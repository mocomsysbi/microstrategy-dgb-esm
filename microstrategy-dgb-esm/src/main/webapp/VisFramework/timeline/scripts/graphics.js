SimileAjax.Graphics=new Object();SimileAjax.Graphics.pngIsTranslucent=(!SimileAjax.Platform.browser.isIE)||(SimileAjax.Platform.browser.majorVersion>6);if(!SimileAjax.Graphics.pngIsTranslucent){SimileAjax.includeCssFile(document,SimileAjax.urlPrefix+"styles/graphics-ie6.css");}SimileAjax.Graphics._createTranslucentImage1=function(url,verticalAlign){var elmt=document.createElement("img");elmt.setAttribute("src",url);if(verticalAlign!=null){elmt.style.verticalAlign=verticalAlign;}return elmt;};SimileAjax.Graphics._createTranslucentImage2=function(url,verticalAlign){var elmt=document.createElement("img");elmt.style.width="1px";elmt.style.height="1px";elmt.style.filter="progid:DXImageTransform.Microsoft.AlphaImageLoader(src='"+url+"', sizingMethod='image')";elmt.style.verticalAlign=(verticalAlign!=null)?verticalAlign:"middle";return elmt;};SimileAjax.Graphics.createTranslucentImage=SimileAjax.Graphics.pngIsTranslucent?SimileAjax.Graphics._createTranslucentImage1:SimileAjax.Graphics._createTranslucentImage2;SimileAjax.Graphics._createTranslucentImageHTML1=function(url,verticalAlign){return'<img src="'+url+'"'+(verticalAlign!=null?' style="vertical-align: '+verticalAlign+';"':"")+" />";};SimileAjax.Graphics._createTranslucentImageHTML2=function(url,verticalAlign){var style="width: 1px; height: 1px; filter:progid:DXImageTransform.Microsoft.AlphaImageLoader(src='"+url+"', sizingMethod='image');"+(verticalAlign!=null?" vertical-align: "+verticalAlign+";":"");return"<img src='"+url+"' style=\""+style+'" />';};SimileAjax.Graphics.createTranslucentImageHTML=SimileAjax.Graphics.pngIsTranslucent?SimileAjax.Graphics._createTranslucentImageHTML1:SimileAjax.Graphics._createTranslucentImageHTML2;SimileAjax.Graphics.setOpacity=function(elmt,opacity){if(SimileAjax.Platform.browser.isIE){elmt.style.filter="progid:DXImageTransform.Microsoft.Alpha(Style=0,Opacity="+opacity+")";}else{var o=(opacity/100).toString();elmt.style.opacity=o;elmt.style.MozOpacity=o;}};SimileAjax.Graphics.bubbleConfig={containerCSSClass:"simileAjax-bubble-container",innerContainerCSSClass:"simileAjax-bubble-innerContainer",contentContainerCSSClass:"simileAjax-bubble-contentContainer",borderGraphicSize:50,borderGraphicCSSClassPrefix:"simileAjax-bubble-border-",arrowGraphicTargetOffset:33,arrowGraphicLength:100,arrowGraphicWidth:49,arrowGraphicCSSClassPrefix:"simileAjax-bubble-arrow-",closeGraphicCSSClass:"simileAjax-bubble-close",extraPadding:20};SimileAjax.Graphics.createBubbleForContentAndPoint=function(div,pageX,pageY,contentWidth,orientation,maxHeight){if(typeof contentWidth!="number"){contentWidth=300;}if(typeof maxHeight!="number"){maxHeight=0;}div.style.position="absolute";div.style.left="-5000px";div.style.top="0px";div.style.width=contentWidth+"px";document.body.appendChild(div);window.setTimeout(function(){var width=div.scrollWidth+10;var height=div.scrollHeight+10;var scrollDivW=0;if(maxHeight>0&&height>maxHeight){height=maxHeight;scrollDivW=width-25;}var bubble=SimileAjax.Graphics.createBubbleForPoint(pageX,pageY,width,height,orientation);document.body.removeChild(div);div.style.position="static";div.style.left="";div.style.top="";if(scrollDivW>0){var scrollDiv=document.createElement("div");div.style.width="";scrollDiv.style.width=scrollDivW+"px";scrollDiv.appendChild(div);bubble.content.appendChild(scrollDiv);}else{div.style.width=width+"px";bubble.content.appendChild(div);}},200);};SimileAjax.Graphics.createBubbleForPoint=function(pageX,pageY,contentWidth,contentHeight,orientation){contentWidth=parseInt(contentWidth,10);contentHeight=parseInt(contentHeight,10);var bubbleConfig=SimileAjax.Graphics.bubbleConfig;var pngTransparencyClassSuffix=SimileAjax.Graphics.pngIsTranslucent?"pngTranslucent":"pngNotTranslucent";var bubbleWidth=contentWidth+2*bubbleConfig.borderGraphicSize;var bubbleHeight=contentHeight+2*bubbleConfig.borderGraphicSize;var generatePngSensitiveClass=function(className){return className+" "+className+"-"+pngTransparencyClassSuffix;};var div=document.createElement("div");div.className=generatePngSensitiveClass(bubbleConfig.containerCSSClass);div.style.width=contentWidth+"px";div.style.height=contentHeight+"px";var divInnerContainer=document.createElement("div");divInnerContainer.className=generatePngSensitiveClass(bubbleConfig.innerContainerCSSClass);div.appendChild(divInnerContainer);var close=function(){if(!bubble._closed){document.body.removeChild(bubble._div);bubble._doc=null;bubble._div=null;bubble._content=null;bubble._closed=true;}};var bubble={_closed:false};var layer=SimileAjax.WindowManager.pushLayer(close,true,div);bubble._div=div;bubble.close=function(){SimileAjax.WindowManager.popLayer(layer);};var createBorder=function(classNameSuffix){var divBorderGraphic=document.createElement("div");divBorderGraphic.className=generatePngSensitiveClass(bubbleConfig.borderGraphicCSSClassPrefix+classNameSuffix);divInnerContainer.appendChild(divBorderGraphic);};createBorder("top-left");createBorder("top-right");createBorder("bottom-left");createBorder("bottom-right");createBorder("left");createBorder("right");createBorder("top");createBorder("bottom");var divContentContainer=document.createElement("div");divContentContainer.className=generatePngSensitiveClass(bubbleConfig.contentContainerCSSClass);divInnerContainer.appendChild(divContentContainer);bubble.content=divContentContainer;var divClose=document.createElement("div");divClose.className=generatePngSensitiveClass(bubbleConfig.closeGraphicCSSClass);divInnerContainer.appendChild(divClose);SimileAjax.WindowManager.registerEventWithObject(divClose,"click",bubble,"close");(function(){var dims=SimileAjax.Graphics.getWindowDimensions();var docWidth=dims.w;var docHeight=dims.h;var halfArrowGraphicWidth=Math.ceil(bubbleConfig.arrowGraphicWidth/2);var createArrow=function(classNameSuffix){var divArrowGraphic=document.createElement("div");divArrowGraphic.className=generatePngSensitiveClass(bubbleConfig.arrowGraphicCSSClassPrefix+"point-"+classNameSuffix);divInnerContainer.appendChild(divArrowGraphic);return divArrowGraphic;};if(pageX-halfArrowGraphicWidth-bubbleConfig.borderGraphicSize-bubbleConfig.extraPadding>0&&pageX+halfArrowGraphicWidth+bubbleConfig.borderGraphicSize+bubbleConfig.extraPadding<docWidth){var left=pageX-Math.round(contentWidth/2);left=pageX<(docWidth/2)?Math.max(left,bubbleConfig.extraPadding+bubbleConfig.borderGraphicSize):Math.min(left,docWidth-bubbleConfig.extraPadding-bubbleConfig.borderGraphicSize-contentWidth);if((orientation&&orientation=="top")||(!orientation&&(pageY-bubbleConfig.arrowGraphicTargetOffset-contentHeight-bubbleConfig.borderGraphicSize-bubbleConfig.extraPadding>0))){var divArrow=createArrow("down");divArrow.style.left=(pageX-halfArrowGraphicWidth-left)+"px";div.style.left=left+"px";div.style.top=(pageY-bubbleConfig.arrowGraphicTargetOffset-contentHeight)+"px";return ;}else{if((orientation&&orientation=="bottom")||(!orientation&&(pageY+bubbleConfig.arrowGraphicTargetOffset+contentHeight+bubbleConfig.borderGraphicSize+bubbleConfig.extraPadding<docHeight))){var divArrow=createArrow("up");divArrow.style.left=(pageX-halfArrowGraphicWidth-left)+"px";div.style.left=left+"px";div.style.top=(pageY+bubbleConfig.arrowGraphicTargetOffset)+"px";return ;}}}var top=pageY-Math.round(contentHeight/2);top=pageY<(docHeight/2)?Math.max(top,bubbleConfig.extraPadding+bubbleConfig.borderGraphicSize):Math.min(top,docHeight-bubbleConfig.extraPadding-bubbleConfig.borderGraphicSize-contentHeight);if((orientation&&orientation=="left")||(!orientation&&(pageX-bubbleConfig.arrowGraphicTargetOffset-contentWidth-bubbleConfig.borderGraphicSize-bubbleConfig.extraPadding>0))){var divArrow=createArrow("right");divArrow.style.top=(pageY-halfArrowGraphicWidth-top)+"px";div.style.top=top+"px";div.style.left=(pageX-bubbleConfig.arrowGraphicTargetOffset-contentWidth)+"px";}else{var divArrow=createArrow("left");divArrow.style.top=(pageY-halfArrowGraphicWidth-top)+"px";div.style.top=top+"px";div.style.left=(pageX+bubbleConfig.arrowGraphicTargetOffset)+"px";}})();document.body.appendChild(div);return bubble;};SimileAjax.Graphics.getWindowDimensions=function(){if(typeof window.innerHeight=="number"){return{w:window.innerWidth,h:window.innerHeight};}else{if(document.documentElement&&document.documentElement.clientHeight){return{w:document.documentElement.clientWidth,h:document.documentElement.clientHeight};}else{if(document.body&&document.body.clientHeight){return{w:document.body.clientWidth,h:document.body.clientHeight};}}}};SimileAjax.Graphics.createMessageBubble=function(doc){var containerDiv=doc.createElement("div");if(SimileAjax.Graphics.pngIsTranslucent){var topDiv=doc.createElement("div");topDiv.style.height="33px";topDiv.style.background="url("+SimileAjax.urlPrefix+"images/message-top-left.png) top left no-repeat";topDiv.style.paddingLeft="44px";containerDiv.appendChild(topDiv);var topRightDiv=doc.createElement("div");topRightDiv.style.height="33px";topRightDiv.style.background="url("+SimileAjax.urlPrefix+"images/message-top-right.png) top right no-repeat";topDiv.appendChild(topRightDiv);var middleDiv=doc.createElement("div");middleDiv.style.background="url("+SimileAjax.urlPrefix+"images/message-left.png) top left repeat-y";middleDiv.style.paddingLeft="44px";containerDiv.appendChild(middleDiv);var middleRightDiv=doc.createElement("div");middleRightDiv.style.background="url("+SimileAjax.urlPrefix+"images/message-right.png) top right repeat-y";middleRightDiv.style.paddingRight="44px";middleDiv.appendChild(middleRightDiv);var contentDiv=doc.createElement("div");middleRightDiv.appendChild(contentDiv);var bottomDiv=doc.createElement("div");bottomDiv.style.height="55px";bottomDiv.style.background="url("+SimileAjax.urlPrefix+"images/message-bottom-left.png) bottom left no-repeat";bottomDiv.style.paddingLeft="44px";containerDiv.appendChild(bottomDiv);var bottomRightDiv=doc.createElement("div");bottomRightDiv.style.height="55px";bottomRightDiv.style.background="url("+SimileAjax.urlPrefix+"images/message-bottom-right.png) bottom right no-repeat";bottomDiv.appendChild(bottomRightDiv);}else{containerDiv.style.border="2px solid #7777AA";containerDiv.style.padding="20px";containerDiv.style.background="white";SimileAjax.Graphics.setOpacity(containerDiv,90);var contentDiv=doc.createElement("div");containerDiv.appendChild(contentDiv);}return{containerDiv:containerDiv,contentDiv:contentDiv};};SimileAjax.Graphics.createAnimation=function(f,from,to,duration,cont){return new SimileAjax.Graphics._Animation(f,from,to,duration,cont);};SimileAjax.Graphics._Animation=function(f,from,to,duration,cont){this.f=f;this.cont=(typeof cont=="function")?cont:function(){};this.from=from;this.to=to;this.current=from;this.duration=duration;this.start=new Date().getTime();this.timePassed=0;};SimileAjax.Graphics._Animation.prototype.run=function(){var a=this;window.setTimeout(function(){a.step();},50);};SimileAjax.Graphics._Animation.prototype.step=function(){this.timePassed+=50;var timePassedFraction=this.timePassed/this.duration;var parameterFraction=-Math.cos(timePassedFraction*Math.PI)/2+0.5;var current=parameterFraction*(this.to-this.from)+this.from;try{this.f(current,current-this.current);}catch(e){}this.current=current;if(this.timePassed<this.duration){this.run();}else{this.f(this.to,0);this["cont"]();}};SimileAjax.Graphics.createStructuredDataCopyButton=function(image,width,height,createDataFunction){var div=document.createElement("div");div.style.position="relative";div.style.display="inline";div.style.width=width+"px";div.style.height=height+"px";div.style.overflow="hidden";div.style.margin="2px";if(SimileAjax.Graphics.pngIsTranslucent){div.style.background="url("+image+") no-repeat";}else{div.style.filter="progid:DXImageTransform.Microsoft.AlphaImageLoader(src='"+image+"', sizingMethod='image')";}var style;if(SimileAjax.Platform.browser.isIE){style="filter:alpha(opacity=0)";}else{style="opacity: 0";}div.innerHTML="<textarea rows='1' autocomplete='off' value='none' style='"+style+"' />";var textarea=div.firstChild;textarea.style.width=width+"px";textarea.style.height=height+"px";textarea.onmousedown=function(evt){evt=(evt)?evt:((event)?event:null);if(evt.button==2){textarea.value=createDataFunction();textarea.select();}};return div;};SimileAjax.Graphics.getWidthHeight=function(el){var w,h;if(el.getBoundingClientRect==null){w=el.offsetWidth;h=el.offsetHeight;}else{var rect=el.getBoundingClientRect();w=Math.ceil(rect.right-rect.left);h=Math.ceil(rect.bottom-rect.top);}return{width:w,height:h};};SimileAjax.Graphics.getFontRenderingContext=function(elmt,width){return new SimileAjax.Graphics._FontRenderingContext(elmt,width);};SimileAjax.Graphics._FontRenderingContext=function(elmt,width){this._elmt=elmt;this._elmt.style.visibility="hidden";if(typeof width=="string"){this._elmt.style.width=width;}else{if(typeof width=="number"){this._elmt.style.width=width+"px";}}};SimileAjax.Graphics._FontRenderingContext.prototype.dispose=function(){this._elmt=null;};SimileAjax.Graphics._FontRenderingContext.prototype.update=function(){this._elmt.innerHTML="A";this._lineHeight=this._elmt.offsetHeight;};SimileAjax.Graphics._FontRenderingContext.prototype.computeSize=function(text,className){var el=this._elmt;el.innerHTML=text;el.className=className===undefined?"":className;var wh=SimileAjax.Graphics.getWidthHeight(el);el.className="";return wh;};SimileAjax.Graphics._FontRenderingContext.prototype.getLineHeight=function(){return this._lineHeight;};