mstrIPhoneMapVisPropsEditorImplScript=true;mstrIPhoneMapVisPropsEditorImpl.prototype=new mstrBoneImpl();mstrIPhoneMapVisPropsEditorImpl.prototype.onload=function(){try{if(!this.isValidGrid){return ;}this.TRDisplay=mstr.utils.ISDXIE?"block":"table-row";for(var e in this.keys){this.initBone();this.updateForms("gr",e);this.updateAttribute("af",e);this.updateAttrForms("af",e);this.updateDisplayPulldown(e);this.updateIcon("mstyl",e);this.updateIcon("dms",e);this.updateDisplayAffinityPulldown(e);this.updateDisplayInfoPulldown(e);this.updateDisplayMarkCheckbox("af",e);this.updateLookupAttForms("af",e);}this.updateDataSetRadio();this.updateBaseMap();var spanTab=microstrategy.findChildrenWithAtt(this.elem,"span","ty","tab1");if(spanTab&&spanTab.length>0){this.setCurrentTab(spanTab[0]);}else{this.setCurrentTab();}}catch(err){microstrategy.errors.log(err);}};mstrIPhoneMapVisPropsEditorImpl.prototype.updateAttribute=function(propName,key){var parentDiv=microstrategy.findChildWithAtt(this.elem,"div","key",key),show=microstrategy.findChildWithAtt(parentDiv,"select","id",propName);if(!show){return ;}var attrTR=microstrategy.findChildWithAtt(parentDiv,"tr","id","attr").style;if(show.value=="1"){attrTR.display=this.TRDisplay;}else{attrTR.display="none";}};mstrIPhoneMapVisPropsEditorImpl.prototype.getAffinityLineTemplateKeys=function(){var tabContainers=microstrategy.findChildrenWithAtt(this.elem,"span","ty","tab1"),sdpHash={},parentDiv,aft,disAf,afSelect;if(tabContainers){for(var key in this.keys){for(var i=0;i<tabContainers.length;i++){if(tabContainers[i].getAttribute("key")===key&&tabContainers[i].style.display!="none"){parentDiv=microstrategy.findChildWithAtt(this.elem,"div","key",key);aft=microstrategy.findChildWithAtt(parentDiv,"table","id","affinity-table");disAf=microstrategy.findChildWithAtt(parentDiv,"input","id","da");if(aft&&aft.style.display!="none"&&disAf.checked){afSelect=microstrategy.findChildWithAtt(parentDiv,"select","sdp","2");if(afSelect.selectedIndex!="0"){sdpHash[afSelect.value]=true;}}}}}}return sdpHash;};mstrIPhoneMapVisPropsEditorImpl.prototype.getSdpKeys=function(){var sdpHash=this.getAffinityLineTemplateKeys();var tabContainers=microstrategy.findChildrenWithAtt(this.elem,"span","ty","tab1");if(tabContainers){for(var i=1;i<tabContainers.length;i++){if(tabContainers[i].style.display!="none"){sdpHash[tabContainers[i].getAttribute("key")]=true;}}}return sdpHash;};mstrIPhoneMapVisPropsEditorImpl.prototype.updateIcon=function(selectedStyle,key){var parentDiv=microstrategy.findChildWithAtt(this.elem,"div","key",key),sty=microstrategy.findChildWithAtt(parentDiv,"select","id",selectedStyle);var icon=selectedStyle=="mstyl"?microstrategy.findChildWithAtt(parentDiv,"img","id","style-icon"):microstrategy.findChildWithAtt(parentDiv,"img","id","density-icon");if(sty&&icon){icon.src=selectedStyle=="mstyl"?sty.value:this.densityMap[sty.value];}};mstrIPhoneMapVisPropsEditorImpl.prototype.updateForms=function(propName,key){var parentDiv=microstrategy.findChildWithAtt(this.elem,"div","key",key),latTR=microstrategy.findChildWithAtt(parentDiv,"tr","id","lat").style,longTR=microstrategy.findChildWithAtt(parentDiv,"tr","id","long").style,pointTR=microstrategy.findChildWithAtt(parentDiv,"tr","id","point").style,show=microstrategy.findChildWithAtt(parentDiv,"select","id",propName);if(show.value=="1"){latTR.display="none";longTR.display="none";pointTR.display=this.TRDisplay;}else{latTR.display=this.TRDisplay;longTR.display=this.TRDisplay;pointTR.display="none";}};mstrIPhoneMapVisPropsEditorImpl.prototype.getLayerProps=function(key){var visProps;if(this.visProps){if(this.visProps.pgk==key||key==-1){visProps=this.visProps;}else{if(this.visProps.sgProps){visProps=this.visProps.sgProps[key];}}}return visProps;};mstrIPhoneMapVisPropsEditorImpl.prototype.updateAttrForms=function(propName,key){var parentDiv=(microstrategy.findChildWithAtt(this.elem,"div","key",key)),attForm=microstrategy.findChildWithAtt(parentDiv,"select","id","af"),visProps=this.getLayerProps(key),index;if(!attForm){return ;}var isSel=function(curElem,propName,defaultVal){if(visProps){if(visProps[propName]){return visProps[propName]==curElem;}if(propName==="flat"&&visProps.lat){return visProps.lat==curElem;}if(propName==="flong"&&visProps.lng){return visProps.lng==curElem;}}return index==defaultVal;};var attformTR=microstrategy.findChildWithAtt(parentDiv,"tr","id","attform").style,attrTR=microstrategy.findChildWithAtt(parentDiv,"tr","id","attr").style,attTR=microstrategy.findChildWithAtt(parentDiv,"tr","id","att").style;var lat=microstrategy.findChildWithAtt(parentDiv,"select","id","flat"),lng=microstrategy.findChildWithAtt(parentDiv,"select","id","flong"),point=microstrategy.findChildWithAtt(parentDiv,"select","id","fpt");if(attForm.value=="1"){var attPulldown=microstrategy.findChildWithAtt(parentDiv,"select","id","ga");if(!attPulldown||!this.attForms||!this.attForms[key]){return ;}var selectedAttr=attPulldown[attPulldown.selectedIndex],selectedAttrKey=selectedAttr&&selectedAttr.value;var attForms=this.attForms[key][selectedAttrKey];if(attForms){var satf=microstrategy.findChildWithAtt(parentDiv,"select","id","satf");index=0;for(var i=lat.options.length-1;i>=0;i--){lat.options[i]=null;lng.options[i]=null;point.options[i]=null;satf.options[i]=null;}for(var e in attForms){lat.options[index]=new Option(attForms[e],e,null,isSel(e,"flat",0));lng.options[index]=new Option(attForms[e],e,null,isSel(e,"flong",1));point.options[index]=new Option(attForms[e],e,null,isSel(e,"fpt",0));satf.options[index]=new Option(attForms[e],e,null,isSel(e,"satf",0));index++;}}attformTR.display="";attrTR.display="";attTR.display="none";}else{var atts=this.att&&this.att[key];if(atts){index=0;for(var i=lat.options.length-1;i>=0;i--){lat.options[i]=null;lng.options[i]=null;point.options[i]=null;}for(var e in atts){lat.options[index]=new Option(atts[e],e,null,isSel(e,"flat",0));lng.options[index]=new Option(atts[e],e,null,isSel(e,"flong",1));point.options[index]=new Option(atts[e],e,null,isSel(e,"fpt",0));index++;}}attTR.display="";attformTR.display="none";attrTR.display="none";}};mstrIPhoneMapVisPropsEditorImpl.prototype.updateMarkers=function(propName,key){var parentDiv=(microstrategy.findChildWithAtt(this.elem,"div","key",key)),show=microstrategy.findChildrenWithAtt(parentDiv,"input","id","mtp"),showMarker=microstrategy.findChildWithAtt(parentDiv,"input","id","sm"),showAffinity=showMarker.checked;if(show==null||show[0]==null||show[1]==null||show[2]==null){return ;}if(!show[0].checked&&!show[1].checked&&!show[2].checked&&!show[3].checked){if(show[1].getAttribute("checked")){show[1].checked=true;}else{if(show[2].getAttribute("checked")){show[2].checked=true;}else{if(show[3].getAttribute("checked")){show[3].checked=true;}else{show[0].checked=true;}}}}var checkedOpt=show[3].checked?show[3]:show[2].checked?show[2]:show[1].checked?show[1]:show[0],markPD=microstrategy.findChildWithAtt(parentDiv,"div","id","markerPulldown").style,densityPD=microstrategy.findChildWithAtt(parentDiv,"div","id","densityPulldown").style,pathColorPickPD=microstrategy.findChildWithAtt(parentDiv,"div","id","pathColorPicker").style,maxBSTB=microstrategy.findChildWithAtt(parentDiv,"tr","id","maxBubbleSizeTextbox").style,dms=document.getElementById("dms").style,mstyl=document.getElementById("mstyl").style,mSizeStyle=microstrategy.findChildWithAtt(parentDiv,"tr","id","mapSizingStyle").style,atCB=microstrategy.findChildWithAtt(parentDiv,"tr","id","applyThreadCheckBox").style,mcCB=microstrategy.findChildWithAtt(parentDiv,"tr","id","applyMarkerClustering").style,aft=microstrategy.findChildWithAtt(parentDiv,"table","id","affinity-table"),displayAffline=microstrategy.findChildWithAtt(parentDiv,"input","id","da");if(aft){aft.style.display="none";}if(checkedOpt.value==="2"){maxBSTB.display=this.TRDisplay;mSizeStyle.display=this.TRDisplay;atCB.display=this.TRDisplay;markPD.visibility="hidden";densityPD.visibility="hidden";pathColorPickPD.visibility="hidden";if(mstr.utils.ISIE4){dms.visibility="hidden";mstyl.visibility="hidden";}if(aft&&showAffinity){aft.style.display="table";}}else{if(checkedOpt.value==="1"){markPD.visibility="visible";maxBSTB.display="none";mSizeStyle.display="none";densityPD.visibility="hidden";pathColorPickPD.visibility="hidden";if(mstr.utils.ISIE4){mstyl.visibility="visible";dms.visibility="hidden";}atCB.display=this.TRDisplay;mcCB.display=this.TRDisplay;if(aft&&showAffinity){aft.style.display="table";}}else{if(checkedOpt.value==="4"){markPD.visibility="hidden";maxBSTB.display="none";mSizeStyle.display="none";densityPD.visibility="visible";pathColorPickPD.visibility="hidden";if(mstr.utils.ISIE4){mstyl.visibility="hidden";dms.visibility="visible";}atCB.display="none";mcCB.display="none";}else{if(checkedOpt.value==="5"){markPD.visibility="hidden";maxBSTB.display="none";mSizeStyle.display="none";densityPD.visibility="hidden";pathColorPickPD.visibility="visible";if(mstr.utils.ISIE4){mstyl.visibility="hidden";dms.visibility="hidden";}atCB.display="none";mcCB.display="none";}}}}if(aft&&aft.style.display==="none"){displayAffline.checked=false;}};mstrIPhoneMapVisPropsEditorImpl.prototype.updateDisplayPulldown=function(key){var parentDiv=(microstrategy.findChildWithAtt(this.elem,"div","key",key)),display=microstrategy.findChildWithAtt(parentDiv,"input","id","dl");if(display==null){return ;}var disSel=microstrategy.findChildWithAtt(parentDiv,"tr","id","disSelect");if(display.checked){disSel.style.display=this.TRDisplay;}else{disSel.style.display="none";}};mstrIPhoneMapVisPropsEditorImpl.prototype.updateDisplayInfoPulldown=function(){var display=document.getElementById("dil");if(display==null){return ;}if(display.checked){document.getElementById("disSelectL").style.display=this.TRDisplay;}else{document.getElementById("disSelectL").style.display="none";}};mstrIPhoneMapVisPropsEditorImpl.prototype.getSdpString=function(){var sdpHash=this.getSdpKeys();var temp="";for(var k in sdpHash){temp+=k+",";}temp=temp.substring(0,temp.length-1);return temp;};mstrIPhoneMapVisPropsEditorImpl.prototype.getMTPForPrimaryString=function(){var inputs=microstrategy.findChildrenWithAtt(this.elem,"input","visprop","1");var value="";for(var i=0;i<inputs.length;i++){var input=inputs[i];if(input.id.indexOf("mtp")>-1){value=input.checked?input.value:value;}}return value;};mstrIPhoneMapVisPropsEditorImpl.prototype.restoreMTPForPrimaryString=function(key){var inputs=microstrategy.findChildrenWithAtt(this.elem,"input","visprop","1");for(var i=0;i<inputs.length;i++){var input=inputs[i];if(input.id=="mtp"){input.id=input.id+key;}}};mstrIPhoneMapVisPropsEditorImpl.prototype.getPCPValue=function(isPrimaryGrid,key){var parentDiv=(microstrategy.findChildWithAtt(this.elem,"div","key",key)),input=isPrimaryGrid=="true"?microstrategy.findChildWithAtt(parentDiv,"input","id","pcp"):microstrategy.findChildWithAtt(parentDiv,"input","id","pcp"+key);return input.value.substring(1);};mstrIPhoneMapVisPropsEditorImpl.prototype.updateDisplayMarkCheckbox=function(selectedAttributeOrForm,key){var parentDiv=(microstrategy.findChildWithAtt(this.elem,"div","key",key)),show=microstrategy.findChildWithAtt(parentDiv,"select","id",selectedAttributeOrForm);if(!show){return ;}var dm=microstrategy.findChildWithAtt(parentDiv,"tr","id","dm").style;var dmaf=microstrategy.findChildWithAtt(parentDiv,"tr","id","dmaf").style;if(show.value=="0"){dm.display=this.TRDisplay;dmaf.display="none";}else{dm.display="none";dmaf.display=this.TRDisplay;}};mstrIPhoneMapVisPropsEditorImpl.prototype.updateLookupAttForms=function(selectedAttributeOrForm,key){var parentDiv=(microstrategy.findChildWithAtt(this.elem,"div","key",key)),show=microstrategy.findChildWithAtt(parentDiv,"select","id",selectedAttributeOrForm),slaPulldown=microstrategy.findChildWithAtt(parentDiv,"tr","id","lookupAttrSelect");if(!show){return ;}if(slaPulldown){var attr=slaPulldown.style;if(show.value=="0"){attr.display=this.TRDisplay;}else{attr.display="none";}}};mstrIPhoneMapVisPropsEditorImpl.prototype.updateDisplayAffinityPulldown=function(key){var parentDiv=(microstrategy.findChildWithAtt(this.elem,"div","key",key)),display=microstrategy.findChildWithAtt(parentDiv,"input","id","da");if(display==null){return ;}var sdpSelectBox=microstrategy.findChildWithAtt(parentDiv,"select","id","ag"),clusterCheckBox=microstrategy.findChildWithAtt(parentDiv,"input","id","mc");microstrategy.findChildWithAtt(parentDiv,"tr","id","disAffSelect").style.display=display.checked?this.TRDisplay:"none";microstrategy.findChildWithAtt(parentDiv,"tr","id","disAffSelectAL").style.display=display.checked?this.TRDisplay:"none";microstrategy.findChildWithAtt(parentDiv,"tr","id","disMaxLineThickness").style.display=display.checked?this.TRDisplay:"none";microstrategy.findChildWithAtt(parentDiv,"select","id","latt").disabled=display.checked?false:true;if(!display.checked){sdpSelectBox.selectedIndex=0;clusterCheckBox.disabled=false;}else{clusterCheckBox.disabled=true;clusterCheckBox.checked=false;}};mstrIPhoneMapVisPropsEditorImpl.prototype.getGridsXml=function(){var selects,inputs;var tabContainers=microstrategy.findChildrenWithAtt(this.elem,"span","ty","tab1");if(tabContainers.length>0){if(tabContainers.length==1){return"";}var gridXml="<sgProps>";for(var k=1;k<tabContainers.length;k++){if(tabContainers[k].style.display!="none"){var gridKey=tabContainers[k].getAttribute("key");gridXml+='<g k="'+gridKey+'">';inputs=microstrategy.findChildrenWithAtt(this.elem,"input","groupKey",gridKey);selects=microstrategy.findChildrenWithAtt(this.elem,"select","groupKey",gridKey);inputs=inputs.concat(selects);var gridsPropsXml=this.getGridsPropsXml(inputs,gridKey);if(gridsPropsXml==-1){return gridsPropsXml;}gridXml+=gridsPropsXml;gridXml+="</g>";}}gridXml+="</sgProps>";return gridXml;}else{return"";}};mstrIPhoneMapVisPropsEditorImpl.prototype.getGridsPropsXml=function(gridInputs,gridKey){var i,j,gridXml="",layerProps=this.getLayerProps(gridKey)||{},propsToDelete=["sgProps","gtp","sm","sa","ma","lat","lng","dirtyVp"],n=propsToDelete.length;for(i=0;i<n;i++){delete layerProps[propsToDelete[i]];}if(gridInputs){for(i=0;i<gridInputs.length;i++){var input=gridInputs[i];var value="";var isValidAttribute=input.getAttribute("isvalid");if(isValidAttribute){var isValid=eval(isValidAttribute);if(isValid!=true){alert(isValid);return -1;}}switch(input.type){case"text":value=(input.getAttribute("getvalue"))?eval(input.getAttribute("getvalue")):input.value;break;case"checkbox":value=input.checked?input.value:"0";break;case"hidden":value=(input.getAttribute("getvalue"))?eval(input.getAttribute("getvalue")):input.value;break;case"radio":value=input.checked?input.value:null;break;case"select-one":for(j=0;j<input.length;j++){var option=input[j];if(option.selected==true){value=option.value;if(value.length==0&&input.getAttribute("allowEmpty")=="false"){value=null;}break;}}break;default:alert("input type not supported");}if(value!=null){layerProps[input.id.indexOf("pcp")>-1?"pcp":input.id]=value;}}}for(var k in layerProps){gridXml+="<"+k+' value="'+layerProps[k]+'" />';}return gridXml;};mstrIPhoneMapVisPropsEditorImpl.prototype.setCurrentTab=function(tabSelected){try{if(tabSelected){this.currentTab=tabSelected.getAttribute("curtab");}var tabContainers=microstrategy.findChildrenWithAtt(this.elem,"span","ty","tab1");var divContainers=microstrategy.findChildrenWithAtt(this.elem,"div","id","gridDiv");var afTmpKeys=this.getAffinityLineTemplateKeys();if(tabContainers&&tabContainers.length>0){for(var i=0;i<tabContainers.length;i++){if(tabContainers[i].getAttribute("curtab")==this.currentTab&&divContainers[i].getAttribute("key")==tabContainers[i].getAttribute("key")){divContainers[i].style.display="block";tabContainers[i].className="mstrTabSetTabSelected";tabContainers[i].style.display="";}else{tabContainers[i].className="mstrTabSetTab";divContainers[i].style.display="none";if(afTmpKeys[tabContainers[i].getAttribute("key")]){tabContainers[i].style.display="none";}}}}else{divContainers[0].style.display="block";}this.updateAffinityLineTemplatesSelect();}catch(err){microstrategy.errors.log(err);}};mstrIPhoneMapVisPropsEditorImpl.prototype.updateAffinityLineTemplatesSelect=function(){var tabContainers=microstrategy.findChildrenWithAtt(this.elem,"span","ty","tab1"),affinityLinesSelects=microstrategy.findChildrenWithAtt(this.elem,"select","id","ag"),sdpKeyNameMap={"":"- none -"},afSelect,option,selectdAfKey;if(tabContainers&&affinityLinesSelects){for(var i=1;i<tabContainers.length;i++){if(tabContainers[i].style.display=="none"){sdpKeyNameMap[tabContainers[i].getAttribute("key")]=tabContainers[i].firstChild.data;}}for(var j=0;j<affinityLinesSelects.length;j++){afSelect=affinityLinesSelects[j];selectdAfKey="";for(var k=0;k<afSelect.length;k++){option=afSelect[k];if(option.selected==true){selectdAfKey=option.value;break;}}afSelect.options.length=0;for(var afKey in sdpKeyNameMap){option=new Option(sdpKeyNameMap[afKey],afKey,null,afKey==selectdAfKey);afSelect.options.add(option);}}}};mstrIPhoneMapVisPropsEditorImpl.prototype.delCurrentTab=function(spanSelected){var tabSelected=spanSelected.parentNode;var tabContainers=microstrategy.findChildrenWithAtt(this.elem,"span","ty","tab1");if(!tabContainers||tabContainers.length==0){return ;}if(tabSelected.getAttribute("key")==tabContainers[0].getAttribute("key")){return ;}for(var i=1;i<tabContainers.length;i++){if(tabContainers[i].getAttribute("key")==tabSelected.getAttribute("key")&&tabContainers[i].className=="mstrTabSetTabSelected"){tabContainers[i].className="mstrTabSetTab";var divContainers=microstrategy.findChildrenWithAtt(this.elem,"div","id","gridDiv");divContainers[i].style.display="none";tabContainers[i].style.display="none";divContainers[0].style.display="block";tabContainers[0].className="mstrTabSetTabSelected";break;}}this.updateTabStripDisplay();this.updateAffinityLineTemplatesSelect();};mstrIPhoneMapVisPropsEditorImpl.prototype.closeMapElemPopup=function(){var mapElemDiv=getElementById("evodiv");mapElemDiv.style.display="none";};mstrIPhoneMapVisPropsEditorImpl.prototype.updateDataSetRadio=function(){var dsRadio=document.getElementsByName("dataSet"),sdpKeys=this.getSdpKeys(),tabContainers=microstrategy.findChildrenWithAtt(this.elem,"span","ty","tab1");if(!dsRadio||!tabContainers||tabContainers.length==0||dsRadio.length==0){return 0;}var dsShow=dsRadio.length;for(var i=0;i<dsRadio.length;i++){if(sdpKeys[dsRadio[i].value]){dsRadio[i].parentNode.style.display="none";dsShow--;}else{dsRadio[i].parentNode.style.display="";}}return dsShow;};mstrIPhoneMapVisPropsEditorImpl.prototype.showDSPopup=function(){var parentDiv=microstrategy.findChildrenWithAtt(this.elem,"div","id","ppdiv");var dsCount=this.updateDataSetRadio();if(dsCount<=0){alert(microstrategy.descriptors.getDescriptor(9934));}else{if(parentDiv){for(var i=0;i<parentDiv.length;i++){parentDiv[i].style.display="block";}}}};mstrIPhoneMapVisPropsEditorImpl.prototype.showMEVOPopup=function(){var mapElemDiv=microstrategy.findChildWithAtt(this.elem,"div","id","evodiv"),contract=microstrategy.findChildWithAtt(this.elem,"img","id","contract"),expand=microstrategy.findChildWithAtt(this.elem,"img","id","expand");contract.style.display=mapElemDiv.style.display=="none"?"inline":"none";expand.style.display=mapElemDiv.style.display=="none"?"none":"inline";mapElemDiv.style.display=mapElemDiv.style.display=="none"?"block":"none";};mstrIPhoneMapVisPropsEditorImpl.prototype.validateDataType=function(formName,key,propName1,propName2){var parentDiv=(microstrategy.findChildWithAtt(this.elem,"div","key",key)),showMarker=microstrategy.findChildWithAtt(parentDiv,"input","id","sm"),dataType=microstrategy.findChildWithAtt(parentDiv,"select","id",formName);if(!showMarker.checked){return true;}if(dataType!=null&&dataType.value=="1"){return true;}return this.validateLatLong(parentDiv,key,propName1,propName2);};mstrIPhoneMapVisPropsEditorImpl.prototype.validateLatLong=function(parentDiv,key,propName1,propName2){var lat=microstrategy.findChildWithAtt(parentDiv,"select","id",propName1),lng=microstrategy.findChildWithAtt(parentDiv,"select","id",propName2);if((lat!=null)&&(lng!=null)&&lat.value&&lng.value&&(lat.value==lng.value)){return microstrategy.descriptors.getDescriptor("7670");}else{return true;}};mstrIPhoneMapVisPropsEditorImpl.prototype.updateTabStripDisplay=function(){if(mstr.utils.ISIE7){var tabStrip=document.getElementById("visTabStrip");if(tabStrip){tabStrip.style.paddingBottom=(tabStrip.scrollWidth>tabStrip.clientWidth)?"17px":0;}}};mstrIPhoneMapVisPropsEditorImpl.prototype.okDSChanges=function(){var show=document.getElementsByName("dataSet");if(show==null){return ;}for(var i=0;i<show.length;i++){if(show[i].checked){var selectedTab=show[i].value;var tabContainers=microstrategy.findChildrenWithAtt(this.elem,"span","ty","tab1");if(tabContainers){for(var i=0;i<tabContainers.length;i++){if(selectedTab==tabContainers[i].getAttribute("key")){this.setCurrentTab(tabContainers[i]);break;}}}break;}}this.updateTabStripDisplay();this.closeDSPopup();};mstrIPhoneMapVisPropsEditorImpl.prototype.closeDSPopup=function(){var dsTable=document.getElementById("ppdiv");if(dsTable){dsTable.style.display="none";}};mstrIPhoneMapVisPropsEditorImpl.prototype.validateSecondaryDataProvider=function(sdpName,key){var parentDiv=(microstrategy.findChildWithAtt(this.elem,"div","key",key)),aft=microstrategy.findChildWithAtt(parentDiv,"table","id","affinity-table");if(!aft||aft.style.display=="none"){return true;}var sdp=microstrategy.findChildWithAtt(parentDiv,"select","id",sdpName);var daCheckbox=microstrategy.findChildWithAtt(parentDiv,"input","id","da");if(!sdp||!daCheckbox||!daCheckbox.checked){return true;}if(sdp.selectedIndex==0){return microstrategy.descriptors.getDescriptor("8328");}else{return true;}};mstrIPhoneMapVisPropsEditorImpl.prototype.validateMaxBubbleSize=function(){var mbs=getElementById("mbs");if(!mbs){return ;}if(!(/^[-+]?[0-9]+$/.test(mbs.value))){return microstrategy.descriptors.getDescriptor("8326");}if(mbs.value<=6){return microstrategy.descriptors.getDescriptor("8327").replace("##","7");}return true;};mstrIPhoneMapVisPropsEditorImpl.prototype.updateBaseMap=function(){var i,mt,baseMapVal,basemap=microstrategy.findChildWithAtt(this.elem,"select","id","bmt"),mapstyles=microstrategy.findChildrenWithAtt(this.elem,"select","id","dv"),msNum=(mapstyles&&mapstyles.length)||0;if(!basemap){return ;}baseMapVal=basemap.value;for(i=0;i<msNum;i++){mt=mapstyles[i];mt.style.display=mt.getAttribute("basemap")===baseMapVal?"block":"none";}for(var key in this.keys){this.updateAreaShapes("lid",key);this.updateShowMarkerArea(key);}};mstrIPhoneMapVisPropsEditorImpl.prototype.updateAreaShapes=function(propName,key){var selectedShapeId,option,shapes=this.areaShapes,visProps=this.getLayerProps(key),parentDiv=microstrategy.findChildWithAtt(this.elem,"div","key",key),basemap=microstrategy.findChildWithAtt(this.elem,"select","id","bmt"),isESRI=basemap.value=="1",lid=microstrategy.findChildWithAtt(parentDiv,"select","id",propName);for(var j=0;j<lid.length;j++){option=lid[j];if(option.selected==true){selectedShapeId=option.value;break;}}if(selectedShapeId==undefined&&visProps){selectedShapeId=visProps[propName]||"4";}lid.options.length=0;for(var shapeId in shapes){if(shapes.hasOwnProperty(shapeId)&&(isESRI||shapes[shapeId].cust)){option=new Option(shapes[shapeId].desc,shapeId,null,shapeId==selectedShapeId);lid.options.add(option);}}};mstrIPhoneMapVisPropsEditorImpl.prototype.updateShowMarkerArea=function(key){this.updateShowMarker(key);this.updateShowArea(key);this.updateMarkers("mtp",key);};mstrIPhoneMapVisPropsEditorImpl.prototype.updateShowMarker=function(key){var i,n,hasChecked,markerFieldsInput,markerFieldsSelect,parentDiv=microstrategy.findChildWithAtt(this.elem,"div","key",key),pathColorPickPD=microstrategy.findChildWithAtt(parentDiv,"div","id","pathColorPicker").style,showMarker=microstrategy.findChildWithAtt(parentDiv,"input","id","sm"),radioOptions=microstrategy.findChildrenWithAtt(parentDiv,"input","id","mtp"),displayAffline=microstrategy.findChildWithAtt(parentDiv,"input","id","da"),clusterCheckBox=microstrategy.findChildWithAtt(parentDiv,"input","id","mc"),markerChecked=showMarker.checked;if(!markerChecked){pathColorPickPD.visibility="hidden";}else{if(radioOptions[3].checked){pathColorPickPD.visibility="visible";}}for(i=0;i<radioOptions.length;i++){radioOptions[i].disabled=!markerChecked;}markerFieldsInput=["mbs","at","dm","dmaf"];for(i=0;i<markerFieldsInput.length;i++){microstrategy.findChildWithAtt(parentDiv,"input","id",markerFieldsInput[i]).disabled=showMarker.checked?false:true;}markerFieldsSelect=["mstyl","dms","mss","af","gr","ga","flat","flong","fpt","satf","atf"];for(i=0;i<markerFieldsSelect.length;i++){microstrategy.findChildWithAtt(parentDiv,"select","id",markerFieldsSelect[i]).disabled=showMarker.checked?false:true;}if(showMarker.checked&&(!displayAffline||!displayAffline.checked)){clusterCheckBox.disabled=false;}else{clusterCheckBox.disabled=true;}hasChecked=false;n=radioOptions.length;for(i=0;i<n;i++){hasChecked|=radioOptions[i].checked;}if(!hasChecked){radioOptions[0].checked=true;}};mstrIPhoneMapVisPropsEditorImpl.prototype.updateShowArea=function(key){var parentDiv=microstrategy.findChildWithAtt(this.elem,"div","key",key),showArea=microstrategy.findChildWithAtt(parentDiv,"input","id","sa"),aa=microstrategy.findChildWithAtt(parentDiv,"select","id","aa"),basemap=microstrategy.findChildWithAtt(this.elem,"select","id","bmt"),isESRI=basemap.value=="1",areaChecked=showArea.checked;aa.disabled=areaChecked?false:true;var trLid=microstrategy.findChildWithAtt(parentDiv,"tr","id","trLid"),lid=microstrategy.findChildWithAtt(parentDiv,"select","id","lid");if(isESRI&&this.isOnPremise){trLid.style.display="none";}else{trLid.style.display=this.TRDisplay;lid.disabled=areaChecked?false:true;}};function mstrIPhoneMapVisPropsEditorImpl(id){this.inherits=mstrBoneImpl;this.inherits(id);this.id=id;this.inherits=null;this.path="microstrategy.bone('"+id+"')";return this;}