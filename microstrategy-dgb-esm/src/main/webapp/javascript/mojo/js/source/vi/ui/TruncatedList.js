(function(){mstrmojo.requiresCls("mstrmojo._HasContextMenu","mstrmojo._IsList","mstrmojo.css","mstrmojo.dom","mstrmojo.ListBase");var $CSS=mstrmojo.css,$DOM=mstrmojo.dom;function shouldShowOverflowItem(){var width,itemsWidth,container=this.itemsContainerNode,children,items=this.items,overflowItems=[],overflowControl,overflowWidth,padding=this.padding,len,i=0;this.items.pop();if(!this.width){return ;}width=parseInt(this.width,10);itemsWidth=container.scrollWidth||$DOM.position(container).w;if(itemsWidth<=width){return ;}overflowControl=container.lastChild;$CSS.removeClass(overflowControl,"hide");overflowWidth=$DOM.position(overflowControl).w;children=container.children;len=children.length-1;while(i<len){width-=($DOM.position(container.children[i]).w+padding);if(width<overflowWidth){break;}i++;}while(i<len){container.removeChild(children[children.length-2]);overflowItems.push(items[i++]);}this.set("cm",overflowItems);overflowControl.textContent=mstrmojo.desc(15124,"## more").replace("##",overflowItems.length);}mstrmojo.vi.ui.TruncatedList=mstrmojo.declare(mstrmojo.ListBase,[mstrmojo._IsList,mstrmojo._HasContextMenu],{scriptClass:"mstrmojo.vi.ui.TruncatedList",cssClass:"mstr-truncList",padding:0,overflowCls:"",getAdditionalProperties:mstrmojo.emptyFn,getItemProps:function getItemProps(item,idx){var it=this._super(item,idx),style=item.style;if(style){it.addStyle(style);}this.getAdditionalProperties(it,idx);return it;},buildRendering:function buildRendering(){this.items.push({alias:"overflowItem",cls:this.overflowCls+" hide",n:mstrmojo.desc(15124,"## more").replace("##",this.items.length)});if(this._super){this._super();}},setWidth:mstrmojo.emptyFn,postBuildRendering:function postBuildRendering(){this.setWidth();shouldShowOverflowItem.call(this);if(this._super){this._super();}},onclick:function onclick(evt){var items=this.itemsContainerNode.children,len=items.length,overflowItem=len&&items[len-1];if(overflowItem&&overflowItem===evt.getTarget()){this.cmPos=$DOM.getMousePosition(evt.e,evt.hWin);this.showContextMenu();}}});}());