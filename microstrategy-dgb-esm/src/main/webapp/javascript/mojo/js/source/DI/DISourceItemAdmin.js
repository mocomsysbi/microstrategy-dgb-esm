(function(){mstrmojo.requiresCls("mstrmojo.Box","mstrmojo.dom","mstrmojo.DI.DIHelpers","mstrmojo.DI.DIConstants");mstrmojo.requiresDescs(13227,15134);var $DOM=mstrmojo.dom,$CSS=mstrmojo.css,constants=mstrmojo.DI.DIConstants,$Helper=mstrmojo.DI.DIHelpers,detectCustomImg=mstrmojo.DI.DIHelpers.detectCustomImg;mstrmojo.DI.DISourceItemAdmin=mstrmojo.declare(mstrmojo.Box,null,{scriptClass:"mstrmojo.DI.DISourceItemAdmin",icon:"",n:"",desc:"",mode:"add",tooltipOpenDelay:0,useRichTooltip:true,markupString:'<div id="{@id}" class="mstrmojo-di-source-item mstrmojo-di-source-item-admin {@icon} {@mode}" mstrAttach:click><div class="mstrmojo-di-source-name"><span class="mstrmojo-di-source-name-span">{@en@n}</span></div><div class="mstrmojo-di-source-below"><div class="mstrmojo-di-Icons medium-{@icon}"></div><div class="mstrmojo-di-source-desc">{@desc}</div><div class="mstrmojo-di-source-cover {@mode}"><div class="mstrmojo-di-source-cover-img {@mode}" /></div></div></div>',markupSlots:{nameNode:function(){return this.domNode.firstChild;},iconNode:function(){return this.domNode.children[1].children[0];},descNode:function(){return this.domNode.children[1].children[1];},coverNode:function(){return this.domNode.children[1].children[2];}},postBuildRendering:function postBuildRendering(){if(this._super){this._super();}if(this.iconData&&mstrmojo.string.startsWith(this.iconData,"data:image")){this.iconNode.innerHTML='<img src="'+this.iconData+'" style="width:80px;height:80px;"/>';}else{if(!this.customizeIcon&&!this.icon&&!mstrmojo.string.startsWith(this.iconData,"data:image")&&!$Helper.isOriginalConnector(this.oid)){mstrmojo.css.addClass(this.iconNode,"medium-defaultconnector");}else{if(this.customizeIcon){if(!constants.sourceIconClsName[this.itemId]){detectCustomImg(this.originalName?this.originalName:this.n,this.iconNode);}}else{if($Helper.isOriginalConnector(this.oid)&&this.oid===constants.originalConnector.elastic){mstrmojo.css.addClass(this.iconNode,"medium-Elastic_Connector");}else{if($Helper.isOriginalConnector(this.oid)&&this.oid===constants.originalConnector.tapClicks){mstrmojo.css.addClass(this.iconNode,"medium-TapClicks_Connector");}}}}}if(this.showOAuthLink&&$Helper.getEnvObj().isWS()){$DOM.attachEvent(this.iconNode,"mouseover",this.onOauthButtonMouseOver);$DOM.attachEvent(this.iconNode,"mouseleave",this.onOauthButtonMouseLeave);$CSS.addClass(this.iconNode,"set-oauth-source");this.iconNode.innerHTML='<div class="oauth-link hide"><span>'+mstrmojo.desc(15134,"Set OAuth")+"</span></div>";$DOM.attachEvent(this.iconNode.firstChild,"click",this.onOauthButtonClick.bind(this));}this.set("enabled",true);if(!this.enabled){mstrmojo.css.addClass(this.domNode,"disabled");}else{mstrmojo.css.addClass(this.domNode,"enabled");}},onOauthButtonMouseOver:function(){$CSS.removeClass(this.firstChild,"hide");},onOauthButtonMouseLeave:function(){$CSS.addClass(this.firstChild,"hide");},onOauthButtonClick:function(event){var model=mstrApp.getRootController().model;var externalSources=model.externalSources[this.sourceInfo.type];var sourceItem=this;mstrApp.getRootController().openOAuthParaDialog(event,{sourceName:externalSources.name,did:externalSources.dbRoleID,isOneTier:!!mstrApp.isSingleTier,sourceItem:sourceItem});},onmodeChange:function(evt){var vWas=evt.valueWas,v=evt.value;if(this.hasRendered){$CSS.toggleClass(this.domNode,vWas,false);$CSS.toggleClass(this.coverNode,vWas,false);$CSS.toggleClass(this.domNode,v,true);$CSS.toggleClass(this.coverNode,v,true);}},onclick:function(evt){var target=evt.getTarget(),mode=this.mode;if(mode==="add"&&$DOM.contains(this.coverNode,target)){this.raiseEvent({name:"selectChange",type:"add"});}else{if(mode==="remove"&&target===this.coverNode.children[0]){this.raiseEvent({name:"selectChange",type:"remove"});}}},updateTooltipConfig:function(){var pos=$DOM.position(this.domNode);if(this.title){this.set("richTooltip",{cssClass:"vi-regular A-center vi-tooltip-V",top:Math.max(pos.y,0),left:Math.max(pos.x+pos.w/2,0),posType:mstrmojo.tooltip.POS_BOTTOMCENTER,content:this.title});}}});}());