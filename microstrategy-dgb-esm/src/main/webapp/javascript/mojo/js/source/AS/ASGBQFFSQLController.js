(function(){mstrmojo.requiresCls("mstrmojo.qb.bigquery.RootController","mstrmojo.DI.DIConstants","mstrmojo.AS.ASFFSQLRootController");var $DI_CONSTANTS=mstrmojo.DI.DIConstants;mstrmojo.AS.ASGBQFFSQLController=mstrmojo.declare(mstrmojo.qb.bigquery.RootController,[mstrmojo.AS.ASFFSQLRootController],{scriptClass:"mstrmojo.AS.ASGBQFFSQLController",onFinishButtonClick:function onFinishButtonClick(){var model=mstrApp.rootController.model,dbrId=model.dbrid,tableId=model.tableID,dbr,sql,seq,result;sql=mstrApp.getRootController().rootView.getSQLStatement();seq=sql.split(".");seq=seq[seq.length-1];result={ns:model.selectedDataset,id:dbrId,type:$DI_CONSTANTS.dbType.GOOGLE_BIG_QUERY_FFSQL_MODEL,sql:sql,dbtn:"Custom Query",n:"Custom Query",name:"Google Bigquery",accountId:model.said};result.connection={connectionType:$DI_CONSTANTS.dbType.GOOGLE_BIG_QUERY_FFSQL_MODEL,};result.tables=[];result.tables.push({dbr:dbrId,ns:model.selectedDataset,type:$DI_CONSTANTS.dataSourceType.GOOGLE_BIGQUERY,sql:sql,name:"Custom Query",accountId:model.said});this._super(result);},autoMapFFSQL:function autoMapFFSQL(sqlstatement){var controller=mstrApp.getRootController(),model=controller.model;if(sqlstatement===""){model.raiseEvent({name:"dataPreview",mappings:null,dataset:null,selectedColumns:null,isRefined:false});return ;}var clientId=window.mstrAppSchema.workspaceManager.currentClientId,workspaceId=window.mstrAppSchema.workspaceManager.initialWorkspaceId,piplineId="",dbRoleId=model.SelDBRoleID;var formdata={accountId:model.said,clientId:clientId,requestId:"",workspaceId:workspaceId,pipelineId:piplineId,datasource:{accountId:model.said,dbRoleId:dbRoleId,sql:sqlstatement}};this._super(formdata);}});}());