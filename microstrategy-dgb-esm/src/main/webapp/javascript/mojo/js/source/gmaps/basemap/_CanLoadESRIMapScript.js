(function(){mstrmojo.requiresCls("mstrmojo.gmaps.MapUtils");var esriConfig=null,$ESRI_VERSION="3.17",$DEFAULT_ESRI_API_SERVER="js.arcgis.com/"+$ESRI_VERSION,$MUTLS=mstrmojo.gmaps.MapUtils;mstrmojo.gmaps.basemap._CanLoadESRIMapScript=mstrmojo.provide("mstrmojo.gmaps.basemap._CanLoadESRIMapScript",{_mixinName:"mstrmojo.gmaps.basemap._CanLoadESRIMapScript",callback:null,esriAPIServer:null,setEsriConfig:function setEsriConfig(val){esriConfig=val;},getEsriConfig:function getEsriConfig(){return esriConfig;},parseEsriAPIServer:function parseEsriAPIServer(){var useCloud=esriConfig&&!!esriConfig.useESRICloud&&(parseInt(esriConfig.useESRICloud)===1),apiUrl=esriConfig&&esriConfig.jsapiurl;if(!useCloud&&apiUrl){apiUrl=apiUrl.trim();apiUrl=apiUrl.replace(/^.*:\/{2,}/,"");apiUrl=apiUrl.replace(/\/+$/,"");if(apiUrl){this.esriAPIServer="//"+apiUrl;return ;}}this.esriAPIServer="//"+$DEFAULT_ESRI_API_SERVER;},loadExternalScript:function loadScript(callBackFunc,mapCache){this.parseEsriAPIServer();this.loadJsScript(this.getURL(this.esriAPIServer+"/init.js"),callBackFunc,mapCache);},loadMainModule:function loadMainModule(){if(!window.dojo){this.loadMap(mstrmojo.esrimap);return ;}window.dojo.require("esri.map");window.dojo.require("esri.tasks.query");window.dojo.require("esri.arcgis.utils");var protocol=window.location.protocol;if(mstrApp.isSingleTier){protocol="http:";}var esriCssUrl=protocol+this.esriAPIServer+"/esri/css/esri.css";$MUTLS.loadCss("esricss",esriCssUrl);var claroUrl=protocol+this.esriAPIServer+"/dijit/themes/claro/claro.css";$MUTLS.loadCss("esriClaro",claroUrl);var me=this;window.dojo.addOnLoad(function(){var intervalId=window.setInterval(function(){window.clearInterval(intervalId);me.loadMap(mstrmojo.esrimap);},50);});}});}());