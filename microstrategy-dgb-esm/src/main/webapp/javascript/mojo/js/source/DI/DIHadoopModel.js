(function(){mstrmojo.requiresCls("mstrmojo.qb.QBuilderModel");var $WRAP=mstrmojo.func.wrapMethods,$ARR=mstrmojo.array;function submitRequest(callback,params,showWait){params.showWait=showWait;mstrApp.getRootController().getDataService().submitRequest(callback,params);}function populateURLPath(dbr){if(!dbr){return"";}var prefix="hdfs://";var postfix="/";if(dbr.hadoopnameservice){return prefix+dbr.hadoopnameservice+postfix;}else{if(dbr.hadoopname){if(dbr.hdfsport&&dbr.hdfsport!=8020){return prefix+dbr.hadoopname+":"+dbr.hdfsport+postfix;}else{return prefix+dbr.hadoopname+postfix;}}else{return prefix+postfix;}}}mstrmojo.DI.DIHadoopModel=mstrmojo.declare(mstrmojo.qb.QBuilderModel,null,{scriptClass:"mstrmojo.DI.DIHadoopModel",dbObjectsDisplayOptions:32,dbRolesTypeFilter:[5400],dbRolesVersionFilter:[218],dbmsTypeFilter:[5400],saveDBRole:function saveDBRole(dbRole,isNew,callback){submitRequest($WRAP({success:function success(res){mstrApp.dbRoleID=res.dbr.did;var db_role=[];$ARR.forEach(dbRole.connstr.split(";"),function(x){var arr=x.split("=");db_role[arr[0].trim().toLowerCase()]=arr[1];});mstrApp.hadoopConnURL=populateURLPath(db_role);}},callback),{skipSchemaIDCheck:true,taskId:"arch.saveDBRole",dbroleinfo:JSON.stringify(dbRole),showWait:true},true);}});mstrmojo.DI.DIHadoopModel.prototype.populateURLPath=populateURLPath;})();