(function(){mstrmojo.requiresCls("mstrmojo.Button","mstrmojo.DataGrid","mstrmojo.dom","mstrmojo.Editor","mstrmojo.RadioButton","mstrmojo.architect.ui.SQLInputBox","mstrmojo.warehouse.EnumNamespaceMode","mstrmojo.warehouse.ui.AvailableTablesTree","mstrmojo.warehouse.ui.NameSpacePullDown","mstrmojo.DI.DIHelpers");var $A=mstrmojo.array,$H=mstrmojo.hash,$CSS=mstrmojo.css,$DOM=mstrmojo.dom,$DIHELPER=mstrmojo.DI.DIHelpers,catalogModeSQL="1",catalogModeODBC="2",cacheModeFull="0",cacheModeTables="2",cacheModeNone="4",nsModeAll=mstrmojo.warehouse.EnumNamespaceMode.ALL,nsModeCurrent=mstrmojo.warehouse.EnumNamespaceMode.CURRENT,maxSelectCatalogModeLength=30,DssXmlPrivilegesUseDatabaseInstanceManager=57,maxPreviewLength=40,maxSqlLabelLength=78,suffixLength=3,suffix="...",CSS_PREFIX="mstrmojo-ar-catSQL",STR_TITLE=mstrmojo.desc(15173,"Edit Catalog Options"),STR_SELECT_CATALOG_MODE=mstrmojo.desc(15174,"Select Catalog Mode"),STR_CATALOG_MODE=mstrmojo.desc(15175,"Retrieval Mode"),STR_SQL=mstrmojo.desc(12263,"Data source SQL"),STR_ODBC=mstrmojo.desc(12264,"ODBC calls"),STR_CACHING=mstrmojo.desc(8368,"Caching"),STR_CACHING_TABLES=mstrmojo.desc(12265,"Table names only"),STR_CACHING_FULL_CATALOG=mstrmojo.desc(12266,"Table and column names"),STR_CACHING_NONE=mstrmojo.desc(2057,"None"),STR_CACHING_NOT_GUARANTEED=mstrmojo.desc(12267,"Cannot guarantee caching when using non-default SQL"),STR_CLOSE=mstrmojo.desc(221,"Cancel"),STR_EDIT_SQL_STATEMENT=mstrmojo.desc(15176,"Edit SQL Statement:"),STR_NS=mstrmojo.desc(12268,"Namespaces"),STR_NS_ALL=mstrmojo.desc(3524,"All"),STR_NS_CURRENT=mstrmojo.desc(12269,"Current only"),STR_SQL_FULL=mstrmojo.desc(12270,"Retrieve table and column names in the data source"),STR_SQL_NAMESPACES=mstrmojo.desc(15177,"Retrieve namespaces available in data source"),STR_SQL_TABLES=mstrmojo.desc(12271,"Retrieve tables available in the data source"),STR_SQL_COLUMNS=mstrmojo.desc(12272,"Retrieve columns available in the data source"),STR_PREVIEW=mstrmojo.desc(15178,"Preview Available Tables"),STR_OK=mstrmojo.desc(1442,"OK"),STR_RESET=mstrmojo.desc(1905,"Reset"),STR_APPLY=mstrmojo.desc(134,"Apply"),STR_APPLY_DEFAULT=mstrmojo.desc(12273,"Use default value"),sqlSectionTexts={namespace:STR_SQL_NAMESPACES,full:STR_SQL_FULL,table:STR_SQL_TABLES,column:STR_SQL_COLUMNS},EMPTY_PLACEHOLDER="##EMPTY##";var OPEN_SIZE;var sqlSectionArray;function trimSQL(sql){return sql.replace(/[ \n\r\t]/g,"");}function addEditSqlStatementTitle(){var sqlSection=new mstrmojo.Label({cssClass:CSS_PREFIX+"-sectionTitle",text:STR_EDIT_SQL_STATEMENT});this.contents.middlePanel.addChildren([sqlSection]);}function addSQLSection(defaultSQLs,currentSQLs,type){var sqlSection=new mstrmojo.Box({alias:"sqlBox",cssClass:CSS_PREFIX+"-sqlBox",defaultSQL:"",useDefaultSQL:function useDefaultSQL(){return(trimSQL(this.defaultSQL)===trimSQL(this.currentSQL));},currentSQL:"",resize:function resize(){var sqlInputNode=this.sqlText.domNode,h=$DOM.position(sqlInputNode).h,t=sqlInputNode.offsetTop,w=$DOM.position(sqlInputNode).w,c=this.curtain;c.domNode.style.height=h+"px";c.domNode.style.width=w+"px";c.domNode.style.top=t+"px";},children:[{scriptClass:"mstrmojo.HBox",alias:"sqlHead",cssClass:"sqlSection-box",children:[{scriptClass:"mstrmojo.Label",cssClass:CSS_PREFIX+"-sqlLabel",text:sqlSectionTexts[type].length>maxSqlLabelLength?sqlSectionTexts[type].substring(0,maxSqlLabelLength-suffixLength)+suffix:sqlSectionTexts[type],title:sqlSectionTexts[type],useRichTooltip:true,updateTooltipConfig:function(){updateTooltip.call(this);}},{scriptClass:"mstrmojo.CheckBox",cssClass:CSS_PREFIX+"-check",alias:"sqlCheck",index:type,label:STR_APPLY_DEFAULT,oncheckedChange:function oncheckedChange(){var box=this.parent.parent,editor=box.parent.parent.parent,sqlWrapper,str;box.curtain.set("visible",this.checked);editor.changeDirtyStat(true);if(this.checked){box.sqlText.setSQLStatement(box.defaultSQL);}else{if(!editor.loadingPanel){switch(editor.options.cacheMode.value){case cacheModeFull:str=STR_CACHING_FULL_CATALOG;break;case cacheModeTables:if(this.index==="column"){break;}str=STR_CACHING_TABLES;break;case cacheModeNone:break;}str!==undefined&&mstrmojo.alert(STR_CACHING_NOT_GUARANTEED,undefined,STR_CACHING+": "+str);}}sqlWrapper=box.sqlText.domNode.firstChild.firstChild.firstChild;sqlWrapper.style.overflowY=this.checked?"hidden":"auto";}}]},{scriptClass:"mstrmojo.architect.ui.SQLInputBox",cssClass:"mstrmojo-ar-sqlInput-inputbox visible "+CSS_PREFIX,alias:"sqlText",postBuildRendering:function(){mstrmojo.architect.ui.SQLInputBox.prototype.postBuildRendering.call(this);this.inputBox.handlekeyup=function(e){var editor=this.parent.parent.parent.parent.parent;mstrmojo.ME.TokenInputBox.prototype.handlekeyup.call(this,e);editor.changeDirtyStat(true);};}},{scriptClass:"mstrmojo.Label",cssClass:CSS_PREFIX+"-curtain",alias:"curtain"}]});this.contents.middlePanel.addChildren([sqlSection]);var sqlInput=sqlSection.sqlText;$CSS.toggleClass(sqlInput.domNode,"full",(this.options.cacheMode.value===cacheModeFull));$CSS.toggleClass(sqlInput.domNode,"full-column",(this.options.catalogMode.value===catalogModeODBC));sqlSection.resize();sqlSection.defaultSQL=defaultSQLs[$A.find(defaultSQLs,"tp",type)]?defaultSQLs[$A.find(defaultSQLs,"tp",type)].sql:"";sqlSection.currentSQL=currentSQLs[$A.find(currentSQLs,"tp",type)]?currentSQLs[$A.find(currentSQLs,"tp",type)].sql:"";if("namespace"===type){if(EMPTY_PLACEHOLDER===sqlSection.currentSQL){sqlSection.currentSQL=convertEmptyString(sqlSection.currentSQL);}}sqlInput.setSQLStatement(sqlSection.currentSQL);sqlSection.sqlHead.sqlCheck.checked=!sqlSection.useDefaultSQL();sqlSection.sqlHead.sqlCheck.set("checked",sqlSection.useDefaultSQL());return sqlSection;}function getSQL(defaultSQLs,currentSQLs,type,index){var editor=this,currentSQL,defaultSQL,sql;defaultSQL=defaultSQLs[$A.find(defaultSQLs,"tp",type)];currentSQL=currentSQLs[$A.find(currentSQLs,"tp",type)];sql=editor.contents.middlePanel.children[index].sqlText.getSQLStatement();if(defaultSQL===undefined&&type==="namespace"){return false;}if(sql===defaultSQL.sql){sql="";}currentSQL.sql=sql;return currentSQL;}function chooseSQLs(editor,nsMode,cacheMode,getCurrent){var currentSQLs,defaultSQLs;if((nsMode.value===nsModeAll)){currentSQLs=$H.cloneArray(editor.SQLStatements.currentSQLs.allNS);defaultSQLs=$H.cloneArray(editor.SQLStatements.defaultSQLs.allNS);if(cacheMode.value===cacheModeNone){if(editor.supportsNameSpaces){currentSQLs=$H.cloneArray(editor.SQLStatements.currentSQLs.allNS);defaultSQLs=$H.cloneArray(editor.SQLStatements.defaultSQLs.allNS);}}else{if(cacheMode.value===cacheModeTables){if(editor.supportsNameSpaces){var currentColSQL=$H.cloneArray(editor.SQLStatements.currentSQLs.allNS),defaultColSQL=$H.cloneArray(editor.SQLStatements.defaultSQLs.allNS);currentSQLs[$A.find(currentSQLs,"tp","column")]=currentColSQL[$A.find(currentColSQL,"tp","column")];defaultSQLs[$A.find(defaultSQLs,"tp","column")]=defaultColSQL[$A.find(defaultColSQL,"tp","column")];}}}}else{currentSQLs=$H.cloneArray(editor.SQLStatements.currentSQLs.currentNS);defaultSQLs=$H.cloneArray(editor.SQLStatements.defaultSQLs.currentNS);}if(getCurrent){return currentSQLs;}return defaultSQLs;}function updateTooltip(){var pos=$DOM.position(this.domNode);this.set("richTooltip",{cssClass:"vi-regular A-center vi-tooltip-A",top:Math.max(pos.y+pos.h*1.2,0),left:Math.max(pos.x+pos.w*0.5,0),posType:mstrmojo.tooltip.POS_TOPCENTER,content:this.title});}function addPreview(){var editor=this,sqlSection=new mstrmojo.Box({alias:"sqlPreviewBox",cssClass:CSS_PREFIX+"-sqlBox",children:[{scriptClass:"mstrmojo.Label",cssClass:CSS_PREFIX+"-sqlPreviewLabel",text:STR_PREVIEW.length>maxPreviewLength?STR_PREVIEW.substring(0,maxPreviewLength-suffixLength)+suffix:STR_PREVIEW,title:STR_PREVIEW,useRichTooltip:true,updateTooltipConfig:function(){updateTooltip.call(this);}},{scriptClass:"mstrmojo.Box",cssClass:CSS_PREFIX+"-preview",alias:"sqlPreviewContents",children:[new mstrmojo.warehouse.ui.NameSpacePullDown({alias:"nameSpaces",sourceInfo:"CatSQL",keepNamespacesVisible:true,catalogRefreshNS:function(){var controller=mstrApp.getRootController(),model=controller.model,applyBtn=editor.btnHbox.applyBtn;if(editor.isDirty){mstrmojo.confirm(mstrmojo.desc(15180,"Catalog SQL statement modification will be applied firstly before you preview catalog."),{confirmBtn:{fn:function(){applyBtn.onclick(function(){model.catalogRefresh=true;model.sourceInfo="CatSQL";controller.updateSelectedDBRoleId();});},t:mstrmojo.desc(134,"Apply")},cancelBtn:{fn:function(){}}},{title:mstrmojo.desc(15185,"Apply SQL statement")});}else{model.catalogRefresh=true;model.sourceInfo="CatSQL";controller.updateSelectedDBRoleId();}},nameSpacesLoaded:function(){if(this.parent.parent.parent){var editor=this.parent.parent.parent.parent.parent,nsMode=editor.options.nsMode;if(nsMode.value===nsModeAll){this.pulldown.set("items",[]);mstrApp.rootController.availableTableSearch("",{dbRoleID:editor.dbRole.did,nameSpace:"",getFresh:true,sourceInfo:"CatSQL"});}}},onItemSelectedCallback:function onItemSelectedCallback(item){editor.selectedNS=item.n;var applyBtn=editor.btnHbox.applyBtn;if(editor.isDirty&&item.n!==""){mstrmojo.confirm(mstrmojo.desc(15180,"Catalog SQL statement modification will be applied firstly before you preview catalog."),{confirmBtn:{fn:function(){applyBtn.onclick();},t:mstrmojo.desc(134,"Apply")},cancelBtn:{fn:function(){}}},{title:mstrmojo.desc(15185,"Apply SQL statement")});}else{if(editor.options.nsMode.value!==nsModeAll){mstrApp.rootController.availableTableSearch("",{dbRoleID:editor.dbRole.did,nameSpace:editor.selectedNS||"",getFresh:editor.isDirty,sourceInfo:"CatSQL"});}}},onvisibleChange:function(){var width=(this.domNode&&this.domNode.clientWidth)||parseInt(this.width,10);if(this.visible&&typeof width==="number"&&width>0){this.pulldown.set("width","144px");if(this.waitBoxTip){this.waitBoxTip.adjustCorners();}}}})]},{scriptClass:"mstrmojo.warehouse.ui.AvailableTablesTree",alias:"dbTableTree",cssClass:"mstrmojo-wh-AvailableTablesTree "+CSS_PREFIX+"-dbTablesTree",sourceInfo:"CatSQL",editor:editor,postCreate:function postCreate(){this.ondblclick=function(){};if(this.editor.options.catalogMode.value===catalogModeODBC){this.cssClass+="-none";}}}]});this.contents.rightPanel.addChildren([sqlSection]);}function radioButtonClick(){var i,count=this.parent.count,prefix=this.parent.prefix;if(this.checked){for(i=0;i<count;i++){this.parent[prefix+i].set("checked",false);}this.set("checked",true);}}function hasWriteAccess(editor){var dbr=$H.walk("dbRole.mdDBRole",editor);return $DIHELPER.isdbRoleWritable(dbr);}function hasUseAccess(editor){var dbr=$H.walk("dbRole.mdDBRole",editor);return dbr&&dbr.usable==="1";}function populateCentralPanel(){var editor=this,options=editor.options,middlePanel=editor.contents.middlePanel,rightPanel=editor.contents.rightPanel,SQLOptions,currentSQLs,defaultSQLs,sqlSection,nameSpaces;if(editor.loading){return ;}this.loadingPanel=true;middlePanel.removeChildren();addEditSqlStatementTitle.call(editor);currentSQLs=chooseSQLs(editor,options.nsMode,options.cacheMode,true);defaultSQLs=chooseSQLs(editor,options.nsMode,options.cacheMode,false);sqlSectionArray=[];sqlSectionArray.push(addSQLSection.call(editor,defaultSQLs,currentSQLs,"namespace"));if(options.catalogMode.value===catalogModeSQL){switch(options.cacheMode.value){case cacheModeFull:sqlSection=addSQLSection.call(editor,defaultSQLs,currentSQLs,"full");sqlSectionArray.push(sqlSection);break;case cacheModeTables:case cacheModeNone:sqlSectionArray.push(addSQLSection.call(editor,defaultSQLs,currentSQLs,"table"));sqlSectionArray.push(addSQLSection.call(editor,defaultSQLs,currentSQLs,"column"));break;default:break;}}rightPanel.sqlPreviewBox&&rightPanel.sqlPreviewBox.sqlPreviewContents.nameSpaces.destroy();rightPanel.removeChildren();addPreview.call(editor);nameSpaces=editor.contents.rightPanel.sqlPreviewBox.sqlPreviewContents.nameSpaces;nameSpaces.domNode.style.visibility=(editor.supportsNameSpaces?"":"hidden");nameSpaces.selectedIndex=undefined;editor.selectedNS=undefined;if(editor.supportsNameSpaces){if(editor.defaultOptions.nsMode.value===nsModeAll&&editor.options.nsMode.value===nsModeCurrent){nameSpaces.keepNamespacesIndexUnselectedBeforeLoading=true;}nameSpaces.pulldown.set("visible",true);nameSpaces.labelNS.set("visible",true);nameSpaces.set("visible",true);nameSpaces.btnRefreshNS.set("visible",true);}this.loadingPanel=false;var writable=hasWriteAccess(editor),usable=hasUseAccess(editor);editor.btnHbox.applyBtn.set("enabled",writable&&usable);editor.btnHbox.okBtn.set("enabled",writable&&usable);nameSpaces.btnRefreshNS.set("enabled",writable&&usable);}function convertEmptyString(str){var result;switch(str){case"":result=EMPTY_PLACEHOLDER;break;case EMPTY_PLACEHOLDER:result="";break;default:result=str;break;}return result;}mstrmojo.warehouse.ui.editors.CatalogSQLEditor=mstrmojo.declare(mstrmojo.Editor,[mstrmojo._FillsBrowser,mstrmojo._HasLayout],{scriptClass:"mstrmojo.warehouse.ui.editors.CatalogSQLEditor",cssClass:CSS_PREFIX,title:STR_TITLE,isDirty:false,changeDirtyStat:function(isDirty){this.isDirty=isDirty;this.btnHbox.applyBtn.set("enabled",hasWriteAccess(this)&&hasUseAccess(this)&&isDirty);},hasApplied:false,options:{},SQLStatements:[],onUpdateInfo:undefined,supportsNameSpaces:false,dbRole:undefined,sql:"",curtain:undefined,useDefaultSQL:undefined,contents:undefined,middlePanel:undefined,rightPanel:undefined,sqlPreviewBox:undefined,sqlPreviewContents:undefined,leftPanel:undefined,currentSQLs:undefined,defaultSQLs:undefined,catalogModeRBBox:undefined,catalogModeRB0:undefined,catalogModeRB1:undefined,cacheMode:undefined,nsMode:undefined,catalogMode:undefined,sqlCheck:undefined,allNS:undefined,currentNS:undefined,cacheModeRBBox:undefined,nsModeRBBox:undefined,nsModeRB1:undefined,applyBtn:undefined,okBtn:undefined,revertBtn:undefined,closeBtn:undefined,cbkOnClose:mstrmojo.emotyFn,browserResized:function browserResized(size){var width=parseInt(size.w,10);OPEN_SIZE=size;if(isNaN(width)||width<0||!this.domNode){return ;}if(width<948){width=1110;}else{if(width>1063){width=1110;}else{width=Math.ceil(width*0.95);}}this.domNode.children[0].style.width=width+"px";this.contents.middlePanel.domNode.style.width=(width-219-281)+"px";$A.forEach(sqlSectionArray,function(sqlSection){sqlSection.resize();});this.btnHbox.revertBtn.domNode.style.marginRight=(width-316)+"px";},collectOptions:function collectOptions(){var editor=this,options=editor.options,catalogMode=options.catalogMode,nsMode=options.nsMode,cacheMode=options.cacheMode,currentSQLs,defaultSQLs,SQLOptions=[];SQLOptions.push(catalogMode);SQLOptions.push(nsMode);SQLOptions.push(cacheMode);currentSQLs=chooseSQLs(editor,nsMode,cacheMode,true);defaultSQLs=chooseSQLs(editor,nsMode,cacheMode,false);var namespaceCurrentSQLObj=getSQL.call(editor,defaultSQLs,currentSQLs,"namespace",1);if(namespaceCurrentSQLObj!==false){if(false===editor.contents.middlePanel.children[1].sqlHead.sqlCheck.checked&&trimSQL(editor.contents.middlePanel.children[1].sqlText.getSQLStatement())===""){namespaceCurrentSQLObj.sql=convertEmptyString(namespaceCurrentSQLObj.sql);}SQLOptions.push(namespaceCurrentSQLObj);}if(options.catalogMode.value===catalogModeSQL){switch(cacheMode.value){case cacheModeFull:SQLOptions.push(getSQL.call(editor,defaultSQLs,currentSQLs,"full",2));break;case cacheModeTables:SQLOptions.push(getSQL.call(editor,defaultSQLs,currentSQLs,"table",2));SQLOptions.push(getSQL.call(editor,defaultSQLs,currentSQLs,"column",3));break;case cacheModeNone:SQLOptions.push(getSQL.call(editor,defaultSQLs,currentSQLs,"table",2));SQLOptions.push(getSQL.call(editor,defaultSQLs,currentSQLs,"column",3));break;}}return SQLOptions;},defaultOptions:undefined,applyOptions:function applyOptions(opt){var index,options=opt?opt:this.options,leftPanel=this.contents.leftPanel;var supportsDataSourceSQL=($A.find(mstrApp.rootController.getDBObjects().catalogDbTypes,"v",this.dbRole.mdDBRole.db_type)>=0);leftPanel.catalogModeRBBox.catalogModeRB0.set("enabled",supportsDataSourceSQL);if((options.catalogMode.value===catalogModeSQL)&&supportsDataSourceSQL){index=0;}else{index=1;}leftPanel.catalogModeRBBox["catalogModeRB"+index].set("checked",true);leftPanel.catalogModeRBBox["catalogModeRB"+index].onclick();leftPanel.nsModeRBBox.nsModeRB1.set("enabled",this.supportsNameSpaces);if(this.supportsNameSpaces){if(options.nsMode.value===cacheModeFull){index=0;}else{index=1;}}else{index=0;}leftPanel.nsModeRBBox["nsModeRB"+index].set("checked",true);leftPanel.nsModeRBBox["nsModeRB"+index].onclick();if(options.cacheMode.value===cacheModeFull){index=0;}else{if(options.cacheMode.value===cacheModeTables){index=1;}else{if(options.cacheMode.value===cacheModeNone){index=2;}}}leftPanel.cacheModeRBBox["cacheModeRB"+index].set("checked",true);leftPanel.cacheModeRBBox["cacheModeRB"+index].onclick();},checkSqlSection:function(){var editor=this,middlePanel=editor.contents.middlePanel,sqlSections=middlePanel.children.slice(1);$A.forEach(sqlSections,function(section,index){section.sqlHead.sqlCheck.set("checked",true);},editor);},onOpen:function onOpen(){var leftPanel=this.contents.leftPanel,index,node,top;this.loading=true;this.defaultOptions=$H.clone(this.options);this.applyOptions();this.hasApplied=false;this.selectedNS=undefined;this.loading=false;populateCentralPanel.call(this);node=this.domNode.children[0];top=parseInt(node.style.top,10);if(top<0){node.style.top="0px";}if(OPEN_SIZE){this.browserResized(OPEN_SIZE);$DOM.center(node);}this.changeDirtyStat(false);},onClose:function(){this.cbkOnClose.call(this);},children:[{scriptClass:"mstrmojo.HBox",alias:"contents",cssClass:"catsql-hbox",children:[{scriptClass:"mstrmojo.Box",cssClass:CSS_PREFIX+"-leftPanel",alias:"leftPanel",children:[{scriptClass:"mstrmojo.Label",cssClass:CSS_PREFIX+"-sectionTitle",text:STR_SELECT_CATALOG_MODE.length>maxSelectCatalogModeLength?STR_SELECT_CATALOG_MODE.substring(0,maxSelectCatalogModeLength-suffixLength)+suffix:STR_SELECT_CATALOG_MODE,title:STR_SELECT_CATALOG_MODE,useRichTooltip:true,updateTooltipConfig:function(){updateTooltip.call(this);}},{scriptClass:"mstrmojo.Label",cssClass:CSS_PREFIX+"-sectionSubTitle",text:STR_CATALOG_MODE},{scriptClass:"mstrmojo.Box",cssClass:CSS_PREFIX+"-sectionBox",count:2,prefix:"catalogModeRB",alias:"catalogModeRBBox",children:[{scriptClass:"mstrmojo.RadioButton",cssClass:CSS_PREFIX+"-option",label:STR_SQL,index:0,alias:"catalogModeRB0",onclick:function onclick(){radioButtonClick.call(this);},oncheckedChange:function oncheckedChange(){}},{scriptClass:"mstrmojo.RadioButton",cssClass:CSS_PREFIX+"-option",label:STR_ODBC,index:1,alias:"catalogModeRB1",onclick:function onclick(){radioButtonClick.call(this);},oncheckedChange:function oncheckedChange(){var editor=this.parent.parent.parent.parent;editor.changeDirtyStat(true);editor.options.catalogMode.value=(this.checked?catalogModeODBC:catalogModeSQL);populateCentralPanel.call(editor);}}]},{scriptClass:"mstrmojo.Label",cssClass:CSS_PREFIX+"-sectionSubTitle",text:STR_NS},{scriptClass:"mstrmojo.Box",cssClass:CSS_PREFIX+"-sectionBox",count:2,alias:"nsModeRBBox",prefix:"nsModeRB",children:[{scriptClass:"mstrmojo.RadioButton",cssClass:CSS_PREFIX+"-option",label:STR_NS_ALL,index:0,alias:"nsModeRB0",onclick:function onclick(){radioButtonClick.call(this);},oncheckedChange:function oncheckedChange(){if(!this.checked){return ;}var editor=this.parent.parent.parent.parent;editor.options.nsMode.value=nsModeAll;editor.changeDirtyStat(true);populateCentralPanel.call(editor);}},{scriptClass:"mstrmojo.RadioButton",cssClass:CSS_PREFIX+"-option",label:STR_NS_CURRENT,index:1,alias:"nsModeRB1",onclick:function onclick(){radioButtonClick.call(this);},oncheckedChange:function oncheckedChange(){if(!this.checked){return ;}var editor=this.parent.parent.parent.parent;editor.options.nsMode.value=nsModeCurrent;editor.changeDirtyStat(true);populateCentralPanel.call(editor);}}]},{scriptClass:"mstrmojo.Label",cssClass:CSS_PREFIX+"-sectionSubTitle",text:STR_CACHING},{scriptClass:"mstrmojo.Box",cssClass:CSS_PREFIX+"-sectionBox",count:3,alias:"cacheModeRBBox",prefix:"cacheModeRB",children:[{scriptClass:"mstrmojo.RadioButton",cssClass:CSS_PREFIX+"-option",label:STR_CACHING_FULL_CATALOG,index:0,alias:"cacheModeRB0",onclick:function onclick(){radioButtonClick.call(this);},oncheckedChange:function oncheckedChange(){if(!this.checked){return ;}var editor=this.parent.parent.parent.parent;editor.changeDirtyStat(true);editor.options.cacheMode.value=cacheModeFull;populateCentralPanel.call(editor);}},{scriptClass:"mstrmojo.RadioButton",cssClass:CSS_PREFIX+"-option",label:STR_CACHING_TABLES,index:1,alias:"cacheModeRB1",onclick:function onclick(){radioButtonClick.call(this);},oncheckedChange:function oncheckedChange(){if(!this.checked){return ;}var editor=this.parent.parent.parent.parent;editor.changeDirtyStat(true);editor.options.cacheMode.value=cacheModeTables;populateCentralPanel.call(editor);}},{scriptClass:"mstrmojo.RadioButton",cssClass:CSS_PREFIX+"-option",label:STR_CACHING_NONE,index:2,alias:"cacheModeRB2",onclick:function onclick(){radioButtonClick.call(this);},oncheckedChange:function oncheckedChange(){if(!this.checked){return ;}var editor=this.parent.parent.parent.parent;editor.changeDirtyStat(true);editor.options.cacheMode.value=cacheModeNone;populateCentralPanel.call(editor);}}]}]},{scriptClass:"mstrmojo.Box",cssClass:CSS_PREFIX+"-middlePanel",alias:"middlePanel",children:[]},{scriptClass:"mstrmojo.Box",cssClass:CSS_PREFIX+"-rightPanel",alias:"rightPanel",children:[]}]}],buttons:[{scriptClass:"mstrmojo.Button",cssClass:"mstrmojo-WebButton "+CSS_PREFIX+"-button mstrmojo-ar-catSQL-revertBtn",text:STR_RESET,alias:"revertBtn",onclick:function onclick(){var editor=this.parent.parent;mstrmojo.confirm(mstrmojo.desc(15181,"Do you want to revert all modifications to default value?"),{confirmBtn:{hot:false,fn:function(){var defaultOptions=editor.defaultOptions;editor.applyOptions(defaultOptions);editor.checkSqlSection();}},cancelBtn:{fn:function(){}}},{title:mstrmojo.desc(15182,"Revert to Default Value")});}},{scriptClass:"mstrmojo.Button",cssClass:"mstrmojo-WebButton "+CSS_PREFIX+"-button",text:STR_APPLY,alias:"applyBtn",enabled:false,onclick:function onclick(callback){var editor=this.parent.parent,SQLOptions=editor.collectOptions();dbr=editor.dbRole.mdDBRole;if(hasWriteAccess(editor)){editor.onUpdateInfo({options:SQLOptions,callback:function(){if(editor.selectedNS){mstrApp.rootController.availableTableSearch("",{dbRoleID:editor.dbRole.did,nameSpace:editor.selectedNS||"",getFresh:editor.isDirty,sourceInfo:"CatSQL"});}editor.changeDirtyStat(false);editor.hasApplied=true;typeof callback==="function"&&callback();}});}else{return ;}}},{scriptClass:"mstrmojo.Button",cssClass:"mstrmojo-WebButton "+CSS_PREFIX+"-button",text:STR_OK,alias:"okBtn",onclick:function onclick(){var btnGrp=this.parent,editor=btnGrp.parent;if(editor.isDirty){btnGrp.applyBtn.onclick(function(){btnGrp.closeBtn.onclick();});}else{btnGrp.closeBtn.onclick();}}},{scriptClass:"mstrmojo.Button",cssClass:"mstrmojo-WebButton "+CSS_PREFIX+"-closeBtn",text:STR_CLOSE,alias:"closeBtn",onclick:function onclick(){var editor=this.parent.parent,closeFn=function closeFn(){$A.forEach(editor.contents.rightPanel.sqlPreviewBox.dbTableTree.items,function(dbTable){delete dbTable.items;});editor.close();};if(editor.isDirty){mstrmojo.confirm(mstrmojo.desc(15183,"The SQL statement modification has not been saved applied, do you still want to leave and discard the SQL modification?"),{confirmBtn:{t:mstrmojo.desc(15186,"Leave"),hot:false,fn:function(){closeFn();}},cancelBtn:{t:mstrmojo.desc(221,"Cancel"),fn:function(){}}},{title:mstrmojo.desc(15184,"Discard SQL modification")});}else{closeFn();}}}]});}());