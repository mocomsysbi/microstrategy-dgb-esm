(function(){mstrmojo.requiresCls("mstrmojo.ui.ScrollableList","mstrmojo.color","mstrmojo.css","mstrmojo.array");var $CSS=mstrmojo.css,$ARR=mstrmojo.array,$COLOR=mstrmojo.color,$FORMAT_MODEL=mstrmojo.models.FormatModel,$ENUM_FORMAT_PROPERTIES=$FORMAT_MODEL.ENUM_PROPERTY_NAMES,DEFAULT_BG="transparent",DEFAULT_TEXT="#000000",DEFAULT_BG_SELECTED="#2f9ad3",DEFAULT_TEXT_SELECTED="#ffffff",itemMarkup,DATA_TIP,preMouseMoveTarget;function isLinkBar(){return this.docSelector.style===mstrmojo.DocSelector.STYLES.LINK;}function isHorizontal(){return(this.isHoriz&&(this.orientation!=="v"))||(!this.isHoriz&&this.orientation==="h");}function setElementStyle(el,stateName){if(isLinkBar.call(this)){var elStyle=el.style,styles=this.stateCssText[stateName];elStyle.background=styles.bg;elStyle.color=styles.text;}}function assignNodeWidths(){if(this.itemWidthMode===1){var itemNodes=Array.prototype.slice.call(this.itemsContainerNode.childNodes);if(itemNodes.length>0&&itemNodes.length<100){var fnUpdateStyle=mstrmojo.emptyFn;if(this.isHoriz){var me=this,widths=itemNodes.map(function(node){return node.offsetWidth;}),total=widths.reduce(mstrmojo.array.fnReduceNumber);this.scaleConst=(this.domNode.clientWidth-(itemNodes.length-1)*(isLinkBar.call(this)?this.itemGap:0))/total;if(total>0){fnUpdateStyle=function(nodeStyle,idx,linkListContext){var nodeWidth=widths[idx];nodeStyle.minWidth=nodeWidth+"px";nodeStyle.width=nodeWidth*linkListContext.scaleConst+"px";};}}else{fnUpdateStyle=function(nodeStyle){nodeStyle.minWidth=nodeStyle.width="auto";};}itemNodes.forEach(function(node,idx){fnUpdateStyle(node.style,idx,me);});}}}function displayInfo(text){var container=this.domNode,content=document.createElement("div");$CSS.addClass(content,"content");content.innerText=text;container.style.display="flex";container.innerHTML="";container.appendChild(content);}function toggle(show){this.toggle(show);var style=this.domNode.style;if(style.display==="block"){style.display="flex";}}mstrmojo.vi.ui.rw.selectors.LinkList=mstrmojo.declare(mstrmojo.ui.ScrollableList,null,{scriptClass:"mstrmojo.vi.ui.rw.selectors.LinkList",markupString:'<div id="{@id}" class="mstrmojo-ListBase {@cssClass}" style="{@cssText}" mstrAttach:click,dblclick,mousemove,mouseover,mouseout,contextmenu><div class="list-content"><div class="items-container {@icnCss}" style="{@icnCssText}">{@itemsHtml}</div></div></div>',renderOnScroll:true,itemGap:1,init:function init(props){this._super(props);$CSS.addWidgetCssClass(this,"mstrmojo-vi-sel-LinkList");if(isHorizontal.call(this)&&this.itemWidthMode===0){$CSS.addWidgetCssClass(this,"mstrmojo-vi-sel-LinkList-iwm");}if(!DATA_TIP){DATA_TIP=new mstrmojo.VisTooltip({widgetClass:"LinkList-Vis-Tooltip"});DATA_TIP.hide();DATA_TIP.render();}},listHooks:{select:function(el){setElementStyle.call(this,el,"selected");},unselect:function(el){setElementStyle.call(this,el,"base");}},onmousemove:function(e){var t=e.getTarget();if(!t||$ARR.indexOf(t.classList,"item-wrapper")===-1){toggle.call(DATA_TIP);return ;}var position={x:e.e.pageX,y:e.e.pageY};toggle.call(DATA_TIP,true);DATA_TIP.moveTo(position.x,position.y);if(preMouseMoveTarget===t){return ;}preMouseMoveTarget=t;if(!DATA_TIP.domNode.parentNode){document.body.appendChild(DATA_TIP.domNode);}displayInfo.call(DATA_TIP,t[t.innerText!==undefined?"innerText":"textContent"]);},onmouseout:function(e){DATA_TIP.hide();preMouseMoveTarget=null;},getItemMarkup:function getItemMarkup(item,idx){if(mstrmojo.string.isEmpty(item.n)){return this._super(item,idx).replace("{@en@n}",'<div class="item-wrapper">&nbsp;</div>');}if(!itemMarkup){itemMarkup=this._super(item,idx).replace("{@en@n}",'<div class="item-wrapper">{@en@n}</div>');}return itemMarkup;},getItemProps:function getItemProps(item,idx){var props=this._super(item,idx),isHoriz=isHorizontal.call(this),itemCnt=this.items.length,isLastItem=idx===itemCnt-1;if(isLinkBar.call(this)){var stateCssText=this.stateCssText,styles=props.sel?stateCssText.selected:stateCssText.base;props.addStyle("background:"+styles.bg+";color:"+styles.text);if(isHoriz&&!isLastItem){props.addStyle("margin-right:"+this.itemGap+"px");}}if(this.itemWidthMode===0){props.addCls("equal-width");if(isHoriz){var width=100/itemCnt;if(isLastItem){width=100-((itemCnt-1)*width);}if(isLinkBar.call(this)){props.addStyle("width:calc("+width+"% - "+this.itemGap+"px)");}else{props.addStyle("width:"+width+"%");}}}return props;},preBuildRendering:function preBuildRendering(){if(isLinkBar.call(this)){var docSelector=this.docSelector,fmts=docSelector.getFormats(),defaultBg=this.getPropertyDefaultValue($ENUM_FORMAT_PROPERTIES.SELECTOR_SELECTION_COLOR)||DEFAULT_BG_SELECTED,defaultColor=this.getPropertyDefaultValue($ENUM_FORMAT_PROPERTIES.COLOR)||DEFAULT_TEXT_SELECTED,selectedBg=docSelector.defn.ssc!==undefined?$FORMAT_MODEL.decodeValue($ENUM_FORMAT_PROPERTIES.SELECTOR_SELECTION_COLOR,docSelector.defn.ssc):defaultBg;this.stateCssText={base:{bg:fmts["background-color"]||DEFAULT_BG,text:fmts.color||DEFAULT_TEXT},selected:{bg:selectedBg,text:$COLOR.encodeColor(selectedBg)===$COLOR.encodeColor(defaultBg)?defaultColor:$COLOR.getContrastingColor(selectedBg,"#ffffff","#000000")}};}return this._super();},postBuildRendering:function postBuildRendering(){if(!isLinkBar.call(this)){$CSS.addClass(this.domNode,"buttons");}assignNodeWidths.call(this);return this._super();},onclick:function(evt){var item=this.getItemFromTarget(evt.getTarget());if(item){this.doItemSelect(item,evt||{});}},getPropertyDefaultValue:function(propName){var theme=mstrApp.getThemeClassName(),v=null;switch(propName){case $ENUM_FORMAT_PROPERTIES.SELECTOR_SELECTION_COLOR:v=theme==="mojo-theme-light"?"#34ABEB":"#34ABEB";break;case $ENUM_FORMAT_PROPERTIES.COLOR:v=theme==="mojo-theme-light"?"#444649":"#ffffff";break;}return v;},updateScrollbars:function updateScrollbars(){if(this.hasRendered&&this.orientation==="v"){this.scrollboxNode.style.height=this.height;}this._super();}});mstrmojo._HasMarkup.addMarkupMethods(mstrmojo.vi.ui.rw.selectors.LinkList,{onorientationChange:function(){assignNodeWidths.call(this);}});}());