(function(){mstrmojo.requiresCls("mstrmojo.array","mstrmojo.hash","mstrmojo.mstr.EnumDSSXMLObjectTypes","mstrmojo.mstr.EnumDSSXMLObjectSubTypes","mstrmojo.vi.ui.editors.FilterEditor");mstrmojo.requiresDescs(5758,16037);var ARR=mstrmojo.array,HASH=mstrmojo.hash,OBJECT_TYPE=mstrmojo.mstr.EnumDSSXMLObjectTypes,OBJECT_SUB_TYPE=mstrmojo.mstr.EnumDSSXMLObjectSubTypes;mstrmojo.ME._HasConditionMetricFilterEditor=mstrmojo.provide("mstrmojo.ME._HasConditionMetricFilterEditor",{openConditionMetricFilterEditor:function openConditionMetricFilterEditor(config){var editorId="cmfe",filterEditor,targetMap={},filter=config.filter;function showEditor(){ARR.forEach(config.att,function(unit){if(unit.t!==OBJECT_TYPE.Attribute||unit.da){return ;}var did=unit.did,path=unit.path;targetMap[did]={did:did,n:unit.n,t:unit.t,st:unit.st,fs:unit.fs,da:unit.da||false,datasetId:unit.datasetId,ttp:unit.n+(path?" - "+path:""),dsName:path};});ARR.forEach(config.mx,function(unit){var did=unit.did,path=unit.path;targetMap[did]={did:did,n:unit.n,t:unit.t,st:unit.st||OBJECT_SUB_TYPE.Metric,um:unit.um,datasetId:unit.datasetId,ttp:unit.n+(path?" - "+path:""),dsName:path};});var filterModel={expr:HASH.clone(filter),targets:HASH.valarray(targetMap)};filterEditor=editorId&&window.mstrmojo&&mstrmojo.all[editorId];if(!filterEditor){filterEditor=mstrmojo.insert({id:editorId,scriptClass:"mstrmojo.vi.ui.editors.FilterEditor",showLimits:false,docModel:config.docModel,title:mstrmojo.desc(11579,"Metric Editor")+" - "+mstrmojo.desc(16037,"Add Filter")});}if(config.zIndex){filterEditor.set("zIndex",config.zIndex);}filterEditor.set("model",filterModel);filterEditor.targetMap=targetMap;filterEditor.onSave=config.fnOk;filterEditor.onCancel=config.onCancel;filterEditor.onUpdateBrowseElementsParams=config.browseParam;filterEditor.open();}showEditor();}});}());