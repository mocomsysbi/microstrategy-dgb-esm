(function(){mstrmojo.requiresCls("mstrmojo.ui.editors.RenameEditor","mstrmojo.func");var $FUNC=mstrmojo.func;mstrmojo.vi.ui.editors.RenameDEEditor=mstrmojo.declare(mstrmojo.ui.editors.RenameEditor,null,{scriptClass:"mstrmojo.vi.ui.editors.RenameDEEditor",showSetParent:false,preBuildRendering:function preBuildRendering(){if(this.showSetParent){this.renameBox.layoutConfig.w.col1Node="100px";this.addChildren({scriptClass:"mstrmojo.ui.editors.controls.TwoColumnContainer",cssClass:"setParentBox",width:"264px",col1Width:"100px",col2Width:"100%",alias:"setParentBox",children:[{scriptClass:"mstrmojo.Label",text:mstrmojo.desc(14743,"Set Parent As:"),slot:"col1Node"},{scriptClass:"mstrmojo.ui.Pulldown",slot:"col2Node",alias:"setParent",getLayoutOffsets:function getLayoutOffsets(){return{h:0,w:2};}}]},1);}this.addChildren({scriptClass:"mstrmojo.Widget",slot:"buttonNode",alias:"btnNotifier",markupString:"<div class='mstrmojo-btnNotifier'><div class='vfNotifier'><div></div><div>"+mstrmojo.desc(15430,"The visualization filter selections will be cleared if you continue.")+"</div></div></div>"});return this._super();},onRename:function onRename(renameText){var valid=mstrmojo.vi.ui.editors.DerivedElementsEditor.validateElementName(renameText);if(valid){var view=this.view,docModel=view.model.docModel,action=this.action,controller=this.controller,actions=[],callbacks={},extras={};action.deName=(renameText)||((action.funcVal===-1)?mstrmojo.desc(5187,"Group"):mstrmojo.desc(5188,"Calculation"));if(this.showSetParent){var parent=this.setParentBox.setParent.getSelectedItem();if(parent){action.peId=parent.id;action.peName=parent.n;action.peLevel=parent.level;}}docModel.addUpdateObjects(action,{id:action.oId,type:action.oTp,flag:mstrmojo.DocDataService.PARTIAL_UPDATE_FLAGS.DATA_CHANGE});actions.push(controller.dataService().getUpdateTemplateAction(view.k,action));if(docModel.hasSelectionOnVisFilter()&&action.act!=="editQuickDECalculation"){actions=docModel.wrapUnsetVisualizationFilterAction(actions);docModel.clearSelectionOnVisFilter(true);}callbacks=$FUNC.wrapMethods(callbacks,docModel.getDatasetsUpdateCallback(),controller._getXtabCallback(view),docModel.getUpdateHiddenPanelsCallback(),docModel.getUpdateHiddenLayoutsCallback(),docModel.getHighLightNDECallback());if(action.isRA){extras=mstrmojo.DocDataService.REQUEST_DEFN_DATA;}controller.submitUndoRedoUpdates(actions,{},callbacks,extras);}return valid;},onOpen:function onOpen(){this.toggleNotifier();},toggleNotifier:function(){var view=this.view,action=this.action,model=view&&view.model&&view.model.docModel,show=model&&model.hasSelectionOnVisFilter&&model.hasSelectionOnVisFilter();if(show&&action){show=action.act!=="editQuickDECalculation";}this.btnNotifier.domNode.style.display=!!show?"block":"none";},destroy:function destroy(ignoreDOM){delete this.view;delete this.action;delete this.controller;this._super(ignoreDOM);}});}());