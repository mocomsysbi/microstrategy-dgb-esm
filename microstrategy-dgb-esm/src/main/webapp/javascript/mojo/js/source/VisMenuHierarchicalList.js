(function(){mstrmojo.requiresClsP("mstrmojo","ListBase","_IsList","css","array");var $CSS=mstrmojo.css;var INITIAL_INDENT=0;var LEVEL_INDENT=15;var CSS_COLLAPSED="collapsed";var CSS_EXPENDED="expanded";var CSS_HIDDEN="hidden";mstrmojo.VisMenuHierarchicalList=mstrmojo.declare(mstrmojo.ListBase,[mstrmojo._IsList],{scriptClass:"mstrmojo.VisMenuHierarchicalList",prevSelection:{},itemField:"v",selectionPolicy:"toggle",multiSelect:false,init:function init(props){this._super(props);var me=this;},onRender:function onRender(){this.collapseAll();},getItemProps:function getItemProps(item,idx){var props=this._super(item,idx);props.tag="a";props.addCls("mstrmojo-ui-Menu-item");props.addCls("hierarachy");if(!item.isLeaf){var markType=item.collapsed?CSS_COLLAPSED:CSS_EXPENDED;props.addCls(markType);}if(!item.initVisible){props.addCls(CSS_HIDDEN);}props.indent=item.level*LEVEL_INDENT+INITIAL_INDENT;return props;},getItemMarkup:function getItemMarkup(item,idx){return'<{@tag} class="item {@cls}" idx="{@idx}" style="{@style}" title="{@tt}"><span class="indent" style="padding-left: {@indent}px;"></span><span class="mark" style="position: static;"></span><span class="">{@en@n}</span></{@tag}>';},onselectionChange:function onselectionChange(evt){this._super(evt);this.parent.data.set("valid",true);},doItemSelect:function doItemSelect(item,evt){if(item.isLeaf){this._super(item,evt);}else{var el=this._getItemNode(item._renderIdx);item.collapsed=!item.collapsed;if(item.collapsed){$CSS.addClass(el,CSS_COLLAPSED);$CSS.removeClass(el,CSS_EXPENDED);}else{$CSS.addClass(el,CSS_EXPENDED);$CSS.removeClass(el,CSS_COLLAPSED);}this.collapseChildren(item,item.collapsed);if(this.parent.adjustCornersForPopupOverflow){this.parent.adjustCornersForPopupOverflow();}if(this.parent.updateScrollbars){this.parent.updateScrollbars();}}},collapseChildren:function collapseChildren(item,forceCollpase){var me=this;(item.children||[]).forEach(function(child){if(forceCollpase){me.setVisible(child,false);}else{me.setVisible(child,true);}me.collapseChildren(child,forceCollpase||child.collapsed);});},setVisible:function setVisible(item,visible){var el=this._getItemNode(item._renderIdx);$CSS.toggleClass(el,CSS_HIDDEN,!visible);},collapseAll:function collapseAll(){var me=this;var items=this.items;if(items){items.forEach(function(item){if(!item.isLeaf){var el=me._getItemNode(item._renderIdx);item.collapsed=true;$CSS.addClass(el,CSS_COLLAPSED);$CSS.removeClass(el,CSS_EXPENDED);me.collapseChildren(item,item.collapsed);}});}},});}());