(function(){mstrmojo.requiresCls("mstrmojo.css","mstrmojo.Popup","mstrmojo.CheckBox","mstrmojo.gmaps.MapEnums");var $MOJO=mstrmojo,$CSS=$MOJO.css,$GMAPS=$MOJO.gmaps,$EnumPropertyType=$GMAPS.EnumPropertyType;mstrmojo.gmaps.MapMoreControls=mstrmojo.declare(mstrmojo.Popup,[mstrmojo._HasPopup],{scriptClass:"mstrmojo.gmaps.MapMoreControls",cssClass:"moreCtrlBox",sourceToolbar:null,maxHeight:null,alias:"moreCtrlBox",slot:"popupNode",locksHover:true,autoCloses:true,onOpen:function onOpen(){var sourceToolbar=this.sourceToolbar,moreCtrlNode=sourceToolbar&&sourceToolbar.moreCtrlNode,parent=this.parent;if(!moreCtrlNode||!parent){return ;}$CSS.addClass(moreCtrlNode,"open");parent.set("useRichTooltip",false);var mapViewer=sourceToolbar.parent,canShowLegend=false,isLegendShown=false,canLayerShowLegend;mapViewer.forEachGraphicLayer(function(graphicLayer){canLayerShowLegend=graphicLayer.canShowLegend();isLegendShown=isLegendShown||(canLayerShowLegend&&graphicLayer.needShowLegend());canShowLegend=canShowLegend||canLayerShowLegend;},false,true);if(canShowLegend){$CSS.removeClass(this.legendCtrl.domNode,"disabled");this.legendCtrl.set("checked",isLegendShown);}else{$CSS.addClass(this.legendCtrl.domNode,"disabled");this.legendCtrl.domNode.firstChild.disabled=true;}var vismap=sourceToolbar&&sourceToolbar.map,isTooltipShown=vismap&&vismap.getPropertyValue($EnumPropertyType.tooltipSwitch);this.tooltipCtrl.set("checked",isTooltipShown!=="false");},onClose:function onClose(){var sourceToolbar=this.sourceToolbar,parent=this.parent,moreCtrlNode=sourceToolbar&&sourceToolbar.moreCtrlNode;if(!moreCtrlNode){return ;}$CSS.removeClass(moreCtrlNode,"open");parent.set("useRichTooltip",true);this.destroy();},children:[{alias:"legendCtrl",scriptClass:"mstrmojo.CheckBox",label:mstrmojo.desc(12001,"Show Legend"),align:"left",cssDisplay:"block",checked:false,onclick:function(){var me=this.parent,sourceToolbar=me.sourceToolbar,map=sourceToolbar&&sourceToolbar.map,checked=this.checked;if(!map){return ;}map.handleShowAllLegends(checked);this.set("checked",checked);}},{alias:"tooltipCtrl",scriptClass:"mstrmojo.CheckBox",label:mstrmojo.desc(15859,"Enable Tooltips"),align:"left",cssDisplay:"block",checked:true,onclick:function(){var me=this.parent,sourceToolbar=me.sourceToolbar,map=sourceToolbar&&sourceToolbar.map,checked=this.checked;if(!map){return ;}map.writeProperties($EnumPropertyType.tooltipSwitch,checked.toString());this.set("checked",checked);}}],destroy:function destroy(ignoreDom){var pr=this.popupRef;if(this.popupToBody&&pr.hasRendered){pr.unrender(false);}delete this.sourceToolbar;this._super(ignoreDom);}});}());