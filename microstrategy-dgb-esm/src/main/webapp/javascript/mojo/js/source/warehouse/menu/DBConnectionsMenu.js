(function(){mstrmojo.requiresCls("mstrmojo.Obj","mstrmojo.architect.menu.ArchitectMenu","mstrmojo.architect.menu.EnumMenuActions","mstrmojo.DI.DIHelpers","mstrmojo.array");mstrmojo.requiresDescs(1088,629,9099,1388,3397,12259,11425,4572,15173);var $H=mstrmojo.DI.DIHelpers,$A=mstrmojo.array;var $MNU_ACTIONS=mstrmojo.architect.menu.EnumMenuActions,ENUM_ACTION_NONE=$MNU_ACTIONS.NONE,ENUM_ACTION_EDIT=$MNU_ACTIONS.EDIT,ENUM_ACTION_DELETE=$MNU_ACTIONS.DELETE,ENUM_ACTION_RENAME=$MNU_ACTIONS.RENAME,ENUM_ACTION_DUPLICATE=$MNU_ACTIONS.DUPLICATE,ENUM_ACTION_CATALOG_SQL=$MNU_ACTIONS.CATALOG_SQL,ENUM_ACTION_SET_AS_PRIMARY=$MNU_ACTIONS.SET_AS_PRIMARY,ENUM_ACTION_IS_PRIMARY=$MNU_ACTIONS.IS_PRIMARY,ENUM_ACTION_SHARE=$MNU_ACTIONS.SHARE,STR_EDIT=mstrmojo.desc(1088,"Edit"),STR_DELETE=mstrmojo.desc(629,"Delete"),STR_RENAME=mstrmojo.desc(1388,"Rename"),STR_DUPLICATE=mstrmojo.desc(3397,"Duplicate"),STR_CATALOG_SQL=mstrmojo.desc(15173,"Edit Catalog Options"),STR_SET_AS_PRIMARY=mstrmojo.desc(11425,"Set as Primary"),STR_PRIMARY=mstrmojo.desc(4572,"Primary");function ACLPermissionsFilter(item,me){var visable;switch(item.action){case ENUM_ACTION_RENAME:visable=parseInt(me.writable,10);break;case ENUM_ACTION_SHARE:visable=parseInt(me.controllable,10);break;case ENUM_ACTION_DELETE:visable=parseInt(me.deletable,10);break;default:visable=true;}return !!visable;}mstrmojo.warehouse.menu.DBConnectionsMenu=mstrmojo.declare(mstrmojo.architect.menu.ArchitectMenu,null,{scriptClass:"mstrmojo.architect.menu.DBConnectionsMenu",cm:[{action:ENUM_ACTION_EDIT,n:STR_EDIT,icn:"edt"},{action:ENUM_ACTION_DELETE,n:STR_DELETE,icn:"del"},{action:ENUM_ACTION_RENAME,n:STR_RENAME,icn:"rnm"},{action:ENUM_ACTION_SHARE,n:mstrmojo.desc(9099,"Share")},{action:ENUM_ACTION_DUPLICATE,n:STR_DUPLICATE},{action:ENUM_ACTION_SET_AS_PRIMARY,n:STR_SET_AS_PRIMARY},{action:ENUM_ACTION_NONE},{action:ENUM_ACTION_IS_PRIMARY,n:STR_PRIMARY},{action:ENUM_ACTION_NONE},{action:ENUM_ACTION_CATALOG_SQL,n:STR_CATALOG_SQL,icn:"catsql"}],isManaged:undefined,readable:"1",writable:"1",controllable:"1",deletable:"1",postCreate:function(){var $this=this;if(!$H.isOnetier()){$this.cm=$A.filter($this.cm,function(item){return ACLPermissionsFilter(item,$this);});}$this.cm=$A.map($this.cm,function(item){if($this.isManagedDBR){if(item.action===ENUM_ACTION_DUPLICATE){return{action:ENUM_ACTION_DUPLICATE,n:STR_DUPLICATE,isManaged:true};}else{if(item.action===ENUM_ACTION_SHARE){return{action:ENUM_ACTION_SHARE,n:mstrmojo.desc(9099,"Share"),isManaged:true};}}}if(item.action===ENUM_ACTION_CATALOG_SQL){return{action:ENUM_ACTION_CATALOG_SQL,n:STR_CATALOG_SQL,readable:parseInt($this.readable,10)};}return item;});},executeCommand:function executeCommand(item){var data=this.data,rootController=mstrApp.getRootController();switch(item.action){case ENUM_ACTION_EDIT:rootController.editDBRole(data);break;case ENUM_ACTION_RENAME:rootController.renameDBRole(data);break;case ENUM_ACTION_DELETE:rootController.deleteDBRole(data);break;case ENUM_ACTION_DUPLICATE:rootController.duplicateDBRole(data);break;case ENUM_ACTION_SET_AS_PRIMARY:rootController.setProjectPrimaryDBRole(data);break;case ENUM_ACTION_CATALOG_SQL:rootController.model.SelDBRoleID=data.did;rootController.displayCatalogSQL(data.did);break;case ENUM_ACTION_SHARE:if($H.isServerBasedWS()){var params={taskId:"openNativeWindow",did:data.did,windowType:2};mstrApp.serverRequest(params,{},false);}else{if(rootController.shareDBRole){rootController.shareDBRole(data);}}break;}}});}());