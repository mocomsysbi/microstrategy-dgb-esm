(function(){mstrmojo.requiresCls("mstrmojo.vi.ui.tabs.TabStrip","mstrmojo.vi.ui._HasMask","mstrmojo.vi.ui.tabs.Tab","mstrmojo.hash","mstrmojo.dom","mstrmojo.css","mstrmojo.string","mstrmojo.vi.controllers.EnumLayoutSelectorPosition");mstrmojo.requiresDescs(3687,4780,14919,13768);var $HASH=mstrmojo.hash,$DOM=mstrmojo.dom,$CSS=mstrmojo.css,$STR=mstrmojo.string,ENUM_ACTIONS=mstrmojo.vi.ui.tabs.Tab.ACTIONS,MENU_ACTIONS=ENUM_ACTIONS.DELETE+ENUM_ACTIONS.DUPLICATE+ENUM_ACTIONS.MOVE+ENUM_ACTIONS.RENAME+ENUM_ACTIONS.NEW_TAB,LAYOUT_SELECTOR_POSITION=mstrmojo.vi.controllers.EnumLayoutSelectorPosition,BUTTON_BAR_WIDTH=144,ADD_BUTTON_WIDTH=90,NAV_BUTTONS_WIDTH=52,BUFFER_WIDTH=6,ADJUSTED_WIDTH=2;mstrmojo.vi.ui.tabs.PanelTabStrip=mstrmojo.declare(mstrmojo.vi.ui.tabs.TabStrip,[mstrmojo.vi.ui._HasMask],{scriptClass:"mstrmojo.vi.ui.tabs.PanelTabStrip",cssClass:"mstrmojo-PanelTabStrip",docModel:null,isAlignRight:false,alignPosition:LAYOUT_SELECTOR_POSITION.LEFT,selectMovedTab:true,hasFloater:true,markupMethods:{onalignPositionChange:function(){$CSS.toggleClass(this.domNode,"alignTop",this.alignPosition===LAYOUT_SELECTOR_POSITION.TOP);this.visible=this.alignPosition===LAYOUT_SELECTOR_POSITION.LEFT?false:true;},onvisibleChange:mstrmojo.Widget.visibleMarkupMethod},layoutConfig:{w:{bufferNode:BUFFER_WIDTH+"px",addBtnNode:ADD_BUTTON_WIDTH+"px",navBtnsNode:NAV_BUTTONS_WIDTH+"px"},xt:true},onRender:function onRender(){this._super();var leftBtn=this.leftBtnNode,rightBtn=this.rightBtnNode,replaceText=mstrApp.isWSStyling?mstrmojo.desc(3687,"Page"):mstrmojo.desc(4780,"Panel");if(leftBtn&&!leftBtn.getAttribute("tooltip")){this.leftBtnNode.setAttribute("tooltip",mstrmojo.desc(15820,"This is the first ##").replace("##",replaceText));}if(rightBtn&&!rightBtn.getAttribute("tooltip")){this.rightBtnNode.setAttribute("tooltip",mstrmojo.desc(15821,"This is the last ##").replace("##",replaceText));}},widgetResized:function widgetResized(){var fnAdjustLayout=function(){var isInvalidMode=!this.isValidMode(),currentWidth=$DOM.position(this.domNode).w||parseInt(this.width,10)||0,reservedWidth=isInvalidMode?NAV_BUTTONS_WIDTH+ADJUSTED_WIDTH+BUFFER_WIDTH:BUTTON_BAR_WIDTH,maxWidth=Math.max(currentWidth-reservedWidth,0),tabContainerNode=this.tabContainerNode;if(tabContainerNode&&maxWidth){tabContainerNode.style.maxWidth=maxWidth+"px";}};if(this.hasRendered){fnAdjustLayout.call(this);return ;}this.attachEventListener("renderComplete",this.id,fnAdjustLayout);},buildRendering:function bldRendering(){this._super();var borderDiv=this.borderNode=document.createElement("div");borderDiv.className="mstrmojo-VIPanelTabs-divider";borderDiv.style.zIndex=this._borderZIndex;this.domNode.appendChild(borderDiv);this.addBtnTxtNode.innerHTML=mstrApp.isWSStyling?mstrmojo.desc(3687,"Page"):mstrmojo.desc(4780,"Panel");this.set("visible",this.children.length>1);},getTabCfg:function getTabCfg(allTabObjects,currentTabObject,cfg){var panelStack=this.parent;$HASH.copy({title:currentTabObject.titleText,getMenuActions:function getMenuActions(){return MENU_ACTIONS;},addNewTabMenuItem:function addNewTabMenuItem(menuCfg){menuCfg.addMenuItem(mstrApp.isWSStyling?mstrmojo.desc(14919,"Insert Page"):mstrmojo.desc(13768,"Insert Panel"),"",function(){panelStack.addPanel();});},tabSelected:function tabSelected(callback){var isTargeting=mstrApp.isAppStateSelection&&mstrApp.isAppStateSelection(),model=currentTabObject.model,panelKey=currentTabObject.k;if(isTargeting){model.raiseEvent({name:"targetLayoutSelected",layoutKey:model.getLayoutKeyByUnitKey(panelKey),panelKey:panelKey});}else{panelStack.selectPanel(panelKey,false,false,null,callback);}},tabDeleted:function tabDeleted(){panelStack.deletePanel(currentTabObject);},tabDuplicated:function tabDuplicated(){panelStack.duplicatePanel(currentTabObject);},titleEdited:function editTitle(titleText,oldText){panelStack.renamePanel(currentTabObject,titleText);},postCreateChildren:function postCreateChildren(){$HASH.copy({autoApplyDelay:3000,editOnDoubleClick:mstrApp.allowWebDashboardDesign()},this.lbl);},useRichTooltip:true,updateTooltipConfig:function updateTooltipConfig(evt){var target=evt.target;if(target===this.lbl.domNode&&target.scrollWidth>target.clientWidth){var position=$DOM.position(target);this.richTooltip={posType:mstrmojo.tooltip.POS_BOTTOMCENTER,cssClass:"vi-regular vi-tooltip-V V-center",content:$STR.encodeHtmlString(this.title),top:position.y,left:position.x+position.w/2};}else{this.richTooltip=null;}}},cfg);this.docModel=currentTabObject.model;return cfg;},addTab:function addTab(){this.parent.addPanel();},commitTabMove:function commitTabMove(fromIdx,toIdx){this.parent.movePanel(fromIdx,toIdx);},onTabsChange:function onTabsChange(){var panelTabs=this.children||[];this.set("visible",panelTabs.length>1);},selectPage:function selectPage(evt){this.parent.selectPanel(evt.panelKey,undefined,undefined,undefined,evt.callback);}});}());