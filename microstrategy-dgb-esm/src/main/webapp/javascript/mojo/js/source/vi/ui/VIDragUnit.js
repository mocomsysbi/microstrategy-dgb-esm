(function(){mstrmojo.requiresCls("mstrmojo.vi.viz.DropZoneHelper","mstrmojo.string","mstrmojo.vi.ui.DatasetUnitMenuUtils");var DRAG_UNIT_CLASS="mstrmojo-VIUnitList",CLS_DELETE_SUB="icn clsx_sub",isMetricNames=mstrmojo.vi.viz.DropZoneHelper.isMetricNames,$DS_UTILS=mstrmojo.vi.ui.DatasetUnitMenuUtils,$STR=mstrmojo.string;mstrmojo.vi.ui.VIDragUnit=mstrmojo.declare(null,null,{scriptClass:"mstrmojo.vi.ui.VIDragUnit",getItemDisplayName:function getItemDisplayName(item){return item.n;},getUnitAvatar:function getUnitAvatar(context,encodeUnitAvatar){var avatar=document.createElement("div"),ctxtDragData=context.getCtxtDragData(),items=ctxtDragData.items,avatarMarkupArr=['<div class="',[DRAG_UNIT_CLASS,mstrApp.getThemeClassName()].join(" "),'">'],me=this;items.forEach(function(item){var itemName=me.getItemDisplayName(item),itemCSS="item unit isAvatar "+$DS_UTILS.getUnitCssClass(item);if(isMetricNames(item)){itemName=mstrmojo.desc(3582,"Metrics");itemCSS+=" is-mh";}avatarMarkupArr.push('<div class="'+itemCSS+'"><span class="txt" unselectable="on">'+(encodeUnitAvatar?$STR.encodeHtmlString(itemName):itemName)+"</span></div>");});avatarMarkupArr.push("</div>");avatar.innerHTML=avatarMarkupArr.join("");return avatar.removeChild(avatar.firstChild);},getUnitDragData:function getUnitDragData(context,items){var fnSetAvatarClass=this.setAvatarClass.bind(this);return{items:items,item:items[0],setAvatarClass:function setAvatarClass(cls){fnSetAvatarClass(context,cls);},setInvalidAvatarClass:function setInvalidAvatarClass(){fnSetAvatarClass(context,CLS_DELETE_SUB);}};},getDragUnitOffsets:function getDragUnitOffsets(){return{x:21,y:16};},setAvatarClass:function setAvatarClass(context,cls){var avatar=context.avatar;if(avatar){var classes=[DRAG_UNIT_CLASS,"hasOwnAvatar",mstrApp.getThemeClassName(),cls||""];avatar.className=classes.join(" ");}}});}());