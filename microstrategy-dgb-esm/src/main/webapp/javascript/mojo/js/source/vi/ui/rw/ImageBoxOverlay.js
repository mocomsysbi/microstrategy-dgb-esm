(function(){mstrmojo.requiresCls("mstrmojo.string","mstrmojo.ui._HasScroller","mstrmojo.Box","mstrmojo._HasLayout","mstrmojo._Formattable","mstrmojo.Label","mstrmojo.Button","mstrmojo.dom","mstrmojo.TextBox");mstrmojo.requiresDescs(1442,10493,14552);var $STR=mstrmojo.string,$DOM=mstrmojo.dom;function setFocusFunction(){var linkBox=this.parent.parent;this.imgURL.onfocus=function(){linkBox.hideLinkButton();};this.imgURL.onblur=function(){linkBox.unhideLinkButton();};}mstrmojo.vi.ui.rw.ImageBoxOverlay=mstrmojo.declare(mstrmojo.Box,[mstrmojo._HasLayout,mstrmojo._Formattable,mstrmojo.ui._HasScroller],{scriptClass:"mstrmojo.vi.ui.rw.ImageBoxOverlay",cssClass:"mstrmojo-ImageBoxOverlay",init:function init(props){if(this._super){this._super(props);}setFocusFunction.call(this);},setupScrollNodes:function setupScrollNodes(){this.scrollNode=this.containerNode;},layoutConfig:{h:{containerNode:"100%"},w:{containerNode:"100%"}},formatHandlers:{domNode:["BG"]},hasChanged:function hasChanged(){var textBox=this.imgURL,textBoxNode=textBox&&textBox.domNode,text=textBoxNode&&textBoxNode.value;if(textBoxNode&&(textBoxNode.scrollWidth>textBoxNode.clientWidth||!text)){textBox.set("tooltip",text||(this.parent.parent.isEmbeddedImageFeatureEnabled?mstrmojo.desc(14552,"Enter an image URL or choose a file."):mstrmojo.desc(10493,"Image URL")));}else{textBox.set("tooltip","");}},imageBox:undefined,imgURL:undefined,origURLStr:undefined,onimgURLChange:function onimgURLChange(){setFocusFunction.call(this);},children:[{scriptClass:"mstrmojo.Label",slot:"labelNode",cssClass:"init-label"},mstrmojo.Button.newWebButton(mstrmojo.desc(1442,"OK"),function(){var overlayWidget=this.parent;if(overlayWidget.imgURL.value!==overlayWidget.origURLStr){overlayWidget.imageBox.urlEdited(overlayWidget.imgURL.value);}else{overlayWidget.imageBox.hideControlOverlay();}},true,{alias:"okBtn",slot:"buttonNode",enabled:false}),{scriptClass:"mstrmojo.TextBox",cssClass:"init-input",alias:"imgURL",slot:"textNode",bindings:{hint:function(){if(this.parent.parent.parent.isEmbeddedImageFeatureEnabled){return mstrmojo.desc(14552,"Enter an image URL or choose a file.");}else{return mstrmojo.desc(10493,"Image URL");}}},onkeydown:function(eventWrapper){if(eventWrapper.e.keyCode===13){var overlayWidget=this.parent;if(overlayWidget.imgURL.value!==overlayWidget.origURLStr){overlayWidget.imageBox.urlEdited(this.value);}else{overlayWidget.imageBox.hideControlOverlay();}}},onmousedown:function(evt){$DOM.stopPropogation(evt.hWin,evt.e);},onblur:function(eventWrapper){this.parent.hasChanged();},getLayoutOffsets:function getLayoutOffsets(){return{h:0,w:2};},_set_value:function(n,v){var oldValue=this.value;if(oldValue!==v){this.value=v;var okBtn=this.parent.okBtn;okBtn.set("enabled",!$STR.isEmpty(v));}}}]});}());