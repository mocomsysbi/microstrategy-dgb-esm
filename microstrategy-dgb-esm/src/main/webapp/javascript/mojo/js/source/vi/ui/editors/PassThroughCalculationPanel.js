(function(){mstrmojo.requiresClsP("mstrmojo","Box","HBox","VBox","Widget","Button","hash");mstrmojo.requiresCls("mstrmojo.vi.ui.editors.cm.MDXExpressionPanel","mstrmojo.vi.ui.editors.cm.ParentPanel","mstrmojo.mstr.EnumDataType");mstrmojo.requiresDescs(15594);var $DESC=mstrmojo.desc,$DT=mstrmojo.mstr.EnumDataType;mstrmojo.vi.ui.editors.PassThroughCalculationPanel=mstrmojo.declare(mstrmojo.Box,null,{scriptClass:"mstrmojo.vi.ui.editors.PassThroughCalculationPanel",cssClass:"mstrmojo-PassThroughCalculationPanel",children:[{scriptClass:"mstrmojo.VBox",alias:"rootVBox",children:[{scriptClass:"mstrmojo.HBox",alias:"definitionBox",cssClass:"definitionBox",children:[{scriptClass:"mstrmojo.vi.ui.editors.cm.MDXExpressionPanel",alias:"expressionPanel"},{scriptClass:"mstrmojo.vi.ui.editors.cm.ParentPanel",alias:"parentPanel"}]},{scriptClass:"mstrmojo.HBox",alias:"applyBox",cssClass:"applyBox",children:[{scriptClass:"mstrmojo.Widget",markupString:'<div class="apply-text">'+$DESC(15594,"Click # to apply.").replace("#",'"&#10003;"')+"</div>"},{scriptClass:"mstrmojo.Button",iconClass:"applyBtn",alias:"applyBtn",enabled:false,onclick:function(){var dePanel=this.parent.parent.parent,deEditor=dePanel.parent,expression=dePanel.expressionPanel().getExpression(),pe=dePanel.parentPanel().getSelectedParent()||dePanel.model.getParentElement(),items=[{dtp:$DT.DataTypeChar,v:expression,}];if(deEditor.commitEdit(items,false,pe)){this.set("enabled",false);dePanel.set("visible",false);deEditor.toggleEdit(false);}},bindings:{enabled:function(){var me=this.parent.parent.parent,expValue=this.parent.parent.definitionBox.expressionPanel.value,isExpInvalid=me.expressionPanel().inputBox.isExpressionInvalid(),isPEChanged=this.parent.parent.definitionBox.parentPanel.isPEChanged,isNameChanged=this.parent.parent.parent.isNameChanged,mptf=this.parent.parent.parent.parent.mptf;return !!(expValue&&!isExpInvalid&&(expValue!=me.model.getPassThroughExpression()||isPEChanged||isNameChanged||mptf));}}},{scriptClass:"mstrmojo.Button",iconClass:"cancelBtn",alias:"cancelBtn",onclick:function(){var dePanel=this.parent.parent.parent,deEditor=dePanel.parent;dePanel.set("visible",false);deEditor.toggleEdit(false);}}]}]}],resetDisplay:function(){var model=this.model,decModel=this.parent&&this.parent.model,isEssbaseSource=decModel&&decModel.isEssbaseSource();this.set("isNameChanged",false);this.parentPanel().resetDisplay(model&&model.getParentElement(),this.parent.browseConfig,isEssbaseSource);this.expressionPanel().resetDisplay(model&&model.getPassThroughExpression());},expressionPanel:function(){return this.rootVBox.definitionBox.expressionPanel;},parentPanel:function(){return this.rootVBox.definitionBox.parentPanel;},applyBtn:function(){return this.rootVBox.applyBox.applyBtn;}});}());