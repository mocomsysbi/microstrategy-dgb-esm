(function(){mstrmojo.requiresCls("mstrmojo.Container","mstrmojo.array","mstrmojo.css","mstrmojo._HasChildren");var $ARR=mstrmojo.array,$CSS=mstrmojo.css,TYPE_LOWEST_PERCENT=1,TYPE_HIGHEST_PERCENT=2,TYPE_BETWEEN_PERCENT=3,TYPE_LOWEST=4,TYPE_HIGHEST=5;function renderBars(){var me=this,metric=me.metric,thresholds=me.thresholds||[],numThresholds=thresholds.length,firstItem,lastItem,isPercentage,min,max,percentDivisor,hasDivisor=true;me.destroyChildren();if(!!thresholds&&numThresholds>0){var isImageBased=this.isImageBasedType();if(isImageBased){var thCount=thresholds.length;$ARR.forEach(thresholds,function(threshold){var imgUrl=threshold.rtxt,widthPercentage=1/thCount*100;bar={scriptClass:"mstrmojo.Widget",markupString:'<div class="item" style="{@cssText}{@bg}"></div>',cssText:"width: "+widthPercentage+"%; ",bg:"background:url("+imgUrl+");background-size: contain; background-repeat: no-repeat; background-position: center;"};me.addChildren(bar);});}else{firstItem=thresholds[0];lastItem=thresholds[thresholds.length-1];isPercentage=firstItem.ttp===TYPE_LOWEST_PERCENT||firstItem.ttp===TYPE_HIGHEST_PERCENT||firstItem.ttp===TYPE_BETWEEN_PERCENT;if(!isPercentage){if(firstItem.ttp===TYPE_LOWEST||firstItem.ttp===TYPE_HIGHEST){min=0;max=metric.cnt;percentDivisor=max;if(metric.min===metric.max){hasDivisor=false;}}else{min=metric.min;max=metric.max;if(isFinite(firstItem.ceil)&&firstItem.ceil<min){min=firstItem.ceil;}if(isFinite(lastItem.flr)&&lastItem.flr>max){max=lastItem.flr;}percentDivisor=max-min;if(percentDivisor<=0){hasDivisor=false;}}}$ARR.forEach(thresholds,function(threshold){var high=Math.min(threshold.ceil,max),low=Math.max(threshold.flr,min),width=high-low,color=threshold.fmt.bc,isWidthFinite=isFinite(width),isCeilFinite=isFinite(threshold.ceil),isFlrFinite=isFinite(threshold.flr),bar={scriptClass:"mstrmojo.Widget",markupString:'<div class="item" style="{@cssText}"></div>',cssText:"width: "+width+"%; "};if(!isPercentage&&hasDivisor){if(!isWidthFinite){if(isCeilFinite){width=threshold.ceil-min;}else{if(isFlrFinite){width=max-threshold.flr;}else{width=max-min;}}}bar.cssText="width: "+(width/percentDivisor*100)+"%; ";}else{if(!isWidthFinite||!hasDivisor){bar.cssText="width: "+(1/numThresholds*100)+"%; ";}}if(color.c1){var gradient=$CSS.buildGradient(color.or,color.c1,color.c2),styleName=$CSS.convertCssToCamelCase(gradient.n);bar.cssText+=styleName+": "+gradient.v;}else{bar.cssText+="background-color: "+color;}me.addChildren(bar);});}}}mstrmojo.vi.ui.ColorRangeSelector=mstrmojo.declare(mstrmojo.Container,[mstrmojo._HasChildren],{scriptClass:"mstrmojo.vi.ui.ColorRangeSelector",markupString:'<div id="{@id}" class="mstrmojo-ColorRangeSelector" mstrAttach:click><div class="children"></div><div class="icon"></div></div>',markupSlots:{containerNode:function containerNode(){return this.domNode.firstChild;}},thresholds:[],metric:null,preBuildRendering:function preBuildRendering(){this._super();renderBars.call(this);},isImageBasedType:function isImagebasedType(){var thresholds=this.thresholds;return thresholds&&!thresholds.some(function(thresholdData){return thresholdData.rtp!==4;});},});}());