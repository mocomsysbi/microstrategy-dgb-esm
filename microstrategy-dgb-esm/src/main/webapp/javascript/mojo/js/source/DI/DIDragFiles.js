(function(){mstrmojo.requiresCls("mstrmojo.Container","mstrmojo.DI.DIConstants","mstrmojo.List","mstrmojo.DI.DIObjectBrowserDnD","mstrmojo._HasLayout","mstrmojo.Label","mstrmojo.TextArea","mstrmojo.Widget","mstrmojo.DI.FileDragDropBoxDnD","mstrmojo.css");mstrmojo.requiresDescs(12679);mstrmojo.DI.DIDragFiles=mstrmojo.declare(mstrmojo.Box,null,{scriptClass:"mstrmojo.DI.DIDragFiles",cssClass:"di-connector-panel",titleWidget:"",children:[{scriptClass:"mstrmojo.VBox",cssClass:"",alias:"mainPage",children:[{scriptClass:"mstrmojo.HBox",cssClass:"",alias:"content",children:[{scriptClass:"mstrmojo.VBox",cssClass:"di-connector-left-panel",alias:"objectListPanel",children:[{scriptClass:"mstrmojo.DI.DIObjectBrowserDnD",cssClass:"di-object-browser",alias:"browser",rootUrl:"",visible:true,populate:function populate(list){this.set("fileList",list);},markupMethods:{onvisibleChange:function(){this.domNode.style.display=this.visible?"block":"none";}},bindings:{canRefresh:"this.parent.parent.parent.parent.canRefresh"}}]},{scriptClass:"mstrmojo.DI.FileDragDropBoxDnD",alias:"urlList",draggable:false,fileUpload:false,dropZone:true,visible:true,text:mstrmojo.desc(12679,"Drag and drop file(s) from left."),cssClass:"di-connector-right-panel",getFilesCnt:function(){return this.urls?this.urls.length:0;},getFileUrl:function(idx){if(idx<this.urls.length){return this.urls[idx];}return"";},getFileUrlDBRole:function(idx){var dbr=null;if(this.dbrs&&idx<this.dbrs.length){dbr=this.dbrs[idx];}if(dbr&&dbr.did===-1){return null;}return dbr&&dbr.did;},onurlsChange:function(){if(this._super){this._super();}var controller=mstrApp.getRootController();if(!this.parent.parent.parent.multiSelect){controller.sourceSelected(this.urls.length===1);}else{if(this.urls.length>0||this.forceEnable===true){controller.sourceSelected(true);}else{controller.sourceSelected(false);}}var node=this.domNode.firstChild.children[0];var CSS=mstrmojo.css;if(this.urls&&this.urls.length>0){CSS.toggleClass(node,"solid",true);}else{CSS.toggleClass(node,"solid",false);}this.updateItemsCount(this.getURLCnt());}}]}]}],createTitleWidget:mstrmojo.emptyFn,ondrop:mstrmojo.emptyFn,onNextButtonClick:mstrmojo.emptyFn,browseFunction:mstrmojo.emptyFn,refreshFunction:mstrmojo.emptyFn,editFunction:mstrmojo.emptyFn,supportFolderDrag:true,sourceObjectsInfo:null,autoSelectNode:mstrmojo.emptyFn,canRefresh:false,sizeTooltip:false,folderSizeTooltip:false,multiSelect:true,filterType:[],preBuildRendering:function preBuildRendering(){var contentPanel,objectListPanel,browser;if(this._super){this._super();}this.titleWidget=this.createTitleWidget();contentPanel=this.mainPage.content;objectListPanel=contentPanel.objectListPanel;browser=objectListPanel.browser;objectListPanel.addChildren(this.titleWidget,0);contentPanel.urlList.set("ondrop",this.ondrop);browser.set("browseFunction",this.browseFunction);browser.set("refreshFunction",this.refreshFunction);browser.set("editFunction",this.editFunction);browser.set("supportFolderDrag",this.supportFolderDrag);browser.set("sourceObjectsInfo",this.sourceObjectsInfo);browser.set("autoSelectNode",this.autoSelectNode);browser.set("container",this);browser.set("sizeTooltip",this.sizeTooltip);browser.set("folderSizeTooltip",this.folderSizeTooltip);browser.set("filterType",this.filterType);browser.set("dblClickNodeFunction",function(node){if((node.data.isFolder&&this.supportFolderDrag)||!node.data.isFolder){contentPanel.urlList.ondrop({src:{data:[node]}});}});},getObjectBrowser:function getObjectBrowser(){var contentPanel,objectListPanel,browser;contentPanel=this.mainPage.content;objectListPanel=contentPanel.objectListPanel;browser=objectListPanel.browser;return browser;},getDropZone:function getDropZone(){var contentPanel=this.mainPage.content;return contentPanel.urlList;},getTitleWidget:function getTitleWidget(){return this.titleWidget;},refreshBrowser:function refreshBrowser(){var contentPanel,objectListPanel,browser;contentPanel=this.mainPage.content;objectListPanel=contentPanel.objectListPanel;browser=objectListPanel.browser;browser.clickedNode=this.mainPage.content.objectListPanel.browser.fileTree;browser.refreshFunction();},setRootURL:function setRootURL(url){var contentPanel,objectListPanel,browser;contentPanel=this.mainPage.content;objectListPanel=contentPanel.objectListPanel;browser=objectListPanel.browser;browser.set("rootUrl",url);},adjustSize:function adjustSize(size){var width=parseInt(size.w,10),height=parseInt(size.layoutH,10),contentPanel,objectListPanel,leftPanelWidth=Math.round(width*0.482),right_delta=(!!mstrApp.isWorkstation)?15:0,left_delta=(!!mstrApp.isWorkstation)?47:36,vi_header_delta_left=(!!mstrApp.isWorkstation&&!!mstrApp.isPopup)?3:0,vi_header_delta_right=(!!mstrApp.isWorkstation&&!!mstrApp.isPopup)?7:0;this.domNode.style.width=width+"px";contentPanel=this.mainPage.content;objectListPanel=contentPanel.objectListPanel;objectListPanel.domNode.style.width=leftPanelWidth+"px";contentPanel.urlList.dnDNode.style.width=width-leftPanelWidth-31+"px";if(!isNaN(height)){this.mainPage.content.objectListPanel.domNode.style.height=height-left_delta+vi_header_delta_left+"px";this.mainPage.content.objectListPanel.browser.domNode.style.height=height-16-left_delta+vi_header_delta_left-10+"px";var h=height-16-left_delta+vi_header_delta_left-11;if(h===390){h-=10;}this.mainPage.content.objectListPanel.browser.fileTree.set("height",h+"px");this.mainPage.content.urlList.dnDNode.style.height=height-38-18-25+right_delta+vi_header_delta_right+"px";}},changeSize:function changeSize(evt){var width=Math.ceil(parseInt(evt.size.w,10));var height=Math.ceil(parseInt(evt.size.layoutH,10));if(isNaN(width)){return ;}this.mainPage.content.objectListPanel.domNode.style.width=width*0.5+"px";this.mainPage.content.urlList.dnDNode.style.width=(width*0.5-41)+"px";if(!mstrApp.isPopup&&!isNaN(height)){this.mainPage.content.objectListPanel.domNode.style.height=height+"px";this.mainPage.content.objectListPanel.browser.domNode.style.height=height-42+"px";this.mainPage.content.objectListPanel.browser.fileTree.set("height",height-42-11+"px");this.mainPage.content.urlList.dnDNode.style.height=height-41+"px";}}});}());