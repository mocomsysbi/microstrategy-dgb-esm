(function(){mstrmojo.requiresCls("mstrmojo.DI.DIRootView","mstrmojo.DI.DIConstants","mstrmojo.DI.DIHelpers","mstrmojo.Editor");mstrmojo.requiresDescs(14155);var $HELPER=mstrmojo.DI.DIHelpers,constants=mstrmojo.DI.DIConstants;function clearPadding(){try{if(this.domNode&&this.containerNode){this.containerNode.style.padding=0;}if(this.domNode&&this.buttonNode){this.buttonNode.style.padding=0;}}catch(e){console.log(e,"Dom Manipulation Error! Swallowed!");}}function adjustForHomePage(ratioW,ratioH){var container=window.document.getElementById("DIContainer");if(container&&this.rootView){this.rootView.windowResize({h:(container.clientHeight*ratioH).toString()+"px",w:(container.clientWidth*ratioW).toString()+"px"});}if(this.editNode){mstrmojo.dom.center(this.editNode);}}mstrmojo.DI.ui.dialogs.DIPageDialog=mstrmojo.declare(mstrmojo.Editor,[mstrmojo._FillsBrowser],{scriptClass:"mstrmojo.DI.ui.dialogs.DIPageDialog",showTitle:false,zIndex:999,launcher:null,getMovingHandle:function getMovingHandle(){return this.rootView.headerNode;},browserResized:function browserResized(size){if(this.editorNode){mstrmojo.dom.center(this.editorNode);$HELPER.reevaluatePopupPosition(this.editorNode);}if(this.pageType===constants.pageType.sourceAdmin||this.pageType===constants.pageType.dataSelection){this.hasRendered&&adjustForHomePage.call(this,0.8,0.8);}},postBuildRendering:function(){if(this._super){this._super();}if(this.pageType===constants.pageType.dataSelection){window.setTimeout(adjustForHomePage.bind(this,0.8,0.8),0);}},onOpen:function onOpen(){var controller=mstrApp.getRootController(),slot=this.slot,me=this,msg=mstrmojo.desc(14155,"Please input your original data into clipboard because you have parsed or wrangled the data."),clipboardCallback={success:function(res){clearPadding.call(me);slot.getConfig().properties.content=res;controller.showPage(constants.pageType.clipboard,0,slot||null);me.raiseEvent({name:"EditorResized"});},failure:function(res){controller.showPage(constants.pageType.clipboard,0,slot||null);controller.displayError(mstrmojo.desc(12795,"Could not load clipboard data!"),false,res.message);}},tableID,params,silent;this.set("visible",false);this.launcher=controller.rootView;this.origTitleText=controller.rootView.header&&controller.rootView.header.titleText;controller.rootView=this.rootView;switch(this.pageType){case constants.pageType.emmaPreview:controller.fetchCubeInfoEMMA();break;case constants.pageType.dataSelection:controller.showPage(this.pageType,null,this.slot||null);break;case constants.pageType.file:controller.showPage(this.pageType,this.sourceInfo,this.slot||null);break;case constants.pageType.clipboard:tableID=slot.getConfig().properties.tableID;silent=!!slot.getConfig().properties.donotFetchData;params={previewflag:constants.requestFlag.fullData,browsetype:4,sheetIndex:0,bindingflag:0,tableID:tableID};if(!silent&&!controller.getModel().isParsed(tableID)&&!controller.getModel().isRefined(tableID)){controller.dataService.getImportedData(clipboardCallback,params,0);}else{controller.showPage(constants.pageType.clipboard,0,this.slot||null);mstrApp.getRootController().displayWarning(msg,null,mstrmojo.emptyFn,{showCancel:false});}clearPadding.call(this);break;case constants.pageType.schedule:case constants.pageType.republish:this.origModel=controller.getModel();this.origMessageID=controller.dataService.messageID;this.origIRRMessageID=controller.dataService.emmaIRRMessageID;this.model=new mstrmojo.DI.DIModel();this.addDisposable(this.model);this.model.initParams(this.diParams);controller.model=this.model;controller.dataService.messageID=null;controller.dataService.emmaIRRMessageID=null;controller.restoreForLaunchingApp();break;case constants.pageType.publicData:controller.showPage(this.pageType,null,this.slot||null);break;default:break;}},onClose:function onClose(){var controller=mstrApp.getRootController();controller.rootView=this.launcher;if(controller.rootView.header){controller.rootView.header.set("titleText","");controller.rootView.header.set("titleText",this.origTitleText);}controller.dialogController.pageZIndex--;this.sourceInfo=null;this.slot=null;if(this.origModel){controller.model=this.origModel;this.origModel=null;}if(this.origMessageID!==undefined){controller.dataService.messageID=this.origMessageID;this.origMessageID=null;}if(this.origIRRMessageID!==undefined){controller.dataService.emmaIRRMessageID=this.origIRRMessageID;this.origIRRMessageID=null;}this.destroy();},children:[{scriptClass:"mstrmojo.DI.DIRootView",alias:"rootView",showHeader:true,inPageDialog:true,onvisibleChange:function(){this.parent.set("visible",this.visible);},}]});}());