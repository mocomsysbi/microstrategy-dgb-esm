(function(){mstrmojo.requiresCls("mstrmojo.hash","mstrmojo.VisUtility","mstrmojo.vi.enums.EnumThemeProperties","mstrmojo.models.FormatModel","mstrmojo.chart.enums.EnumFontStyle");var $VISUTIL=mstrmojo.VisUtility,$HASH=mstrmojo.hash,FORMAT_MODEL=mstrmojo.models.FormatModel,ENUM_FORMAT_PROPERTIES=FORMAT_MODEL.ENUM_PROPERTY_NAMES,ENUM_FONT_STYLE=mstrmojo.chart.enums.EnumFontStyle,EnumThemeProperties=mstrmojo.vi.enums.EnumThemeProperties;mstrmojo.heatmap.vi.VisHeatmapUtility=mstrmojo.provide("mstrmojo.heatmap.vi.VisHeatmapUtility",{fontStyleValueMap:{bold:ENUM_FONT_STYLE.FS_BOLD,italic:ENUM_FONT_STYLE.FS_ITALIC,underline:ENUM_FONT_STYLE.FS_UNDERLINE,strikeout:ENUM_FONT_STYLE.FS_STRIKETHROUGH},setStepperEnabled:function(stepper,paths,limits){var btns=["min","max"],validState=["gt","lt"];btns.forEach(function(btn,idx){var enabled=paths.every(function(name){var expectedState=validState[idx],state=$VISUTIL.getPropertyByPath(limits,[name,btn].join("."),expectedState);return state===expectedState;});stepper.getControl(idx+1).set("enabled",enabled);});},getStepper:function(callback,config){var btn1=new mstrmojo.Button(mstrmojo.Button.newIconButton(mstrmojo.desc(13608,"Decrease Font Size"),"single-operator minus",function(){callback(-1);},undefined,{slot:"col1Node"})),btn2=new mstrmojo.Button(mstrmojo.Button.newIconButton(mstrmojo.desc(13607,"Increase Font Size"),"single-operator plus",function(){callback(1);},undefined,{slot:"col2Node"}));config=$HASH.copy(config,{col1Width:"50%",col2Width:"50%",dividerWidth:"10px",children:[btn1,btn2]});return new mstrmojo.ui.editors.controls.TwoColumnContainer(config);},isInvalidTemplate:function isInvalidTemplate(modelData){var temp=modelData&&modelData.gts,row=temp&&temp.row;return(!(row&&row.length>0)||!$VISUTIL.hasOnlyMetricsOnColumn(modelData)||!$VISUTIL.hasNoMetricOnRow(modelData));},getInvalidTemplateErrMsg:function(dftMsg){return dftMsg||mstrmojo.desc(13685,"The Heat Map requires at least one attribute on the row axis to render properly; it is recommended that two metrics be placed on the column axis as well");},isSpatial:function(){return mstrApp.getThemeProps&&mstrApp.getThemeProps(EnumThemeProperties.SUBTYPE.HEATMAP).smallGap===EnumThemeProperties.DEFAULT_THEME_PROPS.HEATMAP.smallGap||false;},convertFontStyle:function(fontStyleValue,formats){if((fontStyleValue&ENUM_FONT_STYLE.FS_BOLD)>0){formats[ENUM_FORMAT_PROPERTIES.FONT_WEIGHT]="bold";}if((fontStyleValue&ENUM_FONT_STYLE.FS_ITALIC)>0){formats[ENUM_FORMAT_PROPERTIES.FONT_STYLE]="italic";}if((fontStyleValue&ENUM_FONT_STYLE.FS_UNDERLINE)>0){formats[ENUM_FORMAT_PROPERTIES.UNDERLINE]="underline";}if((fontStyleValue&ENUM_FONT_STYLE.FS_STRIKETHROUGH)>0){formats[ENUM_FORMAT_PROPERTIES.LINE_THROUGH]="line-through";}},processFontStyle:function(formats,fontStyleValue){formats.fontWeight=(fontStyleValue&ENUM_FONT_STYLE.FS_BOLD?"bold":"normal");formats.fontStyle=(fontStyleValue&ENUM_FONT_STYLE.FS_ITALIC?"italic":"normal");if((fontStyleValue&ENUM_FONT_STYLE.FS_STRIKETHROUGH)&&(fontStyleValue&ENUM_FONT_STYLE.FS_UNDERLINE)){formats.textDecoration="line-through underline";}else{if(fontStyleValue&ENUM_FONT_STYLE.FS_STRIKETHROUGH){formats.textDecoration="line-through";}else{if(fontStyleValue&ENUM_FONT_STYLE.FS_UNDERLINE){formats.textDecoration="underline";}else{formats.textDecoration="none";}}}},getFontStyleItems:function(){return[{n:mstrmojo.desc(2718,"Bold"),id:"b",css:"bold"},{n:mstrmojo.desc(2719,"Italic"),id:"i",css:"italic"},{n:mstrmojo.desc(2720,"Underline"),id:"u",css:"underline"},{n:mstrmojo.desc(3062,"Strikeout"),id:"s",css:"strikeout"}];},updateFontStyle:function(widget,formats){var styleValues=[],fnAddFontStyle=function(propertyName,cssName,idx){var cssValue=formats[propertyName];if(cssValue){styleValues.push(idx);}};fnAddFontStyle(ENUM_FORMAT_PROPERTIES.FONT_WEIGHT,"bold",0);fnAddFontStyle(ENUM_FORMAT_PROPERTIES.FONT_STYLE,"italic",1);fnAddFontStyle(ENUM_FORMAT_PROPERTIES.UNDERLINE,"underline",2);fnAddFontStyle(ENUM_FORMAT_PROPERTIES.LINE_THROUGH,"line-through",3);widget.select(styleValues);},});}());