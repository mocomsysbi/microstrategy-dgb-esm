(function(){if(!mstrmojo.PerformanceLogOutput){var TIME_ID_CACHE={},ENABLE_PRINT=true;mstrmojo.PerformanceLogOutput=mstrmojo.provide("mstrmojo.PerformanceLogOutput",{mTimers:[],mUseTimer:true,timerId:0,startTimer:function startTimer(desc,name){if(this.mUseTimer){if(name&&this.getTimerIdByName(name)>=0){return ;}var timerId=this.timerId++;this.mTimers.push({timeStamp:new Date(),timerId:timerId,desc:desc.functionName+": "+desc.purpose});if(name){TIME_ID_CACHE[name]=timerId;}return timerId;}},getTimerIdByName:function getTimerIdByName(name){var id=TIME_ID_CACHE[name];return isNaN(id)?-1:id;},endTimer:function endTimer(timeInfo){var timeId;if(typeof timeInfo==="string"){timeId=this.getTimerIdByName(timeInfo);}else{timeId=timeInfo;}if(this.mUseTimer){var timer,mTimers=this.mTimers;if(timeId===undefined){timer=mTimers.pop();}else{var i,t;for(i=0;i<mTimers.length;i++){t=mTimers[i];if(t.timerId===timeId){timer=t;mTimers.splice(i,1);break;}}}if(timer){var desc=timer.desc;var perfTime=new Date()-timer.timeStamp;var perfResult=[desc,perfTime];this.visPrint("%c"+timer.desc+": "+perfTime+"ms","color: blue");perfLogCollect(perfResult);delete TIME_ID_CACHE[timeInfo];}}},visPrint:function visPrint(){if(ENABLE_PRINT&&window.mstr_profile&&mstr_profile.enabled&&console){Function.prototype.apply.call(console.log,console,arguments);}},recordJSHeapMemory:function recordJSHeapMemory(desc){var performance=window.performance,memory=performance&&performance.memory;if(this.mUseTimer&&memory){desc=desc?(desc+": "):"";var memoryMetrics=["usedJSHeapSize","totalJSHeapSize","jsHeapSizeLimit"],me=this;memoryMetrics.forEach(function(metrix){var description=desc+metrix,valueInKB=memory[metrix]/1000;me.visPrint("%c"+description+": "+valueInKB+"KB","color: blue");perfLogCollect([description,valueInKB]);});}},exportToCsv:function exportToCsv(){var filename=mstrApp.rootCtrl.docCtrl.model.n+".csv",rows=window.perfResults;var processRow=function(row,j){var finalVal="";var innerValue=row[j]===null?"":row[j].toString();if(row[j] instanceof Date){innerValue=row[j].toLocaleString();}var result=innerValue.replace(/"/g,'""');if(result.search(/("|,|\n)/g)>=0){result='"'+result+'"';}finalVal+=result;return finalVal+",";};var csvFile="";for(var i=0;i<rows.length;i++){csvFile+=processRow(rows[i],0);}csvFile+="\n";for(var i=0;i<rows.length;i++){csvFile+=processRow(rows[i],1);}csvFile+="\n";var blob=new Blob([csvFile],{type:"text/csv;charset=utf-8;"});if(navigator.msSaveBlob){navigator.msSaveBlob(blob,filename);}else{var link=document.createElement("a");if(link.download!==undefined){var url=URL.createObjectURL(blob);link.setAttribute("href",url);link.setAttribute("download",filename);link.style.visibility="hidden";document.body.appendChild(link);link.click();document.body.removeChild(link);}}window.perfResults=[];}});function perfLogCollect(perfResult){var perfResults=window.perfResults;if(!perfResults){perfResults=window.perfResults=[];}perfResults.push(perfResult);}}})();