(function(){mstrmojo.requiresCls("mstrmojo.array","mstrmojo.chart.model.enums.EnumDSSObjectType","mstrmojo.hash");var $ARR=mstrmojo.array,$HASH=mstrmojo.hash,ELEM_ALL_ID="u;",ELEM_DUMMY_ID="-1";ELEM_HIDDEN_PROP="hid";mstrmojo.elementHelper=mstrmojo.provide("mstrmojo.elementHelper",{buildElemsTerseID:function buildElemsTerseID(elements,attrId,delDN){var item,i;for(i in elements){item=elements[i];if(item.v){var val=item.v.replace(/\\\\/g,"\u001e").replace(/\\\;/g,"\u001f");var vs=val.split(";");if(vs&&vs.length>1){vs[1]=attrId;if(delDN&&vs.length>2){vs.pop();}item.v=vs.join(";").replace(/\u001e/g,"\\\\").replace(/\u001f/g,"\\;");}}}return elements;},buildElemsCountStr:function buildElemsCountStr(ces,elements,isExcluded){ces=(!ces||!ces.length)?[]:ces;elements=(!elements||!elements.length)?[]:elements;function removeHidden(elms){return elms.filter(function(e){return !e[ELEM_HIDDEN_PROP];});}var sc=removeHidden(ces).length,tc=removeHidden(elements).length;if($ARR.find(elements,"v",ELEM_ALL_ID)>-1){tc-=1;}if($ARR.find(elements,"v",ELEM_DUMMY_ID)>-1){tc-=1;}if(isExcluded){sc=(sc<tc)?tc-sc:0;}if($ARR.find(ces,"v",ELEM_ALL_ID)>-1||$ARR.indexOf(ces,ELEM_ALL_ID)>-1){sc=tc;}return this.buildElemsCountStrByNum(sc,tc);},buildElemsCountStrByNum:function buildElemsCountStr(sc,tc){if(sc===tc){if(tc===0){return"";}return tc.toString();}else{if(tc===0){return sc+" "+mstrmojo.desc(514);}else{if(sc>tc){return"("+tc+")";}}}return mstrmojo.desc(4891,"").replace("##",String(sc)).replace("###",String(tc));},browseElements:function submitElemSearch(callbacks,taskParams,instParams){var config={doNotHold:!(instParams&&mstrApp.serverProxy),silent:true};mstrApp.serverRequest(mstrmojo.hash.copy(instParams,taskParams),callbacks,config);},getIdPresentation:function getIdPresentation(elementID){if(!!elementID){var charZero=elementID.charAt(0),charOne,escapeNext,i;if((charZero>="g"&&charZero<="w")||(charZero>="V"&&charZero<="Z")){escapeNext=false;for(i=1;i<elementID.length;++i){if(escapeNext){escapeNext=false;}else{switch(elementID.charAt(i)){case";":return"terseLong";case"\\":escapeNext=true;break;}}}return"terse";}if(charZero>="B"&&charZero<="Q"){if(elementID.length>2){charOne=elementID.charAt(1);if(charOne>="A"&&charOne<="Q"){if(elementID.charAt(2)===":"){return"oldLong";}}}}if(elementID.length>=33&&elementID.charAt(32)===":"){return"old";}}return null;},terseLong2OldShort:function terseLong2OldShort(elementID){if(this.getIdPresentation(elementID)!=="terseLong"){return elementID;}var encodedID=elementID.replace(/\\\\/g,"\u001e").replace(/\\\;/g,"\u001f"),es=encodedID.substring(1,encodedID.length).split(";");return(es[1]+":"+es[0]).replace(/\u001e/g,"\\\\").replace(/\u001f/g,"\\;");},oldShort2terseLong:function oldShort2terseLong(elementID,tersePrefix){if(this.getIdPresentation(elementID)!=="old"){return elementID;}var encodedID=elementID.replace(/\\\\/g,"\u001e").replace(/\\\:/g,"\u001f"),es=encodedID.split(":"),sourceID=es.shift();return(tersePrefix||"h")+(es.join(":")+";"+sourceID).replace(/\u001e/g,"\\\\").replace(/\u001f/g,"\\:");},isNullElem:function isNullElem(elementID){if(!elementID){return true;}var pres=this.getIdPresentation(elementID),isNull=false,es;switch(pres){case"terse":case"terseLong":es=elementID.substring(1,elementID.length).split(";");isNull=es[0].indexOf(this.TERSE_NULL)>-1;break;case"old":case"oldLong":isNull=elementID.indexOf(this.OLD_NULL)>-1;break;}return isNull;},isNonGroupNull:function(data){var eid=data.eid||(data._e&&data._e.id),name=eid&&eid.split(":")[0];return name&&name===this.NON_GROUP_NULL;},getAttributeId:function getAttributeId(eid){var attId,arr;if(eid){arr=eid.split(";");attId=arr[1];}return attId;},getElementValue:function getElementValue(eid){var value,arr;if(eid){arr=eid.split(";");if(arr.length>2){value=arr[0]+" "+arr[2];}else{value=arr[0];}}return value;},isAttributeIdsLinked:function isAttributeIdsLinked(attId1,attId2,links){var isLinked=false,ids=$HASH.keyarray(links);$ARR.forEach(ids,function(k){if(k===attId1){$ARR.forEach(links[k],function(linked){if(linked===attId2){isLinked=true;return false;}});}if(isLinked){return false;}});return isLinked;},ELEM_ALL_ID:"u;",ELEM_DUMMY_ID:"-1",ELEM_SEPARATOR:"\u001E",OLD_NULL:"~!@@~~!@@~",TERSE_NULL:"\\N",NON_GROUP_NULL:"n00000000000000000000000000000000",ELEM_ALL:{t:mstrmojo.chart.model.enums.EnumDSSObjectType.DssTypeDimension,v:"u;",n:"(All)"}});}());