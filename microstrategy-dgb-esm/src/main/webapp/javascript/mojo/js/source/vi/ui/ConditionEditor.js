(function(){mstrmojo.requiresCls("mstrmojo.array","mstrmojo.hash","mstrmojo.Editor","mstrmojo.Label","mstrmojo.Button","mstrmojo.mstr.EnumNodeDimty","mstrmojo.vi.ui.ConditionWalk","mstrmojo.fe.FilterUtils","mstrmojo.expr");mstrmojo.requiresDescs(15540);var $ARR=mstrmojo.array,$HASH=mstrmojo.hash,$NWB=mstrmojo.Button.newWebButton,$DMT=mstrmojo.mstr.EnumNodeDimty,VALID_DIMTY_TYPES=$ARR.hash([$DMT.NodeDimtyUnspecified,$DMT.NodeDimtyNone]),$FILTER_UTILS=mstrmojo.fe.FilterUtils,E=mstrmojo.expr,ET=E.ET;mstrmojo.vi.ui.ConditionEditor=mstrmojo.declare(mstrmojo.Editor,null,{scriptClass:"mstrmojo.vi.ui.ConditionEditor",cssClass:"mstrmojo-vi-ui-ConditionEditor",help:"Creating_a_Metric_Qualification.htm",title:mstrmojo.desc(15540,"Edit Qualification"),objectBrowsingEnabled:false,targets:null,targetsLastMod:null,ets:null,condition:null,model:null,hasPrompt:false,disableElementsBrowsing:null,inRelation:null,editor:null,children:[{scriptClass:"mstrmojo.Box",markupString:'<div id="{@id}" class="mstrmojo-Box {@cssClass}" style="{@cssText}"></div>',cssDisplay:"inline-block",cssClass:"conditionBar",model:null,alias:"conditionBar",bindings:{model:"this.parent.model"},update:function(){var model=this.model,htmlAndText=$FILTER_UTILS.getExprNodeHtmlAndText(model.data?model.data:model,{emptyText:mstrmojo.desc(15413,"Qualification Details"),elemsEmpty:" "});if(this.containerNode){this.containerNode.innerHTML=htmlAndText.html;this.containerNode.title=htmlAndText.text;}}},{scriptClass:"mstrmojo.vi.ui.ConditionWalk",alias:"walk",dimtyTypes:VALID_DIMTY_TYPES,delegateUpdateOkBtn:function delegateUpdateOkBtn(valid){var conditionEditor=this.parent,btnBox=conditionEditor&&conditionEditor.btnHbox,okBtn=btnBox&&btnBox.okBtn;if(okBtn){okBtn.set("enabled",!!valid);}},onOK:function onOK(){var cond=this.condition,editor=this.editor;editor.onConditionEdit(cond,this.model.get());},close:function close(){var c=this.condition;if(c&&c.isEmpty()){c.del();}},postmodeledit:function postmodeledit(evt){this.parent.updateConditionBar();},getIfDataSource:function getIfDataSource(){return this.parent.getIfDataSource();},onUpdateBrowseElementsParams:function onUpdateBrowseElementsParams(params){this.parent.onUpdateBrowseElementsParams(params);},getDatasets:function getDatasets(){return this.parent.getDatasets();}}],buttons:[$NWB(mstrmojo.desc(1442,"OK"),function(){var conditionEditor=this.parent.parent;conditionEditor.walk.onOK();conditionEditor.close();},true,{enabled:true,alias:"okBtn"}),$NWB(mstrmojo.desc(221,"Cancel"),function(){var conditionEditor=this.parent.parent;conditionEditor.close();})],updateConditionBar:function updateConditionBar(){this.conditionBar.update();},open:function open(opener,config){this._super(opener,config);var walkCfg={objectBrowsingEnabled:this.objectBrowsingEnabled,targets:this.targets,targetsLastMod:this.targetsLastMod,ets:this.ets,condition:this.condition,hasPrompt:this.hasPrompt,disableElementsBrowsing:this.disableElementsBrowsing,disableHierarchyLevel:this.disableHierarchyLevel,inRelation:this.inRelation,editor:this.editor};$HASH.copy(walkCfg,this.walk);if(!(this.disableElementsBrowsing&&this.disableElementsBrowsing())){this.model.defaultETAttr=ET.AE;}this.walk.set("model",this.model);this.updateConditionBar();},onClose:function onClose(){this.walk.close();},getDatasets:mstrmojo.emptyFn,getIfDataSource:mstrmojo.emptyFn,onUpdateBrowseElementsParams:mstrmojo.emptyFn});}());