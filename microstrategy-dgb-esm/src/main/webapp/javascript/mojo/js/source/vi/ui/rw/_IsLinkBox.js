(function(){mstrmojo.requiresCls("mstrmojo.css","mstrmojo.Widget","mstrmojo.ui.editors.controls.LinkGroup","mstrmojo.ui.PopupButton","mstrmojo.ui.PopupWidget");var $CSS=mstrmojo.css,$CLASS_HIDDEN="hidden";function buttonFadeOut(){var me=this;this._hideLinkHandler=window.setTimeout(function(){if(!me._disableHide){$CSS.addClass(me.linkBtnNode,$CLASS_HIDDEN);}},200);}mstrmojo.vi.ui.rw._IsLinkBox=mstrmojo.provide("mstrmojo.vi.ui.rw._IsLinkBox",{_mixinName:"mstrmojo.vi.ui.rw._IsLinkBox",linkBtnNode:null,linkMenuCfg:null,init:function(props){if(this._super){this._super(props);}if(mstrApp.isDossier){return ;}var me=this,bc=this.boxContent,model=this.model;this.linkMenuCfg=new mstrmojo.ui.PopupButton({cssDisplay:"",cssClass:$CLASS_HIDDEN,isHostedWithin:false,anchorSlot:"domNode",alias:"linkMenu",markupString:'<div id="{@id}" class="hover-link-btn {@cssClass}" style="{@cssText}" mstrAttach:click></div>',markupSlots:{btnNode:function(){return this.domNode.firstChild;}},markupMethods:{onvisibleChange:mstrmojo.Widget.visibleMarkupMethod},postBuildRendering:function(){if(this._super){this._super();}me.linkBtnNode=this.domNode;},getPopupWidget:function getPopupWidget(){return this.linkPopup;},children:[{scriptClass:"mstrmojo.ui.editors.controls.LinkGroup",alias:"linkPopup",cssClass:"link-selection-editor "+mstrApp.getThemeClassName(),docModel:model,hostId:bc.id,visible:false,onOpenCallback:function(){me._disableHide=true;},onCloseCallback:function(){me._disableHide=false;buttonFadeOut.call(me);},postBuildRendering:function(){this.constructor.prototype.postBuildRendering.call(this);if(!this.popupConfig){this.popupConfig=this.parent.getPopupConfig();}}}]});this.addChildren([this.linkMenuCfg]);this._targetNameChangeListener=model.attachEventListener("ontitleChange",this.id,function(evt){var nodeData=bc&&bc.node&&bc.node.data;if(nodeData&&nodeData.navpage===evt.panelKey){nodeData.navpagenm=evt.newTitle;}});},destroy:function destroy(){if(this._targetNameChangeListener){this.model.detachEventListener(this._targetNameChangeListener);}this.linkMenuCfg=null;if(this._super){this._super();}},updateToolbar:function updateToolbar(cfg){var me=this,text;if(this._super){cfg=this._super(cfg);}if(!mstrApp.isAppStatePresentation()){text=this.boxContent.hasActiveLink()?mstrmojo.desc(15703,"Edit Link..."):mstrmojo.desc(15702,"Link...");cfg.addMenuItem(text,"lnk",function(){var btnNode=me.linkBtnNode;$CSS.removeClass(btnNode,$CLASS_HIDDEN);btnNode.click();});}return cfg;},addContextMenuItems:function addContextMenuItems(menuCfg){return this.updateToolbar(menuCfg);},onmouseover:function onmouseover(evt){if(!this._disableShow){this._super(evt);if(this.boxContent.hasActiveLink()&&!mstrApp.isAppStatePresentation()){window.clearTimeout(this._hideLinkHandler);$CSS.removeClass(this.linkBtnNode,$CLASS_HIDDEN);}}},onmouseout:function onmouseout(evt){this._super(evt);buttonFadeOut.call(this);},hideLinkButton:function hideLinkButton(){this.onmouseout();this._disableShow=true;},unhideLinkButton:function unhideLinkButton(){this._disableShow=false;}});}());