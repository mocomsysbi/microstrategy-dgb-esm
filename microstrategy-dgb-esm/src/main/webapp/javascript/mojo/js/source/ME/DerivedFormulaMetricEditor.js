(function(){mstrmojo.requiresCls("mstrmojo.array","mstrmojo.ME.MetricEditor","mstrmojo.ME._DerivedMetricEditorHelper","mstrmojo.ME._HasConditionMetricFilterEditor","mstrmojo.mstr.EnumDSSXMLObjectTypes","mstrmojo.mstr.EnumDSSXMLObjectSubTypes");mstrmojo.requiresDescs(2213,8950);var $DESC=mstrmojo.desc,ARR=mstrmojo.array,OBJECT_TYPE=mstrmojo.mstr.EnumDSSXMLObjectTypes,OBJECT_SUB_TYPE=mstrmojo.mstr.EnumDSSXMLObjectSubTypes;mstrmojo.ME.DerivedFormulaMetricEditor=mstrmojo.declare(mstrmojo.ME.MetricEditor,[mstrmojo.ME._DerivedMetricEditorHelper,mstrmojo.ME._HasConditionMetricFilterEditor],{scriptClass:"mstrmojo.ME.DerivedFormulaMetricEditor",title:mstrmojo.desc(2536,"Derived Metric:"),init:function init(props){mstrmojo.css.addWidgetCssClass(this,"dme");this._super(props);},hasConditionFilter:function hasConditionFilter(){var tks=this.oi&&this.oi.tks,items=tks&&tks.items,hasFilter=false;ARR.forEach(items,function(tk){if(tk&&tk.oi&&tk.oi.t===OBJECT_TYPE.Filter&&tk.oi.st===OBJECT_SUB_TYPE.Filter){hasFilter=true;return false;}});return hasFilter;},clearConditionFilter:function clearConditionFilter(){var tks=this.oi&&this.oi.tks,items=tks&&tks.items;for(var i=0;i<items.length;i++){var tk=items[i];if(tk&&tk.oi&&tk.oi.t===OBJECT_TYPE.Filter&&tk.oi.st===OBJECT_SUB_TYPE.Filter){var preTk=i>0?items[i-1]:undefined,deleteIdx=i,deleteCnt=1;if(preTk&&preTk.v==="<"){deleteIdx=i-1;for(var j=deleteIdx+1;j<items.length;j++){var token=items[j];deleteCnt++;if(token.v===">"){break;}}}items.remove(deleteIdx,deleteCnt);i=deleteIdx-1;}}}});}());