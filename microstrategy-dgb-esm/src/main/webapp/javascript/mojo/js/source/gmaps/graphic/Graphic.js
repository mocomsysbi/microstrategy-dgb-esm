(function(){mstrmojo.requiresCls("mstrmojo.Obj","mstrmojo.hash","mstrmojo.array","mstrmojo.gmaps.MapUtils","mstrmojo.gmaps.GraphicUtils");var $MOJO=mstrmojo,$H=$MOJO.hash,$ARR=$MOJO.array,$GMAPS=$MOJO.gmaps,$EnumGeometryType=$GMAPS.EnumGeometryType,$MUTIL=$GMAPS.MapUtils,$GUTIL=$GMAPS.GraphicUtils;mstrmojo.gmaps.graphic.Graphic=mstrmojo.declare(mstrmojo.Obj,null,{scriptClass:"mstrmojo.gmaps.graphic.Graphic",type:null,parent:null,geoData:null,screenData:null,geometry:null,attributes:null,init:function init(props){this._super(props);if(!!this.geometry){this.setGeometry(this.geometry);}},setGeometry:function setGeometry(geometry){if(!geometry){console.log("setGeometry(): invalid geometry");return ;}if(this.geometry!==geometry){this.destroyGeometry();}this.geometry=geometry;this._addGraphicIDToNode();},_addGraphicIDToNode:function _addGraphicIDToNode(){var node=this.geometry&&this.geometry.node;if(node){node.graphicID=this.id;}},getGeometryArr:function getGeometryArr(){var geometry=this.geometry;if(this.parent instanceof $GMAPS.layer.DensityLayer&&!geometry){geometry=$H.copy(this.screenData,{type:$EnumGeometryType.Point});}return(!!geometry)?[geometry]:[];},getPositionInfo:function getPositionInfo(){return this.screenData;},updatePosition:function updatePosition(screenData){var geometry=this.geometry;this.screenData=screenData;if(!!geometry&&geometry.update instanceof Function){geometry.update(screenData);}},setHover:function setHover(isHovered){var geometry=this.geometry;if(geometry&&(geometry.setHover instanceof Function)){geometry.setHover(isHovered);}},setSelection:function setSelection(isSelected){var geometry=this.geometry;if(geometry&&(geometry.setSelection instanceof Function)){geometry.setSelection(isSelected);}this.setIsSelected(isSelected);},setContextMenuSelection:function setContextMenuSelection(isSelected,isContextMenuSelected){var geometry=this.geometry;if($MUTIL.checkHasFunction(geometry,"setContextMenuSelection")){geometry.setContextMenuSelection(isSelected,isContextMenuSelected);}},setIsSelected:function setIsSelected(isSelected){this._isSelected=!!isSelected;},isSelected:function isSelected(){return this._isSelected;},getDataRowIdx:function getDataRowIdx(){var rowIndices=this.attributes&&this.attributes.rowIndices;if(!!$ARR.isArray(rowIndices)){return rowIndices[0];}},getDataRowIndices:function getDataRowIndices(){var rowIndices=this.attributes&&this.attributes.rowIndices;if(!$ARR.isArray(rowIndices)){console.log("getDataRowIndices@Graphic: Graphic with no attributes or rowIndex");return[];}return rowIndices;},getLayerKey:function getLayerKey(){if(this.parent){return this.parent.key;}},getGeoName:function getGeoName(){var attrs=this.attributes;return attrs&&(attrs.originGeoName||attrs.geoName);},matchLocationName:function matchLocationName(matchPattern){if(!matchPattern){return[];}var geoName=this.getGeoName(),re=new RegExp(matchPattern,"i");return(!!geoName&&re.test(geoName))?[this]:[];},getGraphicsForSelection:function getGraphicsForSelection(){return[this];},getGraphicSize:function getGraphicSize(){var geometry=this.geometry;return(geometry&&geometry.getGeometrySize instanceof Function&&geometry.getGeometrySize())||0;},isClusterGraphic:function isClusterGraphic(){return false;},getGeoExtent:function getGeoExtent(isNotGeo){if(this.type===$EnumGeometryType.Polygon&&!this.geoExtent){this.geoExtent=$GUTIL.calGeoExtent(isNotGeo,this.geoData);}return this.geoExtent;},getGeoCenter:function getGeoCenter(){var geoData=this.geoData;if(geoData&&!$ARR.isArray(geoData)){return{lat:geoData.lat,lng:geoData.lng};}},intersect:function intersect(shapeGmt){var geometryArr=this.getGeometryArr(),isIntersect=false,i,il;if(!$ARR.isArray(geometryArr)||!shapeGmt||!(shapeGmt.intersect instanceof Function)){return isIntersect;}for(i=0,il=geometryArr.length;i<il;i++){if(geometryArr[i]){isIntersect=shapeGmt.intersect(geometryArr[i],this.geoData);if(isIntersect===true){break;}}}return isIntersect;},getGraphicLayer:function getGraphicLayer(){var graphic=this.parentGraphic||this;return graphic.parent;},moveGraphicToTop:mstrmojo.emptyFn,moveGraphicToBottom:mstrmojo.emptyFn,destroyGeometry:function destroyGeometry(){var geometry=this.geometry;if($MUTIL.checkHasFunction(geometry,"destroy")){geometry.destroy();}this.geometry=null;},destroy:function destroy(){this.parent=null;this.parentGraphic=null;this.destroyGeometry();this._super();}});}());