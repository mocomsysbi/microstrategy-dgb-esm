mstrmojo.EnumReadystate={IDLE:1,WAITING:3,ERROR:4,SUCCESS:5,CANCELLED:6,TIMEOUT:7};(function(){mstrmojo.requiresCls("mstrmojo.dom","mstrmojo.css");var J={T:["top","left"],D:["height","width"],B:["border","border-color","border-style","border-width"],F:["font","color","text-decoration"],P:["padding"],BG:["background-color","fx"],RW:[]};J.RW=["z-index"].concat(J.T.concat(J.D));var D=mstrmojo.dom,O=mstrmojo.css;function N(T,V,S){var U=T[V]||[];U.push(S);T[V]=U;}function L(W,V){var U=((W&&W.fmts)||null);if(V){var Y=W.thresholds,T=Y&&Y[V];if(T){var X={},Z;for(Z in U){X[Z]=T[Z]||U[Z];}for(Z in T){var S=T[Z];X[Z]=(typeof S==="string")?(S+" !important"):S;}U=X;}}return U;}mstrmojo._Formattable=mstrmojo.provide("mstrmojo._Formattable",{_mixinName:"mstrmojo._Formattable",formatHandlers:null,thresholdId:null,getCacheKey:function E(){return"css_cache"+(this.thresholdId||"");},update:function G(T){var S=true;this.invisible=!!(T&&T.data&&T.data.invisible);if(this._super){S=this._super(T);}return S;},buildCSSFormatString:function H(U,d){var h=this.formatHandlers[U],k=h.src?d[h.src]:d;if(!k){return null;}var b=h.props||h;if(!b){return null;}var X=[],g=-1;var V=b.length-1;for(V;V>=0;V--){var j=b[V];var c=J[j]||[j];var a=c.length-1;for(a;a>=0;a--){j=c[a];var T=k[j];if(T!==undefined){if(j==="fx"){var Y=T,S={};var e=Y.gd;if(e){this.formatGradient(e,S);}var W=parseInt(Y.rt,10);if(W){if(W===1||W===3){this.formatTextRotation(Y.rt,S);}}if(Y.ds){this.formatDropShadow(Y,S);}var Z;for(Z in S){X[++g]=Z+":"+S[Z].join(" ");}}else{X[++g]=j+":"+T;}}}}if(this.invisible){X.push("visibility:hidden");}return X.join(";")+";";},applyCSSFormatToNode:function I(U,S){var V=this[U],T=V&&V.style;if(T){this.buildCSSFormatString(U,S).split(";").forEach(function(W){var X=W.split(":");T[O.convertCssToCamelCase(X[0])]=X[1];});}},clearSlotBackgroundCSS:function F(T){var U=this[T],S=U&&U.style;if(S){S.background="transparent none 0 0 no-repeat";S.filter="none";}},preBuildRendering:function B(){this._super();var V=this.formatHandlers,S=this.getFormats();if(V&&S){var W=this.defn=this.defn||{},X=this.getCacheKey(),U=W[X];if(!U){U=W[X]={};for(var T in V){var Z=T+"CssText";this[Z]=U[Z]=this.buildCSSFormatString(T,S)||"";}}else{var Y;for(Y in U){this[Y]=U[Y];}}}return true;},formatGradient:function P(S,U){var T=O.buildGradient(S.t,S.sc,S.ec);if(T){N(U,T.n,T.v);}},formatDropShadow:function K(W,U){if(D.supports(D.cssFeatures.DROP_SHADOW)){var V=W.ds;if(D.isDXIE){N(U,"filter","progid:DXImageTransform.Microsoft.DropShadow(Color='#66000000',Positive='true',OffX="+V+",OffY="+V+")");}else{var S=[V,V],T=parseInt(W.rt,10);if(T===1||T===3){S[((T===1)?1:0)]=-V;}N(U,(D.isWK?"-webkit-":"")+"box-shadow",S.join("px ")+"px 3px 0px #888");}}},formatTextRotation:function C(T,S){if(D.supports(D.cssFeatures.TEXT_ROTATION)){if(D.isDXIE){N(S,"filter","progid:DXImageTransform.Microsoft.BasicImage(rotation="+T+")");}else{var U=(T===1)?90:-90;N(S,D.CSS3_PREFIX+"transform-origin","top left");N(S,D.CSS3_PREFIX+"transform","rotate("+U+"deg)");}}},getFormats:function R(){if(!this.fmts){this.fmts=L.call(this,this.defn,this.thresholdId);}return this.fmts;},clearFormats:function A(){this.fmts=undefined;},createEmptyFormats:function(){return(this.fmts=this.fmts||{});},clearCache:function Q(){delete this.defn[this.getCacheKey()];},unrender:function M(S){if(this.thresholdId){this.fmts=null;}this._super(S);}});mstrmojo._Formattable.getBorderWidths=function(W){var V=W.getFormats(),S=(V.border)?V.border.match(/(\d*|\d*\.\d*)pt/)[0]:V["border-width"],U=W.model,T=U.docModel;return O.getBorderWidths(S,(T&&T.dpi)||U.dpi);};}());(function(){mstrmojo.requiresCls("mstrmojo.EnumReadystate");var D=mstrmojo.EnumReadystate;var A=1200;var C=function(F,E){if(E){E.style.display=F?"block":"none";}};mstrmojo._HasWaitIcon={waitHandle:null,postBuildRendering:function B(){if(!this._rsl){var E=this.id;this._rsl=this.defn.attachEventListener("readyStateChange",E,function(G){if(!this.hasRendered){return ;}switch(G.value){case D.WAITING:if(!this.waitIcon&&this.domNode){var H=document.createElement("div");H.className="mojo-overlay-wait";H.innerHTML='<div class="overlay"></div><div class="icon"></div>';this.domNode.appendChild(H);this.addSlots({waitIcon:H});}var F=this.waitIcon;if(A){this.waitHandle=window.setTimeout(function(){if(mstrmojo.all[E]){mstrmojo.all[E].waitHandle=null;}C(true,F);},A);}else{C(true,F);}break;case D.IDLE:if(this.waitHandle){window.clearTimeout(this.waitHandle);this.waitHandle=null;}C(false,this.waitIcon);break;}});}return this._super();}};}());(function(){mstrmojo.markup={apply:function B(E,G){var F=(/mstrmarkup\:markup/).test(E)?this.dhtml(E):E;return F.replace(this._REG_EXP_TOKENS,function H(I,J){return(J in G&&G[J]!==null)?G[J]:"";});},dhtml:function D(E){return(E||"").replace(/^<mstrmarkup:markup[^\>]*?\>/,"").replace(/<\/mstrmarkup:markup\>/,"");},slots:function C(H){var J={};function G(N){var O=N.getAttribute("mstrSlot");if(O){var L=O.split(/\s*,\s*/);for(var M=0,K=L.length;M<K;M++){J[L[M]]=N;}}}G(H);var E=H.getElementsByTagName("*");for(var F=0,I=E&&E.length||0;F<I;F++){G(E[F]);}return J;},_REG_EXP_TOKENS:/\{\@([^\}]+)\}/gm,useCache:false,methods:function A(G){var K=this.useCache&&this._findCache(G);if(K){return K;}var F={lookup:{},sequence:[]};var E=G&&G.match(/<mstrmarkup\:markup(.*?)\>/);if(!E){return F;}var H=E[1],I;while((I=H.match(/([^\s=]+)=\"([^\"]+)\"/m))){var J=I[1];F.lookup[J]=new Function(I[2]);F.sequence.push(J);H=H.substr(I.index+I[0].length);}if(this.useCache){this._writeCache(G,F);}return F;},_cache:[],_writeCache:function(E,F){this._cache.push({markup:E,data:F});},_findCache:function(F){var I=this._cache,G;for(var H=0,E=I.length;H<E;H++){if(I[H].markup==F){G=I[H];break;}}return G&&G.data;}};})();(function(){mstrmojo.requiresCls("mstrmojo.dom","mstrmojo.hash");mstrmojo.touchManager=new mstrmojo.Obj({notify:function(r,s){return this.raiseEvent({name:"touchesBegin",srcId:r,touch:s});}});var V=mstrmojo.dom,o=V.attachEvent,p=V.detachEvent,B=Math,W=window.mstrConfig,Q=false,J=null,h=W&&W.allowDefaultTouches;var g=10,D=250,F=400,Y=100;var f="Begin",N="End",c="Move",S="Cancel";var l=1,m=2,C=3,P=4;var K={};K[l]="Select";K[m]="Swipe";K[C]="Multi";K[P]="Tap";o(document.body,"touchmove",function(r){if(!W||!W.allowDefaultTouches){if(r.preventDefault){r.preventDefault();return false;}}return true;});function X(r){var s=r.identifier;return(s===undefined)?1:s;}function j(u,v,t,s){if(Q){var r=s?X(s)+" ":"";window.console.log(u+":"+(t?" "+t.scriptClass+" "+t.id:"")+" "+r+(v||""));}}function k(r){return(J===r);}function T(r){if(!k(r)){return ;}j("detachWinEvts","",r);p(window,V.TOUCHMOVE,r._tmCallback,true);p(window,V.TOUCHEND,r._teCallback,true);p(window,V.TOUCHCANCEL,r._teCallback,true);J=null;}function U(r){if(k(r)){return ;}var s=J;if(s){j("forced deactivation","",s);T(s);}j("attachWinEvts","",r);o(window,V.TOUCHMOVE,r._tmCallback,true);o(window,V.TOUCHEND,r._teCallback,true);o(window,V.TOUCHCANCEL,r._teCallback,true);J=r;}function M(s,r){return"touch"+((r&&K[r])||"")+(s||"");}function Z(t,u,s){var r=M(u,s);return(t[r]!==undefined)?r:"";}function n(u,w,x,t,s){s=s||u.gestures[x.id];var v=(s&&s.bubbleTarget)||u,r=Z(v,w,t);if(r){j("fire",r,v);x.methodName=r;return v[r](x);}j("no handler",M(w,t),v);return true;}function d(z,AA,r,v){var w=r.pageX,u=r.pageY,x=z.timeStamp,s=X(r),AE={x:B.round(w-AA.pageX),y:B.round(u-AA.pageY)};var AD={id:s,evt:z,pageX:w,pageY:u,clientX:r.clientX,clientY:r.clientY,target:r.target,delta:AE,date:x,stop:function(){j("event stopped",s);z.stopPropagation();z.cancelBubble=true;}};if(v){var t=x-v.date,AC=v.delta,y={x:B.abs(AE.x-AC.x),y:B.abs(AE.y-AC.y)};AD.velocity={x:y.x/t,y:y.y/t};AD.isVertical=(y.y>y.x);AD.accelDelta=y;var AB=AD.direction={};if(w!==v.pageX){AB.x=(w<v.pageX);}else{if(w!==AA.pageX){AB.x=(w<AA.pageX);}}if(u!==v.pageY){AB.y=(u<v.pageY);}else{if(w!==AA.pageX){AB.y=(u<AA.pageY);}}}return AD;}function I(u,r,t,s){return{s:u,p1:r,p2:t,evt:s,target:s.target};}function L(s,r){if(s){s.gestures[r]=null;}}function a(s,r){T(s);n(s,N,r);}function G(r){if(r._selectHandle){window.clearTimeout(r._selectHandle);delete r._selectHandle;j("cancelSelect","",r);}}function H(x,z){var v=z.which;if(v&&v===3){j("ignore","right mouse click",x);return ;}var y=x.gestures,w=z.touches||[z],r=(z.changedTouches&&z.changedTouches[0])||z,AC=k(x),AD=d(z,r,r),AB=I(AD,AD,AD,z);j("touchBegin","",x,r);if(w.length>1){if(!AC){AD.stop();j("ignore","cross widget multitouch",x,r);var u=J;if(u&&u.onCrossWidgetMultitouch!==undefined){j("call onCrossWidgetMultitouch for","",u);u.onCrossWidgetMultitouch();}return false;}}else{if(AC){j("forced deactivation","",x,r);T(x);AC=false;}}if(x.singleNode&&r.target!==x._tn){j("ignore","target is not touch node",x,r);return ;}if(mstrmojo.touchManager.notify(x.id,AD).ignore){AD.stop();return ;}if(!AC){var t=AD.target.tagName;t=t&&t.toLowerCase();if(t==="select"||t==="input"){j("ignore","target is input or select",x,r);if(x.monitorInputs){n(x,null,AD,P);}return ;}}y[AD.id]=AB;if(AC){if(!x.multiTouch){G(x);var s=w[w.length-2],AA=y[X(s)];n(x,S,s,AA.action,AA);}else{AB.action=C;if(x._singleTouch){G(x);x._singleTouch.action=C;delete x._singleTouch.bubbleTarget;delete x._singleTouch;n(x,f,AD,C);}}AD.stop();return ;}if(!V.contains(x._tn,z.target,true,x.domNode)){delete y[AD.id];return ;}x._singleTouch=AB;if(n(x,f,AD)===false){return ;}AD.stop();if(Z(x,f,l)){x._selectHandle=window.setTimeout(function(){AB.action=l;if(n(x,f,AD,l)===false){a(x,AD);}delete x._selectHandle;},F);}U(x);}function q(v,w){var y=(w.changedTouches&&w.changedTouches[0])||w,s=v.gestures[X(y)];if(!s){return ;}var t=d(w,s.s,y,s.p2),u=s.action;s.p2=s.p1;s.p1=t;if(!u&&(B.abs(t.delta.x)>g||B.abs(t.delta.y)>g)){u=s.action=m;G(v);if(!Z(v,f,u)&&!Z(v,c,u)){t.methodName=M(f,u);return v.bubbleTouchEvent(t);}if(n(v,f,t,u)===false){a(v,t);return ;}}if(u){var r=s.lastMove||s.s.date,x=t.date-r;if(!mstrApp.isTouchApp()||x>=Y){s.lastMove=t.date;n(v,c,t,u);}}}function E(v,x){var r=(x.changedTouches&&x.changedTouches[0])||x,y=(x.touches&&x.touches.length)||0,w=v.gestures,AB=X(r),AA=w[AB];if(!AA){j("No gesture",AB,v,r);return ;}var u=AA.action,AC=d(x,AA.s,r,AA.p2);if(!u){G(v);if(!AA.wasMulti){u=P;}}if(y===0){T(v);v.gestures=[];j("gestures","clear all",v,r);}else{w[AB]=null;j("gestures","clear single",v,r);}L(AA.bubbleTarget,AB);switch(u){case m:case l:AC.stop();n(v,N,AC,u,AA);break;case C:if(y<2){n(v,N,AC,u,AA);if(y===1){var t=x.touches[0],z=d(x,t,t),s=I(z,z,z,x);s.wasMulti=true;w[X(t)]=s;v._singleTouch=s;}}if(y>0){return ;}break;case P:if(!Z(v,null,u)){break;}var AD=v._tapHandler;if(AD){window.clearTimeout(AD.h);}if(AC.date-AA.s.date<F){if(n(v,"Before",AC,u,AA)===false){break;}if(!v.multiTap){AC.count=1;n(v,null,AC,u,AA);}else{if(AD){AD.count++;}else{AD=v._tapHandler={count:1};}AD.h=window.setTimeout(function(){AC.count=AD.count;n(v,null,AC,u,AA);delete v._tapHandler;},D);}}else{delete v._tapHandler;}break;}n(v,N,AC,undefined,AA);}function b(s){var r=s._tn;if(!r){return ;}if(!s._tmCallback){s._tsCallback=function(t){H(s,t);};s._tmCallback=function(t){q(s,t);};s._teCallback=function(t){E(s,t);};}o(r,V.TOUCHSTART,s._tsCallback);}mstrmojo._TouchGestures=mstrmojo.provide("mstrmojo._TouchGestures",{_mixinName:"mstrmojo._TouchGestures",singleNode:false,multiTouch:false,touchNode:null,multiTap:false,monitorInputs:false,postBuildRendering:function O(){if(this._super){this._super();}this._tn=this.touchNode||this.domNode;this.gestures=[];b(this);},bubbleTouchEvent:function e(x){var u=x.methodName,r=x.id,s=this.gestures[r],t=this.parent;while(t){var w=t[u],v=t.touchBegin;if(w&&(!v||n(t,f,x)!==false)){x.methodName=u;L(s.bubbleTarget,r);s.bubbleTarget=t;t.gestures[r]=s;j("bubble",((this.k)?" "+this.k:"")+"] bubbled "+u+" to ["+t.scriptClass+((t.k)?" "+t.k:"")+"]",this,x);return w.call(t,x);}t=t.parent;}return false;},unrender:function A(s){if(k(this)){T(this);}var r=this._tn;if(r){V.detachEvent(r,V.TOUCHSTART,this._tsCallback);}this._super(s);},restoreDefaultTouches:function R(r){if(W){W.allowDefaultTouches=r&&h;}}});}());(function(){mstrmojo.requiresCls("mstrmojo.Obj","mstrmojo.hash","mstrmojo.dom","mstrmojo.array");var R=Math,U=mstrmojo.publisher.hasSubs,Q=mstrmojo.hash,F=Q.forEach,a=mstrmojo.dom;var S=0.15;var d=1,T=2;var B={y:{edge:["top","bottom"],size:0},x:{edge:["left","right"],size:0},clsName:"mstrmojo-touch-scroll-indicator",init:function Y(){var h=this.y,g=this.x;if(!h.i){var j=h.i=document.createElement("div");j.className=this.clsName;var k=g.i=j.cloneNode(false);document.body.appendChild(j);document.body.appendChild(k);}},setGradient:function Z(o,j,p,l){var n=o.i,h=o.edge[j?1:0];var m=R.min(R.round(R.min(R.abs(p)/200,1)*100),l/2),g="left top",k="left bottom";if(j){k=g;if(h==="bottom"){g="left bottom";}else{g="right top";}}else{if(h==="left"){k="right top";}}if(m!==o.size){n.style.background="-webkit-gradient(linear, "+g+", "+k+", from(rgba(39, 104, 162, .4)), to(rgba(39, 104, 162, 0)), color-stop("+(m/100)+", rgba(39, 104, 162, 0)))";o.size=m;}},scrollAxis:function D(k,t,m,r,j){var y=t-m,h=j[k]=(y!==0);if(!h){this.hide(k);return ;}var n=this[k],q=n.i,g=q.style,o=(k==="y"),p=(y>0),s=this.clsName+" "+n.edge[p?1:0];if(!n.size||q.className!==s){q.className=s;var u="px",z=3,v=r.y,l=r.x,w=100,x=r.w;if(o){if(p){v+=r.h-w-z;}}else{x=w;w=r.h;if(p){l+=r.w-x-z;}}g.top=v+u;g.left=l+u;g.width=x+u;g.height=w+u;g.display="block";}this.setGradient(n,p,y,o?r.h:r.w);},scroll:function D(k,j,n,m,q){var p=j.x,o=j.y;if(p!==n||o!==m){this.init();var l=this._widgetPosition;if(!l){var g=k.indicatorEl||q;l=mstrmojo.dom.position(g.parentNode);}var h=k._outOfBounds||{};this.scrollAxis("y",o,m,l,h);this.scrollAxis("x",p,n,l,h);this._widgetPosition=l;k._outOfBounds=h;}else{this.hideAll();delete k._outOfBounds;}},hide:function M(h){var g=this[h];if(g.size!==undefined){g.i.style.display="none";g.i.className=this.clsName;g.size=0;}},hideAll:function b(){this.hide("y");this.hide("x");delete this._widgetPosition;}};function W(g,h){return h?R.max(R.min(R.round(g),h.end),h.start):g;}function O(g,j,h){h.name=j;h.id=g.identifier;g.raiseEvent(h);}function G(){var h="scrollDone",g=this.origin;if(U(this.id,h)&&g){O(this,h,{x:g.x,y:g.y});}this.stopDeceleration();}function I(j,h,m){var l=j.scrollEl;if(!l){G.call(j);return ;}var k={x:h.x||0,y:h.y||0};F(j._scrollBarEls,function(y,s){var AD=(s==="x"),x=k[s],n=y.length,z=y.ratio,u=y.viewportSize,r=6/n,q=y["base"+(AD?"Left":"Top")],w=q+u-n,p=R.round(q+(z*x));if(p<q){p=q-x;n+=x;}else{if(p>w){var AC=(x-j.offset[s].end)*z;p=R.min(w+AC,u+q-6)-1;n-=AC;}}var AB=0,o=[AB,AB,AB],t=[1,1,1],AA=AD?0:1;o[AA]=(p-q);t[AA]=R.min(R.max(n/y.length,r),1);a.translate(y,o[0],o[1],o[2]," scale3d("+t.join(",")+")");});if(m){m+="ms";}if(j._isHosted){var g=l.parentNode;g.scrollTop=k.y;g.scrollLeft=k.x;}else{l.style[a.CSS3_TRANSITION_DURATION]=m||"0";a.translate(l,-k.x,-k.y,0,j.transform,j.useTranslate3d);}if(U(j.id,"scrollMoved")){O(j,"scrollMoved",{x:h.x,y:h.y});}}function J(g,h,j){return R.ceil(1+R.log(g/R.abs(h))/R.log(1-j));}function E(g,l,j,h,k){return g+(l*(j*(1-R.pow(1-k,h))/k));}function N(AD,AN,m,AJ,v,AI,r){var q=AD.offset[m];if(!q){return AN;}var l=AD._outOfBounds,h=l&&l[m],t=q.incFetch,u=AD.friction,p=q.start,o=q.end,AE=AJ?o:p;v=R.abs(v);if(h){AJ=(AN<p);AE=AJ?p:o;}var AM=AJ?1:-1;if(h&&(AJ||!t)){var s=S*3,AL=1/(1-u),k=s/R.pow((1-u),(R.log(1-R.abs(AN-AE)*(1-AL)/s)/R.log(AL))-1);var AB=R.round(E(AN,AM,k,AI,u));if(AJ?(AB>=AE):(AB<=AE)){G.call(AD);return AE;}return AB;}var AH=q.pageSize,AG=q.supportedEdges;var n=E(AN,AM,v,AI,u),w=(n<=p),j=(n>=o);if(w||j){if(t&&((w&&((AG&d)>0))||(j&&((AG&T)>0)))){if(n-o>=AH){n=o+AH;AE=n;}if(!AD.STATUS_INC_FETCH){AD.STATUS_INC_FETCH=true;O(AD,"incFetch",{edge:j?T:d});}}else{if(AD.bounces){var AK=u*2,x=AD.bounceVelocity,g=AD.bounceTime,AF=AD.bounceDistance;if(!AD.hasBounced){x[m]=R.abs(S/R.pow(1-u,r-AI-1));g[m]=J(S,x[m],AK);AF[m]=R.abs(E(n,AM,x[m],g[m],AK)-n);AD.raiseEvent({name:"bounceOut",id:AD.identifier,axis:m,direction:AJ,value:R.round(n)});AD.hasBounced=true;}var AA=Math.floor(AF[m]/2);var z=E(AE,AM,x[m],AI,AK),AC=R.abs(z-AE);if(R.abs(AC)<AA){return z;}if(R.abs(AC)>=AF[m]){G.call(AD);return AE;}var y=AA-(AC-AA);return R.round(AE-(AJ?-y:y));}n=AE;}}return R.round(n);}function P(h){var g=this._scrollListener;if(g){if(!h||h!==g.el){a.detachEvent(g.el,"scroll",g.fn);delete this._scrollListener;return true;}return false;}return true;}mstrmojo.TouchScroller=mstrmojo.declare(mstrmojo.Obj,null,{scriptClass:"mstrmojo.TouchScroller",scrollEl:null,identifier:"",hScroll:false,vScroll:false,offset:null,origin:null,transform:"",friction:0.0015,frameRate:60,bounces:true,hasBounced:false,bounceDistance:{},bounceTime:{},bounceVelocity:{},showScrollbars:false,showIndicators:true,useTranslate3d:true,STATUS_INC_FETCH:false,init:function Y(g){this._super(g);B.init();},initScroller:function X(h){Q.copy(h,this);var l=this.scrollEl;if(l){var k=this._isHosted=false;if(k){var g=l.parentNode;if(P.call(this,g)){g.style.overflow="auto";var m=this.id,j=this._scrollListener={el:g,fn:function(n){var o=mstrmojo.all[m].origin,p=n.target;o.x=p.scrollLeft;o.y=p.scrollTop;}};a.attachEvent(g,"scroll",j.fn);}this.showScrollbars=false;}}},canScroll:function L(){return this.vScroll||this.hScroll;},updateScrollBars:function H(o,k){var m=this.scrollEl;if(!this.showScrollbars||!m){return ;}var h=this._scrollBarEls;if(!h){var l=this;h=this._scrollBarEls={x:"hScroll",y:"vScroll"};F(h,function(p,q){if(l[p]){var r=document.createElement("div");r.className="mstrmojo-touch-scrollBar "+q+"Axis";(k||m.parentNode).appendChild(r);h[q]=r;}else{delete h[q];}});}if(!o){var g=this.scrollEl.parentNode;o={top:0,right:g.clientWidth,bottom:g.clientHeight,left:0};}var n=9,j={x:{left:o.left,top:o.bottom-n,x:o.right-o.left,d:"Width"},y:{left:o.right-n,top:o.top,x:o.bottom-o.top,d:"Height"}};F(h,function(u,r){var AA=u.style,y=j[r],s=y.d,t=u.parentNode,z=y.x;var q=y.left,w=y.top,v=z/m["offset"+s],p=Math.min(Math.round(z*v),z);u.baseLeft=q;u.baseTop=w;u.ratio=v;u.viewportSize=z;u.length=p;AA.left=q+"px";AA.top=w+"px";AA[s.toLowerCase()]=p+"px";});},toggleScrollBars:function C(g){F(this._scrollBarEls,function(h){h.style.opacity=g?1:0;});},scrollTo:function(h,m,k){if(!this.canScroll()&&!(h===0&&m===0)){I(this,{x:0,y:0});return ;}var l=this.offset,j=this.origin,g={x:(this.hScroll)?W(h,l.x):0,y:(this.vScroll)?W(m,l.y):0};I(this,g,k);j.x=g.x;j.y=g.y;},scrollToEnd:function(h,m,k){var j=this.origin,l=this.offset,g={x:0,y:0};if(j&&l){mstrmojo.array.forEach([h,m],function(o,n){var q=n?"y":"x",p=l[q];g[q]=o?(p&&p.end)||0:j[q];});}this.scrollTo(g.x,g.y,k);},scroll:function D(m){if(this._isHosted){return ;}var k=this.offset,t=this.scrollEl,v=m.delta,w=v.x,u=v.y;if(!t){return ;}if(!k&&this.showIndicators){B.scroll(this,{x:(this.noHScroll)?0:-w,y:(this.noVScroll)?0:-u},0,0,t);return ;}var s=this.origin,n={x:(this.hScroll)?R.round(s.x-w):0,y:(this.vScroll)?R.round(s.y-u):0},q=W(n.x,k.x),p=W(n.y,k.y);if(!k.scrollPast){if(this.showIndicators){B.scroll(this,n,q,p,t);}n.x=q;n.y=p;}else{var l=(q!==n.x),o=(p!==n.y),g=(l||o),j=this._outOfBounds,h="";if(j){if(l!==(j.x===true)||o!==(j.y===true)){h="scrollIn";}}else{if(g){h="scrollOut";}}if(h){if(U(this.id,h)){var r=m.direction;O(this,h,{x:{position:n.x,direction:r.x},y:{position:n.y,direction:r.y}});}if(g){this._outOfBounds={x:l,y:o};}else{delete this._outOfBounds;}}}I(this,n);},scrollEnd:function V(u){B.hideAll();if(!this.canScroll()||this._isHosted){return ;}var AC=this.id,v=this.friction,AK=1/(1-v),AD=this.origin,k=u.velocity,AI=u.direction,AB=new Date(),l=this._outOfBounds,r=this.offset,AJ={x:this.hScroll,y:this.vScroll},w={},AM={},AL={},s={},n={},t={},p={},o={},AF={},AH=function(AP){t[AP]=S;var AO=r[AP],AN=(l&&l[AP]),AQ=(AN&&(!AO||!r.scrollPast));AM[AP]=(AJ[AP]&&!AQ)?AD[AP]-u.delta[AP]:AD[AP];if(AO){p[AP]=AO.start;o[AP]=AO.end;if(AN){if(!AQ){AI[AP]=(AM[AP]<p[AP]);AF[AP]=(AI[AP])?p[AP]:o[AP];if(AI[AP]||!AO.incFetch){t[AP]=S*3;k[AP]=t[AP]/R.pow((1-v),(R.log(1-R.abs(AM[AP]-AF[AP])*(1-AK)/t[AP])/R.log(AK))-1);}}else{AM[AP]=W(AD[AP]-u.delta[AP],AO);}}}w[AP]=(AJ[AP]&&!AQ)?R.abs(k[AP]):0;AL[AP]=(AI[AP]||false)?1:-1;s[AP]=J(t[AP],w[AP],v);n[AP]=E(AM[AP],AL[AP],w[AP],s[AP],v);};AH("x");AH("y");AD.x=AM.x;AD.y=AM.y;var z=(w.x>0),y=(w.y>0);if(!r.scrollPast&&!z&&!y){G.call(this);var m,AE,x,j,AG;for(m in r){AE=r[m];AG=AE.supportedEdges;x=((AE.start===AM[m])&&((AG&d)>0));j=((AE.end===AM[m])&&((AG&T)>0));if(AE.incFetch&&(x||j)){this.STATUS_INC_FETCH=true;O(this,"incFetch",{edge:j?T:d});}}return ;}this.hasBounced=false;this.bounceDistance={};this.bounceTime={};this.bounceVelocity={};this.decelerating=true;var h=Math.round(1000/this.frameRate),q=AB,AA,g={x:z,y:y};this.decelerationTimer=window.setTimeout(function(){var AN=mstrmojo.all[AC],AO=AN.origin,AS=new Date(),AT=(AS-AB),AR;if(AN._halt){G.call(AN);return ;}AA=AS-q;q=AS;if(AA>(h+5)){h=h+R.round((AA-h)/2);}for(AR in g){if(g[AR]){var AQ=N(AN,AM[AR],AR,AI[AR],w[AR],AT,s[AR]);if(!isNaN(AQ)){AO[AR]=AQ;}}}I(AN,AO);var AP=(AT>s.x&&AT>s.y);if(!AP&&!AN.bounces){AP=true;mstrmojo.hash.forEach(r,function(AW,AV){var AU=AO[AV];if(AU!==AW.end&&AU!==AW.start){AP=false;return false;}});}if(AP){G.call(AN);}else{if(AN.decelerating){AN.decelerationTimer=window.setTimeout(arguments.callee,h);}}},h);},stopDeceleration:function A(){var g=!!this.decelerating;if(g){if(this.decelerationTimer){window.clearTimeout(this.decelerationTimer);delete this.decelerationTimer;}delete this.decelerating;this.toggleScrollBars(false);}delete this._outOfBounds;delete this.hasBounced;delete this.bounceDistance;delete this.bounceTime;delete this.bounceVelocity;delete this._halt;return g;},haltScroller:function K(){this._halt=!!this.decelerating;},unrender:function c(){delete this.scrollEl;},destroy:function e(){this.stopDeceleration();P.call(this);this._super();}});mstrmojo.TouchScroller.getScrollPositionTotals=function f(l){var j=l.parent,g=l._scroller,h=mstrmojo.hash.copy((g&&g.origin)||{x:0,y:0});if(j){var k=mstrmojo.TouchScroller.getScrollPositionTotals(j);h.x+=k.x;h.y+=k.y;}return h;};mstrmojo.TouchScroller.ScrollIndicators=B;mstrmojo.TouchScroller.EnumIncFetchEdges={start:d,end:T};}());(function(){mstrmojo.requiresCls("mstrmojo.dom","mstrmojo._TouchGestures","mstrmojo.TouchScroller");var L=mstrmojo.array.forEach,E=mstrmojo.hash.forEach,Z=mstrmojo.dom;function O(e,f){var d;for(d in e){Z.translate(e[d],f[0],f[1],f[2]);}}function R(e){var d=Math.abs;return{x:(d(e.accelDelta.x)<d(e.accelDelta.y)),y:(d(e.accelDelta.y)<d(e.accelDelta.x))};}function J(d,f){d.raiseEvent({name:"scrolledOut",value:f.value,axis:f.axis,direction:f.direction});}function Q(e,j,m,k,n,d,g,f){var l=new mstrmojo.TouchScroller({scrollEl:e,vScroll:m,hScroll:k,frameRate:n,showScrollbars:d,offset:j,origin:{x:0,y:0},bounces:false,useTranslate3d:false,indicatorEl:f});if(g){l.friction=g;}return l;}function B(d){var e;for(e in d){if(d[e].decelerating){d[e].stopDeceleration();}}}var S={x:false,y:false};function U(){var d=S;if(!d.x){return"x";}if(!d.y){return"y";}return null;}var P={x:false,y:false};function N(h,j){var f=U(),g=h.scrollerConfig.scrollPast;if(!f||!g){return !!f&&!g;}function e(l){var d=h.viewport,k=h._TSN[l],p=h._scroller[l],q=h.tPos[l],m=j[l],r=P[l],n=(l==="x")?"y":"x",t=h._scroller[n],s=P[n],o;if(!t[0].decelerating&&s){e(n);}if(q<=0&&m>0){if(!r){if(s){return false;}O(k,[0,0,0]);for(o in p){p[o].scrollEl=d;}P[l]=true;}}else{if(r){O([d],[0,0,0]);for(o in p){p[o].scrollEl=k[o];}P[l]=false;}}return true;}return e(f);}function F(l,d){var h=d.axis,g=l.scrollboxHeightFixed,k=d.name;if(l.ss){var j=l.zones._BR.getRowInfoByPosition(d[h]);j.position=d[h];l.ss.onMove(j);}l.tPos[h]=d[h];if(k==="scrollDone"){E(l._scroller,function(m){L(m,function(n){n.toggleScrollBars(false);});});if(!N(l,d)){return true;}}if(h==="y"){var f=function(m){if(!l._isDownloading&&(-m<=l._TMAX[h])){if(l.onScrolledToLastRow){l.onScrolledToLastRow();}}};if(k==="scrollDone"){delete l._isDecelerating;if(l._cachedDownload){l.dataDownloaded();}else{f(d.y);}if(g){var e=d.y;l.notifyScrollListeners({x:d.x,y:Math.max(e,0)});}}else{if(k==="scrollDecel"){l._isDecelerating=true;f(d.fY);if(g){l.notifyScrollListeners({x:d.fX,y:d.fY});}}else{if(k==="scrollOut"){l._isDecelerating=true;f(d.y.position);}}}}}function I(g,f){var d=Math.abs,h={};var e=h[f]={start:g._TMIN[f],end:d(g._TMAX[f])};h.scrollPast=g.scrollerConfig.scrollPast;if(f==="y"){if(g.useSeamlessIncFetch){e.incFetch=!g.endFetching;e.pageSize=g.scrollboxHeight-((parseInt(g.gridData.rh,10)||25)*4);}}return h;}function W(d){d._scroller={x:[],y:[]};var e=d._viewportCoords;E(d._TSN,function(h,j){var m=I(d,j),k=(j==="y"),l=(j==="x"),f=h.length;L(h,function(q,p){var o=Q(q,m,k,l,d.frameRate,(p===f-1)&&d.scrollerConfig.showScrollbars,d.scrollerFriction,d.domNode);o.updateScrollBars(e,d.domNode);d._scroller[j][p]=o;});var n=d._scroller[j][0],g=["scrollDone","scrollMoved"];if(n){if(k){g=g.concat(["scrollDecel","scrollOut"]);}L(g,function(o){n.attachEventListener(o,d.id,function(p){p.axis=j;F(d,p);});});}});}function A(e){if(this.hasRendered){this[e+"Limit"]=parseInt(this[e],10);if(this.zones){var d=this;window.setTimeout(function(){if(d.hasRendered){d.setOffsets(true);d.setupScrollers();}},0);}}}mstrmojo._HasXtabTouchScroll=mstrmojo.provide("mstrmojo._HasXtabTouchScroll",{noScrolling:false,useTouchScrolling:true,scrollerConfig:{showScrollbars:false,scrollPast:false},_TSN:null,tPos:{x:0,y:0},_TMIN:{x:0,y:0},setupTNs:function T(){this._TSN.x=this._TSN.y=[this.domNode];},touchBegin:function X(h){if(!this.noScrolling){h.stop();if(!this._isDownloading){if(this.toolbarMgr){this.toolbarMgr.closeToolbar();}var g=this._scroller,e=this._TMIN,d=this._TMAX;E(this.tPos,function(j,k){if(j>=e[k]&&j<=Math.abs(d[k])){B(g[k]);}});}var f=this._scroller.x;E(f,function(j){j.origin.x=f[0].origin.x;});}return true;},touchSwipeBegin:function V(k){if(this.noScrolling){return this.bubbleTouchEvent(k);}if(this._isDownloading){return false;}S=R(k);var f=S.y?"x":"y",d=this._scroller[f][0],h=d.offset,g=h[f][k.direction[f]?"end":"start"];if(!h.scrollPast&&g===d.origin[f]){var j=this.bubbleTouchEvent(k);if(j!==undefined){return j;}}var e=this._scroller;if(!N(this,k.delta)){return true;}if(!S.x){B(e.x);}if(!S.y){B(e.y);}E(this._scroller,function(m,l){if(!S[l]){L(m,function(n){n.toggleScrollBars(true);});}});return true;},touchSwipeMove:function D(e){if(!N(this,e.delta)){return true;}var d=this._scroller;L(["x","y"],function(f){if(!S[f]){E(d[f],function(g){g.scroll(e);});}});},touchSwipeEnd:function Y(k){var e=S,g=null,j=k.delta,h=k.direction;if(!e.x&&j.x!==0){g="x";h=h.x?"left":"right";}if(!e.y&&j.y!==0){g="y";h=h.y?"up":"down";}if(g){J(this,{axis:g,value:this.tPos[g],direction:h});var d=this._scroller[g],f;if(!e[g]){for(f in d){d[f].scrollEnd(k);}}}},gridPagesRendered:function C(){if(this._super){this._super();}this.setOffsets(true);},renderEmptyGrid:function G(){if(this._super){this._super();}this.noScrolling=true;},postBuildRendering:function b(){if(this._super){this._super();}if(this.zones&&!this.gridData.eg){var d=this;window.setTimeout(function(){if(d.hasRendered){d._TSN={x:[],y:[]};d.setupTNs();d.setupScrollers();}},0);}},setOffsets:function c(){var g=this,f=this.domNode,e=this.zones,j=e._TR,d=e._BL,h=(!this.isFullScreenWidget&&this.isDocXtab),k=this._viewportCoords={top:j?j.cp.rc*parseInt(this.gridData.rh,10):0,right:h?this.widthLimit:parseInt(this.width,10),bottom:h?this.heightLimit:parseInt(this.height,10),left:d?d.totalColWidth:0};E(this._scroller,function(m,l){L(m,function(n){n.offset=I(g,l);n.updateScrollBars(k,f);var o=n.origin;if(o){n.scrollTo(o.x,o.y);}});});},setupScrollers:function H(){var f=this.gridData,e=this._TMAX,d=this.noScrolling=((f&&f.co)||(!this.scrollerConfig.scrollPast&&e.x===0&&e.y===0));if(!d&&!this._scroller){P={x:false,y:false};O(this._TSN.x,[0,0,0]);O(this._TSN.y,[0,0,0]);W(this);}},onwidthChange:function M(){A.call(this,"width");if(this._super){this._super();}},onheightChange:function K(){A.call(this,"height");if(this._super){this._super();}},unrender:function a(d){E(this._scroller,function(e){L(e,function(f){f.destroy();});});delete this._scroller;if(this._super){this._super(d);}}});}());(function(){mstrmojo.requiresCls("mstrmojo.Widget","mstrmojo._RowRendTracker","mstrmojo.array","mstrmojo.dom","mstrmojo.url","mstrmojo.chart.model.enums.EnumDSSBaseFormType");var L="<tr>";var X=mstrmojo.dom;var g=['<table cellspacing="0" cellpadding="0" style="table-layout:',null,";width:",null,';mstr-tablestyle-slot" ',null,">",null,"<tbody>"];var T="&nbsp;";var f="fsbp_1 ";var W="fsbp_2 ";var Q="fsbp_3 ";var d=1,e=2,G=3,c=4,l=5,S={1:" stack-top",2:" stack-middle",3:" stack-bottom",4:" stack-bottom-last",5:" no-stack",6:" stack-full"},K=1,j=3;var B=mstrmojo.css,Z=mstrmojo.array,P=mstrmojo.chart.model.enums.EnumDSSBaseFormType;var N=4;function Y(p,q,m){var o=true,n=0;if(m.cs>1){for(n=0;n<m.cs;n++){o=o&&p[q+m.cs-n-1];}}else{o=p[q];}return o;}function U(o,n){for(var p=0,m=o.length;p<m;p++){var r=o[p];var q=n.rows[r.rows].cells[r.cells];if(q){mstrmojo.css.addClass(q,f);}}}function b(o){var q=o.indexOf('src="');if(q<0){return o;}var p=o.substring(q+5),n=p.indexOf('"'),r;p=p.substring(0,n);r=p;if(mstrApp.isDossier){r=mstrmojo.url.getFullPath(p);}else{var m=this.parent&&this.parent.controller&&this.parent.controller.model&&this.parent.controller.model.dataService;if(m&&m.getImage){r=m.getImage(p);}}return o.replace(p,r);}function k(q,p){var m="",r="#srcend",n=-1,o,s=q.split("#srcstart");s.forEach(function(t){n=t.indexOf(r);o=t.split(r);o.forEach(function(v,u){if(u===0&&n!==-1){v=v.substring(0,n);m+='<img src="'+v+'" '+p+">";}else{m+=v;}});});return m;}function D(o,n,m){var t=o.outLvl,p="outlineMode",s=this.parent.outlineState,r=o._ei,q=r?(' ei="'+r+'"'):"";if(s&&s[r]){p+=o.hidden?" hiddenRow":"";}else{if((m>0&&t>m)){p+=" hiddenRow";}}if(this.parent.hasEmptyTBody&&p.indexOf("hiddenRow")===-1){this.parent.hasEmptyTBody=false;}return' level="'+t+'" class="'+p+'"'+q+">";}var J=(function(){var p=/\n/g,t="<br/>",y=/<a\s[^>]+>/gi,x="<a ",AG='<a target="_blank" ',n="target=";var w='<a href="',u="",r="</a>",o="<span>",m="</span>",AD="<div>",AC="</div>",AA='<span class="text">',z="</span>",v='<span rabtn class="raBtn ',s='"></span>',AB="iconRA-expand",q="iconRA-collapse",AF="<span>",AE="</span>";return function(AI,AS,AQ){var AV=AI.v||AI.n||T,AM=AI.ts===P.DssBaseFormUrl,AP=AI.ts===P.DssBaseFormHTMLTag,AU=AI.lv!==undefined;AV=(AI.ts===P.DssBaseFormText||AI.mdf===1)?AV.replace(p,t):AV;if(AM){if(!u){u=AS?'" target="_blank">':'">';}AV=w+AV+u+AV+r;}else{if(AP&&AS){(AV.match(y)||[]).forEach(function(AZ){if(AZ.indexOf(n)===-1){AV=AV.replace(AZ,AZ.replace(x,AG));}});}}if(AP){var AJ=document.createElement("div");AJ.innerHTML=AV;var AN=AJ.querySelectorAll("img");Z.forEach(AN,function(Aa){Aa.onload=function AZ(){var Ab=mstrmojo.all[AQ];if(Ab){if(Ab._updateScrollbarTimer){clearTimeout(Ab._updateScrollbarTimer);}Ab._updateScrollbarTimer=setTimeout(function(){Ab.updateScrollbars();},100);}};});AV=AJ.innerHTML;}if((AI.css&&AI.css.indexOf("hl")>-1)||AM){AV=o+AV+m;}if(AU){var AX=AI.lv,AY="&nbsp;&nbsp;&nbsp;&nbsp;",AL="",AH="",AR="",AT;for(AT=0;AT<AX;AT++){AL+=AY;}if(AI.hcd&&AI.fi===undefined){AR=v+(AI.epd?q:AB)+s;}else{AL+=AY;}if(AI.axis===1){AH=AF+AL+AE;}AV=AD+AH+AR+AA+AV+z+AC;}else{if(AI.outLvl&&AI.cs>1&&!AI.isLeaf){var AW=(AI.stt&&!AI.dpt),AK=AW?"":"icon-outline-span"+(AI.epd?" outline-expand":" outline-collapse"),AO=!AW&&AI.epd?' collapsed="true"':"";AV='<span class="'+AK+'"  sty="outimg" dpt="'+AI.outLvl+'"'+AO+"></span>"+AV;}else{if(AI.expandLevel){AV='<span class="icon-outline-span outline-collapse" expandTo="'+AI.expandLevel+'" title=""></span>'+AV;}else{if(AI.fillerCell&&AV==T){AV="";}}}}return AV;};}());mstrmojo.GridBase=mstrmojo.declare(mstrmojo.Widget,[mstrmojo._RowRendTracker],{scriptClass:"mstrmojo.GridBase",markupString:'<span id="{@id}" class="mstrmojo-Grid {@cssClass}" style="{@cssText}"></span>',markupSlots:{gridContainerNode:function(){return this.domNode;}},autoFitWindow:false,tableLayout:null,numAutoHeightRows:0,cp:null,rc:0,cc:0,cws:null,rh:null,totalColWidth:0,start:0,end:0,forceFixedSizes:true,hiliteCellsMap:null,eiMap:null,init:function C(m){this._super(m);},numColumnCanMerge:0,preBuildRendering:function A(){var m=this.cp;if(!m){return ;}m.initContent();this.rc=m.rc||0;this.cws=m.colWidths||[];this.cc=this.cws.length;this.tdWidths=m.tdWidths||[];this.tdCnt=this.tdWidths?this.tdWidths.length:0;this.start=0;this.end=this.rc-1;this.numAutoHeightRows=m.getNumAutoHeightRows&&m.getNumAutoHeightRows()||0;this.hiliteCellsMap={};this.eiMap={};this.posMap=[];this.thPosMap=[];this.totalColWidth=0;},buildRendering:function a(n){var m=this._super(n);this.renderGrid();return m;},renderGrid:function F(n){var m=this.getGridContainer();this.preBuildGridTable();this.buildGridTable(m,n);this.postBuildGridTable();},getGridContainer:function H(){return this.gridContainerNode;},buildGridTable:function M(o,m){var n=this.getTableStartMarkup();var u=this.getTableEndMarkup();if(m){this.mergeHdrsAcrossBlks=true;}var s=this.buildTableRowsMarkup(this.start,this.end,n,u).join("");if(m){var q=document.createElement("div");q.innerHTML=s;var t=o.firstChild,v=t&&t.tBodies,p=q.firstChild.tBodies[0],r=this.matchedHdrsAcrossBlks;t.appendChild(p);if(r&&r.length>0){U(r,v[v.length-2]);}}else{o.innerHTML=s;}this.markPages(this.start,this.end);},getTableStartMarkup:function E(){var n=this._getGridWidths(),m=g;m[1]=n.tableLayout;m[3]=n.totalColWidths;m[5]=this.tableCssClass?"class="+this.tableCssClass:"";m[7]="<colgroup>"+n.colgroup+"</colgroup>";if(this.tbodyStyle){m[8]='<tbody style="'+this.tbodyStyle+'">';}return m.join("");},getTableEndMarkup:function O(){return"</tbody></table>";},_getGridWidths:function R(){var u={};var q="",o=[],t="fixed",n=this.cws,r=n.length;if(r){q=0;o=[];for(var p=0;p<r;p++){if(n[p].w!==""){q+=parseInt(n[p].w,10);}}for(p=0;p<r;p++){var m=n[p];if(m.w!==""&&!this.autoFitWindow&&!this.autoFitContent){var s=parseInt(m.w,10);if(mstrmojo.dom.isIE7){if(s===0){o.push('<col style="width:0%;display:none"></col>');}else{o.push('<col style="width:'+(s/q*100)+'%"></col>');}}else{if(mstrmojo.dom.isWK&&s===0){o.push('<col style="width:-1px"></col>');}else{o.push('<col style="width:'+m.w+'"></col>');}}}else{o.push("<col />");t="auto";}}this.totalColWidth=q;}u.colgroup=o.join("");t=this.tableLayout||t;if(this.autoFitWindow){t=this.tableLayout||t||"fixed";q="100%";}else{if(t==="fixed"){q+="px";}else{q="auto";}}u.totalColWidths=q;u.tableLayout=t;return u;},_CELL_MARKUP:['<td rowSpan="',null,'" colSpan="',null,'" class="',null,'" ei="',null,'" style="',null,'" r="',null,'">',null,"</td>"],buildTableRowsMarkup:function I(AG,Ab,z,u,o){var At=[],Aa=0;At[Aa++]=z||"<table><tbody>";var AS=this.cp,As=this.acws,Av=this.rowMerge,A6=this.headerOffset,A7=this.mxPos,Az=!!AS.gemh,BA=AS.getRowHeight(),n=this._CELL_MARKUP,A8=BA?'<tr style="height:'+(BA?BA+"px":"")+'">':L;var Ay=true,A3=true,AW=[],BD;var Ai=function Ai(r){var m=-1;mstrmojo.array.forEach(As,function(BE,v){r=r-BE;if(r<0){m=v;return false;}});return m;};var AL=function AL(v,r){var m=-1;mstrmojo.hash.forEach(AS.gemh,function(BE,BF){if(v<=BF&&v+r>BF){m=BF;return false;}});return m;};var AF=function AF(BF,BG,BE){var v="",r,m;m=BF.gemh&&BF.gemh[BG];if(m){r=Ai(BE);if(m[r]&&m[r].v===0||A7===BE){v+=f;}}m=BF.gsmh&&BF.gsmh[BG];if(m){r=Ai(BE);if(m[r]&&m[r].v===0||A7===BE){v+=Q;}}return v;};var Aw,AP,Am,AQ=[],AZ,AU,t=0,Ag=0,AX,AB,s=AS.colWidths&&AS.colWidths.length,BB=0,Ap=0,Ak=o||((z&&z.indexOf("table-layout:fixed;")!==-1)?"fixed":"auto"),AJ=mstrApp.isSingleTier;if(As&&Az){for(AZ=0;AZ<As.length-1;AZ++){Ap+=As[AZ];}}Ap=Ap||this.numColumnCanMerge;if(Ak==="fixed"){Aw=[];for(AP=0,Am=this.cws.length;AP<Am;AP++){if(window.parseFloat(this.cws[AP].w)<=0){Aw[AP]=true;}else{Aw[AP]=false;}}}this.matchedHdrsAcrossBlks=[];var x=Ab,A9=this.parent.isOutlineMode,Al=this.parent.gridData,A5=Al.maxLevel,Ac=Al.lvlepd,y=this.parent.id,AT=0;AS.renderingNewPage=true;for(var AV=AG;AV<=Ab;AV++){t=0;BD=Aa++;At[BD]=AV<this.numAutoHeightRows?L:A8;var p=AS.updateCounter,Ad=AS.getRowCells(AV);if(A9&&window.mstrApp&&mstrApp.isExporting){var AI=AS.updateCounter-p;if(AI>0){AT=AI;}if(AT>0){AT--;At[BD]=At[BD].substr(0,At[BD].length-1)+' extra="1">';}}var Af=Ab+1-AV;var AN=0;AB=Av;AX="";if(!this.mergeHdrsAcrossBlks){if(Ay&&AG>0&&Ad.length<AS.colWidths.length){var An=AS.getUnmergedCells(AG),Aj;if(An){AN=An.length;}for(AZ=0,Am=AN;AZ<Am;AZ++){var Ar=An[AZ],A4=Ar.rs;if(A4>Af){n[1]=Af;n[5]=W+Ar.css;}else{n[1]=A4||1;n[5]=Q+Ar.css;}if(Aw&&Aw[Ag+t]){n[5]+=" nwFixedWidth0 ";}if(A4&&A4>1){AQ.push(A4);}t+=Ar.cs||1;if(Ar.cet){n[5]+=" mstrmojo-selected-cell";this.addHilitePosition(Ar.cet,AV,AZ);}if(Ar._ei){this.addExtraInfoMap(Ar._ei,AV,AZ);n[5]+=" pt";}n[9]="";n[13]=T;n[3]=Ar.cs;if(Ar._ei===undefined){Aj=AS.getRowCells(Ar.o+(AS.cps[0]&&AS.cps[0].rc||0),true);Ar=Z.filterOne(Aj,function(m){return m.dpt===Ar.dpt&&m.idx===Ar.idx;});}n[7]=Ar._ei;n[11]=AV;if(Az){if(AB){AX=AF(AS,AV-A6,AZ);}if(!!AX){n[5]=AX+n[5];}else{AB=false;}AX=AF(AS,AL(AV-A6,n[1]),AZ);if(!!AX){n[5]=f+n[5];AB=true;}}At[Aa++]=n.join("");}Ay=false;}}BB=s;Am=Ad.length;var Ae;for(Ae=0;Ae<Am;Ae++){BB-=Ad[Ae].cs||1;}for(Ae=0;Ae<Am;Ae++){var AO=Ad[Ae],A2;if(AO.outLvl){var A0=D.call(this,AO,A5,Ac);At[BD]=At[BD].replace(">",A0);if(AS.updateCounter>0){Ab=x+AS.updateCounter;}}AO.colIx=BB;if(AO.rs&&AO.rs>Af){n[1]=Af;n[5]=f+AO.css;if(AO._ei){this.addExtraInfoMap(AO._ei,AV,Ae);}}else{n[1]=AO.rs||1;n[5]=AO.css;}if(Aw&&Aw[BB]){if(AO.cs==undefined||Y(Aw,BB,AO)){n[5]+=" nwFixedWidth0 ";}}if(AO.rs&&AO.rs>1){AQ.push(AO.rs);}t+=AO.cs||1;if(AO.rowType!==d){n[5]+=" xtab-td ";}if(AO.cet){n[5]+="sc_"+this.parent.k;this.addHilitePosition(AO.cet,AV,Ae);}if(AO.lv!==undefined){n[5]+=" ra ";}A2=AO.rowType;if(A2){n[5]+=S[A2]||"";var AR=AS.getRowHeight(A2);if(AR){At[BD]='<tr style="height:'+(AR?AR+"px":"")+'">';}}n[3]=AO.cs||1;n[7]=AO._ei!==undefined?AO._ei:"";if(AO.fs||AO._e){this.addTitleHeaderPositionMap(AV,Ae+AN,AO);}if(AO._ei!=null){this.addPositionMap(AO._ei,AV,Ae+AN);}n[11]=AV;if(AO.ts===N){if(mstrApp.isDossier){AO.v=mstrmojo.url.getFullPath(AO.v);}var Au=AO.v;if(this.imgCacheMap){var AY=this.imgCacheMap,AU=Au&&Au.replace(/\\/g,"/");if(AY.cachedImg[AU]){AO.v=Au=AY.baseURL+AY.cachedImg[AU];}else{if(AU&&!AY.unCachedImg[AU]){AY.unCachedImg[AU]=AU;}}}else{var AA=this.parent&&this.parent.controller&&this.parent.controller.model&&this.parent.controller.model.dataService;if(AA&&AA.getImage){Au=AA.getImage(Au);}}if(AO.rowType){var AH=(AS.getRowHeight(AO.rowType)||AS.rh||BA),AK=AH,BC=this.tdWidths,AD=AO.colIdx,w=0,AC=0;var Ah=AS.getPadding(K),Ax=AS.getPadding(j);if(AO.rowType===d||AO.rowType===c){AC=AH>(Ah+Ax)?(AH-Ah-Ax):0;}else{if(AO.rowType===e||AO.rowType===G){AC=AH>2*Ax?(AH-2*Ax):0;}else{if(AO.rowType===l){AC=AH>(Ax*2)?(AH-Ax*2):0;}}}if(AD!=="undefined"&&AD>-1&&BC&&BC.length>AD){var AM=BC[AD]&&BC[AD].w;if(AM!=="undefined"){w=parseInt(AM,10);}}var q=w>30?(w-30):0;n[13]='<div><div style="top:'+(-parseInt(AK/2,10))+"px;height:"+(AH-1)+"px;line-height:"+(AH-1)+'px !important;">&nbsp;<img style="max-height:'+AC+"px; max-width: "+q+'px;" src="'+Au+'"></img></div></div>';}else{n[9]="";var Ao="",AE=this.parent&&this.parent.controller&&this.parent.controller.model&&this.parent.controller.model,Aq=AE.getZoomFactor();if(Aq!=1){Ao='onload="this.style.height='+Aq+"*this.offsetHeight+'px';\"";}if(A9){if(Au.indexOf("#srcstart")!==-1){AO.v=k(Au,Ao);}else{AO.v='<img src="'+Au+'" '+Ao+"></img>";}n[13]=J(AO,AJ,y);}else{n[13]='<img src="'+Au+'" '+Ao+"></img>";}if(AO.css&&AO.css.indexOf("hl")>-1){n[13]="<span>"+n[13]+"</span>";}}}else{n[9]="";if(A9&&AO.v&&AO.v.indexOf("#srcstart")>=0){AO.v=k(AO.v,"");n[13]=J(AO,AJ,y);}else{if((mstrApp.isDossier||mstrApp.useBinaryFormat)&&AO.v&&AO.v.indexOf("img")>=0){AO.v=b.call(this,AO.v);}n[13]=J(AO,AJ,y);}}if(Ae<Ap){if(AV===AG&&this.mergeHdrsAcrossBlks){var A1=this.rowHdsAcrossBlks;if(A3&&AO.v&&A1&&A1[Ae]){if(AO.v===A1[Ae].v){n[1]=AO.rs||1;n[5]=Q+AO.css;n[13]="";this.matchedHdrsAcrossBlks.push(A1[Ae]);}else{A3=false;}}}if(Az){if(AB){AX=AF(AS,AV-A6,BB);if(!!AX){n[5]=AX+n[5];if(AX.indexOf(Q)>=0&&AV-A6>1){n[13]=T;}}else{AB=false;}AX=AF(AS,AL(AV-A6,n[1]),BB);if(!!AX){n[5]=f+n[5];AB=true;}}}if(n[1]>=Af&&AO.v){AW.push({rows:AV-AG,cells:Ae,v:AO.v});}}BB+=AO.cs||1;At[Aa++]=n.join("");}At[Aa++]="</tr>";for(Ae=AQ.length-1;Ae>=0;Ae--){AU=AQ[Ae];if(AU<=1){AQ.pop();}else{AQ[Ae]=--AU;}}Ag=AQ.length;}At[Aa++]=u||"</tbody></table>";this.rowHdsAcrossBlks=AW;return At;},addHilitePosition:function(n,o,m){var p=this.hiliteCellsMap[n];if(!p){this.hiliteCellsMap[n]={pos:[],nodes:[]};}this.hiliteCellsMap[n].pos.push({row:o,cell:m,page:0});},addExtraInfoMap:function(n,m,o){if(!this.eiMap[n]){this.eiMap[n]=[];}this.eiMap[n].push({row:m,cell:o,page:0});},addPositionMap:function(n,m,o){if(!this.posMap[n]){this.posMap[n]={row:m,cell:o,page:0};}},addTitleHeaderPositionMap:function(m,p,n){this.thPosMap.push({row:m,cell:p,page:0,obj:n});},clearHilites:function(p){var t=this.hiliteCellsMap[p],r=t&&t.nodes,q=this.parent;if(r){if(r.length==0&&t.pos){r=this.getNodesByPositions(t.pos);}for(var o=0,n=r.length;o<n;o++){var s=r[o],m=q.getCellForNode(s);if(m){delete m.cet;}B.removeClass(s,"sc_"+q.k);}this.hiliteCellsMap[p].nodes=[];}},setHilites:function(n,o){B.addClass(o,"sc_"+this.parent.k);if(!this.hiliteCellsMap[n]){this.hiliteCellsMap[n]={pos:[],nodes:[]};}this.hiliteCellsMap[n].nodes.push(o);var m=this.parent.getCellForNode(o);if(m){m.cet=n;}},getNodesByPositions:function(q){var p=this.tableNode,m=[];for(var o in q){var n=q[o];m.push(p.tBodies[0].rows[n.row].cells[n.cell]);}return m;},preBuildGridTable:function V(){},postBuildGridTable:function h(){this.addSlots({tableNode:this.gridContainerNode&&this.gridContainerNode.firstChild});if(this.tableNode&&mstrApp&&mstrApp.isSingleTier){X.redirectUrlToFormWrapper(this.tableNode);}}});})();(function(){mstrmojo.requiresCls("mstrmojo.Widget","mstrmojo.color","mstrmojo.css","mstrmojo.dom","mstrmojo.GridBase","mstrmojo.array");var X=mstrmojo.css,O=mstrmojo.color,c=mstrmojo.css,E=mstrmojo.dom,I=E.isEdge;function C(e,f){var g=e&&e.parent;while(g&&g.scriptClass.indexOf("DocPanelStack")===-1){if(f in g){return g;}g=g.parent;}return null;}function B(f){var e=document.createElement("img");f.appendChild(e);f.removeChild(e);}function F(e,f){var h=Math.floor(e/f.rowsPerPage),k=e%f.rowsPerPage,j=f.tableNode.tBodies[h],g=j.rows[k].cells;return g;}function J(){var e=this._renderTimer;if(e){self.clearInterval(e);delete this._renderTimer;this.renderingRows=false;}}mstrmojo.Grid=mstrmojo.declare(mstrmojo.GridBase,null,{scriptClass:"mstrmojo.Grid",rowsPerPage:0,effectiveRh:0,numPagesRendered:0,totalPages:0,pageStatus:null,_defaultPageHeight:0,renderPause:10,rhMin:14,defaultRowsPerPage:100,minRowsPerPage:50,init:function H(e){this._super(e);this.forceFixedSizes=true;},initPageSettings:function P(){var h=this.parent,f=h.gridData,g=this.defaultRowsPerPage,e=this.cp.getAvailableRowsCount();this.effectiveRh=this.rh||this.rhMin||1;this.effectiveRh=this.effectiveRh*h.model.docModel.getZoomFactor();if(h&&h.numRowFixed){g=e;}else{if(h&&h.scrollboxHeightFixed){g=Math.ceil(h.scrollboxHeight/this.effectiveRh);g=Math.max(g,this.minRowsPerPage);if(e<g){g=this.minRowsPerPage;this._shouldRenderNextPage=true;}}}if(h.isOutlineMode){g=Math.min(200,e);}this.pageStatus=[];this.rowsPerPage=g;this.initPageStatus(this.pageStatus);this._defaultPageHeight=this.rowsPerPage*this.effectiveRh;},initPageStatus:function a(h){var g=this.rowsPerPage,e,k,f,j=function(n,o,l){var m=this;return function(){if(m._onDemand===undefined){m._onDemand=!n.isDataAvailable(o,l);}return m._onDemand;};};this.totalPages=(g&&Math.ceil(this.cp.rc/g))||0;h=h||this.pageStatus;for(e=0;e<this.totalPages;++e){k=e*g;f=k+g-1;if(!h[e]){h[e]={};}delete h[e]._onDemand;h[e].isOnDemand=j.call(h[e],this.cp,k,f);}},buildRendering:function G(){var e=false;if(this.renderMode==="vscroll"){this.initPageSettings();var h=this.pageStatus[0];e=h&&h.isOnDemand();this.start=0;this.end=-1;if(!e){this.end=Math.min(this.cp.rc,this.rowsPerPage)-1;}this.preRenderPages();this.preRenderPage(0,!e);}this._super();if(this.renderMode==="vscroll"){var g=this.parent;this.gridContainerNode.style[c.MINHEIGHT]=(this.cp.rc*this.effectiveRh)+"px";if(!this.connectedScrollbox){if(g&&g.connectScrollbox){g.connectScrollbox(this);this.connectedScrollbox=true;}}this.postRenderPage(0,!e);this.postRenderPages();var f=g&&!g.scrollboxHeightFixed&&!g.numRowFixed;if(f&&this.numPagesRendered>=this.totalPages&&!e){this.postRenderingCleanup();}else{if(e||f||this._shouldRenderNextPage||(g.isOutlineMode&&this.getPageHeight(this.pageNum)<this._defaultPageHeight)){this.onscroll();delete this._shouldRenderNextPage;}}}},preRenderPages:function S(){},postRenderPages:function b(){if(mstrApp&&mstrApp.isExpress){var f=this.parent.scrollboxNode,g=f.scrollTop,h=f.scrollLeft,e=(g>5)?g-5:0;this.parent.scrollTo({x:h,y:e});this.parent.scrollTo({x:h,y:g});}},configureActions:function N(){var e=this.parent;if(e&&e.configureActions){e.configureActions();}},preRenderPage:function Q(e,f){this.pageNum=e;},postRenderPage:function L(f,h,j){if(f+1>this.numPagesRendered){this.numPagesRendered=f+1;}var e=this.pageStatus,g=e[f];if(!g){g=e[f]={};}if(h){g.filled=true;g.dirty=false;}var k=this.gridContainerNode.style;if(f===this.totalPages-1&&k){k[c.MINHEIGHT]="";}},invalidAllPages:function(){for(var e=0;e<this.totalPages;++e){var f=this.pageStatus[e];if(f.filled){f.dirty=true;}delete f._onDemand;f.filled=false;f.isDownloading=false;}this.thPosMap=[];this.posMap=[];},_startPageRenderThread:function d(e){var f=this.id;this.renderingRows=true;this._renderTimer=self.setInterval(function(){try{var j=mstrmojo.all[f];if(!j){return ;}var g=j.getPagesToRender(e);if(g.length>0){j.preRenderPages();j.renderPages(g);j.postRenderPages();j._postPagesClearup=true;}else{if(j._postPagesClearup){j.postRenderPagesCleanup();j.configureActions();j._postPagesClearup=false;}J.call(j);if(j.isRenderingComplete()){j.postRenderingCleanup();}}}catch(h){J.call(mstrmojo.all[f]);throw h;}},this.renderPause);},onscroll:function Z(f,e){if(!this.renderingRows){if(f===true){var g=this.parent;if(g&&g.maskNode){X.addClass(g.maskNode,"wait");}}window.clearTimeout(this.scrollingTimeOut);this.scrollingTimeOut=window.setTimeout(function(){this._startPageRenderThread(e);}.bind(this),150);}},isRenderingComplete:function R(){if(this.end>=this.cp.rc-1){for(var e=this.pageStatus,f=this.totalPages-1;f>-1;f--){if(!e[f]||!e[f].filled){return false;}}return true;}return false;},renderPages:function D(f){for(var g=0,e=f.length;g<e;++g){this.renderPage(f[g].idx,f[g].fill,g!==e-1);}},renderPage:function Y(o,g,s){var u=this.pageStatus,k=(this.numPagesRendered>=o+1);if(k){if(!g||(u[o]&&u[o].filled)){return ;}}var t=this.rowsPerPage,l=this.domNode,n=this.parent;this.start=o*t;this.end=Math.min(this.start+t,this.cp.rc)-1;this.preRenderPage(o,g);if(g&&n.isOutlineMode){n.hasEmptyTBody=true;}var f=this.tempTable;if(!f){f=this.tempTable=l.ownerDocument.createElement("div");}var r=this.tableNode,q=this.start,h=this.end,m=g?this.buildTableRowsMarkup(q,h,'<table><tbody n="'+this.pageNum+'">',"</tbody></table>",r.style.tableLayout).join(""):'<table><tbody n="'+this.pageNum+'"><tr><td style="height:'+(n.isOutlineMode?this._defaultPageHeight:(this.effectiveRh*(this.end-this.start+1)))+'px">&nbsp;</td></tr></tbody></table>';if(g&&n.hasEmptyTBody){if(!n.outlineState.hasTBodyElementsToExpand){m='<table><tbody n="'+this.pageNum+'"><tr style="height:'+0+'px"></tr></tbody></table>';}else{n.outlineState.hasTBodyElementsToExpand=false;}}f.innerHTML=m;var j=f.firstChild.tBodies[0];if(!k){r.appendChild(j);if(n.isOutlineMode&&n.isAutoTableLayout()){if(n.clonedColHeader){n.clonedColHeader.getTableNode().appendChild(j.cloneNode(true));}if(n.clonedTitle&&n.clonedTitle.getTableNode()){n.clonedTitle.getTableNode().appendChild(j.cloneNode(true));}}}else{r.replaceChild(j,r.tBodies[o]);}if(j&&mstrApp&&mstrApp.isSingleTier){E.redirectUrlToFormWrapper(j);}if(g){this.markPages(q,h);}this.postRenderPage(o,g,j);var e=this.parent;if(e.onPageRendered){e.onPageRendered(j,o,k,g,s);}},getPagesToRender:function U(v){var t=[],x=this.parent,AI=this._defaultPageHeight,l=null,AJ=this.pageStatus,AK=this;function r(j){var m=AJ[j];if(m&&(m.filled||m.dirty)){if(!l){l=AK.tableNode.tBodies;}m.height=l[j].getBoundingClientRect().height;if(I){m.height-=11;}return m.height;}else{return AI;}}var q=0,o=null,u=null,g=x.scrollboxTop;for(var AE=0,AF=this.totalPages,e=this.pageStatus;AE<AF;AE++){q+=r(AE);if(q>=g){o=AE>0?AE-1:AE;break;}}if(o===null){o=u=Math.max(AF-1,0);}else{var w=x.scrollboxBottom;if(isNaN(w)&&x.numRowFixed){w=g;}for(var AD=o+1;AD<AF;AD++){if(parseInt(q,10)>w){u=AD;break;}q+=r(AD);}}if(u===null){u=AF-1;}else{if(u<AF-1&&u<=o){u=u+1;}}for(var z=this.numPagesRendered;z<o;++z){t.push({idx:z,fill:false});}var AC=0,AG=this.rowsPerPage,s=false;for(var AA=o;AA<=u;++AA){var AH=AJ[AA];if(!AH||!AH.filled){if(AH&&AH.isOnDemand()){s=true;if(!AH.isDownloading&&!this.isDownloading){AC+=AG;AH.isDownloading=true;this.isDownloading=true;var k=AA*AG,h=k+AG-1;this.cp.download(k,h,v);}t.push({idx:AA,fill:false});}else{t.push({idx:AA,fill:true});}}}if(x.isOutlineMode&&t.length===0){var AB=x.scrollboxNode.getBoundingClientRect().bottom;while(t.length===0&&u<this.totalPages-1){var f=l[u].getBoundingClientRect().bottom;if(f<AB){u++;if(!AJ[u].filled){t.push({idx:u,fill:true});}}else{break;}}}if(s){this.parent.showDownloadStatus(AC);}else{if(this.parent.closeDownloadStatus){this.parent.closeDownloadStatus();}}return t;},addHilitePosition:function(f,h,e){var j=this.hiliteCellsMap[f];if(!j){this.hiliteCellsMap[f]={pos:[],nodes:[]};}var g=h-(this.pageNum||0)*this.rowsPerPage;this.hiliteCellsMap[f].pos.push({row:g,cell:e,page:this.pageNum});},setHilites:function(h,j){var k=j.getAttribute("ei"),l=this.eiMap[k],e=this.getNodesByPositions(l);if(!e.length){this._super(h,j);return ;}for(var g=0,f=e.length;g<f;g++){this._super(h,e[g]);}},addExtraInfoMap:function(f,g,e){if(!this.eiMap[f]){this.eiMap[f]=[];}this.eiMap[f].push(this.getPosObj(g,e));},addPositionMap:function(f,g,e){if(!this.posMap[f]){this.posMap[f]=this.getPosObj(g,e);}},addTitleHeaderPositionMap:function(g,e,f){var h=this.getPosObj(g,e);h.obj=f;this.thPosMap.push(h);},getPosObj:function(f,h){var g=this.pageNum||0,e=this.rowsPerPage||0;return{row:f-g*e,cell:h,page:g};},getNodeByPosition:function(e){return this.tableNode.tBodies[e.page].rows[e.row].cells[e.cell];},getRowIdxByCell:function(e){var f=this.posMap[e._ei];return f.page*this.rowsPerPage+f.row;},getNodesByPositions:function(m){var j=[];for(var g in m){var o=m[g],f=(o&&o.page)||0,e=o&&o.row,k=o&&o.cell,h=this.tableNode.tBodies[f],l=h&&h.rows[e],n=l&&l.cells[k];if(n){j.push(n);}}return j;},getPageHeight:function T(e){var f=this.tableNode.tBodies;return(f&&f[e]&&f[e].offsetHeight)||0;},getTargetCell:function(n,m){var k=0,f=0,l;for(l=this.totalPages;f<l;f++){k+=this.getPageHeight(f);if(m<=k){break;}}var g=this.tableNode.tBodies[f];if(g){for(f=0,l=g.rows.length;f<l;f++){var q=g.rows[f];for(var e=0,p=q.cells.length;e<p;e++){var o=q.cells[e];if(o.offsetTop+o.offsetHeight>=m){if(n>=o.offsetLeft&&n<=o.offsetLeft+o.offsetWidth){return o;}}else{break;}}}}},postRenderPagesCleanup:function K(){var g=this.parent;if(g&&g.gridData&&g.gridData.afc){var f=this.tableNode;if(f&&(this.lastWidth!==f.offsetWidth)){if(g.onGridWidthChanged){g.onGridWidthChanged();}mstrmojo.array.forEach(this.pageStatus,function(h){delete h.height;});this.lastWidth=f.offsetWidth;}var e=C(g,"adjustAutoWidth");if(e){e.adjustAutoWidth(g);}}if(g.gridPagesRendered){g.gridPagesRendered();}if(mstrmojo.dom.isIE&&!mstrmojo.dom.isIE8){B(this.domNode);}if(g&&g.maskNode){X.removeClass(g.maskNode,"wait");}this.hightLightChangedCells();},hightLightChangedCells:function M(){var n=this.cp.getUpdatedRows(),j=this,m,e,l,o,g,h,k,f=[];if(n){mstrmojo.hash.forEach(n,function(q,p){k=parseInt(p,10);m=j.cp.getRowCells(k);e=F(k,j);l=e.length;o=m.length-1;if(o>=0){for(g=l-1;g>=0;g--){h=e[g];if(o<0){break;}if(m[g]._d){var s=h.style.backgroundColor,r=h.style.color;f.push({dom:h,bgcolor:s,ftcolor:r});h.style.backgroundColor=O.getHighlightColor(O.rgbStr2rgb(c.getStyleValue(h,"backgroundColor"),true));h.style.color=O.getContrastingColor(O.rgbStr2hex(c.getStyleValue(h,"backgroundColor")),"#ffffff","#000000");delete m[g]._d;}o--;}}});if(f.length>0){window.setTimeout(function(){mstrmojo.array.forEach(f,function(p){p.dom.style.backgroundColor=p.bgcolor;p.dom.style.color=p.ftcolor;});},300);}}},postRenderingCleanup:function A(){var e=this.parent;if(e&&this.connectedScrollbox){e.disconnectScrollbox(this);}this.connectedScrollbox=false;if(e&&!e.scrollboxHeightFixed){var f=C(e,"performCanGrowCanShrink");if(f){f.performCanGrowCanShrink([e],true);}}},getRowInfoByPosition:function(e){return this.cp.getRowCellInfo(e);},unrender:function W(e){J.call(this);if(this.connectedScrollbox){this.parent.disconnectScrollbox(this);this.connectedScrollbox=false;}this.numPagesRendered=0;this.lastWidth=0;this.isDownloading=false;this.unMarkAllPages();this._super(e);},dataDownloaded:function V(){this.isDownloading=false;this.initPageStatus();this.onscroll();}});})();(function(){mstrmojo.requiresCls("mstrmojo.GridBase","mstrmojo.Grid","mstrmojo.mstr.EnumDSSXMLObjectTypes");mstrmojo.XtabZone=mstrmojo.declare(mstrmojo.Grid,null,{scriptClass:"mstrmojo.XtabZone",markupString:'<div id="{@id}" class="mstrmojo-XtabZone" style="position:relative;{@cssText}"></div>',markupSlots:{gridContainerNode:function(){return this.domNode;}}});}());(function(){var G=1,B=2;mstrmojo.XtabCP=mstrmojo.declare(null,null,{scriptClass:"mstrmojo.XtabCP",base:null,lookupBase:null,colWidths:null,forceAutoRowHeight:false,startIndexInContainer:0,updatedRows:null,preServeUpdatedRows:true,init:function M(N){mstrmojo.hash.copy(N,this);},initContent:function E(Q){this.startIndexInContainer=Q||this.startIndexInContainer||0;var P=this.base||[],O=P.show,N=P.items;this.rc=O&&N?N.length:0;this.colWidths=(O&&P.cws)||[];this.isDownloading=false;this.isDownloaded=true;this.invalidData=false;},isDataAvailable:function C(O,N){return !this.invalidData;},download:function A(P,O,N){if(!this.isDownloaded&&!this.isDownloading&&this.dataSource){this.isDownloading=true;this.dataSource.download(0,N);}},invalid:function F(){this.invalidData=true;this.isDownloading=false;this.isDownloaded=false;this.preServeUpdatedRows=true;if(this.gridData){this.oldGridData=this.gridData;this.oldBase=this.base;this.updatedRows={};}},getRowHeight:function D(){return this.gridData.rh;},getNumAutoHeightRows:function(){return this.forceAutoRowHeight?this.rc:0;},getAvailableRowsCount:function L(){return this.rc;},getUpdatedRows:function J(){return this.updatedRows;},getRowCells:function(j,O){var Z=this.base||[],V=Z.items||[],k=V[j]||[],X=k.items,m=this.lookupBase,c=this.interactiveCellsArray,l=this.gridData.css,q=this.gridData.gsi,d=q&&q.prop&&q.prop.cols&&q.prop.cols.mg,o=null,Y,g,U,n,t,T,h,S,W,R,f="-1";if(this.oldGridData){Y=this.oldBase;g=Y&&Y.items;U=g[j]&&g[j].items;}for(t=0,n=(X&&X.length)||0;t<n;t++){T=X[t];if(T){T.v=T.v||T.n;if(m&&!T._e){h=m[T.tui];S=T.fi;W=(h&&h.fs)||[];R=W[S]||W[0];T.ts=T.ts||R&&R.bftp;o=h&&h.es[T.idx];if(o){T.v=T.v||o.n;if(o.rv){T.rv=o.rv;}T._e=o;}}if(!T.css){var w=T.cni;if(w!==undefined){T.css=l[w].n;}else{T.css="";}}if(!T._d&&U&&this.preServeUpdatedRows){var Q=U[t];if(!Q||(Q.rs!==T.rs)){this.preServeUpdatedRows=false;this.updatedRows={};}else{if((Q.v&&T.v!==Q.v)){var v={};if(T.v!==Q.v){v.v=Q.v;}if(T.css!==Q.css){v.css=Q.css;}T._d=v;this.updatedRows[this.startIndexInContainer+j]=true;}}}T._gd=this.gridData._bidx||0;if(c){if(!O&&(T._ei===undefined||c[T._ei]!==T)){T._ei=c.push(T)-1;}}if(this.axis){T.axis=this.axis;}var p=T.pi,b=function b(y,r,e){var x=y&&y[r];return x&&x.es[e];},a=function a(z,x,AA,r,y){var e=z.items[x].items[AA];if(e){e.axis=e.axis||r;if(e._e===undefined){e._e=b(z.show?m:y,e.tui,e.idx);}}return e;};if(p){if(p.ri!==undefined&&p.ci!==undefined){if(T.axis===2&&d!==f){T._p=V[p.ri].items[t];}else{T._p=V[p.ri].items[p.ci];}}else{var u=this.gridData.ghs,N=this.gridData.gts,s=p.left,P=p.top;if(s){T._lp=a(u.rhs,s.ri,s.ci,G,N.row);}if(P){T._tp=a(u.chs,P.ri,P.ci,B,N.col);}}}}}return X;},getUnmergedCells:function H(S){var U=[],V=(this.base&&this.base.items)||[];if(S>V.length-1||S<0){return U;}var P=this.gridData.css,T=V[S].items[0],O=T&&T.pi,N=O&&O.ri,R=O&&O.ci;while(O&&N>-1&&R>-1){T=T._p||V[N].items[R];var Q={};mstrmojo.hash.copy(T,Q);if(!Q.css){Q.css=P[Q.cni].n;}Q.rs=T.rs-S+N;U.splice(0,0,Q);O=T&&T.pi;N=O&&O.ri;R=O&&O.ci;}return U;},getIndentPadding:function K(N){return N*14;},getCell:function I(N,O){var P=this.base.items;return P[N].items[O];}});}());(function(){mstrmojo.XtabVACP=mstrmojo.declare(mstrmojo.XtabCP,null,{scriptClass:"mstrmojo.XtabVACP",cps:[],initContent:function G(L){this.startIndexInContainer=L||0;this.rc=0;this.type=0;this.colWidths=[];var J;for(J=0;J<this.cps.length;++J){var K=this.cps[J];K.initContent(this.startIndexInContainer+this.rc);this.rc+=K.rc;this.type|=K.type;var I=K.colWidths;if(I&&(I.length>this.colWidths.length)){this.colWidths=I;}}},getNumAutoHeightRows:function(){return this.cps[0].getNumAutoHeightRows();},getRowHeight:function C(){return this.cps[0].getRowHeight();},getRowCells:function(J,I){var K=0,L=this.cps[K],M;while(J>=L.rc){J-=L.rc;L=this.cps[++K];}if(this.renderingNewPage){L.updateCounter=0;this.renderingNewPage=false;}M=L.getRowCells(J,I);this.updateCounter=L.updateCounter;return M;},getUnmergedCells:function(I){var J=0,K=this.cps[J];while(I>=K.rc){I-=K.rc;K=this.cps[++J];}return K.getUnmergedCells(I);},getCell:function(I,K){var J=0,L=this.cps[J];while(I>=L.rc){I-=L.rc;L=this.cps[++J];}return L.getCell(I,K);},isDataAvailable:function D(L,K){var J=this._getCPs(L,K),I;for(I=0;I<J.length;++I){if(!J[I].isDataAvailable(L,K)){return false;}}return true;},getAvailableRowsCount:function F(){var K=0,I;for(I=0;I<this.cps.length;++I){var J=this.cps[I];if(J.isDataAvailable()){K+=J.getAvailableRowsCount();}}return K;},_getCPs:function H(N,L){var J=0,M=this.cps[J],I=M&&M.startIndexInContainer,K=[];if(M){N-=I;L-=I;}while(M&&N>=M.rc){N-=M.rc;L-=M.rc;M=this.cps[++J];}while(M&&L>=M.rc){L-=M.rc;K.push(M);M=this.cps[++J];}if(M){K.push(M);}return K;},invalid:function E(){var I;for(I=0;I<this.cps.length;++I){var J=this.cps[I];J.invalid();}this.updatedRows={};},getUpdatedRows:function A(){var I={},J;for(J=0;J<this.cps.length;++J){var K=this.cps[J];if(!K.preServeUpdatedRows){return{};}mstrmojo.hash.copy(K.getUpdatedRows(),I);}this.updatedRows=I;return I;},download:function B(N,M,I){var L=this._getCPs(N,M),J;for(J=0;J<L.length;++J){var K=L[J];K.download(N,M,I);}}});}());(function(){mstrmojo.XtabHACP=mstrmojo.declare(mstrmojo.XtabCP,null,{scriptClass:"mstrmojo.XtabHACP",cps:[],initContent:function G(J){this.startIndexInContainer=J||0;this.type=0;this.colWidths=[];var I;for(I=0;I<this.cps.length;++I){this.cps[I].initContent(this.startIndexInContainer);this.type|=this.cps[I].type;var H=this.cps[I].colWidths;if(H){this.colWidths=this.colWidths.concat(H);}}this.rc=Math.max(this.cps[0].rc,this.cps[1].rc);},getNumAutoHeightRows:function(){return Math.max(this.cps[0].getNumAutoHeightRows(),this.cps[1].getNumAutoHeightRows());},getRowHeight:function C(){return this.cps[0].getRowHeight();},getRowCells:function(J,I){var N=this.cps,K=[],H=N.length,M;for(M=0;M<H;M++){if(N[M].getAvailableRowsCount()>0&&N[M].rc>J){var L=N[M].getRowCells(J,I);if(L){K=K.concat(L);}}}return K;},getUnmergedCells:function(H){return this.cps[0].getUnmergedCells(H);},isDataAvailable:function D(I,H){return this.cps[1].isDataAvailable(I,H);},getAvailableRowsCount:function F(){return Math.max(this.cps[0].getAvailableRowsCount(),this.cps[1].getAvailableRowsCount());},invalid:function E(){var I,H,J;for(I=0,H=this.cps.length;I<H;++I){J=this.cps[I];J.invalid();}this.updatedRows={};},getUpdatedRows:function A(){var H={},I;for(I=0;I<this.cps.length;++I){var J=this.cps[I];if(!J.preServeUpdatedRows){return{};}mstrmojo.hash.copy(J.getUpdatedRows(),H);}this.updatedRows=H;return H;},download:function B(K,I,H){var J=this.cps[1];J.download(K,I,H);}});}());(function(){var C=4;mstrmojo.XtabLevelHACP=mstrmojo.declare(mstrmojo.XtabHACP,null,{scriptClass:"mstrmojo.XtabLevelHACP",allCells:[],updateCounter:0,pageNum:0,getEmptyCell:function B(D,E,G){var F={css:D.css.replace(" hl",""),v:"",fillerCell:true};if(E){F.cs=this.headerCells[G].cs||1;}return F;},getCellDepth:function A(D){var E=D.dpt||1;if(!D.dpt){D=D._p;while(D){if(D.dpt){E+=D.dpt;break;}E++;D=D._p;}}return E;},getUnmergedCells:function(D){return ;},getRowCells:function(S){var N=this.cps,I=[],a=N.length,K=false,c=this.gridData,O=(c&&c.lvlepd)||-1,Q=this.outlineState,H=this.allCells,Z,Y,X,F,E,d,W=0,J=-10;d=this.updateCounter;S-=d;if(H.length>0){return H.splice(0,1)[0];}var U=function(k){var j=k.gridData||(k.cps[0]&&k.cps[0].gridData),l=(j&&j.gts.row),f=(l&&l.length)||0,e,g,h;this.headerCells=e=mstrmojo.hash.clone(l);for(h=0;h<e.length;h++){if(e[h].cs>1&&e[h].otp===mstrmojo.mstr.EnumDSSXMLObjectTypes.Filter){for(Y=1;Y<e[h].cs;Y++){g=this.getEmptyCell(e[h],false);e.splice(h+1,0,g);}e[h].cs=1;}}for(h=f-1;h>0;h--){if(e[h].id===e[h-1].id){e.splice(h,1);}}f=e.length;this.maxLevel=j.maxLevel=f;this.gridData=j;for(h=0;h<f;h++){if(e[h].cs>1){return true;}}return false;};var G=function(j){var e,h,f,g;for(g=j.length-1;g>0;g--){h=j[g-1];e=j[g];if(e.dpt&&e.dpt===h.dpt){if(e.v&&e.v!==""){if(e.ts===C){if(e.v.indexOf("#srcstart")===0){f=e.v;}else{f="#srcstart"+e.v+"#srcend";}if(h.ts!==C){f=h.v+" "+f;}else{f="#srcstart"+h.v+"#srcend "+f;}h.v=f;}else{if(h.ts===C){h.v="#srcstart"+h.v+"#srcend "+e.v;}else{h.v+=" "+e.v;}}e.v="";}j.splice(g,1);}}return j;};var b=function(g){var f=this.headerCells,j=f.length,e=f[g].cs?(f[g].cs-1):0;var h=0;for(h=g+1;h<f.length;h++){e+=f[h].cs?(f[h].cs-1):0;}return e;};var D=function(h){var g=h.gridData||(h.cps[0]&&h.cps[0].gridData),e=g.gts,f=false;if(e.col.length===0){f=true;}else{f=e.rec;}return f?0:1;};for(Z=0;Z<a;Z++){if(N[Z].getAvailableRowsCount()>0&&N[Z].rc>S){var L=mstrmojo.hash.clone(N[Z].getRowCells(S).slice(0));if(N[Z].type===4){if(S===0){this.hasMultiFormAttributes=U.call(this,N[Z]);this.metricAdjuster=D(N[Z]);if(O===-1){O=this.gridData&&this.gridData.lvlepd;}}if(this.hasMultiFormAttributes){L=G(L);}var P=L.length;for(X=P-1;X>=0;X--){F=L[X];var V=this.getCellDepth(F);if(X===0){for(Y=1;Y<V;Y++){L.splice(Y-1,0,this.getEmptyCell(F,this.hasMultiFormAttributes,Y-1));}}else{if(F.stt&&F.idx<0){L.splice(X,1);}else{if(F.stt===1&&(!F._e||F._e.n)){L.splice(X,1);E=L[X-1];if(F._e&&F.hst&&F.hst!==J&&E&&E.v===E._e.n){E.v+=" ("+F._e.n+")";}continue;}else{var R=[];L.splice(X,1);for(Y=1;Y<V;Y++){R.push(this.getEmptyCell(F,this.hasMultiFormAttributes,Y-1));}R.push(F);H.splice(0,0,R);K=true;d++;this.rc++;}}}F.rs=1;F.outLvl=V;if(Q&&Q.collapseToLevel){if(V<=Q.collapseToLevel){if(V<Q.collapseToLevel||!Q.isExpanding){delete Q.collapseToLevel;H.forEach(function(e){e.forEach(function(f){if(!f.fillerCell&&f._ei){delete Q[f._ei];f.epd=false;f.hidden=false;}});});}else{if(Q.isExpanding){Q.hasTBodyElementsToExpand=true;}Q[F._ei]={expanded:false,hidden:true};}}else{Q[F._ei]={expanded:false,hidden:true};}}if(Q&&Q[F._ei]!==undefined){F.epd=!(Q[F._ei].expanded);F.hidden=Q[F._ei].hidden;}else{F.epd=O>0&&O<=V;F.hidden=false;}if(this.hasMultiFormAttributes){W=b.call(this,V-1);}if((W||this.metricAdjuster)&&V===this.maxLevel){F.isLeaf=true;}F.cs=P>1?(P-X+W+this.metricAdjuster):(P+W+this.metricAdjuster);}this.updateCounter=d;}else{if(K){var T=H.length-1,M=H[T];H[T]=M.concat(L);for(Y=0;Y<T;Y++){M=H[Y];for(X=0;X<L.length;X++){M.push(this.getEmptyCell(L[X]));}}for(X=0;X<L.length;X++){I.push(this.getEmptyCell(L[X]));}continue;}}if(L){I=I.concat(L);}}}return I;}});}());(function(){function F(N){var M=0;for(M=0;M<N.length;M++){if(N[M].otp===-1){return true;}}return false;}function G(M){var N=[],Q,P,O;for(O=M.length-1;O>0;O--){Q=M[O];P=M[O-1];if(Q.id===P.id){M.splice(O,1);if(P.v===P.n){P.v+=" | "+Q.v;P.cs=(P.cs||1)+(Q.cs||1);}}}return M;}function C(M){return M.gts.col.length>0&&M.gts.rec===false;}mstrmojo.XtabTitlesCP=mstrmojo.declare(mstrmojo.XtabCP,null,{scriptClass:"mstrmojo.XtabTitlesCP",init:function L(M){this._super(M);},download:function A(O,N,M){},shouldClonedLastTitleCell:function K(){return(this.gridData.lhv!==0);},initContent:function H(U){this.startIndexInContainer=0;if(!this.cts){this.cts=mstrmojo.hash.clone(this.gridData.gts.col);}var N=this.gridData.gts,P=N.row||[],M=N.col||[],W=N.show,T=N.rec,c=this.cts||[],b=P.length,V=c.length,Z=this.gridData.css;this.base={items:[]};this.rc=(W&&c.length)||0;if(this.rc===0&&W){this.rc=b>0?1:0;}this.colWidths=(W&&N.cws)||[];if(!this.rc){this.nRowSpan=this.nColSpan=0;return ;}var R={items:[]},X=0,O=1,Y,a,e=this,Q=e.base.items,d=function(f,g){if(e.shouldClonedLastTitleCell()&&g>1){f.rs=1;Y=mstrmojo.hash.clone(f,{});Y.n="&nbsp;";f.cni=Z.push({n:(Z[f.cni].n||"")+" fsbp_1"})-1;}},S=function(h){var f=h;while(f-->1){if(e.shouldClonedLastTitleCell()){var g=mstrmojo.hash.clone(Y,{});g.cni=Z.push({n:(Z[g.cni].n||"")+" fsbp_"+((f==1)?"3":"2")})-1;Q.push({items:[g]});}else{Q.push({items:[]});}}};for(a=0;a<b;++a){P[a].axis=1;P[a].ui=a;X+=P[a].cs||1;R.items.push(P[a]);}if(V>0){c[0].axis=2;c[0].ui=0;M[0].axis=2;M[0].ui=0;O=c[0].rs||1;d(c[0],O);X+=c[0].cs||1;R.items.push(c[0]);}Q.push(R);for(a=1;a<V;++a){if(O>1){S(O);}c[a].axis=2;c[a].ui=a;M[a].axis=2;M[a].ui=a;O=c[a].rs||1;d(c[a],O);Q.push({items:[c[a]]});}this.rc=Q.length;this.nRowSpan=this.rc+O-1;this.nColSpan=X;if(T){this._removeExtraColumn(P,c);}},getAvailableRowsCount:function I(){return this.rc;},getSpanDimension:function J(){return{nRow:this.nRowSpan||0,nCol:this.nColSpan||0};},isDataAvailable:function B(N,M){return true;},getRowCells:function E(N){var Q=this._super(N),T=this.gridData;if(T.olm&&!(T.rw&&T.rw.row.bc>0)&&!(this.dataSource&&this.dataSource.defn.txi)){Q=G(Q);var S=0,P=0,O;Q=mstrmojo.hash.clone(Q);for(S=0;S<Q.length;S++){if(Q[S].cs>1&&Q[S].otp===mstrmojo.mstr.EnumDSSXMLObjectTypes.Filter){for(P=1;P<Q[S].cs;P++){O={};O.css=Q[S].css.replace(" hl","");O.v="&nbsp;";Q.splice(S+1,0,O);}Q[S].cs=1;}}var R=C(T),M=R?Q.length-1:Q.length,S;for(S=0;S<M-1;S++){Q[S].expandLevel=S+1;}}return Q;},_removeExtraColumn:function D(P,f){var d=P&&P.length,U=f&&f.length,M=this.gridData.gts,X=M.row||[],S=M.col||[],N=X.length,b=S.length;if(!d||!U){if(U===1){var g=f[U-1];if(g.otp==-1){if(b>0){S[b-1]._hid=true;}this.base.items=[];this.nRowSpan=this.nColSpan=this.rc=0;}}return ;}var O=P[d-1],Y=this.rc,Q=this.base.items;if(O){if(O.otp==-1){if(N>0){X[N-1]._hid=true;}if(this.nColSpan){this.nColSpan-=O.cs||1;}Q[0].items.splice(d-1,1);}else{var V=Y>1?Y-1:0,W=Q[V],e=W.items.length;if(e>0&&b>0){S[b-1]._hid=true;}var R=O.fix;if(R){var c;for(c=0;c<R;c++){W.items[e-1+c]=P[d-R+c];}}else{W.items[e-1]=O;}for(var a=0,Z=U-1;a<Z;a++){f[a].cs=R?R:O.cs;}var T=R?R:1;Q[0].items.splice(d-T,T);if(this.nColSpan){this.nColSpan-=1;}}}return ;}});})();(function(){mstrmojo.XtabOnDemandCP=mstrmojo.declare(mstrmojo.XtabCP,null,{scriptClass:"mstrmojo.XtabOnDemandCP",blockNum:0,listeners:null,initContent:function E(F){if(F!==undefined){this.startIndexInContainer=F;}this.isDownloaded=(this.base!==null);this.isDownloading=false;if(this.base){this._super(this.startIndexInContainer);this.notifyListeners();}},addCPListener:function D(F){if(!this.listeners){this.listeners=[];}this.listeners.push(F);},notifyListeners:function C(){var F,H=this.listeners,G=(H&&H.length)||0;for(F=0;F<G;F++){if(H[F]&&H[F].onDemandDataReady){H[F].onDemandDataReady(this);}}},getAvailableRowsCount:function B(){return this.isDownloaded?this.rc:0;},download:function(F){if(!this.isDownloaded&&!this.isDownloading){this.isDownloading=true;this.dataSource.download(this.blockNum,F);}},invalid:function(){if(this._super){this._super();}this.isDownloaded=false;this.isDownloading=false;},isDataAvailable:function A(G,F){return this.isDownloaded;}});})();(function(){var a=1,e=2,n=4,W=8,g=1,h=2,G=3,c=4,m=5,U=6,M=7,k=8,X=4,F={},B={},I=4,R=1,J={TITLE:"ig-title",GROUPING:"iggroup",BANDING:"igbanding",RIGHT_ALIGN:"rtAlign",LEFT_ALIGN:"leftAlign",TOTAL_ROW:"total"},T=mstrmojo.hash,V=mstrmojo.array;function Z(s,q){var r=s[0],o=q.gts,p=o.cws.length;return(q.vp.gr==="1"&&(p>1));}function j(p,u){var s=function(v,w){if(w&&v&&v.css&&v.css.indexOf(w)<0){v.css+=" "+w;}};var r=u.type,q=u.col,t=(q&&q.cl)||0,o=(r===e||r===a);if(r===e||r===W){s(p,J.RIGHT_ALIGN);}else{if(r===a||r===n){s(p,J.LEFT_ALIGN);}}if(o){if(q&&q.tg&&t>1){if(!p._v){p._v=p.v;p.v="<span class='toggleHeader'>"+p.v+"</span>";}}s(p,J.TITLE);}V.forEach(u.extraCss,function(v){s(p,v);});}function A(o){return 0;}function l(s){var q,r=s.cg,o=r&&r.cgc,p=1;for(q=0;q<o;q++){if(r&&r[q]&&!r[q].tg&&r[q].cl>p){p=r[q].cl;}}return p;}function N(p,o){var q=m;if(o===2){if(p===0){q=g;}else{if(p===1){q=c;}}}else{if(o>2){if(p===0){q=g;}else{if(p===1){q=h;}else{if(p===o-1){q=c;}else{if(p<o-1&&p>1){q=G;}}}}}}return q;}function L(o,s,q,p){var u=p&&p.cols&&p.cols.cg,r,v=0,t=0;if(u){for(r=0;r<s;r++){if(o[r]){v+=o[r].length;}}v+=(q+1);for(r=0;r<u.cgc;r++){t+=u[r].cl;if(t>=v){return r;}}}return -1;}function P(v,r,p,o){var u=[],t,q,s,w;for(q=0,s=v.length;q<s;q++){if(v[q].length===1){t=v[q][0];t.rowType=(t.rowType!==k)?N(r,p):k;t.singleStack=(p>1);t=T.copy(t);if(t.ts===I){if(p===1){t.rowType=m;t.colIdx=L(v,q,r,o);}else{if(!r){t.colIdx=L(v,q,r,o);}else{delete t.ts;t.v="";}}}else{if(r){t.v="";}}}else{t=v[q][r];if(!t){w=v[q].length;t=T.copy(v[q][w-1],{});t.v="";if(t.hasOwnProperty("ts")){delete t.ts;}}else{if(t.ts===I){t.colIdx=L(v,q,r,o);}}t.rowType=(t.rowType!==k)?N(r,p):k;}u.push(t);}return u;}function Q(o){if(o===0){return 0;}var p=this.sectionMap[o-1]||0;return Math.floor((o-p)/this.stackLevels);}function D(v){var t,u,r=this.sectionInfo,o=r.length,q=this.srh,p=this.lastSectionIndex;u=r[p];if(v>=u.rs&&v<(u.rs+q)){return u;}if(v<u.rs){t=p-1;if(t<=0){this.lastSectionIndex=0;return null;}do{u=r[t];if(v>u.rs&&v<=(u.rs+q)){this.lastSectionIndex=t;return u;}}while(v<u.rs&&--t>0);this.lastSectionIndex=t;return u;}else{t=p+1;if(t>=o){this.lastSectionIndex=o-1;return null;}do{u=r[t];if(v>u.rs&&v<=(u.rs+q)){this.lastSectionIndex=t;return u;}}while(v>(u.rs+q)&&++t<o);this.lastSectionIndex=t-1;return null;}}function d(w,q,o,v){var u=w[0],s,t=w.length,p=u&&u.rowType,r={v:"",css:"empty-igcell",rowType:p};if(o!==undefined&&u&&(p===g||p===m||p===U)){r={v:'<div><div class="IG-ActionArrow-IMG" style="height:'+v+"px;top:-"+(0.5*F[p])+'px;"></div></div>',css:"IG-ActionArrow",_ei:o};}for(s=t-1;s>=t-q;s--){u=w&&w[s];if(u){u.css+=" IG-lastdatacolumn";}}w.push(r);}function S(AJ,AE,q){var AA=AJ.cols,AB=AA.cg,o=[{w:"0px"}];if(AA&&AE){var AK=AA.cws,p=[],AI=AK.length,AM=0,v=(parseInt(AJ.ar,10)===1)?(AE/AI):-1,z,r,y=false,s=0,AC=AE,AD=0,AH;for(AH=0;AH<AI;AH++){r=p[AH]=AK[AH];z=r.w;if(z===""){y=true;}else{if(r.xc){AM+=parseInt(z);AC-=AM;s++;}else{AD+=parseFloat(z,10);}}}if(y||AD<100){v=AC/(AI-s);}for(AH=0;AH<AI;AH++){r=AK[AH];if(r.xc){continue;}else{if(v===-1){z=parseInt(r.w,10)*AC/100;if(!z&&z!==0){z=parseInt(AC/AB.cgc,10);}}else{z=(parseInt(r.w,10)<0)?0:v;}}p[AH]={w:z+"px"};}if(q){return p;}var x=[],AG=0;for(AH=0;AH<AI;AH++){var AL=AB[AH],u=AL.tg?AL.cl:1,AF=0;for(AF=0;AF<u;AF++){var t="0px";if(AF===AL.cc){t=p[AH].w;}x[AG+AF]={w:t};}AG+=u;}return x.concat(o);}else{if(q){return null;}else{return cp.cws.concat(o);}}}function C(){delete this.lastStackCols;delete this.lastAttRow;delete this.lastMtxRow;}mstrmojo.InteractiveGridHACP=mstrmojo.declare(mstrmojo.XtabHACP,null,{scriptClass:"mstrmojo.InteractiveGridHACP",sectionMap:[],stackLevels:1,gridWidth:480,tdWidths:null,lastSectionIndex:0,adjustCPMaps:function O(){var x=this.cps,w=this.cps[0],AC=Math.max(x[0].rc,x[1].rc);if(w.type!==a){var AH=this.gridData,AB=function(AK,AN){var AJ=AK.base.items,AL=AK.lookupBase[0].es,AM=AJ[AN].items[0],AI=AL&&AL[AM.idx];return(AI&&AI.n)||((AM.pi&&AL[AM.pi.ri||0])||"");},AF,AE,o=1,u,p,z,r=0,q=-1,AA,AG,AD=0,y=this.groupEnabled;for(AA=0,AF=0,AG=w.cps?w.cps.length:1;AA<AG;AA++){var t=w.cps?w.cps[AA]:w,v=t.rc;r=q+1;q=r+v-1;if(t.isDataAvailable(r,q)){if(t.lastRow){AD=t.lastRow;p=t.lastSection;}else{AF=AD||0;for(AE=0,o=this.sectionMap[AF-1]||0;AE<v;AE++){var s=this.stackLevels;z=AB(t,AE);if(y&&z!==p){p=z;this.sectionInfo.push({sn:z,rs:this.srh*o+this.stackedRh*Math.floor((AF-o)/this.stackLevels)});this.sectionMap[AF]=++o;AF++;}while(s){this.sectionMap[AF]=o;s--;AF++;}}AD=t.lastRow=AF;t.lastSection=z;}}else{break;}}this.rc=(this.stackLevels>1?AC*this.stackLevels:AC)+(y?o:0);}},onDemandDataReady:function b(){this.adjustCPMaps();},initContent:function Y(x){var w=this.cps,AI=this.gridData=w[0].gridData||w[0].cps[0].gridData,AE=AI.vp=this.gridVp=this.gridVp||AI.vp,q=AE.daf&&AE.daf.split(":"),y=AE.cols,z=y.cg,AF=y.cws,v=w[A(z)],AC=AI.gts.row,p=AI.gts,AG=Z(w,AI),u=v.type!==a,AB,AD,s,o,AA,t,AH,r=(typeof (mstrMobileApp)!=="undefined"&&mstrMobileApp.getDeviceDPI)?mstrMobileApp.getDeviceDPI():160;if(r===160){F={1:33,2:22,3:20,4:30,5:53,6:40,7:27,8:53};B={1:11,2:11,3:1,4:16,5:16};}else{if(r===213){F={1:45,2:31,3:26,4:39,5:71,6:40,7:35,8:71};B={1:15,2:15,3:2,4:21,5:21};}else{if(r===240){F={1:50,2:34,3:30,4:44,5:80,6:40,7:40,8:80};B={1:16,2:16,3:2,4:24,5:24};}else{if(r===320){F={1:67,2:44,3:38,4:58,5:107,6:40,7:53,8:107};B={1:22,2:22,3:2,4:32,5:32};}else{F={1:33,2:22,3:20,4:30,5:53,6:40,7:27,8:53};B={1:11,2:11,3:1,4:16,5:16};}}}}if(u){if(AE.dafIdx===undefined&&q){for(AB=0;AB<AC.length;AB++){if(AC[AB].id===q[0]&&AC[AB].fid===q[1]){AE.dafIdx=AB;break;}}}}for(AB=0;AB<z.cgc;AB++){if(z[AB]&&z[AB].tg){break;}}if(AB===z.cgc){AI.gts.show=false;AI.ghs.chs.show=false;}this._super(x);this.colWidths=S(AE,this.gridWidth);this.tdWidths=S(AE,this.gridWidth,true);if(u){this.stackLevels=l(y);if(this.stackLevels>1){this.srh=F[M];this.rh=F[m];this.mrh=F[G];this.stackedRh=F[g]+(this.stackLevels-2)*F[h]+F[G];}else{this.srh=F[M];this.rh=this.stackedRh=this.mrh=F[m];}if(AG||this.stackLevels>1){this.sectionMap=[];this.sectionInfo=[];this.groupEnabled=AG;this.adjustCPMaps();o=this.cps[0].cps;if(o){AH=this;for(AB=0,AD=o.length;AB<AD;AB++){t=o[AB];if(t&&t.addCPListener){t.addCPListener(AH);}}}}}},getUnmergedCells:function(o){return ;},getResolvedGroupHeader:function(q,t){var p=this.gridData,s=p.gts.row[t].es,o=p.ghs.rhs.items[q].items[t];if(o){if(!o.css){o.css=p.css[o.cni].n+" iggroup";o.n=s[o.idx].n;}}else{return{css:" iggroup",n:""};}return o;},getRowCells:function(AG){var AB=this.cps,u=[],AU=this.gridData,AQ=AU.vp,AE=AQ.cols.cg,z=AB[A(AE)],AD=this.groupEnabled,q=AQ.bn==="1",AR=[],AF=Q.call(this,AG),v,r,AH=1,AA,o,x,AN,AM,AP,AT,y;if(AD&&(this.sectionMap[AG]!==this.sectionMap[AG-1])){var s=T.copy(z.getRowCells(AF)[0],{});s.cs=this.colWidths.length;s.rowType=M;j(s,{col:null,type:z.type,extraCss:[J.GROUPING]});return[s];}if(!AG){C.call(this);}this.lastAttRow=this.lastAttRow||(AB[0].rc?AB[0].getRowCells(AF):[]);this.lastMtxRow=this.lastMtxRow||(AB[1].rc?AB[1].getRowCells(AF):[]);x=this.lastAttRow;AP=x.length;if(AP>0&&x[0].stt){AA=true;for(AN=0;AN<AP;AN++){AT=x[AN];if(AT.stt===R){o=AT;break;}}}if(!this.lastStackCols){V.forEach([this.lastAttRow,this.lastMtxRow],function(p){for(AN=0;AN<p.length;AN++){if(p[AN]._ei!==undefined){if(AQ.dafIdx>=0){y=z.getRowCells(AF)[AQ.dafIdx];}v=(AQ.dafIdx>=0)?(y&&y._ei):"";return false;}}},this);var AL=function(p,AV){if(p&&(AV.type===a||AV.type===e)){if(AJ.tg===false){p.n=p.v="";}p.rowType=k;}j(p,{col:AJ,type:AV.type,extraCss:[((AV.type===W||AV.type===n)&&q&&(AF%2===1))?J.BANDING:null,AA?J.TOTAL_ROW:null]});if(p){p.cs=1;if(p._ei===undefined&&AQ.dafIdx!==undefined){p._ei=v;}}};this.lastRowIndex=0;for(AM=0;AM<AE.cgc;AM++){var AJ=AE[AM],AO=AJ["mix"+AJ.cc],t=AO!==undefined,w=AB[t?1:0],AK,AI,AC,AS={n:"",stt:R,css:"xtab-td"};arr=[];if(AJ.tg){for(var AN=0;AN<AJ.cl;AN++){arr=[];AC=t?AJ["mix"+AN]:AJ.attForms[AN].idx;var x=t?this.lastMtxRow:this.lastAttRow;AT=x[AC];if(AA){if(!AT){AT=AS;}else{if(AT&&AT.stt===R){AT=T.copy(o,AS);}else{AT=T.copy(AT,{});}}}else{AT=T.copy(AT,{});}AL(AT,w);arr.push(AT);AR.push(arr);}if(AM+1===AE.cgc){AH=AJ.cl;}}else{for(AK=0,AP=AJ.cl;AK<AP;AK++){if(t){AI=AJ["mix"+AK];if(AI!==undefined){AT=this.lastMtxRow[AI];}}else{AI=AJ.attForms[AK];if(AI){AT=this.lastAttRow[AI.idx];}if(AA&&!AT){AT=AS;}}AL(AT,w);arr.push(AT);}AR.push(arr);}}this.lastStackCols=AR;}u=P(this.lastStackCols,this.lastRowIndex++,this.stackLevels,AQ);if(this.lastRowIndex>=this.stackLevels){C.call(this);}return u;},getRowHeight:function E(p){var o=F[m];return F[p]||o;},getPadding:function K(o){return B[o]||B[X];},isDataAvailable:function f(p,o){if(!this.onDemandIF||!this.cps[1].cps){return true;}else{var r=this.sectionMap.length,q;if(!r){return this.cps[1].isDataAvailable(p,o);}if(o>r){if(p<r){q=Q.call(this,p);return this.cps[1].isDataAvailable(q,q+(o-p));}else{return false;}}else{return this.cps[1].isDataAvailable(Q.call(this,p),Q.call(this,o));}}},download:function H(u,r,v){var q=Q.call(this,u),o=q+Math.ceil((r-u)/this.stackLevels),s=this.cps[0],p,w,t=!s.cps?[s]:this.cps[0]._getCPs(q,o);for(p=0;p<t.length;++p){w=t[p];w.download(q,o,v);}},getRowCellInfo:function(r){var q=D.call(this,r+this.srh),o,p=this.lastSectionIndex;if(q){o=this.sectionInfo[p-1];return{rowStart:q.rs,isNextRowNewSection:true,sectionName:o&&o.sn};}else{return{isNextRowNewSection:false,sectionName:this.sectionInfo[p].sn};}}});}());(function(){mstrmojo.requiresCls("mstrmojo.Container","mstrmojo._HasScrollbox","mstrmojo.XtabZone","mstrmojo._ShowsStatus","mstrmojo.boxmodel","mstrmojo._IsLockableXtab","mstrmojo._IsDocumentTemplate","mstrmojo.hash","mstrmojo.dom","mstrmojo.chart.model.enums.EnumDSSBaseFormType");var Q=1,X=2,Y=0,C=1,x=2,N=3;var M=1;var z=2;var I=4;var g=8;var d=mstrmojo.dom,p;function AD(AF){var AG=null;if(AF&&AF.length>1){AG=new mstrmojo.XtabVACP();AG.cps=AF;}return AG;}function J(AH){if(!AH||this._onDemandCP){return null;}var AQ=AH.bc,AO=AH.tc,AI=AH.tbc,AR=AH.rm===2,AG=AR?this.gridData.ghs.rhs.items.length:AQ,AJ=AO-AG,AK=AR?AI-AQ:AO-AG,AP=Math.ceil(AK/AQ),AM=[],AN=[],AL;if(AR){AQ=Math.floor(AJ/AP);}for(AL=0;AL<AP;++AL){if(AR&&AP===(AL+1)&&AJ>AQ){AQ=AJ;}var AF=Math.min(AJ,AQ);AM.push(this.createOnDemandCP(AL+1,AF,I));AN.push(this.createOnDemandCP(AL+1,AF,g));AJ-=AQ;}this._onDemandCP={rhs:AM,vls:AN};return this._onDemandCP;}mstrmojo.XtabTitlesCP.prototype.shouldClonedLastTitleCell=function(){return false;};mstrmojo.XtabBase=mstrmojo.declare(mstrmojo.Container,[mstrmojo._IsLockableXtab,mstrmojo._HasScrollbox,mstrmojo._ShowsStatus,mstrmojo._IsDocumentTemplate],{scriptClass:"mstrmojo.XtabBase",dataRenderMode:"vscroll",shouldClipLockableXtab:true,handleClicks:function H(){return true;},markupString:'<div id="{@id}" k="{@k}" class="mstrmojo-Xtab {@cssClass}" title="{@tooltip}" style="{@domNodeCssText}"><div style="display: none;{@msgNodeCssText}"><div class="text"><div class="warning-icon"></div><div>&nbsp;</div></div></div><div class="mstrmojo-Xtab-overlay"></div><div class="mstrmojo-Xtab-content {@cssDefault}" title="{@tooltip}" style="{@viewportCssText}" mstrAttach:click,selectstart,touchstart><table cellspacing="0" cellpadding="0"><tr><td style="vertical-align:top;padding:0;"><div style="position: relative;"><div class="mstrmojo-progress" style="display:none"><div class="mstrmojo-progress-barbg"><div class="mstrmojo-progress-bar"></div></div><div class="mstrmojo-progress-text"></div></div><div id="{@id}_scrollbox" style="position:relative;{@scrollboxNodeCssText};{@scrollboxNodeOverflow}"></div></div></td></tr></table></div></div>',markupSlots:{overlayNode:function(){return this.domNode;},msgNode:function(){return this.domNode.firstChild;},maskNode:function(){return this.domNode.childNodes[1];},viewport:function(){return this.domNode.lastChild;},contentNode:function(){return this.domNode.lastChild.firstChild;},scrollboxNode:function(){return this.domNode.lastChild.firstChild.rows[0].cells[0].firstChild.lastChild;},tableContainerNode:function(){return this.domNode.lastChild.firstChild.rows[0].cells[0].firstChild;},_STATUS:function(){return this.domNode.lastChild.firstChild.rows[0].cells[0].firstChild.firstChild;},_STATUS_TXT:function(){return this.domNode.lastChild.firstChild.rows[0].cells[0].firstChild.firstChild.lastChild;},_STATUS_BAR:function(){return this.domNode.lastChild.firstChild.rows[0].cells[0].firstChild.firstChild.firstChild;},_TB_CELL:function(){return this.domNode.lastChild.firstChild.rows[0].cells[0];}},markupMethods:{onvisibleChange:function(){this.domNode.style.display=(this.visible)?"block":"none";}},zone:null,lockHeadersCase:N,interactiveCellsArray:null,titlesCP:null,chsCP:null,rhsCP:null,valuesCP:null,onDemandIF:true,numRowFixed:false,heightLimit:0,height:0,widthLimit:0,width:0,useTouchScrolling:false,scrollInterval:0,selections:null,dataBlocks:null,getCellUnitIndex:function m(AF){return(AF.o!==undefined)?AF.o:AF._ei;},getCellTitleId:function e(AF){var AG="";if(AF.axis&&AF.ui!==undefined){AG=AF.axis+"A"+(AF.ui+1);}else{if(AF.mix!==undefined){AG="0A"+AF.mix;}}return AG;},update:function k(AG){this.set("gridData",AG.data[0]||AG.data);var AF=this.defn||AG.defn;this.sid=this.gridData.sid;this.treeType=(AF&&AF.tt)||1;this.interactiveCellsArray=[];if(this._super){return this._super(AG);}return true;},initCP:function F(AH,AG,AM,AJ,AL,AI,AK){var AF={gridData:AH,type:AM,interactiveCellsArray:AG,defn:this.defn};AF.base=AJ||AF.base;AF.lookupBase=AL||AF.lookupBase;AF.axis=AI||AF.axis;if(!AK){if(AM===M){AK=new mstrmojo.XtabTitlesCP(AF);}else{AK=new mstrmojo.XtabCP(AF);}}else{mstrmojo.hash.copy(AF,AK);}return AK;},preBuildRendering:function D(){var AH=this.gridData,AF=this.height,AG=this.width;this.lockHeadersCase=AH.lhv||Y;this.selections={};this.numRowFixed=!!(!AF&&AH.rw&&AH.rw.row&&(AH.rw.row.bc<AH.rw.row.tc));this.rw=AH.rw;this._onDemandCP=null;if(AG){this.widthLimit=parseInt(AG,10);}if(AF){this.heightLimit=parseInt(AF,10);}return this._super();},renderEmptyGrid:function q(){var AI=this.gridData,AG=this.msgNode,AH=AG.style,AF=this.viewport;AG.firstChild.childNodes[1].innerHTML=AI.eg;if(AI.eg!==""&&!this.excludeData){AH.display="block";AH.overflow="hidden";AG.className="mstrmojo-message";AF.style.display="none";}return true;},postBuildRendering:function U(){var AK=this.gridData,AH=!!this.viewport&&AK,AG=this.msgNode,AF=this.viewport,AJ;if(AK.eg===undefined){if(AG.style.display==="block"){AG.style.display="none";AF.style.display="block";}}else{return this.renderEmptyGrid();}if(!this.interactiveCellsArray){this.interactiveCellsArray=[];}if(AH){AK.ghs=AK.ghs||[];AK.gts=AK.gts||[];this._setupZone(AK);this._setupCP(AK);var AM=this.zone;if(AM.parent!==this){this.addChildren(AM);}if(this.scrollboxNode){var AI=this.heightLimit;this.scrollboxHeightFixed=!isNaN(AI)&&(AI>0);if(this.scrollboxHeightFixed){this.scrollboxHeight=AI;}this.scrollboxLeft=this.scrollboxTop=0;this.connectScrollbox(this);}}this.renderChildren();if(this.controller&&this.controller.getScrollPosition){var AL=this.controller.getScrollPosition(this.controller.model.oid+"."+this.gridData.k);if(AL){this.scrollTo(AL);}}AJ=this._super();if(this.numRowFixed){if(!this.height){this.heightLimit=this.zone.getPageHeight(0);this.height=this.heightLimit+"px";}else{this.heightLimit=parseInt(this.height,10);}}if((AH&&this.scrollboxNode&&AK.afc)||this.numRowFixed){this.resizeScrollBox();}this.onGridWidthChanged(AK.afc||AK.afw);this._onContainerGrowShrink(this.widthLimit,this.heightLimit);if(this.scrollboxNode&&this.scrollboxNode.childNodes&&this.scrollboxNode.childNodes[0]){this.scrollboxNode.style.zIndex=this.scrollboxNode.childNodes[0].style.zIndex;}if(this.lockHeadersCase&&this.initLock){this.initLock({top:this.scrollboxTop,left:this.scrollboxLeft});}if(this.configureActions){this.configureActions();}return AJ;},onclick:function n(AG){var AI=mstrmojo.dom,AK=AG.getTarget(),AJ=AK&&AI.findAncestorByName(AK,"td",true,this.viewport);if(AK.nodeName.toLowerCase()==="a"&&AJ.getAttribute("ei")){try{var AH=this.interactiveCellsArray[parseInt(AJ.getAttribute("ei"),10)];if(AH&&AH.ts===mstrmojo.chart.model.enums.EnumDSSBaseFormType.DssBaseFormHTMLTag){AK.href=mstrmojo.addCSRFTokenToURL(AK.href);}}catch(AL){}}if(AJ){var AF=AI.findAncestorByName(AK,"span",true,AJ);if(AF&&!AG.shiftKey&&!AG.ctrlKey){this.defaultAction(AJ);}else{this.doSelection(AG.e,AG.hWin,AJ);}}if(this.isSelectingText){this.isSelectingText=false;}},ontouchend:function h(AG,AF){this.onclick(mstrmojo._HasMarkup.newDomEvent("click",AF,AG));},onselectstart:function r(AG,AF){if(this.isHandleNode&&this.isHandleNode(AG.getTarget())){d.preventDefault(AF,AG);}return false;},onscroll:function s(){this._alignHeaders();if(this.controller&&this.controller.addScrollPosition){this.controller.addScrollPosition(this.controller.model.oid+"."+this.gridData.k,this.scrollboxLeft,this.scrollboxTop);}},resizeScrollBox:function K(){var AI=this.scrollboxNode,AH=AI&&AI.style,AG=this._TB_CELL;if(!AH||!AG){return ;}var AF=this.heightLimit;if(!AF){AH.height="auto";this.scrollboxHeightFixed=false;}else{if(AF>0){AH.height=AF+"px";this.scrollboxHeight=AF;this.scrollboxHeightFixed=true;}}this._resizeScrollBoxWidth();},_onContainerGrowShrink:function AE(AG,AJ){var AF=mstrmojo.findAncestor(this,"fixedSizeCanGrowShrink",null,mstrmojo.DocSection),AI=AG||null,AH=AJ||null;if(AI||AH){if(AF){AF.fixedSizeCanGrowShrink(this,AH,AI);}}else{if(AF){AF.performCanGrowCanShrink([this],true);}}},_resizeScrollBoxWidth:function V(){var AL=this.scrollboxNode,AJ=AL.scrollWidth+(AL.offsetWidth-AL.clientWidth),AH=AL&&AL.style,AG=this._TB_CELL;if(this.useTouchScrolling||!AH||!AG){return ;}var AI=this.widthLimit;if(!AI){var AK=AL.firstChild.style,AF=AK.position;AK.position="relative";AH.width="auto";AJ=AL.firstChild.firstChild.offsetWidth+(AL.offsetWidth-AL.clientWidth);AL.firstChild.style.position=AF;}if((AJ&&(AJ>0))&&(!AI||(AI&&(AJ<AI)))&&(AL.firstChild.firstChild.offsetWidth>=AL.clientWidth)){AH.width=AJ+"px";}},onGridWidthChanged:function c(AG){if(!AG){this._resizeScrollBoxWidth();}var AF=this.widthLimit;if(!AF){this.width=p;}this._onContainerGrowShrink(AF,null);},getGridDimension:function R(AI){var AG=1,AH=AI===AG?"Height":"Width",AJ=AH.toLowerCase(),AF=this[AJ+"Limit"];if(!AF&&(this[AJ]===p||this[AJ]===0)){AF=this.viewport["offset"+AH];this[AJ]=AF+"px";return AF;}return AF||parseInt(this[AJ],10);},_alignHeaders:function B(AF){var AH=this.scrollboxLeft,AG=this.scrollboxTop;if(this.lockHeadersCase&&this.alignLockNodes){this.alignLockNodes(AH,AG);}},defaultAction:function S(AK,AG){var AF=AG||this.getCellForNode(AK),AJ=AK&&AK.className.indexOf("sc_")>0;if(this.model&&this.model.data&&this.model.data.visName&&this.model.data.visName==="InteractiveGridAjaxVisualizationStyle"){AJ=this.isReselectedTD(AF);if(AJ&&this.hasSelectAll&&this.hasSelectAll(AF)){this.IGCurrentSelectedCell=null;}else{this.IGCurrentSelectedCell=AF;}}var AI=this.model.getAction(this.getActionCells(AF),AK,AJ),AH=AI&&AI.h;this._currentSelectedTD=AK;if(AH&&this.controller[AH]){this.controller[AH](this,AI.a);return true;}return false;},createZone:function l(AG){var AH=AG||{},AF=this._super&&this._super(AH);if(!AF){AF=new mstrmojo.XtabZone(AH);}return AF;},_setupZone:function t(AJ){this.zones={};if(!this.zone){this.zone=this.createZone({renderMode:this.dataRenderMode,cssText:"z-index: 1",slot:"scrollboxNode"});}var AF=this.zone;this.zones.origin=AF;AF.rh=AJ.rh;AF.autoFitWindow=!!AJ.afw;AF.autoFitContent=!!AJ.afc;if(!this.isVIXtab){AF.tableCssClass="r-cssDefault"+(this.k?"_"+this.k:"");}AF.numColumnCanMerge=AJ.gts&&AJ.gts.cws?(AJ.gts.cws.length-1):0;var AK=[],AH=undefined,AL=null,AI,AG;mstrmojo.array.forEach(AJ.gts&&AJ.gts.row,function(AM){AI=AL&&AL.id===AM.id;if(AI){AK[AK.length-1]+=AM.fs&&AM.fs.length||1;}else{if(AM.otp===-1){AH=0;mstrmojo.array.forEach(AK,function(AN){AH+=AN;});}AK.push(AM.fs&&AM.fs.length||1);}AL=AM;});AF.acws=AK;AF.rowMerge=AJ.gsi&&AJ.gsi.prop&&AJ.gsi.prop.rows&&AJ.gsi.prop.rows.mg!=="0";AG=AJ.ghs&&AJ.ghs.chs;AF.headerOffset=AG&&(AG.show?(AG.items&&AG.items.length||1):0)-1;AF.mxPos=AH;},getHACP:function AC(AG){var AF;if(AG){AF=new mstrmojo.XtabLevelHACP();if(this.outlineState){AF.outlineState=this.outlineState;}}else{AF=(this._super&&this._super())||new mstrmojo.XtabHACP();}return AF;},_setupCP:function W(AL){var AI=this.titlesCP=this.getTitleCP(AL),AK=this.chsCP=this.getColumnHeadersCP(AL),AG=this.rhsCP=this.getRowHeadersCP(AL),AH=this.valuesCP=this.getValuesCP(AL);AI.forceAutoRowHeight=AK.forceAutoRowHeight=AL.rh;var AO=new mstrmojo.XtabVACP();var AF=this.getHACP();AF.cps=[AI,AK];AO.cps=[AF];var AM=this.getHACP(this.isOutlineMode);AM.cps=[AG,AH];AO.cps.push(AM);var AN=AL.gmh&&AL.gmh.gmrh,AJ=AL.rw&&AL.rw.row;if(AN&&AJ){AO.gsmh={};AO.gemh={};AO.gsmh[AJ.bb]=AN.gsmh;AO.gemh[AJ.bb+AJ.bc-1]=AN.gemh;}this.zone.cp=AO;},ongridDataChange:function Z(){var AF=this.model;if(AF){AF.set("data",this.gridData);if(!this.dataBlocks){this.dataBlocks=[];}this.dataBlocks[0]=this.gridData;}},gridPagesRendered:function b(){if(this._super){this._super();}},getTitleCP:function G(AF){return this.initCP(AF,this.interactiveCellsArray,M);},getColumnHeadersCP:function y(AF){return this.initCP(AF,this.interactiveCellsArray,z,AF.ghs&&AF.ghs.chs,AF.gts&&AF.gts.col,X);},getRowHeadersCP:function AA(AF){var AG=this.initCP(AF,this.interactiveCellsArray,I,AF.ghs&&AF.ghs.rhs,AF.gts&&AF.gts.row,Q);if(this.onDemandIF&&this.rw){if(!this._onDemandCP){J.call(this,this.rw&&this.rw.row);}this.rhsCPList=[AG].concat(this._onDemandCP.rhs);return AD(this.rhsCPList)||AG;}return AG;},getValuesCP:function a(AG){var AF=this.initCP(AG,this.interactiveCellsArray,g,AG.gvs,AG.gts&&AG.gts.col);if(this.onDemandIF&&this.rw){if(!this._onDemandCP){J.call(this,this.rw&&this.rw.row);}this.valuesCPList=[AF].concat(this._onDemandCP.vls);return AD(this.valuesCPList)||AF;}return AF;},createOnDemandCP:function f(AG,AH,AF){var AI=new mstrmojo.XtabOnDemandCP();AI.dataSource=this;AI.blockNum=AG;AI.rc=AH;return AI;},dataDownloaded:function T(AG,AM){var AO=AM.blockNum,AF=this.rhsCPList[AO],AH=this.valuesCPList[AO],AN=AG.data,AK=this.gridData;AN._bidx=AO;this.dataBlocks[AO]=AN;if(!AF||!AH){return ;}this.initCP(AN,this.interactiveCellsArray,I,AN.ghs&&AN.ghs.rhs,AN.gts&&AN.gts.row,Q,AF);this.initCP(AN,this.interactiveCellsArray,g,AN.gvs,AK.gts&&AK.gts.col,null,AH);AF.initContent();AH.initContent();this.numRowsDownloaded+=parseInt(AF.rc,10);this.updateStatus(mstrmojo.desc(8301,"Retrieving Data ..."),this.numRowsDownloaded*100/this.numRowsToDownload);var AJ=this.zone;if(AJ){var AL=AJ.cp;if(AL){var AP=AN.gmh&&AN.gmh.gmrh,AI=AN.rw&&AN.rw.row;if(AP&&AI){AL.gsmh[AI.bb]=AP.gsmh;AL.gemh[AI.bb+AI.bc-1]=AP.gemh;}}AJ.dataDownloaded();}},showDownloadStatus:function P(AF){if(!AF){return ;}if(this.showingStatus){this.numRowsToDownload+=AF;}else{this.numRowsToDownload=AF;this.numRowsDownloaded=0;}if(this.showStatus){this.showStatus(true,mstrmojo.desc(8301,"Retrieving Data ..."),this.numRowsDownloaded*100/this.numRowsToDownload);}},closeDownloadStatus:function j(){this.numRowsToDownload=0;if(this.showStatus){this.showStatus(false);}},download:function L(AI,AF,AM){var AL=this.gridData.rw,AH=AL.row,AJ=AL.col,AK=AH.rm,AG=AH.bc;this.rhsCPList[AI].isDownloading=this.valuesCPList[AI].isDownloading=true;if(AG){this.controller.onDownloadGridData(this,this.model.getDownloadAction(AI*AG+1,AG,AJ.bb,AJ.bc,this.id,AK,{blockNum:AI},AF),AM);}},unrender:function E(AF){this.width=this.widthLimit=this.height=this.heightLimit=0;this.disconnectScrollbox(this);this._super(AF);},getCellForNode:function w(AG){var AF=AG&&parseInt(AG.getAttribute("ei"),10);if(isNaN(AF)){return null;}return this.interactiveCellsArray[parseInt(AF,10)];},getActionCells:function O(AF){var AG=[],AI=this.selections;var AJ=AF.axis+"A"+(AF.ui+1),AK=AI[AJ],AH;if(AK&&AK[AF.o]){for(AH in AK){var AL=this.getCellForNode(AK[AH][0]);AG.push(AL);}}else{AG.push(AF);}return AG;},setModel:function AB(AF){this.model=AF;if(AF.data){this.set("gridData",AF.data);}},delegateGridAction:function A(AF,AG){if(this._shouldResponseToAction(AG)){AF(this.zone);}},_shouldResponseToAction:function u(AF){return AF!=="refreshOnDataDownloaded";},getTargetZone:function o(){return this.zone;},destroy:function v(){var AF=this.model;if(this.controller&&this.controller.addScrollPosition){this.controller.addScrollPosition(this.gridData.datasetId+"."+this.gridData.k,this.scrollboxLeft,this.scrollboxTop);}if(AF&&AF.destroy){AF.destroy();}this._super();}});mstrmojo.XtabBase.EnumLockedHeaders={OFF:Y,ROW:C,COL:x,BOTH:N};}());(function(){mstrmojo.StringBuffer=mstrmojo.declare(null,null,{scriptClass:"mstrmojo.StringBuffer",append:function A(C){if(!this.buf){this.reset();}this.buf[++this.len]=C;return this;},reset:function B(){this.buf=[];this.len=-1;}});mstrmojo.StringBuffer.prototype.toString=function(D){var C=this.buf;return(C&&C.join(D||""))||"";};}());(function(){mstrmojo.requiresCls("mstrmojo.prompt.WebPrompts");var D="mstrmojo._ResultSetXt",G=0,Q=1,F=2,N=3,H=4;var U=["promptsAnswerXML","elementsPromptAnswers","valuePromptAnswers","objectsPromptAnswers"];function A(X){if(X.linkAnswers){return true;}var V=U.length,W;for(W=0;W<V;W++){if(X[U[W]]){return true;}}return false;}function C(V){if((!V)||(V.status===undefined)||(isNaN(V.status))){return G;}switch(parseInt(V.status,10)){case 0:case 1:return Q;case 2:return N;case 3:return F;default:return H;}}function L(Z,V,c){var X=c.success;delete c.success;var b=mstrApp,a=!!Z.useRefreshProgress,Y=a?[mstrmojo.desc(10078,"Refreshing data. Please wait.")]:[],W;delete Z.useRefreshProgress;c.success=function(d,e){switch(C(d)){case Q:case N:case G:X(d,e);break;case F:c.failure(d);break;case H:var f;c.success=function(h,j){var g=C(h);switch(g){case Q:case N:X(h,j);break;case G:case H:W();break;default:h.message="Error checking the status of running report/document.";c.failure(h);break;}};W=function(){b.serverRequest({taskId:"pollStatus",msgID:d.id},c,{src:D+"::pollForResult"});};W();break;}};b.serverRequest(Z,c,{src:D+"::pollForResult",showProgress:V,hideProgress:!V,hideWait:!V,useRefreshProgress:a,progressStateText:Y});}function I(X,Z,V,Y){var W=this;L.call(this,X,V,{success:function(a){W.msgId=a.id;if(a.visName){W.visName=a.visName;}var b=C(a);if(b===N){if(Z.prompts){W.loadPrompts({success:Z.prompts,failure:Z.failure});}else{Z.failure({message:"Wrong status. Received Prompts while expected Result."});}}else{if(Z.execSuccess){Z.execSuccess(a);}if(Y&&Y.statusOnly){Z.success(a);}else{if(W.visName&&W.visName!==""){if(!Y){Y={};}Y.colsPerPage=-1;Y.rowsPerPage=-1;}W.getResults(Y,{success:Z.success,failure:Z.failure,complete:Z.complete||mstrmojo.emptyFn,canceled:Z.canceled||mstrmojo.emptyFn});}}},failure:Z.failure,complete:Z.complete||mstrmojo.emptyFn,canceled:Z.canceled||mstrmojo.emptyFn});}function B(W,X){var V=mstrApp.modelFactory;if(V){return V.newPromptsModel(W,X);}return mstrApp.viewFactory.newPrompts(W,X);}mstrmojo._ResultSetXt=mstrmojo.provide("mstrmojo._ResultSetXt",{_mixinName:"mstrmojo._ResultSetXt",msgId:null,execute:function J(X,Z,Y){if(X.link){X.linkAnswers=X.link.toXml();delete X.link;}var W=this,V=mstrmojo.func.addMethods(Z,{prompts:function(a){W.prompts=a;Z.prompts(a);},success:function(a){if(a.prompt){W.prompts=a.prompt;}Z.success(a);}});if(!W.prompts&&A(X)){V.success=function(a,b){delete b.config.hideWait;delete b.config.hideProgress;W.loadPrompts({success:function(c){if(c.prompts){W.prompts=c;W.answers=B(c).buildAnswerObject();}Z.success(a,b);},failure:Z.failure,complete:Z.complete||mstrmojo.emptyFn},{includeClosed:true});};}else{if(X.promptsAnswerXML){V.success=function(a,b){W.prompts=null;W.answers=null;W.loadPrompts({success:function(c){if(c.prompts){W.prompts=c;W.answers=B(c).buildAnswerObject();}Z.success(a,b);},failure:mstrmojo.emptyFn});};}}I.call(this,X,V,true,Y);},answerPrompts:function P(V,Y,X){if(mstrApp.useBinaryFormat){X.objectType=55;}X.taskId="answerPrompts";X.msgID=X.msgId||this.msgId;X.promptAnswerXML=V.getAnswerXML();var W=this;I.call(this,X,{success:function(Z){W.answers=V.buildAnswerObject();Y.success(Z);},prompts:Y.prompts,failure:Y.failure},true);},getResults:function R(V,W){V.messageID=V.msgId||this.msgId;L.apply(this,[V,false,W]);},loadPrompts:function O(W,V){V.taskId="getPrompts";V.msgID=V.msgID||this.msgId;L.apply(this,[V,false,W]);},linkToObject:function K(V,W){this.execute(V,W);},getPrompts:function E(){var V=this.prompts;if(V){return B(this.prompts,this.answers);}return undefined;},checkCache:function T(X,Y,W){var V=mstrmojo.hash.copy(W,{src:D+"::checkCache",override:false,silent:true});X.taskId="checkCache";mstrApp.serverRequest(X,Y,V);},checkCachedLinkTargets:function S(V,X){var W={taskId:"checkCachedLinkTargets",items:V};mstrApp.serverRequest(W,X,{src:D+"::checkCachedLinkTargets",override:false,silent:true});},urlLinkParams:function M(){return U;}});}());(function(){mstrmojo.requiresCls("mstrmojo.XtabBase2","mstrmojo.XtabZone","mstrmojo._TouchGestures","mstrmojo._HasXtabTouchScroll","mstrmojo._XtabSelections","mstrmojo.dom","mstrmojo.hash","mstrmojo.css","mstrmojo._HasMagnifier","mstrmojo.XtabMagnifierHelper");var d=mstrmojo.css,F=mstrmojo.dom;var I=0;var V=1;var Q=2;var e=3;function R(g,h){d.toggleClass(g.firstChild,"tx-active",h);}function C(g){if(g){g.domNode.style.pointerEvents="auto";}}function N(){if(mstrMobileApp.isOnline()){return ;}var m=this.controller,r,q,g,h,u,k,l,p,n=[],j=[],s;if(!m.getLinkRequest){return ;}for(r in this.zones){if(r==="_BL"||r==="_BR"){q=this.zones[r];g=q.getNodesByPositions(q.posMap);for(l=0;l<g.length;l++){h=g[l];u=this.getCellForNode(h);if(u&&u.at&&(u.at&4)){k=this.model.getAction(this.getActionCells(u),null);if(k){p=k.a;s=m.getLinkRequest(p);if(s){n.push(s);j.push(h);}}}}}}var o=n.length;if(o){var t=function(w){var v,x;for(v=0;v<o;v++){x=j[v];if(!w[v]){x.setAttribute("hl_d",true);d.addClass(x,"hl_d");}}};if(mstrApp.isHosted()){}else{this.model.getDataService().checkCachedLinkTargets(n,{success:t,failure:mstrmojo.emptyFn});}}}function a(){if(mstrMobileApp.isOnline()){var l,g,h,k,j;for(l in this.zones){if(l==="_BL"||l==="_BR"){g=this.zones[l];h=g.getNodesByPositions(g.posMap);for(j=0;j<h.length;j++){k=h[j];k.removeAttribute("hl_d");d.removeClass(k,"hl_d");}}}}else{N.call(this);}}mstrmojo.MobileXtab=mstrmojo.declare(mstrmojo.XtabBase2,[mstrmojo._TouchGestures,mstrmojo._HasXtabTouchScroll,mstrmojo._XtabSelections,mstrmojo._HasMagnifier],{scriptClass:"mstrmojo.MobileXtab",frameRate:30,enableMagnifier:true,useSeamlessIncFetch:false,allowToggleSelections:true,markupMethods:{onvisibleChange:function(){this.domNode.style.display=(this.visible)?"block":"none";},onheightChange:function(){this.domNode.style.height=this.height||"";},onwidthChange:function(){this.domNode.style.width=this.width||"";}},init:function X(g){this._super(g);this.magnifierHelper=new mstrmojo.XtabMagnifierHelper({xtab:this});this.disposables.push(this.magnifierHelper);},gridPagesRendered:function B(){this._super();N.call(this);},onRender:function G(){this._super();var g=this.interactiveCellsArray;if(g&&g.length>0&&this.controller.getLinkRequest){if(!this.subscr){var j=mstrmojo.publisher;this.subscr=j.subscribe(j.NO_SRC,j.CONNECTIVITY_CHANGED_EVENT,a,this.id);}if((mstrApp.useBinaryFormat||mstrApp.isHosted())&&!mstrMobileApp.isOnline()){var h=this;window.setTimeout(function(){try{N.call(h);}catch(k){}},100);}}},unrender:function Z(){if(this.subscr){mstrmojo.publisher.unsubscribe(this.subscr);delete this.subscr;}this._super();},getDataService:function J(g){return this.model.getDataService();},setData:function E(g){this.set("gridData",g);},createZone:function D(g){g=g||{};var h=this.getDataService();g.imgCacheMap=(h&&h.imgCache)||this.imgCacheMap;g.unCachedMap={};return this._super(g);},showDownloadStatus:function b(){},onclick:mstrmojo.emptyFn,setupTNs:function O(){var h=this.contentNode,g=h.rows[1].cells[1].lastChild,j=0;switch(this.lockHeadersCase){case I:this._TSN.x=[g.lastChild.lastChild];this._TSN.y=[g.firstChild];break;case Q:this._TSN.x=[h];this._TSN.y=[g.firstChild];break;case V:this._TSN.x=[g];this._TSN.y=[h];j=-1;break;case e:this._TSN.x=[h.rows[0].cells[1].lastChild,g.firstChild];this._TSN.y=[h.rows[1]];j=2;break;}if(j){this._TSN.x[0].style.zIndex=j;}this.setOffsets();this.attachEventListener("scrolledOut",this.id,this.scrolledOut);},useDomToCalculateOffsets:function P(){return(this.lockHeadersCase===I||(this._super&&this._super()));},setOffsets:function c(z){var t=0,h=0;var k=this.lockHeadersCase;if(this.useDomToCalculateOffsets()||z){var p=this._TSN,u=p.x[0],l=p.y[0],n=u.offsetLeft,w=l.offsetTop;if(z){if(!!(k&V)){n=0;}if(!!(k&Q)){w=0;}}t=n+u.offsetWidth+(!!(k&V)?this._BL.offsetWidth:0);h=w+l.offsetHeight+(!!(k&Q)?this._TR.offsetHeight:0);}else{var r=this.zones,q=(this.gridData.rh&&parseInt(this.gridData.rh,10))||0,g=r._TR?r._TR.cp.rc:0,j=r._BR.cp.rc,y=r._BL?r._BL.totalColWidth:0,v=r._BR.totalColWidth;h=((k===V)?j:g+j)*q;t=(k===Q)?v:y+v;}var s=1,m=2,o=this.getGridDimension(m)||0,x=this.getGridDimension(s)||0;this._TMAX={x:Math.min(o-t,0),y:Math.min(x-h,0)};if(this._super){this._super();}},touchTap:function Y(h){if(!this.magnifier){if(this._super){this._super();}if(this.performActionForXtab(h)===false){var g=this.controller;if(g&&g.viewTap){g.viewTap();}}}},performActionForXtab:function W(n){this.deselectCell();var m=F.findAncestorByAttr(n.target,"ei",true,this.domNode);if(!m||!m.value){return false;}var l=m.node,g=this.getCellForNode(l),k=g.at;if(this._super&&this._super(n)){return ;}if(!k){return false;}if((k&4)&&!l.getAttribute("hl_d")){var h=document.createElement("div"),j=h.style;id=this.id;h.className="activeLink on";j.left=l.offsetLeft+"px";j.top=l.offsetTop+"px";j.width=l.offsetWidth+"px";j.height=l.offsetHeight+"px";l.appendChild(h);window.setTimeout(function(){var o=mstrmojo.all[id];if(o&&o.hasRendered){F.attachOneTimeEvent(h,"webkitTransitionEnd",function(){l.removeChild(h);});d.removeClass(h,"on");}},200);}this.defaultAction(l);},selectCell:function L(g){var j=document.createElement("div"),h=j.style;j.className="overlay";h.top=g.offsetTop+"px";h.left=(g.offsetLeft+1)+"px";h.height=(g.clientHeight-2)+"px";h.width=(g.clientWidth-1)+"px";g.appendChild(j);},flagDirtyUnit:function f(g){R(g,true);},clearDirtyUnit:function M(g){R(g,false);},deselectCell:function U(){var g=this._selectedCell;if(g){g.removeChild(g.lastChild);delete this._selectedCell;}},touchSelectBegin:function A(j){if(this.enableMagnifier){var h=this.controller,g;if(h.getMagnifierConfig){g=h.getMagnifierConfig();}this.displayMagnifier(j,g);}},touchSelectMove:function H(h){if(this.enableMagnifier){var g=this;this.latestTouch=h;if(!this._moveMagnifierTimer){this._moveMagnifierTimer=setTimeout(function(){g.displayMagnifier(g.latestTouch);g._moveMagnifierTimer=null;},50);}}},touchSelectCancel:function T(g){C(this.magnifier);},touchSelectEnd:function S(g){C(this.magnifier);},getCaptureDimensions:function K(){var h=this.viewport,g=F.position(this.domNode,true);g.w=Math.min(h.offsetWidth,g.w);g.h=Math.min(h.offsetHeight,g.h);return g;}});}());(function(){mstrmojo.requiresCls("mstrmojo.hash","mstrmojo.func","mstrmojo.Obj");var K=mstrmojo.hash;var P=0;var F=[];var J={};var L=false;function I(T){var U=T.callback;if(U.submission){U.submission(T.id,this.userInteractionRequired(T),T);}this.submitRequest(T);}function G(){if(F.length&&!L){I.call(this,F.shift());}}mstrmojo.ServerProxy=mstrmojo.declare(mstrmojo.Obj,null,{scriptClass:"mstrmojo.ServerProxy",transport:null,cnt:0,request:function E(d,a,U,V){if(U){this.cancelRequests();}var X=this.id,Y=this.transport,T=mstrmojo.now()+a.taskId+P++,W=d.canceled||mstrmojo.emptyFn;d.canceled=function(e){W();d.complete(true);return Y.cancelRequest(e);};d=mstrmojo.func.wrapMethods(d,{complete:function(e){mstrmojo.all[X]&&mstrmojo.all[X].deleteRequest(e);}});var Z=!K.isEmpty(this._requests),b=this.createRequest(T,d,a,V),c=(L||Z)&&!V.doNotHold;if(c){F.push(b);}else{I.call(this,b);}return T;},hasRequests:function O(){return !K.isEmpty(this._requests)||L;},createRequest:function Q(V,X,W,T){var U=this._requests;if(!U){U=this._requests={};}U[V]={id:V,callback:X,params:W,config:T};return U[V];},submitRequest:function M(T){this.transport.serverRequest(this.id,T.id,T);},cancelRequests:function S(){var T=false;K.forEach(this._requests,function(U){if(U.gotResponse===undefined){T|=U.callback.canceled(U.id);}});this._requests={};F=[];return T;},cancelRequest:function B(X){var U=false,W=this._requests[X],V,T=F.length;for(V=0;V<T;V++){if(F[V]===W){break;}}if(V<T){F.splice(V,1);delete this._requests[X];U|=W.callback.canceled(W.id);}return U;},response:function A(X,T,V){$MAPF(false,"AndroidServerTransport","transportRequest");var W=this.getRequest(X);if(W){W.gotResponse=true;var Y=W.callback,U=(T&&!V.mstrerr)?"success":"failure";try{if(Y[U]){Y[U](V,W);}}finally{Y.complete(X);}}G.call(this);},deleteRequest:function N(U){var T=this._requests;delete T[U];},getRequest:function H(U){var T=this._requests;return T&&T[U];},userInteractionRequired:function C(T){return false;},addLoadingGraph:function D(T){J[T]=true;L=true;},removeLoadingGraph:function R(T){delete J[T];if(K.isEmpty(J)){L=false;G.call(this);}},_serverRequestParallel:function(U,W,X,T){var V=T||new mstrmojo.SimpleXHR();V.request("POST",U,{success:function(Y){if(X.success){X.success(Y);}},failure:function(Y){if(X.failure){X.failure({code:Y.getResponseHeader("X-MSTR-TaskErrorCode"),message:Y.getResponseHeader("X-MSTR-TaskFailureMsg")});}},complete:function(){if(X.complete){X.complete();}}},W);},serverRequestParallel:function(U,V,T){this._serverRequestParallel(mstrConfig.taskURL,U,V,T);},upload:function(Z,Y,X,U,W,V,T){mstrmojo.xhr.upload("POST",mstrConfig.taskURL,Z,Y,X,U,W,V,T);}});}());(function(){mstrmojo.requiresCls("mstrmojo.Obj","mstrmojo.hash","mstrmojo.dom","mstrmojo.array","mstrmojo._ResultSetXt","mstrmojo._ReportDataService","mstrmojo._ImageHelper");function B(T,U,Q,R){var S=this;mstrApp.serverRequest(T,{success:function(V){S.msgId=V.id;S.visName=V.visName;S.getResults(R,U);},failure:function(V){if(U.failure){U.failure(V);}},canceled:function(){if(U.canceled){U.canceled();}}},Q);}function C(S,R){var Q={hideWait:!S,delay:true};Q["show"+(R?"Progress":"Wait")]=true;return Q;}var F={objectType:3};var G=mstrmojo.hash.copy,J=mstrmojo.array;function L(){var Q="MojoXtabStyle",S=this.visName;if(S){var R=mstrmojo.AndroidVisList.getVis(S);Q=(R&&R.s)||Q;}return Q;}mstrmojo.XtabDataService=mstrmojo.declare(mstrmojo.Obj,[mstrmojo._ResultSetXt,mstrmojo._ReportDataService,mstrmojo._ImageHelper],{scriptClass:"mstrmojo.XtabDataService",execute:function K(V,X,T){var W=this.id;var S=this.controller.ab;if(S){var U=S.split("|"),Q=mstrApp.isTablet()?"73^":"72^";J.forEach(U,function(b,Z,Y){var a=b.indexOf(Q);if(a>=0){mstrmojo.all[W].visName=b.substring(a+3);return false;}});}var R=mstrmojo.hash.copy(V,{});R.taskId=R.taskId||"reportExecute";R.reportID=R.reportID||this.dssId;R.styleName=mstrApp.isTablet()?"AndroidTabletMessageResultStyle":"AndroidMessageResultStyle";if(V){if(V.dssId){R.reportID=V.dssId;}}this.dssId=R.reportID;this._super(R,X,T);},getResults:function A(W,Y){var V=L.call(this),U=mstrMobileApp.getDeviceDPI(),Z=160;if(U<160){Z=80;}else{if(U>240){Z=230;}}var X={taskId:"iPhoneGetReportResults",styleName:V,zoomFactor:Z,deviceMode:mstrApp.isTablet?(mstrApp.isTablet()?73:72):0};if(W){var S=W.pbUnits,T=W.yPos,R=W.colsPerPage,Q=W.rowsPerPage;if(S){X.pageByKeys=this.pageByUnitsToKeys(S);}if(T){X.yPos=T;}if(R){X.colsPerPage=R;}if(Q){X.rowsPerPage=Q;}}this._super(X,Y);},answerPrompts:function I(Q,R){this._super(Q,R,G(F));},loadPrompts:function H(R,Q){this._super(R,G(F,Q));},drill2Grid:function D(R,S){var Q={taskId:"RWGridDrillToReport",msgID:R.srcMsgId,displayMode:-1,retainParent:3,retainThreshold:3,drillPathKey:R.drillPathKey,drillPathIndex:R.drillPathIndex,elementList:R.drillElements,nodeKey:R.nodeKey,rwGroupByElements:R.rwGroupByElements};if(R.sliceId){Q.sliceId=R.sliceId;}B.call(this,Q,S,C(true,true));},drillGrid:function P(Q,R){B.call(this,{taskId:"gridDrill",msgID:Q.srcMsgId,drillPathKey:Q.drillPathKey,drillPathIndex:Q.drillPathIndex,elementList:Q.drillElements},R,C(true,true));},pageBy:function M(R,T){var S=mstrApp,Q={taskId:"changePageBy",messageID:this.msgId,pageByKeys:this.pageByUnitsToKeys(R)};if(!S.useBinaryFormat){Q.taskId="iPhoneGetReportResults";Q.styleName=L.call(this);Q.zoomFactor=200;}mstrApp.serverRequest(Q,T,C());},sort:function E(Q,R){B.call(this,{taskId:"gridSort",msgID:this.msgId,sortKey:Q.sortKey,sortOrder:((Q.isAsc)?1:0),subtotalPos:Q.subTotalsPos,clearSorts:1},R,C());},pivot:function N(R,S){var Q={taskId:"gridPivot",msgID:this.msgId,objectId:R.objectId,pos:R.pos,objectType:R.objectType};if(R.axis){Q.axis=R.axis;}B.call(this,Q,S,C());},downloadGridData:function O(Q,R){mstrApp.serverRequest({taskId:"DocXtabIncrementalFetch",nodeKey:"",rowPosition:Q.rowPosition,maxRows:Q.maxRows,colPosition:-1,maxColumns:-1},R);}});}());(function(){mstrmojo.requiresCls("mstrmojo.dom");var D=mstrmojo.dom;mstrmojo._FillsBrowser=mstrmojo.provide("mstrmojo._FillsBrowser",{_mixinName:"mstrmojo._FillsBrowser",getBrowserDimensions:function F(H){if(H){return{w:H.innerWidth,h:H.innerHeight};}var G=D.windowDim(),I=(D.isFF||D.isWK)?0:2;return{w:Math.max(G.w,0)+"px",h:Math.max(G.h-I,0)+"px"};},preBuildRendering:function B(){var I=this._super(),H=this.getBrowserDimensions();if(!this.browserResized||this.browserResized(H)!==true){this.height=H.h;this.width=H.w;}if(!this._listenerProc){var K=this.id,J=null,G=this._listenerProc=function(M){if(mstrApp&&mstrApp.isExporting){var L=M||window.event;mstrmojo.all[K].monitorWindow(L);}else{window.clearTimeout(J);J=window.setTimeout(function(){var N=M||window.event;mstrmojo.all[K].monitorWindow(N);},150);}};D.attachEvent(window,"resize",G);}return I;},destroy:function C(G){if(this._listenerProc){D.detachEvent(window,"resize",this._listenerProc);}this._super(G);},getResizeDimensions:function A(G){var J=G.currentTarget,I=this.getBrowserDimensions(),H={w:(J?J.innerWidth+"px":I.w),h:(J?J.innerHeight+"px":I.h)};return H;},monitorWindow:function E(G){var H=this.getResizeDimensions(G);if((H.h===this.height&&H.w===this.width)||parseInt(H.h,10)<=20||parseInt(H.w,10)<=20){return ;}if(!this.browserResized||this.browserResized(H,true)!==true){if(H.h!==this.height){this.set("height",H.h);}if(H.w!==this.width){this.set("width",H.w);}}}});}());(function(){mstrmojo.requiresCls("mstrmojo.MobileXtab","mstrmojo._HasMagnifier");var D="overflow:auto",N="overflow:hidden",J=mstrmojo.dom;function L(V,U){var Q=V.domNode;if(!Q){return false;}var T=U.toLowerCase(),P=V[T],R=parseInt(P,10),S=(U==="Width");Q.style[((S)?"left":"top")]=0;Q.style[T]=P;V.contentNode.parentNode.style[T]=P;V["scrollbox"+U]=R;return true;}function I(g){var X=[];X.push('<table style="border-spacing:0px 0px;background:white;border-collapse:collapse;table-layout:auto">');var Q=function(c,k,j){var h=function(n,m,l){if(n&&n.ts===4){X.push('<td  class="'+(n.css||"")+(l?" xtab-selected-cell":"")+'" ><img src="'+(n.n||n.v)+'"/></td>');}else{X.push('<td  class="'+(n.css||"")+(l?" xtab-selected-cell":"")+'" style="white-space:nowrap;'+m+'">'+(n.n||n.v||"&nbsp;")+"</td>");}};X.push("<tr>");h(c,"text-decoration:none;text-align:right !important");h(k,"text-decoration:none;text-align:left !important",j);X.push("</tr>");};var W=g.si,e=false,P=g.th.length;for(var V=0,Z=g.rh[0].length;V<Z;V++){var S=g.th[0][V];if(P>1&&V===Z-1){S=g.th[P-1][0];}if(V==W){Q(S,g.rh[0][V],true);e=true;break;}Q(S,g.rh[0][V]);}var d=null;if(!e){for(var U=0,f=g.ch.length;U<f;U++){var R=V;for(var T=0,b=g.ch[U].length;T<b;T++){var a=g.ch[U][T],Y=(a&&a.cs)||1;if((W>=R)&&(W<R+Y)){if(a.mix!==undefined){d=a;}else{Q(U==0?g.th[0][V-1]:g.th[U][0],a);}break;}R+=Y;}}Q(a,g.vs[0][W-V],true);}X.push("</table>");return X.join("");}function B(P){var Q=P.target;while(Q&&Q.tagName!="TD"){Q=Q.parentElement;}return Q;}mstrmojo.iXtab=mstrmojo.declare(mstrmojo.MobileXtab,[mstrmojo._FillsBrowser,mstrmojo._HasMagnifier],{scriptClass:"mstrmojo.iXtab",scrollboxHeightFixed:false,enableXtabInteractivity:false,rowAdjust:0,preBuildRendering:function O(){this.numRowFixed=true;this.scrollboxNodeOverflow=N;if(this.enableXtabInteractivity){mstrmojo.requiresCls("mstrmojo._iToolbarMgr");this.toolbarMgr="mstrmojo._iToolbarMgr";}return this._super();},postBuildRendering:function C(){var S=this._super();var P=this.msgNode,T=this.maskNode,U=J.CSS3_TRANSITION_END,V=mstrmojo.dom.attachEvent,Q=mstrmojo.css.parkAfterFade;P.style.height="auto";P.style.width="auto";V(T,U,Q);V(P,U,Q);var R=this;window.setTimeout(function(){T.style.opacity=0;R.clearTransitionCurtain();var W=R.imgCacheMap;if(W&&W.unCachedImg&&W.unCachedImg.length>0){if(R.model&&R.model.cacheImages){R.model.cacheImages(W.unCachedImg.join(",,,"));}}},400);if(this.enableXtabInteractivity){this.requiresContrib("toolbarMgr",true);}if(this.lockHeadersCase==LOCK_OFF||this.lockHeadersCase==LOCK_ROW){this.rowAdjust=this.chsCP.rc||0;}return S;},setTransitionCurtain:function K(P){if(P){P.style.zIndex=20;this.transitionCurtain=P;}},clearTransitionCurtain:function F(){var P=this.transitionCurtain;if(P){var Q=P.style;window.setTimeout(function(){Q.zIndex=-1;P.innerHTML="";},10);Q.opacity=0;}},performAction:function H(R){this.deselectCell();var Q=mstrmojo.dom.findAncestorByAttr(R.target,"ei",true,this.domNode);if(!Q||!Q.value){if(this.controller.touchTap){this.controller.touchTap();}return ;}var P=Q.node;this.defaultAction(P);},updateActionMenu:function A(P,Q){if(this.enableXtabInteractivity&&this.toolbarMgr){this.toolbarMgr.showToolbar(P,Q,this);return true;}else{return false;}},browserResized:function M(Q){if(this.height!==Q.h||this.width!==Q.w){this.height=Q.h;this.width=Q.w;var P=L(this,"Width"),R=L(this,"Height");if(P||R){this.setOffsets();}return true;}return false;},scrolledOut:function E(V){var Q=Math.abs,W={x:0,y:0},T=V.axis,R=(0.2*parseInt(T==="x"?this.width:this.height,10)),P=Q(this._TMAX[T]),S=this._TMIN[T],U=V.value;if(T=="y"&&this.useSeamlessIncFetch){return ;}if((U>(R+P))||(U<(S-R))){W[T]=U;this.controller.swipe({cmd:V.direction,offX:W.x,offY:W.y});}},createZone:function G(P){P=P||{};P.tbodyStyle="background-color:white;";return this._super(P);}});})();(function(){mstrmojo.requiresCls("mstrmojo.Obj","mstrmojo.array","mstrmojo.StringBuffer","mstrmojo.ResSetLink");var j=1,T=2;var E=2,L=4,D=5;var W=1,O=4;var g=mstrmojo.array;function H(k,l){return k[((l===j)?"row":"col")];}function B(k,m){var l=m.lm;return l&&l[k.mix||0];}function c(l,q,w){var u=new mstrmojo.ResSetLink({mid:this.getMessageId(),srct:q.target.t||2,aopam:q.daMode});var r=q.ans,v=r&&r.length;if(v){var s=u.prms=[],m=0;for(m=0;m<v;m++){var AA=r[m];var n=AA.pid,p=parseInt(AA.m,10),y={id:n,am:p,pt:AA.pt};s.push(y);if(AA.po){y.orid=AA.po.did;y.ortp=AA.po.t;}switch(p){case u.DO_NOT_ANSWER:case u.CLOSE:case u.USE_DEFAULT_ANSWER:case u.SAME_PROMPT:break;case u.STATIC:var k=AA.es,x=(k&&k.length)||0,t;y.pa={es:[]};for(t=x-1;t>=0;--t){var o=k[t];y.pa.es.push({ei:o.id,disp_n:o.n,emt:1});}break;case u.DYNAMIC:case u.ALL_VALID_UNITS:case u.CURRENT_UNIT:case u.DYNAMIC_OR_SAME_PROMPT:if(w.els){A.call(this,AA,w,y,p,u);}else{K.call(this,AA,w,y,p,u);}break;}}}return u;}function A(r,l,k,q,p){var o=r.dunits,m=l.els,n=k.pa={};g.forEach(m,function(s){if(g.find(o,"id",s.id)>=0){if(q!==p.DYNAMIC&&q!==p.DYNAMIC_OR_SAME_PROMPT){n.a={id:s.id,n:s.disp_n,dispForms:s.dfi};}if(r.pt===1){n.v=s.v;}else{n.es=[];n.es.push({ei:s.ei,emt:s.emt,disp_n:s.disp_n});}}});}function K(y,v,x,o,q){var r=y.dunits,t=y.dsUnits;if(r&&r.length&&v){var s=x.pa={};var n=v,m=(v.mix!==undefined)&&(v._lp||v._tp);if(m){n=v._lp||v._tp;}var l=parseInt(n.axis,10);while(n){var w=this.getPTitle(n,l);if(w&&g.find(r,"id",w.id)>=0){var p={id:w.id,n:w.n,dispForms:w.dfi};if(o===q.ALL_VALID_UNITS){s.a=(s.a||[]).concat(p);}else{if(o!==q.DYNAMIC&&o!==q.DYNAMIC_OR_SAME_PROMPT){s.a=p;}}if(y.pt===1){var k=y.formMap;s.v=k&&k[n.fmi]?k[n.fmi]:n.v;break;}else{var u={ei:n._e.id,emt:1,disp_n:n._e.n};if(o===q.ALL_VALID_UNITS){s.es=(s.es||[]).concat(u);}else{s.es=[].concat(u);}}if(o===q.CURRENT_UNIT){break;}}n=this.getPCellParentNode(n,l);if(m&&!n&&l===j){l=T;n=v._tp;}}}else{if(t&&t.length&&v){x.pa={es:t};}}}function R(m){var l=this.getCellTitleInfo(m[0]),o=[],q=function(r){if(r){if(mstrApp.useBinaryFormat){if(r._e){o.push(r.axis+"A"+(r.ui+1)+"A"+r._e.id);}q(r._p);}else{o.push(r.axis+"A"+(r.ui+1)+"A"+r.o);}}},n,k;if(!l.isSrcTitle){for(n=0,k=m.length;n<k;n++){var p=m[n];if(p.mix!==undefined&&(p._lp||p._tp)){q(p._lp);q(p._tp);}else{q(p);}}}return(mstrApp.useBinaryFormat)?o:o.join(",");}function J(o,n,l){var m=true,k=l.length;while(o<k){if(l[o].id!==n.id){m=false;break;}o++;}return m;}mstrmojo.XtabModel=mstrmojo.declare(mstrmojo.Obj,null,{scriptClass:"mstrmojo.XtabModel",getMessageId:function S(){return this.data.mid;},getCellTitleInfo:function d(l,o){var m=o?o.gts:this.data.gts;var n=null;if(m){if(l&&l.mix===undefined){n=H(m,l.axis)[l.tui||l.ui];}else{var k=function(r){var p=(r&&r.length)||0,q;for(q=p-1;q>=0;--q){if(parseInt(r[q].otp,10)===-1){return r[q];}}return null;};n=k(m.col)||k(m.row);}}return{isSrcTitle:!!l&&(l.o===undefined)&&!((l.mix!==undefined)&&(l._lp||l._tp)),title:n};},getCellInfo:function I(l){var k=this.getCellTitleInfo(l),m={isTitle:false,isHeader:false,isMetric:false};if(l&&(l.hasOwnProperty("mix")||l.otp===-1)){m.isMetric=true;if(l._e){m.isHeader=true;}}if(k.isSrcTitle){m.isTitle=true;}return m;},getCellLinksInfo:function f(l,m){if(!m){var k=this.getCellTitleInfo(l);m=k&&k.title;}return B(l,m);},getAllDrillPathsForCell:function a(l,n){if(!n){var k=this.getCellTitleInfo(l);n=k&&k.title;}var m=g.filter(n.dp,function(p){var o=p&&p.oid;if(o&&l._e&&l._e.oid){return o===l._e.oid;}return true;});return m;},getCellDrillsInfo:function G(k,m){var l=this.getAllDrillPathsForCell(k,m);return l&&l[k.mix||0];},getLinkDrillAction:function P(k){return this.getActionObject(k);},getAction:function V(k){return this.getActionObject(k);},getActionObject:function M(l){var k=l[0]&&l[0].at,m=null;if(k){if((k&O)>0){m={h:"onLink",a:this.getLinkAction(l[0])};}else{if((k&W)>0){m={h:"onDrill",a:this.getDrillAction(l)};}}}return m;},getSortAction:function F(y,s){var o=this.getCellTitleInfo(y),v=o.title,l=[],n=o.isSrcTitle?v.axis:(g.find(this.data.gts.col,"otp",-1)>-1?j:T),x=this.data.gts[((n===j)?"row":"col")+"SubPos"],q,u,t,w,z;s=(s===null||s===undefined)?!(y&&y.so):s;if(o.isSrcTitle){q=E;u=v.id;t=v.otp;w=v.fid;}else{q=L;t=4;z=v.stt;var r,k;do{r=y._e;if(r){if(r.oid){u=r.oid;}else{k=r.id.replace(/;/g,"\\;");l.push(k);}}y=y._p;}while(y);}var p={sortType:q,axis:n,isAsc:s,unitID:u,unitType:t,elementList:l.join(";"),subTotalsPos:x};if(u){p.unitID=u;}if(w){p.formId=w;}if(z){p.sortType=D;p.stt=z;}var m;if((q===L)||(q===D)){m=["","",p.elementList||"",p.axis];}else{m=[p.formId,"21","",p.axis];}m=[p.unitType,p.unitID].concat(m);p.sortKey=m.join("!");return p;},getSubTotalsPos:function Y(){var k=this.data.gts;if(k){return[k.rowSubPos,k.colSubPos];}return[0,0];},getPivotAction:function N(l,s){var n=false,m=l.hasOwnProperty("mix"),t=m?null:l.axis,q=(m?l.idx:l.ui)+1,y=(l.otp===-1);if(!isNaN(s)){t=parseInt(s,10);q=1;if(m){m=false;y=true;}}else{var w=(s==="u"||s==="l"||s==="b");if(!m){var o=H(this.data.gts,t),AA=0,AD={},k=false;mstrmojo.array.forEach(o,function(AE){if(AD[AE.id]){AD[AE.id].frm++;}else{AA++;AD[AE.id]={pos:AA,frm:1};if(AE.id===l.id){k=true;}else{if(k){return false;}}}});q=AD[l.id].pos;var x=l.fix;if(x){if((!w||x>1)&&!this.xtab.isOutlineMode){if(w||x!==AD[l.id].frm){q=x;n=true;}}}}else{var AB=H(this.data.gts,l.axis),v=AB[l.ui].es,r=this.data.gsi.mx;if(v.length!==r.length){var u=v[q+(w?-1:1)-1];if(u){var p=g.find(r,"did",u.oid);if(p!==-1){q=p+(w?1:-1)+1;}}}}if(s==="b"){q=1;}else{q=q+(w?-1:1);}}var z={act:"pivot",unitPos:q};if(n){z.attFormId=l.fid;}else{if(!m){z.axis=t;}}if(!y){var AC=m?l._e:l;if(!n){z.unitType=AC.otp;}z.unitId=m?AC.oid:l.id;}return z;},isPvtButtonVisible:function e(r,m){var o=r.axis,n=H(this.data.gts,o),q=r.ui,l=r.hasOwnProperty("mix");if(m==="b"&&q===0){return false;}if(!isNaN(m)){if(parseInt(m,10)===o){return false;}if(l){return !!n[r.ui]._hid;}return true;}var p=n[r.ui].es,k=l?p.length:n.length;if(k===1){return false;}if(o===(l?T:j)){if(m==="u"||m==="d"){return false;}}else{if(m==="l"||m==="r"){return false;}}if(l?r._e===p[0]:q===0){if(m==="l"||m==="u"){return false;}}if(l?r._e===p[k-1]:(this.xtab.isOutlineMode&&r.fix)?J(q+1,r,n):q===k-1){if(m==="r"||m==="d"){return false;}}return true;},getDrillAction:function C(k,m){var l=m||this.getCellDrillsInfo(k[0]);return{srcMsgId:this.data.mid,sliceId:this.xtab.sid,isWithin:l.within,drillPathKey:l.k,drillPathIndex:l.dpi,drillElements:R.call(this,k)};},isVis:function b(){if(this.xtab){return this.xtab.isVis&&this.xtab.isVis();}else{var k=this.controller&&this.controller.view;if(k&&k.isVis){return k.isVis();}}return false;},getPTitle:function h(m,l){var k;if(this.isVis()){k=m.titleInfo;}else{k=H(this.data.gts,l)[m.tui];}return k;},getPCellParentNode:function Q(m,l){var k;if(this.isVis()){k=(l===j)?m._lp:m._tp;}else{k=m._p;}return k;},getLinkAction:function U(m,l){var k,n;if(this.isVis()){m=m.node;n=m.titleInfo;}else{k=this.getCellTitleInfo(m);n=k.title;}return this.getLinkActionImpl(m,n,l);},getLinkActionImpl:function Z(w,s,u){var m=B(w,s),t=m&&m.links,x=(m&&m.onw)?"_blank":"";if(u===null||u===undefined){u=(m&&m.di)||0;}var p=t&&t[u];if(!p){return null;}var n={linkInfo:p,linkTarget:x};var k=p.url;if(k){var o="&CurrentElement";if(w&&s&&k.indexOf(o)>-1){k=k.replace(o,w._e.id);}n.url=k;}else{var q=p.target,v,l;switch(parseInt(q&&q.t,10)){case 55:if(parseInt(q.st,10)===14081){if(q.dvm&(8192|2048)&&!((q.dvm&2048&&mstrApp.features["run-vi-flash"]))){v=3140;if(mstrmojo.dom.isIE6||mstrmojo.dom.isIE7||mstrmojo.dom.isIE8){mstrmojo.alert(mstrmojo.desc(15474,"To work with HTML5 dossiers, please turn off your browser Compatibility View or update your browser to one of the following browser versions: Chrome, Firefox, Safari, Internet Explorer 9 or above."));return null;}l="objectID";}else{v=2048001;l="documentID";}}else{v=32001;l="documentID";}break;case 3:v=4001;l="reportID";n.reportViewMode=((parseInt(q.st,10)===769)?2:1);break;default:return null;}n.evt=v;n[l]=q.did;n.srcMsgId=this.getMessageId();var r=c.call(this,m,p,w);if(r){n.link=r;}return n;}},getDownloadAction:function X(n,l,p,m,o,k,q){return{xtabId:o,rowPosition:n,maxRows:l,colPosition:p,maxColumns:m,rowMode:q,memo:k};}});}());(function(){var K=8;function F(L){mstrApp.serverRequest(L);}function B(){var L=mstrmojo.all,M;for(M in L){mstrmojo.registry.remove(L[M]);}}var D=function(L){return L.replace(/\&/g,"&amp;").replace(/</g,"&lt;").replace(/>/g,"&gt;").replace(/\'/g,"&apos;").replace(/\"/g,"&quot;");};var G="iRoot";var C={data:null,controller:null,adjustSize:function(){var L=mstrmojo.all[G];if(L){L._monitorWindow();}},getRWInfo:function(){var L=mstrmojo.all[G].gridData.rw;return'<ifd tr="'+L.tr+'" wmr="'+L.wmr+'" tc="'+L.tc+'" wmc="'+L.wmc+'" wsr="'+L.wsr+'" wsc="'+L.wsc+'"/>';},getPBInfo:function(){var Q="",N=mstrmojo.all[G].gridData,O=N.ghs.phs,M=N.ci,R=N.n||"";if(O||M||R){Q='<report_info n="'+D(R)+'">';if(M){Q+='<ci cid="'+M.cid+'" tp="'+M.tp+'" utm="'+M.utm+'"/>';}if(O){Q+="<pbe>";var P=O.cets;for(var L in P){Q+='<pb ei="'+D(P[L].eid)+'"/>';}Q+="</pbe>";}Q+="</report_info>";}return Q;},hasPageBy:function(){var L=mstrmojo.all[G].gridData.ghs.phs;if(L&&L.cets){return"1";}return"0";},render:function(M){var P=M,L=G,N=this.data;B();if(N&&N.eg){return N.eg;}var O=new mstrmojo.iXtab({id:L,placeholder:G,defn:new mstrmojo.Model({fmts:{top:"0",left:"0",scrollarea:{y:459,x:319}}}),imgCacheMap:P,controller:this.controller});O.model=new mstrmojo.XtabModel({controller:this.controller});O.update({data:N});O.render();return ;},destroy:function(){var L=mstrmojo.all[G];if(L){var O=L.domNode,P=O.lastChild,N=O.childNodes.length,M=0;for(M=0;M<N;M++){window.setTimeout(function(){O.removeChild(O.lastChild);},0);}}}};function H(L,M){C.controller=L;C.data=M;return C;}mstrmojo.iPhoneXtabController=mstrmojo.declare(null,null,{scriptClass:"mstrmojo.iPhoneXtabController",setData:function(L){this.data=L;},getProxy:function(L){return H(this,L);},touchTap:function(){var L={cmd:"tap"};F(L);},swipe:function(L){F(L);},sortGrid:function I(L,M){var N={cmd:"sort",sortKey:M.sortKey,sortOrder:M.sortOrder,clearSort:1,subtotalPos:M.subTotalsPos};F(N);},pivotGrid:function A(L,M){var N={cmd:"pivot",pos:M.pos,axis:M.axis,objectType:M.objectType};F(N);},onDrill:function J(M,O){var N=O.drillElements,P={cmd:"drl",dk:O.drillPathKey};if(N){var L=N.split("A");P.a=L[0];P.d=L[1];P.o=L[2];}F(P);},onLink:function E(L,M){if(M.link){M.linkAnswers=link.toXml();delete M.link;}var P=mstrmojo.hash.copy(M,{cmd:"lnk"});linkInfo=M.linkInfo,areAllAnswersDefault=(linkInfo.daMode==K);if(areAllAnswersDefault){var O=linkInfo.ans;if(O){for(i=0,cnt=O.length;i<cnt;++i){if(O[i].m!=K){areAllAnswersDefault=false;break;}}}}P.areAllAnswersDefault=areAllAnswersDefault?1:0;var N=linkInfo.target;P.tty=N&&N.t;delete P.linkInfo;delete P.linkTarget;delete P.srcMsgId;F(P);}});})();(function(){mstrmojo.requiresCls("mstrmojo.func","mstrmojo.form","mstrmojo.ServerProxy");mstrmojo.iPhoneServerTransport={serverRequest:function B(H,G,F){mstrmojo.form.send(F.params,null,"POST");}};mstrmojo.iPhoneApp=mstrmojo.declare(mstrmojo.Obj,null,{scriptClass:"mstrmojo.iPhoneApp",serverProxy:null,init:function E(F){this._super(F);if(!this.serverProxy){this.serverProxy=new mstrmojo.ServerProxy({transport:mstrmojo.iPhoneServerTransport,_sessions:{}});}},setTarget:function D(F){this.data=F;},setSessionState:function(G,F,H,I){this.serverProxy._sessions[F]=this.sessionState=G;this.baseTaskUrl=I;this.projectId=F;this.hostUrl=H+"/";},getXtabProxy:function A(){if(this.controller){return this.controller.getProxy(this.data);}var F=this.controller=new mstrmojo.iPhoneXtabController();return F.getProxy(this.data);},getDocProxy:function C(){if(this.controller){return this.controller.getProxy(this.data);}var F=this.controller=new mstrmojo.iPhoneDocController();return F.getProxy(this.data);},serverRequest:function B(H){try{var G=this;window.setTimeout(function(){G.serverProxy.request({},H);},0);}catch(F){mstrmojo.err(F);}}});}());