mstr.behaviors.Generic=(function(){var J={};J.returnFalse=function(){return false;};J.returnTrue=function(){return true;};J.set_enabled=function B(K,G){K&&(K.disabled=!G);};J.set_tooltip=function I(K,G){K&&(K.title=(G!=null)?G:"");};J.clearBrowserHighlights=function D(G){mstr.utils.Dom.clearBrowserHighlights(G);return true;};J.set_css_display=function A(M,N,K,L){if(M&&M.style){var G=!!L?N:K;if(!mstr.utils.ISW3C){if(G=="table"){G="block";}}M.style.display=G;}};J.toggleCellElement=function F(S,Q,P,M,N,L,O){var G=(Q>-1)&&S&&S.rows&&S.rows[Q];var R=G&&G.cells&&G.cells[P];var K=R&&R.childNodes&&R.childNodes[M];this.set_css_display(K,N,L,O);};J.renderState=function E(G,L){if(!G){return ;}var M=null;if(L&mstr.Enum.Widget.STATE.SELECTED){M=mstr.Settings.Scheme.SELECTED_BORDERCOLOR;}else{if(L&mstr.Enum.Widget.STATE.HOVER){M=mstr.Settings.Scheme.HOVER_BORDERCOLOR;}else{M=mstr.Settings.Scheme.DEFAULT_BORDERCOLOR;}}if(M!=null){G.style.border="1px "+M+" solid";G.style.margin="0px";}else{G.style.border="0px";G.style.margin="1px";}var K=null;if(!G.disabled&&(L&mstr.Enum.Widget.STATE.SELECTED)&&(L&mstr.Enum.Widget.STATE.HOVER)){K=mstr.Settings.Scheme.SELECTED_HOVER_BGCOLOR;}else{if(L&mstr.Enum.Widget.STATE.SELECTED){K=mstr.Settings.Scheme.SELECTED_BGCOLOR;}else{if(!G.disabled&&(L&mstr.Enum.Widget.STATE.HOVER)){K=mstr.Settings.Scheme.HOVER_BGCOLOR;}else{K=mstr.Settings.Scheme.DEFAULT_BGCOLOR;}}}G.style.backgroundColor=(K!=null)?K:"transparent";};J.oncontextmenu=function C(O,K,G){var M=mstr.$obj(G);var L=new mstr.lang.Event(O,K);if(!M||!M.fireCommands){return true;}var N=M.getModel().getRMCModel();if(M.props.enabled&&N){M.execCommand("OpenPopup",{popup:mstr.$obj("RMCPopup1"),x:L.x+3,y:L.y+3});cancelEvent(O);return false;}return true;};J.on_model_set_validationStatus=function H(K,L,O){if(K.props.visible&&K.props.enabled){var G=L&&L.get("validationStatus"),N=G&&G.statusCode;if(N&&N!=mstr.Enum.Validation.STATUSCODE.VALID){var M=L&&L.get("message");if(M){alert(M);}}}};return J;})();mstr.behaviors.MojoWidget=(function(){var A={};A.on_set_visible=function C(D,F,G){var E=D.props.visible;mstr.behaviors.Generic.set_css_display(G,"block","none",E);if(E){this.renderMojoWidget(D,F,G);}};A.renderMojoWidget=function B(O,K,P){var N=O.props,F=N.id,L=N.cfg,D=L.ui,H=L.data,G=L.dataProp,I={};if(!mstr.utils.String.isEmpty(L)){try{D=JSON.parse(D)||{};}catch(M){}I=D;var J=G&&K.props[G]||{};if(G===undefined){try{H=JSON.parse(H)||{};}catch(M){}J=H;}}I.placeholder=P.lastChild;I.id=F.replace("id_","");var E=function(R){var Q=K.getAncestorByProperty(G,true);if(Q){Q.set(G,R);}};switch(N.name){case"ACLEditor":mstr.$H.overwrite(I,{acls:J});I.onhasChangedChange=function(){var Q=this.getACLItems();E(Q);};I.getAvailableRightsForSelection=function(){return K.props.userSubscribeRights.items;};microstrategy.showSharingEditor(null,null,null,I);break;}};return A;})();mstr.behaviors.FloatingEditor=(function(){var B={};B.on_set_visible=function A(C,E,F){var D=C.props.visible;if(C.get("isModal")){mstr.controllers.ModalEditors[D?"add":"remove"](C);}if(D){F.style.zIndex=microstrategy.getMaxZIndex();}mstr.behaviors.Generic.set_css_display(F,"block","none",D);};return B;})();mstr.behaviors.TextBox=(function(){var D={};D.on_set_visible=function B(P,S,V){mstr.behaviors.Generic.set_css_display(V,"block","none",P.props.visible);if(mstr.utils.ISIE4&&!V.mstrInitialized){V.mstrInitialized=true;var T=V.getElementsByTagName("input")[0];if(T){var O=T.onfocus,U=function(){P.textBoxInitialized=true;return true;};if(O){T.onfocus=function(){return O.apply(this,arguments)&&U.apply(null,arguments);};}else{T.onfocus=U;}var R=T.onblur,Q=function(){P.textBoxInitialized=false;return true;};if(R){T.onblur=function(){return Q.apply(null,arguments)&&R.apply(this,arguments);};}else{T.onblur=Q;}}self.setTimeout('mstr.behaviors.TextBox.initValue("'+P.getId()+'")',100);}};D.initValue=function K(O){var P=mstr.$obj(O);if(P){this.on_model_set_value(P,P.props.model,P.props.element);}};D.on_set_enabled=function H(P,R,S){mstr.behaviors.Generic.set_enabled(S,P.props.enabled);var O=S.childNodes[1].childNodes[0];var Q=P.props.enabled;mstr.behaviors.Generic.set_enabled(O,Q);O.style.backgroundColor=Q?"#ffffff":"#d4d0c8";};D.on_set_caption=function N(P,Q,S){var R=S.childNodes[0];var O=P.props.caption;R.childNodes[0].innerHTML=(O!=null)?O:"";mstr.behaviors.Generic.set_css_display(R,"block","none",(O!=null)&&(O!=""));};D.on_set_size=function M(O,P,R){var Q=parseInt(O.props.size);if(!isNaN(Q)){R.childNodes[1].childNodes[0].size=Q;}};D.on_set_maxlength=function I(P,Q,R){var O=parseInt(P.props.maxlength);if(!isNaN(O)){R.childNodes[1].childNodes[0].maxlength=O;}};D.on_model_set_dataType=function A(O,P,R){var Q=mstr.utils.Math.isDataTypeNumeric(P&&P.get("dataType"));R.childNodes[1].childNodes[0].style.textAlign=Q?"right":"left";};D.on_model_set_value=function F(O,Q,S){var P=Q&&Q.get(O.get("valueField"));if(P==null){P="";}P+="";O.props.rendering=true;var R=O.get("selectionRange");if(R){window.setTimeout(function(){O.set("selectionRange",null);},0);}if(mstr.utils.ISIE4){if(!O.textBoxInitialized||!this._containDBCharacter(P)){S.value=P;}}else{if(S.value!=P){S.value=P;}}if(R){mstr.utils.Controls.setSelectionRange(S,R.start,R.end);}O.props.rendering=false;O.set("validationStatus",{statusCode:mstr.Enum.Validation.STATUSCODE.VALID,message:"",bubble:true});};D._containDBCharacter=function J(O){for(var P=0;P<O.length;P++){var Q=O.charCodeAt(P);if(Q>256&&!this._isDBCurSymbol(Q)){return true;}}return false;};D._isDBCurSymbol=function J(O){return(O==8364)||(O==8361)||(O==65509)||(O==65510);};D.on_value_change=function L(X,T,U){var V=mstr.$obj(X);if(!V){return true;}if(V.props.rendering){return true;}var S=V.getModel();if(S){var Y=mstr.utils.Math.convertStringToDataType(T&&T.value,S.get("dataType"));var O=document.getElementsByClassName("mstrImagePreview")[0],Q=microstrategy.getViewerBone()&&microstrategy.getViewerBone().doc.prevSelectedId,W=document.getElementById(Q);if(O&&Q){if(U){var P=mstr.utils.Math.convertStringToDataType(window.URL.createObjectURL(U),S.get("dataType"));U.url=P;W.setAttribute("ut",mstr.Enum.IMAGE_URL_TYPE.IMAGE_NAME);O.blobURL=P;O.imgName=T.value;}else{O.blobURL=undefined;W.setAttribute("ut",mstr.Enum.IMAGE_URL_TYPE.HTTP_URL);}}var Z=(!V.get("validator")||V.get("validator").validate(Y));if(Z){V.set("selectionRange",mstr.utils.Controls.getSelectionRange(T));if(O){S._storeDeltaProp("imgFile",U);}S.set(V.props.valueField,Y);S.set("isComplex",false);}}var R=V.fireCommands&&V.fireCommands();return true;};D.on_file_selected=function G(O,S){if(S.type!=="file"||!S.files[0]){return false;}var V=document.getElementById("imgUrl_txt"),R=S.files[0];S.value="";if(S.value!=""){var U=S.cloneNode(true);S.parentNode.appendChild(U);if(S.removeNode){S.removeNode(true);}}var P=R.name,Q=["image/jpeg","image/bmp","image/gif","image/png"],T=true;me=this,ONE_MB=1<<20,IMG_MAX_SIZE=3,ORI_MAX_SIZE=10;if(R.size>ORI_MAX_SIZE*ONE_MB||(R.size>IMG_MAX_SIZE*ONE_MB&&R.type==="image/gif")){mstrmojo.alert(mstrmojo.desc(14665,"Cannot embed an image larger than ##MB. Enter a URL to the image instead.").replace("##",IMG_MAX_SIZE));return false;}mstr.$A.forEach(Q,function(X){if(T&&R.type===X){var Y=new Image(),W=new FileReader();W.onload=function(Z){Y.src=Z.target.result;Y.onload=function(){var a=R;if(R.size>IMG_MAX_SIZE*ONE_MB){var c=mstrmojo.imageUtils,b=Y.naturalWidth>=1920&&Y.naturalHeight>=1080?45:75,d=R.type==="image/png"?"png":"jpg";compressImg=c.compress(Y,b,d);a=c.dataURLToBlob(compressImg.src);if(a.size>IMG_MAX_SIZE*ONE_MB){mstrmojo.alert(mstrmojo.desc(14633,"Cannot embed an image larger than ##MB. Your image is still ###MB after compression. Enter a URL to the image instead.").replace("##",IMG_MAX_SIZE).replace("###",(a.size/ONE_MB).toFixed(1)));return false;}}V.value=P;a.name=R.name;me.on_value_change("imgUrl",V,a);};Y.onerror=function(){mstrmojo.alert(mstrmojo.desc(14636,"Invalid image format. Please use .png, .jpg, .jpeg, .gif or .bmp."));return false;};};W.onerror=function(){mstrmojo.alert(mstrmojo.desc(14636,"Invalid image format. Please use .png, .jpg, .jpeg, .gif or .bmp."));return false;};W.readAsDataURL(R);T=false;return false;}});if(T){mstrmojo.alert(mstrmojo.desc(14636,"Invalid image format. Please use .png, .jpg, .jpeg, .gif or .bmp."));return false;}};D.on_keyPress=function E(R,O){R=R||hWin.event;if(R.keyCode==13){var P=mstr.$obj(O);if(!P){return true;}var Q=P.getModel();if(!Q){return true;}if(!Q.get("submitQueueOnEnter")){return true;}if(Q.submitParentQueue){Q.submitParentQueue();}return false;}return true;};D.on_set_validationStatus=function C(O,P,Q){mstr.behaviors.Controls.on_set_validationStatus(O,P,Q);if(!mstr.behaviors.Controls.needsValidation(O)){return true;}if(mstr.behaviors.Controls.validate(O)){Q.style.backgroundImage="none";}else{Q.style.background="#ffffff url(../style/mstr/images/errorLine.gif) bottom left repeat-x";}return true;};return D;})();mstr.behaviors.TextBoxWithIcon=(function(){var B={};B.on_set_enabled=function H(K,N,O){var M=!!K.props.enabled;mstr.behaviors.Generic.set_enabled(O,M);var L=O.childNodes[1].rows[0].cells;var J=L[0].childNodes[0].firstChild;mstr.behaviors.Generic.set_enabled(J,M);J.style.backgroundColor=M?"#ffffff":"#d4d0c8";var I=L[1].childNodes[0];mstr.behaviors.ToolButtonRounded.markAsEnabled(I,M);};B.on_set_caption=function E(J,K,M){var L=M.childNodes[0];var I=J.props.caption;L.childNodes[0].innerHTML=(I!=null)?I:"";mstr.behaviors.Generic.set_css_display(L,"block","none",(I!=null)&&(I!=""));};B.on_set_size=function C(I,J,L){var K=parseInt(I.props.size);if(!isNaN(K)){L.childNodes[1].rows[0].cells[0].childNodes[0].size=K;}};B.on_set_maxlength=function D(J,K,L){var I=parseInt(J.props.maxlength);if(!isNaN(I)){L.childNodes[1].rows[0].cells[0].childNodes[0].maxlength=I;}};B.on_model_set_valueString=function A(I,K,L){var J=K&&K.get("valueString");if(J==null){J="";}L.childNodes[1].rows[0].cells[0].childNodes[0].value=J;};B.onkeypress=function G(L,J,I,K){L=L||J.event;if(L.keyCode==13){this.fire(I,K);stopEventBubbling(L);return false;}return true;};B.fire=function F(I,K){var J=mstr.$obj(I);if(J&&J.fireCommands&&!!J.props.enabled){J.fireCommands(null,K);}return true;};return B;})();mstr.behaviors.ToolButtonRounded=(function(){var E={};E.hover=function C(F){F&&!F.disabled&&(F.style.backgroundPosition="center right");};E.unhover=function B(F){F&&!F.disabled&&(F.style.backgroundPosition="center left");};E.on_set_enabled=function D(F,G,H){this.markAsEnabled(H,!!F.props.enabled);};E.markAsEnabled=function A(G,F){if(!F){this.unhover(G);}mstr.behaviors.Generic.set_enabled(G,F);G.childNodes[0].style.backgroundPosition=F?"left center":"right center";G.childNodes[0].style.cursor=F?"pointer":"default";};return E;})();mstr.behaviors.ToolButton=(function(){var B={};B.hover=function A(F){F&&!F.disabled&&mstr.behaviors.Generic.renderState(F,mstr.Enum.Widget.STATE.HOVER);};B.unhover=function D(F){F&&mstr.behaviors.Generic.renderState(F,0);};B.on_set_enabled=function E(F,G,H){this.markAsEnabled(H,!!F.props.enabled);};B.markAsEnabled=function C(G,F){if(!F){this.unhover(G);}mstr.behaviors.Generic.set_enabled(G,F);G.style.backgroundPosition=F?"left center":"right center";};return B;})();mstr.behaviors.TextLink=(function(){var A={};A.on_set_enabled=function B(D,F,G){var C=G&&G.childNodes[0];if(!C){return ;}var E=D.props.enabled;C.disabled=!E;if(E){C.className=C.className.replace("Disabled","");C.tabIndex="0";}else{C.className+="Disabled";C.tabIndex="-1";}};return A;})();mstr.behaviors.TextFieldLabel=(function(){var A={};A.on_model_set_value=function B(C,F,E){var D=F&&F.get(C.get("valueField"));if(D==null){D="";}D+="";E.innerHTML=D;};return A;})();mstr.behaviors.TextDiv=(function(){var A={};A.on_set_caption=function B(E,F,H){var G=H.childNodes[0];var D=E.props.caption;G.innerHTML=(D!=null)?D:"";mstr.behaviors.Generic.set_css_display(G,"block","none",(D!=null)&&(D!=""));};A.on_model_set_value=function C(D,F,G){var E=(F&&F.get&&F.get("value"))||F;if(E==null||E==undefined||typeof (E)!="string"){E="";}G.childNodes[1].innerHTML=E;};return A;})();mstr.behaviors.ListTextDiv=(function(){var A={};A.on_model_set_items=function B(D,E,F){F.childNodes[1].innerHTML=this.buildObjectListString(E);};A.buildObjectListString=function C(E){var G=[];for(var F=0,D=mstr.$A.len(E);F<D;F++){G[F]=E[F]["n"];}return G.join(", ");};return A;})();mstr.behaviors.Pulldown=(function(){var E={};E.onmousedown=function G(K){var L=mstr.$obj(K);var M=L.getModel&&L.getModel();if(L.props.enabled&&!this._showAsLabel(L,M)){if(L.get("opened")){L.execCommand("ClosePopup");}else{L.execCommand("OpenPopup");if(L.get("popup")&&L.get("popup").focus){L.get("popup").focus();}}}return true;};E.on_set_enabled=function C(K,M,Q){var L=!!K.props.enabled;Q.disabled=!L;var P=Q.childNodes[0];P.style.color=L?"#000000":"#808080";var O=Q.childNodes[1].rows[0].cells[1];O.style.color=L?"#000000":"#808080";O.style.backgroundColor=(this._showAsLabel(K,M))?"transparent":(L?"#ffffff":"#d4d0c8");O.style.cursor=(L&&!this._showAsLabel(K,M))?"pointer":"default";if(O.childNodes[1].firstChild){O.childNodes[1].firstChild.ignoreMouseEvents=!(L&&!this._showAsLabel(K,M));}var N=K.get("disabledModelValue");if(!L&&N!=undefined){M.execSingleSelect(N);}};E.on_set_opened=function J(K,L,N){var M=N.childNodes[1].rows[0].cells[2].childNodes[0];if(K.props.opened){M.className+="Pushed";}else{M.className=M.className.replace(/Pushed/,"");}};E.on_set_width=function A(M,N,O){var L=M.props.width;if(L&&L!="auto"&&!L.match(/\%$/)){O.style.width=L;O.childNodes[1].style.width=L;O.childNodes[1].style.tableLayout="fixed";var K=M.props.popup;if(K){K.width=L;}}};E.on_set_enabled_colorPicker=function I(K,M,P){var L=!!K.props.enabled;P.disabled=!L;var O=P.childNodes[1].rows[0].cells[1].childNodes[1];var N=M.get("actualColor");if(N&&N.indexOf(",")>0){N="#"+N.split(",")[0];}O.style.backgroundColor=L?N:"#a3a19d";};E.clickColorButton=function D(P){var M=mstr.$obj(P);var L=M?M.get("model"):null;var N=L?L.get("parent"):null;var O=M.props.modelPath;var K=O.substring(O.lastIndexOf(mstr.controllers.Factory.PATHDELIM)+1,O.length);if(N&&N.exec){N.exec(K,L.get("actualColor"));}};E.showPulldownOrLabel=function B(K,M,P){var O=P.childNodes[1].rows[0].cells[2];O.style.display=(!this._showAsLabel(K,M))?((mstr.utils.ISW3C)?"table-cell":"block"):"none";var L=P.childNodes[1].rows[0].cells[1];var N=L.className;if(this._showAsLabel(K,M)){if(!/AsLabel$/.test(N)){N+="AsLabel";}}else{N=N.replace(/AsLabel$/,"");}L.className=N;};E._showAsLabel=function H(K,M){var L=M&&M.props&&M.props.items;return(K.props.showSingleItemListAsLabel&&(L&&mstr.$A.len(L)==1));};E.on_model_set_readyState=function F(T,Q,V){var O=Q&&Q.get("readyState");T.set("message",null);var U=V.childNodes[1].rows[0].cells[1];var N=U.childNodes[1];var M=U.childNodes[2];var L=false;if((O!=mstr.Enum.Widget.READYSTATE.IDLE)&&mstr.utils.Hash.isEmpty(Q&&Q.get("selectedIndices"))){L=true;}if(!L){M.style.display="none";N.style.display="block";this.showPulldownOrLabel(T,Q,V);}else{N.style.display="none";M.style.display="block";var S='<span class="'+(T.props.cssPrefix||"")+(T.props.cssClass||"")+'ReadyState">';var K="</span>";var P="";var R=T.props.descriptors;switch(O){case mstr.Enum.Widget.READYSTATE.SUCCESS:P=R&&R.loadingText;break;case mstr.Enum.Widget.READYSTATE.CANCELLED:P=R&&R.requestCancelledText;break;case mstr.Enum.Widget.READYSTATE.WAITING:P=R&&R.waitingText;break;case mstr.Enum.Widget.READYSTATE.TIMEOUT:P="Request timed out.";break;case mstr.Enum.Widget.READYSTATE.ERROR:default:P=R&&R.requestTimeOutText;break;}M.innerHTML=S+P+K;}};return E;})();mstr.behaviors.ListView=(function(){var K={};K.on_set_height=function I(L,N,R){var Q=L&&L.props,P=Q&&Q.scrollArea,M=P&&P.style,O=Q.height;if(M&&O){M.height=O;}};K.on_set_width=function G(M,O,R){var Q=M&&M.props,P=Q&&Q.scrollArea,N=P&&P.style,L=Q.width;if(!N){return ;}if(L==""||L=="auto"){R.style.width=N.width=L;}else{if(L&&L.match(/\%$/)){R.style.width=L;if(!mstr.utils.ISIE6){N.width="auto";}}else{N.width=(L!=null)?L:"";R.style.width="auto";}}};K.on_set_caption=function A(M,N,P){var L=M.props.caption!=null?M.props.caption:"";var O=P.rows[0].cells[0].firstChild.firstChild;mstr.behaviors.Generic.set_css_display(O,"block","none",L!="");O.innerHTML=L;};K.on_set_message=function F(L,M,R){var Q=L&&L.props,O=Q&&Q.message,N=Q&&Q.scrollArea,P=N&&N.childNodes;if(!P){return ;}if(O){P[0].style.display="none";P[1].style.display="none";P[2].style.display="block";P[2].firstChild.innerHTML=O;}else{P[0].style.display="block";P[1].style.display="none";P[2].style.display="none";}};K.on_model_set_leadIndex=function C(M,N,O){var L=mstr.utils.ListViewHelper.getItemRenderer(M);if(!L||!L.on_set_leadIndex){return false;}return L.on_set_leadIndex(M,N,O);};K.on_model_set_readyState=function J(X,S,Y){var Q=S&&S.get("readyState");X.set("message",null);var P=X.props.scrollArea,W=P.childNodes,O=W[1],R=W[0];if(Q==mstr.Enum.Widget.READYSTATE.IDLE){O.style.display="none";R.style.display="block";X._updateEmptyMessage();}else{var N=!X.props.showItemsDuringRequest;if(N){R.style.display="none";}O.style.display="block";var T=X.props.descriptors;switch(Q){case mstr.Enum.Widget.READYSTATE.SUCCESS:O.innerHTML=microstrategy.descriptors.getDescriptor("5674");break;case mstr.Enum.Widget.READYSTATE.CANCELLED:O.innerHTML="Request cancelled.";break;case mstr.Enum.Widget.READYSTATE.WAITING:O.innerHTML=microstrategy.descriptors.getDescriptor("5674");break;case mstr.Enum.Widget.READYSTATE.TIMEOUT:O.innerHTML="Request timed out.";break;case mstr.Enum.Widget.READYSTATE.ERROR:default:var M=T&&T.errorText,U=S&&S.props.requestContext,V=U&&U.response,L=V&&V.errorMessage&&V.errorMessage.replace(/[\r\n]/g,"");if(L){M=M+' <a href="javascript:void(0)" onclick="alert(\''+L.replace(/'/g,"\\'")+"');return false;\">"+T.errorDetailsText+"</a>";}O.innerHTML=M;break;}}};K.ondblclick=function D(P,N,M){var O=mstr.$obj(M);if(!O||!O.fireCommands||!O.props.enabled){return true;}var L=O.props.cmdsDblClick;if(!L){return true;}O.fireCommands(L,null);return true;};K.onmousedown=function B(Q,N,T){var R=mstr.$obj(T);if(!R||!R.fireCommands||!R.props.enabled){return true;}var U=new mstr.lang.Event(Q,N);var M=U.ctrl(),W=U.shift();if(M||W){mstr.utils.Dom.clearBrowserHighlights(N);}var P={valueForm:null,ctrl:M,shift:W,browseType:null,rmc:U.rightClick()};var L=U.target();if(L){L.mstrViewId=T;}var V=mstr.utils.Dom.findAncestor(L,"mstrListItemInfo",null,R.props[mstr.$W.ELEMENT],true);if(V){var O=V.mstrListItemInfo.split("/");var T=O.shift();var S=O.pop();P.valueForm=O.join("/");if(!M&&!W&&!U.rightClick()&&String(L.nodeName).toLowerCase()=="a"){P.browseCommand=S;}}window.setTimeout(function(){R.fireCommands(null,P);},0);return true;};K.on_set_visible=function E(M,N,R){if(M.props.showDescriptions){var L=M.props.scrollArea,P=L.childNodes,O=P[0];O.className+=" mstrListWithDescriptions";}mstr.behaviors.Generic.set_css_display(R,"table","none",M.props.visible);var Q=M.props.id;if(mstr.utils.ISIE4&&!M.keysInited){var Q=M.props.id;R.attachEvent("onkeypress",function(S){mstr.$obj(Q).onkeypress(S,window);});R.attachEvent("onkeydown",function(S){mstr.$obj(Q).onkeydown(S,window);});M.keysInited=true;}};K.on_set_validationStatus=function H(L,O,P){mstr.behaviors.Controls.on_set_validationStatus(L,O,P);if(!mstr.behaviors.Controls.needsValidation(L)){return true;}var N=L&&L.get("validator");var M=N.get("cache");if(mstr.behaviors.Controls.validate(L)){if(M){P.style.color=M.c;P.style.textDecoration=M.td;}}else{if(M){M.c=P.style.color;M.td=P.style.textDecoration;}P.style.color="#ff0000";P.style.textDecoration="underline";}return true;};return K;})();mstr.itemrenderers={};mstr.itemrenderers.FastListView=(function(){var A={};A.listItemHeightMin=function E(J){return 20;};A.listItemHeight=function D(J){return(J&&J.props.showDescriptions)?40:20;};A.listItemHeightMax=function H(J){return(J&&J.props.showDescriptions)?40:20;};A.renderListItem=function C(V,P,Z,K){var Y=K.item;var X=V.props[mstr.$W.DOCUMENT];var Q=(V.props.cssPrefix||"")+(V.props.itemCSSPrefix||"");if("enabled" in Y&&!Y.enabled){Q+="Disabled";}var M=Q;if(Y.cssClass){M=V.props.cssPrefix+Y.cssClass+" "+Q;}var L=X.createElement("div");L.className=M;if(Y.cssText){L.style.cssText=Y.cssText;}if(V&&V.props.showDescriptions){L.style.height=this.listItemHeight(V)+"px";}L.onmouseover=this.hover;L.onmouseout=this.unhover;if(Y.n!=null&&Y.n!=""&&Y.desc!=null&&Y.desc!=""){L.title=Y.n+". "+Y.desc;}else{if(Y.n!=null&&Y.n!=""&&Y.dsn!=null&&Y.dsn!=""){L.title=Y.n+" ("+Y.dsn+")";}else{if(Y.n!=null&&Y.n!=""){L.title=Y.n;}else{if(Y.desc!=null&&Y.desc!=""){L.title=Y.desc;}}}}var R=X.createElement("div");L.appendChild(R);R.className=Q+"Name";if(V.props.showDescriptions&&Y.desc){var J=X.createElement("div");L.appendChild(J);J.className=Q+"Desc";J.appendChild(X.createTextNode(Y.desc));}else{var J=null;}var T=null;if(V.props.shouldReplaceSpace){var S=Y.n.replace(/ /g,"\u00a0");T=X.createTextNode(S||"");}else{T=X.createTextNode(Y.n||"");}var W=K.browseCommand;if(W&&!Y.locked){var O=X.createElement("a");R.appendChild(O);O.appendChild(T);O.href="javascript:void(0)";var N=function(a){cancelEvent(a||window.event);return false;};O.onclick=N;O.tabIndex=-1;O.oncontextmenu=N;W=null;}else{R.appendChild(T);}if(V.props.showIcons){var U=Y.icon;if(Y.locked){U+="_locked";}if(U){mstr.utils.Dom.setBGIconClass(R,U);R.style.backgroundPosition="2px 50%";R.style.paddingLeft="23px";if(J){J.style.paddingLeft="23px";}}}return L;};A.hover=function(J){if(!this.ignoreMouseEvents&&!/Hover$/.test(this.className)){this.className+="Hover";}};A.unhover=function(J){if(!this.ignoreMouseEvents){this.className=this.className.replace(/Hover/,"");}};A.markListItemAsSelected=function B(J,K,O,L){if(J.get("ignoreSelection")){return ;}var M=L.elItem;if(!M){return ;}var N=M.className;if(/Hover/.test(N)){N=N.replace(/Hover/,"SelectedHover");}else{if(!/Selected/.test(N)){N+="Selected";}}M.className=N;};A.markListItemAsUnselected=function G(J,K,N,L){var M=L.elItem;if(!M){return ;}M.className=M.className.replace(/Selected/,"");};A.fireBrowse=function I(){var L=this.mstrListItemInfo||this.parentNode.mstrListItemInfo||this.parentNode.parentNode.mstrListItemInfo;L=L&&L.split("/");if(L&&(L[0]!=null)&&(L[1]!=null)&&(L[2]!=null)){var J=mstr.controllers.Factory.obj(L[0]);var K=J&&J.getModel();if(K){K.execCommand(L[2],L[1]);}}return true;};A.on_set_leadIndex=function F(K,L,O){var N=L&&L.get("leadIndex");if(N==null||N<0){return false;}var M=K&&K._getOrMakeElementForItemAt(N);if(!M){return false;}var J=K.get("scrollArea")||O.rows[0].cells[0].firstChild.childNodes[2];if(!J){return false;}mstr.utils.BoxModel.scrollToElement(J,M);};return A;})();mstr.itemrenderers.ListPulldownView=(function(){var A={};A.renderListItem=function(B,D,I,E){var C=mstr.itemrenderers.FastListView.renderListItem(B,D,I,E);var H=this._getContentContainer(I);mstr.utils.Dom.clearChild(H,0);H.appendChild(C);C.ignoreMouseEvents=!B.props.enabled||E.showAsLabel;H.title=C.title||"";if(mstr.utils.ISIE4){var F=H.style,G=F.width;if(G==null){G="";}F.width="1px";F.width=G;}};A.renderMultipleItems=function(H,E,I,B){var G=B.items;var F=mstr.$A.len(G);var J=new Array(F);for(var D=0;D<F;D++){J[D]=G[D]["n"];}J=J.join(", ");var C=this._getContentContainer(I);C.innerHTML=J;C.title=J;};A.renderEmpty=function(B,C,F,E){var D=(B.props.cssPrefix||"")+(B.props.cssClass||"");this._getContentContainer(F).innerHTML='<span class="'+D+'EmptyText">'+B.props.descriptors.emptyText+"</span>";};A._getContentContainer=function(B){return B.childNodes[1].rows[0].cells[1].childNodes[1];};return A;})();mstr.itemrenderers.CheckList=(function(){var H={};H.renderListItem=function G(M,J,Q,I){if(I.at==0){var L=(M.props.cssPrefix||"")+(M.props.cssClass||"");var O=L+(M.props.multiSelect?"Checks":"Radios");var K=['<table class="'+L+'Table" cellspacing="0" cellpadding="0">','<tbody class="'+O+'" >'];if(M.props.horizontal){K=K.concat(this._buildHorizontalTableHTML(M,J,Q));}else{K=K.concat(this._buildVerticalTableHTML(M,J,Q));}K.push("</tbody></table>");var P=this._getListContainer(Q);if(P){P.innerHTML=K.join("");}}var N=this._findCellForIndex(M,Q,parseInt(I.at),!M.props.horizontal);return N&&N.childNodes[0];};H._buildHorizontalTableHTML=function F(Q,M,S){var O=M&&M.getItems(),N=mstr.$A.len(O),J=Q&&parseInt(Q.props.arrangementSize),P=(!J||(J<1))?N:J,T=mstr.utils.Math.roundUpDiv(N,P);var L=[];if(T&&P){var I=0;for(var R=1;R<=T;R++){L.push("<tr>");for(var K=1;K<=P;K++){L.push(this._buildItemCell(Q,M,S,O[I++]));if(I>=N){break;}}L.push("</tr>");}}return L;};H._buildVerticalTableHTML=function C(Q,M,S){var O=M&&M.getItems(),N=mstr.$A.len(O),J=Q&&parseInt(Q.props.arrangementSize),T=(!J||(J<1))?N:J,P=mstr.utils.Math.roundUpDiv(N,T);var L=[];if(T&&P){var I;for(var R=1;R<=T;R++){L.push("<tr>");for(var K=1;K<=P;K++){I=(R-1)+(K-1)*T;if(I>=N){break;}L.push(this._buildItemCell(Q,M,S,O[I++]));}L.push("</tr>");}}return L;};H._buildItemCell=function A(Q,M,U,S){var J=(S.cssText&&S.cssText!="")?'" style="'+S.cssText:"";var N=(Q.props.cssPrefix||"")+(Q.props.itemCSSPrefix||"");if("enabled" in S&&!S.enabled){N+="Disabled";}var L=!!Q.props.multiSelect;var I=S.n;var O=S.desc;var T=['<td><div onmouseover="return mstr.itemrenderers.CheckList.hover(this)" onmouseout="return mstr.itemrenderers.CheckList.unhover(this)" class="'+N+'" tabindex=0"" title="'+((O!=null&&O!="")?I+". "+O:I)+J+'">'];var R=N+"Name";var K="";if(Q.props.showIcons){var P=S.icon;if(S.locked){P+="_locked";}if(P){R=mstr.utils.Dom.getBGIconClass(P)+" "+R;K=' style="padding-left: 23px" ';}}T.push('<div class="'+R+'" '+K+" >"+S.n+"</div>");if(Q.props.showDescriptions){if((O!=null)&&(O!="")){T.push('<div class="'+N+'Desc" '+K+" >"+O+"</div>");}}return T.join("");};H.hover=function E(I){I.className+="Hover";};H.unhover=function B(I){I.className=I.className.replace(/Hover/,"");};H._getListContainer=function D(I){return I.rows[0].cells[0].firstChild.childNodes[2].firstChild;};H.markListItemAsSelected=function(I,J,L,K){this._toggleCheckBox(I,J,L,K,true);};H.markListItemAsUnselected=function(I,J,L,K){this._toggleCheckBox(I,J,L,K,false);};H._toggleCheckBox=function(I,K,P,L,O){I.props.rendering=true;var M=this._findCellForIndex(I,P,parseInt(L.at),!I.props.horizontal);var J=M&&M.childNodes[0];if(J){if(O){var N=J.className;if(!(/Selected/.test(N))){var N=J.className;if(/Hover/.test(N)){N=N.replace(/Hover/,"SelectedHover");}else{N+="Selected";}J.className=N;}J.tabIndex="-1";}else{J.className=J.className.replace(/Selected/,"");J.tabIndex="0";}}I.props.rendering=false;};H._findCheckboxForIndex=function(I,L,J,K){return this._findCellForIndex(I,L,J,K);};H._findCellForIndex=function(J,M,K,L){var I=this._computeRowColumnForIndex(J,K,L);if(I){return this._getListContainer(M).firstChild.rows[I.row].cells[I.col];}};H._computeRowColumnForIndex=function(I,K,N){var L=parseInt(I.props.arrangementSize);var M=(L&&L>0)?K%L:K;var J=(L&&L>0)?parseInt(K/L):0;if(N){return{row:M,col:J};}else{return{row:J,col:M};}};return H;})();mstr.behaviors.Popup=(function(){var B={};B.on_set_visible=function C(F,G,K,H){var E=F.props.id;var D=new Function("mstr.$obj('"+E+"').props['timeoutID'] = self.setTimeout(\"mstr.$obj('"+E+"').execCommand('Unpop');\", 500)");if((H&&H.init)||!F.props.animate){if(F.props.autoHide){K.onmouseover=new Function("self.clearTimeout(mstr.$obj('"+E+"').props['timeoutID']);");K.onmouseout=D;}return mstr.behaviors.Generic.set_css_display(K,"table","none",F.props.visible);}var I=!!F.props.visible;if(F.props.autoHide&&I){D();}if(I){mstr.behaviors.Generic.set_css_display(K,"table","none",F.props.visible);}var J=new Function("","mstr.behaviors.Popup.on_after_set_visible('"+F.props.id+"')");mstr.utils.Animations.alpha(K,I?0:100,I?100:0,I?5:15,J);};B.on_after_set_visible=function A(D){var E=mstr.$obj(D);if(!E){return ;}var F=!!E.props.visible;var G=E.props.element;if(!F){mstr.behaviors.Generic.set_css_display(G,"table","none",F);}};B.origon_set_visible=function C(D,E,F){mstr.behaviors.Generic.set_css_display(F,"table","none",D.props.visible);};return B;})();mstr.behaviors.Controls=(function(){var B={};B.on_model_set_value=function(C,G,H){if(H==null){return ;}var F=(G&&G.get&&G.get(C.props.valueField));C.props.rendering=true;if(H.tagName.toLowerCase()=="input"){switch(H.getAttribute("type").toLowerCase()){case"checkbox":H.checked=F||false;break;default:H.value=(F!=null&&F!=undefined)?F:"";C.fireCommands(null,G&&G.get&&G.get(C.props.valueField));break;}}else{H.innerHTML=F;}C.set("validationStatus",{statusCode:mstr.Enum.Validation.STATUSCODE.VALID,message:"",bubble:true});C.props.rendering=false;};B.on_set_validationStatus=function E(C,H,I){if(!mstr.behaviors.Controls.needsValidation(C)){return true;}var G=C&&C.get("validator");var F=G.get("cache");var J=C.get("validationStatus");if(mstr.behaviors.Controls.validate(C)){if(F){I.style.borderColor=F.b;I.setAttribute("title",F.t);}}else{if(!F){G.set("cache",{b:I.style.borderColor,t:I.getAttribute("title")});}I.style.borderColor="#ff0000";I.setAttribute("title",J.message);}return true;};B.needsValidation=function A(C){var F=C&&C.get("validator");if(!F){return false;}var G=C.get("validationStatus");if(!G){return false;}return true;};B.validate=function D(C){var F=C.get("validationStatus");return(F.statusCode==mstr.Enum.Validation.STATUSCODE.VALID);};return B;})();mstr.behaviors.ListToolButton=(function(){var B={};B.onmousedown=function A(C){var D=mstr.$obj(C);if(D.props.enabled){D.execCommand("OpenPopup");}return true;};return B;})();mstr.models.PromptAnswer=(function(){mstr.$O.extendsClass(B,mstr.models.BaseModel);B.prototype.validate=function D(F,G){var E=this._validateInternally(F,G);this.set("message",this._getMsgForStatus(E.statusCode));this.set("validationStatus",E);return E.statusCode;};B.prototype.format=function A(E){return this.validate(E,true);};B.prototype.execValidate=function C(E){return(this.validate(E)==mstr.Enum.Validation.STATUSCODE.VALID);};function B(E){mstr.models.BaseModel.apply(this,[E]);}return B;})();mstr.models.ConstantPromptAnswer=(function(){mstr.$O.extendsClass(H,mstr.models.PromptAnswer);H.prototype.getValueString=H.prototype.getSelected=function D(){return this.props.isComplex?null:this.props.valueString;};H.prototype.isEmpty=function G(){var K=this.props,J=K.isComplex?K.complexString:K.valueString;return this._isEmptyAnswerString(J);};H.prototype._isEmptyAnswerString=function E(K){var P=false;var O=this.props;if(O&&O.dataType){var N=String(O.dataType).split(",");var L=mstr.Enum.Nodes.DATATYPE;var J=false;for(var M=0;M<N.length;M++){if(mstr.utils.Math.isDataTypeString(N[M])){J=true;break;}}if(J){if(!K){P=true;}}else{P=mstr.utils.String.isEmpty(K);}}else{P=mstr.utils.String.isEmpty(K);}return P;};H.prototype.format=function F(K){var J=this._validateInternally(K,true);if(J.valueStringFormatted){this.set("valueString",J.valueStringFormatted);}this.set("message",this._getMsgForStatus(J.statusCode));this.set("validationStatus",J);return J;};H.prototype._validateInternally=function C(L,P){var K=mstr.Enum.Validation.STATUSCODE,J={statusCode:K.VALID,context:L&&L.stage};var O=this.get("parent")&&this.get("parent").get("savingAnswer");var M=this.props;if(!M.isComplex){var N=this._validateString(M.valueString,P);J.statusCode=N.statusCode;J.valueStringFormatted=N.valueStringFormatted;}if(J.statusCode==K.VALID&&O){J.statusCode=this.validateSavedAnswer();}return J;};H.prototype._validateString=function A(R,M){var U=mstr.Enum.Validation.STATUSCODE,S={statusCode:U.VALID},K=this.props;if(this._isEmptyAnswerString(R)){if(K.required){S.statusCode=U.NO_INPUT;}}else{if(K.dataType){var V=String(K.dataType).split(",");var J=(mstr.utils.QualNode)?mstr.utils.QualNode.constValue2Array(R,!!K.multiSelect):[R],Z=M?J.concat():[];var T=K.min,W=K.max,Q=mstr.utils.Math,L=mstr.utils.LocaleParser;for(var X=0,Y=J.length;X<Y;X++){var a=J[X],O=L.whichDataType(a,V,M),N=M?O&&O.dataType:O,P;if(N==null){S.statusCode=U.INVALID_DATATYPE;break;}else{if(M){Z[X]=O.formatted;}if(Q.isDataTypeNumeric(N)){P=L.inNumericRange(a,T,W);if(P){S.statusCode=(P>0)?U.EXCEEDS_MAX_VALUE:U.EXCEEDS_MIN_VALUE;break;}}else{if(Q.isDataTypeDateTime(N)){P=L.inDateTimeRange(a,T,W);if(P){S.statusCode=(P>0)?U.EXCEEDS_MAX_VALUE:U.EXCEEDS_MIN_VALUE;break;}}else{if(Q.isDataTypeString(N)){P=L.inNumericRange(a.length,T,W);if(P){S.statusCode=(P>0)?U.EXCEEDS_MAX_LENGTH:U.EXCEEDS_MIN_LENGTH;break;}}else{if(Q.isDataTypeBigDecimal(N)){P=L.inBigDecimalRange(a,T,W);if(P){S.statusCode=(P>0)?U.EXCEEDS_MAX_VALUE:U.EXCEEDS_MIN_VALUE;break;}}}}}}}if(M){S.valueStringFormatted=(mstr.utils.QualNode)?mstr.utils.QualNode.constArray2Value(Z):(Z&&Z.length>0)?Z[0]:null;}}}return S;};H.prototype.loadRequestResponse=function B(){var J=this.props.requestContext;var L=J&&J.response;if(!L||!L.data){this.set("readyState",mstr.Enum.Widget.READYSTATE.ERROR);return ;}this.set("valueString",L.data.get("valueString"));var K=L.data.get("validationStatus");if(K&&K.statusCode!=mstr.Enum.Validation.STATUSCODE.VALID){this.set("message",this._getMsgForStatus(K.statusCode).replace("##",L.data.get("max")));this.set("validationStatus",K);}this.props.requestContext={};this.set("readyState",mstr.Enum.Widget.READYSTATE.IDLE);};H.prototype.init=function I(){mstr.models.PromptAnswer.prototype.init.apply(this);if(!("CommandEnabledValidate" in this.props)){this.set("CommandEnabledValidate",true);}};function H(J){mstr.models.PromptAnswer.apply(this,[J]);}return H;})();mstr.models.ListModel=(function(){mstr.$O.extendsClass(V,mstr.models.BaseModel);V.RESERVED_LISTS={items:true};V.RESERVED_HASHS={selectedIndices:true};function Ac(Ap){var Aq=Ap.props,As=Aq.parent,Ar=As&&As.props.selected,Ao=Ar&&Ar.items||[];if(Aq.autoSelectFirstItem&&!Aq.defaultSelection&&Ap.getSelectedIndex()===-1&&Ao.length===0){Ap.execSelect({0:true});}}V.prototype.DEFAULTS={readyState:mstr.Enum.Widget.READYSTATE.IDLE};V.prototype.sethash=function o(Aq,Ao){var Ap=this.hashclear(Aq);if(Ao&&Ao.length){return this.hashadd(Aq,Ao);}else{return Ap;}};V.prototype.setlist=function J(Aq,Ao){var Ap=this.listclear(Aq);if(Ao&&Ao.length){return this.listadd(Aq,Ao);}else{return Ap;}};V.prototype.execToggleSelect=function AC(Ao){if(this.props.selectedIndices[Ao]){this.execRemoveSelect(Ao);}else{this.execAddSelect(Ao);}this.set("leadIndex",Ao);return true;};V.prototype.execAddSelect=function AL(Ao){if(!mstr.utils.ListModelHelper.canAdd(this,this.getItems()[Ao])){return false;}var Ap={};Ap[Ao]=true;this.hashadd("selectedIndices",Ap);this.props.anchorIndex=Ao;return true;};V.prototype.execRemoveSelect=function AQ(Ao){var Ap={};Ap[Ao]=true;this.hashremove("selectedIndices",Ap);if(this.props.anchorIndex==Ao){this.props.anchorIndex=-1;}return true;};V.prototype.execRangeSelect=function z(Ap){var Ao=this.props.anchorIndex;if(Ao<0){if(mstr.utils.ListModelHelper.canAdd(this,this.getItems()[Ap])){var As={};As[Ap]=true;this.hashadd("selectedIndices",As);}}else{var As={};var At=Math.min(Ap,Ao);var Ar=Math.max(Ap,Ao);for(var Aq=At;Aq<=Ar;Aq++){As[Aq]=true;}if(this.execSelect(As)){this.props.anchorIndex=Ao;}}this.set("leadIndex",Ap);return true;};V.prototype.execSingleSelect=function AD(Ao){if(!this.props.enableReselect){var Aq=this.props.selectedIndices;if(Aq&&Aq[Ao]){if(!mstr.utils.Hash.lenGreaterThan(Aq,1)){return false;}}}var Ap={};Ap[Ao]=true;if(this.execSelect(Ap)){this.props.anchorIndex=Ao;this.set("leadIndex",Ao);}return true;};V.prototype.execRMCSelect=function AR(Ao){var Aq=this.props.selectedIndices;if(Aq&&Aq[Ao]){return false;}var Ap={};Ap[Ao]=true;this.execSelect(Ap);this.props.anchorIndex=Ao;return true;};V.prototype.execSelect=function Ab(Ao){Ao=mstr.utils.ListModelHelper.verifySelectionKeys(this,Ao);if(!Ao){return false;}this.execClearSelect();this.hashadd("selectedIndices",Ao);return true;};V.prototype.execDeleteSelected=function s(){var Ao=this.props.selectedIndices;var Ap=mstr.$H.len(Ao);if(!Ap){return ;}var Aq=mstr.$A.sortNumericArray(mstr.$A.fromHashKeys(Ao,true));this.removeItemsAt(Aq,true);};V.prototype.execRenameSelectedItem=function Am(Ao){if(Ao){var Ap=this.getSelectedIndex();if(Ap==null){return ;}var Aq=this.props.items&&this.props.items[Ap];if(Aq){this.removeItemsAt([Ap],true);Aq.n=Ao;this.insertItemsAt([Aq],Ap);this.execSingleSelect(Ap);}}};V.prototype.execEnableIndices=function Al(Ap){var Ar=mstr.utils.Hash.clone(this.getSelectedIndices());var At=false;for(var Ao in Ap){var Aq=this.indexOfValue(Ao);if(Aq==-1){continue;}var As=this.props.items&&this.props.items[Aq];if(!As||As.enabled==Ap[Ao]){continue;}if(Ar[Aq]){At=true;}this.removeItemsAt([Aq],true);As.enabled=Ap[Ao];this.insertItemsAt([As],Aq);}if(At){this.execSelect(Ar);}};V.prototype.verifySelectionKeys=function AB(Aq){var Ao=this.getItems();for(var Ap in Aq){if(!mstr.utils.ListModelHelper.canAdd(this,Ao[Ap])){delete Aq[Ap];}}return(mstr.utils.Hash.isEmpty(Aq))?null:Aq;};V.prototype.execSelectPrevious=function y(Ar){var At=this.props.selectedIndices;var Au=this.getSelectedItems();var As=parseInt(this.props.leadIndex);var Ao=parseInt(this.props.anchorIndex);if(Ar){var Aq=mstr.utils.Hash.maxNumber(At);if((Ao==As)&&Au.length>1){var Ap={};Ap[As]=true;if((As-1)>=0){Ap[As-1]=true;}this.execSelect(Ap);}else{if(As<=Aq){if((As-1)>=0){this.execRangeSelect(As-1);}}else{this.execRemoveSelect(As);this.set("leadIndex",As-1);}}}else{if((As-1)>=0){this.execClearSelect();this.execSingleSelect(As-1);}}return true;};V.prototype.execSelectNext=function Aj(Ar){var At=this.props.selectedIndices;var Au=this.getSelectedItems();var Ap=this.props.items;var As=parseInt(this.props.leadIndex);var Ao=parseInt(this.props.anchorIndex);if(Ar){if((Ao==As)&&Au.length>1){var Aq={};Aq[As]=true;if((As+1)<Ap.length){Aq[As+1]=true;}this.execSelect(Aq);}else{if(As>=Ao){if((As+1)<Ap.length){this.execRangeSelect(As+1);}}else{this.execRemoveSelect(As);this.set("leadIndex",As+1);}}}else{if((As+1)<Ap.length){this.execClearSelect();this.execSingleSelect(As+1);}}return true;};V.prototype.execSingleSelectNextAndLoop=function Aa(){var Ap=this.props.selectedIndicesList;if(isNaN(Ap)){return false;}var Ao=parseInt(Ap);var Aq=this.props.items.length;var Ar;if(Ao+1<Aq){Ar=Ao+1;}else{Ar=0;}this.execSingleSelect(Ar);return true;};V.prototype.execSelectString=function Af(Aq,As,Ar){if(!Aq){return false;}if(!As){As="n";}var Ap=new RegExp("^"+Aq,"i"),Ao=mstr.$A.matchByForm(this.getItems(),Ap,As,this.props.leadIndex+((Ar===undefined)?1:Ar));return(Ao>-1)&&this.execSingleSelect(Ao);};V.prototype.execSelectValue=function c(Ao){var Ap=this.indexOfValue(Ao);if(Ap==-1){return false;}this.execSingleSelect(Ap);return true;};V.prototype.execSelectValues=function AW(Ao){if(!Ao){return false;}if(typeof (Ao)=="string"){Ao=[Ao];}var Ar={};for(var Aq=0;Aq<Ao.length;Aq++){var Ap=this.indexOfValue(Ao[Aq]);if(Ap!=-1){Ar[Ap]=true;}}if(mstr.utils.Hash.isEmpty(Ar)){return false;}return this.execSelect(Ar);};V.prototype.getSelectedIndices=function AY(){return this.props.selectedIndices;};V.prototype.getSelectedIndex=function AZ(){var Ao=parseInt(mstr.$H.firstKey(this.props.selectedIndices));if(Ao!=null&&!isNaN(Ao)){return Ao;}return -1;};V.prototype.getSelectedItems=function AJ(As){var Ap=this.props.items;if((!Ap||!Ap.length)&&this.props.keptSelections){return[].concat(this.props.keptSelections);}else{var Ao=this.props.selectedIndices;var Au=(As)?mstr.$A.sortNumericArray(mstr.$A.fromHashKeys(Ao,true)):Ao;if(Au){var At=[];for(var Aq in Au){var Ar=(As)?Ap[Au[Aq]]:Ap[parseInt(Aq)];if(Ar){At.push(Ar);}}return At;}}return null;};V.prototype.getAllSelectedItems=function An(At){var Ap=this.props.items||[];var Au=this.props.preSelectedItems||this.props.parent&&this.props.parent.props.selected.props.items||[];for(var Aq=Au.length-1;Aq>=0;Aq--){if(mstrmojo.array.find(Ap,"dssid",Au[Aq].dssid)>=0){Au.splice(Aq,1);}}if((!Ap.length||!Au.length)&&this.props.keptSelections){return[].concat(this.props.keptSelections);}else{var Ao=this.props.selectedIndices;var Av=(At)?mstr.$A.sortNumericArray(mstr.$A.fromHashKeys(Ao,true)):Ao;if(Av){for(var Aq in Av){var As=(At)?Ap[Av[Aq]]:Ap[parseInt(Aq)];if(As){Au.push(As);}}}}this.set("preSelectedItems",Au);if(this.props.parent){var Ar=this.props.parent.props.selected;Ar.set("items",Au);}return Au;};V.prototype.getSelectedItem=function m(){var Aq=this.props.selectedIndices;if(Aq){var Ao=this.props.items;for(var Ap in Aq){return Ao[parseInt(Ap)];}}return null;};V.prototype.getSelectedItemValue=function AG(){var Ap=this.getSelectedItem();var Ao=Ap&&Ap[this.get("valueForm")];return Ao||null;};V.prototype.setSelectedItems=function AN(Ao){var Ap=this.indexOfMultiple(Ao,false);if(Ap&&Ap.foundCount){this.execSelect(mstr.$A.toHash(Ap.indices));}else{this.execClearSelect();}};V.prototype.execClearSelect=function B(){var Ao=mstr.$H.clone(this.props.selectedIndices);this.hashremove("selectedIndices",Ao);this.props.anchorIndex=-1;this.props.leadIndex=-1;};V.prototype.execSelectAll=function e(){var Aq=[];var Ao=this.getItems();for(var Ap=0;Ap<Ao.length;Ap++){Aq.push(true);}this.execSelect(Aq);};V.prototype.queryEnabledSelectAll=function N(){return(this.getSelectedIndices().length!=this.getItems().length);};V.prototype.getItems=function S(){return this.props.items;};V.prototype.setItems=function AS(Ap){this.execClearSelect();var Aq=mstr.$A.len(this.props.items);if(Aq){var Ao={min:0,max:Aq-1};this.removeItemsAtRanges([Ao],true);}this.insertItemsAt(Ap,0);Ac(this);};V.prototype.insertItemsAt=function H(Ar,As){if(As==null||As<0){As=mstr.$A.len(this.props.items);}var At=mstr.$A.len(Ar);if(!At){return -1;}var Aq=this.props.selectedIndices;if(Aq){var Ao={};for(var Ap in Aq){if(parseInt(Ap)>=As){Ap=parseInt(Ap)+At;}Ao[Ap]=true;}this.props.selectedIndices=Ao;}this.listadd("items",Ar,As);this._updateCommandEnabledUpDown();return As;};V.prototype.removeItems=function Ai(Ao){var Ap=this.indexOfMultiple(Ao,false);if(Ap&&Ap.foundCount){this.removeItemsAt(Ap&&Ap.indices);}};V.prototype.removeItemsAt=function n(Aq,Ap){if(!mstr.$A.len(Aq)){return ;}var Ao=mstr.utils.Math.convertIndicesToRanges(Aq,Ap);this.removeItemsAtRanges(Ao,true);};V.prototype.removeItemsAtRanges=function AO(Ap,Aw){if(!mstr.utils.Hash.isEmpty(this.props.selectedIndices)){var Az=Aw?Ap:Ap.concat().sort(mstr.$A.rangeSorter);mstr.$H.remove(this.props.selectedIndices,mstr.utils.Hash.fromRanges(Az));}var Aq=this.listremove("items",Ap,Aw);if(!mstr.utils.Hash.isEmpty(this.props.selectedIndices)){var Ax=mstr.$A.sortNumericArray(mstr.$A.fromHashKeys(this.props.selectedIndices,true));var A1=mstr.$A.len(Ax);for(var At=0,Au=mstr.$A.len(Aq);At<Au;At++){var As=Aq[At].min;var Ay=Aq[At].max;for(var A0=Ay;A0>=As;A0--){for(var Ar=A1-1;Ar>-1;Ar--){if(Ax[Ar]<A0){break;}Ax[Ar]--;}}}this.props.selectedIndices=mstr.$A.toHash(Ax);}else{var Ao=Math.max(Aq[0].min,0);var Av=mstr.$A.len(this.props.items);if(Av){this.execSingleSelect(Math.min(Av-1,Ao));}else{this._updateCommandEnabledUpDown();}}};V.prototype.execUp=function Ad(){var At=this.props.selectedIndices,Ap=mstr.utils.Math.convertIndicesToRanges(mstr.$A.fromHashKeys(At,true),false);var Aq,As;for(var Ar=0,Ao=mstr.$A.len(Ap);Ar<Ao;Ar++){Aq=Ap[Ar];if(Aq&&Aq.min&&(Aq.max>=Aq.min)){As=this.props.items[Aq.min-1];this.removeItemsAtRanges([{min:Aq.min-1,max:Aq.min-1}],true);this.insertItemsAt([As],Aq.max);At[Aq.min-1]=true;At[Aq.max]=false;}}this._updateCommandEnabledUpDown();return true;};V.prototype.execDown=function q(){var At=this.props.selectedIndices,Ap=mstr.utils.Math.convertIndicesToRanges(mstr.$A.fromHashKeys(At,true),false);var Aq,Au=mstr.$A.len(this.props.items)-1,As;for(var Ar=0,Ao=mstr.$A.len(Ap);Ar<Ao;Ar++){Aq=Ap[Ar];if(Aq&&(Aq.max>-1)&&(Aq.max<Au)){As=this.props.items[Aq.max+1];this.removeItemsAtRanges([{min:Aq.max+1,max:Aq.max+1}],true);this.insertItemsAt([As],Aq.min);At[Aq.min]=false;At[Aq.max+1]=true;}}this._updateCommandEnabledUpDown();return true;};V.prototype.on_hashadd_selectedIndices=V.prototype.on_hashremove_selectedIndices=function AX(Ao){if(Ao&&Ao.src==this){this._updateCommandEnabledUpDown();}var Aq=mstr.utils.Arrays.fromHashKeys(Ao.memo.at);this.props.selectedIndicesList=Aq.join(",");var Ap=this.props.selectedIndices;this.set("selectedCount",mstr.utils.Hash.len(Ap));};V.prototype.on_set_selectedIndicesList=function Ah(Ao){this.execSelect(mstr.utils.Arrays.toHash(String(Ao.memo.value).split(",")));};V.prototype._updateCommandEnabledUpDown=function b(){var As=this.props.selectedIndices,At=mstr.$A.len(this.props.items)-1,Aq;var Ao=false,Ap=false;for(var Ar in As){Aq=parseInt(Ar);if(!Ao){Ao=Aq&&!As[Aq-1];}if(!Ap){Ap=(Aq<At)&&!As[Aq+1];}if(Ao&&Ap){break;}}this.set("CommandEnabledUp",Ao);this.set("CommandEnabledDown",Ap);};V.prototype.indexOfItem=function AV(Ap){var Ao=this.props.valueForm;if(Ao!=null&&!Ap.get){return mstr.$A.findByForm(this.props.items,Ap&&Ap[Ao],Ao);}else{return mstr.$A.find(this.props.items,Ap);}};V.prototype.indexOfValue=function AA(Ar){var Ao=false,Ap,At,As;if(Ar instanceof Object){Ap=Ar.form||this.props.valueForm;At=Ar.value;Ao=Ar.ignoreCase?true:false;}else{Ap=this.props.valueForm;At=Ar;}if(Ap!=null){var Aq=this.props.items;if(Aq&&Aq[0]&&Aq[0].get){return mstr.$A.findByGetter(this.props.items,"get",At,Ap);}else{return mstr.$A.findByForm(this.props.items,At,Ap,Ao);}}return -1;};V.prototype.indexOfMultiple=function AH(Ap,Aq){var Ao=this.props.valueForm;if(Ao!=null){return mstr.$A.findByFormMultiple(this.props.items,Ap,Ao,Aq);}else{return mstr.$A.findMultiple(this.props.items,Ap,Aq);}};V.prototype.getContainerTree=function E(){var Ao=this.props.containerTree;if(!Ao){Ao=this.setContainerTree(this.props.container);}return Ao;};V.prototype.setContainerTree=function F(Ao){var Ap=new mstr.models.TreeModel({parent:this,valueForm:this.props.valueForm,scriptClass:"mstr.models.TreeModel"});mstr.controllers.Factory.add(Ap);if(Ao){var Aq={value:Ao};Ap.setRootNode(Aq);Ap.execCommand("SingleSelect",Aq);}this.props.containerTree=Ap;return Ap;};V.prototype.getContainer=function Ak(){var Ao=this.getContainerTree();if(Ao){return Ao.getSelectedNode&&Ao.getSelectedNode();}return null;};V.prototype.execBrowseListItem=function O(Ao){if(Ao&&Ao.browseCommand&&Ao.valueForm!=null){return this.execCommand(Ao.browseCommand,Ao.valueForm);}return false;};V.prototype.execBrowseFolder=function t(Aq){var Ao,Ap;if(Aq&&Aq.dssid!=null){Ao=Aq.dssid;Ap=Aq;}else{if(typeof (Aq)=="string"){Ao=Aq;}}if(Ao){return this.browseFolderBlock(Ao,1,null,Ap);}return false;};V.prototype.browseFolderBlock=function AM(Aq,At,Au,Ap,Ar){if(!At||At<0){return false;}if(!Aq&&!this.props.searchXML){return false;}var Ao;if(!Ar){Ar={};}var As=this.props.searchFlags;if(Au!=null&&Au!=""){Ao=new mstr.http.MetadataSearchRequestInputs(Aq||"",At,(this.props.blockCount&&!this.props.blockCountAuto)?this.props.blockCount:mstr.utils.ListViewHelper.getFetchBlockForTask("searchMetadata"),this.props.totalSize||0,this.props.objectType,this.props.searchXML||"",Au,this.props.dataSourcesXML);if(!Ar.commandId){Ar.commandId="Search";}Ar.searchPattern=Au;Ar.item=Ap;if(As&&(As&mstr.Settings.SearchFlags.rootRecursive)===0&&(As&mstr.Settings.SearchFlags.folderBrowserStyle)===0){Ao.params.recursive=0;}}else{Ao=new mstr.http.BrowseFolderRequestInputs(Aq||"",At,(this.props.blockCount&&!this.props.blockCountAuto)?this.props.blockCount:mstr.utils.ListViewHelper.getFetchBlockForTask("searchMetadata"),this.props.totalSize||0,this.props.hierarchical,this.props.objectType,this.props.searchXML||"",this.props.dataSourcesXML);if(!Ar.commandId){Ar.commandId="BrowseFolder";}if(this.props.styleName){Ao.params.styleName=this.props.styleName;}if(Ao.params.searchXML&&As&&(As&mstr.Settings.SearchFlags.dereferenceshortcut)===0){Ao.params.dereferenceshortcut=0;}Ar.item=Ap;}this.submitRequest(Ao,Ar);return true;};V.prototype.canBrowseFolder=function a(Ao){if(Ao){switch(parseInt(Ao.tp)){case mstr.Enum.MSTRFolderItem.TYPE.FOLDER:case mstr.Enum.MSTRFolderItem.TYPE.PROJECT:return true;}}return false;};V.prototype.canBrowseHierarchy=function d(Ao){return false;};V.prototype._loadResults=function X(Ao){this.set("readyState",mstr.Enum.Widget.READYSTATE.SUCCESS);this.set("searchPattern",(Ao&&Ao.searchPattern)||"");this.set("totalSize",(Ao&&Ao.totalSize)||0);this.set("blockBegin",(Ao&&Ao.blockBegin)||1);this.set("blockCount",(Ao&&Ao.blockCount)||this.props.blockCount||1);this.set("leafElements",!!(Ao&&Ao.leafElements));this._appendBrowsedItemsToContainerTree((Ao&&Ao.browsedItems)||[],(Ao&&Ao.browsedItemsSiblings)||[]);this.set("rmc",(Ao&&Ao.rmc)||null);if(this.props.headerModel){this.updateHeaderModel();}var Ap=(Ao&&Ao.listItems)||[];if(this.props.prefixItems){Ap=Ap.concat(this.props.prefixItems);}this.setItems(Ap);this.set("readyState",mstr.Enum.Widget.READYSTATE.IDLE);};V.prototype.execBrowseContainerTreeNode=function AF(Ar){var Aq=Ar&&Ar.value;if(!Aq){return false;}switch(parseInt(Aq.tp)){case mstr.Enum.MSTRFolderItem.TYPE.FOLDER:case mstr.Enum.MSTRFolderItem.TYPE.PROJECT:return this.browseFolderBlock(Aq[this.props.valueForm],1,null,Aq,{commandId:"BrowseContainerTreeNode",node:Ar});default:if(mstr.utils.ListViewHelper.isWithinHierarchy(Ar)){if(this.isElementSearchRequired(Ar)){var Ao=this.getContainerTree();if(Ao){Ao.removeAllChildNodes(Ar);Ao.execSelect([Ar]);}this._loadResults({browsedItems:null,browsedItemsSiblings:null,listItems:[],totalSize:0,blockBegin:1});return true;}else{var As=this.canAutoExpandOnDrill(),Av=Ar;var Ap=Av&&Av.value;if(As&&Ap&&Ap.filters&&Ap.filters.length==1){if(!Av.children||Av.children.length==0){this._loadResults({browsedItems:[Ap.filters[0]],browsedItemsSiblings:[[Ap.filters[0]]],listItems:[],totalSize:0,blockBegin:1});}Av=Av.children[0];}return this.browseHierarchyBlock(this._buildHierarchyPathForNode(Av),1,"",{commandId:"BrowseContainerTreeNode",node:Av});}}else{if(this._isDummyNode(Ar)){var At=[];if(Ar.children){for(var Au in Ar.children){if(Ar.children[Au].value){At.push(Ar.children[Au].value);}}}var Ao=this.getContainerTree();if(Ao){Ao.removeAllChildNodes(Ar);Ao.execSelect([Ar]);}this._loadResults({browsedItems:null,browsedItemsSiblings:null,listItems:At,totalSize:0,blockBegin:1});return true;}}}return false;};V.prototype.execBrowseContainerParent=function x(){var Aq=this.getContainer();if(Aq&&Aq.parent){var Ap=this.canAutoExpandOnDrill&&this.canAutoExpandOnDrill(),Ar=Aq.parent;if(Ap&&mstr.utils.ListViewHelper.isWithinHierarchy(Ar)){var Ao=Ar&&Ar.value;if(Ao&&Ao.filters&&Ao.filters.length==1){Ar=Ar.parent||Ar;}}return this.execBrowseContainerTreeNode(Ar);}return false;};V.HIERARCHY_PATHDELIM="~";V.ELE_FILTER_ATT_DELIM=",";V.prototype._getNodeFromBrowsePath=function Ae(Ao,Ap){while(Ao){browsePathItem=Ao.value;if(!browsePathItem){break;}tp=parseInt(browsePathItem.tp);if(tp==mstr.Enum.MSTRFolderItem.TYPE.PROJECT||tp==mstr.Enum.MSTRFolderItem.TYPE.FOLDER||tp==mstr.Enum.MSTRFolderItem.TYPE.DIMENSION){break;}if(browsePathItem[this.props.valueForm]==Ap){return Ao;}Ao=Ao.parent;}return null;};V.prototype.execFetchBlock=function P(Ao){if(!Ao){return ;}return this.fetchBlock(Ao,this.props.searchPattern);};V.prototype.execFetchData=function L(){if(this.shouldFetchData()){var Ao=this.props.readyState;if(Ao==null||Ao==mstr.Enum.Widget.READYSTATE.IDLE){return this.execCommand("FetchFirst");}}return false;};V.prototype.shouldFetchData=function C(){if(this.props.totalSize==null){if(this.props.prefixItems){return(mstr.$A.len(this.props.items)-mstr.$A.len(this.props.prefixItems))<=0;}else{return !mstr.$A.len(this.props.items);}}return false;};V.prototype.fetchBlock=function AI(Ao,Ap){var Aq=this.getContainer();if(!Aq){return false;}switch(Aq.value&&parseInt(Aq.value.tp)){case mstr.Enum.MSTRFolderItem.TYPE.FOLDER:case mstr.Enum.MSTRFolderItem.TYPE.PROJECT:return this.browseFolderBlock(Aq.value.dssid,Ao,Ap,Aq.value);break;default:if(mstr.utils.ListViewHelper.isWithinHierarchy(Aq)){if(!Ap&&this.isElementSearchRequired(Aq)){this._loadResults({browsedItems:null,browsedItemsSiblings:null,listItems:[],totalSize:0,blockBegin:1,searchPattern:Ap});return true;}else{return this.browseHierarchyBlock(this._buildHierarchyPathForNode(Aq),Ao,Ap,{commandId:"BrowseContainerTreeNode",node:Aq,searchPattern:Ap});}}else{if(parseInt(Aq.value.tp)==mstr.Enum.MSTRFolderItem.TYPE.ATTRIBUTE){if(!Ap&&this.isElementSearchRequired(Aq)){this._loadResults({browsedItems:null,browsedItemsSiblings:null,listItems:[],totalSize:0,blockBegin:1,searchPattern:Ap});return true;}else{return this.browseAttributeBlock(Aq.value.dssid,Ao,Ap);}}}break;}};V.prototype.execFetchFirst=function AE(){return this.execFetchBlock(1);};V.prototype.execFetchPrevious=function k(){return this.execFetchBlock(this._computePreviousBlockBegin());};V.prototype.execFetchNext=function w(){return this.execFetchBlock(this._computeNextBlockBegin());};V.prototype.execFetchLast=function l(){return this.execFetchBlock(this._computeLastBlockBegin());};V.prototype.queryEnabledFetchFirst=function G(){var Ao=this.props.totalSize;var Ap=this.props.blockCount;return(Ao>0)&&(Ap>0)&&(this.props.blockBegin>1);};V.prototype.queryEnabledFetchPrevious=function AP(){var Ao=this.props.blockBegin;return(Ao>1)&&(this._computePreviousBlockBegin()<Ao);};V.prototype.queryEnabledFetchNext=function U(){return this._computeNextBlockBegin()>0;};V.prototype.queryEnabledFetchLast=function Q(){var Ao=this.props.blockBegin;return Ao>0&&(this._computeLastBlockBegin()>=Ao+this.props.blockCount);};V.prototype._computePreviousBlockBegin=function r(){var Ao=this.props.totalSize;var Ap=this.props.blockCount;if(Ao>0&&Ap>0){return Math.max(1,this.props.blockBegin-Ap);}return -1;};V.prototype._computeNextBlockBegin=function R(){var Ao=this.props.totalSize;var Ap=this.props.blockCount;if(Ao>0&&Ap>0){if(this.props.blockBegin+Ap<=Ao){return this.props.blockBegin+Ap;}}return -1;};V.prototype._computeLastBlockBegin=function u(){var Ao=this.props.totalSize;var Ap=this.props.blockCount;if(Ao>0&&Ap>0){var Aq=Ao%Ap;if(Aq==0){Aq=Ap;}return Ao-Aq+1;}return -1;};V.prototype.getFetchBlockModel=function Y(){var Ar=false;var Ao=this.props.fetchBlockModel;if(Ao){Ar=(Ao.get("blockBegin")==this.props.blockBegin)&&(Ao.get("totalSize")==this.props.totalSize);}if(!Ar){var Aq=parseInt(this.props.totalSize)||0;var Ap={min:Math.min(1,Aq),max:Aq,dataType:mstr.Enum.Nodes.DATATYPE.INTEGER,valueString:parseInt(this.props.blockBegin)||""};Ao=new mstr.models.ConstantPromptAnswer(Ap);if(Ao){mstr.controllers.Factory.add(Ao);Ao.init&&Ao.init();this.props.fetchBlockModel=Ao;}}return Ao;};V.prototype.execSearch=function AU(Ao){this.fetchBlock(1,Ao);};V.prototype.on_set_readyState=function g(Ao){if(Ao&&Ao.src==this){this._updateCommandEnabledSearch();this._updateCommandEnabledFetchBlock();this._updateCommandEnabledBrowseFolder();}};V.prototype._updateCommandEnabledSearch=function D(){var Ap=false;var Aw=false;if(this.props.readyState==mstr.Enum.Widget.READYSTATE.IDLE){var Av=this.getContainer(),Ar=Av&&Av.value,Au=Ar&&parseInt(Ar.tp);switch(Au){case mstr.Enum.MSTRFolderItem.TYPE.FOLDER:Ap=true;break;case mstr.Enum.MSTRFolderItem.TYPE.ATTRIBUTE:var As=this.props.items,Ao=this.props.prefixItems,At=As&&As[(Ao?Ao.length:0)];Ap=(!this.props.elementSearchDisabled)&&(!At||(parseInt(At.tp)==mstr.Enum.MSTRFolderItem.TYPE.ELEMENT));Aw=Ap&&!this.props.matchCaseDisabled;break;case mstr.Enum.MSTRFolderItem.TYPE.FILTER:Ap=(Av.readyState==null)||(Av.readyState==mstr.Enum.Widget.READYSTATE.IDLE);Ap=Ap&&(!this.props.elementSearchDisabled);Ap=Ap&&mstr.utils.ListViewHelper.isWithinHierarchy(Av);Aw=Ap&&!this.props.matchCaseDisabled;break;}}else{if(this.props.readyState==mstr.Enum.Widget.READYSTATE.ERROR){var Aq=this.props.requestContext&&this.props.requestContext.memo&&this.props.requestContext.memo.searchPattern;if(Aq){Ap=true;}}}this.set("CommandEnabledSearch",Ap);this.set("searchMatchCaseAvailable",Aw);};V.prototype._updateCommandEnabledBrowseFolder=function A(){var Aq=this.props.readyState,Ao=this.getContainer(),Ar=(Aq==mstr.Enum.Widget.READYSTATE.IDLE),Ap=(Ar||(Aq==mstr.Enum.Widget.READYSTATE.ERROR))&&!this._isDummyRootNode(Ao);this.set("CommandEnabledBrowseFolder",Ar);this.set("CommandEnabledBrowseContainerTreeNode",Ap);var As=(Ap&&Ao)||null;this.set("CommandEnabledBrowseContainerParent",!!(As&&As.parent&&!(As.parent.parent==null&&this._isDummyNode(As.parent))));};V.prototype._updateCommandEnabledFetchBlock=function W(){var Ap=this.props.blockCount;var Ao=this.props.totalSize;this.set("CommandEnabledFetchBlock",(this.props.readyState==mstr.Enum.Widget.READYSTATE.IDLE)&&(Ap>0)&&(Ao>0)&&(Ap<Ao));};V.prototype.loadRequestResponse=function I(){var At=this.props.requestContext;var A4=At&&At.response;if(!A4||!A4.data){this.set("readyState",mstr.Enum.Widget.READYSTATE.ERROR);return ;}var A2=A4.data;this.set("searchPattern",At.memo&&At.memo.searchPattern);var Ao;if(this.props.keepSelectionsAfterRequest){Ao=this.getAllSelectedItems();if(!Ao||!Ao.length){Ao=this.props.keptSelections;}this.props.keptSelections=null;}var Au;switch(At.memo&&At.memo.commandId){case"BrowseForms":var Aw=A2.getContainer();Au=Aw&&Aw.value&&Aw.value.dssforms;if(this.props.prefixItems){Au=Au?this.props.prefixItems.concat(Au):this.props.prefixItems.concat();}var A1=mstr.$A.len(Au);this.set("totalSize",A1);this.set("blockCount",0);this.set("blockBegin",A1?0:1);this.set("leafElements",false);this.setContainerTree(Aw&&Aw.value);this.setItems(Au||[]);break;default:var A3=["totalSize","blockCount","blockBegin","leafElements"];for(var A0=0;A0<A3.length;A0++){this.set(A3[A0],A2.get(A3[A0]));}switch(At.memo&&At.memo.commandId){case"BrowseHierarchyItem":this._appendBrowsedItemsToContainerTree(At.memo.items,At.memo.itemsSiblings);break;case"BrowseContainerTreeNode":var Az=At.memo.node;if(Az){var As=this.getContainerTree();if(As){As.execCommand("SingleSelect",Az);var Av=Az.parent;var Ar=Av&&Av.children||[Az];for(var A0=0,A1=mstr.$A.len(Ar);A0<A1;A0++){As.removeAllChildNodes(Ar[A0]);}}}break;default:if(this.props.keepFolders||(At.memo&&At.memo.commandId=="BrowseAttribute")){var Ap=At.memo.item;if(!Ap){var Ay=A2.getContainer();Ap=Ay&&Ay.value;}this._appendBrowsedItemsToContainerTree([Ap],[this.getItems()]);}else{var A5=A2.getContainerTree();var Ax=this.getContainerTree();if(Ax){var Aq=A5&&A5.getRootNode();if(Aq){Aq=mstr.utils.Trees.cloneSubTree(Aq);}Ax.setRootNode(Aq);Ax.setSelectedPaths(A5&&A5.getSelectedPaths());}}}Au=A2.getItems()||[];this.setRMCModel(A2.props.rmc);if(this.props.headerModel){this.updateHeaderModel();}if(this.props.prefixItems){Au=Au?this.props.prefixItems.concat(Au):this.props.prefixItems.concat();}this.setItems(Au);}if(mstr.$A.len(Ao)){this.setSelectedItems(Ao);}this.props.requestContext={};this.set("readyState",mstr.Enum.Widget.READYSTATE.IDLE);this.raiseEvent("loadRequestResponse",null);};V.prototype._shouldKeepBrowsedItemSiblings=function AT(Ap,Ao){if(!Ap||!Ao){return null;}if(this.props.keepEntryPoints&&Ap.value&&(Ap.value.tp==mstr.Enum.MSTRFolderItem.TYPE.HIERARCHY)){return mstr.Enum.MSTRFolderItem.TYPE.ATTRIBUTE;}else{if(this.props.keepHierarchies&&(Ao.tp==mstr.Enum.MSTRFolderItem.TYPE.HIERARCHY)){return mstr.Enum.MSTRFolderItem.TYPE.HIERARCHY;}else{if(this.props.keepFolders&&!Ap.parent&&(Ao.tp==mstr.Enum.MSTRFolderItem.TYPE.FOLDER)){return mstr.Enum.MSTRFolderItem.TYPE.FOLDER;}}}return null;};V.prototype._isSingleFilterNode=function K(Ap){var Ao=Ap&&Ap.value;if(Ao&&(Ao.stp==256||Ao.tp==1)){var Aq=Ap.parent&&Ap.parent.value;if(Aq&&Aq.filters&&Aq.filters.length==1){return true;}}return false;};V.prototype._isDummyNode=function h(Ao){return !(Ao&&Ao.value&&Ao.value.tp&&(Ao.value.tp>0));};V.prototype._isDummyRootNode=function Z(Ap){var Aq=Ap&&Ap.value,Ao=Aq&&parseInt(Aq.tp)===mstr.Enum.MSTRFolderItem.TYPE.DUMMY&&parseInt(Aq.stp)===-1&&Aq.dssid==="11111111111111111111111111111111";return Ao;};V.prototype._appendBrowsedItemsToContainerTree=function AK(Aw,Ax){var A1=this.getContainerTree();if(!A1||!mstr.$A.len(Aw)){return ;}var A0=this.getContainer(),Av=this.props.valueForm,A2,Ay,Ap,Ar,Az,Aq;for(var As in Aw){A2=Aw[As];Ay=Ax&&Ax[As];if(!A2||!A0){break;}if(A0&&A0.value&&A0.value[Av]==A2[Av]){if(A0.value.dssforms&&A2.dssforms){A0.value.dssforms=A2.dssforms;}break;}Ar=[];Az=null;var Au=this._isDummyNode(A0);if(Au||(Aq=this._shouldKeepBrowsedItemSiblings(A0,A2))){for(var At=0,Ao=mstr.$A.len(Ay);At<Ao;At++){if(Au||(Ay[At]&&Ay[At]["tp"]==Aq)){Ar.push({value:Ay[At]});if(Ay[At][Av]==A2[Av]){Az=Ar[Ar.length-1];}}}if(!Az){Az={value:A2};Ar.push(Az);}}else{Az={value:A2};Ar.push(Az);}Ap=A1.getNodePath(A0)+mstr.models.AbstractTreeBase.PATHDELIM+mstr.$A.len(A0.children);A1.insertNodesAt(Ar,Ap);A1.execCommand("SingleSelect",Az);A0=Az;}};V.prototype.getPropertyNameForForm=function M(Aq){if(Aq!=null){var Ap=this.getContainer();if(Ap&&Ap.value&&Ap.value.dssforms){var Ao=mstr.$A.findByForm(Ap.value.dssforms,Aq,"dssid");if(Ao>-1){return"form"+Ao;}}}return null;};V.prototype.clone=function Ag(){var Ap=mstr.$H.clone(this.props);Ap.items=[].concat(Ap.items);Ap.selectedIndices=mstr.$H.clone(Ap.selectedIndices);if(this.getContainer()){Ap.containerTree=this.getContainerTree()&&this.getContainerTree().clone();}else{Ap.containerTree=null;}Ap.container=null;Ap.id=mstr.controllers.Factory.nextFreeId();var Ao=new V(Ap,false);if(this.props.headerModel){Ao._initHeaderModel();}if(!Ao){return ;}mstr.controllers.Factory.add(Ao);Ao.init&&Ao.init();return Ao;};V.prototype.init=function T(){mstr.models.BaseModel.prototype.init.apply(this);if(this.props.container||this.props.blockBegin){this._updateCommandEnabledBrowseFolder();this._updateCommandEnabledSearch();}Ac(this);};function V(Ao,Ap){mstr.models.BaseModel.apply(this,[Ao]);this.props.items=this.props.items||[];if(this.props.prefixItems&&(Ap!==false)){this.props.items=this.props.prefixItems.concat(this.props.items);}this.props.selectedIndices=this.props.selectedIndices||{};if(this.props.selectedIndicesList){var Aq=mstr.$A.toHash(this.props.selectedIndicesList.split(","));this.execSelect(Aq);}if(this.props.anchorIndex==null){this.props.anchorIndex=-1;}if(this.props.leadIndex==null){this.props.leadIndex=-1;}this._updateCommandEnabledFetchBlock();}return V;})();mstr.models.dnd={};mstr.models.dnd.DragZone=(function(){mstr.$O.extendsClass(G,mstr.models.BaseModel);G.prototype.init=function E(){mstr.controllers.EventManager.attachWindowEventListener(this,"mousedown","onmousedown");mstr.controllers.EventManager.attachWindowEventListener(this,"mouseup","onmouseup");mstr.utils.Hash.applydefault(this.props,{delay:200});};G.prototype.findTarget=function H(M,N){return null;};G.prototype.getDragData=function L(M,N){return{ddel:this.get("src").cloneNode(true)};};G.prototype.startDrag=function A(M){};G.prototype.drag=function K(N,M,O){};G.prototype.endDrag=function J(N,M,O){};G.prototype.onmousedown=function C(O){if(this.get("view").get("renderStatus")<3){return null;}var M=this.findTarget(this.get("view"),O);if(!M){return ;}var N=this;this.delayHandle=window.setTimeout(function(){N.initDrag(O,M);},this.get("delay"));};G.prototype.initDrag=function D(T,V){delete this.delayHandle;mstr.controllers.EventManager.attachWindowEventListener(this,"mousemove","onmousemove");this.set("dragging",true);this.set("src",V);var S=mstr.utils.BoxModel.getBox(V);this.set("xOffset",T.x-S.left);this.set("yOffset",T.y-S.top);var U=this.getDragData(this.get("view"),T);this.set("data",U);U.ddel.style.left="0";U.ddel.style.top="0";var N=this.get("el");if(!N){N=document.createElement("div");N.style.position="absolute";N.style.zIndex=10001;document.body.appendChild(N);this.set("el",N);}else{N.removeChild(N.firstChild);}N.appendChild(U.ddel);var P={};var Q=["x","y"];var M,O;for(var R=0;R<2;R++){M=Q[R];O=this.get(M+"Min");if(O||!isNaN(O)){P[M+"Min"]=(typeof (O)=="function")?O():O;}O=this.get(M+"Max");if(O||!isNaN(O)){P[M+"Max"]=(typeof (O)=="function")?O():O;}P[M]=(("xMin" in P)||("xMax" in P));}this.set("constraints",P);this.startDrag(this.get("view"));this.onmousemove(T);};G.prototype.onmousemove=function I(O){if(!this.get("dragging")){return ;}var M=O.x-this.get("xOffset");var Q=O.y-this.get("yOffset");var P=this.constrainXY(M,Q);var N=this.get("el");N.style.left=P.x+"px";N.style.top=P.y+"px";this.drag(this.get("view"),P.x,P.y);};G.prototype.onmouseup=function F(N){if(!this.get("dragging")){if(this.delayHandle){window.clearTimeout(this.delayHandle);delete this.delayHandle;}return ;}this.set("dragging",false);mstr.controllers.EventManager.detachWindowEventListener(this,"mousemove");var O=this.constrainXY(N.x-this.get("xOffset"),N.y-this.get("yOffset"));this.endDrag(this.get("view"),O.x,O.y);var M=this.get("el");M.style.top="-10000px";};G.prototype.constrainXY=function B(N,M){var O=this.get("constraints");if(O.x){if(!isNaN(O.xMin)){N=Math.max(N,O.xMin);}if(!isNaN(O.xMax)){N=Math.min(N,O.xMax);}}if(O.y){if(!isNaN(O.yMin)){M=Math.max(M,O.yMin);}if(!isNaN(O.yMax)){M=Math.min(M,O.yMax);}}return{x:N,y:M};};function G(N,M){mstr.models.BaseModel.apply(this,[N]);mstr.utils.Hash.overwrite(this,M);mstr.controllers.Factory.add(this);this.init();}return G;})();mstr.http.FrameProcessor=(function(){mstr.$O.extendsClass(B,mstr.models.BaseModel);B.prototype.isHTTPProcessor=true;B.prototype.setInputs=function C(J){this.props.inputs=J;this.props.readyState=mstr.Enum.Widget.READYSTATE.IDLE;this.props.response=null;};B.prototype.submit=function A(){var K=this.props.inputs;if(!K){return ;}var O=K.htmlForm?K.htmlForm.ownerDocument:this.props.document;if(!O){return ;}var M=K.htmlForm;if(!M){M=O.createElement("form");O.body.appendChild(M);M.method="POST";}var J=this.props.taskURL;J=microstrategy.addJSessionID(J);M.action=J;M.target=this.props.frameName;M.appendChild(this._getHiddenInput(O,"taskEnv","juil_iframe",Q));var N;var Q=(K.htmlForm)?[]:null;for(var P in K.params){M.appendChild(this._getHiddenInput(O,P,K.params[P],Q));}M.appendChild(this._getHiddenInput(O,"_xts_",new Date().getTime(),Q));for(var L in microstrategy.persistParams){M.appendChild(this._getHiddenInput(O,L,microstrategy.persistParams[L],Q));}this.props.cancelled=false;this.props.readyState=mstr.Enum.Widget.READYSTATE.WAITING;this.props.lastSubmit=new Date();if(parseInt(this.props.timeout)){this.props.timeoutId=self.setTimeout('mstr.$obj("'+this.getId()+'").timeout()',parseInt(this.props.timeout));}M.submit();if(Q){while(N=Q.pop()){M.removeChild(N);}}};B.prototype._getHiddenInput=function G(L,N,J,M){var K=L.createElement("input");K.type="hidden";K.name=N;K.value=J;if(M){M.push(K);}return K;};B.prototype.timeout=function H(){this._clearTimeout();if(this.props.readyState==mstr.Enum.Widget.READYSTATE.WAITING){this.set("readyState",mstr.Enum.Widget.READYSTATE.TIMEOUT);}};B.prototype.cancel=function D(){this._clearTimeout();if(this.props.readyState==mstr.Enum.Widget.READYSTATE.WAITING){this.props.cancelled=true;this.set("readyState",mstr.Enum.Widget.READYSTATE.CANCELLED);}};B.prototype.update=function F(J){this._clearTimeout();var K=this.props.response=J&&J.mstrResponse;if(J){J.mstrResponse=null;}if(parseInt(K&&K.statusCode)==200){this.props.lastSuccess=new Date();this.set("readyState",mstr.Enum.Widget.READYSTATE.SUCCESS);}else{this.set("readyState",mstr.Enum.Widget.READYSTATE.ERROR);}};B.prototype.getResponse=function I(){return this.props.response;};B.prototype._clearTimeout=function E(){var J=this.props.timeoutId;if(J){self.clearTimeout(J);this.props.timeoutId=null;}};function B(J){mstr.models.BaseModel.apply(this,[J]);}return B;})();mstr.http.BrowseFolderRequestInputs=(function(){function A(D,E,G,C,B,H,F,I){this.url="../servlet/taskProc";this.params={taskId:"searchMetadata",rootFolderID:D,blockBegin:E,blockCount:G,recursive:B?0:(F?"":1),folderBrowserStyle:B?1:0,includeAncestorInfo:String(!!B),searchXML:F,dataSourcesXML:I||"",objectType:H};}return A;})();mstr.http.MetadataSearchRequestInputs=(function(){function A(C,D,G,B,H,F,E,I){this.params={taskId:"searchMetadata",rootFolderID:C,searchPattern:E,nameWildcards:1,blockBegin:D,blockCount:G,recursive:1,folderBrowserStyle:0,includeAncestorInfo:"true",searchXML:F,dataSourcesXML:I||"",objectType:H};}return A;})();mstr.views={};mstr.views.IView={get:null,set:null,getModel:null,setModel:null,render:null,update:null};mstr.views.BaseView=(function(){mstr.$O.extendsClass(n,mstr.models.BaseModel);n.prototype.DEFAULTS={visible:true,enabled:true,renderStatus:mstr.Enum.Widget.RENDERSTATUS.NOT_STARTED,validationStatus:{statusCode:mstr.Enum.Validation.STATUSCODE.VALID,message:"",bubble:false}};n.prototype.getModel=function G(){return this.props.model;};n.prototype.setModel=function B(AQ){if(AQ==this.props.model){return false;}if(this.props.model){this._detachLayoutHandlers();}this.props.model=AQ;this._modelDirty=true;var AU=this.props.modelPushedProps;var AP=AU&&AU.split&&AU.split(",");for(var AS=0,AO=AP&&AP.length||0;AS<AO;AS++){var AT=AP[AS];var AR=(AT.indexOf("!")==0);if(AR){AT=AT.substr(1);}if(!(AT in AQ.props)){continue;}this["set_"+AT]=function(AV){var AX=AV.name.substring(4,AV.name.length);var AW=AV.originalSrc;this.setPropertyByPath(AX.replace("|","/"),AW&&AW.props[AX],false);};AQ.attachEventListener(this,"set_"+AT,"set_"+AT);if(AR||mstr.controllers.Factory.getPath(AT.replace("|","/"),this)==null){this.setPropertyByPath(AT.replace("|","/"),AQ&&AQ.props[AT],true);if(AQ.props[AT] instanceof mstr.models.BaseModel){AQ.props[AT].set("parent",this);}}}if(this.props.cmds){this._refreshCommandHandlers();}this._refreshChildViewModels();if(this._shouldAutoRender()){this.render();}return true;};n.prototype.initModel=function H(){var AO=this.props.modelPath;if(AO!=null){this.setModel(mstr.controllers.Factory.getPath(AO,this));}};n.prototype.initValidator=function Y(){var AQ=this.props.validator;if(AQ!=null){var AP=AQ[mstr.$W.SCRIPTCLASS]&&mstr.controllers.Factory.registerJSON(AQ,this.props[mstr.$W.DOCUMENT]);if(AP){this.props.validator=AP;var AO=AP.props&&(AP.props[mstr.$W.PARENT]=this);AO=AP.init&&AP.init();}}};n.prototype.execResetValidationStatus=function w(){var AO=this.get("validationStatus");if(AO.statusCode!=mstr.Enum.Validation.STATUSCODE.VALID){this.set("validationStatus",{statusCode:mstr.Enum.Validation.STATUSCODE.VALID,message:"",bubble:true});this.updateAllProps();}};n.prototype.execCheckValidationStatus=function AE(){return !(this.get("validationStatus").statusCode>mstr.Enum.Validation.STATUSCODE.VALID);};n.prototype.after_set_validationStatus=function P(){var AO=this.get("validationStatus");if(AO.bubble){this.raiseEvent("set_childValidationStatus",{id:this.getId(),code:AO.statusCode},true);}};n.prototype._refreshChildViewModels=function m(AQ){for(var AS=0,AP=mstr.$A.len(this._childViewsInstantiated);AS<AP;AS++){var AV=this._childViewsInstantiated[AS];var AU=AV&&AV.props&&AV.props.modelPath;if(AU&&(AU.substring(0,7)=="parent/")){AV.initModel&&AV.initModel();}var AO=AV.props.cmdArray;for(var AR=0,AT=mstr.$A.len(AO);AR<AT;AR++){if(AO[AR]&&AO[AR].targetPath&&(AO[AR].targetPath.substring(0,7)=="parent/")){AV._refreshCommandHandlers();break;}}if(AQ){AV._refreshChildViewModels(AQ);}}};n.prototype.getLayoutXML=function Z(){return this._layoutXML;};n.prototype.setLayoutXML=function AL(AO){if(AO==this._layoutXML){return false;}if(this._layoutXML){this._detachLayoutHandlers();}this._layoutXML=AO;this._layoutDirty=true;if(this._shouldAutoRender()){this.render();}};n.prototype.initLayoutXML=function I(){var AR=this.props[mstr.$W.LAYOUTCLASS];if(AR){AR=AR.replace(/\@[^:]*:/g,"");this.props[mstr.$W.LAYOUTCLASS]=AR;}if(AR){var AQ=AR.split(".");var AP=window;for(var AO=0;AO<AQ.length;AO++){AP=AP[AQ[AO]];}this.setLayoutXML(AP);}};n.prototype.render=function AB(){if(!mstr.timers.renderStart){mstr.timers.renderStart=new Date();}var AQ=mstr.utils.LayoutRenderer;var AO=AQ.render(this.props,this._layoutXML);var AS=AO&&AO.el&&AO.el.childNodes&&AO.el.childNodes[0];if(!AS){return ;}AS.style.display="none";var AP=this.props[mstr.$W.ELEMENT];if(this.get("preserveDOMNode")&&this.get("parent")==null){mstr.$D.insertNode(AS,AP.parentNode,AP);}else{mstr.$D.replaceNode(AP,AS);}this.props[mstr.$W.ELEMENT]=AS;this.props[mstr.$W.RENDERSTATUS]=AO.renderStatus;this._layoutHandlers=AQ.getLayoutHandlers(this.props[mstr.$W.LAYOUTCLASS],this._layoutXML);this._layoutHandlers=AQ.replaceLayoutHandlerTokens(this._layoutHandlers,this);this._attachLayoutHandlers();if(this.props.cmds){this._refreshCommandHandlers();}this._layoutDirty=false;this.updateAllProps();this._modelDirty=false;this.props.childViewPaths=AO.childPaths;this.props.childViewRenderCounter=0;if(mstr.$A.len(AO.childPaths)){var AR=parseInt(this.props.pauseBeforeRenderingChildren);if(AR>0){window.setTimeout('mstr.$obj("'+this.getId()+'").renderNextChildView()',AR);}else{this.renderNextChildView();}}else{this.props[mstr.$W.RENDERSTATUS]=mstr.Enum.Widget.RENDERSTATUS.RENDEREDCHILDREN;mstr.timers.renderStop=new Date();mstr.timers.render=mstr.timers.renderStop-mstr.timers.renderStart;}};n.prototype._shouldAutoRender=function W(){var AO=this.props[mstr.$W.RENDERSTATUS];return(AO!=null&&AO!=mstr.Enum.Widget.RENDERSTATUS.NOT_STARTED);};n.prototype.renderNextChildView=function x(){var AQ=this.props.childViewPaths,AP={};if(AQ){var AO;while(AO=AQ.shift()){if(this.renderChildAt(AO.name,AO.id)){this.props.childViewRenderCounter++;if(this.props.childViewRenderCounter%mstr.views.BaseView.REPAINT_EVERY_CHILDCOUNT==0){window.setTimeout('mstr.$obj("'+this.getId()+'").renderNextChildView()',1);break;}}else{AP[AO.name]=AO;}}this.props.unrenderedChildViewPaths=AP;}if(!mstr.$A.len(AQ)){this.props[mstr.$W.RENDERSTATUS]=mstr.Enum.Widget.RENDERSTATUS.RENDEREDCHILDREN;mstr.timers.renderStop=new Date();mstr.timers.render=mstr.timers.renderStop-mstr.timers.renderStart;this.execLayoutHandler("on_win_resize");}};n.prototype.renderChildAt=function AH(AR,AO){var AS=mstr.controllers.Factory.getPath(AR,this);if(!AS){return false;}var AQ=this.props[mstr.$W.DOCUMENT];var AP=AQ&&AQ.getElementById(AO);mstr.controllers.Factory.safeset(AS,"document",AQ);mstr.controllers.Factory.safeset(AS,"element",AP);mstr.controllers.Factory.safeset(AS,"renderStatus",mstr.Enum.Widget.RENDERSTATUS.NOT_STARTED);if((AS.props&&AS.props.visible==false)||AS.visible==false){return false;}if(!AS.getId){AS[mstr.$W.PARENT]=this;AS=mstr.controllers.Factory.registerElement(AP,null,AS);if(AS){mstr.controllers.Factory.setPath(AR,this,AS,true);}this._childViewsInstantiated.push(AS);}if(AS&&AS.render){AS.render();return true;}return false;};n.prototype._attachLayoutHandlers=function AJ(){var AQ=this.props.model;var AP=this._layoutHandlers&&this._layoutHandlers.info;if(AP&&AQ&&AQ.attachEventListener){for(var AT in AP){switch(AP[AT].src){case"model":AQ.attachEventListener(this,AP[AT].eventName,"update");break;case"win":mstr.controllers.EventManager.attachWindowEventListener(this,AP[AT].eventName,"update");break;default:if(AP[AT]&&AP[AT].src&&AP[AT].src.substr(0,5)=="model"){var AS=AP[AT].src.split(".");var AO=AQ;for(var AR=1;AR<AS.length;AR++){AO=AO.get(AS[AR]);}AO.attachEventListener(this,AP[AT].eventName,"update");break;}}}}this._attachPropertiesHandlers(["enabled","visible"]);};n.prototype._attachPropertiesHandlers=function AG(AO){var AX,AW,AP,AV,AU;for(var AQ=0,AS=AO.length;AQ<AS;AQ++){AX=this.props[AO[AQ]+"Field"];if(AX==null||AX==""){continue;}AU="on"+AO[AQ]+"FieldValueChange";if(!this[AU]){continue;}if(AX.charAt(0)=="!"){AX=AX.substring(1);}AW=AX.split(mstr.controllers.Factory.PATHDELIM);AV=AW.pop();var AT=AV.indexOf(":");if(AT>-1){var AR=AV.split(":");AV=AR[0];this.props[AO[AQ]+"SourceFieldValues"]=AR[1].split(",");}this.props[AO[AQ]+"SourceField"]=AV;AX=AW.join(mstr.controllers.Factory.PATHDELIM);this.props[AO[AQ]+"Source"]=AP=AX.length?mstr.$path(AX,this):this;if(AP instanceof mstr.models.ListModel&&AV=="selectedIndices"){AP&&AP.attachEventListener&&AP.attachEventListener(this,"hashadd_"+AV,AU);}else{AP&&AP.attachEventListener&&AP.attachEventListener(this,"set_"+AV,AU);}if(AP){this[AU]({memo:{value:AP.get(AV)}});}}};n.prototype._detachLayoutHandlers=function AI(){var AP=this.props.model;var AO=this._layoutHandlers&&this._layoutHandlers.info;if(AO&&AP&&AP.detachEventListener){for(var AQ in AO){switch(AO[AQ].src){case"model":AP.detachEventListener(this,AO[AQ].eventName);break;case"win":mstr.controllers.EventManager.detachWindowEventListener(this,AO[AQ].eventName);}}}this._detachPropertiesHandlers(["enabled","visible"]);};n.prototype._detachPropertiesHandlers=function X(AS){var AR,AQ;for(var AP=0,AO=AS.length;AP<AO;AP++){AR=this.props[AS[AP]+"Source"];AQ=this.props[AS[AP]+"SourceField"];AR&&AR.detachEventListener&&AR.detachEventListener(this,"set_"+AQ);}};n.prototype.onenabledFieldValueChange=function L(AO){var AQ=this.extractEventSourceFieldValue("enabled",AO);var AP=this.props.enabledField;if(AP&&AP.charAt(0)=="!"){AQ=!AQ;}this.set("enabled",AQ);};n.prototype.onvisibleFieldValueChange=function O(AO){var AP=this.extractEventSourceFieldValue("visible",AO);fieldPath=this.props.visibleField;if(fieldPath&&fieldPath.charAt(0)=="!"){AP=!AP;}this.set("visible",AP);};n.prototype.extractEventSourceFieldValue=function k(AQ,AO){if(!this.props[AQ+"SourceFieldValues"]){return !!AO&&AO.memo&&AO.memo.value;}else{var AU=this.props[AQ+"Source"];if(AU instanceof mstr.models.ListModel){var AT=AU&&AU.get(this.props[AQ+"SourceField"]);if(AT){var AP=this.props[AQ+"SourceFieldValues"];if(typeof (AT)=="object"){for(var AS=0,AR=AP.length;AS<AR;AS++){if(AP[AS] in AT){return true;}}}else{for(var AS=0,AR=AP.length;AS<AR;AS++){if(AP[AS]==AT){return true;}}}}}else{return !AO&&AO.memo&&AO.memo.value&&AO.memo.value==this.props[AQ+"SourceFieldValues"];}}return false;};n.prototype._refreshCommandHandlers=function b(){var AQ=this.props.cmdArray;if(!AQ){AQ=this.props.cmdArray=this._initCommands(this.props.cmds);}if(this.props.enabledField!=undefined){return ;}if(!AQ||!AQ.length){return ;}var AO=false;var AR=true;for(var AS=0,AT=AQ.length;AS<AT;AS++){if(!AQ[AS].id){continue;}var AW=AQ[AS].id;var AP=AQ[AS].target;var AU=AQ[AS].targetPath?mstr.$path(AQ[AS].targetPath,this):this;if(AU!=AP){AP&&AP.detachEventListener&&AP.detachEventListener(this,"set_CommandEnabled"+AW);AU&&AU.attachEventListener&&AU.attachEventListener(this,"set_CommandEnabled"+AW,"updateCommandEnabled");AQ[AS].target=AP=(AU&&AU.execCommand)?AU:null;}var AV=AQ[AS].valuePath;AV=(AV&&!/^prompt\(/.test(AV))?mstr.controllers.Factory.resolveArgsString(AV,this):null;AQ[AS].enabled=((AP&&AP.queryCommandEnabled&&AP.queryCommandEnabled(AW,AV))||AW.substr(0,4)=="Set_"||false);if(!AO){AO=AQ[AS].enabled;}if(AR&&AQ[AS].required&&!AQ[AS].enabled){AR=false;}}this.set("enabled",AR&&AO);};n.prototype.updateCommandEnabled=function V(AW){var AQ=String(AW&&AW.name).substr(18);if(!AQ){return ;}var AP=this.props.cmdArray;var AT=mstr.$A.findByForm(AP,AQ,"id");if(AT>-1){var AV=AP[AT].valuePath;AV=AV?mstr.controllers.Factory.resolveArgsString(AV,this):null;var AO=!!(AW.src&&AW.src.queryCommandEnabled&&AW.src.queryCommandEnabled(AQ,AV));var AR=(!!AP[AT].enabled!=!!AO);if(AR){AP[AT].enabled=!!AO;var AU=!!AO;if(!AU){var AS=mstr.$A.findByForm(AP,"enabled",true);if(AS>-1){AU=true;}}this.set("enabled",AU);}}};n.prototype.execFireCommands=function u(AO){return this.fireCommands(null,AO);};n.prototype.fireCommands=function AN(AV,AU){var AP;if(AV){AP=this._initCommands(AV);}else{AP=this.props.cmdArray;}for(var AS=0,AO=mstr.$A.len(AP);AS<AO;AS++){var AT=false;var AR=AP[AS].target;if(!AR){AR=AP[AS].targetPath?mstr.$path(AP[AS].targetPath,this):this;}if(AR&&AR.execCommand){var AQ=AP[AS].valuePath;AQ=AQ?mstr.controllers.Factory.resolveArgsString(AQ,this):null;if(AQ==null){AQ=[AU];}AT=AR.execCommand.apply(AR,[AP[AS].id].concat(AQ));}if(!AT&&AP[AS].required){break;}}return true;};n.prototype._initCommands=function AA(AR){if(!AR){return ;}AR=(AR&&AR.split)?AR.split(";"):[AR];var AP=AR.length;if(AP){var AO=[];for(var AQ=0;AQ<AP;AQ++){var AS=(AR[AQ]&&AR[AQ].split)?AR[AQ].split("|"):[AR[AQ]];if(AS[0]){var AT=(String(AS[0]).charAt(0)=="!");if(AT){AS[0]=String(AS[0]).substr(1);}AO.push({id:AS[0],valuePath:AS[1],targetPath:AS[2],required:AT});}}return AO;}return null;};n.prototype.computeHandlerNameForEvent=function d(AO){if(AO.src==this.props.model){return"on_model_"+AO.name;}else{if(AO.src==this.props.document){return"on_win_"+AO.name;}else{return"on_"+AO.name;}}};n.prototype.searchHandlerByEventName=function o(AO){if(this._layoutHandlers&&this._layoutHandlers.info){for(var AP in this._layoutHandlers.info){if(this._layoutHandlers.info[AP].eventName==AO.name){return this._layoutHandlers.info[AP];}}}return null;};n.prototype.update=function AC(AO){if(AO){var AR=this.computeHandlerNameForEvent(AO);var AQ=this._layoutHandlers&&this._layoutHandlers.info&&this._layoutHandlers.info[AR];if(!AQ){AQ=this.searchHandlerByEventName(AO);if(AQ){AR=AQ.name;}}switch(AQ&&AQ.method){case"listadd":var AP={min:AO.memo.start,max:AO.memo.start+AO.memo.count-1};this._updateListPropIteratively(AR,AQ,[AP]);break;case"listremove":this._updateListPropIteratively(AR,AQ,AO.memo.ranges);break;case"hashadd":case"hashremove":this._updateHashPropIteratively(AR,AQ,AO.memo.at);break;default:return this.execLayoutHandler(AR);}}};n.prototype.updateAllProps=function U(){if(!this._layoutHandlers){return ;}var AY=this._layoutHandlers.sequence;var Aa=this._layoutHandlers.info;var Ab=this,AR=this.props.model,AQ=this.props.element;for(var AT=0,AX=mstr.$A.len(AY);AT<AX;AT++){var AS=AY[AT];var AW=Aa[AS];switch(AW&&AW.method){case"set":case"win":case null:case undefined:var AV=this._validateLayoutHandlerFunction(AW);if(AV){var AP=AV(Ab,AR,AQ,{init:true});if(AS&&!AS.match(/^on\_/)){this.props[AS]=AP;}}break;case"listadd":var AO=(AW.src=="model")?AR:Ab;if(AO){var AZ=(AO==Ab)?AO.props[AW.prop]:AO.get&&AO.get(AW.prop);var AX=mstr.$A.len(AZ);if(AX){var AU={min:0,max:AX-1};this._updateListPropIteratively(AS,AW,[AU]);}}break;case"hashadd":var AO=(AW.src=="model")?AR:Ab;if(AO){var Ac=(AO==Ab)?AO.props[AW.prop]:AO.get&&AO.get(AW.prop);this._updateHashPropIteratively(AS,AW,Ac);}break;}}};n.prototype.execLayoutHandler=function AF(AR,AP){var AO=this._layoutHandlers&&this._layoutHandlers.info&&this._layoutHandlers.info[AR];var AQ=this._validateLayoutHandlerFunction(AO);return AQ&&AQ(this,this.props.model,this.props[mstr.$W.ELEMENT],AP);};n.prototype._updateHashPropIteratively=function AD(AV,AQ,AU){var AT=this._validateLayoutHandlerFunction(AQ);if(!AT){return ;}var AP=this;var AO=this.props.model;var AS=this.props[mstr.$W.ELEMENT];for(var AR in AU){AT(AP,AO,AS,AR);}};n.prototype._updateListPropIteratively=function C(AS,AV,AO){var AU=this._validateLayoutHandlerFunction(AV);if(!AU){return ;}var AZ=this;var AQ=this.props.model;var AP=this.props[mstr.$W.ELEMENT];for(var AT=0,AX=mstr.$A.len(AO);AT<AX;AT++){var AR=AO[AT].min;var AY=AO[AT].max;for(var AW=AR;AW<=AY;AW++){AU(AZ,AQ,AP,AW);}}};n.prototype.raiseEvent=function c(AS,AR,AQ){if(AS){var AP=new mstr.lang.CustomEvent(this,AS,AR);if(this["before_"+AS]){this["before_"+AS](AP);}this.update(AP);if(this["after_"+AS]){this["after_"+AS](AP);}this.notifyListeners(AP);if(AQ){var AO=this.get("parent")&&this.get("parent").raiseEvent&&this.get("parent").raiseEvent(AS,AR,AQ);}}};n.prototype._validateLayoutHandlerFunction=function y(AO){if(AO){if(!AO.func&&AO.str){AO.func=new Function("view, model, rootTag, context",AO.str);AO.str=null;}return AO.func;}return null;};n.prototype.execHide=function A(){this.set("visible",false);return true;};n.prototype.execShow=function AM(){this.set("visible",true);return true;};n.prototype.execHideChild=function t(AO){if(AO){mstr.controllers.Factory.setPath(AO+"/visible",this,false,false);}};n.prototype.execShowChild=function l(AO){return this._showChildViewAtPath(AO);};n.prototype._showChildViewAtPath=function Q(AQ){var AR=mstr.controllers.Factory.getPath(AQ,this);if(AR){mstr.controllers.Factory.safeset(AR,"visible",true);if((this.props.renderStatus==mstr.Enum.Widget.RENDERSTATUS.RENDEREDCHILDREN)&&(!AR.getId||(AR.props.renderStatus==mstr.Enum.Widget.RENDERSTATUS.NOT_STARTED))){var AP=this.props.unrenderedChildViewPaths&&this.props.unrenderedChildViewPaths[AQ];if(AP&&AP.id!=null){this.renderChildAt(AQ,AP.id);AR=mstr.controllers.Factory.getPath(AQ,this);var AO=AR&&AR.props.model;if(AO){AO.execCommand&&AO.execCommand("FetchData");}}}}};n.prototype.execOpenPopup=function J(AQ){self.supressWaitPage=true;try{if(AQ){if(typeof (AQ)=="string"){AQ={popup:mstr.$obj(AQ)};}else{if(AQ.popup==null){AQ={popup:AQ};}}}var AP=AQ&&AQ.popup;if(!AP&&this.props.popupId){AP=mstr.$obj(this.props.popupId);}var AO=!AP||!AP.getId;if(AO){AP=this.props.popup;}if(!AP){return ;}var AS=this.props.currentPopUp;if(AS){this.execClosePopup();}var AR=AP&&AP.props&&AP.props.opener;if(AR){AR.execClosePopup();}if(!AP.getId){if(AO){AP[mstr.$W.PARENT]=this;}AP=mstr.controllers.Factory.registerJSON(AP,this.props.document);AP&&AP.init&&AP.init();if(AO){this.props.popup=AP;AP&&this._childViewsInstantiated.push(AP);}}this.props.currentPopUp=AP;if(!AP){return ;}AP.attachEventListener(this,"Pop","onPop");if(AQ&&AQ.x!=null){AP.set("x",AQ.x);}if(AQ&&AQ.y!=null){AP.set("y",AQ.y);}AP.execCommand("Pop",this);}finally{window.setTimeout("self.supressWaitPage = false;",10);}};n.prototype.onPop=function h(AO){var AQ=this.props.currentPopUp;if(AQ!=(AO&&AO.src)){return ;}this.set("opened",true);AQ.detachEventListener(this,"Pop");AQ.attachEventListener(this,"Unpop","onUnpop");self.setTimeout("mstr.controllers.EventManager.attachWindowEventListener(mstr.$obj('"+this.props.id+"'),'mousedown','onMouseEvent')",1);var AR=this.getAncestorByProperty("isScrollProvider");if(AR){if(AQ.props.element.offsetParent!=AR.props.element){AR.attachEventListener(this,"sync_scroll","onSyncScroll");AR.props._initialScrollTop=AR.props.element.scrollTop;AQ.props._scrollProvider=AR;if(mstr.utils.ISWK){var AS=document.documentElement,AP=AS.style.overflow;AS.style.overflow="hidden";window.setTimeout(function(){AS.style.overflow=AP;},0);}}}};n.prototype.onSyncScroll=function g(AP){var AO=this.props.currentPopUp;if(AO){if(this._scTimer){window.clearTimeout(this._scTimer);}var AQ=this.props.element;this._scTimer=window.setTimeout(function(){var AW=AO.props,AY=AW&&AW._scrollProvider;if(AY){var AR=AY.props,AZ=AR.element,Ad=AZ.scrollTop,Aa=Ad-AR._initialScrollTop;var AT=AW.element;if(AT){AT.style.top=parseInt(AT.style.top)-Aa+"px";AR._initialScrollTop=AZ.scrollTop;var Ab=mstr.utils.BoxModel.position(AZ),AV=Ab.top+Ab.height,AX=mstr.utils.BoxModel.position(AQ),Ac=AX.top+AX.height;AT.style.display=Ac>=AV?"none":"";if(mstr.utils.ISWK){var AS=document.documentElement,AU=mstr.utils.CSS.getStyleValue(AS,"overflow");AS.style.overflow="hidden";window.setTimeout(function(){AS.style.overflow=AU;},100);}}}},100);}};n.prototype.onUnpop=function S(AO){var AP=this.props.currentPopUp;if(AP!=(AO&&AO.src)){return ;}this.set("opened",false);AP.detachEventListener(this,"Unpop");mstr.controllers.EventManager.detachWindowEventListener(this,"mousedown");mstr.controllers.EventManager.detachWindowEventListener(this,"mouseup");this.props.currentPopUp=null;};n.prototype.onMouseEvent=function F(AQ){var AR=this.props.currentPopUp;if(!AR){return ;}var AS=AQ&&AQ.target();if(!mstr.utils.Dom.containsElement(AR.props.element,AS,true)&&(!mstr.utils.Dom.containsElement(this.props.element,AS,true)||this.props.popupPolicy=="toggle")){var AO=AS&&AS.mstrViewId,AP=AO&&mstr.$obj(AO);if(!AR.isAncestorOf(AP)){this.execClosePopup();}}};n.prototype.isAncestorOf=function(AO){var AP=AO;while(AP){AP=AP&&AP.props&&AP.props.parent;if(AP==this){return true;}}return false;};n.prototype.execClosePopup=function q(){var AO=this.props.currentPopUp;if(AO){AO.execCommand("Unpop");}};n.prototype.execPop=function N(AR){if(!AR){return ;}this.props.opener=AR;this.set("visible",false);if(!this.props.element){var AT=AR.props.document||document;this.props.element=AT.createElement("span");}var AQ=this.props.element;var AS=AR.props.element;if(AS&&AS.parentNode){if(AQ.parentNode){AQ.parentNode.removeChild(AQ);}var AP=AS.nextSibling;if(AP){AS.parentNode.insertBefore(AQ,AP);}else{AS.parentNode.appendChild(AQ);}}var AO=mstr.$path(this.props.modelPath,this);if(AO!=this.getModel()){this.setModel(AO);}this.render();this._positionPop();this.set("visible",true);this.raiseEvent("Pop");};n.prototype._positionPop=function T(){this._prePositionPop();var AS=this._computeNewClientCoords();var AU=mstr.utils.BoxModel,AQ=this._getMySize(),AT=(this.props.popOrientation!=mstr.Enum.Widget.POPORIENTATION.VERTICAL);if(AT||this.props.nudge){AS.width=AQ.width;AS.height=AQ.height;AS=AU.fitRectWithinRect(AS,AU.getBrowserWindowRect(this.props.element.ownerDocument));}var AP=this.props.element.offsetParent,AO=0,AR=0;if(AP){AO=+AP.scrollLeft;AR=+AP.scrollTop;}AU.setClientCoords(this.props.element,AS.left+AO,AS.top+AR);this._postPositionPop(AQ.width,AQ.height);};n.prototype._prePositionPop=function s(){var AP=this.props.element,AO=AP&&AP.style;if(!AO){return ;}AP.className=AP.className.replace(/ mstrAsPopup/,"")+" mstrAsPopup";AO.visibility="hidden";AO.position="absolute";AO.zIndex=999;AO.display=(AP.tagName&&AP.tagName.toLowerCase()=="table"&&mstr.utils.ISW3C)?"table":"block";};n.prototype._postPositionPop=function R(AS,AO){var AR=this.props.element,AQ=AR&&AR.style;if(!AQ){return ;}AQ.display="none";AQ.visibility="visible";if(mstr.utils.ISIE6){var AP=microstrategy.getPopupMask(AR),AT=AP&&AP.style;if(AT){AP.className="popupMask_"+AR.id;AT.left=AQ.left;AT.top=AQ.top;AT.width=AS+"px";AT.height=AO+"px";AT.zIndex=AQ.zIndex-1;}}};n.prototype._getMySize=function r(){var AR=this.props,AO=AR.width,AQ=AR.height,AP=AR.element,AS=mstr.utils.BoxModel;if(AO&&AO.match(/px$/)){AO=parseInt(AO);}else{AO=AS.getElementOuterWidth(AP)||AS.getElementOuterWidth(AP.firstChild);}if(AQ&&AQ.match(/px$/)){AQ=parseInt(AQ);}else{AQ=AS.getElementOuterHeight(AP)||AS.getElementOuterHeight(AP.firstChild);}return{width:AO,height:AQ};};n.prototype._computeNewClientCoords=function z(){return(this.props.popOrientation==mstr.Enum.Widget.POPORIENTATION.VERTICAL)?this._computeNewClientCoordsAsDropdown():this._computeNewClientCoordsAsCtxtMenu();};n.prototype._computeNewClientCoordsAsDropdown=function K(){var AP=this._getOpenerArea();var AO=mstr.utils.BoxModel.getClientCoords(AP);AO.top+=AP.offsetHeight;return AO;};n.prototype._computeNewClientCoordsAsCtxtMenu=function e(){if(!isNaN(parseInt(this.props.x))&&!isNaN(parseInt(this.props.y))){var AO=this.props.element,AP=AO&&AO.ownerDocument,AQ=AP&&AP.documentElement;return{left:parseInt(this.props.x)-(AQ&&AQ.scrollLeft||0),top:parseInt(this.props.y)-(AQ&&AQ.scrollTop||0)};}else{return mstr.utils.BoxModel.getClientCoords(this._getOpenerArea());}};n.prototype._getOpenerArea=function M(){var AO=this.get("opener"),AP=AO&&(AO.execLayoutHandler("openerArea")||AO.get("element"));return AP;};n.prototype.execUnpop=function E(){if(mstr.utils.ISIE4){microstrategy.releasePopupMask(this.props.element);}this.set("visible",false);this.props.opener=null;this.raiseEvent("Unpop");};n.prototype.execConfirm=function D(AO){if(!AO){return false;}return window.confirm(AO);};n.prototype.prompt=function AK(AP,AO){if(!AP){return null;}return window.prompt(AP,(AO?AO:""));};n.prototype.init=function a(){this.initLayoutXML();this.initModel();this.initValidator();};function n(AO){this.props=mstr.utils.Hash.applydefault(AO,this.DEFAULTS);this._childViewsInstantiated=[];}return n;})();mstr.views.Editor=(function(){mstr.$O.extendsClass(B,mstr.views.BaseView);B.prototype.execApply=function A(E){this.raiseEvent("apply",{value:E});};B.prototype.execSave=function D(E){this.raiseEvent("save",{value:E});};B.prototype.queryEnabledApply=function C(){return true;};B.prototype.queryEnabledApply=function C(){return false;};function B(E){mstr.views.BaseView.apply(this,[E]);}return B;})();mstr.views.TextInput=(function(){mstr.$O.extendsClass(B,mstr.views.BaseView);B.prototype.shouldWriteBack=function A(F){F=String(F).toLowerCase();var E=mstr.Enum.Widget.AUTOWRITEBACK;switch(parseInt(this.props.autoWriteBack)){case E.ONKEYPRESS:return !!F.match(/keypress|keydown|blur/i);case E.ONBLUR:return !!F.match(/blur/i);case E.OFF:return false;}return !!F.match(/keypress|keydown|blur/i);};B.prototype.getAutoValidate=function C(){var G=mstr.Enum.Widget.AUTOVALIDATE,F=parseInt(this.props.autoValidate);if(isNaN(F)){F=G.USEDEFAULT;}if(F==G.USEDEFAULT){var E=mstr.Enum.Prompts.VALIDATIONLEVEL;switch(mstr.Settings.Prompts.VALIDATIONLEVEL){case E.AFTERANSWEREACH:F=G.ONBLUR;break;case E.INMIDANSWEREACH:F=G.ONKEYPRESS;break;case E.OFF:case E.ATRUNREPORT:default:F=G.OFF;break;}}return F;};B.prototype.getAutoFormat=function D(){var G=mstr.Enum.Widget.AUTOFORMAT,F=parseInt(this.props.autoFormat);if(isNaN(F)){F=G.USEDEFAULT;}if(F==G.USEDEFAULT){var E=mstr.Enum.Prompts.AUTOFORMATLEVEL;switch(mstr.Settings.Prompts.AUTOFORMATLEVEL){case E.AFTERANSWEREACH:F=G.ONBLUR;break;case E.INMIDANSWEREACH:F=G.ONKEYPRESS;break;case E.OFF:case E.BEFORERUNREPORT:case E.AFTERRUNREPORT:default:F=G.OFF;break;}}return F;};function B(E){mstr.views.BaseView.apply(this,[E]);}return B;})();mstr.views.ViewListBase=(function(){mstr.$O.extendsClass(B,mstr.views.BaseView);B.prototype._attachLayoutHandlers=function C(){mstr.views.BaseView.prototype._attachLayoutHandlers.apply(this);var F=this.props.model;if(F&&F.attachEventListener){F.attachEventListener(this,"hashadd_selectedIndices","onAddSelections");F.attachEventListener(this,"hashremove_selectedIndices","onRemoveSelections");}};B.prototype._detachLayoutHandlers=function D(){mstr.views.BaseView.prototype._detachLayoutHandlers.apply(this);var F=this.props.model;if(F&&F.attachEventListener){F.detachEventListener(this,"hashadd_selectedIndices");F.detachEventListener(this,"hashremove_selectedIndices");}};B.prototype.initChildModelPaths=function E(){var G=this.props.views;var J="parent/model/items/";for(var H=0,F=mstr.$A.len(G);H<F;H++){var I=G[H];if(!I||((I.props&&I.props.modelPath)||(I.modelPath))){continue;}if(I.props){I.props.modelPath=J+H;}else{I.modelPath=J+H;}}};B.prototype.init=function A(){this.initChildModelPaths();mstr.views.BaseView.prototype.init.apply(this);};function B(F){mstr.views.BaseView.apply(this,[F]);}return B;})();mstr.views.ViewBook=(function(){mstr.$O.extendsClass(D,mstr.views.ViewListBase);D.prototype.init=function E(){mstr.views.ViewListBase.prototype.init.apply(this);var F=this.getModel();F.attachEventListener(this,"listadd_items","reRender");F.attachEventListener(this,"listremove_items","reRender");};D.prototype.reRender=function C(){if(this.props.renderStatus!=mstr.Enum.Widget.RENDERSTATUS.NOT_STARTED){this.render();}};D.prototype.render=function B(){this._initChildViewList();mstr.views.ViewListBase.prototype.render.apply(this);};D.prototype._initChildViewList=function A(){var H="parent/model/items/";var N=this.props.views=[];var J=this.props.childViewTypes||this.props.parent.props.childViewTypes;var M=this.props.document,F=this.props.model,K=F&&F.getItems(),Q,L,O;for(var G=0,I=mstr.$A.len(K);G<I;G++){Q=K[G];L=(Q&&Q.get&&Q.get("type"))||"default";O=J&&(J[L]||J["default"]);if(!O){continue;}O=mstr.utils.Hash.deepClone(O);O.parent=this;O.modelPath=H+G;N[G]=mstr.controllers.Factory.registerJSON(O,M);if(N[G]&&N[G].init){N[G].init();}}};function D(F){mstr.views.ViewListBase.apply(this,[F]);}return D;})();mstr.views.ViewStack=(function(){mstr.$O.extendsClass(F,mstr.views.ViewListBase);F.prototype.setModel=function I(L){mstr.views.ViewListBase.prototype.setModel.apply(this,[L]);if(L){L.set("stack",true);}};F.prototype.onAddSelections=function K(L){var N=L&&L.memo&&L.memo.at;var M=parseInt(mstr.$H.firstKey(N));this._showChildViewAtIndex(M);this._updateNavCommands();};F.prototype._updateNavCommands=function E(){var M;var L=this.props.model;if(L){M=L.getSelectedIndex();}if(M==null){M=-1;}this.set("CommandEnabledPreviousView",M>0);this.set("CommandEnabledNextView",M<(mstr.$A.len(this.props.views)-1));};F.prototype.onRemoveSelections=function A(L){var N=L&&L.memo&&L.memo.at;var M=parseInt(mstr.$H.firstKey(N));if(M>-1){var O=this.props.views&&this.props.views[M];mstr.controllers.Factory.safeset(O,"visible",false);}};F.prototype.render=function J(){var N=this.props.views,M=mstr.$A.len(N),Q;for(var P=0;P<M;P++){mstr.controllers.Factory.safeset(N[P],"visible",false);mstr.controllers.Factory.safeset(N[P],"renderStatus",mstr.Enum.Widget.RENDERSTATUS.NOT_STARTED);}mstr.views.BaseView.prototype.render.apply(this);var L=this.getModel();var O=L&&L.getSelectedIndex();this._showChildViewAtIndex(O);mstr.timers.renderStop=new Date();mstr.timers.render=mstr.timers.renderStop-mstr.timers.renderStart;};F.prototype.renderNextChildViewOld=function B(){var O=this.props.childViewPaths;if(O){var N=this.props.stackInfo={};var M;for(var L=O.length-1;L>-1;L--){M=O[L];if(M.name&&M.name.substring(0,6)=="views/"){N[M.name]=M;O.splice(L,1);}}}this.renderNextChildView=mstr.views.BaseView.prototype.renderNextChildView;this.renderNextChildView();};F.prototype.execPreviousView=function D(){var L=this.props.model;if(L){var M=L.getSelectedIndex();if(M>0){return this.execGotoView(M-1);}}return false;};F.prototype.execNextView=function G(){var L=this.props.model;if(L){var M=L.getSelectedIndex();if(M>-1){return this.execGotoView(M+1);}}return false;};F.prototype.execGotoView=function H(M){var L=this.props.model;if(L){if((M>-1)&&(M<mstr.$A.len(this.props.views))){return L.execCommand("SingleSelect",M);}}return false;};F.prototype._showChildViewAtIndex=function C(L){L=parseInt(L);if(L!=null&&L>-1){this._showChildViewAtPath("views/"+L);}};function F(L){mstr.views.ViewListBase.apply(this,[L]);this._updateNavCommands();}return F;})();mstr.views.Pulldown=(function(){mstr.$O.extendsClass(C,mstr.views.BaseView);C.prototype.render=function H(){mstr.views.BaseView.prototype.render.apply(this);if(!this.get("horizontalCaption")){var I=this.get("element");var J=I.getElementsByTagName("td");if(J.length>0){J[0].style.display="none";}}this.renderSelections();};C.prototype._attachLayoutHandlers=function G(){mstr.views.BaseView.prototype._attachLayoutHandlers.apply(this);var I=this.props.model;if(I&&I.attachEventListener){I.attachEventListener(this,"set_icon","set_buttonClass");I.attachEventListener(this,"set_showPressed","set_pressed");var J=this._getPropNameForSelections();if(J){I.attachEventListener(this,"hashadd_"+J,"renderSelections");I.attachEventListener(this,"hashremove_"+J,"renderSelections");}}};C.prototype.set_buttonClass=function A(I){this.set("buttonClass",I.memo.value);};C.prototype.set_pressed=function D(I){this.set("pressed",I.memo.value);};C.prototype._detachLayoutHandlers=function B(){mstr.views.BaseView.prototype._detachLayoutHandlers.apply(this);var I=this.props.model;if(I&&I.attachEventListener){var J=this._getPropNameForSelections();if(J){I.detachEventListener(this,"hashadd_"+J);I.detachEventListener(this,"hashremove_"+J);}}};C.prototype._getPropNameForSelections=function E(){var I=this.props.modelClass;if(/TreeModel/.test(I)){return"selections";}else{if(/ListModel/.test(I)){return"selectedIndices";}}return null;};C.prototype.renderSelections=function F(){var L=mstr.utils.ListViewHelper.getItemRenderer(this);if(!L){return ;}var I=this.props.model;var K=(this.props.popup&&(this.props.popup.singleFilterCssClass||this.props.popup.props&&this.props.popup.props.singleFilterCssClass))?(I&&I.getViewableSelectedItems&&I.getViewableSelectedItems()):(I&&I.getSelectedItems());var M=(this.props.showSingleItemListAsLabel&&(K&&mstr.$A.len(K)==1));var J;switch(mstr.$A.len(K)){case 1:J="renderListItem";break;case 0:J="renderEmpty";break;default:J="renderMultipleItems";break;}if(L[J]){L[J](this,I,this.props.element,{item:K&&K[0],items:K,showAsLabel:M});}};function C(I){mstr.views.BaseView.apply(this,[I]);}return C;})();mstr.views.FieldSet=(function(){mstr.$O.extendsClass(B,mstr.views.BaseView);B.prototype.onlegendFieldValueChange=function C(F){var G=this.get("element"),E=G.firstChild;if(F.memo.value){E.innerHTML=F.memo.value;}};B.prototype._attachLayoutHandlers=function D(){mstr.views.BaseView.prototype._attachLayoutHandlers.apply(this);mstr.views.BaseView.prototype._attachPropertiesHandlers.call(this,["legend"]);};B.prototype._detachLayoutHandlers=function A(){mstr.views.BaseView.prototype._detachLayoutHandlers.apply(this);mstr.views.BaseView.prototype._detachPropertiesHandlers.call(this,["legend"]);};function B(E){mstr.views.BaseView.apply(this,[E]);}return B;})();mstr.views.ListView=(function(){mstr.$O.extendsClass(N,mstr.views.BaseView);N.prototype.render=function B(){mstr.views.BaseView.prototype.render.apply(this);var S=this.getModel();var R=mstr.$A.len(S&&S.getItems&&S.getItems());if(R){this.renderItemsAt(0,R);}this._updateEmptyMessage();mstr.timers.renderStop=new Date();mstr.timers.render=mstr.timers.renderStop-mstr.timers.renderStart;};N.prototype._updateEmptyMessage=function J(){var S=this.props.model,R=mstr.$A.len(S&&S.getItems&&S.getItems()),U=mstr.$A.len(S&&S.props&&S.props.prefixItems),W=this.props.descriptors,V=W&&W.searchRequiredText,T=W&&W.emptyText,X=S&&S.isElementSearchRequired&&S.isElementSearchRequired()&&!S.get("searchPattern");if(R>U||(!X&&R)){this._clearEmptyMessage();}else{msg=(X)?V:T;this.set("message",msg);}};N.prototype._clearEmptyMessage=function G(){var U=this.get("message"),T=this.props.descriptors,R=T&&T.emptyText,S=T&&T.searchRequiredText;switch(U){case R:case S:this.set("message",null);break;}};N.prototype.renderItemsAt=function P(R,Y){var d=mstr.utils.ListViewHelper.getItemRenderer(this);if(!d||!d.renderListItem){return null;}var g=this,S=this.getId(),V=this.props.model;var Z=V&&V.getItems();var T=(V&&V.getSelectedIndices())||{};var a=Math.min(R+Y,mstr.$A.len(Z));var W=this.props[mstr.$W.ELEMENT];var b=V&&V.get("valueForm"),e;for(var X=R;X<a;X++){var h=Z[X];var c=mstr.utils.ListViewHelper.getItemBrowseCommand(this,h)||"";var U=d.renderListItem(g,V,W,{at:X,item:h,browseCommand:c});if(U){if(T[X]){d.markListItemAsSelected(g,V,W,{at:X,item:h,elItem:U});}if(!("enabled" in h)||h.enabled){e=h[b];if(e==null&&h.get){e=h.get(b);}U.mstrListItemInfo=S+"/"+(e||"")+"/"+c;}}}};N.prototype._attachLayoutHandlers=function Q(){mstr.views.BaseView.prototype._attachLayoutHandlers.apply(this);var R=this.props.model;if(R&&R.attachEventListener){R.attachEventListener(this,"listadd_items","onAddListItems");R.attachEventListener(this,"listremove_items","onRemoveListItems");R.attachEventListener(this,"hashadd_selectedIndices","onAddSelectedIndices");R.attachEventListener(this,"hashremove_selectedIndices","onRemoveSelectedIndices");}};N.prototype._detachLayoutHandlers=function L(){mstr.views.BaseView.prototype._detachLayoutHandlers.apply(this);var R=this.props.model;if(R&&R.attachEventListener){R.detachEventListener(this,"listadd_items");R.detachEventListener(this,"listremove_items");R.detachEventListener(this,"hashadd_selectedIndices");R.detachEventListener(this,"hashremove_selectedIndices");}};N.prototype.onAddListItems=function K(R){var T=R.memo.start;var S=R.memo.count;if(!S||(T==null)){return ;}this._updateEmptyMessage();this.renderItemsAt(T,S);};N.prototype.onRemoveListItems=function I(Z){var X=mstr.utils.ListViewHelper.getItemRenderer(this);if(!X||!X.removeListItem){return ;}var R=Z.memo.ranges;var Y=this,S=this.props.model,W=this.props[mstr.$W.ELEMENT];for(var U=mstr.$A.len(R)-1;U>-1;U--){var V=R[U];for(var T=V.max;T>=V.min;T--){X.removeListItem(Y,S,W,{at:T});}}this._updateEmptyMessage();};N.prototype.onAddSelectedIndices=function F(R){this._toggleSelectedIndices(R.memo.at,"markListItemAsSelected");};N.prototype.onRemoveSelectedIndices=function A(R){this._toggleSelectedIndices(R.memo.at,"markListItemAsUnselected");};N.prototype._toggleSelectedIndices=function O(Y,V){if(!Y){return ;}var S=mstr.utils.ListViewHelper.getItemRenderer(this);if(!S||!S[V]){return ;}var U=this,R=this.props.model,X=this.props[mstr.$W.ELEMENT];var T=R&&R.getItems();for(var W in Y){W=parseInt(W);S[V](U,R,X,{at:W,item:T[W]});}};N.prototype.execClickListItem=function E(V){var S=this.props.model;if(!S){return false;}var U=!!this.props.multiSelect;var T=S.indexOfValue(V.valueForm);if(T>-1){var R=null;if(this.props.isCheckList){if(U){R="ToggleSelect";}else{R="SingleSelect";}}else{if(V.ctrl&&U){R="ToggleSelect";}else{if(V.shift&&U){R="RangeSelect";}else{if(V.rmc&&U){R="RMCSelect";}else{R="SingleSelect";}}}}if(this.get("validator")){this.get("validator").validate(R,T);}S.execCommand(R,T);if(R==="SingleSelect"){S.set("preSelectedItems",[]);}return true;}else{if(U&&!this.props.isCheckList){S.execCommand("ClearSelect");}return false;}};N.prototype.onkeypress=function D(X,T){if(this.get("ignoreKeyStrokes")){return false;}var W=1;if(this._timerID){window.clearTimeout(this._timerID);this._timerID=null;W=0;}var S=this.getModel();if(!S){return true;}var U=mstr.utils.Events.keyChar(X,T),R=(U==String.fromCharCode(9));if(mstr.Enum.REGEXP_RESERVED_CHARS[U]){U="\\"+U;}this._selKeys+=U;S.execCommand("SelectString",this._selKeys,"n",W);var V=this;this._timerID=window.setTimeout(function(){V._selKeys="";V._timerID=null;},this._keyDelay);if(!R){mstr.utils.Events.cancel(X,T);}return R;};N.prototype.onkeydown=function H(V,S){if(this.get("ignoreKeyStrokes")){return true;}var R=this.getModel();if(!R){return true;}var U=mstr.utils.Events.keyCode(V,S),T=mstr.utils.Events.shiftKey(V,S);switch(U){case 38:this.getModel().execCommand("SelectPrevious",T);mstr.utils.Events.cancel(V,S);return false;case 40:this.getModel().execCommand("SelectNext",T);mstr.utils.Events.cancel(V,S);return false;default:return true;}};N.prototype.focus=function C(){if(!mstr.utils.ISIE4){document.getElementById(this.get("id")+"TabStop").focus();}};N.prototype.restoreFocus=function M(){if(!mstr.utils.ISIE4){document.getElementById(this.get("id")+"TabStop").focus();}else{this.props.scrollArea.focus();}};function N(R){mstr.views.BaseView.apply(this,[R]);this._selKeys="";this._timerID=null;this._keyDelay=1000;}return N;})();mstr.itemrenderers.ListView=(function(){var G={};G.renderListItem=function(H,J,L,K){var I=mstr.itemrenderers.FastListView.renderListItem(H,J,L,K);this._insertElementForIndex(H,L,K.at,I);return I;};G.markListItemAsSelected=function A(H,I,K,J){J.elItem=this._findElementForIndex(H,K,J.at);mstr.itemrenderers.FastListView.markListItemAsSelected(H,I,K,J);};G.markListItemAsUnselected=function E(H,I,K,J){J.elItem=this._findElementForIndex(H,K,J.at);mstr.itemrenderers.FastListView.markListItemAsUnselected(H,I,K,J);};G.removeListItem=function F(H,J,M,K){var I=this._findElementForIndex(H,M,K.at);var L=I&&I.parentNode;if(L){L.removeChild(I);}};G._insertElementForIndex=function B(H,M,J,K){var L=H.props.scrollArea.firstChild;var I=L.childNodes[J];if(I){L.insertBefore(K,I);}else{L.appendChild(K);}};G.on_set_leadIndex=function D(I,J,M){var L=J&&J.get("leadIndex");if(L==null||L<0){return false;}var K=this._findElementForIndex(I,M,L);if(!K){return false;}var H=I.get("scrollArea")||M.rows[0].cells[0].firstChild.childNodes[2];if(!H){return false;}mstr.utils.BoxModel.scrollToElement(H,K);};G._findElementForIndex=function C(H,J,I){return H.props.scrollArea.firstChild.childNodes[I];};return G;})();mstr.views.TextBox=(function(){mstr.$O.extendsClass(A,mstr.views.BaseView);A.prototype.execClearSearch=function B(){var C=this.props.element.getElementsByTagName("input");if(C&&C[0].value!=""){C[0].value="";}this.fireCommands(null,"");};function A(C){mstr.views.BaseView.apply(this,[C]);}return A;})();mstr.views.FastListView=(function(){mstr.$O.extendsClass(Q,mstr.views.ListView);Q.DEFAULT_LIST_ITEM_HEIGHT=20;Q.prototype.init=function U(){mstr.views.ListView.prototype.init.apply(this,arguments);this.set("baseHeight",this.get("height"));};Q.prototype._positionPop=function T(){var g=this.props.element;var e=g&&g.style;if(!e){return ;}e.position=mstr.utils.ISFF?"fixed":"absolute";e.display="block";var d=this.props.scrollArea;d.style.height="auto";var c=mstr.utils.BoxModel.getElementOuterHeight(g);if(mstr.utils.ISIE4&&mstr.utils.BoxModel.hasScrollbar(d,"x")){c+=SCROLLBAR_SIZE;}var b=this.get("baseHeight");if(b!="auto"){c=Math.min(c,parseInt(b))+"px";}else{c=b;}d.style.height=c;this.props.height=c;mstr.views.BaseView.prototype._positionPop.apply(this);};Q.prototype.render=function I(){mstr.views.BaseView.prototype.render.apply(this);var b=this.execLayoutHandler("scrollArea");this.props.scrollArea=b;if(b&&this.props.renderListItemsOnScroll){b.onscroll=new Function("e","return mstr.controllers.Factory.obj('"+this.getId()+"').onScroll()");}this.props.listItemsContainer=b&&b.childNodes[0];this._updateItemsContainerDimensions();this.initItems();mstr.timers.renderStop=new Date();mstr.timers.render=mstr.timers.renderStop-mstr.timers.renderStart;};Q.prototype.initItems=function H(){var d=this.getModel();var c=mstr.$A.len(d&&d.getItems&&d.getItems());var e=d&&d.props&&d.props.prefixItems&&d.props.prefixItems.length||0;this._updateEmptyMessage();this.props.isListItemRendered=[];if(!c){return ;}var h=this.props.renderListItemsOnScroll&&this.props.scrollArea;if(!h){this.renderItemsAt(0,c);}else{this._addIndicesToRender(0,g);var g=parseInt(this.props.initialListItemRenderCount)||0;g&&this.renderItemsAt(0,g);}var b=mstr.utils.ListViewHelper.getItemRenderer(this);if(b&&b.on_set_leadIndex){b.on_set_leadIndex(this,this.getModel(),this.props.element);}if(h){this.onScroll();}};Q.prototype.renderItemsAt=function W(d,e){var c=mstr.utils.ListViewHelper.getItemRenderer(this);if(!c){return null;}var u=this.props.listItemsContainer;if(!u){return null;}var t=this._countIndicesRenderedBefore(d);var h=u.childNodes[t];var o=this.props.model;var n=o&&o.getItems();var q=Math.min(d+e,mstr.$A.len(n));var k={};var r=this.props.isListItemRendered;var g=(o&&o.getSelectedIndices())||{};var l=this;var z=this.getId();var o=this.props.model;var b=this.props[mstr.$W.ELEMENT];var s=o&&o.get("valueForm");for(var w=d;w<q;w++){var x=n[w];var y=mstr.utils.ListViewHelper.getItemBrowseCommand(this,x)||"";var b=c.renderListItem(l,o,b,{at:w,item:x,browseCommand:y});if(h){u.insertBefore(b,h);}else{u.appendChild(b);}if(g[w]){c.markListItemAsSelected(l,o,b,{at:w,item:x,elItem:b,notFocus:true});}if(!("enabled" in x)||x.enabled){b.mstrListItemInfo=z+"/"+(x[s]||"")+"/"+y;}r[w]=true;if(w==d){k.first=b;}if(w==q-1){k.last=b;}}return k;};Q.prototype.onAddListItems=function F(b){var e=b.memo.start;var d=b.memo.count;if(!d||(e==null)){return ;}this._updateEmptyMessage();this._updateItemsContainerDimensions();this._addIndicesToRender(e,d);var c=this.findNextRenderedIndex(e+d,false);if(c>-1){this._adjustWhiteSpaceAboveItem(c,this._getElementForItemAt(c));}this.updateScrollArea();};Q.prototype.onRemoveListItems=function D(m){this._updateItemsContainerDimensions();var h=[];mstr.$A.forEach(m.memo.ranges,function(o){h.push(mstr.$H.clone(o));});var b=this._splitRangesByRenderStatus(h);var n=this.props.isListItemRendered;var d=this.props.listItemsContainer;for(var g=mstr.$A.len(b)-1;g>-1;g--){var k=b[g];if(n[k.min]){var c=this._getElementForItemAt(k.min);for(var e=0;e<k.max-k.min;e++){d.removeChild(c.nextSibling);}d.removeChild(c);}this._removeIndicesToRender(k.min,k.max-k.min+1);var l=this.findNextRenderedIndex(k.max+1,false);if(l>-1){this._adjustWhiteSpaceAboveItem(l,this._getElementForItemAt(l));}}this.updateScrollArea();this._updateEmptyMessage();};Q.prototype._toggleSelectedIndices=function G(n,h){if(!n){return ;}var k=mstr.utils.ListViewHelper.getItemRenderer(this);if(!k){return ;}var l=this,c=this.props.model,d=this.props[mstr.$W.ELEMENT];var g=c&&c.getItems();for(var e in n){e=parseInt(e);var b=this._getElementForItemAt(e);if(b){k[h](l,c,d,{at:e,item:g[e],elItem:b});}}};Q.prototype._updateItemsContainerDimensions=function K(){this._updateItemsContainerHeight();};Q.prototype._updateItemsContainerHeight=function N(){var e=this.props.listItemsContainer;if(!e){return ;}var c=this.props.height;if(!c||c=="auto"){return ;}var g=mstr.utils.ListViewHelper.getItemRenderer(this);var d=g&&((g.listItemHeight&&g.listItemHeight(this))||(g.listItemHeightMin&&g.listItemHeightMin(this)));if(!d){d=Q.DEFAULT_LIST_ITEM_HEIGHT;}if(d){var b=this.getModel();d=d*mstr.$A.len(b&&b.getItems&&b.getItems());}if(d){e.style.height=d+"px";}else{e.style.height=mstr.utils.ISIE4?"1px":"auto";}if(mstr.utils.ISIE4){e.style.overflow=d?"visible":"hidden";}};Q.prototype._addIndicesToRender=function A(c,b){this.props.isListItemRendered=mstr.$A.insert(this.props.isListItemRendered,new Array(b),c);};Q.prototype._removeIndicesToRender=function E(c,b){this.props.isListItemRendered=mstr.$A.removeRange(this.props.isListItemRendered,c,b);};Q.prototype._countIndicesRenderedBefore=function P(b){var d=0;var e=this.props.isListItemRendered;for(var c=0;c<b;c++){if(e[c]){d++;}}return d;};Q.prototype._getElementForItemAt=function S(b){if(this.props.isListItemRendered[b]){var c=this._countIndicesRenderedBefore(b);return this.props.listItemsContainer.childNodes[c];}return null;};Q.prototype._getOrMakeElementForItemAt=function M(d){var g=this._getElementForItemAt(d);if(!g){var b=this.getModel(),c=b&&b.getItems(),h=c[d];if(h){var e=this.renderItemsAt(d,1);g=e&&e.first;if(g){this._adjustWhiteSpaceAboveItem(d,g);this._adjustWhiteSpaceBelowItem(d,g);}}}return g;};Q.prototype.onScroll=function R(){if(this.props.scrollTimeoutId){return true;}this.props.scrollTimeoutId=self.setTimeout('mstr.controllers.Factory.obj("'+this.getId()+'").updateScrollArea()',200);return true;};Q.prototype.after_set_visible=function V(b){if(this.props.visible){this.updateScrollArea();}};Q.prototype.on_win_resize=function Y(b){this._updateListContainerWidth();};Q.prototype.updateScrollArea=function C(){if(this.props.scrollTimeoutId){self.clearTimeout(this.props.scrollTimeoutId);this.props.scrollTimeoutId=null;}var h=this._computeVisibleItemsRange();if(!h){return ;}var c=this._splitRangesByRenderStatus([h]);var k=this.props.isListItemRendered;for(var e=0,b=mstr.$A.len(c);e<b;e++){var d=c[e];if(!k[d.min]){var g=this.renderItemsAt(d.min,d.max-d.min+1);if(!g||!g.first){continue;}this._adjustWhiteSpaceAboveItem(d.min,g.first);this._adjustWhiteSpaceBelowItem(d.max,g.last);}}this._updateListContainerWidth();};Q.prototype._updateListContainerWidth=function B(){if(mstr.utils.ISIE6){return ;}var b=this.props.scrollArea,c=b&&b.firstChild;if(c.style.width!=(b.scrollWidth+"px")&&mstr.utils.BoxModel.hasScrollbar(b,"x")){window.setTimeout(function(){c.style.width=b.scrollWidth+"px";},0);}};Q.prototype.execResetScrollArea=function O(){var b=this.props.scrollArea;if(mstr.utils.ISFF){b.scrollTop=0;}};Q.prototype._adjustWhiteSpaceAboveItem=function X(c,g){if(!g){return ;}var k=mstr.utils.ListViewHelper.getItemRenderer(this);var e=k&&((k.listItemHeight&&k.listItemHeight(this))||(k.listItemHeightMin&&k.listItemHeightMin(this)));if(!e){e=Q.DEFAULT_LIST_ITEM_HEIGHT;}if(!e){return ;}var d=this.findNextRenderedIndex(c-1,true);var b=c-d-1;g.style.marginTop=(b*e)+"px";};Q.prototype._adjustWhiteSpaceBelowItem=function L(c,e){var g=mstr.utils.ListViewHelper.getItemRenderer(this);var d=g&&((g.listItemHeight&&g.listItemHeight(this))||(g.listItemHeightMin&&g.listItemHeightMin(this)));if(!d){d=Q.DEFAULT_LIST_ITEM_HEIGHT;}if(!d){return ;}var l=this.findNextRenderedIndex(c+1,false);if(l>-1){var k=l-c-1;var b=e.nextSibling;if(b){b.style.marginTop=(k*d)+"px";if(mstr.utils.ISIE8){b.style.display="none";window.setTimeout(function(){b.style.display="block";},0);}}}};Q.prototype._computeVisibleItemsRange=function a(){var b=this.props,d=b.scrollArea,l=b.height;if(l&&l.match(/px$/)||(l==String(parseInt(l)))){l=parseInt(l);}else{if(l&&(l!="auto")&&!l.match(/\%$/)){l=d&&d.clientHeight;if(!l&&d&&d.style){l=d.style.height;l=(l.match(/px$/)||(l==String(parseInt(l))))?parseInt(l):"auto";}}else{l="auto";}}if(!l||isNaN(l)){var e=this.props.model,n=e&&e.props&&e.props.items;return{min:0,max:n&&n.length||0};}var g,q;var c=mstr.utils.ListViewHelper.getItemRenderer(this);if(c&&c.listItemHeight){g=q=c.listItemHeight(this);}else{g=(c&&c.listItemHeightMin&&c.listItemHeightMin(this))||Q.DEFAULT_LIST_ITEM_HEIGHT;q=(c&&c.listItemHeightMax&&c.listItemHeightMax(this))||Q.DEFAULT_LIST_ITEM_HEIGHT;}if(g){var o=d.scrollTop;var k={min:parseInt(o/q),max:parseInt((o+l)/g)+1};return k;}return null;};Q.prototype._splitRangesByRenderStatus=function J(d){var l=this.props.isListItemRendered;var c=mstr.$A.len(d);var k=0;while(k<c){var e=d[k];var b=l[e.min];for(var h=e.min+1;h<=e.max;h++){if(l[h]!=b){var g={min:h,max:e.max};e.max=h-1;d=mstr.$A.insert(d,g,k+1);c++;break;}}k++;}return d;};Q.prototype.findNextRenderedIndex=function Z(g,d){var e=this.props.isListItemRendered;if(d){for(var c=g;c>-1;c--){if(e[c]){return c;}}}else{var b=mstr.$A.len(e);for(var c=g;c<b;c++){if(e[c]){return c;}}}return -1;};function Q(b){mstr.views.ListView.apply(this,[b]);this.props.isListItemRendered=[];}return Q;})();mstr.views.FloatingEditor=(function(){mstr.$O.extendsClass(G,mstr.views.BaseView);G.prototype.before_set_visible=function C(L){if(L.memo.value&&this.get("reloadCmds")){this.fireCommands(this.get("reloadCmds"),"");}};G.prototype.execResetValidationStatus=function E(){mstr.views.BaseView.prototype.execResetValidationStatus.apply(this,arguments);if(!this.childValidationStatus){return ;}for(var L in this.childValidationStatus){mstr.$obj(L).execResetValidationStatus();}};G.prototype.after_set_childValidationStatus=function J(M){var L=M.memo;this.childValidationStatus=this.childValidationStatus||{};if(L.code==mstr.Enum.Validation.STATUSCODE.VALID){if(L.id in this.childValidationStatus){delete this.childValidationStatus[L.id];if(mstr.utils.Hash.isEmpty(this.childValidationStatus)){this.set("validationStatus",mstr.Enum.Validation.STATUSCODE.VALID);this.set("message","");this.set("CommandEnabledCheckValidationStatus",true);var N=this.getModel()&&this.getModel().disableModelFromView&&this.getModel().disableModelFromView(false);}}}else{if(mstr.utils.Hash.isEmpty(this.childValidationStatus)){this.set("validationStatus",mstr.Enum.Validation.STATUSCODE.INVALID_ANSWERS);this.set("message",this.props.descriptors.ALERT);this.set("CommandEnabledCheckValidationStatus",false);var O=this.getModel()&&this.getModel().disableModelFromView&&this.getModel().disableModelFromView(true);}this.childValidationStatus[L.id]=L.code;}};G.prototype.after_set_message=function I(N){var P=this.get("element").firstChild.rows[1].cells[0].firstChild;var O=P.firstChild;var M=N.memo.value;if(M){P.style.visibility="hidden";P.style.position="absolute";O.innerHTML=M;P.style.height="auto";var L=function(){var Q=mstr.utils.BoxModel.getElementInnerHeight(P);P.style.height=0;P.style.position="static";P.style.visibility="visible";mstr.utils.Animations.resize(P,null,Q,3,null);};window.setTimeout(L,0);}else{mstr.utils.Animations.resize(P,null,0,3,function(){O.innerHTML="";});}};G.prototype.after_set_opener=function A(M){var Q=this.get("cmdButtons")||[];for(var O=0,N=Q.length;O<N;O++){var L=Q[O]&&Q[O]._refreshCommandHandlers&&Q[O]._refreshCommandHandlers();}var P=this.get("modelPath");if(P&&P.substr(0,6)=="opener"){this.initModel();this._refreshChildViewModels(true);}};G.prototype.render=function F(){mstr.views.BaseView.prototype.render.apply(this);var M=this.props[mstr.$W.ELEMENT];if(this.get("moveToBody")&&mstr.utils.ISIE9&&M.parentNode!=document.body){this.props[mstr.$W.ELEMENT]=document.body.appendChild(M);}var O=M.firstChild;var Q=null;this.set("titleBar",this.execLayoutHandler("titleBar"));if(this.get("isModal")){var L=mstr.utils.Dom.findPositionedAncestor(M);var P=mstr.utils.BoxModel.computeDistanceFromAncestor(L);var N=mstr.utils.BoxModel.getBrowserWindowRect(M.ownerDocument);M.style.top=(N.top-P.offsetY)+"px";M.style.left=(N.left-P.offsetX)+"px";M.style.width=N.width+"px";M.style.height=N.height+"px";M.style.backgroundRepeat="repeat";mstr.utils.Dom.setBGIconClass(M,"1ptrans");Q=O;if(this.left){Q.style.left=this.left;Q.style.top=this.top;}else{mstr.utils.BoxModel.centerElementOnObject(M,Q);this.left=Q.style.left;this.top=Q.style.top;}}else{M.style.height="auto";M.style.width="auto";M.style.background="transparent";Q=M;mstr.utils.BoxModel.centerElementOnObject(document.body,Q);}O.style.visibility="visible";mstr.utils.Dom.insertPopupMask(Q,M,Q.style.left,Q.style.top);if(this.get("loadCmds")){this.fireCommands(this.get("loadCmds"),"");}};G.prototype.getHelpLink=function B(){if(this.get("helpTopic")&&this.get("helpTopic")&&this.get("helpPath")){var L=this.get("helpPath");return L+(L.lastIndexOf("#")===L.length-1?"":"#")+this.get("helpTopic");}return this.get("helpPath");};G.prototype.execShowHelp=function K(L){window.open(L);};G.prototype.execSetModel=function H(L){this.setModel(L);};G.prototype.execCheckValidationStatus=function D(){return !(this.get("validationStatus")>mstr.Enum.Validation.STATUSCODE.VALID);};function G(L){mstr.views.BaseView.apply(this,[L]);if(!this.get("isDraggable")){return ;}this.set("dz",new mstr.models.dnd.DragZone({view:this},{findTarget:function(M,O){var N=M.get("element");var P=mstr.utils.Dom.findAncestor(O.target(),"className","mstrFloatingEditorTitle");return(P&&P==M.get("titleBar"))?P:null;},getDragData:function(M,O){var P=document.createElement("div");P.style.border="2px solid #9e9e9e";var N=M.get("element").firstChild;P.style.height=mstr.utils.BoxModel.getElementOuterHeight(N)+"px";P.style.width=mstr.utils.BoxModel.getElementOuterWidth(N)+"px";return{ddel:P};},endDrag:function(N,M,P){M=Math.max(0,M);P=Math.max(0,P);var O=N.get("element");if(N.get("isModal")){P-=mstr.utils.BoxModel.getElementSumOffsetTop(O);O.firstChild.style.left=M+"px";O.firstChild.style.top=P+"px";if(O.firstChild!=O.lastChild&&O.lastChild.className!=="mstrCurtain"){O.lastChild.style.left=M+"px";O.lastChild.style.top=P+"px";}}else{O.style.left=M+"px";O.style.top=P+"px";}}}));}return G;})();mstr.views.JoinBehaviorTable=(function(){mstr.$O.extendsClass(A,mstr.views.BaseView);A.prototype.init=function E(){mstr.views.BaseView.prototype.init.apply(this);};A.prototype.render=function C(){var I="mstrDG",G=this,F=G.getModel(),H=function(){var J=G.buildDGItems(G.getModel().get(G.get("valueField"))),K=false;G.dgWidget=mstrmojo.insert({scriptClass:"mstrmojo.DataGrid",placeholder:G.props.element,cssClass:"jointype",columns:[{headerText:mstrmojo.desc(5467,"Objects"),dataField:"mn",headerCss:"jointype-hd",tooltip:true,itemTooltipField:"tf",itemCSSField:"itemCss",colWidth:160},{headerText:mstrmojo.desc(13176,"Join Type"),headerCss:"jointype-hd",dataWidget:{scriptClass:"mstrmojo.Pulldown",popupToBody:true,itemIdField:"v",itemTitleField:"title",popupZIndex:999,items:[{n:mstrmojo.desc(959,"Default"),v:"dft",title:mstrmojo.desc(959,"Default")},{n:mstrmojo.desc(13177,"Inner Join"),v:"0",title:mstrmojo.desc(13178,"Results displaying only those attribute elements that have metric value")},{n:mstrmojo.desc(13179,"Outer Join - Ignore Filter"),v:"2",title:mstrmojo.desc(13180,"Outer join to attribute's look up table without considering the filter on template")},{n:mstrmojo.desc(13181,"Outer Join - Preserve Filter"),v:"3",title:mstrmojo.desc(13182,"Outer join to attribute's look up table after considering the filter on template")}],onvalueChange:function(){if(!F.translating&&K){F.joinTypeChange(this.data.id,this.value);}},postCreate:function(){this.markupMethods=mstrmojo.hash.copy({ondataChange:function(){var L=this.data;this.set("value",L[this.itemIdField]);}},mstrmojo.hash.copy(this.markupMethods));if(this.data&&this.data.id!=="allAttrs"){this.items=[{n:mstrmojo.desc(959,"Default"),v:"dft",title:mstrmojo.desc(959,"Default")},{n:mstrmojo.desc(13177,"Inner Join"),v:"0",title:mstrmojo.desc(13178,"Results displaying only those attribute elements that have metric value")},{n:mstrmojo.desc(13183,"Outer Join"),v:"1",title:mstrmojo.desc(13184,"Outer join to attributes look up table")}];}}}}],items:J});G.dgWidget.render();K=true;};G.initModel();F.attachEventListener(this,"set_"+G.get("valueField"),"onUpdateDataGrid");if(!window.mstrmojo){microstrategy.mojoLoader.loadWidget({scriptClass:"DataGrid",id:I,bundle:"mojo-sle.js",callback:function(){microstrategy.mojoLoader.loadWidget({scriptClass:"Pulldown",id:I,bundle:"mojo-coreui.js",callback:H});}});}else{H();}};A.prototype.onUpdateDataGrid=function B(F){if(this.dgWidget){this.dgWidget.set("items",this.buildDGItems(F.memo.value));}};A.prototype.buildDGItems=function D(G){var F=[];mstr.$A.forEach(G,function(H){F.push({mn:H.alias,id:H.dssId,v:H.jt,n:H.n,tf:H.alias,itemCss:H.ic});});return F;};function A(F){mstr.views.BaseView.apply(this,[F]);}return A;})();microstrategy.FEATURE_CHECK_SHOW_SUBTOTALS="check-show-subtotals";microstrategy.FEATURE_CHECK_MERGE_COL_HEADER="check-merge-col-header";microstrategy.FEATURE_CHECK_MERGE_ROW_HEADER="check-merge-row-header";microstrategy.FEATURE_CHECK_OUTLINE_MODE="check-outline-mode";microstrategy.FEATURE_WEB_REMOVE_FROM_GRID="web-remove-from-grid";microstrategy.FEATURE_INSERT_NEW_METRIC="insert-new-metric";microstrategy.FEATURE_INSERT_TRANSFORMATION_METRICS="insert-transformation-metrics";microstrategy.FEATURE_MODIFY_GRID_LEVEL_IN_DOCUMENTS="modify-grid-level-in-documents";microstrategy.FEATURE_DOCUMENTS_DESIGN_MODE="documents-design-mode";microstrategy.FEATURE_SET_ATTRIBUTEFORM_DISPLAY="set-attributeform-display";microstrategy.FEATURE_RW_INTERACTIVE_VIEW_MODE_EPLUS="rw-interactive-view-mode-eplus";microstrategy.FEATURE_RW_EDITABLE_VIEW_MODE_EPLUS="rw-editable-view-mode-eplus";microstrategy.FEATURE_DATASET_OBJECTS_LIST="dataset-objects-list";microstrategy.FEATURE_WEB_PIVOT="web-pivot";microstrategy.FEATURE_CHECK_SHOW_PIVOT_BUTTONS="check-show-pivot-buttons";microstrategy.FEATURE_CHECK_SHOW_SORT_BUTTONS="check-show-sort-buttons";microstrategy.FEATURE_USE_OFFICE="useOffice";microstrategy.FEATURE_MODIFY_REPORT_LIST="modify-report-list";microstrategy.FEATURE_REPORT_FROM_REPORT="web-remove-from-report";microstrategy.FEATURE_USE_REPORT_OBJECT_WINDOW="report-objects-window";microstrategy.FEATURE_EMBEDDED_TEMPLATE_NODE="embedded-template-node";microstrategy.FEATURE_RW_EDITABLE_VIEW_MODE="rw-editable-view-mode";microstrategy.FEATURE_ENABLE_REEXECUTE="enable-reexecute";microstrategy.FEATURE_CHECK_SHOW_BANDING="check-show-banding";microstrategy.FEATURE_ENABLE_SCHEDULING="enable-scheduling";microstrategy.FEATURE_IS_NON_VIEWABLE_REPORT="is-non-viewable-report";microstrategy.FEATURE_REPORT_FILTER="report-filter";microstrategy.FEATURE_CREATE_HTML_CONTAINER="create-html-container";microstrategy.FEATURE_CHECK_SHOW_GRAPH_ZONES="check-show-graph-zones";microstrategy.FEATURE_INSERT_INTO_PANEL="insert-into-panel";microstrategy.FEATURE_CHECK_DESIGN_MODE="check-design-mode";microstrategy.FEATURE_ENABLE_SHOW_SUBTOTALS="enable-show-subtotals";microstrategy.FEATURE_IS_VIEW_REPORT="is-view-report";microstrategy.FEATURE_CHECK_LOCK_COLUMN_HEADERS="check-lock-column-headers";microstrategy.FEATURE_CHECK_LOCK_ROW_HEADERS="check-lock-row-headers";microstrategy.FEATURE_CONFIGURE_TRANSACTIONS="configure-transactions";microstrategy.FEATURE_ASK_BEFORE_SAVE_CHANGES="ask-before-save-changes";microstrategy.FEATURE_FORCE_SAVE_AS="force-save-as";microstrategy.FEATURE_REPORT_TEMPLATE_SEARCH="report-template-search";microstrategy.FEATURE_SINGLE_SOURCE_GRID="single-source-grid";microstrategy.FEATURE_SINGLE_SOURCE_GRID_PROJECT="single-source-grid-project";microstrategy.FEATURE_RW_LEVEL_MCE_JOIN="rw-MCE-join";microstrategy.FEATURE_PROJECT_LEVEL_MCE_JOIN="project-MCE-join";microstrategy.FEATURE_MANAGE_DATASETS="manage-datasets";microstrategy.FEATURE_SET_ATTRIBUTE_FORM_DISPLAY="set-attributeform-display";mstrNumber.UNIT_CM="1";mstrNumber.UNIT_IN="2";mstrNumber.UNIT_MM="3";mstrNumber.UNIT_PT="4";mstrNumber.UNIT_PC="5";mstrNumber.UNIT_PX="6";mstrNumber.UNIT_EM="7";mstrNumber.prototype=new Object;mstrNumber.prototype.locale="1033";mstrNumber.prototype.units=mstrNumber.UNIT_IN;mstrNumber.prototype.unitsLabel="";mstrNumber.prototype.thousandSeparatorRegex=null;mstrNumber.prototype.toLocaleString=function(B){try{return(B+"").replace(".",mstr.Settings.Locale.DECIMALSEP);}catch(A){microstrategy.errors.log(A);return B;}};mstrNumber.prototype.toString=function(D,A){try{if(A==true){var C=this.getThousandSepRegex();if(C){D=String(D).replace(C,"");}}D=String(D).replace(mstr.Settings.Locale.DECIMALSEP,".");return D;}catch(B){microstrategy.errors.log(B);return D;}};mstrNumber.prototype.toUserUnits=function(C,B){try{return this.toLocalUnits(this.units,C,B);}catch(A){microstrategy.errors.log(A);}};mstrNumber.prototype.toLocalUnits=function(D,E,C){try{var A;switch(D){case mstrNumber.UNIT_CM:A=(parseFloat(this.toString(E))*2.54).toFixed(4)+"";break;case mstrNumber.UNIT_MM:A=(parseFloat(this.toString(E))*25.4).toFixed(4)+"";break;case mstrNumber.UNIT_PT:A=(parseFloat(this.toString(E))*72).toFixed(4)+"";break;case mstrNumber.UNIT_PC:A=(parseFloat(this.toString(E))*6).toFixed(4)+"";break;case mstrNumber.UNIT_PX:A=(parseFloat(this.toString(E))*microstrategy.DPI_CONVERSION)+"";break;case mstrNumber.UNIT_EM:A=(parseFloat(this.toString(E))*10.6666).toFixed(4)+"";break;default:A=parseFloat(this.toString(E)).toFixed(4)+"";}if(C){return A;}else{return this.toLocaleString(A);}}catch(B){microstrategy.errors.log(B);}};mstrNumber.prototype.toUSUnits=function(C,B){try{return this.convertToUSUnits(this.units,C,B);}catch(A){microstrategy.errors.log(A);}};mstrNumber.prototype.convertToUSUnits=function(D,E,C){try{var A=E;switch(D){case mstrNumber.UNIT_CM:A=parseFloat(this.toString(E))/2.54+"";break;case mstrNumber.UNIT_MM:A=parseFloat(this.toString(E))/25.4+"";break;case mstrNumber.UNIT_PT:A=parseFloat(this.toString(E))/72+"";break;case mstrNumber.UNIT_PC:A=parseFloat(this.toString(E))/6+"";break;case mstrNumber.UNIT_PX:A=parseFloat(this.toString(E))/microstrategy.DPI_CONVERSION+"";break;case mstrNumber.UNIT_EM:A=(parseFloat(this.toString(E))/10.6666)+"";break;}if(C){return A;}else{return this.toLocaleString(A);}}catch(B){microstrategy.errors.log(B);}};mstrNumber.prototype.convertUnit=function(B,C,A){return this.toLocalUnits(C,this.convertToUSUnits(B,A,true),true);};mstrNumber.prototype.getThousandSepRegex=function(){if(this.thousandSeparatorRegex==null){var A=mstr.Settings.Locale.THOUSANDSEP;A=A.replace(/(\W){1}/g,"\\$1");this.thousandSeparatorRegex=new RegExp(A,"g");}return this.thousandSeparatorRegex;};function mstrNumber(){return this;}microstrategy.number=new mstrNumber();mstrObserverImpl.prototype=new Object();mstrObserverImpl.prototype.items=null;mstrObserverImpl.prototype.onload=function(){if(microstrategy.observerItems){this.items=microstrategy.observerItems;microstrategy.observerItems=null;}};mstrObserverImpl.prototype.onunload=function(){microstrategy.observerItems=this.items;};mstrObserverImpl.prototype.register=function(A){if(typeof (this.items[A])=="undefined"){this.items[A]=A;}return true;};mstrObserverImpl.prototype.unregister=function(A){if(typeof (this.items[A])!="undefined"){delete this.items[A];}return true;};mstrObserverImpl.prototype.notifyAll=function(A,D){try{for(var E in this.items){var C=mstr.$obj(E);if(C&&A in C){C[A](D);}}return true;}catch(B){microstrategy.errors.log(B);return false;}};function mstrObserverImpl(A){this.items=new Object();return this;}mstrSerializer.prototype=new Object;mstrSerializer.prototype.buffer="";mstrSerializer.prototype.needDelim=false;mstrSerializer.CH_ESCAPE="*";mstrSerializer.CH_DELIM=".";mstrSerializer.CH_BRA="-";mstrSerializer.CH_KET="_";mstrSerializer.CH_LESS="<";mstrSerializer.STR_NULL="*0";mstrSerializer.prototype.getState=function(){try{return this.buffer;}catch(A){microstrategy.errors.log(A);return false;}};mstrSerializer.prototype.addStr=function(B){try{if(this.needDelim){this.buffer+=mstrSerializer.CH_DELIM;}this.appendValue(B);this.needDelim=true;}catch(A){microstrategy.errors.log(A);return false;}};mstrSerializer.prototype.addInt=function(B){try{this.addStr(B+"");}catch(A){microstrategy.errors.log(A);return false;}};mstrSerializer.prototype.addBoolean=function(B){try{this.addStr(B?"1":"0");}catch(A){microstrategy.errors.log(A);return false;}};mstrSerializer.prototype.addValues=function(A){try{this.buffer+=mstrSerializer.CH_BRA;for(var B=0;B<A.length;B++){if(B>0){this.buffer+=mstrSerializer.CH_DELIM;}this.appendValue(A[B]);}this.buffer+=mstrSerializer.CH_KET;this.needDelim=false;}catch(C){microstrategy.errors.log(C);return false;}};mstrSerializer.prototype.appendValue=function(C){try{var A=new RegExp("[\\"+mstrSerializer.CH_ESCAPE+"\\"+mstrSerializer.CH_BRA+"\\"+mstrSerializer.CH_KET+"\\"+mstrSerializer.CH_DELIM+"\\"+mstrSerializer.CH_LESS+"]","g");var D=mstrSerializer.CH_ESCAPE+"$&";C=String(C).replace(A,D);this.buffer+=C;}catch(B){microstrategy.errors.log(B);return false;}};function mstrSerializer(){return this;}function util_alignColumnHeaderCell(A,C){A.style.width=C+"px";if(mstr.utils.ISIE4&&!mstr.utils.ISIE8&&!(mstr.utils.ISIE9||mstr.utils.ISIE10||mstr.utils.ISW3CIE)){if(C==0){A.style.display="none";}else{A.style.display="";}var B=function(){var D=A.offsetWidth;if(D!=C){A.style.width=Math.max(parseInt(A.style.width)+C-D,0)+"px";}};window.setTimeout(B,0);}}function util_convert2Px(D,B){if(mstr.utils.ISIE8&&!/px$/.test(B)){var A=document.createElement("img"),C;A.style.zIndex=-1;A.style.left=B;D.appendChild(A);C=A.style.pixelLeft;D.removeChild(A);return C+"px";}return B;}function util_getBorderWidth(A,E){var B="border-"+E+"-width",C=mstr.utils.CSS.getStyleValue(A,B),D=mstrNumber["UNIT_"+C.substring(C.length-2,C.length).toUpperCase()];if(D){C=(parseFloat(microstrategy.number.convertUnit(D,mstrNumber.UNIT_PX,C))||0);}return C;}function util_getCellPadding(A,B){return parseFloat(mstr.utils.CSS.getStyleValue(A,"padding-"+B));}function util_getRowHeight(G){if((mstr.utils.ISIE9||mstr.utils.ISIE10||mstr.utils.ISW3CIE)){var C=G.cells,A=null;if(G.style.height){return parseFloat(G.style.height);}var E=0;for(var D=0;D<C.length;D++){A=C[D];var B=util_getBorderWidth(A,"top")+util_getBorderWidth(A,"bottom");var F=util_getCellPadding(A,"top")+util_getCellPadding(A,"bottom");if(A.getAttribute("rowspan")==null){E=Math.max(E,parseFloat((mstr.utils.CSS.getStyleValue(A,"height")))+B+F);}}if(A){if(!G.getAttribute("o")){return getObjOuterHeight(G);}return E;}}return mstr.utils.ISIE8?getObjInnerHeight(G):getObjOuterHeight(G);}function util_getCellWidth(A){if((mstr.utils.ISIE9||mstr.utils.ISIE10||mstr.utils.ISW3CIE)){var B=(parseFloat(mstr.utils.CSS.getStyleValue(A,"width")));B=B==0?B:(B+(parseFloat(mstr.utils.CSS.getStyleValue(A,"padding-right"))||0)+(parseFloat(mstr.utils.CSS.getStyleValue(A,"padding-left"))||0)+util_getBorderWidth(A,"left")+util_getBorderWidth(A,"right"));return B+((mstr.utils.ISIE9||mstr.utils.ISIE10||mstr.utils.ISW3CIE)&&A.parentNode.getAttribute("o")?0.1:0);}return getObjOuterWidth(A);}function util_serRowHeight(F,A,E){F.style.height=A+"px";if(mstr.utils.ISSAFARI){var C=F.cells;for(var B=0;B<C.length;B++){C[B].style.height=A+"px";}}if((mstr.utils.ISIE9||mstr.utils.ISIE10||mstr.utils.ISW3CIE)&&E){var C=F.cells;if(C&&C[0]){window.setTimeout(function(){C[0].style.height=(A-util_getBorderWidth(C[0],"top")-util_getBorderWidth(C[0],"bottom"))+"px";},100);}}if(mstr.utils.ISIE4&&(!((mstr.utils.ISIE9||mstr.utils.ISIE10||mstr.utils.ISW3CIE)))){var D=function(){var G=util_getRowHeight(F);if(G!=A){F.style.height=Math.max(2*A-G,0)+"px";}};window.setTimeout(D,0);}}function util_getRowHeight(G){if((mstr.utils.ISIE9||mstr.utils.ISIE10)){var C=G.cells,A=null;if(G.style.height){return parseFloat(G.style.height);}var E=0;for(var D=0;D<C.length;D++){A=C[D];var B=util_getBorderWidth(A,"top")+util_getBorderWidth(A,"bottom");var F=util_getCellPadding(A,"top")+util_getCellPadding(A,"bottom");if(A.getAttribute("rowspan")==null){E=Math.max(E,parseFloat((mstr.utils.CSS.getStyleValue(A,"height")))+B+F);}}if(A){if(!G.getAttribute("o")){return getObjOuterHeight(G);}return E;}}return mstr.utils.ISIE8?getObjInnerHeight(G):getObjOuterHeight(G);}function util_getBorderWidth(A,E){var B="border-"+E+"-width",C=mstr.utils.CSS.getStyleValue(A,B),D=mstrNumber["UNIT_"+C.substring(C.length-2,C.length).toUpperCase()];if(D){C=(parseFloat(microstrategy.number.convertUnit(D,mstrNumber.UNIT_PX,C))||0);}return C;}function util_getCellPadding(A,B){return parseFloat(mstr.utils.CSS.getStyleValue(A,"padding-"+B));}function util_getHeaderColumnLeftPosition(A){var B=util_getHeaderColumnHelper(A,"getObjOffsetLeft");return B;}function util_getHeaderColumnWidths(B){if(!mstr.utils.ISWK&&!mstr.utils.ISIE8&&!(mstr.utils.ISIE9||mstr.utils.ISIE10||mstr.utils.ISW3CIE)){var A=[];if(!B){return A;}var E=B.getElementsByTagName("COL");if(E&&E.length){var D=E.length;for(var C=0;C<D;C++){A.push(getObjOuterWidth(E[C]));}}return A;}return util_getHeaderColumnHelper(B,"util_getCellWidth");}function util_getHeaderColumnHelper(V,I){var A=[];if(!V){return A;}var Q=V.rows,R,B=Q&&Q[0],M=0;for(R=0;R<Q.length;R++){if(Q[R].cells.length!==0){B=Q[R];break;}}var K=function(m,c){var l=m.getAttribute(c);return l==null?1:parseInt(l);};var d=function(n,c){var l=null;var o=n.getElementsByTagName("colgroup");var m=o&&o[0];if(m&&m.childNodes[c]){l=parseFloat(m.childNodes[c].style.width);}return l;};var D=function(l){var c=0;if((mstr.utils.ISIE7||mstr.utils.ISIE8||(mstr.utils.ISIE9||mstr.utils.ISIE10||mstr.utils.ISW3CIE))&&!l.parentNode.getAttribute("o")&&!l.getAttribute("p")){l.setAttribute("p",1);c=((parseFloat(util_convert2Px(l,mstr.utils.CSS.getStyleValue(l,"paddingRight")))||0)+((mstr.utils.ISIE8||(mstr.utils.ISIE9||mstr.utils.ISIE10||mstr.utils.ISW3CIE))?1:0));l.style.paddingRight=((mstr.utils.ISIE9||mstr.utils.ISIE10||mstr.utils.ISW3CIE)?c:Math.ceil(c))+"px";}};var T=function(q,s){var n=q.cells,r=0;for(var m=0,l=n.length;m<l;m++){var o=K(n[m],"colspan");if(o==1){A[s+m+r]=((mstr.utils.ISIE9||mstr.utils.ISIE10||mstr.utils.ISW3CIE)&&I=="util_getCellWidth")?d(V,s+m+r)||window[I](n[m]):window[I](n[m]);}else{var c=0;for(W=s+m+r+1;W<s+m+r+o;W++){c+=A[W];}A[s+m+r]=window[I](n[m])-c;r+=o-1;}}};var b=function(t,m){var s,l,r,q,o,u=m.cells,w=t.cells;for(l=0,r=u.length;l<r;l++){o=K(u[l],"rowspan");if(o===1){break;}}for(s=0,r=w.length;s<r;s++){q=w[s];if(q.getAttribute("CTY")=="3"){return false;}else{u[l++]=q;}}return true;};if(Q.length>0){var Y=B.cells;for(var W=0,h=Y.length;W<h;W++){var L=K(Y[W],"colspan"),g=window[I](Y[W]),J=(g/L);A.push(J);while(L-->1){A.push(J);}}}var k=null,P=null,E=[],S={colStart:0,rowSpan:1},O=0,H=0;for(var X=R+1,U=Q.length;X<U;X++){var a=Q[X].getAttribute("level");if(!Q[X].getAttribute("o")){var C=Q[X].cells[0];if(C&&(C.getAttribute("oty")=="12"||C.getAttribute("MH"))){k=Q[X];H=X;}else{H=X;}}else{if(!a&&Q[X].getAttribute("o")){if(!P){P={cells:[]};}if(b(Q[X],P)){break;}}else{if(a){if(a<=O&&Q[X].style.display!="none"){P=Q[X-1];break;}else{O=a;}}}}}if(k){for(var X=R,Z=H;X<=Z;X++){Y=Q[X].cells;for(var W=0,N=Y.length;W<N;W++){var G=K(Y[W],"rowspan");if(G>H){M+=K(Y[W],"colspan");}else{break;}}}T(k,M);}var F=function F(){var q,l,o,r,c,m,s=Q.length,u=P&&P.cells,n=A.length,t=n,w=false;if(!u||u.length==n){return ;}for(q=R+1;q<s;q++){if(Q[q].getAttribute("level")){return ;}if(Q[q].getAttribute("o")){o=Q[q].cells;m=o.length;for(l=0;l<m;l++){if(o[l].getAttribute("CTY")=="3"){w=true;break;}}if(w&&(K(o[l],"rowspan")>1)){break;}return ;}}for(q=0;q<n;q++){u[q]=null;}for(q=0;q<s;q++){if(t==0){break;}o=Q[q].cells;c=n;for(l=o.length-1;l>=0;l--){r=K(o[l],"colspan");if(r>1){c-=r;continue;}c-=1;if(!u[c]){u[c]=o[l];t--;}}}if(t>0){for(q=0;q<n;q++){if(!u[q]){u[q]={offsetLeft:0,parentNode:{getAttribute:function(){return null;}},getAttribute:function(x){if(x=="colspan"||x=="p"){return 1;}return null;}};}}}};F();if(P){for(X=0,U=Math.min(B.cells.length,P.cells.length);X<U;X++){var e=B.cells[X];if(e&&(e.getAttribute("AX")==="1"||e.getAttribute("AX")==="2"&&e.getAttribute("oty")==="12"||e.getAttribute("MH"))){if(K(B.cells[X],"colspan")>K(P.cells[X],"colspan")){T(P,0);break;}}else{break;}}}return A;}function util_getColumnWidthsArray(A,C,D,F){var E=util_getColumnLeftPositionsArray(A,C,D);var B=util_getWidthsArrayFromLeftsArray(A,C,D,E,F);return(B);}function util_getWidthsArrayFromLeftsArray(H,A,C,F,I){var G=(I)?1:0;var B=new Array;for(var E=0;E<A;E++){var J=E+1;for(J=E+1;J<=A;J++){if(F[J]!=null){break;}}if(J<=A){B[E]=Math.max(F[J]-F[E]-I,0);for(var D=E+1;D<J;D++){B[D]=0;}E+=J-(E+1);}}return(B);}function util_getColumnLeftPosition(K,A,B,I){var C=K.getElementsByTagName("COL");var D=(C)?C.length:0;var G=true;if(A<D){G=false;for(var H=A;H<D;H++){if(C[H].style.display!="none"){A=H;G=true;break;}}}if(G){var F=null;if(bIsIE4&&!bIsIE6){var L=util_getLetterForColumnNumber(A+1);var J=K.cells(L+"1:"+L+B);if(J){if(J.length){F=getObjSumLeft(J[0]);}else{F=getObjSumLeft(J);}}}else{if(bIsW3C||bIsIE6){if(mstr.utils.ISIE8||(mstr.utils.ISIE9||mstr.utils.ISIE10)){var E=util_getHeaderColumnLeftPosition(K);F=E[A]+getObjSumLeft(K);}else{if(mstr.utils.ISCHROME||mstr.utils.ISSAFARI||mstr.utils.ISW3CIE){E=util_getHeaderColumnHelper(K,"getObjSumLeft");F=E[A];}else{if(!I){I=K.getElementsByTagName("COL");}F=getObjSumLeft(I&&I[A]);}}}}return(F);}else{return(getObjSumLeft(K)+getObjWidth(K));}}function util_getColumnLeftPositionsArray(B,E,F){var G=new Array;if(!B){return(G);}for(var C=0;C<E;C++){G[C]=util_getColumnLeftPosition(B,C,F);}var A=null;if(bIsIE4){var D=util_getLetterForColumnNumber(E);A=B.cells.namedItem(D+"1:"+D+F);if(A){if(A.length){A=A[0];}}}if(A){G[E]=getObjSumLeft(A)+getObjWidth(A);}else{G[E]=getObjSumLeft(B)+getObjWidth(B);}return(G);}function util_setObjTableLayout(A,B){A.style.tableLayout="fixed";A.style.width="";if(A.width){A.width="";}return ;}function util_getRowHeightsOfTable(D,B){var A=new Array;for(var C=0;C<B;C++){A[C]=getObjHeight(D.rows[C]);}return(A);}function util_applyRowHeightsToTable(D,B){if(!D){return ;}var A=D.rows.length;for(var C=0;C<A;C++){if(B[C]!=getObjHeight(D.rows[C])){D.rows[C].style.height=B[C];}}return ;}function util_applyColWidthsToTable(H,C,A){if((!H)||(!C)){return ;}var B=C.length;var G=-1;var I=-1;var D=1;for(var F=0;F<B;F++){if(A[F]!=null){I=F;D=1;}else{I=G;var J=-1;for(var E=F+1;E<B;E++){if(A[F]!=null){J=E;break;}}D=J-G;if(D<1){D=1;}}if(I>-1){if(parseInt(A[I])>-1){C[F].style.width=(parseInt(A[I])/D)+"px";if(A[I]>0){C[F].style.display="";}else{if(!mstr.utils.ISW3C){C[F].style.display="none";}else{C[F].style.width="0px";}}G=I;}else{C[F].style.display="none";}}}H.style.width="";return ;}function util_parseRowSpan(B,C){var A=B.rowSpan;if((A)&&(!isNaN(parseInt(A)))&&(parseInt(A)>0)){return(parseInt(A));}return(C);}function util_initCOLTags(G,A){var C=0;var B=G.getElementsByTagName("COL");if(B){C=B.length;}if(C<A){var F=null;var E=G.getElementsByTagName("COLGROUP");if(E.length==0){F=document.createElement("COLGROUP");F=G.insertBefore(F,G.getElementsByTagName("TBODY")[0]);}else{F=E[0];}var I=A-C;for(var D=0;D<I;D++){var H=document.createElement("COL");F.appendChild(H);}}return ;}function util_getWidthofFixedColumns(A,D,E,C,B){if((!A)||(!D)||(!E)||(!C)){return(0);}if(D>=E){return(getObjWidth(A));}else{return(util_getColumnLeftPosition(A,D,C,B)-getObjSumLeft(A));}return(0);}function util_getHeightofFixedRows(A,B,C){if((!A)||(!B)||(!C)){return(0);}if(B>=C){return(getObjHeight(A));}else{return(getObjSumTop(A.rows[B])-getObjSumTop(A));}return(0);}function util_getLetterForColumnNumber(D){var G=97;var F=0;var E=0;var C=0;do{F++;E=26*F;C=26*(F-1)+1;if((D<=E)&&(D>=C)){break;}}while(E<=256);var B="";var A="";if(F>1){B=String.fromCharCode(G+F-2);}A=String.fromCharCode(G+(D-C));return(B+A);}function util_getFixedRows(C){if(!C){return(0);}var D=C.rows;if(!D){return(0);}var A=D.length;var E=0;var F="";if(D[A-1].getAttribute("o")){F="o";}else{if(D[A-1].getAttribute("level")){F="level";}}if(F==""){E=A;}else{for(var B=0;B<A;B++){if(D[B].getAttribute(F)){E=B;break;}}}return(E);}function util_getFixedCols(A){var C=0;var B=util_lastRepeatColHeaderInRow(A,0);C=util_sumColumnCountForCell(A,0,B);return(C);}function util_lastRepeatColHeaderInRow(B,E){var D=B.rows;if(!D){return(0);}var G=D[E].childNodes.length-1;var F=-1;for(var C=0;C<=G;C++){if(D[E].childNodes[C].getAttribute){var A=D[E].childNodes[C].getAttribute("AX");}if(!A||(A!="1")){break;}else{F=C;}}if(F<G){if(D[E].childNodes[F+1].getAttribute){if((D[E].childNodes[F+1].getAttribute("AX")=="2")&&(D[E].childNodes[F+1].getAttribute("OR")=="H")){F+=1;}}}return(F);}function util_sumColumnCountForCell(A,F,D){if(!(A.rows)){return(0);}var C=A.rows[F];if(!C){return(0);}var E=0;for(var B=0;B<D+1;B++){E+=util_parseSpan(C.childNodes[B],1);}return(E);}function util_parseSpan(B,C){var A=B.colSpan;if((A)&&(!isNaN(parseInt(A)))&&(parseInt(A)>0)){return(parseInt(A));}return(C);}function util_copyNode(C,A){A.innerHTML=C.innerHTML;if(C.attributes){var D=C.attributes.length;for(var B=0;B<D;B++){if((C.attributes[B])&&(C.attributes[B].specified)){A.setAttribute(C.attributes[B].nodeName,C.attributes[B].nodeValue,0);}}}if(C.className){A.className=C.className;}return ;}function util_resolveRepeatedColumnWidths(B,D){var H=B;var M=new Array;var K=0;if(!D){return(H);}var F=D.length;for(var I=0;I<F;I++){var L=false;var J=D[I].getAttribute("KEY");if(J){for(var G=0;G<K;G++){if(M[K]==J){L=true;break;}}}else{L=true;}if(!L){var C=new Array;var A=0;for(var G=I;G<F;G++){if(D[G].getAttribute("KEY")==J){C[A]=G;A++;}}var E=0;for(var G=0;G<C.length;G++){if(B[C[G]]>E){E=B[C[G]];}}for(var G=0;G<C.length;G++){H[C[G]]=E;}M[K]=J;K++;}}return(H);}function util_getColumnWidthsString(J,C,M,B){if(!J){return("");}var A=util_getColumnWidthsArray(J,M,B);A=util_resolveRepeatedColumnWidths(A);var E=new Array;var K=0;if(C){var D=C.length;for(var G=0;G<D;G++){var I=C[G].getAttribute("KEY");var L=false;for(var F=0;F<K;F=F+2){if(E[F]==I){L=true;break;}}if(!L){E[K]=I;K++;E[K]=parseInt(A[G]);K++;}}}var H="";var G=0;do{H+=E[G]+":"+E[G+1]+"_";G=G+2;}while(G<K);return(H);}function util_applySingleRowHeight(D,E,G,A){if((!D)||(!D.rows)||(!D.rows.length)){return ;}var F=D.rows.length;if(G>F-1){return ;}if(A>F-1){A=F-1;}var B=(E.length==0)?"":E+"px";for(var C=G;C<=A;C++){D.rows[C].style.height=B;}return ;}function util_getColIndex(K,M,C){try{var F=K.parentNode.rowIndex;var J=util_sumColumnCountForCell(M,F,K.cellIndex)-1;var N=M.rows;for(var A=F;A>=0;A--){for(var I=0,E=0;I<(J+C[F]);){var B=N[A].cells[E++];var H=util_parseRowSpan(B,1);var G=util_parseSpan(B,1);if(H>1){for(var L=A+1;L<(A+H);L++){C[L]+=G;}}I+=G;}}return(J+C[F]);}catch(D){microstrategy.errors.log(D);return null;}}function util_getAllCellsInColumnFromThisCell(B,R,A){try{var U=B.parentNode.rowIndex;var J=R.rows;var F=new Array();for(var Q=0;Q<J.length;Q++){F[Q]=0;}var O=util_getColIndex(B,R,F);var M=new Array();M[0]=B;var P=1;var H=util_parseRowSpan(B,1);if(A==null||typeof (A)=="undefined"){A=J.length;}for(var L=U+H;L<A;){var D=J[L].cells;for(var S=0,N=0;S<O-F[L]&&N<D.length;){var T=D[N++];var E=util_parseRowSpan(T,1);var I=util_parseSpan(T,1);if(E>1){for(var K=L+1;K<(L+E);K++){F[K]+=I;}}if(I>1){F[L]+=I-1;}S+=I;}var C=1;if((O-F[L])>=0){M[P++]=D[O-F[L]];C=util_parseRowSpan(D[O-F[L]],1);}L+=C;}return M;}catch(G){microstrategy.errors.log(G);return null;}}function util_getAllCellsInRowFromThisCell(G,H){if(G.nodeName.toLowerCase()!="td"){return null;}var F=G.parentNode.rowIndex;var B=new Array();B[0]=G;var C=1;var E=util_parseRowSpan(G,H);for(var D=G.cellIndex+1;D<G.parentNode.cells.length;D++){B[C]=G.parentNode.cells[D];C++;}for(var D=F+1;D<F+E;D++){var I=H.rows[D];for(var A=0;A<I.cells.length;A++){B[C]=H.rows[D].cells[A];C++;}}return B;}function util_findCell(D,H,B,C,G){var F=D.rows[H];if(F!=null){var A=F.cells[B];var E=A&&A.getAttribute(G);if(E&&E.toLowerCase()==C.toLowerCase()){return A;}}return null;}GradientUtilScript=true;var gradientUtil=new function(){};gradientUtil.prototype=new Object();gradientUtil.PIXEL_WIDTH=2;gradientUtil.GRADIENTSHADING_STYLE_HORIZONTAL=1;gradientUtil.GRADIENTSHADING_STYLE_VERTICAL=2;gradientUtil.GRADIENTSHADING_STYLE_DIAGONALUP=3;gradientUtil.GRADIENTSHADING_STYLE_DIAGONALDOWN=4;gradientUtil.GRADIENTSHADING_STYLE_FROMCORNER=5;gradientUtil.GRADIENTSHADING_STYLE_FROMCENTER=6;gradientUtil.GRADIENTSHADING_STYLE_CUSTOM=7;gradientUtil.GRADIENT_START_COLOR_INDEX=0;gradientUtil.GRADIENT_END_COLOR_INDEX=1;gradientUtil.GRADIENT_TRANSITION_TYPE_INDEX=2;gradientUtil.GRADIENT_ANGLE_INDEX=3;gradientUtil.GRADIENT_XOFFSET_INDEX=4;gradientUtil.GRADIENT_YOFFSET_INDEX=5;gradientUtil.GRADIENT_POSTFIX="_gradient";gradientUtil.getXCoordinate=function(C,A){try{return parseInt(C%(A/this.PIXEL_WIDTH));}catch(B){microstrategy.errors.log(B);return false;}};gradientUtil.getYCoordinate=function(C,A){try{return parseInt(C/(A/this.PIXEL_WIDTH));}catch(B){microstrategy.errors.log(B);return false;}};gradientUtil.getColorPercent=function(E,G,A,C,B){try{switch(parseInt(B)){case gradientUtil.GRADIENTSHADING_STYLE_HORIZONTAL:if(A==1){return E*gradientUtil.PIXEL_WIDTH/C;}else{if(A==2){return 1-E*gradientUtil.PIXEL_WIDTH/C;}else{if(A==3){return 1-(((-2)*Math.abs(E-(C/gradientUtil.PIXEL_WIDTH)/2))+(C/gradientUtil.PIXEL_WIDTH))*gradientUtil.PIXEL_WIDTH/C;}}}break;case gradientUtil.GRADIENTSHADING_STYLE_VERTICAL:if(A==1){return G*gradientUtil.PIXEL_WIDTH/C;}else{if(A==2){return 1-G*gradientUtil.PIXEL_WIDTH/C;}else{if(A==3){return 1-(((-2)*Math.abs(G-(C/gradientUtil.PIXEL_WIDTH)/2))+(C/gradientUtil.PIXEL_WIDTH))*gradientUtil.PIXEL_WIDTH/C;}}}break;case gradientUtil.GRADIENTSHADING_STYLE_DIAGONALUP:if(A==1){return((E+G)*gradientUtil.PIXEL_WIDTH/C)/2;}else{if(A==2){return 1-((E+G)*gradientUtil.PIXEL_WIDTH/C)/2;}else{if(A==3){return 1-(((-1)*Math.abs((E+G)-(C/gradientUtil.PIXEL_WIDTH)))+(C/gradientUtil.PIXEL_WIDTH))*gradientUtil.PIXEL_WIDTH/C;}}}break;case gradientUtil.GRADIENTSHADING_STYLE_DIAGONALDOWN:if(A==1){return 1-((E+(C/gradientUtil.PIXEL_WIDTH)-G)*gradientUtil.PIXEL_WIDTH/C)/2;}else{if(A==2){return((E+(C/gradientUtil.PIXEL_WIDTH)-G)*gradientUtil.PIXEL_WIDTH/C)/2;}else{if(A==3){return 1-(((-1)*Math.abs((E+(C/gradientUtil.PIXEL_WIDTH)-G)-(C/gradientUtil.PIXEL_WIDTH)))+(C/gradientUtil.PIXEL_WIDTH))*gradientUtil.PIXEL_WIDTH/C;}}}break;case gradientUtil.GRADIENTSHADING_STYLE_FROMCORNER:if(A==1){return Math.max(E,G)*gradientUtil.PIXEL_WIDTH/C;}else{if(A==2){return Math.max((C/gradientUtil.PIXEL_WIDTH)-E,G)*gradientUtil.PIXEL_WIDTH/C;}else{if(A==3){return 1-Math.min(E,G)*gradientUtil.PIXEL_WIDTH/C;}else{if(A==4){return 1-Math.min((C/gradientUtil.PIXEL_WIDTH)-E,G)*gradientUtil.PIXEL_WIDTH/C;}}}}break;case gradientUtil.GRADIENTSHADING_STYLE_FROMCENTER:var F=2*gradientUtil.PIXEL_WIDTH;if(A==1){return 1-(2*Math.min(Math.min((C/gradientUtil.PIXEL_WIDTH)-E,E),Math.min((C/gradientUtil.PIXEL_WIDTH)-G,G)))*gradientUtil.PIXEL_WIDTH/C;}else{if(A==2){return((Math.abs(E-(C/F))/(C/F))+(Math.abs(G-(C/F))/(C/F)))/2;}else{if(A==3){return Math.sqrt((Math.pow(Math.abs(E-(C/F)),2)+Math.pow(Math.abs(G-(C/F)),2))/Math.pow((C/F),2));}}}break;}}catch(D){microstrategy.errors.log(D);}};gradientUtil.getRGBColor=function(B){try{if(B.indexOf("#")>=0){B=B.substring(B.indexOf("#")+1);}var C=new Array();if(B.length==6){var F=parseInt(B.substring(0,2),16);var E=parseInt(B.substring(2,4),16);var A=parseInt(B.substring(4,6),16);C.push(F);C.push(E);C.push(A);return C;}else{return[0,0,0];}}catch(D){microstrategy.errors.log(D);return false;}};gradientUtil.createIntervalColors=function(C,B,A,D){try{var E=new Array();var G=(A-D)/2;E[0]=gradientUtil.createIntervalColor(C,B,(A-G)/A);E[1]=gradientUtil.createIntervalColor(C,B,G/A);return E;}catch(F){microstrategy.errors.log(F);return false;}};gradientUtil.createIntervalColor=function(B,A,D){try{var C=gradientUtil.setColorHue(gradientUtil.longHexToDec(B),D,gradientUtil.longHexToDec(A));return mstr.utils.Color.rgb2hex(C[0],C[1],C[2]);}catch(E){microstrategy.errors.log(E);return false;}};gradientUtil.setColorHue=function(E,D,F){try{var A=new Array();for(var B=0;B<E.length;B++){A[B]=Math.round(E[B]*D)+Math.round(F[B]*(1-D));A[B]=A[B]>255?255:A[B];}return A;}catch(C){microstrategy.errors.log(C);return false;}};gradientUtil.longHexToDec=function(A){try{return new Array(gradientUtil.toDec(A.substring(0,2)),gradientUtil.toDec(A.substring(2,4)),gradientUtil.toDec(A.substring(4,6)));}catch(B){microstrategy.errors.log(B);return false;}};gradientUtil.toDec=function(B){try{return parseInt(B,16);}catch(A){microstrategy.errors.log(A);return false;}};gradientUtil.applyGradientSettings=function(C,A,B){gradientUtil.applyGradient(C,A[gradientUtil.GRADIENT_START_COLOR_INDEX],A[gradientUtil.GRADIENT_END_COLOR_INDEX],A[gradientUtil.GRADIENT_ANGLE_INDEX],A[gradientUtil.GRADIENT_XOFFSET_INDEX],A[gradientUtil.GRADIENT_YOFFSET_INDEX],microstrategy.styleObj);};gradientUtil.applyGradient=function(E,H,C,I,F,B,A){try{var G=(I==0)?gradientUtil.GRADIENTSHADING_STYLE_HORIZONTAL:gradientUtil.GRADIENTSHADING_STYLE_VERTICAL;if((G==gradientUtil.GRADIENTSHADING_STYLE_HORIZONTAL&&F!=100)||(G==gradientUtil.GRADIENTSHADING_STYLE_VERTICAL&&B!=100)){gradientUtil.createGradient(E,H,C,G,A,true);}else{gradientUtil.createGradient(E,C,H,G,A,false);}}catch(D){microstrategy.errors.log(D);return false;}};gradientUtil.createGradient=function(H,K,E,J,A,M){try{var C=(J==gradientUtil.GRADIENTSHADING_STYLE_HORIZONTAL)?1:0;if(bIsDXIE){var B=false;var D=H.style.filter;if((D==null||D.length==0)&&A){D=A.getFilter(H);if(D&&D.length>0){B=true;}}var I=null;if(D!=null&&D.length>0){I=H.filters["DXImageTransform.Microsoft.Gradient"];}if((getObjInnerHeight(H)<2&&J==gradientUtil.GRADIENTSHADING_STYLE_VERTICAL)||(getObjInnerWidth(H)<2&&J==gradientUtil.GRADIENTSHADING_STYLE_HORIZONTAL)){if(I){I.enabled=false;}H.style.backgroundColor="#"+K;return ;}if(I!=null){I.gradientType=C;I.startColorStr="#FF"+K;I.endColorStr="#FF"+E;I.enabled=true;}else{if(!B){H.style.filter+="progid:DXImageTransform.Microsoft.Gradient(GradientType="+C+", StartColorStr='#"+K+"', EndColorStr='#"+E+"') ";}else{A.objSheet.styleRules[A.getId(H)].style.filter+="progid:DXImageTransform.Microsoft.Gradient(GradientType="+C+", StartColorStr='#"+K+"', EndColorStr='#"+E+"') ";}}H.style.backgroundColor="transparent";}else{H.style.backgroundColor="#"+((M==true)?K:E);var L="#"+K,G="#"+E;if(mstr.utils.ISFF){H.style.background="-moz-linear-gradient("+((C===0)?"top":"left")+","+L+","+G+")";}else{if(mstr.utils.ISWK){H.style.background="-webkit-gradient(linear,"+((C===0)?"left top, left bottom":"left top, right top")+",from("+L+"),to("+G+"))";}else{if(mstr.utils.ISIE10||mstr.utils.ISW3CIE){H.style.background="linear-gradient("+((C===0)?"to bottom":"to right")+","+L+","+G+")";}}}}}catch(F){microstrategy.errors.log(F);return false;}};var mstrFormatObject={"VLDB Select":{"MCE Join To Get Data Combination":["RWLevelMCEJoin",true,"all"]},ATTR_NAME:3,ScalePagesTall:["FormattingPage","ScalePagesTall",true,"all"],TOCFontItalic:["TableOfContents","FontItalic",true,"all"],HighlightURL:["FormattingPicture","HighlightURL",true,"106"],ExportRange:["RWDocumentProperties","ExportRange",true,"all"],ctlOrientation:["FormattingSelector","Orientation",true,"111"],TableOfContents:{TitleAlignment:["TOCTitleAlignment",true,"all"],FontItalic:["TOCFontItalic",true,"all"],FontStrikeout:["TOCFontStrikeout",true,"all"],FillStyle:["TOCFillStyle",true,"all"],TitleFontName:["TOCTitleFontName",true,"all"],BorderColor:["TOCBorderColor",true,"all"],FontBold:["TOCFontBold",true,"all"],RightIndent:["TOCRightIndent",true,"all"],TitleFontItalic:["TOCTitleFontItalic",true,"all"],UserSeparateStyleForTitle:["TOCTitleEnableInherit",true,"all"],TitleFillColor:["TOCTitleFillColor",true,"all"],TitleFontSize:["TOCTitleFontSize",true,"all"],LeftIndent:["TOCLeftIndent",true,"all"],TitleFontBold:["TOCTitleFontBold",true,"all"],BorderWeight:["TOCBorderWeight",true,"all"],FillColor:["TOCFillColor",true,"all"],BorderStyle:["TOCBorderStyle",true,"all"],ShowTabLeader:["ShowTabLeader",true,"all"],FontColor:["TOCFontColor",true,"all"],TitleFontColor:["TOCTitleFontColor",true,"all"],TitleFillStyle:["TOCTitleFillStyle",true,"all"],Enabled:["Enabled",true,"all"],Title:["Title",true,"all"],TitleFontStrikeout:["TOCTitleFontStrikeout",true,"all"],IncludePageHeaderFooter:["IncludePageHeaderFooter",true,"all"],TitleFontUnderline:["TOCTitleFontUnderline",true,"all"],FontSize:["TOCFontSize",true,"all"],BeforeLayout:["BeforeLayout",true,"all"],FontName:["TOCFontName",true,"all"],FontUnderline:["TOCFontUnderline",true,"all"]},ActionForDirectTargetSelectors:["FormattingSelector","ActionForDirectTargetSelectors",true,"111"],borderRightStyle:["FormattingBorder","RightStyle",false,"102,106,107,52,53,111,8,t,de"],SetBadgeToValueOnField:["FormattingTransactions","SetBadgeToValueOnField",true,"106"],TOCTitleFontName:["TableOfContents","TitleFontName",true,"all"],ShowChangeIndication:["FormattingTransactions","",true,"51,52"],thousandsSeparators:{"3082":".","1033":",","1043":".","2055":"'","1053":" ","1042":",","1031":".","1041":",","2064":"'","1030":".","2052":",","1040":".","2060":".","1028":",","1049":" ","1036":" ","1046":".","1045":" ","2057":",","4108":"'"},borderBottomColor2:["FormattingBorder","Border3DBottomColor",false,"102,106,107,52,53,111,101,8,t,de"],UseAsTableControl:["FormattingLayout","UseAsTableControl",true,"8"],TOCTitleFontBold:["TableOfContents","TitleFontBold",true,"all"],DatasetObjectsWidth:["FormattingAnalysis","DatasetObjectsWidth",true,"4"],zIndex:["FormattingOrder","ZIndex",true,"101,102,105,106,107,52,53,8,111"],IncludeBookmarks:["FormattingPage","IncludeBookmarks",true,"all"],fitExcelRowHeight:["FormattingSection","FitExcelRowHeight",true,"4"],FormattingBorder:{TopStyle:["borderTopStyle",false,"102,106,107,52,53,111,8,t,de","bts","3"],Border3DLeftColor:["borderLeftColor2",false,"102,106,107,52,53,111,101,8,t,de","b3dlc","3"],LeftColor:["borderLeftColor",false,"102,106,107,52,53,111,8,t,de","blc","3"],Border3DBottomColor:["borderBottomColor2",false,"102,106,107,52,53,111,101,8,t,de","b3dbc","3"],RightStyle:["borderRightStyle",false,"102,106,107,52,53,111,8,t,de","brs","3"],RightColor:["borderRightColor",false,"102,106,107,52,53,111,8,t,de","brc","3"],BottomColor:["borderBottomColor",false,"102,106,107,52,53,111,8,t,de","bbc","3"],Border3DWeight:["b3dweight",true,"102,106,107,52,53,111,112,101,8,t,de","b3dweight","3"],Border3DTopColor:["borderTopColor2",false,"102,106,107,52,53,111,101,8,t,de","b3dtc","3"],BottomStyle:["borderBottomStyle",false,"102,106,107,52,53,111,8,t,de","bbs","3"],TopColor:["borderTopColor",false,"102,106,107,52,53,111,8,t,de","btc","3"],LeftStyle:["borderLeftStyle",false,"102,106,107,52,53,111,8,t,de","bls","3"],Border3DRightColor:["borderRightColor2",false,"102,106,107,52,53,111,101,8,t,de","b3drc","3"],Border3DStyle:["b3dstyle",true,"102,106,107,52,53,111,112,101,8,t,de","b3dstyle","3"]},TOCFillColor:["TableOfContents","FillColor",true,"all"],IndependentNodeSelector:["FormattingSelector","IndependentNodeSelector",true,"52"],ViewModeInteractivityLevel:["RWDocumentProperties","ViewModeInteractivityLevel",true,"all"],Orientation:["FormattingPage","Orientation",true,"all"],layoutBarStyle:["RWDocumentProperties","layoutBarStyle",true,"all"],topRightCornerRadius:["FormattingAppearance","TopRightCornerRadius",true,"101,8"],left:["FormattingPosition","Left",false,"101,102,105,106,107,52,53,8,111"],gridShowRH:["FormattingCrosstab","ShowRowHeaders",true,"52"],gradientAngle:["FormattingPatterns","GradientAngle",true,"101,106,107,52,53,4,8,9,111,208"],ExecutionFullScreenMode:["RWDocumentProperties","ExecutionFullScreenMode",true,"all"],lockAspectRatio:["FormattingSize","LockAspectRatio",true,"102,106"],Visualization:{ATabletVisualization:["ATabletVisualization",true,"52","atv"],VisualizationsEnabled:["VisualizationsEnabled",true,"52"],IPhoneVisualization:["IPhoneVisualization",true,"52","iphv"],VisualizationList:["VisualizationList",true,"52"],ViewMode:["ViewMode",true,"52"],FileName:["FileName",true,"52"],SelectedVisualization:["SelectedVisualization",true,"52"],IncludeMDProperties:["IncludeMDProperties",true,"52"],IPadVisualization:["IPadVisualization",true,"52","ipadv"],CustomProps:["CustomProps",true,"52"],VisProps:["VisProps",true,"52"],APhoneVisualization:["APhoneVisualization",true,"52","aphv"]},pictureAlignment:["FormattingPicture","PictureAlignment",true,"102"],ExpandToFit:["FormattingPage","ExpandToFit",true,"all"],FilterDetailsFormatProperties:{FilterDetailsFormat:["FilterDetailsFormat",true,"all"]},titleBarDisplay:["FormattingView","TitleBarDisplay",true,"52,8"],TabMPHF:["FormattingLayout","UseMasterPageHeaderFooter",true,"all"],IsApp:["FormattingWidget","IsApp",true,"52,111"],TOCTitleFontStrikeout:["TableOfContents","TitleFontStrikeout",true,"all"],BackgroundHighlightColor:["FormattingPatterns","HighlightColor",false,"8,106"],b3dstyle:["FormattingBorder","Border3DStyle",true,"102,106,107,52,53,111,112,101,8,t,de"],DisplayConfirmation:["FormattingSelector","DisplayConfirmation",true,"111"],TOCTitleFontItalic:["TableOfContents","TitleFontItalic",true,"all"],EmbedFonts:["FormattingPage","EmbedFonts",true,"all"],widthMode:["FormattingSize","WidthMode",false,"101,102,105,106,107,52,53,8,111"],VisualizationsEnabled:["Visualization","VisualizationsEnabled",true,"52"],b3dweight:["FormattingBorder","Border3DWeight",true,"102,106,107,52,53,111,112,101,8,t,de"],ExpandAllPanels:["FormattingAppearance","ExpandAllPanels",true,"8"],Enabled:["TableOfContents","Enabled",true,"all"],APPLIES_TO:3,SplitPanelAcrossPages:["FormattingAppearance","SplitPanelAcrossPages",true,"8"],showInHTMLViewMode:["FormattingSection","ShowInHTMLViewMode",true,"4"],xTabView:["FormattingUnassigned","xTabView",true,"52"],FormattingHTML:{HTMLText:["htmlText",true,"107","htxt"],HTMLType:["htmlType",true,"107","htype"],URL:["url",true,"107","hsrc"]},isTargetStyleOrAttr:function(E){try{var B=mstrFormatObject.TARGET_VALUE_STYLE;if(!mstrFormatObject[E]){return B;}var D=mstrFormatObject.getPropertySetName(E);var A=mstrFormatObject.getPropertyName(E);if(mstrFormatObject.getAttrNameFromStyle(E)==null||mstrFormatObject.getAttrNameFromStyle(E).length==0){return B;}B=mstrFormatObject.TARGET_VALUE_ATTR;if(mstrFormatObject[D][A][mstrFormatObject.TARGET]&&(parseInt(mstrFormatObject[D][A][mstrFormatObject.TARGET])&(parseInt(mstrFormatObject.TARGET_VALUE_STYLE)+parseInt(mstrFormatObject.TARGET_VALUE_ATTR)))>0){B+=mstrFormatObject.TARGET_VALUE_STYLE;}return B;}catch(C){microstrategy.errors.log(err);}return null;},EnableSwipingToSwitchLayout:["Mobile","EnableSwipingToSwitchLayout",true,"all"],ShowTabsForSingleLayout:["RWDocumentProperties","ShowTabsForSingleLayout",true,"all"],DocumentThemeColor:["Mobile","DocumentThemeColor",true,"all"],DatasetObjectsVisible:["FormattingAnalysis","DatasetObjectsVisible",true,"4"],lengthMode:["FormattingSize","LengthMode",true,"105"],TOCLeftIndent:["TableOfContents","LeftIndent",true,"all"],TOCBorderStyle:["TableOfContents","BorderStyle",true,"all"],CurrencySymbol:["FormattingNumber","CurrencySymbol",true,"100,106,52,t,de"],borderTopStyle:["FormattingBorder","TopStyle",false,"102,106,107,52,53,111,8,t,de"],UseSegments:["FormattingLayout","UseSegments",true,"all"],Blur:["FormattingAppearance","Blur",true,"8"],borderBottomStyle:["FormattingBorder","BottomStyle",false,"102,106,107,52,53,111,8,t,de"],radius:["FormattingAppearance","Radius",true,"101,8"],htmlText:["FormattingHTML","HTMLText",true,"107"],visibility:["FormattingAppearance","Visible",false,"101,102,105,106,107,52,53,4,8,111"],dropShadowDepth:["FormattingAppearance","DropShadowDepth",true,"101,102,105,106,107,53,8,111,52"],lineColor:["FormattingLine","LineColor",false,"101,105"],Duration:["FormattingTransitions","Duration",true,"8,52"],getThousandsSeparator:function(B){try{return mstrFormatObject.thousandsSeparators[B];}catch(A){microstrategy.errors.log(A);return",";}},getAttrNameFromStyle:function(D){try{if(mstrFormatObject[D]){var C=mstrFormatObject[D][mstrFormatObject.PROP_SET];var A=mstrFormatObject[D][mstrFormatObject.PROP_NAME];if(C&&A){return mstrFormatObject[C][A][mstrFormatObject.ATTR_NAME];}}}catch(B){microstrategy.errors.log(err);}return null;},ShowHiddenObjects:["RWDocumentProperties","ShowHiddenObjects",true,"all"],backgroundStyle:["FormattingPatterns","FillStyle",false,"101,106,107,52,53,4,8,9,111,208"],oldWidth:["FormattingSize","OldWidth",false,"52"],canGrow:["FormattingSize","CanGrow",true,"4"],canShrink:["FormattingSize","CanShrink",true,"4"],FormattingSection:{KeepSectionTogether:["keepSectionTogether",true,"4","kst"],FitExcelRowHeight:["fitExcelRowHeight",true,"4","ferh"],ForceNewPage:["forceNewPage",true,"4","fnp"],HideIfEmpty:["hideIfEmpty",true,"4","he"],DockSection:["docked",true,"dsec","docked"],RepeatHorizontally:["repeatHorizontally",true,"4","rpth"],ShowInHTMLViewMode:["showInHTMLViewMode",true,"4","shvm"],RepeatSection:["repeatSection",true,"4","rpts"],Expanded:["expanded",true,"none"]},quickSwitch:["FormattingCrosstab","Prefetch",true,"52"],FormattingAlignment:{Vertical:["verticalAlign",false,"52,106,107,111,t,de","vta","3"],Horizontal:["textAlign",false,"106,111,107,t,de"],TextDirection:["TextDirection",true,"52,106,107,t,de","td","3"],Horizontal2:["textAlign2",false,"52"],Vertical2:["verticalAlign2",false,"52","vta2","3"],TextWrap:["whiteSpace",false,"52,106,107,t,de"]},title:["FormattingAppearance","TooltipText",true,"101,102,105,106,107,52,53,8,111"],TabColor:["FormattingLayout","TabColor",false,"all"],expanded:["FormattingSection","Expanded",true,"none"],AnalysisSection:["FormattingAnalysis","AnalysisSection",true,"8,52"],getPxFromPt:function(A){return parseFloat(A)*(microstrategy.DPI_CONVERSION/72);},EditableViewMode:["FormattingPage","EditableViewMode",true,"all"],DisplayPageByBar:["FormattingLayout","DisplayPageByBar",true,"all"],whiteSpace:["FormattingAlignment","TextWrap",false,"52,106,107,t,de"],TOCTitleFontColor:["TableOfContents","TitleFontColor",true,"all"],length:["FormattingSize","Length",true,"105"],ImageScale:["WatermarkProperties","ImageScale",true,"all"],KeepControlTargetsConsistent:["AnalyticalEngineProperties","KeepControlTargetsConsistent",true,"all"],TARGET_VALUE_ATTR:2,VisualizationList:["Visualization","VisualizationList",true,"52"],ExcelExportDocumentURL:["RWDocumentProperties","ExcelExportDocumentURL",true,"all"],repeatHorizontally:["FormattingSection","RepeatHorizontally",true,"4"],ScalePercentage:["FormattingPage","ScalePercentage",true,"all"],CustomProps:["Visualization","CustomProps",true,"52"],EnableCopyForText:["Mobile","EnableCopyForText",true,"all"],showOnlyInRepeatingCopies:["FormattingAppearance","ShowOnlyInRepeatingCopies",true,"101,102,105,106,107,52,53,8,111"],mouseOverAction:["FormattingSelector","MouseOverAction",true,"111"],OnDemandEvaluation:["RWDExecution","OnDemandEvaluation",true,"all"],RefreshFrequency:["Mobile","RefreshFrequency",true,"all"],TextOverflow:["FormattingSize","TextOverflow",false,"106,8"],AvailableViewModes:["FormattingPage","AvailableViewModes",true,"all"],SubmitMessage:["FormattingSelector","SubmitMessage",true,"111"],ViewMode:["Visualization","ViewMode",true,"52"],gridPosition:["FormattingCrosstab","GridPosition",true,"52"],MarginBottom:["FormattingPage","MarginBottom",true,"all"],oldHeight:["FormattingSize","OldHeight",false,"52"],FormattingSelector:{NoSelectionBehavior:["NoSelectionBehavior",true,"111","nsb"],ShowElementCount:["showElementCount",true,"111","sec"],IndependentNodeSelector:["IndependentNodeSelector",true,"52"],MetricConditionType:["mct",true,"111"],Include:["Include",true,"111"],MaxSelectionCount:["MaxSelectionCount",true,"111","masc"],ActionForDirectTargetSelectors:["ActionForDirectTargetSelectors",true,"111","adts"],Orientation:["ctlOrientation",true,"111"],SearchOnServer:["SearchOnServer",true,"111","sos"],ExportAsShownOnWeb:["ExportAsShownOnWeb",true,"111","aow"],ItemWidthMode:["ItemWidthMode",true,"111"],InformationWindowTarget:["InformationWindowTarget",true,"102,106,111","ifw"],OfflineSubmission:["OfflineSubmission",true,"111"],SubmitMessage:["SubmitMessage",true,"111"],MouseOverAction:["mouseOverAction",true,"111"],DisplayText:["DisplayText",true,"111"],Style:["Style",true,"111"],TXNSubmitInOrder:["TXNSubmitInOrder",true,"111"],Multiselect:["Multiselect",true,"52,111"],ShowSummary:["ShowSummary",true,"111"],DisplaySelectorDocked:["DisplaySelectorDocked",true,"111"],DisplayConfirmation:["DisplayConfirmation",true,"111"],MinSelectionCount:["MinSelectionCount",true,"111","misc"]},getPropertyName:function(A){return mstrFormatObject[A][mstrFormatObject.PROP_NAME];},maxWidth:["FormattingSize","MaxWidth",false,"4"],verticalAlign:["FormattingAlignment","Vertical",false,"52,106,107,111,t,de"],verticalAlign2:["FormattingAlignment","Vertical2",false,"52"],GraphFormat:["FormattingPage","GraphFormat",true,"all"],FormattingPadding:{LineSpacing:["lineHeight",false,"106,t"],RightPadding:["paddingRight",false,"52,106,t,de"],TopPadding:["paddingTop",false,"52,106,t,de"],BottomPadding:["paddingBottom",false,"52,106,t,de"],LeftPadding:["paddingLeft",false,"52,106,t,de"]},PromptUserForPagebyExport:["RWDocumentProperties","PromptUserForPagebyExport",true,"all"],UsePageWidthAsLayoutWidth:["FormattingPage","UsePageWidthAsLayoutWidth",true,"all"],fontStyle:["FormattingFont","Italic",false,"52,106,107,111,8,t,de,df"],IncludePageHeaderFooter:["TableOfContents","IncludePageHeaderFooter",true,"all"],PrintHeaderOn:["FormattingPage","PrintHeaderOn",true,"all"],UseOneSheetPerPage:["FormattingGroup","UseOneSheetPerPage",true,"all"],borderLeftColor2:["FormattingBorder","Border3DLeftColor",false,"102,106,107,52,53,111,101,8,t,de"],topCornersOnly:["FormattingAppearance","TopCornersOnly",true,"101,8"],InformationWindowPlacement:["FormattingView","InformationWindowPlacement",true,"8"],fontSize:["FormattingFont","Size",false,"52,106,107,111,8,t,de,df"],EnableCopyForGridCell:["Mobile","EnableCopyForGridCell",true,"all"],paddingLeft:["FormattingPadding","LeftPadding",false,"52,106,t,de"],TOCWidth:["FormattingAnalysis","TOCWidth",true,"4"],ZoomType:["RWDocumentProperties","ZoomType",true,"all"],FitPDFContentHeight:["FormattingLayout","FitPDFContentHeight",true,"all"],DisplayInPartialScreen:["FormattingView","DisplayInPartialScreen",true,"8"],keepSectionTogether:["FormattingSection","KeepSectionTogether",true,"4"],top:["FormattingPosition","Top",false,"101,102,105,106,107,52,53,8,111"],FormattingAppearance:{BottomRightCornerRadius:["bottomRightCornerRadius",true,"101,8","brcr"],Radius:["radius",true,"101,8","rd"],Transparency:["Transparency",true,"8","trpr"],BottomLeftCornerRadius:["bottomLeftCornerRadius",true,"101,8","blcr"],TopCornersOnly:["topCornersOnly",true,"101,8","tco"],DisplayStyle:["DisplayStyle",true,"106","dpst"],TopLeftCornerRadius:["topLeftCornerRadius",true,"101,8","tlcr"],ExpandAllPanels:["ExpandAllPanels",true,"8","ep"],SplitPanelAcrossPages:["SplitPanelAcrossPages",true,"8","spcp"],ShowOnlyInRepeatingCopies:["showOnlyInRepeatingCopies",true,"101,102,105,106,107,52,53,8,111","sirc"],TooltipText:["title",true,"101,102,105,106,107,52,53,8,111","title"],Name:["name",true,"101,102,105,106,107,52,53,4,8,111","nm"],DropShadowDepth:["dropShadowDepth",true,"101,102,105,106,107,53,8,111,52","dsw","3"],TopRightCornerRadius:["topRightCornerRadius",true,"101,8","trcr"],IgnoreInExport:["IgnoreInExport",true,"8","cone"],RepeatPanelSpacing:["RepeatPanelSpacing",true,"8","povfs"],DropShadowEffect:["dropShadowEffect",true,"101,102,105,106,107,53,8,111,52","dse","3"],Visible:["visibility",false,"101,102,105,106,107,52,53,4,8,111","visible"],Blur:["Blur",true,"8","blur"],FormatVersion:["formatVersion",true,"52","fmtv"],HasRoundedCorners:["hasRoundedCorners",true,"101,8","rc"]},lineWeight:["FormattingLine","LineWeight",false,"101,105"],RWDocumentProperties:{ZoomFactor:["zoom",false,"all"],ZoomType:["ZoomType",true,"all"],ShowTabsForSingleLayout:["ShowTabsForSingleLayout",true,"all"],enableGraphTooltips:["enableGraphTooltips",true,"all"],ExportRange:["ExportRange",true,"all"],EmbeddedFonts:["EmbeddedFonts",true,"all"],CtlAutoSubmit:["CtlAutoSubmit",true,"all"],layoutBarPosition:["layoutBarPosition",true,"all"],SmartClientDoc:["SmartClientDoc",true,"all"],PreserveTranslations:["PreserveTranslations",true,"all"],DocumentVersion:["DocumentVersion",true,"all"],SelectorBehavior:["SelectorBehavior",true,"all"],OfflineOnCube:["OfflineOnCube",true,"all"],LayoutStyle:["LayoutStyle",true,"all"],IsNavigationDocument:["IsNavigationDocument",true,"all"],ApplyGBToAllLayouts:["ApplyGBToAllLayouts",true,"all"],PromptUserForPagebyExport:["PromptUserForPagebyExport",true,"all"],ViewModeInteractivityLevel:["ViewModeInteractivityLevel",true,"all"],layoutBarStyle:["layoutBarStyle",true,"all"],ExcelEmbedImages:["ExcelEmbedImages",true,"all"],PDFExportDocumentURL:["PDFExportDocumentURL",true,"all"],ShowFloatingToolbars:["ShowFloatingToolbars",true,"all"],CalculateDocWidth:["CalculateDocWidth",true,"all"],DefaultPageByExportMode:["DefaultPageByExportMode",true,"all"],ShowHiddenObjects:["ShowHiddenObjects",true,"all"],ExcelExportDocumentURL:["ExcelExportDocumentURL",true,"all"],PreLoadAllPanels:["PreLoadAllPanels",true,"all"],ExecutionFullScreenMode:["ExecutionFullScreenMode",true,"all"],ExcelGraphFormat:["ExcelGraphFormat",true,"all"],ShowingBarsTemporarily:["ShowingBarsTemporarily",true,"all"]},Style:["FormattingSelector","Style",true,"111"],borderRightColor2:["FormattingBorder","Border3DRightColor",false,"102,106,107,52,53,111,101,8,t,de"],textDecoration2:["FormattingFont","Strikeout",false,"52,106,107,111,8,208,t,de,df"],borderLeftColor:["FormattingBorder","LeftColor",false,"102,106,107,52,53,111,8,t,de"],MarginRight:["FormattingPage","MarginRight",true,"all"],TableControlDefinition:["FormattingLayout","TableControlDefinition",true,"8"],Text:["WatermarkProperties","Text",true,"all"],borderLeftStyle:["FormattingBorder","LeftStyle",false,"102,106,107,52,53,111,8,t,de"],Mobile:{EnableBookStylePagebyNavigation:["EnableBookStylePagebyNavigation",true,"all"],EnableCopyForText:["EnableCopyForText",true,"all"],DocumentThemeColor:["DocumentThemeColor",true,"all"],EnableExport:["EnableExport",true,"all"],EnableSwipingToSwitchLayout:["EnableSwipingToSwitchLayout",true,"all"],EnableZoom:["EnableZoom",true,"all"],EnableCopyForGridCell:["EnableCopyForGridCell",true,"all"],View:["MobileDataView",true,"all"],RefreshFrequency:["RefreshFrequency",true,"all"]},url:["FormattingHTML","URL",true,"107"],DecimalPlaces:["FormattingNumber","DecimalPlaces",true,"100,106,52,t,de"],ATabletVisualization:["Visualization","ATabletVisualization",true,"52"],TOCTitleFillColor:["TableOfContents","TitleFillColor",true,"all"],DisplayText:["FormattingSelector","DisplayText",true,"111"],FormattingOrder:{ZIndex:["zIndex",true,"101,102,105,106,107,52,53,8,111"]},Transition:["FormattingTransitions","Transition",true,"8,52"],showTitleBar:["FormattingView","ShowTitleBar",true,"52,8,111"],gridIfRowMode:["FormattingIncrementalFetch","RowIFMode",true,"52"],TOCBorderColor:["TableOfContents","BorderColor",true,"all"],TOCFontName:["TableOfContents","FontName",true,"all"],FormattingWidget:{SecondaryDataProviders:["SecondaryDataProviders",true,"52,111"],NonFlashRender:["NonFlashRender",true,"52","nfr","2"],RSLPath:["RSLPath",true,"52,111"],ClassName:["ClassName",true,"52,111","twc","2"],Enable:["Enable",true,"52,111"],DhtmlRenderer:["DhtmlRenderer",true,"52","dr","2"],WidgetProps:["WidgetProps",true,"52,111","wp"],IsApp:["IsApp",true,"52,111"]},TOCFontBold:["TableOfContents","FontBold",true,"all"],DefaultGridStyle:["FormattingPage","DefaultGridStyle",true,"all"],DropZonesWidth:["FormattingAnalysis","DropZonesWidth",true,"8"],MarginTop:["FormattingPage","MarginTop",true,"all"],EnableBookStylePagebyNavigation:["Mobile","EnableBookStylePagebyNavigation",true,"all"],paddingBottom:["FormattingPadding","BottomPadding",false,"52,106,t,de"],PROP_NAME:1,locked:["FormattingPosition","Locked",true,"101,102,105,106,107,52,53,8,111"],MinSelectionCount:["FormattingSelector","MinSelectionCount",true,"111"],InitialSlidingInHeight:["FormattingView","InitialSlidingInHeight",true,"8"],mct:["FormattingSelector","MetricConditionType",true,"111"],OfflineOnCube:["RWDocumentProperties","OfflineOnCube",true,"all"],TabCloseToDismissInfoWindow:["FormattingView","TabCloseToDismissInfoWindow",true,"8"],RemoveMissingUnits:["AnalyticalEngineProperties","RemoveMissingUnits",true,"all"],textAlign:["FormattingAlignment","Horizontal",false,"106,111,107,t,de"],decimalSeparators:{"3082":",","1033":".","1043":",","2055":".","1053":",","1042":".","1031":",","1041":".","2064":".","1030":",","2052":".","1040":",","2060":",","1028":".","1049":",","1036":",","1046":",","1045":",","2057":".","4108":"."},PSPreLoadAllPanels:["FormattingIncrementalFetch","PreLoadAllPanels",true,"8"],ShowBookmarks:["FormattingPage","ShowBookmarks",true,"all"],bottomRightCornerRadius:["FormattingAppearance","BottomRightCornerRadius",true,"101,8"],Collapsed:["FormattingAnalysis","Collapsed",true,"111"],TOCFontUnderline:["TableOfContents","FontUnderline",true,"all"],RWDExecution:{OnDemandEvaluation:["OnDemandEvaluation",true,"all"]},WatermarkFontStrikeout:["WatermarkProperties","FontStrikeout",true,"all"],VisProps:["Visualization","VisProps",true,"52"],TOCBorderWeight:["TableOfContents","BorderWeight",true,"all"],gradientColor:["FormattingPatterns","GradientColor",false,"101,106,107,52,53,4,8,9,111,208"],USE_VALUE:2,DefaultViewMode:["FormattingPage","DefaultViewMode",true,"all"],windowTitle:["FormattingView","Title",true,"52,8,9,111"],EmbeddedFonts:["RWDocumentProperties","EmbeddedFonts",true,"all"],FormattingFont:{Italic:["fontStyle",false,"52,106,107,111,8,t,de,df"],Strikeout:["textDecoration2",false,"52,106,107,111,8,208,t,de,df"],Size:["fontSize",false,"52,106,107,111,8,t,de,df"],Color:["color",false,"52,106,107,111,8,t,de,df"],Underline:["textDecoration",false,"52,106,107,111,8,208,t,de,df"],Bold:["fontWeight",false,"52,106,107,111,8,t,de,df"],HighlightColor:["FontHighlightColor",false,"106","fhlc"],Name:["fontFamily",true,"52,106,107,111,8,t,de,df"]},FormattingTransitions:{Transition:["Transition",true,"8,52","ttr","2"],Enable:["EnableTransition",true,"8,52"],Duration:["Duration",true,"8,52","tdr","2"]},borderBottomColor:["FormattingBorder","BottomColor",false,"102,106,107,52,53,111,8,t,de"],SmartClientDoc:["RWDocumentProperties","SmartClientDoc",true,"all"],WatermarkFontSize:["WatermarkProperties","FontSize",true,"all"],ScalePageHeaderFooter:["FormattingPage","ScalePageHeaderFooter",true,"all"],Format:["FormattingNumber","Format",true,"100,106,52,t,de"],FormattingLine:{LineStyle:["lineStyle",false,"101,105","ls","3"],LineOrientation:["orientation",false,"105","or"],LineWeight:["lineWeight",false,"101,105","lw","3"],LineColor:["lineColor",false,"101,105","lc","3"]},SelectorBehavior:["RWDocumentProperties","SelectorBehavior",true,"all"],ThousandSeparator:["FormattingNumber","ThousandSeparator",true,"100,106,52,t,de"],repeatSection:["FormattingSection","RepeatSection",true,"4"],isLink:["FormattingNavigation","IsHyperlink",true,"102,106"],UseAsMasterPanel:["FormattingLayout","UseAsMasterPanel",true,"8"],NoSelectionBehavior:["FormattingSelector","NoSelectionBehavior",true,"111"],getDecimalSeparator:function(B){try{return mstrFormatObject.decimalSeparators[B];}catch(A){microstrategy.errors.log(A);return".";}},FormattingSize:{CanShrink:["canShrink",true,"4","cs"],OldWidth:["oldWidth",false,"52","oldwd","3"],CanShrinkHorizontal:["canShrinkHorizontal",true,"4","csh"],OldHeight:["oldHeight",false,"52","oldht","3"],LengthMode:["lengthMode",true,"105"],HeightMode:["heightMode",false,"101,102,105,106,107,52,53,111,8","hm"],TextOverflow:["TextOverflow",false,"106,8","tovf"],CanGrow:["canGrow",true,"4","cg"],LockAspectRatio:["lockAspectRatio",true,"102,106"],WidthMode:["widthMode",false,"101,102,105,106,107,52,53,8,111","wm"],MaxWidth:["maxWidth",false,"4","mw"],Length:["length",true,"105","cs"],AutoResizeInDesign:["autoResizeInDesign",true,"106","ard"],Height:["height",false,"101,102,105,106,107,52,53,4,8,111,4","ht","3"],MaxHeight:["maxHeight",false,"4","mh"],Width:["width",false,"101,102,105,106,107,52,53,8,111,4","wd","3"],CanGrowHorizontal:["canGrowHorizontal",true,"4","cgh"]},src:["FormattingUnassigned","src",true,"102"],WatermarkFontItalic:["WatermarkProperties","FontItalic",true,"all"],bottomLeftCornerRadius:["FormattingAppearance","BottomLeftCornerRadius",true,"101,8"],TOCFillStyle:["TableOfContents","FillStyle",true,"all"],ImageSource:["WatermarkProperties","ImageSource",true,"all"],TOCTitleFontUnderline:["TableOfContents","TitleFontUnderline",true,"all"],FormattingAnalysis:{TOCWidth:["TOCWidth",true,"4"],Collapsed:["Collapsed",true,"111"],DatasetObjectsVisible:["DatasetObjectsVisible",true,"4"],DropZonesVisible:["DropZonesVisible",true,"8"],DatasetObjectsWidth:["DatasetObjectsWidth",true,"4"],FilterMode:["FilterMode",true,"8"],AnalysisSection:["AnalysisSection",true,"8,52"],DropZonesWidth:["DropZonesWidth",true,"8"],TOCVisible:["TOCVisible",true,"4"],FilterDisplay:["FilterDisplay",true,"8"],DatasetsSettings:["DatasetsSettings",true,"4"]},IPhoneVisualization:["Visualization","IPhoneVisualization",true,"52"],enableGraphTooltips:["RWDocumentProperties","enableGraphTooltips",true,"all"],paddingRight:["FormattingPadding","RightPadding",false,"52,106,t,de"],ShowWidgetTitleBar:["FormattingView","ShowWidgetTitleBar",true,"52"],WatermarkFontScript:["WatermarkProperties","FontScript",true,"all"],TextDirection:["FormattingAlignment","TextDirection",true,"52,106,107,t,de"],PROP_SET:0,TOCTitleEnableInherit:["TableOfContents","UserSeparateStyleForTitle",true,"all"],ShowSummary:["FormattingSelector","ShowSummary",true,"111"],TOCVisible:["FormattingAnalysis","TOCVisible",true,"4"],gridArea:["FormattingCrosstab","GridAreaPercent",true,"52"],height:["FormattingSize","Height",false,"101,102,105,106,107,52,53,4,8,111,4"],LayoutStyle:["RWDocumentProperties","LayoutStyle",true,"all"],AnalyticalEngineProperties:{RemoveNullGroups:["RemoveNullGroups",true,"all"],TrimEmptySections:["TrimNoSectionData",true,"all"],RemoveMissingUnits:["RemoveMissingUnits",true,"all"],KeepControlTargetsConsistent:["KeepControlTargetsConsistent",true,"all"],SingleSourceGrid:["SingleSourceGrid",true,"all"]},ShowTabLeader:["TableOfContents","ShowTabLeader",true,"all"],TextWashout:["WatermarkProperties","TextWashout",true,"all"],textDecoration:["FormattingFont","Underline",false,"52,106,107,111,8,208,t,de,df"],ScalePagesWide:["FormattingPage","ScalePagesWide",true,"all"],StyleForSwitchingPanel:["FormattingView","StyleForSwitchingPanel",true,"8"],SearchOnServer:["FormattingSelector","SearchOnServer",true,"111"],PDFExportDocumentURL:["RWDocumentProperties","PDFExportDocumentURL",true,"all"],TrimNoSectionData:["AnalyticalEngineProperties","TrimEmptySections",true,"all"],FormattingPicture:{NormalURL:["NormalURL",true,"106","nmurl"],HighlightURL:["HighlightURL",true,"106","hlurl"],PictureMode:["pictureMode",true,"102"],PictureAlignment:["pictureAlignment",true,"102"]},TOCFontColor:["TableOfContents","FontColor",true,"all"],FilterDetailsFormat:["FilterDetailsFormatProperties","FilterDetailsFormat",true,"all"],TextOrientation:["WatermarkProperties","TextOrientation",true,"all"],LayoutWidth:["FormattingPage","Width",true,"all"],FileName:["Visualization","FileName",true,"52"],CtlAutoSubmit:["FormattingLayout","CtlAutoSubmit",true,"8"],UseAsInfoWindow:["FormattingLayout","UseAsInfoWindow",true,"all"],borderTopColor2:["FormattingBorder","Border3DTopColor",false,"102,106,107,52,53,111,101,8,t,de"],exportOptions:["FormattingCrosstab","ShowExportOptions",true,"52"],lineStyle:["FormattingLine","LineStyle",false,"101,105"],maxHeight:["FormattingSize","MaxHeight",false,"4"],HTML_USE_VALUE:1,WatermarkProperties:{WatermarkType:["WatermarkType",true,"all"],FontScript:["WatermarkFontScript",true,"all"],TextOrientation:["TextOrientation",true,"all"],AutoFontSize:["AutoFontSize",true,"all"],FontItalic:["WatermarkFontItalic",true,"all"],FontStrikeout:["WatermarkFontStrikeout",true,"all"],FontColor:["WatermarkFontColor",true,"all"],TextWashout:["TextWashout",true,"all"],FontBold:["WatermarkFontBold",true,"all"],Text:["Text",true,"all"],ImageScale:["ImageScale",true,"all"],FontSize:["WatermarkFontSize",true,"all"],FontName:["WatermarkFontName",true,"all"],ImageSource:["ImageSource",true,"all"],FontUnderline:["WatermarkFontUnderline",true,"all"]},Enable:["FormattingWidget","Enable",true,"52,111"],EnableTransition:["FormattingTransitions","Enable",true,"8,52"],htmlType:["FormattingHTML","HTMLType",true,"107"],backgroundColor:["FormattingPatterns","FillColor",false,"101,106,107,52,53,4,8,9,111,208,t,de"],CurrencyPosition:["FormattingNumber","CurrencyPosition",true,"100,106,52,t,de"],ShowAsCollapsiblePanel:["FormattingView","ShowAsCollapsiblePanel",true,"8"],IsNavigationDocument:["RWDocumentProperties","IsNavigationDocument",true,"all"],ApplyGBToAllLayouts:["RWDocumentProperties","ApplyGBToAllLayouts",true,"all"],gridIfEnabled:["FormattingIncrementalFetch","EnableIFOnGrid",true,"52"],textAlign2:["FormattingAlignment","Horizontal2",false,"52"],InformationWindowTarget:["FormattingSelector","InformationWindowTarget",true,"102,106,111"],canGrowHorizontal:["FormattingSize","CanGrowHorizontal",true,"4"],RepeatPanelSpacing:["FormattingAppearance","RepeatPanelSpacing",true,"8"],canShrinkHorizontal:["FormattingSize","CanShrinkHorizontal",true,"4"],FontHighlightColor:["FormattingFont","HighlightColor",false,"106"],hasRoundedCorners:["FormattingAppearance","HasRoundedCorners",true,"101,8"],Scaling:["FormattingPage","Scaling",true,"all"],PreLoadAllPanels:["RWDocumentProperties","PreLoadAllPanels",true,"all"],TARGET:4,selectionColor:["FormattingPatterns","SelectorSelectionColor",false,"52,111"],BlackAndWhite:["FormattingPage","BlackAndWhite",true,"all"],DropZonesVisible:["FormattingAnalysis","DropZonesVisible",true,"8"],borderRightColor:["FormattingBorder","RightColor",false,"102,106,107,52,53,111,8,t,de"],TOCTitleFontSize:["TableOfContents","TitleFontSize",true,"all"],MobileDataView:["Mobile","View",true,"all"],UseAsFilterPanel:["FormattingLayout","UseAsFilterPanel",true,"8"],InitialSlidingInWidth:["FormattingView","InitialSlidingInWidth",true,"8"],name:["FormattingAppearance","Name",true,"101,102,105,106,107,52,53,4,8,111"],EnableExport:["Mobile","EnableExport",true,"all"],decodeValue:function(A,H){try{if((A in mstrFormatObject)&&mstrFormatObject[A][mstrFormatObject.USE_VALUE]){return H;}var B=function(J,K){if(K!=undefined&&(J==null||J.length==0)){return K+"px";}else{if(J=="auto"||J=="100%"){return J;}else{return(parseFloat(microstrategy.number.toString(J))*microstrategy.DPI_CONVERSION*(microstrategy.ZOOM_FACTOR/100))+"px";}}};var E=function(J,K){if(K!=undefined&&(J==null||J.length==0)){J=K;}return parseFloat(J)*(microstrategy.ZOOM_FACTOR/100)+"pt";};var C=function(K,N){if(K==null||K.length==0){return(N!=undefined)?N:null;}if(K=="-1"){return"transparent";}else{if(K=="-2"){return -2;}else{var J=parseInt(K).toString(16);for(var M=0,L=J.length;M<6-L;M++){J="0"+J;}return"#"+J.substring(4)+J.substring(2,4)+J.substring(0,2);}}};var F={0:"0pt solid",8:"0pt none",3:"1pt dashed",4:"1pt dotted",5:"1.5pt solid",6:"2.5pt double",1:"1pt solid",7:"0.5pt solid"};var G=function(K){K=F[K]||"";if(K==null||K==""){return"";}var J=K.indexOf("pt");return(K.substring(0,J)*(microstrategy.ZOOM_FACTOR/100))+K.substring(J);};H=String(H);var I=H.toLowerCase();switch(A){case"top":return B(I);case"left":return B(I);case"width":return B(I);case"height":return B(I);case"oldWidth":case"oldHeight":case"heightMode":return I;case"widthMode":return I;case"maxHeight":return B(I);case"maxWidth":return B(I);case"TextOverflow":switch(I){case"-1":return"auto";case"0":return"hidden";}case"visibility":switch(I){case"-1":return"visible";case"0":return"hidden";}case"textAlign":switch(I){case"1":return"right";case"2":return"center";case"6":return"justify";default:return"left";}case"textAlign2":switch(I){case"4":return"right";case"3":return"center";case"6":return"justify";default:return"left";}case"verticalAlign":switch(I){case"1":return"middle";case"2":return"bottom";default:return"top";}case"verticalAlign2":switch(I){case"2":return"middle";case"3":return"bottom";default:return"top";}case"whiteSpace":switch(I){case"0":return"nowrap";default:return"normal";}case"fontSize":return E(I);case"color":return C(I,"");case"fontWeight":switch(I){case"-1":return"bold";default:return"normal";}case"fontStyle":switch(I){case"-1":return"italic";default:return"normal";}case"textDecoration":return(I==null||I.length==0||I=="0")?null:"underline";case"textDecoration2":return(I==null||I.length==0||I=="0")?null:"line-through";case"FontHighlightColor":return C(I);case"backgroundColor":return C(I,"");case"backgroundStyle":if(I==null||I.length==0){return null;}else{return(I=="1")?"transparent":"0";}case"gradientColor":return C(I);case"selectionColor":return C(I);case"BackgroundHighlightColor":return C(I);case"borderTopColor2":return C(I);case"borderRightColor2":return C(I);case"borderBottomColor2":return C(I);case"borderLeftColor2":return C(I);case"borderTopColor":return C(I);case"borderRightColor":return C(I);case"borderBottomColor":return C(I);case"borderLeftColor":return C(I);case"borderTopStyle":return G(I);case"borderRightStyle":return G(I);case"borderBottomStyle":return G(I);case"borderLeftStyle":return G(I);case"paddingLeft":return E(I);case"paddingRight":return E(I);case"paddingTop":return E(I);case"paddingBottom":return E(I);case"lineHeight":return(I==null||I.length==0||I=="0"||I=="")?"normal":parseFloat(I)+"in";case"lineStyle":switch(I){case"2":return"dashed";case"3":return"dotted";case"4":return"double";case"0":return"none";default:return"solid";}case"lineColor":return C(I,"");case"lineWeight":return E(I);case"orientation":switch(I){case"1":return"border-left";default:return"border-top";}case"PaperType":switch(I){case"1":return"2A,46.81,66.18";case"2":return"A0,33.11,46.81";case"3":return"A1,23.39,33.11";case"4":return"A2,16.54,23.39";case"5":return"A3,11.69,16.54";case"6":return"A4,8.27,11.69";case"7":return"A5,5.83,8.27";case"8":return"A6,4.13,5.83";case"9":return"A7,2.91,4.13";case"10":return"A8,2.09,2.91";case"11":return"C,17,22";case"12":return"D,22,34";case"13":return"E,34,44";case"14":return"Executive,7.25,10.5";case"15":return"F,28,40";case"16":return"Ledger,11,17";case"17":return"Legal,8.5,14";case"18":return"Letter,8.5,11";case"19":return"Super A3/B,13,19";case"20":return"Folio,8.5,13";default:return"Custom";}case"zoom":return parseFloat(microstrategy.number.toString(I));case"TabColor":return C(I,"");}}catch(D){microstrategy.errors.log(D);return H;}},FormattingGroup:{UseOneSheetPerPage:["UseOneSheetPerPage",true,"all"]},FormattingUnassigned:{src:["src",true,"102","src"],xTabView:["xTabView",true,"52","xTabView"]},DisplaySelectorDocked:["FormattingSelector","DisplaySelectorDocked",true,"111"],MarginLeft:["FormattingPage","MarginLeft",true,"all"],showElementCount:["FormattingSelector","ShowElementCount",true,"111"],forceNewPage:["FormattingSection","ForceNewPage",true,"4"],color:["FormattingFont","Color",false,"52,106,107,111,8,t,de,df"],TOCTitleAlignment:["TableOfContents","TitleAlignment",true,"all"],FillEffect:["FormattingPatterns","FillEffect",true,"106"],SupportedOrientations:["FormattingLayout","SupportedOrientations",true,"all"],DhtmlRenderer:["FormattingWidget","DhtmlRenderer",true,"52"],UseOneSheetPerGroupElement:["FormattingPage","UseOneSheetPerGroupElement",true,"all"],getPropertySetName:function(A){return mstrFormatObject[A][mstrFormatObject.PROP_SET];},gradientXOffset:["FormattingPatterns","GradientXOffset",true,"101,106,107,52,53,4,8,9,111,208"],WatermarkFontUnderline:["WatermarkProperties","FontUnderline",true,"all"],ClassName:["FormattingWidget","ClassName",true,"52,111"],FormattingCrosstab:{ShowExportOptions:["exportOptions",true,"52","seo"],ExportOverflowMode:["gridExportOverFlow",true,"52","xovf","2"],OverflowMode:["gridOverFlow",true,"52","ovf","2"],GridPosition:["gridPosition",true,"52"],GridAreaPercent:["gridArea",true,"52"],Prefetch:["quickSwitch",true,"52"],ShowRowHeaders:["gridShowRH",true,"52"],ShowColHeaders:["gridShowCH",true,"52"]},paddingTop:["FormattingPadding","TopPadding",false,"52,106,t,de"],AutoFontSize:["WatermarkProperties","AutoFontSize",true,"all"],Title:["TableOfContents","Title",true,"all"],FormattingPosition:{Locked:["locked",true,"101,102,105,106,107,52,53,8,111","lck"],Left:["left",false,"101,102,105,106,107,52,53,8,111"],Top:["top",false,"101,102,105,106,107,52,53,8,111"]},gradientYOffset:["FormattingPatterns","GradientYOffset",true,"101,106,107,52,53,4,8,9,111,208"],encodeValue:function(A,H){try{if((A in mstrFormatObject)&&mstrFormatObject[A][mstrFormatObject.USE_VALUE]){return H;}var B=function(J,K){if(K!=undefined&&(J==null||J.length==0)){return parseInt(K,10);}else{if(J=="auto"||J=="100%"){return J;}else{return microstrategy.number.toLocaleString(parseFloat(I)/(microstrategy.DPI_CONVERSION*microstrategy.ZOOM_FACTOR/100));}}};var F=function(J,K){if(K!=undefined&&(J==null||J.length==0)){J=K;}return parseFloat(microstrategy.number.toString(J,false))/(microstrategy.ZOOM_FACTOR/100);};var C=function(J,K){if(K!=undefined&&(J==null||J.length==0||J=="undefined")){J=K;}if(J=="transparent"){return -1;}else{if(J==-2){return -2;}else{return parseInt(J.substring(5)+J.substring(3,5)+J.substring(1,3),16);}}};var D=function(J,K){return(J!=null&&J.indexOf(K)>-1)?"-1":"0";};var G=function(K){K=K||"";if(K!=""){var J=K.indexOf("pt");K=((K.substring(0,J)/(microstrategy.ZOOM_FACTOR/100))+"").substring(0,Math.min(J,3))+K.substring(J);}switch(K){case"0pt solid":return"0";case"0pt none":return"8";case"1pt dashed":return"3";case"1pt dotted":return"4";case"1.5pt solid":return"5";case"2.5pt double":return"6";case"1pt solid":return"1";case"0.5pt solid":return"7";default:return"-1";}};H=String(H);var I=H.toLowerCase();switch(A){case"top":return B(I);case"left":return B(I);case"width":return B(I);case"height":return B(I);case"oldWidth":case"oldHeight":case"heightMode":return I;case"widthMode":return I;case"maxHeight":return B(I);case"maxWidth":return B(I);case"TextOverflow":switch(I){case"auto":return"-1";case"hidden":return"0";}case"visibility":switch(I){case"visible":return"-1";case"hidden":return"0";}case"textAlign":switch(I){case"right":return"1";case"center":return"2";case"justify":return"6";default:return"0";}case"textAlign2":switch(I){case"right":return"4";case"center":return"3";case"justify":return"6";default:return"2";}case"verticalAlign":switch(I){case"middle":return"1";case"bottom":return"2";default:return"0";}case"verticalAlign2":switch(I){case"middle":return"2";case"bottom":return"3";default:return"1";}case"whiteSpace":switch(I){case"nowrap":return"0";default:return"-1";}case"fontSize":return F(I);case"color":return C(I,"#000000");case"fontWeight":switch(I){case"bold":return"-1";default:return"0";}case"fontStyle":switch(I){case"italic":return"-1";default:return"0";}case"textDecoration":return D(I,"underline");case"textDecoration2":return D(I,"line-through");case"FontHighlightColor":return C(I,"#000000");case"backgroundColor":if(I&&I.indexOf(",")>0){I="#"+I.split(",")[0];}return C(I,"#FFFFFF");case"backgroundStyle":if(I&&I.indexOf(",")>0){return"2";}if(I=="gradient"){return"2";}if(I=="transparent"){return"1";}else{return"0";}case"gradientColor":if(I&&I.indexOf(",")>0){I="#"+I.split(",")[1];}return C(I,"#000000");case"selectionColor":return C(I,"#000000");case"BackgroundHighlightColor":return C(I,"#000000");case"borderTopColor2":return C(I,"#000000");case"borderRightColor2":return C(I,"#000000");case"borderBottomColor2":return C(I,"#000000");case"borderLeftColor2":return C(I,"#000000");case"borderTopColor":return C(I,"#000000");case"borderRightColor":return C(I,"#000000");case"borderBottomColor":return C(I,"#000000");case"borderLeftColor":return C(I,"#000000");case"borderTopStyle":return G(I);case"borderRightStyle":return G(I);case"borderBottomStyle":return G(I);case"borderLeftStyle":return G(I);case"paddingLeft":return F(I);case"paddingRight":return F(I);case"paddingTop":return F(I);case"paddingBottom":return F(I);case"lineHeight":return(I==null||I=="0"||I=="normal"||I=="")?"":parseFloat(I);case"lineStyle":switch(I){case"dashed":return"2";case"dotted":return"3";case"double":return"4";case"none":return"0";default:return"1";}case"lineColor":return C(I,"#000000");case"lineWeight":return F(I);case"orientation":switch(I){case"border-left":return"1";default:return"0";}case"PaperType":switch(I){case"2a,46.81,66.18":return"1";case"a0,33.11,46.81":return"2";case"a1,23.39,33.11":return"3";case"a2,16.54,23.39":return"4";case"a3,11.69,16.54":return"5";case"a4,8.27,11.69":return"6";case"a5,5.83,8.27":return"7";case"a6,4.13,5.83":return"8";case"a7,2.91,4.13":return"9";case"a8,2.09,2.91":return"10";case"c,17,22":return"11";case"d,22,34":return"12";case"e,34,44":return"13";case"executive,7.25,10.5":return"14";case"f,28,40":return"15";case"ledger,11,17":return"16";case"legal,8.5,14":return"17";case"letter,8.5,11":return"18";case"super a3/b,13,19":return"19";case"folio,8.5,13":return"20";default:return"0";}case"zoom":return microstrategy.number.toLocaleString(parseFloat(I));case"TabColor":return C(I,"#ffffff");case"colWidth":return Math.round(parseInt(I)/(microstrategy.DPI_CONVERSION*microstrategy.ZOOM_FACTOR/100)*microstrategy.BASE_DPI);}}catch(E){microstrategy.errors.log(E);return H;}},DefaultPageByExportMode:["RWDocumentProperties","DefaultPageByExportMode",true,"all"],BeforeLayout:["TableOfContents","BeforeLayout",true,"all"],Multiselect:["FormattingSelector","Multiselect",true,"52,111"],WidgetProps:["FormattingWidget","WidgetProps",true,"52,111"],docked:["FormattingSection","DockSection",true,"dsec"],gridOverFlow:["FormattingCrosstab","OverflowMode",true,"52"],NavBarLayout:["FormattingLayout","NavBarLayout",true,"8"],WatermarkType:["WatermarkProperties","WatermarkType",true,"all"],SelectedVisualization:["Visualization","SelectedVisualization",true,"52"],FormattingView:{WindowState:["windowState",true,"52,111","ws"],TabCloseToDismissInfoWindow:["TabCloseToDismissInfoWindow",true,"8","tctdiw"],TitleBarDisplay:["titleBarDisplay",true,"52,8","tbd"],EnableHorizontalSwipeToChange:["EnableHorizontalSwipeToChange",true,"8","ehstc"],ShowAsCollapsiblePanel:["ShowAsCollapsiblePanel",true,"8","sacp"],InitialSlidingInWidth:["InitialSlidingInWidth",true,"8","isiw"],Title:["windowTitle",true,"52,8,9,111","wt"],StyleForSwitchingPanel:["StyleForSwitchingPanel",true,"8","sfwp"],ShowWidgetTitleBar:["ShowWidgetTitleBar",true,"52","swwt"],InfoWindowMode:["InfoWindowMode",true,"8","iwm"],DisplayInPartialScreen:["DisplayInPartialScreen",true,"8","dips"],InfoWindowPosition:["InfoWindowPosition",true,"8","iwp"],ShowTitleBar:["showTitleBar",true,"52,8,111","swt"],CopyMode:["CopyMode",true,"106,52","mcm"],UseAsInformationWindow:["UseAsInformationWindow",true,"8","uaiw"],InformationWindowPlacement:["InformationWindowPlacement",true,"8","iwpl"],InitialSlidingInHeight:["InitialSlidingInHeight",true,"8","isih"]},layoutBarPosition:["RWDocumentProperties","layoutBarPosition",true,"all"],borderTopColor:["FormattingBorder","TopColor",false,"102,106,107,52,53,111,8,t,de"],GraphQualityDPI:["FormattingPage","GraphQualityDPI",true,"all"],listSeparators:{"3082":",","1033":",","1043":";","2055":";","1053":";","1042":",","1031":";","1041":",","2064":";","1030":";","2052":",","1040":";","2060":";","1028":",","1049":";","1036":";","1046":";","1045":";","2057":",","4108":";"},dropShadowEffect:["FormattingAppearance","DropShadowEffect",true,"101,102,105,106,107,53,8,111,52"],selectionStyle:["FormattingPatterns","SelectorSelectionFillStyle",true,"52,111"],InfoWindowPosition:["FormattingView","InfoWindowPosition",true,"8"],ItemWidthMode:["FormattingSelector","ItemWidthMode",true,"111"],DatasetsSettings:["FormattingAnalysis","DatasetsSettings",true,"4"],NonFlashRender:["FormattingWidget","NonFlashRender",true,"52"],HTML_PROP_NAME:0,UseAsInformationWindow:["FormattingView","UseAsInformationWindow",true,"8"],SecondaryDataProviders:["FormattingWidget","SecondaryDataProviders",true,"52,111"],Transparency:["FormattingAppearance","Transparency",true,"8"],DisplayStyle:["FormattingAppearance","DisplayStyle",true,"106"],RSLPath:["FormattingWidget","RSLPath",true,"52,111"],PrintFooterOn:["FormattingPage","PrintFooterOn",true,"all"],NegativeNumbers:["FormattingNumber","NegativeNumbers",true,"100,106,52,t,de"],ExportAsShownOnWeb:["FormattingSelector","ExportAsShownOnWeb",true,"111"],PreserveTranslations:["RWDocumentProperties","PreserveTranslations",true,"all"],TOCTitleFillStyle:["TableOfContents","TitleFillStyle",true,"all"],FormattingTransactions:{"":["ShowChangeIndication",true,"51,52"],SetBadgeToValueOnField:["SetBadgeToValueOnField",true,"106"]},PageHeight:["FormattingPage","PageHeight",true,"all"],DocumentVersion:["RWDocumentProperties","DocumentVersion",true,"all"],IncludeMDProperties:["Visualization","IncludeMDProperties",true,"52"],FormattingPatterns:{FillColor:["backgroundColor",false,"101,106,107,52,53,4,8,9,111,208,t,de"],GradientXOffset:["gradientXOffset",true,"101,106,107,52,53,4,8,9,111,208"],SelectorSelectionColor:["selectionColor",false,"52,111","ssc"],GradientColor:["gradientColor",false,"101,106,107,52,53,4,8,9,111,208"],FillEffect:["FillEffect",true,"106","fe"],FillStyle:["backgroundStyle",false,"101,106,107,52,53,4,8,9,111,208","bgstyle","3"],GradientAngle:["gradientAngle",true,"101,106,107,52,53,4,8,9,111,208"],GradientYOffset:["gradientYOffset",true,"101,106,107,52,53,4,8,9,111,208"],HighlightColor:["BackgroundHighlightColor",false,"8,106","bhlc"],SelectorSelectionFillStyle:["selectionStyle",true,"52,111","sstyle"]},UseOneSheetPerLayout:["FormattingPage","UseOneSheetPerLayout",true,"all"],WatermarkFontName:["WatermarkProperties","FontName",true,"all"],APhoneVisualization:["Visualization","APhoneVisualization",true,"52"],NormalURL:["FormattingPicture","NormalURL",true,"106"],UseAsNavBar:["FormattingLayout","UseAsNavBar",true,"8"],newWin:["FormattingNavigation","OpenInNewWindow",true,"102,106"],FilterMode:["FormattingAnalysis","FilterMode",true,"8"],MaxSelectionCount:["FormattingSelector","MaxSelectionCount",true,"111"],InfoWindowMode:["FormattingView","InfoWindowMode",true,"8"],WatermarkFontColor:["WatermarkProperties","FontColor",true,"all"],FormattingLayout:{DisplayPageByBar:["DisplayPageByBar",true,"all"],UseAsMasterPanel:["UseAsMasterPanel",true,"8","uamp"],UseAsNavBar:["UseAsNavBar",true,"8","uanb"],NavBarLayout:["NavBarLayout",true,"8","nbl"],UseAsFilterPanel:["UseAsFilterPanel",true,"8","uafp"],FitPDFContentHeight:["FitPDFContentHeight",true,"all"],DisplayRePromptIcon:["DisplayRePromptIcon",true,"all"],TableControlDefinition:["TableControlDefinition",true,"8","tcd"],SupportedOrientations:["SupportedOrientations",true,"all"],CtlAutoSubmit:["CtlAutoSubmit",true,"8","cas"],UseAsInfoWindow:["UseAsInfoWindow",true,"all"],TabColor:["TabColor",false,"all"],UseSegments:["UseSegments",true,"all"],UseAsTableControl:["UseAsTableControl",true,"8","uatc"],UseMasterPageHeaderFooter:["TabMPHF",true,"all"],Autowire:["Autowire",true,"all"],ResetToFirstPanelWhenTargeted:["ResetToFirstPanelWhenTargeted",true,"all","rtfp"]},getListSeparator:function(B){try{return mstrFormatObject.listSeparators[B];}catch(A){microstrategy.errors.log(A);return",";}},FormattingIncrementalFetch:{EnableIFOnGrid:["gridIfEnabled",true,"52","gif"],PreLoadAllPanels:["PSPreLoadAllPanels",true,"8","plp"],MaxRows:["gridIfMaxRows",true,"52","gmr"],RowIFMode:["gridIfRowMode",true,"52","gifmd"]},ShowFloatingToolbars:["RWDocumentProperties","ShowFloatingToolbars",true,"all"],CopyMode:["FormattingView","CopyMode",true,"106,52"],FormattingPage:{ScalePagesTall:["ScalePagesTall",true,"all"],ExpandToFit:["ExpandToFit",true,"all"],DefaultViewMode:["DefaultViewMode",true,"all"],DefaultGridStyle:["DefaultGridStyle",true,"all"],PrintFooterOn:["PrintFooterOn",true,"all"],BlackAndWhite:["BlackAndWhite",true,"all"],MarginTop:["MarginTop",true,"all"],UseOneSheetPerGroupElement:["UseOneSheetPerGroupElement",true,"all"],GraphQualityDPI:["GraphQualityDPI",true,"all"],SectionHorizontalOverflow:["SectionHorizontalOverflow",true,"all"],ScalePageHeaderFooter:["ScalePageHeaderFooter",true,"all"],AvailableViewModes:["AvailableViewModes",true,"all"],MarginBottom:["MarginBottom",true,"all"],PageHeight:["PageHeight",true,"all"],Width:["LayoutWidth",true,"all"],EditableViewMode:["EditableViewMode",true,"all"],IncludeBookmarks:["IncludeBookmarks",true,"all"],UseOneSheetPerLayout:["UseOneSheetPerLayout",true,"all"],EmbedFonts:["EmbedFonts",true,"all"],GraphFormat:["GraphFormat",true,"all"],MarginRight:["MarginRight",true,"all"],UsePageWidthAsLayoutWidth:["UsePageWidthAsLayoutWidth",true,"all"],ScalePagesWide:["ScalePagesWide",true,"all"],Orientation:["Orientation",true,"all"],PaperType:["PaperType",false,"all"],ShowBookmarks:["ShowBookmarks",true,"all"],PrintHeaderOn:["PrintHeaderOn",true,"all"],Scaling:["Scaling",true,"all"],PageWidth:["PageWidth",true,"all"],ScalePercentage:["ScalePercentage",true,"all"],MarginLeft:["MarginLeft",true,"all"]},width:["FormattingSize","Width",false,"101,102,105,106,107,52,53,8,111,4"],lineHeight:["FormattingPadding","LineSpacing",false,"106,t"],TOCFontSize:["TableOfContents","FontSize",true,"all"],Autowire:["FormattingLayout","Autowire",true,"all"],TOCFontStrikeout:["TableOfContents","FontStrikeout",true,"all"],Include:["FormattingSelector","Include",true,"111"],SectionHorizontalOverflow:["FormattingPage","SectionHorizontalOverflow",true,"all"],SingleSourceGrid:["AnalyticalEngineProperties","SingleSourceGrid",true,"all"],IgnoreInExport:["FormattingAppearance","IgnoreInExport",true,"8"],fontFamily:["FormattingFont","Name",true,"52,106,107,111,8,t,de,df"],topLeftCornerRadius:["FormattingAppearance","TopLeftCornerRadius",true,"101,8"],TOCRightIndent:["TableOfContents","RightIndent",true,"all"],TXNSubmitInOrder:["FormattingSelector","TXNSubmitInOrder",true,"111"],FilterDisplay:["FormattingAnalysis","FilterDisplay",true,"8"],formatVersion:["FormattingAppearance","FormatVersion",true,"52"],fontWeight:["FormattingFont","Bold",false,"52,106,107,111,8,t,de,df"],WatermarkFontBold:["WatermarkProperties","FontBold",true,"all"],EnableHorizontalSwipeToChange:["FormattingView","EnableHorizontalSwipeToChange",true,"8"],IPadVisualization:["Visualization","IPadVisualization",true,"52"],ExcelEmbedImages:["RWDocumentProperties","ExcelEmbedImages",true,"all"],OfflineSubmission:["FormattingSelector","OfflineSubmission",true,"111"],CalculateDocWidth:["RWDocumentProperties","CalculateDocWidth",true,"all"],heightMode:["FormattingSize","HeightMode",false,"101,102,105,106,107,52,53,111,8"],EnableZoom:["Mobile","EnableZoom",true,"all"],ExcelGraphFormat:["RWDocumentProperties","ExcelGraphFormat",true,"all"],hideIfEmpty:["FormattingSection","HideIfEmpty",true,"4"],TARGET_VALUE_STYLE:1,Category:["FormattingNumber","Category",true,"100,106,52,t,de"],link:["FormattingNavigation","Hyperlink",true,"102,106"],DisplayRePromptIcon:["FormattingLayout","DisplayRePromptIcon",true,"all"],autoResizeInDesign:["FormattingSize","AutoResizeInDesign",true,"106"],gridIfMaxRows:["FormattingIncrementalFetch","MaxRows",true,"52"],FormattingNumber:{DecimalPlaces:["DecimalPlaces",true,"100,106,52,t,de","ndp","2"],CurrencyPosition:["CurrencyPosition",true,"100,106,52,t,de","ncp","2"],Format:["Format",true,"100,106,52,t,de","nfs","2"],Category:["Category",true,"100,106,52,t,de","nct","2"],NegativeNumbers:["NegativeNumbers",true,"100,106,52,t,de","nnn","2"],ThousandSeparator:["ThousandSeparator",true,"100,106,52,t,de","nth","2"],CurrencySymbol:["CurrencySymbol",true,"100,106,52,t,de","ncs","2"]},gridExportOverFlow:["FormattingCrosstab","ExportOverflowMode",true,"52"],orientation:["FormattingLine","LineOrientation",false,"105"],pictureMode:["FormattingPicture","PictureMode",true,"102"],gridShowCH:["FormattingCrosstab","ShowColHeaders",true,"52"],zoom:["RWDocumentProperties","ZoomFactor",false,"all"],PaperType:["FormattingPage","PaperType",false,"all"],RemoveNullGroups:["AnalyticalEngineProperties","RemoveNullGroups",true,"all"],FormattingNavigation:{OpenInNewWindow:["newWin",true,"102,106","nw"],IsHyperlink:["isLink",true,"102,106","isl"],Hyperlink:["link",true,"102,106","href"]},windowState:["FormattingView","WindowState",true,"52,111"],PageWidth:["FormattingPage","PageWidth",true,"all"],RWLevelMCEJoin:["VLDB Select","MCE Join To Get Data Combination",true,"all"],ShowingBarsTemporarily:["RWDocumentProperties","ShowingBarsTemporarily",true,"all"],ResetToFirstPanelWhenTargeted:["FormattingLayout","ResetToFirstPanelWhenTargeted",true,"all"]};var dropDown=new function(){};dropDown.prototype=new Object();dropDown.togglePicker=function(show,id,dropdown,bone){try{if(typeof microstrategy.log!="undefined"&&microstrategy.log.shouldLog(mstrLogImpl.METHOD_LEVEL)){microstrategy.log.start("dropDown.togglePicker",0);}var oldPicker=null;if(bone.currentPicker){oldPicker=bone.currentPicker;if(bone.currentPicker.selected){var item=bone.currentPicker.selected;if(item){item.className="";}bone.currentPicker.selected=null;bone.currentPicker.commandId=null;bone.currentPicker.toolId=null;}bone.currentPicker.style.display="none";bone.currentPicker=null;}if(show){bone.currentPicker=document.getElementById(id);if(!bone.currentPicker){microstrategy.errors.log(microstrategy.descriptors.getDescriptor("3623"));return false;}bone.currentPicker.style.zIndex=1000;var cmdId=dropdown.getAttribute(microstrategy.HTMLATTR_CMD_ID);if(!cmdId){cmdId=dropdown.parentNode.getAttribute(microstrategy.HTMLATTR_CMD_ID);}bone.currentPicker.commandId=cmdId;var subtypeStyle=bone.currentPicker.getAttribute(microstrategy.HTMLATTR_STYLE);if(subtypeStyle!=null){this.adjustPickerElements(bone.currentPicker);}if(bone.selectPickerElement){bone.selectPickerElement(bone.currentPicker);}for(var i=0;i<bone.currentPicker.childNodes.length;i++){var oChild=bone.currentPicker.childNodes[i];auxStr=oChild.getAttribute("de");if(auxStr&&auxStr.length>0){oChild.className=(eval(auxStr))?" ":"disabled";}}var leftElem=mstr.utils.BoxModel.getElementSumOffsetLeftAccurately(dropdown,document.body);var bottomElem=mstr.utils.BoxModel.getElementSumOffsetTopAccurately(dropdown,document.body)+getObjHeight(dropdown);if(bone.dialogDiv&&bone.dialogDiv.getAttribute(mstrHTMLAttributes.ATTR_DIALOG)=="true"){leftElem-=getObjSumLeft(bone.dialogDiv);bottomElem-=getObjSumTop(bone.dialogDiv);}bone.currentPicker.style.visibility="hidden";bone.currentPicker.style.display="block";var lClientWidth=getClientWidth();var lPickerWidth=getObjWidth(bone.currentPicker);if(lPickerWidth+leftElem>lClientWidth+((bone.dialogDiv&&!mstr.utils.ISIE6)?bone.dialogDiv.scrollLeft:0)){leftElem=Math.max(leftElem-lPickerWidth+getObjWidth(dropdown),0);}moveObjTo(bone.currentPicker,leftElem,bottomElem);if(bIsIE6&&!bIsIE7&&bone.maxHeight){bone.currentPicker.style.height="auto";bone.currentPicker.style.height=(bone.currentPicker.clientHeight<parseInt(bone.maxHeight))?bone.currentPicker.clientHeight+"px":bone.maxHeight;}bone.currentPicker.style.visibility="visible";togglePulldowns(bone.currentPicker,false);}else{if(oldPicker){togglePulldowns(oldPicker,true);}}}catch(err){microstrategy.errors.log(err);}finally{if(typeof microstrategy.log!="undefined"&&microstrategy.log.shouldLog(mstrLogImpl.METHOD_LEVEL)){microstrategy.log.stop("dropDown.togglePicker",0);}}return false;};dropDown.closePicker=function(F,D){try{if(typeof microstrategy.log!="undefined"&&microstrategy.log.shouldLog(mstrLogImpl.METHOD_LEVEL)){microstrategy.log.start("dropDown.closePicker",0);}if(!F){F=window.event;}var E=getEventTarget(F);var C=true;if(E){if(!E.getAttribute("id")&&E.parentNode.nodeType==1){E=E.parentNode;}var B=false;if(D.currentPicker){B=(findTarget(E,"ty")==D.currentPicker)&&(E!=D.currentPicker)&&(E.className.indexOf("disabled")<0);C=(E.className.indexOf("disabled")<0)&&(E!=D.currentPicker);}if(B){if(D.execPicker){C=D.execPicker(D.currentPicker,E);}else{alert("Option '"+E.getAttribute("id")+"' was selected from picker '"+D.currentPicker.id+"'. Please make sure the bone '"+D.id+"' implements execPicker.");}}}if(C&&D.currentPicker){dropDown.togglePicker(false,D.currentPicker.id,null,D);}return true;}catch(A){microstrategy.errors.log(A);return false;}finally{if(typeof microstrategy.log!="undefined"&&microstrategy.log.shouldLog(mstrLogImpl.METHOD_LEVEL)){microstrategy.log.stop("dropDown.closePicker",0);}}};dropDown.adjustPickerElements=function(I){try{var E=I.getAttribute(microstrategy.HTMLATTR_STYLE);switch(E){case"color":var H=microstrategy.userPalette;if(H){var B=microstrategy.findChildWithAtt(I,"span","name","pkrCustom");if(!B){return ;}if(B.getElementsByTagName("img").length==0){var J=document.createElement("img");J.src=microstrategy.FOLDER_IMAGES+"1ptrans.gif";B.appendChild(J);}displayObj(B);if(!ISIE7){var F=microstrategy.findChildWithAtt(I,"span","name","pkrMore");if(F){F.style.marginTop="25px";}}H=H.split(",");var A=microstrategy.findChildrenWithAtt(I,"span","custom","1");if(A.length==H.length&&A.length==8){if(A[0].id=="pkr"+H[0]){return ;}}else{if(A.length==H.length){return ;}}for(var D=0;D<A.length;D++){I.removeChild(A[D]);}for(var D=(H.length-1);D>=0;D--){var G=document.createElement("span");G.setAttribute("custom","1");G.id="pkr"+H[D];G.setAttribute("name","pkr"+H[D]);G.setAttribute("title",H[D]);G.style.backgroundColor=H[D];B.insertAdjacentElement("afterEnd",G);}}break;}}catch(C){microstrategy.errors.log(C);return false;}};mstrUpdateManager.prototype=new Object;mstrUpdateManager.prototype.id="bonesUpdateManager";mstrUpdateManager.prototype.observer=null;mstrUpdateManager.prototype.actions={};mstrUpdateManager.prototype.redoActions=[];mstrUpdateManager.prototype.undoActions=[];mstrUpdateManager.prototype.staticActions=[];mstrUpdateManager.prototype.useIframe=false;mstrUpdateManager.prototype.newWindow=false;mstrUpdateManager.prototype.newWindowName="_blank";mstrUpdateManager.prototype.extraURL="";mstrUpdateManager.prototype.iframeTarget="frameManager";mstrUpdateManager.prototype.formAction="";mstrUpdateManager.prototype.OPTIMIZE_EVENTS=true;mstrUpdateManager.prototype.ADD_EVENT_IDS=null;mstrUpdateManager.prototype.optActions=[];mstrUpdateManager.prototype.lastPosArray=[];mstrUpdateManager.prototype.copyActions={};mstrUpdateManager.prototype.cachedActionCollection=null;mstrUpdateManager.prototype.queueActions=false;mstrUpdateManager.prototype.forceSubmitAfterQueue=false;mstrUpdateManager.prototype.ctlCurElementsPosition=null;mstrUpdateManager.prototype.currentPanelPosition=null;mstrUpdateManager.prototype.hiddenInputs=null;mstrUpdateManager.prototype.submittedForm=null;mstrUpdateManager.prototype.submittedXhr=false;mstrUpdateManager.prototype.newActions=false;mstrUpdateManager.prototype.sTimeOutID=null;mstrUpdateManager.prototype.callback=null;mstrUpdateManager.UNIT_SEPARATOR=",";mstrUpdateManager.ITEM_SEPARATOR=";";mstrUpdateManager.UPDATE_LATER="0";mstrUpdateManager.UPDATE_NOW="1";mstrUpdateManager.STATIC_ACTION=-1;mstrUpdateManager.ARG_KEY_SEPARATOR="_";mstrUpdateManager.addEvent=function(A){if(!mstrUpdateManager.actions){mstrUpdateManager.actions={};}for(var B in A){var C=A[B].i;mstrUpdateManager[B]=C;mstrUpdateManager.actions[C]={eventID:C,paramName:A[B].n,paramID:A[B].p};}mstrUpdateManager.newActions=true;};mstrUpdateManager.prototype.addSingleAction=function(B){try{if(!this.cachedActionCollection){this.cachedActionCollection=[];}this.cachedActionCollection.push(B);this.newActions=true;}catch(A){microstrategy.errors.log(A);}};mstrUpdateManager.prototype.getUseIFrame=function(){try{return this.useIframe;}catch(A){microstrategy.errors.log(A);}};mstrUpdateManager.prototype.setUseIFrame=function(B){try{this.useIframe=B;}catch(A){microstrategy.errors.log(A);}};mstrUpdateManager.prototype.getNewWindowSetting=function(){try{return this.newWindow;}catch(A){microstrategy.errors.log(A);}};mstrUpdateManager.prototype.setNewWindowSetting=function(B){try{this.newWindow=B;}catch(A){microstrategy.errors.log(A);}};mstrUpdateManager.prototype.addActionCollection=function(B){try{if(!this.cachedActionCollection){this.cachedActionCollection=[];}this.cachedActionCollection=this.cachedActionCollection.concat(B);this.newActions=true;}catch(A){microstrategy.errors.log(A);}};mstrUpdateManager.prototype.hasCachedActions=function(){try{return(this.cachedActionCollection&&this.cachedActionCollection.length>0);}catch(A){microstrategy.errors.log(A);}return false;};mstrUpdateManager.prototype.addCachedActions=function(){try{if(this.cachedActionCollection){this.queueActions=false;this.add(this.cachedActionCollection,false);this.cachedActionCollection=null;if(this.forceSubmitAfterQueue){this.flushAndSubmitChanges();}}}catch(A){microstrategy.errors.log(A);}};mstrUpdateManager.prototype.killCachedActions=function(){try{if(this.cachedActionCollection){this.queueActions=false;this.cachedActionCollection=null;}}catch(A){microstrategy.errors.log(A);}};mstrUpdateManager.prototype.add=function(C,A){try{if(this.queueActions){if(C.length){this.addActionCollection(C);}else{this.addSingleAction(C);}}else{if(A){this.staticActions.push(C);this.redoActions.unshift(mstrUpdateManager.STATIC_ACTION);this.newActions=true;}else{this.clearRedoActions();this.undoActions.push(C);this.newActions=true;}microstrategy.eventManager.notifyOrphanBones("onupdatemanagerchange","add",C);if(this.observer){this.observer.notifyAll("onupdatemanagerchange");}}return true;}catch(B){microstrategy.errors.log(B);return false;}};mstrUpdateManager.prototype.addURL=function(A){try{if(A){if(this.extraURL.length>0){this.extraURL+="&"+A;}else{this.extraURL=A;}}return true;}catch(B){microstrategy.errors.log(B);return false;}};mstrUpdateManager.prototype.replaceURL=function(A,D){try{if(this.extraURL.length>0){if(this.extraURL.indexOf(A)>-1){var E=this.extraURL.substring(0,this.extraURL.indexOf(A)-2);var C=this.extraURL.indexOf("&",this.extraURL.indexOf(A));if(E==null||E.length==0){E="";}else{E+="&";}if(C>this.extraURL.indexOf(A)){this.extraURL=E+this.extraURL.substring(C+1,this.extraURL.length)+"&"+A+"="+D;}else{this.extraURL=A+"="+D;}}else{this.extraURL+="&"+A+"="+D;}}else{this.extraURL=A+"="+D;}return true;}catch(B){microstrategy.errors.log(B);return false;}};mstrUpdateManager.prototype.processUndoRedo=function(C,D){try{while(C.length>0){var B=C.pop();D.push(B);if(B!=mstrUpdateManager.STATIC_ACTION){return B;}}}catch(A){microstrategy.errors.log(A);}return null;};mstrUpdateManager.prototype.broadcastUpdate=function(){try{while(source.length>0){var B=source.pop();target.push(B);if(B!=mstrUpdateManager.STATIC_ACTION){return B;break;}}return null;}catch(A){microstrategy.errors.log(A);return false;}};mstrUpdateManager.prototype.undo=function(C){try{var D=false;C=C||1;for(var A=0;A<C;A++){var F=this.processUndoRedo(this.undoActions,this.redoActions);if(F){for(var B=0;B<F.length;B++){microstrategy.eventManager.notifyOrphanBones("onundo",new mstrUndoObj(F[B]));}D=true;}}if(D){microstrategy.eventManager.notifyOrphanBones("onupdatemanagerchange","undo");}if(this.observer){this.observer.notifyAll("onupdatemanagerchange");}return true;}catch(E){microstrategy.errors.log(E);return false;}};mstrUpdateManager.prototype.redo=function(){try{var C=this.processUndoRedo(this.redoActions,this.undoActions);if(C){for(var A=0;A<C.length;A++){microstrategy.eventManager.notifyOrphanBones("onredo",new mstrRedoObj(C[A]));}microstrategy.eventManager.notifyOrphanBones("onupdatemanagerchange","redo");if(this.observer){this.observer.notifyAll("onupdatemanagerchange");}}return true;}catch(B){microstrategy.errors.log(B);return false;}};mstrUpdateManager.prototype.getPendingEventsForTask=function(A){var E;var J;var B=0;var N=[];var D=A.split(".");var C=D[D.length-1];var F=this.optActions;this.optActions=[];if(this.OPTIMIZE_EVENTS){for(var I=0;I<this.undoActions.length;I++){var G=this.undoActions[I];if(G==mstrUpdateManager.STATIC_ACTION){G=this.staticActions[B];B++;}for(var M=0;M<G.length;M++){var H=G[M];var K=H.beanPath;if(K&&K.indexOf(A)==0){H.beanPath=K.substring(K.indexOf(C));H.beanPath=microstrategy.servletName+"."+H.beanPath;this.createOptimizedArray(H);G.splice(M,1);M=M-1;}}}for(var I=0;I<this.optActions.length;I++){if(this.optActions[I].id!=null){N.push(this.createEventForAction(this.optActions[I]));}}this.postOptimizationCleanup();}else{for(var I=0;I<this.undoActions.length;I++){var G=this.undoActions[I];if(G==mstrUpdateManager.STATIC_ACTION){G=this.staticActions[B];B++;}for(var M=0;M<G.length;M++){var H=G[M];var K=H.beanPath;if(K&&K.indexOf(A)==0){H.beanPath=K.substring(K.indexOf(C));H.beanPath=microstrategy.servletName+"."+H.beanPath;N.push(this.createEventForAction(H));G.splice(M,1);M=M-1;}}}}this.optActions=F;if(N.length>0){var L=new mstrSerializer();L.addValues(N);return L.getState();}else{return"";}};mstrUpdateManager.prototype.flushChanges=function(I){try{var B;var E;var A=0;var J=[];this.clearRedoActions();if(this.extraURL.length>0){addURLAsHiddenInputsToForm(I,this.extraURL);this.extraURL="";}if(this.OPTIMIZE_EVENTS){for(var F=0;F<this.undoActions.length;F++){var D=this.undoActions[F];if(D==mstrUpdateManager.STATIC_ACTION){D=this.staticActions[A];A++;}for(var H=0;H<D.length;H++){this.createOptimizedArray(D[H]);}}for(var F=0;F<this.optActions.length;F++){if(this.optActions[F].id!=null){J.push(this.createEventForAction(this.optActions[F]));}}this.postOptimizationCleanup();}else{for(var F=0;F<this.undoActions.length;F++){var D=this.undoActions[F];if(D==mstrUpdateManager.STATIC_ACTION){D=this.staticActions[A];A++;}for(var H=0;H<D.length;H++){J.push(this.createEventForAction(D[H]));}}}var G=new mstrSerializer();G.addValues(J);if(I.getAttribute("hasUpdateChanges")=="true"){updateDynamicInput(I,mstrUpdateManager.multipleEventArgName,G.getState());}else{this.submittedForm=I;this.hiddenInputs=[];this.createHiddenInput(I,mstrUpdateManager.multipleEventArgName,G.getState());this.createHiddenInput(I,"evt",mstrUpdateManager.multipleEventID);this.createHiddenInput(I,"src",mstrUpdateManager.multipleEventSrc);this.createHiddenInput(I,mstrUpdateManager.multipleEventID,"1");I.setAttribute("hasUpdateChanges","true");}if(this.newWindow){I.target=this.newWindowName;}this.newActions=false;return true;}catch(C){microstrategy.errors.log(C);return false;}};mstrUpdateManager.prototype.flushChangesAsParams=function(G){try{var B;var E;var A=0;var J=[];this.clearRedoActions();if(this.extraURL.length>0){UpdateHelper.addURLToParams(G,this.extraURL);this.extraURL="";}if(this.OPTIMIZE_EVENTS){for(var F=0;F<this.undoActions.length;F++){var D=this.undoActions[F];if(D==mstrUpdateManager.STATIC_ACTION){D=this.staticActions[A];A++;}for(var I=0;I<D.length;I++){this.createOptimizedArray(D[I]);}}for(var F=0;F<this.optActions.length;F++){if(this.optActions[F].id!=null){J.push(this.createEventForAction(this.optActions[F]));}}this.postOptimizationCleanup();}else{for(var F=0;F<this.undoActions.length;F++){var D=this.undoActions[F];if(D==mstrUpdateManager.STATIC_ACTION){D=this.staticActions[A];A++;}for(var I=0;I<D.length;I++){J.push(this.createEventForAction(D[I]));}}}var H=new mstrSerializer();H.addValues(J);if(G.hasUpdateChanges=="true"){G[mstrUpdateManager.multipleEventArgName]=H.getState();}else{this.submittedXhr=true;UpdateHelper.addAdditionalParam(G,mstrUpdateManager.multipleEventArgName,H.getState());UpdateHelper.addAdditionalParam(G,"evt",mstrUpdateManager.multipleEventID);UpdateHelper.addAdditionalParam(G,"src",mstrUpdateManager.multipleEventSrc);UpdateHelper.addAdditionalParam(G,mstrUpdateManager.multipleEventID,"1");G.hasUpdateChanges=="true";}if(this.newWindow){G.target=this.newWindowName;}this.newActions=false;return true;}catch(C){microstrategy.errors.log(C);return false;}};mstrUpdateManager.prototype.createHiddenInput=function(D,B,C){var A=createHiddenInput(D,B,C);this.hiddenInputs.push(A);};mstrUpdateManager.prototype.postOptimizationCleanup=function(A){if(this.fullScreenModePosition){delete this.fullScreenModePosition;}if(this.lTbarBrowserSettingPosition){delete this.lTbarBrowserSettingPosition;}if(this.ctlCurElementsPosition){delete this.ctlCurElementsPosition;}if(this.currentPanelPosition){delete this.currentPanelPosition;}if(this.widgetPropEdits){delete this.widgetPropEdits;}this.optActions=[];this.lastPosArray=[];};mstrUpdateManager.prototype.createEventForAction=function(G){try{var A=mstrUpdateManager.actions[G.id];var E=new mstrSerializer();E.addStr(A.eventID);E.addStr(G.beanPath+"."+A.eventID);var D="";for(var C=0;C<G.newArgs.length;C++){actionID=G.argID[C];for(var B=0;B<A.paramID.length;B++){if(A.paramID[B]==actionID){if(false){D+="<arg name='"+A.paramName[B]+"' v='"+G.newArgs[C]+"' />";}if(G.argKey==null){E.addStr(A.paramName[B]);}else{E.addStr(A.paramName[B]+mstrUpdateManager.ARG_KEY_SEPARATOR+G.argKey);}E.addStr(G.newArgs[C]);break;}}}if(false){alert(D);}return E.getState();}catch(F){microstrategy.errors.log(F);return false;}};mstrUpdateManager.prototype.flushAndSubmitChanges=function(C,H){this.callback=H||{};var B=this,G=this.callback.success,F=this.callback.noRefresh;this.callback.success=function(I){if(G){G(I);}if(!F&&I&&I.status=="6"){B.refreshPage();}};try{if(useXHR&&!C){mstrMsgBoxImpl.hideMessage(null,"controlSubmitButton");var A=UpdateHelper.createParamsFromURL(this.getFormAction(),this.useIframe&&!this.newWindow);this.flushing=true;UpdateHelper.submitRequest(A);}else{mstrMsgBoxImpl.hideMessage(null,"controlSubmitButton");var D=createDynamicForm(this.getFormAction());if(this.useIframe&&!this.newWindow){addURLAsHiddenInputsToForm(D,"iframe=true");D.target=this.iframeTarget;}this.flushing=true;submitForm(D,C);}return true;}catch(E){microstrategy.errors.log(E);return false;}};mstrUpdateManager.prototype.acknowledgeRequest=function(){try{this.undoActions=[];this.redoActions=[];this.staticActions=[];this.optActions=[];this.lastPosArray=[];this.copyActions={};this.newWindow=false;microstrategy.eventManager.notifyOrphanBones("onupdatemanagerchange");if(this.observer){this.observer.notifyAll("onupdatemanagerchange");}var B;if(this.submittedForm!=null){for(var A=0;A<this.hiddenInputs.length;A++){B=this.hiddenInputs[A];try{this.submittedForm.removeChild(B);}catch(C){if((C&&C.code!=8)&&(C.number&&C.number!=-2147024809)){throw (C);}}}this.submittedForm.setAttribute("hasUpdateChanges","false");this.submittedForm=null;this.hiddenInputs=null;this.flushing=false;}if(this.submittedXhr){this.submittedXhr=false;this.flushing=false;}}catch(C){microstrategy.errors.log(C);return false;}};mstrUpdateManager.prototype.isFlushing=function(){return !!this.flushing;};mstrUpdateManager.prototype.acknowledgeReloadEnd=function(){if(this.observer){this.observer.notifyAll("acknowledgeReloadEnd");}};mstrUpdateManager.prototype.getFixStateActions=function(){try{var E=[];for(var B=0;B<this.staticActions.length;B++){var D=this.staticActions[B];for(var A=0;A<D.length;A++){E.push(D[A]);}}return E;}catch(C){microstrategy.errors.log(C);return false;}};mstrUpdateManager.prototype.hasChangesToSubmit=function(){try{return(this.undoActions.length>0||this.isRedoStatic()||(this.extraURL!=null&&this.extraURL.length>0));}catch(A){microstrategy.errors.log(A);return false;}};mstrUpdateManager.prototype.hasNewChanges=function(){try{var A=this.newActions;this.newActions=false;return A;}catch(B){microstrategy.errors.log(B);return false;}};mstrUpdateManager.prototype.clearRedoActions=function(){try{while(this.redoActions.length>0){var B=this.redoActions.pop();if(B==mstrUpdateManager.STATIC_ACTION){this.undoActions.push(B);}}}catch(A){microstrategy.errors.log(A);return false;}};mstrUpdateManager.prototype.getLastAction=function(){try{return this.undoActions.pop();}catch(A){microstrategy.errors.log(A);return false;}};mstrUpdateManager.prototype.isRedoStatic=function(){try{var C=false;for(var A=0;A<this.redoActions.length;A++){if(this.redoActions[A]==mstrUpdateManager.STATIC_ACTION){C=true;break;}}return C;}catch(B){microstrategy.errors.log(B);return false;}};mstrUpdateManager.prototype.anyNonStatic=function(B){try{var A=(B)?this.redoActions:this.undoActions;var E=false;for(var C=0;C<A.length;C++){if(A[C]!=mstrUpdateManager.STATIC_ACTION){E=true;break;}}return E;}catch(D){microstrategy.errors.log(D);return false;}};mstrUpdateManager.prototype.createActionObject=function(C,A,G,H,B,F,J,I){try{var E={};E.elem=C;E.id=A;E.beanPath=G;E.argID=H;E.newArgs=B;E.oldArgs=F;E.cachedArray=J;E.argKey=I;if(A==mstrUpdateManager.EDIT_PROPS){E.formatType=microstrategy.formatType;E.argID.push("2048131");E.newArgs.push(microstrategy.formatType);E.oldArgs.push(microstrategy.formatType);}return E;}catch(D){microstrategy.errors.log(D);return false;}};mstrUpdateManager.prototype.createOptimizedArray=function(G){try{var I=G.id;if(!this.ADD_EVENT_IDS){this.ADD_EVENT_IDS=mstrUpdateManager.ADD_TEXT+"|"+mstrUpdateManager.ADD_LINE+"|"+mstrUpdateManager.ADD_SHAPE+"|"+mstrUpdateManager.ADD_TEMPLATE+"|"+mstrUpdateManager.ADD_DATASET_TEMPLATE+"|"+mstrUpdateManager.ADD_IMAGE+"|"+mstrUpdateManager.ADD_HTML_CONTAINER+"|"+mstrUpdateManager.ADD_PANEL_STACK+"|"+mstrUpdateManager.CTRL_ADD+"|";}var N=(G.elem)?G.elem.id:null;var B=N;if(I==mstrUpdateManager.SET_REPORT_PROPERTY_VALUES){for(var K=0;K<G.argID.length;K++){if(G.argID[K]=="4146"){B=N+G.newArgs[K].split("!")[0]+G.newArgs[K].split("!")[1]+G.newArgs[K].split("!")[2];break;}}}var P;if(I==mstrUpdateManager.EDIT_PROPS){for(var K=0,D=G.argID.length;K<D;K++){if(G.argID[K]=="2048035"){var J=G.newArgs[K].split(mstrUpdateManager.UNIT_SEPARATOR);if(J[1]=="FormattingWidget"&&J[2]=="WidgetProps"){var C=this.widgetPropEdits||{};if(J[0] in C){this.optActions[C[J[0]]].id=null;}C[J[0]]=this.optActions.length;this.widgetPropEdits=C;}break;}}this.optActions.push(G);}else{if(I==mstrUpdateManager.COPY_TO_CLIPBOARD||I==mstrUpdateManager.CUT_TO_CLIPBOARD){P=G.newArgs[0].split(CLIPBOARD_ITEM_SEPARATOR);for(var K=0;K<P.length;K++){this.copyActions[P[K]]={};this.copyActions[P[K]].position=this.optActions.length;this.copyActions[P[K]].applied=false;}this.optActions.push(G);}else{if(I==mstrUpdateManager.SET_REPORT_PROPERTY_VALUES||I==mstrUpdateManager.EDIT_TEXT||I==mstrUpdateManager.SET_TOPLEFT_POSITION||I==mstrUpdateManager.CHANGE_BONE_PROPERTY){if(!this.lastPosArray[I]){this.lastPosArray[I]={};}if(this.copyActions[N]&&this.copyActions[N].applied==false){this.copyActions[N].applied=true;for(anItem in this.lastPosArray){delete this.lastPosArray[anItem][B];}this.lastPosArray[I][B]={};this.lastPosArray[I][B].position=this.optActions.length;this.optActions.push(G);}else{if(this.lastPosArray[I][B]){var L=this.lastPosArray[I][B].position;var F=this.optActions[L];var H=mstr.$A.find(F.argID,"2048007");if(H==-1){H=null;}var M=mstr.$A.find(F.argID,"2048007");if(M==-1){H=null;}if(M==H){F.newArgs=G.newArgs;}else{this.lastPosArray[I][B].position=this.optActions.length;this.optActions.push(G);}}else{this.lastPosArray[I][B]={};this.lastPosArray[I][B].position=this.optActions.length;this.optActions.push(G);}}}else{if(I==mstrUpdateManager.REMOVE_OBJECT){if(this.copyActions[N]){for(var K=this.copyActions[N].position;K<this.optActions.length;K++){if(this.optActions[K].elem&&this.optActions[K].elem.id==N){this.optActions[K].id=null;}}delete this.copyActions[N];for(anItem in this.lastPosArray){delete this.lastPosArray[anItem][B];}}else{for(var K=0;K<this.optActions.length;K++){if(this.optActions[K].elem&&this.optActions[K].elem.id==N&&!this.ADD_EVENT_IDS.contains(this.optActions[K].id,"|")){this.optActions[K].id=null;}}}this.optActions.push(G);}else{if(I==mstrUpdateManager.SWITCH_FULL_SCREEN_MODE){if(typeof (this.fullScreenModePosition)!="undefined"&&this.optActions[this.fullScreenModePosition]&&this.optActions[this.fullScreenModePosition].newArgs&&this.optActions[this.fullScreenModePosition].id==I){this.optActions[this.fullScreenModePosition].newArgs=G.newArgs;}else{this.fullScreenModePosition=this.optActions.length;this.optActions.push(G);}}else{if(I==mstrUpdateManager.SET_PERMANENT_BROWSER_SETTING){if(G.argID[0]=="5005"&&G.newArgs[0]=="lTbar"){if(typeof (this.lTbarBrowserSettingPosition)!="undefined"&&this.optActions[this.lTbarBrowserSettingPosition]&&this.optActions[this.lTbarBrowserSettingPosition].newArgs){this.optActions[this.lTbarBrowserSettingPosition].newArgs=G.newArgs;}else{this.lTbarBrowserSettingPosition=this.optActions.length;this.optActions.push(G);}}else{this.optActions.push(G);}}else{if(I==mstrUpdateManager.SET_CUR_CTL_ELEMENTS){for(var K=0;K<G.argID.length;K++){if(G.argID[K]=="2048130"){this.ctlCurElementsPosition=this.ctlCurElementsPosition||{};var A=G.newArgs[K];if(A in this.ctlCurElementsPosition){this.optActions[this.ctlCurElementsPosition[A]].id=null;}this.ctlCurElementsPosition[A]=this.optActions.length;this.optActions.push(G);break;}}}else{if(I==mstrUpdateManager.SET_CURRENT_PANEL){var O=G.newArgs[0];if(!this.currentPanelPosition){this.currentPanelPosition={};}if(typeof (this.currentPanelPosition[O])!="undefined"){this.optActions.splice(this.currentPanelPosition[O],1);}this.currentPanelPosition[O]=this.optActions.length;this.optActions.push(G);}else{this.optActions.push(G);}}}}}}}}}catch(E){microstrategy.errors.log(E);return false;}};mstrUpdateManager.prototype.getFormAction=function(){if(!this.formAction){this.formAction=microstrategy.servletName;}return this.formAction;};mstrUpdateManager.prototype.setFormAction=function(A){this.formAction=A;};mstrUpdateManager.createPropertyEditString=function(C,B,G,A,H){try{var F=mstrFormatObject;if(!F){return"";}if(!A){G=F.encodeValue(B,G);}var D=C||"";if(D){D+=mstrUpdateManager.UNIT_SEPARATOR;}return D+(H||F.getPropertySetName(B))+mstrUpdateManager.UNIT_SEPARATOR+F.getPropertyName(B)+mstrUpdateManager.UNIT_SEPARATOR+G+mstrUpdateManager.ITEM_SEPARATOR;}catch(E){microstrategy.errors.log(E);return"";}};mstrUpdateManager.prototype.createEditPropsAction=function(F,J,S,I,Q,D,A,L,K,R){try{var E=(A)?mstrUpdateManager.UPDATE_NOW:mstrUpdateManager.UPDATE_LATER;var M=mstrUpdateManager.createPropertyEditString;var O=K?"1":"0";var H="",C="";for(var N=0;N<I.length;N++){H+=M(J,I[N],Q[N],R);if(D&&(N in D)){C+=M(J,I[N],D[N]);}}var B=K?["2048018","2048035","2048241"]:["2048018","2048035"],G=K?[E,H,O]:[E,H];return this.createActionObject(F,mstrUpdateManager.EDIT_PROPS,S,B,G,(C&&[E,C])||[],L);}catch(P){microstrategy.errors.log(err);return null;}};mstrUpdateManager.prototype.findRwbInputOnPageStateForm=function(){var C=getObj("pageStateForm");var B=C.getElementsByTagName("INPUT");for(i=0,cnt=B.length;i<cnt;i++){var A=B[i];if(A.name==="rwb"){return A;}}return null;};mstrUpdateManager.prototype.getRWBState=function(A){if(A){var B=this.findRwbInputOnPageStateForm();if(B){return B.value;}}else{if(pageState){var C=(pageState+"&").match(/rwb=(.*?)\&/);if(C!=-1){return C[1];}}}return"";};mstrUpdateManager.prototype.setRWStateInForm=function(A){var B=this.findRwbInputOnPageStateForm();if(B){B.value=A;}};mstrUpdateManager.prototype.refreshPage=function(){try{this.useIframe=false;var B=this.createActionObject(null,mstrUpdateManager.PAGE_REFRESH,microstrategy.servletName+"."+microstrategy.pageName,[],[],[],null);this.add([B],true);this.flushAndSubmitChanges();}catch(A){microstrategy.errors.log(A);}};mstrUpdateManager.prototype.submitPartialUpdate=function(C){try{microstrategy.puStatus=0;iframe.notifyParent(true);if(!this.partialUpdateModel){this.partialUpdateModel=new mstr.models.BooleanTaskModel({parent:this});mstr.controllers.Factory.add(this.partialUpdateModel);var A=this.partialUpdateModel&&this.partialUpdateModel&&this.partialUpdateModel.init();if(!("id" in this)||!mstr.$obj(this.id)){mstr.controllers.Factory.add(this);}this.partialUpdateModel.attachEventListener(this,"set_readyState","handleStateChange");}C.processorClass=mstr.http.PUProcessor;this.partialUpdateModel.execSubmit({params:C,callback:this.callback});}catch(B){microstrategy.errors.log(B);}};mstrUpdateManager.prototype.handleStateChange=function(evt){try{switch(evt.memo.value){case mstr.Enum.Widget.READYSTATE.TIMEOUT:case mstr.Enum.Widget.READYSTATE.ERROR:break;case mstr.Enum.Widget.READYSTATE.SUCCESS:var updateResult=evt.src.get("requestContext").response.data;if(updateResult){if(updateResult.status=="2"){iframe.showWaitPage();}else{iframe.hideWaitPage();}UpdateHelper.replaceComponents(updateResult.components);document.title=updateResult.title;if(updateResult.status=="2"){this.doRedirect(updateResult.redirectURL,updateResult.waitSeconds);}microstrategy.eventManager.executeFunction("microstrategy.eventManager.onreload()");if(updateResult.script){eval(updateResult.script);}microstrategy.puStatus=1;}else{if(window.document.readyState=="complete"){var sMarkup=evt.src.get("requestContext").response.text;if(bIsIE6&&!bIsIE7){document.write(sMarkup);}else{var oNewDoc=window.document.open("text/html");if(sMarkup.indexOf("<!DOCTYPE")==-1){oNewDoc.write('<!DOCTYPE html PUBLIC "-//W3C//DTD XHTML 1.0 Transitional//EN" "http://www.w3.org/TR/xhtml1/DTD/xhtml1-transitional.dtd " >');}oNewDoc.write(sMarkup);oNewDoc.close();}}}delete this.callback;break;}}catch(err){microstrategy.errors.log(err);}};mstrUpdateManager.prototype.doRedirect=function(C,A){try{this.sTimeOutID=window.setTimeout('microstrategy.updateManager.timedRedirect("'+C+'")',A*1000);}catch(B){microstrategy.errors.log(B);}};mstrUpdateManager.prototype.timedRedirect=function(C){try{window.clearTimeout(this.sTimeOutID);var A=UpdateHelper.createParamsFromURL(C);UpdateHelper.submitRequest(A);}catch(B){microstrategy.errors.log(B);}};function mstrUpdateManager(){this.commands=new UpdateManagerCommands(this);if(typeof (mstrObserverImpl)!="undefined"){this.observer=new mstrObserverImpl();}return this;}if(typeof (microstrategy)!="undefined"){microstrategy.updateManager=new mstrUpdateManager();}mstrUndoObj.prototype={};function mstrUndoObj(A){this.elem=A.elem;this.id=A.id;this.args=A.oldArgs;this.cachedArray=A.cachedArray;return this;}mstrRedoObj.prototype={};function mstrRedoObj(A){this.elem=A.elem;this.id=A.id;this.args=A.newArgs;this.cachedArray=A.cachedArray;return this;}function UpdateManagerCommands(A){this.queryVisible=function(B){return true;};this.queryEnabled=function(B){switch(B){case"redo":return A.anyNonStatic(true);case"undo":return A.anyNonStatic(false);case"apply":return A.hasChangesToSubmit();default:return false;}};this.queryState=function(B){return false;};this.exec=function(B,C){switch(B){case"redo":return A.redo();case"undo":return A.undo();case"apply":A.add([A.createActionObject(null,mstrUpdateManager.APPLY_CHANGES,mstrUpdateManager.applyChangesBeanPath,[],[],[])]);return A.flushAndSubmitChanges();default:return false;}};return this;}var UpdateHelper=new function(){};UpdateHelper.prototype=new Object();UpdateHelper.createParamsFromURL=function(B,G){var C={method:"post"};var H=B.indexOf("?")>0;var F=B.indexOf("#")>0;var E=(B.indexOf("iframe=true")>0||G);var D=((H)?B.substring(0,B.indexOf("?")):B);if(F){var A="";B=moveAnchor(B);A=B.substring(B.indexOf("#"));D=D.replace(A,"")+A;B=B.substring(0,B.indexOf("#"));}D=microstrategy.addJSessionID(D);if(H){UpdateHelper.addURLToParams(C,B);}C.iframe=(E)?"true":"false";C.action=D;return C;};UpdateHelper.createParamsFromForm=function(I,J,F,H){var G=getObj(I);var C=microstrategy.findChildrenWithAtt(G,["INPUT","SELECT","TEXTAREA"],"name");var B={action:G.action,method:G.method};if(typeof G.target!=undefined){B.target=G.target;}for(var D=0;D<C.length;D++){var A=C[D];if(H===true&&A.ps===true){continue;}if(A.type=="select-multiple"&&A.options&&A.options.length>0&&A.disabled!=true){for(var E=0;E<A.options.length;E++){if(UpdateHelper.shouldSubmit(A.options[E])){UpdateHelper.addAdditionalParam(B,A.name,A.options[E].value);}}}else{if(UpdateHelper.shouldSubmit(A)){UpdateHelper.addAdditionalParam(B,A.name,A.value);}}}if(J){B[J]=F;}return B;};UpdateHelper.shouldSubmit=function(A){if(A.disabled==true){return false;}if(A.type=="submit"||A.type=="button"||A.type=="image"||A.value=="undefined"){return false;}if(A.type=="radio"||A.type=="checkbox"){if(!A.getAttribute("agg")){return A.checked;}else{A.value=A.checked?"true":"false";return true;}}if(A.tagName.toLowerCase()=="option"){return A.selected;}return true;};UpdateHelper.addURLToParams=function(D,F,C){F=F.substring(F.indexOf("?")+1,F.length);var G=F.split("&");var I="";var E="";var A="";var H=/\+/g;for(var B=0;B<G.length;B++){I=G[B].split("=");E=I[0];A=I[1];if(E&&E!==""){if(A){A=decodeURIComponent(A.replace(H," "));}if(C){D[E]=A;}else{UpdateHelper.addAdditionalParam(D,E,A);}}}return false;};UpdateHelper.addAdditionalParam=function(A,B,C){if(A[B]&&typeof A[B]!="object"){A[B]=[A[B],C];}else{if(A[B]&&A[B].push){A[B].push(C);}else{A[B]=C;}}};UpdateHelper.submitRequest=function(H){var N=getObj("pageStateForm");var E=null;var I=null;var G;var F;var C;var O;UpdateHelper.appendPageStateToParams(H);if(typeof (microstrategy)!="undefined"&&typeof (microstrategy.bones.rwb_viewer)!="undefined"&&microstrategy.EDIT_MODE==microstrategy.ALLOW_EDIT_MODE){var L=microstrategy.bones.rwb_viewer;H.docSelections=L.commands.queryState("selectionsKey");L.adjustScrollValues();H.viewerScroll=L.dScrollTop+","+L.dScrollLeft;H.isLocked=(L.insertionControlLocked)?1:0;var M=L.doc.currentControlSubtype?"|"+L.doc.currentControlSubtype:"";H.currentControl=L.doc.currentControl+M;}if(typeof (microstrategy)!="undefined"&&microstrategy.DISPLAY_MODE==microstrategy.VIEW_MODE&&microstrategy.EDIT_MODE==microstrategy.ALLOW_EDIT_MODE){for(var A in microstrategy.bones){if(microstrategy.bones[A]!=null&&microstrategy.bones[A].type==microstrategy.OBJTYPE_GRID){var B=microstrategy.bones[A];if(B&&B.gridStructureInfo&&!B.gridStructureInfo.emptyCase&&!B.gridStructureInfo.isEmptyTemplate){if(B.isGrid){var K=B.commands.queryState("selections");if(K){H[B.id]=K;}}if(B.isGraph&&A.indexOf("_graph")==-1){H[B.id+"_gs"]=B.commands.queryState("graphSelections");}}}}}if(H.iframe=="true"){microstrategy.updateManager.submitPartialUpdate(H);}else{var J=UpdateHelper.createFormFromParams(H);if(mstrApp&&mstrApp.optimizeFitToPage){UpdateHelper.appendPageSizeToParams(J);}if(mstr.utils.ISSAFARI&&J.target=="_blank"){J.action+=(J.action.indexOf("?")==-1?"?":"&");J.action+="t="+new Date().getTime();}try{microstrategy.submitForm(J);}catch(D){if(J.target!=""&&!window.open("","","width=1,height=1,left=0,top=0,scrollbars=no")){showMessage({contents:microstrategy.descriptors.getDescriptor("5877"),elements:microstrategy.OK_BUTTON,type:mstrMsgBoxImpl.MSG_WARNING});}else{microstrategy.errors.log(D);}}}return false;};UpdateHelper.createFormFromParams=function(A){var C=document.createElement("FORM");C.name="dynamic_form";C.method=A.method;delete A.method;C.action=A.action;delete A.action;if(typeof A.target!="undefined"){C.target=A.target;delete A.target;}C.setAttribute("hasUpdateChanges",A.hasUpdateChanges=="true");for(var D in A){if(A[D]){if(typeof A[D]=="object"){for(var B=0;B<A[D].length;B++){if(A[D][B]){createHiddenInput(C,D,A[D][B]);}}}else{createHiddenInput(C,D,A[D]);}}}document.body.insertAdjacentElement("beforeEnd",C);return C;};UpdateHelper.submitFormThroughXHR=function(B,D){if(D){if(!B){B=window.event;}var B=getEventTarget(B);if(!B){return false;}}var F=microstrategy.findAncestorWithTag(B,"FORM");var C=B.name;var A=B.value;if(typeof F=="undefined"||typeof C=="undefined"||typeof A=="undefined"){return false;}var E=UpdateHelper.createParamsFromForm(F,C,A,true);UpdateHelper.appendPageStateToParams(E);microstrategy.updateManager.submitPartialUpdate(E);return false;};UpdateHelper.appendPageStateToParams=function(A){var E=getObj("pageStateForm");var D=null;var B=(typeof (microstrategy)!="undefined")?microstrategy.updateManager:null;var C;if(B&&B.hasChangesToSubmit()){B.flushChangesAsParams(A);UpdateHelper.addEvtOrderToParams(A,mstrUpdateManager.multipleEventID);}if(E){if(A.method=="get"||A.method=="GET"){UpdateHelper.addURLToParams(A,pageState,true);}else{D=E.getElementsByTagName("INPUT");for(C=0;C<D.length;C++){A[D[C].name]=D[C].value;}}}};UpdateHelper.appendPageSizeToParams=function(A){createHiddenInput(A,"innerWidth",getClientWidth());createHiddenInput(A,"innerHeight",getClientHeight());};UpdateHelper.submitLink=function(F){var H;H=F.href;var C;C=F.target;var G=document.getElementById("cssAnalyzerToolbar");var A=(getCookie(ENABLE)=="true")&&(G!=null);if(A){return false;}window.mstrSubmitLink=true;if(C=="frameManager"||(typeof (microstrategy)!="undefined"&&microstrategy.updateManager&&microstrategy.updateManager.hasChangesToSubmit())){var B=UpdateHelper.createParamsFromURL(H);if(C){B.target=C;}UpdateHelper.submitRequest(B);return false;}if(typeof (pageState)!="undefined"){var D=updateLink(H);D=moveAnchor(D);var E=null;if(bIsIE6&&F.childNodes&&(F.childNodes.length==1)&&F.childNodes[0].nodeType==3){E=F.innerHTML;}F.href=D;if(bIsIE6&&E!=null){F.innerHTML=E;}return true;}else{return true;}};UpdateHelper.addEvtOrderToParams=function(A,B,C){if(A.evtorder){if(A.evtorder.indexOf(B)<0){if(C){A.evtorder=A.evtorder+","+B;}else{A.evtorder=B+","+A.evtorder;}A[B]="1";}}else{A.evtorder=B;if(A.evt&&A.evt.length<3){for(j=0;j<A.evt.length;j++){A[A.evt[j]]="1";}}}};UpdateHelper.replaceComponents=function(A,G){try{if(!G){iframe.consolidatedStyles={};iframe.isProcessing=true;if(!bIsW3C){iframe.togglePulldownChildren(document.body,false);}}var C;for(C=0;C<A.length;C++){var F=A[C];if(F&&F.ISEMPTY!="true"){if(F.errBox!="true"||currentModalEditor.length==0){UpdateHelper.updateComponent(F,G);}else{var E=F.content;if(E.length>0){showMessage({contents:E,elements:microstrategy.OK_BUTTON,type:mstrMsgBoxImpl.MSG_ERROR});}}}}if(!G){for(var B in iframe.consolidatedStyles){updateStyleContainer(iframe.consolidatedStyles[B],B);}if(!bIsW3C){iframe.togglePulldownChildren(document.body,true);}iframe.targets=null;microstrategy.loadDynamicJS();microstrategy.registerNewBones();}}catch(D){microstrategy.errors.log(D);}};UpdateHelper.updateComponent=function(cB,parentId){try{var sReplaceHTML;var aScripts=null;var j;var oParentDiv;if(!cB.id){return ;}if(cB.components&&cB.components.length>1){UpdateHelper.replaceComponents(cB.components,cB.id);return ;}else{if(cB.components&&cB.components.length==1){return ;}}if(cB.slid){var slices=document.getElementsByName(cB.id);if(slices&&slices.length>0){for(var i=0,len=slices.length;i<len;i++){if(slices[i].getAttribute("slid")==cB.slid){oParentDiv=slices[i];break;}}}}if(!oParentDiv){var oParentDivs=document.getElementById(cB.id);if(!oParentDivs&&(cB.dialog||cB.css=="1")){iframe.createPlaceHolder(cB.id);oParentDivs=document.getElementById(cB.id);}if(oParentDivs){if(oParentDivs.length>1){for(var i=0;i<oParentDivs.length;i++){if(oParentDivs[i].tagName=="DIV"){oParentDiv=oParentDivs[i];break;}}}else{oParentDiv=oParentDivs;}}}if(oParentDiv){var sReplaceHTML=cB.content.replace(/'/g,"'");if(cB.message=="true"){showMessage({contents:sReplaceHTML,elements:microstrategy.OK_BUTTON,type:mstrMsgBoxImpl.MSG_WARNING});}var scriptArray=[],chartArray=[];var oDivNode=iframe.createElementFromHTML(sReplaceHTML);if(!oDivNode){return ;}iframe.extractScript(oDivNode,scriptArray);iframe.extractImage(oDivNode,chartArray);if(cB.errorInfo){var errorHolder=document.getElementById("errorInfo");if(errorHolder){errorHolder.innerHTML+=cB.errorInfo;}}if(cB.css=="1"){var styleId=oDivNode.getAttribute("styleid");if(!iframe.consolidatedStyles[styleId]){iframe.consolidatedStyles[styleId]=[];}iframe.consolidatedStyles[styleId]=consolidateStyleSheets(oDivNode,iframe.consolidatedStyles[styleId],styleId);}else{if(oParentDiv.getAttribute(mstrHTMLAttributes.ATTR_MODAL)=="true"||(oParentDiv.popupMask)){togglePulldowns(oParentDiv,true);}if(cB.partialUpdate=="true"&&oParentDiv.childNodes.length>1){oParentDiv.innerHTML=oDivNode.innerHTML;}else{if(bIsW3C&&!bIsIE8&&!bIsIE9&&!bIsIE10&&!bIsW3CIE&&!bIsSafari){iframe.setOuterHTML(oParentDiv,oDivNode);}else{if(oParentDiv&&oDivNode){if(cB.isFlashVis&&bIsIE8){var o=oParentDiv.getElementsByTagName("object");if(o&&o.length>0){for(var i=0;i<o.length;i++){o[i].parentNode.removeChild(o[i]);}}}oParentDiv.parentNode.replaceChild(oDivNode,oParentDiv);}if(chartArray.length>0){for(var j=0,cnt=chartArray.length;j<cnt;j++){chartArray[j].src=chartArray[j].getAttribute("dsrc");}}}}for(var i=0,len=scriptArray.length;i<len;i++){eval(scriptArray[i].toString());}}}}catch(err){microstrategy.errors.log(err);}};mstrPathImplScript=true;mstrPathImpl.prototype=new mstrBoneImpl();mstrPathImpl.prototype.commands=null;mstrPathImpl.prototype.openHistoryPageEvent="";mstrPathImpl.prototype.openHistoryPageEventID="";mstrPathImpl.prototype.openHistoryPageEventArgumentID="";mstrPathImpl.prototype.openHistoryPageEventArgumentName="";mstrPathImpl.prototype.pathSize=0;mstrPathImpl.PINNED_CLASS="pinned";mstrPathImpl.PADDING=23;mstrPathImpl.prototype.onload=function(){try{mstrBoneImpl.prototype.onload.call(this);this.updateAccountButton();this.commands=new mstrPathCommandsImpl(this);this.onwinresize();}catch(A){microstrategy.errors.log(A);}};mstrPathImpl.prototype.updateAccountButton=function(){var D=document.getElementById("mstrPathAccount"),B=microstrategy.servletName,A;if(D){if(microstrategy.hasSession&&!mstrApp.isAdminPage&&D.getAttribute("_isstatic")!="true"){D.href="#";var C=microstrategy.menuHover?"mouseover":"click";D["on"+C]=microstrategy.showAccountSCList;}}};mstrPathImpl.prototype.onwinresize=function(){try{if(window.mstrInterfacePlugin){if(microstrategy.pageScreenMode==microstrategy.PAGE_FULL_SCREEN_MODE){return ;}var A=this.id;this.pathBar=microstrategy.findAncestorWithAtt(this.elem,"id","mstrWeb_path");this.footerBar=microstrategy.findAncestorWithAtt(this.elem,"id","mstrWeb_footer");if(!this.pathBar&&!this.footerBar){return ;}if(mstr.utils.ISIE8&&this.pathBar){this.pathBar.className=this.pathBar.className.replace(/ ie8/,"")+" ie8";}this.pathText=this.findChildByCssClass(this.elem,"mstrPathText");if(this.pathText){if(!this.pathBar){this.pathText.onclick=function(D){microstrategy.bone(A).pinPath(D);};}if(!mstr.utils.ISIE){this.pathText.setAttribute("selectable","true");}this.pathAncestor=this.findChildByCssClass(this.pathText,"mstrPathTextAncestors");this.pathCurrent=this.findChildByCssClass(this.pathText,"mstrPathTextCurrent");this.pathAncestors=this.findChildByCssClass(this.pathText,"mstrPathAncestors");this.pathBreadCrumbs=this.findChildByCssClass(this.pathText,"mstrPathBreadCrumbs");this.pathBreadCrumbsParent=this.findChildByCssClass(this.pathText,"mstrPathBreadCrumbsParent","span");this.pathBreadCrumbsAncestors=this.findChildByCssClass(this.pathText,"mstrPathBreadCrumbsAncestors");}this.closeIcon=this.findChildByCssClass(this.footerBar,"mstrFooterPathClose","div");if(this.closeIcon){this.closeIcon.onclick=function(D){microstrategy.bone(A).toggleFooterPath(D);};}var C=this;if(this.pathBar&&this.pathText&&this.pathAncestors&&this.pathBreadCrumbs){this.neededWidth=C.getNeededWidth(),this.availableWidth=C.getAvailWidth();if(this.neededWidth<this.availableWidth){C.hideBreadCrumbs();}else{C.showBreadCrumbs();}}else{window.setTimeout(function(){C.resizePathBar();},10);}}}catch(B){microstrategy.errors.log(B);}};mstrPathImpl.prototype.getNeededWidth=function(){try{var A=this.pathAncestors,E=this.pathBreadCrumbs,B=this.pathAncestor,C=this.pathCurrent;if(A&&E&&B&&C){A.className=A.className.replace(" hidden","");if(!this.hasClass(E,"hidden")){E.className=E.className+" hidden";}return B.scrollWidth+C.scrollWidth+40;}else{return 0;}}catch(D){microstrategy.errors.log(D);}};mstrPathImpl.prototype.hideBreadCrumbs=function(){try{var A=this.pathAncestors,D=this.pathBreadCrumbs,B=this.pathBreadCrumbsAncestors;A.className=A.className.replace(" hidden","");if(!this.hasClass(D,"hidden")){D.className=D.className+" hidden";}if(!this.hasClass(B,"hidden")){B.className=B.className+" hidden";}if(A&&D){this.resizePathBar();}}catch(C){microstrategy.errors.log(C);}};mstrPathImpl.prototype.showBreadCrumbs=function(){try{var A=this.pathAncestors,E=this.pathBreadCrumbs,C=this.pathBreadCrumbsAncestors;if(!this.hasClass(A,"hidden")){A.className=A.className+" hidden";}E.className=E.className.replace(" hidden","");if(!this.hasClass(C,"hidden")){C.className=C.className+" hidden";}this.resizeBreadCrumbs();C.style.left=mstr.$BM.position(E,true).left+"px";var B=this.id;E.onclick=function(F){microstrategy.bone(B).toggleBreadCrumbsSelector(F);};}catch(D){microstrategy.errors.log(D);}};mstrPathImpl.prototype.toggleBreadCrumbsSelector=function(){try{var A=this.findChildByCssClass(this.pathText,"mstrPathBreadCrumbsAncestors");if(A){if(this.hasClass(A,"hidden")){A.className=A.className.replace(" hidden","");}else{A.className=A.className+" hidden";}}}catch(B){microstrategy.errors.log(B);}};mstrPathImpl.prototype.getAvailWidth=function(){try{this.pathText.style.maxWidth="0px";if(mstr.utils.ISIE8){this.pathText.style.display="none";}var K=mstr.utils.BoxModel,D=document.body.clientWidth,G=this.pathBar||this.footerBar,M=microstrategy.findChildWithAtt(G,"div","id","mstrSearchSuggest"),E=microstrategy.findChildWithAtt(G,"div","id","mstrPathAccount"),F=this.findChildByCssClass(G,"mstrFooterPathClose","div"),L=M||E||F,J=Math.min(L?K.position(L).left:D,D),B=this.findChildByCssClass(G,"mstrPathIcons"),C=0;if(!B){B=this.findChildByCssClass(G,"mstrLogoMenu");}if(B){var A=K.position(B),I=A.left+A.width,C=J-I-20;}if(mstr.utils.ISIE8){this.pathText.style.display="block";}return Math.max(C,0);}catch(H){microstrategy.errors.log(H);return 0;}};mstrPathImpl.prototype.resizePathBar=function(){try{var A=this.elem.parentNode;if(A){var C=this.pathCurrent,D=this.pathText,J=this.pathAncestor,H=this.getAvailWidth();if(D){D.style.maxWidth=H+"px";}if(J){this.pathSize=H-(this.pathBar?mstrPathImpl.PADDING:0)-15;this.curWidth=Math.min(this.pathSize/2,C.offsetWidth);var G=this.pathSize-this.curWidth;var I=parseInt(mstr.utils.CSS.getStyleValue(J,"padding-right")),F=J.scrollWidth+I,B=G>F?G-F:0;G-=B;this.curWidth+=B;J.style.maxWidth=Math.max(0,G)+"px";if((bIsDXIE)&&this.pathBar){J.style.marginLeft=-G-20+"px";}if(this.pathBar){C.style.maxWidth=Math.max(0,this.pathSize-(this.isPinned(D)?G:0))+"px";}else{C.style.maxWidth=Math.max(0,this.pathSize-G)+"px";}}if(this.hasClass(D,"hidden")){window.setTimeout(function(){D.className=D.className.replace(" hidden","");},300);}}}catch(E){microstrategy.errors.log(E);}};mstrPathImpl.prototype.resizeBreadCrumbs=function(){try{var A=this.elem.parentNode;if(A){var C=this.pathCurrent,D=this.pathText,G=this.pathBreadCrumbsParent,F=this.pathAncestor,H=this.availableWidth;if(D){D.style.maxWidth=H+"px";G.style.maxWidth=H+"px";C.style.maxWidth=H+"px";F.style.maxWidth=H+"px";}if(G){this.pathSize=H-(this.pathBar?mstrPathImpl.PADDING:0)-50;this.curWidth=Math.min(this.pathSize/2,C.scrollWidth);var I=this.pathSize-this.curWidth;var B=I>G.scrollWidth?I-G.scrollWidth:0;I-=B;G.style.maxWidth=Math.max(0,I)+"px";C.style.maxWidth=Math.max(0,this.pathSize-I)+"px";F.style.maxWidth=Math.max(0,I+31)+"px";}if(this.hasClass(D,"hidden")){window.setTimeout(function(){D.className=D.className.replace(" hidden","");},300);}}}catch(E){microstrategy.errors.log(E);}};mstrPathImpl.prototype.pinPath=function(){try{var E=" "+mstrPathImpl.PINNED_CLASS,B=this.pathText,D=this.pathAncestor,H=this.pathCurrent;if(D&&B&&this.pathBar){var C=this.isPinned(B),G=this.pathSize;if(C){B.className=B.className.replace(E,"");var A=microstrategy.bones;if(A.leftToolbar){A.leftToolbar.resize();}window.setTimeout(function(){H.style.maxWidth=G+"px";},(bIsDXIE?0:300));}else{B.className+=E;H.style.maxWidth=Math.max(0,this.curWidth)+"px";}}}catch(F){microstrategy.errors.log(F);}};mstrPathImpl.prototype.findChildByCssClass=function(F,A,D){try{if(!F){return null;}if(F.getElementsByClassName){return F.getElementsByClassName(A)[0];}else{var D=D||"div",G=new RegExp("(^|\\s)"+A+"(\\s|$)","i");if(F.tagName!=null&&F.tagName.toLowerCase()==D.toLowerCase()&&G.test(F.className)){return F;}var H=F.getElementsByTagName(D),C=H&&H.length;if(C){for(var B=0;B<C;B++){if(G.test(H[B].className)){return H[B];}}}return null;}}catch(E){microstrategy.errors.log(E);return null;}};mstrPathImpl.prototype.hasClass=function(B,A){try{return(" "+B.className+" ").indexOf(" "+A+" ")>-1;}catch(C){microstrategy.errors.log(C);return null;}};mstrPathImpl.prototype.isPinned=function(A){try{return this.hasClass(A,mstrPathImpl.PINNED_CLASS);}catch(B){microstrategy.errors.log(B);return null;}};mstrPathImpl.prototype.toggleFooterPath=function(){var C=document.getElementById("mstrWeb_footer");if(C){C.style.bottom="-41px";var B=this.id;window.setTimeout(function(){C.innerHTML="";microstrategy.unRegisterBone(B);microstrategy.eventManager.ondialogresize();},500);}var A=microstrategy.updateManager;A.add([A.createActionObject(null,mstrUpdateManager.SET_PREFERENCE,microstrategy.servletName+"."+microstrategy.pageName,mstrUpdateManager.actions[mstrUpdateManager.SET_PREFERENCE].paramID,["showFooterPath",0])]);};function mstrPathImpl(A){this.inherits=mstrBoneImpl;this.inherits(A);this.inherits=null;return this;}mstrPathCommandsImpl.prototype=new Object();mstrPathCommandsImpl.prototype.item=null;mstrPathCommandsImpl.prototype.queryEnabled=function(A){try{return true;}catch(B){microstrategy.errors.log(B);}};mstrPathCommandsImpl.prototype.queryState=function(A){try{switch(A){case"openPage":return this.item;default:microstrategy.errors.log(A+" command id not implemented.");break;}}catch(B){microstrategy.errors.log(B);}return null;};mstrPathCommandsImpl.prototype.exec=function(A,F){try{switch(A){case"openPage":var C=microstrategy.updateManager;if(C){mstrUpdateManager.addEvent({OPEN_HISTORY_PAGE:{p:[this.parentBone.openHistoryPageEventArgumentID],n:[this.parentBone.openHistoryPageEventArgumentName],i:this.parentBone.openHistoryPageEventID}});C.useIframe=false;var B=new Array();B.push(C.createActionObject(this.elem,mstrUpdateManager.OPEN_HISTORY_PAGE,microstrategy.servletName+"."+microstrategy.pageName,[this.parentBone.openHistoryPageEventArgumentID],[F]));C.add(B,true);C.flushAndSubmitChanges();}else{var D=createDynamicForm(this.parentBone.openHistoryPageEvent+F);D.method="POST";D.submit();}break;default:microstrategy.errors.log(values[0]+" command id not implemented.");break;}return true;}catch(E){microstrategy.errors.log(E);}};function mstrPathCommandsImpl(A){this.parentBone=A;return this;}mstr.Enum.ColorPickerFlags={NO_COLOR:1,MORE_COLORS:2,GRADIENT_COLORS:4,USER_COLORS:8,GRAPH_GRADIENTS:16,AUTOMATIC:32};mstr.Enum.AttrFormSelector={AUTOMATIC:1,CUSTOM:4,DEFAULT_SORT:1};mstr.bones={};mstr.bones.editors={};mstr.bones.editors.Map={};mstr.controllers.ExportTypes=(function(){var B={};B.exportSet=[{c:"Excel",d:"4",n:"3958",f:"web-export-to-excel;enable-export"},{c:"PDF",d:"3",n:"1877",f:"web-export-to-pdf;enable-pdf;document-html-view-mode"},{c:"HTML",d:"-1",n:"3957",f:"web-export-to-html;enable-html-export;document-html-view-mode"},{c:"Flash",d:"7",n:"14513",f:"rw-flash-view-mode-enabled;web-export-to-flash;enable-flash"}];B.getExportModes=function A(){var C={items:[],value:""};for(var E in this.exportSet){var D=this.exportSet[E];if(mstr.behaviors.featureResolver.resolveFeatSet(D.f)){C.items.push({dssid:D.d,n:microstrategy.descriptors.getDescriptor(D.n),cssClass:"ToolbarList x"+D.c});}}C.value=C.items[0]?C.items[0].dssid:"";return C;};return B;})();mstr.controllers.ZoomFactors=(function(){var C={};var A;C.getZoomFactors=function B(E,J,K){if(!A){A={items:[{n:"400%",dssid:"400"},{n:"300%",dssid:"300"},{n:"200%",dssid:"200"},{n:"150%",dssid:"150"},{n:"125%",dssid:"125"},{n:"100%",dssid:"100"},{n:"75%",dssid:"75"},{n:"50%",dssid:"50"},{n:"25%",dssid:"25"},{n:microstrategy.descriptors.getDescriptor("4809"),dssid:"Width"},{n:microstrategy.descriptors.getDescriptor("4808"),dssid:"Page"}]};}if(typeof (J)=="undefined"){return A;}if(K&&E!=microstrategy.ZOOM_STATIC){A.value=(E==microstrategy.ZOOM_FIT_WIDTH)?"Width":"Page";return A;}var H=[{n:J+"%",dssid:J}];var F=A.items;var D=0,I;for(;D<F.length-2;D++){I=parseInt(F[D].dssid);if(I==J){A.value=J;return A;}if(I<J){break;}}var G={};G.items=mstr.$A.insert(A.items,H,D);G.value=J;return G;};return C;})();mstr.models.ChangeTrackingModel=(function(){mstr.$O.extendsClass(G,mstr.models.BaseModel);G.prototype.init=function B(){mstr.models.BaseModel.prototype.init.apply(this);for(var I in this.props){var H=this.props[I];if(H instanceof mstr.models.ListModel){H.attachEventListener(this,"hashadd_selectedIndices","onHashAdd");H.attachEventListener(this,"hashremove_selectedIndices","onHashRemove");H.set("propName",I);}}};G.prototype.set=function F(J,I){var H=mstr.models.BaseModel.prototype.set.apply(this,[J,I]);if(H){this.changedProps[J]=I;}return H;};G.prototype.onHashAdd=function E(H){var I=H.src.get("propName");this._updateChangedProp(I);};G.prototype.onHashRemove=function A(H){var I=H.src.get("propName");this._updateChangedProp(I);};G.prototype._updateChangedProp=function C(K){var J=this.get(K);var M=J.get("valueForm");var L=J.getSelectedItems();var H="";for(var I=0;I<L.length;I++){H+=L[I][M]+"|";}if(H.charAt(H.length-1)=="|"){H=H.substring(0,H.length-1);}this.changedProps[K]=H;};G.prototype.getChanges=function D(){return this.changedProps;};function G(H){mstr.models.BaseModel.apply(this,[H]);this.changedProps={};}return G;})();mstr.models.ChangeTrackingModelManager=(function(){mstr.$O.extendsClass(A,mstr.models.BaseModel);A.prototype.getChangesAsString=function C(G){var O="";var L;var N;var H;if(!G){G=UNIT_SEPARATOR;}for(var F in this.props){var E=this.props[F];N="";if(E instanceof mstr.models.ChangeTrackingModel){L=M.getChanges();for(var K in L){H=L[K];if(isNaN(H)){H='"'+H+'"';}N+=K+"="+L[K]+G;}N=N.substring(0,N.length-1);O+=N+G;}else{if(E instanceof mstr.models.ListModel){var J=E.props.items;for(var I=0;I<J.length;I++){var M=J[I];N="";if(M instanceof mstr.models.ChangeTrackingModel){L=M.getChanges();for(var K in L){H=L[K];if(isNaN(H)){H='"'+H+'"';}N+=K+"="+H+G;}if(N.charAt(N.length-1)==G){N=N.substring(0,N.length-1);}if(N.length>0){O+=N+G;}}}}}}if(O.charAt(O.length-1)==G){O=O.substring(0,O.length-1);}return O;};A.prototype.execSubmitChanges=function B(E){};A.prototype.execCancelChanges=function D(){};function A(E){mstr.models.BaseModel.apply(this,[E]);}return A;})();mstr.models.FilterDetailsEditor=(function(){mstr.$O.extendsClass(E,mstr.models.ChangeTrackingModelManager);E.prototype.PROPERTY_SET_NAME="FilterDetailsFormatProperties";E.prototype.PROPERTY_NAME="FilterDetailsFormat";E.prototype.getChangesAsString=function D(G){var J=mstr.models.ChangeTrackingModelManager.prototype.getChangesAsString.apply(this,[G]);J=this.updateRelatedProperties(J);if(!J||J.length==0){return J;}if(!G){G=UNIT_SEPARATOR;}var I=this.props.oldValue||"";var F;var H;var M;var N;var P;var O='\\s*\\b[A-Za-z]+\\b\\s*=\\s*([0-9]+|"[^"]*")\\s*';var L=J.split(G);for(var K=0;K<L.length;K++){M=L[K].indexOf("=");if(M==-1){continue;}F=L[K].substring(0,M);H=L[K].substring(M+1);if(F=="isComplex"){continue;}if(isNaN(H)){H=H.substring(1,H.length-1);if(H.indexOf("\\")>=0){H=H.replace("\\","\\\\");}if(H.indexOf('"')>=0){H=H.replace('"','\\",');}H='"'+H+'"';}N=I.indexOf(F);if(N>=0){P=I.substring(N);P=P.match(O);if(P){if(H!="-1"&&H!=""){I=I.replace(P[0],L[K]);}else{I=I.replace(P[0],"");}}}else{if(H!="-1"){I+=","+L[K];}}}if(I.charAt(0)==","){I=I.substring(1);}if(I.charAt(I.length-1)==","){I=I.substring(0,I.length-1);}return I;};E.prototype.execSubmitChanges=function B(H){var J=this.getChangesAsString(H);var G=microstrategy.updateManager;if(microstrategy.EXECUTION_SCOPE==microstrategy.RWD_EXECUTION){var L=microstrategy.getViewerBone().doc;var F=[];if(L){if(!this.props.objId){L.processRWDocProperty(this.PROPERTY_NAME,J);}else{var K=mstrUpdateManager.createPropertyEditString(this.props.objId,this.PROPERTY_NAME,J);F.push(G.createActionObject(null,mstrUpdateManager.EDIT_PROPS,L.parentBone.beanPath,["2048018","2048035"],[mstrUpdateManager.UPDATE_NOW,K],[]));F.push(G.createActionObject(null,mstrUpdateManager.APPLY_CHANGES,L.parentBone.beanPath,["2048018","2048035"],[mstrUpdateManager.UPDATE_NOW,K],[]));G.add(F);G.flushAndSubmitChanges();}}}else{var I=microstrategy.bone("UniqueReportID");var F=new Array();I.setReportProp(this.PROPERTY_SET_NAME,this.PROPERTY_NAME,J,F);G.add(F);G.flushAndSubmitChanges();}return true;};E.prototype.updateRelatedProperties=function C(F){var G=F.replace(" ","");if(G.indexOf("SBLT=-1")>=0){F+=UNIT_SEPARATOR+"CDLT=";}return F;};E.prototype.execCancelChanges=function A(){return true;};function E(F){mstr.models.ChangeTrackingModelManager.apply(this,[F]);}return E;})();mstr.models.TaskModel=(function(){mstr.$O.extendsClass(A,mstr.models.BaseModel);A.prototype.execFetchBlock=function C(G,F,E){var D=this.props.requestContext;if(D&&D.id){this.cancelRequest(D.id);this.set("readyState",mstr.Enum.Widget.READYSTATE.CANCELLED);}this.waitingElement=F;this.submitRequest(G,E);};A.prototype.loadRequestResponse=function B(){var D=this.props.requestContext;var F=D&&D.response;if(!F||!F.data){if(this.get("readyState")!=mstr.Enum.Widget.READYSTATE.WAITING){this.set("readyState",mstr.Enum.Widget.READYSTATE.ERROR);}return ;}var G=F.data;this.set("models",G.get("models"));this.set("views",G.get("views"));var E=G.get("views")[0];E.set("element",this.waitingElement);E.set("document",this.waitingElement.ownerDocument);this.set("renderableView",E);this.set("readyState",mstr.Enum.Widget.READYSTATE.IDLE);this.props.requestContext={};};function A(D){mstr.models.BaseModel.apply(this,[D]);}return A;})();mstr.models.SelectDataSetModel=(function(){mstr.$O.extendsClass(C,mstr.models.ListModel);C.prototype.setItems=function B(I){for(var J=0;J<I.length;J++){if(I[J].tp===microstrategy.DSSTYPE_FOLDER){I[J].did=I[J].dssid;}else{I[J].did=I[J].did||I[J].dssid;}}mstr.models.ListModel.prototype.setItems.apply(this,[I]);};C.prototype.execSelectDataset=function H(){var I=this.getSelectedItems();if(I==null){return false;}var K=this.get("oldDSID");var L=this.get("ReplaceAllDS");var J=(K&&(K.length>0))||L;this.get("opener").handleDatasetExplorer({items:I,formatting:this.get("addWithFormatting"),oldDSID:K,oldDSType:this.get("oldDSType"),ReplaceAllDS:L});return true;};C.prototype._showWarningMessage=function G(I){showMessage({contents:microstrategy.descriptors.getDescriptor(I),elements:microstrategy.OK_BUTTON,type:mstrMsgBoxImpl.MSG_WARNING});document.getElementById(currentModalEditor[0]).style.zIndex=9999;};C.prototype._updateCommandEnabledSelectDataset=function F(){this.set("CommandEnabledSelectDataset",(this.getSelectedItem()!=null));};C.prototype.on_hashadd_selectedIndices=function A(I){mstr.models.ListModel.prototype.on_hashadd_selectedIndices.apply(this,[I]);if(I&&I.src==this){this._updateCommandEnabledSelectDataset();}};C.prototype.on_hashremove_selectedIndices=function D(I){mstr.models.ListModel.prototype.on_hashremove_selectedIndices.apply(this,[I]);if(I&&I.src==this){this._updateCommandEnabledSelectDataset();}};C.prototype.execOpenImportData=function E(){var I=this,J=function J(K){if(!K||!K.length){return false;}I.get("opener").handleDatasetExplorer({items:K,oldDSID:I.get("oldDSID"),oldDSType:I.get("oldDSType"),ReplaceAllDS:I.get("ReplaceAllDS")});return true;};microstrategy.openDataImport({AnalysisId:microstrategy.bone("rwb_viewer").messageID,callback:J});};function C(I){mstr.models.ListModel.apply(this,[I]);this._updateCommandEnabledSelectDataset();}return C;})();mstr.models.AnnotationModel=(function(){mstr.$O.extendsClass(F,mstr.models.BaseModel);F.ADDITION_MAX_LENGTH=32000;F.NOTES_MAX_LENGTH=65535;F.prototype.execSetMode=function H(I){this.set("mode",I);};F.prototype.loadRequestResponse=function B(){var I=this.props.requestContext;var J=I&&I.response;if(!J||!J.data){this.set("readyState",mstr.Enum.Widget.READYSTATE.ERROR);return ;}var K=J.data;if(I.memo.command=="fetch"||I.memo.command=="add"||I.memo.command=="save"){this.set("value",decode(K.annotation));}this.props.requestContext={};this.set("readyState",mstr.Enum.Widget.READYSTATE.IDLE);};F.prototype.execSave=function C(){var I=new mstr.http.SaveAnnotationsInputs(this.get("objectID"),this.get("objectType"),this.get("value").substring(0,F.NOTES_MAX_LENGTH-this.get("postfixLen")),0);this.submitRequest(I,{command:"save"});return true;};F.prototype.execAdd=function E(I){var J=new mstr.http.SaveAnnotationsInputs(this.get("objectID"),this.get("objectType"),I.substring(0,F.ADDITION_MAX_LENGTH-this.get("addition").get("prefixLen")-this.get("addition").get("postfixLen")),1);this.submitRequest(J,{command:"add"});return true;};F.prototype.execFetch=function D(){var I=new mstr.http.GetAnnotationsInput(this.get("objectID"),this.get("objectType"),"GetAnnotationsStyle");this.submitRequest(I,{command:"fetch"});return true;};F.prototype.updateValue=function A(I){if(I!=this.get("value")){this.set("CommandEnabledValidateEdit",true);}};F.prototype.execValidateEdit=function G(I){return true;};function F(I){if(I.value){I.value=decode(I.value);}mstr.models.BaseModel.apply(this,[I]);this.set("CommandEnabledValidateEdit",false);}return F;})();mstr.models.AnnotationAddArea=(function(){mstr.$O.extendsClass(B,mstr.models.BaseModel);B.prototype.execClear=function A(){this.set("value","");return true;};B.prototype.execValidateAdd=function C(E,F){return true;};B.prototype.updateValue=function D(E){this.set("CommandEnabledValidateAdd",true);};function B(E){mstr.models.BaseModel.apply(this,[E]);this.set("CommandEnabledValidateAdd",false);}return B;})();mstr.models.NotesIconModel=(function(){mstr.$O.extendsClass(B,mstr.models.BaseModel);B.prototype.loadRequestResponse=function A(){var D=this.props.requestContext;var E=D&&D.response;if(!E||!E.data){this.set("readyState",mstr.Enum.Widget.READYSTATE.ERROR);return ;}var F=E.data;this.set("hasAnnotation",F.hasAnnotation);this.props.requestContext={};this.set("readyState",mstr.Enum.Widget.READYSTATE.IDLE);};B.prototype.execCheck=function C(){this.set("hasAnnotation",false);var D=new mstr.http.GetAnnotationsInput(this.get("objectID"),this.get("objectType"),"CheckAnnotationsStyle");this.submitRequest(D,{});return true;};function B(D){mstr.models.BaseModel.apply(this,[D]);}return B;})();mstr.models.ColorPicker=(function(){mstr.$O.extendsClass(C,mstr.models.ListModel);C.prototype.init=function B(){mstr.models.ListModel.prototype.init.apply(this);var G=this.getItems()&&this.getItems()[0];if(G){this.set("hasColor",G[this.get("valueForm")]!="transparent");}};C.prototype.on_hashadd_selectedIndices=function E(G){mstr.models.ListModel.prototype.on_hashadd_selectedIndices.apply(this,[G]);var I=this.getSelectedItem();if(I){var H=this.set("actualColor",I[this.get("valueForm")]);}};C.prototype.execSelectValue=function D(G){if(G==null||G==""){G="#000000";}var H=parseInt(G,10);if(!isNaN(H)&&H<0){G="#000000";}if(G!="transparent"&&G!="automatic"){G=G.toUpperCase();}if(mstr.models.ListModel.prototype.execSelectValue.apply(this,[G])){return true;}this.set("actualColor",G);this.execClearSelect();this.raiseEvent("hashremove_selectedIndices",{name:"selectedIndices",at:{}});return true;};C.prototype.set=function A(H,G){if(H=="actualColor"&&this.props.enableReselect&&this.props[H]==G){this.raiseEvent("set_"+H,{name:H,value:G,valueWas:G});return true;}else{return mstr.models.ListModel.prototype.set.apply(this,arguments);}};C.prototype.execInsertCustomColor=function F(Q){if(!Q||!this.getItems()||!this.getItems()[0]){return ;}var K=this.get("valueForm");var J=mstr.$H.clone(this.getItems()[0]);J[K]=Q;if(K!="n"){J.n=microstrategy.descriptors.getDescriptor("2133")+" "+Q;}var L=-1;var R=mstr.$A.len(this.props.items);var P=this.get("maxSize");if(P>-1&&P<=R){L=0;var I={min:P-1,max:R-1};this.removeItemsAtRanges([I],true);}this.execSingleSelect(this.insertItemsAt([J],L));this.set("hasColor",true);var M=microstrategy&&microstrategy.updateManager;if(M){var G="";var O="";var N=this.getItems();for(var H=0;H<8;H++){if(N[H][K]=="transparent"){break;}G+=O+N[H][K];O=",";}M.add([M.createActionObject(null,mstrUpdateManager.SET_PREFERENCE,mstr.$obj("mstrPageInfo").get("beanPath"),["5003","5004"],["userPalette",G],[],null)],true);}};function C(G){mstr.models.ListModel.apply(this,[G]);}return C;})();mstr.models.AdvancedColorPicker=(function(){mstr.$O.extendsClass(C,mstr.models.BaseModel);C.monitoredFields=["color","rootColor","hex","r","g","b","h","s","v"];C.prototype.init=function I(){mstr.models.BaseModel.prototype.init.apply(this);for(var J=0;J<9;J++){this["on_set_"+C.monitoredFields[J]]=this.synchFields;}this.get("basicColors").attachEventListener(this,"set_actualColor","synchFields");this.getTarget()&&this.initFromTarget();};C.prototype.getTarget=function A(){return this.get("targetPath")?mstr.controllers.Factory.getPath(this.get("targetPath"),this):null;};C.prototype.initFromTarget=function B(){if(!this.getTarget()){return ;}this.set("color",this.getTarget().getCurrentColor());this.set("activeControlId",this.getTarget().getActiveControlId());};C.prototype.execUpdateTarget=function E(){if(!this.getTarget()){return ;}this.getTarget().exec("advColorPicker",this.get("activeControlId")+"|"+this.get("color"));};C.prototype.set=function H(M,K){mstr.models.BaseModel.prototype.set.apply(this,[M,K]);if(M=="opener"){var J=K&&K.getModel&&K.getModel();if(!J){return ;}var L=J.get("actualColor");if(L){L=L.split(",")[0];if(L=="transparent"){L="#ffffff";}else{if(L.charAt(0)!="#"){L="#"+L;}}this.set("color",L);}mstr.$obj("mstrPageInfo").get("userPalette").attachEventListener(this,"set_actualColor","synchFields");}if(M=="targetPath"){this.getTarget()&&this.initFromTarget();mstr.$obj("mstrPageInfo").get("userPalette").attachEventListener(this,"set_actualColor","synchFields");}};C.prototype.synchFields=function F(J){if(this.synchronizing){return ;}switch(J.name){case"set_color":this.synchronizing=true;var M=J.memo.value;this.set("hex",M.substr(1));var L=mstr.utils.Color.hex2rgb(M);this.set("r",L[0]);this.set("g",L[1]);this.set("b",L[2]);var K=mstr.utils.Color.rgb2hsv(L[0],L[1],L[2]);this.set("h",K[0]);this.set("s",K[1]);this.set("v",K[2]);this.set("rootColor","#"+mstr.utils.Color.hsv2hex(K[0],100,100));this.synchronizing=false;break;case"set_hex":this.set("color","#"+(this.get("hex")||"000000"));break;case"set_r":case"set_g":case"set_b":this.set("color","#"+mstr.utils.Color.rgb2hex(this.get("r"),this.get("g"),this.get("b")));break;case"set_h":case"set_s":case"set_v":this.set("color","#"+mstr.utils.Color.hsv2hex(this.get("h"),this.get("s"),this.get("v")));break;case"set_actualColor":var M=J.src.get("actualColor");if(M!="transparent"){this.set("color",M);}break;}};C.prototype.execDetachUserPalette=function G(J){mstr.$obj("mstrPageInfo").get("userPalette").detachEventListener(this,"set_actualColor");};C.prototype.execAddUserColor=function D(J){var L=this.get("color");if(this.get("basicColors").indexOfValue(L)!=-1){return ;}var K=mstr&&mstr.$obj("mstrPageInfo")&&mstr.$obj("mstrPageInfo").get("userPalette");if(!K||K.indexOfValue(L)!=-1){return ;}K.execInsertCustomColor(L);};function C(J){mstr.models.BaseModel.apply(this,[J]);}return C;})();mstr.models.GradientEditor=(function(){mstr.$O.extendsClass(B,mstr.models.BaseModel);B.prototype.init=function D(){mstr.models.BaseModel.prototype.init.apply(this);this["on_set_gradient"]=this.gradientChange;this.get("color1").attachEventListener(this,"set_actualColor","gradientChange");this.get("color2").attachEventListener(this,"set_actualColor","gradientChange");this.get("gradientType").attachEventListener(this,"hashadd_selectedIndices","gradientChange");this.get("variants").attachEventListener(this,"hashadd_selectedIndices","gradientChange");};B.prototype.set=function A(I,G){mstr.models.BaseModel.prototype.set.apply(this,[I,G]);if(I=="opener"){var F=G&&G.getModel&&G.getModel();if(!F){return ;}var H=F.get("actualColor");if(H&&H.indexOf(",")>-1){this.set("gradient",H);}else{H=(H&&H!="transparent")?H.substr(1):"000000";this.set("gradient",H+",ffffff,14,0,0,0");}}};B.prototype.gradientChange=function C(Q){if(this.changingGradient){return ;}switch(Q.name){case"set_gradient":this.changingGradient=true;var I=Q.memo.value.split(",");this.get("color1").execSelectValue("#"+I[0]);this.get("color2").execSelectValue("#"+I[1]);var K,J,G;var L=I.slice(2).join(",");var F=this.get("variantsCache");var P=F.length+1;for(J=0,G=F.length;J<G;J++){var H=F[J];var S=H.indexOfValue(L);if(S!=-1){P=J+1;K=H;break;}}this.get("gradientType").execSelectValue(P);if(P==gradientUtil.GRADIENTSHADING_STYLE_CUSTOM){this.customGradientInit(L);}if(K){var R=mstr.utils.Hash.deepClone(K.getItems());for(J=0,G=R.length;J<G;J++){R[J].dssid=I[0]+","+I[1]+","+R[J].dssid;}var N=this.get("variants");N.setItems(R);N.execSelectValue(Q.memo.value);}this.changingGradient=false;break;case"set_actualColor":case"hashadd_selectedIndices":if(Q.src==this.get("variants")){this.changingGradient=true;this.set("gradient",this.get("variants").getSelectedItemValue());this.changingGradient=false;}else{var L=this.get("color1").get("actualColor").substr(1)+",";L+=this.get("color2").get("actualColor").substr(1)+",";var M=this.get("gradientType").getSelectedIndex();var O=this.get("variantsCache");if(!O[M]){return ;}L+=O[M].getSelectedItemValue();this.set("gradient",L);}break;}};B.prototype.customGradientInit=function E(F){};function B(F){mstr.models.BaseModel.apply(this,[F]);}return B;})();mstr.models.GraphGradientEditor=(function(){mstr.$O.extendsClass(E,mstr.models.GradientEditor);E.prototype.init=function B(){mstr.models.GradientEditor.prototype.init.apply(this);this.get("transitionType").attachEventListener(this,"hashadd_selectedIndices","customGradientChange");this.attachEventListener(this,"set_angle","customGradientChange");this.attachEventListener(this,"set_xOffset","customGradientChange");this.attachEventListener(this,"set_yOffset","customGradientChange");};E.prototype.customGradientChange=function D(F){var G=this.get("color1").get("actualColor").substr(1)+",";G+=this.get("color2").get("actualColor").substr(1)+",";G+=this.get("transitionType").getSelectedItemValue()+",";G+=this.get("angle")+","+this.get("xOffset")+","+this.get("yOffset");this.changingGradient=true;this.set("gradient",G);this.changingGradient=false;};E.prototype.customGradientInit=function A(F){var G=F.split(",");if(G.length==4){this.get("transitionType").execSelectValue(G[0]);this.set("angle",G[1]);this.set("xOffset",G[2]);this.set("yOffset",G[3]);}};E.prototype.gradientChange=function C(F){if(this.changingGradient){return ;}if(this.get("gradientType").getSelectedItemValue()==gradientUtil.GRADIENTSHADING_STYLE_CUSTOM){this.customGradientChange(null);return ;}mstr.models.GradientEditor.prototype.gradientChange.apply(this,arguments);};function E(F){mstr.models.GradientEditor.apply(this,[F]);}return E;})();mstr.models.Validator=(function(){mstr.$O.extendsClass(A,mstr.models.BaseModel);A.prototype.setValidationStatus=function B(E){var D=this.get("parent");if(!D){return true;}if(E.length==0){D.set("validationStatus",{statusCode:mstr.Enum.Validation.STATUSCODE.VALID,message:"",bubble:true});return true;}var C=this.get("errMessage")||E;D.set("validationStatus",{statusCode:mstr.Enum.Validation.STATUSCODE.INVALID_ANSWERS,message:C,bubble:true});return false;};function A(C){mstr.models.BaseModel.apply(this,[C]);}return A;})();mstr.models.FieldValidator=(function(){mstr.$O.extendsClass(C,mstr.models.Validator);C.EXCEPTION_DELIMITER=";";C.prototype.intRegExp=/(^-?\d\d*$)/;C.prototype.validate=function B(M){var E="",J=this.props.descriptors;var K=false,F;if(this.get("exceptions")){F=mstr.utils.String.trimDelimited(C.EXCEPTION_DELIMITER+this.get("exceptions")+C.EXCEPTION_DELIMITER,C.EXCEPTION_DELIMITER);if(F.indexOf(mstr.utils.String.trimDelimited(C.EXCEPTION_DELIMITER+M+C.EXCEPTION_DELIMITER,C.EXCEPTION_DELIMITER))!=-1){K=true;}if(K){return this.setValidationStatus(E);}}var I=(M==null||(typeof (M)=="string"&&M.length==0));if(this.get("required")&&I){E=J.errRequired;}if(E.length==0&&!I){var G=rangeErr=regErr=0;var Q="";var L=this.get("max");var H=this.get("min");if(L=="x"){L=null;}if(H=="x"){H=null;}var P=this._resolveComparisonFields("lessThan");var O=this._resolveComparisonFields("greaterThan");var N=this.get("regEx");var D=this.get("type");if(H&&L||H&&P||L&&O||P&&O){Q=J.errMinMax;}else{if(H||O){Q=J.errMinOrGreater;}else{if(L||P){Q=J.errMaxOrLess;}else{if(N){Q=J.errRegEx;}else{if(D){Q=J.errType;}}}}}switch(D){case mstr.Enum.Nodes.DATATYPE.INTEGER:if((!this.intRegExp.test(M)&&!this.snRegExp.test(M))||parseInt(M,10)!=parseFloat(M)){Q=Q.replace("#",J.errTypeInt);G=1;}break;case mstr.Enum.Nodes.DATATYPE.FLOAT:if(!this.floatRegExp.test(M)&&!this.snRegExp.test(M)){Q=Q.replace("#",J.errTypeNum);G=1;}break;}if(!G){Q=Q.replace("# ","");}if((L||H)&&mstr.utils.Math.inNumericRange(M,H,L)){rangeErr=1;}if(H){Q=Q.replace("##",H);}if(L){Q=Q.replace("###",L);}if(!isNaN(P)){if(M>P||G){rangeErr=1;}Q=Q.replace("###",P);}if(!isNaN(O)){if(M<O||G){rangeErr=1;}Q=Q.replace("##",O);}if(N&&!(new RegExp(N,"g").test(M))){regErr=1;}if(G||rangeErr||regErr){E=Q;}}return this.setValidationStatus(E);};C.prototype._resolveComparisonFields=function A(K){var G=this.get(K);if(!G){return NaN;}var J=0;var D,F,E;var I=G.split("|");if(I[0]){var H=I[0].split(";");for(F=0,E=H.length;F<E;F++){D=mstr.$path(H[F],this.get("parent"));J+=parseFloat(D,10);}}if(I[1]){var L=I[1].split(";");for(F=0,E=L.length;F<E;F++){D=mstr.$path(L[F],this.get("parent"));J-=parseFloat(D,10);}}return J;};function C(D){mstr.models.Validator.apply(this,[D]);var E=mstr.controllers.Factory.getPath("userInfo/decimalSeparator",mstr.$obj("mstrPageInfo"));this.floatRegExp=new RegExp("(^-?\\d\\d*\\"+E+"\\d*$)|(^-?\\d\\d*\\"+E+"?\\d*e(\\+|-)\\d+$)|(^-?\\d\\d*$)|(^-?\\"+E+"\\d\\d*$)");this.snRegExp=new RegExp("^-?[1-9](\\"+E+"\\d+)?[Ee]([+-]?\\d+)$");}return C;})();mstr.models.ListValidator=(function(){mstr.$O.extendsClass(B,mstr.models.Validator);B.prototype.validate=function A(D,E){var C=this.get("parent").getModel();if(this.get("required")&&D=="ToggleSelect"){var F=[];if(C.getSelectedIndices()[E]&&C.getSelectedItems().length==1){F=[microstrategy.descriptors.getDescriptor("6076")];}return this.setValidationStatus(F);}return true;};function B(C){mstr.models.Validator.apply(this,[C]);}return B;})();mstr.models.RibbonToolbarModel=(function(){mstr.$O.extendsClass(D,mstr.models.ListModel);D.prototype.init=function B(){microstrategy.bones[this.getId()]=this;mstr.models.ListModel.prototype.init.apply(this,[]);if(microstrategy.pageScreenMode==microstrategy.PAGE_FULL_SCREEN_MODE){this.set("selectedToolbar",0);}this.selectToolbar();};D.prototype.onreload=function A(){var R=this.getSelectedItem();var P=this.getItems();for(var N=0,K=P.length;N<K;N++){var L=P[N];var M=L.visibleFeatures;var J=L.enabledFeatures;var Q=mstr.behaviors.featureResolver.resolveFeatSet(M,true);var O=mstr.behaviors.featureResolver.resolveFeatSet(J,true);if(Q&&!L.visible){this.get("toolbarModels").getItems()[N].execSynchronizeControls();}L.visible=Q;}if(!R.visible||!O){this.execSelectValue(0);}this.raiseEvent("featuresChanged");};D.prototype.onload=function C(){this.onreload();};D.prototype.selectToolbar=function H(){this.set("initializing",true);if(!this.execSelectValue(this.get("selectedToolbar"))){var J=0;while(!this.execSelectValue(J)){J++;}}this.set("initializing",false);};D.prototype.execSingleSelect=function G(L){mstr.controllers.EventManager.notifyWindowListeners({name:"closeMenus"});if(this.props.items[L].enabledFeatures){if(!mstr.behaviors.featureResolver.resolveFeatSet(this.props.items[L].enabledFeatures)){return false;}}mstr.models.ListModel.prototype.execSingleSelect.call(this,L);if((mstrUpdateManager.SET_REPORT_SELECTED_RIBBON||mstrUpdateManager.SET_RW_SELECTED_RIBBON)&&!this.get("initializing")){var K=microstrategy.updateManager;if(!this.action){this.action=K.createActionObject(null,mstrUpdateManager.SET_REPORT_SELECTED_RIBBON||mstrUpdateManager.SET_RW_SELECTED_RIBBON,this.get("beanPath").replace("mstrWeb",microstrategy.servletName),["120005"],[],[],null);K.add([this.action],true);}this.action.newArgs=[this.getSelectedItemValue()];}var J=this.get("toolbarModels");J.execSingleSelect(L);if(J.getSelectedItem().get("requestToolbar")){this.requestToolbar(L);}return true;};D.prototype.requestToolbar=function I(K){var J=this.props.requestContext;if(J&&J.id){this.cancelRequest(J.id);}var L=new mstr.http.LoadToolbarInput();L.params.viewer=this.get("targetPath");L.params.toolbarName=this.getItems()[K]["toolbarName"];L.params.ribbonListName=this.get("ribbonListName");this.submitRequest(L,{index:K});};D.prototype.on_set_readyState=function F(J){if(J.memo.value==mstr.Enum.Widget.READYSTATE.ERROR){microstrategy.handleTaskModelError(J);}mstr.models.ListModel.prototype.on_set_readyState.apply(J);};D.prototype.loadRequestResponse=function E(){var M=this.props.requestContext;var N=M&&M.response;if(!N||!N.data){return ;}var K=N.data.props.n;var R=this.get("toolbarModels");var O=R.getItems();var Q=M.memo.index;var S=K.getItems();for(var L=0,J=S.length;L<J;L++){if(S[L].set){S[L].set("parent",O[Q]);}}var P=K.get("targetPath");if(P){O[Q].set("targetPath",P);}O[Q].setItems(S);O[Q].set("requestToolbar",false);this.props.requestContext={};};function D(J){mstr.models.ListModel.apply(this,[J]);}return D;})();mstr.models.Toolbar=(function(){mstr.$O.extendsClass(C,mstr.models.ListModel);C.prototype.queueStatus={};C.prototype.init=function G(J){if(!this.props.targetPath){var N=this.getAncestorByProperty("targetPath",true);if(N){this.props.targetPath=N.get("targetPath");}}if(this.props.targetPath){var K=this.get("items");for(var M=0,L=K.length;M<L;M++){if(!K[M].targetPath){mstr.controllers.Factory.safeset(K[M],"targetPath",this.props.targetPath);}}}mstr.models.ListModel.prototype.init.apply(this,arguments);};C.prototype.clearQueuedValues=function B(K,J){if(!this.queue){return ;}var L=this.queue[K];if(!L){return ;}if(J){delete L[J];if(mstr.utils.Hash.isEmpty(L)){delete this.queue[K];}}else{delete this.queue[K];}this.set("CommandEnabledSubmitQueue",!this.get("CommandEnabledSubmitQueue"));};C.prototype.queueValue=function E(M,K,L){var J=this.queue||{};var N=J[M]||{};N[K]=L;J[M]=N;this.queue=J;this.set("CommandEnabledSubmitQueue",!this.get("CommandEnabledSubmitQueue"));};C.prototype.execSubmitQueue=function F(K){if(!this.isQueueStatusValid(K)){return ;}var L=mstr.controllers.Factory.getPath(this.get("targetPath"),this);var J=L&&L.commands&&L.commands.exec(K,this.queue[K]);this.clearQueuedValues(K);};C.prototype.queryCommandEnabled=function A(K,J){if(K=="SubmitQueue"&&J&&J[0]){return this.isQueueStatusValid(J[0]);}else{return mstr.models.BaseModel.prototype.queryCommandEnabled.apply(this,arguments);}};C.prototype.setQueueValidationStatus=function D(K,J){this.queueStatus[K]=J;this.set("CommandEnabledSubmitQueue",!this.get("CommandEnabledSubmitQueue"));};C.prototype.isQueueStatusValid=function I(J){return this.queue&&this.queue[J]&&!(this.queueStatus[J]>mstr.Enum.Validation.STATUSCODE.VALID);};C.prototype.execSynchronizeControls=function H(){var J=this.getItems();for(var L=0,K=J.length;L<K;L++){var M=J[L].get&&J[L].get("toolbarHelper");if(M){M.synchronizeControl();}}};function C(J){mstr.models.ListModel.apply(this,[J]);}return C;})();mstr.models.TextBoxModel=(function(){mstr.$O.extendsClass(A,mstr.models.BaseModel);A.prototype.submitParentQueue=function B(){var C=this.props&&this.props.parent&&this.props.parent.execSubmitQueue;if(C&&this.props.queueGroup){this.props.parent.execSubmitQueue(this.props.queueGroup);}};function A(C){mstr.models.BaseModel.apply(this,[C]);}return A;})();mstr.models.ToolbarControlHelper=(function(){mstr.$O.extendsClass(TCH,mstr.models.BaseModel);TCH.prototype.init=function TCH_init(excludedProps){mstr.models.BaseModel.prototype.init.apply(this,arguments);var path=this.get("parent").get("targetPath");if(!path){return ;}this.set("targetPath",path);var that=this;var fn=function(){that.synchronizeControl();};var methods=this.get("parent").get("listenerMethods").split(",");for(var i=0,cnt=methods.length;i<cnt;i++){this[methods[i]]=fn;}if(this.get("targetPath")&&!this.getTarget()){this.synchronizeControl();var h=window.setInterval(function(){if(that.attachToTarget()){window.clearInterval(h);}},100);return ;}this.attachToTarget();};TCH.prototype.attachToTarget=function TCH_attachToTarget(){var target=this.getTarget();if(!target){return false;}this.synchronizeControl();var zz=target.observer&&target.observer.register(this.get("id"));return true;};TCH.prototype.getCmdId=function(){var parent=this.get("parent");return parent&&parent.get("cmdid");};TCH.prototype.getTarget=function(){return mstr.controllers.Factory.getPath(this.get("targetPath"),this);};TCH.prototype.synchronizeControl=function TCH_synchronizeControl(){var target=this.getTarget();var cmdId=this.getCmdId();var b=this.get("visible");var parent=this.get("parent");var vFeatures=parent.get("visibleFeatures");if(vFeatures){b=mstr.behaviors.featureResolver.resolveFeatSet(vFeatures);}if((cmdId&&target)&&(!vFeatures||b)){b=target.commands.queryVisible(cmdId);}this.set("visible",b);if(!b){return false;}b=this.get("enabled");var eFeatures=parent.get("enabledFeatures");if(eFeatures){b=mstr.behaviors.featureResolver.resolveFeatSet(eFeatures);}else{if(cmdId&&target){b=target.commands.queryEnabled(cmdId);}}this.set("enabled",b);return b;};TCH.prototype._getCustomizationInfo=function TCH__getCustomizationInfo(n){return this.get("parent").get(n);};TCH.prototype.processCustomizations=function TCH_processCustomizations(){var ext=this._getCustomizationInfo("extra-url");if(ext){microstrategy.updateManager.addURL(ext);}var js=this._getCustomizationInfo("on-click");if(js){eval(js);}this.execHyperlink(this._getCustomizationInfo("link"),ext);this.execEvent(this._getCustomizationInfo("event"),ext);};TCH.prototype.execHyperlink=function TCH_execHyperlink(link,extraUrl){if(!link){return ;}var h=link.href;if(!h){return ;}var p=link.params;if(link["append-state"]||p){if(!(/\?$/.test(h))){h+="?";}if(link["append-state"]){h=updateLink(h);}h=this._parameterizeUrl(h,p);}if(extraUrl){h+="&"+extraUrl;}var t=this._resolveTarget(link);window.open(h,t);};TCH.prototype.execEvent=function TCH_execEvent(evt,extraUrl){if(!evt){return ;}var p=this.getAncestorByProperty("evtInfo");if(!p){p=this.getAncestorByProperty("ribbonId");p=mstr.$obj(p.get("ribbonId")).getAncestorByProperty("evtInfo",true);}var h=p&&p.get("evtInfo").get(evt["action-id"]);if(!h){return ;}if(evt.iframe){h+="&iframe=true";}var t=this._resolveTarget(evt);if(evt["append-state"]){submitLink({href:h,target:t});}else{if(extraUrl){h+="&"+extraUrl;}window.open(h,t);}};TCH.prototype._parameterizeUrl=function TCH__parameterizeUrl(h,p){if(!p){return h;}var delim=(/\?$/.test(h))?"":"&";var parent=this.get("parent");for(var i=0,cnt=p.length;i<cnt;i++){var v=mstr.controllers.Factory.getPath(p[i].value,parent);v=(v!=undefined)?v:p[i].value;h+=delim+escape(p[i].n)+"="+escape(v);delim="&";}return h;};TCH.prototype._resolveTarget=function TCH__resolveTarget(info){var t="_self";if(info.target){t=info.target;}else{if(info.iframe){t="frameManager";}else{if(info["use-window-open"]){t="_blank";}}}return t;};function TCH(props){mstr.models.BaseModel.apply(this,[props]);}return TCH;})();mstr.models.ToolbarButtonHelper=(function(){mstr.$O.extendsClass(B,mstr.models.ToolbarControlHelper);B.prototype.execPressed=function A(){var D=this.getCmdId();if(D){var E=this.getTarget();var C=E&&E.commands&&E.commands.exec(D);}this.processCustomizations();};function B(C){mstr.models.ToolbarControlHelper.apply(this,[C]);}return B;})();mstr.models.ToolbarDualStateButtonHelper=(function(){mstr.$O.extendsClass(C,mstr.models.ToolbarButtonHelper);C.prototype.synchronizeControl=function A(){if(!mstr.models.ToolbarButtonHelper.prototype.synchronizeControl.apply(this,arguments)){return false;}var D=this.getTarget();this.get("parent").set("state",D&&D.commands.queryState(this.getCmdId()));};C.prototype.execPressed=function B(){var F=this.get("parent");var H=!F.get("state");F.set("state",H);var E=this.getCmdId();if(E){var G=this.getTarget();var D=G&&G.commands&&G.commands.exec(E,H);}this.processCustomizations();};function C(D){mstr.models.ToolbarButtonHelper.apply(this,[D]);}return C;})();mstr.models.ToolbarListHelper=(function(){mstr.$O.extendsClass(B,mstr.models.ToolbarControlHelper);B.prototype.init=function F(H){mstr.models.ToolbarControlHelper.prototype.init.apply(this,arguments);var I=this.get("parent");I.attachEventListener(this,"hashadd_selectedIndices","updateTarget");};B.prototype._getCustomizationInfo=function A(J){var I=this.get("parent");var H=I&&I.getSelectedItem();return(H&&mstr.controllers.Factory.safeget(H,J))||I.get(J);};B.prototype.updateTarget=function C(J){if(this.get("synchronizing")){return ;}var M=this.get("parent");var K=M.getSelectedItem();if(!K){return ;}var I=this.getCmdId();if(I){var L=this.getTarget();var H=L.commands&&L.commands.exec(I,K[M.get("valueForm")]);}this.processCustomizations();};B.prototype.synchronizeControl=function G(){if(!mstr.models.ToolbarControlHelper.prototype.synchronizeControl.apply(this,arguments)){return false;}var J=this.getTarget();var I=J&&J.commands.queryState(this.getCmdId());if(!I){return true;}this.set("synchronizing",true);this.checkItemFeatures();var H=(mstr.$A.isArray(I))?"execSelectValues":"execSelectValue";var K=this.get("parent")[H](I);if(!K){this.get("parent").execClearSelect();}this.set("synchronizing",false);return true;};B.prototype.checkItemFeatures=function E(){if(this.get("noFeatures")){return ;}var K,J;var M=this.get("parent");var N=this.get("cachedItems");if(!N){var I=M.getItems();var H=false;for(K=0,J=I.length;K<J;K++){if(I[K]["visibleFeatures"]){H=true;break;}}if(H){N=mstr.utils.Hash.deepClone(M.getItems());this.set("cachedItems",N);}else{this.set("noFeatures",true);return ;}}N=mstr.utils.Hash.deepClone(N);for(K=N.length-1;K>=0;K--){var L=N[K]["visibleFeatures"];if(!L){continue;}if(!mstr.behaviors.featureResolver.resolveFeatSet(L)){N.splice(K,1);}}M.setItems(N);};B.prototype.pickerButtonPushed=function D(){if(this.get("parent").get("updateOnClick")){this.updateTarget();this.synchronizeControl();return true;}else{return false;}};function B(H){mstr.models.ToolbarControlHelper.apply(this,[H]);}return B;})();mstr.models.ToolbarCheckListHelper=(function(){mstr.$O.extendsClass(G,mstr.models.ToolbarListHelper);G.prototype.init=function D(H){mstr.models.ToolbarListHelper.prototype.init.apply(this,arguments);var I=this.get("parent");I.attachEventListener(this,"hashremove_selectedIndices","cacheAction");I.attachEventListener(this,"hashadd_selectedIndices","cacheAction");};G.prototype.cacheAction=function B(H){if(this.get("synchronizing")){return ;}var I=this._killUpdateTimeout();I.push(this._packageValue(mstr.utils.Arrays.fromHashKeys(H.memo.at,true),(H.name=="hashadd_selectedIndices")));this._setUpdateTimeout(I);};G.prototype.updateTarget=function F(){if(this.get("synchronizing")){return ;}var J=this.get("parent").get("lastSelection");var K=this.get("updateCache")||[this._packageValue(J?[J]:[],true)];this.set("updateCache",null);var I=this.getCmdId();if(I){var L=this.getTarget();var H=L.commands&&L.commands.exec(I,K);}};G.prototype._packageValue=function C(O,H){H=!!H;var N=this.get("parent");var K=N.getItems();var I=N.get("valueForm");var J=[];for(var M=0,L=O.length;M<L;M++){J.push(K[O[M]][I]);}return{cl:H,v:J};};G.prototype._killUpdateTimeout=function A(){if(this.get("updateHandle")){window.clearTimeout(this.get("updateHandle"));this.set("updateHandle",null);if(!!!this.get("discardQueue")){return this.get("updateCache");}}return[];};G.prototype._setUpdateTimeout=function E(H){this.set("updateCache",H);this.set("updateHandle",window.setTimeout('mstr.$obj("'+this.getId()+'").updateTarget();',0));};function G(H){mstr.models.ToolbarListHelper.apply(this,[H]);}return G;})();mstr.models.ToolbarDynamicListHelper=(function(){mstr.$O.extendsClass(A,mstr.models.ToolbarListHelper);A.prototype.synchronizeControl=function B(){if(!mstr.models.ToolbarControlHelper.prototype.synchronizeControl.apply(this,arguments)){return false;}var D=this.getTarget();var C=D.commands.queryState(this.getCmdId());this.set("synchronizing",true);this.get("parent").setItems(C.items);var E=this.get("parent").execSelectValue(C.value);if(!E){this.get("parent").execClearSelect();}this.set("synchronizing",false);return true;};function A(C){mstr.models.ToolbarListHelper.apply(this,[C]);}return A;})();mstr.models.ToolbarColorPickerHelper=(function(){mstr.$O.extendsClass(D,mstr.models.ToolbarControlHelper);D.prototype.init=function C(F){mstr.models.ToolbarControlHelper.prototype.init.apply(this,arguments);var G=this.get("parent");G.attachEventListener(this,"set_actualColor","updateTarget");};D.prototype.updateTarget=function B(F){if(this.get("synchronizing")){return ;}var G=F.memo.value;this.get("parent").set("lastColor",G);this.getTarget().commands.exec(this.getCmdId(),G);};D.prototype.synchronizeControl=function A(){if(!mstr.models.ToolbarControlHelper.prototype.synchronizeControl.apply(this,arguments)){return ;}var G=this.getTarget();var F=G.commands.queryState(this.getCmdId());this.set("synchronizing",true);this.get("parent").execSelectValue(F);this.set("synchronizing",false);F=G.commands.queryState(this.getCmdId()+"_vf");if(F!=""){this.get("parent").set("popup|viewFlags",F);}};D.prototype.pickerButtonPushed=function E(){var G=this.get("parent");var F=G.get("lastColor");if(F){G.set("actualColor",F);this.synchronizeControl();}return true;};function D(F){mstr.models.ToolbarControlHelper.apply(this,[F]);}return D;})();mstr.models.ToolbarTextBoxHelper=(function(){mstr.$O.extendsClass(D,mstr.models.ToolbarControlHelper);D.prototype.init=function A(){mstr.models.ToolbarControlHelper.prototype.init.apply(this,arguments);var E=this.get("parent");E.attachEventListener(this,"set_value","queueValue");};D.prototype.queueValue=function C(E){if(this.get("synchronizing")){return ;}var F=E.memo.value;var G=this.get("parent");var H=G.get("parent");H.queueValue(G.get("queueGroup"),this.getCmdId(),F);};D.prototype.synchronizeControl=function B(){var E=this.get("parent");E.get("parent").clearQueuedValues(E.get("queueGroup"),this.getCmdId());var F="";if(mstr.models.ToolbarControlHelper.prototype.synchronizeControl.apply(this,arguments)){var G=this.getTarget();F=G.commands.queryState(this.getCmdId())||"";}this.set("synchronizing",true);this.get("parent").set("value",F);this.set("synchronizing",false);};function D(E){mstr.models.ToolbarControlHelper.apply(this,[E]);}return D;})();mstr.models.ToolbarButtonModel=(function(){mstr.$O.extendsClass(A,mstr.models.BaseModel);A.prototype.DEFAULTS={tooltip:"",enabled:true,visible:true};function A(B){mstr.models.BaseModel.apply(this,[B]);}return A;})();mstr.models.BlockContainer=(function(){mstr.$O.extendsClass(B,mstr.models.BaseModel);B.prototype.init=function A(){mstr.models.BaseModel.prototype.init.call(this,["models","views"]);var D,G,F,C;var E=this.props[mstr.$W.DOCUMENT];G=this.props.models;for(D=0;G&&G.length&&D<G.length;D++){F=G[D][mstr.$W.SCRIPTCLASS]&&mstr.controllers.Factory.registerJSON(G[D],E);if(F){G[D]=F;C=F.props&&(F.props[mstr.$W.PARENT]=this);C=F.init&&F.init();}}G=this.props.views;for(D=0;G&&G.length&&D<G.length;D++){F=G[D][mstr.$W.SCRIPTCLASS]&&mstr.controllers.Factory.registerJSON(G[D],E);if(F){G[D]=F;C=F.props&&(F.props[mstr.$W.PARENT]=this);C=F.init&&F.init();}}};function B(C){mstr.models.BaseModel.apply(this,[C]);}return B;})();mstr.models.InsertLayoutEditor=(function(){mstr.$O.extendsClass(D,mstr.models.BaseModel);D.prototype.init=function C(){this.props.existingLayouts.styleName="WidgetFolderStyle";mstr.models.BaseModel.prototype.init.call(this,["models","views"]);var H=["tabList","newDashboardLayouts","newDocumentLayouts","existingLayouts"];for(var G=0;G<4;G++){var F=this.get(H[G]);F.attachEventListener(this,"hashadd_selectedIndices","updateCommandEnabledSubmitModel");F.attachEventListener(this,"hashremove_selectedIndices","updateCommandEnabledSubmitModel");}};D.prototype.updateCommandEnabledSubmitModel=function A(){this.set("CommandEnabledSubmitModel",(this._getSelectedItem()!=null));};D.prototype.execSubmitModel=function B(){var H=this._getSelectedItem();if(!H){return false;}var I=mstr.$obj(this.props.boneId);if(I){I.commands.exec("unloadDocViewer");}var G=this.get("tabList").getSelectedIndex()!=2?"1":"0";var F=microstrategy.updateManager;F.add([F.createActionObject(null,mstrUpdateManager.RW_IMPORT_DOC,mstr.$obj("mstrPageInfo").get("beanPath"),["2048001","2048175"],[H.dssid,G])]);F.flushAndSubmitChanges();return true;};D.prototype._getSelectedItem=function E(){var F=this.get("tabList").getSelectedIndex();if(F==NaN||F==-1){return null;}if(F==0){p="newDashboardLayouts";}else{if(F==1){p="newDocumentLayouts";}else{if(F==2){p="existingLayouts";}}}return this.get(p).getSelectedItem();};function D(F){mstr.models.BaseModel.apply(this,[F]);}return D;})();mstr.models.ContextMenuModel=(function(){mstr.$O.extendsClass(F,mstr.models.BaseModel);F.prototype.execPopulate=function C(){if(this.gridMenuItemsMap[this.getGridKey()]==null){var L=null;L=new mstr.http.OndemandContextMenuInputs(this.getGridKey());this.submitRequest(L,{});}else{this.raiseEvent("set_menu_ready",null);}};F.prototype.clearMenuItems=function K(L){this.gridMenuItemsMap[L]=null;this.submittedGridKeys[L]=null;};F.prototype.submitRequest=function H(M,L){this.raiseEvent("set_menu_processing",null);if(this.submittedGridKeys[this.getGridKey()]==null){var N=mstr.models.BaseModel.prototype.submitRequest.apply(this,[M,L]);this.submittedGridKeys[this.getGridKey()]=N;}};F.prototype.setGridKey=function A(L){this.gridKey=L;};F.prototype.getGridKey=function B(){return this.gridKey;};F.prototype.setCurrentDynamicMenuKey=function I(L){this.currentDynamicMenuKey=L;};F.prototype.getCurrentDynamicMenuKey=function G(){return this.currentDynamicMenuKey;};F.prototype.onRequestCallback=function J(L){mstr.models.BaseModel.prototype.onRequestCallback.apply(this,[L]);switch(this.props.readyState){case mstr.Enum.Widget.READYSTATE.ERROR:this.raiseEvent("set_hide_menu_processing",null);this.submittedGridKeys[this.getGridKey()]=null;break;}};F.prototype.loadRequestResponse=function D(){var L=this.props.requestContext;var Q=L&&L.response&&L.response.data;if(!Q){this.set("readyState",mstr.Enum.Widget.READYSTATE.ERROR);this.submittedGridKeys[this.getGridKey()]=null;return ;}if(Q.dynamicMenus&&Q.menuItems){var N=JSON.parse(Q.dynamicMenus.substring(Q.dynamicMenus.indexOf(" = ")+3).replace(/]];/,"]]"));var P=this.getGridKey();for(var O=0;O<N.length;O++){var M=N[O][0];this.dynamicMenusMap[P+M]=N[O][1];}this.gridMenuItemsMap[P]=JSON.parse(Q.menuItems.replace(/\\\'/g,"'").replace(/]];/,"]]"));}this.props.requestContext={};this.set("readyState",mstr.Enum.Widget.READYSTATE.IDLE);this.raiseEvent("set_hide_menu_processing",null);this.raiseEvent("set_menu_ready",null);};F.prototype.getMenuItems=function E(){return this.gridMenuItemsMap[this.getGridKey()];};F.prototype.getCurrentMenuItemIndices=function(){var L=this.getGridKey()+this.getCurrentDynamicMenuKey();return this.dynamicMenusMap[L]||null;};function F(L){mstr.models.BaseModel.apply(this,[L]);this.gridMenuItemsMap=[];this.dynamicMenusMap=[];this.currentDynamicMenuKey=null;this.gridKey=null;this.submittedGridKeys=[];}return F;})();mstr.models.ToolbarPickerListModel=(function(){mstr.$O.extendsClass(C,mstr.models.ListModel);C.prototype.on_hashadd_selectedIndices=function B(E){this._storeLastSelection(E);mstr.models.ListModel.prototype.on_hashadd_selectedIndices.apply(this,arguments);};C.prototype.on_hashremove_selectedIndices=function A(E){this._storeLastSelection(E);mstr.models.ListModel.prototype.on_hashremove_selectedIndices.apply(this,arguments);};C.prototype._storeLastSelection=function D(E){var F=this.get("toolbarHelper");if(!F||!F.get||F.get("synchronizing")){return ;}this.set("lastSelection",mstr.utils.Hash.firstKey(E.memo.at));};function C(E){mstr.models.ListModel.apply(this,[E]);}return C;})();mstr.models.ToolbarBorderListModel=(function(){mstr.$O.extendsClass(B,mstr.models.ToolbarPickerListModel);B.prototype.execToggleSelect=function A(C){var F=this.props.selectedIndices;if(F[C]){if(C<2){return false;}else{if(F[0]){this.execRemoveSelect(0);}}this.execRemoveSelect(C);if(!F[2]&&!F[3]&&!F[4]&&!F[5]){C=1;this.execAddSelect(C);}}else{if(C==1){this.execClearSelect();}else{if(F[1]){this.execRemoveSelect(1);}if(C==0){for(var D=2;D<6;D++){if(!F[D]){this.execAddSelect(D);}}}else{var E=mstr.utils.Hash.clone(F);E[C]=true;if(E[2]&&E[3]&&E[4]&&E[5]){this.execAddSelect(0);}}}this.execAddSelect(C);}this.set("leadIndex",C);return true;};function B(C){mstr.models.ToolbarPickerListModel.apply(this,[C]);}return B;})();mstr.behaviors.TriStateCheckBox=(function(){var B={};B._DISABLED="Disabled";B._INTERMEDIATE="Intermediate";B._ON="On";B._OFF="Off";B.on_set_enabled=function D(F,G,J){var H=J.childNodes[0].childNodes[0].childNodes[0].childNodes[0].childNodes[0];var E=J.childNodes[0].childNodes[0].childNodes[0].childNodes[1].childNodes[0];var I=F.props.cssPrefix+F.props.cssClass;if(F.props.enabled==false){H.className=I+this._DISABLED;E.className=I+"Caption"+this._DISABLED;return ;}else{this.setTriState(F,G,J);}};B.on_model_hashadd_selectedIndices=function C(E,F,G){if(E.get("enabled")){this.setTriState(E,F,G);}};B.setTriState=function A(H,I,L){var J=L.childNodes[0].childNodes[0].childNodes[0].childNodes[0].childNodes[0];var G=L.childNodes[0].childNodes[0].childNodes[0].childNodes[1].childNodes[0];var K=H.props.cssPrefix+H.props.cssClass;var E=I.getSelectedIndex();var F=I.props.items[E].cssClass;switch(E){case 0:J.className=K+(F||this._INTERMEDIATE);break;case 1:J.className=K+(F||this._ON);G.className=K+"Caption"+(F||this._ON);break;case 2:J.className=K+(F||this._OFF);G.className=K+"Caption"+(F||this._OFF);break;}};return B;})();mstr.behaviors.ToolbarPickerButton=(function(){var C=mstr.$H.clone(mstr.behaviors.Pulldown);C.on_set_enabled=function B(F,H,J){var G=!!F.props.enabled;J.disabled=!G;var I="0px",E="0px";if(!G){I="20px";E="22px";}var D=J.childNodes[1].rows[0].cells[1].firstChild.childNodes[3];D.style.height=I;D.style.width=E;};C.pickerButtonPushed=function A(E){var F=mstr.$obj(E);if(!F.get("enabled")){return ;}var D=F.getModel();var G=D.get("toolbarHelper");if(G&&G.pickerButtonPushed&&!G.pickerButtonPushed()){mstr.behaviors.ToolbarPickerButton.onmousedown(E);}};return C;})();mstr.behaviors.ColorPickerPopup=(function(){var A={elements:{0:mstr.Enum.ColorPickerFlags.NO_COLOR,1:mstr.Enum.ColorPickerFlags.AUTOMATIC,3:mstr.Enum.ColorPickerFlags.USER_COLORS,4:mstr.Enum.ColorPickerFlags.MORE_COLORS,5:mstr.Enum.ColorPickerFlags.GRADIENT_COLORS,6:mstr.Enum.ColorPickerFlags.GRAPH_GRADIENTS}};A.resolveViewFlags=function B(D){var C=D.props.viewFlags;for(var E in A.elements){if(!!(C&A.elements[E])){D._showChildViewAtPath("children/"+E);}else{mstr.controllers.Factory.safeset(D.props.children[E],"visible",false);}}};return A;})();mstr.itemrenderers.FastTileView=(function(){var B=mstr.$H.clone(mstr.itemrenderers.FastListView);B.renderListItem=function A(L,F,P,D,C){var R=D.item;var U=L.props[mstr.$W.DOCUMENT];var J=(L.props.cssPrefix||"")+(L.props.itemCSSPrefix||"");if("enabled" in R&&!R.enabled){J+="Disabled";}var G=U.createElement("div");if(R.cssClass){G.className=R.cssClass+" "+J;}else{G.className=J;}if(R.cssText){G.style.cssText=R.cssText;}if(R.desc!=null&&R.desc!=""){G.title=R.n+". "+R.desc;}else{G.title=R.n||"";}var V=U.createElement("div");G.appendChild(V);V.className=J+"Name";if(L.props.showDescriptions&&R.desc){var O=U.createElement("div");G.appendChild(O);O.className=J+"Desc";O.appendChild(U.createTextNode(R.desc));}else{var O=null;}if(L.props.itemCSSPrefix!="TileViewItem"){var T=U.createTextNode(R.n||"");var S=D.browseCommand;if(S&&!R.locked){var K=U.createElement("a");V.appendChild(K);K.appendChild(T);K.href="javascript:void(0)";S=null;}else{V.appendChild(T);}}if(L.props.showIcons&&!C){var Q=R.icon;if(R.locked){Q+="_locked";}var H=U.createElement("div");H.className="mstrTileViewImgContainer";V.appendChild(H);var I;if(!Q){var N=microstrategy.bones.ribbon_graphToolbar.block.get("major").getSelectedItems();if(N){var E=mstr.Settings.Scheme.LARGEPREVIEWS[N[0].icon];I=E+"_"+R.dssid;H.className+=" "+E+"_subtype";}}else{I=mstr.Settings.Scheme.LARGEPREVIEWS[Q];}if(I){if(I.substr(0,5)=="graph"&&Q){H.className+=" graphBgImg";}H.className+=" "+I;if(L.props.itemCSSPrefix!="TileViewItem"){V.style.paddingLeft="23px";if(O){O.style.paddingLeft="23px";}}}else{if(Q){H.className+=" "+Q;if(L.props.itemCSSPrefix!="TileViewItem"){V.style.paddingLeft="23px";if(O){O.style.paddingLeft="23px";}}}}var M=U.createElement("div");M.className=J+"NameImg";H.appendChild(M);M.onmouseover=this.hover;M.onmouseout=this.unhover;}return G;};return B;})();mstr.itemrenderers.PreviewPickerView=(function(){var A=mstr.$H.clone(mstr.itemrenderers.ListPulldownView);A.renderListItem=function(B,D,I,E){var C=mstr.itemrenderers.FastTileView.renderListItem(B,D,I,E,true);var H=this._getContentContainer(I);mstr.utils.Dom.clearChild(H,0);H.appendChild(C);H.title=C.title||"";if(mstr.utils.ISIE4){var F=H.style,G=F.width;if(G==null){G="";}F.width="1px";F.width=G;}};return A;})();mstr.itemrenderers.ColorPickerView=(function(){var A=mstr.$H.clone(mstr.itemrenderers.ListPulldownView);A.renderListItem=function(B,C,E,D){this._renderItem(B,C,E,D.item);};A.renderEmpty=function(C,D,H,E){var G=D&&D.get("actualColor");if(G){var B=D.get("valueForm");var F={};F[B]=G;if(B!="n"){F.n=microstrategy.descriptors.getDescriptor("2133")+" "+G;}this._renderItem(C,D,H,F);}else{mstr.itemrenderers.ListPulldownView.renderEmpty(C,D,H,E);}};A._renderItem=function(E,C,J,I){var F=E.props[mstr.$W.DOCUMENT];var D=(E.props.cssPrefix||"")+(E.props.itemCSSPrefix||"");var B=F.createElement("div");B.className=D+"ColorItem";var G=I[C.get("valueForm")];if(G!=null&&G.indexOf(",")>-1){mstr.itemrenderers.GradientItem.renderGradientItem(B,G,80,12);}else{if(G!="#"&&(!(bIsIE6||bIsIE7||bIsIE8||bIsIE9)||G!="0")){B.style.backgroundColor=(G!="automatic")?G:"transparent";}if(I.n){B.setAttribute("title",I.n);}if(G.toLowerCase()=="transparent"||G.toLowerCase()=="automatic"){B.style.border="1px dashed #999999";}}var H=this._getContentContainer(J);mstr.utils.Dom.clearChild(H,0);H.appendChild(B);};return A;})();mstr.itemrenderers.ColorPickerListView=(function(){var C=mstr.$H.clone(mstr.itemrenderers.ListView);C.renderListItem=function(I,E,M,D){var L=D.item;var K=I.props[mstr.$W.DOCUMENT];var G=(I.props.cssPrefix||"")+(I.props.itemCSSPrefix||"");var H=(L.dssid=="transparent");if(!I.props.renderTransparent&&H){return null;}var F=(L.dssid=="automatic");if(!I.props.renderAutomatic&&F){return null;}if(L.dssid.indexOf(",")>-1){return null;}var J=K.createElement("span");J.className=G+I.props.itemCssClass;J.style.backgroundColor=L.dssid;J.setAttribute("title",L.n);J.onmouseover=this.hover;J.onmouseout=this.unhover;if(H){J.style.cursor="default";}this._insertElementForIndex(I,M,D.at,J);return J;};C.on_set_visible=function B(D,G,I){var H=D.props.visible;if(H){var F=mstr.$obj("mstrPageInfo")&&mstr.$obj("mstrPageInfo").get("userPalette");if(F){if(G&&G.getSelectedItem()){F.execClearSelect();}else{var E=G&&G.get("actualColor");if(E){F.execSelectValue(E.toUpperCase());}}}}mstr.behaviors.Generic.set_css_display(I,"block","none",D.props.visible);};C.hover=function A(){this.className+="Hover";};C.unhover=function A(){this.className=this.className.replace(/Hover/,"");};return C;})();mstr.itemrenderers.GradientItem=(function(){var A={};A.renderGradientItem=function(B,O,G,N){var L=O.split(",");var K=mstr.utils.Color.hex2rgb(L[0]);var J=mstr.utils.Color.hex2rgb(L[1]);var T=gradientUtil.GRADIENTSHADING_STYLE_CUSTOM;var F=1;var C=L[2];var Q=parseInt(L[3],10);var E=parseInt(L[4],10);var D=parseInt(L[5],10);if(C=="9"){T=gradientUtil.GRADIENTSHADING_STYLE_FROMCENTER;F=3;}else{if(C=="10"){if(E==50){T=gradientUtil.GRADIENTSHADING_STYLE_FROMCENTER;if(Q==45){F=2;}}else{T=gradientUtil.GRADIENTSHADING_STYLE_FROMCORNER;if(E+D==200){F=3;}else{if(E+D==100){F=(E==100)?2:4;}}}}else{if(Q==0||Q==90){T=(Q==0)?gradientUtil.GRADIENTSHADING_STYLE_HORIZONTAL:gradientUtil.GRADIENTSHADING_STYLE_VERTICAL;}else{T=(Q==135)?gradientUtil.GRADIENTSHADING_STYLE_DIAGONALUP:gradientUtil.GRADIENTSHADING_STYLE_DIAGONALDOWN;}var P=(Q==0)?E:D;if(P==100){F=2;}else{if(P==50){F=3;}}}}var R=(G/gradientUtil.PIXEL_WIDTH)*(N/gradientUtil.PIXEL_WIDTH);for(var M=0;M<R;M++){var I=document.createElement("div");I.className="pixel";var S=gradientUtil.getColorPercent(gradientUtil.getXCoordinate(M,G),gradientUtil.getYCoordinate(M,N),F,G,T);var H=parseInt(S*(J[0]-K[0]))+K[0];var O=parseInt(S*(J[1]-K[1]))+K[1];var U=parseInt(S*(J[2]-K[2]))+K[2];I.style.backgroundColor="rgb("+H+", "+O+", "+U+")";B.appendChild(I);}};return A;})();mstr.itemrenderers.GradientListView=(function(){var A=mstr.$H.clone(mstr.itemrenderers.ListView);A.renderListItem=function(I,F,M,D){var L=D.item;var K=I.props[mstr.$W.DOCUMENT];var G=(I.props.cssPrefix||"")+(I.props.itemCSSPrefix||"");var J=K.createElement("span");J.className=G;J.setAttribute("title",mstr.itemrenderers.GradientListView._buildTooltip(L.dssid,L.flashOnly));mstr.itemrenderers.GradientItem.renderGradientItem(J,L.dssid,50,50);var H=document.createElement("span");var C=I.props;H.className=C.cssPrefix+C.cssClass+"ItemContainer";var E=document.createElement("span");E.innerHTML=L.flashOnly?microstrategy.descriptors.getDescriptor("4875"):"&nbsp;";E.style.paddingLeft="5px";H.appendChild(E);H.appendChild(J);J=H;this._insertElementForIndex(I,M,D.at,J);return J;};A._buildTooltip=function B(E,D){var F=E.split(",");var C=microstrategy.descriptors.getDescriptor("4883")+" ";if(F[2]=="9"){C+=microstrategy.descriptors.getDescriptor("4889");}else{if(F[2]=="10"){C+=microstrategy.descriptors.getDescriptor("4862");}else{C+=microstrategy.descriptors.getDescriptor("4888");}}C+="; "+microstrategy.descriptors.getDescriptor("4884")+" "+F[3]+"; "+microstrategy.descriptors.getDescriptor("4885")+" "+F[5]+"; "+microstrategy.descriptors.getDescriptor("4886")+" "+F[4];if(D){C+="; "+microstrategy.descriptors.getDescriptor("4875");}return C;};return A;})();mstr.itemrenderers.ToolbarRadioButtons=(function(){var B=mstr.$H.clone(mstr.itemrenderers.ListView);B.renderListItem=function(G,E,L,D){var J=D.item;var I=G.props[mstr.$W.DOCUMENT];var F=(G.props.cssPrefix||"")+(G.props.itemCSSPrefix||"");var H=I.createElement("a");H.className=F;H.setAttribute("title",J.n);var K=I.createElement("span");if(J.id){K.setAttribute("id",J.id);}K.setAttribute("align","absmiddle");K.onmouseover=function(){mstr.itemrenderers.ToolbarRadioButtons.markListItemAsSelected(G,E,L,D);};K.onmouseout=function(){mstr.itemrenderers.ToolbarRadioButtons.markListItemAsUnselected(G,E,L,D);};H.appendChild(K);this._insertElementForIndex(G,L,D.at,H);return H;};B.markListItemAsSelected=function C(D,E,H,F){var G=this._findElementForIndex(D,H,F.at);if(G){G.className+=" on";}};B.markListItemAsUnselected=function A(D,E,H,F){var G=this._findElementForIndex(D,H,F.at);if(G){G.className=G.className.replace(" on","");}};return B;})();mstr.itemrenderers.ToolbarPickerButton=(function(){var A=mstr.$H.clone(mstr.itemrenderers.ListPulldownView);A.renderListItem=function(C,D,F,E){if(C.get("showLastSelection")){var B=D.get("lastSelection");if(!isNaN(B)){E.item=D.getItems()[D.get("lastSelection")];}else{return ;}}mstr.itemrenderers.ListPulldownView.renderListItem.apply(this,[C,D,F,E]);this._updatePickerButton(C,F);};A.renderMultipleItems=function(B,C,E,D){this.renderListItem(B,C,E,D);};A._updatePickerButton=function(B,H){var F=B.getModel().get("tooltip");var E=this._getContentContainer(H);var G=[E];if(B.get("useDynamicBtnImg")){if(E.firstChild.nodeType==3){E.innerHTML="";}else{E.replaceChild(E.firstChild.cloneNode(false),E.firstChild);G.push(E.firstChild);}}else{E.removeChild(E.firstChild);}if(F){for(var D=0,C=G.length;D<C;D++){G[D].setAttribute("title",F);}}};A.renderEmpty=function(B,C,E,D){};A._getContentContainer=function(B){return B.childNodes[1].rows[0].cells[1].firstChild.childNodes[1];};return A;})();mstr.itemrenderers.VerticalTileList=(function(){var A=mstr.$H.clone(mstr.itemrenderers.ListView);A.renderListItem=function(F,D,K,B){var H=B.item;var G=F.props[mstr.$W.DOCUMENT];var E=(F.props.cssPrefix||"")+(F.props.itemCSSPrefix||"");var C=G.createElement("div");C.className=E;C.setAttribute("id","vt_"+H.dssid);if(F.props.showDescriptions&&H.desc){C.setAttribute("title",H.desc);}if(F.props.showIcons){var J=G.createElement("div");J.className=E+"Img";C.appendChild(J);}var I=G.createElement("div");I.className=E+"Txt";I.innerHTML=H.n;C.appendChild(I);this._insertElementForIndex(F,K,B.at,C);return C;};return A;})();mstr.itemrenderers.FontList=(function(){var E={};E.renderListItem=function A(F,G,J,H){var I=mstr.itemrenderers.FastListView.renderListItem.apply(this,[F,G,J,H]);I.style.fontFamily=H.item[G.get("valueForm")];return I;};E.hover=function(F){this.className+="Hover";};E.unhover=function(F){this.className=this.className.replace(/Hover/,"");};E.markListItemAsSelected=function C(F,G,I,H){mstr.itemrenderers.FastListView.markListItemAsSelected.apply(this,[F,G,I,H]);};E.markListItemAsUnselected=function B(F,G,I,H){mstr.itemrenderers.FastListView.markListItemAsUnselected.apply(this,[F,G,I,H]);};E.on_set_leadIndex=function D(F,G,H){mstr.itemrenderers.FastListView.on_set_leadIndex.apply(this,[F,G,H]);};return E;})();mstr.itemrenderers.TabTreeList=(function(){var G={};var E=function(K){var J=mstr.utils.ListViewHelper.getItemRenderer(this);J&&J.on_target_object_change(this,this.getModel(),this.get("element"),{item:K.src,at:this.getModel().indexOfItem(K.src)});};G.on_target_object_change=function F(P,M,S,K){var Q=K.item;var L=mstr.itemrenderers.TabTreeList.findElementFromIndex(P,M,S,K);var O=Q.get(Q.get("visibleField"));L.style.display=(O)?"block":"none";var J=Q.get("categoryText");var N=P.props.categoryElems;if(N&&N[J]){var R=N[J]["visibleElems"];R+=Q.get(Q.get("visibleField"))?1:-1;N[J]["visibleElems"]=R;N[J]["elem"].style.display=(R==0)?"none":"block";}};G.renderListItem=function I(Q,N,W,L){var a=Q.props.document;var P=(Q.props.cssPrefix||"")+(Q.props.cssClass||"");var V=Q.get("scrollArea").childNodes[0];var R=N.getItems();var X=L.item;var T=X.get("categoryText");var O=null;var U=N.get("valueForm");var Z=Q.props.categoryElems;if(!Z){Z=[];Q.props.categoryElems=Z;}if(L.at==0||T!=R[L.at-1].get("categoryText")){O=a.createElement("div");O.className=P+"TabTreeItemCategory";O.appendChild(a.createTextNode(T));V.appendChild(O);var S=X[U];if(S==null&&X.get){S=X.get(U);}O.mstrListItemInfo=Q.getId()+"/"+(S||"")+"/"+L.browseCommand;Z[T]={elem:O,visibleElems:0};O.style.display="none";}var J=X.get("titleField"),b=X.get("titleText"),Y=a.createElement("div");if(J!=null){b=X.get(J);Q._notifyTitleChanged=function(){b=X.get(J);Y.innerHTML="";Y.appendChild(a.createTextNode(b));};X.attachEventListener(Q,"set_"+J,"_notifyTitleChanged");}Y.className=P+"TabTreeItem";V.appendChild(Y);Y.onmouseover=this.hover;Y.onmouseout=this.unhover;Y.appendChild(a.createTextNode(b));var K=X.get("visibleField");var M=false;if(K!=null){M=X.get(K);if(!Q._notifyItemRenderer){Q._notifyItemRenderer=E;}X.attachEventListener(Q,"set_"+K,"_notifyItemRenderer");}else{M=X.get("visible");}Y.style.display=M?"block":"none";if(M){Z[T]["elem"].style.display="block";Z[T]["visibleElems"]++;}return Y;};G.markListItemAsSelected=function H(J,K,O,L){var M=mstr.itemrenderers.TabTreeList.findElementFromIndex(J,K,O,L);if(!M){return ;}var N=M.className;if(/Hover/.test(N)){N=N.replace(/Hover/,"SelectedHover");}else{N+="Selected";}M.className=N;};G.markListItemAsUnselected=function B(J,K,N,L){var M=mstr.itemrenderers.TabTreeList.findElementFromIndex(J,K,N,L);if(M){M.className=M.className.replace(/Selected/,"");}};G.hover=function C(){this.className+="Hover";};G.unhover=function D(J){this.className=this.className.replace(/Hover/,"");};G.findElementFromIndex=function A(Q,N,S,K){var O=parseInt(K.at);if(isNaN(O)||O<0){return null;}var P=N.getItems();var R=0;var M="";for(var L=0;L<=O;L++){var J=P[L].get("categoryText");if(J!=M){R++;}M=J;}return Q.get("scrollArea").childNodes[0].childNodes[O+R];};return G;})();mstr.behaviors.FontPreview=(function(){var A={};A.on_set_enabled=function(C,B){if(B){C.className=C.className.replace("Disabled","");}else{if(C.className.indexOf("Disabled")==-1){C.className+="Disabled";}}};A.on_model_set_prop=function(K,B,H,E){var I=E&&E.get(H.get(B));if(I instanceof mstr.models.ColorPicker){I=I.get("actualColor");}else{if(I instanceof mstr.models.ListModel){var J=I.getSelectedItem();var F=I.get("valueForm");I=(J&&J[F])||(B=="fontFamily"&&"Arial")||(B=="fontSize"&&"10")||I.getItems()[0][F];}}if(isNaN(I)&&!I){return ;}var D=K.childNodes[1];if(B=="boldItalic"){D.style.fontWeight=(I==1||I==3)?"bold":"normal";D.style.fontStyle=(I==2||I==3)?"italic":"normal";}else{switch(B){case"fontSize":I+="pt";break;case"textUnderline":case"textStrikeout":B="textDecoration";var C=E.get(H.get("textUnderline"));var G=E.get(H.get("textStrikeout"));if(!C&&!G){I="none";}else{I=(C)?"underline":"";I+=(G)?" line-through":"";}break;case"fontColor":B="color";D.style.backgroundColor=mstr.utils.Color.getContrastingColor(I,["#ffffff","#000000"]);break;}D.style[B]=I;}};return A;})();mstr.behaviors.ImagePreview=(function(){var B={};B.on_set_src=function(Q,J,E){if(Q.intervalHandle){window.clearInterval(Q.intervalHandle);}mstr.$D.clearChilds(Q);var G=E.get(J.get("valueField"));if(!G||G.length==0){return ;}if(G!==""){var S=document.getElementById("imgUrl_txt");if(S){var I=microstrategy.getViewerBone().doc.prevSelectedId,D=document.getElementById(I),K=Number(D.getAttribute("ut")),M=mstrmojo.string;switch(K){case mstr.Enum.IMAGE_URL_TYPE.DUMMY_URL:S.value="";return ;case mstr.Enum.IMAGE_URL_TYPE.TASK_URL:S.value=decodeURIComponent(D.getAttribute("n"));break;case mstr.Enum.IMAGE_URL_TYPE.BLOB_URL:case mstr.Enum.IMAGE_URL_TYPE.IMAGE_NAME:G=Q.blobURL;S.value=Q.imgName;break;}}}if(mstr.utils.ISFF){var L=G.split("?");if(L.length>1){L[0]=L[0].replace(/\\/g,"/");G=L.join("?");}else{G=L[0].replace(/\\/g,"/");}}var T=J.get("document").createElement("img");T.style.visibility="hidden";T.src=G;var C=J.get(mstr.Props.Widget.ELEMENT);var N=mstr.utils.BoxModel.getElementInnerWidth(C),R=mstr.utils.BoxModel.getElementInnerHeight(C);if(!N||!R){N=parseInt(mstr.utils.CSS.getStyleValue(C,"width"));R=parseInt(mstr.utils.CSS.getStyleValue(C,"height"));}N=Math.max(N-6,0);R=Math.max(R-6,0);var H=N/R;var F=new Date();var O=false;Q.intervalHandle=window.setInterval(function(){var X=(T.readyState=="complete"||T.complete);var W=(new Date()-F>=5000);var V=mstr.utils.BoxModel.getElementOuterWidth(T);var Y=mstr.utils.BoxModel.getElementOuterHeight(T);var U=mstr.utils.ISIE4?(T.readyState=="loading"):(V&&Y);if(X||W||O||U){window.clearInterval(Q.intervalHandle);(U||X)&&P();}T.style.visibility="visible";},100);var P=function(){var U=mstr.utils.BoxModel.getElementOuterWidth(T);var V=mstr.utils.BoxModel.getElementOuterHeight(T);var W=U/V;if(V>R||U>N){if(W>H){U=N;V=(N/W);}else{V=R;U=V*W;}T.style.width=U+"px";T.style.height=V+"px";}T.style.marginTop=Math.abs(((R-V)/2))+3+"px";};T.onload=P;T.onerror=function(){O=true;P();};Q.appendChild(T);};B.on_set_visible=function A(E,G,C,D){mstr.behaviors.Generic.set_css_display(E,G,C,D);if(!mstr.utils.ISIE4){return ;}var F=E.getElementsByTagName("img");if(F[0]){F[0].style.visibility=(!!D)?"visible":"hidden";}};return B;})();mstr.behaviors.Tab=(function(){var A={};A.on_set_visible=function(H,B,C){var F=!!B.props.visible;var D=H.style;D.display=F?"block":"none";D.visibility=F?"inherit":"hidden";var E=(B.get("helpTopic")==null?"":B.get("helpTopic"));var G=B.props[mstr.$W.PARENT];while(G&&!(G instanceof mstr.views.FloatingEditor)){G=G.props[mstr.$W.PARENT];}if(G&&(G instanceof mstr.views.FloatingEditor)){G.set("helpTopic",E);}};return A;})();mstr.itemrenderers.TabbedToolbarView=(function(){var C=mstr.$H.clone(mstr.itemrenderers.ListView);C.markListItemAsUnselected=function B(D,E,H,F){var G=this._findElementForIndex(D,H,F.at);if(!G){return ;}G.className=G.className.replace(/SelectedHover/,"");G.className=G.className.replace(/Selected/,"");G.className=G.className.replace(/pinned/,"");};C.markListItemAsSelected=function A(D,E,I,F){var G=this._findElementForIndex(D,I,F.at);if(!G){return ;}var H=G.className;if(/Selected/.test(H)){H=H.replace(/Selected/,"");}if(/Hover/.test(H)){H=H.replace(/Hover/,"SelectedHover");}else{H+="Selected";}if(E.get("items")[F.at]["pinned"]){H="pinned "+H;}else{if(/pinned/.test(H)){H=H.replace(/pinned/,"");}}G.className=H;};C.renderListItem=function(N,J,Q,D){var F=mstr.itemrenderers.FastListView.renderListItem(N,J,Q,D);F.title="";var P=document.createElement("table");var R=P.insertRow(0);var H=R.insertCell(0);H.className="left";var G=R.insertCell(1);var M=R.insertCell(2);var E=F.childNodes[0];G.appendChild(E);G.className=E.className;E.className="";G.onmousedown=function(S){mstr.behaviors.ListView.onmousedown(S||window.event,self,N.get("id"));};var I=false;var O,K;if((O=J.get("items")[D.at])&&(feats=O.enabledFeatures)){I=!mstr.behaviors.featureResolver.resolveFeatSet(feats);}if(D.item.menuModel){M.className="right menu";var L=function(S){S=S||window.event;mstr.behaviors.ToolbarListView.displayMenu(S,N,J,D,P);};M.onmouseover=L;M.onmousedown=L;if(I){G.onmousedown=L;}M=null;}else{M.className="right";if(I){F.onmouseover=null;F.onmouseout=null;}}G=null;F.appendChild(P);P.cellSpacing=0;this._insertElementForIndex(N,Q,D.at,F);F.style.display=(D.item.visible)?"block":"none";return F;};C.hover=function(D){mstr.itemrenderers.FastListView.hover.apply(this,arguments);};C.unhover=function(D){mstr.itemrenderers.FastListView.unhover.apply(this,arguments);};return C;})();mstr.behaviors.ToolbarListView=(function(){var C={};C.displayMenu=function B(Q,N,K,G,R){if(!mstr.controllers.Factory.getPath(N.getModel().get("targetPath"),N)||!mstr.behaviors.ToolbarListView.shouldProcessEvt(Q,K)){return ;}if(G&&G.item){var D=G.item.menuStyle?G.item.menuStyle:K.props.menuStyle;var L=G.item.menuModel;var P=G.item.layouts;}if(!D){return ;}var H=mstr.$obj(mstr.behaviors.FloatingMenu.getMenuId({modelName:L,layouts:P}));if(H&&H.get("visible")){if(Q.type==="mousedown"){H.execCloseMenu();}return ;}var J=N.get("menus")||{};for(var F in J){if(F!==D){var I=mstr.$obj(F);if(I&&I.get&&I.get("visible")){I.execCloseMenu();}}}J[mstr.behaviors.FloatingMenu.getMenuId({modelName:L,layouts:P})]=true;N.set("menus",J);var E=R.parentNode;N.set("openerEl",E);mstr.behaviors.FloatingMenu.toggleOpenerHoverEffect(N,true);var O=mstr.utils.BoxModel.getElementSumOffsetLeft(R);var M=mstr.utils.BoxModel.getElementSumOffsetTop(R)+mstr.utils.BoxModel.getElementOuterHeight(R);O+=getDocumentScrollLeft();M+=getDocumentScrollTop();mstr.behaviors.FloatingMenu.displayMenu(N,O,M,D,L,P,document.body);};C.shouldProcessEvt=function A(D,E){return(!mstr.behaviors.featureResolver.featAvailable(E.get("featurePopMenus"))||D.type!=="mouseover");};return C;})();mstr.behaviors.ToolbarButton=(function(){var A={};A.setButtonClassName=function(C,F){var E=C.get("cssPrefix")+C.get("cssClass");var B=C.get("extraCssClass");if(B){E+=" "+B;}var D=C.get("enabled");if(!D){E+=" disabled";}if(C.getModel().get("state")||(F&&D)){E+=" on";}C.get("element").className=E;};return A;})();mstr.behaviors.FloatingMenu=(function(){var C={};C.displayMenu=function(J,K,I,E,H,L,F){if(J.get("requestingMenu")){return ;}microstrategy.setJLSCXMenuOpen(true);var D={cssText:"top:"+I+"px;left:"+K+"px;z-index:"+mstr.views.FloatingMenuBook.prototype.getZIndex()+";",showing:J.get("mOverOpen")?false:true,viewer:J.getModel().get("targetPath"),modelName:H,ribbonId:J.getModel().get("id")};if(L){D.layouts=L;}var G=microstrategy.getBlockEditorFromCache(this.getMenuId(D),null,D,J,F);if(G){return ;}mstr.behaviors.FloatingMenu.showProgressIndicator(J,K,I,F);J.set("requestingMenu",true);microstrategy.openBlockLoaderEditor(this.getMenuId(D),E,null,D,J,{scope:this,method:this.menuDisplayed},F);};C.getMenuId=function(D){var E=D.layouts?D.layouts.replace(/[.,\/]/g,""):"";return D.modelName+"_"+E;};C.menuDisplayed=function(D){var F=D.src.get("requestContext");var E=F&&F.memo&&F.memo.opener;if(E){this.killProgressIndicator(E);}var G=D&&D.memo&&D.memo.name;if(G=="readyState"){if(D.memo.value==mstr.Enum.Widget.READYSTATE.ERROR||D.memo.value==mstr.Enum.Widget.READYSTATE.CANCELLED){mstr.behaviors.FloatingMenu.toggleOpenerHoverEffect(E,false);}}};C.showProgressIndicator=function(F,E,H,D){var G={pn:D,handle:window.setTimeout(function(){var K=F.get("element").ownerDocument;var J=K.createElement("table");J.className="select-free mstrFloatingMenu mstrFloatingMenuProgress";J.style.top=H+"px";J.style.left=E+"px";var L=J.insertRow(-1).insertCell(-1);L.appendChild(K.createTextNode(microstrategy.descriptors.getDescriptor("2901")));var I=G.pn||K.body;I.appendChild(J);G.indicator=J;},3000)};F.set("progressIndicator",G);D=null;};C.killProgressIndicator=function(D){var E=D&&D.get("progressIndicator");if(!E){return ;}var F=E.indicator;if(!F){window.clearTimeout(E.handle);}else{if(F.parentNode){F.parentNode.removeChild(F);}}D.set("progressIndicator",null);D.set("requestingMenu",false);};C.toggleOpenerHoverEffect=function A(D,G){var F=D&&D.get&&D.get("openerEl");if(!F){return ;}var E=mstr.utils.ListViewHelper.getItemRenderer(D);if(G){if(E&&E.hover){E.hover.call(F);}F.ignoreMouseEvents=true;}else{F.ignoreMouseEvents=false;if(E&&E.unhover){E.unhover.call(F);}}};C.adjustMenuPosition=function B(K){if(K.get("useFixedPosition")){return ;}var G=K.get("element");var E=G.parentNode;var N=K.get("document");var L=parseInt(G.style.left,10);var J=parseInt(G.style.top,10);var O=mstr.utils.BoxModel.getElementOuterWidth(G);var I=mstr.utils.BoxModel.getElementOuterHeight(G);var H=0;var F=0;var P=0;var M=0;if(E==N.body){P=getDocumentScrollLeft();M=getDocumentScrollTop();H=mstr.utils.BoxModel.getBrowserWindowWidth(N)+P;F=mstr.utils.BoxModel.getBrowserWindowHeight(N)+M;}else{P=E.scrollLeft;M=E.scrollTop;H=mstr.utils.BoxModel.getElementInnerWidth(E)+P;F=mstr.utils.BoxModel.getElementInnerHeight(E)+M;}if(L+O>H){var D=L;if(K.get("opener").get){D-=O;D-=mstr.utils.BoxModel.getElementOuterWidth(K.get("opener").get("element"));}else{D=H-O;}G.style.left=Math.max(D,P)+"px";}if(J+I>F){G.style.top=Math.max(F-I,M)+"px";}};C.onmouseout=function(E){var D=mstr.$obj(E);if(D.get&&D.get("hasToClose")){if(D.timeout){clearTimeout(D.timeout);}D.timeout=setTimeout("mstr.$obj('"+D.get("id")+"').set('visible',false);",2000);}};C.onmouseover=function(E){var D=mstr.$obj(E);if(D.timeout){clearTimeout(D.timeout);}};return C;})();mstr.behaviors.MenuOption=(function(){var A={};A.onmouseover=function D(F){var G=F.get("parent");G=G&&G.get("opener");if(G&&G.get){G=G.get("menuCloserTO");clearTimeout(G);}if(F.get("cmds")=="OpenSubMenu"){var H=F.get("menuCloserTO");if(H){clearTimeout(H);}H=window.setTimeout(function(){F.set("mOverOpen",true);mstr.behaviors.MenuOption.fireCommands(F,null);},250);F.set("menuOpenerTO",H);}};A.onmouseout=function E(F){if(F.get("cmds")!="OpenSubMenu"){return ;}var G=F.get("menuOpenerTO");if(G){clearTimeout(G);}G=window.setTimeout(function(){F.execCloseSubMenu();},350);F.set("menuCloserTO",G);};A.fireCommands=function C(G,F){if(!G.get("enabled")){return ;}G.fireCommands();if(!G.getModel().get("menuModel")){G.get("parent").execCloseMenu();}};A.updateCSS=function B(G,H){var J=G.get("cssPrefix");var F=G.get("cssClass");F+=G.get("extraCssClass")?" "+G.get("extraCssClass"):"";var I="";if(!G.get("enabled")){I=" disabled";}if(G.props.pressed||(G.props.model&&G.props.model.props.state)){I+=" pressed";}if(H&&G.get("enabled")){I+=" hover";}G.get("element").className=J+F+I;};return A;})();mstr.behaviors.FieldSet=(function(){var A={};A.set_fieldSet_enabled=function B(H,E){if(!E){var G=H.childNodes[1];var C=G&&G.lastChild;if(C&&C.id&&C.id.substring(0,12)=="fieldSetMask"){C.style.display="block";}else{H.style.position="relative";G.style.position="relative";var C=document.createElement("div");C.setAttribute("id","fieldSetMask_"+H.getAttribute("id"));var D=C.style;D.top="0px";D.left="0px";D.width="100%";D.height="100%";D.position="absolute";D.background="transparent url(images/1ptrans.gif) repeat";G.appendChild(C);}if(mstr.utils.ISFF||mstr.utils.ISWK||mstr.utils.ISIE10||mstr.utils.ISW3CIE){C.style.opacity="0.8";C.style.backgroundColor="#fafafa";}else{G.style.filter="progid:DXImageTransform.Microsoft.Alpha(opacity=30)";if(mstr.utils.ISIE6){window.setTimeout(function F(){C.style.height=G.offsetHeight;},0);}}}else{var G=H.childNodes[1];var C=G&&G.lastChild;if(C&&C.id&&C.id.substring(0,12)=="fieldSetMask"){C.style.display="none";if(mstr.utils.ISFF||mstr.utils.ISWK||mstr.utils.ISIE10||mstr.utils.ISW3CIE){G.style.opacity="1";}else{G.style.filter="";}}}};return A;})();mstr.http.SaveAnnotationsInputs=(function(){function A(E,C,B,D){this.params={taskId:"setAnnotations",objectID:E,objectType:C,annotation:B,isAppend:(typeof (D)!="undefined")?D:0,locale:mstr.Settings.Locale.ID};}return A;})();mstr.http.GetAnnotationsInput=(function(){function B(F,C,D,E){this.params={taskId:"getAnnotations",objectID:F,objectType:C,locale:mstr.Settings.Locale.ID,counter:A++};if(D){this.params.styleName=D;}else{this.params.styleName="AnnotationsStyle";}if(typeof (E)!="undefined"){this.params.juil=E;}}var A=0;return B;})();mstr.http.PingServer=(function(){function A(){this.params={taskId:"keepSessionAlive"};}return A;})();mstr.http.BlockLoaderInput=(function(){function A(B){this.params={taskId:"loadBlocks",styleName:B,juil:true};}return A;})();mstr.http.LoadToolbarInput=(function(){function A(){this.params={taskId:"loadToolbar",juil:true};}return A;})();mstr.http.FolderBlockLoaderInput=(function(){function A(B,C){this.params={taskId:"folderBrowse",styleName:B,juil:true};mstr.utils.Hash.overwrite(this.params,C);}return A;})();mstr.http.RwBlockLoaderInput=(function(){function A(C,E,B){this.params={taskId:"loadDocBlocks",styleName:C,juil:true};if(pageState){var D=(pageState+"&").match(/rwb=(.*?)\&/);if(D!=-1){this.params[E]=D[1];}}}return A;})();mstr.http.ReportBlockLoaderInput=(function(){function A(C,E,B){this.params={taskId:"loadReportBlocks",styleName:C,juil:true};if(pageState){var D=pageState.match(/rb=[^\&]*/);D=D[0].replace("rb=","");if(D!=-1){this.params[E]=D;}}}return A;})();mstr.http.GetGridFormats=(function(){function A(B,C){this.params={taskId:"getDocGridFormat",juil:true,docGridKey:B,msgID:C};}return A;})();mstr.http.GetRWGraphProperties=(function(){function A(B,C){this.params={taskId:"getRWGraphProperties",juil:true,docGridKey:B,msgID:C};}return A;})();mstr.http.GetReportGraphProperties=(function(){function A(B,C){this.params={taskId:"getReportGraphProperties",juil:true,stateID:C,msgID:B};}return A;})();mstr.http.OndemandContextMenuInputs=(function(){A.prototype.setDrillParams=function B(C){var D=microstrategy.findBone(microstrategy.activeCXMenu);var F=false;if(microstrategy.EXECUTION_SCOPE==microstrategy.REPORT_EXECUTION){F=true;}if(F){this.params={taskId:"ReportOndemandDrill",juil:true,styleName:"OndemandContextMenusStyle",ondemandDrillMinimalXML:true};if(pageState){var E=pageState.match(/rb=(.*?)(\&|$)/);if(E!=-1){this.params.rb=E[1];}}}else{this.params={taskId:"RWOnDemandDrill",juil:true,styleName:"OndemandContextMenusStyle",viewMode:D&&D.effectiveView||1,usePartDisplay:1,docGridKey:C,isQuickSwitchEnabled:D&&D.quickSwitchCurrent||false};if(pageState){var E=pageState.match(/rwb=(.*?)(\&|$)/);if(E!=-1){this.params.rwb=E[1];}}}};function A(C){this.setDrillParams(C);}return A;})();mstr.views.BaseView.prototype.taskModelCallback=function BV_taskModelCallback(B){switch(B.name){case"set_readyState":this.set("readyState",B.memo.value);if(B.memo.value==mstr.Enum.Widget.READYSTATE.IDLE){var A=this.taskModel.get("models")&&this.taskModel.get("models")[0];if(A){A.set("opener",this);}var C=this.taskModel.get("views")[0];if(C){C.set("opener",this);C.render();}}break;}};mstr.views.BaseView.prototype.execOpenModalPopup=function BV_execOpenModalPopup(B,A,D){self.supressWaitPage=true;A=A||{};D=D||{};var C,G;var I=mstr.$obj(B);if(I){var F=I.getModel();if(F){for(C in D){mstr.controllers.Factory.setPath(C,F,D[C],false);}F.set("opener",this);}for(C in A){mstr.controllers.Factory.setPath(C,I,A[C],false);}I.set("opener",this);I.set("visible",true);}else{var H=document.createElement("textarea");H.setAttribute("id",B);H.className="mstrJSON";this.get(mstr.$W.DOCUMENT).body.appendChild(H);var J=new mstr.http.BlockLoaderInput(B);for(C in D){J.params[C]=D[C];}for(C in A){J.params[C]=A[C];}if(!this.taskModel){this.taskModel=new mstr.models.TaskModel({parent:this});mstr.controllers.Factory.add(this.taskModel);var E=this.taskModel&&this.taskModel.init&&this.taskModel.init();this.taskModel.attachEventListener(this,"set_readyState","taskModelCallback");}this.set("readyState",mstr.Enum.Widget.READYSTATE.WAITING);this.taskModel.execFetchBlock(J,H);}window.setTimeout("self.supressWaitPage = false;",10);};mstr.views.FastTileView=(function(){mstr.$O.extendsClass(F,mstr.views.FastListView);F.DEFAULT_LIST_ITEM_HEIGHT=75;F.DEFAULT_LIST_ITEM_WIDTH=76;F.prototype._computeVisibleItemsRange=function E(){var H=mstr.views.FastListView.prototype._computeVisibleItemsRange.apply(this);if(H){var I=Math.max(parseInt(this.props.itemsPerRow)||1,1);H.min=H.min*I;H.max=(H.max+1)*I-1;}return H;};F.prototype._updateItemsContainerDimensions=function D(){mstr.views.FastListView.prototype._updateItemsContainerDimensions.apply(this);this._updateItemsContainerWidth();};F.prototype._updateItemsContainerHeight=function C(){var K=this.props.listItemsContainer;if(!K){return ;}var L=mstr.utils.ListViewHelper.getItemRenderer(this);var J=F.DEFAULT_LIST_ITEM_HEIGHT;if(J){var I=this.getModel();var H=mstr.$A.len(I&&I.getItems&&I.getItems()),N=Math.max(parseInt(this.props.itemsPerRow)||1,1),M=parseInt(H/N);if(H%N){M++;}J=J*M;}if(J){K.style.height=J+"px";}else{K.style.height=mstr.utils.ISIE4?"1px":"auto";}if(mstr.utils.ISIE4){K.style.overflow=J?"visible":"hidden";}};F.prototype._updateItemsContainerWidth=function G(){var J=this.props.listItemsContainer;if(!J){return ;}var I=this.getModel();var H=mstr.$A.len(I&&I.getItems&&I.getItems()),L=Math.max(parseInt(this.props.itemsPerRow)||1,1);J.style.width=(F.DEFAULT_LIST_ITEM_WIDTH*Math.min(H,L))+"px";var K=parseInt(H/L);if(mstr.utils.ISW3C&&(K*F.DEFAULT_LIST_ITEM_WIDTH>parseInt(this.props.height))){J.style.width=(parseInt(J.style.width)+SCROLLBAR_SIZE)+"px";}};F.prototype._adjustWhiteSpaceAboveItem=function B(H,I){return ;};F.prototype._adjustWhiteSpaceBelowItem=function A(H,I){return ;};function F(H){mstr.views.FastListView.apply(this,[H]);}return F;})();mstr.views.TabTreeListView=(function(){mstr.$O.extendsClass(A,mstr.views.ListView);A.prototype.execClickListItem=function B(J){var C=this.props.model;var F=C.indexOfValue(J.valueForm);if(F!=-1){var E=C.getItems();var I=E[F];var D=I&&I.get&&I.get("visibleField");if(D){if(!I.get(D)){for(var H=F,G=E.length;H<G;H++){D=E[H].get("visibleField");if(!D||E[H].get(D)){J.valueForm=E[H].getId();break;}}}}}return mstr.views.ListView.prototype.execClickListItem.apply(this,[J]);};function A(C){mstr.views.ListView.apply(this,[C]);}return A;})();mstr.views.AnnotationView=(function(){mstr.$O.extendsClass(G,mstr.views.BaseView);G.prototype.execResize=function F(){this.resize();return true;};G.prototype.resize=function D(I,H){if(H==null){H=mstr.utils.BoxModel.getElementOuterHeight(this.props[mstr.$W.ELEMENT]);}else{this.props[mstr.$W.ELEMENT].style.height=Math.max(H-26,0)+"px";}if(I==null){I=mstr.utils.BoxModel.getElementOuterWidth(this.props[mstr.$W.ELEMENT]);}else{this.props[mstr.$W.ELEMENT].style.width=Math.max(I-26,0)+"px";}this.nonEditableArea=this.nonEditableArea||document.getElementById("nonEditableArea");this.editableArea=this.editableArea||document.getElementById("editableArea");this.addArea=this.addArea||document.getElementById("addArea");this.editButtons=this.editButtons||document.getElementById("editButtons");this.scratchPad=this.scratchPad||document.getElementById("scratchPad");if(this.editableArea&&this.nonEditableArea){if(this.scratchPad){this.scratchPad.style.width=Math.max(parseInt(this.props[mstr.$W.ELEMENT].style.width),0)+"px";}this.editableArea.style.height=Math.max(parseInt(this.props[mstr.$W.ELEMENT].style.height)-mstr.utils.BoxModel.getElementOuterHeight(this.addArea)-mstr.utils.BoxModel.getElementOuterHeight(this.editButtons)-10,0)+"px";this.editableArea.style.width=Math.max(parseInt(this.props[mstr.$W.ELEMENT].style.width),0)+"px";this.nonEditableArea.style.height=this.editableArea.style.height;this.nonEditableArea.style.width=Math.max(parseInt(this.props[mstr.$W.ELEMENT].style.width),0)+"px";}};G.prototype.execUpdate=function B(H){if(H=="true"){this.addArea=this.addArea||document.getElementById("addArea");this.getModel().get("addition").set("value",this.addArea.firstChild.value);}else{this.editableArea=this.editableArea||document.getElementById("editableArea");this.getModel().set("value",this.editableArea.value);}};G.prototype.execValidateAdd=function E(H,I){if(!H||H.length==0){this.execConfirm(microstrategy.descriptors.getDescriptor("6156"));return false;}else{if((H.length+this.getModel().get("addition").get("prefixLen")+this.getModel().get("addition").get("postfixLen"))>mstr.models.AnnotationModel.ADDITION_MAX_LENGTH){return this.execConfirm("*Additional notes cannot be longer than ## characters. The note you are adding will be truncated if you proceed.*".replace(/##/,mstr.models.AnnotationModel.ADDITION_MAX_LENGTH));}else{if(this.getModel().get("value")&&((this.getModel().get("value").length+H.length)>mstr.models.AnnotationModel.NOTES_MAX_LENGTH)){return this.execConfirm("*Notes cannot be longer than ## characters. The note you are editing will be truncated if you proceed.*".replace(/##/,mstr.models.AnnotationModel.NOTES_MAX_LENGTH));}}}return true;};G.prototype.execValidateEdit=function C(H){if((H.length+this.getModel().get("postfixLen"))>mstr.models.AnnotationModel.NOTES_MAX_LENGTH){return this.execConfirm("*Notes cannot be longer than ## characters. The note you are editing will be truncated if you proceed.*".replace(/##/,mstr.models.AnnotationModel.NOTES_MAX_LENGTH));}return true;};G.prototype.setEditCursor=function A(){if(this.editableArea){this.editableArea.focus();if(mstr.utils.ISW3C){this.editableArea.scrollTop=this.editableArea.scrollHeight;}else{var H=this.editableArea.createTextRange();H.collapse(false);H.select();}}};function G(H){mstr.views.BaseView.apply(this,[H]);}return G;})();mstr.views.Slider=(function(){mstr.$O.extendsClass(S,mstr.views.BaseView);S.prototype._getThumb=function S__getThumb(){var el=this.get(mstr.Props.Widget.ELEMENT);return el&&el.lastChild.firstChild;};S.prototype._getTooltip=function S__getTooltip(){var el=this.get(mstr.Props.Widget.ELEMENT);return el&&el.lastChild.lastChild;};S.prototype.init=function S_init(){mstr.views.BaseView.prototype.init.apply(this,arguments);var m=this.getModel();if(m&&m.attachEventListener){m.attachEventListener(this,"set_"+this.get("xField"),"schedule_thumb_move");m.attachEventListener(this,"set_"+this.get("yField"),"schedule_thumb_move");}};S.prototype.render=function S_render(){mstr.views.BaseView.prototype.render.apply(this,arguments);this.schedule_thumb_move(null,true);if(!this.get("dnd")){return null;}var el=this.get("element").lastChild;var thumb=this._getThumb();var props={view:this};var f1,f2;var o=this.get("orientation");if(o=="h"||o=="b"){f1=function(){return Math.round(mstr.utils.BoxModel.getElementSumOffsetLeft(el)-(mstr.utils.BoxModel.getElementOuterWidth(thumb)/2));};props.xMin=f1;props.xMax=function(){return f1()+mstr.utils.BoxModel.getElementInnerWidth(el);};}else{f1=function(){return mstr.utils.BoxModel.getElementSumOffsetLeft(el);};props.xMin=f1;props.xMax=f1;}if(o=="v"||o=="b"){f2=function(){return Math.round(mstr.utils.BoxModel.getElementSumOffsetTop(el)-(mstr.utils.BoxModel.getElementOuterHeight(thumb)/2));};props.yMin=f2;props.yMax=function(){return f2()+mstr.utils.BoxModel.getElementInnerHeight(el);};}else{f2=function(){return mstr.utils.BoxModel.getElementSumOffsetTop(el);};props.yMin=f2;props.yMax=f2;}this.set("dz",new mstr.models.dnd.DragZone(props,{findTarget:function(view,e){var t=mstr.utils.Dom.findAncestor(e.target(),"className",thumb.className);return(t&&t==thumb)?t:null;},startDrag:function(view){if(!view.get("dndGhost")){thumb.style.visibility="hidden";}var origClickJump=!!view.get("enableClickJumps");if(!origClickJump){view.set("enableClickJumps",true);}},drag:function(view,l,t){l=l+Math.round(mstr.utils.BoxModel.getElementOuterWidth(thumb)/2);t=t+Math.round(mstr.utils.BoxModel.getElementOuterHeight(thumb)/2);view.repositionThumb({x:l,y:t},1);},endDrag:function(view,l,t){var origClickJump=!!view.get("enableClickJumps");if(!origClickJump){view.set("enableClickJumps",true);}var origAnimation=!!view.get("animate");if(origAnimation){view.set("animate",false);}l=l+Math.round(mstr.utils.BoxModel.getElementOuterWidth(thumb)/2);t=t+Math.round(mstr.utils.BoxModel.getElementOuterHeight(thumb)/2);view.repositionThumb({x:l,y:t},1);if(!origClickJump){view.set("enableClickJumps",false);}if(origAnimation){view.set("animate",true);}if(!view.get("dndGhost")){thumb.style.visibility="visible";}}}));return null;};S.prototype.on_click=function S_on_click(e,hWin){if(!this.get("enabled")||(!this.get("xField")&&!this.get("yField"))){return ;}e=e||window.event;if((e.target||e.srcElement).tagName!="DIV"){return ;}var evt=new mstr.lang.Event(e,hWin,this);var el=this.get(mstr.Props.Widget.ELEMENT).lastChild;var h=parseInt(this.get("height"),10);var offset=(mstr.utils.ISW3C)?(mstr.utils.BoxModel.getElementOuterHeight(el)-h)/2:4;this.repositionThumb(evt,offset);};S.prototype.repositionThumb=function S_repositionThumb(evt,offset){var x,y;var h=parseInt(this.get("height"),10);var w=parseInt(this.get("width"),10);var el=this.get(mstr.Props.Widget.ELEMENT).lastChild;var or=this.get("orientation");var og=this.get("origin");if(or=="h"||or=="b"){x=evt.x-mstr.utils.BoxModel.getElementSumOffsetLeft(el)-offset;if(og==2||og==6){x=NaN;}else{if(og==3||og==4||og==5){x=w-x;}}}if(or=="v"||or=="b"){y=evt.y-mstr.utils.BoxModel.getElementSumOffsetTop(el)-offset;if(og==4||og==8){y=NaN;}else{if(og==5||og==6||og==7){y=h-y;}}}var info={x:{n:x,d:w},y:{n:y,d:h}};var m=this.getModel();for(var id in info){if(!isNaN(info[id]["n"])){var f=this.get(id+"Field");if(!f){continue;}var min=this.get(id+"Min");var max=this.get(id+"Max");var v=Math.round(((info[id]["n"]/info[id]["d"])*(max-min))+min);if(this.get("enableClickJumps")){m.set(f,v);}else{var ov=m.get(f);v=(ov<v)?ov++:ov--;m.set(f,ov);}}}if(!isNaN(x)){var thumb=this._getThumb();thumb.style.left=(x-Math.round(mstr.utils.BoxModel.getElementOuterWidth(thumb)/2)-(mstr.utils.ISIE6||mstr.utils.ISIE7?1:0))+"px";}this.showTooltip(true);};S.prototype._buildTooltipText=function S__buildTooltipText(){var tf=this.get("tooltipFunction");if(tf){eval("var f ="+tf);}var s="";var m=this.getModel();var or=this.get("orientation");if(this.get("xField")&&(or=="h"||or=="b")){s+=(tf)?f(m.get(this.get("xField"))):microstrategy.descriptors.getDescriptor("4891").replace("##",m.get(this.get("xField"))).replace("###",this.get("xMax"));}if(this.get("yField")&&(or=="v"||or=="b")){if(s.length>0){s+="<br />";}s+=(tf)?f(m.get(this.get("yField"))):microstrategy.descriptors.getDescriptor("4891").replace("##",m.get(this.get("yField"))).replace("###",this.get("yMax"));}return s;};S.prototype._moveTooltip=function S__moveTooltip(){if(!this.get("showTooltip")){return ;}var el=this.get(mstr.Props.Widget.ELEMENT);var tooltip=this._getTooltip();if(!tooltip){return ;}var or=this.get("orientation");tooltip.lastChild.innerHTML=this._buildTooltipText();var x,y;var h=mstr.utils.BoxModel.getElementOuterHeight(tooltip);var w=mstr.utils.BoxModel.getElementOuterWidth(tooltip);var thumb=this._getThumb();var tt=mstr.utils.BoxModel.getElementSumOffsetTop(thumb)-mstr.utils.BoxModel.getElementSumOffsetTop(el.lastChild);var tl=mstr.utils.BoxModel.getElementSumOffsetLeft(thumb)-mstr.utils.BoxModel.getElementSumOffsetLeft(el.lastChild);var th=mstr.utils.BoxModel.getElementOuterHeight(thumb);var tw=mstr.utils.BoxModel.getElementOuterWidth(thumb);switch(or){case"h":x=Math.round(tl+(tw/2)-(w/2));y=Math.round(tt-h-1);break;case"v":x=Math.round(tl+tw+1);y=Math.round(tt+(th/2)-(h/2));break;case"b":x=Math.round(tl+tw+1);y=Math.round(tt-h-1);break;}tooltip.style.left=x+"px";tooltip.style.top=y+"px";};S.prototype.showTooltip=function S_showTooltip(show){if(!this.get("showTooltip")){return ;}var tooltip=this._getTooltip();if(!tooltip){return ;}if(this.get("enabled")&&show){tooltip.style.display="inline";tooltip.style.visibility="visible";this._moveTooltip();}else{tooltip.style.visibility="hidden";}};S.prototype.schedule_thumb_move=function S_schedule_thumb_move(evt,noAnimation){if(!isNaN(this.get("animationTimeout"))){self.clearTimeout(this.get("animationTimeout"));this.set("animationTimeout",null);}var thumb=this._getThumb();var og="|"+this.get("origin")+"|";var tempT=thumb.cloneNode(true);tempT.style.display="block";tempT.style.position="absolute";tempT.style.left="3000px";tempT.style.top="2000px";tempT=document.body.appendChild(tempT);var info={x:{d:parseInt(this.get("width"),10),i:"|2|6|",o:"|3|4|5|",t:mstr.utils.BoxModel.getElementOuterWidth(tempT)/2,v:NaN},y:{d:parseInt(this.get("height"),10),i:"|4|8|",o:"|5|6|7|",t:mstr.utils.BoxModel.getElementOuterHeight(tempT)/2,v:NaN}};document.body.removeChild(tempT);var model=this.getModel();for(var id in info){var f=this.get(id+"Field");if(!f){continue;}var min=this.get(id+"Min");var n=(model.get(f)-min)/(this.get(id+"Max")-min);if(info[id]["i"].indexOf(og)>-1){n=NaN;}else{if(info[id]["o"].indexOf(og)>-1){n=1-n;}}info[id]["v"]=Math.round(n*info[id]["d"]-info[id]["t"]);}var x=info.x["v"]||null;var y=info.y["v"]||null;if(noAnimation||!this.get("animate")||this.get("animationStep")<=1){if(x&&!isNaN(x)){thumb.style.left=x+"px";}if(y&&!isNaN(y)){thumb.style.top=y+"px";}}else{this.props.animationTimeout=self.setTimeout("mstr.$obj('"+this.get("id")+"').move_thumb("+x+", "+y+")",10);}this._moveTooltip();};S.prototype.move_thumb=function S_move_thumb(x,y){var thumb=this._getThumb();if(thumb){mstr.utils.Animations.move(thumb,x,y,this.get("animationStep"));this.set("animationTimeout",null);}};S.prototype.after_set_enabled=function S_after_set_enabled(evt){var thumb=this._getThumb();if(thumb){thumb.style.display=(this.get("enabled"))?"inline":"none";}};function S(props){mstr.views.BaseView.apply(this,[props]);}return S;})();mstr.views.FontFormatter=(function(){mstr.$O.extendsClass(A,mstr.views.BaseView);A.pathMap={nameModelPath:{p:"children/0/children/0",f:"fontFamily",vp:"parent/parent/model/"},styleModelPath:{p:"children/1/children/0/children/0",f:"boldItalic",vp:"parent/model/"},sizeModelPath:{p:"children/1/children/0/children/1",f:"fontSize",vp:"parent/model/"},underlineField:{p:"children/0/children/1/children/0",f:"textUnderline",vp:"parent/model/"},strikeoutField:{p:"children/0/children/1/children/1",f:"textStrikeout",vp:"parent/model/"},colorModelPath:{p:"children/1/children/1",f:"fontColor",vp:"parent/model/"}};A.prototype.init=function B(){var E=this;var D=function(G){var H=G.name.split("_").pop();E._updateViewProperties(H);};for(var F in mstr.views.FontFormatter.pathMap){this._updateViewProperties(F);this["after_set_"+F]=D;}mstr.views.BaseView.prototype.init.apply(this);};A.prototype._updateViewProperties=function C(J){var E=mstr.$path(mstr.views.FontFormatter.pathMap[J].p,this);var H=this.get(J);if(J.indexOf("Field")>-1){mstr.controllers.Factory.safeset(E,"valueField",H);}else{var G=mstr.views.FontFormatter.pathMap[J].vp+H;mstr.controllers.Factory.safeset(E,"modelPath",G);}var D=this.get("enabledField");if(D){var F=mstr.views.FontFormatter.pathMap[J].vp+D;mstr.controllers.Factory.safeset(E,"enabledField",F);}var I=mstr.$path("children/1/children/2",this);mstr.controllers.Factory.safeset(I,mstr.views.FontFormatter.pathMap[J].f,H);};function A(D){mstr.views.BaseView.apply(this,[D]);}return A;})();mstr.views.ToolbarListView=(function(){mstr.$O.extendsClass(A,mstr.views.ListView);A.prototype.init=function C(){mstr.views.ListView.prototype.init.apply(this);this.getModel().attachEventListener(this,"featuresChanged","render");};A.prototype.render=function B(){if(!this.props.model.get("items")[1]&&!this.props.model.get("items")[0]["menuModel"]&&mstr.utils.Hash.isEmpty(this.props.rightIcons)){var E=" mstrNoTabs";if(document.body.className.indexOf(E)==-1){document.body.className+=E;}return ;}mstr.views.ListView.prototype.render.call(this,[]);var I=this.get("rightIcons"),D=this.props.scrollArea,J=D&&D.firstChild;if(!J||!I){return ;}for(var G=0,F=I.length;G<F;G++){var H=I[G];if(H.get){J.appendChild(H.get(mstr.$W.ELEMENT));}else{H=mstr.controllers.Factory.registerJSON(I[G],this.props[mstr.$W.DOCUMENT]);H.set("parent",this);H.init();H.set(mstr.$W.ELEMENT,J.appendChild(document.createElement("div")));}H.render();I[G]=H;}};function A(D){mstr.views.ListView.apply(this,[D]);}return A;})();mstr.views.FloatingMenuOption=(function(){mstr.$O.extendsClass(C,mstr.views.BaseView);C.prototype.execOpenSubMenu=function B(){var G=this.getModel().get("style");var E=this.getModel().get("menuModel");var I=this.getModel().get("layouts");if(!G){G=this.props.parent.props.model.props.styleName;}if(!G||!E){return ;}this.get("parent").execCloseSubMenus();var F=this.get("element");var H=this.get("parent").get("element");var D=parseInt(H.style.left,10)+mstr.utils.BoxModel.getElementOuterWidth(H)-12;var J=parseInt(H.style.top,10)+mstr.utils.BoxModel.getElementSumOffsetTop(F)-mstr.utils.BoxModel.getElementSumOffsetTop(H);mstr.behaviors.FloatingMenu.displayMenu(this,D,J,G,E,I,H.parentNode);};C.prototype.execCloseSubMenu=function A(){if(!this.getModel().get("menuModel")){return ;}var E=mstr.$obj(mstr.behaviors.FloatingMenu.getMenuId({layouts:this.getModel().get("layouts"),modelName:this.getModel().get("menuModel")}));var D=E&&E.execCloseMenu();};function C(D){mstr.views.BaseView.apply(this,[D]);}return C;})();mstr.views.ToolbarButton=(function(){mstr.$O.extendsClass(B,mstr.views.BaseView);B.prototype._attachLayoutHandlers=function C(){mstr.views.BaseView.prototype._attachLayoutHandlers.apply(this,[]);var D=this.props.model;if(!D){return ;}D.attachEventListener(this,"set_showPressed","set_pressed");};B.prototype.set_pressed=function A(D){this.set("pressed",D.memo.value);};function B(D){mstr.views.BaseView.apply(this,[D]);}return B;})();mstr.views.LastUpdateView=(function(){mstr.$O.extendsClass(B,mstr.views.BaseView);B.prototype.render=function A(){var D=mstr.$path(mstr.$path("parent/model/targetPath",this),this);if(!D){return ;}mstr.views.BaseView.prototype.render.apply(this,arguments);var C=this.get(mstr.$W.ELEMENT);if(D.lastUpdate){C.innerHTML=D.lastUpdate;}C.className=this.get("cssPrefix")+this.get("cssClass");};function B(C){mstr.views.BaseView.apply(this,[C]);}return B;})();mstr.views.Toolbar=(function(){mstr.$O.extendsClass(C,mstr.views.ViewBook);C.prototype.render=function E(){mstr.views.ViewBook.prototype.render.apply(this);this.checkAllSeparators();var G=this.get("views");for(var I=0,H=G.length;I<H;I++){var J=G[I];if(!(J.get("ge"))){var F=J.attachEventListener&&J.attachEventListener(this,"set_visible","checkSeparators");}}};C.prototype.checkAllSeparators=function B(){var F=this.get("views");var J=false;var I;for(var H=0,G=F.length;H<G;H++){I=F[H].get("ge");if(!this.renderFirstSeparator&&F[H].get("visible")&&!J){J=true;if(I){F[H].set("visible",false);continue;}}if(I&&H+1<G){this.checkSeparators({src:F[H+1]});}}};C.prototype.checkSeparators=function D(G){var F=this.get("views");var H=mstr.$A.find(F,G.src);var K=G.src.get("visible");var J,M,I;var L;for(M=H-1;M>=0;M--){J=F[M];if(J.get("ge")){L=M;break;}}for(M=L+1,I=F.length;M<I;M++){J=F[M];if(J.get("ge")){F[L].set("visible",false);break;}if(J.get("visible")){F[L].set("visible",true);break;}}if(M==F.length&&!this.renderLastSeparator){F[L].set("visible",false);}};C.prototype.after_set_childValidationStatus=function A(H){var F=H.memo;var I=mstr.$obj(F.id).getModel().get("queueGroup");this.childValidationStatus=this.childValidationStatus||{};var J=this.childValidationStatus[I]=this.childValidationStatus[I]||{};var G=this.get("model");if(F.code==mstr.Enum.Validation.STATUSCODE.VALID){if(F.id in J){delete J[F.id];if(mstr.utils.Hash.isEmpty(J)){G.setQueueValidationStatus(I,mstr.Enum.Validation.STATUSCODE.VALID);}}}else{if(mstr.utils.Hash.isEmpty(J)){G.setQueueValidationStatus(I,mstr.Enum.Validation.STATUSCODE.INVALID_ANSWERS);}J[F.id]=F.code;}};function C(F){this.renderFirstSeparator=true;this.renderLastSeparator=true;mstr.views.ViewBook.apply(this,[F]);}return C;})();mstr.views.ClickableMessage=(function(){mstr.$O.extendsClass(B,mstr.views.BaseView);B.prototype.showMessage=function D(){showMessage({contents:this.get("dlgText"),elements:microstrategy.OK_BUTTON+microstrategy.CANCEL_BUTTON,zIndex:1001,okEval:'mstr.$obj("'+this.get("id")+'").handleOK()',type:mstrMsgBoxImpl.MSG_WARNING});};B.prototype.handleOK=function C(){};B.prototype.render=function A(){mstr.views.BaseView.prototype.render.apply(this,arguments);var H=this.get("element");var F=this.get("msgText");var G=F.match(/##(.*)##/);if(G&&G.length>0){var E="<span style='text-decoration:underline;cursor:pointer' onclick='mstr.$obj(\""+this.get("id")+"\").showMessage();'>"+G[1]+"</span>";F=F.replace(/##.*##/,E);H.innerHTML=F;}};function B(E){mstr.views.BaseView.apply(this,[E]);}return B;})();mstr.views.TooltipText=(function(){mstr.$O.extendsClass(A,mstr.views.BaseView);A.prototype.render=function B(){mstr.views.BaseView.prototype.render.apply(this,arguments);var C=this.get("element");model=this.getModel();currAttr=model.getSelectedItemValue();attrName=currAttr.split("|")[2];abbr=attrName;if(attrName.length>20){abbr=attrName.substring(0,17)+"...";}C.innerHTML="<div style='margin-top:6px;' title='"+attrName+"'>"+abbr+":</div>";};function A(C){mstr.views.BaseView.apply(this,[C]);}return A;})();mstr.views.DisableAutowireMessage=(function(){mstr.$O.extendsClass(B,mstr.views.ClickableMessage);B.prototype.handleOK=function A(){microstrategy.getViewerBone().commands.exec("disableAutowire");this.get("parent").getModel().set("Autowire",false);};function B(C){mstr.views.BaseView.apply(this,[C]);}return B;})();mstr.views.FloatingMenuBook=(function(){mstr.$O.extendsClass(D,mstr.views.Toolbar);D.prototype.zIndex=1000;D.prototype.getZIndex=function I(){return this.zIndex++;};D.prototype.init=function A(){mstr.views.Toolbar.prototype.init.apply(this);mstr.controllers.EventManager.attachWindowEventListener(this,"mousedown","documentClick");mstr.controllers.EventManager.attachWindowEventListener(this,"closeMenus","documentClick");};D.prototype.after_set_visible=function G(J){if(this.props.visible){mstr.behaviors.FloatingMenu.adjustMenuPosition(this);}else{mstr.behaviors.FloatingMenu.toggleOpenerHoverEffect(this.props.opener,false);}};D.prototype.render=function B(){mstr.views.Toolbar.prototype.render.apply(this);mstr.utils.Dom.insertPopupMask(this.get("element"),this.execLayoutHandler("maskContainer"));var J=this.get("opener");if(J&&J.get&&J.get("visible")===false){this.execCloseMenu();}else{mstr.behaviors.FloatingMenu.adjustMenuPosition(this);}};D.prototype.documentClick=function F(J){if(this.props.visible===false){return ;}if(this.props.showing){this.set("showing",false);return ;}var K=J&&J.target&&J.target();if(K&&K.tagName&&K.tagName.toLowerCase()=="html"){return ;}if(((!K&&J.name=="closeMenus")||!mstr.utils.Dom.containsElement(this.props.element,K,true))&&!(this.props.opener.props&&mstr.utils.Dom.containsElement(this.props.opener.props.element,K,true))&&!this.isSubMenu(K)){this.execCloseMenu();}};D.prototype.isSubMenu=function E(N){var K=N,J,L,M,O;while(K){O=(K.getAttribute&&K.getAttribute("blockId"))||K.id;if(O){J=mstr.$obj(O);if(J&&J.props){M=M||(J.props.cmds);L=J.props.opener;L=L&&L.props.element;if(L){return M=="OpenSubMenu"&&mstr.utils.Dom.containsElement(this.props.element,L,true);}}}K=K.parentNode;}return false;};D.prototype.isSubMenu=function E(N){var K=N,J,L,M,O;while(K){O=(K.getAttribute&&K.getAttribute("blockId"))||K.id;if(O){J=mstr.$obj(O);if(J&&J.props){M=M||(J.props.cmds);L=J.props.opener;L=L&&L.props.element;if(L){return M=="OpenSubMenu"&&mstr.utils.Dom.containsElement(this.props.element,L,true);}}}K=K.parentNode;}return false;};D.prototype.execCloseMenu=function H(){if(this.props.visible===false){return ;}if(!(this.props.opener instanceof mstr.views.FloatingMenuOption)){microstrategy.setJLSCXMenuOpen(false);}this.set("visible",false);this.set("cssText","left:-2000px;top:-2000px");};D.prototype.execCloseSubMenus=function C(){if(!this.props.views){return ;}for(var L=0,K=this.props.views.length;L<K;L++){var M=this.props.views[L];var J=M.execCloseSubMenu&&M.execCloseSubMenu();}};function D(J){mstr.views.Toolbar.apply(this,[J]);this.renderLastSeparator=false;this.renderFirstSeparator=false;}return D;})();mstr.views.ContextMenuProcessingView=(function(){mstr.$O.extendsClass(A,mstr.views.BaseView);A.prototype.setModel=function(B){mstr.views.BaseView.prototype.setModel.apply(this,[B]);B.attachEventListener(this,"set_menu_ready","on_menu_ready");B.attachEventListener(this,"set_menu_processing","on_menu_processing");B.attachEventListener(this,"set_hide_menu_processing","on_hide_menu_processing");};A.prototype.on_menu_processing=function(){addProcessingMenuItem(this.getMenuLevel());};A.prototype.on_hide_menu_processing=function(){removeProcessingMenuItem(this.getMenuLevel());};A.prototype.on_menu_ready=function(){var C=this.getModel().getMenuItems();var B=this.getModel().getCurrentMenuItemIndices();if(C!=null&&B!=null){addDynamicMenus(this.getMenuLevel(),C,B);}};A.prototype.setMenuLevel=function(B){this.iMenu=B;};A.prototype.getMenuLevel=function(){return this.iMenu;};function A(B){mstr.views.BaseView.apply(this,[B]);}return A;})();mstr.views.ToolbarColorPickerButton=(function(){mstr.$O.extendsClass(A,mstr.views.Pulldown);A.prototype._attachLayoutHandlers=function D(){mstr.views.Pulldown.prototype._attachLayoutHandlers.apply(this);var E=this.props.model;if(E&&E.attachEventListener){E.attachEventListener(this,"set_lastColor","lastColorChanged");}this.lastColorChanged();};A.prototype._detachLayoutHandlers=function B(){mstr.views.Pulldown.prototype._detachLayoutHandlers.apply(this);var E=this.props.model;if(E&&E.detachEventListener){E.detachEventListener(this,"set_lastColor");}};A.prototype.lastColorChanged=function C(){var F=this.getModel();var H=F.get("lastColor");H=(H.indexOf(",")>-1)?H.split(",")[0]:H;var E=mstr.utils.ListViewHelper.getItemRenderer(this);var G=E._getContentContainer(this.props[mstr.$W.ELEMENT]);if(/^#[0-9a-f]{6}$/i.test(H)){G.style.backgroundColor=H;}};function A(E){mstr.views.Pulldown.apply(this,[E]);}return A;})();mstr.bones.editors.BoneTranslator=(function(){mstr.$O.extendsClass(P,mstr.models.BaseModel);P.prototype.translating=false;P.prototype._createNewModel=function H(Y){var X=Y.scriptClass;if(!X||!mstr.models[X]){return null;}var W=new mstr.models[X](Y);if(!W){return null;}mstr.controllers.Factory.add(W);var V=W.init&&W.init();return W;};P.prototype._initializeDynamicModel=function Q(V,W,Y){this._setDynamicModelValues(V,W,Y);this.props[V]=W;this._setModelChangeEventListeners(W,V);this.dynamicModels=this.dynamicModels||[];this.dynamicModels.push({dm:W,p:V,s:Y});if(V==="EditSelectorTargets"&&Y==="availableTemplates"){var a=this.get("EditSelectorSource"),Z=a&&a.getSelectedItem()&&a.getSelectedItem().olap,X=a&&a.getSelectedItem(),b=X&&X.de&&X.sty!=12033;if(Z){this._setDynamicModelValues("EditSelectorTargetsNoPlaceholder",W,"availableTemplatesNoPlaceholder");}if(b){this._setDynamicModelValues("EditSelectorTargetsNoPlaceholder",W,"availableTemplatesNoPlaceholder");}}};P.prototype._setModelChangeEventListeners=function M(W,V){if(W instanceof mstr.models.ListModel){if(W instanceof mstr.models.ColorPicker){W.attachEventListener(this,"set_actualColor","onModelPropertyChange");}else{W.attachEventListener(this,"hashadd_selectedIndices","onModelPropertyChange");W.attachEventListener(this,"hashremove_selectedIndices","onModelPropertyChange");}W.set("mappedPropertyName",V);}else{if(mstr.models.ListCart&&W instanceof mstr.models.ListCart){var X=W.get("selected");X.attachEventListener(this,"listadd_items","onModelPropertyChange");X.attachEventListener(this,"listremove_items","onModelPropertyChange");X.set("mappedPropertyName",V);}}};P.prototype._setDynamicModelValues=function G(W,X,Y){var V=(typeof (Y)=="string")?this.getBone().commands.queryState(Y):Y;if(X instanceof mstr.models.ListModel){this._setDynamicListModelValues(X,V,W);}else{if(mstr.models.ListCart&&X instanceof mstr.models.ListCart){this._setDynamicCartModelValues(X,V,W);}}};P.prototype._setDynamicListModelValues=function J(X,W,V){X.setItems(W);var Z=this.getBone().commands.queryState(V);var Y=(mstr.$A.isArray(Z))?"execSelectValues":"execSelectValue";X[Y](Z);};P.prototype._setDynamicCartModelValues=function S(X,W,V){X.get("available").setItems(W);var Y=this.getBone().commands.queryState(V);X.get("selected").setItems(Y);X._updateAvailableFilteredItems();};P.prototype._resolveDynamicModelSource=function D(V){return(V in this.props&&"getItems" in this.props[V])?this.get(V).getItems():V;};P.prototype._getPropertyCategory=function E(){return"default";};P.prototype._storeDeltaProp=function C(X,V){if(this.get("previewDisabledFields")&&this.get("previewDisabledFields")[X]){this.props.parent.set("disablePreview",true);this.props.parent.set("enablePreview",false);}var W=this._getPropertyCategory();this.deltaProps[W]=this.deltaProps[W]||{};this.deltaProps[W][X]=V;this.raiseEvent("store_deltaProp",{category:W,name:X,value:V});mstr.models.BaseModel.prototype.set.apply(this,["hasChanges",true]);};P.prototype._getDeltaProp=function O(W){var V=this._getPropertyCategory();if(!(V in this.deltaProps)||!(W in this.deltaProps[V])){return null;}return this.deltaProps[V][W];};P.prototype.getBone=function N(){return mstr.$obj(this.props.boneId);};P.prototype.reinitializeModel=function F(){var W=("dynamicModels" in this);this.translateBone();if(!this.get("enabled")){return ;}if(!W){return ;}var Z=this.translating;this.translating=true;for(var a=0,Y=this.dynamicModels.length;a<Y;a++){var b=this.dynamicModels[a];if(b.p==="EditSelectorTargets"&&b.s==="availableTemplates"){var V=this.get("EditSelectorSource"),e=V&&V.getSelectedItem()&&V.getSelectedItem().olap,X=V&&V.getSelectedItem(),c=X&&X.de&&X.sty!=12033;if(e){this._setDynamicModelValues("EditSelectorTargetsNoPlaceholder",b.dm,"availableTemplatesNoPlaceholder");continue;}if(c){this._setDynamicModelValues("EditSelectorTargetsNoPlaceholder",b.dm,"availableTemplatesNoPlaceholder");continue;}}this._setDynamicModelValues(b.p,b.dm,b.s);}this.translating=Z;};P.prototype.getDynamicListModel=function R(X,W){var Y=this._resolveDynamicModelSource(X);var V=this._createNewModel({scriptClass:"ListModel",parent:this,valueForm:"dssid"});if(V){this._initializeDynamicModel(W,V,Y);}return V;};P.prototype.getDynamicCartModel=function K(X,W){var Y=this._resolveDynamicModelSource(X);var V=this._createNewModel({scriptClass:"ListCart",parent:this,available:{scriptClass:"mstr.models.ListModel",valueForm:"dssid"},selected:{scriptClass:"mstr.models.ListModel",valueForm:"dssid"}});if(V){this._initializeDynamicModel(W,V,Y);}return V;};P.prototype.set=function U(Y,V){var X=mstr.models.BaseModel.prototype.set.apply(this,[Y,V]);if(!X){return ;}if(!this.translating&&this._isTranslatedProperty(Y)){this._storeDeltaProp(Y,V);}var W=this.get("broadcastProperties");if(W&&W[Y]){this.get("parent").notifyPropertyChange(Y,{memo:{value:V}});}};P.prototype.translateBone=function I(){var Z=this.getBone();var W=this.props.visibleField;if(W!=null&&W.length>0){this.set(W,Z.commands.queryEnabled(W));if(!this.props[W]){return ;}}if(!this.get("enabled")||!Z){return ;}var b=this.get("fields");if(!b){return ;}b=b.split("|");if(b[0]==""){b.shift();}if(b[b.length-1]==""){b.pop();}if(!b){return ;}this.translating=true;for(var a=0,Y=b.length;a<Y;a++){var X=b[a];if(!Z.commands.queryEnabled(X)){continue;}var d=this._getDeltaProp(X);if(d==null){d=Z.commands.queryState(X);}if(d&&typeof d=="string"){d=d.replace(/'+/g,"");}var V=this.props[X];if(mstr.models.ListCart&&V instanceof mstr.models.ListCart){V.get("selected").setItems(d);this._setModelChangeEventListeners(V,X);}else{if(V instanceof mstr.models.ListModel){var c=(mstr.$A.isArray(d))?"execSelectValues":"execSelectValue";var e=V[c](d);if(!e&&V.execClearSelect){V.execClearSelect();}this._setModelChangeEventListeners(V,X);}else{this.set(X,d);}}}this.translating=false;};P.prototype.onModelPropertyChange=function L(g){var Z=g.src;var e="";var W=null;if(g.name=="set_actualColor"){e=Z.get("actualColor");W=g.memo.valueWas;}else{var c=[];switch(g.name){case"hashadd_selectedIndices":case"hashremove_selectedIndices":c=Z.getSelectedItems();W=g.memo.at;break;case"listadd_items":case"listremove_items":c=Z.getItems();break;default:return ;}var a=Z.get("valueForm");var b="";for(var X=0,V=c.length;X<V;X++){e+=b+c[X][a];b=CLIPBOARD_ITEM_SEPARATOR;}}var Y=Z.get("mappedPropertyName");this.raiseEvent("set_"+Y,{name:Y,src:g.name,value:e,valueWas:W});if(this.translating){return ;}this._storeDeltaProp(Y,e);};P.prototype.resetDeltas=function B(){this.deltaProps={};mstr.models.BaseModel.prototype.set.apply(this,["hasChanges",false]);};P.prototype.collectChanges=function A(X){for(var W in this.deltaProps){var V=(W.indexOf("|")==-1)?{}:mstr.utils.Arrays.toHashProperties(W.split("|"),["category","unit","format"]);for(var Y in this.deltaProps[W]){X.push({obj:null,cmdId:Y,value:this.deltaProps[W][Y],memo:V,performFormatChange:true,submitUpdateManager:false});}}};P.prototype._isTranslatedProperty=function T(X){var V=this.props.fields;if(!V){return false;}var W=new RegExp("\\|"+X+"\\||^"+X+"\\||\\|"+X+"$|^"+X+"$");return W.test(V);};function P(V){mstr.models.BaseModel.apply(this,[V]);this.resetDeltas();}return P;})();mstr.bones.editors.BoneTranslatorManager=(function(){mstr.$O.extendsClass(P,mstr.models.ListModel);P.prototype.init=function A(){mstr.models.BaseModel.prototype.init.apply(this);this.attachEventListener(this,"set_lockedTab","_lockTabs");this._lockTabs();var R=this.getItems();var T=R.length;for(var S=0;S<T;S++){R[S].attachEventListener(this,"set_hasChanges","handleChanges");}this._startBoneTranslation();this._fixSelection();};P.prototype.on_set_viewDisabled=function N(R){this.set("CommandEnabledOkChanges",(!R.memo.value&&this.get("enableOk")));this.set("CommandEnabledPreviewChanges",(!R.memo.value&&this.get("enablePreview")));};P.prototype.on_set_enableOk=function J(R){this.set("CommandEnabledOkChanges",(R.memo.value&&!this.get("viewDisabled")));};P.prototype.on_set_enablePreview=function O(R){this.set("CommandEnabledPreviewChanges",(R.memo.value&&!this.get("viewDisabled")&&!this.get("disablePreview")));};P.prototype._startBoneTranslation=function K(){var R=this.getItems();var T=R.length;for(var S=0;S<T;S++){R[S].translateBone();}};P.prototype._lockTabs=function I(){var R=this.get("lockedTab");if(R!=-1){this.execSingleSelect(R);this.set("disableList",true);}else{this.set("disableList",false);}};P.prototype.execReinitializeModel=function E(){this.set("hasChanges",false);this.set("previewCount",0);this.props.enableOk=false;this.props.enablePreview=false;this.set("viewDisabled",false);this.set("disablePreview",false);this._reinitializeChildModels();this._fixSelection();};P.prototype._reinitializeChildModels=function G(){var R=this.getItems();for(var T=0,S=R.length;T<S;T++){R[T].reinitializeModel();}};P.prototype.handleChanges=function Q(R){this.set("hasChanges",R.memo.value);if(!R.memo.value){return ;}this.set("enableOk",true);this.set("enablePreview",true);if(this.get("lockedTab")!=-1&&!this.get("viewDisabled")){this.set("lockedTab",-1);}};P.prototype.disableModelFromView=function F(R){this.set("viewDisabled",R);};P.prototype.execOkChanges=function D(){this.saveModelChanges();this.set("enableOk",false);this.set("enablePreview",false);return true;};P.prototype.execPreviewChanges=function H(){var R=microstrategy.updateManager;if(R){R.observer.register(this.props.id);}this.saveModelChanges();this.set("enablePreview",false);this.props.previewCount++;if(R&&!R.isFlushing()){var S=mstr.$obj(this.get("boneId"));if(S&&S.commands.queryEnabled("oneTable")){this._initializeSelectors();}this._reinitializeChildModels();R.observer.unregister(this.props.id);}return true;};P.prototype.saveModelChanges=function C(){var S=new Array();var R=this.getItems();for(var U=0,T=R.length;U<T;U++){R[U].collectChanges(S);}if(S.length>0){var V=mstr.$obj(this.props.boneId);if(V){if(!(V.commands.exec(this.props.boneCmdId,S))){return false;}}}this.execClearChanges();return true;};P.prototype.execClearChanges=function L(){var R=this.getItems();for(var T=0,S=R.length;T<S;T++){R[T].resetDeltas();}};P.prototype.execCancelChanges=function M(){this.execClearChanges();var R=mstr.$obj(this.props.boneId);if(R){R.commands.exec("cancelEdit",this.get("previewCount"));}this.set("lockedTab",-1);this.set("enablePreview",false);this.set("enableOk",false);};P.prototype._fixSelection=function B(){var U=this.getSelectedItem();if(!U.get(U.get("visibleField"))){var R=this.getItems();for(var T=0,S=R.length;T<S;T++){if(R[T].get(R[T].get("visibleField"))){this.execSingleSelect(T);return ;}}}};function P(R){mstr.models.ListModel.apply(this,[R]);}return P;})();mstr.bones.editors.PropertiesBoneTranslatorManager=(function(){mstr.$O.extendsClass(I,mstr.bones.editors.BoneTranslatorManager);I.prototype._initializeSelectors=function N(){var X=mstr.$obj(this.get("boneId"));this.set("showGridSelectors",X.commands.queryEnabled("showGridSelectors"));this.set("showPanelSelector",X.commands.queryEnabled("showPanelSelector"));var V=["edtUnitSelector","edtValueSelector"];for(var W=0;W<2;W++){this._initializeSingleSelector(V[W]);}};I.prototype._initializeSingleSelector=function O(W){var X=mstr.$obj(this.get("boneId"));var V=this.get(W);V.detachEventListener(this,"hashadd_selectedIndices");V.set("cmdId",W);var Y=X.commands.queryState(W,this._getTabName());if(Y.isFetching&&(!this.pollInterval)){this._setGridModelEnablement(false);this.pollInterval=self.setInterval("mstr.$obj('"+this.get("id")+"').pollForGridFormat();",100);}V.set("visible",Y.visible);V.set("enabled",Y.enabled);if(Y.items){V.setItems(Y.items);if("value" in Y){V.execSelectValue(Y.value);}}V.attachEventListener(this,"hashadd_selectedIndices","updateTargetFromUnitSelectors");};I.prototype._getTabName=function B(){return mstr.controllers.Factory.safeget(this.getSelectedItem(),"tabName");};I.prototype._setGridModelEnablement=function C(W){var V=this.getItems();for(var Y=0,X=V.length;Y<X;Y++){var Z=mstr.controllers.Factory.safeget(V[Y],"unitSelectorChange");if(Z&&(Z.indexOf("Grid")>-1)){mstr.controllers.Factory.safeset(V[Y],"enabled",W);if(W&&V[Y].reinitializeModel){V[Y].reinitializeModel();}}}};I.prototype.on_set_enablePreview=function T(V){if(!V.memo.value||this.get("viewDisabled")){mstr.bones.editors.BoneTranslatorManager.prototype.on_set_enablePreview.apply(this,[V]);return ;}this.set("CommandEnabledPreviewChanges",!this.get("isGridFormatted"));};I.prototype.pollForGridFormat=function F(){var V=mstr.$obj(this.get("boneId"));if(V.commands.queryState("areGridFormatsReady")){this._clearGridFormatPoll();this._setGridModelEnablement(true);}};I.prototype._clearGridFormatPoll=function D(){if(this.pollInterval){self.clearInterval(this.pollInterval);delete this.pollInterval;}};I.prototype._cancelGridFormatPoll=function Q(){if(!this.pollInterval){return ;}this._clearGridFormatPoll();var Y=mstr.$obj(this.get("boneId"));Y.commands.exec("cancelGridFormatRequest");var V=this.getItems();for(var X=0,W=V.length;X<W;X++){mstr.controllers.Factory.safeset(V[X],"enabled",true);}};I.prototype._startBoneTranslation=function M(){this._initializeSelectors();mstr.bones.editors.BoneTranslatorManager.prototype._startBoneTranslation.apply(this);};I.prototype._handleDeltaPropStorage=function P(V){return ;var W=V.memo.category.split("|");if(W.length==3){if(W[0]=="Grid"||(W[0]=="AllGrid"&&W[1]!="0")){this.set("isGridFormatted",true);this.set("enablePreview",false);}}};I.prototype.init=function E(){mstr.bones.editors.BoneTranslatorManager.prototype.init.apply(this);this.set("isGridFormatted",false);var V=this.getItems();for(var X=0,W=V.length;X<W;X++){V[X].attachEventListener(this,"store_deltaProp","_handleDeltaPropStorage");}};I.prototype.acknowledgeReloadEnd=function U(){this.execReinitializeModel();var V=microstrategy.updateManager;if(V){V.observer.unregister(this.props.id);}};I.prototype.execReinitializeModel=function H(){this._initializeSelectors();this.set("isGridFormatted",false);this.set("showCancelButton",true);mstr.bones.editors.BoneTranslatorManager.prototype.execReinitializeModel.apply(this);var V=this.getSelectedItem();if(!V.get(V.get("visibleField"))){this.execSingleSelect(0);}};I.prototype.updateTargetFromUnitSelectors=function A(X){var W=X.src.get("cmdId");var V=this.get(W);var Y={src:W,v:V.getSelectedItem()[V.get("valueForm")],t:this._getTabName()};mstr.$obj(this.get("boneId")).commands.exec("setUnitFormatLevels",Y);if(W=="edtUnitSelector"){this._initializeSingleSelector("edtValueSelector");}this._reinitializeSelectorBasedModels();};I.prototype._reinitializeSelectorBasedModels=function S(){if(this.pollInterval){return ;}var V=this.getItems();for(var X=0,W=V.length;X<W;X++){var Y=V[X].get("unitSelectorChange");if(Y){V[X].reinitializeModel();}}};I.prototype.execClearChanges=function R(){mstr.bones.editors.BoneTranslatorManager.prototype.execClearChanges.apply(this);this._cancelGridFormatPoll();};I.prototype.execOpenWebHyperLinkEditor=function L(){mstr.$obj("rwb_viewer").doc.commands.exec("WebHyperLinkEditor");this.set("showCancelButton",false);};I.prototype.handleChanges=function G(V){mstr.bones.editors.BoneTranslatorManager.prototype.handleChanges.apply(this,[V]);V.memo.value&&this.set("showCancelButton",true);};I.prototype.on_hashadd_selectedIndices=function K(V){mstr.bones.editors.BoneTranslatorManager.prototype.on_hashadd_selectedIndices.call(this,V);var X=this._getTabName();if(X){mstr.$obj(this.get("boneId")).commands.exec("edtTabChange",X);}var W=this.getItems();if(W.length>0&&W[0].get){this._initializeSelectors();this._reinitializeSelectorBasedModels();}};I.prototype.notifyPropertyChange=function J(X,V){var W=this.getItems();for(var Z=0,Y=W.length;Z<Y;Z++){if(W[Z]["on_set_ext_prop_"+X]){W[Z]["on_set_ext_prop_"+X](V);}}};function I(V){mstr.bones.editors.BoneTranslatorManager.apply(this,[V]);}return I;})();mstr.bones.editors.FormatEditingBoneTranslator=(function(){mstr.$O.extendsClass(C,mstr.bones.editors.BoneTranslator);C.prototype._getPropertyCategory=function A(){var F=mstr.bones.editors.BoneTranslator.prototype._getPropertyCategory.apply(this);var J=this.get("parent");var H=J.get("edtUnitSelector");var I=J.get("edtValueSelector");var E=((J.get("showGridSelectors"))?"Grid":"default")+"|";var G=H.getSelectedItem();if(!G){return F;}E+=H.getSelectedItem()[H.get("valueForm")]+"|";G=I.getSelectedItem();if(!G){return F;}E+=I.getSelectedItem()[I.get("valueForm")];return E;};C.prototype.refreshForSearchBox=function B(G,E){if(E){var F=G.get("visibleField");if(F=="alignmentTabEnabled"||F=="effectsTabEnabled"){G.set(F,false);}}};C.prototype.translateBone=function D(){mstr.bones.editors.BoneTranslator.prototype.translateBone.apply(this);this.translating=true;var E=mstr.bones.editors.LayoutPropertiesBoneTranslator.prototype.isSearchBox(this);this.refreshForSearchBox(this,E);this.translating=false;};function C(E){mstr.bones.editors.BoneTranslator.apply(this,[E]);}return C;})();mstr.bones.editors.EffectsPropertiesBoneTranslator=(function(){mstr.$O.extendsClass(A,mstr.bones.editors.FormatEditingBoneTranslator);A.prototype.on_set_ext_prop_showTranslucent=function B(C){var D=C.InfoWindowMode;this.set("showTranslucent",(C.UseAsInformationWindow&&(D==="2"||D==="3"||D==="4")));};function A(C){mstr.bones.editors.FormatEditingBoneTranslator.apply(this,[C]);}return A;})();mstr.bones.editors.FontPropertiesBoneTranslator=(function(){mstr.$O.extendsClass(A,mstr.bones.editors.FormatEditingBoneTranslator);A.prototype._getPropertyCategory=function C(){return mstr.bones.editors.FormatEditingBoneTranslator.prototype._getPropertyCategory.apply(this);};A.prototype.on_set_ext_prop_ButtonDisplayStyle=function B(D){var E=Number(D.memo.value);var F=this.get("visibleField");switch(E){case microstrategy.BUTTON_STYLE_CAPTION_ONLY:case microstrategy.BUTTON_STYLE_ICON_LEFT:case microstrategy.BUTTON_STYLE_ICON_RIGHT:case microstrategy.BUTTON_STYLE_ICON_TOP:this.set(F,true);break;case microstrategy.BUTTON_STYLE_ICON_ONLY:case microstrategy.BUTTON_STYLE_CUSTOM:this.set(F,false);break;}};function A(D){mstr.bones.editors.FormatEditingBoneTranslator.apply(this,[D]);}return A;})();mstr.bones.editors.LayoutPropertiesBoneTranslator=(function(){mstr.$O.extendsClass(R,mstr.bones.editors.BoneTranslator);var E=null;var D={};R.prototype.init=function S(){mstr.bones.editors.BoneTranslator.prototype.init.apply(this);E=this.get("XTabView").getItems()[this.get("XTabView").indexOfValue("50")];};R.prototype.translateBone=function B(){mstr.bones.editors.BoneTranslator.prototype.translateBone.apply(this);var Y=this.get("XTabView").getSelectedItemValue();this.set("ExportOverflowVisible",!this.get("IsPortal")&&(Y==1||Y==3));this.on_set_DataSource();D={};};R.prototype.getDynamicListModel=function I(a,Z){var Y=mstr.bones.editors.BoneTranslator.prototype.getDynamicListModel.apply(this,[a,Z]);if(Z=="DataSource"){this.on_set_DataSource();}else{if(Z=="EditSelectorStyle"){this.on_set_EditSelectorStyle();}}return Y;};R.prototype._setDynamicModelValues=function G(Z,a,b){if(Z=="EditSelectorStyle"){this.isNde=this._isNde();var Y=this._getApplicableStyles(this.isNde);this._setDynamicListModelValues(a,Y,Z);}else{mstr.bones.editors.BoneTranslator.prototype._setDynamicModelValues.apply(this,[Z,a,b]);}};R.prototype._isNde=function Q(){var b=mstr.controllers.Factory.getPath("parent/items/6/EditSelectorSource",this);var Y=b&&b.get("selectedIndicesList"),Z,a;if(Y!=undefined){a=b.get("items")[Y];Z=a.sty==12033;}else{a=microstrategy.getViewerBone()&&microstrategy.getViewerBone().commands.queryState("EditSelectorSource");if(a){Z=a.split("|")[1]==47;}}return Z;};R.prototype._getApplicableStyles=function V(a){var c=[],Y=this.get("SelectorStyles").get("items"),Z,b;for(Z=0;Z<Y.length;Z++){b=Y[Z];if(a&&b.dssid==9){continue;}c.push(b);}this.isNde=a;return c;};R.prototype.on_set_ext_prop_EditSelectorSource=function M(Y){var c=this._isNde();if(c!=this.isNde){this.isNde=c;var a=this.get("EditSelectorStyle");if(a){var Z=this._getApplicableStyles(c),b=a.getSelectedItemValue();a.setItems(Z);if(b){a.execSelectValue(b);}}}};R.prototype.on_set_ext_prop_IsPortal=function P(Y){var Z=Y.memo.value;var a=this.translating;this.translating=true;this.set("IsPortal",Z);this.translating=a;if(!this.get("isOneGrid")){return ;}this.set("showFixedHeightOnly",Z);this.set("showFixedFitHeight",!Z);this.set("showFixedWidthOnly",Z);this.set("showFixedFitWidth",!Z);this.set("ExportOverflowVisible",!Z&&this.props.XTabView.getSelectedIndex()!=1);};R.prototype.on_set_DataSource=function F(Y){this.set("enableShortcut",this.props.DataSource&&this.props.DataSource.props.selectedCount>0&&!this.props.isCubeReportDataset);};R.prototype.on_set_XTabView=function J(Y){if(!this.translating){this.get("parent").notifyPropertyChange("XTabView",Y);this.set("ExportOverflowVisible",!this.get("IsPortal")&&(Y.memo.value==1||Y.memo.value==3));}};R.prototype.on_set_Height=function A(Y){if(this._shouldLockRatio()){this._lockRatio(Y,"Width");}};R.prototype.on_set_Width=function U(Y){if(this._shouldLockRatio()){this._lockRatio(Y,"Height");}};R.prototype.on_set_ext_prop_EditSelectorType=function H(Y){this.on_set_EditSelectorStyle(Y);};R.prototype.on_set_EnableSelCount=function H(Y){if(!this.get("EnableSelCount")){this.set("MaxSel","");this.set("MinSel","");}};R.prototype.on_set_ext_prop_isDSAsTarget=function X(Y){this._checkSearchBoxProps(Y);};R.prototype.on_set_ext_prop_EditSelectorStyle=function T(Y){this._checkSearchBoxProps(Y);};R.prototype._checkSearchBoxProps=function L(Y){var Z=this.isSearchBox(this);this.set("visibleSearchOnServ",Z);this.set("ItemWidthModeEnabled",!Z);if(Z){this.get("EditSelectorOrientation").set("selectedIndicesList",0);var a=this.get("setWidget");if(a){a.set("selectedIndicesList",0);}}mstr.bones.editors.ColorLinesPropertiesBoneTranslator.prototype.refreshForSearchBox(this.get("parent").get("items")[8],Z);mstr.bones.editors.FormatEditingBoneTranslator.prototype.refreshForSearchBox(this.get("parent").get("items")[11],Z);mstr.bones.editors.FormatEditingBoneTranslator.prototype.refreshForSearchBox(this.get("parent").get("items")[12],Z);mstr.bones.editors.SelectorPageBoneTranslator.prototype.refreshForSearchBox(this.get("parent").get("items")[6],Z);};R.prototype.on_set_EditSelectorStyle=function N(a){var c=mstr.controllers.Factory.getPath("parent/items/6/EditSelectorType",this);var Z,d,e;this._checkSearchBoxProps(a);if(c.props&&c.props.selectedIndicesList!=undefined){Z=c.props.selectedIndicesList=="2";d=c.props.selectedIndicesList=="4";e=c.props.selectedIndicesList=="5";}else{Z=microstrategy.getViewerBone()&&microstrategy.getViewerBone().commands.queryState("EditSelectorType")=="3";d=microstrategy.getViewerBone()&&microstrategy.getViewerBone().commands.queryState("EditSelectorType")=="5";e=microstrategy.getViewerBone()&&microstrategy.getViewerBone().commands.queryState("EditSelectorType")=="8";}if(Z||e){this.set("EditSelectorMultiSelectEnabled",false);return ;}if(d){this.set("EditSelectorMultiSelectEnabled",true);return ;}var b=this.get("EditSelectorStyle"),Y=b&&b.props.selectedIndicesList;switch(Y){case"1":case"2":case"3":case"5":case"6":case"7":this.set("EditSelectorMultiSelectEnabled",true);break;default:this.set("EditSelectorMultiSelectEnabled",false);}this.set("ChangeSelectionOnMouseOverEnabled",(this.props.isSlicingSelector&&Y!=7));};R.prototype._shouldLockRatio=function W(){return(!this.translating&&!this.adjustingRatio&&this.getBone().commands.queryState("LockAspectRatio"));};R.prototype._lockRatio=function K(Y,g){var a=Y.memo,Z=a.value,c=a.name,b=g;if(!(D[c]&&D[c].hasOwnProperty(b))){if(!D[c]){D[c]={};}var e=this.get(b)/a.valueWas;e=isNaN(e)||!isFinite(e)?0:e;D[c][b]=e;if(!D[b]){D[b]={};}D[b][c]=1/e;}this.adjustingRatio=true;this.set(g,Z*D[c][b]);this.adjustingRatio=false;};R.prototype.on_set_LockAspectRatio=function C(Y){if(!Y.memo.value){D={};}};R.prototype.isSearchBox=function O(b){var Y=mstr.controllers.Factory.getPath("parent/items/6/EditSelectorType",b);var d=mstr.controllers.Factory.getPath("parent/items/1/EditSelectorStyle",b);var a=function(g,e){return g?g.commands.queryState(e):null;};var Z=Y&&Y.getSelectedItemValue()!=null?Y.getSelectedItemValue():a(microstrategy.getViewerBone(),"EditSelectorType");var c=d&&d.getSelectedItemValue()!=null?d.getSelectedItemValue():a(microstrategy.getViewerBone(),"EditSelectorStyle");return(Z=="1"&&c=="9");};function R(Y){mstr.bones.editors.BoneTranslator.apply(this,[Y]);}return R;})();mstr.bones.editors.GridPropertiesBoneTranslator=(function(){mstr.$O.extendsClass(F,mstr.bones.editors.BoneTranslator);F.prototype.translateBone=function C(){mstr.bones.editors.BoneTranslator.prototype.translateBone.apply(this);this.translating=true;this.on_set_DrillOptions();this.translating=false;};F.prototype.on_set_DrillOptions=function E(G){var H=(G&&G.memo&&G.memo.value);if(H==null){H=this.get("DrillOptions").getSelectedItemValue();}if(H==""){return ;}this.set("showSyncDrillingOpt",(H==2)&&mstr.behaviors.featureResolver.featAvailable(microstrategy.FEATURE_RW_EDITABLE_VIEW_MODE_EPLUS));};F.prototype.IF_MODE_ROWS="1";F.prototype.IF_MODE_BLOCKS="2";F.prototype.on_set_gridIfRowMode=function B(M){var G=(M&&M.memo&&M.memo.value);if(G==null){G=this.get("gridIfRowMode").getSelectedItemValue();}if(G==""){return ;}var I=this.getBone(),J=I.doc.selections.getSelectedGrid(),H=microstrategy.findBone(J),L=H.ifTotalRows,K=H.ifTotalBlocks,N=this.get("gridIfMaxRows"),O=N;if(L&&K){if(G===this.IF_MODE_ROWS){O=Math.round(N*L/K)||1;}else{O=Math.round(N*K/L)||1;}}else{O=1;}this.set("gridIfMaxRows",O);};F.prototype.on_set_Outline=function D(G){if(this.props.Outline&&!this.translating){if(microstrategy.DISPLAY_MODE===2){var H=this.getBone(),I=H.doc.selections.getSelectedGrid(),K=microstrategy.findBone(I),J=K.ifTotalRows;if(J>5000){showMessage({contents:mstrmojo.desc(15778,"Enabling Outline will disable the Incremental Fetch setting in the grid."),zIndex:99999,elements:microstrategy.OK_BUTTON,type:mstrMsgBoxImpl.MSG_WARNING});}}this.set("gridIfEnabled",!this.props.Outline);}};F.prototype.on_set_gridIfEnabled=function A(G){if(this.props.gridIfEnabled&&this.props.Outline){showMessage({contents:mstrmojo.desc(15779,"Enabling Incremental Fetch will disable Outline in Presentation Mode."),zIndex:99999,elements:microstrategy.OK_BUTTON,type:mstrMsgBoxImpl.MSG_WARNING});}};function F(G){mstr.bones.editors.BoneTranslator.apply(this,[G]);}return F;})();mstr.bones.editors.NumberPropertiesBoneTranslator=(function(){mstr.$O.extendsClass(D,mstr.bones.editors.FormatEditingBoneTranslator);D.prototype.init=function F(){mstr.bones.editors.FormatEditingBoneTranslator.prototype.init.apply(this);this.attachEventListener(this,"set_Category","_buildFormatString");this.attachEventListener(this,"set_DecimalPlaces","_buildFormatString");this.attachEventListener(this,"set_ThousandSeparator","_buildFormatString");this.attachEventListener(this,"set_CurrencySymbol","_buildFormatString");this.attachEventListener(this,"set_CurrencyPosition","_buildFormatString");this.get("NegativeNumbers").attachEventListener(this,"hashadd_selectedIndices","_buildFormatString");this.get("Date").attachEventListener(this,"hashadd_selectedIndices","_buildFormatString");this.get("Time").attachEventListener(this,"hashadd_selectedIndices","_buildFormatString");this.get("Fraction").attachEventListener(this,"hashadd_selectedIndices","_buildFormatString");};D.prototype.translateBone=function E(){mstr.bones.editors.FormatEditingBoneTranslator.prototype.translateBone.apply(this);var J=this.get("Format");var L=this.get("Category").getSelectedItem();L=L?parseInt(L.dssid):-2;switch(L){case -2:case 9:if(this.get("Format")=="General"){var K=this.translating;this.translating=true;this.set("Format","");this.translating=K;}break;case 0:case 1:case 4:this._rebuildNegativeNumberField(this._buildDecimalString(true));break;case 2:this.get("Date").execSelectValue(J);break;case 3:this.get("Time").execSelectValue(J);break;case 5:this.get("Fraction").execSelectValue(J);break;}};D.prototype.onModelPropertyChange=function H(J){mstr.bones.editors.FormatEditingBoneTranslator.prototype.onModelPropertyChange.apply(this,[J]);this._buildFormatString(J);};D.prototype._buildDecimalString=function I(N){var J="";var L=parseInt(this.get("DecimalPlaces"));for(var K=0;K<L;K++){J+="0";}var M=".";if(N){M=mstr.$obj("mstrPageInfo").get("userInfo").get("decimalSeparator");}return(J.length>0)?M+J:"";};D.prototype._addNegativeFormatString=function A(J){switch(this.get("NegativeNumbers").getSelectedIndex()){case 1:return J+";[RED]-"+J;case 2:return J+";[RED]"+J;case 3:return J+";("+J+")";case 4:return J+";[RED]("+J+")";default:return J;}};D.prototype._addCurrencySymbolFormatString=function C(J){var K="";var L=this.get("CurrencySymbol");switch(this.get("CurrencyPosition").getSelectedIndex()){case 1:K=J+'"'+L+'"';break;case 2:K='"'+L+' "'+J;break;case 3:K=J+'" '+L+'"';break;default:K='"'+L+'"'+J;}return this._addNegativeFormatString(K);};D.prototype._buildFormatString=function B(M){var O=this.get("Category").getSelectedItem();if(!O){return ;}var K=parseInt(O.dssid);if(K==7){return ;}var J=this._buildDecimalString();if(K==0||K==1||K==4){this._rebuildNegativeNumberField(this._buildDecimalString(true));}var N=(this.get("ThousandSeparator"))?",":"";var L="";switch(K){case 0:L=this._addNegativeFormatString("#"+N+"##0"+J);break;case 1:L=this._addCurrencySymbolFormatString("#,##0"+J);break;case 2:L=this.get("Date").getSelectedItem()["dssid"];break;case 3:L=this.get("Time").getSelectedItem()["dssid"];break;case 4:L=this._addNegativeFormatString("0"+J+"%");break;case 5:L=this.get("Fraction").getSelectedItem()["dssid"];break;case 6:L="0"+J+"E+00";}this.set("Format",L);};D.prototype._rebuildNegativeNumberField=function G(Q){var L=this.translating;this.translating=true;var J=this.get("NegativeNumbers");var P=mstr.utils.Hash.deepClone(J.getItems());var T=J.getSelectedItem()&&J.getSelectedItem()["dssid"];J.detachEventListener(this,"hashadd_selectedIndices");J.detachEventListener(this,"hashremove_selectedIndices");var N=this.get("Red");var K=this.getBone().commands.queryState("textfieldSelected")?"color:red;display:block;":"color:red;display:none;";var S=mstr.Settings.Locale.THOUSANDSEP;var R=parseInt(this.get("Category").getSelectedItem()["dssid"]);switch(R){case 0:S=(this.get("ThousandSeparator"))?S:"";P[0]["n"]="-1"+S+"234"+Q;P[1]["n"]="-1"+S+"234"+Q+" ["+N+"]";P[1]["cssText"]=K;P[2]["n"]="1"+S+"234"+Q+" ["+N+"]";P[2]["cssText"]=K;P[3]["n"]="(1"+S+"234"+Q+")";P[4]["n"]="(1"+S+"234"+Q+") ["+N+"]";P[4]["cssText"]=K;break;case 1:var O="";var U="";var M=this.get("CurrencySymbol");switch(this.get("CurrencyPosition").getSelectedIndex()){case 2:O+=" ";case 0:O=M+O;break;case 3:U+=" ";case 1:U+=M;break;}P[0]["n"]=O+"-1"+S+"234"+Q+U;P[1]["n"]=O+"-1"+S+"234"+Q+U+" ["+N+"]";P[1]["cssText"]=K;P[2]["n"]=O+"1"+S+"234"+Q+U+" ["+N+"]";P[2]["cssText"]=K;P[3]["n"]="("+O+"1"+S+"234"+Q+U+")";P[4]["n"]="("+O+"1"+S+"234"+Q+U+") ["+N+"]";P[4]["cssText"]=K;break;case 4:P[0]["n"]="-123"+Q+"%";P[1]["n"]="-123"+Q+"% ["+N+"]";P[1]["cssText"]=K;P[2]["n"]="123"+Q+"% ["+N+"]";P[2]["cssText"]=K;P[3]["n"]="(123"+Q+"%)";P[4]["n"]="(123"+Q+"%) ["+N+"]";P[4]["cssText"]=K;break;}J.setItems(P);if(T){J.execSelectValue(T);}J.attachEventListener(this,"hashadd_selectedIndices","onModelPropertyChange");J.attachEventListener(this,"hashremove_selectedIndices","onModelPropertyChange");this.translating=L;};function D(J){mstr.bones.editors.FormatEditingBoneTranslator.apply(this,[J]);}return D;})();mstr.bones.editors.ColorLinesPropertiesBoneTranslator=(function(){mstr.$O.extendsClass(C,mstr.bones.editors.FormatEditingBoneTranslator);C.prototype.on_set_enableBorders=function G(H){var I=mstr.controllers.Factory.safeget;this.resolveBorderEnablement(H.memo.value,I(this.get("parent").get("items")[12],"enabled3d"));};C.prototype.on_set_ext_prop_enabled3d=function D(H){this.resolveBorderEnablement(this.get("enableBorders"),H.memo.value);};C.prototype.resolveBorderEnablement=function B(I,H){this.set("enableBordersNot3d",I&&!H);};C.prototype.translateBone=function F(){mstr.bones.editors.FormatEditingBoneTranslator.prototype.translateBone.apply(this);this.translating=true;var H=mstr.bones.editors.LayoutPropertiesBoneTranslator.prototype.isSearchBox(this);this.refreshForSearchBox(this,H);this.translating=false;};C.prototype.refreshForSearchBox=function A(L,J){var M=microstrategy.formatType;var I=L.get("parent").get("edtValueSelector");var K=I.get("items");var H=mstr.$A.findByForm(K,4,"dssid",false);if(J&&H>=0){I.set("selectedIndicesList",H);}I.set("formatEnabled",!J);microstrategy.formatType=M;};C.prototype.on_set_ext_prop_ButtonDisplayStyle=function E(H){var I=Number(H.memo.value);var J=this.get("visibleField");switch(I){case microstrategy.BUTTON_STYLE_CAPTION_ONLY:case microstrategy.BUTTON_STYLE_ICON_LEFT:case microstrategy.BUTTON_STYLE_ICON_RIGHT:case microstrategy.BUTTON_STYLE_ICON_TOP:case microstrategy.BUTTON_STYLE_ICON_ONLY:this.set(J,true);break;case microstrategy.BUTTON_STYLE_CUSTOM:this.set(J,false);break;}};function C(H){mstr.bones.editors.FormatEditingBoneTranslator.apply(this,[H]);}return C;})();mstr.bones.editors.ThemePropertiesBoneTranslator=(function(){mstr.$O.extendsClass(D,mstr.bones.editors.FormatEditingBoneTranslator);function D(I){mstr.bones.editors.FormatEditingBoneTranslator.apply(this,[I]);}D.prototype._resolveAppliedThemeTypeSelected=function H(){var J=this.get("appliedThemeID"),I=this.get("appliedThemeType"),K=this.get("appliedThemeTypes");if(!K){return ;}switch(I){case microstrategy.APPLIED_THEME_NONE:case microstrategy.APPLIED_THEME_CUSTOM:K.execSelectValue(I);break;case microstrategy.APPLIED_THEME_DEFAULT:K.execSelectValue(J);break;}};D.prototype._resolveAppliedThemeAsLink=function G(){var I=this.get("appliedThemeAsLink"),J=this.get("appliedThemeAsTypes");if(!J){return ;}J.execSelectValue(I?"1":"0");};D.prototype.translateBone=function F(){mstr.bones.editors.BoneTranslator.prototype.translateBone.apply(this);this.translating=true;this._resolveAppliedThemeTypeSelected();this._resolveAppliedThemeAsLink();this.translating=false;};D.prototype._handleAppliedThemeTypeChange=function E(I){if(this.translating){return ;}var K=this.get("appliedThemeTypes"),J=K.getSelectedItemValue();if(J===microstrategy.APPLIED_THEME_CUSTOM){this.set("appliedThemeType",J);this.set("appliedThemeID",null);this.set("showAppliedThemeAsType",true);this.set("showCustomThemePicker",true);}else{if(J===microstrategy.APPLIED_THEME_NONE){this.set("appliedThemeType",J);this.set("appliedThemeID",null);this.set("showAppliedThemeAsType",false);this.set("showCustomThemePicker",false);}else{this.set("appliedThemeType",microstrategy.APPLIED_THEME_DEFAULT);this.set("appliedThemeID",J);this.set("showAppliedThemeAsType",true);this.set("showCustomThemePicker",false);}}};D.prototype._handleAppliedThemeAsTypeChange=function A(I){if(this.translating){return ;}var K=this.get("appliedThemeAsTypes"),J=K.getSelectedItemValue();this.set("appliedThemeAsLink",J==="0"?false:true);};D.prototype.onModelPropertyChange=function C(I){mstr.bones.editors.BoneTranslator.prototype.onModelPropertyChange.apply(this,[I]);if(this.get("appliedThemeTypes")==I.src&&I.name=="hashadd_selectedIndices"){this._handleAppliedThemeTypeChange(I);}else{if(this.get("appliedThemeAsTypes")==I.src&&I.name=="hashadd_selectedIndices"){this._handleAppliedThemeAsTypeChange(I);}}};D.prototype.execBrowseTheme=function B(J){var L=microstrategy.getViewerBone(),I=L.saveFolderId?L.saveFolderId:L.parentFolderID,K=this;microstrategy.showApplyThemeEditor(false,null,function(O,N,M){K.set("appliedThemeID",O);K.set("appliedThemePath",encode(M));});};return D;})();mstr.bones.editors.DocAdvancedBoneTranslator=(function(){mstr.$O.extendsClass(A,mstr.bones.editors.BoneTranslator);A.prototype._storeDeltaProp=function B(E,C){mstr.bones.editors.BoneTranslator.prototype._storeDeltaProp.apply(this,arguments);if(E=="RefreshDocument"&&C){var D="RefreshFrequency";this._storeDeltaProp(D,this.get(D));}};function A(C){mstr.bones.editors.BoneTranslator.apply(this,[C]);}return A;})();mstr.bones.editors.DocMobileBoneTranslator=(function(){mstr.$O.extendsClass(B,mstr.bones.editors.BoneTranslator);B.prototype.set=function A(D,C){mstr.bones.editors.BoneTranslator.prototype.set.apply(this,[D,C]);};function B(C){mstr.bones.editors.BoneTranslator.apply(this,[C]);}return B;})();mstr.bones.editors.PageSetupPageBoneTranslator=(function(){mstr.$O.extendsClass(E,mstr.bones.editors.BoneTranslator);E.prototype.init=function C(){mstr.bones.editors.BoneTranslator.prototype.init.apply(this);this.attachEventListener(this,"set_PageWidth","_handlePaperSizeChange");this.attachEventListener(this,"set_PageHeight","_handlePaperSizeChange");this.attachEventListener(this,"set_ScalePercentage","_handleScalingChange");this.attachEventListener(this,"set_ScalePagesWide","_handleScalingChange");this.attachEventListener(this,"set_ScalePagesTall","_handleScalingChange");};E.prototype._handlePaperSizeChange=function D(O){if(this.translating||this.changingPaperSize){return ;}if(O.name=="hashremove_selectedIndices"){return ;}this.changingPaperSize=true;var J,M,N,H,L;var P=this.get("PaperType");var G=this.get("PaperOrientation");var F=O.src;if(F==this){J=parseFloat(microstrategy.number.toUSUnits(this.get("PageHeight"),true),10);M=parseFloat(microstrategy.number.toUSUnits(this.get("PageWidth"),true),10);N=G.getSelectedIndex();if(N==0&&M>J){G.execSingleSelect(1);}else{if(N==1&&J>M){G.execSingleSelect(0);}}H=Math.min(J,M);L=Math.max(J,M);if(!P.execSelectString(".*,"+H+","+L,P.get("valueForm"))){P.execClearSelect();}}else{if(F==P){var N=P.getSelectedItemValue().split(",").slice(1);var K=["PageWidth","PageHeight"];if(G.getSelectedIndex()!=0){K.reverse();}for(var I=0;I<N.length;I++){this.set(K[I],microstrategy.number.toUserUnits(N[I]));}}else{J=parseFloat(microstrategy.number.toUSUnits(this.get("PageHeight")),10);M=parseFloat(microstrategy.number.toUSUnits(this.get("PageWidth")),10);H=Math.min(J,M);L=Math.max(J,M);H=microstrategy.number.toUserUnits(H);L=microstrategy.number.toUserUnits(L);N=G.getSelectedIndex();if(N==0){if(J!=L){this.set("PageHeight",L);this.set("PageWidth",H);}}else{if(J!=H){this.set("PageHeight",H);this.set("PageWidth",L);}}}}this.changingPaperSize=false;};E.prototype.onModelPropertyChange=function A(F){mstr.bones.editors.BoneTranslator.prototype.onModelPropertyChange.apply(this,[F]);if(F.src==this.get("PaperType")||F.src==this.get("PaperOrientation")){this._handlePaperSizeChange(F);}};E.prototype._handleScalingChange=function B(F){if(this.translating||this.changingScale){return ;}this.changingScale=true;var H=this.get("Scaling");var G=H.getSelectedIndex();if(F.name=="set_ScalePercentage"){if(G!=0){H.execSingleSelect(0);}}else{if(G!=1){H.execSingleSelect(1);}}this.changingScale=false;};function E(F){mstr.bones.editors.BoneTranslator.apply(this,[F]);}return E;})();mstr.bones.editors.ButtonPropertiesBoneTranslator=(function(){mstr.$O.extendsClass(A,mstr.bones.editors.BoneTranslator);A.prototype.on_set_DisplayStyle=function D(E){var F=E.memo.value;this._onSetDisplayStyle(F);this.get("parent").notifyPropertyChange("ButtonDisplayStyle",E);};A.prototype._onSetDisplayStyle=function B(F){F=Number(F);var E=this;function G(H){E.set("normalURLEnable",H);E.set("highlightURLEnable",H);}switch(F){case microstrategy.BUTTON_STYLE_CAPTION_ONLY:G(false);break;case microstrategy.BUTTON_STYLE_ICON_ONLY:case microstrategy.BUTTON_STYLE_ICON_LEFT:case microstrategy.BUTTON_STYLE_ICON_RIGHT:case microstrategy.BUTTON_STYLE_ICON_TOP:case microstrategy.BUTTON_STYLE_CUSTOM:G(true);break;}if(this.get("isInsideNavBar")){this.set("highlightURLEnable",false);}};A.prototype.translateBone=function C(){mstr.bones.editors.BoneTranslator.prototype.translateBone.apply(this);this.translating=true;displayStyleValue=this.get("DisplayStyle").getSelectedItemValue();this._onSetDisplayStyle(displayStyleValue);this.translating=false;};function A(E){mstr.bones.editors.BoneTranslator.apply(this,[E]);}return A;})();mstr.bones.editors.DocumentTabBoneTranslator=(function(){mstr.$O.extendsClass(A,mstr.bones.editors.BoneTranslator);A.prototype.on_set_ExecutionFullScreenMode=function B(F){if(F.memo.value){this.set("ShowingBarsTemporarily",true);}};A.prototype.on_set_DefaultViewMode=function E(N){var G=this.get("DefaultViewMode");var L=mstr.utils.Hash.firstKey(N.memo.valueWas);var M=G.getItems()[L][G.get("valueForm")];switch(N.memo.src){case"hashremove_selectedIndices":this.cache={};this.cache[M]=true;break;case"hashadd_selectedIndices":this.cache[M]=false;this.changingRunMode=true;var I=this.get("AvailableViewModes");var F=this.get("AvailableExportModes");var H=I.getSelectedItems();var K=F.getSelectedItems();I.execEnableIndices(this.cache);F.execEnableIndices(this.cache);var J=function(O,S,Q){var P=O.getSelectedItems();outer:for(f1 in P){if(Q[P[f1].dssid]!=undefined){continue;}for(f2 in S){if(S[f2].dssid==P[f1].dssid){continue outer;}}var R=O.indexOfItem(P[f1]);O.execRemoveSelect(R);}};J(F,K,this.cache);J(I,H,this.cache);this.changingRunMode=false;if(!this._selectDefaultRunMode(I,M)){this._selectDefaultRunMode(F,M);}break;}};A.prototype._selectDefaultRunMode=function C(F,G){var H=F.indexOfValue(G);if(H==-1){return false;}var I=F.getSelectedIndices();if(!(H in I)){F.execAddSelect(H);}return true;};A.prototype.onModelPropertyChange=function D(F){if(this.changingRunMode){return ;}mstr.bones.editors.BoneTranslator.prototype.onModelPropertyChange.apply(this,[F]);};function A(F){mstr.bones.editors.BoneTranslator.apply(this,[F]);}return A;})();mstr.bones.editors.WidgetBoneTranslator=(function(){mstr.$O.extendsClass(W,mstr.bones.editors.BoneTranslator);W.prototype.execOpenWidgets=function M(k){var g=getObjSumLeft(k),l=getObjSumTop(k)+getObjHeight(k),h;microstrategy.openBlockLoaderEditor("addWidgetMenu","InsertMenuBlockLoader",null,{cssText:"position:absolute;top:"+l+"px;left:"+g+"px;z-index:"+mstr.views.FloatingMenuBook.prototype.getZIndex()+";",useFixedPosition:"false",contextMenuName:"insertWidgetEditor",viewer:"#widgetBoneTranslator"},this,null,h);};W.prototype.execOpenVisPropsEditor=function F(n){var k=microstrategy.getViewerBone();if(k){var m=k.gridWidgets.lst;var t=m[this.props.widgetId];if(t&&t.edt){var r=k.doc.selections.getSelectedGrid();if(r){var h=microstrategy.findBone(r);if(h){if(this.isMojoVis(t.edt)){if(this.props.hasChanges){var s=this.props.parent.props.parent.props.models[0];s.execPreviewChanges();}return h.docViewer.commands.exec("mojoVisPropsEditor",t.edt);}var q=microstrategy.VIS_EDITOR_SCOPE_RW_GRID;var o=[q,t.edt,""];o.push(this.props.WidgetProps||"");var g=this.deltaProps["default"];var l=(g&&g.SecondaryDataProviders)?g.SecondaryDataProviders:this.props.SecondaryDataProvidersValue;o.push(l||"");h.commands.exec("visPropsEditor",o);}}}}};W.prototype.commands={getTranslator:function(){if(!this.t){this.t=mstr.$obj("widgetBoneTranslator");}return this.t;},queryEnabled:function(){return true;},queryVisible:function(){return true;},queryState:function(){return true;},exec:function(g){var k=this.getTranslator();var h=g.split(";")[1];k.set("widgetId",h);}};W.prototype.on_set_widgetId=function I(g){var h=g.memo.value;this.set("ADisplayEnabled",h!="");this.updateWidgetInfo(h);};W.prototype.updateWidgetInfo=function a(k){var y=this.getWidgetObj(k);if(y){var l=microstrategy.getViewerBone();this.setupSecondaryDataProviders(y);this.set("widgetName",y.t);this.set("FlashDisplayEnabled",!!y.wgt);this.set("DHTMLDisplayEnabled",!!y.vis);this.set("iPhoneDisplayEnabled",!!y.iphVis);this.set("iPadDisplayEnabled",!!y.ipadVis);this.updateIPhoneFullscreen();this.set("AndroidDisplayEnabled",!!y.aVis);this.set("AndroidTabletDisplayEnabled",!!y.atVis);this.set("AndroidDisplayFullScreenEnabled",!!this.props.AndroidDisplayEnabled&&l.isMultiLayout);if(!this.translating){this.sureBoolSet("FlashDisplay",!!this.props.FlashDisplayEnabled);this.sureBoolSet("DHTMLDisplay",!!this.props.DHTMLDisplayEnabled&&y.vis.vm!=50);this.sureBoolSet("iPhoneDisplay",!!this.props.iPhoneDisplayEnabled);this.sureBoolSet("iPhoneDisplayFullScreen",!!this.props.iPhoneDisplayEnabled);this.sureBoolSet("iPadDisplay",!!this.props.iPadDisplayEnabled);this.sureBoolSet("AndroidDisplay",!!this.props.AndroidDisplayEnabled);this.sureBoolSet("AndroidTabletDisplay",!!this.props.AndroidTabletDisplayEnabled);this.sureBoolSet("AndroidDisplayFullScreen",!!this.props.AndroidDisplayEnabled);this.set("WidgetProps","");}else{var x=l.commands.queryState("setWidget");if(x&&x!="None"){var l=microstrategy.getViewerBone(),o=!!l&&l.gridWidgets&&l.gridWidgets.lst;for(var n in o){var u=o[n];if(u.wgt&&(u.wgt.rsl==x||u.wgt.cn==x)){this.set("FlashDisplay",k==n);break;}}}var t=l.doc.selections.getSelectedGrid();if(t){var h=microstrategy.findBone(t);if(h){this.set("DHTMLDisplay",y.vis&&y.vis.s==h.selectedVisualization&&h.isVisualization);this.set("iPadDisplay",y.ipadVis&&y.ipadVis.s==h.iPadVis);}}var m=y.iphVis&&y.iphVis.s==l.iPhoneVis;var g=y.iphVis&&y.iphVis.s==h.iPhoneVis;this.set("iPhoneDisplay",m||g);this.set("iPhoneDisplayFullScreen",m);var r=y.aVis&&y.aVis.s==l.aVis;var q=y.aVis&&y.aVis.s==h.aVis;this.set("AndroidDisplay",r||q);if(l.aVis){this._storeDeltaProp("AndroidDisplay",true);}var s=y.atVis&&y.atVis.s==h.atVis;this.set("AndroidTabletDisplay",s);}this.set("OpenVisPropsEditor",y.edt);}else{this.props.NonFlashRender.execSelectValue(0);this.set("widgetName",microstrategy.descriptors.getDescriptor(181));this.sureBoolSet("FlashDisplayEnabled",false);this.sureBoolSet("DHTMLDisplayEnabled",false);this.sureBoolSet("iPhoneDisplayEnabled",false);this.sureBoolSet("iPadDisplayEnabled",false);this.sureBoolSet("AndroidDisplayEnabled",false);this.sureBoolSet("AndroidTabletDisplayEnabled",false);this.sureBoolSet("FlashDisplay",false);this.sureBoolSet("DHTMLDisplay",false);this.sureBoolSet("iPadDisplay",false);this.sureBoolSet("AndroidDisplay",false);this.sureBoolSet("AndroidTabletDisplay",false);this.sureBoolSet("iPhoneDisplay",false);this.sureBoolSet("iPhoneDisplayFullScreen",false);this.sureBoolSet("AndroidDisplayFullScreen",false);}this.updateLabelsForAltDisplay();this.updateFlashDisplayLabel();this.updateIPhoneDisplayLabel();this.updateIPadDisplayLabel();this.updateAndroidDisplayLabel();this.updateAndroidTabletDisplayLabel();};W.prototype.sureBoolSet=function L(h,g){if(g==this.props[h]){this.props[h]=!g;}this.set(h,g);};W.prototype.setupSecondaryDataProviders=function J(g){if(!g){g=this.getWidgetObj(this.props.widgetId);}if(!g){this.set("showSecondaryDataProviders",false);return ;}if((!!this.props.FlashDisplay||!!this.props.DHTMLDisplay||!!this.props.iPadDisplay||!!this.props.AndroidDisplay||!!this.props.AndroidTabletDisplay||!!this.props.iPhoneDisplay)&&(g.smn>0||g.smx>0)){this.set("showSecondaryDataProviders",true);this.validateSecondaryDataProviders();}else{this.set("showSecondaryDataProviders",false);if(!this.translating){this.get("parent").set("enableOk",true);this.get("parent").set("enablePreview",true);}}};W.prototype.validateSecondaryDataProviders=function d(g){var h=this.get("SecondaryDataProviders"),l=h&&h.get("selected").get("items").length,k=this.getWidgetObj(this.get("widgetId"));if(!k){return ;}if(l<k.smn||l>k.smx){this.get("parent").set("enableOk",false);this.get("parent").set("enablePreview",false);}else{this.get("parent").set("enableOk",true);this.get("parent").set("enablePreview",true);}};W.prototype.on_set_SecondaryDataProviders=function b(g){this.validateSecondaryDataProviders();};W.prototype.on_set_FlashDisplay=function N(g){this.setupSecondaryDataProviders();this.updateFlashDisplayLabel();};W.prototype.updateFlashDisplayLabel=function R(){this.set("FlashDisplayLabel",!!this.props.FlashDisplay?this.props.widgetName:microstrategy.descriptors.getDescriptor(7759));};W.prototype.on_set_DHTMLDisplay=function c(g){this.setupSecondaryDataProviders();this.set("DHTMLDisplayLabel",g.memo.value?this.props.widgetName:this.props.PDFExcelDisplayLabel);};W.prototype.on_set_iPhoneDisplay=function Q(g){this.setupSecondaryDataProviders();this.updateIPhoneDisplayLabel();};W.prototype.on_set_iPhoneDisplayFullScreen=function E(g){this.sureBoolSet("iPhoneDisplay",!!this.props.iPhoneDisplay);};W.prototype.updateIPhoneDisplayLabel=function H(){this.set("iPhoneDisplayLabel",!!this.props.iPhoneDisplay?this.props.widgetName:microstrategy.descriptors.getDescriptor(7759));};W.prototype.updateIPhoneFullscreen=function U(){this.set("iPhoneDisplayFullScreenEnabled",!!this.props.iPhoneDisplay&&!!this.props.iPhoneDisplayEnabled&&microstrategy.getViewerBone().isMultiLayout);};W.prototype.on_set_iPadDisplay=function e(g){this.setupSecondaryDataProviders();this.updateIPadDisplayLabel();};W.prototype.updateIPadDisplayLabel=function C(){this.set("iPadDisplayLabel",!!this.props.iPadDisplay?this.props.widgetName:microstrategy.descriptors.getDescriptor(7759));};W.prototype.on_set_AndroidDisplay=function T(g){this.setupSecondaryDataProviders();this.updateAndroidDisplayLabel();};W.prototype.on_set_AndroidTabletDisplay=function K(g){this.setupSecondaryDataProviders();this.updateAndroidTabletDisplayLabel();};W.prototype.on_set_AndroidDisplayFullScreen=function Y(g){this.sureBoolSet("AndroidDisplay",!!this.props.AndroidDisplay);};W.prototype.on_set_mojoVisPropsChanged=function D(g){if(g.memo.value){this.setupSecondaryDataProviders();}};W.prototype.updateAndroidDisplayLabel=function A(){this.set("AndroidDisplayLabel",!!this.props.AndroidDisplay?this.props.widgetName:microstrategy.descriptors.getDescriptor(7759));};W.prototype.updateAndroidTabletDisplayLabel=function G(){this.set("AndroidTabletDisplayLabel",!!this.props.AndroidTabletDisplay?this.props.widgetName:microstrategy.descriptors.getDescriptor(7759));};W.prototype.on_set_NonFlashRender=function Z(g){this.updateLabelsForAltDisplay();};W.prototype.updateLabelsForAltDisplay=function P(){this.set("PDFExcelDisplayLabel",this.getAltDisplayLabel(this.props.NonFlashRender.props.selectedIndicesList));this.set("DHTMLDisplayLabel",!!this.props.DHTMLDisplay?this.props.widgetName:this.props.PDFExcelDisplayLabel);};W.prototype.getAltDisplayLabel=function S(g){var h=7759;if(g=="1"){h=7760;}else{if(g=="2"){h=7761;}}return microstrategy.descriptors.getDescriptor(h);};W.prototype.getWidgetObj=function V(k){var h=microstrategy.getViewerBone(),g=!!h&&h.gridWidgets&&h.gridWidgets.lst;return !!g&&g[k];};W.prototype.isMojoVis=function B(g){return["GraphMatrixVisualizationStyle","VIHeatMapVisualizationStyle","NetworkVisualizationStyle"].indexOf(g)>-1;};W.prototype.onModelPropertyChange=function X(g){mstr.bones.editors.BoneTranslator.prototype.onModelPropertyChange.apply(this,[g]);this.validateSecondaryDataProviders(g);};W.prototype.translateBone=function O(){this.props.widgetId="-1";mstr.bones.editors.BoneTranslator.prototype.translateBone.apply(this);};function W(g){mstr.bones.editors.BoneTranslator.apply(this,[g]);}return W;})();mstr.bones.editors.OnlineBoneTranslator=(function(){mstr.$O.extendsClass(D,mstr.bones.editors.BoneTranslator);D.prototype.init=function C(){mstr.bones.editors.BoneTranslator.prototype.init.apply(this);if(!this.get("boneModel")){return ;}var G=this.props.parent;if(G){var H=mstr.$obj(G.props.boneId);if(H&&H.observer){H.observer.register(this.get("id"));}}};D.prototype.onselectionchange=function(){this.translateBone();};D.prototype.translateBone=function E(){var H=this.get("boneModel");var I=this.props.enabledField;if(I!=null&&I.length>0){var G=H.commands.queryEnabled(I);if(G!=this.props[I]){this.set(I,G);}if(!this.props[I]){return ;}}mstr.bones.editors.BoneTranslator.prototype.translateBone.apply(this);};D.prototype.on_set_fontTabEnabled=function B(H){var G=this.props.fields;var K=G&&G.length>0?G.split("|"):[];var J;for(var I=0;I<K.length;I++){J=K[I];if(!J||!J.length>0){continue;}this.props[J]&&this.props[J].set&&this.props[J].set(H.memo.name,H.memo.value);}};D.prototype._storeDeltaProp=function A(H,G){this.exec(H,G);};D.prototype.exec=function F(K,G){var I=this.props.parent;if(I){var J=mstr.$obj(I.props.boneId);if(J){var H=[{obj:null,cmdId:K,value:G,memo:{},performFormatChange:true,submitUpdateManager:false}];if(!(J.commands.exec(I.props.boneCmdId,H))){return false;}}}};function D(G){mstr.bones.editors.BoneTranslator.apply(this,[G]);}return D;})();mstr.bones.editors.TOCPageBoneTranslator=(function(){mstr.$O.extendsClass(A,mstr.bones.editors.BoneTranslator);A.prototype._resolveTOCTitleSet=function C(E){if(E&&E.props&&E.props.selectedCount&&E.props.selectedCount==1&&E.props.selectedIndicesList){if(E.props.selectedIndicesList=="0"||E.props.selectedIndicesList==""){this.set("TOCBorderStyleEnable",false);}else{this.set("TOCBorderStyleEnable",true);}}};A.prototype.onModelPropertyChange=function B(E){mstr.bones.editors.BoneTranslator.prototype.onModelPropertyChange.apply(this,[E]);if(E.src==this.get("TOCBorderStyle")){this._resolveTOCTitleSet(E.src);}};A.prototype.set=function D(H,F){mstr.bones.editors.BoneTranslator.prototype.set.apply(this,[H,F]);if(H=="EnableToc"||H=="TOCTitleEnableInherit"){var E=this.get("EnableToc");var G=this.get("TOCTitleEnableInherit");if(E&&!G){this.set("TOCTitleSetEnable",true);}else{this.set("TOCTitleSetEnable",false);}}if(H=="EnableToc"){this._resolveTOCTitleSet(this.get("TOCBorderStyle"));}};function A(E){mstr.bones.editors.BoneTranslator.apply(this,[E]);}return A;})();mstr.bones.editors.SelectorPageBoneTranslator=(function(){mstr.$O.extendsClass(B,mstr.bones.editors.BoneTranslator);B.prototype.init=function K(){mstr.bones.editors.BoneTranslator.prototype.init.apply(this);this.attachEventListener(this,"openPopup","_handleOpenPopup");};B.prototype.reinitializeModel=function S(){mstr.bones.editors.BoneTranslator.prototype.reinitializeModel.apply(this);if(this.get(this.props.visibleField)){this._resolveUCLogic();}this._resolveStateEnabled();var AC=null;var AB=null;var AD=this.translating;this.translating=true;this._resolveDelimiterSelected();this._resolveAttrFormSelected();this._resolveAttrFormEnabled();this.translating=AD;};B.prototype._resolveDelimiterSelected=function z(){if(!this.get("EditSelectorSource")){return ;}var AC=this.get("showFormDelimiters");if(this.get("EditSelectorSource").getSelectedIndex()==0){AC.execSingleSelect(0);}else{var AB=this.get("EditFormDelimiter");if(AB==" "){AB="SPACE";}AC.execSelectValue(AB)||AC.execSingleSelect(4);}};B.prototype._resolveAttrFormSelected=function R(){if(!this.get("EditSelectorSource")){return ;}var AC=this.get("displayForms");if(this.get("EditSelectorSource").getSelectedIndex()==0){this.updateDisplayFormList(null);AC.execSingleSelect(0);this.attrFormSelectedIndex=0;this.attrFormSelectedItems=null;}else{var AD=this.get("EditDisplayForm");if(AD==mstr.Enum.AttrFormSelector.CUSTOM){var AB=this.get("selectedAttrForms");this.updateDisplayFormList(AB);this.checkAvailabilityAndSelect(AB);this.attrFormSelectedIndex=1;this.attrFormSelectedItems=AB;}else{this.updateDisplayFormList(null);AC.execSingleSelect(0);this.attrFormSelectedIndex=0;this.attrFormSelectedItems=null;}}};B.prototype._resolveAttrFormEnabled=function e(){if(!this.get("EditSelectorSource")){return ;}this.set("displayFormsEnable",true);var AB=this.get("EditSelectorSource").getSelectedIndex();if(AB<0){return ;}if(AB==0){this.set("displayFormsEnable",false);}else{var AE=this.getBone().commands.queryState("documentAttributesType")[AB];if(!AE){return ;}var AD=AE.type.split("|")[0];var AC=AE.type.split("|")[1];if(AD&&(AD==microstrategy.DSSTYPE_CONSOLIDATION||(AD==microstrategy.DSSTYPE_FILTER&&AC==microstrategy.DSSTYPE_CUSTOM_GROUP))){this.set("displayFormsEnable",false);}else{this.set("displayFormsEnable",true);}}};B.prototype._initializeDynamicModel=function l(AB,AC,AF){if(AB=="selectedAttrForms"){this._setDynamicModelValues(AB,AC,AF);this.set("afCartModel",AC);var AE=AC.get("selected");AE.attachEventListener(this,"listadd_items","onOkEnabledChange");AE.attachEventListener(this,"listremove_items","onOkEnabledChange");this.set("okBtnEnable",!!(AC&&AC.props&&AC.props.selected&&AC.props.selected.getItems().length>0));}else{if(AB=="sortAttrForm"){this._setDynamicModelValues(AB,AC,AF);this.set("afListModel",AC);AC.attachEventListener(this,"hashadd_selectedIndices","onModelPropertyChange");this._resolveSortType();}else{mstr.bones.editors.BoneTranslator.prototype._initializeDynamicModel.apply(this,[AB,AC,AF]);if(AB=="EditSelectorTargets"){var AD=this.translating;this.translating=true;this._resolveUCLogic();this.translating=AD;}if(AB=="selectorCurrentState"){var AD=this.translating;this.translating=true;this._resolveCountEnabled();this._resolveStateEnabled();this._resolveAllEnabled();this.translating=AD;}if(AB=="EditSelectorSource"){var AD=this.translating;this.translating=true;this._resolveDelimiterSelected();this._resolveAttrFormSelected();this._resolveAttrFormEnabled();this.translating=AD;}}}};B.prototype.checkAvailabilityAndSelect=function o(AG){if(this.availAttrForms==null){this.availAttrForms={};}var AC=this.get("EditSelectorSource")&&this.get("EditSelectorSource").getSelectedItemValue();if(AC){var AE=AC.split("|")[0];if(this.availAttrForms[AE]==null){var AD=this;var AB={success:function(AM){var AH=[];var AL={};for(var AK in AM.objects){var AO=AM.objects[AK];var AI=AO.did+"|"+AO.t+"|"+AO.n;AH.push({dssid:AI,n:AO.n});AL[AI]=true;}AD.availAttrForms[AE]=AH;var AN=[];for(var AK in AG){if(AL[AG[AK].dssid]){AN.push(AG[AK]);}}var AJ=AD.translating;AD.translating=true;AD.updateDisplayFormList(AN);AD.translating=AJ;},failure:function(AH){AD.updateDisplayFormList([]);}},AF={taskId:"getWSAttributeForms",attributeID:AE,objectType:55,msgID:this.getBone().messageID};mstr.$XHR.request(mstrConfig.taskURL,AF,AB);}}};B.prototype._getAvailableSortForm=function w(AF,AD){if(!AF||!AD){return undefined;}var AC=AF.split("|")[0],AB=AD.length,AG;for(var AE=0;AE<AB;AE++){AG=AD[AE].dssid;if(AC==AG.split("|")[0]){return AG;}}return undefined;};B.prototype._setDynamicModelValues=function I(AB,AC,AF){if(AF=="availAttrFormsList"||AF=="availAttrFormsCart"){if(this.availAttrForms==null){this.availAttrForms={};}var AD=this.get("EditSelectorSource")&&this.get("EditSelectorSource").getSelectedItemValue();if(AD){var AE=AD.split("|")[0];if(this.availAttrForms[AE]==null){return ;}else{if(AF=="availAttrFormsList"){this._setDynamicListModelValues(AC,this.availAttrForms[AE],AB);}else{this._setDynamicCartModelValues(AC,this.availAttrForms[AE],AB);}}}}else{mstr.bones.editors.BoneTranslator.prototype._setDynamicModelValues.apply(this,[AB,AC,AF]);}};B.prototype._setDynamicListModelValues=function Z(AD,AH,AF){if(AF=="sortAttrForm"){var AE=microstrategy.descriptors.getDescriptor("959"),AC=this.get(AF)||this.getBone().commands.queryState(AF),AK=AC.dssid,AH,AB=mstr.Enum.AttrFormSelector.DEFAULT_SORT;if(AK){AK=this._getAvailableSortForm(AK,AH)||AB;}else{AK=AB;}AH=AH&&[{dssid:AB,n:AE}].concat(AH);}else{var AK=this.getBone().commands.queryState(AF);}if(AF=="EditSelectorSource"){var AL=mstr.bones.editors.LayoutPropertiesBoneTranslator.prototype.isSearchBox(this);if(AL){AH=this.getBone().commands.queryState("documentPureAttributes");}}var AG=this.getBone().commands.queryState("isAQSelector");if(AG){AH=this.getBone().commands.queryState("documentAttributesWithDateForm");}AD.setItems(AH);var AJ=(mstr.$A.isArray(AK))?"execSelectValues":"execSelectValue";var AI=AD[AJ](AK);if(AF=="EditSelectorSource"&&!AI){AD.execSingleSelect(0);}};B.prototype._setDynamicCartModelValues=function Y(AD,AC,AB){var AG=AD.get("available"),AE=AD.get("selected"),AH;AG.setItems(AC);if(AB=="selectedAttrForms"){AH=this.get(AB)||this.getBone().commands.queryState(AB);}else{AH=this.getBone().commands.queryState(AB);if(AB=="EditSelectorCandidateAttributes"){var AF=AE.get("valueForm");mstr.$A.forEach(AH,function(AJ){var AI=mstr.$A.findByForm(AC,AJ[AF],AF);if(AI>-1){AJ.n=AC[AI].n;}});}}AE.setItems(AH);AD._updateAvailableFilteredItems();};B.prototype._resolveSelecotrSourceForUConDS=function x(AI){if(AI&&AI.selectedCount==1){if(isNaN(AI.selectedIndicesList)){return false;}var AF=parseInt(AI.selectedIndicesList);if(AI.items[AF]){var AD=AI.items[AF],AH=-1,AE=AD.sty;var AB=AD.dssid.split("|");if(AB.length>2&&!isNaN(AB[1])){AH=parseInt(AB[1]);}var AJ=this.get("dsAsTgtChkVisible"),AC=this.get("isDSAsTarget"),AG=this.get("EditSelectorType"),AK=AG.getSelectedItemValue();if(AH===parseInt(microstrategy.DSSTYPE_ATTRIBUTE)&&AE!==microstrategy.DSSSUB_TYPE_DERIVED_ATTRIBUTE&&AK!==mstrRWControlImpl.CTL_TYPE_ATTR_QUAL&&AK!==mstrRWControlImpl.CTL_TYPE_ATTR_LIST){if(!AJ){this.set("dsAsTgtChkVisible",true);}}else{if(AC){this.set("isDSAsTarget",false);}if(AJ){this.set("dsAsTgtChkVisible",false);}}}}};B.prototype._resolveEditSelectorTargetsCartList=function u(AB){var AE=this.get("EditSelectorSource");if(!AE||!AE.getSelectedItem()){return ;}var AD=AE.getSelectedItem().olap,AC=AE&&AE.getSelectedItem(),AF=AC&&AC.de&&AC.sty!=12033;lastSelectedItem=AE.getItems()[this.lastSelectedSourceIdx],lastde=lastSelectedItem&&lastSelectedItem.de&&lastSelectedItem.sty!=12003,lastOlap=lastSelectedItem&&lastSelectedItem.olap;if(AD&&!lastOlap||AF&&!lastde){this._setDynamicModelValues("EditSelectorTargetsNoPlaceholder",this.get("EditSelectorTargets"),"availableTemplatesNoPlaceholder");}else{if(!AD&&lastOlap||!AF&&lastde){this._setDynamicModelValues("EditSelectorTargets",this.get("EditSelectorTargets"),"availableTemplates");}}};B.prototype._storeLastSelectedSourceIdx=function J(AB){if(AB&&AB.memo){this.lastSelectedSourceIdx=mstr.utils.Hash.firstKey(AB.memo.at);}};B.prototype.onModelPropertyChange=function C(AB){mstr.bones.editors.BoneTranslator.prototype.onModelPropertyChange.apply(this,[AB]);if(AB.src==this.get("EditSelectorType")){this._handleSelectorTypeChange();this.get("parent").notifyPropertyChange("EditSelectorType",AB);this._resolveUCLogic();this._resolveStateUCVisible();this._resolveCountEnabled();this._resolveStateEnabled();this._resolveAllEnabled();this._resolveGUIComponentsVisible();this._resolveCartListVisible();}else{if(AB.src==this.get("DataFilterMode")){this._resolveTotalAndAutoSynchEnabled();this._resolveCountEnabled();this._resolveStateUCVisible();this._resolveUpdateFilterTargetEnabled();}else{if(this.get("EditSelectorTargets")&&(AB.src==this.get("EditSelectorTargets").get("selected")||this.get("EditSelectorSource")==AB.src)){this._resolveUCLogic();if(this.get("EditSelectorSource")==AB.src){this._resolveAttrFormEnabled();this._resolveEditSelectorTargetsCartList(AB);this._storeLastSelectedSourceIdx(AB);}if(AB.name!="listremove_items"&&!this.translating){this._resolveDataFilterMode();}}else{if(this.get("EditSelectorTargets")&&(AB.src==this.get("EditSelectorTargets").get("selected")||this.get("EditSelectorSourceDDIC")==AB.src)){this._resolveUCLogic();if(AB.name!="listremove_items"&&!this.translating){this._resolveDataFilterMode();}}else{if(this.get("selectorCurrentState")==AB.src){this._resolveCountEnabled();}else{if(this.get("EditSelectorSelectionType")==AB.src){this._resolveAllEnabled();}else{if(this.get("showFormDelimiters")==AB.src&&AB.name=="hashadd_selectedIndices"){this._resolveDelimiter();}else{if(this.get("displayForms")==AB.src&&AB.name=="hashadd_selectedIndices"){this._resolveDisplayForm();}else{if(this.get("afListModel")==AB.src&&AB.name=="hashadd_selectedIndices"){this._resolveSortType();}}}}}}}}}if(this.get("EditSelectorSource")==AB.src&&AB.name=="hashadd_selectedIndices"){this._clearAttrFormSelector();this.get("parent").notifyPropertyChange("EditSelectorSource",AB);this._resolveSelecotrSourceForUConDS(AB.src.props);}};B.prototype.set=function P(AE,AC){mstr.bones.editors.BoneTranslator.prototype.set.apply(this,[AE,AC]);if(AE=="isDSAsTarget"){var AD=this.get("EditSelectorType");if(AC){this.set("DataFilterVisible",false);this.set("attrLCVisible",false);this.set("metricLCVisible",false);this.set("datasetLCVisible",true);this.set("attrReplaceLCVisible",false);this.set("submissionLCVisible",false);this.set("selectorAutoSyncVisible",false);this.set("showTotalVisible",false);this.set("countVisible",false);this.set("selectionTypeVisible",false);this._moveSelectedBack("EditSelectorTargets");}else{if(AD.getSelectedItemValue()==1){if(!this.getBone().commands.queryState("isMetricQualifier")){this.set("DataFilterVisible",true);}this.set("attrLCVisible",true);this.set("metricLCVisible",false);this.set("datasetLCVisible",false);this.set("attrReplaceLCVisible",false);this.set("submissionLCVisible",false);this.set("selectorAutoSyncVisible",true);var AB=this.getBone().commands.queryState("isDDIC");this.set("showTotalVisible",!AB);this.set("countVisible",!AB);this.set("selectionTypeVisible",!AB);this._moveSelectedBack("EditSelectorTargetsDataset");}}this._resolveStateUCVisible();}else{if(AE=="Autowire"){this.set("showAutoWireMessage",AC);}}};B.prototype._moveSelectedBack=function t(AC){var AB=this.get(AC);if(AB){AB.execRemoveAll();}};B.prototype._resolveStateUCVisible=function V(){var AC=this.get("EditSelectorType")&&this.get("EditSelectorType").getSelectedItemValue();var AD=this.get("DataFilterMode");var AE=AD&&AD.getSelectedItemValue();var AB=this.get("isDSAsTarget");if(AE==null||AE==undefined){AE=this.getBone().commands.queryState("DataFilterMode");}if(AE=="1"||(AC=="1"&&AB)){this.set("stateUCVisible",true);}else{this.set("stateUCVisible",false);}};B.prototype._resolveGUIComponentsVisible=function O(){var AC=this.get("EditSelectorType")&&this.get("EditSelectorType").getSelectedItemValue();this.set("DataFilterVisible",true);this.set("selectionTypeVisible",false);this.set("showAdvanced",true);if(AC==1){this.set("dsAsTgtChkVisible",true);var AB=this.get("isDSAsTarget");if(AB){this.set("attrLCVisible",false);this.set("metricLCVisible",false);this.set("datasetLCVisible",true);this.set("attrReplaceLCVisible",false);this.set("DataFilterVisible",false);this.set("submissionLCVisible",false);}else{this.set("attrLCVisible",true);this.set("metricLCVisible",false);this.set("datasetLCVisible",false);this.set("attrReplaceLCVisible",false);this.set("selectionTypeVisible",true);this.set("submissionLCVisible",false);}}else{if(AC==2){this.set("dsAsTgtChkVisible",false);this.set("isDSAsTarget",false);this.set("attrLCVisible",false);this.set("metricLCVisible",true);this.set("datasetLCVisible",false);this.set("attrReplaceLCVisible",false);this.set("submissionLCVisible",false);}else{if(AC==3){this.set("attrReplaceLCVisible",false);this.set("submissionLCVisible",false);}else{if(AC==4){this.set("attrLCVisible",false);this.set("metricLCVisible",false);this.set("datasetLCVisible",false);this.set("DataFilterVisible",false);this.set("attrReplaceLCVisible",false);this.set("submissionLCVisible",true);}else{if(AC==8){this.set("dsAsTgtChkVisible",false);this.set("isDSAsTarget",false);this.set("attrLCVisible",false);this.set("metricLCVisible",false);this.set("datasetLCVisible",false);this.set("attrReplaceLCVisible",true);this.set("DataFilterVisible",false);this.set("showAdvanced",false);this.set("submissionLCVisible",false);this.set("EditSelectorShowAll",false);this.set("EditSelectorMultiSelect",false);}}}}}this._resolveStateUCVisible();};B.prototype._clearAttrFormSelector=function E(){if(!this.translating){this._clearPopupDelta();this.get("displayForms").execSingleSelect(0);this.get("showFormDelimiters").execSingleSelect(0);if(this.get("stRadioList")){this.get("stRadioList").execClearSelect();}}};B.prototype._resolveSortType=function X(){if(this.translating){return ;}if(!this.get("stRadioList")){this.getSortTypeModel();}if(this.get("afListModel").getSelectedItemValue()==mstr.Enum.AttrFormSelector.DEFAULT_SORT){this.get("stRadioList").execClearSelect();this.set("SortTypeEnabled",false);}else{var AB=this.get("sortType");this.get("stRadioList").execSelectValue(AB);this.set("SortTypeEnabled",true);}};B.prototype._resolveDisplayForm=function m(){if(!this.translating){displayFormList=this.get("displayForms");if(!displayFormList){return ;}var AB=displayFormList.getSelectedItemValue();if(AB==mstr.Enum.AttrFormSelector.AUTOMATIC){if(displayFormList.props.items.length>2){this._removeCustom(displayFormList);}this.set("EditDisplayForm",AB);this.attrFormSelectedIndex=0;this.attrFormSelectedItems=null;}else{if(AB=="custom"){this.execTryOpenPopup("AttrFormsEditor","AttrFormsCartBlock","selectedAttrForms","availAttrFormsCart");this.set("EditDisplayForm",mstr.Enum.AttrFormSelector.CUSTOM);}}}};B.prototype._clearPopupDelta=function n(){this.set("selectedAttrForms",[]);this.set("sortAttrForm",mstr.Enum.AttrFormSelector.DEFAULT_SORT);};B.prototype.execTryOpenPopup=function G(AD,AF,AI,AB){if(this.availAttrForms==null){this.availAttrForms={};}var AK=this.get("EditSelectorSource")&&this.get("EditSelectorSource").getSelectedItemValue(),AC=this.get("EditSelectorSource")&&this.get("EditSelectorSource").getSelectedItem().n;if(AK){var AH=AK.split("|")[0],AL=arguments;AL.title=microstrategy.descriptors.getDescriptor("2890")+(AC?" - "+AC:"");if(this.availAttrForms[AH]==null){var AJ=this;var AE={success:function(AO){var AM=[];for(var AN in AO.objects){var AP=AO.objects[AN];AM.push({dssid:AP.did+"|"+AP.t+"|"+AP.n,n:AP.n});}AJ.availAttrForms[AH]=AM;AJ.raiseEvent("openPopup",{args:AL});},failure:function(AM){showMessage({contents:AM.getResponseHeader("X-MSTR-TaskFailureMsg"),elements:microstrategy.OK_BUTTON,type:mstrMsgBoxImpl.MSG_WARNING});}},AG={taskId:"getWSAttributeForms",attributeID:AH,objectType:55,msgID:this.getBone().messageID};mstr.$XHR.request(mstrConfig.taskURL,AG,AE);}else{this.raiseEvent("openPopup",{args:AL});}}};B.prototype._handleOpenPopup=function a(AB){args=AB&&AB.memo&&AB.memo.args;editorId=args[0],editorStyle=args[1],propertyName=args[2],source=args[3];microstrategy.openBlockLoaderEditor(editorId,editorStyle,{},{title:(args&&args.title)||""},this,null,null);if(propertyName=="selectedAttrForms"&&this.get("afCartModel")){this._setDynamicModelValues(propertyName,this.get("afCartModel"),source);}else{if(propertyName=="sortAttrForm"&&this.get("afListModel")){this._setDynamicModelValues(propertyName,this.get("afListModel"),source);mstr.$obj("tt").render();}}};B.prototype.onOkEnabledChange=function F(AB){model=AB&&AB.src;this.set("okBtnEnable",!!(model&&model.getItems().length>0));};B.prototype.execSelectAttrForms=function h(AD){if(AD&&AD.get("selected")){var AC=AD.get("selected"),AB=AC.getItems();if(this.translating){return ;}this.updateDisplayFormList(AB);AB=AB&&[].concat(AB);this.set("selectedAttrForms",AB);this.attrFormSelectedIndex=1;this.attrFormSelectedItems=AB;}};B.prototype.updateDisplayFormList=function Q(AC){displayFormList=this.get("displayForms");if(displayFormList.get("items").length>2){this._removeCustom(displayFormList);}if(!AC||AC.length==0){displayFormList.execSingleSelect(0);return ;}this.set("selectedAttrForms",AC);itemValue=AC[0].n;for(i=1;i<AC.length;i++){itemValue+=","+AC[i].n;}var AB=mstr.Enum.AttrFormSelector.CUSTOM;displayFormList.insertItemsAt([{dssid:AB,n:itemValue}],2);displayFormList.execSingleSelect(2);};B.prototype._removeCustom=function T(AB){this.set("selectedAttrForms",[]);AB.removeItemsAt([2]);var AC=mstr.$obj("formLPD");if(AC&&AC.props.currentPopUp){AC.props.currentPopUp.props.scrollArea.children[0].style.width="200px";}};B.prototype.execCancelSelectAttrForms=function s(){if(this.attrFormSelectedIndex==0){this.get("displayForms").execSingleSelect(0);return ;}else{if(this.attrFormSelectedIndex==1&&this.attrFormSelectedItems){this.updateDisplayFormList(this.attrFormSelectedItems);return ;}}this.get("displayForms").execSingleSelect(0);};B.prototype.execSelectSortAttrForm=function q(){if(this.translating){return ;}var AC=this.get("afListModel").getSelectedItem();var AB=mstr.$H.clone(AC);AB.attr=this.get("EditSelectorSource")&&this.get("EditSelectorSource").getSelectedItemValue();this.set("sortAttrForm",AB);this.set("sortType","-1");this.set("sortType",this.get("stRadioList").getSelectedItemValue());};B.prototype._resolveDelimiter=function d(){var AC=this.get("showFormDelimiters");var AD=AC.getSelectedItemValue()||"";if(AD=="OTHER"){var AB=this.get("EditFormDelimiter");if(AB==":"||AB==";"||AB==","||AB==" "){AB=":";}this.set("EditFormDelimiter",AB);}else{if(AD=="SPACE"){AD=" ";}this.set("EditFormDelimiter",AD);}};B.prototype.getSortTypeModel=function c(){var AB=this._createNewModel({scriptClass:"ListModel",parent:this,valueForm:"dssid"});var AC=microstrategy.descriptors.getDescriptor("1885"),AD=microstrategy.descriptors.getDescriptor("1886");AB.setItems([{dssid:"1",n:AC},{dssid:"0",n:AD}]);this.set("stRadioList",AB);return AB;};B.prototype._moveSelectedBack=function t(AC){var AB=this.get(AC);if(AB){AB.execRemoveAll();}};B.prototype._resolveCartListVisible=function y(){var AC=this.get("EditSelectorType")&&this.get("EditSelectorType").getSelectedItemValue();this.set("DataFilterVisible",true);this.set("showAdvanced",true);if(AC==1){var AB=this.get("isDSAsTarget");if(AB){this.set("attrLCVisible",false);this.set("metricLCVisible",false);this.set("datasetLCVisible",true);this.set("attrReplaceLCVisible",false);this.set("DataFilterVisible",false);this.set("submissionLCVisible",false);}else{this.set("attrLCVisible",true);this.set("metricLCVisible",false);this.set("datasetLCVisible",false);this.set("attrReplaceLCVisible",false);this.set("submissionLCVisible",false);}}else{if(AC==2){this.set("attrLCVisible",false);this.set("metricLCVisible",true);this.set("datasetLCVisible",false);this.set("attrReplaceLCVisible",false);this.set("submissionLCVisible",false);}else{if(AC==3){this.set("attrReplaceLCVisible",false);this.set("submissionLCVisible",false);}else{if(AC==4){this.set("attrLCVisible",false);this.set("metricLCVisible",false);this.set("datasetLCVisible",false);this.set("DataFilterVisible",false);this.set("attrReplaceLCVisible",false);this.set("submissionLCVisible",true);}else{if(AC==8){this.set("attrLCVisible",false);this.set("metricLCVisible",false);this.set("datasetLCVisible",false);this.set("attrReplaceLCVisible",true);this.set("DataFilterVisible",false);this.set("showAdvanced",false);this.set("submissionLCVisible",false);this.set("EditSelectorShowAll",false);this.set("EditSelectorMultiSelect",false);}}}}}};B.prototype._resolveCountEnabled=function g(){var AC=this.get("EditSelectorType").getSelectedItemValue(),AE=this.get("DataFilterMode"),AB=AE&&AE.getSelectedItemValue(),AD=this.get("selectorCurrentState"),AD=AD&&AD.getSelectedItemValue(),AF=(AD&&AD!="-1");this.set("countEnabled",AC=="1"&&AF);this.set("nonMixed",(AB!="-1"));};B.prototype._resolveStateEnabled=function k(){var AB=this.get("EditSelectorType").getSelectedItemValue();this.set("stateEnabled",AB=="1");};B.prototype._resolveAllEnabled=function H(){this._handleSelectorTypeChange();var AC=this.get("EditSelectorType"),AB=AC.getSelectedItemValue(),AD=AB!=="3";if(AD){AC=this.get("EditSelectorSelectionType");AB=AC.getSelectedItemValue();AD=AB!=="0";}if(!AD){this.set("EditSelectorShowAll",false);}this.set("OptionAllEnabled",AD);};B.prototype._handleSelectorTypeChange=function W(){if(this.translating){return ;}var AC=this.get("EditSelectorType"),AB=AC.getSelectedItemValue();switch(AB){case"3":this.set("EditSelectorShowAll",false);case"2":this.set("EditSelectorShowTotal",false);break;}this._clearAttrFormSelector();};B.prototype._resolveUCLogic=function M(){this._resolveDataFilterModeEnabled();this._resolveTotalAndAutoSynchEnabled();this._resolveUpdateFilterTargetEnabled();};B.prototype._resolveDataFilterModeEnabled=function AA(){var AD=this.get("EditSelectorType");var AI=this.props["EditSelectorSource"+(this.get("isMetricQualifier")?"Metrics":this.get("isDDIC")?"DDIC":"")];if(!AI){return ;}var AH=AI&&AI.getSelectedItem()&&AI.getSelectedItem().olap,AC=AI&&AI.getSelectedItem()&&AI.getSelectedItem().sty;AI=AI&&AI.getSelectedItemValue();AI=AI&&AI.split("|");AI=AI&&AI.length>2&&(AI[1]==microstrategy.DSSTYPE_ATTRIBUTE||(AI[1]==microstrategy.DSSTYPE_CONSOLIDATION&&AC=="12033"));var AB=this.get("EditSelectorTargets").get("selected").props.items;var AF=false;for(var AE=0;AB&&AE<AB.length;AE++){var AG=AB[AE];if(AG.dssid.indexOf("_")>-1){AF=true;break;}}this.set("DataFilterModeEnabled",(AB&&AB.length>0)&&(AD.getSelectedItemValue()==1)&&!!AI&&!AH&&!AF);};B.prototype._resolveDataFilterMode=function L(){var AG=this.get("EditSelectorSource"),AC=AG&&AG.getSelectedItem(),AF=AG&&AG.getSelectedItemValue(),AI=AF&&AF.split("|"),AD=AC&&AC.sty===257,AE=AI&&AI.length>2&&AI[1]==microstrategy.DSSTYPE_CONSOLIDATION&&AC.sty===12032;var AJ=this.get("DataFilterMode"),AB=AJ.getItems(),AH=AJ.get("valueForm");AJ.setItems(AB.map(function(AK){if(AK[AH]==="-1"){if(AD||AE){AK.cssClass="Disabled";}else{delete AK.cssClass;}}return AK;}));this.get("DataFilterMode").execSelectValue((AD||AE)?"-1":"1");};B.prototype._resolveTotalAndAutoSynchEnabled=function N(){var AE=this.get("DataFilterMode");var AB=AE&&AE.getSelectedItemValue();var AF=this.get("DataFilterModeEnabled");var AD=this.get("EditSelectorType")&&this.get("EditSelectorType").getSelectedItemValue();var AC=mstr.bones.editors.LayoutPropertiesBoneTranslator.prototype.isSearchBox(this);this.set("showTotalEnabled",(AB=="0"||!AF)&&AD==1&&!AC);this.set("selectorAutoSyncEnabled",AB=="0"||!AF);if(!((AB=="0"||!AF)&&AD==1)){this.set("EditSelectorShowTotal",false);}if(AB!="0"&&AF){this.set("EditSelectorAutoSync",false);}};B.prototype._resolveUpdateFilterTargetEnabled=function b(){var AD=this.get("DataFilterMode");var AB=AD&&AD.getSelectedItemValue();var AE=this.get("DataFilterModeEnabled");var AC=this.get("EditSelectorType")&&this.get("EditSelectorType").getSelectedItemValue();this.set("updateFilterTargetEnabled",(AB!="0"&&AE)&&AC==1);};B.prototype.execSelectObject=function r(AB){this.set("runReportDocName",AB[0].n);this.set("runReportDocId",AB[0].dssid);this.set("runObjectType",AB[0].tp);};B.prototype.refreshForSearchBox=function A(AB,AJ){AB.set("showTotalEnabled",!AJ);var AG=AB.get("EditSelectorSource"),AC=AG&&AG.getSelectedItemValue();if(AG){var AH=AB.getBone().commands.queryState(AJ?"documentPureAttributes":"documentAttributes"),AF=AG.getItems()||[];if(AF.length!=AH.length){AG.setItems(AH);var AI=AG.execSelectValue(AC);if(!AI){AG.execSingleSelect(0);}}}if(AJ){AB.get("EditSelectorType").set("selectedIndicesList",0);if(!AG){var AE=AB.getBone().commands.queryState("EditSelectorSource")||"",AD=AE.split("|")[1];if(AD&&AD!=microstrategy.DSSTYPE_ATTRIBUTE){AB._storeDeltaProp("EditSelectorSource","");}}}};B.prototype.on_set_ext_prop_UseAsInformationWindow=function U(AB){if(this.get("showTableDisplayMode")){var AC=microstrategy.descriptors;this.set("TableCancelType",AB.memo.value?AC.getDescriptor("11174"):AC.getDescriptor("11175"));this.set("TableCancelText",AB.memo.value?AC.getDescriptor("221"):AC.getDescriptor("2827"));}};B.prototype.translateBone=function D(){this.translating=true;var AC=this.props.EditSelectorType,AD=AC&&AC.getItems().concat(),AF=(AD&&mstr.$A.findByForm(AD,3,"dssid",false))||-1,AE=this.getBone().commands.queryState("isInFilterPanel"),AB=!!AC.iifp;isAQ=microstrategy.getViewerBone()&&microstrategy.getViewerBone().commands.queryState("EditSelectorStyle")=="11";mstr.$A.forEach(AD,function(AH){var AG=AH.dssid;if(AG!=4){if(isAQ){AH.cssText=(AG==7)?"":"display: none;";}else{AH.cssText=(AG==7)?"display: none;":"";}}});if(AE!=AB){AD[AF].cssText=AE?"display: none;":"";AC.iifp=AE;}AC.setItems(AD);this.translating=false;mstr.bones.editors.BoneTranslator.prototype.translateBone.apply(this);};function B(AB){mstr.bones.editors.BoneTranslator.apply(this,[AB]);}return B;})();mstr.bones.editors.GeneralTabBoneTranslator=(function(){mstr.$O.extendsClass(K,mstr.bones.editors.BoneTranslator);K.prototype.init=function H(){mstr.bones.editors.BoneTranslator.prototype.init.apply(this);this.attachEventListener(this,"set_Visible","_handleVisiblilityChange");};K.prototype._handleVisiblilityChange=function B(P){if(this.translating){return ;}if(!P.memo.value){this.set("VisibleHTML",false);}};K.prototype.on_set_IsPortal=function J(P){if(this.translating){return ;}this.get("parent").notifyPropertyChange("IsPortal",P);this.updatePanelCustomTitle();};K.prototype.on_set_TitleBarDisplay=function D(P){if(this.translating){return ;}this.updatePanelCustomTitle();};K.prototype.updateShowTranslucent=function L(R,Q){var P={};P.UseAsInformationWindow=R;P.InfoWindowMode=Q;this.get("parent").notifyPropertyChange("showTranslucent",P);};K.prototype.updateInitialSlidingInWidthAndHeightEnabled=function C(T){var S=T.usiw!==undefined?T.usiw:this.get("UseAsInformationWindow"),Q=T.dips!==undefined?T.dips:this.get("DisplayInPartialScreen"),R=T.iwm!==undefined?T.iwm:this.get("InfoWindowMode").getSelectedItemValue(),P=T.iwp!==undefined?T.iwp:this.get("InfoWindowPosition").getSelectedItemValue();this.set("InitialSlidingInHeightEnabled",S&&Q&&R==="4"&&(P==="1"||P==="2"));this.set("InitialSlidingInWidthEnabled",S&&Q&&R==="4"&&(P==="3"||P==="4"));};K.prototype.on_set_InfoWindowMode=function O(P){if(this.translating){return ;}this.updateShowTranslucent(this.get("UseAsInformationWindow"),P.memo.value);this.updateInfoWinPosition();this.updateInitialSlidingInWidthAndHeightEnabled({iwm:P.memo.value});};K.prototype.on_set_UseAsInformationWindow=function N(P){if(this.translating){return ;}this.updateShowTranslucent(P.memo.value,this.get("InfoWindowMode").getSelectedItemValue());if(this.get("showTableDisplayMode")){!P.memo.value&&this.set("IsPortal",P.memo.value);this.get("parent").notifyPropertyChange("UseAsInformationWindow",P);}if(P.memo.value){this.set("ShowAsCollapsiblePanel",false);}this.updateInfoWinPosition();this.updateInitialSlidingInWidthAndHeightEnabled({usiw:P.memo.value});};K.prototype.on_set_DisplayInPartialScreen=function A(P){this.updateInitialSlidingInWidthAndHeightEnabled({dips:P.memo.value});};K.prototype.on_set_InfoWindowPosition=function M(P){this.updateInitialSlidingInWidthAndHeightEnabled({iwp:P.memo.value});};K.prototype.updateInfoWinPosition=function F(){var P=this.get("InfoWindowMode").getSelectedItemValue(),Q=this.get("UseAsInformationWindow");this.set("InfoWindowPositionEnabled",Q&&(P==4));};K.prototype.updatePanelCustomTitle=function E(){var P=this.get("TitleBarDisplay").getSelectedItemValue();this.set("panelCustomTitle",P&&P=="1"&&this.get("IsPortal"));};K.prototype.onModelPropertyChange=function I(P){mstr.bones.editors.BoneTranslator.prototype.onModelPropertyChange.apply(this,[P]);if(P.src==this.get("titleTriState")){if(this.translating){return ;}var Q=(this.get("titleTriState").getSelectedItemValue()=="1");this.set("ShowWidgetTitleBar",Q);this.set("IsPortal",Q);}};K.prototype.translateBone=function G(){mstr.bones.editors.BoneTranslator.prototype.translateBone.apply(this);this.translating=true;var P=!this.get("IsPortal")?"0":(this.get("ShowWidgetTitleBar")?"1":"-1");this.get("titleTriState").execSelectValue(P);this.translating=false;};function K(P){mstr.bones.editors.BoneTranslator.apply(this,[P]);}return K;})();mstr.bones.editors.ActionsBoneTranslator=(function(){mstr.$O.extendsClass(E,mstr.bones.editors.BoneTranslator);E.prototype.getDynamicListModel=function B(I,H){var G=mstr.bones.editors.BoneTranslator.prototype.getDynamicListModel.apply(this,arguments);if(H=="ControlGroupByList"){G.detachEventListener(this,"hashadd_selectedIndices");G.detachEventListener(this,"hashremove_selectedIndices");G.attachEventListener(this,"listadd_items","onControlGroupByChange");}return G;};E.prototype.onControlGroupByChange=function F(H){var K=H.src;var J="";var G=null;var I=[];J=K.getItems();var L=K.get("mappedPropertyName");this.raiseEvent("set_"+L,{name:L,src:H.name,value:J,valueWas:G});if(this.translating){return ;}this._storeDeltaProp(L,J);};E.prototype.on_set_ext_prop_XTabView=function D(G){var H=G.memo.value;var I=this.translating;this.translating=true;this.set("showGridIf",H==1||H==3);this.translating=I;};E.prototype.on_set_expandPanels=function A(H){var G=H.memo.value;var I=this.translating;this.translating=true;this.set("allowPanelsToSplitAcrossPages",G==0);this.set("panelOverflowSpacingEnabled",this.get("ClipOnExport")&&G!=0);this.translating=I;};E.prototype.on_set_ClipOnExport=function F(H){var J=this.translating;if(J){return ;}this.translating=true;var I=H.memo.value;var G=this.get("expandPanels");this.set("panelOverflowSpacingEnabled",I&&G.getSelectedIndex()!=0);this.translating=J;};E.prototype.joinTypeChange=function C(G,I){var H=this._getDeltaProp("joinTypes");if(!H){H={};}H[G]=I;this._storeDeltaProp("joinTypes",H);};function E(G){mstr.bones.editors.BoneTranslator.apply(this,[G]);}return E;})();mstr.models.TriStateListModel=(function(){mstr.$O.extendsClass(A,mstr.models.ListModel);A.prototype.execSingleSelectNextAndLoop=function B(){mstr.models.ListModel.prototype.execSingleSelectNextAndLoop.apply(this);var D=this.props.selectedIndicesList;if(isNaN(D)){return false;}var C=parseInt(D);var E=this.get("ExcludedItemsOnLoop");E=E&&E.split(",");if(E&&C in E){this.execSingleSelectNextAndLoop();}return true;};function A(C){mstr.models.ListModel.apply(this,[C]);}return A;})();mstr.models.IPhoneTimeSeriesEditorModel=(function(){mstr.$O.extendsClass(N,mstr.models.BaseModel);N.prototype.init=function J(){mstr.models.BaseModel.prototype.init.apply(this);this.set("granularity","");if(this.props.isReport){this.selectItemFromId(this.props.dataSets,"r");}this.aeh();this.changeSelectedNode();this.ROOT_NODE="rl";this.ITEM_NODE="it";this.TEMPLATE_NODE="nk";this.NAME_NODE="lbl";this.LEVEL_NODE="lvl";this.RANGE_NODE="rng";this.RANGE_ATT_NODE="ut";this.RANGE_SIZE_NODE="v";};N.prototype.aeh=function L(){this.props.nodes.attachEventListener(this,"hashadd_selectedIndices","changeSelectedNode");this.props.rangeList.attachEventListener(this,"hashadd_selectedIndices","changeRangeList");this.props.dataSets.attachEventListener(this,"hashadd_selectedIndices","changeDataSet");};N.prototype.changeSelectedNode=function C(S){var X=this.props.nodes,U=X.getSelectedItem();if(U){if(U.dssid=="-1"){if(!this.props.justRemoved){this.execAdd();}return ;}this.set("empty",false);this.set("downEnabled",!S.memo.at[mstr.$A.len(X.props.items)-2]);this.set("upEnabled",!X.props.selectedIndices[0]);var W=this.changingN;this.changingN=true;var T=mstr.$obj("selectedNameIphoneEditorField");if(T){T.textBoxInitialized=false;}this.set("selectedName",U.n);this.set("selectedRangeSize",U.rs);var V=this.selectItemFromId(this.props.dataSets,U.ds);this.selectItemFromId(this.props.rangeList,U.sr);if(!V){this.set("attEnabled",false);}this.changingN=W;}else{this.set("empty",true);}this.updatePreview();};N.prototype.updatePreview=function K(){var W=microstrategy.descriptors.getDescriptor("7678"),U=this.props.nodes.getSelectedItem(),V=this.props.dataSets.getSelectedItem(),S=this.props.rangeList.getSelectedItem(),T=this.props.granularity;v=V&&T&&S&&U;W=W.replace("######",V?V.n:"").replace("#####",T?T:"").replace("####",S?S.n:"").replace("###",U?U.rs:"").replace("##",U?U.n:"");this.props.preview.set("value",v?W:"");};N.prototype.selectItemFromId=function E(U,V){var S=U.getItems();for(var T in S){if(S[T][U.props.valueForm]==V){U.setSelectedItems([S[T]]);return true;}}U.execClearSelect();return false;};N.prototype.on_set_selectedRangeSize=function F(){this.props.nodes.getSelectedItem().rs=this.props.selectedRangeSize;this.updatePreview();};N.prototype.on_set_selectedName=function G(){if(this.changingN){return ;}var S=this.changingN;this.changingN=true;this.props.justRemoved=true;this.props.nodes.execRenameSelectedItem(this.props.selectedName);this.props.justRemoved=false;this.changingN=S;this.updatePreview();};N.prototype.changeRangeList=function B(){this.props.nodes.getSelectedItem().sr=this.props.rangeList.getSelectedItem()[this.props.rangeList.props.valueForm];this.updatePreview();};N.prototype.changeDataSet=function O(){this.set("attEnabled",true);this.props.rangeList.execClearSelect();this.props.rangeList.removeItems(this.props.rangeList.getItems());var T=this.props.dataSets.getSelectedItem();var U=this.props.__atts[T.dssid];this.set("granularity",U[U.length-1].n);this.props.rangeList.insertItemsAt(U);var S=this.props.nodes.getSelectedItem();S.ds=this.props.dataSets.getSelectedItem()[this.props.dataSets.props.valueForm];S.sl=U[U.length-1].dssid;if(!this.changingN){S.sr=null;}this.updatePreview();};N.prototype.execAdd=function Q(){this.set("empty",false);this.set("downEnabled",false);this.set("attEnabled",false);this.set("upEnabled",false);var T={dssid:Math.random(),n:microstrategy.descriptors.getDescriptor(945),sl:null,sr:null,rs:"1",ds:null},U=this.props.nodes,S=U.props.items.length;U.insertItemsAt([T],S-1);U.execSingleSelect(S-1);this.props.rangeList.execClearSelect();this.set("granularity","");if(this.props.isReport){this.selectItemFromId(this.props.dataSets,"r");}else{this.props.dataSets.execClearSelect();}};N.prototype.execRemove=function R(){this.props.justRemoved=true;};N.prototype.execPostRemove=function H(){var T=this.props.nodes,S=mstr.$A.len(T.props.items);this.props.justRemoved=false;this.set("empty",S==1);this.set("attEnabled",S>1);if(S==1){T.execClearSelect();}else{if(parseInt(T.props.selectedIndicesList)==(S-1)){T.execSingleSelect(S-2);}}};N.prototype.execCheckDown=function A(){var T=this.props.nodes,S=mstr.$A.len(T.props.items);this.set("downEnabled",!T.props.selectedIndices[S-2]);this.set("upEnabled",!T.props.selectedIndices[0]);};N.prototype.getXMLValue=function P(){var S=this.props.nodes.getItems();var U="<"+this.ROOT_NODE+">";for(var T in S){if(T==S.length-1){continue;}U+=this.appendItemXML(S[T]);}U+="</"+this.ROOT_NODE+">";return U;};N.prototype.appendItemXML=function M(T){var S="<"+this.ITEM_NODE+"><"+this.TEMPLATE_NODE+">"+T.ds+"</"+this.TEMPLATE_NODE+"><"+this.NAME_NODE+">"+T.n+"</"+this.NAME_NODE+"><"+this.LEVEL_NODE+">"+T.sl+"</"+this.LEVEL_NODE+"><"+this.RANGE_NODE+"><"+this.RANGE_SIZE_NODE+">"+T.rs+"</"+this.RANGE_SIZE_NODE+"><"+this.RANGE_ATT_NODE+">"+T.sr+"</"+this.RANGE_ATT_NODE+"></"+this.RANGE_NODE+"></"+this.ITEM_NODE+">";return S;};N.prototype.validate=function I(){var T=this.props.nodes.getItems(),U,V="";for(var S in T){if(S==T.length-1){continue;}U=T[S];if(!U.n||!U.sl||!U.sr||!U.ds||!/^\d+$/.test(U.rs)){V+=" "+U.n+",";}}if(V){V=V.substring(0,V.length-1);return microstrategy.descriptors.getDescriptor(7565)+" "+V;}return true;};N.prototype.checkValidationStatus=function D(){var V=this.props.nodes.props.items,U=microstrategy.bone("visPropsEditor_VisualizationPropertiesEditorStyle").elem,S=microstrategy.findChildWithAtt(U,"input","id","ok");for(var T in V){if(V[T].invalidRS){S.disabled=true;return ;}}S.disabled=false;};function N(S){mstr.models.BaseModel.apply(this,[S]);}return N;})();mstr.models.IphoneTSFieldValidator=(function(){mstr.$O.extendsClass(C,mstr.models.FieldValidator);C.prototype.validate=function A(D){this.props.theValue=D;var E=mstr.models.FieldValidator.prototype.validate.apply(this,[D]);};C.prototype.setValidationStatus=function B(H){var G=mstr.models.FieldValidator.prototype.setValidationStatus.apply(this,[H]);var D=this.props.parent;D=D&&D.props.model;var F=D&&D.props.nodes,E=this.props.theValue;F=F&&F.getSelectedItem();if(F){F.rs=E;F.invalidRS=!G;D.set("selectedRangeSize",E);D.checkValidationStatus();}return G;};function C(D){mstr.models.FieldValidator.apply(this,[D]);}return C;})();mstr.behaviors.ToolbarContextMenuOpener=(function(){var B={};B.openMenu=function C(E){var G=E.props.element,D=getObjSumLeft(G),H=getObjSumTop(G)+getObjHeight(G),F=E.getModel();microstrategy.openBlockLoaderEditor("addWidgetToolbarMenu","InsertMenuBlockLoader",null,{cssText:"position:absolute;top:"+H+"px;left:"+D+"px;z-index:"+mstr.views.FloatingMenuBook.prototype.getZIndex()+";",useFixedPosition:"false",contextMenuName:F.get("contextMenuName"),viewer:"#"+F.props.id},E,null,document.body);};B.changeIcon=function A(D,E,G){var F=E.props.cmdid.split(";");F=F.length>1?F[1]:F.join();G.className=D.props.cssBaseIcon+F;};return B;})();mstr.models.ToolbarContextMenuOpenerModel=(function(){mstr.$O.extendsClass(A,mstr.models.BaseModel);A.prototype.init=function B(){mstr.models.BaseModel.prototype.init.apply(this);this.commands.p=this;this.commands.h=this.props.toolbarHelper;};A.prototype.commands={queryEnabled:function(){return true;},queryVisible:function(){return true;},queryState:function(){return true;},exec:function(C){this.p.set("cmdid",C);this.h.execPressed();}};function A(C){mstr.models.BaseModel.apply(this,[C]);}return A;})();mstr.itemrenderers.IPhoneTimeSeriesItemRenderer=(function(){LV=mstr.$H.clone(mstr.itemrenderers.ListView);LV.renderListItem=function(A,C,F,D){var B=mstr.itemrenderers.FastListView.renderListItem(A,C,F,D);this._insertElementForIndex(A,F,D.at,B);if(D&&D.item&&D.item.dssid==-1){var E=B.style;E.fontStyle="italic";E.textDecoration="underline";E.cursor="pointer";B.className="";B.title="";}return B;};return LV;})();mstrLeftToolBarImpl.prototype=new mstrEditorImpl();mstrLeftToolBarImpl.prototype.onload=function(){try{this.initEditor();mstrBoneImpl.prototype.onload.call(this);var B=document.getElementById("btnDockLeft");if(B){B.onmousedown=new Function("e","microstrategy.bone('"+this.id+"').close(); return false;");}this.updateTooltip();return true;}catch(A){microstrategy.errors.log(A);return false;}};mstrLeftToolBarImpl.prototype.onpostload=function(){try{mstrBoneImpl.prototype.onpostload.call(this);this.resize();this.initResize();this.resizeLeftToolbar(this.ltW);}catch(A){microstrategy.errors.log(A);return false;}};mstrLeftToolBarImpl.prototype.resize=function(){var A=getObj(window.mstrInterfacePlugin?"mstrWeb_dockLeft":"mstrWeb_content");var B=microstrategy.contentHeight-(window.mstrInterfacePlugin?0:5);if(B>=0){if(this.elem&&this.elem.style){A.style.height=B+"px";this.elem.style.height=A.style.height;}}else{this.elem.style.height=0;A.style.height=0;}if(window.mstrInterfacePlugin){var C=microstrategy.findAncestorWithAtt(A,"id","td_mstrWeb_dockLeft");C.style.height=A.style.height;}};mstrLeftToolBarImpl.prototype.resizeLeftToolbar=function(B){var A=getObj("td_mstrWeb_dockLeft");if(A){A.style.width=B+"px";}};mstrLeftToolBarImpl.prototype.afterresize=function(){try{var B=getObjWidth(this.elem);this.resizeLeftToolbar(B);if(window.mstrUpdateManager){microstrategy.updateBrowserSetting("ltW",B);}microstrategy.eventManager.ondialogresize();this.resize();}catch(A){microstrategy.errors.log(A);return false;}};mstrLeftToolBarImpl.prototype.onwinresize=function(){try{this.resize();this.initResize();}catch(A){microstrategy.errors.log(A);return false;}};mstrLeftToolBarImpl.prototype.updateTooltip=function(){try{var A=getObj("tbTreeView");if(A){if(!this.elem){A.title=microstrategy.descriptors.getDescriptor("5695");}else{A.title=microstrategy.descriptors.getDescriptor("5696");}}}catch(B){microstrategy.errors.log(B);}};mstrLeftToolBarImpl.prototype.close=function(){try{removeObj(this.elem);var B=this.elem.parentNode;while(B!=null){if(B.nodeName=="DIV"&&B.className=="mstrDockLeft"){B.style.display="none";}if(B.nodeName=="TD"&&B.className=="tdDockLeft"){B.style.width="0px";B.style.display="none";break;}B=B.parentNode;}microstrategy.updateCookieSetting("lTbar","0");microstrategy.updateBrowserSetting("lTbar","0");microstrategy.unRegisterBone(this.id);var A=getObj("tbTreeView");if(A){A.className="mstrIcon-tb unselected";}this.updateTooltip();if(microstrategy.eventManager){microstrategy.eventManager.ondialogresize();}}catch(C){microstrategy.errors.log(C);return false;}};function mstrLeftToolBarImpl(A){this.inherits=mstrBoneImpl;this.inherits(A);delete this.inherits;return this;}mstrFormatImplScript=true;mstrFormatImpl.prototype=new mstrEditorImpl();mstrFormatImpl.prototype.childrenTabs=new Array();mstrFormatImpl.prototype.changesApplied=0;mstrFormatImpl.prototype.currentTab=1;mstrFormatImpl.prototype.actionId=microstrategy.OPEN_EDITOR_ACTION_EDIT;mstrFormatImpl.prototype.selectedTabOptions="";mstrFormatImpl.prototype.autoSubmitJS=null;mstrFormatImpl.prototype.sharedObj=null;mstrFormatImpl.prototype.useDynamicTitle=false;mstrFormatImpl.prototype.titleContainer=null;mstrFormatImpl.prototype.targetAxis=null;mstrFormatImpl.prototype.targetLevel=null;mstrFormatImpl.prototype.targetUnit=null;mstrFormatImpl.prototype.targetPosition=null;mstrFormatImpl.prototype.submitUponTargetLevelChange=true;mstrFormatImpl.prototype.axisOptionId=null;mstrFormatImpl.prototype.levelOptionId=null;mstrFormatImpl.prototype.targetOptions=null;mstrFormatImpl.prototype.levelOptions=null;mstrFormatImpl.prototype.commands=null;mstrFormatImpl.prototype.helpButton=null;mstrFormatImpl.prototype.defaultHelpURL=null;mstrFormatImpl.panelStackOptionsMapDescriptors=[["4579","3297"],["512"]];mstrFormatImpl.gridContainerOptionsMapDescriptors=[["4579","3297"],["512"]];mstrFormatImpl.panelStackOptionsMap=[[{name:"",value:0},{name:"",value:1}],[{name:"",value:2}]];mstrFormatImpl.gridContainerOptionsMap=[[{name:"",value:8},{name:"",value:9}],[{name:"",value:8}]];mstrFormatImpl.prototype.onload=function(){try{if(typeof microstrategy.log!="undefined"&&microstrategy.log.shouldLog(mstrLogImpl.ACTION_LEVEL|mstrLogImpl.METHOD_LEVEL)){microstrategy.log.start("mstrFormatImpl.onload",mstrLogImpl.LOAD_TABS);}mstrFormatImpl.initOptionsMap();this.initFormatManager();this.tabContainer=microstrategy.subObjectFind(this.body,["DIV"],microstrategy.SUBOBJTYPE_TAB_CONTAINER);this.commands=new mstrFormatImplCommandsImpl(this);}catch(A){microstrategy.errors.log(A);return false;}finally{if(typeof microstrategy.log!="undefined"&&microstrategy.log.shouldLog(mstrLogImpl.ACTION_LEVEL|mstrLogImpl.METHOD_LEVEL)){microstrategy.log.stop("mstrFormatImpl.onload",mstrLogImpl.LOAD_TABS);}}};mstrFormatImpl.initOptionsMap=function(){try{if(mstrFormatImpl.panelStackOptionsMap[0][0].name!=""){return ;}else{for(var B=0;B<mstrFormatImpl.panelStackOptionsMap.length;B++){for(var A=0;A<mstrFormatImpl.panelStackOptionsMap[B].length;A++){mstrFormatImpl.panelStackOptionsMap[B][A].name=microstrategy.descriptors.getDescriptor(mstrFormatImpl.panelStackOptionsMapDescriptors[B][A]);}}for(var B=0;B<mstrFormatImpl.gridContainerOptionsMap.length;B++){for(var A=0;A<mstrFormatImpl.gridContainerOptionsMap[B].length;A++){mstrFormatImpl.gridContainerOptionsMap[B][A].name=microstrategy.descriptors.getDescriptor(mstrFormatImpl.gridContainerOptionsMapDescriptors[B][A]);}}}}catch(C){microstrategy.errors.log(C);return false;}};mstrFormatImpl.prototype.onreload=function(){try{mstrEditorImpl.prototype.onreload.call(this);var F=microstrategy.findChildrenWithAtt(this.elem,"span","ty","tab");if(!F){return false;}for(var C=0;C<F.length;C++){if(F[C].getAttribute("curTab")==this.currentTab){var E;var B=F[C].getAttribute("tab");if(B){E=getElementById(B);}if(E){this.updateDynamicInfo(F[C]);this.showTabSection(E);if(!microstrategy.bone(B)){var A=E.getAttribute("scriptClass");if(A){loadInit(A+"Script",'microstrategy.registerBone("'+B+'", "(true)", null);');this.setTimeout('microstrategy.bone("'+B+'")','microstrategy.bone("'+this.id+'").loadChildrenTab("'+B+'")',500);}}}}}}catch(D){microstrategy.errors.log(D);return false;}};mstrFormatImpl.prototype.onpostload=function(){try{mstrEditorImpl.prototype.onpostload.call(this);this.initChildrenTabs();this.initSelections();this.restorePreviousSelections();}catch(A){microstrategy.errors.log(A);return false;}finally{if(typeof microstrategy.log!="undefined"&&microstrategy.log.shouldLog(mstrLogImpl.ACTION_LEVEL|mstrLogImpl.METHOD_LEVEL)){microstrategy.log.stop("mstrFormatImpl.onload",mstrLogImpl.LOAD_TABS);}}};mstrFormatImpl.prototype.onunload=function(C){try{mstrEditorImpl.prototype.onunload.call(this,C);this.unRegisterChildren();var B=this.getAppliesTo();if(B!=null&&B.observer){B.observer.unregister(this.id);}}catch(A){microstrategy.errors.log(A);}return true;};mstrFormatImpl.prototype.restorePreviousSelections=function(){try{if(this.selectedTabOptions!=null&&this.selectedTabOptions.length>0){this.selectedTabOptions=JSON.parse(this.selectedTabOptions);for(var D in this.selectedTabOptions){var B=microstrategy.bone(D);if(B!=null){var A=this.selectedTabOptions[D];B.restorePreviousSelections(A);}}this.selectedTabOptions=null;}}catch(C){microstrategy.errors.log(C);return false;}};mstrFormatImpl.prototype.initFormatManager=function(){try{this.initEditor();this.changesApplied=0;if(this.elem){var A=this.elem.getAttribute("at");if(A&&A.length>0){this.setAppliesTo(A);}}if(this.axisOptionId&&this.levelOptionId){this.targetOptions=microstrategy.findChildWithAtt(this.elem,"SELECT","id",this.axisOptionId);this.levelOptions=microstrategy.findChildWithAtt(this.elem,"SELECT","id",this.levelOptionId);}this.adjustTargetLevelOptions();this.initHelpButton();}catch(B){microstrategy.errors.log(B);return false;}};mstrFormatImpl.prototype.initHelpButton=function(){try{var B=microstrategy.findChildWithAtt(this.elem,"img",(bIsW3C)?"class":"className","mstrIcon-btn mstrIcon-btnHelp");if(B){this.help=B.parentNode;}}catch(A){microstrategy.errors.log(A);return false;}};mstrFormatImpl.prototype.isPanelStackSelected=function(){try{var A=this.getAppliesTo();return(A&&A.commands.queryEnabled("onepanelstack")==true);}catch(B){microstrategy.errors.log(B);return false;}};mstrFormatImpl.prototype.areAllSelectedPanelStacks=function(){try{var A=this.getAppliesTo();return(A&&A.commands.queryEnabled("allpanelstack")==true&&A.commands.queryEnabled("onepanelstack")==false);}catch(B){microstrategy.errors.log(B);return false;}};mstrFormatImpl.prototype.isGridSelected=function(){try{var A=this.getAppliesTo();return(A&&A.commands.queryEnabled("onegrid")==true);}catch(B){microstrategy.errors.log(B);return false;}};mstrFormatImpl.prototype.isGridContainerSelected=function(){try{var A=this.getAppliesTo();return(this.isGridSelected()&&this.targetAxis==0&&(this.targetLevel==8||this.targetLevel==9));}catch(B){microstrategy.errors.log(B);return false;}};mstrFormatImpl.prototype.adjustTargetLevelOptions=function(){try{var D;var J;var H;if(this.levelOptions){D=this.levelOptions.options;J=D.length;if(this.isGridContainerSelected()){if(D){H=D[this.levelOptions.selectedIndex].value;for(var G=0;G<J;G++){this.levelOptions.removeChild(D[0]);}}var C=microstrategy.findBone(this.getAppliesTo().commands.queryState("selectedGrid"));if(!C.showTitleBar()){this.targetLevel=8;B=1;this.levelOptions.disabled=true;}else{B=0;this.levelOptions.disabled=false;}for(var F=0;F<mstrFormatImpl.gridContainerOptionsMap[B].length;F++){var I=document.createElement("OPTION");this.levelOptions.options.add(I);I.text=mstrFormatImpl.gridContainerOptionsMap[B][F].name;I.value=mstrFormatImpl.gridContainerOptionsMap[B][F].value;I.selected=(F==0||I.value==H);}}if(this.isPanelStackSelected()){if(D){H=D[this.levelOptions.selectedIndex].value;for(var G=0;G<J;G++){this.levelOptions.removeChild(D[0]);}}var B=0;if(this.targetAxis==0){var A=microstrategy.findBone(this.getAppliesTo().commands.queryState("selectedPanelStack"));if(!A.isTitleVisible){this.targetLevel=0;B=1;this.levelOptions.disabled=true;}else{B=0;this.levelOptions.disabled=false;}}else{if(this.targetAxis==1){this.targetLevel=2;B=1;this.levelOptions.disabled=true;}}for(var F=0;F<mstrFormatImpl.panelStackOptionsMap[B].length;F++){var I=document.createElement("OPTION");this.levelOptions.options.add(I);I.text=mstrFormatImpl.panelStackOptionsMap[B][F].name;I.value=mstrFormatImpl.panelStackOptionsMap[B][F].value;I.selected=(F==0||I.value==H);}}}}catch(E){microstrategy.errors.log(E);return false;}};mstrFormatImpl.prototype.enableChildrenTabs=function(){try{var G=microstrategy.objectListFind(this.body,["span"],microstrategy.OBJTYPE_TAB);var B=this.getAppliesTo();var I=false;var A=null;if(G&&G.length){for(var E=0;E<G.length;E++){var H=false;var C=G[E].getAttribute(microstrategy.HTMLATTR_CMD_ID);if(C&&C.length>0){if(!B.commands.queryEnabled(C)||!this.commands.queryEnabled(C)){H=true;}}if(A==null&&!H){A=E;}if((this.currentTab-1)==E&&H){I=true;}if(H){G[E].className="mstrTabSetTabdisabled";microstrategy.unRegisterBone(G[E].id);var F=G[E].getAttribute("tab");if(F){F=getElementById(F);}if(F){F.style.display="none";F.style.visibility="hidden";}}else{if(!this.submitUponTargetLevelChange){if(G[E].className&&G[E].className.indexOf("disabled")>=0){G[E].className=G[E].className.replace("disabled"," ");}}}}}if(I){this.setCurrentTab(G[A]);}}catch(D){microstrategy.errors.log(D);return false;}};mstrFormatImpl.prototype.initChildrenTabs=function(){try{this.childrenTabs=new Array();this.enableChildrenTabs();if(this.tabContainer){var C=microstrategy.subObjectListFind(this.tabContainer,["DIV"],microstrategy.SUBOBJTYPE_TAB_SECTION);if(C&&C.length){for(var B=0;B<C.length;B++){var A=microstrategy.bone(C[B].id);var E=microstrategy.findChildWithAtt(this.body,"SPAN","id",C[B].id+"_tab");if((E&&(E.className.indexOf("disabled")==-1))||C.length==1){if(!A){if(C[B].getAttribute("scriptClass")){loadInit(C[B].getAttribute("scriptClass")+"Script",'microstrategy.registerBone("'+C[B].id+'", "(true)", null);');this.setTimeout('microstrategy.bone("'+C[B].id+'")','microstrategy.bone("'+this.id+'").loadChildrenTab("'+C[B].id+'")',500);}}else{A.dialogDiv=this.elem;A.tabManager=this;this.childrenTabs[this.childrenTabs.length]=A;if(A.initValues){A.initValues();}}}this.setScheduleTab(A);this.setDeliveryTab(A);}}}}catch(D){microstrategy.errors.log(D);return false;}};mstrFormatImpl.prototype.loadChildrenTab=function(A){try{var C=microstrategy.bone(A);if(C){C.tabManager=this;C.setAppliesTo(this.getAppliesTo());if(A in this){for(var B in this[A]){C[B]=this[A][B];}}if(C.onload){C.onload();}C.dialogDiv=this.elem;if(C.initSharedObj){C.initSharedObj(this.sharedObj);}this.childrenTabs[this.childrenTabs.length]=C;if(C.onpostload){C.onpostload();}this.setScheduleTab(C);this.setDeliveryTab(C);this.resizePopUp(this.elem);}}catch(D){microstrategy.errors.log(D);return false;}};mstrFormatImpl.prototype.setScheduleTab=function(A){try{if(A&&A.scheduleType!=undefined){A.initScheduleInfo();this.scheduleTab=A;}}catch(B){microstrategy.errors.log(B);return false;}};mstrFormatImpl.prototype.setDeliveryTab=function(A){try{if(A&&A.userType!=undefined){this.deliveryTab=A;}}catch(B){microstrategy.errors.log(B);return false;}};mstrFormatImpl.prototype.unRegisterChildren=function(){try{if(this.tabContainer){if(this.childrenTabs&&this.childrenTabs.length){var C=this.getAppliesTo();for(var A=0;A<this.childrenTabs.length;A++){if(C&&C.observer){C.observer.unregister(this.childrenTabs[A].id);}microstrategy.unRegisterBone(this.childrenTabs[A].id);}}}}catch(B){microstrategy.errors.log(B);return false;}};mstrFormatImpl.prototype.initSelections=function(){try{if(this.titleBar){var A=this.getAppliesTo();if(A==null){return ;}var F=this.titleBar.getElementsByTagName("span");var E=this.titleBar;if(F.length>0){E=F[0];}var D=E.innerHTML;var B=D.indexOf(":");if(B<0){B=D.indexOf("\uFF1A");}if(B==D.length-1){D=D.substr(0,B+1);if(A.commands&&A.commands.queryEnabled("isUserMetricSelected")){D=D+" "+microstrategy.descriptors.getDescriptor("3865");}else{if(A.commands&&A.commands.queryEnabled("isSummaryMetricSelected")){D=D+" "+microstrategy.descriptors.getDescriptor("3866");}else{if(A.commands&&!A.commands.queryEnabled()&&!A.commands.queryEnabled("onegrid")){D=D+" "+microstrategy.descriptors.getDescriptor("3520");}else{if(A.commands){D=D+" "+A.commands.queryState("selected");}}}}}E.innerHTML=D;}}catch(C){microstrategy.errors.log(C);return false;}};mstrFormatImpl.prototype.setAppliesTo=function(B){try{if(!this.appliesTo){this.appliesTo=(typeof (B)=="string")?B:B.id;}B=microstrategy.bone(this.appliesTo);if(B&&B.observer){B.observer.register(this.id);}return true;}catch(A){microstrategy.errors.log(A);return false;}};mstrFormatImpl.prototype.getAppliesTo=function(B){try{if(this.appliesTo){var B=microstrategy.bone(this.appliesTo);return B;}return null;}catch(A){microstrategy.errors.log(A);return false;}};mstrFormatImpl.prototype.cancelChanges=function(){try{var A=this.getAppliesTo();var C=A.updateManager||A.um;if(A&&C){while(this.changesApplied>0){C.undo();this.changesApplied--;}}this.changesApplied=0;for(var B=0;B<this.childrenTabs.length;B++){this.childrenTabs[B].cleanup();}this.actionId=null;this.closeEditor();return true;}catch(D){microstrategy.errors.log(D);return false;}};mstrFormatImpl.prototype.applyGraphFormatChanges=function(C){try{var A=this.getAppliesTo();if(!this.validateInputs()){return false;}if(C==null){C=new Array();}var B;if(C.length==0){for(B=0;B<this.childrenTabs.length;B++){var E=this.childrenTabs[B];C=E.applyFormatChanges(A,C);}}if(C.length>0){A.commands.exec("formatGraphBulk",C);}return true;}catch(D){microstrategy.errors.log(D);return false;}};mstrFormatImpl.prototype.applyFormatChanges=function(E){try{if(typeof microstrategy.log!="undefined"&&microstrategy.log.shouldLog(mstrLogImpl.ACTION_LEVEL|mstrLogImpl.METHOD_LEVEL)){microstrategy.log.start("mstrFormatImpl.applyFormatChanges",mstrLogImpl.APPLY_EDITOR_CHANGES);}var C=this.getAppliesTo();var I=C.updateManager||C.um;if(E==null){E=new Array();}var A;if(!this.validateInputs()){return false;}this.changeGridProperties=(C&&C.commands.queryEnabled("onegrid")==true)?true:false;var L=this.isGridContainerSelected();var B=false;var H=null;if(this.isPanelStackSelected()){if(this.targetAxis==0&&this.targetLevel==1){microstrategy.formatType=mstrPanelStack.FMT_TYPE_TITLE;}}if(this.changeGridProperties&&L&&this.targetLevel==9){microstrategy.formatType=mstrGridReport.FMT_TYPE_TITLE;}if(E.length==0){for(A=0;A<this.childrenTabs.length;A++){var G=this.childrenTabs[A];if(this.changeGridProperties&&!L){G.enforceSubmit=true;}G.applyFormatChanges(C,E);B=B||G.enforceSubmit;if(typeof (G.isUserMetric)!="undefined"&&G.isUserMetric){this.formatUserMetric=true;H=G;}}this.getExtraFormatChanges(C,E);}if(E.length>0){if(this.formatUserMetric){var K=new Object();K.userMetricId=H.userMetricId;K.dataSetId=H.dataSetId;K.bulkChanges=E;C.commands.exec("formatUserMetric",K);}else{if(this.changeGridProperties==true&&this.targetAxis!=null){var J=C.commands.queryState("selectedGrid");var F=microstrategy.findBone(J);if(F==null){F=microstrategy.findBone(document.getElementById(J.id));}if(F){F.selectedAxis=this.targetAxis;F.selectedPosition=this.targetPosition;F.selectedLevel=this.targetLevel;F.selectedUnit=this.targetUnit;}if(L){C.commands.exec("formatBulk",E);if(B&&microstrategy.DISPLAY_MODE!=microstrategy.DESIGN_MODE&&I){I.flushAndSubmitChanges();}}else{C.commands.exec("formatGridBulk",E);}}else{C.commands.exec("formatBulk",E,this.isPanelStackSelected()&&this.targetAxis==1);if(B&&microstrategy.DISPLAY_MODE!=microstrategy.DESIGN_MODE&&I){I.flushAndSubmitChanges();}}}this.changesApplied++;}microstrategy.formatType=microstrategy.FORMAT_TYPE_MAIN;return true;}catch(D){microstrategy.errors.log(D);return false;}finally{if(typeof microstrategy.log!="undefined"&&microstrategy.log.shouldLog(mstrLogImpl.ACTION_LEVEL|mstrLogImpl.METHOD_LEVEL)){microstrategy.log.stop("mstrFormatImpl.applyFormatChanges",mstrLogImpl.APPLY_EDITOR_CHANGES);}}};mstrFormatImpl.prototype.getExtraFormatChanges=function(A,B){try{}catch(C){microstrategy.errors.log(C);}return B;};mstrFormatImpl.prototype.applyMultiLevelFormatChanges=function(){try{if(typeof microstrategy.log!="undefined"&&microstrategy.log.shouldLog(mstrLogImpl.ACTION_LEVEL|mstrLogImpl.METHOD_LEVEL)){microstrategy.log.start("mstrFormatImpl.applyMultiLevelFormatChanges",mstrLogImpl.APPLY_EDITOR_CHANGES);}var B=this.getAppliesTo();if(!B){return ;}if(!this.validateInputs()){return false;}var D=microstrategy.updateManager;var C=new Array();var A=false;D.queueActions=true;for(var E=0;E<this.childrenTabs.length;E++){var G=this.childrenTabs[E];C=G.applyFormatChanges(B,C);A=A||G.enforceSubmit;}if(C.length==0){D.queueActions=false;return ;}B.commands.exec("formatMultiLevelBulk",C);D.addCachedActions();if(A){D.flushAndSubmitChanges();}this.changesApplied++;return true;}catch(F){microstrategy.errors.log(F);return false;}finally{if(typeof microstrategy.log!="undefined"&&microstrategy.log.shouldLog(mstrLogImpl.ACTION_LEVEL|mstrLogImpl.METHOD_LEVEL)){microstrategy.log.stop("mstrFormatImpl.applyMultiLevelFormatChanges",mstrLogImpl.APPLY_EDITOR_CHANGES);}}};mstrFormatImpl.prototype.applyScheduleChanges=function(G){try{var B=this.scheduleTab;if(B){var A=this.getAppliesTo();var D=B.getScheduleType();var E=B.getScheduleList();if(D!=B.scheduleType||E!=B.scheduleList){var C=A.updateManager||A.um;C.add([C.createActionObject(A.elem,mstrUpdateManager.SAVE_REPORT_ASSOCIATED_SCHEDULES,A.beanPath,["4238","4239"],[D,E],[B.scheduleType,B.schedule])]);if(G){C&&C.flushAndSubmitChanges();}}return true;}}catch(F){microstrategy.errors.log(F);return false;}};mstrFormatImpl.prototype.applyUserChanges=function(H){try{var C=this.deliveryTab;if(C){var B=this.getAppliesTo(),D=C.getAssociatedUserInfo(),F=D.userType,A=D.users;if(F!=C.userTypeWas||A!=C.usersWas){var E=B.updateManager||B.um;E.add([E.createActionObject(B.elem,mstrUpdateManager.SAVE_REPORT_ASSOCIATED_USERS,B.beanPath,["4241","4242"],[D.allowType,A])]);if(H){E&&E.flushAndSubmitChanges();}C.userTypeWas=F;C.usersWas=A;}return true;}}catch(G){microstrategy.errors.log(G);return false;}};mstrFormatImpl.prototype.applyPropertyChanges=function(G,F){try{if(typeof microstrategy.log!="undefined"&&microstrategy.log.shouldLog(mstrLogImpl.ACTION_LEVEL|mstrLogImpl.METHOD_LEVEL)){microstrategy.log.start("mstrFormatImpl.applyPropertyChanges",mstrLogImpl.APPLY_EDITOR_CHANGES);}if(F==false||this.validateInputs(true)){var A=this.getAppliesTo();var D=new Array();for(var B=0;B<this.childrenTabs.length;B++){var E=this.childrenTabs[B];E.applyPropertyChanges(D);if(E.applySharedObjChanges){E.applySharedObjChanges(D);}}this.applyScheduleChanges(D.length==0);this.applyUserChanges(D.length==0);if(D.length>0){if(G&&G.length>0){A.commands.exec(G,D);}else{A.commands.exec("PropertyChanges",D);}}this.changesApplied++;return true;}else{return false;}}catch(C){microstrategy.errors.log(C);return false;}finally{if(typeof microstrategy.log!="undefined"&&microstrategy.log.shouldLog(mstrLogImpl.ACTION_LEVEL|mstrLogImpl.METHOD_LEVEL)){microstrategy.log.stop("mstrFormatImpl.applyPropertyChanges",mstrLogImpl.APPLY_EDITOR_CHANGES);}}};mstrFormatImpl.prototype.applyMultiLevelPropertyChanges=function(H){try{if(typeof microstrategy.log!="undefined"&&microstrategy.log.shouldLog(mstrLogImpl.ACTION_LEVEL|mstrLogImpl.METHOD_LEVEL)){microstrategy.log.start("mstrFormatImpl.applyPropertyChanges",mstrLogImpl.APPLY_EDITOR_CHANGES);}var B=this.getAppliesTo();if(!B){return ;}if(H&&!this.validateInputs()){return false;}var D=microstrategy.updateManager;var C=new Array();var A=false;D.queueActions=true;for(var E=0;E<this.childrenTabs.length;E++){var G=this.childrenTabs[E];G.applyPropertyChanges(C);A=A||G.enforceSubmit;}if(C.length==0){D.queueActions=false;return ;}B.commands.exec("MultiLevelPropertyChanges",C);D.addCachedActions();if(A){D.flushAndSubmitChanges();}this.changesApplied++;return true;}catch(F){microstrategy.errors.log(F);return false;}finally{if(typeof microstrategy.log!="undefined"&&microstrategy.log.shouldLog(mstrLogImpl.ACTION_LEVEL|mstrLogImpl.METHOD_LEVEL)){microstrategy.log.stop("mstrFormatImpl.applyMultiLevelPropertyChanges",mstrLogImpl.APPLY_EDITOR_CHANGES);}}};mstrFormatImpl.prototype.okPropertyChanges=function(E,D){try{var B=true;B=this.validateInputs(true);if(B){this.close();if(D){this.applyMultiLevelPropertyChanges(false);}else{this.applyPropertyChanges(E,false);}for(var A=0;A<this.childrenTabs.length;A++){this.childrenTabs[A].cleanup();}this.actionId=null;microstrategy.unRegisterBone(this.id);}}catch(C){microstrategy.errors.log(C);return false;}};mstrFormatImpl.prototype.okFormatChanges=function(B){try{B=(B==true);if(!this.validateInputs()){return false;}else{this.close();if(B){this.applyMultiLevelFormatChanges();}else{this.applyFormatChanges();}microstrategy.unRegisterBone(this.id);}}catch(A){microstrategy.errors.log(A);return false;}};mstrFormatImpl.prototype.okGraphFormatChanges=function(){try{if(!this.validateInputs()){return false;}else{this.close();this.applyGraphFormatChanges();microstrategy.unRegisterBone(this.id);}}catch(A){microstrategy.errors.log(A);return false;}};mstrFormatImpl.prototype.adjustFormatType=function(){try{if(this.changeGridProperties&&this.targetAxis==0&&this.targetLevel==9){microstrategy.formatType=mstrGridReport.FMT_TYPE_TITLE;}if(this.isPanelStackSelected()){if(this.targetAxis==0&&this.targetLevel==1){microstrategy.formatType=mstrPanelStack.FMT_TYPE_TITLE;}}}catch(A){microstrategy.errors.log(A);return false;}};mstrFormatImpl.getHTMLElement=function(A){if(typeof (A)=="string"){A=getElementById(A);}return A;};mstrFormatImpl.prototype.hasChanges=function(){var A=false;var B;for(B=0;B<this.childrenTabs.length;B++){var C=this.childrenTabs[B];A=C.checkForFormatChanges();if(A){break;}}return A;};mstrFormatImpl.prototype.changeTarget=function(F,H){try{var A=this.getAppliesTo();var C=new Array();F=mstrFormatImpl.getHTMLElement(F);var G=A.updateManager||A.um;var D=this.hasChanges();if((typeof (H)=="undefined")&&D){showMessage({contents:microstrategy.descriptors.getDescriptor("3044"),elements:microstrategy.OK_BUTTON+microstrategy.CANCEL_BUTTON,okEval:"microstrategy.bone('"+this.id+"').changeTarget('"+F.id+"',true);",cancelEval:"microstrategy.bone('"+this.id+"').changeTarget('"+F.id+"',false);",type:mstrMsgBoxImpl.MSG_WARNING});}else{var I=new Array();for(counter=0;counter<this.childrenTabs.length;counter++){var E=this.childrenTabs[counter];E.applyFormatChanges(A,C);}if((typeof (H)=="boolean")&&H&&(C.length>0)){if(this.applyFormatPropertyChanges){this.applyFormatPropertyChanges(C);}else{this.applyFormatChanges(C);}this.targetAxis=F.value;I.push(G.createActionObject(F,mstrUpdateManager.CHANGE_FORMATTING_TARGET,this.beanPath,["72003"],[F.value]));G.add(I);if(this.submitUponTargetLevelChange){this.unRegisterChildren();}}else{this.targetAxis=F.value;if(A&&G){I.push(G.createActionObject(F,mstrUpdateManager.CHANGE_FORMATTING_TARGET,this.beanPath,["72003"],[F.value]));G.add(I);if(this.submitUponTargetLevelChange){G.flushAndSubmitChanges();this.unRegisterChildren();}}}}if(!this.submitUponTargetLevelChange){this.adjustTargetLevelOptions();this.initChildrenTabs();}}catch(B){microstrategy.errors.log(B);return false;}};mstrFormatImpl.prototype.changePosition=function(F,H){try{var A=this.getAppliesTo();var C=new Array();F=mstrFormatImpl.getHTMLElement(F);var G=A.updateManager||A.um;var D=this.hasChanges();if((typeof (H)=="undefined")&&D){showMessage({contents:microstrategy.descriptors.getDescriptor("3044"),elements:microstrategy.OK_BUTTON+microstrategy.CANCEL_BUTTON,okEval:"microstrategy.bone('"+this.id+"').changePosition('"+F.id+"',true);",cancelEval:"microstrategy.bone('"+this.id+"').changePosition('"+F.id+"',false);",type:mstrMsgBoxImpl.MSG_WARNING});}else{var I=new Array();for(counter=0;counter<this.childrenTabs.length;counter++){var E=this.childrenTabs[counter];C=E.applyFormatChanges(A,C);}if((typeof (H)=="boolean")&&H&&(C.length>0)){if(F.value=="0,-9"){I.push(G.createActionObject(F,mstrUpdateManager.CHANGE_FORMATTING_TARGET,this.beanPath,["72003","72002"],[0,8]));}else{I.push(G.createActionObject(F,mstrUpdateManager.CHANGE_FORMATTING_TARGET,this.beanPath,["72001"],[F.value]));}G.add(I);this.applyFormatChanges(C);G.flushAndSubmitChanges();this.unRegisterChildren();}else{if(A&&G){if(F.value=="0,-9"){I.push(G.createActionObject(F,mstrUpdateManager.CHANGE_FORMATTING_TARGET,this.beanPath,["72003","72002"],[0,8]));}else{I.push(G.createActionObject(F,mstrUpdateManager.CHANGE_FORMATTING_TARGET,this.beanPath,["72001"],[F.value]));}G.add(I);G.flushAndSubmitChanges();this.unRegisterChildren();}}}}catch(B){microstrategy.errors.log(B);return false;}};mstrFormatImpl.prototype.changeLevel=function(G,F){try{var B=this.getAppliesTo();G=mstrFormatImpl.getHTMLElement(G);var D=B.updateManager||B.um;var A=this.hasChanges();if(typeof (F)=="undefined"&&A){showMessage({contents:microstrategy.descriptors.getDescriptor("3044"),elements:microstrategy.OK_BUTTON+microstrategy.CANCEL_BUTTON,okEval:"microstrategy.bone('"+this.id+"').changeLevel('"+G.id+"',true);",cancelEval:"microstrategy.bone('"+this.id+"').changeLevel('"+G.id+"',false);",type:mstrMsgBoxImpl.MSG_WARNING});return ;}if(F==true&&A){this.applyFormatChanges();}this.targetLevel=G.value;if(B&&D){if(this.submitUponTargetLevelChange==true||F==true){var C=new Array();C.push(D.createActionObject(G,mstrUpdateManager.CHANGE_FORMATTING_TARGET,this.beanPath,["72002"],[G.value]));D.add(C);}if(this.submitUponTargetLevelChange){D.flushAndSubmitChanges();this.unRegisterChildren();}else{this.initChildrenTabs();}}}catch(E){microstrategy.errors.log(E);return false;}};mstrFormatImpl.prototype.setCurTab=function(D){try{var B=microstrategy.findChildrenWithAtt(this.elem,"span","ty","tab");for(var A=0;A<B.length;A++){if(B[A].getAttribute("curTab")==D){this.setCurrentTab(B[A]);break;}}}catch(C){microstrategy.errors.log(C);return false;}};mstrFormatImpl.prototype.setCurrentTab=function(G){try{if(!G){return false;}if(this.currentTab==G.getAttribute("curTab")){return false;}if((G.className.indexOf("disabled")>=0)||(!this.validateInputs())){return true;}var C=microstrategy.findChildrenWithAtt(this.elem,"span","ty","tab");var E=true;var H=null;for(var B=0;B<C.length;B++){var F=C[B].getAttribute("tab");if(F){F=getElementById(F);}if(C[B]==G){C[B].className="mstrTabSetTabSelected";this.currentTab=G.getAttribute("curTab");if(F&&G.getAttribute(microstrategy.TAB_SWITCH_MODE)==microstrategy.TAB_SWITCH_MODE_CACHED){this.updateDynamicInfo(G);this.showTabSection(F);H=microstrategy.findBone(F);E=false;for(var A=0;A<this.childrenTabs.length;A++){if(this.childrenTabs[A]&&this.childrenTabs[A].id==G.id.substring(0,G.id.indexOf("_tab"))&&this.childrenTabs[A].onpostswitch){this.childrenTabs[A].onpostswitch();break;}}}}else{if(C[B].className.indexOf("disabled")==-1){C[B].className="mstrTabSetTab";this.hideTabSection(F);}}}this.addSetTabEvent(E);if(E){microstrategy.updateManager.flushAndSubmitChanges();}else{if(this.adjustTabTable){this.adjustTabTable();if(H){if(H.resize){H.resize();}if(H.onSwitchToCurrent){H.onSwitchToCurrent();}}}}this.resizePopUp(this.elem);microstrategy.eventManager.notifyOrphanBones("onstatechange");return true;}catch(D){microstrategy.errors.log(D);return false;}};mstrFormatImpl.prototype.findTabSectionContainer=function(B){try{return B;}catch(A){microstrategy.errors.log(A);return false;}};mstrFormatImpl.prototype.showTabSection=function(C){try{if(!C){return ;}var A=this.findTabSectionContainer(C);A.style.display="block";A.style.visibility="visible";}catch(B){microstrategy.errors.log(B);return false;}};mstrFormatImpl.prototype.hideTabSection=function(C){try{if(!C){return ;}var A=this.findTabSectionContainer(C);A.style.display="none";A.style.visibility="hidden";}catch(B){microstrategy.errors.log(B);return false;}};mstrFormatImpl.prototype.updateDynamicInfo=function(B){try{this.updateDynamicTitle(B);this.updateDynamicHelp(B);}catch(A){microstrategy.errors.log(A);return false;}};mstrFormatImpl.prototype.updateDynamicTitle=function(C){try{var A=this.getTitleContainer();if(this.useDynamicTitle&&A){if(A.childNodes[0]){A.childNodes[0].nodeValue=(C.childNodes[0].childNodes[0])?C.childNodes[0].childNodes[0].nodeValue:C.childNodes[0].nodeValue;A.setAttribute("title",A.childNodes[0].nodeValue);}}}catch(B){microstrategy.errors.log(B);return false;}};mstrFormatImpl.prototype.updateDynamicHelp=function(C){if(this.help){this.help.setAttribute("href",(C.getAttribute("helpUrl"))?C.getAttribute("helpUrl"):this.defaultHelpURL);if(this.help.childNodes[0]&&this.getTitleContainer()){var B=microstrategy.descriptors.getDescriptor("2409").replace("###",this.titleContainer.childNodes[0].nodeValue);this.help.childNodes[0].setAttribute("title",B);}}try{}catch(A){microstrategy.errors.log(A);return false;}};mstrFormatImpl.prototype.addSetTabEvent=function(C){try{var B=microstrategy.updateManager;if(B){var A=new Array();A.push(B.createActionObject(null,mstrUpdateManager.SET_CURRENT_TAB,this.beanPath,["49001","49002"],[this.currentTab,C]));B.add(A,true);}}catch(D){microstrategy.errors.log(D);return false;}};mstrFormatImpl.prototype.getChangedTabOptions=function(){try{var B="";for(var A=0;A<this.childrenTabs.length;A++){var D=this.childrenTabs[A];var E=D.getChanges();if(E!=null&&E.length>0){B+='"'+D.id+'":{'+E+"},";}}if(B.length>0){B=B.substring(0,B.length-1);}B="{"+B+"}";return B;}catch(C){microstrategy.errors.log(C);return false;}};mstrFormatImpl.prototype.validateInputs=function(C){try{if(!mstrEditorImpl.prototype.validateInputs.call(this)){return false;}if(C){for(var A=0;A<this.childrenTabs.length;A++){var D=this.childrenTabs[A];if(!D.validateInputs()){return false;}}}return true;}catch(B){microstrategy.errors.log(B);return false;}};mstrFormatImpl.prototype.onmenusubmitform=function(){if(this.autoSubmitJS!=null&&this.autoSubmitJS.length>0){return JSON.parse(this.autoSubmitJS);}};mstrFormatImpl.prototype.applySortChanges=function(){try{var B=new Array();for(var A=0;A<this.childrenTabs.length;A++){var E=this.childrenTabs[A];E.getSortChanges(B);}var C=microstrategy.updateManager;if(B.length>0&&C){C.add(B,true);C.flushAndSubmitChanges();}}catch(D){microstrategy.errors.log(D);return false;}};mstrFormatImpl.prototype.okSortChanges=function(){try{this.close();this.applySortChanges();microstrategy.unRegisterBone(this.id);return true;}catch(A){microstrategy.errors.log(A);return false;}};mstrFormatImpl.prototype.afterresize=function(){try{if(mstrEditorImpl.prototype.afterresize){mstrEditorImpl.prototype.afterresize.call(this);}for(var A=0;A<this.childrenTabs.length;A++){if(this.childrenTabs[A]&&this.childrenTabs[A].afterresize){this.childrenTabs[A].afterresize();}}}catch(B){microstrategy.errors.log(B);return false;}};mstrFormatImpl.prototype.getTitleContainer=function(){try{if(!this.titleContainer){this.titleContainer=microstrategy.findChildWithAtt(this.elem,"span",((bIsW3C)?"class":"className"),"mstrPanelTitle");}return this.titleContainer;}catch(A){microstrategy.errors.log(A);return false;}};function mstrFormatImpl(A){this.inherits=mstrEditorImpl;this.inherits(A);this.inherits=null;return this;}mstrFormatImplCommandsImpl.prototype=new Object();mstrFormatImplCommandsImpl.prototype.queryEnabled=function(A){try{switch(A){case"fontprops":if(this.parentBone.areAllSelectedPanelStacks()){return false;}if(this.parentBone.isPanelStackSelected()){if(this.parentBone.targetAxis==1){return false;}if(this.parentBone.targetLevel!=1){return false;}}else{if(this.parentBone.isGridSelected()){if((this.parentBone.targetPosition==-9&&this.parentBone.targetLevel==8)||(this.parentBone.targetPosition==-99)){return false;}}}break;case"numberprops":if(this.parentBone.areAllSelectedPanelStacks()){return false;}if(this.parentBone.isPanelStackSelected()){return false;}if(this.parentBone.isGridSelected()){if(this.parentBone.isGridContainerSelected()||(this.parentBone.targetPosition==-99)){return false;}}break;case"alignprops":if(this.parentBone.areAllSelectedPanelStacks()){return false;}if(this.parentBone.isPanelStackSelected()){return false;}if(this.parentBone.isGridSelected()){if(this.parentBone.isGridContainerSelected()||(this.parentBone.targetPosition==-99)){return false;}}break;case"dropShadowEffect":if(this.parentBone.isGridSelected()){if(this.parentBone.targetPosition==-99){return false;}}case"effectprops":if(this.parentBone.isPanelStackSelected()){if(this.parentBone.targetLevel==1){return false;}}else{if(this.parentBone.isGridSelected()){if((this.parentBone.targetPosition!=-9||this.parentBone.targetLevel!=8)&&(this.parentBone.targetPosition!=-99)){return false;}}}break;}return true;}catch(B){microstrategy.errors.log(B);return false;}};function mstrFormatImplCommandsImpl(A){this.parentBone=A;return this;}mstrTabImplScript=true;mstrTabImpl.prototype=new mstrEditorImpl();mstrTabImpl.prototype.settings=new Array();mstrTabImpl.prototype.settingsNameArray=new Array();mstrTabImpl.prototype.enforceSubmit=false;mstrTabImpl.prototype.currentPropertyName=null;mstrTabImpl.prototype.tabManager=null;mstrTabImpl.prototype.PIXEL_WIDTH=2;mstrTabImpl.prototype.cmdLevel=null;mstrTabImpl.prototype.appliesTo=null;mstrTabImpl.prototype.tabSwitch=null;mstrTabImpl.CMD_TYPE_DEFAULT=0;mstrTabImpl.CMD_TYPE_BITFLAG=1;mstrTabImpl.prototype.onload=function(){try{this.initEditor();if(this.elem&&this.elem.parentNode){var A=this.elem.parentNode.getAttribute("at");if(A&&A.length>0){this.appliesTo=A;}}}catch(B){microstrategy.errors.log(B);return false;}};mstrTabImpl.prototype.onunload=function(C){try{mstrEditorImpl.prototype.onunload.call(this,C);var B=this.getAppliesTo();if(B&&B.observer){B.observer.unregister(this.id);}}catch(A){microstrategy.errors.log(A);}return true;};mstrTabImpl.prototype.exec=function(A,H){try{switch(A){case"advColorPicker":var G=H.split("|");var F=document.getElementById(G[0]);if(F){this.updateColorPicker(F,G[1]);}break;case"edtColorGradient":var G=H.split("|");var F=document.getElementById(G[0]);var E=G[1].split(",");if(E.length>=2&&(E[0]==E[1])){if(F){this.updateColorPicker(F,E[0]);}break;}else{if(F){F.setAttribute(microstrategy.HTMLATTR_CMD_VALUE,G[1]);var C=F.getElementsByTagName("span");if(C.length>0){C[0].setAttribute(microstrategy.HTMLATTR_CMD_VALUE,G[1]);}else{F.setAttribute(microstrategy.HTMLATTR_CMD_VALUE,G[1]);}var B=document.getElementById(this.id+F.getAttribute(microstrategy.HTMLATTR_CMD_ID));if(B){B.value=G[1];if(!this.initializing){B.setAttribute(microstrategy.HTMLATTR_CMD_VALUE,G[1]);}}}this.updateColorPickerGradient(H);break;}}}catch(D){microstrategy.errors.log(D);return false;}};mstrTabImpl.prototype.showOptions=function(E){try{if(!E){return false;}var D=E.parentNode.getElementsByTagName(E.tagName);for(var B=0;B<D.length;B++){var A=D[B].id;if(A){A=document.getElementById("div"+A);}if(A){A.style.display=(D[B]==E)?"block":"none";}}return true;}catch(C){microstrategy.errors.log(C);return false;}};mstrTabImpl.prototype.ondocumentclick=function(B){try{if(!B){B=window.event;}if(this.currentPicker){this.closePicker(B);}}catch(A){microstrategy.errors.log(A);}};mstrTabImpl.prototype.togglePicker=function(A,D,B){try{if(B&&(!B.disabled)){dropDown.togglePicker(A,D,B,this);}}catch(C){microstrategy.errors.log(C);}return false;};mstrTabImpl.prototype.closePicker=function(B){try{dropDown.closePicker(B,this);return true;}catch(A){microstrategy.errors.log(A);return false;}};mstrTabImpl.prototype.checkForFormatChanges=function(){try{return false;}catch(A){microstrategy.errors.log(A);}};mstrTabImpl.prototype.applyFormatChanges=function(A,B){try{return B;}catch(C){microstrategy.errors.log(C);return B;}};mstrTabImpl.prototype.checkRGBColors=function(B,A){try{if((A!=null)&&(B.toLowerCase().indexOf("color")>-1)){A=mstr.utils.Color.rgbStr2hex(A);}return A;}catch(C){microstrategy.errors.log(C);return A;}};mstrTabImpl.prototype.applyPropertyChanges=function(G){try{for(counter=0;counter<this.settings.length;counter++){var C=this.settings[counter];var F=C.getAttribute(microstrategy.HTMLATTR_CMD_VALUE);if(F!=null){var D=C.getAttribute(microstrategy.HTMLATTR_CMD_ID);var B=C.getAttribute(microstrategy.HTMLATTR_CMD_LEVEL);if(!B){B=this.cmdLevel;}var A=new this.propChangeObject(C,D,F,null,null,B);G.push(A);if(!this.enforceSubmit){C.removeAttribute(microstrategy.HTMLATTR_CMD_VALUE);}}}return true;}catch(E){microstrategy.errors.log(E);return false;}};mstrTabImpl.prototype.propChangeObject=function(E,B,G,D,A,C,F){this.obj=E;this.cmdId=B;this.value=G;this.performFormatChange=D;this.submitUpdateManager=A;this.level=(C!=null)?C:this.cmdLevel;this.formatType=(F!=null)?F:microstrategy.FORMAT_TYPE_MAIN;return this;};mstrTabImpl.prototype.simpleInitCheckValue=function(D,C,A){try{if(D&&D.tagName.toLowerCase()!="input"){if(C==0){D.src=microstrategy.FOLDER_IMAGES+"check_off.gif";D.setAttribute("cv","0");}else{D.src=microstrategy.FOLDER_IMAGES+"check_on.gif";D.setAttribute("cv","-1");}}else{if((C||typeof (C)=="boolean")&&D){if(C&D.value||C==D.value){D.checked=true;}else{D.checked=false;}}}if(D){if(A==null||A=="true"){D.onclick();}}}catch(B){microstrategy.errors.log(B);return false;}};mstrTabImpl.prototype.initCheckValue=function(B,A,H,C,F){try{var G=document.getElementById(H);if(!G||!B||!B.commands){return ;}if(F==null||(B.commands.queryEnabled("isSelectionsPresent")&&this.isEnabled(B.commands.queryState("selectedItems"),F))){if(B.commands.queryEnabled()&&B.commands.queryEnabled(A)){var E=B.commands.queryState(A);this.simpleInitCheckValue(G,E,C);return ;}}this.disableObj(H);}catch(D){microstrategy.errors.log(D);}};mstrTabImpl.prototype.simpleInitTextValue=function(D,C,A){try{if((C||(C!=null&&C.length==0))&&D){D.value=C;if(A==null||A=="true"){D.onchange();}}}catch(B){microstrategy.errors.log(B);return false;}};mstrTabImpl.prototype.initTextValue=function(B,A,H,C,F){try{if(document.getElementById(H)){if(F==null||(B.commands.queryEnabled("isSelectionsPresent")&&this.isEnabled(B.commands.queryState("selectedItems"),F))){if(B.commands&&B.commands.queryEnabled()){if(B.commands.queryEnabled(A)){var E=B.commands.queryState(A);var G=document.getElementById(H);this.simpleInitTextValue(G,E,C);}}}else{this.disableObj(H);}}}catch(D){microstrategy.errors.log(D);return false;}};mstrTabImpl.prototype.simpleInitRadioValue=function(D,C,A){try{if(D){D.checked=true;if(A==null||A=="true"){D.onclick();}}}catch(B){microstrategy.errors.log(B);return false;}};mstrTabImpl.prototype.initRadioValue=function(A,J,I,F,E){try{var B=document.getElementsByName(I);if(B){if(E==null||(A.commands.queryEnabled("isSelectionsPresent")&&this.isEnabled(A.commands.queryState("selectedItems"),E))){if(A.commands&&A.commands.queryEnabled()){if(A.commands.queryEnabled(J)){var H=A.commands.queryState(J);var G=document.getElementById(I+H);this.simpleInitRadioValue(G,H,F);}}}else{for(var D=0;D<B.length;D++){this.disableOptionAndLabel(B[D]);}}}}catch(C){microstrategy.errors.log(C);return false;}};mstrTabImpl.prototype.simpleInitLabelValue=function(C,B){try{if(B&&C){C.innerHTML=B;}}catch(A){microstrategy.errors.log(A);return false;}};mstrTabImpl.prototype.disableOptionAndLabel=function(A){try{if(A){A.disabled=true;A.className="disabled";if(document.getElementById(A.id+"_label")){document.getElementById(A.id+"_label").className="disabledLabel";}}}catch(B){microstrategy.errors.log(B);return false;}};mstrTabImpl.prototype.enableOptionAndLabel=function(A){try{if(A){A.disabled=false;A.className="";if(document.getElementById(A.id+"_label")){document.getElementById(A.id+"_label").className="";}}}catch(B){microstrategy.errors.log(B);return false;}};mstrTabImpl.prototype.initLabelValue=function(B,A,F){try{if(B.commands&&B.commands.queryEnabled()){if(B.commands.queryEnabled(A)){var D=B.commands.queryState(A);var E=document.getElementById(F);this.simpleInitLabelValue(E,D);}}}catch(C){microstrategy.errors.log(C);return false;}};mstrTabImpl.prototype.simpleInitComboValue=function(H,J,G){try{if(J!=null&&(J.toString()).length>0&&H!=null){var F=parseInt(H.getAttribute(microstrategy.HTMLATTR_CMD_TYPE));switch(F){case mstrTabImpl.CMD_TYPE_BITFLAG:var B=H.options;var E=-1;var I=parseInt(J);var A=0;for(var D=0;D<B.length;D++){var L=B.item(D);var K=parseInt(L.value);if((((I&K)||(K==A))&&(K>E))||(K==0==I)){E=K;I=I-K;A+=K;}if((I==0)&&(K==A)&&(E>-1)){break;}}if(E>-1){H.value=E;}break;default:H.value=J;}if(G==null||G=="true"){H.onchange();}}}catch(C){microstrategy.errors.log(C);return false;}};mstrTabImpl.prototype.initComboValue=function(B,A,H,C,F){try{if(F==null||(B.commands.queryEnabled("isSelectionsPresent")&&this.isEnabled(B.commands.queryState("selectedItems"),F))){if(B.commands&&B.commands.queryEnabled()){if(B.commands.queryEnabled(A)){var E=B.commands.queryState(A);var G=document.getElementById(H);this.simpleInitComboValue(G,E,C);}}}else{this.disableObj(H);}}catch(D){microstrategy.errors.log(D);return false;}};mstrTabImpl.prototype.initColorPickerValue=function(B,A,G,E){try{if(E==null||(B.commands.queryEnabled("isSelectionsPresent")&&this.isEnabled(B.commands.queryState("selectedItems"),E))){if(B.commands&&B.commands.queryEnabled()){var D;var F=document.getElementById(G);if(A=="bgcolor"){D=F.getAttribute(microstrategy.HTMLATTR_CMD_VALUE);if(!D&&B.commands.queryEnabled("gradientcolor")){D=B.commands.queryState("gradientcolor");}}if(B.commands.queryEnabled(A)){if((A=="bgcolor"&&!D)||A!="bgcolor"){D=B.commands.queryState(A,this.tabManager.isPanelStackSelected()&&this.tabManager.targetAxis==1);}this.updateColorPicker(F,D);}}}else{if(document.getElementById(G)){document.getElementById(G).disabled=true;document.getElementById(G).className="mstrPulldowndisabled";}if(document.getElementById(G+"_label")){document.getElementById(G+"_label").className="disabledLabel";}}}catch(C){microstrategy.errors.log(C);return false;}};mstrTabImpl.prototype.setAppliesTo=function(B){if(B==null){return true;}try{if(!this.appliesTo){this.appliesTo=(typeof (B)=="string")?B:B.id;}B=microstrategy.bone(this.appliesTo);if(B.observer){B.observer.register(this.id);}return true;}catch(A){microstrategy.errors.log(A);return false;}};mstrTabImpl.prototype.getAppliesTo=function(B){try{if(this.appliesTo){var B=microstrategy.bone(this.appliesTo);return B;}return null;}catch(A){microstrategy.errors.log(A);return false;}};mstrTabImpl.prototype.isEnabled=function(A,D){try{var B=microstrategy.isEnabled(A,D);return B;}catch(C){microstrategy.errors.log(C);return false;}};mstrTabImpl.prototype.updateList=function(A){};mstrTabImpl.prototype.updateText=function(C,A){try{if(C&&(typeof (A)=="undefined"||!A)){C.setAttribute(microstrategy.HTMLATTR_CMD_VALUE,C.value);}}catch(B){microstrategy.errors.log(B);return false;}};mstrTabImpl.prototype.updateCheck=function(C){try{if(C){var B=(C.checked)?"-1":"0";C.setAttribute(microstrategy.HTMLATTR_CMD_VALUE,B);}}catch(A){microstrategy.errors.log(A);return false;}};mstrTabImpl.prototype.updateDropdown=function(E,C,D,A){try{if(E){E.innerHTML=C;if(typeof (A)=="undefined"||!A){E.setAttribute(microstrategy.HTMLATTR_CMD_VALUE,D);}}}catch(B){microstrategy.errors.log(B);return false;}};mstrTabImpl.prototype.updateColorPicker=function(E,D,A){try{if(D==null){D="transparent";}if(E&&(D!="-2")){var B=E.getElementsByTagName("span");if(D&&D.indexOf(",")>=0&&D.indexOf("rgb")<0){this.updateColorPickerGradient(E.id+"|"+D);}else{if(B.length>0){B[0].style.backgroundColor=D;if(!D||D=="transparent"){B[0].innerHTML=microstrategy.descriptors.getDescriptor(3779);}else{B[0].innerHTML="";}}else{E.style.backgroundColor=D;}}if(typeof (A)=="undefined"||!A){E.setAttribute(microstrategy.HTMLATTR_CMD_VALUE,D);}}}catch(C){microstrategy.errors.log(C);return false;}};mstrTabImpl.prototype.getColorPickerValue=function(E){try{var D="";if(E){var A=E.getElementsByTagName("span");var B=null;if(A.length>0){B=A[0];}else{B=E;}D=B.style.backgroundColor;}return D;}catch(C){microstrategy.errors.log(C);return false;}};mstrTabImpl.prototype.disableObj=function(A){try{if(document.getElementById(A)){this.disableOptionAndLabel(document.getElementById(A));}}catch(B){microstrategy.errors.log(B);return false;}};mstrTabImpl.prototype.enableObj=function(A){try{if(document.getElementById(A)){this.enableOptionAndLabel(document.getElementById(A));}}catch(B){microstrategy.errors.log(B);return false;}};mstrTabImpl.prototype.allSelectedItemsAreOfType=function(C){try{var G=true;var A=this.getAppliesTo();var B=A.commands.queryState("selectedItems");for(var E in B){var F=B[E].getAttribute("sty");if(F!=C){G=false;break;}}return G;}catch(D){microstrategy.errors.log(D);return false;}};mstrTabImpl.prototype.cleanup=function(A){};mstrTabImpl.prototype.getJSONProperty=function(A,E,D){try{var B="";if(A!=null&&E!=null){E=(D)?E:'"'+E+'"';E=E.replace(/%5C/g,"%5C%5C");E=E.replace(/%22/g,"%5C%22");B+='"'+A+'":'+E+",";}return B;}catch(C){microstrategy.errors.log(C);return"";}};mstrTabImpl.prototype.getChanges=function(){try{var C="";var B;for(B=0;B<this.settings.length;B++){var A=this.settings[B];var D=A.getAttribute(microstrategy.HTMLATTR_CMD_ID);var F=this.getChangedValue(A);C+=this.getJSONProperty(D,F);}if(C.length>0){C=C.substring(0,C.length-1);}return C;}catch(E){microstrategy.errors.log(E);return false;}};mstrTabImpl.prototype.getChangedValue=function(A){try{var C=A.getAttribute(microstrategy.HTMLATTR_CMD_VALUE);if(C==null){if(A.nodeName.toLowerCase()=="input"&&A.type.toLowerCase()=="checkbox"){C=A.checked;}}return C;}catch(B){microstrategy.errors.log(B);return null;}};mstrTabImpl.prototype.saveTabSelections=function(){var C="{"+this.getChanges(true)+"}";var B=this.tabManager.selectedTabOptions||"";var A=B.length;if(A){B=B.substring(1,A-1)+",";}this.tabManager.selectedTabOptions="{"+B+'"'+this.id+'":'+C+"}";microstrategy.updateManager.replaceURL("selectedTabOptions",this.tabManager.selectedTabOptions);};mstrTabImpl.prototype.restorePreviousSelections=function(A){try{for(var B in A){var D=document.getElementById(this.id+B);if(D!=null&&A[B]!=null&&D.id==this.id+B){this.restoreEachSelection(D,B,A[B]);}else{if(D==null||D.getAttribute("name")==this.id+B){this.updateSpecialCases(B,A[B]);}}}}catch(C){microstrategy.errors.log(C);return false;}};mstrTabImpl.prototype.restoreEachSelection=function(E,A,D){try{if(A.indexOf("Color")>-1){this.updateColorPicker(E,D);}else{var F=E.nodeName;switch(F.toLowerCase()){case"select":this.updateComboBox(E,D);this.updateList(E);break;case"input":var B=E.type.toLowerCase();switch(B){case"checkbox":this.reselectCheckBox(E,D);this.updateCheck(E);break;case"radio":this.updateRadioButton(E,D);break;case"text":this.updateText(E);break;}break;default:E.setAttribute(microstrategy.HTMLATTR_CMD_VALUE,D);}}}catch(C){microstrategy.errors.log(C);return false;}};mstrTabImpl.prototype.updateRadioButton=function(B,A){};mstrTabImpl.prototype.updateSpecialCases=function(A,B){};mstrTabImpl.prototype.reselectCheckBox=function(C,B){try{C.checked=B;}catch(A){microstrategy.errors.log(A);return false;}};mstrTabImpl.prototype.updateComboBox=function(F,E){try{var B=F.childNodes;var A=-1;var G=0;for(var C=0;C<B.length;C++){if(B[C]!=null&&B[C].nodeName.toLowerCase()=="option"){if(this.matchesListValue(B[C].value,E,F.getAttribute(microstrategy.HTMLATTR_CMD_ID))){A=G;break;}G++;}}F.selectedIndex=A;F.setAttribute(microstrategy.HTMLATTR_CMD_VALUE,E);}catch(D){microstrategy.errors.log(D);return false;}};mstrTabImpl.prototype.matchesListValue=function(B,D,A){try{return(B==D);}catch(C){microstrategy.errors.log(C);return false;}};mstrTabImpl.prototype.openAdvancedColorPicker=function(B,A,C){try{if(B&&B.commands){var E=mstr.utils.Color.rgbStr2hex(C);B.commands.exec("edtColorPicker",this.id+"|"+this.id+A+"|"+E+"|"+this.tabManager.getChangedTabOptions());}}catch(D){microstrategy.errors.log(D);return false;}};mstrTabImpl.prototype.openColorGradientEditor=function(A,B){try{if(A&&A.commands){A.commands.exec("edtColorGradient",B+"|"+this.tabManager.getChangedTabOptions());}}catch(C){microstrategy.errors.log(C);return false;}};mstrTabImpl.prototype.openColorGradientEditor=function(A,C,B){try{if(A&&A.commands){if(B==true){A.commands.exec("graphEdtColorGradient",C+"|"+this.tabManager.getChangedTabOptions());}else{this.tabManager.adjustFormatType();A.commands.exec("edtColorGradient",C+"|"+this.tabManager.getChangedTabOptions(),this.tabManager.isPanelStackSelected()&&this.tabManager.targetAxis==1);microstrategy.formatType=microstrategy.FORMAT_TYPE_MAIN;}}}catch(D){microstrategy.errors.log(D);return false;}};mstrTabImpl.prototype.openGradientColorPicker=function(B,J,I,H,C,D,G,E){try{if(B&&B.commands){this.tabManager.adjustFormatType();if(!C){B.commands.exec("edtColorGradient",this.id+"|"+this.id+J+"|"+0+"|"+I+"|"+H+"|"+this.tabManager.getChangedTabOptions(),this.tabManager.isPanelStackSelected()&&this.tabManager.targetAxis==1);}else{var A=((D==0&&G==0)||(D==90&&E==0))?0:1;B.commands.exec("edtColorGradient",this.id+"|"+this.id+J+"|"+A+"|"+I+"|"+H+"|"+C+"|"+D+"|"+G+"|"+E+"|"+this.tabManager.getChangedTabOptions(),this.tabManager.isPanelStackSelected()&&this.tabManager.targetAxis==1);}microstrategy.formatType=microstrategy.FORMAT_TYPE_MAIN;}}catch(F){microstrategy.errors.log(F);return false;}};mstrTabImpl.prototype.updateColorPickerGradient=function(J){try{var N=J.split("|");var F=document.getElementById(N[0]);F.style.backgroundColor="transparent";var K=F.getElementsByTagName("span");if(K.length>0){F=K[0];}else{return false;}F.innerHTML="";var O=N[1].split(",");var H=getObjInnerWidth(F);var G=getObjInnerHeight(F);if(H%2==1){H=H-1;}if(G%2==1){G=G-1;}var S=gradientUtil.getRGBColor(O[0]);var A=gradientUtil.getRGBColor(O[1]);var Q=(O[3]==0)?gradientUtil.GRADIENTSHADING_STYLE_HORIZONTAL:gradientUtil.GRADIENTSHADING_STYLE_VERTICAL;var U=O[4];var D=O[5];var T=(Q==gradientUtil.GRADIENTSHADING_STYLE_HORIZONTAL&&U!=100)||(Q==gradientUtil.GRADIENTSHADING_STYLE_VERTICAL&&D!=100)?1:2;var R=(H/gradientUtil.PIXEL_WIDTH)*(G/gradientUtil.PIXEL_WIDTH);for(var L=0;L<R;L++){var B=document.createElement("div");B.className="pixel";var P=gradientUtil.getColorPercent(gradientUtil.getXCoordinate(L,H),gradientUtil.getYCoordinate(L,G),T,H,Q);var E=parseInt(P*(A[0]-S[0]))+S[0];var I=parseInt(P*(A[1]-S[1]))+S[1];var M=parseInt(P*(A[2]-S[2]))+S[2];B.style.backgroundColor="rgb("+E+", "+I+", "+M+")";F.appendChild(B);}}catch(C){microstrategy.errors.log(C);return false;}};mstrTabImpl.prototype.initSettings=function(){try{if(this.settingsNameArray.length==0){return ;}this.settings=new Array();for(var A=0;A<this.settingsNameArray.length;A++){var C=document.getElementById(this.id+this.settingsNameArray[A]);if(C){this.settings.push(C);}}}catch(B){microstrategy.errors.log(B);return false;}};mstrTabImpl.prototype.initCtrlValue=function(G,D){try{var B=this.getAppliesTo();if(!B){return ;}var A=G.getAttribute(microstrategy.HTMLATTR_CMD_ID);if(B.commands&&B.commands.queryEnabled(A)){var F=B.commands.queryState(A);var C=G.type||G.getAttribute("type");switch(C){case"text":this.simpleInitTextValue(G,F,D);break;case"checkbox":this.simpleInitCheckValue(G,(F==true),D);break;case"colorpicker":this.updateColorPicker(G,F);break;case"picker":break;}}else{this.disableObj(fieldName);}}catch(E){microstrategy.errors.log(E);return false;}};mstrTabImpl.prototype.updateCtrl=function(B){try{if(!B){return ;}if(this.initializing){return ;}switch(B.type){case"text":B.setAttribute(microstrategy.HTMLATTR_CMD_VALUE,B.value);break;case"checkbox":B.setAttribute(microstrategy.HTMLATTR_CMD_VALUE,(B.checked)?microstrategy.TRUE:microstrategy.FALSE);break;}}catch(A){microstrategy.errors.log(A);return false;}};mstrTabImpl.prototype.getSwitchMode=function(){try{if(!this.tabSwitch){if(this.tabManager){this.tabSwitch=microstrategy.findChildWithAtt(this.tabManager,"td","tab",this.id);}}if(this.tabSwitch){return this.tabSwitch.getAttribute(microstrategy.TAB_SWITCH_MODE);}return 0;}catch(A){microstrategy.errors.log(A);return false;}};mstrTabImpl.prototype.setSwitchMode=function(B){try{if(!this.tabSwitch){if(this.tabManager){this.tabSwitch=microstrategy.findChildWithAtt(this.tabManager,"td","tab",this.id);}}if(this.tabSwitch){this.tabSwitch.setAttribute(microstrategy.TAB_SWITCH_MODE,B);}}catch(A){microstrategy.errors.log(A);return false;}};mstrTabImpl.prototype.afterresize=function(){try{if(mstrEditorImpl.prototype.afterresize){mstrEditorImpl.prototype.afterresize.call(this);}var D=microstrategy.findChildrenWithAtt(this.elem,"div","ty");for(var B=0;B<D.length;B++){var A=microstrategy.findBone(D[B]);if(A&&A.afterresize){A.afterresize();}}}catch(C){microstrategy.errors.log(C);return false;}};mstrTabImpl.prototype.onwinresize=function(){try{if(mstrEditorImpl.prototype.onwinresize){mstrEditorImpl.prototype.onwinresize.call(this);}this.resize();}catch(A){microstrategy.errors.log(A);return false;}};mstrTabImpl.prototype.resize=function(){try{if(mstrEditorImpl.prototype.resize){mstrEditorImpl.prototype.resize.call(this);}var D=microstrategy.findChildrenWithAtt(this.elem,"div","ty");if(D){for(var B=0;B<D.length;B++){var A=microstrategy.findBone(D[B]);if(A&&A.resize){A.resize();}}}}catch(C){microstrategy.errors.log(C);return false;}};mstrTabImpl.prototype.toggleCheck=function(C,A){if(this.initializing!=false){return false;}var D=parseInt(C.getAttribute("cv"),10)-1;if(D<-2){D=0;}var B="check_off.gif";if(D==-1){B="check_on.gif";}else{if(D==-2){if(A){B="Check_conflict.gif";}else{D=0;}}}C.src=microstrategy.FOLDER_IMAGES+B;C.setAttribute("cv",D);C.setAttribute(microstrategy.HTMLATTR_CMD_VALUE,D);return true;};mstrTabImpl.prototype.unregister=function(){try{var C=microstrategy.findChildrenWithAtt(this.elem,"div","ty");if(C){for(var A=0;A<C.length;A++){microstrategy.unRegisterBone(C[A].getAttribute("id"));}}}catch(B){microstrategy.errors.log(B);return false;}};function mstrTabImpl(A){this.inherits=mstrEditorImpl;this.inherits(A);delete this.inherits;return this;}