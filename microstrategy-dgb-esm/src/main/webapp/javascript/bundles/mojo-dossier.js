var xmjd=mstrmojo&&mstrmojo.descriptors;var mstrmojo={helpPath:function(){return(mstrApp.helpUrl||"../help/")+"MSTRWeb/WebHelp/Lang_"+(mstrApp.helpLocaleId||mstrApp.localeId)+"/Content/";},helpPathMobileAdmin:function(){return(mstrApp.helpUrl||"../help/")+"MobileAdmin/WebHelp/Lang_"+(mstrApp.helpLocaleId||mstrApp.localeId)+"/";},upgradeHelpPath:function(){return(mstrApp.upgradeHelpUrl||"../help/")+"WebHelp/Lang_"+(mstrApp.helpLocaleId||mstrApp.localeId)+"/Content/";},descriptors:xmjd||{},meta:{TP:"t",STP:"st"},emptyFn:function(){},tstid:function(B){var A;if(B){if(typeof (B)==="object"){A=B.tstid;}else{A=B;}}return A?'tstid="'+A+'"':"";},getMissingFn:function getMissingFn(){return function(){var C=this.scriptClass,A;try{for(A in this){if(this[A]===arguments.callee){C+="."+A;break;}}}catch(B){}throw new Error("Missing abstract method: "+C);};},now:function now(){return new Date().getTime();},usesFrames:false};(function(){mstrmojo.global=(function(){var F=function(){return this;};return F.call(null);}());mstrmojo.dbg=mstrmojo.emptyFn;mstrmojo.dbg_stack=mstrmojo.emptyFn;mstrmojo.dbg_xhr=mstrmojo.emptyFn;mstrmojo.dbg_profile=mstrmojo.emptyFn;mstrmojo.debugBundles=(function(){return(window.mstrConfig&&(mstrConfig.debugFlags!==undefined)&&((mstrConfig.debugFlags&4)>0));})();mstrmojo.platform={};mstrmojo.prompt={};mstrmojo.settings={};mstrmojo.models={datasets:{},template:{}};mstrmojo.ui={editors:{controls:{}},menus:{},pathbar:{}};mstrmojo.prefs={};mstrmojo.ACL={};mstrmojo.CMS={};mstrmojo.storage={};mstrmojo.maps={};mstrmojo.maps.androidmap={};mstrmojo.maps.jsmap={};mstrmojo.graph={};mstrmojo.IPA={};mstrmojo.IPA.Monitors={};mstrmojo.IPA.Alerts={};mstrmojo.IPA.Environment={};mstrmojo.IPA.Groups={};mstrmojo.IPA.Heartbeat={};mstrmojo.IPA.Managers={};mstrmojo.sm={};mstrmojo.sort={};mstrmojo.ME={};mstrmojo.architect={ui:{editors:{},panels:{},factories:{}},obj:{},menu:{},projectmanagement:{}};mstrmojo.warehouse={ui:{editors:{}},obj:{},dbroles:{},menu:{}};mstrmojo.plugins={};mstrmojo.AS={};mstrmojo.DI={controller:{},model:{},ui:{dialogs:{}}};mstrmojo.Refine={};mstrmojo.qb={bigquery:{},es:{},mdx:{},menu:{},thirdParty:{}};mstrmojo.WH={};mstrmojo.fe={};mstrmojo.txEditor={};mstrmojo.condTx={};mstrmojo.threshold={};mstrmojo.express={ui:{}};mstrmojo.rw={model:{},xtab:{}};mstrmojo.util={ui:{}};mstrmojo.android={controllers:{},factories:{},inputControls:{},large:{controllers:{},factories:{},ui:{}},medium:{controllers:{},factories:{},ui:{nativebar:{}}},selectors:{},ui:{},nativedialog:{}};mstrmojo.vi={controllers:{},factories:{},models:{editors:{}},enums:{},ui:{menus:{},editors:{fe:{},cm:{},nlp:{}},rw:{selectors:{},xtab:{}},tabs:{},toolbars:{},tutorial:{}},viz:{},util:{}};mstrmojo.onetier={controllers:{},vi:{acl:{},prefs:{model:{}},ui:{tutorial:{}}}};mstrmojo.config={vi:{},onetier:{}};mstrmojo.chart={common:{},enums:{},model:{enums:{}}};mstrmojo.nativeandroid={};mstrmojo.gm={};mstrmojo.ngm={};mstrmojo.heatmap={vi:{}};mstrmojo.netviz={};mstrmojo.imagelayout={};mstrmojo.kpicard={layout:{},editors:{}};mstrmojo.iphone={};mstrmojo.winphone={};mstrmojo.mstr={search:{}};mstrmojo.mstr.ui={};mstrmojo.gmaps={basemap:{},graphic:{},geometry:{},layer:{svg:{},canvas:{},mapbox:{}}};mstrmojo.esrimap={};mstrmojo.mapbox={ui:{selectors:{}}};mstrmojo.examples={};mstrmojo.home={controllers:{},models:{},views:{},ui:{}};mstrmojo.workstation={pages:{}};mstrmojo.err=function D(I,H){var G=I.name+': "'+I.message+'"';if(mstrmojo.debug){if(I.fileName){G+=" at\n    "+I.fileName;}if(I.hasOwnProperty("lineNumber")){G+=": "+I.lineNumber;}else{if(I.hasOwnProperty("line")&&I.sourceURL){var F=I.sourceURL.split("/");G+="("+F[F.length>1?F.length-1:0]+":"+I.line+")";}}}this.dbg(G);if(mstrmojo.Dialog){mstrmojo.error({longDesc:I.message,code:I.code},H,{title:I.name});}else{window.alert(G);}};mstrmojo.confirm=function B(F){return window.confirm(F);};mstrmojo.alert=function E(F){window.alert(F);};var C=!!(/return true/.test(String(function(){return true;})));mstrmojo.mixin=function A(J,H){if(J){H=H||{};var I=/this\.\_super/;var G=function(N,M){return function L(){var P=this._super;this._super=M;var O=N.apply(this,arguments||[]);this._super=P;return O;};};var F=J.__onmixin__;if(F){delete J.__onmixin__;}var K;for(K in J){if((typeof J[K]==="function")&&(!C||I.test(J[K]))){H[K]=G(J[K],H[K]);}else{H[K]=J[K];}}if(F){J.__onmixin__=F;}}return H;};}());(function(){var $XHR;var $MISSING={};var getApp=function(){return mstrmojo.global.mstrApp||{};},getJsRoot=function(){return getApp().jsRoot||"../javascript/";},getJsBundlesRoot=function(){return getJsRoot()+"bundles/";},getJsMojoRoot=function(){return getApp().jsMojoRoot||"../javascript/mojo/js/source/";},getPluginRoot=function(){return getApp().pluginRoot||"../plugins/";},getPluginMojoRoot=function(){return getApp().pluginMojoRoot||getJsMojoRoot();},isIE=!!document.all;function getXHR(){$XHR=self.XMLHttpRequest?new XMLHttpRequest():(self.ActiveXObject?new ActiveXObject("Microsoft.XMLHTTP"):null);}function encodeParams(params){var x=-1,url=[],p;if(params){for(p in params){if(params.hasOwnProperty(p)){url[++x]=p+"="+encodeURIComponent(params[p]);}}}return url.join("&");}function appendUrlParams(method,baseUrl,params){if(method!=="GET"||!params){return baseUrl;}return baseUrl+"?"+encodeParams(params);}function syncXHR(method,baseUrl,params){var result=null;method=method.toUpperCase();if(!$XHR){getXHR();}if($XHR){try{var m=null,app=window.mstrApp;if(window.microstrategy!==undefined&&microstrategy){m=microstrategy;}params.taskContentType=params.taskContentType||"json";params.taskEnv="xhr";params.xts=mstrmojo.now();params=mstrmojo.addCSRFTokenToTaskParams(params);var ptp=(app&&app.persistTaskParams)||(m&&m.persistParams);if(ptp){mstrmojo.requiresCls("mstrmojo.hash");mstrmojo.hash.copy(ptp,params);}$XHR.open(method,appendUrlParams(method,baseUrl,params),false);$XHR.setRequestHeader("X-Requested-With","XMLHttpRequest");if(method!=="POST"){params=null;}else{params=encodeParams(params);$XHR.setRequestHeader("Content-type","application/x-www-form-urlencoded");}$XHR.send(params);result=$XHR.responseText||null;}catch(localerr){if(window.console){window.console.log(localerr);}}}return result;}function _jsGet(file,nullCheck){var js=mstrmojo.loadFileSync(file);if(js){try{eval(js);return nullCheck?!!verifyJsLoaded(nullCheck):true;}catch(localerr){window.alert("JavaScript compile error:\n\nFile: "+file+"\n\nError: "+localerr.message);}}return false;}mstrmojo.requiresBundle=function reqBundle(bundleName){return _jsGet(getJsBundlesRoot()+bundleName);};mstrmojo.requiresDepLib=function requiresDepLib(file,AMD){if(reqCache[file]){return true;}function isAMD(){return"function"===typeof define&&define.amd;}var AMDCache=window.define;if(!AMD&&isAMD()){delete window.define;}var value=_jsGet(file);reqCache[file]=true;window.define=AMDCache;return value;};mstrmojo.loadFileSync=function loadFileSync(file){var result=null;if(!$XHR){getXHR();}if($XHR){try{$XHR.open("GET",file+((window.mstrConfig&&mstrConfig.webVersion)?"?v="+mstrConfig.webVersion:""),false);$XHR.setRequestHeader("X-Requested-With","XMLHttpRequest");$XHR.send(null);result=$XHR.responseText||null;}catch(localerr){}if(!isIE&&$XHR.abort){$XHR.abort();}}return result;};mstrmojo.insertCSSLinks=function insertCSSLinks(files){var css,firsthead;if(files&&files.length>0){firsthead=document.getElementsByTagName("head")[0];files.forEach(function(file){css=document.createElement("link");css.setAttribute("id",file.replace(/[^a-zA-Z0-9]/g,""));css.setAttribute("rel","stylesheet");css.setAttribute("type","text/css");css.setAttribute("href",file);firsthead.appendChild(css);});}};mstrmojo.loader={loaded:{mstrmojo:true,"mstrmojo.loader":true},isLoaded:function isLd(fqcn){var isLoaded=!!verifyJsLoaded(fqcn);if(isLoaded){this.loaded[fqcn]=true;}return isLoaded;},load:function ld(fqcn){if($MISSING[fqcn]){return false;}if(this.loaded[fqcn]||this.isLoaded(fqcn)){return true;}if(_jsGet(this.fqcnToFile(fqcn),fqcn)){this.loaded[fqcn]=true;return true;}$MISSING[fqcn]=true;return false;},fqcnToFile:function fqcnToFile(fqcn){if(fqcn.match(/^mstrmojo\.plugins\./)){var pluginName=fqcn.substring(17,fqcn.indexOf(".",17)),pluginFile=pluginName+"/javascript/"+getPluginMojoRoot()+fqcn.replace("mstrmojo.plugins."+pluginName+".","").replace(/\./gm,"/");if(mstrApp&&mstrApp.supportFeature&&mstrApp.supportFeature(mstrmojo.vi.enums.EnumFeatures.SUPPORT_LIVEMODE)&&mstrApp.getWSLiveMode()&&mstrConfig.dossierServerPluginNames&&mstrConfig.dossierServerPluginNames.indexOf(pluginName)>-1){fqcn=mstrApp.dossierServerBaseUrl+"plugins/"+pluginFile;}else{fqcn=getPluginRoot()+pluginFile;}}else{if(fqcn.match(/^mstrmojo\./)){fqcn=getJsMojoRoot()+fqcn.replace("mstrmojo.","").replace(/\./gm,"/");}else{fqcn=getJsRoot()+fqcn.replace(/\./gm,"/");}}return fqcn+".js";}};var $LOADER=mstrmojo.loader,isLoaded=$LOADER.loaded;var reqCache={},addPackagesToReqCache=function addPkg(n,ns){var ps=n.split("."),klen=ps.length,k;for(k=1;k<klen;k++){var s=ps.slice(0,k).join(".");if(!reqCache[s]){ns.push(s);reqCache[s]=true;}}},loadInputScripts=function loadInputScripts(ns){var jlen=ns.length,j;for(j=0;j<jlen;j++){if(!$LOADER.load(ns[j])){window.alert("Warning: Javascript class not found:\n"+ns[j]);break;}}};mstrmojo.requiresCls=function reqCls(){var argLen=arguments.length,ns=[],i,len;for(i=0,len=argLen;i<len;i++){var n=arguments[i];if(!n||isLoaded[n]||$MISSING[n]){continue;}else{if(reqCache[n]){loadInputScripts([n]);reqCache[n]=false;continue;}}if(!n.match(/^mstrmojo\.plugins\./)){addPackagesToReqCache(n,ns);}ns.push(n);reqCache[n]=true;}loadInputScripts(ns);return true;};mstrmojo.requiresClsP=function reqClsP(){var argLen=arguments.length,ns=[],pkgName=arguments[0],i,len;addPackagesToReqCache(pkgName,ns);for(i=1,len=argLen;i<len;i++){var n=pkgName+"."+arguments[i];if(!n||isLoaded[n]||$MISSING[n]){continue;}else{if(reqCache[n]){loadInputScripts([n]);reqCache[n]=false;continue;}}if(!n.match(/^mstrmojo\.plugins\./)){ns.push(n);reqCache[n]=true;}}loadInputScripts(ns);return true;};var $DESCRIPTORS=mstrmojo.descriptors,descPrefix="mstrWeb.";function populateDescriptors(ds){if(ds){var dlen=ds.length,di;for(di=0;di<dlen;di++){var d=ds[di];$DESCRIPTORS[d.key]=d.v;}}}mstrmojo.populateDescriptors=populateDescriptors;if(window.mstrConfig!==undefined){populateDescriptors(mstrConfig.mstrDescs&&mstrConfig.mstrDescs.descriptors);mstrConfig.mstrDescs=null;}if(window.mstrApp!==undefined){populateDescriptors(mstrApp.mstrDescs&&mstrApp.mstrDescs.descriptors);}var requestDescriptor=function(prefix,ids){var ns=[],len=ids.length,i;for(i=0;i<len;i++){var k=ids[i];if(k&&!($DESCRIPTORS.hasOwnProperty(prefix+k))){ns.push(k);}}if(ns.length>0){var response=syncXHR("POST",(window.mstrConfig&&mstrConfig.taskURL)||"taskProc",{taskId:"getDescriptors",keys:ns.join(","),prefix:prefix});if(response){var r=JSON.parse(response.replace(/\\'/g,"'"));populateDescriptors(r&&r.descriptors);}}};mstrmojo.requiresDescsWPrefix=function reqDescP(prefix){var args=[].slice.call(arguments);args[0]=null;requestDescriptor(prefix,args);};mstrmojo.requiresDescs=function reqDesc(){if(window.mstrConfig!==undefined&&!mstrConfig.onMobileDevice){requestDescriptor(descPrefix,arguments);}};mstrmojo.desc=function desc(descID,defText){if(descID!==null&&descID!==undefined){mstrmojo.requiresDescs(descID);if($DESCRIPTORS.hasOwnProperty(descPrefix+descID)){return $DESCRIPTORS[descPrefix+descID];}defText=defText||"No string descriptor found for descID="+descID;}var decDefText="["+defText+"]";$DESCRIPTORS[descPrefix+descID]=decDefText;return decDefText;};mstrmojo.descP=function descP(prefix,descID,defText){mstrmojo.requiresDescsWPrefix(prefix,descID);if($DESCRIPTORS.hasOwnProperty(prefix+descID)){return $DESCRIPTORS[prefix+descID];}defText=defText||"No string descriptor found for descID="+descID;var decDefText="*"+defText+"*";$DESCRIPTORS[prefix+descID]=decDefText;return decDefText;};mstrmojo.provide=function prv(fqcn,cls){isLoaded[fqcn]=!!cls;return cls;};mstrmojo.invalidateCls=function rel(fqcn){reqCache[fqcn]=false;isLoaded[fqcn]=false;this.invalidateJsLoaded(fqcn);};var mx=mstrmojo.mixin;mstrmojo.declare=function declare(SuperCls,mixins,config){function Constr(props){if((!props||!props.dontInit)&&this.init){this.init(props);}}if(SuperCls){Constr.prototype=new SuperCls({dontInit:true});Constr.prototype.constructor=Constr;}var proto=Constr.prototype;var cnt=(mixins&&mixins.length)||0,i;for(i=0;i<cnt;i++){mx(mixins[i],proto);}if(config){mx(config,proto);if(config.scriptClass){isLoaded[config.scriptClass]=true;}}return Constr;};mstrmojo.findAncestor=function findAncestor(src,property,value,limitClass){var ancestor=src&&src.parent;while(ancestor&&(!limitClass||!(ancestor instanceof limitClass))){var targetProperty=ancestor[property];if(targetProperty!==undefined){if(value!==undefined&&value!==null){if(targetProperty===value){return ancestor;}}else{return ancestor;}}ancestor=ancestor.parent;}return null;};mstrmojo.isDescendant=function isDescendant(parent,child){var ancestor;if(!child||!parent){return false;}ancestor=child.parent;while(ancestor){if(ancestor===parent){return true;}ancestor=ancestor.parent;}return false;};mstrmojo.getCSRFToken=function getCSRFToken(url){var tkn=null;try{if(url){if(url.indexOf("validateRandNum=")>=0){return tkn;}if(this.isUrlExternal(url)){return tkn;}}if(window.mstrApp&&mstrApp.validateRandNum){tkn=mstrApp.validateRandNum;}else{if(window.mstrConfig&&mstrConfig.validateRandNum){tkn=mstrConfig.validateRandNum;}else{if(window.microstrategy!==undefined&&microstrategy&&microstrategy.validateRandNum){tkn=microstrategy.validateRandNum;}}}}catch(err){}return tkn;};mstrmojo.addCSRFTokenToURL=function addCSRFTknToURL(url){if(!url){return"";}var tkn=mstrmojo.getCSRFToken(url);if(tkn&&tkn.length>0){if(url.indexOf("?")>-1){url+="&";}else{url+="?";}url+="validateRandNum="+tkn;}return url;};mstrmojo.addCSRFTokenToTaskParams=function addCSRFTknToTaskParams(params){if(params){var tkn=mstrmojo.getCSRFToken();if(tkn&&tkn.length>0){params.validateRandNum=tkn;}}return params;};mstrmojo.getInstance=function getInstance(config){var Clazz=mstrmojo.hash.walk(config.scriptClass,window);if(Clazz){return new Clazz(config);}return null;};mstrmojo.isUrlExternal=function isUrlExternal(url){var curURL=window.location.href;var servletName=window.mstrApp&&mstrApp.name,taskProcName=window.mstrConfig.taskURL&&mstrConfig.taskURL,isSameWebApp=(url.indexOf("?")===0||url.indexOf(servletName)===0||url.indexOf("./"+servletName)===0||url.indexOf(taskProcName)===0||url.indexOf("./"+taskProcName)===0||url.indexOf(curURL)===0||((curURL.indexOf("?")>0)&&(url.indexOf(curURL.substring(0,curURL.indexOf("?")))===0)));return !isSameWebApp;};mstrmojo.resolveFeature=function resolveFeature(feature){var features=mstrApp.features;return features&&features[feature];};mstrmojo.getStyleRoot=function getStyleRoot(){var c=mstrConfig||{},styleRoot=c.styleRoot||"../style";return styleRoot;};mstrmojo.getJsRoot=getJsRoot;function verifyJsLoaded(name){name=name.trim();var path=name.split(".");var o=window;for(var i=0;i<path.length;i++){o=o[path[i]];if(!o){break;}}return o;}mstrmojo.invalidateJsLoaded=function invalidateJsLoaded(name){var path=name&&name.trim().split("."),len=(path&&path.length)||0,tmp=window,i;for(i=0;i<len-1;i++){if(!tmp){return ;}tmp=tmp[path[i]];}if(tmp&&path[i]){tmp[path[i]]=undefined;}};}());mstrmojo.vi.viz.EnumDSSDropZones={Reserved:0,Rows:1,Columns:2,XAxis:3,YAxis:4,BreakBy:5,SliceBy:6,ColorBy:7,SizeBy:8,AdditionalMetrics:9,Angle:10,Grouping:11,GeoAttribute:12,Layout:13,FromItem:14,ToItem:15,ItemSize:16,Latitude:17,Longitude:18,Metric:19,Trend:20};(function(){function Q(V,R,S){if(V.nodeType===3&&R){return V;}else{var U=(R&&V.nodeType===1&&V.lastChild)?V.lastChild:F(V,S);return U?D(U,S):null;}}function F(S,R){return(S===R)?null:(S.previousSibling||F(S.parentNode,R));}function D(S,R){if(S===R){return null;}if(S.nodeType===3&&I(S)){return S;}else{if(S.nodeType===1&&S.lastChild){return D(S.lastChild);}else{return D(F(S,R));}}}function I(R){return R.textContent||R.nodeValue||R.innerText;}function M(V,R,S){if(V.nodeType===3&&R){return V;}else{var U=(R&&V.nodeType===1&&V.firstChild)?V.firstChild:B(V,S);return U?E(U,S):null;}}function B(S,R){return(S===R)?null:(S.nextSibling||B(S.parentNode,R));}function E(S,R){if(S===R){return null;}if(S.nodeType===3&&I(S)){return S;}else{if(S.nodeType===1&&S.firstChild){return E(S.firstChild);}else{return E(B(S,R));}}}mstrmojo.range=mstrmojo.provide("mstrmojo.range",{EDGE:{EDGE_BEGIN:1,EDGE_END:2,EDGE_MIDDLE:-1},getEdgeInfo:function P(U,V){var R=0,S;if(U.nodeType===1){if(window.getSelection){S=document.createRange();S.selectNode(U);R=S.toString().length;}else{S=document.body.createTextRange();S.moveToElementText(U);R=S.text.length;}}else{R=I(U).length;}return V===R?this.EDGE.EDGE_END:(V===0?this.EDGE.EDGE_BEGIN:this.EDGE.EDGE_MIDDLE);},collapseOnNode:function K(V,S){if(!V.offsetParent){return ;}var U=this.getSelection(),R=this.getRange();if(window.getSelection){R.selectNodeContents(V);R.collapse(S);U.removeAllRanges();U.addRange(R);}else{R.moveToElementText(V);R.collapse(S);R.select();}},collapseOnTextNode:function L(V,W){var U=this.getSelection(),S=this.getRange();if(window.getSelection){var R=M(V,true);S.setStart(R,W);S.collapse(true);U.removeAllRanges();U.addRange(S);}else{S.moveToElementText(V);S.collapse(true);S.move("character",W);S.select();}},collapseOnTextNodeIE:function C(S,U){var V=M(S,true),R;while(V!==null){R=I(V).length;if(R>=U){this.collapseOnTextNode(V,U);break;}else{U-=R;V=M(V,false);}}},getRangeInfo:function J(Y,f){var a=null,l,d=this.getRange(),c;if(Y&&Y===d.startContainer){var h=d.startContainer.firstChild,V=h&&h.firstChild,e=V&&V.firstChild;if(e){d.setStart(e,d.startOffset);d.setEnd(e,d.endOffset);}}if(window.getSelection){var X=function(n,p,o){var m=n.cloneRange();m.collapse(o);m.setStartBefore(p);return m.toString().length;},S=d.startContainer,g=d.startOffset;if(S.nodeType===1){g=X(d,S,true);}a={collapsed:d.collapsed,startContainer:S,startOffset:f?f.startOffset:g};if(!d.collapsed){var W=d.endContainer,R=d.endOffset;if(W.nodeType===1){R=X(d,W,false);}a.endContainer=W;a.endOffset=R;}a.range=d;}else{var k,b,Z=function(p,q){var o=p.duplicate(),m=document.body.createTextRange(),n;o.collapse(q);n=o.parentElement();m.moveToElementText(n);m.setEndPoint("EndToStart",o);return{container:n,offset:m.text.length};},j=Z(d,true),U;a={collapsed:(d.compareEndPoints("StartToEnd",d)===0),startContainer:j.container,startOffset:j.offset};if(!a.collapsed){U=Z(d,false);a.endContainer=U.container;a.endOffset=U.offset;}}return a;},collapse:function O(S){if(window.getSelection){var U=this.getSelection();if(S){U.collapseToStart();}else{U.collapseToEnd();}}else{var R=this.getRange();R.collapse(S);R.select();}},selectSingleNode:function H(U){var S=this.getSelection(),R=this.getRange();if(window.getSelection){R.selectNodeContents(U);S.removeAllRanges();S.addRange(R);}else{R.moveToElementText(U);R.select();}},selectMultipleNodes:function N(X,S,Y,V){var W=this.getSelection(),U=this.getRange();if(window.getSelection){U.setStart(X,S);U.setEnd(Y,V);W.removeAllRanges();W.addRange(U);}else{X=(X.nodeType===3)?X.parentNode:X;U.moveToElementText(X);U.move("character",S);Y=(Y.nodeType===3)?Y.parentNode:Y;var R=document.body.createTextRange();R.moveToElementText(Y);R.move("character",V);U.setEndPoint("EndToStart",R);U.select();}},getSelection:function G(){if(window.getSelection){return window.getSelection();}else{return document.selection;}},getRange:function A(){if(window.getSelection){selection=window.getSelection();if(selection.rangeCount>0){return selection.getRangeAt(0);}else{return document.createRange();}}else{return document.selection.createRange();}}});}());mstrmojo.vi.controllers.EnumLayoutSelectorPosition={TOP:0,BOTTOM:1,LEFT:2};mstrmojo.mstr.EnumDSSXMLObjectSubTypes={Unknown:-1,Reserved:0,Filter:256,CustomGroup:257,Template:512,ReportGrid:768,ReportGraph:769,ReportEngine:770,ReportText:771,ReportDatamart:772,ReportBase:773,ReportGridAndGraph:774,ReportNonInteractive:775,ReportCube:776,ReportIncrementalRefresh:777,ReportTransaction:778,ReportEmmaCube:779,ReportEmmaIncrementalRefresh:780,Metric:1024,SubtotalDefinition:1025,SystemSubtotal:1026,MetricDMX:1027,DssSubTypeMetricTraining:1028,Style:1536,AggMetric:1792,Folder:2048,Device:2304,Prompt:2560,PromptBoolean:2561,PromptLong:2562,PromptString:2563,PromptDouble:2564,PromptDate:2565,PromptObjects:2566,PromptElements:2567,PromptExpression:2568,PromptExpressionDraft:2569,PromptDimty:2570,PromptBigDecimal:2571,Function:2816,Attribute:3072,AttributeRole:3073,AttributeTransformation:3074,AttributeAbstract:3075,AttributeRecursive:3076,Fact:3328,DimensionSystem:3584,DimensionUser:3585,DimensionOrdered:3586,DimensionUserHierarchy:3587,Table:3840,TablePartitionMD:3841,TablePartitionWH:3842,DatamartReport:4096,FactGroup:4352,Resolution:4864,AttributeForm:5376,FormSystem:5377,FormNormal:5378,Schema:5632,Format:5888,Catalog:6144,CatalogDefn:6400,Column:6656,PropertyGroup:6912,PropertySet:7168,DBRole:7424,DBRoleDataImport:7425,DBRoleOAuth:7427,DBRoleGenericDataConnector:7430,DBLogin:7680,DBConnection:7936,Project:8192,ServerDef:8448,User:8704,UserGroup:8705,Transmitter:8705,Configuration:9216,Request:9472,Search:9984,SearchFolder:10240,Datamart:10496,FunctionPackageDefinition:10752,Role:11008,RoleTransformation:11009,SecurityRole:11264,InBox:11520,InBoxMsg:11776,Consolidation:12032,ConsolidationManaged:12033,ConsolidationElement:12288,ScheduleEvent:12544,ScheduleObject:12800,ScheduleTrigger:13056,Link:13312,DBTable:13568,DBTablePMT:13569,TableSource:13824,DocumentDefinition:14080,ReportWritingDocument:14081,DocumentTheme:14082,DrillMap:14336,DBMS:14592,MDSecurityFilter:14848,MonitorPerformance:15104,MonitorJobs:15105,MonitorUserConnections:15106,MonitorDBConnections:15107,PromptAnswer:15232,PromptAnswers:15360,PromptAnswerBoolean:15233,PromptAnswerLong:15234,PromptAnswerString:15235,PromptAnswerDouble:15236,PromptAnswerDate:15237,PromptAnswerObjects:15238,PromptAnswerElements:15239,PromptAnswerExpression:15240,PromptAnswerExpressionDraft:15241,PromptAnswerDimty:15242,PromptAnswerBigDecimal:15243,PromptAnswerInt64:15244,GraphStyle:15616,ChangeJournalSearch:15872,BlobUnknown:16128,BlobOther:16129,BlobImage:16130,BlobProjectPackage:16131,BlobExcel:16132,BlobHTMLTemplate:16133,DashboardTemplate:16384,Flag:16640,ChangeJournal:16896,ExternalShortcutUnknown:17152,ExternalShortcutURL:17153,ExternalShortcutSnapshot:17154,ExternalShortcutTarget:17408,Reconciliation:17664,DerivedAttribute:3077,PaletteSystem:17920,PaletteCustom:17921,Thresholds:18432,SubscriptionAddress:65281,SubscriptionContact:65282,SubscriptionInstance:65283};mstrmojo.warehouse.EnumObjectTypes={FILTER:1,METRIC:4,ATTRIBUTE:12,FACT:13,DIMENSION:14,TABLE:15,TABLE_LOGICAL_VIEW:151,TABLE_PARTITION:152,FORM:21,COLUMN:26,DBROLE:29,PROJECT:32,TRANSFORMATION:43,DBTABLE:53,LAYER:70,RELATIONSHIP:99,COMPOUND_FORM:1001,RELATIONSHIP_ATTRIBUTE:1002};mstrmojo.chart.model.enums.EnumDSSXMLAxesBitMap={DssXmlAxisNone:0,DssXmlAxisRowsBit:1,DssXmlAxisColumnsBit:2,DssXmlAxisPagesBit:4,DssXmlAxisChaptersBit:8};(function(){mstrmojo.vi._MonitorsAppState=mstrmojo.provide("mstrmojo.vi._MonitorsAppState",{onAppStateChange:function(B){if(this._super){this._super(B);}},init:function A(B){this._super(B);if(mstrApp.attachEventListener){mstrApp.attachEventListener("appStateChange",this.id,"onAppStateChange");}}});}());(function(){mstrmojo.vi.ui._MonitorsTocPage=mstrmojo.provide("mstrmojo.vi.ui._MonitorsTocPage",{tocPanel:null,currentLayoutKey:undefined,currentPanelKey:undefined,onTocPageChange:function(B){if(B.value){this.currentLayoutKey=B.value.layoutKey;this.currentPanelKey=B.value.panelKey;}if(this._super){this._super(B);}},init:function A(B){this._super(B);if(!this.tocPanel){throw new Error("You must pass the tocPanel when instantiating mstrmojo.vi.ui._MonitorsTocPage.");}if(this.tocPanel.attachEventListener){this.tocPanel.attachEventListener("displayPageInfoChange",this.id,"onTocPageChange");}}});}());mstrmojo.vi.viz.EnumWidgetTypes={GRID:0,GRAPH_MATRIX:1,HEATMAP:2,NETWORK:3,IMAGELAYOUT:4,ESRIMAP:5,GOOGLEMAP:6,CUSTOM:7,MAPBOX:8,KPICARD:9};mstrmojo.mstr.EnumNodeProperties={NORMAL:0,DRILL:1,CONDITION:2};(function(){function B(L,Q,N){var M,O;M=0;if(N){M=Math.max(L,L-Q);M=Math.max(M,-Q);}else{M=L-Q;}if(M===0){this.mIsShown=false;return 1;}var P=M;O=1;while(M<1){M*=10;O/=10;}while(M>=10){M/=10;O*=10;}if(M<1.8){O*=2;O/=10;}else{if(M<3.1){O*=4;O/=10;}else{if(M<4.6){O*=5;O/=10;}else{if(M>=8.1){O*=2;}}}}return O;}function K(P){var L,N;this.mStep=B.call(this,this.mMaximum,this.mMinimum,P.mAlwaysIncludeZero);this.mMaxTick=Math.ceil(this.mMaximum/this.mStep)*this.mStep;this.mMinTick=Math.floor(this.mMinimum/this.mStep)*this.mStep;this.mMinTick=(this.mMinTick*this.mMinimum<0)?0:this.mMinTick;if(P.mAlwaysIncludeZero){this.mMaxTick=(this.mMaximum<0)?0:this.mMaxTick;this.mMinTick=(this.mMinimum>0)?0:this.mMinTick;}var M=this.mMaxTick-this.mMinTick;if(this.mStep>=M){return ;}L=Math.floor((this.mMaxTick-this.mMinTick+this.mStep/100)/this.mStep)+1;for(N=1;N<L-1;++N){var O=this.mMinTick+N*this.mStep;this.mTicks.push(O);}}function C(M){var L;this.mMaxTick=1;this.mStep=this.mMinimum<0?0.2:0.1;if(M.mUseCustomMinMax){this.mMaxTick=M.mAxisMaxValue;this.mMinTick=M.mAxisMinValue;this.mMaxTick=Math.min(1,this.mMaxTick);this.mMinTick=Math.max(-1,this.mMinTick);this.mStep=0.1;}else{if(this.mMaximum>=0.5){this.mMaxTick=1;this.mMinTick=Math.floor(this.mMinimum/this.mStep)*this.mStep;this.mMinTick=(this.mMinTick*this.mMinimum<0)?0:(this.mMinTick>0?0:this.mMinTick);if(this.mMinimum<-0.5){this.mMinTick=-1;}}else{if(this.mMaximum>0){this.mMaxTick=Math.ceil(this.mMaximum/this.mStep)*this.mStep;this.mMinTick=-1;}else{this.mStep=0.1;this.mMaxTick=0;this.mMinTick=-1;}}}for(L=this.mMinTick+this.mStep;L+0.01<this.mMaxTick;L+=this.mStep){this.mTicks.push(Math.round(L*100)/100);}}function I(L){return Math.log(L)/Math.log(10);}function H(O){var N,L,M;this.mStep=1;if(this.mMaximum<=0){this.mMinTick=1;this.mMaxTick=10;return ;}if(this.mMinimum<=0){L=this.mMaximum>1?0:-1;this.mMinTick=Math.pow(10,L);if(O.mUseCustomMinMax){this.mMaxTick=this.mMaximum;N=Math.floor(I.call(this,this.mMaximum));if(I.call(this,this.mMaximum)===N){N--;}}else{N=Math.ceil(I.call(this,this.mMaximum));this.mMaxTick=Math.pow(10,N);}for(M=L+1;M<N;++M){this.mTicks.push(Math.pow(10,Math.floor(M)));}return ;}if(O.mUseCustomMinMax){N=I.call(this,this.mMaximum);L=I.call(this,this.mMinimum);this.mMaxTick=this.mMaximum;this.mMinTick=this.mMinimum;}else{N=Math.ceil(I.call(this,this.mMaximum));L=Math.floor(I.call(this,this.mMinimum));this.mMaxTick=Math.pow(10,N);this.mMinTick=Math.pow(10,L);}for(M=L+1;M<N;++M){this.mTicks.push(Math.pow(10,Math.floor(M)));}}function J(L){this.mTicks.splice(0,this.mTicks.length);if(this.mIsPercent){return C.call(this,L);}if(L.mUseLogarithmicScale){return H.call(this,L);}K.call(this,L);}function G(Q){if(Q.mUseCustomMinMax||Q.mUseLogarithmicScale){return ;}var M=0.1,O=false,L=false,P=[];this.GetTicks(P);if(P.length>=2){var N=P.length;L=((Math.abs(this.mMaximum-P[N-2])<M*this.mStep));O=((Math.abs(this.mMinimum-P[1])<M*this.mStep));if(this.mIsPercent){L=false;}}if(L&&O){this.mMinTick=this.mMinimum;this.mMaxTick=this.mMaximum;Q.mUseMinValue=Q.mShowMinLabel=true;Q.mUseMaxValue=Q.mShowMaxLabel=true;}else{if(L){this.mMaxTick=this.mMaximum;Q.mUseMaxValue=Q.mShowMaxLabel=true;}else{if(O){this.mMinTick=this.mMinimum;Q.mUseMinValue=Q.mShowMinLabel=true;}else{}}}if(Q.mAlwaysIncludeZero){this.mMaxTick=(this.mMaximum<0)?0:this.mMaxTick;this.mMinTick=(this.mMinimum>0)?0:this.mMinTick;}}mstrmojo.chart.common.ScalePlate=mstrmojo.provide("mstrmojo.chart.common.ScalePlate",{mOptions:{mShowMinLabel:true,mShowMaxLabel:true},isStackedChart:false,mStep:0,mIsPercent:false,mMinimum:0,mMaximum:0,mMaxTick:0,mMinTick:0,mTicks:[],clear:function F(){this.isStackedChart=this.mIsPercent=false;this.mMinimum=this.mMaximum=0;this.mMinTick=this.mMaxTick=0;this.mStep=0;this.mTicks=[];},GetTicks:function A(M){if(this.mOptions.mShowMinLabel){M.push(this.mMinTick);}var L;for(L=0;L<this.mTicks.length;++L){M.push(this.mTicks[L]);}if(this.mOptions.mShowMaxLabel){M.push(this.mMaxTick);}},getMaxMinTickValue:function D(O,N,L,M){this.computeTicks(O,N,L,M);return{Max:this.mMaxTick,Min:this.mMinTick};},computeTicks:function E(Q,P,L,N){this.mMinimum=N;this.mMaximum=L;this.mIsPercent=!!(P&1);this.isStackedChart=!!(P&2);var O=1e-14;if(!Q.mUseLogarithmicScale&&this.isStackedChart){this.mMinimum=Math.min(this.mMinimum,0);this.mMaximum=Math.max(this.mMaximum,0);}if(Q.mDrawCustomLine){this.mMinimum=Math.min(this.mMinimum,Q.mAxisCustomValue);this.mMaximum=Math.max(this.mMaximum,Q.mAxisCustomValue);}if(this.mIsPercent&&this.mMinimum===this.mMaximum&&1===this.mMaximum){if(this.mMinimum===1){this.mMinimum=0;}}if(Math.abs(this.mMinimum-this.mMaximum)<O){if(this.mMinimum<-O||this.mMinimum>O){var M=Math.abs(this.mMinimum)*0.5;this.mMaximum=this.mMaximum+M;this.mMinimum=this.mMinimum-M;}else{this.mMinimum=-6;this.mMaximum=6;}}J.call(this,Q);if(Q.mUseLogarithmicScale&&this.isStackedChart){this.mMaximum=Q.mDrawCustomLine?Math.max(this.mMaximum+this.mMinTick,Q.mAxisCustomValue):this.mMaximum+this.mMinTick;this.mMinimum=Math.min(this.mMinimum,0);this.mTicks.splice(0,this.mTicks.length);H.call(this,Q);}G.call(this,Q);}});}());(function(){mstrmojo.boxmodel=mstrmojo.provide("mstrmojo.boxmodel",{rangeIntersect:function E(J,H,I,G){if(J<I){return I<=H;}if(J>I){return J<=G;}return true;},px2Inches:function C(H,G){G=parseInt(G,10);return mstrmojo.NumberFormat.getInstance(mstrConfig.decimalSep,mstrConfig.thousandsSep).format(parseFloat((G/H.zf/H.dpi).toFixed(4)));},offset:function F(I,H){var L=I,G=0,K=0;while(I){G+=I.offsetLeft;K+=I.offsetTop;I=I.offsetParent;if(I===H){break;}}var J;for(J=L&&L.parentNode;J&&J!==H;J=J.parentNode){if(J.scrollTop){K-=J.scrollTop;}if(J.scrollLeft){G-=J.scrollLeft;}}return{left:G,top:K};},convert2px:function D(K,I){if(!/px$/.test(I)){var H=document.createElement("img"),G=H.style,J;G.zIndex=-1;G.left=I;K.appendChild(H);J=G.pixelLeft;K.removeChild(H);return J+"px";}return I;},getEdgeQuadrantByPoint:function B(I,H){var G=H.x-I.x,M=H.y-I.y,J=I.w,L=I.h,K=[["Left","Bottom"],["Top","Right"]];if(M>L/J*G){K=K[0];}else{K=K[1];}return(M<-L/J*G+L)?K[0]:K[1];},isPtInPolygon:function A(I,K){var G=I.x,J=I.y,H=false;K.forEach(function(N,L){var M=K[L-1]||K[K.length-1];if((N.y>=J)!==(M.y>=J)){if((G<(M.x-N.x)*(J-N.y)/(M.y-N.y)+N.x)){H=!H;}}});return H;}});}());mstrmojo.vi.enums.EnumFilterClearActionType={CLEAR_ALL:0,CLEAR_KEEP_ONLY:1,CLEAR_ADV_QUALIFICATION:2,CLEAR_LINKING:3,CLEAR_KEEP_ONLY_AND_LINKING:4,CLEAR_DRILLING:5};(function(){mstrmojo.mstr.search._IconCssClassBuilder=mstrmojo.provide("mstrmojo.mstr.search._IconCssClassBuilder",{_mixinName:"mstrmojo.mstr.search._IconCssClassBuilder",getIconCssClass:function A(B){B=B||this.data;return B.ccss||("t"+B.t+(B.st?" st"+B.st:"")+(B.isc?" isc":"")+(B.dvm?" dvm"+B.dvm:""));}});}());mstrmojo.EnumRWUnitType={LAYOUT:0,HEADER:2,FOOTER:3,SUBSECTION:4,DETAILS:5,PAGEHEADER:6,PAGEFOOTER:7,PANELSTACK:8,PANEL:9,UNITCONTAINER:11,GRID:521,GRAPH:522,GRIDGRAPH:527,RECTANGLE:101,IMAGE:102,LINE:105,TEXTFIELD:106,HTMLCONTAINER:107,SELECTOR:111,ROUNDEDRECTANGLE:112,VISUALIZATION:114,MOJOVISUALIZATION:115};(function(){var A=/^mstrmojo./;mstrmojo.DynamicClassFactory={newComponent:function(C,B,F){var H=C.prototype.scriptClass.replace(A,"");for(var E=0,D=B&&B.length||0;E<D;E++){if(!B[E]._mixinName){throw new Error('Mixins must have a "_mixinName" property to be used with DynamicClassFactory');}H+="_"+B[E]._mixinName.replace(A,"");}var G=mstrmojo[H];if(!G){G=mstrmojo.declare(C,B,F);mstrmojo[H]=G;}return G;}};}());(function(){var B=1,C=2,A=4;mstrmojo._IsThresholdConditionTarget=mstrmojo.provide("mstrmojo._IsThresholdConditionTarget",{_mixinName:"mstrmojo._IsThresholdConditionTarget",update:function D(G){var E=G.data.tta;var F=(E&B)>0,H=(E&C)>0;if(F&&this.preservedEnabled===undefined){this.preservedEnabled=!!this.enabled;}if(H&&this.preservedVisible===undefined){this.preservedVisible=!!this.visible;}this.set("enabled",F?false:this.preservedEnabled!==undefined?this.preservedEnabled:this.enabled);this.set("visible",H?false:this.preservedVisible!==undefined?this.preservedVisible:this.visible);this.set("required",(E&A)>0);if(this._super){this._super(G);}}});}());mstrmojo.kpicard.KPICardEnum={};mstrmojo.kpicard.KPI_PROPERTIES={SHOW_METRIC_NAME:"smn",AUTO_PLAY:"ap",DISPLAY_MODE:"dm",KPI_STYLE:"ks",FONT:"fts",NEW_FONT:"nfts",UNIFY_TEXT_SIZE:"uts",TEXT_SIZE_TYPE:"tst",UNIFY_STEPS:"us",PREVIOUS_METRIC_NAME:"pmn",BADGE_MODE:"bm",INCREASE_BG_COLOR:"ibc",DECREASE_BG_COLOR:"dbc",COLOR_THRESHOLDS:"cts",CURRENT_SLIDE_ELEMENT:"cse",FIX_CARD_HEIGHT:"fch",CARD_HEIGHT:"ch",GRID_COLUMN_COUNT:"gcc",CUSTOM_KPI_STYLE:"cks",};mstrmojo.kpicard.TEXT_SIZE_TYPE={UNIFIED:"0",FIT_TO_CONTAINER:"1",FIXED:"2",};mstrmojo.kpicard.DISPLAY_MODE={STACKED:"1",DEFAULT:"2",HORIZONTAL:"3",VERTICAL:"4",GRID:"5"};mstrmojo.kpicard.BADGE_MODE={NONE:"1",PERCENTAGE:"2",VALUE:"3"};mstrmojo.kpicard.KPI_STYLES={LIGHT:"1",NIGHT:"2",DESERT:"3",OCEAN:"4",};mstrmojo.kpicard.KPI_STYLES_CONFIG={};mstrmojo.kpicard.KPI_STYLES_CONFIG[mstrmojo.kpicard.KPI_STYLES.LIGHT]={bgColor:"#ffffff",bgOpacity:1,chartColor:"#F1F1F1",chartOpacity:1};mstrmojo.kpicard.KPI_STYLES_CONFIG[mstrmojo.kpicard.KPI_STYLES.NIGHT]={bgColor:"#313855",bgOpacity:1,chartColor:"#539CAE",chartOpacity:1};mstrmojo.kpicard.KPI_STYLES_CONFIG[mstrmojo.kpicard.KPI_STYLES.DESERT]={bgColor:"#606060",bgOpacity:1,chartColor:"#FFD333",chartOpacity:1};mstrmojo.kpicard.KPI_STYLES_CONFIG[mstrmojo.kpicard.KPI_STYLES.OCEAN]={bgColor:"#5181D7",bgOpacity:1,chartColor:"#83C8F4",chartOpacity:1};mstrmojo.kpicard.DEFAULT_PROPS={smn:"false",ap:"true",dm:"2",ks:"1",fts:"Arial",uts:"true",us:"0",bm:"2",ibc:"#83C962",dbc:"#DB6657",fch:"false",ch:"0",gcc:"4",tst:mstrmojo.kpicard.TEXT_SIZE_TYPE.UNIFIED,};mstrmojo.kpicard.SINGLE_METRIC_DISPLAY_MODE={HORIZONTAL:0,VERTICAL:1};mstrmojo.kpicard.KPI_TEMPLATE_MODE={ONLY_METRIC:0,METRIC_WITH_TREND:1,METRIC_WITH_BREAKBY:2,METRIC_WITH_TREND_AND_BREAKBY:3};mstrmojo.kpicard.CAN_SET_FONT_PARTS={LABEL:"label",PRIMARY_VALUE:"primary_value",PREVIOUS_VALUE:"previous_value",TREND_IDENTITY:"trend_identity",};mstrmojo.kpicard.CARDLIMIT=80;mstrmojo.kpicard.NEW_STYLE_MARGIN=4;mstrmojo.kpicard.SELECTION_BORDER_COLOR="#3B92ED";mstrmojo.warehouse.EnumDatabaseType={SAP:1200,MSAS:1500,EssBase:1600,TM1:2900,SAPHana:4000,BDE:5400,SearchEngineSOLR:5500,Hive:3100,Impala:4100,SearchEngineSPLUNK:5600,Pig:6400,PHOENIX:6800,IBMBigInsights:700,Drill:7300,DB_TYPE_NEWDB_1:8100,DB_TYPE_NEWDB_5:8500,AzureCosmosDB:8700};mstrmojo.EnumAuthenticationModes={DEFAULT:0,STANDARD:1,NTCREDENTIAL:2,PASSTHRU:4,ANONYMOUS:8,LDAP:16,DATABASE:32,PLUGIN:64,INTEGRATED:128,USHER:256};mstrmojo.VisEnum={ControlType:{BUTTON:"button",LASSO_SELECTOR:"lasso-selector",LASSO_RESIZER:"lasso-resizer",SPLITTER:"splitter",GM_ROW_HEADER:"rh",GM_ROW_HEADER_TEXT:"rhtext",GM_ROW_HEADER_EXTRA:"rhext",GM_COL_HEADER:"ch",GM_COL_HEADER_TEXT:"chtext",GM_COL_HEADER_EXTRA:"chext",GM_YAXIS:"y",GM_XAXIS:"x",GM_YLABEL:"y-label",GM_XLABEL:"x-label",GM_ROW_HEADER_TITLE:"rht",GM_ROW_HEADER_TITLE_TEXT:"rhttext",GM_COL_HEADER_TITLE:"cht",GM_COL_HEADER_TITLE_TEXT:"chttext",GM_MINI_CHART:"chart",GM_TEXT_BODY:"text-body",GM_SHAPE:"shape",GM_MARKER:"marker",GM_SET_SHAPE:"set-shape",GM_YAXIS2:"y2",GM_XAXIS2:"x2",GM_TREND_LINE:"trendLine",GM_TREND_LINE_HOVER:"trendLineHover",GM_TREND_LINE_SELECT:"trendLineSelect",GM_REF_LINE:"referenceLine",GM_REF_LINE_HOVER:"referenceLineHover",GM_REL_LINE_SELECT:"referenceLineSelect",GM_HIGHLIGHT_BOX:"highlight-box",GM_AXIS_TEXT:"axis-text",GM_AXIS_WORD:"axis-word",GM_SVG_X_NUMERIC:"svg-x-numeric",GM_SVG_X_CATEGORY:"svg-x-category",GM_SVG_Y_NUMERIC:"svg-y-numeric",GM_SVG_Y_CATEGORY:"svg-y-category",GM_X_NUMERIC:"x-numeric",GM_X_CATEGORY:"x-category",GM_Y_NUMERIC:"y-numeric",GM_Y_CATEGORY:"y-category",GM_SVG_CHART:"svg-chart",GM_DATA_LABEL:"data-label",GM_YAXIS_LINE:"y-line",GM_XAXIS_LINE:"x-line",GM_YAXIS2_LINE:"y2-line",GM_XAXIS2_LINE:"x2-line",LGD_TITLE:"lgd-title",LGD_TEXT:"lgd-text",LGD_COLORBOX:"lgd-colorbox",LGD_COLORBOX_CTN:"lgd-colorbox-ctn",LGD_CANVAS:"lgd-canvas",LINE_CONTAINER:"line-ctn",GM_V_MATRIX_LINE:"v-line",GM_H_MATRIX_LINE:"h-line",GM_V_CHART_LINE:"v-ctline",GM_H_CHART_LINE:"h-ctline",GM_CHART_ROW:"ct-row",GM_CHART_COL:"ct-col",GM_H_GRID_LINE:"h-gline",GM_V_GRID_LINE:"v-gline",GM_H_MINOR_GRID_LINE:"h-gline-minor",GM_V_MINOR_GRID_LINE:"v-gline-minor",GM_ORIGIN_LINE:"originLine",GM_ORIGIN_LABEL:"origin-label",GM_ORIGIN_LINE_H:"origin-line-h",GM_ORIGIN_LINE_V:"origin-line-v",GM_ORIGIN_LABEL_H:"origin-label-h",GM_ORIGIN_LABEL_V:"origin-label-v",GM_DUMMY_A:"dummy-a",GM_V_EXTRA_LINE:"v-extra-line",GM_REF_LABEL:"ref-label",GM_RIGHT_BORDER:"border-r",GM_BOTTOM_BORDER:"border-b",KPI_V_SCROLLBAR:"kpi-vertical-scrollbar",KPI_H_SCROLLBAR:"kpi-horizontal-scrollbar"},GMDropZoneID:{ROWS:1,COLUMNS:2,XAXIS:3,YAXIS:4,BREAKBY:5,SLICEBY:6,COLORBY:7,SIZEBY:8,TOOLTIP:9,ANGLEBY:10},NETWORK_LOCAL_PROPS:{ZOOM_FACTOR:"zf",NODE_POSITION:"np"},NETWORK_PROPERTIES:{showLegend:"showLegend",showEdgeDirection:"showedgearrow",showTransition:"animatelayout",nodeSizeAggregation:"nodesizeaggfunc",minNodeSize:"minns",maxNodeSize:"maxns",themeType:"th",circleLabelFont:"BubFnt",modifiedNodes:"mn",layoutMode:"layout",legendPosition:"legendposition",dragMode:"mode",bubbleStyle:"bbs",propsCategory:"pc",lgdBgFillClr:"lgdBgFillClr",lgdBgFillTrans:"lgdBgFillTrans",lgdFntClr:"lgdFntClr",lgdFntSz:"lgdFntSz",lgdFntFml:"lgdFntFml",lgdFntStyle:"lgdFntStyle"},NETWORK_LAYOUT:{CIRCULAR:"circular",LINEAR:"linear",FORCE_DIRECTED:"forceDirected"},NETWORK_DRAG_MODE:{pan:0,select:1},NETWORK_AGGREGATION_METHOD:{"Count of":0,"Sum of":1,"Average of":2,"Min of":3,"Max of":4},NETWORK_MIN_NODE_SIZE_TYPE:{PROPORTIONAL:1,FULL_RANGE:2,ADJUSTED_RANGE:3},NETWORK_MAX_NODE_SIZE_TYPE:{AUTOMATIC:1,MANUAL:2},NETWORK_FORCE_DIRECTED_LAYOUT_EDGE_CURVATURE:[0,0.2],HEATMAP_PROPERTIES:{showLegend:"showLegend",deleteButton:"ed",showMetricValues:"mv",labelSize:"lb",layout:"la",themeType:"th",headerType:"he",deletedList:"dl",refreshType:"rt",metricList:"ml",colorByType:"cbt",absoluteFixed:"abs",blendColor:"blc",background:"bg",legendBackground:"lbg",headerColors:"hcl",fonts:"fts",propsCategory:"pc",attrColorByOpacity:"acbo",metricColorByOpacity:"mcbo"},HEATMAP_LABEL_SIZE:{On:0,Off:1,Proportional:2},MAPS_PROPERTIES:{SHOW_LEGEND:"showLegend"},VIS_CARDLIMIT:{GRID:250,NON_GRID:8000,AREA_MAP:1000},GMLegendDataType:{COLOR_BY:1,SIZE_BY:2},GMLegendFormatingPropertyTag:{LEGEND_BG_COLOR:"lgdBgFillClr",LEGEND_BG_FILL_STYLE:"lgdBgFillStyle",LEGEND_BG_FILL_EFFECT:"lgdBgFillEff",LEGEND_BG_FILL_TRANSPARENCY:"lgdBgFillTrans",LEGEND_FONT_SIZE:"lgdFntSz",LEGEND_FONT_FAMILY:"lgdFntFml",LEGEND_FONT_STYLE:"lgdFntStyle",LEGEND_FONT_COLOR:"lgdFntClr",LEGEND_BORDER_SHOW:"lgdBdrShw",LEGEND_BORDER_COLOR:"lgdBdrClr",LEGEND_BORDER_THICKNESS:"lgdBdrThk",LEGEND_BORDER_LINE_STYLE:"lgdBdrStyle",LEGEND_BORDER_LINE_COMBINED_STYLE:"lgdBdrCmbStyle",COLOR_SQUARE_COLOR:"clrSqrClr"},LegendPropertyTag:{LEGEND_MODE:"lm",LEGEND_POSITION:"LegendPosition",SCALE_LEGEND_WIDTH:"lwr"},EnumLegendMode:{RESTORED:1,MINIMIZED:2},EnumSingleLegendMode:{RESTORE:1,COLLAPSE:2},EnumColorRankMode:{INVALID:-1,VALUE:0,TOP:1,BOTTOM:2,TOP_PERCENT:3,BOTTOM_PERCENT:4},FormNameDisplayType:{OFF:0,ON:1,FORM_NAME_ONLY:2,SHOW_ATT_NAME_ONCE:3,AUTO:4},SERVER_JSON_ERROR_TYPE:{EMPTY_DATA:0,NO_DATASET:1,AE_ERROR:2,NO_TEMPLATE_UNIT:3},NETWORK_CIRCLE_BORDER_WIDTH:8,IMAGELAYOUT_PROPERTIES:{DISPLAY_MODE:"mt",MAX_SIZE_TYPE:"ty",MAX_SIZE_VALUE:"val",MIN_SIZE_TYPE:"mst",MIN_SIZE_VALUE:"msv",MAP_FILE_PATH:"mf",SHAPE_FILL_OPC_PER:"shapeFillTrans",SHAPE_FILL_COLOR:"shapeClr",SHAPE_BORDER_STYLE:"shapeBorderCmbStyle",SHAPE_BORDER_COLOR:"shapeBorderClr",DATA_LABEL_SWITCH:"dls",DATA_LABEL_FONT_SIZE:"dlFntSz",DATA_LABEL_FONT_FAMILY:"dlFntFml",DATA_LABEL_FONT_COLOR:"dlFntClr",DATA_LABEL_FONT_STYLE:"dlFntStyle",BLANK_MAP_BORDER_STYLE:"blankMapBorderStyle",BLANK_MAP_BORDER_COLOR:"blankMapBorderClr",BLANK_MAP_COLOR:"blankMapClr",DEFAULT_MAP_COLOR:"dftMapClr",DEFAULT_BUBBLE_COLOR:"dftBubbleClr",DEFAULT_MAP_BORDER_COLOR:"dftMapBorderClr",DEFAULT_BUBBLE_BORDER_COLOR:"dftBubbleBorderClr",LEGEND_FONT_SIZE:"lgFntSz",LEGEND_FONT_FAMILY:"lgFntFml",LEGEND_FONT_COLOR:"lgFntClr",LEGEND_FONT_STYLE:"lgFntStyle",LEGEND_BACKGROUND_COLOR:"lgBgClr",LEGEND_OPC_PER:"lgBgFillTrans",LEGEND_POSITION:"lgPos",LEGEND_SHOW:"lgShow",LEGEND_MODE:"lgMode",LEGEND_SCALE:"lgScale",H_MATRIX_LINE_COLOR:"hMatrixLnClr",V_MATRIX_LINE_COLOR:"vMatrixLnClr",ALL_MATRIX_LINE_COLOR:"allMatrixLnClr",H_MATRIX_LINE_STYLE:"hMatrixLnCmbStyle",V_MATRIX_LINE_STYLE:"vMatrixLnCmbStyle",ALL_MATRIX_LINE_STYLE:"allMatrixLnCmbStyle"}};mstrmojo.chart.model.enums.EnumDSSBaseFormType={DssBaseFormReserved:0,DssBaseFormDateTime:1,DssBaseFormNumber:2,DssBaseFormText:3,DssBaseFormPicture:4,DssBaseFormUrl:5,DssBaseFormEmail:6,DssBaseFormHTMLTag:7,DssBaseFormDate:8,DssBaseFormTime:9,DssBaseFormSymbol:10,DssBaseFormBigDecimal:11};(function(){function Z(c){var d=[].slice.call(c),e=d[d.length-1],f=function(h,g){return h===g;};if(/function|string/.test(typeof e)){f=typeof e==="function"?e:function(h,g){return h[e]===g[e];};d=d.slice(0,d.length-1);}return{sets:d,compareFunc:f};}mstrmojo.array=mstrmojo.provide("mstrmojo.array",{indexOf:function D(d,f){var c=(d&&d.length)||0,e;for(e=0;e<c;e++){if(d[e]==f){return e;}}return -1;},indexOfMulti:function V(c,d){var h=[],g={},f=0,e=this;e.forEach(c,function(k,j){e.forEach(d,function(l,m){var n=(l===k);if(n){h[m]=g[m]=j;f++;}return !n;});});return{indices:h.length?h:null,map:g,count:f};},forEach:function S(d,j,g){var c=(d&&d.length)||0,e;for(e=0;e<c;e++){var h=e===(c-1);if(g){if(j.call(g,d[e],e,d,h)===false){break;}}else{if(j(d[e],e,d,h)===false){break;}}}return d;},map:function a(d,h){var c=(d&&d.length)||0,e=[],g;for(g=0;g<c;g++){e[g]=h(d[g],g);}return e;},filter:function J(e,f,g){var k=[],j=0,d=(e&&e.length)||0,c=(g&&g.max)||0,h;for(h=0;h<d;h++){if(f(e[h],h,e)){k[j]=e[h];j++;if(c&&j>=c){break;}}}return k;},filterOne:function M(c,d){var e=this.filter(c,d,{max:1});if(e.length){return e[0];}return null;},ensureArray:function Q(c){return[].concat(c||[]);},find:function N(d,h,e){var c=(d&&d.length)||0,f;for(f=0;f<c;f++){var g=d[f];if(g&&g[h]==e){return f;}}return -1;},distinct:function B(d,h){if(d.reduce&&!h){return d.reduce(function(k,j){if(k.indexOf(j)<0){k.push(j);}return k;},[]);}var c=(d&&d.length)||0,e,g,f=[];for(e=0;e<c;e++){g=d[e];if((g!==undefined)&&((h&&this.find(f,h,g[h])<0)||(!h&&this.indexOf(f,g)<0))){f.push(g);}}return f;},findBin:function E(e,k,n,d){var j=(d||e.length)-1,f=0,c,g=k[n];while(j-f>1){if(e[c=j+f>>1][n]<g){f=c;}else{j=c;}}if(e[f][n]===g){return f;}return e[j][n]===g?j:-1;},search:function I(n,f,j){var g=n.length,e=-1,d,k=f.toUpperCase(),c=f.length;while(g-e>1){if(n[d=g+e>>1][j].substr(0,c).toUpperCase()<k){e=d;}else{g=d;}}return g;},findMulti:function R(l,e,o){if(!o){return{indices:null,map:{},count:0};}var m=o.length,r=[],d={},p=0,g=(l&&l.length)||0,h;for(h=0;h<g;h++){var q=l[h][e],f;for(f=0;f<m;f++){if(o[f][e]===q){r[f]=h;d[f]=h;p++;break;}}}return{indices:r,map:d,count:p};},removeItem:function Y(c,e){var d=this.indexOf(c,e);if(d>-1){this.removeIndices(c,d,1);}return d;},removeItems:function O(c,h,d){var e=this.findMulti(c,h,d);if(e.count){var g=e.indices.concat().sort(this.numSorter).slice(0,e.count),f;for(f=g.length-1;f>-1;f--){c.splice(g[f],1);}}},numSorter:function b(d,c){return Number(d)-Number(c);},stringSorter:function K(e,d){var c=e.toLowerCase(),f=d.toLowerCase();if(c<f){return -1;}if(c>f){return 1;}return 0;},removeIndices:function P(c,e,d){c.splice(e,d);},insert:function F(d,c,e){if(!d){d=[];}if(c===null||c===undefined){c=d.length;}Array.prototype.splice.apply(d,[c,0].concat(e));return d;},hash:function C(d,f){f=f||{};var c=(d&&d.length)||0,e;for(e=0;e<c;e++){f[d[e]]=true;}return f;},get:function W(d,g){if(!g){return null;}var e=[],c=g.length,f;for(f=0;f<c;f++){e[f]=d[g[f]];}return e;},deepSortArr:function G(d,f,c,e){return d.sort(function(j,g){var k=j[c][f],h=g[c][f];if(!e){return(k<=h);}return(k>h)?-1:1;});},isArray:function(c){var d=Array.isArray;if(d){return d(c);}return Object.prototype.toString.call(c)==="[object Array]";},some:function L(d,e){if(!d){return false;}if(d.some){return d.some(e);}var c=false;this.forEach(d,function(g,f){c=e(g,f,d);return !c;});return c;},difference:function X(){if(arguments.length<2){throw new Error("difference should get at least 2 parameters");}var f=Z(arguments),d=f.sets,e=f.compareFunc,g=d[0],c=[].concat.apply([],d.slice(1));return g.filter(function(h){return !c.some(function(j){return e(h,j);});});},intersection:function U(){if(arguments.length<2){throw new Error("intersection should get at least 2 parameters");}var g=Z(arguments),e=g.sets,f=g.compareFunc,c=e[0],d=e.slice(1);d.forEach(function(h){c=c.filter(function(j){return h.some(function(k){return f(j,k);});});});return c;},fnReduceNumber:function A(c,d){return c+d;},applyLargeArray:function H(f,j,l,m){var g=f.length,k=1000,c,d,e,h=l;if(g){for(c=0,d=k;c<g;c=d,d+=k){e=j.apply(m,f.slice(c,d));h=j.apply(m,[h,e]);}}else{h=j.apply(m,f);}return h;}});}());mstrmojo.chart.model.enums.EnumDSSGraphMarkerShape={DssGraphMarkerShapeNone:0,DssGraphMarkerShapeRectangle:1,DssGraphMarkerShapeStar45:2,DssGraphMarkerShapePlus:3,DssGraphMarkerShapeCircle:4,DssGraphMarkerShapeDiamond:5,DssGraphMarkerShapeSpikedX:6,DssGraphMarkerShapePlainX:7,DssGraphMarkerShapeTriangle1:8,DssGraphMarkerShapeFatPlus:10,DssGraphMarkerShapeSquare:24,DssGraphMarkerShapeHouse:27,DssGraphMarkerShapeStar5:37,DssGraphMarkerShapeGMTick:200,DssGraphMarkerShape2DPie:201,DssGraphMarkerShape2DRingPie:202,DssGraphMarkerShapeCombined:203,DssGraphMarkerShapeGMPolyLine:204,DssGraphMarkerShapeGMBar:205,DssGraphMarkerShapeGMArea:206,DssGraphMarkerBullet:207};(function(){function G(O,V,U,Q,S,P,R){if(V>P){return false;}return(!R)||(O===0)||((O<Q)&&(V>=S-(P-S)));}function M(R,O,W,V,Q,U,P,S){if(W>P){return false;}return(!S)||((O<Q)&&(W>=U-R.getHeight()));}function N(O,Q,P){O.renderMode="scroll";O.render();O.numChildrenRendered=0;Q.numChildrenRendered++;if(P&&!O.builtChildren){O.buildChildren();}}function E(){return this.useScrollBuffer?this.scrollBuffer:0;}mstrmojo._CanRenderDocOnScroll=mstrmojo.provide("mstrmojo._CanRenderDocOnScroll",{_mixinName:"mstrmojo._CanRenderDocOnScroll",renderMode:"scroll",scrollBuffer:0,preBuildRendering:function K(){if(!!mstrApp.features["ignore-incremental-rendering"]){this.renderMode=null;}if(this._super){this._super();}},postBuildRendering:function B(){if(this.renderMode===null){return this._super();}this.renderChildren();return true;},childRenderOnAddCheck:function(O){if(this.renderMode===null){return this._super(O);}return false;},renderChildren:function L(){var P;if(this.renderMode==="scroll"){var Q=this;while(Q){if(Q.scrollboxNode&&(Q.scrollboxWidthFixed||Q.scrollboxHeightFixed)&&Q.connectScrollbox){P=Q;break;}Q=Q.parent;}}if((this.renderMode!=="scroll")||!P){this._super();return ;}if(this.containerNode){this.scrollboxOwner=P;P.connectScrollbox(this);this.numChildrenRendered=0;var O=this.numChildren;if(O===undefined){this.numChildren=O=this._getModelChildNodes(this.node,false,0,0,true).total;}this.sectionsToRender=O;this.subsectionsToRender=0;if(O){this._startSubsectionThread(false);}}if(this.resizeOrReposition){this.resizeOrReposition();}},onscroll:function I(){if(!this.renderingSubsections){this.useScrollBuffer=true;this._startSubsectionThread(true);}},_startSubsectionThread:function A(R){var P=this;var Q=function(U,S){if(P[U]){if(S){self.clearTimeout(P[U]);}else{self.clearInterval(P[U]);}delete P[U];}};var O=function(U){P.renderingSubsections=false;var S=function(){Q("renderCtlsTimer");P.showRenderStatus(false);P.renderCtrlsInViewport();P.raiseEvent({name:"afterScroll"});P=null;};if(U){P.renderCtlsTimer=self.setTimeout(S,P.scrollboxOwner.scrollInterval+1);}else{S();}};Q("renderSubsTimer");Q("renderCtlsTimer",true);this.renderingSubsections=true;if((this.sectionsToRender||this.subsectionsToRender)&&!this._renderSubsectionsToScroll()){this.showRenderStatus(true);this.renderSubsTimer=self.setInterval(function(){if(P._renderSubsectionsToScroll()){Q("renderSubsTimer");O(R);}else{P.showRenderStatus(true);}},this.scrollboxOwner.scrollInterval);}else{O(R);}},showRenderStatus:function F(P,V){var U=this.parent;if(!U||!U.showStatus){return ;}var O=V,Q;if(P){var R=this.numChildrenRendered,S=this.numChildren;Q=S&&parseInt(100*R/S,10);O="*Rendering section "+R+" of "+S+".*";}U.showStatus(P,O,Q);},_renderSubsectionsToScroll:function J(){var a=this.scrollboxOwner,b=a.scrollboxTop,R=a.scrollboxLeft,V=a.scrollboxBottom+E.call(this),n=a.scrollboxRight,c=V-b,Y=0,X=0,W=null,d=null,Z,j;V+=1;function k(){W=X;d=W+c;}var O=this.numChildren,U=this.children||[],Q=this.model,g=this.node,f=false;for(j=0;j<O;j++){var m=U[j];if(!m){m=this.addChildren(this.builder.build(this._getModelChildNodes(g,false,j,1,true).nodes,Q))[0];U=this.children||[];}var P=f;f=!!m.defn.horiz;Z=(j>0&&m.node.data.bh);if((!f&&P)||(Z&&P)){Y=0;X+=U[j-1].getHeight();if(X>V){return true;}if((d!==null)&&(X>d)){return false;}}if(!m.hasRendered){if(!G(Y,X,R,n,b,V,f)){if(f){continue;}else{return true;}}this._renderSection(m,j);this.sectionsToRender--;this.subsectionsToRender+=(m.children&&m.children.length)||0;if(W===null){k();}}var S=m.children||[],h=null,e,l;for(e=0,l=S.length;e<l;e++){h=S[e];if(!h.hasRendered){if(!M(h,Y,X,R,n,b,V,f)){if(f){break;}else{return true;}}N(h,m);this.subsectionsToRender--;if(W===null){k();}}if(f){Y+=h.getWidth();if(Y>n){break;}}else{X+=h.getHeight();if(X>V){return true;}if((d!==null)&&(X>d)){return false;}}}}return true;},_renderSection:function H(O,P){N(O,this,true);},_getModelChildNodes:function(Q,P,S,O,R){return this.model.getChildren(Q,P,S,O,R);},renderCtrlsInViewport:function D(){var Y=this.scrollboxOwner,a=Y.scrollboxTop,P=Y.scrollboxLeft,S=Y.scrollboxBottom+E.call(this),o=Y.scrollboxRight,V=0,U=0,f=false,R=this.children||[],O,W,j,Z;var e=function(c){if(f){V+=c.getWidth();}else{U+=c.getHeight();}};var m=function(v,c,u,x,t){var r=parseInt(c,10)||0,w=parseInt(u,10);return(isNaN(w))?(v+r<=t):mstrmojo.boxmodel.rangeIntersect(v+r,v+r+w,x,t);};for(j=0,Z=(R&&R.length)||0;j<Z;j++){var p=R[j];O=f;f=!!p.defn.horiz;W=(j>0&&p.node.data.bh);if((!f&&O)||(W&&O)){V=0;U+=R[j-1].getHeight();if(U>S){return ;}}if(!p.hasRendered){if(!f){return ;}continue;}var l=p.children,Q=(l&&l.length)||0,d,h;for(d=0;d<Q;d++){h=l[d];if(!h.hasRendered){break;}if(h.builtChildren&&(h.numChildrenRendered===((h.children&&h.children.length)||0))){e(h);}else{if((U+h.getHeight()>=a)&&(!f||(V+h.getWidth()>=P))){var q=h.children,b=(q&&q.length)||0;if(!b&&!h.builtChildren){h.buildChildren();q=h.children;b=(q&&q.length)||0;}var g=[],k;for(k=0;k<b;k++){var n=q[k];if(n.hasRendered){continue;}var X=n.getFormats()||{};if(m(U,X.top,X.height,a,S)&&m(V,X.left,X.width,P,o)){n.render();g.push(n);}}h.performCanGrowCanShrink(g,true);}e(h);}if((f&&V>o)||(!f&&U>S)){break;}}}},unrender:function C(P){var O=this.scrollboxOwner;if(O){O.disconnectScrollbox(this);}this._super(P);}});}());mstrmojo.EnumReadystate={IDLE:1,WAITING:3,ERROR:4,SUCCESS:5,CANCELLED:6,TIMEOUT:7};(function(){mstrmojo.ui.editors._HostsControls=mstrmojo.provide("mstrmojo.ui.editors._HostsControls",{_mixinName:"mstrmojo.ui.editors._HostsControls",setFormatSource:function C(E){this.throwAbstractMethodError("setFormatSource");},syncControls:function A(E){var F=this._sync;this._sync=true;E.call(this);this._sync=F;},raiseFormatValueChange:function D(F,G,E){if(this._sync){return false;}this.onGroupValueChange(F,G,E);return true;},onGroupValueChange:function B(F,G,E){}});}());mstrmojo.chart.model.enums.EnumDSSDynamicShortcut={DssDynamicShortcutReserved:0,DssDynamicShortcutAuto:1,DssDynamicShortcutAcrossThenDown:2,DssDynamicShortcutDownThenAcross:3,DssDynamicShortcutColumns:4,DssDynamicShortcutRows:5,DssDynamicShortcutCell:6,DssDynamicShortcutShape:7,DssDynamicShortcutLastOne:8,DssDynamicShortcutRangeEnd:255};mstrmojo.vi.enums.EnumDSSAccessRightFlags={DssAccessRightReservedFlag:0,DssAccessRightBrowseFlag:1,DssAccessRightUseExecuteFlag:2,DssAccessRightReadFlag:4,DssAccessRightWriteFlag:8,DssAccessRightDeleteFlag:16,DssAccessRightControlFlag:32,DssAccessRightUseFlag:64,DssAccessRightExecuteFlag:128,DssAccessRightFullControlFlag:255,DssAccessRightInheritable:536870912,DssAccessRightAudit:1073741824,DssAccessRightAuditInheritable:1610612736};(function(){mstrmojo._Fetchable=mstrmojo.provide("mstrmojo._Fetchable",{_mixinName:"mstrmojo._Fetchable",blockBegin:1,blockCount:-1,concat:false,items:null,size:function A(){var B=this.items;return(B&&B.length)||0;},next:function(B){if(this.hasNext()){this.getItems(this.blockBegin+this.blockCount,B);}},previous:function(B){if(this.hasPrevious()){var C=this.blockBegin-this.blockCount;C=C<0?0:C;this.getItems(C,B);}},getItems:function(H,F,B){F=F||{};var E=this,D=mstrmojo.emptyFn,C=F.success||D,G=F.failure||D,I=F.complete||D;this._retrieveItems(H,{success:function(J){E.blockBegin=H;E.blockCount=J.bc||30;E.set("items",(E.concat?(E.items||[]).concat(J.items||[]):(J.items||[])));if(J.totalSize){E.totalSize=J.totalSize;}C(J);},failure:function(J){G(J);},complete:function(J){I(J);}},B);},_retrieveItems:function(D,C,B){alert("Object which mixes in this mixin has not implemented this method - _retrieveItems().");},hasNext:function(){return(((this.concat?1:this.blockBegin)+((this.items&&this.items.length)||0))<((mstrApp.isAppStatePause&&mstrApp.isAppStatePause())?this.totalSize:(this.totalSize+1)));},hasPrevious:function(){return this.blockBegin>1;}});}());(function(){function A(C){return C.replace(/&apos;/g,"'").replace(/&quot;/g,'"').replace(/&gt;/g,">").replace(/&lt;/g,"<").replace(/&amp;/g,"&");}mstrmojo._ImageHelper=mstrmojo.provide("mstrmojo._ImageHelper",{getImage:function B(D){var E=mstrApp,C=E.getConfiguration();if(D){if(D.indexOf("\\")>=0){D=D.replace(/\\/g,"/");}D=A(D);if(D===decodeURI(D)){D=encodeURI(D);}}if(C&&D&&D.indexOf("://")===-1){D=C.getHostUrlByProject(E.getCurrentProjectId())+D;}return(mstrApp.useBinaryFormat)?String(mstrMobileApp.getImage(D)):D;}});}());mstrmojo.chart.enums.EnumFontStyle={FS_NORMAL:0,FS_BOLD:1,FS_ITALIC:2,FS_BOTH:3,FS_UNDERLINE:4,FS_STRIKETHROUGH:8};(function(){mstrmojo.FlexHelper=mstrmojo.declare(null,null,{scriptClass:"mstrmojo.FlexHelper",getWidget:function C(D){var E=D.split("x");return mstrApp.docModel.getUnitInstance(E[0],E[1]);},getZoomFactor:function A(){return mstrApp.docModel.getZoomFactor()*100;}});var B=new mstrmojo.FlexHelper();window.getFlexHelper=function(){return B;};})();(function(){function B(J,E){if(!E.domNode){return 0;}var K="_fixed"+J;if(E[K]){return E[K];}var H=E.getFormats(),I=J.toLowerCase();if(H&&H.hasOwnProperty(I)){var F=H[I];if(F.charAt(F.length-1)!=="%"){var G=parseInt(F,10);if(!isNaN(G)){E[K]=G;return G;}}}return(E.domNode["client"+J]||0);}mstrmojo._ContainsDocObjects=mstrmojo.provide("mstrmojo._ContainsDocObjects",{getHeight:function D(){return B("Height",this);},getWidth:function A(){return B("Width",this);},getMaxZIndex:function C(){var F=0;mstrmojo.array.forEach(this.children,function E(G){F=Math.max(F,G.getFormats()["z-index"]);});return F;}});}());mstrmojo.vi.controllers.EnumEvents={UPDATE_TOC:"updateTOC",MANIPULATE_LAYOUT:"layoutManipulation",MANIPULATE_PANEL:"panelManipulation",LAST_MODIFIED_CHANGE:"lastModifiedChange",CHANGE_COVER_IMAGE:"changeCoverImage",WSITEM_DRAG_OVER:"WSItemDragOver",WSITEM_DRAG_ENTER:"WSItemDragEnter",WSITEM_DRAG_EXIT:"WSItemDragExit",WSITEM_DROP:"WSItemDrop",CONTENTS_PANEL_VISIBILITY_CHANGE:"contentPanelVisibilityChange",DO_LAYOUT:"doLayout"};(function(){mstrmojo.url=mstrmojo.provide("mstrmojo.url",{isAbsoluteURL:function(B){return(/^(http|https|ftp|file):\/\//i.test(B));},getAbsoluteURL:function(B,C){if(this.isAbsoluteURL(B)){return B;}if(C){return C+(/\/$/.test(C)?"":"/")+B;}return"http://"+B;},getWebServerUrl:function(F){var J=null;if(F){if(mstrApp!==undefined&&mstrApp.getConfiguration){J=mstrApp.getConfiguration().getCurrentProjectWebServerUrl();}}else{var D=document.location&&document.location.href;if(D){var E=D.toLowerCase();var C="/app/",L="/servlet/",K="/asp/";var B=E.indexOf(C),H=E.indexOf(L),I=E.indexOf(K);if(B>=0){J=D.substr(0,B+1);}else{if(H>=0){if(I<0){J=D.substr(0,H+1);}else{if(I>=0){var G=(H>I)?I:H;J=D.substr(0,G+1);}}}else{if(H<0){if(I>=0){J=D.substr(0,I+1);}}}}}}return J;},getFullPath:function A(J){var E=J,C=/^[A-z]:\/\//,I,D;if(!(mstrApp&&mstrApp.isDossier)||!J||J.indexOf("data:image")===0){return J;}if(C.test(J)){E=J;}else{var H=/^(\.\.\/|\.\.\\)/;var G=/^(\.\/|\.\\)/;var F=/^(\/|\\)/;J=J.replace(H,"");J=J.replace(G,"");J=J.replace(F,"");if(mstrApp&&mstrApp.getConfiguration){var B=this.getWebServerUrl(this.isTablet);if(!B){E=J;}else{E=this.getAbsoluteURL(J,B);}}}return E;}});}());(function(){mstrmojo.func=mstrmojo.provide("mstrmojo.func",{composite:function D(E){if(!E||!E.length){return mstrmojo.emptyFn;}return function(){var F=E.length,G;for(G=0;G<F;G++){E[G].apply(this,arguments);}};},wrapMethods:function C(J,H){function I(L,K){K=K||{};mstrmojo.hash.forEach(L,function(M,N){K[N]=(K.hasOwnProperty(N)&&typeof M==="function")?mstrmojo.func.composite([M,K[N]]):M;});return K;}if(arguments.length<3){return I(J,H);}var F=arguments.length,G=[].slice.call(arguments,0,F-1).reverse(),E=arguments[F-1];mstrmojo.array.forEach(G,function(K){E=I(K,E);});return E;},override:function A(G,E){var F=function(J,I){return function H(){var L=this._super,K;this._super=I||mstrmojo.emptyFn;try{K=J.apply(this,arguments||[]);}finally{this._super=L;}return K;};};E=E||{};mstrmojo.hash.forEach(G,function(H,I){E[I]=F(H,E[I]);});return E;},throttle:function(G,I,E){var F,K,N,L=null,J=0,M=E||{};var H=function(){J=M.leading===false?0:mstrmojo.date.now();L=null;N=G.apply(F,K);F=K=null;};return function(){var O=mstrmojo.date.now();if(!J&&M.leading===false){J=O;}var P=I-(O-J);F=this;K=arguments;if(P<=0){clearTimeout(L);L=null;J=O;N=G.apply(F,K);F=K=null;}else{if(!L&&M.trailing!==false){L=setTimeout(H,P);}}return N;};},debounce:function(H,J,G){var M,L,F,K,N,E=mstrmojo.date.now;var I=function(){var O=E()-K;if(O<J){M=setTimeout(I,J-O);}else{M=null;if(!G){N=H.apply(F,L);F=L=null;}}};return function(){F=this;L=arguments;K=E();var O=G&&!M;if(!M){M=setTimeout(I,J);}if(O){N=H.apply(F,L);F=L=null;}return N;};},addMethods:function B(F,E){E=E||{};mstrmojo.hash.forEach(F,function(G,H){if(!E.hasOwnProperty(H)&&typeof G==="function"){E[H]=G;}});return E;}});}());(function(){mstrmojo.StringBuffer=mstrmojo.declare(null,null,{scriptClass:"mstrmojo.StringBuffer",append:function A(C){if(!this.buf){this.reset();}this.buf[++this.len]=C;return this;},reset:function B(){this.buf=[];this.len=-1;}});mstrmojo.StringBuffer.prototype.toString=function(D){var C=this.buf;return(C&&C.join(D||""))||"";};}());mstrmojo.vi.viz.EnumVisualizationTemplates={UNKNOWN_GRAPHMATRIX_TYPE:-1,GRID:0,HEATMAP:1,GOOGLEMAP:2,PIE:3,RING:4,GRAPHMATRIXVERTICALBARSTACKED:6,GRAPHMATRIXVERTICALBARCLUSTERED:7,GRAPHMATRIXVERTICALBARPERCENT:8,GRAPHMATRIXHORIZONTALBARSTACKED:9,GRAPHMATRIXHORIZONTALBARCLUSTERED:10,GRAPHMATRIXHORIZONTALBARPERCENT:11,GRAPHMATRIXVERTICALLINESTACKED:12,GRAPHMATRIXVERTICALLINECLUSTERED:13,GRAPHMATRIXVERTICALLINEPERCENT:14,GRAPHMATRIXHORIZONTALLINESTACKED:15,GRAPHMATRIXHORIZONTALLINECLUSTERED:16,GRAPHMATRIXHORIZONTALLINEPERCENT:17,GRAPHMATRIXSCATTERCIRCLEMM:18,GRAPHMATRIXSCATTERGRIDCIRCLEAA:19,GRAPHMATRIXBUBBLECIRCLEMM:21,GRAPHMATRIXBUBBLEGRIDCIRCLEAA:22,GRAPHMATRIXSCATTERSQUAREAM:23,GRAPHMATRIXSCATTERSQUAREMM:24,GRAPHMATRIXSCATTERGRIDSQUAREAA:25,GRAPHMATRIXBUBBLESQUAREAM:26,GRAPHMATRIXBUBBLESQUAREMM:27,GRAPHMATRIXBUBBLEGRIDSQUAREAA:28,GRAPHHORIZONTALBARCLUSTERED:29,GRAPHMATRIXVERTICALAREASTACKED:30,GRAPHMATRIXVERTICALAREAPERCENT:31,GRAPHMATRIXVERTICALAREACLUSTERED:32,GRAPHMATRIXHORIZONTALAREASTACKED:40,GRAPHMATRIXHORIZONTALAREAPERCENT:41,GRAPHMATRIXHORIZONTALAREACLUSTERED:42,GRAPHHORIZONTALBARDUALAXISCLUSTERED:33,GRAPHHORIZONTALBARDUALAXISABSOLUTE:34,GRAPHHORIZONTALLINEABSOLUTE:35,GRAPHHORIZONTALLINEDUALAXISABSOLUTE:36,GRAPHHORIZONTALAREAABSOLUTE:37,GRAPHHORIZONTALAREADUALAXISABSOLUTE:38,GRAPHVERTICALBARCLUSTERED:39,GRAPHVERTICALBARDUALAXISCLUSTERED:43,GRAPHVERTICALBARDUALAXISABSOLUTE:44,GRAPHVERTICALBARDUALAXISSTACKED:45,GRAPHVERTICALLINEABSOLUTE:46,GRAPHVERTICALLINESTACKED:47,GRAPHVERTICALLINEPERCENT:48,GRAPHVERTICALLINEDUALAXISABSOLUTE:49,GRAPHVERTICALLINEDUALAXISSTACKED:50,GRAPHVERTICALAREAABSOLUTE:51,GRAPHVERTICALAREAPERCENT:52,GRAPHVERTICALAREASTACKED:53,GRAPHVERTICALAREADUALAXISABSOLUTE:54,GRAPHVERTICALAREADUALAXISSTACKED:55,GRAPHCOMBINATIONBARAREA:56,GRAPHCOMBINATIONBARAREADUALAXIS:57,NETWORK:58,IMAGELAYOUT:59,GOOGLEMAPDENSITY:60,GRAPHMATRIXPIE:61,GRAPHMATRIXRING:62,GRAPHHORIZONTALBARABSOLUTE:63,GRAPHHORIZONTALBARPERCENT:64,GRAPHHORIZONTALBARSTACKED:65,GRAPHVERTICALBARABSOLUTE:66,GRAPHVERTICALBARPERCENT:67,GRAPHVERTICALBARSTACKED:68,ESRIMAP:69,GRAPHMATRIXVERTICALBARAUTOMATIC:70,GRAPHMATRIXHORIZONTALBARAUTOMATIC:71,GRAPHMATRIXVERTICALLINEAUTOMATIC:72,GRAPHMATRIXHORIZONTALLINEAUTOMATIC:73,GRAPHMATRIXVERTICALAREAAUTOMATIC:74,GRAPHMATRIXHORIZONTALAREAAUTOMATIC:75,GRAPHMATRIXVERTICALHISTOGRAM:76,GRAPHMATRIXGRIDCHART:78,GRAPHMATRIXVERTICALBOXPLOT:79,GRAPHMATRIXHORIZONTALBOXPLOT:80,GRAPHMATRIXVERTICALWATERFALL:81,GRAPHMATRIXHORIZONTALWATERFALL:82,KPICARD:83};var T=mstrmojo.vi.viz.EnumVisualizationTemplates;mstrmojo.vi.viz.EnumAggregatedVisTemplates={COMBOCHART:[T.GRAPHHORIZONTALBARDUALAXISCLUSTERED,T.GRAPHHORIZONTALBARDUALAXISABSOLUTE,T.GRAPHHORIZONTALLINEDUALAXISABSOLUTE,T.GRAPHHORIZONTALAREADUALAXISABSOLUTE,T.GRAPHVERTICALBARDUALAXISCLUSTERED,T.GRAPHVERTICALBARDUALAXISABSOLUTE,T.GRAPHVERTICALBARDUALAXISSTACKED,T.GRAPHVERTICALLINEDUALAXISABSOLUTE,T.GRAPHVERTICALLINEDUALAXISSTACKED,T.GRAPHVERTICALAREADUALAXISABSOLUTE,T.GRAPHVERTICALAREADUALAXISSTACKED,T.GRAPHCOMBINATIONBARAREADUALAXIS,T.GRAPHCOMBINATIONBARAREA],BUBBLECHART:[T.GRAPHMATRIXSCATTERCIRCLEMM,T.GRAPHMATRIXSCATTERGRIDCIRCLEAA,T.GRAPHMATRIXBUBBLECIRCLEMM,T.GRAPHMATRIXBUBBLEGRIDCIRCLEAA,T.GRAPHMATRIXSCATTERSQUAREAM,T.GRAPHMATRIXSCATTERSQUAREMM,T.GRAPHMATRIXSCATTERGRIDSQUAREAA,T.GRAPHMATRIXBUBBLESQUAREAM,T.GRAPHMATRIXBUBBLESQUAREMM,T.GRAPHMATRIXBUBBLEGRIDSQUAREAA],BARCHART:[T.GRAPHMATRIXVERTICALBARSTACKED,T.GRAPHMATRIXVERTICALBARCLUSTERED,T.GRAPHMATRIXVERTICALBARPERCENT,T.GRAPHMATRIXHORIZONTALBARSTACKED,T.GRAPHMATRIXHORIZONTALBARCLUSTERED,T.GRAPHMATRIXHORIZONTALBARPERCENT,T.GRAPHHORIZONTALBARCLUSTERED,T.GRAPHVERTICALBARCLUSTERED,T.GRAPHHORIZONTALBARABSOLUTE,T.GRAPHHORIZONTALBARPERCENT,T.GRAPHHORIZONTALBARSTACKED,T.GRAPHVERTICALBARABSOLUTE,T.GRAPHVERTICALBARPERCENT,T.GRAPHVERTICALBARSTACKED,T.GRAPHMATRIXVERTICALBARAUTOMATIC,T.GRAPHMATRIXHORIZONTALBARAUTOMATIC],LINECHART:[T.GRAPHMATRIXVERTICALLINESTACKED,T.GRAPHMATRIXVERTICALLINECLUSTERED,T.GRAPHMATRIXVERTICALLINEPERCENT,T.GRAPHMATRIXHORIZONTALLINESTACKED,T.GRAPHMATRIXHORIZONTALLINECLUSTERED,T.GRAPHMATRIXHORIZONTALLINEPERCENT,T.GRAPHHORIZONTALLINEABSOLUTE,T.GRAPHVERTICALLINEABSOLUTE,T.GRAPHVERTICALLINESTACKED,T.GRAPHVERTICALLINEPERCENT,T.GRAPHMATRIXVERTICALLINEAUTOMATIC,T.GRAPHMATRIXHORIZONTALLINEAUTOMATIC],PIECHART:[T.PIE,T.RING,T.GRAPHMATRIXPIE,T.GRAPHMATRIXRING],AREACHART:[T.GRAPHMATRIXVERTICALAREASTACKED,T.GRAPHMATRIXVERTICALAREAPERCENT,T.GRAPHMATRIXVERTICALAREACLUSTERED,T.GRAPHMATRIXHORIZONTALAREASTACKED,T.GRAPHMATRIXHORIZONTALAREAPERCENT,T.GRAPHMATRIXHORIZONTALAREACLUSTERED,T.GRAPHHORIZONTALAREAABSOLUTE,T.GRAPHVERTICALAREAABSOLUTE,T.GRAPHVERTICALAREAPERCENT,T.GRAPHVERTICALAREASTACKED,T.GRAPHMATRIXVERTICALAREAAUTOMATIC,T.GRAPHMATRIXHORIZONTALAREAAUTOMATIC],HISTOGRAM:[T.GRAPHMATRIXVERTICALHISTOGRAM,],BOXPLOT:[T.GRAPHMATRIXVERTICALBOXPLOT,T.GRAPHMATRIXHORIZONTALBOXPLOT],WATERFALL:[T.GRAPHMATRIXVERTICALWATERFALL,T.GRAPHMATRIXHORIZONTALWATERFALL]};(function(){function AN(Ay,Az){return Az||(Ay||window).event;}function p(Ay){var Az=parseInt(Ay,10);return Az===null||isNaN(Az)?0:Az;}mstrmojo.PositionType=null;var Au=!!document.all,AL=document.documentMode,w=navigator.userAgent,n=false,l=false,j=false,h=false,V=false,S=!Au&&"ActiveXObject" in window,z=false;Au=Au||S;if(Au){if(window.mstrConfig&&mstrConfig.isEdgeModeEnabled){n=!!w.match(/MSIE 6/);l=((!!w.match(/MSIE 7/)&&!AL)||AL===7);j=(AL===8);h=(AL===9);V=(AL===10);z=(!AL||AL<=9);}else{n=!!w.match(/MSIE 6/);l=!!w.match(/MSIE 7/);j=!!w.match(/MSIE 8/);h=!!w.match(/MSIE 9/);V=!!w.match(/MSIE 10/);z=!V;}}var g=!Au&&!!w.match(/Firefox/),q=0,x=!!w.match(/Android/),Ak=!!w.match(/iPad/),AS=!!w.match(/iPhone/),Aa=!!document.createTouch||x,v=!!w.match(/PlayBook/),Q=!!w.match(/Windows Phone/),Av=!Au&&!!w.match(/Trident.*rv/),f=g?"-moz-":(Au||Av)?"":"-webkit-",AM=g?"Moz":(V||Av)?"":Au?"ms":"webkit",AX=((V||Av)?"t":"T"),AR=AM+AX+"ransition";function Ap(){return AM+AX+"ransform";}function AJ(){return AR+"Property";}function W(){return AR+"Duration";}function P(){return(V||g)?"transitionend":"webkitTransitionEnd";}function k(){return AM+"BoxShadow";}var As=Ap(),Ag=AJ(),AE=W(),A=P(),t=k();function AW(){if(!q&&g){var Ay=w.match(/.*Firefox\/([\d|\.]*).*/);if(Ay){q=parseFloat(Ay[1]);}}return q;}function Ac(){var Az=0,A3=0,A0=window,A1=document,Ay=A1.body,A2=A1.documentElement;if(typeof A0.pageYOffset==="number"){A3=A0.pageYOffset;Az=A0.pageXOffset;}else{if(Ay&&(Ay.scrollLeft||Ay.scrollTop)){A3=Ay.scrollTop;Az=Ay.scrollLeft;}else{if(A2&&(A2.scrollLeft||A2.scrollTop)){A3=A2.scrollTop;Az=A2.scrollLeft;}}}return{x:Az,y:A3};}function AK(Ay){Ay=Ay||0;Ay=String(Ay);return((Ay.indexOf("%",0))!==-1)?Ay:(Ay+"px");}function AU(A0,A4,A3,A2,A1){if(!mstrmojo.dom.isWinPhone){A2=(A2||false||this.isHWAccelerated);}else{A2=false;}var Az=A1+(A2?"3d":"")+"(",Ay=A2?(","+A3+")"):")";return Az+A0+","+A4+Ay;}var Ai=2,Z=3;function AA(A4,A3,A7){var A6=A4.style,A0=A6.display,A2=this.windowDim(),A1=Ac();A6.display="block";var A5=A2.w-A4.clientWidth,A8=Math.max(A2.h-A4.clientHeight,0),Ay={4:0,5:A5,3:A5/2},Az={1:0,3:A8/2,2:A8};A6.left=Ay[A3]+A1.x+"px";A6.top=Az[A7]+A1.y+"px";A6.display=A0;}function r(A1,A0,A2,Ay){if(A1.addEventListener){return A1.addEventListener(A0,A2,!!Ay);}A2._id=A2._id||r.guid++;A1.events=A1.events||{};var Az=A1.events[A0];if(!Az){Az=A1.events[A0]={};if(A1["on"+A0]){Az[0]=A1["on"+A0];}}Az[A2._id]=A2;function A3(A6){A6=A6||window.event;var A5=this.events[A6.type],A4;for(A4 in A5){A5[A4].call(this,A6);}}A1["on"+A0]=A3;}r.guid=1;function m(A0,Az,A1,Ay){if(!A0){return ;}if(A0.removeEventListener){A0.removeEventListener(Az,A1,!!Ay);}else{if(A0.events&&A0.events[Az]){delete A0.events[Az][A1._id];}}}mstrmojo.Enum_Keys={BACKSPACE:8,TAB:9,ENTER:13,CTRL:17,ESCAPE:27,SPACE:32,PAGE_UP:33,PAGE_DOWN:34,END:35,HOME:36,LEFT_ARROW:37,UP_ARROW:38,RIGHT_ARROW:39,DOWN_ARROW:40,INSERT:45,DELETE:46};mstrmojo.dom=mstrmojo.provide("mstrmojo.dom",{userAgent:w,isIE:Au,isIE6:n,isIE7:l,isIE8:j,isIE9:h,isIE10:V,isIE11:S,isIEW3C:Av,isNSIE:z,isDXIE:z,isFF:g,isWK:!!w.match(/AppleWebKit/),isSafari:!!w.match(/Safari/)&&!w.match(/Chrome/),isChrome:!!w.match(/AppleWebKit/)&&w.match(/Chrome/),isEdge:!!w.match(/Edge/),isHWAccelerated:!x,isAndroid:x,isIPad:Ak,isPlayBook:v,isWinPhone:Q,isMobile:Ak||AS||Q||x,isIOSTouch:(Ak||AS)&&!window.MSStream,supportsTouches:Aa,TOUCHSTART:Aa?"touchstart":"mousedown",TOUCHMOVE:Aa?"touchmove":"mousemove",TOUCHEND:Aa?"touchend":"mouseup",TOUCHCANCEL:Aa?"touchcancel":"",RESIZE:Aa?"orientationchange":"resize",CSS3_PREFIX:f,CSS3_BOXSHADOW:t,CSS3_TRANSFORM:As,CSS3_TRANSITION:AR,CSS3_TRANSITION_PROPERTY:Ag,CSS3_TRANSITION_DURATION:AE,CSS3_TRANSITION_END:A,cssFeatures:{GRADIENTS:"gd",ROUND_CORNERS:"rc",TEXT_ROTATION:"tr",DROP_SHADOW:"sh"},htmlFeatures:{FILE_READER:"fr"},MOUSE_BUTTON:{LEFT:1,RIGHT:2},supports:function B(Ay){var Az=this.isFF&&AW();switch(Ay){case this.cssFeatures.GRADIENTS:return(this.isIE||this.isIEW3C||this.isWK||Az>=3.6||this.isWinPhone);case this.cssFeatures.ROUND_CORNERS:return(this.isWK||this.isFF||this.isWinPhone||this.isIE10);case this.cssFeatures.TEXT_ROTATION:case this.cssFeatures.DROP_SHADOW:return(this.isIE||this.isWK||Az>=3.5||this.isWinPhone||this.isIE10||this.isIEW3C);case this.htmlFeatures.FILE_READER:return !!(window.FileReader);}return false;},getOSInfo:function AT(){var A3="Unknown",Az=navigator.appVersion,A2=navigator.userAgent,A1=A3;var Ay=[{s:"Windows 3.11",r:/Win16/},{s:"Windows 95",r:/(Windows 95|Win95|Windows_95)/},{s:"Windows ME",r:/(Win 9x 4.90|Windows ME)/},{s:"Windows 98",r:/(Windows 98|Win98)/},{s:"Windows CE",r:/Windows CE/},{s:"Windows 2000",r:/(Windows NT 5.0|Windows 2000)/},{s:"Windows XP",r:/(Windows NT 5.1|Windows XP)/},{s:"Windows Server 2003",r:/Windows NT 5.2/},{s:"Windows Vista",r:/Windows NT 6.0/},{s:"Windows 7",r:/(Windows 7|Windows NT 6.1)/},{s:"Windows 8.1",r:/(Windows 8.1|Windows NT 6.3)/},{s:"Windows 8",r:/(Windows 8|Windows NT 6.2)/},{s:"Windows NT 4.0",r:/(Windows NT 4.0|WinNT4.0|WinNT|Windows NT)/},{s:"Windows ME",r:/Windows ME/},{s:"Android",r:/Android/},{s:"Open BSD",r:/OpenBSD/},{s:"Sun OS",r:/SunOS/},{s:"Linux",r:/(Linux|X11)/},{s:"iOS",r:/(iPhone|iPad|iPod)/},{s:"Mac OS X",r:/Mac OS X/},{s:"Mac OS",r:/(MacPPC|MacIntel|Mac_PowerPC|Macintosh)/},{s:"QNX",r:/QNX/},{s:"UNIX",r:/UNIX/},{s:"BeOS",r:/BeOS/},{s:"OS/2",r:/OS\/2/},{s:"Search Bot",r:/(nuhk|Googlebot|Yammybot|Openbot|Slurp|MSNBot|Ask Jeeves\/Teoma|ia_archiver)/}];var A0;for(A0=0;A0<Ay.length;A0++){var A5=Ay[A0];if(A5.r.test(A2)){A1=A5.s;break;}}var A4=A3;if(/Windows/.test(A1)){A4=/Windows (.*)/.exec(A1)[1];A1="Windows";}switch(A1){case"Mac OS X":A4=/Mac OS X (10[\.\_\d]+)/.exec(A2)[1];break;case"Android":A4=/Android ([\.\_\d]+)/.exec(A2)[1];break;case"iOS":A4=/OS (\d+)_(\d+)_?(\d+)?/.exec(Az);A4=A4[1]+"."+A4[2]+"."+(A4[3]|0);break;}return{name:A1,version:A4};},transEndEvtNames:{WebkitTransition:"webkitTransitionEnd",MozTransition:"transitionend",OTransition:"oTransitionEnd",msTransition:"MSTransitionEnd",transition:"transitionend"},animationEndEvtNames:{WebkitAnimation:"webkitAnimationEnd",OAnimation:"oAnimationEnd",msAnimation:"MSAnimationEnd",MozAnimation:"animationend",animation:"animationend"},replace:function u(A0,Ay){if(A0&&Ay){var Az=A0.parentNode;if(Az){Az.replaceChild(Ay,A0);}}return Ay;},attachEvent:function b(A0,Az,A1,Ay){if(A0.addEventListener){return A0.addEventListener(Az,A1,!!Ay);}return A0.attachEvent("on"+Az,A1);},detachEvent:function Ae(A0,Az,A1,Ay){if(!A0){return ;}if(A0.removeEventListener){A0.removeEventListener(Az,A1,!!Ay);}else{A0.detachEvent("on"+Az,A1);}},attachMarkupEvent:function AC(A1,A0,Ay){var Az=function(A2){mstrmojo.all[A1].captureDomEvent(Ay,window,A2);};this.attachEvent(A0,Ay,Az);return Az;},attachOneTimeEvent:function a(A1,Az,A2,Ay){var A0=function(A3){A2(A3);if(Ay){m(this,Az,A0);}else{mstrmojo.dom.detachEvent(this,Az,A0);}};if(Ay){r(A1,Az,A0);}else{this.attachEvent(A1,Az,A0);}A1=null;return A0;},attachMouseMoveEvents:function D(A1,Ay){var A0=this,Az=function(A2){if(Ay){Ay(A2);}A0.detachEvent(document,"mousemove",A1);A0.detachEvent(document,"mouseup",Az);};A0.attachEvent(document,"mousemove",A1);A0.attachEvent(document,"mouseup",Az);},captureDomEvent:function AQ(A3,A1,Az,A2,A0){var Ay=mstrmojo.all[A3];if(Ay){Ay.captureDomEvent(A1,Az,A2,A0);}},captureEventInfo:function AP(A1){var Az=mstrmojo.hash.copy(A1,{}),A0=Az.hWin=Az.hWin||window,Ay=Az.e=Az.e||A0.event;Az.node=this.eventTarget(A0,Ay);Az.pos=this.getMousePosition(Ay,A0);return Az;},translate:function N(A0,Az,A3,A2,Ay,A1){Ay=(Ay&&" "+Ay)||"";A0.style[((mstrmojo.dom.isWinPhone||mstrmojo.dom.isIE9||mstrmojo.dom.isIE10)?"ms":"webkit")+"Transform"]=this.createTranslateString(Az,A3,A2,A1)+Ay;},createTranslateString:function R(Ay,A1,A0,Az){Ay=AK(Ay);A1=AK(A1);A0=AK(A0);return AU(Ay,A1,A0,Az,"translate");},createScaleString:function AB(Ay,A1,A0,Az){Ay=Ay||0;A1=A1||0;A0=A0||0;return AU(Ay,A1,A0,Az,"scale");},_bufferSize:200,_bufferConnects:{},attachBufferedEvent:function C(A0,Ay,A1,A3){var Az=A0.id+"-"+Ay,A2=this._bufferConnects[Az];if(!A2){A2=this._bufferConnects[Az]={elId:A0.id,eventName:Ay,timer:null,bufferSize:A3,listeners:[],callback:function(A4){mstrmojo.dom._callback(A4,mstrmojo.global,Az);return true;}};this.attachEvent(A0,Ay,A2.callback);}A2.listeners.push(A1);},_callback:function Ao(A2,Ay,A0){var A1=this._bufferConnects[A0],A3=A1&&A1.timer;if(A1&&!A3){var Az=(A1.bufferSize===null)?this._bufferSize:A1.bufferSize;if(A1.bufferSize){A1.timer=Ay.setTimeout(function(){mstrmojo.dom.updateBuffers(A0);},Az);}else{mstrmojo.dom.updateBuffers(A0);}}},updateBuffers:function J(A1){var A2=this._bufferConnects[A1],Az=A2&&A2.listeners,Ay=(Az&&Az.length)||0,A0;for(A0=0;A0<Ay;A0++){Az[A0]();}if(A2&&A2.timer){delete A2.timer;}},detachBufferedEvent:function AH(Az,A3,A4){if(!Az){return ;}var A6=Az.id+"-"+A3,A0=this._bufferConnects[A6],A2=A0&&A0.listeners,A5=(A2&&A2.length)||0,A1;if(A5){for(A1=A5-1;A1>-1;A1--){if(A2[A1]===A4){A2.splice(A1,1);}}if(!A2.length){this.detachEvent(Az,A3,A0.callback);delete this._bufferConnects[A6];if(A0.timer){var Ay=mstrmojo.global;Ay.clearTimeout(A0.timer);}}}},eventTarget:function AF(Ay,Az){Az=AN(Ay,Az);return Az.target||Az.srcElement;},isMac:function AD(){return this.getOSInfo().name.toLowerCase().indexOf("mac")>=0;},isMetaKey:function L(Ay,A1){var A0=this.getOSInfo().name.toLowerCase().indexOf("mac")>=0,Az=AN(Ay,A1)||{};return(Az.ctrlKey&&!A0)||(Az.metaKey&&A0);},ctrlKey:function Ar(Ay,Az){return(AN(Ay,Az)||{}).ctrlKey;},shiftKey:function AG(Ay,Az){return(AN(Ay,Az)||{}).shiftKey;},metaKey:function d(Ay,Az){return(AN(Ay,Az)||{}).metaKey;},getButton:function AY(Ay,Az){return((Number(AN(Ay,Az).button))===2)?2:1;},isPrimaryMouseBtn:function Al(Az,Ay){return this.getButton(Ay||window,Az)===1;},isRMC:function Ah(Az,Ay){return Az&&(Az.button===2||Az.type==="contextmenu"||this.isMac()&&this.ctrlKey(Ay,Az)&&Az.button===0);},getMousePosition:function o(A1,A0){A0=A0||window;var Az,A4;if(mstrmojo.dom.isIE){A1=A1||A0.event;var A2=document,Ay=A2.body,A3=A2.documentElement;Az=A1.clientX+Ay.scrollLeft+(A3.scrollLeft||0);A4=A1.clientY+Ay.scrollTop+(A3.scrollTop||0);}else{Az=A1.pageX;A4=A1.pageY;}return{x:Az,y:A4};},position:function AZ(Az,A0){var A3={x:0,y:0,w:0,h:0};if(Az&&Az.getBoundingClientRect){try{A3=Az.getBoundingClientRect();}catch(A2){A3={left:0,top:0,right:0,bottom:0,height:0,width:0};}A3={x:A3.left,y:A3.top,w:A3.right-A3.left,h:A3.bottom-A3.top};if(this.isIE6||this.isIE7){var Ay=Az.ownerDocument;if(Ay){var A5=Ay.documentElement,A4=A5.getBoundingClientRect();A3.x-=A4.left;A3.y-=A4.top;}}}if(A0){var A1=Ac();A3.x+=A1.x;A3.y+=A1.y;}return A3;},delta:function G(A0,Ay){Ay=Ay||document.body;var Az=this.position(A0),A1=this.position(Ay);return{x:Math.round(Az.x-A1.x),y:Math.round(Az.y-A1.y)};},windowDim:function U(){var Ay=0,A0=0,A1=window,A2=document,A3=A2.documentElement,Az=A2.body;if(typeof (A1.innerWidth)=="number"&&typeof (A1.innerHeight)=="number"){Ay=A1.innerWidth;A0=A1.innerHeight;}else{if(A3&&(A3.clientWidth||A3.clientHeight)){Ay=A3.clientWidth;A0=A3.clientHeight;}else{if(Az&&(Az.clientWidth||Az.clientHeight)){Ay=Az.clientWidth;A0=Az.clientHeight;}}}return{w:Ay,h:A0};},center:function AO(Ay){AA.call(this,Ay,Z,Z);},bottomCenter:function E(Ay){AA.call(this,Ay,Z,Ai);},clearBrowserHighlights:function M(Ay){Ay=Ay||self;if(!Ay.getSelection){var A4=Ay.document,A3=A4&&A4.selection,A1=A3&&A3.empty;if(A1){try{A3.empty();}catch(A0){}}}else{var Az=Ay.getSelection,A2=Az&&Ay.getSelection();if(A2&&!A2.isCollapsed){if(A2.empty){A2.empty();}else{if(A2.removeAllRanges){A2.removeAllRanges();}}}}},findAncestorByAttr:function AV(A2,A0,Az,Ay){var A3=Az?A2:A2&&A2.parentNode;while(A3&&(A3!==Ay)){var A1=A3.getAttribute&&A3.getAttribute(A0);if(A1!=null){return{node:A3,value:A1};}A3=A3.parentNode;}return null;},findAncestorByName:function Aq(A0,A3,Az,Ay){A3=A3&&A3.toLowerCase();var A1=Az?A0:A0&&A0.parentNode;while(A1&&(A1!==Ay)){var A2=A1.nodeName;if(A2&&(A2.toLowerCase()===A3)){return A1;}A1=A1.parentNode;}return null;},contains:function K(A1,A2,Az,Ay){var A0=A2;if(!Az){A0=A0.parentNode;}while(A0){if(A0===A1){return true;}if(A0===Ay){break;}A0=A0.parentNode;}return false;},toggleSelection:function Aw(Az,Ay){Az.setAttribute("unselectable",Ay?"off":"on");mstrmojo.css.toggleClass(Az,"unselectable",!Ay);Az.onselectstart=function(){return Ay;};if(!Ay){this.clearBrowserHighlights();}},preventDefault:function Y(Ay,Az){Az=Az||Ay.event;if(Az.preventDefault){Az.preventDefault();}else{Az.returnValue=false;}},stopPropogation:function O(Ay,Az){Az=Az||Ay.event;if(Az.stopPropagation){Az.stopPropagation();}else{Az.cancelBubble=true;}},firstTouch:function Ab(Ay,Az){return Az&&Az.touches&&Az.touches.length?Az.touches[0]:(Az||Ay.event);},firstChangedTouch:function Aj(Ay,Az){return Az&&Az.changedTouches&&Az.changedTouches.length?Az.changedTouches[0]:(Az||Ay.event);},isLandscape:function X(){return !this.supportsTouches||(Math.abs(window.orientation)===90);},findWidget:function Ad(Ay){while(Ay){var Az=Ay.mstrmojoId;if(Az!==null&&Az!==undefined){return mstrmojo.all[Az];}Ay=Ay.parentNode;}return null;},setCaret:function H(Ay,A0){if(Ay.setSelectionRange){Ay.focus();Ay.setSelectionRange(A0,A0);}else{if(Ay.createTextRange){var Az=Ay.createTextRange();Az.move("character",A0);Az.select();}}},setInputSelection:function c(Ay){if(Ay.select){Ay.focus();Ay.select();}else{if(Ay.createTextRange){Ay.createTextRange().select();}}},setElementSelection:function e(A0){if(window.getSelection){var Ay=document.createRange(),Az=window.getSelection();Ay.selectNodeContents(A0);Az.removeAllRanges();Az.addRange(Ay);}else{if(document.body.createTextRange){var A1=document.body.createTextRange();A1.moveToElementText(A0);A1.select();}}},getHorizontalScroll:function At(){return Ac().x;},getVerticalScroll:function AI(){return Ac().y;},getMaxScrollHeight:function I(){return mstrmojo.dom.windowDim().h-22;},getComputedScrollbarWidth:function Am(Az){if(Az){var Ay=mstrmojo.css.getComputedStyle(Az);if(Ay){return(Az.offsetWidth-p(Ay.borderLeftWidth)-p(Ay.borderRightWidth)-Az.clientWidth);}}return null;},removeNode:function An(A0){var Az=document.getElementById(A0),Ay=Az&&Az.parentNode;if(Ay){return Ay.removeChild(Az);}},redirectUrlToFormWrapper:function Af(A1){var A0=function A0(A3){A3.preventDefault();var A5=A3.target,A4=A5&&A5.href;if(A4&&window&&window.FormWrapper){window.FormWrapper.openPage(A4.replace(/ /g,"%20"));}};var A2=A1&&A1.getElementsByTagName("a"),Az=A2.length;for(var Ay=0;Ay<Az;Ay++){if(!A2[Ay].openWithFormWrapper){A2[Ay].addEventListener("click",A0,true);A2[Ay].openWithFormWrapper=true;}}},checkTagName:function Ax(Az,Ay){return Az&&Az.tagName&&Az.tagName.toLowerCase()===Ay;},getComputedMargin:function F(Az){var Ay=mstrmojo.css.getComputedStyle(Az);return[parseInt(Ay.marginTop,10)||0,parseInt(Ay.marginRight,10)||0,parseInt(Ay.marginBottom,10)||0,parseInt(Ay.marginLeft,10)||0];}});}());mstrmojo.mstr.EnumDSSXMLTokenTypes={EndOfInput:-1,Reserved:0,Error:1,Unknown:2,Empty:3,ExclamationPoint:33,NumberSign:35,Dollar:36,Percent:37,Ampersand:38,LeftParen:40,RightParen:41,Asterisk:42,PlusSign:43,Comma:44,MinusSign:45,Dot:46,FwdSlash:47,Colon:58,Semicolon:59,LeftAngleBracket:60,EqualSign:61,RightAngleBracket:62,QuestionMark:63,AtSign:64,LeftSquareBracket:91,RightSquareBracket:93,Caret:94,Underscore:95,LeftAccolade:123,VerticalBar:124,RightAccolade:125,Tilda:126,Literal:258,Identifier:259,Reserved1:260,DoubleQString:261,Integer:262,Float:263,AttrRef:264,DimRef:265,MetricRef:266,AggMetricRef:267,FactRef:268,ReportRef:269,FilterRef:270,RoleRef:271,TableRef:272,PromptRef:273,ColumnRef:274,AttrFormRef:275,DimFormRef:276,SimpInfixFun1:277,SimpInfixFun2:278,SimpPrefixFun:279,AggFun:280,RelativeFun:281,CompareFun:282,AndFun:283,OrFun:284,NotFun:285,BoolPrefixFun:286,IntersectFun:287,Reserved2:288,InSetFun:289,BetweenFun:290,LikeFun:291,EnhCompareFun:292,EnhBetweenFun:293,ArrowUp:294,ArrowDown:295,ArrowUpDown:296,AggFirstInFact:297,AggLastInFact:298,KwdTrue:299,KwdFalse:300,KwdBreakBy:301,KwdSortBy:302,KwdFactID:303,DateTime:304,CaseFun:305,FreeVariable:306,LongNumber:307,RWMetricRef:308,CSQLRef:309,ConsolidationRef:310,DssTokenTypeKwdCSIUpdate:312,DssTokenTypeKwdCSISet:313,DssTokenTypeKwdCSIInsert:314,DssTokenTypeKwdCSIDelete:315,DssTokenTypeKwdCSIWhere:316,DssTokenTypeKwdCSIInto:317,DssTokenTypeKwdCSIValues:318,DssTokenTypeKwdCSIFrom:319,DssTokenTypeCSIFieldUnit:321,Elements:323,ConsolidationElementRef:324,EndOfTypes:340};mstrmojo._ShowsStatus=mstrmojo.provide("mstrmojo._ShowsStatus",{showStatus:function showStatus(A,G,D){var C=this._STATUS;if(!this.hasRendered||!C){return ;}var E=C.style;if(!A){if(this.showingStatus){E.display="none";}}else{if(C){var F=this._STATUS_TXT;if(F){F.innerHTML=G||"";}var B=this._STATUS_BAR;if(B){B.style.width=(D||0)+"%";}if(!this.isStatusBarPositioned){E.top=Math.max((this.scrollboxHeight||0)-50,12)+"px";this.isStatusBarPositioned=true;}if(!this.showingStatus){E.display="block";}}}this.showingStatus=A;},updateStatus:function updateStatus(A,B){this.showStatus(this.showingStatus,A,B);}});(function(){var A=400,B=1500;mstrmojo._CanHandleTwoClicks=mstrmojo.provide("mstrmojo._CanHandleTwoClicks",{firstClickTimeStamp:undefined,firstClickTarget:undefined,onclick:function(C){var D=new Date();timeStamp=D.getTime();if(D-this.firstClickTimeStamp<B&&D-this.firstClickTimeStamp>A){C.secondTarget=C.getTarget();C.firstTarget=this.firstClickTarget;this.onTwoClicks(C);C.cancel();}else{this.firstClickTarget=C.getTarget();this.firstClickTimeStamp=timeStamp;}if(this._super){this._super(C);}},onTwoClicks:mstrmojo.emptyFn});}());(function(){mstrmojo.vi.ui._IsUnitContainerTitleBar=mstrmojo.provide("mstrmojo.vi.ui._IsUnitContainerTitleBar",{_mixinName:"mstrmojo.vi.ui._IsUnitContainerTitleBar",layoutConfig:{w:{leftToolNode:"auto",textNode:"100%",rightToolNode:"auto"},xt:true},setDimensions:function A(D,C){return this._super("auto",C);},getTitleChildrenLayoutOffsets:function B(){return{h:0,w:12};}});}());mstrmojo.chart.model.enums.EnumDSSGraphDataTextShowType={DssGraphDataTextNone:0,DssGraphDataTextValue:1,DssGraphDataTextLabel:2,DssGraphDataTextBoth:3,DssGraphDataTextAbs:4,DssGraphDataTextAbsValue:5,DssGraphDataTextAbsBoth:7,DssGraphDataTextTotal:8,DssGraphDataTextZValue:16,DssGraphDataTextPercent:32,DssGraphDataTextYValue:64,DssGraphDataTextInternal:128,DssGraphDataTextSeriesDependent:256,DssGraphDataTextQualityObjectMode:512};(function(){mstrmojo.models.template.MetricValue=mstrmojo.declare(null,null,{init:function G(H){this.data=H.data;this.value=H.value;},getValue:function B(){return this.value.v;},getThresholdType:function D(){return this.value.ty;},getRawValue:function A(){return this.value.rv;},getCSS:function C(){return this.data.css[this.value.cni].n;},getThresholdValue:function F(H){if(this.value.ti===undefined){return H;}return this.data.th[this.value.ti].n;},getFillColor:function E(H){if(this.value.ci===undefined){return H;}return this.data.fc[this.value.ci].n;}});}());(function(){mstrmojo.requiresDescs(5774,2266,2287,2496,2495,2493,2267,2498,2500,2279,2491,2476,2271,2478,2268,2492,2273,2280,2490,2488,2494,2487,2269,2477,2499,2292,2489,2281,2484,2483,2480,2497,2274,2485,2486,2282,2481,2479,2482,2290,2293);var A=[{n:mstrmojo.desc(5774,"No Fill"),id:"transparent"},{n:mstrmojo.desc(2266,"Black"),id:"#000000"},{n:mstrmojo.desc(2287,"Brown"),id:"#993300"},{n:mstrmojo.desc(2496,"Olive Green"),id:"#333300"},{n:mstrmojo.desc(2495,"Dark Green"),id:"#003300"},{n:mstrmojo.desc(2493,"Dark Teal"),id:"#003366"},{n:mstrmojo.desc(2267,"Dark Blue"),id:"#000080"},{n:mstrmojo.desc(2498,"Indigo"),id:"#333399"},{n:mstrmojo.desc(2500,"Grey-80%"),id:"#333333"},{n:mstrmojo.desc(2279,"Dark Red"),id:"#800000"},{n:mstrmojo.desc(2491,"Orange"),id:"#ff6600"},{n:mstrmojo.desc(2476,"Dark Yellow"),id:"#808000"},{n:mstrmojo.desc(2271,"Green"),id:"#008000"},{n:mstrmojo.desc(2478,"Teal"),id:"#008080"},{n:mstrmojo.desc(2268,"Blue"),id:"#0000ff"},{n:mstrmojo.desc(2492,"Blue-Grey"),id:"#666699"},{n:mstrmojo.desc(2273,"Grey-50%"),id:"#808080"},{n:mstrmojo.desc(2280,"Red"),id:"#ff0000"},{n:mstrmojo.desc(2490,"Light Orange"),id:"#ff9900"},{n:mstrmojo.desc(2488,"Lime"),id:"#99cc00"},{n:mstrmojo.desc(2494,"Sea Green"),id:"#339966"},{n:mstrmojo.desc(2487,"Aqua"),id:"#33cccc"},{n:mstrmojo.desc(2269,"Light Blue"),id:"#3366ff"},{n:mstrmojo.desc(2477,"Violet"),id:"#800080"},{n:mstrmojo.desc(2499,"Grey-40%"),id:"#969696"},{n:mstrmojo.desc(2292,"Pink"),id:"#ff00ff"},{n:mstrmojo.desc(2489,"Gold"),id:"#ffcc00"},{n:mstrmojo.desc(2281,"Yellow"),id:"#ffff00"},{n:mstrmojo.desc(2484,"Bright Green"),id:"#00ff00"},{n:mstrmojo.desc(2483,"Turquoise"),id:"#00ffff"},{n:mstrmojo.desc(2480,"Sky Blue"),id:"#00ccff"},{n:mstrmojo.desc(2497,"Plum"),id:"#993366"},{n:mstrmojo.desc(2274,"Grey-25%"),id:"#c0c0c0"},{n:mstrmojo.desc(2485,"Rose"),id:"#ff99cc"},{n:mstrmojo.desc(2486,"Tan"),id:"#ffcc99"},{n:mstrmojo.desc(2282,"Light Yellow"),id:"#ffff99"},{n:mstrmojo.desc(2481,"Light Green"),id:"#ccffcc"},{n:mstrmojo.desc(2479,"Light Turquoise"),id:"#ccffff"},{n:mstrmojo.desc(2482,"Pale Blue"),id:"#99ccff"},{n:mstrmojo.desc(2290,"Lavender"),id:"#cc99ff"},{n:mstrmojo.desc(2293,"White"),id:"#ffffff"}];var E=[];mstrmojo.util.ui.ColorPicker={getBasicColors:function B(){return A.slice();},getCustomColors:function D(){return E.slice();},addCustomColor:function C(G){var F=function(H){return H.id===G;};if(!A.filter(F)[0]&&!E.filter(F)[0]){E.push({n:G,id:G});if(E.length>8){E.shift();}}}};}());mstrmojo.mapbox.MapboxEnums={};mstrmojo.mapbox.ID_SUFFIX={Source:"-source",Hover:"-hover",Selection:"-selection",Unselected:"-unselected",ContextMenu:"-contextmenu",SelectionContextMenu:"-selection-contextmenu",Cluster:"-clusters",DataLabel:"-datalabel",Border:"-border"};mstrmojo.mapbox.FILTER={SINGLE:["!has","point_count"],CLUSTER:["has","point_count"],NOFEATURE:["==","id",""],NOCLUSTER:["==","cluster_id",""]};mstrmojo.mapbox.DEFAULT_DATA_LABEL_PROPS_MAPBOX={dlShw:[0],dlShwAll:[false],dlFntFml:["Arial Unicode"],dlFntSz:["10pt"],dlFntStyle:[0],dlFntClr:[0],dlFntHaloClr:["white"]};mstrmojo.mapbox.EXCLUDED_FONT_FAMILIES=["Batang","Bookshelf Symbol 1","Bookshelf Symbol 2","Bookshelf Symbol 3","Map Symbols","Marlett","Monotype Sorts","MS Outlook","MT Extra","Symbol","Webdings","Wingdings","Wingdings 2","Wingdings 3"];mstrmojo.mapbox.FONT_FAMILIES_MAPPING={Arial:{normal:"Arial WGL Regular",bold:"Arial WGL Bold",italic:"Arial WGL Italic",bolditalic:"Arial WGL Bold Italic"},ArialBlack:{normal:"Arial Black Regular",italic:"Arial Black Italic"},ArialNarrow:{normal:"Arial Narrow MT Pro Regular",bold:"Arial Narrow MT Std Bold",italic:"Arial Narrow MT Std Italic",bolditalic:"Arial Narrow MT Std Bold Italic"},ArialUnicodeMS:{normal:"Arial Unicode MS Regular",bold:"Arial Unicode MS Bold",italic:"Arial Unicode MS Italic",bolditalic:"Arial Unicode MS Bold Italic"},Batang:{normal:"Batang Regular"},BookAntiqua:{normal:"Book Antiqua Regular",bold:"Book Antiqua Bold",italic:"Book Antiqua Italic",bolditalic:"Book Antiqua Bold Italic"},BookmanOldStyle:{normal:"Bookman Old Style Regular",bold:"Bookman Old Style Bold",italic:"Bookman Old Style Italic",bolditalic:"Bookman Old Style Bold Italic"},BookshelfSymbol1:{normal:"Bookshelf Symbol 1 Regular"},BookshelfSymbol2:{normal:"Bookshelf Symbol 2 Regular"},BookshelfSymbol3:{normal:"Bookshelf Symbol 3 Regular"},ComicSansMS:{normal:"Comic Sans MS Regular",bold:"Comic Sans MS Bold",italic:"Comic Sans MS Italic",bolditalic:"Comic Sans MS Bold Italic"},CourierNew:{normal:"Courier New Regular",bold:"Courier New Bold",italic:"Courier New Italic",bolditalic:"Courier New Bold Italic"},Garamond:{normal:"Garamond Regular",bold:"Garamond Bold",italic:"Garamond Italic",bolditalic:"Garamond MT Bold Italic"},Haettenschweiler:{normal:"Haettenschweiler Regular"},Helvetica:{normal:"Helvetica LT Pro Regular",bold:"Helvetica LT Pro Bold",italic:"Helvetica LT Pro Italic",bolditalic:"Helvetica LT Pro Bold Italic"},Impact:{normal:"Impact Regular"},LucidaConsole:{normal:"Lucida Console Regular"},LucidaSansUnicode:{normal:"Lucida Sans Unicode Regular"},MapSymbols:{normal:"Map Symbols Regular"},Marlett:{normal:"Marlett Regular"},MonotypeCorsiva:{normal:"Monotype Corsiva Regular"},MonotypeSorts:{normal:"Monotype Sorts Regular"},MSGothic:{normal:"MS Gothic Regular"},MSOutlook:{normal:"MS Outlook Regular"},MicrosoftSansSerif:{normal:"Microsoft Sans Serif Regular"},MTExtra:{normal:"MT Extra Regular"},OpenSans:{normal:"Open Sans Regular"},OpenSansSemiBold:{normal:"Open Sans SemiBold"},Symbol:{normal:"Symbol Regular"},Tahoma:{normal:"Tahoma Regular",bold:"Tahoma Bold",italic:"Tahoma Italic",bolditalic:"Tahoma Bold Italic"},TimesNewRoman:{normal:"Times New Roman MT Regular",bold:"Times New Roman MT Bold",italic:"Times New Roman MT Italic",bolditalic:"Times New Roman MT Bold Italic"},TrebuchetMS:{normal:"Trebuchet MS Regular",bold:"Trebuchet MS Bold",italic:"Trebuchet MS Italic",bolditalic:"Trebuchet MS Bold Italic"},Verdana:{normal:"Verdana Regular"},Webdings:{normal:"Webdings Regular"},Wingdings:{normal:"Wingdings Regular"},Wingdings2:{normal:"Wingdings 2 Regular"},Wingdings3:{normal:"Wingdings 3 Regular"}};mstrmojo.EnumDSSDisplayMode={RESERVED:0,GRID:1,GRAPH:2,ENGINE:3,TEXT:4,DATAMART:5,BASE:6,GRIDGRAPH:7,NONINTERACTIVE:8};(function(){mstrmojo._HasDrillLinks=mstrmojo.provide("mstrmojo._HasDrillLinks",{_mixinName:"mstrmojo._HasDrillLinks",update:function A(E){this._super(E);var B=E.defn.dl,F=E.data.dl,D=this.drillLinkItems=((B&&B.items)||[]).concat((F&&F.items)||[]).sort(function(H,G){return H.index-G.index;}),C;for(C=D.length-1;C>=0;C--){if(C&&D[C].index===D[C-1].index){D.splice(C,1);}}if(B&&B.target){for(C=0;C<D.length;C++){D[C].target=B.target;}}}});}());mstrmojo.EnumSelectionType={ALL:0,ELEMENT:1,BRANCH:2,LEVEL:3,BRANCH_LEVEL:4};mstrmojo.mstr.EnumDSSXMLObjectTypes={Generic:-2,Unknown:-1,Reserved:0,Filter:1,Template:2,ReportDefinition:3,Metric:4,Style:6,AggMetric:7,Folder:8,SubscriptionDevice:9,Prompt:10,Function:11,Attribute:12,Fact:13,Dimension:14,Table:15,DatamartReport:16,FactGroup:17,Shortcut:18,Resolution:19,Monitor:20,AttributeForm:21,Schema:22,Format:23,Catalog:24,CatalogDefn:25,Column:26,PropertySet:28,DBRole:29,DBLogin:30,DBConnection:31,Project:32,ServerDef:33,User:34,Configuration:36,Request:37,Script:38,Search:39,SearchFolder:40,Datamart:41,FunctionPackageDefinition:42,Role:43,SecurityRole:44,Locale:45,Consolidation:47,ConsolidationElement:48,ScheduleEvent:49,ScheduleObject:50,ScheduleTrigger:51,Link:52,DbTable:53,TableSource:54,DocumentDefinition:55,DrillMap:56,DBMS:57,MDSecurityFilter:58,PromptAnswer:59,PromptAnswers:60,ObjectTag:65,ReservedLastOne:66};(function(){mstrmojo.requiresDescs(9380,9381,9382,9383,9384,9385,9379,15106,15107,10639,10159,9705,9704);mstrmojo.DI.DIConstants=mstrmojo.provide("mstrmojo.DI.DIConstants",{invalidObjectNameChars:'\\"[]',invalidObjectNameCharsRegex:/[\\"\[\]]/,sourceItemLinkType:{dbList:0,oauthPara:1},setDefaultOAuthParamCMD:"MSTR_DEFAULT_OAUTH_PARAMS",actions:{none:0,importSource:1,editImport:2,transform:3,changeSheet:4,publish:5,changeMappings:6,refine:7,quickPreview:8,savePublish:9,getFlatPreview:10,refreshData:11,mergeCube:12},localStorageKey:{HGOSFileTypeTooltipPop:"HGOSFileTypeTooltipPop"},requestFlag:{mapping:1,preview:2,sourceInfo:4,refineSourceInfo:8,sheets:16,crb:32,transformations:64,transformedPreview:128,relationship:256,stateInfo:512,anyState:268435456,fullData:1024,refineInnerData:2048},formMappingFlag:{formMappingFlagReserved:0,formMappingFlagRemoveGeoRole:1,formMappingFlagRemoveTimeRole:2,formMappingFlagRemoveDeriveFlags:4},browseFlag:{reportBindingTable:1,dataPreview:4,publish:16,cubeConfig:68,reportLevelProperty:256},importBehaviorFlag:{reserved:0,newColumnsSilent:1,dataTypeSilent:2},saveAsFlags:{saveAsOverWrite:32,saveAsManaged:524288,saveAsDDA:33554432,saveAsInMemory:67108864,saveAsWithPrompts:4096,saveAsWithAnswers:4},connectLiveSupport:{connectLiveSupportUnknown:0,connectLiveSupportDDAOrInMemory:1,connectLiveSupportInMemoryOnly:2,connectLiveSupportDDAOnly:3},xdaType:{excel:272,text:288,refine:384,salesforce:337,querybuilder:352,ffsql:304,mdx:2,customFreeFormSQL:3,googleAnalytics:390,googleBigQuery:341,googleBigQueryFFSQL:342,googleBigQuerySingleTable:345,qbSingleTable:368,twitter:343,facebook:344,dataImport:256,projectsImport:400,sparkDataset:416,dataImportFileExcel:16|256,dataImportFileText:32|256,dataImportCustomSQL:48|256,dataImportTable:64|256,dataImportOAuth:80|256,dataImportBISource:144|256,dataImportOAuthSalesforce:1|336,dataImportOAuthGDocs:2|336,dataImportOAuthGDrive:2|336,dataImportOAuthDropbox:3|336,dataImportOAuthGAnalytics:4|336,dataImportOAuthGBigQuery:5|336,dataImportOAuthGBigQueryFFSQL:6|336,dataImportOAuthGBigQuerySingleTable:9|336,spark:160|256},fileTypes:[{n:"CSV/TXT",v:"CSV"},{n:"PARQUET",v:"PARQUET"},{n:"AVRO",v:"AVRO"},{n:"ORC",v:"ORC"},{n:"JSON",v:"JSON"},{n:"PARQ",v:"PARQUET",visible:false}],sourceInfoDesc:{json:"DB_FILE_TYPE_JSON"},sourceType:{file:1,salesforce:2,dropbox:3,googleDrive:4,googleAnalytics:5,googleBigQuery:6,querybuilder:7,mstrFile:8,mdx:9,hadoop:10,twitter:11,facebook:12,bisource:13,remoteProject:14,importfromcube:15,dataFromPushApi:16,newConnector:17,cloudElement:18},sourceSubtype:{localFile:1,url:2,salesforce:3,dropbox:4,googleDrive:5,googleAnalytics:6,googleBigQuery:7,querybuilder:8,samplefile:9,clipboard:10,googleBigQueryFFSQL:11,searchOnSource:12,mdx:13,hadoop:14,twitter:15,facebook:16,bisource:17,remoteProject:18,googleBigQuerySingleTable:19,hanaSingleTable:20,publicData:21,importfromcube:22,dataFromPushApi:23,cloudElement:24,},backendSourceSubtype:{localFile:65537,url:65539,samplefile:65540,clipboard:65538,newConnector:65544,cloudElement:65552,hadoopFileBrowser:65541,customSQL:131073,customSQLWizard:131074,singleTable:131075,bISources:131076,searchAsASource:131078,salesforce:196609,dropbox:196610,facebook:196611,twitter:196612,googleDrive:196613,googleAnalytics:196614,googleBigQuery:196615,googleBigQueryFFSQLModel:196616,googleBigQuerySingleTable:196617,OLAPSources:327681,publicData:65542,dataFromPushApi:65543,dataFromPushApiV2:65545,cloudElement:65552,},sourceItemType:{file:0,url:1,database:2,hadoop:3,olap:4,publicData:5,salesforce:6,googleAnalytics:7,googleBigQuery:8,googleDrive:9,dropbox:10,searchAsASource:11,clipboard:12,bISources:13,facebook:14,twitter:15,samplefile:16,importFromCube:17,addNewConnector:18,newConnector:19,cloudElement:20,unknow:-1},columnState:{reserved:0,unchanged:1,newColumn:2,missing:4,changed:8},operationMode:{create:0,edit:1,refresh:2,subscribe:3,enterCredentials:4,oauth:5,pickTable:6,hadoopPickTable:7,ffsql:8,hadoopFFsql:9},statusCode:{obtainSource:-2147071874,xformsError:-2147071872,mappingError:-2147071871,edit:1,republish:2,schedule:3,enterCredentials:4,pickTable:5,hadoopPickTable:6,ffsql:7,hadoopFFsql:8},pageType:{intro:0,file:1,database:2,emmaPreview:3,redirect:4,analytics:5,dataSelection:6,suggestNewSource:7,sourceIntro:8,sourceObjects:10,sampleFiles:11,dataset:12,externalPage:13,preview:14,clipboard:15,refine:16,parse:17,mstrFile:18,allProjectSource:19,hadoop:20,twitter:21,facebook:22,sourceObjectsDnD:23,schedule:24,publicData:25,republish:26,sourceAdmin:27,importFromCube:28,addNewConnector:29,newConnector:30,addConnectorList:31,cloudElement:32},backendError:{overwriteObject:-2147212339,noPermission:-2147214579,invalidObjectName:-2147213715,unexpectedDataType:-2147212539,noExternalSession:-2147071844,noPrivilege:-2147212082,salesforceUnsavedReport:-2147212081,salesforceObsoleteReport:-2147212080,maxSizeExceeded:-2147212076,maxSizeExceededURL:-2147212121,salesforceUnresolvedFilter:-2147212074,incrementalRefresh:-2147212287,invalidUrl:-2147212062,fileVersionError:-2147212064,emptySheet:-2147212144,refreshTokenUnavailable:-2147202875,cubeQuotaExceeded:-2147071825,notEnoughSpace:-2147071811,importedURLInvalid:-2147212122,unsupportedFileFormat:-2147212063,objectNameTooLong:-2147217407,noExternalSourceInfo:-2147215346,memoryConsumptionExceeded:-2147215346,cubeQuotaReached:-2147071870,switchingFileType:-2147212140,memoryGovernSizeExceeded:-2147181051,stringTooLong:-2147213718,missingColumn:-2147071871,dataDiscoveryError:-2147211998,refineApplyError:-2147202299,serverOutOfMemory:-2147212055,columnCountMatchError:-2147467259,incompatibleDataTypeError:-2147211983,reportTimeout:-2147212335,requestTimeout:-2147206497,databaseCredentialsNotAvailable:-2147212037,ddasupportIncompatible:-2147215326,mergeInvalidXdatype:-2147215325,notFullyControl:-2147214579,shouldBeIgnored:-2147212123,CECredentialNotAvailable:-2147215317,AuthenticationError:-2147215346,queryEngineGeneralError:-2147212544},transformation:{xtab:1,delimiter:2},application:{platform:"Platform",cloudPersonal:"Personal",cloudProfessional:"Professional"},refreshOptions:{replace:1,append:2,update:4},cubeRefreshType:{dummy:-1,reserved:0,add:1,remove:2,update:3,upsert:4,addNewTable:5,deleteTable:6,replaceTable:7,preserve:8},tableStatsExecutionAction:{reserved:0,forceExecution:1,ignore:4,requireFreshData:268435456},sourcesInfoFlags:{none:0,getReports:1,getUserName:2,getTokensInfo:4,revokeSession:8,getGAnalyticsAccount:64},queryBuilderType:{individualTable:1,multipleTables:2,queryScript:3},relationshipEditType:{create:1,changeERType:2,remove:3,flip:8001},ERType:{reserved:0,ERType11:1,ERType1M:2,ERTypeM1:3,ERTypeMM:4,ERTypeParallel:5,ERTypePerpendicular:6},RSType:{reserved:0,auto:1,geo:2,defined:3},tableStates:{newly:1,old:2},behaviorChangeFlag:{multiSheet:4,remapping:8,refreshData:16},menuItems:{SEPARATOR:-1,NONE:0,TABLE_RENAME:1,DO_NOT_IMPORT:2,FLIP_ORDER:3,DELETE:4,RELATIONSHIP_TYPE:5,ONE_TO_ONE:6,ONE_TO_MANY:7,MANY_TO_ONE:8,MANY_TO_MANY:9,REMOVE:10,REFRESH_DATA:11,REFINE:12,CANCEL_REFINE:13,UNLINK:14,CHANGE_DATA_TYPE:15,MARK_GEO_ROLES:16,CREATE_TIME_ATTRIBUTES:17,TO_METRIC:18,TO_ATTRIBUTE:19,MAP_TO_PROJECT_ATTRIBUTE:20,UNMAP:21,MODIFY_ATTRIBUTE_GROUP:22,CREATE_ATTRIBUTE_GROUP:23,HIDE_ALL_ATTRIBUTE_FORMS:24,DEFINE_RELATIONSHIPS:25,LINK:26,ITEM_RENAME:27,CREATE_MULTIFORM_ATTRIBUTE:28,EDIT_MULTIFORM_ATTRIBUTE:29,ADDTO_MULTIFORM_ATTRIBUTE:30,SHOW_ALL_ATTRIBUTE_FORMS:31,SHOW_ALL_COLUMNS:32,PARTITION:33,REFINE_RENAME:34,REFINE_DELETE:35,REFINE_DELETE_ALL:36,REFINE_RESET:37,REFINE_RESET_ALL:38,PARSE:39,IMPORT:40,UNLINK_ALL:41,CREATE_HIERARCHY_ATTRIBUTE:42,EDIT_HIERARCHY_ATTRIBUTE:43,RESET_HIERARCHY_ATTRIBUTE:44},dataTypeMenuItems:{DATE_TIME:"1",NUMBER:"2",TEXT:"3",URL:"5",EMAIL:"6",HTML_TAG:"7",DATE:"8",TIME:"9",SYMBOL:"10",BIG_DECIMAL:"11",PHONE_NUMBER:"12"},columnDataTypes:{reserved:0,integer:1,unsigned:2,numeric:3,decimal:4,real:5,dtdouble:6,dtfloat:7,dtchar:8,varChar:9,longVarChar:10,binary:11,varBin:12,longVarBin:13,date:14,dttime:15,timeStamp:16,nChar:17,nVarChar:18,nlong:22,bigDecimal:30,cellFormatData:31,utf8Char:33,int64:34},formsOptions:{CREATE_MULTIFORM_ATTRIBUTE:1,EDIT_MULTIFORM_ATTRIBUTE:2,ADDTO_MULTIFORM_ATTRIBUTE:3},hierarchyOptions:{CREATE_HIERARCHY_ATTRIBUTE:1,EDIT_HIERARCHY_ATTRIBUTE:2,RESET_HIERARCHY_ATTRIBUTE:3},rdcsFlag:{ID:1,JOIN_ID:2,FILTER_ID:3,DISTANCE:4},timeRoles:{NONE:0,DATE:1,DATE_TIME:2,TIME:3,SECOND:4,MINUTE:5,HOUR:6,DAY:7,WEEK:8,MONTH:9,QUARTER:10,YEAR:11},contextMenuType:{ITEM_MENU:0,TABLE_MENU:1,PREVIEW_ITEM_MENU:2,LINK_MENU:3},dialogType:{fixRefreshErrorDialog:1,allObjectsViewDialog:2,missingColumnsDialog:3,diPageDialog:4,refreshHistoryDialog:5,alternateSourceValidateDialog:6,ddaConfirmDialog:7,publishStatusDialog:8,saveAsDialog:9,cubesList:10,refinePage:11,multiFormEditor:12,sheetsSelectionDialog:13,partitionGroupDialog:14,parseDataDialog:15,errorDialog:16,warningDialog:17,relationDefineDialog:18,qbImportOptionDialog:19,previewRenameDialog:20,mapProjectsAttributeDialog:21,setOAuthParaDialog:22,objectPicker:23,refineClusteringPage:24,refineExtractDialog:25,refineImportDialog:26,twitterAdvOptDialog:27,credentialsDialog:28,mapProjectsAttributeDialog2:29,setWhiteListDialog:30,binaryUploadDialog:31,authenticationDialog:32,sharingDialog:33,hadoopGatewayManagerDialog:34,hadoopGatewayDialog:35,addConnectorDialog:36,hierarchyAttributeDialog:37,hierarchyAttributeResetDialog:38},dataEvents:{DATA_PREVIEW_EVENT:"dataReturned",NO_DATA_RETURNED_EVENT:"noDataReturned"},cubeSchedStatus:{unexecuted:1,successful:2,unscheduled:3,failed:4},privilegeType:{accessDatabase:1,accessFile:2,accessCloud:3},dbType:{MS_ACCESS:100,ORACLE:200,SQL_SERVER:300,INFORMIX:400,SYBASE:500,REDBRICK:600,DB2:700,TANDEM:800,TERADATA:900,UNKNOWN:1000,GENERIC:1100,SAP:1200,NETEZZA:1300,EXCEL:1400,MSFT_AS:1500,ESSBASE:1600,MYSQL:1700,POSTGRESQL:1800,HPNEOVIEW:1900,METAMATRIX:2000,DATALLEGRO:2100,COMPOSITE:2200,ASTER:2300,VERTICA:2400,OPENACCESS:2500,SYBASE_SQL_ANY:2600,SYBASE_IQ:2700,PARACCEL:2800,TM1:2900,XQUERY:3000,HIVE:3100,SAND:3200,SALESFORCE:3300,HIVETHRIFT:3400,VECTORWISE:3500,ENTERPRISEDB:3600,KOGNITIOWX2:3700,EXASOLUTION:3800,INFORMATICA:3900,SAPHANA:4000,IMPALA:4100,AMAZON_REDSHIFT:4200,DENODO:4300,GOOGLE_DRIVE:4400,DROPBOX:4500,GOOGLE_ANALYTICS:4600,GOOGLE_BIGQUERY:4700,CONNECTION_CLOUD:4800,GOOGLE_BIG_QUERY_FFSQL_MODEL:4900,PARSTREAM:5100,MONGODB:5200,MARKLOGIC:5300,BIG_DATA_ENGINE:5400,SEARCH_ENGINE_SOLR:5500,SPLUNK:5600,TWITTER:5700,FACEBOOK:5800,PIG:6400,URL:7700,newConnector:7900,LOACLFILE:8200},getCubeQuotaAndInfosOptions:{GetCubeQuotaAndInfosReserved:0,GetCubeQuotaAndInfosDefault:1,GetCubeQuotaAndInfosQuotaOnly:2,GetCubeQuotaAndInfosAll:3,GetCubeQuotaAndInfosVI:4},homepageViewMode:{GRID_VIEW:0,LIST_VIEW:1},datasetServeMode:{inMemory:1,dda:2,unknow:3},cubePollStatus:{msgID:0,result:1,prompt:2,error:3,xmlResult:21},ibmDb2Versions:[17,18,21,22,23,24,25,37,45,46,47,48,63,66,74,89,92,101,103,105,123,134,157,172,202,232],hadoopDbTypes:[3100,1100,700,4100,7300,6800,6400,8100],formCategory:{longitude:"2345134F4F5E261C3BB902A874467080",latitude:"B191051C48221A6AE44CA2B65B1B65E3"},urlAuthDBRoles:{anonymous:"CB1CB472A07E41D5AE038232839F2064",windows:"95A5ACC02FE94CBABCB65E4F2D2415B2",kerberos:"317D6F016D784836A724AD4D739E1E9C",integrated:"E966E1A0A4C949108287B2E5086B68EB"},urlAuthDBMSId:"497F2406FA154B86810C71EA3D401D6D",newConnectorDBMSId:"565D5DC3A1124726B85FE53EF992472A",hadoopGateWay:{HGoS_CONFIG_HAS_EXIT:1510,CONNOT_AUTHENTICATE:1511,SPACE_OVER:1512,FAIL_COPY_TO_HOST:1513,INSUFFICIENT:1514,DIRECTORY_NO_EXIST:1515,HGOS_DEPLOYED:1518,HGOS_DEPLOYING:1519,CONNOT_AUTHENTICATE2:1520,HGOS_RUNNING:1521,HGOS_STOPPED:1522,HGOS_NOT_DEPLOYING:1523,HGOST_TAR_NOT_EXIST:1524,HGOS_CONF_NOT_EXIST:1530},workstation:{filerBreakLine:new RegExp("[\r\n]","g"),utils:{shouldShowTitleBar:function(){var A=mstrApp.getRootController().rootView.inPageDialog;return !!mstrApp.isWorkstation&&(!!mstrApp.isPopup||!!A);},setNativeWindow:function(C,F){var B=1110,E=590,D=parseInt(C,10),A=parseInt(F,10);if(!window.FormWrapper||!window.FormWrapper.setWindowFrame){return ;}if(C.match(/%$/)&&F.match(/%$/)){window.FormWrapper.setWindowContentSize(1200,680);}else{D=D<B?B:D;A=A<E?E:A;window.FormWrapper.setWindowContentSize(D,A);}},lockResize:function(){if(!window.FormWrapper||!window.FormWrapper.lockResize){return ;}window.FormWrapper.lockResize();},unlockResize:function(){if(!window.FormWrapper||!window.FormWrapper.unlockResize){return ;}window.FormWrapper.unlockResize();}}},authMode:{ANONYMOUS:0,USERNAME:1,OAUTH:2},authModePrefix:{ANONYMOUS:"AuthMode=Anonymous;URL=",USERNAME:"AuthMode=Basic;URL=",OAUTH:"AuthMode=OAuth;URL="},sdkUrl:{MARKPLACE_URL:"https://community.microstrategy.com/s/gallery?tabset-89baf=202df",QUICK_START_URL:"https://lw.microstrategy.com/msdz/MSDL/GARelease_Current/docs/projects/DataConnectorSDK/Content/topics/Quick_Start_Guide.htm"},originalConnector:{elastic:"DE4A8E15405A36D80BF1E1A2BA6F9B66",tapClicks:"1E8ADD3975DA4609B8D00E6211ACAB6A"},googleAnalyticsUrl:{queryExplorer:"https://ga-dev-tools.appspot.com/query-explorer/"},weekDay:[{n:mstrmojo.desc(9380,"Monday"),v:0},{n:mstrmojo.desc(9381,"Tuesday"),v:1},{n:mstrmojo.desc(9382,"Wednesday"),v:2},{n:mstrmojo.desc(9383,"Thursday"),v:3},{n:mstrmojo.desc(9384,"Friday"),v:4},{n:mstrmojo.desc(9385,"Saturday"),v:5},{n:mstrmojo.desc(9379,"Sunday"),v:6}],dateMon:[{n:mstrmojo.desc(15106,"1st day"),v:"1"},{n:mstrmojo.desc(15107,"15th day"),v:"15"}],timeOfDay:[{n:"12:00AM",v:"12:00AM"},{n:"1:00AM",v:"1:00AM"},{n:"2:00AM",v:"2:00AM"},{n:"3:00AM",v:"3:00AM"},{n:"4:00AM",v:"4:00AM"},{n:"5:00AM",v:"5:00AM"},{n:"6:00AM",v:"6:00AM"},{n:"7:00AM",v:"7:00AM"},{n:"8:00AM",v:"8:00AM"},{n:"9:00AM",v:"9:00AM"},{n:"10:00AM",v:"10:00AM"},{n:"11:00AM",v:"11:00AM"},{n:"12:00PM",v:"12:00PM"},{n:"1:00PM",v:"1:00PM"},{n:"2:00PM",v:"2:00PM"},{n:"3:00PM",v:"3:00PM"},{n:"4:00PM",v:"4:00PM"},{n:"5:00PM",v:"5:00PM"},{n:"6:00PM",v:"6:00PM"},{n:"7:00PM",v:"7:00PM"},{n:"8:00PM",v:"8:00PM"},{n:"9:00PM",v:"9:00PM"},{n:"10:00PM",v:"10:00PM"},{n:"11:00PM",v:"11:00PM"}],schedule:{DAILY:"Daily",WEEKDAY:"Weekday",WEEKLY:"Weekly",MONTHLY:"Monthly"},mainPage:{GRID_MODE:0,LIST_MODE:1},sourceIconClsName:{0:"ds-Generic",1:"ds-DB2",2:"ds-DB2",3:"ds-DB2",4:"ds-InformixWire",5:"ds-InformixXPS",6:"ds-PostgreSQL",7:"ds-SAP",8:"ds-SAP",9:"ds-Oracle",10:"ds-MicroSoft",11:"ds-Teradata",12:"ds-MySQL",13:"ds-GreenPlum",14:"ds-Netezza",15:"ds-WebServices",17:"ds-Infobright",18:"ds-Salesforce",19:"ds-MicroSoft",20:"ds-Actian-n",21:"ds-Amazon-Redshift",22:"ds-Impala",23:"ds-Aster",25:"ds-Actian-n",26:"ds-EnterpriseDB",27:"ds-Vertica",28:"ds-Denodo",29:"ds-CiscoDataVirtualization",31:"ds-MicroSoft",32:"ds-GoogleBigQuery",33:"ds-SAP",35:"ds-IBMBigInsights",39:"ds-TM1",41:"ds-WebServices",43:"ds-Amazon-EMR",44:"ds-Apache-Hive",45:"ds-ClouderaHive",46:"ds-HortonworksHive",47:"ds-MapRHive",48:"ds-apache",49:"ds-SharkSpark",50:"ds-MongoDB",52:"ds-MariaDB",51:"ds-MarkLogic",54:"ds-Splunk",55:"ds-DataDirectCloud",56:"ds-ParStream",58:"ds-Phoenix",59:"ds-MicroSoft",60:"ds-DB2",61:"ds-Oracle",62:"ds-Teradata",63:"ds-SAP",65:"ds-PostgreSQL",66:"ds-MySQL",67:"ds-MariaDB",68:"ds-Amazon-EMR",69:"ds-Apache-Hive",70:"ds-ClouderaHive",71:"ds-HortonworksHive",72:"ds-MapRHive",73:"ds-SharkSpark",75:"ds-Amazon-Redshift",76:"ds-PIVOTALHAWQ",77:"ds-MemSQL",78:"ds-Arcadia-Platform",79:"ds-Altibase",80:"ds-MongoDB",81:"ds-Presto",82:"ds-DB2",83:"ds-DB2",84:"ds-InformixWire",85:"ds-SAP",86:"ds-MicroSoft",87:"ds-MicroSoft",88:"ds-MemSQL",90:"ds-GreenPlum",91:"ds-PIVOTALHAWQ",92:"ds-Netezza",93:"ds-Infobright",94:"ds-Actian-n",95:"ds-Impala",96:"ds-IBMBigInsights",97:"ds-Aster",99:"ds-Actian-n",100:"ds-EnterpriseDB",101:"ds-Vertica",102:"ds-Denodo",103:"ds-CiscoDataVirtualization",105:"ds-DataDirectCloud",106:"ds-ParStream",107:"ds-Arcadia-Platform",109:"ds-Presto",110:"ds-Phoenix",111:"ds-Kognitio",112:"ds-Kognitio",113:"ds-Informatica",114:"ds-Informatica",115:"ds-Apache-Cassandra-JDBC",116:"ds-SAP",117:"ds-Actian",118:"ds-Actian",119:"ds-InformixXPS",120:"ds-Apache-Cassandra-JDBC",121:"ds-MapRDrill",122:"ds-Cirro",123:"ds-EXASolution",124:"ds-EXASolution",125:"ds-Oracle",126:"ds-Oracle",127:"ds-Snowflake",128:"ds-Snowflake",129:"ds-Amazon-Aurora",130:"ds-Amazon-Aurora",131:"ds-Amazon-Athena",132:"ds-Amazon-Athena",133:"ds-MapRDrill",134:"ds-Druid",135:"ds-Druid",139:"ds-MongoBI",157:"ds-GoogleBigQuery",161:"ds-MapD",168:"ds-HortonworksSpark",169:"ds-HortonworksSpark",170:"ds-Yellowbrick",},dispTag:{1:"Database",2:"OLAP",4:"BigData",8:"Database",16:"BigData",32:"BigData"},searchTags:{100:["Database","ODBC"],200:["Database","ODBC"],300:["Database","ODBC"],400:["Database","ODBC"],500:["Database","ODBC"],600:["Database","ODBC"],700:["Database","ODBC"],900:["Database","ODBC"],1100:["Database","ODBC"],1200:["OLAP","Cube"],1300:["Database","ODBC"],1400:["Database"],1500:["OLAP","Cube"],1600:["OLAP","Cube"],1700:["Database","ODBC"],1800:["Database","ODBC"],2200:["Database","ODBC"],2300:["Database","ODBC"],2400:["Database","ODBC"],2800:["Database","ODBC"],2900:["OLAP","Cube"],3000:["Database"],3100:["Database","BigData","Hadoop"],3300:["Cloud"],3500:["Database","ODBC"],3600:["Database","ODBC","BigData"],3800:["Database"],3900:["Database"],4000:["Database","ODBC"],4100:["Database","BigData","Hadoop"],4200:["Database","ODBC"],4300:["Database","ODBC"],4700:["Database","Cloud","BigData"],4800:["Cloud"],5200:["Database","NoSQL"],5300:["Database","NoSQL"],5400:["Hadoop"],6400:["Database","BigData","Hadoop"],6600:["Database"],6700:["Database"],6800:["BigData"],6900:["BigData"],7100:["NoSQL"],7200:["Database"],7300:["BigData","Hadoop"],7500:["Database"],7600:["Database"],8000:["Database"],8100:["BigData"],},srcItemTypes:{ALL_SOURCES:"ALL_SOURCES",STATIC_SOURCE:"STATIC_SOURCE",DBTYPE_SOURCE:"DBTYPE_SOURCE",CUSTOM_CONNECTOR:"CUSTOM_CONNECTOR",CLOUDELEMENT_CONNECTOR:"CLOUDELEMENT_CONNECTOR"},combination:{BigData:["BigData","NoSQL","Search","Hadoop"],Apps:["Apps","oAuth","Cloud","Social","BI","PublicData","CE"]},GenericDBStr:"Generic",dataSourceType:{MONGODB:"mongodb",FILE_URL:"fileUrl",FILE_LOCAL:"fileLocal",ES:"elasticsearch",DROPBOX:"dropbox",GOOGLE_DRIVE:"googleDrive",GOOGLE_ANALYTICS:"googleAnalytics",GOOGLE_BIGQUERY:"googleBigQuery",SALESFORCE:"salesforce",FILE:"file",GENERIC_JDBC:"genericJdbc"},ERDF:{ENUM_LOAD_REPORT_BROWSE_TYPE_BINDINGTABLE:1,ENUM_LOAD_REPORT_BROWSE_TYPE_DATAPREVIEW:4,ENUM_LOAD_REPORT_BINDING_FLAG_ALL:15,ENUM_LOAD_REPORT_PREVIEW_FLAG_MappingInfo:1,ENUM_LOAD_REPORT_PREVIEW_FLAG_DataInfo:2,ENUM_LOAD_REPORT_PREVIEW_FLAG_SourceInfo:4,ENUM_LOAD_REPORT_PREVIEW_FLAG_InnerDataInfo:2048,},DSSSubType:{DSSSUBTYPEATTRIBUTE:3072,DSSSUBTYPEATTRIBUTEROLE:3073,DSSSUBTYPEATTRIBUTETRANSFORMATION:3074,DSSSUBTYPEATTRIBUTEABSTRACT:3075,DSSSUBTYPEATTRIBUTERECURSIVE:3076},DSSExType:{DSSEXDISPARK:416},URLMode:{NormalUrl:0,NewConnector:1,NewConnectorEdit:2,CloudElement:3},disableFeatures:{DISABLE_CUSTOM_CONNECTOR:"disableCustomerConnector",DISABLE_DDA:"disableDDA",DISABLE_QUOTA:"disableQuota",DISABLE_HADOOP:"disableHadoop",DISABLE_BI_TOOLS:"disableBITools",DISABLE_CLIP_BOARD:"disableClipboard",DISABLE_FACE_BOOK:"disableFacebook",DISABLE_TWITTER:"disableTwitter",DISABLE_SAMPLE_FILES:"disableSampleFiles",DISABLE_PUBLIC_DATA:"disablePublicData",DISABLE_MERGE_CUBE:"disableMergeCube",DISABLE_CE_SOURCE:"disableCESource",DISABLE_FLATTERN_DB_SOURCE:"disabledSources"},DssXmlPrivileges:{DssXmlPrivilegesUseDatabaseInstanceManager:57},Enum_SourceCategoryType:{File:1,BigData:2,Database:3,OLAP:4,Customized:5,Apps:6,}});}());(function(){var A="ABCDEFGHIJKLMNOPQRSTUVWXYZabcdefghijklmnopqrstuvwxyz0123456789+/=",G=String.fromCharCode;function D(H){H=H.replace(/\r\n/g,"\n");var I="";for(var K=0;K<H.length;K++){var J=H.charCodeAt(K);if(J<128){I+=G(J);}else{if((J>127)&&(J<2048)){I+=G((J>>6)|192);I+=G((J&63)|128);}else{I+=G((J>>12)|224);I+=G(((J>>6)&63)|128);I+=G((J&63)|128);}}}return I;}function F(L){var H="",J=0,M=0,K=0,I=0;while(J<L.length){M=L.charCodeAt(J);if(M<128){H+=G(M);J++;}else{if((M>191)&&(M<224)){K=L.charCodeAt(J+1);H+=G(((M&31)<<6)|(K&63));J+=2;}else{K=L.charCodeAt(J+1);I=L.charCodeAt(J+2);H+=G(((M&15)<<12)|((K&63)<<6)|(I&63));J+=3;}}}return H;}mstrmojo.base64=mstrmojo.provide("mstrmojo.base64",{decodeHttpHeader:function E(K){var I=/\=\?UTF-8\?B\?(.+?)\?\=/g;if(K&&K.indexOf("=?UTF-8?B?")===0){var J="",H;while((H=I.exec(K))!==null){J+=mstrmojo.base64.decode(H[1]);}return J;}return K;},encode:function B(J){var H="";var Q,O,M,P,N,L,K;var I=0;J=D(J);while(I<J.length){Q=J.charCodeAt(I++);O=J.charCodeAt(I++);M=J.charCodeAt(I++);P=Q>>2;N=((Q&3)<<4)|(O>>4);L=((O&15)<<2)|(M>>6);K=M&63;if(isNaN(O)){L=K=64;}else{if(isNaN(M)){K=64;}}H+=A.charAt(P)+A.charAt(N)+A.charAt(L)+A.charAt(K);}return H;},decode:function C(J){var H="",I=0;var Q,O,M,P,N,L,K;J=J.replace(/[^A-Za-z0-9\+\/\=]/g,"");while(I<J.length){P=A.indexOf(J.charAt(I++));N=A.indexOf(J.charAt(I++));L=A.indexOf(J.charAt(I++));K=A.indexOf(J.charAt(I++));Q=(P<<2)|(N>>4);O=((N&15)<<4)|(L>>2);M=((L&3)<<6)|K;H+=G(Q);if(L!==64){H+=G(O);}if(K!==64){H+=G(M);}}H=F(H);return H;}});})();(function(){mstrmojo.vi.ui.theme=mstrmojo.provide("mstrmojo.vi.ui.theme",{getThemeClass:function A(){var D=this.parent||this.opener,C="",B;while(D){var E=D.themeClassName;if(E){C=E;break;}B=D.parent||D.opener;if(B===D){break;}D=B;}return C;}});}());mstrmojo.chart.enums.EnumGraphMajorType={GMT_INVALID:0,GMT_CATEGORY:1,GMT_PIE:2,GMT_SCATTER:3,GMT_POLAR:4,GMT_RADAR:5,GMT_BUBBLE:6,GMT_STOCK:7,GMT_HISTOGRAM:8,GMT_GAUGE:9,GMT_FUNNEL:10,GMT_BOX:11,GMT_GANTT:12,GMT_SPECTRAL:13,GMT_TABLE:14,GMT_3D_CATEGORY:15,GMT_3D_SCATTER:16,GMT_GRID:17};mstrmojo.mstr.EnumNodeDimty={NodeDimtyReserved:0,NodeDimtyNone:1,NodeDimtyContinuation:2,NodeDimtyExclusiveContinuation:3,NodeDimtyOutputLevel:4,NodeDimtyBreakBy:5,NodeDimtyEmbedded:6,NodeDimtyUnspecified:7};mstrmojo.vi.models.EnumDragSources={DATASETS:1,VIZ_EDITOR:2,FILTERS:3,ALL_OBJECT_LIST:4,VIZ:5,TOC_CHAPTER:6,TOC_PAGES_LIST:7,VIZ_LAYER:8};(function(){mstrmojo._IsGraphDataService=mstrmojo.provide("mstrmojo._IsGraphDataService",{handleUserSingleTap:function A(D,E,B,G,C,F){if(mstrApp.onMobileDevice()){mstrApp.serverRequest({taskId:"handleUserSingleTap",sliceID:D,nodekey:E,x:B,y:G,selectable:C},F);}}});}());mstrmojo.vi.viz.EnumVizStyles={GRAPH_MATRIX:"GraphMatrixVisualizationStyle",NETWORK:"NetworkVisualizationStyle",HEAT_MAP:"VIHeatMapVisualizationStyle",GOOGLE_MAP:"GoogleMapVisualizationStyle",ESRI_MAP:"ESRIMapVisualizationStyle",IMAGE_LAYOUT:"ImageLayoutVisualizationStyle",NEW_GRAPH_MATRIX:"NewGraphMatrixVisualizationStyle",MAPBOX:"MapboxVisualizationStyle",KPICARD:"KPICardVisualizationStyle"};(function(){function A(C){return function B(H){if(!this.domNode){return 0;}var G=this.children;if(H!==undefined&&!isNaN(H)){G=(G&&[G[H-1]]);}var E=(G&&G.length)||0,D=0,F;for(F=0;F<E;F++){D+=G[F]["get"+C]();}return D;};}mstrmojo._CanMeasureChildren=mstrmojo.provide("mstrmojo._CanMeasureChildren",{getHeight:A("Height"),getWidth:A("Width")});}());(function(){function E(H,G,F){return H>=G&&H<=F;}function A(G,F){return{start:G,end:F};}function C(I,G){var L=this.renderedRowsArr,K=B.call(this,I,1),J=K.index,H=L[J],F;if(!K.between){if(H&&I>H.end+1){J++;L.splice(J,0,A(I,G));}else{L.splice(J,0,A(I,G));}H=L[J];}else{H.end=Math.max(H.end,G);}while(J<L.length-1){J++;F=L[J];if(H.end+1>=F.start){H.end=Math.max(H.end,F.end);L.splice(J,1);J--;}else{break;}}}function B(G,L){var K=this.renderedRowsArr,H=0,I=K.length-1,F,J;while(H<=I){F=(H+I)/2|0;J=K[F];if(E(G,J.start,J.end+L||0)){return{between:true,index:F};}else{if(G<J.start){I=F-1;}else{H=F+1;}}}return{between:false,index:F};}mstrmojo._RowRendTracker=mstrmojo.provide("mstrmojo._RowRendTracker",{_mixinName:"mstrmojo._RowRendTracker",renderedRowsArr:undefined,init:function D(F){this._super(F);this.renderedRowsArr=[];},markPages:function(G,F){C.call(this,G,F);},searchRow:function(H){var G=B.call(this,H,0),F;if(G.between){F=this.renderedRowsArr[G.index];return{rendered:true,min:F.start,max:F.end};}return null;},unMarkAllPages:function(){this.renderedRowsArr.length=[];}});}());mstrmojo.vi.models.EnumPanelTypes={FILTERS:1,VIS_CONTENT:2,PAGEBY:3,VISUALIZATION:4};mstrmojo.requiresDescs(5547,5217,5218,5219,5220,5221);var EnumWebPromptsList=[{n:"Hierarchy Qualification Prompt",desc:"Hierarchy Qualification prompt",descId:5547,value:"editPrompt",name:"hierarchyPrompt",params:{evt:3004,target:"editPrompt",promptType:3,promptExpressionType:16}},{n:"Attribute Qualification Prompt",desc:"Attribute Qualification prompt",descId:5217,name:"aqPrompt",value:"editPrompt",params:{evt:3004,target:"editPrompt",promptType:3,promptExpressionType:17}},{n:"Attribute Element List",desc:"Att Element List prompt",descId:5218,value:"editPrompt",name:"attributePrompt",params:{evt:3004,target:"editPrompt",promptType:2}},{n:"Metric Qualification Prompt",desc:"Metric Qualification prompt",descId:5219,value:"editPrompt",name:"mqPrompt",params:{evt:3004,target:"editPrompt",promptType:3,promptExpressionType:10}},{n:"Object Prompt",desc:"Object",descId:5220,value:"editPrompt",name:"objectPrompt",params:{evt:3004,target:"editPrompt",promptType:4,}},{n:"Value Prompt",desc:"Value",descId:5221,value:"editPrompt",name:"valuePrompt",params:{evt:3004,target:"editPrompt",promptType:1,constDataType:14}}];mstrmojo.mstr.ui.EnumWebPromptsList={get:function(){var A=mstrApp.servletName||mstrApp.name;return mstrmojo.array.map(EnumWebPromptsList,function(B){B.src=A+B.evt;return B;});}};mstrmojo.mstr.EnumDSSXMLBaseFormType={DssXmlBaseFormReserved:0,DssXmlBaseFormHidden:-1,DssXmlBaseFormDateTime:1,DssXmlBaseFormNumber:2,DssXmlBaseFormText:3,DssXmlBaseFormPicture:4,DssXmlBaseFormUrl:5,DssXmlBaseFormEmail:6,DssXmlBaseFormHTMLTag:7,DssXmlBaseFormDate:8,DssXmlBaseFormTime:9,DssXmlBaseFormSymbol:10,DssXmlBaseFormBigDecimal:11,DssXmlBaseFormPhoneNumber:12};mstrmojo.mstr.EnumDSSXMLBaseFormType.convertDataType2BaseFormType=function(B){var A={0:2,1:2,2:2,3:2,4:2,5:2,6:2,7:2,8:3,9:3,10:3,11:2,12:2,13:2,14:8,15:9,16:1,17:3,18:3,21:2,22:2,23:3,30:11,31:2,33:3,34:2};return A[B]||0;};mstrmojo.chart.model.enums.EnumDSSGraphObject={DssGraphNull:-3,DssGraphBackground:1,DssGraphFrame:2,DssGraphFootnote:3,DssGraphSubtitle:4,DssGraphTitle:5,DssGraphLegendArea:6,DssGraphLegendLine:7,DssGraphLegendMarker:8,DssGraphLegendText:9,DssGraphCurve:257,DssGraphDataLine:258,DssGraphDataMarker:259,DssGraphDataText:260,DssGraphDivBiPolar:261,DssGraphErrorBar:262,DssGraphLinrExp:263,DssGraphLinrLine:264,DssGraphLinrLog:265,DssGraphLinrNatLog:266,DssGraphLinrNPoly:267,DssGraphLinrText:268,DssGraphMeanLine:269,DssGraphMovAvgLine:270,DssGraphO1Body:271,DssGraph2DO1Label:272,DssGraphO1Major:273,DssGraphO1Minor:274,DssGraphO1Super:275,DssGraphO1Title:276,DssGraphO2Body:277,DssGraph2DO2Label:278,DssGraphO2Major:279,DssGraphO2Minor:280,DssGraphO2Title:281,DssGraphConnectDataLine:282,DssGraphRiser:286,DssGraphRiserShadow:287,DssGraphStdDevLine:288,DssGraphX1Body:289,DssGraphX1Label:290,DssGraphX1Major:291,DssGraphX1Minor:292,DssGraphXTitle:293,DssGraphY1Body:295,DssGraphY1Label:296,DssGraphY1Major:297,DssGraphY1Minor:298,DssGraphY1Title:299,DssGraphY2Body:301,DssGraphY2Label:302,DssGraphY2Major:303,DssGraphY2Minor:304,DssGraphY2Title:305,DssGraph3DShowColumnHeaders:318,DssGraph3DShowLeftHeaders:321,DssGraph3DShowRightHeaders:323,DssGraph3DShowRowHeaders:325,DssGraphOBPBox:329,DssGraphOBPMedian:330,DssGraphOBPStem:331,DssGraphOBPTail:332,DssGraphPieFeelerLine:337,DssGraphPieFeelerLabel:338,DssGraphPieGroupLabel:339,DssGraphPieRingLabel:340,DssGraphPieSlice:341,DssGraphSeriesTitle:398,DssGraphConnectStackLine:399,DssGraphDataTextStackTotal:401,DssGraphOPILBLValue:418,DssGraphUserLine1:414,DssGraphUserLine2:415,DssGraphUserLine3:416,DssGraphUserLine4:417,DssGraphDataTextConnectLine:431,DssGraphGauge:444,DssGraphGaugeTitle:450,DssGraphGaugeRange:451,DssGraphY3Body:477,DssGraphY3Label:478,DssGraphY3Major:479,DssGraphY3Minor:480,DssGraphY4Body:483,DssGraphY4Label:484,DssGraphY4Major:485,DssGraphY4Minor:486,DssGraph3DColHeader:512,DssGraph3DColTitle:515,DssGraph3DDataText:518,DssGraph3DRowHeader:552,DssGraph3DRowTitle:555,DssGraph3DRYHeader:558,DssGraph3DRYTitle:561,DssGraphGaugeBorder:1319,DssGraphGaugeNeedleBase:1320,DssGraphGaugeNeedleBaseLine:1330,DssGraphZBody:10003,DssGraphTrendLine:10004,DssGraphY1RightBody:10005,DssGraphY1RightTitle:10006,DssGraphReferenceLine:10007,DssGraphStraightLine:10008,DssGraphTargetLine:10009,DssGraphRefLineText:10010,DssGraphTrendLineText:10011,DssGraphUserLabel1:100100,DssGraphUserLabel2:100101,DssGraphUserLabel3:100102,DssGraphUserLabel4:100103,DssGraphX2Body:100200,DssGraphX2Label:100201,DssGraphX2Major:100202,DssGraphX2Minor:100203,DssGraphX2Title:100204};mstrmojo.mstr.EnumDSSXMLDrillType={DssXmlDrillReserved:0,DssXmlDrillToParent:1,DssXmlDrillToChild:2,DssXmlDrillToUnit:3,DssXmlDrillToTemplate:4,DssXmlDrillToForm:5,DssXmlDrillToDetails:6,DssXmlDrillToMetric:7,DssXmlDrillFixTemplate:8,DssXmlDrillRemoveMetric:9,DssXmlDrillRemoveUnit:10,DssXmlDrillToGraphCoordinates:11};(function(){var C="xviPopopNode";function A(G){var H={};H[C]=G;return H;}mstrmojo.ui.menus._IsMenuPopup=mstrmojo.provide("mstrmojo.ui.menus._IsMenuPopup",{init:function E(G){this._super(G);var J=this.popupConfig;if(!J){throw new Error("Cannot instantiate popup without supplying the popupConfig property.");}this.addDisposable(J);var H=mstrmojo.all[J.hostId],I=J.hostElement;if(J.isHostedWithin&&H&&I){H.addSlots(A(I));this.slot=C;}},closeAllMenus:function F(){var G=this.opener;if(G&&G.closePopup){G.closePopup();}if(G&&G.closeAllMenus){G.closeAllMenus();}},open:function B(H,G){if(this._super){this._super(H,G);}},close:function D(G){if(this.slot===C){this.opener.removeSlots(A(null));}if(this._super){this._super(G);}var H=mstrmojo.all[this.popupConfig.hostId];if(H){H.closePopup();}this.destroy();}});}());mstrmojo.mstr.EnumWebAPIErrorCodes={MSI_INBOX_MSG_NOT_FOUND:-2147468986,POOL_OBJECT_NOT_FOUND_BY_ID:-2147467398,DOCDATA_PREPARE_TASK_REPORT_INCOMP:-2147466604,AUTHEN_E_LOGIN_FAIL_EXPIRED_PWD:-2147216963,AUTHEN_E_LOGIN_FAILED_NEW_PASSWORD_REQD:-2147216960,AUTHEN_E_LOGIN_FAIL:-2147216959,E_INVALID_EXPRESSION:-2147214839,MSI_ADDUSERJOB_ERROR:-2147209185,E_MSI_USERMGR_USER_NOTFOUND:-2147209051,MSI_SERVER_NOT_FOUND:-2147206923,DFC_QRYENG_RES_TRUNC:-2147205488,MSI_CUBE_NOT_PUBLISHED:-2147072488,ERROR_CREATE_REPORT_INSTANCE:-2147216373,E_UNUSED:4294967295,UICMD_DEFAULT_ERROR:10};mstrmojo.vi.models.EnumFieldTypes={TEXT:3,IMAGE:2,HTML_CONTAINER:10};(function(){mstrmojo._CanRenderChildrenOnShow=mstrmojo.provide("mstrmojo._CanRenderChildrenOnShow",{_subs_renderOnShow:null,childRenderCheck:function B(D){if(this.renderMode!=="onshow"){return this._super(D);}if(D.visible){return this._super(D);}var C=this._subs_renderOnShow;if(!C){C={};this._subs_renderOnShow=C;}if(!C[D.id]){C[D.id]=D.attachEventListener("visibleChange",this.id,"_on_child_visibleChange");}return false;},_on_child_visibleChange:function A(C){if(this.hasRendered){var E=C&&C.src;if(E&&this.childRenderCheck(E)){var D=this._subs_renderOnShow;if(D){E.detachEventListener(D[E.id]);delete D[E.id];}E.render();}}}});}());(function(){mstrmojo._HasPopup=mstrmojo.provide("mstrmojo._HasPopup",{_mixinName:"mstrmojo._HasPopup",_lastOpened:null,openPopup:function A(G,E){var C=!!G&&(typeof G==="string")&&!G.match(/\./)&&!!this[G],D=mstrmojo.registry.ref(C?this[G]:G);if(D&&D.open){if(C){this[G]=D;}if(D.disposable!==false){this.addDisposable(D);}var J=D.slot&&this[D.slot];if(J){if(D.parent!==this){if(this.addChildren){this.addChildren([D]);}else{var I=false,F=D.domNode||D.placeholder;if(F&&typeof F==="string"){F=document.getElementById(F);}if(!F){I=true;F=document.createElement("span");D.placeholder=F;}if(I||(F.parentNode!==J)){J.appendChild(F);}}}}try{D.open(this,E);}catch(H){console.log("Error opening popup: "+H);}this._lastOpened=D;}},closePopup:function B(){var C=this._lastOpened;if(C&&C.visible&&C.close){C.close();delete this._lastOpened;}}});}());(function(){var B={NetworkVisualizationStyle:{b:"vi-network.js",s:"VisualizationServerJsonDataStyle",c:"netviz.VisNetwork",oivmb:"oivm-network.js",vib:"vi-network.js"},ReportTimelineAjaxVisualizationStyle:{s:"TimelineMojoVisualizationDataStyle",c:"VisTimeline"},visAjaxDatePicker:{s:"AjaxDatePickerReportStyle",c:"VisDateSelection"},SurveyVisualizationStyle:{s:"VisualizationDataStyle",c:"SurveyVis"},VIHeatMapVisualizationStyle:{b:"vi-heatmap.js",s:"VisualizationServerJsonDataStyle",c:"heatmap.vi.VisHeatMap",oivmb:"oivm-heatmap.js",vib:"vi-heatmap.js"},KPICardVisualizationStyle:{b:"vi-kpi.js",s:"VisualizationServerJsonDataStyle",c:"kpicard.VisKPICard",lib:'[["libraries/echarts.common.min.js"],["libraries/slick/slick.min.js"]]'},GraphMatrixVisualizationStyle:{b:"vi-gm.js",s:"VisualizationServerJsonDataStyle",c:"gm.VisGraphMatrix",oivmb:"oivm-gm.js",vib:"vi-gm.js"},ESRIMapVisualizationStyle:{b:"mojo-map.js",s:"MojoXtabMapStyle",c:"VisMapBase"},MapboxVisualizationStyle:{b:"mojo-map.js",s:"MojoXtabMapStyle",c:"mapbox.VisMapbox",lib:'[["libraries/mapbox/mapbox-gl.js"],["libraries/mapbox/supercluster.min.js"],["libraries/mapbox/turf.min.4.7.3.js"]]'},NewGraphMatrixVisualizationStyle:{b:"vi-ngm.js",s:"VisualizationServerJsonDataStyle",c:"ngm.VisNewGraphMatrix",lib:'[["../VisFramework/ngm/dist/bundle/ngm.js"]]',oivmb:"oivm-ngm.js",vib:"vi-ngm.js"},GoogleMapVisualizationStyle:{b:"mojo-map.js",s:"MojoXtabMapStyle",c:"VisMapBase"}};var E={"com.microstrategy.web.vf.viewer.EsriMapApplicationViewer":"ESRIMapVisualizationStyle","com.microstrategy.web.vf.viewer.HeatMapApplicationViewer":"VIHeatMapVisualizationStyle","com.microstrategy.flex.viewer.GraphMatrixViewer":"GraphMatrixVisualizationStyle","com.microstrategy.flex.viewer.NewGraphMatrixViewer":"NewGraphMatrixVisualizationStyle","com.microstrategy.web.vf.viewer.DatePickerApplicationViewer":"visAjaxDatePicker","com.microstrategy.flex.viewer.NetViz":"NetworkVisualizationStyle"};mstrmojo.ExpressVisList=mstrmojo.provide("mstrmojo.ExpressVisList",{getVis:function D(F){return B[F]||(mstrConfig&&mstrConfig.pluginsVisList&&mstrConfig.pluginsVisList[F])||null;},findVisName:function(F){return E[F]||(mstrConfig&&mstrConfig.pluginsWidgetVisMap[F])||null;},findWidgetName:function C(H){var G;for(var F in E){if(E.hasOwnProperty(F)&&E[F]===H){G=F;break;}}if(!G&&mstrConfig&&mstrConfig.pluginsWidgetVisMap){for(var F in mstrConfig.pluginsWidgetVisMap){if(mstrConfig.pluginsWidgetVisMap.hasOwnProperty(F)&&mstrConfig.pluginsWidgetVisMap[F]===H){G=F;break;}}}return G;},getVisClass:function A(F,G){if(G.txi&&G.t===115){F=mstrmojo.DynamicClassFactory.newComponent(F,[mstrmojo._CanSupportTransaction,mstrmojo._IsEditableXtab]);}return F;}});}());(function(){var A={};mstrmojo.NumberFormat={getInstance:function B(F,G){var E=F+"--"+G;if(E in A){return A[E];}var C={parse:function(H){},format:function(H){}};if(F==="."&&G===","){C.parse=function(H){if(!H){return NaN;}var I=H.replace(/,/g,"");return Number(I);};C.format=function(H){return Number(H).toString();};}else{var D=new RegExp("\\"+G,"g");C.parse=function(I){if(!I){return NaN;}var H=I.replace(D,"").replace(F,".");return Number(H);};C.format=function(I){var H=Number(I).toString();return H.replace(".",F);};}A[E]=C;return C;}};})();mstrmojo.mstr.EnumDSSConsolidationType={DssNormal:0,DssDerivedElement:1,DssRecursiveDerivedElement:2};(function(){mstrmojo.vi.ui.rw._SavesChildPositions=mstrmojo.provide("mstrmojo.vi.ui.rw._SavesChildPositions",{scriptClass:"mstrmojo.vi.ui.rw._SavesChildPositions",getChildPositionActions:function A(){var B=this.children,C=[];B.forEach(function(D){if(D.addFormatProps){C.push(D.addFormatProps());}if(D.getChildPositionActions){C=C.concat(D.getChildPositionActions());}});return C;}});}());mstrmojo.vi.enums.EnumVisFilterType={KEEP_ONLY:0,ADV_QUALIFICATION:1,LINKING:2,DRILLING:3};mstrmojo.vi.controllers.EnumPanelManipulationType={RENAME:1,MOVE:2,DUPLICATE:3,DELETE:4,NEW:5,CROSS_CHAPTER_MOVE:6,MOVE_TO_NEW_CHAPTER:7};(function(){mstrmojo.vi.ui.tabs.LayoutTabHelper=mstrmojo.provide("mstrmojo.vi.ui.tabs.LayoutTabHelper",{position:0,saveTabBarPosition:function B(C){var D=C.tabContainerNode;if(D){this.position=D.firstChild.offsetLeft;}},applyTabBarPosition:function A(D){var C=D.tabContainerNode;if(C){C.firstChild.style.left=this.position+"px";}}});}());(function(){mstrmojo.vi.ui._IsValidURL=mstrmojo.provide("mstrmojo.vi.ui._IsValidURL",{_mixinName:"mstrmojo.vi.ui._IsValidURL",isValidURL:function A(B){var C=!!B&&B.toLowerCase();return !!C&&(C.indexOf("javascript:")===-1)&&(!mstrApp.isSingleTier||C.startsWith("http://")||C.startsWith("https://"));}});}());(function(){var E=new RegExp("^[A-Z0-9]{8}[A-Z0-9]{4}[A-Z0-9]{4}[A-Z0-9]{4}[A-Z0-9]{12}$","i");var A=2147483648;var G=Array.apply(null,Array(256)).map(function(H,I){return(I<16?"0":"")+I.toString(16).toUpperCase();});var F=(window.crypto&&window.crypto.getRandomValues)?function(){var H=new Uint32Array(4);window.crypto.getRandomValues(H);return{d0:H[0],d1:H[1],d2:H[2],d3:H[3]};}:function(){return{d0:Math.abs(Math.floor(Math.random()*A)^(+new Date())),d1:Math.abs(Math.floor(Math.random()*A)^(+new Date())),d2:Math.abs(Math.floor(Math.random()*A)^(+new Date())),d3:Math.abs(Math.floor(Math.random()*A)^(+new Date()))};};function D(H){var L=H.d0,K=H.d1,J=H.d2,I=H.d3;return G[L&255]+G[L>>8&255]+G[L>>16&255]+G[L>>24&255]+G[K&255]+G[K>>8&255]+G[K>>16&15|64]+G[K>>24&255]+G[J&63|128]+G[J>>8&255]+G[J>>16&255]+G[J>>24&255]+G[I&255]+G[I>>8&255]+G[I>>16&255]+G[I>>24&255];}mstrmojo.UUID=mstrmojo.provide("mstrmojo.UUID",{create:function C(){return D(F());},isUUID:function B(H){return H&&E.test(H.toString());}});mstrmojo.UUID.EMPTY="00000000000000000000000000000000";}());(function(){if(!mstrmojo.PerformanceLogOutput){var G={},D=true;mstrmojo.PerformanceLogOutput=mstrmojo.provide("mstrmojo.PerformanceLogOutput",{mTimers:[],mUseTimer:true,timerId:0,startTimer:function C(L,K){if(this.mUseTimer){if(K&&this.getTimerIdByName(K)>=0){return ;}var J=this.timerId++;this.mTimers.push({timeStamp:new Date(),timerId:J,desc:L.functionName+": "+L.purpose});if(K){G[K]=J;}return J;}},getTimerIdByName:function F(J){var K=G[J];return isNaN(K)?-1:K;},endTimer:function A(M){var K;if(typeof M==="string"){K=this.getTimerIdByName(M);}else{K=M;}if(this.mUseTimer){var J,P=this.mTimers;if(K===undefined){J=P.pop();}else{var L,R;for(L=0;L<P.length;L++){R=P[L];if(R.timerId===K){J=R;P.splice(L,1);break;}}}if(J){var O=J.desc;var N=new Date()-J.timeStamp;var Q=[O,N];this.visPrint("%c"+J.desc+": "+N+"ms","color: blue");H(Q);delete G[M];}}},visPrint:function I(){if(D&&window.mstr_profile&&mstr_profile.enabled&&console){Function.prototype.apply.call(console.log,console,arguments);}},recordJSHeapMemory:function E(L){var N=window.performance,M=N&&N.memory;if(this.mUseTimer&&M){L=L?(L+": "):"";var K=["usedJSHeapSize","totalJSHeapSize","jsHeapSizeLimit"],J=this;K.forEach(function(P){var Q=L+P,O=M[P]/1000;J.visPrint("%c"+Q+": "+O+"KB","color: blue");H([Q,O]);});}},exportToCsv:function B(){var K=mstrApp.rootCtrl.docCtrl.model.n+".csv",P=window.perfResults;var Q=function(W,U){var V="";var S=W[U]===null?"":W[U].toString();if(W[U] instanceof Date){S=W[U].toLocaleString();}var R=S.replace(/"/g,'""');if(R.search(/("|,|\n)/g)>=0){R='"'+R+'"';}V+=R;return V+",";};var O="";for(var M=0;M<P.length;M++){O+=Q(P[M],0);}O+="\n";for(var M=0;M<P.length;M++){O+=Q(P[M],1);}O+="\n";var J=new Blob([O],{type:"text/csv;charset=utf-8;"});if(navigator.msSaveBlob){navigator.msSaveBlob(J,K);}else{var N=document.createElement("a");if(N.download!==undefined){var L=URL.createObjectURL(J);N.setAttribute("href",L);N.setAttribute("download",K);N.style.visibility="hidden";document.body.appendChild(N);N.click();document.body.removeChild(N);}}window.perfResults=[];}});function H(K){var J=window.perfResults;if(!J){J=window.perfResults=[];}J.push(K);}}})();mstrmojo.vi.enums.EnumHiddenSections={NONE:0,HEADER:1,PATH:2,DOCKTOP:4,DATASETS:8,GALLERY:16,DOCKLEFT:32,EDITOR:64,FILTER:128,PROPERTIES:256,TOV:512,VIPANE:64+128+256};mstrmojo.vi.controllers.EnumLayoutManipulationType={RENAME:1,MOVE:2,DUPLICATE:3,DELETE:4,NEW:5};(function(){mstrmojo.cookies={};var C="%26",E="%3D",B=mstrmojo.cookies,D=function(){var F=document.cookie;if(!F||!(typeof F==="string")||F.indexOf("bSet")<0){return false;}return true;},A=function(){var F=document.cookie;F=F.split(";");for(s in F){if(F[s].indexOf("bSet")>=0){return F[s];}}return null;};mstrmojo.cookies.updateCookieSetting=function(H,N,J){try{if(!D()&&!J){return ;}var K=document.cookie,M=H+E+N+C;if(K.indexOf(H)>=0){var F=H+E,G=F+(B.getCookieSetting(H)||0),I=F+N;if(I!=G){document.cookie=K.replace(G,I);}}else{if(K.indexOf("bSet")>=0){document.cookie=K.replace("bSet=","bSet="+M);}else{if(J){document.cookie="bSet="+M+";"+K;}}}}catch(L){mstrmojo.alert(L);return ;}};mstrmojo.cookies.getCookieSetting=function(F){try{return B.getCookieList()[F];}catch(G){mstrmojo.alert(G);return ;}};mstrmojo.cookies.getCookieList=function(){try{if(!D()){return[];}var G=A(),F={},H=null;G=G.replace("bSet=","").split(C);for(H in G){H=G[H].split(E);F[H[0]]=H[1];}return F;}catch(I){mstrmojo.alert(I);return ;}};mstrmojo.cookies.enabledCookieOnBrowser=function(){var F=document.cookie;if(!F||!(typeof F==="string")){return false;}return true;};})();(function(){function D(K){var J=this.h.idx;if(J!==-1){return this.t.es[J][K];}return"";}mstrmojo.models.template.Header=mstrmojo.declare(null,null,{init:function H(J){this.h=J.h;this.t=J.t;},getName:function A(){return D.call(this,"n");},getElementId:function I(){return D.call(this,"id");},getObjectId:function B(){return D.call(this,"oid");},getElementIndex:function G(){return this.h.idx;},getActionType:function F(){return this.h.at;},isTotal:function E(){return this.h.otr===1;},getFormIndex:function C(){return this.h.fi;}});}());mstrmojo.vi.enums.EnumDerivedElementType={LIST:1,CALCULATION:2,RESIDUE:4};mstrmojo.vi.enums.EnumFeatures={SUPPORT_RESPONSIVE:"support-responsive",SUPPORT_RESPONSIVE_RESIZING:"support-responsive-resizing",SUPPORT_GHOST_IMG:"support-ghost-img",SUPPORT_NLP:"use-natural-language",SUPPORT_CONDITION_METRIC:"support_condition_metric",USE_WORKSTATION_NAMING_STYLE:"use-workstation-naming-style",SUPPORT_TOC_UPDATEPOISITION:"support-toc-updatePosition",SUPPORT_LIVEMODE:"support-livemode",NUMBER_FORMATTING:"number-formatting",SAVE_ANALYSIS:"save-analysis",INSERT_NEW_METRIC:"insert-new-metric",DATA_ENGINE_VERSION:"data-engine-version",WEB_DRILL_AND_LINK:"web-drill-and-link",WEB_IMPORT_DATABASE:"web-import-database"};mstrmojo.chart.model.enums.EnumDSSAxisName={DssAxisReserved:0,DssAxisRows:1,DssAxisColumns:2,DssAxisPages:3,DssAxisChapters:4,DssAxisAll:5,DssAxisDropZoneIndexRoot:8,DssAxisDropZoneIndexEnd:8+255,DssAxisDynamicShortcutRoot:300,DssAxisDynamicShortcutEnd:300+255};(function(){mstrmojo.hash=mstrmojo.provide("mstrmojo.hash",{copy:function B(S,R){if(S){R=R||{};var U;for(U in S){R[U]=S[U];}}return R;},copyProps:function C(U,W,R){R=R||{};if(W){var V=(U&&U.length)||0,S;for(S=0;S<V;S++){var X=U[S];if(W[X]!==undefined){R[X]=W[X];}}}return R;},forEach:function I(V,U,S){if(V){var R;for(R in V){if(S){if(U.call(S,V[R],R,V)===false){break;}}else{if(U(V[R],R,V)===false){break;}}}}return V;},walk:function P(W,S){if(!S){S=mstrmojo.global;}var V=W.split(".");if(V.length===1){return S[W];}var U=(V&&V.length)||0,R;for(R=0;R<U;R++){S=S[V[R]];if(!S){break;}}return S;},isEmpty:function F(S){if(!S){return true;}var R;for(R in S){if(S[R]!==null&&S[R]!==undefined){return false;}}return true;},clear:function G(S){if(S){var R;for(R in S){delete S[R];}}return S;},any:function J(V,W){var U;if(V){var S=this.keyarray(V);if(S.length>0){var R=S[0];U=W?R:V[R];}}return U;},clone:function M(W){if(!W){return null;}var Y;if(W.constructor===Array){Y=W.concat();var X=Y[0];if(X&&typeof X==="object"){var R=Y.length,V;for(V=0;V<R;V++){Y[V]=this.clone(W[V]);}}}else{Y={};var U;for(U in W){var S=W[U];if(S&&typeof S==="object"){Y[U]=this.clone(S);}else{Y[U]=S;}}}return Y;},cloneArray:function E(S){var U=[],R=(S&&S.length)||0,V;for(V=0;V<R;V++){U[V]=this.clone(S[V]);}return U;},keyarray:function K(U,V){var R=[],S;if(U){if(Object.keys&&!V){R=Object.keys(U);}else{for(S in U){R.push(V?Number(S):S);}}}return R;},valarray:function L(U){var R=[];if(U){var S;for(S in U){R.push(U[S]);}}return R;},equals:function Q(Z,Y){var S=mstrmojo.hash,X=(Z&&Y)||(!Z&&!Y&&(Z===Y));if(X&&Z){X=(Z.constructor===Y.constructor);if(X){if(Z.constructor===Array){var W=Z.length;X=(W===Y.length);if(X&&W){var U;for(U=0;U<W;U++){X=X&&S.equals(Z[U],Y[U]);}}}else{if(typeof Z==="object"){var a=S.keyarray(Z),V=S.keyarray(Y);X=a.length===V.length;if(X){var R;for(R in Z){X=X&&(S.equals(Z[R],Y[R]));}}}else{X=(Z===Y);}}}}return X;},obj2array:function O(X){var Y;for(Y in X){var W=X[Y];if(W&&typeof W==="object"){X[Y]=this.obj2array(W);}}var S=X.isArray;if(S!==undefined&&S===true){var V=[],R=X.length,U;for(U=0;U<R;U++){V.push(X[U]);}return V;}return X;},min:function D(V,W,X){var R=null,U;if(V){for(U in V){var S=W?V[U]:U;if(X){S=Number(S);}if((R===null)||(S<R)){R=S;}}}return R;},max:function N(V,W,X){var R=null,U;if(V){for(U in V){var S=W?V[U]:U;if(X){S=Number(S);}if((R===null)||(S>R)){R=S;}}}return R;},make:function A(S,U,R){if(!S||!U){return null;}if(S.attachEventListener){return S;}if(U.makeObservable){S=U.makeObservable(S,R)||S;}else{this.copy(U.prototype,S);if(S.init){S=S.init(R)||S;}}return S;},mergeHashes:function H(R,S){R=this.clone(R)||{};if(S){mstrmojo.array.forEach(mstrmojo.array.distinct(this.keyarray(S).concat(this.keyarray(R))),function(U){var W=R[U],V=S[U];if(W===undefined){R[U]=V;}else{if(W&&V){if(typeof W==="object"){if(W.constructor===Array){R[U]=W.concat(V);}else{R[U]=this.mergeHashes(W,V);}}else{R[U]=V;}}}},this);}return R;},invert:function(S){var U={};if(S){var R;for(R in S){if(S.hasOwnProperty(R)){if(typeof R==="number"||typeof R==="string"){U[S[R].toString()]=R;}}}}return U;}});}());mstrmojo.mstr.EnumFunction={FunctionCustom:-1,FunctionReserved:0,FunctionPlus:1,FunctionMinus:2,FunctionTimes:3,FunctionDivide:4,FunctionUnaryMinus:5,FunctionEquals:6,FunctionNotEqual:7,FunctionGreater:8,FunctionLess:9,FunctionGreaterEqual:10,FunctionLessEqual:11,FunctionSum:12,FunctionCount:13,FunctionAvg:14,FunctionMin:15,FunctionMax:16,FunctionBetween:17,FunctionLike:18,FunctionAnd:19,FunctionOr:20,FunctionNot:21,FunctionIn:22,FunctionRank:23,FunctionAbs:24,FunctionRunningSum:25,FunctionRunningAvg:26,FunctionMovingSum:28,FunctionMovingAvg:27,FunctionProduct:29,FunctionMedian:30,FunctionMode:31,FunctionStdev:32,FunctionVar:33,FunctionGeomean:34,FunctionEqualEnhanced:35,FunctionNotEqualEnhanced:36,FunctionGreaterEqualEnhanced:37,FunctionLessEqualEnhanced:38,FunctionBetweenEnhanced:39,FunctionBanding:40,FunctionBandingC:41,FunctionBandingP:42,FunctionNotLike:43,FunctionNotBetween:44,FunctionIntersect:45,FunctionIntersectIn:46,FunctionNullToZero:47,FunctionZeroToNull:48,FunctionApplySimple:49,FunctionApplyAggregation:50,FunctionApplyLogic:51,FunctionApplyComparison:52,FunctionApplyRelative:53,FunctionIsNull:54,FunctionIsNotNull:55,FunctionUcase:56,FunctionNotIn:57,FunctionNTile:58,FunctionPercentile:59,FunctionMovingMax:60,FunctionMovingMin:61,FunctionMovingDifference:62,FunctionMovingStdev:63,FunctionExpWghMovingAvg:64,FunctionMovingCount:65,FunctionRunningMax:66,FunctionRunningMin:67,FunctionRunningStdev:68,FunctionRunningCount:69,FunctionExpWghRunningAvg:70,FunctionNotBetweenEnhanced:71,FunctionConcat:72,FunctionFirstInRange:73,FunctionLastInRange:74,FunctionValueSegment:75,FunctionContains:76,FunctionBeginsWith:77,FunctionEndsWith:78,FunctionNotContains:79,FunctionNotBeginsWith:80,FunctionNotEndsWith:81,FunctionCase:82,FunctionCaseV:83,FunctionStdevP:84,FunctionRunningStdevP:85,FunctionMovingStdevP:86,FunctionNTileS:87,FunctionNTileVS:88,FunctionVarP:89,FunctionCurrentDate:90,FunctionDayOfMonth:91,FunctionDayOfWeek:92,FunctionDayOfYear:93,FunctionWeek:94,FunctionMonth:95,FunctionQuarter:96,FunctionYear:97,FunctionCurrentDateTime:98,FunctionCurrentTime:99,FunctionHour:100,FunctionMinute:101,FunctionSecond:102,FunctionMilliSecond:103,FunctionConcatNoBlank:104,FunctionLength:105,FunctionLower:106,FunctionLTrim:107,FunctionPosition:108,FunctionRTrim:109,FunctionSubStr:110,FunctionInitCap:111,FunctionTrim:112,FunctionRightStr:113,FunctionLeftStr:114,FunctionGreatest:115,FunctionLeast:116,FunctionFirst:117,FunctionLast:118,FunctionAdd:134,FunctionAverage:135,FunctionMultiply:136,FunctionBandingM:137,FunctionOLAPSum:138,FunctionOLAPAvg:139,FunctionOLAPCount:140,FunctionOLAPMax:141,FunctionOLAPMin:142,FunctionLag:143,FunctionLead:144,FunctionPercentRank:166,FunctionConcatAgg:177,FunctionTuple:1000};if(!mstrmojo.LoadedExternalJSURLs){mstrmojo.LoadedExternalJSURLs={};}function LoadScriptsExternalJSCallback(){mstrmojo.LoadedExternalJSURLs[mstrmojo._LoadsScript.esScripts.splice(0,1)[0].url]=true;mstrmojo._LoadsScript.requiresExternalScripts(mstrmojo._LoadsScript.esScripts,mstrmojo._LoadsScript.callback,mstrmojo._LoadsScript.esScritsContext);mstrmojo._LoadsScript.ExternalJSCallbackIsBusy=false;}if(!mstrmojo._LoadsScript){mstrmojo._LoadsScript=mstrmojo.provide("mstrmojo._LoadsScript",{_meta_usesSuper:false,requiresMethod:function requiresMethod(B){if(!B){return false;}if(typeof this[B]==="function"){return true;}var A=this[B]||(this.methods&&(this.methods[B]||this.methods["*"]));if(typeof A==="string"){this.requiresCls(A);return typeof this[B]==="function";}return false;},requiresCls:function req(mixins,callback){if(mixins){if(typeof mixins==="string"){mixins=[mixins];}mstrmojo.requiresCls.apply(mstrmojo,mixins);var p=this.constructor.prototype,pm=p.mixins;if(!pm){p.mixins={};pm=p.mixins;}var mx=mstrmojo.mixin,i,len;for(i=0,len=mixins.length;i<len;i++){var fqcn=mixins[i];if(!pm[fqcn]){var m=eval(mixins[i]);mx(m,p);pm[fqcn]=true;if(m.__onmixin__){m.__onmixin__.apply(this,[]);}}}if(callback){callback.apply(this,[]);}}},requiresContrib:function reqCb(C,B){var A=this[C];if(A){var E,D=false;if(typeof A==="string"){E=mstrmojo.registry.ref(A);this[C]=E;D=true;}else{E=A;}if(E&&(D||B)){E.parent=this;if(E.startup){E.startup();}}return E;}return null;},requiresExternalScripts:function requiresExternalScripts(G,H,C){if(G&&G instanceof Array){if(G.length===0){if(H){H.call(C);}return false;}if(G[0]&&G[0].forceReload===false&&mstrmojo.LoadedExternalJSURLs[G[0].url]){G.splice(0,1);return this.requiresExternalScripts(G,H,C);}var A=document.createElement("script"),D=!!document.all,B=G[0].url,F=G[0].onError;if(B.substr(0,7)==="file://"){B=B.substr(7);}else{if(mstrApp.isSingleTier&&B.substr(0,4)!=="http"){B="http:"+B;}}A.type="text/javascript";A.src=B;if(F){A.onerror=function(){if(F&&F.callback&&C){F.callback.call(C,F.params);}};}if(!G[0].callbackParamName){if(D){A.onreadystatechange=function(){if(A.readyState==="loaded"||A.readyState==="complete"){A.onreadystatechange=null;A.onerror=null;if(G.length>1){mstrmojo.LoadedExternalJSURLs[G.splice(0,1)[0].url]=true;mstrmojo._LoadsScript.requiresExternalScripts(G,H,C);}else{if(G.length===1){mstrmojo.LoadedExternalJSURLs[G[0].url]=true;if(H){H.call(C);}}}}};}else{A.onload=function(){A.error=null;A.onload=null;if(G.length>1){mstrmojo.LoadedExternalJSURLs[G.splice(0,1)[0].url]=true;mstrmojo._LoadsScript.requiresExternalScripts(G,H,C);}else{if(G.length===1){mstrmojo.LoadedExternalJSURLs[G[0].url]=true;if(H){H.call(C);}}}};}}else{if(G[0].callbackParamName.length!==0){if(mstrmojo._LoadsScript.ExternalJSCallbackIsBusy&&mstrmojo._LoadsScript.ExternalJSCallbackIsBusy===true){var E=this;window.setTimeout(function(){E.requiresExternalScripts(G,H,C);},500);return ;}mstrmojo._LoadsScript.ExternalJSCallbackIsBusy=true;A.src+="&"+G[0].callbackParamName+"=LoadScriptsExternalJSCallback";mstrmojo._LoadsScript.esScripts=G;mstrmojo._LoadsScript.callback=H;mstrmojo._LoadsScript.esScritsContext=C;}}document.getElementsByTagName("head")[0].appendChild(A);}}});}(function(){mstrmojo.models.template.Title=mstrmojo.declare(null,null,{init:function G(J){this.title=J.title;},getActionType:function(){return this.title.at;},getDrillPath:function(){return this.title.dp;},getHeaderValues:function B(){return this.title.es;},getHeaderName:function F(J){return this.title.es[J].n;},getHeaderId:function F(J){return this.title.es[J].id;},getForms:function E(){return this.title.fs;},getFormId:function D(){return this.title.fid;},getFormType:function I(){return this.title.ftp;},getUnitId:function H(){return this.title.id;},getLinkMap:function C(){return this.title.lm;},getName:function A(){return this.title.n;},getUnitDssType:function(){return this.title.otp;},getSelectorControl:function(){return this.title.sc;}});}());mstrmojo.mstr.EnumDataType={DataTypeUnknown:-1,DataTypeReserved:0,DataTypeInteger:1,DataTypeUnsigned:2,DataTypeNumeric:3,DataTypeDecimal:4,DataTypeReal:5,DataTypeDouble:6,DataTypeFloat:7,DataTypeChar:8,DataTypeVarChar:9,DataTypeLongVarChar:10,DataTypeBinary:11,DataTypeVarBin:12,DataTypeLongVarBin:13,DataTypeDate:14,DataTypeTime:15,DataTypeTimeStamp:16,DataTypeShort:21,DataTypeLong:22,DataTypeMBChar:23,DataTypeBool:24,DataTypePattern:25,DataTypeBigDecimal:30,DataTypeCellFormatData:31,DataTypeInt64:34};mstrmojo.vi.viz.EnumAxisNames={RESERVED:0,ROWS:1,COLUMNS:2,PAGES:3,CHAPTERS:4,ALL:5};mstrmojo.gm.GMEnums={};mstrmojo.gm.DualAxisSubAxisBit={PRIMARY:0,SECONDARY:1};mstrmojo.gm.StackExetrmeId={PRIMARY_Y_AXIS:-2,SECONDARY_Y_AXIS:-18,PRIMARY_X_AXIS:-1,SECONDARY_X_AXIS:-17};mstrmojo.gm.FormNameType={OFF:0,ON:1,FORM_NAME_ONLY:2,SHOW_ATT_NAME_ONCE:3,AUTO:4};mstrmojo.gm.EnumSelectionOptionLevel={GLOBAL:1,ITSELF:2,ATTS_METRIC_COMBINATION:3,METRIC_AXIS:4,METRIC:5,AXIS:6,COLOR_BY:7,ALL_SHAPE:8,ITSELF_RESOLVED:9};mstrmojo.gm.EnumLabelRotation={VERTICAL:2,HORIZONTAL:0,AUTOMATIC:-1};mstrmojo.gm.EnumIdentityType={LEGEND:Math.pow(2,0),GRAPH_SHAPE:Math.pow(2,1),X_AXIS:Math.pow(2,2),Y_AXIS:Math.pow(2,3),X2_AXIS:Math.pow(2,4),Y2_AXIS:Math.pow(2,5),GRID_LINE:Math.pow(2,6),TREND_LINE:Math.pow(2,7),REF_LINE:Math.pow(2,8),DATA_LABEL:Math.pow(2,9),COLOR_SQUARE:Math.pow(2,10),ROW_TITLE:Math.pow(2,11),COL_TITLE:Math.pow(2,12),ROW_HEADER:Math.pow(2,13),COL_HEADER:Math.pow(2,14),LOG_SCALE:Math.pow(2,15),H_MATRIX_LINE:Math.pow(2,16),V_MATRIX_LINE:Math.pow(2,17),LEGEND_TEXT:Math.pow(2,18),SHAPE_COLLECTION:Math.pow(2,19),MINOR_GRID_LINE:Math.pow(2,20),AXIS_SCALE:Math.pow(2,22),AXIS_ORIGIN:Math.pow(2,23),ROWS_BACKGROUND:Math.pow(2,24),COLS_BACKGROUND:Math.pow(2,25),X_NUMERIC:Math.pow(2,26),X_CATEGORY:Math.pow(2,27),Y_NUMERIC:Math.pow(2,28),Y_CATEGORY:Math.pow(2,29),X_METRIC_AXIS_TITLE:Math.pow(2,30),Y_METRIC_AXIS_TITLE:Math.pow(2,31),VIZ_BOX_TITLE:Math.pow(2,32),REF_LINE_LABEL:Math.pow(2,33),LINE_MARKER:Math.pow(2,34),X_AXIS_ORIGIN_LABEL:Math.pow(2,35),Y_AXIS_ORIGIN_LABEL:Math.pow(2,36),X_AXIS_ORIGIN_LINE:Math.pow(2,37),Y_AXIS_ORIGIN_LINE:Math.pow(2,38),Y_ATTRIBUTE_AXIS_TITLE:Math.pow(2,39),ROW_HEADER_TEXT:Math.pow(2,40),ROW_TITLE_TEXT:Math.pow(2,41),COL_HEADER_TEXT:Math.pow(2,42),COL_TITLE_TEXT:Math.pow(2,43),VIZ_BOX_CONTAINER:Math.pow(2,44),X_ATTRIBUTE_AXIS_TITLE:Math.pow(2,45),AXIS_ORIGIN_DEFINE:Math.pow(2,46)};mstrmojo.gm.EnumGMZoneIds={ROWS:1,COLUMNS:2,XAXIS:3,YAXIS:4,BREAKBY:5,SLICEBY:6,COLORBY:7,SIZEBY:8,TOOLTIP:9,ANGLEBY:10};mstrmojo.gm.EnumClickType={NONE:-1,LEFT_CLICK:1,RIGHT_CLICK:2,DOUBLE_CLICK:3};mstrmojo.gm.EnumLegendSlot={RIGHT_TOP:1,RIGHT_MIDDLE:2,RIGHT_BOTTOM:3,LEFT_TOP:4,LEFT_MIDDLE:5,LEFT_BOTTOM:6,LEFT:7,RIGHT:8};mstrmojo.gm.EnumAxisType={ATTRIBUTE:0,METRIC:1};mstrmojo.gm.EnumGraphType={UNDEFINED:-1,AREA:1,BAR:2,LINE:3,SCATTER:4,BUBBLE:5,PIE:6,GRID:7,HISTOGRAM:8,BOXPLOT:9,WATERFALL:10};mstrmojo.gm.EnumContextMenu={SEPARATOR:0,KEEP_ONLY:1,EXCLUDE:2,SORT_ASCENDING:3,SORT_DESCENDING:4,CLEAR_SORT:5,SHOW_DATA:6,SWITCH_THEME:7,KEEP_ONLY_AND_SHOW:8,CLOSE_LEGEND:9,OPEN_LEGEND:10,AXIS_SCALE:11,DRILL_TO:100,CHART_TYPE:200,AREA_ABS:201,AREA_STACKED:202,AREA_PERCENT:203,BAR_SBS:204,BAR_ABS:205,BAR_STACKED:206,BAR_PERCENT:207,LINE_ABS:208,LINE_STACKED:209,LINE_PERCENT:210,BUBBLE:211,SCATTER:212,H_AREA_ABS:213,H_AREA_STACKED:214,H_AREA_PERCENT:215,H_BAR_SBS:216,H_BAR_ABS:217,H_BAR_STACKED:218,H_BAR_PERCENT:219,H_LINE_ABS:220,H_LINE_STACKED:221,H_LINE_PERCENT:222,GRID:223,CIRCLE:224,SQUARE:225,PIE:226,TICKER:227,RING:228,CANVAS:229,SVG:230,LARGE_ABL:231,OUTPUT_EXTREMES:232,COMBINATION:233,ENABLE_PARTIAL_RENDERING:234,DISABLE_PARTIAL_RENDERING:235,OUTPUT_DATA_COUNT:236,ENABLE_TIMER:239,DISABLE_TIMER:240,ENABLE_CE_TIMER:241,DISABLE_CE_TIMER:242};mstrmojo.gm.EnumColorRankMode={RANK_MODE_VALUE:0,RANK_MODE_TOP:1,RANK_MODE_BOTTOM:2,RANK_MODE_TOP_PERCENT:3,RANK_MODE_BOTTOM_PERCENT:4};mstrmojo.gm.EnumColorByType={NULL:0,ATT:1,METRICS_ITEM:2,METRICS:3,ATT_METRICS:4};mstrmojo.gm.EnumDockPosition={TOP:1,RIGHT:2,BOTTOM:3,LEFT:4};mstrmojo.gm.EnumXAxisLabelStatus={NORMAL:1,STAGGER:2,ROTATE:3,HORI_DROP:4};mstrmojo.gm.EnumABLDirection={UNDEFINED:-1,NONE:0,HORIZONTAL:1,VERTICAL:2};mstrmojo.gm.EnumMetricsPosition={MetricsByRow:0,MetricsByColumn:1,MetricsByAxis:2,MetricsByBreakBy:3,MetricsBySlice:4,MetricsByXAxis:5,MetricsByYAxis:6};mstrmojo.gm.EnumDrawingAPI={GET_CHART_WIDTH:0,GET_CHART_HEIGHT:1,GET_ROW_HEADER:2,GET_COLUMN_HEADER:3,CREATE_UNIT_Y_AXIS:4,CREATE_UNIT_X_AXIS:5,GET_FULL_FLEDGED_CHART:6,GET_ROW_SPAN:7,GET_COLUMN_SPAN:8,GET_METRICS_ON_X:9,GET_METRICS_ON_Y:10,GET_METRICS_ON_SIZE_BY:11,UPDATE_MINI_CHART:12,UPDATE_X_AXIS:13,UPDATE_Y_AXIS:14,MAX_RADIUS_CALC:15,GET_EXTRA_COLUMN_HEADER:16,UPDATE_COLUMN_HEADER:17,UPDATE_ROW_HEADER:18,LAYOUT_ALL_X_AXIS_LABELS:19,LAYOUT_ONE_X_AXIS_LABELS:20};mstrmojo.gm.WidgetPropertyTag={FIT_TO:"FitTo",AXIS_SCALE:"MinMax",SHAPE:"Shape",SUB_TYPE:"Subtype",VIS_TYPE:"visType",DATA_LABEL:"DataLabel",DATA_LABELS_PLACEMENT:"DataLabelPalcement",METRIC_LEVEL_DATA_LABEL:"mtcLvlDataLabel",DATA_LABEL_FONT_SIZE_CONSTRAINT:"DataLabelFontSizeConstraint",DATA_LABEL_TEXT_ANGLE:"DataLabelTextAngle",BANDING:"Banding",LEGEND_VISIBLE:"LegendVisibleness",COL_ALIGNMENT:"Columnalignment",ROW_ALIGNMENT:"Rowalignment",MAX_SIZE_TYPE:"SizeType",MAX_SIZE_VALUE:"SizeValue",MIN_SIZE_TYPE:"minSizeType",MIN_SIZE_VALUE:"minSizeValue",OUTSIDE_BORDER:"OutSideBorder",AXES:"AxisLine",MATRIX_LINES:"MatrixLine",GRID_LINES:"GridLine",SELECTION_TYPE:"SelectionType",SELECTIONS:"Selections",LEGEND_MODE:"lm",LEGEND_POSITION:"LegendPosition",SCALE_LEGEND_WIDTH:"lwr",SCALE_CHART_HEIGHT:"rr",SCALE_CHART_WIDTH:"cr",SCALE_ROW_HEADERS:"rvr",SCALE_COL_HEADERS:"chr",SCALE_Y:"yr",SCALE_X:"xr",SCALE_Y2:"y2r",SCALE_X2:"x2r",SCALE_ALL:"scales",SCALE_V_EXTRA_LINE:"vExtraLine",SORT_ORDER:"so",SORT_INDEX:"si",AXIS_SCALE_DATA:"AxisScale",AXIS_SCALE_REAL_MIN:"rMin",AXIS_SCALE_REAL_MAX:"rMax",AXIS_SCALE_MANUAL_MIN:"mMin",AXIS_SCALE_MANUAL_MAX:"mMax",AXIS_SCALE_AUTO_MIN:"autoMin",AXIS_SCALE_AUTO_MAX:"autoMax",SINGLE_AXIS_SCALE_TYPE:"scaleType",LOG_SCALE:"logScale",GROUP_INFO:"groupInfo",METRIC_SHAPES:"metricShapes",AXIS_ORIGIN:"axisOrigin",AXIS_ORIGIN_AUTO:"axOriAuto",AXIS_ORIGIN_VALUE:"axOriValue",TREND_LINE_DEF:"trdDef",REF_LINE_DEF:"refDef",TREND_TYPE:"trdTp",TREND_LEVEL:"trdLvl",TREND_ENABLED:"trdEnabled",TREND_INCLUDE_BREAK_BY:"trdIncBB",TREND_POLY_DEGREE:"trdDgr",TREND_FORECAST_ENABLED:"trdFstEnabled",TREND_BWD_FORECAST:"trdBwdFst",TREND_FWD_FORECAST:"trdFwdFst",TREND_SEASONALITY:"trdSeason",TREND_BUBBLE_FORE_DEF:"trdBbForeDef",TREND_BUBBLE_FORE_FWD:"trdBbForeFwd",TREND_BUBBLE_FORE_BWD:"trdBbForeBwd",TREND_BUBBLE_FORE_ENABLED:"trdBbForeEnabled",TREND_BUBBLE_MAX:"trdBbMax",TREND_BUBBLE_MIN:"trdBbMin",REF_TYPE:"refTp",REF_LEVEL:"refLvl",REF_ENABLED:"refEnabled",REF_SHOW_LABEL:"refLbShw",REF_LABEL_TYPE:"refLbTp",REF_CONST_VALUE:"refCstVl",REF_LINE_NAME:"refLnName",TREND_REF_LINE_THICKNESS:"trdRefLnThk",TREND_REF_LINE_COLOR:"trdRefLnClr",TREND_REF_LINE_STYLE:"trdRefLnStyle",TREND_REF_LINE_COMBINED_STYLE:"trdRefLnCmbStyle",FORMATS_ON_COMBINATION:"fmtOnComb",PARTIAL_RENDER:"prtRdn",SHOW_BOTH_TOTALS:"totalShw:intSumShw"};mstrmojo.gm.FormatingPropertyTag={IS_DEFAULT_VALUE:"_default",MODIFIED_DEF_FILL_COLOR:"modDefFillClr",ALL_SHAPE_FORMAT:"allShpFmt",SHAPE_LINE_THICKNESS:"shpLnThk",SHAPE_LINE_COLOR:"shpLnClr",SHAPE_LINE_STYLE:"shpLnStyle",SHAPE_LINE_COMBINED_STYLE:"shpLnCmbStyle",SHAPE_FILL_COLOR:"shpFillClr",SHAPE_FILL_COLOR_DEFAULT:"shpFillClr_default",SHAPE_FILL_STYLE:"shpFillStyle",SHAPE_FILL_TRANSPARENCY:"shpFillTrans",SHAPE_FILL_EFFECT:"shpFillEff",SHAPE_BORDER_COLOR:"shpBdrClr",SHAPE_BORDER_STYLE:"shpBdrStyle",SHAPE_BORDER_COMBINED_STYLE:"shpBdrCmbStyle",SHAPE_BORDER_THICKNESS:"shpBdrThk",LINE_MARKER_SHOW:"lnMkShw",LINE_MARKER_SHAPE:"lnMkShp",LINE_MARKER_SIZE:"lnMkSz",LINE_MARKER_COLOR:"lnMkClr",LINE_MARKER_COLOR_EQUAL:"lnMkClrEq",LINE_MARKER_BORDER_COLOR:"lnMkBdrClr",PIE_EXPLODE:"pieExpl",DATA_LABELS_SHOW:"dlShw",DATA_LABELS_FONT_FAMILY:"dlFntFml",DATA_LABELS_FONT_SIZE:"dlFntSz",DATA_LABELS_FONT_STYLE:"dlFntStyle",DATA_LABELS_FONT_COLOR:"dlFntClr",REF_LABELS_FONT_FAMILY:"rfLnFntFml",REF_LABELS_FONT_SIZE:"rfLnFntSz",REF_LABELS_FONT_STYLE:"rfLnFntStyle",REF_LABELS_FONT_COLOR:"rfLnFntClr",LEGEND_BG_COLOR:"lgdBgFillClr",LEGEND_BG_FILL_STYLE:"lgdBgFillStyle",LEGEND_BG_FILL_EFFECT:"lgdBgFillEff",LEGEND_BG_FILL_TRANSPARENCY:"lgdBgFillTrans",LEGEND_FONT_SIZE:"lgdFntSz",LEGEND_FONT_FAMILY:"lgdFntFml",LEGEND_FONT_STYLE:"lgdFntStyle",LEGEND_FONT_COLOR:"lgdFntClr",LEGEND_BORDER_SHOW:"lgdBdrShw",LEGEND_BORDER_COLOR:"lgdBdrClr",LEGEND_BORDER_THICKNESS:"lgdBdrThk",LEGEND_BORDER_LINE_STYLE:"lgdBdrStyle",LEGEND_BORDER_LINE_COMBINED_STYLE:"lgdBdrCmbStyle",ALL_LINE_SHOW:"allLnShw",ALL_LINE_COLOR:"allLnClr",ALL_LINE_STYLE:"allLnStyle",ALL_LINE_COMBINED_STYLE:"allLnCmbStyle",ALL_LINE_THICKNESS:"allLnThk",ALL_AXIS_ORIGIN_LINE_SHOW:"axOriLnShw",ALL_AXIS_ORIGIN_LINE_COLOR:"axOriLnClr",ALL_AXIS_ORIGIN_LINE_COMBINED_STYLE:"axOriLnCmbStyle",X_AXIS_ORIGIN_LINE_SHOW:"xAxOriLnShw",X_AXIS_ORIGIN_LINE_COLOR:"xAxOriLnClr",X_AXIS_ORIGIN_LINE_STYLE:"xAxOriLnStyle",X_AXIS_ORIGIN_LINE_COMBINED_STYLE:"xAxOriLnCmbStyle",X_AXIS_ORIGIN_LINE_THICKNESS:"xAxOriLnThk",Y_AXIS_ORIGIN_LINE_SHOW:"yAxOriLnShw",Y_AXIS_ORIGIN_LINE_COLOR:"yAxOriLnClr",Y_AXIS_ORIGIN_LINE_STYLE:"yAxOriLnStyle",Y_AXIS_ORIGIN_LINE_COMBINED_STYLE:"yAxOriLnCmbStyle",Y_AXIS_ORIGIN_LINE_THICKNESS:"yAxOriLnThk",ALL_AXIS_LINE_SHOW:"allAxLnShw",ALL_AXIS_LINE_COLOR:"allAxLnClr",ALL_AXIS_LINE_STYLE:"allAxLnStyle",ALL_AXIS_LINE_COMBINED_STYLE:"allAxLnCmbStyle",ALL_AXIS_LINE_THICKNESS:"allAxLnThk",ALL_AXIS_TITLE_SHOW:"allAxTtShw",ALL_AXIS_TITLE_CONTENT:"allAxTtCtt",ALL_AXIS_TITLE_FONT_COLOR:"allAxTtFntClr",ALL_AXIS_TITLE_FONT_FAMILY:"allAxTtFntFml",ALL_AXIS_TITLE_FONT_STYLE:"allAxTtFntStyle",ALL_AXIS_TITLE_FONT_SIZE:"allAxTtFntSz",ALL_AXIS_LABELS_FONT_SIZE:"allAxLbFntSz",ALL_AXIS_LABELS_FONT_FAMILY:"allAxLbFntFml",ALL_AXIS_LABELS_FONT_STYLE:"allAxLbFntStyle",ALL_AXIS_LABELS_FONT_COLOR:"allAxLbFntClr",ALL_AXIS_LABELS_ROTATION:"allAxLbRtt",ALL_AXIS_LABELS_SHOW:"allAxLbShw",X_AXIS_LINE_SHOW:"xAxLnShw",X_AXIS_LINE_COLOR:"xAxLnClr",X_AXIS_LINE_STYLE:"xAxLnStyle",X_AXIS_LINE_COMBINED_STYLE:"xAxLnCmbStyle",X_AXIS_LINE_THICKNESS:"xAxLnThk",X_AXIS_TITLE_SHOW:"xAxTtShw",X_AXIS_TITLE_CONTENT:"xAxTtCtt",X_AXIS_TITLE_FONT_COLOR:"xAxTtFntClr",X_AXIS_TITLE_FONT_FAMILY:"xAxTtFntFml",X_AXIS_TITLE_FONT_STYLE:"xAxTtFntStyle",X_AXIS_TITLE_FONT_SIZE:"xAxTtFntSz",X_AXIS_LABELS_FONT_SIZE:"xAxLbFntSz",X_AXIS_LABELS_FONT_FAMILY:"xAxLbFntFml",X_AXIS_LABELS_FONT_STYLE:"xAxLbFntStyle",X_AXIS_LABELS_FONT_COLOR:"xAxLbFntClr",X_AXIS_LABELS_ROTATION:"xAxLbRtt",X_AXIS_LABELS_SHOW:"xAxLbShw",Y_AXIS_LINE_SHOW:"yAxLnShw",Y_AXIS_LINE_COLOR:"yAxLnClr",Y_AXIS_LINE_STYLE:"yAxLnStyle",Y_AXIS_LINE_COMBINED_STYLE:"yAxLnCmbStyle",Y_AXIS_LINE_THICKNESS:"yAxLnThk",Y_AXIS_TITLE_SHOW:"yAxTtShw",Y_AXIS_TITLE_CONTENT:"yAxTtCtt",Y_AXIS_TITLE_FONT_COLOR:"yAxTtFntClr",Y_AXIS_TITLE_FONT_FAMILY:"yAxTtFntFml",Y_AXIS_TITLE_FONT_STYLE:"yAxTtFntStyle",Y_AXIS_TITLE_FONT_SIZE:"yAxTtFntSz",Y_AXIS_LABELS_FONT_SIZE:"yAxLbFntSz",Y_AXIS_LABELS_FONT_FAMILY:"yAxLbFntFml",Y_AXIS_LABELS_FONT_STYLE:"yAxLbFntStyle",Y_AXIS_LABELS_FONT_COLOR:"yAxLbFntClr",Y_AXIS_LABELS_ROTATION:"yAxLbRtt",Y_AXIS_LABELS_SHOW:"yAxLbShw",ALL_FILL_COLOR:"allFillClr",ALL_FILL_TRANSPARENCY:"allFillTrans",BG_COLOR:"bgFillClr",BG_FILL_EFFECT:"bgFillEff",BG_FILL_STYLE:"bgFillStyle",BG_FILL_TRANSPARENCY:"bgFillTrans",ROW_HEADER_FILL_COLOR:"rwHdrFillClr",ROW_HEADER_FILL_EFFECT:"rwHdrFillEff",ROW_HEADER_FILL_STYLE:"rwHdrFillStyle",ROW_HEADER_FILL_TRANSPARENCY:"rwHdrFillTrans",COLUMN_HEADER_FILL_COLOR:"colHdrFillClr",COLUMN_HEADER_FILL_EFFECT:"colHdrFillEff",COLUMN_HEADER_FILL_STYLE:"colHdrFillStyle",COLUMN_HEADER_FILL_TRANSPARENCY:"colHdrFillTrans",ALL_MATRIX_LINES_SHOW:"allMatrixLnShw",ALL_MATRIX_LINES_COLOR:"allMatrixLnClr",ALL_MATRIX_LINES_THICKNESS:"allMatrixLnThk",ALL_MATRIX_LINES_STYLE:"allMatrixLnStyle",ALL_MATRIX_LINES_COMBINED_STYLE:"allMatrixLnCmbStyle",V_MATRIX_LINES_SHOW:"vMatrixLnShw",V_MATRIX_LINES_COLOR:"vMatrixLnClr",V_MATRIX_LINES_THICKNESS:"vMatrixLnThk",V_MATRIX_LINES_STYLE:"vMatrixLnStyle",V_MATRIX_LINES_COMBINED_STYLE:"vMatrixLnCmbStyle",H_MATRIX_LINES_SHOW:"hMatrixLnShw",H_MATRIX_LINES_COLOR:"hMatrixLnClr",H_MATRIX_LINES_THICKNESS:"hMatrixLnThk",H_MATRIX_LINES_STYLE:"hMatrixLnStyle",H_MATRIX_LINES_COMBINED_STYLE:"hMatrixLnCmbStyle",OUTSIDE_BORDER_SHOW:"outBdrShw",OUTSIDE_BORDER_COLOR:"outBdrClr",OUTSIDE_BORDER_STYLE:"outBdrStyle",OUTSIDE_BORDER_THICKNESS:"outBdrThk",OUTSIDE_BORDER_COMBINED_STYLE:"outBdrCmbStyle",GRID_LINE_AUTO:"gridLineAuto",ALL_GRID_LINES_SHOW:"allGridLnShw",ALL_GRID_LINES_COLOR:"allGridLnClr",ALL_GRID_LINES_THICKNESS:"allGridLnThk",ALL_GRID_LINES_STYLE:"allGridLnStyle",ALL_GRID_LINES_COMBINED_STYLE:"allGridLnCmbStyle",AUTO_GRID_LINES_COLOR:"autoGridLnClr",AUTO_GRID_LINES_COMBINED_STYLE:"autoGridLnCmbStyle",MAJOR_GRID_LINES_SHOW:"majorGridLnShw",MAJOR_GRID_LINES_COLOR:"majorGridLnClr",MAJOR_GRID_LINES_THICKNESS:"majorGridLnThk",MAJOR_GRID_LINES_STYLE:"majorGridLnStyle",MAJOR_GRID_LINES_COMBINED_STYLE:"majorGridLnCmbStyle",MINOR_GRID_LINES_SHOW:"minerGridLnShw",MINER_GRID_LINES_COLOR:"minerGridLnClr",MINER_GRID_LINES_THICKNESS:"minerGridLnThk",MINER_GRID_LINES_STYLE:"minerGridLnStyle",MINER_GRID_LINES_COMBINED_STYLE:"minerGridLnCmbStyle",ALL_NGM_GRID_LINES_SHOW:"allNGMGridLnShw",X_GRID_LINES_SHOW:"xGridLnShw",Y_GRID_LINES_SHOW:"yGridLnShw",ALL_ROW_COLUMN_SHOW:"allRwColShw",COLUMN_TEXT_SHOW:"colTxtShw",ROW_TEXT_SHOW:"rwTxtShw",COLUMN_HEADER_SHOW:"colHdrShw",ROW_HEADER_SHOW:"rwHdrShw",COLUMN_VALUES_SHOW:"colVlShw",ROW_VALUES_SHOW:"rwVlShw",ALL_TEXT_FONT_COLOR:"allTxtFntClr",ALL_TEXT_FONT_SIZE:"allTxtFntSz",ALL_TEXT_FONT_FAMILY:"allTxtFntFml",ALL_TEXT_FONT_STYLE:"allTxtFntStyle",ALL_ROW_COLUMN_TEXT_FONT_COLOR:"allRwColTxtFntClr",ALL_ROW_COLUMN_TEXT_FONT_SIZE:"allRwColTxtFntSz",ALL_ROW_COLUMN_TEXT_FONT_FAMILY:"allRwColTxtFntFml",ALL_ROW_COLUMN_TEXT_FONT_STYLE:"allRwColTxtFntStyle",ALL_ROW_COLUMN_TEXT_ALIGNMENT_HORIZONTAL:"allRwColTxtAlignH",ALL_ROW_COLUMN_TEXT_ALIGNMENT_VERTICAL:"allRwColTxtAlignV",ROW_TEXT_TEXT_FONT_COLOR:"rwTxtTxtFntClr",ROW_TEXT_TEXT_FONT_SIZE:"rwTxtTxtFntSz",ROW_TEXT_TEXT_FONT_FAMILY:"rwTxtTxtFntFml",ROW_TEXT_TEXT_FONT_STYLE:"rwTxtTxtFntStyle",ROW_TEXT_TEXT_ALIGNMENT_HORIZONTAL:"rwTxtTxtAlignH",ROW_TEXT_TEXT_ALIGNMENT_VERTICAL:"rwTxtTxtAlignV",COLUMN_TEXT_TEXT_FONT_COLOR:"colTxtTxtFntClr",COLUMN_TEXT_TEXT_FONT_SIZE:"colTxtTxtFntSz",COLUMN_TEXT_TEXT_FONT_FAMILY:"colTxtTxtFntFml",COLUMN_TEXT_TEXT_FONT_STYLE:"colTxtTxtFntStyle",COLUMN_TEXT_TEXT_ALIGNMENT_HORIZONTAL:"colTxtTxtAlignH",COLUMN_TEXT_TEXT_ALIGNMENT_VERTICAL:"colTxtTxtAlignV",ROW_HEADER_TEXT_FONT_COLOR:"rwHdrTxtFntClr",ROW_HEADER_TEXT_FONT_SIZE:"rwHdrTxtFntSz",ROW_HEADER_TEXT_FONT_FAMILY:"rwHdrTxtFntFml",ROW_HEADER_TEXT_FONT_STYLE:"rwHdrTxtFntStyle",ROW_HEADER_TEXT_ALIGNMENT_HORIZONTAL:"rwHdrTxtAlignH",ROW_HEADER_TEXT_ALIGNMENT_VERTICAL:"rwHdrTxtAlignV",COLUMN_HEADER_TEXT_FONT_COLOR:"colHdrTxtFntClr",COLUMN_HEADER_TEXT_FONT_SIZE:"colHdrTxtFntSz",COLUMN_HEADER_TEXT_FONT_FAMILY:"colHdrTxtFntFml",COLUMN_HEADER_TEXT_FONT_STYLE:"colHdrTxtFntStyle",COLUMN_HEADER_TEXT_ALIGNMENT_HORIZONTAL:"colHdrTxtAlignH",COLUMN_HEADER_TEXT_ALIGNMENT_VERTICAL:"colHdrTxtAlignV",ROW_VAVLUE_TEXT_FONT_COLOR:"rwVlTxtFntClr",ROW_VAVLUE_TEXT_FONT_SIZE:"rwVlTxtFntSz",ROW_VAVLUE_TEXT_FONT_FAMILY:"rwVlTxtFntFml",ROW_VAVLUE_TEXT_FONT_STYLE:"rwVlTxtFntStyle",ROW_VAVLUE_TEXT_ALIGNMENT_HORIZONTAL:"rwVlTxtAlignH",ROW_VAVLUE_TEXT_ALIGNMENT_VERTICAL:"rwVlTxtAlignV",COLUMN_VAVLUE_TEXT_FONT_COLOR:"colVlTxtFntClr",COLUMN_VAVLUE_TEXT_FONT_SIZE:"colVlTxtFntSz",COLUMN_VAVLUE_TEXT_FONT_FAMILY:"colVlTxtFntFml",COLUMN_VAVLUE_TEXT_FONT_STYLE:"colVlTxtFntStyle",COLUMN_VAVLUE_TEXT_ALIGNMENT_HORIZONTAL:"colVlTxtAlignH",COLUMN_VAVLUE_TEXT_ALIGNMENT_VERTICAL:"colVlTxtAlignV",TITLE_FONT_COLOR:"ttlFntClr",TITLE_FONT_SIZE:"ttlFntSz",TITLE_FONT_FAMILY:"ttlFntFml",TITLE_FONT_STYLE:"ttlFntStyle",COLOR_SQUARE_COLOR:"clrSqrClr",SELECTION_LIMIT:"slctnLmt",CONTAINER_FIT_MODE:"cntrFitMode",SHOW_MODEBAR:"showModeBar",MEAN_SD:"meanSD",POINT_SIZE:"ptSize",PTSZ_TYPE:"ptSzType",JITTER:"jitter",JTR_TYPE:"jtrType",POINT_POS:"ptPos",PTPOS_TYPE:"ptPosType",SHOW_OUTLIERS:"shwOutliers",CUSTOM_BINS_MODE:"custMode",MANUAL_BINS_MODE:"manualBinsMode",RANGE_TYPE:"rangeType",NUM_BINS:"numBins",XBINS_START:"xBinsStart",XBINS_END:"xBinsEnd",XBINS_SIZE:"xBinsSize",HAS_UNCHECKED_AUTO:"hasUncheckedAuto",HAS_UNCHECKED_DATASET_RANGE:"hasUncheckedDstRng",TOTAL_SHOW:"totalShw",TOTAL_LABEL:"totalLabel",INT_SUM_SHOW:"intSumShw",POSITIVE_COLOR:"posClr",NEGATIVE_COLOR:"negClr",TOTAL_COLOR:"totalClr",INT_SUM_COLOR:"intSumClr",INT_SUM_FULL:"intSumFull"};mstrmojo.gm.EnumAxis={DssAxisReserved:0,DssAxisRows:1,DssAxisColumns:2,DssAxisPages:3,DssAxisChapters:4,DssAxisAll:5};mstrmojo.gm.EnumCombinedLineStyle={NONE:99,THIN:1,THICK:2,DASHED:3,DOTTED:4};mstrmojo.gm.EnumSizeByType={SQUARE:1,CIRCLE:4};mstrmojo.gm.EnumTheme={DARK:0,LIGHT:1};mstrmojo.gm.EnumFitTo={NONE:1,AUTOMATIC:2,COMPACT:3,MANUAL:4};mstrmojo.gm.EnumAxisScale={GLOBAL:0,PERROWCOL:1,PERCELL:2,CUSTOM:3,DIFFERENT:4};mstrmojo.gm.EnumShape={GENERIC:-1,AREA:0,BAR:1,LINE:2,STEPLINE:3,CIRCLE:4,RECTANGLE:5,SQUARE:6,TICK:7,PIESLICE:8,POLYGON:9,PIE:10,RING:11,DEFAULT:12,BULLET:13};mstrmojo.gm.EnumSubtype={AUTO:1,ABSOLUTE:2,STACKED:3,CLUSTERED:4,PERCENT:5};mstrmojo.gm.EnumDataLabels={HIDE:1,SHOW_VALUE_ONLY:2,SHOW_TEXT_ONLY:3};mstrmojo.gm.EnumDataLabelPlacements={AUTOMATIC:1,GENERIC:2,RESERVED:3};mstrmojo.gm.EnumLegend={SHOW:0,HIDE:1,MINIMIZED:2};mstrmojo.gm.EnumLegendMode={RESTORED:1,MINIMIZED:2};mstrmojo.gm.EnumTextAlignH={LEFT:0,MIDDLE:1,RIGHT:2};mstrmojo.gm.EnumTextAlignV={TOP:0,MIDDLE:1,BOTTOM:2};mstrmojo.gm.EnumMaxSizeType={AUTO:1,MANUAL:2,AUTO_FIT:3};mstrmojo.gm.EnumMinSizeType={AUTO:1,MANUAL:2,PROPORTIONAL:3};mstrmojo.gm.EnumAxes={SHOW_BOTH:1,SHOW_NONE:2,SHOW_X:3,SHOW_Y:4};mstrmojo.gm.EnumMatrixLines={SHOW_ALL:1,SHOW_NONE:2,SHOW_HORIZONTAL:3,SHOW_VERTICAL:4};mstrmojo.gm.EnumGridLines={AUTO:1,SHOW:2,HIDE:3,SHOW_MAJOR_ONLY:4};mstrmojo.gm.EnumNGMGridLines={SHOW_Y:1,SHOW_X:2,SHOW:3,HIDE:4,AUTO:5};mstrmojo.gm.LineMarkerShape={Circle:4,Square:1};mstrmojo.gm.ShapeFillType={Solid:0,Gradient:14,Pattern:3};mstrmojo.gm.ShapeFillEffect={None:1,Bevel:2};mstrmojo.gm.Enum3DGMapping={SizeType:"9999_1002",SizeValue:"9999_1003",lgdBgFillClr:"6_564",lgdBgFillStyle:"6_10002",lgdBgFillEff:"6_608",lgdFntSz:"9_603",lgdFntFml:"9_576",lgdFntStyle:"9_584",lgdFntClr:"9_574",LegendVisibleness:"9999_116",xAxShw:"9999_124",xAxTtCtt:"293_9999",xAxTtFntClr:"293_574",xAxTtFntFml:"293_576",xAxTtFntStyle:"293_584",xAxLbFntSz:"272_603",xAxLbFntFml:"272_576",xAxLbFntStyle:"272_584",yAxShw:"9999_125",yAxTtCtt:"299_9999",yAxTtFntClr:"299_574",yAxTtFntFml:"299_576",yAxTtFntStyle:"299_584",yAxLbFntSz:"296_603",yAxLbFntFml:"296_576",yAxLbFntStyle:"296_584",bgFillClr:"1_564",bgFillEff:"1_879",bgFillTrans:"1_608",outBdrClr:"1_588"};mstrmojo.gm.EnumRefLineModelType={MAX:1,MIN:2,AVG:3,MED:4,FIRST:5,LAST:6,CONST:7};mstrmojo.gm.EnumTrendLineModelType={BEST_FIT:256,LINEAR:257,LOG:258,EXP:259,POW:260,POLY:261};mstrmojo.gm.EnumTrendRefLevel={DssModelLevelReserved:0,DssModelLevelPerCell:1,DssModelLevelPerRow:2,DssModelLevelPerColumn:3,DssModelLevelPerPanel:4,DssModelLevelLastOne:5};mstrmojo.gm.EnumTimeRole={None:0,YearOfDecade:3083,QuarterOfYear:2826,MonthOfYear:2825,MonthOfQuarter:2569,WeekOfYear:2824,WeekOfQuarter:2568,WeekOfMonth:2312,DayOfYear:2823,DayOfQuarter:2567,DayOfMonth:2311,DayOfWeek:2055,HourOfDay:1798,MinuteOfDay:1797,MinuteOfHour:1541,SecondOfDay:1796,SecondOfHour:1540,SecondOfMinute:1284};mstrmojo.gm.EnumTrendRefModelLabels={DssModelLabelsReserved:-1,DssModelLabelsNone:0,DssModelLabelsType:1,DssModelLabelsMetric:2,DssModelLabelsValue:4};mstrmojo.gm.EnumTRFManipulations={AddTRLine:"141",RemoveTRLine:"142",UpdateTRLine:"143",UpdateForecastInfo:"144"};mstrmojo.gm.EnumShapeFormatStatus={NORMAL:0,PER_COLORBY:1,PER_SHAPE:2};mstrmojo.gm.EnumNGMSubtype={CLUSTERED:0,STACKED:1,PERCENT:2};mstrmojo.gm.EnumBoxPlotMean={NO_MEAN:0,ONLY_MEAN:1,MEAN_STDEV:2};mstrmojo.gm.EnumBoxPlotOutliers={OUTLIERS:0,ALL_POINTS:1,JITTER:0,JTR_MAN:0.5,POINT_POS:0,POS_MAN:-1.8,POINT_SIZE:6,SIZE_MAN:10,MANUAL:1};mstrmojo.gm.EnumHistogram={AUTOMATIC:1,MANUAL:0,CUST_INPUT:2,DATASET:3,BY_BIN_SIZE:4,BY_BIN_NUMBER:5};mstrmojo.gm.EnumContainerFitModes={AUTOMATIC:0,FIT_TO_CONTAINER:1,FIT_TO_CONTENT:2};mstrmojo.chart.model.enums.EnumDSSObjectType={DssTypeUnknown:-1,DssTypeReserved:0,DssTypeGeneric:5,DssTypeFormatBAD:46,DssTypeFilter:1,DssTypeTemplate:2,DssTypeReportDefinition:3,DssTypeMetric:4,DssTypeStyle:6,DssTypeAggMetric:7,DssTypeFolder:8,DssTypeDevice:9,DssTypePrompt:10,DssTypeFunction:11,DssTypeAttribute:12,DssTypeFact:13,DssTypeDimension:14,DssTypeTable:15,DssTypeDatamartReport:16,DssTypeFactGroup:17,DssTypeShortcut:18,DssTypeResolution:19,DssTypeMonitor:20,DssTypeAttributeForm:21,DssTypeSchema:22,DssTypeFormat:23,DssTypeCatalog:24,DssTypeCatalogDefn:25,DssTypeColumn:26,DssTypePropertyGroup:27,DssTypePropertySet:28,DssTypeDBRole:29,DssTypeDBLogin:30,DssTypeDBConnection:31,DssTypeProject:32,DssTypeServerDef:33,DssTypeUser:34,DssTypeTransmitter:35,DssTypeConfiguration:36,DssTypeRequest:37,DssTypeScript:38,DssTypeSearch:39,DssTypeSearchFolder:40,DssTypeDatamart:41,DssTypeFunctionPackageDefinition:42,DssTypeRole:43,DssTypeSecurityRole:44,DssTypeLocale:45,DssTypeConsolidation:47,DssTypeConsolidationElement:48,DssTypeScheduleEvent:49,DssTypeScheduleObject:50,DssTypeScheduleTrigger:51,DssTypeLink:52,DssTypeDbTable:53,DssTypeTableSource:54,DssTypeDocumentDefinition:55,DssTypeDrillMap:56,DssTypeDBMS:57,DssTypeMDSecurityFilter:58,DssTypePromptAnswer:59,DssTypePromptAnswers:60,DssTypeGraphStyle:61,DssTypeChangeJournalSearch:62,DssTypeNCSObjects:255,DssTypeReservedLastOne:63};(function(){mstrmojo.vi._MonitorsLayoutMode=mstrmojo.provide("mstrmojo.vi._MonitorsLayoutMode",{onLayoutModeChange:function(B){if(this._super){this._super(B);}},init:function A(B){this._super(B);if(mstrApp.attachEventListener){mstrApp.attachEventListener("layoutModeChange",this.id,"onLayoutModeChange");}}});}());mstrmojo.chart.model.enums.EnumDSSGraphProperty={DssGraphTextContent:9999,DssGraphContent:9999,DssGraphPropertyReserved:0,DssGraphAutoFitO1:4,DssGraphAutoFitO2:5,DssGraphAutoFitX:6,DssGraphAutoFitY1:7,DssGraphAutoFitY2:8,DssGraphGroupSpacing:10,DssGraphRiserWidth:11,DssGraphColorBySeries:12,DssGraphCurveColorAsSeries:13,DssGraphSDMOVAFactor:14,DssGraph2DAngle:18,DssGraph2DDepth:20,DssGraphDepthMode:21,DssGraph2ScaleDirectionX:22,DssGraph2ScaleDirectionY1:23,DssGraph2ScaleDirectionY2:24,DssGraph2ExcludeZeroX:25,DssGraph2ExcludeZeroY1:26,DssGraph2ExcludeZeroY2:27,DssGraphFormatDataTextX:28,DssGraphFormatDataTextY1:29,DssGraphFormatDataTextY2:30,DssGraphFormatX:33,DssGraphFormatY1:34,DssGraphFormatY2:35,DssGraphFormatZ:36,DssGraphGridLineO1:37,DssGraphGridLineO2:38,DssGraphGridLineX:39,DssGraphGridLineY1:40,DssGraphGridLineY2:41,DssGraphLabelModeO1:48,DssGraphLabelModeO2:49,DssGraphLegendLocation:52,DssGraphTitleXLocation:54,DssGraphTitleY1Location:55,DssGraphTitleY2Location:56,DssGraph2LogScaleX:57,DssGraph2LogScaleY1:58,DssGraph2LogScaleY2:59,DssGraphMarkerShape:60,DssGraphMarkerSize:61,DssGraph2DPlaceX:65,DssGraph2DPlaceY1:66,DssGraph2DPlaceY2:67,DssGraphConnectLine:68,DssGraphShowStepLine:70,DssGraph2ScaleEndX:74,DssGraph2ScaleEndY1:75,DssGraph2ScaleEndY2:76,DssGraph2DScaleFreqO1:87,DssGraph2DScaleFreqO2:88,DssGraph2DScaleFreqX:89,DssGraph2DScaleFreqY1:90,DssGraph2DScaleFreqY2:91,DssGraphScaleX:92,DssGraphScaleY1:93,DssGraphScaleY2:94,DssGraphShowSDDataLineType:96,DssGraphSDRiserType:97,DssGraphShowSDLine:98,DssGraphShowSDCurve:99,DssGraphShowSDLinrCorr:101,DssGraphShowSDLinrExp:102,DssGraphShowSDLinrFormula:103,DssGraphShowSDLinrLine:104,DssGraphShowSDLinrLog:105,DssGraphShowSDLinrNatLog:106,DssGraphShowSDLinrNPoly:107,DssGraphSDPolyFactor:108,DssGraphShowSDMeanLine:109,DssGraphShowSDMOVALine:110,DssGraphShowSDSTDDLine:111,DssGraphShowDataText:113,DssGraphShowDivBiPolar:114,DssGraphShowErrorBar:115,DssGraphShowLegendText:116,DssGraphShow2DO1Label:117,DssGraphShow2DO1:-117,DssGraphShow2DO2:118,DssGraphOffScaleTypeX:119,DssGraphOffScaleTypeY1:120,DssGraphOffScaleTypeY2:121,DssGraphShowQuadrants:122,DssGraphShowRiserShadows:123,DssGraphShow2DXTitle:124,DssGraphShow2DY1Title:125,DssGraphShow2DY2Title:126,DssGraphShow2DXLabel:127,DssGraphShow2DX:-127,DssGraphShow2DY1Label:128,DssGraphShow2DY1:-128,DssGraphShow2DY2Label:129,DssGraphShow2DY2:-129,DssGraphShowZeroLineX:130,DssGraphShowZeroLineY1:131,DssGraphShowZeroLineY2:132,DssGraph2DSideO1:133,DssGraph2DSideO2:134,DssGraph2DSideX:135,DssGraph2DSideY1:136,DssGraph2DSideY2:137,DssGraph2DSDSplitY:140,DssGraphStaggerO1:142,DssGraphStaggerO2:143,DssGraphStaggerX:144,DssGraphStaggerY1:145,DssGraphStaggerY2:146,DssGraphUniformBorders:148,DssGraphPieDepthValue:192,DssGraphPieHoleSizeValue:198,DssGraphPieInset:200,DssGraphPiesPerRowValue:201,DssGraphPieRotationValue:202,DssGraphShowFeeler:204,DssGraphShowLBLFeelerLabel:205,DssGraphShowLBLFeeler:-205,DssGraphShowLBLPie:206,DssGraphShowLBLRing:207,DssGraphDeleteSlice:208,DssGraphDetachSlice:209,DssGraphPieRestore:210,DssGraphPieTiltValue:211,DssGraphPieTiltOn:212,DssGraphShowPolarCoordinateAxis:215,DssGraphShowPolarConnectLines:218,DssGraphStockDataValueType:222,DssGraphShowBubbleGrid:245,DssGraphSDShowDataText:247,DssGraphShowTitleSeries:248,DssGraphConnectStackBars:249,DssGraphLegendBox:250,DssGraphLinkColors:260,DssGraph3DCustomView:265,DssGraph3DGridFloor:277,DssGraph3DGridLWall:278,DssGraph3DGridRiser:279,DssGraph3DGridRWall:280,DssGraph3DColTitleLocation:285,DssGraph3DLYTitleLocation:287,DssGraph3DRowTitleLocation:288,DssGraph3DRYTitleLocation:289,DssGraph3DScalefreqX:299,DssGraph3DScalefreqY:300,DssGraph3DScalefreqZ:301,DssGraphShow3DScatterLine:308,DssGraphShow3DLineToLWall:309,DssGraphShow3DLineToFloor:310,DssGraphShow3DLineToRWall:311,DssGraphSD3DRiserType:312,DssGraphShow3DShowDataLabelsBox:313,DssGraph3DOffScaleTypeX:314,DssGraph3DOffScaleTypeY:315,DssGraph3DOffScaleTypeZ:316,DssGraphShow3DCHeader:318,DssGraphShow3DColTitle:319,DssGraph3DShowDataText:320,DssGraphShow3DLNumber:321,DssGraphShow3DLYTitle:322,DssGraphShow3DRNumber:323,DssGraphShow3DRYTitle:324,DssGraphShow3DRHeader:325,DssGraphShow3DRowTitle:326,DssGraphShow3DFloor:327,DssGraphShow3DLegend:328,DssGraphShow3DLWall:329,DssGraphShow3DRWall:330,DssGraph3DViewStruct:337,DssGraphACMColorModel:549,DssGraphLegendItems:554,DssGraphSeriesColor:556,DssGraphReverseGroup:558,DssGraphReverseSeries:559,DssGraphSeriesByColumn:560,DssGraphAreaBackColor:561,DssGraphAreaTransparency:563,DssGraphAreaColor:564,DssGraphAreaPattern:566,DssGraphAreaSFX:567,DssGraphFontAlign:570,DssGraphFontTransparency:573,DssGraphFontColor:574,DssGraphFontName:576,DssGraphFontRotation:578,DssGraphVirtualFontSize:583,DssGraphFontStyle:584,DssGraphType:585,DssGraphLineTransparency:587,DssGraphLineColor:588,DssGraphLinePattern:589,DssGraphVirtualLineWidth:591,DssGraphFootnoteLocation:592,DssGraphFrameLocation:593,DssGraphSubTitleLocation:594,DssGraphTitleLocation:595,DssGraphShowfootnote:596,DssGraphShowSubtitle:597,DssGraphShowTitle:598,DssGraphFontBox:601,DssGraphFontSize:603,DssGraphLockFontSize:604,DssGraphLineWidth:605,DssGraphAreaAlpha:608,DssGraphLineAlpha:609,DssGraphFontAlpha:610,DssGraphAreaCustomBevelEffect:612,DssGraphFormatDataTextAdv:616,DssGraphFormatXAdv:618,DssGraphFormatY1Adv:619,DssGraphFormatY2Adv:620,DssGraphFormatZAdv:621,DssGraphMiddleValue:630,DssGraphSplitYPosition:631,DssGraphAxisShowUserLine:632,DssGraphAxisUserLineValue:633,DssGraphAxisUserLineAxis:634,DssGraphMarkerLayout:637,DssGraphPieDataValueLoc:638,DssGraphPieDataLabelLoc:639,DssGraph2DOrdSpaceMode:642,DssGraphLegendLock:644,DssGraphGridStepY1:645,DssGraphGridStepY2:646,DssGraphGridStepX:647,DssGraphDataTextShowConnectLine:652,DssGraphGridLineZ:658,DssGraphScaleZ:659,DssGraphStaggerZ:660,DssGraph2ScaleEndZ:662,DssGraph2ExcludeZeroZ:663,DssGraph2ScaleDirectionZ:664,DssGraphGridStepZ:665,DssGraphGaugeInfo:668,DssGraphGaugeFancyBox:669,DssGraphSDMarkerSize:671,DssGraphSDMarkerShape:683,DssGraphMetric1:690,DssGraphMetric2:691,DssGraphStockStyle:692,DssGraph2ScaleDirectionY3:693,DssGraph2ExcludeZeroY3:694,DssGraphGridLineY3:697,DssGraphFormatY3Adv:699,DssGraphGridStepY3:701,DssGraphOffScaleTypeY3:702,DssGraphShow2DY3:704,DssGraph2DSideY3:706,DssGraphStaggerY3:707,DssGraph2DPlaceY3:709,DssGraph2ScaleEndY3:710,DssGraph2DScaleFreqY3:713,DssGraphScaleY3:714,DssGraph2ScaleDirectionY4:715,DssGraph2ExcludeZeroY4:716,DssGraphGridLineY4:719,DssGraphFormatY4Adv:721,DssGraphGridStepY4:723,DssGraphOffScaleTypeY4:724,DssGraphShow2DY4:726,DssGraph2DSideY4:728,DssGraphStaggerY4:729,DssGraph2DPlaceY4:731,DssGraph2ScaleEndY4:732,DssGraph2DScaleFreqY4:735,DssGraphScaleY4:736,DssGraphSpiderLines:739,DssGraphPolarStartAngle:740,DssGraphMetric3:742,DssGraphRadarCircularDataLines:782,DssGraphRemoteAxis:784,DssGraphConnectFirstLast:790,DssGraphGaugeShowAxisLabelsOutside:791,DssGraphGaugeShowNeedle:792,DssGraphTailShape:793,DssGraphPieForceRound:794,DssGraphGaugeStyleValue:795,DssGraphGaugeBorderStyleValue:796,DssGraphGaugeBorderThicknessValue:797,DssGraphGaugeRangeThicknessValue:798,DssGraphGaugeRangeStartAngleValue:799,DssGraphGaugeRangeStopAngleValue:800,DssGraphGaugeNeedleStyleValue:801,DssGraphCurvedLines:804,DssGraphAreaBevelEffect:879,DssGraphFontAntiAlias:881,DssGraphFormatDataTextY3:695,DssGraphFormatDataTextY4:717,DssGraphColorPalette:10000,DssGraphOriContent:10001,DssGraphFillEffect:10002,DssGraphGradient:10003,DssGraphSDShowToolTip:10004,DssGraphSDToolTip:10005,DssGraphSDRegressionType:10006,DssGraph2LogScale:10007,DssGraphManualMajor:10008,DssGraphManualMinor:10009,DssGraph2ScaleDirection:10010,DssGraphShow2DAxisLine:10011,DssGraph2ExcludeZero:10012,DssGraph2ScaleUseMax:10013,DssGraph2ScaleUseMin:10014,DssGraph2ScaleMax:10015,DssGraph2ScaleMin:10016,DssGraphShow2DAxisLabels:10017,DssGraph2ScaleEndMax:10018,DssGraph2ScaleEndMin:10019,DssGraphShow2DAxisMajor:10020,DssGraphShow2DAxisMinor:10021,DssGraph2DSide:10022,DssGraphStyleMajor:10023,DssGraphStyleMinor:10024,DssGraphCountMajor:10025,DssGraphCountMinor:10026,DssGraphShowTotalValue:10027,DssGraph2DPie:10028,DssGraphShowDataValue:10029,DssGraphShowDVPercent:10030,DssGraphShowDataLabel:10031,DssGraphShowPieLabelOnSide:10032,DssGraphShowMarker:10033,DssGraphShowMetric1:10034,DssGraphShowMetric2:10035,DssGraphShowMetric3:10036,DssGraphMetric1Style:10037,DssGraphMetric2Style:10038,DssGraphMetric3Style:10039,DssGraphShowLine:10040,DssGraphShowToolTip:10041,DssGraphToolTip:10042,DssGraphAxisAutoFit:10043,DssGraphAxisStagger:10044,DssGraphAxisScaleFreq:10045,DssGraphMetric1Value:10046,DssGraphMetric2Value:10047,DssGraphMetric3Value:10048,DssGraph2AxisFormatText:10049,DssGraph2AxisFormatDataText:10050,DssGraphDPI:10051,DssGraphDocSize:10052,DssGraphAutoArrange:10053,DssGraph2DSplitYAutomatic:10054,DssGraphHistogramRangeMin:10055,DssGraphHistogramRangeMax:10056,DssGraphHistogramBuckets:10057,DssGraphGaugeSAngle:10058,DssGraphGaugeEAngle:10059,DssGraphGaugeThickness:10060,DssGraphGauge1Show:10061,DssGraphGauge1Min:10062,DssGraphGauge1Max:10063,DssGraphGauge2Show:10064,DssGraphGauge2Min:10065,DssGraphGauge2Max:10066,DssGraphGauge3Show:10067,DssGraphGauge3Min:10068,DssGraphGauge3Max:10069,DssGraphGauge4Show:10070,DssGraphGauge4Min:10071,DssGraphGauge4Max:10072,DssGraphGauge5Show:10073,DssGraphGauge5Min:10074,DssGraphGauge5Max:10075,DssGraphAxisDataTextPlace:10076,DssGraphAxisNumberFormat:10077,DssGraphAxisDataNumberFormat:10078,DssGraphAxisHasErrorBar:10079,DssGraphAxisHasMiddleValue:10080,DssGraphHeight:10081,DssGraphWidth:10082,DssGraphPicture:10083,DssGraph3DTurnXCounterClockwise:10084,DssGraph3DTurnYCounterClockwise:10085,DssGraph3DTurnZCounterClockwise:10086,DssGraph3DTurnXClockwise:10087,DssGraph3DTurnYClockwise:10088,DssGraph3DTurnZClockwise:10089,DssGraph3DMoveXTowardsOrigin:10090,DssGraph3DMoveYTowardsOrigin:10091,DssGraph3DMoveZTowardsOrigin:10092,DssGraph3DMoveXAwayFromOrigin:10093,DssGraph3DMoveYAwayFromOrigin:10094,DssGraph3DMoveZAwayFromOrigin:10095,DssGraph3DDecreaseCubeX:10096,DssGraph3DDecreaseCubeY:10097,DssGraph3DDecreaseCubeZ:10098,DssGraph3DIncreaseCubeX:10099,DssGraph3DIncreaseCubeY:10100,DssGraph3DIncreaseCubeZ:10101,DssGraph3DDecreaseWallX:10102,DssGraph3DDecreaseWallY:10103,DssGraph3DDecreaseWallZ:10104,DssGraph3DIncreaseWallX:10105,DssGraph3DIncreaseWallY:10106,DssGraph3DIncreaseWallZ:10107,DssGraph3DPanXLeft:10108,DssGraph3DPanYUp:10109,DssGraph3DRelative:10110,DssGraph3DPanXRight:10111,DssGraph3DPanYDown:10112,DssGraph3DAbsolute:10113,DssGraph3DZoomIn:10114,DssGraph3DIncreasePerspectiveDistortion:10115,DssGraph3DStepSize:10116,DssGraph3DZoomOut:10117,DssGraph3DDecreasePerspectiveDistortion:10118,DssGraph3DInitMatrix:10119,DssGraphGaugeQBShow:10120,DssGraphGaugeQBStart:10121,DssGraphGaugeQBStop:10122,DssGraphEnhancedSeriesEffect:10123,DssGraphLocale:10124,DssGraph3DViewStructName:10125,DssGraphLabelsDistance:10126,DssGraphLegendDetails:10127,DssGraphDefaultsInitialized:10128,DssGraphShow3DAxisMajor:10129,DssGraphGradientColorMode:10130,DssGraphLegendDetailsNEW:10131,DssGraphFrameLocationNEW:10132,DssGraph3DColTitleLocationNEW:10133,DssGraph3DRowTitleLocationNEW:10134,DssGraphLabelsDistanceNEW:10135,DssGraphDocSizeNEW:10136,DssGraphUseManualHistogramBuckets:10137,DssGraphFontSize100:10138,DssGraphUseSpecialSeries:10140,DssGraphIsOnlyAdditionalMetrics:10170};mstrmojo.vi.ui.rw.selectors.EnumVizSelectorMode={CONFIGURATION:"configure",INTERACTIVE:"interactive"};(function(){mstrmojo._IsSelectorTarget=mstrmojo.provide("mstrmojo._IsSelectorTarget",{_mixinName:"mstrmojo._IsSelectorTarget",setDirty:function A(C){var D=(C?"add":"remove")+"DirtyKey",B=this.parent;if(B&&B[D]){this.parent[D](this.k);}}});}());mstrmojo.gmaps.MapEnums={};mstrmojo.gmaps.EnumBaseMapType={Reserved:"-1",Esri:"1",Google:"2",Image:"3",Mapbox:"4"};mstrmojo.gmaps.EnumDefaultMapStyle={Esri:"Light Gray Map",Google:"0",Image:"",Mapbox:"mapbox://styles/microstrategy/cj4fnd0xu1ax82rnuq287rwvu"};mstrmojo.gmaps.EnumLanguageType={Local:"{name}",English:"{name_en}",Both:"{name_en}\n{name}"};mstrmojo.gmaps.EnumGraphicType={Marker:"1",Bubble:"2",Area:"3",Density:"4",Path:"5"};mstrmojo.gmaps.EnumMarkerType={Pin:"1",Square:"2",Diamond:"3",Image:"4",Circle:"5"};mstrmojo.gmaps.EnumPolygonSource={Cloud:"1",Custom:"2",MapBoxPolygon:"3"};mstrmojo.gmaps.EnumShapeType={polygon:"polygon",multiPolygon:"multipolygon"};mstrmojo.gmaps.EnumGeometryType={Point:"Point",Extent:"2",Polygon:"Polygon"};mstrmojo.gmaps.EnumExtraCfgTaskId={Esri:"getESRIExtraConfig",Google:"getGoogleExtraConfig"};mstrmojo.gmaps.EnumGlobalCfgName={Esri:"esriConfig",Google:"googleConfig"};mstrmojo.gmaps.EnumThresholdType={Default:-1,Number:2,Text:3,Image:4,Url:5,QuickSymbol:10};mstrmojo.gmaps.EnumPropertyType={applyThreshold:"at",clusterMode:"mc",clusterRadius:"cr",clusterMaxZoom:"cmz",shapeFile:"lid",mapStyle:"dv",languageType:"lang",themeType:"dms",markerType:"mtp",zoomSetting:"rosa",legendSwitch:"ls",tooltipSwitch:"ts",legendWidthScale:"lwr",imageUrl:"mstyl",needMapToolbar:"mt",attributeId:"atf",useAttributeForm:"af",showZoomBtns:"zb",showAffinityLines:"da",showArcsLines:"dal",maxLineThickness:"lwm",maxBubbleSize:"mbs",useAbsolute:"mss",customInfoWinTpl:"iwd",pathColor:"pcp",affinityLineGrid:"ag",collapseLegend:"clgd",legendSize:"lgds",satf:"satf",dm:"dm",mvo:"mvo",baseMapType:"bmt",editingLayerIdx:"elx",mapGeoExtent:"mext",graphicType:"gtp",layerName:"ln",layerIdx:"lx",isRemoved:"ird",isHidden:"ih",enableZoomThroughLayer:"eztl",minLayerZoomLvl:"minlzl",maxLayerZoomLvl:"maxlzl",MAX_SIZE_TYPE:"maxst",MAX_SIZE_VALUE:"maxsv",MIN_SIZE_TYPE:"minst",MIN_SIZE_VALUE:"minsv",showMapLable:"mlb",mapLabelOnTop:"mlbt",distUnit:"mdu",geoAttribute:"ga",latitude:"lat",longitute:"lng",slice:"slc",angle:"amt",colorby:"cmt",sizeby:"smt",tooltip:"tooltip",keepZoomAndPos:"kzp",zoomLevel:"mz",mapCenter:"mp",mapBearing:"mbr",mapPitch:"mpt",dirtyVp:"dirtyVp",colorByOpacity:"cbo"};mstrmojo.gmaps.EnumGeographicRole={EnumGeographicRoleNone:"0",EnumGeographicRoleCity:"1",EnumGeographicRoleState:"2",EnumGeographicRoleCountry:"3",EnumGeographicRoleLocation:"4",EnumGeographicRoleLatitiude:"5",EnumGeographicRoleLongitude:"6",EnumGeographicRoleOther:"7",EnumGeographicRoleZipCode:"8",EnumGeographicRoleCounty:"9",EnumGeographicRoleLastOne:"10"};mstrmojo.gmaps.EnumClusterMode={MOBILE_OFF:"0",MOBILE_ON:"1",ON:"2",OFF:"3",PIE:"4"};mstrmojo.gmaps.EnumZoomBehavior={Keep:"0",Automatic:"1"};mstrmojo.gmaps.EnumDistUnitType={KM:"0",Miles:"1"};mstrmojo.gmaps.EnumDataLabel={DATA_LABEL_SHOW:"dlShw",DATA_LABEL_SHOW_ALL:"dlShwAll",DATA_LABEL_FONT_SIZE:"dlFntSz",DATA_LABEL_FONT_FAMILY:"dlFntFml",DATA_LABEL_FONT_COLOR:"dlFntClr",DATA_LABEL_FONT_STYLE:"dlFntStyle",DATA_LABEL_FONT_HALO_COLOR:"dlFntHaloClr",DATA_LABEL_FONT_HALO_WIDTH:"dlFntHaloWidth"};mstrmojo.gmaps.EnumShapeFormatting={SHAPE_FORMAT_FILL_COLOR:"shapeClr",SHAPE_FORMAT_FILL_OPACITY:"shapeFillTrans",SHAPE_FORMAT_BORDER_COLOR:"shapeLineClr",SHAPE_FORMAT_BORDER_STYLE:"shapeLineStyle"};mstrmojo.gmaps.EnumCombinedLineStyle={NONE:99,THIN:1,THICK:2,DASHED:3,DOTTED:4};mstrmojo.gmaps.EnumDefaultShapeFormatStyle={FILL_COLOR:"#436CD3",FILL_OPACITY:"85",FILL_OPACITY_VALUE:"0.85",FILL_OPACITY_FACTOR_HOVER:0.75,FILL_OPACITY_FACTOR_UNSEL:0.5,BORDER_STYLE:mstrmojo.gmaps.EnumCombinedLineStyle.THIN,BORDER_COLOR:"#FFFFFF",BORDER_WIDTH:"1"};mstrmojo.gmaps.DEFAULT_DATA_LABEL_PROPS={dlShw:[0],dlShwAll:[false],dlFntFml:["Arial"],dlFntSz:["8pt"],dlFntStyle:[0],dlFntClr:[0]};mstrmojo.gmaps.EnumDataLabelShowOption={NONE:0,SHOW_TEXT:1,SHOW_VALUE:2,SHOW_BOTH:3};mstrmojo.gmaps.MarkerAlignOption={CENTER:0,TOP:1,LEFT:2,RIGHT:3,BOTTOM:4,TOP_LEFT:5,TOP_RIGHT:6,BOTTOM_LEFT:7,BOTTOM_RIGHT:8};mstrmojo.gmaps.EnumToolbarButtonType={DRILL:1,SINGLE_SELECT:2,RECTANGLE_SELECT:4,EDIT_INFO_WINDOW:8,CLEAR_ALL:16,AFFINITY:32,FREE_SELECT:64,CIRCLE_SELECT:128,ZOOM:256,LAYERS_SELECT:512,KEEP_ONLY:1024,EXCLUDE:2048,SHOW_DATA:4096,SEARCH_BAR:8192,MAP_STYLE:16384};mstrmojo.gmaps.EnumToolbarState={NORMAL:0,SINGLE_SELECT:1,RECTANGLE_SELECT:2,ZOOM:3,AFFINITY:4,FREE_SELECT:5,CIRCLE_SELECT:6,CLEAR_ALL:7,LAYERS_SELECT:8,MARKERTYPE:9,CLUSTER:10,MAP_TYPE:11};mstrmojo.gmaps.EnumActions={rename:"renameUnit",remove:"removeDropZoneUnit",add:"addDropZoneUnit",addForm:"addForm",removeForm:"removeForm"};mstrmojo.gmaps.TARGET_MAPOPTIONS=1;mstrmojo.gmaps.TARGET_FORMATTING_LAYERS=2;mstrmojo.gmaps.SelectionHashType={PRIMARY:0,TEMPLATE_SELECTION:1,EDITING_LAYER:2,RMC_LAYER:3};mstrmojo.gmaps.EnumTransformState={ReadyToUse:-1,UseExistingLine:0,CrossFromExistingToNewLine:1,UseNewLine:2,CrossFromNewToExistingLine:3};mstrmojo.gmaps.EnumDrillLinkAnswerType={SAME_PROMPT:1,DO_NOT_ANSWER:2,CLOSE:3,DYNAMIC:4,STATIC:5,CURRENT_UNIT:6,ALL_VALID_UNITS:7,USE_DEFAULT_ANSWER:8,DYNAMIC_OR_SAME_PROMPT:9};mstrmojo.gmaps.EnumMinSizeType={PROPORTIONAL:1,FULL_RANGE:2,ADJUSTED_RANGE:3};mstrmojo.gmaps.EnumMaxSizeType={AUTOMATIC:1,MANUAL:2};mstrmojo.gmaps.EnumDynamicZoomStatus={INIT:0,NO_GEO_ATTR:1,FIRST_ADD_GEO_ARR:2,FIRST_GEO_ADD_FINISHED:3};mstrmojo.gmaps.ZoomAnimationDelta=0.15;mstrmojo.gmaps.LAYER_INDEX_MAX=100;mstrmojo.gmaps.LASSOLAYER_ZINDEX=mstrmojo.gmaps.LAYER_INDEX_MAX+1;mstrmojo.gmaps.ZOOMBTN_ZINDEX=mstrmojo.gmaps.LAYER_INDEX_MAX+50;mstrmojo.gmaps.ENABLE_MAX_MIN_SIZE_CONTROL=true;mstrmojo.gmaps.EnumRenderMethod={svg:"svg",canvas:"canvas",mapbox:"mapbox"};mstrmojo.gmaps.EnumLayerZoneSource={DROP_ZONE:"dzpn",PROPERTY_PANEL:"pppn"};(function(){mstrmojo.requiresCls("mstrmojo.gmaps.MapEnums");var E=mstrmojo.gmaps,M=E.EnumGeographicRole,G=E.EnumBaseMapType,L=E.EnumPolygonSource,J="4-s";function K(O){return !!(O&&O.custom&&(O.custom==="true"||O.custom===true));}mstrmojo.gmaps._AreaMapHelper=mstrmojo.provide("mstrmojo.gmaps._AreaMapHelper",{_mixinName:"mstrmojo.gmaps._AreaMapHelper",getAvailableShapes:function N(O,W,U,V){var R=[],Q,S,P;if(!O||U==undefined){return R;}if(V===G.Mapbox){return this.getShapesForMapbox(O,W);}for(S=0,P=O.length;S<P;S++){Q=O[S];if(V!==G.Esri&&!K(Q)){continue;}if(this.isMapBoxShapeConfig(Q,W)){continue;}if(U===M.EnumGeographicRoleNone||U===M.EnumGeographicRoleOther&&K(Q)||U==Q.roleId){R.push(Q);}}return R;},getShapesForMapbox:function C(O,U){var R=[],Q,S,P;for(S=0,P=O.length;S<P;S++){Q=O[S];if(this.isMapBoxShapeConfig(Q,U)){Q.supportedGeoRoles=[Q.roleId];if(Q.roleId===M.EnumGeographicRoleCity){Q.supportedGeoRoles.push(M.EnumGeographicRoleCounty);}R.push(Q);}}return R;},getPolygonSource:function D(O,P,Q,U){var R=O&&O.data,V=R&&R.vp,W=V&&V.lid,S,X;if(!V){return L.Cloud;}if(!!W){S=this.getMatchingShape(P,W,null);}else{X=this.getShapeAttributeGeoRole(R,O.dropZones.geoAttribute);P=this.getAvailableShapes(P,Q,X,U);S=this.getMatchingShape(P,null,X);}if(!!S){if(!W){V.lid=S.id;}if(K(S)){if(this.isMapBoxShapeConfig(S,Q)){return L.MapBoxPolygon;}return L.Custom;}}return L.Cloud;},isMapBoxShapeConfig:function A(O,S){var Q,P,R=(S&&S.length)||0;for(Q=0;Q<R;Q++){P=S[Q];if(O.layerId===P.id){return parseInt(P.scope)===parseInt(G.Mapbox);}}return false;},isMapboxStatisticalShape:function B(O,S){var Q,P,R=(S&&S.length)||0;for(Q=0;Q<R;Q++){P=S[Q];if(O&&O.layerId===P.id){return P.scope===J;}}return false;},getShapeAttributeGeoRole:function F(S,V){var P=S.gts,a=P&&P.row,O,Z,Y,U,X,Q,R,W=false;if(!a||!a.length){return ;}X=a.length;if(!!V){for(U=0;U<X;U++){Y=a[U];if(Y.id!==V){continue;}O=Y.fs;for(Q=0,R=O.length;Q<R;Q++){Z=O[Q].fgr;if(Z==undefined){continue;}Z=Z.toString();if(Z!==M.EnumGeographicRoleNone&&Z!==M.EnumGeographicRoleLatitiude&&Z!==M.EnumGeographicRoleLongitude){W=true;break;}}if(W){break;}}}else{for(U=0;U<X;U++){Y=a[U];O=Y.fs;for(Q=0,R=O.length;Q<R;Q++){Z=O[Q].fgr;if(Z!==M.EnumGeographicRoleNone&&Z!==M.EnumGeographicRoleLatitiude&&Z!==M.EnumGeographicRoleLongitude){break;}}}}return Z;},getMatchingShape:function I(P,U,X){var R,S,W,O,Q,V;if(!P){return null;}if(X===M.EnumGeographicRoleNone){X=null;}if(!!U){for(Q=0,V=P.length;Q<V;Q++){if(P[Q].id==U){R=P[Q];break;}}}else{if(!!X){for(Q=0,V=P.length;Q<V;Q++){O=P[Q];if(K(O)&&(O.roleId==X||(O.supportedGeoRoles&&O.supportedGeoRoles.indexOf(X)>-1))){if(!S){S=O;}if(!!O["default"]&&(O["default"]+"").toLowerCase()==="true"){R=O;break;}}else{if(!W&&O.roleId==X&&!!O["default"]&&(O["default"]+"").toLowerCase()==="true"){W=O;}}}if(!R){if(!!S){R=S;}else{if(!!W){R=W;}}}}}return R;},getShape4MapboxSecondGeoAttr:function H(P,Q,V,Y){var O,S,R,W,X,U;P=this.getAvailableShapes(P,Q,M.EnumGeographicRoleOther,G.Mapbox);W=(P&&P.length)||0;S=this.getMatchingShape(P,V,null);for(R=0;R<W;R++){O=P[R];if(O.roleId==Y||(O.supportedGeoRoles&&O.supportedGeoRoles.indexOf(Y)>-1)){if(Y==M.EnumGeographicRoleCountry){return O;}X=this.isMapboxStatisticalShape(S,Q);U=this.isMapboxStatisticalShape(O,Q);if(X===U){return O;}}}return null;}});}());(function(){mstrmojo.requiresCls("mstrmojo.array","mstrmojo.chart.model.enums.EnumDSSObjectType","mstrmojo.hash");var I=mstrmojo.array,B=mstrmojo.hash,D="u;",C="-1";ELEM_HIDDEN_PROP="hid";mstrmojo.elementHelper=mstrmojo.provide("mstrmojo.elementHelper",{buildElemsTerseID:function F(R,Q,V){var P,O;for(O in R){P=R[O];if(P.v){var S=P.v.replace(/\\\\/g,"\u001e").replace(/\\\;/g,"\u001f");var U=S.split(";");if(U&&U.length>1){U[1]=Q;if(V&&U.length>2){U.pop();}P.v=U.join(";").replace(/\u001e/g,"\\\\").replace(/\u001f/g,"\\;");}}}return R;},buildElemsCountStr:function K(U,Q,P){U=(!U||!U.length)?[]:U;Q=(!Q||!Q.length)?[]:Q;function S(V){return V.filter(function(W){return !W[ELEM_HIDDEN_PROP];});}var R=S(U).length,O=S(Q).length;if(I.find(Q,"v",D)>-1){O-=1;}if(I.find(Q,"v",C)>-1){O-=1;}if(P){R=(R<O)?O-R:0;}if(I.find(U,"v",D)>-1||I.indexOf(U,D)>-1){R=O;}return this.buildElemsCountStrByNum(R,O);},buildElemsCountStrByNum:function K(P,O){if(P===O){if(O===0){return"";}return O.toString();}else{if(O===0){return P+" "+mstrmojo.desc(514);}else{if(P>O){return"("+O+")";}}}return mstrmojo.desc(4891,"").replace("##",String(P)).replace("###",String(O));},browseElements:function G(Q,R,P){var O={doNotHold:!(P&&mstrApp.serverProxy),silent:true};mstrApp.serverRequest(mstrmojo.hash.copy(P,R),Q,O);},getIdPresentation:function J(R){if(!!R){var Q=R.charAt(0),O,P,S;if((Q>="g"&&Q<="w")||(Q>="V"&&Q<="Z")){P=false;for(S=1;S<R.length;++S){if(P){P=false;}else{switch(R.charAt(S)){case";":return"terseLong";case"\\":P=true;break;}}}return"terse";}if(Q>="B"&&Q<="Q"){if(R.length>2){O=R.charAt(1);if(O>="A"&&O<="Q"){if(R.charAt(2)===":"){return"oldLong";}}}}if(R.length>=33&&R.charAt(32)===":"){return"old";}}return null;},terseLong2OldShort:function N(P){if(this.getIdPresentation(P)!=="terseLong"){return P;}var O=P.replace(/\\\\/g,"\u001e").replace(/\\\;/g,"\u001f"),Q=O.substring(1,O.length).split(";");return(Q[1]+":"+Q[0]).replace(/\u001e/g,"\\\\").replace(/\u001f/g,"\\;");},oldShort2terseLong:function L(P,S){if(this.getIdPresentation(P)!=="old"){return P;}var O=P.replace(/\\\\/g,"\u001e").replace(/\\\:/g,"\u001f"),R=O.split(":"),Q=R.shift();return(S||"h")+(R.join(":")+";"+Q).replace(/\u001e/g,"\\\\").replace(/\u001f/g,"\\:");},isNullElem:function H(O){if(!O){return true;}var R=this.getIdPresentation(O),P=false,Q;switch(R){case"terse":case"terseLong":Q=O.substring(1,O.length).split(";");P=Q[0].indexOf(this.TERSE_NULL)>-1;break;case"old":case"oldLong":P=O.indexOf(this.OLD_NULL)>-1;break;}return P;},isNonGroupNull:function(Q){var O=Q.eid||(Q._e&&Q._e.id),P=O&&O.split(":")[0];return P&&P===this.NON_GROUP_NULL;},getAttributeId:function M(Q){var P,O;if(Q){O=Q.split(";");P=O[1];}return P;},getElementValue:function A(P){var Q,O;if(P){O=P.split(";");if(O.length>2){Q=O[0]+" "+O[2];}else{Q=O[0];}}return Q;},isAttributeIdsLinked:function E(P,O,Q){var S=false,R=B.keyarray(Q);I.forEach(R,function(U){if(U===P){I.forEach(Q[U],function(V){if(V===O){S=true;return false;}});}if(S){return false;}});return S;},ELEM_ALL_ID:"u;",ELEM_DUMMY_ID:"-1",ELEM_SEPARATOR:"\u001E",OLD_NULL:"~!@@~~!@@~",TERSE_NULL:"\\N",NON_GROUP_NULL:"n00000000000000000000000000000000",ELEM_ALL:{t:mstrmojo.chart.model.enums.EnumDSSObjectType.DssTypeDimension,v:"u;",n:"(All)"}});}());mstrmojo.requiresCls("mstrmojo.gm.GMEnums");var $GM=mstrmojo.gm,CHART_TYPE=$GM.EnumGraphType,PRP_DATA_LABELS=$GM.EnumDataLabels,PRP_LEGEND=$GM.EnumLegend,PRP_MIN_SIZE_TYPE=$GM.EnumMinSizeType,PRP_FIT_TO=$GM.EnumFitTo,ENUM_FIT_MODES=$GM.EnumContainerFitModes,NGM_GRID_LINE=$GM.EnumNGMGridLines;var ARIAL="Arial",OPEN_SANCE="Open Sans",ALL="ALL";var ENUM_LAYOUT_THEME={DEFAULT:"spatial",CLASSIC:"classic"};var classicProps={THEME_STYLE:ENUM_LAYOUT_THEME.CLASSIC,LAYOUT:{allFF:ARIAL,titleFF:ARIAL,dlvPadding:2,dlvMargin:4,dlvLOH_Compensation:1,ucTBLOHeight:1,drpChildPadding:4,drpLOHW_Compensation:0,cueBottomOffset:1},GRID:{paddingSize:5,mRatio:2,lRatio:3,gridTemplateVisible:false},HEATMAP:{smallGap:2,middleGap:4,largeGap:6,largerGap:8},NGM:{GENERAL_PROPS:(function(){var A={};A[ALL]={dataLabels:PRP_DATA_LABELS.HIDE};return A;}()),DEFAULT_PROPS:(function(){var A={};A[ALL]={cntrFitMode:ENUM_FIT_MODES.AUTOMATIC};return A;}())},OGM:{GENERAL_PROPS:(function(){var A={};A[ALL]={dataLabels:PRP_DATA_LABELS.HIDE,minRowHeight:20,fitTo:PRP_FIT_TO.AUTOMATIC};return A;}()),DEFAULT_PROPS:(function(){var A={};A[ALL]={};A[CHART_TYPE.BAR]={shpBdrThk:1,shpBdrStyle:0};A[CHART_TYPE.PIE]={shpBdrThk:1,shpBdrStyle:0};A[CHART_TYPE.GRID]={shpFillTrans:70};return A;}())},KPI:{fontFamily:ARIAL,defaultFontClr:{1:"#444649",2:"#FFFFFF",3:"#FFFFFF",4:"#FFFFFF"}}},defaultProps={THEME_STYLE:ENUM_LAYOUT_THEME.DEFAULT,LAYOUT:{allFF:OPEN_SANCE,titleFF:OPEN_SANCE,dlvPadding:0,dlvMargin:0,dlvLOH_Compensation:0,ucTBLOHeight:0,drpChildPadding:12,drpLOHW_Compensation:12,cueBottomOffset:-2},GRID:{paddingSize:4.52,mRatio:1050/452,lRatio:1205/452,gridTemplateVisible:true},HEATMAP:{smallGap:1,middleGap:3,largeGap:5,largerGap:5,cellTextSize:11,fontFamily:"Open Sans SemiBold",leftPadding:10,topPadding:8,lineHeightTime:1.3,marginTop:"3px"},NGM:{GENERAL_PROPS:(function(){var A={};A[ALL]={dataLabels:PRP_DATA_LABELS.HIDE};A[CHART_TYPE.WATERFALL]={dataLabels:PRP_DATA_LABELS.HIDE};return A;}()),DEFAULT_PROPS:(function(){var A={};A[ALL]={cntrFitMode:ENUM_FIT_MODES.FIT_TO_CONTENT,dlFntFml:OPEN_SANCE,rfLnFntFml:OPEN_SANCE,lgdFntFml:OPEN_SANCE,xAxTtFntFml:OPEN_SANCE,xAxLbFntFml:OPEN_SANCE,yAxTtFntFml:OPEN_SANCE,yAxLbFntFml:OPEN_SANCE,allTxtFntFml:OPEN_SANCE,rwHdrTxtFntFml:OPEN_SANCE,colHdrTxtFntFml:OPEN_SANCE,rwVlTxtFntFml:OPEN_SANCE,colVlTxtFntFml:OPEN_SANCE,ttlFntFml:OPEN_SANCE,dlFntSz:"9pt",rfLnFntSz:"9pt",lgdFntSz:"9pt",xAxTtFntSz:"9pt",xAxLbFntSz:"9pt",yAxTtFntSz:"9pt",yAxLbFntSz:"9pt",allTxtFntSz:"9pt",rwHdrTxtFntSz:"9pt",colHdrTxtFntSz:"9pt",rwVlTxtFntSz:"9pt",colVlTxtFntSz:"9pt",ttlFntSz:"9pt"};A[CHART_TYPE.WATERFALL]={yGridLnShw:NGM_GRID_LINE.AUTO,xGridLnShw:NGM_GRID_LINE.AUTO};return A;}())},OGM:{GENERAL_PROPS:(function(){var A={};A[ALL]={dataLabels:PRP_DATA_LABELS.HIDE,minRowHeight:20,fitTo:PRP_FIT_TO.NONE};A[CHART_TYPE.PIE]={legend:PRP_LEGEND.HIDE,legendShow:false,dataLabels:PRP_DATA_LABELS.SHOW_TEXT_ONLY};A[CHART_TYPE.SCATTER]={minSizeType:PRP_MIN_SIZE_TYPE.AUTO};return A;}()),DEFAULT_PROPS:(function(){var A={};A[ALL]={rwHdrShw:false,colHdrShw:false,dlFntFml:OPEN_SANCE,rfLnFntFml:OPEN_SANCE,lgdFntFml:OPEN_SANCE,xAxTtFntFml:OPEN_SANCE,xAxLbFntFml:OPEN_SANCE,yAxTtFntFml:OPEN_SANCE,yAxLbFntFml:OPEN_SANCE,allTxtFntFml:OPEN_SANCE,rwHdrTxtFntFml:OPEN_SANCE,colHdrTxtFntFml:OPEN_SANCE,rwVlTxtFntFml:OPEN_SANCE,colVlTxtFntFml:OPEN_SANCE,ttlFntFml:OPEN_SANCE,dlFntClr:3815477,rfLnFntClr:3815477,lgdFntClr:3815477,xAxTtFntClr:3815477,xAxLbFntClr:3815477,yAxTtFntClr:3815477,yAxLbFntClr:3815477,allTxtFntClr:3815477,rwHdrTxtFntClr:3815477,colHdrTxtFntClr:3815477,rwVlTxtFntClr:3815477,colVlTxtFntClr:3815477,ttlFntClr:3815477,yAxTtFntStyle:1,xAxTtFntStyle:1,rwHdrTxtFntStyle:1,colHdrTxtFntStyle:1,dlFntSz:"9pt",rfLnFntSz:"9pt",lgdFntSz:"9pt",xAxTtFntSz:"9pt",xAxLbFntSz:"9pt",yAxTtFntSz:"9pt",yAxLbFntSz:"9pt",allTxtFntSz:"9pt",rwHdrTxtFntSz:"9pt",colHdrTxtFntSz:"9pt",rwVlTxtFntSz:"9pt",colVlTxtFntSz:"9pt",ttlFntSz:"9pt"};A[CHART_TYPE.AREA]={shpBdrThk:1,shpFillTrans:100,shpBdrClr:15461355};A[CHART_TYPE.BAR]={shpBdrClr:15461355,shpBdrStyle:0,shpBdrThk:1,shpFillTrans:100};A[CHART_TYPE.LINE]={shpFillTrans:100};A[CHART_TYPE.PIE]={shpBdrThk:1,shpBdrStyle:0,shpFillTrans:100,shpBdrClr:15461355};A[CHART_TYPE.SCATTER]={shpBdrStyle:99,shpFillTrans:40};A[CHART_TYPE.BUBBLE]={shpBdrStyle:99,shpFillTrans:40};A[CHART_TYPE.GRID]={shpBdrThk:1,shpFillTrans:100};return A;}())},KPI:{fontFamily:OPEN_SANCE,defaultFontClr:{1:"#35383A",2:"#FFFFFF",3:"#FFFFFF",4:"#FFFFFF"}}};mstrmojo.vi.enums.EnumThemeProperties={CLASSIC_THEME_PROPS:classicProps,DEFAULT_THEME_PROPS:defaultProps};mstrmojo.vi.enums.EnumThemeProperties.SUBTYPE={GRID:"GRID",LAYOUT:"LAYOUT",HEATMAP:"HEATMAP"};mstrmojo.vi.enums.EnumThemeProperties.ENUM_LAYOUT_THEME=ENUM_LAYOUT_THEME;mstrmojo.vi.enums.EnumThemeProperties.ENUM_LAYOUT_STYLE={DEFAULT:0,CARD:1,FLAT:2};(function(){mstrmojo.requiresCls("mstrmojo.models.template.Title");mstrmojo.models.template.Titles=mstrmojo.declare(null,null,{init:function D(G){var F=this.gridData=G.data,E=F.gts;this.titles=G.isRow?E.row:E.col;},size:function C(){return this.titles.length;},getTitle:function B(E){return new mstrmojo.models.template.Title({title:this.titles[E]});},getCSS:function A(E){return this.gridData.css[this.titles[E].cni].n;}});}());(function(){mstrmojo.requiresCls("mstrmojo.hash");var O=/this\.([\w\.\[\]\'\"\-]+)/m,D=/this\./m,M=/mstrmojo\.all\[[\'\"]([\w]+)[\'\"]\]\.([\w\.\[\]\'\"\-]+)/m,R=/mstrmojo\.all\[/m,L=/mstrmojo\.all\.([\w]+)\.([\w\.\[\]\'\"\-]+)/m,B=/mstrmojo\.all\./m,C=/\[(\d+)\]/g,E=/\[\'([\w\-]+)\'\]/g,P=/\[\"([\w\-]+)\"\]/g,H=/([\[\]].*)/;mstrmojo.Binding=mstrmojo.declare(null,null,{scriptClass:"mstrmojo.Binding",parent:null,source:null,destination:null,enabled:false,setter:"set",executing:0,init:function N(S){mstrmojo.hash.copy(S,this);mstrmojo.registry.add(this);},destroy:function F(){mstrmojo.publisher.clearSubscriptions(this.id);mstrmojo.registry.remove(this);},exec:function K(){this.executing++;var X=this._sourceFn;if(!X){var W=this.source;if(W!=null){if(typeof (W)=="string"){if(!(W.match("return "))&&!(W.match(/\;\s*\S/))){W="return "+W;}X=new Function(W);}else{if(typeof (W)=="function"){X=W;}}this._sourceFn=X;}}var S,Y=this.parent;if(X){try{S=X.apply(Y,[]);}catch(V){}}var U=this.setter,Z=this.destination;if(U==null){Y[Z]=S;}else{if(typeof (U)=="string"){Y[U](Z,S);}else{if(typeof (U)=="function"){U.apply(Y,[Z,S]);}}}this.executing--;},enable:function A(){if(!this.enabled){this.exec();var U=this._chains;if(!U){this._parseChains();U=this._chains;}for(var S in U){this._attachChain(U[S]);}this.enabled=true;}},disable:function J(){if(this.enabled){var U=this._chains;if(U){for(var S in U){this._detachChain(U[S]);}}this.enabled=false;}},_chains:null,_parseChains:function(){this._chains={};var V=this._chains;var U=this.source;if(U&&(typeof (U)=="function")){U=U.toString&&U.toString();}if(!U){return ;}function S(c,f,W,Y){var X=c,a;while(a=X.match(f)){var d=a[0],b=d.length,e=true;d=d.replace(C,".$1").replace(E,".$1").replace(P,".$1").replace(H,"");for(var Z in V){if(Z.substr(0,b)===d){e=false;break;}else{if(d.indexOf(Z)===0){delete V[Z];}}}if(e){V[d]={host:(W==null)?null:a[W],parts:a[Y].replace(C,".$1").replace(E,".$1").replace(P,".$1").replace(H,"").split(".")};}X=X.substr(a.index+b);}}if(D.test(U)){S(U,O,null,1);}if(R.test(U)){S(U,M,1,2);}if(B.test(U)){S(U,L,1,2);}},_attachChain:function Q(S,V){if(!S.evt2idx){S.evt2idx={};}if(!S.idx2evt){S.idx2evt=[];}var e=S.evt2idx,h=S.idx2evt,a=S.parts;var f=(V>=0)?V:0,c=this.id,X=mstrmojo.all,d=(V>0)?X[h[f-1].context][a[f-1]]:(S.host?X[S.host]:this.parent),U=a[f];var W=mstrmojo.array;while(d&&U){if(d.attachEventListener){var g=d[U+"_bindEvents"]||(U+"Change");if(typeof (g)=="string"){g=[g];}var Z=[];for(var b=0,Y=g.length;b<Y;b++){Z[b]=d.attachEventListener(g[b],c,"_callback");}for(var b=0;b<g.length;b++){e[d.id+"_"+g[b]]=f;}h[f]={context:d.id,evts:g,subs:Z};}d=d[U];U=S.parts[++f];}},_detachChain:function G(S,U){var V=mstrmojo.all,k=S.idx2evt,e=S.evt2idx,b=this.id;var Z=(U>-1)?U:0,c=k.length;if(Z<c){for(;Z<c;Z++){var a=k[Z];if(!a){break;}var X=a.context,d=V[X],h=a.evts;if(d&&d.detachEventListener){var l=a.subs;for(var g=0,W=l.length;g<W;g++){d.detachEventListener(l[g]);}}k[Z]=null;for(var Y=0,f=h.length;Y<f;Y++){delete e[X+"_"+h[Y]];}}}},_callback:function I(U){this.exec();if(!U||!U.name||!U.src){return ;}var V=U.src.id+"_"+U.name,X=this._chains;for(var Y in X){var W=X[Y],S=W.evt2idx[V];if(S!=null){this._detachChain(W,S+1);this._attachChain(W,S+1);}}}});})();(function(){mstrmojo.requiresCls("mstrmojo.hash","mstrmojo.array");var H=mstrmojo.array,B=mstrmojo.hash,J=B.isEmpty;var G=1;function D(Q){return(typeof Q==="object")?Q:{};}function E(R,Q){B.forEach(Q,function(S,W){var U=R[W];if(U===undefined){delete Q[W];return true;}S=Q[W]=D(S);U=R[W]=D(U);if(J(S)&&J(U)){throw (G);}else{if(J(U)){delete R[W];if(J(R[W])){E(R,Q);}}else{if(J(S)){delete R[W];if(J(R[W])){E(R,Q);}}else{try{E(R[W],Q[W]);}catch(V){switch(V){case G:R[W]=Q[W]={};break;}}}}}});}function I(Q){B.forEach(Q,function(R){B.forEach(R,function(V,S){var U=V.include,X=V.exclude;if(J(U)||J(X)){return true;}if(!J(U)&&!J(X)){try{E(X,U);}catch(W){switch(W){case G:R[S]={};break;}}}});});return Q;}function F(S,R,Q){B.forEach(S,function(V,U){if(V===true||J(V)){Q.push(R+U);}else{F(V,R+U+".",Q);}});return Q;}function P(Q){B.forEach(Q,function(R){B.forEach(R,function(V,S){var U=[];F(V.include,"",U);F(V.exclude,"!",U);R[S]=U.join(";");});});return Q;}function K(Q,R){B.forEach(Q,function(S,V){var U=R[V];if(U!==undefined){if(S!==true&&U!==true){K(S,U);}else{if(S===true&&U!==true){R[V]=true;}else{if(S!==true&&U===true){Q[V]=true;}}}}});}function L(R,S){var Q=true;B.forEach(R,function(Z,U){var X=S[U];if(X){var V=Z.include,a=Z.exclude,Y=X.include,W=X.exclude;if(!J(W)&&!J(a)){Q=false;return Q;}if(!J(Y)&&!J(V)){K(Y,V);}}return Q;});return Q;}function C(S,Q){Q=Q||{};if(S){var R=Q;H.forEach(S.split("."),function(X,V,U,W){R[X]=W?true:{};R=R[X];});}return Q;}mstrmojo.rw.model.RetrievalKeysConfig=mstrmojo.declare(null,null,{scriptClass:"mstrmojo.rw.model.RetrievalKeysConfig",init:function M(){this.nodes=[];this.filters={};},addNode:function A(R,U){var S=this.filters,Q=S[R];if(!Q){this.nodes.push(R);Q=S[R]={data:{},defn:{}};}if(U){if(L(Q,U)){S[R]=B.mergeHashes(Q,U);}else{throw ("The new filters for node key ## cannot be merged with the filters currently defined".replace("##",R));}}return this;}});mstrmojo.rw.model.RetrievalKeysConfig.getConsolidatedConfig=function O(U){var Q={},V={},S={};H.forEach(U,function R(X){var W=X.partialRetrieval;if(W){H.forEach(W.nodes,function(Y){V[Y]=true;});S=B.mergeHashes(S,W.filters);delete X.partialRetrieval;}H.forEach(X.actions,R);});if(!J(V)){Q.nodes=B.keyarray(V);}if(!J(S)){Q.filters=P(I(S));}return Q;};mstrmojo.rw.model.RetrievalKeysConfig.parseResponseFilters=function N(R){var Q=function(U){var S={};B.forEach(U,function(X,W){var V=S[W]={serialized:X,include:{},exclude:{}};H.forEach(X.split(";"),function(Z){var Y=Z.indexOf("!")===0;Z=Y?Z.slice(1):Z;C(Z,Y?V.exclude:V.include);});});return S;};return{data:Q(R.data),defn:Q(R.defn)};};}());(function(){mstrmojo.requiresCls("mstrmojo.array","mstrmojo.hash");var C=mstrmojo.array,B=mstrmojo.hash;mstrmojo.models.datasets.DataInterface=mstrmojo.provide("mstrmojo.models.datasets.DataInterface",{getFormsByAttrId:function A(F,E){var D=[];E=E||[];B.forEach(E,function(G){C.forEach(G.att||[],function(H){if(H.did===F){D=D.concat(H.fs||[]);return false;}});});D=C.filter(D,function(G){return !!G.obf;});return C.distinct(D,"fid");}});}());(function(){mstrmojo.requiresCls("mstrmojo.hash");var B=mstrmojo.hash;mstrmojo.Base=mstrmojo.declare(null,null,{scriptClass:"mstrmojo.Base",init:function A(C){B.copy(C,this);if(this.postApplyProperties){this.postApplyProperties();}}});}());mstrmojo.DPIManager={classes:[],registerClass:function registerClass(B,C,D,A){this.classes.push({c:B,d:C,s:D,v:A});},setDPI:function(){var A=mstrMobileApp.getDeviceDPI();mstrmojo.array.forEach(this.classes,function(B){B.c.prototype.layoutConfig[B.d][B.s]=B.v[A]+"px";});this.classes=[];}};(function(){document.msCSSOMElementFloatMetrics=true;mstrmojo.requiresCls("mstrmojo.hash");var S=mstrmojo.hash,H="containerNode",G="auto",Q="px";var I={v:G,c:undefined,sv:G};function E(d,g,f){var h=this._layoutWidgets[g],l=d.slot||H,j=h.f,k=h.p,e=(j&&j[l]!==undefined),c=(k&&k[l]!==undefined);if(l&&((!f&&e)||c)){return e?j[l]:(h.x*parseInt(k[l],10)/100)+Q;}return d[(g==="h")?"height":"width"];}function K(j,e,c){if(j.ignoreLayout){return ;}var d=(e===G)||e==="NaNpx",g=(c===G)||c==="NaNpx";var f=j.getLayoutOffsets&&j.getLayoutOffsets();if(f){if(!d){e=(parseInt(e,10)-f.h)+Q;}if(!g){c=(parseInt(c,10)-f.w)+Q;}}if(j.setDimensions){j.setDimensions(e,c);}else{if(j.set){if(!d){j.set("height",e);}if(!g){j.set("width",c);}}}}function a(f){var d=this.children,j,l;for(j=0,l=(d&&d.length)||0;j<l;j++){var e=d[j],m=e.slot||H;if(m){var k=E.call(this,e,"h",f),n=E.call(this,e,"w",f);this.setSlotDimensions(m,k,n);K(e,k,n);var c=E.call(this,e,"h",f),g=E.call(this,e,"w",f);if(c!==k||g!==n){K(e,c,g);}this.setSlotDimensions(m,c,g);}}this.afterLayout();}function B(){var d=this.children,c=this._layoutWidgets;S.forEach(this.slotNames,function(j,k){if(!j||this.skipsSlotLayout(k)){return ;}var g=(c.h&&c.h.getSlotSizeInfo(k,d))||I,e=(c.w&&c.w.getSlotSizeInfo(k,d))||I,f=g.c||e.c;mstrmojo.array.forEach(f,function(h){K(h,g.v,e.v);});this.setSlotDimensions(k,g.sv,e.sv);},this);this.afterLayout();}function D(d){var c=this.layoutConfig.xt?B:a;c.call(this,d);}function U(k,f,h){var j=k.slot||H,g=f&&f.a;if(!g||g[j]===undefined){return ;}var c=this[j]["offset"+h],e=g[j];if(c===e){return ;}f.x-=(c-e);g[j]=c;}function J(c){this.beforeLayout();var d=this._layoutWidgets,e=c.src;U.call(this,e,d.h,"Height");U.call(this,e,d.w,"Width");D.call(this,true);}function O(e,j){if(!e){return null;}var c=this.children,t=j.toLowerCase(),k=parseInt(this[t],10),m=k,o={},q={},h={},d={},p={},l,n,f,u,r;for(r in e){if(!e.hasOwnProperty(r)){continue;}u=e[r];if(u.match(/px$/)){k-=parseInt(u,10);o[r]=u;}else{if(u.match(/%$/)){q[r]=u;}else{if(u.match(/all/)){p[r]=m;}else{h[r]=u;}}}}if(!S.isEmpty(h)&&!S.isEmpty(q)){for(l=0,n=(c&&c.length)||0;l<n;l++){f=c[l];r=f.slot||H;if(r&&h[r]&&!f.ignoreLayout){if(f.hasRendered){var g=this[r];d[r]=g.getBoundingClientRect?Math.round(g.getBoundingClientRect()[j.toLowerCase()]):g["offset"+j];k-=d[r];}else{d[r]=0;f.attachEventListener((f instanceof mstrmojo.Container)?"childrenRendered":"renderComplete",this.id,J);}}}}return{f:S.isEmpty(o)?undefined:o,p:S.isEmpty(q)?undefined:q,a:S.isEmpty(d)?undefined:d,n:S.isEmpty(p)?undefined:p,x:k,getSlotSizeInfo:function(AD,x){if(!e[AD]){return I;}var w=mstrmojo.array.filter(x,function(AF){var AE=AF.slot;return AE===AD||(AD===H&&!AE);}),AB,AC;var v=o[AD];if(v){AC=v;}var AA=q[AD];if(AA){AC=(this.x*parseInt(AA,10)/100)+Q;}if(h[AD]){AC=d[AD];if(AC){AC+=Q;}else{AC=G;}AB=G;}var z=p[AD];if(z){AC=AB=z+Q;}AC=AC||"0px";return{v:AC,c:w,sv:AB||AC};}};}function R(d){var c=this.domNode;if(!c||!this.layoutConfig){return ;}c.style[d]=this[d];this.doLayout();}mstrmojo._HasLayout=mstrmojo.provide("mstrmojo._HasLayout",{_mixinName:"mstrmojo._HasLayout",height:"auto",width:"auto",ignoreLayout:false,beforeLayout:mstrmojo.emptyFn,afterLayout:mstrmojo.emptyFn,forceLayout:false,layoutConfig:null,init:function W(c){this._super(c);this.layoutConfig=S.clone(this.layoutConfig);},preBuildRendering:function C(){var e=this.cssText||"";var c=this.height;if(c&&c!==G){e+="height:"+this.height+";";}var d=this.width;if(d&&d!==G){e+="width:"+this.width+";";}this.cssText=e;return(this._super)?this._super():true;},postBuildRendering:function X(){this.doLayout();return this._super();},modifyLayoutConfig:function Z(e,d){var c=this.layoutConfig=this.layoutConfig||{};c.h=S.copy(e,c.h);c.w=S.copy(d,c.w);this.doLayout();},getLayoutOffsets:mstrmojo.emptyFn,set:function P(e,c){var d=this._super(e,c);if(e==="visible"&&this._pendingLayoutOnVisible){delete this._pendingLayoutOnVisible;this.doLayout();}return d;},doLayout:function A(){var c=this.layoutConfig;if(!c||(this.height===G&&this.width===G)){return ;}if(c.xt){if(!this.visible){this._pendingLayoutOnVisible=true;return ;}}this.beforeLayout();this._layoutWidgets={h:O.call(this,c.h,"Height"),w:O.call(this,c.w,"Width")};D.call(this,false);this.widgetResized();},browserResized:function F(c){this.setDimensions(c.h,c.w);return true;},onwidthChange:function N(){R.call(this,"width");},onheightChange:function M(){R.call(this,"height");},skipsSlotLayout:function(c){return false;},adjustParentDimensions:function L(){var d=this.parent,c=d&&d._layoutWidgets;if(c){U.call(d,this,c.h,"Height");U.call(d,this,c.w,"Width");}},setDimensions:function V(f,d){var e=(f===G)||f==="NaNpx",g=(d===G)||d==="NaNpx";if((!e&&parseInt(this.height,10)!==parseInt(f,10))||(!g&&parseInt(this.width,10)!==parseInt(d,10))||this.forceLayout){if(!e){this.height=f;}if(!g){this.width=d;}var c=this.domNode,j=c&&c.style;if(j){if(!e){j.height=f;}if(!g){j.width=d;}this.doLayout();}return true;}return false;},setSlotDimensions:function Y(f,e,d){var c=this[f]&&this[f].style;if(!c){return ;}if(e!==G&&e!==undefined&&e!=="NaNpx"&&c.height!==e&&parseInt(e)>=0){c.height=e;}if(d!==G&&d!==undefined&&d!=="NaNpx"&&c.width!==d&&parseInt(d)>=0){c.width=d;}}});mstrmojo._HasLayout.getSlotSize=function b(f,g){var d=f&&f.prototype.layoutConfig;if(d){var e=d.h,c=d.w;return{h:(e&&e[g])||undefined,w:(c&&c[g])||undefined};}return null;};}());(function(){mstrmojo.requiresCls("mstrmojo.array","mstrmojo.hash");var I=mstrmojo.array,M=mstrmojo.hash;function J(V){if(V!==null){return(V.constructor!==Array)?[V]:V;}return null;}function F(f,d,Z){if(!d){return null;}var g=[],W=f.selectedIndices,V=f.allIdx,b=f.noneIdx;if(f.multiSelect&&(b>-1)&&(I.indexOf(d,b)>-1)){return g;}var Y,a,e=f.items,c=f.itemIdField,X=f.selectedItems,j;if(f.multiSelect&&(V>-1)&&(I.indexOf(d,f.allIdx)>-1)){for(Y=0,a=e.length;Y<a;Y++){if(!W[Y]){g.push(Y);W[Y]=true;f.selectedIndex=Y;f.selectedItem=e[Y];}}}else{for(Y=0,a=d.length;Y<a;Y++){var h=d[Y];if(!W[h]){W[h]=true;if(Z){g.push({idx:h,positions:Z});}else{g.push(h);}f.selectedIndex=h;j=f.selectedItem=e[h];if(X){X[j[c]]=j;}}}}return g;}function D(Y,V){var X=[],Z=Y.selectedIndices,a=Y.selectedItems,W;for(W in Z){delete Z[W];if(V){X.push({idx:parseInt(W,10),positions:V});}else{X.push(parseInt(W,10));}}Y.selectedIndex=-1;Y.selectedItem=null;if(a){Y.selectedItems={};}return X;}function U(f,e,Z){if(!e){return null;}var b=[],W=f.selectedIndices,h=I.indexOf,V=f.allIdx,c=f.noneIdx,d=f.itemIdField,X=f.selectedItems;if(f.multiSelect&&(((V>-1)&&(h(e,V)>-1))||((c>-1)&&(h(e,c)>-1)))){return D(f);}if(e.length>0&&W[V]){if(h(e,V)<0){e.push(V);}}var a=e.length,Y;for(Y=0;Y<a;Y++){var g=e[Y];if(W[g]){delete W[g];if(Z){b.push({idx:g,positions:Z});}else{b.push(g);}if(X){delete X[f.items[g][d]];}if(f.selectedIndex===g){f.selectedIndex=-1;f.selectedItem=null;}}}return b;}function C(Y,Z,W,V){if(V){return ;}if(this.raiseEvent){if((Y&&Y.length)||(Z&&Z.length)){try{this.raiseEvent({name:"selectionChange",added:Y,removed:Z});}catch(X){U(this,Y);F(this,Z);throw X;}}}}function B(W){var X=this.itemIdField,V=this.items;if(typeof W==="object"&&X){return I.find(V,X,W[X]);}return I.indexOf(V,W);}mstrmojo._ListSelections={multiSelect:false,allIdx:-1,noneIdx:-1,itemIdField:"",items:null,selectedIndices:null,selectedIndex:-1,selectedIndices_bindEvents:"selectionChange",selectedIndex_bindEvents:"selectionChange",selectedItem:null,selectedItem_bindEvts:"selectionChange",allowUnlistedValues:true,selectedItems:null,supportsIncFetch:false,init:function(V){this._super(V);if(this.supportsIncFetch&&this.itemIdField){this.selectedItems={};}if(!this.items){this.items=[];}if(!this.selectedIndices){this.selectedIndices={};if(this.selectedIndex>-1){this._set_selectedIndex("selectedIndex",this.selectedIndex,true);}else{if(this.selectedItem){this._set_selectedItem("selectedItem",this.selectedItem,true);}}}},addItems:function K(e){e=J(e);if(!e){return ;}var b=this.items,V=this.items.length,X=this.selectedItems,Z=[],W;b=this.items=b.concat(e);W=b.length;if(X){var a=this.itemIdField,Y,d;for(Y=V;Y<b.length;Y++){d=b[Y];if(X[d[a]]){Z.push(Y);}}}if(Z&&Z.length){F(this,Z);}if(W>V){var c=this.itemsContainerNode;if(c){c.innerHTML+=this._buildItemsMarkup(V,W-1).join("");}}},addSelectedItems:function S(V){this.selectItems(V,false);},setSelectedItems:function L(V){this.selectItems(V,true);},selectItems:function R(d,f){d=J(d);if(!d){return ;}if(f&&this.selectedItems){this.selectedItems={};}var X=this.selectedItems,b=this.itemIdField,V=[],Z=this.items.length,a=[],W=this.allowUnlistedValues,e,c,Y;for(Y=0;Y<d.length;Y++){e=d[Y];c=B.call(this,e);if(c<0){if(X===null){if(W){V.push(e);c=Z++;a.push(c);}}else{X[e[b]]=e;}}else{a.push(c);}}if(V.length>0){this.addItems(V);}if(a.length>0){if(f){this.select(a);}else{this.addSelect(a);}}},unselectItems:function A(W){W=J(W);if(!W){return ;}var b=this.selectedItems,X=[],a=this.itemIdField,Z,V,Y;if(b===null){return ;}for(Y=0;Y<W.length;Y++){Z=W[Y];if(b){delete b[Z[a]];}V=B.call(this,Z);if(V<0){X.push(V);}}if(X.length>0){this.removeSelect(X);}},getSelectedItems:function G(){if(this.selectedItems){return M.valarray(this.selectedItems);}return I.get(this.items,M.keyarray(this.selectedIndices,true));},singleSelect:function(W,X,V){if(W!==-1){this.select([W],X,V);}},singleSelectByField:function O(W,X,V){this.singleSelect(I.find(this.items,X,W),V);},toggleSelect:function Q(V){var X,W;if(this.selectedIndices[V]){W=U(this,[V]);}else{X=F(this,[V]);}C.call(this,X,W,[V]);},select:function(X,W,V){X=J(X);if(!X){return ;}var Z=D(this,V),b=F(this,X,V),Y;if(this.selectionPolicy!=="reselect"){for(Y=Z.length-1;Y>=0;Y--){var a=I.indexOf(b,Z[Y]);if(a>-1){Z.splice(Y,1);b.splice(a,1);}}}C.call(this,b,Z,X,W);},rangeSelect:function H(W,V){var b=this.selectedIndex,Z=b,a=this.allIdx,X=[],Y;if(W===a||this.selectedIndices[a]){X.push(a);}else{if(Z===-1&&this.selectedIndices){for(Y in this.selectedIndices){Z=parseInt(Y,10);break;}}Z=Z===-1?0:Z;if(Z>W){Z=W;W=b;}for(Y=Z;Y<=W;Y++){X.push(Y);}}this.select(X,V);this.selectedIndex=b;},clearSelect:function(V){C.call(this,null,D(this),[],V);if(!V){this.raiseEvent({name:"clearSelection"});if(this.parent){this.parent.raiseEvent({name:"clearSelection"});}}},addSelect:function(Y,V,W){Y=J(Y);if(!Y){return ;}var X=F(this,Y,W),a=null,Z=this.noneIdx;if(this.multiSelect&&(Z>-1&&I.indexOf(Y,Z)>-1)){a=U(this,Y);}C.call(this,X,a,Y,V);},removeSelect:function(X,V,W){X=J(X);if(!X){return ;}C.call(this,null,U(this,X,W),X,V);},_set_selectedIndices:function P(X,d,V){if(this.selectedItems){this.selectedItems={};}var W=this.selectedIndices;if(W===d){return false;}if(!W){W={};this.selectedIndices=W;}if(!d){d={};}var b=this.selectedIndex,a=[],c;for(c in W){if(!d[c]){c=parseInt(c,10);delete W[c];a.push(c);if(b===c){this.selectedIndex=-1;this.selectedItem=null;}}}var g=[],e=this.items,Z=this.itemIdField,f;for(c in d){if(!W[c]){c=parseInt(c,10);W[c]=true;g.push(c);this.selectedIndex=c;f=this.selectedItem=e[c];if(this.selectedItems){this.selectedItems[f[Z]]=f;}}}if(V!==true){var Y=[];for(c in d){if(W[c]){c=parseInt(c,10);Y.push(c);}}C.call(this,g,a,Y);}return(g.length||a.length);},_set_selectedIndex:function N(Y,W,V){var X={};if(W>-1){X[W]=true;}return this._set_selectedIndices("selectedIndices",X,V);},_set_selectedItem:function E(Y,X,W){var V=B.call(this,X);if((V<0)&&(X!==null&&X!==undefined)&&this.allowUnlistedValues&&this.items){this.set("items",this.items.concat(X));V=this.items.length-1;}return this._set_selectedIndex("selectedIndex",V,W);},_addSelections:function(V){return F(this,V);},_removeAll:function(){return D(this);}};}());(function(){mstrmojo.requiresCls("mstrmojo.dom","mstrmojo.hash");var D=mstrmojo.dom,L=mstrmojo.hash;var O=100;var F=D.supportsTouches?0.5:1;var G=1;var R=100;var P={onvscrollVisibleChange:function(){var V=this.vscrollNode,W=V&&V.style;if(!W){return ;}if(this.vscrollVisible){var U=this.maxPos,X=this.clientSize;W.height=Math.round(X.y*X.y/U.y)+"px";W.left=(X.x-5)+"px";W.display="block";W.opacity=0.5;}else{W.opacity=0;}},onhscrollVisibleChange:function(){var W=this.hscrollNode,V=W&&W.style;if(!V){return ;}if(this.hscrollVisible){var U=this.maxPos,X=this.clientSize;V.width=Math.round(X.x*X.x/U.x)+"px";V.top=(X.y-5)+"px";V.display="block";V.opacity=0.5;}else{V.opacity=0;}}};var M=L.copy({onposChange:function(){var W=this.clientSize,V=this.maxPos,U=0,X=0;if(this.scrollsVert){X=this.pos.y;if(this.vscrollVisible){this.vscrollNode.style[D.CSS3_TRANSFORM]="translateY("+Math.round((W.y-(W.y*W.y/V.y))*this.pos.y/V.y)+"px)";}}if(this.scrollsHoriz){U=this.pos.x;if(this.hscrollVisible){this.hscrollNode.style[D.CSS3_TRANSFORM]="translateX("+Math.round((W.x-(W.y*W.x/V.x))*this.pos.x/V.x)+"px)";}}this.scrollChild.style[D.CSS3_TRANSFORM]="translate3d(-"+parseInt(U,10)+"px, -"+parseInt(X,10)+"px, 0px)";},ondeceleratingChange:function(){this.scrollChild.style[D.CSS3_TRANSITION]=this.decelerating?(D.CSS3_PREFIX+"transform 0.2s linear"):"";}},L.copy(P));var H=L.copy({onposChange:function(){var W=this.clientSize,V=this.maxPos,U=0,Y=0,X=this.scrollboxNode;if(this.scrollsVert){Y=this.pos.y;if(this.vscrollVisible){this.vscrollNode.style.top=Math.round((W.y-(W.y*W.y/V.y))*this.pos.y/V.y)+"px";}X.scrollTop=parseInt(Y,10);}if(this.scrollsHoriz){U=this.pos.x;if(this.hscrollVisible){this.hscrollNode.style.left=Math.round((W.x-(W.y*W.x/V.x))*this.pos.x/V.x)+"px";}X.scrollLeft=parseInt(U,10);}}},L.copy(P));mstrmojo._TouchScrolling=mstrmojo.provide("mstrmojo._TouchScrolling",{FRICTION:0.65,BOUNCEFRICTION:0.5,usesTouches:false,bounces:true,scrollsHoriz:true,scrollsVert:true,pos:null,preBuildRendering:function N(){this.usesTouches=(mstrmojo.dom.supportsTouches&&this.usesTouches&&(this.scrollsHoriz||this.scrollsVert));if(this.usesTouches){this.pos={x:0,y:0};}if(this._super){this._super();}},postBuildRendering:function C(){if(this._super){this._super();}if(this.usesTouches){var X=this.scrollboxNode,W=this.itemsContainerNode||X.firstChild;if(X&&X!==W){this.scrollChild=W;var U=X.style;U.position="relative";U.overflow="hidden";var V=W.style;V.position="absolute";V.left=0;V.top=0;this.markupMethods=L.copy(D.isSafari?M:H,L.copy(this.markupMethods));this.attachTouchEvents();}}},unrender:function(U){if(this.usesTouches){this.detachTouchEvents();}this._super(U);},attachTouchEvents:function(){var V=this.touchNode||this.scrollboxNode;if(V){if(!this._tsCallback){var U=this;this._tsCallback=function(W){U.touchesBegin(self,W);};this._tmCallback=function(W){U.touchesMoved(self,W);};this._teCallback=function(W){U.touchesEnd(self,W);};}D.attachEvent(V,D.TOUCHSTART,this._tsCallback);this._tsNode=V;}},detachTouchEvents:function(){var U=this._tsNode;if(U){D.detachEvent(U,D.TOUCHSTART,this._tsCallback);delete this._tsNode;}},touchesBegin:function J(U,W){var V=W.target&&W.target.tagName;if(V&&(V==="SELECT"||V==="INPUT")){return ;}D.preventDefault(U,W);this.stopDeceleration();this.startTime=new Date();this.startTimePos={x:this.pos.x,y:this.pos.y};this.startTouchPos=D.getMousePosition(D.firstTouch(U,W),U);this.dragging=false;D.attachEvent(window,D.TOUCHMOVE,this._tmCallback);D.attachEvent(window,D.TOUCHEND,this._teCallback);},touchesMoved:function E(c,f){var a=D.getMousePosition(D.firstTouch(c,f),c);D.preventDefault(c,f);if(!this.dragging){var U=5,j=Math.abs;if((this.scrollsHoriz&&j(a.x-this.pos.x)>U)||(this.scrollsVert&&j(a.y-this.pos.y)>U)){this.dragging=true;this.dragStartTime=new Date();this.startTouchPos=a;var W=this.scrollboxNode,Z={x:W.clientWidth,y:W.clientHeight},g={x:W.scrollWidth,y:W.scrollHeight};this.clientSize=Z;this.scrollSize=g;this.maxPos={x:Math.max(g.x-Z.x,0),y:Math.max(g.y-Z.y,0)};this.showScroll();}}if(this.dragging){D.stopPropogation(c,f);var d=this.startTimePos,Y=this.startTouchPos,b=this.maxPos;var X={x:this.scrollsHoriz?Math.max(Math.min(d.x-(a.x-Y.x),b.x),0):0,y:this.scrollsVert?Math.max(Math.min(d.y-(a.y-Y.y),b.y),0):0};this.set("pos",X);this.nextLastDragPos=this.lastDragPos;this.lastDragPos=a;var V=new Date(),h=this.lastDragTime;this.nextLastDragTime=h;this.lastDragTime=V;if((V-h)>R){this.startTime=this.lastDragTime;this.dragStartTime=this.startTime;this.startTimePos={x:X.x,y:X.y};this.startTouchPos=a;}}},touchesEnd:function I(U,V){D.preventDefault(U,V);D.detachEvent(window,D.TOUCHMOVE,this._tmCallback);D.detachEvent(window,D.TOUCHEND,this._teCallback);if(this.dragging){this.dragging=false;D.stopPropogation(U,V);if((new Date())-this.lastDragTime<=R){this.startDeceleration(U,V);}else{this.hideScroll();}}},startDeceleration:function B(Z,a){var X=D.getMousePosition(D.firstChangedTouch(Z,a),Z),d=((mstrmojo.dom.supportsTouches===null)?this.lastDragPos:this.nextLastDragPos)||X,c={x:X.x-d.x,y:X.y-d.y},U=((mstrmojo.dom.supportsTouches===null)?this.lastDragTime:this.nextLastDragTime),f=U?(new Date())-U:0,W={x:f?Number(c.x*O*F/f).toFixed(2):0,y:f?Number(c.y*O*F/f).toFixed(2):0};var b=this,V=function(e){return(b.scrollsHoriz&&Math.abs(e.x)>=G)||(b.scrollsVert&&Math.abs(e.y)>=G);};if(V(W)){this.velocity=W;this.friction={x:this.FRICTION,y:this.FRICTION};this.set("decelerating",true);var Y=function(){b.decelerate();if(!V(b.velocity)){b.stopDeceleration();b=null;}};Y();if(this.decelerating){this.decelerationTimer=window.setInterval(Y,O);}}else{this.hideScroll();}},stopDeceleration:function A(){this.set("decelerating",false);delete this.velocity;if(this.decelerationTimer){window.clearTimeout(this.decelerationTimer);delete this.decelerationTimer;}this.hideScroll();},decelerate:function S(){var X=this.pos,W=this.velocity,V=this.friction,a=this.maxPos,Y={x:X.x-W.x,y:X.y-W.y},c=this.bounces,U=this.BOUNCEFRICTION;var b=Y.x;if(b<0||b>a.x){Y.x=(b<0)?0:a.x;W.x*=c?-U:0;V.x=U;}var Z=Y.y;if(Z<0||Z>a.y){Y.y=(Z<0)?0:a.y;W.y*=c?-U:0;V.y=U;}this.set("pos",Y);this.velocity={x:V.x*W.x,y:V.y*W.y};},hideScroll:function K(){this.set("vscrollVisible",false);this.set("hscrollVisible",false);},showScroll:function Q(){var U=this.maxPos;if(this.scrollsVert&&U.y&&this.vscrollNode){this.set("vscrollVisible",true);}if(this.scrollsHoriz&&U.x&&this.hscrollNode){this.set("hscrollVisible",true);}}});}());(function(){mstrmojo.requiresCls("mstrmojo.array","mstrmojo.hash");var E=mstrmojo.array,D=mstrmojo.hash;mstrmojo.vi.ui.rw._HasBufferSlice=mstrmojo.provide("mstrmojo.vi.ui.rw._HasBufferSlice",{_mixinName:"mstrmojo.vi.ui.rw._HasBufferSlice",_bufferedSlices:null,bufferSlice:function B(G){var F=this._bufferedSlices=this._bufferedSlices||{};if(G.ctlKey){F[G.ctlKey]=G;this.set("applyEnabled",true);}if(mstrApp.isAppStatePause&&mstrApp.isAppStatePause()){mstrApp.enableUpdate=true;}},getBufferedSlice:function C(F){var G=this._bufferedSlices||{};return G[F];},applyBufferedSlices:function A(H,L,G){var J=this._bufferedSlices;if(!J){return ;}var K,I;for(I in J){K=J[I]&&J[I].tks;if(K){break;}}var F={tks:K,events:J};if(H){if(G){E.forEach(this.model.buildSliceUrInfo(F).extraPuKeys,function(M){G.push(M);});}this.model.sliceDeferred(L,F);}else{this.model.slice(F);}this.clearBuffSlices();},clearBuffSlices:function(){this._bufferedSlices=null;this.set("applyEnabled",false);},clearSingleBuffSlice:function(F){var G=this._bufferedSlices;if(G&&G[F]){delete G[F];if(D.isEmpty(G)){this.set("applyEnabled",false);}}}});}());(function(){mstrmojo.requiresCls("mstrmojo.func","mstrmojo.hash");var E=mstrmojo.func.wrapMethods;function B(L,I,K,H,J){return E({success:function(M){if(mstrMobileApp&&mstrMobileApp.sendCallback){mstrMobileApp.sendCallback("success",I.target,JSON.stringify(I.memo),JSON.stringify(M));}},complete:function(){if(mstrMobileApp&&mstrMobileApp.sendCallback){mstrMobileApp.sendCallback("complete",I.target,JSON.stringify(I.memo));}J.removeCallback(K,H);},failure:function(M){if(mstrMobileApp&&mstrMobileApp.sendCallback){mstrMobileApp.sendCallback("failure",I.target,JSON.stringify(I.memo),JSON.stringify(M));}}},L);}mstrmojo._CanProxyCallback=mstrmojo.provide("mstrmojo._CanProxyCallback",{_mixinName:"mstrmojo._CanProxyCallback",callbacks:null,isCallbackReceiver:false,newCallback:function D(O){return O;var K=this.callbacks,I=mstrmojo.hash.copy(O),P=(O.index!==undefined)?String(O.index):"index",N=arguments.callee.caller.arguments,L,J,M,H=O.method||"anonymous";if(!K){K=this.callbacks={};}if(!K[H]){K[H]={};}if(!this.isCallbackReceiver){for(J=0,M=N.length;J<M;J++){L=N[J];if(L&&L.target){I=B(I,L,H,P,this);break;}}}if(!O.method){I.proxy=this.getCallbackMemo();}K[H][P]=I;return I;},anonymous:function(J,K,I,H){if(!this.isCallbackReceiver){K=B(K,H,"anonymous","index",this);mstrApp.serverRequest(J,K,I);}},getCallback:function C(K,J){var H=J||"index",I=this.callbacks;return I&&I[K]&&I[K][H];},removeCallback:function G(K,J){var H=J||"index",I=this.callbacks;if(I&&I[K]){delete I[K][H];if(mstrmojo.hash.isEmpty(I[K])){delete I[K];}}},getCallbackMemo:function F(I,H){return{target:'mstrmojo.all["'+this.id+'"].receiveCallback',memo:{method:I||"anonymous",index:H||"index"}};},receiveCallback:function A(L,J,K){var M=J.method,I=J.index,H=this.getCallback(M,I);if(H&&L&&H[L]){H[L](K);}}});}());(function(){mstrmojo.requiresCls("mstrmojo.dom","mstrmojo.array","mstrmojo.hash","mstrmojo.StringBuffer");var G=mstrmojo.dom,U=mstrmojo.hash,P=mstrmojo.array;function Y(){U.forEach(this.ifwMap,function(b){b.destroy();});this.ifwMap={};}function A(){var b=[],d=null,c=null;U.forEach(this.ifwMap,function(e){if(e.visible){b.push({psId:e.psId,psKey:e.psKey,autoCloseLocks:e.autoCloseLocks,lockInfoWinId:e.lockIW?e.lockIW.id:false,anchorPos:e.anchorPosition||G.position(e.anchor,true),anchorOrn:e.anchorOrientation});}});if(b.length>0){d=this.getSelectedLayoutWidget();c=d&&d.getScrollPos();}return{ifwRecords:b,docScrollRecord:c};}function O(k){var c=(k&&k.ifwRecords)||[],h=k&&k.docScrollRecord,f=this.getSelectedLayoutWidget(),g=this,j={};if(c.length>0){if(h&&f){f.scrollTo(h);}var d=this.model,e=d.getCurrentLayoutKey(),b=d.getLayoutDataCache(e);P.forEach(c,function(l){if(l.lockInfoWinId){j.lockInfoWinId=l.lockInfoWinId;}var m=window.setInterval(function(){if(b[l.psId]){window.clearInterval(m);g.showInfoWindow(l.psId,l.psKey,j,null,l.anchorOrn,l.anchorPos,l.autoCloseLocks);}},10);});}}function K(){if(mstrmojo.DICPopup&&mstrmojo.DICPopup.cancel){mstrmojo.DICPopup.cancel();}}function S(){P.forEach(this.xtabStyleSheets,function(c){var b=c.parentNode;if(b){b.removeChild(c);}});}function a(c,f){var d=this.getLayout(c),b=d.docGroupBy,e=this.controller;if(b){b.set("data",f.groupbys);d.gb=f;}if(e.getPageByTree){e.getPageByTree(true);}}mstrmojo._IsRwDocument=mstrmojo.provide("mstrmojo._IsRwDocument",{_mixinName:"mstrmojo._IsRwDocument",updateXtabStyles:function M(h,d){var o=this.xtabStyleSheets&&this.xtabStyleSheets[0],n=this.styleList||{},c=function(v,t){var u;for(u in t){var r=t[u].css||"";if(t[u].app){r=(v[u]||"")+r;}v[u]=r;}return v;},p=document;if(!n[h]){n[h]=c({},this.model.getSelectedXtabStyles(h));}c(n[h],d);if(!this.xtabStyleSheets){this.xtabStyleSheets=[];o=this.xtabStyleSheets[0]=p.getElementsByTagName("head")[0].appendChild(p.createElement("style"));}var q=new mstrmojo.StringBuffer(),f,g;for(f in n){for(g in n[f]){q.append(n[f][g]);}q.append("\n");}var e=q.toString();if(o&&e){o=o.styleSheet||o;if(G.isWK){var m=o.firstChild;if(m){m.nodeValue=e;}else{o.appendChild(p.createTextNode(e));}}else{if(G.isIE6||G.isIE7||G.isIE8||G.isIE9){o.cssText=e;var l,k,b,j;for(l=1;o.rules.length===4095&&p.styleSheets.length<31;l++){k=o.rules[4094];b=new RegExp(k.selectorText,"i");j=e.search(b);if(j===-1){break;}j=e.indexOf("}",j+1);e=e.slice(j+1);if(!this.xtabStyleSheets[l]){this.xtabStyleSheets[l]=p.getElementsByTagName("head")[0].appendChild(p.createElement("style"));}o=this.xtabStyleSheets[l].styleSheet;o.cssText=e;}}else{o.innerHTML=e;}}}this.styleList=n;},postBuildRendering:function X(){var b=document.getElementsByTagName("head")[0];P.forEach(this.xtabStyleSheets,function(c){b.appendChild(c);});return this._super();},buildChildren:function B(f){var k;try{var g=this.model;if(g){var h=this.buildSubs||{},q=g.id+"-partialUpdate",c=g.id+"-rebuildLayout",n=g.id+"-updateStyles",e=g.id+"-showInfoWin",d=this.id;var l=this,p=function(){P.forEach(l.getLayouts(),function(m){if(m.k!==g.currlaykey){m.defn.loaded=false;}});};if(h[q]===undefined){var o=function b(AA){var u=this.model,t=u&&u.getLayoutDataCache(u.getCurrentLayoutKey()),r=AA&&AA.ids;if(U.isEmpty(t)||!r){return ;}P.forEach(AA&&AA.tree&&AA.tree.layouts,function(m){if(m.k===u.currlaykey){this.updateXtabStyles(m.k,m.xtabStyles);if(m.gbys){a.call(this,m.k,m.gbys);}return false;}return true;},this);var w=U.forEach,AB=false,x={update:r.upd,refresh:r.tgts,adjustSectionSize:r.secs};w(r.ifws,function(AD,AC){var m=mstrmojo.all[AD+"_ifw"];if(m&&m.visible){this.updateInfoWindowPS(AD,AC);}},this);w(x,function(AC,m){w(AC,function(AF,AJ){var AE=mstrmojo.all[AJ],AI;if(AE&&AE[m]!==undefined){var AH=t[AJ],AD=(m==="update"?AH:null),AG=m;if(m==="update"){if(AE.updateForPU){AG="updateForPU";}else{AE.node=AH;}}else{if(m==="refresh"&&AE.refreshForPU){AG="refreshForPU";}}AI=AE[AG](AD);if(m==="adjustSectionSize"&&AI){AB=AB||(!!AI.heightReduced);}}},this);},this);var v=this.getSelectedLayoutWidget();if(AB){v.notifyScrollListeners();}var z=v.docLayout;if(z){z.resizeOrReposition();}if(AA&&AA.unloadCache){p();}};h[q]=g.attachEventListener("partialUpdate",d,o);}h[c]=h[c]||g.attachEventListener("rebuildLayout",d,function(m){var t=m&&m.restoreIW,r;if(t){r=A.call(this);this.model.aws=null;}this.onLayoutRebuilt(this.rebuildLayout(m.src.currlaykey,this.getLayouts()));if(m&&m.unloadCache){p();}if(t){O.call(this,r);}});h[n]=h[n]||g.attachEventListener("updateStyles",d,function(m){this.updateXtabStyles(m.key,m.updatedStyles);});h[e]=h[e]||g.attachEventListener("showInfoWin",d,function(m){this.showInfoWindow(m.psId,m.psKey,m.anchor,m.invalidate,m.anchorOrientation,m.anchorPosition);});this.updateXtabStyles(g.getCurrentLayoutKey());g.attachEventListener("refresh",this.id,function(){this.refresh();});}k=this._super(f);}catch(j){mstrmojo.err(j);}return k;},updateInfoWindowPS:mstrmojo.emptyFn,showInfoWindow:function J(c,u,l,n,q,r,AD){var e=this.model,h=e.getLayoutDataCache(e.getCurrentLayoutKey()),x=this.builder,b=h[c]&&h[c].defn,g=b&&b.iwpl,w=c+"_ifw",AC=mstrmojo.all[w],z=this.domNode,d=mstrmojo.DocInfoWindow.PLACEMENT.FIXED,AA=function(AE,AF,AG,AI,AH){if(g===d){if(AF){var AJ=G.delta(AF,z);AE.popPosition={left:(AJ&&AJ.x)?AI+AJ.x:AI,top:(AJ&&AJ.y)?AH+AJ.y:AH};}else{if(AG){AE.popPosition={left:(AG.scrollboxLeft)?AI-AG.scrollboxLeft:AI,top:(AG.scrollboxTop)?AH-AG.scrollboxTop:AH};}else{AE.popPosition={left:AI,top:AH};}}}};var p=this.getLayout(e.getCurrentLayoutKey());if(AC){if(n){AC.refresh();}AC.anchorOrientation=q;AC.anchorPosition=r;if(g===d){if(!AC._ifwpdn){var m=h[c]&&h[c].p,t=m&&e.getUnitInstance(m.k,m.wid);AC._ifwpdn=t&&t.domNode;}else{if(AC._ifwpdn.style.display==="none"){AC._ifwpdn=document.getElementById(AC._ifwpdn.id);}}}AA(AC,AC._ifwpdn,p,AC._ifwfl,AC._ifwft);AC.open(this,{anchor:l,boundary:z});}else{var j={opener:this,anchor:l,anchorOrientation:q,boundary:z,parent:this,builder:x,model:this.model,psKey:u,psId:c,id:w,autoCloses:true,locksHover:true,closeOnClick:false,autoCloseLocks:AD,anchorPosition:r};if(g){g=parseInt(g,10);j.placement=g;if(g===d){var k=b.fmts,f=j._ifwfl=k&&k.left&&parseInt(k.left.replace("px",""),10),v=j._ifwft=k&&k.top&&parseInt(k.top.replace("px",""),10),m=h[c]&&h[c].p,t=m&&e.getUnitInstance(m.k,m.wid),o=j._ifwpdn=t&&t.domNode;AA(j,o,p,f,v);}}AC=x.newInfoWindow(j);this.renderInfoWindow(AC);var AB=this.ifwMap=(this.ifwMap||{});AB[c]=AC;}},renderInfoWindow:function L(b){b.render();},_lockInfoWinContainer:function I(d){var g=this.ifwMap,c=function(h,j){return function(){h.releaseLock(j);};},b;for(b in g){var e=g[b],f=d.xtab;if(e&&f&&G.contains(e.infoNode,f.domNode,true,document.body)){e.registerLock(f);d.onClose=c(e,f);break;}}},unrender:function W(b){Y.call(this);this._super(b);S.call(this);},getLayouts:function Q(){return this._layouts;},getLayout:function V(b){b=b||this.model.getCurrentLayoutKey();var c=this.getLayouts();return c[P.find(c,"k",b)];},getSelectedLayoutWidget:mstrmojo.emptyFn,needLoadLayout:function R(b,c){return b.defn&&(c&&c.reload||(!!(c&&c.panelKey))||(b.defn.loaded===false)||(this.model.zt&&(window.mstrMobileApp!==undefined)&&(b.defn.lastOrientation!==mstrMobileApp.getOrientation())));},getNewLayout:function F(c,h,b,l,d){var g=this,e=g.model,k=c.layoutKey,f=h[P.find(h,"k",k)];if(this.needLoadLayout(f,c)){var j=l.success;l.success=function(m){e.replaceLayout(k,m,false);e.currlaykey=k;if(b){g.selectLayout(f,false,null,d);}var n=g.rebuildLayout(k,h,false);if(g.controller.getPageByTree){g.controller.getPageByTree(true);}j(n);};this.loadDocLayout(c,l,d);}else{if(b){this.selectLayout(f,true,{success:function(m){U.copyProps(["bs"],m,e);}},d);}if(!f.hasRendered){f=this.rebuildLayout(k,h);if(g.controller.getPageByTree){g.controller.getPageByTree(true);}}l.success(f);}},selectLayout:function E(e,f,h,g){var b=this.model,c=e.k,d=(c!==b.currlaykey);b.currlaykey=c;if(this.controller){this.controller.updateZoom();}this.restoreLayoutState(e);if(f&&d){this.setCurrentDocLayout(c,h,g);}else{if(h&&h.complete){h.complete();}}return e;},rebuildLayout:function C(d,l,m){var f=this.model,e=P.find,g=l[e(l,"k",d)],b=f.getChildren(this.node,false);var h=b[e(b,"k",d)];if(window.mstrMobileApp!==undefined){h.defn.lastOrientation=mstrMobileApp.getOrientation();}var j=this.replaceLayout(g,h);this.updateXtabStyles(d,f.getSelectedXtabStyles(d));if(m!==false){Y.call(this);}K();return j;},destroy:function Z(){Y.call(this);if(this._super){this._super();}S.call(this);},replaceLayout:mstrmojo.emptyFn,restoreLayoutState:mstrmojo.emptyFn,onLayoutRebuilt:mstrmojo.emptyFn,unloadGbLayuts:function H(d){var j=this.getLayouts(),f=this.model.getCurrentLayoutKey(),h,g,l,c,e,b;h=this.getLayout();c=h.gb&&h.gb.groupbys;for(e=0;e<c.length;e++){l=c[e];if(l.k===d){b=l.unit.target.did;break;}}for(g=0;g<j.length;g++){h=j[g];if(h.k===f){continue;}c=h.gb&&h.gb.groupbys;if(c&&c.length){for(e=0;e<c.length;e++){l=c[e];if(l.unit.target.did===b){h.defn.loaded=false;break;}}}}},loadDocLayout:function N(b,d,c){this.model.getDataService().loadDocLayout(b,d,c);},setCurrentDocLayout:function D(b,d,c){this.model.getDataService().setCurrentDocLayout(b,d,c);}});}());(function(){mstrmojo.requiresCls("mstrmojo.hash","mstrmojo.array");mstrmojo.vi.ui.rw.SelectionType={EMPTY:"empty",ATTS:"att",METRICS:"metric",COL_HEADERS:"col-headers",ROW_HEADERS:"row-headers",METRIC_VALUES:"metric-values"};var A=function(AA){var x=(mstrApp&&mstrApp.docModelData&&mstrApp.docModelData.mid)||"",z=AA.k||AA.key;return z+"-"+x;},F={},o={},R=mstrmojo.hash,X=mstrmojo.array,L=function(AA){var x=R.keyarray(AA).sort(),z=[],AB;X.forEach(x,function(AC){AB=[];X.forEach(AA[AC],function(AD){AB.push(this.model.getNormalizedFormElementId(AD.id));},this);z.push(AC+"-"+AB.sort().join("@"));},this);return z.join("#");},K=function(x){var z=L.call(this,x);if(!this._viSelections[z]){this._viSelections[z]=x;if(mstrApp&&mstrApp.isInVFConfigMode){return ;}F[A(this)]={_selectionType:this.getSelectionType(),_viSelections:this.getSelectionHash()};}},w=function(x){var z=L.call(this,x);if(!this._viContextMenuSelections[z]){this._viContextMenuSelections[z]=x;}},m=function(z){var AA=L.call(this,z),x=this._viSelections[AA];if(x){delete this._viSelections[AA];if(mstrApp&&mstrApp.isInVFConfigMode){return ;}F[A(this)]={_selectionType:this.getSelectionType(),_viSelections:this.getSelectionHash()};}return x;},c=function(z){var AA=L.call(this,z),x=this._viContextMenuSelections[AA];if(x){delete this._viContextMenuSelections[AA];}return x;},j=function(){var x=A(this);o=o||{};if(F[x]){o[x]=R.clone(F[x]);}},v=function(AB,AA,AF,AC,x,AE,z){var AD={};AD[AB]=[{id:AA,n:AF,fm:z,ui:AC,o:x,axis:AE}];return AD;},G=mstrmojo.vi.ui.rw.SelectionType;mstrmojo.vi.ui.rw._HasVisSelections=mstrmojo.provide("mstrmojo.vi.ui.rw._HasVisSelections",{_mixinName:"mstrmojo.vi.ui.rw._HasVisSelections",init:function(x){if(this._super){this._super(x);}this._viSelections={};},update:function b(z){var x=true;if(this._super){x=this._super(z);}if(!mstrApp.isInVFConfigMode){R.copy(F[A(this)],this);}if(!this.updateForInteractiveMode){j.call(this);}return x;},onSelectionChange:function J(x){if(this._super){this._super(x);}},_viSelections:{},_viContextMenuSelections:{},_selectionType:G.EMPTY,_contextMenuSelectionType:G.EMPTY,_cellSelections:[],getSelectionType:function(){return this._selectionType;},getContextMenuSelectionType:function(){return this._contextMenuSelectionType;},isSingleAttrSelection:function(){var z=null,x;if(this.getSelectionType()===G.ATTS){x=this.getSelections();if(x.length>1){return !x.some(function(AA){if(!z){z=AA[0].tid;return false;}return z!=AA[0].tid;},this);}return true;}return false;},isSingleContextMenuAttrSelection:function(){var z=null,x;if(this.getContextMenuSelectionType()===G.ATTS){x=this.getContextMenuSelections();if(x.length>1){return !x.some(function(AA){if(!z){z=AA[0].tid;return false;}return z!=AA[0].tid;},this);}return true;}return false;},isSingleSelection:function(){return(this._viSelections&&R.keyarray(this._viSelections).length===1);},isSingleContextMenuSelection:function(){return(this._viContextMenuSelections&&R.keyarray(this._viContextMenuSelections).length===1);},getSelectionSize:function p(){return(this._viSelections&&R.keyarray(this._viSelections).length)||0;},getCxtMnuSelectionSize:function C(){return(this._viContextMenuSelections&&R.keyarray(this._viContextMenuSelections).length)||0;},getSelectionHash:function Q(){return this._viSelections;},getContextMenuSelectionHash:function h(){return this._viContextMenuSelections;},getSelectionCache:function B(){return F[A(this)];},setSelectionCache:function V(x){F[A(this)]=x;},getPrevSelectionInfo:function I(){return o[A(this)];},getSelections:function l(){var x=[],z;R.forEach(this.getSelectionHash(),function(AA){z=[];x.push(z);R.forEach(AA,function(AB,AC){X.forEach(AB,function(AD){z.push({tid:AC,eid:AD.id,v:AD.n,level:AD.level});});});});return x;},getContextMenuSelections:function a(){var x=[],z;R.forEach(this.getContextMenuSelectionHash(),function(AA){z=[];x.push(z);R.forEach(AA,function(AB,AC){X.forEach(AB,function(AD){z.push({tid:AC,eid:AD.id,fm:AD.fm,v:AD.n,axis:AD.axis,o:AD.o,ui:AD.ui});});});});return x;},isMetricValueSelected:function r(x){return !!this._viSelections[L.call(this,x)];},isAttSelected:function S(z,x){return this.isMetricValueSelected(v(z,x));},addAttributeSelection:function f(z,x,AA){if(this._selectionType!==G.ATTS){this.clearSelections();this._selectionType=G.ATTS;}var AB=v.call(this,z,x,AA);K.call(this,AB);return AB[z];},addContextMenuAttributeSelection:function d(AB,AA,AE,AC,x,AD,z){if(this._contextMenuSelectionType!==G.ATTS){this.clearCxtMnuSelection();this._contextMenuSelectionType=G.ATTS;}var AF=v.call(this,AB,AA,AE,AC,x,AD,z);w.call(this,AF);return AF[AB];},removeAttributeSelection:function H(z,x){return m.call(this,v.call(this,z,x));},removeContextMenuAttributeSelection:function U(z,x){return c.call(this,v.call(this,z,x));},addMetricValueSelection:function k(x){if(this._selectionType!==G.METRICS){this.clearSelections();this._selectionType=G.METRICS;}K.call(this,x);},addContextMenuMetricValueSelection:function k(x){if(this._contextMenuSelectionType!==G.METRICS){this.clearCxtMnuSelection();this._contextMenuSelectionType=G.METRICS;}w.call(this,x);},addAttrOrMetricCellSelection:function t(AA,z,x){this._cellSelections.push({parentElementIds:AA,target:{selectionType:x?G.ATTS:G.METRICS,id:z}});},getCellSelections:function g(){var x=this;x.clearCellSelections();var z=function(AB,AA){var AC=[];if(AB){while(AA.hasOwnProperty("_p")){AC.push(AA._p._e.id);AA=AA._p;}}else{var AD=x.model.getCellDataUnion(AA);X.forEach(AD,function(AE){AC.push(AE.eid);});}return AC;};X.forEach(x.highlights,function(AE){var AA=x.getCellForNode(AE),AF=!AA.hasOwnProperty("mix")&&AA._e&&!AA.fi,AD=z(AF,AA);if(AF){var AB=AA._e.id;x.addAttrOrMetricCellSelection(AD,AB,true);}else{var AC=AA._tp._e.oid;x.addAttrOrMetricCellSelection(AD,AC,false);}});return this._cellSelections;},removeMetricValueSelection:function M(x){return m.call(this,x);},removeContextMenuMetricValueSelection:function N(x){return c.call(this,x);},clearSelections:function Z(){if(this._super){this._super();}this._viContextMenuSelections={};this._contextMenuSelectionType=G.EMPTY;this._viSelections={};this._selectionType=G.EMPTY;if(typeof this.clearSelectedGraphicInfo==="function"){this.clearSelectedGraphicInfo();}},clearCxtMnuSelection:function q(){if(this._super){this._super();}this._viContextMenuSelections={};this._contextMenuSelectionType=G.EMPTY;},clearCellSelections:function O(){this._cellSelections=[];},clearSelectionsCache:function P(){F={};},clearUnitSelections:function Z(z){if(this._super){this._super();}var x={};R.forEach(this._viSelections,function(AB,AA){if(R.keyarray(AB)[0]!==z){x[AA]=AB;}});this._viSelections=x;},clearAllSelectionsAndHighlight:function e(){this.clearSelections(true);this.endSelections();},endSelections:function E(){if(mstrApp&&mstrApp.isInVFConfigMode){return ;}F[A(this)]={_selectionType:this.getSelectionType(),_viSelections:this.getSelectionHash()};this.raiseGraphicsSelectedEvent(this);if(this.isInFilterPanel()&&mstrApp&&mstrApp.isDossier){this.raiseGraphicsSelectionChangeEvent();return ;}this.onSelectionChange(this.getSelectionHash());},isInFilterPanel:function D(){var x=this.node&&this.node.defn;return x.iifp;},addSelectionsFromExpression:function u(AA){this.clearSelections();this._selectionType=AA.type;var x=this,z=function(AG){var AH=20,AE=19,AF=function(AI){return AI.nds.length===1?AH:AI.fn;},AD=function(AI){return parseInt(AI.et,10)===5||parseInt(AF(AI),10)===AE;},AB=function(AI){X.forEach(AI.es,function(AJ){x.addAttributeSelection(AI.a.did,AJ.v,AJ.n);});},AC=function(AK){var AJ={},AI=function(AL){X.forEach(AL.es,function(AM){R.copy(v.call(x,AL.a.did,AM.v,AM.n),AJ);});};if(AK.nds){X.forEach(AK.nds,AI);}else{if(AK.es){AI(AK);}}x.addMetricValueSelection(AJ);};if(AD(AG)){AG={nds:[AG]};}X.forEach(AG.nds,function(AI){if(AD(AI)){if(AA.type===G.ATTS){AB(AI);}else{AC(AI);}}else{z(AI);}});};z(AA.data);},raiseGraphicsSelectedEvent:function n(){if(window.mstrApp&&window.mstrApp.isEmbedded){var AE=this,AD=AE.model,AC=AD&&AD.data,AA=AC&&AC.k,x=AC&&AC.gts,AI=x&&x.row,AB=x&&x.col,AF=X.ensureArray(AI).concat(AB||[]),z=function(AK){var AJ;X.forEach(AF,function(AL){if(AL&&AL.id===AK){AJ=AL.n;return false;}});return AJ;},AG=[],AH=this.getSelectionHash();R.forEach(AH,function(AK){var AJ=[];R.forEach(AK,function(AN,AM){var AL=z(AM);X.forEach(AN,function(AO){AJ.push({n:AL,nid:AM,v:AO.n,vid:AO.id});});});AG.push(AJ);});mstrApp.raiseEvent({name:"graphicsSelected",value:{graphics:AG,vizKey:AA}});}},raiseGraphicsSelectionChangeEvent:function Y(){if(mstrApp&&(typeof mstrApp.raiseEvent==="function")){mstrApp.raiseEvent({name:"graphicsSelectionChange",value:{selections:F[A(this)],vizKey:this.k}});}}});mstrmojo.vi.ui.rw._HasVisSelections.VisSelectionType=null;mstrmojo.vi.ui.rw._HasVisSelections.clearAllSelectionsCache=function W(){F={};o={};};}());(function(){mstrmojo.requiresCls("mstrmojo.dom","mstrmojo.hash");var E=mstrmojo.dom,M=mstrmojo.hash,B,I=mstrmojo.global.document,K="mousedown",O="mousemove",Q="mouseup";function G(Y){if(E.isPrimaryMouseBtn(Y)){B.startDragCheck(self,Y);}}var V,P,A="mstrmojo-dnd-avatar",U;function F(Z,Y){if(Y!==undefined&&Y!==null){P.innerHTML=Y;}U.left=Z.x+"px";U.top=Z.y+"px";}function L(Z,Y){if(!V){V=I.createElement("div");U=V.style;V.className=A;V.innerHTML='<div class="'+A+'-inner"></div>';P=V.firstChild;I.body.appendChild(V);}F(Z,Y);U.display="block";}function R(){if(U){U.display="none";}}function H(Y){var Z=++B.ctxt.moveCount;if(Z>=B.minMoves){B.stopDragCheck();if((Y.buttons===1||Y.buttons===undefined||E.isIE9)&&(Y.which===1||Y.button===0||E.isIE8)){B.startDrag(self,Y);}}}function N(Y){if(E.isPrimaryMouseBtn(Y)){B.stopDragCheck();delete B.ctxt;}}function D(Y){B.onDragMove(self,Y);}function C(Y){if(E.isPrimaryMouseBtn(Y)){B.stopDrag(window,Y);}}function J(Z){var Y=E.findWidget(Z);while(Y){if(Y.draggable){return Y;}Y=Y.parent;}return null;}function S(Y){var a=Y.src,Z=J(a.node);if(!Z){return null;}if(Z.getDragAction){Y.action=Z.getDragAction(Y);}a.widget=Z;a.data=Z.getDragData&&Z.getDragData(Y);if(Z.isDragValid){if(!Z.isDragValid(Y)){if(!mstrApp.isInVFInteractMode&&(!Z.shouldDragBubble||Z.shouldDragBubble(Y)===true)){Y.src.node=Z.domNode.parentNode;return S(Y);}return null;}}if(Z.ondragstart){Z.ondragstart(Y);}return Z;}function X(a,Z){var Y=E.findWidget(a),b=Z.tgt&&Z.tgt.widget;while(Y){if(Y.dropZone){if(Y===b){return Y;}if(Y.allowDrop&&Y.allowDrop(Z)){return Y;}}Y=Y.parent;}return null;}function W(){if(this.set){this.set("allowingDrop",false);}}mstrmojo.dnd=mstrmojo.dnd||mstrmojo.provide("mstrmojo.dnd",{minMoves:3,enable:function(){if(!mstrmojo.dndEnabled){E.attachEvent(I,K,G);mstrmojo.dndEnabled=true;}},disable:function(){mstrmojo.dndEnabled=false;E.detachEvent(I,K,G);},startDragCheck:function(Y,Z){delete this.ctxt;var a=E.captureEventInfo({hWin:Y,e:Z});this.ctxt={src:a,moveCount:0,last:M.copy(a.pos),getDirection:function(b){return !!this.dir[b];},getCtxtDragData:function(){var b=this.src;return(b&&b.data)||{};},getCtxtDropData:function(){var b=this.tgt;return(b&&b.data)||{};}};if(this.minMoves){E.attachEvent(I,O,H);E.attachEvent(I,Q,N);}else{this.startDrag(Y,Z);}},stopDragCheck:function(){E.detachEvent(I,O,H);E.detachEvent(I,Q,N);},startDrag:function(Y,b){var Z=this.ctxt;Z.id=mstrmojo.now();var a=S(Z);if(!a){return ;}E.clearBrowserHighlights(Y);E.preventDefault(self,b);E.attachEvent(I,O,D);E.attachEvent(I,Q,C);var d=window.mstrApp;if(d&&d.setInteractive){this._changeAppStatus=d.setInteractive(false);}if(!a.ownAvatar){var c=Z.src;L(c.pos,c.data&&c.data.html);}},stopDrag:function(Y,f){E.detachEvent(I,O,D);E.detachEvent(I,Q,C);var b=this.ctxt,a=b.tgt||{},Z=E.captureEventInfo({hWin:Y,e:f,data:a.data}),d=X(Z.node,b);Z.widget=d;b.tgt=Z;if(d){if(d.ondrop){d.ondrop(b);}else{W.call(d);}}var c=b.src.widget;if(c&&c.ondragend){c.ondragend(b);}if(c&&!c.ownAvatar){R();}if(this._changeAppStatus){window.mstrApp.setInteractive(true);delete this._changeAppStatus;}},onDragMove:function(c,f){if(E.isSafari){E.clearBrowserHighlights();}var Y=this.ctxt,b=Y.tgt||{},Z=b.widget,d=E.captureEventInfo({hWin:c,e:f,data:b.data}),j=d.widget=X(d.node,Y),h=Y.last,a=d.pos;Y.dir={x:a.x>h.x,y:a.y>h.y};Y.last=M.copy(d.pos);Y.tgt=d;if(Z!==j){if(Z){if(Z.ondragleave){Z.ondragleave(Y);}else{W.call(Z);}}if(j){Y.tgt.data=(j.getDropData&&j.getDropData(Y))||{};if(j.ondragenter){j.ondragenter(Y);}else{if(j.set){j.set("allowingDrop",true);}}}}if(j){if(j.ondragover){j.ondragover(Y);}}var g=Y.src.widget;if(g&&g.ondragmove){g.ondragmove(Y);}if(g&&!g.ownAvatar){F(d.pos);}}});B=mstrmojo.dnd;B.enable();}());(function(){mstrmojo.requiresCls("mstrmojo.hash","mstrmojo.array");var C=mstrmojo.hash,E=mstrmojo.array;function D(F){return function(G){F[G]=true;};}mstrmojo.rw.model.UpdateKeysConfig=mstrmojo.declare(null,null,{scriptClass:"mstrmojo.rw.model.UpdateKeysConfig",init:function B(){this.nodes=[];this.selectors={};this.objects={};}});mstrmojo.rw.model.UpdateKeysConfig.getConsolidatedConfig=function A(J){var F={},K={},G={},I={};E.forEach(J,function H(M){var L=M.partialUpdate;if(L){E.forEach(L.nodes,D(K));E.forEach(L.selectors,D(G));E.forEach(L.objects,function(N){if(!I[N.id]||N.flag>I[N.id].flag){I[N.id]=N;}});delete M.partialUpdate;}E.forEach(M.actions,H);});if(!C.isEmpty(K)){F.nodes=C.keyarray(K);}if(!C.isEmpty(G)){F.selectors=C.keyarray(G);}if(!C.isEmpty(I)){F.objects=C.valarray(I);}return F;};}());(function(){mstrmojo.requiresCls("mstrmojo.array","mstrmojo.hash");var C=mstrmojo.array;function A(E){var D=(E&&E.gts&&E.gts.col)||[],G=(E&&E.gts&&E.gts.row)||[];var F=C.filter(D.concat(G),function(H){return H.otp===-1;})[0];return{tpltProp:E.prop,mxProp:C.map((F&&F.es)||[],function(H){var I={};I[H.oid]=mstrmojo.hash.copy(H.prop,{n:H.n,t:H.otp});return I;})};}mstrmojo._IsDocumentTemplate=mstrmojo.provide("mstrmojo._IsDocumentTemplate",{_mixinName:"mstrmojo._IsDocumentTemplate",gridInfo:null,tmsProps:null,update:function B(D){if(D&&D.data){this.gridInfo=D.data.gsi;this.tmsProps=A(D.data);}if(this._super){return this._super(D);}return true;}});}());(function(){mstrmojo.requiresCls("mstrmojo.hash");mstrmojo.all={};var E=mstrmojo.all,G=mstrmojo.hash;var A=0;function D(){var I;while(!I){var H="mstr"+(A++);if(!E[H]){I=H;}}return I;}mstrmojo.registry=mstrmojo.provide("mstrmojo.registry",{add:function F(H){if(!H){return ;}var I=H.id;if(!I){H.id=I=D();}else{if(E[I]){throw new Error("Tried to register 2 objects with same id: "+I);}}E[I]=H;},remove:function C(H){if(H&&H.id){delete E[H.id];}},dumpAll:function(){var H;for(H in E){var I=E[H].id;if(I){mstrmojo.dbg(I+"("+(E[H].scriptClass||"[unknown class]")+")");}}},ref:function B(I,H){H=H||{};if(I){var L=I;while(L){switch(typeof L){case"string":if(H.skipLoadChecks!==true){mstrmojo.requiresCls(L);}L=G.walk(L,window);break;case"function":return(H.dontInst!==true)?new L():L;case"object":if(L.constructor===Object){var K=L.scriptClass;if(K){if(H.skipLoadChecks!==true){mstrmojo.requiresCls(K);}var J=G.walk(K,window);if(J){return new J((H.clone===true)?G.clone(L):L);}return null;}return L;}return L;default:return null;}}}return null;}});mstrmojo.insert=mstrmojo.registry.ref;}());(function(){mstrmojo.requiresCls("mstrmojo.hash");var C=mstrmojo.hash;mstrmojo._CanSupportTransaction={_mixinName:"mstrmojo._CanSupportTransaction",updatedCellsMap:null,getUpdates:mstrmojo.emptyFn,getUpdateObject:mstrmojo.emptyFn,getKeyContext:mstrmojo.emptyFn,autoRefresh:mstrmojo.emptyFn,editNext:mstrmojo.emptyFn,buildConditions:mstrmojo.emptyFn,dataChanged:function A(G,H,F,I,D){var E=this.updateValue(G,F);this.updatedCellsMap[G]={r:H,v:F};this.controller.onTransactionUpdates(this,this.getUpdateObject(),E,D);},postBuildRendering:function B(){if(this._super){this._super();}if(!this.txModel){this.txModel=this.model.docModel||this.model;}this.updatedCellsMap=this.updatedCellsMap||{};},updateValue:function(E,D){if(this.txModel.deltaUpdate){this.txModel.deltaUpdate(this);}return false;},getUpdatedValues:function(){var E=this.updatedCellsMap,F,D,G=[];for(F in E){if(E.hasOwnProperty(F)){D={};D.v=E[F].v.v;G.push(C.copy(this.getKeyContext(F),D));}}return G;},clear:function(){this.updatedCellsMap={};},registerTxWidget:function(){function E(F,H){var G=F.node.data.k;H.txWidgets=H.txWidgets||{};H.txWidgets[G]=F;return false;}var D=this.parent;while(D){if(D.isPanelStack===true){E(this,D);}D=D.parent;}}};}());(function(){mstrmojo.requiresCls("mstrmojo.hash");var C=mstrmojo.hash,A=null;function B(D){return mstrmojo.DICFactory.createDIC(C.copy({dic:this.dic,owner:this.owner,group:this},D));}mstrmojo.DICFactory=mstrmojo.provide("mstrmojo.DICFactory",{createDIC:function(G){var E=G.dic,F=mstrmojo.DICConfig.getDICClass(E),D;if(F){if(G.k===undefined){G.k=G.opener&&G.opener.id;}G.showByDefault=mstrmojo.DICConfig.showDICByDefault(G.dic,G.openerType);G.hasPreview=mstrmojo.DICConfig.hasDICPreview(G.dic,G.openerType);G.canSlice=mstrmojo.DICConfig.canSlice(G.dic,G.openerType);D=new F(G);}return D;},createDICPopup:function(D,E){return mstrmojo.DICPopup.getInstance(D,E);},createDICGroup:function(F){var I=C.copy(F,{scriptClass:"mstrmojo.Widget",widgetsMap:{},dic:null,owner:null,groupMembers:{},postCreate:function(){var L=this.dic,K=this.openerType,J=mstrmojo.DICConfig;this.showByDefault=J.showDICByDefault(L,K);this.hasPreview=J.hasDICPreview(L,K);},addDIC:function D(J,K){this.groupMembers[J]=K;},showPopupDIC:function H(K){if(!this.showByDefault){var J=this.widgetsMap[K],L=this.groupMembers[K];if(!L){return ;}if(!J){J=this.widgetsMap[K]=B.call(this,L);}J.showInPopup();}},render:function G(){if(this.showByDefault||this.hasPreview){var L=this.groupMembers,K=this,J;C.forEach(L,function(N,M){if(!N.hasRendered){K.widgetsMap[M]=J=B.call(K,N);if(K.showByDefault){J.render();}else{if(K.hasPreview&&J.enabled){J.renderPreview();}}N.hasRendered=true;}});}},destroy:function E(){C.forEach(this.widgetsMap,function(J){J.destroy();});this.widgetsMap={};}});return mstrmojo.insert(I);}});}());(function(){mstrmojo.requiresCls("mstrmojo.hash");var A=mstrmojo.hash;mstrmojo.requiresDescs(2213,3326,3327,3329,4531,13283,13284,13285,13286);mstrmojo.ME.Enum={METRIC_ACTIONS:{ADD:"add",EDIT:"edit",EDIT_NEW:"editNew"},EDITOR_IDS:{ADVANCED:"mstrME",FORMULA:"mstrME",WIZARD:"mstrFE",SIMPLE:"mstrSME",SELECOTR:"mstrFSE"},EDITOR_TYPES:{ADVANCED:"ADVANCED",FUNCTION:"FUNCTION",SIMPLE:"SIMPLE",SELECTOR:"SELECTOR"},METRIC_EDIT_TYPES:{ADVANCED:65536,SIMPLE:131072,FUNCTION:196608},METRIC_TYPES:{65536:"ADVANCED",131072:"SIMPLE",196608:"FUNCTION"},NEW_METRIC_DEFINITION:{did:"",n:mstrmojo.desc(2213,"New Metric"),tks:{items:[],vs:0,vm:""},mhfts:{},mvfts:{}},getNewDefinition:function(){return{did:"",n:mstrmojo.desc(2213,"New Metric"),tks:{items:[],vs:0,vm:""},mhfts:{},mvfts:{}};},FBFlag:{Automatic:0,Manual:3},AFB:{Automatic:-1,False:0,True:1},SFB:{Automatic:-1,False:1,True:2},UI_OBJECT_TYPE:{Dimty:-1,Sub_Expression:-2,Level:-4,Condition:-5,Transformation:-6,Row_Count:-7},UI_DATA_TYPE:{Sortby:-1,Breakby:-2,Level:-4,Condition:-5,Transformation:-6},SHORTCUT_FUNCTIONS:{Level:-4,Condition:-5,Transformation:-6,Row_Count:-7},DYNAMIC_DIMTY:{CODES:{auto:{n:mstrmojo.desc(4531,"Automatic"),did:"@auto",t:-1},page:{n:mstrmojo.desc(3329,"Grand Total"),did:"@p",t:-1},byCol:{n:mstrmojo.desc(3326,"By Columns"),did:"@cols",t:-1},byRow:{n:mstrmojo.desc(3327,"By Rows"),did:"@rows",t:-1},byCell:{n:mstrmojo.desc(13283,"By Cell"),did:"@cell",t:-1},byShape:{n:mstrmojo.desc(13284,"By Shape"),did:"@shape",t:-1},downCross:{n:mstrmojo.desc(13285,"Down, Then Across"),did:"@cr",t:-1},crossDown:{n:mstrmojo.desc(13286,"Across, Then Down"),did:"@rc",t:-1}},getItems:function D(G){var F=this.CODES,E=[];switch(G){case"breakby":E=[F.auto,A.copy({n:mstrmojo.desc(2057,"None")},A.copy(F.page)),A.copy({n:mstrmojo.desc(122,"Columns")},A.copy(F.byCol)),A.copy({n:mstrmojo.desc(2968,"Rows")},A.copy(F.byRow)),A.copy({n:mstrmojo.desc(13399,"Cell")},A.copy(F.byCell)),A.copy({n:mstrmojo.desc(2923,"Shape")},A.copy(F.byShape))];break;case"level":E=[F.auto,F.page,F.byCol,F.byRow,F.byCell,F.byShape];break;case"sortby":E=[F.auto,F.downCross,F.crossDown];}return E;},getAutomaticDimtyObject:function C(){return A.copy(this.CODES.auto);},getDimtyObject:function B(E,H){var F=null;var G=false;if(H){A.forEach(mstrmojo.ME.Enum.DYNAMIC_DIMTY.CODES,function(I){if(I.did===E){F=A.copy(I);G=true;return false;}});}if(!G){F={n:E,t:-1,dimty:true};}return F;}},NonExposableParams:["IsNewOLAP","OLAPPattern","OLAPHasWindow"]};mstrmojo.ME.Enum.DEFAULT_MPS={mps:{afb:mstrmojo.ME.Enum.AFB.False,sfb:mstrmojo.ME.Enum.SFB.False,fbf:mstrmojo.ME.Enum.FBFlag.Automatic}};}());(function(){mstrmojo.requiresCls("mstrmojo.hash");mstrmojo.mstr.ElementDataService=mstrmojo.provide("mstrmojo.mstr.ElementDataService",{getElements:function A(C,D){var B=mstrmojo.hash.copy(C,{});B.taskId=B.taskId||"browseElements";mstrApp.serverRequest(B,D,{showWait:true,hideWait:true,delay:true,silent:B.silent});}});}());(function(){mstrmojo.requiresCls("mstrmojo.hash");var E=mstrmojo.hash;var B=function(G){return(mstrmojo.now()-G.getTime());};mstrmojo.storage.DOMStorage=mstrmojo.declare(null,null,{scriptClass:"mstrmojo.storage.DOMStorage",mIsSupported:false,mStorageObj:null,itemTimeToLive:3600,init:function F(G){E.copy(G,this);return this;},isSupported:function C(){return this.mIsSupported;},checkVersion:function A(G){var H=this.getItem("__version__");if(H&&H<G){mstrmojo.dbg("DOMStorage data is old - clearing, v="+H);this.clear();}this.setItem("__version__",G,-1);return this;},length:function(){return(this.mIsSupported?this.mStorageObj.length:0);},_keyExpired:function D(G){return(G&&(G.ts>0)&&(mstrmojo.now()>G.ts));},key:function(G){return(this.mIsSupported?this.mStorageObj.key(G):null);},getItemAsString:function(H){var G=this.getItem(H);if(G){if(typeof G=="object"){G=JSON.stringify(G);}else{G=G+"";}}return G;},getItem:function(H){var G=null;if(this.mIsSupported){var J=this.mStorageObj.getItem(H);if(J){try{J=JSON.parse(J);}catch(I){}if(this._keyExpired(J)){this.removeItem(H);}else{G=J.data;}}}return G;},setItem:function(H,J,G){G=G||this.itemTimeToLive;try{if(this.mIsSupported){this.mStorageObj.removeItem(H);var L=(G>0)?(mstrmojo.now()+(G*1000)):-1;var I={ts:L,data:J};this.mStorageObj.setItem(H,JSON.stringify(I));}}catch(K){if(K!==QUOTA_EXCEEDED_ERR){throw K;}}finally{}return this;},removeItem:function(G){if(this.mIsSupported){this.mStorageObj.removeItem(G);}return this;},clear:function(){if(this.mIsSupported){this.mStorageObj.clear();}return this;}});})();(function(){mstrmojo.requiresCls("mstrmojo.array","mstrmojo.hash");var D=mstrmojo.array,B=mstrmojo.hash;mstrmojo.vi.ui.rw._IsPanelStack=mstrmojo.provide("mstrmojo.vi.ui.rw._IsPanelStack",{_mixinName:"mstrmojo.vi.ui.rw._IsPanelStack",getFormats:function A(){return{};},selectPanel:function C(H,I,G,K,J){var E=false,F=this.selectedKey;if(!K){K=this.model.getDataService().newUpdateWithoutCmd({callback:J});E=true;}this.selectPanelDeferred(K,H,I,G);this.model.getDataService().addSuppressData(K.extras);D.forEach(this.children,function(L){if(L.visible&&L.hasRendered&&L.children&&L.children.length===0){L.refresh();}});if(!G&&K.actions&&K.actions.length>0){if(E){this.controller.cmdMgr.execute({execute:function(){var L=this.urInfo,M=function(){L.extras.params.suppressData=false;}.bind(this);L=B.copy({undo:function(){L.puKeys=[F];M();},redo:function(){L.puKeys=[H];M();},},L);K.cmd=this;K.submit();},urInfo:{extras:{style:{params:{treesToRender:3}},params:{suppressData:true}}},isUntracked:mstrApp.isAppStateSelection()});}else{K.submit();}}}});}());(function(){mstrmojo.requiresCls("mstrmojo.dom","mstrmojo.hash","mstrmojo.array");var D=mstrmojo.dom,G=mstrmojo.array;function F(P){var O=this.model,N=O.data.gts,Q=O.getCellTitleInfo(P).title,S=[],M=[],L=[];function R(U){L.push(U);(U.ch||[]).forEach(function(V){R(V);});}if(N){S=G.filterOne(N.row.concat(N.col),function(U){return U.id===Q.id;}).es;S.forEach(function(U){delete U.ch;});S.forEach(function(W,U,X){var V=X[W.p_index];if(O.compareElementsId(W.id,P._e.id)){M.push(W);}if(V){if(V.ch){V.ch.push(W);}else{V.ch=[W];}}});M.forEach(function(U){R(U);});}return L;}mstrmojo.vi.ui.rw._XtabRA=mstrmojo.provide("mstrmojo.vi.ui.rw._XtabRA",{_mixinName:"mstrmojo.vi.ui.rw._XtabRA",_highlightTimer:null,highlightRAcells:function J(M,L){var N=this;if(this.allowRAcellsHighlight()){return ;}this.resetRAcellsHighlight();this.highlightGroupCells(this.getRACellGroups(M));if(L){this._highlightTimer=window.setTimeout(function(){N.clearGroupHighlights();},1000);}},resetRAcellsHighlight:function I(){if(this.allowRAcellsHighlight()){return ;}if(this._highlightTimer){window.clearTimeout(this._highlightTimer);this._highlightTimer=null;}this.clearHighlights();},allowRAcellsHighlight:function H(){return D.isIE||D.isIEW3C;},onclick:function K(N){var S=N.getTarget&&N.getTarget();if(S&&S.hasAttribute("rabtn")){var Q=this,O=this.model,M=S&&D.findAncestorByName(S,"td",true,this.viewport),P=this.getCellForNode(M);this.highlightRAcells(P);var R=O.getRAExpandAction(P,this.sid),L={success:function(){Q.highlightRAcells(P,true);}};if(this.isCustomSort){this.delegateToActionMgr(R,this.getCallbackForRACollapseExpand(P));}else{this.controller.submitTemplateUpdates(this,R,L,null,null,true);}}else{this._super(N);}},raExpandAll:function C(M,N){var L=this.model.getRAExpandAllAction(M.id,N);if(this.isCustomSort){this.delegateToActionMgr(L);}else{this.controller.submitTemplateUpdates(this,L,null,null,null,true);}},raExpandDescendants:function A(M){var L=this.model.getRAExpandAction(M,this.sid,true);if(this.isCustomSort){this.delegateToActionMgr(L,null,null,{needDataReady:true});}else{this.controller.submitTemplateUpdates(this,L,null,null,null,true);}},getRACellGroups:function B(O){var N=this.model,Q=N.getCellTitleInfo(O).title,P=[],L=[],M=F.call(this,O);G.forEach(this.interactiveCellsArray,function(R){var U=R._e&&R._e.id,S=U&&!R.hasOwnProperty("mix")&&R.fi===undefined;if(S&&N.getCellTitleInfo(R).title.id===Q.id){if(N.compareElementsId(U,O._e.id)||G.find(M,"id",U)===-1){if(P.length>0){L.push(P);P=[];}}if(G.find(M,"id",U)>-1){P.push(R);}}});if(P.length>0){L.push(P);}return L;},getAncestors:function E(N,U){var R=this,U=U||G.map(R.selCells,function(W){return R.getCellForNode(W);}),L=this.model.data.gts,S=G.filterOne(L.row.concat(L.col),function(W){return W.id===N;}).es,V=[],M=U[0]&&U[0].lv||0,Q,P,O=0;U.forEach(function(W,X){Q=W.idx;while(Q>=0){if(X>0){P=V.indexOf(Q);if(P>=0){O=Math.max(O,P);break;}}else{V.push(Q);}Q=S[Q].p_index;}});return G.map(G.get(S,V.slice(O)),function(X,W){var Y=X.id.substring(1).split(";");return{id:Y[1]+":"+Y[0],n:X.n,level:M-O-W};});}});}());(function(){mstrmojo.requiresCls("mstrmojo.array","mstrmojo.hash");var O=/\{\@(en@)?([^\}]+)\}/gm,K=/\</gm,S=/\>/gm,F=/\S/,R=["$","^","=","!",":","/",".","*","+","?","|","(",")","[","]","{","}","\\"],G=new RegExp("(\\"+R.join("|\\")+")","g"),U={"&":{k:"&(?!#?\\w+;)",v:"&amp;"},"<":"&lt;",">":"&gt;","\u0009":"&#x09;","\n":"&#x0A;","\r":"&#x0D;",'"':"&quot;"},X={"&amp;":"&","&lt;":"<","&gt;":">","&#x09;":"\u0009","&#x0A;":"\n","&#x0D;":"\r","&quot;":'"'},D={"&":{k:"&(?!#?\\w+;)",v:"&amp;"},"<":"&lt;",">":"&gt;"," ":"&nbsp;","\n":"<br/>","\r":"&nbsp;&nbsp;&nbsp;&nbsp;","'":"&#39;",'"':"&#34;"},N={"&amp;":"&","&lt;":"<","&gt;":">","&nbsp;":" ","<br/>":"\n","&nbsp;&nbsp;&nbsp;&nbsp;":"\r","&#39;":"'","&#34;":'"'},E={"&":"&amp;","<":"&lt;",">":"&gt;","'":"&#39;",'"':"&#34;","\u20ac":"&#8364;"},L={"&amp;":"&","&lt;":"<","&gt;":">","&#39;":"'","&#34;":'"',"&#8364;":"\u20ac"};var M=function(Y){if(Y===null){return"null";}var Z=typeof Y;if(Z!=="object"){return Z;}if(Y.length===undefined){return"object";}return"array";};var V={strictMode:false,key:["source","protocol","authority","userInfo","user","password","host","port","relative","path","directory","file","query","anchor"],q:{name:"queryKey",parser:/(?:^|&)([^&=]*)=?([^&]*)/g},parser:{strict:/^(?:([^:\/?#]+):)?(?:\/\/((?:(([^:@]*)(?::([^:@]*))?)?@)?([^:\/?#]*)(?::(\d*))?))?((((?:[^?#\/]*\/)*)([^?#]*))(?:\?([^#]*))?(?:#(.*))?)/,loose:/^(?:(?![^:@]+:[^:@\/]*@)([^:\/?#.]+):)?(?:\/\/)?((?:(([^:@]*)(?::([^:@]*))?)?@)?([^:\/?#]*)(?::(\d*))?)(((\/(?:[^?#](?![^?#\/]*\.[^?#\/.]+(?:[?#]|$)))*\/?)?([^?#\/]*))(?:\?([^#]*))?(?:#(.*))?)/}};mstrmojo.string=mstrmojo.provide("mstrmojo.string",{multiReplace:function H(Z,c,b){var Y;b=b||[];if(!Z){return"";}var a=[];for(Y in c){if(mstrmojo.array.indexOf(b,Y)===-1){a.push(Y.k||Y);}}return Z.replace(new RegExp(a.join("|"),"g"),function(d){var e=c[d];return e.v||e;});},trim:function Q(Y){return(Y&&Y.replace)?Y.replace(/^\s+/,"").replace(/\s+$/,""):Y;},startsWith:function W(Z,Y){return Z.length>=Y.length&&Z.substring(0,Y.length)==Y;},ellipsize:function A(a,Z){var Y=this.trim(a.substr(0,(Z||1)-1));if(Y!==a){Y+="&hellip;";}return Y;},isEmpty:function J(Y){return(Y===null)||(Y===undefined)||!(F.test(Y));},regEscape:function P(Y){return Y.replace(G,"\\$1");},escapeIllegalXML:function C(Y){if(!Y||!Y.replace){return Y;}var Z=/\u001a/gm,a="";return Y.replace(Z,a);},encodeXMLAttribute:function(Y){return mstrmojo.string.multiReplace(Y,U);},decodeXMLAttribute:function(Y){return mstrmojo.string.multiReplace(Y,X);},encodeHtmlString:function(Z,Y,a){if(!Z||!Z.replace){return Z;}if(a){return mstrmojo.string.multiReplace(Z,E);}return mstrmojo.string.multiReplace(Z,D,Y?[" "]:[]);},decodeHtmlString:function(Z,Y){return Y?mstrmojo.string.multiReplace(Z,L):mstrmojo.string.multiReplace(Z,N);},htmlAngles:function(Y){if(!mstrmojo.string.isEmpty(Y)){Y=String(Y);return Y.replace(K,"&lt;").replace(S,"&gt;");}return Y;},apply:function I(Y,a){if(!Y){return"";}var Z=this;return Y.replace(O,function b(e,f,g){var c;try{c=mstrmojo.hash.walk(g,a);}catch(d){}c=(c===null||c===undefined)?"":c;return(!!f)?Z.encodeHtmlString(c,true):c;});},json2xml:function(Y,o,p){if(!(o instanceof Array)){o=[o];}var Z=p&&p.isSerializable,m=(p.convertBoolean!==false),r=p&&p.skipFunctions,l,e;var g=[],c=[],f,b,d;for(l=0,e=o.length;l<e;l++){var k=o[l];for(f in k){if(r&&typeof k[f]==="function"){continue;}if(Z){var q=Z(f,o,l);if(q!==true){if(q===false){continue;}else{if(q.att){g.push(q.att);}if(q.child){c.push(q.child);}continue;}}}b=k[f];d=M(b);switch(d){case"array":var h,j;c.push("<"+f+">");for(h=0,j=b.length;h<j;h++){var a=p.getArrItemName(f,b,h)||h;c.push(this.json2xml(a,b[h],p));}c.push("</"+f+">");break;case"object":c.push(this.json2xml(f,b,p));break;case"string":g.push(f+'="'+mstrmojo.string.encodeXMLAttribute(b)+'"');break;case"boolean":g.push(f+'="'+(m?(b?"-1":"0"):b)+'"');break;case"null":if(!p.skipNull){g.push(f+'="'+p.nullValue+'"');}break;default:g.push(f+'="'+b+'"');break;}}}return"<"+Y+" "+g.join(" ")+">"+c.join("")+"</"+Y+">";},escape4HTMLText:function B(f){if(!f||!f.replace){return f;}var c=/"/gm;var a="&quot;";var g=/&/gm;var e="&amp;";var d=/</gm;var Y="&lt;";var b=/>/gm;var Z="&gt;";return f.replace(g,e).replace(c,a).replace(d,Y).replace(b,Z);},parseUri:function(c,Z){Z=Z||V;var Y=Z.parser[((Z.strictMode)?"strict":"loose")].exec(c),b={},a=14;while(a--){b[Z.key[a]]=Y[a]||"";}b[Z.q.name]={};b[Z.key[12]].replace(Z.q.parser,function(e,d,f){if(d){b[Z.q.name][d]=f;}});return b;},removeSpecialChars:function(Y){return Y.replace(/[^a-zA-Z0-9]/g,"");}});})();(function(){mstrmojo.requiresCls("mstrmojo.array","mstrmojo.hash");var K=mstrmojo.array,D=mstrmojo.hash;function E(W,U){var X=[],Q=W.selectedIndices,P=W.allIdx;var R,S,V=W.items;if(W.multiSelect&&(P>-1)&&(K.indexOf(U,W.allIdx)>-1)){for(R=0,S=V.length;R<S;R++){if(!Q[R]){X.push(R);Q[R]=true;W.selectedIndex=R;W.selectedItem=V[R];}}}else{for(R=0,S=U.length;R<S;R++){var Y=U[R];if(!Q[Y]){Q[Y]=true;X.push(Y);W.selectedIndex=Y;W.selectedItem=V[Y];}}}return X;}function J(R){var Q=[],S=R.selectedIndices,P;for(P in S){delete S[P];Q.push(parseInt(P,10));}R.selectedIndex=-1;R.selectedItem=null;return Q;}function H(W,V){var S=[],Q=W.selectedIndices,Y=K.indexOf,P=W.allIdx;if(W.multiSelect&&(P>-1)&&(Y(V,P)>-1)){return J(W);}if(V.length>0&&Q[P]){if(Y(V,P)<0){V.push(P);}}var U=V.length,R;for(R=0;R<U;R++){var X=V[R];if(Q[X]){delete Q[X];S.push(X);if(W.selectedIndex===X){W.selectedIndex=-1;W.selectedItem=null;}}}return S;}function A(S,R){var P=S.selectedIndices;if(!P){P={};S.selectedIndices=P;}if(!R){R={};}var V=S.selectedIndex,U=[],W,Q;for(Q in P){if(!R[Q]){W=parseInt(Q,10);delete P[Q];U.push(W);if(V===W){S.selectedIndex=-1;S.selectedItem=null;}}}var Y=[],X=S.items;for(Q in R){if(!P[Q]){W=parseInt(Q,10);P[Q]=true;Y.push(W);S.selectedIndex=W;S.selectedItem=X&&X[W];}}return{add:Y,rmv:U};}function G(Q,P,R){if(Q.raiseEvent&&((P&&P.length)||(R&&R.length))){Q.raiseEvent({name:"change",added:P,removed:R});}}mstrmojo._ListBase2Selections=mstrmojo.provide("mstrmojo._ListBase2Selections",{multiSelect:false,selectedIndices:null,selectedIndex:-1,selectedItem:null,selectedIndices_bindEvents:"change",selectedIndex_bindEvents:"change",selectedItem_bindEvents:"change",allowUnlistedValues:true,insertUnlistedValuesAt:-1,allIdx:-1,singleSelect:function F(P,Q){if(!this.selectedIndices[P]||(this.selectionPolicy==="reselect")||(P!==this.allIdx&&this.selectedIndices[this.allIdx])){var R=J(this),S=E(this,[P]);if(Q!==true){G(this,S,R);}}},toggleSelect:function O(P,Q){var S,R;if(this.selectedIndices[P]){R=H(this,[P]);}else{S=E(this,[P]);}if(Q!==true){G(this,S,R);}},rangeSelect:function N(P,Q){this.singleSelect(P,Q);},clearSelect:function I(P){var Q=J(this);if(P!==true){G(this,null,Q);}},select:function L(R,P){var Q=A(this,K.hash(R));if((P!==true)&&(Q.add.length||Q.rmv.length)){G(this,Q.add,Q.rmv);}},addSelect:function B(R,P){if(R===null||R===undefined){return null;}if(R.constructor!==Array){R=[R];}var Q=E(this,R);if(P!==true){G(this,Q,null);}return Q;},removeSelect:function M(R,P){if(R===null||R===undefined){return null;}if(R.constructor!==Array){R=[R];}var Q=H(this,R);if(P!==true){G(this,null,Q);}return Q;},_set_selectedIndices:function(S,Q,P){if(this.selectedIndices===Q){return false;}var R=A(this,Q);if(R.add.length||R.rmv.length){if(P!==true){G(this,R.add,R.rmv);}}return false;},_set_selectedIndex:function(S,Q,P){var R={};if(Q>-1){R[Q]=true;}return this._set_selectedIndices(null,R,P);},_set_selectedItem:function(X,U,S){var R=U&&(typeof U==="object"),W=this.itemIdField,Q=-1,V=this.items;if(R&&W!=null){Q=K.find(V,W,U[W]);}else{if(U!=null){Q=K.indexOf(V,U);}}if((Q===-1)&&(U!=null)&&this.allowUnlistedValues){var P=this.insertUnlistedValuesAt;if(P==null||P<0){P=(V&&V.length)||0;}Q=P;this.add([U],Q);}return this._set_selectedIndex(null,Q,S);},initSelections:function C(U,Q,P,S,R){if(!this.selectedIndices){this.selectedIndices={};this.selectedIndex=-1;}if(U){this._set_selectedIndices(null,U,R);}else{if(Q){this.select(Q,R);}else{if(S){this._set_selectedItem(null,S,R);}else{if(P!==null&&P!==undefined){this._set_selectedIndex(null,P,R);}}}}},sortSelectedIndices:function(){return D.keyarray(this.selectedIndices,true).sort(K.numSorter);},removeSelectedItems:function(){var R=this.sortSelectedIndices(),P=R.length,S=R[P-1],Q=this.remove(R);S=Math.min(S+1-P,this.items.length-1);if(S>=0){this.singleSelect(S);}return Q;},getSelectedItems:function(){return K.get(this.items,this.sortSelectedIndices())||[];},setSelectedItems:function(Q,e){if(!Q||!Q.length){return ;}var S=this.items||[],u=this.itemIdField!=null?K.findMulti(S,this.itemIdField,Q):K.indexOfMulti(S,Q),W=Q.length,U=W-u.count,r=this.allowUnlistedValues,d=this.insertUnlistedValuesAt,Y=(r&&(d>-1))?U:0;if(d<0){d=S.length;}var R=[],V=[],g=u.map;if(U&&r){var q=0,f;for(f=0;f<W;f++){if(g[f]==null){R.push(Q[f]);V.push(d+q++);}}this.add(R,d);}var X=[],l;for(l in g){var p=g[l];if(p>=d){p+=Y;}X.push(p);}var t=X.concat(V),Z=this.addSelect(t,!e);if(!e){var a=K.hash(Z),h=this.selectedIndices,b=[],o;for(o in h){if(!a[o]){b.push(parseInt(o,10));}}var P=this.removeSelect(b,true);G(this,Z,P);}}});}());(function(){mstrmojo.requiresCls("mstrmojo.hash");mstrmojo.requiresDescs(521,522,523,524,525,526,529,530,534,535,546,547,587,686,687,688,696,746,1101,1102,1956,1957,1958,1959,1960,1961,1962,1963,1964,1965,1966,1967,2171,2202,2203,2204,2219,2220,2784,2785,2786,2795,2796,3086,3344,3852,3853,3854,3855,3856,3857,3858,3859,3860,3861,3862,3863,3945,3946,4406,4407,5282,5283,5924,5925,6076,6077,6078,6079,6080,6081,6082,7899,7900,7901,7902,7903,9379,9380,9381,9382,9383,9384,9385,12298,13889,13890,13896,13897);mstrmojo.locales=mstrmojo.provide("mstrmojo.locales",{load:function(C){var A=this;if(this.isLoaded){C();C=null;}else{var B={taskId:"getLocaleInfo"};if(mstrConfig&&mstrConfig.isAddSessionState&&mstrApp&&mstrApp.sessionState){B.sessionState=mstrApp.sessionState;}mstrmojo.xhr.request("POST",mstrConfig.taskURL,{success:function(D){A.update(D);C();C=null;if(mstrmojo.expr){mstrmojo.expr.onLocaleUpdated();}mstrmojo.locales.isLoaded=true;},failure:function(D){alert(D.getResponseHeader("X-MSTR-TaskFailureMsg"));}},B);}},update:function(A){if(A){mstrmojo.hash.copy(mstrmojo.hash.obj2array(A),this);}},isLoaded:false,datetime:{MONTHNAME_SHORT:[mstrmojo.desc(3852,"Jan"),mstrmojo.desc(3853,"Feb"),mstrmojo.desc(3854,"Mar"),mstrmojo.desc(3855,"Apr"),mstrmojo.desc(3856,"May"),mstrmojo.desc(3857,"Jun"),mstrmojo.desc(3858,"Jul"),mstrmojo.desc(3859,"Aug"),mstrmojo.desc(3860,"Sep"),mstrmojo.desc(3861,"Oct"),mstrmojo.desc(3862,"Nov"),mstrmojo.desc(3863,"Dec")],MONTHNAME_FULL:[mstrmojo.desc(1956,"January"),mstrmojo.desc(1957,"February"),mstrmojo.desc(1958,"March"),mstrmojo.desc(1959,"April"),mstrmojo.desc(1960,"May"),mstrmojo.desc(1961,"June"),mstrmojo.desc(1962,"July"),mstrmojo.desc(1963,"August"),mstrmojo.desc(1964,"September"),mstrmojo.desc(1965,"October"),mstrmojo.desc(1966,"November"),mstrmojo.desc(1967,"December")],dayShortNames:["S","M","T","W","T","F","S"],dayNames:[mstrmojo.desc(9379,"Sunday"),mstrmojo.desc(9380,"Monday"),mstrmojo.desc(9381,"Tuesday"),mstrmojo.desc(9382,"Wednesday"),mstrmojo.desc(9383,"Thursday"),mstrmojo.desc(9384,"Friday"),mstrmojo.desc(9385,"Saturday")],DATEINPUTFORMATS:["M/d/yy","M/d/yyyy","MMM d, yy"],TIMEINPUTFORMATS:["h:mm a","H:mm","h:mm:ss a","H:mm:ss","h:mm:ss a z"],DATEOUTPUTFORMAT:"M/d/yyyy",TIMEOUTPUTFORMAT:"h:mm:ss a",DATEDISPLAYFORMAT:"M/d/yy",TIMEDISPLAYFORMAT:"h:mm:ss",AM_NAME:"AM",PM_NAME:"PM",TWODIGITYEARSTART:"2029"},number:{NUMBERINPUTFORMATS:{"0":"#,##0.###"},INTEGERINPUTFORMATS:{"0":"#,##0"},NUMBEROUTPUTFORMAT:"#0.##########",INTEGEROUTPUTFORMAT:"#0",DECIMALSEPARATOR:".",THOUSANDSEPARATOR:","},expression:{METRICVALIDATIONLEVEL:"0",PRESERVEWHITESPACE:false,Include:[{did:"1",n:mstrmojo.desc(3945,"Include")},{did:"2",n:mstrmojo.desc(3946,"Exclude")}],BranchQual:[{did:"19",n:mstrmojo.desc(5282,"AND")},{did:"20",n:mstrmojo.desc(5283,"OR")},{did:"21",n:mstrmojo.desc(12298,"NOT")},{did:"19_21",n:mstrmojo.desc(5924,"AND NOT")},{did:"20_21",n:mstrmojo.desc(5925,"OR NOT")}],RootOperator:[{did:"19",n:mstrmojo.desc(534,"All selections")},{did:"20",n:mstrmojo.desc(535,"Any selection")}],ExprType:[{did:"2",n:mstrmojo.desc(546,"Qualify")},{did:"5",n:mstrmojo.desc(547,"Select")}],DimtyLevels:[{did:"1",n:mstrmojo.desc(2171,"Default")},{did:"2",n:mstrmojo.desc(3086,"Metric")},{did:"3",n:mstrmojo.desc(3344,"Report")}],Attribute:[{did:"1,6",n:mstrmojo.desc(2795,"Equals"),t:1,tp:1},{did:"1,7",n:mstrmojo.desc(2796,"Does not equal"),t:1,tp:1},{did:"1,8",n:mstrmojo.desc(521,"Greater than"),t:1,tp:1},{did:"1,10",n:mstrmojo.desc(522,"Greater than or equal to"),t:1,tp:1},{did:"1,9",n:mstrmojo.desc(523,"Less than"),t:1,tp:1},{did:"1,11",n:mstrmojo.desc(524,"Less than or equal to"),t:1,tp:1},{did:"1,17",n:mstrmojo.desc(696,"Between"),t:1,tp:1},{did:"1,44",n:mstrmojo.desc(746,"Not between"),t:1,tp:1},{did:"1,76",n:mstrmojo.desc(686,"Contains"),t:1,tp:1},{did:"1,79",n:mstrmojo.desc(2784,"Does not contain"),t:1,tp:1},{did:"1,77",n:mstrmojo.desc(687,"Begins with"),t:1,tp:1},{did:"1,80",n:mstrmojo.desc(2785,"Does not begin with"),t:1,tp:1},{did:"1,78",n:mstrmojo.desc(688,"Ends with"),t:1,tp:1},{did:"1,81",n:mstrmojo.desc(2786,"Does not end with"),t:1,tp:1},{did:"1,18",n:mstrmojo.desc(525,"Like"),t:1,tp:1},{did:"1,43",n:mstrmojo.desc(526,"Not Like"),t:1,tp:1},{did:"1,54",n:mstrmojo.desc(2202,"Is Null"),t:1,tp:1},{did:"1,55",n:mstrmojo.desc(2203,"Is Not Null"),t:1,tp:1},{did:"1,22",n:mstrmojo.desc(587,"In"),t:1,tp:1},{did:"1,57",n:mstrmojo.desc(2204,"Not In"),t:1,tp:1}],Metric:[{did:"1,6",n:mstrmojo.desc(2795,"Equals"),t:1,tp:1},{did:"1,7",n:mstrmojo.desc(2796,"Does not equal"),t:1,tp:1},{did:"1,8",n:mstrmojo.desc(521,"Greater than"),t:1,tp:1},{did:"1,10",n:mstrmojo.desc(522,"Greater than or equal to"),t:1,tp:1},{did:"1,9",n:mstrmojo.desc(523,"Less than"),t:1,tp:1},{did:"1,11",n:mstrmojo.desc(524,"Less than or equal to"),t:1,tp:1},{did:"1,17",n:mstrmojo.desc(696,"Between"),t:1,tp:1},{did:"1,44",n:mstrmojo.desc(746,"Not between"),t:1,tp:1},{did:"1,54",n:mstrmojo.desc(2202,"Is Null"),t:1,tp:1},{did:"1,55",n:mstrmojo.desc(2203,"Is Not Null"),t:1,tp:1},{did:"1,22",n:mstrmojo.desc(587,"In"),t:1,tp:1},{did:"1,57",n:mstrmojo.desc(2204,"Not In"),t:1,tp:1},{did:"2,1",n:mstrmojo.desc(529,"Highest"),t:2,tp:2},{did:"2,2",n:mstrmojo.desc(530,"Lowest"),t:2,tp:2},{did:"3,1",n:mstrmojo.desc(4407,"Highest %"),t:3,tp:3},{did:"3,2",n:mstrmojo.desc(4406,"Lowest %"),t:3,tp:3}],MetricRP:[{did:"2,13",n:mstrmojo.desc(13897,"Rank between highest"),t:2,tp:2},{did:"2,4",n:mstrmojo.desc(1101,"Exclude highest"),t:2,tp:2},{did:"2,3",n:mstrmojo.desc(13896,"Rank between lowest"),t:2,tp:2},{did:"2,5",n:mstrmojo.desc(1102,"Exclude lowest"),t:2,tp:2},{did:"3,13",n:mstrmojo.desc(13890,"Between highest")+"%",t:3,tp:3},{did:"3,4",n:mstrmojo.desc(1101,"Exclude highest")+"%",t:3,tp:3},{did:"3,3",n:mstrmojo.desc(13889,"Between lowest")+"%",t:3,tp:3},{did:"3,5",n:mstrmojo.desc(1102,"Exclude lowest")+"%",t:3,tp:3}],MDXAttribute:[{did:"1,6",n:mstrmojo.desc(2795,"Equals"),t:1,tp:1},{did:"1,7",n:mstrmojo.desc(2796,"Does not equal"),t:1,tp:1},{did:"1,8",n:mstrmojo.desc(521,"Greater than"),t:1,tp:1},{did:"1,10",n:mstrmojo.desc(522,"Greater than or equal to"),t:1,tp:1},{did:"1,9",n:mstrmojo.desc(523,"Less than"),t:1,tp:1},{did:"1,11",n:mstrmojo.desc(524,"Less than or equal to"),t:1,tp:1},{did:"1,17",n:mstrmojo.desc(696,"Between"),t:1,tp:1},{did:"1,44",n:mstrmojo.desc(746,"Not between"),t:1,tp:1},{did:"1,22",n:mstrmojo.desc(587,"In"),t:1,tp:1},{did:"1,57",n:mstrmojo.desc(2204,"Not In"),t:1,tp:1}],MDXMetric:[{did:"1,6",n:mstrmojo.desc(2795,"Equals"),t:1,tp:1},{did:"1,7",n:mstrmojo.desc(2796,"Does not equal"),t:1,tp:1},{did:"1,8",n:mstrmojo.desc(521,"Greater than"),t:1,tp:1},{did:"1,10",n:mstrmojo.desc(522,"Greater than or equal to"),t:1,tp:1},{did:"1,9",n:mstrmojo.desc(523,"Less than"),t:1,tp:1},{did:"1,11",n:mstrmojo.desc(524,"Less than or equal to"),t:1,tp:1},{did:"1,17",n:mstrmojo.desc(696,"Between"),t:1,tp:1}],SAPAttribute:[{did:"1,6",n:mstrmojo.desc(2795,"Equals"),t:1,tp:1},{did:"1,7",n:mstrmojo.desc(2796,"Does not equal"),t:1,tp:1},{did:"1,22",n:mstrmojo.desc(587,"In"),t:1,tp:1},{did:"1,57",n:mstrmojo.desc(2204,"Not In"),t:1,tp:1},{did:"1,8",n:mstrmojo.desc(521,"Greater than"),t:1,tp:1},{did:"1,10",n:mstrmojo.desc(522,"Greater than or equal to"),t:1,tp:1},{did:"1,9",n:mstrmojo.desc(523,"Less than"),t:1,tp:1},{did:"1,11",n:mstrmojo.desc(524,"Less than or equal to"),t:1,tp:1},{did:"1,17",n:mstrmojo.desc(696,"Between"),t:1,tp:1}],Element:[{did:"1,22",n:mstrmojo.desc(2219,"In List"),t:1,tp:1},{did:"1,57",n:mstrmojo.desc(2220,"Not In List"),t:1,tp:1}]},validation:{requiredFieldError:mstrmojo.desc(6078,"This field is required."),invalidCharError:mstrmojo.desc(7899,"This field contains invalid characters for #."),invalidDateStringError:mstrmojo.desc(7900,"This field contains invalid date/time string."),invalidNumericFormatError:mstrmojo.desc(7901,"This field contains numeric value with incorrect format."),outofRangeError:mstrmojo.desc(6079,"This field should be # between ## and ###."),noLessMinError:mstrmojo.desc(6081,"This field should be # greater than or equal to ##."),noGreaterMaxError:mstrmojo.desc(6080,"This field should be # less than or equal to ###."),failRegexTestError:mstrmojo.desc(6082,"This field failed regular expression validation."),invalidValueInListError:mstrmojo.desc(7902,"One of the value (#) in this list is not valid."),integerDataType:mstrmojo.desc(6076,"an Integer value"),numericDataType:mstrmojo.desc(6077,"a Number value"),dateDataType:mstrmojo.desc(7903,"a Date/Time value")},color:{colors:[{n:"Black",v:"#000000"},{n:"Brown",v:"#993300"},{n:"Olive Green",v:"#333300"},{n:"Dark Green",v:"#003300"},{n:"Dark Teal",v:"#003366"},{n:"Dark Blue",v:"#000080"},{n:"Indigo",v:"#333399"},{n:"Grey-80%",v:"#333333"},{n:"Dark Red",v:"#800000"},{n:"Orange",v:"#FF6600"},{n:"Dark Yellow",v:"#808000"},{n:"Green",v:"#008000"},{n:"Teal",v:"#008080"},{n:"Blue",v:"#0000FF"},{n:"Blue-Grey",v:"#666699"},{n:"Grey-50%",v:"#808080"},{n:"Red",v:"#FF0000"},{n:"Light Orange",v:"#FF9900"},{n:"Lime",v:"#99CC00"},{n:"Sea Green",v:"#339966"},{n:"Aqua",v:"#33CCCC"},{n:"Light Blue",v:"#3366FF"},{n:"Violet",v:"#800080"},{n:"Grey-40%",v:"#969696"},{n:"Pink",v:"#FF00FF"},{n:"Gold",v:"#FFCC00"},{n:"Yellow",v:"#FFFF00"},{n:"Bright Green",v:"#00FF00"},{n:"Turquoise",v:"#00FFFF"},{n:"Sky Blue",v:"#00CCFF"},{n:"Plum",v:"#993366"},{n:"Grey-25%",v:"#C0C0C0"},{n:"Rose",v:"#FF99CC"},{n:"Tan",v:"#FFCC99"},{n:"Light Yellow",v:"#FFFF99"},{n:"Light Green",v:"#CCFFCC"},{n:"Light Turquoise",v:"#CCFFFF"},{n:"Pale Blue",v:"#99CCFF"},{n:"Lavender",v:"#CC99FF"},{n:"White",v:"#ffffff"}],userPalette:[{n:"#F00E0E",v:"#F00E0E"},{n:"#080000",v:"#080000"},{n:"#E81A1A",v:"#E81A1A"},{n:"#6E0909",v:"#6E0909"},{n:"#4F2828",v:"#4F2828"},{n:"#141212",v:"#141212"},{n:"#D60202",v:"#D60202"},{n:"#C40404",v:"#C40404"}]}});}());(function(){mstrmojo.requiresCls("mstrmojo.hash");mstrmojo.vi.ui.rw.selectors._IsPageBySelector=mstrmojo.provide("mstrmojo.vi.ui.rw.selectors._IsPageBySelector",{_mixinName:"mstrmojo.vi.ui.rw.selectors._IsPageBySelector",isViPageBy:true,preBuildRendering:function A(){var C=this.defn;C.horiz=true;var B=mstrmojo.hash.copyProps(["n","srcid","srct","style","ck","ckey","tks"],C);B.n=C.ttl||B.n||"";B.id=this.id;this.parent.set("unit",B);delete this.getFormats().color;return this._super();}});mstrmojo.vi.ui.rw.selectors._IsPageBySelector.PageByUnitType=null;}());(function(){mstrmojo.requiresCls("mstrmojo.hash","mstrmojo.array");var B={};var E={};mstrmojo.publisher=mstrmojo.provide("mstrmojo.publisher",{publish:function F(H,Q,L){var M=B[H]&&B[H][Q],O;if(!M){return ;}for(O in M){var J=null;if(O){J=mstrmojo.all[O];if(!J){delete M[O];continue;}}var R=M[O].methods;if(R){var P=J||mstrmojo.global,I;for(I in R){if(P[I]){P[I](L);}}}var N=M[O]&&M[O].functions,S=(N&&N.length)||0;if(S){var K;if(J){for(K=S-1;K>-1;K--){if(N[K]){N[K].apply(J,[L]);}}}else{for(K=S-1;K>-1;K--){if(N[K]){N[K](L);}}}}}},subscribe:function D(I,N,R,J){var S=B[I];if(!S){S={};B[I]=S;}var M=S[N];if(!M){M={};S[N]=M;}var K=M[J||""];if(!K){K={};M[J||""]=K;}if(typeof R==="function"){var L=K.functions;if(!L){L=[];K.functions=L;}L.push(R);}else{var H=K.methods;if(!H){H={};K.methods=H;}H[R]=true;}var Q=E,P=Q[J||""];if(!P){P={};Q[J||""]=P;}var O=P[I];if(!O){O={};P[I]=O;}O[N]=true;return{id:I,type:N,callback:R,listener:J,clear:function(){mstrmojo.publisher.unsubscribe(this);}};},unsubscribe:function C(I){var R=B[I.id],O=R&&R[I.type],L=O&&O[I.listener||""];if(!L){return ;}var K=mstrmojo.array,Q=mstrmojo.hash,P=typeof I.callback,M=false;if(P==="function"){var N=L.functions;if(N){K.removeItem(N,I.callback);if(!N.length){delete L.functions;if(Q.isEmpty(L.methods)){M=true;}}}}else{var J=L.methods;if(J){delete J[I.callback];if(Q.isEmpty(J)){delete L.methods;if(!L.functions||!L.functions.length){M=true;}}}}if(M){delete O[I.listener||""];if(Q.isEmpty(O)){delete R[I.type];}}},hasSubs:function G(K,J){var I=B[K],H=I&&I[J];return !!H;},clearSubscriptions:function A(I){if(!I){I="";}var P=B,M=mstrmojo.hash,H;if(P[I]){delete P[I];}var O=E[I];if(O){for(H in O){var N=P[H],L=O[H],K;if(!N){continue;}for(K in L){var J=N[K];if(!J){continue;}delete J[I];if(M.isEmpty(J)){delete N[K];}}}}delete E[I];}});mstrmojo.publisher.NO_SRC="NO_SRC";mstrmojo.publisher.CONNECTIVITY_CHANGED_EVENT="CONNECTIVITY_CHANGED";mstrmojo.publisher.RECONCILE_END_EVENT="RECONCILE_END";}());(function(){mstrmojo.requiresCls("mstrmojo.models.template.Header");mstrmojo.models.template.Headers=mstrmojo.declare(null,null,{init:function D(K){var O=this.isRow=K.isRow,J=this.data=K.data,L=J.gts,G=J.ghs,F=this.hs=O?G.rhs:G.chs,M=this.i=K.i,N=0,I;this.titles=O?L.row:L.col;this.headers=F.items&&F.items[M]&&F.items[M].items;this.missingTitles=this.titles&&this.headers?(this.headers.length-this.titles.length):0;if(O&&this.headers){N=this.titles.length-this.headers.length;if(N){for(I=M-1;I>=0;I--){var E=F.items[I].items,H=E.length-this.headers.length;if(H>0){this.headers=E.slice(0,H).concat(this.headers);if(this.titles.length===this.headers.length){break;}}}}}},size:function B(){var E=this.headers;return(!E?0:E.length);},getHeader:function C(H){var F=this.headers,G=F&&F[H],E=H;if(G&&this.missingTitles){E=isNaN(G.tui)?G.ui:G.tui;}return G&&new mstrmojo.models.template.Header({h:G,t:this.titles[this.isRow?E:this.i]});},getCSS:function A(F){var E=this.headers;return E&&this.data.css[E[F].cni].n;},getHeaderCell:function(F){var E=this.headers;return E&&E[F];}});}());(function(){mstrmojo.requiresCls("mstrmojo.cookies");mstrmojo.requiresDescs(14356,11866);mstrmojo.mstr._RecentObjectsHelper=mstrmojo.provide("mstrmojo.mstr._RecentObjectsHelper",{_mixinName:"mstrmojo.mstr._RecentObjectsHelper",handleRecentObjects:function B(){var F=this.recentObjects();var D=Math.min(F.length,10);var C=-1;for(i=0;i<D;i++){if(F[i].lastRecovered!==undefined&&F[i].lastRecovered===true){F[i].iconClass="mstrIcon-lv mstrIcon-recover";F[i].recoveryName=mstrmojo.desc(11866,"Recover #").replace("#",F[i].recoveryName);F[i].itemClass="mstr-recent-item";C=i;}else{F[i].itemClass="mstr-recent-item";F[i].iconClass="mstrIcon-lv "+F[i].iconClass;}}if(C!=-1){F[C].cssText="border-bottom: 1px solid #D6D6D6;";}var E={};if(D==0){E.recoveryURL="";E.recoveryName=mstrmojo.desc(14356,"No recent items");E.iconClass="";E.lastRecovered=false;F.push(E);}return F;},recentObjects:function A(){try{var J=window.localStorage,P=window.sessionStorage;if(!J||!window.JSON){return ;}var E=[];var N=function(V){var W="";switch(V){case 3:W="reportID=";break;case 55:W="documentID=";break;default:W="messageID=";break;}return W;};var H=function(Z){var Y=Z.ty;var V="";switch(Y){case 55:var X=Z.vm;switch(X){case 8192:case 2048:V="mstrIcon-lv-rw avm";break;case 1:default:V="mstrIcon-lv-rw";break;}break;case 3:var W=Z.viewMode;switch(W){case 1:V="mstrIcon-lv-g";break;case 2:V="mstrIcon-lv-gp";break;case 3:V="mstrIcon-lv-gpgs";break;default:V="";break;}break;}return V;};var U=JSON.parse(J.getItem("recentObjects"+mstrConfig.lastMsgKey));try{var S=mstrConfig.lastMsgKey,D="lastMsgID"+S,G=(JSON.parse(decodeURIComponent(mstrmojo.cookies.getCookieSetting("lastMsgID")||"{}")))[S],I=function(V){return V&&(V.length===32)&&/^[A-Z0-9]{32}$/.test(V);};}catch(R){}if(I(G)){var K={};var O="lastMsgRecoveryInfo"+S,C=J.getItem(O);if(C){var C=JSON.parse(C);K.recoveryInfo=C;K.recoveryURL=mstrmojo.addCSRFTokenToURL("?"+C.url.replace(/messageID.*/,"messageID="+G)),K.recoveryName=C.n;K.recoveryType=C.ty;K.did=C.did;K.iconClass=H(C);K.lastRecovered=true;E.push(K);}}for(var Q in U){var L=U[Q];if(L===""){continue;}var K={};var C=JSON.parse(L);K.recoveryInfo=C;K.recoveryURL=mstrmojo.addCSRFTokenToURL("?"+C.url.replace(/messageID.*/,N(C.ty)+C.did));K.recoveryName=C.n;K.recoveryType=C.ty;K.did=C.did;K.iconClass=H(C);K.lastRecovered=false;var M=mstrmojo.array.find(E,"did",K.did);if(M===-1){E.push(K);}else{E[M].recoveryInfo.imgData=K.recoveryInfo.imgData;}}return E;}catch(F){mstrmojo.errors.log(F);}}});}());(function(){mstrmojo.requiresCls("mstrmojo.vi.models.EnumDragSources");function D(H){this.cleanUpAfterTarget(H);var G=H.tgtData;if(G){delete H.tgtData;}var I=this.getContextDragData(H);if(I&&I.setAvatarClass){I.setAvatarClass("");}}mstrmojo.vi.ui._IsDropTarget=mstrmojo.provide("mstrmojo.vi.ui._IsDropTarget",{_mixinName:"mstrmojo.vi.ui._IsDropTarget",dropZone:true,getDropAvatarIcon:function B(G){return"add";},getContextDragData:function F(G){return G.getCtxtDragData();},cleanUpAfterTarget:mstrmojo.emptyFn,ondragenter:function A(G){var H=this.getContextDragData(G);if(H&&H.setAvatarClass){H.setAvatarClass(this.getDropAvatarIcon(G));}if(this._super){this._super(G);}},ondragleave:function E(G){D.call(this,G);if(this._super){this._super(G);}},ondrop:function C(G){D.call(this,G);if(this._super){this._super(G);}}});}());(function(){mstrmojo.requiresCls("mstrmojo.EnumDSSDisplayMode");mstrmojo.requiresDescs(981);var B=mstrmojo.vi.viz;mstrmojo.vi.viz.KnownVisualizations={CUSTOM:-2,UNKNOWN:-1,GRID:0,ESRIMAP:2,GRAPHMATRIX:3,NEWGRAPHMATRIX:13,IMAGELAYOUT:4,HEATMAP:16,GOOGLEMAP:17,NETWORK:18,MAPBOX:19,KPICARD:20,getDefinition:function A(E){var F=B.KnownVisualizations,H={Grid:{id:F.GRID,displayMode:mstrmojo.EnumDSSDisplayMode.GRID,title:mstrmojo.desc(981,"Grid")},visAjaxDatePicker:{id:1},ESRIMapVisualizationStyle:{id:F.ESRIMAP,mobileVIStyles:{IPhoneVisualization:"ViEsriMapAdapter",IPadVisualization:"ViEsriMapAdapter"}},GraphMatrixVisualizationStyle:{id:F.GRAPHMATRIX,displayMode:mstrmojo.EnumDSSDisplayMode.GRID,widgetEnable:"-1",mobileVIStyles:{IPadVisualization:"IPadGraphMatrix2Style"}},NewGraphMatrixVisualizationStyle:{id:F.NEWGRAPHMATRIX,displayMode:mstrmojo.EnumDSSDisplayMode.GRID,widgetEnable:"-1",mobileVIStyles:{IPadVisualization:"IPadGraphMatrix2Style"}},ImageLayoutVisualizationStyle:{id:F.IMAGELAYOUT,mobileVIStyles:{IPadVisualization:"IPhoneImageMapStyle",ATabletVisualization:"AndroidImageMapStyle"}},SurveyVisualizationStyle:{id:8,mobileVIStyles:{IPadVisualization:"SurveyVisualizationStyle"}},VIHeatMapVisualizationStyle:{id:F.HEATMAP,mobileVIStyles:{IPadVisualization:"IPadHeatMapStyle",ATabletVisualization:"HeatMapVisualizationStyle"}},GoogleMapVisualizationStyle:{id:F.GOOGLEMAP,mobileVIStyles:{IPhoneVisualization:"IPhoneMapStyle",IPadVisualization:"IPadMapStyle"}},MapboxVisualizationStyle:{id:F.MAPBOX,mobileVIStyles:{IPhoneVisualization:"IPhoneMapboxStyle",IPadVisualization:"IPhoneMapboxStyle"}},NetworkVisualizationStyle:{id:F.NETWORK,mobileVIStyles:{IPadVisualization:"IPhoneNetVizStyle"}},KPICardVisualizationStyle:{id:F.KPICARD,mobileVIStyles:{IPadVisualization:"IPhoneKPICardStyle"}}};var G=H[E];if(!G){var C=mstrConfig.pluginsVisList,D=C&&C[E];G={id:D?F.CUSTOM:F.UNKNOWN};G.mobileVIStyles=(D&&D.mobileVIStyles)||{};}return G;}};}());(function(){mstrmojo.requiresCls("mstrmojo.array","mstrmojo.dom");var E=mstrmojo.dom,K=mstrmojo.array,N=mstrmojo.hash;function C(a){var Y=0,Z=a.childNodes;K.forEach(Z,function(b){Y+=(b.colSpan||1)-1;});return Y;}function H(Z){var Y=this;Y.selectedRows=[];Y.headersData="";Y.rowsData="";if(Z){Y.clipBoardTextRMC="";}else{Y.clipBoardText="";}Y.globalRowCounter=0;Y.allRows=[];}function J(Z,f){H.call(this,f);var d,Y=Z.length;var c=R.call(this,E.findAncestorByName(Z[0],"tr",true,this.domNode)),e=c.headerRowCount,a=c.maxHeaderChildCount,b=c.gridOffset;for(d=0;d<Y;d++){G.call(this,Z[d],"tr",true,this.domNode,e,a,b);}}function R(h){var Y=this.rhsCP.startIndexInContainer||0,d=0;var b,a=0,c=h&&h.parentNode;while(c.hasAttribute("n")&&parseInt(c.getAttribute("n"),10)>0){c=c.previousElementSibling;}var Z=c.firstChild,f=Z.childNodes;for(b=0;b<f.length;b++){d+=parseInt(f[b].getAttribute("colspan"));}var e=S(Z,Y,d);this.headersData=e.headerText;var g=e.firstDataRow;if(g&&g.childElementCount>d){a=1;}return{headerRowCount:Y,maxHeaderChildCount:d,gridOffset:a};}function S(g,e,Z){var b=0,a,d="",Y=0,h,f,c;while(Y<e){c=g.childNodes;h=c.length;if(Y!==0){d+="\n";for(b=0;b<(Z-h);b++){d+="\t";}}for(b=0;g&&b<h;b++){a=c[b].innerText||c[b].textContent;d+=a?(a+"\t"):"";f=c[b].getAttribute("colspan");while(f>1){d+="\t";f--;}}g=g.nextSibling;Y++;}return{headerText:d,firstDataRow:g};}function M(Y){return this.allRows[this.globalRowCounter>0?this.globalRowCounter-1:0][Y];}function G(j,Z,c,o,d,g,b){var f=[],e=[],l=j.rowSpan,m=0,Y="",n=0,a="",p=E.findAncestorByName(j,Z,c,o),q=this,h=q.allRows,k;if((p.childElementCount-b)<g){e=q.rhsCP.getUnmergedCells(j.getAttribute("r")-d);for(m=0;m<e.length;m++){f[m]=(e[m]._e)?e[m]._e.n:" ";}}if(l===1){h[q.globalRowCounter]=new Array(g);n=0;if(f.length>0){f.forEach(function(r){Y+=r+"\t";h[q.globalRowCounter][n++]=r;});}Y=I.call(q,p,Y,n);U.call(q,Y);this.globalRowCounter++;}else{while(l>0){n=0;h[q.globalRowCounter]=new Array(g);Y="";k=C(p);m=g-(p.childElementCount-b)-k;while(m>0){a=f[n]?f[n]:M.call(q,n);Y+=a+"\t";h[q.globalRowCounter][n++]=a;m--;}Y=I.call(q,p,Y,n);U.call(q,Y);q.globalRowCounter++;p=p.nextSibling;l--;}}}function I(e,d,a){var Z,Y,g=e.childNodes,f=this.allRows[this.globalRowCounter],b;for(Z=0;Z<g.length;Z++){var c=g[Z];Y=c.innerText||c.textContent;d+=Y?(Y+"\t"):"";f[a++]=Y?(Y):"";b=c.colSpan;while(b-->1){d+="\t";f[a++]="\t";}}return d;}function U(Y){if(K.indexOf(this.selectedRows,Y)<0){this.selectedRows.push(Y);this.rowsData+=Y+"\n";}}function D(){this.clipBoardText=(this.headersData)?this.headersData+"\n"+this.rowsData:this.rowsData;}function P(){this.clipBoardTextRMC=(this.headersData)?this.headersData+"\n"+this.rowsData:this.rowsData;}function W(){var Y=this.xTabHiddenTextArea;Y.readOnly=false;Y.value=this.clipBoardText;Y.readOnly=true;Y.focus();Y.select();}function V(){var Y=this.xTabHiddenTextArea;Y.readOnly=false;Y.value=this.clipBoardTextRMC;Y.readOnly=true;Y.focus();Y.select();}function A(){try{document.execCommand("copy");}catch(Y){console.log("Exception while copying data"+Y);}}function L(){var Y=this;Y.selectedRows=null;Y.allRows=null;Y.headersData=null;Y.rowsData=null;}mstrmojo.vi.ui.rw.xtab._SupportXtabCopyPaste=mstrmojo.provide("mstrmojo.vi.ui.rw.xtab._SupportXtabCopyPaste",{_mixinName:"mstrmojo.vi.ui.rw.xtab._SupportXtabCopyPaste",xTabHiddenTextArea:undefined,isCopySupported:false,selectedRows:[],headersData:"",rowsData:"",clipBoardText:"",clipBoardTextRMC:"",globalRowCounter:0,allRows:undefined,init:function Q(Y){this._super(Y);this.isCopySupported=!(mstrApp.isSingleTier&&E.isMac()||E.isSafari||E.isFF);},onclick:function X(Y){this._super(Y);var Z=N.walk("node.data.olm",this)&&!(N.walk("node.data.rw.row.bc",this)>0);if(this.cmSelCells.length>0&&!E.isMobile&&!Z){this.prepareClipBoardDataRMC.call(this,this.cmSelCells);}if(this.selCells.length>0&&!E.isMobile&&!Z){this.prepareClipBoardData.call(this,this.selCells);}},prepareClipBoardData:function O(Y){J.call(this,Y,false);D.call(this);W.call(this);L.call(this);},prepareClipBoardDataRMC:function F(Y){J.call(this,Y,true);P.call(this);},copyRowsFromXtab:function B(Z,Y){if(Y.length<1){return ;}if(this.isCopySupported){V.call(this);A.call(this);}L.call(this);}});}());(function(){mstrmojo.requiresCls("mstrmojo.dom");var G=mstrmojo.dom,H=Math;var D=1,F=2,J=4,E=5,A=6;function B(r){var M=this.anchor;if(!M){return false;}var W=this.baseTipClass,X=this[this.tipNodeName];X.className=W+" top";var j=this[this.boundaryNodeName],w=this[this.popupNodeName],g=this.anchorOffset,u=this.anchorOrientation,q=this.hasScrollbars(),d=mstrmojo.hash.copy(this.anchorPosition||G.position(M,true)),P=G.position(j,true),AB=P.w,N=P.h,k=w.offsetWidth,R=w.offsetHeight,a=k/2,K=R/2,c=G.position(X),o=H.min(c.h,c.w),U=H.max(c.h,c.w)/2,m=parseInt(this.placement,10);if(r){d=G.position(M,true);}if(q){AB-=15;N-=15;}var e=G.contains(j,w),p=e?0:P.y,AA=AB/2-a,V=N/2-K+p,v=-1000,AC=-1000,O,n=["borderBottomColor","borderTopColor","borderRightColor","borderLeftColor"],AD=0;if(e){d.x=d.x-P.x;d.y=d.y-P.y;}var l=d.y+d.h,Q=d.x+d.w,x=((Q+k)<AB),Y=d.y>R,t=((l+R)<N),b=function(AE,AG,AF){return H.min(H.max(AE,AF),H.max(AG,0));},S=function(){if((d.x<AB)&&(t||Y)){var AE=d.x+(d.w/2),AF=(m===J&&t)||!Y;if(AF){O="top";AC=l;AD=0;V=l+o-g;}else{O="bottom";AC=d.y-o;AD=1;V=AC-R+g;}AA=b(0,AB-k,AE-a);v=b(d.x,Q,AE)-U;return true;}return false;},h=function(){if((d.y<N)&&(x||d.x>k)){var AE=d.y+(d.h/2),AF=!(m===E&&d.x>k)&&x;if(AF){O="left";v=Q;AD=2;AA=Q+o-g;}else{O="right";v=d.x-o;AD=3;AA=v-k+g;}V=b(p,N-R,AE-K);AC=b(d.y,l,AE)-U;return true;}return false;},Z=[S,h],z=0;if(m===F){V=this.popPosition.top;AA=this.popPosition.left;AC=-1000;v=-1000;O=null;}else{if(m===E||m===A||(m===D&&u==="h")){Z.reverse();}for(z;z<2;z++){if(Z[z]()){break;}}V=H.round(V);AA=H.round(AA);AC=H.round(AC);v=H.round(v);}X.className=W+" "+(O||"hidden");var f=X.style,L=w.style;f.top=AC+"px";f.left=v+"px";if(this.tipNodeColor){mstrmojo.array.forEach(n,function(AE){f[AE]="";});f[n[AD]]=this.tipNodeColor;}L.top=V+"px";L.left=AA+"px";return true;}mstrmojo._IsAnchorable={anchor:null,anchorPosition:null,boundaryNodeName:"curtainNode",popupNodeName:"editorNode",tipNodeName:"tipNode",baseTipClass:"mstrmojo-Editor-tip",anchorOffset:25,anchorOrientation:"v",placement:D,popPosition:null,hasScrollbars:function C(){return(!mstrApp.isTouchApp||!mstrApp.isTouchApp());},prepareAnchor:mstrmojo.emptyFn,positionDialog:function I(K){this.prepareAnchor();if(!B.apply(this,[K])){if(typeof this._super==="function"){this._super();}}}};}());(function(){mstrmojo.requiresCls("mstrmojo.dom");var F=mstrmojo.dom;var W="touchstart",J="mousedown",P=F.isIOSTouch,S=P?W:J;function X(Z){var Y=Z[Z.hotSlot||"domNode"];if(Y){if(!Z._closeCallback){var b=Z.id,a=function(c){return function(f){var d=mstrmojo.all[b];if(d&&!d.ignoreHover){d["auto"+c](f,self);}};};Z._uncloseCallback=a("Unclose");Z._closeCallback=a("Close");}F.attachEvent(Y,"mouseover",Z._uncloseCallback);F.attachEvent(Y,"mouseout",Z._closeCallback);}}function C(Z){if(Z._closeCallback){var Y=Z[Z.hotSlot||"domNode"];if(Y){F.detachEvent(Y,"mouseover",Z._uncloseCallback);F.detachEvent(Y,"mouseout",Z._closeCallback);}}}function G(b,Z){var Y=b,a;while(Y){if(Y.open||Y.openPopup){a=Y.ignoreHoverCount||0;a=Z?(a+1):(a>0?a-1:a);Y.ignoreHoverCount=a;if(Y.set){Y.set("ignoreHover",(a>0));}else{Y.ignoreHover=(a>0);}}Y=Y.opener||Y.parent;if(Y&&Y.shouldPropagateLockHover&&!Y.shouldPropagateLockHover()){break;}}}function E(){var a=this._lockHoverCallback,Z=this.curtainNode,c=this._onClickChange;if(a){F.detachEvent(document.body,S,a,true);delete this._lockHoverCallback;}if(!Z||!c){return ;}var Y=mstrApp&&mstrApp.isTouchApp&&mstrApp.isTouchApp()||P,b=Y?W:J;F.detachEvent(Z,b,c);delete this._onClickChange;}mstrmojo._CanAutoClose=mstrmojo.provide("mstrmojo._CanAutoClose",{autoCloses:false,autoCloseDelay:100,locksHover:false,hotSlot:null,closeOnClick:false,curtainNode:null,postBuildRendering:function U(){this._super();if(this.autoCloses){X(this);}this.oncloseOnClickChange();},onautoClosesChange:function N(){var Y=(this.autoCloses)?X:C;Y(this);},oncloseOnClickChange:function I(){if(!this.curtainNode){return ;}var a=this,Y=mstrApp&&mstrApp.isTouchApp&&mstrApp.isTouchApp()||P,Z=Y?W:J;this._onClickChange=function(){a.close();if(Y){mstrmojo.touchManager.notify([]);}};F.attachEvent(a.curtainNode,Z,this._onClickChange);},autoUnclose:function H(){var Y=this._autoCloseTimer;if(Y){self.clearTimeout(Y);delete this._autoCloseTimer;}},autoClose:function L(){if(this.ignoreHover){return ;}if(this._autoCloseTimer){self.clearTimeout(this._autoCloseTimer);}if(this.opener){if(this.autoCloseDelay){var Y=this.opener.id;this._autoCloseTimer=self.setTimeout(function(){mstrmojo.all[Y].closePopup();},this.autoCloseDelay);}else{this.opener.closePopup();}}},destroy:function V(Y){E.call(this);this._super(Y);},lockHover:function R(){G(this,true);if(!this._lockHoverCallback){var Z=this.id,Y=this._lockHoverCallback=function(a){mstrmojo.all[Z]._unlockHoverCheck(a,self);};if((F.isIE7||F.isIE8)&&window.event&&(window.event.type===S)&&this.opener){this.opener._ignoreMousedown=true;}F.attachEvent(document.body,S,Y,true);}},unlockHover:function O(){G(this,false);E.call(this);},hoverLock:function(Y){G(this,Y);},suppressClose:function B(Y){return F.contains(this.domNode,Y,true,document.body);},_unlockHoverCheck:function D(b,Y){var Z=this.opener;if(Z&&Z._ignoreMousedown){delete Z._ignoreMousedown;return ;}var a=F.eventTarget(Y,b);if(!this.suppressClose(a)){if(this.isWithinParentWidget(a)){return ;}if(Z&&Z.onPopupAutoClosed){Z.onPopupAutoClosed(b,Y);}this.close(a);}},isWithinParentWidget:function Q(Z){var Y=F.findWidget(Z);while(Y){if(Y===this){return true;}Y=Y.parent||Y.opener;}return false;},open:function K(Z,Y){if(this.autoCloses){this.autoUnclose();}this._super(Z,Y);if(this.locksHover){this.lockHover();}},close:function M(Y){if(this.locksHover){this.unlockHover();}this._super(Y);},shouldPropagateLockHover:function A(){return true;}});}());(function(){mstrmojo.requiresCls("mstrmojo.dom");var B="mstrmojo-floating-toolbar-lightbox";var G="mstrmojo-floating-toolbar";var M="mstrmojo-floating-toolbar-cell";var I="mstrmojo-fixed-toolbar-lightbox";var A="mstrmojo-fixed-toolbar";var N="mstrmojo-fixed-toolbar-cell";var H=" hasToolBar";var E="mstrmojo-Button mstrmojo-InteractiveButton mstrmojo-oivmSprite ";var D="mstrmojo-Button-text";var L=27;mstrmojo._HasToolbar=mstrmojo.provide("mstrmojo._HasToolbar",{_mixinName:"mstrmojo._HasToolbar",postBuildRendering:function C(){this._super();var O=this.getToolbarCfg();if(!O||this.defn.ttl){return ;}var S=this.containerNode;if(S){var Q=this._createToolbar(G,M);Q.className=B;S.className+=H;S.insertBefore(Q,S.firstChild);var P=this.domNode,R=mstrmojo.boxmodel.offset(P,this.parent&&this.parent.domNode);if(R.top<L){Q.style.top=(L-R.top)+"px";}}},_createToolbar:function F(W,b){var S=this.getToolbarCfg(),Z=this,X=document,P=X.createElement("div"),V=X.createElement("table"),Y=X.createElement("tr"),R=X.createElement("td");P.appendChild(V);V.className=W;R.className=b;Y.appendChild(R);V.appendChild(Y);var a=function(c){Z.onClick(c);},U;for(U in S){var O=X.createElement("div");O.className=E+S[U].css[0];var Q=X.createElement("div");Q.className=D;Q.nodeValue="&nbsp;";Q.setAttribute("ix",U);Q.setAttribute("cix","0");O.appendChild(Q);R.appendChild(O);O.onclick=a;}return P;},renderToolbar:function K(Q){if(!this.getToolbarCfg()){return ;}var P=Q.firstChild,O=this._createToolbar(A,N);O.className=I;if(P){Q.insertBefore(O,P);}else{Q.appendChild(O);}},onClick:function J(V,P){var W=mstrmojo.dom,O=W.eventTarget(P,V),S=O.getAttribute("cix"),R=O.getAttribute("ix");var Q=this.toolbarCfg[R],U=Q.callback;if(U&&this[U]&&this[U]()){S=++S%Q.css.length;O.parentNode.className=E+Q.css[S];O.setAttribute("cix",S);}}});}());(function(){mstrmojo.requiresCls("mstrmojo.dom");var D=mstrmojo.dom;mstrmojo._FillsBrowser=mstrmojo.provide("mstrmojo._FillsBrowser",{_mixinName:"mstrmojo._FillsBrowser",getBrowserDimensions:function F(H){if(H){return{w:H.innerWidth,h:H.innerHeight};}var G=D.windowDim(),I=(D.isFF||D.isWK)?0:2;return{w:Math.max(G.w,0)+"px",h:Math.max(G.h-I,0)+"px"};},preBuildRendering:function B(){var I=this._super(),H=this.getBrowserDimensions();if(!this.browserResized||this.browserResized(H)!==true){this.height=H.h;this.width=H.w;}if(!this._listenerProc){var K=this.id,J=null,G=this._listenerProc=function(M){if(mstrApp&&mstrApp.isExporting){var L=M||window.event;mstrmojo.all[K].monitorWindow(L);}else{window.clearTimeout(J);J=window.setTimeout(function(){var N=M||window.event;mstrmojo.all[K].monitorWindow(N);},150);}};D.attachEvent(window,"resize",G);}return I;},destroy:function C(G){if(this._listenerProc){D.detachEvent(window,"resize",this._listenerProc);}this._super(G);},getResizeDimensions:function A(G){var J=G.currentTarget,I=this.getBrowserDimensions(),H={w:(J?J.innerWidth+"px":I.w),h:(J?J.innerHeight+"px":I.h)};return H;},monitorWindow:function E(G){var H=this.getResizeDimensions(G);if((H.h===this.height&&H.w===this.width)||parseInt(H.h,10)<=20||parseInt(H.w,10)<=20){return ;}if(!this.browserResized||this.browserResized(H,true)!==true){if(H.h!==this.height){this.set("height",H.h);}if(H.w!==this.width){this.set("width",H.w);}}}});}());(function(){mstrmojo.requiresCls("mstrmojo.dom");var C=mstrmojo.dom;function D(J,I){var G=[];if(J){var F;for(F in J){var H=Number(F);if(H>=I){G.push(H);}}}G.sort(mstrmojo.array.numSorter);return G;}mstrmojo.ListSelector=mstrmojo.provide("mstrmojo.ListSelector",{premousedown:function E(L,F,N){if(C.isPrimaryMouseBtn(N.e)){var I=N.hWin,J=N.e,G=C.eventTarget(I,J),M=L.listMapper.findIndex(L,F,G);if(M>-1){var H=L.multiSelect,K=C.ctrlKey(I,J),O=C.shiftKey(I,J);if(K||O){C.clearBrowserHighlights(I);}if(H&&(K||(L.selectionPolicy==="toggle"))){L.toggleSelect(M);}else{if(H&&O){L.rangeSelect(M);}else{L.singleSelect(M);}}}}},premouseup:function B(H,K,G){var F=G.hWin,J=G.e,L=C.ctrlKey(F,J),I=C.shiftKey(F,J);if(L||I){C.clearBrowserHighlights(F);}},onadd:function A(I,H){var M=H&&H.value&&H.value.length;if(M){var G=H.index,K=I.selectedIndices,L=D(K,G),J;for(J=L.length-1;J>-1;J--){var F=L[J];K[F+M]=true;delete K[F];}if(I.selectedIndex>=G){I.selectedIndex+=M;}}},onremove:function A(Q,S){var O=S&&S.value&&S.value.length;if(O){var R=S.index,I=R+O-1,M=Q.selectedIndices,L=Q.selectedIndex,G=[],U=[],P=false;if(M){var H;for(H in M){var K=Number(H);if(K>I){G.push(K);}else{if(K>=R){U.push(K);P=true;}}}}G.sort(mstrmojo.array.numSorter);var J,N;for(J=0,N=G.length;J<N;J++){var F=G[J];M[F-O]=true;delete M[F];}if(L>I){Q.selectedIndex-=O;}if(P){Q.removeSelect(U);}}}});}());(function(){mstrmojo.requiresCls("mstrmojo.dom");var E=mstrmojo.dom;mstrmojo.ui._IsIncFetchList=mstrmojo.provide("mstrmojo.ui._IsIncFetchList",{_mixinName:"mstrmojo.ui._IsIncFetchList",ifDataHelper:null,supportsIncFetch:false,isFetching:false,initScroll:function A(){var I=this.ifDataHelper,H=this,G=this.scrollNode||this.domNode;this.supportsIncFetch=I&&I.hasNext();if(I&&this.supportsIncFetch){this._scroll=function F(){var J=this.scrollNode||this.domNode||G;if(Math.ceil(J.offsetHeight+J.scrollTop)>=J.scrollHeight){H.raiseEvent({name:"incFetch",id:H.id});}};E.attachEvent(G,"scroll",this._scroll);this.attachEventListener("incFetch",this.id,function(J){if(!this.supportsIncFetch||this.isFetching){return ;}if(this.preNext){this.preNext();}this.set("isFetching",true);I.next({complete:function(K){if(H.postNext){H.postNext();}H.set("isFetching",false);},success:function(K){H.addItems(K.items||null);},failure:function(K){H.supportsIncFetch=false;mstrmojo.alert("Error in fetching next: "+K);}});});}},unrender:function D(F){var G=this.scrollNode||this.domNode;E.detachEvent(G,"scroll",this._scroll);this._super(F);},render:function C(){this._super();if(this.supportsIncFetch){var F=this.scrollNode||this.domNode;E.attachEvent(F,"scroll",this._scroll);}},addItems:function B(F){if(this._super){this._super(F);}if(!this.ifDataHelper.hasNext()){this.supportsIncFetch=false;var G=this.scrollNode||this.domNode;E.detachEvent(G,"scroll",this._scroll);}}});}());(function(){mstrmojo.requiresCls("mstrmojo.dom");var J=mstrmojo.dom;var Z=5;var l=1;var W=2;var N=4;var k=0;var O=true;var I=0;var F=86400000;mstrmojo.VisChartUtils=mstrmojo.provide("mstrmojo.VisChartUtils",{getScreenZoomFactor:function a(){if(I==0){if(mstrMobileApp){var p=mstrMobileApp.getDeviceDPI();console.log("dpi:"+p);I=p/160;}else{I=1;}}return I;},changeElementSize:function b(t,x,w){if(x=="fontSize"||x=="height"||x=="line-height"){var v=mstrmojo.css.getStyleValue(t,x);var r=Math.round(w*parseInt(v));t.style[x]=r+"px";}else{if(x=="font"){var u=mstrmojo.css.getStyleValue(t,"fontSize");var r=Math.round(w*parseInt(u));var q=mstrmojo.css.getStyleValue(t,"fontWeight");var p=mstrmojo.css.getStyleValue(t,"fontFamily");t.style.font=q+" "+r+"px "+p;}}},rgbaStr2rgba:function L(p){var r=null;p=p.replace(/ /g,"");var q=p.indexOf("rgba");if(q>=0){p=p.substring(q+5,p.length-1);r=p.split(",");}return r;},fillBackground:function c(t,p,AC,q,v){var u=q||t.context,r=p||t.canvas.width,z=AC||t.canvas.height,AA=t.themeColor||"#000000",x=null,AB=v||1;if(!u){u=t.canvas.getContext("2d");if(!u){return ;}}u.save();if(t.noBackground){}else{if(!t.isAndroid&&!t.isTimeSeries){x=u.createLinearGradient(0,0,0,z/2);u.fillStyle=AA;u.fillRect(0,0,r,z);u.globalAlpha=0.4;x.addColorStop(0,"#fff");x.addColorStop(0.1,"#fff");x.addColorStop(1,AA);u.fillStyle=x;u.rect(0,0,r,z/2);u.fill();u.globalAlpha=0.1;u.fillStyle="#fff";u.fillRect(0,0,r,z/2);}else{if(t.isTimeSeries){var w=t.formatProp;x=u.createLinearGradient(0,0,0,z);u.globalAlpha=w.backgroundAlpha;u.fillStyle=this.rgb2rgbStr(w.backgroundClr)||"#000000";u.rect(0,0,r,z);u.fill();}else{u.globalAlpha=AB;u.fillStyle=AA;u.fillRect(0,0,r,z);}}}u.restore();},rgb2rgbStr:function X(q,r){var p="";if(!q||q.length!=3){return p;}if(r||r==0){p="rgba("+q[0]+","+q[1]+","+q[2]+","+r+")";}else{p="rgb("+q[0]+","+q[1]+","+q[2]+")";}return p;},getRGBWithOpacity:function R(q,p,r){if(isNaN(p)){return ;}if(!r){r=[255,255,255];}var t=[];for(color in q){t[color]=parseInt(q[color]*(1-p)+r[color]*p);}return t;},fillMasterChartBackground:function S(x,q,p,t,AE,w,u){var z=u||x.context,v=t||x.canvas.width,AC=AE||x.canvas.height,AD=x.themeColor,AB=null;var AA=x.formatProp;z.save();z.globalAlpha=AA.backgroundAlpha;z.fillStyle=this.rgb2rgbStr(AA.backgroundClr)||"#000000";z.fillRect(0,0,v,p+AE+w);z.globalAlpha=1;z.strokeStyle=this.rgb2rgbStr(x.formatProp.textClr,0.5);z.lineWidth=1;var r=p+0.5;this.drawLineSet(this,[{x:q,y:r},{x:q+v,y:r}],false,z);r=p+AC-0.5;this.drawLineSet(this,[{x:q,y:r},{x:q+v,y:r}],false,z);z.restore();},drawLineSetWithSplit:function(v,AA,z,q,w){var r=AA.length,x=Math.ceil(r/w),p,t;for(var u=0;u<x;u++){p=u*w;t=Math.min(p+w+1,r);this.drawLineSet(v,AA.slice(p,t),z,q);}},drawLineSet:function M(u,AB,AA,p){var v=null,r=AB.length,z=null;if(p){v=p;}else{v=u.context;}var w=null,q=false;v.beginPath();var t=0;while(t<r){if(AB[t]){v.moveTo(AB[t].x,AB[t].y);w=AB[t];q=true;t++;break;}t++;}var x=false;for(;t<r;t++){z=AB[t];if(z){if(!x){v.lineTo(z.x,z.y);q=false;}else{v.moveTo(z.x,z.y);q=true;w=z;x=false;}}else{if(!x){x=true;if(q){v.arc(w.x,w.y,1,0,Math.PI*2,false);}}}}if(AA){v.closePath();v.fill();}else{v.stroke();}},getMinYPosition:function H(q,u,p){var t=u,r;while(t<=p){if(q[t]){r=q[t].y;break;}t++;}for(t=u;t<=p;t++){if(q[t]){r=Math.min(r,q[t].y);}}return r;},drawLineAreaWithSplit:function(w,AD,p,u,t,x,q,z){var r=u-p+1,AB=Math.ceil(r/z),AC,AA;for(var v=0;v<AB;v++){AC=p+v*z;AA=Math.min(AC+z,p+r-1);this.drawLineArea(w,AD,AC,AA,t,x,q);}},drawLineArea:function M(v,p,z,u,x,AD,r){var AC=null,AG=p.length,AB=null,AH=0,AA=0;if(r){AC=r;}else{AC=v.context;}var t=null,AF=false;AC.save();AC.lineWidth=0;AC.beginPath();var AI=z,w;while(AI<=u){if(p[AI]){AH=p[AI].x;AC.moveTo(AH,x);t=p[AI];AF=true;break;}AI++;}w=AI;var AE=false;for(;AI<=u;AI++){AB=p[AI];if(AB){if(!AE){AC.lineTo(AB.x,AB.y);AF=false;AA=AB.x;}else{AH=AB.x;AC.moveTo(AH,x);if(AI+1<=u&&p[AI+1]){AC.lineTo(AB.x,AB.y);}t=AB;AE=false;w=AI;}}else{if(!AE){AE=true;if(!AF){AC.lineTo(AA,x);AC.lineTo(AH,x);var q=this.getMinYPosition(p,w,AI)||0;AC.fillStyle=this.rgb2rgbStr(AD,1);AC.globalAlpha=0.65;AC.fill();}}}}if(!AF){AC.lineTo(AA,x);AC.lineTo(AH,x);var q=this.getMinYPosition(p,w,u)||0;AC.closePath();AC.fillStyle=this.rgb2rgbStr(AD,1);AC.globalAlpha=0.65;AC.fill();}AC.restore();},drawRectangle:function m(v,p,AA,r,u,z,t){var q=null;if(t){q=t;}else{q=v.context;}if(z){q.fillRect(p,AA,r,u);}else{q.strokeRect(p,AA,r,u);}},drawArc:function Q(t,AA,z,v,w,q,r,AB,p){var u=null;if(p){u=p;}else{u=t.context;}u.beginPath();u.arc(AA,z,v,w,q,r);if(AB){u.fill();}else{u.stroke();}},drawRoundRect:function K(t,p,AA,q,u,v,z){v=Math.min(q/2,u/2,v);t.beginPath();t.moveTo(p+v,AA);t.arcTo(p+q,AA,p+q,AA+u,v);t.arcTo(p+q,AA+u,p,AA+u,v);t.arcTo(p,AA+u,p,AA,v);t.arcTo(p,AA,p+q,AA,v);t.closePath();if(z){t.fill();}else{t.stroke();}},drawHalfRoundedRectangle:function o(t,AA,z,AB,u,p,AC,q){var v=null;if(q){v=q;}else{v=t.context;}v.beginPath();v.moveTo(AA+AB,z);v.lineTo(AA+p,z);v.arcTo(AA,z,AA,z+p,p);v.lineTo(AA,z+u-p);v.arcTo(AA,z+u,AA+p,z+u,p);v.lineTo(AA+AB,z+u);if(AC){v.fill();}else{v.stroke();}},drawStartEndPoints:function Y(x,AE,q,u){var t=AE.length;var z=null,p=x.startEndPointRadius;if(q){z=q;}else{z=x.context;}z.save();var AB="#f0f43e",AA="#f0f43e",AC="#663300";if(x.startPointColor){AB=x.startPointColor;}if(x.endPointColor){AA=x.endPointColor;}else{var AD=AE[0].y,w=AE[t-1].y;if(AD>w){AA="#008000";}else{if(AD<w){AA="#8d1616";}else{AA=AB;}}}if(x.otherPointColor){AC=x.otherPointColor;}if(u&l&&AE[0]){z.strokeStyle=AB;z.fillStyle=AB;this.drawArc(this,AE[0].x,AE[0].y,p,0,Math.PI*2,true,true,z);}if(u&W&&AE[t-1]){z.strokeStyle=AA;z.fillStyle=AA;this.drawArc(this,AE[t-1].x,AE[t-1].y,p,0,Math.PI*2,true,true,z);}if(u&N){z.strokeStyle=AC;z.fillStyle=AC;for(var v=1;v<t-1;v++){if(AE[v]){this.drawArc(this,AE[v].x,AE[v].y,p,0,Math.PI*2,true,true,z);}}}z.restore();},getColor:function U(p){return(parseInt(p.themeColor.substr(1),16)>8388607)?"#000000":"#ffffff";},drawHighlightLine:function e(q,v){var p=q.context,u=q.margin,t=u.l,r=q.isTimeSeries?q.chartWidth+u.l:q.getWidth()-u.r;p.save();p.globalAlpha=1;p.strokeStyle=this.rgb2rgbStr(q.formatProp.textClr,0.35);p.lineWidth=1;p.lineCap="round";while(t<r){p.beginPath();p.moveTo(t,v);t+=2;p.lineTo(t,v);p.stroke();t+=3;}p.restore();},addLabel:function n(AH,AI,AG,AE,q,AA,AB){var AD=document.createElement("div");AD.className="mstrmojo-Chart-lbl";AD.style.color=this.rgb2rgbStr(AH.formatProp.textClr,0.8);AD.innerHTML=AI;if(q){AD.style.width=q+"px";}var u=null;var AC=0;if(AH.isTimeSeries){if(AB.w>=0){u=AH.xdiv;AC=AH.animationCanvas.width;}else{u=AH.domNode.getElementsByClassName("mstrmojo-chart-ylbl-div")[0];if(!u){u=document.createElement("div");u.id="mstrmojo-chart-ylbl-div";u.className="mstrmojo-chart-ylbl-div";AH.domNode.appendChild(u);}u.style.width=AH.margin.l-1+"px";}}else{u=AH.domNode;AC=AH.getWidth();}u.appendChild(AD);var t=AD.offsetWidth||(AH.getTextWidth&&AH.getTextWidthByElem(AI,AD));var AF=AD.offsetHeight||22*(I||1);var r=q||t||100;var z=AH.xLabelPadding/2;var v=AH.yLabelPadding/2;if(AB.w>=0&&AH.isTimeSeries&&AH._scroller.origin){var AJ=AG-AH._scroller.origin.x;if(AJ<=0&&(AJ+t/2>-AH.maxYLblWidth)){AH.needRedrawVerticalLine=true;u.removeChild(AD);return null;}var p=AJ-AH.getChartWidthOnScreen();if((p-t/2)<=0&&p>=0){AH.needRedrawVerticalLine=true;u.removeChild(AD);return null;}}if(AB.w>=0){AG=AG-r/2;}if(AB.h>=0&&((AE>=AB.y-v&&AE<=AB.y+AB.h)||(AE+AF>=AB.y-v&&AE+AF<=AB.y+AB.h)||(AE+AF>=AH.canvas.height-AH.margin.b))){u.removeChild(AD);return null;}if(AB.w>=0&&(((AG>=AB.x&&AG<AB.x+AB.w+z))||AG<AB.x||AG<AH.margin.l||AG+r>AC)){u.removeChild(AD);return null;}if(AH.isTimeSeries&&AB.h>=0){u.style.top=(AH.margin.t-AF/2)+"px";u.style.height=(AH.canvas.height-AH.margin.t-AH.margin.b-1+AF/2)+"px";this.translateCSS(AG,(AE-AH.margin.t)+AF/2,AA,AD);}else{this.translateCSS(AG,AE,AA,AD);AD.style.maxHeight=AF+"px";}AB.x=AG;AB.y=AE;if(AB.h>=0){AB.h=AF;}if(AB.w>=0){AB.w=r;AD.style.textAlign="center";}return AD;},addDataLabel:function n(q,t,v,r){var p=(q.margin.l>q.margin.r)?Z:q.getWidth()-q.margin.r+Z,u=(q.margin.l>q.margin.r)?q.margin.l:q.margin.r;return this.addLabel(q,t,p,v-10,u-Z*2,false,r);},translateCSS:function g(p,u,q,t){var r="translate("+p+"px,"+u+"px)";if(q){r+=" rotate(45deg)";}t.style[J.CSS3_TRANSFORM]=r;},getTouchXYOnWidget:function B(q,p,u){var t=mstrmojo.TouchScroller,r=(t&&u.parent&&t.getScrollPositionTotals(u.parent))||{x:0,y:0};q=q-u.offsetLeft+r.x;p=p-u.offsetTop+r.y;return{touchX:q,touchY:p};},getYValue:function A(u,q){var p=u.canvas.height,t=u.margin,r=u.model.mvalues;return p-t.b-4-((parseFloat(q)-r[0])*u.RTY);},getMasterYValue:function f(t,q,u){var p=t.masterCanvas.height,r=t.model.mvalues;return p-u.b-3-((parseFloat(q)-r[0])*t.MRTY);},getSeriesIndexAndYValue:function C(z,p,AA){var AB=z.model.series,t=AB.length,v=0;y=this.getYValue(z,AB[v].rv[p])||0;var x=AA-y<0?-(AA-y):AA-y,q=x;for(var u=1;u<t;u++){var r=this.getYValue(z,AB[u].rv[p])||0;x=AA-r<0?-(AA-r):AA-r;if(x<q){y=r;q=x;v=u;}}return{y:y,si:v};},getLabelWidthForMargin:function j(p,t){var r=document.createElement("div");r.className="mstrmojo-Chart-lbl";r.innerHTML=t;p.domNode.appendChild(r);var q=r.offsetWidth||60;p.domNode.removeChild(r);return q+Z*2;},animateLineSet:function V(AC,r,AA,v){var AD=[],AB=AC.animationContext,t=AA.length;AB.clearRect(0,0,AC.getWidth(),AC.canvas.height);if(!v.index){v.index=0;}else{if(v.index>=v.rate){this.drawLineSet(AC,AA,false,AB);AC.drawLabels();if(AC.isFillLinesArea){this.fillLinesArea(AC,AA.slice(0));}if(AC.isDrawStartEndPoints){this.drawStartEndPoints(AC,AA,AB,AC.isDrawStartEndPoints);}return ;}}for(var u=0;u<t;u++){var q=AA[u],p=r[u];AD[u]={x:(v.index*(q.x-p.x)/v.rate)+p.x,y:(v.index*(q.y-p.y)/v.rate)+p.y};}this.drawLineSet(AC,AD,false,AB);var z=this;v.index++;window.setTimeout(function(){z.animateLineSet(AC,r,AA,v);},40);},fillLinesArea:function G(q,u){var r=q.canvas.height;u.push({x:q.getWidth()-q.margin.r,y:r-q.margin.b});u.push({x:q.margin.l,y:r-q.margin.b});var v=new Array();if(q.fillinColor){mstrmojo.requiresCls("mstrmojo.color");var t=mstrmojo.color.hex2rgb(q.fillinColor).join(",");v[0]="rgba("+t+", 0.8)";v[1]="rgba("+t+", 0.2)";}else{v=["rgba(255,128,0,0.8)","rgba(255,128,0,0.2)"];}var p=q.animationContext;var t=p.createLinearGradient(0,0,0,r);t.addColorStop(0,v[0]);t.addColorStop(0.75,v[1]);p.fillStyle=t;this.drawLineSet(q,u,true,p);},convertRawValueToMilliseconds:function h(r){var t=Number(r),p=t-((new Date("1/1/1970").getTime()-new Date("12/30/1899").getTime())/F)-k,q=new Date(p*F);return new Date(q.getUTCFullYear(),q.getUTCMonth(),q.getUTCDate()).getTime();},getAncestorBgColor:function D(r){var w=null,v=r,AB=v.modelData?v.modelData:v.model,AA=null;if(v.hasOwnProperty("xtabModel")&&v.xtabModel.hasOwnProperty("docModel")){AA=v.xtabModel.docModel;}if(AA&&AA.defn&&AA.defn.layouts&&AA.defn.layouts.length>0){var z=AA.defn.layouts,t;var q;for(q in z){if(z[q].loaded){t=z[q];}}if(t&&t.hasOwnProperty("units")){var u=t.units;var x=AB.parent;while(x){var p=x.k||null;if(u[p]&&u[p].fmts&&u[p].fmts["background-color"]){w=u[p].fmts["background-color"];break;}else{x=x.parent||null;}}if(!w){if(t.fmts&&t.fmts["background-color"]){w=t.fmts["background-color"];}}}}return w;},isLightColor:function d(v){var q=/^#([0-9a-fA-f]{3}|[0-9a-fA-f]{6})$/,w,p,x,AB,AA,u=false;if(v){var AC,z;if(/^(rgba|RGBA)/.test(v)){z=v.replace(/rgba\(|RGBA\(/,"");z=z.replace(")","");AC=z.split(",");p=AC[0];x=AC[1];AB=AC[2];}else{if(/^(rgb|RGB)/.test(v)){z=v.replace(/rgb\(|RGB\(/,"");z=z.replace(")","");AC=z.split(",");p=AC[0];x=AC[1];AB=AC[2];}else{if(q.test(v)){if(v.length===4){AC="#";for(w=1;w<4;w++){AC+=v.slice(w,w+1).concat(v.slice(w,w+1));}v=AC;}var t=[];for(w=1;w<7;w+=2){t.push(parseInt("0x"+v.slice(w,w+2)));}p=t[0];x=t[1];AB=t[2];}}}AA=(p*299+x*587+AB*114)/1000;if(AA>150){u=true;}}return u;},getPointDistanceSquare:function E(q,p){return(q.x-p.x)*(q.x-p.x)+(q.y-p.y)*(q.y-p.y);},truncateTextToLine:function(q,AC,AG){AC.className=q.className;AC.style.whiteSpace="nowrap";var w=AC.innerHTML=q.innerHTML;var t=parseInt(q.offsetWidth)-parseInt(q.style.width);var AE=AG*parseInt(q.style.width)+t;var u=w;if(AC.offsetWidth>AE){var x=0,r=w.length-1;while(x<=r){var AB=Math.round((x+r)/2);var AF=w.substr(0,AB+1);var AD=w.substr(0,AB+2);AC.innerHTML=AF;var AA=AC.offsetWidth;AC.innerHTML=AD;var v=AC.offsetWidth;if(AA<=AE&&v>AE){break;}else{if(AA>AE){r=AB-1;}else{if(v<=AE){x=AB+1;}}}}u=w.substr(0,AB+1);if(u.length<w.length){if(u.charAt(u.length-1)===" "){u=u.substr(0,u.length-1);}var z=u.lastIndexOf(" ");var p=u.length-1-z;if(p>=2&&p<=8){u=u.substr(0,u.length-p-1)+"...";}else{u=u.substr(0,u.length-3)+"...";}}}q.innerHTML=u;},getLen:function(t,r,q,p){r.innerHTML=t;var u=r.offsetWidth+q-p;return u;},splitWordIfTooLong:function(u,AF,AC,x,AA){var AE=u.split(" ");var z=[];var AB=AE.length;var v=0;var t=0;for(v=0;v<AB;v++){var q=AE[v];while(true){var AG=this.getLen(q,AF,AA,x);if(AG>AC){var AD=(AC/AG)*q.length;var p=Math.round(AD);while(p>0){var w=q.substr(0,p);var r=this.getLen(w,AF,AA,x);if(r<=AC){z.push(w);break;}else{p--;}}q=q.substr(p,q.length-p);}else{z.push(q);break;}}}return z.join(" ");},truncateTextToLineWithWordWrap:function(AP,AL,AI){AL.className=AP.className;AL.style.whiteSpace="nowrap";var AH=7;var z=-1;if(AP.style&&AP.style.width&&AP.style.width.length>0){z=parseFloat(AP.style.width);}if(z<0){z=parseFloat(mstrmojo.css.getComputedStyle(AP).width);}var AJ=AP.innerHTML;var AO=parseFloat(AP.offsetWidth)-z;AJ=this.splitWordIfTooLong(AJ,AL,z,AO,AH);var AB=AJ.split(" ");var u=[];var AE=[];var AN=0;var p=0;var AG=AB.length;AL.innerHTML="&nbsp;";var AQ=AL.offsetWidth-AO;AE.push(0);for(AN=0;AN<AG;AN++){var q=this.getLen(AB[AN],AL,AH,AO);if(q>z){var AA=AB[AN];var AM=(z/q)*AA.length;AB[AN]=AA.substr(0,parseInt(AM));q=z;}u.push(q);p+=q;AE.push(p);if(AN!==AG-1){p+=AQ;}}var AD=0,AK=0;var AC=AI;for(;AK<AE.length;){var x=AE[AK]-AE[AD];if(AD>0&&AK!=AD){x-=AQ;}var w=AE[AK+1]-AE[AD];if(AD>0&&AK+1!=AD){w-=AQ;}if(x<=z&&((AK+1==AE.length)||(w>z))){AC--;if(AC==0||AK===AG){break;}else{AD=AK;AK++;}}else{AK++;}}if(AK>AG){AK=AG;}var AF=AE[AK]-AE[AD];if(AD>0&&AK!=AD){AF-=AQ;}var AR;if(AK>=AG&&AF<z){AR=AB.join(" ");}else{AR=AB.slice(0,AK).join(" ");var t=this.getLen("...",AL,AH,AO);if(AF+t<=z){AR+="...";}else{if(AR.charAt(AR.length-1)===" "){AR=AR.substr(0,AR.length-1);}var v=AR.lastIndexOf(" ");var r=AR.length-1-v;if(r===3){AR=AR.substr(0,AR.length-3)+" ...";}else{AR=AR.substr(0,AR.length-3)+"...";}}}AP.innerHTML=AR;},getLen2:function(w,q,p){var r=p;var t=r.getContext("2d");t.font=q;t.textAlign="center";t.fillStyle="blue";var v=t.measureText(w);var u=v.width;return u;},splitWordIfTooLong2:function(v,AC,u,w){var AE=v.split(" ");var AA=[];var AB=AE.length;var x=0;var t=0;for(x=0;x<AB;x++){var q=AE[x];while(true){var AF=this.getLen2(q,u,w);if(AF>AC){var AD=(AC/AF)*q.length;var p=Math.max(Math.round(AD),1);while(p>0){var z=q.substr(0,p);var r=this.getLen2(z,u,w);if(r<=AC||p==1){AA.push(z);break;}else{p--;}}q=q.substr(p,q.length-p);}else{AA.push(q);break;}}}return AA.join(" ");},getComputedFontStyle:function P(p){var q=p.fontStyle+" "+p.fontWeight+" "+p.fontSize+"/"+p.fontVariant+" "+p.fontFamily;return q;},truncateTextToLineWithWordWrap2:function(AS,AL,AC,AK){var AB=-1;if(AS.style&&AS.style.width&&AS.style.width.length>0){var AP=0;var AR=mstrmojo.css.getComputedStyle(AS);if(AR.paddingLeft){AP+=parseFloat(AR.paddingLeft);}if(AR.paddingRight){AP+=parseFloat(AR.paddingRight);}var AQ=AS.offsetWidth;AB=AQ?AQ-AP:parseInt(AS.style.width);}if(AB<0){AS.innerHTML="...";return ;}var x=mstrmojo.css.getComputedStyle(AS);var r=this.getComputedFontStyle(x);AL=this.splitWordIfTooLong2(AL,AB,r,AC);var AE=AL.split(" ");var v=[];var AH=[];var AO=0;var p=0;var AJ=AE.length;var AT=this.getLen2(" ",r,AC);AH.push(0);for(AO=0;AO<AJ;AO++){var q=this.getLen2(AE[AO],r,AC);if(q>AB){var AD=AE[AO];var AN=(AB/q)*AD.length;AE[AO]=AD.substr(0,parseInt(AN));q=AB;}v.push(q);p+=q;AH.push(p);if(AO!==AJ-1){p+=AT;}}var AG=0,AM=0;var AF=AK;for(;AM<AH.length;){var AA=AH[AM]-AH[AG];if(AG>0&&AM!=AG){AA-=AT;}var z=AH[AM+1]-AH[AG];if(AG>0&&AM+1!=AG){z-=AT;}if(AA<=AB&&((AM+1==AH.length)||(z>AB))){AF--;if(AF==0||AM===AJ){break;}else{AG=AM;AM++;}}else{AM++;}}if(AM>AJ){AM=AJ;}var AI=AH[AM]-AH[AG];if(AG>0&&AM!=AG){AI-=AT;}var AU;if(AM>=AJ&&AI<AB){AU=AE.join(" ");}else{AU=AE.slice(0,AM).join(" ");var u=this.getLen2("...",r,AC);if(AI+u<=AB){AU+="...";}else{if(AU.charAt(AU.length-1)===" "){AU=AU.substr(0,AU.length-1);}var w=AU.lastIndexOf(" ");var t=AU.length-1-w;if(t===3){AU=AU.substr(0,AU.length-3)+" ...";}else{AU=AU.substr(0,AU.length-3)+"...";}}}AS.innerHTML=AU;return AU.indexOf("...")>-1;},truncateDivContent:function(v,AA,r){AA.innerHTML=v;if(AA.offsetHeight>r){var w=0,q=v.length-1;while(w<=q){var AB=Math.round((w+q)/2);var AD=v.substr(0,AB+1);var AC=v.substr(0,AB+2);AA.innerHTML=AD;var z=AA.offsetHeight;AA.innerHTML=AC;var u=AA.offsetHeight;if(z<=r&&u>r){break;}else{if(z>r){q=AB-1;}else{if(u<=r){w=AB+1;}}}}var t=v.substr(0,AB+1);if(t.length<v.length){if(t.charAt(t.length-1)===" "){t=t.substr(0,t.length-1);}var x=t.lastIndexOf(" ");var p=t.length-1-x;if(p>=2&&p<=8){t=t.substr(0,t.length-p-1)+"...";}else{t=t.substr(0,t.length-3)+"...";}}return t;}else{return v;}},positionTooltip:function(AI,r,AN,x){if(!AI||!r||!AN){return ;}if(isNaN(x)){x=45;}var AK=AN.offsetWidth,z=AN.offsetHeight,v=AI.offsetWidth,AH=AI.offsetHeight,AD=AI.style,AA=0,AL=0;function w(){return v+x<r.x&&AH<z;}function t(){return AH+x<r.y&&v<AK;}function u(){return r.x+x+v<AK&&AH<z;}function AC(){return r.y+x+AH<z&&v<AK;}function q(){return r.x>v/2&&(AK-r.x)>v/2;}function p(){return r.y>AH/2&&(z-r.y)>AH/2;}function AM(){return t()&&w();}function AJ(){return t()&&q();}function AG(){return t()&&u();}function AO(){return w()&&p();}function AF(){return AC()&&w();}function AP(){return u()&&p();}function AE(){return AC()&&q();}function AB(){return AC()&&u();}if(AM()){AA=r.x-x-v;AL=r.y-x-AH;}else{if(AJ()){AA=r.x-v/2;AL=r.y-x-AH;}else{if(AG()){AA=r.x+x;AL=r.y-x-AH;}else{if(AO()){AA=r.x-x-v;AL=r.y-AH/2;}else{if(AF()){AA=r.x-x-v;AL=r.y+x;}else{if(AP()){AA=r.x+x;AL=r.y-AH/2;}else{if(AE()){AA=r.x-v/2;AL=r.y+x;}else{if(AB()){AA=r.x+x;AL=r.y+x;}}}}}}}}AD.left=AA+"px";AD.top=AL+"px";}});})();(function(){mstrmojo.requiresCls("mstrmojo.dom");function G(J){return(J&&J.id);}mstrmojo._HasScrollbox=mstrmojo.provide("mstrmojo._HasScrollbox",{_mixinName:"mstrmojo._HasScrollbox",scrollListeners:null,scrollListenerCount:0,scrollInterval:50,scrollboxNode:undefined,scrollTo:function F(L,K){var J=this.scrollboxNode;J.scrollLeft=L.x;J.scrollTop=L.y;if(K){this.notifyScrollListeners(L);}},connectScrollbox:function E(K){if(!G(K)){return ;}var L=this.scrollListeners,J=K.id;if(!L){L={};this.scrollListeners=L;}if(!L[J]){L[J]=K;this.scrollListenerCount++;if(this.scrollListenerCount===1){this._attachScrollDom();}}},disconnectScrollbox:function D(K){if(!G(K)){return ;}var L=this.scrollListeners,J=K.id;if(L&&L.hasOwnProperty(J)){delete this.scrollListeners[J];this.scrollListenerCount--;if(!this.scrollListenerCount){this._detachScrollDom();}}},notifyScrollListeners:function C(K){var N=K||this.getScrollPos(),M=N.y,L=N.x;this.scrollboxTop=M;this.scrollboxLeft=L;this.scrollboxRight=L+this.scrollboxWidth;this.scrollboxBottom=M+this.scrollboxHeight;var J=this.scrollListeners,O;for(O in J){J[O].onscroll(this);}},getScrollPos:function H(){var J=this.scrollboxNode;return{x:J.scrollLeft,y:J.scrollTop};},_attachScrollDom:function A(){var M=this.scrollboxNode;if(M){var L=this.usesTouches;if(!L){if(!this.scrollCallback){var K=this.id;this.scrollCallback=function(){mstrmojo.all[K].notifyScrollListeners();};}mstrmojo.dom.attachBufferedEvent(M,"scroll",this.scrollCallback,this.scrollInterval);}if(this.scrollboxTop===null){this.scrollboxTop=L?0:M.scrollTop;}if(this.scrollboxLeft===null){this.scrollboxLeft=L?0:M.scrollLeft;}var J=function(P){var O=P.toLowerCase();var N=M.style[O];return(!isNaN(N)&&N.charAt(N.length-1)!=="%")?parseInt(N,10):M["client"+P];};if(this.scrollboxHeight===null){this.scrollboxHeight=J("Height");}if(this.scrollboxWidth===null){this.scrollboxWidth=J("Width");}this.scrollboxBottom=this.scrollboxTop+this.scrollboxHeight;this.scrollboxRight=this.scrollboxLeft+this.scrollboxWidth;this._attachedScrollbox=M;}},_detachScrollDom:function I(){var J=this._attachedScrollbox;if(J&&this.scrollCallback){mstrmojo.dom.detachBufferedEvent(J,"scroll",this.scrollCallback,this.scrollInterval);}delete this._attachedScrollbox;},scrollboxTop:null,scrollboxLeft:null,scrollboxHeight:null,scrollboxBottom:null,buildRendering:function B(){this._detachScrollDom();this._super();if(this.scrollListenerCount){this._attachScrollDom();}}});}());(function(){mstrmojo.requiresCls("mstrmojo.dom");var J=mstrmojo.dom;var I=1,C=2;function E(P){var Q=this.defn,R=Q.vc,S=Q.hc;if(!P||P.length===0||(!R&&!S)){return{};}return{v:!!R,h:!!S};}function B(P){return parseInt(this.getFormats()[(P===I)?"height":"width"],10);}function H(Q){var P=this.getFormats()["max-"+((Q===I)?"height":"width")];return P&&parseInt(P,10);}function G(U,S){var Q=this.defn,R=U&&(U.dimNode||U.domNode),P=Q.ck&&Q.ck[U&&(U.k||U.content.k)];if(R&&P&&(P&S)>0){return R;}return null;}function F(Q,U,S,Z){var P=parseInt(S.style[(U===I)?"top":"left"],10)||(Q.fmts&&parseInt(Q.fmts[(U===I)?"top":"left"],10))||0;if(!!Z){return P+Z;}var R=(Q.fmts&&Q.fmts.fx)||{},V=(!J.isIE7&&(R.rt===1||R.rt===3))?((U===I)?C:I):U,X=(V===I)?"Height":"Width";Z=S["offset"+X]+(R.ds||0);if(!J.isDXIE&&((U===I&&R.rt===3)||(U===C&&R.rt===1))){P=P-Z;}var W=P+Z;if(J.isIE7&&X==="Width"&&Q instanceof mstrmojo.XtabBase){var Y=Q.contentNode.offsetWidth;if(W<Y){W+=Y;}}return W;}function L(P,Q,R){if(P>Q){if(R){P=Math.min(P,R);}return P;}return Q;}function D(W,U,V){var P=this.getCanGrowShrinkNode(),R=(W===I)?"Height":"Width",Q=R.toLowerCase(),S=parseInt(P.style[Q],10);if(U&&U!==S&&!(U<S&&!!V)){S=U;P.style[Q]=S+"px";this.afterCanGrowShrink();}this["_fixed"+R]=S;}function A(X,S,V){var W=H.call(this,S),Y=B.call(this,S),U=X.length,Q;for(Q=0;Q<U;Q++){var P=X[Q],R=G.call(this,P,S);if(!R){continue;}Y=L(F.call(this,P,S,R),Y,W);if(Y===W){break;}}D.call(this,S,Y,V);}function O(V,U,Q,S){var R=G.call(this,V,U);if(!R){return ;}var P=F.call(this,V,U,R,Q);D.call(this,U,L(P,B.call(this,U),H.call(this,U)),S);}mstrmojo._CanGrowOrShrink=mstrmojo.provide("mstrmojo._CanGrowOrShrink",{getCanGrowShrinkNode:function N(){return this.domNode;},performCanGrowCanShrink:function M(Q,R){var P=E.call(this,Q);if(P.v){A.call(this,Q,I,R);}if(P.h){A.call(this,Q,C,R);}},fixedSizeCanGrowShrink:function K(W,P,U,V){var R=E.call(this,W&&[W]);var S=parseInt(P,10),Q=parseInt(U,10);if(R.v&&!isNaN(S)){O.call(this,W,I,S,V);}if(R.h&&!isNaN(Q)){O.call(this,W,C,Q,V);}},afterCanGrowShrink:mstrmojo.emptyFn});}());(function(){mstrmojo.requiresCls("mstrmojo.dom","mstrmojo.array");var H=mstrmojo.array,G=mstrmojo.dom;mstrmojo._IsDocXtab={_mixinName:"mstrmojo._IsDocXtab",isDocXtab:true,formatHandlers:{domNode:["RW","T","font"],msgNode:["height","background-color"],viewport:["D","background-color","B","fx"]},preBuildRendering:function B(){var I=this.getFormats(),L="",K=function K(M){if(I[M]){var N=this[M]||I[M];this[M]=N;if(this.isFullScreenWidget){I[M]=N;}this[M+"Limit"]=parseInt(N,10);}};K.call(this,"height");K.call(this,"width");var J=function(P,O){var M=I[P];if(M&&M.charAt(M.length-1)!=="%"){var N=parseInt(M,10);if(!isNaN(N)){if(O){N-=O;}L+=P+":"+N+"px;";}}return null;};J("height",0);J("width",0);this.scrollboxNodeCssText=L;return this._super();},postBuildRendering:function D(){var J=this._super();var I=this.gridData;if((I.afw||I.afc)&&this.hasCustomScrollbar&&!this.node.data.eg&&this.scrollboxNode.firstChild){this.scrollboxNode.firstChild.style.width=this.getFormats().width;}return J;},resize:function A(){this.clearCache();var K=this.getFormats(),J=parseInt(K.height,10),I=parseInt(K.width,10);if(I>0&&J>0){if(!this.visible&&this.forcedHidden){this.set("visible",true);this.forcedHidden=false;}H.forEach([this.scrollboxNode,this.viewport],function(M){var L=M.style;L.height=J+"px";L.width=I+"px";});if(this.scrollboxNode){this.scrollboxHeightFixed=J&&(J!=="auto");if(this.scrollboxHeightFixed){this.scrollboxHeight=parseInt(J,10);this.heightLimit=this.scrollboxHeight;this.scrollboxBottom=this.scrollboxTop+J;}if(I>0){this.widthLimit=I;}if(this.lockHeadersCase){this.resizeScrollBox(G.isIE);}}this.delegateGridAction(function(L){if(L&&L.onscroll){L.onscroll();}},"scrollOnResize");if(!(this.gridData&&this.gridData.eg!==undefined)){this.onGridWidthChanged();this.refreshResizeHandlers();}if(this.lockHeadersCase){this._refreshClonedNodes();}}else{if(this.visible){this.set("visible",false);this.forcedHidden=true;}}},renderPortalState:function E(){this.clearCache();this.unrender();this.render();},unrender:function F(I){this.clearCache();if(this._super){this._super(I);}},defaultAction:function C(N,I){if(this._super(N,I)){var M=this.model.sti,L=M&&M.titleId,K=M&&M.deselectCurrent;this._currentSelectedTD=K?undefined:N;if(L){var J=this.zone;this.delegateGridAction(function(P){var O=P.domNode,Q=O&&O.firstChild;if(!J&&Q&&(N.offsetParent===Q||N.offsetParent===O)){J=P;}},"defaultClickAction");if(J){J.clearHilites(L);if(!K){J.setHilites(L,N);}J.hiliteKey=L;this.model.sti=null;}}return true;}return false;}};}());(function(){mstrmojo.requiresCls("mstrmojo.dom");mstrmojo.fx={enabled:true};var E=mstrmojo.dom;mstrmojo.fx._Effect=mstrmojo.declare(null,null,{scriptClass:"mstrmojo.fx._Effect",duration:500,interval:50,delay:null,target:null,getTarget:null,widget:null,slot:null,preStart:null,postStart:null,onCancel:null,onEnd:null,revertOnCancel:true,isPlaying:false,started:false,init:function R(X){mstrmojo.hash.copy(X,this);},play:function C(){this.isPlaying=true;this.started=false;if(this.delay){var X=this;this.delayTimer=window.setTimeout(function(){X._start();X=null;},this.delay);}else{this._start();}},pause:function H(){if(this.delayTimer){window.clearTimeout(this.delayTimer);delete this.delayTimer;}if(this.timer){window.clearInterval(this.timer);delete this.timer;}this.isPlaying=false;},cancel:function V(){this.pause();if(this.started){if(this.revertOnCancel){this.counter=0;this.exec();}if(this.onCancel){this.onCancel();}this.started=false;}},_start:function F(){this.started=true;this._doTarget();this.steps=Math.max(Math.ceil(this.duration/this.interval),1);var X=this.ease;if(typeof X==="string"){this.ease=mstrmojo.registry.ref(X);}if(this._doPreStart()===false){this.started=false;this.isPlaying=false;return ;}this.counter=0;this.exec();this.counter++;this._doPostStart();if(this.counter>=this.steps){this._end();}else{var Y=this;if(this.timer){window.clearInterval(this.timer);}this.timer=window.setInterval(function Z(){if(Y){Y.exec();Y.counter++;if(Y.counter>=Y.steps){Y._end();Y=null;}}},this.interval);}},exec:null,_end:function D(){this.pause();this.started=false;if(this.onEnd){this.onEnd();}},_doTarget:function U(){if(this.getTarget){this.target=this.getTarget();}else{if(this.widget){this.target=this.widget[this.slot||"domNode"];}else{if(this.target){var Y=this.target;if(Y&&this.slot&&Y.scriptClass){var Z=Y[this.slot];if(Z){this.widget=Y;this.target=Z;}}}}}if(!this.target){var X=this;while(X=X.parent){if(!X||X.domNode){break;}}if(X){this.widget=X;this.target=X[this.slot||"domNode"];}}},_doPreStart:function N(){if(this.preStart){return this.preStart();}},_doPostStart:function S(){if(this.postStart){this.postStart();}}});function M(a,b){var Y=a.children,X=(Y&&Y.length)||0,Z;for(Z=0;Z<X;Z++){Y[Z][b]();}}mstrmojo.fx.Parallel=mstrmojo.declare(mstrmojo.fx._Effect,null,{scriptClass:"mstrmojo.fx.Parallel",init:function R(a){this._super(a);var Z=this.children;mstrmojo.registry.refArray(Z);var X=(Z&&Z.length)||0,Y;for(Y=0;Y<X;Y++){Z[Y].parent=this;}},_start:function F(){this.started=true;if(this.preStart){this.preStart();}M(this,"play");if(this.postStart){this.postStart();}},pause:function H(){M(this,"pause");},cancel:function V(){M(this,"cancel");}});mstrmojo.fx.AnimateProp=mstrmojo.declare(mstrmojo.fx._Effect,null,{scriptClass:"mstrmojo.fx.AnimateProp",props:null,_start:function O(){var Z=this.props,a;for(a in Z){var Y=Z[a],X=Y.ease;if(typeof X==="string"){Y.ease=mstrmojo.registry.ref(X,{dontInst:true});}}this._super();},exec:function P(){var a=this.props,b;for(b in a){var Y=a[b],X=(Y.ease||mstrmojo.ease.sin)(this.counter,Y.start,Y.stop-Y.start,this.steps-1);if(Y.fn){X=Y.fn(X);}if(Y.suffix){X+=Y.suffix;}var Z=Y.isStyle===false?this.target:this.target.style;Z[b]=X;}}});mstrmojo.fx.Typewriter=mstrmojo.declare(mstrmojo.fx._Effect,null,{scriptClass:"mstrmojo.fx.Typewriter",charGroupSize:1,srcProp:"text",_doPreStart:function(){this._super();this._dynStop=false;if(this.stop==null){var b=this.srcProp,Z;if(b){var X=this.widget||this.parent;Z=X&&X[b];if((Z!=null)&&(typeof (Z)!=="string")){Z=String(Z);}}this.stop=Z;this._dynStop=true;}if(this.stop==null){this.stop="";}var a=this.target,c=null,Y=1;if(a){a.innerHTML="";c=document.createTextNode("");a.appendChild(c);Y=Math.max(Math.floor(this.stop.length/this.steps),1);}this.targetTextNode=c;this.charGroupSize=Y;},exec:function(){var Y=this.targetTextNode;if(!Y){return ;}var X;if(this.counter>=this.steps-1){X=this.stop;}else{if(this.counter===0){X="";}else{X=this.stop.substring(0,this.charGroupSize*this.counter)+"_";}}Y.nodeValue=X;},_end:function D(){this._super();if(this._dynStop){this.stop=null;delete this._dynStop;}},cancel:function V(){if(this._dynStop){this.stop=null;delete this._dynStop;}}});mstrmojo.requiresCls("mstrmojo.dom");mstrmojo.fx.Fade=mstrmojo.declare(mstrmojo.fx._Effect,null,{scriptClass:"mstrmojo.fx.Fade",start:null,stop:null,ease:null,suffix:null,exec:function P(X){if(X==null){X=(this.ease||mstrmojo.ease.sin)(this.counter,this.start,this.stop-this.start,this.steps-1);}if(E.isIE&&!E.isWinPhone){this.target.style.filter="alpha(opacity="+parseInt(X*100,10)+")";}else{this.target.style.opacity=X;}}});mstrmojo.fx.FadeOut=mstrmojo.declare(mstrmojo.fx.Fade,null,{scriptClass:"mstrmojo.fx.FadeOut",start:1,stop:0,revertOnCancel:true,cssDisplay:"block",_end:function D(){if(this.cssDisplay){this.target.style.display="none";this.exec(this.start);}this._super();},cancel:function V(){if(this.started&&this.cssDisplay){this.target.style.display=this.cssDisplay;}this._super();}});mstrmojo.fx.FadeIn=mstrmojo.declare(mstrmojo.fx.Fade,null,{scriptClass:"mstrmojo.fx.FadeIn",start:0,stop:1,revertOnCancel:true,cssDisplay:"block",_doPostStart:function W(){if(this.cssDisplay){this.target.style.display=this.cssDisplay;}this._super();},cancel:function(){if(this.started&&this.revertOnCancel&&this.cssDisplay){this.target.style.display="none";}this._super();}});function I(Z,Y,a){var X=Math.pow(10,a||2);if(Y){return parseInt(X*Z/Y,10)/X;}return parseInt(X*Z,10)/X;}mstrmojo.ease={linear:function L(Y,X,a,Z){if(Y===Z){return X+a;}if(Y===0){return X;}return X+a*I(Y,Z);},sin:function A(Y,X,a,Z){return X+a*Math.sin((Math.PI/2)*Y/Z);},cos:function B(Y,X,a,Z){return X+a*Math.cos((Math.PI/2)*(1-Y/Z));},sincos:function K(Y,X,a,Z){if(Y>Z/2){return X+a*Math.cos((Math.PI/2)*(1-Y/Z));}return X+a*Math.sin((Math.PI/2)*Y/Z);},cossin:function Q(Y,X,a,Z){if(Y>Z/2){return X+a*Math.sin((Math.PI/2)*Y/Z);}return X+a*Math.cos((Math.PI/2)*(1-Y/Z));},bounce:function G(Y,X,a,Z){if((Y/=Z)<(1/2.75)){return a*(7.5625*Y*Y)+X;}if(Y<(2/2.75)){return a*(7.5625*(Y-=(1.5/2.75))*Y+0.75)+X;}if(Y<(2.5/2.75)){return a*(7.5625*(Y-=(2.25/2.75))*Y+0.9375)+X;}return a*(7.5625*(Y-=(2.625/2.75))*Y+0.984375)+X;},shake:function J(Y,X,a,Z){if(Y<Z/2){return X+a*I(Math.sin(2*Math.PI*Y/8),null,2)*2*Y/Z;}return X+a*I(Math.sin(2*Math.PI*Y/8),null,2)*2*(1-Y/Z);}};}());(function(){mstrmojo.requiresCls("mstrmojo.dom");var B=mstrmojo.dom;mstrmojo.ui.pathbar._PreAppExit=mstrmojo.provide("mstrmojo.ui.pathbar._PreAppExit",{_mixinName:"mstrmojo.ui.pathbar._PreAppExit",onmouseover:function C(E){if(this._super){this._super(E);}if(this.handleMouseOver){var H=E.target||B.eventTarget(E.hWin,E.e),F=B.findAncestorByAttr(H,"idx",true,this.domNode),D=F&&parseInt(F.value,10),G=this.items[D];this.handleMouseOver(E,G);}},onclick:function A(E){var J=E.target||B.eventTarget(E.hWin,E.e),H=B.findAncestorByAttr(J,"idx",true,this.domNode),D=H&&parseInt(H.value,10),I=this.items[D];if(this.handleClick){var F=this.handleClick(E,I);if(F){E.cancel();return ;}}if(this._super){this._super(E);}if(!J.attributes.menu&&I&&I.en!==false){var G=function(){mstrmojo.form.sendLink(I.href,I.target);};if(mstrApp.onNavigateOut(I,G)!==true){G();}return false;}return true;}});}());(function(){mstrmojo.requiresCls("mstrmojo.func");mstrmojo.ACL.UserDataService=mstrmojo.provide("mstrmojo.ACL.UserDataService",{topgroups:null,userCandidates:null,getMembers:function(G,E){var F={taskId:"getUserEntityInfo",blockBegin:G.blockBegin,blockCount:G.blockCount,userEntityID:G.data.did,userEntityName:G.data.n||"",incremental:true,outputElements:G.outputElements||3};mstrmojo.xhr.request("POST",mstrConfig.taskURL,E,F);},getTopLevelGroups:function D(G,F){var E=this;if(this.topgroups){F.success({items:this.topgroups});return ;}F.success=mstrmojo.func.composite([F.success,function(H){E.topgroups=H.items;}]);this.getUsers({topGroupsOnly:true},F);},searchUserCandidates:function C(F,I,G,E){var H={blockBegin:1,blockCount:G,searchPattern:F,nameWildcards:I?4:2};this.getUsers(H,E);},getUserCandidates:function B(H,G){if(this.userCandidates){G.success(this.userCandidates);return ;}var E=G.success,F=this;G.success=function(J){F.userCandidates={items:J.items,isComplete:(parseInt(J.bc,10)===-1||(J.bb+J.bc>J.sz))};E(F.userCandidates);};var I={blockBegin:1,blockCount:H,nameWildcards:1};this.getUsers(I,G);},getUsers:function A(G,E){var F={taskId:"getUserServices"};mstrmojo.hash.copy(G,F);mstrmojo.xhr.request("POST",mstrConfig.taskURL,E,F);}});}());(function(){mstrmojo.requiresCls("mstrmojo.func","mstrmojo.url");var B=mstrmojo.func,A=mstrmojo.url;mstrmojo.imageUtils=mstrmojo.provide("mstrmojo.imageUtils",{compress:function(F,K,J){var H="image/jpeg";if(J==="png"||J==="image/png"){H="image/png";}var G=parseInt(K);G=G>1&&G<=100?G:100;var I=document.createElement("canvas");if(!!(I.getContext&&I.getContext("2d"))){I.width=F.naturalWidth;I.height=F.naturalHeight;I.getContext("2d").drawImage(F,0,0);var E=I.toDataURL(H,G/100);var D=new Image();D.src=E;return D;}return F;},dataURLToBlob:function(J){var D=";base64,",I,K,E;J=J||"";if(J.indexOf(D)===-1){I=J.split(",");K=I[0].split(":")[1];E=decodeURIComponent(I[1]);return new Blob([E],{type:K});}I=J.split(D);K=I[0].split(":")[1];E=window.atob(I[1]);var H=E.length;var G=new Uint8Array(H);for(var F=0;F<H;++F){G[F]=E.charCodeAt(F);}return new Blob([G],{type:K});},isImageAccessible:function C(F,G){var E=document.createElement("img");var D=function(){E=null;};if(mstrApp&&mstrApp.getWSLiveMode&&mstrApp.getWSLiveMode()&&F.indexOf(";base64,")===-1){E.src=A.getAbsoluteURL(F,window.FormWrapper.getDossierServerURL());}else{E.src=F;}E.onload=B.composite([G&&G.success||mstrmojo.emptyFn,D]);E.onerror=B.composite([G&&G.failure||mstrmojo.emptyFn,D]);}});})();(function(){mstrmojo.requiresCls("mstrmojo.array","mstrmojo.func","mstrmojo.vi.controllers.EnumEvents");var E=mstrmojo.array,A=mstrmojo.func,B=mstrmojo.vi.controllers.EnumEvents;mstrmojo.vi.controllers.ControlUtils=mstrmojo.provide("mstrmojo.vi.controllers.ControlUtils",{findNewSelectedIndex:function C(H,J,L){H.sort(function(N,M){return N-M;});var F=H.indexOf(J);var I={};E.forEach(H,function(M){I[M]=true;});var K=1;if(J+(H.length-F)===L){K=-1;}var G=J+K;while(I[G]){G+=K;}return G;},rebuildAndUpdateTOCcallback:function D(){var F=this;return A.wrapMethods(F.getRebuildCallback(),{success:function(){F.raiseEvent({name:B.UPDATE_TOC});}});}});})();(function(){mstrmojo.requiresCls("mstrmojo.EnumReadystate");var D=mstrmojo.EnumReadystate;var A=1200;var C=function(F,E){if(E){E.style.display=F?"block":"none";}};mstrmojo._HasWaitIcon={waitHandle:null,postBuildRendering:function B(){if(!this._rsl){var E=this.id;this._rsl=this.defn.attachEventListener("readyStateChange",E,function(G){if(!this.hasRendered){return ;}switch(G.value){case D.WAITING:if(!this.waitIcon&&this.domNode){var H=document.createElement("div");H.className="mojo-overlay-wait";H.innerHTML='<div class="overlay"></div><div class="icon"></div>';this.domNode.appendChild(H);this.addSlots({waitIcon:H});}var F=this.waitIcon;if(A){this.waitHandle=window.setTimeout(function(){if(mstrmojo.all[E]){mstrmojo.all[E].waitHandle=null;}C(true,F);},A);}else{C(true,F);}break;case D.IDLE:if(this.waitHandle){window.clearTimeout(this.waitHandle);this.waitHandle=null;}C(false,this.waitIcon);break;}});}return this._super();}};}());(function(){mstrmojo.requiresCls("mstrmojo.EnumReadystate");var C=mstrmojo.EnumReadystate;function E(G){return(G.getKey&&G.getKey())||G.k;}mstrmojo._IsDocController={_mixinName:"mstrmojo._IsDocController",_getXtabCallback:function(L,H){var G={},J=G[E(L)]=L.defn,K=this,I=K.model;return I.newCallback({submission:function(){if(J.set){J.set("readyState",C.WAITING);}},success:function(N){var M=N.pukeys,O=M&&M.split("\u001E");if(M){G=I.getUnitDefinitions(M);}I.partialUpdate(N.data,G,H===false?undefined:N.defn,O,N.puFilters);},failure:function(M){if(!(mstrApp.isSingleTier&&M.code===403)){mstrmojo.alert(M.code+": "+M.message);}},complete:function(){if(J.set){J.set("readyState",C.IDLE);}K.docRequestComplete();}});},_addNodeKeyToAction:function(G,H){H.nodeKey=E(G);return H;},onGridSelector:function(H,K){var G=this.model,J=[].concat(G.getTargetInfoWin(K.ifw)).concat(G.getTargetInfoWin(K.tks));K.sid=H.sid;if(H.isInFilterPanel&&H.isInFilterPanel()&&H.filterCtrl){H.filterCtrl.cacheUpdateAction(K);}else{G.slice(K);}if(J&&J.length){var I;for(I=0;I<J.length;I++){G.showInfoWin(J[I],K.anchor,"h",true,null,K.sid);}}},onVisSelector:function(H,J){if(J.anchor){var G=this.model,I=G.getTargetInfoWin(J.tks);if(I&&I.length){G.showInfoWin(I[0],J.anchor,"h",true);}}if(H.xtabModel&&H.xtabModel.docModel&&H.xtabModel.docModel.slice){H.xtabModel.docModel.slice(J);}},isInRequest:function D(){var G=!!this._inProcess;if(!G){this._inProcess=true;}return G;},docRequestComplete:function F(){this._inProcess=false;},nudgeWidget:mstrmojo.emptyFn,getGroupByElements:function B(I){var M=[],L;while(I){L=I.node&&I.node.data&&I.node.data.pbes;if(L){break;}I=I.parent;}if(L){var J=this.model.data.elems;var H=L.length,K;for(K=0;K<H;K++){var G=L[K];M.push(isNaN(G)?G:J&&J[G]);}}return M;},setData:function A(H,J){var G=this.view,I=J;if(J&&G&&G.unloadLayouts){G.unloadLayouts(null,false);I=false;}this.model.loadLayout(H,I);if(this.hasPageBy&&this.hasPageBy()){this.getPageByTree(true);}}};}());(function(){mstrmojo.requiresCls("mstrmojo.array");var A=mstrmojo,D=A.array;mstrmojo.vi.util.TemplateUtils=mstrmojo.provide("mstrmojo.vi.util.TemplateUtils",{getTemplateUnits:function B(F){var E=[].concat(F.mx);(F.rows||[]).concat(F.cols||[]).forEach(function(G){if(G.did!=="-1"){E.push({did:G.did,t:G.t,n:G.n});}});return E;},findUnitsById:function C(H,F){var E=mstrmojo.vi.util.TemplateUtils.getTemplateUnits(H),G=[];D.ensureArray(F).forEach(function(K){var J=D.find(E,"did",K),I=J>-1?E[J]:null;if(I){G.push(I);}});return G;}});}());(function(){mstrmojo.requiresCls("mstrmojo.array");var E="*",A=".",C="-",J="_",H="<";var M=new RegExp("[\\"+E+"\\"+A+"\\"+C+"\\"+J+"\\"+H+"]","g"),G=E+"$&";mstrmojo.Serializer={scriptClass:"mstrmojo.Serializer",serializeValueGroup:function F(B){mstrmojo.array.forEach(B,function(D,K){B[K]=mstrmojo.Serializer.serializeValues(D);});return C+this.serializeValues(B)+J;},serializeValues:function I(D){var B=[];mstrmojo.array.forEach(D,function(K){if(typeof K==="Boolean"){K=K?"1":"0";}B.push(String(K).replace(M,G));});return B.join(A);}};}());(function(){mstrmojo.requiresCls("mstrmojo.array");var I=mstrmojo.array,Q=mstrmojo.desc(2412,"Default"),P=mstrmojo.desc(3433,"Font"),K=mstrmojo.desc(3434,"Number"),D=mstrmojo.desc(3435,"Alignment"),N=mstrmojo.desc(2886,"Borders"),E=mstrmojo.desc(3905,"Background"),R="-1,234.12",C="1,234.12",M="(1,234.12)",H="-$1,234.12",B="$1,234.12",J="($1,234.12)";var O=[{n:Q,v:"pru"}];I.forEach(["Arial","Arial Black","Arial Narrow","Arial Unicode MS","Batang","Book Antiqua","Bookman Old Style","Bookshelf Symbol 1","Bookshelf Symbol 2","Bookshelf Symbol 3","Comic Sans MS","Courier New","Garamond","Haettenschweiler","Helvetica","Impact","Lucida Console","Lucida Sans Unicode","Map Symbols","Marlett","Monotype Corsiva","Monotype Sorts","MS Gothic","MS Outlook","Microsoft Sans Serif","MT Extra","Open Sans SemiBold","Open Sans","Symbol","Tahoma","Times New Roman","Trebuchet MS","Verdana","Webdings","Wingdings","Wingdings 2","Wingdings 3"],function(S){O.push({n:S,v:S,symbolic:true});});function G(U,S,V){return(S&&S>=U)?G(U,S-V,V).concat(S):[];}var A=G(2,12,1);A=A.concat(G(14,24,2));A=A.concat(G(36,48,12));A=A.concat(G(72,72,1));var F=[{n:Q,v:"pru"}];I.forEach(A,function(S){F.push({n:String(S),v:String(S)});});mstrmojo._FormatDefinition={Formats:[{n:P},{n:K},{n:D},{n:mstrmojo.desc(3436,"Color and Lines")}],FormatTarget:[{n:mstrmojo.desc(7942,"Element Header"),v:1,p:"header_format"},{n:mstrmojo.desc(7943,"Element Value"),v:2,p:"grid_format"},{n:mstrmojo.desc(7944,"Individual Items Header"),v:3,p:"child_header_format"},{n:mstrmojo.desc(7945,"Individual Items Value"),v:4,p:"child_grid_format"}],MetricFormatTarget:[{n:mstrmojo.desc(9710,"Metric Headers"),v:1,p:"header_format"},{n:mstrmojo.desc(9711,"Metric Values"),v:2,p:"grid_format"}],MetricValueFormats:[{n:K},{n:D},{n:P},{n:N},{n:E}],MetricHeaderFormats:[{n:K},{n:D},{n:P},{n:N},{n:E},{n:mstrmojo.desc(12139,"Chart")}],NumberFormatCategory:{Automatic:-3,Default:-2,General:9,Fixed:0,Currency:1,Date:2,Time:3,Percentage:4,Fraction:5,Scientific:6,Custom:7},DefaultFormat:{FormattingAlignment:{Horizontal:"1",Vertical:"1",TextWrap:"0",TextDirection:"0"},FormattingBorder:{HInsideStyle:"1",VInsideStyle:"1",TopStyle:"1",LeftStyle:"1",BottomStyle:"1",RightStyle:"1",HInsideColor:"0",VInsideColor:"0",TopColor:"0",LeftColor:"0",BottomColor:"0",RightColor:"0",Border3DStyle:"0",Border3DWeight:"0",Border3DBottomColor:"0",Border3DLeftColor:"0",Border3DRightColor:"0",Border3DTopColor:"0"},FormattingFont:{Name:"Arial",Bold:"0",Italic:"0",Size:"10",Strikeout:"0",Underline:"0",Color:"0",Script:"0"},FormattingNumber:{Category:"9",DecimalPlaces:"0",ThousandSeparator:"-1",CurrencySymbol:"$",CurrencyPosition:"0",Format:"General",NegativeNumbers:"3"},FormattingPadding:{LeftPadding:"1",RightPadding:"1",TopPadding:"1",BottomPadding:"1",LineSpacing:"0"},FormattingPatterns:{FillColor:"16777215",PatternColor:"8650752",PatternStyle:"1",FillStyle:"0",ApplyToGraphThreshold:"0",GradientColor:"16777215",GradientAngle:"0",GradientXOffset:"0",GradientYOffset:"0",SelectorSelectionColor:"16167264",SelectorSelectionFillStyle:"0",SeriesFillColor:"pru",SeriesPatternColor:"8650752",SeriesPatternStyle:"1",SeriesFillStyle:"0",SeriesApplyToGraphThreshold:"0",SeriesGradientColor:"16777215",SeriesGradientAngle:"0",SeriesGradientXOffset:"0",SeriesGradientYOffset:"0",SeriesSelectorSelectionColor:"16167264",SeriesSelectorSelectionFillStyle:"0"}},Families:O,Sizes:F,SizesInVI:F.slice(7,19),Styles:[{n:Q,v:"pru"},{n:mstrmojo.desc(3440,"Regular"),v:"0,0"},{n:mstrmojo.desc(2718,"Bold"),v:"-1,0",v2:"-1,"},{n:mstrmojo.desc(2719,"Italic"),v:"0,-1",v2:",-1"},{n:mstrmojo.desc(3441,"Bold Italic"),v:"-1,-1"}],Effects:[{n:"Underline",v:0},{n:"Strike",v:1}],Category:[{n:Q,v:-2},{n:mstrmojo.desc(2378,"General"),v:9},{n:mstrmojo.desc(2050,"Fixed"),v:0},{n:mstrmojo.desc(2051,"Currency"),v:1},{n:mstrmojo.desc(2052,"Date"),v:2},{n:mstrmojo.desc(2170,"Time"),v:3},{n:mstrmojo.desc(2053,"Percentage"),v:4},{n:mstrmojo.desc(2054,"Fraction"),v:5},{n:mstrmojo.desc(2055,"Scientific"),v:6},{n:mstrmojo.desc(2056,"Custom"),v:7}],MaxNegativeDidigts:30,FixedNegative:[{n:R,v:1,f:"#,##0.00"},{n:R,r:true,v:5,f:"#,##0.00;[RED]-#,##0.00"},{n:C,r:true,v:2,f:"#,##0.00;[RED]#,##0.00"},{n:M,v:3,f:"#,##0.00;(#,##0.00)"},{n:M,r:true,v:4,f:"#,##0.00;[RED](#,##0.00)"}],CurrencyNegative:[{n:H,v:1,f:'"$"#,##0.00'},{n:H,r:true,v:5,f:'"$"#,##0.00;[RED]-"$"#,##0.00'},{n:B,r:true,v:2,f:'"$"#,##0.00;[RED]"$"#,##0.00'},{n:J,v:3,f:'"$"#,##0.00;("$"#,##0.00)'},{n:J,r:true,v:4,f:'"$"#,##0.00;[RED]("$"#,##0.00)'}],CurrencyPosition:[{n:mstrmojo.desc(2194,"Left"),v:0},{n:mstrmojo.desc(2195,"Right"),v:1},{n:mstrmojo.desc(2183,"Left with space"),v:2},{n:mstrmojo.desc(2182,"Right with space"),v:3}],Date:[{n:mstrmojo.desc(2231,"4/7"),v:"m/d"},{n:mstrmojo.desc(2232,"04/07"),v:"mm/dd"},{n:mstrmojo.desc(2233,"4/7/98"),v:"m/d/yy"},{n:mstrmojo.desc(2234,"04/07/98"),v:"mm/dd/yy"},{n:mstrmojo.desc(2235,"04/07/1998"),v:"mm/dd/yyyy"},{n:mstrmojo.desc(2236,"7-Apr"),v:"d-mmm"},{n:mstrmojo.desc(2237,"7-Apr-98"),v:"d-mmm-yy"},{n:mstrmojo.desc(2238,"Apr-98"),v:"mmm-yy"},{n:mstrmojo.desc(2239,"Apr '98"),v:"mmm 'yy"},{n:mstrmojo.desc(2240,"April 1998"),v:"mmmm yyyy"},{n:mstrmojo.desc(2241,"4/7/98 15:41"),v:"m/d/yy h:mm"},{n:mstrmojo.desc(2242,"4/7/98 3:41 PM"),v:"m/d/yy h:mm AM/PM"},{n:mstrmojo.desc(2243,"April 7, 1998"),v:"mmmm d, yyyy"}],Time:[{n:mstrmojo.desc(2244,"15:41"),v:"h:mm"},{n:mstrmojo.desc(2245,"3:41 PM"),v:"h:mm AM/PM"},{n:mstrmojo.desc(2246,"15:41:46"),v:"h:mm:ss"},{n:mstrmojo.desc(2247,"3:41:46 PM"),v:"h:mm:ss AM/PM"},{n:mstrmojo.desc(2241,"4/7/98 15:41"),v:"m/d/yy h:mm"},{n:mstrmojo.desc(2242,"4/7/98 3:41 PM"),v:"m/d/yy h:mm AM/PM"},{n:mstrmojo.desc(2250,"04/07/98 15:41"),v:"mm/dd/yy h:mm"},{n:mstrmojo.desc(2248,"04/07/98 3:41 PM"),v:"mm/dd/yy h:mm AM/PM"}],PercentNegative:[{n:"-12.12%",v:1,f:"0.00%"},{n:"-12.12%",r:true,v:5,f:"0.00%;[RED]-0.00%"},{n:"12.12%",r:true,v:2,f:"0.00%;[RED]0.00%"},{n:"(12.12%)",v:3,f:"0.00%;(0.00%)"},{n:"(12.12%)",r:true,v:4,f:"0.00%;[RED](0.00%)"}],Fraction:[{n:"12 1/3",v:"# ?/?"},{n:"37/3",v:"?/?"},{n:"12 26/81",v:"# ??/??"},{n:"998/81",v:"??/??"}],TextDirection:[{n:Q,v:"pru"},{n:mstrmojo.desc(4601,"Horizontal"),v:0},{n:mstrmojo.desc(5156,"-90 Degree"),v:-90}],Horizontal:[{n:mstrmojo.desc(2296,"Use Default"),v:"pru"},{n:mstrmojo.desc(2378,"General"),v:1},{n:mstrmojo.desc(2194,"Left"),v:2},{n:mstrmojo.desc(2193,"Center"),v:3},{n:mstrmojo.desc(2195,"Right"),v:4},{n:mstrmojo.desc(2068,"Justify"),v:6}],Vertical:[{n:mstrmojo.desc(2296,"Use Default"),v:"pru"},{n:mstrmojo.desc(2256,"Top"),v:1},{n:mstrmojo.desc(2067,"Center"),v:2},{n:mstrmojo.desc(2257,"Bottom"),v:3}],TextWrap:[{v:0},{v:-1}],BorderStyles:[{n:Q,v:"pru"},{n:mstrmojo.desc(2258,"None"),v:0},{n:mstrmojo.desc(2259,"Dashed"),v:3},{n:mstrmojo.desc(2260,"Dotted"),v:4},{n:mstrmojo.desc(2261,"Hair"),v:7},{n:mstrmojo.desc(2262,"Thin"),v:1},{n:mstrmojo.desc(2264,"Thick"),v:5},{n:mstrmojo.desc(15361,"Double"),v:6}],extractModel:function(V,X,U){var Z=U||this.DefaultFormat,Y;for(Y in V){var S=V[Y];if(!S.attachEventListener){if(!mstrmojo.hash.isEmpty(S)){X[Y]=S;}}else{var W;for(W in S){if(Z[Y]&&Z[Y][W]){if(!X[Y]){X[Y]={};}X[Y][W]=S[W];}}}}},getAvailableFonts:function L(){var S={success:function(V){if(V.name==="fontPicker"){var U=[{n:Q,v:"pru"}];I.forEach(V.shortcuts,function(X){var Y=X.attributes,Z=I.filterOne(Y,function(a){return a.value;}),W=I.filterOne(Y,function(a){return a.symbolic;});U.push({n:Z&&Z.value,v:Z&&Z.value,symbolic:(W&&W.symbolic||"false").toUpperCase()==="TRUE"});});mstrmojo._FormatDefinition.Families=U;}}};mstrmojo.xhr.request("POST",mstrConfig.taskURL,S,{taskId:"getSystemPickerJson",name:"fontPicker"},false,null,true);},getStandardFormat:function(U,S){var W=mstrmojo.hash.clone(S||this.DefaultFormat),V;U=U||{};for(V in W){U[V]=U[V]||{};}for(V in U){if(!U[V].attachEventListener){U[V]=mstrmojo.hash.make(U[V],mstrmojo.Obj);}}return U;},saveFormatModel:function(X,d,U,e){var c=e||this.DefaultFormat,Z,S;for(Z=0;Z<U.length;Z++){var Y=U[Z],W=d[Y]||null,b=X[Y];if(b===undefined){delete d[Y];continue;}for(S in c){var a=c[S],V;if((!W&&!b)||(W&&!W[S]&&!b[S])){continue;}for(V in a){if(b[S]===undefined||b[S]===""||b[S][V]==="pru"||b[S][V]===undefined){if(W&&W[S]&&(W[S][V]!==undefined&&W[S][V]!==null&&W[S][V]!=="pru")){W[S][V]="pru";}}else{W=W||{};W[S]=W[S]||{};W[S][V]=b[S][V];}}}if(W){d[Y]=W;}}}};}());(function(){mstrmojo.requiresCls("mstrmojo.array");var G=mstrmojo.array;function B(){var H=this.buildConfig=this.buildConfig||{};H.pk=this.k;H.fgk=this.defn&&this.defn.fgk;return H;}mstrmojo._HasBuilder={builder:null,postBuildRendering:function D(){if(!this.builtChildren){this.buildChildren();}return this._super();},getChildren:function F(){return this.model.getChildren(this.node,false);},buildChildren:function E(H){if(!this.builder||!this.model){return false;}var J=this.children;if(J&&J.length){this.set("children",[]);}var I=this.builder.build(this.getChildren(),this.model,B.call(this));if(!H){this.addChildren(I);}this.builtChildren=true;return H?I:true;},rebuildChildren:function C(J){var P=this.children.slice(0),L=this.model,K=[],I,H=this,M=mstrApp.restoreVFKey,N,O;J=J||P.slice(0);J.forEach(function(S){var Q=G.indexOf(P,S),R=S.k;if(Q===-1){throw new Error("Invalid child requested rebuild in mstrmojo._HasBuilder::rebuildChild.");}this.removeChildren(S);S.destroy();K.push(R);},this);if(mstrApp.isInVFConfigMode&&(mstrApp.showBandingInVFConfigMode||mstrApp.showOutlineInVFConfigMode)&&!!J&&J.length===1&&!!J[0]&&J[0].k===M){delete mstrApp.showBandingInVFConfigMode;delete mstrApp.showOutlineInVFConfigMode;N=L.insertVizBox(M,H,{});L.selectVIUnit(N.id,true,{});I=[N];}else{O=L.getChildrenByKey(this.node,false,K);I=this.builder.build(O,L,B.call(this));this.addChildren(I);}return I;},rebuildChild:function A(H){return this.rebuildChildren([H])[0];}};}());(function(){mstrmojo.requiresCls("mstrmojo.array");var B=mstrmojo.array;mstrmojo._HasConditionLogicDIC=mstrmojo.provide("mstrmojo._HasConditionLogicDIC",{_mixinName:"mstrmojo._HasConditionLogicDIC",target:null,owner:null,applyChanges:function(){this._super&&this._super();var F=this.target||[],D=F.length,E;for(E=0;E<D;E++){F[E].triggerValidateCondition();}},onvisibleChange:function(){this._super&&this._super();var F=this.target||[],D=F.length,E;for(E=0;E<D;E++){F[E].triggerValidateCondition();}},updateCellsMap:function(E){var I="",G=this.getCurValue?this.getCurValue():this.value,H=this.getDisplayValue?this.getDisplayValue():G,F=this.k,D=this.owner;if(E){D.updatedCellsMap[F]={r:I,v:{dv:H,v:G}};}else{if(D.updatedCellsMap[F]){delete D.updatedCellsMap[F];}}}});mstrmojo._CanRespondConditionChange=mstrmojo.provide("mstrmojo._CanRespondConditionChange",{_mixinName:"mstrmojo._CanRespondConditionChange",src:null,childDICs:null,owner:null,postBuildRendering:function(){var D=this.owner;if(D){D.buildConditions(this);}if(this.src){this.childDICs=[];A.call(this,this.childDICs);this.triggerValidateCondition();}this._super();},onvisibleChange:function(){this._super&&this._super();var J=this.childDICs||[],F=J.length,E,H,G,D,I;for(I=0;I<F;I++){E=J[I].owner.dics;H=J[I].k;D=B.find(E,"k",H);if(D>-1){G=E[D].mdf;if(G){J[I].updateCellsMap(this.visible);}}J[I].set("visible",this.visible);}},triggerValidateCondition:function(){var D=true;B.forEach(this.src,function(E){if(!C(E)){D=false;}});this.applyConditionAction(D);},applyConditionAction:mstrmojo.emptyFn});function A(G){var F=this.children||[],D=F.length,E;for(E=0;E<D;E++){if(F[E].dic){G.push(F[E]);}else{A.call(F[E],G);}}}function C(H){var M=H.dic,D=M.value,J=M.visible,F=H.logic,I=[],G,E,L=null;try{if(F[0]==="/"){I=F.split("/");G=I.pop();I.shift();E=I.join("/");L=new RegExp(E,G);}else{L=new RegExp(F);}if(!J||!L.test(D)){return false;}}catch(K){return false;}return true;}})();(function(){mstrmojo.requiresCls("mstrmojo.array");var A=mstrmojo.array;mstrmojo.fe._IsRelationTreeNode=mstrmojo.provide("mstrmojo.fe._IsRelationTreeNode",{createSetHtml:'<span class="mstrmojo-textset mstrmojo-create-set-text" mstrAttach:click >'+mstrmojo.desc(12034,"Create a Set")+"</span>",syncRootOperator:function(){var F=this.parent,H=function(){var J=this.parent,I=[];if(J){I=J.ctxtBuilder.itemWidgets;}return I;},E,D,B,C,G;if(F){E=H.call(this);B=E.length;D=A.find(E,"noRelationOperator",true)!==-1;for(C=0;C<B;C++){G=E[C];G&&G.set("noRelationOperator",D);}this.set("noRelationOperator",D);}}});}());(function(){mstrmojo.requiresCls("mstrmojo.array");var I="#000000",E=Math.round;function O(Z){return("0"+parseInt(Z,10).toString(16)).slice(-2);}mstrmojo.color=mstrmojo.provide("mstrmojo.color",{rgbStr2rgb:function X(Z){if(Z==="transparent"){return["0","0","0"];}else{return Z.match(/^rgba?[\s+]?\([\s+]?(\d+)[\s+]?,[\s+]?(\d+)[\s+]?,[\s+]?(\d+)[\s+]?/i).slice(1);}},rgbStr2hex:function G(Z){if(Z.indexOf("rgb")>=0){var a=this.rgbStr2rgb(Z);return"#"+this.rgb2hex(a[0],a[1],a[2]);}return Z;},rgb2hex:function B(c,a,Z){return O(c)+O(a)+O(Z);},rgb2hsv:function W(Z,j,l){var e=Math.min(Z,j,l),m=Math.max(Z,j,l),f=0,p,o;o=m/255;p=(m!==0)?(parseFloat(m)-parseFloat(e))/parseFloat(m):0;if(p===0){f=0;}else{var k=m-e,a=(m-Z)/k,c=(m-j)/k,n=(m-l)/k;if(Z===m){f=n-c;}else{if(j===m){f=2+a-n;}else{f=4+c-a;}}f=f/6;if(f<0){f=f+1;}}return[E(f*360),E(p*100),E(o*100)];},rgb2hsl:function D(Z,e,f){Z/=255;e/=255;f/=255;var j=Math.max(Z,e,f),c=Math.min(Z,e,f),a=(j+c)/2,d,m;if(j===c){d=m=0;}else{var k=j-c;m=a>0.5?k/(2-j-c):k/(j+c);switch(j){case Z:d=(e-f)/k+(e<f?6:0);break;case e:d=(f-Z)/k+2;break;case f:d=(Z-e)/k+4;break;}d/=6;}return[d,m,a];},hsl2rgb:function C(f,m,e){var d=function d(h,g,b){if(b<0){b+=1;}if(b>1){b-=1;}if(b<1/6){return h+(g-h)*6*b;}if(b<1/2){return g;}if(b<2/3){return h+(g-h)*(2/3-b)*6;}return h;},Z,j,k;if(m===0){Z=j=k=e;}else{var a=e<0.5?e*(1+m):e+m-e*m,c=2*e-a;Z=d(c,a,f+1/3);j=d(c,a,f);k=d(c,a,f-1/3);}return[E(Z*255),E(j*255),E(k*255)];},hsl2hex:function J(b,a,Z){return"#"+mstrmojo.array.map(this.hsl2rgb(b,a,Z),function(c){return O(c);}).join("");},hex2rgb:function Q(c){var Z=this.fixFullHexValue("#"+c.replace("#","")),a=[],b;Z=Z.replace("#","");for(b=0;b<3;b++){a.push(parseInt(Z.substr(b*2,2),16));}return a;},hex2bgr:function L(Z){return this.hex2rgb(Z).reverse();},hex2hsv:function U(a){var Z=this.hex2rgb(a);return this.rgb2hsv(Z[0],Z[1],Z[2]);},hex2hsl:function Y(Z){return this.rgb2hsl.apply(this,this.hex2rgb(Z));},hsv2rgb:function H(k,w,o){k=k/360;w=w/100;o=o/100;var Z,l,n;if(w===0){Z=o*255;l=o*255;n=o*255;}else{var d=k*6;if(d===6){d=0;}var j=Math.floor(d);var c=o*(1-w);var a=o*(1-w*(d-j));var u=o*(1-w*(1-(d-j)));var m,e,f;switch(j){case 0:m=o;e=u;f=c;break;case 1:m=a;e=o;f=c;break;case 2:m=c;e=o;f=u;break;case 3:m=c;e=a;f=o;break;case 4:m=u;e=c;f=o;break;default:m=o;e=c;f=a;break;}Z=m*255;l=e*255;n=f*255;}return[E(Z),E(l),E(n)];},hsv2hex:function M(c,b,Z){var a=this.hsv2rgb(c,b,Z);return this.rgb2hex(a[0],a[1],a[2]);},getContrastingColor:function N(c,a,Z){var b=this.hex2rgb(c);return(((b[0]*299)+(b[1]*587)+(b[2]*114))/1000<125)?a:Z;},getLuminance:function F(a){var Z=this.hex2rgb(a);return 0.2126*Z[0]+0.7152*Z[1]+0.0722*Z[2];},getHighlightColor:function S(j,f){var Z,h,k,l,m=this.hex2rgb(!f?"#FFCE7F":"#EFE6D8"),e=parseInt(j[0],10),c=parseInt(j[1],10),o=parseInt(j[2],10),d=parseInt(m[0],10),a=parseInt(m[1],10),n=parseInt(m[2],10);Z=(e*d)/255;h=(c*a)/255;k=(o*n)/255;l=e*0.3+c*0.59+o*0.11;if(l<85){Z=Z+(63*(85-l)/85);Z=Z>255?255:Z;h=h+(63*(85-l)/85);h=h>255?255:h;k=k+(63*(85-l)/85);k=k>255?255:k;}return"#"+this.rgb2hex(E(Z),E(h),E(k));},get3DBorderColor:function R(c,f){var a=parseInt(c[0],10)*0.3+parseInt(c[1],10)*0.59+parseInt(c[2],10)*0.11;var e=parseInt(c[0],10);var d=parseInt(c[1],10);var Z=parseInt(c[2],10);switch(f){case"light":if(a>150){e=e*0.9;d=d*0.9;Z=Z*0.9;}else{e=e*0.6+102;d=d*0.6+102;Z=Z*0.6+102;}break;case"dark":if(a>10){e=e*0.4;d=d*0.4;Z=Z*0.4;}else{e=e*0.8+30;d=d*0.8+30;Z=Z*0.8+30;}break;}return"#"+this.rgb2hex(E(e),E(d),E(Z));},encodeColor:function K(Z,a){if(a!==undefined&&(Z===null||Z.length===0||Z==="undefined")){Z=a;}if(Z==="transparent"){return -1;}if(parseInt(Z,10)===-2){return -2;}if(Z.substring(0,1)==="#"){Z=Z.substring(1);}return parseInt(Z.substring(4)+Z.substring(2,4)+Z.substring(0,2),16);},decodeColor:function A(Z){Z=parseInt(Z,10);if(Z===0){return I;}var a=16777216+(Z&255)*65536+(Z&65280)+(Z&16711680)/65536;return"#"+a.toString(16).substring(1).toUpperCase();},fixFullHexValue:function V(Z){if(Z&&Z.length===4){return Z.replace(/([0-9a-f])/ig,"$1$1");}return Z;},findMidColorHex:function P(c,b){var d=this.hex2rgb(c),Z=this.hex2rgb(b),a=[];d.forEach(function(e,f){a.push(parseInt((e+Z[f])/2,10));});return("#"+this.rgb2hex(a[0],a[1],a[2]));}});}());(function(){mstrmojo.requiresCls("mstrmojo.array");var E=mstrmojo.array;mstrmojo._BindTargetChildren=mstrmojo.provide("mstrmojo._BindTargetChildren",{target:null,targetProps:null,addTabButtons:null,removeTabButtons:null,clearButtons:null,ontargetChange:function D(L){var M=L&&L.valueWas;if(M){var J=this._targetSubs;if(J){M.detachEventListener(J.add);M.detachEventListener(J.rem);M.detachEventListener(J.sel);}this.clearButtons();}var N=this.target;if(N){var I=this.targetProps,H=(I&&I.children)||"children",F=N[H];this.addTabButtons(F,0);this._onTargetSelChg();if(N.attachEventListener){var G=this.id,K="attachEventListener";this._targetSubs={add:N[K]("addChild",G,"_onTargetAddChild"),rem:N[K]("removeChild",G,"_onTargetRemoveChild"),sel:N[K]("selectedChange",G,"_onTargetSelChg")};}}this._ontargetChange();},_ontargetChange:mstrmojo.emptyFn,_onTargetAddChild:function A(F){var G=F&&F.value;if(G&&G.length){this.addTabButtons(G,F.index);}this._postTargetAddChild();},_postTargetAddChild:mstrmojo.emptyFn,_onTargetRemoveChild:function B(G){var F=G&&G.value,H;for(H=((F&&F.length)||0)-1;H>-1;H--){this.removeTabButton(F[H]);}this._postTargetRemoveChild();},_postTargetRemoveChild:mstrmojo.emptyFn,_onTargetSelChg:function C(L){var G=this.targetProps||{},F=this[G.names||"children"],J=function(O,P){if(O.set){O.set("selected",P);}else{O.selected=P;}};if(L){var H=L.valueWas,K=H?E.find(F,"target",H):-1;if(K>-1){J(F[K],false);}}var M=this.target,N=M&&M.selected,I=N?E.find(F,"target",N):-1;if(I>-1){J(F[I],true);}this._postTargetSelChg();},_postTargetSelChg:mstrmojo.emptyFn});}());(function(){mstrmojo.requiresCls("mstrmojo.array");var F=mstrmojo.array;mstrmojo._IsPanelStack=mstrmojo.provide("mstrmojo._IsPanelStack",{_mixinName:"mstrmojo._IsPanelStack",TTL_SRC_PANEL:0,model:null,selectedIdx:undefined,init:function K(P){this._super(P);var O=this.defn;if(!O){O=this.defn=this.node&&this.node.defn;this.titleSrc=this.titleSrc||O.ttlSrc;}var N=this.selectedKey=this.defn.selKey=this.node.data.selKey;this.set("selectedIdx",F.find(this.node.data.panels,"k",N));O.attachEventListener("selKeyChange",this.id,function(Q){this.set("selectedKey",Q.value);});},addChildren:function M(P,W,U){var V=this.getFormats(),R=V&&V.overflow,Q=P.length,S;for(S=0;S<Q;S++){var O=P[S],X=O.k;if(X){O.selected=O.visible=X===this.selectedKey;if(R){var N=O.getFormats()||O.createEmptyFormats();if(N){N.overflow=R;}}}}return this._super(P,W,U);},refresh:function G(){if(this.hasRendered){var N=this.defn.newSelKey||this.selectedKey,P=this.selectedVisFilterContainerKey,O;F.forEach(this.children,function(R){var Q=R.k;if(Q){R._delayRefresh=(Q!==N);O=mstrApp.isInVFConfigMode&&Q===P;if(!R._delayRefresh&&!O){R.refresh();}}});}delete this.defn.newSelKey;},selectPanel:function B(O,P,N){var Q=this.model.getDataService(),R=Q.newUpdateWithoutCmd();this.selectPanelDeferred(R,O,P,N);if(R.actions&&R.actions.length>0){Q.addSuppressData(R.extras);R.submit();}},selectPanelDeferred:function(Q,O,P,N){if(O!==this.selectedKey){this.defn.set("selKeyChange",O);this.model.selectPanelDeferred(Q,this.k,O,this.node.data.wid,P,N);}},onselectedKeyChange:function L(O){var P=0,S,N,Q;F.forEach(this.children||this.node.data.panels,function(V,U){var W=V.k;if(W){if(O.value===W){N=V;Q=U-P;if(V.set){V.set("visible",true);V.set("selected",true);}}else{if(O.valueWas===W){S=V;if(V.set){V.set("selected",false);V.set("visible",false);}}}if(N&&S){return false;}}else{P++;}return true;});if(this.titleSrc===this.TTL_SRC_PANEL&&this.title){var R=N&&N.title;this.set("title",R);this.defn.ttl=R;}this.prevSelectIdx=this.selectedIdx;this.set("selectedIdx",Q);this.raiseEvent({name:"panelSelected",key:N.k});return{on:N,off:S};},getSelectedPanel:function D(){var N=0,O=this.selectedIdx,P;F.forEach(this.children,function(R,Q){if(R.k){if(Q-N===O){P=R;return false;}}else{N++;}return true;});return P;},setDirtyChildren:function I(N){var O=this.selectedKey;F.forEach(this.children,function(Q){var P=Q.k;if(P){Q[((N||P!==O)?"add":"remove")+"DirtyKey"](P);}});},clearDirtyChild:function J(P){var O=this.children,N=O[F.find(O,"k",P)];if(N){N.removeDirtyKey(N.k);}},isPanelStack:true,checkRequiredObjects:function C(){var N=this.txWidgets||{},O=true,P;for(P in N){O&=!!N[P].checkRequiredObjects();}return O;},isAutoApply:function E(){return this.defn.cas;},updateSelectedIdx:mstrmojo.emptyFn,unrender:function H(N){delete this.defn.newSelKey;this._super(N);},switchToPanel:function A(N,O){if(O!==undefined){this.set("selectedIdx",O);}else{this.updateSelectedIdx(N);}this.children[this.selectedIdx]&&this.selectPanel(this.children[this.selectedIdx].k);}});}());(function(){mstrmojo.requiresCls("mstrmojo.array");var B=mstrmojo.array;function A(C){if(C.parent){if(C.parent.shouldEllipsizeChildren===undefined){mstrmojo.mixin(mstrmojo._HasEllipsis,C.parent);}C.parent.set("shouldEllipsizeChildren",true);}}mstrmojo._HasEllipsis=mstrmojo.provide("mstrmojo._HasEllipsis",{shouldEllipsize:false,shouldEllipsizeChildren:false,doEllipsize:function(){if(this.shouldEllipsizeChildren){B.forEach(this.children,function(D,C){if(D.hasRendered&&D.doEllipsize){D.doEllipsize();}});}},onshouldEllipsizeChange:function(){this._onEllipsizeFlagChange(this.shouldEllipsize,this.shouldEllipsizeChildren);},onshouldEllipsizeChildrenChange:function(){this._onEllipsizeFlagChange(this.shouldEllipsizeChildren,this.shouldEllipsize);},_onEllipsizeFlagChange:function(D,C){if(D&&!C){A(this);this.markupMethods=mstrmojo.mixin({onvisibleChange:function(){if(this._super){this._super();}if(this.visible&&this.hasRendered){this.doEllipsize();}}},mstrmojo.hash.copy(this.markupMethods));}}});}());(function(){mstrmojo.requiresCls("mstrmojo.array");function C(G,H,E){var F=G.createElement("input");F.name=H;F.type="hidden";F.value=E;return F;}function B(K,J){J=J.substring(J.indexOf("?")+1,J.length);var M=J.split("&"),L="",G="";var N=/\+/g,H,E;for(H=0,E=M.length;H<E;H++){var I=M[H].indexOf("=");if(I>=0){L=M[H].substring(0,I);G=M[H].substring(I+1);}else{L=M[H];G="";}if(G){G=decodeURIComponent(G.replace(N," "));}var F=document.createElement("INPUT");F.type="HIDDEN";F.name=L;F.value=G;K.appendChild(F);}return false;}mstrmojo.form={createDynamicForm:function A(E,H){var F=document.createElement("FORM"),G=E.indexOf("?")>0;F.name="dynamic_form";F.method=H||"POST";F.action=(G?E.substring(0,E.indexOf("?")):E);if(G){B(F,E);}document.body.appendChild(F);return F;},sendLinkAsForm:function(E,G,H){var F=this.createDynamicForm(E,H);this.send({},F.action,F.method,G,null,null,F);},sendLink:function(E,H,I){var G=mstrmojo.array.indexOf(["_new","_blank"],H)>-1,F=!mstrmojo.isUrlExternal(E);if(!G&&F){mstrApp.showWait&&mstrApp.showWait({showCancel:true,onCancel:mstrApp.hideWait});}if(!mstrmojo.isUrlExternal(E)){mstrmojo.form.sendLinkAsForm(E,H,I);}else{if(G){window.open(E);}else{window.location.href=E;}}},send:function D(L,M,F,O,J,H,G){var Q=((J&&J.hWin)||window).document,N=G||Q.createElement("form"),K=mstrApp;L=mstrmojo.addCSRFTokenToTaskParams(L);N.method=F||"POST";if(O){N.target=O;}N.action=M||K.name;H=(H!==undefined)?H:!(N.action&&N.action.indexOf("aspx")>0)&&mstrConfig.addTimeStampToPreventCaching;if(!!K.addJSessionIdToURL&&K.httpSessionId){N.action+=";jsessionid="+K.httpSessionId;}if(H){N.action+=";uxts"+mstrmojo.now();}N.appendChild(C(Q,"xts",String(mstrmojo.now())));var R,E=K.persistTaskParams||microstrategy.persistParams;for(R in E){L[R]=E[R];}if(K.servletState&&K.name){L[K.name]=K.servletState;}if(L){var I;for(I in L){if(L[I].constructor===Array){mstrmojo.array.forEach(L[I],function(S){N.appendChild(C(Q,I,S));});}else{N.appendChild(C(Q,I,L[I]));}}}Q.body.appendChild(N);try{N.submit();}catch(P){if(O&&P.result===2147500037&&!window.open("","","width=1,height=1,left=0,top=0,scrollbars=no")){mstrmojo.alert("*This action requires popups to be allowed in the browser.*");}else{mstrmojo.err("Form submission failed for an unknown reason.");}}Q.body.removeChild(N);},addURLAsHiddenInputsToForm:B};}());(function(){mstrmojo.requiresCls("mstrmojo.array");var G=function(X){var W=(mstrApp.docModelData&&mstrApp.docModelData.mid)||"";return X.k+"-"+W;},O={},K=mstrmojo.array;mstrmojo.vi.ui.rw.selectors._BrushesAndHighlights=mstrmojo.provide("mstrmojo.vi.ui.rw.selectors._BrushesAndHighlights",{_mixinName:"mstrmojo.vi.ui.rw.selectors._BrushesAndHighlights",postBuildRendering:function J(){this._super();this.setup();this.initialHighlight();},initialHighlight:function B(){if(!this.getExp()){if(O[G(this)]){this.highlight.apply(this,O[G(this)]);}else{if(this.isVisMap){this.highlight("allLayers",this.genSelectionMapping(),true);}else{this.highlight(this.getSelectionType(),this.getSelectionHash(),true);}}}},getExp:function(){var W=this.model.data,X=W&&W.sc&&W.sc.exp;return X;},clearsBrushingOnHighlight:true,brushSub:null,clearSub:null,getAssociatedNodes:function V(){var W=this.defn&&this.defn.an;return W&&W.length>0?W:[];},hasAssociatedNodes:function M(){var W=this.getAssociatedNodes();return W.length>0;},getDocModelForEvent:function H(){return this.model&&this.model.docModel;},setup:function Q(){var W=this.getDocModelForEvent(),X=this.id;if(W){[this.brushSub,this.clearSub].forEach(function(Y){if(Y){Y.clear();}});this.brushSub=W.attachEventListener("brushing",X,this.onBrushing);this.clearSub=W.attachEventListener("clearBrush",X,this.onClearBrushing);}},handlesMultiSelection:function F(){return(this._super&&this._super())||this.getAssociatedNodes().length>0;},getHighlightKeys:function P(){var X=[],W=this.getAssociatedNodes();W.forEach(function(Y){X.push(Y.k);});return X;},onSelectionChange:function L(W){var X=false;if(this._super){X=this._super(W);}return this.clearHighlightForSelectionChange(X);},onContextMenuSelectionChange:function I(W){var X=false;if(this._super){X=this._super(W);}return this.clearHighlightForSelectionChange(X);},clearHighlightForSelectionChange:function U(X){var W=this.getDocModelForEvent();if(this.clearsBrushingOnHighlight){W.raiseEvent({name:"clearBrush",from:this});}if(this.handlesMultiSelection()&&!X){W.raiseEvent({name:"brushing",from:this,keys:this.getHighlightKeys()});return true;}return false;},onBrushing:function A(X){var W=X.keys.slice();if(W.indexOf(this.k)!==-1){if(this.highlight){var Y=X.from;this.highlight(Y.getSelectionType(),Y.getSelectionHash());W.push(Y.k);this.getDocModelForEvent().raiseEvent({name:"clearBrush",from:this,excludeKeys:W});}else{throw new Error(this.scriptClass+" must implement highlight method.");}}},onClearBrushing:function S(X){var W=false;if(K.indexOf(X.excludeKeys,this.k)===-1){if(this._super){W=this._super(X);}if(!W){var Y=this.getAssociatedNodes();if(K.find(Y,"k",X.from.k)!==-1){this.clearSelections(true);}}}return true;},highlight:function E(){O[G(this)]=arguments;if(this._super){this._super.apply(this,arguments);}},clearSelections:function C(){delete O[G(this)];if(this._super){this._super.apply(this,arguments);}},clearCxtMnuSelection:function D(){if(this._super){this._super.apply(this);}},clearHighlightsCache:function R(){delete O[G(this)];},updateAssociatedNodesOnMove:function N(){this.clearSelections(true);this.endSelections();if(this.isLinkedFilter&&this.isLinkedFilter()){return ;}delete this.defn.an;}});}());(function(){mstrmojo.requiresCls("mstrmojo.EnumAuthenticationModes");var A=mstrmojo.EnumAuthenticationModes;function C(G){var H,F,E={success:function(I){H=I.identityToken;},complete:function(){if(H){G=G+"?idToken="+H;}F.location.href=G;}};if(mstrConfig.seamlessLoginEnabled){if(mstrConfig.authMode===A.INTEGRATED.toString()){G+="?loginMode="+A.INTEGRATED;window.open(G,"_blank");}else{F=window.open();mstrmojo.xhr.request("GET",mstrConfig.taskURL,E,{taskId:"createIdentityToken"});}}else{window.open(G,"_blank");}}function D(){return mstrConfig&&mstrConfig.features&&mstrConfig.features["show-dossier-library-link"]&&!!mstrConfig.libraryWebBaseURL;}function B(F){var E=mstrConfig.libraryWebBaseURL+"app";if(F){E+="/"+mstrConfig.projectId+"/"+F;}return E;}mstrmojo.util.LibraryHelper=mstrmojo.provide("mstrmojo.util.LibraryHelper",{createTokenAndOpenLink:C,isLibraryConfigured:D,constructLibraryUrl:B});})();(function(){mstrmojo.requiresCls("mstrmojo.array","mstrmojo.dom","mstrmojo.form");var F=mstrmojo.dom;var A=mstrmojo.form;function C(J,I,H,L){var G=J.getElementsByTagName(I);var K=mstrmojo.array.filter(G,function(M){return M.getAttribute(H)===L;});return K[0];}function B(M){var K=document.getElementById(M),J=C(K,"input","name","myFile"),I=J.value,L=function(){if(F.isIE){var N=document.createElement("form");J.parentNode.insertBefore(N,J);N.appendChild(J);N.reset();N.removeNode(false);}};if(I===""){return ;}else{if(/\.mstr$/.test(I.toLowerCase())){mstrApp.showWait(true);A.addURLAsHiddenInputsToForm(K,mstrmojo.addCSRFTokenToURL(mstrApp.name+"="+encodeURIComponent(mstrApp.servletState)));if(mstrApp.currentFolderId){var H=document.getElementById("import_folderID");H.value=mstrApp.currentFolderId;}if(!C(K,"input","name","formId")){var G=document.createElement("input");G.type="hidden";G.name="formId";G.value=K.id;K.appendChild(G);}K.submit();K.reset();}else{mstrmojo.alert(mstrmojo.desc(11227),null,mstrmojo.desc(11226));}}L();}function E(Q){var W=Q.status===200,K=Q.content,J=mstrApp.name,L=function(b){mstrApp.showWait();var a=document.getElementById(K.formId||"import_form"),Z=[],Y=0,X;mstrmojo.hash.forEach(b,function(e,d){if(d==="folderId"){if(F.isIE8){var c=document.getElementById("import_folderID");if(c){c.value=e;}}}else{X=document.createElement("input");X.type="hidden";X.name=d;X.value=e;a.appendChild(X);Z[Y++]=X;}});window.setTimeout(function(){a.submit();for(var c=0;c<Z.length;c++){a.removeChild(Z[c]);}},0);};if(K&&K.messageID){var I=(K.fdid?K.fdid:"");if(K.isConflict){var P=function(){L({messageID:K.messageID,resume:true});},M=function(){var X=mstrmojo.insert({scriptClass:"mstrmojo.ui.editors.RenameEditor",renameText:mstrmojo.string.decodeHtmlString(K.n),title:mstrmojo.desc(13052,"Upload"),zIndex:1002,onRename:function(Y){if(mstrmojo.string.isEmpty(Y)){mstrmojo.alert("Please enter a valid name",null,null,1004);return false;}else{L({messageID:K.messageID,resume:true,dashboardName:Y});var Z=mstrmojo.all.ImportNameConflictDialog;if(Z){Z.destroy();}}}});X.open();return false;},H=function(){mstrApp.hideWait();};H();mstrmojo.confirm(mstrmojo.desc(15454,"The Dossier ## already exists. Do you want to replace the existing Dossier?").replace("##",("<strong>"+K.n+"</strong>")),null,{id:"ImportNameConflictDialog",title:mstrmojo.desc(13052,"Upload"),allowHTML:true,buttons:[mstrmojo.Button.newWebButton(mstrmojo.desc(219,"Yes"),P,true),mstrmojo.Button.newWebButton(mstrmojo.desc(3167,"Save As"),M,true),mstrmojo.Button.newWebButton(mstrmojo.desc(3416,"Cancel"),H)],onPreClose:function(){H();return true;}});}else{L({messageID:K.messageID,folderId:I});}}else{if(W){var O=mstrmojo.addCSRFTokenToURL(J+"?evt=2001&src="+J+".2001"+((K&&K.fdid)?("&folderID="+K.fdid):"&systemFolder=20")),G=D(K.did),V=function(X){if(this.parent===null&&this.close){this.close();}else{this.parent.parent.close();}if(X){location.href=X;}},S=mstrmojo.emptyFn,R=function(){mstrmojo.mstr._ObjectActions.openSharingEditor(K.servletPath+G,{objectName:K.n,objId:K.did,objType:"55",mid:-1},false,{showLinkOnOpen:true});};if(!mstrmojo.resolveFeature("flashvi")&&(F.isIE8)){S=function(){V.call(this);mstrmojo.alert(mstrmojo.desc(15474));};}else{S=function(){V.call(this,G);};}var U=mstrApp.currentFolderName&&mstrApp.currentFolderName();var N=mstrmojo.insert({scriptClass:"mstrmojo.onetier.vi.ui.UploadResultEditor",folderName:U||"My Reports",dashboardName:K.n,okFn:function(){V.call(this,U&&O);},viewDashboardFn:S,shareDashboardFn:R});N.open();}else{mstrmojo.error({longDesc:Q.errorMsg});}mstrApp.hideWait(true);}}function D(K){var I=mstrApp.name,J,L;if(mstrmojo.resolveFeature("flashvi")){J=2048001;L={visMode:0};}else{J=3140;L={};}L.documentID=K;L.evt=J;L.src=I+"."+J;var G=[];for(var H in L){if(!L.hasOwnProperty(H)){continue;}G.push(encodeURIComponent(H)+"="+encodeURIComponent(L[H]));}return mstrmojo.addCSRFTokenToURL(I+"?"+G.join("&"));}mstrmojo.mstr.ui.MstrFileUploadHelper={uploadDashboardFile:B,uploadCallback:E};}());(function(){mstrmojo.requiresCls("mstrmojo.form");mstrmojo.vi.util.NavUtility=mstrmojo.provide("mstrmojo.vi.util.NavUtility",{checkSessionAndSendForm:function(C,A,E,B){var D=mstrApp.sessionManager;if(D&&D.sessionTimedout){D.openLoginEditor({success:function(){if(B!=="_blank"&&B!=="mstrExportWindow"){mstrApp.showWait();}mstrmojo.form.send(C,A,E,B);}});}else{if(B!=="_blank"&&B!=="mstrExportWindow"&&C.evt!==3198){mstrApp.showWait();}mstrmojo.form.send(C,A,E,B);}}});}());(function(){mstrmojo.requiresCls("mstrmojo.hash","mstrmojo.dom","mstrmojo.ListSelector");var C=mstrmojo.dom,B=C.isIE;mstrmojo.TreeNodeSelector=mstrmojo.provide("mstrmojo.TreeNodeSelector",mstrmojo.mixin({premousedown:function A(E,I,D){var G=(E&&E.tree)||E,H=D&&D.e;if(!H){return false;}var F=G.lastMouseDown;if(F){if((F.e===H)||(B&&((new Date())-F.dt<50))){return false;}}this._super(E,I,D);if(G){if(G.onnodemousedown){G.onnodemousedown(D);}G.lastMouseDown={e:H,dt:new Date()};}return true;}},mstrmojo.hash.copy(mstrmojo.ListSelector)));}());(function(){mstrmojo.requiresCls("mstrmojo.dom","mstrmojo.ListSelector");var A=mstrmojo.dom;mstrmojo.TreeBrowserSelector=mstrmojo.provide("mstrmojo.TreeBrowserSelector",mstrmojo.hash.copy({premousedown:function B(F,I,E){if(A.isPrimaryMouseBtn(E.e)){var D=E.hWin,H=E.e,G=A.eventTarget(D,H),C=F.listMapper.findIndex(F,I,G);if(C>-1){F.toggleSelect(C);}}}},mstrmojo.hash.copy(mstrmojo.ListSelector)));})();(function(){mstrmojo.requiresCls("mstrmojo.array","mstrmojo.hash","mstrmojo.string","mstrmojo.models.template.Titles","mstrmojo.models.template.MetricValue","mstrmojo.models.template.Headers","mstrmojo.models.datasets.DataInterface");var Y=mstrmojo.array,K=mstrmojo.hash,j=mstrmojo.string,V=mstrmojo.models.datasets.DataInterface,L=j.decodeHtmlString;var P=-1,g=1,S=2,E=3;var H=1,f=2,C=3;var I="0";function J(m){var n={};K.forEach(m,function(q,p){var o=[];Y.forEach(q,function(r){o.push({fillColor:r.fillclr,text:r.n});});n[p]=o;});return n;}function U(p){var AB=this.getTotalRows(),r=this.data,v=[],x=r.gts.col[0],o=x?x.es:[],AA=o.length,t=0;p=K.copy(p,{minAttribute:1,minMetric:1});if(AB<p.minAttribute||AA<p.minMetric){throw"Error";}do{var n=this.getRowHeaders(t),q,m={},w=n.size();for(q=0;q<w;q++){while(q<w&&n.getHeader(q).getFormIndex()!==undefined){q++;}if(q<w){var u=n.getHeader(q);m[u.t.n]=u.getName();}}for(q=0;q<o.length;q++){var z=this.getMetricValue(t,q).value;m[o[q].n]={v:z.v,rv:z.rv};}v.push(m);t++;}while(t<AB);return v;}function B(n){var m=[],o=this.data.gts.row;Y.forEach(o,function(q,p){Y.forEach(n,function(r){if(q.id===r.id){m[p]=true;}});});return m;}function e(AQ){var x=this.getTotalRows(),AS=this.data,w=[],AA=AS.gts.col[0],r=AA?AA.es:[],AH=r.length,v,AL=0;AQ=K.copy(AQ,{minAttribute:1,minMetric:1,colorByInfo:[],hasTitleName:false,hasSelection:false,needDecode:false});if(x<AQ.minAttribute||AH<AQ.minMetric){throw"Error";}var m=AQ.needDecode,AN=AQ.hasTitleName,AM=AQ.hasSelection,AT=AQ.hasThreshold,AF=AQ.colorByInfo;var AR=AT?J(AS.th):undefined;v=B.call(this,AF);do{var o=this.getRowHeaders(AL),q={},AJ,AI=[],AP=AF.length,n={headers:[],values:[],colorInfo:[]};for(AJ=0;AJ<o.size();AJ++){var AK=o.getHeader(AJ),AC=AK.getName(),AV=AK.t,u={name:m?L(AC):AC};if(AN){var AU=AV&&AV.n;u.tname=m?L(AU):AU;}if(AM){var AE=AV&&AV.id,z=AK.getElementId();u.attributeSelector={n:AC,tid:AE,eid:z,isSelectAttr:true};q[AE]=[{n:AC,id:z}];}if(AP&&v[AJ]===true){var AB=AK.getElementId();AI.push(AB);}n.headers.push(u);}if(AP){n.colorInfo=AI;}for(AJ=0;AJ<r.length;AJ++){var AG=this.getMetricValue(AL,AJ).value,AO={v:AG.v,rv:AG.rv};if(AT){var t=AR[AJ],p=t&&t[AG.ti];if(p){AO.threshold=p;}}if(AN){var AD=this.getColTitles().titles[0].es[AJ].n;AO.name=m?L(AD):AD;}n.values.push(AO);}if(AM){n.metricSelector=q;}w.push(n);AL++;}while(AL<x);return w;}function O(AG){var AJ=this.data,q=this.getTotalRows(),r=AJ.gts.col[0],o=r?r.es:[],v=o.length,w={},x=[],AA,AB=0,z;AG=K.copy(AG,{minAttribute:1,minMetric:1,descKey:"name",childrenKey:"children",hasTitleName:false,hasSelection:false,needDecode:false,nestedLevel:undefined,colorByInfo:[]});if(q<AG.minAttribute||v<AG.minMetric){throw"Error";}var p=AG.descKey,t=AG.childrenKey,m=AG.needDecode,AD=AG.hasTitleName,AC=AG.hasSelection,n=AG.nestedLevel||0,AI=AG.hasThreshold,u=AG.colorByInfo,AE=u.length;var AH=AI?J(AJ.th):undefined;w[p]="root";AA=B.call(this,u);var AF=function(Af,AM,AW,AZ,AP){var AT=(Af[t]=Af[t]||[]),Ag=AM.getHeader(AW),Ak=Ag&&Ag.t,Ad=Ak&&Ak.id,Ab=(Ag&&Ag.getName())||"",AX=AM&&AM.headers&&AM.headers.length||0,Ah,Aa=Ag&&Ag.getElementId(),AL=Y.filterOne(AT,function(Al){return(Al._eid===Aa);});Ah=Y.some(AA,function(Am,Al){return Am&&((AW-Al)%AX===0);});var Ai=AW+1,AR=[Ab];while(Ai<AM.size()){var AQ=AM.getHeader(Ai),AK=AQ&&AQ.t,AS=AK&&AK.id;if(AS===Ad){AW++;if(AQ&&AQ.getName()){AR.push(AQ.getName());}}else{break;}Ai++;}Ab=AR.join(" ");if(AE&&Ah){x.push(Aa);}if(!AL||(AW===n-1)){AL={_eid:Aa};var AV=(Ag!==undefined);if(AV){AL[p]=m?L(Ab):Ab;}if(AD&&AV){var Aj=Ak&&Ak.n;AL.tname=m?L(Aj):Aj;}if(AC&&AV){AL.attributeSelector={n:Ab,tid:Ad,eid:Aa,isSelectAttr:true};}AT.push(AL);}if(AC&&AV){AP[Ad]=[{n:Ab,id:Aa}];}if(AW<AM.size()-1&&(!n||(AW<n-1))){AF.call(this,AL,AM,AW+1,AZ,AP);}else{var AY=this.getMetricValue(AZ,0).value;if(AY){AL.value=AY.rv;AL.formattedValue=AY.v;}if(AE){AL.colorInfo=x;x=[];}AL.values=[];for(z=0;z<o.length;z++){var Ae=this.getMetricValue(AZ,z).value,AN={v:Ae.v,rv:Ae.rv};if(AI){var AU=AH[z],AO=AU&&AU[Ae.ti];if(AO){AN.threshold=AO;}}if(AD){var Ac=this.getColTitles().titles[0].es[z].n;AN[p]=m?L(Ac):Ac;}AL.values.push(AN);}if(AC){AL.metricSelector=AP;}}};do{AF.call(this,w,this.getRowHeaders(AB),0,AB,{});AB++;}while(AB<q);return w;}function X(m,n){var o=[];Y.forEach((m.row||[]).concat(m.col||[]),function(p){if((p.id===n)&&(p.fs)){o=o.concat(p.fs);}});return o;}mstrmojo.models.template.DataInterface=mstrmojo.declare(null,null,{scriptClass:"mstrmojo.models.template.DataInterface",data:null,init:function(m){this.data=m;},getRowTitles:function(){return new mstrmojo.models.template.Titles({data:this.data,isRow:true});},getColTitles:function(){return new mstrmojo.models.template.Titles({data:this.data,isRow:false});},getTotalRows:function b(){if(this.data.eg){return 0;}var o=this.data,n=o&&o.ghs,m=n&&n.rhs,p=m&&m.items;return(p&&p.length)||0;},getTotalColHeaderRows:function c(){var m=this.data.ghs.chs.items;return(m&&m.length)||0;},getTotalCols:function D(){return this.getColHeaders(0).size();},getRowHeaders:function W(m){return new mstrmojo.models.template.Headers({data:this.data,i:m,isRow:true});},getColHeaders:function Z(m){return new mstrmojo.models.template.Headers({data:this.data,i:m,isRow:false});},getMetricValue:function F(o,m){var n=this.data;return new mstrmojo.models.template.MetricValue({data:n,value:n.gvs.items&&n.gvs.items[o].items[m]});},getColumnHeaderCount:function N(){var m=this.data.gvs.items;return m?m[0].items.length:0;},getCSSString:function a(){return this.data.cssString;},isEmpty:function M(){var m=this.data.gsi;return !m||(!m.rows.length&&!m.cols.length&&!m.mx.length);},getAggregatePadding:function G(){var n=this.data.gsi&&this.data.gsi.fmts,o=function(q,p){return q+p;},m=function(q){var p=0;return["ch","rh","va"].map(function(r){var t=false;return q.map(function(u){if(n[r]&&n[r].hasOwnProperty(u)){if(!t){t=true;p++;}return n[r][u];}return 0;}).reduce(o)/q.length;}).reduce(o)/(p||1);};if(!n){return null;}return{v:m(["tp","bp"]),h:m(["rp","lp"])};},getColResizeScenario:function h(){var m=this.data;if(m.afw){return g;}else{if(m.afc===false){return E;}else{return S;}}},getColResizeInfo:function d(r){var t=this.data,p={v:this.getColResizeScenario(),widths:null};var u=t.gsi,n=t.gts||{},x=[],q=t.twm||{},v=q.top||[],w=q.bottom||[],o=0,m=function(AA,z){if(u){u[AA].every(function(AC){var AD=AC.did,AE=X(n,AD),AB=V.getFormsByAttrId(AD,r);(AE.length?AE:[]).forEach(function(AH,AG){var AI=AB[Y.find(AB,"fid",AH.id)],AF=(w&&w[o])||{};x.push({n:AC.n+(AB.length?(" - "+AI.fnm):""),did:AD,depth:AG+1,t:AC.t||4,width:parseInt(AF.w||0,10),widthModel:{top:(v&&v[o])||{},bottom:AF}});o++;});return !z;});}};m("rows",false);if(x.length===0){m("cols",false);}m("mx",u.tma===1);p.widths=x;return p;},getRowResizeScenario:function Q(){return !!this.data.rh?E:S;},getRowResizeInfo:function A(){var n=this.data,m=n.rh;return{v:this.getRowResizeScenario(),height:(m===undefined||m==="")?n.xrh:m};},getColumnHeaderData:function R(z){var t=this.data,AB=t.gts,AA=t.gts.rec,AC=[],n=[],w=AB.row,u=t.gsi.prop.rows.shw===I&&z;Y.forEach(w,function(AE){var AD=AE.fs,AF=AE.otp===P;if(!u){if(AD&&AD.length>1){Y.forEach(AD,function(){AC.push(AE);});}else{AC.push(AE);}}if(AF){n=AE.es;}});var r=AB.col;if(r&&r.length>0){var q=t.ghs,o=q.chs,m=o.items,x=m[m.length-1].items,p=function p(AD){var AE=AD.pi,AF=AE&&AE.ci,AG=AE&&AE.ri;if(AD.mix!==undefined){return AD;}if(AG===undefined||AF===undefined){return ;}return p(m[AG].items[AF]);};Y.forEach(r,function(AD){var AE=AD.otp===P;if(!u&&(AE&&(!AA||w.length===0))){AC.push(AD);}if(AE){n=AD.es;}});var v=AC.length;Y.forEach(x,function(AD){delete AD._ridx;});if(n.length>0){Y.forEach(x,function(AG){var AD=p(AG);var AH=AD?AD.idx:(AG.pi?0:AG.idx),AF=n[AH]||n[0];var AE=AF._ridx=AF._ridx||[];if(AE.length===0){Y.forEach(x,function(AJ,AK){var AI=p(AJ);if(!AD||AI.mix===AH){AE.push(v+AK);}});}AC.push(AF);});}}else{if(n.length>0){AC.push(n[0]);}}return AC;},getUnitById:function k(o){var n=this.data.gsi,m=null;[n.rows,n.cols,n.mx].some(function(p,q){if(q===2){q=-2;}p.some(function(r,t){if(r.did===o){m={axis:q+1,depth:t+1,unit:r};}return !!m;});return !!m;});return m;},getRawData:function l(m,n){switch(m){case f:return U.call(this,n);case C:return e.call(this,n);}return O.call(this,n);}});mstrmojo.models.template.DataInterface.inflateGridData=function(o){var p=o.gvs,n=o.ghs;if(o.egt===undefined&&(o.eg===undefined||o.eg===null)&&!!p&&K.isEmpty(p)){var m={v:"",rv:""},q={items:(n.chs.cws||[0]).map(function(){return m;})};p.items=n.rhs.items?n.rhs.items.map(function(){return q;}):[];p.show=true;}};mstrmojo.models.template.DataInterface.ENUM_GRID_RESIZE={FIT_TO_WINDOW:g,FIT_TO_CONTENTS:S,FIXED:E};mstrmojo.models.template.DataInterface.ENUM_RAW_DATA_FORMAT={TREE:H,ROWS:f,ROWS_ADV:C};}());(function(){mstrmojo.requiresCls("mstrmojo.publisher");var C=mstrmojo.publisher;mstrmojo._Provider=mstrmojo.provide("mstrmojo._Provider",{_meta_usesSuper:false,audibles:{"*":true},set:function F(N,H){var G=false,K=this["_set_"+N],I=this[N];if(K){G=K.apply(this,arguments);}else{this[N]=H;G=(I!==H);}if(G){var L=N+"Change",M=this.audibles||{},J=(M[N]===true)||((M[N]!==false)&&(M["*"]!==false));if(J&&(this["pre"+L]||this["on"+L]||this["post"+L]||C.hasSubs(this.id,L))){this.raiseEvent({name:L,prop:N,value:H,valueWas:I});}}return this;},raiseEvent:function B(H){var M=H&&H.name;if(!M){return null;}H.src=this;this.preHandleEvent(H);var K=["pre","on","post"],L=false,I,G;for(I=0,G=K.length;I<G;I++){var J=K[I]+M;if(this[J]){if(this[J](H)===false){L=true;break;}}}if(!L){this.postHandleEvent(H);C.publish(this.id,M,H);}return H;},preHandleEvent:mstrmojo.emptyFn,postHandleEvent:mstrmojo.emptyFn,attachEventListener:function A(G,H,I){return C.subscribe(this.id,G,I,H);},detachEventListener:function E(G){C.unsubscribe(G);},destroy:function D(){C.clearSubscriptions(this.id);if(this._super){this._super();}}});}());(function(){mstrmojo.requiresCls("mstrmojo.registry","mstrmojo.array","mstrmojo.publisher");var D=mstrmojo.registry,K=mstrmojo.array,I=mstrmojo.publisher;function G(Q,R){if(R){R.parent=Q;var P=D.ref(R);if(R!==P){delete R.parent;}return P;}return null;}function L(Q,R){var P=R.alias;if(P!==null&&P!==""){Q[P]=R;}}function N(Q,R){var P=R.alias;if(R.parent===Q){delete R.parent;}if((P!==null&&P!=="")&&(Q[P]===R)){delete Q[P];}}function A(U,Q){var P=Q&&Q.length,S,R;if(P){S=[];for(R=0;R<P;R++){var V=G(U,Q[R]);if(!V){continue;}S.push(V);L(U,V);}}return S;}mstrmojo._HasChildren=mstrmojo.provide("mstrmojo._HasChildren",{_meta_usesSuper:false,children:null,postCreateChildren:mstrmojo.emptyFn,onaddChild:null,onremoveChild:null,initChildren:function F(){var P="children",Q=this[P];if(!Q){return ;}this[P]=null;this._set_children(P,Q,true);this.postCreateChildren();},_set_children:function E(S,Q,P){var R=this.children;if(Q!==R){if(R){this.removeChildren(null,P);}this.addChildren(Q,0,P);}return false;},destroyChildren:function C(S){var R=this.children,P=(R&&R.length)||0,Q;if(P){for(Q=P-1;Q>-1;Q--){var U=R[Q];if(U&&U.destroy){U.destroy(S);if(!S){N(this,U);}}}if(!S){R.length=0;}}},invalidateChildren:function B(){mstrmojo.array.forEach(this.children,function(P){P.invalidate();});},invalidate:function H(){this.invalidateChildren();},addChildren:function O(V,Q,R){if(!V){return V;}var U=V.constructor===Array,P=A(this,U?V:[V]);if(P&&P.length){var S=this.children||[];if(Q===null||Q===undefined){Q=S.length;}this.children=K.insert(S,Q,P);if(!R&&(this.onaddChild||I.hasSubs(this.id,"addChild"))){this.raiseEvent({name:"addChild",value:P,index:Q});}}return U?P:(P&&P[0]);},removeChildren:function J(W,R){var U=this.children,V=W?[W]:(this.children||[]).concat(),Q=V.length,P=-1,S;if(Q){for(S=Q-1;S>-1;S--){N(this,V[S]);}if(W){P=K.removeItem(U,W);}else{if(U){U.length=0;P=0;}}if(!R&&(this.onremoveChild||I.hasSubs(this.id,"removeChild"))){this.raiseEvent({name:"removeChild",value:V,index:P});}}return P;},removeAndDestroyChild:function M(R,P,Q){if(R){if(R.parent!==this){throw"Unable to remove an object that is not in the children collection.";}this.removeChildren(R,P);R.destroy(Q);}}});}());(function(){mstrmojo.requiresCls("mstrmojo.locales");var Y=function(){return mstrmojo.locales.datetime;},L=mstrmojo.string;mstrmojo.date=mstrmojo.provide("mstrmojo.date",{monthNumbers:{Jan:1,Feb:2,Mar:3,Apr:4,May:5,Jun:6,Jul:7,Aug:8,Sep:9,Oct:10,Nov:11,Dec:12},REGEXPS:{DATES:{},TIMES:{}},CACHE:{PARSEDATE:{CONTAINS:{},EQUALS:{}},PARSETIME:{CONTAINS:{},EQUALS:{}}},now:Date.now||function D(){return new Date().getTime();},isDate:function Z(c,g,b){var e=this.parseDate(c,b);var f=!!(e&&this.doesDateExist(e.month,e.day,e.year));if(g){if(f){var d=this.formatDateInfo(e,Y().DATEOUTPUTFORMAT);if(b){return{match:e.match,formatted:d};}return d;}return null;}return !!f;},formatDateInfo:function R(e,g){if(!g){return"";}var b=e.day,f=e.month,d=e.year;var c=g.replace(/dd/g,this.formatInteger(b,2)).replace(/d/g,Number(b)).replace(/yyyy/g,Number(d)).replace(/yy/g,this.formatInteger(Number(d)%100,2)).replace(/MMM/g,"~~~~").replace(/MM/g,"@@").replace(/M/g,"^").replace(/MMMM/g,Y().MONTHNAME_FULL[Number(f)-1]).replace(/\~\~\~\~/g,Y().MONTHNAME_SHORT[Number(f)-1]).replace(/\@\@/g,this.formatInteger(f,2)).replace(/\^/g,Number(e.month));return c;},parseDate:function a(m,g,k){if(m==null){return false;}if(typeof m!=="string"){m=String(m);}m=L.trim(m);var b=this.CACHE.PARSEDATE[g?"CONTAINS":"EQUALS"],d=b[m];if(d||(d===null)){return d;}var c=null;var j;if(k){j=[k];}else{j=[].concat(Y().DATEINPUTFORMATS);j.unshift(Y().DATEOUTPUTFORMAT);}var e,f;for(e=0,f=j.length;e<f;e++){var h=this._buildRegExp4DateFormat(j[e]),l=h&&m.match(g?h.reContains:h.reEquals);if(l){c={match:l[0],year:h.yearIndex&&this.fourDigitYear(l[h.yearIndex]),day:h.dayIndex&&parseInt(Number(l[h.dayIndex]),10),month:h.monthIndex&&this.numericMonth(l[h.monthIndex])};break;}}b[m]=c;return c;},isTime:function I(c,f,b){var g=this.parseTime(c,b);var e=!!(g&&this.doesTimeExist(g.hour,g.min,g.sec));if(f){if(e){var d=this.formatTimeInfo(g,Y().TIMEOUTPUTFORMAT);if(b){return{match:g.match,formatted:d};}return d;}return null;}return !!e;},parseTime:function J(n,g,l){if(n==null){return false;}if(typeof n!=="string"){n=String(n);}n=L.trim(n);var b=this.CACHE.PARSETIME[g?"CONTAINS":"EQUALS"],d=b[n];if(d||(d===null)){return d;}var c=null;var k;if(l){k=[l];}else{k=[].concat(Y().TIMEINPUTFORMATS);k.unshift(Y().TIMEOUTPUTFORMAT);}var e,f;for(e=0,f=k.length;e<f;e++){var j=this._buildRegExp4TimeFormat(k[e]),m=j&&n.match(g?j.reContains:j.reEquals);if(m){var h=j.ampmIndex&&m[j.ampmIndex];c={match:m[0],hour:j.hourIndex&&this.capitalHour(m[j.hourIndex],h),min:j.minIndex&&parseInt(Number(m[j.minIndex]),10),sec:j.secIndex&&parseInt(Number(m[j.secIndex]),10)};break;}}b[n]=c;return c;},formatTimeInfo:function S(e,c){if(!c){return"";}var d=!(Number(e.hour)%12)?12:(Number(e.hour)%12),b=c.replace(/HH/g,this.formatInteger(e.hour,2)).replace(/H/g,Number(e.hour)).replace(/hh/g,this.formatInteger(d,2)).replace(/h/g,d).replace(/mm/g,this.formatInteger(Number(e.min)||0,2)).replace(/m/g,Number(e.min)||0).replace(/ss/g,this.formatInteger(Number(e.sec)||0,2)).replace(/s/g,Number(e.sec)||0).replace(/a/g,(Number(e.hour)<12)?Y().AM_NAME:Y().PM_NAME).replace(/tt/g,(Number(e.hour)<12)?Y().AM_NAME:Y().PM_NAME).replace(/AM\/PM/g,(Number(e.hour)<12)?Y().AM_NAME:Y().PM_NAME);return b;},doesTimeExist:function G(g,c,f){var e=parseInt(g,10);if(e>=0&&e<=23){var b=parseInt(c,10);if(b>=0&&b<=59){if(!f){return true;}var d=parseInt(f,10);if(d>=0&&d<=59){return true;}}}return false;},capitalHour:function C(b,c){b=parseInt(Number(b),10);if(c&&(c.match(Y().AM_NAME)||c.match(/AM/i))){return b%12;}if(c&&(c.match(Y().PM_NAME)||c.match(/PM/i))){return 12+(b%12);}return b;},getTimeStamp:function O(){var c=new Date();var b=[c.getMonth()+1,c.getDate(),c.getFullYear()];var f=[c.getHours(),c.getMinutes(),c.getSeconds()];var e=(f[0]<12)?"AM":"PM";f[0]=(f[0]<12)?f[0]:f[0]-12;f[0]=f[0]||12;for(var d=1;d<3;d++){if(f[d]<10){f[d]="0"+f[d];}}return b.join("-")+" "+f.join("")+" "+e;},isDateAndOrTime:function W(b,c){return this.isDateTime(b,c)||this.isDate(b,c)||this.isTime(b,c);},isDateTime:function B(l,b){var f=this.parseDateAndOrTime(l),j=f&&f.date,e=f&&f.time,h=!!j&&!!e&&this.doesDateExist(j.month,j.day,j.year)&&this.doesTimeExist(e.hour,e.min,e.sec);if(b){if(h){var c=this.formatDateInfo(j,Y().DATEOUTPUTFORMAT),d=this.formatTimeInfo(e,Y().TIMEOUTPUTFORMAT),k=l.indexOf(j.match),g=l.indexOf(e.match);return(g<k)?d+" "+c:c+" "+d;}return null;}return !!h;},parseDateAndOrTime:function Q(c,b,g){var d=this.parseDate(c,true,b);var e=L.trim((d&&d.match)?c.replace(d.match,""):c),f=this.parseTime(e,false,g);if(!d&&!f){return null;}return{date:d,time:f};},inDateTimeRange:function P(d,f,j){var c=this.parseDateAndOrTime(d),g=c&&c.date,k=c&&c.time;if(!g&&!k){return 0;}if(f!=null){var e=this.parseDateAndOrTime(f);if(g&&e&&e.date){var l=this.compareDate(g,e.date);if(l<0){return -1;}if(l==0){if(k&&e.time&&(this.compareTime(k,e.time)<0)){return -1;}}}}if(j!=null){var b=this.parseDateAndOrTime(j);if(g&&b&&b.date){var h=this.compareDate(g,b.date);if(h>0){return 1;}if(h==0){if(k&&b.time&&(this.compareTime(k,b.time)>0)){return 1;}}}}return 0;},compareDate:function A(d,b){if(d===b){return 0;}var e=typeof d==="string"?this.parseDate(d):d,c=typeof b==="string"?this.parseDate(b):b;if(!e){return -1;}if(!c){return 1;}return(e.year-c.year)||(e.month-c.month)||(e.day-c.day)||0;},compareTime:function K(c,b){if(c===b){return 0;}var e=typeof c==="string"?this.parseTime(c):c,d=typeof b==="string"?this.parseTime(b):b;if(!e){return -1;}if(!d){return 1;}return(e.hour-d.hour)||(e.min-d.min)||(e.sec-d.sec)||0;},compareDateTime:function V(c,b){return this.compareDate(c,b)||this.compareTime(c,b);},compareDateAndOrTime:function E(j,g){if(j===g){return 0;}var c=typeof j==="string"?this.parseDateAndOrTime(j):j,b=typeof g==="string"?this.parseDateAndOrTime(g):g;if(!c){return -1;}if(!b){return 1;}var h=c.date,f=b.date,e=c.time,d=b.time;return this.compareDate(h,f)||this.compareTime(e,d);},_buildRegExp4DateFormat:function N(d){if(!d){return null;}var f=this.REGEXPS.DATES[d];if(!f){if(!this.REGEXPS.MONTHNAME_FULL){this.REGEXPS.MONTHNAME_FULL=Y().MONTHNAME_FULL.join("|");this.REGEXPS.MONTHNAME_SHORT=Y().MONTHNAME_SHORT.join("|");}f=this.REGEXPS.DATES[d]={};f.formatStr=d;var c=f.reStr=d.replace(/([^M|d|y|\s])/g,"\\$1").replace(/dd/g,"~~~~").replace(/d/g,"(\\d{1,2})").replace(/\~\~\~\~/g,"(\\d\\d)").replace(/yyyy/g,"(\\d\\d\\d\\d)").replace(/yy/g,"(\\d\\d)").replace(/MMMM/g,"@@@@").replace(/MMM/g,"@@@").replace(/MM/g,"(\\d\\d)").replace(/M/g,"(\\d{1,2})").replace("@@@@","("+this.REGEXPS.MONTHNAME_FULL+")").replace("@@@","("+this.REGEXPS.MONTHNAME_SHORT+")");f.reEquals=new RegExp("^"+c+"$");f.reContains=new RegExp("^"+c+"\\b");var g=[{key:"monthIndex",index:d.indexOf("M")},{key:"dayIndex",index:d.indexOf("d")},{key:"yearIndex",index:d.indexOf("y")}];g.sort(function(j,h){return j.index-h.index;});var b=1,e;for(e=0;e<3;e++){f[g[e].key]=g[e].index>-1?b++:null;}}return f;},_buildRegExp4TimeFormat:function F(e){if(!e){return null;}var g=this.REGEXPS.TIMES[e];if(!g){if(!this.REGEXPSTR_AMPM){this.REGEXPSTR_AMPM=[Y().AM_NAME,Y().PM_NAME,String(Y().AM_NAME).toLowerCase(),String(Y().PM_NAME).toLowerCase()].join("|");}g=this.REGEXPS.TIMES[e]={};g.formatStr=e;var d=e.replace(/\'\'/g,'"');var h=d.match(/\'(.+?)\'/g);d.replace(/\'(.+?)\'/g,"*");d=d.replace(/([^H|h|m|s|z|Z|a|t|\s|A|P|M|\/])/g,"\\$1").replace(/HH|hh/g,"(\\d\\d)").replace(/H|h/g,"(\\d{1,2})").replace(/mm/g,"(\\d\\d)").replace(/m/g,"(\\d{1,2})").replace(/ss/g,"(\\d\\d)").replace(/s/g,"(\\d{1,2})").replace(/a/g,"("+this.REGEXPSTR_AMPM+")").replace(/AM\/PM/,"("+this.REGEXPSTR_AMPM+")").replace(/tt/g,"("+this.REGEXPSTR_AMPM+")").replace(/z|Z/g,"(.+?)");var f,b;for(f=1,b=(h&&h.length)||0;f<b;f++){d=d.replace(/\*/,h[f]);}d=d.replace(/\"/g,"'");g.reEquals=new RegExp("^"+d+"$");g.reContains=new RegExp(d);var j=[{key:"hourIndex",index:e.search(/h|H/)},{key:"minIndex",index:e.indexOf("m")},{key:"secIndex",index:e.indexOf("s")},{key:"ampmIndex",index:e.search(/tt|a|AM\/PM/)},{key:"zoneIndex",index:e.search(/z|Z/)}];j.sort(function(l,k){return l.index-k.index;});var c=1;for(f=0;f<5;f++){g[j[f].key]=j[f].index>-1?c++:null;}}return g;},doesDateExist:function M(e,b,c){var d=new Date(c,e-1,b);return c==d.getFullYear()&&e==d.getMonth()+1&&b==d.getDate();},fourDigitYear:function U(c){c=parseInt(Number(c),10);if(!isNaN(c)){var b=(Y().TWODIGITYEARSTART%100)||0;if(c>=0&&c<=b){c=2000+c;}else{if(c>b&&c<100){c=1900+c;}}}return c;},numericMonth:function X(f){var e=parseInt(Number(f),10),d=mstrmojo.array;if(!isNaN(e)){return e;}var b=(f&&f.length)||0,c=-1;if(b){if(b<=3){c=d.indexOf(Y().MONTHNAME_SHORT,f);}if(c===-1){c=d.indexOf(Y().MONTHNAME_FULL,f);}}return c+1;},formatInteger:function H(d,c){var g=String(d),f=Math.max(c-g.length,0);if(f>0){var b=[g],e;for(e=1;e<=f;e++){b.push("0");}g=b.reverse().join("");}return g;},getFirstDateOfMonth:function(c,b){return new Date(c,b-1,1);},getDateObject:function(h,b,g,e,f,c){h=h||0;b=b||1;g=g||1;e=e||0;f=f||0;c=c||0;return new Date(h,b-1,g,e,f,c);},getDateFromDateInfo:function(b){return this.getDateObject(b.date&&b.date.year,b.date&&b.date.month,b.date&&b.date.day,b.time&&b.time.hour,b.time&&b.time.min,b.time&&b.time.sec);},getDateJson:function(b){return{year:b.getFullYear(),month:b.getMonth()+1,day:b.getDate(),hour:b.getHours(),min:b.getMinutes(),sec:b.getSeconds()};},isLeapYear:function(b){return !(b%400)||(!(b%4)&&!!(b%100));},getDaysOfMonth:function(d,b){var c=[31,28,31,30,31,30,31,31,30,31,30,31];if(b==2&&this.isLeapYear(d)){return 29;}return c[b-1];},getPreMonth:function(c,b){if(b===1){return{y:c-1,m:12};}return{y:c,m:b-1};},getNextMonth:function(c,b){if(b===12){return{y:c+1,m:1};}return{y:c,m:b+1};}});}());(function(){mstrmojo.requiresCls("mstrmojo.locales","mstrmojo.string","mstrmojo.array");var M=mstrmojo.locales,I=mstrmojo.string,P=window.mstrConfig,F=mstrmojo.array,C=P.units,R={CM:1,IN:2,MM:3,PT:4,PC:5,PX:6},A={1:"cm",2:"in",3:"mm",4:"pt",5:"pc",6:"px"},E={DEFAULT:-2,FIXED:0,CURR:1,PERCENT:4,FRACTION:5,SCIENTIFIC:6,GENERAL:9};var G=96;String.prototype.reverse=function(){var V="",U;for(U=this.length;U>0;--U){V+=this.charAt(U-1);}return V;};function K(U,W){U=U||"";W=W||U.match(/\".+?\"/g)||[];for(var V=0;V<W.length;V++){U=U.replace(W[V],W[V].substring(1,W[V].length-1).replace(/\$/g,"$$$$"));}return U;}function S(Z){var U=86400000,Y=new Date(1900,0,1,0,0,0,0),V=Math.floor(Z)-1,X=Z-V-1;if(Z>=59){V--;}var W=new Date(Y.getTime()+(V*U));W.setTime(W.getTime()+X*U+500);return W;}function H(Y,f,h){var Z={"d+":Y.getDate(),"h+|H":Y.getHours(),"s+":Y.getSeconds()},U=M.datetime,a;if(/(y+)/.test(f)){var X=Y.getFullYear().toString(),e=RegExp.$1,W=e.length===2,V=X.length;f=f.replace(e,X.substr(W?V-2:0,W?2:V));}if(/(^\[h\])/.test(f)&&h){f=f.replace(RegExp.$1,""+(Math.floor(h*24)));}if(/(\"?:\"?mm)/.test(f)){var b=Y.getMinutes();f=f.replace(RegExp.$1,":"+(RegExp.$1.length===1?b:("00"+b).substr(b.toString().length)));}if(/(AM\/PM)/.test(f)){var g=Z["h+"],c=g>11;Z["h+"]=g-(c?12:0);f=f.replace(RegExp.$1,c?"PM":"AM");}for(a in Z){if(new RegExp("("+a+")").test(f)){f=f.replace(RegExp.$1,RegExp.$1.length===1?Z[a]:("00"+Z[a]).substr((Z[a].toString()).length));}}if(/(mmmm)/.test(f)){f=f.replace(RegExp.$1,U.MONTHNAME_FULL[Y.getMonth()]);}else{if(/(mmm)/.test(f)){f=f.replace(RegExp.$1,U.MONTHNAME_SHORT[Y.getMonth()].substr(0,3));}else{if(/((m|M)+)/.test(f)){var d=(Y.getMonth()+1).toString();f=f.replace(RegExp.$1,RegExp.$1.length===1?d:("00"+d).substr(d.length));}}}return K(f);}function N(V,Y){var W=0,U=Y.length,X=0;for(;W<U;W++){if(Y[W]==="0"){X++;}else{if(Y[W]==="#"){if(X<V){X++;}}else{continue;}}}return X;}mstrmojo.num=mstrmojo.provide("mstrmojo.num",{isInt:function D(U){var X=this.getThousand(),W=new RegExp("^(-)?[0-9]{1,3}(\\"+X+"[0-9]{3})*$"),V=new RegExp("^(-)?[0-9]+$");return(String(U).indexOf(X)&&W.test(U))||V.test(U);},isNumeric:function O(Y){var X=this.getDecimal(),Z=this.getThousand(),W=new RegExp("^(-)?[0-9]{1,3}(\\"+Z+"[0-9]{3})*(\\"+X+"[0-9]+)?$"),V=new RegExp("^(-)?[0-9]*(\\"+X+")?[0-9]+$"),U=new RegExp("^(-)?[0-9]{1}(\\"+X+")[1-9]+[eE]{1}[-]{0,1}[0-9]+$");return(String(Y).indexOf(Z)&&W.test(Y))||V.test(Y)||U.test(Y);},isBigDecimal:function(V){if(!V){return false;}var U=String(V).match(/^#([^#]+)#$/);if(!U||U.length<=1){return false;}var W=U[1];return this.isNumeric(W);},parseInteger:function L(U,V){if(!this.isInt(U)){return Number.NaN;}return parseInt(this.toString(U,true),V);},parseNumeric:function B(U){if(!this.isNumeric(U)){return Number.NaN;}return parseFloat(this.toString(U,true));},parseBigDecimal:function(U){return String(U).match(/^#(.+)#$/)[1];},inNumericRange:function Q(V,W,U){V=this.parseNumeric(V);U=(U!=null)?this.parseNumeric(this.toLocaleString(U)):Number.NaN;W=(W!=null)?this.parseNumeric(this.toLocaleString(W)):Number.NaN;if(U!=Number.NaN&&(V>U||isNaN(V))){return 1;}if(W!=Number.NaN&&(V<W||isNaN(V))){return -1;}return 0;},convertToUSUnits:function(X,W,V){var U=X;W=W||C;switch(parseInt(W,10)){case R.CM:U=parseFloat(this.toString(X))/2.54+"";break;case R.MM:U=parseFloat(this.toString(X))/25.4+"";break;case R.PT:U=parseFloat(this.toString(X))/72+"";break;case R.PC:U=parseFloat(this.toString(X))/6+"";break;case R.PX:U=parseFloat(this.toString(X))/G+"";break;}return V?U:this.toLocaleString(U);},convertToLocalUnits:function(X,W,V){var U;W=W||C;switch(parseInt(W,10)){case R.CM:U=(parseFloat(this.toString(X))*2.54).toFixed(4)+"";break;case R.MM:U=(parseFloat(this.toString(X))*25.4).toFixed(4)+"";break;case R.PT:U=(parseFloat(this.toString(X))*72).toFixed(4)+"";break;case R.PC:U=(parseFloat(this.toString(X))*6).toFixed(4)+"";break;case R.PX:U=(parseFloat(this.toString(X))*G)+"";break;default:U=parseFloat(this.toString(X)).toFixed(4)+"";}return V?U:this.toLocaleString(U);},convertUnits:function(V,W,U){return this.convertToLocalUnits(this.convertToUSUnits(U,V,true),W,true);},toLocaleString:function(U){return(U+"").replace(".",this.getDecimal());},toString:function(W,U){if(U===true){var V=this.getThousandSepRegex();if(V){W=String(W).replace(V,"");}}return String(W).replace(this.getDecimal(),".");},getThousandSepRegex:function(){if(this.thousandSeparatorRegex==null){this.thousandSeparatorRegex=new RegExp(this.getThousand().replace(/(\W){1}/g,"\\$1"),"g");}return this.thousandSeparatorRegex;},addSeparators:function(W,V){var U=V;if(V=="."||V=="*"||V=="\\"){U="\\"+V;}return W.reverse().replace(/(\d{3})/g,"$1"+V).reverse().replace(new RegExp("^(-)?"+U),"$1");},addSeparators2:function(X,W){var U=X,V=/(\d+)(\d{3})/;while(V.test(U)){U=U.replace(V,"$1"+W+"$2");}return U;},format:function(Y,X,b,U){var a="",Z=(X>0)?".":"",V=[];b=(b)?b:"";for(var W=0;W<X;W++){V.push("0");}V=V.join("");switch(Y){case E.GENERAL:a="0.00";break;case E.PERCENT:a="0"+Z+V+"%";break;case E.SCIENTIFIC:a="0"+Z+V+"E+00";break;default:a='"'+b+'"#,##0'+Z+V;}return this.formatByMask(a,U);},getDecimalLength:function J(W){var U=W.indexOf("."),X=0;if(U!==-1){var V=W.substr(U+1,W.length).match(/\d+/);if(V&&V.length>0){X=V[0].length;}}return X;},formatByMask:function(AH,AZ){var AB,n="",t,Ac=false;if(isNaN(AZ)){AB=new Date(AZ);if(isNaN(AB)){return AZ;}t=true;}if(AH==="General"){var AM=String(parseFloat(AZ).toFixed(2));n=AM.split(".");if(n.length===2){return n.join(this.getDecimal());}return AM;}var r=String(AH).split(";"),X=r[0],h="\u00A4",AS=/"[^"]*"/g,l=(AH&&AH.replace(AS,h).replace(/\[.*\]/g,h))||"",AY=["m","y","d","h","s"],AN=false;F.forEach(AY,function(j){AN=AN||l.indexOf(j,0)!==-1;});if(AN){if(window.SSF&&!Ac){n=this.formatBySSF(AH,AZ);Ac=true;}if(n!==""){return n;}else{return H(t?AB:S(AZ),AH,AZ);}}var AL=X.indexOf("E+"),d=X.indexOf("%"),x=X.match(/\".+?\"/g),AE=X.match(/\[([=<>]*)(-?\d+\.?\d*)\]/),z=X.indexOf("?/?")>-1,AF=(AL!=-1)?E.SCIENTIFIC:((d!=-1)?E.PERCENT:((x&&!AE)?E.CURR:z?E.FRACTION:E.FIXED)),q="",AU="",o=false,V=new String(AZ),c=parseFloat(AZ)||this.parseNumeric(AZ);if(x){if(X.match(/\[\$.+?\]/g)){for(var e=0;e<x.length;e++){X=X.replace(x[e],x[e].substring(1,x[e].length-1));if(x[e].match(/\[\$.+?\]/g)){x[e]=x[e].replace(/\[\$.+?\]/g,x[e][x[e].indexOf("[$")+2]);}}X=X.replace(/\[\$.+?\]/g,'"#"'.replace("#",X[X.indexOf("[$")+2]));}q=K(X,x);q=q.replace(X.replace(/\".+?\"/g,""),h);}if(c<0){V=V.substring(1,V.length);c=-c;o=true;if(r.length>1){var a=r[1].replace(/\[.*\]/,"");AU=K(a.replace(r[0],h));}}var k=this,b=function(v,j){var m=j&&j.replace(h,v);if(j&&(m===j)&&window.SSF){if(Ac){return v;}else{Ac=true;return k.formatBySSF(j,v);}}return(j)?m:"-"+v;};if(AF===E.FRACTION){var AQ,AP,AX,p=10,AA,w=0,AJ,AT,Y,W=false,AG;if(AH.indexOf("# ")>-1){W=true;}for(AQ=5;AQ>0;AQ--){AG="/";for(AP=0;AP<AQ;AP++){AG+="?";}if(AH.indexOf(AG)>-1){for(AP=1;AP<AQ;AP++){p*=10;}break;}}if(W){w=Math.floor(Number(c));c-=w;}AT=p/2;AX=-1;AJ=c*p;for(AQ=p-1;AQ>=2;AQ--){Y=(AJ*AQ)/p;Y=Y-Math.floor(Y);Y=Y*p;if(Math.abs(Y-p)<Y){Y=Math.abs(Y-p);}Y=Y/AQ;if(Y<AT){AT=Y;AX=AQ;}else{if((Y==AT)&&(Y==0)){AT=Y;AX=AQ;}}}AA=Math.round(AX*AJ/p);for(AQ=AX;AQ>=2;AQ--){if((AA%AQ==0)&&(AX%AQ==0)){AA=AA/AQ;AX=AX/AQ;break;}}if(AX==p){AX=1;AA=0;}if(AA==0){AX=1;}if(AA==AX){if(W){n=""+(w+1);}else{n="1";}}else{if(W&&w>0){if(AA==0){n=w;}else{n=w+" "+AA+"/"+AX;}}else{if(AA==0){n="0";}else{n=AA+"/"+AX;}}}if(o){n=b(n,AU);}}else{if(AF==E.SCIENTIFIC){if(c!=0){var Aa=Math.floor(Math.log(c)/Math.LN10),AO=c/Math.pow(10,Aa),Ab=X.substring(0,AL),g=Ab.indexOf("."),AI=X.length-X.indexOf("E+")-(""+Math.abs(Aa)).length-2,AQ,U=Aa<0;Aa=Math.abs(Aa);for(AQ=0;AQ<AI;AQ++){Aa="0"+Aa;}n+=Number(AO).toFixed((g!=-1)?Ab.length-g-1:0);n=((o)?b(n,AU):n)+"E"+(U?"-":"+")+Aa;}else{n="0";}}else{if(AF==E.PERCENT){X=X.substring(0,X.length-1);V=String(c*100);}var g=X.indexOf("."),Z=0,AW,u=g>=0?X.substring(0,g):X,AC=g>=0?X.substring(g+1,X.length):"",f=false;if(u.match(/[#0\?],$/)){c/=1000;V=String(c);}else{if(AC.match(/^[#0]*,/)){var AD=0;f=true;while(AD<AC.length){if(AC[AD]==="0"||AC[AD]==="#"){AD++;}else{if(AC[AD]===","){c/=1000;V=String(c);AD++;}else{break;}}}}}AW=this.getDecimalLength(V);if(g!=-1){Z=N(AW,X.substr(g+1,X.length));}n=String((+(Math.round(+(V.indexOf("e")>0?String(parseFloat(V).toFixed(Math.min(Z+2,20))):V+"e"+Math.min(Z,20)))+"e"+-Math.min(Z,20))).toFixed(Math.min(Z,20)));if(AF===E.FIXED){if(/[\[\]><=A-Za-z]|,{2}/.test(X)&&window.SSF){var AR=this.formatBySSF(AH,AZ);n=AR!==""?AR:n;Ac=true;}}var AV=n.split(".");var AK=X.replace(/"[^"]*"/g,"").match(/[#\d]+[^\.\d#]+[#\d]+/);if(AK!==null){if(AF===E.CURR){AV[0]=(this.formatBySSF((f?AK[0]&&AK[0].trim():AK.input&&AK.input.trim()),parseFloat(AV[0]))||"").split(".")[0];Ac=true;}if(AV[0].indexOf(",")>=0){AV[0]=AV[0].replace(/,/g,this.getThousand());}else{if(!(this.getThousand()===","&&AV[0].search(this.getThousand())>0)){AV[0]=this.addSeparators2(AV[0],this.getThousand());}}}n=AV.join(this.getDecimal());if(AF==E.CURR){n=q.replace(h,n);if(n===q&&window.SSF){n=this.formatBySSF(AH,AZ,n);Ac=true;}}if(AF==E.PERCENT){n+="%";}if(o){n=b(n,AU);}}}return n;},formatBySSF:function(W,V,X){var U=(X!==undefined&&X!==null)?X:"";if(typeof V==="string"){V=parseFloat(V);}try{U=window.SSF.format(W,V);}catch(Y){if(window.mstr_profile){window.mstr_profile.log(Y);}U=(X||V).toString();}return U;},validateFormat:function(U){var V=true,W=String(U).split(";");if(W[1]&&W[1].indexOf(W[0])<0){V=false;}return V;},generateUniqueID:function(U){var W="0123456789ABCDEF".split(""),X=[];for(var V=0;V<U;V++){X[V]=W[0|Math.random()*16];}return X.join("");},countOfDecimals:function(V,W){var U=String(V);return U.length-(U.indexOf(W!==undefined?W:this.getDecimal())+1);},getThousand:function(){return mstrmojo.locales.number.THOUSANDSEPARATOR;},getDecimal:function(){return mstrmojo.locales.number.DECIMALSEPARATOR;}});mstrmojo.num.UNIT=R;mstrmojo.num.UNIT_SYMBOL=A;})();(function(){mstrmojo.requiresCls("mstrmojo.array","mstrmojo.hash","mstrmojo.locales");var d=mstrmojo.array,P=mstrmojo.meta.TP,G=mstrmojo.meta.STP,O=mstrmojo.hash,F={ANDOR:14,MQ:10,MC:12,AQ:2,AL:6,AC:9,AE:5,F:13,R:21,B:20,XML:1,RLS:15},B={};var X;for(X in F){B[F[X]]=true;}var b={};b[F.AQ]="a";b[F.AL]="a";b[F.AC]="a";b[F.AE]="a";b[F.MQ]="m";b[F.MC]="m";b[F.F]="f";b[F.R]="r";b[F.XML]="p";b[F.ANDOR]="nds";var K={};K[F.MQ]=["not","m","fn","fnt","cs","dmy","idcsi"];K[F.MC]=["not","m","fn","fnt","m2","m3","p","dmy","idcsi"];K[F.AE]=["not","a","fn","es","a2","fm2","p"];K[F.AQ]=["not","a","fm","fn","cs"];K[F.AL]=["not","a","fm","fn","cs"];K[F.AC]=["not","a","fm","a2","fm2","a3","fm3","fn","cs"];K[F.R]=["not","r"];K[F.F]=["not","f"];K[F.XML]=["not","n","p"];K[F.ANDOR]=["not","node","nds","fn"];var M={};M[F.MQ]="METRIC_FNS";M[F.MC]="METRIC_FNS";M[F.AQ]="FORM_FNS";M[F.AL]="FORM_FNS";M[F.AC]="FORM_FNS";M[F.AE]="ELEM_FNS";var N={FILTER:1,REPORT:3,METRIC:4,FOLDER:8,PROMPT:10,FUNCTION:11,ATTR:12,FACT:13,DIM:14,FORM:21,ROLE:43,CONS:47},c={FILTER:256,CUSTOMGROUP:257,PROMPT:2560,PROMPT_BOOLEAN:2561,PROMPT_LONG:2562,PROMPT_STRING:2563,PROMPT_DOUBLE:2564,PROMPT_DATE:2565,PROMPT_OBJECTS:2566,PROMPT_ELEMENTS:2567,PROMPT_EXPRESSION:2568,PROMPT_EXPRESSION_DRAFT:2569,PROMPT_DIMTY:2570,PROMPT_BIGDECIMAL:2571,REPORT_GRID:768,REPORT_GRAPH:769,REPORT_ENGINE:770,REPORT_TEXT:771,REPORT_DATAMART:772,REPORT_BASE:773,REPORT_GRIDGRAPH:774,REPORT_NONINTERACTIVE:775,REPORT_CUBE:776,REPORT_EMMACUBE:779,CONS:12032,NDE:12033},U={a:N.ATTR,a2:N.ATTR,m:N.METRIC,m2:N.METRIC,r:N.REPORT,f:N.FILTER,p:N.PROMPT},V={f:c.FILTER};var W={};W[F.MQ]=N.METRIC;W[F.MC]=N.METRIC;W[F.AQ]=N.ATTR;W[F.AL]=N.ATTR;W[F.AC]=N.ATTR;W[F.AE]=N.ATTR;W[F.F]=N.FILTER;W[F.R]=N.REPORT;var J=function(e){var H=e.length,h={},g;for(g=0;g<H;g++){var j=e[g];h[j.did]=j.n;}return h;},E=function(f){var H=f.length,g;for(g=0;g<H;g++){var e=f[g];if("tp" in e){e.t=e.tp;}}return f;},Y=function(f,h){var H=f.length,g;for(g=0;g<H;g++){var e=f[g];if("tp" in e){if(h){e.t=h;}else{delete e.t;}}}return f;},a=function(e,g){if(!g){g=[];}g.length=0;var f,H;for(f=0,H=e.length;f<H;f++){g[f]=e[f];}return g;},L={0:[{did:"1,76"},{did:"1,79"},{did:"1,77"},{did:"1,80"},{did:"1,78"},{did:"1,81"},{did:"1,18"},{did:"1,43"}],1:[{did:"2,1"},{did:"2,2"},{did:"3,1"},{did:"3,2"}]};var R={0:[{did:"1,22"},{did:"1,57"}]};mstrmojo.expr=mstrmojo.provide("mstrmojo.expr",{ET:F,ETs:B,ET2TGT:b,ET2COND:K,ET2TP:W,FN:{EQUAL:6,NOT_EQUAL:7,GREATER:8,LESS:9,GREATER_EQUAL:10,LESS_EQUAL:11,IN_LIST:22,NOT_IN_LIST:57,BETWEEN:17,NOT_BETWEEN:44,IS_NULL:54,IS_NOT_NULL:55,AND:19,OR:20,NOT:21,SEARCH:158,DESCENDANT:187},FN_MRP:{BETWEEN:3,EXCLUDE_TOP:4,EXCLUDE_BOTTOM:5,BETWEEN_DESCENDING:13},FNT:{DEF:1,RANK:2,PER:3},FN_SEP:",",TP:N,STP:c,DMY_TP:{ATTR:-1,DIM:-2},DTP:{UNKNOWN:-1,INTEGER:1,UNSIGNED:2,NUMERIC:3,DECIMAL:4,REAL:5,DOUBLE:6,FLOAT:7,CHAR:8,VARCHAR:9,LONGVARCHAR:10,BINARY:11,VARBIN:12,LONGVARBIN:13,DATE:14,TIME:15,TIMESTAMP:16,SHORT:21,LONG:22,MBCHAR:23,BOOLEAN:24,PATTERN:25,BIGDECIMAL:30},BFTP:{RESERVED:0,HIDDEN:-1,DATETIME:1,NUMBER:2,TEXT:3,PICTURE:4,URL:5,EMAIL:6,TAG:7,DATE:8,TIME:9,SYMBOL:10,BIGDECIMAL:11,PHONENUMBER:12},METRIC_DTP:3,FN_DTP:{NUM:0,CHAR:1,DATE:2},DTP2PROMPT_STP:{"-1":c.PROMPT,1:c.PROMPT_LONG,2:c.PROMPT_LONG,3:c.PROMPT_LONG,4:c.PROMPT_DOUBLE,5:c.PROMPT_DOUBLE,6:c.PROMPT_DOUBLE,7:c.PROMPT_DOUBLE,8:c.PROMPT_STRING,9:c.PROMPT_STRING,10:c.PROMPT_STRING,14:c.PROMPT_DATE,15:c.PROMPT_DATE,16:c.PROMPT_DATE,21:c.PROMPT_LONG,22:c.PROMPT_LONG,23:c.PROMPT_STRING,24:c.PROMPT_BOOLEAN,30:c.PROMPT_BIGDECIMAL},DTP2FN_DTP:{"-1":0,1:0,2:0,3:0,4:0,5:0,6:0,7:0,8:1,9:1,10:1,11:0,12:0,13:0,14:0,15:0,16:0,21:0,22:0,23:1,24:0,25:1,30:0,34:0},fnCstCount:function A(g,e){var h=this.FN,j=this.FN_MRP,H=this.FNT;if(e===H.DEF||e===undefined){switch(g){case h.BETWEEN:case h.NOT_BETWEEN:return 2;case h.IS_NULL:case h.IS_NOT_NULL:return 0;}}else{if(e===H.PER||e===H.RANK){switch(g){case j.BETWEEN:case j.BETWEEN_DESCENDING:return 2;}}}return 1;},fn_List:function S(e,H){var g=this.FN;return e==g.IN_LIST||e==g.NOT_IN_LIST;},fn_AC_MC:function Z(e,H){var g=this.FN;return(e==g.EQUAL)||(e==g.NOT_EQUAL)||(e==g.GREATER)||(e==g.LESS)||(e==g.GREATER_EQUAL)||(e==g.LESS_EQUAL);},fnName:function Q(j,h,e,g){var H=this[M[j]];if(H&&H.constructor===Object){H=H[this.DTP2FN_DTP[g]]||H["*"];}if(j===F.MQ){H=H.concat(mstrmojo.locales.expression.MetricRP);}var f=d.find(H,"did",(e||1)+this.FN_SEP+h);if(f>-1){return H[f].n;}return"";},findTargets:function I(o,g,q){if(!q){q={};}if(o){var n;for(n in U){var AA=o[n];if(AA){if(!AA[P]){AA[P]=U[n];}if(!AA[G]&&V[n]){AA[G]=V[n];}q[AA[g]]=AA;}}if(o.dmy){var l=this.TP.ATTR,r=this.DMY_TP.ATTR,f=o.dmy.uts,z,e;for(z=0,e=(f&&f.length)||0;z<e;z++){var m=f[z];if(m&&m.utp===r){var j=m.utgt;if(!j.t){j.t=l;}q[j[g]]=j;}}}var H=o.nds,p,w;for(p=0,w=(H&&H.length)||0;p<w;p++){this.findTargets(H[p],g,q);}var v=o.cs,x=v&&v.length;if(x){for(p=0;p<x;p++){this.findTargets(v[p],g,q);}}}return q;},onLocaleUpdated:function(){var e=mstrmojo.locales.expression,H=mstrmojo.expr;H.BRANCH_FNS=O.copy(J(e.BranchQual),H.BRANCH_FNS);H.ELEM_FNS=a(Y(e.Element,"fn"),H.ELEM_FNS);H.METRIC_FNS={"*":Y(d.filter(e.Metric.concat(e.MetricRP),function(f){return f.did&&(d.find(R["0"],"did",f.did)<0);}))};H.FORM_FNS={0:Y(d.filter(e.Attribute,function(f){return f.did&&(d.find(L["0"],"did",f.did)<0);})),1:Y(d.filter(e.Attribute,function(f){return f.did&&(d.find(L["1"],"did",f.did)<0);})),2:Y(d.filter(e.Attribute,function(f){return f.did&&(d.find(L["0"],"did",f.did)<0)&&(d.find(L["1"],"did",f.did)<0);}))};H.DIMTYLEVELS=a(Y(e.DimtyLevels),H.DIMTYLEVELS);},getSortedObjectsByTypeGroup:function D(h){var f=-1,H=0,e=1,g=2;function j(k){switch(k.t){case N.METRIC:return e;case N.ATTR:case N.DIM:case N.CONS:return H;case N.FILTER:return k.st===c.CUSTOMGROUP?H:g;case -1:return f;default:return g;}}h=d.map(h||[],function(k){return O.copy(k,{});});return h.sort(function(o,n){var p=j(o)-j(n);if(p){return p;}var m=o.n.toUpperCase(),l=n.n.toUpperCase(),k=m.localeCompare(l);if(k){return k;}return o.n.localeCompare(n.n);});},mapBaseFormTypeToDataType:function C(f){f=parseInt(f);if(f===NaN){return -1;}var e=this.BFTP,H=this.DTP;switch(f){case e.DATETIME:return H.TIMESTAMP;case e.DATE:return H.DATE;case e.TIME:return H.TIME;case e.NUMBER:return H.REAL;case e.TEXT:return H.CHAR;case e.BIGDECIMAL:return H.BIGDECIMAL;default:return H.CHAR;}}});mstrmojo.expr.onLocaleUpdated();}());(function(){mstrmojo.requiresCls("mstrmojo.vi.models.EnumPanelTypes","mstrmojo.hash","mstrmojo.string");var F=mstrmojo.hash;function B(J,H){var I=false,G=false;F.keyarray(H).every(function(K){(H[K].att||[]).every(function(L){if(L.did===J){I=true;if(L.de){G=true;}}return !I;});return !I;});return G;}mstrmojo.vi.ui.rw.selectors._IsFilterSelector=mstrmojo.provide("mstrmojo.vi.ui.rw.selectors._IsFilterSelector",{_mixinName:"mstrmojo.vi.ui.rw.selectors._IsFilterSelector",model:null,cachedFps:null,hasDE:false,init:function E(H){this._super(H);var G=this.node.defn;this.hasDE=(G.srct===12&&B(G.srcid,this.model.datasets));},isInFilterPanel:function A(){return true;},getFilterPanel:function C(){var G=this.cachedFps;if(!G){this.cachedFps=G=mstrmojo.findAncestor(this.parent,"scriptClass","mstrmojo.vi.ui.rw.FilterPanelStack");}return G;},slice:function D(H){var G=this.getFilterPanel();if(G){if(H.eid){H.eid=mstrmojo.string.escapeIllegalXML(H.eid);}if(H.forceBuffer){G.bufferSlice(H);return ;}if(H.forceApply){this.model.slice(H);return ;}if(G.autoApply){this.model.slice(H);}else{G.bufferSlice(H);}}}});}());(function(){mstrmojo.requiresCls("mstrmojo.dom","mstrmojo.array","mstrmojo.string");var X=mstrmojo.dom,L=mstrmojo.string,b=mstrmojo.array;mstrmojo.css=mstrmojo.provide("mstrmojo.css",{DISPLAY_TABLE:X.isNSIE?"block":"table",DISPLAY_CELL:X.isNSIE?"block":"table-cell",MINHEIGHT:X.isIE6?"height":"minHeight",addClass:function M(j,h){if(j){if(h.constructor!==Array){h=[h];}var e=j.className||"",l=" "+e+" ",f=false,d=h.length,g;for(g=0;g<d;g++){var k=h[g];if(!l.match(new RegExp("\\s"+k+"\\s"))){e+=" "+k;f=true;}}if(f){j.className=L.trim(e);}}return j;},removeClass:function O(g,f){if(!g){return ;}if(f.constructor!==Array){f=[f];}var d=" "+(g.className||"")+" ",c=f.length,e;for(e=0;e<c;e++){d=d.replace(new RegExp("\\s"+f[e]+"\\s","g")," ");}g.className=L.trim(d);},addWidgetCssClass:function N(h,f){var d=h.cssClass,g=(d&&d.split(" "))||[],e;f=[].concat(f);for(e=0;e<f.length;e++){var c=f[e];if(b.indexOf(g,c)===-1){g.push(c);}}h.cssClass=g.join(" ");},removeWidgetCssClass:function G(j,g){var d=j.cssClass,h=(d&&d.split(" "))||[],f;g=[].concat(g);for(f=0;f<g.length;f++){var c=g[f];var e=b.indexOf(h,c);if(e!==-1){h.splice(e,1);}}j.cssClass=h.join(" ");},toggleClass:function W(e,d,c){if(c){this.addClass(e,d);}else{this.removeClass(e,d);}},hasClass:function A(e,f){if(e){var d=" "+(e.className||"")+" ";return !!d.match(new RegExp("\\s"+f+"\\s"));}return false;},applyShadow:function H(g,h,f,e,c){var d=g.style;if(X.isDXIE){d.filter+="progid:DXImageTransform.Microsoft.dropshadow(OffX="+h+"px, OffY="+f+"px, Color='"+c+"')";}else{if(X.isFF||X.isWK||X.isIE10){d[X.CSS3_BOXSHADOW]=h+"px "+f+"px "+e+"px "+c;}}},removeShadow:function C(d){var c=d.style;if(X.isFF||X.isWK||X.isIE10){c[X.CSS3_BOXSHADOW]="";}},setOpacity:function Y(d,f){if(X.isDXIE&&!X.isIE9){var g=d.currentStyle.filter;var c=null;if(g.length>0){c=d.filters["DXImageTransform.Microsoft.Alpha"];}if(c){c.opacity=f;c.enabled=(f!==100);}else{if(f<100){var e="progid:DXImageTransform.Microsoft.Alpha(Opacity="+f+")";d.style.filter=(g||"")+" "+e;}}}else{d.style.opacity=f/100-(X.isIE9?0.00001:0);}},buildGradient:function P(d,f,c){if(X.supports(X.cssFeatures.GRADIENTS)){var e={};if(X.isDXIE){e.n="filter";e.v="progid:DXImageTransform.Microsoft.Gradient(GradientType="+d+",StartColorStr='"+f+"',EndColorStr='"+c+"')";}else{if(X.isFF){e.n="background-image";e.v="-moz-linear-gradient("+((d===0)?"top":"left")+","+f+","+c+")";}else{if(X.isWK){e.n="background";e.v="-webkit-gradient(linear,"+((d===0)?"left top, left bottom":"left top, right top")+",from("+f+"),to("+c+"))";}else{if(X.isIE10||X.isIEW3C){e.n="background";e.v="linear-gradient("+((d===0)?"to bottom":"to right")+","+f+","+c+")";}}}}return e;}return null;},buildRoundCorners:function R(h,g){if(X.supports(X.cssFeatures.ROUND_CORNERS)){var d=h+"px";var k=d+(g?" "+d+" 0 0":"")+";";if(X.isFF||X.isWinPhone||X.isIE10){return"border-radius:"+k;}if(X.isWK){if(!g){return"-webkit-border-radius:"+d+";";}var j=["left","right"],f=[],c=-1,e;for(e=0;e<2;e++){f[++c]="-webkit-border-top-"+j[e]+"-radius:"+d;f[++c]="-webkit-border-bottom-"+j[e]+"-radius:0";}return f.join(";");}}return"";},getBorderWidthsOrPaddings:function E(d,g){var h={t:0,r:0,b:0,l:0,h:0,w:0};if(!d){return h;}var e=d.split(" "),c=e.length,f;for(f=0;f<c;f++){e[f]=Math.round(g*parseFloat(e[f])/72);}if(c<4){if(c===1){e[1]=e[2]=e[3]=e[0];}else{e[3]=e[1];if(c===2){e[2]=e[0];}}}h.t=e[0];h.r=e[1];h.b=e[2];h.l=e[3];h.h=h.t+h.b;h.w=h.l+h.r;return h;},getBorderWidths:function I(d,c){return this.getBorderWidthsOrPaddings(d,c);},getPaddings:function D(d,c){return this.getBorderWidthsOrPaddings(d,c);},parkAfterFade:function B(c){var d=c.target.style;if(d.opacity===0){d.left="-10000px";window.setTimeout(function(){d.opacity=0.99;},0);return true;}return false;},getStyleValue:function J(c,g){var e=(g==="float"),f;if(c.currentStyle){g=e?"styleFloat":g;f=c.currentStyle[g];}else{if(document.defaultView&&document.defaultView.getComputedStyle){g=e?"cssFloat":g;var d=document.defaultView.getComputedStyle(c,null);f=d?d[g]:null;}}return f;},getComputedStyle:function V(c,e){var d=(window.getComputedStyle)?function(f,g){return window.getComputedStyle(f,g||null);}:function(f){return f.currentStyle||{};};mstrmojo.css.getComputedStyle=d;return d(c,e);},getCssTextFromObj:function F(e){var d="",c;for(c in e){d+=c+":"+e[c]+";";}return d;},onTransitionEnd:function a(e,c){var d="transition",f=window.Modernizr;if(f.testProp(d)){X.attachOneTimeEvent(e,X.transEndEvtNames[f.prefixed(d)],c);}else{window.setTimeout(c,0);}},onAnimationEnd:function U(e,c){var d="animation",f=window.Modernizr;if(f.testProp(d)){X.attachEvent(e,X.animationEndEvtNames[f.prefixed(d)],c);}else{window.setTimeout(c,0);}},flashClass:function Q(d,c,f){this.toggleClass(d,c,true);var e=this;window.setTimeout(function(){e.toggleClass(d,c,false);},f);},convertCssToCamelCase:function K(c){return c.replace(/\-([a-z])/gi,function(d,e){return e.toUpperCase();});},printCSSInfo:function Z(g){var m=document.styleSheets,p=m.length,h,k;for(k=0;k<p;k++){var l=m[k],n=l.cssRules,e=n?n.length:0,o=0;for(h=0;h<e;h++){var c=n[h].selectorText;if(c){try{o+=c.split(",").length;}catch(f){}}}var d=l.href;if(!g||(d&&d.indexOf(g)>-1)){console.log("Stylesheet: "+d||"Inline CSS Block");console.log("Total rules: "+e);console.log("Total selectors: "+o);}}},cssEscape:function S(j){if(arguments.length===0){throw new TypeError("`CSS.escape` requires an argument.");}var f=String(j),h=f.length,e=-1,g,c="",d=f.charCodeAt(0);while(++e<h){g=f.charCodeAt(e);if(g==0){c+="\uFFFD";continue;}if((g>=1&&g<=31)||g==127||(e==0&&g>=48&&g<=57)||(e==1&&g>=48&&g<=57&&d==45)){c+="\\"+g.toString(16)+" ";continue;}if(e==0&&h==1&&g==45){c+="\\"+f.charAt(e);continue;}if(g>=128||g==45||g==95||g>=48&&g<=57||g>=65&&g<=90||g>=97&&g<=122){c+=f.charAt(e);continue;}c+="\\"+f.charAt(e);}return c;}});}());(function(){mstrmojo.requiresCls("mstrmojo.string","mstrmojo.dom","mstrmojo.hash");var M=mstrmojo.string,L=mstrmojo.hash,E=mstrmojo.dom;var R=mstrmojo.usesFrames?null:document.createElement("span");var J=/mstrAttach:([\w,]+)/g;var Q;function V(b,c){if(Q===undefined){Q=(mstrApp!==undefined&&mstrApp.isTouchApp&&mstrApp.isTouchApp())||false;}return b.replace(J,function a(j,l){var f=l.split(","),g=[],d=f.length,h;for(h=0;h<d;h++){var k=f[h];if(k){if(Q){if(k.indexOf("mouse")>-1){continue;}else{if(k==="click"){k="touchend";}}}g.push("on"+k+"=\"mstrmojo.dom.captureDomEvent('{@id}','"+k+"', self, event)\"");}}return g.join(" ");});}var N="preBuildRendering",C="buildRendering",B="postBuildRendering";function Y(c){var b=c.markupString;if(b.match(/mstrAttach:/)){b=V(b,c);if(c.markupString===c.constructor.prototype.markupString){c.constructor.prototype.markupString=b;}}var a=M.apply(b,c);if(a){if(a.indexOf("oncontextmenu")>-1){c.hasContextMenuEvent=true;}if(mstrmojo.usesFrames){var e=(c.domNode&&c.domNode.ownerDocument)||window.document;if(!R||R.ownerDocument!==e){R=e.createElement("span");}}R.innerHTML=a;var f=R.removeChild(R.firstChild);f.mstrmojoId=c.id;return f;}return null;}function A(c){var b=c.markupSlots,a,d;if(b){a={};for(d in b){a[d]=b[d].call(c);}}return a;}mstrmojo._HasMarkup=mstrmojo.provide("mstrmojo._HasMarkup",{markupString:null,markupMethods:null,markupSlots:null,onRender:mstrmojo.emptyFn,onUnRender:mstrmojo.emptyFn,render:function Z(){if((this[N]&&this[N]()===false)||(this[C]()===false)||(this[B]&&this[B]()===false)){return false;}this.hasRendered=!!this.domNode;this.onRender();var a="renderComplete";if(mstrmojo.publisher.hasSubs(this.id,a)){this.raiseEvent({name:a});}return true;},buildDom:function U(){return Y(this);},postBuildDom:null,preBuildRendering:mstrmojo.emptyFn,buildRendering:function F(){var a=this.domNode,b=this.buildDom();this.domNode=b;if(this.postBuildDom){this.postBuildDom();}if(this.slotNames){this.removeSlots(this.slotNames);}this.addSlots(A(this));this.paint();if(b){var e=a;if(!e){e=this.placeholder;if(e){if(typeof e==="string"){e=document.getElementById(e);}delete this.placeholder;}}if(e){E.replace(e,b);}}var c="onchildRenderingChange",d=this.parent;if(d&&d[c]){d[c](this);}return true;},postBuildRendering:mstrmojo.emptyFn,unrender:function S(c){if(this.hasRendered){if(!c){try{var a=this.domNode;if(a.parentNode){a.parentNode.removeChild(a);}if(mstrmojo.dom.isIE&&a.outerHTML!=="undefined"){a.outerHTML="";}}catch(b){}}this.domNode=null;this.removeSlots(this.slotNames);this.hasRendered=false;this.onUnRender();}},paint:function K(){var b=this.markupMethods;if(!b){return ;}var e=this,f=function(k){var j=b[k];if(j){try{j.apply(e,[true]);}catch(h){throw new Error(["Error in markup method.","Script class: "+e.scriptClass,"Widget id: "+e.id,"Method name: "+k,"Err: "+h.message].join("\n\n"));}}};var d=b.sequence,a,c,g;if(d){a=d.length||0;for(c=0;c<a;c++){f(d[c]);}}else{for(g in b){f(g);}}},redraw:function P(){return false;},refresh:function D(a){if(this.hasRendered){if(this.redraw()!==true){var b=this.domNode;this.unrender(true);this.placeholder=b;if(a){a();}this.render();}}},set:function I(d,a){this._super(d,a);if(this.domNode){var b=this.markupMethods,c=b&&b["on"+d+"Change"];if(c){c.apply(this);}}return this;},slotNames:null,addSlots:function G(b){var a=this.slotNames,c;if(!a){a={};this.slotNames=a;}for(c in b){this[c]=b[c];a[c]=true;}},removeSlots:function H(a){if(a){var b=this.slotNames,c;for(c in a){delete this[c];if(b){delete b[c];}}}},captureDomEvent:function X(c,a,d,b){if(this.enabled!==false){this.raiseEvent(mstrmojo._HasMarkup.newDomEvent(c,a,d||a.event,b));}},playEffect:function W(b){var a=this[b];if(a&&a.constructor===Object){a=mstrmojo.insert(mstrmojo.hash.clone(a));a.widget=this;this[b]=a;}if(a){a.play();}}});mstrmojo._HasMarkup.addMarkupMethods=function O(b,a){b.prototype.markupMethods=L.copy(a,L.copy(b.prototype.markupMethods));};mstrmojo._HasMarkup.MSTRDomEventType=null;mstrmojo._HasMarkup.newDomEvent=function(d,a,c,b){return{name:d,hWin:a,e:c,config:b,ctrlKey:E.ctrlKey(a,c),shiftKey:E.shiftKey(a,c),metaKey:E.isMetaKey(a,c),cancel:function(){E.stopPropogation(a,c);},preventDefault:function(){E.preventDefault(a,c);},getTarget:function(){return E.eventTarget(a,c);}};};}());(function(){mstrmojo.requiresCls("mstrmojo.string");var D=mstrmojo.string,F=1;mstrmojo.ListBuilder=mstrmojo.provide("mstrmojo.ListBuilder",{newContext:function E(G){var I=G.itemMarkupFunction;if(!I){var H=G.itemMarkup||(G.itemField&&'<div class="mstrmojo-text">{@'+G.itemField+"}</div>");I=H?function(K,J,L){return D.apply(H,K);}:null;}return{itemStatus:[],itemFunc:I};},build:function A(I,H,J,G){H.itemStatus[G]=F;return H.itemFunc(J,G,I);},onadd:function B(I,G,H){if(G){mstrmojo.array.insert(G.itemStatus,H.index,new Array(H.value.length));}},onremove:function C(I,G,H){if(G){G.itemStatus.splice(H.index,H.value.length);}}});}());(function(){mstrmojo.requiresCls("mstrmojo.hash","mstrmojo.string","mstrmojo.StringBuffer");mstrmojo._XMLNode=mstrmojo.declare(null,null,{nodeName:null,init:function N(O){mstrmojo.hash.copy(O,this);},addChild:function F(P){var O=new mstrmojo._XMLNode({nodeName:P});return this.appendNode(O);},appendNode:function J(O){if(O){if(!this.children){this.children=[];}this.children.push(O);O.parent=this;}return O;},addAttribute:function L(O,P){if(O!=null){if(!this.attributes){this.attributes={};}this.attributes[O]=P;}return this;},addText:function M(O){this._addToStringMember("text",O);return this;},addRawXML:function K(O){this._addToStringMember("rawXML",O);return this;},getXMLString:function I(){var O=new mstrmojo.StringBuffer();this.buildXMLString(O);return O.toString();},buildXMLString:function E(O){O=O||new mstrmojo.StringBuffer();O.append("<").append(this.nodeName).append(" ");this._buildAttributesXMLString(O).append(">").append(((this.text!=null)?this._escapeString(this.text):"")).append(((this.rawXML!=null)?this.rawXML:""));this._buildChildrenXMLString(O).append("</").append(this.nodeName).append(">");return O;},_buildAttributesXMLString:function D(O){var Q=this.attributes;if(Q){var R;for(R in Q){if(Q[R]!=null){var P=String(Q[R]);switch(R){case"et":case"nt":case"dmt":case"ddt":case"fnt":case"tp":case"stp":break;default:P=this._escapeString(P);}O.append(R+'="'+P+'" ');}}}return O;},_escapeString:function C(O){return mstrmojo.string.escape4HTMLText(O);},_buildChildrenXMLString:function H(P){var R=this.children;var O=R&&R.length;if(O){var Q;for(Q=0;Q<O;Q++){if(R[Q]&&R[Q].buildXMLString){R[Q].buildXMLString(P);}}}return P;},_addToStringMember:function A(O,Q){var P=this[O];if(P==null){this[O]=Q;}else{this[O]=P+Q;}}});mstrmojo.XMLBuilder=mstrmojo.declare(null,null,{root:null,curNode:null,addChild:function F(O){if(!this.root){this.currentNode=this.root=new mstrmojo._XMLNode({nodeName:O});}else{this.currentNode=this.currentNode.addChild(O);}return this;},appendNode:function J(O){if(!this.root){this.currentNode=this.root=O;}else{this.currentNode=this.currentNode.appendNode(O);}return this;},addAttribute:function L(O,P){if(this.currentNode){this.currentNode.addAttribute(O,P);}else{alert("no root node");}return this;},addText:function M(O){if(this.currentNode){this.currentNode.addText(O);}else{alert("no root node");}return this;},addRawXML:function K(O){if(this.currentNode){this.currentNode.addRawXML(O);}else{alert("no root node");}return this;},closeElement:function G(){this.currentNode=this.currentNode.parent;return this;},toString:function B(){if(this.root){return this.root.getXMLString();}return"";}});}());(function(){mstrmojo.requiresCls("mstrmojo.array","mstrmojo.string","mstrmojo.vi.enums.EnumFilterClearActionType","mstrmojo.vi.enums.EnumVisFilterType");var D=mstrmojo.array,M=mstrmojo.string,H=mstrmojo.vi.enums.EnumFilterClearActionType,J=mstrmojo.vi.enums.EnumVisFilterType;mstrmojo.vi.ui.rw._SupportViewFilterInVizBox=mstrmojo.provide("mstrmojo.vi.ui.rw._SupportViewFilterInVizBox",{_mixinName:"mstrmojo.vi.ui.rw._SupportViewFilterInVizBox",getSelectorObjectsFromTemplateLimit:function N(){return this.getSelObjsFromTemlateLimitHandler();},getSelectorObjectsFromViewFilter:function B(){return this.getSelObjsFromVFHandler();},getSelObjsFromVFHandler:function F(){var R=this,P=R.model,Q=R.node.data,S=Q&&Q.vfexpr;return P&&P.getSelectorDataFromViewFilter(S);},getSelObjsFromTemlateLimitHandler:function K(){var R=this,P=R.model,Q=R.node.data,S=Q&&Q.tpl;return P&&P.getSelectorDataFromTemplateLimit(S);},makeBold:function C(P){return"<span style='font-weight:bold;'>"+P+"</span>";},getSelectorExpr:function I(U,S){var V=[],W="",R=true,Q=U.keepOnly?"##":mstrmojo.desc(13232,"Not ##"),P,X=mstrmojo.desc(5283,"OR");if(S){X=this.makeBold(X);}U.data.every(function(Y){[].concat(Y).every(function(Z){if(W===""){W=Z.tn;}return(R=(W===Z.tn));});return R;});U.data.forEach(function(a,Y){if(Y>0){V.push(X);}var Z=[];[].concat(a).forEach(function(d){var c=S?M.encodeHtmlString(d.v):d.v,b=S?M.encodeHtmlString(d.tn):d.tn;Z.push((R?"":(d.tn+" = "))+(c||mstrmojo.desc(14323,"NULL")));});V.push(Z.join(" "));});if(V.length>0){P=Q.replace("##",(R?W+" = ":"")+V.join(" "));}return P;},getLinkingSelectorExpr:function O(S,R){var U=[],V="",Q=true,W=mstrmojo.desc(5283,"OR"),P=S.keepOnly?"##":mstrmojo.desc(13232,"Not ##");if(R){W=this.makeBold(W);}S.data.every(function(X){[].concat(X).every(function(Y){if(V===""){V=Y.tn;}return(Q=(V===Y.tn));});return Q;});S.data.forEach(function(Z,X){var Y=[];if(Q){if(X>0){Y.push(W);}else{Y.push(P.replace("##",V+" = "));}}[].concat(Z).forEach(function(c){var b=R?M.encodeHtmlString(c.v):c.v,a=R?M.encodeHtmlString(c.tn):c.tn;Y.push((Q?"":(a+" = "))+(b||mstrmojo.desc(14323,"NULL")));});U.push(Y.join(" "));});return U.join(" ");},getFilterMenuPairs:function G(P){var R=this,S=[],Q=mstrmojo.desc(2827,"Clear");if(P instanceof Array){P.forEach(function(X,W){var V=R.getSelectorExpr(X),U=R.getSelectorExpr(X,true);S.push({menuString:Q+' "'+V+'"',menuTtpString:Q+' "'+U+'"',ctxt:W});});}return S;},filterMenuHandler:function L(P,S){var R=this,Q=R.controller;switch(P.type){case H.CLEAR_KEEP_ONLY:P=P.idx;Q.applyKeepOnly(R,S,undefined,P,false);break;case H.CLEAR_ALL:Q.clearFiltersForVis(R,[J.KEEP_ONLY,J.LINKING,J.DRILLING],S);break;case H.CLEAR_ADV_QUALIFICATION:Q.clearFiltersForVis(R,[J.ADV_QUALIFICATION],S);break;case H.CLEAR_KEEP_ONLY_AND_LINKING:Q.clearFiltersForVis(R,[J.KEEP_ONLY,J.LINKING],S);break;case H.CLEAR_LINKING:Q.clearLinkingFilter(P,S);break;case H.CLEAR_DRILLING:Q.clearFiltersForVis(R,[J.DRILLING],S);break;default:break;}},hasKeepOnly:function E(P){return P===null||P.length>0;},getSelectorDataForKeepOnly:function A(Q,V){var S=this,R=S.model,U=S.model.data||S.node.data,P=U.tpl,W;if(V===-1){W=[];}else{W=[].concat(R.getSelectorDataFromTemplateLimit(P));if(V===-2){W=D.filter(W,function(X){return !X.keepOnly;});}else{if(V>=0){W.splice(V,1);}}}if(Q){W=W.concat(Q);}return W;}});}());(function(){mstrmojo.requiresCls("mstrmojo.base64","mstrmojo.func","mstrmojo.hash","mstrmojo.string","mstrmojo.dom");mstrmojo.XhrCallbackType=null;function decodeHeader(value){var rEncoded=/\=\?UTF-8\?B\?(.+?)\?\=/g;if(value&&value.indexOf("=?UTF-8?B?")===0){var decMsg="",result;while((result=rEncoded.exec(value))!==null){decMsg+=mstrmojo.base64.decode(result[1]);}return decMsg;}return value;}function encodeParams(params){var x=-1,url=[],p;if(params){for(p in params){url[++x]=p+"="+encodeURIComponent(params[p]);}}return url.join("&");}function appendUrlParams(method,baseUrl,params){if(method!=="GET"||!params){return baseUrl;}return baseUrl+"?"+encodeParams(params);}function sendXhr(xhr,method,baseUrl,params){method=method.toUpperCase();var app=mstrApp,m=window.microstrategy;if(this.isTask){params=mstrmojo.addCSRFTokenToTaskParams(params);params.taskContentType=params.taskContentType||"json";params.taskEnv=params.taskEnv||"xhr";params.xts=new Date().getTime();params[mstrApp.name]=mstrApp.servletState||mstrConfig.servletState||"";baseUrl=baseUrl||mstrConfig.taskURL;}var ptp=app.persistTaskParams||(m&&m.persistParams);if(ptp){mstrmojo.requiresCls("mstrmojo.hash");mstrmojo.hash.copy(ptp,params);}xhr.open(method,appendUrlParams(method,baseUrl,params),this.async);var headers=params.xhrHeaders;if(headers){for(var hdr in headers){xhr.setRequestHeader(hdr,headers[hdr]);}delete params.xhrHeaders;}if(method!=="POST"){xhr.send(null);}else{xhr.setRequestHeader("Content-type","application/x-www-form-urlencoded");xhr.send(encodeParams(params));}if(this.async===false){xhr.onreadystatechange();}}function createXhr(){var methods=[function(){var res=new XMLHttpRequest();var foo=res.open;res.open=function(){foo.apply(res,arguments);};return res;},function(){return new ActiveXObject("Msxml2.XMLHTTP");},function(){return new ActiveXObject("Microsoft.XMLHTTP");}],cnt=methods.length,i;for(i=0;i<cnt;i++){var xhr;try{xhr=methods[i]();}catch(e){continue;}createXhr=methods[i];return xhr;}throw new Error("mstrmojo.SimpleXHR: Could not create an XHR object.");}function evalResponse(rt){var rtn=null;try{try{rtn=JSON.parse(rt);}catch(ex){rtn=eval("("+rt+")");}}catch(ex){rtn=rt&&mstrmojo.string.trim(rt);}return rtn;}var MSI_SERVER_NAME_NOT_INITIALIZED=2147760371,MSI_INVALID_SESSION_ID=2147760372,E_MSI_USERMGR_USER_NOTFOUND=2147758245,E_MSI_CONNECT_FAILED=2147759877;function isSessionExpiredError(res){if(res.status===401){return true;}var c=res&&res.getResponseHeader("X-MSTR-TaskErrorCode");c=(c<0)?(4294967296+parseInt(c,10)):c;switch(c){case MSI_SERVER_NAME_NOT_INITIALIZED:case MSI_INVALID_SESSION_ID:case E_MSI_USERMGR_USER_NOTFOUND:case E_MSI_CONNECT_FAILED:return true;}return false;}function xhrSupportsProgress(xhr){return !mstrmojo.dom.isSafari&&!!(xhr&&xhr.upload&&xhr.upload.onprogress);}mstrmojo.SimpleXHR=mstrmojo.declare(null,null,{scriptClass:"mstrmojo.SimpleXHR",isTask:true,async:true,init:function init(props){mstrmojo.hash.copy(props,this);},onreadystatechange:function onreadystatechange(xhr,callback,prevRequest){if(xhr.readyState!==4){return ;}if(typeof callback!=="object"){return ;}try{if((xhr.status===200)||(xhr.status===304)){this.response=callback.textResponse?xhr.responseText:evalResponse(xhr.responseText);if(typeof callback.success==="function"){callback.success(this.response,xhr);}}else{if(xhr.status!==0||(!xhr.isAborted&&prevRequest.params.displayNoResErr)){var app=mstrApp,sessionExp=app&&app.onSessionExpired;if(sessionExp&&isSessionExpiredError(xhr)){sessionExp.call(app,prevRequest);}else{var orig=xhr.getResponseHeader;xhr.getResponseHeader=function(name){return decodeHeader(orig.apply?orig.apply(xhr,[name]):orig(name));};if(typeof callback.failure==="function"){callback.failure(xhr);}}}}}catch(ex){mstrmojo.err(ex);throw ex;}finally{if(typeof callback.complete==="function"){callback.complete();}if(!isSessionExpiredError(xhr)&&!prevRequest.params.notRestartSessionManager){var sm=mstrApp.sessionManager;if(sm&&sm.restart){sm.restart();}}}},cancel:function(){var didCancel=false;var xhr=this.xhr;if(xhr){delete xhr.onreadystatechange;xhr.isAborted=true;if(xhr.readyState<4){xhr.abort();didCancel=true;}this.xhr=null;}return didCancel;},request:function request(method,baseUrl,callback,params,webSvrUrl,useResFeed,webSrvParams){if(webSvrUrl){if(useResFeed===true){if(!params){params={};}params.srcURL=appendUrlParams("POST",webSvrUrl,webSrvParams);this.request(method,baseUrl,callback,params);}else{mstrmojo.jsonp.request(webSvrUrl,params,callback);}}else{var xhr=createXhr();xhr.onreadystatechange=(function(me,x,c,pr){return function(){me.onreadystatechange(x,c,pr);};}(this,xhr,callback,{method:method,baseUrl:baseUrl,callback:callback,params:params}));if(xhrSupportsProgress(xhr)&&callback.progress){xhr.onprogress=(function(me,x,c){return function(evt){c.progress.call(me,evt);};}(this,xhr,callback));}this.xhr=xhr;sendXhr.call(this,xhr,method,baseUrl,params);}}});mstrmojo.QueuedXHR=mstrmojo.declare(mstrmojo.SimpleXHR,null,{scriptClass:"mstrmojo.QueuedXHR",queue:null,requestCount:0,retryDelay:1,lookup:null,cancel:function cancel(){var didCancel=this._super();while(this.queue.length){var x=this.queue.pop();var cb=x.callback;if(cb&&cb.complete){cb.complete();}}this.queue=[];this.requestCount--;return didCancel;},init:function init(){this.queue=[];this.lookup=[];},request:function request(method,baseUrl,callback,params,override,webSvrUrl,useResFeed,webSrvParams,useCache){if(webSvrUrl){if(useResFeed===true){if(!params){params={};}params.srcURL=appendUrlParams("POST",webSvrUrl,webSrvParams);this.request(method,baseUrl,callback,params);}else{mstrmojo.jsonp.request(webSvrUrl,params,callback);}}else{if(this.requestCount>0&&!override){this.queue.push({method:method,baseUrl:baseUrl,callback:callback,params:params});}else{if(this.requestCount>0){this.cancel();}this.requestCount++;var lu=null,oriParams=null;if(useCache){lu=this._searchForCacheRequest(params);oriParams=mstrmojo.hash.copy(params);}if(lu){try{if(callback.success){window.setTimeout(function(){callback.success(lu.res);},10);}}catch(ex){mstrmojo.err(ex);throw ex;}finally{if(callback.complete){callback.complete();}this.advanceQueue();}}else{var xhr=this.xhr=createXhr();callback=mstrmojo.func.wrapMethods(callback,{complete:(function(ths){return function(){ths.advanceQueue();};}(this)),success:(function(ths){return function(){if(useCache){ths.lookup.push({params:oriParams,res:ths.response});}};}(this))});xhr.onreadystatechange=(function(me,x,c,pr){return function(){me.onreadystatechange(x,c,pr);};}(this,xhr,callback,{method:method,baseUrl:baseUrl,callback:callback,params:params}));if(xhrSupportsProgress(xhr)&&callback.progress){xhr.onprogress=(function(me,x,c){return function(evt){c.progress.call(me,evt);};}(this,xhr,callback));}sendXhr.call(this,xhr,method,baseUrl,params);}}}},upload:function upload(method,baseUrl,callback,params,data,config,override,webSrvParams,useCache){if(this.isTask){params=mstrmojo.addCSRFTokenToTaskParams(params);}if(this.requestCount>0&&!override){this.queue.push({method:method,baseUrl:baseUrl,callback:callback,params:params,data:data,config:config});}else{if(this.requestCount>0){this.cancel();}this.requestCount++;var lu=null,oriParams=null;if(useCache){lu=this._searchForCacheRequest(params);oriParams=mstrmojo.hash.copy(params);}if(lu){try{if(callback.success){window.setTimeout(function(){callback.success(lu.res);},10);}}catch(ex){mstrmojo.err(ex);throw ex;}finally{if(callback.complete){callback.complete();}this.advanceQueue();}}else{var xhr=this.xhr=createXhr();var self=this;callback=mstrmojo.func.wrapMethods(callback,{complete:(function(ths){return function(){ths.advanceQueue.call(ths);};}(this)),success:(function(ths){return function(){if(useCache){ths.lookup.push({params:oriParams,res:ths.response});}};}(this))});var handleProgress=function(event){callback.progress(event,config);};var url=baseUrl;var async=!!(config&&config.async);xhr.open("POST",url,async);if(config&&config.authToken){xhr.setRequestHeader("X-MSTR-AuthToken",config.authToken);if("projectId" in params){xhr.setRequestHeader("X-MSTR-ProjectId",params.projectId);}}var formData=new FormData();var a;for(a in params){formData.append(a,params[a]);}if(data){if(params.fileName){formData.append(params.fileFieldName?params.fileFieldName:"myFile",data,params.fileName);}else{formData.append(params.fileFieldName?params.fileFieldName:"myFile",data);}}if(xhrSupportsProgress(xhr)&&callback.progress){xhr.upload.onprogress=handleProgress;}xhr.onreadystatechange=(function(me,x,c,pr){return function(){me.onreadystatechange(x,c,pr);};}(self,xhr,callback,{method:method,baseUrl:baseUrl,callback:callback,params:params}));xhr.send(formData);}}},advanceQueue:function advanceQueue(){this.requestCount--;if(this.queue.length===0){this.requestCount=0;return ;}var req=this.queue.shift();if(req.params.taskId==="importFile"||req.params.taskId==="arch.sparkFileUpload"){this.upload(req.method,req.baseUrl,req.callback,req.params,req.data,req.config);}else{this.request(req.method,req.baseUrl,req.callback,req.params,true);}},_searchForCacheRequest:function _searchForCacheRequest(params){var i;for(i in this.lookup){if(mstrmojo.hash.equals(params,this.lookup[i].params)){return this.lookup[i];}}return null;},hasRequests:function hasRequests(){return this.requestCount>0||mstrmojo.jsonp.hasRequests();}});mstrmojo.xhr=new mstrmojo.QueuedXHR();mstrmojo.jsonp={jsc:new Date().getTime(),timeToWait:20000,requestCount:0,request:function(url,params,callback){var head=document.getElementsByTagName("head")[0]||document.documentElement,jsonp="jsonp"+(this.jsc++),script=document.createElement("script");params.jsonp=jsonp+"(@R@);";params.taskContentType="jsonp";params.taskEnv="jsonp";params.xts=new Date().getTime();window[jsonp]=function(response){mstrmojo.jsonp.requestCount--;if(!response){if(callback.timeout){callback.timeout();}}else{if(response.status===200){callback.success(response.content);}else{var res={status:response.status,getResponseHeader:function(name){switch(name){case"X-MSTR-TaskFailureMsg":return response.errorMsg;case"X-MSTR-TaskErrorCode":return response.errorCode;}}};if(mstrApp.onSessionExpired&&isSessionExpiredError(res)){if(callback.onSessionExpired){callback.onSessionExpired();}else{mstrApp.onSessionExpired();}}else{callback.failure(res);}}}if(window[jsonp]){if(callback.complete){callback.complete();}window[jsonp]=undefined;try{delete window[jsonp];}catch(e){}head.removeChild(script);}};head.insertBefore(script,head.firstChild);this.requestCount++;script.src=appendUrlParams("GET",url,params);setTimeout(function(){var fn=window[jsonp];if(fn){fn();}},this.timeToWait);},hasRequests:function(){return this.requestCount>0;}};}());(function(){mstrmojo.requiresCls("mstrmojo.storage.DOMStorage");var A=4;mstrmojo.storage.DOMLocalStorage=mstrmojo.declare(mstrmojo.storage.DOMStorage,null,{scriptClass:"mstrmojo.storage.DOMLocalStorage",init:function(B){this._super(B);try{this.mIsSupported=("localStorage" in window)&&(window.localStorage!==null);this.mStorageObj=this.mIsSupported?window.localStorage:null;this.checkVersion(A);}catch(C){this.mIsSupported=false;}}});$LS=mstrmojo.global.localStore=new mstrmojo.storage.DOMLocalStorage({itemTimeToLive:(3600*24)});})();(function(){mstrmojo.requiresCls("mstrmojo.registry");mstrmojo._PagingList=mstrmojo.provide("mstrmojo._PagingList",{usePaging:false,page:0,totalPages:1,_set_page:function(B,A){if(this.page!==A&&this.usePaging){if(A>=0&&A<this.totalPages){this.page=A;}return true;}return false;},_inScroll:false,_inPaging:false,onscroll:function(){if(this.usePaging&&!this._inPaging){this._inScroll=true;this.set("page",this.listMapper.whichPage(this));this._inScroll=false;}if(this._super){this._super();}}});}());(function(){mstrmojo.requiresCls("mstrmojo._HasDrillLinks","mstrmojo.registry","mstrmojo.hash","mstrmojo.dom");var C=mstrmojo.dom;var A="openDrillLinkMenu";mstrmojo._HasHoverButton=mstrmojo.provide("mstrmojo._HasHoverButton",mstrmojo.hash.copy(mstrmojo._HasDrillLinks,{_mixinName:"mstrmojo._HasHoverButton",buttonNodeMarkup:'<div class="mstrmojo-LinkInfo-buttonNode"></div>',init:function D(E){this._super(E);this.markupSlots.buttonNode=function(){return this.domNode.lastChild;};},hoverBtn:null,postBuildRendering:function B(){if(!this.hoverBtn){this.addChildren(mstrmojo.registry.ref({scriptClass:"mstrmojo.Button",slot:"buttonNode",alias:"hoverBtn",onclick:function H(){if(this.parent.url){this.openPopup();}},openPopup:function E(){var J=mstrmojo.findAncestor(this,A);if(J){J.openDrillLinkMenu({openerButton:this,drillLinkItems:this.parent.drillLinkItems,cmPos:this.cmPos});}},closePopup:function F(){var J=mstrmojo.findAncestor(this,A);if(J){J.closePopup();}}}));}var G=this._super();var I=this.id;C.attachEvent(this.domNode,"contextmenu",function(J){mstrmojo.all[I].oncontextmenu(J,self);});return G;},oncontextmenu:function(G,E){var F=this.hoverBtn;F.cmPos=C.getMousePosition(G,E);F.openPopup();F.cmPos=null;C.preventDefault(E,G);}}));}());(function(){mstrmojo.requiresCls("mstrmojo.registry","mstrmojo.hash");var A=false,D="mstrmojo.Binding",I="bindings",H=mstrmojo.registry;function B(K){var L;for(L in K){var J=K[L];if(J&&J.disable){J.destroy();}}}function C(K,M){if(!A){mstrmojo.requiresCls(D);A=true;}var N;for(N in K){var J=K[N];if(J===null||J===undefined){continue;}var L=typeof J;if(L==="string"||L==="function"){J={destination:N,source:J,scriptClass:D};}J.parent=M;J=H.ref(J,{skipLoadChecks:true});K[N]=J;J.enable();}}mstrmojo._HasBindings=mstrmojo.provide("mstrmojo._HasBindings",{_meta_usesSuper:false,initBindings:function E(){this.hasInitBindings=true;var K=mstrmojo.hash.copy(this[I]);if(K){delete this[I];this._set_bindings(I,K);if(this.postCreateBindings){this.postCreateBindings();}}var M=this.children,J=(M&&M.length)||0;if(J){var L;for(L=0;L<J;L++){var N=M[L];if(N&&N.initBindings){N.initBindings();}}}},destroyBindings:function G(){var J=this.bindings;if(J){B(J);delete this.bindings;}},_set_bindings:function F(L,J){var K=this[I];if(J!==K){if(K){B(K);}this[I]=J;if(J){C(J,this);}return true;}return false;}});}());(function(){mstrmojo.requiresCls("mstrmojo.hash","mstrmojo.array","mstrmojo.dnd");var d=mstrmojo.array,N=mstrmojo.hash,c=d.fnReduceNumber;mstrmojo.vi.ui.BoxLayoutType=null;var Y="c";var e="b";var P="h";var v="v";var O="|";var l=false;function I(w){mstrmojo.all[this.hostId].buildBoxLayout(w);}function R(x){x=x||"";var w=x.split(O);return{target:parseInt(w.pop(),10),parentPathArray:w,parentPath:w.join(O)};}function B(AA,x){if(!AA){return undefined;}x=x||this.box;var z=R(AA),w=x;z.parentPathArray.forEach(function(AC){w=w.children[AC];});var AB=function(AD,AH,AF){var AJ=AH.children,AC=AJ[AD],AI=function(AN,AL,AM){if(AN.t===Y){return mstrmojo.all[AN.id].getMinBoxSize(AH.o)+(AM?this.padding:0);}var AK=AN.children.map(function(AO){return AI(AO,AL,AM);});if(AN.o===AL){return AK.reduce(c);}return Math.max.apply(null,AK);}.bind(this),AG=function(AL,AN,AK,AM){return AL.map(function(AP,AO){return AB(AO+AN,AK||AH,parseInt(AM)===0?0:(AM||AF));});},AE=function(AL){var AK=[0,AD];if(AL){AK=[AD+1];}return AG(Array.prototype.slice.apply(AJ,AK),AL?AD+1:0);};return{idx:AD,path:(AF||parseInt(AF)===0)?(AF+O+AD):AD,parent:AH,parentPath:AF,siblings:AJ,box:AC,getBoxLength:function(){return AC[AH.o==="v"?"h":"w"];},getSiblings:function(){return AG(AJ,0);},getPreviousSiblings:function(){return AE();},getNextSiblings:function(){return AE(true);},getMinimumBoxSize:function(AK,AL){return AI(AC,AK,AL);},getChildren:function(){return AG(AC.children||[],0,AC,this.path);}};}.bind(this);if(w&&w.children){return AB(z.target,w,z.parentPath);}else{return undefined;}}function M(z,x){var w=mstrmojo.all[z].getBoxConfiguration().f;return w&&w[x];}function D(w){return w.filter(function(x){return !x.f;});}function W(w){return !w.some(function(x){return !x.f;});}function f(AC,w,AB){if(AC.length){var z=AB?0:w,AA=AB?w:0,x=AC[0];AC.forEach(function(AE){var AD=Math.round((AE.l/(100-z))*w);AE.l+=AB?-AD:AD;AA+=AE.l;x=AE;});x.l+=100-AA;}}function j(z,x){var w=D(z);x=x||Math.round(100/(w.length+1));f(w,x,true);return x;}function E(x,w){f(D(x),w);}function F(w){return !w.children.some(function(x){if(x.t===Y){return !mstrmojo.all[x.id].getBoxConfiguration().f;}return !F(x);});}function n(AC,z){var AA=AC.children,x=AA.reduce(function(AD,AE){return AE.l+AD;},0);AA.forEach(function(AD){delete AD.f;AD.l=Math.round((AD.l/x)*100);});if(AC!==this.box){AC.f=true;AC.l=AC[AC.o==="h"?"h":"w"];if(z){var w=B.call(this,z),AB=w.box;if(W(AB.children)){n.call(this,AB,w.parentPath);}}}}function g(AC,x){var AF=AC.children,w=0;AF.filter(function(AG){return AG.t===Y;}).forEach(function(AG){w+=AG.l;AG.f=true;AG.l=M(AG.id,AC.o);});D(AF).forEach(function(AG){AG.l=Math.round(AG.l*(100/(w||100)));});var AD=this.box;if(AC!==AD){var AB=x&&B.call(this,x),AA=(AB&&AB.box)||AD;if(F(AA)){g.call(this,AA,AB&&AB.parentPath);return ;}var z=AA.children,AE=z.indexOf(AC);delete AC.f;z.splice(AE,1);AC.l=j(z);z.splice(AE,0,AC);}}function r(w){if(typeof w!=="string"){return undefined;}return parseInt(w,10);}function h(w,AA){var x=false;var z=r(w);if(z!==undefined){w=z;x=true;}return{f:x,l:w===undefined?100:w,r:!!AA};}function J(w){return function(x,z){if(!!w){x.push(z);}else{x.splice(0,0,z);}return x;};}function Z(w){if(l){console.log(JSON.stringify({t:w,cfg:this.box}));}}function L(AB,AD,AA,AC){var AE=this.getNewRootBox(AB===v),x=this.box,z=x.children,w=z.length>1?x:z[0];AD.l=AC||50;w.l=AC?100:50;AE.children=AA([w],AD);this.box=AE;}function G(w,AE,AA,AB){var AD=this.identifier,x=this.box,z=x.children,AF={t:Y,f:false,l:100,id:w.id},AC=J(AB);AF[AD]=w[AD];if(F(x)){if(AE){AE=0;}else{g.call(this,x);}}AF.f=!!AE;if(AA){if(AA===x.o){AF.l=AE||j(z);AC(z,AF);}else{L.call(this,AA,AF,AC,AE);}}else{AF.l=AE||j(z);AC(z,AF);}Z.call(this,"addRootChild");}mstrmojo.vi.ui.BoxLayoutConfig=mstrmojo.declare(null,null,{scriptClass:"mstrmojo.vi.ui.BoxLayoutConfig",identifier:"k",padding:4,hostId:"",box:null,boxPaths:null,init:function q(w){N.copy(w,this);},validateBoxLayout:function C(w,x){x=x||this.box;var AB=this.identifier,z=function(AE){var AD=AE.children,AF=AD.filter(function(AG){return AG.t===e;});var AC=AD.length;if(AC===AF.length&&AC===1){return false;}return AF.map(z).reduce(function(AG,AH){return AG&&AH;},true);},AA=function(){var AD=w.map(function(AF){return AF[AB];}),AE=function(AG){var AF=[];AG.children.forEach(function(AH){if(AH.t===e){AF=AF.concat(AE(AH));}else{AF.push(AH[AB]);}});return AF;},AC=AE(x);return(AC.length!==0||AD.length===0)&&AC.every(function(AF){return AD.indexOf(AF)>-1;});}.bind(this);return z(x)&&AA();},useDefaultBox:function(AA,AD){var z=this.identifier,x=Math.round(100/AA.length),AB=this.getNewRootBox(this.box&&this.box.o===v),w=0,AC=null;AB.children=AA.map(function(AK,AH){var AF={t:Y},AG=x,AI=false;if(AD){AG=AD[AH];var AJ=r(AG);if(AJ!==undefined){AG=AJ;AI=true;}}if(!AI){w+=AG;AC=AF;}AF.l=AG;AF.f=AI;AF[z]=AK[z];return AF;});if(AC){var AE=100-w;if(AE){AC.l+=AE;}}this.box=AB;return AB;},getNewRootBox:function S(w){return{t:e,o:w?v:P,children:[]};},addNewChild:function U(z,x,AB,AA){var w=h(x,AA);w.t=Y;w[this.identifier]=AB;z.children.push(w);},getBoxState:function b(){return JSON.parse(JSON.stringify(this.box));},getResizeBoundaries:function t(AB,z){var x={min:0,max:0},w=function(AD,AC){if(!AC){return ;}AC.getPreviousSiblings().forEach(function(AE){x.min+=AE.getMinimumBoxSize(z,true);});AC.getNextSiblings().forEach(function(AE){x.max+=AE.getMinimumBoxSize(z,true);});AD.pop();AD.pop();w(AD,B.call(this,AD.join(O)));}.bind(this);var AA=B.call(this,AB);x.min+=AA.getMinimumBoxSize(z,true)-this.padding;w(AB.split(O),AA);return x;},resizeBox:function p(AB,AC){var w=0,AD=1,AA=2,z=function(AG,AL,AJ,AK){var AH=Math.abs(AJ);AJ=-AH;AG.forEach(function(AP){var AQ=AP.getBoxLength(),AN=0;if(AJ){var AO=Math.max(AQ+AJ,AP.getMinimumBoxSize(AP.parent.o,false));AN=AQ-AO;AJ+=AN;AQ=AO;}AK.push({idx:AP.idx,l:AQ,f:AP.box.f,d:-AN});});var AI={},AM;AL.forEach(function(AP,AN){var AO=AP.getMinimumBoxSize(),AQ=AP.getBoxLength();if(AQ<AO&&AH>0){AI[AN]=Math.min(AO-AQ,AH);AH-=AI[AN];}});AL.forEach(function(AP,AO){var AN=0;AM=AP.getBoxLength();if(!AO){AN=AH;AM+=AH;}if(AI[AO]){AM+=AI[AO];}AK.push({idx:AP.idx,l:AM,f:AP.box.f,d:AN});});return AJ;},x=function(AH,AG,AI){var AK=B.call(this,AH),AL=AK.getPreviousSiblings().concat(AK),AJ=AL,AM=AK.getNextSiblings();AL.reverse();if(AG>=0){AJ=AM;AM=AL;}return z(AJ,AM,AG,AI);},AE=function(AH,AG){return function(AJ,AI,AK){var AM=B.call(this,AJ),AN=AM.getSiblings(),AL=AN,AO=[];if(AH){AN.reverse();}if(AG){AL=[];AO=AN;}return z(AL,AO,AI,AK);};},AF=function(AJ,AM,AL,AG){var AI=B.call(this,AJ);if(!AI){return ;}var AR=AI.idx,AO=AI.getSiblings(),AK=[],AP=AL.call(this,AJ,AM,AK);var AH=AK.filter(function(AS){return !AS.f;}),AN=AH.map(function(AS){return AS.l;}).reduce(c,0);AH.forEach(function(AS){AS.l=(AS.l/AN)*100;});AK.forEach(function(AU){var AW=AU.idx,AT=AO[AW],AS=AU.d;if(AS!==0&&(AG!==AA||AW!==AR)){var AV=AE(AW<AR,AS>0);AT.getChildren().forEach(function(AX){if(AX.box.t===e){AF(AX.path+O+"0",AS,AV,AD);}});}AT.box.l=AU.l;});if(AG!==AD&&AP){var AQ=AJ.split(O);AQ.pop();AQ.pop();if(AQ.length){AF(AQ.join(O),AM<0?AP:-AP,x,AA);}}}.bind(this);AF(AB,AC,x,w);},insertNewRootChild:function u(AA,z){var w=AA.getBoxConfiguration(),x=w.o,AB=w.addToEnd;if(z){x=z==="Left"||z==="Right"?"h":"v";AB=z==="Right"||z==="Bottom";}G.call(this,AA,(w.f&&w.f[x])||0,x,AB);},insertExistingRootChild:function Q(AB,AC){var x=AB.src.widget,AA=AB.box.oldPathInfo,w=x.getBoxConfiguration(),z=AC==="Left"||AC==="Right"?"h":"v",AD=(w.f&&w.f[z])||0;if(AD&&AA.parent.o===z){AD=AA.box.l;}G.call(this,x,AD,z,AC==="Right"||AC==="Bottom");AB.dropSuccessful=true;},getBoxOrientation:function K(x){var w=B.call(this,x);return w&&w.parent&&w.parent.o;},getBoxPath:function k(w){return this.boxPaths[w[this.identifier]];},deleteBox:function X(w,AL){var AK=B.call(this,this.getBoxPath(w));if(!AK){return ;}var AH=AK.box,AM=AK.idx,z=AK.parent,AC=AK.parentPath,AF=B.call(this,AC),AD=AK.siblings;AD.splice(AM,1);if(AD.length>1){if(W(AD)){n.call(this,z,AC);}else{if(!AH.f){E(AD,AH.l);}}}else{var AN=AD[0],AB=AN&&(AN.t===e),AO=AN&&AN.f;if(AF){var AE=AF.parent,AJ=F(AE),AG=[];if(AB){AG=AN.children;if(AJ){g.call(this,AE,R(AE.parentPath).parentPath);}if(AO){AG.forEach(function(AP){AP.f=true;AP.l=Math.round((AP.l/100)*AN.ps);});}else{D(AG).forEach(function(AP){AP.l=Math.round((AP.l/100)*z.l);});}}else{AG.push(AN);var x=M(AN.id,AE.o);if(!AJ&&x){AO=AN.f=true;}if(AO){AN.l=x;}else{AN.l=z.l;}}var AI=AE.children;AI.splice.apply(AI,[AF.idx,1].concat(AG));}else{var AA=this.box;if(AB){AA.children=AN.children;AA.o=AN.o;if(AO){n.call(this,AA);}}else{if(AN){delete AN.f;AN.l=100;}}}}Z.call(this,"delete");if(!AL){I.call(this,true);}else{mstrmojo.all[this.hostId].updateBoxPaths();}},beginBoxMove:function V(x,AA,z){var AB=B.call(this,this.getBoxPath(AA)),w;if(AB){w=AB.box;}x.box={initState:this.getBoxState(),oldPathInfo:AB,boxId:AA.id,parentPath:AB.parentPath,length:w.l,orientation:AB.parent.o};if(!z){this.deleteBox(AA);}},addDropBox:function A(AH,AG,AD){var AF=(AG==="Right"||AG==="Bottom"),AJ=(AG==="Top"||AG==="Bottom")?v:P,AX=this.identifier,AC=B.call(this,this.getBoxPath(AH)),AK=AC.idx,AN=AC.parent,AQ=AC.siblings,AT=AC.parentPath,AU=F(AN),AM=AN.f,z=AD.box,AA=z.boxId,AV=mstrmojo.all[AA],AP=AV.getBoxConfiguration(),AW=AP.f&&AP.f[AJ],AB=AV.getMinBoxSize(AJ),AO=M(AH.id,AJ),AR=AH.getMinBoxSize(AJ),w=z.length,x={t:Y,f:!!AW,l:AW,id:AA,r:!!AP.r};x[AX]=AV[AX];if(AW&&z.orientation===AJ){AW=w;}if(!AW&&AU){g.call(this,AN,R(AT).parentPath);AM=false;}if(AJ===AN.o){if(AW){if(AU){delete x.f;AW=undefined;}}if(AT!==z.parentPath){w=undefined;}x.l=AW||j(AQ,w);AQ.splice(AF?AK+1:AK,0,x);}else{if(AN===this.box&&AQ.length===1){L.call(this,AJ,x,J(AF),AW);}else{var AS=AC.box,AI=AS.f;var AL={l:AS.l,f:AI,o:AJ,t:e};var AE=AL.children=[x,AS];AQ.splice(AK,1);if(AF){AE.reverse();}if(AM){if(AW){if(AO){AN.l=Math.max(AN.l,AW+AO);x.l=AS.l=50;delete x.f;delete AS.f;}else{AN.l=Math.max(AN.l,AW+AR);x.l=AW;AS.l=100;}}else{if(AO){x.l=100;AS.l=AO;AN.l=Math.max(AN.l,AB+AO);}else{AN.l=Math.max(AN.l,AB+AR);x.l=AS.l=50;}}}else{if(AW&&AI){AL.h=AS.h;AL.w=AS.w;x.l=AW;AS.l=AO;n.call(this,AL,AT);}else{if(AW){x.l=AW;AS.l=100;}else{if(AO){AS.l=AO;x.l=100;if(!AL.f){AL.l=j(AQ,null);}}else{AS.f=false;AS.l=100;x.l=j([AS]);}}}}AQ.splice(AK,0,AL);}}AV.postDropBox();Z.call(this,"drop");I.call(this);AD.dropSuccessful=true;},cancelBoxMove:function a(w){this.revertBoxState(w.box.initState);},revertBoxState:function m(w){N.copy(w,this.box);I.call(this);},getBoxChildClass:function H(w){var z=w.id,x=z&&mstrmojo.all[z];if(x){return x.scriptClass;}return"";},replaceLayoutXmlKeys:function o(z){var x=false;var w=function(AG){if(!AG){return ;}var AA=AG.children,AD=AA&&AA.length,AC;for(AC=0;AD&&AC<AD;AC++){var AE=AA[AC];switch(AE.t){case e:w(AE);break;case Y:var AI=AE.k,AH=z[AI]||z["default"],AJ=mstrApp?mstrApp.primaryScdpMap:null,AB=(AJ&&AJ[AH])||[];var AF=d.indexOf(AB,AI)!==-1;if(AH&&!AF){AE.k=AH;x=true;}break;}}};w(this.box);return x;}});mstrmojo.vi.ui.BoxLayoutConfig.getMinimumChildSizes=function(z,AA,AB){var x=AB.getBoxChildClass(z);if(!x){throw"BoxLayoutConfig::getMinimumChildSizes - unable to obtain script class for box.";}var w=mstrmojo.vi.ui._IsBoxLayoutChild.getBoxMinimums(x);if(z.f){w[AA]=z.l;}return w;};mstrmojo.vi.ui.BoxLayoutConfig.BoxInfoType=null;mstrmojo.vi.ui.BoxLayoutConfig.BoxAddContextType=null;}());(function(){mstrmojo.requiresCls("mstrmojo.dom","mstrmojo.dnd");var E=mstrmojo.dom;function B(I){return E.contains(this.getMovingHandle(),I.src.node,true,document.body);}mstrmojo._IsMovable=mstrmojo.provide("mstrmojo._IsMovable",{draggable:true,ownAvatar:true,getMovingHandle:function G(){return this.domNode;},getMovingTarget:function H(){return this.domNode;},isDragValid:function A(I){return B.call(this,I)||(this._super&&this._super(I))||false;},ondragstart:function C(J){if(B.call(this,J)){var K=this.getMovingHandle(),I=this.getMovingTarget().style;this._leftPos=parseInt(I.left,10);this._topPos=parseInt(I.top,10);this._hWidth=K.clientWidth;this._hHeight=K.clientHeight;}if(this._super){this._super();}},ondragmove:function F(L){if(B.call(this,L)){var M=L.tgt.pos,J=L.src.pos,K=this.getMovingTarget().style,I=E.windowDim();K.left=this.left=Math.min(Math.max(this._leftPos+M.x-J.x,-this._hWidth+40),I.w-40)+"px";K.top=this.top=Math.min(Math.max(this._topPos+M.y-J.y,-this._hHeight+20),I.h-20)+"px";}if(this._super){this._super();}},ondragend:function D(I){if(B.call(this,I)){delete this._leftPos;delete this._topPos;delete this._hWidth;delete this._hHeight;}if(this._super){this._super();}}});}());(function(){mstrmojo.requiresCls("mstrmojo.Base");mstrmojo.chart.common.DSSTimeUtil=mstrmojo.declare(mstrmojo.Base,null,{scriptClass:"mstrmojo.chart.common.DSSTimeUtil",DaysInMonth:[31,28,31,30,31,30,31,31,30,31,30,31],DaysBeforeMonth:[0,31,59,90,120,151,181,212,243,273,304,334],DateAbove1970:[1972,1973,1974,1997,1976,1977,1978,1973,1980,1981,1971,1977,2012,1974,1997,1981,1988,1978,1973,1974,1992,1971,1977,1978,1996,1997,1981,1971,1972,1973,1974,1997,1976,1977,1978,1973,1980,1981,1971,1977,2012,1974,1997,1981,1988,1978,1973,1974,1992,1971,1977,1978,1996,1997,1981,1971,1972,1973,1974,1997,1976,1977,1978,1973,1980,1981,1971,1977,2012,1974,1997,1981,1988,1978,1973,1974,1992,1971,1977,1978,1996,1997,1981,1971,1972,1973,1974,1997,1976,1977,1978,1973,1980,1981,1971,1977,2012,1974,1997,1981,1971,1977,1978,1973,1980,1981,1971,1977,2012,1974,1997,1981,1988,1978,1973,1974,1992,1971,1977,1978,1996,1997,1981,1971,1972,1973,1974,1997,1976,1977,1978,1973,1980,1981,1971,1977,2012,1974,1997,1981,1988,1978,1973,1974,1992,1971,1977,1978,1996,1997,1981,1971,1972,1973,1974,1997,1976,1977,1978,1973,1980,1981,1971,1977,2012,1974,1997,1981,1988,1978,1973,1974,1992,1971,1977,1978,1996,1997,1981,1971,1972,1973,1974,1997,1976,1977,1978,1973,1980,1981,1971,1977,2012,1974,1997,1981,1988,1978,1973,1974,1997,1981,1971,1977,2012,1974,1997,1981,1988,1978,1973,1974,1992,1971,1977,1978,1996,1997,1981,1971,1972,1973,1974,1997,1976,1977,1978,1973,1980,1981,1971,1977,2012,1974,1997,1981,1988,1978,1973,1974,1992,1971,1977,1978,1996,1997,1981,1971,1972,1973,1974,1997,1976,1977,1978,1973,1980,1981,1971,1977,2012,1974,1997,1981,1988,1978,1973,1974,1992,1971,1977,1978,1996,1997,1981,1971,1972,1973,1974,1997,1976,1977,1978,1973,1980,1981,1971,1977,2012,1974,1997,1981,1988,1978,1973,1974,1992,1971,1977,1978,1973,1974,1997,1981,1988,1978,1973,1974,1992,1971,1977,1978,1996,1997,1981,1971,1972,1973,1974,1997,1976,1977,1978,1973,1980,1981,1971,1977,2012,1974,1997,1981,1988,1978,1973,1974,1992,1971,1977,1978,1996,1997,1981,1971,1972,1973,1974,1997,1976,1977,1978,1973,1980,1981,1971,1977,2012,1974,1997,1981,1988,1978,1973,1974,1992,1971,1977,1978,1996,1997,1981,1971,1972,1973,1974,1997,1976,1977,1978,1973,1980,1981,1971,1977,2012,1974,1997,1981,1988,1978,1973,1974,1992,1971,1977,1978,1996,1997,1981,1971,1972,1973,1974,1997,1976,1977,1978,1973,1980,1981,1971,1977,2012,1974,1997,1981,1988,1978,1973,1974,1992,1971,1977,1978,1996,1997,1981,1971,1972,1973,1974,1997,1976,1977,1978,1973,1980,1981,1971,1977,2012,1974,1997,1981,1988,1978,1973,1974,1992,1971,1977,1978,1996,1997,1981,1971,1972,1973,1974,1997,1976,1977,1978,1973,1980,1981,1971,1977,2012,1974,1997,1981,1988,1978,1973,1974,1992,1971,1977,1978,1996,1997,1981,1971,1972,1973,1974,1997,1976,1977,1978,1973,1980,1981,1971,1977,2012,1974,1997,1981,1971,1977,1978,1973,1980,1981,1971,1977,2012,1974,1997,1981,1988,1978,1973,1974,1992,1971,1977,1978,1996,1997,1981,1971,1972,1973,1974,1997,1976,1977,1978,1973,1980,1981,1971,1977,2012,1974,1997,1981,1988,1978,1973,1974,1992,1971,1977,1978,1996,1997,1981,1971,1972,1973,1974,1997,1976,1977,1978,1973,1980,1981,1971,1977,2012,1974,1997,1981,1988,1978,1973,1974,1992,1971,1977,1978,1996,1997,1981,1971,1972,1973,1974,1997,1976,1977,1978,1973,1980,1981,1971,1977,2012,1974,1997,1981,1988,1978,1973,1974,1997,1981,1971,1977,2012,1974,1997,1981,1988,1978,1973,1974,1992,1971,1977,1978,1996,1997,1981,1971,1972,1973,1974,1997,1976,1977,1978,1973,1980,1981,1971,1977,2012,1974,1997,1981,1988,1978,1973,1974,1992,1971,1977,1978,1996,1997,1981,1971,1972,1973,1974,1997,1976,1977,1978,1973,1980,1981,1971,1977,2012,1974,1997,1981,1988,1978,1973,1974,1992,1971,1977,1978,1996,1997,1981,1971,1972,1973,1974,1997,1976,1977,1978,1973,1980,1981,1971,1977,2012,1974,1997,1981,1988,1978,1973,1974,1992,1971,1977,1978,1973,1974,1997,1981,1988,1978,1973,1974,1992,1971,1977,1978,1996,1997,1981,1971,1972,1973,1974,1997,1976,1977,1978,1973,1980,1981,1971,1977,2012,1974,1997,1981,1988,1978,1973,1974,1992,1971,1977,1978,1996,1997,1981,1971,1972,1973,1974,1997,1976,1977,1978,1973,1980,1981,1971,1977,2012,1974,1997,1981,1988,1978,1973,1974,1992,1971,1977,1978,1996,1997,1981,1971,1972,1973,1974,1997,1976,1977,1978,1973,1980,1981,1971,1977,2012,1974,1997,1981,1988,1978,1973,1974,1992,1971,1977,1978,1996,1997,1981,1971,1972,1973,1974,1997,1976,1977,1978,1973,1980,1981,1971,1977,2012,1974,1997,1981,1988,1978,1973,1974,1992,1971,1977,1978,1996,1997,1981,1971,1972,1973,1974,1997,1976,1977,1978,1973,1980,1981,1971,1977,2012,1974,1997,1981,1988,1978,1973,1974,1992,1971,1977,1978,1996,1997,1981,1971,1972,1973,1974,1997,1976,1977,1978,1973,1980,1981,1971,1977,2012,1974,1997,1981,1988,1978,1973,1974,1992,1971,1977,1978,1996,1997,1981,1971,1972,1973,1974,1997,1976,1977,1978,1973,1980,1981,1971,1977,2012,1974,1997,1981,1971,1977,1978,1973,1980,1981,1971,1977,2012,1974,1997,1981,1988,1978,1973,1974,1992,1971,1977,1978,1996,1997,1981,1971,1972,1973,1974,1997,1976,1977,1978,1973,1980,1981,1971,1977,2012,1974,1997,1981,1988,1978,1973,1974,1992,1971,1977,1978,1996,1997,1981,1971,1972,1973,1974,1997,1976,1977,1978,1973,1980,1981,1971,1977,2012,1974,1997,1981,1988,1978,1973,1974,1992,1971,1977,1978,1996,1997,1981,1971,1972,1973,1974,1997,1976,1977,1978,1973,1980,1981,1971,1977,2012,1974,1997,1981,1988,1978,1973,1974,1997,1981,1971,1977,2012,1974,1997,1981,1988,1978,1973,1974,1992,1971,1977,1978,1996,1997,1981,1971,1972,1973,1974,1997,1976,1977,1978,1973,1980,1981,1971,1977,2012,1974,1997,1981,1988,1978,1973,1974,1992,1971,1977,1978,1996,1997,1981,1971,1972,1973,1974,1997,1976,1977,1978,1973,1980,1981,1971,1977,2012,1974,1997,1981,1988,1978,1973,1974,1992,1971,1977,1978,1996,1997,1981,1971,1972,1973,1974,1997,1976,1977,1978,1973,1980,1981,1971,1977,2012,1974,1997,1981,1988,1978,1973,1974,1992,1971,1977,1978,1973,1974,1997,1981,1988,1978,1973,1974,1992,1971,1977,1978,1996,1997,1981,1971,1972,1973,1974,1997,1976,1977,1978,1973,1980,1981,1971,1977,2012,1974,1997,1981,1988,1978,1973,1974,1992,1971,1977,1978,1996,1997,1981,1971,1972,1973,1974,1997,1976,1977,1978,1973,1980,1981,1971,1977,2012,1974,1997,1981,1988,1978,1973,1974,1992,1971,1977,1978,1996,1997,1981,1971,1972,1973,1974,1997,1976,1977,1978,1973,1980,1981,1971,1977,2012,1974,1997,1981,1988,1978,1973,1974,1992,1971,1977,1978,1996,1997,1981,1971,1972,1973,1974,1997,1976,1977,1978,1973,1980,1981,1971,1977,2012,1974,1997,1981,1988,1978,1973,1974,1992,1971,1977,1978,1996,1997,1981,1971,1972,1973,1974,1997,1976,1977,1978,1973,1980,1981,1971,1977,2012,1974,1997,1981,1988,1978,1973,1974,1992,1971,1977,1978,1996,1997,1981,1971,1972,1973,1974,1997,1976,1977,1978,1973,1980,1981,1971,1977,2012,1974,1997,1981,1988,1978,1973,1974,1992,1971,1977,1978,1996,1997,1981,1971,1972,1973,1974,1997,1976,1977,1978,1973,1980,1981,1971,1977,2012,1974,1997,1981,1971,1977,1978,1973,1980,1981,1971,1977,2012,1974,1997,1981,1988,1978,1973,1974,1992,1971,1977,1978,1996,1997,1981,1971,1972,1973,1974,1997,1976,1977,1978,1973,1980,1981,1971,1977,2012,1974,1997,1981,1988,1978,1973,1974,1992,1971,1977,1978,1996,1997,1981,1971,1972,1973,1974,1997,1976,1977,1978,1973,1980,1981,1971,1977,2012,1974,1997,1981,1988,1978,1973,1974,1992,1971,1977,1978,1996,1997,1981,1971,1972,1973,1974,1997,1976,1977,1978,1973,1980,1981,1971,1977,2012,1974,1997,1981,1988,1978,1973,1974,1997,1981,1971,1977,2012,1974,1997,1981,1988,1978,1973,1974,1992,1971,1977,1978,1996,1997,1981,1971,1972,1973,1974,1997,1976,1977,1978,1973,1980,1981,1971,1977,2012,1974,1997,1981,1988,1978,1973,1974,1992,1971,1977,1978,1996,1997,1981,1971,1972,1973,1974,1997,1976,1977,1978,1973,1980,1981,1971,1977,2012,1974,1997,1981,1988,1978,1973,1974,1992,1971,1977,1978,1996,1997,1981,1971,1972,1973,1974,1997,1976,1977,1978,1973,1980,1981,1971,1977,2012,1974,1997,1981,1988,1978,1973,1974,1992,1971,1977,1978,1973,1974,1997,1981,1988,1978,1973,1974,1992,1971,1977,1978,1996,1997,1981,1971,1972,1973,1974,1997,1976,1977,1978,1973,1980,1981,1971,1977,2012,1974,1997,1981,1988,1978,1973,1974,1992,1971,1977,1978,1996,1997,1981,1971,1972,1973,1974,1997,1976,1977,1978,1973,1980,1981,1971,1977,2012,1974,1997,1981,1988,1978,1973,1974,1992,1971,1977,1978,1996,1997,1981,1971,1972,1973,1974,1997,1976,1977,1978,1973,1980,1981,1971,1977,2012,1974,1997,1981,1988,1978,1973,1974,1992,1971,1977,1978,1996,1997,1981,1971,1972,1973,1974,1997,1976,1977,1978,1973,1980,1981,1971,1977,2012,1974,1997,1981,1988,1978,1973,1974,1992,1971,1977,1978,1996,1997,1981,1971,1972,1973,1974,1997,1976,1977,1978,1973,1980,1981,1971,1977,2012,1974,1997,1981,1988,1978,1973,1974,1992,1971,1977,1978,1996,1997,1981,1971,1972,1973,1974,1997,1976,1977,1978,1973,1980,1981,1971,1977,2012,1974,1997,1981,1988,1978,1973,1974,1992,1971,1977,1978,1996,1997,1981,1971,1972,1973,1974,1997,1976,1977,1978,1973,1980,1981,1971,1977,2012,1974,1997,1981,1971,1977,1978,1973,1980,1981,1971,1977,2012,1974,1997,1981,1988,1978,1973,1974,1992,1971,1977,1978,1996,1997,1981,1971,1972,1973,1974,1997,1976,1977,1978,1973,1980,1981,1971,1977,2012,1974,1997,1981,1988,1978,1973,1974,1992,1971,1977,1978,1996,1997,1981,1971,1972,1973,1974,1997,1976,1977,1978,1973,1980,1981,1971,1977,2012,1974,1997,1981,1988,1978,1973,1974,1992,1971,1977,1978,1996,1997,1981,1971,1972,1973,1974,1997,1976,1977,1978,1973,1980,1981,1971,1977,2012,1974,1997,1981,1988,1978,1973,1974,1997,1981,1971,1977,2012,1974,1997,1981,1988,1978,1973,1974,1992,1971,1977,1978,1996,1997,1981,1971,1972,1973,1974,1997,1976,1977,1978,1973,1980,1981,1971,1977,2012,1974,1997,1981,1988,1978,1973,1974,1992,1971,1977,1978,1996,1997,1981,1971,1972,1973,1974,1997,1976,1977,1978,1973,1980,1981,1971,1977,2012,1974,1997,1981,1988,1978,1973,1974,1992,1971,1977,1978,1996,1997,1981,1971,1972,1973,1974,1997,1976,1977,1978,1973,1980,1981,1971,1977,2012,1974,1997,1981,1988,1978,1973,1974,1992,1971,1977,1978,1973,1974,1997,1981,1988,1978,1973,1974,1992,1971,1977,1978,1996,1997,1981,1971,1972,1973,1974,1997,1976,1977,1978,1973,1980,1981,1971,1977,2012,1974,1997,1981,1988,1978,1973,1974,1992,1971,1977,1978,1996,1997,1981,1971,1972,1973,1974,1997,1976,1977,1978,1973,1980,1981,1971,1977,2012,1974,1997,1981,1988,1978,1973,1974,1992,1971,1977,1978,1996,1997,1981]});}());(function(){mstrmojo.requiresCls("mstrmojo.Base","mstrmojo.desc","mstrmojo.dom","mstrmojo.elementHelper","mstrmojo.hash");var C=mstrmojo.hash,K=Math.max,D=Math.min,F=Math.round;mstrmojo.vi.ui.rw.selectors.SliderHelper=mstrmojo.declare(mstrmojo.Base,null,{scriptClass:"mstrmojo.vi.ui.rw.selectors.SliderHelper",_children:[{scriptClass:"mstrmojo.Label",slot:"controlNode",alias:"summary"}],init:function M(N){if(!N.slider){throw new Error(this.scriptClass+"must be initialized with a slider instance.");}if(this._children){N.slider.set("children",this._children.slice(0));}return this._super(N);},getUnit:function I(){var N=this.slider;return N._effectiveLength/K((N.items.length-1),1);},getIdxByPx:function B(N,O){var P=this.slider.unit||this.getUnit();return K(Math[O?"ceil":"floor"](N/P+0.5),0);},updateThumb:function L(){var N=this.slider,O=N.cs1Idx,Q=N.cs2Idx;if(this.notNull(O,Q)){var P=N.unit;C.copy(this.positionSliderElements(N,F(O*P),F(Q*P)),N);}},updateHandleNodeStyle:function A(R,N,Q,O,P){R.handle1Node.style[N]=Q+P;R.handle2Node.style[N]=O+P;},positionSliderElements:function E(c,Y,X){var e=this.slider,Z="px",k=e.multiSelect,S=e._effectiveLength,Q=e.thumbWidth,m=e.cssBkBW,O=e.orCfg,l=O.posCssP,U=O.lenCssP,g="opacity";Y=D(K(Y,-1),S);X=K(D(X,S),0);var f=D(Y,X),h=K(Y,X),d=0,a=f+(k?Q:0),P=h+Q-m,b=K(f,0),j=K(h-a,0),V=K(S-h,0);if(e.hasRendered){this.updateHandleNodeStyle(c,l,Y,X,Z);var N=c.lowerRange.style,W=c.thumbNode.style,R=c.upperRange.style;N[l]=d+Z;W[l]=a+Z;R[l]=P+Z;N[U]=b+Z;W[U]=j+Z;R[U]=V+Z;N[g]=b?1:0;}else{Z+=";";l+=":";U+=":";e.handle1CssText=l+Y+Z;e.handel2CssText=l+X+Z;e.lowerRangeCssText=U+b+Z;e.thumbCssText=l+a+Z+U+j+Z;e.upperRangeCssText=l+P+Z+U+V+Z;e.lowerRangeCssText+=g+":"+(b?1:0)+";";}return{handle1:Y,handle2:X};},updateSummary:function J(){var P=this.slider,V=P.items,N=P.include,W,S,R="";if(P.multiSelect){W=C.keyarray(P.selectedIndices,true);S=W&&W.length||0;var O=mstrmojo.desc(2058,"All");try{var Q=P.parent.node.data.del.elem;if(Q.v===mstrmojo.elementHelper.ELEM_ALL_ID){O=Q.n;}}catch(U){}if(S===0){R=N?mstrmojo.desc(2057,"None"):O;}else{if(S===V.length){R=O;}else{R=(N?"":mstrmojo.desc(1099,"Not")+" ")+V[W[0]].n+(S>1?(" - "+V[W[S-1]].n):"");}}}else{W=P.selectedIndex;if(W>=0){R=(N?"":mstrmojo.desc(1099,"Not")+" ")+V[W].n;}}P.summary.set("text",R);},initialSlider:function H(){var O=this.slider,Q=O.items,U=Q.length,S,P,R;if(U>0){if(O.multiSelect){var N=O.selectedIndices;P=C.min(N,false,true)||0;R=C.max(N,false,true)||0;}else{P=0;R=K(O.selectedIndex,0);}O.cs1Idx=P;S=Q[P];O.cs1Vl=S.v;O.cs1Nm=S.n;O.cs2Idx=O.currentZoomLevel?O.getIndexByValue(O.currentZoomLevel):R;S=Q[O.cs2Idx];O.cs2Vl=S.v;O.cs2Nm=S.n;O.set("lowText",Q[0].n);O.set("highText",Q[U-1].n);}O.include=O.parent.include;O.unit=this.getUnit();},updateSelection:function G(){var O=this.slider,Q=O.items,P=O.cs1Idx,V=O.cs2Idx,S=D(P,V),N=K(P,V),U={},R;if(O.multiSelect){for(R=S;R<=N;R++){if(Q[R]){U[R]=true;}}O.selectedIndices=U;}else{O.selectedIndex=V;}},notNull:function(){var N=function(P){return P===undefined||P===null;},O;for(O=0;O<arguments.length;O++){if(N(arguments[O])){return false;}}return true;}});}());(function(){mstrmojo.requiresCls("mstrmojo.Base","mstrmojo.array");var H=mstrmojo,F=H.array,A="00000000000000000000000000000000",E=-1;function J(K){return K&&K.t===4&&K.id!==A;}function G(L){var K,M=(L&&L.length)||0;if(M===0){return false;}for(K=0;K<M;K++){if(!J(L[K])){return false;}}return true;}mstrmojo.VisProps=null;mstrmojo.vi.viz.DropZoneHelper=mstrmojo.declare(mstrmojo.Base,null,{scriptClass:"mstrmojo.vi.viz.DropZoneHelper",getXml:function B(){return"";},setData:function I(K){},isMetric:function(K){return J(K);},isMetricZone:function(K){return G(K);},getMetricCountInZone:function D(L){var K=0;F.forEach(L,function(M){if(J(M)){K++;}});return K;}});mstrmojo.vi.viz.DropZoneHelper.METRIC_NAMES_ID=A;mstrmojo.vi.viz.DropZoneHelper.isMetricNames=function C(K){return(parseInt(K.did,10)===E)||(K.id===A)||(K.did===A);};}());(function(){mstrmojo.requiresCls("mstrmojo.vi.enums.EnumThemeProperties");var A=mstrmojo.vi.enums.EnumThemeProperties,B=A.ENUM_LAYOUT_THEME;mstrmojo.util.ThemeHelper=mstrmojo.provide("mstrmojo.util.ThemeHelper",{getThemePropConfig:function C(E){var F=E&&E.layoutTheme,D=E&&E.layoutstyle;if(!F){F=!!D?B.DEFAULT:B.CLASSIC;}return F===B.DEFAULT?A.DEFAULT_THEME_PROPS:A.CLASSIC_THEME_PROPS;}});})();(function(){mstrmojo.requiresCls("mstrmojo.hash","mstrmojo.array","mstrmojo.vi.viz.EnumDSSDropZones","mstrmojo.vi.viz.DropZoneHelper","mstrmojo.gmaps.MapEnums","mstrmojo.gm.GMEnums","mstrmojo.VisEnum");var d=mstrmojo,e=d.array,f=d.vi.viz.EnumDSSDropZones,Q=d.hash,N=d.gmaps,l=mstrmojo.VisEnum,r=l.LegendPropertyTag,j=l.MAPS_PROPERTIES,I=N.EnumPropertyType,X=N.EnumZoomBehavior,h=N.EnumGraphicType,W=N.EnumClusterMode,k=N.EnumGeographicRole,E=N.EnumBaseMapType,V=N.EnumLanguageType,K=l.EnumLegendMode,D=mstrmojo.gm.EnumLegendSlot,o=l.EnumSingleLegendMode,Y=new RegExp(".{32}","g"),q;mstrmojo.vi.viz.MapHelper=mstrmojo.declare(mstrmojo.vi.viz.DropZoneHelper,null,{scriptClass:"mstrmojo.vi.viz.MapHelper",widget:null,data:null,vp:null,geoAttribute:null,latitude:null,longitude:null,slice:[],angle:null,colorBy:null,sizeBy:null,tooltip:null,markerType:null,useAttributeForm:null,supportAreaMap:true,defaultView:null,init:function p(w){this._super(w);this.tooltip=[];this.data=this.data||{};this.vp=this.data.vp||{};},setWidget:function O(x){if(!x){return ;}var AB=x.fnGetWidget(),AA=x.k,z=x.node&&x.node.data&&x.node.data.vp;this.widget=x;this.geoAttribute=L(x,f.GeoAttribute);this.latitude=L(x,f.Latitude);this.longitude=L(x,f.Longitude);this.angle=L(x,f.Angle);this.colorBy=L(x,f.ColorBy);this.sizeBy=L(x,f.SizeBy);this.tooltip=AB.getDropZoneItems(f.AdditionalMetrics,AA).map(function(w){return w.id;});this.slice=AB.getDropZoneItems(f.SliceBy,AA).map(function(w){return w.id;});if(z){this.markerType=z.mtp;this.useAttributeForm=z[I.useAttributeForm];this.defaultView=z.dv;}},getGeoUnit:function G(){return m(this.widget,f.GeoAttribute);},getLatitudeUnit:function H(){return m(this.widget,f.Latitude);},getLongitudeUnit:function c(){return m(this.widget,f.Longitude);},getAngleUnit:function A(){return m(this.widget,f.Angle);},getColorByUnit:function P(){return m(this.widget,f.ColorBy);},getSizeByUnit:function g(){return m(this.widget,f.SizeBy);},getSliceByUnits:function C(){var w=this.widget.fnGetWidget();return w.getDropZoneItems(f.SliceBy,this.widget.k);},getTooltipUnits:function a(){var w=this.widget.fnGetWidget();return w.getDropZoneItems(f.AdditionalMetrics,this.widget.k);},setMapType:function(w){this.vp.gtp=w;},getMapType:function(){return this.vp.gtp;},getLayerName:function(){return this.vp.ln;},setShapeFile:function(w){this.vp.lid=w;},setUseAttributeForm:function Z(w){this.useAttributeForm=w?q.USE_ATTRIBUTE_FORM:q.USE_ATTRIBUTE;},getGeoForm:function t(AA,x){var w=AA&&AA.fs,z=null;if(!x){x=function(){return true;};}if((AA.otp===12||AA.t===12)&&w){e.forEach(w,function(AB){if(x(AB)){z=AB;return false;}});}return z;},getLatitudeForm:function u(w){return this.getGeoForm(w,function(x){return q.isLatitude(x.fnm,x.fgr)&&x.obf;});},getLongitudeForm:function S(w){return this.getGeoForm(w,function(x){return q.isLongitude(x.fnm,x.fgr)&&x.obf;});},getXml:function M(){var w=this.vp,z=this.tooltip,x=this.useAttributeForm;w[r.LEGEND_MODE]=w[r.LEGEND_MODE]||K.RESTORED.toString();w[r.LEGEND_POSITION]=w[r.LEGEND_POSITION]||D.RIGHT_MIDDLE.toString();w[j.SHOW_LEGEND]=w[j.SHOW_LEGEND]||"false";w[I.collapseLegend]=w[I.collapseLegend]||o.RESTORE.toString();w[I.legendSwitch]=w[I.legendSwitch]||"false";w[I.baseMapType]=w[I.baseMapType]||E.Reserved;w[I.layerIdx]=w[I.layerIdx]||0;w[I.layerName]=w[I.layerName]||mstrmojo.desc(14750,"Layer")+" 1";w[I.isHidden]=w[I.isHidden]||"0";w[I.zoomSetting]=w[I.zoomSetting]||X.Automatic;w[I.clusterRadius]=50;w[I.clusterMaxZoom]=22;w[I.languageType]=V.English;w[I.tooltipSwitch]=w[I.tooltipSwitch]||"true";w.ga=this.geoAttribute||"";w.lat=this.latitude||"";w.lng=this.longitude||"";w.cmt=this.colorBy||"";w.smt=this.sizeBy||"";if(x){w[I.useAttributeForm]=x;}w.tooltip="";if(z){z.forEach(function(AA){w.tooltip+=AA;});}return q.getXmlFromJson(this.vp);},showColorByZone:function(w){return q.canShowColorByZone(w);},showSizeByZone:function(w){return !!w&&w[I.graphicType]===h.Bubble;},showSliceZone:function(w){return !!w&&w[I.graphicType]===h.Bubble;},showAngleZone:function(w){return !!w&&w[I.graphicType]===h.Bubble||((w[I.graphicType]===h.Marker)&&w[I.clusterMode]===W.PIE);}});q=mstrmojo.vi.viz.MapHelper;q.zonesCfg=[{n:mstrmojo.desc(11661,"Geo Attribute"),id:f.GeoAttribute,prm:true,allowSingle:true,show:function(){return true;},v:function(w){return B(w,I.geoAttribute);},onDel:function(w){if(!!w){w[I.geoAttribute]="";w[I.shapeFile]="";}},onAdd:function(w,x){if(!!w){w[I.geoAttribute]=x.item.did;w[I.useAttributeForm]=q.USE_ATTRIBUTE_FORM;w[I.shapeFile]="";}}},{n:mstrmojo.desc(7696,"Latitude"),id:f.Latitude,prm:true,allowSingle:true,show:function(w){if(!!w){return(w[I.graphicType]!==h.Area);}},v:function(w){return B(w,I.latitude);},onDel:function(w){if(!!w){w[I.latitude]="";}},onAdd:function(w,x){var z=x.item;if(!!w){w[I.latitude]=z.did;w[I.useAttributeForm]=z.t===21?q.USE_ATTRIBUTE_FORM:q.USE_ATTRIBUTE;}}},{n:mstrmojo.desc(7697,"Longitude"),id:f.Longitude,prm:true,allowSingle:true,show:function(w){if(!!w){return(w[I.graphicType]!==h.Area);}},v:function(w){return B(w,I.longitute);},onDel:function(w){if(!!w){w[I.longitute]="";}},onAdd:function(w,x){var z=x.item;if(!!w&&!!z){w[I.longitute]=z.did;w[I.useAttributeForm]=z.t===21?q.USE_ATTRIBUTE_FORM:q.USE_ATTRIBUTE;}}},{n:mstrmojo.desc(6188,"Slice"),id:f.SliceBy,prm:true,allowSingle:false,show:function(w){if(!!w){return q.showSliceZone(w);}},v:function(w){if(!!w){var x=w[I.slice];return x&&x.match(Y);}},onDel:function(w,x){var z=x&&x.item;if(!!w&&z&&z.id&&w[I.slice]){w[I.slice]=w[I.slice].replace(z.did,"");}},onAdd:function(w,x){var AB=I.slice,AA=x&&x.item;if(!!w&&AA){var z=w[AB]?w[AB].match(Y):[];z.splice(x.idx,0,AA.did);w[AB]=z.join("");}}},{n:mstrmojo.desc(14294,"Angle"),id:f.Angle,prm:true,allowSingle:true,show:function(w){if(!!w){return q.showAngleZone(w);}},v:function(w){return B(w,I.angle);},onDel:function(w){if(!!w){w[I.angle]="";}},onAdd:function(w,x){F(w,x,I.angle);}},{n:mstrmojo.desc(11662,"Color By"),id:f.ColorBy,prm:true,allowSingle:true,show:function(w){return q.canShowColorByZone(w);},v:function(w){return B(w,I.colorby);},onDel:function(w){if(!!w){w[I.colorby]="";}},onAdd:function(w,x){F(w,x,I.colorby);}},{n:mstrmojo.desc(11663,"Size By"),id:f.SizeBy,prm:true,allowSingle:true,show:function(w){if(!!w){return q.canShowSizeByZone(w);}},v:function(w){return B(w,I.sizeby);},onDel:function(w){if(!!w){w[I.sizeby]="";}},onAdd:function(w,x){F(w,x,I.sizeby);}},{n:mstrmojo.desc(2962,"Tooltip"),id:f.AdditionalMetrics,prm:false,allowSingle:false,show:function(){return true;},v:function(w){if(!!w){var x=w[I.tooltip];return x&&x.match(Y);}},onDel:function(w,x){if(w&&w[I.tooltip]){w[I.tooltip]=w[I.tooltip].replace(x.item.did,"");}},onAdd:function(w,x){var AA=I.tooltip;if(!!w){var z=w[AA]?w[AA].match(Y):[];z.splice(x.idx,0,x.item.did);w[AA]=z.join("");}}}];q.USE_ATTRIBUTE="0";q.USE_ATTRIBUTE_FORM="1";q.canShowColorByZone=function(w){return !!w&&(w[I.graphicType]!==undefined)&&w[I.graphicType]!==h.Density;};q.canShowSizeByZone=function(w){return !!w&&w[I.graphicType]===h.Bubble;};q.showAngleZone=function(w){if(!w){return false;}return w[I.graphicType]===h.Bubble||((w[I.graphicType]===h.Marker)&&w[I.clusterMode]===W.PIE);};q.showSliceZone=function(w){return !!w&&w[I.graphicType]===h.Bubble;};q.supportImageThreshold=function(w){return !!w&&w[I.graphicType]===h.Marker;};q.isLatitude=function U(x,w){return w===5||(x&&x.toLowerCase().indexOf("latitude")>-1);};q.isLongitude=function n(x,w){return w===6||(x&&x.toLowerCase().indexOf("longitude")>-1);};q.isAxisAttribute=function v(x){var w=x&&x.fs,z;if(w&&w.length===1){z=w[0];return !!z&&(z.fgr===5||z.fgr===6);}return false;};q.getXmlFromJson=function R(w){var x=new mstrmojo.XMLBuilder();x.addChild("widgetProps");x.addChild("fmt");Q.forEach(w,function(z,AA){x.addChild(AA);x.addAttribute("value",z);x.closeElement();});x.closeElement();x.closeElement();return x.toString();};q.isGeoRoleSupportArea=function J(w){w=w&&w.toString();return w===k.EnumGeographicRoleCity||w===k.EnumGeographicRoleState||w===k.EnumGeographicRoleCountry||w===k.EnumGeographicRoleOther||w===k.EnumGeographicRoleZipCode||w===k.EnumGeographicRoleCounty;};q.zonesNeedSyncToTooltipZone=[f.GeoAttribute,f.SliceBy,f.Angle,f.SizeBy,f.ColorBy];q.shouldSyncItemToTooltipZone=function b(z,w,x){x=e.ensureArray(x);return q.zonesNeedSyncToTooltipZone.indexOf(w)>-1&&x.indexOf(z)<0;};function m(z,x){var AC=z.fnGetWidget(),AB=z.k,AA=AC.getDropZoneItems(x,AB);return AA[0];}function L(z,x,AA){var AB=m(z,x,AA);return AB?AB.id:"";}function B(x,w){if(!!x){return x[w]?[x[w]]:[];}}function F(x,z,w){var AA=z.item;if(!!x||!!AA){x[w]=AA.did;}return x;}}());(function(){mstrmojo.requiresCls("mstrmojo.hash","mstrmojo.vi.viz.DropZoneHelper","mstrmojo.vi.viz.EnumDSSDropZones","mstrmojo.XMLBuilder");var D=mstrmojo.hash,C=mstrmojo.vi.viz.EnumDSSDropZones;mstrmojo.vi.viz.KPICardVisualizationHelper=mstrmojo.declare(mstrmojo.vi.viz.DropZoneHelper,null,{scriptClass:"mstrmojo.vi.viz.KPICardVisualizationHelper",metric:null,breakByAttribute:null,trendAttribute:null,getAddDropZonesAction:function(){var E=this,F={act:"updateTemplate",keyContext:this.node.k,actions:[]};[{n:"metric",zone:"Metric",t:4},{n:"breakByAttribute",zone:"BreakBy"},{n:"trendAttribute",zone:"Trend"}].forEach(function(G){var H=[].concat(E[G.n]||[]),I=C[G.zone];if(H&&H.length){H.forEach(function(J){F.actions.push({act:"addDropZoneUnit",zoneId:I,unitId:J.did,unitType:J.t});});}});return F;},getXml:function B(){var E=new mstrmojo.XMLBuilder();E.addChild("props");E.addChild("widgetProps");E.addChild("fmt");E.closeElement();E.closeElement();E.closeElement();return E.toString();}});var A=mstrmojo.vi.viz.KPICardVisualizationHelper;A.PROP_METRIC="metric";A.PROP_BREAKBY="BreakBy";A.PROP_TREND="trend";}());(function(){mstrmojo.requiresCls("mstrmojo.hash","mstrmojo.vi.viz.DropZoneHelper","mstrmojo.XMLBuilder");var F=mstrmojo.hash,H=mstrmojo.array;function E(){var K,I,J=this.tooltipMetrics;if(J.length>0){K=J[0].did;for(I=1;I<J.length;I++){K=K+","+J[I].did;}}return K;}mstrmojo.vi.viz.HeatMapVisualizationHelper=mstrmojo.declare(mstrmojo.vi.viz.DropZoneHelper,null,{scriptClass:"mstrmojo.vi.viz.HeatMapVisualizationHelper",groupingObjects:null,colorBy:null,sizeByMetric:null,tooltipMetrics:null,init:function D(I){this._super(I);this.colorBy=[];this.groupingObjects=[];this.tooltipMetrics=[];},getAddDropZonesAction:function(){var I=this,J={act:"updateTemplate",keyContext:this.node.k,actions:[]};[{n:"groupingObjects",zone:"Grouping"},{n:"colorBy",zone:"ColorBy"},{n:"sizeByMetric",zone:"SizeBy",t:4},{n:"tooltipMetrics",zone:"AdditionalMetrics",t:4}].forEach(function(K){var L=[].concat(I[K.n]||[]),M=mstrmojo.vi.viz.EnumDSSDropZones[K.zone];if(L&&L.length){L.forEach(function(N){J.actions.push({act:"addDropZoneUnit",zoneId:M,unitId:N.did,unitType:N.t});});}});return J;},setData:function A(K){if(!K){return ;}var I=this,J=function(M,N){if(M){var O=I[N],L=M.TemplateUnit||M.TemplateMetric;if(L){L.forEach(function(P){var Q=F.copy(P);if(!Q.did){Q.did=Q.id;}if(O instanceof Array){O.push(Q);}else{I[N]=Q;}});}}};J(K[G.PROP_GROUPING],"groupingObjects");J(K[G.PROP_COLORBY],"colorBy");J(K[G.PROP_SIZEBY],"sizeByMetric");J(K[G.PROP_TOOLTIPMETRICS],"tooltipMetrics");},getXml:function B(){var I=new mstrmojo.XMLBuilder(),M,K,J=function(Q,O,P){if(P){I.addChild(Q);I.addAttribute(O,P);I.closeElement();}};I.addChild("props");I.addChild("widgetProps");I.addChild("fmt");var L=this.sizeByMetric,N=this.colorBy[0];if(L&&N){M=L.did+","+N.did;}else{if(L&&!N){M=L.did+","+L.did;}else{if(!L&&N){M=N.did+","+N.did;}}}J("ml","value",M);K=E.call(this);J("am","value",K);I.closeElement();I.closeElement();I.closeElement();return I.toString();},getFirstColorByUnit:function C(L){var J=this.colorBy,I;if(J.length){var K=J[0];if(L){if(this.isMetric(K)){I=K;}}else{I=K;}}return I;}});var G=mstrmojo.vi.viz.HeatMapVisualizationHelper;G.PROP_GROUPING="Grp";G.PROP_COLORBY="ColorBy";G.PROP_SIZEBY="SizeBy";G.PROP_TOOLTIPMETRICS="AdditionalMetrics";}());(function(){mstrmojo.requiresCls("mstrmojo.hash","mstrmojo.vi.viz.DropZoneHelper","mstrmojo.XMLBuilder");mstrmojo.requiresClsP("mstrmojo.vi.viz","DropZoneHelper","EnumDSSDropZones");var B=mstrmojo,G=B.hash,H=B.vi.viz;function F(){var K,I,J=this.tooltipMetrics;if(J.length>0){K=J[0].did;for(I=1;I<J.length;I++){K=K+","+J[I].did;}}return K;}mstrmojo.vi.viz.ImageLayoutHelper=mstrmojo.declare(mstrmojo.vi.viz.DropZoneHelper,null,{scriptClass:"mstrmojo.vi.viz.ImageLayoutHelper",geoAttribute:null,colorByMetric:null,sizeByMetric:null,layoutAttribute:null,tooltipMetrics:null,mapFile:null,init:function E(I){this._super(I);this.tooltipMetrics=[];if(I&&I.node.data){this.mapFile=I&&I.node.data.vp&&I.node.data.vp.mf;}},getAddDropZonesAction:function(){var I=this,J={act:"updateTemplate",keyContext:this.node.k,actions:[]};[{n:"geoAttribute",zone:"GeoAttribute"},{n:"colorByMetric",zone:"ColorBy",t:4},{n:"sizeByMetric",zone:"SizeBy",t:4},{n:"layoutAttribute",zone:"Layout"},{n:"tooltipMetrics",zone:"AdditionalMetrics",t:4}].forEach(function(K){var L=[].concat(I[K.n]||[]),M=H.EnumDSSDropZones[K.zone];if(L&&L.length){L.forEach(function(N){J.actions.push({act:"addDropZoneUnit",zoneId:M,unitId:N.did,unitType:N.t});});}});return J;},setData:function A(K){if(!K){return ;}var I=this,J=function(M,N){if(M){var O=I[N],L=M.TemplateUnit||M.TemplateMetric;if(L){L.forEach(function(P){var Q=G.copy(P);if(!Q.did){Q.did=Q.id;}if(O instanceof Array){O.push(Q);}else{I[N]=Q;}});}}};J(K[C.PROP_GEO],"geoAttribute");J(K[C.PROP_COLORBY],"colorByMetric");J(K[C.PROP_SIZEBY],"sizeByMetric");J(K[C.PROP_LAYOUT],"layoutAttribute");J(K[C.PROP_TOOLTIPMETRICS],"tooltipMetrics");},getXml:function D(){var J="ga",L="PathToMap",N="ColorBy",I="mf",Q="SizeBy",O="Tooltip";var K=new mstrmojo.XMLBuilder(),M,P=function(U,R,S){if(S&&S.did!==undefined){K.addChild(U);K.addAttribute(R,S.did);K.closeElement();}};K.addChild("props");K.addChild("widgetProps");K.addChild("fmt");P(J,"value",this.geoAttribute);P(N,"value",this.colorByMetric);P(Q,"value",this.sizeByMetric);P(L,"value",this.layoutAttribute);M=F.call(this);P(O,"value",M);P(I,"value",this.mapFile);K.closeElement();K.closeElement();K.closeElement();return K.toString();}});var C=mstrmojo.vi.viz.ImageLayoutHelper;C.PROP_GEO="Geo";C.PROP_COLORBY="ColorBy";C.PROP_SIZEBY="SizeBy";C.PROP_LAYOUT="layout";C.PROP_TOOLTIPMETRICS="AdditionalMetrics";}());(function(){mstrmojo.requiresCls("mstrmojo.hash","mstrmojo.vi.viz.DropZoneHelper","mstrmojo.XMLBuilder");var B=mstrmojo.hash,G=mstrmojo.array,H="fromitem",D="toitem",E="edgecolorby",J="edgesizeby",C="nodesizeby";mstrmojo.vi.viz.NetworkVisualizationHelper=mstrmojo.declare(mstrmojo.vi.viz.DropZoneHelper,null,{scriptClass:"mstrmojo.vi.viz.NetworkVisualizationHelper",fromItemAttribute:null,toItemAttribute:null,edgeColorMetric:null,edgeSizeMetric:null,nodeSizeMetric:null,getNetworkMetrics:function(){return[this.nodeSizeMetric,this.edgeSizeMetric,this.edgeColorMetric].filter(function(K){return K!==null;});},getXml:function A(){var K=new mstrmojo.XMLBuilder(),L=function(R,P,Q){if(Q){K.addChild(R);K.addAttribute(P,Q.did);K.closeElement();}},N="value";K.addChild("props");K.addChild("widgetProps");K.addChild("fmt");var O=this.fromItemAttribute,M=this.toItemAttribute;L(H,N,this.fromItemAttribute);L(D,N,this.toItemAttribute);L(E,N,this.edgeColorMetric);L(J,N,this.edgeSizeMetric);L(C,N,this.nodeSizeMetric);K.closeElement();K.closeElement();K.closeElement();return K.toString();},setData:function I(M){if(!M){return ;}var K=this,L=function(N,O){if(N){var P=K[O];arr=N.TemplateUnit||N.TemplateMetric;if(arr){arr.forEach(function(Q){var R=B.copy(Q);if(!R.did){R.did=R.id;}if(P instanceof Array){P.push(R);}else{K[O]=R;}});}}};L(M[F.PROP_FROMITEM],"fromItemAttribute");L(M[F.PROP_TOITEM],"toItemAttribute");L(M[F.PROP_COLORBY],"edgeColorMetric");L(M[F.PROP_SIZEBY],"edgeSizeMetric");L(M[F.PROP_ITEMSIZE],"nodeSizeMetric");},getAddDropZonesAction:function(){var K=this,L={act:"updateTemplate",keyContext:this.node.k,actions:[]};[{n:"fromItemAttribute",zone:"FromItem"},{n:"toItemAttribute",zone:"ToItem"},{n:"edgeColorMetric",zone:"ColorBy",t:4},{n:"nodeSizeMetric",zone:"ItemSize",t:4},{n:"edgeSizeMetric",zone:"SizeBy",t:4}].forEach(function(M){var N=[].concat(K[M.n]||[]),O=mstrmojo.vi.viz.EnumDSSDropZones[M.zone];if(N&&N.length){N.forEach(function(P){L.actions.push({act:"addDropZoneUnit",zoneId:O,unitId:P.did,unitType:P.t});});}});return L;}});var F=mstrmojo.vi.viz.NetworkVisualizationHelper;F.PROP_FROMITEM="from";F.PROP_TOITEM="to";F.PROP_COLORBY="ColorBy";F.PROP_SIZEBY="SizeBy";F.PROP_ITEMSIZE="itemsz";}());(function(){mstrmojo.requiresCls("mstrmojo.hash","mstrmojo.vi.viz.DropZoneHelper","mstrmojo.vi.viz.EnumDSSDropZones","mstrmojo.XMLBuilder","mstrmojo.gm.GMEnums");var L=mstrmojo,F=L.hash,I=L.array,P=L.vi.viz,B=P.EnumDSSDropZones,A=1,H=0,D=P.DropZoneHelper.METRIC_NAMES_ID,O,E=mstrmojo.gm.DualAxisSubAxisBit,G=E.PRIMARY;mstrmojo.vi.viz.GraphMatrixHelper=mstrmojo.declare(mstrmojo.vi.viz.DropZoneHelper,null,{scriptClass:"mstrmojo.vi.viz.GraphMatrixHelper",handled:false,rowObjects:null,columnObjects:null,xAxisObjects:null,yAxisObjects:null,angleObjects:null,sliceObjects:null,breakByObjects:null,colorByObjects:null,currentXML:"",sizeByObjects:null,tooltipMetrics:null,data:null,metricsDropZone:"",secondaryMetricsDropZone:"",shape:"",subtype:"",metricShapes:null,visType:-1,init:function N(Q){this._super(Q);this.rowObjects=[];this.columnObjects=[];this.xAxisObjects=[];this.yAxisObjects=[];this.angleObjects=[];this.sliceObjects=[];this.breakByObjects=[];this.colorByObjects=[];this.sizeByObjects=[];this.tooltipMetrics=[];this.currentXML="";this.metricsDropZone="";this.secondaryMetricsDropZone="";this.shape="";this.subtype="";this.metricShapes="{}";},clone:function J(R){var Q=this;Q.rowObjects=R.rowObjects.concat();Q.columnObjects=R.columnObjects.concat();Q.xAxisObjects=R.xAxisObjects.concat();Q.yAxisObjects=R.yAxisObjects.concat();Q.angleObjects=R.angleObjects.concat();Q.sliceObjects=R.sliceObjects.concat();Q.breakByObjects=R.breakByObjects.concat();Q.colorByObjects=R.colorByObjects.concat();Q.sizeByObjects=R.sizeByObjects.concat();Q.tooltipMetrics=R.tooltipMetrics.concat();Q.currentXML=R.currentXML;Q.metricsDropZone=R.metricsDropZone;Q.secondaryMetricsDropZone=R.secondaryMetricsDropZone;Q.shape=R.shape;Q.subtype=R.subtype;Q.metricShapes=R.metricShapes;},exists:function(S,Q){var U=this[Q],R=false;I.forEach(U,function(V){R=(V.did===S.did);if(R){return false;}});return R;},removeAngleMetricFromOthers:function(Q){["xAxisObjects","yAxisObjects","tooltipMetrics"].every(function(U){var S=this[U],R=I.find(S,"did",Q.did);if(R>-1){S.splice(R,1);return false;}});},getXml:function C(){var Q=this.data.dz,R=Q?F.copy(Q.visProp&&Q.visProp.fmt,{}):{},S=new mstrmojo.XMLBuilder();if(this.data.visName===mstrmojo.vi.viz.EnumVizStyles.MAPBOX){delete R.cr;}if(this.visStyle){R.visStyle=this.visStyle;}if(this.shape){R.Shape=this.shape;}if(this.subtype){R.Subtype=this.subtype;}if(this.metricShapes){R.metricShapes=this.metricShapes;}R.visType=this.visType;S.addChild("props");S.addChild("widgetProps");S.addChild("fmt");F.forEach(R,function(U,V){S.addChild(V);S.addAttribute("value",U);S.closeElement();});S.closeElement();S.closeElement();S.closeElement();return S.toString();},setData:function K(U){if(!U){return ;}var R=this,S=function(W,X){if(W){var V=(W.TemplateUnit||[]).concat(W.TemplateMetric||[]);if(V){V.forEach(function(Y){var Z=F.copy(Y);if(!Z.did){Z.did=Z.id;}X.push(Z);});}}};S(U[O.PROP_ROWS],this.rowObjects);S(U[O.PROP_COLUMNS],this.columnObjects);S(U[O.PROP_XAXIS],this.xAxisObjects);S(U[O.PROP_YAXIS],this.yAxisObjects);S(U[O.PROP_BREAKBY],this.breakByObjects);S(U[O.PROP_COLORBY],this.colorByObjects);S(U[O.PROP_SIZEBY],this.sizeByObjects);S(U[O.PROP_SLICE],this.sliceObjects);S(U[O.PROP_ANGLE],this.angleObjects);S(U[O.PROP_TOOLTIPMETRICS],this.tooltipMetrics);var Q=U.visProp.fmt;this.shape=Q[O.PROP_SHAPE];this.subtype=Q[O.PROP_SUBTYPE];},setMetricsDropZone:function M(Q){if(!Q){return ;}var R=this;[O.PROP_ROWS,O.PROP_COLUMNS,O.PROP_XAXIS,O.PROP_YAXIS,O.PROP_BREAKBY,O.PROP_SLICE,O.PROP_COLORBY].forEach(function(S){if(Q[S]&&Q[S].hasOwnProperty("MetricNames")){if(R.metricsDropZone){R.secondaryMetricsDropZone=S;}else{R.metricsDropZone=S;}}});},getAddDropZonesAction:function(){var V=this,R=this.metricsDropZone,Q=this.secondaryMetricsDropZone,S={act:"updateTemplate",keyContext:this.data.k,actions:[]},U=function(W){S.actions.push({act:"addDropZoneUnit",zoneId:B[W],unitId:D,unitType:H});};[{p:"rowObjects",v:"Rows"},{p:"columnObjects",v:"Columns"},{p:"xAxisObjects",v:"XAxis"},{p:"yAxisObjects",v:"YAxis"},{p:"breakByObjects",v:"BreakBy"},{p:"colorByObjects",v:"ColorBy"},{p:"sizeByObjects",v:"SizeBy"},{p:"angleObjects",v:"Angle"},{p:"sliceObjects",v:"SliceBy"},{p:"tooltipMetrics",v:"AdditionalMetrics"}].forEach(function(Y){var W=V[Y.p],Z=B[Y.v];W.forEach(function(a){if(a){S.actions.push({act:"addDropZoneUnit",zoneId:Z,unitId:a.did,unitType:a.t,ax:a.ax||G});}});if(R===Y.v){var X=function(a){return(a&&(a.length>A)&&V.isMetricZone(a));};if(X(V.xAxisObjects)||X(V.yAxisObjects)||X(V.angleObjects)){U(R);}}});if(Q==="ColorBy"){U(Q);}return S;}});O=mstrmojo.vi.viz.GraphMatrixHelper;O.PROP_ROWS="Rows";O.PROP_COLUMNS="Columns";O.PROP_HORIZONTAL_AXIS="HorizontalAxis";O.PROP_VERTICAL_AXIS="VerticalAxis";O.PROP_XAXIS="XAxis";O.PROP_YAXIS="YAxis";O.PROP_SLICE="SliceBy";O.PROP_ANGLE="AngleBy";O.PROP_BREAKBY="BreakBy";O.PROP_COLORBY="ColorBy";O.PROP_SIZEBY="SizeBy";O.PROP_TOOLTIPMETRICS="AdditionalMetrics";O.PROP_SHAPE="Shape";O.PROP_SUBTYPE="Subtype";O.PROP_METRICSHAPES="metricShapes";O.PROP_SHAPE_AREA="Area";O.PROP_SHAPE_LINE="Line";O.PROP_SHAPE_BAR="Bar";O.PROP_SHAPE_CIRCLE="Circle";O.PROP_SHAPE_SQUARE="Square";O.PROP_SHAPE_PIE="Pie";O.PROP_SHAPE_RING="Ring";O.PROP_SHAPE_TICK="Tick";O.PROP_SUBTYPE_CLUSTERED="Clustered";O.PROP_SUBTYPE_AUTOMATIC="Automatic";O.PROP_SUBTYPE_STACKED="Stacked";O.PROP_SUBTYPE_ABSOLUTE="Absolute";O.PROP_SUBTYPE_PERCENT="Percent";}());(function(){mstrmojo.requiresCls("mstrmojo.Base","mstrmojo.chart.common.DSSTimeUtil");var H=24*60*60*1000;var A=60*60*1000;var L=60*1000;var C=1000;var K=24;var D=24*60;var J=24*60*60;var B=new mstrmojo.chart.common.DSSTimeUtil();mstrmojo.chart.common.DSSDateTime=mstrmojo.declare(mstrmojo.Base,null,{scriptClass:"mstrmojo.chart.common.DSSDateTime",mnYear:1899,mnMonth:12,mnDay:30,mnHour:0,mnMinute:0,mnSecond:0,mnMillisecond:0,mnWeek:-1,mnDayOfWeek:-1,init:function P(U){if(!U||!U.ifTime){this.mnYear=1899;this.mnMonth=12;this.mnDay=30;this.mnHour=0;this.mnMinute=0;this.mnSecond=0;this.mnMillisecond=0;this.mnWeek=-1;this.mnDayOfWeek=-1;return ;}var S=0;var W=23242571;var R=-693593;if(U.ifTime>W){this.mnYear=65535;this.mnMonth=12;this.mnDay=30;S=U.ifTime-Math.floor(U.ifTime);}else{if(U.ifTime<R){this.mnYear=1;this.mnMonth=1;this.mnDay=1;S=Math.abs(U.ifTime)+Math.ceil(U.ifTime);}else{if(U.ifTime>0){var X=this.DAYSToYMD(Math.floor(U.ifTime));this.mnYear=X.year;this.mnMonth=X.month;this.mnDay=X.day;S=U.ifTime-Math.floor(U.ifTime);}else{if(U.ifTime<0){var X=this.DAYSToYMD(Math.ceil(U.ifTime));this.mnYear=X.year;this.mnMonth=X.month;this.mnDay=X.day;S=Math.abs(U.ifTime)+Math.ceil(U.ifTime);}}}}S*=H;var V=S+0.5;if(V==H){V--;}if(V>0){this.mnHour=Math.floor(V/A);V-=this.mnHour*A;this.mnMinute=Math.floor(V/L);V-=this.mnMinute*L;this.mnSecond=Math.floor(V/C);V-=this.mnSecond*C;this.mnMillisecond=Math.floor(V);}else{this.mnHour=0;this.mnMinute=0;this.mnSecond=0;this.mnMillisecond=0;}this.mnWeek=-1;this.mnDayOfWeek=-1;this.Sanitize();},Sanitize:function O(){var R=false;if(this.mnHour==24&&this.mnMinute==0&&this.mnSecond==0){R=true;this.mnHour=0;}if(this.mnMonth<1){this.mnMonth=1;}else{if(this.mnMonth>12){this.mnMonth=12;}}if(this.mnDay<1){this.mnDay=1;}else{if(this.mnDay>B.DaysInMonth[this.mnMonth-1]){this.mnDay=B.DaysInMonth[this.mnMonth-1];if(this.mnMonth==2&&this.IsLeapYear(this.mnYear)){this.mnDay++;}}}if(this.mnHour<0){this.mnHour=0;}else{if(this.mnHour>23){this.mnHour=23;}}if(this.mnMinute<0){this.mnMinute=0;}else{if(this.mnMinute>59){this.mnMinute=59;}}if(this.mnSecond<0){this.mnSecond=0;}else{if(this.mnSecond>59){this.mnSecond=59;}}if(this.mnMillisecond<0){this.mnMillisecond=0;}else{if(this.mnMillisecond>999){this.mnMillisecond=999;}}if(R){var S=this.ToMilliseconds();S=S+H;this.init({ifTime:this.MillisecondsToDATE(S)});}},IsLeapYear:function Q(R){return((R&3)==0)&&((R%100)!=0||(R%400)==0);},ToMilliseconds:function I(){var R=this.YMDToDAYS(this.mnYear,this.mnMonth,this.mnDay);var S=R*H;S+=this.mnHour*A+this.mnMinute*L+this.mnSecond*C+this.mnMillisecond;return S;},MillisecondsToDATE:function E(S){var R=Math.floor(S/H);var U=(S-R*H)/H;if(U<0){R--;U+=1;}return R>=0?R+U:R-U;},DAYSToYMD:function N(U){var X=0;var Z=0;var S=0;U+=693959;var W=Math.floor(U/365);var V=U-W*365;var Y=Math.floor(W/4)-Math.floor(W/100)+Math.floor(W/400);V=V-Y;if(V<0){W--;V+=365;while(V<=0){W--;V+=365;}}var R=U-(W*365+Math.floor(W/4)+(W%4?1:0)-Math.floor((W-1)/100)+Math.floor((W-1)/400));if(R==365&&!this.IsLeapYear(W)){X=W+1;Z=1;S=1;return{year:X,month:Z,day:S};}if(R==-1){X=W-1;Z=12;S=31;return{year:X,month:Z,day:S};}X=W;Z=12;while(R<B.DaysBeforeMonth[Z-1]){Z--;}S=R-B.DaysBeforeMonth[Z-1]+1;if(Z>2&&this.IsLeapYear(X)){S--;if(S==0){Z--;S=B.DaysInMonth[Z-1];if(Z==2){S++;}}}return{year:X,month:Z,day:S};},YMDToDAYS:function G(V,U,S){if(U<1||U>12){return 0;}var R=V*365+Math.floor(V/4)+(V%4?1:0)-Math.floor((V-1)/100)+Math.floor((V-1)/400);R+=B.DaysBeforeMonth[U-1];if(U>2&&this.IsLeapYear(V)){R++;}R+=S-1;R-=693959;return R;},ToDATE:function F(){var S=this.YMDToDAYS(this.mnYear,this.mnMonth,this.mnDay);var R=this.mnHour/K+this.mnMinute/D+this.mnSecond/J+this.mnMillisecond/H;if(S>=0){return S+R;}else{return S-R;}},DateTimeOrder:function M(R){if(this.mnYear>R.mnYear){return 1;}else{if(this.mnYear<R.mnYear){return -1;}}if(this.mnMonth>R.mnMonth){return 1;}else{if(this.mnMonth<R.mnMonth){return -1;}}if(this.mnDay>R.mnDay){return 1;}else{if(this.mnDay<R.mnDay){return -1;}}if(this.mnHour>R.mnHour){return 1;}else{if(this.mnHour<R.mnHour){return -1;}}if(this.mnMinute>R.mnMinute){return 1;}else{if(this.mnMinute<R.mnMinute){return -1;}}if(this.mnSecond>R.mnSecond){return 1;}else{if(this.mnSecond<R.mnSecond){return -1;}}if(this.mnMillisecond>R.mnMillisecond){return 1;}else{if(this.mnMillisecond<R.mnMillisecond){return -1;}}return 0;}});}());(function(){mstrmojo.requiresCls("mstrmojo.vi.ui.BoxLayoutConfig");mstrmojo.vi.ui.rw.DocRootBoxLayoutConfig=mstrmojo.declare(mstrmojo.vi.ui.BoxLayoutConfig,null,{scriptClass:"mstrmojo.vi.ui.rw.DocRootBoxLayoutConfig",useDefaultBox:function(A,B){this._super(A,B);this.setVizGalleryOpen(true);},setVizGalleryOpen:function(A){this.box.go=!!A;},isVizGalleryOpen:function(){return !!this.box.go;}});}());(function(){mstrmojo.requiresCls("mstrmojo.array","mstrmojo.hash","mstrmojo.num","mstrmojo.func","mstrmojo.EnumRWUnitType","mstrmojo.storage.DOMLocalStorage");var E=new mstrmojo.storage.DOMLocalStorage({itemTimeToLive:-1});var a=mstrmojo,O=a.all,X=a.num,R=a.hash,J=a.array,Q=a.func,L=a.EnumRWUnitType,A={update:"updateTemplate",add:"addDropZoneUnit",remove:"removeDropZoneUnit",ungroup:"removeQuickDE",ungroup1:"removeNDEFromDS",add2group:"applyDEChanges",muteKey:"__MSTR_MUTE_VFN",gridStyle:"XtabGrid"};function P(){var c=this,d=c.getSelectedViUnit();return d&&d.boxContent;}function K(j){var f=J.ensureArray(j.actions),m,e,h=j.zm,k=j.vn,d,c=j.cmb,g=j.ca||[],l=j.k;var n=function(o){return o===A.add||A.remove;};if(!!h===false){return false;}d=h.getVFNotifierBlackList(k,c);if(g.length){return J.intersection(g,d).length>0;}f=J.filter(f,function(o){o=o||{};return(o.act===A.update&&o.keyContext===l)||n(o.act||"");});return f.some(function(o){o=o||{};m=o.actions||J.ensureArray(f);return m.some(function(p){p=p||{};e=p.zoneId;e=X.isInt(p.zoneId)?e:p.axis;return n(p.act||"")&&X.isInt(e)&&d.indexOf(e)!==-1;});});}function S(g){var d,j=J.ensureArray(g.actions),f=g.k;var e=function(k){return k===A.add2group;};var c=function(k){return k===A.ungroup||k===A.ungroup1;};var h=J.filter(j,function(k){k=k||{};return(k.k===f&&e(k.act||""))||c(k.act||"");});if(h.length>0){return true;}j=J.filter(j,function(k){k=k||{};return(k.act===A.update&&k.keyContext===f);});return j.some(function(k){k=k||{};d=k.actions||J.ensureArray(j);return d.some(function(l){l=l||{};return c(l.act||"");});});}function G(e){e=e||{};var d,f=e.vn,c=e.ca,g=e.zm;if(g&&c){d=g.getVFNotifierBlackList(f,e.cmb);return J.intersection(d,c).length;}return false;}function Y(){var c;if(!!mstrApp.muteVFNotifier){return true;}try{c=JSON.parse(E.getItem(A.muteKey))===true;}catch(d){c=false;}return c;}function Z(e){var f,c,d=e.node&&e.node.data,h=d&&d.sc,g=h&&h.exp;if(g&&g.nds){return g.nds.length>0;}f=e.getSelectionCache&&e.getSelectionCache();c=f&&f._viSelections;return(c?Object.keys(c):[]).length>0;}mstrmojo.vi.models._NotificationVisFilter=mstrmojo.provide("mstrmojo.vi.models._NotificationVisFilter",{_mixinName:"mstrmojo.vi.models._NotificationVisFilter",isVisFilter:function M(c){var d=null;if(c){if(c&&c.iifp){return[L.VISUALIZATION,L.MOJOVISUALIZATION,L.GRID,L.GRAPH,L.GRIDGRAPH].indexOf(c.t)!==-1;}d=O[c.id];}else{d=P.call(this);}return d&&d.isInFilterPanel&&d.isInFilterPanel();},hasSelectionOnVisFilter:function W(){var c=P.call(this);if(c&&c.isInFilterPanel&&c.isInFilterPanel()){return Z(c);}return false;},clearSelectionOnVisFilter:function B(c){var d=P.call(this);if(d&&d.setSelectionCache){d.setSelectionCache({});if(c){this.raiseEvent({name:"clearSelector",id:d.id,k:d.k});}}},needNotifyVFChange:function b(c,e){if(c==="CHANGE_VISTYPE"){return false;}e=e||{};var f=null,d=e.defn,g=false;if(d&&d.id){f=O[d.id];}else{f=P.call(this);}if(f&&f.isInFilterPanel&&f.isInFilterPanel()){g=mstrApp.isInVFConfigMode&&Z.call(this,f);}if(g){e.k=e.k||f.k;e.vn=R.walk("model.data.visName",f)||R.walk("model.data.vis.vn",f);if(e.vn===undefined){e.vn=f.defn&&f.defn.t===521?A.gridStyle:null;}switch(c){case"DROP_ZONE_UPDATE":g=K.call(this,e);break;case"GROUP_UPDATE":g=S.call(this,e);break;case"CLEAR_ALL":g=G.call(this,e);break;case"CHANGE_VISTYPE":case"KEEPONLY_EXCLUDE":break;default:g=false;break;}}return g;},notifyVFChange:function V(e){e=e||{};var d=this,g=P.call(d),j=e.onConfirm,f=mstrmojo.desc(15298,"Do you want to unset filter?"),c=mstrmojo.desc(15299,"The actions which changes the data will unset the filter."),h='<div style="font-weight: bold">'+f+"</div><div>"+c+"</div>";if(j){e.onConfirm=Q.composite([j,function(){d.raiseEvent({name:"clearSelector",id:g.id,k:g.k});}]);}mstrmojo.warn(h,{confirmBtn:{t:mstrmojo.desc(1442,"OK"),fn:e.onConfirm||mstrmojo.emptyFn},cancelBtn:{t:mstrmojo.desc(2140,"Cancel"),fn:e.onCancel||mstrmojo.emptyFn}},{title:mstrmojo.desc(14595,"Unset Filter"),allowHTML:true,children:[{scriptClass:"mstrmojo.Label",cssClass:"alert-content",text:h,slot:"containerNode",allowHTML:true},{scriptClass:"mstrmojo.CheckBox",slot:"buttonNode",cssClass:"mstrmojo-checkbox-inline",label:mstrmojo.desc(15300,"Do not show me again"),onclick:function(){mstrApp.muteVFNotifier=this.checked;if(this.checked){E.setItem(A.muteKey,true);}else{E.removeItem(A.muteKey);}}}]});},wrapUnsetVisualizationFilterAction:function U(h,e){var f=P.call(this),g=f&&f.model.data&&f.model.data.sc,c,d=function(){var j=this.getDataService();return j&&j.getMultiUnitSelectorAction({ck:g.ck,ct:g.ct,ctlKey:g.ckey,selections:[],tks:g.tks,type:521,isNavigation:false,ignoreTargetData:true});};f.clearSelections();f.setSelectionCache({_selectionType:f.getSelectionType(),_viSelections:f.getSelectionHash()});if(g){c=d.call(this,g);if(c&&c.partialUpdate&&e){delete c.partialUpdate;}return[c].concat(J.ensureArray(h));}return h;},checkAndNotify:function N(c,d){if(Y()){var e=P.call(this);this.raiseEvent({name:"clearSelector",id:e.id,k:e.k});return c();}else{return this.notifyVFChange({onConfirm:c,onCancel:d});}},checkAndNotifyVFChangeOnDZUnitsUpdate:function H(g,d,c){if(this.needNotifyVFChange("DROP_ZONE_UPDATE",g)){var e=this.getSelectedViUnit(),f=function(){if(e&&e.selectVIUnit){e.selectVIUnit(true);}};return this.checkAndNotify(d,f);}c=c||d;return c();},checkAndNotifyVFChangeOnVisTypeUpdate:function I(e,d,c){if(this.needNotifyVFChange("CHANGE_VISTYPE",e)){this.clearSelectionOnVisFilter();return this.checkAndNotify(d);}c=c||d;return c();},checkAndNotifyVFChangeOnClearAll:function F(e,d,c){if(this.needNotifyVFChange("CLEAR_ALL",e)){this.clearSelectionOnVisFilter();return this.checkAndNotify(d);}c=c||d;return c();},checkAndNotifyVFChangeOnGroupUpdate:function C(e,d,c){if(this.needNotifyVFChange("GROUP_UPDATE",e)){this.clearSelectionOnVisFilter();return this.checkAndNotify(d);}c=c||d;return c();},checkAndNotifyVFChangeOnKeepOnlyExclude:function D(e,d,c){if(this.needNotifyVFChange("KEEPONLY_EXCLUDE",e)){return this.checkAndNotify(d);}c=c||d;return c();}});}());(function(){var D={};var B="XHRServerTransport";mstrmojo.XHRServerTransport={serverRequest:function A(I,G,F){var E=mstrmojo.all[I],H=D[G]=new mstrmojo.SimpleXHR();$MAPF(true,B,"transportRequest");if(F.params&&!F.params.sessionState&&mstrConfig&&mstrConfig.isAddSessionState&&mstrApp&&mstrApp.sessionState){F.params.sessionState=mstrApp.sessionState;}H.request(F.config.method||"POST",F.taskURL||mstrConfig.taskURL,{success:function(J){if(typeof J==="string"&&J[0]==="{"){try{J=JSON.parse(J);}catch(K){}}if(J.mstrerr){J.code=J.mstrerr.code;J.message=J.mstrerr.message;}E&&E.response(G,true,J);},failure:function(L){var M=L.status,K=L.getResponseHeader("X-MSTR-TaskErrorCode"),J;if(M===0){M=K||M;J=mstrmojo.desc(15666,"The connection to the MicroStrategy Web Server failed. Please wait a few minutes and then attempt to reload the page. If the condition persists, please contact your administrator.");}else{M=K||M||"-999";J=L.getResponseHeader("X-MSTR-TaskFailureMsg")||L.responseText||"Unexpected error, please contact your administrator";}E&&E.response(G,false,{code:M,message:J});},complete:function(){delete D[G];},textResponse:F.callback.textResponse},F.params);},cancelRequest:function C(F){var G=D[F],E=false;if(G){E=G.cancel();delete D[F];}$MAPF(false,B,"transportRequest");return E;}};}());(function(){mstrmojo.requiresCls("mstrmojo.hash","mstrmojo.QueuedXHR");var F=mstrmojo.hash;function J(K,L){return function(){if(K[L]){K[L]();}};}var B=[];function H(L){var K;switch(L.cacheLevel){case mstrmojo.AjaxCall.CACHELEVEL_LOCAL:if(L._cache==null){L._cache=[];}K=L._cache;break;default:if(B==null){B=[];}K=B;break;}return K;}function E(N){var M=H(N);var P={cache:M,idx:-1},O=N.params;if("xts" in O){delete O.xts;}for(var L=0,K=M.length;L<K;L++){var Q=M[L];if(Q&&F.equals(Q.url,N.url)&&F.equals(Q.params,O)){P.idx=L;break;}}return P;}function C(L){var K=H(L),M=F.copy(L.params);delete M.xts;K.push({url:L.url,params:M,res:F.copy(L.response)});}function D(K){var L=E(K);if(L&&L.idx>=0){K.response=L.cache[L.idx].res;return true;}return false;}mstrmojo.AjaxCall=mstrmojo.declare(mstrmojo.QueuedXHR,null,{scriptClass:"mstrmojo.AjaxCall",method:"POST",url:"",params:null,onsuccess:null,onerr:null,oncomplete:null,oncancel:null,readCache:false,writeCache:false,cacheLevel:"",_cache:null,useQueue:false,init:function I(K){this._super(K);F.copy(K,this);},send:function A(){var K=this;if(this.readCache&&D(this)){this.onsuccess();return ;}this.request(this.method,this.url,{success:function(L){K.response=L;if(K.writeCache){C(K);}if(K&&K.onsuccess){K.onsuccess();}},failure:J(K,"onerr"),complete:J(K,"oncomplete")},this.params,!this.useQueue);},cancel:function G(){this._super();if(this.oncancel){this.oncancel();}}});mstrmojo.AjaxCall.CACHELEVEL_GLOBAL="global";mstrmojo.AjaxCall.CACHELEVEL_LOCAL="local";})();(function(){mstrmojo.requiresCls("mstrmojo.hash","mstrmojo.registry","mstrmojo.ListBuilder");var H=mstrmojo.hash,E=mstrmojo.registry,G=1;mstrmojo.WidgetListBuilder=mstrmojo.provide("mstrmojo.WidgetListBuilder",mstrmojo.mixin({newContext:function F(J){var K=J.itemFunction;if(!K){var I=J.itemConfig;K=I?function(M,L,N){var O=H.clone(I);O.data=M;O.parent=N;return E.ref(O);}:null;}return{itemStatus:[],itemWidgets:[],itemFunc:K};},build:function A(K,J,N,I){var L=J.itemFunc(N,I,K);if(L){J.itemStatus[I]=G;J.itemWidgets[I]=L;if(L.set){var M=K.selectedIndices;if(M&&M[I]){L.set("selected",true);}}}return L;},onadd:function C(K,I,J){if(I){mstrmojo.array.insert(I.itemWidgets,J.index,new Array(J.value.length));}this._super(K,I,J);},onremove:function D(L,J,K){if(J){var O=J.itemWidgets.splice(K.index,K.value.length),N,I;for(N=0,I=O.length;N<I;N++){var M=O[N];if(M&&M.destroy){delete M.parent;M.destroy();}}}this._super(L,J,K);},onchange:function B(S,J,P,U){if(U){var N=P.itemWidgets,L,O,I,R;for(O=0,I=U.removed,R=I&&I.length;O<R;O++){L=N[I[O]];if(L&&L.set){L.set("selected",false);}}var M,Q,K;for(M=0,Q=U.added,K=Q&&Q.length;M<K;M++){L=N[Q[M]];if(L&&L.set){L.set("selected",true);}}}}},H.copy(mstrmojo.ListBuilder)));}());(function(){mstrmojo.requiresCls("mstrmojo.dom","mstrmojo.hash","mstrmojo._HasMarkup");var J=mstrmojo.dom,D=mstrmojo._HasMarkup,P,Q=mstrmojo.global.document,K,A="touchstart",C="touchmove",I="touchend",N="contextmenu";function O(S){var R=J.findWidget(S);while(R){if(R.hasContextMenuEvent){return R;}R=R.parent;}return null;}function M(R){var U=R.src,S=O(U&&U.node);if(!S){return null;}return S;}H:function H(R){if(R&&R.touches.length===1){P.startTapHoldCheck(self,R);}}B:function B(){var R=++P.ctxt.moveCount;if(R>P.minMoves){P.stopTapHoldCheck();if(K){window.clearTimeout(K);}}}L:function L(){P.stopTapHoldCheck();if(K){window.clearTimeout(K);}}mstrmojo.taphold=mstrmojo.taphold||mstrmojo.provide("mstrmojo.taphold",{timeThreshold:750,minMoves:3,startTapHoldCheck:function G(R,S){delete this.ctxt;var U=J.captureEventInfo({hWin:R,e:S});this.ctxt={src:U,moveCount:0};J.attachEvent(Q,C,B);J.attachEvent(Q,I,L);S.name=N;K=window.setTimeout(function(){P.stopTapHoldCheck();var V=D.newDomEvent(N,window,S),W;for(W in S){if(!V[W]){V[W]=S[W];}}V.type=N;P.triggerContextMenu(V);},this.timeThreshold);},triggerContextMenu:function F(R){var S=this.ctxt,U=M(S);if(!U){return ;}if(U.raiseEvent){U.raiseEvent(R);}},stopTapHoldCheck:function E(){J.detachEvent(Q,C,B);J.detachEvent(Q,I,L);},enable:function(){if(J.isIOSTouch){J.attachEvent(Q,A,H);}},disable:function(){J.detachEvent(Q,A,H);}});P=mstrmojo.taphold;P.enable();}());(function(){mstrmojo.requiresCls("mstrmojo.array","mstrmojo.dom","mstrmojo.hash","mstrmojo.css");var X=mstrmojo.dom,V=mstrmojo.hash,Y=mstrmojo.array,K=function K(z,w){var x=this.getCellForNode(z),v=this.getCellForNode(w);return !x||!v||x.hasOwnProperty("mix")===v.hasOwnProperty("mix");},H=function H(AA){var z=[],w=this.clonedRowHeader&&this.clonedRowHeader.getTableNode()&&this.clonedRowHeader.getTableNode().tBodies,x=[],v;x.push(this.zone.tableNode.tBodies);if(w){x.push(w);}Y.forEach(x,function(AB){Y.forEach(AB,function(AC){for(v=0;v<AC.childNodes.length;v++){z.push(AC.childNodes[v]);}if(AA&&AC.childNodes.length<this.zone.rowsPerPage){z.push.apply(z,new Array(this.zone.rowsPerPage-AC.childNodes.length));}},this);},this);return z;},C=function C(w,AA){var z=H.call(this,true)[AA],v;for(v=0;v<z.childNodes.length;v++){if(n.call(this,z.childNodes[v])>w){return null;}if(n.call(this,z.childNodes[v])===w){return z.childNodes[v];}}},n=function n(v){var w=this.getCellForNode(v);return w&&w.colIx||0;},A={REPLACE_ALL:1,REMOVE:2,APPEND:3,TOGGLE:4},k={CONTROL:"Ctrl",SHIFT:"Shft",SINGLE:"Single"},d=function d(){return this.rhsCP.startIndexInContainer;},M=function M(w,x){var v=this.rhsCP.getUnmergedCells(w)||[];if(v.length>x){return v[x];}else{return this.rhsCP.getCell(w,x-v.length);}},Q=function Q(AG,AC,v){var AB=AG.o,w=AB,z=AG._gd,AF=AG._e&&AG._e.id,AE,AD=this.zone.searchRow(AB+AC),AA,x=AG.colIx;if(AD!==null){AA=v===1?AD.max-AC:AD.min;while(Math.abs(AB-AA)>0){AE=M.call(this,AB+v,x);if(!AE||AF!==(AE._e&&AE._e.id)||(w!==AE.o&&z===AE._gd)){break;}AB+=v;}return AB+AC;}else{return null;}},b=function(v){var z=this.model.getCellDataUnion(v),w={},x;Y.forEach(z,function(AA){x=AA.v;if(w[AA.tid]&&w[AA.tid][0]&&w[AA.tid][0].n){x=w[AA.tid][0].n+":"+AA.v;}w[AA.tid]=[{id:AA.eid,n:x}];});return w;},h=function h(AL){if(!AL){return null;}if(!this.selectSiblings(AL)){return[AL];}var AH=[],AB=this.getCellForNode(AL),AK=this.gridData,AJ=AK.gsi,AG,z,AF,AM,v,w,AC,AA,AI,AD,AE=function(AO,AN){var AP=true;if(AO.length===AN.length){Y.forEach((AO||[]),function(AQ){AP=AP&&Y.find(AN,"id",AQ.id)!==-1;return AP;});return AP;}return false;},x=this.model.getCellInfo(AB);if(x.isMetric){if(AJ.tma===2){AG=AL.parentNode.childNodes;for(z=0;z<AG.length;z++){AA=true;AF=this.getCellForNode(AG[z]);if(AF&&AF.hasOwnProperty("mix")){AI=b.call(this,AF);AD=b.call(this,AB);w=V.keyarray(AI);AC=V.keyarray(AD);if(!!w.length&&w.length===AC.length){Y.forEach((w||[]),function(AN){AA=AA&&AE(AI[AN],AD[AN]);return AA;},this);}else{AA=false;}if(AA){AH.push(AG[z]);}}}}else{AH.push(AL);}}else{if(this.isSelectAllCell(AL)){AH.push(AL);}else{if(AB&&AB._e&&AB.axis===1){AM=H.call(this,false);Y.forEach((AM||[]),function(AN){for(z=0;z<=AN.childNodes.length;z++){v=AN.childNodes[z];AF=this.getCellForNode(v);if(AF&&AF._e){if(this.model.compareElementsId(AB._e.id,AF._e.id)){AH.push(v);}}}},this);}else{if(AB&&AB._e&&AB.axis===2){AG=AL.parentNode.childNodes;for(z=0;z<AG.length;z++){AA=true;AF=this.getCellForNode(AG[z]);if(AF&&AF._e){if(AB._e.id===AF._e.id){AH.push(AG[z]);}}}}}}}return AH;},e=function e(){this.selCells=[];this.clearSelections();},S=function S(x){var w=this,v=w.getCellForNode(x);this.selCells=Y.filter(this.selCells,function(AA){var z=w.getCellForNode(AA);return z&&v&&(z.tui||z.ui)!==(v.tui||v.ui);});this.clearUnitSelections(this.model.data.gts[v.axis===1?"row":"col"][v.tui||v.ui].id);},r=function r(x){var w=this.isSelectAllCell(x),z=this.getCellForNode(x),AA=this.model.getCellInfo(z),v=this.model.getCellTitleInfo(z);if(!z){return ;}if(!w){if(Y.indexOf(this.selCells,x)===-1){this.selCells.push(x);}}else{if(!z.hasOwnProperty("mix")){var AB=AA.isMetric?"Metrics":(v.title&&v.title.id),AD=this.model.scm,AC=AB&&AD&&AD[AB];if(AC&&(AC.all||AC.showall)){this.addAttributeSelection(v.title.id,"OA:(All)","all");}}return ;}if(z.hasOwnProperty("mix")){this.addMetricValueSelection(b.call(this,z));}else{this.addAttributeSelection(v.title.id,z._e.id,z._e.n);}},I=function I(v){var x=this.selCells.indexOf(v),w=this.getCellForNode(v);this.selCells.splice(x,1);if(w.hasOwnProperty("mix")){this.removeMetricValueSelection(b.call(this,w));}else{this.removeAttributeSelection(this.model.getCellTitleInfo(w).title.id,w._e.id);}},W=function W(){this.clearContextMenuHighlights();this.cmSelCells=[];this.clearCxtMnuSelection();},q=function q(w,z){var x=this.getCellForNode(w),v=this.model.getCellTitleInfo(x);if(Y.indexOf(this.cmSelCells,w)===-1){this.cmSelCells.push(w);if(x.hasOwnProperty("mix")){this.addContextMenuMetricValueSelection(b.call(this,x));}else{this.addContextMenuAttributeSelection(v.title.id,x._e.id,z.n,undefined,undefined,undefined,z.fm);}}},F=function(AG){var AE=this,AA={n:"",fm:""},AD,w=[],x,v,AF,AC,z=[],AB=0;if(AG.length){Y.forEach(AG,function(AH){AD=AE.getCellForNode(AH);v=AD._e;x=v&&v.n;if(x){w.push(x);}});if(v){AF=v.id.split(";");AC=AF[1];z=Y.map(AE.model.getAttributeFormsInTemplate(AC),function(AH){return AH.bfid;});AA.fm=z.join(";");AB=z.length;}if(w.length){AA.n=w.slice(0,AB).join(" ");}}return AA;},c=function c(){var z=this,w,v,x;W.call(this);this.cmSelCells=this.selCells.slice(0);Y.forEach(this.cmSelCells,function(AA){x=F.call(z,h.call(z,AA));w=z.getCellForNode(AA);v=z.model.getCellTitleInfo(w);if(w.hasOwnProperty("mix")){z.addContextMenuMetricValueSelection(b.call(z,w));}else{z.addContextMenuAttributeSelection(v.title.id,w._e.id,x.n,undefined,undefined,undefined,x.fm);}});},B=function B(w){var v=this.getCellForNode(w);if(v){return Y.some(this.model.getCellDataUnion(v),function(x){return x.isSubtotal;});}return false;},U=function U(x,AA,w){var z,v,AB=this;if(V.isEmpty(x)&&(!w&&this.clearAllSelections&&this.clearAllSelections())){e.call(this);}x=Y.filter((x||[]),function(AC){return !B.call(AB,AC);});Y.forEach(x,function(AC){v=AA;z=~Y.indexOf(this.selCells,AC);if(A.TOGGLE===v){v=z?A.REMOVE:A.APPEND;}if(A.REPLACE_ALL===v){if(w){S.call(this,AC);}else{e.call(this);}AA=v=A.APPEND;}switch(v){case A.APPEND:r.call(this,AC);break;case A.REMOVE:I.call(this,AC);break;}},this);},a=function a(v){var x=this,w;v=Y.filter((v||[]),function(z){return !B.call(x,z);});W.call(this);w=F.call(this,v);Y.forEach(v,function(z){q.call(this,z,w);},this);},J=function J(AC,AD,w,AA){var z=Math.min(AD,AA),AB=Math.min(AC,w),AI=Math.max(AD,AA),v=Math.max(AC,w),AF,AE,AH=[],AG=function(x,AJ){Y.forEach((AJ||[]),function(AK){if(Y.indexOf(x,AK)===-1){x.push(AK);}});};for(AF=AB;AF<=v;AF++){for(AE=z;AE<=AI;AE++){AG(AH,h.call(this,C.call(this,AF,AE)));}}U.call(this,AH,A.APPEND);},Z=function Z(v,AC){var AD,AA=this.selectorControl&&this.selectorControl.showall,AE=!!this.defn.msuc,w=this.isSelectAllCell(AC),AF=(this.model.getSelectorControlMapInfo?this.model.getSelectorControlMapInfo():[]),x=!this.selectorControl&&(AF&&AF.length>0),AG,z,AI,AB,AH=this.parent&&this.parent.defn&&this.parent.defn.t===527;if(AH){AE=!!this.parent.defn.msuc;}if(x){if(!AE){v=k.SINGLE;}AI=this.getCellForNode(AC);z=AI&&AI.id;AB=Y.find(AF,"did",z);if(AB>=0){AG=AF[AB].sc;AA=AG.showall||AG.all;}}if(AC.attributes.getNamedItem("ei")!==null&&(x||(!B.call(this,AC)&&(AA||!w)))){AD=this.getSelectionHash();if(V.isEmpty(AD)){this.selCells=[];}if(AC.className.indexOf(this.CELL_HIGHLIGHT)!==-1&&this.selCells.length>0){if(AA===false&&(v===k.SINGLE||v===k.CONTROL)&&l.call(this,AC)){return ;}if(v===k.SINGLE&&l.call(this,AC)){v=k.CONTROL;this.xTabHiddenTextArea.blur();}}this.clearHighlights();this["on"+v+"Select"](AC,x);this.lastSelectedCell=AC;if(v!==k.SHIFT){this.shiftInfo={lastCell:AC,selCells:[].concat(this.selCells)};}this.markSelections();this.endSelections();}else{if(AA===true&&AC.attributes.getNamedItem("ei")===null&&!this.cellMenuOnCloseFlag){e.call(this);this.markSelections();this.endSelections();}}},u=function u(x){var w=false,v=this.isSelectAllCell(x);if(x.attributes.getNamedItem("ei")!==null&&!v){w=this.isSelected(x);if(w){c.call(this);}else{a.call(this,h.call(this,x));}this.markContextMenuSelections();}},l=function l(AC){var x=this.selCells,AA=true;if(this.selectSiblings(AC)){var w=this.getCellForNode(x[0]),v=this.model.getCellInfo(w).isMetric,z=v?w._ei:w._e&&w._e.id,AB=v?w._tp&&w._tp._e&&w._tp._e.id:undefined;AA=!Y.some(x,function(AD){AD=this.getCellForNode(AD);if(v){return AD._tp._e.id===AB&&AD._ei!==z;}else{return AD._e&&AD._e.id!==z;}}.bind(this));}else{if(x.length>1){AA=false;}}return AA;};mstrmojo.vi.ui.rw._IsMultiselectXtab=mstrmojo.provide("mstrmojo.vi.ui.rw._IsMultiselectXtab",{_mixinName:"mstrmojo.vi.ui.rw._IsMultiselectXtab",selCells:[],cmSelCells:[],cellMenuOnCloseFlag:false,lastSelectedCell:null,isMultiSelect:false,getLastSelectedCell:function G(){return this.lastSelectedCell;},onCtrlSelect:function f(v,w){U.call(this,h.call(this,v),A.TOGGLE,w);},onShftSelect:function t(AL,x){if(x){return this.onSingleSelect(AL,x);}var w=this.shiftInfo.lastCell;if(K.call(this,AL,w)){this.selCells=[].concat(this.shiftInfo.selCells);var AG=d.call(this),AH,AA,AE,z,AF,AJ,AI=n.call(this,w),AD=n.call(this,AL),v=parseInt(w.getAttribute("r"),10),AK=parseInt(AL.getAttribute("r"),10),AC=this.model.getCellInfo(this.getCellForNode(AL));if(AC.isMetric){AH=v;AA=AK;}else{if(AI===AD){AF=this.getCellForNode(w);AJ=this.getCellForNode(AL);}else{var AB=Math.min(AI,AD);AF=M.call(this,v-AG,AB);AJ=M.call(this,AK-AG,AB);if(this.zone.searchRow(AF.o+AG)===null){AF=this.getCellForNode(w);}if(this.zone.searchRow(AJ.o+AG)===null){AJ=this.getCellForNode(AL);}}AE=(AF.o<AJ.o)?AF:AJ;AH=Q.call(this,AE,AG,-1);z=(AF.o>AJ.o)?AF:AJ;AA=Q.call(this,z,AG,1);}J.call(this,AI,AH,AD,AA);}},onSingleSelect:function P(v,w){U.call(this,h.call(this,v),A.REPLACE_ALL,w);},handleSelection:function E(AA,v,z){var x=z&&X.findAncestorByName(z,"td",true,this.viewport),w=K.call(this,x,this.lastSelectedCell),AB;if(!X.isRMC(AA,v)){if(X.isMetaKey(v,AA)&&w){AB=k.CONTROL;}else{if(X.shiftKey(v,AA)&&w){AB=k.SHIFT;}else{AB=k.SINGLE;}}Z.call(this,AB,x);}else{if(!(X.isMetaKey(v,AA)||X.shiftKey(v,AA))){u.call(this,x);}}},markSelections:function D(){this.highlightCells(this.selCells);},markContextMenuSelections:function R(){this.highlightCellsWithContextMenuSelection(this.cmSelCells);},handlesMultiSelection:function j(v){return(this._super&&this._super(v))||this.isMultiSelect;},isSelected:function p(v){return Y.indexOf(this.selCells,v)!==-1;},addSelection:function O(v){if(!this.isSelected(v)){Z.call(this,k.CONTROL,v);}},onclick:function g(w){X.clearBrowserHighlights();W.call(this);var z=w.getTarget&&w.getTarget();if(this.handlesMultiSelection(w)){if(mstrApp.isExpress){var x=z&&X.findAncestorByName(z,"td",true,this.viewport),v=X.findAncestorByName(z,"span",true,x);if(v){this.handleSelection(w.e,w.hWin,z);}}else{this.handleSelection(w.e,w.hWin,z);}}else{this._super(w);}this.cellMenuOnCloseFlag=false;},singleUnitSelect:function m(){var w=this.lastSelectedCell,v=this.getCellForNode(w);this.defaultAction(w,v);},getActionCells:function L(v){var x=this,w=Y.map(Y.filter(this.selCells,function(AA){var z=x.getCellForNode(AA);return z&&v&&(z.tui||z.ui)===(v.tui||v.ui);}),function(z){return x.getCellForNode(z);});if((w.length===0)||!this.model.getCellTitleInfo(v).isSrcTitle){w=this._super(v);}return w;},openXtabCellMenu:function N(AA){var w=mstrmojo.findAncestor(this,"openXtabCellMenu"),x=this,v=null;if(this.isInFilterPanel()&&mstrApp&&mstrApp.isInVFInteractMode){w=this.controller&&this.controller.view;}if(w){if(AA.evt){if(X.isMetaKey(AA.hWin,AA.evt)){var z=AA.td&&X.findAncestorByName(AA.td,"td",true,this.viewport);this.addSelection(z);}}v=w.openXtabCellMenuWithSelectionStyleControl(AA);if(v){v.onCloseMenuCallBack=function(){x.clearContextMenuHighlights();x.cellMenuOnCloseFlag=true;};}if(this.parent&&this.parent.selectVIUnit){this.parent.selectVIUnit();}}},highlightCells:function(w,v){if(this._super){this._super(w,v);}if(v){this.selCells=w;}},selectSiblings:function(){return true;},isSelectAllCell:function o(x){var v=this.getCellForNode(x),w=v&&this.model.getCellDataUnion(v);return !!v&&(w.length===0||(w.length===1&&!w[0].eid));}});}());(function(){mstrmojo.requiresCls("mstrmojo.string","mstrmojo.dom","mstrmojo.css","mstrmojo.array");var E=mstrmojo.dom,Q=mstrmojo.css,B=mstrmojo.string,I="selected",L="hidden";function P(W,X,Y,V,a){var Z=a.listHooks[W];if(Z&&Z.call(a,X,Y,V)){return ;}Q.toggleClass(X,I,W==="select");}function G(Y,X,W){var Z=this[Y],V=Z?Z.split(X):[];this[Y]=mstrmojo.array.distinct(V.concat(W.split(X))).join(X);}mstrmojo._IsList=mstrmojo.provide("mstrmojo._IsList",{_mixinName:"mstrmojo._IsList",listHooks:{},useListModKeys:false,init:function N(V){this._super(V);this._shiftStartIndex=-1;},getItemMarkup:function D(W,V){return'<{@tag} class="item {@cls}" idx="{@idx}" style="{@style}" title="{@title}">{@en@n}</{@tag}>';},getItemDisplayName:function M(V){return V.n||"";},getItemProps:function R(Z,V){var W=!!this.selectedIndices[V],a={tag:"div",sel:W,cls:"",n:this.getItemDisplayName(Z),style:"",idx:V,addCls:function X(c){G.call(this,"cls"," ",c);},addStyle:function Y(c){G.call(this,"style",";",c);},title:Z.title||""};if(a.n&&B.isEmpty(a.n)){a.n=B.decodeHtmlString("<br/>");}if(W){a.addCls(I);}var b=Z.cls;if(b){a.addCls(b);}if(Z.hid){a.addCls(L);}return a;},itemRenderer:{render:function S(W,V,X){W._renderIdx=V;return mstrmojo.string.apply(X.getItemMarkup(W,V),X.getItemProps(W,V));},select:function K(W,X,V,Y){P("select",W,X,V,Y);},unselect:function H(W,X,V,Y){P("unselect",W,X,V,Y);}},onclick:function U(V){try{var X=this.getItemFromTarget(V.getTarget());if(X){V.cancel();this.doItemSelect(X,V||{});}}catch(W){mstrApp.onerror(W);}},doItemSelect:function C(l,k){var c=k.hWin,d=k.e,h=l._renderIdx,f=l._positionIdx,W=E.isMetaKey(c,d),b=E.shiftKey(c,d),X=this.multiSelect,a=this.useListModKeys,j=this._shiftStartIndex,Y=this.selectedIndices;if(X&&a&&b&&j>-1){var V=[],Z=[];this.processContinuousSelection(V,Z,h);this.addSelect(V);this.removeSelect(Z);}else{if(X&&(!a||W)){var g=(Y[h])?"remove":"add";this[g+"Select"](h,false,f);}else{this.singleSelect(h,false,f);}this._shiftStartIndex=h;}},processContinuousSelection:function J(X,W,V){var c=this._shiftStartIndex,b=this.selectedIndices,a=Math.min(c,V),Z=Math.max(c,V),Y;for(Y=0;Y<this.items.length;Y++){if(a<=Y&&Y<=Z){if(!b[Y]){X.push(Y);}}else{if(b[Y]){W.push(Y);}}}},onclearSelection:function A(){this._shiftStartIndex=-1;},getItemNodeFromTarget:function F(W){var V=E.findAncestorByAttr(W,"idx",true,this.domNode);return(V&&V.node)||null;},getItemFromTarget:function O(X){var W=this.getItemNodeFromTarget(X),V=W&&parseInt(W.getAttribute("idx"),10);if(V!==null&&!isNaN(V)&&this.items){return this.items[V];}return undefined;}});mstrmojo._IsList.SELECTED_CLS=I;mstrmojo._IsList.HIDDEN_CLS=L;}());(function(){mstrmojo.requiresCls("mstrmojo.array","mstrmojo.expr","mstrmojo.css");var G=mstrmojo.array,F=mstrmojo.expr,H=mstrmojo.css;mstrmojo._IsExprNode=mstrmojo.provide("mstrmojo._IsExprNode",{ind:function B(){var L=this.parent;if(L&&L.indent){var K=this.childIndex();K=(K>-1&&(K>0))?[K,K-1]:null;if(K){L.indent(K);}}},out:function D(){var L=this.parent;if(L&&L.outdent){var K=this.childIndex();K=(K>-1&&(K>0))?[K,K-1]:null;if(K){L.outdent(K);}}},andOrTxt:function A(){var M=this.parent,K=M&&M.data,L="",N=this.data;if(K&&(K.et===F.ET.ANDOR)&&K.fn){L=K.fn+(N&&N.not?"_"+F.FN.NOT:"");L=F.BRANCH_FNS[L];}return'<span class="mstrmojo-text mstrmojo-andor">'+L+"</span>";},getPrefixAndOrToolsMarkup:function(){return('<span class="mstrmojo-indent" onclick="mstrmojo.all[\'{@id}\'].ind()" mstrAttach:mouseover,mouseout>'+mstrmojo.desc(5895,"Group conditions")+'</span><span class="mstrmojo-outdent" onclick="mstrmojo.all[\'{@id}\'].out()" mstrAttach:mouseover,mouseout>'+mstrmojo.desc(5896,"Ungroup Conditions")+"</span>");},premousedown:function J(K){var L=mstrmojo.dom.eventTarget(K.hWin,K.e);if(this.prefixHoverNode&&mstrmojo.dom.contains(this.prefixHoverNode,L,false)){mstrmojo.dom.stopPropogation(K.hWin,K.e);return ;}if(this._super){this._super(K);}},isSelectableArea:function E(K){return true;},childIndex:function I(){var M=this.parent,K=M&&M.data,L=K&&K.nds,N=this.data;if(L&&N){return G.indexOf(L,N);}return -1;},toggleGroupBorder:function C(K){H.toggleClass(this.parent.itemsContainerNode.childNodes[this.childIndex()-1].firstChild,"upgroup",K);H.toggleClass(this.domNode,"downgroup",K);}});}());(function(){mstrmojo.requiresCls("mstrmojo.array","mstrmojo.css");var F=mstrmojo.array,D=mstrmojo.css;function B(G,J,H){var I=Number(G).toFixed(J);return H?parseFloat(I):I;}mstrmojo.mapbox.ui.selectors._SliderCommon=mstrmojo.provide("mstrmojo.mapbox.ui.selectors._SliderCommon",{_mixinName:"mstrmojo.mapbox.ui.selectors._SliderCommon",generateItems:function E(K,G,L){var H=[],J,I;L=L||0.1;for(J=K,I=0;J<=G;I++){H[I]={n:""+J,v:J};J=B(J+L,1,true);}return H;}});mstrmojo.mapbox.ui.selectors._SliderCommon.getIndexByValue=function A(G){return F.find(this.items,"v",B(G,1,true));};mstrmojo.mapbox.ui.selectors._SliderCommon.enabledMarkupMethod=function C(){var H=this.children,G=this.enabled;D.toggleClass(this.domNode,"disabled",!this.enabled);F.forEach(H,function(I){if(I&&I.set instanceof Function){I.set("enabled",G);}});};}());(function(){mstrmojo.requiresClsP("mstrmojo","dom","hash","array","css","func","desc");var P=mstrmojo.dom,C=mstrmojo.css,Q=mstrmojo.hash,c=mstrmojo.array,o=mstrmojo.func,L=mstrmojo.desc;var K,F=[],AA="moving";mstrmojo.requiresDescs(15934,15935,15936,15937,15938,15939,15940,1006);function R(AE,AD){var AC=AE&&AE.length||0;AD=AD===undefined?30:AD;return AE+Array(Math.max(AD-AC,0)+1).join(" ");}function B(AC){if(K){window.clearTimeout(K);K=null;}G();c.forEach(AC,function(AD){C.toggleClass(AD,AA,true);});F=[].concat(AC);K=window.setTimeout(G,1000);}function G(){c.forEach(F,function(AC){C.toggleClass(AC,AA,false);});F=[];}function h(AK,AI,AC,AG){var AL=AK.rows,AD=AL.length,AF;if(AI<0||AI>=AD||AC<0||AC>AD){AF=false;}else{if(AC===AI||AC===AI+1){AF=true;}else{var AH=AL[AI],AE=AK.insertRow(AC);P.replace(AE,AH);if(mstrmojo.debugBundles&&console){console.log("move "+R('"'+AH.cells[0].textContent.trim()+'"')+' after "'+AK.rows[AH.rowIndex-1].textContent.trim()+'"');}if(!AG){B(Array.apply(null,AH.cells));}if(AI===1||AC===1){var AJ=this.getViz();AJ.offsetCellNode=S.call(this).rows[1].cells[0];}AF=true;}}return AF;}function x(AC){var AD=P.findAncestorByName(AC,"tr");return AD&&AD.rowIndex;}function H(AE,AF){var AC;if(AE){var AG=P.findAncestorByName(AE,"tr"),AD=AG&&AG.rowIndex;AC=AD+(AF?0:1);}else{if(AF){AC=S.call(this).rows.length;}else{AC=1;}}return AC;}function r(AE,AD){var AC;if(AE){AC=AE.ordinal;}else{if(AD){AC=Y.call(this)-1;}else{AC=0;}}return AC;}function Y(){var AC=this.getViz();dataBlocks=AC.dataBlocks,tc=0;c.filterOne(dataBlocks,function(AD){tc=AD&&AD.rw.row.tc;return tc!==undefined;});return tc;}function AB(AJ,AD){var AK=u.call(this),AN=AK.rowsPerPage,AL=Math.ceil((AJ+2)/AN)-1,AF=AK.pageStatus[AL],AE=[],AG;for(AG=AK.numPagesRendered;AG<AL;AG++){AE.push({idx:AG,fill:false});}var AI,AC;if(!AF||!AF.filled){if(AF&&AF.isOnDemand()){if(!AF.isDownloading&&!AK.isDownloading){var AM=AL*AN-1,AH=(AL+1)*AN-2;AF.isDownloading=true;AK.isDownloading=true;AK.cp.download(AM,AH);AI=true;AC=AH-AM+1;if(mstrmojo.debugBundles&&console){console.log("load data from orddinal "+AM+" to "+AH+" for page index "+AL+" and ordinal "+AJ);}}AE.push({idx:AL,fill:false});}else{AE.push({idx:AL,fill:true});}}if(AI&&AD){AK.parent.showDownloadStatus(AC);}else{AK.parent.closeDownloadStatus();}return AE;}function S(){var AC=u.call(this);return AC.tableNode;}function u(){var AC=this.getViz();return AC.zone;}function a(AF){var AD=this.getViz(),AC=AD.scrollboxLeft,AE=AD.scrollboxTop;if(AC!==AF.x||AE!==AF.y){AD.scrollTo(AF);}}mstrmojo.vi.controllers.CustomSortModeActionMgr=mstrmojo.declare(null,null,{scriptClass:"mstrmojo.vi.controllers.CustomSortModeActionMgr",actions:null,pos:-1,historicalUnsilentActions:null,csDisplayPanel:null,init:function p(AC){Q.copy(AC,this);this.actions=[];this.historicalUnsilentActions=[];},appendHistUnsilentActions:function d(AC){this.historicalUnsilentActions=this.historicalUnsilentActions.concat(AC);},getViz:function b(){return this.csDisplayPanel.getVizBox().boxContent;},wrapCustomSortAction:function I(AD,AF,AC){var AG=this,AE=this.getViz();return{silent:true,submitAction:AD,srcEle:this.getOrdinalInfo(AF),tgtEle:this.getOrdinalInfo(AC),srcRefOrdinal:this.getRefOrdinal(AF),perform:function(AM,AP,AN){var AJ=this,AL=AJ.srcEle,AI=AJ.tgtEle,AK=AJ.submitAction.before,AQ=function(){var AV=AG.getNodeForOrdinal(AL.ordinal),AU=AG.getViz(),AS=AU.getCellForNode(AV),AR=AI&&AG.getNodeForOrdinal(AI.ordinal),AT=AR&&AU.getCellForNode(AR);if(AG.hasFailedSorts()||AS._e.id!==AL.id||AT&&AT._e.id!==AI.id){AG.addFailedSorts(AL.n,AI&&AI.n,AK);}else{h.call(AG,S.call(AG),x(AV),H.call(AG,AR,AK),AN);if(!AM){a.call(AG,{x:AU.scrollboxLeft||0,y:AG.getScrollYForGoldenSectionPoint(AV)});}}if(AP){AP();}};if(AM){AG.resetFailedSorts();AQ();}else{var AH=AJ.srcEle.ordinal,AO=r.call(AG,AJ.tgtEle,AK);if(AG.hasFailedSorts()){AG.addFailedSorts(AL.n,AI&&AI.n,AK);if(AP){AP();}}else{AG.prepareDataAndPages([AH,AO],AQ);}}},undo:function(){var AL=AG.getNodeForOrdinal(this.srcEle.ordinal),AJ=x(AL),AI=AG.getNodeForOrdinal(this.srcRefOrdinal),AH=H.call(AG,AI,false),AK=S.call(AG);h.call(AG,AK,AJ,AH);a.call(AG,{x:AG.getViz().scrollboxLeft||0,y:AG.getScrollYForGoldenSectionPoint(AL)});}};},prepareDataAndPages:function M(AH,AJ){var AF=0,AC=AH.length,AD=u.call(this),AG=this,AI=0;var AE=function(){self.setTimeout(function(){try{var AK=AB.call(AG,AH[AF]);if(AK.length>0){mstrApp.showWait();AD.preRenderPages();AD.renderPages(AK);AD.postRenderPages();AD._postPagesClearup=true;}else{if(AD._postPagesClearup){AD.postRenderPagesCleanup();AD.configureActions();AD._postPagesClearup=false;}if(AD.isRenderingComplete()){AD.postRenderingCleanup();}AF++;}if(AK.length>0||AF<AC){AI=AD.renderPause;AE();}else{AG.dpPreparingCleanUp();if(AJ){AJ();}}}catch(AL){AG.dpPreparingCleanUp();mstrApp.hideWait(true);throw AL;}},AI);};AD.renderingRows=true;AE();},dpPreparingCleanUp:function E(){u.call(this).renderingRows=false;},getRefOrdinal:function Z(AE){var AG=this.getViz(),AC=AG.zone.tableNode.getElementsByTagName("tr"),AD=AE.cellIndex,AH=AE.parentElement.rowIndex,AF=AC[AH-1].cells[AD];return AG.getCellForNode(AF).o;},getOrdinalInfo:function z(AD){var AC=this.getViz().getCellForNode(AD);if(AC&&AC._e){return{id:AC._e.id,n:AC._e.n,ordinal:AC.o};}},getNodeForOrdinal:function q(AC){var AF=S.call(this).rows;if(AC>=0){var AD=AC+1,AE;AE=c.filterOne(AF,function(AG){return parseInt(AG.firstElementChild.getAttribute("r"),10)===AD;});return AE.firstElementChild;}else{return AF[0].firstElementChild;}},getScrollYForGoldenSectionPoint:function U(AG){var AD=0.618,AI=this.getViz(),AC=AI.tableContainerNode.getBoundingClientRect(),AF=AC.top+AC.height*(1-AD),AE=AG.getBoundingClientRect(),AH=AE.top+AE.width/2;return(AI.scrollboxTop||0)+AH-AF;},wrapUnsilentAction:function W(AD,AC,AF,AE){var AG=this;return{silent:false,needDataReady:!!(AE&&AE.needDataReady),submitActions:c.ensureArray(AD),undoCallback:AC,perform:function(AI,AK){var AH=[],AI=c.ensureArray(AI),AL=AG.getViz(),AM=AL.model.getDataService(),AJ;if(AI.length>0){AH=AH.concat(AI);}AH=AH.concat(this.submitActions);AJ=AL.controller._getXtabCallback(AL,Q.copy(AC));if(AK){AJ=o.wrapMethods(AJ,AK);}AF=Q.copy(AF||{});AF.hideCancel=true;AF.noUpdate=true;AF.preserveStid=true;AF.noDeltaXML=true;AM.submitUpdates(AM.getUpdateTemplateAction(AL.k,AH),AJ,AF);}};},addAction:function v(AC){var AD=this.actions,AE=this.pos;AD.splice(AE+1);AD.push(AC);this.pos=AD.length-1;this.csDisplayPanel.updateStatus();},execute:function f(AD){this.addAction(AD);if(AD.silent){AD.perform(true);}else{var AC=this.getCustomSortActAhead();AD.perform(c.ensureArray(AC));}},undo:function V(){var AD=this.actions[this.pos];if(!AD){return ;}this.pos--;this.csDisplayPanel.updateStatus();if(AD.silent){AD.undo();}else{var AC=this.getActionParts4Undo();this.csDisplayPanel.recreateCSVizForUndo(AC.splitUTActions,AC.silentActions,AD.undoCallback);}},getActionParts4Undo:function m(){var AI=[],AK=[AI],AH=[],AF=this.actions,AG=this.pos,AD,AJ;while(AG>=0){AD=AF[AG];if(AD&&AD.silent){AH=[AD].concat(AH);}else{break;}AG--;}while(AG>=0){AD=AF[AG];if(AD){if(AD.silent){AJ=this.getCustomSortActAhead(AG+1);AI.unshift(AJ);AG=AG-(AJ.actions.length-1);}else{AI.unshift.apply(AI,AD.submitActions);if(AD.needDataReady){AI=[];AK.unshift(AI);}}}AG--;}var AE=this.historicalUnsilentActions,AC;AG=AE.length-1;while(AG>=0){AC=AE[AG];AI.unshift.apply(AI,AC.submitActions);if(AC.needDataReady){AI=[];AK.unshift(AI);}AG--;}return{splitUTActions:AK,silentActions:AH};},redo:function O(){var AD=this.actions[this.pos+1];if(!AD){return ;}this.pos++;this.csDisplayPanel.updateStatus();if(AD.silent){this.resetFailedSorts();var AC=this;AD.perform(false,function(){mstrApp.hideWait(true);if(AC.hasFailedSorts()){AC.actions.splice(AC.pos);AC.pos--;AC.csDisplayPanel.updateStatus();AC.showFailedSortsAndReset();}});}else{AD.perform(this.getCustomSortActAhead());}},getContSlientActionsBehind:function X(){var AC=this.actions.length,AD,AE=[],AF;for(AD=this.pos+1;AD<AC;AD++){AF=this.actions[AD];if(AF&&AF.silent){AE.push(AF);}else{break;}}return AE;},getContSlientActionsBefore:function e(){var AF=this.actions,AC,AD=[],AE;for(AC=this.pos;AC>=0;AC--){AE=AF[AC];if(AE&&AE.silent){AD=[AE].concat(AD);}else{break;}}return AD;},getSlientActionsBefore:function A(){var AC=this.actions.slice(0,this.pos+1);return c.filter(AC,function(AD){return AD&&AD.silent;});},getUnslientActionsBefore:function l(){var AC=this.actions.slice(0,this.pos+1);return c.filter(AC,function(AD){return AD&&!AD.silent;});},getCustomSortActAhead:function k(AG){var AC=[],AD=(AG===undefined?this.pos:AG)-1,AF=this.actions;while(AD>=0){var AE=AF[AD];if(AE.silent){AC=[AE.submitAction].concat(AC);}else{break;}AD--;}if(AC.length>0){return this.csDisplayPanel.wrapCustomSortAction(AC,true);}},isCurrentActionSilent:function N(){return this.actions[this.pos]&&this.actions[this.pos].silent;},reset:function j(){this.actions=[];this.pos=-1;this.csDisplayPanel.updateStatus();},getActionsCount:function t(){return(this.actions||[]).length;},getFailedSortsCount:function g(){return(this.failedSorts||[]).length;},resetFailedSorts:function n(){this.failedSorts=[];},hasFailedSorts:function J(){return(this.failedSorts||[]).length>0;},addFailedSorts:function D(AD,AE,AC){this.failedSorts=this.failedSorts||[];this.failedSorts.push({srcName:AD,tgtName:AE,isPost:AC});},showFailedSortsAndReset:function w(){if(this.hasFailedSorts()){var AD=this.failedSorts.length,AF,AI,AC,AG,AH=L(15934,"Below sorting manipulations fail due to change in source data:")+" ";for(var AE=0;AE<AD;AE++){AF=this.failedSorts[AE];AI=AF.srcName;AC=AF.tgtName;AG=AF.isPost;if(AC){AH+=AG?L(15935,'move "#" before "##"').replace("#",AI).replace("##",AC):L(15936,'move "#" after "##"').replace("#",AI).replace("##",AC);}else{AH+=AG?L(15937,'move "#" to the end').replace("#",AI):L(15938,'move "#" to the top').replace("#",AI);}if(AE===AD-1){AH+=L(1006,".")+" ";}else{AH+=L(15939,",")+" ";}}AH+=L(15940,"Please manually do these sortings if necessary.");mstrmojo.err({message:AH});this.resetFailedSorts();}}});}());(function(){mstrmojo.requiresCls("mstrmojo.dom","mstrmojo.css");var C=mstrmojo.dom,G=100,L=700;var B="mojo-safari-hide-nativeTooltip",H=mstrmojo.css;function M(O,N){return function(Q){var P=mstrmojo.all[O];if(P.customTooltipHandler){P.customTooltipHandler(Q);}P[(N?"move":"show")+"Tooltip"](Q,self);};}function A(){var O=this.tooltipNode||this.domNode,Q=this.id,N,P="_ontooltip"+(this.isDynamicTooltip?"move":"over");if(!this._ontooltipout){this._ontooltipout=function(R){mstrmojo.all[Q].hideTooltip(R,self);};}if(!this[P]){this[P]=M(Q,this.isDynamicTooltip);}O=[].concat(O);for(N=0;N<O.length;N++){O[N].removeAttribute("title");C.attachEvent(O[N],(this.isDynamicTooltip?"mousemove":"mouseover"),this[P]);C.attachEvent(O[N],"mouseout",this._ontooltipout);}}function I(){var Q=this.tooltipNode||this.domNode,P;if(Q&&Q.constructor!==Array){Q=[Q];}if(Q){var R=this._ontooltipover,O=this._ontooltipout,N=this._ontooltipmove;for(P=0;P<Q.length;P++){if(R){C.detachEvent(Q[P],"mouseover",R);}if(O){C.detachEvent(Q[P],"mouseout",O);}if(N){C.detachEvent(Q[P],"mousemove",N);}}}}mstrmojo._HasTooltip=mstrmojo.provide("mstrmojo._HasTooltip",{tooltip:"",richTooltip:null,useRichTooltip:false,isDynamicTooltip:false,tooltipNode:null,tooltipOpenDelay:700,isIgnoreTooltipCloseDelay:false,hasWidgetContent:false,tooltipCloseDelay:G,hasOpenTooltip:false,postBuildRendering:function(){var N=this._super();if(this.useRichTooltip){A.call(this);}return N;},onuseRichTooltipChange:function K(){if(this.hasRendered){if(this.useRichTooltip){A.call(this);}else{I.call(this);this.hideTooltip();}}},showTooltip:function J(Q,P){var O=this;if(!O.hasOpenTooltip&&(!mstrApp.isInteractive||mstrApp.isInteractive&&mstrApp.isInteractive())){mstrmojo.requiresCls("mstrmojo.tooltip");if(this.updateTooltipConfig){this.updateTooltipConfig(Q);}window.clearTimeout(this._tooltipTimeOut);if(mstrmojo.dom.isIE){var S={};for(var N in Q){S[N]=Q[N];}Q=S;}var U=this.richTooltip?this.richTooltip.areaId:undefined;if(C.isSafari&&Q){var R=Q.srcElement;if(window.getComputedStyle(R)["text-overflow"]==="ellipsis"){this.baseElement=R;H.toggleClass(R,B,true);}}this._tooltipTimeOut=window.setTimeout(function(){var V=O.richTooltip;if(O._closeTooltipTimeout){window.clearTimeout(O._closeTooltipTimeout);delete O._closeTooltipTimeout;}mstrmojo.tooltip.open(O,Q,P);O.tooltip.onmouseover=function(){if(O.richTooltip&&O.richTooltip.enableHover){window.clearTimeout(O._closeTooltipTimeout);window.clearTimeout(O._deactivationTimeout);if(O.tooltip){O.tooltip.onmouseout=function(W){var X=W.e;if((!X.toElement&&!X.relatedTarget)||!C.contains(this.domNode,W.e.toElement||W.e.relatedTarget)){O.hideTooltip();}};}}};O.tooltip.allowOtherTooltips=O.allowOtherTooltips;if(V&&V.onClose){O.tooltip.onClose=V.onClose;}O.hasOpenTooltip=true;O._hasActiveArea=true;O._tooltipAreaId=U;window.clearTimeout(O._deactivationTimeout);delete O._deactivationTimeout;},(this._hasActiveArea&&U&&U===this._tooltipAreaId)?0:this.tooltipOpenDelay);}},moveTooltip:function D(N,P){if(this._tooltipTimeOut){window.clearTimeout(this._tooltipTimeOut);this._tooltipTimeOut=null;mstrmojo.tooltip.close();}var R=this,O=N,Q=P;this._tooltipTimeOut=setTimeout(function(){mstrmojo.tooltip.open(R,O,Q);},this.tooltipOpenDelay);},hideTooltip:function F(){var N=this;window.clearTimeout(this._tooltipTimeOut);if(C.isSafari&&this.baseElement){H.toggleClass(this.baseElement,B,false);}if(this._closeTooltipTimeout){window.clearTimeout(this._closeTooltipTimeout);}if(this._hasActiveArea&&!this._deactivationTimeout){this._deactivationTimeout=window.setTimeout(function(){delete N._deactivationTimeout;delete N._hasActiveArea;delete N._tooltipAreaId;},100);}mstrmojo.requiresCls("mstrmojo.tooltip");if((!this.isIgnoreTooltipCloseDelay)&&N.richTooltip&&N.richTooltip.enableHover){this._closeTooltipTimeout=window.setTimeout(function(){mstrmojo.tooltip.close();delete N._closeTooltipTimeout;},N.richTooltip.tooltipCloseDelay||this.tooltipCloseDelay);}else{if(N.tooltip){this.isIgnoreTooltipCloseDelay=false;mstrmojo.tooltip.close();}}this.hasOpenTooltip=false;},unrender:function E(N){I.call(this);this._super(N);}});mstrmojo._HasTooltip.TOOLTIP_OPEN_DELAY=L;mstrmojo._HasTooltip.TOOLTIP_CLOSE_DELAY=G;}());(function(){mstrmojo.requiresCls("mstrmojo.css","mstrmojo.hash","mstrmojo.string","mstrmojo.DICFactory");var P=3,A=8,X=2,Z=2,V=mstrmojo.css,B="********",S=mstrmojo.hash,N=mstrmojo.array,D=mstrmojo.string;var L=null;function I(g,e){if(g){var a=this.dicWidget;if(a&&a.setDirtyFlag){a.setDirtyFlag(g,e);}else{if(g.className!=="flag-container"){var b=document.createElement("div");b.className="flag-container";b.style.right="10px";b.innerHTML='<div class="dirty-cell"/>';e.insertBefore(b,g);}}}}function U(b,a){if(b.className==="flag-container"){a.removeChild(b);}}function F(d,b,c,a){return'<rwf rw_tree_type="'+this.tt+'" rw_node_key="'+this.fgk+'" rw_field_key="'+this.k+'" key="'+this.key+'" columns="'+this.cls+'" types="'+c+'" '+b+a+' dt="'+d.dt+'" />';}mstrmojo._IsEditableTextfield={_mixinName:"mstrmojo._IsEditableTextfield",preBuildRendering:function W(){if(!this.edb){var c=this.node.data,a=this.node.defn,b=c.dic||a.txi.dic,e=(this.rv==="")?this.value:this.rv;if(b.psw){this.v=B;e=this.rv="";}if(b.ipt===Z){b.vls=this.vls||[];this.dk=b.k;this.ddic=true;}this.dt=b.dt;this.dicWidget=mstrmojo.DICFactory.createDIC({dic:S.copy(b,{req:this.req}),enabled:!!this.enabled,owner:this,k:0,dv:this.value,value:e,openerType:X,popupTitle:a.n});if(this.shouldReplaceValueNode()){if(!L){L=S.clone(this.formatHandlers);}this.formatHandlers.domNode=["T","z-index","D","B","F","P","text-align","background-color","fx","white-space","overflow"];delete this.formatHandlers.valueNode;}}this.set("cssClass",this.edb?"":"editable-field");this._super();},shouldReplaceValueNode:function R(){return this.dicWidget.showByDefault||this.dicWidget.hasPreview;},postBuildRendering:function M(){this._super();if(this.edb){return ;}var a=this.dicWidget,c=this.valueNode.innerHTML;if(D.isEmpty(c)){this.valueNode.innerHTML=c+"1";this.valueNode.style.height=this.valueNode.clientHeight+"px";this.valueNode.innerHTML=c;}if(a.showByDefault){a.render();}else{if(this.enabled){if(a.hasPreview){a.openerNode=this.domNode;a.renderPreview(this.value);}else{a.openerNode=this.valueNode;}mstrmojo.dom.attachEvent(a.openerNode,mstrApp.isMobile?mstrmojo.dom.TOUCHEND:"click",function(){a.showInPopup();});}else{V.addClass(this.domNode,"disabled");return ;}}if(this.shouldReplaceValueNode()){S.copy(L,this.formatHandlers);}this.registerTxWidget();this.addToTraversalList();if(this.mdf&&this.sci){var b=this.domNode;I.call(this,b.firstChild,b);}},getKeyContext:function G(){return{dt:this.dt||0,k:this.dk||undefined};},getUpdates:function E(){var f=this.getUpdatedValues()[0],a=N.find(this.vls,"v",f.v),b=this.dicWidget,e=this.ddic&&(a===-1),c,d="";if(b.canSlice||e){d=F.call(this,f,"",A,"");}if(!e){c=f.k?('rw_control_key="'+f.k+'" element_id="'+D.encodeXMLAttribute(this.vls[a].eid)+'" '):"";d+=F.call(this,f,c,P,'value="'+D.encodeXMLAttribute(String(f.v))+'"');}return d;},updateValue:function O(h,b){if(this._super){this._super(h,b);}var k=this.valueNode,f=this.domNode,g=this.dicWidget,j=b.v,a=b.dv,e=N.find(this.vls,"v",j),c=this.ddic&&(e===-1);if(this.rv!==j){if(this.req){V.removeClass(f,"required");}this.rv=j;this.v=a;this.mdf=c?0:1;if(!g.showByDefault){if(g.hasPreview){g.renderPreview();}else{k[k.innerText!==undefined?"innerText":"textContent"]=this.psw?B:(!a?"\u00a0":D.decodeHtmlString(a,false));}}if(this.req){V.removeClass(f,"required");}if(this.sci&&!c){I.call(this,f.firstChild,f);}else{U.call(this,f.firstChild,f);}}if(this.txar){return true;}return false;},applyPasswordMask:function Q(){this.psw=true;this.v=B;this.rv="";},getUpdateObject:function J(){var c={fieldKey:this.k,wid:this.wid,newValue:D.encodeXMLAttribute(String(this.rv)),dataType:this.dt},a=-1,b=this.getUpdatedValues()[0];if(b.k!==undefined){c.controlKey=b.k;a=mstrmojo.array.find(this.vls,"v",b.v);c.elementId=a>=0?this.vls[a].eid:"";}return{nodeKey:this.fgk,cells:[c],retrieveData:false,autoRefresh:false};},autoRefresh:function(a){this.model.sendTransactionUpdates(a);},update:function K(a){if(this._super){this._super(a);}var c=a.data,b=a.defn;if(c.vls){this.vls=c.vls;}else{delete this.vls;}this.cell=a.data;this.value=c.v||"";this.rv=(c.rv===undefined)?this.value:c.rv;this.tca=c.tca||0;this.dt=c.dt;this.key=c.key||"";this.cls=c.cls||"";this.wid=c.wid;this.edb=c.edb;this.mdf=c.mdf;this.sci=b.txi.sci;this.req=this.required||b.txi.dic.req;this.tt=b.tt;this.fgk=b.fgk;this.txar=b.txi.txar;this.txck=b.txi.dic.ckey;},addToTraversalList:function Y(){if(mstrmojo.DICConfig.isKeyNavigable(this.dicWidget.dic)){var c=this.parent.traversalList,d=this.domNode;if(!c){c=this.parent.traversalList=[];}var a=this.k,b=false;N.forEach(c,function(e){if(e.refField.k===a){b=true;return false;}});if(!b){c.push({x:d.offsetLeft,y:d.offsetTop,h:d.offsetHeight,refField:this});}}},editNext:function H(){var f=this.parent.traversalList,d,a,c,e=0;if(!f){return false;}if(!f.isSorted){for(d=0,a=f.length;d<a;d++){e+=f[d].h;}c=e/a;f.sort(function(j,g){var k=Math.floor(j.y/c),h=Math.floor(g.y/c);if(k<h){return -1;}if(k>h){return 1;}if(j.x<g.x){return -1;}if(j.x>g.x){return 1;}return(j.y<g.y)?-1:1;});f.isSorted=true;}for(d=0,a=f.length;d<a;d++){if(f[d].refField.k===this.k){break;}}if(d<a){do{d++;if(d>=a){d%=a;}if(d===parseInt(this.k,10)){return false;}var b=f[d].refField.dicWidget;if(b){if(!b.showByDefault){b.showInPopup();}else{b.focus();}return true;}}while(true);}},checkRequiredObjects:function C(){if(this.req&&!this.mdf&&!this.edb){V.addClass(this.domNode,"required");return false;}return true;}};}());(function(){mstrmojo.requiresCls("mstrmojo.hash","mstrmojo.func","mstrmojo.array","mstrmojo.css");var X=mstrmojo.hash,U=mstrmojo.array,d=mstrmojo.func,g=mstrmojo.css;var P="selected",V="all",a="u;",L="levelAll",c=-100;var H=0,O=1,E=2;var F=["docSelector","multiSelect","allIdx","noneIdx","include"];function K(k){return parseInt(k,10)>=0;}function h(l){var k=[];l.forEach(function(m){delete m.children;});l.forEach(function(p,m,n){var o=n.p_index;if(o){if(o.children){o.children.push(p);}else{o.children=[p];}}else{k.push(p);}});return k;}function A(k){var l=k.slice(0);l.sort(function(n,m){if(n.n<=m.n||n.v===a){return -1;}return 1;});return l;}function J(l){var m=[],k=h(l);k.forEach(function n(o){m.push(o);(o.children||[]).forEach(function(p){n(p);});});return m;}function f(l){var k=this.sortedItemsCache;if(k){if(k[l]){return k[l];}}else{k=this.sortedItemsCache={};}switch(l){case O:return k[l]=A(this.items);case E:return k[l]=J(this.items);default:return k[l]=this.items;}}function D(){var k=this.items,m=this.sortedItemsCache,l=m&&this.sortedItemsCache[H];return !k||!l||k.length!==l.length||k.some(function(o,n){return o!==l[n];});}function j(){var l=this.docSelector,o=l.node.data.p_relation||[],k=this.items,m=!l.lockSelection,n=[];if(D.call(this)){k.forEach(function(q,p){q.p_index=o[p]&&o[p].p_index;if(q.v!==a){n[q.lv]=true;}});this.set("levels",n);this.sortedItemsCache={};this.sortedItemsCache[H]=k;if(m){this.set("applyEnabled",false);}Z.call(this,m);}}function B(n,m,l){var o={},k={};m.forEach(function(q,p){if(n[p]){o[q.v]=true;}});l.forEach(function(q,p){if(o[q.v]){k[p]=true;}});return k;}function N(l){var k=this.getCheckList();return B(l||k.selectedIndices,k.items,this.items);}function M(l){var k=this.getCheckList();return B(l||this.selectedIndices,this.items,k.items);}function Z(o){var l=this.getCheckList(),n=l.items,k=X.copy(l.selectedIndices)||{},m=f.call(this,K(this.level)?O:E);if(m.length>0){l.set("items",m);l.set("selectedIndices",o?M.call(this):B(k,n,m));}}function S(){var k=this.searchInput;if(k&&k.hasRendered){k.clearSearch(true);}}function W(){var l=this.searchInput,k=this.renderableItems||[];if(l&&l.isClear()){l.set("visible",k.length>15);}}function Q(){var k=this.searchInput,l=!k||k.isClear();return K(this.level)&&this.allIdx>=0&&l;}function e(){if(Q.call(this)){var l=this.selectedIndices,m=this.level,k=l[this.allIdx]||!(this.items||[]).some(function(o,n){return o.lv===m&&!l[n];});this.isLevelSelected=k;g.toggleClass(this._getItemNode(c),"selected",k);}}function R(){this.filterItems();W.call(this);}mstrmojo.vi.ui.rw.selectors._IsLevelList=mstrmojo.provide("mstrmojo.vi.ui.rw.selectors._IsLevelList",{scriptClass:"mstrmojo.vi.ui.rw.selectors._IsLevelList",level:V,levels:[],applyEnabled:false,getCheckList:mstrmojo.emptyFn,postCreateChildren:function(){var r=this,t=this.getCheckList();d.override({getItemMarkup:function v(x,w){return this._super(x,w).replace('<span class="icon"></span>','<span class="iconRA-checkbox"></span>');},filterItems:function p(){this._super();e.call(this);},updateRenderableItems:function l(){this._super();if(Q.call(this)&&this.renderIndex===0){this.renderableItems.unshift({n:"("+mstrmojo.desc(2461,"All")+")",v:L,_renderIdx:c,cls:"noOnly"});}},getFilteredItem:function m(w){var x=this._super(w),z=this.level;if(x){if(z!==V&&x.v===a){return null;}if(z===P&&!this.selectedIndices[w]){return null;}if(K(z)&&z!==x.lv){return null;}return x;}return null;},postBuildRendering:function k(){this._super();W.call(this);},onchange:function n(w){this._super(w);if(this.hasRendered){if(this.level===P){R.call(this);}else{e.call(this);}}},onclick:function u(x){var AD=x.getTarget(),AC=this.getItemNodeFromTarget(AD),w=AC&&parseInt(AC.getAttribute("idx"),10),AB=this.getItemFromTarget(AD);if(AB){this._super(x);r.set("applyEnabled",true);}else{if(w===c){var AE=this.level,AA=X.copy(this.selectedIndices),z=this.isLevelSelected=!this.isLevelSelected;this.items.forEach(function(AG,AF){if(AG.lv===AE){if(z){AA[AF]=true;}else{delete AA[AF];}}});delete AA[this.allIdx];this.set("selectedIndices",AA);r.set("applyEnabled",true);}}},shouldShowTooltip:function q(w,AB){var AA=w.target||$DOM.eventTarget(w.hWin,w.e);if(AA.classList.contains("text")){var AC=AA.parentNode,z=AC.getElementsByClassName("iconRA-checkbox")[0],x=AC.getElementsByClassName("only")[0];return AA.offsetWidth+(x?x.offsetWidth:0)+z.offsetWidth>AC.offsetWidth;}return this._super(w,AB);},updateTooltipConfig:function o(z){var AE=mstrmojo.dom,x=mstrmojo.tooltip;var AD=z.target||AE.eventTarget(z.hWin,z.e),w=AE.position(AD.parentNode),AB=6;arrowType="vi-tooltip-C",posType=x.POS_TOPLEFT;var AC=w.w+AB,AA=AE.windowDim().w;if(AA<(w.x+AC+300)){arrowType="vi-tooltip-D";AC=-25;posType=x.POS_TOPRIGHT;}this.richTooltip={content:this.getTooltipContent(z),top:-10,cssClass:"vi-regular "+arrowType,left:AC,refNode:AD,posType:posType};}},t);t.markupMethods=X.copy({onlevelChange:function(){var w=this.level===P?"add":"remove";g[w+"Class"](this.domNode,"showSelected");S.call(this);R.call(this);}},X.copy(mstrmojo.ui.CheckList.prototype.markupMethods));},onlevelChange:function b(k){Z.call(this);},preBuildRendering:function C(){X.copyProps(F,this,this.getCheckList());j.call(this);this._super();},select:function Y(l){var k=U.hash(l);this.getCheckList().select(X.keyarray(M.call(this,k),true));this.selectedIndices=N.call(this);this.set("applyEnabled",false);},getLevels:function I(l){var k=this.getlevelNames(),m=[{n:mstrmojo.desc(14672,"Selected Items"),v:P},{n:mstrmojo.desc(2461,"All"),v:V}];U.forEach(l,function(o,p){if(o){var n=k[p]||mstrmojo.desc(493,"Level")+" "+(p+1);m.push({n:n,v:p});}});return m;},handleSelectionSubmit:function G(k){var l=this.getCheckList();if(k){this.selectedIndices=N.call(this);this.onchange();}else{l.set("selectedIndices",M.call(this));}this.set("applyEnabled",false);}});}());(function(){mstrmojo.requiresCls("mstrmojo.css");var F=mstrmojo.css,E="px",J="hasOwnAvatar",I={x:0,y:0};function B(L){var K=this.createAvatar(L.src.node,L);if(K){F.addClass(K,[this.avatarCssClass,J]);this.avatar=L.avatar=document.body.appendChild(K);}}function C(){var K=this.avatar;if(K){K.parentNode.removeChild(K);delete this.avatar;F.removeClass(K,[this.avatarCssClass,J]);}}mstrmojo._HasOwnAvatar=mstrmojo.provide("mstrmojo._HasOwnAvatar",{_mixinName:"mstrmojo._HasOwnAvatar",draggable:true,ownAvatar:true,avatarCssClass:"",restrictedToAxis:undefined,isDragValid:function H(K){if(this._super){return this._super(K);}return false;},ondragstart:function D(K){B.call(this,K);this.positionAvatar(K.src.pos,K);if(this._super){this._super(K);}},ondragmove:function A(K){this.positionAvatar(K.tgt.pos,K);if(this._super){this._super(K);}},ondragend:function A(K){C.call(this);if(this._super){this._super(K);}},createAvatar:mstrmojo.emptyFn,positionAvatar:function G(O,L){if(this.avatar){var N=this.avatar.style,M=this.restrictedToAxis,K=(L&&L.dragOffsets)||I;if(M!=="y"){N.left=O.x+K.x+E;}if(M!=="x"){N.top=O.y+K.y+E;}}}});}());(function(){mstrmojo.requiresCls("mstrmojo.css","mstrmojo.dom","mstrmojo.fx");var e=mstrmojo.css,J=mstrmojo.dom,R=mstrmojo.array,N={v:{styleDim:"height",styleDir:"top",dimension:"h",position:"y",scroll:"scrollTop",scrollDimension:"scrollHeight",cls:"vertical",hostCls:"hasVertical",scrollNodeCls:"hasVertical"},h:{styleDim:"width",styleDir:"left",dimension:"w",position:"x",scroll:"scrollLeft",scrollDimension:"scrollWidth",cls:"horizontal",hostCls:"hasHorizontal",scrollNodeCls:"hasHorizontal"}},c="scrollingMode",V="scrolling",h=3;var O=J.getOSInfo().name.toLowerCase().indexOf("mac")>=0;function M(){return(this.scrollbarHostNode||(this.scrollNode&&this.scrollNode.parentNode));}function W(n,k){var m=this.scrollNode,j=M.call(this),l={v:n,h:k};R.forEach(["v","h"],function(p){var o=N[p];e.toggleClass(j,o.hostCls,l[p]);e.toggleClass(m,o.scrollNodeCls,l[p]);});}function S(k,j){var p=J.eventTarget(j,k),n=this.scrollNode,m=J.position(n),o=this.scrollTrackNodes,l=this.scrollBarNodes,q=function q(AA){var x=p===o[AA];if(x){var AB=N[AA],r=l[AA],AC=J.position(r),u=J.getMousePosition(k,j)[AB.position],v=u-AC[AB.position],t=v>0?1:-1,z=n[AB.scrollDimension],AD=Math.abs(v-(AC.h/2))*(z/m[AB.dimension]),w={};w[AB.scroll]={isStyle:false,start:n[AB.scroll],stop:n[AB.scroll]+(t*Math.min(z/3,500,AD)),ease:mstrmojo.ease.linear};(new mstrmojo.fx.AnimateProp({props:w,duration:200,interval:10,target:n})).play();}};q.call(this,"h");q.call(this,"v");}function C(k,j){var n=this.scrollNode,m=k.type==="mousewheel",l=m?-1:1;mstrmojo.array.forEach(["h","v"],function(v){var t=N[v],p=m?"wheelDelta":"delta",r=k[p+{h:"X",v:"Y"}[v]]*l,q=Math.abs(r),o=r/q,u=q===3&&J.isFF&&!O;n[t.scroll]+=u?o*40:r;});J.stopPropogation(j,k);J.preventDefault(j,k);}function g(o){var n=N[o],m=this.scrollNode,l=J.position(m),k=l[n.dimension],p=m[n.scrollDimension],j=Math.ceil(k)/p;return A(j,k,p);}function A(k,j,l){return(!isNaN(k)&&k<1)&&(Math.abs(j-l)>h);}function D(AJ){var AC="px",u=N[AJ],n=this.scrollNode,v=M.call(this),AL=J.position(n),w=AL[u.dimension],AE=n[u.scrollDimension],m=Math.ceil(w)/AE,AI=this.scrollBarNodes,r=AI[AJ],AA=this.scrollTrackNodes,AB=AA[AJ],AG=A(m,w,AE),o=u.cls;if(!r){AB=AA[AJ]=document.createElement("div");var p=this,z=function(AN){S.call(p,AN);},t=function(AN){C.call(p,AN);},AF=function(AP,AN,AO){J.attachEvent(AP,AN,AO);p.installedEventListeners.push({e:AP,evt:AN,fn:AO});};AF(AB,"click",z);AB.className="mstrmojo-scrolltrack "+o;r=AI[AJ]=document.createElement("div");r.className="mstrmojo-scrollbar "+o;AB.appendChild(r);v.appendChild(AB);var AH=mstrApp.isSingleTier?"mousewheel":"wheel";AF(AB,AH,t);AF(r,AH,t);}var AM=r.style,q=(n[u.scroll]/n[u.scrollDimension]),k=J.delta(n,M.call(this))[u.position],AD=AB.style;if(AG){AD[u.styleDir]=k+AC;var l=m*w,x=35,AK=w*q,j=w-35;AM[u.styleDim]=(l<x?x:l)+AC;AM[u.styleDir]=(AK>j?j:AK)+AC;}return AG;}function I(){return !(mstrApp.isSingleTier&&O);}mstrmojo.ui._HasScroller=mstrmojo.provide("mstrmojo.ui._HasScroller",{_mixinName:"mstrmojo.ui._HasScroller",hasCustomScrollbar:null,draggable:true,ownAvatar:true,scrollNode:undefined,scrollbarHostNode:undefined,scrollBarNodes:undefined,setupScrollNodes:mstrmojo.emptyFn,installedEventListeners:null,init:function Y(j){this._super(j);if(this.hasCustomScrollbar===null){this.hasCustomScrollbar=I();}this.installedEventListeners=[];},onRender:function L(){if(this._super){this._super();}this.updateScrollbars();this.addScrollNodeProperties();},addScrollNodeProperties:function G(){var k=this.scrollNode,l=J.isFF&&!O;if(k){var j=J.attachMarkupEvent(this.id,k,"scroll");this.installedEventListeners.push({e:k,evt:"scroll",fn:j});}if(l){e.addClass(k,"firefox-on-windows");}else{if(J.isEdge){e.addClass(k,"ms-edge");}}if(!this.hasCustomScrollbar){e.addClass(M.call(this),"mstrmojo-sb-host-show-default");e.addClass(k,"mstrmojo-sb-show-default");return ;}if(k){e.addClass(M.call(this),"mstrmojo-scrollbar-host");e.addClass(k,"mstrmojo-scrollNode");}},updateScrollbars:function f(){if(!this.hasRendered){return ;}this.setupScrollNodes();var j,l=false;if(!this.hasCustomScrollbar){if(this.scrollNode){j=this.scrollNode.style;j.overflowY=g.call(this,"v")?"scroll":"hidden";j.overflowX=g.call(this,"h")?"scroll":"hidden";}return ;}if(this.scrollNode){this.scrollBarNodes=this.scrollBarNodes||{};this.scrollTrackNodes=this.scrollTrackNodes||{};W.call(this,l,l);j=this.scrollNode.style;var m=D.call(this,"v"),k=D.call(this,"h");j.overflowY=m?"scroll":"hidden";j.overflowX=k?"scroll":"hidden";W.call(this,m,k);}},onscroll:function b(){var q=this.scrollNode;if(q&&this.hasCustomScrollbar){var n=function n(r){var t=parseInt(r);return t===null||isNaN(t)?0:t;},o=J.position(q),p=o.h-n(e.getStyleValue(q,"padding-bottom")),k=o.w-n(e.getStyleValue(q,"padding-right")),m=this.scrollBarNodes,l=m.v,j=m.h;if(q.scrollHeight-p>0){l.style.top=((p-J.position(l).h)*(q.scrollTop/(q.scrollHeight-p)))+"px";}if(q.scrollWidth-k>0){j.style.left=((k-J.position(j).w)*(q.scrollLeft/(q.scrollWidth-k)))+"px";}}if(this._super){this._super();}if(this.onScrollEnd){this.onScrollEnd();}},getDragData:function F(k){var n=this.scrollNode,m=J.position(n),l=k.src.node,j=this.scrollBarNodes;if(this.isDraggingScrollBar(k)){return{isScrollBar:true,direction:l===j.v?"v":"h",scrollTop:n.scrollTop,scrollLeft:n.scrollLeft,conversionRatio:{y:n.scrollHeight/m.h,x:n.scrollWidth/m.w}};}return(this._super&&this._super(k));},isDragValid:function E(j){return this.isDraggingScrollBar(j)||(this._super&&this._super(j))||false;},isDraggingScrollBar:function X(k){var l=k.src.node,j=this.scrollBarNodes;return !!j&&(l===j.v||l===j.h);},ondragstart:function d(j){if(this.isDraggingScrollBar(j)){e.addClass(j.src.node,V);e.addClass(M.call(this),c);}if(this._super){this._super(j);}},shouldDragBubble:function U(j){var k=j.src.node,l=this.scrollTrackNodes;return !(!!l&&(k===l.v||k===l.h));},ondragmove:function Q(k){if(this.isDraggingScrollBar(k)){var t=k.tgt,j=k.src,u=t.pos,l=j.pos,p=j.node,o=this.scrollNode,r=this.scrollBarNodes,q=j.data,n={y:(u.y-l.y),x:(u.x-l.x)},m=q.conversionRatio;if(p===r.v){o.scrollTop=q.scrollTop+(n.y*m.y);}else{o.scrollLeft=q.scrollLeft+(n.x*m.x);}}if(this._super){this._super(k);}},ondragend:function K(j){if(this.isDraggingScrollBar&&this.isDraggingScrollBar(j)){e.toggleClass(j.src.node,V,false);e.toggleClass(M.call(this),c,false);}if(this._super){this._super(j);}},widgetResized:function P(){if(this._super){this._super();}this.updateScrollbars();},unrender:function Z(j){R.forEach(this.installedEventListeners,function(k){J.detachEvent(k.e,k.evt,k.fn);});this.installedEventListeners=[];delete this.scrollNode;delete this.scrollbarHostNode;delete this.scrollBarNodes;delete this.scrollTrackNodes;this._super(j);},getDefaultScrollBarProps:function a(j){return N[j];},disableScroll:function B(j,m){var l=this.scrollNode,k=M.call(this);R.forEach(["v","h"],function(o){var n=N[o];e.toggleClass(k,n.hostCls,false);e.toggleClass(l,n.scrollNodeCls,false);});if(l){if(m||m===undefined){l.style.overflowY="hidden";}else{if(l.style.overflowY==="hidden"){l.style.overflowY="auto";}}if(j||j===undefined){l.style.overflowX="hidden";}}},enableScroll:function H(){this.updateScrollbars();if(!this.hasCustomScrollbar&&this.scrollNode){this.scrollNode.style.overflowY=g.call(this,"v")?"scroll":"hidden";}},scrollIntoViewIfNeeded:function(m){var r=this.scrollNode,o=m.clientHeight,n=r.clientHeight,k=J.position(m).y,p=J.position(r).y,l=k-p,j=l<0,q=l+o>n;if(j||q){r.scrollTop+=l+o/2-n/2;}}});}());(function(){mstrmojo.requiresCls("mstrmojo.dom","mstrmojo.css");var J={T:["top","left"],D:["height","width"],B:["border","border-color","border-style","border-width"],F:["font","color","text-decoration"],P:["padding"],BG:["background-color","fx"],RW:[]};J.RW=["z-index"].concat(J.T.concat(J.D));var D=mstrmojo.dom,O=mstrmojo.css;function N(U,W,S){var V=U[W]||[];V.push(S);U[W]=V;}function L(X,W){var V=((X&&X.fmts)||null);if(W){var Z=X.thresholds,U=Z&&Z[W];if(U){var Y={},a;for(a in V){Y[a]=U[a]||V[a];}for(a in U){var S=U[a];Y[a]=(typeof S==="string")?(S+" !important"):S;}V=Y;}}return V;}mstrmojo._Formattable=mstrmojo.provide("mstrmojo._Formattable",{_mixinName:"mstrmojo._Formattable",formatHandlers:null,thresholdId:null,getCacheKey:function E(){return"css_cache"+(this.thresholdId||"");},update:function G(U){var S=true;this.invisible=!!(U&&U.data&&U.data.invisible);if(this._super){S=this._super(U);}return S;},buildCSSFormatString:function H(V,e){var j=this.formatHandlers[V],l=j.src?e[j.src]:e;if(!l){return null;}var c=j.props||j;if(!c){return null;}var Y=[],h=-1;var W=c.length-1;for(W;W>=0;W--){var k=c[W];var d=J[k]||[k];var b=d.length-1;for(b;b>=0;b--){k=d[b];var U=l[k];if(U!==undefined){if(k==="fx"){var Z=U,S={};var g=Z.gd;if(g){this.formatGradient(g,S);}var X=parseInt(Z.rt,10);if(X){if(X===1||X===3){this.formatTextRotation(Z.rt,S);}}if(Z.ds){this.formatDropShadow(Z,S);}var a;for(a in S){Y[++h]=a+":"+S[a].join(" ");}}else{Y[++h]=k+":"+U;}}}}if(this.invisible){Y.push("visibility:hidden");}return Y.join(";")+";";},applyCSSFormatToNode:function I(V,S){var W=this[V],U=W&&W.style;if(U){this.buildCSSFormatString(V,S).split(";").forEach(function(X){var Y=X.split(":");U[O.convertCssToCamelCase(Y[0])]=Y[1];});}},clearSlotBackgroundCSS:function F(U){var V=this[U],S=V&&V.style;if(S){S.background="transparent none 0 0 no-repeat";S.filter="none";}},preBuildRendering:function B(){this._super();var W=this.formatHandlers,S=this.getFormats();if(W&&S){var X=this.defn=this.defn||{},Y=this.getCacheKey(),V=X[Y];if(!V){V=X[Y]={};for(var U in W){var a=U+"CssText";this[a]=V[a]=this.buildCSSFormatString(U,S)||"";}}else{var Z;for(Z in V){this[Z]=V[Z];}}}return true;},formatGradient:function P(S,V){var U=O.buildGradient(S.t,S.sc,S.ec);if(U){N(V,U.n,U.v);}},formatDropShadow:function K(X,V){if(D.supports(D.cssFeatures.DROP_SHADOW)){var W=X.ds;if(D.isDXIE){N(V,"filter","progid:DXImageTransform.Microsoft.DropShadow(Color='#66000000',Positive='true',OffX="+W+",OffY="+W+")");}else{var S=[W,W],U=parseInt(X.rt,10);if(U===1||U===3){S[((U===1)?1:0)]=-W;}N(V,(D.isWK?"-webkit-":"")+"box-shadow",S.join("px ")+"px 3px 0px #888");}}},formatTextRotation:function C(U,S){if(D.supports(D.cssFeatures.TEXT_ROTATION)){if(D.isDXIE){N(S,"filter","progid:DXImageTransform.Microsoft.BasicImage(rotation="+U+")");}else{var V=(U===1)?90:-90;N(S,D.CSS3_PREFIX+"transform-origin","top left");N(S,D.CSS3_PREFIX+"transform","rotate("+V+"deg)");}}},getFormats:function R(){if(!this.fmts){this.fmts=L.call(this,this.defn,this.thresholdId);}return this.fmts;},clearFormats:function A(){this.fmts=undefined;},createEmptyFormats:function(){return(this.fmts=this.fmts||{});},clearCache:function Q(){delete this.defn[this.getCacheKey()];},unrender:function M(S){if(this.thresholdId){this.fmts=null;}this._super(S);}});mstrmojo._Formattable.getBorderWidths=function(X){var W=X.getFormats(),S=(W.border)?W.border.match(/(\d*|\d*\.\d*)pt/)[0]:W["border-width"],V=X.model,U=V.docModel;return O.getBorderWidths(S,(U&&U.dpi)||V.dpi);};}());(function(){mstrmojo.requiresCls("mstrmojo.dom","mstrmojo.string","mstrmojo.css");var K=mstrmojo.css,N=mstrmojo.string,H=mstrmojo.dom,L=13,C=27;function I(U){if(this._editComplete){return ;}var Y,R=false,X=this.text,V=false;if(U===C){Y=X;V=true;R=true;}if((!U&&U!==0)||(!this.allowNewLine&&U===L)){var S=this[this.editableSlot],W=S.innerText||S.textContent||"";if(!this.allowNewLine){Y=W.replace(/\n/g,"");}else{Y=W;}R=true;if(!this.allowEmptyText&&Y.length===0){Y=X;V=true;}}if(R){this._editComplete=true;Y=Y.replace(/\u00A0/g,"\u0020");this.text=Y;this.set("isEditing",false);this.onTextEditComplete(Y!==X,X);delete this._editComplete;}if(V){this.refresh();}}function E(R){var S={dblclick:"editOnDoubleClick",click:"editOnClick"};if(this[S[R.name]]||(R.name==="click"&&this.editOnTwoClicks)&&R.getTarget()===this[this.editableSlot]){this.set("isEditing",true);}}function F(U,S,R){if(typeof S["on"+R]!=="function"){H.attachMarkupEvent(U,S,R);}}mstrmojo._HasEditableText=mstrmojo.provide("mstrmojo._HasEditableText",{_mixinName:"mstrmojo._HasEditableText",editableSlot:"domNode",editButtonSlot:null,isEditing:false,editOnClick:true,editOnTwoClicks:false,firstClickTime:undefined,allowEmptyText:false,allowTrimming:true,allowNewLine:false,editOnDoubleClick:false,onTextEditBegin:mstrmojo.emptyFn,onTextEditComplete:mstrmojo.emptyFn,postBuildRendering:function A(){this._super();var U=this.editableSlot,R=this[U],V=this[this.editButtonSlot||U];K.addClass(R,"hasEditableText");this.text=this.text||R.innerText||R.textContent||"";R.innerHTML=this.getEditableTextInnerHTML();var S=this.id;if(this.editOnClick||this.editOnTwoClicks){F(S,V,"click");}F(S,V,"dblclick");F(S,R,"blur");F(S,R,"keyup");F(S,R,"keydown");},getEditableTextInnerHTML:function Q(){return N.encodeHtmlString(this.text,true).replace(/ (?= )/g,"&nbsp;");},onclick:function P(R){if(this.editOnClick){E.call(this,R);}if(this._super){this._super(R);}},onTwoClicks:function(R){if(this.editOnTwoClicks){E.call(this,R);}if(this._super){this._super(R);}},ondblclick:function G(R){E.call(this,R);},onblur:function M(){I.call(this);},onkeyup:function B(S){var R=window.event||S.e;I.call(this,R.keyCode);},onkeydown:function J(S){var R=window.event||S.e;if(R.keyCode===L){I.call(this,R.keyCode);S.cancel();}},_set_text:function D(U,R){var S=this.text;this.text=R;if(this.hasRendered){this[this.editableSlot].innerHTML=N.encodeHtmlString(R||"",true);}return(S!==R);},onisEditingChange:function O(){if(this.hasRendered){var R=this[this.editableSlot],S=!!this.isEditing;R.contentEditable=S;R.spellcheck=false;K.toggleClass(R,"editable",S);if(S){R.focus();H.setElementSelection(R);this.onTextEditBegin();}else{R.blur();R.scrollLeft=0;}}}});}());(function(){mstrmojo.requiresCls("mstrmojo.css","mstrmojo.num","mstrmojo.color","mstrmojo.hash","mstrmojo.array");var AL=mstrmojo.color,a=mstrmojo.hash,BX=mstrmojo.array,BS=mstrmojo.css,m=mstrmojo.num;var BV=1,Ax=2,Az=3,BE=4,Af=5,Ag=6;var Bf="FormattingFont",L="FormattingAppearance",c="FormattingAlignment",Am="FormattingSize",V="FormattingPatterns",I="FormattingBorder",BD="FormattingOrder",H="FormattingView",S="FormattingSelector",A1="Template Formatting",P="FormattingPadding",Av="AnalyticalEngineProperties",A5="RWDocumentProperties",BN="FormattingPage",R="Mobile",Y="VLDB Select",AF="FormattingNumber",Aa="RWDExecution";var Au=1;var p="n",Q="h",BY="w",AJ="wm",BK="pw",b="ml",BL="mr",AB="upwalw",x="ff",Ap="fsz",BQ="fw",AK="fit",BR="fun",v="fst",AA="fc",Z="alh",z="alv",Aj="atw",AR="atd",h="textOverflow",At="bc",E="bgs",K="btc",As="brc",Ac="bbc",w="blc",r="bts",Ba="brs",BF="bbs",Ai="bls",AX="borderColor",BB="borderStyle",k="zIndex",AZ="showTitleBar",q="title",A9="ctrlStyle",AD="ctrlOrientation",A8="ctrlOrientationBehavior",o="ctrlMultiselect",l="ctrlAutoSearchEnabled",C="ciwm",BM="cmcy",BA="sec",u="easow",AQ="layoutXml",M="lockAspectRatio",Ar="ism",n="shw",BC="mg",BZ="lhv",e="gridVPadding",Ao="gridHPadding",An="ln",AP="sar",B="hnv",Al="iw",Ah="ih",AT="tsp",Ad="visible",W="rf",Be="jad",Aw="jdc",AM="ode",BG="fs",BJ="ssc",j="sstyle",AI="hgl",Ay="nct",A7="ncp",f="ncs",BO="ndp",G="nfs",D="nnn",BU="nth",Bd="gi",A3="stfurh",d="stfuch",Bb="stfuva",N="olm",BP="gdc",Bc="gda",AY="layoutstyle";function U(Bg){return Bg;}function AV(Bg){return parseInt(Bg,10);}var AH={name:"encode",_def:U};AH[Az]=function(Bg){return Bg?1:0;};AH[Ax]=function(Bg){if(Bg==="transparent"){return -1;}if(Bg.length===4){Bg=Bg.replace(/([0-9a-f])/ig,"$1$1");}Bg=AL.rgbStr2hex(Bg);return parseInt(Bg.substring(5)+Bg.substring(3,5)+Bg.substring(1,3),16);};AH[BE]=AV;AH[BV]=function(Bg){if(typeof Bg==="number"){return m.toLocaleString(Bg);}return U(Bg);};AH[Ag]=function(Bi){if(Bi==="none"){return 0;}var Bh=Bi.match(/([0-9]+[,\.]?[0-9]*pt)/)[0],Bg=Bi.match(/pt ([\w\W]*)/)[1];if(Bh==="2pt"){return 5;}switch(Bg){case"solid":return 1;case"dashed":return 3;case"dotted":return 4;default:throw new Error("Invalid border style value in FormatModel::encodeValue.");}};var BW={name:"decode",_def:U};BW[Az]=function(Bg){return parseInt(Bg,10)===1;};BW[Ax]=function(Bg){if(Bg===-1){return"transparent";}if(typeof Bg==="number"){return AL.decodeColor(Bg);}if(Bg.length===4){return Bg.replace(/([0-9a-f])/ig,"$1$1");}return AL.rgbStr2hex(Bg);};BW[BE]=AV;BW[Ag]=function(Bi){if(Bi===undefined||Bi===0){return"none";}var Bh="1pt",Bg="solid";if(Bi===5){Bh="2pt";}if(Bi===3){Bg="dashed";}else{if(Bi===4){Bg="dotted";}}return Bh+" "+Bg;};function BH(){return this.pn.toLowerCase();}function AS(Bg,Bi,Bj){var Bh=document.createElement("div");Bh.style[Bj||Bi]=Bg[Bi];return Bh;}function J(Bg){return function(){return AL.rgbStr2hex(Bg.apply(this,arguments));};}function Aq(){var Bg=BH.call(this);return Bg==="underline"?Bg:"line-through";}var A4={name:"extract"},X=A4._def=function(Bg,Bi,Bj){var Bh=AS(Bg,Bi||this.getFormatBlockName(),Bj);return Bh.style[this.getCssName()];};A4[Ax]=J(X);function AC(Bg){return X.call(this,Bg,this.getFormatBlockName())===BH.call(this);}function A(Bg){var Bh=X.call(this,Bg,this.getFormatBlockName(),this.getCssName());return Bh.indexOf(Aq.call(this))>-1;}function A2(Bg){var Bh=this.getFormatBlockName();return AL.rgbStr2hex(X.call(this,Bg,Bh,Bh+this.pn));}var BT={name:"resolve"},g=BT._def=function(Bg,Bj,Bi,Bk){Bi=Bi||this.getFormatBlockName();var Bh=AS(Bg,Bi);Bh.style[Bk||this.getCssName()]=Bj;return Bh.style[BS.convertCssToCamelCase(Bi)];};BT[Ax]=function(Bg,Bi,Bh,Bj){if(Bi.or!==undefined){return Bi;}return AL.rgbStr2hex(g.call(this,Bg,Bi,Bh,Bj));};function Ab(Bg,Bh){return g.call(this,Bg,Bh?BH.call(this):"normal");}function AW(Bh,Bj){var Bi=(Bh[this.getFormatBlockName()]||"").split(" "),Bg=Aq.call(this);if(Bj){if(Bi.indexOf(Bg)===-1){Bi.push(Bg);}}else{Bi=Bi.filter(function(Bk){return Bk!==Bg;});}return g.call(this,Bh,Bi.join(" "));}var Ak={name:"update"},BI=Ak._def=function(Bg,Bh){Bg[this.getFormatBlockName()]=this.resolve(Bg,Bh);return Bg;};var AU={};AU[p]={ps:L,pn:"Name",pt:BV};AU[Q]={ps:Am,pn:"Height",pt:BV};AU[BY]={ps:Am,pn:"Width",pt:BV};AU[AJ]={ps:Am,pn:"WidthMode",pt:BE};AU[BK]={ps:BN,pn:"PageWidth",pt:BV};AU[b]={ps:BN,pn:"MarginLeft",pt:BV,fn:"margin-left"};AU[BL]={ps:BN,pn:"MarginRight",pt:BV,fn:"margin-right"};AU[AB]={ps:BN,pn:"UsePageWidthAsLayoutWidth",pt:Az};AU[x]={ps:Bf,pn:"Name",pt:BV,fn:"font",cn:"fontFamily",extract:function(){return X.apply(this,arguments).replace(/['"]/g,"");},resolve:function(Bg,Bi){var Bh=AS(Bg,"font");Bh.style.fontFamily="'"+Bi+"'";return Bh.style.font;}};AU[Ap]={ps:Bf,pn:"Size",pt:BE,fn:"font",cn:"fontSize"};AU[BQ]={ps:Bf,pn:"Bold",pt:Az,fn:"font",cn:"fontWeight",extract:AC,resolve:Ab};AU[AK]={ps:Bf,pn:"Italic",pt:Az,fn:"font",cn:"fontStyle",extract:AC,resolve:Ab};AU[BR]={ps:Bf,pn:"Underline",pt:Az,fn:"text-decoration",extract:A,resolve:AW};AU[v]={ps:Bf,pn:"Strikeout",pt:Az,fn:"text-decoration",extract:A,resolve:AW};AU[AA]={ps:Bf,pn:"Color",pt:Ax};AU[Z]={ps:c,pn:"Horizontal",pt:BE,fn:"text-align"};AU[Aj]={ps:c,pn:"TextWrap",pt:Az,fn:"white-space"};AU[AR]={ps:c,pn:"TextDirection",pt:BE};AU[z]={ps:c,pn:"Vertical",pt:BE};AU[h]={ps:Am,pn:"TextOverflow",pt:Az};AU[At]={ps:V,pn:"FillColor",pt:Ax,x:Au,fn:"background-color",update:function(Bg,Bi){var Bh=Bg.fx;if(Bi.or!==undefined){if(!Bh){Bh=Bg.fx={};}var Bj=Bh.gd=Bh.gd||{};Bj.ec=Bi.c2;Bj.sc=Bi.c1;Bj.t=Bi.or;delete Bg[this.getFormatBlockName()];Bg.fx=Bh;}else{if(Bh){delete Bh.gd;}BI.call(this,Bg,Bi);}return Bg;}};AU[E]={ps:V,pn:"FillStyle",pt:BE};AU[BJ]={ps:V,pn:"SelectorSelectionColor",pt:Ax};AU[j]={ps:V,pn:"SelectorSelectionFillStyle",pt:BE};AU[K]={ps:I,pn:"TopColor",pt:Ax,fn:"border",extract:A2};AU[As]={ps:I,pn:"RightColor",pt:Ax,fn:"border",extract:A2};AU[Ac]={ps:I,pn:"BottomColor",pt:Ax,fn:"border",extract:A2};AU[w]={ps:I,pn:"LeftColor",pt:Ax,fn:"border",extract:A2};AU[AX]={ps:I,pn:["TopColor","RightColor","BottomColor","LeftColor"],pt:Ax,fn:"border",extract:A2,resolve:J(function(Bg,Bi){var Bj=this.getFormatBlockName(),Bh=g.call(this,Bg,Bi,Bj,Bj+"Color"),Bk=Bh.indexOf("rgb");if(Bk>-1){Bh=Bh.slice(0,Bk)+AL.rgbStr2hex(Bh.slice(Bk));}return Bh;})};AU[BB]={ps:I,pn:["TopStyle","RightStyle","BottomStyle","LeftStyle"],pt:Ag,fn:"border",extract:A2,resolve:function(Bg,Bj){var Bh=Bj.split(" "),Bk=this.getFormatBlockName();if(!Bg[Bk]){Bg[Bk]="transparent";}Bg[Bk]=g.call(this,Bg,Bh[0],Bk,Bk+"Width");var Bi=g.call(this,Bg,Bh[1]||"none",Bk,Bk+"Style"),Bl=Bi.indexOf("rgb");if(Bl>-1){Bi=Bi.slice(0,Bl)+AL.rgbStr2hex(Bi.slice(Bl));}return Bi;}};AU[r]={ps:I,pn:"TopStyle",pt:Ag,fn:"border",extract:A2};AU[Ba]={ps:I,pn:"RightStyle",pt:Ag,fn:"border"};AU[BF]={ps:I,pn:"BottomStyle",pt:Ag,fn:"border",extract:A2};AU[Ai]={ps:I,pn:"LeftStyle",pt:Ag,fn:"border",extract:A2};AU[k]={ps:BD,pn:"ZIndex",pt:BE,fn:"z-index"};AU[AZ]={ps:H,pn:"ShowTitleBar",pt:Az};AU[q]={ps:H,pn:"Title",pt:BV};AU[A9]={ps:S,pn:"Style",pt:BE};AU[AD]={ps:S,pn:"Orientation",pt:BE};AU[A8]={ps:S,pn:"OrientationBehavior",pt:BE};AU[o]={ps:S,pn:"Multiselect",pt:Az};AU[l]={ps:S,pn:"AutoSearchEnabled",pt:Az};AU[C]={ps:S,pn:"ItemWidthMode",pt:BE};AU[BM]={ps:S,pn:"MetricConditionType",pt:BE};AU[BA]={ps:S,pn:"ShowElementCount",pt:BE};AU[u]={ps:S,pn:"ExportAsShownOnWeb",pt:BE};AU[AQ]={ps:Am,pn:"LayoutXML",pt:Af};AU[M]={ps:Am,pn:"LockAspectRatio",pt:Az};AU[Ar]={ps:Am,pn:"ImageSizeMode",pt:BE};AU[Ah]={ps:Am,pn:"ImageHeight",pt:BV};AU[Al]={ps:Am,pn:"ImageWidth",pt:BV};AU[AT]={ps:A5,pn:"layoutBarPosition",pt:BV};AU[BG]={ps:A5,pn:"ExecutionFullScreenMode",pt:Az};AU[AY]={ps:A5,pn:"LayoutStyle",pt:BE};AU[Ad]={ps:L,pn:"Visible",pt:Az};AU[An]={ps:A1,pn:"LongNames",pt:BV};AU[N]={ps:A1,pn:"Indented",pt:BE};AU[AP]={ps:Av,pn:"ShowAllRows",pt:BV};AU[B]={ps:Av,pn:"HideNullZeroValues",pt:BV};AU[Ao]={ps:P,pn:["LeftPadding","RightPadding"],pt:BV};AU[e]={ps:P,pn:["TopPadding","BottomPadding"],pt:BV};AU.rowsshw={ps:A1,pn:"ShowRowHeaders",pt:BV};AU.rowsmg={ps:A1,pn:"MergeCells",pt:BV};AU.rowslhv={ps:A1,pn:"LockRowHeaders",pt:BV};AU.colsshw={ps:A1,pn:"ShowColumnHeaders",pt:BV};AU.colsmg={ps:A1,pn:"MergeColumnCells",pt:BV};AU.colslhv={ps:A1,pn:"LockColumnHeaders",pt:BV};AU[A3]={ps:A1,pn:"SubtotalFormatUseRowHeaders",pt:BV};AU[d]={ps:A1,pn:"SubtotalFormatUseColumnHeaders",pt:BV};AU[Bb]={ps:A1,pn:"SubtotalFormatUseValues",pt:BV};AU[W]={ps:R,pn:"RefreshFrequency",pt:BE};AU[Be]={ps:Y,pn:"Join Across Datasets",pt:BE};AU[Aw]={ps:Y,pn:"MCE Join To Get Data Combination",pt:BE};AU[AM]={ps:Aa,pn:"OnDemandEvaluation",pt:BE};AU[AI]={ps:L,pn:"Highlight",pt:BE};AU[Ay]={ps:AF,pn:"Category",pt:BE};AU[G]={ps:AF,pn:"Format",pt:BV};AU[f]={ps:AF,pn:"CurrencySymbol",pt:BV};AU[BO]={ps:AF,pn:"DecimalPlaces",pt:BE};AU[A7]={ps:AF,pn:"CurrencyPosition",pt:BE};AU[D]={ps:AF,pn:"NegativeNumbers",pt:BE};AU[BU]={ps:AF,pn:"ThousandSeparator",pt:BE};AU[Bd]={ps:L,pn:"GroupInfo",pt:BV};AU[BP]={ps:V,pn:"GradientColor",pt:Ax};AU[Bc]={ps:V,pn:"GradientAngle",pt:BE};BX.forEach(a.keyarray(AU),function(Bg){var Bh=AU[Bg];Bh.getFormatBlockName=function(){var Bj=this.fn;if(!Bj){var Bi=this.pn;Bj=Bi.charAt(0).toLowerCase()+Bi.substr(1);}return Bj;};Bh.getCssName=function(){var Bi=this.getFormatBlockName.call(this),Bj=this.cn;if(!Bj){Bj=BS.convertCssToCamelCase(Bi);}return Bj;};BX.forEach([AH,BW,A4,BT,Ak],function(Bi){var Bj=Bi.name;Bh[Bj]=Bh[Bj]||Bi[Bh.pt]||Bi._def;});});function A6(Bj,Bi,Bg){var Bh=Bg[Bj.ps]=Bg[Bj.ps]||{};Bi=Bj.encode(Bi);BX.forEach([].concat(Bj.pn),function(Bk){Bh[Bk]=Bi;});return Bg;}function AO(Bm,Bl,Bg){var Bk=Bm.x;if(Bk){if((Bk&Au)>0){var Bj=!!Bl.c1,Bi=0;if(Bj){A6(Bm,Bl.c1,Bg);var Bh=Bg[V];Bh.GradientColor=Bm.encode(Bl.c2);Bh.GradientAngle=Bl.or?0:90;Bh.GradientXOffset=0;Bh.GradientYOffset=0;Bi=2;}else{if(Bm.encode(Bl)===-1){Bi=1;}else{A6(Bm,Bl,Bg);}}return A6(AU[E],Bi,Bg);}}return null;}mstrmojo.models.FormatModel={getFormatUpdate:function Ae(Bh,Bk,Bg){var Bj=AU[Bh];if(!Bj){throw new Error("Invalid property "+Bh+" in FormatModel::getFormatUpdate.");}Bg=Bg||{};var Bi=AO.call(this,Bj,Bk,Bg);if(Bi){return Bi;}return A6(Bj,Bk,Bg);},getFormatPropertyInfo:function t(Bg){return AU[Bg];},getValueFromUpdate:function O(Bh,Bi){var Bk=AU[Bh],Bg=null;try{Bg=Bi[Bk.ps][Bk.pn];}catch(Bj){}return Bg;},getGradientValues:function AN(Bh){var Bg=Bh.fx&&Bh.fx.gd;if(Bg){var Bj={c1:Bg.sc,c2:Bg.ec,or:Bg.t};return Bj;}if(Bh[E]===2){if(!!Bh.bc.c1){return Bh.bc;}var Bi={c1:Bh.bc,c2:Bh.gdc,or:Bh.gda===90?0:1};return Bi;}return null;},decodeGradientValue:function F(Bg){if(Bg&&Bg.c1){Bg.c1=this.decodeValue(BP,Bg.c1);Bg.c2=this.decodeValue(BP,Bg.c2);return Bg;}return null;},decodeValue:function AG(Bg,Bh){return AU[Bg].decode(Bh);},updateFormatBlock:function A0(Bg,Bh,Bi){return AU[Bh].update(Bg,Bi);},getFormatBlockValue:function AE(Bg,Bh){return AU[Bh].extract(Bg);},GradientType:null,FormatObjectType:null,PROPERTY_INFO_TYPE:null,ENUM_PROPERTY_NAMES:{NAME:p,HEIGHT:Q,WIDTH:BY,WIDTH_MODE:AJ,PAGE_WIDTH:BK,MARGIN_LEFT:b,MARGIN_RIGHT:BL,USE_PAGE_WIDTH_AS_LAYOUT_WIDTH:AB,FONT_FAMILY:x,FONT_SIZE:Ap,FONT_WEIGHT:BQ,FONT_STYLE:AK,UNDERLINE:BR,LINE_THROUGH:v,COLOR:AA,TEXT_ALIGN:Z,VERTICAL_ALIGN:z,TEXT_WRAP:Aj,TEXT_DIRECTION:AR,TEXT_OVERFLOW:h,BACKGROUND_COLOR:At,FILL_STYLE:E,GRADIENT_COLOR:BP,GRADIENT_ANGLE:Bc,BORDER_TOP_COLOR:K,BORDER_RIGHT_COLOR:As,BORDER_BOTTOM_COLOR:Ac,BORDER_LEFT_COLOR:w,BORDER_TOP_STYLE:r,BORDER_RIGHT_STYLE:Ba,BORDER_BOTTOM_STYLE:BF,BORDER_LEFT_STYLE:Ai,BORDER_COLOR:AX,BORDER_STYLE:BB,Z_INDEX:k,SHOW_TITLE_BAR:AZ,TITLE:q,CONTROL_STYLE:A9,CONTROL_ORIENTATION:AD,CONTROL_ORIENTATION_BEHAVIOR:A8,CONTROL_MULTISELECT:o,CONTROL_AUTOSEARCH:l,CONTROL_ITEM_WIDTH_MODE:C,CONTROL_METRIC_CONDITION_TYPE:BM,CONTROL_SHOW_ELEMENT_COUNT:BA,CONTROL_EXPORT_AS_SHOWN_ON_WEB:u,LAYOUT_XML:AQ,LOCK_ASPECT_RATIO:M,IMAGE_SIZE_MODE:Ar,SHOW_HEADER:n,MERGE_HEADER:BC,LOCK_HEADER:BZ,LONG_NAME:An,SHOW_ALL_ROWS:AP,HIDE_NULL:B,IMAGE_WIDTH:Al,IMAGE_HEIGHT:Ah,VISIBLE:Ad,LAYOUT_TAB_POSITION:AT,GRID_VERTICAL_PADDING:e,GRID_HORIZONTAL_PADDING:Ao,REFRESH:W,JOIN_ACROSS_DATASET:Be,MCE_JOIN_TO_GET_DATA_COMBINATION:Aw,ON_DEMAND_EVALUATION:AM,FULL_SCREEN_MODE:BG,SELECTOR_SELECTION_COLOR:BJ,SELECTOR_SELECTION_FILL_STYLE:j,VIZ_HIGHLIGHTING:AI,GROUP_INFO:Bd,SUBTOTAL_FORMAT_USE_ROWHEADERS:A3,SUBTOTAL_FORMAT_USE_COLUMNHEADERS:d,SUBTOTAL_FORMAT_USE_VALUES:Bb,OUTLINE:N,LAYOUT_STYLE:AY},ENUM_PROPERTY_SETS:{FORMATTING_NUMBER:AF},ENUM_NUMBER_FORMAT_KEYS_OBJ:{CATEGORY:Ay,CURRENCY_POSITION:A7,CURRENCY_SYMBOL:f,DECIMAL_PLACES:BO,FORMAT:G,NEGATIVE_NUMBERS:D,THOUSAND_SEPARATOR:BU}};}());(function(){mstrmojo.requiresCls("mstrmojo._HasPopup","mstrmojo.hash","mstrmojo.css");var F=mstrmojo.hash,C=mstrmojo.css;var D="open";function E(G){return G?G.popupConfig.hostElement:null;}mstrmojo.ui.menus._HasMenuPopup=mstrmojo.provide("mstrmojo.ui.menus._HasMenuPopup",F.copy(mstrmojo._HasPopup));mstrmojo.ui.menus._HasMenuPopup.openPopup=function A(I,G){var H=this._lastOpened;if(H){this.closePopup();}mstrmojo._HasPopup.openPopup.call(this,I,G);C.addClass(E(I),D);};mstrmojo.ui.menus._HasMenuPopup.closePopup=function B(){C.removeClass(E(this._lastOpened),D);mstrmojo._HasPopup.closePopup.call(this);};}());(function(){mstrmojo.requiresCls("mstrmojo.array","mstrmojo.dom","mstrmojo.css");var U=mstrmojo.css,E=mstrmojo.dom,J=mstrmojo.array,K=[],F=null,L=function(X){return(X&&X.rw&&X.rw.row&&X.rw.row.tc)||0;},B=function(Y,X){if(X){if(Y===1){return mstrmojo.desc(11944,"1 of 1 Row selected");}return mstrmojo.desc(11945,"# of ## Rows selected").replace("##",Y).replace("#",X);}return Y===1?mstrmojo.desc(11946,"1 Row"):mstrmojo.desc(11947,"## Rows").replace("##",Y);},I=function(){var c="",Z,a,d=K[0]&&K[0].parentNode.firstChild,X=this.hiddenField,b=K.length,Y=L(this.gridData);for(Z=0;d&&Z<d.childNodes.length;Z++){a=d.childNodes[Z].innerText||d.childNodes[Z].textContent;c+=a?(a+"\t"):"";}c+="\n";K.forEach(function(e){for(Z=0;Z<e.childNodes.length;Z++){a=e.childNodes[Z].innerText||e.childNodes[Z].textContent;c+=a?(a+"\t"):"";}c+="\n";});X.value=c;X.focus();X.select();c=B(Y,b);this.viewDataDialog.updateToolbarChildren(c);},N=function N(a,X){var Y=this.controller,Z=Y.cmdMgr;Z.getInterimCmd().submitInterim(a,Y._getXtabCallback(this,X||{}),{preserveUndo:true,hideCancel:true});},H=function H(Y,X){N.call(this,this.controller.dataService().getUpdateTemplateAction(this.k,Y),X);},Q=function(Y,a){var X=J.indexOf(K,Y),Z=X>-1;if(Z||a===false){K.splice(X,1);}if(!Z||a===true){K.push(Y);F=Y;}U.toggleClass(Y,"selected",!Z||a===true);},C=function C(){K.forEach(function(X){U.removeClass(X,"selected");});K=[];};mstrmojo.vi.ui.rw._IsViewDataGrid=mstrmojo.provide("mstrmojo.vi.ui.rw._IsViewDataGrid",{_mixinName:"mstrmojo.vi.ui.rw._IsViewDataGrid",submitUndoRedoActionsWithCallback:function A(X,Y){N.call(this,X,Y);},doSelection:function O(r,X,f){if(f.getAttribute("r")==="0"){var t=this.getCellForNode(f);if(t.at&8&&E.getButton(X,r)!==E.MOUSE_BUTTON.RIGHT){this.sort(t);}return ;}if(f&&~f.className.indexOf("xtab-td")){var g=E.isMetaKey(X,r),p=E.shiftKey(X,r),b=E.findAncestorByName(f,"tr",true,this.domNode),Y=E.findAncestorByName(f,"tbody",true,this.domNode);if(g||(p&&!F)){Q(b);}else{if(p&&Y){var a=E.findAncestorByName(F,"tbody",true,this.domNode),q=this.zone.rowsPerPage,o=function(e){return e.tBodyN*q+e.index;},l=function(e){return this.zone.tableNode.childNodes[e+1].childNodes;}.bind(this),c={row:F,tBodyN:parseInt(a.getAttribute("n")||0),index:J.indexOf(a.childNodes,F),body:a},h={row:b,tBodyN:parseInt(Y.getAttribute("n")||0),index:J.indexOf(Y.childNodes,b),body:Y},k,Z,n,m,d;if(o(c)<o(h)){k=c;Z=h;}else{k=h;Z=c;}Q(k.row,true);if(k.tBodyN===Z.tBodyN){d=k.body.childNodes;for(m=k.index+1;m<Z.index;m++){Q(d[m]);}}else{for(n=k.tBodyN;n<=Z.tBodyN;n++){if(n===k.tBodyN){d=k.body.childNodes;for(m=k.index+1;m<d.length;m++){Q(d[m]);}}else{if(n===Z.tBodyN){d=Z.body.childNodes;for(m=0;m<Z.index;m++){Q(d[m]);}}else{d=l(n);for(m=0;m<d.length;m++){Q(d[m]);}}}}}Q(Z.row,true);}else{C();Q(b,true);}}}else{C();}I.call(this);},onclick:function W(b,X){if(!this.interactiveCellsArray.length){return ;}b=b.e||b;var Y=mstrmojo.dom,a=Y.eventTarget(X,b),Z=a&&Y.findAncestorByName(a,"td",true,this.viewport);if(Z){this.doSelection(b,X,Z);Y.clearBrowserHighlights();}},changeColumnWidth:function M(b,Z,a,Y,X){H.call(this,this._super(b,Z,a,Y,X,true));},preBuildRendering:function D(){this._super();U.addWidgetCssClass(this,"viewData");},postBuildRendering:function P(){this._super();var X=L(this.gridData);this.viewDataDialog.updateToolbarChildren(B(X));},lastSortedCell:[],sort:function R(f,d){var Y=f._ei,c=d===undefined,e=c?true:!!d,X=this.lastSortedCell,Z={success:function(){try{var l=this.tableContainerNode.lastElementChild.firstChild.firstChild.firstChild.lastChild.firstChild.childNodes,h=this.tableContainerNode.childNodes[1].firstChild.firstChild.lastChild.firstChild.childNodes,j;for(j=0;j<l.length;j++){if(Y===Number(l[j].getAttribute("ei"))){U.addClass(l[j],e?"asc":"desc");U.addClass(h[j],e?"asc":"desc");}}}catch(k){}}.bind(this)};if(X){if(X[0]===Y){e=c?!X[1]:d;}}X[0]=Y;X[1]=e;var b=this.controller,g=b.getSorts(this.model.getSortAction(f,e)),a={act:"sort",sorts:g.sorts,nodeKey:this.k,subTotalsPos:g.subTotalsPos};H.call(this,a,Z);},pivot:function G(X,Y){var Z=this.model.getPivotAction(X,Y);H.call(this,Z);},selectAll:function S(){var Y=this.zone,Z=Y.tableNode.childNodes,b,a,c,X,d,e=true;C();for(b=0;b<Z.length;b++){c=Z[b];if(c.tagName.toLowerCase()==="tbody"){X=c.getAttribute("n")||0;if(!Y.pageStatus[X].isOnDemand()){d=c.childNodes;for(a=0;a<d.length;a++){if(!e){Q(d[a],true);}e=false;}}}}I.call(this);},isMultiSelect:false,onHandleDblClick:function V(){var X={act:"changeXtabColWidthScenario",value:2};H.call(this,X);}});}());(function(){mstrmojo.requiresCls("mstrmojo.dom","mstrmojo.css");var F=mstrmojo.dom,I=mstrmojo.css,C="active";var A=false;mstrmojo.util.ui.SplitterParamsType=null;function H(N,Q){var P=Q.info,O=P&&P.min,M=P&&P.max,L=Q.start+(F.getMousePosition(N,window)[Q.mouseProp]-Q.mousePosition)*(P&&!!P.isReverseMove?-1:1);if(O!==undefined){L=Math.max(L,O);}if(M!==undefined){L=Math.min(L,M);}return L;}function G(M,L,N){return function(O){M.call(mstrmojo.all[L],O,N);};}function B(L,M){M.target.style[M.styleProp]=H(L,M)+"px";}function K(L,N){if(!A){return ;}var M=window.document;F.detachEvent(M,"mousemove",N.fnMove);F.detachEvent(M,"mouseup",N.fnUp);delete N.fnMove;delete N.fnUp;A=false;mstrApp.setInteractive(true);this.splitterMoved(H(L,N)-N.start,N.info);I.removeClass(N.target,C);(this.children||[]).forEach(function(O){O.domNode.style.pointerEvents="inherit";});this.splitterMouseUp();}function J(W){if(A){return ;}mstrApp.setInteractive(false);var L=this.id,M,N,Q=F.eventTarget(window,W),S=(Q.className.indexOf("v")===-1),R=S?"y":"x",P={};P.target=Q;P.info=this.getSplitterInfo(Q);N=P.info&&!!P.info.isReverseMove;M=S?"Top":N?"Right":"Left";P.start=N?parseInt(Q.style.right):Q["offset"+M];P.mouseProp=R;P.mousePosition=F.getMousePosition(W,window)[R];P.styleProp=M.toLowerCase();I.addClass(Q,C);(this.children||[]).forEach(function(X){X.domNode.style.pointerEvents="none";});this.splitterMouseDown();var O=G(B,L,P),V=G(K,L,P);var U=window.document;F.attachEvent(U,"mousemove",O);F.attachEvent(U,"mouseup",V);P.fnMove=O;P.fnUp=V;A=true;}mstrmojo.util.ui._HostsSplitter=mstrmojo.provide("mstrmojo.util.ui._HostsSplitter",{_mixinName:"mstrmojo.util.ui._HostsSplitter",registerSplitter:function E(L){this.splitterEvtMouseDownHandler=G(J,this.id);F.attachEvent(L,"mousedown",this.splitterEvtMouseDownHandler);},unRegisterSplitter:function D(L){if(this.splitterEvtMouseDownHandler){F.detachEvent(L,"mousedown",this.splitterEvtMouseDownHandler);}},getSplitterInfo:mstrmojo.emptyFn,splitterMoved:mstrmojo.emptyFn,splitterMouseDown:mstrmojo.emptyFn,splitterMouseUp:mstrmojo.emptyFn});}());(function(){mstrmojo.requiresCls("mstrmojo.array","mstrmojo.dom","mstrmojo.css");var A=1,K="mstrmojo-itemwrap",J="&nbsp;",I=mstrmojo.array;function B(W){if(!W.pageSize||W.pageSize<=0){var X=W.scrollboxNode;W.pageSize=X&&X.clientHeight||0;}return W.pageSize;}function U(W,X){if(W.usePaging){W.totalPages=1;var Z=W.itemsContainerNode,Y=B(W);if(W.usePaging&&Z&&Y){W.totalPages=Math.ceil((Z.clientHeight-parseInt(Z.style&&Z.style.paddingBottom||0,10))/Y);}if(Z){W.itemsContainerNode.style.paddingBottom=Y+"px";}}}mstrmojo.ListMapper=mstrmojo.provide("mstrmojo.ListMapper",{markupPrefix:"",markupSuffix:"",itemWrapperPrefix:function(W){return'<div class="'+this.getWrapperCss(W)+'">';},itemWrapperSuffix:"</div>",itemWrapperPrefill:"&nbsp",wrapperNodes:function C(W){return W.childNodes;},wrapperParentNode:function D(W){return W;},createWrapperNode:function G(W){var X=W.ownerDocument,Y=X.createElement("div");return Y;},findScrollRange:function N(l,a,k,o,X,d,q,n){if(!a){return{start:0,end:0};}var f=this.wrapperNodes(l),j=parseInt(a/2,10),Z=parseInt(Math.log(a)/Math.log(2),10),Y=0,W=a-1,g=k+o,e=f[0].offsetTop,c;for(var m=1;m<=Z;m++){c=f[j].offsetTop-e+n;if(c<k){Y=j;}else{if(c>g){W=j;}}var b=Math.round(a/Math.pow(2,m+1));j+=(c>k)?-b:b;j=Math.min(Math.max(0,j),a-1);}return{start:Y,end:W};},findWrapper:function L(Y,W){var X=this.wrapperNodes(Y);return X&&X[W];},findIndex:function F(W,Z,Y){var X=this._nd2iw(W,Z,Y);return X?this._iw2idx(W,Z,X):-1;},itemOffsetTop:function V(X,b,W,Z){if(!Z){var Y=this.wrapperNodes(b);Z=Y&&Y[W];if(!Z){return 0;}}var a=b.firstChild;if(!a||(a===Z)){return 0;}else{return Z.offsetTop-a.offsetTop;}},whereDrop:function S(d,W,Y,c,X){var Z=this._nd2iw(d,W,Y),e,b,f;if(Z){b=this._iw2idx(d,W,Z);e=b;f=this.itemOffsetTop(d,W,null,Z);var a=Z.offsetHeight;if(c.y>X.top+f+a/2){e++;f+=a;}}else{return d.dropCuePos;}return{left:0,top:f,idx:e,idxActual:b};},getWrapperCss:function(W){return K;},postBuildRendering:function(a,Z,Y,X,W){U(X,this);},buildItemWrappers:function P(f,c,l,e,b,m){var n=this.itemWrapperPrefix(l),h=this.itemWrapperSuffix,a=n+this.itemWrapperPrefill+h,Z=[this.markupPrefix],X=1,W=l.selectedIndices||{},p=function o(k,j){for(var q=k;q<j;q++){Z[X++]=n;var r=c.build(l,e,f[q],q);if(W[q]){r=r.replace(/class\=\"([^\"]*)\"/,'class="$1 selected"');}Z[X++]=r;Z[X++]=h;}};var d=(f&&f.length)||0;b=b&&c?Math.min(b,d):0;if(b){p(0,b);}m=m&&c?Math.min(m,d-b):0;var g=d-m;for(var Y=b;Y<g;Y++){Z[X++]=a;}if(m){p(g,d);}Z.push(this.markupSuffix);return Z;},fillItemWrappers:function H(Y,h,e,n,g,X,c,m){var f=(h&&h.length)||0,l=this.wrapperNodes(Y),o=g.itemStatus,W=mstrmojo.css,a=n.selectedIndices||{};for(var d=X,j=Math.min(c+1,f),b=0;d<j;d++){if(o[d]!==A){l[d].innerHTML=e.build(n,g,h[d],d);if(a[d]){var Z=l[d].firstChild;if(Z){W.addClass(Z,["selected"]);}}b++;if(b===m){break;}}}return b;},onadd:function O(f,W,a,g){if(W&&g){var b=g.value.length,d=this.wrapperNodes(W),e=d[g.index],Z=this.getWrapperCss(f);for(var Y=0;Y<b;Y++){var X=this.createWrapperNode(W);X.className=Z;X.innerHTML=J;if(e){this.wrapperParentNode(W).insertBefore(X,e);}else{this.wrapperParentNode(W).appendChild(X);}}U(f,this);}},onremove:function Q(Z,d,W,Y){if(d&&Y){var b=this.wrapperNodes(d);if(b){var e=Y.value.length;for(var a=Y.index+e-1,X=Y.index;a>=X;a--){this.wrapperParentNode(d).removeChild(b[a]);}}U(Z,this);}},onchange:function R(h,Y,d,l){if(Y&&l){var e=this.wrapperNodes(Y);if(e){var X=mstrmojo.css,m=d.itemStatus,k;for(var c=0,W=l.removed,g=W&&W.length;c<g;c++){k=W[c];if(m[k]){X.removeClass(e[k].firstChild,["selected"]);}}for(var b=0,f=l.added,Z=f&&f.length;b<Z;b++){k=f[b];if(m[k]){X.addClass(e[k].firstChild,["selected"]);}}}}},_nd2iw:function E(X,a,Z){a=this.wrapperParentNode(a);if(a&&Z&&a!==Z){var W=X.domNode,Y=Z.parentNode;while(Y){if(Y===a){return Z;}if(Y===W){break;}Z=Y;Y=Z.parentNode;}}return null;},_iw2idx:function M(Y,c,b){var X=Y.items&&Y.items.length,Z=this.wrapperNodes(c),W=I.findBin(Z,b,"offsetTop",X);for(var a=W;a<X;a++){if(Z[a].offsetHeight){return a;}}return -1;},toPage:function(W,Y){var X=W.scrollboxNode;if(W.usePaging&&X){X.scrollTop=Y*B(W);}else{mstrmojo.alert("paging is not setup, can not perform paging.");}},whichPage:function(W){var X=W.scrollboxNode,Y=B(W);return Math.round((X&&Y&&X.scrollTop/Y)||0);},toItem:function(a,b){var Y=a&&a.itemsContainerNode,f=a.scrollboxNode,W=this.itemOffsetTop(a,Y,b),d=this.wrapperNodes(Y)[b].clientHeight,X=f.clientHeight,e=f.scrollTop,Z=e;if(W<e){Z=W;}else{if(e+X-d<W){Z=Math.min(W,W-X+d);}}f.scrollTop=Z;}});})();(function(){mstrmojo.requiresCls("mstrmojo.css","mstrmojo.fx.AnimateProp");var S=mstrmojo.css;var Q=10;function C(X,a,Z){X.pauseScrollRendering(true);var Y=X.scrollboxNode,W=X.animate?X.scrollEffect:null;if(W&&W.play){if(W.isPlaying){W.cancel();}W.props={scrollTop:{start:Y.scrollTop,stop:a,isStyle:false}};W.onEnd=function(){X.pauseScrollRendering(false,null,Z);};W.play();}else{Y.scrollTop=a;X.pauseScrollRendering(false,null,Z);}}function K(d,f,W){var X=4;if(!W){W=0;}var g=Math.round(d.renderBlockSize/2);d.fillAt(Math.max(0,f-g),f+g);var c=d.itemsContainerNode,b=c.childNodes[f],a=d.listMapper.itemOffsetTop(d,c,null,b),e=parseInt(d.scrollboxNode.clientHeight/2,10)-b.offsetHeight/2,Y=Math.max(0,d.spacerMargin+a-e);if(Math.abs(d.scrollboxNode.scrollTop-Y)>2){C(d,Y,d.renderOnScroll?function(){if(W<=X){K(d,f,W++);}}:null);}else{var Z=d.animate?d.scrollEffect:null;if(Z&&Z.isPlaying&&Z.cancel){Z.cancel();d.pauseScrollRendering(false);}}}function J(Y){var Z=Y.itemsContainerNode,W=Z.lastChild,X=W?W.offsetTop+W.offsetHeight-Z.firstChild.offsetTop:0;return X;}function V(X){var W=J(X),Y=Math.max(0,parseInt((X.scrollboxNode.clientHeight-W)/2,10));C(X,Math.max(0,X.spacerMargin-Y));}function H(Y){var W=Y.selectedIndex,X=W>-1;Y.set("hasSelection",X);if(!Y.domNode){return ;}if(X){K(Y,W);}else{V(Y);}}function E(X){var Z=X.scrollboxNode,W=J(X),Y=W>Z.clientHeight/2;S.toggleClass(X.upArrowNode,["enabled"],Y);S.toggleClass(X.downArrowNode,["enabled"],Y);}function N(W,X){var Y=W.scrollboxNode;Y.scrollTop=Math.min(Math.max(Y.scrollTop+X,0),Y.scrollHeight-Y.offsetHeight);}function B(X,W){if(!X._scrollInter){var Y=Q*(W?-1:1);X._scrollInter=window.setInterval(function(){N(X,Y);},50);}}function R(W){if(W._scrollInter){window.clearInterval(W._scrollInter);W._scrollInter=null;}}mstrmojo._IsDial=mstrmojo.provide("mstrmojo._IsDial",{markupString:'<div id="{@id}" class="mstrmojo-Dial {@cssClass}" style="position:relative;"><div class="mstrmojo-Dial-uparrow"  onmouseover="mstrmojo.all.{@id}.onmouseoverarrow(self, arguments[0], true)" onmouseout="mstrmojo.all.{@id}.onmouseoutarrow(self, arguments[0], true)" onclick="mstrmojo.all.{@id}.onclickarrow(self, arguments[0], true)" onmousedown="mstrmojo.all.{@id}.onmousedownarrow(self, arguments[0], true)" onmouseup="mstrmojo.all.{@id}.onmouseuparrow(self, arguments[0], true)"></div><div class="mstrmojo-Dial-scrollbox {@cssClass}" style="position:relative;{@cssText}" mstrAttach:mousedown,mouseup><div class="mstrmojo-Dial-spacer" style="{@spacerCssText}"><div class="mstrmojo-Dial-itemsContainer" style="position:relative;{@itemsContainerCssText}">{@itemsHtml}</div></div></div><div class="mstrmojo-Dial-dnarrow" onmouseover="mstrmojo.all.{@id}.onmouseoverarrow(self, arguments[0], false)" onmouseout="mstrmojo.all.{@id}.onmouseoutarrow(self, arguments[0], false)" onclick="mstrmojo.all.{@id}.onclickarrow(self, arguments[0], false)" onmousedown="mstrmojo.all.{@id}.onmousedownarrow(self, arguments[0], false)" onmouseup="mstrmojo.all.{@id}.onmouseuparrow(self, arguments[0], false)"></div></div>',markupSlots:{scrollboxNode:function(){return this.domNode.childNodes[1];},spacerNode:function(){return this.domNode.childNodes[1].firstChild;},itemsContainerNode:function(){return this.domNode.childNodes[1].firstChild.firstChild;},upArrowNode:function(){return this.domNode.childNodes[0];},downArrowNode:function(){return this.domNode.childNodes[2];}},markupMethods:{onvisibleChange:function(){this.domNode.style.display=this.visible?"block":"none";},onhasSelectionChange:function(){S.toggleClass(this.domNode,["hasSelection"],!!this.hasSelection);}},animate:true,itemsEffect:{scriptClass:"mstrmojo.fx.AnimateProp",duration:500,interval:25,slot:"itemsContainerNode",preStart:function(){var X=this.widget[this.slot],W=(X&&X.offsetWidth)||0;this.props=W?{left:{start:-W,stop:0,suffix:"px",isStyle:true}}:{};},revertOnCancel:false},scrollEffect:{scriptClass:"mstrmojo.fx.AnimateProp",duration:250,interval:25,slot:"scrollboxNode",revertOnCancel:false},multiSelect:false,holdJumpOnly:true,audibles:{"*":true,hasSelection:false},initSpacer:function I(){var W=(this.cssText||"").match(/height:\s*(\d*)px/);if(W){this.spacerMargin=parseInt(Number(W[1])/2,10);var X=this.spacerMargin+"px";this.spacerCssText="padding-top: "+X+"; padding-bottom: "+X+";";}else{this.spacerMargin=0;delete this.spacerCssText;}},center:function U(){H(this);},preBuildRendering:function(){this.initSpacer();return this._super();},postBuildRendering:function D(){this._super();this.center();E(this);},refreshScroll:function G(){this.center();E(this);},prechange:function O(W){this._super(W);if(this.hasRendered){if(!this.multiSelect||(W&&W.added&&W.added.length)){this.center();}}},onclickarrow:function A(Y,X,W){N(this,Q*(W?-1:1));},onmouseoverarrow:function L(Y,X,W){if(!this.holdJumpOnly){B(this,W);}},onmouseoutarrow:function M(Y,X,W){R(this);},onmousedownarrow:function F(Y,X,W){if(this.holdJumpOnly){B(this,W);}},onmouseuparrow:function P(Y,X,W){R(this);}});}());(function(){mstrmojo.requiresCls("mstrmojo.css","mstrmojo.dom");var D=mstrmojo.dom,H=D.position,I=Math;function F(V,P,N){var O=this._ellTestNodes||{},K=O[V],M=mstrmojo.css.getComputedStyle(P),J=["width","height"];if(N){J.reverse();}var S=J[0],Q=J[1];if(!K||!D.contains(this.domNode,K.n,true,document.body)){var L=P.cloneNode(true);L.removeAttribute("id");L.removeAttribute("onclick");var U=L.style;U.position="absolute";U.top="-10000px";U.maxHeight=U.maxWidth="none";U[S]="auto";P.parentNode.appendChild(L);var R=parseInt(M["max-"+S],10);if(isNaN(R)){R=parseInt(M[S],10);}K=O[V]={n:L,m:R,d:S.substr(0,1)};if(K.m>0){this._ellTestNodes=O;}}else{K.n.innerHTML=P.innerHTML;}K.n.style[Q]=M[Q];return K;}function B(K,L){var M=this.ellipsisText;switch(this.ellipsisPosition){case"middle":var J=I.floor(L/2);return K.slice(0,J).join("")+M+K.slice(-J).join("");case"end":return K.slice(0,L).join("")+M;default:return K.join("");}}var G=4;mstrmojo._SupportsEllipsisText=mstrmojo.provide("mstrmojo._SupportsEllipsisText",{_mixinName:"mstrmojo._SupportsEllipsisText",ellipsisText:"\u2026",ellipsisPosition:"end",ellipsize:function A(V,P,O){var W=P.innerHTML;if(!W){return false;}var K=F.call(this,V,P,O),M=function(){var X=H(K.n)[K.d];return(X<=K.m);};if(M()){return false;}var L=K.n,J=W.split(""),R=0,N=J.length,Q,S;while(R<N){var U=I.floor((R+N)/2);W=L.innerHTML=B.call(this,J,U);if(M()){R=U+1;}else{N=U-1;}if(N-R<G){for(S=R-1;S<N+1;S++){W=L.innerHTML=B.call(this,J,S);if(!M()){break;}Q=W;}}if(Q){P.innerHTML=Q;break;}}return true;},ellipsizeElements:function C(U,O,N){var L=F.apply(this,arguments),M=function(){var V=H(L.n)[L.d];return(V<=L.m);};if(M()){return false;}var Q=this.ellipsisText;var P=this;var K=document.createElement("span");K.innerHTML=Q;var J=function(Z,Y){var V=Z.slice(0,Y).concat([K]);var X=document.createElement("div");for(var W=0;W<V.length;W++){X.appendChild(V[W]);}return X.innerHTML;};var S=function(W,a,Z,V){var c=0,X=a.length,b,f,d;var Y=function(g){while(g.hasChildNodes()){g.removeChild(g.lastChild);}};while(c<X){var e=I.floor((c+X)/2);if(V){f=Z.call(P,a,e);W.nodeValue=f;}else{Y(W);f=Z.call(P,a,e);W.innerHTML=f;}if(M()){c=e+1;}else{X=e-1;}if(X-c<G){d=c==0?0:c-1;for(;d<X+1;d++){if(V){f=Z.call(P,a,d);W.nodeValue=f;}else{Y(W);f=Z.call(P,a,d+1);W.innerHTML=f;}if(!M()){if(!V){W.removeChild(W.lastChild);b=f=W.innerHTML;}break;}if(!V){W.removeChild(W.lastChild);f=W.innerHTML;}b=f;}}if(b){if(V){W.nodeValue=b;}else{W.innerHTML=b;}break;}}};var R=function(Y){if(Y.nodeType==3){var Z=Y.nodeValue;if(!Z){return false;}S(Y,Z.split(""),B,true);return true;}else{var W=Y.childNodes;if(!W||W.length===0){return false;}var X=[];for(var V=0;V<W.length;V++){X[V]=W[V];}if(X.length!=1||X[0].nodeType!=3){S(Y,X,J,false);}return R(Y.lastChild);}};O.style.visibility="visible";L.n.style.visibility="hidden";R(L.n);O.style.visibility="hidden";L.n.style.visibility="visible";return true;},unrender:function E(J){delete this._ellTestNodes;this._super(J);}});}());(function(){mstrmojo.requiresCls("mstrmojo.color","mstrmojo.css","mstrmojo.hash");var A=mstrmojo.color,C=mstrmojo.css,H=mstrmojo.hash;function B(I){I=G(I);if(isNaN(I)){I=0;}I%=16777216;return{b:I%(1<<8),g:(I%(1<<16))>>8,r:(I%(1<<24))>>16};}function F(M,N,L){M=G(M);L=H.copy(L,{retainGradientObject:false});if(D(M)){var K=F(M.c1,N),I=F(M.c2,N);if(L.retainGradientObject){return{c1:K,c2:I,or:M.or};}return C.buildGradient(M.or,K,I).v;}if(typeof N==="number"){var J=B(M);if(isNaN(M)){N=0;}return"rgba("+J.r+" ,"+J.g+" ,"+J.b+" ,"+N+" )";}else{if(isNaN(M)){M=0;}return"#"+(16777216+M%16777216).toString(16).substring(1,7);}}function G(K){var J=K.c1,I=K.c2;if(D(K)){return{c1:G(J),c2:G(I),or:K.or};}if(typeof K==="number"){return K;}if(typeof K!=="string"){return NaN;}if(K[0]!=="#"){return parseInt(K,10);}if(K.length===4){K=K[0]+K[1]+K[1]+K[2]+K[2]+K[3]+K[3];}return parseInt(K.substring(1,7),16);}function E(K,I){var N=K.value,P=K.opacity;if(D(N)){return["c1","c2"].reduce(function(V,W,U){var X=E({value:N[W],opacity:P},I);V.value[W]=X.value;if(U===0){V.opacity=X.opacity;}return V;},{value:{or:N.or}});}if(N==="transparent"){K.value=I.value;}var M=A.hex2rgb(F(K.value)),L=A.hex2rgb(F(I.value)),S=K.opacity,R=I.opacity,Q=1-S,O,J;J=S+R*Q;O=M.map(function(U,V){return(U*S+L[V]*R*Q)/J;});return{value:"#"+A.rgb2hex.apply(undefined,O),opacity:J};}function D(I){return I&&["c1","c2","or"].every(function(J){return I.hasOwnProperty(J);});}mstrmojo.util.color=mstrmojo.provide("mstrmojo.util.color",{getCSSColorString:F,getColorValue:G,mix:E,isGradientColor:D,getRGB:B,createCanvasFillPattern:function(K,Q,J,P,I,O){var L=K.value,N=K.opacity,M;if(D(L)){M=Q.createLinearGradient(J,P,I,O);M.addColorStop(0,F(L.c1,N));M.addColorStop(1,F(L.c2,N));}else{M=F(L,N);}return M;}});})();(function(){mstrmojo.requiresCls("mstrmojo.css");var A=mstrmojo.css;mstrmojo.ui._HasUITheme=mstrmojo.provide("mstrmojo.ui._HasUITheme",{_mixinName:"mstrmojo.ui._HasUITheme",themeClassName:"",postBuildRendering:function B(){var D=this.themeClassName;if(D){this.onthemeClassNameChange({value:D});}return this._super();},onthemeClassNameChange:function C(D){var F=this.domNode;if(F){var G=D.value,E=D.valueWas;if(G){A.addClass(F,D.value);}if(E){A.removeClass(F,D.valueWas);}}}});mstrmojo.ui._HasUITheme.EnumThemeNames={LIGHT_THEME:"mojo-theme-light",DARK_THEME:"mojo-theme-dark"};}());(function(){mstrmojo.requiresCls("mstrmojo.css");function B(){var D=this.maskNode,E=this.isMasked;D.style.display=E?"block":"none";mstrmojo.css.toggleClass(D,"masked",E);}mstrmojo.vi.ui._HasMask=mstrmojo.provide("mstrmojo.vi.ui._HasMask",{_mixinName:"mstrmojo.vi.ui._HasMask",isMasked:false,postBuildRendering:function C(){if(this._super){this._super();}B.call(this);},onisMaskedChange:function A(){if(!this.hasRendered){return ;}B.call(this);}});}());(function(){mstrmojo.requiresClsP("mstrmojo","hash","css","array","desc");var R=mstrmojo.hash,m=mstrmojo.func,B=mstrmojo.css,f=mstrmojo.array;var E={lv:-1,hcd:false,epd:false,hid:false,dhid:false,children:[],displayChildren:[],parent:null,displayParent:null},k={rootItems:{},items:[],itemMap:{}};var l="hidden",C="expanded",q="collapsed",J="hierarchy",c="hasChildren",p="u;",X=10,M=7,o=32;mstrmojo.ui._IsHierarchyList=mstrmojo.provide("mstrmojo.ui._IsHierarchyList",{_mixinName:"mstrmojo.ui._IsHierarchyList",itemValueField:"v",init:function n(r){this._super(r);this.clearItems();},getItemProps:function g(u,r){var t=this._super(u,r),v=0;if(u.hcd){t.addCls(c);}if(u.v===p){t.addCls(l);}if(this.isHiearachyDisplay()){t.addCls(J);if(u.hid){t.addCls(l);}v=u.lv>=0?u.lv*X:0;}t.indent=v;return t;},_getItemNode:function S(r){var t=this.itemsContainerNode;return f.filterOne(t&&t.childNodes,function(u){return parseInt(u.getAttribute("idx"),10)===r;});},_buildItemsMarkup:function j(z,t,u,v,w,x){var r;if(this.isHiearachyDisplay()){r=this._buildDescendantsMarkup();}else{r=this._super(z,t,u,v,w,x);}return r;},_buildDescendantsMarkup:function a(z,w){var AC=[],x=this.itemRenderer&&this.itemRenderer.render,AA=z?(w?[z]:z.displayChildren):(this.raad?this.getDisplayRoots():this.getRootItems()),t=this.blockCount,v=function(AD){if(!AD.hid&&!AD.dhid){AC.push(x(AD,AD.idx,this));}if(AD.epd||AD.hid){f.forEach(AD.displayChildren,function(AF,AE){return AB.call(this,AF,AE);},this);}},AB=function(AE,AD){if(this.raad&&AD>=t){var AF=this.createRenderer(AE.lv,AE.displayParent,AE.parent,this.items.length,AD);this.items.push(AF);if(AF.displayParent){AF.displayParent.displayChildren.push(AF);}if(AF.parent){AF.parent.children.push(AF);}v.call(this,AF);return false;}else{v.call(this,AE);}};if(x&&typeof x==="function"){if(this.raad&&!z){if(AA.length>t){var r=AA.slice(0,t),u=this.createRenderer(AA[t-1].lv,null,null,this.items.length,t);this.items.push(u);AA.push(u);r.push(u);AC=this._buildSiblingsMarkup(r);}else{AC=this._buildSiblingsMarkup(AA);}}else{f.forEach(AA,function(AE,AD){return AB.call(this,AE,AD);},this);}}return AC;},getItems:function U(){return this.items;},getItemByValue:function D(r){return this.itemMap[r];},isRootItem:function(r){return r.lv>=0&&r.v!==p&&!r.pid&&!r.parent;},getRootItems:function d(){return R.valarray(this.rootItems);},getDisplayRoots:function Y(){if(!this.displayRoots){var u=this.displayRoots=[],r=this.getRootItems(),t=function(v){f.forEach(v,function(w){if(!w.hid){u.push(w);}if(w.epd||w.hid){t(w.displayChildren);}});};t(r);}if(!this.initialDisplayRoots){this.initialDisplayRoots=u.slice();}return this.displayRoots;},getInitialDisplayRoots:function A(){if(!this.initialDisplayRoots){this.initialDisplayRoots=(this.getDisplayRoots()||[]).slice();}return this.initialDisplayRoots;},createRenderer:function I(w,t,v,r,u){return{n:mstrmojo.desc(1005,"More..."),lv:w,displayParent:t,parent:v,idx:r,fetcher:true,fake:true,config:{nextSiblingIdx:u}};},getItemAncestorMap:function F(t){var r=this.itemValueField,u={};while(t&&t[r]){u[t[r]]=true;t=t.parent;}return u;},getItemDescendantMap:function Z(u){var r=this.itemValueField,v={},t=function(w){v[w[r]]=true;f.forEach(w.children,function(x){t(x);});};t(u);return v;},clearItems:function h(){var r=this.itemsContainerNode;R.copy(R.clone(k),this);if(r){r.innerText="";this.updateScrollbars();}},addItems:function e(x,u){var t=this.items,w=this.itemMap,r=this.rootItems,v=this.itemValueField,AA=[];f.forEach(x,function(AB){var AE=AB[v],AC=this.getItemByValue(AE),AD=R.copy(AB,(AC?AC:R.clone(E)));if(!AC){AD.idx=t.length;t.push(AD);if(AE){w[AE]=AD;}}if(this.isRootItem(AD)){r[AE]=AD;}AA.push(AD);},this);f.forEach(AA,function(AD){var AB=this.getItemByValue(AD.pid),AC=this.getItemByValue(AD.dpid)||AB;if(AB){if(!AD.parent){AD.parent=AB;AB.children.push(AD);}if(!AD.hid&&!AD.dhid&&!AD.displayParent){AC.hcd=true;AD.displayParent=AC;AC.displayChildren.push(AD);}}delete AD.pid;delete AD.dpid;},this);if(!u){if(this.postAddItems){this.postAddItems(AA);}var z=this.itemsContainerNode;if(z){if(this.isHiearachyDisplay()){this.refresh();}else{z.innerHTML+=this._buildSiblingsMarkup(this.getFlatDisplayItems(AA)).join("");this.updateScrollbars();}}}return AA;},addSiblingItems:function G(AA,w){var v=this.getItemByValue(w),t;if(v){f.forEach(AA,function(AC){if(AC.v!==w){AC.pid=AC.pid||w;}});}t=this.addItems(AA,true);if(this.postAddSiblingItems){this.postAddSiblingItems(t,v);}var x=this.itemsContainerNode;if(x&&this.isHiearachyDisplay()){var z=this._buildSiblingsMarkup(t).join("");if(!w){x.innerHTML+=z;}else{if(v){var AB={},u=this._getItemNode(v.idx),r;if(u){AB[v.v]=true;while(u.nextSibling){r=this.getItemFromTarget(u.nextSibling);if(r&&r.displayParent&&AB[r.displayParent.v]){AB[r.v]=true;u=u.nextSibling;}else{break;}}u.outerHTML+=z;}}}this.updateScrollbars();}return t;},addBranchItems:function L(t,w){var r=this.getItemByValue(w),v;if(r){f.forEach(t,function(z){z.pid=z.pid||w;});}v=this.addItems(t,true);if(this.postAddBranchItems){this.postAddBranchItems(v,r);}var u=this.itemsContainerNode;if(u&&this.isHiearachyDisplay()){if(!w){f.forEach(v,function(z){if(this.isRootItem(z)){u.innerHTML+=this._buildDescendantsMarkup(z,true).join("");}},this);}else{if(r){var x=this._getItemNode(r.idx);if(x){x.outerHTML+=this._buildDescendantsMarkup(r).join("");}}}this.updateScrollbars();}return v;},updateItems:function H(r,t){if(t){f.forEach(r,function(z,v,w){var x=t[v],u=w[x.p_index];if(u){z.pid=u.v;}});}this.handleOriginalParent(r,t);this.setDisplayParent(r,t);this.clearItems();this.addItems(r,true);},handleOriginalParent:function P(r,t){if(t){f.forEach(r,function(AA,v,w){var z=t[v],u=w[z.p_index],x=w[z.original_p_index];if(u&&u.t===M&&AA.lv!==u.lv&&x&&x.pid===u.v){AA.pid=x.v;}});}},setDisplayParent:function K(r,w,v){if(v){this.idMap=this.idMap||{};f.forEach(r,function(z){this.idMap[z.v]=z;},this);}var u=this,t=function(AB,AA){var z;if(!v&&w){var AC=w[AA].p_index;z=r[AC];}else{if(v){z=u.idMap[AB.pid];}}return z;};f.forEach(r,function x(AC,AA,AB){var z=t(AC,AA);if(!z||u.isRootItem(AC)){return AC.v;}if(!AC.dpid){AC.dpid=z.hid?x(z,w&&w[AA]&&w[AA].p_index,AB):z.v;}return AC.dpid;});},fetchItems:function V(v,z){if(this.raad&&this.isHiearachyDisplay()&&(this.items||[]).length>0){return ;}v=v||{};var t=this,r=v.branch,x=v.browseFlags&o,w=parseInt(v.level,10),u=w>=0;this.fetchItemsThroughTaskCall(v,m.wrapMethods(z,{success:function(AA){if(t.raad===undefined&&AA&&t.isHiearachyDisplay()){t.raad=AA.raad;}if(AA&&AA.es){var AB=AA.es;if(w===(r&&r.lv+1||0)||(x&&!t.raad)){t.addSiblingItems(AB,r&&r.v);}else{if(r&&!u){t.addBranchItems(AB,r.v);}else{t.addItems(AB);}}}}}));},updateItemNodesStatus:function W(){var r=this.itemsContainerNode&&this.itemsContainerNode.childNodes;f.forEach(r,function(u){var t=this.getItemFromTarget(u);if(t){B.toggleClass(u,CSS_SELECTED,t.isSelected);}},this);},_buildSiblingsMarkup:function O(u){var r=[],t=this.itemRenderer&&this.itemRenderer.render;if(t&&typeof t==="function"){f.forEach(u,function(v){r.push(t(v,v.idx,this));},this);}return r;},toggleCollapseExpandCss:function Q(t,r){B.toggleClass(t,q,!r);B.toggleClass(t,C,r);},doExpandCollapse:function b(r,AB){var AC=!AB.epd;AB.epd=AC;this.toggleCollapseExpandCss(r,AC);if(!this.isHiearachyDisplay()){return ;}var z=this.getItemDescendantMap(AB),u,AA;if(AC){var t=AB.displayChildren&&AB.displayChildren[0];if(t){var w=this.getItemFromTarget(r.nextSibling);if(w&&w.displayParent===AB){var x={},v;u=r.nextSibling;while(u){AA=this.getItemFromTarget(u);v=AA&&AA.displayParent;if(!v||!z[AA.v]){break;}if(x[v.v]){B.addClass(u,l);x[AA.v]=true;}else{B.removeClass(u,l);if(!AA.epd){x[AA.v]=true;}}u=u.nextSibling;}}else{r.outerHTML+=this._buildDescendantsMarkup(AB).join("");}}else{this.fetchItems({branch:AB,level:AB.lv+1});}}else{u=r.nextSibling;while(u){AA=this.getItemFromTarget(u);if(!AA||!z[AA.v]){break;}B.addClass(u,l);u=u.nextSibling;}}this.updateScrollbars();},isHiearachyDisplay:function N(){return true;},fetchItemsThroughTaskCall:mstrmojo.emptyFn,getFlatDisplayItems:mstrmojo.emptyFn});}());(function(){mstrmojo.requiresCls("mstrmojo.dom","mstrmojo.css","mstrmojo.array","mstrmojo.hash");var K=1,B=2;function N(Q,P){return D(Q,P)&&Q.o===P.o;}function D(Q,P){return Q&&P&&Q.ui===P.ui&&Q.axis===P.axis&&Q.mix===P.mix;}function A(U,Q,R){var S=R.getCellTitleId(Q),P=R.getCellUnitIndex(Q);R.selections[S]=R.selections[S]||{};R.selections[S][P]=R.selections[S][P]||[];R.selections[S][P].push(U);M(U,Q,R);}function M(U,Q,R){if(Q){var S=R.getCellTitleId(Q),P=R.getCellUnitIndex(Q);if(!R.selectionsForCopy){R.selectionsForCopy={};}R.selectionsForCopy[S]=R.selectionsForCopy[S]||{};R.selectionsForCopy[S][P]=R.selectionsForCopy[S][P]||[];R.selectionsForCopy[S][P].push(U);C(U);}}function O(Q){var V=Q.selectionsForCopy;for(var U in V){for(var S in V[U]){for(var R=0,P=V[U][S].length;R<P;R++){J(V[U][S][R]);}}}Q.selections={};Q.selectionsForCopy={};}function C(P){mstrmojo.css.setOpacity(P,50);if(P.nodeName.toLowerCase()==="td"&&mstrmojo.dom.isIE8){mstrmojo.css.addClass(P,"showGridBorder");}}function J(P){mstrmojo.css.setOpacity(P,100);if(P.nodeName.toLowerCase()==="td"&&mstrmojo.dom.isIE8){mstrmojo.css.addClass(P,"showGridBorder");}}function F(R,S){if(R.mix===undefined){var W=S.gridData.gts[R.axis===K?"row":"col"],Q=W[R.tui||R.ui],V=0;for(var U=0,P=W.length;U<P;U++){if(W[U].id===Q.id){V++;}}return V;}return 0;}function H(){var Q="_xtabSelectionsHiddenField",P;P=document.getElementById(Q);if(!P){P=document.createElement("textarea");P.id=Q;P.style.opacity=0;P.style.position="absolute";P.style.top=0;P.style.height=0;P.style.width=0;document.body.appendChild(P);}return P;}function G(){var X="",Z={},R,c=[],g=[],Q={},S={},P=this.selectionsForCopy,W=mstrmojo.hash,Y=mstrmojo.array,e=function(h,j){if(h.hasOwnProperty("mix")){return j.es[h.mix].n;}else{return j.n;}},U,a,V,f,d,b=0;W.forEach(P,function(h){W.forEach(h,function(j){Y.forEach(j,function(k){b++;a=k.offsetLeft;V=k.offsetTop;if(!Z[a]){Z[a]={};}R=Z[a];R[V]=k.innerText;if(Y.indexOf(c,a)===-1){c.push(a);}if(Y.indexOf(g,V)===-1){g.push(V);}f=this.getCellForNode(k);d=this.model.getCellTitleInfo(f).title;if((!d.id&&d.axis===K)||(d.id&&d.axis===B)){S[V]=e.call(this,f,d);}else{Q[a]=e.call(this,f,d);}},this);},this);},this);c.sort(function(j,h){return j-h;});g.sort(function(j,h){return j-h;});if(b>1&&!W.isEmpty(S)){X="\t";}if(b>1&&!W.isEmpty(Q)){Y.forEach(c,function(h){X+=(Q[h]||"")+"\t";});X+="\n";}Y.forEach(g,function(h){if(b>1&&!W.isEmpty(S)){X+=(S[h]||"")+"\t";}Y.forEach(c,function(j){X+=(Z[j][h]||"")+(b>1?"\t":"");});if(b>1){X+="\n";}});U=H();U.value=X;U.focus();U.select();}mstrmojo._XtabSelections={lastSelectedTD:null,singleSelectForCopy:function I(P){var V=this.getCellForNode(P),c,d,a,b=V&&V.mix!=undefined,S=function(f,e){e=e||{};f=f||{};if(b){return f.mix==e.mix;}else{return f.mix==e.mix&&f.ui==e.ui;}};a=mstrmojo.dom.findAncestorByName(P,"table",false);d=a.rows;for(var W=0,X=d.length;W<X;W++){var Z=d[W].cells;for(var U=0,R=Z.length;U<R;U++){var Q=Z[U],Y=this.getCellForNode(Q);if(Q!=P&&S(Y,V)){M(Q,Y,this);}}}},singleSelect:function E(Q,Z){var X=this.getCellForNode(Q),g=Q.parentNode;if(Z){var W=this.getCellTitleId(X),c=this.getCellUnitIndex(X);selectedTitle=this.selections[W];selectedUnit=selectedTitle&&selectedTitle[c];if(selectedUnit){for(var Y=0,a=selectedUnit.length;Y<a;Y++){J(selectedUnit[Y]);}delete selectedTitle[c];return ;}}var V=F(X,this);if(X.axis===K){for(var Y=0,P=0,a=g.cells.length;Y<a&&P<V;Y++){var S=g.cells[Y],b=this.getCellForNode(S);if(N(b,X)){A(S,b,this);P++;}}}else{if(X.axis===B){var e=mstrmojo.dom.findAncestorByName(Q,"table",false),f=e.rows;for(var Y=0,P=0,a=f.length;Y<a&&P<V;Y++){var d=f[Y].cells;for(var U=0,R=d.length;U<R;U++){var S=d[U],b=this.getCellForNode(S);if(N(b,X)){A(S,b,this);P++;break;}}}}else{A(Q,X,this);}}},rangeSelect:function L(k,l){var f=this.getCellForNode(k),P=this.getCellForNode(l);if(D(f,P)){if(f.o>P.o||f._ei>P._ei){var o=k;k=l;f=this.getCellForNode(k);l=o;P=this.getCellForNode(l);}var b=F(f,this),Q=f.axis,m=mstrmojo.dom.findAncestorByName(k,"table",false),Y=m.rows,g=k.parentNode,p=g.rowIndex,a=g.cells,d=l.parentNode.rowIndex;if(Q===K){for(var e=p;e<=d;e++){var R=Y[e].cells,S=false;for(var c=0,h=R.length,U=0;c<h&&U<b;c++){var W=R[c],Z=this.getCellForNode(W);if(D(Z,f)){A(W,Z,this);U++;}}}}else{if(Q===B){for(var e=0,h=Y.length,n=0;e<h&&n<b;e++){var R=Y[e].cells,X=false;for(var c=0,V=R.length;c<V;c++){var W=R[c],Z=this.getCellForNode(W);if(N(Z,f)){X=true;}if(X){A(W,Z,this);}if(N(Z,P)){break;}}if(X){n++;}}}else{if(p==d){for(var e=k.cellIndex,h=l.cellIndex;e<=h;e++){var W=a[e],Z=this.getCellForNode(W);A(W,Z,this);}}else{for(var e=p,h=d;e<=h;e++){var R=Y[e].cells;for(var c=0,V=R.length;c<V;c++){var W=R[c],Z=this.getCellForNode(W);if(D(Z,f)){A(W,Z,this);break;}}}}}}}},doSelection:function(X,W,U){var Y=mstrmojo.dom,P=Y.isMetaKey(W,X),Q=Y.shiftKey(W,X);if(!P){O(this);}this.clearAllHighlights();var V=this.getCellForNode(U);var R=V&&(V.mix===undefined&&V.o!==undefined),S=V&&(V.mix!==undefined&&(V._lp||V._tp));if(R||S){if(Q){this.rangeSelect(this.lastSelectedTD,U);}else{this.singleSelect(U,P);this.lastSelectedTD=U;}}else{this.singleSelectForCopy(U,P);}G.call(this);},clearAllHighlights:function(){var Q=this.getCellForNode(this.lastSelectedCell),S=Q&&this.gridData.gts[Q.axis===1?"row":"col"],P=S&&S[Q.tui||Q.ui];var R=P&&P.sc&&P.sc.tks&&P.sc.tks.split("\x1E");if(R&&this.model.docModel.getTargetInfoWin(R).length==R.length){this.clearHighlights();}}};})();(function(){mstrmojo.requiresCls("mstrmojo.string","mstrmojo.expr","mstrmojo.array","mstrmojo.hash");mstrmojo.requiresDescs(308,5923,7930,5282,5283,2793,2787,2788,12298);var D=mstrmojo.string,S=mstrmojo.expr,M=S.ET,L=mstrmojo.array,R=mstrmojo.hash;var V=S.FN,K=S.BRANCH_FNS[V.NOT],Z=mstrmojo.mstr.EnumDSSXMLObjectTypes,H=mstrmojo.mstr.EnumDSSXMLObjectSubTypes,N=mstrmojo.mstr.EnumDSSConsolidationType;function C(a){return D.htmlAngles(a)||"";}var A={betweenText:mstrmojo.desc(308,"and"),atText:mstrmojo.desc(5923,"at"),emptyText:mstrmojo.desc(7930,"Empty condition"),andText:mstrmojo.desc(5282,"AND"),orText:mstrmojo.desc(5283,"OR"),boldandText:"<span style='font-weight:bold;'>"+mstrmojo.desc(5282,"AND")+"</span>",boldorText:"<span style='font-weight:bold;'>"+mstrmojo.desc(5283,"OR")+"</span>",whereText:mstrmojo.desc(2793,"Where (##)"),notText:mstrmojo.desc(12298,"NOT")};var Y={"*":function(b,a){return{html:b?('<span class="mstrmojo-unknown">'+(C(b.n||b.xml)||"...")+"</span>"):null,text:b?(C(b.n||b.xml)||"..."):null};}};function W(a){return !!a.not||a.fn===V.NOT_EQUAL||a.fn===V.NOT_IN_LIST||a.fn===V.NOT_BETWEEN||a.fn===V.NOT;}function I(a){if(a&&a.not){return{html:'<span class="mstrmojo-text mstrmojo-not">'+K+"</span>",text:K+" "};}return{html:"",text:""};}function U(c,b){var a=c&&((b?'<span class="mstrmojo-ListIcon t'+b+'"></span>':"")+'<span class="mstrmojo-text mstrmojo-embedobj">'+C(c)+"</span>");return{html:a,text:c&&((b?b+" ":"")+C(c))};}function Q(a,c){var b=c&&c.trim().split(" ")||[];if(a.t===Z.Attribute&&a.st===H.AttributeRecursive){b.push("recursive");}else{if(a.t===Z.Consolidation&&a.st===H.ConsolidationManaged){b.push("derived");if(a.ndetype===N.DssRecursiveDerivedElement){b.push("recursive");}}}return b.join(" ");}function G(b,a){var c=C(b.n);return{html:'<span class="mstrmojo-text mstrmojo-attr '+Q(b,a)+'">'+c+"</span>",text:c};}Y[M.R]=function(b,a){return U(b.r&&b.r.n,b.r&&b.r.t);};Y[M.F]=function(b,a){return U(b.f&&b.f.n,b.f&&b.f.t);};Y[M.XML]=function(b,a){return U(b.n||b.p&&b.p.n||b.xml,b.p&&b.p.t);};Y[M.AE]=function(q,f){var n=[],m=[],c=(f&&f.elemsEmpty)||"("+mstrmojo.desc(2210,"Empty")+")";if(q&&q.a&&q.a.n){var b=G(q.a);n.push(b.html);m.push("{"+b.text+"}");var a=C(S.fnName(q.et,q.fn,q.fnt));n.push('<span class="mstrmojo-text mstrmojo-fn">'+a+"</span>");m.push(" "+a+" ");var r=q.es,g=r&&r.length||0;if(g){n.push('<span class="mstrmojo-elems">');m.push("[");var j=n.length,p="";for(var o=0;o<g;o++){n[j++]='<span class="mstrmojo-text mstrmojo-elem">';p=C(r[o].n);n[j++]=p;m.push(p);if(o<g-1){n[j++]=", ";m.push(", ");}n[j++]="</span>";}n[j++]="</span>";m.push("]");}else{n.push('<span class="mstrmojo-text mstrmojo-emptyelems">'+c+"</span>");m.push(c);}}return{html:n.join(""),text:m.join("")};};Y[M.AQ]=function(w,z){var u=[],j=[];if(w&&w.a&&w.a.n){var e=G(w.a);u.push(e.html);j.push("{"+e.text+"}");if(w.fm&&w.fm.n){var AA=C(w.fm.n);u.push('<span class="mstrmojo-text mstrmojo-form">'+AA+"</span>");j.push("("+AA+")");if(w.fn!=null){var k=C(S.fnName(w.et,w.fn,w.fnt,w.fm.dtp));u.push('<span class="mstrmojo-text mstrmojo-fn">'+k+"</span>");j.push(" "+k+" ");var l=S.fnCstCount(w.fn,w.fnt);if(w.et===M.AC){if(l>=1){if(w.a2&&w.a2.n){var p=C(w.a2.n);u.push('<span class="mstrmojo-text mstrmojo-attr2">'+p+"</span>");j.push("{"+p+"}");if(w.fm2&&w.fm2.n){var v=C(w.fm2.n);u.push('<span class="mstrmojo-text mstrmojo-form2">'+v+"</span>");j.push("("+v+")");}}if(l>1){u.push('<span class="mstrmojo-text mstrmojo-btwn">'+A.betweenText+"</span>");j.push(" "+A.betweenText+" ");if(w.a3&&w.a3.n){var b=C(w.a3.n);u.push('<span class="mstrmojo-text mstrmojo-attr3">'+b+"</span>");j.push("{"+b+"}");if(w.fm3&&w.fm3.n){var c=C(w.fm3.n);u.push('<span class="mstrmojo-text mstrmojo-form3">'+c+"</span>");j.push("("+c+")");}}}}}else{if(w.et===M.AL){var a=w.cs||[],f=[];for(var q=0,r=a.length;q<r;q++){f.push(a[q].v);}var n=f.join(mstrConfig.listSep);u.push('<span class="mstrmojo-text mstrmojo-c1">'+n+"</span>");j.push("["+n+"]");}else{if(l>=1){var a=w.cs,o=a&&a[0];var x=C(o&&o.p&&o.p.n||o&&o.v);u.push('<span class="mstrmojo-text mstrmojo-c1">'+x+"</span>");j.push(x);if(l>1){var m=a&&a[1];u.push('<span class="mstrmojo-text mstrmojo-btwn">'+A.betweenText+"</span>");j.push(" "+A.betweenText+" ");var g=C(m&&m.p&&m.p.n||m&&m.v);u.push('<span class="mstrmojo-text mstrmojo-c1">'+g+"</span>");j.push(g);}}}}}}}return{html:u.join(""),text:j.join("")};};Y[M.AC]=Y[M.AQ];Y[M.AL]=Y[M.AQ];Y[M.MQ]=function(z,AA){var x=[],n=[],r=z&&z.m,AC=r&&r.n;if(AC){var b=z.fnt,g=S.FNT.PER,w=S.FNT.RANK;AC=b===g?mstrmojo.desc(2787,"Percentage of ##").replace("##",AC):b===w?mstrmojo.desc(2788,"Rank of ##").replace("##",AC):AC;x.push('<span class="mstrmojo-text mstrmojo-metric">'+C(AC)+"</span>");n.push(C(AC));if(z.fn!=null){var o=C(S.fnName(z.et,z.fn,b,S.DTP.REAL));x.push('<span class="mstrmojo-text mstrmojo-fn">'+o+"</span>");n.push(" "+o+" ");var p=S.fnCstCount(z.fn,b);if(z.et==S.ET.MC){if(p>=1){var AB=(z.m2&&z.m2.n)||(z.c2&&z.c2.v)||"?";x.push('<span class="mstrmojo-text mstrmojo-m2">'+C(AB)+"</span>");n.push(C(AB));if(p>1){x.push('<span class="mstrmojo-text mstrmojo-btwn">'+A.betweenText+"</span>");n.push(" "+A.betweenText+" ");var e=(z.m3&&z.m3.n)||(z.c3&&z.c3.v)||"?";x.push('<span class="mstrmojo-text mstrmojo-m3">'+C(e)+"</span>");n.push(C(e));}}}else{if(p>=1){var c=z.cs,t=c&&c[0];var a=function(h){var d=h.v;if(z.fnt==g){if(d.replace){h.v=d.replace(/%$/,"");}d=h.v+"%";}return d;};var l=C(t&&t.p&&t.p.n||t&&t.v&&a(t));x.push('<span class="mstrmojo-text mstrmojo-c1">'+l+"</span>");n.push(l);if(p>1){var q=c&&c[1],m=C(q&&q.p&&q.p.n||q&&q.v&&a(q));x.push('<span class="mstrmojo-text mstrmojo-btwn">'+A.betweenText+"</span>");n.push(" "+A.betweenText+" ");x.push('<span class="mstrmojo-text mstrmojo-c2">'+m+"</span>");n.push(m);}}}var v=z.dmy&&z.dmy.uts,k=v&&v.length;if(k){x.push('<span class="mstrmojo-text mstrmojo-at">'+A.atText+"</span>");n.push(" "+A.atText+" ");x.push('<span class="mstrmojo-dmy">');for(var j=0;j<k;j++){var f=v[j];x.push('<span class="mstrmojo-text mstrmojo-dmyunit">');x.push(C(f.utgt?f.utgt.n:f.n));n.push(C(f.utgt?f.utgt.n:f.n));if(j<k-1){x.push(",");n.push(",");}x.push("</span>");}x.push("</span>");}}}return{html:x.join(""),text:n.join("")};};Y[M.MC]=Y[M.MQ];Y[M.ANDOR]=function(l,c){var j=[],g=[],b=(c&&c.elemsEmpty)||"("+mstrmojo.desc(2210,"Empty")+")",e=R.valarray(S.findTargets(l,"did"))[0],f=true;function m(d){if(!f){j.push('<span class="spliter"></span>');g.push(", ");}f=false;if(d){g.push(mstrmojo.desc(12298,"NOT")+" ");}}if(!e){return{html:'<span class="mstrmojo-text mstrmojo-emptyelems">'+b+"</span>",text:b};}var a=G(e,"andor");j.push(a.html);g.push("{"+a.text+"}");j.push("<span>:</span>");g.push(" : ");j.push('<span class="mstrmojo-elems">');g.push("[");L.forEach(l.nds,function k(n){if(!n){return ;}var d=W(n),u=n.fm,q=n.cs,o,r,h,p;switch(n.et){case M.ANDOR:L.forEach(n.nds,k);break;case M.AE:switch(n.fn){case V.IN_LIST:case V.NOT_IN_LIST:L.forEach(n.es,function(v){m(d);o=d?" not":"";r=C(v.n);j.push('<span class="mstrmojo-text mstrmojo-elem single'+o+'">'+r+"</span>");g.push(r);});break;case V.DESCENDANT:var t=(n.es||[]).slice();if(t.length===0){t.push({n:b});}L.forEach(t,function(w){m(d);o=d?" not":"";r=C(w.n);if(q&&q[0]){var v;p=q[0].v;if(isNaN(p)){h=p.substr(p.indexOf(";")+1);}else{h=mstrmojo.desc(493,"Level")+" "+(parseInt(p,10)+1);}v=h+" "+mstrmojo.desc(12853,"of")+" "+r;j.push('<span class="mstrmojo-text mstrmojo-elem level'+o+'">');j.push(v);g.push(v);}else{j.push('<span class="mstrmojo-text mstrmojo-elem descendant'+o+'">');j.push(C(w.n));g.push(r);}j.push("</span>");});break;}break;case M.AQ:L.forEach(n.cs,function(v){m(d);o=d?" not":"";p=v.v;h=(u&&u.n)?C(u.n+" "+p):"";if(u&&u.n==="LEVEL_NUMBER"){o+=" level";if(isNaN(p)){h=p.substr(p.indexOf(";")+1);}else{h=mstrmojo.desc(493,"Level")+" "+(parseInt(p,10)+1);}}j.push('<span class="mstrmojo-text mstrmojo-elem constant'+o+'">'+h+"</span>");g.push(h);});break;}});j.push("</span>");g.push("]");return{html:j.join(""),text:g.join("")};};function O(f,e){var c=Y[f&&f.et]||Y["*"],b=I(f),d=c&&c(f,e),a=e&&e.emptyText||A.emptyText;return{html:b&&b.html+((d&&d.html)||('<span class="mstrmojo-text empty-cond">'+a+"</span>")),text:b&&b.text+((d&&d.text)||a)};}function F(a){return O(a).text;}function J(e,d,b){if(!e){return null;}var o=e.et,l=e.fn,a=e.nds;if(o===M.ANDOR){var p=b?"bold":"";splitter=l===V.AND?A[p+"andText"]:(l===V.OR?A[p+"orText"]:"");a=[].concat(a);if(a.length<1){return null;}var k=[],q;L.forEach(a,function(r){q=J(r,false,b);if(q){k.push(q);}});var n,m=k.length;if(m<1){return null;}else{if(m===1){n=k[0];}else{n=k.join(" "+splitter+" ");}}n=d||e.not?n:"("+n+")";return e.not?A.notText+" "+n:n;}else{if(o===M.RLS){var j=e.dmy&&e.dmy.uts||[],g=[],f;L.forEach(j,function(r){g.push("{"+r.n+"}");});f=g.join(", ");var c=e.nds&&e.nds[0],h=J(c,false,b);if(h){return"("+f+" "+A.whereText.replace(/\(##\)/g,"").replace(/'##'/g,"")+h+")";}return null;}else{return F(e);}}}function B(a){if(mstrmojo.fe.FilterUtils.isExprEmpty(a)){return{et:14,fn:19};}else{((a&&a.nds)||[]).forEach(function(c,b){a.nds[b]=B(c);});return a;}}mstrmojo.fe.FilterUtils=mstrmojo.provide("mstrmojo.fe.FilterUtils",{getExprXml:function(g){var b="<exp>",a="</exp>",e={a:true,a2:true,a3:true,agg:true,cc:true,ce:true,cgp:true,cs:true,conid:true,desc:true,did:true,attId:true,dmt:true,dmy:true,dtp:true,es:true,et:true,expr:true,f:true,flat:true,flt:true,fm:true,fm2:true,fm3:true,fn:true,fnt:true,fres:true,gb:true,isp:true,items:true,m:true,m2:true,m3:true,n:true,nds:true,not:true,pf:true,p:true,r:true,rps:true,st:true,t:true,utgt:true,utp:true,uts:true,v:true,xml:true,relation:true,applySubExpr:true,useSchema:true,guide:true,rsTp:true,joTp:true,paTp:true,erTp:true,exp:true,joAttrs:true,ph:true,idx:true,idc:true,idcsi:true,ucfg:true,node:true},d={getArrItemName:function(h){return h.substr(0,h.length-1);},isSerializable:function(t,q,p){if(t==="xml"){var k=q[p].xml;return{att:'hasXML = "-1"',child:k};}else{if(mstrmojo.array.indexOf(["header_format","grid_format","child_header_format","child_grid_format"],t)>-1){var u=q[p][t];if(!u){return{};}var m="<"+t+">";for(var r in u){m+="<prs n='"+r+"'>";var l=u[r];for(var h in l){var o=l[h];m+="<pr n='"+h+"' v='"+(o==="pru"?"":o)+"'";m+=o==="pru"?' pru="1"':"";m+="/>";}m+="</prs>";}m+="</"+t+">";return{child:m};}else{if(t==="cs"){var j=q[p],n=q[p][t];if(j&&j.fnt&&j.fnt==S.FNT.PER&&n){if(n[0]){n[0].v+="%";}if(n[1]){n[1].v+="%";}}return true;}else{if(t==="c2"||t==="c3"){var j=q[p];if(j&&j.et==S.ET.MC&&(j.fn==S.FN.BETWEEN||j.fn==S.FN.NOT_BETWEEN)){return true;}else{return false;}}}}}return(e[t])?true:false;},skipNull:true},c=B(g);if(!c||c.et!=M.ANDOR||c.fn===V.NOT||c.not){c={et:M.ANDOR,fn:S.FN.AND,nds:c?[c]:[]};}var f=D.json2xml("nd",[{},c],d);return b+f+a;},isExprEmpty:function(a){return(!a||(a.et===M.ANDOR&&(a.nds||[]).length<1));},getExprConditionNodeHtml:function E(a){return O(a).html;},getExprConditionNodeText:function F(a){return O(a).text;},getExprNodeHtmlAndText:function P(b,a){return O(b,a);},getExprText:function X(b,a){return J(b,true,a);}});}());(function(){mstrmojo.requiresCls("mstrmojo.hash","mstrmojo.array","mstrmojo.expr","mstrmojo.elementHelper","mstrmojo.mstr.EnumNodeProperties","mstrmojo.EnumSelectionType");var k=mstrmojo.array,U=mstrmojo.hash,Q=mstrmojo.expr,f=mstrmojo.elementHelper,Z=Q.ET,E=Q.FN,m=Q.DTP,C=mstrmojo.mstr.EnumNodeProperties,c=mstrmojo.EnumSelectionType;var AE=0,F=1,M=2,K=3,d=4,u=5;var n=0,AF="u;",Y="LEVEL_NUMBER",X=false,J=7;function AD(AH){return AH.t===47&&AH.st===12033;}function S(AH,AI){if(AH&&AI&&AI.t===J){return AH.parent===AI&&AH.lv===AI.lv;}return false;}function l(AH){if(AH&&AH.t===J){return k.filter(AH.children,function(AI){return AI.lv===AH.lv;});}return[];}function AC(AH){return !!AH.not||AH.fn===E.NOT_IN_LIST||AH.fn===E.NOT_EQUAL;}function z(AH){return U.copyProps(["did","n","t","st"],AH);}function P(AK,AH){var AJ=AD(AH),AL=AJ?AK.v:f.terseLong2OldShort(AK.v),AI={v:AL.replace(/\\:/g,"*:"),n:AK.n};if(AJ){AI.t=AK.t;AI.conid=AH.did;}return AI;}function R(AK,AI){if(parseInt(AK,10)>=0){var AJ=AI.lvfs||[],AH=AJ[AK]&&AJ[AK].lvfn||"";return{v:AH?AK+";"+AH:AK,dtp:AH?m.CHAR:m.INTEGER};}return null;}function x(AK,AM,AJ){var AH=f.getIdPresentation(AK),AI=AD(AJ);AK=AK.replace(/\*:/g,"\\:");switch(AM){case"old":case"oldLong":switch(AH){case"old":case"oldLong":return AK;case"terse":case"terseLong":switch(AK[0]){case"V":return AK.substring(1).split(";")[0];case"n":return"HF:"+ +f.terseLong2OldShort(AK)+":47";default:return f.terseLong2OldShort(AK);}}break;case"terse":case"terseLong":switch(AH){case"old":return AI?("V"+AK+";"+AJ.did):f.oldShort2terseLong(AK,"h");case"oldLong":switch(AK.substring(0,2)){case"HF":var AL=AK.substr(3).split(":");if(AL.length>3){AL.pop();}return f.oldShort2terseLong(AL.join(":"),"n");default:return AK;}case"terse":case"terseLong":return AK;}break;default:return AK;}}function t(AH){if(isNaN(AH)&&typeof AH==="string"){return parseInt(AH.split(";")[0],10);}return parseInt(AH,10);}function o(AH){return !AH||AH.lv>0&&!AH.parent;}function a(AH,AP,AO){var AM=AO.item,AJ=AO.ancestorMap,AN=AO.descendantMap,AI=this.getItemByValue(AH.itemValue),AL=this.getItemByValue(AP.itemValue),AK=function(AQ,AR){if(AM&&AM===AQ&&AN){return AN[AR.v];}if(AM&&AM===AR&&AJ){return AJ[AQ.v];}while(AR){if(AQ===AR){return true;}AR=AR.parent;}return false;};switch(AH.func){case c.ALL:return AP.func===c.ALL?AE:K;case c.ELEMENT:switch(AP.func){case c.ALL:return M;case c.ELEMENT:return AI===AL?AE:S(AI,AL)?M:S(AL,AI)?K:u;case c.BRANCH:return AK(AL,AI)?M:S(AL,AI)?d:o(AI)?F:u;case c.LEVEL:return AI.lv===AP.level?M:u;case c.BRANCH_LEVEL:return AI.lv!==AP.level?u:o(AI)?F:AK(AL,AI)?M:u;}break;case c.BRANCH:switch(AP.func){case c.ALL:return M;case c.ELEMENT:return AK(AI,AL)?K:S(AI,AL)?d:o(AL)?F:u;case c.BRANCH:return AI===AL?AE:(o(AI)||o(AL))?F:AK(AL,AI)?M:AK(AI,AL)?K:u;case c.LEVEL:return AI.lv<=AP.level?d:u;case c.BRANCH_LEVEL:return AI===AL?K:(o(AI)||o(AL))?F:AK(AI,AL)?K:(AK(AL,AI)&&AP.level>=AI.lv)?d:u;}break;case c.LEVEL:switch(AP.func){case c.ALL:return M;case c.ELEMENT:return AL.lv===AH.level?K:u;case c.BRANCH:return AL.lv<=AH.level?d:u;case c.LEVEL:return AH.level===AP.level?AE:u;case c.BRANCH_LEVEL:return AH.level===AP.level?K:u;}break;case c.BRANCH_LEVEL:switch(AP.func){case c.ALL:return M;case c.ELEMENT:return AL.lv!==AH.level?u:o(AL)?F:AK(AI,AL)?K:u;case c.BRANCH:return AI===AL?M:(o(AI)||o(AL))?F:AK(AL,AI)?M:(AK(AI,AL)&&AH.level>=AL.lv)?d:u;case c.LEVEL:return AH.level===AP.level?M:u;case c.BRANCH_LEVEL:return AH.level!==AP.level?u:AI===AL?AE:(o(AI)||o(AL))?F:AK(AL,AI)?M:AK(AI,AL)?K:u;}break;}return F;}function D(AI,AM,AJ,AN,AH){var AL=(AI.fs||[]).filter(function(AO){return(AO.n||AO.fnm)===Y;})[0],AK=k.ensureArray(AJ).map(function(AO){return P(AO,AI);});switch(AM){case c.ELEMENT:if(AK.length>0){return{et:Z.AE,fn:AH?E.NOT_IN_LIST:E.IN_LIST,a:z(AI),es:AK};}break;case c.BRANCH:if(AK.length>0){return{et:Z.AE,fn:E.DESCENDANT,not:AH,a:z(AI),es:AK};}break;case c.LEVEL:if(AL&&parseInt(AN,10)>=0){return{et:Z.AQ,fn:E.EQUAL,not:AH,a:z(AI),fm:{did:AL.did||AL.fid,n:Y,dtp:Q.mapBaseFormTypeToDataType(AL.bftp)},cs:[R(AN,AI)]};}break;case c.BRANCH_LEVEL:if(AK.length>0&&parseInt(AN,10)>=0){return{et:Z.AE,fn:E.DESCENDANT,not:AH,a:z(AI),es:AK,cs:[R(AN,AI),{v:18,dtp:m.INTEGER}]};}break;}return null;}function B(){var AH={};this.selectionList.forEach(function(AJ,AI){if(AJ.func===c.ELEMENT){AH[AJ.itemValue]=AI;var AK=this.getItemByValue(AJ.itemValue);k.forEach(l(AK),function(AL){AH[AL.v]=AI;});}},this);return AH;}function v(){var AH={};this.selectionList.forEach(function(AJ,AI){if(AJ.func===c.BRANCH){AH[AJ.itemValue]=AI;}});return AH;}function A(){var AH={};this.selectionList.forEach(function(AJ,AI){if(AJ.func===c.LEVEL){AH[AJ.level]=AI;}});return AH;}function j(){var AH={};this.selectionList.forEach(function(AK,AI){if(AK.func===c.BRANCH_LEVEL){var AL=AK.itemValue,AM=AK.level,AJ=AH[AL];if(!AJ){AJ=AH[AL]={};}AJ[AM]=AI;}});return AH;}function W(AJ){var AI=v.call(this),AH=n;while(AJ&&AJ.v){AH=Math.max(AH,AI[AJ.v]||n);AJ=AJ.parent;}return AH;}function q(AJ,AL){var AH=j.call(this),AK=A.call(this),AI=AL?n:W.call(this,AJ),AN=AJ&&AJ.lv||0,AM={};if(!AL){U.forEach(AK,function(AP,AO){if(AO>=AN&&AP>AI){AM[AO]=AP;}});}while(AJ&&AJ.v){U.forEach(AH[AJ.v],function(AP,AO){if(AO>=AN&&AP>AI){AM[AO]=Math.max(AP,AM[AO]||AI);}});AJ=AJ.parent;}return AM;}mstrmojo.ui._HierarchyListSelection=mstrmojo.provide("mstrmojo.ui._HierarchyListSelection",{_mixinName:"mstrmojo.ui._HierarchyListSelection",init:function w(AH){this._super(AH);this.clearSelections();},getAllSelection:function I(){return !this.selectionList[n].isNot;},setAllSelection:function g(AH){this.selectionList[n].isNot=!AH;},clearSelections:function h(){this.selectionList=[{func:c.ALL,isNot:!X}];return this.selectionList;},addSelection:function V(AH){var AL=this.selectionList,AJ=this.getItemByValue(AH.itemValue),AI={item:AJ,ancestorMap:AJ&&this.getItemAncestorMap(AJ),descendantMap:AJ&&this.getItemDescendantMap(AJ)},AK=true;if(!AJ&&(AH.func===c.ELEMENT||AH.func===c.BRANCH||AH.func===c.BRANCH_LEVEL)){return ;}AL=this.selectionList=AL.filter(function(AM){var AO=a.call(this,AM,AH,AI),AN=AM.isNot===AH.isNot;if(AO===K||AO===d&&!AN){AK=!AN;}return !(AO===AE||AO===M);},this);if(AK){AL.push(AH);}},updateSiblingItemSelection:function p(AI){var AK=this.selectionList,AH=B.call(this),AJ=v.call(this);k.forEach(AI,function(AP){var AM=AP.parent,AL=AM?W.call(this,AM):n,AN=AM?q.call(this,AM):A.call(this),AO=Math.max(AJ[AP.v]||n,AL),AQ=Math.max(AH[AP.v]||n,AO,AN[AP.lv]||n);AP.isSelected=!AK[AQ].isNot;AP.isBranchSelected=!AK[AO].isNot;},this);},updateItemSelection:function N(AI){var AQ=this.selectionList,AJ=B.call(this),AR=v.call(this),AM=A.call(this),AN=j.call(this),AK=AI?[AI]:this.getRootItems(),AL=AI?[]:this.getItems().filter(function(AS){return AS&&o(AS);}),AH=AI?W.call(this,AI):n,AP=AI?q.call(this,AI,true):{};(AK.concat(AL)).forEach(function AO(AW){var AU=AH,AT=U.copy(AP);AH=Math.max(AH,AR[AW.v]||n);U.forEach(AN[AW.v],function(AZ,AY){AP[AY]=Math.max(AZ,AP[AY]||n);});var AX=Math.max(AJ[AW.v]||n,AM[AW.lv]||n,AH,AP[AW.lv]||n);AW.isSelected=!AQ[AX].isNot;AW.isBranchSelected=!AQ[AH].isNot;k.forEach(AW.children,function(AY){AO.call(this,AY);},this);var AV=l(AW);if(AV.length>0){var AS=k.find(AV,"isSelected",true)>=0;if(AW.isSelected!==AS){this.addSelection({func:c.ELEMENT,itemValue:AW.v,isNot:!AS});AW.isSelected=AS;}}AH=AU;AP=AT;},this);},updateDescendantsStatus:function AG(){var AM=this.selectionList,AH=this.getMaxLevel(),AK=v.call(this),AI=j.call(this),AJ=n,AN=A.call(this);this.getRootItems().forEach(function AL(AX){var AP=AX.children||[],AT=AX.displayChildren||[],AV=AJ,AW=U.copy(AN),AQ=false;AJ=Math.max(AJ,AK[AX.v]||n);U.forEach(AI[AX.v],function(AZ,AY){AN[AY]=Math.max(AZ,AN[AY]||n);});AP.forEach(function(AY){if(AL(AY)||!AY.hid&&AY.isSelected){AQ=true;}});if(AX.hcd&&AT.length===0){var AR=!AM[AJ].isNot,AU,AO;for(var AS=AX.lv+1;AS<=AH;AS++){AU=AN[AS]||n;AO=AU>AJ&&!AM[AU].isNot;if(AO||AR&&AU<=AJ){AQ=true;break;}}}AX.hasDsctSelected=AQ;AJ=AV;AN=AW;return AQ;});},getMaxLevel:function b(){var AH=0;this.getItems().forEach(function(AI){var AJ=AI.lv;if(AJ>AH&&!AI.hid){AH=AJ;}});this.selectionList.forEach(function(AI){if(AI.func===c.LEVEL||AI.func===c.BRANCH_LEVEL){AH=Math.max(AH,AI.level);}});return AH;},getLevelSelection:function G(AH){var AL=this.selectionList,AJ=AH?q.call(this,AH):A.call(this),AI=AH?AH.isBranchSelected:this.getAllSelection(),AK={};U.forEach(AJ,function(AO,AN){var AM=!AL[AO].isNot;if(AM!==AI){AK[AN]=AM;}});return U.copy({allLevel:AI,isLevelSelected:function(AM){return this[AM]||this.allLevel&&this[AM]!==false;}},AK);},buildSelectionExprJSON:function e(AJ){var AL=this.getAllSelection(),AI=[],AM=null,AK={selected:[],unselected:[]},AH=function(AN,AO){if(!U.isEmpty(AO)&&(AN.length>0||AL===AC(AO))){AN.push(AO);}};this.selectionList.forEach(function(AO){var AQ=AO.func,AN=AO.isNot,AS=AO.level,AR=AO.itemValue,AP=AR?this.getItemByValue(AR):null;if((AP||{}).fetcher){return ;}if(AO.func===c.ELEMENT&&!o(AP)){AK[AN?"unselected":"selected"].push(AP);}else{if(AO.func!==c.ALL){AH(AI,D(AJ,AQ,AP,AS,AN));}}},this);AH(AI,D(AJ,c.ELEMENT,AK.selected));AH(AI,D(AJ,c.ELEMENT,AK.unselected,null,true));if(AI.length>0){AM=AI[0];AI.forEach(function(AQ,AN,AP){var AO=AC(AQ);if(AN>0){if(AO===AC(AP[AN-1])&&AM.nds){AM.nds.push(AQ);}else{AM={et:Z.ANDOR,fn:AO?E.AND:E.OR,nds:[AM,AQ]};}}});}if(AM){if(AM.et===Z.ANDOR){AM.node=C.CONDITION;}else{AM={et:Z.ANDOR,fn:E.AND,nds:[AM],node:C.CONDITION};}}return AM;},setSelectionByExprJSON:function r(AJ){var AK=this.clearSelections(),AI=false,AH=this.getItems(),AM=f.getIdPresentation(AH[0]&&AH[0].v),AL=function(AO,AP){if(U.isEmpty(AO)){return ;}if(AO.et===Z.ANDOR){(AO.nds||[]).forEach(function(AQ){AL.call(this,AQ,AP);},this);}else{var AN=AC(AO);if(!AI){AI=true;this.setAllSelection(AN);}if(AO.et===Z.AQ&&AO.fm&&AO.fm.n===Y){(AO.cs||[]).forEach(function(AR){var AQ=t(AR.v);if(AQ>=0){AP.push({func:c.LEVEL,level:AQ,isNot:AN});}});}if(AO.et===Z.AE){(AO.es||[]).forEach(function(AQ){var AR=x(AQ.v,AM,AO.a),AS=t(AO.cs&&AO.cs[0].v);if(!this.getItemByValue(AR)){this.addItems([U.copy({v:AR,dhid:true},U.clone(AQ))],true);}if(AO.fn===E.DESCENDANT){if(AS>=0){AP.push({func:c.BRANCH_LEVEL,itemValue:AR,level:AS,isNot:AN});}else{AP.push({func:c.BRANCH,itemValue:AR,isNot:AN});}}else{AP.push({func:c.ELEMENT,itemValue:AR,isNot:AN});}},this);}}};AL.call(this,AJ,AK);this.updateItemSelection();},setSelectionByList:function L(AI,AH){var AJ=[],AK=false;k.forEach(AI,function(AL){var AM=AL.v;if(AM===AF){AK=true;return false;}if(!this.getItemByValue(AM)){this.addItems([AL],true);}AJ.push({func:c.ELEMENT,itemValue:AM,isNot:!AH});},this);this.clearSelections();if(!AK){this.setAllSelection(!AH);this.selectionList=this.selectionList.concat(AJ);}this.updateItemSelection();},onSelectionChange:function O(AI,AH,AJ,AK){if(AI===c.ALL){this.clearSelections();this.setAllSelection(AH);}else{this.addSelection({func:AI,itemValue:AJ&&AJ.v,level:AK,isNot:!AH});}if(this.postSelectionChange){this.postSelectionChange();}},postAddItems:function H(AH){this.updateItemSelection();},postAddSiblingItems:function AB(AI,AH){this.updateSiblingItemSelection(AI);},postAddBranchItems:function AA(AI,AH){this.updateItemSelection(AH);}});}());(function(){mstrmojo.requiresCls("mstrmojo.locales","mstrmojo.expr","mstrmojo.date","mstrmojo.num","mstrmojo.string");mstrmojo.validation={STATUSCODE:{UNKNOWN:-1,VALID:0,INVALID:1,INVALID_EMPTY:2,INVALID_CHAR:3,INVALID_OUTOFRANGE:4,INVALID_REGEX:5,INVALID_VALIDATOR:6,INVALID_BAD_NUMERICFORMAT:7,INVALID_BAD_DATESTRING:8},TRIGGER:{NONE:0,ONBLUR:1,ONKEYUP:2,VALUESET:4,ALL:7},REGEXP:{US_ZIP:/^\d{5}([\- ]?\d{4})?$/,EMAIL_ADDRESS:/^([a-zA-Z0-9_\.\-])+@(([a-zA-Z0-9\-])+[\.])+([a-zA-Z0-9]{2,4})+$/,SOCIAL_SECURITY_NUMBER:/^((?!000)(?!666)\d{3})(\s|\-)?((?!00)\d{2})\2((?!0000)\d{4})$/,PHONE_NUMBER:/^(?!-)[ \d\-\(\)\.\+]+$/,FILE_NAME:new RegExp('^[^:*?"<>|/\\\\()]+$'),FOLDER_PATH_WIN:new RegExp('^([a-zA-Z]:|\\\\\\\\[^:*?"<>|/\\\\]+|[^:*?"<>|/\\\\]*)(\\\\[^:*?"<>|/\\\\]+)*(\\\\){0,1}$'),FOLDER_PATH_UNIX:new RegExp('^(/){0,1}([^:*?"<>|/\\\\]+/)*([^:*?"<>|/\\\\]+){0,1}$'),PRINTER_PATH_SINGLE:new RegExp('^[^$%:*?"<>|/\\\\]*$'),PRINTER_PATH_MULTIPLE:new RegExp('^((/|\\\\\\\\)[^$%:*?"<>|/\\\\]+)((/|\\\\)[^$%:*?"<>|/\\\\]+)*(/|\\\\){0,1}$')}};var H=mstrmojo.validation,B=H.TRIGGER,c=H.STATUSCODE,A={"-1":-1,1:1,2:1,3:2,4:2,5:2,6:2,7:2,8:3,9:3,10:3,11:4,12:4,13:4,14:6,15:6,16:6,17:3,18:3,21:2,22:2,23:3,24:4,25:3,30:5,34:5};H.VALIDATOR={DEMO:function N(f){var e=parseInt(f,10),g=mstrmojo.validation.STATUSCODE;if(e===0||e===1||e>10){return{code:g.VALID};}return{code:g.INVALID,msg:"This field must be either 0, 1 or greater than 10"};},VALIDATE_PHONENO:function I(e){var f=String(e).replace(/[^\d]/g,"");if(f.length<10){return{code:c.INVALID,msg:mstrmojo.desc(9203,"A telephone number must contain at least 10 digits.")};}if(!H.REGEXP.PHONE_NUMBER.test(e)){return{code:c.INVALID,msg:mstrmojo.desc(9204,"The telephone number contains invalid characters.")};}return{code:c.VALID};},VALIDATE_ZIPCODE:function G(e){var g="",f=this.dtp;if(!H.REGEXP.US_ZIP.test(e)){if(H.isNumeric(f)||H.isInt(f)){g=mstrmojo.desc(9208,"A zip code must be 5 digits or 5+4 digits.");}else{if(H.isString(f)){g=mstrmojo.desc(9206,"The zip code is invalid");}}return{code:c.INVALID,msg:g};}return{code:c.VALID};},VALIDATE_EMAIL:function U(e){var f=e.indexOf("@");if(f===-1){return{code:c.INVALID,msg:mstrmojo.desc(9197,"The email address is missing an at sign (@).")};}if(e.substring(f).indexOf(".")===-1){return{code:c.INVALID,msg:mstrmojo.desc(9198,"The email address is missing a period on the domain.")};}return H.REGEXP.EMAIL_ADDRESS.test(e)?{code:c.VALID}:{code:c.INVALID,msg:mstrmojo.desc(9207,"The email address is invalid.")};},VALIDATE_SSN:function Q(e){var g=this.dtp,f;if(H.isNumeric(g)||H.isInt(g)){f=String(e).replace(/[^\d]/g,"");if(f.length!==9){return{code:c.INVALID,msg:mstrmojo.desc(9209,"A Social Security Number must be 9 digits.")};}}if(!H.REGEXP.SOCIAL_SECURITY_NUMBER.test(e)){return{code:c.INVALID,msg:mstrmojo.desc(9210,"The Social Security Number is invalid.")};}return{code:c.VALID};}};H.isInt=function D(e){return A[e]===1;};H.isNumeric=function Z(e){return A[e]===2||A[e]===5;};H.isString=function J(e){return A[e]===3;};var C=window.mstrConfig,L=C.listSep,S=mstrmojo.expr,M=S.DTP,a=mstrmojo.num,V=mstrmojo.string,F=mstrmojo.date;function P(m,n){var j=m.dtp,l=m.constraints,p=l.allowedFormatChars||"",h=(A[j]===1),e=H.isNumeric(j),f=(A[j]===6),o=mstrmojo.locales.number.THOUSANDSEPARATOR,g=mstrmojo.locales.number.DECIMALSEPARATOR,k;if(h){if(!m._intRegExp){p+="0-9-"+(m.isList?L:"")+o;m._intRegExp=new RegExp("[^"+p+"]");}k=m._intRegExp;}if(e){if(!m._numericRegExp){p+="0-9-#"+(m.isList?L:"")+g+o;m._numericRegExp=new RegExp("[^"+p+"]");}k=m._numericRegExp;}return !!k&&k.test(n);}function d(m,o){var j=m.dtp,l=m.constraints,h=(A[j]===1),e=H.isNumeric(j),f=(A[j]===6),g=l.min,n=l.max,k;if(g===undefined&&n===undefined){return false;}if(h||e){if(a.isBigDecimal(o)){return a.inNumericRange(a.parseBigDecimal(o),g,n)!==0;}return a.inNumericRange(o,g,n)!==0;}if(f){return F.inDateTimeRange(o,g,n)!==0;}return false;}function K(f,e){return !a.isNumeric(e)&&!a.isBigDecimal(e);}function R(h,f){var g=(h.dtp===M.DATE),e=(h.dtp===M.TIME);return(g?!F.isDate(f):(e?!F.isTime(f):!F.isDateAndOrTime(f)));}mstrmojo._CanValidate=mstrmojo.provide("mstrmojo._CanValidate",{constraints:null,required:false,dtp:M.INTEGER,isList:false,autoFormat:false,validationStatus:null,init:function X(e){this._super(e);if(!this.constraints){this.constraints={};}var f=this.constraints;if(!f.hasOwnProperty("trigger")){f.trigger=B.NONE;}},_set_value:function(k,g){var h=this.value,f=(h!==g);if(f){this.value=g;var j=this.constraints.trigger,e=(j&B.VALUESET)>0;if(e){this.validate(g);}}return f;},validate:function O(){var g=(this.value!==null&&this.value!==undefined)?this.value:"",k=this.isList?g.split(L):[g],j,f,l,e=k.length,h;for(h=0;h<e;h++){j=this.doValidation(k[h]);f=(j.code>c.VALID);if(f){if(e>1){j.msg=mstrmojo.locales.validation.invalidValueInListError.replace("#",k[h]||" ");}break;}}l=f?"onInvalid":"onValid";if(!f&&this.autoFormat){this.format();}this.set("validationStatus",j);if(this[l]){this[l](j);}},format:function Y(){var k=this.dtp,g=(A[k]===6);if(!g){return ;}var m=mstrConfig.listSep,p=this.value||"",f=this.isList?p.split(m):[p],o=k===14,n=[],e,h=mstrmojo.locales.datetime,l=f.length,j;for(j=0;j<l;j++){p=f[j];e=F.parseDateAndOrTime(p);if(e){if(o&&e.date){n.push(F.formatDateInfo(e.date,h.DATEOUTPUTFORMAT));}else{n.push((e.date?F.formatDateInfo(e.date,h.DATEOUTPUTFORMAT):"")+" "+(e.time?F.formatTimeInfo(e.time,h.TIMEOUTPUTFORMAT):""));}}}this.set("value",n.join(m));},isValid:function W(){var e=this.validationStatus;if(!e){this.validate();}return this.validationStatus.code===c.VALID;},clearValidation:function b(){this.set("validationStatus",{code:c.VALID});if(this.onClearValidation){this.onClearValidation();}},doValidation:function E(t){var o=this.constraints,p=o.regExp,g=o.validator,e={id:this.id,code:c.VALID,msg:""},n=this.dtp,m=(A[n]===1),f=H.isNumeric(n),h=(A[n]===3),j=(A[n]===6),l=V.isEmpty(t),q=String(t).length,k="",w=mstrmojo.locales.validation;if(this.required&&l){e.code=c.INVALID_EMPTY;e.msg=w.requiredFieldError;return e;}t=V.trim(t);if(!l&&P(this,t)){if(m){k=w.integerDataType;}if(f){k=w.numericDataType;}if(j){k=w.dateDataType;}e.code=c.INVALID_CHAR;e.msg=w.invalidCharError.replace("#",k);return e;}if(!l&&j&&R(this,t)){e.code=c.INVALID_BAD_DATESTRING;e.msg=w.invalidDateStringError;return e;}if(!l&&(f||m)&&K(this,t)){e.code=c.INVALID_BAD_NUMERICFORMAT;e.msg=w.invalidNumericFormatError;return e;}if(!l&&(m||f||j)&&d(this,t)){e.code=c.INVALID_OUTOFRANGE;if(o.min!==null&&o.max!==null){k=w.outofRangeError.replace("# ","").replace("##",a.toLocaleString(o.min)).replace("###",a.toLocaleString(o.max));}else{if(o.min!==null){k=w.noLessMinError.replace("##",a.toLocaleString(o.min)).replace("# ","");}else{if(o.max!==null){k=w.noGreaterMaxError.replace("###",a.toLocaleString(o.max)).replace("# ","");}}}e.msg=k;return e;}if(h&&o.minLen!==null&&o.maxLen!==null){if(q<o.minLen||q>o.maxLen){e.code=c.INVALID;e.msg=mstrmojo.desc(9211).replace(/#/,o.minLen).replace(/##/,o.maxLen);return e;}}if(p&&!p.test(t)){e.code=c.INVALID_REGEX;e.msg=mstrmojo.desc(9205);return e;}var u=g&&g.apply(this,[t]);if(u){e.code=u.code;e.msg=u.msg;return e;}return e;}});}());(function(){mstrmojo.requiresCls("mstrmojo.dom","mstrmojo.num","mstrmojo.array","mstrmojo.DICFactory");var F=1,J=0,M=1,O=2,G=".",I=mstrmojo.dom,K=mstrmojo.css,E=mstrmojo.hash,D=mstrmojo.Enum_Keys.TAB,H=function(R){return(R>=1&&R<=7)||R==21||R==22||R==30;},C=function(V,S){if(I.isIE&&!/px$/.test(S)){var R=document.createElement("img"),U;R.style.zIndex=-1;R.style.left=S;V.appendChild(R);U=R.style.pixelLeft;V.removeChild(R);return U+"px";}return S;},B=function(R,S){return parseInt(C(R,K.getStyleValue(R,S)),10)||0;},N=function(R){return{lp:B(R,"paddingLeft"),rp:B(R,"paddingRight"),tp:B(R,"paddingTop"),bp:B(R,"paddingBottom")};},Q=function(S){var R=K.getComputedStyle(S)||S.currentStyle;return{fontFamily:R.fontFamily,fontSize:C(S,R.fontSize),fontStyle:R.fontStyle,fontVariant:R.fontVariant,fontWeight:R.fontWeight,textAlign:R.textAlign};},P=function(U,R){var S=mstrmojo.findAncestor(U,"scriptClass","mstrmojo.DocInfoWindow");if(!!S){S[R?"registerLock":"releaseLock"](this);}};mstrmojo._IsInputControl={_mixinName:"_IsInputControl",dic:null,owner:null,openerNode:null,popupStyle:J,items:null,applyOnEnter:true,lv:null,init:function(V){if(this._super){this._super(V);}var X=this.dic,W=X.dt,U=mstrmojo.expr.DTP,S,R=[];if(mstrApp.useBinaryFormat){if(W==U.DATE||W==U.TIME||W==U.TIMESTAMP){S=mstrmojo.date.parseDateAndOrTime(this.value);if(S){if(W!=U.TIME){R.push(mstrmojo.date.formatDateInfo(S.date,mstrmojo.locales.datetime.DATEOUTPUTFORMAT));}if(W!=U.DATE){R.push(mstrmojo.date.formatTimeInfo(S.time,mstrmojo.locales.datetime.TIMEOUTPUTFORMAT));}this.value=R.join(" ");}}}this.lv=this.value;if(X.wm&&X.w===undefined){X.wm=0;}},showByDefault:false,hasPreview:false,getItems:function(){var Z=this.dic,S=[],X,V,R=0,W=String(Z.itv),U=W&&W.indexOf(G),Y=H(Z.dt);if(U>=0){R=W.substring(U+1).length;}if(parseInt(Z.ipt,10)===0){for(X=0,V=Z.min;V<Z.max+0.00001;X++,V+=Z.itv){S[X]={n:mstrmojo.num.toLocaleString(R>0?V.toFixed(R):V),v:V};}}else{S=Z.vls;mstrmojo.array.forEach(S,function(a){if(a.n===undefined){a.n=Y?mstrmojo.num.toLocaleString(a.v):a.v;}});}return S;},font:null,onfontChange:function(){if(this.getInputNode){var R=this.getInputNode(),S=this.font;E.forEach(S,function(V,U){R.style[U]=V;});}},getOpenerNodeStyle:function(){var R=this.group&&this.group.ons,S=this.openerNode;if(!R){R=N(S);R.hp=R.lp+R.rp;R.vp=R.tp+R.bp;R.iw=Math.max(0,S.clientWidth-R.hp);R.ih=Math.max(0,S.clientHeight-R.vp);if(this.group){this.group.ons=R;}}return R;},onvalueChange:function(){if(this._super){this._super();}this.dicChanged=true;if(this.showByDefault&&(!this.isDicWidgetReady||this.isDicWidgetReady())){this.applyChanges();}else{if(this.popupStyle!==J&&this.popup&&this.popup.enableApply){this.popup.enableApply();}}},preBuildRendering:function(){if(this._super){this._super();}this.openerNode=this.openerNode||this.owner.domNode;if(this.showByDefault){this.openerStyle=this.getOpenerNodeStyle();if(this.inlineExtraCssText){this.cssText+=" "+this.inlineExtraCssText;}}if(!this.placeholder){this.placeholder=document.body.appendChild(document.createElement("div"));}},postBuildRendering:function(){var V=this.openerNode;if(this._super){this._super();}if(!mstrmojo.isDescendant(this.owner,this)){if(this.showByDefault){var U=this.domNode;if(!(this.handleDisable()||this.enabled)){var R=document.createElement("div"),S=document.createElement("div");R.className="DIC-Container";S.className="curtain";R.appendChild(U);R.appendChild(S);U=R;}V.innerHTML="";V.appendChild(U);}if(this.dic.t===1||this.dic.t===8){this.set("font",Q(V));}}if(mstrmojo.DICConfig.isKeyNavigable(this.dic)){this.registerKeyEvents(this.domNode);}},applyChanges:function(){var Y=this.lv,R=this.getCurValue?this.getCurValue():this.value,X=this.openerNode,U=this.getDisplayValue?this.getDisplayValue():R,W=this.dic.dt,S=mstrmojo.expr.DTP,V=mstrmojo.locales.datetime;if(String(R)!==String(Y)){if(mstrApp.useBinaryFormat){if(W==S.TIME||W==S.TIMESTAMP){R=R.replace(new RegExp(V.AM_NAME),"AM").replace(new RegExp(V.PM_NAME),"PM");}}this.lv=R;this.dv=U;if(this.owner&&this.owner.dataChanged){this.owner.dataChanged(this.k,Y,{dv:U,v:R},X,this.dic.k);}}return true;},cancelChanges:function A(){this.value=this.lv;},isElementVisible:function L(R){const S=R.getBoundingClientRect();return(S.top>=0)&&(S.left>=0)&&(S.bottom<=(window.innerHeight||document.documentElement.clientHeight))&&(S.right<=(window.innerWidth||document.documentElement.clientWidth));},showInPopup:function(){var S=this.owner;var R=this.openerNode;if(!this.isElementVisible(R)){R.scrollIntoView({block:"nearest"});}this.popup=mstrmojo.DICFactory.createDICPopup(S,this);this.popup.open(S,{widget:this});if(this.focus&&!mstrApp.useBinaryFormat){this.focus();}this.setInfoWindowLock(true);},lockPopup:function(){this.setInfoWindowLock(false);},renderPreview:null,onTabDown:function(R){mstrmojo.dom.preventDefault(window,R);if(this.applyChanges()!==false){if(this.popup){this.popup.close();}this.owner.editNext(this.k);this.cleanup();}},cleanup:mstrmojo.emptyFn,registerKeyEvents:function(S){var R=this;I.attachEvent(S,"keydown",function(U){var V=U||window.event;if(V.keyCode===D){R.onTabDown(U);}});if(I.isIE){I.attachEvent(S,"keyup",function(U){var V=U||window.event;if(V.keyCode===D){R.focus();}});}},setInfoWindowLock:function(R){P.call(this,this.owner,R);},handleDisable:function(){return true;}};}());(function(){mstrmojo.requiresCls("mstrmojo.num","mstrmojo.hash","mstrmojo.string","mstrmojo.array","mstrmojo._FormatDefinition");var B=mstrmojo.num,G=mstrmojo.hash,F=mstrmojo.string,C=mstrmojo.array,E=mstrmojo._FormatDefinition.NumberFormatCategory;mstrmojo.MetricSelectorUtility=mstrmojo.provide("mstrmojo.MetricSelectorUtility",{_GENERIC:1,_RANK:2,_PERCENT:3,OP:{_EQUALS:0,_NOT_EQUALS:1,_GREATER:2,_GREATER_EQUAL:3,_LESS:4,_LESS_EQUAL:5,_BETWEEN:6,_NOT_BETWEEN:7,_IN:8,_NOT_IN:9,_IS_NULL:10,_IS_NOT_NULL:11},OP_NAMES:[{n:mstrmojo.desc(2795,"Equals"),v:0},{n:mstrmojo.desc(2796,"Does not equals"),v:1},{n:mstrmojo.desc(521,"Greater than"),v:2},{n:mstrmojo.desc(522,"Greater than or equal to"),v:3},{n:mstrmojo.desc(523,"Less than"),v:4},{n:mstrmojo.desc(524,"Less than or equal to"),v:5},{n:mstrmojo.desc(696,"Between"),v:6},{n:mstrmojo.desc(746,"Not between"),v:7},{n:mstrmojo.desc(587,"In"),v:8},{n:mstrmojo.desc(2204,"Not In"),v:9},{n:mstrmojo.desc(2202,"Is null"),v:10},{n:mstrmojo.desc(2203,"Is not null"),v:11}],RANK_OP_NAMES:[{n:mstrmojo.desc(529,"Highest"),v:1},{n:mstrmojo.desc(530,"Lowest"),v:2},{n:mstrmojo.desc(4407,"Highest %"),v:3},{n:mstrmojo.desc(4406,"Lowest %"),v:4}],Q:{_G:0,_RT:1,_RB:2,_PT:3,_PB:4},MRPFN:{TOP:1,BOTTOM:2,BETWEEN:3,EXCLUDETOP:4,EXCLUDEBOTTOM:5,NOTBETWEEN:6,EQUALS:7,DIFFERENTFROM:8,EQUALSDESCENDING:15,NOTEQUALSDESCENDING:16,GREATERTHANDESCENDING:4,GREATERTHANEQUALSDESCENDING:18,LESSTHANDESCENDING:20,LESSTHANEQUALSDESCENDING:1,BETWEENDESCENDING:13,NOTBETWEENDESCENDING:14,INDESCENDING:22,NOTINDESCENDING:24,EQUALSASCENDING:7,NOTEQUALSASCENDING:8,GREATERTHANASCENDING:5,GREATERTHANEQUALSASCENDING:17,LESSTHANASCENDING:19,LESSTHANEQUALSASCENDING:2,BETWEENASCENDING:3,NOTBETWEENASCENDING:6,INASCENDING:21,NOTINASCENDING:23},FN:{EQUALS:6,NOTEQUALS:7,GREATERTHAN:8,GREATERTHANEQUALS:10,LESSTHAN:9,LESSTHANEQUALS:11,BETWEEN:17,NOTBETWEEN:44,ISNULL:54,ISNOTNULL:55,IN:22,NOTIN:57,CONTAINS:76,NOTCONTAINS:79,BEGINSWITH:77,NOTBEGINSWITH:80,ENDSWITH:78,NOTENDSWITH:81,LIKE:18,NOTLIKE:43,AND:19,OR:20,NOT:21,RANK:23,RANKPERCENT:59,TUPLE:1000},F:[[6,7,8,10,9,11,17,44,22,57,54,55],[15,16,4,18,20,1,13,14,22,24],[7,8,5,17,19,2,3,6,21,23]],EnumNumberCategory:{Default:-2,Fixed:0,Currency:1,Date:2,Time:3,Percentage:4,Fraction:5,Scientific:6,Custom:7,Special:8,General:9,FromGrid:10},typeHelperCls:{0:"MetricValueSliderHelper",defaultCls:"MetricRankSliderHelper"},ErrorType:{_GENERIC:mstrmojo.desc(11689,"Invalid Number"),_RANK:mstrmojo.desc(11856,"Please enter value between ## and ###.")},ErrorCode:{EmptyValue:"emptyValueVIWarning",InvalidValue:"invalidValueVIWarning",OutOfRange:"outOfRangeVIWarning",NotInteger:"notIntegerVIWarning"},getQuaByFunc:function(L,M){var I=this.F,H=this.Q,K=H._G,J=function(N){return C.indexOf(I[1],N)!==-1;};if(J(L)){K=(M===this._RANK)?H._RT:H._PT;}else{K=(M===this._RANK)?H._RB:H._PB;}return K;},getFuncInfo:function(K,L){var J={},I=this.Q,H=this.F;J[I._G]={ft:this._GENERIC,f:H[0][K]};J[I._RT]={ft:this._RANK,f:H[1][K]};J[I._RB]={ft:this._RANK,f:H[2][K]};J[I._PT]={ft:this._PERCENT,f:H[1][K]};J[I._PB]={ft:this._PERCENT,f:H[2][K]};return J[L]||{};},getOpIdxByfunc:function(J,K){if(!J||!K){return -1;}var H=this.F,I=-1;switch(K){case this._GENERIC:I=C.indexOf(H[0],J);break;case this._RANK:case this._PERCENT:I=C.indexOf(H[1],J);if(I===-1){I=C.indexOf(H[2],J);}break;}return I;},getIncludeByOp:function(I){var H=this.OP;return I===H._EQUALS||I===H._GREATER_EQUAL||I===H._LESS_EQUAL||I===H._BETWEEN||I===H._IN;},formatNumber:function(J,L,I){var M,K=this.Q,N=I.fm,H=I.cat;if(!B.validateFormat(N)){N="#,##0.00;(#,##0.00)";}if(J===K._G){M=(N)?B.formatByMask(N,L):B.format(I.cat,I.dp,I.curr,L);}else{if(J===K._RB||J===K._RT){M=String(parseInt(L,10));}else{if(J===K._PB||J===K._PT){M=parseFloat(L)+"%";}}}if((H===E.Fixed||H===E.Currency||H===E.Percentage)&&L<0&&!F.startsWith(M,"(")&&!F.startsWith(M,"-")){M="-"+M;}return M;},doValidation:function(U,L,P,N){var O=L.qua,R=L.low,K=L.high,M=this.Q,V=O===M._RT||O===M._RB,H=O===M._PT||O===M._PB,S="",J,I=this.ErrorCode;if(F.isEmpty(U)){S=I.EmptyValue;}else{if(!(B.isNumeric(U)||(H&&String(U).match(/^\d+(\.\d+)?%$/))||(N&&!H&&B.isBigDecimal(U)))){S=I.InvalidValue;}else{if((O===M._PT||O===M._PB)&&B.inNumericRange(parseFloat(U),R,K)){S=I.OutOfRange;J=H?["0","100%"]:[R,K];}else{if(V&&(!B.isInt(U)||B.parseInteger(U,10)<0)){S=I.NotInteger;}}}}return G.copy(P,{invalid:!!S,errorCode:S,args:J||[]});},restoreMetricSelectorProps:function D(I,H){if(!I||!H){return ;}G.copyProps(["max","min","cnt","dt","nov"],H,I);},restoreMetricSelectorSelections:function A(I,H){if(!I||!H){return ;}G.copyProps(["f","ft","cs"],H,I);}});}());(function(){mstrmojo.requiresCls("mstrmojo.array","mstrmojo.num","mstrmojo.locales");var D=mstrmojo.array,A=mstrmojo.num,B=mstrmojo.locales;mstrmojo.vi.util.NumberFormatUtility=mstrmojo.provide("mstrmojo.vi.util.NumberFormatUtility",{applyFormatToNumber:function C(P,Q,G){var H="\u00A4",L=/"[^"]*"/g,F=P.match(L),K=P.replace(L,H),O=["m","y","d","h","s"],N=G||false,E=new Date(),M=E.getFullYear(),J=E.getMonth(),I=E.getDay(),S=B.datetime,R;D.forEach(O,function(U){N=N||K.indexOf(U,0)!==-1;});if(N){K=K.replace(/y{3,}/g,M).replace(/y{1,2}/g,M.toString().slice(2,4));K=K.replace(/m{4,}/g,S.MONTHNAME_FULL[J-1]).replace(/m{3}/g,S.MONTHNAME_SHORT[J-1]).replace(/mm/g,"07").replace(/m/g,"7").replace(/7ber/g,"mber");K=K.replace(/d{4,}/g,S.dayNames[I-1]).replace(/d{3}/g,"Mon").replace(/dd/g,"10").replace(/d/g,"1").replace(/1ay/g,"day");K=K.replace(/hh/g,"08").replace(/h/g,"8");K=K.replace(/ss/g,"04").replace(/s/g,"4");K=K.split(H);R=K[0];D.forEach(F,function(V,U){R+=V+K[U+1];});return R;}if(A.isNumeric(Q)){return A.formatByMask(P,A.parseNumeric(Q));}return Q;}});}());(function(){mstrmojo.requiresCls("mstrmojo.Base","mstrmojo.registry","mstrmojo._Provider","mstrmojo.array");var B=mstrmojo.registry,F=mstrmojo.array;mstrmojo.Obj=mstrmojo.declare(mstrmojo.Base,[mstrmojo._Provider],{scriptClass:"mstrmojo.Obj",id:"",init:function I(J){this.disposables=[];this._super(J);B.add(this);if(this.postCreate){this.postCreate();}},addDisposable:function G(M){var K=this.disposables,L,J;if(M.constructor===Array){for(L=0,J=M.length;L<J;L++){K.push(M[L]);}}else{K.push(M);}return M;},destroyDisposables:function D(J){F.forEach(this.disposables,function(K){if(K.destroy){K.destroy(J);}else{if(K.clear){K.clear();}}});this.disposables=[];},throwAbstractMethodError:function A(J){throw new Error(this.scriptClass+" must implement "+J+".");},destroy:function H(J){if(this.destroyed){return ;}this._super(J);this.destroyDisposables(J);B.remove(this);delete this.parent;this.destroyed=true;}});var C=mstrmojo.Obj;C.free=function E(J){if(J instanceof C){J.destroy();}};}());(function(){mstrmojo.requiresCls("mstrmojo.hash","mstrmojo.array","mstrmojo.registry","mstrmojo.publisher","mstrmojo._Provider");var G=mstrmojo.hash,A=mstrmojo.array,B=mstrmojo.registry,D=mstrmojo.publisher;mstrmojo.Arr=mstrmojo.declare(null,[mstrmojo._Provider],{scriptClass:"mstrmojo.Arr",postApplyProperties:null,postCreate:null,length_bindEvents:["add","remove"],init:function H(K){var J;if(K&&K.data){J=K.data;delete K.data;}else{if(K){J=K;K=null;}}if(!J||J.constructor!==Array){J=[];}G.copy(mstrmojo.Arr.prototype,J);if(K){G.copy(K,J);}if(J.postApplyProperties){J.postApplyProperties();}B.add(J);if(J.postCreate){J.postCreate();}return J;},destroy:function E(){D.clearSubscriptions(this.id);B.remove(this);},add:function I(L,J,K){var M=L&&L.length;if(M){if(J==null){J=this.length;}A.insert(this,J,L);if(!K&&(this.onadd||D.hasSubs(this.id,"add"))){this.raiseEvent({name:"add",value:L,index:J});}}},remove:function F(J,L,K){if(L==null){L=1;}if((J!=null)&&L){var M=this.splice(J,L);if(!K&&(this.onremove||D.hasSubs(this.id,"remove"))){this.raiseEvent({name:"remove",value:M,index:J});}}}});mstrmojo.Arr.makeObservable=function C(J,K){if(!J){return ;}if(!K){K={};}K.data=J;return this.prototype.init(K);};})();(function(){mstrmojo.requiresCls("mstrmojo.Obj","mstrmojo.array");var C=mstrmojo.array;mstrmojo.ObjectBrowserDataProvider=mstrmojo.declare(mstrmojo.Obj,null,{scriptClass:"mstrmojo.ObjectBrowserDataProvider",path:mstrConfig.taskURL,serverRequest:function(D,E){if(mstrApp&&mstrApp.serverRequest){mstrApp.serverRequest(D,E,{silent:true});}else{mstrmojo.xhr.request("POST",this.path,E,D,undefined,this.XServer,this.baseParams);}},fetchFolderContents:function(D,E,H){var F=D.blockCount,G={taskId:"searchMetadata",styleName:"MojoFolderStyle",blockCount:F,includeAncestorInfo:"true",includeObjectDesc:D.includeObjectDesc,encodeObjectInfo:false};if(D.folderLinksContextId){G.folderLinksContextId=D.folderLinksContextId;}if(D.sId){G.sessionState=D.sId;}if(E.fid){G.rootFolderID=E.fid;}else{if(E.fty){G.rootFolderType=E.fty;}}if(D.browsableTypes){G.objectType=D.browsableTypes;}if(E.blockBegin){G.blockBegin=E.blockBegin;}if(E.searchPattern){if(D.enableQuickSearch){G.quickSearch=D.enableQuickSearch;}G.searchPattern=E.searchPattern;if(E.recursive){G.recursive=E.recursive;}}this.serverRequest(G,H);},newFolder:function(G,H,F,D){var E={taskId:"createFolder",taskContentType:"json",folderID:G,name:H,description:F};this.serverRequest(E,D);},loadObjects:function B(H,I,D,G){var E=[],F=[];C.forEach(H,function(J){E.push(J.did);F.push(J.t);});if(H.length>0&&G){this.serverRequest({taskId:"getObjectInfo",objectIDs:E.join(","),objectTypes:F.join(","),includeDetails:true},I,D);}else{I.success();}},loadRecentSaveAsFolders:function A(E){var D={taskId:"getRecentSaveAsFolders"};this.serverRequest(D,E);}});}());(function(){mstrmojo.requiresCls("mstrmojo.dom","mstrmojo.hash");mstrmojo.touchManager=new mstrmojo.Obj({notify:function(t,u){return this.raiseEvent({name:"touchesBegin",srcId:t,touch:u});}});var W=mstrmojo.dom,p=W.attachEvent,q=W.detachEvent,B=Math,X=window.mstrConfig,Q=false,J=null,j=X&&X.allowDefaultTouches;var h=10,D=250,F=400,Z=100;var g="Begin",N="End",d="Move",S="Cancel";var m=1,n=2,C=3,P=4;var K={};K[m]="Select";K[n]="Swipe";K[C]="Multi";K[P]="Tap";p(document.body,"touchmove",function(t){if(!X||!X.allowDefaultTouches){if(t.preventDefault){t.preventDefault();return false;}}return true;});function Y(t){var u=t.identifier;return(u===undefined)?1:u;}function k(w,x,v,u){if(Q){var t=u?Y(u)+" ":"";window.console.log(w+":"+(v?" "+v.scriptClass+" "+v.id:"")+" "+t+(x||""));}}function l(t){return(J===t);}function U(t){if(!l(t)){return ;}k("detachWinEvts","",t);q(window,W.TOUCHMOVE,t._tmCallback,true);q(window,W.TOUCHEND,t._teCallback,true);q(window,W.TOUCHCANCEL,t._teCallback,true);J=null;}function V(t){if(l(t)){return ;}var u=J;if(u){k("forced deactivation","",u);U(u);}k("attachWinEvts","",t);p(window,W.TOUCHMOVE,t._tmCallback,true);p(window,W.TOUCHEND,t._teCallback,true);p(window,W.TOUCHCANCEL,t._teCallback,true);J=t;}function M(u,t){return"touch"+((t&&K[t])||"")+(u||"");}function a(v,w,u){var t=M(w,u);return(v[t]!==undefined)?t:"";}function o(w,z,AA,v,u){u=u||w.gestures[AA.id];var x=(u&&u.bubbleTarget)||w,t=a(x,z,v);if(t){k("fire",t,x);AA.methodName=t;return x[t](AA);}k("no handler",M(z,v),x);return true;}function e(AC,AD,t,x){var z=t.pageX,w=t.pageY,AA=AC.timeStamp,u=Y(t),AH={x:B.round(z-AD.pageX),y:B.round(w-AD.pageY)};var AG={id:u,evt:AC,pageX:z,pageY:w,clientX:t.clientX,clientY:t.clientY,target:t.target,delta:AH,date:AA,stop:function(){k("event stopped",u);AC.stopPropagation();AC.cancelBubble=true;}};if(x){var v=AA-x.date,AF=x.delta,AB={x:B.abs(AH.x-AF.x),y:B.abs(AH.y-AF.y)};AG.velocity={x:AB.x/v,y:AB.y/v};AG.isVertical=(AB.y>AB.x);AG.accelDelta=AB;var AE=AG.direction={};if(z!==x.pageX){AE.x=(z<x.pageX);}else{if(z!==AD.pageX){AE.x=(z<AD.pageX);}}if(w!==x.pageY){AE.y=(w<x.pageY);}else{if(z!==AD.pageX){AE.y=(w<AD.pageY);}}}return AG;}function I(w,t,v,u){return{s:w,p1:t,p2:v,evt:u,target:u.target};}function L(u,t){if(u){u.gestures[t]=null;}}function b(u,t){U(u);o(u,N,t);}function G(t){if(t._selectHandle){window.clearTimeout(t._selectHandle);delete t._selectHandle;k("cancelSelect","",t);}}function H(AA,AC){var x=AC.which;if(x&&x===3){k("ignore","right mouse click",AA);return ;}var AB=AA.gestures,z=AC.touches||[AC],t=(AC.changedTouches&&AC.changedTouches[0])||AC,AF=l(AA),AG=e(AC,t,t),AE=I(AG,AG,AG,AC);k("touchBegin","",AA,t);if(z.length>1){if(!AF){AG.stop();k("ignore","cross widget multitouch",AA,t);var w=J;if(w&&w.onCrossWidgetMultitouch!==undefined){k("call onCrossWidgetMultitouch for","",w);w.onCrossWidgetMultitouch();}return false;}}else{if(AF){k("forced deactivation","",AA,t);U(AA);AF=false;}}if(AA.singleNode&&t.target!==AA._tn){k("ignore","target is not touch node",AA,t);return ;}if(mstrmojo.touchManager.notify(AA.id,AG).ignore){AG.stop();return ;}if(!AF){var v=AG.target.tagName;v=v&&v.toLowerCase();if(v==="select"||v==="input"){k("ignore","target is input or select",AA,t);if(AA.monitorInputs){o(AA,null,AG,P);}return ;}}AB[AG.id]=AE;if(AF){if(!AA.multiTouch){G(AA);var u=z[z.length-2],AD=AB[Y(u)];o(AA,S,u,AD.action,AD);}else{AE.action=C;if(AA._singleTouch){G(AA);AA._singleTouch.action=C;delete AA._singleTouch.bubbleTarget;delete AA._singleTouch;o(AA,g,AG,C);}}AG.stop();return ;}if(!W.contains(AA._tn,AC.target,true,AA.domNode)){delete AB[AG.id];return ;}AA._singleTouch=AE;if(o(AA,g,AG)===false){return ;}AG.stop();if(a(AA,g,m)){AA._selectHandle=window.setTimeout(function(){AE.action=m;if(o(AA,g,AG,m)===false){b(AA,AG);}delete AA._selectHandle;},F);}V(AA);}function r(x,z){var AB=(z.changedTouches&&z.changedTouches[0])||z,u=x.gestures[Y(AB)];if(!u){return ;}var v=e(z,u.s,AB,u.p2),w=u.action;u.p2=u.p1;u.p1=v;if(!w&&(B.abs(v.delta.x)>h||B.abs(v.delta.y)>h)){w=u.action=n;G(x);if(!a(x,g,w)&&!a(x,d,w)){v.methodName=M(g,w);return x.bubbleTouchEvent(v);}if(o(x,g,v,w)===false){b(x,v);return ;}}if(w){var t=u.lastMove||u.s.date,AA=v.date-t;if(!mstrApp.isTouchApp()||AA>=Z){u.lastMove=v.date;o(x,d,v,w);}}}function E(x,AA){var t=(AA.changedTouches&&AA.changedTouches[0])||AA,AB=(AA.touches&&AA.touches.length)||0,z=x.gestures,AE=Y(t),AD=z[AE];if(!AD){k("No gesture",AE,x,t);return ;}var w=AD.action,AF=e(AA,AD.s,t,AD.p2);if(!w){G(x);if(!AD.wasMulti){w=P;}}if(AB===0){U(x);x.gestures=[];k("gestures","clear all",x,t);}else{z[AE]=null;k("gestures","clear single",x,t);}L(AD.bubbleTarget,AE);switch(w){case n:case m:AF.stop();o(x,N,AF,w,AD);break;case C:if(AB<2){o(x,N,AF,w,AD);if(AB===1){var v=AA.touches[0],AC=e(AA,v,v),u=I(AC,AC,AC,AA);u.wasMulti=true;z[Y(v)]=u;x._singleTouch=u;}}if(AB>0){return ;}break;case P:if(!a(x,null,w)){break;}var AG=x._tapHandler;if(AG){window.clearTimeout(AG.h);}if(AF.date-AD.s.date<F){if(o(x,"Before",AF,w,AD)===false){break;}if(!x.multiTap){AF.count=1;o(x,null,AF,w,AD);}else{if(AG){AG.count++;}else{AG=x._tapHandler={count:1};}AG.h=window.setTimeout(function(){AF.count=AG.count;o(x,null,AF,w,AD);delete x._tapHandler;},D);}}else{delete x._tapHandler;}break;}o(x,N,AF,undefined,AD);}function c(u){var t=u._tn;if(!t){return ;}if(!u._tmCallback){u._tsCallback=function(v){H(u,v);};u._tmCallback=function(v){r(u,v);};u._teCallback=function(v){E(u,v);};}p(t,W.TOUCHSTART,u._tsCallback);}mstrmojo._TouchGestures=mstrmojo.provide("mstrmojo._TouchGestures",{_mixinName:"mstrmojo._TouchGestures",singleNode:false,multiTouch:false,touchNode:null,multiTap:false,monitorInputs:false,postBuildRendering:function O(){if(this._super){this._super();}this._tn=this.touchNode||this.domNode;this.gestures=[];c(this);},bubbleTouchEvent:function f(AA){var w=AA.methodName,t=AA.id,u=this.gestures[t],v=this.parent;while(v){var z=v[w],x=v.touchBegin;if(z&&(!x||o(v,g,AA)!==false)){AA.methodName=w;L(u.bubbleTarget,t);u.bubbleTarget=v;v.gestures[t]=u;k("bubble",((this.k)?" "+this.k:"")+"] bubbled "+w+" to ["+v.scriptClass+((v.k)?" "+v.k:"")+"]",this,AA);return z.call(v,AA);}v=v.parent;}return false;},unrender:function A(u){if(l(this)){U(this);}var t=this._tn;if(t){W.detachEvent(t,W.TOUCHSTART,this._tsCallback);}this._super(u);},restoreDefaultTouches:function R(t){if(X){X.allowDefaultTouches=t&&j;}}});}());(function(){mstrmojo.requiresCls("mstrmojo.array","mstrmojo.Obj","mstrmojo.string","mstrmojo.hash","mstrmojo.expr","mstrmojo.num","mstrmojo.mstr.EnumNodeDimty");var G=mstrmojo.array,S=mstrmojo.expr,L=S.ET,K=S.TP,D=S.DTP,M=mstrmojo.mstr.EnumNodeDimty,P=S.ET2TGT,O=S.ET2COND,C=mstrmojo.meta.TP,B=mstrmojo.num;function Q(W,A){var V=(A&&A.did)?A.did.split(S.FN_SEP):null,E=V&&parseInt(V[0],10),U=V&&parseInt(V[1],10),X=W.et;W.fnt=E;W.fn=U;if(X!=L.AE&&S.fn_List(U,E)){W.et=L.AL;W.a2=null;W.cs=null;}else{if(X==L.AL&&!S.fn_List(U,E)){W.et=L.AQ;W.cs=null;}else{if(X==L.MC&&!S.fn_AC_MC(U,E)){W.et=L.MQ;W.m2=null;}else{if(X==L.AC&&!S.fn_AC_MC(U,E)){W.et=L.AQ;W.a2=null;}}}}switch(U){case S.FN.IS_NULL:case S.FN.IS_NOT_NULL:W.a2=null;W.a3=null;W.fm2=null;W.fm3=null;W.m2=null;W.m3=null;W.cs=null;break;case S.FN.BETWEEN:case S.FN.NOT_BETWEEN:break;default:W.a3=null;W.fm3=null;W.m3=null;while(W.cs&&W.cs.length>1){W.cs.pop();}}}function H(Z,a,b){var E=2+a,X;if(B.isBigDecimal(b.v)){b.dtp=D.BIGDECIMAL;}switch(b.t){case K.PROMPT:X=Z.cs;var Y;if(!X){X=[];Z.cs=X;}X[a]={};Y=X[a];Y.p=b;Z["a"+E]=null;Z["m"+E]=null;switch(Z.et){case L.AC:Z.et=L.AQ;break;case L.MC:Z.et=L.MQ;break;}break;case K.METRIC:Z["a"+E]=null;Z.cs=null;Z.et=L.MC;Z["m"+E]=b;break;case K.ATTR:Z["m"+E]=null;Z.cs=null;Z.et=L.AC;Z["a"+E]=b;Z["fm"+E]=null;break;default:Z["a"+E]=null;Z["m"+E]=null;X=Z.cs;if(!X){X=[];Z.cs=X;}if("did" in b){Z["a"+E]=null;Z["fm"+E]=null;Z["m"+E]=null;if(X[a]&&X[a].p){X[a].p=null;}}else{if(b&&b.v!=null){X[a]=b;}else{if(X[a]&&Z.et!==L.AL){X=X.splice(a,1);}}}if(!b.skipET){switch(Z.et){case L.MC:if((!Z.c2||!Z.m3)&&(!Z.m2||!Z.c3)){Z.et=L.MQ;}break;case L.AC:Z.et=L.AQ;break;case L.AL:if(!("did" in b)&&b.v){var A,V=b.dtp;X=[];A=b.v.split(mstrConfig.listSep);for(var U=0,W=A.length;U<W;U++){X.push({v:mstrmojo.string.trim(A[U]),dtp:V});}Z.cs=X;}break;}}}}var J={};J[L.AQ]={target:1,fm:1,fn:1,cs:1};J[L.AL]={target:1,fm:1,fn:1,cs:1};J[L.AE]={target:1,fn:1,es:1};J[L.AC]={target:1,a2:1,a3:1,fm:1,fm2:1,fm3:1,fn:1};J[L.MQ]={target:1,fn:1,cs:1,dmy:1};J[L.MC]={target:1,fn:1,m2:1,m3:1,dmy:1};J[L.F]={target:1};J[L.R]=J[L.F];J[L.XML]={target:1};J[L.ANDOR]={target:1};var I=function(A){return A!==null&&A!==undefined;};var N=function(a){if(a.data){return true;}if(!a||!I(a.et)){return false;}var Z=true,A=J[a.et],X=a.cs,W;Z=Z&&(!A.target||a[P[a.et]]);Z=Z&&(!A.fm||a.fm);Z=Z&&(!A.fn||I(a.fn));var V=S.fnCstCount(a.fn,a.fnt);if(Z&&A.cs){for(W=0;W<V;W++){Z=Z&&X&&I(X[W]);}}if(Z){var Y=[P[a.et],"fm"];for(var E=0;E<2;E++){for(W=0;W<V;W++){var b=Y[E]+(2+W);Z=Z&&(!A[b]||a[b]);}}}Z=Z&&(!A.es||a.es&&(a.es.length>0));var U=a.dimtyTypes;Z=Z&&(!A.dmy||U[M.NodeDimtyUnspecified]||U[M.NodeDimtyNone]||(U[M.NodeDimtyOutputLevel]&&a.dmy&&a.dmy.uts&&(a.dmy.uts.length>0)));return Z;};mstrmojo.ConditionModel=mstrmojo.declare(mstrmojo.Obj,null,{scriptClass:"mstrmojo.ConditionModel",data:null,completed:false,defaultETAttr:L.AQ,init:function(A){if(this._super){this._super(A);}this._updateCompleted();},edit:function R(p,f,AC){var W=this[p];if(W===f){return ;}this.etWas=this.et;switch(p){case"not":f=!!(f&&f.did===S.FN.NOT);W=!!this.not;if(f===W){return ;}this.not=!!f||null;break;case"target":var AG=this.et;if(f){switch(f[C]){case K.ATTR:case K.CONS:W=this.a;if(AG!==L.AQ&&AG!==L.AE&&AG!==L.ANDOR){this.et=this.defaultETAttr;this.m=null;this.m2=null;this.m3=null;this.r=null;this.f=null;}if(AG!==L.AE){this.fn=null;this.fnt=null;}this.fm=null;this.fm2=null;this.fm3=null;this.cs=null;break;case K.METRIC:W=this.m;if((AG!==L.MQ)&&(AG!==L.MC)){this.et=L.MQ;this.fm=null;this.fm2=null;this.fm3=null;this.fn=null;this.fnt=null;this.a=null;this.a2=null;this.a3=null;this.r=null;this.f=null;this.cs=null;this.dmt=M.NodeDimtyUnspecified;}this.m2=null;break;case K.REPORT:W=this.r;if(AG!==L.R){this.et=L.R;this.fm=null;this.fm2=null;this.fm3=null;this.fn=null;this.fnt=null;this.a=null;this.a2=null;this.a3=null;this.m=null;this.m2=null;this.m3=null;this.f=null;}break;case K.FILTER:W=this.f;if(AG!==L.F){this.et=L.F;this.fm=null;this.fm2=null;this.fm3=null;this.fn=null;this.fnt=null;this.a=null;this.a2=null;this.a3=null;this.m=null;this.m2=null;this.m3=null;this.r=null;}break;case K.PROMPT:W=this.prms&&this.prms[0];if(AG!==L.XML){this.et=L.XML;this.fm=null;this.fm2=null;this.fm3=null;this.fn=null;this.fnt=null;this.a=null;this.a2=null;this.a3=null;this.m=null;this.m2=null;this.m3=null;this.r=null;this.f=null;}break;}}this.es=null;this.data=null;this[P[this.et]]=f;break;case"fm":if(f&&f[C]==="fn"){this.et=L.AE;this.fm=null;Q(this,f);}else{this.fm=f;if(f&&(this.et==L.AE)){this.et=L.AQ;}this.fnt=null;this.fn=null;this.cs=null;this.a2=null;this.fm2=null;}break;case"fm2":case"fm3":this[p]=f;break;case"fn":Q(this,f);break;case"es":var AJ=this.es;if(f&&f.removed&&AJ){G.removeItems(AJ,f.itemIdField,f.removed);}if(f&&f.added){if(!AJ){AJ=f.added.concat();this.es=AJ;}else{G.insert(AJ,AJ.length,f.added);}}break;case"c0":H(this,0,f);break;case"c1":H(this,1,f);break;case"dmy":var AD=this.dmy;if(!AD){AD={cc:true,fres:true,uts:[]};this.dmy=AD;}var z=AD&&AD.uts;if(!z){z=[];AD.uts=z;this.dmt=M.NodeDimtyOutputLevel;}var U={};U[S.TP.ATTR]=true;U[S.TP.DIM]=true;if(f&&f.removed){var k=[],A=false,d=[],V=false;for(var o=0,X=f.removed,E=X.length;o<E;o++){var Z=X[o],AF=Z[C] in U;if(AF){V=true;}else{A=true;}var m=AF?d:k;m.push(Z);}if(A){G.removeItems(z,"did",k);}if(V){var AI={};for(var h=0,g=z&&z.length;h<g;h++){var e=z[h];if(e&&e.utgt){AI[e.utgt.did]=h;}}var Y=[];for(var AE=0,AB=d.length;AE<AB;AE++){var l=AI[d[AE].did];if(l>-1){Y.push(l);}}Y.sort(G.numSorter);for(var x=Y.length-1;x>-1;x--){z.splice(Y[x],1);}}}if(f&&f.added){var AK=[],q=S.DMY_TP.DIM,w=S.DMY_TP.ATTR;for(var AH=0,AA=f.added,j=AA.length;AH<j;AH++){var t=AA[AH];AK.push((t[C] in U)?{utgt:t,utp:t[C]===K.DIM?q:w,agg:1,flt:2,gb:true,rps:0,n:t.n}:t);}G.insert(z,z.length,AK);}break;case"data":this.data=f;break;}this._updateCompleted();if(!AC){this.raiseEvent({name:"edit",prop:p,value:f,valueWas:W});}},get:function F(){var A=this.data?this.data:this;var E=O[A.et]||[];E.push("et");return mstrmojo.hash.copyProps(E,A);},_updateCompleted:function(){this.set("completed",N(this));}});})();(function(){mstrmojo.requiresCls("mstrmojo.Obj","mstrmojo._LoadsScript","mstrmojo._HasChildren","mstrmojo.Binding","mstrmojo._HasBindings");mstrmojo.Model=mstrmojo.declare(mstrmojo.Obj,[mstrmojo._LoadsScript,mstrmojo._HasChildren,mstrmojo._HasBindings],{scriptClass:"mstrmojo.Model",init:function A(C){this._super(C);if(this.children){this.initChildren();}if(!this.parent){this.initBindings();}},destroy:function B(C){if(this.children){this.destroyChildren(true);}if(this.bindings){this.destroyBindings();}this._super(C);}});})();(function(){mstrmojo.requiresCls("mstrmojo.StringBuffer","mstrmojo.hash","mstrmojo.array","mstrmojo.dom","mstrmojo._IsGraphDataService","mstrmojo.func","mstrmojo._ImageHelper","mstrmojo.fe.FilterUtils","mstrmojo.rw.model.RetrievalKeysConfig","mstrmojo.rw.model.UpdateKeysConfig");var e=mstrmojo.hash,B=e.copy,V=mstrmojo.array,AY=mstrmojo.dom,z=mstrmojo.func,AO=[mstrmojo.desc(8445,"Loading")],AF=mstrmojo.fe.FilterUtils.getExprXml,Ar=mstrmojo.array.ensureArray,P=0;function X(BV){BV=BV||{};BV.preserveUndo=true;return BV;}function Ao(BZ,Ba,BV){if(this.blockRequests){throw ("The data service is currently ignoring all requests to the server.");}var BW=P++,BY=this.getTxUpdates(BW);BV=BV||{};BV.src=Ao.caller.name;if(!mstrmojo.string.isEmpty(BY)){BZ.updateChanges=BY;}BZ.zoomFactor=this.model.getZoomFactor();var BX=this.cmdMgr;if(!BV.preserveUndo&&BX){BX.onSubmitUpdates();}mstrApp.serverRequest(BZ,this.wrapCallback(Ba,BW,BV.preserveStid),BV);}function N(BX,BW,BV){e.copy({unitType:BW.defn&&BW.defn.t,unitKey:BW.k},BX);if(BV.layoutKey){e.copy({toKey:BV.layoutKey,analysisSectionType:BV.analysisSectionType},BX);}else{e.copy({toKey:BV.parentKey},BX);}return BX;}function Au(BW){BW=BW||{};if(mstrApp.optimizeFitToPage){var BV=window.mstrMobileApp?this.model.controller.getContentDimensions():mstrApp.getContentDimensions();if(BV){BW.styleName="RWDocumentMobileStyle";BW.availableWidth=BV.w;BW.availableHeight=BV.h;}else{BW.innerWidth=mstrmojo.dom.windowDim().w;BW.innerHeight=mstrmojo.dom.windowDim().h;}}return BW;}function BQ(BW){var BV=BW&&BW.style,BX=BV&&BV.params;return BX&&BX.treesToRender;}function C(BV,BW){return{act:"moveUnit",toKey:BV,unitType:BW};}function At(BV){return BV.split("\u001E")[2];}function M(BW,Ba){if(BW!==mstrmojo.DocDataService.UNDO_KEY){return BW;}if(!this.undoSectionKey){var BZ=this.undoSectionKey=this.model.getNextKey(),BX=this.undoFGKey=this.model.getNextKey();Ba.addActions({act:"addUndoSection",cbKey:this.cbKey,nodeKey:BZ,fgKey:BX});var BY=this;Ba.addCallbacks({failure:function BV(){delete BY.undoSectionKey;}});}return this.undoSectionKey;}function An(BX,BW){var BV={dsid:BX.dsid,formula:BX.tokenStreamXML,isTokenStream:!mstrmojo.string.isEmpty(BX.tokenStreamXML),name:BX.alias,afb:BX.afb,sfb:BX.sfb};if(BW){BV.Ids=["$GUID_135"];}return this.getAddDerivedMetricToDatasetAction(BV);}function L(BW){var BV="USE_DEFAULT_INDICATOR";BW=BW||{};BW.mptso=BW.mptso||{pru:true};BW.mptsim=BW.mptsim||{pru:true};BW.mptfms=BW.mptfms||"";return{MDXPassThrough:{SolveOrder:BW.mptso.pru?BV:BW.mptso.v,ScopeIsolationMode:BW.mptsim.pru?BV:BW.mptsim.v,FormatString:BW.mptfms}};}function AK(BV,BW){return{act:"formatDerivedMetric",dsid:BV.dsid||"",mid:(BW||!BV.did)?"$GUID_135":BV.did,format:L(BV.mptf),};}function AN(BY,Bb,BW,Bc,BV,BX){var BZ=[this.getNodeKeyFromKeyContext(Bb)];if(!BX){BZ=Ar(Bc).concat(BZ);}var Ba={act:BY,keyContext:Bb,tgtKey:BW,partialRetrieval:{nodes:BZ}};if(!BV){Ba.partialUpdate={selectors:[At(Bb)]};}return Ba;}function n(BX){var BZ=false;if(BX===1||BX===2){var BW=this.model,BV=BW.controller,Ba=BV.getRequiredZoomFactor&&BV.getRequiredZoomFactor(BX),BY=BW.getZoomFactor();if(isNaN(Ba)||parseInt(Math.abs((Ba-BY)*100),10)<=2){BZ=false;}else{BZ=true;}}return BZ;}mstrmojo.DocDataService=mstrmojo.declare(mstrmojo.Obj,[mstrmojo._IsGraphDataService,mstrmojo._ImageHelper],{scriptClass:"mstrmojo.DocDataService",defaultStyle:{params:{treesToRender:2}},cmdMgr:null,stid:-1,blockRequests:false,clientAuto:false,init:function Al(BV){this._super(BV);this.cmdMgr=this.model.controller&&this.model.controller.cmdMgr;},wrapCallback:function Ae(Ba,BX,BW){var BY=this;return z.wrapMethods({success:function BZ(Bb){if(Bb){BY.model.bs=BY.rwb=Bb.bs||BY.rwb;BY.msgId=Bb.mid||BY.msgId;BY.cbKey=Bb.cbKey||BY.cbKey;if(Bb.stid!==undefined&&!BW){BY.stid=Bb.stid;}if(Bb.clientAuto!==undefined){BY.clientAuto=Bb.clientAuto;}if(mstrApp.parseSecondaryDataProviders){mstrApp.parseSecondaryDataProviders(Bb);}}BY.clearTxUpdates(BX);},failure:function BV(){BY.resetTxUpdates(BX);}},Ba);},getNodeKeyFromKeyContext:function Z(BV){return BV.split("\u001E")[1];},refresh:function A1(BX,BY){var BW=!!BX.useRefreshProgress,BV=BW?[mstrmojo.desc(10078,"Refreshing data. Please wait.")]:AO;delete BX.useRefreshProgress;BX=Au.call(this,BX);Ao.call(this,B(BX,{taskId:"docRefresh",rwb:this.rwb,rePrompt:false,fresh:false,regenerate:false,displayNoResErr:true,compress:1}),BY,{showProgress:true,hideProgress:true,progressStateText:BV,useRefreshProgress:BW});},saveRW:function A5(BV,BW){Ao.call(this,B(BV,{taskId:"saveRW",msgID:this.msgId}),BW);},saveThresholds:function j(BW,BX,BV){Ao.call(this,B(BW,{taskId:"saveThresholds"}),BX,BV);},getThresholds:function BJ(BW,BX,BV){Ao.call(this,B(BW,{taskId:"getThresholds"}),BX,BV);},browseElements:function AJ(BW,BX,BV){Ao.call(this,B(BW,{taskId:"browseElements",styleName:"MojoAttributeStyle",blockBegin:1,blockCount:mstrApp.elementsBlockCount||30}),BX,BV);},removeUnit:function Y(BW,BX){var BV=B(BW,{act:"removeUnit"});this.submitTemplateUpdates(BV.nodeKey,BV,BX);},removeLayout:function AS(BW,BV,BX){this.submitUpdates({act:"removeLayout",unitKey:BW,isCurrent:BV},BX);},moveLayout:function w(BX,BV,BW){this.submitUpdates(this.getMoveNodeAction(BX,BV,BW),mstrmojo.DocDataService.EMPTY_CALLBACK,mstrmojo.DocDataService.SUPPRESS_DATA);},getMacroCopyNodeAction:function Ap(BW,BV,BY){var BX={act:"macroCopyUnit",newKey:BY,partialRetrieval:this.newRetrievalKeysConfig().addNode(BY)};N(BX,BW,BV);return BX;},getMacroMoveNodeAction:function AE(BW,BV){var BX={act:"macroMoveUnit",partialRetrieval:this.newRetrievalKeysConfig().addNode(BW.k)};N(BX,BW,BV);return BX;},getMoveNodeAction:function r(BZ,BV,BW){var BY=BZ.defn,BX=BY?BY.t:mstrmojo.EnumRWUnitType.LAYOUT;return this.getMoveNodeActionUsingKey(BZ.k,BX,BV,BW);},getMoveNodeActionUsingKey:function A8(BZ,BX,BV,BW){var BY=C(BV,BX);BY.unitKey=BZ;if(BW!==undefined){BY.index=BW;}return BY;},getMoveControlAction:function d(BY,BW,BV){var BX=C(BW,mstrmojo.EnumRWUnitType.SELECTOR);BX.keyContext=BY;if(BV){BX.partialRetrieval={nodes:Ar(BV)};}return BX;},addMoveControlAction:function I(BY,BX,BW,BV){BY.addActions(this.getMoveControlAction(BX,M.call(this,BW,BY),BV));},getSetCtrlSourceAction:function AL(BW,BY,BV,BX){return{act:"setControlSource",keyContext:BW,unitId:BY,unitType:BV,removeCGB:BX||[],partialRetrieval:this.newRetrievalKeysConfig().addNode(this.getNodeKeyFromKeyContext(BW)),partialUpdate:{selectors:[At(BW)]}};},getRemoveCtrlTargetAction:function G(BX,BW,BY,BV){return AN.call(this,"removeControlTarget",BX,BW,BY,BV);},getClearCtrlTargetAction:function BF(BV){return{act:"clearControlTarget",keyContext:BV};},getAddCtrlTargetAction:function Az(BZ,BW,Ba,Bb,BV,BX){var BY=AN.call(this,"addControlTarget",BZ,BW,Ba,BV,BX);BY.isUC=!Bb;return BY;},getAddCtrlTargetDatasetAction:function BC(BW,BV){return{act:"addControlTargetDataset",keyContext:BW,tgtDid:BV};},getRemoveCtrlTargetDatasetAction:function h(BW,BV){return{act:"removeControlTargetDataset",keyContext:BW,tgtDid:BV};},getClearCtrlTargetDatasetAction:function AR(BV){return{act:"clearControlTargetDataset",keyContext:BV};},getChangeControlElementSource:function BP(BW,BV){return{act:"changeControlElementSource",keyContext:BW,ctlElementSrc:BV};},getSetAttributesJoinTypeAction:function Ai(BV,BW){return{act:"setAttributesJoinType",nodeKey:BV,value:BW,partialRetrieval:this.newRetrievalKeysConfig().addNode(BV)};},getSetMetricJoinTypeAction:function Aa(BX,BZ,BV,BW,BY){return{act:"setMetricJoinType",nodeKey:BX,unitId:BZ,dataType:BV,unitType:BW,value:BY,partialRetrieval:this.newRetrievalKeysConfig().addNode(BX)};},getTxUpdates:function AX(BW){var BV=this.model;return BV&&BV.getTransactionUpdates&&BV.getTransactionUpdates(BW);},clearTxUpdates:function Am(BW){var BV=this.model;if(BV&&BV.clearTransactionUpdates){BV.clearTransactionUpdates(BW);}},resetTxUpdates:function D(BW){var BV=this.model;if(BV&&BV.resetTransactionUpdates){BV.resetTransactionUpdates(BW);}},loadDocLayout:function K(BZ,Bb,Ba){var BY={act:"setCurrentLayout",unitKey:BZ.layoutKey,disablePU:true,panelUnitKey:BZ.panelKey},BX={style:{params:{treesToRender:3}},params:Au.call(this,BZ)},BV=this.model,BW=!!Ba;if(!Ba){Ba=BV.getDataService().newUpdateWithoutCmd();}if(mstrApp.isAppStatePause&&mstrApp.isAppStatePause()){BV.applyBufferedSelections(Ba);}Ba.add(BY,Bb,BX);if(!BW){this.submitUpdates(BY,Bb,BX);}},checkMissingCredentials:function AA(BV,BW){Ao.call(this,B(BV,{taskId:"checkMissingCredentials"}),BW);},setCurrentDocLayout:function Aw(BX,Bb,Ba){var BZ={act:"setCurrentLayout",unitKey:BX},BY={config:{silent:(Bb===null)&&(!!Ba&&Object.keys(Ba.callback||{}).length===0)}},BV=this.model,BW=!!Ba;Bb=Bb||null;if(!Ba){Ba=BV.getDataService().newUpdateWithoutCmd();}if(mstrApp.isAppStatePause&&mstrApp.isAppStatePause()){BV.applyBufferedSelections(Ba);}Ba.add(BZ,Bb,BY);if(!BW){Ba.submit();}if(window.mstrMobileApp!==undefined){mstrMobileApp.clearWebViewCache(false);}},fetchDocPage:function BG(BV,BW){Ao.call(this,{taskId:"fetchDocPage",rwb:this.rwb,pos:BV},BW);},requestPanelChangeDeferred:function BO(Bb,Ba,BV,BW,BY,BZ){var BX={act:"setCurrentPanel",unitKey:Ba};if(BV){BX.partialRetrieval={nodes:BV.split(",")};}Bb.add(BX,BZ,{config:{showProgress:BY,hideProgress:BY,progressStateText:AO},style:{params:{treesToRender:BW?3:0}}});},getGraphSelectionAction:function E(BZ,BV,BX,Bc,Bb,BW){var Ba=this.model.getCurrentLayoutDef(),Bd=(Ba&&Ba.dzf)||1,BY={act:"graphSelector",nodeKey:BZ,sliceID:BX,x:Math.round(Bc/Bd),y:Math.round(Bb/Bd)};if(BW){BY.usePartialUpdate="0";}else{BY.partialUpdate={selectors:BV.split("\u001E")};}return BY;},getSelectorElementsAction:function t(BX){var BW={act:"setSelectorElements",keyContext:BX.ck,ctlKey:BX.ctlKey,elemList:mstrmojo.string.decodeHtmlString(BX.eid),isVisualization:!!BX.isDocVis},BV=BX.include;if(BV!==undefined){BW.include=!!BV;}if(BX.tks){BW.tks=BX.tks;}if(BX.disablePU){BW.usePartialUpdate="0";}else{if(BX.ignoreTargetData){BW.partialRetrieval=this.newRetrievalKeysConfig().addNode(this.getNodeKeyFromKeyContext(BX.ck));}else{BW.partialUpdate={selectors:BX.ctlKey.split("\u001F")};}}return BW;},getUpdateTransactionAction:function BT(BW){var BV={act:"updateTransaction"};if(BW){if(BW.ctlKey){BV.partialUpdate={selectors:[BW.ctlKey]};}}return BV;},getSelectorFromGMAction:function o(BW){var BV={act:"setSelectorFromGM",keyContext:BW.ck,ctlKey:BW.ctlKey,keepOnly:!!BW.keepOnly,selectorObjects:BW.selectorObjects,isVisualization:!!BW.isDocVis,include:!!BW.include};if(BW.tks){BV.tks=BW.tks;}if(BW.disablePU){BV.usePartialUpdate="0";}else{BV.partialUpdate={selectors:[BW.ctlKey]};}return BV;},getGMViewFilterAction:function AI(BW){var BV={act:"keepOnlyGM",selectorObjects:BW.selectorObjects,isVisualization:!!BW.isDocVis,keepOnly:!!BW.keepOnly};if(BW.tks){BV.tks=BW.tks;}if(BW.disablePU){BV.usePartialUpdate="0";}else{BV.partialUpdate={selectors:[BW.ctlKey]};}return BV;},browseControlElements:function BK(BZ,Bi,BW){var BY=BZ.searchPattern,Bf=BZ.attributeId,Bb=this.model;if(!BY||BY===""){return ;}var Bc={taskId:"browseElements",styleName:"MojoAttributeStyle",attributeID:Bf,expressionXML:BZ.expressionXML||"",dataSourcesXML:BZ.dataSourcesXML||"",blockBegin:BZ.blockBegin,blockCount:BZ.blockCount,searchPattern:BY,rawInput:BY,browseFlags:BZ.browseFlags||0,otp:BZ.objectType};if(BZ.datasetId){B({datasetID:BZ.datasetId,messageID:Bb.mid,ctlKey:BZ.controlKey},Bc);}var Bh=BZ.searchForms;if(Bh){var BX="",Ba="";V.forEach(Bh,function(Bj){BX+=Ba+Bj.did;Ba=";";});Bc.searchForms=BX;if(Bb.isnew||BZ.useClientForm){var BV="",Be="",Bd=V.filterOne(Bb.getDatasetUnits(["att"]),function(Bj){return Bj.did===Bf;}),Bg=Bd.fs||[];V.forEach(Bh,function(Bj){var Bk=V.filterOne(Bg,function(Bl){return Bl.fid===Bj.did;});BV+=Be+Bj.did+":"+(Bk&&Bk.bftp||0);Be=";";});Bc.clientFormPatterns=BV;}}Ao.call(this,Bc,Bi,BW);},setMultiDocSelectorElements:function AG(BV,BW,BY){var BX={taskId:"setMultiDocSelectorElements",rwb:this.rwb,multiSelect:BW,selectorObjects:BV};Ao.call(this,BX,BY,{showWait:true,hideWait:true,delay:true});},setDocSelectorTexts:function U(Ba,Bc,Be,Bb,Bd,BW,BV,BX,BZ){var BY={taskId:"setDocSelectorTexts",rwb:this.rwb,unitKeyContext:Ba,ctlTexts:Bc,ctlKey:Be,zoomFactor:BW};if(AY.isAndroid||BV){BY.taskId="androidSetDocSelectorElements";}if(Bb!==null&&Bb!==undefined){BY.include=Bb;}if(BX!==null&&BX!==undefined){BY.usePartDisplay=BX;}if(BZ!==null&&BZ!==undefined){BY.treesToRender=BZ;}Ao.call(this,BY,Bd);},getSelectorExpressionAction:function u(BX){var BW={act:"setSelectorExpression",keyContext:BX.ck,ctlType:BX.type,objId:BX.srcid,objType:BX.srct,expFunction:BX.f,expFunctionType:BX.ft,include:!!BX.include,qt:BX.qt,unset:!!BX.unset};if(BX.disablePU){BW.usePartialUpdate="0";}else{BW.partialUpdate={selectors:[BX.ckey]};if(BX.retrieveCtrlKey){BW.partialRetrieval=this.newRetrievalKeysConfig().addNode(BX.ctlKey);}}if(BX.changeQual){BW.changeQual=BX.changeQual;}var BV=BX.cs;if(BV!==null&&BV!==undefined){BW.expConstants=BV;BW.dataType=BX.dtp;}if(BX.fid){BW.fid=BX.fid;}return BW;},getAttributeSelectorExpressionAction:function Ay(BW){var BV={act:"setAttributeSelectorExpression",keyContext:BW.ck,ctlKey:BW.ctlKey,ctlType:BW.type,expr:BW.expr,partialUpdate:{selectors:[BW.ctlKey]}};if(BW.tks){BV.tks=BW.tks;}return BV;},getMultiUnitSelectorAction:function BM(BV){return{act:"multiUnitSelection",keyContext:BV.ck,include:BV.include!==false,sels:BV.selections,partialUpdate:{selectors:[BV.ctlKey]}};},getRemoveCtrlAction:function Aq(BW,BV){return{act:"removeControl",key:BW,partialUpdate:{selectors:[BW]},partialRetrieval:{nodes:Ar(BV)}};},getAddCtrlAction:function Ah(Bc,Ba,BW,Bb,BX,Bd,BV,BY,Be){if(isNaN(Be)){Be=1;}var BZ={act:"addControl",parentKey:Bc,nodeKey:Ba,ctlKey:BW,isUC:!!BX,unitType:Bd||-1,unitId:BV||"",targetKeys:Ar(BY),ctlType:Be,gpType:Be,partialRetrieval:{nodes:Ar(Bb)}};if(!BZ.isUC){BZ.partialUpdate={selectors:[BW]};}return BZ;},getReplaceCtrlAction:function S(BX,Ba,BV,BZ,BW,BY){return{act:"replaceControl",nodeKey:this.getNodeKeyFromKeyContext(BX),ctlKey:Ba,ctlType:BV,unitId:BZ,unitType:BW,partialUpdate:{selectors:[Ba]},partialRetrieval:{nodes:Ar(BY)}};},getSaveGraphPropertiesAction:function m(BV,BW){return{act:"saveGraphProperties",nodeKey:BV,properties:BW};},getSelectorIncludeAction:function A7(BW){var BV=BW.ckey;return{act:"setSelectorInclude",keyContext:BW.ck,ctlKey:BV,ctlType:BW.type,include:BW.include,partialUpdate:{selectors:[BV]}};},getSelectorShowAllAction:function Q(BV){return{act:"setSelectorShowAll",keyContext:BV.ck,ctlKey:BV.ckey,ctlType:BV.type,showAll:BV.showAll,partialRetrieval:this.newRetrievalKeysConfig().addNode(this.getNodeKeyFromKeyContext(BV.ck))};},getUnsetSelectorAction:function g(BY){var BX=BY.ckey,BV=BY.ck,BW={act:"unsetSelector",keyContext:BV,ctlKey:BX,ctlType:BY.type};if(BY.ignoreTargetData){BW.partialRetrieval=this.newRetrievalKeysConfig().addNode(this.getNodeKeyFromKeyContext(BV));}else{BW.partialUpdate={selectors:[BX]};}if(BY.retrieveCtrlKey){BW.partialRetrieval=this.newRetrievalKeysConfig().addNode(this.getNodeKeyFromKeyContext(BV));BW.partialRetrieval=BW.partialRetrieval.addNode(BX);}return BW;},getRASelectorExpandAction:function q(BW){var BV=BW.ckey;return{act:"raSelectorExpandCollapse",keyContext:BW.ck,ctlKey:BV,ctlType:BW.type,elementId:BW.elementId,isExpand:BW.isExpand,partialRetrieval:this.newRetrievalKeysConfig().addNode(this.getNodeKeyFromKeyContext(BW.ck))};},getChangeFilteringAction:function A3(BV,BY,BX,BW){return{act:"changeFiltering",nodeKey:BV,filterMode:BY,isUC:BX,partialRetrieval:{nodes:(BW?Ar(BW):[])}};},getAddDerivedMetricToDatasetAction:function BB(BV){return{act:"addDerivedMetricToDataset",dsid:BV.dsid,formula:BV.formula,isTokenStream:BV.isTokenStream,name:BV.name,newObjectIds:BV.Ids,afb:BV.afb,sfb:BV.sfb};},getSetMDXPassThroughOptionsForCMAction:function A(BV){var BW={act:"formatDerivedElement",format:L(BV.mptf)};if(BV.cid){BW.cid=BV.cid;}if(BV.ceid){BW.ceid=BV.ceid;}return BW;},getEditDocUnitPropAction:function AD(BV){return{act:"editDocUnitProp",dsid:BV.dsid,formId:BV.formId,unitId:BV.unitId,unitType:BV.unitType,prop:BV.prop,value:BV.value};},getRWGraphImage:function BS(BZ,Bd){if(mstrApp.isExpress&&!mstrApp.optimizeFitToPage&&n.call(this,this.model.zt)){return ;}var BY=mstrApp,BV=this.id,BW={taskId:"getRWGraphImage",taskEnv:"xhr",imgType:4,messageID:this.msgId,nodeKey:BZ.k,sliceID:parseInt(BZ.sid,10),width:parseInt(BZ.w,10),height:parseInt(BZ.h,10)};if(BZ.needCoordinate){BW.needCoordinate=1;}if(BY.onMobileDevice()&&BY.useBinaryFormat){window.setTimeout(function(){Ao.call(mstrmojo.all[BV],BW,Bd,X());},0);}else{if(BZ.encodeImage){BW.taskContentEncoding="base64";delete BW.taskEnv;Ao.call(this,BW,{success:function Be(Bf){Bd.success(Bf);},failure:function BX(Bf){(Bd.failure||BY.onerror)(Bf);}},X());}else{var Bb=BY.getConfiguration(),Ba=BY.getCurrentProjectId(),Bc=new mstrmojo.StringBuffer();BW.__ts__=new Date().getTime();BW.sessionState=BY.getSessionState(Ba);e.forEach(BW,function(Bf,Bg){Bc.append(Bg+"="+encodeURIComponent(Bf));});Bd.success(Bb.getTaskUrlByProject(Ba)+"?"+Bc.toString("&"));}}},getImage:function BR(BW){var BX=mstrApp,BV=BX.getConfiguration();if(BV&&BW&&BW.indexOf("://")===-1){BW=BV.getHostUrlByProject(BX.getCurrentProjectId())+BW;}return(mstrApp.useBinaryFormat)?String(mstrMobileApp.getImage(BW)):BW;},setGridDisplayMode:function v(BX,BW,BY,BV){e.copy(mstrmojo.DocDataService.RAPID_EXEC,BV);this.submitUpdates({act:"setGridDisplayMode",unitKey:BX,displayMode:BW},BY,BV);},setDocZoom:function H(BV,BW){this.submitUpdates(B(BV,{act:"setDocZoom",disablePU:true}),BW,{style:{params:{treesToRender:3}}});},sortGrid:function AP(BV,BW){this.submitTemplateUpdates(BV.nodeKey,B({act:"sort"},BV),BW);},getAdvSortData:function Ak(BV,BW){this.rwExecute(B(BV,{styleName:"RWGridStyle"}),BW);},getFilterExpression:function AU(BX,BW){var BY=BX&&BX.expr,BV=this.model;if(BY&&BV&&BV.getVfexprWithUpdatedVf){BY=BV.getVfexprWithUpdatedVf(BW,BY);}return AF(BY);},saveViewFilter:function Ax(Ba,Bb){var BZ=this.msgId,BV=Ba&&Ba.nodeKeys,BY=this,BX=V.map(BV,function(Bc){return{act:"saveViewFilter",messageID:BZ,nodeKey:Bc,expr:BY.getFilterExpression(Ba.filterModel,Bc),partialUpdate:{nodes:[Bc]}};}),BW=V.map(BV,function(Bc){return{act:"saveViewFilterLimit",messageID:BZ,nodeKey:Bc,limitExp:Ba.limitExp,limitToRemove:Ba.limitMdxToRemove||[]};});this.submitUpdates(BX.concat(BW),Bb);},getViewFilter:function AQ(BW,BX){var BV=this.model;if(BV.getViewFilter){BV.getViewFilter(BW,BX);}else{Ao.call(this,{taskId:BW.taskId,rwb:BW.rwb,msgID:BW.msgID,nodeKey:BW.nodeKey},BX);}},createEmbeddedFilter:function As(BX,Ba){var BV=BX.filterId,BY=BX.expJson,BZ={act:"createEmbeddedFilter",messageID:this.msgId,expr:BX.expr,filterId:BV,filterName:BX.filterName};var BW=this.model;z.wrapMethods({success:function(){var Bb=BW.defn.efs||[];Bb.push({did:BV,exp:BY});BW.defn.efs=Bb;}},Ba);this.submitUpdates([BZ],Ba,{style:{params:{treesToRender:mstrmojo.DocDataService.EnumTreesToRender.NONE}},params:{suppressData:true}});},rwExecute:function BI(BV,BW){Ao.call(this,B(BV,{taskId:"RWExecute",rwb:this.rwb,messageID:this.msgId}),BW);},pivot:function p(BV,BW){this.submitTemplateUpdates(BV.nodeKey,{act:"pivot",unitId:BV.unitId,unitType:BV.unitType,attFormId:BV.attFormId,axis:BV.axis,unitPos:BV.unitPos},BW);},resizeXtabColumn:function BE(BV,BW){this.submitUpdates([this.getUpdateTemplateAction(BV.nodeKey,BV),{act:"format",unitType:52,unitKey:BV.nodeKey,formatType:1,format:{FormattingSize:{WidthMode:2}}}],BW);},showTotals:function W(BV,BW){this.submitTemplateUpdates(BV.nodeKey,{act:"showTotals",unitId:BV.unitId,unitType:BV.unitType,subtotalType:BV.subtotalType,clearSubtotalType:BV.clearSubtotalType},BW);},drillGrid:function AM(BV,BW){this.submitUpdates(this.getDrillGridAction(BV),BW,{config:{showProgress:true,hideProgress:true,progressStateText:AO,delay:true}});},getDrillGridAction:function BL(BW){var BV={act:"gridDrillWithin",messageID:this.msgId,nodeKey:BW.nodeKey,sliceId:BW.sliceId,drillPathIndex:BW.drillPathIndex,drillPathKey:BW.drillPathKey,elementList:BW.drillElements,retainParent:BW.retainParent,partialUpdate:{nodes:Ar(BW.updateNodeKey||BW.nodeKey)}};if(BW.x){BV.x=BW.x;BV.y=BW.y;}return BV;},changeDocGroupBy:function O(BX,BY,BV){var BW={act:"changeDocGroupBy",disablePU:true};if(BX.flags){BW.flags=BX.flags;}if(BX.groupbyKey){BW.gbKey=BX.groupbyKey;BW.elemId=BX.elementId;}else{BW.gbUnits=BX.gbUnits;}this.submitUpdates(BW,BY,{config:BV,style:{params:{treesToRender:3}},params:Au.call(this,BX)});},setOutlineExpanding:function A4(BX,BY,BV){var BW={act:"updateTemplate",keyContext:BX.unitKey,actions:[{act:"setOutlineExpanding",prs:"Template Formatting",pr:"OutlineLevelExpanding",v:BX.outlineLevel}]};this.submitUpdates(BW,BY,e.copy(mstrmojo.DocDataService.RAPID_EXEC,{config:{silent:true},style:{params:{treesToRender:mstrmojo.DocDataService.EnumTreesToRender.BOTH}}}));},retrieveServerJson:function f(BX,Bh,BY){if(mstrApp.isExpress&&!mstrApp.optimizeFitToPage&&n.call(this,this.model.zt)){return ;}var Ba=this.model,Bb=Ba.controller,Bf={},BV,BW,Bd;var Be=BX.nodes;if(Be){Bf.partialRetrieval=Be;}var Bg=BX.slices;if(Bg){Bf.slices=Bg;}if(BY){BV=BY.style;BW=BY.config;Bd=BY.params;}if(!BW){BW={showProgress:true,hideProgress:true,progressStateText:AO};}var Bi=BX.style=e.clone(this.defaultStyle),Bc=mstrApp.isAppStatePause&&mstrApp.isAppStatePause();B(BV.params,Bi.params);var BZ={taskId:"getServerJSONResults",styleName:"ServerJsonRWDStyle",compress:1,rwb:this.rwb,messageID:this.msgId,stateID:-1,excludeData:!!(Bc||mstrConfig.resolveOnly),params:JSON.stringify(Bf),treesToRender:Bi.params.treesToRender};B(Bd,BZ);BW.preserveUndo=(BY&&BY.preserveUndo)||false;Ao.call(this,BZ,Bh,BW);},downloadGridData:function J(BY,BZ){var BX={act:"gridIncrementalFetch",nodeKey:BY.nodeKey,rowPosition:BY.rowPosition,maxRows:BY.maxRows,colPosition:BY.colPosition,sliceId:BY.sliceId,maxColumns:BY.maxColumns,rowMode:BY.rowMode||1,partialRetrieval:this.newRetrievalKeysConfig().addNode(BY.nodeKey)};if(BY.partialUpdate){BX.partialUpdate=BY.partialUpdate;}var BW=mstrmojo.all[BY.xtabId],BV=BW&&BW.isCustomSort;this.submitUpdates(BX,BZ,e.copy(X(),{noUpdate:true,preserveStid:BV,config:{silent:true}}));},txMarkRows:function AW(BV,BW){if(mstrApp&&mstrApp.isNativeAndroid){mstrMobileTransport.applyTransactionMarkRow(BV.nodeKey,BV.sliceId,BV.rowOrdinal,BV.actionType);}else{Ao.call(this,{taskId:"markRow",rwb:this.rwb,nodeKey:BV.nodeKey,sliceId:BV.sliceId,rowOrdinal:BV.rowOrdinal,actionType:BV.actionType},BW);}},txChangeData:function x(BV,BW){if(mstrApp&&mstrApp.isNativeAndroid){mstrMobileTransport.applyTransactionDataChange(BV.nodeKey,BV.sliceId,JSON.stringify(BV.cells),BV.autoRefresh);}else{Ao.call(this,{taskId:"changeData",rwb:this.rwb,nodeKey:BV.nodeKey,sliceId:BV.sliceId,cells:BV.cells,autoRefresh:BV.autoRefresh},BW);}},sendTransactionActions:function c(BW,BX){var BV={taskId:"DocTransaction",rwb:this.rwb,keyContext:BW.keyContext,actions:BW.actions,messageID:this.msgId};if(BW.txrcd){BV.isPending=BW.txrcd.pending;BV.timestamp=BW.txrcd.timestamp;}Ao.call(this,BV,BX,{silent:!!BX});},newUpdate:function BA(BX,BW){var BV=new mstrmojo.DocDataService.Update(BW);BV.ds=this;BV.cmd=BX;return BV;},newUpdateWithoutCmd:function l(BW){var BV=new mstrmojo.DocDataService.Update(BW);BV.ds=this;return BV;},newRetrievalKeysConfig:function Ag(){return new mstrmojo.rw.model.RetrievalKeysConfig();},newUpdateKeysConfig:function R(){return new mstrmojo.rw.model.UpdateKeysConfig();},submitCmd:function BH(BW,BV){this.newUpdate(BW,BV).submit();},submitUpdates:function Aj(Be,Bk,Bb){Be=Ar(Be);var Ba={actions:Be},BV,BY,Bh,BX=false;V.forEach(Be,function Bd(Bm){if(Bm.disablePU){BX=true;delete Bm.disablePU;}V.forEach(Bm.actions,Bd);return !BX;});if(!BX){var BW=mstrmojo.rw.model.RetrievalKeysConfig.getConsolidatedConfig(Be),Bj=mstrmojo.rw.model.UpdateKeysConfig.getConsolidatedConfig(Be);if(!e.isEmpty(BW)){Ba.partialRetrieval=BW;}if(!e.isEmpty(Bj)){Ba.partialUpdate=Bj;}}if(Bb){BV=Bb.style;BY=Bb.config;Bh=Bb.params;}if(!BY){BY={showProgress:true,hideProgress:true,progressStateText:AO};}if(!BV){Ba.style=this.defaultStyle;}else{var Bl=Ba.style=e.clone(this.defaultStyle);B(BV.params,Bl.params);}Ba.style.name=(BV&&BV.name)||mstrApp.styleName;var Bc={taskId:"mojoRWManipulation",rwb:this.rwb,messageID:this.msgId,stateID:-1,params:JSON.stringify(Ba)};B(Bh,Bc);BY.preserveUndo=(Bb&&Bb.noUpdate)||false;BY.preserveStid=(Bb&&Bb.preserveStid)||false;var Bg=this,Bi=true,BZ=z.override({success:function(Bm,Bn){if(Bm.status===2){Bi=false;Bg.submitUpdates([],Bk,Bb);}else{Bi=true;return this._super(Bm,Bn);}},complete:function(){if(this._super&&Bi){this._super();}}},B(Bk));if(!(Bb&&Bb.hideCancel)){BY.waitBoxCfg=e.copy({showCancel:true},BY.waitBoxCfg);}if(Bb&&Bb.message){BY.waitBoxCfg=e.copy({message:Bb.message},BY.waitBoxCfg);}var Bf=mstrApp.isAppStatePause&&mstrApp.isAppStatePause();if(Bb&&Bb.resolveOnly!==undefined){Bc.resolveOnly=Bb.resolveOnly;}else{if(Bf){Bc.resolveOnly=true;}}if(Bb&&Bb.excludeData!==undefined){Bc.excludeData=Bb.excludeData;}else{if(Bf){Bc.excludeData=true;}}if(Bb&&Bb.noDeltaXML!==undefined){Bc.noDeltaXML=Bb.noDeltaXML;}if(Bc.resolveOnly&&Bc.excludeData){mstrApp.enableUpdate=true;}Ao.call(this,Bc,BZ,BY);},submitTemplateUpdates:function AB(BV,BX,BY,BW){this.submitUpdates(this.getUpdateTemplateAction(BV,BX),BY,BW);},getUpdateTemplateAction:function Ad(BV,BX,BW){return{act:"updateTemplate",keyContext:BV,partialRetrieval:this.newRetrievalKeysConfig().addNode(BV,BW),partialUpdate:{selectors:BX.selectors},actions:Ar(BX)};},addUpdateTemplateAction:function BN(BX,BV,BW){BX.addActions(this.getUpdateTemplateAction(BV,BW));},applySegment:function AT(BW,BV,BX){Ao.call(this,{taskId:"applySegment",rwb:this.rwb,segmentID:BW,nodeKey:BV},BX);},getPageByTree:function AV(BV){mstrApp.serverRequest({taskId:"getPageByTree",msgID:this.msgId},BV);},getUserDICubeInfo:function a(BV,BW){Ao.call(this,{taskId:"getUserDICubeInfo",cubeIds:BV.join(",")},BW);},applySorts:function A9(BW,BX,BV,BY){Ao.call(this,{taskId:"applySorts",key:BW,sortType:BX,sortList:BV},BY,mstrmojo.DocDataService.PROGRESS_CONFIG);},getAddNewDerivedMetricToDatasetSubmitFunc:function A6(BW){var BV=this;return function(BZ){var Ba=BV.model,BY=Ba.controller,BX=e.copy(BZ,BW),Bb=[An.call(BV,BX,true)],Bc=Ba.getDatasetsUpdateCallback();if((BX.mptf||{}).dirty||this.enablePTO){Bb.push(AK(BX));}BY.submitUndoRedoUpdates(Bb,null,Bc,{style:{params:{treesToRender:1}}});};},getAddNewDerivedMetricToXtabSubmitFunc:function Av(BW){var BV=this;return function(Ba){var Bb=BV.model,BZ=Bb.controller,BY=e.copy(Ba,BW),BX=BY.idx,Bd=[],Be=z.wrapMethods(Bb.getDatasetsUpdateCallback(),BZ._getXtabCallback(BY.host));Bd.push(An.call(BV,BY,true));if((BY.mptf||{}).dirty||this.enablePTO){Bd.push(AK(BY,true));}if(BY.replace){Bd.push(BV.getUpdateTemplateAction(BY.nodeKey,[BY.host.model.getRemoveTemplateUnitAction({did:BY.replace.did,t:BY.replace.t})]));}else{BX++;}var Bc=BV.getUpdateTemplateAction(BY.nodeKey,[BY.host.model.getAddTemplateUnitAction({did:"$GUID_135",t:4},BY.dsid,BY.zoneid,BX),{act:"renameUnit",id:"$GUID_135",type:4,name:BY.alias,isDynamicAlias:false}]);Bd.push(Bc);BZ.submitUndoRedoUpdates(Bd,null,Be);};},getAddNewDerivedMetricToDropzoneSubmitFunc:function AH(BW){var BV=this;return function(Bc){var Bd=BV.model,Be=Bd.controller,Bg=e.copy(Bc,BW),Bi=Bg.host.zonesModel,Bj=Bg.idx,Bb=[],BX=[],Bh={id:Bg.zoneid},Bf={did:"$GUID_135",t:4},Bk=z.wrapMethods(Bd.getDatasetsUpdateCallback(),Be._getXtabCallback(Bg.host));Bb.push(An.call(BV,Bg,true));if((Bg.mptf||{}).dirty||this.enablePTO){Bb.push(AK(Bg));}if(Bg.replace){var BZ={did:Bg.replace.did,t:Bg.replace.t};Array.prototype.push.apply(BX,Bi.getRemoveDropZoneUnitActions(Bh,BZ));}else{Bj++;}BX.push(Bi.getAddDropZoneUnitAction(Bh,Bf,Bj,{datasetId:Bg.dsid}));if(Bg.extraZone){BX.push(Bi.getAddDropZoneUnitAction({id:Bg.extraZone.id},Bf,Bg.extraZone.idx,{datasetId:Bg.dsid}));}if(!Bg.replace){var BY=(BW.zoneid===4)?1:2,Ba=Bi.getAddMetricNameAction(BW.host,BY);if(Ba){Bb.push(Ba);}}if(!Bg.replace&&Bi.gmZones){Ba=Bi.gmZones.getUpdateGroupInfoActionForNewMetric(BW.zoneid,Bj,true);if(Ba){Bb.push(Ba);}}Bi.checkAndAddThresholdAction(Bg.zoneid,Bf,BX);Bb.push(BV.getUpdateTemplateAction(Bg.nodeKey,BX));Be.submitUndoRedoUpdates(Bb,null,Bk);};},getEditDerivedMetricSubmitFunc:function k(BW){var BV=this;return function(BZ){var Bb=BV.model,BY=Bb.controller,BX=e.copy(BZ,BW),Ba=BW.nodeKey,Bc={act:"editDM",formula:BX.tokenStreamXML,isTokenStream:!mstrmojo.string.isEmpty(BX.tokenStreamXML),afb:BW.afb,sfb:BW.sfb,dsid:BX.dsid||"",did:BX.did},Bd=[Bb.addUpdateObjects(Bc,{id:BX.did,type:4,flag:mstrmojo.DocDataService.PARTIAL_UPDATE_FLAGS.DATA_CHANGE})],Be=z.wrapMethods(Bb.getDatasetsUpdateCallback(),BY.getPartialUpdateCallback());if(mstrApp.isSingleTier&&BW.originTokenStream){Bc.originFormula=BW.originTokenStream;Bc.originAfb=BW.originAfb;Bc.originSfb=BW.originSfb;}if((BX.mptf||{}).dirty){Bd.push(AK(BX));}if(Ba){Bd.push(BV.getUpdateTemplateAction(Ba,[{act:"renameUnit",id:BX.did,type:4,name:BX.alias,isDynamicAlias:false}]));}else{Bc.name=BX.alias;}BY.submitUndoRedoUpdates(Bd,null,Be,{style:{params:{treesToRender:mstrmojo.DocDataService.EnumTreesToRender.BOTH}}});};},resetSelections:function BD(BW,BV,BX){Ao.call(this,{taskId:"resetSelections",rwb:this.rwb,unitKeyContext:BW||"",usePartDisplay:BV?"0":"1",treesToRender:BV?3:2},BX);},setPreference:function F(BV,BW){Ao.call(this,{taskId:"setPreference",prefs:BV},BW);},getObjectInfo:function Ab(BV,BW){Ao.call(this,B(BV,{taskId:"getObjectInfo"}),BW,X());},addSuppressData:function A0(BV){if(BQ(BV)===mstrmojo.DocDataService.EnumTreesToRender.NONE){e.copy({params:{suppressData:true}},BV);}},uploadImageToServer:function(BX,BY){var BW={taskId:"importImage",imageFieldName:"imageData",isEdit:1,fieldKey:BX.fieldKey,fieldName:BX.fieldName,imageName:encodeURIComponent(BX.imageName),imageSize:BX.imageSize,nodeKey:BX.nodeKey,sectionKey:BX.sectionKey,msgID:this.msgId||""};if(mstrApp.isSingleTier){var BV=";base64,";BW.rwNodeKey=BX.fieldGroupKey;BW.imageData=BX.base64Str.split(BV)[1]||BX.base64Str;mstrApp.serverRequest(BW,BY);}else{BW.imageData=BX.imageData;mstrmojo.xhr.upload("POST",mstrConfig.taskURL,BY,BW);}}});mstrmojo.DocDataService.Update=mstrmojo.declare(null,null,{scriptClass:"mstrmojo.DocDataService.Update",actions:null,callback:null,extras:null,init:function Al(BV){B(BV,this);this.actions=this.actions||[];this.callback=this.callback||{};this.extras=this.extras||{};},addActions:function Af(BV){this.actions=this.actions.concat(Ar(BV));},addCallbacks:function A2(BV){this.callback=z.wrapMethods(this.callback,BV);},addExtras:function AZ(BW){var BV=BQ(BW),BX=BQ(this.extras);this.extras=B(BW,this.extras);if(BV!==undefined&&BX!==undefined){this.extras.style.params.treesToRender|=BX;}},addUpdate:function Ac(BV){this.add(BV.actions,BV.callback,BV.extras);},setTreesToRender:function BU(BV){if(BV){this.addExtras({style:{params:{treesToRender:BV}}});}return this.extras.style.params.treesToRender;},add:function b(BW,BX,BV){if(BW){this.addActions(BW);}if(BX){this.addCallbacks(BX);}if(BV){this.addExtras(BV);}},submit:function AC(){var BW=this.actions,BX=this.callback,BV=this.extras;if(this.cmd){this.cmd.submit(BW,BX,BV);}else{this.ds.submitUpdates(BW,BX,BV);}}});mstrmojo.DocDataService.PUInfoType=null;mstrmojo.DocDataService.ExtrasType=null;mstrmojo.DocDataService.PROGRESS_CONFIG={showProgress:true,hideProgress:true,progressStateText:AO,delay:true};mstrmojo.DocDataService.UNDO_KEY="undo";mstrmojo.DocDataService.REQUEST_DEFN_DATA={style:{params:{treesToRender:3}}};mstrmojo.DocDataService.REQUEST_ONLY_DEFINITION={style:{params:{treesToRender:1}}};mstrmojo.DocDataService.REQUEST_ONLY_DATASETS={style:{params:{treesToRender:0}}};mstrmojo.DocDataService.SUPPRESS_DATA={params:{suppressData:true}};mstrmojo.DocDataService.RAPID_EXEC={params:{suppressData:true,rapidExec:true}};mstrmojo.DocDataService.EMPTY_CALLBACK={success:mstrmojo.emptyFn};mstrmojo.DocDataService.CopyMoveDestinationType=null;mstrmojo.DocDataService.PARTIAL_UPDATE_FLAGS={FORMAT_CHANGE:1,DATA_CHANGE:2};mstrmojo.DocDataService.EnumTreesToRender={NONE:0,DEFN:1,DATA:2,BOTH:3};}());(function(){mstrmojo.requiresCls("mstrmojo.Obj","mstrmojo.color","mstrmojo.hash","mstrmojo.num","mstrmojo.array","mstrmojo.date");mstrmojo.requiresClsP("mstrmojo.mstr");var k=1,h=2,q=3,I=4,a=5,l=6,j=7,A=-1,J=-2,G=mstrmojo.color,M=mstrmojo.hash,d=mstrmojo.array,F=mstrmojo.num,O=mstrmojo.date,K,Z,t=mstrmojo.mstr.EnumDSSXMLObjectTypes;function p(AB,AA){return AB.every(function(AC){return AA(AC);});}function f(AC,AB,AA){return p(AC,function(AD){return AD.ttp===AB||AD.ttp===AA;});}function c(AB){var AA=AB.toFixed(2);return parseFloat(AA);}function o(AA){this.raiseEvent(M.copy(AA,{name:"modelEdit"}));}function u(AA){this.raiseEvent(M.copy(AA,{name:"selectedThresholdsChange"}));}function S(){var AA=this.basedOnId||this.metricId;return d.filterOne(this.data.gsi.mx,function(AB){return AB.did===AA;});}function m(AD){var AA=AD.expr.nds,AB=AA.length;if(AB!==1){return false;}var AC=AA[0],AM=AC.cs;if(!AC.m||!AM){return false;}var AL=AC.fnt,AG=AC.fn,AK=AM[0],AI=AM[1],AF=AK&&AK.v,AE=AI&&AI.v,AJ=F.parseNumeric(AF)||parseFloat(AF),AH=F.parseNumeric(AE)||parseFloat(AE);switch(AL){case 2:case 3:switch(AG){case 1:case 2:AD.flr=AL===2?-Infinity:0;AD.ceil=AJ;AD.ttp=AL===2?(AG===1?a:I):(AG===1?h:k);break;case 3:case 4:case 5:case 13:AD.flr=AJ;AD.ceil=isNaN(AH)?(AL===2?Infinity:100):AH;AD.ttp=AL===2?(AG===4?a:(AG===5?I:l)):(AG===4?h:(AG===5?k:q));break;default:return false;}break;default:switch(AG){case 11:AD.flr=-Infinity;AD.ceil=AJ;AD.ttp=j;break;case 17:case 10:AD.flr=AJ;AD.ceil=isNaN(AH)?Infinity:AH;AD.ttp=j;break;default:return false;}}return true;}mstrmojo.threshold.MetricThresholdData=null;mstrmojo.threshold.ThresholdModel=mstrmojo.declare(mstrmojo.Obj,null,{scriptClass:"mstrmojo.threshold.ThresholdModel",data:undefined,thresholds:undefined,orgThresholds:undefined,selectedThresholds:[],metricId:undefined,basedOnId:undefined,editorMode:0,init:function r(AB){this._super(AB);var AA=mstrApp.customization.getCustomThresholds();K=K||AA.color;Z=Z||AA.image;},ondataChange:function n(){this.thresholds=this.data.gsi.thresholds;this.saveOriginalData();},isAdvanced:function E(AE){var AB=this.thresholds;if(AB){var AH=AB[AE]||[],AV=false,AU,AO,AS="The expression is not supported by the Simple Threshold Exception Parser.";if(AH.length===0){return false;}if(AH.some(function(Ab){if(Ab.ttp===A){return true;}try{if(!m(Ab)){throw AS;}AO=Ab.expr.nds[0].m.did;}catch(Aa){return true;}if(AU&&AU!==AO){return true;}AU=AO;var AZ=Ab.rtp;if(AZ===3||AZ===10){return true;}var AW=Ab.scope;if(AW&&AW!==1){return true;}var AY=Ab.fmt||{};for(var AX in AY){if(AX!=="bc"&&AX!=="bgs"){return true;}else{AV=true;}}return false;})){return true;}if(AV&&!p(AH,function(AW){return AW.fmt&&(AW.fmt.bc||AW.fmt.bgs);})){return true;}this.basedOnId=AU;var AP=false,AN=this.getSimpleThresholdType(AE),AG=AH.length;if(AG>0&&AN!==J){var AR,AJ,AL;for(AR=0;AR<AG-1;AR++){AJ=AH[AR];AL=AH[AR+1];if(AJ.ceil!==AL.flr&&AJ.flr!==AL.ceil){AP=true;break;}}if(!AP){var AA=AH[0],AC=AH[AG-1],AK=AA.flr,AQ=AC.ceil,AD=AA.ceil,AF=AC.flr,AI=this.getMetricsCount(),AM=this.getMetricsMinValue(),AT=this.getMetricsMaxValue();switch(AN){case a:case I:AP=!(((AK===0||AK===-Infinity)&&(AQ===AI||AQ===Infinity))||((AD===AI||AD===Infinity)&&(AF===0||AF===-Infinity)));break;case h:case k:AP=!((parseInt(AK,10)===0&&parseInt(AQ,10)===100)||(parseInt(AD,10)===100&&parseInt(AF,10)===0));break;case j:AP=!(((AK===AM||AK===-Infinity)&&(AQ===AT||AQ===Infinity))||((AD===AT||AD===Infinity)&&(AF===AM||AF===-Infinity)));break;}}return AP;}else{return true;}}return false;},getSimpleThresholdType:function(AB){var AC=this.thresholds&&this.thresholds[AB],AA=J;if(AC){if(f(AC,q,h)){AA=h;}else{if(f(AC,q,k)){AA=k;}else{if(f(AC,l,I)){AA=I;}else{if(f(AC,l,a)){AA=a;}else{if(f(AC,j)){AA=j;}}}}}}return AA;},isImageBasedType:function N(AA){var AB=this.thresholds&&this.thresholds[AA];return AB&&!AB.some(function(AC){return AC.rtp!==4;});},getMetricsMaxValue:function(){var AA=S.call(this).max;return(AA===undefined)?3000000:AA;},getMetricsMinValue:function(){var AA=S.call(this).min;return(AA===undefined)?-3000000:AA;},getMetricsCount:function(){var AA=S.call(this).cnt;return AA===undefined?100:AA;},getServerThresholdValues:function B(){var AA=this.basedOnId||this.metricId,AB=this.thresholds&&AA in this.thresholds&&this.thresholds[AA];if(d.isArray(AB)&&AB.length>0&&AB[0].ttp===j){AB.sort(function(AD,AC){return AD.flr-AC.flr;});return{min:AB[0].ceil,max:AB[AB.length-1].flr};}return{min:undefined,max:undefined};},getFormatString:function(){var AC=this.data.nf,AB=this,AA=d.filterOne(AC,function(AD){return AD.id===AB.basedOnId;})||{};return AA.nfs||"";},getDefaultColors:function x(){return K;},getDefaultImages:function L(){return Z;},getNormalizedValue:function(AF,AD,AC,AH){var AB=null;if(AD===q||AD===h||AD===k){AB=AF/100;}else{if(AD===l||AD===a||AD===I){AB=AF/(this.getMetricsCount());}else{if(AD===j){var AE=this.globalMinMax(AC,AH),AA=AE.min,AG=AE.max;if(AH!==undefined&&AH<AG){AG=Math.max(AH,this.getMetricsMaxValue());}if(AC!==undefined&&AC>AA){AA=Math.min(AC,this.getMetricsMinValue());}if(AG===AA){return 1;}AB=(AF-AA)/(AG-AA);}}}if(AB<0){AB=0;}if(AB>1){AB=1;}return AB;},getRealValue:function(AE,AC,AB,AG){if(AC===q||AC===h||AC===k){return c(AE*100);}if(AC===l||AC===a||AC===I){return c(AE*this.getMetricsCount());}if(AC===j){var AD=this.globalMinMax(AB,AG),AA=AD.min,AF=AD.max;if(AG!==undefined&&AG<AF){AF=Math.max(AG,this.getMetricsMaxValue());}if(AB!==undefined&&AB>AA){AA=Math.min(AB,this.getMetricsMinValue());}return AA+AE*(AF-AA);}return null;},globalMinMax:function e(AB,AF){var AA=(AB!==undefined&&AB!==-Infinity)?AB:Infinity,AE=(AF!==undefined&&AF!==Infinity)?AF:-Infinity,AC=this.getServerThresholdValues(),AD=AC.min,AG=AC.max;AD=(AD===undefined)?Infinity:AD;AG=(AG===undefined)?-Infinity:AG;return{min:Math.min(AA,this.getMetricsMinValue(),AD),max:Math.max(AE,this.getMetricsMaxValue(),AG)};},getColorScheme:function(AB){var AA="custom",AC,AD,AE;K.forEach(function(AF){AE=AF.bands;AD=AB.length;if(AD!==AE.length){return ;}for(var AG=0;AG<AD;AG++){AC=mstrmojo.color.fixFullHexValue(AB[AG]);if(AE[AG].bc!==AC&&AE[AD-AG-1].bc!==AC){return ;}}AA=AF.id;});return AA;},getImageSetName:function Y(AE){var AD=Z[0].id,AA,AC=function(AF){return AF===AA.bands[0].url;};for(var AB=0;AB<Z.length;AB++){AA=Z[AB];if(AE.some(AC)){AD=AA.id;break;}}return AD;},getGridValueFormat:function P(){return this.data.gsi.fmts.va;},isMapReversed:function Q(AC,AA,AE){var AD=(AE?Z:K).filter(function(AF){return AF.id===AC;})[0],AB=AA[0];if(!AE){AB=G.fixFullHexValue(AB);}return AD&&AD.bands[0][AE?"url":"bc"]!==AB;},setConditionData:function U(AD,AB){var AC=AD.data,AA=AC.isNew;M.copy(AB,M.clear(AC));delete AC.isNew;AD.paint();AD.tree.onConditionEdit(AD,AA);},hasSelectedThresholds:function w(){return this.selectedThresholds.length>0;},isThresholdSelected:function g(AA){return this.selectedThresholds.indexOf(AA)!==-1;},toggleThresholdSelected:function b(AA,AC){var AG=this.selectedThresholds,AF=AG.indexOf(AA),AB=AF!==-1,AE=this.thresholds[this.metricId],AD=AE.indexOf(AA)!==-1;if(AD){if(AC&&!AB){AG.push(AA);}else{if(!AC&&AB){AG.splice(AF,1);}}u.call(this);}},addThresholds:function X(AA){var AB=this.thresholds[this.metricId];this.thresholds[this.metricId]=(AB||[]).concat(AA);o.call(this);},duplicateThreshold:function v(AB){var AD=this.thresholds[this.metricId],AA=AD[AB],AC=M.clone(AA);AD.push(AC);if(this.isThresholdSelected(AA)){this.toggleThresholdSelected(AC,true);}o.call(this);},deleteThreshold:function z(AA){var AC=this.thresholds[this.metricId];var AB=AC.indexOf(AA);if(AB!==-1){this.toggleThresholdSelected(AA,false);AC.splice(AB,1);}o.call(this);},moveThreshold:function D(AB,AD){var AC=this.thresholds[this.metricId],AA=AC.splice(AB,1);this.thresholds[this.metricId]=AC.slice(0,AD).concat(AA,AC.slice(AD,AC.length));o.call(this);},cleanUp:function R(){this.selectedThresholds=[];this.editorMode=mstrmojo.threshold.ThresholdModel.EDITOR_TYPES.AUTO;},clearData:function W(){var AA=this.thresholds;if(AA){AA[this.metricId]=undefined;}},saveOriginalData:function V(){this.orgThresholds=M.clone(this.thresholds);},setAttIdToNDE:function C(AC){if(!(AC instanceof Array)){AC=[AC];}var AB,AH,AD,AA,AG,AE=function(AI){AI.att.forEach(function(AJ){if(AJ.did===AG.did){AG.attId=AJ.attId;}});},AF=function(AI){AI.conid=AG.did;};for(AB=0;AB<AC.length;AB++){AA=AC[AB];for(AH in AA){AG=AA[AH];if(typeof AG==="function"||!(AG instanceof Object)){continue;}else{if(AH==="a"){if(AG.t===47&&AG.st===12033){M.forEach(this.controller.datasets,AE);AD=AA.fn;if(AD===22||AD===57){(AA.es||[]).forEach(AF);}}}else{this.setAttIdToNDE(AA[AH]);}}}}},showNumberFormat:function H(){var AB=S.call(this),AC=AB&&AB.min,AA=AB&&AB.max;return(typeof (AC)==="number"||typeof (AA)==="number")||(O.isDate(AC)||O.isDate(AA));}});mstrmojo.threshold.ThresholdModel.SLIDER_MODE={COLOR_BASED:0,IMAGE_BASED:1};mstrmojo.threshold.ThresholdModel.REPLACE_SYMBOL=[{n:"&#9679;",v:"1"},{n:"&#9632;",v:"2"},{n:"&#9830;",v:"3"},{n:"&#9670;",v:"4"},{n:"&#10070;",v:"5"},{n:"&#9784;",v:"6"},{n:"&#10047;",v:"7"},{n:"&#8984;",v:"8"},{n:"&#8680;",v:"29"},{n:"&#8679;",v:"30"},{n:"&#8681;",v:"31"}];mstrmojo.threshold.ThresholdModel.FEATURES={SHOW_ADVANCED_EDITOR:1,SHOW_BASED_ON:2,SHOW_IMAGE:3,SHOW_VALUE_ITEM:4};mstrmojo.threshold.ThresholdModel.EDITOR_TYPES={AUTO:0,ADVANCED_EDITOR:1,SIMPLE_EDITOR:2};mstrmojo.threshold.ThresholdModel.BASED_ON_TYPES={LOWEST_PERCENT:k,HIGHEST_PERCENT:h,BETWEEN_PERCENT:q,LOWEST:I,HIGHEST:a,BETWEEN:l,VALUE:j,COMPLEX:A,NONE:J};}());(function(){mstrmojo.requiresCls("mstrmojo.Obj","mstrmojo._LoadsScript","mstrmojo.Binding","mstrmojo._HasBindings","mstrmojo._HasMarkup","mstrmojo._HasTooltip","mstrmojo.css");mstrmojo.Widget=mstrmojo.declare(mstrmojo.Obj,[mstrmojo._LoadsScript,mstrmojo._HasBindings,mstrmojo._HasMarkup,mstrmojo._HasTooltip],{scriptClass:"mstrmojo.Widget",domNode:null,hasRendered:false,visible:true,enabled:true,tooltip:"",cssClass:"",cssText:"",cssDisplay:"block",slot:"",alias:"",parent:null,init:function A(C){this._super(C);var D=this.parent;if(!D||D.hasInitBindings){this.initBindings();}},destroy:function B(C){if(this.hasRendered){this.unrender(C);}if(this.bindings){this.destroyBindings();}this._super();},invalidate:mstrmojo.emptyFn,widgetResized:mstrmojo.emptyFn});mstrmojo.Widget.cssTextMarkupMethod=function(){this.domNode.style.cssText=this.cssText||"";};mstrmojo.Widget.visibleMarkupMethod=function(){this.domNode.style.display=(this.visible)?this.cssDisplay:"none";};mstrmojo.Widget.topMarkupMethod=function(){var C=this.top;if(C){this.domNode.style.top=C;}};mstrmojo.Widget.leftMarkupMethod=function(){var C=this.left;if(C){this.domNode.style.left=C;}};mstrmojo.Widget.heightMarkupMethod=function(){var C=this.height;if(C){this.domNode.style.height=C;}this.widgetResized();};mstrmojo.Widget.widthMarkupMethod=function(){var C=this.width;if(C){this.domNode.style.width=C;}this.widgetResized();};mstrmojo.Widget.enabledMarkupMethod=function(){mstrmojo.css.toggleClass(this.domNode,"disabled",!this.enabled);};}());(function(){mstrmojo.requiresCls("mstrmojo.Obj","mstrmojo.hash");var F=mstrmojo.hash;var D={SOLID_COLOR:0,NO_FILL:1,GRADIENT:2};mstrmojo.threshold.PropertyModel=mstrmojo.declare(mstrmojo.Obj,null,{scriptClass:"mstrmojo.threshold.PropertyModel",threshold:undefined,gridValueFormat:undefined,submitChange:function G(){this.raiseEvent({name:"propertyModelChange",threshold:this.threshold});},updateControl:function E(I){var H=this.threshold,J=F.copy(H.fmt,this.gridValueFormat);I.textGroup.setFormatSource(H);I.charGroup.setFormatSource(J);I.containerGroup.setFormatSource(J);},changeFormatProperty:function B(I,J,L){var H=this.threshold,K=I==="threshold"?H:H.fmt;if(!K&&I==="fmt"){K=H.fmt={};}K[J]=L;if(J==="bc"){if(typeof (L)==="string"){K.bgs=D.SOLID_COLOR;delete K.gdc;delete K.gda;}else{if(L===-1){K.bgs=D.NO_FILL;}else{K.bgs=D.GRADIENT;}}}},getReplaceTypeName:function A(){return"rtp";},getReplaceTextName:function C(){return"rtxt";}});}());(function(){mstrmojo.requiresCls("mstrmojo.func");var A=mstrmojo.string;mstrmojo.ResSetLink=mstrmojo.declare(mstrmojo.Obj,null,{scriptClass:"mstrmojo.ResSetLink",SAME_PROMPT:1,DO_NOT_ANSWER:2,CLOSE:3,DYNAMIC:4,STATIC:5,CURRENT_UNIT:6,ALL_VALID_UNITS:7,USE_DEFAULT_ANSWER:8,DYNAMIC_OR_SAME_PROMPT:9,toXml:function B(){var M=this,E=function(S,U){return" "+S+'="'+U+'"';},D=function(S,U){return E(S,mstrmojo.string.encodeXMLAttribute(U));},H=new mstrmojo.StringBuffer(),F=function(U,V){var S=mstrmojo.string.multiReplace(V.disp_n,{"&nbsp;":" "});U.append("<e"+D("ei",A.decodeXMLAttribute(V.ei))+D("disp_n",A.decodeXMLAttribute(S))+E("emt",V.emt)+"/>");};var K=this.prms,C=K&&K.length;if(C||M.aopam!=M.DO_NOT_ANSWER){H.append("<hl"+E("mid",M.mid)+E("srct",M.srct)+E("aopam",M.aopam)+">");if(C){H.append("<prms>");for(var G=0;G<C;G++){var R=K[G];H.append("<prm"+E("id",R.id)+E("am",R.am)+E("pt",R.pt));if(R.orid){H.append(E("orid",R.orid)+E("ortp",R.ortp));}H.append(">");switch(R.am){case M.DO_NOT_ANSWER:case M.CLOSE:case M.USE_DEFAULT_ANSWER:case M.SAME_PROMPT:break;case M.STATIC:H.append('<pa ia="1"><es>');var Q=R.pa.es,P=Q&&Q.length||0;for(var L=P-1;L>=0;--L){var J=Q[L];F(H,J);}H.append("</es></pa>");break;case M.DYNAMIC:case M.CURRENT_UNIT:case M.DYNAMIC_OR_SAME_PROMPT:var O=R.pa;if(O){H.append('<pa ia="1">');var N=O.a;if(N){H.append("<a"+E("id",N.id)+D("n",N.n)+">");}if(R.pt===1){H.append(mstrmojo.string.encodeXMLAttribute(O.v));}else{H.append("<es"+E("dispForms",N&&N.dispForms>=0?N.dispForms:"")+">");var Q=O.es;P=Q&&Q.length||0;for(var L=P-1;L>=0;--L){var J=Q[L];F(H,J);}H.append("</es>");if(N){H.append("</a>");}}H.append("</pa>");}break;case M.ALL_VALID_UNITS:var O=R.pa;if(O){H.append('<pa ia="1">');var N=O.a,I=(N&&N.length)||0,G;if(I===0&&R.pt===1){H.append(mstrmojo.string.encodeXMLAttribute(O.v));}else{H.append("<attGroups><attGroup>");for(G=0;G<I;G++){H.append("<a"+E("id",N[G].id)+D("n",N[G].n)+">");if(R.pt===1){H.append(mstrmojo.string.encodeXMLAttribute(O.v));}else{H.append("<es"+E("dispForms",N[G].dispForms>=0?N[G].dispForms:"")+">");F(H,O.es[G]);H.append("</es>");}H.append("</a>");}H.append("</attGroup></attGroups>");}H.append("</pa>");}}H.append("</prm>");}H.append("</prms>");}else{H.append("<prms/>");}H.append("</hl>");}return H.toString();}});})();(function(){mstrmojo.requiresCls("mstrmojo.Obj","mstrmojo.hash","mstrmojo._Fetchable");var A=mstrmojo.hash;mstrmojo.mstr.DocElementDataHelper=mstrmojo.declare(mstrmojo.Obj,[mstrmojo._Fetchable],{scriptClass:"mstrmojo.mstr.DocElementDataHelper",source:null,items:null,browseConfig:null,concat:true,init:function(B){var C=B&&B.browseConfig;this.blockBegin=(C&&C.blockBegin)||1;this.blockCount=(C&&C.blockCount)||mstrApp.elementsBlockCount||30;if(this._super){this._super(B);}},getBrowseConfig:function(){if(!this.browseConfig){this.browseConfig={blockBegin:this.blockBegin,blockCount:this.blockCount};}return this.browseConfig;},_retrieveItems:function(E,C,B){var D=this.getBrowseConfig();D.blockBegin=E;mstrmojo.func.override({success:function(F){if(this._super){this._super(mstrmojo.hash.copy(F,{items:F.es,totalSize:F.sz}));}}},C);this.source.browseElements(D,C,B);}});}());(function(){mstrmojo.requiresCls("mstrmojo.Obj");var D={TOP_LEFT:1,TOP_RIGHT:2,BOTTOM_RIGHT:3,BOTTOM_LEFT:4};var C={LEFT_TO_RIGHT:0,RIGHT_TO_LEFT:1};mstrmojo.ui.PopupConfig=mstrmojo.declare(mstrmojo.Obj,null,{scriptClass:"mstrmojo.ui.PopupConfig",ENUM_CORNERS:D,isHostedWithin:true,position:null,hostProxyCssClass:"",hostId:"",hostElement:null,anchorElement:null,popupHandlers:null,alignment:null,alignWithAnchor:false,useTooltip:false,useDarkTheme:false,init:function H(I){this.clear();this._super(I);},setAlignment:function E(I,J){this.alignment={host:I,popup:J};},addPopupHandlers:function F(I,K,J){this.popupHandlers[I]={open:K,close:J};},clear:function B(){this.popupHandlers={};var I=this.ENUM_CORNERS;this.alignment={host:I.BOTTOM_LEFT,popup:I.TOP_LEFT};},destroy:function(I){this.anchorElement=null;this.hostElement=null;if(this._super){this._super(I);}}});mstrmojo.ui.PopupConfig.ENUM_CORNERS=D;mstrmojo.ui.PopupConfig.directionCfg={menuDirection:C.LEFT_TO_RIGHT,isRightToLeft:function G(){return this.menuDirection===C.RIGHT_TO_LEFT;},setDirection:function A(I){this.menuDirection=I?C.RIGHT_TO_LEFT:C.LEFT_TO_RIGHT;}};}());(function(){mstrmojo.requiresCls("mstrmojo.Obj");function B(J,I){this.raiseEvent({name:"viCompBuilt",type:J,widget:I});}mstrmojo.vi.models.VIComponentMap=mstrmojo.declare(mstrmojo.Obj,null,{scriptClass:"mstrmojo.vi.models.VIComponentMap",init:function G(I){this._super(I);this.relativePanels={};this.comps={};},addRelativePanel:function H(I){this.relativePanels[I]=true;},isRelativePanel:function F(I){return !!this.relativePanels[I];},isComponent:function C(J,I){return this.getComponentKey(J)===I;},getComponent:function A(I){return this.comps[I];},getComponentKey:function D(J){var I=this.getComponent(J);return(I&&I.k)||"";},createComponent:function E(L,K,J){B.call(this,L);var I=new K(J);this.comps[L]=I;B.call(this,L,I);return I;}});mstrmojo.vi.models.VIComponentMap.TYPES={FILTER_STACK:1,FILTER_PANEL:2,PAGEBY_STACK:3,PAGEBY_PANEL:4,VIZ_CONTENT:5,MAIN_CONTENT:6};}());(function(){mstrmojo.requiresCls("mstrmojo.Obj");var M=mstrmojo.DI.DIConstants,H=mstrmojo.array,D=M.dbType,F=M.xdaType,I=M.sourceType,K=M.backendSourceSubtype;mstrmojo.DI.DIDatabaseHelper=mstrmojo.declare(mstrmojo.Obj,null,null);mstrmojo.DI.DIDatabaseHelper.getImportOptionByDBType=function A(N){switch(N){case D.SAP:case D.MSFT_AS:case D.ESSBASE:case D.TM1:case D.PIG:return false;default:return true;}};mstrmojo.DI.DIDatabaseHelper.getSourceTypeByDBType=function E(N){switch(N){case D.SAP:case D.MSFT_AS:case D.ESSBASE:case D.TM1:return F.mdx;case D.PIG:return F.ffsql;default:return -1;}};mstrmojo.DI.DIDatabaseHelper.getDescriptionIdByDBType=function(N){switch(N){case D.MS_ACCESS:return 9149;case D.ORACLE:return 8545;case D.SQL_SERVER:return 8552;case D.INFORMIX:return 12995;case D.SYBASE:return 12998;case D.REDBRICK:return 10059;case D.DB2:return 8516;case D.TERADATA:return 8553;case D.SAP:return 13107;case D.NETEZZA:return 8558;case D.EXCEL:return 3958;case D.MSFT_AS:return 13225;case D.ESSBASE:return 13224;case D.MYSQL:return 8556;case D.POSTGRESQL:return 8541;case D.COMPOSITE:return 12991;case D.ASTER:return 10058;case D.VERTICA:return 10062;case D.PARACCEL:return 10056;case D.TM1:return 13223;case D.XQUERY:return 8560;case D.HIVE:return 8561;case D.SALESFORCE:return 9213;case D.SAPHANA:return 12997;case D.GOOGLE_BIGQUERY:return 12450;default:return 4444;}};mstrmojo.DI.DIDatabaseHelper.getOASTFromBEST=function L(N){switch(N){case K.googleBigQuery:case K.googleBigQueryFFSQLModel:case K.googleBigQuerySingleTable:return I.googleBigQuery;case K.dropbox:return I.dropbox;case K.googleAnalytics:return I.googleAnalytics;case K.googleDrive:return I.googleDrive;case K.facebook:return I.facebook;case K.twitter:return I.twitter;case K.salesforce:return I.salesforce;default:return -1;}};mstrmojo.DI.DIDatabaseHelper.isOAuthSourceType=function C(N){var O=[I.googleBigQuery,I.dropbox,I.googleAnalytics,I.googleDrive,I.facebook,I.twitter,I.salesforce];return H.indexOf(O,N)!==-1;};mstrmojo.DI.DIDatabaseHelper.filterDBById=function B(P,N,O){return H.filter(P,function(S){var R=H.indexOf(N,S.id),Q;if(R>-1){Q=O;}else{Q=!O;}return Q;});};mstrmojo.DI.DIDatabaseHelper.filterDBByDispOption=function B(P,N,O){return H.filter(P,function(R){var Q=false;if((R.disp&N)===N){H.forEach(O,function(S){if(R.id===S){Q=true;return false;}});return !Q;}});};mstrmojo.DI.DIDatabaseHelper.getDBIds=function J(O){var N=[];H.forEach(O,function(P){N=N.concat(P.id);});return N;};mstrmojo.DI.DIDatabaseHelper.getUniqueDBTypes=function G(P){var O=[],N;H.forEach(P,function(Q){N=H.indexOf(O,Q.dbType);if(N<0){O.push(Q.dbType);}});return O;};mstrmojo.DI.DIDatabaseHelper.filterDBByAdminConfig=function(O,N){return H.filter(O,function(R){var P=H.indexOf(N,R.id),Q=true;if(P>=0){Q=false;}return Q;});};}());(function(){mstrmojo.requiresCls("mstrmojo.hash","mstrmojo.func","mstrmojo.Obj");var K=mstrmojo.hash;var P=0;var F=[];var J={};var L=false;function I(U){var V=U.callback;if(V.submission){V.submission(U.id,this.userInteractionRequired(U),U);}this.submitRequest(U);}function G(){if(F.length&&!L){I.call(this,F.shift());}}mstrmojo.ServerProxy=mstrmojo.declare(mstrmojo.Obj,null,{scriptClass:"mstrmojo.ServerProxy",transport:null,cnt:0,request:function E(e,b,V,W){if(V){this.cancelRequests();}var Y=this.id,Z=this.transport,U=mstrmojo.now()+b.taskId+P++,X=e.canceled||mstrmojo.emptyFn;e.canceled=function(f){X();e.complete(true);return Z.cancelRequest(f);};e=mstrmojo.func.wrapMethods(e,{complete:function(f){mstrmojo.all[Y]&&mstrmojo.all[Y].deleteRequest(f);}});var a=!K.isEmpty(this._requests),c=this.createRequest(U,e,b,W),d=(L||a)&&!W.doNotHold;if(d){F.push(c);}else{I.call(this,c);}return U;},hasRequests:function O(){return !K.isEmpty(this._requests)||L;},createRequest:function Q(W,Y,X,U){var V=this._requests;if(!V){V=this._requests={};}V[W]={id:W,callback:Y,params:X,config:U};return V[W];},submitRequest:function M(U){this.transport.serverRequest(this.id,U.id,U);},cancelRequests:function S(){var U=false;K.forEach(this._requests,function(V){if(V.gotResponse===undefined){U|=V.callback.canceled(V.id);}});this._requests={};F=[];return U;},cancelRequest:function B(Y){var V=false,X=this._requests[Y],W,U=F.length;for(W=0;W<U;W++){if(F[W]===X){break;}}if(W<U){F.splice(W,1);delete this._requests[Y];V|=X.callback.canceled(X.id);}return V;},response:function A(Y,U,W){$MAPF(false,"AndroidServerTransport","transportRequest");var X=this.getRequest(Y);if(X){X.gotResponse=true;var Z=X.callback,V=(U&&!W.mstrerr)?"success":"failure";try{if(Z[V]){Z[V](W,X);}}finally{Z.complete(Y);}}G.call(this);},deleteRequest:function N(V){var U=this._requests;delete U[V];},getRequest:function H(V){var U=this._requests;return U&&U[V];},userInteractionRequired:function C(U){return false;},addLoadingGraph:function D(U){J[U]=true;L=true;},removeLoadingGraph:function R(U){delete J[U];if(K.isEmpty(J)){L=false;G.call(this);}},_serverRequestParallel:function(V,X,Y,U){var W=U||new mstrmojo.SimpleXHR();W.request("POST",V,{success:function(Z){if(Y.success){Y.success(Z);}},failure:function(Z){if(Y.failure){Y.failure({code:Z.getResponseHeader("X-MSTR-TaskErrorCode"),message:Z.getResponseHeader("X-MSTR-TaskFailureMsg")});}},complete:function(){if(Y.complete){Y.complete();}}},X);},serverRequestParallel:function(V,W,U){this._serverRequestParallel(mstrConfig.taskURL,V,W,U);},upload:function(a,Z,Y,V,X,W,U){mstrmojo.xhr.upload("POST",mstrConfig.taskURL,a,Z,Y,V,X,W,U);}});}());(function(){mstrmojo.requiresCls("mstrmojo.Obj");mstrmojo.StepperContentProvider=mstrmojo.declare(mstrmojo.Obj,null,{scriptClass:"mstrmojo.StepperContentProvider",item:null,renderer:null,min:null,max:null,interval:1,minField:"min",maxField:"max",maxLengthField:"maxLength",valField:"value",intField:"interval",canLoop:false,next:mstrmojo.emptyFn,prev:mstrmojo.emptyFn,hasPrev:mstrmojo.emptyFn,hasNext:mstrmojo.emptyFn,renderItemAt:mstrmojo.emptyFn,setVal:mstrmojo.emptyFn,getVal:mstrmojo.emptyFn});}());(function(){mstrmojo.requiresCls("mstrmojo.Obj","mstrmojo.hash","mstrmojo.dom","mstrmojo.array");var R=Math,V=mstrmojo.publisher.hasSubs,Q=mstrmojo.hash,F=Q.forEach,b=mstrmojo.dom;var S=0.15;var e=1,U=2;var B={y:{edge:["top","bottom"],size:0},x:{edge:["left","right"],size:0},clsName:"mstrmojo-touch-scroll-indicator",init:function Z(){var j=this.y,h=this.x;if(!j.i){var k=j.i=document.createElement("div");k.className=this.clsName;var l=h.i=k.cloneNode(false);document.body.appendChild(k);document.body.appendChild(l);}},setGradient:function a(p,k,q,m){var o=p.i,j=p.edge[k?1:0];var n=R.min(R.round(R.min(R.abs(q)/200,1)*100),m/2),h="left top",l="left bottom";if(k){l=h;if(j==="bottom"){h="left bottom";}else{h="right top";}}else{if(j==="left"){l="right top";}}if(n!==p.size){o.style.background="-webkit-gradient(linear, "+h+", "+l+", from(rgba(39, 104, 162, .4)), to(rgba(39, 104, 162, 0)), color-stop("+(n/100)+", rgba(39, 104, 162, 0)))";p.size=n;}},scrollAxis:function D(l,v,n,t,k){var AB=v-n,j=k[l]=(AB!==0);if(!j){this.hide(l);return ;}var o=this[l],r=o.i,h=r.style,p=(l==="y"),q=(AB>0),u=this.clsName+" "+o.edge[q?1:0];if(!o.size||r.className!==u){r.className=u;var w="px",AC=3,x=t.y,m=t.x,z=100,AA=t.w;if(p){if(q){x+=t.h-z-AC;}}else{AA=z;z=t.h;if(q){m+=t.w-AA-AC;}}h.top=x+w;h.left=m+w;h.width=AA+w;h.height=z+w;h.display="block";}this.setGradient(o,q,AB,p?t.h:t.w);},scroll:function D(l,k,o,n,r){var q=k.x,p=k.y;if(q!==o||p!==n){this.init();var m=this._widgetPosition;if(!m){var h=l.indicatorEl||r;m=mstrmojo.dom.position(h.parentNode);}var j=l._outOfBounds||{};this.scrollAxis("y",p,n,m,j);this.scrollAxis("x",q,o,m,j);this._widgetPosition=m;l._outOfBounds=j;}else{this.hideAll();delete l._outOfBounds;}},hide:function M(j){var h=this[j];if(h.size!==undefined){h.i.style.display="none";h.i.className=this.clsName;h.size=0;}},hideAll:function c(){this.hide("y");this.hide("x");delete this._widgetPosition;}};function X(h,j){return j?R.max(R.min(R.round(h),j.end),j.start):h;}function O(h,k,j){j.name=k;j.id=h.identifier;h.raiseEvent(j);}function G(){var j="scrollDone",h=this.origin;if(V(this.id,j)&&h){O(this,j,{x:h.x,y:h.y});}this.stopDeceleration();}function I(k,j,n){var m=k.scrollEl;if(!m){G.call(k);return ;}var l={x:j.x||0,y:j.y||0};F(k._scrollBarEls,function(AB,u){var AG=(u==="x"),AA=l[u],o=AB.length,AC=AB.ratio,x=AB.viewportSize,t=6/o,r=AB["base"+(AG?"Left":"Top")],z=r+x-o,q=R.round(r+(AC*AA));if(q<r){q=r-AA;o+=AA;}else{if(q>z){var AF=(AA-k.offset[u].end)*AC;q=R.min(z+AF,x+r-6)-1;o-=AF;}}var AE=0,p=[AE,AE,AE],w=[1,1,1],AD=AG?0:1;p[AD]=(q-r);w[AD]=R.min(R.max(o/AB.length,t),1);b.translate(AB,p[0],p[1],p[2]," scale3d("+w.join(",")+")");});if(n){n+="ms";}if(k._isHosted){var h=m.parentNode;h.scrollTop=l.y;h.scrollLeft=l.x;}else{m.style[b.CSS3_TRANSITION_DURATION]=n||"0";b.translate(m,-l.x,-l.y,0,k.transform,k.useTranslate3d);}if(V(k.id,"scrollMoved")){O(k,"scrollMoved",{x:j.x,y:j.y});}}function J(h,j,k){return R.ceil(1+R.log(h/R.abs(j))/R.log(1-k));}function E(h,m,k,j,l){return h+(m*(k*(1-R.pow(1-l,j))/l));}function N(AG,AQ,n,AM,x,AL,t){var r=AG.offset[n];if(!r){return AQ;}var m=AG._outOfBounds,j=m&&m[n],v=r.incFetch,w=AG.friction,q=r.start,p=r.end,AH=AM?p:q;x=R.abs(x);if(j){AM=(AQ<q);AH=AM?q:p;}var AP=AM?1:-1;if(j&&(AM||!v)){var u=S*3,AO=1/(1-w),l=u/R.pow((1-w),(R.log(1-R.abs(AQ-AH)*(1-AO)/u)/R.log(AO))-1);var AE=R.round(E(AQ,AP,l,AL,w));if(AM?(AE>=AH):(AE<=AH)){G.call(AG);return AH;}return AE;}var AK=r.pageSize,AJ=r.supportedEdges;var o=E(AQ,AP,x,AL,w),z=(o<=q),k=(o>=p);if(z||k){if(v&&((z&&((AJ&e)>0))||(k&&((AJ&U)>0)))){if(o-p>=AK){o=p+AK;AH=o;}if(!AG.STATUS_INC_FETCH){AG.STATUS_INC_FETCH=true;O(AG,"incFetch",{edge:k?U:e});}}else{if(AG.bounces){var AN=w*2,AA=AG.bounceVelocity,h=AG.bounceTime,AI=AG.bounceDistance;if(!AG.hasBounced){AA[n]=R.abs(S/R.pow(1-w,t-AL-1));h[n]=J(S,AA[n],AN);AI[n]=R.abs(E(o,AP,AA[n],h[n],AN)-o);AG.raiseEvent({name:"bounceOut",id:AG.identifier,axis:n,direction:AM,value:R.round(o)});AG.hasBounced=true;}var AD=Math.floor(AI[n]/2);var AC=E(AH,AP,AA[n],AL,AN),AF=R.abs(AC-AH);if(R.abs(AF)<AD){return AC;}if(R.abs(AF)>=AI[n]){G.call(AG);return AH;}var AB=AD-(AF-AD);return R.round(AH-(AM?-AB:AB));}o=AH;}}return R.round(o);}function P(j){var h=this._scrollListener;if(h){if(!j||j!==h.el){b.detachEvent(h.el,"scroll",h.fn);delete this._scrollListener;return true;}return false;}return true;}mstrmojo.TouchScroller=mstrmojo.declare(mstrmojo.Obj,null,{scriptClass:"mstrmojo.TouchScroller",scrollEl:null,identifier:"",hScroll:false,vScroll:false,offset:null,origin:null,transform:"",friction:0.0015,frameRate:60,bounces:true,hasBounced:false,bounceDistance:{},bounceTime:{},bounceVelocity:{},showScrollbars:false,showIndicators:true,useTranslate3d:true,STATUS_INC_FETCH:false,init:function Z(h){this._super(h);B.init();},initScroller:function Y(j){Q.copy(j,this);var m=this.scrollEl;if(m){var l=this._isHosted=false;if(l){var h=m.parentNode;if(P.call(this,h)){h.style.overflow="auto";var n=this.id,k=this._scrollListener={el:h,fn:function(o){var p=mstrmojo.all[n].origin,q=o.target;p.x=q.scrollLeft;p.y=q.scrollTop;}};b.attachEvent(h,"scroll",k.fn);}this.showScrollbars=false;}}},canScroll:function L(){return this.vScroll||this.hScroll;},updateScrollBars:function H(p,l){var n=this.scrollEl;if(!this.showScrollbars||!n){return ;}var j=this._scrollBarEls;if(!j){var m=this;j=this._scrollBarEls={x:"hScroll",y:"vScroll"};F(j,function(q,r){if(m[q]){var t=document.createElement("div");t.className="mstrmojo-touch-scrollBar "+r+"Axis";(l||n.parentNode).appendChild(t);j[r]=t;}else{delete j[r];}});}if(!p){var h=this.scrollEl.parentNode;p={top:0,right:h.clientWidth,bottom:h.clientHeight,left:0};}var o=9,k={x:{left:p.left,top:p.bottom-o,x:p.right-p.left,d:"Width"},y:{left:p.right-o,top:p.top,x:p.bottom-p.top,d:"Height"}};F(j,function(w,t){var AD=w.style,AB=k[t],u=AB.d,v=w.parentNode,AC=AB.x;var r=AB.left,AA=AB.top,z=AC/n["offset"+u],q=Math.min(Math.round(AC*z),AC);w.baseLeft=r;w.baseTop=AA;w.ratio=z;w.viewportSize=AC;w.length=q;AD.left=r+"px";AD.top=AA+"px";AD[u.toLowerCase()]=q+"px";});},toggleScrollBars:function C(h){F(this._scrollBarEls,function(j){j.style.opacity=h?1:0;});},scrollTo:function(j,n,l){if(!this.canScroll()&&!(j===0&&n===0)){I(this,{x:0,y:0});return ;}var m=this.offset,k=this.origin,h={x:(this.hScroll)?X(j,m.x):0,y:(this.vScroll)?X(n,m.y):0};I(this,h,l);k.x=h.x;k.y=h.y;},scrollToEnd:function(j,n,l){var k=this.origin,m=this.offset,h={x:0,y:0};if(k&&m){mstrmojo.array.forEach([j,n],function(p,o){var r=o?"y":"x",q=m[r];h[r]=p?(q&&q.end)||0:k[r];});}this.scrollTo(h.x,h.y,l);},scroll:function D(n){if(this._isHosted){return ;}var l=this.offset,v=this.scrollEl,x=n.delta,z=x.x,w=x.y;if(!v){return ;}if(!l&&this.showIndicators){B.scroll(this,{x:(this.noHScroll)?0:-z,y:(this.noVScroll)?0:-w},0,0,v);return ;}var u=this.origin,o={x:(this.hScroll)?R.round(u.x-z):0,y:(this.vScroll)?R.round(u.y-w):0},r=X(o.x,l.x),q=X(o.y,l.y);if(!l.scrollPast){if(this.showIndicators){B.scroll(this,o,r,q,v);}o.x=r;o.y=q;}else{var m=(r!==o.x),p=(q!==o.y),h=(m||p),k=this._outOfBounds,j="";if(k){if(m!==(k.x===true)||p!==(k.y===true)){j="scrollIn";}}else{if(h){j="scrollOut";}}if(j){if(V(this.id,j)){var t=n.direction;O(this,j,{x:{position:o.x,direction:t.x},y:{position:o.y,direction:t.y}});}if(h){this._outOfBounds={x:m,y:p};}else{delete this._outOfBounds;}}}I(this,o);},scrollEnd:function W(w){B.hideAll();if(!this.canScroll()||this._isHosted){return ;}var AF=this.id,x=this.friction,AN=1/(1-x),AG=this.origin,l=w.velocity,AL=w.direction,AE=new Date(),m=this._outOfBounds,t=this.offset,AM={x:this.hScroll,y:this.vScroll},z={},AP={},AO={},u={},o={},v={},q={},p={},AI={},AK=function(AS){v[AS]=S;var AR=t[AS],AQ=(m&&m[AS]),AT=(AQ&&(!AR||!t.scrollPast));AP[AS]=(AM[AS]&&!AT)?AG[AS]-w.delta[AS]:AG[AS];if(AR){q[AS]=AR.start;p[AS]=AR.end;if(AQ){if(!AT){AL[AS]=(AP[AS]<q[AS]);AI[AS]=(AL[AS])?q[AS]:p[AS];if(AL[AS]||!AR.incFetch){v[AS]=S*3;l[AS]=v[AS]/R.pow((1-x),(R.log(1-R.abs(AP[AS]-AI[AS])*(1-AN)/v[AS])/R.log(AN))-1);}}else{AP[AS]=X(AG[AS]-w.delta[AS],AR);}}}z[AS]=(AM[AS]&&!AT)?R.abs(l[AS]):0;AO[AS]=(AL[AS]||false)?1:-1;u[AS]=J(v[AS],z[AS],x);o[AS]=E(AP[AS],AO[AS],z[AS],u[AS],x);};AK("x");AK("y");AG.x=AP.x;AG.y=AP.y;var AC=(z.x>0),AB=(z.y>0);if(!t.scrollPast&&!AC&&!AB){G.call(this);var n,AH,AA,k,AJ;for(n in t){AH=t[n];AJ=AH.supportedEdges;AA=((AH.start===AP[n])&&((AJ&e)>0));k=((AH.end===AP[n])&&((AJ&U)>0));if(AH.incFetch&&(AA||k)){this.STATUS_INC_FETCH=true;O(this,"incFetch",{edge:k?U:e});}}return ;}this.hasBounced=false;this.bounceDistance={};this.bounceTime={};this.bounceVelocity={};this.decelerating=true;var j=Math.round(1000/this.frameRate),r=AE,AD,h={x:AC,y:AB};this.decelerationTimer=window.setTimeout(function(){var AQ=mstrmojo.all[AF],AR=AQ.origin,AV=new Date(),AW=(AV-AE),AU;if(AQ._halt){G.call(AQ);return ;}AD=AV-r;r=AV;if(AD>(j+5)){j=j+R.round((AD-j)/2);}for(AU in h){if(h[AU]){var AT=N(AQ,AP[AU],AU,AL[AU],z[AU],AW,u[AU]);if(!isNaN(AT)){AR[AU]=AT;}}}I(AQ,AR);var AS=(AW>u.x&&AW>u.y);if(!AS&&!AQ.bounces){AS=true;mstrmojo.hash.forEach(t,function(AZ,AY){var AX=AR[AY];if(AX!==AZ.end&&AX!==AZ.start){AS=false;return false;}});}if(AS){G.call(AQ);}else{if(AQ.decelerating){AQ.decelerationTimer=window.setTimeout(arguments.callee,j);}}},j);},stopDeceleration:function A(){var h=!!this.decelerating;if(h){if(this.decelerationTimer){window.clearTimeout(this.decelerationTimer);delete this.decelerationTimer;}delete this.decelerating;this.toggleScrollBars(false);}delete this._outOfBounds;delete this.hasBounced;delete this.bounceDistance;delete this.bounceTime;delete this.bounceVelocity;delete this._halt;return h;},haltScroller:function K(){this._halt=!!this.decelerating;},unrender:function d(){delete this.scrollEl;},destroy:function f(){this.stopDeceleration();P.call(this);this._super();}});mstrmojo.TouchScroller.getScrollPositionTotals=function g(m){var k=m.parent,h=m._scroller,j=mstrmojo.hash.copy((h&&h.origin)||{x:0,y:0});if(k){var l=mstrmojo.TouchScroller.getScrollPositionTotals(k);j.x+=l.x;j.y+=l.y;}return j;};mstrmojo.TouchScroller.ScrollIndicators=B;mstrmojo.TouchScroller.EnumIncFetchEdges={start:e,end:U};}());(function(){mstrmojo.requiresCls("mstrmojo.Base","mstrmojo.desc","mstrmojo.dom","mstrmojo.hash","mstrmojo.MetricSelectorUtility","mstrmojo.mstr.EnumDataType","mstrmojo._FormatDefinition","mstrmojo.num","mstrmojo.array");var M=mstrmojo.MetricSelectorUtility,I=mstrmojo.mstr.EnumDataType,V=mstrmojo._FormatDefinition.NumberFormatCategory,B=M.FN,Q=M.Q,C=M.OP,X=mstrmojo.num,H=Math.max,D=Math.min,A=Math.round;mstrmojo.vi.ui.rw.selectors.ISliderHelper=mstrmojo.declare(mstrmojo.vi.ui.rw.selectors.SliderHelper,null,{scriptClass:"mstrmojo.vi.ui.rw.selectors.ISliderHelper",initAsStaticStatus:function K(){var Y=this.slider;Y.staticStatus=Y.disableDrag=this.isStatic();if(Y.staticStatus){Y.da.low=1;Y.da.high=7;Y.ft=M._GENERIC;Y.f=B.BETWEEN;Y.cs=[{n:"",v:1},{n:"",v:7}];Y.numFmts={cat:9,dp:0,fm:""};}if(this.displayInvalid()){Y.f=B.BETWEEN;Y.cs=[];}},initialSlider:function W(){this.initAsStaticStatus();this.createDataRangeItems();this.updateCurrentSelectionFromModel();},createDataRangeItems:function L(){var a=this.slider,j=this.fixDigitByNumFormat,b=this.notNull,c=a.numFmts,k=a.qua,Z=a.da.cnt,Y,f;switch(k){case Q._G:Y=j(a.da.low,c);f=j(a.da.high,c);a.step=this.getValueStep(Y,f);break;case Q._RB:case Q._RT:Y=Z?1:0;f=Z;a.step=this.getValueStep(Y,f);break;case Q._PB:case Q._PT:Y=0;f=100;a.step=this.getValueStep(Y,f);break;}var e=this.isEmpty();a.set("lowText",e?"":this.formatNumber(Y));a.set("highText",e?"":this.formatNumber(f));a.low=Y;a.high=f;var h=[],g,d;if(b(Y,f)){if(Y+a.step<=Y){a.set("validation",{refNode:a.docSelector.parent.domNode,position:1,invalid:true,errorCode:"bigDecimalMetricSliderVIWaring"});}else{for(d=Y;d<=f;d+=a.step){h.push(this.getItem(k,d,c));}g=h.length;if(g>0){h[g-1]=this.getItem(k,f,c);}}}a.items=h;a.unit=this.getUnit();},getItem:function O(Z,b,Y){var a=this.fixDigitByNumFormat(b,Y),c=(Z===Q._RB||Z===Q._RT)?String(parseInt(a,10)):M.formatNumber(Z,b,Y);return{n:c,v:a};},getValueStep:function G(a,b){var Z=this.slider,Y=Z._effectiveLength;return this.fixDigitByNumFormat(b-a,Z.numFmts)/(Y-2)||1;},getIdxByValue:function J(Z){var Y=this.slider;return D(H(A((Z-Y.low)/Y.step),0),Y.items.length-1);},isStatic:function P(){var Y=this.slider;return !this.notNull(Y.da,Y.da.low,Y.da.high,Y.da.cnt,Y.qua);},isEmpty:function R(){var Y=this.slider;return this.isStatic()||!!Y.da.nov;},displayInvalid:function F(){var Y=this.slider;var c=parseInt(Y.ft,10),a=parseInt(Y.f,10),b,Z;if(c===M._GENERIC){b=a===B.ISNULL||a===B.ISNOTNULL||a===B.NOTIN||a===B.IN;}else{if(c===M._PERCENT||c===M._RANK){Z=a===M.MRPFN.INASCENDING||a===M.MRPFN.INDESCENDING||a===M.MRPFN.NOTINDESCENDING||a===M.MRPFN.NOTINASCENDING;}}return !!b||!!Z;},fixDigitByNumFormat:function E(Z,d){var b=parseInt(d.cat,10),Y=(b===V.Custom&&d.fm&&d.fm.indexOf("%")>=0),a=Y?2:d.dp,c=(b===V.Percentage||b===V.General||Y)?2:(b===V.Fraction)?4:0;return Number(Number(Z).toFixed(Math.min(a+c,20)));},formatNumber:function N(d){var a=this.slider,j=Math.abs(d),g=a.numFmts.cat,Z=1000,k=["K","M","B","T","P","E","Z","Y"],e=k.length,c;if(j>=Z&&(g===V.Default||g===V.Fixed||g===V.General||g===V.Currency)){for(c=0;c<e;c++,Z*=1000){if(j<Z*1000){var Y=j/Z,b=(Y*10).toFixed(0)%10>0?1:0,f=X.toLocaleString(Y.toFixed(b))+k[c];var h=M.formatNumber(a.qua,d<0?-1:1,a.numFmts);return h.replace(new RegExp("["+X.getDecimal()+"]0+","g"),"").replace("1",f);}}}return M.formatNumber(a.qua,d,a.numFmts);},updateCurrentSelectionFromModel:function S(){var a=this.slider,b=this.notNull,k=a.cs,j=a.f,g=a.ft,Y=a.low,h=a.high,m=a.qua,d=a.numFmts,e=(k&&k.length>0)?X.parseNumeric(X.toLocaleString(k[0].v).replace("%","")):m?h:Y,c=(k&&k.length>1)?X.parseNumeric(X.toLocaleString(k[1].v).replace("%","")):h,Z=a.include=a.parent.include,l;if(a.dt===I.DataTypeTimeStamp){d.fm=d.fm.replace(/\\/g,"");}if(m===Q._PT||m===Q._PB){e=(k&&k.length>0&&!String(k[0].v).match("%"))?e*100:e;}a.frtUst=e<Y;a.ndUst=c>h;a.unSet=!k||k.length===0;if(b(j,g)){l=M.getOpIdxByfunc(j,g);}else{if(Z){l=m?C._LESS_EQUAL:C._BETWEEN;}else{l=m?C._GREATER:C._NOT_BETWEEN;}}a.opId=l;switch(l){case C._EQUALS:case C._NOT_EQUALS:a.cs1Vl=a.cs2Vl=e;break;case C._LESS_EQUAL:case C._GREATER:a.cs1Vl=Y;a.cs2Vl=e;break;case C._GREATER_EQUAL:case C._LESS:a.cs1Vl=e;a.cs2Vl=h;break;case C._IN:case C._NOT_IN:case C._IS_NULL:case C._IS_NOT_NULL:break;default:a.cs1Vl=e;a.cs2Vl=c;break;}a.cs1Idx=this.getIdxByValue(a.cs1Vl);a.cs2Idx=this.getIdxByValue(a.cs2Vl);a.cs1Nm=b(a.cs1Vl)?M.formatNumber(m,a.cs1Vl,d):a.items[a.cs1Idx].n;a.cs2Nm=b(a.cs2Vl)?M.formatNumber(m,a.cs2Vl,d):a.items[a.cs2Idx].n;if(m){a.rankon.selectItemByField("v",m);}},updateSelection:function U(){var Z=this.slider,b=Z.cs1Vl,a=Z.cs2Vl,Y=parseInt(Z.qua,10),c=Z.numFmts;Z.cs1Idx=this.getIdxByValue(b);Z.cs2Idx=this.getIdxByValue(a);Z.cs1Nm=M.formatNumber(Y,b,c);Z.cs2Nm=M.formatNumber(Y,a,c);Z.unSet=false;this.updateOpCs();Z.parent.node.data.cs=Z.cs;}});}());(function(){mstrmojo.requiresCls("mstrmojo.hash","mstrmojo.array","mstrmojo.expr","mstrmojo.func","mstrmojo.css","mstrmojo.UUID","mstrmojo.fe.FilterUtils","mstrmojo.desc");var Q=mstrmojo.func,L=mstrmojo.hash,J=mstrmojo.array,N=mstrmojo.expr,U=mstrmojo.css,R=N.DTP,F=mstrmojo.UUID,V=mstrmojo.fe.FilterUtils,U=mstrmojo.css;var H=16,E=32;function O(a,Z,c){var X=L.copyProps(["did","t","st","n"],a),Y=(a.fs||[]).filter(function(d){return d.fnm==="LEVEL_NUMBER"||d.n==="LEVEL_NUMBER";})[0],b;if(Z){b={et:N.ET.AE,fn:N.FN.DESCENDANT,a:X,es:[{v:Z.v,n:Z.n}]};if(parseInt(c,10)>=Z.lv){b.cs=[{v:c-Z.lv,dtp:R.INTEGER},{v:2,dtp:R.INTEGER}];}}else{if(parseInt(c,10)>=0&&Y){b={et:N.ET.AQ,fn:N.FN.EQUAL,a:X,fm:{did:Y.did||Y.fid,n:Y.n||Y.fnm,dtp:R.INTEGER},cs:[{v:c,dtp:R.INTEGER}]};}}return b?V.getExprXml(b):"";}mstrmojo.ui._IsIncFetchHierarchyList=mstrmojo.provide("mstrmojo.ui._IsIncFetchHierarchyList",{_mixinName:"mstrmojo.ui._IsIncFetchHierarchyList",blockCount:500,getDataHelper:mstrmojo.emptyFn,getAttribute:mstrmojo.emptyFn,isHiearachyDisplay:mstrmojo.emptyFn,getItemMarkup:function C(Z,X){var Y;if(Z.fetcher){Y='<{@tag} class="item fetcher {@cls}" idx="{@idx}" style="{@style}"><span class="indent" style="padding-left: {@indent}px;"></span><span class="text">{@en@n}</span></{@tag}>';}else{Y=this._super(Z,X);}return Y;},isFetcher:function K(X){if(X instanceof HTMLElement){X=this.getItemFromTarget(X);}return X&&X.fetcher;},fetchItems:function I(X,Y){this._super(X,Q.wrapMethods(this.getFetchItemsCallback(X),Y));},fetchItemsThroughTaskCall:function P(b,g){var a=this.getDataHelper(),Z=this.getAttribute();if(a&&Z&&!this.isFetching){this.set("isFetching",true);var d=this,e=b.branch,X=parseInt(b.level,10),c=b.blockBegin||1,f=b.blockCount||this.blockCount,Y=b.browseFlags||0;a.set("browseConfig",L.copy({blockBegin:c,blockCount:f,browseFlags:Y,expressionXML:(e||X>=0)?O(Z,e,X):"",otp:Z.t,compress:1},L.copy(a.browseConfig)));a.getItems(c,Q.wrapMethods({success:function(h){if(h){L.copy({bb:c,bc:f},h);J.forEach(h.es,function(j){if(!j.pid&&j.pi>-1){j.pid=h.es[j.pi].v;delete j.pi;}L.copy({lv:j.lv||0,hcd:!!j.hcd,hid:!!j.hid,dhid:!!j.hid,pid:j.pid||""},j);});}}},g,{complete:function(h){d.set("isFetching",false);}}),{hideFailureErr:g.failure});}},getFlatDisplayItems:function B(X){return X.filter(function(Y){var Z=Y.fhid;delete Y.fhid;return !Z;});},getFetchItemsCallback:function M(a){var Z=this,Y=a.branch,b=parseInt(a.level,10),X=this.isHiearachyDisplay();return{success:function(c){if(c&&c.es){var e=c.es,d=c.bb+c.bc-1;if(c.sz>d&&!c.raad){e.push({v:"fetcher"+F.create(),n:mstrmojo.desc(1005,"More..."),fetcher:true,lv:X?(b>=0?b:(Y?Y.lv+1:0)):-1,config:L.copy({blockBegin:d+1},L.copy(a))});}if(!X){e.forEach(function(g){var h=g.hid,f=Z.getItemByValue(g.v);delete g.epd;delete g.hid;if(f){delete g.hcd;}L.copy({fhid:h,dhid:!f||f.dhid},g);});}if(Z.setDisplayParent){Z.setDisplayParent(e,null,true);}}}};},getMaxLevel:function A(){var X=this.getAttribute(),Y=(X&&X.lvfs||[]).length;if(Y>0){return Y-1;}return this._super?this._super():0;},getLevels:function D(){var X=this.getAttribute(),Y=X&&X.lvfs||[];return Y.map(function(a,Z){return{v:Z,n:a.lvfn};});},initElements:function S(c){if(this.isHiearachyDisplay()){delete this.displayRoots;var Z=this.getItems(),Y=Z.length,b,X;if(Y>0){if(this.raad){for(var a=Y-1;a>-1;a--){b=Z[a];if(b.fetcher&&b.fake){b.hid=true;X=J.find(b.parent&&b.parent.children,"idx",b.idx);if(X>-1){b.parent.children.splice(X,1);}X=J.find(b.displayParent&&b.displayParent.displayChildren,"idx",b.idx);if(X>-1){b.displayParent.displayChildren.splice(X,1);}}}}this.refresh();}else{this.fetchItems({browseFlags:E},c);}}else{this.clearItemsNode();this.fetchItems({blockCount:500,browseFlags:H},c);}},clearItemsNode:function G(){var X=this.itemsContainerNode;if(X){X.innerText="";this.updateScrollbars();}},onclick:function W(h){var e=h.getTarget(),Y=this.getItemNodeFromTarget(e),j=this.getItemFromTarget(e);if(j&&j.fetcher){if(U.hasClass(e,"text")){if(j.fake){var d=function(k){if(k.displayParent){if(!k.displayParent.hid){return k.displayParent;}else{return d(k.displayParent);}}},b=d(j),a=b?b.displayChildren:this.getDisplayRoots(),f=this.items,X=j.config.nextSiblingIdx,c=this.blockCount,Z=X+c,g;if(a.length-1>Z){g=a.slice(X,Z);j.config.nextSiblingIdx+=c;j.lv=g[g.length-1].lv;g.push(j);}else{a.pop();if(j.parent){j.parent.children.pop();}f.splice(J.find(f,"idx",j.idx),1);g=a.slice(X,a.length);}Y.outerHTML=this._buildSiblingsMarkup(g).join("");this.updateScrollbars();}else{this.fetchItems(j.config,{success:function(k){j.hid=true;Y.outerHTML="";}});}}h.cancel();}else{this._super(h);}},});}());(function(){mstrmojo.requiresCls("mstrmojo.ListMapper");var D=1,B="mstrmojo-itemwrap";mstrmojo.ListMapperHoriz=mstrmojo.provide("mstrmojo.ListMapperHoriz",mstrmojo.hash.copy({markupPrefix:'<table class="mstrmojo-itemwrap-table" cellspacing="0" cellpadding="0"><tbody><tr>',markupSuffix:"</tr></tbody></table>",itemWrapperPrefix:function(H){return'<td class="'+this.getWrapperCss(H)+'">';},getWrapperCss:function(H){return"mstrmojo-itemwrap-td";},itemWrapperPrefill:"&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;",itemWrapperSuffix:"</td>",wrapperNodes:function G(H){return this.wrapperParentNode(H).cells;},wrapperParentNode:function F(H){return H.firstChild.rows[0];},createWrapperNode:function E(H){var I=H.ownerDocument,J=I.createElement("td");return J;},findScrollRange:function C(V,L,S,Y,I,P,Z,X){var Q=this.wrapperNodes(V),R=parseInt(L/2,10),K=parseInt(Math.log(L)/Math.log(2),10),J=0,H=L-1,U=I+P,M=Q[0].offsetLeft,O;for(var W=1;W<=K;W++){O=Q[R].offsetLeft-M+Z;if(O<=I){J=R;}else{if(O>=U){H=R;}}var N=Math.round(L/Math.pow(2,W+1));R+=(O>I)?-N:N;R=Math.min(Math.max(0,R),L-1);}return{start:J,end:H};},findIndex:function A(I,M,K){if(M&&K){var H=I.domNode,L=this.wrapperParentNode(M),J=K.parentNode;while(J){if(J===L){return mstrmojo.array.findBin(this.wrapperNodes(M),K,"offsetLeft",I.items&&I.items.length);}else{if(J===H){break;}}K=J;J=K.parentNode;}}return -1;}},mstrmojo.hash.copy(mstrmojo.ListMapper)));})();(function(){mstrmojo.requiresCls("mstrmojo.dom","mstrmojo.array","mstrmojo.css","mstrmojo.vi.ui.rw._IsMultiselectXtab");var Z=mstrmojo.dom,c=mstrmojo.css;function N(){var e=this._outlineRenderTimer;if(e){self.clearInterval(e);delete this._outlineRenderTimer;this.renderingRows=false;}}function P(e,k,n,g,j,h,m){var l=this,f=this.id;this.renderingRows=true;this._outlineRenderTimer=self.setInterval(function(){try{if(!e){return ;}var o=[],q=e.pageStatus[k],t=0,r=e.rowsPerPage;if(!q||!q.filled){o.push({idx:k,fill:true});}if(o.length>0){e.preRenderPages();e.renderPages(o);e.postRenderPages();e._postPagesClearup=true;}else{if(e._postPagesClearup){e.postRenderPagesCleanup();e.configureActions();e._postPagesClearup=false;}N.call(l);if(e.isRenderingComplete()){e.postRenderingCleanup();}if(h){k++;if(e.pageStatus[k]){P.call(l,e,k,n,g,j,h);}else{V.call(l);l.domNode.style.visibility="visible";}}else{if(m){X.call(l,n,g,j,m);}else{C.call(l,n,g,j,m);}}}}catch(p){N.call(l);throw p;}},e.renderPause);}function b(){var g=this.scrollboxNode;if(!this.heightLimit){g.style.height=g.firstChild.offsetHeight+(g.offsetHeight-g.clientHeight)+"px";}var f=this.xtabClonedNodes,e;for(e in f){f[e].refreshNode();}this._adjustClipSize();this.alignLockNodes(this.scrollboxLeft,this.scrollboxTop);}function G(){var e=this.getTargetZone();if(e&&e.onscroll){e.onscroll();}}function V(){c.removeClass(this.domNode,"outlineBusyCursor");var e=this.scrollboxNode;if(!this.heightLimit){e.style.height=e.firstChild.offsetHeight+(e.offsetHeight-e.clientHeight)+"px";this.refreshResizeHandlers();}if(!this.widthLimit){this.scrollboxNode.firstChild.style.position="relative";this.onGridWidthChanged();}if(this.scrollboxHeightFixed){b.call(this);this._refreshClonedNodes();}this.refreshResizeHandlers();G.call(this);this.updateScrollbars&&this.updateScrollbars();}function D(f,e){if(!f){return ;}if(e){f.className="icon-outline-span outline-expand";f.setAttribute("collapsed",true);}else{f.className="icon-outline-span outline-collapse";f.setAttribute("collapsed",false);}}function Y(){if(this.allPagesLoaded){return true;}var g=0,k=this.children[0].pageStatus,e=k.length;for(g=0;g<e;g++){if(!k[g].filled){return false;}}this.allPagesLoaded=true;var n=this.getTargetZone().tableNode,m=n.rows,l=this.gridData.maxLevel,h,j,f;e=m.length;Q.call(this,l,true);for(g=0;g<e;g++){f=m[g].getElementsByClassName("icon-outline-span")[0];j=(f&&parseInt(f.getAttribute("dpt"),10))||0;if(j>0){j=parseInt(f.getAttribute("dpt"),10);h="depth"+(j-1);this.maxIndividualCollapseCount[h]+=1;if(f.getAttribute("collapsed")==="true"){this.individualCollapseCount[h]+=1;}}}return true;}function L(e){e.setAttribute("collapsed","true");e.className="icon-outline-span outline-expand";}function C(o,h,m,n){var q=o.rows,k=q.length,e=this.getTargetZone(),p,l,g,f=0,j=true;for(g=m+1;g<k;g++){p=q[g];l=parseInt(p.getAttribute("level"),10);if(isNaN(l)){f=parseInt(p.parentElement.getAttribute("n")||1,10);if((m===g-1)&&e.pageStatus[f].filled===true){g++;}break;}if(l<=h){f=parseInt(p.parentElement.getAttribute("n")||0,10)+1;if(f<e.totalPages&&e.pageStatus[f].filled){j=false;}delete this.outlineState.collapseToLevel;break;}}if(g===k){f=parseInt(q[k-1].parentElement.getAttribute("n")||0,10)+1;if(f<e.totalPages&&e.pageStatus[f].filled===true){f++;}}if(j&&f<e.totalPages){P.call(this,e,f,o,h,g-1,false,n);}else{M.call(this,o,h,this.startCollapseRowIndex||m,n);if(this.isAutoTableLayout()){b.call(this);}delete this.startCollapseRowIndex;delete this.outlineState.collapseToLevel;}}function X(o,h,m,n){var q=o.rows,k=q.length,e=this.getTargetZone(),p,l,g,f=e.pageStatus.length,j=true;for(g=m+1;g<k;g++){p=q[g];l=parseInt(p.getAttribute("level"),10);if(isNaN(l)){f=parseInt(p.parentElement.getAttribute("n")||1,10);if(e.pageStatus[f].filled===true){e.pageStatus[f].filled=false;g++;}break;}if(l<=h){f=parseInt(p.parentElement.getAttribute("n")||0,10)+1;if(f<e.totalPages&&e.pageStatus[f].filled){j=false;}delete this.outlineState.collapseToLevel;break;}}if(j&&f<e.totalPages){P.call(this,e,f,o,h,g-1,false,n);}else{M.call(this,o,h,this.startCollapseRowIndex||m,n);if(this.isAutoTableLayout()){b.call(this);}delete this.startCollapseRowIndex;delete this.outlineState.collapseToLevel;}}function M(AC,h,n,f){var AD=this,r=AC.rows,AA=r.length,o,g,k,x,v,q="outlineMode "+(f?"":" hiddenRow"),AB=AD.getStickedTableNodes(),e=AD.children[0],u=this.outlineState,z,l,p=e.rowsPerPage;for(x=n+1;x<AA;x++){o=r[x];k=parseInt(o.getAttribute("level"),10);if(k<=h){break;}if(f&&k>h+1){continue;}o.className=q;l=o.getAttribute("ei");z=o.getElementsByClassName("icon-outline-span")[0];if(!f){u[l]={expanded:false,hidden:true};if(z&&z.getAttribute("collapsed")!=="true"){AD.individualCollapseCount["depth"+(k-1)]+=1;L(z);}}else{u[l]={expanded:false,hidden:false};}for(v=0;v<AB.length;v++){g=AB[v].rows[x];if(g){g.className=q;if(!f){z=g.getElementsByClassName("icon-outline-span")[0];if(z){L(z);}}}}}V.call(AD);var m="depth"+(h-1);if(Y.call(AD)){if(AD.individualCollapseCount[m]===0){S.call(AD,h+1,true);}else{if(!f&&this.maxIndividualCollapseCount[m]===this.individualCollapseCount[m]){R.call(AD,h);}}}var t=mstrmojo.findAncestor(this,"adjustAutoWidth",null,mstrmojo.grid);if(t){t.adjustAutoWidth(this);}}function S(j,f){if(!this.gridData.gts.show){return ;}var h=this.getTargetZone().tableNode,k=this.getStickedTableNodes(),e=j-1,l,g;k.push(h);mstrmojo.array.forEach(k,function(m){var n=m.rows[0].getElementsByClassName("icon-outline-span");for(g=0;g<n.length;g++){l=n[g];if(g<e){l.setAttribute("collapsed",0);c.removeClass(l,"outline-expand");c.addClass(l,"outline-collapse");}else{if(!f){l.setAttribute("collapsed",1);c.removeClass(l,"outline-collapse");c.addClass(l,"outline-expand");}}}});}function R(f){if(f===this.gridData.maxLevel){return ;}var e="depth"+(f-1);if(this.individualCollapseCount[e]===this.maxIndividualCollapseCount[e]){S.call(this,f);}else{R.call(this,f+1);}}function Q(k,f){var h=this.gridData,e=h.maxLevel||(h.gts&&h.gts.row&&h.gts.row.length)||0,j,g;for(g=0;g<e;g++){j="depth"+g;if(f){this.maxIndividualCollapseCount[j]=0;}if(g>=k){this.individualCollapseCount[j]=this.maxIndividualCollapseCount[j];}else{this.individualCollapseCount[j]=0;}}}function J(){var f=this.gridData,e=f.gts.show?1:0;if(f.gts.col&&f.gts.col.length>1){e=f.gts.col.length;}return e;}function U(){this.outlineState={};if(mstrApp.outlineStates[this.id]){delete mstrApp.outlineStates[this.id];}}function O(){this.retainOutlineState=true;if(!mstrApp.outlineStates[this.id]){mstrApp.outlineStates[this.id]=this.outlineState;}}mstrmojo.vi.ui.rw._IsOutlineXtab=mstrmojo.provide("mstrmojo.vi.ui.rw._IsOutlineXtab",{_mixinName:"mstrmojo.vi.ui.rw._IsOutlineXtab",onclick:function d(q){var n=this,m=q.getTarget&&q.getTarget(),k=m&&Z.findAncestorByName(m,"td",true,this.viewport),g=k&&Z.findAncestorByName(m,"span",true,k),l=g&&parseInt(g.getAttribute("expandTo"),10);if(g&&(g.getAttribute("sty")==="outimg"||l>=1)){var r=k.parentElement;if(g&&!q.shiftKey&&!q.ctrlKey){var t=this.getTargetZone().tableNode;if(this.renderingRows){return ;}if(l>=1){U.call(this);this.scrollboxNode.scrollTop=0;var o=this.gridData,e=n.model.getDataService(),j=parseInt(g.getAttribute("collapsed"),10)||0;l+=j?1:0;S.call(this,l);o.lvlepd=l=l<o.maxLevel?l:-1;e.setOutlineExpanding({unitKey:n.node.k||n.node.data.k,outlineLevel:l});window.setTimeout(function(){n.refresh();},10);}else{if(g.getAttribute("sty")==="outimg"){c.addClass(this.domNode,"outlineBusyCursor");var h=parseInt(g.getAttribute("dpt"),10),p=m.getAttribute("collapsed")==="true",f=r.getAttribute("ei");this.outlineState[f]={expanded:p,hidden:false};if(p){m.className="icon-outline-span outline-collapse";m.setAttribute("collapsed","false");this.individualCollapseCount["depth"+(h-1)]-=1;window.setTimeout(function(){n.outlineState.isExpanding=true;n.outlineState.collapseToLevel=h+1;n.startCollapseRowIndex=r.rowIndex;X.call(n,t,h,r.rowIndex,true);},10);}else{m.className="icon-outline-span outline-expand";m.setAttribute("collapsed","true");this.individualCollapseCount["depth"+(h-1)]+=1;window.setTimeout(function(){n.outlineState.isExpanding=false;n.outlineState.collapseToLevel=h;n.startCollapseRowIndex=r.rowIndex;C.call(n,t,h,r.rowIndex,false);},10);}}}}}else{this._super(q);}},refresh:function I(e,n){var l=this;if(n){var k=this.getTargetZone(),q=k&&k.tableNode,o=this.gridData;if(!o||!k||!q){return this._super(e);}var m=this.getFormats(),h=k.gridContainerNode,g=this.xtabClonedNodes||[],f=(m&&m.width)||h.style.width,p=(m&&m.height)||this.scrollboxNode.style.height,j=parseInt(f,10);if(o.afc){j=Math.max(q.offsetWidth,j);}h.style.width=j+"px";mstrmojo.array.forEach(g,function(r){if(r.domNode){r.domNode.firstChild.style.width=j+"px";}});this.widthLimit=j;this.heightLimit=parseInt(p,10);this.scrollboxNode.style.height=p;this.resize();this.updateScrollbars();return ;}if(!this.retainOutlineState){U.call(this);}else{this.retainOutlineState=false;}this._super(e);},postBuildRendering:function a(){var j=this.gridData;this.isOutlineMode=(j&&j.olm&&!(j.rw&&j.rw.row.bc>0)&&!this.defn.txi);if(!mstrApp.outlineStates){mstrApp.outlineStates=[];}if(mstrApp.outlineStates[this.id]){this.outlineState=mstrApp.outlineStates[this.id];}else{if(!this.outlineState){this.outlineState={};}}this._super();var g=this.getTargetZone(),h=g&&g.tableNode;if(!j||!g||!h){return ;}var k=j.lvlepd||0,f=j.maxLevel||(j.gts&&j.gts.row&&j.gts.row.length)||0,e=j.olm&&!(j.rw&&j.rw.row.bc>0)&&(k>=1&&k<f);this.allPagesLoaded=false;this.individualCollapseCount={};this.maxIndividualCollapseCount={};Q.call(this,f,true);if(e){g._defaultPageHeight=Math.min(h.tBodies[0].offsetHeight,g._defaultPageHeight);g.gridContainerNode.style.minHeight=g._defaultPageHeight*g.totalPages+"px";S.call(this,k);this.scrollboxNode.scrollTop=0;G.call(this);}},gridPagesRendered:function B(){this._super();if(Y.call(this)&&!this.outlineState.isExpanding){R.call(this,1);}},isOutlineMode:true,showBanding:function A(e){O.call(this);this._super(e);},formatGridZone:function W(g,f,e){O.call(this);this._super(g,f,e);},batchFormatGridZones:function E(g,f,e){O.call(this);this._super(g,f,e);},formatPadding:function K(f,g,e){O.call(this);this._super(f,g,e);},updateRelatedColWidths:function F(e){O.call(this);this._super(e);},updateScenario:function H(e){O.call(this);this._super(e);}});}());(function(){mstrmojo.requiresCls("mstrmojo.dom","mstrmojo.taphold");var A=false,Q=mstrmojo.dom,V=16;mstrmojo._HasContextMenu=mstrmojo.provide("mstrmojo._HasContextMenu",{cm:null,cmPos:null,itemField:"n",itemIdField:"did",itemChildrenField:"items",dynamicUpdate:false,queryChecked:function(W){return false;},queryEnabled:function(W){return true;},queryVisible:function(W){return true;},executeCommand:function P(W){},item2textCss:function E(W){return W.cssClass||W.cmdId||("cmd"+W[this.itemIdField]);},showContextMenu:function J(){if(!A){mstrmojo.requiresCls("mstrmojo.ContextMenu");A=true;}var c=this._subMenu,a=this.getMenuPosition();if(!c){var e=(this.menuZIndex||this.zIndex||10)+1,Y={left:a.x+"px",top:a.y+"px",zIndex:e,visible:false,dynamicUpdate:this.dynamicUpdate,itemField:this.itemField,itemIdField:this.itemIdField,itemChildrenField:this.itemChildrenField,_cmSource:this.getContextMenuSource(),items:this.getContextMenuItems(),cssClass:this.getContextMenuCssClass(),placeholder:document.body.appendChild(document.createElement("div")),parent:this};c=new mstrmojo.ContextMenu(Y);c.render();this._subMenu=c;}else{c.set("left",a.x+"px");c.set("top",a.y+"px");}if(this.dynamicUpdate){var X=c.ctxtBuilder.itemWidgets,Z=X&&X.length,W,b,d=this.getContextMenuSource();for(W=0;W<Z;W++){b=X[W];if(d.queryVisible){b.set("visible",d.queryVisible(b.data));}if(d.queryChecked){b.set("checked",d.queryChecked(b.data));}if(d.queryEnabled){b.set("enabled",d.queryEnabled(b.data));}}}c.set("visible",true);this.callOnContextMenuOpen();this.adjustMenuPosition();this.attachMousedownEvent();},hideContextMenu:function I(){var W=this._subMenu;if(W&&W.visible){this._subMenu.set("visible",false);this.callOnContextMenuClose();}},adjustMenuPosition:function O(){var W=this._subMenu,Z=this._subMenu.domNode,Y=Z.offsetHeight,X=Z.offsetWidth,c=Q.windowDim(),b=Q.position(Z,false),a=Q.position(Z,true);if((b.x+X+V)>c.w){W.set("left",(c.w-X-V+(a.x-b.x))+"px");}if((b.y+Y+V)>c.h){W.set("top",(c.h-Y-V+(a.y-b.y))+"px");}},attachMousedownEvent:function M(){var W=this;if(!this._close_handler){this._close_handler=function(X){W.closeMenuHandler(X);};}Q.attachEvent(document.body,"mousedown",this._close_handler);},closeMenuHandler:function R(W){if(!this.isOnMySubmenu(Q.eventTarget(self,W))){this.closeMenuTree();}},isOnMySubmenu:function N(a){var X=this._subMenu;if(!X){return false;}if(Q.contains(X.domNode,a,true,document.body)){return true;}var b=X.ctxtBuilder.itemWidgets,W=b&&b.length,Z,Y;for(Z=0;Z<W;Z++){Y=b[Z];if(Y.isOnMySubmenu(a)){return true;}}return false;},oncmChange:function K(){delete this._subMenu;},callOnContextMenuOpen:function D(){if(this.onContextMenuOpen){this.onContextMenuOpen();}},callOnContextMenuClose:function C(){if(this.onContextMenuClose){this.onContextMenuClose();}},getContextMenuItems:function U(){return this.cm;},getContextMenuCssClass:function B(){return this.cmCssClass||"";},getContextMenuSource:function H(){return this;},getMenuPosition:function F(){if(this.cmPos){return this.cmPos;}var W=Q.position(this.domNode,true);return{x:Math.round(W.x),y:Math.round(W.y+W.h)};},isSeparatorItem:function G(W){return W[this.itemIdField]===-1||W[this.itemField]==="-";},hasSubmenu:function L(W){return !!W[this.itemChildrenField];},closeMenuTree:function S(Y){var X=this.activeMenuItem,W=this._cmSource||this;if(!X){if(Y){this.activeMenuItem=Y;}else{W.hideContextMenu();}return ;}if(X===Y){return ;}if(Y){this.activeMenuItem=Y;if(Y.parent.parent===X){return ;}if(Y.parent===X.parent){X.hideContextMenu();return ;}}else{Y=W;this.activeMenuItem=null;}X.hideContextMenu();while(X!==W){X=X.parent.parent;if(X!==Y||W===Y){X.hideContextMenu();if(W===Y){Q.detachEvent(document.body,"mousedown",this._close_handler);}}if(X.parent===Y.parent){break;}}}});}());(function(){mstrmojo.requiresCls("mstrmojo.hash","mstrmojo.WidgetListBuilder");mstrmojo.WidgetTreeBuilder=mstrmojo.provide("mstrmojo.WidgetTreeBuilder",mstrmojo.mixin({newContext:function A(B){var D=this._super(B);if(!B.itemFunction&&D.itemFunc){var C=D.itemFunc;D.itemFunc=function(G,F,H){var E=C(G,F,H);if(E){E.tree=H.tree||H;}return E;};}return D;}},mstrmojo.hash.copy(mstrmojo.WidgetListBuilder)));})();(function(){mstrmojo.requiresCls("mstrmojo.dom","mstrmojo.css","mstrmojo.registry","mstrmojo._HasContextMenu","mstrmojo.Widget");var F=mstrmojo.dom,K=mstrmojo.css,N=16;mstrmojo.ContextMenuItem=mstrmojo.declare(mstrmojo.Widget,[mstrmojo._HasContextMenu],{scriptClass:"mstrmojo.ContextMenuItem",SUBMENU_SHIFT:3,visible:true,checked:false,enabled:true,buildDom:function(){var V=document.createElement("tr"),W=this.data,Z=this._cmSource,R,S;V.id=this.id;V.className="mstrmojo-ContextMenuItem "+(Z.isSeparatorItem(W)?"separator":Z.item2textCss(W));var X=this,Y=function(){X.handleMouseOver();},U=function(){X.handleMouseOut();},Q=function(){X.handleClick();};F.attachEvent(V,"mouseover",Y);F.attachEvent(V,"mouseout",U);F.attachEvent(V,"click",Q);R=document.createElement("td");V.appendChild(R);R.className="mstrmojo-CMI-left";S=document.createElement("img");S.src="../images/1ptrans.gif";R.appendChild(S);R=document.createElement("td");V.appendChild(R);R.className="mstrmojo-CMI-text";if(Z.isSeparatorItem(W)){S=document.createElement("img");S.src="../images/1ptrans.gif";}else{S=document.createElement("div");S.className="mstrmojo-CMI-content";R.innerHTML=W.itemWidget?"&nbsp":W[this.itemField];}R.appendChild(S);R=document.createElement("td");V.appendChild(R);R.className="mstrmojo-CMI-right "+(this.hasSubmenu?"sm":"");S=document.createElement("img");S.src="../images/1ptrans.gif";R.appendChild(S);return V;},buildRendering:function L(){this._super();var Q=this.data.itemWidget;if(Q){Q.placeholder=this.domNode.cells[1].children[0];Q.data=this.data;Q=mstrmojo.insert(Q);Q.render();Q.parent=this;this.itemWidget=Q;}},markupMethods:{onvisibleChange:function(){this.domNode.style.display=this.visible?"":"none";},oncheckedChange:function(){K.toggleClass(this.domNode,["checked"],this.checked);},onenabledChange:function(){K.toggleClass(this.domNode,["disabled"],!this.enabled);}},getMenuPosition:function I(){var Q=F.position(this.domNode,true);return{x:Math.round(Q.x+Q.w-this.SUBMENU_SHIFT),y:Math.round(Q.y)};},getContextMenuItems:function B(){return this.data[this.itemChildrenField];},getContextMenuCssClass:function D(){return this.data.cmCssClass||"";},callOnContextMenuOpen:function M(){var Q=this.data;if(Q.onContextMenuOpen){Q.onContextMenuOpen.apply(this,[]);}},callOnContextMenuClose:function A(){var Q=this.data;if(Q.onContextMenuClose){Q.onContextMenuClose.apply(this,[]);}},attachMousedownEvent:function J(){},getContextMenuSource:function P(){return this._cmSource;},adjustMenuPosition:function G(){var Q=this._subMenu,U=this._subMenu.domNode,S=U.offsetHeight,R=U.offsetWidth,X=F.windowDim(),W=F.position(U,false),V=F.position(U,true);if((W.x+R+N)>X.w){Q.set("left",(F.position(this.domNode,true).x-R)+"px");}else{Q.set("left",(F.position(this.domNode,true).x+this.domNode.offsetWidth)+"px");}if((W.y+S+N)>X.h){Q.set("top",(X.h-S-N+(V.y-W.y))+"px");}},handleMouseOver:function O(){var Q=this,R=function(){if(Q.hasSubmenu){Q.showContextMenu();}Q._cmSource.closeMenuTree(Q);Q._mouseOverTimer=null;};if(this._cmSource.activeMenuItem!==this){this._mouseOverTimer=window.setTimeout(R,80);}},handleMouseOut:function H(){if(this._mouseOverTimer){window.clearTimeout(this._mouseOverTimer);this._mouseOverTimer=null;}},closeMenuTree:function C(){this._cmSource.closeMenuTree();},handleClick:function E(){if(this.hasSubmenu){return ;}var Q=this._cmSource,R=this.data;if(!this.itemWidget){if(!Q.isSeparatorItem(R)&&Q.queryEnabled(R)){if(Q.executeCommand){Q.executeCommand(this.data);}Q.closeMenuTree();}}}});}());(function(){mstrmojo.requiresCls("mstrmojo.ListMapper");var C=1;mstrmojo._hasWidgetListMapper={buildItemWrappers:function A(H,G,F,E,J,I){E.first=J;E.last=I;return this._super(H,G,F,E,0,0);},postBuildRendering:function B(K,I,H,G,F){var J=F.first;if(J){this.fillItemWrappers(K,I,H,G,F,0,J);}if(F.last){var E=I&&I.length||0,L=Math.max(Math.max(0,E-F.last),J);this.fillItemWrappers(K,I,H,G,F,L,E);}if(this._super){this._super(K,I,H,G,F);}},fillItemWrappers:function D(F,N,K,R,M,E,I,Q){var L=(N&&N.length)||0,P=this.wrapperNodes(F),S=M.itemStatus;for(var J=E,O=Math.min(I+1,L),H=0;J<O;J++){if(S[J]!==C){var G=K.build(R,M,N[J],J);if(G){G.placeholder=P[J].firstChild;G.render();}H++;if(H===Q){break;}}}return H;},onchange:null};mstrmojo.WidgetListMapper=mstrmojo.provide("mstrmojo.WidgetListMapper",mstrmojo.mixin(mstrmojo._hasWidgetListMapper,mstrmojo.hash.copy(mstrmojo.ListMapper)));mstrmojo.WidgetListMapper.RENDERED=C;mstrmojo.requiresCls("mstrmojo.ListMapperHoriz");mstrmojo.WidgetListMapperHoriz=mstrmojo.provide("mstrmojo.WidgetListMapperHoriz",mstrmojo.mixin(mstrmojo._hasWidgetListMapper,mstrmojo.hash.copy(mstrmojo.ListMapperHoriz)));})();(function(){mstrmojo.requiresCls("mstrmojo.desc","mstrmojo.dom","mstrmojo.MetricSelectorUtility","mstrmojo.num","mstrmojo.css","mstrmojo.vi.ui.rw.selectors.ISliderHelper");var C=mstrmojo.MetricSelectorUtility,H=C.OP,A=C.FN,J=C.Q,D=mstrmojo.num,E=mstrmojo.css,F=Math.min,I=Math.max;mstrmojo.vi.ui.rw.selectors.MetricRankSliderHelper=mstrmojo.declare(mstrmojo.vi.ui.rw.selectors.ISliderHelper,null,{scriptClass:"mstrmojo.vi.ui.rw.selectors.MetricRankSliderHelper",_children:[{scriptClass:"mstrmojo.ui.Pulldown",slot:"controlNode",alias:"rankon",isHostedWithin:false,items:C.RANK_OP_NAMES,onitemSelected:function(){this.parent.set("qua",this.getSelectedItem().v);}},{scriptClass:"mstrmojo.Label",slot:"controlNode",alias:"summary"}],init:function(K){this._super(K);this.slider.set("multiSelect",false);this.slider.rankon.set("useDarkTheme",!this.slider.docSelector.isInFilterPanel()&&mstrApp.getRootController().isDarkThemeSelected());},updateOpCs:function B(){var M=this.slider,L=parseInt(M.qua,10),K=M.include,N=I(M.cs1Vl,M.cs2Vl),O=(L===J._PT||L===J._PB);if(N===M.high){M.unSet=true;M.cs=[];return ;}M.opId=K?H._LESS_EQUAL:H._GREATER;M.cs=[{dtp:5,v:D.toLocaleString(N)+(O?"%":"")}];},updateSummary:function G(){var L=this.slider,O=C.getFuncInfo(L.opId,L.qua).f,N=C.MRPFN,K="",M=L.cs1Vl<L.cs2Vl?L.cs2Nm:L.cs1Nm;if(L.unSet){K=mstrmojo.desc(2058,"All");}else{switch(O){case N.TOP:case N.BOTTOM:case N.BETWEENDESCENDING:K=String.fromCharCode(8804)+" "+M;break;case N.EXCLUDETOP:case N.EXCLUDEBOTTOM:case N.NOTBETWEENDESCENDING:K="> "+M;break;default:K=String.fromCharCode(8804)+" "+M;break;}}L.summary.set("text",K);}});}());(function(){mstrmojo.requiresCls("mstrmojo.TouchScroller","mstrmojo.hash");var H=mstrmojo.hash;mstrmojo._HasTouchScroller=mstrmojo.provide("mstrmojo._HasTouchScroller",{_meta_usesSuper:true,scrollerConfig:{},allowTouchBubble:true,scrollerSetupDelay:undefined,init:function M(S){this._super(S);this.scrollerConfig=H.clone(this.scrollerConfig);},updateScrollerConfig:function P(){return this.scrollerConfig;},updateScroller:function F(W,X){var S=this._scroller;if(S){var U=this.updateScrollerConfig();S.initScroller(U);if(!W){var V=U.origin;if(V){S.scrollTo(V.x,V.y,X);}}S.updateScrollBars();}},initScroller:mstrmojo.emptyFn,useSelectScroll:false,postBuildRendering:function Q(){var S=this._scroller;if(!S){S=this._scroller=new mstrmojo.TouchScroller();this.initScroller(S);}else{S.haltScroller();}if(!this.layoutConfig){var V=this.id,U=this.scrollerSetupDelay;if(!isNaN(U)){window.setTimeout(function(){mstrmojo.all[V].updateScroller();},U);}else{this.updateScroller();}}this._super();},afterLayout:function G(){this._super();this.updateScroller();},getScrollPos:function A(){return H.copy(this._scroller.origin||{x:0,y:0});},shouldTouchBubble:function I(W){if(!this.allowTouchBubble){return false;}var S=this._scroller,V=W.isVertical,U=V?"y":"x";return(!S[(V?"v":"h")+"Scroll"]||S.offset[U][W.direction[U]?"end":"start"]===S.origin[U]);},touchBegin:function L(S){this._scroller.haltScroller();return(this._super&&this._super(S))||true;},touchSwipeBegin:function J(S){if(this.shouldTouchBubble(S)){if(this.bubbleTouchEvent(S)===false){this._touchCanceled=true;}return ;}if(this._super){this._super(S);}this._scroller.toggleScrollBars(true);},touchSelectBegin:function B(S){if(this._super){this._super(S);}if(this.useSelectScroll){this.touchSwipeBegin(S);}},touchSwipeMove:function C(S){if(!this._touchCanceled){if(this._super){this._super(S);}}this._scroller.scroll(S);},touchSelectMove:function E(S){if(!this._touchCanceled){if(this._super){this._super(S);}}if(this.useSelectScroll){this.touchSwipeMove(S);}},touchSwipeEnd:function N(S){S.evt.handled=true;if(!this._touchCanceled){if(this._super){this._super(S);}}this._scroller.scrollEnd(S);},touchSelectEnd:function K(S){if(this._touchCanceled){return ;}if(this._super){this._super(S);}if(this.useSelectScroll){this.touchSwipeEnd(S);}},touchEnd:function D(S){if(this._touchCanceled){delete this._touchCanceled;return ;}if(this._super){this._super(S);}},unrender:function O(U){var S=this._scroller;if(S){S.unrender();}delete this.scrollerConfig.scrollEl;this._super(U);},destroy:function R(){if(this._scroller){this._scroller.destroy();delete this._scroller;}if(this._super){this._super();}}});}());(function(){mstrmojo.requiresCls("mstrmojo.StepperContentProvider","mstrmojo.num");var A=mstrmojo.num;function B(G,F){var H=F?G.max:G.min,D=F?G.min:G.max,E=G.getVal(F?1:-1);return(H===null||(F?(E<=H):(E>=H))||(D!==null&&G.canLoop));}function C(H,G){var F=H.min,D=H.max,E=H.getVal(G?1:-1);if((G&&D!==null&&E>D)||(!G&&F!==null&&(E<F))){if(H.canLoop){E=((E-F)%(D-F+1))+F;E=(E>=F)?E:E+(D-F+1);}else{return ;}}H.item[H.valField]=H.curVal=E;H.onTraverse();}mstrmojo.NumStepperContentProvider=mstrmojo.declare(mstrmojo.StepperContentProvider,null,{scriptClass:"mstrmojo.NumStepperContentProvider",curVal:null,init:function(E){this._super(E);var F=this.item,D=function(I){var H=I&&F[I];return(H===null||H===undefined);},G=function(I,K,H){var J=H&&D.call(this,K)?null:F[K];if(J!==null&&J!==undefined){this[I]=J;}};G.call(this,"min",this.minField,true);G.call(this,"max",this.maxField,true);G.call(this,"maxLength",this.maxLengthField,true);G.call(this,"interval",this.intField);this._initCurrent();},_initCurrent:function(){var E=this.item,F=this.curVal=E[this.valField];if(F===null||F===undefined){var D=this.min;this.curVal=D!==null?D:0;}},next:function(){C(this,true);},prev:function(){C(this,false);},hasPrev:function(){return B(this,false);},hasNext:function(){return B(this,true);},renderItemAt:function(F){var E=this.getVal(F),D=this.renderer;return D?D.render(E,this):E;},getVal:function(D){return this.curVal+(this.interval*(D||0));},setVal:function(F){var G=this.min,D=this.max,E=this.getVal();if(typeof F!=="number"||isNaN(F)||F===E||A.inNumericRange(F,G,D)!==0){return ;}this.item[this.valField]=this.curVal=F;this.onTraverse();},onTraverse:mstrmojo.emptyFn});}());(function(){mstrmojo.requiresCls("mstrmojo.func","mstrmojo.hash","mstrmojo.array","mstrmojo.ServerProxy","mstrmojo.XHRServerTransport","mstrmojo.mstr.EnumFunction");var m=mstrmojo.array,g=mstrmojo.mstr.EnumFunction;var N={"8107C31BDD9911D3B98100C04F2233EA":"Sum","548C68A0F60811D3ACC300C04F0423DE":"StdevP","8107C31FDD9911D3B98100C04F2233EA":"Max","8107C331DD9911D3B98100C04F2233EA":"GeoMean",B2C0FA4220C711D6AD1400C04F0423DE:"First","8107C32CDD9911D3B98100C04F2233EA":"Product",B2C0FA4020C711D6AD1400C04F0423DE:"Greatest","8107C330DD9911D3B98100C04F2233EA":"Var","8107C32FDD9911D3B98100C04F2233EA":"Stdev","8107C32DDD9911D3B98100C04F2233EA":"Median",B2C0FA4320C711D6AD1400C04F0423DE:"Last","8107C31CDD9911D3B98100C04F2233EA":"Count","8107C31DDD9911D3B98100C04F2233EA":"Avg","8107C31EDD9911D3B98100C04F2233EA":"Min","8107C32EDD9911D3B98100C04F2233EA":"Mode",D64F1B10F6C011D3ACC300C04F0423DE:"VarP",B2C0FA4120C711D6AD1400C04F0423DE:"Least"},Q={"8107C326DD9911D3B98100C04F2233EA":"Rank"},x={D221F90EB35540E3A1204ED6CC9A8267:"Avg",D221F90FB35540E3A1204ED6CC9A8267:"Count",D221F910B35540E3A1204ED6CC9A8267:"Max",D221F911B35540E3A1204ED6CC9A8267:"Min",D221F90DB35540E3A1204ED6CC9A8267:"Sum"},z={"8107C32ADD9911D3B98100C04F2233EA":"Avg","8107C350DD9911D3B98100C04F2233EA":"Count","8107C34BDD9911D3B98100C04F2233EA":"Max","8107C34CDD9911D3B98100C04F2233EA":"Min","8107C32BDD9911D3B98100C04F2233EA":"Sum"},q={"8107C329DD9911D3B98100C04F2233EA":"Avg","8107C354DD9911D3B98100C04F2233EA":"Count","8107C351DD9911D3B98100C04F2233EA":"Max","8107C352DD9911D3B98100C04F2233EA":"Min","8107C328DD9911D3B98100C04F2233EA":"Sum"},X={"8107C337DD9911D3B98100C04F2233EA":"Banding","8107C338DD9911D3B98100C04F2233EA":"BandingC","8107C339DD9911D3B98100C04F2233EA":"BandingP"},H={"8107C31DDD9911D3B98100C04F2233EA":"Avg","8107C31CDD9911D3B98100C04F2233EA":"Count",B2C0FA4220C711D6AD1400C04F0423DE:"First","8107C331DD9911D3B98100C04F2233EA":"GeoMean",B2C0FA4320C711D6AD1400C04F0423DE:"Last","8107C31FDD9911D3B98100C04F2233EA":"Max","8107C32DDD9911D3B98100C04F2233EA":"Median","8107C31EDD9911D3B98100C04F2233EA":"Min","8107C32EDD9911D3B98100C04F2233EA":"Mode","8107C32CDD9911D3B98100C04F2233EA":"Product","8107C32FDD9911D3B98100C04F2233EA":"Stdev","548C68A0F60811D3ACC300C04F0423DE":"StdevP","8107C31BDD9911D3B98100C04F2233EA":"Sum","8107C330DD9911D3B98100C04F2233EA":"Var",D64F1B10F6C011D3ACC300C04F0423DE:"VarP",A202C23DDD9D11D3B98100C04F2233EA:"Fvschedule",A202C23CDD9D11D3B98100C04F2233EA:"IRR",A202C240DD9D11D3B98100C04F2233EA:"MIRR",A202C23EDD9D11D3B98100C04F2233EA:"NPV","8107C34ADD9911D3B98100C04F2233EA":"Percentile","9C374203DD9F11D3B98100C04F2233EA":"AvgDev","9C374228DD9F11D3B98100C04F2233EA":"ChiSquareTest","9C374225DD9F11D3B98100C04F2233EA":"Correlation","9C374224DD9F11D3B98100C04F2233EA":"Covariance","9C374237DD9F11D3B98100C04F2233EA":"ForecastV","9C37422FDD9F11D3B98100C04F2233EA":"FTest","9C374234DD9F11D3B98100C04F2233EA":"GrowthV","9C37422EDD9F11D3B98100C04F2233EA":"HeteroscedasticTTest","9C37422DDD9F11D3B98100C04F2233EA":"HomoscedasticTTest","9C37422ADD9F11D3B98100C04F2233EA":"Intercept","9C374204DD9F11D3B98100C04F2233EA":"Kurtosis","9C374222DD9F11D3B98100C04F2233EA":"MeanTTest","9C37422CDD9F11D3B98100C04F2233EA":"PairedTTest","9C374226DD9F11D3B98100C04F2233EA":"Pearson","9C374227DD9F11D3B98100C04F2233EA":"RSquare","9C374205DD9F11D3B98100C04F2233EA":"Skew","9C374229DD9F11D3B98100C04F2233EA":"Slope","9C37422BDD9F11D3B98100C04F2233EA":"SteYX","9C374231DD9F11D3B98100C04F2233EA":"TrendV","9C374223DD9F11D3B98100C04F2233EA":"VarTest","4A99DC7BC5254A319F6B8098E7D652C1":"ConcatAgg"},Z={AND283:"And",OR284:"Or",NOT285:"Not",IF305:"If"},o={BEGINSWITH279:"Begins with",ENDSWITH279:"Ends with",IN289:"In",BETWEEN290:"Between",CONTAINS291:"Contains",LIKE291:"Like"};function P(AE){var AC=function(AG,AF){return mstrmojo.array.stringSorter(AG.n,AF.n);},AD,AB;AE=AE.sort(AC);for(AD=0,AB=AE.length;AD<AB;AD++){AE[AD].fns=AE[AD].fns.sort(AC);}return AE;}function Y(AE,AF){var AB=AE.length,AD;for(AD=0;AD<AB;AD++){var AC=AE[AD].fns;if(mstrmojo.array.find(AC,"did",AF)>-1){return AD;}}return -1;}function M(AC){var AB=mstrApp&&mstrApp.useQuickSearch&&mstrApp.useQuickSearch();AC=mstrmojo.hash.copy(AC,{taskId:"searchMetadata",recursive:true,styleName:"MojoFolderStyle",includeObjectDesc:true,includeAncestorInfo:false});if(AB){AC.quickSearch=AB;AC.nameWildcards=16;AC.sortKey=-1;}return AC;}function I(AC,AB){if(mstrApp.serverRequest){mstrApp.serverRequest(AB,AC);}else{window.$MAPF=function(){return false;};this.getServerProxy().request(AC,AB,false,{});}}mstrmojo.ME.MetricDataService=mstrmojo.provide("mstrmojo.ME.MetricDataService",{rootFolderTypes:{ALL:39,FILTERS:4,METRICS:5,FACTS:29,SCHEMA:24,ATTRIBUTES:26,TRANSFORMATIONS:38},blockCount:10,suggestCount:10,suggestDelay:200,noCache:true,functions:null,metricComponents:null,functionsDetails:null,getServerProxy:function F(){if(!this.serverProxy){this.serverProxy=new mstrmojo.ServerProxy({transport:mstrmojo.XHRServerTransport});}return this.serverProxy;},getMetricDefintion:function S(AD,AB){var AC={taskId:"getMetricDefinition",metricId:AD.id,outputFlags:65599};if(AD.msgID){AC.msgID=AD.msgID;}I.call(this,AB,AC);},validateMetric:function e(AD,AB){var AC={taskId:"validateMetric",metricId:AD.metricId,tokenStreamXML:AD.tokenStreamXML,metricXML:AD.metricXML,outputFlags:327695};if(mstrmojo.string.isEmpty(AD.metricId)){AC.isNew=true;}if(AD.msgID){AC.msgID=AD.msgID;}if(AD.formID){AC.frmid=AD.formID;}if(AD.isIDForm){AC.isIDForm=AD.isIDForm;}if(AD.objectType){AC.objectType=AD.objectType;}I.call(this,AB,AC);},getMetricComponents:function B(AF,AC){var AB=this,AD=this.metricComponents;if(!this.noCache&&AD&&AD.items.length==AD.sz){AC.success(AD);return ;}AC.success=mstrmojo.func.composite([AC.success,function(AG){if(AB.metricComponents&&AB.metricComponents.items){AB.metricComponents.items.push(AG.items);}else{AB.metricComponents=AG;}}]);var AE=M({blockBegin:AF.blockBegin,blockCount:AF.blockCount,searchPattern:AF.pattern,rootFolderType:AF.rootFolderType||24,objectType:AF.objectType||"12,13,43"});I.call(this,AC,AE);},getAttributes:function R(AD,AB){var AC=M({blockBegin:AD.blockBegin,blockCount:AD.blockCount,searchPattern:AD.pattern,rootFolderType:AD.rootFolderType||26,objectType:12});I.call(this,AB,AC);},getFacts:function L(AD,AB){var AC=M({blockBegin:AD.blockBegin,blockCount:AD.blockCount,searchPattern:AD.pattern,rootFolderType:AD.rootFolderType||29,objectType:13});I.call(this,AB,AC);},getMetrics:function G(AD,AB){var AC=M({blockBegin:AD.blockBegin,blockCount:AD.blockCount,searchPattern:AD.pattern,rootFolderType:AD.rootFolderType||5,objectType:4});if(AD.isVerify){AC.nameWildcards=2;}I.call(this,AB,AC);},getFunctions:function U(AG){var AI=this,AJ=window.sessionStorage,AF=this.functions||(AJ&&AJ.getItem("functions")),AH=AJ&&AJ.getItem("mstrLocaleId"),AD=mstrApp&&mstrApp.localeId;if(AF&&AH==AD){AF=P(JSON.parse(AF).fncs);AG.success(AF);}else{var AC={failure:AG.failure,textResponse:true},AE={taskId:"getSystemFunctions",includeFunctionDetails:true,functionFlags:2|2147483648,includeFunctionHelpTopic:true};var AB=function(AK){m.forEach(AK,function(AM){var AL=AM&&AM.fns;m.forEach(AL,function(AO){var AN=AO.pros;var AP=m.filterOne(AN,function(AQ){return AQ.n==="UseLookupForAttributes";});if(AP){AP.dfv="0";}});});};AC.success=function(AK){if(typeof AK==="string"||!mstrApp.isSingleTier){AK=AK.replace(/\\'/g,"'");var AM=JSON.parse(AK),AL=AM.fncs;AB(AL);AK=JSON.stringify(AM);if(AJ){AJ.setItem("functions",AK);AJ.setItem("mstrLocaleId",AD);}AI.functions=AK;AF=P(JSON.parse(AK).fncs);}else{AB(AK.fncs);AF=P(AK.fncs);AI.functions=JSON.stringify(AK);}AG.success(AF);};I.call(this,AC,AE);}},getAggFunctions:function C(){if(this._aggFunctions){return this._aggFunctions;}var AB=this.parseFuncStr();AB=mstrmojo.array.filter(AB[this.getBasicCategoryIndex(AB)].fns,function(AD){var AC=AD.did,AE;if(AC!=="B2C0FA4020C711D6AD1400C04F0423DE"&&AC!=="B2C0FA4120C711D6AD1400C04F0423DE"){AE=N[AC];}return AE;});return AB;},getOLAPAggFunctions:function E(AB){var AC=this.parseFuncStr();AC=mstrmojo.array.filter(AC[this.getOLAPCategoryIndex(AC)].fns,function(AD){switch(AB){case"moving":return z[AD.did];case"running":return q[AD.did];case"olap":default:return x[AD.did];}return false;});return AC;},getFunctionCatList:function t(){if(this._functionCatList){return this._functionCatList;}var AB=this.parseFuncStr();AB=mstrmojo.hash.make(AB,mstrmojo.Arr);this._functionCatList=AB;return AB;},getCategoryIndex:function r(AC,AB){return Y(AB||this.getFunctionCatList(),AC);},getBasicCategoryIndex:function J(AC){var AB="B2C0FA4020C711D6AD1400C04F0423DE";return Y(AC||this.getFunctionCatList(),AB);},getDataMiningCatIndex:function k(AB){var AC="F17CD4F3FF134D91B80DDAB9CA73C919";return Y(AB||this.getFunctionCatList(),AC);},getDateTimeCategoryIndex:function w(AC){var AB="C50F2A4F75AE49D6B20E00224967B500";return Y(AC||this.getFunctionCatList(),AB);},getStringCategoryIndex:function h(AC){var AB="6F7DF5FF449111D5BEA300B0D01A55EF";return Y(AC||this.getFunctionCatList(),AB);},getOLAPCategoryIndex:function J(AC){var AB="D221F90EB35540E3A1204ED6CC9A8267";return Y(AC||this.getFunctionCatList(),AB);},getInternalCategoryIndex:function V(AC){var AB="8107C337DD9911D3B98100C04F2233EA";return Y(AC||this.getFunctionCatList(),AB);},getFunctionDetails:function u(AD,AB){var AC={taskId:"getSystemFunctions",functionId:AD.did,includeFunctionDetails:true,includeFunctionHelpTopic:true};I.call(this,AB,AC);},getTransformations:function O(AD,AB){var AC=M({blockBegin:AD.blockBegin,blockCount:AD.blockCount,searchPattern:AD.pattern,rootFolderType:AD.rootFolderType||38,objectType:43});I.call(this,AB,AC);},getFilters:function l(AD,AB){var AC=M({blockBegin:AD.blockBegin,blockCount:AD.blockCount,searchPattern:AD.pattern,rootFolderType:AD.rootFolderType||4,objectType:1});I.call(this,AB,AC);},getAttributeForms:function f(AD,AB){var AC={taskId:"getAttributeForms",attributeID:AD.attributeID,displayedForms:AD.displayedForms,styleName:"WidgetElementListStyle"};I.call(this,AB,AC);},getSubtotalFunctions:function W(AD,AB){var AC=M({objectType:"1025,1026",searchPattern:""});I.call(this,AB,AC);},isBasicAggMap:function n(AB){var AC=!!N[AB];if(AB==="B2C0FA4020C711D6AD1400C04F0423DE"||AB==="B2C0FA4120C711D6AD1400C04F0423DE"){AC=false;}return AC;},isOLAPAgg:function AA(AB){return !!x[AB];},isMovingAgg:function a(AB){return !!z[AB];},isRunningAgg:function d(AB){return !!q[AB];},isBanding:function j(AB){return !!X[AB];},isOLAP:function K(AC){var AD=this.getFunctionCatList(),AB=AD[this.getOLAPCategoryIndex(AD)].fns;return mstrmojo.array.find(AB,"did",AC)>-1;},isRank:function D(AB){return !!Q[AB];},isScalar:function c(AB){return(AB||{}).sqt===3;},hasLookupForAttributesProps:function(AB){return !!H[AB];},getFunctionHelpTopic:function p(AB){var AC="<div class='func-details' onclick='mstrmojo.ME.MetricDataService.showFunctionHelpTopic(\"##HELPTOPIC##\")'>"+mstrmojo.desc(5811,"Details...")+"</div>";AC=AC.replace("##HELPTOPIC##",AB);return AC;},showFunctionHelpTopic:function v(AC){var AD=mstrApp.isSingleTier,AB=((mstrApp.helpUrl||"../help/")+"FunctionsRef/");if(AD){AB=AB+"index.htm#cshid="+(AC||"");window.FormWrapper.openPage(AB);}else{if(AC){AB=AB+"Content/"+AC+".htm";}else{AB=AB+"index.htm";}window.open(AB);}return false;},sortFunctions:function A(AC){var AD={},AB=function(AF,AE){return mstrmojo.array.stringSorter(AF.n,AE.n);};mstrmojo.array.forEach(AC,function(AE){mstrmojo.array.forEach(AE&&AE.fns,function(AF){if(AF&&AF.did){AD[AF.did]=AF;}});});return mstrmojo.hash.valarray(AD).sort(AB);},parseFuncStr:function b(){var AB=window.sessionStorage,AC=this.functions||AB&&AB.getItem("functions");if(AC){return P(JSON.parse(AC).fncs);}},isValEqual:function(AE,AD){if(AE===AD){return true;}var AB=[-1,"-1","True",true],AC=[0,"0","False",false];if(AB.indexOf(AE)>-1&&AB.indexOf(AD)>-1){return true;}else{if(AC.indexOf(AE)>-1&&AC.indexOf(AD)>-1){return true;}}return false;},isFuncHasUseLookupForAttributeProp:function(AC){var AB=[g.FunctionSum,g.FunctionCount,g.FunctionAvg,g.FunctionMin,g.FunctionMax,g.FunctionProduct,g.FunctionMedian,g.FunctionMode,g.FunctionStdev,g.FunctionVar,g.FunctionGeomean,g.FunctionPercentile,g.FunctionStdevP,g.FunctionVarP,g.FunctionFirst,g.FunctionLast,g.ConcatAgg];return AB.indexOf(AC)>-1;},isLogicOrCompFunc:function(AC){var AB=AC.v.toUpperCase()+AC.tp;return !!Z[AB]||!!o[AB];}});}());(function(){mstrmojo.requiresCls("mstrmojo.ServerProxy");mstrmojo.QueueNative=mstrmojo.declare(mstrmojo.ServerProxy,null,{scriptClass:"mstrmojo.QueueNative",queue:[],requestCount:0,transport:null,createRequest:function(C,E,D,B){return this._super(C,E,D,B);},advance:function(){var B=this.queue.shift();if(B){this.request(B.callback,B.params,false,{});}},queueHandle:function(B,C){if(this.requestCount>0){this.queue.push({callback:C,params:B});this.requestCount++;}else{this.requestCount++;this.request(C,B,false,{});}},response:function A(F,B,D){var E=this.getRequest(F);if(E){E.gotResponse=true;var G=E.callback,C=(B&&!D.mstrerr)?"success":"failure";try{if(G[C]){G[C](D,E);}}finally{G.complete(F);}this.requestCount--;this.advance();}},});}());(function(){mstrmojo.requiresCls("mstrmojo.Obj","mstrmojo.locales","mstrmojo.date","mstrmojo.DI.DIConstants","mstrmojo.DI.DIDatabaseHelper");mstrmojo.requiresDescs(2052,2170,2265,3434,3544,4530,4699,8002,8984,9614,9919,9920,9921,9922,12491,12492,12493,12494,12495,12509,12771,13031,13131,13132,13980,13981,8536);var U=mstrmojo.DI.DIConstants,O=U.dataTypeMenuItems,L=U.rdcsFlag,D=mstrmojo.dom,J=mstrmojo.array;mstrmojo.DI.DIHelpers=mstrmojo.declare(mstrmojo.Obj,null,null);mstrmojo.DI.DIHelpers.isIE7=function N(){return mstrmojo.dom.isIE7;};mstrmojo.DI.DIHelpers.isIE=function(){return D.isIE||!!D.userAgent.match(/Trident\/7\.0/);};mstrmojo.DI.DIHelpers.isIEOrEdge=function(){return mstrmojo.dom.isEdge||this.isIE();};mstrmojo.DI.DIHelpers.getURLCaption=function(){var V="";if(mstrApp.diParams&&mstrApp.diParams.EnableURLImport){if(mstrApp.diParams.EnableFileImport){if(mstrApp.isSingleTier){if(window.FormWrapper!==window.client){V+="File://";}}else{V+="File://";}}if(mstrApp.diParams.EnableHttpImport){if(V!==""){V+=", ";}V+="Http://, Https://";}if(mstrApp.diParams.EnableFTPImport){if(V!==""){V+=", ";}V+="Ftp://";}}return V;};mstrmojo.DI.DIHelpers.getUrlTooltip=function C(){var V="";if(!mstrApp.diParams){return V;}if(!mstrApp.diParams.EnableURLImport){V=mstrmojo.desc(12491,"URL file uploads are currently disabled. Please contact your administrator.");}else{V=mstrmojo.desc(12492,"Use one of the following URL formats to upload your file:")+" ";V+=mstrmojo.DI.DIHelpers.getURLCaption();if(mstrApp.enableFileImport){V+="\r\r";V+=mstrmojo.desc(12493,"'File://' format allows you to upload files in your local machine. For example: File://ComputerName/path/FileName.");}if(mstrApp.enableHttpImport||mstrApp.enableHttpsImport){V+="\r\r";if(mstrApp.enableFileImport){V+=mstrmojo.desc(12494,"Some other examples are:");}else{V+=mstrmojo.desc(12495,"Some examples are:");}}if(mstrApp.enableHttpImport){V+="\r";V+="http://host/path/FileName";V+="\r";V+="https://user:password@host/path/FileName";}if(mstrApp.enableFtpImport){V+="\r";V+="ftp://user:password@host/path/FileName";V+="\r";V+="ftp://user:password@host:port/path/FileName";}}return V;};mstrmojo.DI.DIHelpers.createMSTRObjects=function(X,Z){var V,Y,W;if(X.constructor===Array){V=X;for(W=0;W<V.length;W++){V[W]=mstrmojo.DI.DIHelpers.createMSTRObjects(X[W],Z);}}else{if(typeof X==="object"){V=new mstrmojo.Obj(X);for(Y in X){if(!Z||Z.indexOf(Y)===-1){if(X.hasOwnProperty(Y)){V.set(Y,mstrmojo.DI.DIHelpers.createMSTRObjects(X[Y],Z));}}}}else{V=X;}}return V;};mstrmojo.DI.DIHelpers.getURLParameters=function(V){var W;var Z;var Y=[];if(V){if(V.indexOf("?")>0){V=V.substr(V.indexOf("?")+1);}Z=V.split("&");for(W=0;W<Z.length;W++){var X=Z[W].split("=");if(X.length===2){Y[X[0]]=X[1];}}}return Y;};mstrmojo.DI.DIHelpers.getBackendSourceType=function(V){var W=U.backendSourceSubtype.localFile;switch(V){case U.sourceSubtype.dropbox:W=U.backendSourceSubtype.dropbox;break;case U.sourceSubtype.bisource:W=U.backendSourceSubtype.bISources;break;case U.sourceSubtype.clipboard:W=U.backendSourceSubtype.clipboard;break;case U.sourceSubtype.facebook:W=U.backendSourceSubtype.facebook;break;case U.sourceSubtype.googleAnalytics:W=U.backendSourceSubtype.googleAnalytics;break;case U.sourceSubtype.googleBigQuery:W=U.backendSourceSubtype.googleBigQuery;break;case U.sourceSubtype.googleBigQueryFFSQL:W=U.backendSourceSubtype.googleBigQueryFFSQLModel;break;case U.sourceSubtype.googleBigQuerySingleTable:W=U.backendSourceSubtype.googleBigQuerySingleTable;break;case U.sourceSubtype.googleDrive:W=U.backendSourceSubtype.googleDrive;break;case U.sourceSubtype.hadoop:W=U.backendSourceSubtype.hadoopFileBrowser;break;case U.sourceSubtype.localFile:W=U.backendSourceSubtype.localFile;break;case U.sourceSubtype.mdx:W=U.backendSourceSubtype.OLAPSources;break;case U.sourceSubtype.salesforce:W=U.backendSourceSubtype.salesforce;break;case U.sourceSubtype.samplefile:W=U.backendSourceSubtype.samplefile;break;case U.sourceSubtype.searchOnSource:W=U.backendSourceSubtype.searchAsASource;break;case U.sourceSubtype.twitter:W=U.backendSourceSubtype.twitter;break;case U.sourceSubtype.url:W=U.backendSourceSubtype.url;break;case U.sourceSubtype.publicData:W=U.backendSourceSubtype.publicData;break;case U.sourceSubtype.cloudElement:W=U.backendSourceSubtype.cloudElement;break;}return W;};mstrmojo.DI.DIHelpers.getStateParameters=function(W){var V;var Z;var X=[];if(W.indexOf(":")>=0){Z=W.split(":");}else{Z=W.split("%3A");}for(V=0;V<Z.length;V++){var Y=Z[V];if(Y.substr(2,1)==="_"){X[Y.substr(0,2)]=Y.substr(3);}}return X;};mstrmojo.DI.DIHelpers.getExtensionType=function(X){var W=X.toLowerCase(),V;if(W===".xls"||W===".xlsx"||W===".xlsm"){V=U.xdaType.excel;}else{if(W===".txt"||W===".csv"||W===".tsv"||W===".prn"){V=U.xdaType.text;}else{V=0;}}return V;};mstrmojo.DI.DIHelpers.setTablesrc=function(V,X,W){if(X){if(!V.tablesSrc[X]){V.tablesSrc[X]=[];}V.tablesSrc[X].push(W);}};function S(V){var X={0:2,1:2,2:2,3:2,4:2,5:2,6:2,7:2,8:3,9:3,10:3,11:2,12:2,13:2,14:8,15:9,16:1,17:3,18:3,21:2,22:2,23:3,30:11,31:2,33:3,34:2},a={1:U.columnDataTypes.integer,2:U.columnDataTypes.integer,6:U.columnDataTypes.dtdouble,7:U.columnDataTypes.dtfloat,21:U.columnDataTypes.integer,22:U.columnDataTypes.nlong,30:U.columnDataTypes.bigDecimal,34:U.columnDataTypes.int64},W=X[V],Z=a[V],Y="";switch(W.toString()){case U.dataTypeMenuItems.NUMBER:switch(Z){case U.columnDataTypes.integer:Y=mstrmojo.desc(9614,"Integer");break;case U.columnDataTypes.nlong:Y=mstrmojo.desc(13131,"Long");break;case U.columnDataTypes.int64:Y=mstrmojo.desc(13132,"Big Integer");break;case U.columnDataTypes.dtfloat:Y=mstrmojo.desc(8002,"Float");break;case U.columnDataTypes.dtdouble:Y=mstrmojo.desc(2265,"Double");break;case U.columnDataTypes.bigDecimal:Y=mstrmojo.desc(9920,"Big Decimal");break;default:Y=mstrmojo.desc(3434,"Number");break;}break;case U.dataTypeMenuItems.DATE:Y=mstrmojo.desc(2052,"Date");break;case U.dataTypeMenuItems.DATE_TIME:Y=mstrmojo.desc(9919,"DateTime");break;case U.dataTypeMenuItems.TIME:Y=mstrmojo.desc(2170,"Time");break;case U.dataTypeMenuItems.TEXT:Y=mstrmojo.desc(3544,"Text");break;case U.dataTypeMenuItems.HTML_TAG:Y=mstrmojo.desc(9921,"HTML Tag");break;case U.dataTypeMenuItems.PHONE_NUMBER:Y=mstrmojo.desc(8984,"Phone Number");break;case U.dataTypeMenuItems.SYMBOL:Y=mstrmojo.desc(4530,"Symbol");break;case U.dataTypeMenuItems.URL:Y=mstrmojo.desc(9922,"URL");break;case U.dataTypeMenuItems.EMAIL:Y=mstrmojo.desc(4699,"Email");break;}return Y;}mstrmojo.DI.DIHelpers.getDataTypeString=S;mstrmojo.DI.DIHelpers.parseAlternateSourceValidationResults=function M(d){var b=[],Z,a,c,e,V,X,Y,W;J.forEach(d,function(f){Z=a=c=e="";X=(f.vt===3)?1:0;switch(f.vt){case 0:case 1:case 2:case 3:Z=f.n;a=S(f.ddt);V=f.src;c=V.n;e=S(V.ddt);break;case 4:Z=f.n;a=S(f.ddt);break;case 8:V=f.src;c=V.n;e=S(V.ddt);break;}Y=a?Z+"("+a+")":Z;W=e?c+"("+e+")":c;b.push([Y,X,W]);});return b;};mstrmojo.DI.DIHelpers.getURLFileName=function(W){var V=W.lastIndexOf("/");return V>=0&&V+1!==W.length?W.substr(V+1):W;};mstrmojo.DI.DIHelpers.isOperationMode=function(V){return V!==undefined&&V!==null;};mstrmojo.DI.DIHelpers.isCtrlKey=function(V,X){var W=X||(V||window).event;return W.ctrlKey||W.metaKey;};mstrmojo.DI.DIHelpers.isRefreshable=function(W){var V,X=0;for(V in W.importSources){var Y=W.importSources[V];if(Y.type===U.sourceType.file&&(Y.subtype===U.sourceSubtype.url||Y.subtype===U.sourceSubtype.publicData)){if(!Y.sourceInfo||Y.sourceInfo.url.indexOf("http://mirror.microstrategy.com/datahub/samples")!==0){X++;}}}if(W.getAllTableID().length===X&&!mstrApp.diParams.EnableHttpImport&&!mstrApp.diParams.EnableFTPImport&&!mstrApp.diParams.EnableFileImport&&!mstrApp.diParams.EnableURLImport){return false;}return true;};mstrmojo.DI.DIHelpers.strStartsWith=function(W,V){return W.indexOf(V)===0;};mstrmojo.DI.DIHelpers.adjustDataIdx=function(Y,X){var V=[],W;if(!Y||Y.length===0){return ;}J.forEach(Y,function(Z){W=Z.subColumns;if(W&&W.length>1){V=V.concat(W);}else{V.push(Z);}});V.sort(function(c,Z){return c[X]-Z[X];});};mstrmojo.DI.DIHelpers.setDataIdx=function(X,W,V){if(!W||W.length===0){return ;}if(W[0].hasOwnProperty("clix")){J.forEach(X,function(Z){var Y=Z.ix;Z[V]=J.find(W,"clix",Y);if(Z.isMultiForm){J.forEach(Z.subColumns,function(a){a[V]=J.find(W,"clix",a.ix);});}});}if(W[0].hasOwnProperty("did")){J.forEach(X,function(a){var Z=a.did;var Y=J.find(W,"did",Z);if(Y!==-1){a[V]=Y;}if(a.isMultiForm){J.forEach(a.subColumns,function(b){Y=J.find(W,"did",b.did);if(Y!==-1){b[V]=Y;}});}});}};mstrmojo.DI.DIHelpers.encodeData=function(V){var W="";if(V!==undefined){if(typeof V==="number"){W=V;}else{W=mstrmojo.string.encodeHtmlString(V,false,true);}}return W;};var E={0:"Bytes",1:"KB",2:"MB",3:"GB",4:"TB",5:"PB"};function P(V){return E[V]||"unknown";}mstrmojo.DI.DIHelpers.getRoundSize=function I(W){var V;for(V=0;(W/1024)>1;V++){W=W/1024;}W=W.toPrecision(3);return W+P(V);};mstrmojo.DI.DIHelpers.findNewElements=function(X,Y){var W=[],V;if(X&&X.length){J.forEach(Y,function(Z){V=J.indexOf(X,Z);if(V===-1){W.push(Z);}});}else{if(Y&&Y.length){W=[].concat(Y);}}return W;};mstrmojo.DI.DIHelpers.generateCubeName=function(W){var V,X,Y=50;V=W.join(" ");if(V.length>Y){V=V.slice(0,Y)+"...";}X=W.length;if(X>1){V+=" ("+X+" tables)";}return V;};mstrmojo.DI.DIHelpers.parseValidateSourceResults=function(W){var V={isValidate:true,hasError:false,tbids:[],tableValidate:[],missingColumnTbids:[],mismatchedDatatypeTbids:[],missingTableTbids:[],errorTableTbids:[],missingColumns:{},mismatchedDatatypeColumns:{},missingTablesColumns:{},errorTableErrCode:{},errorTableErrMsg:{}},X=W&&W.vts;J.forEach(X,function(f){var Y=f.tbid,g=f.vt,a=f.emsg,d=f.cols||[],Z=true,e=false,c,h=[],b=[];if(g===1){Z=true;}else{switch(g){case U.backendError.switchingFileType:case U.backendError.noExternalSession:case U.backendError.databaseCredentialsNotAvailable:case U.backendError.CECredentialNotAvailable:case U.backendError.AuthenticationError:case U.backendError.shouldBeIgnored:e=true;break;}J.forEach(d,function(j){var k=j.vt;switch(k){case 1:b.push(j);break;case 4:h.push(j);break;}});}if(e){V.errorTableTbids.push(Y);V.errorTableErrCode[Y]=g;V.errorTableErrMsg[Y]=a;V.isValidate=false;V.hasError=true;}c=h.length>0&&h.length===d.length;if(h.length>0||b.length>0){Z=false;}else{Z=true;}if(Z===false){V.isValidate=false;}V.tbids.push(Y);V.tableValidate.push(Z);if(h.length>0){if(c){V.missingTableTbids.push(Y);V.missingTablesColumns[Y]=h;}else{V.missingColumnTbids.push(Y);V.missingColumns[Y]=h;}}if(b.length>0){V.mismatchedDatatypeTbids.push(Y);V.mismatchedDatatypeColumns[Y]=b;}});return V;};mstrmojo.DI.DIHelpers.truncate=function(X,Z,V){if(X&&X.length>Z){var b=3,W=Z-b,a=Math.ceil(W/2),Y=Math.floor(W/2);if(V){return X.substr(0,W)+"...";}else{return X.substr(0,a)+"..."+X.substr(X.length-Y);}}else{return X;}};mstrmojo.DI.DIHelpers.getAbsoluteFileName=function(V){var W,X=V.lastIndexOf("\\");if(X===-1){X=V.lastIndexOf("/");}W=V.substring(X+1,V.length);return W;};mstrmojo.DI.DIHelpers.reevaluatePopupPosition=function(V){if(V){var W=V.style,Z=W.display,Y=W.left,X=W.top;W.display="block";if(parseInt(Y.substring(0,Y.length-2))<0){W.left="0px";}if(parseInt(X.substring(0,X.length-2))<0){W.top="0px";}W.display=Z;}};mstrmojo.DI.DIHelpers.expandNode=function(W){var V=W.visible;W.set("visible",!V);return !V;};mstrmojo.DI.DIHelpers.normalizeTimestamp=function(X){var W=X.replace(/-/g,"/");var V=W.indexOf(".");if(V>0){W=W.substring(0,V);}return W;};mstrmojo.DI.DIHelpers.getBackendErrorStr=function(W,V){var X="";switch(W){case U.backendError.switchingFileType:X=mstrmojo.desc(12509,"Switching the file type is not allowed during republishing or editing the cube.");break;case U.backendError.noExternalSession:case U.backendError.databaseCredentialsNotAvailable:case U.backendError.CECredentialNotAvailable:case U.backendError.AuthenticationError:X=mstrmojo.desc(14392,"We do not have the credentials needed to get the data for this table. Please provide the credentials to proceed publishing this table.");break;}return X;};mstrmojo.DI.DIHelpers.getCommonElements=function(Y,a,Z){var W=[],X,V;for(X=0;Y&&X<Y.length;X++){for(V=0;a&&V<a.length;V++){if(Z(Y[X],a[V])){W.push(Y[X]);break;}}}return W;};mstrmojo.DI.DIHelpers.formatDateAndTime=function(d,Y){var c=mstrmojo.date;var W=mstrmojo.locales;var X,e,b,a,V,Z;X=c.parseDateAndOrTime(d);e=X.date;b=X.time;if(Y){Z=new Date(Date.UTC(e.year,e.month-1,e.day,b.hour,b.min,b.sec));X=c.getDateJson(Z);e=X;b=X;}a=c.formatDateInfo(e,W.datetime.DATEDISPLAYFORMAT);V=c.formatTimeInfo(b,W.datetime.TIMEDISPLAYFORMAT);return a+" "+V;};mstrmojo.DI.DIHelpers.isServerBasedWS=function(){return !!mstrApp.isWorkstation&&!mstrApp.isSingleTier;};mstrmojo.DI.DIHelpers.isLocalWS=function(){return !!mstrApp.isWorkstation&&!!mstrApp.isSingleTier;};mstrmojo.DI.DIHelpers.isDIinVI=function(){return !!mstrApp.isWorkstation&&!!mstrApp.isSingleTier&&!!mstrApp.isPopup;};mstrmojo.DI.DIHelpers.extractFileNameFromHadoopURL=function(W){if(!W){return"";}var V,X;V=W.lastIndexOf("/")+1;X=W.substring(V);return X;};mstrmojo.DI.DIHelpers.extractFileExtensionFromHadoopURL=function(W){if(!W){return"";}var V,X;V=W.lastIndexOf("/")+1;X=W.substring(V);return X.substring(X.lastIndexOf(".")+1);};mstrmojo.DI.DIHelpers.isWS=function(){return !!mstrApp.isWorkstation;};mstrmojo.DI.DIHelpers.getEnvObj=function(){var Y=(navigator.platform.indexOf("Win")!==-1?"Win":"Mac"),V=!!mstrApp.isWorkstation?"WS":"Web",W=[];W.push(V,Y);return{ENV:W.join("-"),isWSClient:function(){if(!window.FormWrapper||!window.FormWrapper.isDesktop){return false;}return !window.FormWrapper.isDesktop();},isDesktopClient:function(){if(!window.FormWrapper||!window.FormWrapper.isDesktop){return false;}return window.FormWrapper.isDesktop();},isWeb:function(){return V==="Web";},isWS:function(){return V==="WS";},isWin:function(){return Y==="Win";},isMac:function(){return Y==="Mac";},isDataSet:function(){return mstrApp.placeholder==="DIApp"||mstrApp.placeholder==="mainDIApp"||mstrApp.placeholder==="QBApp";},isDIinVI:function(){return !!mstrApp.isFromVI;},isInDI:function(){return mstrApp.placeholder==="DIApp"||mstrApp.placeholder==="mainDIApp";},isInQB:function(){return mstrApp.placeholder==="QBApp";},isAppSchema:function(){return !!window.mstrAppSchema;},isWebWin:function(){return this.isWeb()&&this.isWin();},isWebMac:function(){return this.isWeb()&&this.isMac();},isWebDataSet:function(){return this.isWeb()&&this.isDataSet();},isWebDossier:function(){return this.isWeb()&&this.isDIinVI();},isWSWin:function(){return this.isWS()&&this.isWin();},isWSMac:function(){return this.isWS()&&this.isMac();},isWSDataSet:function(){return this.isWS()&&this.isDataSet();},isServerBasedWS:mstrmojo.DI.DIHelpers.isServerBasedWS,isWSDossier:function(){return this.isWS()&&this.isDIinVI();},isWSLiveMode:function X(){return this.isWS()&&parseInt(window.FormWrapper.isWSLiveMode(),10)===1;},isWSDossierLocalMode:function(){return this.isWSDossier()&&!this.isWSLiveMode();},isWebWinDataSet:function(){return this.isWeb()&&this.isWin()&&this.isDataSet();},isWebMacDataSet:function(){return this.isWeb()&&this.isMac()&&this.isDataSet();},isWebWinDossier:function(){return this.isWeb()&&this.isWin()&&this.isDIinVI();},isWebMacDossier:function(){return this.isWeb()&&this.isMac()&&this.isDIinVI();},isWSWinDataSet:function(){return this.isWS()&&this.isWin()&&this.isDataSet();},isWSMacDataSet:function(){return this.isWS()&&this.isMac()&&this.isDataSet();},isWSWinDossier:function(){return this.isWS()&&this.isWin()&&this.isDIinVI();},isWSMacDossier:function(){return this.isWS()&&this.isMac()&&this.isDIinVI();},isStandaloneDataSet:function(){return !this.isDIinVI()&&this.isDataSet();}};};mstrmojo.DI.DIHelpers.isOnetier=function(){return !!mstrApp.isSingleTier;};mstrmojo.DI.DIHelpers.getHierarchyMappingXML=function(a,b){var X="";var W=0,Y=1,Z=12;if(b&&b[L.ID]){X+="<mpcs>";X+="<mpc ";X+='did="'+b[L.ID].did+'" drvflg="'+W+(b[L.ID].n?('" n="'+b[L.ID].n+'" ot="'):"")+Z+'" recurisve="'+Y+'" ';if(!!a&&a!==""){X+='oid="'+a+'" ';}X+=">";if(b[L.JOIN_ID]){X+="<rdcs>";}for(var V=L.JOIN_ID;V<=L.DISTANCE;V++){if(b[V]!==undefined){X+='<rdc did="'+b[V].did+'" fg="'+V+'"/>';}}if(b[L.JOIN_ID]){X+="</rdcs>";}X+="</mpc>";X+="</mpcs>";}return X;};mstrmojo.DI.DIHelpers.getOperationMode=function(){return mstrApp.getRootController().getModel().operationMode;};mstrmojo.DI.DIHelpers.standardizeDBRolesFormat=function Q(d){var X=["att","dbRole","tableMap"],e,g,a,V,Y,W,b,Z,f,h,c=(function(){var j="list",l="number",k="text";function m(n,t,r,q,p,o){if(n&&r){if(o){n.push({field:t,fieldV:r,IDS:q,options:o,tp:p});}else{n.push({field:t,fieldV:r,IDS:q,tp:p});}}}return{authenticationmethod:function(n,o){m(n,"auth",o,7776,j,[{IDS:13980,n:mstrmojo.desc(13980),v:"1"},{IDS:13981,n:mstrmojo.desc(13981),v:"4"}]);},databasename:function(n,o){m(n,"db",o,8519,k);},hostname:function(n,o){m(n,"host",o,8533,k);},port:function(n,o){m(n,"port",o,8534,l);},server:function(n,o){m(n,"svr",o,8536,k);}};}());d=Object.keys(d).map(function(j){return mstrmojo.DI.DIHelpers.createMSTRObjects(d[j],X);});J.forEach(d,function(j){J.forEach(j.tables,function(k){k.dbRole=(k.dbRole&&k.dbRole.oi)||k.dbRole;k.dbmsObj=k.dbmsObj&&k.dbmsObj.oi;g=k.dbRole;if(g){g.dbmsObj=k.dbmsObj;a=g.dbmsObj;if(!g.dbms){g.dbms=g.def&&g.def.dbms&&g.def.dbms.did;}}if(!a||a.DBInfo){return ;}a.DBInfo={};e=a.DBInfo;V=g.efd;if(!V){return ;}V.forEach(function(l){Y=l.oi&&l.oi.def;if(!Y){return ;}h=Y.dbtp;if(h){g.db_type=h;e.dbTypes={dbt:{v:h,n:mstrmojo.desc(mstrmojo.DI.DIDatabaseHelper.getDescriptionIdByDBType(h))}};}W=Y.cnsr;if(!W){return ;}f=[];Z=null;g.connstr=W;W.split(";").forEach(function(m){b=m.split("=");b[0]=b[0].toLowerCase().trim();if(b[0]==="driver"){e.driverInstalled=true;}else{if(b[0]==="authenticationmethod"){Z=b;}else{if(c[b[0]]){c[b[0]](f,b[1]);}}}});if(Z){c[Z[0]](f,Z[1]);}});});});return d;};mstrmojo.DI.DIHelpers.filterDisableSources=function A(V){return J.indexOf(mstrApp.diParams.disabledSources,V)<0;};mstrmojo.DI.DIHelpers.getPopupWindowOptions=function R(){var Z={};var X=window.screenX||window.screenLeft||0,W=window.screenY||window.screenTop||0,Y=800,V=600,a;if(document.body&&document.body.offsetWidth){Y=document.body.offsetWidth;V=document.body.offsetHeight;}if(document.compatMode==="CSS1Compat"&&document.documentElement&&document.documentElement.offsetWidth){Y=document.documentElement.offsetWidth;V=document.documentElement.offsetHeight;}if(window.innerWidth&&window.innerHeight){Y=window.innerWidth;V=window.innerHeight;}if(window.outerWidth){Y=window.outerWidth;}if(window.outerHeight){V=window.outerHeight;}Z.height=V*0.5;Z.width=Y*0.8;if(Z.height<600||isNaN(Z.height)){Z.height=600;}if(Z.width<800||isNaN(Z.width)){Z.width=800;}Z.left=X+(Y-Z.width)/2;Z.top=W+(V-Z.height)/8;if(this.getEnvObj().isWSWin()&&this.getEnvObj().isDIinVI()){Z.left=(window.screen.width-Z.width)/2;Z.top=(window.screen.height-Z.height)/2;}a="width="+Z.width+",height="+Z.height;a+=",toolbar=0,scrollbars=1,status=1,resizable=1,location=1,menuBar=0";a+=",left="+Z.left+",top="+Z.top;return a;};mstrmojo.DI.DIHelpers.createPopupWindow=function G(W,V){var X,Y;Y=this.getPopupWindowOptions();if(!W){W="";}X=window.open(W,V,Y);return{wnd:X};};mstrmojo.DI.DIHelpers.openPopupWindow=function H(Y,W,V){var X;if(Y&&!Y.closed){Y.location=V;Y.focus();}else{X=this.createPopupWindow(V);Y=X.wnd;if(Y){Y.focus();}}return Y;};mstrmojo.DI.DIHelpers.sendResponse2Window=function B(W,V,Z){var Y;if(Z){Y=Z;}else{Y=window.opener;}if(Y){if(V===undefined){V=window.location.origin;if(!V){V=window.location.protocol+"//"+window.location.hostname+(window.location.port?":"+window.location.port:"");}}try{if(this.isIE()&&Y.postMessagePassthrough){Y.postMessagePassthrough(W,V);try{window.open("","_self","");window.close();}catch(a){window.close();}}else{Y.postMessage(W,V);}}catch(X){console.log("postMessage error: "+X);}}};mstrmojo.DI.DIHelpers.convertDataSourceType2SourceType=function F(V){switch(V){case U.dataSourceType.DROPBOX:return U.sourceType.dropbox;case U.dataSourceType.GOOGLE_DRIVE:return U.sourceType.googleDrive;case U.dataSourceType.GOOGLE_ANALYTICS:return U.sourceType.googleAnalytics;case U.dataSourceType.SALESFORCE:return U.sourceType.salesforce;case U.dataSourceType.GOOGLE_BIGQUERY:return U.sourceType.googleBigQuery;default:return -1;}};mstrmojo.DI.DIHelpers.highlightKeyWords=function K(d,e,V){var X="\\*.?+$^[](){}|/",f=d,b,Y;if(d===""){return e;}for(Y in X){if(X.hasOwnProperty(Y)){b=X[Y];f=f.replace(new RegExp("\\"+b,"g"),"\\"+b);}}var c=new RegExp("("+f+")","ig");var W="\u001E",a=mstrmojo.string.encodeHtmlString,Z;if(c.test(e)){e=e.replace(c,function(g){return W+g+W;});Z=J.map((e||"").split(W),function(h,g){return(g%2===0)?a(h):('<span class="'+V+'">'+a(h)+"</span>");});return Z.join("");}};mstrmojo.DI.DIHelpers.detectCustomImg=function(Y,X){if(!Y||!(X.nodeType&&X.nodeType===window.Node.ELEMENT_NODE)){return ;}var V=Y.replace?Y.replace(/\s+/g,""):"";var Z=document.getElementsByTagName("head")[0];var W=document.createElement("img");W.src="../javascript/mojo/css/images/DI/connectors/"+V+".png";W.onload=function(){X.style.background="url(../javascript/mojo/css/images/DI/connectors/"+V+".png) no-repeat";Z.removeChild(W);};W.onerror=function(){X.style.background="url(../javascript/mojo/css/images/DI/connectors/default.png) no-repeat";Z.removeChild(W);};Z.appendChild(W);};mstrmojo.DI.DIHelpers.spliceUrlBySeparator=function(W){var V=W.split("#");return V.slice(V.length/2+1).join("#");};mstrmojo.DI.DIHelpers.isOriginalConnector=function(W){var V=U.originalConnector;if(V.elastic===W||V.tapClicks===W){return true;}return false;};mstrmojo.DI.DIHelpers.acceptEventFromAncestor=function(V){if(!V){return true;}if(!this.domNode||typeof V.contains!=="function"||!this.hasRendered){return false;}return V.contains(this.domNode);};mstrmojo.DI.DIHelpers.isdbRoleWritable=function(V){if(mstrmojo.DI.DIHelpers.isOnetier()){return true;}else{return V.writable==="1"&&mstrApp.rootController.hasPrivilege(U.DssXmlPrivileges.DssXmlPrivilegesUseDatabaseInstanceManager);}};mstrmojo.DI.DIHelpers.isdbRoleUsable=function(V){return mstrmojo.DI.DIHelpers.isOnetier()?true:V.usable==="1";};mstrmojo.DI.DIHelpers.applyDriverSuffix=function(X){if(!X||!X.Preferences){return ;}var V=JSON.stringify(X),W=X.Preferences.driverNameSuffix,Z=this.getEnvObj();var Y="Platform";if(Z.isDesktopClient()){Y=Z.isMac()?"DesktopMac":"DesktopWin";}else{if(Z.isWSClient()){Y=Z.isMac()?"WorkstationMac":"WorkstationWin";}}var a=W[J.find(W,"n",Y)];return JSON.parse(V.replace(/!#DRIVERSUFFIX#!/g,a?a.value:""));};mstrmojo.DI.DIHelpers.isGeo=function(V){return V.georole&&V.georole>0;};mstrmojo.DI.DIHelpers.isTime=function(V){return V.dtp===parseInt(O.DATE,10)||V.dtp===parseInt(O.DATE_TIME,10)||V.dtp===parseInt(O.TIME,10);};}());(function(){mstrmojo.requiresCls("mstrmojo.EnumRWUnitType","mstrmojo.DocDataService","mstrmojo.func","mstrmojo.array","mstrmojo.hash","mstrmojo.vi.models.VIComponentMap.TYPES","mstrmojo.vi.controllers.EnumEvents","mstrmojo.vi.enums.EnumFeatures");var U=mstrmojo,P=mstrmojo.func,K=mstrmojo.array,M=mstrmojo.hash,H=mstrmojo.DocDataService,L=U.EnumRWUnitType,N=mstrmojo.vi.models.VIComponentMap.TYPES,J=U.DocDataService.REQUEST_DEFN_DATA,C=mstrmojo.vi.controllers.EnumEvents,F=mstrmojo.vi.enums.EnumFeatures;function I(Z,Y,X){(X.children||[]).forEach(function(a){I(Z,Y,a);});var W=Z.indexOf(X.k);if(W!==-1){X.k=Y[W];}}function D(W,a,Z){var Y=W&&W.parent,X=Y&&Y.panels;a=a+1;Z=Z+1;K.forEach(X,function(c){var b=c.defn.chdidx;if(b===Z){c.defn.chdidx=a;}if(Z<b&&b<=a){c.defn.chdidx=b-1;}if(a<=b&&b<Z){c.defn.chdidx=b+1;}});}function G(f,Z,W,c,a){var d=this.getLayoutDefn(Z),b=[];M.forEach(d.units,function(g){if(g.t===L.PANEL&&g.pnk===f&&!g._isDeleted){b.push(g);}});for(var Y=0;Y<W.length;Y++){var X=c[Y]+1,e=W[Y]+1;K.forEach(b,function(j,h){var g=j.chdidx;if(g===X){j.chdidx=e;}if(X<g&&g<=e){j.chdidx=g-1;}if(e<=g&&g<X){j.chdidx=a&&h===X-1?g:g+1;}});}}function R(W,a){if(!W||W.length===0){return -1;}var Z=0,Y=W.length-1;while(Z<Y-1){var X=Math.floor((Z+Y)/2);if(W[X]>a){Y=X;}else{Z=X;}}if(W[Z]>a){return Z;}if(W[Y]>a){return Y;}return -1;}function V(b,Z,e){var Y=this,a=Y.getLayoutDefn(Z).units||{},c=[].concat(e),d=c.slice();K.forEach(c,function(g){var f=Y.getPanel(g,Z);if(f){K.forEach(f&&f.children,function(j){var h=j.k;if(h){d.push(h);}if(!a[h]&&j.node&&j.node.defn){a[h]=j.node.defn;}});if(!a[g]&&f.node&&f.node.defn){a[g]=f.node.defn;}}else{M.forEach(a,function(j,h){if(j.pnk===g){d.push(h);}});}});d.forEach(function(f){if(a[f]){if(b){a[f]._isDeleted=true;}else{delete a[f]._isDeleted;}}});var W=Y.getVisPanelKeys(Z),X=[];K.forEach(c,function(f){if(a[f]){X.push(a[f].chdidx);}});X.sort(function(g,f){return g-f;});if(b){K.forEach(W,function(g){var h=a[g];if(!h._isDeleted){var f=R(X,h.chdidx);if(f===-1){h.chdidx-=X.length;}else{h.chdidx-=f;}}});}if(!b){K.forEach(X,function(g){var f=g,h=null;K.forEach(W,function(j){var k=a[j];if(!k._isDeleted){if(c.indexOf(j)===-1&&k.chdidx>=f){k.chdidx+=1;}else{if(c.indexOf(j)!==-1&&k.chdidx===f){h=j;}}}});c.splice(c.indexOf(h),1);});}Y.raiseEvent({name:C.UPDATE_TOC});}mstrmojo.vi.models._PanelActions=mstrmojo.provide("mstrmojo.vi.models._PanelActions",{_mixinName:"mstrmojo.vi.models._PanelActions",addPanel:function(Z,f,c,a,e){var d=this.getVIComponent(N.VIZ_CONTENT,c),g=this.createNewUnitNode(null,function(h){h.t=L.PANEL;return h;},null,null,c),Y=g.k,X=this.id,W=null;if(a){a.k=Y;}if(d){var b=d.builder;W=b.build([g],this,{pk:f})[0];d.addChildren([W],null,false,true);d.doLayout();W.boxLayoutConfig.useDefaultBox([]);}Z.add([{act:"addPanel",nodeKey:Y,titlePattern:mstrApp.supportFeature(F.USE_WORKSTATION_NAMING_STYLE)?1:0,parentKey:f,index:0}],{success:function(j){var h=mstrmojo.all[X];h.partialUpdate(j.data,h.getUnitDefinitions(Y),j.defn);if(W){g.defn=h.getUnitDefinitions(Y)[Y];W.defn=g.defn;W.node.defn=g.defn;}if(!e){h.raiseEvent({name:C.UPDATE_TOC});}}},J);return W;},selectNewPanel:function(X,W){X.add([{act:"setCurrentPanel",unitKey:W}],{success:function(){var Y=this.getPanel(W);Y.parent.selectPanel(W,null,true);}.bind(this)});},duplicatePanel:function B(W,h,a,e,f,X,l){var m=l||this.createNewUnitNode(null,function(n){n.t=L.PANEL;return n;}),Y=m.k,b=W.k,k=h.k,Z=this.id,g=mstrmojo.desc(11450,"## copy ###"),d=[{act:"duplicatePanel",nodeKey:b,parentKey:k,duplicateKey:g.replace("###",W.numDupl===0?"":W.numDupl).replace("##",W.titleText),newKey:Y,index:a+1},{act:"setCurrentPanel",unitKey:Y}],c;var j=this.getDataService();this.execute({execute:function(){var n=this,o=j.newUpdate(n,{actions:d,extras:J,callback:{success:function(r){var q=mstrmojo.all[Z];q.partialUpdate(r.data,q.getUnitDefinitions(r.pukeys||Y),r.defn);m.defn=q.getUnitDefinitions(Y)[Y];var u=f.build([m],q,{pk:k});c=u[0];h.addChildren(u);var t=h.children.length,p=h.panels.length;h.changePanelPosition(c,p-1,a,t-1,a);G.call(q,k,e,[a],[p-1],true);if(c.defn.layoutXML){I.call(this,W.getTargetKeysExcludingTypes(),c.getTargetKeysExcludingTypes(),m.defn.layoutXML);}W.numDupl=W.numDupl+1;h.selectPanel(Y,null,true);h.doLayout();q.getPanel().saveBoxLayout(null,q.cmdMgr().CMD_PHASE.LAST);q.raiseEvent({name:C.UPDATE_TOC});}}});o.submit();},urInfo:{disablePU:true,treesToRender:3,undo:X.undo,redo:X.redo},discard:X.discard});},movePanel:function S(W,Z,Y,b){var a=this.getDataService(),X=this;b=P.composite([b,function(){D(W,Z,Y);X.raiseEvent({name:C.UPDATE_TOC});}]);this.execute({execute:function(){this.submit([a.getMoveNodeAction(W,W.parent.k,Z),{act:"setCurrentPanel",unitKey:W.k}],{success:function(){b(Y,Z);}},H.RAPID_EXEC);},urInfo:{silent:true,undo:function(){b(Z,Y);},redo:function(){b(Y,Z);}}});},movePanelsInLayout:function E(g,m,d,W,f,l){var j=this.getDataService(),c=this,X=g&&g[0],e=this.getPanel(X,d).parent,k=e.k,Y=e.selector,h=Y.selectMovedTab,Z=h&&m!==X,b=e.selectedKey,a=c.getDataService().newUpdate();l=P.composite([l,function(o,n){G.call(c,k,d,n,o);c.raiseEvent({name:C.UPDATE_TOC});}]);K.forEach(g,function(p,n){var o=j.getMoveNodeActionUsingKey(p,L.PANEL,k,W[n]);a.actions.push(o);});if(Z){e.selectPanelDeferred(a,X,false,false);}a.callback=P.wrapMethods({success:function(){l(f,W);}},a.callback);a.extras=M.copy({params:{suppressData:Z?false:true}},a.extras);this.execute({execute:function(){this.submitUpdate(a);},urInfo:{silent:h?false:true,treesToRender:h?H.EnumTreesToRender.BOTH:H.EnumTreesToRender.NONE,undo:function(){this.urInfo.puKeys=[b];var o=W.slice(),n=f.slice();o.reverse();n.reverse();l(o,n);},redo:function(){this.urInfo.puKeys=[X];l(f,W);}}});},getRemoveUnitAction:function O(W){return{act:"removeUnit",unitKey:W.k,unitType:W.defn.t};},getRemoveVisPanelAction:function A(W){return{act:"removeUnit",unitKey:W,unitType:L.PANEL};},getSetCurrentPanelAction:function Q(W){return{act:"setCurrentPanel",unitKey:W};}});mstrmojo.vi.models._PanelActions.defnUpdatePanelRemoval=V;}());(function(){mstrmojo.requiresCls("mstrmojo.ui.PopupConfig","mstrmojo.array","mstrmojo.hash","mstrmojo.css","mstrmojo.ui._HasUITheme","mstrmojo.vi.ui.theme","mstrmojo.dom");function g(h,k){if(!mstrmojo.DocInfoWindow){return ;}var j=h;while(j){if(j instanceof mstrmojo.DocInfoWindow){j[k?"registerScrollLock":"releaseScrollLock"](this);break;}j=j.parent;}}var N=mstrmojo.array,D=mstrmojo.dom,S=mstrmojo.hash,e=mstrmojo.css,G="px",K=mstrmojo.ui._HasUITheme.EnumThemeNames;var C=false;function M(h,k){if(!mstrmojo.DocInfoWindow){return ;}var j=h;while(j){if(j instanceof mstrmojo.DocInfoWindow){j[k?"registerLock":"releaseLock"](this);this.lockIW=k?j:null;break;}j=j.parent;}}var W=mstrmojo.ui.PopupConfig,O=W.directionCfg,B=W.ENUM_CORNERS,Z=B.TOP_LEFT,V=B.TOP_RIGHT,I=B.BOTTOM_RIGHT,H=B.BOTTOM_LEFT;function J(h){return(h===H||h===Z);}function d(h){return(h===V||h===I);}function Q(h){return(h===I||h===H);}function U(h){return(h===V||h===Z);}function a(q,k,AA,AG){var AJ=AA.x,AI=AA.y,AF=AA.w||0,u=AA.h||0,j=AG.w,AB=AG.h,AE=q.alignment,o=AE.popup,m=AE.host,AH=d(m),AK=Q(m),AD=false,x=false,l=false,z=false,n=false,v=false,AC=D.isMobile,r=mstrmojo.ui.PopupConfig.directionCfg;if(J(o)){var p=AJ+j+(AH?AF:0);AD=k.w<p;n=AC&&(AD||r.isRightToLeft());}if(U(o)){var w=AI+AB+(AK?u:0);x=k.h<w;v=AC&&x;}if(d(o)||n){var t=AJ-j+((AH&&!n)?AF:0);l=t<0;}if(Q(o)||v){var h=AI-AB+((AK&&!v)?u:0);z=h<0;}return{top:z,bottom:x,left:l,right:AD};}function F(j){var h=this.popupConfig;if(h){S.forEach(h.popupHandlers,function(l,m){var k=l[j?"open":"close"];if(k){k.call(mstrmojo.all[m]||k,!!j);}});}}function L(j){var h=this.popupConfig;if(h&&!h.isHostedWithin){var k=this.hostProxy;if(k){k.style.display=j?"":"none";}}}function f(h){return h!==undefined&&h!==null&&!isNaN(h);}mstrmojo._IsPopup={visible:false,lockIWForScroll:false,disposable:true,opener:null,onOpen:mstrmojo.emptyFn,onClose:mstrmojo.emptyFn,popupConfig:null,hostProxy:undefined,open:function P(k,h){F.call(this,true);if(this.updatePopupConfig){this.updatePopupConfig(h,k);}else{S.forEach(h,function(n,m){this.set(m,n);},this);}var j="popup-mid-render";this.set("opener",k);if(!this.hasRendered){var l=this.visible;this.visible=false;this.render();e.addClass(this.domNode,j);this.set("visible",l);}if(this.nudge){this.domNode.style.top="-10000px";}L.call(this,true);this.set("visible",true);if(this.lockIWForScroll){g.call(this,this.opener,true);}if(h&&h.lockIW){M.call(this,h.lockIW,true);}if(this.nudge){this.nudge();}if(this.adjustSize){this.adjustSize();}this.adjustCornersForPopupOverflow();this.onOpen();e.removeClass(this.domNode,j);},adjustCornersForPopupOverflow:function b(){var t=this.popupConfig;if(!t){return false;}var AY=(t.includeScroll!==undefined)?t.includeScroll:true;var n=t.anchorElement||t.hostElement,l=t.position||D.position(n,AY),AE=n&&n.style&&n.style.zIndex;if(!t.isHostedWithin){var Ag=this.hostProxy,AX=this.hostProxy=document.createElement("div");document.body.appendChild(AX);AX.appendChild(this.domNode);if(Ag){Ag.parentNode.removeChild(Ag);}var AO=AX.style,AP={x:"left",y:"top",w:"width"};AX.className=t.hostProxyCssClass;AO.position="absolute";AO.background="none";e.addClass(AX,"mstrmojo-popup-widget-hosted");AO.height="0";N.forEach(["x","y","w"],function(Ap){var Ao=l[Ap];if(f(Ao)){AO[AP[Ap]]=Ao+G;}});}var AD=t.ENUM_CORNERS,Am=AD.BOTTOM_LEFT,AQ=AD.BOTTOM_RIGHT,j=AD.TOP_RIGHT,AJ=AD.TOP_LEFT;var q=D.position(document.body),AS=D.position(this.domNode),Ab=a(t,q,l,AS),p=Ab.right,AC=Ab.bottom,An=Ab.left,AW=Ab.top,AF=t.alignment,AN=AF.popup,k=AF.host,w=AN,AB=k,AR=D.isMobile,AA=n&&n.classList&&n.classList.contains("mstrmojo-ui-Menu-item"),AT=this.id,x=n&&n.parentNode,AU=x&&x.parentElement,AM=n||this.domNode,AK,Ah=this.domNode.style;if(AU&&AU.classList.contains("mstrmojo-ui-Menu")){AM=AU;}AK=D.position(AM);if(AA&&((An&&p)||(AW&&AC))){if(AU){Ah.top=AK.y+"px";Ah.left=AK.x+"px";var Af=document.getElementsByClassName("mstrmojo-ui-Menu");N.forEach(Af,function(Ao){if(AT!==Ao.id){Ao.style.visibility="hidden";}});}t.anchorElement=AM;t.position={h:0,w:0,x:(AK.x+AS.w)>q.w?Math.min(AK.x,5):AK.x,y:(AK.y+AS.h)>q.h?Math.min(AK.y,90):AK.y};this.adjustCornersForPopupOverflow();return ;}if(O.isRightToLeft()&&(!AR||AS.w>0)){if(!AR||!An){p=true;}else{if(!AR||!p){O.setDirection(false);this.resetDirection=true;if(AR){AB=(AB===j)?AJ:Am;}}}}else{if(p){O.setDirection(true);this.resetDirection=true;}}if(p||An){if(J(AB)){AB=U(AB)?j:AQ;}else{if(d(AB)){AB=U(AB)?AJ:Am;}}if(p&&J(w)){w=U(w)?j:AQ;}else{if(An&&d(w)){w=U(w)?AJ:Am;}}}if(AC||AW){if(J(AB)){AB=U(AB)?Am:AJ;}else{if(d(AB)){AB=U(AB)?AQ:j;}}if(AC&&U(w)){w=J(w)?Am:AQ;}else{if(AW&&Q(w)){w=J(w)?AJ:j;}}}if(AW||p||AC||An){if(C){console.log("Overflow directions: "+JSON.stringify(Ab));}this._orgalgn={host:k,popup:AN};t.setAlignment(AB,w);}if(!t.isHostedWithin){if(f(l.y)&&f(l.h)){this.hostProxy.style.top=(l.y+(Q(w)?(t.alignWithAnchor===true?l.h:0):(t.alignWithAnchor===true?0:l.h)))+G;this.hostProxy.style.zIndex=(f(AE)&&(AE>100))?AE+1:101;}}var AV,Aj={};if(t.isHostedWithin&&!!this.opener){AV=e.getComputedStyle(this.opener.domNode);}N.forEach(["left","right","top","bottom"],function(Ao){Aj[Ao]=AV?parseInt(AV["border-"+Ao+"-width"]||0,10):0;});var Ad=Q(AB),Ae=d(AB),v=Q(w),o=d(w),AZ=function(Ap,Ao){return"calc(100% + "+(Ao?Aj[Ap]:0)+"px)";},z=function(Ap,Ao){return(Ao?-Aj[Ap]:0)+"px";};var r,Aa,h,m;r=Aa=h=m="auto";if(v){h=Ad?z("top"):AZ("top");}else{r=Ad?AZ("bottom"):z("bottom");}if(o){Aa=Ae?z("left"):AZ("left");}else{m=Ae?AZ("right"):z("right");}Ah.top=r;Ah.right=Aa;Ah.bottom=h;Ah.left=m;var u=D.position(this.domNode),AL=5;if(AC||AW){var Ak=u.y,AG=D.getMaxScrollHeight()+"px",Ai=this.scrollNode,AH=Ai&&Ai.style.maxHeight;if(Ak<0||(Ak+u.h>q.h)){if(Ai&&AG!==AH){Ai.style.maxHeight=AG;this.updateScrollbars();}var Ac=(-l.y+AL)+G;if(!t.isHostedWithin){if(this.hostProxy){this.hostProxy.style.top=0;}Ac=AL+G;}Ah.top=Ac;Ah.bottom="auto";}}if(An||p){var Al=u.x;if(Al<0||(Al+u.w>q.w)){var AI=(-l.x+AL)+G;if(!t.isHostedWithin){if(this.hostProxy){this.hostProxy.style.left=0;}AI=AL+G;}Ah.left=AI;Ah.right="auto";}}return true;},close:function R(j){if(this.keepOpen){return ;}if(this.onClose){this.onClose(j);}L.call(this,false);if(this.lockIWForScroll){g.call(this,this.opener,false);}this.set("visible",false);this.set("opener",null);if(this.lockIW){M.call(this,this.lockIW,false);}F.call(this,false);var h=this._orgalgn;if(h){this.popupConfig.setAlignment(h.host,h.popup);}if(this.resetDirection){this.resetDirection=false;O.setDirection(false);}},preBuildRendering:function A(j){this._super(j);var m=this.popupConfig;if(m&&!m.isHostedWithin){var h=m.hostProxyCssClass.split(" "),l=false;N.forEach(S.keyarray(K),function(n){if(h.indexOf(K[n])>=0){l=true;return false;}});if(!(l||m.noInheritTheme)){var k=mstrmojo.vi.ui.theme.getThemeClass.call(this);if(k){h.push(k);}}m.hostProxyCssClass=h.join(" ");}},buildRendering:function E(){var h=this._super();if(h){if(!this.parent&&!this.domNode.parentElement){document.body.appendChild(this.domNode);}}return h;},postBuildRendering:function Y(){var h=this,j=this.popupConfig;if(j&&!this._ListenerProc){this._ListenerProc=function(){h.monitorWindow();};D.attachEvent(window,"resize",this._ListenerProc);}this._super();},monitorWindow:function(){var j=D.getMaxScrollHeight();if(this.updateScrollbars&&this.scrollNode){this.scrollNode.style.maxHeight=(this.scrollNodeMaxHeight||j)+"px";this.updateScrollbars();}if(this.visible){var h=this,k=null;window.clearTimeout(k);k=window.setTimeout(function(){h.scrollNode.style.maxHeight=(h.scrollNodeMaxHeight||j)+G;h.adjustCornersForPopupOverflow();},175);}},destroy:function c(h){if(this._ListenerProc){D.detachEvent(window,"resize",this._ListenerProc);delete this._ListenerProc;}this._super(h);},unrender:function X(h){if(this.popupConfig&&!this.popupConfig.isHostedWithin&&this.hostProxy){document.body.removeChild(this.hostProxy);delete this.hostProxy;}this._super(h);}};}());(function(){mstrmojo.requiresCls("mstrmojo.Obj","mstrmojo.array","mstrmojo.StringBuffer","mstrmojo.ResSetLink");var k=1,U=2;var E=2,L=4,D=5;var X=1,O=4;var h=mstrmojo.array;function H(l,m){return l[((m===k)?"row":"col")];}function B(l,n){var m=n.lm;return m&&m[l.mix||0];}function d(m,r,AA){var w=new mstrmojo.ResSetLink({mid:this.getMessageId(),srct:r.target.t||2,aopam:r.daMode});var t=r.ans,x=t&&t.length;if(x){var u=w.prms=[],n=0;for(n=0;n<x;n++){var AD=t[n];var o=AD.pid,q=parseInt(AD.m,10),AC={id:o,am:q,pt:AD.pt};u.push(AC);if(AD.po){AC.orid=AD.po.did;AC.ortp=AD.po.t;}switch(q){case w.DO_NOT_ANSWER:case w.CLOSE:case w.USE_DEFAULT_ANSWER:case w.SAME_PROMPT:break;case w.STATIC:var l=AD.es,AB=(l&&l.length)||0,v;AC.pa={es:[]};for(v=AB-1;v>=0;--v){var p=l[v];AC.pa.es.push({ei:p.id,disp_n:p.n,emt:1});}break;case w.DYNAMIC:case w.ALL_VALID_UNITS:case w.CURRENT_UNIT:case w.DYNAMIC_OR_SAME_PROMPT:if(AA.els){A.call(this,AD,AA,AC,q,w);}else{K.call(this,AD,AA,AC,q,w);}break;}}}return w;}function A(t,m,l,r,q){var p=t.dunits,n=m.els,o=l.pa={};h.forEach(n,function(u){if(h.find(p,"id",u.id)>=0){if(r!==q.DYNAMIC&&r!==q.DYNAMIC_OR_SAME_PROMPT){o.a={id:u.id,n:u.disp_n,dispForms:u.dfi};}if(t.pt===1){o.v=u.v;}else{o.es=[];o.es.push({ei:u.ei,emt:u.emt,disp_n:u.disp_n});}}});}function K(AB,x,AA,p,r){var t=AB.dunits,v=AB.dsUnits;if(t&&t.length&&x){var u=AA.pa={};var o=x,n=(x.mix!==undefined)&&(x._lp||x._tp);if(n){o=x._lp||x._tp;}var m=parseInt(o.axis,10);while(o){var z=this.getPTitle(o,m);if(z&&h.find(t,"id",z.id)>=0){var q={id:z.id,n:z.n,dispForms:z.dfi};if(p===r.ALL_VALID_UNITS){u.a=(u.a||[]).concat(q);}else{if(p!==r.DYNAMIC&&p!==r.DYNAMIC_OR_SAME_PROMPT){u.a=q;}}if(AB.pt===1){var l=AB.formMap;u.v=l&&l[o.fmi]?l[o.fmi]:o.v;break;}else{var w={ei:o._e.id,emt:1,disp_n:o._e.n};if(p===r.ALL_VALID_UNITS){u.es=(u.es||[]).concat(w);}else{u.es=[].concat(w);}}if(p===r.CURRENT_UNIT){break;}}o=this.getPCellParentNode(o,m);if(n&&!o&&m===k){m=U;o=x._tp;}}}else{if(v&&v.length&&x){AA.pa={es:v};}}}function R(n){var m=this.getCellTitleInfo(n[0]),p=[],r=function(t){if(t){if(mstrApp.useBinaryFormat){if(t._e){p.push(t.axis+"A"+(t.ui+1)+"A"+t._e.id);}r(t._p);}else{p.push(t.axis+"A"+(t.ui+1)+"A"+t.o);}}},o,l;if(!m.isSrcTitle){for(o=0,l=n.length;o<l;o++){var q=n[o];if(q.mix!==undefined&&(q._lp||q._tp)){r(q._lp);r(q._tp);}else{r(q);}}}return(mstrApp.useBinaryFormat)?p:p.join(",");}function J(p,o,m){var n=true,l=m.length;while(p<l){if(m[p].id!==o.id){n=false;break;}p++;}return n;}mstrmojo.XtabModel=mstrmojo.declare(mstrmojo.Obj,null,{scriptClass:"mstrmojo.XtabModel",getMessageId:function S(){return this.data.mid;},getCellTitleInfo:function e(m,p){var n=p?p.gts:this.data.gts;var o=null;if(n){if(m&&m.mix===undefined){o=H(n,m.axis)[m.tui||m.ui];}else{var l=function(t){var q=(t&&t.length)||0,r;for(r=q-1;r>=0;--r){if(parseInt(t[r].otp,10)===-1){return t[r];}}return null;};o=l(n.col)||l(n.row);}}return{isSrcTitle:!!m&&(m.o===undefined)&&!((m.mix!==undefined)&&(m._lp||m._tp)),title:o};},getCellInfo:function I(m){var l=this.getCellTitleInfo(m),n={isTitle:false,isHeader:false,isMetric:false};if(m&&(m.hasOwnProperty("mix")||m.otp===-1)){n.isMetric=true;if(m._e){n.isHeader=true;}}if(l.isSrcTitle){n.isTitle=true;}return n;},getCellLinksInfo:function g(m,n){if(!n){var l=this.getCellTitleInfo(m);n=l&&l.title;}return B(m,n);},getAllDrillPathsForCell:function b(m,o){if(!o){var l=this.getCellTitleInfo(m);o=l&&l.title;}var n=h.filter(o.dp,function(q){var p=q&&q.oid;if(p&&m._e&&m._e.oid){return p===m._e.oid;}return true;});return n;},getCellDrillsInfo:function G(l,n){var m=this.getAllDrillPathsForCell(l,n);return m&&m[l.mix||0];},getLinkDrillAction:function P(l){return this.getActionObject(l);},getAction:function W(l){return this.getActionObject(l);},getActionObject:function M(m){var l=m[0]&&m[0].at,n=null;if(l){if((l&O)>0){n={h:"onLink",a:this.getLinkAction(m[0])};}else{if((l&X)>0){n={h:"onDrill",a:this.getDrillAction(m)};}}}return n;},getSortAction:function F(AB,u){var p=this.getCellTitleInfo(AB),x=p.title,m=[],o=p.isSrcTitle?x.axis:(h.find(this.data.gts.col,"otp",-1)>-1?k:U),AA=this.data.gts[((o===k)?"row":"col")+"SubPos"],r,w,v,z,AC;u=(u===null||u===undefined)?!(AB&&AB.so):u;if(p.isSrcTitle){r=E;w=x.id;v=x.otp;z=x.fid;}else{r=L;v=4;AC=x.stt;var t,l;do{t=AB._e;if(t){if(t.oid){w=t.oid;}else{l=t.id.replace(/;/g,"\\;");m.push(l);}}AB=AB._p;}while(AB);}var q={sortType:r,axis:o,isAsc:u,unitID:w,unitType:v,elementList:m.join(";"),subTotalsPos:AA};if(w){q.unitID=w;}if(z){q.formId=z;}if(AC){q.sortType=D;q.stt=AC;}var n;if((r===L)||(r===D)){n=["","",q.elementList||"",q.axis];}else{n=[q.formId,"21","",q.axis];}n=[q.unitType,q.unitID].concat(n);q.sortKey=n.join("!");return q;},getSubTotalsPos:function Z(){var l=this.data.gts;if(l){return[l.rowSubPos,l.colSubPos];}return[0,0];},getPivotAction:function N(m,u){var o=false,n=m.hasOwnProperty("mix"),v=n?null:m.axis,r=(n?m.idx:m.ui)+1,AB=(m.otp===-1);if(!isNaN(u)){v=parseInt(u,10);r=1;if(n){n=false;AB=true;}}else{var z=(u==="u"||u==="l"||u==="b");if(!n){var p=H(this.data.gts,v),AD=0,AG={},l=false;mstrmojo.array.forEach(p,function(AH){if(AG[AH.id]){AG[AH.id].frm++;}else{AD++;AG[AH.id]={pos:AD,frm:1};if(AH.id===m.id){l=true;}else{if(l){return false;}}}});r=AG[m.id].pos;var AA=m.fix;if(AA){if((!z||AA>1)&&!this.xtab.isOutlineMode){if(z||AA!==AG[m.id].frm){r=AA;o=true;}}}}else{var AE=H(this.data.gts,m.axis),x=AE[m.ui].es,t=this.data.gsi.mx;if(x.length!==t.length){var w=x[r+(z?-1:1)-1];if(w){var q=h.find(t,"did",w.oid);if(q!==-1){r=q+(z?1:-1)+1;}}}}if(u==="b"){r=1;}else{r=r+(z?-1:1);}}var AC={act:"pivot",unitPos:r};if(o){AC.attFormId=m.fid;}else{if(!n){AC.axis=v;}}if(!AB){var AF=n?m._e:m;if(!o){AC.unitType=AF.otp;}AC.unitId=n?AF.oid:m.id;}return AC;},isPvtButtonVisible:function f(t,n){var p=t.axis,o=H(this.data.gts,p),r=t.ui,m=t.hasOwnProperty("mix");if(n==="b"&&r===0){return false;}if(!isNaN(n)){if(parseInt(n,10)===p){return false;}if(m){return !!o[t.ui]._hid;}return true;}var q=o[t.ui].es,l=m?q.length:o.length;if(l===1){return false;}if(p===(m?U:k)){if(n==="u"||n==="d"){return false;}}else{if(n==="l"||n==="r"){return false;}}if(m?t._e===q[0]:r===0){if(n==="l"||n==="u"){return false;}}if(m?t._e===q[l-1]:(this.xtab.isOutlineMode&&t.fix)?J(r+1,t,o):r===l-1){if(n==="r"||n==="d"){return false;}}return true;},getDrillAction:function C(l,n){var m=n||this.getCellDrillsInfo(l[0]);return{srcMsgId:this.data.mid,sliceId:this.xtab.sid,isWithin:m.within,drillPathKey:m.k,drillPathIndex:m.dpi,drillElements:R.call(this,l)};},isVis:function c(){if(this.xtab){return this.xtab.isVis&&this.xtab.isVis();}else{var l=this.controller&&this.controller.view;if(l&&l.isVis){return l.isVis();}}return false;},getPTitle:function j(n,m){var l;if(this.isVis()){l=n.titleInfo;}else{l=H(this.data.gts,m)[n.tui];}return l;},getPCellParentNode:function Q(n,m){var l;if(this.isVis()){l=(m===k)?n._lp:n._tp;}else{l=n._p;}return l;},getLinkAction:function V(n,m){var l,o;if(this.isVis()){n=n.node;o=n.titleInfo;}else{l=this.getCellTitleInfo(n);o=l.title;}return this.getLinkActionImpl(n,o,m);},getLinkActionImpl:function a(z,u,w){var n=B(z,u),v=n&&n.links,AA=(n&&n.onw)?"_blank":"";if(w===null||w===undefined){w=(n&&n.di)||0;}var q=v&&v[w];if(!q){return null;}var o={linkInfo:q,linkTarget:AA};var l=q.url;if(l){var p="&CurrentElement";if(z&&u&&l.indexOf(p)>-1){l=l.replace(p,z._e.id);}o.url=l;}else{var r=q.target,x,m;switch(parseInt(r&&r.t,10)){case 55:if(parseInt(r.st,10)===14081){if(r.dvm&(8192|2048)&&!((r.dvm&2048&&mstrApp.features["run-vi-flash"]))){x=3140;if(mstrmojo.dom.isIE6||mstrmojo.dom.isIE7||mstrmojo.dom.isIE8){mstrmojo.alert(mstrmojo.desc(15474,"To work with HTML5 dossiers, please turn off your browser Compatibility View or update your browser to one of the following browser versions: Chrome, Firefox, Safari, Internet Explorer 9 or above."));return null;}m="objectID";}else{x=2048001;m="documentID";}}else{x=32001;m="documentID";}break;case 3:x=4001;m="reportID";o.reportViewMode=((parseInt(r.st,10)===769)?2:1);break;default:return null;}o.evt=x;o[m]=r.did;o.srcMsgId=this.getMessageId();var t=d.call(this,n,q,z);if(t){o.link=t;}return o;}},getDownloadAction:function Y(o,m,q,n,p,l,r){return{xtabId:p,rowPosition:o,maxRows:m,colPosition:q,maxColumns:n,rowMode:r,memo:l};}});}());(function(){mstrmojo.requiresCls("mstrmojo.Widget","mstrmojo._Formattable");mstrmojo.DocLine=mstrmojo.declare(mstrmojo.Widget,[mstrmojo._Formattable],{scriptClass:"mstrmojo.DocLine",markupString:'<div id="{@id}" k="{@k}" class="mstrmojo-DocLine" title="{@tooltip}" style="{@domNodeCssText}"></div>',formatHandlers:{domNode:["RW","border-top","border-left","fx"]},markupMethods:{onvisibleChange:mstrmojo.Widget.visibleMarkupMethod},update:function B(C){if(this.thresholdId||C.data.tid){delete this.fmts;}this.thresholdId=C.data.tid;this.set("visible",!C.data.hidden);if(this._super){this._super(C);}},getFormats:function A(){var C=this._super();if(C&&parseInt(C.height,10)===0){C.height="1px";}return C;}});}());(function(){mstrmojo.requiresCls("mstrmojo.Widget");var C=mstrmojo.css,G=mstrmojo.array;function F(H,J){var I={searchMetadata:{taskId:"searchMetadata",styleName:this.searchStyleName,rootFolderID:this.rootID,searchPattern:this.searchPattern+"*",nameWildcards:(this.qse?16:1),quickSearch:this.qse,sortKey:(this.qse?-1:6),blockBegin:this.blockBegin||1,blockCount:this.blockCount,recursive:1,folderBrowserStyle:0,includeAncestorInfo:"true",includeObjectDesc:this.includeObjectDesc,searchXML:this.searchXML||"",dataSourcesXML:this.dataSources||"",objectType:this.objectTypes},browseFolder:{taskId:"searchMetadata",rootFolderID:this.rootID,blockBegin:this.blockBegin,blockCount:this.blockCount,recursive:this.hierarchical?0:(this.searchXML?"":1),folderBrowserStyle:this.hierarchical?1:0,includeAncestorInfo:String(!!this.hierarchical),searchXML:this.searchXML||"",dataSourcesXML:this.dataSources||"",objectType:this.objectTypes},browseElements:{taskId:"browseElements",styleName:"MojoAttributeStyle",attributeID:this.rootID,blockBegin:this.blockBegin,blockCount:this.blockCount,filterXML:this.filterXML||"",searchPattern:this.searchPattern||"",matchCase:!!this.matchCase,dataSourcesXML:this.dataSourcesXML||"",includeFormNames:!!this.collectForms,includeFormValues:!!this.bIncludeFormValues,displayedForms:this.displayedForms||1,dimensionID:this.dimensionId||""}}[H]||{};if(typeof J==="object"){mstrmojo.hash.copy(J,I);}return I;}var B="##searchPattern";mstrmojo.SearchBox2=mstrmojo.declare(mstrmojo.Widget,null,{scriptClass:"mstrmojo.SearchBox2",taskId:"searchMetadata",rootID:null,searchStyleName:"MojoFolderStyle",objectTypes:"3,14,256,257,1024,1027,2048,3072,10",token:{searchMetadata:/\//,browseElements:/(^-)|(,)|( OR )|( AND)|([<>]=?)|(&)|( )|(["\[\]\/])/},blockCount:50,blockBegin:1,minSearchLength:2,matchCase:false,enableMatchCase:true,supportIncFetch:true,quickSearch:false,searchAfterSearchPatternRestored:false,includeObjectDesc:true,forceResetCache:false,onUpdateSearchParams:mstrmojo.emptyFn,markupString:'<table id={@id} cellspacing=0 cellpadding=0 class="mstrmojo-SearchBox-Wrapper {@cssClass}" style="{@cssText};"><tr><td><div class="mstrmojo-SearchBox" mstrAttach:click ><input class="mstrmojo-SearchBox-input" type="text" mstrAttach:keyup,blur /></div></td><td><div class="mstrmojo-SearchBox-bg"><div class="mstrmojo-SearchBox-search" id="{@id}sbSearch" mstrAttach:click ></div></div></td><td><div class="mstrmojo-SearchBox-options" style="{@cssTextShowMC}"><input id="{@id}sbMatchCase" type="checkbox" mstrAttach:click /><label for="{@id}sbMatchCase">'+mstrmojo.desc(4326,"Case Sensitive")+"</label></div></td></tr></table>",markupSlots:{inputNode:function(){return this.domNode.rows[0].cells[0].firstChild.firstChild;},searchNode:function(){return this.domNode.rows[0].cells[1].firstChild.firstChild;},optionNode:function(){return this.domNode.rows[0].cells[2].firstChild.firstChild;}},preBuildRendering:function(){this.cssTextShowMC=this.enableMatchCase?"":"display: none";},postBuildRendering:function(){if(this._super){this._super();}this.matchCase=this.optionNode.checked;},onkeyup:function E(H){var J=this;var I=J.searchTimer;if(I){window.clearTimeout(I);}J.searchTimer=window.setTimeout(function(){J.onkeyupDelayed(H);delete J._searchTimer;},parseInt(H.e.keyCode||H.e.charCode,10)===13?0:J.searchDelay);},onkeyupDelayed:function A(I){var H=I.hWin,K=I.e||H.event;var J=mstrmojo.string.trim(this.inputNode.value);if(this.searchNode){C.toggleClass(this.searchNode,["clear"],J.length>0);}this.showTaskError=false;this.click2Search=false;if(J.length==0||this.autoSubmit||this.onEnter&&K.keyCode===13){this._onsearch();}},onEnter:function(){this._onsearch();},onclick:function(I){var H=I.hWin,K=I.e||H.event,M=K.target||K.srcElement,L=M&&M.id;switch(L.replace(this.id,"")){case"sbDown":if(this.enableMatchCase){var J=this.optionNode.parentNode.style;J.display=J.display=="block"?"none":"block";}break;case"sbSearch":if(this.inputNode.value.length>0){this.clearSearch();}break;case"sbMatchCase":this.set("matchCase",this.optionNode.checked);break;case"sbSpinner":break;}},clearSearch:function(){this.inputNode.value="";C.removeClass(this.searchNode,["clear"]);var I=this.searchCache,H=this.rootID;if(I&&I[H]){I[H][B]="";}this._onsearch(true);},onmatchCaseChange:function(){this.matchCaseChanged=true;this._onsearch();},onrootIDChange:function(){this.rootChanged=true;this._setupCache(this.forceResetCache);var I=this.searchCache[this.rootID];if(I){var H=I[B]||"";this.inputNode.value=H;if(H.length>0){if(H.length>=this.minSearchLength&&this.searchAfterSearchPatternRestored){this._onsearch();}}}},getRootID:function(){},contentWidget:null,_notifyContentWidget:function(I){var H=this.contentWidget||this;H.set("items",I[0]);if(this.supportIncFetch){var J=I[1],L=I[2],K=this.blockCount;H.set("ifs",{np:Math.floor(J/K)+((J%K>0)?1:0),cp:Math.floor(L/K)+((L%K>0)?1:0)});}},_onsearch:function(H){this.getRootID();this._setupCache();var K=mstrmojo.string.trim(this.inputNode.value);if(K.length===0){H=true;}var L=this.token[this.taskId];if(L.test(K)){}if(this.searchPattern==K&&!this.rootChanged&&!this.matchCaseChanged&&!this.click2Search){return ;}var M=this.rootID,J=this.searchCache[M];if((K.length<this.minSearchLength&&!this.click2Search)&&!H){if(this.searchPattern&&this.searchPattern.length>=this.minSearchLength){this._notifyContentWidget(J[M]);this.searchPattern=K;}}else{this.searchPattern=K;J[B]=this.searchPattern;var I=this.filterCache(K,J,H);if((this.click2Search||I===null)&&!H){this.blockBegin=1;this.fetch();return ;}else{this._notifyContentWidget(I);}}J[B]=K;},_setupCache:function(J){var K=this.searchCache,I=this.rootID;if(K&&(J||!K[I])){K[I]=K[I]||{};var H=this.contentWidget&&this.contentWidget.items||this.rootCacheItems||[];K[I][I]=[H,this.totalSize||0,this.blockBegin||1].concat();}},taskCallId:0,path:mstrConfig.taskURL,method:"POST",serverRequest:function D(H,I){if(mstrApp&&mstrApp.serverRequest){mstrApp.serverRequest(H,I);}else{mstrmojo.xhr.request("POST",this.path,I,H,undefined,this.XServer,this.baseParams);}},fetch:function(){this.rootChanged=false;this.matchCaseChanged=false;if(this.spinnerNode){this.spinnerNode.style.display="block";}if(this.preFetch){this.preFetch();}var H=this,I=F.apply(this,[this.taskId]);I.searchPattern=this.searchPattern;this.onUpdateSearchParams(I);var J={success:function(K){var L=K.items||K.es||[];L=[L,K.totalSize||K.sz||0,K.blockBegin||K.bb];mstrmojo.all[H.id].searchCache[H.rootID][(I.searchPattern.length==0?H.rootID:H.buildIndex(I.searchPattern))]=L;H._notifyContentWidget(L);},failure:function(K){if(H.showTaskError){mstrmojo.alert(mstrmojo.desc(8117,"Data request failed:")+" \n"+K.getResponseHeader("X-MSTR-TaskFailureMsg"));}},complete:function(){if(H.spinnerNode){H.spinnerNode.style.display="none";}if(H.postFetch){H.postFetch();}}};this.serverRequest(I,J);},fetchPage:function(H){this.blockBegin=H*this.blockCount+1;this.fetch();},filterCache:function(J,M,I){var H=M&&M[I?this.rootID:this.buildIndex(J)];if(H){return H;}var K=this.token[this.taskId];if(K.test(J)||this.totalSize>this.blockCount){return null;}var O=J.replace(/.$/,"");H=M&&M[this.buildIndex(O)];while(H===undefined&&(O=O.replace(/.$/,"")).length>0){H=M&&M[this.buildIndex(O)];}if(H!==undefined){if(H[1]>this.blockCount){return null;}var L=H[0],N=[];G.forEach(L,function(P){if(P.n.search(new RegExp(J,this.matchCase?"":"i"))>-1){N.push(P);}});this.totalSize=N.length;return(M[this.buildIndex(J)]=[N,N.length,this.blockBegin].concat());}return null;},buildIndex:function(H){if(H.replace(/^\s|\s$/g,"").length===0){return"";}return !this.matchCase?H.toUpperCase():H+"::0";},init:function(H){if(this._super){this._super(H);}this.qse=mstrApp.useQuickSearch&&mstrApp.useQuickSearch()||0;this.autoSubmit=this.quickSearch&&(mstrApp.searchAutoComplete&&mstrApp.searchAutoComplete()||false);this.searchDelay=mstrApp.searchAutoCompleteDelay&&mstrApp.searchAutoCompleteDelay()||0;this.xhr=new mstrmojo.SimpleXHR();this.searchCache=this.searchCache||{};},clear:function(){this.inputNode.value="";C.removeClass(this.searchNode,["clear"]);}});})();(function(){mstrmojo.requiresCls("mstrmojo.Widget");mstrmojo.WaitIcon=mstrmojo.declare(mstrmojo.Widget,null,{scriptClass:"mstrmojo.WaitIcon",cssFloat:"left",visible:false,markupString:'<div id="{@id}" class="mstrmojo-WaitIcon {@cssClass}" style="float:{@cssFloat};{@cssText};"></div>',markupMethods:{onvisibleChange:function(){this.domNode.style.display=this.visible?"block":"none";}},markupSlots:{}});}());(function(){mstrmojo.requiresCls("mstrmojo.css","mstrmojo.desc","mstrmojo.Widget");var A=mstrmojo.css,B=mstrmojo.dom;mstrmojo.vi.ui.TargetMask=mstrmojo.declare(mstrmojo.Widget,[],{scriptClass:"mstrmojo.vi.ui.TargetMask",markupString:'<div class="mstrmojo-hasTgt" mstrAttach:contextmenu><div class="tgt"><div></div>'+mstrmojo.desc(4787,"Target")+'</div><div class="src"><div></div>'+mstrmojo.desc(4283,"Source")+"</div></div>",useRichTooltip:true,isDynamicTooltip:true,tooltipContent:mstrmojo.desc(15275,"This container cannot be selected as target"),allowFilters:false,init:function D(E){if(this._super){this._super(E);}},setMaskClass:function(H){var F=this.parent,G=F instanceof mstrmojo.vi.ui.rw.VizBox,E=F instanceof mstrmojo.vi.ui.rw.FilterBox;if(this.domNode){if(F.id===H){A.addClass(this.domNode,"sourced");}else{if(!G&&!(E&&this.allowFilters)){A.addClass(this.domNode,"disabled");}else{A.addClass(F.domNode,"targeted");}}this.domNode.style.display="block";return true;}return false;},clearMaskClass:function(){var E=this.parent;A.removeClass(this.domNode,"sourced");A.removeClass(this.domNode,"disabled");A.removeClass(E.domNode,"targeted");this.domNode.style.display="none";},moveTooltip:function C(E,F){this.richTooltip={posType:mstrmojo.tooltip.POS_TOPLEFT,cssClass:"vi-regular vi-tooltip-A tgt-tt",content:this.tooltipContent,top:E.clientY+15,left:E.clientX-15};this._super(E,F);},oncontextmenu:function(F,E){B.preventDefault(E,F);}});}());(function(){mstrmojo.requiresCls("mstrmojo.Widget","mstrmojo._Formattable");mstrmojo.DocRectangle=mstrmojo.declare(mstrmojo.Widget,[mstrmojo._Formattable],{scriptClass:"mstrmojo.DocRectangle",markupString:'<div id="{@id}" k="{@k}" class="mstrmojo-DocRectangle" title="{@tooltip}" style="{@domNodeCssText}"></div>',markupMethods:{onheightChange:function(){if(this.height){this.domNode.style.height=this.height+"px";}},onwidthChange:function(){if(this.width){this.domNode.style.width=this.width+"px";}},onvisibleChange:mstrmojo.Widget.visibleMarkupMethod},formatHandlers:{domNode:["RW","B","background-color","fx"]},preBuildRendering:function B(){var E=this._super(),D=this.defn;if(D.r){this.domNodeCssText+=mstrmojo.css.buildRoundCorners(D.r,D.topc);}return E;},postBuildRendering:function(){var F=this._super();var E=this.fmts;if(E){var D=E.border||E["border-width"],G=D&&(parseInt(D,10)/72*this.model.dpi);if(G){if(E.height==="100%"){this.set("height",this.domNode.clientHeight-2*G);}if(E.width==="100%"){this.set("width",this.domNode.clientWidth-2*G);}}}return F;},update:function C(D){if(this.thresholdId||D.data.tid){delete this.fmts;}this.thresholdId=D.data.tid;this.set("visible",!D.data.hidden);if(this._super){this._super(D);}},getFormats:function A(){var D=this._super(),E="z-index";if(D&&this.defn&&this.defn.fmts&&D[E]!=this.defn.fmts[E]){D[E]=this.defn.fmts[E]||D[E];}return D;}});}());mstrmojo.ToolSeparator=mstrmojo.declare(mstrmojo.Widget,null,{scriptClass:"mstrmojo.ToolSeparator",markupString:'<div class="mstrmojo-ToolSeparator {@cssClass}" style="{@cssText}"></div>',markupSlots:{},markupMethods:{}});(function(){mstrmojo.requiresCls("mstrmojo.Widget","mstrmojo.hash","mstrmojo.css","mstrmojo.string");function A(C,B){return mstrmojo.hash.copy(B,{label:"",tabIndex:"",cssDisplay:"inline",name:null,markupString:'<span id="{@id}" class="'+C+' {@cssClass}" style="{@cssText}" title="{@tooltip}"><input id="{@id}_input"  type="{@type}" name="{@name}" value="{@value}" tabIndex="{@tabIndex}" mstrAttach:click tstid="{@tstid}"/><label for="{@id}_input">{@label}</label></span>',markupSlots:{inputNode:function(){return this.domNode.firstChild;},labelNode:function(){return this.domNode.childNodes[1];}},markupMethods:{onvisibleChange:function(){this.domNode.style.display=(this.visible)?this.cssDisplay:"none";},onenabledChange:function(){this.inputNode.disabled=!this.enabled;mstrmojo.css[this.enabled?"removeClass":"addClass"](this.domNode,"disabled");},onlabelChange:function(){this.labelNode.innerHTML=mstrmojo.string.encodeHtmlString(this.label);},oncheckedChange:function(){this.inputNode.checked=this.checked;}},checked:false,preclick:function(){this.set("checked",this.inputNode.checked);},isChecked:function(){return this.inputNode.checked;}});}mstrmojo.CheckBox=mstrmojo.declare(mstrmojo.Widget,null,A("mstrmojo-CheckBox",{scriptClass:"mstrmojo.CheckBox",type:"checkbox"}));mstrmojo.ImageCheckBox=mstrmojo.declare(mstrmojo.Widget,null,A("mstrmojo-CheckBox mstrmojo-ImageCheckBox",{scriptClass:"mstrmojo.CheckBox",type:"image",cssDisplay:"block",preclick:function(){this.set("checked",!this.checked);},postCreate:function(){this.markupMethods=mstrmojo.hash.copy(this.markupMethods);this.markupMethods.oncheckedChange=function(){mstrmojo.css.toggleClass(this.inputNode,["checked"],this.checked);};},postBuildRendering:function(){this.inputNode.src=this.src||"../images/1ptrans.gif";if(this._super){return this._super();}return true;}}));mstrmojo.RadioButton=mstrmojo.declare(mstrmojo.Widget,null,A("mstrmojo-RadioButton",{scriptClass:"mstrmojo.RadioButton",type:"radio",postBuildRendering:function(){if(mstrmojo.dom.isIE){this.inputNode.checked=this.checked;}}}));}());(function(){mstrmojo.requiresCls("mstrmojo.Widget","mstrmojo.string");var B=mstrmojo.string;mstrmojo.Label=mstrmojo.declare(mstrmojo.Widget,null,{scriptClass:"mstrmojo.Label",allowHTML:false,text:"",title:"",markupString:'<div id="{@id}" class="mstrmojo-Label {@cssClass}" style="{@cssText}" title="{@title} "mstrAttach:click></div>',markupMethods:{ontitleChange:function(){this.domNode.title=this.title;},ontextChange:function(){var C=this.text;C=B.isEmpty(C)?"":C.toString();this.domNode.innerHTML=this.allowHTML?C:B.encodeHtmlString(B.decodeHtmlString(C),true);},oncssTextChange:mstrmojo.Widget.cssTextMarkupMethod,onvisibleChange:mstrmojo.Widget.visibleMarkupMethod,onenabledChange:mstrmojo.Widget.enabledMarkupMethod},autoHide:false,_set_text:function A(E,C){if(this.autoHide){this.set("visible",(C!==null)&&(C!=="")&&(C!==undefined));}var D=this.text;this.text=C;return(D!==C);}});}());(function(){mstrmojo.requiresCls("mstrmojo.Widget","mstrmojo._IsExprNode","mstrmojo.fe._IsRelationTreeNode","mstrmojo._HasEditableText","mstrmojo.css","mstrmojo.string","mstrmojo.dom");var C=mstrmojo.css,A=mstrmojo.dom,F=mstrmojo.string,E=function(H){this._super&&this._super(H);A.stopPropogation(H.hWin,H.e);},G=mstrmojo.fe._IsRelationTreeNode.createSetHtml;mstrmojo.fe.DynamicNode=mstrmojo.declare(mstrmojo.Widget,[mstrmojo._IsExprNode,mstrmojo.fe._IsRelationTreeNode,mstrmojo._HasEditableText],{scriptClass:"mstrmojo.fe.DynamicNode",markupString:'<div id="{@id}" class="mstrmojo-dynamic {@cssClass}"  style="position:relative;{@cssText}" mstrAttach:mousedown><div class="mstrmojo-onhoverparent mstrmojo-dynamic-prefix {@cssClass}"><span class="mstrmojo-textset mstrmojo-dynamic-prefix-text"  mstrAttach:click></span><span class="mstrmojo-onhover-in mstrmojo-andor-tools {@cssClass}">'+G+'<span class="mstrmojo-indent" onclick="mstrmojo.all[\'{@id}\'].ind()">'+mstrmojo.desc(5895,"Group conditions")+'</span><span class="mstrmojo-outdent" onclick="mstrmojo.all[\'{@id}\'].out()">'+mstrmojo.desc(5896,"Ungroup Conditions")+'</span></span></div><div class="mstrmojo-onhoverparent mstrmojo-dynamicNode" title="'+mstrmojo.desc(13229,"Add this condition to the target list of a selector.")+'"><span class="mstrmojo-dynamicNode-info"><span class="mstrmojo-textset"></span></span><span class="mstrmojo-onhover-bl mstrmojo-abs mstrmojo-topright mstrmojo-cond-tools {@cssClass}"><img class="mstrmojo-del" src="../images/1ptrans.gif" title="'+mstrmojo.desc(7931,"Delete condition")+'" onclick="mstrmojo.all[\'{@id}\'].del()" ></img></span><span class="mstrmojo-textset mstrmojo-rename-text" mstrAttach:click >'+mstrmojo.desc(1388,"Rename")+"</span>"+G+"</div></div>",markupSlots:{prefixHoverNode:function(){return this.domNode.firstChild;},prefixNode:function(){return this.domNode.firstChild.firstChild;},dynamicNode:function(){return this.domNode.lastChild;},textNode:function(){return this.domNode.lastChild.firstChild.lastChild;},createSetOptNode:function(){return this.domNode.firstChild.childNodes[1].firstChild;},createSetNode:function(){return this.domNode.lastChild.lastChild;},renameNode:function(){return this.domNode.lastChild.childNodes[2];}},markupMethods:{onprefixedAndOrEditableChange:function(){C.toggleClass(this.prefixNode,["editable"],this.prefixedAndOrEditable);},onselectedChange:function(){C.toggleClass(this.dynamicNode,["selected"],this.selected);},onisEditingChange:function(){C.toggleClass(this.domNode,["renaming"],this.isEditing);},ondataChange:function(){this.prefixNode.innerHTML=this.andOrTxt();this.textNode.innerHTML=this.data.ph.n;},onglowChange:function(){var H=this;C.toggleClass(H.dynamicNode,["glow"],this.glow);if(this.glow){setTimeout(function(){C.toggleClass(H.dynamicNode,["glow"],false);H.glow=false;},1000);}},onnoRelationOperatorChange:function(){C.toggleClass(this.prefixHoverNode,["noRelation"],this.noRelationOperator);},onnoRelationChange:function(){C.toggleClass(this.dynamicNode,["noRelation"],this.noRelation);}},editableSlot:"textNode",editButtonSlot:"renameNode",init:function(H){var J=H.data;if(J){var I=H.tree.nameFactory;if(J.ph.n){I.setName(J.ph.n,this);}else{J.ph.n=I.getNewName(this,mstrmojo.desc(12033,"Dynamic Condition")+" ");}}this._super(H);},_set_data:function(K,H){var I=this.data,J=(I!==H);if(J){this.data=H;this.text=H.ph.n;}return J;},preclick:function D(H){var J=null,I=A.eventTarget(H.hWin,H.e);if(A.contains(this.prefixNode,I,true)){J="andor";}else{if(A.contains(this.createSetOptNode,I,true)&&!this.noRelationOperator&&!this.noRelation){J="createSetOpt";}else{if(A.contains(this.createSetNode,I,true)&&!this.noRelation){J="createSet";}else{if(A.contains(this.renameNode,I,true)){this.set("isEditing",true);}}}}H.part=J;},isEmpty:function(){var I=this.data,H=I&&I.ph;return !(H&&H.n);},del:function B(){var I=this.parent,H=this.tree.nameFactory;if(I&&I.remove&&this.data){I.remove(this.data);H.removeName(this.data.ph.n);}},onkeyup:E,onkeydown:E,onTextEditComplete:function(){var J=this.tree,K=J.nameFactory,H=F.trim(this.text||""),I=this.data.ph.n;if(H&&H!==I){if(K.isNameExist(H)){K.names[H].set("glow",true);this.set("isEditing",true);}else{K.changeName(I,H,this);this.data.ph.n=H;}}},isSelectableArea:function(H){return mstrmojo.dom.contains(this.dynamicNode,H,true);},avatarCssCls:"mstrmojo-FE mstrmojo-dynamicNode",getAvatarNode:function(){return this.dynamicNode.cloneNode(true);}});})();(function(){mstrmojo.requiresCls("mstrmojo.array","mstrmojo.css","mstrmojo.string","mstrmojo.dom");var F=mstrmojo.array,C=mstrmojo.css,G=mstrmojo.string,B=mstrmojo.dom,A="unselected",D="block";function H(L){var K=mstrApp.getConfiguration();if(L===decodeURI(L)){L=encodeURI(L);}if(K&&L&&L.indexOf("://")===-1){L=K.getHostUrlByProject(mstrApp.getCurrentProjectId())+L;}return(mstrApp.useBinaryFormat)?String(mstrMobileApp.getImage(L)):L;}mstrmojo.ImageToggle=mstrmojo.declare(mstrmojo.Widget,null,{scriptClass:"mstrmojo.ImageToggle",unset:null,useAnimation:true,markupString:'<div class="mstrmojo-ImageToggle {@cssClass}" style="{@cssText}" tabindex="{@tabIndex}"  mstrAttach:click,blur,keydown ></div>',tabIndex:0,markupMethods:{onimageListChange:function(){var P=this.imageList&&this.imageList.slice(),M=this,N=this.unset,L,O,K;if(!G.isEmpty(N)&&P){P.push({n:N,v:N,_ust:true});}if(this.domNode&&P){M.domNode.innerHTML="";M.domNode.style.minHeight=Math.min(20,M.height)+"px";M.domNode.style.minWidth=Math.min(20,M.width)+"px";M._loadedImgs=P.length;mstrmojo.array.forEach(P,function(R,Q){O=document.createElement("div");O.style.cssText="display:none;font-size:0px !important;line-height:"+Math.min(30,M.height)+"px !important;";K=document.createElement("img");K.alt=K.title=R.v;K.style.verticalAlign="middle";K.style.maxHeight=M.height+"px";K.style.maxWidth=(M.width-1)+"px";if(!mstrmojo.dom.isIE){K.onerror=function(){this.src="../images/image_not_found.jpg";};}O.appendChild(K);M.domNode.appendChild(O);K.src=(R.n&&H(R.n))||"../images/image_not_found.jpg";if(R._ust){M.ustImgIdx=Q;}M._imgs[Q]=O;});this._setSelectedValue();}},onvalueChange:function(){this._setSelectedValue();}},imageList:null,value:null,selectedIndex:-1,preBuildRendering:function E(){if(this._super){this._super();}this._imgs=[];},_setSelectedValue:function I(){var M=this,L=this.selectedIndex,O=this.imageList;if(O){if(O[L]){M._imgs[L].style.display="none";}F.forEach(this.imageList,function(P,Q){if(P.v==M.value){C.removeClass(M.domNode,A);M.selectedIndex=Q;M._imgs[Q].style.display=D;return ;}});if(this.selectedIndex===-1){if(!this.unset){C.addClass(this.domNode,A);}else{var N=this._imgs[this.ustImgIdx],K=N.lastChild;K.alt=K.title=this.value;N.style.display=D;}}}},onclick:function J(){var M=this.imageList,N=M&&M.length,O=300,V=this.selectedIndex,L=V,K=this.domNode,S,R,Q,U,P=this;Q=(V===-1&&this.ustImgIdx!==null)?this._imgs[this.ustImgIdx]:this._imgs[V];V=(V+1)%N;U=this._imgs[V];C.removeClass(K,A);this.selectedIndex=V;if(this.useAnimation){R=new mstrmojo.fx.FadeIn({duration:O,interval:(B.isIE8?(O/3):(O/10)),target:U,preStart:function(){this.target.style.display=D;}});S=new mstrmojo.fx.FadeOut({duration:O,interval:(B.isIE8?(O/3):(O/10)),target:Q,onEnd:function(){Q.style.display="none";if(L===-1){P._imgs.splice(P.ustImgIdx,1);K.removeChild(Q);delete P.ustImgIdx;}R.play();}});if(Q){S.play();}else{R.play();}}else{if(Q){Q.style.display="none";if(L===-1){P._imgs.splice(P.ustImgIdx,1);K.removeChild(Q);delete P.ustImgIdx;}}U.style.display=D;}this.value=this.imageList[V].v;},onkeydown:function(L){var K=L.hWin,M=L.e||K.event;if(M.keyCode===mstrmojo.Enum_Keys.SPACE){mstrmojo.dom.preventDefault(K,M);this.onclick();}}});}());(function(){mstrmojo.requiresCls("mstrmojo.Widget");var C=mstrmojo.css,A="selected";mstrmojo.ButtonSwitch=mstrmojo.declare(mstrmojo.Widget,null,{scriptClass:"mstrmojo.ButtonSwitch",markupString:'<div id="{@id}" class="mstrmojo-ButtonSwitch {@cssClass}" style="{@cssText}" mstrAttach:click><div class="left selected" > {@label1} </div><div class="right"> {@label2} </div></div>',markupSlots:{left:function(){return this.domNode.children[0];},right:function(){return this.domNode.children[1];}},switchFn:mstrmojo.emptyFn,onselectedChange:function(){var D;for(D=0;D<2;D++){C.toggleClass(this.domNode.children[D],A,this.selected===D);}this.switchFn();},onclick:function B(D){this.set("selected",(D.getTarget()===this.left)?0:1);}});}());(function(){mstrmojo.requiresCls("mstrmojo.Widget","mstrmojo._Formattable");mstrmojo.DocHTMLContainer=mstrmojo.declare(mstrmojo.Widget,[mstrmojo._Formattable],{scriptClass:"mstrmojo.DocHTMLContainer",scrolling:"auto",markupString:'<iframe id="{@id}" k="{@k}" class="mstrmojo-DocHTMLContainer" title="{@tooltip}" style="{@domNodeCssText}" src="{@v}" scrolling="{@scrolling}"></iframe>',formatHandlers:{domNode:["RW","B","F","background-color","text-align","white-space","fx"]},markupMethods:{onvisibleChange:mstrmojo.Widget.visibleMarkupMethod},update:function A(B){this.v=B.data.v;if(mstrApp&&mstrApp.isTouchApp()){this.scrolling="no";}if(this.thresholdId||B.data.tid){delete this.fmts;}this.thresholdId=B.data.tid;this.set("visible",!B.data.hidden);}});}());(function(){mstrmojo.requiresCls("mstrmojo.Widget","mstrmojo._Formattable");mstrmojo.DocRoundRectangle=mstrmojo.declare(mstrmojo.Widget,[mstrmojo._Formattable],{scriptClass:"mstrmojo.DocRoundRectangle",markupString:'<div id="{@id}" k="{@k}" class="mstrmojo-DocRoundRectangle" title="{@tooltip}" style="{@domNodeCssText}"><div class="mstrmojo-DocRoundRectangle-l1" style="{@tCornersCssText}{@tCornersCssGradText}"></div><div class="mstrmojo-DocRoundRectangle-l2" style="{@tCornersCssText}{@tCornersCssGradText}"></div><div class="mstrmojo-DocRoundRectangle-l3" style="{@tCornersCssText}{@tCornersCssGradText}"></div><div style="{@rectNodeCssText}{@rectNodeGradCssText}"></div><div class="mstrmojo-DocRoundRectangle-l3" style="{@bCornersCssText}{@bCornersCssGradText}"></div><div class="mstrmojo-DocRoundRectangle-l2" style="{@bCornersCssText}{@bCornersCssGradText}"></div><div class="mstrmojo-DocRoundRectangle-l1" style="{@bCornersCssText}{@bCornersCssGradText}"></div></div>',markupSlots:{rectNode:function(){return this.domNode.childNodes[3];}},markupMethods:{onvisibleChange:mstrmojo.Widget.visibleMarkupMethod},formatHandlers:{domNode:["top","left","width","z-index","fx"],rectNode:["height","background-color"],tCorners:["background-color"],bCorners:["background-color"]},update:function C(D){if(this.thresholdId||D.data.tid){delete this.fmts;}this.thresholdId=D.data.tid;this.set("visible",!D.data.hidden);},preBuildRendering:function B(){var F=this._super();var G=this.getFormats(),D=!!this.defn.topc,I=D?4:8,H="(\\d*px)",E=Math.max(parseInt(G.height,10)-I,0);if(G.height==="100%"){H="(100%)";E=this.parent.getHeight()-I;}this.rectNodeCssText=this.rectNodeCssText.replace(new RegExp("(.*height:)"+H+"(.*)"),"$1"+E+"px$3");if(D){this.bCornersCssText="display:none;";}return F;},formatGradient:function A(E,H){var F=mstrmojo.css.buildGradient(E.t,E.sc,E.ec);if(!F){return ;}var D=F.n+":"+F.v+";",G="background-color:";this.rectNodeGradCssText=D;if(E.t===0){this.tCornersCssGradText=G+E.sc+";";this.bCornersCssGradText=G+E.ec+";";}else{this.tCornersCssGradText=this.bCornersCssGradText=D;}}});}());(function(){mstrmojo.requiresCls("mstrmojo.css","mstrmojo.Widget");var A=mstrmojo.css;mstrmojo.TabButton=mstrmojo.declare(mstrmojo.Widget,null,{scriptClass:"mstrmojo.TabButton",markupString:'<span id="{@id}" class="mstrmojo-TabButton {@cssClass}" style="{@cssText}" mstrAttach:click></span>',markupMethods:{onvisibleChange:function(){this.domNode.style.display=this.visible?"inline":"none";},ontitleChange:function(){this.domNode.innerHTML=this.title||"";},onbackgroundColorChange:function(){this.domNode.style.backgroundColor=this.backgroundColor||"";},onselectedChange:function(){A.toggleClass(this.domNode,["selected"],!!this.selected);}}});})();(function(){mstrmojo.requiresCls("mstrmojo.Widget","mstrmojo.hash");function A(H,E,G,F){var D=mstrmojo.hash.copy(F,{props:{left:{isStyle:true,start:H,stop:E,suffix:"px",ease:mstrmojo.ease.linear}},duration:G});(new mstrmojo.fx.AnimateProp(D)).play();}function B(K,N,G,L){var I=K.domNode,M=I.offsetWidth,D=K.scrollableIncFetch;var E=K.hasAnimation&&(!(/Firefox[\/\s](\d+\.\d+)/.test(navigator.userAgent))||Number(RegExp.$1)>3.5),J=L?1:-1,F=parseInt(M,10)*J,H=E?500:0;A(0,-F,H,{target:G,duration:H,preStart:function(){this.target.style.overflowY="hidden";},onEnd:function(){this.target.style.display="none";}});A(F,0,H,{target:N,preStart:function(){this.target.style.display="block";this.target.style.overflowY=(D?"visible":"auto");}});if(K.waiting){A(0,-F,H,{widget:K,slot:"loaderNode",onEnd:function(){this.widget.waiting=false;}});}}var C=function(D){var E=D.currentPage;if(E===D.p1Node){E=D.p2Node;}else{E=D.p1Node;}D.currentPage=E;};mstrmojo.Booklet=mstrmojo.declare(mstrmojo.Widget,null,{scriptClass:"mstrmojo.Booklet",pageClass:"mstrmojo-BookletPage",markupString:'<div id="{@id}" class="mstrmojo-Booklet {@cssClass}" style="{@cssText}"><div id="{@id}_p1" class="mstrmojo-BookletPage" ></div><div id="{@id}_p2" class="mstrmojo-BookletPage" style="left:-100%;"></div><div id="{@id}_ldr" class="mstrmojo-BookletLoader" ></div></div>',markupSlots:{containerNode:function(){return this.domNode;},p1Node:function(){return this.domNode.firstChild;},p2Node:function(){return this.domNode.childNodes[1];},loaderNode:function(){return this.domNode.childNodes[2];}},markupMethods:{onnextChange:function(){var G=this.next;if(!G){return ;}var D=this.currentPage,F=this.p1Node,E=this.currentPage=(D==F)?this.p2Node:F;if(!(G instanceof mstrmojo.Obj)){G=this.next=mstrmojo.insert(G);}if(!G.hasRendered){G.placeholder=E.appendChild(document.createElement("span"));G.render();}else{if(E.firstChild){E.replaceChild(G.domNode,E.firstChild);}else{E.appendChild(G.domNode);}}this.set("waiting",false);if(E&&D){B(this,E,D,this.turnDirFwd);}else{if(this.scrollableIncFetch){E.style.overflowY="visible";}}},onwaitingChange:function(D){this.loaderNode.style.left=(this.waiting)?0:"-100%";},onheightChange:function(D){if(this.height){this.domNode.style.height=this.height;}},onwidthChange:function(D){if(this.width){this.domNode.style.width=this.width;}}},enabled:true,waiting:false,next:null,currentPage:null,turnDirFwd:true,hasAnimation:true,scrollableIncFetch:false,FORWARD:true,REVERSE:false,turnFwd:function(D){this.turn(D,this.FORWARD);},turnBack:function(D){this.turn(D,this.REVERSE);},turn:function(D,E){this.set("turnDirFwd",E);this.set("next",D);}});})();(function(){mstrmojo.requiresCls("mstrmojo.expr","mstrmojo.css","mstrmojo._IsExprNode","mstrmojo._HasPopup","mstrmojo.Widget","mstrmojo.fe.FilterUtils");var I=mstrmojo.dom,A=mstrmojo.css,E=mstrmojo.fe.FilterUtils,D=E.getExprConditionNodeHtml,B=E.getExprNodeHtmlAndText;function C(J){var K=J.data;return D(K);}mstrmojo.ConditionNode=mstrmojo.declare(mstrmojo.Widget,[mstrmojo._IsExprNode,mstrmojo._HasPopup],{scriptClass:"mstrmojo.ConditionNode",data:null,editable:false,prefixedAndOrEditable:false,markupString:'<div id="{@id}" class="mstrmojo-cond mstrmojo-ConditionNode {@cssClass}" mstrAttach:mousedown><div class="mstrmojo-onhoverparent mstrmojo-cond-prefix {@cssClass}"><span class="mstrmojo-textset mstrmojo-cond-prefix-text" mstrAttach:click></span><span class="mstrmojo-onhover-in mstrmojo-andor-tools {@cssClass}">{@_prefixAndOrToolsMarkup}</span></div><div class="mstrmojo-onhoverparent mstrmojo-cond-contents {@cssClass}"><span class="mstrmojo-textset mstrmojo-cond-text {@cssClass}" mstrAttach:click></span><span class="mstrmojo-cond-text-postfix {@cssClass}"></span><span class="mstrmojo-rel mstrmojo-cond-popupNode {@cssClass}"></span><span class="mstrmojo-onhover-bl mstrmojo-abs mstrmojo-topright mstrmojo-cond-tools {@cssClass}"><img class="mstrmojo-del" src="../images/1ptrans.gif" tooltip="'+mstrmojo.desc(7931,"Delete condition")+'" onclick="mstrmojo.all[\'{@id}\'].del()" /></span></div></div>',markupSlots:{prefixHoverNode:function(){return this.domNode.firstChild;},prefixNode:function(){return this.domNode.firstChild.firstChild;},prefixAndOrToolsNode:function(){return this.domNode.firstChild.childNodes[1];},condNode:function(){return this.domNode.childNodes[1];},textNode:function(){return this.domNode.childNodes[1].firstChild;},textPostfixNode:function(){return this.domNode.childNodes[1].childNodes[1];},popupNode:function(){return this.domNode.childNodes[1].childNodes[2];}},markupMethods:{onprefixedAndOrEditableChange:function(){A.toggleClass(this.prefixNode,["editable"],this.prefixedAndOrEditable);},oneditableChange:function(){A.toggleClass(this.textNode,["editable"],this.editable);},onselectedChange:function(){A.toggleClass(this.condNode,["selected"],this.selected);},ondataChange:function(){this.prefixNode.innerHTML=this.andOrTxt();var J=B(this.data);this.textNode.innerHTML=J.html;this.textNode.title=J.text;this.textPostfixNode.innerHTML=this.getConditionTextPostfix();}},betweenText:mstrmojo.desc(308,"and"),atText:mstrmojo.desc(5923,"at"),emptyText:mstrmojo.desc(7930,"Empty condition"),init:function H(J){this._super(J);this.markupString=this.markupString.replace("{@_prefixAndOrToolsMarkup}",this.getPrefixAndOrToolsMarkup());},getConditionTextPostfix:function(){return"";},del:function G(){var J=this.parent;if(J&&J.remove&&this.data){J.remove(this.data);}},isEmpty:function(){var K=this.data,J=K&&K.et,L=J&&mstrmojo.expr.ET2TGT[J];return !(L&&K[L]);},isSelectableArea:function(J){return I.contains(this.condNode,J,true);},preclick:function F(J){var L=null,K=I.eventTarget(J.hWin,J.e);if(I.contains(this.prefixNode,K,true)){L="andor";}else{if(I.contains(this.textNode,K,true)){L="condition";}else{if(I.contains(this.textPostfixNode,K,true)){I.stopPropogation(J.hWin,J.e);return false;}}}J.part=L;}});mstrmojo.ConditionNode.getFunctionNode=C;})();(function(){mstrmojo.requiresCls("mstrmojo.boxmodel","mstrmojo.array","mstrmojo.hash","mstrmojo.dom","mstrmojo.css","mstrmojo.Widget","mstrmojo.Arr","mstrmojo._HasLayout","mstrmojo._ListBase2Selections","mstrmojo.ListSelector","mstrmojo._TouchScrolling","mstrmojo._PagingList");var b=mstrmojo.hash,g=mstrmojo.array,f=mstrmojo.boxmodel,d=mstrmojo.dom;function A(k,m,j){var l=k.listSelector;if(l){l[m](k,k.itemsContainerNode,j);}}function L(k,j){var l=k.lastPagePos;if(!l||l.dragId!==j){l=f.offset(k.itemsContainerNode);l.dragId=j;k.lastPagePos=l;var m=k.scrollboxNode;k.lastScrollPos={left:m.scrollLeft,top:m.scrollTop,width:m.clientWidth,height:m.clientHeight};}}function O(m,p,k){var l=p&&p.node;if(l===m.dropCueNode||l===m.dropCueNode.firstChild){return m.dropCuePos;}var n=m.listMapper;var j=n&&n.whereDrop(m,m.itemsContainerNode,l,p.pos,{left:m.lastPagePos.left-m.lastScrollPos.left,top:m.lastPagePos.top-m.lastScrollPos.top,width:m.lastScrollPos.width,height:m.lastScrollPos.height});var o=m.dropCuePos;return((k!==false)&&o&&j&&(o.idx===j.idx)&&(o.left===j.left)&&(o.top===j.top))?o:j;}var h="attachEventListener";function D(k,j){if(k.makeObservable){j=j||[];if(!j[h]){mstrmojo.hash.make(j,k.itemsScriptClass||mstrmojo.Arr);}}return j;}function H(k,j){if(j&&j[h]){k._sub_its=j;k._sub_add=j[h]("add",k.id,"preadd");k._sub_rmv=j[h]("remove",k.id,"preremove");}}function G(j){if(j._sub_its){var k=mstrmojo.publisher;k.unsubscribe(j._sub_add);k.unsubscribe(j._sub_rmv);delete j._sub_add;delete j._sub_rmv;delete j._sub_its;}}mstrmojo.ListBase2=mstrmojo.declare(mstrmojo.Widget,[mstrmojo._ListBase2Selections,mstrmojo._TouchScrolling,mstrmojo._PagingList,mstrmojo._HasLayout],{scriptClass:"mstrmojo.ListBase2",items:null,markupString:'<div id="{@id}" class="mstrmojo-ListBase2 {@cssClass}" style="position:relative;{@cssText}" mstrAttach:keyup,keypress,mousedown,mouseup,dblclick><div class="mstrmojo-ListBase2-itemsContainer" style="position:relative;{@itemsContainerCssText}">{@itemsHtml}</div><div class="mstrmojo-ListBase2-dropCue {@cssClass}"><div class="mstrmojo-ListBase2-dropCue-inner"></div></div></div>',markupSlots:{scrollboxNode:function(){return this.domNode;},itemsContainerNode:function(){return this.domNode.firstChild;},dropCueNode:function(){return this.domNode.lastChild;}},markupMethods:{onvisibleChange:function(){this.domNode.style.display=this.visible?this.cssDisplay:"none";},ondropCuePosChange:function(){var k=this.dropCueNode,j=k&&k.style;if(!j){return ;}var m=this.dropCuePos,l=!!m;if(l){j.left=m.left+"px";j.top=m.top+"px";}j.display=l?"block":"none";},onpageChange:function(){if(this.usePaging&&!this._inScroll){this._inPaging=true;this.listMapper.toPage(this,this.page);this._inPaging=false;}},onwidthChange:function(){if(!isNaN(parseInt(this.width))){this.domNode.style.width=this.width;}},onheightChange:function(){if(!isNaN(parseInt(this.height))){this.domNode.style.height=this.height;}}},autoHide:false,renderOnScroll:false,firstRenderBlockSize:50,renderBlockSize:50,listMapper:null,listBuilder:null,listSelector:mstrmojo.ListSelector,animate:false,itemsEffect:null,containerResizable:true,init:function a(m){this._super(m);this.items=this.initItems(this.items);var l=this.selectedIndices,j=this.selectedIndicesList,k=this.selectedIndex,n=this.selectedItem;this.selectedIndices={};this.selectedIndex=-1;delete this.selectedIndicesList;delete this.selectedItem;if(l||j||(k>-1)||n){this.initSelections(l,j,k,n);}if(this.postInitItems){this.postInitItems();}},initItems:function I(j){return D(this,j);},preBuildRendering:function X(){var n=this.listBuilder,q=n.newContext(this);this.ctxtBuilder=q;var k=this.markupSlots,m=!!(this.renderOnScroll&&this.renderBlockSize&&k&&k.scrollboxNode),l=this.items,j=(l&&l.length)||0,o=m?this.firstRenderBlockSize:j,p=m?this.firstRenderBlockSize:0;this._eros=m;this.paused=false;this.itemsHtml=this.listMapper.buildItemWrappers(l,n,this,q,o,p).join("");this.itemsContainerCssText="visibility: hidden";if(this._super){this._super();}},postBuildRendering:function E(){delete this.itemsHtml;var o=this.listMapper;if(o&&o.postBuildRendering){o.postBuildRendering(this.itemsContainerNode,this.items,this.listBuilder,this,this.ctxtBuilder);}H(this,this.items);if(this._eros||this.usePaging){if(!this._cb_scroll){var q=this.id;this._cb_scroll=function(){var n=mstrmojo.all[q];n.onscroll();};}mstrmojo.dom.attachEvent(this.scrollboxNode,"scroll",this._cb_scroll);this.onscroll();}if(this.animate){for(var l=0,k=["itemsEffect","scrollEffect"],j=k.length;l<j;l++){var p=k[l],m=this[p];if(m&&m.constructor===Object){m=mstrmojo.insert(mstrmojo.hash.clone(m));m.widget=this;this[p]=m;}}if(this.itemsEffect){this.itemsEffect.play();}}this.itemsContainerNode.style.visibility="inherit";if(this.containerResizable&&this.itemsContainerNode.scrollWidth<this.domNode.scrollWidth){this.itemsContainerNode.style.width=this.domNode.scrollWidth+"px";}if(this._super){this._super();}},unrender:function Y(m){G(this);if(this._eros){mstrmojo.dom.detachEvent(this.scrollboxNode,"scroll",this._cb_scroll);delete this._cb_scroll;}for(var k=0,l=["itemsEffect","scrollEffect"],j=l.length;k<j;k++){var n=this[l[k]];if(n&&n.isPlaying){n.cancel();}}this._super(m);},pauseScrollRendering:function P(l,j,k){if(l!==false){l=true;}if(this.paused===!!l){return ;}this.paused=!!l;if(l){if(this._fillTmr){window.clearTimeout(this._fillTmr);delete this._fillTmr;}}else{this.fill(j,k);}},onscroll:function K(){if(this.paused){return ;}if(this._eros){if(!this._fillTmr){var j=this;this._fillTmr=self.setTimeout(function(){j.fill();j=null;},50);}}if(this._super){this._super();}},fill:function c(j,n){if(this._fillTmr){window.clearTimeout(this._fillTmr);delete this._fillTmr;}var o=(this.items&&this.items.length)||0;if(!o){if(n){n();}}else{var l=this.scrollboxNode,p=this.itemsContainerNode,m=mstrmojo.boxmodel.offset(p,l),r=this.listMapper,q=r.findScrollRange(p,o,(this.usesTouches&&this.pos&&parseInt(this.pos.y,10))||l.scrollTop,l.clientHeight,(this.usesTouches&&this.pos&&parseInt(this.pos.x,10))||l.scrollLeft,l.clientWidth,m.left,m.top);if(this.fillAt(q.start,q.end)){if(j){j();}var k=this.id;this._fillTmr=window.setTimeout(function(){mstrmojo.all[k].fill(j,n);},100);}else{if(n){n();}}}},fillAt:function M(l,k){var j=this.listMapper;if(j){return j.fillItemWrappers(this.itemsContainerNode,this.items,this.listBuilder,this,this.ctxtBuilder,l,k,this.renderBlockSize);}else{return false;}},add:function R(k,j){if(!k||!k.length){return -1;}var l=this.items;if(j==null){j=b.min(this.selectedIndices,false,true);if(j!==null&&j!==undefined){j++;}}if(j==null||j===-1){j=(l&&l.length)||0;}if(l&&l.add){l.add(k,j);}else{this.set("items",l?g.insert(l.concat(),j,k):k);}return j;},preadd:function B(l){if(this.hasRendered){var o=this.listMapper;if(o){o.onadd(this,this.itemsContainerNode,this.ctxtBuilder,l);}var n=this.listBuilder;if(n){n.onadd(this,this.ctxtBuilder,l);}var k=this.listSelector;if(k){k.onadd(this,l);}if(this._eros){this.onscroll();}else{var m=l.index,j=l.value.length;this.fillAt(m,m+j-1);}}if(this.onadd){this.onadd(l);}if(this._super){this._super(l);}},remove:function V(j){if(j==null){return -1;}if(j.constructor!==Array){return this._remove(j);}var l=this.items;if(l){var k;if(l.remove){for(k=j.length-1;k>-1;k--){l.remove(j[k],1);}}else{l=l.concat();for(k=j.length-1;k>-1;k--){l.splice(j[k],1);}this.set("items",l);}return j[0];}return -1;},_remove:function V(l){var k=this.items;if(!k||(l==null)){return -1;}var j;if(!isNaN(l)){j=l;}else{j=this.itemIndex(l);}if(j>-1){if(k.remove){k.remove(j,1);}else{k=k.concat();k.splice(j,1);this.set("items",k);}}return j;},duplicate:function Z(o,k,l){var m=this.items,j=-1;if(!m||(o==null)){return -1;}if(!isNaN(o)){if(k===null||k===undefined){k=o+1;}o=m[o];}else{if(k===null||k===undefined){k=this.itemIndex(o)+1;}}if(o){var n;n=b.copy(l,b.clone(o));j=this.add([n],k);}return j;},preremove:function N(k){if(this.hasRendered){var m=this.listMapper;if(m){m.onremove(this,this.itemsContainerNode,this.ctxtBuilder,k);}var l=this.listBuilder;if(l){l.onremove(this,this.ctxtBuilder,k);}var j=this.listSelector;if(j){j.onremove(this,k);}if(this._eros){this.onscroll();}}if(this.onremove){this.onremove(k);}if(this._super){this._super(k);}},move:function S(m,r){function p(u,t){return r>=u&&r<=u+t;}var q=(this.items&&this.items.length)||0;if(r===-1||r==null||isNaN(r)){r=q;}else{r=Math.min(r,q);}var l,j,o,n;if(m.constructor===Array){j=m;o=m;n=(j&&j.length)||0;if(p(m[0],m.length)){return false;}l=g.get(this.items,m);}else{if(typeof (m)==="object"){l=[m];n=1;j=this.itemIndex(l[0]);o=[j];if(p(j,1)){return false;}}else{j=m;o=[m];n=1;if(p(j,1)){return false;}l=[this.items[j]];}}for(var k=0;k<n;k++){if(o[k]<=r){r--;}}if(l[0]!=null){this.remove(j);this.add(l,r);}return true;},itemIndex:function F(j){if(j==null){return -1;}var k=this.itemIdField;return k?g.find(this.items,k,j[k]):g.indexOf(this.items,j);},prechange:function U(l){if(this.hasRendered){var k=[this.listBuilder,this.listMapper];for(var m=0,j=k.length;m<j;m++){var n=k[m];if(n&&n.onchange){n.onchange(this,this.itemsContainerNode,this.ctxtBuilder,l);}}}},makeObservable:false,_set_items:function J(p,j){var o=this.items;j=this.initItems(j);this.items=j;if(o!==j){var m=this,l=function(){if(m.autoHide){m.set("visible",!!(j&&j.length));}m=null;},k=this.hasRendered;if(k){this.refresh(l);}else{l();}}return o!==j;},premousedown:function e(j){A(this,"premousedown",j);},premouseup:function Q(j){A(this,"premouseup",j);},scrollTo:function W(k){var j,l=this.listMapper;if(l&&l.toItem){if(!isNaN(k)){j=k;}else{j=this.itemIndex(k);}if(j>=0){l.toItem(this,j);}}},draggable:false,getDragData:function(n){L(this,n.id);var l=O(this,n.src),k=l&&l.idxActual;if((k>-1)&&this.selectedIndices[k]){var m=this.sortSelectedIndices(),j=g.get(this.items,m)||[];switch(j.length){case 1:return b.copy({html:j[0][this.itemDisplayField],index:m[0]},b.copy(j[0]));case 0:return null;default:return b.copy({html:j.length+" selections",indices:m},j);}}},dropZone:false,ondragenter:function(j){L(this,j.id);this.set("dropCuePos",O(this,j.tgt));},ondragover:function(j){this.set("dropCuePos",O(this,j.tgt));},ondragleave:function(j){this.set("dropCuePos",null);},isDragValid:function C(j){return j&&j.src&&j.src.data;},ondragstart:function(j){if(!(j&&j.src&&j.src.data)){return false;}},allowCopy:false,ondragend:function(m){var k=m&&m.tgt,j=k&&k.widget;if(j===this){}else{if(this.tree&&j&&j.tree===this.tree){if(!this.allowCopy||!d.ctrlKey(k.hWin,k.e)){var l=m.src&&m.src.data;if(l&&(l.indices||(l.index!==null))){this.remove(l.indices||l.index);}}}}},ondrop:function(r){var v=r&&r.src,q=v&&v.data;if(q){var l=O(this,r.tgt,false),t=l&&l.idx,m=(q&&q.constructor===Array),k=this.sortSelectedIndices();var o=this.items;t=Math.min(t,o&&o.length)||0;var u=true;if(v.widget===this){u=this.move(k,t);g.forEach(k,function(w){if(w<=t){t--;}});}else{this.add(m?q:[q],t);}if(u){var p=m?q.length:1,j={};for(var n=0;n<p;n++){j[t+n]=true;}this.set("selectedIndices",j);}}this.set("dropCuePos",null);}});})();(function(){mstrmojo.requiresCls("mstrmojo.publisher","mstrmojo.Widget","mstrmojo.array","mstrmojo._HasChildren");var G=mstrmojo.array;function E(P){if(!this.shouldPropagateEnabled){return ;}var O=this._disabledChildren;G.forEach(P,function(Q){if(Q.enabled){O.push(Q.id);Q.set("enabled",false);}});}function J(){G.forEach(this._disabledChildren,function(O){var P=mstrmojo.all[O];if(P&&P.parent===this){P.set("enabled",true);}},this);this._disabledChildren=[];}mstrmojo.Container=mstrmojo.declare(mstrmojo.Widget,[mstrmojo._HasChildren],{scriptClass:"mstrmojo.Container",defaultChildSlot:"containerNode",containerNode:null,preserveChildDomOrder:true,shouldPropagateEnabled:false,init:function M(P){this._super(P);this._disabledChildren=[];this.attachEventListener("addChild",this.id,function(Q){if(this.shouldPropagateEnabled&&!this.enabled){E.call(this,Q.value);}});if(this.children){this.initChildren();}var O=this.parent;if(!O||O.hasInitBindings){this.initBindings();}},destroy:function H(O){if(this.children){this.destroyChildren(true);}if(this.bindings){this.destroyBindings();}this._super(O);},unrender:function I(Q){var R=this.children,O=(R&&R.length)||0,P;for(P=O-1;P>-1;P--){R[P].unrender(true);}this._super(Q);},postBuildRendering:function A(){if(this._super()!==false){this.renderChildren();return true;}return false;},renderChildren:function L(){var Q=this.children,O=(Q&&Q.length)||0,P;for(P=0;P<O;P++){var R=Q[P];if(this.childRenderCheck(R)){R.render();}}},childRenderCheck:function D(P){if(P&&!P.hasRendered){var O=P.slot||this.defaultChildSlot;return !!this[O];}return false;},addChildren:function N(R,P,Q){var O=this._super(R,P,Q);if(O){this.childRenderOnAddCheck(O);}return O;},removeChildren:function F(W,R){var V=W?[W]:(this.children||[]),O=V.length,S;for(S=O-1;S>-1;S--){var Q=V[S],P=Q&&Q.domNode;if(P){var U=this[(Q.slot||this.defaultChildSlot)];if(P.parentNode===U){U.removeChild(P);}}}return this._super(W,R);},childRenderOnAddCheck:function B(Q){if(this.hasRendered&&Q){var O=Q.length,P;for(P=0;P<O;P++){var R=Q[P];if(this.childRenderCheck(R)){R.render();}else{if(R&&R.hasRendered){this.onchildRenderingChange(R);}}}}},onchildRenderingChange:function K(O){var X=O&&O.domNode;if(!X){return ;}var P=this.defaultChildSlot,W=O.slot||P,Z=this[W],Q=this.children;if(!Z){if(X.parentNode){X.parentNode.removeChild(X);}}else{if(X.parentNode===Z){return ;}if(!this.preserveChildDomOrder){Z.appendChild(X);}else{var R,V;for(V=Q.length-1;V>=0;V--){var Y=Q[V];if(Y===O){break;}if(W===(Y.slot||P)){var a=Y.domNode;if(a&&a.parentNode===Z){R=a;}}}if(R){Z.insertBefore(X,R);}else{Z.appendChild(X);}}}if(mstrmojo.publisher.hasSubs(this.id,"childrenRendered")){var S=Q.length,U;for(U=0;U<S;U++){if(!Q[U].domNode){return ;}}this.raiseEvent({name:"childrenRendered"});}},propagateChildProps:function C(S){var R=this[S],Q=this.children||[],O=Q.length,P;for(P=0;P<O;P++){Q[P].set(S,R);}}});mstrmojo.Container.enabledMarkupMethod=function(){mstrmojo.Widget.enabledMarkupMethod.apply(this,arguments);if(this.shouldPropagateEnabled){if(this.enabled){J.call(this);}else{E.call(this,this.children);}}};}());(function(){mstrmojo.requiresCls("mstrmojo.Widget","mstrmojo.css");var C=mstrmojo.Widget;mstrmojo.ui.Checkbox=mstrmojo.declare(mstrmojo.Widget,null,{scriptClass:"mstrmojo.ui.Checkbox",markupString:'<div id="{@id}" class="mstrmojo-ui-Checkbox {@cssClass}" mstrAttach:click></div>',markupMethods:{onvisibleChange:C.visibleMarkupMethod,oncheckedChange:function B(){mstrmojo.css.toggleClass(this.domNode,"checked",this.checked);},onenabledChange:C.enabledMarkupMethod},checked:false,onclick:function A(){this.set("checked",!this.checked);}});}());(function(){mstrmojo.requiresCls("mstrmojo.Widget","mstrmojo.css","mstrmojo.string");function C(H,D,E){var K=[];var G=H.optionRenderer,I=G&&G.render;if(I&&typeof I==="function"){var L=H.options,J=Math.min(E,((L&&L.length)||0)),F;for(F=D;F<J;F++){K.push(I(L[F],F,H));}}return K.join("");}mstrmojo.DropDownList=mstrmojo.declare(mstrmojo.Widget,null,{scriptClass:"mstrmojo.DropDownList",title:"",selectCssClass:"",tooltip:"",cssDisplay:"inline",value:"",unset:false,options:null,optionValueField:"v",optionNameField:"n",idx:-1,renderedOptions:"",markupString:'<span id="{@id}"  class="mstrmojo-DropDownList {@cssClass}">{@en@title}<select id="{@id}_select" class="mstrmojo-DropDownList-select {@selectCssClass}"  style="{@cssText}" title="{@tooltip}"onchange="mstrmojo.all[\'{@id}\'].set(\'selected\', this.options[this.selectedIndex].value);">{@renderedOptions}</select><div class = "strikeoutContainer"></div></span>',markupSlots:{selectNode:function(){return this.domNode.getElementsByTagName("select")[0];}},markupMethods:{onvisibleChange:mstrmojo.Widget.visibleMarkupMethod,onidxChange:function(){var D=this.domNode.getElementsByTagName("select");if(D&&D.length){D[0].selectedIndex=this.idx;}},onvalueChange:function(){var I=this.selectNode,G=I.options,F=this.value,E,H;for(H=0;H<G.length;H++){var D=G[H].value.toString()===F;if(D){E=H;if(F!==""){mstrmojo.css.toggleClass(G[H],"selected",D);}break;}}if(I.length>0&&E>0&&this.unset){if(this.options[0].v==="-1"){I.remove(0);E--;}this.unset=false;}this.set("idx",E);},onwidthChange:function(){var D=this.width;if(D>=0){this.selectNode.style.width=D+"px";}}},_set_selected:function(G,D){var E=this.selectNode,F=this[G]!==D;this[G]=D;if(E){this.set("value",D);}return F;},preBuildRendering:function A(){var F=this;if(F.unset){F.idx=0;}var E=F.options,D=(E&&E.length)||0;if(D){F.renderedOptions=C(F,0,D);}return this._super();},optionRenderer:{render:function(E,D,F){return mstrmojo.string.apply(F.getOptionMarkup(E),F.getOptionProps(E,D));}},getOptionMarkup:function(D){return'<option value="{@en@v}" class="{@cls}" style="{@style}" {@sel}>{@en@n}</option>';},getOptionProps:function B(F,D){var G=this,H=F[G.optionValueField],E=D===parseInt(G.idx,10);G.selected=G.value=E?H.toString():G.value;return{cls:E?"selected":"",v:H===undefined?"":H,n:F[G.optionNameField]||"",style:"",sel:E?"selected":""};}});}());(function(){mstrmojo.requiresCls("mstrmojo.array","mstrmojo.dom","mstrmojo.Widget","mstrmojo._ListSelections");var E=mstrmojo.dom;mstrmojo.ListBase=mstrmojo.declare(mstrmojo.Widget,[mstrmojo._ListSelections],{scriptClass:"mstrmojo.ListBase",selectionPolicy:null,itemRenderer:null,icnCssText:"",icnCss:"",markupString:'<div id="{@id}" tstid="{@tstid}" class="mstrmojo-ListBase {@cssClass}" style="{@cssText}" mstrAttach:click,dblclick,mousedown,mouseover,mouseout,contextmenu><div class="{@icnCss}" style="{@icnCssText}">{@itemsHtml}</div></div>',markupSlots:{itemsContainerNode:function G(){return this.domNode.firstChild;},scrollboxNode:function A(){return this.domNode;}},markupMethods:{onvisibleChange:mstrmojo.Widget.visibleMarkupMethod,onheightChange:mstrmojo.Widget.heightMarkupMethod,onwidthChange:mstrmojo.Widget.widthMarkupMethod},autoHide:false,itemsContainerNode:null,_markupPrefix:null,_markupSuffix:null,_itemPrefix:null,_itemSuffix:null,init:function J(K){this._super(K);if(this.autoHide){this.visible=!!(this.items&&this.items.length);}},buildRendering:function D(){this.itemsHtml="";var K=(this.renderOnScroll?this.items&&((this.renderIndex+1)*this.renderBlockSize):this.items&&this.items.length);if(K){this.itemsHtml=this._buildItemsMarkup(0,K-1,this._markupPrefix&&this._markupPrefix(),this._markupSuffix&&this._markupSuffix(),this._itemPrefix&&this._itemPrefix(),this._itemSuffix&&this._itemSuffix()).join("");}this._super();delete this.itemsHtml;this.addSlots({itemsNode:this.itemsContainerNode.firstChild});},_buildItemsMarkup:function B(K,N,V,L,W,M){var X=[],Q=0;X[Q++]=V||"";var P=this.itemRenderer,U=P&&P.render;if(U&&typeof U==="function"){var R=this.items,S=Math.min(N+1,((R&&R.length)||0)),O;for(O=K;O<S;O++){X[Q++]=W||"";X[Q++]=U(R[O],O,this);X[Q++]=M||"";}}X[Q+1]=L||"";return X;},onselectionChange:function H(X){if(!X){return ;}var S=this.itemRenderer;if(!S){return ;}var V=this.items;if(X.added&&X.added.length>0&&V.length>0&&!mstrmojo.array.some(X.added,function(a){return !V[a]||!V[a].dsbld;})){return ;}var O=S.unselect,R=this.items||[],Y=X.removed,N,M,L,P,Z;if(O&&Y){for(P=0,Z=Y.length;P<Z;P++){N=Y[P];if(typeof (N)==="object"){M=(N.idx==0)?0:N.positions;N=N.idx;}else{M=N;}L=this._getItemNode(M);if(L){O(L,R[N],M,this);}}}var K=S.select,W=X.added,Q,U;if(K&&W){for(Q=0,U=W.length;Q<U;Q++){N=W[Q];if(typeof (N)==="object"){M=(N.idx==0)?0:N.positions;N=N.idx;}else{M=N;}L=this._getItemNode(M);if(L){K(L,R[N],M,this);}}}if(this.onchange){this.onchange({added:X.added,removed:X.removed});}},_set_items:function C(N,K){this.renderIndex=0;if(this.autoHide){this.set("visible",!!(K&&K.length));}var M=this.items;this.items=K;if(M!==K){var L=this.hasRendered;if(L){this.unrender(false);}this.clearSelect();if(L){this.render();}return true;}return false;},onItemContextMenu:mstrmojo.emptyFn,oncontextmenu:function F(K){E.preventDefault(window,K.e);var M=K.getTarget(),L=this.getItemFromTarget&&this.getItemFromTarget(M);if(L){if(this.onItemContextMenu(L,K)){K.cancel();}}},_getItemNode:function I(K){var L=this.itemsContainerNode;return(L&&L.childNodes[K])||null;},renderOnScroll:false});}());(function(){mstrmojo.requiresCls("mstrmojo.Widget");var E=mstrmojo.Widget;mstrmojo.ui._IsPulldown=mstrmojo.provide("mstrmojo.ui._IsPulldown",{scriptClass:"mstrmojo.ui._IsPulldown",markupString:'<div id="{@id}" style="{@cssText}" class="mstrmojo-ui-Pulldown {@cssClass}" mstrAttach:mousedown,click><div class="mstrmojo-ui-Pulldown-text {@cssTextClass}" title="{@title}" style="{@labelCssText}">{@value}</div><div class="container"></div></div>',markupSlots:{selectedNode:function D(){return this.domNode.firstChild;},containerNode:function A(){return this.domNode.lastChild;}},markupMethods:{onvisibleChange:E.visibleMarkupMethod,onheightChange:E.heightMarkupMethod,onwidthChange:E.widthMarkupMethod,onvalueChange:function F(){this.selectedNode.innerHTML=this.value||"";},onenabledChange:mstrmojo.Widget.enabledMarkupMethod},getPopupList:mstrmojo.emptyFn,anchorSlot:"selectedNode",postBuildRendering:function B(){this._super();this.getPopupList().set("items",this.items);var G=this.selectedIndex,H=this.selectedIndices;if(G!==undefined){this.set("selectedIndex",G);}if(H!==undefined){this.set("selectedIndices",mstrmojo.hash.copy(H||{}));}},onitemsChange:function C(){var G=this.getPopupList();if(G){G.set("items",this.items);}},onPopupWidgetOpened:function(){var G=this.getPopupList();if(G&&(!G.items||G.items.length===0)){G.close();}}});}());(function(){var regExH=/"height", "[0-9.]+"/g;var regExW=/"width", "[0-9.]+"/g;var regExH1=/height="?[0-9.]+"?/g;var regExW1=/width="?[0-9.]+"?/g;mstrmojo.requiresCls("mstrmojo.Widget","mstrmojo._Formattable","mstrmojo._IsSelectorTarget");mstrmojo.DocVisualization=mstrmojo.declare(mstrmojo.Widget,[mstrmojo._Formattable,mstrmojo._IsSelectorTarget],{scriptClass:"mstrmojo.DocVisualization",markupString:'<div id={@id} class="mstrmojo-docvisualization" title="{@tooltip}" style="{@domNodeCssText}">{@htmlText}</div>',formatHandlers:{domNode:["RW","T","B","fx"]},update:function update(node){if(this._super){this._super(node);}var d=node.data;this.htmlText=d.htmlText;this.jsText=d.jsText;this.selData=d.selData;this.ctrLink=d.ctrLink;this.vp=d.vp;this.eg=d.eg;if(this.eg){this.htmlText=this.eg;}},preBuildRendering:function(){if(this._super){this._super();}var fmts=this.getFormats();if(!fmts){return ;}var h=fmts.height;if(h){h=h.replace("px","");}var w=fmts.width;if(w){w=w.replace("px","");}if(this.jsText){this.jsText=this.jsText.replace(regExH,'"height", "'+h+'"').replace(regExW,'"width", "'+w+'"');}},postBuildRendering:function pstBldRnd(){if(this._super){this._super();}eval(this.jsText);},resize:function(){if(this.eg){return ;}var embedNode=this.domNode.firstChild.firstChild.firstChild;if(!embedNode){return ;}var fmts=this.getFormats();var h=fmts.height;if(h){h=h.replace("px","");}var w=fmts.width;if(w){w=w.replace("px","");}if(mstrmojo.dom.isIE){embedNode.firstChild.setAttribute("height",h);embedNode.firstChild.setAttribute("width",w);}else{embedNode.innerHTML=embedNode.innerHTML.replace(regExH1,'height="'+h+'"').replace(regExW1,'width="'+w+'"');}},makeSelections:function(selections){var shuffledData={},i,j,attId,e;for(i=0;i<selections.length;i++){var attIdI=selections[i].attId;if(!shuffledData[attIdI]){shuffledData[attIdI]=[];}shuffledData[attIdI]=shuffledData[attIdI].concat(selections[i].values);}var sep="\u001E",sep1="\u001F";var ckJoined="",eidJoined="",cklJoined="";var tksArray=[];for(attId in shuffledData){var sd=this.getSelectionData(attId);if(!sd){continue;}var ctrLink=this.ctrLink[attId];var values=shuffledData[attId];if(sd&&values&&values.length>0){sd.sel=values;sd.ias=false;for(e in values){if(e==="u;"){sd.ias=true;break;}}}if(ctrLink.gbTargets){var t=ctrLink.targets=[],gbt=ctrLink.gbTargets,cgbmap=this.model.getCGBMap();for(j=0;j<gbt.length;j++){var targetKey=cgbmap[gbt[j]];if(targetKey){t.push(targetKey);}}delete ctrLink.gbTargets;}ckJoined+=ctrLink.ctxt+sep1;eidJoined+=values.join(sep)+sep1;cklJoined+=ctrLink.ck+sep1;tksArray=tksArray.concat(ctrLink.targets);}ckJoined=ckJoined.substring(0,ckJoined.length-1);eidJoined=eidJoined.substring(0,eidJoined.length-1);cklJoined=cklJoined.substring(0,cklJoined.length-1);if(tksArray.length===0){return ;}var evt={ck:ckJoined,eid:eidJoined,src:this.k,tks:tksArray.join(sep),type:this.defn.t,ctlKey:cklJoined,include:true,isDocVis:true};this.model.slice(evt);},getAllSelectionData:function(){return this.selData;},getSelectionData:function(attId){var selData=this.selData,k;if(selData&&selData.attl){var attl=selData.attl;if(attId){return attl[attId];}return attl[attl.keys()[0]];}},saveVisProps:function(widgetPropsXml){mstrApp.docModel.updateUnitFormat(this,1,{FormattingWidget:{WidgetProps:widgetPropsXml}},{success:function(){}});}});}());(function(){mstrmojo.requiresCls("mstrmojo.Widget","mstrmojo.dom");var B="mstrmojo-Image";mstrmojo.Image=mstrmojo.declare(mstrmojo.Widget,null,{scriptClass:"mstrmojo.Image",markupString:'<div id="{@id}" class="'+B+' {@cssClass}" style="{@cssText}" mstrAttach:click><image class="{@imgCssClass}" src="{@src}" mstrAttach:load /></div>',markupSlots:{imgNode:function(){return this.domNode.firstChild;}},markupMethods:{onsrcChange:function(){var C=this.imgNode;if(C){C.src=this.src||"../javascript/mojo/css/images/1ptrans.gif";}},oncssClassChange:function(){var C=this.domNode;if(C){C.className=this.cssClass||B;}},onvisibleChange:mstrmojo.Widget.visibleMarkupMethod},src:"",getImageSize:function A(){var C=this.imgNode;return{w:C.clientWidth,h:C.clientHeight};}});mstrmojo.Image.baseCssClass=B;}());(function(){mstrmojo.requiresCls("mstrmojo._IsInputControl");mstrmojo.DefaultDIC=mstrmojo.declare(mstrmojo.Widget,null,{scriptClass:"mstrmojo.DefaultDIC",isDummy:true,showInPopup:function(){mstrmojo.alert("The control style has not been supported yet.");}});}());(function(){mstrmojo.requiresCls("mstrmojo.Widget","mstrmojo._RowRendTracker","mstrmojo.array","mstrmojo.dom","mstrmojo.url","mstrmojo.chart.model.enums.EnumDSSBaseFormType");var L="<tr>";var Y=mstrmojo.dom;var h=['<table cellspacing="0" cellpadding="0" style="table-layout:',null,";width:",null,';mstr-tablestyle-slot" ',null,">",null,"<tbody>"];var U="&nbsp;";var g="fsbp_1 ";var X="fsbp_2 ";var Q="fsbp_3 ";var e=1,f=2,G=3,d=4,m=5,S={1:" stack-top",2:" stack-middle",3:" stack-bottom",4:" stack-bottom-last",5:" no-stack",6:" stack-full"},K=1,k=3;var B=mstrmojo.css,a=mstrmojo.array,P=mstrmojo.chart.model.enums.EnumDSSBaseFormType;var N=4;function Z(q,r,n){var p=true,o=0;if(n.cs>1){for(o=0;o<n.cs;o++){p=p&&q[r+n.cs-o-1];}}else{p=q[r];}return p;}function V(p,o){for(var q=0,n=p.length;q<n;q++){var t=p[q];var r=o.rows[t.rows].cells[t.cells];if(r){mstrmojo.css.addClass(r,g);}}}function c(p){var r=p.indexOf('src="');if(r<0){return p;}var q=p.substring(r+5),o=q.indexOf('"'),t;q=q.substring(0,o);t=q;if(mstrApp.isDossier){t=mstrmojo.url.getFullPath(q);}else{var n=this.parent&&this.parent.controller&&this.parent.controller.model&&this.parent.controller.model.dataService;if(n&&n.getImage){t=n.getImage(q);}}return p.replace(q,t);}function l(r,q){var n="",t="#srcend",o=-1,p,u=r.split("#srcstart");u.forEach(function(v){o=v.indexOf(t);p=v.split(t);p.forEach(function(x,w){if(w===0&&o!==-1){x=x.substring(0,o);n+='<img src="'+x+'" '+q+">";}else{n+=x;}});});return n;}function D(p,o,n){var v=p.outLvl,q="outlineMode",u=this.parent.outlineState,t=p._ei,r=t?(' ei="'+t+'"'):"";if(u&&u[t]){q+=p.hidden?" hiddenRow":"";}else{if((n>0&&v>n)){q+=" hiddenRow";}}if(this.parent.hasEmptyTBody&&q.indexOf("hiddenRow")===-1){this.parent.hasEmptyTBody=false;}return' level="'+v+'" class="'+q+'"'+r+">";}var J=(function(){var q=/\n/g,v="<br/>",AB=/<a\s[^>]+>/gi,AA="<a ",AJ='<a target="_blank" ',o="target=";var z='<a href="',w="",t="</a>",p="<span>",n="</span>",AG="<div>",AF="</div>",AD='<span class="text">',AC="</span>",x='<span rabtn class="raBtn ',u='"></span>',AE="iconRA-expand",r="iconRA-collapse",AI="<span>",AH="</span>";return function(AL,AV,AT){var AY=AL.v||AL.n||U,AP=AL.ts===P.DssBaseFormUrl,AS=AL.ts===P.DssBaseFormHTMLTag,AX=AL.lv!==undefined;AY=(AL.ts===P.DssBaseFormText||AL.mdf===1)?AY.replace(q,v):AY;if(AP){if(!w){w=AV?'" target="_blank">':'">';}AY=z+AY+w+AY+t;}else{if(AS&&AV){(AY.match(AB)||[]).forEach(function(Ac){if(Ac.indexOf(o)===-1){AY=AY.replace(Ac,Ac.replace(AA,AJ));}});}}if(AS){var AM=document.createElement("div");AM.innerHTML=AY;var AQ=AM.querySelectorAll("img");a.forEach(AQ,function(Ad){Ad.onload=function Ac(){var Ae=mstrmojo.all[AT];if(Ae){if(Ae._updateScrollbarTimer){clearTimeout(Ae._updateScrollbarTimer);}Ae._updateScrollbarTimer=setTimeout(function(){Ae.updateScrollbars();},100);}};});AY=AM.innerHTML;}if((AL.css&&AL.css.indexOf("hl")>-1)||AP){AY=p+AY+n;}if(AX){var Aa=AL.lv,Ab="&nbsp;&nbsp;&nbsp;&nbsp;",AO="",AK="",AU="",AW;for(AW=0;AW<Aa;AW++){AO+=Ab;}if(AL.hcd&&AL.fi===undefined){AU=x+(AL.epd?r:AE)+u;}else{AO+=Ab;}if(AL.axis===1){AK=AI+AO+AH;}AY=AG+AK+AU+AD+AY+AC+AF;}else{if(AL.outLvl&&AL.cs>1&&!AL.isLeaf){var AZ=(AL.stt&&!AL.dpt),AN=AZ?"":"icon-outline-span"+(AL.epd?" outline-expand":" outline-collapse"),AR=!AZ&&AL.epd?' collapsed="true"':"";AY='<span class="'+AN+'"  sty="outimg" dpt="'+AL.outLvl+'"'+AR+"></span>"+AY;}else{if(AL.expandLevel){AY='<span class="icon-outline-span outline-collapse" expandTo="'+AL.expandLevel+'" title=""></span>'+AY;}else{if(AL.fillerCell&&AY==U){AY="";}}}}return AY;};}());mstrmojo.GridBase=mstrmojo.declare(mstrmojo.Widget,[mstrmojo._RowRendTracker],{scriptClass:"mstrmojo.GridBase",markupString:'<span id="{@id}" class="mstrmojo-Grid {@cssClass}" style="{@cssText}"></span>',markupSlots:{gridContainerNode:function(){return this.domNode;}},autoFitWindow:false,tableLayout:null,numAutoHeightRows:0,cp:null,rc:0,cc:0,cws:null,rh:null,totalColWidth:0,start:0,end:0,forceFixedSizes:true,hiliteCellsMap:null,eiMap:null,init:function C(n){this._super(n);},numColumnCanMerge:0,preBuildRendering:function A(){var n=this.cp;if(!n){return ;}n.initContent();this.rc=n.rc||0;this.cws=n.colWidths||[];this.cc=this.cws.length;this.tdWidths=n.tdWidths||[];this.tdCnt=this.tdWidths?this.tdWidths.length:0;this.start=0;this.end=this.rc-1;this.numAutoHeightRows=n.getNumAutoHeightRows&&n.getNumAutoHeightRows()||0;this.hiliteCellsMap={};this.eiMap={};this.posMap=[];this.thPosMap=[];this.totalColWidth=0;},buildRendering:function b(o){var n=this._super(o);this.renderGrid();return n;},renderGrid:function F(o){var n=this.getGridContainer();this.preBuildGridTable();this.buildGridTable(n,o);this.postBuildGridTable();},getGridContainer:function H(){return this.gridContainerNode;},buildGridTable:function M(p,n){var o=this.getTableStartMarkup();var w=this.getTableEndMarkup();if(n){this.mergeHdrsAcrossBlks=true;}var u=this.buildTableRowsMarkup(this.start,this.end,o,w).join("");if(n){var r=document.createElement("div");r.innerHTML=u;var v=p.firstChild,x=v&&v.tBodies,q=r.firstChild.tBodies[0],t=this.matchedHdrsAcrossBlks;v.appendChild(q);if(t&&t.length>0){V(t,x[x.length-2]);}}else{p.innerHTML=u;}this.markPages(this.start,this.end);},getTableStartMarkup:function E(){var o=this._getGridWidths(),n=h;n[1]=o.tableLayout;n[3]=o.totalColWidths;n[5]=this.tableCssClass?"class="+this.tableCssClass:"";n[7]="<colgroup>"+o.colgroup+"</colgroup>";if(this.tbodyStyle){n[8]='<tbody style="'+this.tbodyStyle+'">';}return n.join("");},getTableEndMarkup:function O(){return"</tbody></table>";},_getGridWidths:function R(){var x={};var r="",p=[],v="fixed",o=this.cws,t=o.length;if(t){r=0;p=[];for(var q=0;q<t;q++){if(o[q].w!==""){r+=parseInt(o[q].w,10);}}for(q=0;q<t;q++){var n=o[q];if(n.w!==""&&!this.autoFitWindow&&!this.autoFitContent){var u=parseInt(n.w,10);if(mstrmojo.dom.isIE7){if(u===0){p.push('<col style="width:0%;display:none"></col>');}else{p.push('<col style="width:'+(u/r*100)+'%"></col>');}}else{if(mstrmojo.dom.isWK&&u===0){p.push('<col style="width:-1px"></col>');}else{p.push('<col style="width:'+n.w+'"></col>');}}}else{p.push("<col />");v="auto";}}this.totalColWidth=r;}x.colgroup=p.join("");v=this.tableLayout||v;if(this.autoFitWindow){v=this.tableLayout||v||"fixed";r="100%";}else{if(v==="fixed"){r+="px";}else{r="auto";}}x.totalColWidths=r;x.tableLayout=v;return x;},_CELL_MARKUP:['<td rowSpan="',null,'" colSpan="',null,'" class="',null,'" ei="',null,'" style="',null,'" r="',null,'">',null,"</td>"],buildTableRowsMarkup:function I(AI,Ad,AB,w,o){var Av=[],Ac=0;Av[Ac++]=AB||"<table><tbody>";var AU=this.cp,Au=this.acws,Ax=this.rowMerge,A8=this.headerOffset,A9=this.mxPos,A1=!!AU.gemh,BC=AU.getRowHeight(),n=this._CELL_MARKUP,BA=BC?'<tr style="height:'+(BC?BC+"px":"")+'">':L;var A0=true,A5=true,AY=[],BF;var Ak=function Ak(v){var r=-1;mstrmojo.array.forEach(Au,function(BH,BG){v=v-BH;if(v<0){r=BG;return false;}});return r;};var AN=function AN(BG,v){var r=-1;mstrmojo.hash.forEach(AU.gemh,function(BH,BI){if(BG<=BI&&BG+v>BI){r=BI;return false;}});return r;};var AH=function AH(BI,BJ,BH){var BG="",v,r;r=BI.gemh&&BI.gemh[BJ];if(r){v=Ak(BH);if(r[v]&&r[v].v===0||A9===BH){BG+=g;}}r=BI.gsmh&&BI.gsmh[BJ];if(r){v=Ak(BH);if(r[v]&&r[v].v===0||A9===BH){BG+=Q;}}return BG;};var Ay,AR,Ao,AS=[],Ab,AW,u=0,Ai=0,AZ,AD,t=AU.colWidths&&AU.colWidths.length,BD=0,Ar=0,Am=o||((AB&&AB.indexOf("table-layout:fixed;")!==-1)?"fixed":"auto"),AL=mstrApp.isSingleTier;if(Au&&A1){for(Ab=0;Ab<Au.length-1;Ab++){Ar+=Au[Ab];}}Ar=Ar||this.numColumnCanMerge;if(Am==="fixed"){Ay=[];for(AR=0,Ao=this.cws.length;AR<Ao;AR++){if(window.parseFloat(this.cws[AR].w)<=0){Ay[AR]=true;}else{Ay[AR]=false;}}}this.matchedHdrsAcrossBlks=[];var z=Ad,BB=this.parent.isOutlineMode,An=this.parent.gridData,A7=An.maxLevel,Ae=An.lvlepd,AA=this.parent.id,AV=0;AU.renderingNewPage=true;for(var AX=AI;AX<=Ad;AX++){u=0;BF=Ac++;Av[BF]=AX<this.numAutoHeightRows?L:BA;var p=AU.updateCounter,Af=AU.getRowCells(AX);if(BB&&window.mstrApp&&mstrApp.isExporting){var AK=AU.updateCounter-p;if(AK>0){AV=AK;}if(AV>0){AV--;Av[BF]=Av[BF].substr(0,Av[BF].length-1)+' extra="1">';}}var Ah=Ad+1-AX;var AP=0;AD=Ax;AZ="";if(!this.mergeHdrsAcrossBlks){if(A0&&AI>0&&Af.length<AU.colWidths.length){var Ap=AU.getUnmergedCells(AI),Al;if(Ap){AP=Ap.length;}for(Ab=0,Ao=AP;Ab<Ao;Ab++){var At=Ap[Ab],A6=At.rs;if(A6>Ah){n[1]=Ah;n[5]=X+At.css;}else{n[1]=A6||1;n[5]=Q+At.css;}if(Ay&&Ay[Ai+u]){n[5]+=" nwFixedWidth0 ";}if(A6&&A6>1){AS.push(A6);}u+=At.cs||1;if(At.cet){n[5]+=" mstrmojo-selected-cell";this.addHilitePosition(At.cet,AX,Ab);}if(At._ei){this.addExtraInfoMap(At._ei,AX,Ab);n[5]+=" pt";}n[9]="";n[13]=U;n[3]=At.cs;if(At._ei===undefined){Al=AU.getRowCells(At.o+(AU.cps[0]&&AU.cps[0].rc||0),true);At=a.filterOne(Al,function(r){return r.dpt===At.dpt&&r.idx===At.idx;});}n[7]=At._ei;n[11]=AX;if(A1){if(AD){AZ=AH(AU,AX-A8,Ab);}if(!!AZ){n[5]=AZ+n[5];}else{AD=false;}AZ=AH(AU,AN(AX-A8,n[1]),Ab);if(!!AZ){n[5]=g+n[5];AD=true;}}Av[Ac++]=n.join("");}A0=false;}}BD=t;Ao=Af.length;var Ag;for(Ag=0;Ag<Ao;Ag++){BD-=Af[Ag].cs||1;}for(Ag=0;Ag<Ao;Ag++){var AQ=Af[Ag],A4;if(AQ.outLvl){var A2=D.call(this,AQ,A7,Ae);Av[BF]=Av[BF].replace(">",A2);if(AU.updateCounter>0){Ad=z+AU.updateCounter;}}AQ.colIx=BD;if(AQ.rs&&AQ.rs>Ah){n[1]=Ah;n[5]=g+AQ.css;if(AQ._ei){this.addExtraInfoMap(AQ._ei,AX,Ag);}}else{n[1]=AQ.rs||1;n[5]=AQ.css;}if(Ay&&Ay[BD]){if(AQ.cs==undefined||Z(Ay,BD,AQ)){n[5]+=" nwFixedWidth0 ";}}if(AQ.rs&&AQ.rs>1){AS.push(AQ.rs);}u+=AQ.cs||1;if(AQ.rowType!==e){n[5]+=" xtab-td ";}if(AQ.cet){n[5]+="sc_"+this.parent.k;this.addHilitePosition(AQ.cet,AX,Ag);}if(AQ.lv!==undefined){n[5]+=" ra ";}A4=AQ.rowType;if(A4){n[5]+=S[A4]||"";var AT=AU.getRowHeight(A4);if(AT){Av[BF]='<tr style="height:'+(AT?AT+"px":"")+'">';}}n[3]=AQ.cs||1;n[7]=AQ._ei!==undefined?AQ._ei:"";if(AQ.fs||AQ._e){this.addTitleHeaderPositionMap(AX,Ag+AP,AQ);}if(AQ._ei!=null){this.addPositionMap(AQ._ei,AX,Ag+AP);}n[11]=AX;if(AQ.ts===N){if(mstrApp.isDossier){AQ.v=mstrmojo.url.getFullPath(AQ.v);}var Aw=AQ.v;if(this.imgCacheMap){var Aa=this.imgCacheMap,AW=Aw&&Aw.replace(/\\/g,"/");if(Aa.cachedImg[AW]){AQ.v=Aw=Aa.baseURL+Aa.cachedImg[AW];}else{if(AW&&!Aa.unCachedImg[AW]){Aa.unCachedImg[AW]=AW;}}}else{var AC=this.parent&&this.parent.controller&&this.parent.controller.model&&this.parent.controller.model.dataService;if(AC&&AC.getImage){Aw=AC.getImage(Aw);}}if(AQ.rowType){var AJ=(AU.getRowHeight(AQ.rowType)||AU.rh||BC),AM=AJ,BE=this.tdWidths,AF=AQ.colIdx,x=0,AE=0;var Aj=AU.getPadding(K),Az=AU.getPadding(k);if(AQ.rowType===e||AQ.rowType===d){AE=AJ>(Aj+Az)?(AJ-Aj-Az):0;}else{if(AQ.rowType===f||AQ.rowType===G){AE=AJ>2*Az?(AJ-2*Az):0;}else{if(AQ.rowType===m){AE=AJ>(Az*2)?(AJ-Az*2):0;}}}if(AF!=="undefined"&&AF>-1&&BE&&BE.length>AF){var AO=BE[AF]&&BE[AF].w;if(AO!=="undefined"){x=parseInt(AO,10);}}var q=x>30?(x-30):0;n[13]='<div><div style="top:'+(-parseInt(AM/2,10))+"px;height:"+(AJ-1)+"px;line-height:"+(AJ-1)+'px !important;">&nbsp;<img style="max-height:'+AE+"px; max-width: "+q+'px;" src="'+Aw+'"></img></div></div>';}else{n[9]="";var Aq="",AG=this.parent&&this.parent.controller&&this.parent.controller.model&&this.parent.controller.model,As=AG.getZoomFactor();if(As!=1){Aq='onload="this.style.height='+As+"*this.offsetHeight+'px';\"";}if(BB){if(Aw.indexOf("#srcstart")!==-1){AQ.v=l(Aw,Aq);}else{AQ.v='<img src="'+Aw+'" '+Aq+"></img>";}n[13]=J(AQ,AL,AA);}else{n[13]='<img src="'+Aw+'" '+Aq+"></img>";}if(AQ.css&&AQ.css.indexOf("hl")>-1){n[13]="<span>"+n[13]+"</span>";}}}else{n[9]="";if(BB&&AQ.v&&AQ.v.indexOf("#srcstart")>=0){AQ.v=l(AQ.v,"");n[13]=J(AQ,AL,AA);}else{if((mstrApp.isDossier||mstrApp.useBinaryFormat)&&AQ.v&&AQ.v.indexOf("img")>=0){AQ.v=c.call(this,AQ.v);}n[13]=J(AQ,AL,AA);}}if(Ag<Ar){if(AX===AI&&this.mergeHdrsAcrossBlks){var A3=this.rowHdsAcrossBlks;if(A5&&AQ.v&&A3&&A3[Ag]){if(AQ.v===A3[Ag].v){n[1]=AQ.rs||1;n[5]=Q+AQ.css;n[13]="";this.matchedHdrsAcrossBlks.push(A3[Ag]);}else{A5=false;}}}if(A1){if(AD){AZ=AH(AU,AX-A8,BD);if(!!AZ){n[5]=AZ+n[5];if(AZ.indexOf(Q)>=0&&AX-A8>1){n[13]=U;}}else{AD=false;}AZ=AH(AU,AN(AX-A8,n[1]),BD);if(!!AZ){n[5]=g+n[5];AD=true;}}}if(n[1]>=Ah&&AQ.v){AY.push({rows:AX-AI,cells:Ag,v:AQ.v});}}BD+=AQ.cs||1;Av[Ac++]=n.join("");}Av[Ac++]="</tr>";for(Ag=AS.length-1;Ag>=0;Ag--){AW=AS[Ag];if(AW<=1){AS.pop();}else{AS[Ag]=--AW;}}Ai=AS.length;}Av[Ac++]=w||"</tbody></table>";this.rowHdsAcrossBlks=AY;return Av;},addHilitePosition:function(o,p,n){var q=this.hiliteCellsMap[o];if(!q){this.hiliteCellsMap[o]={pos:[],nodes:[]};}this.hiliteCellsMap[o].pos.push({row:p,cell:n,page:0});},addExtraInfoMap:function(o,n,p){if(!this.eiMap[o]){this.eiMap[o]=[];}this.eiMap[o].push({row:n,cell:p,page:0});},addPositionMap:function(o,n,p){if(!this.posMap[o]){this.posMap[o]={row:n,cell:p,page:0};}},addTitleHeaderPositionMap:function(n,q,p){this.thPosMap.push({row:n,cell:q,page:0,obj:p});},clearHilites:function(q){var v=this.hiliteCellsMap[q],t=v&&v.nodes,r=this.parent;if(t){if(t.length==0&&v.pos){t=this.getNodesByPositions(v.pos);}for(var p=0,o=t.length;p<o;p++){var u=t[p],n=r.getCellForNode(u);if(n){delete n.cet;}B.removeClass(u,"sc_"+r.k);}this.hiliteCellsMap[q].nodes=[];}},setHilites:function(o,p){B.addClass(p,"sc_"+this.parent.k);if(!this.hiliteCellsMap[o]){this.hiliteCellsMap[o]={pos:[],nodes:[]};}this.hiliteCellsMap[o].nodes.push(p);var n=this.parent.getCellForNode(p);if(n){n.cet=o;}},getNodesByPositions:function(r){var q=this.tableNode,n=[];for(var p in r){var o=r[p];n.push(q.tBodies[0].rows[o.row].cells[o.cell]);}return n;},preBuildGridTable:function W(){},postBuildGridTable:function j(){this.addSlots({tableNode:this.gridContainerNode&&this.gridContainerNode.firstChild});if(this.tableNode&&mstrApp&&mstrApp.isSingleTier){Y.redirectUrlToFormWrapper(this.tableNode);}}});})();(function(){mstrmojo.requiresCls("mstrmojo.Widget","mstrmojo.color","mstrmojo.dom");var L=mstrmojo.color,H=mstrmojo.dom;var I=68.5,M=77.5,D=83;function B(O,N){return{x:O.clientX-N.x-M,y:O.clientY-N.y-M};}function K(){var N=this._hsl[1],P=this._hsl[2];var O=this.slHandleNode.style;O.left=Math.round(D*(0.5-N)+M)+"px";O.top=Math.round(D*(0.5-P)+M)+"px";}function F(){var N=this._hsl[0],P=N*2*Math.PI;var O=this.hueHandleNode.style;O.left=Math.round(Math.sin(P)*I+M)+"px";O.top=Math.round(-Math.cos(P)*I+M)+"px";this.slNode.style.backgroundColor=L.hsl2hex(N,1,0.5);}function C(){this._hsl=L.hex2hsl(this.color);if(this.slHandleNode&&this.hueHandleNode){K.call(this);F.call(this);}}mstrmojo.ui.editors.controls.ColorWheel=mstrmojo.declare(mstrmojo.Widget,null,{scriptClass:"mstrmojo.ui.editors.controls.ColorWheel",markupString:'<div id="{@id}" class="mstrmojo-ui-ColorWheel {@cssClass}" style="{@cssText}" mstrAttach:mousedown><div class="cwHue"></div><div class="cwColorField"></div><div class="cwHandle"><div></div></div><div class="cwHandle"><div></div></div></div>',markupSlots:{slNode:function(){return this.domNode.childNodes[1];},hueHandleNode:function(){return this.domNode.childNodes[2];},slHandleNode:function(){return this.domNode.lastChild;}},markupMethods:{onvisibleChange:mstrmojo.Widget.visibleMarkupMethod},slNode:null,hueHandleNode:null,slHandleNode:null,color:"#ffffff",onColorPicked:function G(N){},postBuildRendering:function A(){C.call(this);},oncolorChange:function J(){C.call(this);},onmousedown:function E(Q){var S=this,N=H.position(this.domNode),U=this._hsl,P=Q.e,R=B(P,N),V=Math.max(Math.abs(R.x),Math.abs(R.y))*2>D,O=function(Y){var b=B(Y,N),X=U[0],Z=U[1],a=U[2];if(V){X=Math.atan2(b.x,-b.y)/(2*Math.PI);if(X<0){X+=1;}S._hsl=[X,Z,a];F.call(S);}else{Z=Math.max(0,Math.min(1,-(b.x/D)+0.5));a=Math.max(0,Math.min(1,-(b.y/D)+0.5));S._hsl=[X,Z,a];K.call(S);}var W=L.hsl2hex(X,Z,a);S.color=W;S.onColorPicked(W);H.stopPropogation(window,Y);return false;};H.attachMouseMoveEvents(O);O(P);}});}());(function(){mstrmojo.requiresCls("mstrmojo.hash","mstrmojo.css","mstrmojo.dom","mstrmojo.boxmodel","mstrmojo.Widget");var Y=mstrmojo.hash,g=mstrmojo.css,L=mstrmojo.dom,d="animate",P="px";function b(h){return Y.copy(((!!mstrApp.isWSStyling)?Y.walk(h,window).boxConfigurationWS:undefined)||Y.walk(h,window).boxConfiguration||mstrmojo.vi.ui._IsBoxLayoutChild.boxConfiguration);}function H(k){var j=k.boxCache,l=j&&j[this.id],h=false;if(!l){h=this.domNode.className.indexOf(d)>-1;this.cacheCtxtBoxPosition(k);}k.boxAnimating=h;}mstrmojo.vi.ui._IsBoxLayoutChild=mstrmojo.provide("mstrmojo.vi.ui._IsBoxLayoutChild",{_mixinName:"mstrmojo.vi.ui._IsBoxLayoutChild",markupMethods:{onvisibleChange:mstrmojo.Widget.visibleMarkupMethod,ontopChange:mstrmojo.Widget.topMarkupMethod,onleftChange:mstrmojo.Widget.leftMarkupMethod,onzIndexChange:function(){this.domNode.style.zIndex=this.zIndex||1;}},id:null,left:"0px",top:"0px",zIndex:1,draggable:false,dropZone:false,getBoxConfiguration:function C(){return b(this.scriptClass);},getBoxBorderWidth:function I(){return 0;},getMinBoxSize:function A(h){return mstrmojo.vi.ui._IsBoxLayoutChild.getBoxMinimums(this.scriptClass)[h];},getIdentifier:function Q(){return this.id;},updateLayout:function O(k,h){if(Y.equals(k,this._currentLayout)){return ;}var j=this.domNode,m=window.Modernizr,l=this.getBoxBorderWidth();if(j&&h&&m.testProp("transition")){g.addClass(j,d);g.onTransitionEnd(j,function(){g.removeClass(j,d);});}this._currentLayout=k;this.applyBoxSize(Math.max((parseInt(k.height,10)-l),0)+P,Math.max((parseInt(k.width,10)-l),0)+P,k.top,k.left);if(this.hasRendered&&this.doLayout){this.doLayout();}this.postUpdateLayout();},postUpdateLayout:function D(){},applyBoxSize:function Z(h,l,n,m){this.height=h;this.width=l;this.top=n;this.left=m;var k=this.domNode;if(k){var j=this.domNode.style;j.top=n;j.left=m;j.height=h;j.width=l;if(parseInt(h,10)<=0||parseInt(l,10)<=0){j.borderWidth="0";}}},createAvatar:function W(){return this.offsetAvatar(this.domNode);},offsetAvatar:function S(h){h.style.margin="20px 0 0 20px";return h;},setMaskVisibility:function U(h){var j=this.maskNode.style;j.display=h?"block":"none";if(!h){this.resetMask();}},isDragValid:function F(h){return true;},initializeDrag:function G(h){},ondragstart:function f(h){this.initializeDrag(h);delete this._currentLayout;this.parent.beginBoxMove(h,this);this._super(h);},ondragend:function N(h){this._super(h);this.parent.endBoxMove(h,this);if(!h.dropSuccessful){this.parent.cancelBoxMove(h);}var j=this.domNode;j.style.margin="0";},allowDrop:function K(h){var k=h.src,j=k&&k.widget;return(j&&j.parent===this.parent);},wasDropped:function M(h){},cancelBoxMove:function J(h){return false;},ondragenter:function V(h){this.setMaskVisibility(true);},ondragover:function X(h){H.call(this,h);this.highlightMask(this.parent.getPanelTargetEdge(h)||this.getTargetDropZone(h),h);if(h.boxAnimating){delete h.boxCache[this.id];}},cacheCtxtBoxPosition:function E(j){var h=j.boxCache=j.boxCache||{};h[this.id]=L.position(this.domNode);},ondrop:function c(h){H.call(this,h);var k=h.src.widget;if(k.wasDropped){k.wasDropped(h);}var j=this.parent;if(k.parent===j){j.dropBox(h,this,this.maskNode.zone,true);}this.setMaskVisibility(false);},ondragleave:function B(){this.setMaskVisibility(false);},highlightMask:function e(l,k){var h=this.maskNode,j=k.boxAnimating;if(l!==h.zone||j||h.isAnimating!==j){h.zone=l;h.isAnimating=j;this.parent.updateDropCue(l,k,k.boxCache[this.id]);}},getTargetDropZone:function R(h){return mstrmojo.boxmodel.getEdgeQuadrantByPoint(h.boxCache[this.id],h.tgt.pos);},resetMask:function a(){this.parent.updateDropCue("");var h=this.maskNode;delete h.zone;delete h.isAnimating;},getBoxDimension:mstrmojo.emptyFn,postDropBox:mstrmojo.emptyFn});mstrmojo.vi.ui._IsBoxLayoutChild.boxConfiguration={addToEnd:true};mstrmojo.vi.ui._IsBoxLayoutChild.getBoxMinimums=function(h){var j=b(h);return Y.copy(j.minSize||j.f||{h:75,v:75});};mstrmojo.vi.ui._IsBoxLayoutChild.BoxConfigurationType=null;}());(function(){mstrmojo.requiresCls("mstrmojo.Widget","mstrmojo.dom","mstrmojo.hash","mstrmojo.css");var C=mstrmojo.dom,B=mstrmojo.hash,E=mstrmojo.css;mstrmojo.Button=mstrmojo.declare(mstrmojo.Widget,null,{scriptClass:"mstrmojo.Button",iconClass:"",innerIconClass:"",title:"",text:"&nbsp;",enabled:true,selected:false,markupString:'<div id="{@id}" class="mstrmojo-Button {@cssClass} {@iconClass}" title="{@title}" style="{@cssText}" mstrAttach:touchstart,click,mousedown,mouseup><div class="mstrmojo-Button-text {@innerIconClass}"></div></div>',markupSlots:{textNode:function(){return this.domNode.firstChild;}},markupMethods:{onvisibleChange:mstrmojo.Widget.visibleMarkupMethod,onenabledChange:function(){E.toggleClass(this.domNode,"disabled",!this.enabled);},onselectedChange:function(){E.toggleClass(this.domNode,"selected",this.selected);},ontextChange:function(){this.textNode.innerHTML=this.text;},ontitleChange:function(){this.domNode.title=this.title;},onwidthChange:mstrmojo.Widget.widthMarkupMethod},oniconClassChange:function D(J){var K=this.domNode;if(this.hasRendered&&K){K.className=K.className.replace(J.valueWas,"")+" "+J.value;}},onclick:mstrmojo.emptyFn,ontouchend:function I(J){this.onclick(J);}});mstrmojo.Button.newIconButton=function H(L,O,M,J,N){var K={scriptClass:"mstrmojo.Button",title:L,cssClass:O,text:"",onclick:M};if(J){K.bindings=J;}B.copy(N,K);return K;};function F(M,N,J,P){var L=[];if(J){L.push(J);}var O=P&&P.cssClass;if(O){L.push(O);delete P.cssClass;}var K={scriptClass:"mstrmojo.Button",cssClass:L.join(" "),text:M};if(N){K.onclick=N;}return B.copy(P,K);}mstrmojo.Button.newInteractiveButton=function G(M,N,P,O){var L={glowClass:"glow"};if(P&&(C.isFF||C.isWK)){B.copy({onmousedown:function J(){E.applyShadow(this.domNode,0,0,10,P);},onmouseup:function K(){E.removeShadow(this.domNode);}},L);}return F(M,N,"mstrmojo-InteractiveButton",B.copy(O,L));};mstrmojo.Button.newWebButton=function A(K,J,M,L){return F(K,J,"mstrmojo-WebButton"+(M?" hot":""),L);};mstrmojo.Button.newActionButton=function(K,L,M){var J=mstrmojo.Button.newWebButton(K,L,false,M);J.cssClass=J.cssClass+" action-button";return J;};}());(function(){mstrmojo.requiresCls("mstrmojo.threshold.ThresholdModel","mstrmojo.chart.model.enums.EnumDSSObjectType","mstrmojo.models.FormatModel");var K=mstrmojo,F=mstrmojo.chart.model.enums.EnumDSSObjectType,E=mstrmojo.vi.viz.EnumVisualizationTemplates,H=1,D=["#ec7b75","#f6db7f","#84c87b"],I=[0.35,0.65],B=K.models.FormatModel,J=B.ENUM_PROPERTY_NAMES;function C(N,M,O,P){M.reverse().forEach(function(Q){P.push(N.getClearThresholdAction(O.did,O.t||F.DssTypeMetric,Q.tid));});}mstrmojo.vi.util.ThresholdUtils=mstrmojo.provide("mstrmojo.vi.util.ThresholdUtils",{addClearAllThresholdsActions:function L(M,O,S){var R=O.data.gsi,N=R.mx,P=R.thresholds,Q;if(P){N.forEach(function(U){Q=P[U.did];if(Q){C(M,Q,U,S);}});R.thresholds={};}},addThresholds:function A(V,a,P,U,R,M,N,Q){var S,X=[],W=new mstrmojo.threshold.ThresholdModel({data:P.data}),Y=W.data.gsi.thresholds,O=Y&&Y[U.did];R=R||[];if(!O||Q){M=M||D;N=N||I;for(S=0;S<M.length;S++){var Z={};Z.fmt=B.getFormatUpdate(J.BACKGROUND_COLOR,M[S]);B.getFormatUpdate(J.FILL_STYLE,0,Z.fmt);if(S>0){Z.flr=W.getRealValue(N[S-1],H);}if(S<N.length){Z.ceil=W.getRealValue(N[S],H);}X.push(Z);}if(O){C(V,O,U,R);}R.push(V.getCreateSimpleThresholdAction(X,a.k,U.did,H,null,4));}W.destroy();return R;},getDefaultGMThreshold:function G(O){var N,M;switch(O){case E.GRAPHMATRIXHORIZONTALBARCLUSTERED:case E.GRAPHMATRIXHORIZONTALBARSTACKED:case E.GRAPHMATRIXHORIZONTALBARPERCENT:case E.GRAPHMATRIXVERTICALBARCLUSTERED:case E.GRAPHMATRIXVERTICALBARSTACKED:case E.GRAPHMATRIXVERTICALBARPERCENT:case E.GRAPHMATRIXVERTICALBARAUTOMATIC:case E.GRAPHMATRIXPIE:N=["#d2e0e8","#a4cbe6","#80add9","#558dcc","#2e78bb"];M=[0.2,0.4,0.6,0.8];break;case E.GRAPHMATRIXVERTICALLINECLUSTERED:case E.GRAPHMATRIXVERTICALLINESTACKED:case E.GRAPHMATRIXVERTICALLINEPERCENT:case E.GRAPHMATRIXVERTICALLINEAUTOMATIC:case E.GRAPHMATRIXHORIZONTALLINECLUSTERED:case E.GRAPHMATRIXHORIZONTALLINESTACKED:case E.GRAPHMATRIXHORIZONTALLINEPERCENT:case E.GRAPHMATRIXHORIZONTALLINEAUTOMATIC:case E.GRAPHMATRIXVERTICALAREACLUSTERED:case E.GRAPHMATRIXVERTICALAREASTACKED:case E.GRAPHMATRIXVERTICALAREAPERCENT:case E.GRAPHMATRIXVERTICALAREAAUTOMATIC:case E.GRAPHMATRIXHORIZONTALAREACLUSTERED:case E.GRAPHMATRIXHORIZONTALAREASTACKED:case E.GRAPHMATRIXHORIZONTALAREAPERCENT:case E.GRAPHMATRIXHORIZONTALAREAAUTOMATIC:N=["#ec7b75","#f6db7f","#84c87b"];M=[0.35,0.65];break;case E.GRAPHMATRIXBUBBLECIRCLEMM:case E.GRAPHMATRIXBUBBLEGRIDCIRCLEAA:case E.GRAPHMATRIXBUBBLEGRIDSQUAREAA:case E.GRAPHMATRIXBUBBLESQUAREAM:case E.GRAPHMATRIXBUBBLESQUAREMM:N=["#abcffa","#7ca8de","#4570af","#224b8f","#0e3270"];M=[0.2,0.4,0.6,0.8];break;default:break;}return{colors:N,ranges:M};}});}());(function(){mstrmojo.requiresCls("mstrmojo.EnumRWUnitType","mstrmojo.DocDataService","mstrmojo.array","mstrmojo.hash");var A=mstrmojo,G=A.hash,E=A.array,C=A.EnumRWUnitType,F=A.DocDataService.REQUEST_DEFN_DATA;mstrmojo.vi.models._DataGridActions=mstrmojo.provide("mstrmojo.vi.models._DataGridActions",{_mixinName:"mstrmojo.vi.models._DataGridActions",createViewDataGrid:function D(a,g,I,L,K,j,R){var Y=false,d=this.dataService,X=function(){if(j){return j.k;}var n="K51";try{var m=this.getCurrentLayoutDef(),p=m.btsd||m.btn;if(p){n=p;Y=true;}else{if(this.getTargetDefn("K48").K48){n="K48";Y=true;}}}catch(o){}return n;}.call(this),Z=this.createNewUnitNode(function(m){m.gsi={cols:[],rows:[],mx:[]};return m;},function(n){n.t=C.GRID;var m=n.fmts;m.height="350px";m.width="600px";return new mstrmojo.Model(n);},null,Y?X:this.getNextKey()),h=Z.k,V=this.id,Q=this.getDocBuilder().build([Z],this,{pk:g,isViewDataGrid:true})[0],b=[{act:"changeXtabColWidthScenario",value:2}],P=this.getDataService().newUpdate(),f=0,U=0,W=[],l=[],k=j&&j.node.data,e=j&&G.copy(k),H;if(e){e.gsi=G.clone(k.gsi);mstrmojo.vi.util.ThresholdUtils.addClearAllThresholdsActions(j.model,{data:e},b);}(a||[]).forEach(function(m){b.push(Q.model.getAddTemplateUnitAction(m,m.dsId||K,m.t===4?2:1,m.t===4?U++:f++));});if(j&&R){l.push({act:"pivot",unitId:"",unitType:"",axis:2,unitPos:1});E.forEach(R.zones,function(m){if(m.id!==1){E.forEach(m.items,function(n){if(n.t===12){l.push({act:"pivot",unitId:n.did,unitType:12,axis:1,unitPos:1});}});}E.forEach(m.items,function(n){if(n.t===4&&n.did!=="-1"){W.push({unitId:n.did,unitType:4,regions:["g"]});}});});if(!Y){if(W.length>0){b.push({act:"formatGridZone",nodeKey:h,props:{FormattingPatterns:{FillColor:16777215,FillStyle:0},FormattingFont:{Color:6974058},FormattingAlignment:{Horizontal:4}},units:W,axis:[{axis:1,regions:["sg"]},{axis:2,regions:["sg"]}]});}b.push({act:"formatGridZone",nodeKey:h,props:{FormattingPatterns:{FillColor:16777215,FillStyle:0},FormattingFont:{Color:6974058},FormattingAlignment:{Horizontal:2}},units:[],axis:[{axis:1,regions:["g","sh"]}]},{act:"formatGridZone",nodeKey:h,props:{FormattingPatterns:{FillColor:15461355,FillStyle:0},FormattingFont:{Color:6974058},FormattingAlignment:{Horizontal:2}},units:[],axis:[{axis:1,regions:["h"]},{axis:2,regions:["h","g","sh"]}]},{act:"formatGridZone",nodeKey:h,props:{FormattingAlignment:{Horizontal:4}},units:[],axis:[{axis:2,regions:["h","g","sh"]}]});}b=b.concat(l);b.push({act:"advancedProperties",props:{"Template Formatting":{MergeCells:"0",MergeColumnCells:"0",LockColumnHeaders:"-1",LockRowHeaders:"0",Indented:0}}});}P.addActions(Y?d.getMoveNodeAction(Z,g):{act:"copyUnit",unitKey:X,unitType:521,newKey:h,toKey:g});P.addActions({act:"updateTemplate",keyContext:h,partialRetrieval:d.newRetrievalKeysConfig().addNode(h,{data:{exclude:{vfexpr:true}}}),actions:b});P.addActions(this.getUnitFormatAction(Z,1,{FormattingSize:{Height:0,Width:0}}));if(j&&R){H={act:"format",unitKey:h,unitType:521,formatType:1,format:{Visualization:{VisualizationsEnabled:0,ViewMode:0,SelectedVisualization:"",IPhoneVisualization:"",IPadVisualization:"",APhoneVisualization:"",ATabletVisualization:""},FormattingIncrementalFetch:{EnableIFOnGrid:-1},FormattingWidget:{ClassName:"",Enable:0,WidgetProps:""},FormattingPatterns:{FillColor:16777215,FillStyle:0},FormattingView:{Title:R.n||"Visualization"},FormattingBorder:{TopStyle:0,LeftStyle:0,BottomStyle:0,RightStyle:0}}};if(j.isSdp){H.format["FormattingAppearance"]={Visible:1};}P.addActions(H);}if(!G.isEmpty(I)){P.addActions(this.getKeepOnlyOrExcludeAction(h,I));}if(K){P.addActions({act:"editNode",nodeKey:h,datasetId:K});}if(j&&R){var c=j.parent.parent;E.forEach(c.getTargetKeysByType([C.SELECTOR]),function(q){var m=c.getUnitByKey(q).defn,n=m.srct,p=m.srcst,r=((n===47&&p!==12033)||n===1),o;if((m.tks||"").indexOf(j.k)>-1){o=this.dataService.getAddCtrlTargetAction(m.ck,h,null,r,true,true);delete o.partialRetrieval;P.addActions(o);}},this);var O=true,S,J=j.getFilterType()===1;E.forEach(c.getTargetKeysByType([C.GRID,C.GRAPH,C.MOJOVISUALIZATION]),function(n){var p=c.getUnitByKey(n).boxContent,o=p.defn.an,m=E.find(o,"k",j.k)!==-1,q;if(m){if(O){S=this.getNextKey();}q=p.findSelectorControl();if(q){P.addActions({act:"addVisToFilter",parentKey:n,targetKey:h,ctrlKey:q.ckey,newCGB:O,cgbKey:S});if(!J){O=false;}}}},this);}P.addActions({act:"changeGridDisplayMode",nodeKey:h,displayMode:1});P.addCallbacks({success:function M(n){var m=mstrmojo.all[V];m.partialUpdate(n.data,m.getTargetDefn(h),n.defn,n.pukeys&&n.pukeys.split("\u001E"),n.puFilters);L.success(Q);},failure:L.failure});P.addExtras(F);this.execute({execute:function N(){this.submitUpdate(P,mstrmojo.all[V].cmdMgr().CMD_PHASE.FIRST);}});return Y;},removeViewDataGrid:function B(H,X,J,Z){var P=this.cmdMgr(),Y=P.getInterimCmd(),S=this.getDataService(),M=S.newUpdateWithoutCmd(),U=H.zonesModel.getDropZones().zones,V=[],O=[];if(J){U.forEach(function(a){a.items.forEach(function(b){if(parseInt(b.did,10)!==-1){V.push(H.model.getRemoveTemplateUnitAction(b));}});});if(V.length>0){O.push({act:"updateTemplate",keyContext:H.k,actions:V});}O.push(S.getMoveNodeAction(H,"K12"));}else{O.push({act:"removeUnit",unitKey:H.k,unitType:H.defn.t});}if(!X){M.addCallbacks(Z);M.extras={params:{suppressData:true},config:{silent:false},style:{params:{treesToRender:0}}};M.addActions(O);Y.isUntracked=true;Y.submit(M.actions,M.callback,M.extras,P.CMD_PHASE.LAST);}else{var R=this.id,L,W,N,Q,I;M.addCallbacks(Z);if(X){W=this.createNewVizNode({title:mstrmojo.desc(11693,"Visualization")});N=this.getCurrentLayoutKey();Q=this.getPanel(null,N);L=Q.k;I=this.getDocBuilder().build([W],this,{pk:L})[0];M.addActions([{act:"macroCopyUnit",unitKey:H.k,unitType:521,newKey:I.k,toKey:L},mstrmojo.all[R].getUnitFormatAction(W,1,{FormattingView:{Title:mstrmojo.desc(11693,"Visualization")}})]);Q.insertNewBoxAndSaveDeferred(M,I);M.actions.forEach(function(a){delete a.partialRetrieval;});M.actions[0].partialRetrieval=S.newRetrievalKeysConfig().addNode(I.k);}M.addActions(O);M.addCallbacks({success:function K(d){var b=mstrmojo.all[R];b.partialUpdate(d.data,b.getTargetDefn(I.k),d.defn);var c=b.getCurrentLayoutKey(),a=E.filterOne(b.data.layouts,function(e){return(e.k===c);});b.updateDataCache({layouts:[a]},b.getTargetDefn(L));b.selectVIUnit(Q.rebuildChild(I).id);}});M.addExtras(F);Y.urInfo.extraPuKeys=[Q.k];Y.submit(M.actions,M.callback,M.extras,P.CMD_PHASE.LAST);}}});}());(function(){mstrmojo.requiresCls("mstrmojo.boxmodel","mstrmojo.DocDataService");mstrmojo.vi.models.PanelFormatSaver=mstrmojo.provide("mstrmojo.vi.models.PanelFormatSaver",{getPanelSaver:function A(C,B,D){return{saveProperty:function E(G,H){var J=B[G];if(J){if(J.convert){H=mstrmojo.boxmodel.px2Inches(C.getZoomProps(),H);}var I={},F=I[J.set]={};F[J.name]=H;C.updateUnitFormat(D||C.getRootNode(),1,I,undefined,mstrmojo.DocDataService.RAPID_EXEC);}}};}});}());(function(){mstrmojo.requiresCls("mstrmojo.DocDataService","mstrmojo.mstr.ElementDataService");mstrmojo.vi.factories.ModelFactory=mstrmojo.declare(mstrmojo.Obj,null,{scriptClass:"mstrmojo.vi.factories.ModelFactory",newDocumentDataService:function B(D){return new mstrmojo.DocDataService(D);},newElementDataService:function A(){return mstrmojo.mstr.ElementDataService;},newDataService:function C(D,E){return this["new"+D+"DataService"](E);}});}());(function(){mstrmojo.requiresCls("mstrmojo.hash","mstrmojo.func","mstrmojo.DocDataService","mstrmojo.mstr.EnumWebAPIErrorCodes");var G=mstrmojo.hash.copy,S=mstrmojo.func,X=S.wrapMethods,Y=mstrmojo.mstr.EnumWebAPIErrorCodes;var K=1,E=2,A=3;var P={FIRST:1,MIDDLE:2,LAST:3};var O={BUSY:1,INTERIM:2,DONE:3,SILENT:4,CANCELED:5};var F=G(mstrmojo.DocDataService.SUPPRESS_DATA,{preserveUndo:true,config:{silent:true}});function B(Z,b,a){if(b.stid==="undefined"){a.submission=function(f,c,d){var g=d.params,e=JSON.parse(g.params);e.actions[0].stid=Z.action===K?Z.undoStateId:Z.redoStateId;g.params=JSON.stringify(e);};}return a;}function H(a,e){var b=a.mgr;e.disablePU=true;var d=B(a,e,{success:function c(){a.state=O.DONE;},failure:function Z(){b.onFailure();}});a.state=O.SILENT;b.dataService.submitUpdates(e,d,F);b.onSuccess(a);}function W(k,e){var j=k.urInfo,h=j.puKeys,p=j.puObjs,f=j.puFilters,l=k.mgr,g=l.model,m=l.dataService;if(h||p){if(h){e.partialRetrieval={nodes:h,filters:f};}if(p){g.addUpdateObjects(e,p);}}else{e.disablePU=true;}var c=B(k,e,{success:function o(){k.state=O.DONE;l.onSuccess(k);g.restoreUIState(k.action===K?k.undoUIState:k.redoUIState);},failure:function b(){l.onFailure();},complete:function a(){l.resetState();}}),Z=j.callback||g.getRebuildCallback(),n=X(Z,c),d=G(j.extras);if(e.act==="undo"&&d!==undefined){d.hideCancel=true;if(e.killJob){d.message=mstrmojo.desc(14586,"Canceling...");}}k.state=O.BUSY;m.submitUpdates(e,n,d);}function M(c){var Z=c.urInfo,a=c.mgr.model;if(!Z.extras){var b=(Z.treesToRender!==undefined)?Z.treesToRender:c._treesFromRes;if(!Z.disablePU&&!c._hasFullUpdate&&(!Z.puKeys||!Z.puKeys.length)){b=0;Z.callback=X(a.getDatasetsUpdateCallback(),Z.callback);}Z.extras={style:{params:{treesToRender:b}}};}}mstrmojo.vi.controllers.UICmd=mstrmojo.declare(null,null,{scriptClass:"mstrmojo.vi.controllers.UICmd",mgr:null,redoStateId:null,undoStateId:null,execute:mstrmojo.getMissingFn(),discard:mstrmojo.emptyFn,isUntracked:false,action:null,state:O.INTERIM,urInfo:null,getStateValue:function V(a,Z){return this.action===K?Z:a;},init:function Q(Z){G(Z,this);this._treesFromRes=0;this.urInfo=this.urInfo||{};this.submitCount=0;},undoRedo:function I(f){var b=this,d,a=this.urInfo,Z=a.silent,g,c=this.mgr,e=c.dataService;if(b.action===A){d={act:"redo",stid:b.redoStateId};g=a.redo;}else{if(b.action===K){d={act:"undo",stid:b.undoStateId,killJob:f};g=a.undo;}else{c.handleError();}}if(g){e.blockRequests=true;try{Z=!!g.call(b)||Z;}finally{e.blockRequests=false;}}if(Z){H(b,d);}else{W(b,d);}},submitUpdate:function J(a,Z){this.submit(a.actions,a.callback,a.extras,Z);},submit:function L(d,o,c,m){var j=this,k=j.mgr,f=k.model,l=k.dataService,h=mstrmojo.array.ensureArray(d);o=o?G(o):f.getRebuildCallback();j.state=O.BUSY;function e(p,q){return !(p&&p[q]&&p[q].length);}if(j._hasFullUpdate||h.some(function(p){return p.disablePU;})||h.every(function(q){var r=q.partialRetrieval,p=q.partialUpdate;return e(r,"nodes")&&e(p,"nodes")&&e(p,"selectors")&&e(p,"objects");})){j._hasFullUpdate=true;}S.override({submission:function b(){if(j.submitCount===0){j.undoStateId=l.stid;}j.submitCount++;},success:function n(u,v){if(j.action!==E){k.handleError();}j.redoStateId=u.stid;var t=!m||m===P.LAST;if(t){j.state=O.DONE;}else{j.state=O.INTERIM;}var r=j.urInfo;if(!r.disablePU){var p=r.puKeys||[],w=u.pukeys&&u.pukeys.split("\u001E");if(w&&w.length){p=p.concat(w);var q=r.extraPuKeys;if(q){p=p.concat(q);delete r.extraPuKeys;}}if(p.length){r.puKeys=p;}}j._treesFromRes|=(u.defn?1:0)|(u.data?2:0);if(this._super){this._super(u,v);}if(t){j.completeSubmit();}},failure:function a(p,t){var r=(c&&c.skipUICmdMgrOnFailure)||[],q=parseInt(p.code||(p.getResponseHeader&&p.getResponseHeader("X-MSTR-TaskErrorCode")||Y.UICMD_DEFAULT_ERROR),10);if(r.indexOf(q)===-1&&r.indexOf(mstrmojo.mstr.EnumWebAPIErrorCodes.E_UNUSED)===-1){k.onFailure();}if(this._super){this._super(p,t);}},canceled:function g(p){if(this._super){this._super(p);}window.setTimeout(function(){j.cancel(true);},0);},complete:function Z(){if(!m||m===P.LAST){k.resetState();}if(this._super){this._super();}}},o);l.submitUpdates(d,o,c);},submitInterim:function R(a,b,Z){this.submit(a,b,Z,P.MIDDLE);},resetCmdMgrOnComplete:function C(){this._resetMgr=true;},completeSubmit:function N(){var a=this,b=a.mgr,Z=b.model;if(!a.completed){a.completed=true;a.state=O.DONE;b.onSuccess(a);M(a);a.redoUIState=Z.getUIState();if(a.isUntracked){b.untrackLastCmd();}else{if(a._resetMgr){b.reset();}}}},cancel:function D(Z){this.state=O.CANCELED;if(this._hasFullUpdate){this._treesFromRes=3;}M(this);this.mgr.onCancel(this,Z);},submitSilent:function U(b){var d=this,e=d.mgr,c=e.model,f=e.dataService;d.state=O.SILENT;e.onSuccess(d);d.redoUIState=c.getUIState();var g={submission:function a(){d.undoStateId=f.stid;d.submitCount++;},success:function h(j){d.state=O.DONE;d.redoStateId=j.stid;},failure:function Z(){e.onFailure();}};f.submitUpdates(b,g,F);}});mstrmojo.vi.controllers.UICmd.CMD_PHASE=P;mstrmojo.vi.controllers.UICmd.CMD_STATE=O;mstrmojo.vi.controllers.UICmd.CMD_ACT_TYPE={UNDO:K,EXEC:E,REDO:A};}());(function(){mstrmojo.requiresCls("mstrmojo.hash","mstrmojo.array","mstrmojo.DocDataService","mstrmojo.mstr.EnumFunction","mstrmojo.warehouse.EnumDatabaseType","mstrmojo.mstr.EnumDSSXMLObjectTypes");mstrmojo.requiresDescs(5421,5422,13355);var P=mstrmojo.hash,L=mstrmojo.array,F=mstrmojo.desc,G=mstrmojo.DocDataService,C=mstrmojo.string,a=mstrmojo.mstr.EnumFunction,b=mstrmojo.mstr.EnumDSSXMLObjectTypes;var c=1;function K(n,d,t,v){var g=n.model,p=n.cmSelCells,u=[],AE=g.getCellTitleInfo(d).title,AG,x,j=function(e){var w=n.getCellForNode(e);u.push(n.getCellUnitIndex(w));AG=w.dpt;},o,AB=d.lv>=0,AH;if(typeof v==="string"&&v.indexOf(";")>0){x=parseInt(v.substring(v.indexOf(";")+1),10);v=parseInt(v.substring(0,v.indexOf(";")),10);}if(x===1&&!t){p.reverse().forEach(j);}else{if(x===1){o=1;p.forEach(j);}else{p.forEach(j);}}AH={oId:AE.id,oTp:AE.otp,depth:AG,ordinals:u.join(","),sliceId:n.sid,viewKey:n.k,funcVal:v,switchOrder:o,art:g.getObjectInfoFromDataset(AE.id).art,isRA:AB};if(AB&&v===a.FunctionApplySimple){var r=g.docModel.datasets[g.data.datasetId];if(r&&r.tables&&r.tables.length>=0&&r.tables[0].dbt===mstrmojo.warehouse.EnumDatabaseType.EssBase){AH.peName=AE.v||AE.n;}else{var k=n.getCellForNode(p[0]),AF=k._e.id;AH.peId=AF;AH.peName=k._e.ori_n||k._e.n;try{if(AE.fix>=0){var h=g.docModel.findUnitInDataSet(AE.id).fs,m=L.filterOne(h,function(e){return e.fnm==="DESC";}).fid;if(m){var AC=n.dataBlocks&&n.dataBlocks[k._gd]||g.data,AA=AC.gts[(AE.axis===c)?"row":"col"],l=L.filterOne(AA,function(e){return e.id===AE.id&&e.fid===m;}),AD=l.es[k.idx];AH.peName=AD&&(AD.ori_n||AD.n)||AH.peName;}}else{var q;L.forEach(AE.fs,function(w,e){if(w.n==="DESC"){q=e;return false;}});if(q!==undefined){var f=[];if(AE.axis===c){var z;for(z=k.idx;z>-1;z--){if(AE.es[z].id===AF){f=[AE.es[z].ori_n||AE.es[z].n].concat(f);}else{break;}}for(z=k.idx+1;z<AE.es.length;z++){if(AE.es[z].id===AF){f.push(AE.es[z].ori_n||AE.es[z].n);}else{break;}}}else{f=L.map(L.filter(AE.es,function(w){return w.id===AF;}),function(w){return w.ori_n||w.n;});}AH.peName=f[q]||AH.peName;}}}catch(AD){}}}return AH;}function D(f,e,h){var l=f.getDEInfo(e),k=l&&l.deObject&&l.deObject.des,j=1,g=h===-1?F(5187,"Group"):(h===a.FunctionApplySimple?F(13355,"Calculated Member"):F(5188,"Calculation")),d=function(m){return m.n===g+" "+j;};while(true&&k){if(k.some(d)){j++;}else{break;}}f.controller.onAddQuickDE(f,P.copy(K(f,e,false,h),{act:"addQuickDE",deName:g+" "+j}));}function Z(d,f){var e;for(e in d){if(L.find(d[e].att,"did",f)>-1){return e;}}return undefined;}function X(d){var f=d.split(";"),e;if(f.length>1&&f[f.length-2].slice(-1)!=="//"){f.splice(-1,1);}e=f.join(";");return e.replace(/\\:/g,"*:").replace(/\\;/g,";").replace(/\\\\/g,"\\").substring(1);}function A(q,e,m,h,d){var l=m.es,f=m.id,k;d.forEach(function(r){k=r[0];if(k.eid.indexOf(f)<0){l.push({n:C.decodeHtmlString(k.v,true),t:mstrmojo.vi.enums.EnumDerivedElementType.LIST,v:X(k.eid)});}});var g=q.controller,p=q.model&&q.model.docModel,o=g._getXtabCallback(q),j={act:"applyDEChanges",deId:e.did,attId:e.attId,attName:e.attName,dsId:e.dsId,k:q&&q.k,actions:[V(m,h)]};p.addUpdateObjects(j,{id:j.deId||j.attId,type:47,flag:G.PARTIAL_UPDATE_FLAGS.DATA_CHANGE});o=mstrmojo.func.wrapMethods(o,p.getDatasetsUpdateCallback(),p.getUpdateHiddenLayoutsCallback(),{success:function(){p.callOnNDECreated([m]);}});var n=function(r){return function(){if(j&&r){j.partialRetrieval={nodes:Y(q,p,e)};}var t=r?p.wrapUnsetVisualizationFilterAction(j):j;g.submitUndoRedoUpdates(t,{},o,G.REQUEST_DEFN_DATA);};};p.checkAndNotifyVFChangeOnGroupUpdate({actions:j},n(true),n(false));}function V(e,d){return{act:"update",position:d+1,item:e};}function E(f,e,j,h,g){var d=f.model.getCellTitleInfo(e).title;f.controller.onSetDEHierachyOptions(f,{act:"setDEHierarchyOptions",oId:d.id,eId:j.id,splice:h,expand:g});}function O(h,e){var d=[],g=e.t,f=e.did;h.getDropZones().zones.forEach(function(j){((j&&j.items)||[]).forEach(function(l){var m=l.t,k=l.did;if(m!==21&&k!=="-1"&&k!=="00000000000000000000000000000000"&&((m===4&&g===4)||(m!==4&&g!==4))&&k!==f&&L.find(d,"did",k)===-1){d.push(l);}});});h.docModel.getDatasetUnits(g===4?["mx"]:["att"]).forEach(function(j){if(L.find(d,"did",j.did)===-1&&j.did!==f&&!j.hide){d.push(j);}});return mstrmojo.vi.ui.DatasetUnitMenuUtils.getSortedDatasetUnits(d);}function Y(g,d,f){var e=d.getSourceFilterKeys(g.zonesModel.getHost().k);L.forEach(g.parent.parent.children,function(k){var h=k.boxContent.gridInfo;if(h){var l=(h.rows.concat(h.cols)).some(function(m){return m.did===f.did;}),j=e.some(function(m){return m===k.k;});if(l&&!j){e.push(k.k);}}});return e;}mstrmojo.vi.ui.rw._XtabDE=mstrmojo.provide("mstrmojo.vi.ui.rw._XtabDE",{scriptClass:"mstrmojo.vi.ui.rw._XtabDE",derivedElementGroup:function M(d){D(this,d,-1);},addElementsToGroup:function N(f,g,e,d){A(this,f,g,e,d);},derivedElementCalculation:function B(e,d){D(this,e,d);},separateOthers:function Q(d,e){E(this,d,e,1,1);},renameDEList:function I(d){this.controller.onEditQuickDEList(this,P.copy(K(this,d,true,-1),{act:"editQuickDEList",deName:d.v}));},editQuickDECalculationNumberFormat:function J(e,f){var d=K(this,e);d.deId=f.de.id;d.act="editQuickDECalculationNumberFormat";this.controller.editQuickDECalculationNumberFormat(this,P.copy(d,this.model.docModel.createNumberFormatParams(f)));},editDECalculation:function H(e,d){if(d!==undefined&&d!==null){this.controller.editQuickDECalculation(this,P.copy(K(this,e,true,d),{act:"editQuickDECalculation"}));}else{this.controller.onEditQuickDECalculation(this,P.copy(K(this,e,true),{act:"editQuickDECalculation",deName:e.v}));}},createDEParam:function K(d,f,e){return K(this,d,f,e);},removeQuickDE:function S(l,p){var h=p&&p.deObject,j=(h&&h.des)||[],q=this,r=2,o=L.filter(j,function(u){return !u.ido;},{max:r+1});if(h&&(j.length<=r||o.length<=r)){var k=[],n=this.zonesModel.getZoneForObject(h.did),f=O(this.zonesModel,h),e=L.find(f,"did",h.attId),d=e>=0?f[e]:null,m={};if(d&&n){k.push(P.copy({isUngroup:1,deId:h.did},this.model.getAddTemplateUnitAction(d,h.dsId,n.id,L.find(n.items,"did",h.did))));k=[this.zonesModel.getUpdateTemplateAction(k)];m=this.controller._getXtabCallback(this);}k.push({act:"removeNDEFromDS",dsid:h.dsId,oid:h.did,disablePU:true});m=mstrmojo.func.wrapMethods(this.controller.model.getDatasetsUpdateCallback(),this.controller.model.getReloadLayoutModelCallback(),m,this.controller.getReloadLayoutViewCallback());var t=q.model&&q.model.docModel;var g=function(u){return function(){var v=(u&&t)?t.wrapUnsetVisualizationFilterAction(k):k;q.controller.submitUndoRedoUpdates(v,null,m,G.REQUEST_DEFN_DATA);};};t&&t.checkAndNotifyVFChangeOnGroupUpdate({actions:k,zm:t},g(true),g(false));}else{this.controller.removeQuickDE(this,P.copy(K(this,l),{act:"removeQuickDE"}));}},derivedElementsEdit:function U(m,g){if(!g){g=this.getDEInfo(m);}var h=this.model,e=h.getCellTitleInfo(m).title,f=g&&g.deObject,l=g&&g.de,d,k,j;if(!f){d=this.gridData.datasetId||Z(h.docModel.datasets,e.id);k=e.id;j=e.n?C.decodeHtmlString(e.n):undefined;}this.controller.openDEEditor(this,{dsId:d,attId:k,attName:j,deObj:f,elemId:l&&l.id,dispName:m.n?C.decodeHtmlString(m.n):j});},getDEInfo:function W(m){var g=this.model,j=g.getCellTitleInfo(m),k=j.isSrcTitle,e=j.title,d=m.dei,f,l;if((e&&e.ost!==12033)||(k&&m.otp!==b.Consolidation)){return null;}var h=(e&&e.id)||(k&&m.otp===b.Consolidation&&m.id);f=g.docModel.getDEObject(h);if(f&&d!==undefined){l=f.des[d];}return{deObject:f,de:l,ttl:e};},getOthersDEInfo:function R(e){var d;L.forEach(e.des,function(f){if(f.t===4){d=f;return false;}});return d;}});}());(function(){mstrmojo.requiresCls("mstrmojo.hash","mstrmojo.EnumRWUnitType","mstrmojo.DocDataService","mstrmojo.func","mstrmojo.array","mstrmojo.vi.viz.KnownVisualizations","mstrmojo.VisEnum","mstrmojo.vi.viz.EnumVizStyles","mstrmojo.vi.controllers.ControlUtils","mstrmojo.vi.controllers.EnumEvents","mstrmojo.gmaps.EnumGraphicType");mstrmojo.requiresClsP("mstrmojo.vi.models","EnumPanelTypes");var h=mstrmojo.array,P=mstrmojo.hash,m=mstrmojo.func,j=mstrmojo.EnumRWUnitType,O=mstrmojo.vi.models.VIComponentMap.TYPES,Y=mstrmojo.vi.viz.KnownVisualizations,a=mstrmojo.vi.models.EnumPanelTypes,E=mstrmojo.vi.viz.EnumVizStyles,B="\u001E",D=mstrmojo.DocDataService.REQUEST_DEFN_DATA,I=mstrmojo.DocDataService.SUPPRESS_DATA,F=mstrmojo.vi.controllers.ControlUtils,V=mstrmojo.VisEnum.VIS_CARDLIMIT.NON_GRID,C=mstrmojo.vi.controllers.EnumEvents;var J=4,Q=[Y.HEATMAP];function H(r){r=r||{};return this.createNewUnitNode(function(t){t.eg="";if(r.fnData){t=r.fnData(t);}return t;},function(t){t.t=j.GRID;t.n=r.n||"";t.ttl=r.title||t.n;t.ds=0;t.tt=1;t.eo=0;if(r.fnDefn){t=r.fnDefn(t);}return new mstrmojo.Model(t);},r.fnNode,r.nodeKey,r.layoutKey);}function c(x,z,w,u,AA,AC){var AB=x.getDataService(),v=z.boxContent,r=x.getMapLayerKeys(v),t=[];h.forEach(r,function(AE){var AG,AD=x.getLayoutUnitDefn(AE),AF={k:AE,defn:{t:AD.t||522}};if(w){u.addActions(AB.getMacroMoveNodeAction(AF,AA));}else{AG=x.getNextKey();t.push(AG);u.addActions(AB.getMacroCopyNodeAction(AF,AA,AG));}});if(t&&AC){u.addActions(x.getFormatSDPAction(AC,t));}return t;}function R(AN,AG,w,AE,AO){var t=AG.k,AK=w.k,AI=AG.parent.children,AM=[],AC=AG.boxContent,z=AC.getFilterType()===1,AD=true,AH,v,AL=AN.getDataService(),u=[AK].concat(AO||[]);h.forEach(AI,function(AR){var AQ=AR.defn.an,AP=h.find(AQ,"k",t)!==-1,AS;h.forEach(u,function(AT){if(AD){AH=AN.getNextKey();}if(AP){AS=AR.boxContent.selectorControl;AM.push(AR.k);AQ.push({k:AT,muc:24});AE.addActions({act:"associateNodes",nodeKey:AR.k,targetKeys:[AT],partialRetrieval:AL.newRetrievalKeysConfig().addNode(AR.k)});if(AS){AS.cgb[P.keyarray(AS.cgb).length+1]=AH;AE.addActions({act:"addVisToFilter",parentKey:t,targetKey:AT,ctrlKey:AS.ckey,newCGB:AD,cgbKey:AH});}}});if(!z){AD=false;}});if(AC&&AC.selectorControl){var AF=AN.getCurrentLayoutDef().cgbMap,AJ=[],AA=[],r=AC.selectorControl,x=function(AP){var AQ;P.forEach(AF,function(AR,AS){if(P.valarray(r.cgb).indexOf(AS)!==-1&&AP===AR){AQ=AS;}});return AQ;},AB;u=[];v=(r.tks||"").split("\u001E");v.forEach(function(AP){var AT,AR,AQ,AS=(AI.filter(function(AU){return AU.k===AP;}))[0];if(AS){AB=AS.boxContent.getFilterType();}if(AB===1){u.push(AP);AT=AN.getNextKey();AF[AT]=AP;AJ.push([AT,true]);AR=x(AP);P.forEach(r.cgb,function(AV,AU){if(AV===AR){AQ=AU;}});if(AQ){r.cgb[AQ]=AT;}AA.push([AR,false]);}});if(u.length){AE.addActions({act:"replaceControlCGB",oldCGBNodeKey:AA,targetKeys:u,newCGBNodeKeys:AJ,controlKey:AC.selectorControl.ckey,sourceKey:t});}}if(AM.length>0){AE.addCallbacks({success:function(AP){AN.partialUpdate(AP.data,AN.getTargetDefn(AM),AP.defn,AM);}});}}function n(v,w,t,u,r,x){v.execute({execute:function(){var AT=v.getDataService(),AN=v.cmdMgr(),AV=this,AO=v.controller.view,AK=AT.newUpdate(),AM=w.parent,AQ=AM.k,AD=v.getCurrentLayoutKey(),Aa,AL=r===AD,AB=w.k,AS,AR,AU,AP,AE;if(x&&w.boxContent&&w.boxContent.updateAssociatedNodesOnMove){w.boxContent.updateAssociatedNodesOnMove();}if(AL){AP=!!u;if(!AP){Aa=v.addPanel(AK,t.k);u=Aa.k;AU=true;var AH=t.id,AX=t.parent.id,AJ=t.k,AA=function(){this.urInfo.puKeys=[AJ];}.bind(this);this.urInfo=P.copy({undo:function(){AA();var Ab=v.getLayoutUnitDefn(u,r);if(Ab){Ab._isDeleted=true;}this.urInfo.extras.style.params.treesToRender=3;},redo:function(){AA();var Ab=v.getLayoutUnitDefn(u,r);if(Ab&&Ab._isDeleted){delete Ab._isDeleted;}},callback:m.wrapMethods({success:function(Ab){v.controller.view.updateXtabStyles(r,Ab.data.layouts[h.find(Ab.data.layouts,"k",r)].xtabStyles);v.updateDefnCache(Ab.defn,[AJ,AQ,u]);v.updateDataCache(Ab.data,v.getTargetDefn(AJ));var Ac=mstrmojo.all[AX];Ac.rebuildChild(mstrmojo.all[AH]);Ac.doLayout();v.raiseEvent({name:C.UPDATE_TOC});}},v.getRebuildCallback())},this.urInfo);}else{Aa=v.getPanel(u);AU=u===AQ||Aa.defn.l;if(u!==AQ){this.urInfo=P.copy({undo:function(){this.urInfo.puKeys=[AQ];},redo:function(){this.urInfo.puKeys=[u];},callback:m.wrapMethods({success:function(){v.getPanel(AQ).unload();v.getPanel(u).unload();}},v.getRebuildCallback()),treesToRender:3},this.urInfo);}}AR={parentKey:u};}else{if(r){AU=false;AP=true;v.markDirtyLayout(r);AO.showLayout(AO.getLayout(r),null,AK);AR={layoutKey:r,analysisSectionType:a.VISUALIZATION};AV.urInfo=P.copy({callback:m.wrapMethods({success:function(){if(x){v.markDirtyLayout(AD);}v.markDirtyLayout(r);}},v.getRebuildCallback())},this.urInfo);}else{AU=false;AP=false;r=v.getNextKey();u=v.getNextKey();AE=AN.CMD_PHASE.FIRST;AO.addNewLayout(AK,-1,{nodeKey:r,newPanelKey:u,analysisSectionType:a.VISUALIZATION});AR={parentKey:u};AV.urInfo=P.copy({callback:F.rebuildAndUpdateTOCcallback.call(v)},AV.urInfo);}}if(x){AS=AB;var z=v.getTargetDefn(AB)[AB];if(z&&z.gi){var AG=z.gi,AI=v.id,AZ=function(Ab){var Ac=mstrmojo.all[AI];if(Ac){var Ad=Ac.getTargetDefn(AB)[AB];if(Ad){if(Ab){Ad.gi=AG;}else{delete Ad.gi;}}}};m.wrapMethods({undo:function(){AZ(true);},redo:function(){AZ(false);}},AV.urInfo);delete z.gi;}if(!AM.hasMultipleChildren()){var AW=v.addVisualizationDeferred(AK,AQ).k;AK.addCallbacks({success:function(Ab){var Ac=null;h.forEach(Ab.defn.layouts,function(Ad){if(Ad.k===AD){Ac=Ad.units[AW];return false;}});v.getLayoutDefn(AD).units[AW]=Ac;}});}AM.deleteBoxAndSubmitDeferred(AK,w,undefined,true,true);AK.addActions(AT.getMacroMoveNodeAction(w,AR));c(v,w,x,AK,AR);if(AU){w.unrender();Aa.insertNewBoxAndSaveDeferred(AK,w);AK.addCallbacks({success:function(Ac){var Ab=[u,w.k];v.updateDefnCache(Ac.defn,Ab);v.updateDataCache(Ac.data,v.getTargetDefn(Ab.join(B)));Aa.rebuildChild(w);}});}else{if(!AL){v.markDirtyLayout(AD);}w.destroy();}}else{var AC=H.call(v,{n:w.title,layoutKey:r}),AY;AS=AC.k;AK.addActions(AT.getMacroCopyNodeAction(w,AR,AS));AY=c(v,w,x,AK,AR,AC);if(AU){var AF=v.createUnit(AC,u);v.deferredInsertUnit(AK,AF,u);if(AQ===u){R(v,w,AF,AK,AY);this.urInfo.puKeys=[AQ];}}}if(AL){if(!AP){v.selectNewPanel(AK,u);}else{if(AQ!==u){t.selectPanelDeferred(AK,u);}}}if(AP){if(!AU){AE=AN.CMD_PHASE.FIRST;AK.addCallbacks({success:function(){Aa=v.getPanel();var Ac=Aa.getUnitByKey(AS),Ab=AN.getInterimCmd();if(!Aa.hasBoxLayoutChild(Ac)){Aa.insertNewBox(Ac);}if(Aa.defn.layoutXML){Aa.saveBoxLayout(Ab,AN.CMD_PHASE.LAST,null,null,true);}else{Aa.saveBoxLayout(Ab,AN.CMD_PHASE.LAST,null,null,true);}}});}AK.addCallbacks({success:function(){var Ab=Aa.getUnitByKey(AS);Ab.selectVIUnit();},complete:function(){Aa.restoreAnyMaxedVizBox();}});}AK.addExtras(D);this.submitUpdate(AK,AE);},urInfo:{treesToRender:3}});}function K(AD,AC,x,u,v,AF){var z=this,AE=[],AB=[],AG,t,r=[],AH=this.getCGBMap(),AA=function(){return h.filter(P.keyarray(AH),function(AI){return v.indexOf(AH[AI])>-1;});},w;if(x){x.forEach(function(AI){AE.push(AI.k);});AG={act:"clearVisAsFilter",nodeKey:u,associatedNodes:AE,partialRetrieval:{nodes:AE}};if(AC){h.forEach(P.valarray(AC.cgb),function(AI){r.push([AI,z.getSourceControls(AD,AI).length<=1]);});AG.cgbNodeKeys=r;AG.controlKey=AC.ckey;}t=AF?{success:function(AI){z.partialUpdate(AI.data,z.getTargetDefn(AE));}}:m.wrapMethods(this.associatedNodesUpdate([AD]).callback,this.controller._getXtabCallback(AD.boxContent));AB.push(AG);}if(AF){w=AA();h.forEach(w,function(AR){var AQ=AH[AR],AI=z.getSourceControls(AD,AR),AK=false,AN,AO,AL,AS,AP,AM,AJ;delete AH[AR];h.forEach(AI,function(AT){AL=AT.bc;AJ=AT.control;AS=AL&&AL.isVisMap;AP=AS?AL.getKeyForTemplateSelection():AT.sourceKey;AM=AS?AL.getWidgetForTemplateSelection().node:AL.node;AN=AJ.tks.split("\u001E");AG={act:"clearVisAsFilter",nodeKey:AP,associatedNodes:[AQ],cgbNodeKeys:[[AR,!AK]],controlKey:AJ.ckey,removeControl:AN.length===1,partialRetrieval:{nodes:[AP]}};AK=true;if(AN.length>1){AO=P.valarray(AJ.cgb);AO.splice(AO.indexOf(AR),1);AJ.cgb={};h.forEach(AO,function(AV,AU){AJ.cgb[AU]=AV;});AN.splice(AN.indexOf(AQ),1);AJ.tks=AN.join("\u001E");if(AM.defn&&AM.defn.an){AM.defn.an.splice(h.find(AM.defn.an,"k",AQ),1);}}else{delete AM.data.sc;delete AM.defn.an;delete AL.selectorControl;}AB.push(AG);});});}if(AB.length>0){return{actions:AB,callback:t,extras:{style:{params:{treesToRender:AF?2:3}}}};}}mstrmojo.vi.models._VisActions=mstrmojo.provide("mstrmojo.vi.models._VisActions",{_mixinName:"mstrmojo.vi.models._VisActions",createNewVizNode:H,addVisualizationDeferred:function(z,x,t){var r=this,w=mstrmojo.desc(11659,"New Visualization"),v=r.createNewUnitNode(null,null,null,null,t);t=t||this.getLayoutKeyByUnitKey(x);P.copy({t:j.GRID,ttl:w,n:w,ds:0,tt:1,eo:0},v.defn);v.data.eg="";var u=r.createUnit(v,x,t);z.addActions([r.getCopyEmptyTemplateAction(u.k,x,t)]);r.deferredInsertUnit(z,u,x);z.actions.some(function(AA){if(AA.unitKey===u.k){AA.partialRetrieval={nodes:[u.k]};return true;}});z.addExtras(D);return u;},addVisualization:function N(){var r=this,t,u,v=this.getPanel().k;r.execute({execute:function(){var x=r.getDataService(),z=x.newUpdate(this);var w=r.addVisualizationDeferred(z,v);t=w.k;u=w.boxContent.node;this.submitUpdate(z);},urInfo:{treesToRender:3,undo:function(){this.urInfo.puKeys=[];this.urInfo.callback={};var x=r.getUnitInstance(v,1),w=x.getUnitByKey(t),AA=r.getLayoutUnitDefn(t),AB=r.getLayoutUnitDefn(AA.pnk),z=AB.layoutXML;AA._isDeleted=true;z.children=z.children.filter(function(AC){return AC.k!==t;});x.removeChildren(w);w.destroy();r.restoreUIState(this.undoUIState);return true;},redo:function(){this.urInfo.puKeys=[t];this.urInfo.callback={success:function(x){var AA=r.createUnit(u,v),w=r.getUnitInstance(v,1),z=r.getLayoutUnitDefn(t);if(z){delete z._isDeleted;}w.addChildren(AA);w.boxLayoutConfig.dirty=true;r.partialUpdate(x.data,r.getTargetDefn([t]),x.defn,[t]);w.rebuildChild(AA);}};return false;}}});},duplicateVisualization:function W(u){var r=this.getCurrentLayoutKey(),t=u.boxContent.builder.getLayoutVIMap(r).getComponent(O.VIZ_CONTENT);n(this,u,t,t.selectedKey,r,false);},copyVisualization:function(v,t,u,r){n(this,v,t,u,r,false);},moveVisualization:function(v,t,u,r){n(this,v,t,u,r,true);},renameRWUnitTitle:function p(u,t,r,v){this.updateTitle(u,t,r,this.currlaykey,"ttl",v);},changeSelectedVisType:function k(AV,AP,AC,AH){var AR=this.getSelectedViUnit();if(!AR){return ;}var AK,v=this,AQ=[],AI=AR.boxContent,AS=AI.k,Aa=AI.node.data,AX=Aa.visName,AY=(typeof AI.getVisType==="function"?AI.getVisType():{}).vt,x=typeof AP==="object"?[AP.v,AP.h]:[AP],AZ=AX||"",t=AX===E.ESRI_MAP||AX===E.GOOGLE_MAP||AX===E.MAPBOX,AN=Y.getDefinition(AV),AA=this.controller.visTransitionFactory.newVisualizationTransition(AV||"Grid",{vis:AI,newVizInfo:{s:AV,dz:AH}});if(AZ===AV){var r=AA.isGraphMatrix(AY)||AA.isGraphMatrix(x[0]);if(r&&(x[0]!==undefined&&AY===x[0]||x[1]!==undefined&&AY===x[1])){return ;}else{if(!r){return ;}}}if(t){AK=this.getMapLayerKeys(AI);AQ=this.getExtraActionsForChangeMapViz(AI,AK,AQ);}if(Y.getDefinition(AX||"Grid").id===Y.GRID&&Q.indexOf(AN.id)===-1){var z=[];AA.addClearAllThresholdsActions(z);AQ.push({act:"updateTemplate",keyContext:AI.k,actions:z});}if(AV!==""&&AN.id!==Y.UNKNOWN){AQ.push({act:"updateTemplate",keyContext:AI.k,actions:[{act:"createDefaultDropZones",nodeKey:AI.k,treeType:AI.defn.tt,datasetId:Aa.datasetId,datasetType:3,widgetType:AC,partialUpdate:{nodes:[AI.k]}}]});}var AM=AA?AA.transitionDropZones(AQ,AP):{wp:""},AF=AM.wp,u=AM.wgtName,AE=AM.handled,AJ=[],AG=AA&&AA.vis,AU=(AG&&AG.node&&AG.node.data&&AG.node.data.gts)||{},AL=(AU.col||[]).concat(AU.row||[]);if(AC){h.forEach(AL,function(w){AJ.push(w);});}var AB=[],AW={},AT,AD=function(Ab){if(!Ab.id){Ab.id=Ab.did;}var w=Ab.id;AW[w]=Ab.card;};P.keyarray(this.datasets).forEach(function(w){AB.push(w);});for(AT=0;AT<AB.length;AT++){h.forEach(this.datasets[AB[AT]].att,AD);}h.forEach(AJ,function(w){if(!w.id){w.id=w.did;}if(!w.cardg&&!w.card){w.card=AW[w.id];}});var AO=AM&&AM.gtp;AA.vis.zonesModel.addAttributeNameAndTargetVisForAddUnits(AG.node.data,AJ,AV,AO,AM&&AM.ln);AA.vis.zonesModel.checkAndWarnLargeItemsForAddUnits(AJ,function(Ak,Ab){if(AF.length>0&&!AE){var Am=this.getWidgetClassNameByStyle(AV,AC),Ad=u?({FormattingAppearance:{Name:u}}):undefined,Ac=D,Af=function(w){if(t&&AK&&AK.length>0){v.syncLayerDefn(AS,AK,w);}},Ae={undo:function Ai(){Af(false);},redo:function Ag(){Af(true);}},Al=Ab.k;AQ.push(this.getUnitChangeVizAction(AV,Am,Ab,AF,Ad));AQ.push({act:"changeGridDisplayMode",nodeKey:Al,displayMode:AV===E.GRAPH_MATRIX?2:1});if(AV==="KPICardVisualizationStyle"){AQ.push(this.getDataService().getUpdateTemplateAction(AS,{act:"clearSort"}));}if(Ak.model.data.eg!==undefined){Ac=P.copy(Ac,{preserveUndo:true});}var Ah=this;var Aj=function(w){var An=[].concat(AQ);if(w){An=Ah.wrapUnsetVisualizationFilterAction(AQ);}Ah.controller.submitUndoRedoUpdates(An,null,{success:function Ao(Ax){var Ap=Ah.getCurrentLayoutKey(),Au,Aq=Ah.getPanel();Ah.refreshDefinition(Al,Ah.getRawLayoutUnitDefn(Al,Ax.defn));Ah.updateDataCache(Ax.data,Ah.getTargetDefn(Al));if(w){var Ay=Ah.getSelectedViUnit(),As=Ay&&Ay.boxContent,Ar=As&&As.k,Av=Ax.pukeys,At=Av&&Av.split("\u001E"),Aw=(At&&At.indexOf(Ar))||-1;if(Ar&&Aw!==-1){At.splice(Aw,1);Av=At.join("\u001E");}if(Av){Au=v.getUnitDefinitions(Av);}Ah.partialUpdate(Ax.data,Au,Ax.defn,At,Ax.puFilters);}if(Ax.data){Ax.data.layouts.some(function(A0){var Az=A0.k===Ap;if(Az){Ah.controller.view.updateXtabStyles(Ap,A0.xtabStyles);}return Az;},Ah);}if(mstrApp.isInVFConfigMode){Ah.selectVIUnit(Ah.rebuildVizBox(Al).id,true);}else{Ah.selectVIUnit(Aq.rebuildChild(Aq.getUnitByKey(Al)).id,true);}}.bind(Ah)},Ac,Ae);};Ah.checkAndNotifyVFChangeOnVisTypeUpdate({},function(){Aj(true);},function(){Aj(false);});}}.bind(this,AI,AR),null,!AC,null,false,V);},getUnitChangeVizAction:function Z(AA,r,z,x,u){var t=Y.getDefinition(AA);var w={IPhoneVisualization:"",IPadVisualization:"",APhoneVisualization:"",ATabletVisualization:""};if(t&&t.mobileVIStyles){w=P.copy(t.mobileVIStyles,w);}var v={Visualization:P.copy(w,{VisualizationsEnabled:AA?-1:0,ViewMode:AA?51:0,SelectedVisualization:AA||"",VisualizationList:AA||""}),FormattingIncrementalFetch:{EnableIFOnGrid:AA?0:-1},FormattingWidget:{ClassName:AA?r:"",Enable:(r!=="")?1:0}};if(x){v.FormattingWidget.WidgetProps=x;}P.forEach(u,function(AC,AB){if(!v[AB]){v[AB]={};}P.forEach(AC,function(AD,AE){v[AB][AE]=AD;});});return this.getUnitFormatAction(z,1,v);},setVisAsFilter:function A(Aj,Ab,AV){var Af=[],Ac=Ab.sc,AZ=Ab.targetKeys,Ag=Ab.isFilter,AQ=Ab.clearAll,AS=Ab.isNav,An=Ab.navPage,t=this,AT=Ab.srcKey,Ak=this.getLayoutKeyByUnitKey(Aj.k),AE=[],AN=[],Ah=[],AD=[],AL=false,AG,AM,AW,z=[],AJ=[],AR=Ab.forAllData!==undefined&&Ab.forAllData,r=false,AP=false,AC=Ab.singleUnit,AK=t.getCurrentLayoutDef().cgbMap,u={},AH,w=[],Ao,Am=Aj&&Aj.boxContent,AU=Am.isVisMap,v=Ab.isLayerChanged,Aa=AU?(v?Ab.layerKey:Am.getKeyForTemplateSelection()):Aj.k,AI=AU?(Am.getKeyForTemplateSelection()):Aj.k,AF,x=(AU?Am.getWidgetForTemplateSelection(AI):Am).node,Ai=function Ai(){delete Aj.defn.an;},AA=function(){if(AQ===undefined&&Ac){return Ac.all||Ac.showall;}return AQ===undefined?true:!!AQ;},Al=function(){if(AL&&Ag===undefined){if(Ah.length===AD.length){return true;}return !!Ac;}if(Ag!==undefined){return Ag;}return true;},AY=I,Ae=function(Aq){var Ap=false;P.forEach(AZ,function(Ar){if(Ar.cgbs&&Ar.cgbs.length){Ar.cgbs.forEach(function(As){Ap=Ap||P.valarray(As.sc.cgb).indexOf(Aq)!==-1;});}});return Ap;},AO=function(Au){var As=false,Ar=t.getPanel().defn.ck,At=t.defn.layoutMap[t.getCurrentLayoutKey()],Aq=At&&At.units,Ap,Av;if(Aq){P.forEach(Ar,function(Ax,Aw){Ap=Aq[Aw];Av=Ap&&(Ap.t===j.SELECTOR)&&Ap.cgb&&P.valarray(Ap.cgb);if(Av&&Av.length){if(Av.indexOf(Au)!==-1){As=true;return false;}}});}return As;};if(v){AL=true;}mstrmojo.hash.forEach(AZ,function(Aq,Ap){if(Aq.c){AL=true;AD.push(Ap);}if((Aq.v&&!Aq.c)||(!Aq.v&&Aq.c)||(v&&x.defn.an)){AN.push(Ap);}if(Aq.v){Ah.push(Ap);}return true;},this);if(AC){AE=[Aj.k];AY=D;}var AB=Ah.length;if(AB===0&&!AC&&(!!x.defn.an&&x.defn.an.length>0)){if(Ac){Ag=undefined;}else{Ag=false;}}if(AC&&!AR&&AL){h.forEach(P.valarray(Ac.cgb),function(Ap){w.push([Ap,true]);delete AK[Ap];});if(!AB){AG={act:"clearVisAsFilter",nodeKey:Aj.k,associatedNodes:AN,cgbNodeKeys:w,controlKey:Ac.ckey};AE=AE.concat(AN);r=true;}else{Ah.forEach(function(Ap){z.push(t.getNextKey());if(AE.indexOf(Ap)===-1){AE.push(Ap);}},this);AG={act:"updateSingleUnitControl",controlKey:Ac.ckey,nodeKey:Aj.k,removeTargetKeys:w,newTargetKeys:Ah,CGBKeys:z,unitId:Ab.unitId};}Af.push(AG);}else{if(AR||AL||Ag!==undefined){AG={act:"clearVisAsFilter",nodeKey:AI};if(AN){AG.associatedNodes=AN;AE=AE.concat(AN);}if(Ac){h.forEach(P.valarray(Ac.cgb),function(Aq){var Ap=t.getAllSources(Am,Aq).length<=1;if(Ap){delete AK[Aq];}w.push([Aq,Ap]);});AG.cgbNodeKeys=w;AG.controlKey=Ac.ckey;}if(Ac||!P.isEmpty(AN)){r=true;Af.push(AG);AY=D;}}if(AR||(AL&&AB>0)||Ag!==undefined){if(Al()){AW=t.getNextKey();}Ah.forEach(function(Ap){if(Al()){AM=AZ[Ap].ft;if(!AM){AH=true;P.forEach(AK,function(Aq,Ar){if(Ap===Aq&&!Ae(Ar)&&!AO(Ar)){z.push([Ar,false]);AH=false;}});if(AH){Ao=t.getNextKey();u[Ao]=Ap;z.push([Ao,true]);}}else{Ao=t.getNextKey();u[Ao]=Ap;z.push([Ao,true]);}}if(AE.indexOf(Ap)===-1){AE.push(Ap);}AJ.push(Ap);},this);Af.push({act:"setVisAsFilter",sourceKey:Aa,targetKeys:AJ,controlKey:AW,CGBKeys:z,showAll:AA(),fos:Al(),isNav:AS});AY=Al()&&t.hasUnitSelector?D:AY;AP=true;}}if(!AP&&AB>0&&AQ!==undefined){Af.push({act:"setControlShowAll",nodeKey:Aa,controlKey:Ac.ckey,showAll:AQ});}if(Af.length){P.copy(u,AK);Af[0].partialUpdate={nodes:AE};if(!AV){var Ad=function(){if(Am){Am.raiseEvent({name:"regenerateToolbar"});}},AX=function(){this.execute({execute:function(){var Ap=t.getDataService();AV=Ap.newUpdate(this);AV.addActions(Af);AV.addExtras(AY);if(AY!==I){AV.addCallbacks(t.getRebuildCallback());}AV.addCallbacks({success:function(){var Aw=[],Au,Av=mstrmojo.all[Am.id],As=t.getLayoutKeyByUnitKey(Av.k),Aq=As&&t.getLayoutDefn(As),Ax,Ar,At;if(r){Ax=x.data.sc||{};h.forEach(Ax.cgb,function(Ay){if(Ax.isNavigation&&Aq){At=Aq.units[Ay];if(At){At.scs=At.scs||[];Ar=h.find(At.scs,"ckey",Ax.ckey);if(Ar>-1){At.scs.splice(Ar,1);if(!At.scs.length){delete Aq.units[Ay];}}}}});delete x.data.sc;delete x.defn.an;if(Av&&Av.deleteSelectorControl){Av.deleteSelectorControl();}At=Aq.units[Av.k];if(At){delete At.an;}}AF=(AU?Av.getWidgetForTemplateSelection(Aa):Av).node;if(AP){if(Al()){h.forEach(z,function(Ay){Ar=Ay[0];Aw.push(Ar);if(AS&&Aq){At=Aq.units[Ar];if(At){At.scs=At.scs||[];if(h.find(At.scs,"pnk",Av.k)===-1){At.scs.push({ckey:AW,isNavigation:true,pnk:Av.k});}}else{Aq.units[Ar]={pnk:AT,t:j.UNITCONTAINER,isNavigation:false,scs:[{ckey:AW,isNavigation:true,pnk:Av.k}]};}}});AF.data.sc={ck:[1].concat([Aa,AW]).join(B),ckey:AW,ct:6,showall:AA(),cgb:Aw,tks:AJ.join(B),isNavigation:AS,navPage:An};}Au=AF.defn.an=[];AJ.forEach(function(Ay){Au.push({k:Ay,muc:24});},this);}if(!AP&&AB&&AQ!==undefined){AF.data.sc.showall=AQ;}if(Av&&Av.findSelectorControl){Av.findSelectorControl();}},complete:Ad});this.submitUpdate(AV);},urInfo:{treesToRender:3,undo:Ai,redo:Ai,extraPuKeys:AC?null:h.distinct([AI,Aa]),puKeys:AY===I&&h.distinct([AI,Aa]).concat(AE),callback:m.wrapMethods(t.getRebuildCallback(),{success:Ad})}});};if(AS){t.raiseEvent({name:"layoutSelected",panelKey:AT,layoutKey:Ak,callback:{complete:AX.bind(this)}});}else{AX.call(this);}}else{AV.addActions(Af);}}return r;},updateVisSelector:function S(v,z,x,r){if(!v){return ;}var w=[],u=v.node,t;h.forEach(r,function(AA){w.push(AA[0]);});u.data.sc={ck:[1].concat([v.k,z]).join(B),ckey:z,ct:6,showall:true,cgb:w,tks:x.join(B)};t=u.defn.an=[];x.forEach(function(AA){t.push({k:AA,muc:24});},this);u.data.sc.showall=true;if(v.findSelectorControl){v.findSelectorControl();}},getAllSources:function l(r,AD){var v=function(AG){return AG.selectorControl||(AG.findSelectorControl&&AG.findSelectorControl());},u=v(r),w=((u&&u.tks)||"").split(B),x=this.getLayoutKeyByUnitKey((w.length&&w[0])||AD),AF=this.getVizContentPanel(x).children,AE=x&&this.getLayoutDefn(x).units[AD],AC,t,z=(AE&&AE.scs)||[],AB=P.copy(z,[]),AA;h.forEach(AF,function(AG){AC=v(AG.boxContent);if(AC&&P.valarray(AC.cgb).indexOf(AD)>=0){if(parseInt(AC.ct,10)===6){t=AG.k;if(h.find(z,"pnk",t)<0){AB.push({bc:AA,sourceKey:t,control:AC});}}}});return AB;},getSourceControls:function q(v,u){var t=v.parent.children,x,r=[],w;h.forEach(t,function(z){w=z.boxContent;x=w.selectorControl||(w.findSelectorControl&&w.findSelectorControl());if(x&&P.valarray(x.cgb).indexOf(u)>=0){r.push({bc:w,sourceKey:z.k,control:x});}});return h.filter(r,function(z){return Number(z.control.ct)===6;});},clearVisAsFilterAction:function e(z,AA){var x=z.boxContent,u=x.isVisMap,r=x.selectorControl,v=u?x.getDefnAnForTemplateSelection():z.defn.an,t=u?x.getKeyForTemplateSelection():z.k,w=u?x.getAllLayerKeys(true):[z.k];return K.call(this,z,r,v,t,w,AA);},clearVisAsFilterActionForMapLayer:function b(x,z,t){var r=z.findSelectorControl(),v=z.node.defn.an,u=z.k,w=[z.k];return K.call(this,x,r,v,u,w,t);},getVisualizationByKey:function f(t){var u=this.getVIComponent(O.VIZ_CONTENT),r;h.forEach(u.children,function(v){h.forEach(v.children,function(w){if(t===w.k){r=w;return false;}});if(r){return false;}});return r;},associatedNodesUpdate:function G(t){var r=this,u=r.getCurrentLayoutKey(),v;return{callback:{success:function(w){w.defn.layouts.some(function(x){v=x;return x.k===u&&x.loaded;});h.forEach(t,function(x){var z=v.units[x.k];if(z){if(P.isEmpty(z.an)){delete x.defn.an;}else{x.defn.an=z.an;}}});}},extras:{style:{params:{treesToRender:1}}}};},redoFilterAssociations:function X(t,w,v,r,x,u){return{act:"redoFilterAssociations",isNewCGB:t,controlKey:w,sourceKey:v,targetKey:r,removeCGB:x,addCGB:u,partialUpdate:{nodes:[v,r]}};},setFilterType:function U(u,t,r){u.addActions({act:"setVisFilterType",nodeKey:t.k,type:r});},getTargetFilterKeys:function o(t){var u=[],x=this.getCurrentLayoutDef(),v=this.getVizContentPanel(x.k),AD=x.cgbMap,AA=x.units,z=t.boxContent,AC=z&&z.selectorControl,AB=AA[t.k],w=AB&&AB.an,r=w&&w.length&&w[0].k;if(AC){P.forEach(AC.cgb,function(AE){if(AA[AE]){u.push(AE);u.push(AD[AE]);}});}if(r&&v&&h.some(v.children,function(AE){return AE.k===r;})){u=u.concat(h.map(w,function(AE){return AE.k;}));}return u;},getSourceFilterKeys:function g(t,v){var w=[],AB=this.getVIComponent(O.FILTER_STACK),AA=this.getCurrentLayoutDef(),x=this.getVizContentPanel(AA&&AA.k),AC=AA&&AA.units,r,z,u=P.forEach(AA&&AA.cgbMap,function(AE,AD){if(AE===t){r=AC[AD];if(r&&r.scs){h.forEach(r.scs,function(AF){z=AF.pnk;if(AC[z]){w.push(z);}});}}});if(AB){if(v){h.forEach(AB.getFilters(),function(AD){if(AD.node.defn.srct===J){w.push(AD.k);}});}else{w.push(AB.k);}}if(x){x.children.forEach(function(AD){var AE=(AD.getTargetKeys&&AD.getTargetKeys())||[];if(h.indexOf(AE,t)>-1&&h.indexOf(w,AD.k)===-1){w.push(AD.k);}});}return w;},getAddVisActions:function d(t,r,x,v){var z=[],u,w;z.push(this.getCopyEmptyTemplateAction(r,t));v='<props ><widgetProps ><fmt ><visStyle value="GraphMatrixVisualizationStyle" ></visStyle><Shape value="Bar" ></Shape><Subtype value="Automatic" ></Subtype></fmt></widgetProps></props>';if(x){z.push({act:"updateTemplate",keyContext:r,actions:[{act:"createDefaultDropZones",nodeKey:r,treeType:1,datasetType:3,widgetType:x.type}]});u=x.style;w={k:r,defn:{t:j.GRID}};z.push(this.getUnitChangeVizAction(u,this.getWidgetClassNameByStyle(u,x.type),w,v,x.extraFormatting));}return z;},getClearVisFilterAction:function M(t,r,w,v){var u={act:"clearVisAsFilter",nodeKey:t,controlKey:w,cgbNodeKeys:v};if(r){u.associatedNodes=r;}return{act:"clearVisAsFilter",nodeKey:t};},getSetVisAsFilterAction:function L(t,w,v,u,r){return{act:"setVisAsFilter",sourceKey:t,targetKeys:u,controlKey:w||this.getNextKey(),CGBKeys:r,showAll:true,fos:true,partialRetrieval:{nodes:h.ensureArray(v)}};}});}());(function(){mstrmojo.requiresCls("mstrmojo.EnumRWUnitType","mstrmojo.func","mstrmojo.DocDataService","mstrmojo.vi.models.EnumFieldTypes");mstrmojo.requiresDescs(1013,2922,4538);var N=mstrmojo.func,H=mstrmojo.EnumRWUnitType,S=mstrmojo.models.FormatModel,D=S.getFormatUpdate,J=S.ENUM_PROPERTY_NAMES,Q="\u001E",I={106:{id:"1013",desc:"Text"},102:{id:"2922",desc:"Image"},107:{id:"4538",desc:"HTML Container"}},C=mstrmojo.vi.models.EnumFieldTypes;function G(V,U,W,X){if(U!==W){return{act:"editField",fieldKey:V.k,fieldType:X,fieldValue:U,nodeKey:V.nk,treeType:1,fieldName:(V.defn&&V.defn.n)||V.k,partialRetrieval:{nodes:[V.k,V.nk]}};}return undefined;}function P(U){switch(U){case H.TEXTFIELD:case H.IMAGE:case H.HTMLCONTAINER:return mstrmojo.desc(I[U].id,I[U].desc)+this.updateTypeCounter(U);default:return null;}}function A(Y,X,a){var W=H.HTMLCONTAINER,V=Y.nk,U=Y.k,Z={act:"format",unitType:W,formatType:1,nodeKey:V,fieldKey:U,keyContext:W+Q+V+Q+U,format:{FormattingHTML:{HTMLType:X}},partialRetrieval:{nodes:[U,V]}};Z.format.FormattingHTML[X===1?"HTMLText":"URL"]=a;return Z;}mstrmojo.vi.models._FieldActions=mstrmojo.provide("mstrmojo.vi.models._FieldActions",{_mixinName:"mstrmojo.vi.models._FieldActions",insertNewField:function B(U){var c=this,a=c.getVizContentPanel(),e=U.t,V,Y=this.id,f=P.call(this,e),Z=c.getVizContentPanel().k,b=c.getNextKey(),d=a.nk,X=a.defn.fgk,W;a.restoreAnyMaxedVizBox();this.execute({execute:function(){var k=c.getDataService(),l=k.newUpdate(this,{extras:mstrmojo.DocDataService.REQUEST_DEFN_DATA});var j=c.createNewUnitNode(function(m){m.v=U.v;return m;},function(m){m.t=e;m.n=f||b;return m;},function(m){V=a.defn.fgk||a.nk;m.nk=b=V||mstrmojo.all[Y].getNextKey();return m;});var h=c.createUnit(j,Z);W=h.k;h.nk=a.nk=b;var g=function(m){m.fieldKey=W;m.fieldType=U.ft;m.nodeKey=b;m.treeType=1;m.fieldName=f||b;m.partialRetrieval={nodes:[b]};return m;};l.addActions([g({act:"addField",createNode:!V,nodeKeyParent:a.k}),g({act:"editField",fieldValue:U.v})]);if(U.getAdditionalActions){l.addActions(U.getAdditionalActions(h)||[]);}c.deferredInsertUnit(l,h,Z);this.submitUpdate(l);},urInfo:{treesToRender:3,undo:function(){a=c.getVizContentPanel();a.nk=d;a.defn.fgk=X;var g=a.getUnitByKey(W);g.defn._isDeleted=true;g.undoInsert();delete this.callback;return true;},redo:function(){var h=c.createNewUnitNode(function(l){l.v=U.v;return l;},function(l){l.t=e;l.n=f||b;return l;},function(l){l.nk=b;return l;},W);var g=c.createUnit(h,Z);g.nk=c.getVizContentPanel().nk=b;var j=c.getDataService(),k=j.newUpdate(this,{extras:mstrmojo.DocDataService.REQUEST_DEFN_DATA});c.deferredInsertUnit(k,g,Z);if(this.urInfo){this.urInfo.callback=k.callback;}this.callback=k.callback;return false;}}});},insertNewText:function K(){var U=H.TEXTFIELD;this.insertNewField({v:"",t:U,ft:C.TEXT,getAdditionalActions:function V(X){var Y=X.k,W=X.nk;return[{act:"format",unitKey:Y,unitType:U,formatType:1,fieldKey:Y,nodeKey:W,keyContext:U+Q+W+Q+Y,format:{FormattingSize:{TextOverflow:1}}}];}});},editField:function O(e,Z,f,b,V,U){var d=this,Y=(U&&U.actions)||[],a=U&&U.callback,X,W=U&&U.extras,c=e.k;X=G.call(d,e,b,V,Z);if(X){Y.push(X);}this.execute({execute:function(){this.submit(Y,N.wrapMethods(a,{success:function(g){if(Z===C.IMAGE&&e.defn.oid){delete e.defn.oid;}d.partialUpdate(g.data,d.getTargetDefn(e.k),g.defn,[c]);d.selectVIUnit(e.id);if(f&&f.success){f.success(g);}},failure:function(){if(f&&f.fail){f.fail();}}}),W);}});},getRemoveFieldUpdate:function F(U){return this.getDataService().newUpdate(null,{actions:[{act:"removeField",treeType:"1",nodeKey:U.nk,fieldKey:U.k}]});},editLink:function E(U,Z,V,Y){var W=this.getUnitFormatAction(U,1,{FormattingNavigation:{Hyperlinks:V}});var X=this.getDataService();this.execute({execute:function(){var a=this,b=X.newUpdate(a,{actions:[W],callback:Y});b.submit();},urInfo:{silent:true,undo:Y.undo,redo:Y.redo}});},editHtmlContainer:function R(W,V,Y,a){var Z=this.id,X=mstrmojo.DocDataService,U={callback:mstrmojo.DocDataService.EMPTY_CALLBACK,undo:a.undo,redo:a.redo};if(V!==1){U.extras=X.SUPPRESS_DATA;}this.execute({execute:function(){var c=mstrmojo.all[Z],e=c.getDataService(),d=(V!==1?{extras:X.SUPPRESS_DATA}:null),f=e.newUpdate(this,d),b=W.k;f.addActions([A(W,V,Y)]);f.addCallbacks(N.wrapMethods(a,{success:function(g){c.partialUpdate(g.data,c.getTargetDefn(b),g.defn);}}));this.submitUpdate(f);},urInfo:U});},insertNewImage:function M(){this.insertNewField({v:"",t:H.IMAGE,ft:C.IMAGE,getAdditionalActions:function U(V){var W=V.model.getUnitFormatAction;return[W(V,1,D(J.IMAGE_HEIGHT,0),true),W(V,1,D(J.IMAGE_WIDTH,0),true)];}});},insertNewHtmlContainer:function L(){this.insertNewField({v:"",t:H.HTMLCONTAINER,ft:C.HTML_CONTAINER});}});}());(function(){mstrmojo.requiresCls("mstrmojo.DocDataService");mstrmojo.OIVMViewFactory=mstrmojo.declare(null,null,{scriptClass:"mstrmojo.OIVMViewFactory",newDocDataService:function A(B){return new mstrmojo.DocDataService(B);}});}());(function(){mstrmojo.requiresCls("mstrmojo.DocDataService","mstrmojo.vi.enums.EnumFeatures");var L=mstrmojo,A=L.func,K=L.array,M=L.DocDataService.REQUEST_DEFN_DATA,F=L.mstr.EnumWebAPIErrorCodes,H=mstrmojo.vi.enums.EnumFeatures;mstrmojo.vi.models._LayoutActions=mstrmojo.provide("mstrmojo.vi.models._LayoutActions",{_mixinName:"mstrmojo.vi.models._LayoutActions",addNewLayout:function J(R,P,Q){var N=this,O={act:"addLayout",nodeKey:P.nodeKey,titlePattern:mstrApp.supportFeature(H.USE_WORKSTATION_NAMING_STYLE)?1:0,newPanelKey:P.newPanelKey,analysisSectionType:P.analysisSectionType,index:P.index,disablePU:true};R.add(O,A.wrapMethods({success:function(S){N.replaceLayout(O.nodeKey,S,true);N.mapLayKeys={newKey:O.nodeKey};}},Q),M);},addExistingLayouts:function I(S,Q,R){var N=this,P=[F.E_UNUSED],O={act:"importDashboard",newPanelKey:Q.newPanelKey,analysisSectionType:Q.analysisSectionType,index:Q.index,disablePU:true};S.extras.skipUICmdMgrOnFailure=P;S.extras.config={hideFailureErr:true};S.add(O,A.wrapMethods({success:function(U){if(N.resetKeySeed){N.resetKeySeed(U.keySeed);}N.updateLayouts(U);},failure:function(U,W){var V=function(){N.controller.undo();};mstrmojo.error({longDesc:U.message},V,{onClose:V,title:"Error"});}},N.controller.getUpdateLayoutsCallback(),R),M);},duplicateLayout:function(R,P,Q){var N=this,O={act:"duplLayout",srcKey:P.srcKey,destKey:P.destKey,name:P.name,index:P.index,disablePU:true};R.add(O,A.wrapMethods({success:function(W){N.replaceLayout(O.destKey,W,true);N.mapLayKeys={oldKey:O.srcKey,newKey:O.destKey};var S=N.getLayoutDefn(O.srcKey),X=(W.defn&&W.defn.layouts||[]).filter(function(Z){return Z.k===O.srcKey;})[0],V;for(V in S.units){var Y=S.units[V],U=X&&X.units[V];Y.pnk=U?U.pnk:Y.pnk;Y.chdidx=U?U.chdidx:-1;}}},Q),M);},moveLayout:function C(O,Q){var N=this.defn.layouts,P=this.data.layouts,R=[N,P];R.forEach(function(S){S.splice(Q,0,S.splice(O,1)[0]);});},getMoveLayoutAction:function B(N,O){return this.getDataService().getMoveNodeAction(this.data.layouts[N],this.defn.root.k,O);},removeLayout:function G(Q,U,S){var P=this,O=this.defn.layouts,R=this.data.layouts,N=K.find(O,"k",Q);if(N===-1){throw new Error("Layout with key "+Q+" not found.");}S.add({act:"removeLayout",unitKey:Q,isCurrent:Q===P.currlaykey},A.wrapMethods({success:function(V){O.splice(N,1);R.splice(N,1);var W=R[K.find(R,"k",V.currlaykey)];if(!W||!W.loaded){P.replaceLayout(V.currlaykey,V,true);}}},U));},renameLayout:function E(N,P,O,Q){this.updateTitle(P,O,N,N,"title",Q);},updateLayouts:function D(P){var U=this,O=false,S=(U.defn&&U.defn.layouts)||[],V=(U.data&&U.data.layouts)||[],R=(P.defn&&P.defn.layouts)||[],N=(P.data&&P.data.layouts)||[],Q=[],W=[];R.forEach(function(Y){var X=mstrmojo.array.find(S,"k",Y.k);if(X>=0&&!Y.loaded){Q.push(S[X]);}else{Q.push(Y);}});N.forEach(function(Y){var X=mstrmojo.array.find(V,"k",Y.k);if(X>=0&&!Y.loaded){W.push(V[X]);}else{W.push(Y);}});if(U.defn){U.defn.layouts=Q.length?Q:S;}if(U.data){U.data.layouts=W.length?W:V;}(N||R||[]).forEach(function(X){if(X.loaded){U.replaceLayout(X.k,P,true);O=true;}});if(!O){U.ondefnChange();}return R.length!==0||N.length!==0;}});}());(function(){mstrmojo.requiresCls("mstrmojo.util.ui._HostsSplitter","mstrmojo.models.FormatModel","mstrmojo.DocDataService","mstrmojo.dom","mstrmojo.array","mstrmojo.vi.enums.EnumThemeProperties","mstrmojo.hash","mstrmojo.css");var g=mstrmojo.array,V=mstrmojo.hash,C=mstrmojo.css,R=mstrmojo.dom,n=mstrmojo.models.FormatModel,q=n.getFormatUpdate,h=n.ENUM_PROPERTY_NAMES,J={h:{dimension:{shared:"width",full:"height"},position:{shared:"left",full:"top"}},v:{dimension:{shared:"height",full:"width"},position:{shared:"top",full:"left"}}},N=mstrmojo.DocDataService.SUPPRESS_DATA,K=mstrmojo.DocDataService.RAPID_EXEC;mstrmojo.vi.ui.BoxLayoutDimensionsType=null;function I(AA){var z=V.copy(AA);var x="px";z.left=Math.max(z.left,0)+x;z.top=Math.max(z.top,0)+x;z.height=Math.max(z.height,0)+x;z.width=Math.max(z.width,0)+x;return z;}function u(AA,AD,AC,z){var AE=J[AA].dimension,x=J[AA].position,AB={};AB[AE.shared]=AD;AB[AE.full]=AC[AE.full];AB[x.shared]=z;AB[x.full]=AC[x.full];return AB;}function O(x,AE,AC,AD){var AB=x==="v"?"h":"v",AA=[],z=function(AF){if(AF===x){return AA.reduce(function(AG,AH){return AG+AH[x];},0);}return Math.max.apply(null,AA.map(function(AG){return AG[AB];}));};AE.forEach(function(AF,AG){var AH={};if(AF.t===this.componentType){AH=mstrmojo.vi.ui.BoxLayoutConfig.getMinimumChildSizes(AF,x,AD);}else{AH=O.call(this,AF.o,AF.children,AC,AD);}if(AG!==AE.length-1){AH[x]+=AC;}AA.push(AH);},this);return{sizes:AA.map(function(AF){return AF[x];}),v:z("v"),h:z("h")};}function k(z,AO,AD,AH,AQ){var x=O.call(this,z,AO,AH,AQ),AS=J[z].dimension.shared,AM=AD[AS],AL=AM,AF=AO.length-1,AC=0,AT=false,AE=function(AV,AU){return AU===AF?AV:AV+AH;},AA=0,AB={},AR={},AJ=false,AG=function(AV){var AU=this.getUnitByKey&&this.getUnitByKey(AV);return AU&&AU.height&&parseInt(AU.height,10)||0;};AO.forEach(function(AW,AU){var AV=parseFloat(AW.l);if(AW.f){AM-=AE(AV,AU);AT=true;}else{AC+=AV;}});var AK=!AT&&AC===0;if(AK){AC=100*AO.length;}if(AC>100){AJ=true;}AO.forEach(function(AV,AU){var AX=AK?100:AV.l;if(AV.f){AB[AU]=AE(AX,AU);return ;}var AW=AJ&&AV.type===this.componentType?AG.call(this,AV.k):Math.round(AM*(AX/AC)),AY=x.sizes[AU];if(AY>AW){AB[AU]=AY;AA+=AY-AW;return ;}AR[AU]={c:AW,m:AY};}.bind(this));if(AA){var AI=function(){var AW=Object.keys(AR),AV=Math.floor(AA/AW.length),AU=true;AW.forEach(function(AX){var AY=AR[AX];if(AY.m>AY.c-AV){AB[AX]=AY.m;AA-=AY.c-AY.m;AU=false;delete AR[AX];}});if(AU){AW.forEach(function(AX){AB[AX]=AR[AX].c-AV;});AR={};return ;}AI();};AI();}Object.keys(AR).forEach(function(AU){AB[AU]=AR[AU].c;});var AN=Object.keys(AB).map(function(AV,AU){return AB[AV]-(AU<AF?AH:0);}),AP=AL-AN.reduce(g.fnReduceNumber,0)-(AF*AH);if(AP!==0){if(AN[AF]+AP<=0){AD[AS]-=AP;}else{AN[AF]+=AP;}}return AN;}var L=document.createElement("div");L.setAttribute("unselectable","on");L.className="splitter";mstrmojo.vi.ui._HasBoxLayout=mstrmojo.provide("mstrmojo.vi.ui._HasBoxLayout",{_mixinName:"mstrmojo.vi.ui._HasBoxLayout",boxType:"b",componentType:"c",boxLayoutConfig:null,firstBoxId:null,firstVizBoxId:null,splitterCache:null,splittersInfo:null,isInteractive:true,allowPanelEdgeTargeting:false,postBuildBoxLayout:mstrmojo.emptyFn,postCalculateBoxLayout:null,getBoxLayoutSaveAction:function W(x,z){return this.model.getUnitFormatAction(this,1,q(h.LAYOUT_XML,x),z);},getBoxLayoutSaveCallback:function l(){return null;},getChildPositionActions:function F(x){return[];},saveBoxLayout:function e(x,AG,AI,AC,AD,z){var AF=this.boxLayoutConfig,AE=this.model,AH=AE.getDataService(),AB=[].concat(this.getBoxLayoutSaveAction(AF.getBoxState(),AD)).concat(this.getChildPositionActions(AD)),AA=V.copy(z,V.copy(K,{preserveUndo:true}));AI=AI||{success:mstrmojo.emptyFn};if(!AC){if(x){x.submit(AB,AI,AA,AG);}else{AH.submitUpdates(AB,AI,AA);}}else{AC.add(AB,AI);}},buildBoxLayout:function M(AB,AE){var AC=this.boxLayoutConfig;if(!AC||(this.height===undefined&&this.width===undefined)){return ;}if(AE){AC.box=AE;}var AA={height:parseInt(this.height,10),width:parseInt(this.width,10),top:0,left:0},AH=this.calculateBoxLayout(AC,AA),AN=AH.box,AI=AC.identifier,AD=this.children,AG=AC.boxPaths={};this.firstVizBoxId=null;var AM=Infinity,z=Infinity,AL=-1,AF=-1;Object.keys(AN).forEach(function(AO){var AP=AD[g.find(AD,AI,AO)];if(AP&&AP.scriptClass==="mstrmojo.vi.ui.rw.VizBox"){AL=parseInt(AP.top,10);AF=parseInt(AP.left,10);if(z>AL){z=AL;AM=AF;this.firstVizBoxId=AP.id;}else{if(z===AL){if(AM>AF){AM=AF;this.firstVizBoxId=AP.id;}}}}},this);this.firstBoxId=null;Object.keys(AN).forEach(function(AP){var AQ=AD[g.find(AD,AI,AP)];if(AQ){var AO=AN[AP],AR=AQ.id;if(AO.first){this.firstBoxId=AR;}AO.boxChild.id=AR;AG[AP]=AO.boxLevel;AQ.updateLayout(AO.dim,AB);}},this);var AJ=this.getSplitterHost();this.splittersInfo=AH.splitter;this.updateSplitters();if(AJ){var AK=AJ.style,x=AH.size;AK.height=x.height+"px";AK.width=x.width+"px";}if(this.updateScrollbars){this.updateScrollbars();}this.postBuildBoxLayout();delete AC.dirty;},postBuildRendering:function X(){var x=this._super();this.updateSplitters();return x;},updateSplitters:function f(){if(!this.splittersInfo){return ;}var z=this.splitterCache=this.splitterCache||[],x=this.splittersInfo,AA=this.getSplitterHost();if(AA){x.forEach(function(AF,AD){var AB=AF.dim;var AE=z[AD];if(!AE){AE=z[AD]=L.cloneNode(false);this.registerSplitter(AE);}AE.path=AF.boxLevel;AE.orientation=AF.orientation;var AC=AE.style;V.copy(I(AB),AC);AC.display="block";C.toggleClass(AE,"v",AF.orientation==="h");if(!AE.parentNode){AA.appendChild(AE);}},this);z.slice(x.length).forEach(function(AB){AB.style.display="none";});this.splittersInfo=null;}},calculateBoxLayout:function Q(z,AE){var AD=z.padding||0,AC=[],AG={},x=[];var AB=function(AQ,AH,AI){var AJ=AQ.o,AN=J[AJ].dimension,AP=J[AJ].position,AK=AN.shared,AL=AP.shared,AS=AH[AL],AR=AQ.children,AO=AR.length-1,AM=k.call(this,AJ,AR,AH,AD,z);if(AC.length===AI){AC[AI]=-1;}AR.forEach(function(AU,AW){var AY=AU.t,AZ=AM[AW],AX=u.call(this,AJ,AZ,AH,AS);AU.h=AX.height;AU.w=AX.width;AC[AI]=AC[AI]+1;var AV=AC.join("|");if(AY===this.componentType){AG[AU[z.identifier]]={boxLevel:AV,boxChild:AU,dim:I(AX),first:(AX.top===0&&AX.left===0)};}else{if(AY===this.boxType){AB.call(this,AU,AX,AI+1);AC.splice(AI+1);}}if(this.isInteractive&&!AU.r&&AW<AO){var AT=(JSON.parse(JSON.stringify(AX)));AT[AL]+=AZ;AT[AK]=AD;x.push({boxLevel:AV,dim:AT,orientation:AJ});}AS+=AZ+AD;},this);};var AA=z.box||z.useDefaultBox(this.children),AF=O.call(this,AA.o,AA.children,AD,z);AE.height=Math.max(AE.height,AF.v);AE.width=Math.max(AE.width,AF.h);if(this.postCalculateBoxLayout){AA=this.postCalculateBoxLayout(AA,AE,AB);if(AA&&z.box){z.box=AA;}}if(AA){AB.call(this,AA,AE,0);}return{box:AG,splitter:x,size:{height:AE.height,width:AE.width}};},updateBoxPaths:function v(){var AA=[],z=this.boxLayoutConfig,AB=this.boxLayoutConfig.boxPaths={};var x=function(AC,AD){if(AA.length===AD){AA[AD]=-1;}AC.children.forEach(function(AE){var AG=AE.t;AA[AD]=AA[AD]+1;var AF=AA.join("|");if(AG===this.componentType){AB[AE[z.identifier]]=AF;}else{if(AG===this.boxType){x.call(this,AE,AD+1);AA.splice(AD+1);}}},this);};x.call(this,z.box,0);},getBoxLayoutChild:function Z(x){var z=x.id;if(z){return mstrmojo.all[z];}return null;},setDimensions:function o(AA,x){if(this.height!==AA||this.width!==x||(this.parent&&this.parent.forceLayout)){this.height=AA;this.width=x;if(this.hasRendered){var z=this.domNode.style;z.height=AA;z.width=x;}this.buildBoxLayout();}},onAppStateChange:function j(x){this.isInteractive=!(mstrApp.isAppStatePresentation&&mstrApp.isAppStatePresentation()||mstrApp.isLayoutModePreview());},onLayoutModeChange:function U(x){this.isInteractive=!(mstrApp.isAppStatePresentation&&mstrApp.isAppStatePresentation()||mstrApp.isLayoutPreview(x.value));},getSplitterInfo:function t(AA){var AC=AA.path,z=AA.orientation,x=this.boxLayoutConfig.getResizeBoundaries(AC,z),AB=parseInt(z==="v"?this.height:this.width,10);return{path:AC,min:x.min,max:AB-x.max};},shouldSaveSplitterMoves:function D(){return !mstrApp.hasRequests();},splitterMoved:function S(x,AE){var AC=this,z=AC.boxLayoutConfig,AB=AC.model,AD=mstrmojo.DocDataService,AA=function(AF){z.resizeBox(AE.path,x);AC.buildBoxLayout();AC.saveBoxLayout(AF);};if(this.shouldSaveSplitterMoves()){AB.execute({execute:function(){AA(this);},urInfo:{callback:AD.EMPTY_CALLBACK,extras:AD.SUPPRESS_DATA}});}else{AA();}},insertNewBox:function E(AB,z,AA,AC){var x=this.boxLayoutConfig;if(AC){AC.oldBoxState=x.getBoxState();}if(z){x.addDropBox(z,AA,{box:{boxId:AB.id}});}else{x.insertNewRootChild(AB,AA);this.buildBoxLayout(true);}},insertNewBoxAndSaveDeferred:function(AD,AA,AB,AC,x,z){this.insertNewBox(AA,x,z);this.saveBoxLayout(undefined,-1,AC,AD);},deleteBoxAndSubmitDeferred:function(AC,z,AB,AA,x){this.deleteBox(z,x);this.saveBoxLayout(undefined,-1,AB,AC,AA);},deleteBox:function a(x,z){this.boxLayoutConfig.deleteBox(x,z);this.removeChildren(x);},deleteBoxAndSubmit:function r(z,AC,x){var AB=this.model.getDataService(),AA=this;this.model.execute({execute:function(){var AD=this,AE=AB.newUpdate(AD,AC);AA.deleteBoxAndSubmitDeferred(AE,z);AE.addExtras(V.copy(N,x));AE.submit();}});},getBoxOrientation:function P(x){var z=this.boxLayoutConfig;return z.getBoxOrientation(z.getBoxPath(x));},hasBoxLayoutChild:function m(AA){var x=this.boxLayoutConfig,AC=x.identifier,AB=AA[AC],z=function(AD){if(!AD){return false;}if(AD.t===this.componentType){return AD[AC]===AB;}return(AD.children||[]).some(z);}.bind(this);return AA.parent===this&&z(x.box);},beginBoxMove:function Y(z,x,AA){this.boxLayoutConfig.beginBoxMove(z,x,AA);},dropBox:function d(AB,z,AD,AE){var AA=this.getPanelTargetEdge(AB),x=this,AC=this.boxLayoutConfig;if(AA){AC.insertExistingRootChild(AB,AA.substr(1));}else{AC.addDropBox(z,AD,AB);}x.buildBoxLayout();if(AE){this.saveBoxLayout();}},cancelBoxMove:function c(x){var z=x.src.widget;if(!z.cancelBoxMove(x)){this.boxLayoutConfig.cancelBoxMove(x);}},endBoxMove:mstrmojo.emptyFn,getPanelTargetEdge:function w(AA){if(!this.allowPanelEdgeTargeting){return"";}var AD=AA.panelPos;if(!AD){var x=R.position(this.domNode);AD=AA.panelPos={p:x,q:{Top:x.y,Right:x.x+x.w,Bottom:x.y+x.h,Left:x.x}};}var AC=AA.tgt.pos,AB=mstrmojo.boxmodel.getEdgeQuadrantByPoint(AD.p,AC),z=AB==="Left"||AB==="Right"?AC.x:AC.y;return Math.abs(AD.q[AB]-z)<=12?"p"+AB:"";},updateDropCue:function H(AD,AB,AC){var AA=this._dropCue;if(!AA){AA=this._dropCue=document.body.appendChild(document.createElement("div"));AA.className="mstrmojo-vi-hbl-cue";}var AE=AA.style;if(AD===""){AE.display="none";AE.top="-10000px";return ;}if(AD.charAt(0)==="p"){AD=AD.substr(1);AC=AB.panelPos.p;}var z=AD==="All",x={top:AC.y-3,left:AC.x-3,height:AC.h+6,width:AC.w+6};if(!z){var AF=true;if(AD==="Bottom"){x.top=AC.y+AC.h+mstrApp.getThemeProps(mstrmojo.vi.enums.EnumThemeProperties.SUBTYPE.LAYOUT).cueBottomOffset;}else{if(AD==="Right"){x.left=AC.x+AC.w+1;AF=false;}else{AF=AD==="Top";}}x[AF?"height":"width"]=2;}C.toggleClass(AA,"all",z);AE.cssText=Object.keys(x).map(function(AG){return AG+":"+x[AG]+"px";}).join(";");AE.display="block";},unrender:function B(z){var x=this._dropCue;if(x){x.parentNode.removeChild(x);delete this._dropCue;}this.splitterCache=null;return this._super(z);},getSplitterHost:function A(){throw new Error(this.scriptClass+" must implement getSplitterHost.");},getBoxState:function b(){return this.boxLayoutConfig.getBoxState();},restoreBoxState:function p(x){this.boxLayoutConfig.revertBoxState(x);}});var G=mstrmojo.vi.ui._HasBoxLayout;V.forEach(mstrmojo.util.ui._HostsSplitter,function(z,x){if(!G.hasOwnProperty(x)){G[x]=z;}});}());(function(){mstrmojo.requiresCls("mstrmojo.Model","mstrmojo._HasPopup","mstrmojo.string","mstrmojo.taphold");var D=mstrmojo.dom,B=mstrmojo.string,O=D.isIOSTouch;var L=1,C=2,J=4,V=8,U=16,K=512;function N(b,X){var a=b.getCellForNode(X),W=a&&a.at,Z=0;if(W){Z=(W&C)||(W&J)||(W&L);}if(Z===J){var f=b.model.getCellLinksInfo(a);if(!f||isNaN(f.di)){return"";}var d=f.links[f.di];return d.n;}if(Z===L){var c=b.model.getCellDrillsInfo(a);return c&&(mstrmojo.desc(183,"Drill to")+" "+c.n)||"";}if(a){var Y=("mix" in a)?a._e:a;if(Y&&Y.desc){return B.decodeHtmlString(Y.desc);}}return b.tooltip||"";}function I(c,X){var b=c.getCellForNode(X),W=b&&b.at;if((W&V)>0||(W&U)>0||(W&K)>0){return true;}var Y=0;if((W&L)>0&&b.sdm===undefined){return true;}if((W&J)>0){Y++;}if((W&C)>0){Y++;}if(Y>1){return true;}if((W&J)>0){var e=c.model.getCellLinksInfo(b),d=e&&e.links,a=b.v?B.decodeHtmlString(b.v):b.v;var Z=(d&&d.length)||0;if(e&&!isNaN(e.di)&&!B.isEmpty(a)){Z--;}if(Z>0){return true;}}return false;}function H(W){return W.viewport.clientWidth-(W.scrollboxNode.offsetWidth-W.scrollboxNode.clientWidth);}mstrmojo._XtabCellHoverMgr=mstrmojo.declare(mstrmojo.Model,null,{scriptClass:"mstrmojo._XtabCellHoverMgr",parent:null,td:null,audibles:{"*":false},startup:function E(){var X=this.parent;if(X&&X.getCellForNode){var W=X.zones,Y;for(Y in W){this.addMgrElement(Y);}if(!this._sub_ihc){this._sub_ihc=X.attachEventListener("ignoreHoverChange",this.id,"onChangeIgnoreHover");}window.setTimeout(function(){X._pl=H(X);},0);}},addMgrElement:function Q(Y){var b=this.parent,a=this,c=b&&b.zones[Y].tableNode;if(c&&b&&b.getCellForNode){if(!this.fCtxMenu){this.fCtxMenu=function(d){a.oncontextmenu(d,self);};}if(!this.fOver){this.fOver=function(d){a.onhover(d,self);};}if(!this.fOut){this.fOut=function(d){a.onunhover(d,self);};}var Z=this.fCtxMenu,X=this.fOver,W=this.fOut;D.attachEvent(c,"mouseover",X);D.attachEvent(c,"mouseout",W);D.attachEvent(c,"contextmenu",Z);if(O){this.xtabContextMenuListener=b.attachEventListener("contextmenu",c.id,Z);b.hasContextMenuEvent=true;}}},shutdown:function A(){var Y=this.parent,X=Y&&Y.zones,Z;for(Z in X){var W=X[Z].tableNode;if(W){D.detachEvent(W,"mouseover",this.fOver);D.detachEvent(W,"mouseout",this.fOut);D.detachEvent(W,"contextmenu",this.fCtxMenu);}}if(O&&Y&&this.xtabContextMenuListener){Y.detachEventListener(this.xtabContextMenuListener);Y.hasContextMenuEvent=false;}},onXtabWidthChanged:function(){var W=this.parent;W._pl=H(W);},onChangeIgnoreHover:function(){var W=this.parent;if(!W.ignoreHover&&this._ignored){this.onhover(null,null,this._ignored);}},onhover:function F(Z,W,Y){if(this.parent.ignoreHover){this._ignored=D.eventTarget(W,Z);return ;}var X=this.parent,a=this.getEvtTargetCell(Z,W,X,Y);if(a&&X){a.title=N(X,a);}if(this.showHvrBtn(X,a)){this.td=a;if(!X._pl){X._pl=H(X);}X.openPopup("cellHoverPopupRef",{xtab:X,td:a});}else{this.onunhover(Z,W,Y);}},onunhover:function M(){if(this.parent.ignoreHover){return ;}var X=this.parent,W=X._lastOpened;if(!W){return ;}if(W.autoCloses){W.autoClose();}else{X.closePopup();}},getEvtTargetCell:function G(a,W,Z,Y){var X=Y||D.eventTarget(W,a);return X&&D.findAncestorByName(X,"td",true,Z.viewport);},oncontextmenu:function P(Z,W,Y){var X=this.parent,a=this.getEvtTargetCell(Z,W,X,Y);this.processRightClick(Z,W,a);if(a&&this.shouldShowPopup(X,a,true)){if(!(D.isMetaKey(W,Z)||D.shiftKey(W,Z))){X.openPopup("cellHoverPopupRef",{xtab:X,td:a,cmPos:D.getMousePosition(Z,W)});X.cellHoverPopupRef.btn.openPopup();}X.closePopup();D.preventDefault(W,Z);D.stopPropogation(W,Z);}},processRightClick:mstrmojo.emptyFn,shouldShowPopup:function S(Y,Z,X){var W=Z.mstrShowPopup;if(W!==undefined){return W;}W=I(Y,Z);Z.mstrShowPopup=W;return W;},showHvrBtn:function R(W,X){if(mstrApp.isDossier||mstrApp.isVI){return false;}return this.shouldShowPopup(W,X,false);}});}());(function(){mstrmojo.ToolBarModel=mstrmojo.declare(mstrmojo.Model,null,{scriptClass:"mstrmojo.ToolBarModel",getChildren:function A(C,B){return(C||this.n||this).items;}});})();(function(){mstrmojo.requiresCls("mstrmojo._XtabCellHoverMgr","mstrmojo.dom");var D=mstrmojo.dom;mstrmojo.vi.ui._XtabCellHoverMgr=mstrmojo.declare(mstrmojo._XtabCellHoverMgr,null,{scriptClass:"mstrmojo.vi.ui._XtabCellHoverMgr",oncontextmenu:function E(I,F,H){this._super(I,F,H);var G=this.parent,J=this.getEvtTargetCell(I,F,G,H);if(!J||!this.shouldShowPopup(G,J,true)){D.preventDefault(F,I);D.stopPropogation(F,I);}},processRightClick:function B(G,F,H){this.parent.doSelection(G,F,H);},shouldShowPopup:function A(J,K,I){var G=J.getCellForNode(K),F=false,H=G&&G.at;if(G){if(!J.model.canShowCellMenu(G)){return false;}F=this._super(J,K,I);if(!F&&H!==undefined){K.mstrShowPopup=F=true;}}return F;},showHvrBtn:function C(H,I){var G,F=false;if(this._super(H,I)){G=H.model.getCellInfo(H.getCellForNode(I));F=(G.isMetric&&G.isHeader)||(!G.isMetric&&G.isTitle);}return F;}});}());(function(){mstrmojo.requiresCls("mstrmojo.hash","mstrmojo.array","mstrmojo.DocDataService","mstrmojo.vi.controllers.UICmd");var H=mstrmojo.hash.copy,U=mstrmojo.array.forEach,F=mstrmojo.vi.controllers.UICmd;var O=2,E=1,N=F.CMD_ACT_TYPE.UNDO,G=F.CMD_ACT_TYPE.EXEC,A=F.CMD_ACT_TYPE.REDO;var V=F.CMD_PHASE;var S=F.CMD_STATE;function B(){U(this._delayRemovedCmds,function(d){d.discard();});this._delayRemovedCmds=null;}function D(){this.cmds=this.cmds.concat(this._delayRemovedCmds);this._delayRemovedCmds=null;}function M(e){var d=this.cmds,f=this.pos;this._delayRemovedCmds=d.splice(f+1);if(f>=this.size-1){d.shift().discard();}d.push(e);this.pos=d.length-1;}mstrmojo.vi.controllers.UICmdMgr=mstrmojo.declare(null,null,{scriptClass:"mstrmojo.vi.controllers.UICmdMgr",cmds:null,pos:-1,size:20,_delayRemovedCmds:null,controller:null,dataService:null,model:null,state:E,CMD_PHASE:V,init:function W(d){H(d,this);this.cmds=[];},execute:function J(g){if(this.state===O){this.handleError();}try{g=H(g,{mgr:this,undoUIState:this.model.getUIState(),action:G});var d=this.curCmd=new F(g);M.call(this,d);this.state=O;d.execute();}catch(f){this.reset();throw f;}},getInterimCmd:function R(){if(this.state===O){var d=this.cmds[this.pos];if(d&&d.state===S.INTERIM){return d;}}return null;},undo:function b(g){if(this.canUndo()){this.state=O;try{var d=this.curCmd=this.cmds[this.pos--];d.action=N;d.redoUIState=this.model.getUIState();d.undoRedo(g);}catch(f){this.reset();throw f;}}},redo:function P(){if(this.canRedo()){this.state=O;try{var d=this.curCmd=this.cmds[++this.pos];d.action=A;d.undoUIState=this.model.getUIState();d.undoRedo();}catch(f){this.reset();throw f;}}},onSuccess:function I(d){if(this.state===E){this.handleError();}if(d!==this.curCmd){this.handleError("Wrong command");}this.state=E;B.call(this);this.controller.onCmdMgrChanged();},onFailure:function Y(){B.call(this);this.reset();},onCancel:function L(e,f){this.state=E;var d=!!e.submitCount;if(d){this.undo(f);}else{this.pos--;}this.cmds.pop();e.discard();if(d){B.call(this);}else{D.call(this);}this.controller.onCmdMgrChanged();},untrackLastCmd:function a(){var d=this.cmds.pop();d.discard();this.pos--;this.controller.onCmdMgrChanged();},reset:function a(){U(this.cmds,function(d){d.discard();});this.cmds.length=0;this.pos=-1;this.state=E;this.controller.onCmdMgrChanged();},resetState:function X(){this.state=E;},canUndo:function c(){return this.state===E&&this.pos>=0;},canRedo:function Q(){return this.state===E&&this.pos<this.cmds.length-1;},onSubmitUpdates:function Z(){if(this.state===E){this.cmds.splice(this.pos+1);this.controller.onCmdMgrChanged();}},isUndoRedo:function C(){var d=this.curCmd||{};return(this.state===O&&(d.action===N||d.action===A));},handleError:function K(d){this.reset();throw new Error(d||"Invalid state.");}});mstrmojo.vi.controllers.UICmdMgr.STATES={BUSY:O,IDLE:E};}());(function(){mstrmojo.requiresCls("mstrmojo.vi.models.PanelFormatSaver");mstrmojo.vi.ui._IsViPanel=mstrmojo.provide("mstrmojo.vi.ui._IsViPanel",{_mixinName:"mstrmojo.vi.ui._IsViPanel",getPanelSaver:function A(){return null;},setOpenStatus:function D(F,E,I,H){if(this.visible!==F){this.set("visible",F);if(!H){this.resetLayout(H);}if(!E){var G=this.getPanelSaver();if(G){G.saveProperty("visible",F);}}mstrApp.rootCtrl.generateToolbar();}},getOpenStatus:function C(){return !!this.visible;},resetLayout:function B(){this.height=this.width="1px";this.parent.doLayout();}});}());(function(){mstrmojo.requiresCls("mstrmojo.Base","mstrmojo.vi.util.ThresholdUtils","mstrmojo.array");mstrmojo.requiresClsP("mstrmojo.vi.viz","EnumVisualizationTemplates");var G=mstrmojo,F=G.array,J=G.vi.viz,D=J.EnumVisualizationTemplates,E=mstrmojo.vi.util.ThresholdUtils;mstrmojo.vi.viz.VisualizationTransition=mstrmojo.declare(mstrmojo.Base,null,{scriptClass:"mstrmojo.vi.viz.VisualizationTransition",vis:null,transitionDropZones:mstrmojo.getMissingFn(),addClearAllThresholdsActions:function I(L){var K=this.vis;E.addClearAllThresholdsActions(K.model,K.node,L);},addThresholds:function B(O,P,Q,L,K,M){var N=this.vis;return E.addThresholds(N.model,N,N.node,P,Q,L,K,M);},clearImageThreshold:function C(N,M){var L,K;for(key in N){if(N.hasOwnProperty(key)){L=N[key];if(L&&L.length){for(K=0;K<L.length;K++){if(!(L[K].fmt&&L[K].fmt.bc)){this.addClearAllThresholdsActions(M);break;}}}}}},isGraphMatrix:function H(L){var K=false;switch(L){case D.UNKNOWN_GRAPHMATRIX_TYPE:case D.GRAPHMATRIXBUBBLECIRCLEMM:case D.GRAPHMATRIXBUBBLEGRIDCIRCLEAA:case D.GRAPHMATRIXBUBBLEGRIDSQUAREAA:case D.GRAPHMATRIXBUBBLESQUAREAM:case D.GRAPHMATRIXBUBBLESQUAREMM:case D.GRAPHMATRIXHORIZONTALBARCLUSTERED:case D.GRAPHMATRIXHORIZONTALBARSTACKED:case D.GRAPHMATRIXHORIZONTALBARPERCENT:case D.GRAPHMATRIXHORIZONTALLINECLUSTERED:case D.GRAPHMATRIXHORIZONTALLINESTACKED:case D.GRAPHMATRIXHORIZONTALLINEPERCENT:case D.GRAPHMATRIXHORIZONTALLINEAUTOMATIC:case D.GRAPHMATRIXHORIZONTALAREACLUSTERED:case D.GRAPHMATRIXHORIZONTALAREASTACKED:case D.GRAPHMATRIXHORIZONTALAREAPERCENT:case D.GRAPHMATRIXHORIZONTALAREAAUTOMATIC:case D.GRAPHMATRIXSCATTERCIRCLEMM:case D.GRAPHMATRIXSCATTERGRIDCIRCLEAA:case D.GRAPHMATRIXSCATTERGRIDSQUAREAA:case D.GRAPHMATRIXSCATTERSQUAREAM:case D.GRAPHMATRIXSCATTERSQUAREMM:case D.GRAPHMATRIXVERTICALBARCLUSTERED:case D.GRAPHMATRIXVERTICALBARSTACKED:case D.GRAPHMATRIXVERTICALBARPERCENT:case D.GRAPHMATRIXVERTICALBARAUTOMATIC:case D.GRAPHMATRIXVERTICALLINECLUSTERED:case D.GRAPHMATRIXVERTICALLINESTACKED:case D.GRAPHMATRIXVERTICALLINEPERCENT:case D.GRAPHMATRIXVERTICALLINEAUTOMATIC:case D.GRAPHMATRIXVERTICALAREACLUSTERED:case D.GRAPHMATRIXVERTICALAREASTACKED:case D.GRAPHMATRIXVERTICALAREAPERCENT:case D.GRAPHMATRIXVERTICALAREAAUTOMATIC:case D.GRAPHMATRIXPIE:case D.GRAPHMATRIXRING:case D.GRAPHMATRIXVERTICALHISTOGRAM:case D.GRAPHMATRIXGRIDCHART:case D.GRAPHMATRIXVERTICALBOXPLOT:case D.GRAPHMATRIXHORIZONTALBOXPLOT:case D.GRAPHMATRIXVERTICALWATERFALL:case D.GRAPHMATRIXHORIZONTALWATERFALL:K=true;break;default:break;}return K;},filterGMTrainingMetric:function A(K,P){var L,M,O=[];if(!K||!K.ColorBy||!P){return P;}var N=function(Q){return(Q&&Q.TemplateMetric)||[];};L=N(K.AngleBy).concat(N(K.Rows)).concat(N(K.YAxis)).concat(N(K.Columns)).concat(N(K.XAxis)).concat(N(K.ColorBy)).concat(N(K.SizeBy)).concat(N(K.AdditionalMetrics));F.forEach(P,function(Q){M=false;F.forEach(L,function(R){if(Q.did===R.id){M=true;return false;}});if(M){O.push(Q);}});return O;}});}());(function(){mstrmojo.requiresCls("mstrmojo.vi.viz.GraphMatrixHelper","mstrmojo.vi.viz.MapHelper","mstrmojo.vi.viz.KnownVisualizations","mstrmojo.vi.util.ThresholdUtils","mstrmojo.gm.GMEnums","mstrmojo.gmaps.MapEnums","mstrmojo.chart.model.enums.EnumDSSObjectType","mstrmojo.gmaps._AreaMapHelper");var X=mstrmojo,S=X.array,W=X.vi.viz,L=X.gmaps,M=W.GraphMatrixHelper,V=W.EnumDSSDropZones,A=W.KnownVisualizations,D=X.vi.util.ThresholdUtils,Q=X.chart.model.enums.EnumDSSObjectType,H=L.EnumGraphicType,N=L.EnumPropertyType,Z=X.gm.EnumABLDirection,J=L._AreaMapHelper;function P(a){return a&&a.getHostModel&&a.getHostModel();}function F(b){var a=false;if(b.t!==4){S.forEach(b.fs||[],function(c){if(c.ftr||c.bftp===1||c.bftp===8||c.bftp===9){a=true;return false;}});}return a;}function G(b,d){var a=b.getHost(),c=a.GMController;if(c){switch(d){case"bp":return c.isBoxPlot;case"wf":return c.isWaterfall;case"hg":return c.isHistogram;default:break;}}return false;}function I(AG,g,AJ,o,r){var f=AJ.dz,AH=AJ.gsi||{},c=[],h=false,b=false,d=false,x=o.getHost().getChartStyle()==="NewGraphMatrixVisualizationStyle",j=G(o,"bp"),a=G(o,"wf"),AD=G(o,"hg"),p=function(AK){return AK.shape==="Pie"||AK.shape==="Ring";},AE=function(){var AK=o.getHost();return AK&&AK.GMController&&AK.GMController.isBubbleOrScatter();},z=function(AK,AO){c.push({act:"addDropZoneUnit",zoneId:AK,datasetId:g,unitId:AG.did,unitType:AG.t,unitPos:AO||0});h=true;d=(AK===V.ColorBy);b=(AK===V.AdditionalMetrics);var AN=["Reserved","Rows","Columns","XAxis","YAxis","BreakBy","SliceBy","ColorBy","SizeBy"],AM=AN[AK],AL=AG.t===4?"TemplateMetric":"TemplateUnit";if(f[AM]){if(!f[AM][AL]){f[AM][AL]=[];}f[AM][AL].push(AG);}},w=function(AK,AL){c.push({act:"removeDropZoneUnit",zoneId:AK,unitId:AL.did,unitType:AL.t});},AC=function(AK){c.push({act:"addDropZoneUnit",zoneId:AK,unitId:"00000000000000000000000000000000",unitType:0});},AF=new W.GraphMatrixHelper({data:AJ}),AI=function(AK){if(!AF.shape){AF.shape=AK;r=true;}},m=function(AK,AQ){z(AK,AQ);if(!AF.metricsDropZone){if(AK===V.XAxis&&AF.xAxisObjects.length){AC(V.Columns);}else{if(AK===V.YAxis&&AF.yAxisObjects.length){AC(V.Rows);}}}var AN=o.getHost(),AO=AN.GMController,AM,AP=AO.getChartInfo(),AL={dndGM:false};if(AO.shallWeUseGroupInfo){AM=AO.getGroupInfo();if((AP.dirc===Z.VERTICAL&&AK===V.YAxis)||(AP.dirc===Z.HORIZONTAL&&AK===V.XAxis)){AM=o.fillGroupInfo(AL,AM,AG.did,true);}AO.setGroupInfo(AM);r=true;}};AF.setData(AJ.dz);AF.setMetricsDropZone(AJ.dz);if(AG.t===Q.DssTypeMetric){if(AD){if(!AF.yAxisObjects.length){z(V.YAxis);}else{w(V.YAxis,AF.yAxisObjects[0]);z(V.YAxis);}}else{if(AF.exists(AG,"yAxisObjects")||AF.exists(AG,"xAxisObjects")||AF.exists(AG,"sizeByObjects")||AF.exists(AG,"colorByObjects")||AF.exists(AG,"angleObjects")){var AB=!AF.exists(AG,"yAxisObjects")&&!AF.exists(AG,"xAxisObjects");if(AB&&(!AF.yAxisObjects.length||AF.yAxisObjects[0].t===4)){m(V.YAxis);}else{if(AB&&(!AF.xAxisObjects.length||AF.xAxisObjects[0].t===4)){m(V.XAxis);}else{if(!AF.angleObjects.length&&p(AF)){z(V.Angle);}else{if(!j&&!AF.colorByObjects.length){z(V.ColorBy);}else{if(!AF.sizeByObjects.length||(!AF.exists(AG,"sizeByObjects")&&AE())){z(V.SizeBy);}}}}}}else{if(!j&&!AF.angleObjects.length&&p(AF)){z(V.Angle);}else{if((!AF.yAxisObjects.length)&&(!AF.xAxisObjects.length)){m(V.YAxis);if(!j&&!a){AI(M.PROP_SHAPE_BAR);}}else{if(AF.yAxisObjects.length&&!AF.xAxisObjects.length){if((j||a)&&AF.yAxisObjects[0].t===4){m(V.YAxis);}else{if(!AF.exists(AG,"yAxisObjects")){m(V.XAxis);if(!j&&!a){AI(o.isMetricZone(V.YAxis)?M.PROP_SHAPE_CIRCLE:M.PROP_SHAPE_BAR);}}}}else{if((!AF.yAxisObjects.length)&&AF.xAxisObjects.length){if((j||a)&&AF.xAxisObjects[0].t===4){m(V.XAxis);}else{if(!AF.exists(AG,"xAxisObjects")){m(V.YAxis);if(!j&&!a){AI(o.isMetricZone(V.XAxis)?M.PROP_SHAPE_CIRCLE:M.PROP_SHAPE_BAR);}}}}else{if((AF.xAxisObjects[0].t!==4)&&(AF.yAxisObjects[0].t===4)&&!AF.exists(AG,"yAxisObjects")&&!AF.exists(AG,"sizeByObjects")&&!AF.exists(AG,"colorByObjects")){m(V.YAxis);if(AF.metricsDropZone!==M.PROP_COLUMNS&&AF.metricsDropZone!==M.PROP_ROWS&&(!AF.colorByObjects.length||AF.colorByObjects[0].t!==4)){AC(V.ColorBy);}}else{if((AF.xAxisObjects[0].t===4)&&(AF.yAxisObjects[0].t!==4)&&!AF.exists(AG,"xAxisObjects")&&!AF.exists(AG,"sizeByObjects")&&!AF.exists(AG,"colorByObjects")){m(V.XAxis);if(AF.metricsDropZone!==M.PROP_COLUMNS&&AF.metricsDropZone!==M.PROP_ROWS&&(!AF.colorByObjects.length||AF.colorByObjects[0].t!==4)){AC(V.ColorBy);}}else{if((AF.xAxisObjects[0].t===4)&&(AF.yAxisObjects[0].t===4)&&!AF.exists(AG,"xAxisObjects")&&!AF.exists(AG,"yAxisObjects")&&!AF.exists(AG,"sizeByObjects")&&!AF.exists(AG,"colorByObjects")){if(!j&&!AF.colorByObjects.length&&AF.metricsDropZone!==M.PROP_COLORBY){z(V.ColorBy);}else{if(!AF.sizeByObjects.length&&AF.shape!=="Area"){z(V.SizeBy);}else{if(AF.xAxisObjects.length===1){m(V.XAxis);}else{if(AF.yAxisObjects.length===1){m(V.YAxis);}else{if(AF.sizeByObjects.length===1&&AF.shape!=="Area"){z(V.SizeBy);}else{if(!AF.exists(AG,"tooltipMetrics")){z(V.AdditionalMetrics);}}}}}}}else{if(!j&&!AF.colorByObjects.length&&AF.metricsDropZone!==M.PROP_COLORBY){z(V.ColorBy);}else{if(!AF.sizeByObjects.length){z(V.SizeBy);}else{if(!AF.exists(AG,"tooltipMetrics")){z(V.AdditionalMetrics);}}}}}}}}}}if((!b)&&h){if(AF.exists(AG,"tooltipMetrics")){var v=S.find(AF.tooltipMetrics,"did",AG.did);if(v>-1){AF.tooltipMetrics.splice(v,1);w(V.AdditionalMetrics,AG);}}}}if(h&&d){var u=o.getHost(),l=u.getVisType().vt,k=D.getDefaultGMThreshold(l);D.addThresholds(u.model,u,u.node,AG,c,k.colors,k.ranges,false);}}}else{if(AD){z(V.XAxis);}else{if((AH.rows||[]).concat(AH.cols||[]).some(function(AK){return AK.did===AG.did;})){if(j&&AF.exists(AG,"breakByObjects")){}else{if(!AF.colorByObjects.length||(AF.colorByObjects[0].t!==4&&!AF.exists(AG,"colorByObjects"))){z(V.ColorBy);}}}else{if(!j&&!AF.sliceObjects.length&&p(AF)){z(V.SliceBy);if(!AF.colorByObjects.length){z(V.ColorBy);}}else{if((!AF.yAxisObjects.length)&&(!AF.xAxisObjects.length)){z(V.XAxis);if(!j&&!a){AI(F(AG)?M.PROP_SHAPE_LINE:M.PROP_SHAPE_BAR);}}else{if((AF.yAxisObjects.length)&&(!AF.xAxisObjects.length)){if((j||a)&&AF.yAxisObjects[0].t!==4){z(V.Rows);}else{z(V.XAxis);if(!j&&!a){AI(F(AG)&&AF.yAxisObjects[0]===4?M.PROP_SHAPE_LINE:M.PROP_SHAPE_BAR);}}}else{if((!AF.yAxisObjects.length)&&(AF.xAxisObjects.length)){if((j||a)&&AF.xAxisObjects[0].t!==4){z(V.Columns);}else{z(V.YAxis);if(!j&&!a){AI(F(AG)&&AF.xAxisObjects[0]===4?M.PROP_SHAPE_LINE:M.PROP_SHAPE_BAR);}}}else{if((AF.xAxisObjects[0].t!==4)&&(AF.yAxisObjects[0].t===4)){if(j&&!AF.breakByObjects.length){z(V.BreakBy);}else{if(!AF.colorByObjects.length&&!j){z(V.ColorBy);if(!AF.exists(AG,"breakByObjects")){z(V.BreakBy);}}else{z(V.Columns);}}}else{if((AF.xAxisObjects[0].t===4)&&(AF.yAxisObjects[0].t!==4)){if((j||a)&&!AF.breakByObjects.length){z(V.BreakBy);}else{if(!AF.colorByObjects.length&&!j){z(V.ColorBy);if(!AF.exists(AG,"breakByObjects")){z(V.BreakBy);}}else{z(V.Rows);}}}else{if((AF.xAxisObjects[0].t!==4)&&(AF.yAxisObjects[0].t!==4)){z(V.Columns);}else{if((AF.xAxisObjects[0].t===4)&&(AF.yAxisObjects[0].t===4)){if((j||a)&&!AF.breakByObjects.length){z(V.BreakBy);}else{if(!AF.colorByObjects.length&&!j){z(V.ColorBy);if(!AF.exists(AG,"breakByObjects")){z(V.BreakBy);}}else{if(!AF.columnObjects.length&&AF.rowObjects.length&&AF.rowObjects[0].t!==4){z(V.Rows);}else{z(V.Columns);}}}}}}}}}}}}}}var n=[];if(c.length){if(x){z(V.AdditionalMetrics,o.getTooltipDropzoneIdx(AG));}var t=o.getUpdateTemplateAction(c);var e=o.docModel,AA=e.controller.view.builder,q=AA.getLayoutVIMap(e.getCurrentLayoutKey()).getComponent(mstrmojo.vi.models.VIComponentMap.TYPES.FILTER_STACK);if(q&&!mstrApp.isInVFConfigMode){t.partialRetrieval.nodes.push(q.k);}n.push(t);}if(r){n.push({act:"setProperty",nodeKey:AJ.k,prs:"FormattingWidget",pri:4,v:mstrmojo.string.encodeXMLAttribute(AF.getXml())});}if(n.length){o.clearCardinalityFlags();o.findLargeItemsForAddUnits([AG]);}return n;}function R(d,f,e,a){var b,c=true;function g(l,n,k){var m=a.getZoneModelByZoneId(l);if(a.getUnitIndexInZone(m,d)===-1&&(!k||k(m))){var j=n?0:m.items.length;b=a.getAddItemActions(m,[d],j,false,n?m.items[j]:null,f);m.items.push(d);return false;}return true;}function h(j){return j.items.length===0;}if(!a.isMetric(d)){c=g(V.ColorBy,false,h);c=c&&g(V.Grouping);if(b){a.clearCardinalityFlags();a.findLargeItemsForAddUnits([d]);}}else{c=g(V.SizeBy,false,h);c=c&&g(V.ColorBy,false,h);c=c&&g(V.SizeBy,true,function(j){return j.items[0].did===a.getZoneModelByZoneId(V.ColorBy).items[0].did;});c=c&&g(V.AdditionalMetrics,false,function(){return a.getUnitIndexInZone(a.getZoneModelByZoneId(V.SizeBy),d)===-1&&a.getUnitIndexInZone(a.getZoneModelByZoneId(V.ColorBy),d)===-1;});}return b?[a.docModel.getDataService().getUpdateTemplateAction(a.getHost().k,b)]:[];}function U(c,e,d,a){var b=null,f=!a.isMetric(c)?[V.FromItem,V.ToItem]:[V.ColorBy,V.ItemSize,V.SizeBy];S.forEach(f,function(g){var h=a.getZoneModelByZoneId(g);if(h.items.length===0){b=a.getAddItemActions(h,[c],0,e);h.items.push(c);return false;}});if(b){a.clearCardinalityFlags();a.findLargeItemsForAddUnits([c]);return[a.docModel.getDataService().getUpdateTemplateAction(a.getHost().k,b)];}return[];}function E(b){var d=8,e=1,a=S.find(b.fs,"idf",true);if(a==-1){return null;}var c=b.fs[a];return((b.da||c.obf)&&(c.bftp===d||c.bftp===e))?c:null;}function C(a){return !!(a.fs&&E(a));}function O(e,g,f,a){var c=null,h=!a.isMetric(e)?[V.BreakBy,V.Trend]:[V.Metric];trendZone=a.getZoneModelByZoneId(V.Trend);if(C(e)&&trendZone.items.length===0){c=a.getAddItemActions(trendZone,[e],0,g);trendZone.items.push(e);}else{for(var d=0;d<h.length;d++){var b=a.getZoneModelByZoneId(h[d]);if(b.items.length===0){c=a.getAddItemActions(b,[e],0,g);b.items.push(e);break;}}}if(c){a.clearCardinalityFlags();a.findLargeItemsForAddUnits([e]);return[a.docModel.getDataService().getUpdateTemplateAction(a.getHost().k,c)];}return[];}function Y(c,e,d,a){var b=null,f=!a.isMetric(c)?[V.GeoAttribute,V.Layout]:[V.ColorBy,V.SizeBy,V.AdditionalMetrics];S.forEach(f,function(g){var h=a.getZoneModelByZoneId(g);if((g===V.AdditionalMetrics||h.items.length===0)&&a.isZoneAvalaible(g)){b=a.getAddDropZoneUnitsActions(h,[c],0,{datasetId:e});return false;}});return b?[a.docModel.getDataService().getUpdateTemplateAction(a.getHost().k,b)]:[];}function K(AC,g,AI,l,c,v){var AD=AI.gsi||{},k=l.getHost(),p=k.fnGetWidget(),w=p&&p.scriptClass==="mstrmojo.mapbox.VisMapbox",m=[],o=false,z=l.getZoneModelByZoneId(V.ColorBy),AA=l.getZoneModelByZoneId(V.SizeBy),x=l.getZoneModelByZoneId(V.Angle),r=l.getZoneModelByZoneId(V.SliceBy),e=l.getZoneModelByZoneId(V.AdditionalMetrics),AB=mstrmojo.vi.viz,n=AB.MapHelper,h=false,d=function(AO,AN,AL,AP){if(AO){var AM=l.getCreateDropZonesAction(AL);m=m.concat(AM.length?l.getUpdateTemplateAction(AM):[]);m.push(l.getUpdateTemplateAction([{act:"addDropZoneUnit",zoneId:AL,unitId:AO,unitType:AN,datasetId:AP}]));if(AL===V.ColorBy){m.push(l.getUpdateTemplateAction(D.addThresholds(k.model,k,k.node,AC)));}}switch(AL){case V.GeoAttribute:c.geoAttribute=AO;break;case V.Latitude:c.latitude=AO;break;case V.Longitude:c.longitude=AO;break;case V.SliceBy:if(!c.slice){c.slice=[];}c.slice.push(AO);break;case V.ColorBy:c.colorBy=AO;break;case V.SizeBy:c.sizeBy=AO;break;case V.Angle:c.angle=AO;break;case V.AdditionalMetrics:c.tooltip.push(AO);break;}h=true;},j=function(AN,AM,AL,AO){d(AN,AM,AL,AO);if(w&&n.shouldSyncItemToTooltipZone(AN,AL,c&&c.tooltip)){d(AN,AM,V.AdditionalMetrics,AO);}},AK=function(AO,AN,AL){if(AO){m.push(l.getUpdateTemplateAction([{act:"removeDropZoneUnit",zoneId:AL,unitId:AO,unitType:AN}]));}switch(AL){case V.geoAttribute:c.geoAttribute="";break;case V.Latitude:c.latitude="";break;case V.Longitude:c.longitude="";break;case V.SliceBy:var AM=c.slice.indexOf(AO);if(AM!==-1){c.slice(AM,1);}break;case V.Angle:c.angle="";break;case V.ColorBy:c.colorBy="";break;case V.SizeBy:c.sizeBy="";break;case V.AdditionalMetrics:c.tooltip=S.filter(c.tooltip,function(AP){return AP!==AO;},{max:c.tooltip.length});break;}},AH=function(AL,AM){m.push(l.getUpdateTemplateAction({act:"addForm",unitId:AL,attFormId:AM,unitPos:1}));};c.setWidget(k);S.forEach((AD.rows||[]).concat(AD.cols||[]),function(AL){if(AL.did===AC.did){o=true;return false;}});if(o){return[];}switch(AC.t){case 4:if(z&&!z.items.length){j(AC.did,AC.t,V.ColorBy,g);}else{if(AA&&!AA.items.length){j(AC.did,AC.t,V.SizeBy,g);}else{if(x&&!x.items.length){j(AC.did,AC.t,V.Angle,g);}else{if(e){var u=AC.did;if(c.colorBy.indexOf(u)<0&&c.sizeBy.indexOf(u)&&c.angle.indexOf(u)&&c.tooltip.indexOf(u)<0){j(u,AC.t,V.AdditionalMetrics,g);}}}}}break;default:var q=p.edtModel.getEditingPropertyVal(N.graphicType),a=!c.geoAttribute&&(!c.latitude&&!c.longitude||q===H.Area),b=c.getGeoForm(AC,function(AL){return n.isGeoRoleSupportArea(AL.fgr);}),f=c.getLatitudeForm(AC),AJ=c.getLongitudeForm(AC),t=function(){var AL=c.vp,AN=c.tooltip;if(!n.canShowSizeByZone(AL)&&c.sizeBy&&AN.indexOf(c.sizeBy)<0){j(c.sizeBy,4,V.AdditionalMetrics);AK(c.sizeBy,4,V.SizeBy);}if(!n.canShowColorByZone(AL)&&c.colorBy&&AN.indexOf(c.colorBy)<0){j(c.colorBy,4,V.AdditionalMetrics);AK(c.colorBy,4,V.ColorBy);}if(!n.showAngleZone(AL)&&c.angle&&AN.indexOf(c.angle)<0){j(c.angle,4,V.AdditionalMetrics);AK(c.angle,4,V.Angle);}if(!n.showSliceZone(AL)&&c.slice&&c.slice.length>0){var AM=c.slice;S.forEach(AM,function(AO){j(AO,12,V.AdditionalMetrics);AK(AO,12,V.SizeBy);});}};if(a&&c.supportAreaMap&&b&&!((q!==H.Area)&&(f||AJ))){c.setMapType(H.Area);c.setUseAttributeForm(false);j(AC.did,AC.t,V.GeoAttribute,g);AH(AC.did,b.fid);}else{var AF=(v&&AC.card>500)?H.Density:((q!==H.Area)?q:H.Marker);if(f&&AJ&&a){j(AC.did,AC.t,V.GeoAttribute,g);c.setMapType(AF);c.setUseAttributeForm(true);AH(AC.did,f.fid);AH(AC.did,AJ.fid);j(f.fid,21,V.Latitude,g);j(AJ.fid,21,V.Longitude,g);}else{if((f||n.isLatitude(AC.n))&&(!AJ&&!n.isLongitude(AC.n))&&!c.geoAttribute&&!c.latitude){j(AC.did,AC.t,V.Latitude,g);c.setMapType(AF);c.setUseAttributeForm(false);}else{if((!f&&!n.isLatitude(AC.n))&&(AJ||n.isLongitude(AC.n))&&!c.geoAttribute&&!c.longitude){j(AC.did,AC.t,V.Longitude,g);c.setMapType(AF);c.setUseAttributeForm(false);}else{if(!f&&!AJ&&!b&&r){j(AC.did,AC.t,V.SliceBy,g);}else{if(c.tooltip.indexOf(AC.did)<0){j(AC.did,AC.t,V.AdditionalMetrics,g);}}}}}}if(h){t();}break;}if(h){m.push({act:"setProperty",nodeKey:AI.k,prs:"FormattingWidget",pri:4,v:mstrmojo.string.encodeXMLAttribute(c.getXml())});}if(m.length){var AE=AI.visName,q=c.getMapType(),AG=c.getLayerName();l.addAttributeNameAndTargetVisForAddUnits(AI,[AC],AE,q,AG);l.clearCardinalityFlags();l.findLargeItemsForAddUnits([AC]);}return m;}function B(n,e,d,l){var p=l.getHost().model,k=d.gsi||{},o=k.rows||[],h=k.cols||[],g=k.mx||[],c=[],b,j,a,m;l.clearCardinalityFlags();if(S.find(o.concat(h).concat(g),"did",n.did)===-1&&!p.hasSameRecursiveAttributeGroup(n)){m=!!S.filterOne(h,function(q){return q.t!==4;});a=!!S.filterOne(o,function(q){return q.t!==4;});if(n.t===4){b=-1;if(g.length===0){if(!a&&!!m){b=1;j=o.length;l.findEstimatedTotalRow([n],b);}else{b=2;j=h.length;}}else{if(o.some(function(q){return q.did==="-1";})){var f=1;l.findEstimatedTotalRow([n],f);}}j=g.length;}else{if(m&&!a){b=2;j=h.length;l.findLargeItemsForAddUnits([n]);l.findTotalColumnCount([n],null);}else{b=1;j=o.length;l.findEstimatedTotalRow([n],b);}}c.push({act:"updateTemplate",keyContext:d.k,actions:[p.getAddTemplateUnitAction(n,e,b,j)]});}return c;}mstrmojo.vi.models.DatasetDoubleClick=mstrmojo.provide("mstrmojo.vi.models.DatasetDoubleClick",{addObject:function(h,c,g){var b=P(g),a=[],f=g.getHost();if(!h||!b){return a;}var j=b.visName||"Grid";switch(A.getDefinition(j).id){case A.GRAPHMATRIX:case A.NEWGRAPHMATRIX:a=I(h,c,b,g);break;case A.ESRIMAP:case A.GOOGLEMAP:a=K(h,c,b,g,new W.MapHelper({data:b}),true);break;case A.MAPBOX:a=K(h,c,b,g,new W.MapHelper({data:b}),false);break;case A.HEATMAP:a=R(h,c,b,g);break;case A.NETWORK:a=U(h,c,b,g);break;case A.KPICARD:a=O(h,c,b,g);break;case A.IMAGELAYOUT:a=Y(h,c,b,g);break;case A.CUSTOM:a=(g.getCustomDropZones&&g.getCustomDropZones())?[]:B(h,c,b,g);break;default:a=B(h,c,b,g);break;}if(c!==b.datasetId){var e=g.getHost().model.data.gsi;var d=e?(e.rows||[]).concat(e.cols||[]).concat(e.mx||[]):[];if(c&&(a.length||mstrmojo.array.find(d,"did",h.did)!==-1)){a.push({act:"editNode",nodeKey:f.k,datasetId:c});}}return a;}});}());(function(){mstrmojo.requiresCls("mstrmojo.Button");mstrmojo.HTMLButton=mstrmojo.declare(mstrmojo.Button,null,{scriptClass:"mstrmojo.HTMLButton",markupString:'<input id="{@id}" type="button" class="mstrmojo-text mstrmojo-HTMLButton mstrButton {@cssClass} {@iconClass}" title="{@title}" style="{@cssText}" mstrAttach:click />',markupSlots:{inputNode:function(){return this.domNode;}},markupMethods:{onvisibleChange:function(){this.domNode.style.display=this.visible?"inline":"none";},onenabledChange:function(){mstrmojo.css[this.enabled?"removeClass":"addClass"](this.domNode,["disabled"]);},onselectedChange:function(){mstrmojo.css[this.selected?"addClass":"removeClass"](this.domNode,["selected"]);},ontextChange:function(){this.inputNode.value=this.text!=null?this.text:"";},oniconClassChange:function(){this.domNode.className="mstrmojo-text mstrmojo-HTMLButton mstrButton "+this.cssClass+" "+this.iconClass+(this.enabled?"":" disabled");}}});})();(function(){mstrmojo.requiresCls("mstrmojo.array","mstrmojo.Container","mstrmojo.Button","mstrmojo.vi._MonitorsAppState");var J=mstrmojo.array;var E=1,B=2,O=4,L=8,H=16,R=32;function K(X,W,U,V,Y,S){return mstrmojo.Button.newWebButton(X,function(Z){this.parent.set("_targetMode",W);Z.cancel();},U,{alias:V,flgVis:Y,flgEnabled:S||undefined});}mstrmojo.vi.ui.TargetSelector=mstrmojo.declare(mstrmojo.Container,[mstrmojo.vi._MonitorsAppState],{scriptClass:"mstrmojo.vi.ui.TargetSelector",markupString:'<div id="{@id}" class="mstrmojo-TargetSelector {@cssClass}" style="{@cssText}"><div></div></div>',markupSlots:{containerNode:function(){return this.domNode.firstChild;}},init:function N(S){this._super(S);if(!this.hostId){throw new Error("You must pass the hostId when instantiating mstrmojo.vi.ui.TargetSelector.");}if(!this.srcId){this.srcId=this.hostId;}this.hostBox=mstrmojo.all[this.hostId];this.srcBox=mstrmojo.all[this.srcId];this._targetMode=E;},onAppStateChange:function M(S){var V=mstrmojo.vi.VisualInsightApp.APP_STATES,W=V.SELECTOR_TARGETING,U=this.btnSelect;if(S.valueWas&W||S.value&W){U.set("enabled",!mstrApp.isAppStateSelection());}},hostId:null,srcId:null,markupMethods:{onvisibleChange:mstrmojo.Widget.visibleMarkupMethod,onhostIdChange:function(){this.hostBox=mstrmojo.all[this.hostId];},onsrcIdChange:function(){this.srcBox=mstrmojo.all[this.srcId];},on_targetModeChange:function(){var Y=this._targetMode,Z=this.hostBox,S=this.srcBox,U=this.id,c=S.model,V=c.getVizContentPanel(),b=Y===R,W=function(){this.preChangeTargetSelectionMode(false,c);V.exitTargetSelectionMode(b,this.restoreChildren.bind(this));}.bind(this);this.children.forEach(function(d){d.set("visible",(d.flgVis&Y)>0);d.set("enabled",(!d.flgEnabled||(d.flgEnabled&Y)>0));d.refresh();});this.set("visible",Y!==E);if(b||Y===B){W();if(!b){this.set("_targetMode",this._cancelMode);this.cancel(Z);}this.exitTargetSelectionMode(Z);}else{if(Y===L){this.preChangeTargetSelectionMode(true,c);V.enterTargetSelectionMode(function(e,f){var d=f?E:L;if(!f&&Z.isSelectionDirty(e,f)){d=H;}mstrmojo.all[U].set("_targetMode",d);if(f){Z.setTargets(e);}},this.srcId,Z.getTargetKeys(),this.enterTargetSelectionMode.bind(this),W);}}var X=mstrmojo.vi.VisualInsightApp.APP_STATES,a=mstrApp.isAppStatePause&&mstrApp.isAppStatePause();mstrApp.set("appState",Y===L||Y===H?(a?X.SELECTOR_TARGETING|X.PAUSE:X.SELECTOR_TARGETING):(a?X.PAUSE:X.DEFAULT));}},ignoreLayout:true,setSourceByKey:function(V){var X=this.srcBox.model.getVizContentPanel(),U=(X&&X.children)||[],S=J.find(U,"k",V),W=(S>-1)?U[S]:null;if(W){this.set("srcId",W.id);}},preChangeTargetSelectionMode:function Q(W,U){var X=U.getVizContentPanel().parent.selector,V=U.controller.view,S=V.layoutViewer.docLayout.selector;S.set("isMasked",W);X.set("isMasked",W);},enterTargetSelectionMode:function G(V){var U=this.srcId,S=mstrmojo.all[U].defn;V.setMaskClass(U);V.set("enabled",V.validateTarget&&V.validateTarget(S));},exitTargetSelectionMode:function D(S){S.close();},restoreChildren:function I(S){S.set("enabled",true);S.clearMaskClass();},cancel:function C(S){if(S){S.cancel();}},enterPreSelectMode:function F(){this._cancelMode=O;this.set("_targetMode",O);},enterSelectMode:function P(){this._cancelMode=E;this.set("_targetMode",L);},enterOffMode:function A(){this._cancelMode=E;this.set("_targetMode",E);},children:[K(mstrmojo.desc(4799,"Select Target"),L,true,"btnSelect",O),K(mstrmojo.desc(221,"Cancel"),B,false,"btnCancel",L+H),K(mstrmojo.desc(134,"Apply"),R,true,"btnApply",L+H,H)]});}());(function(){mstrmojo.requiresCls("mstrmojo.hash","mstrmojo.Button","mstrmojo.EnumRWUnitType","mstrmojo.vi.models.VIComponentMap","mstrmojo.VisEnum","mstrmojo.gmaps.EnumGraphicType","mstrmojo.models.template.DataInterface");mstrmojo.requiresDescs(15518,15519,15526);var F=mstrmojo.array,C=12,B=4,D="-1",H=1,G=2,I=-1,E=mstrmojo.Button.newWebButton,J=mstrmojo.vi.models.VIComponentMap.TYPES,A=mstrmojo.models.template.DataInterface;mstrmojo.vi.models._CheckDataCards=mstrmojo.provide("mstrmojo.vi.models._CheckDataCards",{_mixinName:"mstrmojo.vi.models._CheckDataCards",CARDLIMIT:mstrmojo.VisEnum.VIS_CARDLIMIT.NON_GRID,isUnitRestrictedInViz:function(){var P=this.getHost&&this.getHost(),O=P&&P.defn,L=!!(O&&O.iifp);if(L){return false;}var K=this.docModel,M=[],N=K.getVIComponent(J.FILTER_PANEL),Q=N&&N.parent;M=M.concat((Q&&Q.getFilterDefinitions())||[]);return M.length;},_addInLargeItems:[],_columnCardinalityCount:1,_totalRow:0,clearCardinalityFlags:function(){this._addInLargeItems=[];this._columnCardinalityCount=1;this._totalRow=0;},existLargeOrManyItems:function(){return(!!this._addInLargeItems.length||this._columnCardinalityCount>this.CARDLIMIT);},existLargeRowCount:function(){return(this._totalRow>mstrmojo.vi.models.editors.XtabEditorModel.ENUM_MAX_ROWS_OUTLINE);},findTotalColumnCount:function(P,Q){var R=this,U,M=1,O=0,S=this.getHost().gridData;R._columnCardinalityCount=1;if(S){if(Q&&Q.id===H){var K=S.rw,V=K&&K.row;R._columnCardinalityCount=(V&&V.tc)||1;return ;}var L=S.ghs,N=L&&L.chs;F.forEach(N&&N.items,function(W){if(W.items){M=Math.max(M,W.items.length);}});}F.forEach(P,function(W){if(Q&&Q.id===G){Q.items.every(function(X){if(X.t===C&&X.did===W.did&&X.card){O++;M=M/X.card;return false;}return true;});}U=W.cardg>0?W.cardg:W.card;if(!U&&W.otp===C&&W.es){U=W.es.length+1;}if(U){M=M*U;}});R._columnCardinalityCount=(O===P.length)?1:M;},findEstimatedTotalRow:function(P,L,K){var R=this,X,U=1,M=0,S=this.getHost().gridData,W=this.docModel,K=K||[],Q=W&&W.datasets;R._totalRow=1;function O(a){var Z=0;Object.keys(Q).every(function(b){return Q[b].att&&Q[b].att.every(function(c){if(c.did===a){Z=c.card;return false;}return true;});});return Z;}function N(Z){return P.some(function(a){return Z.did===a.did;})||K.some(function(a){return Z.did===a.did;});}if(S){var Y=S.gsi.rows,V=S.gsi.mx;F.forEach(Y,function(Z){if(N(Z)){return ;}if(Z.t===C){U*=O(Z.did)||1;}else{if(Z.t===B){if(Z.did===D&&V){M=V.length;F.forEach(V,function(a){N(a)&&M--;});}}}});}F.forEach(P,function(Z){if(Z.t===B){if(L===H||L===I){if(Z.did===D&&S&&S.gsi.mx){M=S.gsi.mx.length;}else{M++;}}}X=Z.cardg>0?Z.cardg:Z.card;if(!X&&Z.otp===C&&Z.es){X=Z.es.length+1;}if(X){if(L===H){U=U*X;}}});U=U+U*M;R._totalRow=U;return R._totalRow;},addAttributeNameAndTargetVisForAddUnits:function(R,P,Q,O,M){if(!R){return ;}var N={data:R},K=R&&R.vp,L;Q=Q||R&&R.vis&&R.vis.vn;O=O||K&&K.gtp;M=M||K&&K.ln;L=Q===mstrmojo.vi.viz.EnumVizStyles.GOOGLE_MAP||Q===mstrmojo.vi.viz.EnumVizStyles.ESRI_MAP||Q===mstrmojo.vi.viz.EnumVizStyles.MAPBOX;F.forEach(P,function(S){var V=S.id,U;if(V&&!S.attributeName){U=A.prototype.getUnitById.call(N,V);S.attributeName=U&&U.unit&&U.unit.n;}if(O===mstrmojo.gmaps.EnumGraphicType.Area&&L){if(!S.targetVis){S.targetVis={};}S.targetVis.vis=Q;S.targetVis.gtp=O;S.targetVis.ln=M;}else{if(S.targetVis){S.targetVis=undefined;}}});},findLargeItemsForAddUnits:function(K,L,O){var N=this,P,M={};if((!L&&!N.isUnitRestrictedInViz())||L){K.forEach(function(S){var Q=S.cardg>0?S.cardg:S.card;P=!!O?O:N.CARDLIMIT;if(S.targetVis&&S.targetVis.gtp===mstrmojo.gmaps.EnumGraphicType.Area){P=mstrmojo.VisEnum.VIS_CARDLIMIT.AREA_MAP;}if(Q&&Q>P){var U=S.attributeName||S.n;if(!M[U]){M[U]=true;var R=S.targetVis&&S.targetVis.ln?(U+"("+S.targetVis.ln+") ("+Q+")"):U+" ("+Q+")";N._addInLargeItems.push(R);}}});}},warnAndExecCallBackForOutlineAddUnits:function(M,L){var K=this,L=L||mstrmojo.emptyFn;if(this.existLargeRowCount()){mstrmojo.confirm(mstrmojo.desc(15792,"The dossier will attempt to display more than 5000 rows in outline mode. This may affect performance and stability. Do you want to continue?"),null,{id:"OutlineModeWarningDialog",title:mstrmojo.desc(11812,"Notification"),allowHTML:false,buttons:[mstrmojo.Button.newWebButton(mstrmojo.desc(212,"Continue"),M),mstrmojo.Button.newWebButton(mstrmojo.desc(3416,"Cancel"),L)],onPreClose:function(){L();return true;}});}else{M();}},checkAndWarnForOutlineAddUnits:function(K,M,O,N,L){if(this.getHost().isOutlineMode){this.findEstimatedTotalRow(K,M,L);this.warnAndExecCallBackForOutlineAddUnits(O,N);}else{O();}},warnAndExecCallBackForAddUnits:function(R,P,M,Q){if(this.existLargeOrManyItems()&&!mstrApp.isAppStatePresentation()){var N=this._addInLargeItems,O=N.length,L;if(O>1){L=mstrmojo.desc(15518,"The following attributes contain a large number of elements: ##. This action may impact dossier performance.").replace("##",N);}else{if(O===1){L=mstrmojo.desc(15519,"The attribute ## has too many elements. This action may impact dossier performance.").replace("##",N);}else{L=mstrmojo.desc(15526,"The dossier will attempt to display more than ### columns. This can affect performance and stability.").replace("###",this.CARDLIMIT);}}var K=[];if(O&&P){K.push(E(mstrmojo.desc(7977,"Move to Rows"),function(){P();},true));}K.push(E(mstrmojo.desc(212,"Continue"),function(){R();}));K.push(E(mstrmojo.desc(2140,"Cancel"),function(){if(M){if(Q){Q();}else{if(mstrApp.isWorkstation&&mstrApp.isSingleTier){window.FormWrapper.closeWindow("{}");}else{mstrmojo._DocToolbarActions.close.call({model:{isnew:false}});}}}}));mstrmojo.warn(L,{},{buttons:K});N.splice(0,N.length);return ;}R();},checkAndWarnLargeItemsForAddUnits:function(N,R,P,K,M,L,O,Q){this.clearCardinalityFlags();if(!M||M.id===G){this.findLargeItemsForAddUnits(N,L,O);}if(K){this.findTotalColumnCount(N,M);}this.warnAndExecCallBackForAddUnits(R,P,L,Q);}});}());(function(){mstrmojo.requiresCls("mstrmojo.EnumRWUnitType","mstrmojo.vi.viz.EnumVizStyles","mstrmojo.hash","mstrmojo.Button","mstrmojo.vi.ui.rw._IsOutlineXtab","mstrmojo.css");mstrmojo.requiresDescs(619,1442,15963,16112,16113);var B=mstrmojo.EnumRWUnitType,A=mstrmojo.vi.viz.EnumVizStyles,Q=mstrmojo.hash,C={},N=mstrmojo.array,V=mstrmojo.DynamicClassFactory.newComponent;C[B.HEADER]=C[B.FOOTER]=C[B.PAGEHEADER]=C[B.PAGEFOOTER]=C[B.DETAILS]={n:"Section"};C[B.HTMLCONTAINER]={n:"HTMLContainer"};C[B.SELECTOR]={n:"Selector"};C[B.GRID]={n:"Xtab"};C[B.MOJOVISUALIZATION]={n:"MojoVisualization"};function D(a){return(a&&a.t)||mstrmojo.EnumRWUnitType.LAYOUT;}mstrmojo.DocBuilder=mstrmojo.declare(mstrmojo.Obj,null,{scriptClass:"mstrmojo.DocBuilder",visList:null,selectorFactory:null,classMap:null,init:function U(a){this._super(a);var b=this.selectorFactory=this.createSelectorFactory();this.addDisposable(b);this.classMap=this.createClassMap();},createSelectorFactory:function Z(){this.throwAbstractMethodError("getSelectorFactory");},createClassMap:function F(){return Q.copy(C);},getMojoVisName:function W(d){var c=d.data,e=c&&c.visName||"",a=D(d.defn),b=c&&c.vis;if(!e){if(b&&(a===B.GRID||a===B.GRAPH||a===B.GRIDGRAPH)){if(b.vn&&b.ve&&b.vm===51){e=Q.walk("dz.visProp.fmt.visStyle",c)||b.vn;}else{if(b.we&&b.wcn){e=this.visList.findVisName(b.wcn);}}}}if(e===A.NEW_GRAPH_MATRIX){if(mstrApp.supportFeature&&mstrApp.supportFeature("ngm")){if(mstrApp.supportFeature("ngmPartial")){if(N.indexOf([76,79,80,81,82],Q.walk("data.dz.visProp.fmt.visType",d))<0){e=A.GRAPH_MATRIX;}}}else{e=A.GRAPH_MATRIX;}}return e;},build:function P(a,h,q){var o=this.classMap,j=[],l=((a&&a.length)||0),g,d,e,b,f,c,n,m,p;for(g=0;g<l;g++){d=a[g];e=d&&d.defn;b=d&&d.data;f=D(e);c=o[f];if(h.isMapLayerNode(d.k)){continue;}if(f===B.TEXTFIELD&&((e&&e.dpst))){c=o[f+"B"];}n=this.getMojoVisName(d);if(n){b.visName=n;c=C[B.MOJOVISUALIZATION];}if((n||f===B.GRID)&&e.iifp){c=C[B.SELECTOR];e.style=mstrmojo.DocSelector.STYLES.VISUALIZATION;}m=(c&&c.n)?"new"+c.n:"";p=undefined;if(this[m]){p=this[m](h,d,c,q);}else{if(c&&c.scriptClass){var k=c.cls;if(!k){k=Q.walk(c.scriptClass,window);}if(k){p=this.newRWUnitInstance(h,d,k);}}}if(p){p.k=d.k;p.builder=this;p.tooltip=b.tooltip||e.tooltip||"";if(e.iifp){p.style=mstrmojo.DocSelector.STYLES.VISUALIZATION;}if(!p.defn){p.defn=e;delete p.defn.destroyed;p.disposables.push(p.defn);}if(p.update){p.update(d);}if(this.isPortlet(e)){p=this.createPortlet(f,d,p,q);}if(!this.extractWidget(p,d)){j.push(p);}}}return j;},createPortlet:function H(b,c,a,d){return a;},newRWUnitInstance:function S(a,c,d,b){return new d(Q.copy(b||{},{id:c.id,node:c,controller:this.parent.controller,model:a}));},newSection:function X(a,b){this.throwAbstractMethodError("newSection");},newSelector:function M(c,d,b,e){var a=this.selectorFactory.newDocSelector(c,d,b,e);a.controller=this.parent.controller;return a;},isPortlet:function R(a){return !!((a.t!==B.PANEL&&a.ttl!==undefined)||a.qsm);},extractWidget:function O(b,a){return !b;},getDefaultMojoVisModel:function J(){this.throwAbstractMethodError("getDefaultMojoVisModel");},newMojoVisualization:function(f,o){var q=this.visList,b=o.data,x=b.visName===A.ESRI_MAP?A.GOOGLE_MAP:b.visName,p=q.getVis(x),u=p&&((p.dc!==undefined)?p.dc:p.c),z=this;if(!p){var d=b.className,AA=false;if(!d){if(!this._widgetNotFound){this._widgetNotFound=[];}N.forEach(this._widgetNotFound,function(AC){if(AC.name===x){AA=true;}});if(!AA){this._widgetNotFound.push({key:b.k,name:x});}var h=mstrApp.isWorkstation,v=h&&FormWrapper.isDesktop(),k=h&&!(parseInt(FormWrapper.isWSLiveMode(),10)===1),e=k?16113:16112,r=k?'The following custom visualization(s) plug-in(s) used in this dossier are not deployed in $$$$, so the data will be displayed in tabular form:<br>####<br><br>Click on the "plus" button in the Visualizations Gallery to import custom visualization plug-in(s).':"The following custom visualization(s) plug-in(s) used in this dossier are not deployed in your environment, so the data will be displayed in tabular form:<br>####<br><br>Please contact your administrator to deploy these custom visualization plug-in(s).";if(!this._showWarning){this._showWarning=window.setTimeout(function(){var AC=[];N.forEach(this._widgetNotFound,function(AD){AC.push(AD.name);});mstrmojo.warn(mstrmojo.desc(e,r).replace("$$$$",v?mstrmojo.desc(619,"Desktop"):mstrmojo.desc(15963,"Workstation")).replace("####",AC.join("<br>")),{},{buttons:[{scriptClass:"mstrmojo.Button",text:mstrmojo.desc(1442,"OK"),onclick:function(){delete z._widgetNotFound;delete z._showWarning;}}],allowHTML:true});}.bind(this),0);}var AB=this.newXtab(f,o);AB.cssDefault=!!AB.cssDefault?AB.cssDefault+" noVis":"noVis";return AB;}p={dc:d};}var c="mstrmojo."+u,m=p.b;if(mstrApp.isVI&&p.vib){m=p.vib;}else{if(mstrApp.isExpress&&p.oivmb){m=p.oivmb;}}if(m&&!mstrmojo.loader.isLoaded(c)){mstrmojo.requiresBundle(m);}mstrmojo.requiresCls(c);if(p.lib){var w=mstrmojo.getJsRoot();var j=JSON.parse(p.lib);N.forEach(j,function(AC){mstrmojo.requiresDepLib(w+AC[0],AC[1]);});}var a=this.visList.getVis(x).m,n=Q.walk(u,mstrmojo),t=a?Q.walk(a,mstrmojo):this.getDefaultMojoVisModel();if(!n||!t){throw new Error("Missing visualization class.");}n=q.getVisClass(n,o.defn);var l=new n(Q.copy(b.extProps,{id:o.id,node:o,n:o.defn.title,controller:this.parent.controller,gb:b.gbys}));var g=new t({xtab:l,controller:this.parent.controller,docModel:f});l.setModel(g);g.set("data",b);return l;},getModelClassByVisName:function L(c){var a,d,b=this.visList.getVis(c);if(!b){return null;}a=b.m;d=a?Q.walk(a,mstrmojo):this.getDefaultMojoVisModel();return d;},getEditableXtab:function G(a){this.throwAbstractMethodError("getEditableXtab");},getDefaultXtab:function E(a){this.throwAbstractMethodError("getDefaultXtab");},getCustomSortXtab:function I(){this.throwAbstractMethodError("getCustomSortXtab");},newXtab:function K(c,d,b,f){var e=mstrmojo.all[d.id];if(!e){var a=d.defn.iics?this.getCustomSortXtab():(d.defn.txi?this.getEditableXtab(d):this.getDefaultXtab(f));if(d.data&&d.data.olm&&!(d.data.rw&&d.data.rw.row.bc>0)&&!d.defn.txi){a=V(a,[mstrmojo.vi.ui.rw._IsOutlineXtab]);}e=this.newRWUnitInstance(c,d,a);e.model=this.newXtabModel({xtab:e,docModel:c});}else{e.set("node",d);e.model.set("docModel",c);}return e;},newXtabModel:function Y(a){this.throwAbstractMethodError("newXtabModel");}});mstrmojo.DocBuilder.ClassMapItemType=null;}());(function(){mstrmojo.requiresCls("mstrmojo.Button");mstrmojo.MenuItem=mstrmojo.declare(mstrmojo.Button,null,{scriptClass:"mstrmojo.MenuItem",markupString:'<div id="{@id}" class="mstrmojo-MenuItem {@cssClass} {@iconClass}" title="{@title}" style="{@cssText}" mstrAttach:click><div class="mstrmojo-MenuItem-text"></div></div>',markupSlots:{textNode:function(){return this.domNode.firstChild;}}});})();(function(){mstrmojo.requiresCls("mstrmojo.Widget","mstrmojo.color","mstrmojo.css","mstrmojo.dom","mstrmojo.GridBase","mstrmojo.array");var Y=mstrmojo.css,O=mstrmojo.color,d=mstrmojo.css,E=mstrmojo.dom,I=E.isEdge;function C(f,g){var h=f&&f.parent;while(h&&h.scriptClass.indexOf("DocPanelStack")===-1){if(g in h){return h;}h=h.parent;}return null;}function B(g){var f=document.createElement("img");g.appendChild(f);g.removeChild(f);}function F(f,g){var j=Math.floor(f/g.rowsPerPage),l=f%g.rowsPerPage,k=g.tableNode.tBodies[j],h=k.rows[l].cells;return h;}function J(){var f=this._renderTimer;if(f){self.clearInterval(f);delete this._renderTimer;this.renderingRows=false;}}mstrmojo.Grid=mstrmojo.declare(mstrmojo.GridBase,null,{scriptClass:"mstrmojo.Grid",rowsPerPage:0,effectiveRh:0,numPagesRendered:0,totalPages:0,pageStatus:null,_defaultPageHeight:0,renderPause:10,rhMin:14,defaultRowsPerPage:100,minRowsPerPage:50,init:function H(f){this._super(f);this.forceFixedSizes=true;},initPageSettings:function P(){var j=this.parent,g=j.gridData,h=this.defaultRowsPerPage,f=this.cp.getAvailableRowsCount();this.effectiveRh=this.rh||this.rhMin||1;this.effectiveRh=this.effectiveRh*j.model.docModel.getZoomFactor();if(j&&j.numRowFixed){h=f;}else{if(j&&j.scrollboxHeightFixed){h=Math.ceil(j.scrollboxHeight/this.effectiveRh);h=Math.max(h,this.minRowsPerPage);if(f<h){h=this.minRowsPerPage;this._shouldRenderNextPage=true;}}}if(j.isOutlineMode){h=Math.min(200,f);}this.pageStatus=[];this.rowsPerPage=h;this.initPageStatus(this.pageStatus);this._defaultPageHeight=this.rowsPerPage*this.effectiveRh;},initPageStatus:function b(j){var h=this.rowsPerPage,f,l,g,k=function(o,p,m){var n=this;return function(){if(n._onDemand===undefined){n._onDemand=!o.isDataAvailable(p,m);}return n._onDemand;};};this.totalPages=(h&&Math.ceil(this.cp.rc/h))||0;j=j||this.pageStatus;for(f=0;f<this.totalPages;++f){l=f*h;g=l+h-1;if(!j[f]){j[f]={};}delete j[f]._onDemand;j[f].isOnDemand=k.call(j[f],this.cp,l,g);}},buildRendering:function G(){var f=false;if(this.renderMode==="vscroll"){this.initPageSettings();var j=this.pageStatus[0];f=j&&j.isOnDemand();this.start=0;this.end=-1;if(!f){this.end=Math.min(this.cp.rc,this.rowsPerPage)-1;}this.preRenderPages();this.preRenderPage(0,!f);}this._super();if(this.renderMode==="vscroll"){var h=this.parent;this.gridContainerNode.style[d.MINHEIGHT]=(this.cp.rc*this.effectiveRh)+"px";if(!this.connectedScrollbox){if(h&&h.connectScrollbox){h.connectScrollbox(this);this.connectedScrollbox=true;}}this.postRenderPage(0,!f);this.postRenderPages();var g=h&&!h.scrollboxHeightFixed&&!h.numRowFixed;if(g&&this.numPagesRendered>=this.totalPages&&!f){this.postRenderingCleanup();}else{if(f||g||this._shouldRenderNextPage||(h.isOutlineMode&&this.getPageHeight(this.pageNum)<this._defaultPageHeight)){this.onscroll();delete this._shouldRenderNextPage;}}}},preRenderPages:function S(){},postRenderPages:function c(){if(mstrApp&&mstrApp.isExpress){var g=this.parent.scrollboxNode,h=g.scrollTop,j=g.scrollLeft,f=(h>5)?h-5:0;this.parent.scrollTo({x:j,y:f});this.parent.scrollTo({x:j,y:h});}},configureActions:function N(){var f=this.parent;if(f&&f.configureActions){f.configureActions();}},preRenderPage:function Q(f,g){this.pageNum=f;},postRenderPage:function L(g,j,k){if(g+1>this.numPagesRendered){this.numPagesRendered=g+1;}var f=this.pageStatus,h=f[g];if(!h){h=f[g]={};}if(j){h.filled=true;h.dirty=false;}var l=this.gridContainerNode.style;if(g===this.totalPages-1&&l){l[d.MINHEIGHT]="";}},invalidAllPages:function(){for(var f=0;f<this.totalPages;++f){var g=this.pageStatus[f];if(g.filled){g.dirty=true;}delete g._onDemand;g.filled=false;g.isDownloading=false;}this.thPosMap=[];this.posMap=[];},_startPageRenderThread:function e(f){var g=this.id;this.renderingRows=true;this._renderTimer=self.setInterval(function(){try{var k=mstrmojo.all[g];if(!k){return ;}var h=k.getPagesToRender(f);if(h.length>0){k.preRenderPages();k.renderPages(h);k.postRenderPages();k._postPagesClearup=true;}else{if(k._postPagesClearup){k.postRenderPagesCleanup();k.configureActions();k._postPagesClearup=false;}J.call(k);if(k.isRenderingComplete()){k.postRenderingCleanup();}}}catch(j){J.call(mstrmojo.all[g]);throw j;}},this.renderPause);},onscroll:function a(g,f){if(!this.renderingRows){if(g===true){var h=this.parent;if(h&&h.maskNode){Y.addClass(h.maskNode,"wait");}}window.clearTimeout(this.scrollingTimeOut);this.scrollingTimeOut=window.setTimeout(function(){this._startPageRenderThread(f);}.bind(this),150);}},isRenderingComplete:function R(){if(this.end>=this.cp.rc-1){for(var f=this.pageStatus,g=this.totalPages-1;g>-1;g--){if(!f[g]||!f[g].filled){return false;}}return true;}return false;},renderPages:function D(g){for(var h=0,f=g.length;h<f;++h){this.renderPage(g[h].idx,g[h].fill,h!==f-1);}},renderPage:function Z(q,h,u){var w=this.pageStatus,l=(this.numPagesRendered>=q+1);if(l){if(!h||(w[q]&&w[q].filled)){return ;}}var v=this.rowsPerPage,m=this.domNode,o=this.parent;this.start=q*v;this.end=Math.min(this.start+v,this.cp.rc)-1;this.preRenderPage(q,h);if(h&&o.isOutlineMode){o.hasEmptyTBody=true;}var g=this.tempTable;if(!g){g=this.tempTable=m.ownerDocument.createElement("div");}var t=this.tableNode,r=this.start,j=this.end,n=h?this.buildTableRowsMarkup(r,j,'<table><tbody n="'+this.pageNum+'">',"</tbody></table>",t.style.tableLayout).join(""):'<table><tbody n="'+this.pageNum+'"><tr><td style="height:'+(o.isOutlineMode?this._defaultPageHeight:(this.effectiveRh*(this.end-this.start+1)))+'px">&nbsp;</td></tr></tbody></table>';if(h&&o.hasEmptyTBody){if(!o.outlineState.hasTBodyElementsToExpand){n='<table><tbody n="'+this.pageNum+'"><tr style="height:'+0+'px"></tr></tbody></table>';}else{o.outlineState.hasTBodyElementsToExpand=false;}}g.innerHTML=n;var k=g.firstChild.tBodies[0];if(!l){t.appendChild(k);if(o.isOutlineMode&&o.isAutoTableLayout()){if(o.clonedColHeader){o.clonedColHeader.getTableNode().appendChild(k.cloneNode(true));}if(o.clonedTitle&&o.clonedTitle.getTableNode()){o.clonedTitle.getTableNode().appendChild(k.cloneNode(true));}}}else{t.replaceChild(k,t.tBodies[q]);}if(k&&mstrApp&&mstrApp.isSingleTier){E.redirectUrlToFormWrapper(k);}if(h){this.markPages(r,j);}this.postRenderPage(q,h,k);var f=this.parent;if(f.onPageRendered){f.onPageRendered(k,q,l,h,u);}},getPagesToRender:function V(x){var v=[],AA=this.parent,AK=this._defaultPageHeight,o=null,AL=this.pageStatus,AM=this;function t(j){var m=AL[j];if(m&&(m.filled||m.dirty)){if(!o){o=AM.tableNode.tBodies;}m.height=o[j].getBoundingClientRect().height;if(I){m.height-=11;}return m.height;}else{return AK;}}var r=0,q=null,w=null,h=AA.scrollboxTop;for(var AG=0,AH=this.totalPages,f=this.pageStatus;AG<AH;AG++){r+=t(AG);if(r>=h){q=AG>0?AG-1:AG;break;}}if(q===null){q=w=Math.max(AH-1,0);}else{var z=AA.scrollboxBottom;if(isNaN(z)&&AA.numRowFixed){z=h;}for(var AF=q+1;AF<AH;AF++){if(parseInt(r,10)>z){w=AF;break;}r+=t(AF);}}if(w===null){w=AH-1;}else{if(w<AH-1&&w<=q){w=w+1;}}for(var AB=this.numPagesRendered;AB<q;++AB){v.push({idx:AB,fill:false});}var AE=0,AI=this.rowsPerPage,u=false;for(var AC=q;AC<=w;++AC){var AJ=AL[AC];if(!AJ||!AJ.filled){if(AJ&&AJ.isOnDemand()){u=true;if(!AJ.isDownloading&&!this.isDownloading){AE+=AI;AJ.isDownloading=true;this.isDownloading=true;var l=AC*AI,k=l+AI-1;this.cp.download(l,k,x);}v.push({idx:AC,fill:false});}else{v.push({idx:AC,fill:true});}}}if(AA.isOutlineMode&&v.length===0){var AD=AA.scrollboxNode.getBoundingClientRect().bottom;while(v.length===0&&w<this.totalPages-1){var g=o[w].getBoundingClientRect().bottom;if(g<AD){w++;if(!AL[w].filled){v.push({idx:w,fill:true});}}else{break;}}}if(u){this.parent.showDownloadStatus(AE);}else{if(this.parent.closeDownloadStatus){this.parent.closeDownloadStatus();}}return v;},addHilitePosition:function(g,j,f){var k=this.hiliteCellsMap[g];if(!k){this.hiliteCellsMap[g]={pos:[],nodes:[]};}var h=j-(this.pageNum||0)*this.rowsPerPage;this.hiliteCellsMap[g].pos.push({row:h,cell:f,page:this.pageNum});},setHilites:function(j,k){var l=k.getAttribute("ei"),m=this.eiMap[l],f=this.getNodesByPositions(m);if(!f.length){this._super(j,k);return ;}for(var h=0,g=f.length;h<g;h++){this._super(j,f[h]);}},addExtraInfoMap:function(g,h,f){if(!this.eiMap[g]){this.eiMap[g]=[];}this.eiMap[g].push(this.getPosObj(h,f));},addPositionMap:function(g,h,f){if(!this.posMap[g]){this.posMap[g]=this.getPosObj(h,f);}},addTitleHeaderPositionMap:function(h,f,g){var j=this.getPosObj(h,f);j.obj=g;this.thPosMap.push(j);},getPosObj:function(g,j){var h=this.pageNum||0,f=this.rowsPerPage||0;return{row:g-h*f,cell:j,page:h};},getNodeByPosition:function(f){return this.tableNode.tBodies[f.page].rows[f.row].cells[f.cell];},getRowIdxByCell:function(f){var g=this.posMap[f._ei];return g.page*this.rowsPerPage+g.row;},getNodesByPositions:function(n){var k=[];for(var h in n){var q=n[h],g=(q&&q.page)||0,f=q&&q.row,l=q&&q.cell,j=this.tableNode.tBodies[g],m=j&&j.rows[f],o=m&&m.cells[l];if(o){k.push(o);}}return k;},getPageHeight:function U(f){var g=this.tableNode.tBodies;return(g&&g[f]&&g[f].offsetHeight)||0;},getTargetCell:function(o,n){var l=0,g=0,m;for(m=this.totalPages;g<m;g++){l+=this.getPageHeight(g);if(n<=l){break;}}var k=this.tableNode.tBodies[g];if(k){for(g=0,m=k.rows.length;g<m;g++){var r=k.rows[g];for(var f=0,q=r.cells.length;f<q;f++){var p=r.cells[f];if(p.offsetTop+p.offsetHeight>=n){if(o>=p.offsetLeft&&o<=p.offsetLeft+p.offsetWidth){return p;}}else{break;}}}}},postRenderPagesCleanup:function K(){var h=this.parent;if(h&&h.gridData&&h.gridData.afc){var g=this.tableNode;if(g&&(this.lastWidth!==g.offsetWidth)){if(h.onGridWidthChanged){h.onGridWidthChanged();}mstrmojo.array.forEach(this.pageStatus,function(j){delete j.height;});this.lastWidth=g.offsetWidth;}var f=C(h,"adjustAutoWidth");if(f){f.adjustAutoWidth(h);}}if(h.gridPagesRendered){h.gridPagesRendered();}if(mstrmojo.dom.isIE&&!mstrmojo.dom.isIE8){B(this.domNode);}if(h&&h.maskNode){Y.removeClass(h.maskNode,"wait");}this.hightLightChangedCells();},hightLightChangedCells:function M(){var o=this.cp.getUpdatedRows(),k=this,n,f,m,p,h,j,l,g=[];if(o){mstrmojo.hash.forEach(o,function(r,q){l=parseInt(q,10);n=k.cp.getRowCells(l);f=F(l,k);m=f.length;p=n.length-1;if(p>=0){for(h=m-1;h>=0;h--){j=f[h];if(p<0){break;}if(n[h]._d){var u=j.style.backgroundColor,t=j.style.color;g.push({dom:j,bgcolor:u,ftcolor:t});j.style.backgroundColor=O.getHighlightColor(O.rgbStr2rgb(d.getStyleValue(j,"backgroundColor"),true));j.style.color=O.getContrastingColor(O.rgbStr2hex(d.getStyleValue(j,"backgroundColor")),"#ffffff","#000000");delete n[h]._d;}p--;}}});if(g.length>0){window.setTimeout(function(){mstrmojo.array.forEach(g,function(q){q.dom.style.backgroundColor=q.bgcolor;q.dom.style.color=q.ftcolor;});},300);}}},postRenderingCleanup:function A(){var f=this.parent;if(f&&this.connectedScrollbox){f.disconnectScrollbox(this);}this.connectedScrollbox=false;if(f&&!f.scrollboxHeightFixed){var g=C(f,"performCanGrowCanShrink");if(g){g.performCanGrowCanShrink([f],true);}}},getRowInfoByPosition:function(f){return this.cp.getRowCellInfo(f);},unrender:function X(f){J.call(this);if(this.connectedScrollbox){this.parent.disconnectScrollbox(this);this.connectedScrollbox=false;}this.numPagesRendered=0;this.lastWidth=0;this.isDownloading=false;this.unMarkAllPages();this._super(f);},dataDownloaded:function W(){this.isDownloading=false;this.initPageStatus();this.onscroll();}});})();(function(){mstrmojo.requiresCls("mstrmojo.Widget","mstrmojo._HasMarkup","mstrmojo.Image");mstrmojo.threshold.ImageBand=mstrmojo.declare(mstrmojo.Image,null,{scriptClass:"mstrmojo.threshold.ImageBand",cssClass:"mstrmojo-Image color-band"});mstrmojo._HasMarkup.addMarkupMethods(mstrmojo.threshold.ImageBand,{onwidthChange:mstrmojo.Widget.widthMarkupMethod,onleftChange:mstrmojo.Widget.leftMarkupMethod});}());(function(){mstrmojo.requiresClsP("mstrmojo","ListBase","_IsList");mstrmojo.vi.ui.CalculationWidget=mstrmojo.declare(mstrmojo.ListBase,[mstrmojo._IsList],{scriptClass:"mstrmojo.vi.ui.CalculationWidget",prevSelection:{},itemField:"v",selectionPolicy:"toggle",multiSelect:false,init:function C(D){this._super(D);mstrmojo.css.addWidgetCssClass(this,"mstrmojo-vi-calculation");},_set_selectedItems:function(G,E){var D=(E||[]).map(function(H){return H.t;}),F=this.prevSelection={};D.forEach(function(H){F[H]=true;});this.setSelectedItems(this.items.filter(function(H){return D.indexOf(H.v)>-1;}));},getCalculationTypes:function A(){var F=this.items,G=this.selectedIndices,I=this.prevSelection,E=F.filter(function(K,J){return G[J]&&!I[K.v];}),H=F.filter(function(K,J){return !G[J]&&I[K.v];}),D=function(J){return J.v;};return[E.map(D),H.map(D)];},onselectionChange:function B(D){this._super(D);this.parent.applyCalculation(this.selectedItem.v);}});}());(function(){mstrmojo.requiresCls("mstrmojo.ListBase","mstrmojo._IsList");var A;mstrmojo.ui.editors.controls.ColorList=mstrmojo.declare(mstrmojo.ListBase,[mstrmojo._IsList],{scriptClass:"mstrmojo.ui.editors.controls.ColorList",init:function D(E){this._super(E);mstrmojo.css.addWidgetCssClass(this,"mstrmojo-ui-ColorList");},getItemMarkup:function C(F,E){if(!A){A=this._super(F,E).replace(">{@en@n}<",">{@en@msg}<");}return A;},getItemProps:function B(G,E){var F=this._super(G,E);if(G.id==="transparent"){F.msg=mstrmojo.desc(5774,"No Fill");F.addCls("noFill");}else{F.msg="";G.title=G.n;F.addStyle("background-color:"+G.id);}return F;}});}());(function(){mstrmojo.requiresClsP("mstrmojo","ListBase","_IsList");mstrmojo.VisMenuList=mstrmojo.declare(mstrmojo.ListBase,[mstrmojo._IsList],{scriptClass:"mstrmojo.VisMenuList",prevSelection:{},itemField:"v",selectionPolicy:"toggle",multiSelect:false,init:function C(D){this._super(D);},getItemProps:function A(F,D){var E=this._super(F,D);E.tag="a";E.addCls("mstrmojo-ui-Menu-item");return E;},onselectionChange:function B(D){this._super(D);this.parent.data.set("valid",true);}});}());(function(){mstrmojo.requiresCls("mstrmojo.ListBase");mstrmojo.SelectBox=mstrmojo.declare(mstrmojo.ListBase,null,{scriptClass:"mstrmojo.SelectBox",size:10,cssDisplay:"inline",markupString:'<select id="{@id}" class="mstrmojo-SelectBox {@cssClass}" style="{@cssText}" size="{@size}" {@multipleHtml} mstrAttach:keyup,change tstid="{@tstid}">{@itemsHtml}</select>',markupSlots:{itemsContainerNode:function(){return this.domNode;},scrollboxNode:function(){return this.domNode;}},markupMethods:{onvisibleChange:function(){this.domNode.style.display=this.visible?this.cssDisplay:"none";},onenabledChange:function(){this.domNode.disabled=!this.enabled;}},itemCssClass:"mstrmojo-selectbox-item",itemDisplayField:"n",itemIdField:"v",showItemTooltip:false,itemRenderer:{render:function(E,D,F){var G=mstrmojo.string.htmlAngles((F.getItemName)?F.getItemName(E,D):(F.itemDisplayField&&E[F.itemDisplayField]));return'<option class="'+F.itemCssClass+'" value="'+((F.getItemValue)?F.getItemValue(E,D):(F.itemIdField&&E[F.itemIdField]))+'" '+((F.selectedIndices[D])?'selected="true" ':"")+((F.showItemTooltip)?'title="'+mstrmojo.string.encodeXMLAttribute(G)+'"':"")+">"+G+"</option>";},select:function(E,F,D,G){E.selected=true;},unselect:function(E,F,D,G){E.selected=false;}},buildRendering:function C(){this.multipleHtml=this.multiSelect?' multiple="true" ':"";this._super();delete this.multipleHtml;},_getItemNode:function(D){var E=this.scrollboxNode;return E&&E.options[D];},prechange:function A(E){if(this._syncDom){return ;}this._syncDom=true;var H=this.scrollboxNode;if(this.multiSelect){var I=H.options,F=[];for(var G=0,D=I.length;G<D;G++){if(I[G].selected){F.push(G);}}this.select(F);}else{this.singleSelect(H.selectedIndex);}delete this._syncDom;},prekeyup:function(E){var H=this.scrollboxNode,F=false;if(this.multiSelect){var I=H.options;for(var G=0,D=I.length;G<D;G++){if(I[G].selected!==!!this.selectedIndices[G]){F=true;break;}}}else{if(H.selectedIndex!==this.selectedIndex){F=true;}}if(F){var J=E;J.name="change";this.raiseEvent(E);}},onselectionChange:function B(D){if(!this._syncDom){this._super(D);}}});})();(function(){mstrmojo.requiresCls("mstrmojo.string");mstrmojo.DivItemRenderer={render:function(E,C,F){var D=mstrmojo.string.encodeHtmlString((F.getItemName?F.getItemName(E,C):(F.itemDisplayField&&E[F.itemDisplayField])));return'<div mstridx="'+C+'" class="'+F.itemCssClass+(F.selectedIndices[C]?" "+F.itemSelectedCssClass:"")+(E.cssClass?" "+E.cssClass:"")+'" style="'+F.itemCssText+'">'+D+"</div>";},select:function(C){if(C&&C.className){C.className+=" selected";}},unselect:function(C){if(C&&C.className){C.className=C.className.replace(/selected/g,"");}},rowHeight:21};mstrmojo._RendersItemDivs={tableCssClass:"mstrmojo-ListBox-table",tableCssText:"",rowCssClass:"",rowCssText:"",cellCssClass:"mstrmojo-ListBox-cell",cellCssText:"",itemCssClass:"mstrmojo-ListBox-item",itemSelectedCssClass:"selected",itemDisplayField:"n",itemRenderer:mstrmojo.DivItemRenderer,rangeSelected:false,_findMatch:function(C,D){return mstrmojo.dom.findAncestorByAttr(mstrmojo.dom.eventTarget(C,D),"mstridx",true,this.itemsNode);},premousedown:function A(C){if(mstrmojo.dom.shiftKey(C.hWin,C.e)){mstrmojo.dom.preventDefault(C.hWin,C.e);}},preclick:function B(K){var G=K.hWin,H=K.e,F=this._findMatch(G,H);if(F){var J=parseInt(F.value,10),I=mstrmojo.dom,C=I.ctrlKey(G,H),D=I.shiftKey(G,H);if(C||D){I.clearBrowserHighlights(G);}if(this.multiSelect&&(this.selectionPolicy==="toggle"||C)){var E=this.rangeSelected||this.selectedIndex===-1;this.toggleSelect(J);if(E&&J<this.items.length&&this.selectedIndices[J+1]){J++;}this.selectedIndex=J;this.rangeSelected=false;}else{if(this.multiSelect&&D){this.rangeSelected=true;this.rangeSelect(J);}else{this.singleSelect(J);this.rangeSelected=false;}}}}};mstrmojo.requiresCls("mstrmojo.ListBase","mstrmojo._RendersItemDivs");mstrmojo.ListBoxBase=mstrmojo.declare(mstrmojo.ListBase,[mstrmojo._RendersItemDivs],{scriptClass:"mstrmojo.ListBoxBase",cssClass:"mstrmojo-ListBox",itemCssClass:"mstrmojo-ListBox-item",_markupPrefix:function(){var C=this.itemRenderer;return(C&&C.markupPrefix)||('<table class="'+this.tableCssClass+'" style="'+this.tableCssText+'" cellspacing="0" cellpadding="0"><tbody>');},_markupSuffix:function(){var C=this.itemRenderer;return(C&&C.markupSuffix)||"</tbody></table>";},_itemPrefix:function(){var C=this.itemRenderer;return(C&&C.itemPrefix)||('<tr class="'+this.rowCssClass+'" style="'+this.rowCssText+'"><td class="'+this.cellCssClass+'" style="'+this.cellCssText+'">');},_itemSuffix:function(){var C=this.itemRenderer;return(C&&C.itemSuffix)||"</td></tr>";},_getItemNode:function(C){var H=this.itemsNode,G=this.renderAllItems,F=H&&H.tBodies,E=G?0:Math.floor(C/100),D=G?C:C%100,I=F&&F[E]&&F[E].rows&&F[E].rows[D];return I&&I.cells[0].firstChild;}});}());(function(){mstrmojo.requiresCls("mstrmojo.ListBase","mstrmojo._IsList");mstrmojo.ui.List=mstrmojo.declare(mstrmojo.ListBase,[mstrmojo._IsList],{scriptClass:"mstrmojo.ui.List",postselectionChange:function C(D){var G=D.added||[],F=G.length,I=D.removed||[],E=I.length;if(E){this.selectionRemoved({added:G,removed:I,isReselect:false});}if(F){var H=function(J){return[].concat(J).sort().join(",");};this.selectionAdded({added:G,removed:I,isReselect:H(G)===H(I)});}},selectionAdded:function A(D){},selectionRemoved:function B(D){}});mstrmojo.ui.List.SelectionChangeEvtType=null;}());(function(){mstrmojo.requiresCls("mstrmojo.ListBase","mstrmojo._IsList","mstrmojo.css");var B=mstrmojo.css;var A;var D;mstrmojo.ui.ButtonBar=mstrmojo.declare(mstrmojo.ListBase,[mstrmojo._IsList],{scriptClass:"mstrmojo.ui.ButtonBar",markupMethods:{onvisibleChange:mstrmojo.Widget.visibleMarkupMethod,onwidthChange:mstrmojo.Widget.widthMarkupMethod,onenabledChange:function G(){B.toggleClass(this.domNode,"disabled",!this.enabled);}},cssDisplay:"table",icnCssText:"display:table-row;",items:null,showIcon:true,hasSpacing:false,init:function F(I){this._super(I);var H=["mstrmojo-ui-ButtonBar"];if(this.hasSpacing){H.push("spacing");}if(!this.showIcon){H.push("btn-text");}B.addWidgetCssClass(this,H);},getItemMarkup:function E(H){if(!D){D=this._super(H);}if(!A){A=D.replace(">{@en@n}<",'title="{@en@n}"><div>&nbsp;</div><');}return this.showIcon&&!H.tx?A:D;},getItemProps:function C(J,H){var I=this._super(J,H);var K=J.css;if(K){I.addCls(K);}I.n=J.n||"";return I;}});mstrmojo.ui.ButtonBar.ItemType=null;}());(function(){mstrmojo.requiresCls("mstrmojo.ListBase","mstrmojo._IsList");var D=mstrmojo.dom,E=mstrmojo.hash;var A;mstrmojo.SuggestionList=mstrmojo.declare(mstrmojo.ListBase,[mstrmojo._IsList],{scriptClass:"mstrmojo.SuggestionList",itemField:"n",getItemMarkup:function(G,F){if(!A){var H=this.itemField;A=this._super(G).replace('@title}">{@en@n}<',"@en@"+H+'}">{@en@'+H+"}<");}return A;},getItemProps:function C(H,F){var G=this._super(H,F),I=this.itemField;if(!mstrmojo.string.isEmpty(H[I])){G[I]=H[I];}return G;},onclick:function B(F){if(this.disableClick){return false;}var K=this,H=this.parent,J=H.opener,G=D.isMetaKey(F.hWin,F.e);if(G&&!this.multiSelect){this.multiSelect=J.parent.defn.multi;if(this.multiSelect){D.attachOneTimeEvent(document.documentElement,"keyup",function(){var M=K.selectedIndices;if(J){J.suggestionShown=false;if(M&&!E.isEmpty(M)){var L=[];E.forEach(K.selectedIndices,function(O,N){L.push(K.items[N]);});J.handleSuggestionItemSelect(L);}H.close();}K.multiSelect=false;});}}this._super(F);if(!this.multiSelect){J.suggestionShown=false;var I=this.selectedItem;if(I){J.handleSuggestionItemSelect(I);}H.close();}},bindings:{itemField:"this.parent.opener.itemField",items:"this.parent.opener.suggestionItems",disableClick:"this.parent.opener.disableClick"}});}());(function(){mstrmojo.requiresCls("mstrmojo._HasContextMenu","mstrmojo._IsList","mstrmojo.css","mstrmojo.dom","mstrmojo.ListBase");var B=mstrmojo.css,F=mstrmojo.dom;function E(){var I,N,H=this.itemsContainerNode,J,O=this.items,R=[],Q,L,P=this.padding,M,K=0;this.items.pop();if(!this.width){return ;}I=parseInt(this.width,10);N=H.scrollWidth||F.position(H).w;if(N<=I){return ;}Q=H.lastChild;B.removeClass(Q,"hide");L=F.position(Q).w;J=H.children;M=J.length-1;while(K<M){I-=(F.position(H.children[K]).w+P);if(I<L){break;}K++;}while(K<M){H.removeChild(J[J.length-2]);R.push(O[K++]);}this.set("cm",R);Q.textContent=mstrmojo.desc(15124,"## more").replace("##",R.length);}mstrmojo.vi.ui.TruncatedList=mstrmojo.declare(mstrmojo.ListBase,[mstrmojo._IsList,mstrmojo._HasContextMenu],{scriptClass:"mstrmojo.vi.ui.TruncatedList",cssClass:"mstr-truncList",padding:0,overflowCls:"",getAdditionalProperties:mstrmojo.emptyFn,getItemProps:function D(K,H){var J=this._super(K,H),I=K.style;if(I){J.addStyle(I);}this.getAdditionalProperties(J,H);return J;},buildRendering:function G(){this.items.push({alias:"overflowItem",cls:this.overflowCls+" hide",n:mstrmojo.desc(15124,"## more").replace("##",this.items.length)});if(this._super){this._super();}},setWidth:mstrmojo.emptyFn,postBuildRendering:function C(){this.setWidth();E.call(this);if(this._super){this._super();}},onclick:function A(I){var K=this.itemsContainerNode.children,H=K.length,J=H&&K[H-1];if(J&&J===I.getTarget()){this.cmPos=F.getMousePosition(I.e,I.hWin);this.showContextMenu();}}});}());(function(){mstrmojo.requiresCls("mstrmojo.ListBase","mstrmojo._IsList","mstrmojo.ui._HasScroller");var F=mstrmojo.dom,J=mstrmojo.string;var D;function G(){var O=this._getItemNode(0);if(O){var N=(Math.min(this.maxVisibleButtons,this.items.length)*O.offsetWidth)+"px",M=this.domNode.style;if(N!==M.width){M.width=N;if(!this._sbto){this._sbto=window.setTimeout(function(){delete this._sbto;this.updateScrollbars();}.bind(this),0);}}}}mstrmojo.vi.ui.rw.PanelSelectorList=mstrmojo.declare(mstrmojo.ListBase,[mstrmojo._IsList,mstrmojo.ui._HasScroller],{scriptClass:"mstrmojo.vi.ui.rw.PanelSelectorList",init:function L(M){this._super(M);mstrmojo.css.addWidgetCssClass(this,"mstrmojo-ui-PanelSelectorList");},multiSelect:false,maxVisibleButtons:10,getItemMarkup:function K(M){if(!D){D=this._super(M).replace(">{@en@n}<",' title="{@en@n}"><div></div><');}return D;},getItemProps:function H(O,M){var N=this._super(O,M);N.n=O.n+" ("+(M+1)+"/"+this.items.length+")";return N;},setupScrollNodes:function E(){this.scrollNode=this.itemsContainerNode;},_set_items:function C(M,N){this._super(M,N);G.call(this);},selectPanel:function B(O){var N=this.items,M=mstrmojo.array.find(N,"id",O);this.singleSelect(M);return N[M];},postBuildRendering:function A(){var M=this._super();G.call(this);return M;},useRichTooltip:true,getItemTooltip:function(P,Q){var N=F.position(Q),O="<div>"+J.encodeHtmlString(P.n,true)+" "+((P.idx+1)+"/"+this.items.length)+"</div>";var M={areaId:P._renderIdx+"text",cssClass:"vi-regular vi-tooltip-V V-center",contentNodeCssClass:"regular-unitlist-tooltips",posType:mstrmojo.tooltip.POS_BOTTOMCENTER,content:O,top:N.y-4,left:N.x+10,enableHover:true};return M;},showTooltip:function I(M,P){var O=M.target||F.eventTarget(M.hWin,M.e),N=this.getItemFromTarget(O);if(N&&N.n){this.richTooltip=this.getItemTooltip(N,this.getItemNodeFromTarget(O));this._super(M,P);}}});}());(function(){mstrmojo.requiresCls("mstrmojo.Container","mstrmojo.DropDownList");function D(){var E=new mstrmojo.WaitIcon(),H=function(K){this.controller.onGroupBy(this,{groupbyKey:K.src.k,elementId:K.value},function(L){E.set("visible",L);});};for(var G=0,F=this.data.length;G<F;G++){var I=this.data[G];var J=this.addChildren(new mstrmojo.DropDownList({k:I.k,title:I.unit.target.n+":",idx:I.unit.idx,cssClass:"mstrmojo-DocGroupBy-unit",selectCssClass:"mstrmojo-DocGroupBy-unit-select"}));J.options=I.unit.elms;J.attachEventListener("selectedChange",this.id,H);}this.addChildren(E);}function B(){var H=this.data,G=this.children;if(H.length===G.length-1){for(var F=0,E=H.length;F<E;F++){var I=H[F].unit,J=G[F];J.idx=I.idx;J.options=I.elms;J.refresh();}}}mstrmojo.DocGroupBy=mstrmojo.declare(mstrmojo.Container,null,{scriptClass:"mstrmojo.DocGroupBy",markupString:'<div id="{@id}" class="mstrmojo-DocGroupBy {@cssClass}"><div style="padding-top: 5px;"></div><div class="mstrmojo-clearMe"></div></div>',markupSlots:{containerNode:function(){return this.domNode.firstChild;}},init:function C(E){this._super(E);this.ondataChange();},ondataChange:function A(){if(!this.data||!this.data.length){return ;}if(!this.hasRendered){D.apply(this);}else{B.apply(this);}},areUnitsSetToAll:function(){var E=true;mstrmojo.array.forEach(this.data,function(F){if(F.unit.elms[F.unit.idx].v!=="u;"){E=false;return false;}});return E;}});})();(function(){mstrmojo.requiresCls("mstrmojo.ui.Checkbox");var A={ROUND:"round",RECT:""};mstrmojo.ui.ToggleButton=mstrmojo.declare(mstrmojo.ui.Checkbox,null,{scriptClass:"mstrmojo.ui.ToggleButton",markupString:'<div id="{@id}" class="mstrmojo-ui-ToggleButton {@cssClass}" mstrAttach:click><div class="container"><div class="slider {@sliderStyle}"></div></div></div>',sliderStyle:A.ROUND});mstrmojo.ui.ToggleButton.EnumStyle=A;}());(function(){mstrmojo.requiresCls("mstrmojo.css","mstrmojo.Container");mstrmojo.VBox=mstrmojo.declare(mstrmojo.Container,null,{scriptClass:"mstrmojo.VBox",markupString:'<table id="{@id}" class="mstrmojo-VBox {@cssClass}" style="{@cssText}" cellspacing="0" cellpadding="0"><tr><td></td></tr></table>',markupSlots:{containerNode:function(){return this.domNode.rows[0].cells[0];}},markupMethods:{onvisibleChange:function(){this.domNode.style.display=this.visible?mstrmojo.css.DISPLAY_TABLE:"none";}}});})();(function(){mstrmojo.requiresCls("mstrmojo.func","mstrmojo.Container","mstrmojo._HasPopup");var E=function(){var G=this.opener;if(G.direction.toLowerCase()==="up"){this.domNode.style.top=-G.domNode.offsetHeight+"px";}};mstrmojo.DropDownButton=mstrmojo.declare(mstrmojo.Container,[mstrmojo._HasPopup],{scriptClass:"mstrmojo.DropDownButton",height:"",text:"",direction:"down",enabled:true,title:"",allowHTML:true,markupString:'<div id="{@id}" class="mstrmojo-DropDownButton {@cssClass} {@direction}" style="{@cssText}"><div class="mstrmojo-DropDownButton-boxNode {@cssClass}-boxNode" title="{@title}" mstrAttach:mousedown><div class="mstrmojo-DropDownButton-iconNode {@cssClass}-iconNode">{@text}</div></div><div class="mstrmojo-DropDownButton-popupNode {@cssClass}-popupNode"></div></div>',markupSlots:{boxNode:function(){return this.domNode.firstChild;},iconNode:function(){return this.domNode.firstChild.firstChild;},popupNode:function(){return this.domNode.lastChild;}},markupMethods:{onheightChange:function(){this.boxNode.style.height=this.height||"";},ontextChange:function(){this.iconNode.innerHTML=this.getTextInnerHTML();},ontitleChange:function(){this.boxNode.title=this.title;},onenabledChange:function(){mstrmojo.css[this.enabled?"removeClass":"addClass"](this.domNode,["disabled"]);},onvisibleChange:function(){this.domNode.style.display=this.visible?"block":"none";}},preBuildRendering:function C(){if(this._super){this._super();}var G=this.popupRef;if(G){if(G.nudge){G.nudge=mstrmojo.func.composite([G.nudge,E]);}else{if(this.direction.toLowerCase()!=="down"){G.nudge=E;}}}},popupRef:null,popupOpenConfig:null,destroy:function D(G){var H=this.popupRef;if(H&&H.hasRendered){H.destroy(false);}if(this._super){this._super(G);}},togglePopup:function F(){var G=this._lastOpened;if(G&&G.visible){this.closePopup();}else{this.openPopup("popupRef",this.popupOpenConfig);}},premousedown:function A(G){this.togglePopup();},getTextInnerHTML:function B(){return this.allowHTML?this.text:mstrmojo.string.encodeHtmlString(this.text);}});}());(function(){mstrmojo.requiresCls("mstrmojo.Container","mstrmojo._HasBuilder","mstrmojo._CanMeasureChildren","mstrmojo._CanRenderDocOnScroll","mstrmojo._FillsBrowser");function A(){var E=this.domNode,D=this.containerNode,F=D.style,J=D.clientWidth||parseInt(F.width,10),I=E.clientWidth||parseInt(E.style.width,10),G=E.parentNode,M=D.clientHeight||parseInt(F.height,10),H=G.clientHeight||parseInt(G.style.height,10);if(J<I){F.left=(I-J)/2+"px";}if(M<H){F.top=(H-M)/2+"px";}var K=this.model.zt,L=K===1||K===2;if(!L||this.model.zoomFactorUpdating===false){F.visibility="visible";}}mstrmojo.rw.DocLayout=mstrmojo.declare(mstrmojo.Container,[mstrmojo._HasBuilder,mstrmojo._CanMeasureChildren,mstrmojo._CanRenderDocOnScroll,mstrmojo._FillsBrowser],{scriptClass:"mstrmojo.rw.DocLayout",markupString:'<div id="{@id}"><div class="mstrmojo-DocLayout {@cssClass}" style="{@domNodeCssText}"></div></div>',markupSlots:{containerNode:function(){return this.domNode.firstChild;},popupNode:function(){return this.domNode.firstChild;}},alias:"docLayout",getHeight:mstrmojo.emptyFn,getWidth:mstrmojo.emptyFn,resizeOrReposition:mstrmojo.emptyFn,preserveChildDomOrder:false,buildRendering:function(){this._super();var D=this.model.zt;if(mstrApp.features["is-document-center-align"]||D===1||D===2){this.containerNode.style.visibility="hidden";}},postBuildRendering:function C(){var F=this._super(),G=this,E=this.model.zt,D=E===1||E===2;if(mstrApp.features["is-document-center-align"]){window.setTimeout(function(){A.call(G);},10);}else{if(D&&this.model.zoomFactorUpdating===false){G.containerNode.style.visibility="visible";}}return F;},browserResized:function B(){if(this.hasRendered&&mstrApp.features["is-document-center-align"]){A.call(this);}}});}());(function(){mstrmojo.requiresCls("mstrmojo.Container","mstrmojo._Formattable","mstrmojo._ContainsDocObjects","mstrmojo._HasBuilder");mstrmojo.rw.DocSubsection=mstrmojo.declare(mstrmojo.Container,[mstrmojo._Formattable,mstrmojo._ContainsDocObjects,mstrmojo._HasBuilder],{scriptClass:"mstrmojo.rw.DocSubsection",markupString:'<div id="{@id}" k="{@k}" class="mstrmojo-DocSubsection" style="{@domNodeCssText}"></div>',markupSlots:{containerNode:function(){return this.domNode;}},formatHandlers:{domNode:["D","B","background-color","fx"]},update:function C(E){var D=E.data.tid;if(this.thresholdId||D){delete this.fmts;}this.thresholdId=D;if(this._super){this._super(E);}},postBuildRendering:function B(){return(this.renderMode!=="scroll")?this._super():true;},childRenderOnAddCheck:function A(D){return(this.renderMode!=="scroll")?this._super(D):false;},preserveChildDomOrder:false,performCanGrowCanShrink:mstrmojo.emptyFn});}());(function(){mstrmojo.requiresCls("mstrmojo.Container","mstrmojo._Formattable","mstrmojo._ContainsDocObjects","mstrmojo._HasBuilder","mstrmojo._SupportsEllipsisText","mstrmojo._HasEllipsis","mstrmojo.css","mstrmojo.array");var W=mstrmojo.css,V=mstrmojo.array;var R=2;function D(a,Y,Z){var b=a.parent.parent;if(b&&b instanceof mstrmojo.DocPanel){b[Y+"DirtyKey"](Z);}}function O(Z,Y,a){if(Z===Y.k){mstrmojo.array.forEach(Y.children,function(b){if(b.setDirtyChildren){b.setDirtyChildren(a);}});}}function I(Y){return Y._isFP()&&!Y.parent.defn.od;}mstrmojo.DocPanel=mstrmojo.declare(mstrmojo.Container,[mstrmojo._Formattable,mstrmojo._ContainsDocObjects,mstrmojo._HasBuilder,mstrmojo._SupportsEllipsisText,mstrmojo._HasEllipsis,mstrmojo.vi.ui._IsDropTarget],{scriptClass:"mstrmojo.DocPanel",visible:false,selected:false,k:"",cssDisplay:"block",subPanelCssText:"height:100%;width:100%;position:absolute;",topStart:R,contentWidth:0,markupString:'<div id="{@id}" k="{@k}" class="mstrmojo-DocPanel {@cssClass}" style="{@cssText}{@domNodeCssText}"><div class="mstrmojo-DocSubPanel-content" style="{@containerNodeCssText}{@subPanelCssText}"></div></div>',markupMethods:{onvisibleChange:function(){var Z=this.domNode.style,Y=this.visible;if(I(this)){Z.visibility=(Y?"":"hidden");Z.zIndex=(Y?10:1);}else{Z.display=(Y?this.cssDisplay:"none");}}},markupSlots:{containerNode:function(){return this.domNode.firstChild;}},formatHandlers:{containerNode:["background-color","fx","overflow"]},title:"",init:function Q(Y){this._super(Y);if(!this.title){this.title=this.node.defn.ttl||"";}if(this._isSearchBoxPanel()){this.isSbp=true;this.set("canApplySbp",false);}},childRenderCheck:function L(Y){return(this._super(Y)&&(this.selected||I(this)));},postBuildRendering:function U(){if(!this.defn.l&&!this._forceRender){W.addClass(this.domNode,"placeholder");}var Z=this._super();if(this.isSbp){var Y=this.addChildren({scriptClass:"mstrmojo.Button",cssClass:"sbp-apply",title:mstrmojo.desc(134,"Apply"),cssText:"top:"+((parseInt(this.parent.fmts.height,10)||0)-28)/2+"px",bindings:{enabled:"this.parent.canApplySbp&&this.parent.parent.applyEnabled"},onclick:function(){this.parent.parent.applyBufferedSlices();}});Y.render();}if(this._isFSP()){this.set("shouldEllipsize",true);}if(mstrApp.isOIVM&&mstrApp.isOIVM()&&mstrmojo.dom.isChrome){var b=this.containerNode.style.overflow;this.containerNode.style.overflow="hidden";var a=this;window.setTimeout(function(){if(a.containerNode&&a.containerNode.style&&a.containerNode.style.overflow){a.containerNode.style.overflow=b;}},2000);}return Z;},onselectedChange:function M(Y){if(Y.value){this.renderChildren();}this.model&&this.model.raiseEvent({name:"panelSelected",panelId:this.id,panelVisible:!!Y.value});},updateForPU:function S(Y){this.node=Y;this.update(Y);},refreshForPU:function A(){this._isPartial=true;this.refresh();this._isPartial=false;},_isPartial:false,refresh:function E(){if(!this.hasRendered){return ;}this._inRendering=true;var a=[].concat(this.getPanelChildren()||[]),Z=[].concat(this.getChildren(this._isPartial)),Y;V.removeItems(a,"k",Z);V.removeItems(Z,"k",this.getPanelChildren());if(a.length!==0){V.forEach(a,function(b){this.removeChildren(b);b.destroy();},this);}if(Z.length!==0){V.forEach(Z,function(d){var c=d.id&&mstrmojo.all[d.id];var b=c&&c.defn;if(b){b._isDeleted=true;}if(c&&c.destroy){c.destroy();}},this);this.addChildren(this.builder.build(Z,this.model,this.buildConfig));this.builtChildren=true;}if(!this.selected){if(!this.children){this.builtChildren=false;}this._forceRender=true;this._super();delete this._forceRender;}else{a=[].concat(this.getPanelChildren()||[]);for(Y=a.length-1;Y>=0;Y--){a[Y].refresh();}}if(this._isFP()&&this.selected){this.refreshFP();}if(this._isFSP()){this.set("richTooltip",{content:this.containerNode.innerHTML,contentNodeCssClass:"sp-tooltip",left:-20,top:20,refNode:this.domNode});this.ellipsizeElements("div",this.containerNode,true);}this._inRendering=false;},setDirty:function N(Y){this[(Y?"add":"remove")+"DirtyKey"](this.k);},addDirtyKey:function H(Y){var a=this.defn,Z=a.dirtyKeys||{};Z[Y]=true;a.dirtyKeys=Z;if(Y===this.k){mstrmojo.array.forEach(this.children,function(b){if(b.setDirtyChildren){b.setDirtyChildren(true);}});}O(Y,this,true);D(this,"add",Y);},removeDirtyKey:function K(Z){D(this,"remove",Z);O(Z,this,false);if(Z===this.k){mstrmojo.array.forEach(this.children,function(b){if(b.setDirtyChildren){b.setDirtyChildren(false);}});}var a=this.defn,Y=a.dirtyKeys;if(!Y){return ;}delete Y[Z];if(!mstrmojo.hash.isEmpty(Y)){return ;}delete a.dirtyKeys;},getPanelChildren:function G(){return V.filter(this.children||[],function(Y){return Y.scriptClass!=="mstrmojo.Button";});},preBuildRendering:function(){if(this._isFSP()){this.useRichTooltip=true;}if(this._super){this._super();}},renderChildren:function J(){this._inRendering=true;var e=this.children;if(e&&(this._isFP()||this._isFSP())){V.forEach(e,function(h){h.getFormats();});}if(this.isSbp){W.addClass(this.domNode,"mstrmojo-sbp");}if(this._isFP()&&!mstrApp.isVI){W.addClass(this.parent.domNode,"fpgb");if(e){var f=this.domNode.clientWidth-2*R,d,Y;this.topStart=R+1;for(d=0,Y=(e&&e.length)||0;d<Y;d++){var a=this.domNode.clientWidth-2*R;this.contentWidth=(a>0)?a:0;if(a!==f){this.topStart=R+1;var b;for(b=0;b<d;b++){var Z=e[b];Z.refresh();if(Z.getContainerHeight){this.topStart+=Z.getContainerHeight()+R+1;}}}var g=e[d];if(this.childRenderCheck(g)){g.render(null);if(g.getContainerHeight){this.topStart+=g.getContainerHeight()+R+1;}}}}}else{this._super();}if(this._isFSP()){this.set("richTooltip",{content:this.containerNode.innerHTML,contentNodeCssClass:"sp-tooltip",left:-20,top:20,refNode:this.domNode});this.ellipsizeElements("div",this.containerNode,true);}this._inRendering=false;},refreshFP:function F(){if(!this.hasRendered){return ;}var b=this.children,Y=(b&&b.length)||0,a;this.topStart=R+1;var Z=this.domNode.clientWidth-2*R;this.contentWidth=(Z>0)?Z:0;for(a=0;a<Y;a++){var d=b[a];if(!d.hasRendered){continue;}if(d.relocate){d.relocate(this.topStart,this.contentWidth);}if(d.updateContentHeight){d.updateContentHeight();}if(d.getContainerHeight){this.topStart+=d.getContainerHeight()+R+1;}}},getChildren:function C(b){var a=this.model.getChildren(this.node,b);if(this._isFP()||this._isFSP()){var Y=(a&&a.length)||0,Z;for(Z=0;Z<Y;Z++){var d=a[Z];if(this._isFP()&&!d.defn.iifp){d.defn.iifp=true;}if(this._isFSP()&&!d.defn.iifs){d.defn.iifs=true;}}}a=V.filter(a||[],function(c){if(typeof c.defn.ifw==="boolean"){return !c.defn.ifw;}return true;});return a;},onchildRenderingChange:function B(Y){this._super(Y);if(this._isFSP()&&!this._inRendering){this.ellipsizeElements("div",this.containerNode,true);}if(this.parent.selectedKey!==this.k&&Y.gridInfo&&Y.tca===2){this.defn.l=false;}},_isFP:function X(){return !!this.parent.defn.ifp;},_isFSP:function P(){return !!this.parent.defn.ifsp;},_isSearchBoxPanel:function(){return false;},canApplySearchBoxPanel:function(){var Z=this.model.getChildren(this.node,false),Y;for(Y=0;Y<Z.length;Y++){var b=Z[Y],a=mstrmojo.all[b.id];if(a&&a.canApply&&!a.canApply()){return false;}}return true;},doEllipsize:function(){if(this.shouldEllipsize){this.ellipsizeElements("div",this.containerNode,true);}if(this._super){this._super();}}});}());(function(){mstrmojo.requiresCls("mstrmojo.func","mstrmojo.Container","mstrmojo._HasPopup");var B=mstrmojo.func,D=mstrmojo.dom,C=mstrmojo.ui._HasUITheme.EnumThemeNames,G="mstrmojo-popup-widget-hosted";mstrmojo.ui.PopupButton=mstrmojo.declare(mstrmojo.Container,[mstrmojo._HasPopup],{scriptClass:"mstrmojo.ui.PopupButton",onPopupWidgetClosed:mstrmojo.emptyFn,onPopupWidgetOpened:mstrmojo.emptyFn,anchorSlot:"domNode",isHostedWithin:true,hostedCSSClass:"",destroy:function J(N){if(this._listenerProc){D.detachEvent(window,"resize",this._listenerProc);}this._super(N);},getPopupWidget:mstrmojo.emptyFn,postCreateChildren:function E(){var N=this.getPopupWidget();if(!N||N._pbCfg){return ;}var O=function O(Q,P){return function(){Q.apply(P,arguments);};};N.onOpen=B.composite([O(this.onPopupWidgetOpened,this),N.onOpen||mstrmojo.emptyFn]);N.onClose=B.composite([O(this.onPopupWidgetClosed,this),N.onClose||mstrmojo.emptyFn]);N._pbCfg=true;},onclick:function L(N){if(this.isClickingAnchorSlot(N)){var O=this.getPopupWidget();if(!O.visible){this.openPopup(O);}else{this.closePopup();}}},isClickingAnchorSlot:function M(N){var O=N.getTarget();return O===this[this.anchorSlot]||O.parentNode===this[this.anchorSlot];},onPopupAutoClosed:function I(O,N){if(D.contains(this[this.anchorSlot],D.eventTarget(N,O),true)){return false;}},getPopupHostNode:function K(){return this.containerNode;},getPopupConfig:function H(){var O=[G],N=this.hostedCSSClass;if(N){O.push(N);}var P=new mstrmojo.ui.PopupConfig({hostId:this.id,hostElement:this.getPopupHostNode(),anchorElement:this[this.anchorSlot],isHostedWithin:this.isHostedWithin,hostProxyCssClass:O.join(" ")});return this.disposables?this.addDisposable(P):P;},unrender:function F(N){if(this._listenerProc){D.detachEvent(window,"resize",this._listenerProc);delete this._listenerProc;}this._super(N);},postBuildRendering:function A(){var R=this.getPopupWidget();if(R){var U=this.getPopupConfig();if(!U.isHostedWithin){var P=this.parent||this.opener,O=U.hostProxyCssClass.split(" ");O.push(this.domNode.className);while(P){var S=P.themeClassName;if(S){O.push(S);break;}P=P.parent||P.opener;}if(U.useDarkTheme){O.splice(O.indexOf(C.LIGHT_THEME),1);O.push(C.DARK_THEME);}U.hostProxyCssClass=O.join(" ");}mstrmojo.Obj.free(R.popupConfig);R.popupConfig=R.addDisposable(U);}if(!(this.editableSlot&&D.isMobile)){var N=R.id,Q=this._listenerProc=function(){var V=mstrmojo.all[N];if(V&&V.visible&&V.adjustCornersForPopupOverflow){V.adjustCornersForPopupOverflow();}};if(this.isHostedWithin===false){D.attachEvent(window,"resize",Q);}}return this._super();}});}());(function(){mstrmojo.requiresCls("mstrmojo.Container","mstrmojo.dom","mstrmojo._IsPopup","mstrmojo._CanAutoClose");var C=mstrmojo.dom;mstrmojo.ui.PopupWidget=mstrmojo.declare(mstrmojo.Container,[mstrmojo._IsPopup,mstrmojo._CanAutoClose],{scriptClass:"mstrmojo.ui.PopupWidget",markupString:'<div id="{@id}" class="mstrmojo-ui-PopupWidget {@cssClass}" style="{@cssText}" mstrAttach:mouseover,mouseout,click><div class="pw-content"></div></div>',markupSlots:{containerNode:function A(){return this.domNode.firstChild;}},markupMethods:{onvisibleChange:mstrmojo.Widget.visibleMarkupMethod},autoCloses:true,locksHover:true,closeOnClick:true,visible:true,onclick:function B(D){C.stopPropogation(null,D.e);}});}());(function(){mstrmojo.requiresCls("mstrmojo.Container");mstrmojo.requiresDescs(11668,15187,15188,15189,15190);function B(L,K,I){var J=K,H;for(;J>0;J--){H=Array(J+1).join("#");L=L.replace(H,I[J-1]);}return L;}var C='<div class="ghost-vis-txt-metric">',A='<div class="ghost-vis-txt-attr">',E='<div class="ghost-vis-txt-attr-time">',G="</div>";var D={grid:B(mstrmojo.desc(15187,"Add # or more ##attributes### and/or #### or more #####metrics######"),6,[1,A,G,1,C,G]),heatmap:B(mstrmojo.desc(15187,"Add # or more ##attributes### and/or #### or more #####metrics######"),6,[1,A,G,1,C,G]),barchart:B(mstrmojo.desc(15188,"Add # or more ##attributes### and #### or more #####metrics######"),6,[1,A,G,1,C,G]),linechart:B(mstrmojo.desc(15188,"Add # or more ##attributes### and #### or more #####metrics######"),6,[1,A,G,1,C,G]),areachart:B(mstrmojo.desc(15188,"Add # or more ##attributes### and #### or more #####metrics######"),6,[1,A,G,1,C,G]),bubblechart:B(mstrmojo.desc(15190,"Add # or more ##metrics### and #### or more #####attributes######"),6,[2,C,G,1,A,G]),piechart:B(mstrmojo.desc(15188,"Add # or more ##attributes### and #### or more #####metrics######"),6,[1,A,G,1,C,G]),combochart:B(mstrmojo.desc(15188,"Add # or more ##attributes### and #### or more #####metrics######"),6,[1,A,G,2,C,G]),network:B(mstrmojo.desc(15188,"Add # or more ##attributes### and #### or more #####metrics######"),6,[2,A,G,1,C,G]),histogram:B(mstrmojo.desc(15667,"Add # or more ##attributes### and ####  #####metric######"),6,[1,A,G,1,C,G]),boxplot:B(mstrmojo.desc(15188,"Add # or more ##attributes### and #### or more #####metrics######"),6,[1,A,G,1,C,G]),waterfall:B(mstrmojo.desc(15188,"Add # or more ##attributes### and #### or more #####metrics######"),6,[1,A,G,1,C,G]),kpicard:B(mstrmojo.desc(15878,"Add # or more ##attributes### and #### #####metric######"),6,[1,A,G,1,C,G])};function F(H){return D[H]?D[H]:mstrmojo.desc(11668,"Drag objects here.");}mstrmojo.vi.ui.rw.GhostImageContainer=mstrmojo.declare(mstrmojo.Container,[],{scriptClass:"mstrmojo.vi.ui.rw.GhostImageContainer",markupString:'<div id="{@id}" class="mstrmojo-vi-ui-rw-GhostImageContainer {@cssClass}"><div class="mstmojo-ghostImgTableCell"><div class="mstrmojo-ghostImgDiv"><div class="ghost-vis-img"></div><div class="ghost-vis-name">{@visName}</div><div class="ghost-vis-desc">{@visDesc}</div></div></div></div>',markupSlots:{containerNode:function(){return this.domNode;}},visName:"",visDesc:""});mstrmojo.vi.ui.rw.GhostImageContainer.getVisDesc=F;}());(function(){mstrmojo.requiresCls("mstrmojo.Container");var A=mstrmojo.Widget;mstrmojo.Box=mstrmojo.declare(mstrmojo.Container,null,{scriptClass:"mstrmojo.Box",markupString:'<div id="{@id}" class="mstrmojo-Box {@cssClass}" style="{@cssText}"></div>',markupSlots:{containerNode:function(){return this.domNode;}},markupMethods:{onvisibleChange:A.visibleMarkupMethod,onheightChange:A.heightMarkupMethod,onwidthChange:A.widthMarkupMethod}});}());(function(){mstrmojo.requiresCls("mstrmojo.Container","mstrmojo.css");var F="",B="row-",E=mstrmojo.css.DISPLAY_TABLE;mstrmojo.Table=mstrmojo.declare(mstrmojo.Container,null,{scriptClass:"mstrmojo.Table",cellCssClass:"",rows:-1,cols:-1,_trows:-1,cellPadding:0,cellSpacing:0,layout:null,markupString:'<table id="{@id}" class="mstrmojo-Table {@cssClass}" style="{@cssText}" cellpadding="{@cellPadding}" cellspacing="{@cellSpacing}">{@tableHtml}</table>',markupSlots:{containerNode:function(){return this.domNode;}},markupMethods:{onvisibleChange:function(){this.domNode.style.display=this.visible?E:"none";}},preBuildRendering:function G(){var I=[],P=this.cellCssClass;if(this.layout){var Q=this._trows=this.layout.length;for(var K=0;K<Q;K++){var H=this.layout[K],R=H.cells,O=R.length,L=[];for(var J=0;J<O;J++){var N=R[J],M="";M+=((N.cssClass||P)?' class="'+(N.cssClass||P)+'"':"");M+=(N.cssText?' style="'+N.cssText+'"':"");M+=(N.rowSpan?' rowspan="'+N.rowSpan+'"':"");M+=(N.colSpan?' colspan="'+N.colSpan+'"':"");L[J]="<td"+M+"></td>";}var S="";S+=(H.cssClass?' class="'+H.cssClass+'"':"");S+=(H.cssText?' style="'+H.cssText+'"':"");I[K]="<tr"+S+">"+L.join("")+"</tr>";}}else{this._trows=this.rows;var M=(P?' class="'+P+'"':""),L=[];for(var K=0;K<this.rows;K++){for(var J=0;J<this.cols;J++){L[J]="<td"+M+"></td>";}I[K]="<tr>"+L.join("")+"</tr>";}}this.tableHtml=I.join("");if(this._super){this._super();}},postBuildRendering:function C(){if(this._trows){var M={},I=this.containerNode.rows,N=I.length;for(var L=0;L<N;L++){var K=I[L].cells,H=K.length;M[B+L]=I[L];for(var J=0;J<H;J++){M[F+L+","+J]=K[J];}}this.addSlots(M);}this._super();},childRenderCheck:function D(I){if(I&&!I.hasRendered){var H=I.slot||this.defaultChildSlot;return !!this[H]||H.match(/^([\d]+),([\d]+)$/);}return false;},on_child_change_rendering:function A(L){var H=(L&&L.src)||L,O=H&&H.domNode;if(O){var V=H.slot;if(!this[V]){var M=V&&V.match(/^([\d]+),([\d]+)$/);if(M){var R=parseInt(M[1],10),W=parseInt(M[2],10),Q=this.containerNode,U=this[(B+R)],N=[];if(!U){var J=Q.rows,S=J&&J.length||0;for(var K=S;K<=R;K++){N[B+K]=Q.insertRow();}U=N[B+R];}var P=U.cells&&U.cells.length||0;for(var K=P;K<=W;K++){var I=U.insertCell(K);N[F+R+","+K]=I;if(this.cellCssClass){I.className=this.cellCssClass;}}this.addSlots(N);}}}this._super(L);}});})();(function(){mstrmojo.requiresCls("mstrmojo.Container","mstrmojo.dom","mstrmojo.css");var I=mstrmojo.css,G={9:"Tab",13:"Enter",27:"Esc",38:"ArrowUp",40:"ArrowDown"},E="sbClear",N="sbSearch";mstrmojo.SearchWidget=mstrmojo.declare(mstrmojo.Container,null,{scriptClass:"mstrmojo.SearchWidget",quickSearch:false,quickSearchForClear:false,showClearNode:true,placeholderText:"",markupString:'<table id={@id} cellspacing="0" cellpadding="0" class="mstrmojo-SearchWidget mstrmojo-SearchBox-Wrapper {@cssClass}" style="{@cssText};"><tr><td><div class="mstrmojo-SearchBox" mstrAttach:click ><input class="mstrmojo-SearchBox-input" type="text" style="width:{@width};" placeholder="{@placeholderText}" mstrAttach:keyup,focus,blur/></div></td><td><div class="mstrmojo-SearchBox-clear" id="{@id}'+E+'" mstrAttach:click></div></td><td><div class="mstrmojo-SearchBox-bg"><div class="mstrmojo-SearchBox-search" id="{@id}'+N+'" mstrAttach:click ></div></div></td></tr></table>',markupSlots:{inputNode:function(){return this.domNode.rows[0].cells[0].firstChild.firstChild;},clearNode:function(){return this.domNode.rows[0].cells[1].firstChild;},searchNode:function(){return this.domNode.rows[0].cells[2].firstChild.firstChild;}},markupMethods:{onquickSearchChange:function(){I.toggleClass(this.domNode,"quick-search",this.quickSearch);},onwidthChange:function(){if(this.inputNode&&this.inputNode.style&&this.inputNode.style.width){this.inputNode.style.width=this.width;}},ondisabledChange:function O(){var Q=this.disabled;I.toggleClass(this.domNode,"disabled",Q);if(this.inputNode){this.inputNode.disabled=Q;}}},clearNode:null,searchNode:null,isFocus:false,disabled:false,onsearch:mstrmojo.emptyFn,onclear:mstrmojo.emptyFn,prekeyup:function M(R){var Q=R.hWin,S=R.e||Q.event;this.updateSearch();var U=G[S.keyCode];if(this["on"+U]){this["on"+U](R);}},setClearIcon:function C(){var R=this.parent;if(!R){return ;}var Q=R.search&&R.search.searchNode,S=this.getSearchPattern(),U=(S.length===0);if(Q){I.toggleClass(this.searchNode,"clear",!U&&this.quickSearch);}},onEnter:function D(Q){this.onsearch(this.getSearchPattern());},onEsc:function A(Q){this.clearSearch();},getSearchPattern:function K(){return mstrmojo.string.trim(this.inputNode.value);},setSearchPattern:function K(Q){if(this.inputNode){this.inputNode.value=Q||"";this.updateSearch();}},preclick:function H(Q){var S=Q.getTarget(),R=S&&S.id;switch(R.replace(this.id,"")){case N:if(this.quickSearch){this.clearSearch();}else{this.onsearch(this.getSearchPattern());}break;case E:this.clearSearch();break;}},updateSearch:function B(){var R=this.getSearchPattern(),Q=(R.length===0),S=this.quickSearch;I.toggleClass(this.clearNode,"show",this.showClearNode&&!Q&&!S);I.toggleClass(this.searchNode,"clear",!Q&&S);I.toggleClass(this.domNode,"hasPattern",!Q);if(S||this.quickSearchForClear&&Q){this[Q?"clearSearch":"onsearch"](R);}},clearSearch:function L(){var Q=this.getSearchPattern();this.reset();this.onclear(Q);},onfocus:function P(){this.isFocus=true;I.addClass(this.domNode,"focus");},onblur:function J(){this.isFocus=false;I.removeClass(this.domNode,"focus");},reset:function F(){this.inputNode.value="";I.removeClass(this.clearNode,"show");I.removeClass(this.domNode,"hasPattern");I.removeClass(this.searchNode,"clear");}});}());(function(){mstrmojo.requiresCls("mstrmojo.Container","mstrmojo._HasScrollbox","mstrmojo._HasLayout","mstrmojo._ShowsStatus");function E(J){var I=this.domNode,H=parseInt(this[J.toLowerCase()],10);return(isNaN(H))?I["offset"+J]:H;}mstrmojo.DocLayoutViewer=mstrmojo.declare(mstrmojo.Container,[mstrmojo._Formattable,mstrmojo._HasScrollbox,mstrmojo._HasLayout,mstrmojo._ShowsStatus],{scriptClass:"mstrmojo.DocLayoutViewer",markupString:'<div id="{@id}" class="mstrmojo-DocLayoutViewer {@cssClass}" style="{@domNodeCssText}"><div></div><div><div class="mstrmojo-progress" style="display:none"><div class="mstrmojo-progress-barbg"><div class="mstrmojo-progress-bar"></div></div><div class="mstrmojo-progress-text"></div></div><div id="{@id}_fh"></div><div id="{@id}_scrollboxNode" class="mstrmojo-DocLayoutViewer-layout" style="{@_scrollCssText}"></div><div id="{@id}_ff"></div></div><div></div></div>',markupMethods:{onvisibleChange:function(){this.domNode.style.display=this.visible?"block":"none";},onborderChange:function(){if(this.border){this.domNode.style.border=this.border;}}},markupSlots:{groupBy:function(){return this.domNode.firstChild;},layout:function(){return this.domNode.childNodes[1].childNodes[2];},scrollboxNode:function(){return this.domNode.childNodes[1].childNodes[2];},containerNode:function(){return this.domNode.childNodes[1].childNodes[2];},incFetchNode:function(){return this.domNode.lastChild;},fixedHeaderNode:function(){return this.domNode.childNodes[1].childNodes[1];},fixedFooterNode:function(){return this.domNode.childNodes[1].childNodes[3];},_STATUS:function(){return this.domNode.childNodes[1].firstChild;},_STATUS_TXT:function(){return this.domNode.childNodes[1].firstChild.lastChild;},_STATUS_BAR:function(){return this.domNode.childNodes[1].firstChild.firstChild.firstChild;}},layoutConfig:{h:{groupBy:"auto",fixedHeaderNode:"auto",layout:"100%",fixedFooterNode:"auto",incFetchNode:"auto"},w:{layout:"100%"}},k:null,scrollboxHeightFixed:true,scrollboxWidthFixed:true,getHeight:function G(){return E.call(this,"Height");},getWidth:function B(){return E.call(this,"Width");},afterLayout:function A(){this._super();this.notifyScrollListeners();},preBuildRendering:function D(){if(this.parent){var J=this.parent[this.slot].style,I=this.height,H=this.width;this.height=(I!=="auto")?I:J.height;this.width=(H!=="auto")?H:J.width;}this.bs=this.model.bs;return this._super();},setSlotDimensions:function F(J,I,H){if(J==="layout"){this.scrollboxHeight=parseInt(I,10);this.scrollboxWidth=parseInt(H,10);}this._super(J,I,H);},onaddChild:function C(H){if(!isNaN(H.index)){var I=this.children[H.index];if(I&&I.slot==="groupBy"){this.docGroupBy=I;}}}});}());(function(){mstrmojo.requiresCls("mstrmojo.Container","mstrmojo.array","mstrmojo.css","mstrmojo._HasChildren");var E=mstrmojo.array,F=mstrmojo.css,K=1,J=2,I=3,D=4,G=5;function C(){var R=this,M=R.metric,X=R.thresholds||[],P=X.length,U,V,Q,N,S,O,W=true;R.destroyChildren();if(!!X&&P>0){var Y=this.isImageBasedType();if(Y){var L=X.length;E.forEach(X,function(Z){var b=Z.rtxt,a=1/L*100;bar={scriptClass:"mstrmojo.Widget",markupString:'<div class="item" style="{@cssText}{@bg}"></div>',cssText:"width: "+a+"%; ",bg:"background:url("+b+");background-size: contain; background-repeat: no-repeat; background-position: center;"};R.addChildren(bar);});}else{U=X[0];V=X[X.length-1];Q=U.ttp===K||U.ttp===J||U.ttp===I;if(!Q){if(U.ttp===D||U.ttp===G){N=0;S=M.cnt;O=S;if(M.min===M.max){W=false;}}else{N=M.min;S=M.max;if(isFinite(U.ceil)&&U.ceil<N){N=U.ceil;}if(isFinite(V.flr)&&V.flr>S){S=V.flr;}O=S-N;if(O<=0){W=false;}}}E.forEach(X,function(g){var d=Math.min(g.ceil,S),j=Math.max(g.flr,N),Z=d-j,e=g.fmt.bc,c=isFinite(Z),f=isFinite(g.ceil),a=isFinite(g.flr),h={scriptClass:"mstrmojo.Widget",markupString:'<div class="item" style="{@cssText}"></div>',cssText:"width: "+Z+"%; "};if(!Q&&W){if(!c){if(f){Z=g.ceil-N;}else{if(a){Z=S-g.flr;}else{Z=S-N;}}}h.cssText="width: "+(Z/O*100)+"%; ";}else{if(!c||!W){h.cssText="width: "+(1/P*100)+"%; ";}}if(e.c1){var k=F.buildGradient(e.or,e.c1,e.c2),b=F.convertCssToCamelCase(k.n);h.cssText+=b+": "+k.v;}else{h.cssText+="background-color: "+e;}R.addChildren(h);});}}}mstrmojo.vi.ui.ColorRangeSelector=mstrmojo.declare(mstrmojo.Container,[mstrmojo._HasChildren],{scriptClass:"mstrmojo.vi.ui.ColorRangeSelector",markupString:'<div id="{@id}" class="mstrmojo-ColorRangeSelector" mstrAttach:click><div class="children"></div><div class="icon"></div></div>',markupSlots:{containerNode:function B(){return this.domNode.firstChild;}},thresholds:[],metric:null,preBuildRendering:function H(){this._super();C.call(this);},isImageBasedType:function A(){var L=this.thresholds;return L&&!L.some(function(M){return M.rtp!==4;});},});}());(function(){mstrmojo.requiresCls("mstrmojo.Container","mstrmojo.Widget","mstrmojo.css","mstrmojo.dom");var Z=mstrmojo.css,F=mstrmojo.dom;var a={9:"Tab",13:"Enter",27:"Esc",38:"ArrowUp",40:"ArrowDown"};function A(){var d=this.value,c=this.inputNode,e=c.value,b=(d!==null&&d!==undefined)?String(d):"";if(b!==e&&(!this.keepEmpty||e!==this.emptyText)){c.value=b;}if(c.mstrmojoEmpty){Z.removeClass(c,[this.emptyClass]);c.mstrmojoEmpty=null;}}function Y(){var b=this.inputNode;b.value=this.emptyText||"";Z.addClass(b,[this.emptyClass]);b.mstrmojoEmpty=true;}function N(){var b=this.inputNode;if(b){this.readingDom=true;this.set("value",b.value);this.readingDom=false;}}function V(b){var c=this;if(b===-1){N.call(this);}else{if(this._lastTimeoutId){window.clearTimeout(this._lastTimeoutId);}this._lastTimeoutId=window.setTimeout(function(){delete c._lastTimeoutId;N.call(c);},b||100);}}mstrmojo.TextBox=mstrmojo.declare(mstrmojo.Container,null,{scriptClass:"mstrmojo.TextBox",value:"",type:"text",hint:"",readOnly:false,size:"",maxLength:"",cssDisplay:"inline",tabIndex:"",emptyText:"",keepEmpty:false,emptyClass:"mstrmojo-empty",valueChangeDelay:-1,textValid:true,autoComplete:true,autoCorrect:true,autoCapitalize:true,spellCheck:true,markupString:'<input id="{@id}" class="mstrmojo-TextBox {@cssClass}"  style="{@cssText}" title="{@tooltip}" type="{@type}" value="" size="{@size}" maxlength="{@maxLength}" index="{@tabIndex}"min="{@min}" max="{@max}" placeholder="{@hint}" mstrAttach:focus,keyup,blur,paste,cut,input,click,keydown,mousedown  tstid="{@tstid}"/>',markupSlots:{inputNode:function D(){return this.domNode;}},markupMethods:{onvisibleChange:mstrmojo.Widget.visibleMarkupMethod,onwidthChange:mstrmojo.Widget.widthMarkupMethod,onheightChange:mstrmojo.Widget.heightMarkupMethod,oncssClassChange:function S(){this.inputNode.className="mstrmojo-TextBox "+(this.cssClass||"");},onhintChange:function O(){this.inputNode.setAttribute("placeholder",this.hint);},onenabledChange:function E(){var b=this.inputNode;b.disabled=!this.enabled;Z.toggleClass(b,"disabled",!this.enabled);},onvalueChange:function P(){var b=this.value,c=(b===undefined)||(b===null)||(b==="");if(c){if(!this.hasFocus){Y.call(this);}else{this.inputNode.value="";}}else{A.call(this);}if(F.isIE9){this.inputNode.type=c?"text":this.type;}},ontooltipChange:function R(){this.domNode.title=this.tooltip;},onreadOnlyChange:function H(){this.inputNode.readOnly=this.readOnly;},ontextValidChange:function B(){Z.toggleClass(this.inputNode,["err"],!this.textValid);}},postBuildRendering:function W(){this._super();var b=this.inputNode;b.setAttribute("autocomplete",this.autoComplete?"on":"off");b.setAttribute("autocorrect",this.autoCorrect?"on":"off");b.setAttribute("autocapitalize",this.autoCapitalize?"on":"off");b.setAttribute("spellcheck",this.spellCheck?"true":"false");},focus:function Q(){if(this.inputNode&&this.inputNode.offsetParent){try{this.inputNode.focus();}catch(b){}}},prefocus:function M(){this.hasFocus=true;A.call(this);},blur:function U(){this.inputNode.blur();},preblur:function X(){window.setTimeout(function(){},200);this.hasFocus=false;N.call(this);var b=this.value;if(((b===null||b==="")&&this.emptyText)||(this.keepEmpty&&b===this.emptyText)){Y.call(this);}},prekeyup:function I(c){var b=c.hWin,d=c.e||b.event;V.call(this,this.valueChangeDelay);var f=a[d.keyCode];if(this["on"+f]){this["on"+f](c);}},preinput:function J(){V.call(this,this.valueChangeDelay);},prepaste:function K(){V.call(this);},precut:function G(){V.call(this);},setInvalidState:function C(b){this.set("textValid",false);if(b){this.domNode.setAttribute("title",b);}},cleanUp:function L(){this.inputNode.value="";this.set("textValid",true);this.domNode.setAttribute("title",this.tooltip);}});}());(function(){mstrmojo.requiresCls("mstrmojo.Container","mstrmojo._HasLayout");var D=' style="display:inline-block;vertical-align:middle;"';mstrmojo.ui.editors.controls.ThreeColumnContainer=mstrmojo.declare(mstrmojo.Container,[mstrmojo._HasLayout],{scriptClass:"mstrmojo.ui.editors.controls.ThreeColumnContainer",markupString:'<div id="{@id}" class="mstrmojo-vi-ThreeColumnProp {@cssClass}" style="{@cssText}"><div class="vi-col1"'+D+'></div><div class="divider1"'+D+'></div><div class="vi-col2"'+D+'></div><div class="divider2"'+D+'></div><div class="vi-col3"'+D+"></div></div>",markupSlots:{col1Node:function C(){return this.domNode.firstChild;},divider1Node:function H(){return this.domNode.childNodes[1];},col2Node:function A(){return this.domNode.childNodes[2];},divider2Node:function B(){return this.domNode.childNodes[3];},col3Node:function E(){return this.domNode.lastChild;}},markupMethods:{onvisibleChange:mstrmojo.Widget.visibleMarkupMethod,onenabledChange:mstrmojo.Container.enabledMarkupMethod},layoutConfig:{w:{col1Node:"30%",divider1Node:"5px",col2Node:"30%",divider2Node:"5px",col3Node:"40%"},xt:true},shouldPropagateEnabled:true,col1Width:"30%",divider1Width:"5px",col2Width:"30%",divider2Width:"5px",col3Width:"40%",init:function G(I){this._super(I);var J=this.layoutConfig=JSON.parse(JSON.stringify(this.layoutConfig)),K=J.w;K.col1Node=this.col1Width;K.divider1Node=this.divider1Width;K.col2Node=this.col2Width;K.divider2Node=this.divider2Width;K.col3Node=this.col3Width;},getControl:function F(I){return(this.children||[]).filter(function(J){return J.slot==="col"+I+"Node";})[0];}});}());(function(){mstrmojo.requiresCls("mstrmojo.Container","mstrmojo._HasLayout");var D=' style="display:inline-block;vertical-align:middle;"';mstrmojo.ui.editors.controls.TwoColumnContainer=mstrmojo.declare(mstrmojo.Container,[mstrmojo._HasLayout],{scriptClass:"mstrmojo.ui.editors.controls.TwoColumnContainer",markupString:'<div id="{@id}" class="mstrmojo-vi-TwoColumnProp {@cssClass}" style="{@cssText}"><div class="vi-col1"'+D+'></div><div class="divider"'+D+'></div><div class="vi-col2"'+D+"></div></div>",markupSlots:{col1Node:function C(){return this.domNode.firstChild;},dividerNode:function B(){return this.domNode.childNodes[1];},col2Node:function A(){return this.domNode.lastChild;}},markupMethods:{onvisibleChange:mstrmojo.Widget.visibleMarkupMethod,onenabledChange:mstrmojo.Container.enabledMarkupMethod},layoutConfig:{w:{col1Node:"40%",dividerNode:"5px",col2Node:"60%"},xt:true},shouldPropagateEnabled:true,col1Width:"40%",dividerWidth:"5px",col2Width:"60%",init:function F(G){this._super(G);var H=this.layoutConfig=JSON.parse(JSON.stringify(this.layoutConfig)),I=H.w;I.col1Node=this.col1Width;I.dividerNode=this.dividerWidth;I.col2Node=this.col2Width;},getControl:function E(G){return(this.children||[]).filter(function(H){return H.slot==="col"+G+"Node";})[0];}});}());(function(){mstrmojo.requiresCls("mstrmojo.Container","mstrmojo._FillsBrowser","mstrmojo._HasLayout");function A(){var D=this._resizeHandler;if(D){window.clearInterval(D);delete this._resizeHandler;}}mstrmojo.OIVMPage=mstrmojo.declare(mstrmojo.Container,[mstrmojo._FillsBrowser,mstrmojo._HasLayout],{scriptClass:"mstrmojo.OIVMPage",markupString:'<div id="{@id}" class="mstrmojo-OIVMPage {@cssClass} {@themeClassName}" style="{@cssText}"><div class="mstrmojo-OIVMPage-pathbar"></div><div class="mstrmojo-OIVMPage-layout"></div></div>',markupSlots:{pathbarNode:function(){return this.domNode.childNodes[0];},layout:function(){return this.domNode.lastChild;}},layoutConfig:{h:{pathbarNode:"42px",layout:"100%"},w:{pathbarNode:"100%",layout:"100%"}},onError:function(F){var H=F.detail,G=mstrApp,E="#666",I=F.code;if(I){var D=mstrmojo.Button.newInteractiveButton;switch(I){case -2147468986:case -2147467618:F.btns=[D(mstrmojo.desc(3758,"Re-run Document"),function(){mstrmojo.form.send({evt:2048001,src:G.name+"."+G.pageName+".2048001",documentID:H.dssid,currentViewMedia:1});},E),D(mstrmojo.desc(221,"Cancel"),function(){mstrmojo.form.send({evt:3010,src:mstrApp.name});},E)];break;default:F.btns=[D(mstrmojo.desc(212,"Continue"),function(){mstrmojo.form.send({evt:3026,src:G.name+"."+G.pageName+".3026"});},E)];}}},renderPageLoadError:function(){var D=this.error;this.onError(D);if(!D.btns||!D.btns.length){mstrmojo.alert(D.message,null,D.title);}else{mstrmojo.confirm(D.message,null,{buttons:D.btns,title:D.title});}},render:function C(){if(this.error){this.renderPageLoadError();}else{this._super();}},browserResized:function B(D,G){var F=this._super(D),E=this;if(G){A.call(this);this._resizeHandler=window.setInterval(function(){var H=mstrApp.docModel.controller,K=H,J=H.zoom,I=H.view.zoomValue;if(J){A.call(E);J.call(K,I&&I.dssid);}},300);}return F;},destroy:function(D){A.call(this);this._super(D);}});}());(function(){mstrmojo.requiresCls("mstrmojo.dom","mstrmojo.css","mstrmojo.Container","mstrmojo._IsPopup","mstrmojo.boxmodel","mstrmojo.dom","mstrmojo.ui._HasScroller");var L=mstrmojo.boxmodel,I=mstrmojo.dom,M=mstrmojo.css,O="mstrmojo-Tooltip",A="mstrmojo-scrollNode",E=20;function C(S,U,R){var V="connectScrollbox";if(R){V="dis"+V;}var Q=S&&S.parent;while(Q){if(Q[V]){Q[V](U);}Q=Q.parent;}}function G(){if(!this._paintHandle){var R=this.id,Q=function(W){var a=mstrmojo.all[R];if(!a){return ;}delete a._paintHandle;var U=[O],b=a.cssClass;if(b){U.push(b);}var S=mstrApp.getThemeClassName&&mstrApp.getThemeClassName(),Y=a.opener;if(Y&&Y.getTooltipThemeClass){S=Y.getTooltipThemeClass();}U.push(S);a.domNode.className=U.join(" ");var Z=a.content,V=a.contentNode,X=a.arrowNode;V.className=(O+"-content "+A+" "+a.contentNodeCssClass);V.style.cssText=a.contentNodeCssText;if(!a.hasWidgetContent){V.innerHTML=Z;}X.style.cssText="";a.domNode.style.visibility=!!Z?"visible":"hidden";a.updatePosition();if(!W&&a.optimizePos){a.optimizePos();}a.updateScrollbars();};if(!this._hasPaint){Q(true);this._hasPaint=true;}else{this._paintHandle=window.setTimeout(Q,0);}}}function B(V,d,k,W){var Z=d&&(d.richTooltip||d.tooltip),n=k?I.getMousePosition(k,W||self):null,c=Z&&(typeof Z==="string");var l="",b="",Y="",h=Z,a=null,Q=mstrmojo.tooltip.POS_TOPLEFT,S=null,f=null,R=null,m=false,U=null,X=mstrmojo._HasTooltip.TOOLTIP_CLOSE_DELAY;var g=false,j=false;if(Z&&!c){b=Z.cssClass||b;l=Z.contentNodeCssClass||l;Y=Z.contentNodeCssText||Y;h=Z.content||"";a=Z.refNode||a;Q=Z.posType||Q;S=Z.left||0;f=Z.top||0;g=Z.keepArrowXPos||g;j=Z.keepArrowYPos||j;R=Z.updatePosition||null;m=Z.hasWidgetContent;U=Z.children;X=Z.tooltipCloseDelay||mstrmojo._HasTooltip.TOOLTIP_CLOSE_DELAY;}V.set("contentNodeCssClass",l);V.set("cssClass",b);V.set("contentNodeCssText",Y);V.set("content",h);V.set("refNode",a);V.set("posType",Q);V.set("left",c?((n&&n.x)||V.left):S);V.set("top",(c||!Z)?((n&&(n.y+E))||V.top):f);V.set("keepArrowXPos",g);V.set("keepArrowYPos",j);if(R){V.set("updatePosition",R);}else{V.set("updatePosition",mstrmojo.Tooltip.prototype.updatePosition);}V.set("hasWidgetContent",m);V.set("children",U);V.set("tooltipCloseDelay",X);}mstrmojo.Tooltip=mstrmojo.declare(mstrmojo.Container,[mstrmojo._IsPopup,mstrmojo.ui._HasScroller],{scriptClass:"mstrmojo.Tooltip",content:null,top:null,left:null,refNode:null,keepArrowXPos:false,keepArrowYPos:false,posType:"TL",allowOtherTooltips:false,markupString:'<div id="{@id}" class="'+O+' {@cssClass}" style="{@cssText}" mstrAttach:mouseover,mouseout><div class="'+O+'-shadow {@shadowNodeCssClass}"></div><div class="'+O+'-contentWrapper"><div class="'+O+"-content "+A+' {@contentNodeCssClass}" style="{@contentNodeCssText}"></div></div><div class="'+O+'-arrow"></div></div>',markupSlots:{containerNode:function(){return this.domNode.children[1];},contentNode:function(){return this.domNode.children[1].firstChild;},shadowNode:function(){return this.domNode.firstChild;},arrowNode:function(){return this.domNode.children[2];}},setupScrollNodes:function D(){this.scrollNode=this.contentNode;this.scrollbarHostNode=this.containerNode;},_previousVisible:false,markupMethods:{onvisibleChange:function(){var R=this.domNode.style,Q=!!this.visible;if(this._previousVisible!==Q){R.visibility="hidden";}R.display=Q?"block":"none";this._previousVisible=Q;if(Q){this.updatePosition();if(this.content){G.call(this);}}},onleftChange:G,ontopChange:G,onrefNodeChange:G,onposTypeChange:G,oncontentNodeCssClassChange:G,oncontentNodeCssTextChange:G,oncontentChange:G,oncssClassChange:G},preBuildRendering:function N(){if(!this.slot&&!this.placeholder){this.placeholder=document.body.appendChild(document.createElement("div"));}return this._super();},updatePosition:function H(W){if(!this.visible&&!W){return ;}var V=this.refNode,U=V?L.offset(V,document.body):{left:I.getHorizontalScroll(),top:I.getVerticalScroll()},n=this.domNode.style,g=this.containerNode,j=g.offsetWidth,a=g.offsetHeight,R=this.posType,d=R.indexOf("R")>-1,X=R.indexOf("B")>-1,c=this.top!==null?parseInt(this.top,10)+U.top-(X?a:0):null,S=this.left!==null?parseInt(this.left,10)+U.left-(d?j:((R.indexOf("C")>-1)?Math.floor(j/2):0)):null,l=false,b=false,e,Y,k=I.windowDim(),h=I.getHorizontalScroll()+k.w,Q=I.getVerticalScroll()+k.h,f=this.arrowNode,m=null;if(S!==null){e=Math.min(Math.max(S,0),h-j);n.left=e+"px";l=S!==e;}if(c!==null){Y=Math.min(Math.max(c,0),Q-a);n.top=Y+"px";b=c!==Y;}if(l||b){var Z,p=this.keepArrowXPos&&l,o=this.keepArrowYPos&&b;if(p||o){m=M.getComputedStyle(f);Z=m.left;}if(Z&&Z.endsWith("%")){Z=parseFloat(Z)/100*j;}if(p){f.style.left=(parseInt(Z,10)+S-e)+"px";}if(o){f.style.top=(parseInt(m.top,10)+c-Y)+"px";}}M.toggleClass(this.domNode,"offset",l||b);},_on_tooltip_change:function(Q){B(this,Q&&Q.src);},_set_opener:function(U,S){var R=this.opener,Q=S!==R;if(Q){if(S){C(S,this);}if(R){C(S,this,true);}if(R&&R.detachEventListener){R.detachEventListener(this._richSubs);R.detachEventListener(this._ttpSubs);}if(S&&S.attachEventListener){this._richSubs=S.attachEventListener("richTooltipChange",this.id,"_on_tooltip_change");this._ttpSubs=S.attachEventListener("tooltipChange",this.id,"_on_tooltip_change");}this.opener=S;}return Q;},updatePopupConfig:function(Q,R){B(this,R,Q&&Q.e,Q&&Q.win);},onscroll:function K(){if(this.visible&&this.nudge){this.nudge();}this._super();},onmouseover:mstrmojo.emptyFn,onmouseout:mstrmojo.emptyFn});var J=null;mstrmojo.tooltip={POS_TOPLEFT:"TL",POS_BOTTOMLEFT:"BL",POS_TOPRIGHT:"TR",POS_BOTTOMRIGHT:"BR",POS_BOTTOMCENTER:"BC",POS_TOPCENTER:"TC",open:function F(R,U,S,Q){if(R&&R.hasWidgetContent&&J){J.destroy();}if(!J||!mstrmojo.all[J.id]){J=new mstrmojo.Tooltip();}Q=Q||{};Q.e=U;Q.win=S;J.open(R,Q);R.tooltip=J;},close:function P(){if(J&&!J.allowOtherTooltips){var Q=J.opener;if(Q){Q.tooltip=null;}J.close();if(Q&&Q.hasWidgetContent){J.destroy();}}}};}());(function(){mstrmojo.requiresCls("mstrmojo.Container","mstrmojo._Formattable","mstrmojo.string","mstrmojo.url");var D=mstrmojo.string,E=function E(G){return G.data.dl||G.defn.dl;};mstrmojo.DocImage=mstrmojo.declare(mstrmojo.Container,[mstrmojo._Formattable],{scriptClass:"mstrmojo.DocImage",markupString:'<div id="{@id}" k="{@k}" class="mstrmojo-DocImage" title="{@tooltip}" style="{@domNodeCssText}"><div style="{@shadowNodeCssText}"><img src="{@en@v}" style="{@imgNodeCssText}" mstrAttach:click></div>{@buttonNodeMarkup}</div>',markupSlots:{imgNode:function(){return this.domNode.firstChild;}},markupMethods:{onvisibleChange:mstrmojo.Widget.visibleMarkupMethod},update:function F(I){var J=this.model.getDataService(),G=I.data.v,H=E(I);if(I.data.v&&!((I.data.ut===4)||I.defn.oid)){G=mstrmojo.url.getFullPath(I.data.v);}this.origV=G;this.v=D.decodeXMLAttribute((J&&J.getImage&&J.getImage(G))||G);this.oid=I.defn.oid;if(H){this.tooltip=H.items[0].n;}if(this.thresholdId||I.data.tid){delete this.fmts;}this.thresholdId=I.data.tid;this.set("visible",!I.data.hidden);if(this._super){this._super(I);}},formatHandlers:{domNode:["left","top","z-index"],shadowNode:["width","height","B","fx"],imgNode:["height","width"]},preBuildRendering:function B(){this._super();if(mstrApp.isMobile&&mstrApp.useBinaryFormat){var G=this.v,I=mstrMobileApp.isOnline(),H=this.model.getDataService();if((!I&&G.indexOf("http")===0)||(I&&G.indexOf("http")!==0)){this.v=(H&&H.getDocImage&&H.getDocImage(this.origV))||G;}}if(this.node.data.ut===4&&this.v.indexOf(mstrConfig.taskURL)===-1){this.v=mstrConfig.taskURL+"?taskId=getRWEmbeddedImage&msgID="+this.model.mid+"&oid="+this.v;}this.updateDimensionsFromFormats();},updateDimensionsFromFormats:function C(){if(!mstrmojo.dom.isIE7){var G=this.getFormats(),J=(G.fx&&G.fx.ds)||0,H=mstrmojo._Formattable.getBorderWidths(this),I=1;if((mstrmojo.dom.isIE||mstrmojo.dom.isIEW3C)&&this.model.getZoomFactor){I=this.model.getZoomFactor()>1?this.model.getZoomFactor():1;H.w=Math.ceil(H.w*I);H.h=Math.ceil(H.h*I);}this.domNodeCssText+="width:"+((parseInt(G.width,10)||0)+J+H.w)+"px; height: "+((parseInt(G.height,10)||0)+J+H.h)+"px;";}},getAnchor:function A(){return this.imgNode;}});}());(function(){mstrmojo.requiresCls("mstrmojo.Widget","mstrmojo.dom");var M=mstrmojo.Widget,G=mstrmojo.dom,N=mstrmojo.global.document,C=50,B=500;mstrmojo.Stepper=mstrmojo.declare(mstrmojo.Container,null,{scriptClass:"mstrmojo.Stepper",orientation:"vertical",provider:null,title:"",markupString:'<div id="{@id}" class="mstrmojo-Stepper {@orientation} {@cssClass}" mstrAttach:click,mousedown,selectstart><div class="title">{@title}</div><div class="next">+</div><div class="text">{@itemHtml}</div><div class="prev">-</div></div>',markupSlots:{titleNode:function(){return this.domNode.firstChild;},nextNode:function(){return this.domNode.children[1];},textNode:function(){return this.domNode.children[2];},prevNode:function(){return this.domNode.lastChild;}},markupMethods:{onvisibleChange:M.visibleMarkupMethod,onheightChange:M.heightMarkupMethod,onwidthChange:M.widthMarkupMethod,onenabledChange:function I(){mstrmojo.css.toggleClass(this.domNode,"disabled",!this.enabled);}},preBuildRendering:function J(){this.itemHtml=this.provider.renderItemAt();this._super();},processEvent:function A(O){if(G.contains(this.textNode,O)||O===this.titleNode){return ;}var Q=this.provider,P=((O===this.nextNode)?"Next":"Prev");if(Q["has"+P]()){Q[P.toLowerCase()]();this.updateDisplayText();}},updateDisplayText:function E(){this.textNode.innerHTML=this.provider.renderItemAt();},startStepperInterval:function F(O,P){var Q=this;this._holdTimer=setInterval(function(){Q[P](O);},C);},stopStepperInterval:function H(){if(this._holdTimer){clearInterval(this._holdTimer);delete this._holdTimer;}},onclick:function L(O){this.processEvent(O.e.target);},onmousedown:function D(O){if(!this._holdTimer&&!this._startHoldTimer){var P=this;this._startHoldTimer=setTimeout(function(){delete P._startHoldTimer;P.startStepperInterval(O,"onclick");},B);G.attachOneTimeEvent(N,"mouseup",function(){if(P._startHoldTimer){clearTimeout(P._startHoldTimer);delete P._startHoldTimer;}P.stopStepperInterval();},true);}},onselectstart:function K(){return false;}});}());(function(){mstrmojo.vi.ui.rw.selectors.VisSelectorCurtain=mstrmojo.declare(mstrmojo.Container,[],{scriptClass:"mstrmojo.vi.ui.rw.selectors.VisSelectorCurtain",markupString:'<svg class="vis-filter-curtain"><defs><mask id="visFilterMask" x="0" y="0"><rect style="width: 100%; height: 100%; fill: #FCFCFC; opacity: 0.5 " /></mask></defs><rect id="VisFilterCurtain" style="width: 100%; height: 100%; fill: #FCFCFC; mask: url(#visFilterMask)" /></svg>',markupSlots:{curtainNode:function B(){return this.domNode.firstChild;}},init:function C(D){this._super(D);},postBuildRendering:function A(){this._super();}});}());(function(){mstrmojo.requiresCls("mstrmojo.css","mstrmojo.Container");var D="slot";mstrmojo.HBox=mstrmojo.declare(mstrmojo.Container,null,{scriptClass:"mstrmojo.HBox",cellCssClass:"",cellSpacing:0,cellPadding:0,markupString:'<table id="{@id}" class="mstrmojo-HBox {@cssClass}" style="{@cssText}" cellspacing="{@cellSpacing}" cellpadding="{@cellPadding}">{@colHTML}<tr>{@tableHtml}</tr></table>',colHTML:"",markupSlots:{containerNode:function(){return this.domNode.rows[0];}},markupMethods:{onvisibleChange:function(){this.domNode.style.display=this.visible?mstrmojo.css.DISPLAY_TABLE:"none";}},buildRendering:function B(){this.tableHtml="";var N=[],F=this.children,K=(F&&F.length)||0,I;if(K){var G=0,J=this.cellCssClass?' class="mstrmojo-HBox-cell '+this.cellCssClass+'" ':"",M="<td "+J+"></td>";for(I=0;I<K;I++){N[G++]=M;F[I].slot=D+I;}this.tableHtml=N.join("");}this._super();if(K){var L={},H=this.containerNode.cells;for(I=0;I<K;I++){L["slot"+I]=H[I];}this.addSlots(L);}},addChildren:function E(K,F,G){if(!K){return K;}if(F===undefined||isNaN(F)||F<0){var J=this.children;F=(J&&J.length)||0;}var I=0,H;if(K.constructor===Array){for(I=0,H=K.length;I<H;I++){K[I].slot=D+(F+I);}}else{K.slot=D+F;}return this._super(K,F,G);},childRenderCheck:function C(G){if(G&&!G.hasRendered){var F=G.slot||this.defaultChildSlot;return !!this[F]||F.match(/^slot[\d]+$/);}return false;},onchildRenderingChange:function A(I){var F=(I&&I.src)||I,L=F&&F.domNode;if(L){var Q=F.slot;if(!this[Q]){var J=Q&&Q.match(/^slot([\d]+)$/);if(J){var O=parseInt(J[1],10),N=this.containerNode,P=N.cells,M=(P&&P.length)||0,K={};for(var H=M;H<=O;H++){var G=N.insertCell(H);K["slot"+H]=G;if(this.cellCssClass){G.className=this.cellCssClass;}}this.addSlots(K);}}}this._super(I);}});})();(function(){mstrmojo.requiresCls("mstrmojo.Container","mstrmojo.ui._HasScroller");var D=mstrmojo.Widget;mstrmojo.ui.ScrollableContainer=mstrmojo.declare(mstrmojo.Container,[mstrmojo.ui._HasScroller],{scriptClass:"mstrmojo.ui.ScrollableContainer",markupString:'<div id="{@id}" class="mstrmojo-ui-ScrollableContainer {@cssClass}" style="{@cssText}"><div class="ScrollableContainer-content"></div></div>',markupSlots:{containerNode:function A(){return this.domNode.firstChild;}},markupMethods:{onvisibleChange:D.visibleMarkupMethod,onheightChange:D.heightMarkupMethod,onwidthChange:D.widthMarkupMethod},setupScrollNodes:function C(){this.scrollNode=this.containerNode;},onOpen:function B(){this.updateScrollbars();}});}());(function(){mstrmojo.requiresCls("mstrmojo.Container");mstrmojo.FieldSet=mstrmojo.declare(mstrmojo.Container,null,{legend:null,scriptClass:"mstrmojo.FieldSet",markupString:'<fieldset id="{@id}" class="mstrmojo-FieldSet {@cssClass}" style="{@cssText}"><legend class="{@cssClass}-legend">{@legend}</legend></fieldset>',markupSlots:{legendNode:function(){return this.domNode.firstChild;},containerNode:function(){return this.domNode;}},markupMethods:{onlegendChange:function(){this.legendNode.innerHTML=mstrmojo.string.encodeHtmlString((this.legend!=null)?this.legend:"");},onvisibleChange:function(){this.domNode.style.display=this.visible?"block":"none";}}});})();(function(){mstrmojo.requiresCls("mstrmojo.Container","mstrmojo._HasBuilder","mstrmojo._Formattable","mstrmojo._HasToolbar");var C="\u001E";var G=1;var I=2;var B=1;var J={TOP:0,BOTTOM:1,LEFT:2,RIGHT:3,vert:["height","width","top"],horiz:["width","height","left"],updateStyle:function(L){var O=L.defn.qsm;if(!O){return ;}if(L.getFormats().width){return ;}var P=null;if(O==G){P=L.containerNode.firstChild;}else{P=L.containerNode.lastChild;}if(!P){return ;}var M=P.clientHeight+"px";var K=P.clientWidth+"px";var N=L.domNode.style;N.height=M;N.width=K;if(L.parent.updateStyle){L.parent.updateStyle(M,K);}},repositionChildren:function(Q){if(!Q.children){return ;}var P=Q.getFormats(),O=parseInt(P.height,10),U=parseInt(P.width,10);var K=Q.children,N=K[0].getFormats(),W=K[1].getFormats();var L=(Q.defn.gp<this.LEFT),S=L?O:U,R=L?U:O,V=this[(L?"vert":"horiz")];var M=Math.round(S*(Q.defn.ga/100));N[V[0]]=M+"px";N[V[1]]=R+"px";W[V[0]]=(S-M)+"px";W[V[1]]=R+"px";if((Q.defn.gp%2)===0){W[V[2]]=M+"px";}else{N[V[2]]=(S-M)+"px";}this.resizeChildren(K[0],K[1]);},stackChildren:function(K){var N=K.children,O=K.getFormats(),M;var L;for(L=N.length-1;L>=0;L--){M=N[L].getFormats();M.width=O.width;M.height=O.height;}this.resizeChildren(N[0],N[1]);},resizeChildren:function(M,K){M.renderPortalState();var L=K.getFormats();K.resizeForDisplayState(parseInt(L.height,10),parseInt(L.width,10),true);},changeVisibility:function(M,K){var P=M.children,O=M.defn.qsm,L=K&&(!O||M.viewMode===G),N=K&&(!O||M.viewMode===I);if(P&&P.length>0){if(P[0].visible!==L){P[0].set("visible",L);}if(P[1].visible!==N){P[1].set("visible",N);}}M.visible=K;},setViewMode:function H(L){var M=L.children,N=L.visible;if(L.defn.qsm&&M&&M.length>0){var K=L.viewMode;M[0].set("visible",(K==G)&&N);M[1].set("visible",(K==I)&&N);}},clearFormatCache:function D(L){var N=L.children;for(var M=0,K=N&&N.length||0;M<K;M++){N[M].clearCache();}}};mstrmojo.DocGridGraph=mstrmojo.declare(mstrmojo.Container,[mstrmojo._HasBuilder,mstrmojo._Formattable,mstrmojo._IsSelectorTarget],{scriptClass:"mstrmojo.DocGridGraph",markupString:'<div id="{@id}" k="{@k}" title="{@tooltip}" class="mstrmojo-DocGridGraph" style="{@domNodeCssText}"><div class="mstrmojo-DocGridGraph-msg"></div><div class="mstrmojo-DocGridGraph-container"></div></div>',markupSlots:{msgNode:function(){return this.domNode.firstChild;},containerNode:function(){return this.domNode.lastChild;}},formatHandlers:{domNode:["RW","B","background-color","fx","font"]},viewMode:null,visible:true,resize:function E(){this.clearCache();J.clearFormatCache(this);var M=this.getFormats(),K=parseInt(M.width,10),L=parseInt(M.height,10);if(K>0&&L>0){J.changeVisibility(this,true);if(!this.defn.qsm){J.repositionChildren(this);}else{J.stackChildren(this);}}else{J.changeVisibility(this,false);}},postBuildRendering:function A(){this._super();var M=this.node.data.eg;if(M===undefined){this.msgNode.style.display="none";this.containerNode.style.display="block";}else{this.msgNode.innerHTML=M;this.msgNode.style.display="block";this.containerNode.style.display="none";}var L=this.defn.qsm;if(!this.viewMode&&L){this.viewMode=L;}var K=this.node.defn;K.attachEventListener("qsmChange",this.id,function(N){this.viewMode=N.value;J.setViewMode(this);this.model.getDataService().setGridDisplayMode(this.k,this.viewMode,null,{cpmfig:{silent:true}});J.updateStyle(this);});J.setViewMode(this);J.updateStyle(this);if(!L&&this.defn.ds===B){this.resize();}},getGridWidget:function(){return this.children[0];},getGraphWidget:function(){return this.children[1];},updateGraph:function(L){var K=this.getGraphWidget();if(K){K.update(L);K.refresh();}},quickSwitch:function F(){var K=this.viewMode!=I;this.defn.set("qsm",(K?I:G));return true;}});})();(function(){mstrmojo.requiresCls("mstrmojo.Container","mstrmojo._IsPopup","mstrmojo._CanAutoClose");function A(B){return function(){this.domNode.style[B]=this[B]||"";};}mstrmojo.Popup=mstrmojo.declare(mstrmojo.Container,[mstrmojo._IsPopup,mstrmojo._CanAutoClose],{scriptClass:"mstrmojo.Popup",shadowNodeCssClass:"mstrmojo-popup-shadow",titleNodeCssClass:"mstrmojo-popup-title",contentNodeCssClass:"mstrmojo-popup-content",cssDisplay:"block",keepOpen:false,markupString:'<div id="{@id}" class="mstrmojo-Popup {@cssClass}" style="{@cssText}"><div class="mstrmojo-Popup-shadow {@shadowNodeCssClass}"></div><div class="mstrmojo-Popup-title {@titleNodeCssClass}">{@title}</div><div class="mstrmojo-Popup-content {@contentNodeCssClass}"></div></div>',markupSlots:{containerNode:function(){return this.domNode.lastChild;},shadowNode:function(){return this.domNode.firstChild;}},markupMethods:{onvisibleChange:mstrmojo.Widget.visibleMarkupMethod,onleftChange:A("left"),ontopChange:A("top"),onzIndexChange:A("zIndex")}});}());(function(){mstrmojo.requiresCls("mstrmojo.Container");mstrmojo.TabStripBase=mstrmojo.declare(mstrmojo.Container,null,{scriptClass:"mstrmojo.TabStripBase",target:null,targetProps:null,isStrip:true,ontargetChange:function A(I){var J=I&&I.valueWas;if(J){var G=this._targetSubs;if(G){J.detachEventListener(G.add);J.detachEventListener(G.rem);J.detachEventListener(G.sel);}this.removeChildren();}var K=this.target;if(K){var E=this.targetProps,D=(E&&E.children)||"children",B=K[D];this.addTabButtons(B,0);var H="attachEventListener",C=this.id,F;if(K[H]){this._targetSubs={add:K[H]("addChild",C,function(L){var M=L&&L.value;if(M&&M.length){this.addTabButtons(M,L.index);}}),rem:K[H]("removeChild",C,function(M){var L=M&&M.value;for(F=((L&&L.length)||0)-1;F>-1;F--){this.removeTabButton(L[F]);}}),sel:K[H]("selectedChange",C,function(L){this.selectionChange(L);})};}}},addTabButtons:mstrmojo.emptyFn,removeTabButton:mstrmojo.emptyFn,selectionChange:mstrmojo.emptyFn});}());(function(){mstrmojo.requiresCls("mstrmojo.array","mstrmojo.Container","mstrmojo._CanRenderChildrenOnShow");var A=mstrmojo.array;mstrmojo.StackContainer=mstrmojo.declare(mstrmojo.Container,[mstrmojo._CanRenderChildrenOnShow],{scriptClass:"mstrmojo.StackContainer",isStack:true,markupString:'<div id="{@id}" class="mstrmojo-StackContainer {@cssClass}" style="{@cssText}"></div>',markupMethods:{onwidthChange:function(){if(!isNaN(parseInt(this.width))){this.domNode.style.width=this.width;}},onheightChange:function(){if(!isNaN(parseInt(this.height))){this.domNode.style.height=this.height;}},onborderChange:function(){this.domNode.style.border=this.border||"";},onbackgroundChange:function(){this.domNode.style.background=this.background||"";}},markupSlots:{containerNode:function(){return this.domNode;}},_set_selected:function D(H,F){var G=this.selected;if(G===F){return false;}if(G){G.set("visible",false);}this.selected=F;if(F){F.set("visible",true);}return true;},addChildren:function B(J,G,H){var K=this.selected,L;for(var I=0,F=(J&&J.length)||0;I<F;I++){L=J[I];if(L&&L.set){L.set("visible",L===K);}}return this._super(J,G,H);},removeChildren:function C(H,F){var G=this._super(H,F);if(!H||(H===this.selected)){this.set("selected",null);}return G;},destroy:function E(F){this._super(F);this.selected=null;},renderMode:"onshow"});})();mstrmojo.requiresCls("mstrmojo.Container");mstrmojo.TBox=mstrmojo.declare(mstrmojo.Container,null,{scriptClass:"mstrmojo.TBox",markupString:'<table id="{@id}" class="mstrmojo-TBox {@cssClass}" cellspacing="{@cellSpacing}" cellpadding="{@cellPadding}" style="{@cssText}"><tbody><tr><td></td></tr></tbody></table>',markupSlots:{containerNode:function(){return this.domNode.rows[0].cells[0];}},cellSpacing:0,cellPadding:0});(function(){mstrmojo.requiresCls("mstrmojo.hash","mstrmojo.Container","mstrmojo._FormatDefinition","mstrmojo.CheckBox","mstrmojo.array");var E=mstrmojo.hash,A=mstrmojo._FormatDefinition,F=mstrmojo.array;var D=function(G){return mstrmojo.hash.copy(G,{scriptClass:"mstrmojo.TextBox",alias:"decimalPlaces",bindings:{m:G.modelBinding,value:function(){return this.m.DecimalPlaces||"2";},category:function(){var H=this.m.Category;this.onkeyup();}},onkeyup:function(H){if(/^\d{1,2}$/.test(this.value)){var O=this.m.DecimalPlaces,J=this.value;this.m.DecimalPlaces=J;if(O!=J&&this.negative){var K=this.parent[this.negative],M;if(K&&K.refreshFormatList){K.refreshFormatList();}else{M=mstrmojo.hash.clone(A[this.negative]);if(M){var N=J>0?".":"",I=N,L;for(L=0;L<Math.min(J,A.MaxNegativeDidigts);L++){N+=L%9;I+="0";}for(L=0;L<M.length;L++){M[L].n=M[L].n.replace(/\.\d{2}/g,N);M[L].f=M[L].f.replace(/\.\d{2}/g,I);}K.set("items",M);}}}}}});},B=function(G){return mstrmojo.hash.copy(G,{scriptClass:"mstrmojo.List",cssClass:"mstrmojo-FormatEditor-numberFormatList",itemMarkupFunction:function(J,H,K){var I=J.r?"color: red":"";return'<div class="mstrmojo-FormatEditor-bullet"><div class="mstrmojo-text" style="'+I+'">'+J.n+"</div></div>";},selectionPolicy:"reselect",bindings:{m:G.modelBinding,selectedIndex:function(){var H=F.find(this.items,"v",this.m.NegativeNumbers);if(H===-1){H=F.find(this.items,"f",this.m.Format);}this.singleSelect(H);return H==-1?3:H;},category:function(){var H=this.m.Category;this.onchange();}},onchange:function(H){if(this.parent.idx===F.find(A.Category,"v",this.m.Category)&&this.selectedItem){this.m.NegativeNumbers=this.selectedItem.v;this.m.set("Format",this.selectedItem.f||this.selectedItem.v);}},onmChange:function(H){if(this.m){var M=this.m.DecimalPlaces;if(M!=2){var K=mstrmojo.hash.clone(A[this.alias]);if(K){var L=M>0?".":"",I=L,J;for(J=0;J<Math.min(M,A.MaxNegativeDidigts);J++){L+=J%9;I+="0";}for(J=0;J<K.length;J++){K[J].n=K[J].n.replace(/\.\d{2}/g,L);K[J].f=K[J].f.replace(/\.\d{2}/g,I);}this.set("items",K);}}}},postCreate:function(){this.onmChange();}});},C=function(G){return mstrmojo.hash.copy(G,{scriptClass:"mstrmojo.List",cssClass:"mstrmojo-FormatEditor-numberFormatList "+G.alias,itemMarkupFunction:function(I,H,J){return'<div class="mstrmojo-FormatEditor-bullet"><div class="mstrmojo-text">'+I.n+"</div></div>";},selectedIndex:0,bindings:{m:G.modelBinding,selectedIndex:function(I){var H=F.find(this.items,"v",this.m.Format);return H===-1?0:H;},category:function(){var H=this.m.Category;this.onchange();}},onchange:function(H){if(this.parent.idx===F.find(A.Category,"v",this.m.Category)){this.m.set("Format",this.selectedItem.f||this.selectedItem.v);}}});};mstrmojo.NumberFormatter=mstrmojo.declare(mstrmojo.Container,null,{scriptClass:"mstrmojo.NumberFormatter",cssClass:"mstrmojo-NumberFormatter",markupString:'<div id={@id} class="{@cssClass}" style="{@cssText}"></div>',markupSlots:{containerNode:function(){return this.domNode;}},markupMethods:{onvisibleChange:function(){this.domNode.style.display=this.visible?"block":"none";}},postCreate:function(){this.onmodelChange();},onmodelChange:function(){if(this.model&&!this.model.scriptClass){E.make(this.model,mstrmojo.Obj);}},children:[{scriptClass:"mstrmojo.Table",layout:[{cells:[{colSpan:2}]},{cells:[{},{}]}],children:[{slot:"0,0",scriptClass:"mstrmojo.Label",text:mstrmojo.desc(7940),cssClass:"category",cssText:"font-weight: bold"},{slot:"1,0",scriptClass:"mstrmojo.List",alias:"numberCategory",cssClass:"mstrmojo-FormatEditor-numberCategory",items:A.Category,selectionPolicy:"reselect",bindings:{m:"this.parent.parent.model",selectedIndex:function(){var H=this.m.Category,G=F.find(this.items,"v",(H==="pru"?-2:H));return(G===-1)?0:G;}},onchange:function(G){if(this.m){this.m.set("Category",this.selectedIndex===0?"pru":this.selectedItem.v);}}},{slot:"1,1",scriptClass:"mstrmojo.Container",alias:"numberSubpanelContainer",width:"300px",markupString:'<div id={@id} class="mstrmojo-FormatEditor-numberPanel-subpanel {@cssClass}"><div class="mstrmojo-FormatEditor-numberPanel-subpanel-container"></div></div>',markupSlots:{containerNode:function(){return this.domNode.firstChild;}},postBuildRendering:function(){var G=mstrmojo.Container.prototype.postBuildRendering.apply(this);this.parent.numberCategory.singleSelect(this.parent.numberCategory.selectedIndex);return G;},children:[{scriptClass:"mstrmojo.Table",cssClass:"mstrmojo-FormatEditor-numberPanel-subpanel-item",idx:0,rows:1,cols:1,children:[{scriptClass:"mstrmojo.Label",text:" ",slot:"0,0"}],bindings:{visible:'this.parent.parent.parent.model.Category=="pru"',category:function(){var H=this.parent.parent.parent.model,G=this.parent.parent.parent.model.Category;if(H&&this.idx===F.find(A.Category,"v",G)){H.set("Format","");}}}},{scriptClass:"mstrmojo.Table",cssClass:"mstrmojo-FormatEditor-numberPanel-subpanel-item",idx:1,rows:1,cols:1,children:[{scriptClass:"mstrmojo.Label",text:" ",slot:"0,0"}],bindings:{visible:"this.parent.parent.parent.model.Category==9",category:function(){var H=this.parent.parent.parent.model,G=this.parent.parent.parent.model.Category;if(H&&this.idx===F.find(A.Category,"v",G)){H.set("Format","");}}}},{scriptClass:"mstrmojo.Table",cssClass:"mstrmojo-FormatEditor-numberPanel-subpanel-item fixed",idx:2,rows:3,cols:2,layout:[{cells:[{},{}]},{cells:[{},{}]},{cells:[{colSpan:2}]}],bindings:{visible:"this.parent.parent.parent.model.Category==0"},children:[{scriptClass:"mstrmojo.Label",text:mstrmojo.desc(2046),slot:"0,0"},D({modelBinding:"this.parent.parent.parent.parent.model",negative:"FixedNegative",alias:"FixedDecimalPlaces",slot:"0,1"}),{scriptClass:"mstrmojo.Label",text:mstrmojo.desc(2044),slot:"1,0"},B({modelBinding:"this.parent.parent.parent.parent.model",items:A.FixedNegative,refreshFormatList:function(){var H=this.parent,K=H&&H.FixedDecimalPlaces,N=H&&H.ThousandSeparator;if(!K||!N){return ;}var I=K.value||0,R=mstrmojo.hash.clone(A.FixedNegative),G=N.checked,Q=I>0?".":"",P=Q,O,M,L;for(M=0,L=Math.min(I,A.MaxNegativeDidigts);M<L;M++){Q+=M%9;P+="0";}var J;for(J=0;J<R.length;J++){O=R[J].n.replace(/\.\d{2}/g,Q);if(!G){O=O.replace("1,234","1234");}R[J].n=O;O=R[J].f.replace(/\.\d{2}/g,P);if(!G){O=O.replace(/#,##/g,"###");}R[J].f=O;}this.set("items",R);},alias:"FixedNegative",slot:"1,1"}),{scriptClass:"mstrmojo.ImageCheckBox",alias:"ThousandSeparator",label:mstrmojo.desc(2049),cssText:"width:auto;",bindings:{m:"this.parent.parent.parent.parent.model",checked:function(){var G=this.m.ThousandSeparator;if(G==null){G=-1;}return parseInt(G,10)!==0;}},oncheckedChange:function(){if(this.m&&this.parent.idx===F.find(A.Category,"v",this.m.Category)){this.m.ThousandSeparator=this.checked?-1:0;this.parent.FixedNegative.refreshFormatList();}},slot:"2,0"}]},{scriptClass:"mstrmojo.Table",cssClass:"mstrmojo-FormatEditor-numberPanel-subpanel-item currency",idx:3,rows:4,cols:2,bindings:{visible:"this.parent.parent.parent.model.Category==1"},children:[{scriptClass:"mstrmojo.Label",text:mstrmojo.desc(2046),slot:"0,0"},D({modelBinding:"this.parent.parent.parent.parent.model",negative:"CurrencyNegative",alias:"currencyDecimal",slot:"0,1"}),{scriptClass:"mstrmojo.Label",text:mstrmojo.desc(2047),slot:"1,0"},{scriptClass:"mstrmojo.TextBox",alias:"currencySymbol",maxLength:5,bindings:{m:"this.parent.parent.parent.parent.model",value:function(){return this.m.CurrencySymbol||mstrmojo.desc("2369");},category:function(){var G=this.m.Category;this.onkeyup();}},onkeyup:function(G){this._update();},onvalueChange:function(){this._update();},_update:function(){if(this.m){var H=this.m.CurrencySymbol;this.m.CurrencySymbol=this.value;var G=this.parent.CurrencyNegative;if(G&&(H!=this.value)){G.refreshFormatList();}}},slot:"1,1"},{scriptClass:"mstrmojo.Label",text:mstrmojo.desc(2048),slot:"2,0"},{scriptClass:"mstrmojo.List",cssClass:"mstrmojo-FormatEditor-numberFormatList",alias:"CurrencyPosition",items:A.CurrencyPosition,itemMarkupFunction:function(H,G,I){return'<div class="mstrmojo-FormatEditor-bullet"><div class="mstrmojo-text">'+H.n+"</div></div>";},bindings:{m:"this.parent.parent.parent.parent.model",selectedIndex:function(){var G=F.find(A.CurrencyPosition,"v",this.m.CurrencyPosition);return(G===-1?0:G);},category:function(){var G=this.m.Category;this.onchange();}},onchange:function(G){if(this.m){this.m.CurrencyPosition=this.selectedItem.v;var H=this.parent.CurrencyNegative;if(H){H.refreshFormatList();}}},slot:"2,1"},{scriptClass:"mstrmojo.Label",text:mstrmojo.desc(2044),slot:"3,0"},B({modelBinding:"this.parent.parent.parent.parent.model",items:A.CurrencyNegative,refreshFormatList:function(){var O=this.parent,J=O&&O.currencyDecimal,N=O&&O.CurrencyPosition,K=O&&O.currencySymbol;if(!J||!N||!K){return ;}var M=J.value||0,I=parseInt(N.selectedIndex,10)||0,H=K.value||"",L=mstrmojo.hash.clone(A.CurrencyNegative),Z=M>0?".":"",X=Z,Q,Y,V;H=(I===2?H+" ":(I===3?" "+H:H));for(Y=0,V=Math.min(M,A.MaxNegativeDidigts);Y<V;Y++){Z+=Y%9;X+="0";}var P=mstrConfig.decimalSep,G=mstrConfig.thousandsSep,U;for(U=0;U<L.length;U++){var R=L[U].n,W=L[U].f,S;if(I===1||I===3){Q=W.split(";");for(S=0,V=Q.length;S<V;S++){Q[S]=Q[S].replace(/(\"\$\")(.*)/g,"$2$1");}R=R.replace(/(\$)(.*)/g,"$2$1");W=Q.join(";");}R=R.replace(/\$/g,H).replace(/\.\d{2}/g,Z);W=W.replace(/\$/g,H).replace(/\.\d{2}/g,X);L[U].n=R.replace(/,/,G).replace(/(\d{2,3})\./,"$1"+P);L[U].f=W.replace(/,/,G).replace(/(\d{2,3})\./,"$1"+P);}this.set("items",L);},alias:"CurrencyNegative",slot:"3,1"})]},{scriptClass:"mstrmojo.Table",cssClass:"mstrmojo-FormatEditor-numberPanel-subpanel-item Date",idx:4,rows:1,cols:2,bindings:{visible:"this.parent.parent.parent.model.Category==2"},children:[{scriptClass:"mstrmojo.Label",text:mstrmojo.desc(2869),slot:"0,0"},C({modelBinding:"this.parent.parent.parent.parent.model",items:A.Date,alias:"Date",slot:"0,1"})]},{scriptClass:"mstrmojo.Table",cssClass:"mstrmojo-FormatEditor-numberPanel-subpanel-item Time",idx:5,rows:1,cols:2,bindings:{visible:"this.parent.parent.parent.model.Category==3"},children:[{scriptClass:"mstrmojo.Label",text:mstrmojo.desc(2869),slot:"0,0"},C({modelBinding:"this.parent.parent.parent.parent.model",items:A.Time,alias:"Time",slot:"0,1"})]},{scriptClass:"mstrmojo.Table",cssClass:"mstrmojo-FormatEditor-numberPanel-subpanel-item percentage",idx:6,rows:2,cols:2,bindings:{visible:"this.parent.parent.parent.model.Category==4"},children:[{scriptClass:"mstrmojo.Label",text:mstrmojo.desc(2046),slot:"0,0"},D({modelBinding:"this.parent.parent.parent.parent.model",negative:"PercentNegative",slot:"0,1"}),{scriptClass:"mstrmojo.Label",text:mstrmojo.desc(2044,"Negative numbers"),slot:"1,0"},B({modelBinding:"this.parent.parent.parent.parent.model",items:A.PercentNegative,alias:"PercentNegative",slot:"1,1"})]},{scriptClass:"mstrmojo.Table",cssClass:"mstrmojo-FormatEditor-numberPanel-subpanel-item Fraction",idx:7,rows:1,cols:2,bindings:{visible:"this.parent.parent.parent.model.Category==5"},children:[{scriptClass:"mstrmojo.Label",text:mstrmojo.desc(2869),slot:"0,0"},C({modelBinding:"this.parent.parent.parent.parent.model",items:A.Fraction,alias:"Fraction",slot:"0,1"})]},{scriptClass:"mstrmojo.Table",cssClass:"mstrmojo-FormatEditor-numberPanel-subpanel-item scientific",idx:8,rows:1,cols:2,children:[{scriptClass:"mstrmojo.Label",text:mstrmojo.desc(2046),slot:"0,0"},D({slot:"0,1",modelBinding:"this.parent.parent.parent.parent.model"})],bindings:{m:"this.parent.parent.parent.model",visible:"this.m.Category==6",category:function(){if(this.m&&this.idx===F.find(A.Category,"v",this.m.Category)){this.m.set("Format","0.00E+00");}}}},{scriptClass:"mstrmojo.Table",cssClass:"mstrmojo-FormatEditor-numberPanel-subpanel-item custom",idx:9,rows:1,cols:2,bindings:{visible:"this.parent.parent.parent.model.Category==7"},children:[{scriptClass:"mstrmojo.Label",text:mstrmojo.desc(2133),slot:"0,0"},{scriptClass:"mstrmojo.TextBox",alias:"custom",value:"",bindings:{m:"this.parent.parent.parent.parent.model",value:function(){return this.m.Format;}},onvalueChange:function(){if(this.m&&this.parent.idx===F.find(A.Category,"v",this.m.Category)){this.m.Format=this.value;}},slot:"0,1"}]}]}]}]});}());(function(){mstrmojo.requiresCls("mstrmojo.Container");function B(K,J,H){var I=J,G;for(;I>0;I--){G=Array(I+1).join("#");K=K.replace(G,H[I-1]);}return K;}var C='<div class="freezing-vis-txt-metric">',A='<div class="freezing-vis-txt-attr">',E="</div>",F="("+mstrmojo.desc(16294,"data retrieval paused")+")";var D=function(J,I){if(J<1&&I<1){return null;}var H=[],G="# ## ### ####";if(J>0){H.push(B(G,4,[A,J,J>1?mstrmojo.desc(3581,"Attributes"):mstrmojo.desc(518,"Attribute"),E]));}if(I>0){H.push(B(G,4,[C,I,I>1?mstrmojo.desc(3582,"Metrics"):mstrmojo.desc(517,"Metric"),E]));}return H.join(",");};mstrmojo.vi.ui.rw.FreezingImageContainer=mstrmojo.declare(mstrmojo.Container,[],{scriptClass:"mstrmojo.vi.ui.rw.FreezingImageContainer",markupString:'<div id="{@id}" class="mstrmojo-vi-ui-rw-freezingImageContainer mstrmojo-vi-ui-rw-GhostImageContainer {@cssClass}"><div class="mstmojo-freezingImgTableCell"><div class="mstrmojo-freezingImgDiv"><div class="freezing-vis-img ghost-vis-img"></div><div class="freezing-vis-desc"><label class="visName">{@visName}</label><div class="freezing-details">{@freezingDetails}</div></div><div class="vis-dropzone">{@visDropzoneMsg} </div></div></div></div>',markupSlots:{containerNode:function(){return this.domNode;}},visName:"",freezingDetails:F,visDropzoneMsg:""});mstrmojo.vi.ui.rw.FreezingImageContainer.getVisDropzoneMsg=D;}());(function(){mstrmojo.requiresCls("mstrmojo.dom","mstrmojo.hash","mstrmojo.Container","mstrmojo._Formattable","mstrmojo._IsThresholdConditionTarget","mstrmojo.EnumRWUnitType");var TP_HTML_CONTAINER=mstrmojo.EnumRWUnitType.HTMLCONTAINER;var $DOM=mstrmojo.dom,$HASH=mstrmojo.hash;function buildScriptNode(scriptNode){var node=document.createElement("script"),attributes=scriptNode.attributes,length=attributes.length;for(var i=0;i<length;i++){node.setAttribute(attributes[i].name,attributes[i].value);}return node;}mstrmojo.DocTextfield=mstrmojo.declare(mstrmojo.Container,[mstrmojo._Formattable,mstrmojo._IsThresholdConditionTarget],{scriptClass:"mstrmojo.DocTextfield",markupString:'<div id="{@id}" k="{@k}" class="mstrmojo-DocTextfield {@cssClass}" title="{@tooltip}" style="{@domNodeCssText}"><div class="mstrmojo-DocTextfield-valueNode" style="{@valueNodeCssText}" mstrAttach:click >{@v}</div>{@buttonNodeMarkup}</div>',markupSlots:{valueNode:function(){return this.domNode.firstChild;}},formatHandlers:{domNode:["T","z-index"],valueNode:["D","B","F","P","background-color","fx","text-align","white-space","overflow"]},markupMethods:{onvisibleChange:mstrmojo.Widget.visibleMarkupMethod},update:function update(node){var d=node.data,v=d.v||"";if(node.defn.t===TP_HTML_CONTAINER){var div=document.createElement("div");div.innerHTML="<textarea>"+v+"</textarea>";v='<div style="display:none">&nbsp;</div>'+div.firstChild.value;div=null;}this.v=v;this.tooltip=d.tooltip||this.tooltip;if(this.thresholdId||d.tid){delete this.fmts;}this.thresholdId=d.tid;this.set("visible",!node.data.hidden);if(this._super){this._super(node);}},init:function(props){this._super(props);},postBuildRendering:function postBuildRendering(){var i,len;this.handleRotatedText();if(this.defn.t===TP_HTML_CONTAINER){var scripts=this.domNode.getElementsByTagName("script");for(i=0,len=scripts.length;i<len;i++){if(scripts[i].src){var parentNode=scripts[i].parentNode,node=buildScriptNode(scripts[i]);parentNode.removeChild(scripts[i]);parentNode.appendChild(node);}else{try{eval(scripts[i].innerHTML);}catch(err){console.log(err);}}}}return this._super();},isTextFieldRotated:function isTextFieldRotated(){var formats=this.getFormats();return(formats.fx&&formats.fx.rt&&!$DOM.isDXIE&&$DOM.supports($DOM.cssFeatures.TEXT_ROTATION));},handleRotatedText:function handleRotatedText(){var formats=this.getFormats(),rotateValue=formats.fx&&formats.fx.rt;if(this.isTextFieldRotated()){var domNode=this.domNode,domNodeStyle=domNode.style;switch(rotateValue){case 1:domNodeStyle.left=(parseInt(formats.left,10)+domNode.offsetHeight)+"px";break;case 3:domNodeStyle.top=(parseInt(formats.top,10)+domNode.offsetWidth)+"px";break;}}},getAnchor:function getAnchor(){return this.valueNode;}});mstrmojo.DocSummaryTextfield=mstrmojo.declare(mstrmojo.DocTextfield,null,{scriptClass:"mstrmojo.DocSummaryTextfield",markupString:'<span id="{@id}" class="mstrmojo-DocSumTextfield {@cssClass}" title="{@tooltip}" style="{@domNodeCssText}"><span class="mstrmojo-DocTextfield-valueNode" style="{@valueNodeCssText}" mstrAttach:click >{@openLink}{@v}{@closeLink}</span>{@buttonNodeMarkup}</span>',formatHandlers:{domNode:["T","z-index"],valueNode:["D","B","F","background-color","fx","text-align","white-space","overflow"]},update:function update(node){this._super(node);if(this.v){var v=this.v,p1=new RegExp("&lt;bold&gt;","g"),p2=new RegExp("&lt;/bold&gt;","g");if(v.indexOf("&lt;empty/&gt;")>-1){this.v="";return ;}v=v.replace(p1,"<b>");v=v.replace(p2,"</b>");this.v=v;}},preBuildRendering:function preBuildRendering(){if(this._super){this._super();}}});}());(function(){mstrmojo.requiresCls("mstrmojo.ListBase2","mstrmojo.ListMapperHoriz","mstrmojo.ListBuilder");mstrmojo.ListHoriz=mstrmojo.declare(mstrmojo.ListBase2,null,{scriptClass:"mstrmojo.ListHoriz",renderOnScroll:true,listMapper:mstrmojo.ListMapperHoriz,listBuilder:mstrmojo.ListBuilder,itemField:"n",itemMarkup:null,itemMarkupFunction:null});})();(function(){mstrmojo.requiresCls("mstrmojo.ListBase2","mstrmojo.ListMapper","mstrmojo.ListBuilder","mstrmojo.ListSelector");mstrmojo.List=mstrmojo.declare(mstrmojo.ListBase2,null,{scriptClass:"mstrmojo.List",renderOnScroll:true,listMapper:mstrmojo.ListMapper,listBuilder:mstrmojo.ListBuilder,listSelector:mstrmojo.ListSelector,itemIdField:"dssid",itemField:"n",itemMarkup:null,itemMarkupFunction:null});})();(function(){mstrmojo.requiresCls("mstrmojo.ListBase2");function B(E){var I=E.ctxtBuilder;if(I){var H=I.itemWidgets,G;for(G=H.length-1;G>-1;G--){var F=H[G];if(F){F.destroy(true);}}}}mstrmojo.WidgetListBase=mstrmojo.declare(mstrmojo.ListBase2,null,{scriptClass:"mstrmojo.WidgetListBase",unrender:function C(G){var I=this.ctxtBuilder;if(I){var H=I.itemWidgets,F;for(F=H.length-1;F>-1;F--){var E=H[F];if(E&&E.hasRendered){E.unrender(true);}}}this._super(G);},refresh:function A(E){B(this);if(this._super){this._super(E);}},destroy:function D(E){B(this);this._super(E);}});})();(function(){mstrmojo.requiresCls("mstrmojo.ConditionNode","mstrmojo.dom");var B=mstrmojo.dom;mstrmojo.threshold.ConditionNode=mstrmojo.declare(mstrmojo.ConditionNode,null,{scriptClass:"mstrmojo.threshold.ConditionNode",emptyText:mstrmojo.desc(5893,"New Condition"),cssClass:"adv-threshold",avatarCssCls:"mstrmojo-thresholdRow",markupString:'<div id="{@id}" class="mstrmojo-cond mstrmojo-ConditionNode {@cssClass} mstrAttach:mousedown"><div class="mstrmojo-onhoverparent mstrmojo-cond-prefix {@cssClass}"><span class="mstrmojo-textset mstrmojo-cond-prefix-text" mstrAttach:click></span><span class="mstrmojo-onhover-in mstrmojo-andor-tools {@cssClass}">{@_prefixAndOrToolsMarkup}</span></div><div class="mstrmojo-onhoverparent mstrmojo-cond-contents {@cssClass}"><span class="mstrmojo-textset mstrmojo-cond-text {@cssClass}" mstrAttach:click></span><span class="mstrmojo-cond-text-postfix {@cssClass}"></span><span class="mstrmojo-rel mstrmojo-cond-popupNode {@cssClass}"></span><span class="mstrmojo-onhover-bl mstrmojo-abs mstrmojo-topright mstrmojo-cond-tools {@cssClass}"><img class="mstrmojo-del" src="../images/1ptrans.gif" tooltip="'+mstrmojo.desc(7931,"Delete condition")+'" onclick="mstrmojo.all[\'{@id}\'].del()" /></span><span class="mstrmojo-add-cond" mstrAttach:click>'+mstrmojo.desc(1994,"Add Condition")+"</span></div></div>",markupSlots:{prefixHoverNode:function(){return this.domNode.firstChild;},prefixNode:function(){return this.domNode.firstChild.firstChild;},prefixAndOrToolsNode:function(){return this.domNode.firstChild.childNodes[1];},condNode:function(){return this.domNode.childNodes[1];},textNode:function(){return this.domNode.childNodes[1].firstChild;},textPostfixNode:function(){return this.domNode.childNodes[1].childNodes[1];},popupNode:function(){return this.domNode.childNodes[1].childNodes[2];},addConditionNode:function(){return this.domNode.childNodes[1].childNodes[4];}},preclick:function A(C){var F=null,E=B.eventTarget(C.hWin,C.e),D=this._super(C);if(B.contains(this.addConditionNode,E,true)){F="addCondition";}C.part=F||C.part;return D;},onmouseover:function(){this.toggleGroupBorder(true);},onmouseout:function(){this.toggleGroupBorder(false);}});})();(function(){mstrmojo.requiresCls("mstrmojo.ConditionNode","mstrmojo.fe._IsRelationTreeNode","mstrmojo.dom","mstrmojo.css","mstrmojo.expr");mstrmojo.requiresDescs(1994,5893,7931,15671);var A=mstrmojo.dom,B=mstrmojo.css,D=mstrmojo.expr.ET,E=mstrmojo.fe._IsRelationTreeNode.createSetHtml;mstrmojo.fe.ConditionNode=mstrmojo.declare(mstrmojo.ConditionNode,[mstrmojo.fe._IsRelationTreeNode],{scriptClass:"mstrmojo.fe.ConditionNode",emptyText:mstrmojo.desc(5893,"New Condition"),markupString:'<div id="{@id}" class="mstrmojo-cond mstrmojo-ConditionNode {@cssClass}" mstrAttach:mousedown><div class="mstrmojo-onhoverparent mstrmojo-cond-prefix {@cssClass}"><span class="mstrmojo-textset mstrmojo-cond-prefix-text" mstrAttach:click></span><span class="mstrmojo-onhover-in mstrmojo-andor-tools {@cssClass}">{@_prefixAndOrToolsMarkup}</span></div><div class="mstrmojo-onhoverparent mstrmojo-cond-contents {@cssClass}"><span class="mstrmojo-textset mstrmojo-cond-text {@cssClass}" mstrAttach:click></span><span class="mstrmojo-cond-text-postfix {@cssClass}"></span><span class="mstrmojo-rel mstrmojo-cond-popupNode {@cssClass}"></span><span class="mstrmojo-onhover-bl mstrmojo-abs mstrmojo-topright mstrmojo-cond-tools {@cssClass}"><img class="mstrmojo-del" src="../images/1ptrans.gif" tooltip="'+mstrmojo.desc(7931,"Delete condition")+'" onclick="mstrmojo.all[\'{@id}\'].del()" /><img class="mstrmojo-lock" src="../images/lock_view.svg"/></span><span class="mstrmojo-add-cond" mstrAttach:click>'+mstrmojo.desc(1994,"Add Condition")+"</span>"+E+"</div></div>",getPrefixAndOrToolsMarkup:function(){return(E+this._super());},markupSlots:{prefixHoverNode:function(){return this.domNode.firstChild;},prefixNode:function(){return this.domNode.firstChild.firstChild;},prefixAndOrToolsNode:function(){return this.domNode.firstChild.childNodes[1];},condNode:function(){return this.domNode.childNodes[1];},textNode:function(){return this.domNode.childNodes[1].firstChild;},textPostfixNode:function(){return this.domNode.childNodes[1].childNodes[1];},popupNode:function(){return this.domNode.childNodes[1].childNodes[2];},createSetNode:function(){return this.domNode.childNodes[1].lastChild;},createSetOptNode:function(){return this.domNode.firstChild.childNodes[1].firstChild;},addConditionNode:function(){return this.domNode.childNodes[1].childNodes[4];}},markupMethods:mstrmojo.hash.copy({onnoRelationOperatorChange:function(){B.toggleClass(this.prefixHoverNode,["noRelation"],this.noRelationOperator);},onnoRelationChange:function(){B.toggleClass(this.condNode,["noRelation"],this.noRelation);},onnoCreateSetChange:function(){B.toggleClass(this.condNode,["noRelation"],this.noCreateSet);},onlockedChange:function(){B.toggleClass(this.condNode,["locked"],this.locked);}},mstrmojo.hash.copy(mstrmojo.ConditionNode.prototype.markupMethods)),init:function(I){if(this._super){this._super(I);}var K=this.data&&this.data.et;if(K){this.set("noCreateSet",mstrApp.supportAdvFilter?false:(K===D.MQ||K===D.MC));}var G=this.tree.editor;if(G){var F=G.scriptClass==="mstrmojo.fe.FilterEditor";var H=typeof (G.disableElementsBrowsing)==="function"&&G.disableElementsBrowsing();if(F&&H&&K===D.AE){this.set("locked",true);this.set("editable",false);this.set("useRichTooltip",true);var J=this;this.set("updateTooltipConfig",function(){var L=mstrmojo.dom.position(J.domNode);this.richTooltip={content:mstrmojo.desc(15671,"Edit or remove is only available in workstation"),refNode:J.domNode,enableHover:true,cssClass:"vi-regular vi-tooltip-V V-center",posType:mstrmojo.tooltip.POS_BOTTOMCENTER,left:L.w/2,top:-10};});}}},preclick:function C(F){var I=null,H=A.eventTarget(F.hWin,F.e),G=this._super(F);if(A.contains(this.createSetOptNode,H,true)&&!this.noRelationOperator&&!this.noRelation){I="createSetOpt";}else{if(A.contains(this.createSetNode,H,true)&&!this.noRelation){I="createSet";}else{if(A.contains(this.addConditionNode,H,true)){I="addCondition";}}}F.part=I||F.part;return G;},onmouseover:function(){this.toggleGroupBorder(true);},onmouseout:function(){this.toggleGroupBorder(false);}});})();(function(){mstrmojo.requiresCls("mstrmojo.css","mstrmojo.ImageToggle","mstrmojo._IsInputControl");mstrmojo.ToggleDIC=mstrmojo.declare(mstrmojo.ImageToggle,[mstrmojo._IsInputControl],{scriptClass:"mstrmojo.ToggleDIC",init:function(A){this._super(A);this.unset=this.dic.ust;},focus:function(){this.domNode.focus();},onvalueChange:function(){},onblur:function(B){var A=B.e||B,C=this.domNode,D=mstrmojo.boxmodel.offset(C,document.body);if(A.clientX>D.left&&A.clientX<D.left+C.offsetWidth&&A.clientY>D.top&&A.clientY<D.top+C.offsetHeight){this.domNode.focus();}else{this.applyChanges();}},postBuildRendering:function(){if(this._super){this._super();}if(this.showByDefault){var A=this.openerStyle;this.width=A.iw;this.height=A.ih;this.set("imageList",this.dic.vls);}}});}());(function(){mstrmojo.requiresCls("mstrmojo.Label","mstrmojo.css","mstrmojo.hash");mstrmojo.TristateCheckBox=mstrmojo.declare(mstrmojo.Label,null,{scriptClass:"mstrmojo.TristateCheckBox",grayed:true,checked:true,cssClass:"tristate",onclick:function(){if(this.grayed){this.set("grayed",!this.grayed);}else{this.set("checked",!this.checked);}},markupMethods:mstrmojo.hash.copy({oncheckedChange:function(){mstrmojo.css.toggleClass(this.domNode,"checked",this.checked);},ongrayedChange:function(){mstrmojo.css.toggleClass(this.domNode,"grayed",this.grayed);},onenabledChange:function(){mstrmojo.css.toggleClass(this.domNode,"disabled",!this.enabled);}},mstrmojo.hash.copy(mstrmojo.Label.prototype.markupMethods))});})();(function(){mstrmojo.requiresCls("mstrmojo.desc","mstrmojo.Label","mstrmojo.dom","mstrmojo.hash","mstrmojo.MetricSelectorUtility","mstrmojo.num","mstrmojo.vi.ui.rw.selectors.ISliderHelper");var C=mstrmojo.MetricSelectorUtility,A=C.FN,G=C.OP,I=C.Q,D=mstrmojo.num,H=Math.max,E=Math.min;mstrmojo.vi.ui.rw.selectors.MetricValueSliderHelper=mstrmojo.declare(mstrmojo.vi.ui.rw.selectors.ISliderHelper,null,{scriptClass:"mstrmojo.vi.ui.rw.selectors.MetricValueSliderHelper",init:function(J){this._super(J);this.slider.set("multiSelect",true);},updateOpCs:function B(){var L=this.slider,Q=L.cs1Vl,P=L.cs2Vl,O=E(Q,P),M=H(Q,P),S=L.low,N=L.high,K=L.include,U=parseInt(L.qua,10),J=(U===I._PT||U===I._PB),R=[];if((O>S&&M<N)||O<S||M>N){L.opId=K?G._BETWEEN:G._NOT_BETWEEN;}if(O===S&&M<N){L.opId=K?G._LESS_EQUAL:G._GREATER;}if(O>S&&M===N){L.opId=K?G._GREATER_EQUAL:G._LESS;}if(O===M){L.opId=K?G._EQUALS:G._NOT_EQUALS;}if(O===S&&M===N){L.unSet=true;L.cs=[];return ;}switch(L.opId){case G._BETWEEN:case G._NOT_BETWEEN:R.push({dtp:5,v:D.toLocaleString(O)+(J?"%":"")});case G._EQUALS:case G._NOT_EQUALS:R.push({dtp:5,v:D.toLocaleString(M)+(J?"%":"")});break;default:if(O>S){R.push({dtp:5,v:D.toLocaleString(O)+(J?"%":"")});}if(M<N){R.push({dtp:5,v:D.toLocaleString(M)+(J?"%":"")});}}L.cs=R;},updateSummary:function F(){var K=this.slider,N=K.opId,J="",M=K.cs1Vl>K.cs2Vl?K.cs2Vl:K.cs1Vl,O=K.cs1Vl<K.cs2Vl?K.cs2Vl:K.cs1Vl,P=this.formatNumber(M),L=this.formatNumber(O);if(K.unSet||M<=K.low&&O>=K.high&&K.include){J=mstrmojo.desc(2058,"All");}else{switch(N){case G._EQUALS:J="= "+P;break;case G._NOT_EQUALS:J=String.fromCharCode(8800)+" "+P;break;case G._GREATER:J="> "+L;break;case G._GREATER_EQUAL:J=String.fromCharCode(8805)+" "+P;break;case G._LESS:J="< "+P;break;case G._LESS_EQUAL:J=String.fromCharCode(8804)+" "+L;break;case G._BETWEEN:J=P+" - "+L;break;case G._NOT_BETWEEN:J="Not "+P+" - "+L;break;default:J=P+" - "+L;break;}}K.summary.set("text",J);}});}());(function(){mstrmojo.requiresCls("mstrmojo.Label","mstrmojo._HasEditableText","mstrmojo.css","mstrmojo._CanHandleTwoClicks","mstrmojo.Label","mstrmojo.Widget");var C=mstrmojo.css,A=mstrmojo.Label.prototype.markupMethods;mstrmojo.EditableLabel=mstrmojo.declare(mstrmojo.Label,[mstrmojo._CanHandleTwoClicks,mstrmojo._HasEditableText],{scriptClass:"mstrmojo.EditableLabel",autoApplyDelay:-1,markupString:'<div id="{@id}" class="mstrmojo-EditableLabel {@cssClass}" title="{@title}" contenteditable="{@isEditing}" style="{@cssText}" mstrAttach:click,mousedown,blur,keydown,keyup></div>',markupMethods:mstrmojo.hash.copy({onwidthChange:function(){mstrmojo.Widget.widthMarkupMethod.call(this);},ontextChange:function(){if(A.ontextChange){A.ontextChange.call(this);}this.widgetResized();},onvisibleChange:function(){if(A.onvisibleChange){A.onvisibleChange.call(this);}if(this.visible){this.widgetResized();}}},mstrmojo.hash.copy(A)),onkeyup:function E(F){this._super(F);if(this._autoApplyTimer){window.clearTimeout(this._autoApplyTimer);}if(this.autoApplyDelay!==-1){var G=this;this._autoApplyTimer=window.setTimeout(function(){G.set("isEditing",false);},this.autoApplyDelay);}},postBuildRendering:function D(){if(this._super){this._super();}this.widgetResized();},selectable:true});mstrmojo._HasMarkup.addMarkupMethods(mstrmojo.EditableLabel,{onselectableChange:function B(){var G=this[this.editableSlot],F=!!this.selectable;G.selectable=F;G.setAttribute("unselectable",!F?"on":"off");C.toggleClass(G,"unselectable",!F);}});}());(function(){mstrmojo.requiresCls("mstrmojo.vi.ui.TargetMask","mstrmojo.css","mstrmojo.desc");var A="targetMask";mstrmojo.vi.ui._HasTargets=mstrmojo.provide("mstrmojo.vi.ui._HasTargets",{_mixinName:"mstrmojo.vi.ui._HasTargets",init:function B(C){if(this._super){this._super(C);}this.addChildren([{scriptClass:"mstrmojo.vi.ui.TargetMask",alias:A,slot:"domNode",tooltipContent:this.maskTooltip,allowFilters:this.allowFilters}]);},setMaskClass:function(C){if(this[A].setMaskClass(C)){this._originalContextMenu=this.shouldShowCustomizeContextMenu;this.shouldShowCustomizeContextMenu=function(){return false;};this._originalIsDraggable=this.draggable;this.draggable=false;}},clearMaskClass:function(){this.shouldShowCustomizeContextMenu=this._originalContextMenu;delete this._originalContextMenu;this.draggable=this._originalIsDraggable;delete this._originalIsDraggable;this[A].clearMaskClass();}});}());(function(){mstrmojo.requiresCls("mstrmojo.XtabModel","mstrmojo.array","mstrmojo.func","mstrmojo.hash","mstrmojo.elementHelper");var AB="Metrics",H=2,g=mstrmojo.array,L=mstrmojo.hash,a=mstrmojo.elementHelper,A="\u001E";var J=1,o=2,N=0,X=2,B=3;function V(AH){if(!AH){return false;}var AI=this.scm,AJ,AM,AL,AK,AG,AF=false;for(AM in AI){AL=AI[AM];AK=AL.cgb;for(AJ in AK){AG=AH[AK[AJ]];if(AG){if(!AL.tks){AL.tks=AG;AF=true;}else{if(AL.tks&&(AL.tks.indexOf(AG)<0)){AL.tks+=A+AG;AF=true;}}}}}return AF;}function m(){var AG=this.data,AF=AG.gts;if(!AF){return ;}var AH;g.forEach([AF.row,AF.col],function(AI){g.forEach(AI,function(AJ){if(AJ.sc){AH=AH||{};AH[AJ.id||AB]=AJ.sc;if(AJ.fid){AH[AJ.id+"_"+AJ.fid]=AJ.sc;}}});});this.scm=AH;V.call(this,this.docModel.getCGBMap());}function AE(AF,AG){var AH=this.getDataService();AH[AF].apply(AH,AG);}function Y(AN,AT,AM){var AP=AT||a.getIdPresentation(AN),AU,AF;switch(AP){case"terse":case"terseLong":AN=AN.replace(/\\;/g,"*ESCAPESEMICOLON*");AU=AN.split(";");return(AU[0]+";"+AU[1]+(AM?";"+AM:"")).replace(/\*ESCAPESEMICOLON\*/g,"\\;");case"old":var AH="",AK=2;AN=AN.replace(/\*:/g,"*COLON*").replace(/\\/g,"\\\\").replace(/;/g,"\\;");AU=AN.split(":");while(AU[AK]){AH+=":"+AU[AK];AK++;}return("h"+AU[1]+AH+";"+AU[0]+(AM?";"+AM:"")).replace(/\*COLON\*/g,"\\:");case"oldLong":var AG=0,AS,AL,AO=[],AV=[],AR,AQ,AJ,AI=function AI(){if(AG<0){return null;}var AZ=false,AX=-1,Aa,AY=null;for(AR=AG;AR<AN.length;AR++){Aa=AN.charAt(AR);if(Aa==="*"&&!AZ){AZ=true;}else{if(Aa===":"&&!AZ){AX=AR;break;}else{AZ=false;}}}if(AX===-1){AY=AN.substring(AG);AG=-1;}else{AY=AN.substring(AG,AX);AG=AX+1;}return AY;};AJ=AI();if(AJ!=="BB"&&AJ!=="BF"){return AN;}AF=AI();if(AJ==="BF"){AF=AI();}AS=parseInt(AI(),10);AL=parseInt(AI(),10);for(AQ=0;AQ<AL;AQ++){AV[AQ]=parseInt(AI(),10);AI();}for(AQ=0;AQ<AL;AQ++){var AW=AI();if(AV[AQ]<AS&&AV[AQ]>=0){AO[AV[AQ]]=AW.replace(/\\/g,"\\\\").replace(/\*:/g,"\\:").replace(/;/g,"\\;");}}return"h"+AO.join(":")+";"+AF+(AM?";"+AM:"");}return AN;}mstrmojo.DocXtabModel=mstrmojo.declare(mstrmojo.XtabModel,null,{scriptClass:"mstrmojo.DocXtabModel",docModel:null,init:function w(AF){this._super(AF);var AG=this;this.docModel.attachEventListener("CGBMapChange",this.id,function(AH){if(AG.xtab.onCBGMapChange){AG.xtab.onCGBMapChange(AH);}});},ondataChange:function q(){m.call(this);},getMessageId:function I(){return this.docModel.mid;},getDataService:function K(){return this.docModel.getDataService();},getAction:function e(AT,AJ,AO){var AR=AT[0],AG=AR&&AR.at;var AI;if(AG){if((AG&H)>0){var AH=this.getCellTitleInfo(AR),AP=AH&&AH.title,AF=AP&&AP.id,AQ=this.scm;this.sti={titleId:AF||AB};var AN=(AF&&AQ[AF])||AQ[AB],AM=function(){var AU=[];g.forEach(AT,function(AV){if(AV._e&&AV._e.id){AU.push(AV._e.id);}});return AU.join(A);};if(AN){var AS=this.xtab,AK=(AS.allowToggleSelections&&AN.all&&AO),AL=(AH.isSrcTitle||AK);this.sti.deselectCurrent=AK;AI={h:"onGridSelector",a:{type:mstrmojo.EnumRWUnitType.GRID,anchor:AJ,ck:AN.ck,tks:AN.tks,eid:AL?"OA:(All)":AM(),ctlKey:AN.ckey,sliceId:AS.sid,isUConDS:AN.isUConDS,ifw:AN.ifw}};}}}if(!AI){AI=this._super(AT);}if(AI&&AI.a){AI.a.sliceId=this.xtab.sid;}return AI;},getDownloadAction:function v(AH,AL,AJ,AI,AM,AG,AK,AN){var AF=this._super(AH,AL,AJ,AI,AM,AK,AG);AF.sliceId=this.xtab.sid;if(AN&&AN.name==="TransactionUpdates"){if(AF.partialUpdate){if(AF.partialUpdate.selectors){AF.partialUpdate.selectors.push(AN.ctlKey);}else{AF.partialUpdate.selectors=[AN.ctlKey];}}else{AF.partialUpdate={selectors:[AN.ctlKey]};}}return AF;},getDrillAction:function p(AG,AI){var AH=this._super(AG,AI),AF=this.getCellTitleInfo(AG[0]);if(AH&&AH.isWithin){AH.attrObj=AF.title;}AH.srcMsgId=this.docModel.mid;return AH;},sort:function AA(AG,AH){var AF=this.xtab;AG.stp=AG.stp||this.getSubTotalsPos();AG.subTotalsPos=AG.stp;AG.nodeKey=AF.k;AG.treeType=AF.treeType||1;if(AF.gridData.ctlTPKeys){AG.selectors=AF.gridData.ctlTPKeys.split(A);}AE.call(this,"sortGrid",[AG,AH]);},getAdvSortData:function W(AF,AG){AE.call(this,"getAdvSortData",[AF,AG]);},pivot:function M(AF,AG){AE.call(this,"pivot",[AF,AG]);},removeUnit:function U(AF,AG){AE.call(this,"removeUnit",[AF,AG]);},getTotalsAction:function O(AF,AI,AG){var AH=this.getPivotAction(AF);AH.act="showTotals";AH.subtotalType=AI;AH.clearSubtotalType=AG;return AH;},getRemoveAxisTotalsAction:function k(AG,AF){return{act:"removeAxisTotals",axis:AF,subtotalType:AG};},showTotals:function E(AF,AG){AE.call(this,"showTotals",[AF,AG]);},drillGrid:function d(AF,AG){AE.call(this,"drillGrid",[AF,AG]);},downloadGridData:function l(AF,AG){AE.call(this,"downloadGridData",[AF,AG]);},loadLayout:function h(AF){this.docModel.loadLayout(AF);},resizeXtabColumn:function Q(AF,AG){AE.call(this,"resizeXtabColumn",[AF,AG]);},submitTemplateActions:function x(AF,AG,AH){AE.call(this,"submitTemplateUpdates",[AF,AG,AH]);},getDerivedMetricAction:function r(AF,AG){return{did:AF._e.oid,um:AF.um,alias:AF._e.n,n:AF._e.n,v:AF.um?AF.formula:AF._e.v,mix:AF.mix,cmd:AG,model:this};},getAddTemplateUnitAction:function D(AJ,AL,AH,AF){var AG=AJ.t,AK=this.data.gsi,AI={act:"addUnit",unitId:AJ.did,unitType:AG,unitPos:++AF,dsId:AL,isFirst:!AK||(AK.cols.length===0&&AK.rows.length===0)};if(AG!==4||!AK||!AK.mx.length){AI.axis=AH;}return AI;},getRemoveTemplateUnitAction:function u(AF){return{act:"removeUnit",unitId:AF.did||AF.id,unitType:AF.t||4,is_disableonly:1};},getRenameTemplateUnitAction:function G(AJ,AH,AF,AG){var AI={act:"renameUnit",id:AJ,type:AH,name:AF};if(AG){AI.isDynamicAlias=true;}return AI;},doesNameExistOnTemplate:function C(AH,AL,AJ,AG){var AK=AH.node.data.gsi,AF=AJ===4,AI=AF?AK.mx:AK.rows.concat(AK.cols);return AI.some(function(AM){return AM.did!==AL&&(AF||AM.t===AJ)&&AM.n===AG;});},getPivotUnitAction:function R(AI,AF,AM,AH,AL,AK){AF++;var AJ=parseInt(AL,10),AG=parseInt(AK,10);return L.copy(isNaN(AJ)||isNaN(AG)?{}:{originAxis:AJ,originUnitPos:++AG},{act:"pivot",unitId:String(AM||""),unitType:AH||"",axis:AI,unitPos:AF});},getShowTotalsUnitAction:function b(AI,AG,AH,AF){return{act:"showTotals",unitId:String(AI||""),unitType:AG||"",subtotalType:AH,clearSubtotalType:AF};},getMoveSubTotalAction:function j(AH,AI,AJ,AM){var AO=(this.xtab.gridInfo&&this.xtab.gridInfo.sorts)||[],AG=AH&&AH.axis,AK;function AF(AU,AV){var AW=[];if(AV.length>=AU){if(AM){AW=AU===J?AV[o-1]:AV[J-1];}else{AW=AV[AU-1];}}function AQ(AX,AY){return AX.indexOf("0!00000000000000000000000000000000!!!!"+AY)>-1;}function AT(AX,AY){return !!(AX&&AX.length&&AX[0].key&&!AQ(AX[0].key,AY));}var AS=AT(AW,AU),AR;if(AS){AR=L.clone(AV);AR.forEach(function(AY,AX){if(!AT(AY,AX+1)){AR[AX]=null;return ;}AR[AX]=AY=g.filter(AY,function(AZ){return !AQ(AZ.key,AU);});(AY||[]).forEach(function(Aa){var AZ=Aa.key;if(AZ){Aa.key=AZ.replace(/;/g,"\\;").replace(/\u001e/g,";");if(AM){AZ=Aa.key;if(AZ.indexOf("!!1")>=0){Aa.key=AZ.replace(/!!1/g,"!!2");}else{Aa.key=AZ.replace(/!!2/g,"!!1");}}}});});if(AM){AR=AR.reverse();}}return AS?AR:[];}function AL(AS,AT){if(!AT||AT.length<AS){return false;}var AQ=AT[AS-1];if(!AQ||AQ.length!==1){return false;}var AU="!5",AR=AQ[0].key;return AR&&AR.slice(-2)===AU;}function AN(AT,AQ,AS,AR,AU){return{act:"moveSubTotal",nodeKey:AT,sorts:AQ,subTotalsPos:AS,stt:AU||-1,axis:AR};}function AP(){var AS=this.data,AR=AS&&AS.gts,AW=AR&&AR.rowSubPos||N,AQ=AR&&AR.colSubPos||N,AV=[AW,AQ];if((!AG||AG===J)&&AW===N){var AU=AR&&AR.row||[],AT=false;g.forEach(AU,function(AX){if(AX.ast&&AX.ast.length>0){AT=true;return false;}});if(!AT||AS&&AS.gsi&&AS.gsi.hidesb){AV[J-1]=X;AK=AF(J,AO);return AN(AJ,AK,AV,J);}}return null;}if(!AI){return AP.call(this);}else{AK=AF(AG,AO);return AN(AJ,AK,AI,AG,AL(AG,AK)&&AH.hst?AH.hst:-1);}return null;},getSortGridAction:function z(AI,AG,AH,AF){return{sortKey:AG,subTotalsPos:AI,axis:AH,isAsc:AF};},getColumnResizeAction:function S(AI,AF,AG,AH,AJ){return{act:"changeXtabColumnWidth",unitId:AI,unitType:AF,width:AG||0,depth:AH||1,ec:AJ};},getNormalizedFormElementId:function AD(AG,AF){return Y(AG,null,AF);},compareNormalizedElementsId:function t(AG,AF){if(AG===AF){return true;}else{if(this.docModel.populateAttributeIdLinkInfo){this.docModel.populateAttributeIdLinkInfo();}if(a.isAttributeIdsLinked(a.getAttributeId(AG),a.getAttributeId(AF),this.docModel.als&&this.docModel.als.idLinks||{})){return a.getElementValue(AG)===a.getElementValue(AF);}}return false;},compareElementsId:function Z(AJ,AI){if(!this.docModel.als){return this.compareElementsIdInSingleGrid(AJ,AI);}var AH=a.getIdPresentation(AJ),AG=a.getIdPresentation(AI),AF=Y(AJ,AH),AK=Y(AI,AG);return this.compareNormalizedElementsId(AF,AK);},compareElementsIdInSingleGrid:function f(AI,AH){var AG=a.getIdPresentation(AI),AF=a.getIdPresentation(AH);if(AG!==AF||AG==="oldLong"||AG==="terseLong"){return Y(AI,AG)===Y(AH,AF);}return AI===AH;},getLinkedAttributes:function n(AF){var AG;if(this.docModel.populateAttributeIdLinkInfo){this.docModel.populateAttributeIdLinkInfo();}AG=this.docModel.als&&this.docModel.als.idLinks||{};return AG[AF];},getCellDataUnion:function c(AH){var AI=this,AG=AH.hasOwnProperty("mix"),AJ=[],AK,AF=function AF(AM){var AL=AI.getCellTitleInfo(AM),AO=AL.title,AN=AO&&AO.id;if(AN){AK={};if(AM.stt){AK.isSubtotal=true;}AJ.push(L.copy(AK,{tid:AN,eid:AM._e&&AM._e.id,v:AM.v||AM._e&&AM._e.n}));}};if(AH){if(!AG){AF(AH);}else{g.forEach([AH._lp,AH._tp],function(AL){var AM=AL;while(AM&&AM!==AM._p){AF(AM);AM=AM._p;}});}}return AJ;},getObjectInfo:function F(AF){var AG;g.forEach((this.data.gsi.cols||[]).concat(this.data.gsi.rows||[]),function(AH){if(AH.did===AF){AG=AH;}});return AG;},supportsViewFilterActions:function P(AF){if(this.data&&this.data.gsi){var AG=this.getObjectInfo(AF);return AG&&!AG.de&&(AG.t!==1)&&(AG.t!==47||AG.st===12033);}return false;},getSelectorControlMapInfo:function AC(){var AG=[],AI=this.data.gsi,AH=[],AF;if(this.scm){L.forEach(AI,function(AJ){if(AJ instanceof Array){AH=AH.concat(AJ);}});L.forEach(this.scm,function(AK,AJ){AF=g.find(AH,"did",AJ);if(AF!==-1){AG.push({did:AJ,n:AH[AF].n,sc:AK});}});}return AG;},getShowDefinedSubtotalsAction:function(){return{act:"showDefinedSubtotals"};}});}());(function(){mstrmojo.requiresCls("mstrmojo.Widget","mstrmojo.ui._HasScroller","mstrmojo.css","mstrmojo.DI.DIHelpers");var F=mstrmojo.css,H=mstrmojo.string,A=mstrmojo.desc(14058,"Show Details"),E=mstrmojo.desc(14059,"Hide Details"),B=mstrmojo.DI.DIHelpers,D=mstrmojo.desc(14060,"We are sorry for the inconvenience. Please {contact} your administrator for help.").replace("{",'<span class="dyn-link">').replace("}","</span>");mstrmojo.ui.editors.ErrorDialogContent=mstrmojo.declare(mstrmojo.Widget,[mstrmojo.ui._HasScroller],{scriptClass:"mstrmojo.ui.editors.ErrorDialogContent",markupString:'<div class="mstrmojo-error-content {@cssClass}" mstrAttach:click><div class="scroll-container"><div>{@shortDesc}</div><div class="contact">'+D+'</div><div class="toggle-details-link" >'+A+'</div><div class="error-details">{@longDesc}</div></div></div>',markupSlots:{scrollNode:function(){return this.domNode.firstChild;},contactNode:function(){return this.domNode.firstChild.children[1].getElementsByClassName("dyn-link")[0];},toggleDetailsNode:function(){return this.domNode.firstChild.children[2];},errorDetailsNode:function(){return this.domNode.firstChild.children[3];}},markupMethods:{onshowDetailsChange:function(){var K=this.showDetails;this.toggleDetailsNode.innerHTML=K?E:A;F.toggleClass(this.domNode,"show-details",K);this.updateScrollbars();}},cssClass:undefined,shortDesc:undefined,longDesc:undefined,showDetails:false,showToggle:true,enableContactStr:true,allowHTML:false,init:function I(K){this._super(K);this.shortDesc=this.shortDesc||mstrmojo.desc(14061,"An error has occurred");},onclick:function J(K){var M=K.getTarget(),L,N=this.longDesc;if(M===this.contactNode){L="mailto:?subject="+encodeURI("Issue: "+this.shortDesc)+(N?("&body="+encodeURI("Detail:\r\n"+N)):"");mstrApp.openPage(L,"_self");}else{if(M===this.toggleDetailsNode){this.set("showDetails",!this.showDetails);this.parent.raiseEvent({name:"EditorResized"});this.parent.positionDialog();}}},setupScrollNodes:function C(){this.scrollNode=this.scrollNode;},preBuildRendering:function G(){this._super&&this._super();if(!this.allowHTML){this.longDesc=H.encodeHtmlString(H.decodeHtmlString(this.longDesc,true),true);}},postBuildRendering:function(){var K=this.domNode.firstChild.children[1];this._super&&this._super();!this.showToggle&&F.addClass(this.toggleDetailsNode,"hide");!this.enableContactStr&&F.addClass(K,"invisible");}});})();(function(){mstrmojo.requiresCls("mstrmojo.NumStepperContentProvider","mstrmojo.num","mstrmojo.array");var A=mstrmojo.num,E=mstrmojo.array;var C="?";function B(H,G){var J=G?H.max:H.min,F=G?H.min:H.max,I=H.getValGroup(G?1:-1);return(J===null||(G?(I.every(function(K){return K<=J;})):(I.every(function(K){return K>=J;})))||(F!==null&&H.canLoop));}function D(I,H){var G=I.min,F=I.max,J=I.getValGroup(H?1:-1)||[];if((H&&F!==null&&J.some(function(K){return K>F;})||(!H&&G!==null&&J.some(function(K){return K<G;})))){if(I.canLoop){J.forEach(function(L,K){L=((L-G)%(F-G+1))+G;L=(L>=G)?L:L+(F-G+1);J[K]=L;});}else{return ;}}I.item[I.valField]=I.curValGroup=J;I.onTraverse();}mstrmojo.NumGroupStepperContentProvider=mstrmojo.declare(mstrmojo.NumStepperContentProvider,null,{scriptClass:"mstrmojo.NumGroupStepperContentProvider",curValGroup:null,init:function(F){this._super(F);},_initCurrent:function(){var H=this.item,F=this.curValGroup=H[this.valField];if(F===null||F===undefined){var G=this.min;this.curValGroup=G!==null?[G]:0;}this.curValGroup=E.ensureArray(this.curValGroup);},next:function(){D(this,true);},prev:function(){D(this,false);},hasPrev:function(){return B(this,false);},hasNext:function(){return B(this,true);},getValGroup:function(I){var F=this.curValGroup,G=this.interval,H=[];(F||[]).forEach(function(K,J){H[J]=F[J]+(G*(I||0));});return H;},getVal:function(){var F=null;(this.curValGroup||[]).forEach(function(G){if(F===null){F=G;}else{if(F!==C&&G!==F){F=C;}}});return F;},setVal:function(H){var I=this.min,G=this.max,F=this.curValGroup;if(typeof H!=="number"||isNaN(H)||A.inNumericRange(H,I,G)!==0){return ;}(F||[]).forEach(function(K,J){F[J]=H;});this.onTraverse();},_set_curValGroup:function(J,I){var H=this.min,G=this.max,F=this.getValGroup();if(I.some(function(K){return typeof K!=="number";})||I.some(function(K){return isNaN(K);})||I.every(function(L,K){return L===F[K];})||I.every(function(K){return A.inNumericRange(K,H,G)!==0;})){return false;}this.item[this.valField]=this.curValGroup=I;return true;}});}());(function(){mstrmojo.requiresCls("mstrmojo.ListMapper");mstrmojo.ListMapperTable=mstrmojo.provide("mstrmojo.ListMapperTable",mstrmojo.hash.copy({markupPrefix:'<table class="mstrmojo-itemwrap-table">',markupSuffix:"</table>",itemWrapperPrefix:function(E){return'<tbody class="'+this.getWrapperCss(E)+'">';},itemWrapperPrefill:"<tr><td>&nbsp;</td></tr>",itemWrapperSuffix:"</tbody>",wrapperNodes:function D(E){return this.wrapperParentNode(E).tBodies;},wrapperParentNode:function C(E){return E.getElementsByTagName("table")[0];},createWrapperNode:function B(E){var F=E.ownerDocument,G=F.createElement("tbody");return G;},findIndex:function A(G,J,I){if(J&&I){var F=G.domNode,E=this.wrapperParentNode(J),H=I.parentNode;while(H){if(H===E){return mstrmojo.array.findBin(this.wrapperNodes(J),I,"offsetTop",G.items&&G.items.length);}else{if(H===F){break;}}I=H;H=I.parentNode;}}return -1;}},mstrmojo.hash.copy(mstrmojo.ListMapper)));mstrmojo.requiresCls("mstrmojo.WidgetListMapper");mstrmojo.WidgetListMapperTable=mstrmojo.provide("mstrmojo.WidgetListMapperTable",mstrmojo.mixin(mstrmojo._hasWidgetListMapper,mstrmojo.hash.copy(mstrmojo.ListMapperTable)));})();(function(){mstrmojo.requiresCls("mstrmojo.hash","mstrmojo.Container","mstrmojo._FormatDefinition","mstrmojo.TristateCheckBox","mstrmojo.FieldSet","mstrmojo.Table");var A=mstrmojo.hash,B=mstrmojo._FormatDefinition;mstrmojo.AlignmentFormatter=mstrmojo.declare(mstrmojo.Container,null,{scriptClass:"mstrmojo.AlignmentFormatter",cssClass:"mstrmojo-AlignmentFormatter",markupString:'<div id={@id} class="{@cssClass}" style="{@cssText}"></div>',markupSlots:{containerNode:function(){return this.domNode;}},markupMethods:{onvisibleChange:function(){this.domNode.style.display=this.visible?"block":"none";}},postCreate:function(){this.onmodelChange();},onmodelChange:function(){if(this.model&&!this.model.scriptClass){A.make(this.model,mstrmojo.Obj);}},children:[{scriptClass:"mstrmojo.FieldSet",alias:"textAlignment",cssClass:"mstrmojo-FormatEditor-textAlignment",legend:mstrmojo.desc(2065),children:[{scriptClass:"mstrmojo.Table",rows:2,cols:2,children:[{scriptClass:"mstrmojo.Label",text:mstrmojo.desc(3691),slot:"0,0"},{scriptClass:"mstrmojo.Pulldown",itemIdField:"v",items:B.Horizontal,bindings:{m:"this.parent.parent.parent.model",value:"this.m.Horizontal"},onvalueChange:function(){if(this.m&&this.value!=null){this.m.Horizontal=this.value;}},slot:"0,1"},{scriptClass:"mstrmojo.Label",text:mstrmojo.desc(3692),slot:"1,0"},{scriptClass:"mstrmojo.Pulldown",itemIdField:"v",items:B.Vertical,bindings:{m:"this.parent.parent.parent.model",value:"this.m.Vertical"},onvalueChange:function(){if(this.m&&this.value!=null){this.m.Vertical=this.value;}},slot:"1,1"}]}]},{scriptClass:"mstrmojo.FieldSet",alias:"textControl",cssClass:"mstrmojo-FormatEditor-textControl",legend:mstrmojo.desc(2884),children:[{alias:"TextWrap",scriptClass:"mstrmojo.TristateCheckBox",text:mstrmojo.desc(2070),checked:false,grayed:false,pr:"TextWrap",bindings:{m:"this.parent.parent.model",checked:function(){return this.m[this.pr]==-1;},grayed:function(){return(typeof this.m[this.pr]=="undefined")||this.m[this.pr]=="pru";}},oncheckedChange:function(C){if(this.m){this.m.set(this.pr,this.checked?-1:0);}}},{scriptClass:"mstrmojo.HBox",children:[{scriptClass:"mstrmojo.Label",text:mstrmojo.desc(5159)},{scriptClass:"mstrmojo.Pulldown",itemIdField:"v",items:B.TextDirection,bindings:{m:"this.parent.parent.parent.model",value:"this.m.TextDirection"},onvalueChange:function(){if(this.m&&this.value!=null){this.m.TextDirection=this.value;}},slot:"1,1"}]}]}]});})();(function(){mstrmojo.requiresCls("mstrmojo.TristateCheckBox","mstrmojo._IsInputControl");mstrmojo.CheckBoxDIC=mstrmojo.declare(mstrmojo.TristateCheckBox,[mstrmojo._IsInputControl],{scriptClass:"mstrmojo.CheckBoxDIC",markupString:'<div id="{@id}" class="mstrmojo-Label {@cssClass}" style="{@cssText}" tabindex="1" mstrAttach:click,keydown></div>',cssText:"width: 0; margin:0 auto; max-height: 18px; cursor: pointer;",onclick:function(){if(this.grayed){this.set("grayed",!this.grayed);this.set("checked",true);}else{this.set("checked",!this.checked);}},oncheckedChange:function(A){this.set("value",this[this.checked?"onValue":"offValue"]);},preBuildRendering:function(){this._super();var A=this.dic.vls;this.offValue=A[0].v;this.onValue=A[1].v;this.grayed=(this.onValue!==this.value)&&(this.offValue!==this.value);this.checked=(this.onValue===this.value);},postBuildRendering:function(){var B=this.domNode,D=B.style,C=this.openerStyle,A;this._super();D.height=C.ih+"px";},onkeydown:function(B){var A=B.hWin,C=B.e||A.event;if(C.keyCode===mstrmojo.Enum_Keys.SPACE){mstrmojo.dom.preventDefault(A,C);this.onclick();}},focus:function(){this.domNode.focus();}});})();(function(){mstrmojo.requiresCls("mstrmojo.WidgetListBase","mstrmojo.WidgetListMapper","mstrmojo.WidgetListBuilder");mstrmojo.WidgetList=mstrmojo.declare(mstrmojo.WidgetListBase,null,{scriptClass:"mstrmojo.WidgetList",renderOnScroll:true,listMapper:mstrmojo.WidgetListMapper,listBuilder:mstrmojo.WidgetListBuilder,itemConfig:null,itemFunction:null,initBindings:function(){this._super();var E=this.ctxtBuilder,D=E&&E.itemWidgets;if(D){for(var C=0,A=D.length;C<A;C++){var B=D[C];if(B&&B.initBindings){B.initBindings();}}}}});})();(function(){mstrmojo.requiresCls("mstrmojo.List");var B=mstrmojo.dom,E=mstrmojo.array,C=mstrmojo.css,G=",";function F(){var K,I,J=this.items,L=[];for(K=0,I=J.length;K<I;K++){L.push(J[K].v);}this.set("value",L.join(G));}function H(){var I=this.itemsContainerNode;if(I){E.forEach(I.children,function(J){if(J&&J.firstChild){C.removeClass(J.firstChild,"selected");}});}}mstrmojo.RankDIC=mstrmojo.declare(mstrmojo.List,[mstrmojo._IsInputControl],{scriptClass:"mstrmojo.RankDIC",cssClass:"mstrmojo-RankDIC",draggable:true,dropZone:true,allowCopy:false,multiSelect:false,renderOnScroll:false,itemDisplayField:"n",itemIdField:"v",containerResizable:false,itemMarkupFunction:function(M,J,K){var I=J===0,O=J===K.items.length-1,L='<div class="moveup '+(!I?"":"disabled")+'" or="1" idx="'+J+'">&nbsp;</div>',N='<div class="movedown '+(!O?"":"disabled")+'" or="-1" idx="'+J+'">&nbsp;</div>';return'<div class="mstrmojo-RankOption'+(I?" first":(O?" last":""))+'"><div class="index" contentEditable="true" onfocus="return mstrmojo.all[\''+K.id+"'].selectText(this);\" onblur=\"return mstrmojo.all['"+K.id+"'].indexChanged(this, "+J+');" onkeyup="return mstrmojo.all[\''+K.id+"'].keyPressed(event, this, "+J+');">'+J+'</div><div class="text">'+M.n+"</div>"+N+L+"</div>";},allowDrop:function(K){var J=K&&K.src,I=J&&J.widget;return(I===this);},ondrop:function(L){var J=this.domNode.parentNode,K=J.style,I=false;if(!K.height){K.height=J.offsetHeight+"px";I=true;}this._super(L);H.call(this);F.call(this);if(I){K.height="";}},selectText:function D(K){var I=document.createRange();I.selectNodeContents(K);var J=window.getSelection();J.removeAllRanges();J.addRange(I);},indexChanged:function(M,J){var L=parseInt(M[M.innerText!==undefined?"innerText":"textContent"],10),K=parseInt(J,10),I=this.items.length;if(isNaN(L)){M[M.innerText!==undefined?"innerText":"textContent"]=J;return false;}L=Math.min(Math.max(0,L),I);if(L!==K){this.move([K],L);F.call(this);return true;}else{return true;}},keyPressed:function A(J,K,I){if(J.keyCode===mstrmojo.Enum_Keys.ESCAPE){K[K.innerText!==undefined?"innerText":"textContent"]=I;if(K.blur){K.blur();}}else{if(J.keyCode===mstrmojo.Enum_Keys.ENTER){this.indexChanged(K,I);}}return true;},onmouseup:function(L){var M=B.eventTarget(L.hWin,L.e),K=parseInt(M.getAttribute("or"),10),J=M&&parseInt(M.getAttribute("idx"),10),I=this.items.length;if(K===1&&J!==0){this.move([J],0);F.call(this);return true;}else{if(K===-1&&J!==(I-1)){this.move([J],I);F.call(this);return true;}else{mstrmojo.dom.preventDefault(window,L.e);return true;}}},init:function(I){this._super(I);this.items=this.getItems();}});}());(function(){mstrmojo.requiresCls("mstrmojo.array","mstrmojo.hash","mstrmojo.css","mstrmojo.string","mstrmojo.dom","mstrmojo.Popup","mstrmojo.List","mstrmojo.DropDownButton");var B=mstrmojo.dom;mstrmojo.Pulldown=mstrmojo.declare(mstrmojo.DropDownButton,null,{scriptClass:"mstrmojo.Pulldown",cssClass:"mstrmojo-Pulldown",items:null,itemIdField:"dssid",itemField:"n",itemCSS:"css",itemTitleField:null,defaultSelection:0,defaultText:null,title:"",value:null,popupToBody:false,popupCssClass:"",popupZIndex:null,fixWidth:false,fixHeight:false,allowHTML:false,_set_items:function(H,F){var G=this.items;this.items=F||[];return G!==this.items;},markupMethods:mstrmojo.hash.copy({onvalueChange:function(){var G=this.value,F=this.selectedIndex,I=this.items||[],J,H;if(F===undefined||(G!==null&&(F===-1||(F!==-1&&I[F]&&I[F][this.itemIdField]!==G)))){F=mstrmojo.array.find(I,this.itemIdField,G);F=(F>-1)?F:this.defaultSelection;this.selectedIndex=F;}else{if(G===null){this.selectedIndex=this.defaultSelection;}}this.selectedItem=J=I[this.selectedIndex];if(J){H=J[this.itemField];}else{H=this.defaultText||"";}this.set("text",H);}},mstrmojo.hash.copy(mstrmojo.DropDownButton.prototype.markupMethods)),prevalueChange:function D(){var G=this.value,F=-1;if(G!==null){F=mstrmojo.array.find(this.items,this.itemIdField,G);}if(F>-1){this.selectedItem=this.items[F];this.selectedIndex=F;}},togglePopup:function E(){if(this.popupToBody){var I=B.position(this.popupNode,true),H=this.popupRef,F={left:Math.round(I.x)+"px",top:Math.round(I.y)+"px"};if(!H.hasRendered){delete H.slot;F.placeholder=document.body.appendChild(document.createElement("div"));}this.popupOpenConfig=this.popupOpenConfig||{};mstrmojo.hash.copy(F,this.popupOpenConfig);}else{this.popupRef.slot="popupNode";}if(this._super){this._super();}var G=this.popupRef.domNode;if(G){if(this.fixWidth){G.style.width=(this.domNode.offsetWidth-2)+"px";}else{G.style.minWidth=(this.domNode.offsetWidth-2)+"px";}}},premousedown:function A(F){if(B.getButton(F.hWin,F.e)===B.MOUSE_BUTTON.LEFT){this.togglePopup();}},unrender:function C(F){var G=this.popupRef;if(this.popupToBody&&G.hasRendered){G.unrender(false);}if(this._super){this._super(F);}},itemName:function(H,F,G){return this.allowHTML?H[G.itemField]:mstrmojo.string.encodeHtmlString(H[G.itemField]);},popupRef:{scriptClass:"mstrmojo.Popup",slot:"popupNode",cssClass:"mstrmojo-Pulldown-Popup",autoCloses:false,modal:false,autoClose:true,locksHover:true,adjustSize:function(){var G=this.opener,F=this.domNode;if(G&&G.fixWidth){mstrmojo.css.addClass(F,["fix-width"]);}if(G&&G.fixHeight){mstrmojo.css.addClass(F,["fix-height"]);}},onOpen:function(){var H=this.opener,G=H&&H.popupZIndex,I=(H&&H.popupCssClass)||"",F=this.domNode;if(G){F.style.zIndex=G;}if(I){mstrmojo.css.addClass(F,[I]);}this.adjustSize();},children:[{scriptClass:"mstrmojo.List",alias:"list",itemMarkupFunction:function(I,F,G){var H=I[G.itemCSS]||G.parent.opener.item2textCss&&G.parent.opener.item2textCss(I)||"",J=G.parent.opener.itemName;return'<div class="mstrmojo-Pulldown-listItem"><div class="mstrmojo-text '+H+'" title="'+I[G.itemTitleField||G.itemField]+'">'+(J(I,F,G)||"&nbsp;")+"</div></div>";},renderOnScroll:false,bindings:{itemIdField:"this.parent.opener.itemIdField",itemField:"this.parent.opener.itemField",itemCSS:"this.parent.opener.itemCSS",itemTitleField:"this.parent.opener.itemTitleField",items:"this.parent.opener.items",selectionPolicy:"this.parent.opener.selectionPolicy",selectedIndex:"this.parent.opener.selectedIndex"},onmousedown:function(){this.parent.close();},onchange:function(){var H=this.parent,I=H.visible,F=H.opener,G=this.selectedItem;if(!F||!G||!I){return ;}F.set("value",G[this.itemIdField]);}}]}});}());(function(){mstrmojo.requiresCls("mstrmojo.ListSelector","mstrmojo.List","mstrmojo.string");mstrmojo.OBList=mstrmojo.declare(mstrmojo.List,null,{scriptClass:"mstrmojo.OBList",cssClass:"mstrmojo-OBList",itemClass:"mstrmojo-OBListItem",iconClass:"mstrmojo-OBListItemIcon",textClass:"mstrmojo-OBListItemText",iconCssPrefx:"mstrmojo-OBIcon_",itemMarkupFunction:function(C,A,B){return'<div class="'+B.itemClass+(C[B.itemType]?" t_"+C[B.itemType]:"")+(C[B.itemSubType]?" st_"+C[B.itemSubType]:"")+(C[this.itemISC]?" isc":"")+(C[B.itemViewMedia]?" vm_"+C[B.itemViewMedia]:"")+'"><table cellspacing="0" cellpadding="0"><tbody><tr><td>'+B.getIcon(C)+'</td><td><div class="'+B.textClass+'" title="'+B.getTooltip(C)+'">'+mstrmojo.string.htmlAngles(C.n)+"</div></td></tr></tbody></table></div>";},getIcon:function(F){var E=F[this.itemType],D=F[this.itemSubType],B=" t"+E,C=(parseInt(E,10)===1||parseInt(E,10)===3||parseInt(D,10)===14082)?" st"+D:"",G=F[this.itemISC]?'class="mstrmojo-ListIcon isc"':"",A=(F[this.itemViewMedia]===2048||F[this.itemViewMedia]===8192)?" hvi":"";return'<span class="mstrmojo-ListIcon '+B+C+A+'"><span '+G+"></span></span>";},getTooltip:function(C){var D="",F=C.anc&&C.anc.items,A=F&&F.length,B;if(A>0){for(B=0;B<A-1;B++){D+=F[B].n+" > ";}D+=F[A-1].n;}var E=C.desc,G=128;if(E){D+="\r\n\r\n"+mstrmojo.string.encodeHtmlString(E.substring(0,G))+(E.length>G?"...":"");}return D;},listSelector:mstrmojo.ListSelector,selectionPolicy:"reselect",itemType:"t",itemSubType:"st",itemISC:"isc",itemViewMedia:"dvm",useDblSelect:false});}());(function(){mstrmojo.requiresCls("mstrmojo.Label","mstrmojo.HTMLButton","mstrmojo.CheckBox","mstrmojo.HBox","mstrmojo.VBox","mstrmojo.Box","mstrmojo.Popup","mstrmojo.List","mstrmojo.DropDownButton");var A=function(E){E.attachEventListener("pfChange",E.id,"positionChange");E.boxes.left.flat.attachEventListener("checkedChange",E.id,"flatChange");var D={pf:"this.boxes.left.pf.value",flat:"!this.boxes.left.flat.checked",agg:function(){return this.boxes.left.agg.checked?"2":"1";},rfi:"this.boxes.left.rfi.value"};E.set("bindings",D);},C=function(E){var D=E.boxes.left;D.pf.set("value",E.pf);D.flat.set("checked",!E.flat);D.agg.set("checked",E.agg==2);D.rfi.set("value",E.rfi);};function B(M,I,E,F,L,D,H,K){var J={target:I,onEnd:function(){if(D){D();}},props:{}};J.props[E]={ease:H||mstrmojo.ease.sin,start:parseInt(F,10),stop:parseInt(L,10),suffix:"px"};J=mstrmojo.hash.copy(K,J);var G=new mstrmojo.fx.AnimateProp(J);G.play();}mstrmojo.CGEOptions=mstrmojo.declare(mstrmojo.VBox,null,{scriptClass:"mstrmojo.CGEOptions",children:[{scriptClass:"mstrmojo.HBox",alias:"boxes",cellCssClass:"cell",children:[{alias:"left",scriptClass:"mstrmojo.Box",cssClass:"mstrmojo-CGEOptions-options",children:[{scriptClass:"mstrmojo.ImageCheckBox",alias:"flat",cssClass:"row",label:mstrmojo.desc(7954,"Enable hierarchical display")},{scriptClass:"mstrmojo.ImageCheckBox",alias:"agg",cssClass:"row",label:mstrmojo.desc(7955,"Enable subtotals display")},{scriptClass:"mstrmojo.Label",text:mstrmojo.desc(7956,"Position parent header:"),cssClass:"row"},{scriptClass:"mstrmojo.Pulldown",itemIdField:"v",alias:"pf",cssClass:"CGE-parent-header mstrmojo-FormatEditor-DropDownButton",items:[{n:mstrmojo.desc(7957,"Above child items"),v:true},{n:mstrmojo.desc(7958,"Below child items"),v:false}],bindings:{value:"this.parent.parent.parent.pf"}},{scriptClass:"mstrmojo.Label",text:mstrmojo.desc(7959,"Interaction with report filter:"),cssClass:"row"},{scriptClass:"mstrmojo.Pulldown",itemIdField:"v",alias:"rfi",cssClass:"CGE-report-filter mstrmojo-FormatEditor-DropDownButton",items:[{n:mstrmojo.desc(7960,"Default (Database Instance level)"),v:-1},{n:mstrmojo.desc(7961,"No interaction"),v:0},{n:mstrmojo.desc(2398,"Apply"),v:1},{n:mstrmojo.desc(7962,"Apply but ignore related elements"),v:2}],bindings:{value:function(){var D=this.parent.parent.parent.rfi,D=D==undefined?"-1":D;return D;}}}]},{scriptClass:"mstrmojo.Box",alias:"preview",cssClass:"mstrmojo-CGEOptions-preview",children:[{scriptClass:"mstrmojo.Label",cssClass:"title",text:mstrmojo.desc(3389,"Preview")},{scriptClass:"mstrmojo.Label",text:mstrmojo.desc(7963,"Element Header 1"),alias:"g1t"},{scriptClass:"mstrmojo.Box",alias:"e1",cssClass:"e",children:[{scriptClass:"mstrmojo.Label",text:mstrmojo.desc(7965,"Item 1-1")},{scriptClass:"mstrmojo.Label",text:mstrmojo.desc(7966,"Item 1-2")}],onflatChange:function(){mstrmojo.css.toggleClass(this.domNode,["flat"],this.flat);}},{scriptClass:"mstrmojo.Label",text:mstrmojo.desc(7963,"Element Header 1"),cssText:"margin-bottom:10px;",alias:"g1b"},{scriptClass:"mstrmojo.Label",text:mstrmojo.desc(7964,"Element Header 2"),cssText:"margin-top:10px;",alias:"g2t"},{scriptClass:"mstrmojo.Box",alias:"e2",cssClass:"e",children:[{scriptClass:"mstrmojo.Label",text:mstrmojo.desc(7967,"Item 2-1")},{scriptClass:"mstrmojo.Label",text:mstrmojo.desc(7968,"Item 2-2")}],onflatChange:function(){mstrmojo.css.toggleClass(this.domNode,["flat"],this.flat);}},{scriptClass:"mstrmojo.Label",text:mstrmojo.desc(7964,"Element Header 2"),alias:"g2b"}]}]},{scriptClass:"mstrmojo.HBox",alias:"btns",cssClass:"mstrmojo-Editor-buttonBar",cssText:"margin-top: 10px;",children:[{scriptClass:"mstrmojo.HTMLButton",alias:"ok",text:mstrmojo.desc(2397,"OK"),cssClass:"mstrmojo-Editor-button",onclick:function(){this.parent.parent.save();}},{scriptClass:"mstrmojo.HTMLButton",alias:"cancel",text:mstrmojo.desc(2399,"Cancel"),cssClass:"mstrmojo-Editor-button",onclick:function(){this.parent.parent.cancel();}}]}],pf:true,flat:false,agg:"1",rfi:"-1",postBuildRendering:function(){if(this._super){this._super();}A(this);this.preview();},open:function(E,F){var D=E.cgp;this.pp=D;this.set("pf",D.pf);this.set("flat",D.flat);this.set("agg",D.agg);this.set("rfi",D.rfi);C(this);for(var G in F){this[G]=F[G];}this.set("visible",true);if(!this.hasRendered){this.render();}},cancel:function(){var D=this.closeCB;if(D){D[0][D[1]]();}},save:function(){this.pp.pf=this.pf;this.pp.flat=this.flat;this.pp.agg=this.agg;this.pp.rfi=this.rfi;this.cancel();},positionChange:function(D){this.preview(D.value,null);},flatChange:function(D){this.preview(null,!D.value);},preview:function(G,E){G=!!G?String(G)==="true":!(String(this.pf)==="false");E=(E==null?this.flat:E);var F=!!G,D=this.boxes.preview;D.g1t.set("visible",F);D.g1b.set("visible",!F);D.g2t.set("visible",F);D.g2b.set("visible",!F);D.e1.set("flat",E);D.e2.set("flat",E);}});})();(function(){mstrmojo.requiresCls("mstrmojo.List","mstrmojo._IsDial");mstrmojo.Dial=mstrmojo.declare(mstrmojo.List,[mstrmojo._IsDial],{scriptClass:"mstrmojo.Dial",markupMethods:{onvisibleChange:function(){this.domNode.style.display=this.visible?"block":"none";},onhasSelectionChange:function(){mstrmojo.css.toggleClass(this.domNode,["hasSelection"],!!this.hasSelection);},hideIfEmpty:function(){this.onadd();}},hideIfEmpty:false,onadd:function(A){if(this._super){this._super(A);}if(this.hideIfEmpty){if(this.domNode){this.domNode.style.display=(!this.items||this.items.length==0)?"none":"block";}}}});})();(function(){mstrmojo.requiresCls("mstrmojo.ListHoriz","mstrmojo.fx");mstrmojo.FishEye=mstrmojo.declare(mstrmojo.ListHoriz,null,{scriptClass:"mstrmojo.FishEye",width:16,size:10,step:16,speed:2,cssClass:"mstrmojo-FishEye",cssClassItem:"mstrmojo-dot",itemMarkupFunction:function(B,A,C){return'<div class="mstrmojo-fisheye-item '+C.cssClassItem+'" title="'+B.n+'" idx="'+A+'" did="'+B.did+'">&nbsp;</div>';},onchange:function(){this.scroll2();this.parent.set("selectedIndex",this.selectedIndex);},as:new mstrmojo.fx.AnimateProp(),onitemsChange:function(){if(this._super){this._super();}this.last=this.items.length-1;this.first=Math.max(0,this.last-this.size);if(this.items.length>this.size){this.scroll("left",this.width);}},scroll2:function(){var A=this.selectedIndex-this.last;if(this.selectedIndex==this.first&&this.first>0){this.scroll("right",this.width);}else{if(this.selectedIndex==this.last&&this.last<this.items.length-1){this.scroll("left",this.width);}else{if(this.selectedIndex>this.last){A=this.selectedIndex-this.last;this.scroll("left",this.width*A,A);this.last=Math.min(this.items.length-1,this.last+A);}else{if(this.selectedIndex<this.first){A=this.first-this.selectedIndex;this.scroll("right",this.width*A,A);this.first=Math.max(0,this.first-A);}}}}},scroll:function(C,F,E){var B=this.itemsContainerNode,I=B&&B.style;var D=this.as,H=parseInt(mstrmojo.css.getStyleValue(B,{left:"right",right:"left"}[C]),10),H=isNaN(H)?0:H,A=parseInt(I.left,10)||0,G=A+(C=="left"?-1:1)*(F||(Math.min(this.step,(-1)*H)));D.target=B;D.props={left:{start:A,stop:G,duration:100,interval:10,suffix:"px"}};D.play();E=E===undefined?1:E;this.first+=(C=="left"?1:-1)*E;this.last=this.first+this.size-1;this.parent.set("scrollable",this.last<this.items.length-1);this.parent.set("rightScrollable",this.first>0);return G;},srcId:null,postBuildRendering:function(){if(this._super){this._super();}this.hasRendered=!!this.domNode;var E=this.itemsContainerNode,A=E&&E.firstChild,B=A&&A.rows&&A.rows[0],D=B&&B.cells&&B.cells[0];this.first=0;this.last=this.size-1;var C=this.srcId;if(C&&mstrmojo.all[C]&&mstrmojo.all[C].attachEventListener){mstrmojo.all[C].attachEventListener("change",this.id,function(F){if(this.items[this.items.length-1]!=F.src.selectedItem){this.items.add([mstrmojo.hash.copy(F.src.selectedItem)]);this.set("selectedIndex",this.items.length-1);}if(this.items.length>this.size){this.set("rightScrollable",this.items.length>this.size);this.scroll("left",this.width*(this.selectedIndex-this.last),(this.selectedIndex-this.last));}});}this.itemsContainerNode.style.left=Math.min(0,(this.size-this.items.length+1))*this.width+"px";}});})();(function(){mstrmojo.requiresCls("mstrmojo.DocTextfield","mstrmojo.ui._HasScroller");mstrmojo.vi.ui.ScrollableDocTextfield=mstrmojo.declare(mstrmojo.DocTextfield,[mstrmojo.ui._HasScroller],{scriptClass:"mstrmojo.vi.ui.ScrollableDocTextfield",setupScrollNodes:function A(){this.scrollNode=this.valueNode;}});}());(function(){mstrmojo.requiresCls("mstrmojo.dom","mstrmojo.css","mstrmojo.url","mstrmojo.DocTextfield");var I=mstrmojo.dom,K=mstrmojo.css,L=1,Q=2,A=3,N=4,P=5,E=6,B=1,D=["","CaptionOnly","IconOnly","IconLeft","IconRight","IconTop","Custom"];var M=[];M[L]=M[Q]=M[E]={minsp:0,mincs:0};M[A]=M[N]={minsp:10,mincs:5};M[P]={minsp:4,mincs:5};function F(W,S,Y,R,U){var Z=I.position(W),V=I.position(W.parentElement),X=W.style;R=R||{};R={t:R.t||0,r:R.r||0,b:R.b||0,l:R.l||0};R.h=V.h-R.t-R.b;R.w=V.w-R.l-R.r;if(U){if(Z.h>R.h){X.height=R.h+"px";}if(Z.w>R.w){X.width=R.w+"px";}Z=I.position(W);}if(S){X.top=((R.h-Z.h)/2+R.t)+"px";}if(Y){X.left=((R.w-Z.w)/2+R.l)+"px";}}function J(W,X,U){var S=document.createElement("img"),R=S.style;W.appendChild(S);I.attachEvent(S,"load",function(){var Y=R.display;R.display="block";F(S,true,true);R.display=Y;},true);S.className=U;var V=this.model.getDataService();S.src=(V&&V.getDocImage&&V.getDocImage(X))||X;}mstrmojo.DocButton=mstrmojo.declare(mstrmojo.DocTextfield,null,{scriptClass:"mstrmojo.DocButton",pressed:false,markupString:'<div id="{@id}" k="{@k}" class="mstrmojo-DocButton {@cssClass}" title="{@tooltip}" style="{@domNodeCssText}"><div class="mstrmojo-DocButton-Container" mstrAttach:click,mousedown><div class="mstrmojo-DocButton-IconNode"></div><div class="mstrmojo-DocButton-ValueNode" style="{@valueNodeCssText}">{@v}</div></div><div class="mstrmojo-DocButton-EffectOverlay"></div>{@buttonNodeMarkup}</div>',markupSlots:{iconNode:function(){return this.domNode.firstChild.firstChild;},valueNode:function(){return this.domNode.firstChild.lastChild;},buttonContainerNode:function(){return this.domNode.firstChild;}},markupMethods:{onpressedChange:function(){var R=!!this.pressed,V=this.defn,U=this.domNode,S=this.fmts;K.toggleClass(U,"pressed",R);this.setBackgroundColor();this.valueNode.style.color=R?V.fhlc:(S.color||"");},onvisibleChange:mstrmojo.Widget.visibleMarkupMethod},formatHandlers:{domNode:["T","z-index","D","B","P","background-color"],valueNode:["font","fx","color","white-space","overflow"]},setBackgroundColor:function H(){this.domNode.style.backgroundColor=(!!this.pressed)?this.defn.bhlc:(this.fmts["background-color"]||"");},getAnchor:function O(){return this.domNode;},getDPI:function C(){return this.model.dpi;},buildRendering:function G(){this._super();var S=this.defn,k=this.domNode,W=this.buttonContainerNode,j=this.iconNode,n=this.valueNode,e=parseInt((S&&S.dpst)||1,10),f="px";K.toggleClass(k,D[e],true);k.onselectstart=k.ondragstart=function(){return false;};var c=this.getFormats(),Y=parseInt(K.getComputedStyle(W).borderWidth,10)*2;if(isNaN(Y)){Y=0;}var a=parseFloat(c.width)-Y,l=parseFloat(c.height)-Y,X=M[e],b=X.minsp,p=X.mincs,d,Z=j.style,g=n.style;function V(q,r){Z.width=q+f;Z.height=r+f;}var o=W.style;o.height=l+f;o.width=a+f;switch(e){case P:var U=this.getDPI(),R=l+K.getBorderWidths(c["border-width"],U).h+K.getPaddings(c.padding,U).h;d=Math.max(0,Math.min(l-b-p,R*0.6));V(a,d);F(j,false,true);F(n,true,false,{t:d+b},true);break;case A:case N:d=Math.max(0,Math.min(l,a-b-p));V(d,d);F(j,true,false);g[(e===A)?"left":"right"]=(d+b)+f;F(n,true,false);break;case L:F(n,true,false);break;case Q:case E:break;}if(B===parseInt(S.fe,10)){K.addClass(k,"gloss");}J.call(this,j,mstrmojo.url.getFullPath(S.nmurl),"normal");J.call(this,j,mstrmojo.url.getFullPath(S.hlurl||S.nmurl),"hilight");var m=document.createElement("div");K.addClass(m,"mstrmojo-DocButton-IconMaskNode");j.appendChild(m);}});}());(function(){mstrmojo.requiresCls("mstrmojo.Container","mstrmojo._HasLayout","mstrmojo.StackContainer");mstrmojo.TabContainer=mstrmojo.declare(mstrmojo.Container,[mstrmojo._HasLayout],{scriptClass:"mstrmojo.TabContainer",markupString:'<div id="{@id}" class="mstrmojo-tabcontainer {@cssClass}"><div class="mstrmojo-tabcontainer-tabs"></div><div class="mstrmojo-tabcontainer-stack"></div><div></div></div>',markupMethods:{onborderChange:function(){if(this.border){this.domNode.style.border=this.border;}},onbackgroundChange:function(){this.domNode.style.background=this.background||"";}},markupSlots:{top:function(){return this.domNode.childNodes[0];},stack:function(){return this.domNode.childNodes[1];},containerNode:function(){return this.domNode.childNodes[1];},bottom:function(){return this.domNode.childNodes[2];}},addChildren:function A(D,K,H){var G=this._super(D,K,H);var B=this.children,F=B.length;if(F>=2){var L,I,E;for(E=0;E<F;E++){var C=B[E],J=C&&C.slot;if(!L&&C.isStrip){L=C;}else{if(!I&&(!J||J==="stack")){I=C;}}if(L&&I){L.set("target",I);break;}}}return G;}});}());(function(){mstrmojo.requiresCls("mstrmojo.Box","mstrmojo.StackContainer");mstrmojo.MouseOverContainer=mstrmojo.declare(mstrmojo.StackContainer,null,{scriptClass:"mstrmojo.MouseOverContainer",markupString:'<div id="{@id}" class="mstrmojo-Box {@cssClass}" style="{@cssText}" mstrAttach:mouseover,mouseout></div>',doSwitch:true,mouseoverItem:null,mouseoutItem:null,init:function(A){this._super(A);if(this.setupSelectedItem){this.setupSelectedItem();}},markupSlots:{containerNode:function(){return this.domNode;}},markupMethods:{onvisibleChange:function(){this.domNode.style.display=this.visible?"block":"none";}},onmouseover:function(){if(this.doSwitch&&this.enabled){this.set("selected",this.mouseoverItem);}},onmouseout:function(){if(this.doSwitch){this.set("selected",this.mouseoutItem);}},preBuildRendering:function(){this.set("selected",this.mouseoutItem);}});}());(function(){mstrmojo.requiresCls("mstrmojo.array","mstrmojo.Container","mstrmojo._BindTargetChildren","mstrmojo.TabButton","mstrmojo.TabStripBase");var E=mstrmojo.array;function D(G,F){if(G.autoHide){G.set("visible",F);}}mstrmojo.TabStrip=mstrmojo.declare(mstrmojo.TabStripBase,[mstrmojo._BindTargetChildren],{scriptClass:"mstrmojo.TabStrip",markupString:'<div id="{@id}" class="mstrmojo-TabStrip {@cssClass}" style="{@cssText}"></div>',markupSlots:{containerNode:function(){return this.domNode;}},markupMethods:{onvisibleChange:function(){this.domNode.style.display=this.visible?"block":"none";}},autoHide:true,tabButtonClass:"TabButton",init:function C(F){if(F&&F.autoHide){F.visible=false;}this._super(F);},addTabButtons:function B(G,N){var J=this.targetProps||{},S=J.childTitle||"n",O=J.childColor||"tbc",R=this.tabButtonClass,K=[],Q=this.target,F=function(){Q.set("selected",this.target);};mstrmojo.requiresCls("mstrmojo."+R);for(var L=0,M=(G&&G.length)||0;L<M;L++){var P=G[L],I=P[S];if(I){var H=mstrmojo.insert({scriptClass:"mstrmojo."+R,title:I,backgroundColor:P[O],target:P,onclick:F});K.push(H);}}if(K.length){D(this,K.length);this.addChildren(K,N);}this.selectionChange();},removeTabButton:function A(G){var F=E.filter(this.children,function(H){return(H.target===G);},{max:1});if(F&&F[0]){D(this,F.length-1);this.removeChildren(F[0]);F[0].destroy();}},clearButtons:function(){var F=E.map(this.children,function(G){return G.id;});this.removeChildren();E.forEach(F,function(G){if(mstrmojo.all[G]){mstrmojo.all[G].destroy();}});}});})();(function(){mstrmojo.requiresCls("mstrmojo.Popup","mstrmojo._HasBuilder","mstrmojo._IsAnchorable","mstrmojo.hash","mstrmojo.array","mstrmojo.dom");var M="mstrmojo-DocInfoWindow-tip",G=1,E=mstrmojo.dom,O=mstrmojo.hash,I=mstrmojo.array;$D=mstrmojo.dom,$A=mstrmojo.array;function H(W){var V=this.anchor,U=E.findWidget(V)||(V&&V.w),W=W||{};W.lockIW=U;return W;}function S(V){var U=V.model;return U.getLayoutDataCache(U.getCurrentLayoutKey())[V.psId];}function R(){var V=this.anchor,X=E.findWidget(V)||(V&&V.w),U=0;while(X){var W=X.className;if(W==="mstrmojo-DocInfoWindow"){U=mstrmojo.css.getStyleValue(X,"z-index");break;}X=X.parentNode||(X.domNode&&X.domNode.parentNode);}return U;}mstrmojo.DocInfoWindow=mstrmojo.declare(mstrmojo.Popup,[mstrmojo._HasBuilder,mstrmojo._IsAnchorable,mstrmojo._HasPopup],{scriptClass:"mstrmojo.DocInfoWindow",markupString:'<div class="mstrmojo-DocInfoWindow-wrapper @{waitState}"><div id="{@id}" class="mstrmojo-DocInfoWindow"></div><div class="'+M+' top"></div><div class="mstrmojo-DocInfoWindow-curtain" mstrAttach:click></div></div>',markupSlots:{infoNode:function(){return this.domNode.firstChild;},tipNode:function(){return this.domNode.childNodes[1];},curtainNode:function(){return this.domNode.lastChild;},containerNode:function(){return this.domNode.firstChild;}},boundaryNodeName:"boundary",popupNodeName:"infoNode",baseTipClass:M,anchorOffset:1,anchorOrientation:"h",anchor:null,boundary:null,closeOnClick:true,autoCloseLocks:null,autoScrollCloseLocks:null,tipNodeColor:"",ontouchstart:function J(){this.close();},close:function N(){if(this.isAutoCloseLocked()){return ;}if(mstrApp&&mstrApp.isOIVM&&mstrApp.isOIVM()&&mstrApp.modalOpenEditors){if(Object.keys(mstrApp.modalOpenEditors).length>0){return ;}}this.model.raiseEvent({name:"infoWindowClosed",psKey:this.psKey});if(this._super){this._super();}if(this.anchor&&this.anchor.lockInfoWinId&&mstrmojo.all[this.anchor.lockInfoWinId]){mstrmojo.all[this.anchor.lockInfoWinId].releaseLock(this);}this.clearAnchorHilites();E.detachEvent(document,E.isFF?"DOMMouseScroll":"mousewheel",this.mw);E.detachEvent(document,"scroll",this.mw);E.detachEvent(window,"resize",this._resizeHandler);},clearAnchorHilites:function C(){var U=mstrmojo.dom.findWidget(this.anchor);if(U&&U.clearHilites){if(U.parent&&U.parent.clearAllHighlights){U.parent.clearAllHighlights();}else{U.clearHilites(U.hiliteKey);delete U.hiliteKey;}}},prepareAnchor:function A(){if(this.children&&this.children[0]){var V=this.infoNode.style,W=this.children[0],X=W.dimNode||W.domNode,Y=X.offsetWidth,U=X.offsetHeight;V.width=(Y+2*G)+"px";V.height=(U+2*G)+"px";}},nudge:function L(){this.positionDialog();var U=this.containerNode.style;if(this.anchor){var V=parseInt(R.call(this),10);if(V){this.containerNode.style.zIndex=(V+2)+"";}}this.model.raiseEvent({name:"infoWindowRendered",id:this.id});},onRender:function F(){this.open(this.opener);},open:function K(b,W){var U=mstrmojo.all[this.psId];if(U){var Y=U.defn.sfp,d=U.selectedIdx;if(Y&&d!==0){U.switchToPanel(0,0);U.children[d].set("selected",false);}}if(this._super){this._super(b,H.call(this,W));}var X=function X(e){if(!e){return ;}if(e.defn&&e.defn.ifp){e.refresh();}I.forEach(e.children||[],function(f){X(f);});};X(U);if(mstrApp.isTablet&&mstrApp.isTablet()){var c=mstrmojo.touchManager,V=this.id,a=this.domNode;this._tchHandler=c.attachEventListener("touchesBegin",V,function(g){if(this.isAutoCloseLocked()){return ;}var f=mstrmojo.dom.contains(a,g.touch.target,true);var j=document.getElementsByClassName("heatmap-infobox"),e=(j&&j.length)||0,h,l=g.touch.target,k=false;for(h=0;h<e;h++){if(mstrmojo.dom.contains(j[h],l,true)){k=true;break;}}if(!f&&!mstrApp.hasOpenDialog()&&!k){this.closeOnTablet();}});}var Z=this;Z.mw=Z.mw||function(g){if(Z.isAutoScrollCloseLocked()){return ;}var f=E.eventTarget(self,g);if(Z.autoCloses&&!E.contains(Z.domNode,f,true,document.body)&&!(Z.isWithinParentWidget&&Z.isWithinParentWidget(f))){Z.close();}};Z._resizeHandler=function(f){Z.positionDialog(true);};E.attachEvent(document,E.isFF?"DOMMouseScroll":"mousewheel",Z.mw);E.attachEvent(document,"scroll",Z.mw);E.attachEvent(window,"resize",Z._resizeHandler);},getChildren:function D(){return[S(this)];},preBuildRendering:function B(){var W=S(this),V=W.defn.fmts;V.left=G+"px";V.top=G+"px";if(V.border){var U=V.border.split(" ");if(U.length>=3){this.tipNodeColor=U[2];}}if(this._super){this._super();}},postBuildRendering:function Q(){this.set("visible",true);if(this._super){this._super();}if(!this.closeOnClick){this.curtainNode.style.display="none";}},closeOnTablet:function P(){this.close();if(this._tchHandler){this._tchHandler.clear();}},postwaitStateChange:function(){var U=this.children[0],V=U.dimNode||U.domNode;if(!this.waitState&&!V){this.refresh();}},renderChildren:function(){if(!this.waitState){this._super();}},registerLock:function(U){var V=this.autoCloseLocks||[];if(I.indexOf(V,U.id)===-1){V.push(U.id);this.autoCloseLocks=V;}},releaseLock:function(U){I.removeItem(this.autoCloseLocks,U.id);},isAutoCloseLocked:function(){this.autoCloseLocks=I.filter(this.autoCloseLocks,function(U){return !!mstrmojo.all[U];});return this.autoCloseLocks.length>0;},openPopupMenu:function(V,U){this.openPopup(V,U);},registerScrollLock:function(U){var V=this.autoScrollCloseLocks||[];if($A.indexOf(V,U.id)===-1){V.push(U.id);this.autoScrollCloseLocks=V;}},releaseScrollLock:function(U){$A.removeItem(this.autoScrollCloseLocks,U.id);},isAutoScrollCloseLocked:function(){this.autoScrollCloseLocks=$A.filter(this.autoScrollCloseLocks,function(U){return !!mstrmojo.all[U];});return this.autoScrollCloseLocks.length>0;},destroy:function(){var U=mstrmojo.all[this.psId];if(U&&U.defn.iwpl===mstrmojo.DocInfoWindow.PLACEMENT.FIXED&&U.fmts){U.fmts.left=this._ifwfl+"px";U.fmts.top=this._ifwft+"px";}if(this._super){this._super();}}});mstrmojo.DocInfoWindow.PLACEMENT={AUTO:1,FIXED:2,ABOVE:3,BELOW:4,LEFT:5,RIGHT:6};}());(function(){mstrmojo.requiresCls("mstrmojo.Popup","mstrmojo.css");var B=mstrmojo.Widget,A="14px";mstrmojo.vi.ui.rw.VizDropCue=mstrmojo.declare(mstrmojo.Popup,null,{scriptClass:"mstrmojo.vi.ui.rw.VizDropCue",markupString:'<div id="{@id}" class="mstrmojo-VizDropCue {@cssClass}"><div class="mstrmojo-VizDropCue-line"><div></div></div><div class="mstrmojo-VizDropCue-tooltip"><div class="mstrmojo-Tooltip vi-regular vi-tooltip-V V-center"><div class="mstrmojo-Tooltip-contentWrapper"><div class="mstrmojo-Tooltip-content"></div></div></div></div></div>',markupSlots:{containerNode:function(){return this.domNode;},tooltipNode:function(){return this.domNode.lastChild;}},markupMethods:{ontopChange:B.topMarkupMethod,onleftChange:B.leftMarkupMethod,onheightChange:B.heightMarkupMethod,onwidthChange:B.widthMarkupMethod,onvisibleChange:B.visibleMarkupMethod,oncueConfigChange:function(){var C=this.cueConfig;this.set("visible",!!C);if(!C){return ;}var G=C.or==="v";mstrmojo.css.toggleClass(this.domNode,"v",G);this.set("top",C.top);this.set("left",C.left);var D=C.size;this.set("height",G?D:A);this.set("width",G?A:D);var F=C.tip,E=this.tooltipNode;E.firstChild.firstChild.firstChild.innerHTML=F||"";E.style.display=F?"block":"none";}},cueConfig:null});mstrmojo.vi.ui.rw.VizDropCue.CueConfigType=null;}());(function(){mstrmojo.requiresCls("mstrmojo.Box","mstrmojo.dom");var E=mstrmojo.dom,G=mstrmojo.css,D=mstrmojo.Button.newIconButton,A="mstrmojo-oivmSprite ",F=0,K=1,L=2,I={0:"inline",1:"above",2:"below"};function B(M){var N=mstrmojo.boxmodel.offset(M,document.body);return{left:N.left,top:N.top,width:M.offsetWidth,height:M.offsetHeight};}mstrmojo.OIVMDICPopup=mstrmojo.declare(mstrmojo.Popup,null,{scriptClass:"mstrmojo.OIVMDICPopup",autoCloses:false,cssClass:"inline",markupString:'<div dic="1" id={@id} class="mstrmojo-OIVMDICPopup {@cssClass}" style="{@cssText}" mstrAttach:keydown><div class="toolbar"></div><div class="dataInputControl"></div><div class="boxtip"></div></div>',markupSlots:{toolbarNode:function(){return this.domNode.firstChild;},containerNode:function(){return this.domNode.children[1];},tipNode:function(){return this.domNode.lastChild;}},markupMethods:{onvisibleChange:function(){this.domNode.style.display=this.visible?"block":"none";},onheightChange:function(){this.domNode.style.height=this.height||"";},onwidthChange:function(){this.domNode.style.width=this.width||"";},ontopChange:function(){this.domNode.style.top=this.top||"";},onleftChange:function(){this.domNode.style.left=this.left||"";},oncssClassChange:function(){this.domNode.className="mstrmojo-OIVMDICPopup "+this.cssClass;}},setStyle:function(){var V=this.widget,c=V.dic,N=V.popupStyle,X=B(V.openerNode),W=this.domNode,Q=W.style,Y=V.domNode.style,M=this.tipNode,O=c.wm?c.w:X.width,b=c.hm?c.h:X.height,U;this.set("cssClass",I[N]);if(N===F){for(U in X){Q[U]=X[U]+"px";}V.set("width",O-2);Y.width=(O-8)+"px";Y.height=(b>8)?(b-8)+"px":"auto";}else{if(N===K){var a=O,R=X.left+X.width/2-21,Z=X.top,S=Z<76;Z=S?Z+X.height+15:Z-76;M.className=S?"boxtip up":"boxtip";Q.left=R+"px";Q.top=Z+"px";Q.width=V.domNode.scrollWidth+"px";Q.height="44px";a=a>100?(a+70):200;var P=document.body.offsetWidth-R-a-parseInt(G.getStyleValue(W,"paddingLeft"),10)-parseInt(G.getStyleValue(W,"paddingRight"),10);P=P>0?0:P;Q.left=R+P+"px";M.style.left=15-P+"px";}else{if(N===L){Q.top=X.top+"px";Q.left=X.left+"px";Q.height=Y.height;Q.width=Y.width;}}}},onOpen:function C(){var M=this.widget,O=this.lastwidget;if(O!=M){if(O){this.removeChildren(O);}this.lastwidget=M;}if(M.hasRendered){M.unrender();}this.addChildren([M]);this.setStyle();var N=this;this.md=this.md||function(Q){var R=E.eventTarget(self,Q),P=E.findAncestorByAttr(R,"dic",true);if(!P&&!mstrmojo.all.mojoAlertx9){N.onBlur();E.preventDefault(self,Q);}};this.mw=this.mw||function(P){N.onBlur();};E.attachEvent(document,"mousedown",this.md);E.attachEvent(document,E.isFF?"DOMMouseScroll":"mousewheel",this.mw);},onBlur:function(){if(this.widget.popupStyle===F){this.onApply();}else{this.onCancel();}},onClose:function(){E.detachEvent(document,"mousedown",this.md);E.detachEvent(document,E.isFF?"DOMMouseScroll":"mousewheel",this.mw);this.toolbar.apply.set("enabled",false);this.set("hasInvalidData",false);if(this.widget&&this.widget.hasRendered){this.widget.lockPopup();}},onApply:function(){if(this.widget.applyChanges()!==false){this.close();}},onCancel:function(){if(this.widget&&this.widget.hasRendered){this.widget.cancelChanges();}this.close();},onkeydown:function J(N){var M=N.hWin,O=N.e||M.event;if(this.widget.applyOnEnter&&O.keyCode===13){this.onApply();}else{if(O.keyCode===27){this.onCancel();}}},enableApply:function(){this.toolbar.apply.set("enabled",true);},preBuildRendering:function H(){if(!this.slot&&!this.placeholder){this.placeholder=document.body.appendChild(document.createElement("div"));}if(this._super){return this._super();}else{return true;}},onhasInvalidDataChange:function(){var M=this.invalidCurtain;if(!M){M=this.invalidCurtain=document.createElement("div");M.className="mstrmojo-fullscreen-curtain";document.body.appendChild(M);}M.style.display=this.hasInvalidData?"block":"none";},children:[{scriptClass:"mstrmojo.ToolBar",slot:"toolbarNode",alias:"toolbar",children:[D(mstrmojo.desc(134,"Apply"),A+"tbApply greyed",function(){this.parent.parent.onApply();},null,{enabled:false,alias:"apply",onenabledChange:function(){G.toggleClass(this.domNode,"greyed",!this.enabled);}}),D(mstrmojo.desc(221,"Cancel"),A+"tbCancel",function(){this.parent.parent.onCancel();})]}]});}());(function(){mstrmojo.requiresCls("mstrmojo.Popup","mstrmojo.css");mstrmojo.ui.pathbar.PathPopup=mstrmojo.declare(mstrmojo.Popup,null,{scriptClass:"mstrmojo.ui.pathbar.PathPopup",autoCloses:true,locksHover:true,markupMethods:{onvisibleChange:function(){if(this.isOpen){mstrmojo.css.toggleClass(this.domNode,"open",this.visible);}},onleftChange:mstrmojo.Widget.leftMarkupMethod,ontopChange:mstrmojo.Widget.topMarkupMethod},cssClass:null,targetNode:null,offsetTop:0,offsetLeft:0,onOpen:function B(){var D=this,C=D.domNode,E=mstrmojo.dom.position(D.targetNode);C.style.top=(E.y+E.h+D.offsetTop)+"px";C.style.left=(E.x+D.offsetLeft)+"px";D.set("visible",false);D.isOpen=true;window.setTimeout(function(){D.set("visible",true);},100);mstrmojo.css.toggleClass(D.targetNode,"opened",true);},onClose:function A(){var C=this;window.setTimeout(function(){delete C.isOpen;mstrmojo.css.toggleClass(C.targetNode,"opened",false);},500);C.domNode.style.left="";},children:null});}());(function(){mstrmojo.requiresCls("mstrmojo.Popup","mstrmojo.dom");var B=mstrmojo.dom;var A="openXtabCellMenu";mstrmojo.XtabCellHoverPopup={cssClass:"mstrXtabCellHoverPopup",scriptClass:"mstrmojo.Popup",slot:"overlayNode",autoCloses:true,children:[{scriptClass:"mstrmojo.Button",alias:"btn",onmousedown:function(D){this.openPopup(true,D);B.stopPropogation(D.hWin,D.e);B.preventDefault(D.hWin,D.e);return false;},openPopup:function(F,D){var E=this.xtab[A]?this.xtab:mstrmojo.findAncestor(this.xtab,A);if(E){E.openXtabCellMenu({xtab:this.xtab,td:this.td,btn:this,cmPos:this.cmPos,lockIW:this.xtab,singleCellClick:F===true,evt:D});}this.domNode.oncontextmenu=function(G){B.stopPropogation(window,G);B.preventDefault(window,G);return false;};},closePopup:function(){var D=mstrmojo.findAncestor(this.xtab,A);if(D){D.closePopup();}}}],updatePopupConfig:function C(F){var G=F&&F.td,O=F&&F.xtab,D=this.btn;var H=this._lastTd;if(H!==G){D.closePopup();this._lastTd=G;}D.xtab=O;D.td=G;D.cmPos=F&&F.cmPos;if(!G||!O){return ;}var I=B.findAncestorByName(G.parentNode,"table",false,O.viewport),K=O.zones,N="",E;if(I){for(E in K){var L=K[E];if(L&&L.tableNode===I){N=L.slot;break;}}}var M=mstrmojo.boxmodel.offset(G,O.overlayNode),J=23;this.set("location",{left:0,top:M.top,width:Math.min(G.offsetWidth+M.left,O._pl),height:J});},markupMethods:{onvisibleChange:function(){this.domNode.style.display=this.visible?"block":"none";},onlocationChange:function(){var D=this.location;if(!D){return ;}var E=this.domNode.style;E.left=(D.left+Math.max(D.width-20,0))+"px";E.top=D.top+(D.height?Math.round(D.height/2)-7:0)+"px";}}};}());(function(){mstrmojo.requiresCls("mstrmojo.registry","mstrmojo.Popup","mstrmojo.MenuItem");var G="mstrFilterPanelMenu",L="mstrmojo.Box",E="mstrmojo-Menu-Box";var B=function(){var N=mstrmojo.all[G],M=N.fps;M.clearAllFilter();M.applyBufferedSlices();N.close();};var C=function(){var N=mstrmojo.all[G],M=N.fps;if(M&&M.applyBufferedSlices){M.applyBufferedSlices();}N.close();};var F=function(){H(false);};var I=function(){H(true);};var A=function(){var O=mstrmojo.all[G],N=O.fps,M=!O.autoSubmit;N.applyBufferedSlices();N.model.updateUnitFormat(N,1,{FormattingLayout:{CtlAutoSubmit:(M?1:0)}},{success:function(){var P=N.parent;O.set("autoSubmit",M);O.fps.defn.set("cas",M);P.buttonbar.applyNow.set("visible",!M);P.buttonbar.resetBtn.set("visible",!M);P.adjustFPHeight2Fit();mstrmojo.css.toggleClass(P.buttonbarNode,"hide",M);mstrmojo.css.toggleClass(P.toolbarNode,["cas"],!M);}},{params:{suppressData:true}});O.close();};function H(O){var P=mstrmojo.all[G],N=P.fps,V=mstrmojo.DocPortlet,M=O?V.ST_RESTORE:V.ST_MIN;if(!N||!N.children){return ;}var U=N.model,R=[];for(var S in N.children){var W=N.children[S];if(!W.children||!W.selected){continue;}for(var Q in W.children){var X=W.children[Q];if(typeof (X.defn.ttl)!=="undefined"){R.push(X.changeWindowState(M));}}}if(R.length){U.getDataService().submitUpdates(R,{},{preserveUndo:true,params:{suppressData:true}});}P.close();}function J(P,N,M){var O={scriptClass:"mstrmojo.MenuItem",text:P,cssClass:"mstrmojo-InteractiveButton",onclick:N,bindings:M};return O;}function K(P,N,M){M=M||{};M.pressed="mstrmojo.all['"+G+"'].autoSubmit";M.iconClass="this.pressed?'pressed':''";var O=J(P,N,M);O.onpressedChange=function(){if(this.domNode){mstrmojo.css.toggleClass(this.domNode,"pressed",this.pressed);}};return O;}mstrmojo.FilterPanelMenu=mstrmojo.registry.ref({id:G,slot:"popupNode",scriptClass:"mstrmojo.Popup",cssClass:"mstrmojo-Menu",shadowNodeCssClass:"mstrmojo-Menu-shadow",contentNodeCssClass:"mstrmojo-Menu-content",locksHover:true,autoSubmit:true,onOpen:function D(){var R=this.opener,a=R&&R[this.slot],Z=mstrmojo.dom.position(a),b=Z.y||0,U=this.cmPos,W,S,Y;if(U){W=U.x;S=U.y-b;}else{var N=this.openerButton.domNode;Y=mstrmojo.boxmodel.offset(N,a);W=Y.left;S=Y.top+((N&&N.offsetHeight)||0);}var Q=mstrmojo.dom.windowDim(),O=this.domNode;var P=O.offsetHeight,V=Q.h-b;Y=Math.max(0,S+P-V);this.set("top",S-Y+"px");var X=O.offsetWidth,M=Q.w;Y=Math.max(0,W+X-M);this.set("left",W-Y+"px");this.set("autoSubmit",this.fps.isAutoApply());},children:[{scriptClass:L,bindings:{},cssClass:E,children:[J(mstrmojo.desc(15554,"Unset all filters"),B,{}),J(mstrmojo.desc(14820,"Apply Now"),C,{visible:"!mstrmojo.all['"+G+"'].autoSubmit",enabled:"mstrmojo.all['"+G+"'].fps.applyEnabled"})]},{scriptClass:L,cssClass:E,bindings:{},children:[J(mstrmojo.desc(8970,"Expand all"),I,{}),J(mstrmojo.desc(8971,"Collapse all"),F,{})]},{scriptClass:L,cssClass:E,bindings:{},children:[K(mstrmojo.desc(1996,"Auto-Apply changes"),A,{})]}]});}());(function(){mstrmojo.requiresCls("mstrmojo.hash","mstrmojo.Container","mstrmojo._FormatDefinition","mstrmojo.FieldSet","mstrmojo.Table");var D=mstrmojo.hash,B=mstrmojo.num;var C=function(F){return D.copy(F,{scriptClass:"mstrmojo.ValidationTextBox",maxLength:6,dtp:4,min:0,max:100,constraints:{trigger:mstrmojo.validation.TRIGGER.ONKEYUP},bindings:{m:F.modelBinding,value:function(){var G=this.m[this.pr];return G==null?"":this._PT2UserUnits(G).replace(/([\.,][1-9]{1,})0{1,}$/,"$1").replace(/\.$/,".0").replace(/,$/,",0");}},postCreate:function(){this.markupMethods=D.copy({onvalueChange:function(){this.inputNode.value=this.value;}},D.copy(this.markupMethods));},onValid:function(){this.m[this.pr]=this._UserUnits2PT(this.value);},_PT2UserUnits:function(G){return B.toLocaleString(B.convertToLocalUnits(B.toString(G),mstrApp.units));},_UserUnits2PT:function(G){return B.toLocaleString(B.toString(B.convertToUSUnits(G,mstrApp.units)));}});};var A=function(F,G){return{scriptClass:"mstrmojo.Label",text:F,slot:G};};mstrmojo.PaddingFormatter=mstrmojo.declare(mstrmojo.Container,null,{scriptClass:"mstrmojo.PaddingFormatter",cssClass:"mstrmojo-PaddingFormatter",markupString:'<div id={@id} class="{@cssClass}" style="{@cssText}"></div>',markupSlots:{containerNode:function(){return this.domNode;}},markupMethods:{onvisibleChange:function(){this.domNode.style.display=this.visible?"block":"none";}},postCreate:function(){this.onmodelChange();},onmodelChange:function(){if(this.model&&!this.model.scriptClass){D.make(this.model,mstrmojo.Obj);}},init:function E(F){var G=mstrConfig.unitsLabel||mstrApp.unitsLabel;this.children=[{scriptClass:"mstrmojo.FieldSet",alias:"padding",cssClass:"mstrmojo-FormatEditor-padding",legend:mstrmojo.desc(2883),children:[{scriptClass:"mstrmojo.HBox",cssClass:"paddingBox",children:[{scriptClass:"mstrmojo.Table",rows:2,cols:3,children:[A(mstrmojo.desc(3528),"0,0"),C({pr:"LeftPadding",slot:"0,1",modelBinding:"this.parent.parent.parent.parent.model"}),A(G,"0,2"),A(mstrmojo.desc(3526),"1,0"),C({pr:"TopPadding",slot:"1,1",modelBinding:"this.parent.parent.parent.parent.model"}),A(G,"1,2")]},{scriptClass:"mstrmojo.Table",rows:2,cols:3,children:[A(mstrmojo.desc(3529),"0,0"),C({pr:"RightPadding",slot:"0,1",modelBinding:"this.parent.parent.parent.parent.model"}),A(G,"0,2"),A(mstrmojo.desc(3527),"1,0"),C({pr:"BottomPadding",slot:"1,1",modelBinding:"this.parent.parent.parent.parent.model"}),A(G,"1,2")]}]}]}];this._super(F);}});}());(function(){mstrmojo.requiresCls("mstrmojo.css");mstrmojo.PickerButton=mstrmojo.declare(mstrmojo.HBox,null,{scriptClass:"mstrmojo.PickerButton",cssClass:"mstrmojo-PickerButton",cellCssClass:"mstrmojo-PickerButton-cell",enabled:true,postCreate:function(){var A=function(B){var C=B.parent,E=C&&C.items&&C.items[C.selectedIndex],D=E&&E.cssClass||null;if(D){mstrmojo.css.removeClass(B.domNode,B.selectedItemCssClass);mstrmojo.css.addClass(B.domNode,B.selectedItemCssClass=D);}};this.children=[{scriptClass:"mstrmojo.Button",cssClass:"mstrmojo-InteractiveButton",selectedItemCssClass:"",bindings:{title:"this.parent.title",iconClass:"this.parent.iconClass",selectedIndex:"this.parent.selectedIndex",enabled:"this.parent.enabled"},onclick:function(){this.parent.onchange();},onselectedIndexChange:function(){A(this);},onRender:function(){A(this);}},{scriptClass:"mstrmojo.DropDownButton",cssClass:"mstrmojo-PickerButton-DropDownButton",bindings:{enabled:"this.parent.enabled"},popupRef:{scriptClass:"mstrmojo.Popup",slot:"popupNode",cssClass:"mstrmojo-Menu",shadowNodeCssClass:"mstrmojo-Menu-shadow",contentNodeCssClass:"mstrmojo-Menu-content",autoCloses:false,locksHover:true,children:[{scriptClass:"mstrmojo.ListBox",itemCssClass:"mstrmojo-ListBox-item mstrmojo-InteractiveText",bindings:{itemDisplayField:"this.parent.opener.parent.itemDisplayField",itemIdField:"this.parent.opener.parent.itemIdField",items:"this.parent.opener.parent.items"},onchange:function(){if(this._closing){return ;}var C=this.selectedIndex,B=this.parent.opener;if((C>-1)&&B){this._closing=true;B.closePopup();B.parent.selectedItem=this.selectedItem;B.parent.set("selectedIndex",C);B.parent.onchange();this._closing=false;}}}]}}];}});})();(function(){mstrmojo.requiresCls("mstrmojo.Container","mstrmojo.HBox","mstrmojo._HasBuilder","mstrmojo._CanMeasureChildren");function D(){return(this.renderMode!=="scroll")?this._super():true;}function C(){if(!this.hasRendered){return ;}var F=this.children||[],E=F.length-1;for(E;E>=0;E--){if(F[E].refresh){F[E].refresh();}}}mstrmojo.DocSection=mstrmojo.declare(mstrmojo.Container,[mstrmojo._HasBuilder,mstrmojo._CanMeasureChildren],{scriptClass:"mstrmojo.DocSection",markupString:'<div id="{@id}" k="{@k}" class="mstrmojo-DocSection" style="{@cssText}"></div>',markupSlots:{containerNode:function(){return this.domNode;}},postBuildRendering:D,childRenderOnAddCheck:D,refresh:C,getWidth:function A(){return this._super(1);}});mstrmojo.DocSectionHoriz=mstrmojo.declare(mstrmojo.HBox,[mstrmojo._HasBuilder,mstrmojo._CanMeasureChildren],{scriptClass:"mstrmojo.DocSectionHoriz",postBuildRendering:D,childRenderOnAddCheck:D,refresh:C,getHeight:function B(){return this._super(1);}});}());(function(){mstrmojo.requiresCls("mstrmojo.dom","mstrmojo.registry","mstrmojo.tooltip","mstrmojo.HBox");var B=mstrmojo.dom,C=mstrmojo.css,A=1,G=2,F=3,E=function(I){var H=C.getStyleValue(I,"verticalAlign");return{top:A,bottom:F,middle:G}[H]||A;};mstrmojo.SliderBox=mstrmojo.declare(mstrmojo.Container,null,{scriptClass:"mstrmojo.SliderBox",markupString:'<div id="{@id}" class="{@cssClass}" style="{@cssText}" tabindex="{@tabIndex}" ><div class="valuePart" style="{@valueCssText}"><span class="valueLabel">{@valueLabel}</span><span class="valueText">{@valueText}</span></div><table class="sliderPart" style="{@sliderCssText}"><tbody><tr><td class="minText">{@min}</td><td class="sliderWrapper"></td><td class="maxText">{@max}</td></tr></tbody></table></div>',markupSlots:{valuePartNode:function(){return this.domNode.firstChild;},valueLabelNode:function(){return this.domNode.firstChild.firstChild;},valueTextNode:function(){return this.domNode.firstChild.lastChild;},sliderPartNode:function(){return this.domNode.lastChild;},minTextNode:function(){return this.domNode.lastChild.rows[0].cells[0];},maxTextNode:function(){return this.domNode.lastChild.rows[0].cells[2];},sliderNode:function(){return this.domNode.lastChild.rows[0].cells[1];}},markupMethods:{onmaxChange:function(){this.maxTextNode.innerHTML=this.max;},onminChange:function(){this.minTextNode.innerHTML=this.min;},onvalueTextChange:function(){this.valueTextNode.innerHTML=this.valueText;},onunsetChange:function(){var H=this.sliderBar.domNode;if(H){mstrmojo.css.toggleClass(H,"unset",this.unset);}}},tabIndex:-1,sliderRef:null,valueLabel:mstrmojo.desc(4104,"Value:"),valueText:"",min:"",max:"",interval:0,isSequential:false,unset:false,cssClass:"mstrmojo-SliderGroup",postCreate:function D(){if(!this.sliderRef){this.sliderRef={scriptClass:"mstrmojo.Slider",isHoriz:true,ontitleChange:function(){if(this.domNode&&this.title){this.domNode.setAttribute("title",this.title);}},onselectionChange:function(){if(!this.hasRendered){return ;}var I=this.items[this.selectedIndex]&&this.items[this.selectedIndex].n,H=this.parent;if(H.unset){H.unset=false;C.removeClass(this.domNode,"unset");}H.set("valueText",I);H.set("value",I);this.typeHelper.updateThumb();}};}this.sliderRef.slot="sliderNode";this.sliderRef.alias="sliderBar";this.addChildren(this.sliderRef);},preBuildRendering:function(){this._super();var M=this.min,I=this.max,K=mstrmojo.num.parseNumeric(this.value),J=this.items,H,L=this.sliderBar;if(this.isSequential){H=Math.floor((Math.max(Math.min(K,I),M)-M)/this.interval);if(isNaN(K)||K<M||K>I){this.unset=true;}}else{H=mstrmojo.array.find(J,"v",String(K));if(H==-1){this.unset=true;H=0;}}L.set("items",J);L.select(H||0);},postBuildRendering:function(){this._super();if(this.unset){C.addClass(this.sliderBar.domNode,"unset");}},alignSlider:function(K,H){var J=E(K),I,L;if(!this.valuePartNode){L=this.valueCssText||"";I=this.sliderCssText||"";if(J===A){this.valueCssText="top:0;"+L;this.sliderCssText="top:0;"+I;}else{if(J===F){this.valueCssText="bottom:0;"+L;this.sliderCssText="bottom:0;"+I;}else{this.valueCssText="height: 100%; line-height: "+H+"px;"+L;this.sliderCssText="height: 100%;"+I;}}}else{I=this.sliderPartNode.style;L=this.valuePartNode.style;if(J){if(J===A){I.top=L.top="0";}else{if(J===F){I.bottom=L.bottom="0";}else{L.height=I.height="100%";L.lineHeight=inlineHeight+"px";}}}}}});})();(function(){mstrmojo.requiresCls("mstrmojo._IsInputControl","mstrmojo.num","mstrmojo.HBox","mstrmojo.Container");var E=mstrmojo.expr.DTP,P="mstrmojo.Button",G=mstrmojo.num,N=mstrmojo.validation.TRIGGER,D=50,B=500,L=10;function F(Q){var R=this;this._holdTimer=setInterval(function(){R.onclick(Q);},D);}function H(){if(this._holdTimer){clearInterval(this._holdTimer);delete this._holdTimer;}}function K(Q){var R=this;if(!this._holdTimer&&!this._startHoldTimer){this._startHoldTimer=setTimeout(function(){delete R._startHoldTimer;F.call(R,Q);},B);}}function A(){if(this._startHoldTimer){clearTimeout(this._startHoldTimer);delete this._startHoldTimer;}H.call(this);}function M(Q){A.call(this);}function C(Q){return Q?parseFloat(Q.toFixed(L)):Q;}function I(U){var Q=U.max,S=U.min,R=U.itv;return{scriptClass:"mstrmojo.HBox",alias:"hBox",children:[{scriptClass:P,alias:"minus",cssClass:"mstrmojo-StepperDIC-Operator",bindings:{enabled:function(){var X=this.parent.parent,W=X.numericValue;if(W<=S||!X.enabled){A.call(this);return false;}return true;}},onclick:function(W){var Y=this.parent.parent,X=Y.numericValue;if(!isNaN(X)){if(Q!==undefined&&X-R>Q){Y.set("numericValue",Q);this.parent.plus.set("enabled",true);}else{if(S===undefined||X-R>=S){Y.set("numericValue",C(X-R));}else{if(X>S&&X-R<S){Y.set("numericValue",S);}}}}},onmouseup:M,onmousedown:K,text:"-"},{scriptClass:"mstrmojo.ValidationTextBox",cssClass:"mstrmojo-DataInputControl",dtp:E.DOUBLE,required:true,alias:"textInput",cssDisplay:"block",constraints:{trigger:N.ONKEYUP|N.ONBLUR,max:Q,min:S},bindings:{value:"this.parent.parent.numericValue",enabled:"!!this.parent.parent.enabled"},onValid:function(){this.parent.parent.set("numericValue",parseFloat(this.value));},onblur:function V(W){var Y=this,X=this.parent.parent,Z=G.parseNumeric(this.value);if(!X.active&&!isNaN(Z)&&Z>=S&&Z<=Q){X.set("value",G.toLocaleString(X.numericValue));}if(this._super){this._super(W);}}},{scriptClass:P,alias:"plus",cssClass:"mstrmojo-StepperDIC-Operator",bindings:{enabled:function(){var X=this.parent.parent,W=X.numericValue;if(W>=Q||!X.enabled){A.call(this);return false;}return true;}},onclick:function(W){var Y=this.parent.parent,X=Y.numericValue;if(!isNaN(X)){if(S!==undefined&&X+R<S){Y.set("numericValue",S);this.parent.minus.set("enabled",true);}else{if(Q===undefined||X+R<=Q){Y.set("numericValue",C(X+R));}else{if(X<Q&&X+R>Q){Y.set("numericValue",Q);}}}}},onmouseup:M,onmousedown:K,text:"+"}]};}mstrmojo.StepperDIC=mstrmojo.declare(mstrmojo.Container,[mstrmojo._IsInputControl],{scriptClass:"mstrmojo.StepperDIC",cssClass:"mstrmojo-StepperDIC",markupString:'<div id="{@id}" class="{@cssClass}" style="{@cssText}" mstrAttach:mouseup,mousedown></div>',markupSlots:{containerNode:function(){return this.domNode;}},markupMethods:{onvisibleChange:function(){this.domNode.style.display=this.visible?"block":"none";}},init:function O(R){if(this._super){this._super(R);}var Q=parseFloat(this.value);this.set("numericValue",isNaN(Q)?(this.dic.min||0):Q);this.set("children",I(this.dic));this.textInput=this.hBox&&this.hBox.textInput;this.plus=this.hBox&&this.hBox.plus;this.minus=this.hBox&&this.hBox.minus;},onmousedown:function(Q){this.active=true;},onmouseup:function(Q){this.active=false;this.textInput&&this.textInput.domNode.focus();},unrender:function J(Q){this.plus&&A.call(this.plus);this.minus&&A.call(this.minus);this._super(Q);}});}());(function(){mstrmojo.requiresCls("mstrmojo.Button","mstrmojo.date","mstrmojo.dom","mstrmojo.HBox","mstrmojo.VBox");var Q=mstrmojo.date,J=mstrmojo.dom,L=mstrmojo.boxmodel,I=function(){return mstrmojo.locales.datetime;},D=Math.PI/6,O=1,P=2,M=3,A=I().AM_NAME,N=I().PM_NAME;function E(S,R){if(S===0){return"00";}if(S<10){return R?S.toString():"0"+S;}return S.toString();}function G(V){if(!V){return null;}var S=Q.parseTime(V),U=/.*\ [a|p]m/i.test(V);if(!S){var R=Q.parseDateAndOrTime(V);S=R&&R.time;if(!S){return null;}}if(U){S.h12=/.*\ am/i.test(V)?A:N;}return S;}function C(f,U){var d=this,S=L.offset(U,document.body),Z=(d._hh%12)*(Math.PI/6)+(Math.PI/360)*d._mm,a=(Math.PI/30)*d._mm,b=0,c=0,X=S.left+80,W=S.top+80,V=0,Y=0,R=function(l,j,g,o){var m=0,n=0,k=g-l,h=j-o;if(h===0){if(k>=0){n=Math.PI/2;}else{n=3*Math.PI/2;}}else{if(k===0){if(h>=0){n=0;}else{n=Math.PI/2;}}else{m=k/h;if(m>0&&k>0){n=Math.atan(m);}else{if(m>0&&k<0){n=Math.PI+Math.atan(m);}else{if(m<0&&k>0){n=Math.PI+Math.atan(m);}else{n=2*Math.PI+Math.atan(m);}}}}}return n;},e=function(h){var j=R(X,W,h.pageX,h.pageY),g;if(Y===O){g=d._hh;d._hh=Math.floor(j*6/Math.PI);if(d._hh===0){if(g===23){d._hh=0;}else{if(g===11||g===12){d._hh=12;}else{if(g>12){d._hh+=12;}}}}else{if(d._hh===11){if(g===0){d._hh=23;}else{if(g===13||g===12){d._hh=11;}else{if(g>12){d._hh+=12;}}}}else{if(g>=12){d._hh+=12;}}}d._updateValue();}else{g=d._mm;d._mm=Math.floor(j*30/Math.PI);if(d._mm<15&&g>45){if(d._hh===23){d._hh=-1;}d._hh+=1;}else{if(d._mm>45&&g<15){if(d._hh===0){d._hh=24;}d._hh-=1;}}d._updateValue();}};V=R(X,W,f.pageX,f.pageY);b=Math.abs(Z-V);b=Math.min(b,2*Math.PI-b);c=Math.abs(a-V);c=Math.min(c,2*Math.PI-c);if(b<D||c<D){if(c<b){Y=P;d.active=P;}else{Y=O;d.active=O;}J.attachEvent(U,"mousemove",e);J.attachEvent(U,"mouseup",function(g){J.detachEvent(U,"mousemove",e);});}}function F(W,S){var R=S.getContext("2d"),V=W.hour,U=W.min;R.save();R.clearRect(0,0,160,160);if(W.h12){R.save();R.fillStyle=V<12?"rgba(191, 223, 255, 1)":"rgba(246, 200, 126, .5)";R.fillRect(68,100,26,14);R.font="bold 14px sans-serif";R.fillStyle="black";R.fillText(V<12?"AM":"PM",70,112);R.restore();}R.translate(80,80);R.scale(0.3,0.3);R.rotate(-Math.PI/2);R.fillStyle="rgb(90, 158, 198)";R.save();R.rotate(V*(Math.PI/6)+(Math.PI/360)*U);R.lineWidth=12;R.beginPath();R.moveTo(-28,0);R.lineTo(105,0);R.stroke();R.restore();R.save();R.rotate((Math.PI/30)*U);R.lineWidth=10;R.beginPath();R.moveTo(-35,0);R.lineTo(162,0);R.stroke();R.restore();R.restore();}function H(U,S){var W=L.offset(S,document.body),R=W.left,V=W.top;if(U.pageX<R+68||U.pageX>R+94||U.pageY<V+100||U.pageY>V+114){return false;}return true;}mstrmojo.TimePicker=mstrmojo.declare(mstrmojo.Container,null,{scriptClass:"mstrmojo.TimePicker",markupString:'<div class="mstrmojo-TimePicker {@cssClass}" style="{@cssText}"><div></div><div class="mstrmojo-Clock-time"><canvas width="157" height="157"></canvas></div></div>',cssText:"width:158px; height:"+(J.isIE?28:180)+"px",markupSlots:{hbNode:function(){return this.domNode.firstChild;},canvasNode:function(){return this.domNode.lastChild;}},markupMethods:{onvisibleChange:function(){this.domNode.style.display=this.visible?"block":"none";},onintervalChange:function(){this.interval=parseInt(this.interval,10);},onvalueChange:function(){if(this.domNode){var R,U;R=G(this.value);if(!R){var V=new Date(),S=Q.getDateJson(V);this.set("value",Q.formatTimeInfo(S,I().TIMEINPUTFORMATS[0]));return ;}this._hh=R.hour;this._mm=R.min;U=this.ctn.hb&&this.ctn.hb.tf;if(R.h12){U.set("visible",true);this.set("_tf",R.h12);this.set("_HH",E(R.hour>12?R.hour-12:(R.hour===0?12:R.hour),true));}else{U.set("visible",false);this.set("_HH",E(R.hour,true));}this.set("_MM",E(R.min));if(!J.isIE){F(R,this.canvasNode.firstChild);}}}},active:P,value:null,_hh:null,_HH:null,_mm:null,_MM:null,_tf:null,interval:5,children:[{scriptClass:"mstrmojo.HBox",alias:"ctn",slot:"hbNode",children:[{scriptClass:"mstrmojo.HBox",alias:"hb",cssText:"border: 1px solid #CECBCE;margin-left: 5px;background-color:#FFFFCC;",children:[{scriptClass:"mstrmojo.TextBox",alias:"hh",width:"20px",cssText:"border:none;text-align:right;",bindings:{value:"this.parent.parent.parent._HH"},onfocus:function(){this.ov=this.value;this.domNode.select();this.parent.parent.parent.active=O;},onkeyup:function(){var R=parseInt(this.value,10);if(parseInt(this.ov,10)!==R&&R>=0&&R<=23){this.parent.parent.parent.updateHours(this.value);this.ov=this.value;}},onblur:function(){var R=parseInt(this.value,10);if(R<0||R>23){this.set("value",this.ov);}}},{scriptClass:"mstrmojo.Label",cssText:"width:5px;",text:":"},{scriptClass:"mstrmojo.TextBox",alias:"mm",width:"20px",cssText:"border:none;",bindings:{value:"this.parent.parent.parent._MM"},onfocus:function(){this.ov=this.value;this.domNode.select();this.parent.parent.parent.active=P;},onkeyup:function(){var R=parseInt(this.value,10);if(parseInt(this.ov,10)!==R&&R>=0&&R<=60){this.parent.parent.parent.updateMinutes(this.value);this.ov=this.value;}},onblur:function(){var R=parseInt(this.value,10);if(R<0||R>60){this.set("value",this.ov);}}},{scriptClass:"mstrmojo.TextBox",width:"24px",cssText:"padding-right:2px;border:none;",alias:"tf",visible:false,onfocus:function(){this.ov=this.value;this.domNode.select();this.parent.parent.parent.active=M;},onkeyup:function(){var R=this.value&&this.value.toUpperCase(),S=this.parent.parent.parent;if((R===I().AM_NAME||R===I().PM_NAME)&&(R!==this.ov)){S._hh+=S._hh<12?12:-12;this.value=this.ov=R;S._updateValue();}},onblur:function(){var R=this.value&&this.value.toUpperCase();if(R!==I().AM_NAME&&R!==I().PM_NAME){this.set("value",this.ov);}},value:"AM",bindings:{value:"this.parent.parent.parent._tf"}}]},{scriptClass:"mstrmojo.VBox",alias:"stepper",slot:"stepperNode",cssText:"padding-left: 2px; padding-top: 0px;",children:[{scriptClass:"mstrmojo.Button",title:mstrmojo.desc(8314,"Increase"),cssClass:"stepper up",text:"",onclick:function(){this.parent.parent.parent.incr();},onmousedown:function(){var R=this;this.tmr=window.setInterval(function(){R.parent.parent.parent.incr();},200);},onmouseup:function(){if(this.tmr){window.clearInterval(this.tmr);delete this.tmr;}}},{scriptClass:"mstrmojo.Button",title:mstrmojo.desc(8315,"Decrease"),cssClass:"stepper down",text:"",onclick:function(){this.parent.parent.parent.decr();},onmousedown:function(){var R=this;this.tmr=window.setInterval(function(){R.parent.parent.parent.decr();},200);},onmouseup:function(){if(this.tmr){window.clearInterval(this.tmr);delete this.tmr;}}}]}]}],init:function(R){if(this._super){this._super(R);}this._hh=0;this._HH="";this._mm=0;this._MM="";},focus:function B(){var R=this.ctn,S=R&&R.hb;if(!S||!this.visible){return ;}if(this.active===O){S.hh.focus();}else{if(this.active===M){S.tf.focus();}else{S.mm.focus();}}},postBuildRendering:function K(){var S=this.canvasNode.firstChild,R=this;if(this._super){this._super();}if(!this.value){this.value="12:00 AM";}if(J.isIE){this.canvasNode.style.display="none";}else{F({hour:this._hh,min:this._mm},S);S.onmousedown=function(U){C.call(R,U,S);};S.onclick=function(U){if(!H(U,S)){return ;}R.active=M;R._hh+=R._hh<12?12:-12;R._updateValue();};}},_updateValue:function(){var R;if(this._tf){R=I().TIMEINPUTFORMATS[0];}else{R=I().TIMEINPUTFORMATS[1];}this.set("value",Q.formatTimeInfo({hour:this._hh,min:this._mm},R));},incr:function(){var R;if(this.active===O){R=this._hh;if(R===23){R=-1;}this._hh=R+1;}else{if(this.active===M){if(this._hh>12){this._hh-=12;}else{this._hh+=12;}}else{R=parseInt(this._mm,10)+this.interval;if(R>=60){if(this._hh===23){this._hh=-1;}this._hh+=1;R=R-60;}this._mm=R;}}this._updateValue();},decr:function(){var R;if(this.active===O){R=this._hh;R=(R===0)?24:R;this._hh=R-1;}else{if(this.active===M){if(this._hh>12){this._hh-=12;}else{this._hh+=12;}}else{R=parseInt(this._mm,10)-this.interval;if(R<0){if(this._hh===0){this._hh=24;}this._hh-=1;R+=60;}this._mm=R;}}this._updateValue();},updateHours:function(S){var R=parseInt(S,10);if(this._tf){if(this._hh>=12&&R<12){this._hh=R+12;}else{this._hh=R;}}else{this._hh=R;}this._updateValue();},updateMinutes:function(R){this._mm=parseInt(R,10);this._updateValue();}});}());(function(){mstrmojo.requiresCls("mstrmojo.Container","mstrmojo.func","mstrmojo.array","mstrmojo.Button","mstrmojo.HBox","mstrmojo.dom","mstrmojo.Box");var D=mstrmojo.dom;mstrmojo.Dialog=mstrmojo.declare(mstrmojo.Container,null,{scriptClass:"mstrmojo.Dialog",title:"",buttons:null,alignment:"center",btnAlignment:"right",zIndex:10,modal:true,markupString:'<div id="{@id}" class="mstrmojo-Dialog {@cssClass}" style="z-index: 1100;" tabindex="0" mstrAttach:click><div class="win mstrmojo-Editor" style="{@cssText}"><div class="mstrmojo-Editor-titlebar"><div class="mstrmojo-Editor-title">{@title}</div></div><div class="mstrmojo-Editor-content"></div><div class="mstrmojo-Editor-buttons"></div></div><div class="mstrmojo-Editor-curtain"></div><div class="mstrmojo-Editor-tip"></div></div>',markupSlots:{editorNode:function(){return this.domNode.firstChild;},curtainNode:function(){return this.domNode.childNodes[1];},titleNode:function(){return this.domNode.firstChild.firstChild;},containerNode:function(){return this.domNode.firstChild.childNodes[1];},buttonNode:function(){return this.domNode.firstChild.lastChild;},tipNode:function(){return this.domNode.lastChild;}},editorNode:null,btnHbox:null,markupMethods:{onzIndexChange:function(){this.editorNode.style.zIndex=this.zIndex;this.curtainNode.style.zIndex=this.zIndex-1;},onwidthChange:function(){this.editorNode.style.width=this.width||"auto";},onvisibleChange:function(L){if(L){return ;}var J=this.visible,K=J?"block":"none";this.editorNode.style.display=K;if(this.modal){this.curtainNode.style.display=K;}},onleftChange:function(){this.editorNode.style.left=this.left||"";},ontopChange:function(){this.editorNode.style.top=this.top||"";},ontitleChange:function(){this.titleNode.firstChild.innerHTML=this.title||"";}},preBuildRendering:function F(){var J;var K=this.buttons;if(K&&!this.btnHbox){for(J in K){K[J].cssClass=(K[J].cssClass||"")+(this.noButtonCls?"":" mstrmojo-Editor-button");}this.addChildren([{scriptClass:"mstrmojo.HBox",cssText:"float:"+this.btnAlignment,slot:"buttonNode",alias:"btnHbox",children:K},{scriptClass:"mstrmojo.Label",cssClass:"mstrmojo-clearMe",slot:"buttonNode"}]);}if(this.modal){this.cssClass+=" modal";}return this._super();},buildRendering:function B(){var J=this.placeholder;if(this._super()){if(!this.parent&&!J){document.body.appendChild(this.domNode);}return true;}return false;},getResizeHandler:function E(){var J=this.id;return function(){var K=mstrmojo.all[J];K.resizeDialog();K.positionDialog();};},postBuildRendering:function A(){this._super();if(this.modal&&this.visible){this.curtainNode.style.display="block";}if(!this._resizeHandler){var K=this._resizeHandler=this.getResizeHandler();D.attachEvent(window,"resize",K);}this.resizeDialog();this.positionDialog();try{this.domNode.focus();}catch(J){}return true;},resizeDialog:function G(){if(this.modal){this.resizeCurtain();}},resizeCurtain:function C(){var K=this,O=K.curtainNode,J=document.body,M=document.documentElement,N=O.style,L=K.curtainPosition;N.width=Math.max(J.clientWidth,M.scrollWidth)+"px";if(L&&L.h){N.height=L.h+"px";}else{N.height=Math.max(J.clientHeight,M.scrollHeight)+"px";}if(L&&L.y){N.top=L.y+"px";}K.raiseEvent({name:"resizeCurtain"});},positionDialog:function H(){var K=this.editorNode,M=this.left,L=this.top;if(!M||!L){D.center(K);var J=K.style;if(this.alignment==="top"){J.top="10px";}if(M){J.left=M;}if(L){J.top=L;}}},destroy:function(K){var J=this._resizeHandler;if(J){D.detachEvent(window,"resize",J);}this._super(K);}});mstrmojo.toast=function I(O,M,Q,J){var P="mojoToast9",N,L=M||3000;if(J&&J.id){P=J.id+"-"+P;}try{mstrmojo.all[P].destroy();}catch(K){}mstrmojo.insert({id:P,scriptClass:"mstrmojo.Label",cssClass:(J&&J.cssClass)?J.cssClass:"toastCss",text:O}).render();N=mstrmojo.all[P].domNode;if(J&&J.dom){J.dom.appendChild(N);}else{document.body.appendChild(N);D.bottomCenter(N);}window.setTimeout(function(){if(Q){Q();}try{mstrmojo.all[P].destroy();}catch(R){}},L);};mstrmojo.mask={show:function(){var J=mstrmojo.mask.win=mstrmojo.insert({scriptClass:"mstrmojo.Box",cssClass:"fullscreen-mask"});J.render();document.body.appendChild(J.domNode);},hide:function(){mstrmojo.mask.win.destroy();}};}());(function(){mstrmojo.requiresCls("mstrmojo.css","mstrmojo._HasBuilder");mstrmojo.ToolBar=mstrmojo.declare(mstrmojo.HBox,[mstrmojo._HasBuilder],{scriptClass:"mstrmojo.ToolBar",cellCssClass:"mstrmojo-ToolBar-cell",markupString:'<table id="{@id}" class="mstrmojo-ToolBar {@cssClass}" style="{@cssText}" cellspacing="0" cellpadding="0"><tr><td class="mstrmojo-ToolBar-outercell"><table class="mstrmojo-ToolBar-innertable" cellspacing="0" cellpadding="0"><tr>{@tableHtml}</tr></table></td></tr></table>',markupSlots:{containerNode:function(){return this.domNode.rows[0].cells[0].firstChild.rows[0];}},markupMethods:{onvisibleChange:function(){this.domNode.style.display=this.visible?mstrmojo.css.DISPLAY_TABLE:"none";}},buildChildren:function A(){var B=this.buildConfig;if(!B){this.buildConfig={};B=this.buildConfig;}B.target=this.target;return this._super();}});}());(function(){mstrmojo.requiresCls("mstrmojo.array","mstrmojo.EnumRWUnitType","mstrmojo.models.FormatModel","mstrmojo.DocDataService","mstrmojo.hash","mstrmojo.vi.viz.EnumWidgetTypes","mstrmojo.vi.viz.EnumVizStyles","mstrmojo.vi.ui.rw.selectors.EnumVizSelectorMode","mstrmojo.css","mstrmojo.vi.ui.rw.selectors.VisSelectorCurtain");mstrmojo.requiresClsP("mstrmojo.vi.models","PanelFormatSaver","EnumPanelTypes","VIComponentMap");var z=mstrmojo,d=z.hash,AA=z.array,k=z.vi.models,J=z.vi.ui.rw,K=k.VIComponentMap.TYPES,u=k.EnumPanelTypes,AK=K.FILTER_STACK,AI=z.models.FormatModel,AL=AI.getFormatUpdate,AF=AI.ENUM_PROPERTY_NAMES,AJ=z.EnumRWUnitType,N=z.mstr.EnumWebAPIErrorCodes,AM=u.FILTERS,S=z.DocDataService.UNDO_KEY,B="\u001E",D=z.DocDataService.REQUEST_DEFN_DATA,P=z.DocDataService.SUPPRESS_DATA,x="sections.0.subsections.0",AR=mstrmojo.vi.viz.EnumVizStyles,AS=mstrmojo.vi.viz.EnumWidgetTypes,F=J.selectors.EnumVizSelectorMode,C=mstrmojo.css;var AN=8,j=80,AP=10;function f(AV){return AV.t!==1&&(AV.t!==47||AV.st===12033);}function AB(AV,AX,AW,Aa,AY){var AZ=[];if(!AV){return AZ;}AY=AY||{};AV.getFilters().forEach(function(Ad){var Ab=parseInt(Ad.defn.fmts["z-index"],10),Ac=Ad.defn.t===AJ.SELECTOR?Ad.ckey:Ad.k;if(Ab>=AX&&(!AW||Ab<=AW)){AZ.push(this.getUnitFormatAction(Ad,1,AL(AF.Z_INDEX,Ab+Aa)));AY[Ac]=Ad.id;}},this);return AZ;}function Y(){var AV=this.getCurrentLayoutKey();return this.getVIComponent(K.VIZ_CONTENT,AV);}function O(Ah,AZ,Ad,AX,Ag){var Ac=[],Ai=this.getCtrlStyleFromDatasetUnit(Ah,true),Aa=this.getCurrentLayoutDef().units,Ab=this.getVIPanelKeyFromUnits(AM),AY=d.keyarray(Aa).filter(function(Aj){return Aa[Aj].t===AJ.PANEL&&Aa[Aj].isFilterPanel;})[0],Ae=this.getTargetDefn(AY)[AY].fmts,Af=Ae&&Ae.width,AW=(Af&&Af.charAt(Af.length-1)!=="%")?parseInt(Af,10):undefined,AV;if(Ag===undefined||Ag===null){Ag=999;}Ac.push(this.getDataService().getAddCtrlAction(AY,Ad,AX,[Ab],f(Ah),Ah.t,Ah.did,AZ));if(Ai===1){AV=1;}Ac=Ac.concat(this.getCtrlActionsByStyle(Ah,this.buildKeyContext(Ad,AX),Ai,AV,this.getCtrlHeightByStyle(Ai,Ah.card&&(Ah.card+1)||AN+1),AW,Ag,1));return Ac;}function AG(Aa,AY,AX,Ag){if(!AY){return ;}var Ac=[],Ae=AY.k,Ab=this.getCurrentLayoutDef().units,Ad=this.getVIPanelKeyFromUnits(AM),AZ=d.keyarray(Ab).filter(function(Am){return Ab[Am].t===AJ.PANEL&&Ab[Am].isFilterPanel;})[0],Ai=this.getTargetDefn(AZ)[AZ].fmts,Al=Ai&&Ai.width,AW=(Al&&Al.charAt(Al.length-1)!=="%")?parseInt(Al,10):undefined,AV,Aj=this,Ah=Aj.buildKeyContext(AY.k,AX),Af=Aj.getVIComponent(K.FILTER_PANEL).children,Ak=Af?Af.length:0;Ac.push(this.getSetVisAsFilterAction(Ae,AX,[Ad],Aa,Ag));Ac=Ac.concat(this.getCtrlActionsByStyleForVisFilter(Ae,Ak));return Ac;}function G(AZ,AX,Ab,Ad,Ac,AW){var Aa=this.getVIMap(),Ae=Aa.getComponent(AK);if(AW&&AW.preInfo){AZ.addActions(AW.preInfo.actions);}if(!AX.length){var AY=Ad;Ab.forEach(function(Ai){var Ah=this.getNextKey(),Aj=this.getNextKey(),Ag=this.buildKeyContext(Ah,Aj);AX.push(Ag);AZ.addActions(O.call(this,Ai,[Aa.getComponentKey(K.MAIN_CONTENT)],Ah,Aj,(AY!==null?AY++:null)));},this);var AV=AX.length&&(Ae.getFilters().length-1);AZ.addActions(AB.call(this,Ae,Ad,AV,AX.length,Ac));}else{var Af=this.getDataService();AX.forEach(function(Ag){Af.addMoveControlAction(AZ,Ag,Ae.contents.k);});AZ.addActions(AB.call(this,Ae,Ad,null,AX.length,Ac));}if(AW&&AW.postInfo){AZ.addActions(AW.postInfo.actions);}}function v(Ab,AY,Aa,AX){var AW=this.getVIMap(),AV=AW.getComponent(AK),AZ=this.getDataService();AY.forEach(function(Ac){AZ.addMoveControlAction(Ab,Ac,S);});Ab.addActions(AB.call(this,AV,Aa+1,undefined,-AY.length,AX));}function H(AY,Aa,Ac,Ab,AZ){var Ad=Aa.getDocBuilder().getLayoutVIMap(Aa.getCurrentLayoutKey()).getComponent(AK),AX=Ad.contents.k,Af=Aa.getDataService();var AW=Ad.getFilters(),AV={},Ae=0;Ac.forEach(function(Ag){AV[Ag.ckey]=Ag;});AW.forEach(function(Ah){var Al=parseInt(Ah.defn.fmts["z-index"],10);if(!Ah.ckey){Ah.ckey=Ah.k;}if(!AV[Ah.ckey]){if(Ae!==0){AY.addActions(Aa.getUnitFormatAction(Ah,1,AL(AF.Z_INDEX,Al-Ae)));Ab[Ah.ckey]=Ah.id;}else{var Ak=Ah.tks?Ah.tks.split(B):[];for(var Ag in AV){if(Ak.indexOf(AV[Ag].ckey)>=0){Ab[Ah.ckey]=Ah.id;break;}}}}else{var Ai=AV[Ah.ckey],Ak=Ai.tks?Ai.tks.split(B):[],An=Ai.dsTks?Ai.dsTks.split(B):[],Ao=Ai.ck,Am=Af.getRemoveCtrlTargetAction,Aj=Af.getRemoveCtrlTargetDatasetAction;if(!(Ah instanceof mstrmojo.VisDocSelector)){Ak.forEach(function(Aq){if(AZ){AY.addActions(Am.call(Af,Ao,Aq,[],true));}else{AY.addActions(Am.call(Af,Ao,Aq,Aq));}});}An.forEach(function(Aq){AY.addActions(Aj.call(Af,Ao,Aq));});if(Aa.datasetsSettings.unitOpr(Ai.ttl,"isDeleteWithFilter")){AY.addActions({act:"removeDerivedMetricFromDataset",dsid:Aa.findDatasetIdFromUnit(Ai.srcid),metricId:Ai.srcid});Aa.datasetsSettings.unitOpr(Ai.ttl,"isDeleteWithFilter",false);Aa.datasetsSettings.unitOpr(Ai.ttl,"completeHide",false);AY.addActions(Aa.datasetsSettings.getSaveActions());}var Ap=[AX];if(!AZ){Ap=Ap.concat(Ak);}AY.addActions(Af.getRemoveCtrlAction(Ai.ckey,Ap));Ae=Ae+1;}},this);}function o(AY,AZ,AW,Ac,Ab){var AV=Ac.contents.k,Ad=this.getDataService(),Aa=AZ.ck,Ae=AZ.ckey,AX=AZ.tks?AZ.tks.split(B):[];Ab[AV]=true;Ab[Ae]=true;AY.addActions(Ad.getReplaceCtrlAction(Aa,Ae,AZ.ct,AW.did,AW.t,AX.concat(AV)));}function n(AV,Aa,Ac,Ab,Aj,Ae,Af){var AZ=this,Ag=Ab.contents,Ah=Ab.k,AW=Aa.params.params,An=AW&&JSON.parse(AW).partialRetrieval,AY=An&&An.nodes;if(Ae){Ah=AV.pukeys;}else{if(AY){Ah=d.keyarray(Aj||{}).concat(AY).join(B);}}AZ.partialUpdate(AV.data,AZ.getTargetDefn(Ah),AV.defn,d.keyarray(Aj||{}));if(mstrApp.isAppStatePause&&mstrApp.isAppStatePause()&&Ag.refreshFP){Ag.refreshFP();}else{if(Ag&&Ag.children){Ag.rebuildChildren();}}if(!!Af&&Af.hasOwnProperty("isVisFilterAdded")&&Af.isVisFilterAdded){var Ai=this.getVIComponent(K.FILTER_PANEL),Ad=Ai.children,Ak=Ad.length,Al=Ad[Ak-1].domNode,AX=Ab.scrollNode;AX.scrollTop=AX.scrollHeight-AX.clientHeight;C.addClass(Al,["visSelector-Animation"]);C.onAnimationEnd(Al,function(){C.removeClass(Al,["visSelector-Animation"]);});}Ab.getFilterDefinitions().forEach(function(Ap){if(!Ap.sfs){var Ao=[],Aq=AZ.getDatasetUnits(["att","mx"],function(Ar){return Ar.did===Ap.srcid;})[0]||{};(Aq.fs||[]).forEach(function(Ar){Ao.push({did:Ar.fid});});if(Ao.length){Ap.sfs=Ao;}}});var Am=Ab.parent&&Ab.parent.tabList;if(Am){Am.singleSelect(AA.find(Am.items,"id","vi_flt"));}}function t(Aa,AV,AY,AX,AZ){var AW=this;if(mstrmojo.array.find(Aa.actions,"act","removeDerivedMetricFromDataset")>=0){Aa.addCallbacks(AW.getDatasetsUpdateCallback());}if(AZ&&AZ.preInfo){Aa.addCallbacks(AZ.preInfo.callback);}Aa.addCallbacks({success:function(Ab,Ac){n.call(AW,Ab,Ac,Aa,AV,AY,AX,AZ);},failure:function(Ab,Ad){var Ac=null;if(Ab.code==N.DFC_QRYENG_RES_TRUNC){Ac=function(){AW.controller.undo();};}mstrmojo.error({longDesc:Ab.message},Ac,{title:"Error"});}});if(AZ&&AZ.postInfo){Aa.addCallbacks(AZ.postInfo.callback);}}function I(Aa){var Ab=this,Ad,Ac=Ab.getCurrentLayoutKey(),AV=Ab.getNodeDataByKey(Aa),AZ=Ab.createNewUnitNode(function(){return AV.data;},function(){return AV.defn;},function(){return AV;},Aa,Ac),AW=Ab.getWidgetId({k:Aa,wid:1},Ac),AX;AZ.defn.iifp=false;if(mstrmojo.all[AZ.id]){var AY=Ab.dataCache[Ac];AZ.id=Ab.adjustNodeId(AW);AY[AZ.id]=AY[AW];AX=mstrmojo.all[AW].parent;}Ad=Ab.createUnit(AZ,"",Ac);Ad.showTitleBar=false;AZ.defn.iifp=true;Ad.boxContent.srcFilterPortlet=AX;return Ad;}function h(AX){var AW=this.getCurrentLayoutKey(),AV=this.getVIComponent(AX,AW);return AV.domNode.getBoundingClientRect();}function A(AV,AY,AX){var AW=this;AY.addCallbacks({success:function(AZ,Ab){var Aa=AZ,Ac;AW.cachePrevSelectedUnitId();AW.updateDefnCache(Aa.defn,[AX]);AW.updateDataCache(Aa.data,AW.getTargetDefn(AX));Ac=AW.insertVizBox(AX,AV,{});AW.controller.rootCtrl.initPanelStautsInConfigMode();AW.selectVIUnit(Ac.id,true,{isAddAction:true});mstrApp.restoreVFKey=AX;mstrApp.isEnableSaveBtn=false;},failure:function(AZ){var Aa=null;if(AZ.code===N.DFC_QRYENG_RES_TRUNC){Aa=function(){AW.controller.undo();};}mstrmojo.error({longDesc:AZ.message},Aa,{title:"Error"});}});}function M(AZ,Ae,AX,AW,AY,Ac,Ad,AV){if(!AX){return ;}var Ab=this,Aa=AX.k;AZ.addCallbacks({success:function(Af,Ag){Ab.updateVisSelector(AX,AW,AY,Ac);Ab.updateDefnCache(Af.defn,[Aa]);Ab.updateDataCache(Af.data,Ab.getTargetDefn(Aa));Ab.destroyVisualiztionselector();Ab.controller.rootCtrl.restorePanelStatus(Ae);n.call(Ab,Af,Ag,AZ,Ae,Ad,AV,{isVisFilterAdded:true});}});}function X(Ab,AV,Aa,AZ,AY){if(!Aa){return ;}var AX=this,AW=Aa.k;Ab.addCallbacks({success:function(Ac,Ad){AX.updateDefnCache(Ac.defn,[AW]);AX.updateDataCache(Ac.data,AX.getTargetDefn(AW));n.call(AX,Ac,Ad,Ab,AV,AZ,AY);}});}mstrmojo.vi.models._FilterStackActions=mstrmojo.provide("mstrmojo.vi.models._FilterStackActions",{_mixinName:"mstrmojo.vi.models._FilterStackActions",addFilterStackSelectors:function E(Ac,Ag,AW,AV){var Af=this.getDataService(),Aa=this,Ab=this.getVIMap(),Ae=Ab.getComponent(AK),AY=[],Ad=Ag!==undefined?Ag:(Ae?Ae.getFilters().length:null),AZ=Aa.getDataService();var AX=function(){var Ah=(!Ae||AA.find(Ae.getFilterDefinitions(),"srcid",Ac[0]&&Ac[0].did)===-1);if(Ah){AV=AV||!!Ac.filter(function(Ai){return !f(Ai);}).length;Aa.execute({execute:function(){var Al=Af.newUpdate(this,{extras:D}),Ak={},Aj=Ae.contents;Al.extras.skipUICmdMgrOnFailure=[N.DFC_QRYENG_RES_TRUNC];Al.extras.config={hideFailureErr:true};Ak[Aj.k]=true;G.call(Aa,Al,AY,Ac,Ad,Ak,AW);t.call(Aa,Al,Ae,Ak,AV,AW);var Ai=Ad===null?this.mgr.CMD_PHASE.FIRST:this.mgr.CMD_PHASE.LAST;this.submitUpdate(Al,Ai);}});}};if(!Ae){AZ.submitUpdates(Aa.getShowVIStackAction(AM),{success:function(Ah,Ai){Aa.buildLoadedVIStack(AM,x,Ah,Aa.getDocBuilder());Aa.controller.view.openViPanel("filterPanel",{success:AX});Ae=Aa.getVIMap().getComponent(AK);}},{preserveUndo:true});}else{if(Ae.getOpenStatus()){AX();}else{Aa.controller.view.openViPanel("filterPanel",{success:AX});}}},pivotFilterStackSelector:function g(AX,AV,Ad){var Ac=this.getDataService(),Ab=AX.id,Aa=this.getVIMap().getComponent(AK),AY=this,AW=AV<Ad;function AZ(){var Aj=Ac.newUpdate(this,{extras:D}),Af={},Ae=this.getStateValue(AV,Ad),Ai=this.getStateValue(Ad,AV),Ah=this.getStateValue(AW,!AW),Ag;AX=mstrmojo.all[Ab];Ag=AX.defn.t===AJ.SELECTOR?AX.ckey:AX.k;Aj.addActions(AB.call(AY,Aa,Ai,Ae+(Ah?1:-1),Ah?-1:1,Af));Aj.addActions(AY.getUnitFormatAction(AX,1,AL(AF.Z_INDEX,Ai)));Af[Ag]=Ab;t.call(AY,Aj,Aa,Af);this.urInfo=this.urInfo||{};this.urInfo.callback=Aj.callback;Aj.submit();}this.execute({execute:AZ});},deleteVisFilterStackSelectors:function R(AV,AW){var Ae=this.getDataService(),Ad=this.getVIMap().getComponent(AK),AX=this,AY=Ad.model.getDataService().newUpdate(Ad),Ab=[AV.defn],Ac=AX.getRemoveUnitAction(AV),Aa=AV.node.data.sc;if(Aa){AV.ckey=AV.defn.ckey=Aa.ckey;AV.defn.tks=Aa.tks;AV.defn.ck=Aa.ck;}if(Ad.applyBufferedSlices){Ad.applyBufferedSlices(true,AY);}function AZ(){var Ah=Ae.newUpdate(this,{extras:D}),Af={};Af[Ad.contents.k]=true;H.call(this,Ah,AX,Ab,Af,AW);t.call(AX,Ah,Ad,Af);this.urInfo=this.urInfo||{};this.urInfo.callback=Ah.callback;var Ag=(AY.actions||[]).concat(Ah.actions);Ag.push(Ac);this.submit(Ag,Ah.callback,Ah.extras);}this.execute({execute:AZ});},deleteFilterStackSelectors:function c(Ab,AW){var Aa=this.getDataService(),AV=this.getVIMap().getComponent(AK),AY=this,AX=AV.model.getDataService().newUpdate(AV);if(AV.applyBufferedSlices){AV.applyBufferedSlices(true,AX);}function AZ(){var Ae=Aa.newUpdate(this,{extras:D}),Ac={};Ac[AV.contents.k]=true;H.call(this,Ae,AY,Ab,Ac,AW);t.call(AY,Ae,AV,Ac);this.urInfo=this.urInfo||{};this.urInfo.callback=Ae.callback;var Ad=(AX.actions||[]).concat(Ae.actions);this.submit(Ad,Ae.callback,Ae.extras);}this.execute({execute:AZ});},changeFilterStackSelectors:function w(Ab,AY){var Ac=this.getDataService(),AX=this,AW=this.getVIMap(),AV=AW.getComponent(AK),Aa=!!Ab.filter(function(Ad){return !f(Ad);}).length,AZ=[];this.execute({execute:function(){var Ae=Ac.newUpdate(this,{extras:D}),Ad={};Ad[AV.contents.k]=true;H.call(this,Ae,AX,AY,Ad);G.call(AX,Ae,AZ,Ab,AV.getFilters().length+1,Ad);t.call(AX,Ae,AV,Ad,Aa);if(AY.length&&Ab.length){this.submitUpdate(Ae,this.mgr.CMD_PHASE.FIRST);}else{this.submitUpdate(Ae);}}});},replaceFilterStackSelectors:function e(AZ,AY){var Aa=this.getDataService(),AV=this.getVIMap().getComponent(AK),AX=this,AW=Aa.newUpdate(AV);if(AV.applyBufferedSlices){AV.applyBufferedSlices(true,AW);}this.execute({execute:function(){var Ad=Aa.newUpdate(this,{extras:D}),Ab={};o.call(AX,Ad,AZ,AY,AV,Ab);t.call(AX,Ad,AV,Ab);this.urInfo=this.urInfo||{};this.urInfo.callback=Ad.callback;var Ac=(AW.actions||[]).concat(Ad.actions);this.submit(Ac,Ad.callback,Ad.extras);}});},buildVisFilterContainer:function Q(Aa,AZ){var AY=this,AX=AY.createNewUnitNode(null,function(Ab){Ab.t=AJ.PANEL;return Ab;},null,null,AZ),AW=Aa.builder,AV;AV=AW.build([AX],AY,{pk:Aa.k})[0];return AV;},getPanelStackForVFContainer:function W(){return Y.call(this);},addVisFilterContainer:function b(){var AW=this,AY=AW.getCurrentLayoutKey(),AX=AW.getPanelStackForVFContainer(),AV=this.buildVisFilterContainer(AX,AY);AX.selectedVisFilterContainerKey=AV.k;AX.addChildren(AV);AV.render();C.addClass(AV.domNode,["vis-filter-container"]);AX.prevSelectedKey=AX.selectedKey;AX.set("selectedKey",AV.k);return AV;},removeVizFilterUnit:function U(Aa){var AX=this,Ac=AX.getDataService(),AZ=AX.getSelectedViUnit(),AW=AZ.k,AY=AX.getRemoveUnitAction(AZ),Ab=AX.getCurrentLayoutDef().units,AV=this.getVIMap().getComponent(AK);this.execute({execute:function(){var Ah=Ac.newUpdate(AX,{extras:D}),Ad=AX.getSelectedViUnit().boxContent.id,Af={},Ae=AV.contents,Ag=mstrmojo.all[Ad];Af[Ae.k]=true;Ah.addActions(mstrmojo.array.ensureArray(AY));Ab[AW]._isDeleted=true;if(Aa===true){X.call(AX,Ah,AV,Ag,Af);}this.submitUpdate(Ah);}});},destroyVisualiztionselector:function Z(AZ,Aa,AX){AZ=AZ||this.getSelectedViUnit();var AV=AZ.boxContent,AY=AV.node,AW=this.getVisFilterContainer();AZ.boxContent.srcFilterPortlet=null;if(AW&&AZ.parent===AW){AW.removeAndDestroyChild(AZ);}else{AZ.destroy();}if(!AX){mstrApp.isInVFConfigMode=false;this.removeVisFilterContainer();}if(!Aa){this.selectVIUnit(this.oldSelectedVizBoxId,true);}AY.id=this.restoreNodeId(AY.id);AV.clearHighlightsCache();},getVisFilterContainer:function AH(){var AX=this,AW=AX.getCurrentLayoutKey(),AV=AX.getPanelStackForVFContainer().selectedVisFilterContainerKey,AY=AX.getWidgetId({k:AV,wid:1},AW);return mstrmojo.all[AY];},removeVisFilterContainer:function AT(){var AW=this,AV=this.getVisFilterContainer(),AX;if(AV){AX=AW.getPanelStackForVFContainer();AX.set("selectedKey",AX.prevSelectedKey);AX.removeAndDestroyChild(AV);AX.selectedVisFilterContainerKey=null;AX.prevSelectedKey=null;}},rebuildVizBox:function l(AV){this.destroyVisualiztionselector("",true,true);return this.insertVizBox(AV,this.getVisFilterContainer(),{});},doVisFilterLayout:function AU(AZ,AW){var AX=this.getPanelStackForVFContainer(),AV=AW.hasOwnProperty("width")?AW.width:parseInt(AX.width)-AP,AY=AW.hasOwnProperty("height")?AW.height:parseInt(AX.height)-AP;AZ.updateLayout({height:AY+"px",left:"0px",top:"0px",width:AV+"px"});},insertVizBox:function a(AX,AV,AW){var AY=I.call(this,AX);AV.addChildren([AY]);AV.domNode.style.width=AY.domNode.style.width;return AY;},addVisualizationSelector:function V(AV,AZ,AY){var AW=this,AX=AW.getDataService(),Ab=AW.getCurrentLayoutDef().units,Aa=d.keyarray(Ab).filter(function(Ac){return Ab[Ac].t===AJ.PANEL&&Ab[Ac].isFilterPanel;})[0];mstrApp.isInVFConfigMode=AZ===F.CONFIGURATION;mstrApp.isInVFInteractMode=AZ===F.INTERACTIVE;this.execute({execute:function(){var Ad=AX.newUpdate(this,{extras:D}),Ac=AW.getNextKey();Ad.addActions(AW.getAddVisActions(Aa,Ac,{style:AR.GRAPH_MATRIX,type:AS.GRAPH_MATRIX,extraFormatting:{FormattingAppearance:{Visible:1,Name:AY},FormattingView:{Title:AY}}}));A.call(AW,AV,Ad,Ac);this.submitUpdate(Ad);}});},saveVisSelectorAndExit:function r(){var AV=this.getVIMap();this.destroyVisualiztionselector();this.controller.rootCtrl.restorePanelStatus(AV.getComponent(AK));},saveVisAsSelector:function AO(){var AX=this,AY=AX.getDataService(),AW=AX.getVIMap(),AV=AW.getComponent(AK);this.execute({execute:function(){var Ag=AY.newUpdate(AX,{extras:D}),Af=AX.getNextKey(),Ae=[AW.getComponentKey(K.MAIN_CONTENT)],Ab=[],AZ=AX.getSelectedViUnit().boxContent.id,Ac={},Aa=AV.contents,Ad=mstrmojo.all[AZ];Ac[Aa.k]=true;AA.forEach(Ae,function(){Ab.push([AX.getNextKey(),true]);});Ag.addActions(AG.call(AX,Ae,Ad,Af,Ab));M.call(AX,Ag,AV,Ad,Af,Ae,Ab,Ac);this.submitUpdate(Ag);}});},getMainPanelFormatting:function AQ(){return h.call(this,K.MAIN_CONTENT);},getFilterPanelFormatting:function m(){return h.call(this,K.FILTER_STACK);},getVizBox:function AD(AW,AV){var AX=I.call(this,AW);this.doVisFilterLayout(AX,AV);return AX;},cachePrevSelectedUnitId:function AE(){var AV=this.getSelectedViUnit();if(AV){this.oldSelectedVizBoxId=AV.id;}},insertVisCtrlToolbar:function L(AV,AW){var AX=new mstrmojo.vi.ui.rw.VisFilterControlToolbar(AW);AX.render();AV.domNode.appendChild(AX.domNode);return AX;},loadHiddenFilterStack:function p(AV,AW){this.loadHiddenVIStack(AM,x,AV,AW);},getNextVisFilterTitle:function AC(){var AX=this.getCurrentLayoutDef(),AV=(AX&&AX.units)||{},AW=0;d.forEach(AV,function(AZ){var AY=AZ&&AZ.t;if(AZ&&AZ.iifp&&(AY===AJ.GRID||AY===AJ.GRAPH||AY===AJ.GRIDGRAPH||AY===AJ.VISUALIZATION||AY===AJ.MOJOVISUALIZATION)){AW++;}});return mstrmojo.desc(15290,"Visualization Filter ##").replace("##",(AW+1));},checkLargeItemsForVisFilter:function q(AW,AV){var AZ=this.getNodeDataByKey(AW),Aa=AZ&&AZ.data,AY=mstrmojo.vi.models._CheckDataCards,AX=[];if(Aa&&Aa.gts){AX=(Aa.gts.row||[]).concat(Aa.gts.col||[]);}AY.addAttributeNameAndTargetVisForAddUnits(Aa,AX);AY.checkAndWarnLargeItemsForAddUnits(AX,AV,null,false,null,true,null,function(){mstr_profile.log("Cancel Visualization Filter Rendering!");});}});}());(function(){mstrmojo.requiresCls("mstrmojo.Container","mstrmojo._ListSelections","mstrmojo.tooltip","mstrmojo.dom","mstrmojo.hash","mstrmojo.css");var Q=mstrmojo.dom,C=mstrmojo.css,R=mstrmojo.hash,K=mstrmojo.all,d=mstrmojo._HasMarkup,e="px";var D={},J=false,a;function c(){var o={mousedown:["touchstart","mousedown"],mouseup:["touchend","mouseup"],mousemove:["touchmove","mousemove"]},n;for(n in o){D[n]=J?o[n][0]:o[n][1];}}function l(o){if(this.dragging){return ;}this._moveCnt++;if(this._moveCnt>this.mousemoveBuffer){var n=document.body;Q.detachEvent(n,"mousemove",this._mousemoveCallback);Q.detachEvent(n,"mouseup",this._cancelCallback);this.initDrag(o);}}function g(o){if(this.dragging){return ;}this._moveCnt++;if(this._moveCnt>this.mousemoveBuffer){var n=document.body;Q.detachEvent(n,"touchmove",this._touchmoveCallback);Q.detachEvent(n,"touchend",this._cancelCallback);if(a){window.clearTimeout(a);}this.initDrag(o);}}function H(q){var n=document.body,p=J?"_touchmoveCallback":"_mousemoveCallback";Q.detachEvent(n,D.mousemove,this[p]);Q.detachEvent(n,D.mouseup,this._cancelCallback);if(a){window.clearTimeout(a);}var o=this.afterDragCancel;if(o){o.call(this.target,q);}}function G(t){J=true;c();Q.preventDefault(window,t);if(this.dragging){return true;}var p=this.target.id,q=document.body,o=t&&t.touches&&t.touches[0]||t;if(!this._touchmoveCallback){this._touchmoveCallback=function(u){g.call(K[p].dnd,u&&u.touches&&u.touches[0]||u);return true;};}this._moveCnt=0;this.startE=R.copy(o);Q.attachEvent(q,"touchmove",this._touchmoveCallback);if(!this._cancelCallback){this._cancelCallback=function(u){H.call(K[p].dnd,o);return true;};}Q.attachEvent(q,"touchend",this._cancelCallback);var r=this,n=o;n.type=n.name="contextmenu";a=window.setTimeout(function(){var v=r.target,w=v&&v.docSelector,u=w&&w.parent;Q.detachEvent(q,"touchmove",this._touchmoveCallback);Q.detachEvent(q,"touchend",this._cancelCallback);if(u){u.raiseEvent(d.newDomEvent("contextmenu",window,n));}},1000);return false;}function f(p){J=false;c();Q.preventDefault(window,p);if(this.dragging){return true;}var n=this.target.id,o=document.body;if(!this._mousemoveCallback){this._mousemoveCallback=function(q){l.call(K[n].dnd,q);return true;};}this._moveCnt=0;this.startE=R.copy(p);Q.attachEvent(o,"mousemove",this._mousemoveCallback);if(!this._cancelCallback){this._cancelCallback=function(q){H.call(K[n].dnd,q);return true;};}Q.attachEvent(o,"mouseup",this._cancelCallback);return false;}function E(o){var n=this.duringDrag;if(n){n.call(this.target,o);}return true;}function N(p){this.dragging=false;var n=document.body;Q.detachEvent(n,D.mousemove,this._dragCallback);Q.detachEvent(n,D.mouseup,this._dragEndCallback);var o=this.afterDragEnd;if(o){o.call(this.target,p);}return true;}function W(){if(this._mousemoveCallback){Q.detachEvent(document.body,"mousemove",this._mousemoveCallback);delete this._mousemoveCallback;}if(this._touchmoveCallback){Q.detachEvent(document.body,"touchmove",this._touchmoveCallback);delete this._touchmoveCallback;}if(this._cancelCallback){Q.detachEvent(document.body,"mouseup",this._cancelCallback);Q.detachEvent(document.body,"touchup",this._cancelCallback);delete this._cancelCallback;}if(this._dragCallback){Q.detachEvent(document.body,"mousemove",this._dragCallback);Q.detachEvent(document.body,"touchmove",this._dragCallback);delete this._dragCallback;}if(this._dragEndCallback){Q.detachEvent(document.body,"mouseup",this._dragEndCallback);Q.detachEvent(document.body,"touchmove",this._dragEndCallback);delete this._dragEndCallback;}}mstrmojo.DnDComponent=mstrmojo.declare(null,null,{scriptClass:"mstrmojo.DnDComponent",isDragging:false,initD:null,startE:null,afterDragStart:null,duringDrag:null,afterDragEnd:null,target:null,mousemoveBuffer:1,init:function V(n){R.copy(n,this);},initDrag:function k(r){this.dragging=true;var o=this.target.id,q=document.body;var t=this._dragCallback;if(!t){t=this._dragCallback=function(u){if(J){u=u&&u.touches&&u.touches[0]||u;}return E.call(K[o].dnd,u);};}Q.attachEvent(q,D.mousemove,t);var n=this._dragEndCallback;if(!n){n=this._dragEndCallback=function(u){if(J){u=u&&u.touches&&u.touches[0]||u;}return N.call(K[o].dnd,u);};}Q.attachEvent(q,D.mouseup,n);var p=this.afterDragStart;if(p){p.call(this.target,r);}this._dragCallback(r);}});function Z(n){this.getUnit=function o(){var p=n.items.length;return p>1?n._effLen/(p-1):1;};this.calcMinMax=function(r,q){var t=Math.round((r/n.unit+q/n.unit)/2);return{min:t,max:t};};this.preUpdateThumb=function(){n.start=Math.min(n.min*n.unit,n._effLen)+e;n.sdCssText=n.orCfg.posCssP+":"+n.start+";";};this.updateThumb=function(){n.containerNode.style[n.orCfg.posCssP]=n.start=Math.min(Math.round(n.min*n.unit),n._effLen)+e;};return this;}function j(n){this.getUnit=function(){return n._effLen/n.items.length;};this.calcMinMax=function(q,p){return{min:Math.floor(q/n.unit+0.5),max:Math.floor(p/n.unit-0.5)};};function o(){var p=n.min,r=n.unit;var t=n.start=(p*r)+e;var q=n.length=Math.max(Math.round((n.max-p+1)*r-n.gap),0)+e;return{st:t,len:q};}this.preUpdateThumb=function(){var q=n.orCfg,p=o();n.sdCssText=q.posCssP+":"+p.st+";"+q.lenCssP+":"+p.len+";";};this.updateThumb=function(){var q=n.orCfg,p=o(),r=n.containerNode.style;r[q.posCssP]=p.st;r[q.lenCssP]=p.len;};return this;}var F="<span>{@content}</span>";mstrmojo.Slider=mstrmojo.declare(mstrmojo.Container,[mstrmojo._ListSelections],{scriptClass:"mstrmojo.Slider",markupString:'<div id="{@id}" class="mstrmojo-Slider {@cssClass} {@clsType} {@clsOrientation}" style="{@cssText}" ><div class="cont"><div class="bk" style="{@bkCssText}"></div><div class="sdc" style="position:absolute;{@sdcCssText}" mstrAttach:mouseout><div class="sd" style="{@sdCssText}"><div class="t1"></div><div class="t2"></div><div class="t3"></div></div></div></div></div>',sdCssText:"",cssClass:"sc",clsType:"sc2",clsOrientation:"sc-v",orCfg:null,typeHelper:null,_tooltip_pos:"TL",useRichTooltip:true,init:function h(n){this._super(n);if(n.isHoriz){this.orCfg={posCssP:"left",marginCssP:"marginLeft",lenCssP:"width",lenP:"clientWidth",opPosCssP:"top",thickP:"clientHeight",offsetP:"x"};this.clsOrientation=" sc-h";this._tooltip_pos=mstrmojo.tooltip.POS_BOTTOMLEFT;}else{this.orCfg={posCssP:"top",marginCssP:"marginTop",lenCssP:"height",lenP:"clientHeight",opPosCssP:"left",thickP:"clientWidth",offsetP:"y"};this._tooltip_pos=mstrmojo.tooltip.POS_TOPRIGHT;this.titleHeight=(n.docSelector.fmts.ttl&&n.docSelector.fmts.ttl.height)?parseInt(n.docSelector.fmts.ttl.height,10):0;}this._exRoom=this.thumbWidth;if(this.multiSelect){this._exRoom*=2;}if(n.multiSelect){this.typeHelper=new j(this);}else{this.clsType="sc1";this.typeHelper=new Z(this);}},markupSlots:{dndNode:function(){return this.domNode.firstChild;},bgNode:function(){return this.domNode.firstChild.firstChild;},sdcNode:function(){return this.domNode.firstChild.lastChild;},containerNode:function(){return this.domNode.firstChild.lastChild.firstChild;},frontNode:function(){return this.domNode.firstChild.lastChild.firstChild.firstChild;},thumbNode:function(){return this.domNode.firstChild.lastChild.firstChild.childNodes[1];},endNode:function(){return this.domNode.firstChild.lastChild.firstChild.lastChild;},tooltipNode:function(){return this.domNode.firstChild.lastChild;}},markupMethods:{onvisibleChange:mstrmojo.Widget.visibleMarkupMethod,onwidthChange:function(){this.synchronizeSlider();}},start:"50px",length:"30px",min:0,max:0,gap:1,ghost:null,thumbWidth:11,cssBkBW:1,dndNode:null,synchronizeSlider:function I(){var v=this.orCfg,u=v.lenCssP,p=this[u],n=parseInt(p,10),AB=this.hasRendered,z=this.titleHeight||0;var q=this._effLen=isNaN(n)?0:(n-this._exRoom-z);if(p){var AA={};AA[u]=Math.max(parseInt(p,10)-(2*this.cssBkBW),0)-z+e;var r={};r[u]=q+e;r[v.posCssP]=Math.round(this._exRoom/2)+e;r[v.opPosCssP]="0"+e;if(AB){R.copy(AA,this.bgNode.style);R.copy(r,this.sdcNode.style);}else{this.bkCssText=C.getCssTextFromObj(AA);this.sdcCssText=C.getCssTextFromObj(r);}}var AD=this.selectedIndices;if(!R.isEmpty(AD)){var x=this.items.length,t=-1,AC=-1,w;for(w=0;w<x;w++){if(AD[w]){if(t<0){t=w;}AC=w;}else{if(t>-1){break;}}}this.min=t;this.max=AC;}var o=this.typeHelper;this.unit=o.getUnit();if(AB){o.updateThumb();}else{o.preUpdateThumb();}},preBuildRendering:function A(){this.synchronizeSlider();},postBuildRendering:function U(){this._super();if(this.items.length>1){var n=this.dnd=new mstrmojo.DnDComponent({target:this});var o=this.id;this.__mouseDownEvt=function(p){Q.stopPropogation(window,p);f.call(K[o].dnd,p);return true;};Q.attachEvent(this.dndNode,"mousedown",this.__mouseDownEvt);if(Q.supportsTouches){this.__touchstartEvt=function(p){Q.stopPropogation(window,p);G.call(K[o].dnd,p);return true;};Q.attachEvent(this.dndNode,"touchstart",this.__touchstartEvt);}n.afterDragStart=this.initDrag;n.duringDrag=this.ondrag;n.afterDragEnd=this.ondrop;n.afterDragCancel=this.cancelDrag;}},initDrag:function k(t,n){n=n||window;var r=this.configureGhost(true),o=this.orCfg,q=this.dnd,p=q.startE;q.initD={tP:parseInt(this.start,10),sL:this._effLen,contL:r.containerNode[o.lenP],offset:Q.getMousePosition(p,n)[o.offsetP],td:Q.eventTarget(n,p)};},configureGhost:function b(o){var q=this.ghost;if(!q){var t=this.containerNode.cloneNode(true),r=t.childNodes;C.addClass(t,"gh");t.style.display="none";q=this.ghost={containerNode:t,frontNode:r[0],thumbNode:r[1],endNode:r[2]};this.sdcNode.appendChild(t);}var p=this.ghost.containerNode.style,n=this.orCfg;R.copyProps([n.posCssP,n.lenCssP],this.containerNode.style,p);if(o){p.display="block";}return q;},ondrag:function O(w,v){v=v||window;var x=this.dnd.initD,r=this.ghost.containerNode,AC,p,n,u=this.min,z=this.max,t=this.orCfg,o=t.lenCssP,AB=t.posCssP;var AA=Q.getMousePosition(w,v)[t.offsetP]-x.offset;switch(x.td){case this.thumbNode:AC=Math.max(Math.min(x.tP+AA,x.sL-x.contL),0);p=AC+x.contL;r.style[AB]=AC+e;var q=this.typeHelper.calcMinMax(AC,p);u=q.min;z=q.max;break;case this.frontNode:AC=Math.max(Math.min(x.tP+AA,x.tP+x.contL),0);n=Math.max(Math.min(x.contL-AA,x.tP+x.contL),0);r.style[AB]=AC+e;r.style[o]=n+e;u=Math.min(Math.floor(AC/this.unit+0.5),this.max);break;case this.endNode:n=Math.max(Math.min(x.contL+AA,x.sL-x.tP),0);p=x.tP+n;r.style[o]=n+e;z=Math.max(Math.floor(p/this.unit-0.5),this.min);break;default:return ;}if(u!==this.min||z!==this.max){this.min=u;this.max=z;this.typeHelper.updateThumb();}this._updateTooltip();},ondrop:function Y(){this.typeHelper.updateThumb();var r=this.ghost;if(r){r.containerNode.style.display="none";}this.hideTooltip();var t=this.dnd&&this.dnd.initD;if(this.makeSelection&&t){this.makeSelection({selItem:t.td});}var n=this.items;if(n&&n.length){var p=[],o;for(o=this.min;o<=this.max;o++){var q=n[o];if(q){p.push(o);}}this.select(p);}this.dnd.initD=null;},cancelDrag:function M(o,n){if(this.makeSelection){this.makeSelection({selItem:Q.eventTarget(n||window,this.dnd.startE)});}},showTooltip:function m(o,n){this.configureGhost(false);this._updateTooltip(o,n);this._super(o,n);},hideTooltip:function P(o,n){if(this.dnd&&this.dnd.dragging){return ;}this._super(o,n);},_updateTooltip:function S(){var v=this.orCfg,w={contentNodeCssClass:"sc-tooltip",refNode:this.domNode,posType:this._tooltip_pos},o=(this.ghost)?this.ghost.containerNode:this.containerNode;w[v.opPosCssP]=0;w[v.posCssP]=o.style[v.posCssP];w.content="";var t=this.items,q=t.length;if(t&&q){var n=(t[this.min]||t[0]),p=this.getItemTooltip(n),r=p;if(this.min!==this.max){var u=(t[this.max]||t[q-1]);r=mstrmojo.desc(146,"From:")+" '"+p+"' "+mstrmojo.desc(2665,"To:")+" '"+this.getItemTooltip(u)+"'";}w.content=F.replace(/\{@content\}/g,r);}this.set("richTooltip",w);},getItemTooltip:function X(n){var o=n?n.n:"";return"'"+(o.length>20?o.slice(0,20)+"...":o)+"'";},unrender:function B(o){this.ghost=null;this.hideTooltip();this.min=0;this.max=(this.items&&this.items.length-1)||0;var p=this.dndNode,q=this.__mouseDownEvt,n=this.__touchstartEvt;if(q&&p){Q.detachEvent(p,"mousedown",q);}if(n&&p){Q.detachEvent(p,"touchstart",n);}W.call(this);this._super(o);},onselectionChange:function L(){var n=this.selectedIndices,o=R.isEmpty(n);if(n){this.set("max",o?this.items.length-1:R.max(n,false,true));this.set("min",o?0:R.min(n,false,true));if(this.typeHelper){this.typeHelper.updateThumb();}}if(this.onchange){this.onchange();}}});mstrmojo.Slider.SINGLE_HANDLE_WIDTH=11;mstrmojo.Slider.SCROLLHANDLEWIDTH=11;}());(function(){mstrmojo.requiresCls("mstrmojo.string","mstrmojo.dom","mstrmojo.css","mstrmojo.array","mstrmojo.tooltip");var E=mstrmojo.dom,D=mstrmojo.string,F=mstrmojo.hash,H=mstrmojo.array,C=mstrmojo.tooltip;mstrmojo.ui._HasListTooltip=mstrmojo.provide("mstrmojo.ui._HasListTooltip",{_mixinName:"mstrmojo.ui._HasListTooltip",tooltipOrientation:"horizontal",tooltipOffset:8,tooltipMarkup:'<div class="content" style="{@style}">{@c}</div>',tooltipCss:{},tooltipContrast:false,getTooltipText:function A(I){return I&&(D.encodeHtmlString(I.ttp,true)||D.encodeHtmlString(I.n,true));},showTooltip:function G(a,N){var Q=this;if(!Q.hasOpenTooltip&&!(Q._lastOpened&&Q._lastOpened.visible)){var g=E.eventTarget(N,a),b=Q.getItemFromTarget(g),V=Q.getItemNodeFromTarget(g),j=Q.getTooltipText(b),P=Q.tooltipCss;if(!j||b.ttpDisabled){return ;}if(Q.showTooltipForLargeText){if(V.offsetWidth>=V.scrollWidth){return ;}}var h=E.position(V),Z,R,L,X="",Y=Q.tooltipOffset,O=(b&&b.ctxt)||{};if(this.tooltipOrientation==="vertical"){Z=h.x+h.w/2;L=O.posType||C.POS_TOPCENTER;R=h.y+h.h+Y;var M="mojo-theme-light vi-regular vi-tooltip-A";if(!O.posType){M+=" A-center";}Q.tooltipCss=F.copy({cssClass:M},P);}else{var K=E.windowDim(),W=40,c=h.x+h.w+Y,J=h.x-Y,f=J-W,I=K.w-(c+W),d="vi-regular vi-tooltip-",U;R=h.y;if(I>=f){Z=c;U=I;L=O.posType||C.POS_TOPLEFT;P.cssClass=d+"C "+P.rightCssClass;}else{Z=J;U=f;L=O.posType||C.POS_TOPRIGHT;P.cssClass=d+"D "+P.leftCssClass;}X="max-width: "+U+"px;";}if(Q.tooltipContrast){P.cssClass=P.cssClass+" contrast";}if(P&&P.getItemCssClass){P.cssClass=H.filter([P.cssClass,P.getItemCssClass(b)],function(e){return !!e;}).join(" ");}var S=Q.richTooltip=F.copy(Q.tooltipCss,{content:D.apply(Q.tooltipMarkup,{c:j,style:X}),top:R,left:Z,posType:L});if(Q.itemDisabled){S.cssClass+=" vi-warning";}if(O.hoverable){S.enableHover=true;}if(O.posType==="TL"){S.left=h.x;}S.keepArrowXPos=!!Q.keepArrowXPos;S.keepArrowYPos=!!Q.keepArrowYPos;this._super(a,N);}},onclick:function B(I){var J=this;window.setTimeout(function(){if(J.hasOpenTooltip){J.hideTooltip();}window.clearTimeout(J._tooltipTimeOut);},0);this._super(I);}});}());(function(){mstrmojo.requiresCls("mstrmojo.locales","mstrmojo.tooltip","mstrmojo.dom","mstrmojo.css","mstrmojo.array","mstrmojo.hash","mstrmojo.string");mstrmojo.requiresDescs(11038,11935,11936,11937,11856,11938,13138,13230,13260,14633,14636);var C=mstrmojo.hash.copy,P=mstrmojo.css,J=mstrmojo.dom,N=mstrmojo.array,E=mstrmojo.string,Q=function Q(W,U){if(!W){return ;}var S=U&&U.length||0,V;for(V=S;V>0;V--){W=W.replace(new Array(V+2).join("#"),U[V-1]);}return W;},L=function L(U){if(!U){return ;}var a=this,W=J.position(U.refNode||a.refNode),Z=J.position(a.domNode),Y=U.position||R.RIGHT,V=0,b=0,S=9+(U.margin!==undefined?U.margin:0),X=" ";switch(Y){case R.TOP:b=-Z.h-S;X+="t";break;case R.BOTTOM:b=W.h+S;X+="b";break;case R.LEFT:V=-Z.w-S;X+="l";break;case R.RIGHT:V=W.w+S;X+="r";break;}mstrmojo.hash.forEach(C(U,{left:V,top:b,contentNodeCssClass:X,visible:false}),function(c,d){this[d]=c;},this);this.set("visible",U.invalid);},A=function A(S){var X=this,V,W=S.errorCode,Y=S.errorMsg,U=S.args,Z=mstrmojo.vi.ui.rw.selectors.EnumWarningMessages;if(S.invalid){V={content:W!==null?(X.generateContentHTML(Q(Z[W],U))||Z["*"]):Y};}return V;};mstrmojo.vi.ui.rw.selectors.EnumWarningMessages=C(mstrmojo.locales.validation,{"*":mstrmojo.desc(11038,"Invalid"),invalidValueVIWarning:mstrmojo.desc(11935,"Invalid characters"),emptyValueVIWarning:mstrmojo.desc(11936,"Please enter a number"),notIntegerVIWarning:mstrmojo.desc(11937,"Please enter an integer"),outOfRangeVIWarning:mstrmojo.desc(11856,"Please enter value between ## and ###."),noMultiSelectionVIWaring:mstrmojo.desc(11938,"This selector does not support multiple selections."),continuousSelectionVIWaring:mstrmojo.desc(13138,"This selector does not support non-continuous selections."),bigDecimalMetricSliderVIWaring:mstrmojo.desc(13230,"Cannot qualify on big decimal value. Please change qualification type to Rank"),unableDisplaySelectionVIWarning:mstrmojo.desc(13260,"Filter cannot display actual selections."),imageSizeExceedLimitVIWarning:mstrmojo.desc(14633,"Cannot embed an image larger than ##MB. Your image is still ###MB after compression. Enter a URL to the image instead."),imageFileTypeNotSupportedVIWarning:mstrmojo.desc(14636,"Invalid image format. Please use .png, .jpg, .jpeg, .gif or .bmp."),imageOverSizeNoCompessionVIWarning:mstrmojo.desc(14665,"Cannot embed an image larger than ##MB. Enter a URL to the image instead.")});mstrmojo.vi.ui.rw.selectors.EnumWarningPosition={TOP:1,BOTTOM:2,LEFT:3,RIGHT:4};var R=mstrmojo.vi.ui.rw.selectors.EnumWarningPosition;mstrmojo.vi.ui.rw.selectors._HasWarningMessage=mstrmojo.provide("mstrmojo.vi.ui.rw.selectors._HasWarningMessage",{_mixinName:"mstrmojo.vi.ui.rw.selectors._HasWarningMessage",warningSlotName:"warning",showWarning:function G(V){var Z=this,b=Z.warningSlotName,d=Z[b],S=V&&V.lasting||6000,Y=V.refNode||this.domNode,U=V.highlight!==false,c=V.closeOnClick===false?false:true,a;if(!d){d=new mstrmojo.Tooltip({refNode:Y,highlight:U,closeOnClick:c,updatePopupConfig:null,cssClass:"vi-warning vi-tooltip-V"});Z.addDisposable(d);Z[b]=d;a=Z.closeOnClick=Z.getCloseOnClickListener();J.attachEvent(document.body,"click",a);}var X=V.position||R.TOP,W="vi-warning vi-tooltip-";switch(X){case R.TOP:d.cssClass=W+"V";break;case R.BOTTOM:d.cssClass=W+"A";break;case R.LEFT:d.cssClass=W+"D";break;case R.RIGHT:d.cssClass=W+"C";break;}d.open(Z,A.call(Z,V));this.adjustPosition(V);if(U){P.toggleClass(d.refNode,"mstrmojo-Warning",true);}window.clearTimeout(Z._warningTimeOut);Z._warningTimeOut=window.setTimeout(function(){Z.hideWarning();},S);},hideWarning:function H(){var U=this,S=U[U.warningSlotName];if(S&&S.visible&&S.close){if(S.highlight){P.toggleClass(S.refNode,"mstrmojo-Warning",false);}S.close();window.clearTimeout(U._warningTimeOut);delete U._warningTimeOut;}},getCloseOnClickListener:function I(){var S=this;return function(){var U=S[S.warningSlotName];if(U.closeOnClick){S.hideWarning();}};},adjustPosition:function M(S){var U=this;L.call(U[U.warningSlotName],S);},generateContentHTML:function D(S){return E.encodeHtmlString(S,true);},bindWarningHandler:function F(){N.forEach(arguments,function S(V){if(!V||!V.attachEventListener){return ;}var W=V._validationEventListener,U;if(W){V.detachEventListener(W);delete V._validationEventListener;}U=this.getValidationEvtListener();if(U){V._validationEventListener=V.attachEventListener("validationChange",this.id,U);}},this);},getValidationEvtListener:function B(){var U=this;return function S(V){var W=V.value;U[(W&&W.invalid?"show":"hide")+"Warning"](W);};},unrender:function K(S){var U=this[this.warningSlotName];if(U){U.unrender();}this._super(S);},destroy:function O(S){J.detachEvent(document.body,"click",this.closeOnClick);return this._super(S);}});}());(function(){mstrmojo.requiresCls("mstrmojo.dom","mstrmojo.Widget","mstrmojo.tooltip","mstrmojo.string","mstrmojo.array");var O=0,I=mstrmojo.array,B=mstrmojo.string;function P(){var V=this.textNode,X=this.imgNode;if(this.eg!=null){X.style.display="none";V.innerHTML=this.eg||"";V.style.display="block";this.domNode.style.display=(this.visible&&this.eg.length>0)?"block":"none";}else{V.style.display="none";this.domNode.style.display=this.visible?"block":"none";X.style.display="block";if(this.tooltip){X.setAttribute("ttl",this.tooltip);}var W=this.getFormats();this.retrieveGraphSrc(W.height,W.width);}}var U={6:"poly",7:"rect",100:"circle"};function H(){var e=this.as,a=e&&e.length;if(!a){return ;}var Z=this.id,d=Z+"_map"+O++,X=[],c=-1,Y;for(Y=0;Y<a;Y++){var W=e[Y];W.id=Z;W.aid=Y;W.tooltip=B.multiReplace(W.tooltip||"",{"&#13":"<br />","&#32":" ",'"':"&quot;"});if(!isNaN(W.shape)){W.shape=this.getAreaShapeName(W.shape);}if(!mstrApp.isDossier&&(W.tks||W.tks===""||W.tty===1)){W.extra=' href="#" ';}X[++c]=B.apply(this.areaMarkup,W);}var b='<map id="'+d+'" name="'+d+'">'+X.join("")+"</map>";if(!this.domNode){this.att='usemap="#'+d+'" ';this.map=b;}else{var V=document.createElement("div");V.innerHTML=b;if(this.mapNode){V=V.firstChild;this.mapNode.innerHTML=V.innerHTML;}else{this.imgNode.setAttribute("usemap","#"+d);this.mapNode=this.domNode.appendChild(V.firstChild);}}}var A=mstrmojo.GraphBase=mstrmojo.declare(mstrmojo.Widget,null,{scriptClass:"mstrmojo.GraphBase",cssClassPrefix:"mstrmojo-GraphBase",markupString:'<div id="{@id}" class="{@cssClassPrefix} {@cssClass}" title="{@tooltip}" style="{@domNodeCssText};"><div class="{@cssClassPrefix}-txt"></div><img {@att}src="../images/1ptrans.gif" class="{@cssClassPrefix} {@cssImageClass}" hidefocus="true" />{@map}</div>',att:"",map:"",cAreaIdx:-1,useRichTooltip:true,markupSlots:{imgNode:function J(){return this.domNode.childNodes[1];},mapNode:function F(){return this.domNode.childNodes.length>2?this.domNode.childNodes[2]:null;},textNode:function M(){return this.domNode.firstChild;}},markupMethods:{onvisibleChange:function K(){this.domNode.style.display=(this.visible)?"block":"none";}},preBuildRendering:function C(){H.call(this);return this._super();},postBuildRendering:function Q(){P.call(this);return this._super();},setModel:function L(V){this.model=V;},updatingTooltipHelper:function R(Z,j,d){var W=Z&&Z.getAttribute("aid"),V=Z&&Z.getAttribute("ttl"),Y=Z.getAttribute("SC"),b={refNode:this.domNode,posType:mstrmojo.tooltip.POS_BOTTOMLEFT,contentNodeCssClass:"gp-tooltip"},h=(this.model.getZoomFactor?this.model.getZoomFactor():(this.model.docModel?this.model.docModel.getZoomFactor():1))+"em";if(W==this.cAreaIdx){return ;}this.cAreaIdx=W;b.content=V||this.defaultTooltip;var X="font-size:"+h+";";if(Y){X+="border-color:#"+Y;}b.contentNodeCssText=X;var e=Z.getAttribute("coords"),g=99999,f=99999;if(!d){if(e&&e.length>0){e=e.split(",");var a=0;while(a+1<e.length){g=Math.min(g,parseInt(e[a++],10));f=Math.min(f,parseInt(e[a++],10));}}}if(g===99999){g=j.x;}if(f===99999){f=j.y;}b.top=f;b.left=g;this.richTooltip=null;this.set("richTooltip",b);},redraw:function N(){if(!this.hasRendered){return false;}P.call(this);var V=this.getFormats();if(this.as&&V.height&&V.width){this.refreshMap();}return true;},refreshMap:function G(){if(this.as){H.call(this);}},getAreaShapeName:function D(V){return U[parseInt(V,10)]||"default";}});var S=A.tooltipCLS="mstrmojo-mobileGraph-Tooltip-content",E=A.canvasCLS="mobile-graph-highlight-canvas";A.hideTooltips=function(){I.forEach(document.getElementsByClassName(S),function(V){V.style.display="none";});I.forEach(document.getElementsByClassName(E),function(V){V.getContext("2d").clearRect(0,0,V.width,V.height);V.width=V.width;});};}());(function(){mstrmojo.requiresCls("mstrmojo.ui.editors.controls.ThreeColumnContainer");mstrmojo.kpicard.editors.KPICardThresholdHeaderControl=mstrmojo.declare(mstrmojo.ui.editors.controls.ThreeColumnContainer,null,{scriptClass:"mstrmojo.kpicard.editors.KPICardThresholdHeaderControl",postBuildRendering:function A(){if(this._super){this._super();}var D=this.col3Node,C=D&&D.style,B=this.col2Node,E=B&&B.firstChild,F=E&&E.style;if(C){C["float"]="right";}if(F){F.marginTop="0px";}}});}());(function(){mstrmojo.requiresCls("mstrmojo.string","mstrmojo.ui._HasScroller","mstrmojo.Box","mstrmojo._HasLayout","mstrmojo._Formattable","mstrmojo.Label","mstrmojo.Button","mstrmojo.dom","mstrmojo.TextBox");mstrmojo.requiresDescs(1442,10493,14552);var F=mstrmojo.string,E=mstrmojo.dom;function D(){var I=this.parent.parent;this.imgURL.onfocus=function(){I.hideLinkButton();};this.imgURL.onblur=function(){I.unhideLinkButton();};}mstrmojo.vi.ui.rw.ImageBoxOverlay=mstrmojo.declare(mstrmojo.Box,[mstrmojo._HasLayout,mstrmojo._Formattable,mstrmojo.ui._HasScroller],{scriptClass:"mstrmojo.vi.ui.rw.ImageBoxOverlay",cssClass:"mstrmojo-ImageBoxOverlay",init:function H(I){if(this._super){this._super(I);}D.call(this);},setupScrollNodes:function B(){this.scrollNode=this.containerNode;},layoutConfig:{h:{containerNode:"100%"},w:{containerNode:"100%"}},formatHandlers:{domNode:["BG"]},hasChanged:function A(){var J=this.imgURL,K=J&&J.domNode,I=K&&K.value;if(K&&(K.scrollWidth>K.clientWidth||!I)){J.set("tooltip",I||(this.parent.parent.isEmbeddedImageFeatureEnabled?mstrmojo.desc(14552,"Enter an image URL or choose a file."):mstrmojo.desc(10493,"Image URL")));}else{J.set("tooltip","");}},imageBox:undefined,imgURL:undefined,origURLStr:undefined,onimgURLChange:function C(){D.call(this);},children:[{scriptClass:"mstrmojo.Label",slot:"labelNode",cssClass:"init-label"},mstrmojo.Button.newWebButton(mstrmojo.desc(1442,"OK"),function(){var I=this.parent;if(I.imgURL.value!==I.origURLStr){I.imageBox.urlEdited(I.imgURL.value);}else{I.imageBox.hideControlOverlay();}},true,{alias:"okBtn",slot:"buttonNode",enabled:false}),{scriptClass:"mstrmojo.TextBox",cssClass:"init-input",alias:"imgURL",slot:"textNode",bindings:{hint:function(){if(this.parent.parent.parent.isEmbeddedImageFeatureEnabled){return mstrmojo.desc(14552,"Enter an image URL or choose a file.");}else{return mstrmojo.desc(10493,"Image URL");}}},onkeydown:function(I){if(I.e.keyCode===13){var J=this.parent;if(J.imgURL.value!==J.origURLStr){J.imageBox.urlEdited(this.value);}else{J.imageBox.hideControlOverlay();}}},onmousedown:function(I){E.stopPropogation(I.hWin,I.e);},onblur:function(I){this.parent.hasChanged();},getLayoutOffsets:function G(){return{h:0,w:2};},_set_value:function(L,I){var J=this.value;if(J!==I){this.value=I;var K=this.parent.okBtn;K.set("enabled",!F.isEmpty(I));}}}]});}());(function(){mstrmojo.requiresCls("mstrmojo.css","mstrmojo.dom","mstrmojo.TextBox");var A=mstrmojo.css,C=mstrmojo.dom;mstrmojo.TextArea=mstrmojo.declare(mstrmojo.TextBox,null,{scriptClass:"mstrmojo.TextArea",markupString:'<textarea id="{@id}" class="mstrmojo-TextArea {@cssClass}"  style="{@cssText}" title="{@tooltip}" placeholder="{@placeholderText}" rows="{@rows}" cols="{@cols}" maxlength="{@maxLength}" index="{@tabIndex}" mstrAttach:focus,keydown,keyup,blur></textarea>',maxLength:256,onkeydown:function B(K){var I=this.inputNode,J=this.value,E=this.maxLength,F=(J&&J.length)||0,M=K.e,L=M.keyCode;this.isDeleteKeys=L===8||L===46;this.isArrowKeys=L===37||L===38||L===39||L===40;if(E!==undefined&&E<=F){var G=I.selectionEnd,H=(G!==undefined)?(G-I.selectionStart)>0:document.selection.createRange().text.length>0;if(!this.isDeleteKeys&&!this.isArrowKeys&&!H){if(C.isIE7||C.isIE8||C.isIE9){I.blur();window.setTimeout(function(){I.focus();},1);}C.preventDefault(window,M);return false;}}}});mstrmojo._HasMarkup.addMarkupMethods(mstrmojo.TextArea,{oncssClassChange:function D(){A.addClass(this.domNode,this.cssClass||"");}});})();(function(){mstrmojo.requiresCls("mstrmojo.TextBox","mstrmojo.hash");var A="mstrmojo-TextBoxWithLabel";mstrmojo.TextBoxWithLabel=mstrmojo.declare(mstrmojo.TextBox,null,{scriptClass:"mstrmojo.TextBoxWithLabel",label:"",rightLabel:"",cssDisplay:"inline",type:"text",markupString:'<div class="'+A+' {@cssClass}" style="{@cssText}"><span class="mstrmojo-TextBox-label">{@label}</span><input id="{@id}" class="mstrmojo-TextBox {@inputNodeCssClass}"  style="{@inputNodeCssText}" title="{@tooltip}" type="{@type}" size="{@size}" maxlength="{@maxLength}" index="{@tabIndex}" mstrAttach:focus,keyup,blur/><span class="mstrmojo-TextBox-label-right">{@rightLabel}</span></div>',markupSlots:{inputNode:function(){return this.domNode.firstChild.nextSibling;},lblNode:function(){return this.domNode.firstChild;}}});mstrmojo.TextBoxWithLabel.prototype.markupMethods=mstrmojo.hash.copy({oncssClassChange:function(){var B=this.cssClass;this.domNode.className=A+(B?" "+B:"");},onlabelChange:function(){this.lblNode.innerText=this.label||"";}},mstrmojo.hash.copy(mstrmojo.TextBoxWithLabel.prototype.markupMethods));}());(function(){mstrmojo.requiresCls("mstrmojo.DocLayoutViewer","mstrmojo._Formattable","mstrmojo._TouchGestures","mstrmojo._HasTouchScroller","mstrmojo.dom");function J(f){var g,W=this._newLinks,e=mstrmojo.hash.copy(W,this._allLinks),g=f?e:W;this._newLinks={};if(mstrMobileApp.isOnline()){return ;}var Y=this.controller,X,b,Z=[],h=[],c;for(X in g){b=g[X];c=Y.getLinkRequest(b);if(c){Z.push(c);h.push(b);}}var a=Z.length;if(a){var d=function(j){for(X=0;X<a;X++){b=h[X];b.src.setLinkEnabled(j[X]);}};if(mstrApp.isHosted()){}else{this.model.getDataService().checkCachedLinkTargets(Z,{success:d,failure:mstrmojo.emptyFn});}}}function D(){var Y=this.children,X,W;for(X=0,W=(Y&&Y.length)||0;X<W;X++){var a=Y[X],Z=a.slot;if(Z){this.setSlotDimensions(Z,a.height,a.width);}}}mstrmojo.MobileDocLayoutViewer=mstrmojo.declare(mstrmojo.DocLayoutViewer,[mstrmojo._TouchGestures,mstrmojo._HasTouchScroller],{scriptClass:"mstrmojo.MobileDocLayoutViewer",layoutConfig:{h:{groupBy:"0",fixedHeaderNode:"auto",layout:"100%",fixedFooterNode:"auto",incFetchNode:"0"},w:{layout:"100%"}},formatHandlers:{domNode:["background-color"]},scrollerConfig:{vScroll:false,hScroll:false,bounces:false,showScrollbars:false},usesTouches:true,init:function O(W){this._super(W);this._newLinks={};this._allLinks={};},postBuildRendering:function U(){this._super();if(this.fixedFooterNode.clientHeight>0){D.call(this);}},preBuildRendering:function B(){this._super();this._scrollCssText="overflow:"+((!mstrmojo.dom.isWinPhone)?"hidden":"auto");var X=this.id,W=this.updateScroller;if(!this.afterScrollSubscr){this.afterScrollSubscr=this.docLayout.attachEventListener("afterScroll",X,function(){this.updateScroller();J.call(this);});this.model.attachEventListener("partialUpdate",X,W);}},mapID:null,setMapID:function I(W){this.mapID=W;},beforeViewHidden:function E(W){if(!this.mapID){return ;}var X=mstrmojo.all[this.mapID];if(X&&X.beforeViewHidden){X.beforeViewHidden(W);}this.mapID=null;},updateScrollerConfig:function R(){var X=this.scrollerConfig,Z=this.docLayout.containerNode;if(Z){var b=this.docLayout,Y={start:0,end:Math.max(b.getWidth()-this.scrollboxWidth,0)},d={start:0,end:Math.max(b.getHeight()-this.scrollboxHeight,0)},W=(d.start!==d.end),a=(Y.start!==Y.end),c;if(W||a){c={x:Y,y:d};}else{X.origin={x:0,y:0};}mstrmojo.hash.copy({scrollEl:this.scrollboxNode.firstChild,offset:c,vScroll:W,hScroll:a,showScrollbars:false},X);if(!X.origin){X.origin=this._origin={x:0,y:0};}b.scrollBuffer=parseInt(mstrApp.rootView.getContentDimensions().h,10);}return this._super();},initScroller:function M(W){this._super(W);W.attachEventListener("scrollDone",this.id,function(X){this._origin={x:X.x,y:X.y};this.notifyScrollListeners(X);});},touchBegin:function N(X){var W=this.parent;if(W&&W.isAnimating&&W.isAnimating()){X.stop();return false;}return this._super(X);},shouldTouchBubble:function K(W){if(mstrmojo.dom.contains(this.scrollboxNode,W.target,true,this.domNode)){return this._super(W);}return true;},touchSwipeBegin:function L(Y){if(this.shouldTouchBubble(Y)){var X=this.parent,W=X.canScroll&&X.canScroll(Y);if(W){this._parentScrolling=true;X.beginScroll(Y);}return W;}this._super(Y);},touchSwipeMove:function A(W){if(this._parentScrolling){this.parent.scroll(W);return ;}this._super(W);},touchSwipeEnd:function P(W){W.evt.handled=true;if(this._parentScrolling){delete this._parentScrolling;this.parent.endScroll(W);return ;}this._super(W);},touchTap:function S(){var W=this.controller;if(W&&W.viewTap){W.viewTap();}},renderChildren:function F(){this._super();this.updateScroller();},unrender:function Q(){delete this.scrollerConfig.origin;var W=this._scroller;if(W){delete W.origin;}if(this.subscr){mstrmojo.publisher.unsubscribe(this.subscr);delete this.subscr;}if(this.afterScrollSubscr){mstrmojo.publisher.unsubscribe(this.afterScrollSubscr);delete this.afterScrollSubscr;}this._super();},addLinkInfo:function H(X,W){this._newLinks[X]=W;},onRender:function C(){this._super();if(!this.subscr){var X=mstrmojo.publisher;this.subscr=X.subscribe(X.NO_SRC,X.CONNECTIVITY_CHANGED_EVENT,function(b){if(b){var Y=this._allLinks,Z,a;for(Z in Y){a=Y[Z].src;if(!a.linkEnabled){a.setLinkEnabled(true);}}}else{J.call(this,true);}},this.id);}if((mstrApp.useBinaryFormat||mstrApp.isHosted())&&!mstrMobileApp.isOnline()){var W=this;window.setTimeout(function(){J.call(W);},100);}},setSlotDimensions:function V(d,c,Z){if(d==="layout"){var Y=parseInt(this.height,10),X=this.fixedHeaderNode.clientHeight,b=this.fixedFooterNode.clientHeight,W=parseInt(c,10),a=Y-X-b;if(X+b>=Y){c=0;}else{if(W!=a){c=a+"px";}}}this._super(d,c,Z);},getCaptureDimensions:function G(){return this.docLayout.getCaptureDimensions();}});}());(function(){mstrmojo.requiresCls("mstrmojo.SearchWidget","mstrmojo.hash","mstrmojo.array","mstrmojo.css","mstrmojo.elementHelper","mstrmojo.mstr.EnumDSSXMLObjectTypes");var L=mstrmojo.hash,I=mstrmojo.array,a=mstrmojo.css,Y=mstrmojo.elementHelper,b=mstrmojo.mstr.EnumDSSXMLObjectTypes;var W=1,G=2147762227,X=2147762262,F=2147762269;mstrmojo.vi.ui.rw.selectors._CanSearchOnServer=mstrmojo.provide("mstrmojo.vi.ui.rw.selectors._CanSearchOnServer",{_mixinName:"mstrmojo.vi.ui.rw.selectors._CanSearchOnServer",searchBlockSize:500,expressionXML:"",browseFlags:1,getSourceDefn:mstrmojo.emptyFn,getDataService:mstrmojo.emptyFn,init:function Q(c){this._super(c);this.clearSearchItems();},execSearchOnServer:function J(h,f,g){var j=this.id,e=this.getDataService(),d=this.getSourceDefn();if(e&&d&&!this.isSearching){var c=d.srct===b.Consolidation;this.set("isSearching",true);e.browseControlElements({searchPattern:h,blockBegin:f,blockCount:g,attributeId:d.srcid,expressionXML:this.expressionXML,dataSourcesXML:d.dsrc,datasetId:d.dsid,controlKey:d.ckey,searchForms:d.fs||d.sfs,browseFlags:this.browseFlags,objectType:d.srct,useClientForm:c},{success:function(m){var n=mstrmojo.all[j],l=m.did||d.srcid;if(m){var k=Y.buildElemsTerseID(m.es,l,true)||[];n.onSearchSuccess(k,{attributeId:l,blockBegin:f,blockCount:g,size:m.sz});}},failure:function(l){var m=mstrmojo.all[j],k=parseInt(l.code,10)+4294967296;if(k!==G&&k!==X&&k!==F){mstrmojo.alert(l.message);}m.onSearchFailure();},complete:function(){var k=mstrmojo.all[j];k.set("isSearching",false);}},{hideFailureErr:true});}},onSearchSuccess:function K(d,e){var c=this.loadItems,f=c.length;this.loadItems=c.concat(d);this.loadCompleted=f+d.length>=e.size;this.renderFilteredItems(f);},onSearchFailure:function R(){this.loadCompleted=true;this.renderFilteredItems();},renderFilteredItems:function M(g){var e=this.loadItems,c=this.itemsContainerNode;if(e&&c){var d=this.items,f;this.items=e;f=this._buildItemsMarkup(g||0,e.length-1,this._markupPrefix&&this._markupPrefix(),this._markupSuffix&&this._markupSuffix(),this._itemPrefix&&this._itemPrefix(),this._itemSuffix&&this._itemSuffix()).join("");this.items=d;c.innerHTML=(g>0?c.innerHTML:"")+f;}if(this.updateScrollbars){this.updateScrollbars();}},renderOriginalItems:function A(){var d=this.itemsContainerNode,c=this.renderOnScroll?(this.renderIndex+1)*this.renderBlockSize:this.items.length;if(c){d.innerHTML=this._buildItemsMarkup(0,c-1,this._markupPrefix&&this._markupPrefix(),this._markupSuffix&&this._markupSuffix(),this._itemPrefix&&this._itemPrefix(),this._itemSuffix&&this._itemSuffix()).join("");}if(this.updateScrollbars){this.updateScrollbars();}},onScrollEnd:function B(){var e=this.pattern,d=this.scrollNode,c=this.loadItems.length;if(d&&this.isOnSearch()){if(d.offsetHeight+Math.ceil(d.scrollTop)>=d.scrollHeight&&!this.loadCompleted){this.execSearchOnServer(e,c+W,this.searchBlockSize);}}if(this._super){this._super();}},_set_pattern:function C(e,c){var d=this.pattern=c;this.clearSearchItems();if(d.length>0){this.execSearchOnServer(d,W,this.searchBlockSize);}else{this.renderOriginalItems();}return true;},onisSearchingChange:function O(c){var e=c.value,d=this.searchbox;if(d){var f=d.inputNode,g=d.clearNode;if(f){f.disabled=e;}if(g){a.toggleClass(g,"show",!e);}}},getSearchbarCfg:function N(){return{scriptClass:"SearchWidget",placeholder:this.searchboxNode,onsearch:function d(e){this.parent.set("pattern",e);},onclear:function c(){this.parent.set("pattern","");}};},postBuildRendering:function V(){var c=this.getSearchbarCfg(),f=c.placeholder,d=this.searchbox,e=L.walk(c.scriptClass,mstrmojo);if(f){if(!d){delete c.scriptClass;c.parent=this;d=new e(c);this.searchbox=d;}d.placeholder=f;d.render();}if(this.isOnSearch()){d.setSearchPattern(this.pattern);this.renderFilteredItems();}return this._super();},unrender:function U(d){var c=this.searchbox;if(c){c.unrender(d);}return this._super(d);},getItemFromTarget:function Z(e){if(this._super){if(this.isOnSearch()){var d=this.items,c;this.items=this.loadItems;c=this._super(e);this.items=d;return c;}return this._super(e);}return undefined;},isOnSearch:function H(){return this.pattern&&this.pattern.length>0;},getSearchItems:function E(){return this.loadItems;},updateSearchItems:function D(c){if(I.isArray(c)){this.loadItems=c;}},clearSearch:function S(){this.pattern="";this.clearSearchItems();},clearSearchItems:function P(){this.loadItems=[];this.loadCompleted=false;}});}());(function(){mstrmojo.requiresCls("mstrmojo.Table","mstrmojo.SelectBox","mstrmojo._CanValidate","mstrmojo.MetricSelectorUtility");var D=mstrmojo.MetricSelectorUtility,K=mstrmojo.validation,G=mstrmojo.expr,E=mstrmojo.num,N=D.OP,F=[{n:mstrmojo.desc(2795,"Equals"),v:N._EQUALS},{n:mstrmojo.desc(2796,"Does not equals"),v:N._NOT_EQUALS},{n:mstrmojo.desc(521,"Greater than"),v:N._GREATER},{n:mstrmojo.desc(522,"Greater than or equal to"),v:N._GREATER_EQUAL},{n:mstrmojo.desc(523,"Less than"),v:N._LESS},{n:mstrmojo.desc(524,"Less than or equal to"),v:N._LESS_EQUAL},{n:mstrmojo.desc(519,"Between (enter value1;value2)"),v:N._BETWEEN},{n:mstrmojo.desc(614,"Not between (enter value1;value2)"),v:N._NOT_BETWEEN},{n:mstrmojo.desc(898,"In (enter value1;value2; ...;valueN)"),v:N._IN},{n:mstrmojo.desc(2394,"Not In (enter value1;value2; ...;valueN)"),v:N._NOT_IN},{n:mstrmojo.desc(2202,"Is null"),v:N._IS_NULL},{n:mstrmojo.desc(2203,"Is not null"),v:N._IS_NOT_NULL}],L=F.slice(0,10),J="padding:2px 2px 2px 2px",H=F.slice(10,12);var C=function(a,S,U,W,V){var X;if(V===2){return S;}var b=String(a).split(";"),Y=K.STATUSCODE.INVALID_VALIDATOR,R=K.STATUSCODE.VALID;if(W&&b&&b.length>1){S.code=Y;}else{for(X=0;X<b.length;X++){var Z=parseFloat(b[X],10);if(isNaN(Z)||(U&&((b[X].match(/^\d+(\.\d+)?%$/)===null&&b[X].match(/^\d+(\.\d+)?$/)==null)||Z<0||Z>100))||(!U&&b[X].match(/\d+$/)===null)){S.code=Y;}if(S.code!==R){break;}}}if(S.code!==R){S.msg=mstrmojo.desc(6103,"Please fix any invalid data");}return S;};var M=function(R){R=parseFloat(R);return isNaN(R)?"54px":((R*72/16)+"pt;");},Q=function(U){if(U.hasRendered){var S=U.domNode.style;S.font=U.font;S.width=M(S.fontSize);}else{var R=U.font.match(/[^\s]*?pt/)||[];U.cssText=U.cssText+" font:"+U.font+"; width:"+M(R[0]);}},I=function(R){if((R>=8&&R<=16)||(R>=23&&R<=25)){return false;}return true;};mstrmojo.MetricQualification=mstrmojo.declare(mstrmojo.Table,null,{scriptClass:"mstrmojo.MetricQualification",cssClass:"qs",cssText:"width:100%",markupMethods:{onvisibleChange:function(){this.domNode.style.display=this.visible?mstrmojo.css.DISPLAY_TABLE:"none";}},getClientHeight:function P(){return this.domNode.clientHeight+2;},rows:1,cols:4,layout:[{cells:[{cssText:"width:100%"},{cssText:"width:56px"},{cssText:"width:56px"},{cssText:"width:18px"}]}],init:function(R){if(this._super){this._super(R);}this._init();},_init:function(U){var S;switch(this.qua){case 0:this.low=(this.da&&this.da.low)||0;this.high=(this.da&&this.da.high)||0;break;case 1:case 2:this.low=1;this.high=(this.da&&this.da.cnt)||0;break;case 3:case 4:this.low=0;this.high=100;break;}if(U){this.cs=[];this.f=this.ft=null;}var W=D.getOpIdxByfunc(this.f,this.ft),V=I(this.dt)?N._GREATER_EQUAL:N._IS_NULL;this.set("opId",(W==-1)?V:W);var R=(this.cs&&this.cs.length>0)?E.toLocaleString(this.cs[0].v):"";if(this.opId===N._IN||this.opId===N._NOT_IN){for(S=1;S<this.cs.length;S++){R+=";"+E.toLocaleString(String(this.cs[S].v));}}else{this.set("cs2",(this.cs&&this.cs.length>1)?E.toLocaleString(this.cs[1].v):"");}this.set("cs1",R);this.vldTbL.validate();this.vldTbH.validate();this.changeQual=false;},updateData:function B(R,S){this.da=R;this.updateExpr(S);},updateExpr:function A(R){if(R){this.cs=R.cs;this.f=R.f;this.ft=R.ft;this.qua=R.qua;}this._init();},onquaChange:function O(R){this._init(true);this.func.items=(this.qua!==0)?L:I(this.parent.dt)?F:H;this.func.refresh();this.changeQual=true;this.onchange();},children:[{slot:"0,0",alias:"func",scriptClass:"mstrmojo.SelectBox",cssText:"width:100%",size:1,bindings:{sv:"this.parent.opId",font:"this.parent.font"},onfontChange:function(){if(this.hasRendered){this.domNode.style.font=this.font;}else{this.cssText="width:100%;font:"+this.font;}},onsvChange:function(){if(this.sv!==null&&this.sv!==undefined){this.set("selectedItem",{v:this.sv});}},postCreate:function(){if(mstrmojo.dom.isIE){this.itemDisplayField="n";this.showItemTooltip=true;}this.items=(this.parent.qua!==0)?L:I(this.parent.dt)?F:H;},onchange:function(){var S=this.parent,U=this.selectedItem;if(U&&U.v!==null&&U.v!==undefined){var R=D.getIncludeByOp(U.v);S.include=R;if(S.parent&&R!==S.parent.include){S.changeInclude=true;}else{S.changeInclude=false;}S.set("opId",U.v);}if(mstrApp.isMobile&&(U.v===N._IS_NULL||U.v===N._IS_NOT_NULL)){if(S.onchange){S.onchange();}}}},{slot:"0,1",alias:"vldTbL",scriptClass:"mstrmojo.ValidationTextBox",required:true,dtp:G.DTP.VARCHAR,constraints:{trigger:K.TRIGGER.ALL,validator:function(R){var S={id:this.id,code:K.STATUSCODE.VALID,msg:""},U=this.parent;C(R,S,(U.qua===3||U.qua===4),(U.opId!==8&&U.opId!==9),(U.numFmts&&U.numFmts.cat));return S;}},bindings:{visible:"this.parent.opId!=10&&this.parent.opId!=11",value:"this.parent.cs1",font:"this.parent.font"},onfontChange:function(){Q(this);},onValid:function(){var S=this.parent,R=this.domNode;S.set("cs1",this.value);if(R&&R.value.length>6){R.title=R.value;}else{if(R){R.title="";}}},onvisibleChange:function(){if(!this.visible){this.parent.set("cs1","");}},onkeyup:function(S){var R=S.hWin,W=S.e||R.event,V=this.parent,U=S.src.domNode;if(W.keyCode===13&&V.apply&&V.apply.enabled){V.apply.onclick();}}},{slot:"0,2",alias:"vldTbH",scriptClass:"mstrmojo.ValidationTextBox",required:true,dtp:G.DTP.VARCHAR,constraints:{trigger:K.TRIGGER.ALL,validator:function(R){var S={id:this.id,code:K.STATUSCODE.VALID,msg:""},U=this.parent;C(R,S,(U.qua===3||U.qua===4),(U.opId!==8&&U.opId!==9),(U.numFmts&&U.numFmts.cat));return S;}},bindings:{visible:"this.parent.opId ==7 ||this.parent.opId ==6",value:"this.parent.cs2",font:"this.parent.font"},onfontChange:function(){Q(this);},onValid:function(){this.parent.set("cs2",this.value);var R=this.domNode;if(R&&R.value.length>6){R.title=R.value;}else{if(R){R.title="";}}},onvisibleChange:function(){if(!this.visible){this.parent.set("cs2","");}},onkeyup:function(S){var R=S.hWin,V=S.e||R.event,U=this.parent;if(V.keyCode===13&&U.apply&&U.apply.enabled){U.apply.onclick();}}},{slot:"0,3",alias:"apply",title:mstrmojo.desc(2164,"Apply"),scriptClass:"mstrmojo.Button",cssClass:"icn apply",bindings:{enabled:"(!this.parent.vldTbL.visible ||!this.parent.vldTbL.validationStatus.code)&& (!this.parent.vldTbH.visible||!this.parent.vldTbH.validationStatus.code)"},onclick:function(){var U=this.parent,X=(U.qua===D.Q._PT||U.qua===D.Q._PB),R;U.cs=[];var V=function(Y){return Y+((X&&!String(Y).match(/^\d+%$/))?"%":"");};var S=function(Y,Z){return((Y===2||Y===3)&&Z===0)?14:5;};if(U.opId===N._IN||U.opId===N._NOT_IN){var W=String(U.cs1).split(";");for(R=0;R<W.length;R++){if(!mstrmojo.string.isEmpty(W[R])){U.cs.push({dtp:5,v:V(W[R])});}}}else{if(U.vldTbL.visible){U.cs.push({dtp:S((U.numFmts&&U.numFmts.cat),U.qua),v:V(U.cs1)});}if(U.vldTbH.visible){U.cs.push({dtp:S((U.numFmts&&U.numFmts.cat),U.qua),v:V(U.cs2)});}}if(U.onchange){U.onchange();}if(U.makeSelection){U.makeSelection();}}}]});}());(function(){mstrmojo.requiresCls("mstrmojo.Box","mstrmojo.ui.editors._HostsControls","mstrmojo._HasLayout","mstrmojo.css");mstrmojo.ui.editors.controls.ControlGroup=mstrmojo.declare(mstrmojo.Box,[mstrmojo.ui.editors._HostsControls,mstrmojo._HasLayout],{scriptClass:"mstrmojo.ui.editors.controls.ControlGroup",layoutConfig:{w:{containerNode:"100%"},xt:true},shouldPropagateEnabled:true,init:function A(B){this._super(B);mstrmojo.css.addWidgetCssClass(this,"ctrl-group");}});mstrmojo._HasMarkup.addMarkupMethods(mstrmojo.ui.editors.controls.ControlGroup,{onenabledChange:mstrmojo.Container.enabledMarkupMethod});}());(function(){mstrmojo.requiresCls("mstrmojo.Label","mstrmojo.Box","mstrmojo._HasTooltip");var D=mstrmojo.dom;mstrmojo.ui.LabelWithIconTooltip=mstrmojo.declare(mstrmojo.Box,[mstrmojo._HasTooltip],{scriptClass:"mstrmojo.ui.LabelWithIconTooltip",markupString:'<div id="{@id}" class="mstrmojo-IconLabel {@cssClass}" style="{@cssText}" ttp="{@tooltip}"><span class="mstrmojo-Label" style="">{@text}</span><span class="{@iconCss}" style=""></span></div>',markupSlots:{labelNode:function(){return this.domNode.firstChild;},iconNode:function(){return this.domNode.lastChild;}},text:"",iconCss:"",tooltip:"",useRichTooltip:true,shouldShowTooltip:function B(F,H){var G=F.target||D.eventTarget(F.hWin,F.e);return G===this.iconNode;},getTooltipContent:function A(F){var G=F.target||D.eventTarget(F.hWin,F.e);return this.tooltip||G.getAttribute("ttp");},updateTooltipConfig:function C(G){var H=G.target||D.eventTarget(G.hWin,G.e),F=D.position(H);if(!this.richTooltip){this.richTooltip={posType:mstrmojo.tooltip.POS_TOPRIGHT,content:this.getTooltipContent(G),top:F.y+F.h,left:F.x+10,cssClass:"vi-regular vi-tooltip-D no-arrow",};}},showTooltip:function E(F,G){if(this.shouldShowTooltip(F,G)){this._super(F,G);}}});})();(function(){mstrmojo.requiresCls("mstrmojo.Widget","mstrmojo.Box","mstrmojo.css");var A=mstrmojo.css;mstrmojo.vi.ui.rw.VisFilterIndicator=mstrmojo.declare(mstrmojo.Box,null,{scriptClass:"mstrmojo.vi.ui.rw.VisFilterIndicator",cssClass:"VisFilterIndicator",init:function D(F){var G=F.unitContainer.domNode,E=G.style;if(G){if(F.hasOwnProperty("width")===false){F.width=(E&&E.width)||(G.clientWidth+"px");}if(F.hasOwnProperty("left")===false){F.left=G.offsetLeft+"px";}if(F.hasOwnProperty("top")===false){F.top=(G.offsetTop)+"px";}}this._super(F);this.placeholder=G.appendChild(document.createElement("div"));},children:[{scriptClass:"mstrmojo.Label",slot:"containerNode",alias:"lblTitle",text:mstrmojo.desc(15297,"Items selected in configuration mode will not be applied to visualization filter.")}],postBuildRendering:function(){this._super();var F=this.domNode,E=this;F.style.left=this.left;F.style.top=this.top;if(!this.animationListener){var G=this.animationListener=function(H){if(H.animationName==="indicatorout"){A.addClass(F,"hidden");E.destroy();}};A.onAnimationEnd(F,G);}},updateDimension:function C(){if(this.hasRendered&&!this.destroyed&&this.unitContainer){var E=this.unitContainer.domNode;if(E){this.set("width",(E.style.width||(E.clientWidth+"px")));}}},destroy:function B(){if(this.animationListener){this.animationListener=null;}this._super();}});}());(function(){mstrmojo.requiresCls("mstrmojo.Box","mstrmojo._IsPopup","mstrmojo._CanAutoClose","mstrmojo.ui.PopupConfig","mstrmojo.css");mstrmojo.ui.editors.ToolbarPopup=mstrmojo.declare(mstrmojo.Box,[mstrmojo._IsPopup,mstrmojo._CanAutoClose],{scriptClass:"mstrmojo.ui.editors.ToolbarPopup",popupConfig:null,anchorElement:null,autoCloses:false,locksHover:true,init:function B(C){this._super(C);mstrmojo.css.addWidgetCssClass(this,"mstrmojo-ui-ToolbarPopup");this.popupConfig=new mstrmojo.ui.PopupConfig({isHostedWithin:false,hostProxyCssClass:(mstrApp&&mstrApp.getThemeClassName())||"",anchorElement:this.anchorElement});},open:function A(D,C){D.closePopup();this._super(D,C);}});}());(function(){mstrmojo.requiresClsP("mstrmojo","Button","Box","vi.ui.CalculationWidget","mstr.EnumFunction");mstrmojo.requiresDescs(221,358,1422,2122,6017,5868,5869);var C=mstrmojo.desc,B=mstrmojo.mstr.EnumFunction,I=4,E=5,H=6,F=7;var D={SINGLE:[{n:C(358,"Absolute"),v:B.FunctionAbs}],PAIR:[{n:C(6017,"Add"),v:B.FunctionAdd},{n:C(2122,"Average"),v:B.FunctionAverage},{n:C(5868,"Least"),v:B.FunctionLeast},{n:C(5869,"Greatest"),v:B.FunctionGreatest},{n:"A-B",v:B.FunctionMinus+";0"},{n:"B-A",v:B.FunctionMinus+";1"},{n:"A/B",v:B.FunctionDivide+";0"},{n:"B/A",v:B.FunctionDivide+";1"}],MORE:[{n:C(6017,"Add"),v:B.FunctionAdd},{n:C(2122,"Average"),v:B.FunctionAverage},{n:C(5868,"Least"),v:B.FunctionLeast},{n:C(5869,"Greatest"),v:B.FunctionGreatest}]};mstrmojo.vi.ui.CalculationMenuEditor=mstrmojo.declare(mstrmojo.Box,null,{scriptClass:"mstrmojo.vi.ui.CalculationMenuEditor",onSubmenuOpen:function G(){var P=this.parent,O=P.de,Q=O&&O.es,J=(Q&&Q.length)||P.cellsNum,L=(J===1)?"SINGLE":((J===2)?"PAIR":"MORE"),N=D[L],K=(O&&O.func)||P.func,M,R;if(L==="PAIR"){if(O){N[I].n=Q[0].n+" - "+Q[1].n;N[E].n=Q[1].n+" - "+Q[0].n;N[H].n=Q[0].n+" / "+Q[1].n;N[F].n=Q[1].n+" / "+Q[0].n;}else{R=this.xtab.selCells;N[I].n=R[0].innerText+" - "+R[1].innerText;N[E].n=R[1].innerText+" - "+R[0].innerText;N[H].n=R[0].innerText+" / "+R[1].innerText;N[F].n=R[1].innerText+" / "+R[0].innerText;}}this.checkList.set("items",N);for(M in N){if(typeof N[M].v==="string"&&N[M].v.indexOf(K)===0&&N[M].v.indexOf(";0")>0){this.checkList.set("selectedItem",N[M]);break;}if(N[M].v===K){this.checkList.set("selectedItem",N[M]);break;}}},applyCalculation:function A(L){var K=this.xtab,J=this.parent;if((J.de&&J.de.func===L)||(typeof L==="string"&&L.indexOf(J.de.func)===0&&L.indexOf(";0")>0)){return ;}if(this.parent.isEdit===true){K.editDECalculation(J.node,L);}else{K.derivedElementCalculation(J.node,L);}this.onSubmenuClosed();},children:[{scriptClass:"mstrmojo.vi.ui.CalculationWidget",alias:"checkList"}]});}());(function(){mstrmojo.requiresCls("mstrmojo.Box","mstrmojo._HasOwnAvatar","mstrmojo.css","mstrmojo.dom");var E=mstrmojo.css,D=mstrmojo.dom;function F(K){var L=K.src.node,M=this.children.filter(function(N){return D.contains(N.domNode,L,true,this.domNode);});return M[0];}function J(K){var N=K.tgt,W=this.children,R=D.getMousePosition(N.e,N.hWin),Q,S,V,M,U,P,L=R.y;for(var O=W.length-1;O>=0;O--){V=W[O];Q=D.position(V.domNode);U=Q.h;M=Q.y;P=M+U/2;if(P<L&&(O===W.length-1||L<=M+U)){S=O;break;}else{if((O===0||M<L)&&L<=P){S=O-1;break;}}}return S;}function I(K){return K===-1?"top":"bottom";}mstrmojo.threshold.ThresholdRowPanel=mstrmojo.declare(mstrmojo.Box,[mstrmojo._HasOwnAvatar],{scriptClass:"mstrmojo.threshold.ThresholdRowPanel",dropZone:true,draggable:true,restrictedToAxis:"y",avatarCssClass:"threshold-drag-avatar",getDragData:function H(K){return{row:F.call(this,K)};},createAvatar:function B(M,L){var K=L.src.data.row.domNode.cloneNode(true);K.style.left=D.position(this.domNode).x+"px";return K;},isDragValid:function G(K){var L=K.getCtxtDragData().row;return !(this.children.length===1||!L||L.draggableNode!==K.src.node)||this._super(K);},ondragstart:function(K){this._super(K);this.removeChildren(K.getCtxtDragData().row);},ondragmove:function A(M){var O=M.getCtxtDragData(),N=this.children,L=J.call(this,M);var K=O.lastRowIdx;if(K!==L){if(K!==undefined){E.removeClass(N[Math.max(K,0)].domNode,I(K));}E.addClass(N[Math.max(L,0)].domNode,I(L));O.lastRowIdx=L;}this._super(M);},ondragend:function C(L){var M=L.src.data,K=M.lastRowIdx;if(K!==undefined){E.removeClass(this.children[Math.max(K,0)].domNode,I(K));}this._super(L);this.parent.parent.model.moveThreshold(L.getCtxtDragData().row.idx,K+1);}});}());(function(){mstrmojo.requiresCls("mstrmojo.Box","mstrmojo.string","mstrmojo.ListBase","mstrmojo._IsList");var G=",",F=mstrmojo.string;mstrmojo.TableLayoutList=mstrmojo.declare(mstrmojo.ListBase,[mstrmojo._IsList],{scriptClass:"mstrmojo.TableLayoutList",cssClass:"mstrmojo-TableLayoutList",styleCssClass:"",itemIdField:"v",allowUnlistedValues:false,tableLayoutCssStyle:"auto",multiSelect:false,titleItems:null,items:null,itemsPerRow:0,getLeftEndTitle:function E(H){return"";},getRightEndTitle:function D(H){return"";},getTitleRowMarkup:function A(){var L=this.titleItems;if(L){var K='<tr><td class="left_text">'+this.getLeftEndTitle(-1)+"</td>",H=L.length,J=0,I;for(J;J<H;J++){I=L[J];K+='<td class="item_title" title="'+I+'">'+I+"</td>";}K+='<td class="left_text">'+this.getRightEndTitle(-1)+"</td></tr>";return K;}return"";},_markupPrefix:function(){return'<table class="tableLayoutList" style="table-layout:'+this.tableLayoutCssStyle+'" cellspacing="0" cellpadding="0"><tbody>'+this.getTitleRowMarkup();},_markupSuffix:function(){return"</tbody></table>";},getItemMarkup:function(L,I){var K='<{@tag} class="item {@cls}" idx="{@idx}" title="{@en@n}" style="{@style}">{@en@n}</{@tag}>',H=this.getLeftEndTitle(I),J=this.getRightEndTitle(I),M=this.itemsPerRow;H='<td class="left_text" title="'+H+'">'+H+"</id>";J='<td class="right_text" title="'+J+'">'+J+"</id>";if(M>0){K=(I%M===0?"<tr>"+H:"")+"<td>"+K+"</td>"+((I+1)%M===0?J+"</tr>":"");}else{K='<td><div class="item_wrapper" idx="'+I+'">'+K+"</div></td>";if(!I){K="<tr>"+H+K;}else{if(I===this.items.length-1){K=K+J+"</tr>";}}}return K;},_getItemNode:function(H){var I=this.itemsNode,K=this.itemsPerRow,J=(this.titleItems?1:0)+((K>0)?parseInt(H/K,10):0),L=1+((K>0)?(H%K):H);return I.rows[J].cells[L].firstChild;},init:function(H){this._super(H);mstrmojo.css.addWidgetCssClass(this,this.styleCssClass);},onchange:function B(){var J,I=[];if(!this.multiSelect){J=this.selectedItem.v;}else{var H;for(H in this.selectedIndices){I.push(this.items[H].v);}J=I.join(this.delim||G);}this.set("value",J);},postBuildRendering:function C(){this._super();var H=[];if(this.multiSelect){var J=this.value.split(G),I;for(I=0;I<J.length;I++){H.push({v:J[I]});}}else{H.push({v:this.value});}this.setSelectedItems(H);}});}());(function(){mstrmojo.requiresCls("mstrmojo.Box","mstrmojo.ui._HasScroller","mstrmojo.css");var B=mstrmojo.css;mstrmojo.ui.ColumnContainer=mstrmojo.declare(mstrmojo.Box,[mstrmojo.ui._HasScroller],{scriptClass:"mstrmojo.ui.ColumnContainer",markupString:'<div id="{@id}" class="mstrmojo-ui-ColumnContainer {@cssClass}"><div></div></div>',markupSlots:{containerNode:function(){return this.domNode.firstChild;},scrollNode:function(){return this.domNode.firstChild;}},markupMethods:{onnextChange:function A(){B.toggleClass(this.domNode,"hasNext",!!this.next);}},active:false,next:null,idx:undefined,updateColumnContainer:function D(){var E=this.next;if(E){E.updateColumnContainer();}},onactiveChange:function C(){B.toggleClass(this.domNode,"active",this.active);var E=this.next;if(E){E.updateColumnContainer();}}});}());(function(){mstrmojo.requiresCls("mstrmojo.Box","mstrmojo._HasLayout","mstrmojo.css","mstrmojo.array");mstrmojo.vi.ui.PanelContents=mstrmojo.declare(mstrmojo.Box,[mstrmojo._HasLayout],{scriptClass:"mstrmojo.vi.ui.PanelContents",layoutConfig:{w:{containerNode:"100%"},xt:true},slot:"containerNode",init:function B(C){this._super(C);mstrmojo.css.addWidgetCssClass(this,"mstrmojo-VIPanelContents");},setDimensions:function A(D,C){this.set("width",C);(this.children||[]).forEach(function(H){var F=H.getLayoutOffsets&&H.getLayoutOffsets(),G=(F&&F.w)||0,E=parseInt(C,10)-G+"px";if(H.setDimensions){H.setDimensions("auto",E);}else{H.set("width",E);}});}});}());(function(){mstrmojo.requiresCls("mstrmojo.Label","mstrmojo.Box","mstrmojo.hash");var C=mstrmojo.css,F=mstrmojo.hash,B="mstrmojo-st-removeFilter";mstrmojo.express.ui.SubmenuEditor=mstrmojo.declare(mstrmojo.Box,null,{scriptClass:"mstrmojo.express.ui.SubmenuEditor",contentScriptClass:"mstrmojo.Box",contentConfig:null,menuItemNode:undefined,contentNode:undefined,init:function E(G){this.children[1].scriptClass=G.contentScriptClass;F.copy(G.contentConfig||{},this.children[1]);this._super(G);this.children[0].text=this.text;this.contentNode.onSubmenuOpen=this.contentNode.onSubmenuOpen||mstrmojo.emptyFn;C.addWidgetCssClass(this,"mstrmojo-SubmenuEditor");},_set_xtab:function(H,G){this.contentNode.xtab=G;return true;},_set_cell:function(H,G){this.contentNode.cell=G;return true;},_set_visible:function(H,G){this.menuItemNode.set("visible",G);this.contentNode.set("visible",false);return true;},children:[{scriptClass:"mstrmojo.Widget",alias:"menuItemNode",markupString:'<div class="mstrmojo-MenuItem-text" mstrAttach:click><div class="mstrmojo-MenuItem-textNode">{@text}</div><div class="mstrmojo-MenuItem-arw"></div></div>',onclick:function(){var G=this.parent.contentNode;G.set("visible",!G.visible);}},{scriptClass:"mstrmojo.Box",alias:"contentNode",cssClass:"mstrmojo-SubmenuItem-content",visible:false,onSubmenuClosed:function D(){this.set("visible",false);mstrmojo.all[this.parent.parentID].close();},onvisibleChange:function A(){var G=this.visible;if(G){this.onSubmenuOpen();}C.toggleClass(document.getElementById(this.parent.parentID),B,G);}}]});}());(function(){mstrmojo.requiresCls("mstrmojo.Box","mstrmojo._HasLayout","mstrmojo.css");var B=mstrmojo.css;mstrmojo.vi.ui.editors.EditorGroup=mstrmojo.declare(mstrmojo.Box,[mstrmojo._HasLayout],{scriptClass:"mstrmojo.vi.ui.editors.EditorGroup",layoutConfig:{w:{containerNode:"100%"},xt:true},markupMethods:{onvisibleChange:mstrmojo.Widget.visibleMarkupMethod,onenabledChange:mstrmojo.Container.enabledMarkupMethod},showDivider:true,isNested:false,isContainer:false,init:function D(E){this._super(E);B.addWidgetCssClass(this,["mstrmojo-vi-EditorGroup","ctrl-group"]);},preBuildRendering:function A(){var E=[];if(this.showDivider){E.push("divide");}if(this.isContainer){E.push("container");}if(E.length){B.addWidgetCssClass(this,E);}return this._super();},getLayoutOffsets:function C(){return{h:0,w:this.isNested?0:18};}});}());(function(){mstrmojo.requiresCls("mstrmojo.Box","mstrmojo._HasLayout");mstrmojo.ui.LayoutBox=mstrmojo.declare(mstrmojo.Box,[mstrmojo._HasLayout],{scriptClass:"mstrmojo.ui.LayoutBox",layoutConfig:{h:{containerNode:"100%"},w:{containerNode:"100%"},xt:true}});}());(function(){mstrmojo.requiresCls("mstrmojo.ui.PopupWidget","mstrmojo.ui.menus._IsMenuPopup","mstrmojo.css");mstrmojo.ui.menus.MenuPopup=mstrmojo.declare(mstrmojo.ui.PopupWidget,[mstrmojo.ui.menus._IsMenuPopup],{scriptClass:"mstrmojo.ui.menus.MenuPopup",popupConfig:null,init:function B(E){this._super(E);var C=this.popupConfig;if(!C.contents){throw new Error("Cannot open popup without contents.");}var D=["mstrmojo-ui-MenuPopup"],F=C.cssClass;if(F){D.push(F);}if(C.hasToggleItem){D.push("hasToggleItem");}mstrmojo.css.addWidgetCssClass(this,D);this.addChildren(C.contents);},shouldPropagateLockHover:function A(){return false;}});}());(function(){mstrmojo.requiresCls("mstrmojo.ui.PopupButton","mstrmojo._HasLayout");mstrmojo.ui.editors.controls.PreviewButton=mstrmojo.declare(mstrmojo.ui.PopupButton,[mstrmojo._HasLayout],{scriptClass:"mstrmojo.ui.editors.controls.PreviewButton",markupString:'<div id="{@id}" class="mstrmojo-ui-PreviewButton {@cssClass}" style="{@cssText}"><div class="cf" mstrAttach:click><div class="preview"></div><div class="btn">&nbsp;</div></div><div class="host"></div></div>',markupSlots:{previewNode:function(){return this.domNode.firstChild.firstChild;},btnNode:function(){return this.domNode.firstChild.lastChild;},widgetHostNode:function(){return this.domNode.lastChild;},clickableNode:function(){return this.domNode.firstChild;}},markupMethods:{onvisibleChange:mstrmojo.Widget.visibleMarkupMethod},layoutConfig:{h:{previewNode:"100%",btnNode:"100%",widgetHostNode:"0px"},w:{previewNode:"100%",btnNode:"20px",widgetHostNode:"all"},xt:true},isHostedWithin:false,getLayoutOffsets:function B(){return{h:2,w:2};},anchorSlot:"clickableNode",updatePreview:function C(){throw new Error(this.scriptClass+" must implement updatePreview.");},getPopupHostNode:function A(){return this.widgetHostNode;}});}());(function(){mstrmojo.requiresCls("mstrmojo.DocPanel","mstrmojo.css");var C=mstrmojo.css;mstrmojo.ExpressDocPanel=mstrmojo.declare(mstrmojo.DocPanel,null,{scriptClass:"mstrmojo.ExpressDocPanel",preBuildRendering:function B(){if(this.getFormats().overflow==="auto"){C.addWidgetCssClass(this,"scroll");}return this._super();},renderChildren:function A(){if(this._isFP()&&this.children){this.children.sort(function(E,D){var F=function(G){return(G&&G.defn&&G.defn.fmts&&G.defn.fmts.p_fmts&&G.defn.fmts.p_fmts["z-index"])||0;};return parseInt(F(E))>parseInt(F(D))?1:-1;});}return this._super();}});}());(function(){mstrmojo.requiresCls("mstrmojo.DocPanel","mstrmojo._HasLayout","mstrmojo.vi.ui.rw._SavesChildPositions");var A="100%";mstrmojo.vi.ui.rw.DocVIMainPanel=mstrmojo.declare(mstrmojo.DocPanel,[mstrmojo._HasLayout,mstrmojo.vi.ui.rw._SavesChildPositions],{scriptClass:"mstrmojo.vi.ui.rw.DocVIMainPanel",layoutConfig:{h:{containerNode:A},w:{containerNode:A},xt:true}});}());(function(){mstrmojo.requiresCls("mstrmojo.rw.DocSubsection","mstrmojo.vi.ui.rw._SavesChildPositions","mstrmojo._HasLayout");mstrmojo.vi.ui.rw.DocSubsection=mstrmojo.declare(mstrmojo.rw.DocSubsection,[mstrmojo._HasLayout,mstrmojo.vi.ui.rw._SavesChildPositions],{scriptClass:"mstrmojo.vi.ui.rw.DocSubsection",alias:"docSubSection",formatHandlers:null,layoutConfig:{h:{containerNode:"100%"},w:{containerNode:"100%"},xt:true}});}());(function(){mstrmojo.requiresCls("mstrmojo.rw.DocSubsection","mstrmojo._CanGrowOrShrink","mstrmojo.boxmodel");mstrmojo.DocSubsection=mstrmojo.declare(mstrmojo.rw.DocSubsection,[mstrmojo._CanGrowOrShrink],{scriptClass:"mstrmojo.DocSubsection",postBuildRendering:function D(){var H=this.defn;if(H.hc||H.vc){var F=this.domNode,J=this.getFormats(),K=this.id,I=J.height,G=J.width;H.attachEventListener("resized",K,function(){var M=J.height,L=J.width;if(M){F.style.height=M;}if(L){F.style.width=L;}});H.attachEventListener("adjustSize",K,function(N){var M=F.style,L=M.height;if(H.hc&&M.width!==G){M.width=G;}if(H.vc&&M.height!==I){M.height=I;}this.performCanGrowCanShrink(this.children);N.heightReduced=(parseInt(L,10)>parseInt(M.height,10));});}return this._super();},onchildRenderingChange:function B(H){this._super(H);if(this.renderMode!=="scroll"){var F=this.parent.slot,G=F==="fixedHeaderNode"||F==="fixedFooterNode";this.performCanGrowCanShrink([(H&&H.src)||H],G);}},portalMaximized:function C(){var I=this.defn,J=I.vc,G=I.hc;if(!G&&!J){return{};}delete I.vc;delete I.hc;delete I.ck;var H=this.getFormats(),F=this.model,N=this.domNode,K=this;var L={HideIfEmpty:-1};var M=function(R,P,Q){var S=R.toLowerCase(),O=parseInt(N.style[S],10);P=((P===undefined)?O:Math.max(parseInt(P,10),O))+"px";if(H[S]!==P){H[S]=P;L[R]=mstrmojo.boxmodel.px2Inches(F.getZoomProps(),P);delete K["_fixed"+R];}Q=Q||"";L["Max"+R]=0;L["CanGrow"+Q]=0;L["CanShrink"+Q]=0;};if(J){M("Height",H.normHeight);}if(G){M("Width",H.normWidth,"Horizontal");}I.raiseEvent({name:"resized"});return L;},adjustSectionSize:function A(){var F=this.defn;if(F.vc||F.hc){return F.raiseEvent({name:"adjustSize"});}return null;},refresh:function E(){if(!this.hasRendered){return ;}var G=this.children||[],F=G.length-1;for(F;F>=0;F--){if(G[F].refresh){G[F].refresh();}}}});}());(function(){mstrmojo.requiresCls("mstrmojo.rw.DocLayout","mstrmojo._Formattable","mstrmojo._HasWaitIcon","mstrmojo.dom");mstrmojo.DocLayout=mstrmojo.declare(mstrmojo.rw.DocLayout,[mstrmojo._Formattable,mstrmojo._HasWaitIcon],{scriptClass:"mstrmojo.DocLayout",formatHandlers:{domNode:["B","background-color","D","min-height","width"]},markupMethods:{onminHeightChange:function(){var N=this.minHeight;if(!N){var M=this.getFormats();N=M&&M["min-height"];}if(N){this.containerNode.style[mstrmojo.css.MINHEIGHT]=N;}}},getHeight:function E(){var M=0;mstrmojo.array.forEach(this.children,function(N){M+=N.getHeight();});return M||this.containerNode.offsetHeight;},getWidth:function I(){var M=this.children;return(M&&M.length)?M[0].getWidth():this.containerNode.offsetWidth;},preBuildRendering:function K(){var M=this.getFormats();if(M&&M["min-width"]!==undefined){M.width=M["min-width"];}this._super();},renderChildren:function L(){this._super();this.resizeOrReposition();},resizeOrReposition:function D(){var O=this.containerNode;if(!!this.defn.aw){var V=this.model.getAutoWidthIDs(),S=(V&&V.length)||0,Z=0,Y=mstrmojo.all,P;if(!S){return ;}for(P=0;P<S;P++){Z=Math.max(this._getWidgetRightMostPosition(Y[V[P]]),Z);}Z=Math.max(this.getLayoutMinWidth(),Z);if(Z>parseInt(this.getFormats().width,10)){O.style.width=Z+"px";}}var X=this.model.zt;if(mstrApp.isMobile&&X){var M=this.parent.domNode;if(M){var Q=this.model.controller,N=!!Q.orientation,a=0,W=this.parent,R=W.getHeight()-W.fixedHeaderNode.clientHeight-W.fixedFooterNode.clientHeight;if(X===2){if(!Q.toolBarDelegated){R-=Q.getBottomToolBarHeight();}a=Math.round(N?Math.max((R-this.getHeight()),0)/2:0)+"px";}O.style.margin=a+" auto";var U=this;window.setTimeout(function(){Q.nudgeWidget(U.id,{left:O.offsetLeft,top:O.offsetTop});},0);}}},getLayoutMinWidth:function F(){return 0;},_getWidgetRightMostPosition:function F(M){return parseInt(M.getFormats().left,10)+((M.getDim&&M.getDim().w)||M.domNode.offsetWidth);},renderCtrlsInViewport:function C(){this._super();this.resizeOrReposition();},adjustAutoWidth:function H(M){if(!this.defn.aw||!M){return ;}var O=this.containerNode.style,N=parseInt(O.width,10)||0;var P=this;window.setTimeout(function(){var Q=P._getWidgetRightMostPosition(M);if(Q>N){O.width=Q+"px";}},1);},_getModelChildNodes:function B(P,O,S,N,R){var Q=this.model.getNonFixedSections(P,O);var M=Q.length;N=isNaN(N)?M:N;S=S||0;if(S>0||N<M){Q=Q.slice(S,S+N);}return R?{nodes:Q,total:M}:Q;},getChildren:function G(O,N,Q,M,P){return this._getModelChildNodes(O||this.node,N||false,Q,M,P);},getCaptureDimensions:function J(){var N=this.domNode,M;if(!this.domNode){return null;}M=mstrmojo.dom.position(N);M.w=Math.min(N.offsetWidth,M.w);M.h=Math.min(N.offsetHeight,M.h);return M;},preserveChildDomOrder:false,postBuildRendering:function A(){if(window.mstrMobileApp!==undefined){this.defn.lastOrientation=mstrMobileApp.getOrientation();}this._super();}});}());(function(){mstrmojo.requiresCls("mstrmojo.Container","mstrmojo.Button","mstrmojo.DropDownButton","mstrmojo.Label","mstrmojo.WaitIcon");mstrmojo.IncFetch=mstrmojo.declare(mstrmojo.Container,null,{scriptClass:"mstrmojo.IncFetch",markupString:'<div id="{@id}" class="mstrmojo-IncFetch {@cssClass}" style="{@cssText}"><div class="mstrmojo-IncFetch-content"></div><div class="mstrmojo-clearMe"></div></div>',markupSlots:{containerNode:function(){return this.domNode.firstChild;}},preBuildRendering:function A(){var J=[],F=this.ds,M=this.cp,P=this.np,C=this.ps,E=this.id,G=2;var L=function(){mstrmojo.all[E].set("cp",this.text);};var H={f:1,p:Math.max(M-1,1),n:Math.min(M+1,P),l:P};for(var O in H){J.push(new mstrmojo.Button({iconClass:"arrow "+O,title:F[O],enabled:(H[O]!==M),text:H[O],onclick:L}));}var D=Math.max(Math.min(M-2,P-4),1),I=Math.min(D+4,P);for(var K=D;K<=I;K++){var N;if(K===M){if(I-D===4&&P!==5){N=new mstrmojo.DropDownButton({height:"13px",title:F.a?F.a:"",text:K,direction:"up",popupRef:{scriptClass:"mstrmojo.Popup",slot:"popupNode",contentNodeCssClass:"goto",autoCloses:false,locksHover:true,children:[{scriptClass:"mstrmojo.VBox",children:[{scriptClass:"mstrmojo.Label",cssText:"float:left;",text:F.gt},{scriptClass:"mstrmojo.TextBox",cssText:"float:left;",size:3,maxLength:String(P).length,onEnter:function(){var R=this.inputNode.value,U=this.parent.parent;if(R===""){U.close();return ;}var Q=parseInt(R,10),S=!(isNaN(Q)||Q<1||Q>P);if(S){mstrmojo.all[E].set("cp",Q);U.close();}else{this.setInvalidState(F.v.replace("###",P).replace("##",1).replace(" #",""));}}},{scriptClass:"mstrmojo.Button",cssText:"float:left",iconClass:"apply",title:F.ap?F.ap:"",onclick:function(){this.parent.children[1].onEnter();}}]}],onOpen:function(){mstrmojo.css.addClass(this.parent.domNode,["open"]);var Q=this.children[0].children[1].inputNode;window.setTimeout(function(){Q.focus();},0);},onClose:function(){mstrmojo.css.removeClass(this.parent.domNode,["open"]);this.children[0].children[1].cleanUp();}}});}else{N=new mstrmojo.Button({iconClass:"pg on",text:K});}}else{N=new mstrmojo.Button({iconClass:"pg",text:K,onclick:L});}J.splice(G++,0,N);}J.splice(G++,0,new mstrmojo.Label({text:F.pgs.replace("###",P).replace("##",""),cssText:"float:left;margin:1px 1px 1px 3px;"}));this._iWait=new mstrmojo.WaitIcon({cssText:"margin-top:-2px;"});J.push(this._iWait);this.addChildren(J);return this._super?this._super():true;},_set_cp:function B(D,C){if(parseInt(C,10)!==this.cp){this.raiseEvent({name:"fetch",v:C,iWait:this._iWait});}}});})();(function(){mstrmojo.requiresCls("mstrmojo.SuggestionList","mstrmojo.mstr.EnumDSSXMLObjectTypes");var C=function(S,V,U){var R=S.parent.opener,J=R&&R.showDesc,Q=R&&R.showPath,I=V[S.itemField];var P=mstrmojo.string.escape4HTMLText,W="";if(Q){var M=V.anc&&V.anc.items,O=M&&M.length;if(O>0){for(var L=0;L<O-1;L++){W+=M[L].n+" > ";}W+=P(M[O-1].n);}else{if(V.path){W+=P(V.path);}}}if(!U){W+=(W.length===0?"":" > ")+P(I);}if(J){var N=V[S.itemDescField],K=120;if(N){W+="\r\n\r\n<br>"+P(N.substring(0,K)+(N.length>K?"...":""));}}return W;};var A=function(I,J,K){I.path=null;if(!J||!K||K.path){if(K&&K.path){I.set("path",K.path);}return ;}window.clearTimeout(this.pathTmr);this.pathTmr=window.setTimeout(function(){var L=J.path||J.getAttribute("path");if(L){I.set("path",K.path);return ;}mstrmojo.xhr.request("POST",mstrConfig.taskURL,{success:function(M){var N=H(M.toString())||"";K.path=N;I.set("path",N);}},{taskId:"getObjectDetails",objectID:K.did,objectType:K.t},undefined);},200);};var H=function(K){var N;if(window.DOMParser){N=(new DOMParser()).parseFromString(K,"text/xml");}else{N=new ActiveXObject("Microsoft.XMLDOM");N.async="false";N.loadXML(K);}var P=N.getElementsByTagName("path")[0],L=P.childNodes,O="";if(L){for(var J=0,I=L.length;J<I;J++){var M=L[J].childNodes&&L[J].childNodes[0];if(M){O+=mstrmojo.string.escape4HTMLText(M.nodeValue)+(J<I-1?"> ":"");}}}return O;};mstrmojo.LegacySuggestionList=mstrmojo.declare(mstrmojo.SuggestionList,null,{scriptClass:"mstrmojo.LegacySuggestionList",useRichTooltip:false,itemDescField:"desc",getItemMarkup:function(K,I){var J=this.parent.opener,L=this.useRichTooltip?"":this.buildTooltip(K);return'<div class="mstrmojo-suggest-text '+((J&&J.item2textCss(K))||"")+'" idx="'+I+'" title="'+L+'">'+J.getHighlightedText(J.getSearchPattern(),mstrmojo.string.escape4HTMLText(K[this.itemField]))+"</div>";},getItemProps:function E(){return{};},onmouseover:function(J){var M=this.parent.opener;if(M&&M.showPath){var K=mstrmojo.dom.eventTarget(J.hWin,J.e),I=K.getAttribute("idx"),L=I!=null?this.items[I]:null;if(L&&L.t>-1){this.targetEl=K;this.targetItem=L;this.requestPath(K,L);}}},requestPath:function D(I,K){var J=this.parent.opener;if(K.t===mstrmojo.mstr.EnumDSSXMLObjectTypes.Function&&J.showFunctionSyntaxAsPath){this.buildFunctionSyntax(K);}else{A(this,I,K);}},buildFunctionSyntax:function G(J){var K=J.path;if(!K&&J.t===mstrmojo.mstr.EnumDSSXMLObjectTypes.Function){var I=function I(P){if(P.did<0){return P.n;}var O=P.pars,M=[],N,L;M.push(P.n);if(O){M.push("(");for(N=0,L=O.length;N<L;N++){M.push(O[N].n);if(N!==(L-1)){M.push(", ");}}M.push(")");}return M.join("");};J.path=I(J);}this.set("path",{path:J.path,excludeSelf:true});},buildTooltip:function B(I,J){return C(this,I,J);},onpathChange:function F(){var I=this.targetEl;I.path=1;var J=this.buildTooltip(this.targetItem,this.path.excludeSelf);if(this.useRichTooltip){this.useRichTooltip=true;this.hasOpenTooltip=false;if(!I.ttp){I.ttp=J;this.showTooltip();}}else{I.title=J;}}});}());(function(){mstrmojo.requiresCls("mstrmojo.css","mstrmojo.hash","mstrmojo.ui.ButtonBar");mstrmojo.vi.ui.TextAlignButtonBar=mstrmojo.declare(mstrmojo.ui.ButtonBar,null,{scriptClass:"mstrmojo.vi.ui.TextAlignButtonBar",includeJustify:true,init:function B(E){this._super(E);mstrmojo.css.addWidgetCssClass(this,"txtAlign");var D=this.itemsValueMap,C=this.items;if(!this.includeJustify){C=C.filter(function(F){return F.id!=="justify";});}this.items=C.map(function(G){var F=mstrmojo.hash.copy(G);F.v=D[F.id];return F;});},onValueChange:mstrmojo.emptyFn,itemsValueMap:{left:0,center:2,right:1,justify:6},items:[{n:mstrmojo.desc(3049,"Left"),id:"left"},{n:mstrmojo.desc(2193,"Center"),id:"center"},{n:mstrmojo.desc(2166,"Right"),id:"right"},{n:mstrmojo.desc(2068,"Justify"),id:"justify"}],getItemProps:function A(E,C){var D=this._super(E,C);D.addCls(E.id);return D;},postselectionChange:function(C){var D=this.items,E=D[C.added[0]],F=D[C.removed&&C.removed[0]];this.onValueChange(E.v,F&&F.v);}});}());(function(){mstrmojo.requiresCls("mstrmojo.ui.List","mstrmojo.dom","mstrmojo.array","mstrmojo.hash");var F=mstrmojo.dom,H=mstrmojo.array,J=mstrmojo.hash,M=2;var W;function S(Z){var Y=[];H.forEach(this.itemsContainerNode.childNodes,function(c,a){if(c!==Z){var b=F.position(c);Y.push({i:a,m:b.x+(b.w/2)});}});return Y;}mstrmojo.vi.ui.IconTabList=mstrmojo.declare(mstrmojo.ui.List,null,{scriptClass:"mstrmojo.vi.ui.IconTabList",init:function N(Y){this._super(Y);mstrmojo.css.addWidgetCssClass(this,"mstrmojo-VIIconTabList");},markupMethods:{onvisibleChange:mstrmojo.Widget.visibleMarkupMethod},items:null,useRichTooltip:true,listHooks:{select:function(Z){var a=this.getItemNodeFromTarget(Z);if(a){var Y=F.position(a.firstChild);this.set("richTooltip",J.copy({top:Y.y+Y.h,left:Y.x-M},J.clone(this.richTooltip)));}}},showTooltip:function D(Z,c){var b=Z.target||F.eventTarget(Z.hWin,Z.e),a=this.getItemFromTarget(b);if(!a||a===this.getSelectedItems()[0]){return ;}if(a&&a.n){var Y=F.position(this.getItemNodeFromTarget(b).firstChild);this.richTooltip={posType:mstrmojo.tooltip.POS_TOPLEFT,cssClass:"vi-regular vi-tooltip-A",content:a.n,top:Y.y+Y.h+3,left:Y.x-M};this._super(Z,c);}},getItemMarkup:function E(Y){if(!W){W=this._super(Y).replace(">{@en@n}<","><div>{@en@n}</div><");}return W;},getItemProps:function X(a,Y){var Z=this._super(a,Y);if(a.disabled){Z.addCls("disabled");}Z.addCls(a.cls);return Z;},disableItem:function Q(Y){this.items[Y].disabled=true;this.refresh();},enableItem:function A(Y){this.items[Y].disabled=false;this.refresh();},singleSelect:function V(Z,a,Y){if(this.items[Z]&&!this.items[Z].disabled){this._super(Z,a,Y);}},selectionAdded:function G(Y){this.hideTooltip();this.tabSelected(this.items[Y.added[0]]);},tabSelected:function L(Y){},getTabIds:function I(){var Y=this.getSelectedItems()[0];return this.items.map(function(Z){return Z.id+((Z===Y)?"*":"");}).join("|");},getDragTabInfo:function C(b){var a=F.findAncestorByAttr(b,"idx",true,this.domNode),Z=this.items,c=Z.length===1;if(a){if(Z[a.value].disabled){return null;}var Y=parseInt(a.value,10);return{id:this.parent.id,node:a.node,homeIdx:Y,idx:Y,item:Z[a.value],isSingleTab:c,active:!c,pos:null,panel:null};}return null;},enterDragMode:function U(Y,a){this.selectItems(Y.item,true);var f=Y.node,c=F.position(this.domNode),d=f.nextSibling,b=f.offsetWidth,Z=S.call(this,f);var e=a.src.pos.x-F.position(f).x;if(e<0||e>b){e=Math.round(b/2);}Y.pos={offset:e,map:Z,width:b,left:c.x,max:c.x+c.w-b};f.style.left=(f.offsetLeft-1)+"px";if(d){d.style.marginLeft=b+"px";Y.pos.idx=Y.idx+1;}mstrmojo.css.addClass(this.domNode,"dnd");Y.active=true;},dragTab:function K(f,Z){var k=f.pos,h=Math.max(Math.min(Z.tgt.pos.x-k.offset,k.max),k.left),Y=k.width;var j=Z.getDirection("x"),d=k.map,g,b;f.node.style.left=h-k.left+"px";d.sort(function(m,l){return j?m-l:l-m;});H.forEach(d,function(l){if(!b&&(j?h+Y<l.m:h<l.m)){b=l;}if(l.i===k.idx){g=l;}});if(b!==g){var c=this.itemsContainerNode.childNodes,e=b&&b.i,a=g&&g.i;k.idx=undefined;if(g){c[a].style.marginLeft=0;}if(b){c[e].style.marginLeft=Y+"px";k.idx=e;}if(g&&b){if(a<e){g.m-=Y;}else{b.m+=Y;}}else{if(g){g.m-=Y;}else{b.m+=Y;}}}},exitDragMode:function O(Y){mstrmojo.css.removeClass(this.domNode,"dnd");H.forEach(this.itemsContainerNode.childNodes,function(Z){Z.style.marginLeft=0;});Y.active=false;delete Y.pos;},removeTab:function B(b){var Y=[].concat(this.items),Z=H.find(Y,"id",b),a=this.getSelectedItems()[0];if(a===Y[Z]){a=Y[Z+1]||Y[0];}Y.splice(Z,1);this.set("items",Y);this.selectItems(a,true);},pivotTab:function R(Y){var Z=[].concat(this.items),b=Y.item,a=Y.idx,c=Y.pos.idx;if(c===undefined){c=Z.length;}if(a<c){c--;}Z.splice(a,1);Z.splice(c,0,b);this.set("items",Z);this.selectItems(b,true);},addTab:function P(b,a,Z){var Y=[].concat(this.items),c=this.getSelectedItems()[0];if(Z||!c){c=b;}if(H.indexOf(Y,b)===-1){a=isNaN(a)?Y.length:a;Y.splice(a,0,b);this.set("items",Y);}this.selectItems(c,true);return{idx:a,node:this._getItemNode(a)};}});mstrmojo.vi.ui.IconTabList.TabInfoType=null;}());(function(){mstrmojo.requiresCls("mstrmojo.ui.List","mstrmojo.ui._HasScroller");mstrmojo.ui.ScrollableList=mstrmojo.declare(mstrmojo.ui.List,[mstrmojo.ui._HasScroller],{scriptClass:"mstrmojo.ui.ScrollableList",markupString:'<div id="{@id}" class="mstrmojo-ListBase {@cssClass}" style="{@cssText}" mstrAttach:click,dblclick,mousedown,mouseover,mouseout,contextmenu><div class="list-content"><div class="items-container {@icnCss}" style="{@icnCssText}">{@itemsHtml}</div></div></div>',markupSlots:{itemsContainerNode:function C(){return this.domNode.firstChild.firstChild;},scrollboxNode:function D(){return this.domNode.firstChild;},scrollNode:function E(){return this.domNode.firstChild;}},postBuildRendering:function B(){if(this.renderOnScroll){if(!this.onScrollEnd){var G=this.id;this.onScrollEnd=function F(){var H=mstrmojo.all[G];H.doScroll();H.updateScrollbars();};}}if(this._super){this._super();}},renderBlockSize:150,renderIndex:0,onScrollEnd:undefined,doScroll:function A(){if(this.renderOnScroll){var G,H=this.scrollNode,F=(this.renderIndex+1)*this.renderBlockSize;if(F>=this.items.length){return ;}if(mstrmojo.dom.position(H).h===H.scrollHeight){G=this.domNode;}else{G=H;}if((mstrmojo.dom.position(G).h+G.scrollTop)>=G.scrollHeight){this.renderIndex++;var I=this._buildItemsMarkup(this.renderIndex*this.renderBlockSize,((this.renderIndex+1)*this.renderBlockSize)-1,this._markupPrefix&&this._markupPrefix(),this._markupSuffix&&this._markupSuffix(),this._itemPrefix&&this._itemPrefix(),this._itemSuffix&&this._itemSuffix()).join("");G.innerHTML+=I;this.itemsContainerNode.innerHTML+=I;}}}});}());(function(){mstrmojo.requiresCls("mstrmojo.ui.List","mstrmojo.ui._HasScroller","mstrmojo.css");var G=mstrmojo.css;var D;mstrmojo.ui.CheckList=mstrmojo.declare(mstrmojo.ui.List,[mstrmojo.ui._HasScroller],{scriptClass:"mstrmojo.ui.CheckList",markupString:'<div id="{@id}" class="mstrmojo-ui-CheckList {@cssClass}" style="{@cssText}" mstrAttach:click,contextmenu><div class="scroll-container"><div class="{@icnCss}" style="{@icnCssText}">{@itemsHtml}</div></div></div>',markupSlots:{scrollboxNode:function A(){return this.domNode.firstChild;},itemsContainerNode:function J(){return this.domNode.firstChild.firstChild;}},markupMethods:{onvisibleChange:mstrmojo.Widget.visibleMarkupMethod,onheightChange:mstrmojo.Widget.heightMarkupMethod,onwidthChange:mstrmojo.Widget.widthMarkupMethod,onorientationChange:function M(){G.toggleClass(this.domNode,"horizontal",this.orientation!=="v");},onmultiSelectChange:function K(){G.toggleClass(this.domNode,"radio",!this.multiSelect);},onenabledChange:function I(){G.toggleClass(this.domNode,"disabled",!this.enabled);},onhideCheckMarkChange:function B(){G.toggleClass(this.domNode,"hideCheckMark",this.hideCheckMark);}},multiSelect:true,hideCheckMark:false,orientation:"v",minimumSelectCnt:0,icnCss:"icn",items:null,getItemMarkup:function L(N){if(!D){D=this._super(N).replace(">{@en@n}<",'title="{@tt}"><span class="text">{@en@n}</span><');}return D;},getItemProps:function H(Q,O){var P=this._super(Q,O),N={"\r\n":" ","\n":" ","\r":" "};var R=Q.css;if(R){P.addCls(R);}P.tt=Q.tt||"";Q.n=mstrmojo.string.multiReplace(Q.n,N);P.n=Q.n||"";return P;},setupScrollNodes:function E(){this.scrollNode=this.scrollboxNode;},preselectionChange:function C(O){var P=this.minimumSelectCnt,N=this.getSelectedItems().length,Q=O.removed;if(Q&&P){if(N<P){this.select(Q,true);return false;}}G.toggleClass(this.itemsContainerNode,"disableSelected",N<=P);return true;},buildRendering:function F(){this._super();G.toggleClass(this.itemsContainerNode,"disableSelected",this.getSelectedItems().length<=this.minimumSelectCnt);}});mstrmojo.ui.CheckList.ItemType=null;}());(function(){mstrmojo.requiresCls("mstrmojo.ListBoxBase","mstrmojo._HasScrollbox");mstrmojo.ListBox=mstrmojo.declare(mstrmojo.ListBoxBase,[mstrmojo._HasScrollbox],{scriptClass:"mstrmojo.ListBox",renderAllItems:false,renderPause:10,numPagesRendered:0,pageStatus:null,_rc:null,_totalPages:null,_rh:null,_rhMin:8,_rowsPerPage:null,_defaultRowsPerPage:100,_minRowsPerPage:100,_pageHeight:null,buildRendering:function K(){if(this.renderAllItems===true){this._super();return true;}this._initPageSettings();var L=this.items;this.items=this._rc?this.items.slice(0,Math.min(this._rowsPerPage,this._rc)):[];this._super();this.items=L;this.postRenderPage(0,true);if(this._rc>this._rowsPerPage){this.itemsContainerNode.style[mstrmojo.css.MINHEIGHT]=(this._rh*this._rc)+"px";if(!this.connectedScrollbox){this.connectScrollbox(this);this.connectedScrollbox=true;}}else{this.postRenderingCleanup();}},_initPageSettings:function E(){var L=this.items;this._rc=(L&&L.length)||0;var N=this.itemRenderer;this._rh=(N&&N.rowHeight)||this._rhMin||3;var M=this._defaultRowsPerPage;if(!isNaN(this.scrollboxHeight)){M=Math.ceil(this.scrollboxHeight/this._rh);M=Math.max(M,this._minRowsPerPage);}this._rowsPerPage=M;this._totalPages=Math.ceil(this._rc/this._rowsPerPage);this._pageHeight=this._rh*this._rowsPerPage;this._pageStatus=new Array(this._totalPages);this._numPagesRendered=0;},onscroll:function J(){if(!this._renderingRows){this._startPageRenderThread();}},_startPageRenderThread:function F(){this.renderingRows=true;var M=this,L=this._renderTimer=self.setInterval(function(){if(!M){self.clearInterval(L);return ;}var N=M.getPagesToRender();if(N.length>0){M.renderPages(N);}else{M.renderingRows=false;self.clearInterval(M._renderTimer);delete M._renderTimer;if(M.isRenderingComplete()){M.postRenderingCleanup();}M=null;}},this.renderPause);},getPagesToRender:function I(){var P=[],a=this._pageHeight,c=null,X=this._pageStatus,Z=this;function R(d){var e=X[d];if(e&&e.filled){if(!e.height){if(!c){c=Z.itemsNode.tBodies;}e.height=c[d].offsetHeight;}return e.height;}else{return a;}}var b=0,S=null,O=null,M=this.scrollboxTop;for(var W=0,Y=this._totalPages;W<Y;W++){b+=R(W);if(b>=M){S=W;break;}}if(S==null){S=O=Y-1;}else{var L=this.scrollboxBottom;for(var U=S+1;U<Y;U++){if(b>=L){O=U-1;break;}b+=R(U);}}if(O==null){O=Y-1;}for(var N=this._numPagesRendered;N<S;++N){P.push({idx:N,fill:false});}for(var Q=S;Q<=O;++Q){var V=X[Q];if(!V||!V.filled){P.push({idx:Q,fill:true});}}return P;},renderPages:function D(M){for(var N=0,L=M.length;N<L;++N){this.renderPage(M[N].idx,M[N].fill);}},renderPage:function B(R,M){var W=this._pageStatus,P=(this._numPagesRendered>=R+1);if(P){if(!M||(W[R]&&W[R].filled)){return ;}}var V=this._rowsPerPage,L=R*V,N=Math.min(L+V,this._rc)-1;var U=this.tempTableCont;if(!U){U=this.tempTableCont=this.domNode.ownerDocument.createElement("div");}var Q=M?this._buildItemsMarkup(L,N,'<table><tbody idx="'+R+'">',"</tbody></table>",this._itemPrefix&&this._itemPrefix(),this._itemSuffix&&this._itemSuffix()).join(""):'<table><tbody idx="'+R+'"><tr><td style="height:'+this._pageHeight+'px">&nbsp;</td></tr></tbody></table>';U.innerHTML=Q;var O=U.firstChild.tBodies[0],S=this.itemsNode;if(!P){S.appendChild(O);}else{S.replaceChild(O,S.tBodies[R]);}this.postRenderPage(R,M);},postRenderPage:function G(M,O){if(M+1>this._numPagesRendered){this._numPagesRendered=M+1;}var L=this._pageStatus,N=L[M];if(!N){N=L[M]={};}if(O){N.filled=true;}if(M>0&&M==this._totalPages-1){this.itemsContainerNode.style[mstrmojo.css.MINHEIGHT]="";}},isRenderingComplete:function C(){if(this._numPagesRendered==this._totalPages){for(var L=this._pageStatus,M=this._totalPages-1;M>-1;M--){if(!L[M]||!L[M].filled){return false;}}return true;}return false;},postRenderingCleanup:function A(){if(this.connectedScrollbox){this.disconnectScrollbox(this);this.connectedScrollbox=false;}},unrender:function(L){this.postRenderingCleanup();this._super(L);},refresh:function H(){if(!this.hasRendered){return ;}var N=this.domNode,L=N&&N.parentNode;if(!this.parent&&L){var M=N.ownerDocument.createElement("span");L.insertBefore(M,N);}this.unrender();if(!this.parent&&L){this.domNode=M;}this.render();if(this.defn&&this.defn.set){this.defn.set("readyState",mstrmojo.EnumReadystate.IDLE);}}});})();(function(){mstrmojo.requiresCls("mstrmojo.ListBase","mstrmojo._ListSelections");mstrmojo.ListBoxHoriz=mstrmojo.declare(mstrmojo.ListBoxBase,[mstrmojo._ListSelections],{scriptClass:"mstrmojo.ListBoxHoriz",cssClass:"mstrmojo-ListBoxHoriz",tableCssClass:"mstrmojo-ListBox-table",tableCssText:"",rowCssClass:"",rowCssText:"",cellCssClass:"",cellCssText:"",cellSpacing:0,cellPadding:0,_markupPrefix:function(){var A=this.itemRenderer;return(A&&A.markupPrefix)||('<table class="'+this.tableCssClass+'" style="'+this.tableCssText+'" cellspacing="'+this.cellSpacing+'" cellpadding="'+this.cellPadding+'"><tbody><tr class="'+this.rowCssClass+'" style="'+this.rowCssText+'">');},_markupSuffix:function(){var A=this.itemRenderer;return(A&&A.markupSuffix)||"</tr></tbody></table>";},_itemPrefix:function(){var A=this.itemRenderer;return(A&&A.itemPrefix)||('<td class="'+this.cellCssClass+'" style="'+this.cellCssText+'">');},_itemSuffix:function(){var A=this.itemRenderer;return(A&&A.itemSuffix)||"</td>";},_getItemNode:function(A){if(A<0){return null;}var B=this.itemsNode,C=B&&B.rows[0];return C&&C.cells[A].firstChild;}});}());(function(){mstrmojo.requiresCls("mstrmojo.GridBase","mstrmojo.Grid","mstrmojo.mstr.EnumDSSXMLObjectTypes");mstrmojo.XtabZone=mstrmojo.declare(mstrmojo.Grid,null,{scriptClass:"mstrmojo.XtabZone",markupString:'<div id="{@id}" class="mstrmojo-XtabZone" style="position:relative;{@cssText}"></div>',markupSlots:{gridContainerNode:function(){return this.domNode;}}});}());(function(){var G=1,B=2;mstrmojo.XtabCP=mstrmojo.declare(null,null,{scriptClass:"mstrmojo.XtabCP",base:null,lookupBase:null,colWidths:null,forceAutoRowHeight:false,startIndexInContainer:0,updatedRows:null,preServeUpdatedRows:true,init:function M(N){mstrmojo.hash.copy(N,this);},initContent:function E(Q){this.startIndexInContainer=Q||this.startIndexInContainer||0;var P=this.base||[],O=P.show,N=P.items;this.rc=O&&N?N.length:0;this.colWidths=(O&&P.cws)||[];this.isDownloading=false;this.isDownloaded=true;this.invalidData=false;},isDataAvailable:function C(O,N){return !this.invalidData;},download:function A(P,O,N){if(!this.isDownloaded&&!this.isDownloading&&this.dataSource){this.isDownloading=true;this.dataSource.download(0,N);}},invalid:function F(){this.invalidData=true;this.isDownloading=false;this.isDownloaded=false;this.preServeUpdatedRows=true;if(this.gridData){this.oldGridData=this.gridData;this.oldBase=this.base;this.updatedRows={};}},getRowHeight:function D(){return this.gridData.rh;},getNumAutoHeightRows:function(){return this.forceAutoRowHeight?this.rc:0;},getAvailableRowsCount:function L(){return this.rc;},getUpdatedRows:function J(){return this.updatedRows;},getRowCells:function(k,O){var a=this.base||[],W=a.items||[],l=W[k]||[],Y=l.items,n=this.lookupBase,d=this.interactiveCellsArray,m=this.gridData.css,t=this.gridData.gsi,f=t&&t.prop&&t.prop.cols&&t.prop.cols.mg,p=null,Z,h,V,o,v,U,j,S,X,R,g="-1";if(this.oldGridData){Z=this.oldBase;h=Z&&Z.items;V=h[k]&&h[k].items;}for(v=0,o=(Y&&Y.length)||0;v<o;v++){U=Y[v];if(U){U.v=U.v||U.n;if(n&&!U._e){j=n[U.tui];S=U.fi;X=(j&&j.fs)||[];R=X[S]||X[0];U.ts=U.ts||R&&R.bftp;p=j&&j.es[U.idx];if(p){U.v=U.v||p.n;if(p.rv){U.rv=p.rv;}U._e=p;}}if(!U.css){var z=U.cni;if(z!==undefined){U.css=m[z].n;}else{U.css="";}}if(!U._d&&V&&this.preServeUpdatedRows){var Q=V[v];if(!Q||(Q.rs!==U.rs)){this.preServeUpdatedRows=false;this.updatedRows={};}else{if((Q.v&&U.v!==Q.v)){var x={};if(U.v!==Q.v){x.v=Q.v;}if(U.css!==Q.css){x.css=Q.css;}U._d=x;this.updatedRows[this.startIndexInContainer+k]=true;}}}U._gd=this.gridData._bidx||0;if(d){if(!O&&(U._ei===undefined||d[U._ei]!==U)){U._ei=d.push(U)-1;}}if(this.axis){U.axis=this.axis;}var q=U.pi,c=function c(AB,r,e){var AA=AB&&AB[r];return AA&&AA.es[e];},b=function b(AC,AA,AD,r,AB){var e=AC.items[AA].items[AD];if(e){e.axis=e.axis||r;if(e._e===undefined){e._e=c(AC.show?n:AB,e.tui,e.idx);}}return e;};if(q){if(q.ri!==undefined&&q.ci!==undefined){if(U.axis===2&&f!==g){U._p=W[q.ri].items[v];}else{U._p=W[q.ri].items[q.ci];}}else{var w=this.gridData.ghs,N=this.gridData.gts,u=q.left,P=q.top;if(u){U._lp=b(w.rhs,u.ri,u.ci,G,N.row);}if(P){U._tp=b(w.chs,P.ri,P.ci,B,N.col);}}}}}return Y;},getUnmergedCells:function H(S){var V=[],W=(this.base&&this.base.items)||[];if(S>W.length-1||S<0){return V;}var P=this.gridData.css,U=W[S].items[0],O=U&&U.pi,N=O&&O.ri,R=O&&O.ci;while(O&&N>-1&&R>-1){U=U._p||W[N].items[R];var Q={};mstrmojo.hash.copy(U,Q);if(!Q.css){Q.css=P[Q.cni].n;}Q.rs=U.rs-S+N;V.splice(0,0,Q);O=U&&U.pi;N=O&&O.ri;R=O&&O.ci;}return V;},getIndentPadding:function K(N){return N*14;},getCell:function I(N,O){var P=this.base.items;return P[N].items[O];}});}());(function(){mstrmojo.XtabVACP=mstrmojo.declare(mstrmojo.XtabCP,null,{scriptClass:"mstrmojo.XtabVACP",cps:[],initContent:function G(L){this.startIndexInContainer=L||0;this.rc=0;this.type=0;this.colWidths=[];var J;for(J=0;J<this.cps.length;++J){var K=this.cps[J];K.initContent(this.startIndexInContainer+this.rc);this.rc+=K.rc;this.type|=K.type;var I=K.colWidths;if(I&&(I.length>this.colWidths.length)){this.colWidths=I;}}},getNumAutoHeightRows:function(){return this.cps[0].getNumAutoHeightRows();},getRowHeight:function C(){return this.cps[0].getRowHeight();},getRowCells:function(J,I){var K=0,L=this.cps[K],M;while(J>=L.rc){J-=L.rc;L=this.cps[++K];}if(this.renderingNewPage){L.updateCounter=0;this.renderingNewPage=false;}M=L.getRowCells(J,I);this.updateCounter=L.updateCounter;return M;},getUnmergedCells:function(I){var J=0,K=this.cps[J];while(I>=K.rc){I-=K.rc;K=this.cps[++J];}return K.getUnmergedCells(I);},getCell:function(I,K){var J=0,L=this.cps[J];while(I>=L.rc){I-=L.rc;L=this.cps[++J];}return L.getCell(I,K);},isDataAvailable:function D(L,K){var J=this._getCPs(L,K),I;for(I=0;I<J.length;++I){if(!J[I].isDataAvailable(L,K)){return false;}}return true;},getAvailableRowsCount:function F(){var K=0,I;for(I=0;I<this.cps.length;++I){var J=this.cps[I];if(J.isDataAvailable()){K+=J.getAvailableRowsCount();}}return K;},_getCPs:function H(N,L){var J=0,M=this.cps[J],I=M&&M.startIndexInContainer,K=[];if(M){N-=I;L-=I;}while(M&&N>=M.rc){N-=M.rc;L-=M.rc;M=this.cps[++J];}while(M&&L>=M.rc){L-=M.rc;K.push(M);M=this.cps[++J];}if(M){K.push(M);}return K;},invalid:function E(){var I;for(I=0;I<this.cps.length;++I){var J=this.cps[I];J.invalid();}this.updatedRows={};},getUpdatedRows:function A(){var I={},J;for(J=0;J<this.cps.length;++J){var K=this.cps[J];if(!K.preServeUpdatedRows){return{};}mstrmojo.hash.copy(K.getUpdatedRows(),I);}this.updatedRows=I;return I;},download:function B(N,M,I){var L=this._getCPs(N,M),J;for(J=0;J<L.length;++J){var K=L[J];K.download(N,M,I);}}});}());(function(){mstrmojo.XtabHACP=mstrmojo.declare(mstrmojo.XtabCP,null,{scriptClass:"mstrmojo.XtabHACP",cps:[],initContent:function G(J){this.startIndexInContainer=J||0;this.type=0;this.colWidths=[];var I;for(I=0;I<this.cps.length;++I){this.cps[I].initContent(this.startIndexInContainer);this.type|=this.cps[I].type;var H=this.cps[I].colWidths;if(H){this.colWidths=this.colWidths.concat(H);}}this.rc=Math.max(this.cps[0].rc,this.cps[1].rc);},getNumAutoHeightRows:function(){return Math.max(this.cps[0].getNumAutoHeightRows(),this.cps[1].getNumAutoHeightRows());},getRowHeight:function C(){return this.cps[0].getRowHeight();},getRowCells:function(J,I){var N=this.cps,K=[],H=N.length,M;for(M=0;M<H;M++){if(N[M].getAvailableRowsCount()>0&&N[M].rc>J){var L=N[M].getRowCells(J,I);if(L){K=K.concat(L);}}}return K;},getUnmergedCells:function(H){return this.cps[0].getUnmergedCells(H);},isDataAvailable:function D(I,H){return this.cps[1].isDataAvailable(I,H);},getAvailableRowsCount:function F(){return Math.max(this.cps[0].getAvailableRowsCount(),this.cps[1].getAvailableRowsCount());},invalid:function E(){var I,H,J;for(I=0,H=this.cps.length;I<H;++I){J=this.cps[I];J.invalid();}this.updatedRows={};},getUpdatedRows:function A(){var H={},I;for(I=0;I<this.cps.length;++I){var J=this.cps[I];if(!J.preServeUpdatedRows){return{};}mstrmojo.hash.copy(J.getUpdatedRows(),H);}this.updatedRows=H;return H;},download:function B(K,I,H){var J=this.cps[1];J.download(K,I,H);}});}());(function(){var C=4;mstrmojo.XtabLevelHACP=mstrmojo.declare(mstrmojo.XtabHACP,null,{scriptClass:"mstrmojo.XtabLevelHACP",allCells:[],updateCounter:0,pageNum:0,getEmptyCell:function B(D,E,G){var F={css:D.css.replace(" hl",""),v:"",fillerCell:true};if(E){F.cs=this.headerCells[G].cs||1;}return F;},getCellDepth:function A(D){var E=D.dpt||1;if(!D.dpt){D=D._p;while(D){if(D.dpt){E+=D.dpt;break;}E++;D=D._p;}}return E;},getUnmergedCells:function(D){return ;},getRowCells:function(S){var N=this.cps,I=[],b=N.length,K=false,d=this.gridData,O=(d&&d.lvlepd)||-1,Q=this.outlineState,H=this.allCells,a,Z,Y,F,E,e,X=0,J=-10;e=this.updateCounter;S-=e;if(H.length>0){return H.splice(0,1)[0];}var V=function(l){var k=l.gridData||(l.cps[0]&&l.cps[0].gridData),m=(k&&k.gts.row),g=(m&&m.length)||0,f,h,j;this.headerCells=f=mstrmojo.hash.clone(m);for(j=0;j<f.length;j++){if(f[j].cs>1&&f[j].otp===mstrmojo.mstr.EnumDSSXMLObjectTypes.Filter){for(Z=1;Z<f[j].cs;Z++){h=this.getEmptyCell(f[j],false);f.splice(j+1,0,h);}f[j].cs=1;}}for(j=g-1;j>0;j--){if(f[j].id===f[j-1].id){f.splice(j,1);}}g=f.length;this.maxLevel=k.maxLevel=g;this.gridData=k;for(j=0;j<g;j++){if(f[j].cs>1){return true;}}return false;};var G=function(k){var f,j,g,h;for(h=k.length-1;h>0;h--){j=k[h-1];f=k[h];if(f.dpt&&f.dpt===j.dpt){if(f.v&&f.v!==""){if(f.ts===C){if(f.v.indexOf("#srcstart")===0){g=f.v;}else{g="#srcstart"+f.v+"#srcend";}if(j.ts!==C){g=j.v+" "+g;}else{g="#srcstart"+j.v+"#srcend "+g;}j.v=g;}else{if(j.ts===C){j.v="#srcstart"+j.v+"#srcend "+f.v;}else{j.v+=" "+f.v;}}f.v="";}k.splice(h,1);}}return k;};var c=function(h){var g=this.headerCells,k=g.length,f=g[h].cs?(g[h].cs-1):0;var j=0;for(j=h+1;j<g.length;j++){f+=g[j].cs?(g[j].cs-1):0;}return f;};var D=function(j){var h=j.gridData||(j.cps[0]&&j.cps[0].gridData),f=h.gts,g=false;if(f.col.length===0){g=true;}else{g=f.rec;}return g?0:1;};for(a=0;a<b;a++){if(N[a].getAvailableRowsCount()>0&&N[a].rc>S){var L=mstrmojo.hash.clone(N[a].getRowCells(S).slice(0));if(N[a].type===4){if(S===0){this.hasMultiFormAttributes=V.call(this,N[a]);this.metricAdjuster=D(N[a]);if(O===-1){O=this.gridData&&this.gridData.lvlepd;}}if(this.hasMultiFormAttributes){L=G(L);}var P=L.length;for(Y=P-1;Y>=0;Y--){F=L[Y];var W=this.getCellDepth(F);if(Y===0){for(Z=1;Z<W;Z++){L.splice(Z-1,0,this.getEmptyCell(F,this.hasMultiFormAttributes,Z-1));}}else{if(F.stt&&F.idx<0){L.splice(Y,1);}else{if(F.stt===1&&(!F._e||F._e.n)){L.splice(Y,1);E=L[Y-1];if(F._e&&F.hst&&F.hst!==J&&E&&E.v===E._e.n){E.v+=" ("+F._e.n+")";}continue;}else{var R=[];L.splice(Y,1);for(Z=1;Z<W;Z++){R.push(this.getEmptyCell(F,this.hasMultiFormAttributes,Z-1));}R.push(F);H.splice(0,0,R);K=true;e++;this.rc++;}}}F.rs=1;F.outLvl=W;if(Q&&Q.collapseToLevel){if(W<=Q.collapseToLevel){if(W<Q.collapseToLevel||!Q.isExpanding){delete Q.collapseToLevel;H.forEach(function(f){f.forEach(function(g){if(!g.fillerCell&&g._ei){delete Q[g._ei];g.epd=false;g.hidden=false;}});});}else{if(Q.isExpanding){Q.hasTBodyElementsToExpand=true;}Q[F._ei]={expanded:false,hidden:true};}}else{Q[F._ei]={expanded:false,hidden:true};}}if(Q&&Q[F._ei]!==undefined){F.epd=!(Q[F._ei].expanded);F.hidden=Q[F._ei].hidden;}else{F.epd=O>0&&O<=W;F.hidden=false;}if(this.hasMultiFormAttributes){X=c.call(this,W-1);}if((X||this.metricAdjuster)&&W===this.maxLevel){F.isLeaf=true;}F.cs=P>1?(P-Y+X+this.metricAdjuster):(P+X+this.metricAdjuster);}this.updateCounter=e;}else{if(K){var U=H.length-1,M=H[U];H[U]=M.concat(L);for(Z=0;Z<U;Z++){M=H[Z];for(Y=0;Y<L.length;Y++){M.push(this.getEmptyCell(L[Y]));}}for(Y=0;Y<L.length;Y++){I.push(this.getEmptyCell(L[Y]));}continue;}}if(L){I=I.concat(L);}}}return I;}});}());(function(){function F(N){var M=0;for(M=0;M<N.length;M++){if(N[M].otp===-1){return true;}}return false;}function G(M){var N=[],Q,P,O;for(O=M.length-1;O>0;O--){Q=M[O];P=M[O-1];if(Q.id===P.id){M.splice(O,1);if(P.v===P.n){P.v+=" | "+Q.v;P.cs=(P.cs||1)+(Q.cs||1);}}}return M;}function C(M){return M.gts.col.length>0&&M.gts.rec===false;}mstrmojo.XtabTitlesCP=mstrmojo.declare(mstrmojo.XtabCP,null,{scriptClass:"mstrmojo.XtabTitlesCP",init:function L(M){this._super(M);},download:function A(O,N,M){},shouldClonedLastTitleCell:function K(){return(this.gridData.lhv!==0);},initContent:function H(V){this.startIndexInContainer=0;if(!this.cts){this.cts=mstrmojo.hash.clone(this.gridData.gts.col);}var N=this.gridData.gts,P=N.row||[],M=N.col||[],X=N.show,U=N.rec,d=this.cts||[],c=P.length,W=d.length,a=this.gridData.css;this.base={items:[]};this.rc=(X&&d.length)||0;if(this.rc===0&&X){this.rc=c>0?1:0;}this.colWidths=(X&&N.cws)||[];if(!this.rc){this.nRowSpan=this.nColSpan=0;return ;}var R={items:[]},Y=0,O=1,Z,b,f=this,Q=f.base.items,e=function(g,h){if(f.shouldClonedLastTitleCell()&&h>1){g.rs=1;Z=mstrmojo.hash.clone(g,{});Z.n="&nbsp;";g.cni=a.push({n:(a[g.cni].n||"")+" fsbp_1"})-1;}},S=function(j){var g=j;while(g-->1){if(f.shouldClonedLastTitleCell()){var h=mstrmojo.hash.clone(Z,{});h.cni=a.push({n:(a[h.cni].n||"")+" fsbp_"+((g==1)?"3":"2")})-1;Q.push({items:[h]});}else{Q.push({items:[]});}}};for(b=0;b<c;++b){P[b].axis=1;P[b].ui=b;Y+=P[b].cs||1;R.items.push(P[b]);}if(W>0){d[0].axis=2;d[0].ui=0;M[0].axis=2;M[0].ui=0;O=d[0].rs||1;e(d[0],O);Y+=d[0].cs||1;R.items.push(d[0]);}Q.push(R);for(b=1;b<W;++b){if(O>1){S(O);}d[b].axis=2;d[b].ui=b;M[b].axis=2;M[b].ui=b;O=d[b].rs||1;e(d[b],O);Q.push({items:[d[b]]});}this.rc=Q.length;this.nRowSpan=this.rc+O-1;this.nColSpan=Y;if(U){this._removeExtraColumn(P,d);}},getAvailableRowsCount:function I(){return this.rc;},getSpanDimension:function J(){return{nRow:this.nRowSpan||0,nCol:this.nColSpan||0};},isDataAvailable:function B(N,M){return true;},getRowCells:function E(N){var Q=this._super(N),U=this.gridData;if(U.olm&&!(U.rw&&U.rw.row.bc>0)&&!(this.dataSource&&this.dataSource.defn.txi)){Q=G(Q);var S=0,P=0,O;Q=mstrmojo.hash.clone(Q);for(S=0;S<Q.length;S++){if(Q[S].cs>1&&Q[S].otp===mstrmojo.mstr.EnumDSSXMLObjectTypes.Filter){for(P=1;P<Q[S].cs;P++){O={};O.css=Q[S].css.replace(" hl","");O.v="&nbsp;";Q.splice(S+1,0,O);}Q[S].cs=1;}}var R=C(U),M=R?Q.length-1:Q.length,S;for(S=0;S<M-1;S++){Q[S].expandLevel=S+1;}}return Q;},_removeExtraColumn:function D(P,g){var e=P&&P.length,V=g&&g.length,M=this.gridData.gts,Y=M.row||[],S=M.col||[],N=Y.length,c=S.length;if(!e||!V){if(V===1){var h=g[V-1];if(h.otp==-1){if(c>0){S[c-1]._hid=true;}this.base.items=[];this.nRowSpan=this.nColSpan=this.rc=0;}}return ;}var O=P[e-1],Z=this.rc,Q=this.base.items;if(O){if(O.otp==-1){if(N>0){Y[N-1]._hid=true;}if(this.nColSpan){this.nColSpan-=O.cs||1;}Q[0].items.splice(e-1,1);}else{var W=Z>1?Z-1:0,X=Q[W],f=X.items.length;if(f>0&&c>0){S[c-1]._hid=true;}var R=O.fix;if(R){var d;for(d=0;d<R;d++){X.items[f-1+d]=P[e-R+d];}}else{X.items[f-1]=O;}for(var b=0,a=V-1;b<a;b++){g[b].cs=R?R:O.cs;}var U=R?R:1;Q[0].items.splice(e-U,U);if(this.nColSpan){this.nColSpan-=1;}}}return ;}});})();(function(){mstrmojo.XtabOnDemandCP=mstrmojo.declare(mstrmojo.XtabCP,null,{scriptClass:"mstrmojo.XtabOnDemandCP",blockNum:0,listeners:null,initContent:function E(F){if(F!==undefined){this.startIndexInContainer=F;}this.isDownloaded=(this.base!==null);this.isDownloading=false;if(this.base){this._super(this.startIndexInContainer);this.notifyListeners();}},addCPListener:function D(F){if(!this.listeners){this.listeners=[];}this.listeners.push(F);},notifyListeners:function C(){var F,H=this.listeners,G=(H&&H.length)||0;for(F=0;F<G;F++){if(H[F]&&H[F].onDemandDataReady){H[F].onDemandDataReady(this);}}},getAvailableRowsCount:function B(){return this.isDownloaded?this.rc:0;},download:function(F){if(!this.isDownloaded&&!this.isDownloading){this.isDownloading=true;this.dataSource.download(this.blockNum,F);}},invalid:function(){if(this._super){this._super();}this.isDownloaded=false;this.isDownloading=false;},isDataAvailable:function A(G,F){return this.isDownloaded;}});})();(function(){var b=1,f=2,o=4,X=8,h=1,j=2,G=3,d=4,n=5,V=6,M=7,l=8,Y=4,F={},B={},I=4,R=1,J={TITLE:"ig-title",GROUPING:"iggroup",BANDING:"igbanding",RIGHT_ALIGN:"rtAlign",LEFT_ALIGN:"leftAlign",TOTAL_ROW:"total"},U=mstrmojo.hash,W=mstrmojo.array;function a(u,r){var t=u[0],p=r.gts,q=p.cws.length;return(r.vp.gr==="1"&&(q>1));}function k(q,w){var u=function(x,z){if(z&&x&&x.css&&x.css.indexOf(z)<0){x.css+=" "+z;}};var t=w.type,r=w.col,v=(r&&r.cl)||0,p=(t===f||t===b);if(t===f||t===X){u(q,J.RIGHT_ALIGN);}else{if(t===b||t===o){u(q,J.LEFT_ALIGN);}}if(p){if(r&&r.tg&&v>1){if(!q._v){q._v=q.v;q.v="<span class='toggleHeader'>"+q.v+"</span>";}}u(q,J.TITLE);}W.forEach(w.extraCss,function(x){u(q,x);});}function A(p){return 0;}function m(u){var r,t=u.cg,p=t&&t.cgc,q=1;for(r=0;r<p;r++){if(t&&t[r]&&!t[r].tg&&t[r].cl>q){q=t[r].cl;}}return q;}function N(q,p){var r=n;if(p===2){if(q===0){r=h;}else{if(q===1){r=d;}}}else{if(p>2){if(q===0){r=h;}else{if(q===1){r=j;}else{if(q===p-1){r=d;}else{if(q<p-1&&q>1){r=G;}}}}}}return r;}function L(p,u,r,q){var w=q&&q.cols&&q.cols.cg,t,x=0,v=0;if(w){for(t=0;t<u;t++){if(p[t]){x+=p[t].length;}}x+=(r+1);for(t=0;t<w.cgc;t++){v+=w[t].cl;if(v>=x){return t;}}}return -1;}function P(x,t,q,p){var w=[],v,r,u,z;for(r=0,u=x.length;r<u;r++){if(x[r].length===1){v=x[r][0];v.rowType=(v.rowType!==l)?N(t,q):l;v.singleStack=(q>1);v=U.copy(v);if(v.ts===I){if(q===1){v.rowType=n;v.colIdx=L(x,r,t,p);}else{if(!t){v.colIdx=L(x,r,t,p);}else{delete v.ts;v.v="";}}}else{if(t){v.v="";}}}else{v=x[r][t];if(!v){z=x[r].length;v=U.copy(x[r][z-1],{});v.v="";if(v.hasOwnProperty("ts")){delete v.ts;}}else{if(v.ts===I){v.colIdx=L(x,r,t,p);}}v.rowType=(v.rowType!==l)?N(t,q):l;}w.push(v);}return w;}function Q(p){if(p===0){return 0;}var q=this.sectionMap[p-1]||0;return Math.floor((p-q)/this.stackLevels);}function D(w){var u,v,t=this.sectionInfo,p=t.length,r=this.srh,q=this.lastSectionIndex;v=t[q];if(w>=v.rs&&w<(v.rs+r)){return v;}if(w<v.rs){u=q-1;if(u<=0){this.lastSectionIndex=0;return null;}do{v=t[u];if(w>v.rs&&w<=(v.rs+r)){this.lastSectionIndex=u;return v;}}while(w<v.rs&&--u>0);this.lastSectionIndex=u;return v;}else{u=q+1;if(u>=p){this.lastSectionIndex=p-1;return null;}do{v=t[u];if(w>v.rs&&w<=(v.rs+r)){this.lastSectionIndex=u;return v;}}while(w>(v.rs+r)&&++u<p);this.lastSectionIndex=u-1;return null;}}function e(z,r,p,x){var w=z[0],u,v=z.length,q=w&&w.rowType,t={v:"",css:"empty-igcell",rowType:q};if(p!==undefined&&w&&(q===h||q===n||q===V)){t={v:'<div><div class="IG-ActionArrow-IMG" style="height:'+x+"px;top:-"+(0.5*F[q])+'px;"></div></div>',css:"IG-ActionArrow",_ei:p};}for(u=v-1;u>=v-r;u--){w=z&&z[u];if(w){w.css+=" IG-lastdatacolumn";}}z.push(t);}function S(AM,AH,r){var AD=AM.cols,AE=AD.cg,p=[{w:"0px"}];if(AD&&AH){var AN=AD.cws,q=[],AL=AN.length,AP=0,z=(parseInt(AM.ar,10)===1)?(AH/AL):-1,AC,t,AB=false,u=0,AF=AH,AG=0,AK;for(AK=0;AK<AL;AK++){t=q[AK]=AN[AK];AC=t.w;if(AC===""){AB=true;}else{if(t.xc){AP+=parseInt(AC);AF-=AP;u++;}else{AG+=parseFloat(AC,10);}}}if(AB||AG<100){z=AF/(AL-u);}for(AK=0;AK<AL;AK++){t=AN[AK];if(t.xc){continue;}else{if(z===-1){AC=parseInt(t.w,10)*AF/100;if(!AC&&AC!==0){AC=parseInt(AF/AE.cgc,10);}}else{AC=(parseInt(t.w,10)<0)?0:z;}}q[AK]={w:AC+"px"};}if(r){return q;}var AA=[],AJ=0;for(AK=0;AK<AL;AK++){var AO=AE[AK],x=AO.tg?AO.cl:1,AI=0;for(AI=0;AI<x;AI++){var v="0px";if(AI===AO.cc){v=q[AK].w;}AA[AJ+AI]={w:v};}AJ+=x;}return AA.concat(p);}else{if(r){return null;}else{return cp.cws.concat(p);}}}function C(){delete this.lastStackCols;delete this.lastAttRow;delete this.lastMtxRow;}mstrmojo.InteractiveGridHACP=mstrmojo.declare(mstrmojo.XtabHACP,null,{scriptClass:"mstrmojo.InteractiveGridHACP",sectionMap:[],stackLevels:1,gridWidth:480,tdWidths:null,lastSectionIndex:0,adjustCPMaps:function O(){var AA=this.cps,z=this.cps[0],AF=Math.max(AA[0].rc,AA[1].rc);if(z.type!==b){var AK=this.gridData,AE=function(AN,AQ){var AM=AN.base.items,AO=AN.lookupBase[0].es,AP=AM[AQ].items[0],AL=AO&&AO[AP.idx];return(AL&&AL.n)||((AP.pi&&AO[AP.pi.ri||0])||"");},AI,AH,p=1,w,q,AC,t=0,r=-1,AD,AJ,AG=0,AB=this.groupEnabled;for(AD=0,AI=0,AJ=z.cps?z.cps.length:1;AD<AJ;AD++){var v=z.cps?z.cps[AD]:z,x=v.rc;t=r+1;r=t+x-1;if(v.isDataAvailable(t,r)){if(v.lastRow){AG=v.lastRow;q=v.lastSection;}else{AI=AG||0;for(AH=0,p=this.sectionMap[AI-1]||0;AH<x;AH++){var u=this.stackLevels;AC=AE(v,AH);if(AB&&AC!==q){q=AC;this.sectionInfo.push({sn:AC,rs:this.srh*p+this.stackedRh*Math.floor((AI-p)/this.stackLevels)});this.sectionMap[AI]=++p;AI++;}while(u){this.sectionMap[AI]=p;u--;AI++;}}AG=v.lastRow=AI;v.lastSection=AC;}}else{break;}}this.rc=(this.stackLevels>1?AF*this.stackLevels:AF)+(AB?p:0);}},onDemandDataReady:function c(){this.adjustCPMaps();},initContent:function Z(AA){var z=this.cps,AL=this.gridData=z[0].gridData||z[0].cps[0].gridData,AH=AL.vp=this.gridVp=this.gridVp||AL.vp,r=AH.daf&&AH.daf.split(":"),AB=AH.cols,AC=AB.cg,AI=AB.cws,x=z[A(AC)],AF=AL.gts.row,q=AL.gts,AJ=a(z,AL),w=x.type!==b,AE,AG,u,p,AD,v,AK,t=(typeof (mstrMobileApp)!=="undefined"&&mstrMobileApp.getDeviceDPI)?mstrMobileApp.getDeviceDPI():160;if(t===160){F={1:33,2:22,3:20,4:30,5:53,6:40,7:27,8:53};B={1:11,2:11,3:1,4:16,5:16};}else{if(t===213){F={1:45,2:31,3:26,4:39,5:71,6:40,7:35,8:71};B={1:15,2:15,3:2,4:21,5:21};}else{if(t===240){F={1:50,2:34,3:30,4:44,5:80,6:40,7:40,8:80};B={1:16,2:16,3:2,4:24,5:24};}else{if(t===320){F={1:67,2:44,3:38,4:58,5:107,6:40,7:53,8:107};B={1:22,2:22,3:2,4:32,5:32};}else{F={1:33,2:22,3:20,4:30,5:53,6:40,7:27,8:53};B={1:11,2:11,3:1,4:16,5:16};}}}}if(w){if(AH.dafIdx===undefined&&r){for(AE=0;AE<AF.length;AE++){if(AF[AE].id===r[0]&&AF[AE].fid===r[1]){AH.dafIdx=AE;break;}}}}for(AE=0;AE<AC.cgc;AE++){if(AC[AE]&&AC[AE].tg){break;}}if(AE===AC.cgc){AL.gts.show=false;AL.ghs.chs.show=false;}this._super(AA);this.colWidths=S(AH,this.gridWidth);this.tdWidths=S(AH,this.gridWidth,true);if(w){this.stackLevels=m(AB);if(this.stackLevels>1){this.srh=F[M];this.rh=F[n];this.mrh=F[G];this.stackedRh=F[h]+(this.stackLevels-2)*F[j]+F[G];}else{this.srh=F[M];this.rh=this.stackedRh=this.mrh=F[n];}if(AJ||this.stackLevels>1){this.sectionMap=[];this.sectionInfo=[];this.groupEnabled=AJ;this.adjustCPMaps();p=this.cps[0].cps;if(p){AK=this;for(AE=0,AG=p.length;AE<AG;AE++){v=p[AE];if(v&&v.addCPListener){v.addCPListener(AK);}}}}}},getUnmergedCells:function(p){return ;},getResolvedGroupHeader:function(t,v){var q=this.gridData,u=q.gts.row[v].es,p=q.ghs.rhs.items[t].items[v];if(p){if(!p.css){p.css=q.css[p.cni].n+" iggroup";p.n=u[p.idx].n;}}else{return{css:" iggroup",n:""};}return p;},getRowCells:function(AJ){var AE=this.cps,w=[],AX=this.gridData,AT=AX.vp,AH=AT.cols.cg,AC=AE[A(AH)],AG=this.groupEnabled,r=AT.bn==="1",AU=[],AI=Q.call(this,AJ),x,t,AK=1,AD,q,AA,AQ,AP,AS,AW,AB;if(AG&&(this.sectionMap[AJ]!==this.sectionMap[AJ-1])){var u=U.copy(AC.getRowCells(AI)[0],{});u.cs=this.colWidths.length;u.rowType=M;k(u,{col:null,type:AC.type,extraCss:[J.GROUPING]});return[u];}if(!AJ){C.call(this);}this.lastAttRow=this.lastAttRow||(AE[0].rc?AE[0].getRowCells(AI):[]);this.lastMtxRow=this.lastMtxRow||(AE[1].rc?AE[1].getRowCells(AI):[]);AA=this.lastAttRow;AS=AA.length;if(AS>0&&AA[0].stt){AD=true;for(AQ=0;AQ<AS;AQ++){AW=AA[AQ];if(AW.stt===R){q=AW;break;}}}if(!this.lastStackCols){W.forEach([this.lastAttRow,this.lastMtxRow],function(p){for(AQ=0;AQ<p.length;AQ++){if(p[AQ]._ei!==undefined){if(AT.dafIdx>=0){AB=AC.getRowCells(AI)[AT.dafIdx];}x=(AT.dafIdx>=0)?(AB&&AB._ei):"";return false;}}},this);var AO=function(p,AY){if(p&&(AY.type===b||AY.type===f)){if(AM.tg===false){p.n=p.v="";}p.rowType=l;}k(p,{col:AM,type:AY.type,extraCss:[((AY.type===X||AY.type===o)&&r&&(AI%2===1))?J.BANDING:null,AD?J.TOTAL_ROW:null]});if(p){p.cs=1;if(p._ei===undefined&&AT.dafIdx!==undefined){p._ei=x;}}};this.lastRowIndex=0;for(AP=0;AP<AH.cgc;AP++){var AM=AH[AP],AR=AM["mix"+AM.cc],v=AR!==undefined,z=AE[v?1:0],AN,AL,AF,AV={n:"",stt:R,css:"xtab-td"};arr=[];if(AM.tg){for(var AQ=0;AQ<AM.cl;AQ++){arr=[];AF=v?AM["mix"+AQ]:AM.attForms[AQ].idx;var AA=v?this.lastMtxRow:this.lastAttRow;AW=AA[AF];if(AD){if(!AW){AW=AV;}else{if(AW&&AW.stt===R){AW=U.copy(q,AV);}else{AW=U.copy(AW,{});}}}else{AW=U.copy(AW,{});}AO(AW,z);arr.push(AW);AU.push(arr);}if(AP+1===AH.cgc){AK=AM.cl;}}else{for(AN=0,AS=AM.cl;AN<AS;AN++){if(v){AL=AM["mix"+AN];if(AL!==undefined){AW=this.lastMtxRow[AL];}}else{AL=AM.attForms[AN];if(AL){AW=this.lastAttRow[AL.idx];}if(AD&&!AW){AW=AV;}}AO(AW,z);arr.push(AW);}AU.push(arr);}}this.lastStackCols=AU;}w=P(this.lastStackCols,this.lastRowIndex++,this.stackLevels,AT);if(this.lastRowIndex>=this.stackLevels){C.call(this);}return w;},getRowHeight:function E(q){var p=F[n];return F[q]||p;},getPadding:function K(p){return B[p]||B[Y];},isDataAvailable:function g(q,p){if(!this.onDemandIF||!this.cps[1].cps){return true;}else{var t=this.sectionMap.length,r;if(!t){return this.cps[1].isDataAvailable(q,p);}if(p>t){if(q<t){r=Q.call(this,q);return this.cps[1].isDataAvailable(r,r+(p-q));}else{return false;}}else{return this.cps[1].isDataAvailable(Q.call(this,q),Q.call(this,p));}}},download:function H(w,t,x){var r=Q.call(this,w),p=r+Math.ceil((t-w)/this.stackLevels),u=this.cps[0],q,z,v=!u.cps?[u]:this.cps[0]._getCPs(r,p);for(q=0;q<v.length;++q){z=v[q];z.download(r,p,x);}},getRowCellInfo:function(t){var r=D.call(this,t+this.srh),p,q=this.lastSectionIndex;if(r){p=this.sectionInfo[q-1];return{rowStart:r.rs,isNextRowNewSection:true,sectionName:p&&p.sn};}else{return{isNextRowNewSection:false,sectionName:this.sectionInfo[q].sn};}}});}());(function(){mstrmojo.requiresCls("mstrmojo.vi.ui.TargetSelector");mstrmojo.vi.ui.LinkTargetSelector=mstrmojo.declare(mstrmojo.vi.ui.TargetSelector,null,{scriptClass:"mstrmojo.vi.ui.LinkTargetSelector",preChangeTargetSelectionMode:function A(D,C){},enterTargetSelectionMode:function B(C){C.setMaskClass(this.srcId);C.set("enabled",C instanceof mstrmojo.vi.ui.rw.VizBox);}});}());(function(){mstrmojo.requiresCls("mstrmojo.array","mstrmojo.gmaps.MapEnums","mstrmojo.mstr.EnumDSSXMLObjectTypes","mstrmojo.vi.viz.EnumVizStyles");mstrmojo.requiresClsP("mstrmojo.vi.viz","MapHelper","EnumDSSDropZones","VisualizationTransition","GraphMatrixHelper","HeatMapVisualizationHelper","ImageLayoutHelper","NetworkVisualizationHelper");var Z=mstrmojo,N=Z.array,F=mstrmojo.gmaps,E=F.EnumGraphicType,I=F.EnumPropertyType,Y=Z.vi.viz,X=Y.EnumDSSDropZones,P=Y.MapHelper,O="Grid",C=mstrmojo.mstr.EnumDSSXMLObjectTypes,B=mstrmojo.vi.viz.EnumVizStyles,M="-1";function V(b){return new Y.MapHelper(b);}function D(e,d,b,f,c,g){if(e){g.push({act:"addDropZoneUnit",zoneId:b,unitId:e,unitType:d});}switch(b){case X.GeoAttribute:c.geoAttribute=e;break;case X.Latitude:c.latitude=e;break;case X.Longitude:c.longitude=e;break;case X.ColorBy:c.colorBy=e;break;case X.SizeBy:c.sizeBy=e;break;case X.AdditionalMetrics:c.tooltip.push(e);break;case X.Angle:c.angle=e;break;case X.SliceBy:c.slice.push(e);break;}}function K(e,d,b,f,c,g){D(e,d,b,f,c,g);if(c.isMapbox&&P.shouldSyncItemToTooltipZone(e,b,c&&c.tooltip)){D(e,d,X.AdditionalMetrics,f,c,g);}}function R(b,c){return{act:"updateTemplate",actions:b,keyContext:c};}function S(b,c){return b.geoAttribute===c||b.latitude===c||b.longitude===c||b.colorBy===c||b.sizeBy===c||b.slice===c||b.angle===c;}function G(b,d){var c=false;N.forEach(b.slice,function(e){if(e===d){c=true;return false;}});return c;}function L(e,d,c){var f;switch(e){case B.GRAPH_MATRIX:f=new Y.GraphMatrixHelper({data:d});f.setData(d.dz);N.forEach(f.colorByObjects,function(h){if(f.isMetric(h)){f.colorByItem=h;return false;}});f.sizeByItem=f.sizeByObjects&&f.sizeByObjects[0];f.angleItem=f.angleObjects&&f.angleObjects[0];f.sliceItem=f.sliceObjects;break;case B.HEAT_MAP:f=new Y.HeatMapVisualizationHelper({data:d});f.setData(d.dz);f.colorByItem=f.getFirstColorByUnit(true);f.sizeByItem=f.sizeByMetric;break;case B.IMAGE_LAYOUT:f=new Y.ImageLayoutHelper();f.setData(d.dz);f.colorByItem=f.colorByMetric;f.sizeByItem=f.sizeByMetric;break;case B.NETWORK:f=new Y.NetworkVisualizationHelper();f.setData(d.dz);f.colorByItem=f.edgeColorMetric;f.sizeByItem=f.nodeSizeMetric;break;case B.GOOGLE_MAP:case B.ESRI_MAP:case B.MAPBOX:var g=e===B.MAPBOX,b;f=V({isMapbox:g,data:d});f.setWidget(c.getTopLayerHost());b=f.getColorByUnit();f.colorByItem=(b&&b.t)===C.Metric?b:undefined;f.sizeByItem=f.getSizeByUnit();break;default:f=null;break;}return f;}function Q(p,h,o,f,b){var g=function(q){o.setMapType(E.Bubble);K(q,C.Metric,X.SizeBy,h,o,f);},l=function(q){K(q,C.Metric,X.ColorBy,h,o,f);},c=function(q){K(q,C.Attribute,X.SliceBy,h,o,f);},k=function(q){K(q,C.Metric,X.Angle,h,o,f);},n=L(p,h,b),e,j,d,m;if(n){e=n.colorByItem&&n.colorByItem.did;j=n.sizeByItem&&n.sizeByItem.did;d=n.sliceItem;m=n.angleItem&&n.angleItem.did;if(j&&(o.vp.gtp===undefined||o.showSizeByZone(o.vp))){g(j);}else{if(o.vp.gtp===undefined){o.setMapType(E.Marker);}}if(o.showColorByZone(o.vp)&&e){l(e);}if(!o.isMapbox){if(o.showSliceZone(o.vp)&&d){N.forEach(d,function(q){c(q.did);});}if(o.showAngleZone(o.vp)&&m){k(m);}}}}function a(f,c,d,b,e){if(f&&f.length){if(b.showColorByZone(b.vp)&&!b.colorBy){N.forEach(f,function(h){if(!S(b,h)){K(h.did,C.Metric,X.ColorBy,d,b,e);return false;}});}if(b.showSizeByZone(b.vp)&&!b.sizeBy){N.forEach(f,function(h){if(!S(b,h)){K(h.did,C.Metric,X.SizeBy,d,b,e);return false;}});}if(b.showAngleZone(b.vp)&&!b.angle){N.forEach(f,function(h){if(!S(b,h)){K(h.did,C.Metric,X.Angle,d,b,e);return false;}});}if(b.showSliceZone(b.vp)&&!b.slice){var g=0;N.forEach(c,function(h){if(g===2){return false;}if(!G(b,h)){K(h.did,C.Attribute,X.Angle,d,b,e);g++;}});}}}function U(w,o,e,l){var b=w.gts,t=w.gsi,j=b&&b.row,g=b&&b.col,f=(j||[]).concat(g||[]),z=null,h=null,x=null,d=0,c=false,p=(t&&t.rows||[]).concat(t&&t.cols||[]),k=[],q=function(AA){N.forEach(f,function(AC){var AB;N.forEach(AC.fs,function(AD){return AB=AA(AC,AD);});return AB;});},r=function(AA){return P.isLatitude(AA.n,AA.fgr);},m=function(AA){return P.isLongitude(AA.n,AA.fgr);},v=function(AB,AA){k.push({act:"addForm",unitId:AB,attFormId:AA,unitPos:1});},u=function(AD,AB,AA){var AC=[];N.forEach(AB,function(AE){AC.push(AE.id);});N.forEach(AA,function(AE){if(AC.indexOf(AE.fid)===-1){v(AD,AE.fid);}});},n=function(AA){if(AA){var AB={};N.forEach(Object.keys(l),function(AC){N.forEach(l[AC].att,function(AD){AB[AD.did]=AD;});});N.forEach(f,function(AC){if(AC.id){u(AC.id,AC.fs,AB[AC.id].fs);AC.fs=AB[AC.id].fs;}});}q(function(AD,AC){if(P.isGeoRoleSupportArea(AC.fgr)){z=AD;return false;}});if(z){K(z.id,C.Attribute,X.GeoAttribute,w,e,o);N.forEach(k,function(AC){o.push(AC);});if(AA){e.setUseAttributeForm(true);}e.setMapType(E.Area);return ;}if(!z){N.forEach(f,function(AC){var AD=AC.id;q(function(AF,AE){if(AF.id===AD&&r(AE)){h=AE.id||AE.fid;d=AF.card;}if(AF.id===AD&&m(AE)&&AE.id!==h){x=AE.id||AE.fid;d=AF.card;}});if(h&&x){z={id:AC.id};return false;}h=null;x=null;});if(z){K(z.id,C.Attribute,X.GeoAttribute,w,e,o);K(h,C.AttributeForm,X.Latitude,w,e,o);K(x,C.AttributeForm,X.Longitude,w,e,o);N.forEach(k,function(AC){o.push(AC);});e.setUseAttributeForm(true);return ;}}if(!z&&!AA){q(function(AD,AC){if(r(AC)||P.isLatitude(AD.n)){h=AD.id;d=AD.card;}if((m(AC)||P.isLongitude(AD.n))&&(h!==AD.id)){x=AD.id;d=AD.card;}});if(h&&x){K(h,C.Attribute,X.Latitude,w,e,o);K(x,C.Attribute,X.Longitude,w,e,o);e.setUseAttributeForm(false);return ;}}};if(w.egt!==undefined&&w.eg!==undefined&&w.eg!==""&&f.length===0&&p.length>0){N.forEach(p,function(AA){Object.keys(l).every(function(AB){(l[AB].att||[]).every(function(AC){if(AC.did===AA.did){c=true;f.push(AC);}return !c;});return !c;});});}n(false);if(!(z||(h&&x))){n(true);}if(o.length===0){e.setMapType(this.getDefaultGraphicType());}}function A(d,h,g,b){var f=d.gsi,c=f.rows||[],e=f.cols||[];N.forEach(c.concat(e),function(j){if(j.did!==M&&!S(b,j.did)&&!G(b,j.did)){K(j.did,j.t||C.Metric,X.AdditionalMetrics,d,b,g);}});N.forEach(h,function(j){if(j.did!==M&&!S(b,j.did)){K(j.did,j.t||C.Metric,X.AdditionalMetrics,d,b,g);}});}mstrmojo.vi.viz.MapVisualizationTransition=mstrmojo.declare(mstrmojo.vi.viz.VisualizationTransition,null,{scriptClass:"mstrmojo.vi.viz.MapVisualizationTransition",shouldSkipTransition:function J(b){return b===B.ESRI_MAP||b===B.GOOGLE_MAP;},transitionDropZones:function W(d){var c=this.vis,e=c.node,h=e.data,p=h.visName||O,n=this.scriptClass==="mstrmojo.vi.viz.MapboxVisualizationTransition",o=V({isMapbox:n}),k=h.gsi,m=k.mx,b=h&&h.gts,l=(b&&b.row||[]).concat(b&&b.col||[]),f=this.vis.model.docModel.datasets,j={act:"updateTemplate",keyContext:h.k,actions:[]},g=j.actions;if(this.shouldSkipTransition(p)){return{wp:"",handled:false};}U.call(this,h,g,o,f);Q(p,h,o,g,c);if(h.visName===B.GRAPH_MATRIX||h.visName===B.NEW_GRAPH_MATRIX){m=this.filterGMTrainingMetric(h.dz,m);}a(m,l,h,o,g);A(h,m,g,o);if(g.length){d.push(j);}if(o.colorBy){d.push(R(this.addThresholds({data:h},{did:o.colorBy,t:C.Metric},[]),h.k));}return{wp:o.getXml(),wgtName:o.vp[I.layerName],handled:false,gtp:o.getMapType(),ln:o.getLayerName()};},getDefaultGraphicType:function H(){return E.Marker;}});}());(function(){mstrmojo.requiresCls("mstrmojo.hash","mstrmojo.chart.model.enums.EnumDSSObjectType","mstrmojo.gm.GMEnums","mstrmojo.gm.EnumShape");mstrmojo.requiresClsP("mstrmojo.vi.viz","KnownVisualizations","EnumVizStyles","EnumVisualizationTemplates","VisualizationTransition","GraphMatrixHelper","HeatMapVisualizationHelper","NetworkVisualizationHelper","ImageLayoutHelper","MapHelper");var X=mstrmojo,Bn=mstrmojo.gm,CE=X.array,At=X.hash,CH=X.vi.viz,B1=CH.KnownVisualizations,Bs=CH.EnumVisualizationTemplates,A4=CH.EnumVizStyles,B3=A4.NEW_GRAPH_MATRIX,AA=CH.GraphMatrixHelper,L=mstrmojo.chart.model.enums.EnumDSSObjectType,BT=Bn.FormatingPropertyTag,AZ=Bn.WidgetPropertyTag,B0=Bn.EnumContainerFitModes,Ag="Grid",P=Bn.EnumShape,U=Bn.DualAxisSubAxisBit,CO=U.PRIMARY,F=U.SECONDARY,CQ=CH.EnumDSSDropZones,AW=CQ.XAxis,M=CQ.YAxis,An=CQ.Angle,AE=CQ.ColorBy,CU=1;var AT=Bs.GRAPHMATRIXVERTICALBARAUTOMATIC,A=Bs.GRAPHMATRIXVERTICALLINEAUTOMATIC,b=Bs.GRAPHMATRIXVERTICALAREAAUTOMATIC,BS=Bs.GRAPHMATRIXVERTICALBARSTACKED,Bf=Bs.GRAPHMATRIXVERTICALLINESTACKED,BH=Bs.GRAPHMATRIXVERTICALAREASTACKED,AD=Bs.GRAPHMATRIXBUBBLECIRCLEMM,As=Bs.GRAPHMATRIXBUBBLESQUAREMM,CS=Bs.GRAPHMATRIXSCATTERCIRCLEMM,AF=Bs.GRAPHMATRIXSCATTERSQUAREMM,a=Bs.GRAPHMATRIXBUBBLEGRIDCIRCLEAA,Ao=Bs.GRAPHMATRIXBUBBLEGRIDSQUAREAA,BU=Bs.GRAPHMATRIXSCATTERGRIDCIRCLEAA,CB=Bs.GRAPHMATRIXSCATTERGRIDSQUAREAA,A0=Bs.GRAPHMATRIXVERTICALBARCLUSTERED,AC=Bs.GRAPHMATRIXVERTICALLINECLUSTERED,Aa=Bs.GRAPHMATRIXVERTICALAREACLUSTERED,Ad=Bs.GRAPHMATRIXVERTICALBARPERCENT,Aq=Bs.GRAPHMATRIXVERTICALLINEPERCENT,AS=Bs.GRAPHMATRIXVERTICALAREAPERCENT,z=Bs.GRAPHMATRIXHORIZONTALBARAUTOMATIC,Am=Bs.GRAPHMATRIXHORIZONTALLINEAUTOMATIC,BD=Bs.GRAPHMATRIXHORIZONTALAREAAUTOMATIC,Ac=Bs.GRAPHMATRIXHORIZONTALBARCLUSTERED,BE=Bs.GRAPHMATRIXHORIZONTALLINECLUSTERED,Bc=Bs.GRAPHMATRIXHORIZONTALAREACLUSTERED,AO=Bs.GRAPHMATRIXHORIZONTALBARSTACKED,BF=Bs.GRAPHMATRIXHORIZONTALLINESTACKED,A9=Bs.GRAPHMATRIXHORIZONTALAREASTACKED,N=Bs.GRAPHMATRIXHORIZONTALBARPERCENT,AP=Bs.GRAPHMATRIXHORIZONTALLINEPERCENT,u=Bs.GRAPHMATRIXHORIZONTALAREAPERCENT,h=Bs.GRAPHMATRIXPIE,BM=Bs.GRAPHMATRIXRING,c=Bs.GRAPHCOMBINATIONBARAREA,R=Bs.GRAPHCOMBINATIONBARAREADUALAXIS,Aj=Bs.GRAPHMATRIXBUBBLESQUAREAM,x=Bs.GRAPHMATRIXSCATTERSQUAREAM,B9=Bs.GRAPHMATRIXVERTICALHISTOGRAM,n=Bs.GRAPHMATRIXGRIDCHART,BC=Bs.GRID,BV=Bs.GRAPHMATRIXVERTICALBOXPLOT,f=Bs.GRAPHMATRIXHORIZONTALBOXPLOT,Bw=Bs.GRAPHMATRIXVERTICALWATERFALL,CF=Bs.GRAPHMATRIXHORIZONTALWATERFALL;var BZ="nm",C="m",Bj="none",Y="any",A8="toggle",Az="MetricsInAny",Ay="MetricsInNone";function B5(Cb){var Ce=At.copy(Cb.data.gsi),Cc=Ce.tma===1?"rows":"cols",Ca=Ce[Cc],Cd=Ce.mx;Ce[Cc]=Ca.filter(function(Cf){return Cf.t!==-1&&Cf.did!=="-1";});if(Cd){Cd.forEach(function(Cf){Cf.t=4;});}return Ce;}function CW(Cc){var Cb=this.templateInfo,Ca;for(Ca=0;Ca<Cb.rows.length;Ca++){if(Cb.rows[Ca].did===Cc.id){Cb.rows.splice(Ca,1);return ;}}for(Ca=0;Ca<Cb.cols.length;Ca++){if(Cb.cols[Ca].did===Cc.id){Cb.cols.splice(Ca,1);return ;}}for(Ca=0;Ca<Cb.mx.length;Ca++){if(Cb.mx[Ca].did===Cc.id){Cb.mx.splice(Ca,1);return ;}}}function BR(Ca,Cb){Ca.MetricsDropZone=Cb;}function CD(Cd,Ca,Cb,Cc){Cd.Zones[Ca]={type:Cb,min:Cc};}function CT(Cc,Cb,Ca){Cc.Properties[Cb]=Ca;}function B6(Cb,Ca){return Cb.Zones[Ca];}function A5(Ca){var Cb={Zones:[],Properties:[]};switch(Ca){case AD:case As:BR(Cb,Az);CD(Cb,AA.PROP_XAXIS,C,1);CD(Cb,AA.PROP_YAXIS,C,1);CD(Cb,AA.PROP_SIZEBY,C,1);CD(Cb,AA.PROP_BREAKBY,Y,1);CD(Cb,AA.PROP_COLORBY,Y,0);break;case CS:case AF:BR(Cb,Az);CD(Cb,AA.PROP_XAXIS,C,1);CD(Cb,AA.PROP_YAXIS,C,1);CD(Cb,AA.PROP_SIZEBY,Bj,1);CD(Cb,AA.PROP_BREAKBY,BZ,1);CD(Cb,AA.PROP_COLORBY,BZ,0);break;case a:case Ao:BR(Cb,Ay);CD(Cb,AA.PROP_XAXIS,BZ,1);CD(Cb,AA.PROP_YAXIS,BZ,1);CD(Cb,AA.PROP_BREAKBY,Bj,0);CD(Cb,AA.PROP_SIZEBY,C,1);break;case BU:case CB:BR(Cb,Ay);CD(Cb,AA.PROP_XAXIS,BZ,1);CD(Cb,AA.PROP_YAXIS,BZ,1);CD(Cb,AA.PROP_BREAKBY,Bj,0);CD(Cb,AA.PROP_SIZEBY,Bj,0);CD(Cb,AA.PROP_COLORBY,C,1);break;case AT:case A:case b:BR(Cb,AA.PROP_ROWS);CD(Cb,AA.PROP_XAXIS,BZ,1);CD(Cb,AA.PROP_YAXIS,C,1);break;case A0:case AC:case Aa:case BC:BR(Cb,AA.PROP_ROWS);CD(Cb,AA.PROP_XAXIS,BZ,1);CD(Cb,AA.PROP_YAXIS,C,1);break;case BS:case Bf:case BH:case Bw:case BV:BR(Cb,AA.PROP_ROWS);CD(Cb,AA.PROP_XAXIS,BZ,1);CD(Cb,AA.PROP_YAXIS,C,1);break;case Ad:case Aq:case AS:BR(Cb,AA.PROP_ROWS);CD(Cb,AA.PROP_XAXIS,BZ,1);CD(Cb,AA.PROP_YAXIS,C,1);break;case z:case Am:case BD:BR(Cb,AA.PROP_ROWS);CD(Cb,AA.PROP_XAXIS,C,1);CD(Cb,AA.PROP_YAXIS,BZ,1);break;case Ac:case BE:case Bc:BR(Cb,AA.PROP_ROWS);CD(Cb,AA.PROP_XAXIS,C,1);CD(Cb,AA.PROP_YAXIS,BZ,1);break;case AO:case BF:case A9:case Bw:case f:BR(Cb,AA.PROP_ROWS);CD(Cb,AA.PROP_XAXIS,C,1);CD(Cb,AA.PROP_YAXIS,BZ,1);break;case N:case AP:case u:BR(Cb,AA.PROP_ROWS);CD(Cb,AA.PROP_XAXIS,C,1);CD(Cb,AA.PROP_YAXIS,BZ,1);break;case h:case BM:BR(Cb,AA.PROP_ROWS);CD(Cb,AA.PROP_SLICE,BZ,1);CD(Cb,AA.PROP_ANGLE,C,1);CD(Cb,AA.PROP_COLORBY,BZ,0);break;case c:case R:BR(Cb,AA.PROP_ROWS);CD(Cb,AA.PROP_XAXIS,BZ,1);CD(Cb,AA.PROP_YAXIS,C,1);break;case B9:CD(Cb,AA.PROP_YAXIS,C,1);CD(Cb,AA.PROP_XAXIS,BZ,1);}switch(Ca){case AD:case a:case CS:case BU:CT(Cb,AA.PROP_SHAPE,AA.PROP_SHAPE_CIRCLE);break;case Aj:case As:case Ao:case x:case AF:case CB:CT(Cb,AA.PROP_SHAPE,AA.PROP_SHAPE_SQUARE);break;case A0:case BS:case Ad:case Ac:case AO:case N:case AT:case z:CT(Cb,AA.PROP_SHAPE,AA.PROP_SHAPE_BAR);break;case AC:case Bf:case Aq:case BE:case BF:case AP:case A:case Am:CT(Cb,AA.PROP_SHAPE,AA.PROP_SHAPE_LINE);break;case Aa:case BH:case AS:case Bc:case A9:case u:case b:case BD:CT(Cb,AA.PROP_SHAPE,AA.PROP_SHAPE_AREA);break;case h:CT(Cb,AA.PROP_SHAPE,AA.PROP_SHAPE_PIE);break;case BM:CT(Cb,AA.PROP_SHAPE,AA.PROP_SHAPE_RING);break;case R:case n:CT(Cb,AA.PROP_SHAPE,AA.PROP_SHAPE_BAR);break;case B9:case Bw:case CF:case BV:case f:CT(Cb,AA.PROP_SHAPE,AA.PROP_SHAPE_BAR);break;}CT(Cb,AA.PROP_SUBTYPE,Bk(Ca));return Cb;}function Bk(Cb){var Ca=AA.PROP_SUBTYPE_AUTOMATIC;switch(Cb){case A0:case AC:case Aa:case Ac:case BE:case Bc:Ca=AA.PROP_SUBTYPE_CLUSTERED;break;case BS:case Bf:case BH:case AO:case BF:case A9:case AT:case z:case Bw:case CF:Ca=AA.PROP_SUBTYPE_STACKED;break;case Ad:case Aq:case AS:case N:case AP:case u:Ca=AA.PROP_SUBTYPE_PERCENT;break;case h:case BM:case A:case Am:case b:case BD:case R:Ca=AA.PROP_SUBTYPE_AUTOMATIC;break;}return Ca;}function Bp(Ca,Cc,Cb){if(Cc===Bj){return false;}if(Cc===Y){return true;}if((Ca.t===L.DssTypeMetric)&&(Cc===C)){return true;}if((Ca.t!==L.DssTypeMetric)&&(Cc===BZ)){return true;}if(Cc===A8){var Cd=B6(Cb,AA.PROP_XAXIS);if((Cd&&Cd.t===C)&&(Ca.t!==L.DssTypeMetric)){return true;}if((Cd&&Cd.t===BZ)&&(Ca.t===L.DssTypeMetric)){return true;}return false;}return false;}function Q(Cb){var Ca=false;switch(Cb){case Ac:case AO:case N:case BE:case BF:case AP:case Bc:case A9:case u:case z:case Am:case BD:Ca=true;break;default:break;}return Ca;}function BW(Cb){var Ca=false;switch(Cb){case AD:case a:case Aj:case As:case Ao:case CS:case BU:case x:case AF:case CB:Ca=true;break;default:break;}return Ca;}function E(Ca){return(Ca===c||Ca===R);}function Bi(Cb,Cc,Cd,Ca,Ce){if(Cc.length+Cd.length>=Ce.min){if(Cd.length){Cb[Ca].push(Cd.pop());}else{if(Cc.length){Cb[Ca].push(Cc.pop());}}}}function Bm(Cd,Cc,Cb){var Ch=this.templateInfo,Ce=Ch.rows,Cf=Ch.cols,Cg=B6(Cd,AA.PROP_SLICE);if(Cg&&Cg.type===BZ&&!Cc.sliceObjects.length){Bi(Cc,Ce,Cf,"sliceObjects",Cg);}Cg=B6(Cd,AA.PROP_XAXIS);if(Cg&&(Cg.type===BZ||Cg.type===Y)&&!Cc.xAxisObjects.length){Bi(Cc,Cf,Ce,"xAxisObjects",Cg);}Cg=B6(Cd,AA.PROP_YAXIS);var Ca=Cg&&((Cg.type===BZ)||(Cg.type===Y));if(!Ca&&Cg&&Cg.type===A8&&Cc.xAxisObjects.length){if(Cc.xAxisObjects[0].t===4){Ca=true;}}if(Ca){Bi(Cc,Ce,Cf,"yAxisObjects",Cg);}Cg=B6(Cd,AA.PROP_BREAKBY);if(Cg&&Cg.type===BZ&&!Cc.breakByObjects.length){if(Q(Cb)){Bi(Cc,Ce,Cf,"breakByObjects",Cg);}else{Bi(Cc,Cf,Ce,"breakByObjects",Cg);}}Cg=B6(Cd,AA.PROP_COLORBY);if(Cg&&Cg.type===BZ&&!Cc.colorByObjects.length){if(Cc.sliceObjects.length){Cc.colorByObjects.push(Cc.sliceObjects[0]);}else{if(Ce.length+Cf.length>=Cg.min){if(Q(Cb)){Bi(Cc,Ce,Cf,"colorByObjects",Cg);}else{Bi(Cc,Cf,Ce,"colorByObjects",Cg);}}}}}function g(Ca){if(Ca.getMetricCountInZone(Ca.xAxisObjects)>CU){return true;}if(Ca.getMetricCountInZone(Ca.yAxisObjects)>CU){return true;}if(Ca.angleObjects&&Ca.getMetricCountInZone(Ca.angleObjects)>CU){return true;}return false;}function Bq(Cd,Cb,Cc){if(g(Cc)){if(!Ba(Cc.colorByObjects)){Cc.secondaryMetricsDropZone=AA.PROP_COLORBY;}var Ca=Cd.MetricsDropZone;if(!Ca||Ca!=="null"){switch(Ca){case Ay:Cc.metricsDropZone="";break;case Az:Cc.metricsDropZone=AA.PROP_COLUMNS;break;default:Cc.metricsDropZone=Ca;break;}}}}function Bz(Cc,Cb,Ca){var Ce=this.templateInfo.mx,Cd;if(!Ce.length){return ;}Cd=B6(Cc,AA.PROP_ANGLE);if(Cd&&Cd.type===C&&!Cb.angleObjects.length&&Ce.length>=Cd.min){Cb.angleObjects.push(Ce[0]);Ce.splice(0,1);}Cd=B6(Cc,AA.PROP_XAXIS);if(Cd&&Cd.type===C&&!Cb.xAxisObjects.length&&Ce.length>=Cd.min){Cb.xAxisObjects.push(Ce[0]);Ce.splice(0,1);}Cd=B6(Cc,AA.PROP_YAXIS);if(Cd){var Cf=(Cd.type===C);if(!Cf&&Cd.type===A8){if(!Cb.xAxisObjects.length||Cb.xAxisObjects[0].t!==4){Cf=true;}}if(Cf&&!Cb.yAxisObjects.length){if(Ce.length>=Cd.min){Cb.yAxisObjects.push(Ce[0]);Ce.splice(0,1);if(Ce.length>0&&(Ca===c||Ca===R)){Cb.yAxisObjects.push(At.copy({ax:F},Ce[0]));Ce.splice(0,1);}}}}Cd=B6(Cc,AA.PROP_COLORBY);if(Cd&&Cd.type===C&&!Cb.colorByObjects.length){if(Ce.length>0){Cb.colorByObjects.push(Ce[0]);this.markedObjects.push(Ce[0]);}else{[{n:"sizeByObjects",fn:function(Cg){return Cb[Cg].length;}},{n:"xAxisObjects",fn:function(Cg){return Cb[Cg].length&&Cb[Cg][0].t===4;}},{n:"yAxisObjects",fn:function(Cg){return Cb[Cg].length&&Cb[Cg][0].t===4;}}].forEach(function(Ch){if(Ch.fn(Ch.n)){var Ci=Cb[Ch.n],Cg=At.copy(Ci[Ci.length-1]);Cg.ax=1;Cb.colorByObjects.push(Cg);}});}}Cd=B6(Cc,AA.PROP_SIZEBY);if(Cd&&Cd.type===C&&!Cb.sizeByObjects.length){if(Ce.length){Cb.sizeByObjects.push(Ce[0]);this.markedObjects.push(Ce[0]);}else{["colorByObjects","xAxisObjects","yAxisObjects"].forEach(function(Ci){var Ch=Cb[Ci],Cg=Ch.length;if(Cg&&Ch[0].t===4){Cb.sizeByObjects.push(Ch[Cg-1]);}});}}}function CK(Cd,Cc){var Cb=["rowObjects","columnObjects","xAxisObjects","yAxisObjects","colorByObjects","breakByObjects","sizeByObjects","sliceObjects","angleObjects"];for(var Cg=0;Cg<Cc.length;Cg++){var Cf=0;for(var Ce=0;Ce<Cb.length;Ce++){var Ca=Cb[Ce];Ca=Cd[Ca];Ca.forEach(function(Ch){if(Ch&&Ch.did==Cc[Cg].did){Cf++;}});}if(Cf===0&&Cc.length){Cd.tooltipMetrics.push(Cc[Cg]);}}}function K(Cb){var Ca=false;CE.forEach(this.markedObjects,function(Cc){if(Cc.did===Cb){Ca=true;return false;}});return Ca;}function CY(Cb){var Ca=this,Cc=this.templateInfo;Cc.rows.forEach(function(Cd){Cb.rowObjects.push(Cd);});Cc.cols.forEach(function(Cd){Cb.columnObjects.push(Cd);});Cc.mx.forEach(function(Cd){if(!K.call(Ca,Cd.did)){Cb.tooltipMetrics.push(Cd);}});}function CV(Cb,Cd){var Cc=Cb.Properties,Ca=this.newVizInfo.s==="NewGraphMatrixVisualizationStyle";if(Cc[AA.PROP_SHAPE]){Cd.shape=Cc[AA.PROP_SHAPE];}if(Cc[AA.PROP_SUBTYPE]&&(Ca||(Cd.subtype===""||Cd.subtype===AA.PROP_SUBTYPE_AUTOMATIC))){Cd.subtype=Cc[AA.PROP_SUBTYPE];}}function k(Cb,Ca,Cd){if(Ca.colorByObjects.length<=0){return ;}var Cc=Ca.colorByObjects[0];if(Cc.t===L.DssTypeMetric){this.addThresholds(Cb,Cc,Cd,undefined,undefined);}}function Ax(Ca,Cc){var Cb=(Ca.data.gts&&Ca.data.gts.row)||[];Cb.forEach(function(Cd){if(Cd.otp===12&&Cd.ast&&Cd.ast.length){Cc.push({act:"showDefinedSubtotals"});Cc.push({act:"showTotals",unitId:Cd.id,unitType:Cd.otp,subtotalType:[],clearSubtotalType:Cd.ast.map(function(Ce){return Ce.t;})});}});}function Ba(Ca){var Cb,Cc;for(Cb=0;Cb<Ca.length;Cb++){Cc=Ca[Cb];if(Cc.t===L.DssTypeMetric){return true;}}return false;}function AB(Cc){var Cf,Ce,Cd,Ca=false,Cb;for(Ce=0;Ce<Cc.sliceObjects.length;Ce++){Cf=Cc.sliceObjects[Ce];if(Cf.t===L.DssTypeAttribute){Cd=Cf;Ca=true;break;}}if(!Ca){return ;}Cb=Ba(Cc.xAxisObjects);if(!Cb){Cb=Ba(Cc.yAxisObjects);}if(!Cb){Cb=Ba(Cc.sizeByObjects);}if(!Cb){return ;}}function B2(Ca){switch(Ca){case A0:case BS:case Ad:case AC:case Bf:case Aq:case Aa:case BH:case AS:case AT:case A:case b:return true;default:return false;}}function BQ(Cd){if(!Cd.data.dz){return false;}var Ca=Cd.data.dz,Cc=mstrmojo.vi.viz.GraphMatrixHelper,Ce=Ca[Cc.PROP_XAXIS],Cg=Ce.TemplateUnit||Ce.TemplateMetric||[],Cb=Ca[Cc.PROP_YAXIS],Cf=Cb.TemplateUnit||Cb.TemplateMetric||[];if(Cf.length>0&&Cf[0].t===L.DssTypeMetric){if(Cg.length===0||Cg[0].t!==L.DssTypeMetric){return true;}}return false;}function Av(Cd){if(!Cd.data.dz){return false;}var Ca=Cd.data.dz,Cc=mstrmojo.vi.viz.GraphMatrixHelper,Ce=Ca[Cc.PROP_XAXIS],Cg=[],Cb=Ca[Cc.PROP_YAXIS],Cf=[];if(Ce){Cg=Ce.TemplateUnit||Ce.TemplateMetric||[];}if(Cb){Cf=Cb.TemplateUnit||Cb.TemplateMetric||[];}if(Cg.length>0&&(Cg[0].t===L.DssTypeMetric)){if(Cf.length===0||(Cf[0].t!==L.DssTypeMetric)){return true;}}return false;}function AX(Ca){return B2(Ca)||Q(Ca);}function o(Ca){switch(Ca){case AC:case Bf:case Aq:case BE:case BF:case AP:case A:case Am:return true;default:return false;}}function Au(Ca){switch(Ca){case Aa:case BH:case AS:case Bc:case A9:case u:case b:case BD:return true;default:return false;}}function Af(Cc,Cd,Cb){var Cf,Ce=0,Ca=0;if(Cb){Cf=Cb;}else{if(Av(Cd)){Cf="xAxisObjects";}else{Cf="yAxisObjects";}}Cc[Cf].forEach(function(Cg){if(Cg.ax===CO){Ca++;}else{if(Cg.ax===F){Ce++;}}});if(Ce&&Ca){return -1;}else{if(Ce){return F;}else{return CO;}}}function Al(Cf,Cb,Ca,Cc,Ce){if(this.isGraphMatrix(Cf)){if((Av(Ce)&&B2(Cb))||(Q(Cb)&&BQ(Ce))){var Cd;for(Cd=0;Cd<Ca.xAxisObjects.length;Cd++){Cc.yAxisObjects.push(Ca.xAxisObjects[Cd]);CW.call(this,Ca.xAxisObjects[Cd]);}for(Cd=0;Cd<Ca.yAxisObjects.length;Cd++){Cc.xAxisObjects.push(Ca.yAxisObjects[Cd]);CW.call(this,Ca.yAxisObjects[Cd]);}}}}function BA(Ca,Cb,Cc){if(g(Cb)){if(Ca.secondaryMetricsDropZone){Cb.secondaryMetricsDropZone=Ca.secondaryMetricsDropZone;}if(!Cc&&Ca.metricsDropZone==="BreakBy"){Cb.metricsDropZone="BreakBy";}else{if(Cb.angleObjects.length>1){Cb.metricsDropZone="Rows";}else{if(Ca.metricsDropZone){Cb.metricsDropZone=Ca.metricsDropZone;}else{if(Cb.xAxisObjects.length>1&&Cb.xAxisObjects[0].t===4){Cb.metricsDropZone="Columns";}else{Cb.metricsDropZone="Rows";}}}}}else{Cb.metricsDropZone="";Cb.secondaryMetricsDropZone="";}}function AK(Ca,Cb){if(g(Cb)){if(Ca.secondaryMetricsDropZone){Cb.secondaryMetricsDropZone=Ca.secondaryMetricsDropZone;}if(Ca.metricsDropZone==="BreakBy"){Cb.metricsDropZone="BreakBy";}else{Cb.metricsDropZone="Rows";}}else{Cb.metricsDropZone="";Cb.secondaryMetricsDropZone="";}}function I(Ca,Cb){if(g(Cb)){if(Ca.secondaryMetricsDropZone){Cb.secondaryMetricsDropZone=Ca.secondaryMetricsDropZone;}if(Ca.metricsDropZone){if(Ca.metricsDropZone==="SliceBy"){Cb.metricsDropZone="BreakBy";}else{Cb.metricsDropZone=Ca.metricsDropZone;}}else{if(Cb.xAxisObjects.length>1&&Cb.xAxisObjects[0].t===4){Cb.metricsDropZone="Columns";}else{Cb.metricsDropZone="Rows";}}}else{Cb.metricsDropZone="";Cb.secondaryMetricsDropZone="";}}function CJ(Cg,Ca,Cd,Cp,Cl,Cn){var Cj,Co,Cm,Cq,Cb=(Cp===Bs.GOOGLEMAP||Cp===Bs.ESRIMAP);if(Cp===Bs.HEATMAP){Cq=new CH.HeatMapVisualizationHelper();Cq.setData(Cn.data.dz);}else{if(Cb){var Cs=CH.MapHelper;Cq=new Cs({data:Cn.data});Cq.setWidget(this.vis);}}if(this.isGraphMatrix(Cp)){if(Ca.xAxisObjects.length>0){Cj=B6(Cg,AA.PROP_XAXIS);if(!Cj||Bp(Ca.xAxisObjects[0],Cj.type,Cg)){for(Co=0;Co<Ca.xAxisObjects.length;Co++){Cm=Ca.xAxisObjects[Co];Cd.xAxisObjects.push(Cm);CW.call(this,Cm);}}}if(Ca.yAxisObjects.length>0){Cj=B6(Cg,AA.PROP_YAXIS);if(!Cj||Bp(Ca.yAxisObjects[0],Cj.type,Cg)){for(Co=0;Co<Ca.yAxisObjects.length;Co++){Cm=Ca.yAxisObjects[Co];Cd.yAxisObjects.push(Cm);CW.call(this,Cm);}}}if(Ca.breakByObjects.length>0){Cj=B6(Cg,AA.PROP_BREAKBY);if(!Cj||Bp(Ca.breakByObjects[0],Cj.type,Cg)){for(Co=0;Co<Ca.breakByObjects.length;Co++){Cm=Ca.breakByObjects[Co];Cd.breakByObjects.push(Cm);CW.call(this,Cm);}}}}var Cr=[];if(this.isGraphMatrix(Cp)){for(Co=0;Co<Ca.colorByObjects.length;Co++){Cr.push(Ca.colorByObjects[Co]);}}else{if(Cp===Bs.HEATMAP){Cq.colorBy.forEach(function(Ct){Cr.push(Ct);});}else{if(Cb&&Cq.showColorByZone()){var Ch=Cq.getColorByUnit();if(Ch){Cr.push(Ch);}}}}if(Cr.length){Cj=B6(Cg,AA.PROP_COLORBY);var Ce=(!Cj||Bp(Cr[0],Cj.type,Cg));if(Ce){for(Co=0;Co<Cr.length;Co++){Cm=Cr[Co];Cd.colorByObjects.push(Cm);this.markedObjects.push(Cm);}}}var Cf=[];if(this.isGraphMatrix(Cp)){for(Co=0;Co<Ca.sizeByObjects.length;Co++){Cf.push(Ca.sizeByObjects[Co]);}}else{if(Cp===Bs.HEATMAP){if(Cq.sizeByMetric){Cf.push(Cq.sizeByMetric);}}else{if(Cb&&Cq.showSizeByZone()){var Ci=Cq.getSizeByUnit();if(Ci){Cf.push(Ci);}}}}if(Cf.length>0){Cj=B6(Cg,AA.PROP_SIZEBY);var Cc=Cg.Properties[AA.PROP_SHAPE],Ck;Ck=(Cc!=="Area")&&(!Cj||Bp(Cf,Cj.type,Cg));if(Ck){for(Co=0;Co<Cf.length;Co++){Cm=Cf[Co];Cd.sizeByObjects.push(Cm);this.markedObjects.push(Cm);}}}}function CP(Ch,Ca){if(Ca){var Cf,Cb,Ci,Cg=[],Cc=[];["columnObjects","rowObjects","xAxisObjects","yAxisObjects","breakByObjects","colorByObjects","sizeByObjects"].forEach(function(Cj){Cf=Ch[Cj];for(Cb=0;Cb<Cf.length;Cb++){Ci=Cf[Cb];if(B7(Ch.tooltipMetrics,Ci)===-1){if(Ci.t===12){Cc.push(Ci);}else{Cg.push(Ci);}}}});Ch.tooltipMetrics=Cc.concat(Ch.tooltipMetrics).concat(Cg);}else{var Ce=[];for(var Cd=0;Cd<Ch.tooltipMetrics.length;Cd++){if(Ch.tooltipMetrics[Cd].t===L.DssTypeMetric){Ce.push(Ch.tooltipMetrics[Cd]);}}Ch.tooltipMetrics=[];CK(Ch,Ce);}}function m(Cb){var Cd=this.templateInfo,Cf=Cd.mx,Ca=this.vis.model.data.gsi,Cc=this.definition;if(Cd.cols.length&&Cd.rows.length){Cb.xAxisObjects.push(Cd.cols.pop());Cb.yAxisObjects.push(Cd.rows.pop());CA(Cd.cols,Cb.columnObjects);CA(Cd.rows,Cb.rowObjects);}else{var Ce=Cd.rows.concat(Cd.cols);if(Ce.length){Cb.xAxisObjects.push(Ce.pop());}if(Ce.length){Cb.yAxisObjects.push(Ce.pop());}CA(Ce,Cb.rowObjects);}if(Cf.length>1){Cb.sizeByObjects.push(Cf.splice(0,1)[0]);}else{if(Cf.length===1&&Cb.xAxisObjects.length){Cb.sizeByObjects.push(Cf.splice(0,1)[0]);Cb.colorByObjects.push(Cb.xAxisObjects[0]);}}if(Cf.length){Cb.colorByObjects.push(Cf.splice(0,1)[0]);CA(Cf,Cb.tooltipMetrics);}}function AG(Cb){var Cd=this.templateInfo,Cg=Cd.mx,Ca=this.vis.model.data.gsi,Cc=this.definition;if(Cd.cols.length&&Cd.rows.length){var Cf;Ca.rows.forEach(function(Ch){if(Ch.n==="Metrics"){Cf="Rows";}});Ca.cols.forEach(function(Ch){if(Ch.n==="Metrics"){Cf="Columns";}});Cb.metricsDropZone=Cf;if(Cf==="Rows"){if(Ca.rows[Ca.rows.length-1].n==="Metrics"){Cg.forEach(function(Ch){Cb.yAxisObjects.push(Ch);});Cb.xAxisObjects.push(Cd.cols.pop());Cd.cols.forEach(function(Ch){Cb.columnObjects.push(Ch);});Cd.rows.forEach(function(Ch){Cb.rowObjects.push(Ch);});}else{Cb.yAxisObjects.push(Ca.rows.pop());Cd.rows.forEach(function(Ch){Cb.rowObjects.push(Ch);});Cg.forEach(function(Ch){Cb.xAxisObjects.push(Ch);});Cd.cols.forEach(function(Ch){Cb.columnObjects.push(Ch);});}}else{if(Cf==="Columns"){if(Ca.cols[Ca.cols.length-1].n==="Metrics"){Cg.forEach(function(Ch){Cb.xAxisObjects.push(Ch);});Cb.yAxisObjects.push(Cd.rows.pop());Cd.cols.forEach(function(Ch){Cb.columnObjects.push(Ch);});Cd.rows.forEach(function(Ch){Cb.rowObjects.push(Ch);});}else{if(Ca.cols.length){Cb.xAxisObjects.push(Ca.cols.pop());}Cd.cols.forEach(function(Ch){Cb.columnObjects.push(Ch);});Cd.rows.forEach(function(Ch){Cb.rowObjects.push(Ch);});Cg.forEach(function(Ch){Cb.yAxisObjects.push(Ch);});}}}}else{Cg.forEach(function(Ch){Cb.yAxisObjects.push(Ch);});if(Cd.cols.length+Cd.rows.length===1){Bi(Cb,Cd.cols,Cd.rows,"xAxisObjects",B6(Cc,AA.PROP_XAXIS));}else{var Ce=Cd.rows.concat(Cd.cols);if(Ce.length){Cb.breakByObjects.push(Ce.pop());}if(Ce.length){Cb.xAxisObjects.push(Ce.pop());}Ce.forEach(function(Ch){Cb.columnObjects.push(Ch);});}if(Cb.xAxisObjects.length>1&&Cb.xAxisObjects[0].t===4){Cb.metricsDropZone="Columns";}else{if(Cb.yAxisObjects.length>1&&Cb.yAxisObjects[0].t===4){Cb.metricsDropZone="Rows";}else{Cb.metricsDropZone="";}}Cb.secondaryMetricsDropZone="";}}function Bb(Cg){var Ca=this.templateInfo,Ch=Ca.mx,Ci=this.vis.model.data.gsi,Cb=this.definition;for(var Cd=0;Cd<(Ch.length/2);Cd++){Cg.yAxisObjects.push(Ch[Cd]);}for(Cd=Math.ceil(Ch.length/2);Cd<Ch.length;Cd++){Cg.xAxisObjects.push(Ch[Cd]);}if(Ca.cols.length&&Ca.rows.length){var Cf;Ci.rows.forEach(function(Cj){if(Cj.n==="Metrics"){Cf="Rows";}});Ci.cols.forEach(function(Cj){if(Cj.n==="Metrics"){Cf="Columns";}});Cg.metricsDropZone=Cf;if(Cf==="Rows"){if(Ci.rows[Ci.rows.length-1].n==="Metrics"){Cg.breakByObjects.push(Ca.cols.pop());Ca.rows.forEach(function(Cj){Cg.rowObjects.push(Cj);});}else{var Cd=0,Cc=false;while(Cc===false){if(Ci.rows[Cd].n!=="Metrics"){Cg.rowObjects.push(Ca.rows[Cd]);Cd++;}else{Cc=true;}}while(Cd<Ca.rows.length){Cg.breakByObjects.push(Ca.rows[Cd]);Cd++;}}Ca.cols.forEach(function(Cj){Cg.columnObjects.push(Cj);});}else{if(Cf==="Columns"){if(Ci.cols[Ci.cols.length-1].n==="Metrics"){Ch.forEach(function(Cj){Cg.xAxisObjects.push(Cj);});Cg.breakByObjects.push(Ca.rows.pop());Ca.cols.forEach(function(Cj){Cg.columnObjects.push(Cj);});}else{var Cd=0,Cc=false;while(Cc===false){if(Ci.cols[Cd].n!=="Metrics"){Cg.columnObjects.push(Ca.cols[Cd]);Cd++;}else{Cc=true;}}while(Cd<Ca.cols.length){Cg.breakByObjects.push(Ca.cols[Cd]);Cd++;}}Ca.rows.forEach(function(Cj){Cg.rowObjects.push(Cj);});}}}else{if(Ca.cols.length+Ca.rows.length===1){Bi(Cg,Ca.cols,Ca.rows,"breakByObjects",B6(Cb,AA.PROP_BREAKBY));}else{if(Ca.cols.length+Ca.rows.length>1){var Ce=Ca.rows.concat(Ca.cols);if(Ce.length){Cg.breakByObjects=Ce.splice(-2,2);Ce.forEach(function(Cj){Cg.columnObjects.push(Cj);});}}}if(Cg.xAxisObjects.length>1&&Cg.xAxisObjects[0].t===4){Cg.metricsDropZone="Columns";}else{if(Cg.yAxisObjects.length>1&&Cg.yAxisObjects[0].t===4){Cg.metricsDropZone="Rows";}else{Cg.metricsDropZone="";}}Cg.secondaryMetricsDropZone="";}}function BY(Cg){var Ca=this.templateInfo,Ch=Ca.mx,Ci=this.vis.model.data.gsi,Cb=this.definition;Ch.forEach(function(Cj){Cg.angleObjects.push(Cj);});if(Ca.cols.length&&Ca.rows.length){var Cf;Ci.rows.forEach(function(Cj){if(Cj.n==="Metrics"){Cf="Rows";}});Ci.cols.forEach(function(Cj){if(Cj.n==="Metrics"){Cf="Columns";}});Cg.metricsDropZone=Cf;if(Cf==="Rows"){if(Ci.rows[Ci.rows.length-1].n==="Metrics"){Cg.sliceObjects.push(Ca.cols.pop());Ca.rows.forEach(function(Cj){Cg.rowObjects.push(Cj);});}else{Cg.sliceObjects.push(Ca.rows.pop());var Cd=0,Cc=false;while(Cc===false){if(Ci.rows[Cd].n!=="Metrics"){Cg.rowObjects.push(Ca.rows[Cd]);Cd++;}else{Cc=true;}}while(Cd<Ca.rows.length){Cg.xAxisObjects.push(Ca.rows[Cd]);Cd++;}}Ca.cols.forEach(function(Cj){Cg.columnObjects.push(Cj);});}else{if(Cf==="Columns"){if(Ci.cols[Ci.cols.length-1].n==="Metrics"){Cg.sliceObjects.push(Ca.rows.pop());Ca.cols.forEach(function(Cj){Cg.columnObjects.push(Cj);});}else{Cg.sliceObjects.push(Ca.cols.pop());var Cd=0,Cc=false;while(Cc===false){if(Ci.cols[Cd].n!=="Metrics"){Cg.columnObjects.push(Ca.cols[Cd]);Cd++;}else{Cc=true;}}while(Cd<Ca.cols.length){Cg.xAxisObjects.push(Ca.cols[Cd]);Cd++;}}Ca.rows.forEach(function(Cj){Cg.rowObjects.push(Cj);});}}}else{var Ce=Ca.rows.concat(Ca.cols);if(Ce.length){Cg.sliceObjects.push(Ce.pop());}if(Ce.length){Cg.xAxisObjects.push(Ce.pop());Ce.forEach(function(Cj){Cg.columnObjects.push(Cj);});}}if(Cg.xAxisObjects.length>1&&Cg.xAxisObjects[0].t===4){Cg.metricsDropZone="Columns";}else{if(Cg.yAxisObjects.length>1&&Cg.yAxisObjects[0].t===4){Cg.metricsDropZone="Rows";}else{if(Cg.angleObjects.length>1){Cg.metricsDropZone="Rows";}else{Cg.metricsDropZone="";}}}Cg.secondaryMetricsDropZone="";}function B7(Ca,Cb){return CE.find(Ca,"did",Cb.did);}function Br(Ca){return Ca.t===L.DssTypeMetric;}function Bx(Ca){return Ca&&Ca.t!==L.DssTypeMetric;}function CA(Cb,Cd,Ce){var Ca=false,Cc=function(){return true;};if(Ce){Cc=Ce===L.DssTypeMetric?Br:Bx;}if(Cb.length&&(Cc(Cb[0])||Ce===undefined)){Cb.forEach(function(Cf){if(B7(Cd,Cf)===-1){Cd.push(Cf);Ca=true;}});}return Ca;}function Ar(Cd,Cb,Ce){var Ca=[],Cc=Cd===L.DssTypeMetric?Br:Bx;if(Ce!==undefined&&Ce.length){Ce.forEach(function(Cf){if(Cc(Cf)){Ca.push(Cf);}});}if(Cb.length){Cb.forEach(function(Cf){if(Cc(Cf)){Ca.push(Cf);}});}return Ca;}function A7(Cb,Ca,Cc){Cb.forEach(function(Cd){CA(Ca[Cd],Cc[Cd]);});}function t(Ca,Cb){if(Ca.length){Cb.push(Ca.pop());}}function G(Ca,Cb){if(Ca.length&&Ca[0].t===4){Cb.push(Ca[0]);return true;}return false;}function B8(Ca,Cb){if(Ca.xAxisObjects.length>1){Cb.breakByObjects.push(Ca.xAxisObjects.pop());}CA(Ca.xAxisObjects,Cb.xAxisObjects);CA(Ca.yAxisObjects,Cb.yAxisObjects);}function Ap(Cc,Ce){var Cb,Ca,Cd;Cc.xAxisObjects=[];Cc.yAxisObjects=[];Cc.tooltipMetrics=[];Cb=new CH.HeatMapVisualizationHelper();Cb.setData(Ce.data.dz);Ca=Cb.groupingObjects;if(Ca.length&&Ca[0].t!==4){CA(Ca,Cc.xAxisObjects);}Ca=Cb.tooltipMetrics;Cd=Cb.sizeByMetric||Cb.getFirstColorByUnit(true)||Ca.pop();if(Cd){Cc.yAxisObjects.push(Cd);}}function AV(Ce,Cf,Cb){var Cc,Ca,Cd=[];Cc=new CH.HeatMapVisualizationHelper();Cc.setData(Cf.data.dz);Ca=Cc.groupingObjects;if(Ca.length===1){Ce.xAxisObjects.push(Ca.pop());}else{if(Ca.length>1){Ce.breakByObjects.push(Ca.pop());Ce.xAxisObjects.push(Ca.pop());Ce.columnObjects=Ca;}}if(Cb){if(Ce.xAxisObjects[0]){Cd.push(Ce.xAxisObjects[0].did);}CE.forEach(Ce.columnObjects,function(Cg){Cd.push(Cg.did);});}if(Cc.sizeByMetric){Ce.yAxisObjects.push(Cc.sizeByMetric);}if(Cc.colorBy){if(Ce.isMetric(Cc.colorBy[0])){if(!Cc.sizeByMetric||Cc.sizeByMetric.did!==Cc.colorBy[0].did){Ce.yAxisObjects.push(Cc.colorBy[0]);}}else{if(Cb){CE.forEach(Cc.colorBy,function(Cg){if(Cd.indexOf(Cg.did)>-1){Ce.colorByObjects.push(Cg);}});}}}if(!Ce.yAxisObjects.length&&Cc.tooltipMetrics.length){Ce.yAxisObjects.push(Cc.tooltipMetrics.shift());}Ce.metricsDropZone="Rows";}function Aw(Cc,Cd){var Cb,Ca;Cb=new CH.HeatMapVisualizationHelper();Cb.setData(Cd.data.dz);Ca=Cb.groupingObjects;if(Ca.length===1){Cc.xAxisObjects.push(Ca[0]);}else{if(Ca.length===2){Cc.xAxisObjects.push(Ca[0]);Cc.breakByObjects.push(Ca[1]);}else{if(Ca.length>2){Cc.breakByObjects.push(Ca.pop());Cc.xAxisObjects.push(Ca.pop());Cc.columnObjects=Ca;}}}if(Cb.sizeByMetric){Cc.yAxisObjects.push(Cb.sizeByMetric);}Cc.colorByObjects=Cb.colorBy;Cc.tooltipMetrics=Cb.tooltipMetrics;}function v(Cc,Ce){var Cb,Ca,Cd;Cb=new CH.HeatMapVisualizationHelper();Cb.setData(Ce.data.dz);Ca=Cb.tooltipMetrics;Cd=Cb.sizeByMetric||Cb.getFirstColorByUnit(true)||Ca.shift();if(Cd){Cc.yAxisObjects.push(Cd);}Cd=Cb.getFirstColorByUnit(true);if(!Cd||Cc.yAxisObjects.length&&Cc.yAxisObjects[0].did===Cd.did){Cd=Ca.shift();}if(Cd){Cc.xAxisObjects.push(Cd);}CA(Cb.groupingObjects,Cc.breakByObjects);CA(Cb.colorBy,Cc.colorByObjects);CA(Cb.tooltipMetrics,Cc.tooltipMetrics,L.DssTypeMetric);}function Ae(Ca,Cd){var Cc,Cb;Cc=new CH.NetworkVisualizationHelper();Cc.setData(Cd.data.dz);var Ce=Cc.getNetworkMetrics();Cb=A2(Ce);if(Cb){Ca.xAxisObjects.push(Cb);}Cb=Ce[0];if(Cb){Ca.yAxisObjects.push(Cb);}Cb=A2(Ce);if(Cb){Ca.sizeByObjects.push(Cb);}Cb=Cc.fromItemAttribute;if(Cb){Ca.breakByObjects.push(Cb);}Cb=Cc.toItemAttribute;if(Cb){Ca.rowObjects.push(Cb);}CA(Ce,Ca.tooltipMetrics,L.DssTypeMetric);}function AY(Cb,Cc){var Ca=Cb.breakByObjects;if(Ca.length){Cc.xAxisObjects.push(Ca[0]);for(var Cd=1;Cd<Ca.length;Cd++){Cc.breakByObjects.push(Ca[Cd]);}CA(Cb.columnObjects,Cc.columnObjects,L.DssTypeAttribute);CA(Cb.rowObjects,Cc.rowObjects,L.DssTypeAttribute);}else{if(Cb.columnObjects.length){Cc.xAxisObjects.push(Cb.columnObjects.pop());}else{Cc.xAxisObjects.push(Cb.rowObjects.pop());}}CA(Cb.xAxisObjects,Cc.yAxisObjects,L.DssTypeMetric);CA(Cb.yAxisObjects,Cc.yAxisObjects,L.DssTypeMetric);var Cd=0;while(Cd<Cc.yAxisObjects.length){Cc.yAxisObjects[Cd].ax=CO;Cd++;}Cc.metricShapes="{}";if(Cb.sizeByObjects.length){Cc.sizeByObjects.push(Cb.sizeByObjects.splice(0,1)[0]);CA(Cb.sizeByObjects,Cc.tooltipMetrics);}A7(["tooltipMetrics","colorByObjects","columnObjects","rowObjects"],Cb,Cc);AK(Cb,Cc);}function p(Cj,Cd,Cc,Ch,Cg,Cp){var Ck,Ci,Cb,Cm=-1,Cl=Cg?Cg.length:0,Co,Ca,Cn=Cg.concat([]),Cf=false;Co=(Ch&&Cj.isMetric(Ch))?Ch:undefined;for(var Ce=0;Ce<Cl;Ce++){if(Cj.isMetric(Cg[Ce])){Cb=Cg[Ce];Cm=Ce;break;}}Ck=Cc||Co;if(!Ck&&Cb){Ck=Cb;Cf=true;}if(Ck){Cj.xAxisObjects.push(Ck);}Ci=Co||Cb;if(Ci&&Ci.did!==Ck.did){Cj.yAxisObjects.push(Ci);if(!Co){Cf=true;}}if(Cp){Ca=Ck;}else{Ca=Cb||Co||Cc;if(Cb){Cf=true;}}if(Ca){Cj.sizeByObjects.push(Ca);}if(Cd){Cj.breakByObjects.push(Cd);}if(Ch){Cj.colorByObjects.push(Ch);}if(Cf){Cn.splice(Cm,1);}CA(Cn,Cj.tooltipMetrics,L.DssTypeMetric);}function Z(Cd,Ca){var Cc=new CH.MapHelper(),Cb=this.vis.getTopLayerHost();Cc.setWidget(Cb);p(Ca,Cc.getGeoUnit(),Cc.getSizeByUnit(),Cc.getColorByUnit(),Cc.getTooltipUnits(),true);}function AU(Ca,Cc){var Cb=new CH.ImageLayoutHelper({node:Cc});Cb.setData(Cc.data.dz);p(Ca,Cb.geoAttribute,Cb.sizeByMetric,Cb.colorByMetric,Cb.tooltipMetrics);}function AR(Ck,Ch,Cc){var Cl=Ar(L.DssTypeAttribute,Ck.xAxisObjects,Ck.yAxisObjects);if(Cl.length){CA(Ck.xAxisObjects,Ch.breakByObjects,L.DssTypeAttribute);CA(Ck.yAxisObjects,Ch.breakByObjects,L.DssTypeAttribute);}else{if(Ck.breakByObjects.length===0){var Cd=Ar(L.DssTypeAttribute,Ck.columnObjects,Ck.rowObjects);if(Cd.length){if(Ck.columnObjects.length){Ch.breakByObjects.push(Ck.columnObjects.pop());}else{if(Ck.rowObjects.length){Ch.breakByObjects.push(Ck.rowObjects.pop());}}}}}var Cf=Ar(L.DssTypeMetric,Ck.yAxisObjects),Ci=Ar(L.DssTypeMetric,Ck.xAxisObjects);var Cg=Cf.length?"yAxisObjects":"xAxisObjects";var Cb=Ci.length?"yAxisObjects":"xAxisObjects";if(Cf.length+Ci.length===1){Ch[Cg].push(Ck[Cg].pop());if(Ck.sizeByObjects.length==0){if(Ck.colorByObjects.length&&Ck.colorByObjects[0].t===L.DssTypeMetric){CA(Ck.colorByObjects,Ch[Cb],L.DssTypeMetric);}else{Ch[Cb].push(Ck.tooltipMetrics.pop());}}else{CA(Ck.sizeByObjects,Ch[Cb],L.DssTypeMetric);}}else{if(Cf.length+Ci.length!==0){var Ce=Math.ceil(Ck[Cg].length/2);for(var Cj=0;Cj<Ce;Cj++){Ch[Cb].push(Ck[Cg][Cj]);}for(Ce;Ce<Ck[Cg].length;Ce++){Ch[Cg].push(Ck[Cg][Ce]);}}else{var Ca=Ar(L.DssTypeMetric,Ck.colorByObjects);if(Ck.sizeByObjects.length&&Ca.length){CA(Ck.sizeByObjects,Ch.yAxisObjects,L.DssTypeMetric);CA(Ck.colorByObjects,Ch.xAxisObjects,L.DssTypeMetric);}else{CA(Ck.sizeByObjects,Ch.yAxisObjects,L.DssTypeMetric);CA(Ck.colorByObjects,Ch.yAxisObjects,L.DssTypeMetric);}}}A7(["tooltipMetrics","sizeByObjects","colorByObjects","columnObjects","rowObjects","breakByObjects"],Ck,Ch);I(Ck,Ch);}function w(Cb,Cc,Ca){if(Cb.sizeByObjects.length){CA(Cb.sizeByObjects,Cc.angleObjects);}else{if(Cb.colorByObjects.length&&Cb.colorByObjects[0].t===L.DssTypeMetric){Cc.angleObjects.push(Cb.colorByObjects[0]);}else{if(Cb.xAxisObjects.length&&Cb.xAxisObjects[0].t===L.DssTypeMetric){CA(Cb.xAxisObjects,Cc.angleObjects);Cb.xAxisObjects=[];CA(Cc.breakByObjects,Cc.sliceObjects);}if(Cb.yAxisObjects.length&&Cb.yAxisObjects[0].t===L.DssTypeMetric){CA(Cb.yAxisObjects,Cc.angleObjects);Cb.yAxisObjects=[];CA(Cc.breakByObjects,Cc.sliceObjects);}else{if(Ca){if(Cb.tooltipMetrics.length){Cc.angleObjects.push(Cb.tooltipMetrics.splice(0,1)[0]);}}}}}}function AM(Cb){var Ca=Ar(L.DssTypeMetric,Cb.xAxisObjects,Cb.yAxisObjects);if(!Ca.length){CA(Cb.breakByObjects,Cb.sliceObjects);return true;}return false;}function l(Cb,Cd){var Ca=function(){if(Cb.sizeByObjects.length){return Cb.sizeByObjects[0];}else{if(Cb.colorByObjects.length&&Cb.colorByObjects[0].t===L.DssTypeMetric){return Cb.colorByObjects[0];}else{if(Cb.tooltipMetrics.length){return Cb.tooltipMetrics.splice(0,1)[0];}}}};var Cc=Ar(L.DssTypeAttribute,Cb.xAxisObjects),Cf=Ar(L.DssTypeAttribute,Cb.yAxisObjects),Ce;if(Cc.length>0){if(Cc.length>1&&!Cf.length){Cd.breakByObjects.push(Cb.xAxisObjects.pop());}CA(Cb.yAxisObjects,Cd.breakByObjects,L.DssTypeAttribute);CA(Cb.xAxisObjects,Cd.xAxisObjects,L.DssTypeAttribute);Ce=Ca();if(Ce){Cd.yAxisObjects.push(Ce);}}else{if(Cf.length>0){if(Cf.length>1){Cd.breakByObjects.push(Cb.yAxisObjects.pop());}CA(Cb.yAxisObjects,Cd.yAxisObjects,L.DssTypeAttribute);Ce=Ca();if(Ce){Cd.xAxisObjects.push(Ce);}}else{if(Cb.breakByObjects.length){Cd.xAxisObjects.push(Cb.breakByObjects.splice(0,1)[0]);Ce=Ca();if(Ce){Cd.yAxisObjects.push(Ce);}}else{if(Cb.columnObjects.length){Cd.xAxisObjects.push(Cb.columnObjects.pop());Ce=Ca();if(Ce){Cd.yAxisObjects.push(Ce);}}else{if(Cb.rowObjects.length){Cd.yAxisObjects.push(Cb.rowObjects.pop());Ce=Ca();if(Ce){Cd.xAxisObjects.push(Ce);}}else{Ce=Ca();if(Ce){Cd.yAxisObjects.push(Ce);}}}}}}A7(["colorByObjects","columnObjects","rowObjects","sizeByObjects","tooltipMetrics","breakByObjects"],Cb,Cd);}function Bl(Cb,Cc){var Ca=function(){if(Cb.sizeByObjects.length){return Cb.sizeByObjects.pop();}else{if(Cb.colorByObjects.length&&Cb.colorByObjects[0].t===L.DssTypeMetric){return Cb.colorByObjects.pop();}else{if(Cb.tooltipMetrics.length){return Cb.tooltipMetrics.splice(0,1)[0];}}}};CA(Cb.yAxisObjects,Cc.breakByObjects,L.DssTypeAttribute);CA(Cb.xAxisObjects,Cc.breakByObjects,L.DssTypeAttribute);if(!Cc.breakByObjects.length){if(Cb.breakByObjects.length){CA(Cb.breakByObjects,Cc.breakByObjects);}else{if(Cb.columnObjects.length){Cc.breakByObjects.push(Cb.columnObjects.pop());}else{if(Cb.rowObjects.length){Cc.breakByObjects.push(Cb.rowObjects.pop());}}}}A7(["sizeByObjects","colorByObjects","columnObjects","rowObjects","breakByObjects"],Cb,Cc);var Cd=Ca();if(Cd){Cc.yAxisObjects.push(Cd);Cd=Ca();if(Cd){Cc.xAxisObjects.push(Cd);}}CA(Cb.tooltipMetrics,Cc.tooltipMetrics);}function AN(Ca,Cc){var Cb=Ar(L.DssTypeAttribute,Ca.xAxisObjects),Cd=Ar(L.DssTypeAttribute,Ca.yAxisObjects);if(Cb.length){Cc.sliceObjects.push(Ca.xAxisObjects.pop());}else{if(Cd.length){Cc.sliceObjects.push(Ca.yAxisObjects.pop());}else{if(Ca.breakByObjects.length){Cc.sliceObjects.push(Ca.breakByObjects.splice(0,1)[0]);}else{if(Ca.columnObjects.length){Cc.sliceObjects.push(Ca.columnObjects.pop());}else{if(Ca.rowObjects.length){Cc.sliceObjects.push(Ca.rowObjects.pop());}}}}}CA(Ca.yAxisObjects,Cc.yAxisObjects,L.DssTypeAttribute);CA(Ca.xAxisObjects,Cc.xAxisObjects,L.DssTypeAttribute);A7(["sizeByObjects","colorByObjects","columnObjects","rowObjects","breakByObjects"],Ca,Cc);w(Ca,Cc,true);CA(Ca.tooltipMetrics,Cc.tooltipMetrics);}function CI(Cc,Ce){var Cb,Ca,Cd;Cb=new CH.HeatMapVisualizationHelper();Cb.setData(Ce.data.dz);Ca=Cb.groupingObjects;if(Ca.length&&!Cc.isMetric(Ca[0])){Cc.xAxisObjects.push(Ca.pop());if(Ca.length){Cc.yAxisObjects.push(Ca.pop());}}CA(Cb.groupingObjects,Cc.columnObjects,L.DssTypeAttribute);CA(Cb.colorBy,Cc.colorByObjects);Cd=Cb.sizeByMetric;if(Cd){Cc.sizeByObjects.push(Cd);}CA(Cb.tooltipMetrics,Cc.tooltipMetrics,L.DssTypeMetric);}function BJ(Cc,Cb,Ca,Ce,Cf){var Cg=Cf?Cf.length:0;if(Cb){Cc.xAxisObjects.push(Cb);}for(var Cd=0;Cd<Cg;Cd++){if(!Cc.isMetric(Cf[Cd])){Cc.yAxisObjects.push(Cf[Cd]);}else{if(Cc.isMetric(Cf[Cd])){Cc.tooltipMetrics.push(Cf[Cd]);}}}if(Ce){Cc.colorByObjects.push(Ce);}}function CC(Cd,Ca){var Cc=new CH.MapHelper(),Cb=this.vis.getTopLayerHost();Cc.setWidget(Cb);BJ(Ca,Cc.getGeoUnit(),Cc.getSizeByUnit(),Cc.getColorByUnit(),Cc.getTooltipUnits());}function A6(Cd,Ca,Cb){if(Ca.breakByObjects.length){Cb.sliceObjects.push(Ca.breakByObjects.pop());}else{if(Ca.columnObjects.length){Cb.sliceObjects.push(Ca.columnObjects.pop());}else{if(Ca.rowObjects.length){Cb.sliceObjects.push(Ca.rowObjects.pop());}}}w(Ca,Cb);A7(["columnObjects","rowObjects","colorByObjects","xAxisObjects","yAxisObjects","colorByObjects","tooltipMetrics","breakByObjects","sizeByObjects"],Ca,Cb);var Cc=AM(Cb);BA(Ca,Cb,Cc);}function S(Ca,Cc){if(Ca.breakByObjects.length){Cc.sliceObjects.push(Ca.breakByObjects.pop());}else{var Cb=Ar(L.DssTypeAttribute,Ca.xAxisObjects),Ce=Ar(L.DssTypeAttribute,Ca.yAxisObjects);if(Ce.length){Cc.sliceObjects.push(Ca.yAxisObjects.pop());}else{if(Cb.length){Cc.sliceObjects.push(Ca.xAxisObjects.pop());}else{if(Ca.rowObjects.length&&Ca.columnObjects.length===0){Cc.sliceObjects.push(Ca.rowObjects.pop());}else{if(Ca.columnObjects.length){Cc.sliceObjects.push(Ca.columnObjects.pop());}}}}}w(Ca,Cc);A7(["sizeByObjects","breakByObjects","rowObjects","columnObjects","xAxisObjects","yAxisObjects","colorByObjects","tooltipMetrics"],Ca,Cc);var Cd=AM(Cc);BA(Ca,Cc,Cd);}function BI(Cc,Cd){var Cb,Ca;Cb=new CH.HeatMapVisualizationHelper();Cb.setData(Cd.data.dz);Ca=Cb.groupingObjects;if(Ca.length>0){Cc.sliceObjects.push(Ca.pop());if(Ca.length>0){Cc.xAxisObjects.push(Ca.pop());}if(Ca.length>0){Cc.columnObjects=Ca;}}if(Cb.sizeByMetric){Cc.angleObjects.push(Cb.sizeByMetric);}Cc.colorByObjects=Cb.colorBy;Cc.tooltipMetrics=Cb.tooltipMetrics;}function Bt(Cb,Ce){var Cd,Ca,Cc;Cd=new CH.NetworkVisualizationHelper();Cd.setData(Ce.data.dz);Cc=Cd.fromItemAttribute||Cd.toItemAttribute;if(Cc){Cb.sliceObjects.push(Cc);}Cc=Cd.nodeSizeMetric||Cd.edgeSizeMetric||Cd.edgeColorMetric;if(Cc){Cb.angleObjects.push(Cc);}Ca=Cb.sliceObjects;Cc=Ca.length&&Ca[0];if(Cc){Cb.colorByObjects.push(Cc);}}function AQ(Cb,Cd,Cf,Ce,Cg){var Ca,Cc;if(Cd){Cb.sliceObjects.push(Cd);}if(Cf){Cb.angleObjects.push(Cf);}Ca=Cb.sliceObjects;Cc=Ce||(Ca.length&&Ca[0]);if(Cc){Cb.colorByObjects.push(Cc);}CA(Cg,Cb.tooltipMetrics,L.DssTypeMetric);}function CN(Ca,Cc){var Cb=new CH.ImageLayoutHelper({node:Cc});Cb.setData(Cc.data.dz);AQ(Ca,Cb.geoAttribute,(Cb.sizeByMetric||Cb.colorByMetric),Cb.colorByMetric,Cb.tooltipMetrics);}function BL(Ca,Cb){var Cc=this.templateInfo,Cd=Cc.rows,Ce=Cc.cols,Cf=Cc.mx[0];CA(Cd,Cb.xAxisObjects);CA(Ce,Cb.xAxisObjects);if(Cf){Cb.yAxisObjects.push(Cf);}}function AH(Cd,Ca){var Cc=new CH.MapHelper(),Cb=this.vis.getTopLayerHost();Cc.setWidget(Cb);var Ce=Cc.getColorByUnit();AQ(Ca,Cc.getGeoUnit(),(Cc.getSizeByUnit()||Ce),Ce,Cc.getTooltipUnits());}function AJ(Cd,Ca,Cb,Cc){if(Ca){S.call(this,Ca,Cb);}else{switch(Cd){case Bs.ESRIMAP:case Bs.GOOGLEMAP:AH.call(this,Cd,Cb,Cc);break;case Bs.HEATMAP:BI.call(this,Cb,Cc);break;case Bs.NETWORK:Bt.call(this,Cb,Cc);break;case Bs.IMAGELAYOUT:CN.call(this,Cb,Cc);break;case Bs.GRID:BY.call(this,Cb,Cc);break;}}}function D(Cb,Ce){var Ca=Cb[Ce],Cd=[],Cc=[];if(Ca&&Ca.length&&Cb.isMetric(Ca[0])){Ca.forEach(function(Cf){if(Cf.ax===CO){Cd.push(Cf);}else{if(Cf.ax===F){Cc.push(Cf);}}});}return[Cd,Cc];}function CG(Cb,Cc){var Ca=Cb[Cc];if(Ca&&Ca.length){Ca.forEach(function(Cd){if(Cd.ax===F){Cd.ax=CO;}});}}function AL(Cb,Cg,Cf){var Cd=[],Ce=(Cg.length/2),Ca=function(Ch,Ci){Cd.push("'"+Ch.did+"':"+Ci);};var Cc=0;while(Ce>0){Cg[0].ax=CO;Cb[Cf].push(Cg[0]);Ca(Cg[0],P.BAR);Cg.splice(0,1);Ce-=1;Cc++;}while(Cg.length){Cg[0].ax=F;Cb[Cf].push(At.copy({ax:F},Cg[0]));Ca(Cg[0],P.LINE);Cg.splice(0,1);Cc++;}if(Cd.length){Cb.metricShapes="{"+Cd.join(",")+"}";}}function BX(Ck,Cg,Cf){var Ch=D(Ck,Cf),Cj=Ch[0],Cd=Ch[1],Ca=[],Cc=[];var Ci=Cj.length-Cd.length,Cb;if(Ci>0){Cc=Cd;Cb=Cj.length-Math.floor(Ci/2);for(var Ce=Cb;Ce<Cj.length;Ce++){Cc.push(Cj[Ce]);}Cj.splice(Cj.length-Math.floor(Ci/2),Cj.length-Math.floor(Ci/2));Ca=Cj;}else{if(Ci<0){Ca=Cj;Ci=Ci*-1;Cb=Cd.length-Math.floor(Ci/2);for(var Ce=Cb;Ce<Cd.length;Ce++){Ca.push(Cd[Ce]);}Cd.splice(Cd.length-Math.floor(Ci/2),Cd.length-Math.floor(Ci/2));Cc=Cd;}else{Cc=Cd;Ca=Cj;}}Ca=Ca.concat(Cc);AL(Cg,Ca,Cf);}function BO(Cb,Cd){Cd.breakByObjects=[];Cd.xAxisObjects=[];var Cp=Ar(L.DssTypeAttribute,Cb.xAxisObjects),Cq=Ar(L.DssTypeAttribute,Cb.yAxisObjects),Cf=Ar(L.DssTypeMetric,Cb.xAxisObjects),Ci=Ar(L.DssTypeMetric,Cb.yAxisObjects),Cn=function(Cs,Ct){if(Cb.sizeByObjects.length){return Cb.sizeByObjects.splice(0,1)[0];}else{if(Cb.angleObjects.length){return Cb.angleObjects.pop();}else{if(Cb.colorByObjects.length&&Cb.colorByObjects[0].t===L.DssTypeMetric){return Cb.colorByObjects[0];}else{if(Cb.tooltipMetrics.length){return Cb.tooltipMetrics.splice(0,1)[0];}}}}},Ca=function(Cs){if(Cb.breakByObjects.length){return Cb.breakByObjects.splice(0,1)[0];}else{if(Cb.sliceObjects.length){return Cb.sliceObjects.splice(0,1)[0];}else{if(Cb.columnObjects.length||Cb.rowObjects.length){if(Cs==="xAxisObjects"){if(Cb.columnObjects.length){return Cb.columnObjects.pop();}else{return Cb.rowObjects.pop();}}else{if(Cb.rowObjects.length){return Cb.rowObjects.pop();}else{return Cb.columnObjects.pop();}}}}}};if(Cp.length===0&&Cq.length===0){if(Cf.length&&Ci.length){var Co=Ca("xAxisObjects");if(Co!=undefined){Cd.xAxisObjects.push(Co);}var Cl,Cg,Ce=[],Cr=[];if(Cb.yAxisObjects[0].ax===CO){Ce=Cb.yAxisObjects.concat(Cb.xAxisObjects);}else{Ce=Cb.xAxisObjects.concat(Cb.yAxisObjects);}AL(Cd,Ce,"yAxisObjects");}else{if(Cf.length||Ci.length){var Ck=Cf.length?"xAxisObjects":"yAxisObjects",Cj=Ci.length?"xAxisObjects":"yAxisObjects";Cd[Cj].push(Ca(Cj));var Cc=[],Cm=[];if(Cb[Ck].length===1){if(Cb[Ck][0].ax===CO){Cc[0]=Cn(Ck);if(Cc[0]!==undefined){Cm=Cb[Ck].concat(Cc);}}else{Cc[0]=Cn(Ck);if(Cc[0]!==undefined){Cm=Cc.concat(Cb[Ck]);}}AL(Cd,Cm,Ck);}else{BX(Cb,Cd,Ck);}}else{var Ch=Cn("yAxisObjects");if(Ch!==undefined){Cb.yAxisObjects.push(Ch);}Ch=Cn("yAxisObjects");if(Ch!==undefined){Cb.yAxisObjects.push(Ch);}BX(Cb,Cd,"yAxisObjects");Cd.xAxisObjects.push(Ca("xAxisObjects"));}}}else{if(Cp.length&&Cq.length){var Ce=[];CA(Cb.xAxisObjects,Cd.xAxisObjects,L.DssTypeAttribute);CA(Cb.yAxisObjects,Cd.xAxisObjects,L.DssTypeAttribute);var Ch=Cn("yAxisObjects");if(Ch!==undefined){Ce.push(Ch);}Ch=Cn("yAxisObjects");if(Ch!==undefined){Ce.push(Ch);}AL(Cd,Ce,"yAxisObjects");}else{if(Cp.length||Cq.length){var Ck,Cj,Ce=[];if(Cp.length){Ck="xAxisObjects";Cj="yAxisObjects";}else{if(Cq.length){Ck="yAxisObjects";Cj="xAxisObjects";}}Ce=Cb[Cj];CA(Cb[Ck],Cd[Ck],L.DssTypeAttribute);var Ch=Cn(Cj);if(Ch!==undefined){Ce.push(Ch);}if(Cf.length===0&&Ci.length===0){Ch=Cn(Cj);if(Ch!==undefined){Ce.push(Ch);}}AL(Cd,Ce,Cj);}}}CA(Cb.breakByObjects,Cd.breakByObjects);CA(Cb.sliceObjects,Cd.breakByObjects);if(Cb.angleObjects.length){if(!Cb.sizeByObjects.length){Cd.sizeByObjects.push(Cb.angleObjects.pop());}CK(Cd,Cb.angleObjects);}A7(["colorByObjects","rowObjects","columnObjects","sizeByObjects","tooltipMetrics"],Cb,Cd);I(Cb,Cd);}function CL(Cj,Cf){Cf.xAxisObjects=[];Cf.yAxisObjects=[];var Ck=Ar(L.DssTypeAttribute,Cj.xAxisObjects,Cj.yAxisObjects),Ch=Ar(L.DssTypeMetric,Cj.xAxisObjects),Cd=Ar(L.DssTypeMetric,Cj.yAxisObjects),Cc=function(){if(Cj.sizeByObjects.length){return Cj.sizeByObjects[0];}else{if(Cj.colorByObjects.length&&Cj.colorByObjects[0].t===L.DssTypeMetric){return Cj.colorByObjects.pop();}else{if(Cj.tooltipMetrics.length){return Cj.tooltipMetrics.splice(0,1)[0];}}}};if(Ck.length){CA(Cj.xAxisObjects,Cf.xAxisObjects,L.DssTypeAttribute);CA(Cj.yAxisObjects,Cf.yAxisObjects,L.DssTypeAttribute);}else{if(Cj.breakByObjects.length){if(Ch.length==0){if(Cj.breakByObjects.length){Cf.xAxisObjects.push(Cj.breakByObjects[0]);Cj.breakByObjects.splice(0,1);}}else{if(Cj.breakByObjects.length){Cf.yAxisObjects.push(Cj.breakByObjects[0]);Cj.breakByObjects.splice(0,1);}}}else{if(Cd.length){Cf.xAxisObjects.push(Cj.columnObjects.pop());}else{if(Ch.length){Cf.yAxisObjects.push(Cj.rowObjects.pop());}}}}var Ce;if(Ch.length){Ce="xAxisObjects";}else{if(Cd.length){Ce="yAxisObjects";}}var Cg=D(Cj,Ce),Ci=Cg[0],Ca=Cg[1];if(Ci.length+Ca.length===1){var Cb=Cc();if(Cb){if(Ci.length){Cb.ax=F;}else{Cb.ax=CO;}Cj[Ce].push(Cb);}}BX(Cj,Cf,Ce);I(Cj,Cf);A7(["columnObjects","rowObjects","colorByObjects","breakByObjects"],Cj,Cf);}function B4(Ca,Cb){if(Ca.breakByObjects.length){Cb.xAxisObjects.push(Ca.breakByObjects[0]);Ca.breakByObjects.splice(0,1);}else{if(Ca.columnObjects.length){Cb.xAxisObjects.push(Ca.columnObjects.pop());}else{Cb.xAxisObjects.push(Ca.rowObjects.pop());}}var Ce=Af(Ca,null,"yAxisObjects"),Cd=Ar(L.DssTypeMetric,Ca.xAxisObjects),Cc=[];if(Ce===CO){Cc=Ca.yAxisObjects.concat(Cd);}else{Cc=Cd.concat(Ca.yAxisObjects);}AL(Cb,Cc,"yAxisObjects");if(Ca.sizeByObjects.length){Cb.sizeByObjects.push(Ca.sizeByObjects.splice(0,1)[0]);CA(Ca.sizeByObjects,Cb.tooltipMetrics);}A7(["breakByObjects","colorByObjects","columnObjects","rowObjects","tooltipMetrics"],Ca,Cb);AK(Ca,Cb);}function CM(Ci,Cg){var Cd,Cc,Ca=[],Ce=function(){if(Ci.sizeByObjects.length){return Ci.sizeByObjects.pop();}else{if(Ci.colorByObjects.length&&Ci.colorByObjects[0].t===L.DssTypeMetric){return Ci.colorByObjects.pop();}else{if(Ci.tooltipMetrics.length){return Ci.tooltipMetrics.splice(0,1)[0];}}}};A7(["colorByObjects","columnObjects","rowObjects","sizeByObjects"],Ci,Cg);var Ch=Ar(L.DssTypeAttribute,Ci.xAxisObjects),Cb=Ar(L.DssTypeAttribute,Ci.yAxisObjects),Cf="yAxisObjects";if(Ch.length){Cf="yAxisObjects";CA(Ci.yAxisObjects,Cg.xAxisObjects,L.DssTypeAttribute);CA(Ci.xAxisObjects,Cg.xAxisObjects,L.DssTypeAttribute);}else{if(Cb.length){Cf="xAxisObjects";CA(Ci.yAxisObjects,Cg.yAxisObjects,L.DssTypeAttribute);}else{if(Ci.breakByObjects.length){Cg.xAxisObjects.push(Ci.breakByObjects.splice(0,1)[0]);Cf="yAxisObjects";}else{if(Ci.columnObjects.length){Cf="yAxisObjects";Cg.xAxisObjects.push(Ci.columnObjects.pop());}else{if(Ci.rowObjects.length){Cf="xAxisObjects";Cg.yAxisObjects.push(Ci.rowObjects.pop());}}}}}Cc=Ce();if(Cc){Cg[Cf].push(Cc);Ca.push("'"+Cc.did+"':"+P.BAR);}Cd=Ce();if(Cd){Cg[Cf].push(At.copy({ax:F},Cd));Ca.push("'"+Cd.did+"':"+P.LINE);}CA(Ci.tooltipMetrics,Cg.tooltipMetrics,L.DssTypeMetric);CA(Ci.breakByObjects,Cg.breakByObjects);if(Ca.length){Cg.metricShapes="{"+Ca.join(",")+"}";}I(Ci,Cg);}function j(Ca,Ci,Cf){var Cb=this.templateInfo,Cg=Cb.mx,Ch=this.vis.model.data.gsi,Cc=this.definition;if(Cb.cols.length&&Cb.rows.length){var Ce;Ch.rows.forEach(function(Cj){if(Cj.n==="Metrics"){Ce="Rows";}});Ch.cols.forEach(function(Cj){if(Cj.n==="Metrics"){Ce="Columns";}});if(Ce==="Rows"){if(Ch.rows[Ch.rows.length-1].n==="Metrics"){AL(Cf,Cg,"yAxisObjects");Cf.xAxisObjects.push(Cb.cols.pop());}else{Cf.yAxisObjects.push(Cb.rows.pop());AL(Cf,Cg,"xAxisObjects");}Cb.rows.forEach(function(Cj){Cf.rowObjects.push(Cj);});Cb.cols.forEach(function(Cj){Cf.columnObjects.push(Cj);});}else{if(Ce==="Columns"){if(Ch.cols[Ch.cols.length-1].n==="Metrics"){AL(Cf,Cg,"xAxisObjects");Cf.yAxisObjects.push(Cb.rows.pop());}else{Cf.xAxisObjects.push(Cb.cols.pop());AL(Cf,Cg,"yAxisObjects");}Cb.rows.forEach(function(Cj){Cf.rowObjects.push(Cj);});Cb.cols.forEach(function(Cj){Cf.columnObjects.push(Cj);});}}}else{AL(Cf,Cg,"yAxisObjects");if(Cb.cols.length+Cb.rows.length===1){Bi(Cf,Cb.cols,Cb.rows,"xAxisObjects",B6(Cc,AA.PROP_XAXIS));}else{var Cd=Cb.rows.concat(Cb.cols);if(Cd.length){Cf.breakByObjects.push(Cd.pop());}if(Cd.length){Cf.xAxisObjects.push(Cd.pop());}Cd.forEach(function(Cj){Cf.columnObjects.push(Cj);});}}if(Cf.xAxisObjects.length>1&&Cf.xAxisObjects[0].t===4){Cf.metricsDropZone="Columns";}else{if(Cf.yAxisObjects.length>1&&Cf.yAxisObjects[0].t===4){Cf.metricsDropZone="Rows";}else{Cf.metricsDropZone="";}}Cf.secondaryMetricsDropZone="";}function e(Cc,Ce){var Cb,Ca,Cd,Cg,Cf=[],Ch;Cb=new CH.HeatMapVisualizationHelper();Cb.setData(Ce.data.dz);Ca=Cb.groupingObjects;if(Ca.length===1){Cc.xAxisObjects.push(Ca[0]);}else{if(Ca.length===2){Cc.xAxisObjects.push(Ca[0]);Cc.breakByObjects.push(Ca[1]);}else{if(Ca.length>2){Cc.breakByObjects.push(Ca.pop());Cc.xAxisObjects.push(Ca.pop());Cc.columnObjects=Ca;}}}Ch=Cb.getFirstColorByUnit(true);Ca=Cb.tooltipMetrics;Cg=Cd=Cb.sizeByMetric||Ch||Ca.shift();if(Cd){Cc.yAxisObjects.push(Cd);Cf.push("'"+Cd.did+"':"+P.BAR);}Cd=(Ch&&(Ch.did!==Cg.did))?Ch:Ca.shift();if(Cd){Cc.yAxisObjects.push(At.copy({ax:F},Cd));Cf.push("'"+Cd.did+"':"+P.LINE);}CA(Cb.colorBy,Cc.colorByObjects);CA(Cb.tooltipMetrics,Cc.tooltipMetrics,L.DssTypeMetric);if(Cf.length){Cc.metricShapes="{"+Cf.join(",")+"}";}}function A2(Cc,Cb){var Ca;CE.forEach(Cc,function(Cf,Ce,Cd){if(Cf&&Cf!==Cb){Ca=Cf;Cd.splice(Ce,1);return false;}});return Ca;}function Bg(Cb,Ce){var Cd,Cc,Cg,Ca,Cf=[];Cd=new CH.NetworkVisualizationHelper();Cd.setData(Ce.data.dz);Cc=Cd.fromItemAttribute||Cd.toItemAttribute;if(Cc){Cb.xAxisObjects.push(Cc);Ca=Cc;}var Ch=Cd.getNetworkMetrics();Cg=Cc=A2(Ch);if(Cc){Cb.yAxisObjects.push(Cc);Cf.push("'"+Ch.did+"':"+P.BAR);}Cc=A2(Ch,Cg);if(Cc){Cb.yAxisObjects.push(At.copy({ax:F},Cc));Cf.push("'"+Cc.did+"':"+P.LINE);}if(Cf.length){Cb.metricShapes="{"+Cf.join(",")+"}";}Cc=Cd.toItemAttribute;if(Cc&&(Ca!==Cc)){Cb.rowObjects.push(Cc);}}function BB(Cb,Ca,Cg,Cd,Ch){var Cc,Cf,Ce=[];if(Ca){Cb.xAxisObjects.push(Ca);}Cf=Cc=A2(Cg);if(!Cc){Cf=Cc=Cd&&(Cd.length>0)&&(Cd[Cd.length-1].t===L.DssTypeMetric)&&Cd.pop();}if(Cc){Cb.yAxisObjects.push(Cc);Ce.push("'"+Cc.did+"':"+P.BAR);}Cc=A2(Cg,Cf);if(!Cc){Cc=Cd&&(Cd.length>0)&&(Cd[Cd.length-1].t===L.DssTypeMetric)&&Cd.pop();}if(Cc){Cb.yAxisObjects.push(At.copy({ax:F},Cc));Ce.push("'"+Cc.did+"':"+P.LINE);}if(Ch){Cb.colorByObjects.push(Ch);}if(Cd){CA(Cd,Cb.tooltipMetrics,L.DssTypeMetric);}if(Ce.length){Cb.metricShapes="{"+Ce.join(",")+"}";}}function Ab(Ca,Cc){var Cb=new CH.ImageLayoutHelper({node:Cc});Cb.setData(Cc.data.dz);BB(Ca,Cb.geoAttribute,[Cb.sizeByMetric,Cb.colorByMetric],Cb.tooltipMetrics,Cb.colorByMetric);}function r(Ce,Ca){var Cd=new CH.MapHelper(),Cc=this.vis.getTopLayerHost();Cd.setWidget(Cc);var Cf=Cd.getColorByUnit(),Cb=[Cd.getSizeByUnit()];if(Cf&&Cf.t===L.DssTypeMetric){Cb.push(Cf);}BB(Ca,Cd.getGeoUnit(),Cb,Cd.getTooltipUnits(),Cf);}function By(Cd,Ca,Cb,Cc){switch(Cd){case Bs.ESRIMAP:case Bs.GOOGLEMAP:r.call(this,Cd,Cb,Cc);break;case Bs.HEATMAP:e.call(this,Cb,Cc);break;case Bs.NETWORK:Bg.call(this,Cb,Cc);break;case Bs.IMAGELAYOUT:Ab.call(this,Cb,Cc);break;case Bs.KPICARD:j.call(this,Cd,Ca,Cb);break;case Bs.GRID:j.call(this,Cd,Ca,Cb);break;}}function Bh(Cc,Ce){var Ca=Cc[Ce],Cb=[],Cd=[];if(Ca&&Ca.length&&Cc.isMetric(Ca[0])){Ca.forEach(function(Cf){if(Cf.ax===CO){Cb.push(Cf);}else{if(Cf.ax===F){Cd.push(Cf);Cf.ax=CO;}}});Cc[Ce]=Cd.concat(Cb);}}function A1(Cb,Cc){var Ca=Cb[Cc];if(Ca&&Ca.length&&Cb.isMetric(Ca[0])){Ca.forEach(function(Cd){Cb[Cc].push(Cd);if(Cd.ax===CO){Cd.ax=F;}});}}function BN(Ca,Cb){if(Av(Cb)){A1(Ca,"xAxisObjects");}else{A1(Ca,"yAxisObjects");}}function d(Ca,Cb){if(Av(Cb)){Bh(Ca,"xAxisObjects");}else{Bh(Ca,"yAxisObjects");}}function B(Ca,Cc,Ce){if(Ca.breakByObjects.length){Cc.sliceObjects.push(Ca.breakByObjects.pop());}else{var Cb=Ar(L.DssTypeAttribute,Ca.xAxisObjects),Cf=Ar(L.DssTypeAttribute,Ca.yAxisObjects);if(Cb.length){Cc.sliceObjects.push(Ca.xAxisObjects.pop());}else{if(Cf.length){Cc.sliceObjects.push(Ca.yAxisObjects.pop());}else{if(Ca.columnObjects.length){Cc.sliceObjects.push(Ca.columnObjects.pop());}else{if(Ca.rowObjects.length){Cc.sliceObjects.push(Ca.rowObjects.pop());}}}}}w(Ca,Cc);d(Ca,Ce);if(Ca.sizeByObjects.length){Cc.sizeByObjects.push(Ca.sizeByObjects.splice(0,1)[0]);CA(Ca.sizeByObjects,Cc.tooltipMetrics);}A7(["columnObjects","rowObjects","yAxisObjects","xAxisObjects","colorByObjects","tooltipMetrics","breakByObjects"],Ca,Cc);var Cd=AM(Cc);BA(Ca,Cc,Cd);}function Be(Ca,Cb,Cc){if(Af(Ca,Cc)===F){BN(Ca,Cc);}else{d(Ca,Cc);}Cb.clone(Ca);if(Au()){I(Ca,Cb);}}function BK(Cb,Ce){var Cd,Cc,Ca;Cd=new CH.NetworkVisualizationHelper();Cd.setData(Ce.data.dz);Cc=Cd.fromItemAttribute||Cd.toItemAttribute;if(Cc){Cb.xAxisObjects.push(Cc);Ca=Cc;}var Cf=Cd.getNetworkMetrics();Cc=A2(Cf);if(Cc){Cb.yAxisObjects.push(Cc);}CA(Cf,Cb.tooltipMetrics,L.DssTypeMetric);Cc=Cd.toItemAttribute;if(Cc&&(Ca!==Cc)){Cb.rowObjects.push(Cc);}}function q(Cg,Ch,Cb,Cf,Ce){var Ca,Cj=-1,Ci=Ce?Ce.length:0,Cd,Ck=Ce.concat([]);if(Ch){Cg.xAxisObjects.push(Ch);}for(var Cc=0;Cc<Ci;Cc++){if(Cg.isMetric(Ce[Cc])){Ca=Ce[Cc];Cj=Cc;break;}}Cd=Cb||Cf;if(!Cd&&Ca){Cd=Ca;Ck.splice(Cj,1);}if(Cd){Cg.yAxisObjects.push(Cd);}if(Cf){Cg.colorByObjects.push(Cf);}CA(Ck,Cg.tooltipMetrics,L.DssTypeMetric);}function W(Cd,Ca){var Cc=new CH.MapHelper(),Cb=this.vis.getTopLayerHost();Cc.setWidget(Cb);q(Ca,Cc.getGeoUnit(),Cc.getSizeByUnit(),Cc.getColorByUnit(),Cc.getTooltipUnits());}function Bu(Ca,Cc){var Cb=new CH.ImageLayoutHelper({node:Cc});Cb.setData(Cc.data.dz);q(Ca,Cb.geoAttribute,Cb.sizeByMetric,Cb.colorByMetric,Cb.tooltipMetrics);}function V(Ci,Cf,Cc){var Cj=Ar(L.DssTypeAttribute,Ci.xAxisObjects,Ci.yAxisObjects);if(Ci.breakByObjects.length||Cj.length){Cf.breakByObjects=Cj.concat(Ci.breakByObjects);}else{var Cg=Ar(L.DssTypeMetric,Ci.xAxisObjects),Cd=Ar(L.DssTypeMetric,Ci.yAxisObjects);if(Cd.length){Cf.breakByObjects.push(Ci.columnObjects.pop());}else{if(Cg.length){Cf.breakByObjects.push(Ci.rowObjects.pop());}}}var Ce,Cb,Ca=Af(Ci,Cc);if(Av(Cc)){Ce="xAxisObjects";Cb="yAxisObjects";}else{Ce="yAxisObjects";Cb="xAxisObjects";}if(Ca===F||Ca===CO){var Ch=Math.floor(Ci[Ce].length/2);Cf[Cb]=Ci[Ce].splice(0,Ch);Cf[Ce]=Ci[Ce];Cf[Cb].forEach(function(Ck){Ck.ax=CO;});}else{Ci[Ce].forEach(function(Ck){if(Ck.ax===CO){Cf[Ce].push(Ck);}else{if(Ck.ax===F){Cf[Cb].push(Ck);Ck.ax=CO;}}});}A7(["colorByObjects","columnObjects","rowObjects","sizeByObjects","tooltipMetrics"],Ci,Cf);I(Ci,Cf);}function BG(Cb,Cc){var Cd=function(){if(Cb.sizeByObjects.length){return Cb.sizeByObjects[0];}else{if(Cb.angleObjects.length){return Cb.angleObjects.pop();}else{if(Cb.colorByObjects.length&&Cb.colorByObjects[0].t===L.DssTypeMetric){return Cb.colorByObjects[0];}else{if(Cb.tooltipMetrics.length){return Cb.tooltipMetrics.splice(0,1)[0];}}}}};A7(["breakByObjects"],Cb,Cc);CA(Cb.xAxisObjects,Cc.breakByObjects,L.DssTypeAttribute);CA(Cb.yAxisObjects,Cc.breakByObjects,L.DssTypeAttribute);CA(Cb.sliceObjects,Cc.breakByObjects);if(Cc.breakByObjects.length===0){if(Cb.columnObjects.length){Cc.breakByObjects.push(Cb.columnObjects.pop());}else{Cc.breakByObjects.push(Cb.rowObjects.pop());}}var Cf=Ar(L.DssTypeMetric,Cb.xAxisObjects),Cg=Ar(L.DssTypeMetric,Cb.yAxisObjects);if(Cf.length&&Cg.length){if(!Cb.sizeByObjects.length){Cc.sizeByObjects.push(Cb.angleObjects.pop());}CA(Cb.xAxisObjects,Cc.xAxisObjects,L.DssTypeMetric);CA(Cb.yAxisObjects,Cc.yAxisObjects,L.DssTypeMetric);}else{if((Cf.length>1&&Cg.length===0)){CK(Cc,Cb.angleObjects);var Ce=Math.ceil(Cf.length/2);for(var Ca=0;Ca<Ce;Ca++){Cc.yAxisObjects.push(Cf[Ca]);}for(Ce;Ce<Cf.length;Ce++){Cc.xAxisObjects.push(Cf[Ce]);}}else{if(Cg.length>1&&Cf.length===0){CK(Cc,Cb.angleObjects);var Ce=Math.ceil(Cg.length/2);for(var Ca=0;Ca<Ce;Ca++){Cc.yAxisObjects.push(Cg[Ca]);}for(Ce;Ce<Cg.length;Ce++){Cc.xAxisObjects.push(Cg[Ce]);}}else{if(Cf.length===1&&Cg.length===0){Cc.xAxisObjects.push(Cf.pop());Cc.yAxisObjects.push(Cd());}else{if(Cg.length===1&&Cf.length===0){Cc.yAxisObjects.push(Cg.pop());Cc.xAxisObjects.push(Cd());}else{if(Cf.length===0&&Cg.length===0){Cc.yAxisObjects.push(Cd());Cc.xAxisObjects.push(Cd());}}}}}}A7(["columnObjects","rowObjects","colorByObjects","sizeByObjects"],Cb,Cc);CK(Cc,Cb.angleObjects);CK(Cc,Cb.tooltipMetrics);I(Cb,Cc);}function O(Ck,Ch){Ch.breakByObjects=[];Ch.tooltipMetrics=[];var Cb=function(Cl){if(Ck.breakByObjects.length){return Ck.breakByObjects.pop();}else{if(Ck.sliceObjects.length){return Ck.sliceObjects.pop();}else{if(Ck.columnObjects.length&&(Cl==="xAxisObjects"||!Ck.rowObjects.length)){return Ck.columnObjects.pop();}else{return Ck.rowObjects.pop();}}}},Cd=function(Cm){if(Ck.sizeByObjects.length){return Ck.sizeByObjects[0];}else{if(Ck.angleObjects.length){var Cl=Ck.angleObjects;Ck.angleObjects=[];return Cl;}else{if(Ck.colorByObjects.length){return Ck.colorByObjects[0];}else{return Ck.tooltipMetrics.splice(0,1)[0];}}}};var Cj=Ar(L.DssTypeAttribute,Ck.xAxisObjects),Ca=Ar(L.DssTypeAttribute,Ck.yAxisObjects),Ci=Ar(L.DssTypeMetric,Ck.xAxisObjects),Cf=Ar(L.DssTypeMetric,Ck.yAxisObjects),Ce,Cc;if((Cj.length&&Cf.length)||(Ca.length&&Ci.length)){A7(["xAxisObjects","yAxisObjects"],Ck,Ch);}else{if(Cf.length===0&&Ci.length===0){var Cg="yAxisObjects";Cc=Cd();if(!Cj.length&&!Ca.length){Ce=Cb("xAxisObjects");if(Ce){Ch.xAxisObjects.push(Ce);}}else{if(Cj.length&&Ca.length){A7(["xAxisObjects"],Ck,Ch);CA(Ck.yAxisObjects,Ch.xAxisObjects);}else{if(Cj.length){A7(["xAxisObjects"],Ck,Ch);}else{if(Ca.length){A7(["yAxisObjects"],Ck,Ch);Cg="xAxisObjects";}}}}if(Cc&&Cc.length){CA(Cc,Ch[Cg]);}else{if(Cc){Ch[Cg].push(Cc);}}}else{if(Cj.length===0&&Ca.length===0){if(Cf.length&&Ci.length){CA(Ck.yAxisObjects,Ch.yAxisObjects);CA(Ck.xAxisObjects,Ch.yAxisObjects);Ce=Cb("xAxisObjects");if(Ce){Ch.xAxisObjects.push(Ce);}}else{if(Cf.length){CA(Ck.yAxisObjects,Ch.yAxisObjects);Ce=Cb("xAxisObjects");if(Ce){Ch.xAxisObjects.push(Ce);}}else{if(Ci.length){CA(Ck.xAxisObjects,Ch.xAxisObjects);Ce=Cb("yAxisObjects");if(Ce){Ch.yAxisObjects.push();}}}}}}}if(Ck.angleObjects.length){if(Ck.sizeByObjects.length){CK(Ch,Ck.angleObjects);}else{Ch.sizeByObjects.push(Ck.angleObjects.pop());if(Ck.angleObjects.length){CK(Ch,Ck.angleObjects);}}}A7(["colorByObjects","sizeByObjects","tooltipMetrics","columnObjects","rowObjects","breakByObjects"],Ck,Ch);CA(Ck.sliceObjects,Ch.breakByObjects);Ch.angleObjects=[];I(Ck,Ch);}function BP(Ca,Cd){var Cc=(Cd.length/2);var Cb=0;while(Cc>0){Ca.xAxisObjects.push(Cd[0]);Cd.splice(0,1);Cc-=1;Cb++;}while(Cd.length){Ca.yAxisObjects.push(Cd[0]);Cd.splice(0,1);Cb++;}}function Ah(Ca,Cb){if(!Ca){return ;}if(!Cb.sizeByObjects.length){Cb.sizeByObjects.push(Ca);}else{if(!Cb.colorByObjects.length){Cb.colorByObjects.push(Ca);}else{CK(Cb,[Ca]);}}}function Ai(Ca,Cc){var Cb=Ar(L.DssTypeAttribute,Ca.xAxisObjects),Ce=Ar(L.DssTypeAttribute,Ca.yAxisObjects);if(Cb.length||Ce.length){var Cd;if(Cb.length){Cd={attrZone:"xAxisObjects",blankZone:"yAxisObjects",h1:"rowObjects",h2:"columnObjects"};}else{Cd={attrZone:"yAxisObjects",blankZone:"xAxisObjects",h1:"columnObjects",h2:"rowObjects"};}if(Ca.breakByObjects.length){CA(Ca[Cd.attrZone],Cc[Cd.attrZone]);Cc[Cd.blankZone].push(Ca.breakByObjects.pop());}else{if(Ca[Cd.attrZone].length>1){BP(Cc,Ca[Cd.attrZone]);}else{CA(Ca[Cd.attrZone],Cc[Cd.attrZone]);if(Ca[Cd.h1].length){Cc[Cd.blankZone].push(Ca[Cd.h1].pop());}else{Cc[Cd.blankZone].push(Ca[Cd.h2].pop());}}}}else{if(Ca.breakByObjects.length>1){BP(Cc,Ca.breakByObjects);Ca.breakByObjects=[];}else{if(Ca.breakByObjects.length){Cc.xAxisObjects.push(Ca.breakByObjects.pop());if(Ca.rowObjects.length){Cc.yAxisObjects.push(Ca.rowObjects.pop());}else{Cc.yAxisObjects.push(Ca.columnObjects.pop());}}else{if(Ca.columnObjects.length&&Ca.rowObjects.length){Cc.xAxisObjects.push(Ca.columnObjects.pop());Cc.yAxisObjects.push(Ca.rowObjects.pop());}else{if(Ca.columnObjects.length){Cc.xAxisObjects.push(Ca.columnObjects.pop());Cc.yAxisObjects.push(Ca.columnObjects.pop());}else{Cc.xAxisObjects.push(Ca.rowObjects.pop());Cc.yAxisObjects.push(Ca.rowObjects.pop());}}}}}A7(["breakByObjects","columnObjects","rowObjects"],Ca,Cc);}function CX(Ca,Cb,Cd){A7(["colorByObjects","sizeByObjects","tooltipMetrics"],Ca,Cb);var Cf,Cc,Ce;if(Av(Cd)){Cf="xAxisObjects";Cc="yAxisObjects";Ce={0:"columnObjects",1:"rowObjects"};}else{Cf="yAxisObjects";Cc="xAxisObjects";Ce={0:"rowObjects",1:"columnObjects"};}if(Ca[Cf].length){Ah(Ca[Cf].splice(0,1)[0],Cb);Ah(Ca[Cf].splice(0,1)[0],Cb);CK(Cb,Ca[Cf]);}Ai(Ca,Cb);A7(["colorByObjects","sizeByObjects","tooltipMetrics"],Ca,Cb);}function AI(Ci,Cf){A7(["colorByObjects","sizeByObjects","tooltipMetrics"],Ci,Cf);if(Ci.angleObjects.length){Ah(Ci.angleObjects.splice(0,1)[0],Cf);Ah(Ci.angleObjects.splice(0,1)[0],Cf);CA(Ci.angleObjects,Cf.tooltipMetrics);}var Cg=Ar(L.DssTypeMetric,Ci.xAxisObjects),Cd=Ar(L.DssTypeMetric,Ci.yAxisObjects),Ch=Ar(L.DssTypeAttribute,Ci.xAxisObjects),Cc=Ar(L.DssTypeAttribute,Ci.yAxisObjects);if(Cg.length||Cd.length){var Ca=Cg.concat(Cd);Ah(Ca.splice(0,1)[0],Cf);Ah(Ca.splice(0,1)[0],Cf);CA(Ca,Cf.tooltipMetrics);Cg=[];Cd=[];if(Ch.length||Cc.length){var Ce=Ch.length?"yAxisObjects":"xAxisObjects",Cb=Ch.length?"xAxisObjects":"yAxisObjects";CA(Ci[Cb],Cf[Cb]);CA(Ci.breakByObjects,Cf[Ce]);CA(Ci.sliceObjects,Cf[Ce]);if(!Cf.xAxisObjects.length){Ci.columnObjects.length?Cf.xAxisObjects.push(Ci.columnObjects.pop()):Cf.xAxisObjects.push(Ci.rowObjects.pop());}if(!Cf.yAxisObjects.length){Ci.rowObjects.length?Cf.yAxisObjects.push(Ci.rowObjects.pop()):Cf.yAxisObjects.push(Ci.columnObjects.pop());}}else{if(Ci.sliceObjects.length&&Ci.breakByObjects.length){CA(Ci.breakByObjects,Cf.yAxisObjects);CA(Ci.sliceObjects,Cf.xAxisObjects);}else{if(Ci.sliceObjects.length||Ci.breakByObjects){var Cj=Ci.sliceObjects.length?Ci.sliceObjects:Ci.breakByObjects;BP(Cf,Cj);}else{if(Ci.columnObjects.length&&Ci.rowObjects.length){Cf.yAxisObjects.push(Ci.rowObjects.pop());Cf.xAxisObjects.push(Ci.columnObjects.pop());}else{if(Ci.columnObjects.length){Cf.yAxisObjects.push(Ci.columnObjects.pop());Cf.xAxisObjects.push(Ci.columnObjects.pop());}else{if(Ci.rowObjects.length){Cf.yAxisObjects.push(Ci.rowObjects.pop());Cf.xAxisObjects.push(Ci.rowObjects.pop());}}}}}}Ci.xAxisObjects=[];Ci.yAxisObjects=[];}else{if(Ch.length||Cc.length){if(Cc.length&&Ch.length){CA(Ci.yAxisObjects,Cf.yAxisObjects);CA(Ci.xAxisObjects,Cf.xAxisObjects);CA(Ci.sliceObjects,Cf.xAxisObjects);}else{if(Cc.length){CA(Ci.sliceObjects,Cf.xAxisObjects);CA(Ci.yAxisObjects,Cf.yAxisObjects);}else{CA(Ci.sliceObjects,Cf.yAxisObjects);CA(Ci.xAxisObjects,Cf.xAxisObjects);}}}else{BP(Cf,Ci.sliceObjects);}}A7(["columnObjects","rowObjects"],Ci,Cf);}function CZ(Ca,Cb,Cc){A7(["colorByObjects","sizeByObjects","tooltipMetrics"],Ca,Cb);var Ce;if(Av(Cc)){Ce="xAxisObjects";}else{Ce="yAxisObjects";}var Cd=D(Ca,Ce);Cd=Cd[0].concat(Cd[1]);Ah(Cd.splice(0,1)[0],Cb);Ah(Cd.splice(0,1)[0],Cb);CK(Cb,Cd);Ca[Ce]=[];Ai(Ca,Cb);}function H(Cb,Cc){if(Cb.sizeByObjects.length){Cc.sizeByObjects.push(Cb.sizeByObjects.splice(0,1)[0]);CK(Cc,Cb.sizeByObjects);}A7(["colorByObjects","tooltipMetrics"],Cb,Cc);var Ca=Ar(L.DssTypeMetric,Cb.xAxisObjects).concat(Ar(L.DssTypeMetric,Cb.yAxisObjects));Ca.forEach(function(Cd){Ah(Cd,Cc);});Ai(Cb,Cc);}function Bd(Cb,Ce){var Cd,Cc,Ca;Cd=new CH.NetworkVisualizationHelper();Cd.setData(Ce.data.dz);Cc=Cd.fromItemAttribute;if(Cc){Cb.yAxisObjects.push(Cc);}Cc=Cd.toItemAttribute;if(Cc){Cb.xAxisObjects.push(Cc);}if(Cd.edgeColorMetric){Cb.colorByObjects.push(Cd.edgeColorMetric);}if(Cd.edgeSizeMetric){Cb.sizeByObjects.push(Cd.edgeSizeMetric);}if(!Cb.colorByObjects.length&&!Cb.sizeByObjects.length&&Cd.nodeSizeMetric){Cb.sizeByObjects.push(Cd.nodeSizeMetric);}else{if(Cd.nodeSizeMetric){CA([Cd.nodeSizeMetric],Cb.tooltipMetrics,L.DssTypeMetric);}}}function A3(Cf){var Ca=Cf.breakByObjects;if(Ca.length===0){var Cd,Ck=false,Cj=Cf.rowObjects,Cb=Cf.columnObjects,Ch=Cf.xAxisObjects,Cg=Cf.yAxisObjects;if((Cj.length>0&&Cg.length>0)||Cg.length>1){Cd=Ar(L.DssTypeAttribute,Cg,Cj);if(Cd.length>0){Ca.push(Cd.pop());Ck=true;}}if(!Ck&&((Cb.length>0&&Ch.length>0)||Ch.length>1)){Cd=Ar(L.DssTypeAttribute,Ch,Cb);if(Cd.length>0){Ca.push(Cd.pop());}}}var Ci=Cf.colorByObjects,Cc={};if(Ca.length>0){for(var Ce=0;Ce<Ca.length;Ce++){if(Ca[Ce]!==undefined){Cc[Ca[Ce].did]=Ce;}}}Ci.forEach(function(Cm){var Cl;if(Cm.t===4){Cl=Ci.indexOf(Cm);Ci.splice(Cl,1);}else{if(Cc[Cm.did]!==undefined){Cl=Ci.indexOf(Cm);Ci.splice(Cl,1);}}});}function Ak(Ce,Cb,Cf,Cd,Cc,Ca){CJ.call(this,this.definition,Ca,Cc,Ce,Cf,Cd);Al.call(this,Ce,Cb,Ca,Cc,Cd);Bm.call(this,this.definition,Cc,Cb);Bq.call(this,this.definition,Ca,Cc);Bz.call(this,this.definition,Cc,Cb);CY.call(this,Cc);}function Bv(Cr,Ck,C5,Cw){var Ce=new CH.GraphMatrixHelper({data:Cw.data,visType:Ck,visStyle:this.newVizInfo.s}),DM,Cx=[],DK=[],Co;if(this.isGraphMatrix(Cr)){DM=new CH.GraphMatrixHelper({data:Cw.data});DM.setData(Cw.data.dz);DM.setMetricsDropZone(Cw.data.dz);Co=this.chartInfo=this.vis.getChartInfo();Ce.metricsDropZone=DM.metricsDropZone;Ce.secondaryMetricsDropZone=DM.secondaryMetricsDropZone;}var Cp=Co&&Co.isGrid,DN=Co&&Co.isBubbleOrScatter,Cv=Co&&Co.isABL,Cb=Co&&Co.isCombo,C2=Co&&Co.isHistogram,Cf=Co&&Co.isBoxPlot,DE=Co&&Co.isWaterfall,DF=Co&&(Co.isPie||Co.isRing),Cm=(Cr===Bs.HEATMAP),DL=(Cr===Bs.NETWORK),C4=(Cr===Bs.GOOGLEMAP||Cr===Bs.ESRIMAP),C8=(Cr===Bs.IMAGELAYOUT),Ci=(Cr===Bs.KPICARD),DC=(Ck===B9),DH=BW(Ck),Cy=AX(Ck),Cj=o(Ck),Cd=E(Ck),DG=(Ck===h||Ck===BM),C6=Au(Ck),Cz=Ck===Bs.GRAPHMATRIXGRIDCHART,Ca=(Ck===Bs.GRAPHMATRIXVERTICALWATERFALL||Ck===Bs.GRAPHMATRIXHORIZONTALWATERFALL),C0=(Ck===BV||Ck===f),Cq=this.newVizInfo.s==="NewGraphMatrixVisualizationStyle",Cl=this.newVizInfo.s==="GraphMatrixVisualizationStyle",C7=Cw.data&&Cw.data.visName==="NewGraphMatrixVisualizationStyle",C1=Cw.data&&Cw.data.visName==="GraphMatrixVisualizationStyle";if(DC){if(Cm){Ap.call(this,Ce,Cw);}else{BL.call(this,DM,Ce,Cw);}}else{if(Cz){if(DF){AI.call(this,DM,Ce,Cw);}else{if(Cb){CZ.call(this,DM,Ce,Cw);}else{if(Cv){CX.call(this,DM,Ce,Cw);}else{if(DN){H.call(this,DM,Ce,Cw);}else{if(Cm){CI.call(this,Ce,Cw);}else{if(DL){Bd.call(this,Ce,Cw);}else{if(C4){CC.call(this,Cr,Ce,Cw);}else{if(Cp){Ce.clone(DM);var DD=this.vis,DJ=DD.node.data,Cn=DJ.visName;if(this.newVizInfo.s===Cn){Ce.handled=true;var Ch=this.vis;Ch.setWidgetPropertyValue("visType",Ce.visType);}}else{m.call(this,Ce,Cw);}}}}}}}}Ce.metricsDropZone="";Ce.secondaryMetricsDropZone="";}else{if(Cy||C0||Ca){if((C0||Ca)&&this.vis.GMController){var DD=this.vis,Cg=DD.GMController.getSortActions([]);DD.removeWidgetProperty("so");DD.removeWidgetProperty("si");C5.push({act:"sortGM",nodeKey:DD.k,subActions:Cg,partialUpdate:{nodes:[DD.k]}});}if(DF){O.call(this,DM,Ce,Cw);}else{if(Cp){l.call(this,DM,Ce,Cw);}else{if(Cb){Be.call(this,DM,Ce,Cw);}else{if(DN){AY.call(this,DM,Ce,Cw);}else{if(DE||Cf){Ce.clone(DM);var Ch=this.vis;Ch.setWidgetPropertyValue("visType",Ce.visType);}else{if(Cv){if(C2&&Ca){B8(DM,Ce,Cw);}else{Ce.clone(DM);var DD=this.vis,DJ=DD.node.data,Cn=DJ.visName;if(this.newVizInfo.s===Cn&&Cy){Ce.handled=true;var Ch=this.vis;Ch.setWidgetPropertyValue(Bn.WidgetPropertyTag.METRIC_SHAPES,{});Ch.writeGlobalProperty("visType",Ce.visType);Ch.writeGlobalProperty("Shape",P[this.definition.Properties[AA.PROP_SHAPE].toUpperCase()]);}}}else{if(Cm){if(C0||Ca){AV.call(this,Ce,Cw,C0);}else{Aw.call(this,Ce,Cw);}}else{if(DL){BK.call(this,Ce,Cw);}else{if(C4){W.call(this,Cr,Ce,Cw);}else{if(C8){Bu.call(this,Ce,Cw);}else{AG.call(this,Ce,Cw);}}}}}}}}}}if(C6&&Ce.sizeByObjects.length){var Cc=this.vis.zonesModel.gmZones.hGetItemOccurrence(Ce.sizeByObjects[0],[AW,M,AE]);if(Cc.length===0){CA(Ce.sizeByObjects,Ce.tooltipMetrics,L.DssTypeMetric);}Ce.sizeByObjects=[];}if(C0||Ca){if(C0&&!Cm){A3(Ce);if(Ce.secondaryMetricsDropZone==="ColorBy"&&Ce.metricsDropZone==="BreakBy"){Ce.secondaryMetricsDropZone="";}}if(Ce.sizeByObjects.length){if(Ce.xAxisObjects[0]&&Ce.xAxisObjects[0].t===L.DssTypeMetric){CA(Ce.sizeByObjects,Ce.xAxisObjects);Ce.metricsDropZone="Columns";}else{CA(Ce.sizeByObjects,Ce.yAxisObjects);if(Ce.yAxisObjects.length>1){Ce.metricsDropZone="Rows";}}}if(Ce.metricsDropZone==="YAxis"||Ce.metricsDropZone==="XAxis"){Ce.metricsDropZone="BreakBy";}var DD=this.vis,DJ=DD.node.data,Cn=DJ.visName;if(this.newVizInfo.s===Cn){DD.setWidgetPropertyValue("visType",Ce.visType);}Ce.angleObjects=[];Ce.sliceObjects=[];Ce.sizeByObjects=[];}else{if(Cj&&Ce&&Ce.visStyle===B3){var DI=Ce.sizeByObjects;Ce.sizeByObjects=[];CK(Ce,DI);}}}else{if(Cd){if(Cf||C2||DE){DM.tooltipMetrics=[];}if(DF){BO.call(this,DM,Ce);}else{if(Cp){CM.call(this,DM,Ce);}else{if(Cb){Ce.clone(DM);}else{if(Cv){CL.call(this,DM,Ce);}else{if(DN){B4.call(this,DM,Ce);}else{By.call(this,Cr,DM,Ce,Cw);}}}}}}else{if(DH){if(DF){BG.call(this,DM,Ce,Cw);}else{if(Cp){Bl(DM,Ce,Cw);}else{if(Cb){V.call(this,DM,Ce,Cw);}else{if(Cr===Bs.GRID){Bb.call(this,Ce,Cw);}else{if(Cv){AR.call(this,DM,Ce,Cw);}else{if(Cm){v.call(this,Ce,Cw);}else{if(DL){Ae.call(this,Ce,Cw);}else{if(DN){Ce.clone(DM);}else{if(C4){Z.call(this,Cr,Ce,Cw);}else{if(C8){AU.call(this,Ce,Cw);}else{if(Ci){Bb.call(this,Ce,Cw);}else{Ak.call(this,Cr,Ck,C5,Cw,Ce,DM);}}}}}}}}}}}}else{if(DG){if(DF){Ce.clone(DM);}else{if(Cp){AN(DM,Ce,Cw);}else{if(DN){A6.call(this,Cr,DM,Ce);}else{if(Cb){B.call(this,DM,Ce,Cw);}else{if(Cv){AJ.call(this,Cr,DM,Ce,Cw);}else{if(DL){Bt.call(this,Ce,Cw);}else{if(C4){AH.call(this,Cr,Ce,Cw);}else{if(Cm){BI.call(this,Ce,Cw);}else{if(C8){CN.call(this,Ce,Cw);}else{BY.call(this,Ce,Cw);}}}}}}}}}}else{Ak.call(this,Cr,Ck,C5,Cw,Ce,DM);}}}}}}if(Cq){CG(Ce,"xAxisObjects");CG(Ce,"yAxisObjects");}CP.call(this,Ce,Cq);CV.call(this,this.definition,Ce);k.call(this,Cw,Ce,DK);if(DG){AB.call(this,Ce,C5,Cw);}Ax.call(this,Cw,DK);var C9=Ce.getAddDropZonesAction();C9.actions=Cx.concat(C9.actions).concat(DK);if(C9.actions.length){C5.push(C9);}if(C1||C7){var DD=this.vis,DB,Cu=DD.property,C3=C7?parseInt(Cu.hGetPropValue(BT.CONTAINER_FIT_MODE)):Cu.hGetPropValue(AZ.FIT_TO),Ct={},DA=[B0.FIT_TO_CONTENT,B0.AUTOMATIC,B0.FIT_TO_CONTAINER],Cs=["Content","Window","Compact"];DA.forEach(function(DP,DO){Ct[DP]=Cs[DO];});Cs.forEach(function(DP,DO){Ct[DP]=DA[DO];});if((!C3||C3==="Content"||C3===B0.FIT_TO_CONTENT)&&DC){C3=undefined;}DB=Ct[C3];if(C7&&Cl){Cu.hSetPropValue(AZ.FIT_TO,DB);}else{if(C1&&Cq){DD.setWidgetPropertyValue(BT.CONTAINER_FIT_MODE,DB);}else{if(DC&&!C3){DD.setWidgetPropertyValue(BT.CONTAINER_FIT_MODE,C3);}}}}return Ce;}function J(Cc,Ca,Ce,Cb){this.templateInfo=B5.call(this,Cb);this.definition=A5.call(this,Ca);var Cd=Bv.call(this,Cc,Ca,Ce,Cb);return{wp:Cd.getXml(),handled:Cd.handled};}mstrmojo.vi.viz.GMVisualizationTransition=mstrmojo.declare(mstrmojo.vi.viz.VisualizationTransition,null,{scriptClass:"mstrmojo.vi.viz.GMVisualizationTransition",templateInfo:null,definition:null,markedObjects:null,chartInfo:null,init:function CR(Ca){this._super(Ca);this.markedObjects=[];},transitionDropZones:function Bo(Cf,Ce){var Cg,Cd=this.vis,Cc=Cd.node.data,Ca=Cc.visName||Ag,Cb=function(Ci,Ck){var Cj=(typeof Ck==="object"),Ch=Cj?Ck.v:Ck;if(Av(Ci.node)&&Cj){Ch=Ck.h;}return Ch;};Ce=Cb.call(this,Cd,Ce);switch(B1.getDefinition(Ca).id){case B1.GRAPHMATRIX:case B1.NEWGRAPHMATRIX:Cg=J.call(this,Bs.UNKNOWN_GRAPHMATRIX_TYPE,Ce,Cf,Cd.node);break;case B1.ESRIMAP:Cg=J.call(this,Bs.ESRIMAP,Ce,Cf,Cd.node);break;case B1.GOOGLEMAP:case B1.MAPBOX:Cg=J.call(this,Bs.GOOGLEMAP,Ce,Cf,Cd.node);break;case B1.HEATMAP:Cg=J.call(this,Bs.HEATMAP,Ce,Cf,Cd.node);break;case B1.IMAGELAYOUT:Cg=J.call(this,Bs.IMAGELAYOUT,Ce,Cf,Cd.node);break;case B1.NETWORK:Cg=J.call(this,Bs.NETWORK,Ce,Cf,Cd.node);break;case B1.KPICARD:Cg=J.call(this,Bs.KPICARD,Ce,Cf,Cd.node);break;default:Cg=J.call(this,Bs.GRID,Ce,Cf,Cd.node);break;}return Cg;}});}());(function(){mstrmojo.requiresCls("mstrmojo.hash","mstrmojo.vi.viz");mstrmojo.requiresClsP("mstrmojo.vi.viz","KPICardVisualizationHelper","KnownVisualizations");var G=mstrmojo,B=G.hash,I=G.vi.viz,H="Grid",D=I.KnownVisualizations;function F(K){var N=B.copy(K.data.gsi),L=N.tma===1?"rows":"cols",J=N[L],M=N.mx;N[L]=J.filter(function(O){return O.t!==-1&&O.did!=="-1";});if(M){M.forEach(function(O){O.t=4;});}return N;}function C(L,M,N,J){var K=M.getAddDropZonesAction();if(K.actions.length){N.push(K);}return M.getXml();}function A(L,J,N){var K=[];var R=new I.KPICardVisualizationHelper({node:J.node});var Q=F(N===D.MAPBOX?J.getTopLayerHost().node:J.node);var U=Q.rows;var P=Q.cols;var O=Q.mx;var S=U.concat(P);if(S.length>0){R.breakByAttribute=S[0];if(S.length>1){for(var M=1;M<S.length;M++){if(S[M].did!==S[0].did){R.trendAttribute=S[M];break;}}}}if(O.length>0){R.metric=O[0];}return C.call(this,J.node,R,L,K);}mstrmojo.vi.viz.KPICardVisualizationTransition=mstrmojo.declare(mstrmojo.vi.viz.VisualizationTransition,null,{scriptClass:"mstrmojo.vi.viz.KPICardVisualizationTransition",transitionDropZones:function E(P,O){var J="";var N=this.vis,M=N.node.data,L=M.visName?M.visName:H,K=D.getDefinition(L).id;if(K!==D.KPICARD){J=A.call(this,P,this.vis,K);}return{wp:J,handled:false};}});}());(function(){mstrmojo.requiresClsP("mstrmojo.chart.model.enums","EnumDSSObjectType","EnumDSSAxisName");mstrmojo.requiresCls("mstrmojo.hash","mstrmojo.array");mstrmojo.requiresClsP("mstrmojo.vi.viz","KnownVisualizations","EnumVisualizationTemplates","VisualizationTransition","HeatMapVisualizationHelper","NetworkVisualizationHelper","ImageLayoutHelper","MapHelper","GraphMatrixHelper");var Z=mstrmojo,K=Z.hash,G=Z.array,Y=Z.vi.viz,B=Y.KnownVisualizations,D=Y.EnumVisualizationTemplates,Q=Z.chart.model.enums,N=Q.EnumDSSObjectType,E=Q.EnumDSSAxisName,J="Grid",W=[0.1,0.3,0.5,0.7,0.9],F=["#CC2525","#E34B4B","#E97D7D","#79D479","#57BA57","#2CA02C"];function C(d){var g=K.copy(d.data.gsi),e=g.tma===1?"rows":"cols",c=g[e],f=g.mx;g[e]=c.filter(function(h){return h.t!==-1&&h.did!=="-1";});if(f){f.forEach(function(h){h.t=4;});}return g;}function A(c){return c.did==="-1"||c.t===4;}function U(f,e,h,c,g){var d=e.getAddDropZonesAction();if(e.colorByMetric){var j=e.colorByMetric;if(A(j)){this.addThresholds(f,j,g,F,W);}}d.actions=c.concat(d.actions).concat(g);if(d.actions.length){h.push(d);}return e.getXml();}function S(h,g){var e,d,f=h.mx;if(f.length>0){for(e=0,d=f.length;e<d;e++){var c=f[e];if(c.t!==4){continue;}if(!g.colorByMetric){g.colorByMetric=c;}else{if((!g.sizeByMetric||(c.did!==g.sizeByMetric.did))&&(c.did!==g.colorByMetric.did)&&c.t===N.DssTypeMetric){g.tooltipMetrics.push(c);}}}}}function a(f,g,j,d){var c=g.data.gts,l=null,h=(f.toLowerCase()==="row")?c&&c.row:c&&c.col,e,m,k;G.forEach(h,function(n){if(n.otp===12){if(!!j){m=false;G.forEach(n.fs,function(o){e=o.n;e=e!==undefined?e:"";if(e.toLowerCase()===j){m=true;return false;}});if(m&&!d){l=n;return false;}if(!m&&d){l=n;return false;}}else{l=n;return false;}}});if(l){k={did:l.id,t:l.otp};}return k;}function X(d,c){return a(d,c,"shapefile",true);}function I(d,c){return a(d,c,"shapefile",false);}function P(d){var c=new Y.ImageLayoutHelper({node:d});return c.getXml();}function O(j,e,g,k,h){var d=new Y.ImageLayoutHelper({node:e}),c=[],f=[];d.geoAttribute=X("row",e)||X("col",e);h.forEach(function(l){l.t=4;});if(g){d.colorByMetric=g;}if(k){d.sizeByMetric=k;}S.call(this,{mx:h},d);return U.call(this,e,d,j,c,f);}function M(m,f){var g,l,j=Y.MapHelper,o=new Y.ImageLayoutHelper({node:f.node}),h=[],e=[],d=f.getTopLayerHost();g=new j({data:f.node.data});g.setWidget(d);l=g.getGeoUnit();if(l){o.geoAttribute=l;}else{var k=g.getTooltipUnits();G.forEach(k,function(q){if(q.t===12){o.geoAttribute=q;return false;}});if(!o.geoAttribute){o.geoAttribute=a("row",d.node)||a("col",d.node);}if(!o.geoAttribute){return P(f.node);}}var p=g.getColorByUnit(),c=g.getSizeByUnit(),n=g.getTooltipUnits();l=p;if(l){o.colorByMetric=l;}l=c;if(l){o.sizeByMetric=l;}S.call(this,{mx:n},o);return U.call(this,f.node,o,m,h,e);}function b(f,c){var e=c.data.gsi.mx||[],h=new Y.GraphMatrixHelper({node:c}),d,g;e=this.filterGMTrainingMetric(c.data.dz,e);h.setData(c.data.dz);G.forEach(h.colorByObjects,function(j){if(h.isMetric(j)){d=j;return false;}});G.forEach(h.sizeByObjects,function(j){if(h.isMetric(j)){g=j;return false;}});return O.call(this,f,c,d,g,e);}function H(g,d){var f=d.data.gsi.mx||[],c=new Y.HeatMapVisualizationHelper({node:d}),e,h;c.setData(d.data.dz);G.forEach(G.ensureArray(c.colorBy),function(j){if(c.isMetric(j)){e=j;return false;}});G.forEach(G.ensureArray(c.sizeByMetric),function(j){if(c.isMetric(j)){h=j;return false;}});return O.call(this,g,d,e,h,f);}function V(g,d){var f=d.data.gsi.mx||[],c=new Y.NetworkVisualizationHelper({node:d}),e,h;c.setData(d.data.dz);G.forEach(G.ensureArray(c.edgeColorMetric),function(j){if(c.isMetric(j)){e=j;return false;}});G.forEach(G.ensureArray(c.nodeSizeMetric).concat(G.ensureArray(c.edgeSizeMetric)),function(j){if(c.isMetric(j)){h=j;return false;}});return O.call(this,g,d,e,h,f);}function L(e,c){var d=c.data.gsi.mx||[];return O.call(this,e,c,null,null,d);}mstrmojo.vi.viz.ImageLayoutVisualizationTransition=mstrmojo.declare(mstrmojo.vi.viz.VisualizationTransition,null,{scriptClass:"mstrmojo.vi.viz.ImageLayoutVisualizationTransition",transitionDropZones:function R(j,h){var c="";var g=this.vis,f=g.node.data,e=f.visName?f.visName:J,d=B.getDefinition(e).id;switch(d){case B.GRAPHMATRIX:case B.NEWGRAPHMATRIX:c=b.call(this,j,g.node);break;case B.GOOGLEMAP:case B.ESRIMAP:case B.MAPBOX:c=M.call(this,j,g);break;case B.HEATMAP:c=H.call(this,j,g.node);break;case B.NETWORK:c=V.call(this,j,g.node);break;case B.IMAGELAYOUT:break;default:c=L.call(this,j,g.node);break;}return{wp:c,handled:false};}});})();(function(){mstrmojo.requiresClsP("mstrmojo.vi.viz","VisualizationTransition","EnumAxisNames");mstrmojo.requiresCls("mstrmojo.chart.model.enums.EnumDSSObjectType");var A=mstrmojo,E=A.vi.viz,C=E.EnumAxisNames,D=A.chart.model.enums.EnumDSSObjectType;mstrmojo.vi.viz.BaseVisualizationTransition=mstrmojo.declare(mstrmojo.vi.viz.VisualizationTransition,null,{scriptClass:"mstrmojo.vi.viz.BaseVisualizationTransition",transitionDropZones:function B(H,O){var F=this.vis,G=F.node,N=G.k,M=G.data.gsi,Q=M.rows,K=M.cols,I,L,J=[],P=function(V,U,R,S){V.push({act:"pivot",unitId:U.did!=="-1"?U.did:"",unitType:U.did!=="-1"?U.t:"",axis:S,unitPos:R+1});};for(I=0;I<K.length;I++){L=K[I];if(L.t!==D.DssTypeMetric){P(J,L,I,C.ROWS);}}for(I=0;I<Q.length;I++){L=Q[I];if(L.did==="-1"){P(J,L,I,C.COLUMNS);break;}}if(J.length){H.push({act:"updateTemplate",keyContext:N,partialRetrieval:{nodes:[N]},actions:J});}return{wp:"<props><widgetProps /></props>",handled:false};}});}());(function(){mstrmojo.requiresCls("mstrmojo.hash","mstrmojo.array","mstrmojo.dom","mstrmojo.func","mstrmojo.vi.controllers.UICmdMgr");var X=mstrmojo.func,S=mstrmojo.hash,P=mstrmojo.array,M=mstrmojo.vi.controllers.UICmdMgr.STATES,J={SHARED:0,SEPARATE:1},N={AND:19,OR:20},d=function d(h,g){var e={},f=function(l,k){var j=[];if(!k){return l;}P.forEach((k||[]),function(m){j.push(m);});P.forEach((l||[]),function(n){var m=P.find(k,"id",n.id);if(!~m){j.push(n);}});return j;};S.forEach(g,function(j,k){e[k]=j;});S.forEach(h,function(j,k){e[k]=f(j,g[k]);});return e;},D=function D(e){var f=[];S.forEach(e,function(g){f.push({ft:N.AND,d:g});});return f;},K=function(f){var e={},g=function(h){var j=S.keyarray(h)[0];return{id:j,d:h[j][0]};};S.forEach(f,function(l){var k={},h=g(l),j=k[h.id];if(h.id){if(!j){k[h.id]=j=[];}j.push(h.d);}e=d(e,k);},this);return[{ft:N.OR,d:e}];},C=function C(j,n){var k=this.model,m,f=[],g=mstrmojo.vi.ui.rw.SelectionType,l=true,h=false,e=this;if(!n){n=this.getSelectionType();}if(!S.isEmpty(j)){if(n===g.METRICS){m=D.call(this,j);}else{m=K.call(this,j);}}S.forEach(m,function(o){l=false;var p=[];S.forEach(o.d,function(q,v){if(e.isSupportViewFilterForSelection(v)){h=true;var r=[],u={id:v,elems:r,fm:q[0].fm,v:P.map(q,function(w){return w.n;}).reverse()},t=k.getObjectInfo(v);if(t){u.t=t.t;u.st=t.st;if(t.st===12033){u.attId=t.attId;}}P.forEach((q||[]),function(w){r.push(w.id);});p.push(u);}});if(p.length){f.push({ft:o.ft,d:p});}});f.hasElements=h;f.clearSelections=l;return f;},F=function F(g){var e=this.getContextMenuSelectionType(),f=[];f=C.call(this,g,e);return f;},a=function a(l,n){var k=this.selectorControl,g,f,m,j=this,h,e;if(k){if(l.clearSelections||l.hasElements){g=this.controller;if(n){f=g.model;e=k.navPage;h=f.getLayoutKeyByUnitKey(e);this.clearSelections();this.setSelectionCache();}k.exp=null;if(g.onGridSelector){m=function(){g.onGridSelector(j,{type:mstrmojo.EnumRWUnitType.GRID,ck:k.ck,tks:k.tks,cgb:S.valarray(k.cgb),ctlKey:k.ckey,sliceId:this.sid,isUConDS:k.isUConDS,isNavigation:n,layoutKey:h,panelKey:e,ct:k.ct,selections:l});};if(this.multiUnitCtrlInterval){window.clearInterval(this.multiUnitCtrlInterval);this.multiUnitCtrlInterval=null;}if(g.cmdMgr.state===M.BUSY){this.multiUnitCtrlInterval=window.setInterval(function(){if(g.cmdMgr.state!==M.BUSY){window.clearInterval(j.multiUnitCtrlInterval);if(!j.destroyed){j.multiUnitCtrlInterval=null;m();}}},1000);}else{m();}}}}},B=function B(g){var e={type:mstrmojo.vi.ui.rw.SelectionType.ATTS,data:g},f=function(h,j){if(parseInt(h.fn,10)===22&&parseInt(j,10)===19){e.type=mstrmojo.vi.ui.rw.SelectionType.METRICS;}P.forEach((h.nds||[]),function(k){f(k,h.fn);});};f(g,null);return e;},b=function b(){return this.parent.model.getCurrentLayoutDef().cgbMap;},O=function O(){var e=b.call(this),f=[];S.forEach(e,function(h,g){if(this.k===h){f.push(g);}},this);return f;},c=function c(){var e=this.controller&&this.controller.cmdMgr;if(e&&e.isUndoRedo()){return true;}return false;};mstrmojo.vi.ui.rw.selectors._IsMultiUnitControl=mstrmojo.provide("mstrmojo.vi.ui.rw.selectors._IsMultiUnitControl",{_mixinName:"mstrmojo.vi.ui.rw.selectors._IsMultiUnitControl",selectorControl:null,multiUnitCtrlInterval:null,postBuildRendering:function Y(){if(this._super){this._super();}var e=mstrApp.isInVFConfigMode||this.isCustomSort?null:this.findSelectorControl();if(c.call(this)){this.clearSelections();}if(e&&!e.isNavigation&&!S.isEmpty(e.exp)&&this.addSelectionsFromExpression){this.addSelectionsFromExpression(B(e.exp));if(this.highlight){this.highlight(this.getSelectionType(),this.getSelectionHash(),true);}}},getSelectorDataFromExpression:B,getSelectionDataTree:C,getContextMenuSelectionDataTree:F,deleteSelectorControl:function E(){if(this._super){return this._super();}this.throwAbstractMethodError("deleteSelectorControl");},findSelectorControl:function W(){if(this._super){return this._super();}this.throwAbstractMethodError("findSelectorControl");},handlesMultiSelection:function H(e){return(this._super&&this._super(e))||!!this.selectorControl;},isSupportViewFilterForSelection:function I(f){var e=this.model;return e.supportsViewFilterActions(f);},isLinkedFilter:function(){var e=this.findSelectorControl&&this.findSelectorControl();return e&&e.isNavigation;},isLinkedFilterEnabled:function(){return this.isLinkedFilter()&&this.getContextMenuSelectionHash&&!S.isEmpty(this.getContextMenuSelectionHash());},handleContextMenuSelectionData:function G(e){this.isNavigation=e;this.onContextMenuSelectionChange(this.getContextMenuSelectionHash&&this.getContextMenuSelectionHash());},onSelectionChange:function Q(f){var j=(this.model.getSelectorControlMapInfo?this.model.getSelectorControlMapInfo():[]),h=false,g=this.isNavigation;if(g){delete this.isNavigation;}if(this._super){h=this._super(f);}if(!g&&this.isLinkedFilter()){return true;}if(j.length>0){this.singleUnitSelect();h=true;}else{if(!!this.selectorControl&&!this.isCustomSort){var e=C.call(this,f);a.call(this,e,g);return true;}}return h;},onContextMenuSelectionChange:function L(f){var j=(this.model.getSelectorControlMapInfo?this.model.getSelectorControlMapInfo():[]),h=false,g=this.isNavigation;if(g){delete this.isNavigation;}if(this._super){h=this._super(f);}if(!g&&this.isLinkedFilter()){return true;}if(j.length>0){this.singleUnitSelect();h=true;}else{if(!!this.selectorControl){var e=F.call(this,f);a.call(this,e,g);return true;}}return h;},singleUnitSelect:function A(){if(this._super){this._super();}},clearAllSelections:function V(){return this.selectorControl&&this.selectorControl.showall;},onClearBrushing:function Z(e){if(this.selectorControl){return true;}if(this._super){return this._super(e);}return false;},getFilterType:function R(){return this.defn.ins||J.SHARED;},switchFilterType:function U(r){var m=this,q,n=m.getFilterType(),k=m.parent.model,j,h={actions:[]},t,g=b.call(m),e,l=false,o,w,p,v,f;if(n!==r){q=O.call(m);o=k.getCurrentLayoutDef().units;if(q.length&&n===J.SHARED){t=P.filterOne(q,function(x){w=o[x];if(w){p=w.scs||[];return true;}j=k.getSourceControls(m.parent,x);p=j;return j.length;});if(!j||!j.length){j=k.getSourceControls(m.parent,t);j=P.filter(j,function(x){v=x.control.key;return !P.find(p,"ckey",v);});p=p.concat(j);}P.forEach(p,function(x,z){if(z!==0){e=k.getNextKey();g[e]=m.k;h.actions.push(k.redoFilterAssociations(true,x.ckey||x.control.ckey,x.pnk||x.sourceKey,m.k,t,e));l=true;}}.bind(m));}else{f="";P.forEach(q,function(x){w=o[x];if(!w){j=k.getSourceControls(m.parent,x);w=j.length&&j[0];if(!w){return true;}w.pnk=w.sourceKey;w.ckey=w.control.ckey;}if(!f){f=x;}else{delete g[x];p=(w.scs&&w.scs[0])||w;h.actions.push(k.redoFilterAssociations(false,p.ckey,p.pnk,m.k,x,f));l=true;}}.bind(m));}h.actions.push(k.getUnitFormatAction(m,1,{FormattingSelector:{IndependentNodeSelector:r}},true));var u=false;h.callback=({success:function(){m.defn.ins=u?n:r;u=!u;}});if(l){h.callback=X.wrapMethods(h.callback,k.getRebuildCallback());}}h.extras={style:{params:{treesToRender:3}}};return h;}});}());(function(){mstrmojo.requiresCls("mstrmojo.dom","mstrmojo.vi.ui._XtabCellHoverMgr");var F=mstrmojo.dom;mstrmojo.vi.ui._CustomSortXtabCellHoverMgr=mstrmojo.declare(mstrmojo.vi.ui._XtabCellHoverMgr,null,{scriptClass:"mstrmojo.vi.ui._CustomSortXtabCellHoverMgr",cue:null,audibles:{"*":false,cueDisplay:true},oncontextmenu:function G(K,I,J){if(!this.parent.isSorting()){this._super(K,I,J);}else{F.preventDefault(I,K);F.stopPropogation(I,K);}},onhover:function C(N,I,M){var M=M||N.target,J=F.findAncestorByName(M,"tr"),L=this.parent;if(!J){return ;}if(L.isSorting()){var P=F.checkTagName(M,"td")?M:F.findAncestorByName(M,"td");if(P&&L.validCustomSortTgtRow(J)){var O=F.position(J),K=this.getCue().style;K.width=Math.min(O.w,F.position(L.domNode).w)+"px";K.top=(O.y+O.h)+"px";K.left=O.x+"px";this.toggleCueDisplay(true);}}else{if(J.rowIndex===0){this._super(N,I,M);}}},onunhover:function B(){this.toggleCueDisplay(false);this._super();},getCue:function H(){if(!this.cue){var I=document.createElement("div");I.className="mstrmojo-vi-cs-cue";this.cue=document.body.appendChild(I);}return this.cue;},removeCue:function A(){if(this.cue){document.body.removeChild(this.cue);delete this.cue;}},toggleCueDisplay:function E(I){this.set("cueDisplay",I);},oncueDisplayChange:function D(){if(this.cue){this.cue.style.display=this.cueDisplay?"":"none";}}});}());(function(){mstrmojo.requiresClsP("mstrmojo.vi.viz","BaseVisualizationTransition","KnownVisualizations");mstrmojo.requiresCls("mstrmojo.array","mstrmojo.hash","mstrmojo.chart.model.enums.EnumDSSObjectType","mstrmojo.chart.model.enums.EnumDSSGraphMarkerShape");var F=mstrmojo.array,B=mstrmojo.hash,I=mstrmojo.vi.viz.KnownVisualizations,E=mstrmojo.chart.model.enums.EnumDSSObjectType,J=201,D=E.DssTypeMetric;function G(L,M,K){switch(L){case I.GRID:return[];case I.HEATMAP:if(K){return["ColorBy","SizeBy","AdditionalMetrics"];}else{return["Grp"];}case I.GRAPHMATRIX:switch(M){case J:if(K){return["AngleBy","XAxis","YAxis","ColorBy","SizeBy","AdditionalMetrics"];}else{return["SliceBy","Rows","YAxis","BreakBy","Columns","XAxis"];}default:if(K){return["XAxis","YAxis","ColorBy","SizeBy","AdditionalMetrics"];}else{return["Rows","YAxis","BreakBy","Columns","XAxis"];}}case I.ESRIMAP:case I.GOOGLEMAP:case I.MAPBOX:if(K){return["ColorBy","SizeBy","AdditionalMetrics"];}else{return["Geo","AdditionalMetrics","Lat","Long"];}case I.NETWORK:if(K){return["ColorBy","SizeBy","itemsz"];}else{return["from","to"];}case I.KPICARD:if(K){return["metric"];}else{return["BreakBy","trend"];}default:return["XAxis","YAxis","BreakBy","SliceBy","ColorBy","SizeBy","AdditionalMetrics","AngleBy","Grp","Geo","layout","from","to","itemsz","Lat","Long"];}}function C(L,O,K){var N=[],M=O.concat();F.forEach(L,function(P){F.forEach(M,function(Q,R){if(P.id===Q.did||P.did===Q.did){Q.fromZone=P.fromZone;if(K){Q.t=D;}N.push(Q);M.splice(R,1);return false;}});});return N;}function A(K,a){var L=K.node,O=L.data,b=O.dz,Z=O.gsi,S=(Z.rows||[]).concat(Z.cols||[]),N=O.gsi.mx||[],W=[],P=[];var R=I.getDefinition(O.visName||"Grid").id,Y=(R===I.GRAPHMATRIX&&K.GMController.isPie)?J:null;var V=K.zonesModel.getCustomDropZones,Q=V&&V instanceof Function,M=Q?K.zonesModel.getCustomDropZones():null;var U=function U(c){F.forEach(G(R,Y,c),function(e,f){var d=b[e]||{};F.forEach((c?d.TemplateMetric:d.TemplateUnit),function(g){g.fromZone=Q?M[f].name:e;if(c){P.push(g);}else{W.push(g);}});});};U(false);if(W.length>0){W=C(W,S,false);}else{W=F.filter(Z.rows,function(c){c.fromZone="Rows";return c.did!=="-1";}).concat(F.filter(Z.cols,function(c){c.fromZone="Columns";return c.did!=="-1";}));}U(true);if(P.length>0){P=C(P,N,true);}else{P=N.concat();F.forEach(P,function(c){c.t=D;c.fromZone="Metrics";});}var X=a.transitionDropZones(W,P);return X.map(function(d){var c=d.obj;return{act:"addDropZoneUnit",zoneId:d.toZoneId,unitId:c.did,unitType:c.t};});}mstrmojo.vi.viz.CustomVisualizationTransition=mstrmojo.declare(mstrmojo.vi.viz.BaseVisualizationTransition,null,{scriptClass:"mstrmojo.vi.viz.CustomVisualizationTransition",transitionDropZones:function H(Q,V){var K=this.newVizInfo,W=K.s,P=K.dz,S=this.vis,U=S.node,c=U.k,b=U.data;if(W===b.visName){return{wp:"",handled:true};}else{if(!P){return this._super(Q,V);}}mstrmojo.requiresCls("mstrmojo."+P);var Z=B.walk(P,mstrmojo),Y=new Z({getDZFlatStruct:function M(){return{};}}),L=Y.getCustomDropZones&&Y.getCustomDropZones();if(!L||L.length===0){var a=Q[Q.length-1],R=a&&a.actions,X=R&&R[0];if(X&&X.act==="createDefaultDropZones"){X.widgetType=0;}return this._super(Q,V);}var O=Y.customDropZonesTransition;if(O&&O instanceof Function){var N=A(this.vis,Y);if(N){Q.push({act:"updateTemplate",keyContext:c,partialRetrieval:{nodes:[c]},actions:N});}}return{wp:"<props><widgetProps /></props>",handled:false};}});}());(function(){mstrmojo.requiresClsP("mstrmojo.vi.viz","BaseVisualizationTransition");var A=mstrmojo,E=A.vi.viz,C=E.KnownVisualizations,D="Grid";mstrmojo.vi.viz.GridVisualizationTransition=mstrmojo.declare(mstrmojo.vi.viz.BaseVisualizationTransition,null,{scriptClass:"mstrmojo.vi.viz.GridVisualizationTransition",transitionDropZones:function B(J,I){var H=this.vis,G=H.node.data,F=G.visName||D;if(C.getDefinition(F).id!==C.GRID){return this._super(J,I);}return{wp:"",handled:false};}});}());(function(){mstrmojo.requiresCls("mstrmojo.gmaps.MapEnums","mstrmojo.vi.viz.MapVisualizationTransition");var A=mstrmojo.gmaps.EnumGraphicType;mstrmojo.vi.viz.MapboxVisualizationTransition=mstrmojo.declare(mstrmojo.vi.viz.MapVisualizationTransition,null,{scriptClass:"mstrmojo.vi.viz.MapboxVisualizationTransition",shouldSkipTransition:mstrmojo.emptyFn});}());(function(){mstrmojo.requiresCls("mstrmojo.Button","mstrmojo.XtabZone","mstrmojo.DICFactory","mstrmojo.DynamicClassFactory");var AR=102,S=1,K=2,F=1,AN=4,r=mstrmojo.css,p=mstrmojo.dom,k=mstrmojo.hash,w=mstrmojo.array,f=mstrmojo.DynamicClassFactory.newComponent,L=1,AT=2,I=4,Q=1,g=2,Y=1,C=2,AO=1,H=2,AB=1,z=2,e=2,l=1,AV=6,AE=7,J=function(AX){if(AX){return AX.tui>=0?("h_"+AX.tui+"_"+AX.fi+"_"+AX.axis):("m_"+AX.mix);}return"";};function AA(Ad,AZ,Aa){var Ac=this.nm[AZ],AY=Aa.v,Ab=Aa.dv;Ad.rv=AY;Ad.v=Ab;Ad.mdf=1;if(Ad._src){Ad._src.rv=AY;Ad._src.v=Ab;Ad._src.mdf=1;}var AX=this.dicGroupMap[J(Ad)].widgetsMap[Ad._ei];if(!AX.showByDefault){if(AX.hasPreview){AX.renderPreview();}else{if(p.isIE7&&mstrmojo.string.isEmpty(AY)){AY=" ";}Ac[Ac.innerText!==undefined?"innerText":"textContent"]=(!AY?"\u00a0":AY);}}return Ac;}function c(Aa,Ab,AX){if(AX[Ab]===0){return true;}if(Aa&&AX[Ab]===undefined){try{var AY=Aa.getRowCells(Ab),Ac=AY&&AY[0];if(Ac&&Ac.o===Ab){if(Ac.sst){AX[Ab]=0;}return !!Ac.stt;}if(Ac&&Ac.o){return c(Aa,Ab+Ab-Ac.o,AX);}return false;}catch(AZ){return false;}}else{return false;}}function M(AY,AX){w.forEach(AY,function(AZ){AX[AZ.o]=1;});}function AS(AX){if(AX.mgh&&(AX.mgh&S)){this.mghMarks={};}}function AC(AZ,Ab){var AY=Ab.bb-1,AX=Math.min(AY+Ab.bc,Ab.tc),Aa;k.forEach(AZ,function(Ad,Ac){Aa=Number(Ac);if(!isNaN(Aa)&&Aa>=AY&&Aa<AX){delete AZ[Ac];}});}function AH(Aa,AZ){var AX=this.editing?1:(Aa.rs||1),AY;for(AY=0;AY<AX;AY++){this.dirtyRows[AZ+AY]=1;}}function AW(AX){return AX&&parseInt(AX.ipt,10)===e;}function AQ(AX){var AY;this.delegateGridAction(function(AZ){if(!AY&&AZ.posMap&&AZ.posMap[AX._ei]){AY=AZ;}},"getRowIndex");return AY.getRowIdxByCell(AX);}function m(AX){var Ad=AX.thPosMap,Af=AX.slot,Ac=Ad&&Ad.length||0,Ah=this.lastHeaderIndexs[Af]||0,Ab=[AX.tableNode],Ae,AZ,Ag,Aa;if(this.getStickedTableNodes){Ab=Ab.concat(this.getStickedTableNodes());}for(Aa=Ah;Aa<Ac;++Aa){Ae=Ad[Aa],Ag=Ae.obj;if(this.isEditableHeader(Ag)){for(var AY in Ab){AM(Ab[AY],Ae);}}}this.lastHeaderIndexs[Af]=Aa;}function AM(AX,AZ){var AY=AX.tBodies[AZ.page].rows[AZ.row].cells[AZ.cell];AY.innerHTML='<div class="editable-column">'+AY.innerHTML+"</div>";}function n(AZ){var Ab=true,AY=AZ||[];for(var Aa=0,AX=AY.length;Aa<AX;Aa++){if(AY[Aa]&&(AY[Aa].w==="")){Ab=false;break;}}return Ab?"40px":"";}function v(AX){return !AX.tav||!(AX.tav&F);}function AK(Ab,AZ,Ad,Ak){var Ae=false;for(var Ac=0;Ac<Ab.length;Ac++){var Ah=Ab[Ac],AY=Ah.style,Aa=parseFloat(r.getStyleValue(Ah,"padding-left"))||0,AX=parseFloat(r.getStyleValue(Ah,"padding-right"))||0,Aj=parseFloat(r.getStyleValue(Ah,"padding-top"))||0,Af=parseFloat(r.getStyleValue(Ah,"padding-bottom"))||0;var Ai=Ah.getElementsByClassName("tableLayoutList")[0];var Ag=Ah.getElementsByClassName("mstrmojo-TableLayoutList")[0];if(Ai&&Ag){if(Ai.clientWidth>AZ[Ac]){AY.width=Ai.clientWidth+"px";Ag.style.width="auto";Ae=true;}else{AY.width=AZ[Ac]-Aa-AX+"px";}if(Ai.clientHeight>Ad[Ac]){AY.height=Ai.clientHeight+"px";Ag.style.height="auto";Ae=true;}else{AY.height=Ad[Ac]-Aj-Af+"px";}}else{AY.width=AZ[Ac]-Aa-AX+"px";AY.height=Ad[Ac]-Aj-Af+"px";}}if(Ae){Ak.style.width="auto";}}mstrmojo._IsEditableGridCP={_mixinName:"mstrmojo._IsEditableGridCP",initContent:function AJ(Aa){this._super(Aa);var Ag=this.gridData,AY=Ag&&Ag.vp,Ae,Ad,Af,Ai,AX,Ah,AZ,Ac;if(((this.type===L)||(this.type===I))&&AY&&AY.cols&&!AY._adjusted){AX=AY.cols.cg;AZ=AY.cols.cws;if(AX&&AX.cgc>0){for(Ae=AX.cgc;Ae>0;Ae--){AX[Ae]=k.copy(AX[Ae-1],{});Ah=AX[Ae];var Ab=Ah.attForms;if(Ab){for(Ad=0,Ai=Ab.length;Ad<Ai;Ad++){Af=Ab[Ad];Af.idx+=1;}}}AX[0]={tg:false,cc:0,cl:1,attForms:[{n:"",idx:0}]};AX.cgc+=1;}if(AZ){AZ.splice(0,0,{w:"60px",xc:true});}if(AY.dafIdx!==undefined){AY.dafIdx+=1;}Ac=Ag.gts.row;for(Ae=0,Ai=Ac.length;Ae<Ai;Ae++){Ac[Ae].ci=Ae+1;}AY._adjusted=true;}this.colWidths=[{w:n(this.colWidths)}].concat(this.colWidths);this.unmergedCells=[];},getUnmergedCells:function b(){return null;},getRowCells:function AF(Ah){var AZ=this._super(Ah),AX=AZ[0],Al=(AX&&AX.o)||0,Ai=(this.tp===L),Ac=this.interactiveCellsArray,Ak={css:"",v:""},Ao=[],AY=[],Ap,Aq;if(!Ai){var Ae=this.base.items,An=this.lookupBase,Am=this.gridData.css,At=AX&&AX.pi,Aj=At&&At.ri,As=At&&At.ci,Af=AX.stt>0;while(At&&Aj>-1&&As>-1){AX=AX._p||Ae[Aj].items[As];var Aa=k.copy(AX,{});Aa._src=AX;if(!Aa.css){Aa.css=Am[Aa.cni].n;}var Ag=An[AX.tui],Ar=Ag&&Ag.es[AX.idx];if(Ar){Aa.v=AX.v||Ar.n;Aa._e=Ar;}Aa.rs=1;if(Af){Aa.at&=~32;}if(Al>-1){Aa.o=Al;}if(!Aa.axis&&this.axis){Aa.axis=this.axis;}Aa._ei=Ac.push(Aa)-1;Ao.splice(0,0,Aa);At=AX&&AX.pi;Aj=At&&At.ri;As=At&&At.ci;}for(Ap=0,Aq=AZ.length;Ap<Aq;Ap++){var Ab=AZ[Ap];if(Ab.rs>1){var Ad=k.copy(Ab,{});Ad.rs=1;Ab=Ad;}AY.push(Ab);}}else{AY=AZ;if(Ah>0){return AZ;}}if(AY[0]){Ak=k.copy(AY[0],{});Ak.rv=Ak.v="";if(this.tp===L){Ak.n=Ak.v="";Ak.markAll=true;}else{Ak.n="";}Ak._ei=Ac.push(Ak)-1;Ak.at=32;Ak.cs=1;Ak.mark=true;Ak.mix="x";Ak.css=(Ao[0]&&Ao[0].css)||Ak.css;delete Ak.ui;delete Ak.tui;delete Ak.fs;delete Ak.mdf;}return[Ak].concat(Ao.concat(AY));}};mstrmojo._IsEditableXtab=mstrmojo.provide("mstrmojo._IsEditableXtab",{_mixinName:"mstrmojo._IsEditableXtab",update:function AD(AZ){var AX,AY=AZ.data;if(this._super){this._super(AZ);}this.kc={};this.rs={};this.rsDelta={};AS.call(this,AY);if(AY.eg!==undefined){return ;}AX=AZ.data.marked;if(AX){M(AX,this.rs);}if(!AY.rw){var Aa=AY.gvs.items.length;AY.rw={row:{bb:1,bc:Aa,tc:Aa},col:{bb:-1,bc:-1,tc:0}};}},initCP:function E(AZ,AY,Ae,Ab,Ad,Aa,Ac){var AX={gridData:AZ,type:Ae,interactiveCellsArray:AY};AX.base=Ab||AX.base;AX.lookupBase=Ad||AX.lookupBase;AX.axis=Aa||AX.axis;AX.dataSource=this;if(!Ac){if(this.tca===K&&this.editing){if(Ae===L){mstrmojo.EditableXtabTitlesCP=f(mstrmojo.XtabTitlesCP,[mstrmojo._IsEditableGridCP],{scriptClass:"mstrmojo.EditableXtabTitlesCP",tp:L});Ac=new mstrmojo.EditableXtabTitlesCP(AX);}else{if(Ae===I){mstrmojo.EditableXtabCP=f(mstrmojo.XtabCP,[mstrmojo._IsEditableGridCP],{scriptClass:"mstrmojo.EditableXtabCP"});Ac=new mstrmojo.EditableXtabCP(AX);}else{Ac=new mstrmojo.XtabCP(AX);}}}else{if(Ae===L){Ac=new mstrmojo.XtabTitlesCP(AX);}else{Ac=new mstrmojo.XtabCP(AX);}}}else{k.copy(AX,Ac);}return Ac;},createOnDemandCP:function q(AY,AZ,AX){var Aa;if(this.tca===K&&this.editing&&AX===I){mstrmojo.EditableXtabOnDemandCP=f(mstrmojo.XtabOnDemandCP,[mstrmojo._IsEditableGridCP],{scriptClass:"mstrmojo.EditableXtabOnDemandCP"});Aa=new mstrmojo.EditableXtabOnDemandCP();}else{Aa=new mstrmojo.XtabOnDemandCP();}Aa.dataSource=this;Aa.blockNum=AY;Aa.rc=AZ;return Aa;},preBuildRendering:function B(){var AX=this.defn.txi;if(this._super){this._super();}this.txar=AX.txar;this.sci=AX.sci;this.tca=AX.tca;if(this.tca!==K){this.editing=false;}else{if(mstrApp.isMobile){this.editing=this.alwaysEditing=true;}}this.nm={};this.ko={};this.dirtyRows={};this.requiredCellsMap={};this.dicGroupMap={};this.lastIndex=0;this.lastHeaderIndexs={};this.columnNames={};},postBuildRendering:function a(){if(this._super){this._super();}if(this.tca===K&&this.gridData.eg===undefined){var AZ=Math.max(-16,-this.domNode.offsetTop),Aa=this;if(!this.alwaysEditing){var AX=mstrmojo.Button.newIconButton(mstrmojo.desc(8324,"Mark rows"),"mstrmojo-EditButton",function(){if(!Aa.recalculating){Aa.editing=!Aa.editing;Aa.refresh();}}),AY=new mstrmojo.Button(mstrmojo.hash.copy({cssText:"top:"+AZ+"px;"},AX));AY.render();this.domNode.appendChild(AY.domNode);if(this.editing){this.domNode.style.zIndex=1000;r.addClass(AY.domNode,"close");}else{r.removeClass(AY.domNode,"close");}}}},dataDownloadErr:function N(){if(this.txar&&this.recalculating){this.delegateGridAction(function(AX){AX.isDownloading=false;},"isDownloading");this.rhsCP.initContent();this.valuesCP.initContent();r.removeClass(this.maskNode,"wait");this.recalculating=false;}},dataDownloaded:function W(Aa,AY){var AZ=Aa.data;if(this.txar){var AX=AY.blockNum,Ab;if(this.recalculating){AY.recalculating=true;this.interactiveCellsArray=[];this.requiredCellsMap={};this.dirtyRows={};this.lastIndex=0;this.lastHeaderIndexs={};this.kc={};this.nm={};this.updatedCellsMap={};this.recalculating=false;this.destroyDICs();}else{AY.recalculating=false;}if(AX===0){this.gridData=AZ;}if(AZ.eg){this.refresh();return ;}Ab=this.interactiveCellsArray;this.initCP(AZ,Ab,L,null,null,null,this.titlesCP);this.initCP(AZ,Ab,AT,AZ.ghs.chs,AZ.gts.col,g,this.chsCP);this.titlesCP.initContent();this.chsCP.initContent();this.delegateGridAction(function(Ac){if(Ab&&Ab.length===0){grid.refresh();}},"refreshOnDataDownloaded");}if(this._super){this._super(Aa,AY);}AS.call(this,AZ);AC(this.rs,AZ.rw.row);if(AZ.marked){M(AZ.marked,this.rs);this.rsDelta={};}},closeDownloadStatus:function Z(){if(this._super){this._super();}mstrmojo.css.removeClass(this._STATUS,"recalculate");},kc:null,ko:null,nm:null,rs:null,dicGroupMap:null,lastIndex:0,lastHeaderIndexs:{},columnNames:null,getDataInputInfo:function j(AX,Aa){var Af=AX._ei,Ae,AZ=this.node.defn,An=this.gridData;if(AX.mark){Ae=AX.o;if(AX.stt){this.rs[Ae]=0;return ;}this.ko[Ae]=Af;AX.rv=AX.v=this.rs[Ae]||-1;this.kc[Af]={rowop:true};return{key:Af,t:AR,vls:[{v:-1},{v:1}],wm:1,w:22,hm:1,h:16,dm:1};}var Ai=this.model.getCellTitleInfo(AX,this.dataBlocks[AX._gd]),Ao=Ai&&Ai.title,Ak=Ao&&Ao.es,Ad=(AX.mti!==undefined)?AX.mti:AX.mix,Ab=(AX.mix!==undefined),Al=AZ.txi.dic,Ah;Ah=k.copy(!Ab?Al.att&&Ao&&Al.att[Ao.id]&&Al.att[Ao.id][Ao.fs[AX.fi].id]:Al.mtx&&Al.mtx[Ak[Ad].oid],{});if(!Ah){return null;}if(this.columnNames[Aa]===undefined){this.columnNames[Aa]=!Ab?Ao.n:Ak[Ad].n;}if(AW(Ah)){Ah.vls=(An.dcv&&An.dcv[Ah.k])||[];}if(An.tcs&&An.tcs[Ah.k]){var Ag=An.tcs[Ah.k];if(Ag&F){Ah.disabled=true;}if(Ag&AN){Ah.req=1;}}if(Af>=0&&!this.kc[Af]){var Am=!AX.axis,Ac={isMv:Am};if(Am){var Aj=AX.pi,AY=Aj&&Aj.top;Ac.co=(AY&&AY.ci)||0;Ac.metric_id=Ak[Ad].oid;AX.o=Ac.o=(AX._lp&&AX._lp.o)||0;Ac.tp=C;}else{Ac.ax=AX.axis;Ac.atid=Ao.id;Ac.form_id=Ao.fs[AX.fi].id;Ac.o=AX.o;Ac.tp=Y;Ac.fi=AX.fi;Ac.ui=AX.ui;Ac.tui=AX.tui;Ac.rs=AX.rs;}Ac.dt=Ah.dt;if(AW(Ah)){Ac.vls=Ah.vls;Ac.k=Ah.k;}this.kc[Af]=Ac;}Ah.key=Af;if(Ah.dm){Ah.dm=parseInt(Ah.dm,10);}return Ah;},isEditableHeader:function G(AX){var AY=this.node.defn,AZ=AY.txi.dic;if(AX.sst||!AZ){return false;}if(AX.id!==undefined&&AZ.att){return !!(AZ.att[AX.id]&&(AX.fix?AZ.att[AX.id][AX.fid]:AZ.att[AX.id]));}if(AX.tui!==undefined&&AX.mix!==undefined&&AZ.mtx){return !!(AZ.mtx[AX._e.oid]);}return false;},dataChanged:function R(AZ,Aa,AY,Ab,AX){if(!this.recalculating){if(Ab){this.nm[AZ]=Ab;}if(this._super){this._super(AZ,Aa,AY,Ab,AX);}}},updateValue:function h(Aa,AY){if(this._super){this._super(Aa,AY);}var Ae=this.interactiveCellsArray[Aa],Ai=AY.v,Aj,AX=AQ.call(this,Ae);this.lmr=null;Aj=AA.call(this,Ae,Aa,AY);this.updateDirtyUnits();if(Ae.r!==Ai){if(!Ae.mark){Ae.mdf=1;mstrmojo.css.removeClass(Aj,"required");AH.apply(this,[Ae,AX]);this.flagDirtyUnit(Aj);}}else{this.clearDirtyUnit(Aj);}if(this.onCellUpdated){this.onCellUpdated(Ae,Aj);}if(this.tca===K){if(Ae.mark){var Ac=Ae.markAll?-1:Ae.o,Ag=this.rsDelta;this.rs[Ac]=Ai;this.lmr={r:Ac,v:Ai};if(Ae.markAll){Ag=this.rsDelta={};Ag[Ac]=Ai;this.mghMarks={};}else{if(Ag[Ac]&&Ag[Ac]!==Ai){delete Ag[Ac];}else{if(Ag[-1]!==Ai){Ag[Ac]=Ai;}}}}else{if(this.rs[Ae.o]!==0){this.rs[Ae.o]=1;}if(!this.editing&&this.mghMarks&&(Ae.mix===undefined)){if(!this.mghMarks[Ae.o]||this.mghMarks[Ae.o].rs<Ae.rs){this.mghMarks[Ae.o]={o:Ae.o,rs:Ae.rs,k:Aa};}var Ab,Af,Ad=this;k.forEach(this.rsDelta,function(Ak,Al){Ab=parseInt(Al,10);Af=parseInt(Ae.o,10);if(Ab>=Af&&Ab<=(Af+Ae.rs)){delete Ad.rsDelta[Al];}});}else{this.rsDelta[Ae.o]=1;}if(!this.editing&&Ae.rs>1){var AZ=Ae.o+1;while(AZ-Ae.o<Ae.rs){if(!c(this.rhsCP,AZ,this.rs)){this.rs[AZ]=1;}AZ+=1;}}if(this.editing){var Ah=this.dicGroupMap.m_x.widgetsMap[this.ko[Ae.o]];if(Ah){Ah.set("checked",true);}}}}if(this.txar&&!Ae.mark){return true;}return false;},autoRefresh:function AG(AX){this.delegateGridAction(function(AY){AY.invalidAllPages();},"invalidAllPages");this.rhsCP.invalid();this.valuesCP.invalid();r.addClass(this._STATUS,"recalculate");this.delegateGridAction(function(AY){var AZ=AY.parent;if(AZ&&!AY.connectedScrollbox){AZ.connectScrollbox(AY);AY.connectedScrollbox=true;}AY.onscroll(true,AX);},"scrollOnAutoRefresh");this.recalculating=true;},getKeyContext:function P(AX){return this.kc[AX];},getUpdateObject:function U(){var Ac=[],Aa,Ad,Ae,AY=this.lmr,AZ,Ab={};if(AY){this.lmr=null;return{manipulation:AO,actionType:(AY.v===-1)?AB:z,rowOrdinal:AY.r,nodeKey:this.k,sliceId:this.sid};}Ad=this.getUpdatedValues();for(Aa=0;Aa<(Ad&&Ad.length);Aa++){if(!Ad[Aa].rowop){Ae=Ad[Aa];break;}}if(Ae){AZ=mstrmojo.string.encodeXMLAttribute(String(Ae.v));if(Ae.k!==undefined&&Ae.vls){var AX=w.find(Ae.vls,"v",Ae.v);if(AX!==-1){Ab={controlKey:Ae.k,elementId:Ae.vls[AX].eid};}}if(!!Ae.isMv){Ac.push(k.copy(Ab,{rowOrdinal:Ae.o,colOrdinal:Ae.co,newValue:AZ,dataType:Ae.dt}));}else{Ac.push(k.copy(Ab,{rowOrdinal:Ae.o,attId:Ae.atid,formId:Ae.form_id,unitIndex:Ae.tui||Ae.ui,newValue:AZ,dataType:Ae.dt}));}}return{manipulation:H,nodeKey:this.k,sliceId:this.sid,cells:Ac,autoRefresh:this.txar};},getUpdates:function V(){var Ah=this,Ac,Ad,AX=Ah.getUpdatedValues(),Aa=this.rsDelta,Ab=[],Ag=[],Ae=false,AZ="";Ab.push('<gr rw_tree_type="'+Ah.treeType+'" rw_node_key="'+Ah.k+'" slice_id="'+Ah.sid+'">');for(Ac in AX){if(AX.hasOwnProperty(Ac)){Ad=AX[Ac];if(!Ad.rowop){var Ai=mstrmojo.string.encodeXMLAttribute(String(Ad.v)),AY=w.find(Ad.vls,"v",Ad.v);if(Ad.k&&Ad.vls&&AY===-1){if(!!Ad.isMv){Ag.push('<cli cordinal="'+Ad.co+'" metric_id="'+Ad.metric_id+'"><updt types="'+AE+'" rordinal="'+Ad.o+'" rw_control_key="'+Ad.k+'"/></cli>');}else{Ag.push('<cli ax="'+Ad.ax+'" attribute_id="'+Ad.atid+'" form_id="'+Ad.form_id+'"><updt types="'+AV+'" ordinal="'+Ad.o+'" rw_control_key="'+Ad.k+'" flags="1"/></cli>');}}else{if(Ad.k&&Ad.vls&&AY!==-1){AZ='rw_control_key="'+Ad.k+'" element_id="'+mstrmojo.string.encodeXMLAttribute(String(Ad.vls[AY].eid))+'" ';}if(!!Ad.isMv){Ag.push('<cli cordinal="'+Ad.co+'" metric_id="'+Ad.metric_id+'"><updt types="'+Ad.tp+'" rordinal="'+Ad.o+'" '+AZ+'value="'+Ai+'" dt="'+Ad.dt+'"/></cli>');}else{Ag.push('<cli ax="'+Ad.ax+'" attribute_id="'+Ad.atid+'" form_id="'+Ad.form_id+'"><updt types="'+Ad.tp+'" ordinal="'+Ad.o+'" '+AZ+'value="'+Ai+'" dt="'+Ad.dt+'"'+(this.mghMarks?' flags="1"':"")+"/></cli>");}}Ae=true;}}}if(!k.isEmpty(this.mghMarks)){var Af=this;k.forEach(this.mghMarks,function(Aj,Ak){AZ=Af.getKeyContext(Aj.k);Ag.push('<mark rordinal="'+Ak+'" types="4" flags="1" attribute_id="'+AZ.atid+'" form_id="'+AZ.form_id+'"/>');});}if(Aa&&!k.isEmpty(Aa)){Ae=true;w.forEach(k.keyarray(Aa).sort(),function(Aj){if(Aa[Aj]===1){Ag.push('<mark rordinal="'+Aj+'" types="4"/>');}else{Ag.push('<mark rordinal="'+Aj+'" types="5"/>');}});}Ab.push(Ag.join(""));Ab.push("</gr>");if(!Ae){Ab=[];}return Ab.join("");},flagDirtyUnit:function d(AY){if(AY&&this.sci){if(this._super){this._super(AY);return ;}var AX=document.createElement("div"),Ac,AZ=false,Ab=r.getStyleValue(this.domNode,p.CSS3_TRANSFORM),Aa;AX.className="flag-container";AX.innerHTML='<div class="dirty-cell"/>';if(AY.insertBefore){AY.insertBefore(AX,AY.firstChild);Aa=(AX.offsetParent===AY);}AZ=mstrmojo.string.isEmpty(Ab)||Ab==="none";Ac=AX.firstChild;Ac.style.top=((!AZ||Aa)?(-AX.offsetTop):(AY.offsetTop-AX.offsetTop))+"px";Ac.style.left=(AY.clientWidth+((!AZ||Aa)?(-AX.offsetLeft):(AY.offsetLeft-AX.offsetLeft))-8)+"px";}},updateDirtyUnits:function AP(){var AX=this.domNode,AZ=AX.getElementsByClassName("dirty-cell"),Ab=r.getStyleValue(AX,p.CSS3_TRANSFORM),AY=mstrmojo.string.isEmpty(Ab)||Ab==="none",Aa;w.forEach(AZ,function(Ae){var Ac=Ae.parentNode,Ad=Ac&&Ac.parentNode;Aa=Ad.insertBefore?Ac.offsetParent===Ad:false;Ae.style.top=((!AY||Aa)?(-Ac.offsetTop):(Ad.offsetTop-Ac.offsetTop))+"px";Ae.style.left=(Ad.clientWidth+((!AY||Aa)?(-Ac.offsetLeft):(Ad.offsetLeft-Ac.offsetLeft))-8)+"px";});},clearDirtyUnit:function AU(AX){if(this._super){this._super(AX);return ;}var AY=AX.firstChild;if(AX){if(AY&&AY.className&&AY.className==="flag-container"){AX.removeChild(AY);}}},onvisibleChange:function u(){if(this.visible===true){var AX=this;setTimeout(function(){AX.configureActions();},10);}},configureActions:function X(){if(this.visible===false){return ;}this.configureCellsAction();this.lastIndex=this.interactiveCellsArray.length;var AX=this;this.delegateGridAction(function(AY){m.call(AX,AY);},"markEditableColHeaders");this.registerTxWidget();if(this._super){this._super();}},configureCellsAction:function AI(AZ,Aj,A4,Ab){var Ah=this,Ax=this.getTargetZone(),A4=A4||Ax.posMap,Af=AZ||this.interactiveCellsArray,Aj=(Aj===undefined?this.lastIndex:Aj),A9=this.dicGroupMap,Aq=[],A7,Ai,A5,A3,Am,An,Ao,Az,A8,Ad,Av,Ae,A1,Al=function(){var BA=[];this.delegateGridAction(function(BB){BA.push(BB);},"configureActions");return BA;},Ap=Al.call(this),Ar=(Ap.length>1),Ag=function(BA){var BC=BA.length,BB;for(BB=0;BB<BC;BB++){Ah.flagDirtyUnit(BA[BB]);}};for(A7=Aj,Ai=Af.length;Af[A7]&&A7<Ai;A7++){Am=Af[A7];An=A4&&A4[A7];if(!An&&Ar){Ax=(Ap[0]===Ax)?Ap[1]:Ap[0];A4=Ax&&Ax.posMap;An=A4&&A4[A7];}if(An&&((Am.at&32)>0)){Am.at=32;if(Am.rv==null){Am.rv=isNaN(Am.mix)?Am._e.n:Am.v;}Az=J(Am);Av=this.getDataInputInfo(Am,Az);Ae=A9[Az];if((Am.axis===g||Am.axis===Q&&Am.o===undefined)&&this.clonedColHeader&&this.clonedColHeader.isRendered()){A1=this.clonedColHeader.getTableNode();}else{if(Am.axis===Q&&this.clonedRowHeader){if(this.clonedRowHeader.isRendered()){A1=this.clonedRowHeader.getTableNode();}else{A1=Ax.tableNode;if(Av&&!Ae){this.clonedRowHeader.addGroupKey(Az);}this.clonedRowHeader.addTempDICInfo(Am,An);}}else{A1=Ax.tableNode;}}Ao=A1.tBodies[An.page].rows[An.row].cells[An.cell];if(Av){if(!Ae){Ae=A9[Az]=mstrmojo.DICFactory.createDICGroup({gk:Az,dic:Av,owner:this,openerType:l});}var Aw=!v(Am)||Av.disabled;var Ak={value:(Am.rv===undefined)?(Am.v||Am.n):(typeof Am.rv==="string"?mstrmojo.string.decodeHtmlString(Am.rv):Am.rv),dv:Am.v||Am.n,ts:Am.ts,markAll:Am.markAll,openerNode:Ao,k:Am._ei,ownerCell:Am,enabled:!Aw,popupTitle:this.columnNames[Az]},Aa=Ax.cp.stackedRh;if(Aa&&Am.singleStack&&(mstrmojo.DICConfig.showDICByDefault(Av,1)||mstrmojo.DICConfig.hasDICPreview(Av,1))){var A2=Ao.offsetHeight;Ao.className+=" igDIC";Ao.style.cssText="height:"+A2+"px;";if(Ae.showByDefault){Ao.className+=" sbd";}mstrmojo.hash.copy({inlineExtraCssText:"position:absolute;top:"+parseInt(Aa/2-A2/2+1,10)+"px;"},Ak);}Ae.addDIC(Am._ei,Ak);A8=An.page*Ax.rowsPerPage+An.row;if(Av.req){for(A3=0;A3<(this.editing?1:(Am.rs||1));A3++){Ad=this.requiredCellsMap[A8+A3];if(!Ad){this.requiredCellsMap[A8+A3]=Ad=[];}Ad.push(Am);}}if(Am.mdf&&!Ab){Aq.push(Ao);AH.apply(this,[Am,A8]);}if(Aw&&!mstrmojo.DICConfig.showDICByDefault(Av,1)){var At=document.createElement("div"),Au=document.createElement("span"),Ay=Ao.currentStyle||document.defaultView.getComputedStyle(Ao,null),AX={marginLeft:"-"+Ay.paddingLeft,paddingLeft:Ay.paddingLeft,marginRight:"-"+Ay.paddingRight,paddingRight:Ay.paddingRight,marginTop:"-"+Ay.paddingTop,paddingTop:Ay.paddingTop,marginBottom:"-"+Ay.paddingBottom,paddingBottom:Ay.paddingBottom};At.className="xtab-dic-disabled";k.copy(AX,At.style);Au.appendChild(Ao.firstChild);At.appendChild(Au);Ao.appendChild(At);}}}}this.lastIndex=A7;var A6=Ax.tableNode.rows,As=A6&&A6.length>=2,Ac,AY=[],A0=[];if(As){Ac=A6[1].children;w.forEach(Ac,function(BA){AY.push(BA.clientWidth);A0.push(BA.clientHeight);});}for(Az in A9){A9[Az].render();}if(As){AK(Ac,AY,A0,Ax.tableNode);}setTimeout(function(){Ag(Aq);},25);},destroyDICGroup:function t(AY){var AZ=this.dicGroupMap,AX,Aa,Ab;if(AZ&&(AY instanceof Array)){for(AX in AY){Aa=AY[AX];Ab=AZ[Aa];if(Ab){Ab.destroy();delete AZ[Aa];}}}},showPopupDIC:function A(Aa){var AY=Aa&&p.findAncestorByAttr(Aa,"ei",true,this.viewport);if(AY){var Ab=AY.node,AX=this.getCellForNode(Ab),AZ=this.dicGroupMap[J(AX)];if(AZ&&!AZ.dic.disabled&&!(AX.tav&&(AX.tav&F))){AZ.showPopupDIC(AX._ei);return true;}}return false;},onclick:function AL(AY){var AX=mstrmojo.dom.eventTarget(window,AY.e);if(!this.showPopupDIC(AX)&&this._super){this._super(AY);}},unrender:function D(){if(this._super){this._super();}this.destroyDICs();},destroyDICs:function x(){var AX=this.dicGroupMap;this.dicGroupMap={};setTimeout(function(){var AY;for(AY in AX){AX[AY].destroy();}},10);},checkRequiredObjects:function O(){if(this.hasRendered&&!(this.isInteractiveGrid&&this.isInteractiveGrid())&&!this.gridData.eg){var AZ=this.getTargetZone();if(!AZ){return true;}var Ab=AZ.posMap,Ad,Aa=this,AY=this.rs,AX=true,Ac=function(Aj,Af){var Ai=true,Ag=Aa.requiredCellsMap[Aj],Ae=(Ag&&Ag.length)||0,Ah;for(Ah=0;Ah<Ae;Ah++){if(!Ag[Ah].mdf){r.toggleClass(AZ.getNodeByPosition(Ab[Ag[Ah]._ei]),"required",Af);Ai=!Af;}}return Ai;};if(this.tca===K){for(Ad in AY){AX=Ac(parseInt(Ad,10)+1,AY[Ad]>0)&&AX;}}else{for(Ad in this.dirtyRows){AX=Ac(Ad,true)&&AX;}}return AX;}return true;},editNext:function o(AZ){if(this.recalculating){return false;}var Aa=this.interactiveCellsArray,AX=Aa.length,Ab=AZ+1,Ac,AY;do{if(Ab>=AX){Ab%=AX;}if(Ab===AZ){return false;}Ac=Aa[Ab];var Ad=this.dicGroupMap[J(Ac)];if(Ad&&!Ad.dic.disabled&&v(Ac)){if(mstrmojo.DICConfig.isKeyNavigable(Ad.dic)){if(!Ad.showByDefault){Ad.showPopupDIC(Ab);}else{AY=Ad.widgetsMap[Ab];AY.focus();}return true;}}Ab++;}while(true);}});}());(function(){mstrmojo.requiresCls("mstrmojo.Obj","mstrmojo.XtabZone","mstrmojo.css","mstrmojo.hash","mstrmojo.dom");var c=0,A=1,AA=2,J=3,l={1:"_BL",2:"_TR",3:"_TL"},AI=1,v=2,o={position:"absolute",overflow:"hidden",width:"auto"},r={position:"absolute",top:0,left:0},E=mstrmojo.css,e=mstrmojo.hash,j=mstrmojo.dom;function L(AM,AL,AJ,AK){if(AK){AM.replaceChild(AL,AM.tBodies[AJ]);}else{AM.appendChild(AL);}}function I(AJ){AJ.offsetCellNode=null;AJ.fstValueCellValidation=null;}function S(){var AP={x:0,y:0};if(this.lockHeadersCase&&!this.offsetCellNode&&!this.fstValueCellValidation){var AQ=this.titlesCP.getSpanDimension(),AJ=AQ.nRow,AN=AQ.nCol,AY=this.scrollboxNode.firstChild.firstChild,AU=AY&&AY.rows[AJ];if(AJ===0||AN===0){this.lockHeadersCase=c;return null;}if(!AY.rows.length){return null;}if(!AU){this.fstValueCellValidation|=AI;this.lockHeadersCase&=AI;AU=AY.rows[0];}var AX=AU&&AU.cells,AT=(AX&&AX.length)||0,AL,AR,AS;for(AR=AS=0;AR<AT&&AS<AN;AR++){AS+=AX[AR].colSpan||1;}AL=AX&&AX[AR];if(!AL){this.fstValueCellValidation|=v;this.lockHeadersCase&=v;this.offsetCellNode=AX&&AX[0];}else{this.offsetCellNode=AL;}var AW=this;var AM=function(){AW._adjustClipSize();};var AO=function(Ac,Ae){var Ab,Aa,AZ,Ad;for(Ab=0;Ab<Ae;Ab++){AZ=Ac.rows[Ab].getElementsByTagName("img");for(Aa=0;Aa<AZ.length;Aa++){Ad=AZ[Aa];Ad.onload=AM;Ad.onerror=AM;}}};AO(AY,AJ||0);}if(this.lockHeadersCase){var AV=j.position(this.offsetCellNode),AK=j.position(this.scrollboxNode.firstChild);AP.x=AV.x-AK.x;AP.y=AV.y-AK.y;}return AP;}function O(AL,AJ,AK,AP){if(this.parent.isAutoTableLayout()&&this.isRendered()){if(!this.fragment){this.fragment=document.createDocumentFragment();}if(AP){var AM=AL.cloneNode(true);if(!this.renderedPages){q.call(this);}if(AK&&this.renderedPages[AJ]){var AO=this.renderedPages[AJ],AN=this.getTableNode();if(AO.parentNode===AN){AN.replaceChild(AM,AO);}else{this.fragment.replaceChild(AM,AO);}}else{this.fragment.appendChild(AM);}this.renderedPages[AJ]=AM;}}}function AD(AK,AJ){for(var AL in AK){if(AK[AL]!=AJ[AL]){return false;}}return true;}function t(){var AK=this.fragment,AJ,AN,AL;if(AK&&AK.childNodes.length>0&&this.isRendered()){var AM=this.getTableNode();if(this.parent.isOutlineMode){while(AK.childNodes.length>0){AJ=AK.childNodes[0];AN=parseInt(AJ.getAttribute("n"),10);if(AM.tBodies[AN]){AM.replaceChild(AJ,AM.tBodies[AN]);}else{AM.appendChild(AJ);}}}else{AM.appendChild(AK);}}}function p(){var AK=this.xtabClonedNodes,AO=this.cellHoverMgr,AM,AN,AJ,AL;if(!AO){return ;}for(AJ in AK){AM=AK[AJ];AL=AM.getID();AN=AM.isRendered();if(!this.zones[AL]&&AN){this.zones[AL]={tableNode:AM.getTableNode()};if(typeof (AO)!="string"){AO.addMgrElement(AL);}}}}function N(AK,AJ){var AL=this.parent,AM=AL&&AL.zone;if(AJ&&AM&&AM.addCoverTable){AM.addCoverTable(AK,AJ);}}function m(AK,AJ,AL){AK.width=((AL&&AL.width<AJ.right)?AL.width:AJ.right)+"px";AK.height=((AL&&AL.height<AJ.bottom)?AL.height:AJ.bottom)+"px";}function q(){this.renderedPages={};var AO=this.getTableNode(),AK=AO.tBodies,AL=this.fragment,AQ=AL&&AL.children,AN=this.renderedPages,AJ,AM,AP=function(AR){var AS=AR.getAttribute("n")||0;AN[AS]=AR;};for(AM=0,AJ=AK.length;AM<AJ;++AM){AP(AK[AM]);}for(AM=0,AJ=(AQ&&AQ.length)||0;AM<AJ;++AM){AP(AQ[AM]);}}function K(AN,AJ,AK){var AL=AJ&&AJ.rows[AN.row],AM=AL&&AL.cells[AN.cell];if(AM&&AK!==AM){AL.replaceChild(AK.cloneNode(true),AM);}}function R(AK,AJ){if(this.isRendered()){if(!this.renderedPages){q.call(this);}K(AK,this.renderedPages[AK.page||0],AJ);}}mstrmojo.XtabZoneWithClonedCover=mstrmojo.declare(mstrmojo.XtabZone,null,{scriptClass:"mstrmojo.XtabZoneWithClonedCover",isAutoTBLayout:null,addCoverTable:function M(AJ,AK){if(!this.coverTableNodes){this.coverTableNodes={};}this.coverTableNodes[l[AJ]]=AK;},getClonedNodesByPositions:function Q(AR){var AQ=this.coverTableNodes,AK=AQ&&AQ[l[J]],AT=AQ&&AQ[l[AA]],AN=AQ&&AQ[l[A]],AM=[AK,AT,AN],AJ,AU,AP=[],AL=function(AW,AY){var AV=AW&&AW.tBodies[AY.page||0],AX=AV&&AV.rows[AY.row];return AX&&AX.cells[AY.cell];};for(var AO in AR){AJ=AR[AO];if(AJ.page&&AN){AU=AL(AN,AJ);AU&&AP.push(AU);}else{for(var AS in AM){if(AM[AS]){AU=AL(AM[AS],AJ);AU&&AP.push(AU);}}}}return AP;},setHilites:function U(AT,AN){var AO=AN.getAttribute("ei"),AS=this.eiMap[AO]||(this.posMap[AO]&&[this.posMap[AO]])||[],AQ=this.hiliteCellsMap,AM=this.parent,AK=this.getNodesByPositions(AS),AJ=function(AU){E.addClass(AU,"sc_"+AM.k);};if(!AQ[AT]){AQ[AT]={pos:[],nodes:[]};}if(!AK.length){AJ(AN);AQ[AT].nodes.push(AN);}else{if(AS.length!==0){var AL=this.getClonedNodesByPositions(AS),AR=AQ[AT].pos;AK=AL.concat(AK);for(var AP in AK){AJ(AK[AP]);}AQ[AT].pos=AR.concat(AS);}}},clearHilites:function C(AK){var AN=this.hiliteCellsMap[AK],AL=AN&&AN.nodes,AO=(AL&&AL.length===0&&AN.pos)||[],AM=this.parent;if(AO.length!==0){AL=this.getNodesByPositions(AO);AL=AL.concat(this.getClonedNodesByPositions(AO));}for(var AJ in AL){E.removeClass(AL[AJ],"sc_"+AM.k);}this.hiliteCellsMap[AK]={nodes:[],pos:[]};},isAutoTableLayout:function AB(){if(this.isAutoTBLayout===null&&this.tableNode){this.isAutoTBLayout=(this.tableNode.style.tableLayout!=="fixed");}return this.isAutoTBLayout;},unrender:function B(AJ){this.coverTableNodes={};this.isAutoTBLayout=null;this._super(AJ);}});mstrmojo.XtabClonedNode=mstrmojo.declare(mstrmojo.Obj,null,{scriptClass:"mstrmojo.XtabClonedNode",domNode:null,left:0,top:0,lockType:c,scrollDM:mstrmojo.emptyFn,refreshNode:mstrmojo.emptyFn,createDomNode:function b(){var AJ=this._getClonedFragment();this.containerNode.appendChild(AJ);N.call(this,this.lockType,this.getTableNode());},getID:function V(){return this.id;},getTableSize:function Z(){var AK=this.parent.zone.tableNode,AJ=this.parent.hasCustomScrollbar?"offset":"client";return{width:AK[AJ+"Width"],height:AK[AJ+"Height"]};},isRendered:function H(){return !!this.domNode;},getTableNode:function AG(){return this.isRendered()?this.domNode.firstChild.firstChild:null;},destroy:function w(AJ){if(this.isRendered()){this.unrender(true);}this._super(AJ);},unrender:function B(AJ){this.domNode=null;this.lastClipRect=null;this._super&&this._super(AJ);},insertPage:function AH(AL,AJ,AK,AM){if(this.isRendered()){L(this.getTableNode(),AL.cloneNode(true),AJ,AK);}},_getClipStr:function a(AJ){this.lastClipRect=AJ;return"rect("+AJ.top+"px, "+AJ.right+"px, "+AJ.bottom+"px, "+AJ.left+"px)";},adjustClip:function d(AL){var AJ=this._getClipRect&&this._getClipRect(AL);if(this.isRendered()){if(this.getTableNode().offsetHeight>this.domNode.offsetHeight){this.domNode.style.height=this.getTableNode().offsetHeight+"px";}if(AJ&&!(this.lastClipRect&&AD(AJ,this.lastClipRect))){this.domNode.style.clip=this._getClipStr(AJ);var AK={};m(AK,AJ,this.getTableSize());e.copy(AK,this.curtainNode.style);}}this.offset=AL;}});mstrmojo.XtabClonedRowHeader=mstrmojo.declare(mstrmojo.XtabClonedNode,null,{scriptClass:"mstrmojo.XtabClonedRowHeader",lockType:A,interactiveCellsArray:[],interactivePosArray:[],dicGroupKey:[],init:function AE(AJ){this._super(AJ);if((this.lockHeadersCase&A)&&this.left){this.createDomNode();}},_getClipRect:function D(AK){var AJ=this.parent.hasCustomScrollbar?"offset":"client";AK=AK||this.offset;return{top:0,right:AK.x||0,bottom:this.toCloneNode[AJ+"Height"],left:0};},_clearLocalData:function G(){this.interactiveCellsArray=[];this.interactivePosArray=[];this.dicGroupKey=[];},_getClonedFragment:function Y(){var AJ=document.createDocumentFragment(),AN=this.toCloneNode.cloneNode(true),AM=document.createElement("div"),AL=e.clone(o),AO=e.clone(r),AK=this._getClipRect();AL.clip=this._getClipStr(AK);AL.zIndex=2;if(this.parent.zone&&this.parent.zone.autoFitWindow){AL.width="100%";}AL.overflowY="hidden";AN.id=this.getID();e.copy(AL,AN.style);e.copy({top:-this.top+"px"},AN.firstChild.style);this.domNode=AN;m(AO,AK,this.getTableSize());AO.zIndex=1;e.copy(AO,AM.style);this.curtainNode=AM;AJ.appendChild(AN);AJ.appendChild(AM);return AJ;},scrollDM:function g(AK,AP,AR){var AL=this.parent.shouldClipLockableXtab,AM;if(this.lockHeadersCase&A){if(!this.isRendered()){this.top=AP;this.createDomNode();this.domNode.style.width="100%";this.domNode.style.height="100%";var AO=this;setTimeout(function(){AO._updateDICGroup();},10);}else{var AQ=this.domNode.firstChild,AJ=AQ.style;AJ.top=-AP+"px";this.top=AP;if(AL){if(AJ.position!=="absolute"){AJ.position="absolute";AJ.width="100%";}if(this.lockHeadersCase&AA){AM={top:this.offset.y+AP,right:this.offset.x,bottom:AQ.offsetHeight,left:0};AJ.clip=this._getClipStr(AM);}}}if(AL&&this.isRendered()){var AT=this.getTableNode();AM={top:0,right:Math.max(AT.offsetWidth,AR.offsetWidth),bottom:Math.max(AT.offsetHeight,AR.offsetHeight),left:this.offset.x+AK};var AN=AR.style,AS=AR.parentNode.style;if(AN.position!=="absolute"){if(isNaN(parseInt(AS.width,10))){AS.width=AR.parentNode.offsetWidth+"px";}if(isNaN(parseInt(AS.height,10))){AS.height=AR.parentNode.offsetHeight+"px";}AN.position="absolute";AN.width="100%";if(isNaN(parseInt(AS.width,10))){AS.width=AM.right+"px";}}AN.clip=this._getClipStr(AM);}}},_updateDICGroup:function k(){var AJ=this.parent;if(this.interactivePosArray.length&&this.interactiveCellsArray.length){AJ.destroyDICGroup(this.dicGroupKey);AJ.configureCellsAction(this.interactiveCellsArray,0,this.interactivePosArray,true);}this._clearLocalData();},addTempDICInfo:function AC(AJ,AK){if(!this.isRendered()){this.interactiveCellsArray.push(AJ);this.interactivePosArray.push(AK);}},addGroupKey:function AF(AJ){if(!this.isRendered()){this.dicGroupKey.push(AJ);}},onCellUpdated:function u(AO,AL){if(this.isRendered()){var AJ=this.getTableNode(),AK=AJ&&AJ.tBodies[AO.page||0],AM=AK&&AK.rows[AO.row],AN=AM&&AM.cells[AO.cell];if(AN&&AL!==AN){AM.replaceChild(AL.cloneNode(true),AN);}}},unrender:function B(AJ){this._clearLocalData();this._super&&this._super(AJ);}});mstrmojo.XtabClonedColHeader=mstrmojo.declare(mstrmojo.XtabClonedNode,null,{scriptClass:"mstrmojo.XtabClonedColHeader",lockType:AA,init:function AE(AJ){this._super(AJ);if(this.lockHeadersCase&AA){this.createDomNode();}},_getClipRect:function D(AK){var AJ=this.parent.hasCustomScrollbar?"offset":"client";AK=AK||this.offset;return{top:0,right:this.toCloneNode[AJ+"Width"],bottom:AK.y||0,left:0};},_getClonedFragment:function Y(){var AJ=document.createDocumentFragment(),AN=this.toCloneNode.cloneNode(true),AM=document.createElement("div"),AL=e.clone(o),AO=e.clone(r),AK=this._getClipRect();AL.clip=this._getClipStr(AK);AL.zIndex=4;if(this.parent.zone&&this.parent.zone.autoFitWindow){AL.width="100%";}AN.id=this.getID();e.copy(AL,AN.style);e.copy({left:-this.left+"px"},AN.firstChild.style);this.domNode=AN;m(AO,AK,this.getTableSize());AO.zIndex=3;e.copy(AO,AM.style);this.curtainNode=AM;AJ.appendChild(AN);AJ.appendChild(AM);return AJ;},scrollDM:function g(AK,AO,AQ){var AL=this.parent.shouldClipLockableXtab,AM;if(this.lockHeadersCase&AA){var AS=this.getTableNode();var AP=this.domNode.firstChild,AJ=AP.style;this.domNode.style.width="100%";this.domNode.style.height="100%";AJ.left=-AK+"px";this.left=AK;if(AL){if(AJ.position!=="absolute"){AJ.position="absolute";AJ.width="100%";}if(this.lockHeadersCase&A){AM=this._getClipRect();AM.left=AK+this.offset.x;AM.right=Math.max(AP.offsetWidth,AS.offsetWidth);AJ.clip=this._getClipStr(AM);}}if(AL){AM={top:this.offset.y+AQ.parentElement.scrollTop,right:Math.max(AS.offsetWidth,AQ.offsetWidth),bottom:Math.max(AS.offsetHeight,AQ.offsetHeight),left:0};if(this.lockHeadersCase&A){AM.left=this.offset.x+AK;}var AN=AQ.style,AR=AQ.parentNode.style;if(AN.position!=="absolute"){if(isNaN(parseInt(AR.width,10))){AR.width=AQ.parentNode.offsetWidth+"px";}if(isNaN(parseInt(AR.height,10))){AR.height=AQ.parentNode.offsetHeight+"px";}AN.position="absolute";AN.width="100%";if(isNaN(parseInt(AR.width,10))){AR.width=AS.offsetWidth+"px";}}AN.clip=this._getClipStr(AM);}}},insertPage:O,refreshNode:t,onCellUpdated:R,unrender:function B(AJ){this._super(AJ);this.fragment=null;this.renderedPages=null;}});mstrmojo.XtabClonedTitle=mstrmojo.declare(mstrmojo.XtabClonedNode,null,{scriptClass:"mstrmojo.XtabClonedTitle",_getClipRect:function D(AJ){AJ=AJ||this.offset;return{top:0,right:AJ.x||0,bottom:AJ.y||0,left:0};},init:function AE(AJ){this._super(AJ);if(this.lockHeadersCase===J&&this.left){this.createDomNode();}},_getClonedFragment:function Y(){var AJ=document.createDocumentFragment(),AN=this.toCloneNode.cloneNode(true),AM=document.createElement("div"),AL=e.clone(o),AO=e.copy(r),AK=this._getClipRect();AL.clip=this._getClipStr(AK);AL.zIndex=6;if(this.parent.zone&&this.parent.zone.autoFitWindow){AL.width="100%";}e.copy(AL,AN.style);AN.firstChild.style.left=0;AN.id=this.getID();this.domNode=AN;m(AO,AK,this.getTableSize());AO.zIndex=5;e.copy(AO,AM.style);this.curtainNode=AM;AJ.appendChild(AN);AJ.appendChild(AM);return AJ;},scrollDM:function g(AM,AL,AK){if(this.lockHeadersCase===J&&!this.isRendered()){this.createDomNode();this.domNode.style.width="100%";this.domNode.style.height="100%";}if(this.parent.shouldClipLockableXtab&&this.isRendered()){var AJ=this.domNode.firstChild.style;if(AJ.position!=="absolute"){AJ.position="absolute";AJ.width="100%";}AJ.clip=this._getClipStr(this._getClipRect());}},insertPage:O,refreshNode:t,onCellUpdated:R,unrender:function B(AJ){this._super(AJ);this.fragment=null;this.renderedPages=null;}});mstrmojo._IsLockableXtab={_mixinName:"mstrmojo._IsLockableXtab",initLock:function z(AR){var AN=S.call(this),AQ=this.scrollboxNode;if(this.lockHeadersCase&&AQ&&AN){var AP=document.createElement("div"),AJ=e.copy(AR,{containerNode:AP,toCloneNode:AQ,offset:AN,lockHeadersCase:this.lockHeadersCase,parent:this});if(!this.xtabClonedNodes){this.xtabClonedNodes=[];}if(this.lockHeadersCase&A){if(!this.clonedRowHeader){this.clonedRowHeader=this.addDisposable(new mstrmojo.XtabClonedRowHeader(AJ));this.xtabClonedNodes.push(this.clonedRowHeader);}}if(this.lockHeadersCase&AA){if(!this.clonedColHeader){this.clonedColHeader=this.addDisposable(new mstrmojo.XtabClonedColHeader(AJ));this.xtabClonedNodes.push(this.clonedColHeader);}}if(this.lockHeadersCase===J){if(!this.clonedTitle){var AL=this.clonedColHeader,AO=AL.domNode,AK=AL.fragment;AJ.toCloneNode=AO||AJ.toCloneNode;AJ.fragment=AK&&AK.cloneNode();this.clonedTitle=this.addDisposable(new mstrmojo.XtabClonedTitle(AJ));this.xtabClonedNodes.push(this.clonedTitle);}}var AM=this.hasCustomScrollbar?"offset":"client",AS={top:0,left:0,position:"absolute",overflow:"hidden",width:AQ[AM+"Width"]+"px",height:AQ[AM+"Height"]+"px"};e.copy(AS,AP.style);this.tableContainerNode.appendChild(AP);this.lockFragment=AP;p.call(this);}},getColClonedZone:function F(){return this.clonedColHeader&&this.clonedColHeader.domNode.firstChild;},createZone:function n(AJ){return new mstrmojo.XtabZoneWithClonedCover(AJ||{});},getStickedTableNodes:function X(){var AK=this.xtabClonedNodes,AL=[];if(AK instanceof Array){for(var AJ in AK){var AM=AK[AJ];if(AM.isRendered()){AL.push(AM.getTableNode());}}}return AL;},_adjustClipSize:function h(){if(this.lockHeadersCase){var AK=this.xtabClonedNodes;if(AK&&AK.length){var AL=S.call(this);this.lockFragment.style.width=(this.hasCustomScrollbar?parseInt(this.scrollboxNode.style.width,10):this.scrollboxNode.clientWidth)+"px";this.lockFragment.style.height=this.scrollboxNode.clientHeight+"px";for(var AJ in AK){AK[AJ].adjustClip(AL);}}}},_refreshClonedNodes:function W(){var AM=this.xtabClonedNodes,AS=this.scrollboxNode.firstChild.firstChild,AJ=this.titlesCP.getSpanDimension().nRow,AR=AS&&(AS.rows[AJ]||AS.rows[0]),AQ=AR&&AR.cells,AK=AQ&&AQ.length,AN=[],AP=!this.lastCellsRBOffsetLeft,AO;for(AO=0;AO<AK;++AO){var AL=AQ[AO].offsetWidth;AN.push(AL);if(!AP){AP=(this.lastCellsRBOffsetLeft[AO]!=AL);}}this.lastCellsRBOffsetLeft=AN;if(AP){for(AO in AM){AM[AO].refreshNode();}this._adjustClipSize();this.alignLockNodes(this.scrollboxLeft,this.scrollboxTop);}else{this._adjustClipSize();}},alignLockNodes:function x(AM,AL){var AK=this.xtabClonedNodes;if(AK&&AK.length){for(var AJ in AK){AK[AJ].scrollDM(AM,AL,this.scrollboxNode.firstChild);}p.call(this);}},isAutoTableLayout:function AB(){return this.zone.isAutoTableLayout();},onPageRendered:function P(AM,AJ,AK,AO){this._super&&this._super(AM,AJ,AK,AO);if(AK&&AJ===0){I(this);}var AL=this.xtabClonedNodes;if(AL&&AL.length){for(var AN in AL){AL[AN].insertPage(AM,AJ,AK,AO);}}},gridPagesRendered:function f(){this._super&&this._super();if(!this.lockHeadersCase){return ;}if(!this.xtabClonedNodes){this.initLock();}else{if(this.isAutoTableLayout()){this._refreshClonedNodes();}}},onCellUpdated:function u(AJ,AM){var AN=this.zone,AO=AN.posMap[AJ._ei],AK=AN.tableNode.tBodies[AO.page||0],AL=this.xtabClonedNodes;K(AO,AK,AM);for(idx in AL){AL[idx].onCellUpdated(AO,AM);}if(this.isAutoTableLayout()){this._refreshClonedNodes();}},unrender:function B(AL){var AK=this.xtabClonedNodes,AJ;if(AK&&AK.length){for(AJ in AK){AK[AJ].unrender(true);}}this.zones=null;I(this);this.lockFragment=null;this.xtabClonedNodes=null;this.clonedColHeader=null;this.clonedRowHeader=null;this.clonedTitle=null;this.lastCellsRBOffsetLeft=null;this._super(AL);}};})();(function(){mstrmojo.requiresCls("mstrmojo.ListBox","mstrmojo.ListBoxBase");mstrmojo.ButtonItemRenderer=mstrmojo.hash.copy(mstrmojo.DivItemRenderer);mstrmojo.ButtonItemRenderer.render=function(D,A,E){var B=D.v!=="u;"?" nAll":"",C=(E.enabled===false);return'<input mstridx="'+A+'" class="'+E.itemCssClass+(E.selectedIndices[A]?" "+E.itemSelectedCssClass:"")+" "+(D.css||"")+B+'" style="'+E.itemCssText+'" type="button"  value="'+D[E.itemDisplayField]+'" '+(C?"disabled ":"")+"/>";};mstrmojo._RendersItemButtons=mstrmojo.hash.copy(mstrmojo._RendersItemDivs);mstrmojo._RendersItemButtons.itemRenderer=mstrmojo.ButtonItemRenderer;mstrmojo.ButtonList=mstrmojo.declare(mstrmojo.ListBox,[mstrmojo._RendersItemButtons],{scriptClass:"mstrmojo.ButtonList",cssClass:"mstrmojo-ButtonList",itemCssClass:"mstrmojo-ButtonItem",selectionPolicy:"toggle"});mstrmojo.requiresCls("mstrmojo.ListBoxHoriz");mstrmojo.ButtonListHoriz=mstrmojo.declare(mstrmojo.ListBoxHoriz,[mstrmojo._RendersItemButtons],{scriptClass:"mstrmojo.ButtonListHoriz",cssClass:"mstrmojo-ButtonListHoriz",itemCssClass:"mstrmojo-ButtonItem",selectionPolicy:"toggle"});}());(function(){mstrmojo.requiresCls("mstrmojo.ListBox","mstrmojo.color");var C=[127,206,255];var D=[216,230,239];var B=function(H,K){if(!H||H==="transparent"){H="#FFFFFF";}var G=mstrmojo.color.hex2rgb(H),J,I,E;if(!K){J=Math.round((3/5)*parseInt(G[0])+110);I=Math.round((3/5)*parseInt(G[1])+110);E=Math.round((3/5)*parseInt(G[2])+110);}else{J=G[0]*K[0]/255;I=G[1]*K[1]/255;E=G[2]*K[2]/255;var F=G[0]*0.3+G[1]*0.59+G[2]*0.11;if(F<85){J=J+(63*((85-F)/85));if(J>255){J=255;}I=I+(63*((85-F)/85));if(I>255){I=255;}E=E+(96*((85-F)/85));if(E>255){E=255;}}}return"#"+mstrmojo.color.rgb2hex(J,I,E);};var A=function(F,G,E){if(F&&F.style){F.style.backgroundColor=G["bg"+E+"Color"]||"";F.style.color=G["text"+E+"Color"]||"";}};mstrmojo.LinkItemRenderer=mstrmojo.hash.copy({render:function(G,E,H){var F=G.v!=="u;"?" nAll":"";return'<input mstridx="'+E+'" class="'+H.itemCssClass+(H.selectedIndices[E]?" "+H.itemSelectedCssClass:"")+F+'" style="'+H.itemCssText+" color:"+(H.selectedIndices[E]?H.textSelectedColor:H.textNormalColor)+"; background-color:"+(H.selectedIndices[E]?H.bgSelectedColor:H.bgNormalColor)+';" type="button"  value="'+G[H.itemDisplayField]+'"  onmouseover="mstrmojo.all.'+H.id+".onmouseover(self, "+E+')" onmouseout="mstrmojo.all.'+H.id+".onmouseout(self, "+E+')"/>';},select:function(F,G,E,H){F.className+=" selected";A(F,H,"Selected");},unselect:function(F,G,E,H){F.className=F.className.replace(/selected/g,"");A(F,H,"Normal");},highlight:function(G,H,E,I){var F=I.selectedIndices[E]?"Selected":"Highlighted";A(G,I,F);},unhighlight:function(G,H,E,I){var F=I.selectedIndices[E]?"Selected":"Normal";A(G,I,F);}},mstrmojo.hash.copy(mstrmojo.DivItemRenderer));mstrmojo._RendersItemLinks=mstrmojo.hash.copy({onmouseover:function(G,E){if(isNaN(E)||E<0){return ;}var F=this._getItemNode(E);this.itemRenderer.highlight(F,this.items[E],E,this);},onmouseout:function(G,E){if(isNaN(E)||E<0){return ;}var F=this._getItemNode(E);this.itemRenderer.unhighlight(F,this.items[E],E,this);},preBuildRendering:function(){this.bgNormalColor=this["background-color"]||this.parent&&this.parent["background-color"];this.bgSelectedColor=this.parent&&this.parent.defn&&this.parent.defn.ssc;if(this.bgSelectedColor!=null){if(this.bgSelectedColor==="transparent"){this.bgHighlightedColor=mstrmojo.LinkList.dftTrptBgHltColor;}else{this.bgHighlightedColor=B(this.bgSelectedColor);}}else{this.bgSelectedColor=B(this.bgNormalColor,C);this.bgHighlightedColor=B(this.bgNormalColor,D);}this.textSelectedColor=(this.bgSelectedColor==="transparent")?mstrmojo.LinkList.dftTrptTxSelColor:mstrmojo.color.getContrastingColor(this.bgSelectedColor,"#ffffff","#000000");this.textHighlightedColor=(this.bgSelectedColor==="transparent")?mstrmojo.LinkList.dftTrptTxHltColor:mstrmojo.color.getContrastingColor(this.bgHighlightedColor,"#ffffff","#000000");this.textNormalColor=this.color;if(this._super){this._super();}}},mstrmojo.hash.copy(mstrmojo._RendersItemDivs));mstrmojo._RendersItemLinks.itemRenderer=mstrmojo.LinkItemRenderer;mstrmojo.requiresCls("mstrmojo.ListBox");mstrmojo.LinkList=mstrmojo.declare(mstrmojo.ListBox,[mstrmojo._RendersItemLinks],{scriptClass:"mstrmojo.LinkList",cssClass:"mstrmojo-LinkList",itemCssClass:"mstrmojo-LinkList-item",selectionPolicy:"toggle"});mstrmojo.LinkList.dftTrptBgHltColor="#FFFFFF";mstrmojo.LinkList.dftTrptTxSelColor="#FFFFFF";mstrmojo.LinkList.dftTrptTxHltColor="#000000";mstrmojo.requiresCls("mstrmojo.ListBoxHoriz");mstrmojo.LinkListHoriz=mstrmojo.declare(mstrmojo.ListBoxHoriz,[mstrmojo._RendersItemLinks],{scriptClass:"mstrmojo.LinkListHoriz",cssClass:"mstrmojo-LinkListHoriz",itemCssClass:"mstrmojo-LinkListHoriz-item",selectionPolicy:"toggle"});})();(function(){mstrmojo.requiresCls("mstrmojo.ListBox","mstrmojo.ListBoxHoriz","mstrmojo.string");var B=mstrmojo.string;var A={render:function(G,C,H){var I=(H.htmlName+C),E=H.selectedIndices[C]?"checked ":"",F=E?" selected":"",D=G.v!=="u;"?" nAll":"";return'<div class="'+H.itemCssClass+F+D+'"><input type="'+H.inputType+'" name="'+H.htmlName+'" id="'+I+'" value="'+C+'" '+E+'/><label for="'+I+'" title="'+B.encodeHtmlString(G[H.itemTitleField]||"")+'" style="'+H.labelCssText+'">'+B.encodeHtmlString(G[H.itemDisplayField||"n"])+"</label></div>";},select:function(D){var C=D&&D.firstChild;if(C){if(!C.checked){C.checked=true;}mstrmojo.css.toggleClass(D,"selected",C.checked);}},unselect:function(D){var C=D&&D.firstChild;if(C){if(C.checked){C.checked=false;}mstrmojo.css.toggleClass(D,"selected",C.checked);}},rowHeight:23};mstrmojo._RendersInputItems=mstrmojo.provide("mstrmojo._RendersInputItems",{inputType:null,htmlName:null,itemRenderer:A,init:function(C){this._super(C);if(!this.htmlName){this.htmlName=this.id;}},preclick:function(F){var E=F.hWin,H=F.e,G=mstrmojo.dom.eventTarget(E,H);if(G&&G.nodeName.match(/input/i)){var D=parseInt(G.value,10);if(this.inputType&&this.inputType.match(/radio/i)){this.singleSelect(D);}else{var C=(G.checked)?"add":"remove";this[C+"Select"](D);}}}});mstrmojo._InputList=mstrmojo.declare(mstrmojo.ListBox,[mstrmojo._RendersInputItems],{scriptClass:"mstrmojo._InputList"});mstrmojo._InputListHoriz=mstrmojo.declare(mstrmojo.ListBoxHoriz,[mstrmojo._RendersInputItems],{scriptClass:"mstrmojo._InputListHoriz"});}());(function(){mstrmojo.requiresCls("mstrmojo.ListBox","mstrmojo.hash","mstrmojo.string");var B=mstrmojo.hash,A=mstrmojo.string;mstrmojo.ListSelectorItemRenderer=B.clone(mstrmojo.DivItemRenderer);mstrmojo.ListSelectorItemRenderer.render=function(F,C,G){var D=F.v!="u;"?" nAll":"",E=G.getItemName?G.getItemName(F,C):(G.itemDisplayField&&F[G.itemDisplayField]);if(mstrmojo.string.isEmpty(E)){E="<br/>";}return'<div mstridx="'+C+'" class="'+G.itemCssClass+(G.selectedIndices[C]?" "+G.itemSelectedCssClass:"")+D+'" style="'+G.itemCssText+'">'+A.encodeHtmlString(E)+"</div>";};mstrmojo.ListBoxSelector=mstrmojo.declare(mstrmojo.ListBox,null,{itemRenderer:mstrmojo.ListSelectorItemRenderer});})();(function(){mstrmojo.requiresCls("mstrmojo.ui.CheckList","mstrmojo.ui._IsHierarchyList","mstrmojo.css","mstrmojo.array","mstrmojo.EnumSelectionType");var S=mstrmojo.css,K=mstrmojo.array,A=mstrmojo.EnumSelectionType;var V="hidden",Q="selected",R="expanded",F="collapsed",I="hierarchy",M="hasChildren";var P="u;",Z=10;mstrmojo.ui.HierarchyCheckList=mstrmojo.declare(mstrmojo.ui.CheckList,[mstrmojo.ui._IsHierarchyList],{scriptClass:"mstrmojo.ui.HierarchyCheckList",markupString:'<div id="{@id}" class="mstrmojo-ui-CheckList {@cssClass}" style="{@cssText}" mstrAttach:click,contextmenu><div class="header"></div><div class="scroll-container"><div class="{@icnCss}" style="{@icnCssText}">{@itemsHtml}</div></div><div class="footer"></div></div>',markupSlots:{headerNode:function E(){return this.domNode.firstChild;},footerNode:function C(){return this.domNode.lastChild;},scrollboxNode:function H(){return this.domNode.children[1];},itemsContainerNode:function U(){return this.domNode.children[1].firstChild;}},getItemMarkup:function D(b,a){return'<{@tag} class="item {@cls}" idx="{@idx}" style="{@style}" title="{@tt}"><span class="indent" style="padding-left: {@indent}px;"></span><span class="triangle"></span><span class="checkbox"></span><span class="text">{@en@n}</span></{@tag}>';},getItemProps:function X(c,a){var b=this._super(c,a);if(c.isSelected){b.addCls(Q);}if(this.isHiearachyDisplay()){if(c.hcd){b.addCls(c.epd?R:F);}}return b;},setupScrollNodes:function J(){this.scrollNode=this.scrollboxNode;var a=this.domNode.clientHeight-this.headerNode.clientHeight-this.footerNode.clientHeight;if(a>0){this.scrollNode.style.height=a+"px";}},onclick:function Y(a){var c=a.getTarget(),d=this.getItemNodeFromTarget(c),b=this.getItemFromTarget(c);if(b){if(S.hasClass(c,"triangle")){if(b.hcd){this.doExpandCollapse(d,b);}}else{if(!S.hasClass(c,"indent")){this.doBranchSelect(d,b,!b.isSelected);}}a.cancel();}},doElementSelect:function W(c,b,a){b.isSelected=a;this.onSelectionChange(A.ELEMENT,a,b);this.updateItemNodesStatus();},doBranchSelect:function O(d,b,a){var c=function(e){e.isSelected=a;e.isBranchSelected=a;(e.children||[]).forEach(function(f){c(f);});};c(b);this.onSelectionChange(A.BRANCH,a,b);this.updateItemNodesStatus();},doLevelSelect:function G(b,a){this.getItems().forEach(function(c){if(c.lv===b){c.isSelected=a;}});this.onSelectionChange(A.LEVEL,a,null,b);this.updateItemNodesStatus();},doBranchLevelSelect:function B(e,b,d,a){var c=function(f){if(f.lv===d){f.isSelected=a;}else{if(f.lv<d){(f.children||[]).forEach(function(g){c(g);});}}};c(b);this.onSelectionChange(A.BRANCH_LEVEL,a,b,d);this.updateItemNodesStatus();},doAllSelect:function L(a){this.getItems().forEach(function(b){b.isSelected=b.isBranchSelected=a;});this.onSelectionChange(A.ALL,a);this.updateItemNodesStatus();},updateItemNodesStatus:function N(){var a=this.itemsContainerNode&&this.itemsContainerNode.childNodes;K.forEach(a,function(c){var b=this.getItemFromTarget(c);if(b){S.toggleClass(c,Q,b.isSelected);}},this);},onSelectionChange:mstrmojo.emptyFn});}());(function(){mstrmojo.requiresCls("mstrmojo.ui.CheckList","mstrmojo.css","mstrmojo.dom","mstrmojo._HasTooltip");var E=mstrmojo.dom,A=mstrmojo.tooltip,H=mstrmojo.css;var B="only";var C;var L;mstrmojo.vi.ui.rw.selectors.CheckList=mstrmojo.declare(mstrmojo.ui.CheckList,[mstrmojo._HasTooltip],{scriptClass:"mstrmojo.vi.ui.rw.selectors.CheckList",isShowOnly:true,tooltip:"",useRichTooltip:true,init:function N(O){this._super(O);H.addWidgetCssClass(this,"mstrmojo-vi-sel-CheckList");if(E.isSafari){H.addWidgetCssClass(this,"safari-checklist");}},shouldShowTooltip:function F(O,Q){var P=O.target||E.eventTarget(O.hWin,O.e);return P.classList.contains("text");},getTooltipContent:function G(O){var P=O.target||E.eventTarget(O.hWin,O.e);return P&&P.innerText;},updateTooltipConfig:function D(P){var W=P.target||E.eventTarget(P.hWin,P.e),O=E.position(W),R=35,S="vi-tooltip-C",V=A.POS_TOPLEFT;if(!this.multiSelect){R=6;}var U=O.w+R,Q=E.windowDim().w;if(Q<(O.x+U+300)){S="vi-tooltip-D";U=-25;V=A.POS_TOPRIGHT;}this.richTooltip={content:this.getTooltipContent(P),top:-4,cssClass:"vi-regular "+S,left:U,refNode:W,posType:V};},showTooltip:function K(O,P){if(this.shouldShowTooltip(O,P)){this._super(O,P);}},getItemMarkup:function J(P,O){if(!C){C=this._super(P).replace('<span class="text">{@en@n}</span>','<span class="icon"></span><span class="text">{@en@n}</span>');L=this._super(P).replace('<span class="text">{@en@n}</span>','<span class="'+B+'">'+mstrmojo.desc(11573,"only")+'</span><span class="icon"></span><span class="text">{@en@n}</span>');}if(this.isShowOnly&&(!this.multiSelect||(O!==this.allIdx&&O!==this.noneIdx))){return L;}return C;},getItemProps:function I(R,O){var Q=this._super(R,O);if(((this.isHoriz&&(this.orientation!=="v"))||(!this.isHoriz&&this.orientation==="h"))&&this.itemWidthMode===0){var S=this.items.length,P=100/S;if(O===S-1){P=100-((S-1)*P);}Q.addStyle("width:"+P+"%");}return Q;},onclick:function M(O){var Q=O.getTarget(),P=this.getItemFromTarget(Q);if(Q.className===B){if(P){this.docSelector.handleActionInSyncPhase(function(){this.clearSelect();},this);this.select([P._renderIdx]);}}else{if(P){this.doItemSelect(P,O||{});}}}});}());(function(){mstrmojo.requiresClsP("mstrmojo","ListBase","_IsList");mstrmojo.requiresCls("mstrmojo.ui.CheckList");mstrmojo.requiresDescs(2121,2122,2125,2127,2123,2124,2126,2128,2129,2130);var D=mstrmojo.desc,C=mstrmojo.array;mstrmojo.express.ui.SubtotalsWidget=mstrmojo.declare(mstrmojo.ui.CheckList,null,{scriptClass:"mstrmojo.express.ui.SubtotalsWidget",prevSelection:{},itemField:"v",selectionPolicy:"toggle",multiSelect:true,init:function B(E){this._super(E);mstrmojo.css.addWidgetCssClass(this,"mstrmojo-vi-subtotals");},_set_selectedItems:function(H,F){var E=[],G=this.prevSelection={};C.forEach((F||[]),function(I){E.push(I.t);});C.forEach(E,function(I){G[I]=true;});this.setSelectedItems(C.filter(this.items,function(I){return C.indexOf(E,I.v)>-1;}));},getSubtotalTypes:function A(){var G=this.items,H=this.selectedIndices,J=this.prevSelection,F=G.filter(function(L,K){return H[K]&&!J[L.v];}),I=G.filter(function(L,K){return !H[K]&&J[L.v];}),E=function(K){return K.v;};return[F.map(E),I.map(E)];},items:[{n:D(2121,"Total"),v:-10},{n:D(2122,"Average"),v:-12},{n:D(2125,"Maximum"),v:-14},{n:D(2127,"Minimum"),v:-13},{n:D(2123,"Count"),v:-11},{n:D(2124,"Geometric Mean"),v:-20},{n:D(2126,"Median"),v:-16},{n:D(2128,"Mode"),v:-17},{n:D(2129,"Product"),v:-15},{n:D(2130,"Standard Deviation"),v:-18},{n:D(2132,"Variance"),v:-19}]});}());(function(){mstrmojo.requiresCls("mstrmojo.ui.CheckList","mstrmojo.css","mstrmojo.ui._HasListTooltip");var E=mstrmojo.css;var C;mstrmojo.ui.IconTooltipCheckList=mstrmojo.declare(mstrmojo.ui.CheckList,[mstrmojo.ui._HasListTooltip],{scriptClass:"mstrmojo.ui.IconTooltipCheckList",markupString:'<div id="{@id}" class="mstrmojo-ui-CheckList {@cssClass}" style="{@cssText}" mstrAttach:click,contextmenu,mouseover><div class="scroll-container"><div class="{@icnCss}" style="{@icnCssText}">{@itemsHtml}</div></div></div>',markupSlots:{scrollboxNode:function A(){return this.domNode.firstChild;},itemsContainerNode:function F(){return this.domNode.firstChild.firstChild;}},getItemMarkup:function I(L){if(!C){var K='><span class="text">{@en@n}</span> <span class="{@iconCss}" ttp="{@ttp}"></span><';C=this._super(L).replace(">{@en@n}<",K);}return C;},markupslots:{scrollboxNode:function A(){return this.domNode.firstChild;},itemsContainerNode:function F(){return this.domNode.firstChild.firstChild;}},getItemProps:function G(N,L){var M=this._super(N,L),K={"\r\n":" ","\n":" ","\r":" "};if(N.css){M.addCls(N.css);}M.ttp=N.ttp||"";M.iconCss=N.iconCss||"";N.n=mstrmojo.string.multiReplace(N.n,K);M.n=N.n||"";return M;},postBuildRendering:function B(){this.set("richTooltip",{cssClass:"vi-regular vi-tooltip-D",refNode:this.itemsContainerNode,posType:mstrmojo.tooltip.POS_TOPRIGHT,keepArrowXPos:false});},useRichTooltip:true,tooltipOffset:0,tooltipMarkup:'<div class="content" style="{@style}">{@c}</div>',tooltipOrientation:"horizontal",tooltipCss:{leftCssClass:"no-arrow",rightCssClass:"no-arrow"},showTooltip:function H(L,N){var M=this,K=mstrmojo.dom.position(L.target);M.richTooltip.top=Math.max(K.y+K.h);M.richTooltip.left=Math.max(K.x+4,0);this._super(L,N);},getTooltipText:function D(K){return K.ttp;},onmouseover:function J(K){var O=this.id,L=mstrmojo.all[O],N=K.getTarget(),M=N.getAttribute("ttp");if(!M){return ;}L.richTooltip.content=M;L.showTooltip(K.e,self);}});}());(function(){mstrmojo.requiresCls("mstrmojo.ui.ScrollableList","mstrmojo.css");var P=mstrmojo.color,C=mstrmojo.models.FormatModel,E=C.ENUM_PROPERTY_NAMES,H="transparent",A="#000000",D="#2f9ad3",J="#ffffff";function B(){return this.docSelector.style===mstrmojo.DocSelector.STYLES.LIST&&!this.docSelector.isInFilterPanel();}function G(R,U){if(B.call(this)){var Q=R.style,S=this.stateCssText[U];Q.background=S.bg;Q.color=S.text;}}mstrmojo.vi.ui.rw.selectors.ListBoxSelector=mstrmojo.declare(mstrmojo.ui.ScrollableList,null,{scriptClass:"mstrmojo.vi.ui.rw.selectors.ListBoxSelector",init:function O(Q){this._super(Q);mstrmojo.css.addWidgetCssClass(this,"mstrmojo-vi-sel-ListBox");},getItemMarkup:function L(R,Q){if(mstrmojo.string.isEmpty(R.n)){return this._super(R,Q).replace("{@en@n}","&nbsp;");}return this._super(R,Q);},listHooks:{select:function(Q){G.call(this,Q,"selected");},unselect:function(Q){G.call(this,Q,"base");}},getItemProps:function I(U,Q){var R=this._super(U,Q);if(B.call(this)){var V=this.stateCssText,S=R.sel?V.selected:V.base;R.addStyle("background:"+S.bg+";color:"+S.text);}return R;},preBuildRendering:function K(){if(B.call(this)){var R=this.docSelector,Q=R.getFormats(),V=this.getPropertyDefaultValue(E.SELECTOR_SELECTION_COLOR)||D,U=this.getPropertyDefaultValue(E.COLOR)||J,S=R.defn.ssc!==undefined?C.decodeValue(E.SELECTOR_SELECTION_COLOR,R.defn.ssc):V;this.stateCssText={base:{bg:Q["background-color"]||H,text:Q.color||A},selected:{bg:S,text:P.encodeColor(S)===P.encodeColor(V)?U:P.getContrastingColor(S,"#ffffff","#000000")}};}return this._super();},getPropertyDefaultValue:function(R){var S=mstrApp.getThemeClassName(),Q=null;switch(R){case E.SELECTOR_SELECTION_COLOR:Q=S==="mojo-theme-light"?"#34ABEB":"#34ABEB";break;case E.COLOR:Q=S==="mojo-theme-light"?"#444649":"#ffffff";break;}return Q;},premousedown:function M(Q){if(mstrmojo.dom.shiftKey(Q.hWin,Q.e)){mstrmojo.dom.preventDefault(Q.hWin,Q.e);}},onclick:function N(R){var U=R.getTarget();var S=this.getItemFromTarget(U);if(S){var Q=S._renderIdx;if(this.multiSelect&&R.metaKey){var V=this.rangeSelected||this.selectedIndex===-1;this.toggleSelect(Q);if(V&&Q<this.items.length&&this.selectedIndices[Q+1]){Q++;}this.selectedIndex=Q;this.rangeSelected=false;}else{if(this.multiSelect&&R.shiftKey){this.rangeSelected=true;this.rangeSelect(Q);}else{this.singleSelect(Q);this.rangeSelected=false;}}}},updateScrollbars:function F(){if(this.hasRendered&&this.orientation==="v"){this.scrollboxNode.style.height=this.height;}this._super();}});}());(function(){mstrmojo.requiresCls("mstrmojo.ui.ScrollableList","mstrmojo.css");var B=mstrmojo.css,A=mstrmojo.desc(15615,"Click here to start selection");mstrmojo.vi.ui.rw.selectors.VisSelectorBox=mstrmojo.declare(mstrmojo.Label,null,{scriptClass:"mstrmojo.vi.ui.rw.selectors.VisSelectorBox",renderOnScroll:true,init:function D(F){this._super(F);B.addWidgetCssClass(this,"mstrmojo-vi-sel-VisSelectorBox");},updateSummaryText:function E(F){if(F){this.selections=F;}var H=this.selections?Object.keys(this.selections).length:0,G=A;if(mstrApp.isAppStatePause&&mstrApp.isAppStatePause()){G=mstrmojo.desc(15763,"Click here to edit visualization");}this.text=H<=0?G:this.docSelector.generateSummaryText(H);},getSummaryText:function C(){return this.text;}});}());(function(){mstrmojo.requiresCls("mstrmojo.ui.ScrollableList","mstrmojo._IsPopup","mstrmojo._CanAutoClose","mstrmojo.ui._HasListTooltip");mstrmojo.ui.PopupList=mstrmojo.declare(mstrmojo.ui.ScrollableList,[mstrmojo._IsPopup,mstrmojo._CanAutoClose,mstrmojo.ui._HasListTooltip],{scriptClass:"mstrmojo.ui.PopupList",autoCloses:true,locksHover:true,closeOnClick:true,scrollNodeMaxHeight:undefined,parentDomNode:undefined,keydownString:null,lastKeydownTime:null,keydownInterval:500,closeAfterSelection:true,markupString:'<div id="{@id}" class="mstrmojo-PopupList {@cssClass}" style="{@cssText}" tabIndex="-1" mstrAttach:click,dblclick,mouseover,mouseout,contextmenu,keydown><div class="mstrmojo-popupList-scrollBar"><div class="{@icnCss}" style="{@icnCssText}">{@itemsHtml}</div></div></div>',markupSlots:{itemsContainerNode:function I(){return this.domNode.firstChild.firstChild;},scrollboxNode:function A(){return this.domNode.firstChild;}},setupScrollNodes:function F(){this.scrollNode=this.scrollboxNode;},onOpen:function E(){this._super();this.updateScrollbars();var M=this;setTimeout(function(){M.scrollToSelectedItem();},10);},onclick:function K(M){this.closeAfterSelection=true;this._super(M);},postBuildRendering:function B(){var N=this._super();if(!this.parent){var M=this.parentDomNode=this.parentDomNode||document.body;M.appendChild(this.domNode);}return N;},closePopup:function J(){this.set("visible",false);},onkeydown:function H(O){if(!this.opener||!this.opener.focusOnPopup){return ;}var M=O.hWin,R=O.e||M.event,U=this.keydownString;this.locksHover=false;this.closeAfterSelection=false;if(R.keyCode===mstrmojo.Enum_Keys.DOWN_ARROW){if(this.selectedIndex<this.items.length-1){this.set("selectedIndex",this.selectedIndex+1);this.scrollToSelectedItem();}}else{if(R.keyCode===mstrmojo.Enum_Keys.UP_ARROW){if(this.selectedIndex>0){this.set("selectedIndex",this.selectedIndex-1);this.scrollToSelectedItem();}}else{if(R.keyCode===mstrmojo.Enum_Keys.ENTER||R.keyCode===mstrmojo.Enum_Keys.ESCAPE){this.closeAfterSelection=true;this.singleSelect(this.selectedIndex);}else{var S=new Date(),P=S.getTime(),N=String.fromCharCode(R.keyCode).toLowerCase(),Q=this;if(this.lastKeydownTime===null){this.keydownString=N;}else{if(P-this.lastKeydownTime<this.keydownInterval){this.keydownString=this.keydownString+N;}else{this.keydownString=N;}}U=this.keydownString;if(this._holdTimer){clearTimeout(this._holdTimer);}this._holdTimer=setTimeout(function(){Q.changeSelectedItem(O);Q.adjustPosition();},Q.keydownInterval);this.lastKeydownTime=P;}}}},changeSelectedItem:function D(M){var P=this.selectedIndex,O=this.items&&this.items.length;if(O>0){var N;for(N=this.selectedIndex+1;N<this.items.length;N++){if(this.items[N].n.toLowerCase().indexOf(this.keydownString)==0){P=N;break;}}if(P===this.selectedIndex){for(N=0;N<this.selectedIndex;N++){if(this.items[N].n.toLowerCase().indexOf(this.keydownString)==0){P=N;break;}}}if(P!==this.selectedIndex){this.set("selectedIndex",P);}}},focus:function L(){this.domNode.focus();},scrollToSelectedItem:function G(){var P=this.itemsContainerNode.childNodes[this.selectedIndex];if(P){var M=this.scrollNode,O=M.clientHeight,N=P.offsetTop;if(N-M.scrollTop+P.offsetHeight>O){M.scrollTop=P.offsetTop+P.offsetHeight-O;}else{if(N<M.scrollTop){M.scrollTop-=P.offsetHeight;}}}},adjustPosition:function C(){this.adjustCornersForPopupOverflow();this.scrollToSelectedItem();this.focus();}});}());(function(){mstrmojo.requiresCls("mstrmojo.ui.ScrollableList");var A;mstrmojo.vi.ui.rw.selectors.PageByButtonBar=mstrmojo.declare(mstrmojo.ui.ScrollableList,null,{scriptClass:"mstrmojo.vi.ui.rw.selectors.PageByButtonBar",init:function C(D){this._super(D);mstrmojo.css.addWidgetCssClass(this,["mstrmojo-vi-sel-LinkList","buttons"]);},multiSelect:false,getItemMarkup:function B(D){if(!A){A=this._super(D).replace(">{@en@n}<","><div>{@en@n}</div><");}return A;}});}());(function(){mstrmojo.requiresCls("mstrmojo.LegacySuggestionList","mstrmojo.ui._HasScroller");var E=mstrmojo.dom;mstrmojo.ui.ScrollableSuggestionList=mstrmojo.declare(mstrmojo.LegacySuggestionList,[mstrmojo.ui._HasScroller],{scriptClass:"mstrmojo.ui.ScrollableSuggestionList",markupString:'<div id="{@id}" class="mstrmojo-ListBase mstrmojo-scrollable-suggestlist {@cssClass}" style="{@cssText}" mstrAttach:click,dblclick,mouseover,mouseout,contextmenu><div class="list-content"><div class="items-container {@icnCss}" style="{@icnCssText}">{@itemsHtml}</div></div></div>',markupSlots:{itemsContainerNode:function B(){return this.domNode.firstChild.firstChild;},scrollboxNode:function D(){return this.domNode.firstChild;},scrollNode:function H(){return this.domNode.firstChild;}},onclick:function A(I){var J=this.getItemFromTarget(I.getTarget());if(J){this._super(I);}},onitemsChange:function C(){var I=this;window.setTimeout(function(){I.hideTooltip();I.updateScrollbars();},0);},updateScrollbars:function F(){this._super();var K=this,M=K.scrollNode,I=M.clientWidth,L=K.itemsContainerNode,J=L.clientWidth;L.style.width="auto";window.setTimeout(function(){if(I>J){L.style.width=J+(I-J)+"px";}},10);},useRichTooltip:true,getItemTooltip:function(L,M){var J=E.position(M),K=M.ttp;var I={areaId:L._renderIdx+"text",cssClass:"vi-regular vi-tooltip-C",contentNodeCssClass:"regular-unitlist-tooltips",posType:"",content:K,top:J.y,left:J.x+J.w+6,enableHover:false};return I;},showTooltip:function G(I,L){var K=this.targetEl,J=this.targetItem;if(K&&K.ttp){this.richTooltip=this.getItemTooltip(J,K);if(this.richTooltip){this._super(I,L);}}}});}());(function(){mstrmojo.requiresCls("mstrmojo.array","mstrmojo.hash","mstrmojo.Container","mstrmojo.Box","mstrmojo.List","mstrmojo.SearchBox2","mstrmojo.WaitIcon","mstrmojo.IncFetch");var A=mstrmojo.array,B=mstrmojo.hash;mstrmojo.ElementsBrowser=mstrmojo.declare(mstrmojo.Box,null,{scriptClass:"mstrmojo.ElementsBrowser",cssClass:"mstrmojo-ElementBrowser",rootCached:null,attributeID:null,onOK:null,onUpdateBrowseElementsParams:mstrmojo.emptyFn,init:function(C){this._super(C);this.rootCached={};},postBuildRendering:function(){if(this._super){this._super();}var E=this.ebIncFetch,C=this.ebSearchBox,D=this.ebList;E.attachEventListener("fetch",C.id,function(F){E.cp=F.v;E.children=null;E.refresh();this.fetchPage(F.v-1);});C.attachEventListener("ifsChange",E.id,function(F){var G=this.np;B.copy(F.value,this);if(this.np>1){this.children=null;this.refresh();}if(G<=1&&this.np>1||G>1&&this.np<=1||G===0&&this.np>0){this.set("visible",this.np>1);}});C.attachEventListener("itemsChange",D.id,function(F){this.set("items",F.value||[]);});},initBrowser:function(){var C=this.ebSearchBox,D=this.attributeID;C.set("rootID",D);C.clear();C.searchPattern="";if(D&&!this.rootCached[D]){C.set("items",[]);C.blockBegin=1;C.fetch();this.rootCached[D]=true;}else{if(D){C._notifyContentWidget(C.searchCache[D][D]);this.ebList.updateSelections();}}},children:[{alias:"ebSearchBox",scriptClass:"mstrmojo.SearchBox2",cssClass:"mstrmojo-ElementsBrowser-SearchBox",taskId:"browseElements",quickSearch:true,getRootID:function(){this.rootID=this.parent.attributeID;},onUpdateSearchParams:function(C){this.parent.onUpdateBrowseElementsParams(C);}},{alias:"ebList",scriptClass:"mstrmojo.List",cssClass:"mstrmojo-ELementsBrowser-List",itemIdField:"v",allowUnlistedValues:false,itemMarkup:'<div class="mstrmojo-bullet"><div class="mstrmojo-ebIcons ae"><div class="mstrmojo-text">{@en@n}</div></div></div>',updateSelections:function(){var C=this.parent,D=C.selectedItems;if(D){this.initializing=true;this.clearSelect(false);this.setSelectedItems(D,false);this.initializing=false;}},onitemsChange:function(){this.updateSelections();},onchange:function(N){if(this.initializing){return ;}var I=this.items,J=this.parent,D=J.selectedItems,G,M;for(var H=0,C=N.removed,L=C&&C.length;H<L;H++){G=I[C[H]];M=A.find(D,this.itemIdField,G[this.itemIdField]);if(M>-1){D.splice(M,1);}}for(var F=0,K=N.added,E=K&&K.length;F<E;F++){G=B.clone(I[K[F]]);D.push(G);}},multiSelect:true,selectionPolicy:"toggle"},{alias:"ebIncFetch",scriptClass:"mstrmojo.IncFetch",cssClass:"mstrmojo-ElementsBrowser-IncFetch",height:"20px",np:0,cp:0,ds:{f:mstrmojo.desc(4046,"First"),p:mstrmojo.desc(1058,"Previous"),n:mstrmojo.desc(1059,"Next"),l:mstrmojo.desc(4049,"Last"),pgs:mstrmojo.desc(5972,"## of ### pages"),gt:mstrmojo.desc(5878,"Go to:"),v:mstrmojo.desc(6079,"This field should be # between ## and ###.")},onvisibleChange:function(C){this.domNode.style.display=C.value?"block":"none";}}]});})();(function(){mstrmojo.requiresCls("mstrmojo.DocLayout");function F(P){var N=-1,O=P.children,M,L,K,I,J=[],H=function(){var R;for(R in J){var Q=J[R];if(Q._fixedHeight!==N){Q._fixedHeight=N;if(Q.domNode){Q.domNode.style.height=N+"px";}}}N=-1;J=[];};for(L in O){M=O[L];if(M&&M.node&&M.node.data&&M.node.data.bh&&N>-1){H();}if(M&&M.defn&&M.defn.horiz){for(K in M.children){I=M.children[K];N=Math.max(I._fixedHeight||0,N);J[J.length]=I;}}}H();}mstrmojo.DocLayoutHoriz=mstrmojo.declare(mstrmojo.DocLayout,null,{scriptClass:"mstrmojo.DocLayoutHoriz",markupString:'<div id="{@id}"><div class="mstrmojo-DocLayout {@cssClass}" style="{@domNodeCssText}"></div></div>',markupSlots:{containerNode:function(){return this.domNode.firstChild;}},getWidth:function A(){return this.containerNode.offsetWidth;},getHeight:function G(){return this.containerNode.offsetHeight;},_renderSection:function C(L,I){if(L.node.data.bh||(L.defn.horiz&&!this._horizOpen)){this._horizOpen=true;var M=document.createElement("div");M.className="mstrmojo-DocLayout-HBox";var J=document.createElement("table");J.className="mstrmojo-DocLayout-HBox-HorizContainerTable";this._hRow=J.insertRow(-1);M.appendChild(J);this.containerNode.appendChild(M);}if(L.defn.horiz){var H="hi"+I;L.slot=H;var N=this._hRow.insertCell(-1);N.vAlign="top";var K={};K[H]=N;this.addSlots(K);}else{if(this._horizOpen){this._horizOpen=false;}}this._super(L,I);},getLayoutMinWidth:function B(){var I=0,Q=0,J=this.children,P=J.length,N,M;for(N=0;N<P;N++){var O=J[N],L=O&&O.node,H=L&&L.data,K=H&&(String(H.bh)==="true"||String(H.bv)==="true");if(K){I=Math.max(I,Q);Q=0;}if(O.children){for(M in O.children){Q+=O.children[M].getWidth();}}else{Q+=10;break;}}return Math.max(I,Q);},resizeOrReposition:function E(){if(this._super){this._super();}F(this);},renderCtrlsInViewport:function D(){this._super();F(this);}});}());(function(){mstrmojo.requiresCls("mstrmojo.ui.PopupConfig","mstrmojo.ui.menus.MenuPopup");mstrmojo.ui.menus.PopupConfig=mstrmojo.declare(mstrmojo.ui.PopupConfig,null,{scriptClass:"mstrmojo.ui.menus.PopupConfig",cssClass:"",hasToggleItem:false,contents:null,clear:function A(){this._super();this.contents=null;},close:function C(){([].concat(this.contents)[0]).parent.closeAllMenus();},newInstance:function B(){return new mstrmojo.ui.menus.MenuPopup({popupConfig:this});}});}());(function(){mstrmojo.requiresCls("mstrmojo.ui.menus.MenuPopup","mstrmojo.Button","mstrmojo.dom","mstrmojo.ui._HasScroller");mstrmojo.requiresDescs(1442,2140);var D=mstrmojo.dom,E=mstrmojo.array;function G(L,N){var K=2140,P="Cancel",O="this.parent.popupConfig."+(L?"ok":"cancel"),M=N&&N[(L?"ok":"cancel")+"BtnText"];if(L){K=1442;P="Ok";}return mstrmojo.Button.newWebButton(M||mstrmojo.desc(K,P),function(R){var S=this.parent,Q=S.popupConfig;S.closeAllMenus();Q["fn"+P](Q.data,S);D.stopPropogation(R.hWin,R.e);},L,{slot:"btnNode",bindings:{enabled:O+"Enabled",visible:O+"Visible"},cssDisplay:"inline-block"});}mstrmojo.ui.menus.MenuEditor=mstrmojo.declare(mstrmojo.ui.menus.MenuPopup,[mstrmojo.ui._HasScroller],{scriptClass:"mstrmojo.ui.menus.MenuEditor",markupString:'<div id="{@id}" class="mstrmojo-ui-MenuEditor {@cssClass}" style="{@cssText}" mstrAttach:mouseover,mouseout,click><div class="scroll-container" style="{@scCssText}"><div class="me-content"></div><div class="me-buttons"></div><div class="me-bottom"></div></div></div>',markupSlots:{containerNode:function C(){return this.domNode.firstChild.firstChild;},btnNode:function H(){return this.domNode.firstChild.children[1];},bottomNode:function H(){return this.domNode.firstChild.children[2];},scrollNode:function(){return this.domNode.firstChild;},scrollbarHostNode:function(){return this.domNode;}},popupConfig:null,postBuildRendering:function A(K){this._super(K);if(this.popupConfig&&this.popupConfig.supportsScroll){var L=this;window.setTimeout(function(){L.updateScrollbars();},10);}},onmouseover:function J(L){var K=this.popupConfig;if(K&&!K.isHostedWithin&&this.opener){this.opener.raiseEvent(mstrmojo._HasMarkup.newDomEvent(L.name,L.hWin,L.e,{targetHostElement:K.hostElement}));}},updateScrollbars:function(){this._super();if(this.popupConfig&&this.popupConfig.supportsScroll){var L=this.scrollNode;if(!L){return ;}var K=D.getComputedScrollbarWidth(L);L.style.marginRight=-K+"px";L.style.paddingRight=0;}},monitorWindow:function F(){var L=document.activeElement,K=null;if(L!==null&&L.id!==""){K=this.domNode.querySelector("#"+L.id)?L:null;}this._super();if(K){K.focus();}},init:function I(M){this._super(M);var L=this.popupConfig,K=L.bottomNode;if(L&&L.supportsScroll&&L.maxHeight>0){if(L.cssClass.indexOf("RoleMenu")>-1){L.maxHeight=360;}this.cssText=(this.cssText||"")+";max-height:"+L.maxHeight+"px";this.scCssText=(this.scCssText||"")+";max-height:"+L.maxHeight+"px";}if(!!mstrApp.isWSStyling){this.themeClassName="mojo-theme-light";}this.data=L.data||{};if(L.onOpen){this.onOpen=L.onOpen;}this.addChildren([G(true,L),G(false)]);if(K){K.slot="bottomNode";this.addChildren(K);}},onOpen:function B(){E.forEach(this.children,function(K){if(K.scriptClass==="mstrmojo.ui.ScrollableContainer"&&K.onOpen){K.onOpen();}});}});}());(function(){mstrmojo.requiresCls("mstrmojo.ui.LayoutBox","mstrmojo._HasBuilder");mstrmojo.ui.BuilderBox=mstrmojo.declare(mstrmojo.ui.LayoutBox,[mstrmojo._HasBuilder],{scriptClass:"mstrmojo.ui.BuilderBox"});}());(function(){mstrmojo.requiresCls("mstrmojo.array","mstrmojo.Container","mstrmojo._HasLayout","mstrmojo.ui._HasScroller","mstrmojo.vi.ui.PanelContents");mstrmojo.vi.ui.BoxPanel=mstrmojo.declare(mstrmojo.Container,[mstrmojo._HasLayout,mstrmojo.ui._HasScroller],{scriptClass:"mstrmojo.vi.ui.BoxPanel",markupString:'<div id="{@id}" class="mstrmojo-VIBoxPanel {@cssClass}" style="{@cssText}"><div class="mstrmojo-VIBoxPanel-control"></div><div class="mstrmojo-VIBoxPanel-content"></div><div class="mstrmojo-VIBoxPanel-mask"></div></div>',markupSlots:{controlNode:function(){return this.domNode.firstChild;},containerNode:function(){return this.domNode.childNodes[1];},maskNode:function(){return this.domNode.lastChild;}},markupMethods:{onvisibleChange:mstrmojo.Widget.visibleMarkupMethod},layoutConfig:{h:{controlNode:"auto",containerNode:"100%"},w:{controlNode:"100%",containerNode:"100%"},xt:true},controlNode:null,containerNode:null,maskNode:null,parent:null,slot:"containerNode",children:[{scriptClass:"mstrmojo.vi.ui.PanelContents",slot:"containerNode",alias:"contents"}],_set_children:function E(N,L,K){var M=this.children;if(L!==M&&M){L=L.concat(M.filter(function(O){return O.slot==="controlNode";}));}return this._super(N,L,K);},doLayout:function A(){if(!this.visible){return ;}this._super();},addPopupHandlers:function B(K,M,L){K.addPopupHandlers(this.id,M,L);},setOpenStatus:function I(L,K,N,M){if(!L){this.parent.removePanel(this,N,K,M);mstrApp.rootCtrl.generateToolbar();}},updateToolbar:function J(K){K.hostId=this.id;K.isHostedWithin=false;return K;},addRenameTargetMenuItem:function C(K){K.addMenuItem(mstrmojo.desc(1388,"Rename"),"rnm",function(){this.toolbar.lblTitle.set("isEditing",true);}.bind(this));},addHelpTopicMenuItem:function G(K,M,L){if(L){K.addMenuItem(M,"help",function(){mstrApp.showHelpTopic(L);});}},addCloseMenuItem:function F(K,L){K.addMenuItem(mstrmojo.desc(2177,"Close"),"",function(){var M=L.getDataService().newUpdateWithoutCmd();this.setOpenStatus(false,false,M);M.submit();}.bind(this));},getOpenStatus:function H(){return true;},setupScrollNodes:function D(){this.scrollNode=this.containerNode;}});mstrmojo.vi.ui.BoxPanel.PANEL_TYPES={DROP_ZONES:"vi_drz",PROPS:"vi_prp",FILTERS:"vi_flt"};}());(function(){mstrmojo.requiresCls("mstrmojo.dom","mstrmojo.hash","mstrmojo.Box","mstrmojo.array","mstrmojo._HasLayout","mstrmojo.ui.ColumnContainer");var E=mstrmojo.dom,G=mstrmojo.hash,C=mstrmojo.array;mstrmojo.ui.ColumnWalk=mstrmojo.declare(mstrmojo.Box,[mstrmojo._HasLayout],{scriptClass:"mstrmojo.ui.ColumnWalk",markupString:'<div id="{@id}" class="mstrmojo-ui-ColumnWalk cf {@cssClass}" mstrAttach:click></div>',layoutConfig:{h:{containerNode:"100%"},xt:true},currentColumn:-1,addNextColumn:function B(K){var J=this.children||[],L=J.length,I=J[L-1];var M=this.addChildren([G.copy(K,{scriptClass:"mstrmojo.ui.ColumnContainer",idx:L})])[0];if(I){I.set("next",M);}},onclick:function A(I){var K=I.getTarget();if(K){var J=this.children;C.forEach(J,function(M,L){if(E.contains(M.domNode,K,true,M.domNode)){this.set("currentColumn",L);}},this);}},oncurrentColumnChange:function D(I){var K=this.children,M=K[I.valueWas],J=K[this.currentColumn],L="active";if(M){M.set(L,false);}J.set(L,true);},removeTrailingContainer:function H(K){var J=this,I=this.children;if(!I||K>=I.length-1){return ;}C.forEach(I.slice(K+1),function(L){J.removeAndDestroyChild(L);});if(K>=0){I[K].set("next",null);}},insertAndRemoveTrailing:function F(J,I){this.removeTrailingContainer(J);this.addNextColumn(I);}});}());(function(){mstrmojo.requiresCls("mstrmojo.TableLayoutList","mstrmojo.array");var A=mstrmojo.array;mstrmojo._IsTableLayoutListDIC=mstrmojo.provide("mstrmojo._IsTableLayoutListDIC",{_mixinName:"mstrmojo._IsTableLayoutListDIC",icnCss:"dicContainer",tableLayoutCssStyle:"fixed",setDirtyFlag:function(E,D){if(E.className!=="flag-container"){var C=document.createElement("div"),B=this.itemsNode&&this.itemsNode.clientWidth-8;C.className="flag-container";C.style.left=(B>0?B:0)+"px";C.innerHTML='<div class="dirty-cell"/>';D.insertBefore(C,E);}},zoomStyle:function(E,D,C,B){if(E!==1){A.forEach(D,function(H){H.style="";var J=window.getComputedStyle(H,null),I=J.getPropertyValue("width"),G=J.getPropertyValue("height"),F=J.getPropertyValue("background-position-x"),K=J.getPropertyValue("background-position-y");if(I&&G&&F&&K){H.style="width:"+parseFloat(I)*E+"px;height:"+parseFloat(G)*E+"px;background-position-x:"+parseFloat(F)*E+"px;background-position-y:"+parseFloat(K)*E+"px;background-size:"+C*E+"px "+B*E+"px;";}});}},zoomBackground:function(C,B){if(C!==1){A.forEach(B,function(E){E.style.backgroundPositionX="";E.style.backgroundPositionY="";var F=window.getComputedStyle(E,null),D=F.getPropertyValue("background-position-x"),G=F.getPropertyValue("background-position-y");if(D&&G){E.style.backgroundPositionX=parseFloat(D)*C+"px";E.style.backgroundPositionY=parseFloat(G)*C+"px";}});}}});}());(function(){mstrmojo.requiresCls("mstrmojo.alert","mstrmojo.css","mstrmojo.desc","mstrmojo.dom","mstrmojo.Label","mstrmojo.ui.editors.ToolbarPopup","mstrmojo.vi.models.EnumFieldTypes");var E=mstrmojo.dom,F=null;function D(I){var H=1;if(I.tstp===769){H=2;}else{if(I.tstp===774){H=3;}}return H;}function B(L){var H=mstrApp.name,K=H+"?",I=-1,J=function(N,M){K+=N+"="+M+"&";};if(!!L){switch(L.ttp){case 3:J("evt","4001");J("reportID",L.tid);I=D(L);if(I!==-1){J("reportViewMode",I);}break;case 55:if(L.tstp===14080){J("evt","32001");J("documentID",L.tid);}else{if(L.tvmd&(8192|2048)&&!((L.tvmd&2048&&mstrApp.features["run-vi-flash"]))){J("evt","3140");J("documentID",L.tid);if(E.isIE6||E.isIE7||E.isIE8){mstrmojo.alert(mstrmojo.desc(15474,"To work with HTML5 dossiers, please turn off your browser Compatibility View or update your browser to one of the following browser versions: Chrome, Firefox, Safari, Internet Explorer 9 or above."));return null;}}else{J("evt","2048001");J("objectID",L.tid);J("visMode","0");}}break;}}return K;}mstrmojo._HasDocLink=mstrmojo.provide("mstrmojo._HasDocLink",{_mixinName:"mstrmojo._HasDocLink",url:"",target:"",linkEnabled:true,ifw:"",update:function G(H){var I=H.defn;this.url=H.data.url||I.url;if(I.target){this.target=I.target;}if(I.ifw){this.ifw=I.ifw;}this._super(H);},postBuildRendering:function A(){if(this.url||this.ifw){mstrmojo.css.addClass(this.domNode,"hasLink");}var I=this.controller&&this.controller.view,H=I&&I.getCurrentLayout&&I.getCurrentLayout();if(H&&H.addLinkInfo){H.addLinkInfo(this.id,{url:this.url,target:this.target,src:this});}return this._super();},setLinkEnabled:function C(L){this.linkEnabled=L;var K=this.domNode;if(!K){return ;}var M=K.childNodes,J=M[M.length-1],H=this.id+"_mask",I=(J.id===H)?J:null;if(L){if(I){K.removeChild(I);delete this._mask;}}else{if(!I){I=document.createElement("div");I.className="mstrmojo-DocLinkMask";I.id=H;I.innerHTML="&nbsp;";K.appendChild(I);}}},cancelDocLink:false,onclick:function(I){if(F===null){var J=this,H=function(){if(J.linkEnabled&&!J.isEditing){var S=J.drillLinkItems,R=S&&S[0],K=J.url||(R&&R.url),M=J.node&&J.node.data,L=M&&M.navpage,Q=J.model,O=mstrmojo.desc(15704,'Go to "#"'),P;if(J.ifw){Q.showInfoWin(J.ifw,(J.getAnchor&&J.getAnchor())||J.domNode,"v",true);}else{if(K){O=O.replace("#",K);P=function(){Q.executeLink(K,J.target,J);};}else{if(M&&M.tid&&!mstrApp.isSingleTier){K=B(M);if(!!K){O=O.replace("#",M.tnm);P=function(){Q.executeLink(K,J.target,J);};}}else{if(L){O=O.replace("#",M.navpagenm);P=function(){Q.raiseEvent({name:"layoutSelected",panelKey:L,layoutKey:Q.getLayoutKeyByUnitKey(L)});};}}}}if(P){if(!mstrApp.isVI||mstrApp.isAppStatePresentation()){P();return ;}var U=J.parent,N=J._menu,V=function(W){if(W===mstrmojo.vi.models.EnumFieldTypes.IMAGE){return mstrmojo.desc(10502,"Edit image");}return mstrmojo.desc(16163,"Edit text");};if(!N){N=J._menu=new mstrmojo.ui.editors.ToolbarPopup({anchorElement:U,autoCloses:true,cssClass:"link-action-cfg",children:[{scriptClass:"mstrmojo.Label",alias:"nav",cssClass:"link nav",cssDisplay:"inline",text:O,onclick:function(){P();this.parent.close();}},{scriptClass:"mstrmojo.Label",cssClass:"separator",cssDisplay:"inline-block",text:"|"},{scriptClass:"mstrmojo.Label",alias:"edit",cssClass:"link",cssDisplay:"inline-block",popupHost:U,text:V(U.hostType),onpopupHostChange:function(){this.set("text",V(this.popupHost.hostType));},onclick:function(){this.parent.close();this.popupHost.switchToEditMode();}}]});}else{N.nav.set("text",O);N.nav.set("onclick",function(){P();this.parent.close();});N.edit.set("popupHost",U);}N.popupConfig.position=E.getMousePosition(I.e,I.hWin);U.openPopup(N);}}};F=window.setTimeout(function(){if(!J.cancelDocLink){H();}J.cancelDocLink=false;F=null;},200);}},hasActiveLink:function(){if(this.linkEnabled){var K=this.drillLinkItems,H=K&&K[0],J=this.url||(H&&H.url),I=this.node&&this.node.data;if(I){if(I.tid&&!mstrApp.isSingleTier){return true;}if(I.navpage){return true;}}if(J){return true;}}return false;}});}());(function(){mstrmojo.requiresCls("mstrmojo.vi.ui.rw.VisFilterIndicator");mstrmojo.vi.ui.rw._HasVisFilterIndicator=mstrmojo.provide("mstrmojo.vi.ui.rw._HasVisFilterIndicator",{displayVisFilterIndicator:function B(){if(mstrApp.isInVFConfigMode){var D=this.parent,E=D&&D.isIndicatorDisplayed,C;if(E){return ;}C=new mstrmojo.vi.ui.rw.VisFilterIndicator({unitContainer:this});C.render();this.indicator=C;D.isIndicatorDisplayed=true;}},updateVisFilterIndicator:function A(){var C=this.indicator;if(mstrApp.isInVFConfigMode&&C){C.updateDimension();}}});}());(function(){mstrmojo.requiresCls("mstrmojo.MobileDocLayoutViewer");var B=mstrmojo.DynamicClassFactory.newComponent;mstrmojo.maps.MobileMapInfoWindowLayoutViewer=mstrmojo.declare(mstrmojo.MobileDocLayoutViewer,null,{scriptClass:"mstrmojo.maps.MobileMapInfoWindowLayoutViewer",preBuildRendering:function A(){this.setDimensions(this.height,this.width);this.set("visible",true);return this._super?this._super():true;}});mstrmojo.maps.MapInfoWindowLayoutViewer=mstrmojo.declare(mstrmojo.MobileDocLayoutViewer,null,{scriptClass:"mstrmojo.maps.MapInfoWindowLayoutViewer",preBuildRendering:function A(){this.set("visible",true);return this._super?this._super():true;}});}());(function(){mstrmojo.requiresCls("mstrmojo.TextArea","mstrmojo.ui._HasScroller");function E(){var L=this.inputNode,F=L.style,J=this.scrollNode,G=J.scrollTop,M=parseInt(F.height),N=L.scrollHeight,I=M<N,H=M>J.clientHeight;if(I){F.height=N+"px";}else{if(H){var K=M;while(K>0&&L.offsetHeight===L.scrollHeight){F.height=--K+"px";}F.height=K+1+"px";}}if(I||H){this.updateScrollbars();}if(I){J.scrollTop=G+(N-M);}}mstrmojo.ui.ScrollableTextArea=mstrmojo.declare(mstrmojo.TextArea,[mstrmojo.ui._HasScroller],{scriptClass:"mstrmojo.ui.ScrollableTextArea",markupSlots:{scrollNode:function(){return this.domNode.firstChild;},inputNode:function(){return this.domNode.firstChild.firstChild;}},cssDisplay:"block",init:function D(F){this.markupString='<div class="mstrmojo-ui-TextArea {@cssClass}"><div class="ta-sc">'+this.markupString+"</div></div>";this._super(F);},postBuildRendering:function A(){this._super();var G=this.inputNode,F=G.style;F.height=G.scrollHeight+"px";},onRender:function C(){this._super();E.call(this);},prevalueChange:function B(){if(!this.hasRendered){return ;}E.call(this);}});})();(function(){mstrmojo.requiresCls("mstrmojo.TextArea","mstrmojo.Button","mstrmojo.Label","mstrmojo.Box","mstrmojo.fx","mstrmojo.css","mstrmojo.DropDownButton");var D=1,K=2,B=null,A=null,E=mstrmojo.dom,F=mstrmojo.css;var C=400;function G(V,Q,M,N,U,L,P,S){var R={duration:C,target:Q,onEnd:function(){if(L){L();}},props:{}};R.props[M]={ease:P||mstrmojo.ease.sin,start:parseInt(N,10),stop:parseInt(U,10),suffix:"px"};R=mstrmojo.hash.copy(S,R);var O=new mstrmojo.fx.AnimateProp(R);O.play();return O;}mstrmojo.ElasticTextArea=mstrmojo.declare(mstrmojo.Container,null,{scriptClass:"mstrmojo.ElasticTextArea",markupString:'<div id="{@id}" class="mstrmojo-ElasticTextArea {@cssClass}" style="{@cssText}" mstrAttach:blur ><div class="mstrmojo-ElasticTextAreaContent " style="height: 100%;"></div></div>',markupSlots:{containerNode:function(){return this.domNode.firstChild;}},markupMethods:{onvalueChange:function(){if(this.textNode&&this.value!==this.textNode.textArea.value){this.textNode.textArea.set("value",this.value);this.adjustStatusBar();}},onvisibleChange:function(){this.domNode.style.display=this.visible?"inline":"none";},onwidthChange:function(){if(this.domNode&&this.width){this.domNode.style.width=this.width+"px";}},ontopChange:function(){if(this.domNode&&this.top){this.domNode.style.top=this.top+"px";}},onleftChange:function(){if(this.domNode&&this.left){this.domNode.style.left=this.left+"px";}}},width:200,resize:"none",maxLength:256,value:"",enabled:true,minTextNodeHeight:15,postCreate:function(){var M=this,L=this.minTextNodeHeight;this.children=[{scriptClass:"mstrmojo.Box",alias:"textNode",cssText:"width:100%;",height:L+"px",onheightChange:function(O){var P=Math.max(L,parseInt(O.valueWas,10)||0),N=Math.max(L,parseInt(O.value,10));if(P!==N){if(E.isIE7){this.textArea.domNode.style.height=this.domNode.style.height=N+"px";}else{if(this._slidingFx&&this._slidingFx.isPlaying){this._slidingFx.props.height.stop=N;}else{this._slidingFx=G(true,this.domNode,"height",P,N);}}}},children:[{scriptClass:"mstrmojo.TextArea",alias:"textArea",cssClass:"eta-text",cssText:"width:100%;height:100%;line-height:inherit;box-sizing:content-box;",rows:1,bindings:{maxLength:"this.parent.parent.maxLength",enabled:"!!this.parent.parent.enabled"},onblur:function(N){if(M.onblur){M.onblur(N);}},onkeyup:function(P){var Q=this.maxLength,N=this.value.length;if(Q<N){if(E.isIE7||E.isIE8||E.isIE9){this.value=this.domNode.value=this.value.substr(0,Math.min(N,Q));}}var O=this.parent.parent;O.set("value",this.value);O.adjustStatusBar();}},{scriptClass:"mstrmojo.Label",cssClass:"eta-text ghost",alias:"ghost",cssText:"visibility: hidden; z-index:-1; position:absolute;left:0; top:0; text-align:"+(E.isIE?"left":"start")+"; word-wrap:break-word; border:1px solid red; none; margin:0; padding:2; width:100%;",bindings:{text:"this.parent.parent.value"},_setHeight:function(O){var N=Math.max(parseInt(O,10)||0,this.domNode.clientHeight);this.parent.set("height",N);},postCreate:function(){this.markupMethods=mstrmojo.hash.copy(this.markupMethods);this.markupMethods.ontextChange=function(N){if(this.domNode&&this.text){this.domNode.innerHTML=this.text.replace(/<br \/>&nbsp;/,"<br />").replace(/<|>/g," ").replace(/&/g,"&amp;").replace(/\n/g,"<br />&nbsp;");}else{if(this.domNode){this.domNode.innerHTML="&nbsp;";}}this._setHeight();};},postBuildRendering:function(N){if(this._super){this._super(N);}this._setHeight(this.parent.parent.height);}}]},{scriptClass:"mstrmojo.Label",alias:"statusBar",cssClass:"eta-bar",text:""},{scriptClass:"mstrmojo.Label",alias:"msgBoxTip",cssClass:"eta-tip",cssText:E.isIE8?"bottom: -4px;":""}];},postBuildRendering:function I(){if(this._super){this._super();}this.textNode.textArea.set("value",this.value);this.adjustStatusBar();},onmaxLengthChange:function(L){if(L.value){this.adjustStatusBar();}},onfontChange:function(L){var O=this.textNode.textArea,N=this.textNode.ghost,M;for(M in this.font){this.domNode.style[M]=this.font[M];if(E.isIE7){O.domNode.style[M]=this.font[M];N.domNode.style[M]=this.font[M];this.statusBar.domNode.style[M]=this.font[M];}}if(E.isIE9){O.refresh();}N._setHeight();},adjustStatusBar:function(){if(!this.msgBoxTip.domNode){return ;}var O=this,R=this.maxLength,S=this.textNode.textArea,Q=(S.value&&S.value.length)||0,P=Q/R,M=this.statusBar,L=this.msgBoxTip;var N=P*this.width;L.domNode.style.left=Math.min(Math.ceil(N-L.domNode.offsetWidth/2),this.width-3)+"px";M.set("text",mstrmojo.desc(4891,Q+" of "+R).replace("##",Q).replace("###",R));},focus:function(){E.setCaret(this.textNode.textArea.domNode,((this.value&&this.value.length)||0));}});mstrmojo.ElasticTextAreaButton=mstrmojo.declare(mstrmojo.DropDownButton,null,{scriptClass:"mstrmojo.ElasticTextAreaButton",cssClass:"mstrmojo-ElasticTextAreaButton",popupToBody:false,popupWidth:200,maxLength:256,enabled:true,lockAutoClose:mstrmojo.emptyFn,unlockAutoClose:mstrmojo.emptyFn,unrender:function H(L){var M=this.popupRef;if(this.popupToBody&&M.hasRendered){M.unrender(false);}if(this._super){this._super(L);}},postBuildRendering:function I(){if(this._super){this._super();}if(this.value&&this.value.length>0){F.addClass(this.domNode,"filled");}},premousedown:function J(M){if(this.popupToBody){var P=E.position(this.popupNode,true),O=this.popupRef,L={left:Math.round(P.x)+"px",top:Math.round(P.y)+"px"};if(!O.hasRendered){delete O.slot;L.placeholder=document.body.appendChild(document.createElement("div"));}this.popupOpenConfig=this.popupOpenConfig||{};mstrmojo.hash.copy(L,this.popupOpenConfig);}else{this.popupRef.slot="popupNode";}if(this.popupRef.eta){this.popupRef.eta.set("value",this.value);}else{this.popupRef.children[0].value=this.value;}if(this._super){this._super();}var N=this.popupRef.domNode;if(N){N.style.minWidth=(this.domNode.offsetWidth-2)+"px";}},openPopup:function(M,L){this._super(M,L);this.lockAutoClose();},popupRef:{scriptClass:"mstrmojo.Popup",slot:"popupNode",cssClass:"mstrmojo-ElasticTextAreaPopup",shadowNodeCssClass:"mstrmojo-ElasticTextAreaPopup-shadow",contentNodeCssClass:"mstrmojo-ElasticTextAreaPopup-content",autoCloses:false,locksHover:true,visible:true,onOpen:function(){var M=this.eta,N=M.domNode.firstChild,O=0,L;this.eta.set("font",this.opener.font);N.parentNode.style.display="block";F.addClass(this.opener.domNode,"editing");N.parentNode.style.overflow="hidden";L=this._h||(N.offsetHeight);G(false,N,"height",O,L,function(){N.style.height="100%";N.parentNode.style.overflow="visible";M.focus();});},onClose:function(){this.visible=false;var N=this.eta.domNode,M=N.firstChild,O=M.offsetHeight,L=0;this.opener.unlockAutoClose();this._h=O;this.opener.set("value",this.eta.value);F.removeClass(this.opener.domNode,"editing");M.style.height=M.offsetHeight+"px";N.style.overflow="hidden";G(false,M,"height",O,L,function(){N.style.display="none";});},children:[{scriptClass:"mstrmojo.ElasticTextArea",alias:"eta",bindings:{width:function(){return this.parent.opener.popupWidth;},maxLength:function(){return this.parent.opener.maxLength;},enabled:function(){return this.parent.opener.enabled;}}}]}});}());(function(){mstrmojo.requiresCls("mstrmojo.vi.ui.rw.ImageBoxOverlay");mstrmojo.vi.ui.rw.ImageBoxOverlayURL=mstrmojo.declare(mstrmojo.vi.ui.rw.ImageBoxOverlay,[],{scriptClass:"mstrmojo.vi.ui.rw.ImageBoxOverlayURL",markupString:'<div id="{@id}" class="mstrmojo-ImageBoxOverlayURL cf {@cssClass}" style="{@domNodeCssText}"><div class="container-scroll-host"><div class="container"><div class="lbl"></div><div class="txt"></div><div class="btn"></div></div></div></div>',markupSlots:{containerNode:function(){return this.domNode.firstChild;},labelNode:function(){return this.domNode.firstChild.firstChild.firstChild;},textNode:function(){return this.domNode.firstChild.firstChild.children[1];},buttonNode:function(){return this.domNode.firstChild.firstChild.lastChild;}}});}());(function(){mstrmojo.requiresCls("mstrmojo.vi.ui.rw.selectors._HasWarningMessage","mstrmojo.dom","mstrmojo.hash","mstrmojo.imageUtils");mstrmojo.requiresDescs(1212);var C=mstrmojo.vi.ui.rw.selectors.EnumWarningPosition,F=mstrmojo.dom,H=mstrmojo.imageUtils,G=mstrmojo.hash,E=1<<20,A=3,D=10*E;var B={SUCCESS:0,OVER_SIZE:1,INVALID_FILE_TYPE:2,OVER_SIZE_NO_COMPRESSION:3};mstrmojo.vi.ui.rw._ValidInputLocalImage=mstrmojo.provide("mstrmojo.vi.ui.rw._ValidInputLocalImage",{_mixinName:"mstrmojo.vi.ui.rw._ValidInputLocalImage",imageBox:undefined,validationStatus:undefined,fileSizeAfterCompressedInMB:undefined,VALID_MIME_TYPES:["image/png","image/jpeg","image/bmp","image/gif"],validationFailed:function(){mstrApp.hideWait();},validationSuccess:function(I){mstrApp.hideWait();if(this.imageBox){this.imageBox.localImageAdded(I);}},getValidationObj:function(){var J=this.validationStatus,I={},K={refNode:this.domNode,invalid:true,position:C.BOTTOM,closeOnClick:true,lasting:12000,highlight:false};I[B.OVER_SIZE]={errorCode:"imageSizeExceedLimitVIWarning",args:[A,this.fileSizeAfterCompressedInMB||A]};I[B.OVER_SIZE_NO_COMPRESSION]={errorCode:"imageOverSizeNoCompessionVIWarning",args:[A]};I[B.INVALID_FILE_TYPE]={errorCode:"imageFileTypeNotSupportedVIWarning",args:[]};return I[J]?G.copy(K,I[J]):undefined;},fileSelected:function(K){var M=this;var N=new Image(),I=new FileReader();var L=(mstrApp.isSingleTier&&K.fileBlob)?K.fileBlob:K;N.mime_type=L.type;var J={file:L,imageName:K.name};if(this.VALID_MIME_TYPES.indexOf(N.mime_type)===-1){M.validationStatus=B.INVALID_FILE_TYPE;M.validationFailed();return ;}mstrApp.showWait({message:mstrmojo.desc(1212,"Processing...")});if(L.size>=D){M.validationStatus=B.OVER_SIZE_NO_COMPRESSION;M.validationFailed();return ;}I.onload=function(O){N.src=O.target.result;N.onload=function(){var P=A*E,R=J.file.size;if(R<P){J.base64Str=N.src;J.imageData=H.dataURLToBlob(N.src);J.imageSize=J.imageData.size;}else{if(N.mime_type==="image/gif"){M.validationStatus=B.OVER_SIZE_NO_COMPRESSION;M.validationFailed();return ;}else{var S=75;if(N.naturalWidth>=1920&&N.naturalHeight>=1080){S=45;}var V="jpg";if(N.mime_type==="image/png"){V="png";}var U=H.compress(N,S,V);J.base64Str=U.src;J.imageData=H.dataURLToBlob(U.src);J.imageSize=J.imageData.size;}}var Q=J.imageSize;M.fileSizeAfterCompressedInMB=Math.min(Q,J.file.size)/E;M.fileSizeAfterCompressedInMB=M.fileSizeAfterCompressedInMB.toFixed(1);if(Q>P){M.validationStatus=Q>=R?B.OVER_SIZE_NO_COMPRESSION:B.OVER_SIZE;M.validationFailed();return ;}M.validationSuccess(J);};N.onerror=function(){M.validationStatus=B.INVALID_FILE_TYPE;M.validationFailed();};};I.onerror=function(){M.validationStatus=B.INVALID_FILE_TYPE;M.validationFailed();};I.readAsDataURL(L);}});}());(function(){mstrmojo.requiresCls("mstrmojo.TextBox","mstrmojo._CanValidate","mstrmojo.css","mstrmojo.validation","mstrmojo.vi.ui.rw.selectors._HasWarningMessage");var H=mstrmojo.css,E=mstrmojo.validation,G=E.TRIGGER,J=E.STATUSCODE;function F(L){if((this.constraints.trigger&L)>0){this.validate();}}mstrmojo.ValidationTextBox=mstrmojo.declare(mstrmojo.TextBox,[mstrmojo._CanValidate,mstrmojo.vi.ui.rw.selectors._HasWarningMessage],{scriptClass:"mstrmojo.ValidationTextBox",validationDelay:500,getInvalidMsg:function K(L){return(L&&L.msg?L.msg:"");},postBuildRendering:function A(){this._super();this._original_tooltip=this.inputNode.title;},prekeyup:function I(L){this._super(L);var P=(this.constraints.trigger&G.ONKEYUP)>0;if(P){var M=this.validationDelay;if(M){this.clearValDelayTimer();var O=this._validateHandler;if(!O){var N=this;this._validateHandler=O=function(){N.validate();if(N._valDelayTimer){window.clearTimeout(N._valDelayTimer);delete N._valDelayTimer;}};}this._valDelayTimer=window.setTimeout(O,M);}else{this.validate();}}},preinput:function D(L){this._super(L);F.call(this,G.ONKEYUP);},preblur:function B(L){this._super(L);F.call(this,G.ONBLUR);},clearValidation:function C(){this._super();var L=this.inputNode;H.removeClass(L,this.constraints.invalidCssClass||"mstrmojo-TextBox-ErrValidation");L.title=this._original_tooltip;},clearValDelayTimer:function(){var L=this._valDelayTimer;if(L){window.clearTimeout(L);}}});mstrmojo._HasMarkup.addMarkupMethods(mstrmojo.ValidationTextBox,{onvalidationStatusChange:function(){var P=this.validationStatus;if(!P){return ;}var N=this.inputNode,L=(P.code>J.VALID),M=this.constraints.invalidCssClass;H.toggleClass(N,M||"mstrmojo-TextBox-ErrValidation",L);var O=L?this.getInvalidMsg(P):this._original_tooltip;if(!this.useRichTooltip&&O!==undefined&&O!==null){N.setAttribute("title",O);}}});}());(function(){mstrmojo.requiresCls("mstrmojo.ListBase","mstrmojo._IsList","mstrmojo._CanAutoClose","mstrmojo._IsPopup","mstrmojo.ui.menus._HasMenuPopup","mstrmojo.ui.menus._IsMenuPopup","mstrmojo.ui.PopupConfig","mstrmojo.ui._HasScroller","mstrmojo.ui._HasUITheme","mstrmojo.dom","mstrmojo.css","mstrmojo.ui._HasListTooltip");var E=mstrmojo.dom,H=mstrmojo.css,F=mstrmojo.ui.PopupConfig.directionCfg;var C={};var B=false;function O(W,X){if(W.pop){if(X&&W.ax){window.clearTimeout(this._popupAxTimeout);W.actionFn();this.closeAllMenus();}else{var U=W.fn.call(mstrmojo.all[W.scope],W.ctxt);var V=U.ENUM_CORNERS,S=U.maxHeight,R=E.getMaxScrollHeight();U.setAlignment(V.TOP_RIGHT,V.TOP_LEFT);U.hostId=this.id;U.hostElement=this._getItemNode(W._renderIdx);U.includeScroll=this.includeScroll;U.supportsScroll=true;U.alignWithAnchor=true;U.isHostedWithin=false;U.maxHeight=S?Math.min(R,S):R;this.openPopup(U.newInstance());}}else{if(W.dsbld!==true){if(W.fn(W,this)!==false){this.closeAllMenus();}}}}mstrmojo.ui.menus.Menu=mstrmojo.declare(mstrmojo.ListBase,[mstrmojo._IsList,mstrmojo.ui.menus._HasMenuPopup,mstrmojo._IsPopup,mstrmojo.ui.menus._IsMenuPopup,mstrmojo._CanAutoClose,mstrmojo.ui._HasListTooltip,mstrmojo.ui._HasScroller,mstrmojo.ui._HasUITheme],{scriptClass:"mstrmojo.ui.menus.Menu",selectionPolicy:"reselect",locksHover:true,closeOnClick:true,themeClassName:"mojo-theme-dark",icnCss:"mstrmojo-ui-Menu-item-container",popupConfig:null,tooltipCss:{leftCssClass:"menuTooltip",rightCssClass:"menuTooltip"},setupScrollNodes:function(){if(this.popupConfig&&this.popupConfig.supportsScroll){this.scrollNode=this.itemsContainerNode;this.scrollbarHostNode=this.domNode;}},updateScrollbars:function(){this._super();if(this.popupConfig&&this.popupConfig.supportsScroll&&this.hasCustomScrollbar){var S=this.scrollNode;if(!S){return ;}var R=E.getComputedScrollbarWidth(S);S.style.marginRight=-R+"px";S.style.paddingRight=0;}},onscroll:function(){this.closePopup();this._super();},init:function P(U){this._super(U);if(!!mstrApp.isWSStyling){this.themeClassName="mojo-theme-light";}if(U.themeClassName){this.themeClassName=U.themeClassName;}var R=this.popupConfig;this.items=R.getMenuItems();var S=["mstrmojo-ui-Menu","unselectable"],V=R.menuCssClass;if(V){S.push(V);}if(R.hasToggleItem){S.push("hasToggleItem");}H.addWidgetCssClass(this,S);if(R&&R.supportsScroll&&R.maxHeight>0){this.icnCssText=(this.icnCssText||"")+";max-height:"+R.maxHeight+"px";}this.useRichTooltip=!!R.useTooltip;this.tstid=R.tstid;},markupMethods:{onvisibleChange:function M(){var R=this.visible;if(!B||R){H.toggleClass(this.domNode,"visible",R);}}},getItemMarkup:function L(X,S){if(X.getItemMarkup){return X.getItemMarkup.apply(this,[X,S]);}var V=!!X.pop,W=V?"submenu":"item",U=C[W],R='<div class="micn"></div>';if(!U){R+=!!mstrApp.isWSStyling?'<div class="mtxt">{@en@n}</div>':"{@en@n}";if(V){R+='<div class="arw"></div>';}U=this._super(X,S).replace("{@en@n}",R);C[W]=U;}if(X.tstid){U=U.replace("{@tag}","{@tag} "+mstrmojo.tstid(X)+" ");}return U;},getItemProps:function J(U,R){var S=this._super(U,R);S.tag="a";S.addCls("mstrmojo-ui-Menu-item");S.addCls(U.cls);return S;},onmouseover:function Q(Y){var W=Y.config&&Y.config.targetHostElement?Y.config.targetHostElement:Y.getTarget(),a=this.getItemFromTarget(W),X=this,S=X._lastOpened,R=S&&this.getItemFromTarget(S.popupConfig.hostElement)._renderIdx,U=this.getItemNodeFromTarget(W),V=(R!==undefined&&E.contains(this._getItemNode(R),W,true,this.domNode));if(a){this._lastHoverIx=a._renderIdx;window.clearTimeout(this._popupTimeOut);window.clearTimeout(this._popupAxTimeout);if(this._lastHoverIx!==R&&!V){this._popupTimeOut=window.setTimeout(function(){if(X._lastOpened&&X._lastOpened.visible){X.closePopup();}if(X.visible&&a.pop){if(a.ax){X._popupAxTimeout=window.setTimeout(function(){H.removeClass(U,"hlt-ax");O.call(X,a);},0);}else{O.call(X,a);}}},400);if(a.pop&&a.ax){H.addClass(U,"hlt-ax");}}}var Z=this.popupConfig;if(Z&&!Z.isHostedWithin&&this.opener){this.opener.raiseEvent(mstrmojo._HasMarkup.newDomEvent(Y.name,Y.hWin,Y.e,{targetHostElement:Z.hostElement}));}},onclick:function N(R){this._evtTarget=R.getTarget();this._super(R);R.cancel();},postselectionChange:function D(R){var S=R.added;if(S){var U=this.items[S[0]];O.call(this,U,!(U.ax&&this._evtTarget.className==="arw"));delete this._evtTarget;}},oncontextmenu:function G(R){E.preventDefault(window,R.e);return false;},postBuildRendering:function A(R){this._super(R);if(this.popupConfig.supportsScroll){var S=this;window.setTimeout(function(){S.updateScrollbars();},10);}},showTooltip:function K(W,V){var U=E.eventTarget(V,W),S=this.getItemNodeFromTarget(U),R=this.getItemFromTarget(U);this.itemDisabled=R&&R.dsbld;if(S&&((R&&R.ttp)||(S.scrollWidth>S.clientWidth)||(U.scrollWidth>U.clientWidth))){this._super(W,V);}},onCloseMenuCallBack:null,onClose:function I(R){if(this._super){this._super(R);}this.closePopup();if(this.onCloseMenuCallBack){this.onCloseMenuCallBack();}}});}());(function(){mstrmojo.requiresCls("mstrmojo.Slider","mstrmojo.vi.ui.rw.selectors.SliderHelper","mstrmojo.dom","mstrmojo.hash","mstrmojo.css","mstrmojo.num");var F=mstrmojo.dom,G=mstrmojo.css,C=mstrmojo.hash,M=Math.max,H=Math.min;mstrmojo.vi.ui.rw.selectors.Slider=mstrmojo.declare(mstrmojo.Slider,null,{scriptClass:"mstrmojo.vi.ui.rw.selectors.Slider",markupString:'<div class="mstrmojo-VISlider mstrmojo-Slider {@cssClass} {@clsOrientation}" style="{@cssText}" ><div class="sl-title"></div><div class="sl-control"></div><div class="cont" style="position:relative"><div class="bk" style="{@bkCssText}"></div><div class="sdc" style="position:absolute;{@sdcCssText}"><div class="sd" style="{@sdCssText}" mstrAttach:click><div class="bk left" style="{@lowerRangeCssText}"></div><div class="t1" style="{@handle1CssText}" mstrAttach:mouseout></div><div class="bk middle" style="{@thumbCssText}"></div><div class="t3" style="{@handel2CssText}" mstrAttach:mouseout></div><div class="bk right" style="{@upperRangeCssText}"></div></div></div><div class="mstrmojo-Label subscript left">{@lowText}</div><div class="mstrmojo-Label subscript right">{@highText}</div></div></div>',markupSlots:{titleNode:function(){return this.domNode.firstChild;},controlNode:function(){return this.domNode.childNodes[1];},dndNode:function(){return this.domNode.childNodes[2];},bgNode:function(){return this.domNode.childNodes[2].firstChild;},sdcNode:function(){return this.domNode.childNodes[2].childNodes[1];},containerNode:function(){return this.domNode.childNodes[2].childNodes[1].firstChild;},lowerRange:function(){return this.domNode.childNodes[2].childNodes[1].firstChild.firstChild;},handle1Node:function(){return this.domNode.childNodes[2].childNodes[1].firstChild.childNodes[1];},thumbNode:function(){return this.domNode.childNodes[2].childNodes[1].firstChild.childNodes[2];},handle2Node:function(){return this.domNode.childNodes[2].childNodes[1].firstChild.childNodes[3];},upperRange:function(){return this.domNode.childNodes[2].childNodes[1].firstChild.lastChild;},lowNode:function(){return this.domNode.childNodes[2].childNodes[2];},highNode:function(){return this.domNode.childNodes[2].childNodes[3];},tooltipNode:function(){return[this.domNode.childNodes[2].childNodes[1].firstChild.childNodes[1],this.domNode.childNodes[2].childNodes[1].firstChild.childNodes[3]];}},markupMethods:{onvisibleChange:mstrmojo.Widget.visibleMarkupMethod,onlowTextChange:function(){this.lowNode.innerHTML=this.lowText||"";},onhighTextChange:function(){this.highNode.innerHTML=this.highText||"";},onwidthChange:function(){this.synchronizeSlider();},onmultiSelectChange:function(){G.toggleClass(this.domNode,"scm",this.multiSelect);G.toggleClass(this.domNode,"sc1",!this.multiSelect);}},thumbWidth:16,sliderDefaultWidth:95,multiSelect:true,init:function P(Q){this._super(Q);this.updateTypeHelper();},updateTypeHelper:function B(){var Q=C.walk("vi.ui.rw.selectors.SliderHelper",mstrmojo);this.typeHelper=new Q({slider:this});},synchronizeSlider:function E(){var S=this.orCfg,U=this.typeHelper,W=S.lenCssP,R=this.thumbWidth,V=parseInt(this[W],10),Q;V=(isNaN(V)||V<=0)?this.sliderDefaultWidth:V;Q=M(V-R,0);if(Q>0){var Y=M(V-(2*this.cssBkBW),0),X=Q;this.bkCssText=W+":"+Y+"px;";this.sdcCssText=S.posCssP+":0px;"+W+":"+X+"px;"+S.opPosCssP+":-1px;";if(this.hasRendered){this.bgNode.style[W]=Y+"px";this.sdcNode.style[W]=X+"px";}}this._effectiveLength=Q;U.initialSlider();U.updateThumb();U.updateSummary();},refresh:function(){this.updateTypeHelper();this._super();},createGhost:function K(){var S=this.containerNode.cloneNode(true),R=S.childNodes,Q;G.addClass(S,["gh"]);S.style.display="none";Q=this.ghost={containerNode:S,lowerRange:R[0],handle1Node:R[1],thumbNode:R[2],handle2Node:R[3],upperRange:R[4]};this.sdcNode.appendChild(S);return Q;},configureGhost:function D(U){var V=this.ghost;if(!V){V=this.createGhost();}var R=this.orCfg,Q=R.posCssP,S=R.lenCssP,W=this.id;mstrmojo.array.forEach(["lowerRange","containerNode","thumbNode","upperRange"],function(b,X){var a=mstrmojo.all[W],Z=a[b].style,Y=V[b].style;if(X){Y[Q]=Z[Q];}Y[S]=Z[S];});if(U){V.containerNode.style.display="block";}return V;},initDrag:function L(V,Q){Q=Q||window;var W=F.eventTarget(Q,this.dnd.startE);if(W===this.handle1Node||W===this.handle2Node){var U=this.configureGhost(true),R=this.orCfg,S=this.dnd;S.initD={handle1:parseFloat(this.handle1,10),handle2:parseFloat(this.handle2,10),length:this._effectiveLength,contL:U.containerNode[R.lenP],offset:F.getMousePosition(this.dnd.startE,Q)[R.offsetP]};S.initD.td=W;G.removeClass(this.domNode,["invalid"]);}},ondrag:function O(Y,X){if(this.enabled===false){return ;}var V=this.typeHelper;X=X||window;var a=this.dnd.initD;if(a){var f=this.ghost,g=a.handle1,U=a.handle2,W=this.cs1Idx,S=this.cs2Idx,R=a.length;var c=F.getMousePosition(Y,X)[this.orCfg.offsetP]-a.offset;switch(a.td){case this.handle1Node:g=M(H(M(a.handle1+c,0),R),-1);W=V.getIdxByPx(g);break;case this.handle2Node:U=M(H(M(a.handle2+c,0),R),-1);S=V.getIdxByPx(U);break;default:return ;}V.positionSliderElements(f,g,U);var Z=this.items,Q=(Z&&Z.length)||0;if(Q&&W>=0&&W<Q&&S>=0&&S<Q){var d=false,b;if(W!==this.cs1Idx){this.cs1Idx=W;b=this.items[W];this.cs1Vl=b.v;this.cs1Nm=b.n;d=true;}if(S!==this.cs2Idx){this.cs2Idx=S;b=this.items[S];this.cs2Vl=b.v;this.cs2Nm=b.n;d=true;}if(d){V.updateThumb();this._updateTooltip({target:a.td});}}}},ondrop:function I(R){this.typeHelper.updateThumb();var Q=this.ghost;if(Q){Q.containerNode.style.display="none";}this.hideTooltip(R,self);if(this.items&&this.items.length){this.onselectionChange();}this.dnd.initD=null;},onclick:function N(b){var U=b.getTarget();if(U===this.lowerRange||U===this.upperRange||U===this.thumbNode){var V=this.typeHelper,R=this.orCfg.offsetP,c=F.getMousePosition(b.e)[R],Z=c-F.position(this.handle1Node)[R],X=c-F.position(this.handle2Node)[R],Y=this.items,W,S,Q,a,d=false;if(Y.length<2){return ;}if(Math.abs(Z)<Math.abs(X)){Q=M(H(M(parseFloat(this.handle1,10)+Z,0),this._effectiveLength),-1);W=V.getIdxByPx(Q);if(this.cs1Idx!==W){this.cs1Idx=W;a=Y[W];this.cs1Vl=a.v;this.cs1Nm=a.n;d=true;}}else{Q=M(H(M(parseFloat(this.handle2,10)+X,0),this._effectiveLength),-1);S=V.getIdxByPx(Q);if(this.cs2Idx!==S){this.cs2Idx=S;a=Y[S];this.cs2Vl=a.v;this.cs2Nm=a.n;d=true;}}if(d){this.onselectionChange();V.updateThumb();}}},onselectionChange:function A(Q){var R=this.typeHelper;R.updateSelection();R.updateSummary();this._super(Q);if(this.dnd&&this.dnd.initD){this.dnd.initD=null;}},_updateTooltip:function J(V,U){var W=F.eventTarget(U,V);if(W){var R="<span {@ttpCssText}>{@content}</span>",Q=String((W===this.handle1Node)?this.cs1Nm:this.cs2Nm).replace("$","$$$$"),S={cssClass:"mstrmojo-VISlider vi-regular vi-tooltip-V "+mstrApp.getThemeClassName(),content:R.replace(/\{@content\}/g,Q),contentNodeCssClass:"scm-tooltip",refNode:W,posType:this._tooltip_pos};this.set("richTooltip",S);}}});}());(function(){mstrmojo.requiresCls("mstrmojo.Slider","mstrmojo.css","mstrmojo.hash");var D=mstrmojo.dom,C=mstrmojo.css,G=mstrmojo.hash,B=9,F="px";mstrmojo.AttributeSlider=mstrmojo.declare(mstrmojo.Slider,null,{scriptClass:"mstrmojo.AttributeSlider",thumbWidth:7,synchronizeSlider:function A(){if(this.isHoriz){var O=this.orCfg,N=O.lenCssP,J=this[N],H=parseInt(J,10),S=this.hasRendered;var K=this._effLen=isNaN(H)?0:(H-this._exRoom-(2*B));if(J){var R={};R[N]=Math.max(parseInt(J,10)-(2*this.cssBkBW),0)-(2*B)+F;var L={};L[N]=K+F;L[O.posCssP]=Math.round(this._exRoom/2)+B+F;L[O.opPosCssP]="0"+F;if(S){G.copy(R,this.bgNode.style);G.copy(L,this.sdcNode.style);}else{this.bkCssText=C.getCssTextFromObj(R);this.sdcCssText=C.getCssTextFromObj(L);}}var V=this.selectedIndices;if(!G.isEmpty(V)){var Q=this.items.length,M=-1,U=-1,P;for(P=0;P<Q;P++){if(V[P]){if(M<0){M=P;}U=P;}else{if(M>-1){break;}}}this.min=M;this.max=U;}var I=this.typeHelper;this.unit=I.getUnit();if(S){I.updateThumb();}else{I.preUpdateThumb();}}else{this._super();}},postBuildRendering:function E(){this._super();C.addClass(this.containerNode,["attslider"]);C.addClass(this.frontNode,["attslider"]);C.addClass(this.thumbNode,["attslider"]);C.addClass(this.endNode,["attslider"]);C.addClass(this.bgNode,["attslider"]);}});}());(function(){mstrmojo.requiresCls("mstrmojo.Container","mstrmojo.ToolBar","mstrmojo.boxmodel","mstrmojo.array","mstrmojo.EnumRWUnitType","mstrmojo.dom","mstrmojo.css");var Q=["background-color","border","border-color","border-left","border-style","border-top","border-width","filter","top","left","z-index","fx","normWidth","normHeight","normZIndex","normTop","normLeft","tbborder","lrborder","ttl"],Y=["width","height"],p="p_fmts";var m="px";var k={getContentHeight:function(t,v){var u=v.ttl&&v.ttl.height;if(t&&u&&!this.floatingToolbar){return Math.max(parseInt(t,10)-parseInt(u,10),0)+m;}return"";},getPortletMinHeight:function(t){return t.ttl.height;},adjustTitleCss:function(){return ;}};var g={getContentHeight:function(t){return t;},getPortletMinHeight:function(){return 0;},adjustTitleCss:function(t){t.titlebarNodeClass+=" floating";return ;}};function A(w,u){var v=this.parent,t=w+"DirtyKey";if(v[t]){v[t](u);}}function P(){this.toolbarTitleTextNode.innerHTML=this.title+(this.count?" ("+this.count+")":"");}function j(){var u=this.parent,w=u&&u.defn;if(w&&parseInt(w.t,10)===mstrmojo.EnumRWUnitType.PANEL){var t=u.parent,v=t.defn;if(v&&v.ifp){return t;}}return null;}var R=mstrmojo.hash,G=2;mstrmojo.DocPortlet=mstrmojo.declare(mstrmojo.Container,[mstrmojo._Formattable],{scriptClass:"mstrmojo.DocPortlet",floatingTitle:false,floatingTitleHeight:30,n:"",buttonWidth:17,markupString:'<div class="mstrmojo-portlet {@borderCss}" nm="{@n}" style="{@portletNodeCssText}"><div class="mstrmojo-portlet-slot-shadow" style="{@shadowNodeCssText}"></div><div class="mstrmojo-portlet-container" style="{@portletContainerNodeCssText}"><div class="mstrmojo-portlet-titlebar {@titlebarNodeClass}" style="{@titlebarNodeCssText}"><table style="height:100%;width:100%" class="mstrmojo-portlet-titlebar-table" cellspacing="0" cellpadding="0"><tr><td class="mstrmojo-portlet-slot-toolbar-left {@leftToolbarNodeClass}" style="{@leftToolbarNodeCssText}"></td><td class="mstrmojo-portlet-title" style="{@titleNodeCssText}"><div style="overflow: hidden;"></div></td><td class="mstrmojo-portlet-slot-toolbar {@toolbarNodeClass}" style="{@rightToolbarNodeCssText}"></td></tr></table></div><div class="mstrmojo-portlet-buttonbar {@buttonbarNodeClass}" style="{@buttonbarNodeCssText}"></div><div class="mstrmojo-portlet-slot-content" style="{@contentNodeCssText}"></div></div></div>',rightToolbarNodeCssText:"",leftToolbarNodeCssText:"",titleNodeCssText:"",titlebarNodeClass:"",titlebarNodeCssText:"",contentNodeCssText:"",borderCss:"no-border",buttonbarNodeClass:"",buttonbarNodeCssText:"",markupSlots:{containerNode:function(){return this.domNode.lastChild;},portletNode:function(){return this.domNode;},portletContainerNode:function(){return this.domNode.lastChild;},dimNode:function(){return this.domNode.lastChild;},shadowNode:function(){return this.domNode.firstChild;},titleNode:function(){return this.domNode.lastChild.childNodes[0];},buttonbarNode:function(){return this.domNode.lastChild.childNodes[1];},toolbarNode:function(){return this.domNode.lastChild.firstChild.childNodes[0].rows[0].cells[2];},toolbarTitleTextNode:function(){return this.domNode.lastChild.firstChild.childNodes[0].rows[0].cells[1].firstChild;},leftToolbarNode:function(){return this.domNode.lastChild.firstChild.childNodes[0].rows[0].cells[0];},contentNode:function(){return this.domNode.lastChild.lastChild;}},markupMethods:{ontitleChange:function(){P.call(this);},oncountChange:function(){P.call(this);},onfcChange:function(){if(this.fc&&this.content){this.updateContentHeight();}}},formatHandlers:{portletContainerNode:["RW","B","fx","background-color"],shadowNode:["RW","B","fx","background-color"],buttonbarNode:{src:"ttl",props:["background-color"]},titlebarNode:{src:"ttl",props:["F","B","background-color","height","fx","text-align","vertical-align"]},titleNode:{src:"ttl",props:["vertical-align","P","text-decoration"]}},updateServer:true,fc:false,content:null,rightToolbar:null,leftToolbar:null,floatingToolbar:false,_ts:k,getCacheKey:function F(){return this._super()+"-portlet";},getFormats:function M(){var u=this.content,t=u&&u.getFormats();return t&&t[p];},updateContentHeight:function e(x){var t=this.getFormats(),u=this.content,w=u.dimNode||u.domNode,v=((t.ttl&&parseInt(t.ttl.height,10))||0);if(w){if(!x){v+=((this.fc||this.isInFilterPanel())?w.offsetHeight:(t.height?parseInt(t.height,10):0));}this.containerNode.style.height=v+m;this.shadowNode.style.height=v+m;}},init:function q(t){this._super(t);var u=this.content;this.n=(t&&t.defn&&t.defn.n)||"";if(u&&u.getFormats()&&!this.getFormats()){this._createFormats();}},preBuildRendering:function B(){var u=this._ts=(this.floatingTitle)?g:k;if(this.isInFilterPanel()){var v=R.clone(this.formatHandlers);v.portletContainerNode=["z-index","height","B","backgroud-color"];v.shadowNode=["z-index","height","B","fx","background-color"];this.formatHandlers=v;}this._super();u.adjustTitleCss(this);var t="display:none;";if(!this.leftToolbar){this.leftToolbarNodeCssText+=t;}if(!this.toolbar){this.toolbarNodeCssText+=t;}var w=mstrmojo._Formattable.getBorderWidths(this);if(w.l||w.t||w.r){this.borderCss="has-border";}},postBuildRendering:function Z(){var w=mstrmojo.dom,AE=this.titleNode,AD=this.onclicktitle;if(this.floatingTitle&&this.titleNode){document.body.appendChild(this.titleNode);var x=mstrmojo.css,AA=this.contentNode,AB=this;if(!this._onhover){this._onhovertt=function(){x.addClass(AB.titleNode,["visible"]);AB._onflt=true;return true;};this._onhoverofftt=function(){x.removeClass(AB.titleNode,["visible"]);AB._onflt=false;return true;};this._onhover=function(){var AF=AB.titleNode;x.addClass(AF,["visible"]);var AG=w.position(AB.contentNode,true);AF.style.top=(AG.y-AF.clientHeight+2)+m;AF.style.left=AG.x+m;return true;};this._onhoveroff=function(){x.removeClass(AB.titleNode,["visible"]);return true;};}w.attachEvent(AA,"mouseover",this._onhover);w.attachEvent(AA,"mouseout",this._onhoveroff);w.attachEvent(AE,"mouseover",this._onhovertt);w.attachEvent(AE,"mouseout",this._onhoverofftt);}if(AE&&AD){w.attachEvent(AE,"click",AD);}if(this._super){this._super();}var z=this.getFormats();this.set("fc",z&&!z.height);if(this.isInFilterPanel()&&!this.isHorizFP()){var u=this.portletContainerNode.style,v=this.shadowNode.style,AC=this.parent;u.width=v.width="99%";u.top=v.top=AC.topStart+m;u.left=v.left=G+m;}else{if(this.isInFilterPanel()&&this.isHorizFP()){G=8;this.portletContainerNode.style.left=this.shadowNode.style.left=parseInt(z.left,10)+G*this.orgPos+m;}else{if(this.defn.ifp){this.adjustFPHeight2Fit();}}}if(this.buttonbarNode.clientHeight>0){this.buttonbarNode.style.height=this.buttonbarNode.clientHeight*this.model.getZoomFactor()+"px";}},adjustFPHeight2Fit:function(){var v=mstrmojo.dom,t=v.position(this.titleNode),u=v.position(this.contentNode).y-t.y-t.h;this.content.domNode.style.height=parseInt(this.defn.fmts.height,10)-u+"px";},unrender:function E(v){if(this.floatingTitle&&this.titleNode){var x=this.domNode,u=this.titleNode,w=mstrmojo.dom;if(x&&this._onhover){w.detachEvent(x,"mouseover",this._onhover);}if(x&&this._onhoveroff){w.detachEvent(x,"mouseout",this._onhoveroff);}if(u&&this._onhovertt){w.detachEvent(u,"mouseover",this._onhovertt);}if(u&&this._onhoverofftt){w.detachEvent(u,"mouseout",this._onhoverofftt);}if(u){document.body.removeChild(u);}}if(this._super){this._super(v);}},updateStyle:function(u,t){var x=this.shadowNode.style,v=this.containerNode.style;x.height=v.height=u;x.width=v.width=t;},_createFormats:function W(){var z=this.content&&this.content.getFormats(),w;w=z.p_fmts={};var t,x;for(t in Q){x=Q[t];if(z[x]!==undefined){w[x]=z[x];delete z[x];}}for(t in Y){x=Y[t];if(z[x]!==undefined){w[x]=z[x];}}z.height=this._ts.getContentHeight(z.height,w);if(mstrmojo.dom.isIE&&w.fx&&w.fx.ds&&!w["background-color"]){w["background-color"]="#ffffff";}var v=w.ttl,u=v&&v["background-color"];if(u){this.titlebarNodeClass=mstrmojo.color.getContrastingColor(u,"light","dark");}},refresh:function r(){if(!this.hasRendered){return ;}var u=this.children,t;for(t=u.length-1;t>=0;t--){u[t].refresh();}},isInFilterPanel:function L(){return(j.call(this)!==null);},isHorizFP:function(){if(this.isInFilterPanel()){var t=this.getFilterPanel();return t&&t.defn&&parseInt(t.defn.fds,10)===2;}return false;},getFilterPanel:function H(){return j.call(this);},getContainerHeight:function d(){return this.containerNode.clientHeight;},relocate:function C(t){if(this.isInFilterPanel()&&!this.isHorizFP()){this.portletContainerNode.style.top=this.shadowNode.style.top=t+m;}},setInfoWindowDimensions:function o(x){var u=this.domNode.style,t=this.shadowNode.style,v=this.portletContainerNode.style,w=mstrmojo._Formattable.getBorderWidths(this);x.h-=w.h;x.w-=w.w;t.height=v.height=u.height=x.h+m;t.width=v.width=u.width=x.w+m;x.h-=this.titleNode.offsetHeight;this.toolbarNode.style.display="none";},addDirtyKey:function K(t){A.call(this,"add",t);},removeDirtyKey:function J(t){A.call(this,"remove",t);},setDirtyChildren:function a(){var t=this.content;if(t&&t.setDirtyChildren){t.setDirtyChildren.apply(t,arguments);}}});var X=0,O=1,l=2;function N(t){var u=this.content.defn;if(u){u.set("ds",t);}}function n(t){return{FormattingOrder:{ZIndex:this.getFormats()["z-index"]},FormattingView:{WindowState:t}};}function b(AH,AF,t,AI){var AD=this.content,AG=AD.k,AC=mstrmojo.boxmodel.px2Inches,x=AD.model.docModel||AD.model,AK=x.getZoomProps(),z=this.getFormats(),u=AF!==undefined&&t!==undefined,AJ={},AA=this,AB=n.call(this,AH),AE=!(AD.defn.t===mstrmojo.EnumRWUnitType.GRIDGRAPH||AD.defn.t===mstrmojo.EnumRWUnitType.GRAPH);if(u){AB.FormattingSize={OldHeight:AC(AK,AF),OldWidth:AC(AK,t),Height:AC(AK,parseInt(z.height,10)),Width:AC(AK,parseInt(z.width,10))};}AJ.success=function(v){var w=v&&v.data;if(w){x.loadPartialData(w,AG);}N.call(AA,AH);var AL=AA.parent;if(AL.adjustSectionSize&&u){AL.adjustSectionSize();}};x.updateUnitFormat(AD,1,AB,AJ,{params:{suppressData:AE,rapidExec:AE},config:u?null:{silent:true},preserveUndo:true});if(!u&&!(AI&&AI.all)){if(x.saveRWProps){x.saveRWProps(AG,undefined,1,this.loadDataOnResize,AJ,true);}}}function U(){var AA=this.content;if(!AA){return ;}var x=function(AE){mstrmojo.array.forEach(AE,function(AF){if(AF.ds!==undefined){AF.set("visible",(AF.ds!==AA.defn.ds));}});},AB;if(this.isInFilterPanel()){var v=(parseInt(this.defn.ds,10)===X);AA.set("visible",v);this.updateContentHeight(!v);AB=this.leftToolbar;x(AB&&AB.children);var w=this.parent;if(w.refreshFP){w.refreshFP();}}else{var t=AA.getFormats(),AC=this.getFormats(),u=this.portletContainerNode.style,AD=this.shadowNode.style,z=this.contentNode.firstChild.style;z.height=t.height;z.width=t.width;AD.height=u.height=AC.height;AD.width=u.width=AC.width;AD.top=u.top=AC.top;AD.left=u.left=AC.left;if(AC["z-index"]!==undefined){AD.zIndex=u.zIndex=AC["z-index"];}AB=this.rightToolbar;x(AB&&AB.children);if(AA.resize){AA.resize();}}}mstrmojo.DocResizablePortlet=mstrmojo.declare(mstrmojo.DocPortlet,null,{scriptClass:"mstrmojo.DocResizablePortlet",loadDataOnResize:false,_createFormats:function W(){this._super();var u=this.getFormats();var t=parseInt(this.defn.ds,10);if(t===X){u.normHeight=u.height;u.normWidth=u.width;if(u["z-index"]!==null&&u["z-index"]!==undefined){u.normZIndex=u["z-index"];}}if(t!==l){u.normTop=u.top;u.normLeft=u.left;}},onmaximize:function f(){var w=this.parent,AA=this.content,z=AA&&AA.getFormats(),v=this.getFormats(),u=v.height,t=v.width,x=mstrmojo._Formattable.getBorderWidths(this);this.clearCache();AA.clearCache();v.height=(parseInt(w.getHeight(),10)-x.h)+m;z.height=this._ts.getContentHeight(v.height,v);v.width=z.width=(w.getWidth()-x.w)+m;v.top=v.left=0;v["z-index"]=w.getMaxZIndex()+1;b.call(this,l,u,t);},onminimize:function c(){var z=this.content,u=z.dimNode||z.domNode,x=z&&z.getFormats(),w=this.getFormats(),v=w.height||u.offsetHeight,t=w.width;this.clearCache();z.clearCache();w.width=x.width=w.normWidth;w.top=w.normTop;w.left=w.normLeft;if(w.normZIndex!==null&&w.normZIndex!==undefined){w["z-index"]=w.normZIndex;}x.height=0;w.height=this._ts.getPortletMinHeight(w);b.call(this,O,v,t);},onrestore:function S(){var x=this.content,w=x&&x.getFormats(),v=this.getFormats(),u=v.height,t=v.width;this.clearCache();x.clearCache();v.height=v.normHeight;w.height=this._ts.getContentHeight(v.height,v);v.width=w.width=v.normWidth;v.top=v.normTop;v.left=v.normLeft;if(v.normZIndex!==null&&v.normZIndex!==undefined){v["z-index"]=v.normZIndex;}b.call(this,X,u,t);},changeWindowState:function I(v){N.call(this,v);var u=this.content,x=n.call(u,v),t=u.model.docModel||u.model;return t.getUnitFormatAction(u,1,x);},oncollapse:function V(t){b.call(this,O,undefined,undefined,t);},onexpand:function D(t){b.call(this,X,undefined,undefined,t);},adjustFP:function h(){var u=(parseInt(this.defn.ds,10)===X);this.content.set("visible",u);this.updateContentHeight(!u);var t=this.parent;if(t.refreshFP){t.refreshFP();}},postBuildRendering:function Z(){if(!this._sub_dsChange){this._sub_dsChange=this.defn.attachEventListener("dsChange",this.id,U);}this._super();if(this.isInFilterPanel()){var t=(parseInt(this.defn.ds,10)===X);this.updateContentHeight(!t);}}});mstrmojo.DocPortlet.ST_RESTORE=X;mstrmojo.DocPortlet.ST_MAX=l;mstrmojo.DocPortlet.ST_MIN=O;}());(function(){mstrmojo.requiresClsP("mstrmojo","dom","css","desc","string");mstrmojo.requiresCls("mstrmojo.Dialog","mstrmojo._IsPopup","mstrmojo._IsMovable");var F=mstrmojo.dom,H=mstrmojo.css;mstrmojo.vi.ui.rw.CustomSortAvatar=mstrmojo.declare(mstrmojo.Dialog,[mstrmojo._IsPopup,mstrmojo._IsMovable],{scriptClass:"mstrmojo.vi.ui.rw.CustomSortAvatar",modal:false,title:mstrmojo.desc(15760,"Selected Element"),markupString:'<div id="{@id}" class="mstrmojo-CustomSortAvatar-wrapper"><div class="mstrmojo-CustomSortAvatar {@cssClass}" style="z-index:{@zIndex};{@cssText}" mstrAttach:mouseover,mouseout,click><div class="mstrmojo-CustomSortAvatar-titlebar"></div><div class="mstrmojo-CustomSortAvatar-content"></div></div></div>',markupSlots:{editorNode:function G(){return this.domNode.firstChild;},titlebarNode:function B(){return this.domNode.firstChild.firstChild;},containerNode:function D(){return this.domNode.firstChild.childNodes[1];}},markupMethods:{ontitleChange:function(){this.titlebarNode.innerText=this.title;},onzIndexChange:function(){this.editorNode.style.zIndex=this.zIndex;},onvisibleChange:function(M){this.domNode.style.display=this.visible?"block":"none";},onleftChange:function A(){this.editorNode.style.left=this.left||"";},ontopChange:function L(){this.editorNode.style.top=this.top||"";}},children:[{scriptClass:"mstrmojo.HBox",slot:"containerNode",alias:"containerBox",children:[{scriptClass:"mstrmojo.Label",alias:"label",useRichTooltip:true,updateTooltipConfig:function(){var N=this.domNode,M;if(N.scrollWidth>N.clientWidth){M=F.position(this.parent.domNode);this.richTooltip={cssClass:"vi-regular vi-tooltip-V",posType:mstrmojo.tooltip.POS_BOTTOMLEFT,content:N.textContent,top:M.y,left:M.x};}else{delete this.richTooltip;}}},{scriptClass:"mstrmojo.Widget",markupString:'<div class="icon close"></div>'}]}],updatePopupConfig:function E(M,O){var N=this;mstrmojo.hash.forEach(M,function(Q,P){if(Q!==undefined){N[P]=Q;}});},onOpen:function C(){this.containerBox.label.set("text",this.text);this.editorNode.style.top=this.top;this.editorNode.style.left=this.left;},preBuildRendering:function I(){if(!this.slot&&!this.placeholder){this.placeholder=document.body.appendChild(document.createElement("div"));}return this._super();},getMovingHandle:function J(){return this.titlebarNode;},getMovingTarget:function K(){return this.editorNode;}});}());(function(){mstrmojo.requiresCls("mstrmojo.dom","mstrmojo.css","mstrmojo.fx","mstrmojo.Dialog","mstrmojo.Label","mstrmojo._IsPopup","mstrmojo._HasPopup","mstrmojo._IsMovable","mstrmojo.ui._HasUITheme","mstrmojo.Button","mstrmojo.dom","mstrmojo.hash","mstrmojo.array","mstrmojo.tooltip","mstrmojo.ui.editors.ErrorDialogContent");var k=mstrmojo.func.composite,M=mstrmojo.dom,a=mstrmojo.Button.newWebButton,C=mstrmojo.css,Z=mstrmojo.all,N=mstrmojo.hash,c=mstrmojo.DI.DIHelpers,X=mstrmojo.array;function W(r){if(!this.modal){return ;}var t=window.mstrApp;if(t&&t.modalEditorChange){t.modalEditorChange(this.id,r);}}mstrmojo.Editor=mstrmojo.declare(mstrmojo.Dialog,[mstrmojo._IsPopup,mstrmojo._HasPopup,mstrmojo._IsMovable,mstrmojo.ui._HasUITheme],{scriptClass:"mstrmojo.Editor",title:"",allowHTMLTitle:false,help:"",autoClose:false,showTitle:true,openEffect:null,themeClassName:"mojo-theme-light",useRichTooltip:true,closeEffect:null,onEditorResized:null,markupString:'<div id="{@id}" class="mstrmojo-Editor-wrapper"><div class="mstrmojo-Editor {@cssClass}" style="z-index:{@zIndex};{@cssText}" mstrAttach:mouseup,mousedown,click,contextmenu>{@titlebarHTML}<div class="mstrmojo-Editor-content"></div><div class="mstrmojo-Editor-buttons"></div></div><div class="mstrmojo-Editor-curtain"></div></div>',titleMarkupString:'<div class="mstrmojo-Editor-title-container"><div class="mstrmojo-Editor-title"></div><div class="edt-title-btn mstrmojo-Editor-help" tooltip="'+mstrmojo.desc(1143,"help")+'"></div><div class="edt-title-btn mstrmojo-Editor-close" tooltip="'+mstrmojo.desc(2102,"Close")+'"></div></div><div class="mstrmojo-Editor-titleSpacer"></div>',markupSlots:{editorNode:function Y(){return this.domNode.firstChild;},titleContainerNode:function l(){return this.domNode.firstChild.firstChild;},titlebarNode:function n(){return this.showTitle?this.domNode.firstChild.firstChild.firstChild:null;},titleNode:function R(){return this.showTitle?this.domNode.firstChild.firstChild.firstChild:null;},helpNode:function o(){return this.showTitle?this.domNode.firstChild.firstChild.children[1]:null;},closeNode:function E(){return this.showTitle?this.domNode.firstChild.firstChild.lastChild:null;},containerNode:function S(){return this.domNode.firstChild.childNodes[2];},buttonNode:function I(){return this.domNode.firstChild.childNodes[3];},curtainNode:function p(){return this.domNode.lastChild;}},markupMethods:{ontitleChange:function(){if(this.showTitle){this.titleNode.innerHTML=this.allowHTMLTitle?this.title:mstrmojo.string.encodeHtmlString(this.title);}},onzIndexChange:function(){var r=this.zIndex;this.editorNode.style.zIndex=r;this.curtainNode.style.zIndex=r-1;},onvisibleChange:function(v){if(v){return ;}var u=this.visible,t="closeEffect",r="none";if(u){t="openEffect";r="block";}if(this[t]){this.playEffect(t);}else{this.editorNode.style.display=r;if(this.modal){this.curtainNode.style.display=r;}}},onhelpChange:function f(){if(this.showTitle){var t=this.help,r=this.helpNode;if(!t){r.style.display="none";}else{r.style.display="block";}}},onleftChange:function F(){this.editorNode.style.left=this.left||"";},ontopChange:function H(){this.editorNode.style.top=this.top||"";}},open:function Q(t,r){this._super(t,r);W.call(this,true);},close:function h(r){this._super(r);W.call(this,false);},unrender:function B(r){this._super(r);W.call(this,false);},destroy:function j(r){this._super(r);W.call(this,false);},preBuildRendering:function A(){if(!this.slot&&!this.placeholder){this.placeholder=document.body.appendChild(document.createElement("div"));this._curtain_to_body=true;W.call(this,true);}this.titlebarHTML=(this.showTitle)?this.titleMarkupString:"<div></div><div></div>";return this._super();},getMovingHandle:function m(){return this.titlebarNode;},getMovingTarget:function V(){return this.editorNode;},onPreClose:function G(){this.hideTooltip();return true;},premousedown:function P(r){var t=r.getTarget();if(t===this.closeNode||t===this.helpNode){C.toggleClass(t,"active",true);}},premouseup:function O(r){var t=r.getTarget();if(t===this.closeNode||t===this.helpNode){C.toggleClass(t,"active",false);}if(r.getTarget()===this.closeNode&&this.onPreClose()){this.close();}},onclick:function e(r){if(r.getTarget()===this.helpNode){if(mstrApp.showHelpTopic){mstrApp.showHelpTopic(this.help);}else{window.open(mstrmojo.helpPath()+(this.help||""),"_blank");return false;}}},_set_visible:function d(z,u){var t=(this[z]!==u);if(t){this[z]=u;var x=this._close_handler;if(u){if(this._curtain_to_body){this.resizeDialog();this.positionDialog();}if(this.autoClose){var w=this;x=this._close_handler=x||function(v){var AA=M.eventTarget(self,v);if(AA&&AA.parentNode&&!M.contains(w.editorNode,AA,true,document.body)){w.close();}};M.attachEvent(document.body,"mousedown",x);}}else{var r=this._curtain_handler;if(r){M.detachEvent(window,"resize",r);}if(x){M.detachEvent(document.body,"mousedown",x);}}}return t;},showTooltip:function q(z,x){var w=this,u=M.findAncestorByAttr(M.eventTarget(x,z),"tooltip",true,this.domNode),v=u&&u.value;if(!w.hasOpenTooltip&&v){var r=M.position(u.node);w.richTooltip={cssClass:"vi-regular A-center vi-tooltip-A",content:v,top:Math.max(r.y+40,0),left:Math.max(r.x+4,0),posType:mstrmojo.tooltip.POS_TOPCENTER};this._super(z,x);}}});mstrmojo.Editor.openEffect_fadeIn={scriptClass:"mstrmojo.fx.AnimateProp",slot:"curtainNode",props:{backgroundColor:{start:255,stop:0,fn:function(r){r=Math.round(r);return["rgb(",r,",",r,",",r,")"].join("");}}},preStart:function(){var t=this.target,r=this.widget;r.editorNode.style.display="block";if(!r.modal){return false;}t.style.display="block";C.setOpacity(t,60);return true;}};mstrmojo.Editor.closeEffect_fadeOut={scriptClass:"mstrmojo.fx.FadeOut",slot:"curtainNode",start:0.6,stop:0,preStart:function(){var r=this.widget;r.editorNode.style.display="none";return !!r.modal;}};function D(r){return function(){Z[r].destroy();};}function J(t,AB,AC,AD){var r=AB.id||"mojoAlertx9",x,AA=AB.buttons;X.forEach(AA,function(AF){var AE=AF.onclick;AF.onclick=function(AG){var AH=Z[r];if(AE&&AE.call(AF,AG)===false){return ;}AH.destroy();AH=null;};});try{!!Z[r]&&Z[r].destroy();}catch(z){}var u=AB.cssClass,v=[];if(u){v.push(u);delete AB.cssClass;}if(AD){v.push(AD);}v.push("mstrmojo-alert");x={scriptClass:"mstrmojo.Editor",id:r,width:"475px",zIndex:1000,title:AC||mstrmojo.desc(11812,"Notification"),cssClass:v.join(" "),children:[{scriptClass:"mstrmojo.Box",cssClass:"alert-content",children:[{scriptClass:"mstrmojo.Label",text:t,allowHTML:AB.allowHTML}]}],visible:true};var w=new mstrmojo.Editor(N.copy(AB,x));w.render();return w;}if(window.mstrConfig&&!window.mstrConfig.simpleDialog){mstrmojo.notify=function L(t,AA,u){u=u||{};var AB=u.forceClose,z=u.callback||mstrmojo.emptyFn,x=N.copy(AA||{},{buttons:AB?[mstrmojo.Button.newActionButton((u.buttonText||mstrmojo.desc(8607,"Dismiss")),z)]:null,showTitle:false,modal:false,top:"42px"}),v=u.duration||6000;var w=J(t,x,"",AB?"ed-notify":"ed-toast"),r=w.id;if(!AB){window.setTimeout(k([z,D(r)]),v);}else{window.setTimeout(function(){if(Z[r]){Z[r].editorNode.style.opacity=0.75;}},6000);}return w;};mstrmojo.confirm=function g(r,z,AB){z=z||{};var u=z.confirmBtn||{},x=z.cancelBtn||{},AA=u.hot!==false,t=!!x.hot,w=AB&&AB.title,v=[a(u.t||mstrmojo.desc(219,"Yes"),u.fn,AA,u.cfg),a(x.t||mstrmojo.desc(218,"No"),x.fn,t,x.cfg)];return J(r,N.copy(AB||{},{buttons:v,onPreClose:function(){if(x&&x.fn){x.fn();}return true;}}),w,c.getEnvObj().isStandaloneDataSet()?["error-dialogue-in-dataset"]:[]);};mstrmojo.warn=function K(u,r,t){t=t||{};t.cssClass=(t.cssClass||"")+" mstrmojo-warning";return mstrmojo.confirm(u,r,t);};mstrmojo.alert=function b(x,u,w,z,r,v){var t={title:w||mstrmojo.desc(12405,"Alert"),zIndex:z,cssClass:r,buttons:[a(mstrmojo.desc(1442,"OK"),u,true)],onPreClose:function(){if(u){u();}return true;}};N.forEach(t,function(AB,AA){if(!AB){delete t[AA];}});return J(x,N.copy(v,t),w,c.getEnvObj().isStandaloneDataSet()?["error-dialogue-in-dataset"]:[]);};mstrmojo.error=function U(x,t,w){var u=x||{};var v=mstrmojo.desc(96,"Error");var r=!(c.getEnvObj().isInDI()||c.getEnvObj().isInQB());if(w){v=(w.title)?w.title:mstrmojo.desc(96,"Error");w.title=v;if(w.enableContactStr===false){r=false;}}J("",N.copy(w||{},{buttons:[a(mstrmojo.desc(1442,"OK"),t,true)],children:[{scriptClass:"mstrmojo.ui.editors.ErrorDialogContent",shortDesc:u.shortDesc,longDesc:u.longDesc,showToggle:!!(u.longDesc),enableContactStr:r,allowHTML:!!(w&&w.allowHTML===true)}]}),v,c.getEnvObj().isStandaloneDataSet()?["error-dialogue-in-dataset"]:[]);};}mstrmojo.Editor.ButtonConfigType=null;}());(function(){mstrmojo.requiresCls("mstrmojo.TimePicker","mstrmojo._IsInputControl");var A=2,B=mstrmojo.date;mstrmojo.TimePickerDIC=mstrmojo.declare(mstrmojo.TimePicker,[mstrmojo._IsInputControl],{scriptClass:"mstrmojo.TimePickerDIC",popupStyle:2,init:function(C){if(this._super){this._super(C);}this.set("interval",this.dic.itv);this.set("active",A);},getCurValue:function(){if(this.dic.dt==mstrmojo.expr.DTP.TIMESTAMP){var F=B.parseDateAndOrTime(this.value),G=F&&F.time,D=F&&F.date,C,E;if(G&&!D){C=B.parseDateAndOrTime(this.lv),D=C&&C.date;if(!D){E=new Date();D={day:E.getDate(),month:E.getMonth()+1,year:E.getFullYear()};}return B.formatDateInfo(D,mstrmojo.locales.datetime.DATEOUTPUTFORMAT)+" "+B.formatTimeInfo(G,mstrmojo.locales.datetime.TIMEOUTPUTFORMAT);}}return this.value;},handleDisable:function(){return false;}});}());(function(){mstrmojo.requiresCls("mstrmojo.SliderBox","mstrmojo._IsInputControl","mstrmojo.Box","mstrmojo.hash");var C=mstrmojo.css,B=mstrmojo.dom,D=mstrmojo.hash,A=1;mstrmojo.SliderDIC=mstrmojo.declare(mstrmojo.SliderBox,[mstrmojo._IsInputControl],{scriptClass:"mstrmojo.SliderDIC",popupStyle:1,tabIndex:0,markupString:'<div id="{@id}" class="{@cssClass}" style="{@cssText}" tabindex="{@tabIndex}" ><div class="valuePart" style="{@valueCssText}"><span class="valueLabel">{@valueLabel}</span><span class="valueText">{@valueText}</span></div><table class="sliderPart" style="{@sliderCssText}"><tbody><tr><td class="minText">{@min}</td><td class="sliderWrapper"></td><td class="maxText">{@max}</td></tr></tbody></table><div class="curtain"></div></div>',markupSlots:D.copy({sliderPartNode:function(){return this.domNode.children[1];},minTextNode:function(){return this.domNode.children[1].rows[0].cells[0];},maxTextNode:function(){return this.domNode.children[1].rows[0].cells[2];},sliderNode:function(){return this.domNode.children[1].rows[0].cells[1];},disableCurtainNode:function(){return this.domNode.lastChild;}},D.copy(mstrmojo.SliderBox.prototype.markupSlots)),init:function(E){if(this._super){this._super(E);}this.cssClass=this.showByDefault?"mstrmojo-SliderGroup":"mstrmojo-PopupSlider";this.items=this.getItems();if(this.dic.ipt!==A){this.isSequential=true;this.max=this.dic.max;this.min=this.dic.min;this.interval=this.dic.itv;}},focus:function(){if(mstrmojo.dom.isIE){var E=this;setTimeout(function(){E.domNode.focus();},10);}else{this.domNode.focus();}},preBuildRendering:function(){this._super();var H=this.dic,E=(H.ldw!=null)?H.ldw/100:0.4,F,G=this.openerStyle;if(this.showByDefault){F=G.iw*(1-E)-G.rp-3;this.alignSlider(this.openerNode,G.ih);}else{F=H.w;}this.sliderBar.set("width",F);this.valueText=this.showByDefault?this.dv:this.value;if(!this.showByDefault&&this.unset&&this.isSequential){this.valueText+=" "+mstrmojo.desc(8316,"(out of range)");}},handleDisable:function(){return !!this.showByDefault;},postBuildRendering:function(){if(this._super){this._super();}if(this.showByDefault){var J=this.dic,G=this.value,E=(J.ldw!=null)?J.ldw:40,I=this.openerStyle,F=I.ih;this.domNode.style.width=I.iw+"px";this.domNode.style.height=I.ih+"px";this.valuePartNode.style.width=this.sliderPartNode.style.left=E+"%";if(this.isSequential){this.sliderBar.set("title",mstrmojo.desc(5441,"Minimum value")+": "+this.min+"   "+mstrmojo.desc(5442,"Maximum value")+": "+this.max);}}if(this.handleDisable()){C.toggleClass(this.disableCurtainNode,"disabled",!!this.enabled);if(!this.enabled){var H={height:this.sliderPartNode.clientHeight+"px",width:(this.sliderPartNode.clientWidth+this.valuePartNode.clientWidth)+"px"};D.copy(H,this.disableCurtainNode.style);}}}});})();(function(){mstrmojo.requiresCls("mstrmojo.DocSection","mstrmojo._HasLayout","mstrmojo.vi.ui._IsBoxLayoutChild","mstrmojo.vi.ui.rw._SavesChildPositions");mstrmojo.vi.ui.rw.DocSection=mstrmojo.declare(mstrmojo.DocSection,[mstrmojo._HasLayout,mstrmojo.vi.ui._IsBoxLayoutChild,mstrmojo.vi.ui.rw._SavesChildPositions],{scriptClass:"mstrmojo.vi.ui.rw.DocSection",layoutConfig:{h:{containerNode:"100%"},w:{containerNode:"100%"},xt:true},alias:"docSection"});}());(function(){var BUILDER_METHOD={BUTTON:"newButton",PICKERBUTTON:"newPickerButton",LIST:"newList",SEPARATOR:"newSeparator",TEXT:"newCustom"};function cmdMethodName(cmdid){return(cmdid==="export")?cmdid+"Cmd":cmdid;}function bindEnabled(enabledFeatures){var arr=enabledFeatures.split(","),txt=[],i,len;for(i=0,len=arr.length;i<len;i++){var s=arr[i],neg=s.match(/^\!/);if(neg){s=s.replace("!","");}txt.push((neg?"!":"")+"this.target.model.features['"+s+"']");}return txt.join(" && ");}function bindItems(cmdid){return"var t = this.target.view, c = this.cmdid; if (t && c) {return this.target.view."+cmdid+"Options;}";}function bindSelectedItem(cmdid){return"var x = this.items; var t = this.target.view, c = this.cmdid; if (t && c){return this.target.view."+cmdid+"Value;}";}function openLink(json){var link=json.link,h=link&&link.href,t=link&&link.target,xtraUrl=json["extra-url"];if(!link||!h){return ;}if(xtraUrl){h+="&"+xtraUrl;}if(link["use-window-open"]){t="_blank";}window.open(h,t?t:"_self");}mstrmojo.ToolBarBuilder={scriptClass:"mstrmojo.ToolBarBuilder",build:function build(nodes,model,config){var arr=[],i,len;for(i=0,len=(nodes&&nodes.length)||0;i<len;i++){var json=nodes[i],n=BUILDER_METHOD[(json&&json.type)||"SEPARATOR"],w=this[n]&&this[n](json,config);if(w){arr.push(w);}}return arr;},newButton:function nwBtn(json,config){if(json["on-click"]||json.link){return this.newCustom(json,config);}var c=cmdMethodName(json.cmdid);return new mstrmojo.Button({title:json.tooltip,iconClass:json.id,cssClass:"mstrmojo-InteractiveButton",target:config&&config.target,cmdid:c,onclick:function(e){var t=this.target,ci=this.cmdid;t[ci](e);},bindings:json.enabledFeatures?{enabled:bindEnabled(json.enabledFeatures)}:null});},newPickerButton:function nwPkrBtn(json,config){var c=cmdMethodName(json.cmdid);var bs;if(!json.items){bs={};bs.items=bindItems(c);}if(json.enabledFeatures){bs=bs||{};bs.enabled=bindEnabled(json.enabledFeatures);}function oc(){var t=this.target,ci=this.cmdid,its=this.items,idx=this.selectedIndex;t[ci](its[idx].dssid);}return new mstrmojo.PickerButton({title:json.title||"",iconClass:json.id,items:json.items,itemDisplayField:"n",itemIdField:"dssid",autoHide:true,size:1,selectedIndex:parseInt(json.selectedIndicesList,10)||0,target:config&&config.target,cmdid:c,onchange:oc,bindings:bs});},newList:function nwLst(json,config){var c=cmdMethodName(json.cmdid),bs={selectedItem:bindSelectedItem(c)};if(!json.items){bs.items=bindItems(c);}if(json.enabledFeatures){bs.enabledFeatures=bindEnabled(json.enabledFeatures);}return new mstrmojo.SelectBox({id:json.cmdid,size:1,tooltip:json.title||"",iconClass:json.id,cmdid:c,target:config&&config.target,itemDisplayField:"n",itemIdField:"dssid",autoHide:true,onchange:function(){var t=this.target,ci=this.cmdid,itm=this.selectedItem;t[ci](itm&&itm.dssid);},items:json.items,bindings:bs});},newSeparator:function nwSep(json,config){return new mstrmojo.ToolSeparator(json);},newCustom:function newCstm(json,config){var b=new mstrmojo.Button({markupString:'<div id="{@id}" class="mstrmojo-Button {@cssClass}" title="{@title}" style="{@cssText}" mstrAttach:click,mousedown,mouseup><div id="{@iconClass}" class="mstrmojo-Button-text"></div></div>',title:json.tooltip,cssClass:"mstrmojo-InteractiveButton",onclick:function(){if(json.link){openLink(json);}if(json["on-click"]){eval(json["on-click"]);}},bindings:json.enabledFeatures?{enabled:bindEnabled(json.enabledFeatures)}:null}),v=json.value;b.text=v||"";b.cssText=v?"width:auto;margin-top:4px;":"";b.title=json.tooltip||"";b.iconClass=json.id||"";return b;}};}());(function(){mstrmojo.requiresCls("mstrmojo.ui.pathbar.PathPopup","mstrmojo.ListBase","mstrmojo._IsList","mstrmojo.dom","mstrmojo.css","mstrmojo.ui.pathbar._PreAppExit");function A(){this.addDisposable(this.breadCrumbs=new mstrmojo.ui.pathbar.PathPopup({id:"mojoPathBreadCrumbs",cssClass:"mojoPathPicker",offsetLeft:0,children:[{scriptClass:"mstrmojo.ui.pathbar.List",alias:"breadCrumbsItems",preclick:function I(){this.parent.close();},items:null,getItemMarkup:function(){return'<a href="#" idx="{@idx}"><span>{@en@n}</span></a>';},getItemProps:function J(L,K){return{n:mstrmojo.string.decodeHtmlString(L.n),idx:K,href:L.href};}}]}));}var D=mstrmojo.css,G=mstrmojo.dom;mstrmojo.ui.pathbar.PathAncestors=mstrmojo.declare(mstrmojo.ListBase,[mstrmojo._IsList,mstrmojo.ui.pathbar._PreAppExit],{scriptClass:"mstrmojo.ui.pathbar.PathAncestors",markupString:'<div id="{@id}" class="mstrmojo-ListBase {@cssClass}" style="{@cssText}" mstrAttach:click,dblclick,mouseover,mouseout><div class="pathText"><div class="pathBreadCrumbs"><span class="pathBreadCrumbsParent"><a href="{@pathParentLink}">{@pathParentName}</a></span><span class="pathBreadCrumbsPullArrow"></span><span class="pathDelim">{@delimiter}</span></div><div class="pathAncestor hidden">{@itemsHtml}</div><div class="pathCurrent"><span>{@pathCurrent}</span></div></div></div>',markupSlots:{breadCrumbsNode:function(){return this.domNode.firstChild.children[0];},breadCrumbsParentNode:function(){return this.domNode.firstChild.children[0].firstChild;},breadCrumbsArrowNode:function(){return this.domNode.firstChild.children[0].children[1];},ancestorNode:function(){return this.domNode.firstChild.children[1];},currentNode:function(){return this.domNode.firstChild.lastChild;},itemsContainerNode:function(){return this.domNode.firstChild.children[1];}},markupMethods:{onwidthChange:function(){var K=this,I=K.ancestorNode,J=K.breadCrumbsNode;if(K.getNeededWidth()>K.getAvailWidth()){D.toggleClass(J,"hidden",false);D.toggleClass(I,"hidden",true);K.resizeBreadCrumbs();}else{K.resizePathBar();}}},delimiter:">",pathCurrent:null,pathFirst:null,pathParent:null,breadCrumbs:null,reversedItems:null,init:function H(J){this._super(J);var I=this.items;this.pathCurrent=I[I.length-1].n;this.pathFirstLink=I[0].href;this.pathFirstName=I[0].n;if(I.length>1){this.pathParentLink=I[I.length-2].en!=true?"#":I[I.length-2].href;this.pathParentName=I[I.length-2].n;}I.splice(I.length-1,1);this.reversedItems=[].concat(I).reverse();A.call(this);},resizePathBar:function(){var P=this,M=P.ancestorNode,I=P.currentNode,K=P.breadCrumbsNode,R=M.style,J=I.style,Q=G.position(P.domNode).w-23-20,O,N,L;O=Math.min(Q/2,G.position(I).w);N=Q-O;L=N>M.scrollWidth?N-M.scrollWidth:0;N-=L;R.maxWidth=Math.max(0,N)+"px";J.maxWidth=Math.max(0,Q-N)+"px";},resizeBreadCrumbs:function(){var N=this,I=N.currentNode,O=N.breadCrumbsParentNode,J=I.style,L=O.style,P=G.position(N.domNode).w-60,M,Q,K;L.maxWidth=Math.max(0,P)+"px";J.maxWidth=Math.max(0,P)+"px";M=Math.min(P/2,G.position(I,true).w);Q=P-M;K=Q>O.scrollWidth?Q-O.scrollWidth:0;Q-=K;L.maxWidth=Math.max(0,Q)+"px";J.maxWidth=Math.max(0,P-Q)+"px";},onclick:function C(I){var J=this.breadCrumbs;if(!this._super(I)){return false;}var K=I.getTarget();if(K==this.breadCrumbsArrowNode){J.set("targetNode",this.breadCrumbsNode);J.breadCrumbsItems.set("items",this.reversedItems.slice(1));if(!J.isOpen){J.open();}}},getItemMarkup:function(){return'<span idx="{@idx}"><a href="#">{@n}</a></span><span class="pathDelim">{@dl}</span>';},getItemProps:function E(J,I){return{n:J.n,href:J.href,dl:this.delimiter,idx:I};},getNeededWidth:function B(){var L=this.breadCrumbsNode,I=this.ancestorNode,K=this.currentNode,J=this.breadCrumbs;D.toggleClass(L,"hidden",true);D.toggleClass(I,"hidden",false);if(J.isOpen){J.close();}return I.scrollWidth+K.scrollWidth+30;},getAvailWidth:function F(){var I=this;return G.position(I.domNode).w-23-20;}});}());(function(){mstrmojo.requiresCls("mstrmojo.Widget","mstrmojo.ui.pathbar.PathPopup","mstrmojo.mstr._RecentObjectsHelper","mstrmojo.util.LibraryHelper");function D(O,J){var F=[],I,G=1;F[0]={name:mstrmojo.desc(8661,"All Projects"),href:mstrApp.name+"?evt=3001&src="+mstrApp.name+".3001",isSpecial:true};if(mstrApp.projectsList&&mstrApp.projectsList.projects){var H=mstrApp.projectsList.projects;for(I=0;I<H.length;I++){F[G++]=H[I];}}var P;O.addDisposable(P=new mstrmojo.ui.pathbar.PathPopup({id:"mstrProjectsGenPopup",cssClass:"mstrShortcutsListPopup",targetNode:J,children:[{scriptClass:"mstrmojo.ui.pathbar.ScrollableList",alias:"menuItems",useRichTooltip:true,items:F,preclick:function L(){this.parent.close();},getItemMarkup:function(Q){if(Q.isSpecial){if(this.items.length===1){Q.cssText="border-bottom: none;";}return'<span id="allProjectsItem" class="item mstrMenuItem {@itemCls}" style="{@cssText}"><a class="mstrLink project{@idx}" href="{@href}" idx="{@idx}" style="width:100%;">{@en@displayName}</a></span>';}return'<span class="item mstrMenuItem {@itemCls}" style="{@cssText}"><a class="mstrLink project{@idx}" href="{@href}" idx="{@idx}" style="width:100%;"><div class="projectName">{@en@displayName}</div>  <div class="serverName">{@srvrName}</div></a></span>';},getItemProps:function N(S,Q){var R=!!S.selected;return{sel:R,itemCls:"mstr-project-item",cssText:S.cssText||"",cls:R?"selected":"",newGroup:!!S.grp?"grp":"",displayName:S.alias||S.name,idx:Q,href:S.href||mstrApp.name+"?evt=3010&src="+mstrApp.name+".3010&Port="+encodeURIComponent(S.port)+"&Project="+encodeURIComponent(S.name)+"&Server="+encodeURIComponent(S.server),srvrName:S.server,target:S.target||"_self"};},getTooltipText:function K(Q){if(Q&&!Q.isSpecial){$STR=mstrmojo.string;return $STR.encodeHtmlString((Q.alias||Q.name))+"<br/>"+Q.server+"<br/>"+$STR.encodeHtmlString(Q.desc);}},onclick:function(Q){var S=function(){mstrmojo.dom.preventDefault(Q.hWin,Q.e);mstrmojo.dom.stopPropogation(Q.hWin,Q.e);};var R=Q.getTarget();if(!R.getAttribute("href")){R=R.parentElement;}mstrmojo.form.sendLinkAsForm(R.href);S();return false;}}],onvisibleChange:function(){if(this.visible){setTimeout(this.menuItems.updateScrollbars(),200);}},onClose:function M(){this.isOpen=false;mstrmojo.css.toggleClass(this.targetNode,"opened",false);this.domNode.style.left="";}}));return P;}function E(J,K){var I=this.handleRecentObjects();var L;J.addDisposable(L=new mstrmojo.ui.pathbar.PathPopup({id:"mstrRecentsGenPopup",cssClass:"mstrShortcutsListPopup",targetNode:K,children:[{scriptClass:"mstrmojo.ui.pathbar.List",alias:"menuItems",items:I,preclick:function F(){this.parent.close();},getItemMarkup:function(O){var M="";if(mstrConfig.showPreviews){if(O.recoveryInfo!==undefined){var N=(O.recoveryInfo.imgData!==undefined)?"data:image/png;base64,"+O.recoveryInfo.imgData:"";if(N!==""){M='<img class = "img-preview" src = "'+N+'" height="200" width="250" style="z-index: 100; position: absolute;">';}}}return'<span class="item mstrMenuItem {@itemCls}" style="{@cssText}"><span class="{@iconCls}"></span><a class="mstrLink" href="{@href}"><div>{@n}</div>'+M+"</a></span>";},getItemProps:function H(P,M){var O=!!P.selected,N=(mstrApp&&mstrApp.optimizeFitToPage)?"&innerWidth="+window.innerWidth+"&innerHeight="+window.innerHeight:"";return{sel:O,iconCls:P.iconClass,itemCls:P.itemClass,cssText:P.cssText||"",cls:O?"selected":"",newGroup:!!P.grp?"grp":"",n:P.recoveryName,idx:M,href:P.recoveryURL+N,name:P.recoveryName,target:P.target||"_self"};},onclick:function(M){var O=function(){mstrmojo.dom.preventDefault(M.hWin,M.e);mstrmojo.dom.stopPropogation(M.hWin,M.e);};var N=M.getTarget();if(N.getAttribute("href")){mstrmojo.form.sendLinkAsForm(N.href);}else{mstrmojo.form.sendLinkAsForm(N.parentElement.href);}O();return false;}}],onClose:function G(){this.isOpen=false;mstrmojo.css.toggleClass(this.targetNode,"opened",false);this.domNode.style.left="";}}));return L;}function A(){var L=this;this.addDisposable(this.popup=new mstrmojo.ui.pathbar.PathPopup({id:"mstrSCList",cssClass:"mstrShortcutsListPopup",targetNode:this.domNode,offsetTop:2,recentsPopup:null,children:[{scriptClass:"mstrmojo.ui.pathbar.List",alias:"menuItems",preclick:function F(M){var N=M.getTarget();if(N.getAttribute("name")!=="recentObjects"&&N.getAttribute("name")!=="projects"){this.parent.close();}},handleMouseOver:function I(M,N){var O=M.getTarget(),Q=this.parent.projectsPopup,P=this.parent.recentsPopup;if(O.getAttribute("name")=="recentObjects"){if(Q!=null){Q.close();}this.handleClick(M,N);}else{if(O.getAttribute("name")=="projects"){if(P!=null){P.close();}this.handleClick(M,N);}else{if(P!=null){P.close();}if(Q!=null){Q.close();}}}return false;},handleClick:function G(N,O){var P=N.getTarget();var M=this.parent;if(P.getAttribute("name")=="recentObjects"){if(P.nodeName==="SPAN"){P=P.parentNode;}if(M.recentsPopup==null){M.recentsPopup=E.call(L,M,P);}this.openHelper(P,M.recentsPopup);return true;}else{if(P.getAttribute("name")=="projects"){if(P.nodeName==="SPAN"){P=P.parentNode;}if(M.projectsPopup==null){this.loadProjects(P);}else{this.openHelper(P,M.projectsPopup);}return true;}else{if(P.getAttribute("name")=="dossierLibrary"){mstrmojo.util.LibraryHelper.createTokenAndOpenLink(O.href);return true;}}}return false;},openHelper:function K(N,O){O.autoPosition=false;var M=N.getBoundingClientRect();if(!O.isOpen){O.offsetTop=M.top-M.bottom;O.offsetLeft=this.domNode.clientWidth-M.left;O.open();}},loadProjects:function J(O){var N=this;var M=N.parent;if(!mstrApp.projectsList){mstrApp.showWait();mstrApp.serverProxy.request({success:function(P){if(P){mstrApp.projectsList=P;M.projectsPopup=D.call(L,M,O);N.openHelper(O,M.projectsPopup);}},complete:function(){mstrApp.hideWait(true);}},{taskId:"getProjectsInfo",sort:true},false,{});}else{M.projectsPopup=D.call(L,M,O);N.openHelper(O,M.projectsPopup);}},items:mstrApp.pathInfo.sb,getItemMarkup:function(N){var M="{@cls}";if(N.name==="recentObjects"||N.name==="projects"){M="";}return'<a name="{@name}" class="item {@name} '+M+' {@newGroup}" idx="{@idx}" onclick="{@onclick}" href="#" target="{@target}"><span name="{@name}" class="icon"></span><span name="{@name}">{@n}</span></a>';},getItemProps:function H(O,M){var N=!!O.selected;return{sel:N,cls:N?"selected":"",newGroup:!!O.grp?"grp":"",n:O.n,idx:M,href:O.href,name:O.name,onclick:O.onclick||"return true",target:O.target||"_self"};}}]}));}mstrmojo.ui.pathbar.PathStarBurst=mstrmojo.declare(mstrmojo.Widget,[mstrmojo.mstr._RecentObjectsHelper],{scriptClass:"mstrmojo.ui.pathbar.PathStarBurst",markupString:'<a id="mstrStarburst {@id}" mstrAttach:click,mouseover,mouseout class="mstrLink" style="top:0"><div id="mstrLogo" class="mstrLogo path"></div><div id="mstrLogoMenu" class="mstrLogoMenu path mstrPullArrow"></div></a>',markupSlots:{logoNode:function(){return this.domNode.children[0];},logoMenuNode:function(){return this.domNode.children[1];}},popup:null,postBuildRendering:function C(){A.call(this);this.domNode.setAttribute("href",mstrApp.name+"?evt=3010&src="+mstrApp.name+".3010");},onclick:function B(F){var G=function(){mstrmojo.dom.preventDefault(F.hWin,F.e);mstrmojo.dom.stopPropogation(F.hWin,F.e);};if(F.getTarget()===this.logoMenuNode){var H=this.popup;if(!H.isOpen){H.open();}G();}else{mstrmojo.form.sendLinkAsForm(F.src.domNode.href);G();return false;}}});}());(function(){mstrmojo.requiresCls("mstrmojo.Widget","mstrmojo.ui.pathbar.PathPopup");function D(F){return(F!=="myPage");}function A(){this.addDisposable(this.popup=new mstrmojo.ui.pathbar.PathPopup({id:"mstrAccountSCList",cssClass:"mstrShortcutsListPopup mstrAccountSCListPopup",targetNode:this.domNode,offsetTop:0,children:[{scriptClass:"mstrmojo.ui.pathbar.List",alias:"menuItems",useRichTooltip:true,postclick:function H(){if(D(this.selectedItem.name)){this.parent.close();}},items:mstrApp.pathInfo.el,getTooltipText:function F(I){if(I&&I.name==="save"){return mstrmojo.desc("14684","Publish current layout as default layout for other users");}else{return null;}},getItemMarkup:function(){return'<a class="item {@name} {@cls} {@newGroup}" idx="{@idx}" onclick="{@onclick}" href="#" target="{@target}"><span class="icon"></span><span>{@n}</span></a>';},getItemProps:function G(K,I){var J=!!K.selected;return{sel:J,cls:J?"selected":"",newGroup:!!K.grp?"grp":"",n:K.n,idx:I,href:K.href,name:K.name,onclick:K.onclick||"return false;",target:K.target||"_self"};}}]}));}mstrmojo.ui.pathbar.PathExtraLinks=mstrmojo.declare(mstrmojo.Widget,null,{userName:null,init:function E(G){var H=this;this._super(G);var F=this.items;this.userName=F[0].user;mstrmojo.array.forEach(this.items,function(I){if(I.name==="save"){I.onclick="mstrmojo.all."+H.id+".raiseEvent({name:'saveDefaultCard'})";I.en=false;}if(I.name==="load"){I.onclick="mstrmojo.all."+H.id+".raiseEvent({name:'loadDefaultCard'})";I.en=false;}if(I.name==="myPage"){I.en=false;}});F.splice(0,1);},scriptClass:"mstrmojo.ui.pathbar.PathExtraLinks",markupString:'<div id="mstrPathAccount" mstrAttach:click class="mstrLink" style="cursor:pointer;"><span class="mstrAccountName" title="{@userName}">{@userName}</span><div id="mstrAccountMenu" class="mstrAccountMenu path"></div></div>',popup:null,postBuildRendering:function C(){A.call(this);},onclick:function B(){var F=this.popup;if(!F.isOpen){F.open();}}});}());(function(){mstrmojo.requiresCls("mstrmojo.Widget","mstrmojo.ui.pathbar.PathPopup","mstrmojo.dom","mstrmojo.css");function D(){var N=this,J=N.domNode,L=false;pos=mstrmojo.dom.position(N.targetNode),winDimension=mstrmojo.dom.windowDim();J.style.top=(pos.y+pos.h+N.offsetTop)+"px";var P=pos.x+pos.w,M=winDimension.w-P-J.offsetWidth;if(P+J.offsetWidth>winDimension.w){M=winDimension.w-pos.x;L=true;if(M+J.offsetWidth>winDimension.w){M=0;}}if(N.id==="mstrToolbarList"){if(L){M=M-pos.w*0.6;}else{M=M+pos.w+6;}}J.style.right=M+"px";N.set("visible",false);N.isOpen=true;N.set("visible",true);var O=parseInt(J.style.top,10);if(O+J.offsetHeight>winDimension.h){var K=O-J.offsetHeight+pos.h;J.style.top=(K>0?K:0)+"px";}mstrmojo.css.toggleClass(N.targetNode,"opened",true);}function B(){var J=this.popup,M=J.containerNode.childNodes[0].childNodes[0].childNodes[J.zoomChildIndex].lastChild,L=M.textContent||M.innerText,K=J.dc.view.zoomValue;L=L.substr(0,L.indexOf("("));M.innerHTML=L+"("+K.n+")";}function C(N){var O=N.selectedItem;if(O===null){return ;}var S=N.containerNode.firstChild.firstChild,J=N.dc.view.zoomValue,Q=O.getAttribute("dssid");if(Q===J.dssid){return ;}mstrmojo.css.removeClass(O,"selected");var M=S.childNodes,R=M.length,P=0,K=-1,L;for(P=0;P<R;P++){L=M[P];if(L.getAttribute("dssid")===J.dssid){K=P;break;}}if(K===-1){var U=N.children[0];U.addItems([J]);L=S.childNodes[U.items.length-1];}mstrmojo.css.addClass(L,"selected");N.selectedItem=L;}function F(J,Q,M){var L;Q.addDisposable(L=new mstrmojo.ui.pathbar.PathPopup({id:"mstrZoomPopup",cssClass:"mstrShortcutsListPopup",targetNode:M,dc:Q.dc,slectedIndex:-1,selectedItem:null,onOpen:function K(){D.call(this);},onClose:function P(){delete this.isOpen;mstrmojo.css.toggleClass(this.targetNode,"opened",false);this.domNode.style.top="-10000px";},children:[{scriptClass:"mstrmojo.ui.pathbar.List",alias:"menuItems",preclick:function N(){this.parent.close();},items:J,getItemMarkup:function(){return'<a class="item {@cls}" dssid="{@dssid}"><span class="icon"></span><span>{@name}</span></a>';},getItemProps:function O(W,S){var U=W.dssid===this.parent.dc.view.zoomValue.dssid,V="";if(U){this.parent.selectedIndex=S;V="selected";}return{cls:V,dssid:W.dssid,name:W.n};},onclick:function R(b){var a=this.parent,V=mstrmojo.dom.findAncestorByAttr(b.getTarget(),"dssid",true,a.domNode),Z=V.node,X=Z.getAttribute("dssid"),U=a.targetNode.getAttribute("cmdid"),c=a.dc,S=c.view.zoomValue,W=S.dssid;if(X!==W){c[U](X);var Y=a.targetNode.lastChild.textContent||a.targetNode.lastChild.innerText;a.targetNode.lastChild.innerHTML=Y.replace(S.n,Z.lastChild.textContent||Z.lastChild.innerText);if(a.selectedItem===null){a.selectedItem=this.domNode.firstChild.childNodes[a.selectedIndex];}mstrmojo.css.removeClass(a.selectedItem,"selected");mstrmojo.css.addClass(Z,"selected");a.selectedItem=Z;}}}]}));return L;}function E(J,P,L){var Q;P.addDisposable(Q=new mstrmojo.ui.pathbar.PathPopup({id:"mstrExportPopup",cssClass:"mstrShortcutsListPopup",targetNode:L,dc:P.dc,onOpen:function K(){D.call(this);},onClose:function O(){delete this.isOpen;mstrmojo.css.toggleClass(this.targetNode,"opened",false);this.domNode.style.top="-10000px";},children:[{scriptClass:"mstrmojo.ui.pathbar.List",alias:"menuItems",preclick:function M(){this.parent.close();},items:J,getItemMarkup:function(){return'<a class="item" dssid="{@dssid}"><span class="icon" style="display:none;"></span><span>{@name}</span></a>';},getItemProps:function N(S){return{cls:S.cssClass,dssid:S.dssid,name:S.n};},onclick:function R(U){var W=mstrmojo.dom.findAncestorByAttr(U.getTarget(),"dssid",true,this.parent.domNode),X=W.node,V=parseInt(X.getAttribute("dssid"),10),S=this.parent.dc;S.exportCmd(V);}}]}));return Q;}function G(){this.addDisposable(this.popup=new mstrmojo.ui.pathbar.PathPopup({id:"mstrToolbarList",cssClass:"mstrShortcutsListPopup",targetNode:this.domNode,offsetTop:0,zoomChildIndex:null,onOpen:function K(){D.call(this);},children:[{scriptClass:"mstrmojo.ui.pathbar.List",alias:"menuItems",items:mstrApp.pathInfo.tbModelData.n.items,getItemMarkup:function(){return'<a class="item {@cls}" cmdId="{@cmdid}" idx="{@idx}"><span class="icon" style="display:none;"></span><span>{@name}</span></a>';},getItemProps:function M(R,O){var Q=!!R.selected,S=R.cmdid,P=R.tooltip||R.title||S;if(S==="zoom"){P+=" ("+this.parent.dc.view.zoomValue.n+")";this.parent.zoomChildIndex=O;}return{sel:Q,idx:O,cls:S,n:S,cmdid:S,name:P};},closePopup:function J(O){if(O){O.close();}},onmouseover:function N(S){var R=mstrmojo.dom.findAncestorByAttr(S.getTarget(),"cmdid",true,document.getElementById("mstrToolbarList")),U=R&&R.value,Q=this.parent,P=Q.exportPopup,O=Q.zoomPopup;if(U==="export"){this.onclick(S,R);this.closePopup(O);}else{if(U==="zoom"){this.onclick(S,R);this.closePopup(P);}else{if(U){this.closePopup(P);this.closePopup(O);}}}return false;},onclick:function L(P,U){P.cancel();var R=U||mstrmojo.dom.findAncestorByAttr(P.getTarget(),"cmdid",true,document.getElementById("mstrToolbarList")),W=R.node,Z=W.getAttribute("idx"),Q=R&&R.value,Y=this.parent,a=Y.dc,O=[],X=null;if(Q==="export"){if(!Y.exportPopup){O=this.items[Z].items;Y.exportPopup=E(O,Y,W);}var V=Y.exportPopup;V.autoPosition=false;X=W.getBoundingClientRect();if(!V.isOpen){V.offsetTop=-(X.height||W.offsetHeight);V.open();}}else{if(Q==="zoom"){if(!Y.zoomPopup){O=this.items[Z].items;Y.zoomPopup=F(O,Y,W);}var S=Y.zoomPopup;S.autoPosition=false;X=W.getBoundingClientRect();if(!S.isOpen){S.offsetTop=-(X.height||W.offsetHeight);if(S.hasRendered){C.call(this,S);}S.open();}}else{if(a[Q]){a[Q]();Y.close();}}}}}]}));}mstrmojo.ui.pathbar.PathHamburger=mstrmojo.declare(mstrmojo.Widget,null,{userName:null,init:function I(J){this._super(J);},scriptClass:"mstrmojo.ui.pathbar.PathHamburger",markupString:'<div id="mstrHamburger" mstrAttach:click class="mstrHamburgerButton" style="top:0"><div class="mstrHamburger path"></div></div>',popup:null,postBuildRendering:function A(){G.call(this);},onclick:function H(){var J=this.popup;if(!J.dc){J.dc=this.parent.dc;}if(!J.isOpen){if(J.hasRendered){B.call(this);}J.open();}}});}());(function(){mstrmojo.requiresCls("mstrmojo.ui.pathbar.PathPopup","mstrmojo.dom","mstrmojo.ListBase","mstrmojo._IsList","mstrmojo.ui.pathbar._PreAppExit");var D=mstrmojo.dom;function C(){this.addDisposable(this.pickerMenu=new mstrmojo.ui.pathbar.PathPopup({id:"mojoPathPickerMenu",cssClass:"mojoPathPicker",offsetLeft:-23,children:[{scriptClass:"mstrmojo.ui.pathbar.List",alias:"menuItems",preclick:function F(){this.parent.close();},items:null,getItemMarkup:function(){return'<a href="#" idx="{@idx}"><span>{@en@n}</span></a>';},getItemProps:function G(I,H){return{n:I.n,idx:H,href:I.href};}}]}));}mstrmojo.ui.pathbar.PathNavigation=mstrmojo.declare(mstrmojo.ListBase,[mstrmojo._IsList,mstrmojo.ui.pathbar._PreAppExit],{scriptClass:"mstrmojo.ui.pathbar.PathNavigation",icnCss:"pathNavigationRight",pickerMenu:null,init:function E(F){this._super(F);C.call(this);},onclick:function A(G){var H=this.pickerMenu;if(!this._super(G)){return false;}var K=G.target||D.eventTarget(G.hWin,G.e),I=D.findAncestorByAttr(K,"idx",true,this.domNode),F=I&&parseInt(I.value,10),J=this.items[F];if(J&&J.en&&J.items){if(H.targetNode!==I.node){H.set("targetNode",I.node);H.menuItems.set("items",J.items);}if(!H.isOpen){H.open();}}},getItemMarkup:function(F){if(F.items){return'<span class="tb{@n} mstrComboDown" idx="{@idx}"><a class="tb{@n}0 mstrIcon-tb {@en}" title="{@desc}" href="#"></a><span class="tb{@n}1 mstrPullArrow {@en}" title="{@desc}" menu="true"></span></span>';}if(F.visible===false){return"";}return'<a href="#" idx="{@idx}"><span title="{@desc}" class="tb{@n} mstrIcon-tb {@en}"></span></a>';},getItemProps:function B(G,F){return{n:G.n,idx:F,href:G.href,desc:G.desc,en:G.en?"":"disabled"};}});}());(function(){mstrmojo.requiresCls("mstrmojo.Button","mstrmojo.Container","mstrmojo.TabStrip");mstrmojo.ScrollingTabStrip=mstrmojo.declare(mstrmojo.TabStrip,null,{scriptClass:"mstrmojo.ScrollingTabStrip",markupString:'<div id="{@id}" class="mstrmojo-TabStrip mstrmojo-ScrollingTabStrip {@cssClass}" style="{@cssText}"><span></span><div class="c" style="position:relative; display:inline-block;"><div style="position:absolute;"></div></div><span></span></div>',markupSlots:{containerNode:function(){return this.domNode.childNodes[1].firstChild;},scrollNode:function(){return this.domNode.childNodes[1];},stripNode:function(){return this.domNode.childNodes[1].firstChild;},btnLeftNode:function(){return this.domNode.childNodes[0];},btnRightNode:function(){return this.domNode.childNodes[2];}},markupMethods:{onvisibleChange:function(){this.domNode.style.display=this.visible?"block":"none";if(this.visible){this.set("width",parseInt(this.width,10));}},onleftChange:function(){if(this.stripNode&&this.left!=null){this.stripNode.style.left=this.left+"px";}},onwidthChange:function(C){var E=this.scrollNode,B=this.stripNode;if(E&&B){var D=this,A=parseInt(this.width,10);if(isNaN(A)){return ;}window.setTimeout(function(){if(A<B.clientWidth){D.createScrBtn();A-=(D.btnsWidth||0);}D.updateScrBtn();if(mstrmojo.dom.isIE7&&B.clientWidth>0){B.style.width=B.clientWidth+7+"px";}E.style.width=A+"px";},0);}}},step:50,scroll:function(B){B=B||1;var D=this.scrollNode,A=this.stripNode,E=Math.abs(parseInt(this.left,10)||0),C=Math.max(A.clientWidth-E-D.clientWidth,0),F=Math.min(this.step,(B==-1?C:E));this.set("right",C);this.set("left",-(E-B*F));this.updateScrBtn();},createScrBtn:function(){if(this.btnLeft&&this.btnRight){return ;}var A=this;this.addChildren([{scriptClass:"mstrmojo.Button",cssClass:"l",alias:"btnLeft",visible:false,enabled:false,scrollInterval:null,onmousedown:function(){var B=this;this.scrollInterval=window.setInterval(function(D,C){A.scroll(1);if(A.left>=0){clearInterval(B.scrollInterval);}},60);},onmouseup:function(){clearInterval(this.scrollInterval);},slot:"btnLeftNode"},{scriptClass:"mstrmojo.Button",cssClass:"r",alias:"btnRight",visible:false,enabled:false,onmousedown:function(){var B=this;this.scrollInterval=window.setInterval(function(D,C){A.scroll(-1);if(A.right<=0){clearInterval(B.scrollInterval);}},60);},onmouseup:function(){clearInterval(this.scrollInterval);},slot:"btnRightNode"}]);this.renderChildren();this.btnsWidth=50;},updateScrBtn:function(){var F=this.scrollNode,B=this.stripNode,D=this.btnLeft,E=this.btnRight;if(F&&B&&D&&E){var H=Math.abs(parseInt(this.left,10)||0),G=B.clientWidth;E.set("enabled",G-H>F.clientWidth);D.set("enabled",H>0);var A=parseInt(this.width,10),C=A<G;this.btnLeft.set("visible",C);this.btnRight.set("visible",C);if(!C){this.set("left",0);}}}});})();(function(){mstrmojo.requiresCls("mstrmojo.dom","mstrmojo.DocButton");var B=mstrmojo.dom;mstrmojo.express.ui.DocButton=mstrmojo.declare(mstrmojo.DocButton,null,{scriptClass:"mstrmojo.express.ui.DocButton",premousedown:function A(C){if(B.getButton(C.hWin,C.e)===1){var E=this.id,D="pressed";this.set(D,true);B.attachOneTimeEvent(document,"mouseup",function(){var F=mstrmojo.all[E];if(F){F.set(D,false);}},true);}}});}());(function(){mstrmojo.requiresCls("mstrmojo.Arr","mstrmojo.Button","mstrmojo.HBox","mstrmojo.FishEye");var A=function(B){return mstrmojo.hash.copy(B,{scriptClass:"mstrmojo.Button",text:"",enabled:false,dir:"left",cssClass:"mstrmojo-icon left",onclick:function(){var D=this.parent.fishEyeList,C=D&&D.scroll(this.dir,D.step);}});};mstrmojo.FishEyeContainer=mstrmojo.declare(mstrmojo.HBox,null,{scriptClass:"mstrmojo.FishEyeContainer",cssClass:"mstrmojo-FishEyeContainer",selectedIndex:-1,setItems:function(B){this.fishEyeList.set("items",B);},setSelectedIndex:function(B){this.fishEyeList.set("selectedIndex",B);},scrollable:false,rightScrollbale:false,children:[A({bindings:{enabled:"!!this.parent.scrollable"}}),({scriptClass:"mstrmojo.FishEye",alias:"fishEyeList",items:mstrmojo.Arr.makeObservable([]),srcId:"obList"}),A({alias:"feScrollRight",cssClass:"mstrmojo-icon right",dir:"right",bindings:{enabled:"!!this.parent.rightScrollable"}})]});mstrmojo.css=mstrmojo.hash.copy({getStyleValue:function(D,E){var B=null;if(D.currentStyle){E=(E==="float"?"styleFloat":E);B=D.currentStyle[E];}if(document.defaultView&&document.defaultView.getComputedStyle){E=(E==="float"?"cssFloat":E);var C=document.defaultView.getComputedStyle(D,null);B=C?C[E]:null;}return B;},setStyleValue:function(D,F,E){var B=function(G){return !!(G&&(typeof G==="object")&&(typeof G.length==="number"));};if(B(F)&&B(E)){var C;for(C in F){D.style[F[C]]=E[C];}}else{D.style[F]=E;}}},mstrmojo.css);}());(function(){mstrmojo.requiresCls("mstrmojo.OBList","mstrmojo.ui._IsIncFetchList","mstrmojo.ui._HasScroller");var F=mstrmojo.array,A=mstrmojo.chart.model.enums.EnumDSSObjectType;function D(G){return{browseConfig:null,parent:G,next:function(J){var I=this.browseConfig;if(!I){return ;}I.blockBegin+=I.blockCount;var H={taskId:"searchMetadata",styleName:"MojoFolderStyle",blockBegin:I.blockBegin,blockCount:I.blockCount,includeAncestorInfo:true};if(I.folderLinksContextId){H.folderLinksContextId=I.folderLinksContextId;}if(I.includeObjectDesc){H.includeObjectDesc=I.includeObjectDesc;}if(I.rootFolderID){H.rootFolderID=I.rootFolderID;}else{if(I.rootFolderType){H.rootFolderType=I.rootFolderType;}}if(I.browsableTypes){H.objectType=I.browsableTypes;}if(I.searchPattern){H.searchPattern=I.searchPattern;if(I.recursive){H.recursive=I.recursive;}}this.parent.set("waiting",true);if(I.dataProvider){I.dataProvider.serverRequest(H,J);}else{mstrmojo.xhr.request("POST",mstrConfig.taskURL,J,H);}},hasNext:function(){var H=this.browseConfig;return(H.blockBegin+H.blockCount-1)<H.totalSize;}};}mstrmojo.mstr.ui.IncFetchOBList=mstrmojo.declare(mstrmojo.OBList,[mstrmojo.ui._IsIncFetchList,mstrmojo.ui._HasScroller],{scriptClass:"mstrmojo.mstr.ui.IncFetchOBList",cssClass:"mstrmojo-OBList mstrmojo-IF-OBList",makeObservable:true,renderOnScroll:false,waiting:false,markupString:'<div id="{@id}" class="mstrmojo-ListBase2 {@cssClass}" style="position:relative;{@cssText}" mstrAttach:keypress,mousedown,mouseup,dblclick><div class="scroll-box" style="{@scrollBoxCssText}"><div class="mstrmojo-ListBase2-itemsContainer" style="{@itemsContainerCssText}">{@itemsHtml}</div><div class="mstrmojo-ListBase2-dropCue {@cssClass}"><div class="mstrmojo-ListBase2-dropCue-inner"></div></div></div></div>',markupSlots:{scrollboxNode:function(){return this.domNode.firstChild;},itemsContainerNode:function(){return this.domNode.firstChild.firstChild;},dropCueNode:function(){return this.domNode.firstChild.lastChild;}},markupMethods:{onwaitingChange:function(){this.onwaitingChange();}},init:function E(G){if(this._super){this._super(G);}this.ifDataHelper=D(this);if(G.browseConfig){this.ifDataHelper.browseConfig=G.browseConfig;}},onwaitingChange:mstrmojo.emptyFn,addItems:function B(G){var H=this.browseConfig.browsableViewMedias;if(G&&H){var I={};F.forEach(H.split(","),function(J){I[parseInt(J,10)]=true;});G=F.filter(G,function(J){return(J.t!==A.DssTypeDocumentDefinition)||I[J.dvm];});}this.add(G,-1);this.set("waiting",false);if(this._super){this._super(G);}if(this.scrollNode){this.updateScrollbars();}},setupScrollNodes:function C(){this.scrollNode=this.scrollboxNode;}});}());(function(){mstrmojo.requiresCls("mstrmojo.css","mstrmojo._HasPopup","mstrmojo.string","mstrmojo.Pulldown","mstrmojo.Container");var C=mstrmojo.css;mstrmojo.CustomGroupEl=mstrmojo.declare(mstrmojo.Container,[mstrmojo._HasPopup],{scriptClass:"mstrmojo.CustomGroupEl",markupString:'<div id="{@id}" class="mstrmojo-onhoverparent mstrmojo-CustomGroupEl {@cssClass}" style="{@cssText}" mstrAttach:mouseover><div class="mstrmojo-CustomGroupEl-title {@cssClass}" mstrAttach:click><img class="mstrmojo-CustomGroupEl-state {@cssClass}" src="../images/1ptrans.gif" align="absmiddle" onclick="var w = mstrmojo.all[\'{@id}\']; w.set(\'state\', !w.state)" /><span class="mstrmojo-text"></span></div><div class="mstrmojo-onhover mstrmojo-abs mstrmojo-topright mstrmojo-CustomGroupEl-tools {@cssClass}"><img class="mstrmojo-dup" src="../images/1ptrans.gif" title="'+mstrmojo.desc(3397,"Duplicate")+'" onclick="mstrmojo.all[\'{@id}\'].dup()" /><img class="mstrmojo-ops" src="../images/1ptrans.gif"onclick="var w = mstrmojo.all[\'{@id}\'].showOps();" title="'+mstrmojo.desc(7932,"Element display options")+'" /><img class="mstrmojo-del" src="../images/1ptrans.gif" onclick="mstrmojo.all[\'{@id}\'].del()" title="'+mstrmojo.desc(7933,"Delete element")+'"/></div><div class="mstrmojo-CustomGroupEl-details {@cssClass}"><div class="mstrmojo-CustomGroupEl-expr {@cssClass}"></div><div class="mstrmojo-CustomGroupEl-expr-tools {@cssClass}"></div></div></div>',markupSlots:{stateNode:function(){return this.domNode.firstChild.firstChild;},titleNode:function(){return this.domNode.firstChild.lastChild;},detailsNode:function(){return this.domNode.lastChild;},exprNode:function(){return this.domNode.lastChild.firstChild;},exprToolsNode:function(){return this.domNode.lastChild.lastChild;},titlebarNode:function(){return this.domNode.firstChild;}},markupMethods:{ondataChange:function(){var G=this.data,F=G&&G.n;this.titleNode.innerHTML=(F!=null)?mstrmojo.string.encodeHtmlString(F):"";},onstateChange:function(){var F=this.stateNode;F.className="mstrmojo-CustomGroupEl-state "+(this.state?"opened":"closed");this.detailsNode.style.display=this.state?"block":"none";},onselectedChange:function(){C.toggleClass(this.domNode,["selected"],this.selected);},onshowaddChange:function(){this.exprToolsNode.style.display=this.showadd?"block":"none";}},_set_data:function A(H,F){var G=this.data;this.data=F;this.set("expr",F&&F.expr);return G!==F;},optionsRef:{scriptClass:"mstrmojo.Editor",title:mstrmojo.desc(7934,"Element Options"),contentNodeCssClass:"mstrmojo-balloon",cssClass:"mstrmojo-CGEOptionsEditor",help:"element_options_dialog_box.htm",ce:false,isp:false,onOpen:function(){var F=this.opener.data,G=this.ops.dsplb.dspl;G.set("value",F.ce?2:(F.isp?1:0));},save:function(){var F=this.ops.dsplb.dspl.value,G=this.opener.data;G.ce=(F==2);G.isp=(F==1);this.close();},children:[{scriptClass:"mstrmojo.VBox",cssClass:"mstrmojo-ElementOptions",alias:"ops",children:[{scriptClass:"mstrmojo.HBox",alias:"dsplb",children:[{scriptClass:"mstrmojo.Label",text:mstrmojo.desc(168,"Display:"),cssText:"margin: 0 5px;"},{alias:"dspl",scriptClass:"mstrmojo.Pulldown",itemIdField:"v",items:[{n:mstrmojo.desc(7935,"Display element name only (Default)"),v:0},{n:mstrmojo.desc(7936,"Display individual items only"),v:1},{n:mstrmojo.desc(7937,"Display element name and individual items"),v:2}]}]},{scriptClass:"mstrmojo.HBox",alias:"btns",cssText:"float:right;width:150px;margin:5px;",children:[{scriptClass:"mstrmojo.HTMLButton",alias:"ok",text:mstrmojo.desc(118,"Save"),cssClass:"mstrmojo-Editor-button",cssText:"width:72px;",onclick:function(){this.parent.parent.parent.save();}},{scriptClass:"mstrmojo.HTMLButton",alias:"cancel",text:mstrmojo.desc(221,"Cancel"),cssClass:"mstrmojo-Editor-button",cssText:"width:72px;margin: 5px;",onclick:function(){this.parent.parent.parent.close();}}]}]}]},showOps:function(){var G=this.titlebarNode,F=mstrmojo.dom.position(G,true);this.openPopup("optionsRef",{zIndex:30,left:Math.round(F.x+F.w-300)+"px",top:Math.round(F.y+F.h)+"px"});},init:function E(F){this._super(F);var G=this.data;if(G){delete this.data;this._set_data(null,G);}},del:function B(){var F=this.parent;if(F&&F.remove){F.remove(this.data);}},dup:function D(){var F=this.parent;if(F&&F.duplicate){var K=this.data,L=F.items,N=K.did,M=1,O=new RegExp(K.n+"_(\\d+)");for(var I=0,J=L.length;I<J;I++){var H=L[I],G=H.n&&H.n.match(O);if(G){M=Math.max(M,G[1]);}N=Math.max(N,parseInt(H.did,10));}F.duplicate(this.data,null,{n:mstrmojo.desc(3651,"Copy of ##").replace("##",K.n),did:F.getNextId(),state:1});}},onmouseover:function(F){this.set("showadd",this.state?true:false);}});})();(function(){var F=mstrmojo.string;function H(Q,R,K){var L,O,J,M=[],N,S;try{N=new RegExp(mstrmojo.string.regEscape(Q),"i");}catch(P){return M;}for(L=0,O=R.length;L<O;L++){J=R[L][K];N.lastIndex=0;if(N.test(J)){M.push(R[L]);}}return M;}function C(){if(this.searchEnabled){this.iconNode.style.display="none";this.inputBar.style.display="";if(this.autofocus){this.inputNode.focus();this.inputNode.select();}}else{this.hideInputNode();if(this.autofocus){if(mstrmojo.dom.isIE7||mstrmojo.dom.isIE8){var J=this;window.setTimeout(function(){try{J.iconNode.focus();}catch(K){}},100);}else{this.iconNode.focus();}}}}var G={8:"BackSpace",9:"Tab",13:"Enter",27:"Esc",38:"ArrowUp",40:"ArrowDown"};mstrmojo.SearchableDropDownList=mstrmojo.declare(mstrmojo.Pulldown,null,{scriptClass:"mstrmojo.SearchableDropDownList",markupString:'<div id="{@id}" class="mstrmojo-SearchableDropDownList mstrmojo-DropDownButton {@cssClass} {@direction}" style="{@cssText}"><div class="mstrmojo-DropDownButton-boxNode {@cssClass}-boxNode" title="{@title}"><div class="mstrmojo-DropDownButton-iconNode {@cssClass}-iconNode" tabindex="0" mstrAttach:mousedown,keyup>{@text}</div><table class="mstrmojo-InputNodeBar"><colgroup><col class="inputCol"/><col class="iconCol"/></colgroup><tr><td><input class="mstrmojo-SearchableDropDownList-inputNode" value="{@text}" placeholder="{@placeholderText}" mstrAttach:keyup,blur,click/></td><td><div class="mstrmojo-DropDownButton-iconNode {@cssClass}-iconNode" mstrAttach:mousedown></div></td></tr></table></div><div class="mstrmojo-DropDownButton-popupNode {@cssClass}-popupNode"></div></div>',markupSlots:mstrmojo.hash.copy(mstrmojo.Pulldown.prototype.markupSlots,{inputBar:function(){return this.domNode.firstChild.lastChild;},inputNode:function(){return this.domNode.firstChild.lastChild.rows[0].cells[0].firstChild;}}),markupMethods:mstrmojo.hash.copy({ontextChange:function(){this.iconNode.innerHTML=F.decodeHtmlString(this.text);this.inputNode.value=this.text;},onheightChange:function(){var J=parseInt(this.height,10);if(J>=0){this.domNode.offsetHeight=J+"px";this.inputBar.offsetHeight=J+"px";}}},mstrmojo.hash.copy(mstrmojo.Pulldown.prototype.markupMethods)),popupToBody:true,searchEnabled:false,selectedIndex:-1,placeholderText:"",allItems:null,autofocus:true,focus:function(){C.call(this);},hideInputNode:function B(){this.inputBar.style.display="none";this.iconNode.style.display="block";},postBuildRendering:function A(){if(!this.allItems){this.allItems=this.items;}this._super();C.call(this);},clickInput2pop:false,onclick:function I(J){if(this.clickInput2pop){this.togglePopup();}},prekeyup:function E(R){var K=this.getSearchPattern(),P=[],M,Q=this.inputNode,O=R.e,J,L,N=this.items.length;if(G[O.keyCode]==="Enter"){if(this.items.length>0){this.set("selectedIndex",this.selectedIndex===-1?0:this.selectedIndex);}this.onEnter&&this.onEnter();this.closePopup();return ;}else{if(G[O.keyCode]==="Esc"){this.onEsc&&this.onEsc();if(this.popupRef.visible){this.popupRef.close();}return ;}else{if(G[O.keyCode]==="ArrowDown"){if(!this.popupRef.visible){this.togglePopup();}this.set("selectedIndex",(this.selectedIndex+1)%N);}else{if(G[O.keyCode]==="ArrowUp"){if(this.popupRef.visible&&N>0){this.set("selectedIndex",(this.selectedIndex+N-1)%N);}}else{if(this.searchEnabled){if(K&&K.length>0&&K.indexOf(this.lastSearchPattern)>-1){P=H(K,this.items,this.itemField);}else{P=H(K,this.allItems,this.itemField);}this.set("selectedIndex",-1);this.set("items",P);N=P.length;if(N===0){this.closePopup();}else{if(!this.popupRef.visible){this.togglePopup();}}if(K&&K.length>0){this.set("selectedIndex",mstrmojo.array.find(P,this.itemField,Q.value));}}}}}}this.lastSearchPattern=K;},getSearchPattern:function D(){return F.trim(this.inputNode.value);}});}());(function(){mstrmojo.requiresCls("mstrmojo.Pulldown");var C={ENTER:13,LEFT:37,UP:38,TAB:9,RIGHT:39,DOWN:40,ESC:27};function D(L,M){var G,J,F,H=[],I,N;try{I=new RegExp(L,"i");}catch(K){I=new RegExp(mstrmojo.string.regEscape(L));}for(G=0,J=M.length;G<J;G++){if(I.test(M[G][this.itemField])){H.push(M[G]);}}return H;}function B(F){return !(F<0||F===undefined||F===null);}mstrmojo.SearchablePulldown=mstrmojo.declare(mstrmojo.Pulldown,null,{scriptClass:"mstrmojo.SearchablePulldown",popupCssClass:"mstrmojo-SearchablePulldown-Popup",searchEnabled:false,allowCustomInput:false,useItemCssOnInput:false,lastSearchPattern:"",isEditing:false,allItems:null,markupString:'<div id="{@id}" class="mstrmojo-SearchablePulldown mstrmojo-DropDownButton {@cssClass} {@direction}" style="{@cssText}"><div class="mstrmojo-SearchablePulldown-boxNode mstrmojo-DropDownButton-boxNode {@cssClass}-boxNode" title="{@title}" mstrAttach:mousedown><input class="mstrmojo-SearchablePulldown-inputNode" value="{@text}" mstrAttach:keyup,blur/><div class="mstrmojo-SearchablePulldown-iconNode mstrmojo-DropDownButton-iconNode {@cssClass}-iconNode" mstrAttach:mouseover,mouseout></div></div><div class="mstrmojo-DropDownButton-popupNode {@cssClass}-popupNode"></div></div>',markupSlots:{boxNode:function(){return this.domNode.firstChild;},inputNode:function(){return this.domNode.firstChild.firstChild;},iconNode:function(){return this.domNode.firstChild.children[1];},popupNode:function(){return this.domNode.lastChild;}},markupMethods:mstrmojo.hash.copy({ontextChange:function(){if(this.inputNode.value!==this.text){this.inputNode.value=this.text;}},onheightChange:function(){this.domNode.style.height=this.height||"";this.boxNode.style.height=this.height||"";},onsearchEnabledChange:function(){this.inputNode.readOnly=this.searchEnabled?false:true;this.items=this.allItems||this.items;},onallowCustomInputChange:function(){if(this.allowCustomInput){this.set("searchEnabled",true);}},onvalueChange:function E(){if(this.useItemCssOnInput&&this.selectedItem){this.inputNode.className="mstrmojo-SearchablePulldown-inputNode "+(this.selectedItem[this.itemCSS]||"");}}},mstrmojo.hash.copy(mstrmojo.Pulldown.prototype.markupMethods)),prevalueChange:function(){this.synchronize();},synchronize:function(){var G=this.value,H=this.items||[],I=H[this.selectedIndex],F=-1;if(I&&G===I[this.itemIdField]){this.selectedItem=I;this.set("text",I[this.itemField]);return ;}F=mstrmojo.array.find(this.items,this.itemIdField,G);if(!B(F)&&this.allowCustomInput){this.selectedItem=undefined;this.selectedIndex=undefined;return ;}this.selectedIndex=B(F)?F:this.defaultSelection;this.selectedItem=I=this.items[this.selectedIndex];this.value=I?I[this.itemIdField]:undefined;this.set("text",I?I[this.itemField]:(this.defaultText||""));},preBuildRendering:function A(){if(this._super){this._super();}this.allItems=this.allItems||this.items;this.synchronize();},premousedown:function(F){if(this.searchEnabled&&F.getTarget()===this.iconNode){this.set("items",this.allItems);}this._super(F);},onkeyup:function(M){var J=mstrmojo.string.trim(this.inputNode.value),I=M.e,N=I.keyCode||I.which,L=B(this.selectedIndex)?this.selectedIndex:-1,F=this.allowCustomInput,H=this.items.length;this.isEditing=true;switch(N){case C.ENTER:if(H>0&&!F){this.set("selectedIndex",L===-1?0:L);this.synchronize();}this.closePopup();break;case C.ESC:this.closePopup();this.synchronize();break;case C.UP:if(this.popupRef.visible&&H>0){this.set("selectedIndex",(L+H-1)%H);this.synchronize();}break;case C.DOWN:if(!this.popupRef.visible&&H>0){this.togglePopup();}this.set("selectedIndex",(L+1)%H);this.synchronize();break;default:if(J===this.lastSearchPattern){return ;}var K=[];if(J&&J.length>0&&J.indexOf(this.lastSearchPattern)>-1){K=D.apply(this,[J,this.items]);}else{K=D.apply(this,[J,this.allItems]);}this.set("items",K);if(K.length===0){this.closePopup();}else{if(!this.popupRef.visible){this.togglePopup();}}this.set("selectedIndex",undefined);if(J&&J.length){var G=mstrmojo.array.find(K,this.itemField,J);if(G!==-1){this.set("selectedIndex",G);}}}if(F&&!B(this.selectedIndex)){this.set("value",this.inputNode.value);}this.lastSearchPattern=J;},onblur:function(F){this.isEditing=false;if(!this.searchEnabled){return ;}if(!this.allowCustomInput){this.items=this.allItems;this.synchronize();}}});}());(function(){mstrmojo.requiresCls("mstrmojo.dnd","mstrmojo.ui._HasScroller","mstrmojo.DI.DIConstants");var f=mstrmojo.DI.DIConstants;function a(h){var k=document.createElement("div"),j=k.style,g=h.domNode;k.className="mstrmojo-DataGrid-avatar";j.height=g.clientHeight+"px";g.appendChild(k);h.avatar=k;return k;}function Q(g){var h=mstrmojo.dom.position(g.domNode,true);return h.x;}function O(g){return'<div class="mstrmojo-DataGrid-resizeHandle" unselectable="on" onselectstart="return false" rh="'+g+'"></div>';}function c(j){var h=j.getAttribute("rh"),g=h&&parseInt(h,10);return g;}function Z(h,l,g){var k=g.src,m=k&&k.data,j=m&&m.resizingIdx;if(!(j&&j>0)){return l&&l.apply(h,[g]);}}mstrmojo.RESIZE_NEXT_COLUMN_MODE={getRange:function G(k,j){var g=k.colSizeArray;var h=[-g[j-1]+k.minColWidth,(j==g.length-1)?g[j]-k.resizeHandleWidth-k.minColWidth:g[j]-k.minColWidth];return h;},updateSize:function F(k,j,h){var g=k.colSizeArray;g[j-1]=g[j-1]+h;g[j]=g[j]-h;},updateColumnWidth:function U(k,h,l,j){var g=k.colSizeArray;h[j-1].style.width=g[j-1]+"px";l[j-1].style.width=g[j-1]+"px";h[j].style.width=g[j]+"px";l[j].style.width=g[j]+"px";}};mstrmojo.RESIZE_ALL_COLUMN_MODE={getRange:function G(m,l){var n=m.minColWidth+m.resizeHandleWidth,g=m.colSizeArray,j=0;for(var k=l;k<g.length;++k){j+=g[k]-n;}var h=[-g[l-1]+n,j];return h;},updateSize:function F(k,o,h){var n=k.minColWidth+k.resizeHandleWidth,l=k.colSizeArray;l[o-1]=l[o-1]+h;var g=[];for(var j=0;j<l.length-o;++j){g[j]=o+j;}g.sort(function(q,r){return l[q]-l[r];});for(var j=0;j<g.length;++j){var p=h/(g.length-j);var m=l[g[j]];h-=(m>=p+n)?p:m-n;l[g[j]]=(m>=p+n)?m-p:n;}},updateColumnWidth:function U(l,h,m,k){var g=l.colSizeArray;for(var j=k-1;j<g.length;++j){h[j].style.width=g[j]+"px";m[j].style.width=g[j]+"px";}}};mstrmojo.RESIZE_CURRENT_COLUMN_MODE={getRange:function G(m,l){var n=m.minColWidth+m.resizeHandleWidth,g=m.colSizeArray,j=0;for(var k=l;k<g.length;++k){j+=g[k]-n;}var h=[-g[l-1]+n,j];return h;},updateSize:function F(k,j,h){var g=k.colSizeArray;g[j-1]=g[j-1]+h;},updateColumnWidth:function U(k,h,l,j){var g=k.colSizeArray;h[j-1].style.width=g[j-1]+"px";l[j-1].style.width=g[j-1]+"px";k.widgetResized();}};mstrmojo._CanResizeColumn=mstrmojo.provide("mstrmojo._CanResizeColumn",{draggable:true,dropZone:false,avatar:null,colSizeArray:null,resizableColumns:true,resizeHandleWidth:10,minColWidth:5,resizeColumnBehavior:mstrmojo.RESIZE_NEXT_COLUMN_MODE,createColSizeArray:function d(){var h,m,k,j,l,g;m=this.headerContainerNode;k=m&&m.getElementsByTagName("table")[0];j=k.rows[0].cells;h=[];for(l=0,g=j.length;l<g;l++){h.push(j[l].offsetWidth);}return h;},postBuildRendering:function W(){if(this._super){this._super();}if(this.avatar){this.domNode.appendChild(this.avatar);}this.colSizeArray=null;},getDragData:function E(g){var j=g.src,k=j.node,h=c(k);if(h&&h>0){return{resizingIdx:h,startingX:j.pos.x,baseX:Q(this)};}if(this._super){return this.dropZone&&this._super(g);}return null;},allowDrop:function K(g){var j=g.src,k=j&&j.data,h=k&&k.resizingIdx;if(h&&h>0){return true;}return this.dropZone;},ondragenter:function R(g){Z(this,this._super,g);},ondragover:function S(g){Z(this,this._super,g);},ondragleave:function B(g){Z(this,this._super,g);},ondrop:function X(g){Z(this,this._super,g);},isDragValid:function C(g){var j=g.src,k=j&&j.data,h=k&&k.resizingIdx;if(h&&h>0){return true;}if(this._super){return this._super(g);}return false;},ondragstart:function Y(g){var k=g.src,l=k&&k.data,j=l&&l.resizingIdx;if(j&&j>0){var h=this.avatar||a(this);this.ownAvatar=true;h.style.left=(l.startingX-l.baseX)+"px";h.style.display="block";document.body.style.cursor="col-resize";if(!this.colSizeArray){this.colSizeArray=this.createColSizeArray();this._firstTimeResize=true;}l.resizingRange=this.resizeColumnBehavior.getRange(this,j);return ;}if(this._super){this._super(g);}},ondragmove:function P(h){var p=h.src,j=p&&p.data,n=j&&j.resizingIdx;if(n&&n>0){var o=h.tgt,k=this.avatar,m=j.resizingRange,l=o.pos.x-j.startingX,g=Math.min(m[1],Math.max(l,m[0]));j.deltaX=g;if(k){k.style.left=(j.startingX-j.baseX+g)+"px";}}else{if(this._super){this._super(h);}}},ondragend:function L(l){var t=l.src,m=t&&t.data,q=m&&m.resizingIdx;if(q&&q>0){var g=this.titleColGroup,r=g&&g.childNodes,o=this.dataColGroup,p=o&&o.childNodes,k=r.length,n=this.colSizeArray,h=m.deltaX;this.resizeColumnBehavior.updateSize(this,q,h);if(this._firstTimeResize){var j;for(j=0;j<k;j++){r[j].style.width=n[j]+"px";p[j].style.width=n[j]+"px";}this._firstTimeResize=false;}else{this.resizeColumnBehavior.updateColumnWidth(this,r,p,q);}this.avatar.style.display="none";document.body.style.cursor="";this.ownAvatar=false;}else{if(this._super){this._super(l);}}}});mstrmojo.requiresCls("mstrmojo._CanResizeColumn","mstrmojo.ListMapperTable","mstrmojo.WidgetList");function J(j){var m=document.createElement("colgroup"),g=j.length,h,l;for(l=0;l<g;l++){var k=document.createElement("col");h=j[l];if(h.colWidth){k.style.width=h.colWidth+"px";}k.className=h.colCss||("col"+l);m.appendChild(k);}return m;}function I(h){var j=h._headerWidgets_,g=j&&j.length;if(g>0){var k;for(k=0;k<g;k++){j[k].destroy(true);}}}function A(l,g,k,n,h){var j=[],m=l.headerWidget;k=k?(" "+k):"";n=n||this._headerWidgets;h=h?(" "+h):' w="1"';j.push("<td"+k+">");if(g>0&&this.resizableColumns){j.push(O(g));}j.push('<div class="mstrmojo-DataGrid-headerText');j.push(l.headerCss?" "+l.headerCss:"");if(m){n.push(mstrmojo.hash.copy(m));j.push('"'+h+">");}else{j.push('">');}j.push(l.headerText||"&nbsp");j.push("</div>");j.push("</td>");return j.join("");}function b(g,o){var j,m,n,h,p,l,k=[];g=g||"_headerWidgets";o=o||"1";j=this[g];m=j.length;if(m>0){n=this.headerContainerNode.getElementsByTagName("div");h=mstrmojo.array.filter(n,function(q){return q.getAttribute("w")==o;});for(l=0;l<m;l++){j[l].placeholder=h[l].firstChild;j[l].dataGrid=this;p=mstrmojo.registry.ref(j[l]);p.render();k.push(p);}}this[g+"_"]=k;}mstrmojo.DataGrid=mstrmojo.declare(mstrmojo.WidgetList,[mstrmojo._CanResizeColumn,mstrmojo.ui._HasScroller],{scriptClass:"mstrmojo.DataGrid",banding:true,resizableColumns:true,columns:null,items:null,listMapper:mstrmojo.WidgetListMapperTable,lockHeader:false,contentWidth:"",renderHook:{},shouldDisableItem:function(){return false;},markupString:'<div id="{@id}" class="mstrmojo-DataGrid {@cssClass}" style="{@cssText}" mstrAttach:mousedown,mouseup><div class="mstrmojo-DataGrid-headerContainer">{@headerHtml}</div><div class="mstrmojo-DataGrid-itemsScrollBox" style="position:relative;"><div class="mstrmojo-DataGrid-itemsContainer" style="{@itemsContainerCssText}">{@itemsHtml}</div><div class="mstrmojo-ListBase2-dropCue"><div class="mstrmojo-ListBase2-dropCue-inner"></div></div></div></div>',markupSlots:{scrollboxNode:function(){return this.domNode.lastChild;},itemsContainerNode:function(){return this.domNode.lastChild.firstChild;},dropCueNode:function(){return this.domNode.lastChild.lastChild;},headerContainerNode:function(){return this.domNode.firstChild;},headerRows:function(){return this.domNode.firstChild.firstChild.rows;},bodyRows:function(){return this.domNode.lastChild.firstChild.firstChild.rows;}},markupMethods:{oncontentWidthChange:function(){var h=this.contentWidth,j=this.headerContainerNode,g=this.itemsContainerNode;if(h&&j&&g){j.style.width=h;g.style.width=h;}},onlockHeaderChange:function(){mstrmojo.css.toggleClass(this.domNode,"lockHeader",this.lockHeader);},onvisibleChange:function(){this.domNode.style.display=this.visible?this.cssDisplay:"none";}},setupScrollNodes:function M(){this.scrollNode=this.scrollboxNode;},itemFunction:function(j,g,h){var k=new mstrmojo.DataRow({columns:h.columns,data:j,disable:h.shouldDisableItem(j),idx:g,dataGrid:h,parent:h});return k;},preBuildRendering:function D(){var m=this.renderHook;if(m&&m.pre){m.pre.apply(this,[A]);}else{var h=this.columns,g=h.length,j=['<table class="mstrmojo-DataGrid-headerTable" cellspacing="0" cellpadding="0"><tr>'],l;this._headerWidgets=[];var k;for(k=0;k<g;k++){l=A.apply(this,[h[k],k]);j.push(l);}j.push("</tr></table>");this.headerHtml=j.join("");}if(this._super){this._super();}},postBuildRendering:function W(){if(this._super){this._super();}var j=this.renderHook;if(j&&j.post){j.post.apply(this,[J,b]);}else{b.apply(this);this.titleColGroup=J(this.columns);}var g=this.titleColGroup,o=g.cloneNode(true),l=this.headerContainerNode,n=l&&l.getElementsByTagName("table")[0],p=this.itemsContainerNode,m=this.scrollboxNode,k=this.domNode,h=p&&p.getElementsByTagName("table")[0];this.dataColGroup=o;if(n&&h){n.insertBefore(g,n.firstChild);h.insertBefore(o,h.firstChild);}if(this.lockHeader){m.style.height=k.offsetHeight-l.offsetHeight+"px";mstrmojo.dom.attachEvent(m,"scroll",function(q){l.style.left=-m.scrollLeft+"px";});}},refresh:function H(g){I(this);if(this._super){this._super(g);}},destroy:function e(g){I(this);this._super(g);},unrender:function V(l){var j=this._headerWidgets_,h=j&&j.length,g;if(h>0){var k;for(k=0;k<h;k++){g=j[k];if(g&&g.hasRendered){g.unrender(true);}}}this._super(l);}});mstrmojo.requiresCls("mstrmojo.css","mstrmojo.hash","mstrmojo.Container");mstrmojo.DataRow=mstrmojo.declare(mstrmojo.Container,null,{scriptClass:"mstrmojo.DataRow",cssClass:"mstrmojo-DataRow",dataTextCSSClass:"mstrmojo-DataRow-text",columns:null,disable:false,markupMethods:{onselectedChange:function(){mstrmojo.css.toggleClass(this.domNode,"selected",this.selected);}},buildDom:function(){this.children=[];var n=document.createElement("tr"),r=this.data,v=this.idx,h=this.dataGrid,o=this.cssClass,z=this.columns,g=this.children,k=this.disable,j,t=-1,x,u;n.setAttribute("id",this.id);if(h.banding){o+=(v%2==1)?" odd":" even";}n.className=o+(mstrmojo.string.isEmpty(r[h.itemDisplayField||"n"])?" empty-row":"")+(" "+r[h.itemCSSField||"itemCss"]||"")+(k?" disabled":"");var m,q;for(m=0,q=z.length;m<q;m++){x=z[m];u=(x.dataWidgetBuilder&&x.dataWidgetBuilder(r))||x.dataWidget;j=document.createElement("td");if(x.applyStyle2Cell&&x.colCss){j.setAttribute("class",x.colCss);}n.appendChild(j);if(u){j.setAttribute("w","1");t++;g.push(mstrmojo.hash.copy(u,{slot:"slot"+t,data:r,idx:v,dataGrid:h}));}else{if(x.dataFunction){j.innerHTML=x.dataFunction(r,v,h);}else{var l=mstrmojo.string.htmlAngles(r[x.dataField||"n"])||"&nbsp",p=x.tooltip?' title="'+l+'"':"";j.innerHTML='<div class="'+this.dataTextCSSClass+'" '+p+">"+l+"</div>";}}}this.initChildren();n.mstrmojoId=this.id;return n;},buildRendering:function N(){this._super();var l=this.domNode.childNodes,g=l.length,k={},j=0,m,h;for(h=0;h<g;h++){m=l[h];if(m.getAttribute("w")=="1"){k["slot"+j]=m;j++;}}this.addSlots(k);}});}());(function(){mstrmojo.requiresCls("mstrmojo.WidgetList","mstrmojo.dom","mstrmojo.TreeNodeSelector");var B=mstrmojo.dom,A={0:"closed",1:"opened",2:"leaf"};mstrmojo.TreeNode=mstrmojo.declare(mstrmojo.WidgetList,null,{scriptClass:"mstrmojo.TreeNode",markupString:'<li id="{@id}" class="mstrmojo-TreeNode {@cssClass}" style="{@cssText}" mstrAttach:mousedown,mouseover><div class="mstrmojo-TreeNode-div"><img class="mstrmojo-TreeNode-state" src="../images/1ptrans.gif" /><span class="mstrmojo-TreeNode-text {@textCssClass}"></span></div><ul class="mstrmojo-TreeNode-itemsContainer">{@itemsHtml}</ul></li>',markupSlots:{stateNode:function(){return this.domNode.firstChild.firstChild;},textNode:function(){return this.domNode.firstChild.lastChild;},itemsContainerNode:function(){return this.domNode.lastChild;}},markupMethods:{ontextChange:function(){this.textNode.innerHTML=mstrmojo.string.encodeHtmlString(this.text);},onstateChange:function(){this.stateNode.className="mstrmojo-TreeNode-state "+(A[this.state]||"closed");this.itemsContainerNode.style.display=(this.state===1)?"block":"none";},onselectedChange:function(){var D=this.selected?"addClass":"removeClass";mstrmojo.css[D](this.domNode.firstChild,["selected"]);},ondropCuePosChange:mstrmojo.WidgetList.prototype.markupMethods.ondropCuePosChange},renderOnScroll:false,listSelector:mstrmojo.TreeNodeSelector,premousedown:function C(D){var E=this._super(D),F=B.eventTarget(D.hWin,D.e);if(F===this.stateNode){if(this.state!==2){this.set("state",this.state===1?0:1);}}return E;},preclick:function(D){mstrmojo.dom.stopPropogation(D.hWin,D.e);},prechange:function(D){var E=this._super(D);if(E!==false){var F=this.tree;if(F&&F.onnodechange){F.onnodechange(D);}}return E;}});}());(function(){mstrmojo.requiresCls("mstrmojo.WidgetList","mstrmojo._IsDial");mstrmojo.WidgetDial=mstrmojo.declare(mstrmojo.WidgetList,[mstrmojo._IsDial],{scriptClass:"mstrmojo.WidgetDial"});})();(function(){mstrmojo.requiresCls("mstrmojo.dom","mstrmojo.ContextMenuItem","mstrmojo.WidgetList","mstrmojo.ListMapperTable");var H=false,B=20;function G(J,K){var L=J.itemsContainerNode;L.scrollTop=Math.min(Math.max(L.scrollTop+K,0),L.scrollHeight-L.offsetHeight);}function I(K,J){if(!K._scrollInter){var L=B*(J?-1:1);K._scrollInter=window.setInterval(function(){G(K,L);},50);}}function E(J){if(J._scrollInter){window.clearInterval(J._scrollInter);J._scrollInter=null;}}mstrmojo.ContextMenu=mstrmojo.declare(mstrmojo.WidgetList,null,{scriptClass:"mstrmojo.ContextMenu",zIndex:100,visible:true,makeObservable:true,markupString:'<div id={@id} class="mstrmojo-ContextMenu {@cssClass}" style="z-index: {@zIndex};{@cssText}"><div class="mstrmojo-CM-scrollup" onmousedown="mstrmojo.all.{@id}.onmousedownarrow(self, arguments[0], true)" onmouseup="mstrmojo.all.{@id}.onmouseuparrow(self, arguments[0], true)"onclick="mstrmojo.all.{@id}.onclickarrow(self, arguments[0], true)" ></div><div class="mstrmojo-CM-itemsContainer">{@itemsHtml}</div><div class="mstrmojo-CM-scrolldown" onmousedown="mstrmojo.all.{@id}.onmousedownarrow(self, arguments[0], false)" onmouseup="mstrmojo.all.{@id}.onmouseuparrow(self, arguments[0], false)"onclick="mstrmojo.all.{@id}.onclickarrow(self, arguments[0], false)" ></div></div>',markupSlots:{scrollupNode:function(){return this.domNode.firstChild;},itemsContainerNode:function(){return this.domNode.childNodes[1];},scrolldownNode:function(){return this.domNode.lastChild;}},markupMethods:{onvisibleChange:function(){var K=this.domNode,P=this.itemsContainerNode,N=this.scrollupNode,M=this.scrolldownNode;K.style.display=this.visible?"block":"none";if(this.visible){N.style.display="none";M.style.display="none";P.style.overflow="auto";P.style.height="auto";var J=mstrmojo.dom.windowDim().h,O=K.offsetHeight,L=K.offsetWidth;if(J<O){N.style.display="block";N.style.minWidth=L+"px";M.style.display="block";M.style.minWidth=L+"px";P.style.overflow="hidden";P.style.height=(J-42)+"px";}}},onleftChange:function(){this.domNode.style.left=(this.left!=null)?this.left:"";},ontopChange:function(){this.domNode.style.top=(this.top!=null)?this.top:"";}},listMapper:mstrmojo.WidgetListMapperTable,itemFunction:function C(N,J,L){if(!H){mstrmojo.requiresCls("mstrmojo.ContextMenuItem");H=true;}var K={data:N,parent:L,hasSubmenu:L._cmSource.hasSubmenu(N),dynamicUpdate:L.dynamicUpdate,_cmSource:L._cmSource,zIndex:L.zIndex,itemIdField:L.itemIdField,itemField:L.itemField,itemChildrenField:L.itemChildrenField,itemFunction:L.itemFunction},M=new mstrmojo.ContextMenuItem(K);return M;},onmousedownarrow:function A(L,K,J){I(this,J);},onclickarrow:function F(L,K,J){G(this,B*(J?-1:1));},onmouseuparrow:function D(L,K,J){E(this);}});})();(function(){mstrmojo.requiresCls("mstrmojo.css","mstrmojo.CheckBoxDIC");var B=mstrmojo.css,A=mstrmojo.dom;mstrmojo.MarkRowDIC=mstrmojo.declare(mstrmojo.CheckBoxDIC,null,{scriptClass:"mstrmojo.MarkRowDIC",cssClass:"mstrmojo-MarkRowDIC",onclick:function(){if(this.grayed){this.set("grayed",false);}this.set("checked",!this.checked);var E=this.group&&this.group.widgetsMap,D,C;if(this.markAll){for(D in E){if(E.hasOwnProperty(D)){C=E[D];if(C.checked!==this.checked){C.set("checked",this.checked);}}}}else{for(D in E){C=E[D];if(C.markAll&&C.checked!==this.checked){C.set("grayed",true);break;}}}},postBuildRendering:function(){if(this._super){this._super();}var C=this.openerNode;if(!this.markAll){A.attachEvent(this.domNode,"mouseover",function(D){B.addClass(C.parentNode,"markSelection");});A.attachEvent(this.domNode,"mouseout",function(D){B.removeClass(C.parentNode,"markSelection");});}}});})();(function(){mstrmojo.requiresCls("mstrmojo.HTMLButton","mstrmojo._HasContextMenu","mstrmojo.ContextMenu");mstrmojo.MenuButton=mstrmojo.declare(mstrmojo.Button,[mstrmojo._HasContextMenu],{preclick:function A(B){this.showContextMenu();},openPopupMenu:function(){this.showContextMenu();}});})();(function(){mstrmojo.requiresCls("mstrmojo.WidgetList","mstrmojo.WidgetTreeBuilder","mstrmojo.TreeNodeSelector");var E=false;mstrmojo.WidgetTree=mstrmojo.declare(mstrmojo.WidgetList,null,{scriptClass:"mstrmojo.WidgetTree",listBuilder:mstrmojo.WidgetTreeBuilder,listSelector:mstrmojo.TreeNodeSelector,renderOnScroll:true,itemIdField:"dssid",itemDisplayField:"n",itemIconField:"tp",itemChildrenField:"items",itemFunction:function D(L,I,J){if(!E){mstrmojo.requiresCls("mstrmojo.TreeNode");E=true;}var H=J.tree||J,K=new mstrmojo.TreeNode({data:L,state:0,parent:J,tree:H,multiSelect:J.multiSelect,text:L[J.itemDisplayField],textCssClass:H.item2textCss(L),items:L[J.itemChildrenField],itemIdField:J.itemIdField,itemDisplayField:J.itemDisplayField,itemIconField:J.itemIconField,itemChildrenField:J.itemChildrenField,itemFunction:J.itemFunction,listSelector:J.listSelector});return K;},item2textCss:function B(H){return H[this.itemIconField];},selectionParentNode:null,init:function F(H){this._super(H);this.selectionParentNode=this;this.tree=this;},clearTreeSelect:function A(){(this.selectionParentNode||this).clearSelect();},prechange:function G(H){var I=this._super(H);this.onnodechange(H);return I;},onnodechange:function C(I){if(!I){return ;}var J=mstrmojo.hash,M=this.selectionParentNode,L=I.src;if(L===M){if(J.isEmpty(L.selectedIndices)){L=this;this.selectionParentNode=this;}this.raiseEvent({name:"selectionChange",parentNode:L,parentNodeWas:M,added:I.added,removed:I.removed});}else{if(I.added&&I.added.length){var K=[];if(!J.isEmpty(M.selectedIndices)){K=mstrmojo.hash.keyarray(M.selectedIndices,true);M.clearSelect();}this.selectionParentNode=L;this.raiseEvent({name:"selectionChange",parentNode:L,parentNodeWas:M,added:I.added,removed:K});}else{}}}});})();(function(){mstrmojo.requiresCls("mstrmojo.TreeNode","mstrmojo._IsExprNode","mstrmojo.array","mstrmojo.dom","mstrmojo.css","mstrmojo.expr","mstrmojo._HasOwnAvatar");var F=mstrmojo.array,M=mstrmojo.expr,P=mstrmojo.dom,A=mstrmojo.css;function J(R,Q){var U=R.data,S=U&&U.nds;if(!S){return null;}if(Q){Q.sort(F.numSorter);}else{Q=R.sortSelectedIndices();}if(!Q.length){return null;}return{idxs:Q,nds:F.get(S,Q)};}function N(S){var R=S.ctxtBuilder,V=R&&R.itemWidgets,Q=V&&V[0],U=Q&&Q.data;if(U&&U.not&&(V.length>0)){delete U.not;Q.paint();}}mstrmojo.AndOrNode=mstrmojo.declare(mstrmojo.TreeNode,[mstrmojo._IsExprNode,mstrmojo._HasOwnAvatar],{scriptClass:"mstrmojo.AndOrNode",data:null,editable:false,prefixedAndOrEditable:false,markupString:'<div id="{@id}" class="mstrmojo-andor mstrmojo-AndOrNode {@cssClass}"  style="position:relative;{@cssText}" mstrAttach:mousedown><div class="mstrmojo-onhoverparent mstrmojo-andor-prefix" mstrAttach:click><span class="mstrmojo-textset mstrmojo-andor-prefix-text"></span><span class="mstrmojo-onhover-in mstrmojo-andor-tools {@cssClass}">{@_prefixAndOrToolsMarkup}</span></div><div class="mstrmojo-andor-top"></div><div class="mstrmojo-andor-contentsWrapper" style="position:relative"><div class="mstrmojo-andor-contents" style="position:relative;{@itemsContainerCssText}">{@itemsHtml}</div><div class="mstrmojo-ListBase2-dropCue mstrmojo-AndOrNode-dropCue {@cssClass}"><div class="mstrmojo-ListBase2-dropCue-inner mstrmojo-AndOrNode-dropCue-inner"></div></div></div><div class="mstrmojo-andor-bottom"></div></div>',markupSlots:{prefixHoverNode:function(){return this.domNode.firstChild;},prefixNode:function(){return this.domNode.firstChild.firstChild;},prefixAndOrToolsNode:function(){return this.domNode.firstChild.childNodes[1];},itemsContainerPrefix:function(){return this.domNode.childNodes[1];},itemsContainerNode:function(){return this.domNode.childNodes[2].firstChild;},dropCueNode:function(){return this.domNode.childNodes[2].lastChild;},itemsContainerSuffix:function(){return this.domNode.lastChild;},scrollboxNode:function(){return this.domNode;}},markupMethods:{onitemCntChange:function(){A.toggleClass(this.itemsContainerNode,["multi"],this.itemCnt>2);},onprefixedAndOrEditableChange:function(){A.toggleClass(this.prefixNode,["editable"],this.prefixedAndOrEditable);},ondataChange:function(){this.prefixNode.innerHTML=this.andOrTxt();},ondropCuePosChange:mstrmojo.TreeNode.prototype.markupMethods.ondropCuePosChange},multiSelect:true,itemIdField:null,init:function(Q){this._super(Q);this.markupString=this.markupString.replace("{@_prefixAndOrToolsMarkup}",this.getPrefixAndOrToolsMarkup());var R=this.data;if(R){delete this.data;this._set_data(null,R);}},itemCnt:0,postBuildRendering:function(){var Q;this.set("itemCnt",this.items.length);if(this._super){Q=this._super();}N(this);return Q;},preadd:function L(Q){if(this._super){this._super(Q);}this.set("itemCnt",this.items.length);N(this);},preremove:function O(Q){if(this._super){this._super(Q);}this.set("itemCnt",this.items.length);N(this);},_set_data:function(U,Q){var R=this.data,S=(R!==Q);if(S){this.data=Q;if(Q&&!Q.nds){Q.nds=[];}this.set("items",Q&&Q.nds);}return S;},isDragValid:function K(){return true;},isSelectableArea:function(Q){return false;},getDragData:function(Q){var S=this._super(Q);if(S&&!S.html){var R=S.et&&M.ET2TGT[S.et];S.html=R?S[R]&&S[R].n||"":S.n||"";}return S;},remove:function I(R,S){var Q=this._super(R);if(Q>-1){var U=S||this.suppressConsolidation;if(!U){this.consolidate(false);}}return Q;},move:function(R,Q){this.suppressConsolidation=true;var S;if(this._super){S=this._super(R,Q);}this.suppressConsolidation=false;return S;},consolidate:function E(){var V=this.parent;if(!V||!V.remove){return ;}var S=this.items,R=S&&S.length;if(R<2){var U=R?S[0]:null,Q=this.childIndex();if(U){V.add([U],Q);}V.remove(this.data);}},indent:function G(S,Q){var R=J(this,S);if(!R){return ;}this.remove(R.idxs,true);var X=R.nds,W=Q&&Q.fn||this.data&&this.data.fn,V={et:M.ET.ANDOR,nds:X,fn:W};if(X.length===2&&X[0].not){if(X[1].not){delete X[0].not;delete X[1].not;V.not=true;V.fn=(W===M.FN.AND?M.FN.OR:M.FN.AND);}else{var U=X[0];X[0]=X[1];X[1]=U;}}this.add([V],R.idxs[0]);this.consolidate(false);},outdent:function C(R){var S=this.parent,Q=S&&S.data;if(!Q||Q.et!==M.ET.ANDOR){return ;}var U=J(this,R);if(!U){return ;}this.remove(U.idxs,true);if(this.data.not){U.nds[0].not=true;}S.add(U.nds,this.childIndex());this.consolidate(false);},edit:function D(a,b,S){if(!a){return ;}var Z=this.data,Y=Z&&Z.fn,R=a.data,g=R&&R.not;if(!R){R={};a.data=R;}R.not=!!S;if(Y!==b){var Q=Z.nds;if(Q&&Q.length>2){var f=a.childIndex();if(f>0){this.indent([f-1,f],{fn:b});}}else{Z.fn=b;var W=this.ctxtBuilder,V=W&&W.itemWidgets;for(var U=0,X=(V&&V.length)||0;U<X;U++){var e=V[U];if(e){e.paint();}}}}else{a.paint();}},preclick:function H(Q){var S=null,R=P.eventTarget(Q.hWin,Q.e);if(R===this.prefixNode){}else{if(P.contains(this.prefixNode,R,true)){S="andor";}}Q.part=S;},createAvatar:function B(S){var R=document.createElement("div"),U=P.findWidget(S),Q=U.getAvatarNode&&U.getAvatarNode();if(!Q){Q=U.condNode.cloneNode(true);Q.style.boxSizing="border-box";Q.style.width=U.condNode.offsetWidth+"px";}R.appendChild(Q);A.addClass(R,U.avatarCssCls||"mstrmojo-FE mstrmojo-ConditionNode");R.style.zIndex=20;return R;},_ndsToMove:J});})();(function(){mstrmojo.requiresCls("mstrmojo.dom","mstrmojo.css","mstrmojo.hash","mstrmojo.fx","mstrmojo.TreeNode");var K=mstrmojo.dom,E={0:"closed",1:"opened",2:"leaf"},I=function(R,Q){var N=R.style,M,P,L,S,O;N.display="block";N.height="auto";M=R.offsetHeight;P=Q?M:0;L=Q?0:M;S=Q?"block":"none";N.overflow="hidden";O=new mstrmojo.fx.AnimateProp({target:R,props:{height:{start:L,stop:P,suffix:"px",fn:Math.round,ease:mstrmojo.ease.linear}},onEnd:function(){N.height="auto";N.display=S;},interval:30,duration:300});O.play();};mstrmojo.TreeBrowserNode=mstrmojo.declare(mstrmojo.TreeNode,null,{scriptClass:"mstrmojo.TreeBrowserNode",markupString:'<div id="{@id}" class="mstrmojo-TreeNode {@cssClass}" style="{@cssText}" mstrAttach:mousedown,mouseup,click,dblclick><div class="mstrmojo-TreeNode-div"><img class="mstrmojo-TreeNode-state" src="../images/1ptrans.gif" /><img class="mstrmojo-TreeNode-checkBox" src="../images/1ptrans.gif" /><span class="mstrmojo-TreeNode-text {@textCssClass}"></span></div><div class="mstrmojo-TreeNode-itemsContainer">{@itemsHtml}</div></div>',markupSlots:mstrmojo.hash.copy({displayNode:function(){return this.domNode.firstChild;},checkBoxNode:function(){return this.domNode.firstChild.childNodes[1];}},mstrmojo.TreeNode.prototype.markupSlots),markupMethods:mstrmojo.hash.copy({onstateChange:function(L){this.stateNode.className="mstrmojo-TreeNode-state "+(E[this.state]||"closed");if(this.tree.anim&&this.contentRetrieved&&!L){I(this.itemsContainerNode,this.state===1);}else{this.itemsContainerNode.style.display=(this.state===1)?"block":"none";}}},mstrmojo.TreeNode.prototype.markupMethods),blockBegin:1,allowUnlistedValues:false,contentRetrieved:false,_set_items:function(N,M){var L=this._super(N,M);if(L&&this.tree.anim){I(this.itemsContainerNode,true);}return L;},onstateChange:function J(){var L=this.tree;if(!this.contentRetrieved&&(this.state==1)){this.set("items",[L.loadingItemCreaterFunc()]);L.getContent(this,this.blockBegin);}else{if((this.state==1)&&L.onNodeExpand){L.onNodeExpand(this);}if((this.state==0)&&L.onNodeCollapse){L.onNodeCollapse(this);}}},toggleState:function G(){if(this.state!==2){this.set("state",this.state===1?0:1);}},preclick:function H(L){K.clearBrowserHighlights(L.hWin);return false;},predblclick:function D(L){K.clearBrowserHighlights(L.hWin);return false;},premousedown:function B(M){var R=mstrmojo.dom,O=mstrmojo.dom.eventTarget(M.hWin,M.e),L=this.tree,N=(this.state==2),Q=R.contains(this.itemsContainerNode,R.eventTarget(M.hWin,M.e),true,this.domNode),P=(L.branchClickPolicy==mstrmojo.TreeBrowserEnum.BRANCH_POLICY_TOGGLE);if((this.isSpecialNode()||!(O==this.checkBoxNode||((O==this.textNode||O==this.displayNode)&&(N||!P))))&&!this.draggable){R.stopPropogation(M.hWin,M.e);}if((O==this.stateNode)||((O==this.textNode||O==this.displayNode)&&!N&&P)){if(!N){this.toggleState();}}else{if(O==this.checkBoxNode||Q){if(this._super){this._super(M);}}else{this.handleNodeClicked();}}},isSpecialNode:function C(){var L=this.data&&this.data.st;return(L<0);},handleNodeClicked:function F(){var L=this.tree,M=this.parent,N=this.data;switch(N&&N.st){case"-4":mstrmojo.css.addClass(this.textNode,["loading"]);L.getContent(M,M.blockBegin-L.blockCount);break;case"-3":mstrmojo.css.addClass(this.textNode,["loading"]);L.getContent(M,M.blockBegin+L.blockCount);break;case"-1":case"-2":break;default:if(L.handleNodeClicked){L.handleNodeClicked(N);}}},init:function(L){this._super(L);this.set("state",this.tree.isBranch(this.data)?0:2);},postBuildRendering:function A(){if(this._super){this._super();}var L=function(M){K.preventDefault(window,M||window.event);return false;};K.attachEvent(this.domNode,"mousedown",L);if(this.isSpecialNode()||this.tree.noCheckBox){this.checkBoxNode.style.display="none";}}});})();(function(){mstrmojo.requiresCls("mstrmojo.Container","mstrmojo.hash","mstrmojo.dom","mstrmojo.css","mstrmojo.array","mstrmojo.SearchableDropDownList","mstrmojo._IsTableLayoutListDIC","mstrmojo.TableLayoutList","mstrmojo._IsInputControl","mstrmojo.DynamicClassFactory");var N=mstrmojo.DynamicClassFactory.newComponent,F=mstrmojo.hash,K=mstrmojo.array,I=mstrmojo.css,H=mstrmojo.dom,D=2,C=0,G=1,Q=2;mstrmojo.SearchableDropDownListForListDIC=mstrmojo.declare(mstrmojo.SearchableDropDownList,null,{scriptClass:"mstrmojo.SearchableDropDownListForListDIC",markupString:'<div id="{@id}" class="mstrmojo-SearchableDropDownList mstrmojo-DropDownButton {@cssClass} {@direction}" style="{@cssText}"><div class="mstrmojo-DropDownButton-boxNode {@cssClass}-boxNode" title="{@title}"><div class="mstrmojo-DropDownButton-iconNode {@cssClass}-iconNode" tabindex="0" mstrAttach:mousedown,keyup>{@text}</div><table class="mstrmojo-InputNodeBar"><colgroup><col class="inputCol"/><col class="iconCol"/></colgroup><tr><td><input class="mstrmojo-SearchableDropDownList-inputNode" value="{@text}" placeholder="{@placeholderText}" mstrAttach:keyup,blur,click/></td><td><div class="mstrmojo-DropDownButton-iconNode {@cssClass}-iconNode" mstrAttach:mousedown></div></td></tr></table></div><div class="mstrmojo-DropDownButton-popupNode {@cssClass}-popupNode"></div><div class="curtain"></div></div>',markupSlots:F.copy({popupNode:function(){return this.domNode.children[1];},disableCurtainNode:function(){return this.domNode.lastChild;}},F.copy(mstrmojo.SearchableDropDownList.prototype.markupSlots)),markupMethods:F.copy({onenabledChange:function(){I.toggleClass(this.disableCurtainNode,"disabled",!!this.enabled);}},F.copy(mstrmojo.SearchableDropDownList.prototype.markupMethods)),init:function O(R){this._super(R);this.popupRef.children[0].onmousedown=function(){var U=this.parent,S=U.opener;U.close();if(S){S.onPopupClosed();}};},postBuildRendering:function(){this.autofocus=false;this._super();},focus:function(){this.autofocus=true;this._super&&this._super();},onmousedown:function B(R){this._super&&this._super(R);if(H.isIE||H.isIEW3C){this.focus();}},openPopup:function(U,R){var S=this.parent.showByDefault;this[U].popupConfig=new mstrmojo.ui.PopupConfig({hostElement:this.popupNode,isHostedWithin:false});this._super(U,R);if(S){this.parent.setInfoWindowLock(true);}},togglePopup:function L(){if(this._super){this._super();}var S=this.popupRef.domNode;var Y=H.position(this.popupNode,true);if(S){var X=(window.getComputedStyle&&window.getComputedStyle(S,null))||S.currentStyle;var V=P(X.height);var U=P(X.marginTop)+P(X.borderTopWidth)+P(X.paddingTop)+P(X.paddingBottom)+P(X.borderBottomWidth)+P(X.marginBottom);var W=H.position(S,true);var R=H.windowDim();if(W.y<0){S.style.maxHeight=Math.min((Math.round(Y.y)-U),V)+"px";S.lastChild.style.maxHeight=S.style.maxHeight;}else{if(W.y+W.h>R.h){S.style.maxHeight=Math.min((Math.round(R.h-W.y)-U),(Math.round(Y.y)-U),V)+"px";S.lastChild.style.maxHeight=S.style.maxHeight;}}}},popupRef:F.copy({onClose:function(){var R=this.opener.parent.showByDefault;if(R){this.opener.parent.setInfoWindowLock(false);}}},F.clone(mstrmojo.SearchableDropDownList.prototype.popupRef)),onPopupClosed:mstrmojo.emptyFn});function M(S){var R=[];mstrmojo.array.forEach(S,function(U){R.push(U.n);});return R;}mstrmojo.TableLayoutListForListDIC=N(mstrmojo.TableLayoutList,[mstrmojo._IsTableLayoutListDIC],{scriptClass:"mstrmojo.TableLayoutListForListDIC",getItemMarkup:function(W,S){var V='<{@tag} class="item {@cls}" idx="{@idx}" title="{@en@n}" style="{@style}"><span class="item_bg"></span>{@en@n}</{@tag}>',R=this.getLeftEndTitle(S),U=this.getRightEndTitle(S),X=this.itemsPerRow;R='<td class="left_text" title="'+R+'">'+R+"</id>";U='<td class="right_text" title="'+U+'">'+U+"</id>";if(X>0){V=(S%X===0?"<tr>"+R:"")+"<td>"+V+"</td>"+((S+1)%X===0?U+"</tr>":"");}else{V='<td><div class="item_wrapper" idx="'+S+'">'+V+"</div></td>";if(!S){V="<tr>"+R+V;}else{if(S===this.items.length-1){V=V+U+"</tr>";}}}return V;},postvalueChange:function(){this._super&&this._super();if(this.parent&&this.parent.owner&&this.parent.owner.model){var R=this.parent.owner.model,S=R.getZoomFactor&&R.getZoomFactor()||1;this.zoomBackground(S,this.domNode.getElementsByClassName("item_bg"));}},postBuildRendering:function(){this._super&&this._super();I.toggleClass(this.domNode,"disabled",!this.enabled);if(this.parent&&this.parent.owner&&this.parent.owner.model){var U=this.parent.owner.model,V=U.getZoomFactor&&U.getZoomFactor()||1;if(V!==1){var R=this.domNode.getElementsByClassName("item_wrapper");for(var S=0;S<R.length;S++){R[S].parentNode.style.width=R[S].parentNode.offsetWidth*V+"px";}this.zoomStyle(V,this.domNode.getElementsByClassName("item_bg"),100,500);}}},});function J(W,X,S,V){var Y=X.ipr||0,U=X.mint||"",R=X.maxt||"";return{0:{scriptClass:"mstrmojo.SearchableDropDownListForListDIC",cssDisplay:"block",searchEnabled:S.length>=10,itemIdField:"v",fixWidth:true,fixHeight:true,postCreate:function(){var c=this.value||"",b=X.ipt||C,d=b===G?X.ust||"":"",Z=mstrmojo.array.find(S,"wbfv",c),a=mstrmojo.array.find(S,"v",c);if(b!==Q){Z=a;}if(Z===-1||V){c=(Z===-1&&a===-1)?c:undefined;if(Z===-1&&a===-1&&V){S=[{n:c||"",v:c||""}].concat(S);}else{S=[{n:d,v:c}].concat(S);}if(a!==-1){Z=a;}Z+=1;if(Z===0){this.unset=true;}}this.items=S;this.selectedIndex=Z;this.set("value",S[Z].v);if(this.parent.showByDefault&&this.searchEnabled){this.applyChange=function(){if(this.value!=this.parent.value){this.parent.set("value",this.value);}else{this.items=this.allItems;this.set("text",this.text);}};this.onvalueChange=function(){};if(H.isIE||H.isIEW3C){this.onPopupClosed=function(){this.applyChange&&this.applyChange();};}}},onblur:function(Z){this.applyChange&&this.applyChange();},onEnter:function(){this.applyChange&&this.applyChange();},onEsc:function(){this.items=this.allItems;this.set("value",this.parent.value);},getDisplayValue:function(){return this.items.length&&this.items[this.selectedIndex===-1?0:this.selectedIndex].n;},isPopupClosed:function(){return !(this.popupRef&&this.popupRef.visible);},bindings:{enabled:"this.parent.enabled"}},1:{scriptClass:"mstrmojo.TableLayoutListForListDIC",styleCssClass:"radio",itemsPerRow:Y,items:S,getDisplayValue:function(){return this.items[this.selectedIndex].n;},bindings:{enabled:"this.parent.enabled"}},2:{scriptClass:"mstrmojo.TableLayoutListForListDIC",styleCssClass:"check",delim:",",multiSelect:true,itemsPerRow:Y,items:S,getDisplayValue:function(){return"";},bindings:{enabled:"this.parent.enabled"}}}[W||0];}function P(R){var S=parseInt(R);return S===null||isNaN(S)?0:S;}mstrmojo.ListDIC=mstrmojo.declare(mstrmojo.Container,[mstrmojo._IsInputControl],{scriptClass:"mstrmojo.ListDIC",tabIndex:0,markupString:'<div class="mstrmojo-ListDIC {@cssClass}" tabIndex="{@tabIndex}" mstrAttach:focus></div>',markupSlots:{containerNode:function(){return this.domNode;}},markupMethods:{onwidthChange:function(){if(this.dicWidget&&this.width){this.dicWidget.set("width",this.width);}},onheightChange:function(){if(this.dicWidget&&this.height){this.dicWidget.set("height",this.height);}}},init:function(R){this._super(R);this.style=this.dic.st;this.items=this.getItems();this.set("children",[mstrmojo.hash.copy(J(this.style,this.dic,this.items,this.dic.ipt===D),{alias:"dicWidget",value:this.value,onvalueChange:function(){if(this.value!=this.parent.value){this.parent.set("value",this.value);}},itemName:function S(W,U,V){return W[V.itemField];}})]);if(this.dicWidget.setDirtyFlag){this.setDirtyFlag=function(V,U){this.dicWidget.setDirtyFlag(V,U);};}},getDisplayValue:function E(){var R=this.dicWidget.getDisplayValue();return(R!=null)?R:this.dv;},onfocus:function(R){this.focus();},focus:function(){var R=this;if(mstrmojo.dom.isIE){setTimeout(function(){R.dicWidget.focus&&R.dicWidget.focus();},10);}else{R.dicWidget.focus&&R.dicWidget.focus();}},postBuildRendering:function(){this._super();if(!mstrmojo.isDescendant(this.owner,this)&&this.showByDefault){this.dicWidget.set("height",(this.openerStyle.ih||0)+"px");this.dicWidget.set("width",(this.openerStyle.iw||0)+"px");}},applyChanges:function(){var R=this._super();if(this.canSlice){var U={type:parseInt(this.dic.ct,10),src:this.dic.k,ctlKey:this.dic.ckey,include:this.dic.include,tks:this.dic.tks,ck:this.dic.ck,disablePU:false};var S=this;window.setTimeout(function(){S.owner.model.sendTransactionUpdates(U);},0);}return this.style?R:this.dicWidget.isPopupClosed();},cleanup:function A(){if(!this.style){this.dicWidget.closePopup();}},isDicWidgetReady:function(){return this.dicWidget;}});})();(function(){mstrmojo.requiresCls("mstrmojo.Editor","mstrmojo.TextBox","mstrmojo.vi.ui._IsValidURL");mstrmojo.vi.ui.TextBoxURLEditor=mstrmojo.declare(mstrmojo.Editor,[mstrmojo.vi.ui._IsValidURL],{scriptClass:"mstrmojo.vi.ui.TextBoxURLEditor",showTitle:false,autoClose:true,cssClass:"textBoxURLEditor",model:null,docControl:null,children:[{scriptClass:"mstrmojo.TextBox",width:"400px",height:"43px",alias:"text",layoutConfig:{h:{inputNode:"43px",searchNode:"20px"},w:{inputNode:"100%",searchNode:"0px"},xt:true},onkeyup:mstrmojo.emptyFn()}],onOpen:function B(){var C=this;window.setTimeout(function(){C.text.inputNode.focus();},10);},onClose:function A(){var G=this.quill,D=G&&G.quillInstance,F=this.text,I=F.inputNode.value,E=G.hlText,H=E.index,C=E.length;if(G&&F&&I&&E){G.renderRVText();G.parent.hideControlOverlay();if(this.isValidURL(I)){D.formatText(H,C,"link",I);}G.updatedirCachDel();G.onUnselected();}if(this._super){this._super();this.destroy();}}});}());(function(){mstrmojo.requiresCls("mstrmojo.hash","mstrmojo.array","mstrmojo.css","mstrmojo.string","mstrmojo._HasPopup","mstrmojo.ListBase","mstrmojo.Popup","mstrmojo.Editor","mstrmojo.SuggestionList");function D(b,Y){var a=this.list,W=a.selectedIndex,V=a.items.length,X=b?V-1:0;if(W===X){a.clearSelect();return ;}if(W===null||W<0){W=b?0:V-1;}else{W+=b?1:-1;}if(Y){var Z=a.items[W];while(Z&&Z.type==="dummy"){if(W===X){a.clearSelect();return ;}W+=b?1:-1;Z=a.items[W];}}a.singleSelect(W);}mstrmojo._HasSuggestion=mstrmojo.provide("mstrmojo._HasSuggestion",mstrmojo.hash.copy(mstrmojo._HasPopup,{blockBegin:1,blockCount:-1,suggestCount:15,autoSelect:true,itemField:"n",candidates:null,suggestionShown:false,suggestionItems:null,_last_hit:null,_request_pattern:null,browseItemVisible:false,folderLinksContextId:25,browsableTypes:"1,8",REQUEST_THRESHOLD:20,noCache:false,disableClick:false,getCandidatesThroughTaskCall:mstrmojo.emptyFn,onSuggestionItemSelect:function J(V){this.hideSuggestion();},getSearchPattern:function U(){return"";},getSuggestionPos:function N(){return{left:"100px",top:"100px"};},getSuggestionTarget:function G(){return this;},showSuggestion:function B(W){var V=this.getSuggestion(W);if(!this.noCache&&V!==-1){this.updateSuggestion(V);}},hideSuggestion:function C(){this.suggestionShown=false;if(this.suggestionPopup.visible){this.suggestionPopup.close();}},getSelected:function M(){return(this.suggestionShown)?this._lastOpened.getSelected():null;},nextHighlight:function E(V){if(this.suggestionShown){this._lastOpened.nextHighlight(V);}},preHighlight:function H(V){if(this.suggestionShown){this._lastOpened.preHighlight(V);}},getSuggestion:function S(j){var e=this.candidates,b=e&&e.items,Y=e&&e.isComplete,h=this._last_hit;if(!this.noCache&&(e||h)){var g=this.filterCandidates(b,j,this.REQUEST_THRESHOLD),d=g.length,f=this.suggestCount,V=false;if(!Y&&d<f){var W=h&&h.pattern;if(h&&W&&(j.indexOf(W)>-1)){V=true;var l=this.filterCandidates(h.items,j,this.REQUEST_THRESHOLD),Z=l&&l.length,X=mstrmojo.array,k=this.itemField,a;for(a=0;a<Z;a++){if(X.find(g,k,l[a][k])===-1){g.push(l[a]);}}d=g.length;}}if(!Y&&((j.length>2&&d<this.REQUEST_THRESHOLD)||(d<f))){this.requestCandidates(j);return -1;}return(d<f)?g:g.slice(0,f);}this.requestCandidates(j);return -1;},requestCandidates:function A(V){this._request_pattern=V;var Y=this,W=this.getSuggestionTarget(),X={success:function(f){if(!f){return ;}var e=Y.getSuggestionTarget();if(!e||(W!==e)){return ;}var k=e.getSearchPattern(),b=f.items;Y._last_hit={items:b,pattern:V};Y.sz=f.sz;if(!Y.noCache&&b){var g=(Y.candidates&&Y.candidates.items)||[],h=[].concat(b),d=b.length,a;for(a=0;a<d;a++){var Z=h[a];if(mstrmojo.array.indexOf(g,Z)>-1){mstrmojo.array.removeItem(b,Z);}}if(Y.candidates){Y.candidates.items=g.concat(b);}}if((k||k==="")&&k.indexOf(V)>-1){var j=Y.filterCandidates(b,k);Y.updateSuggestion(j);}},failure:function(Z){if(Z.getResponseHeader){mstrmojo.alert(Z.getResponseHeader("X-MSTR-TaskFailureMsg"));}}};this.getCandidatesThroughTaskCall({pattern:V,blockBegin:this.blockBegin,blockCount:this.blockCount,isSuggest:true},X);},filterCandidates:function Q(Y,X,V){V=V||this.suggestCount;X=mstrmojo.string.regEscape(X);var Z=this.itemField,W=mstrmojo.array.filter(Y,function(a){return(new RegExp("\\s"+X+"|^"+X,"i")).test(a[Z]);},{max:V});return W;},getHighlightedText:function P(X,a){if(!this.highlightPattern||mstrmojo.string.isEmpty(X)){return a;}try{if(!this.nameWildcards||mstr.$A.find([2,32],parseInt(this.nameWildcards,10))>-1){a=a.replace(new RegExp("(^|\\s)("+X+")","gi"),"$1<b>$2</b>");}else{var Z=X.split(" "),W,V;for(W=0,V=Z.length;W<V;W++){if(Z[W]!==""){a=a.replace(new RegExp("("+Z[W]+")","gi"),"<b>$1</b>");}}}}catch(Y){}return a;},updateSuggestion:function O(Y){var W=Y&&Y.length,V=this.browseItemVisible;if(W||V){if(V){Y=Y||[];Y.push({n:"Browse...",t:-99,cssClass:(W?"br":"bro")});}this.set("suggestionItems",Y);if(this.suggestionShown){var X=this._lastOpened;if(X&&X.nudge){X.nudge();}if(this.autoSelect&&X){X.list.singleSelect(0);}}else{this.openPopup("suggestionPopup",this.getSuggestionPos());this.suggestionShown=true;}}else{this.hideSuggestion();}},ob:{scriptClass:"mstrmojo.Editor",title:mstrmojo.desc(5298,"Select an Object"),help:"Select_Objects_dialog_box_.htm",onClose:function(){var V=this.opener;if(V&&V.onBrowserClose){V.onBrowserClose();}},onOpen:function(){var V=this.opener;if(V&&V.onBrowserOpen){V.onBrowserOpen();}},children:[{scriptClass:"mstrmojo.ObjectBrowser",alias:"browser",fishEyeVisible:false,closeable:false,closeOnSelect:false}]},onBrowserClose:function L(){this.browserShown=false;},handleSuggestionItemSelect:function K(V,W){if(this.browseItemVisible&&V.t===-99){this.hideSuggestion();mstrmojo.requiresCls("mstrmojo.ObjectBrowser");var X=this.zIndex;this.openPopup("ob",{zIndex:(X&&(X+10))||110});this.ob.browser.browse(mstrmojo.hash.copy(W,{folderLinksContextId:this.folderLinksContextId,onSelectCB:[this,"onSuggestionItemSelect"],browsableTypes:this.browsableTypes}));this.browserShown=true;}else{this.onSuggestionItemSelect(V);}},highlightPattern:true,suggestionPopupCssClss:"",suggestionPopup:{scriptClass:"mstrmojo.Popup",cssClass:"mstrmojo-ObjectInputBox-suggest",autoClose:true,locksHover:true,nextHighlight:function(V){D.call(this,true,V);},preHighlight:function(V){D.call(this,false,V);},getSelected:function M(){var V=this.list;return V.items[V.selectedIndex];},onOpen:function I(){var V=this.opener;if(V){mstrmojo.css.addClass(this.domNode,V.suggestionPopupCssClss||"");if(V.autoSelect){this.list.singleSelect(0);}if(V.nudge){V.nudge(this);}}},onClose:function F(){this.list.clearSelect();var V=this.opener;if(V){V.suggestionShown=false;mstrmojo.css.removeClass(this.domNode,V.suggestionPopupCssClss||"");}}},suggestionListClass:"mstrmojo.SuggestionList",postApplyProperties:function R(){this.suggestionPopup.children=[{scriptClass:this.suggestionListClass,alias:"list",cssClass:"mstrmojo-suggest-list"}];}}));}());(function(){mstrmojo.requiresClsP("mstrmojo","Editor","HBox","Box","Button","dom","css","desc","hash","array");mstrmojo.requiresCls("mstrmojo.vi.controllers.CustomSortModeActionMgr");var R=mstrmojo.Button.newWebButton,G=mstrmojo.dom,Z=mstrmojo.css,J=mstrmojo.desc,M=mstrmojo.array,P=mstrmojo.hash,L=36,A=600;mstrmojo.requiresDescs(1442,221,5705,134);function I(){var e=this.vizBox=this.model.createVizBoxForCustomSort(this.nodeKey,{width:this.width,height:(parseInt(this.height)-L-this.spacer)+"px",left:"0px",top:this.spacer+"px"});this.visContainer.addChildren(e);var c=e.boxContent.controller,d=c.model.oid,f=d+"."+(this.oldNodeKey||this.srcViz.k),h=(c.getScrollPosition(f))||{x:0,y:0},g=d+"."+this.nodeKey;c.addScrollPosition(g,h.x,h.y);return e;}function O(){var d=this.titleContainerNode,c=d.style,e=G.position(d);if(e.w<A){c.width=A+"px";c.position="relative";c.left=(e.w-A)/2+"px";c.border="solid 1px rgba(68,70,73,0.2)";}}function V(){var e=G.position(mstrApp.rootCtrl.view.domNode),d=G.position(this.titleContainerNode),c=G.position(this.editorNode),f;if(e.w>=d.w){if(d.x<e.x){f=c.x-d.x;this.set("left",(e.x+f)+"px");}else{if(d.x+d.w>e.x+e.w){f=d.x+d.w-(c.x+c.w)+8;this.set("left",(e.x+e.w-c.w-f)+"px");}}}}function Q(){var c=this.editorNode.style;c.width=this.width;c.height=this.height;}function N(){this.vizBox.toggleBoxSelection(true);}function b(h){var e=this.actionMgr.getSlientActionsBefore();if(e.length>0){var f=M.map(e,function(j){return j&&j.submitAction;}),g=this.wrapCustomSortAction(f,false),d=this.srcViz,c={hideCancel:true};d.model.customSort(g,d.controller._getXtabCallback(d,P.copy(h)),c);}}function a(){var d=this.actionMgr.getContSlientActionsBefore(),c=this,e={success:function(f,h){if(d.length>0){var k=M.map(d,function(n){return n&&n.submitAction;}),m=c.wrapCustomSortAction(k,true),j=c.vizBox.boxContent,g={hideCancel:true,noUpdate:true,preserveStid:true,noDeltaXML:true},l=j.model.getDataService();l.submitUpdates(l.getUpdateTemplateAction(j.k,m),j.controller._getXtabCallback(j),g);}}};b.call(this,e);}mstrmojo.vi.ui.rw.CustomSortDisplayPanel=mstrmojo.declare(mstrmojo.Editor,null,{scriptClass:"mstrmojo.vi.ui.rw.CustomSortDisplayPanel",cssClass:"mstrmojo-CustomSortDisplayPanel",actionMgr:null,init:function S(c){this.actionMgr=new mstrmojo.vi.controllers.CustomSortModeActionMgr({csDisplayPanel:this});this._super(c);},postBuildRendering:function U(){this.getVizBox();var e=this._super();if(!this._listenerProc){var d=this,f=null,c=this._listenerProc=function(g){window.clearTimeout(f);f=window.setTimeout(function(){V.call(d);},150);};G.attachEvent(window,"resize",c);}return e;},destroy:function Y(c){if(this._listenerProc){G.detachEvent(window,"resize",this._listenerProc);}this._super(c);},children:[{scriptClass:"mstrmojo.HBox",slot:"titlebarNode",alias:"leftBox",cssClass:"left title",children:[{scriptClass:"mstrmojo.Label",text:J(5705,"Custom Sort")}]},{scriptClass:"mstrmojo.HBox",slot:"titlebarNode",alias:"urBox",cssClass:"left icons",children:[{scriptClass:"mstrmojo.Widget",markupString:'<div id="{@id}" class="icn {@cssClass}" mstrAttach:click></div>',alias:"undo",cssClass:"undo disabled",enabled:false,onclick:function(){if(this.enabled){var c=this.parent.parent;c.actionMgr.undo();}},bindings:{enabled:function(){return !!this.parent.parent.canUndo;}},onenabledChange:function(){Z.toggleClass(this.domNode,"disabled",!this.enabled);}},{scriptClass:"mstrmojo.Widget",alias:"redo",cssClass:"redo disabled",enabled:false,markupString:'<div id="{@id}" class="icn {@cssClass}" mstrAttach:click></div>',onclick:function(){if(this.enabled){var c=this.parent.parent;c.actionMgr.redo();}},bindings:{enabled:function(){return !!this.parent.parent.canRedo;}},onenabledChange:function(){Z.toggleClass(this.domNode,"disabled",!this.enabled);}}]},{scriptClass:"mstrmojo.HBox",slot:"titlebarNode",alias:"btnBox",cssClass:"btnBox",children:[R(J(1442,"OK"),function(){if(this.enabled){var c=this.parent.parent;c.removeCSViz(function(){b.call(c);c.close();},false);}},true,{alias:"savebtn",enabled:false,bindings:{enabled:function(){return this.parent.parent.canApply;}}}),R(J(134,"Apply"),function(){if(this.enabled){var c=this.parent.parent,d=c.actionMgr;a.call(c);d.appendHistUnsilentActions(d.getUnslientActionsBefore());d.reset();}},true,{enabled:false,bindings:{enabled:function(){return this.parent.parent.canApply;}}}),R(J(221,"Cancel"),function(){var c=this.parent.parent;c.removeCSViz(null,true);c.close();})]},{scriptClass:"mstrmojo.Box",alias:"visContainer",slot:"containerNode"}],oldNodeKey:null,nodeKey:null,vizBox:null,model:null,srcPanelKey:null,srcLayoutKey:null,srcViz:null,srcUnit:null,srcAxis:-1,getVizBox:function D(){return this.vizBox=this.vizBox||I.call(this);},setVizBoxPortalStateRestore:function K(){this.getVizBox().defn.ds=0;},onOpen:function H(){Q.call(this);O.call(this);N.call(this);V.call(this);var d=this.vizBox.boxContent,c=d.selCells||[];M.forEach(c,function(e){d.handleSelection({},null,e);d.clearHighlights();});},onClose:function E(){var d=this.vizBox,c=this.model;if(d.boxContent.cellHoverMgr.removeCue){d.boxContent.cellHoverMgr.removeCue();}mstrmojo.dnd.enable();delete this.actionMgr;delete this.silentMask;this.destroy();},removeCSViz:function F(h,g){var d=this.model,e,c;if(g){e={config:{silent:true}};}else{e={hideCancel:true};}e.style={params:{treesToRender:0}};e=P.copy({noUpdate:true,preserveStid:true,noDeltaXML:true},e);if(h){c={success:function(){h();}};}var f=d.getRemoveUnitAction(this.vizBox);f.clearTargets=true;d.getDataService().submitUpdates(f,c,e);},recreateCSVizForUndo:function X(n,m,p){var q=this.model,r=this.srcViz.model,o=r.getDataService(),d=q.getNextKey(),e,l=this;var c=q.getRemoveUnitAction(this.vizBox);c.clearTargets=true;e=[c];var f=0,g=n.length,k;if(f<g){k=n[f];f++;}e=e.concat(r.getCreateCSVizActions(this.srcUnit,this.srcAxis,d,k));var j=function(AA){var w=l.srcLayoutKey,u=l.srcPanelKey,x=AA.data,v=M.filterOne(x.layouts,function(AD){return AD.k===w;});q.controller.view.updateXtabStyles(w,v.xtabStyles);q.updateDefnCache(AA.defn,[d,u]);q.updateDataCache(x,q.getTargetDefn(d));l.oldNodeKey=l.nodeKey;l.nodeKey=d;l.vizBox.destroy();delete l.vizBox;l.setVizBoxPortalStateRestore();var AB=l.getVizBox();AB.render();var z=0,AC=(m||[]).length,t=function(){if(z<AC){m[z++].perform(false,t,true);}else{mstrApp.hideWait(true);var AE=l.actionMgr;if(AE.hasFailedSorts()){var AD=AE.getActionsCount()-AE.getFailedSortsCount();AE.actions.splice(AD);AE.pos=AD-1;l.updateStatus();AE.showFailedSortsAndReset();if(p&&p.fail){p.fail();}}else{if(p&&p.success){p.success();}}}};t();},h=function(){o.submitUpdates(e,{success:function(t,u){if(f<g){e=o.getUpdateTemplateAction(d,n[f]);f++;h();}else{j(t);}}},{style:{params:{treesToRender:3}},noUpdate:true,preserveStid:true,noDeltaXML:true,hideCancel:true});};h();},wrapCustomSortAction:function B(g,e){var f=this.srcUnit,d=e?1:this.srcAxis,c=1,h=this.srcViz.model.data.gts[((this.srcAxis===c)?"row":"col")+"SubPos"];return{act:"customSortAddActions",unitType:f.otp,unitId:f.id,axis:d,subTotalsPos:[h],actions:g};},maskSilently:function W(c){var f=this.silentMask;if(!f){var e=this.curtainNode,d=document.createElement("div");d.innerHTML=e.outerHTML;d.firstChild.style.zIndex=this.zIndex+1;d.firstChild.style.opacity="0";d.firstChild.style.display="none";f=this.silentMask=this.domNode.appendChild(d.firstChild);}f.style.display=c?"block":"none";},updateStatus:function C(){var c=this.actionMgr;this.set("canUndo",c.pos>=0);this.set("canRedo",(c.actions.length-1)>c.pos);this.set("canApply",c.getSlientActionsBefore().length>0);}});}());(function(){mstrmojo.requiresCls("mstrmojo.Editor","mstrmojo.Button","mstrmojo.ui.editors.controls.TwoColumnContainer");var C=mstrmojo.Button.newWebButton;function B(){if(this.onRename(this.renameBox.name.value)!==false){this.close();}}mstrmojo.ui.editors.RenameEditor=mstrmojo.declare(mstrmojo.Editor,null,{scriptClass:"mstrmojo.ui.editors.RenameEditor",cssClass:"mstrmojo-rename-editor",btnAlignment:"right",renameBox:undefined,renameText:"",helpText:undefined,title:mstrmojo.desc(5740,"Rename"),onRename:mstrmojo.emptyFn,init:function E(F){this._super(F);this.renameBox.name.value=this.renameText;this.helpStrNode.set("text",this.helpText);},postBuildRendering:function(){if(this._super){this._super();}this.renameBox.name.focus();},children:[{scriptClass:"mstrmojo.ui.editors.controls.TwoColumnContainer",width:"264px",col1Width:"35px",col2Width:"100%",alias:"renameBox",children:[{scriptClass:"mstrmojo.Label",text:mstrmojo.desc(2211,"Name:"),slot:"col1Node"},{scriptClass:"mstrmojo.TextBox",slot:"col2Node",alias:"name",onEnter:function A(){B.call(this.parent.parent);},getLayoutOffsets:function D(){return{h:0,w:2};}}]},{scriptClass:"mstrmojo.Label",autoHide:true,alias:"helpStrNode",cssClass:"helpString"}],buttons:[C(mstrmojo.desc(118,"Save"),function(){B.call(this.parent.parent);},true,{alias:"okBtn",bindings:{enabled:function(){return this.parent.parent.renameBox.name.value!=="";}}}),C(mstrmojo.desc(221,"Cancel"),function(){this.parent.parent.close();})]});}());(function(){mstrmojo.requiresCls("mstrmojo.array","mstrmojo.css","mstrmojo.string","mstrmojo.Box","mstrmojo.HBox","mstrmojo.Button","mstrmojo.Label","mstrmojo.TextArea","mstrmojo.Editor","mstrmojo.ui._HasScroller","mstrmojo.ui.ScrollableContainer");var D=mstrmojo.dom,C=mstrmojo.Button.newWebButton,E=mstrmojo.array,G=mstrmojo.css,H=mstrmojo.string;mstrmojo.vi.ui.editors.SQLCSIViewer=mstrmojo.declare(mstrmojo.Editor,[mstrmojo.ui._HasScroller],{scriptClass:"mstrmojo.vi.ui.editors.SQLCSIViewer",title:mstrmojo.desc(15619,"Query Details"),cssClass:"mstrmojo-charcoalboxe mstrmojo-SQLV mstrmojo-vi-ui-SQLV",csiText:"",copied:false,onOpen:function A(){this.set("copied",false);this.updateScrollbars();},oncsiTextChange:function F(J){this.content.csiTextLabel.set("text",H.encodeHtmlString(J.value));this.updateScrollbars();},setupScrollNodes:function B(){this.scrollNode=this.content.containerNode;},children:[{scriptClass:"mstrmojo.Box",alias:"content",cssClass:"mstrmojo-SQLV-content-container",cssText:"",markupString:'<div id="{@id}" class="mstrmojo-Box {@cssClass}" style="{@cssText}"><div class="scroll-container" style="overflow:hidden;"></div><textarea name="csi_text" style="position:absolute;top:0;right:10000px"></textarea></div>',markupSlots:{containerNode:function(){return this.domNode.firstChild;},csiInputNode:function(){return this.domNode.lastChild;}},slot:"containerNode",csiTextLabel:undefined,children:[{scriptClass:"mstrmojo.Label",alias:"csiTextLabel",allowHTML:false,text:""}]},{alias:"buttonBar",scriptClass:"mstrmojo.HBox",cssClass:"mstrmojo-Editor-buttonBar",slot:"buttonNode",children:[{alias:"successIcon",cssClass:"success-icon",scriptClass:"mstrmojo.Label",bindings:{visible:"this.parent.parent.copied"}},{alias:"successTooltip",cssClass:"notice-toaster-label",scriptClass:"mstrmojo.Label",text:mstrmojo.desc(15620,"Statement Copied to Clipboard"),bindings:{visible:"this.parent.parent.copied"}},C(mstrmojo.desc(14502,"Copy to Clipboard"),function I(){var M=this.parent.parent,L=M.content.csiInputNode;L.innerText=M.csiText;L.select();try{var K=document.execCommand("copy");M.set("copied",K);}catch(J){}},false,{cssClass:"copy-button",alias:"btnCopy"}),C(mstrmojo.desc(2102,"Close"),function I(){this.parent.parent.close();},false,{alias:"btnClose"})]}]});})();(function(){mstrmojo.requiresCls("mstrmojo.Button","mstrmojo.HTMLButton","mstrmojo.Label","mstrmojo.TextBox","mstrmojo.TextArea","mstrmojo.Table","mstrmojo.HBox","mstrmojo.Editor");function C(E,F){var D=this;if(mstrApp&&mstrApp.serverRequest){mstrApp.serverRequest(E,F,{silent:true});}else{mstrmojo.xhr.request("POST",D.path,F,E,undefined,D.XServer,D.baseParams);}}function A(H,I,G,D){var E=this,F={taskId:"createFolder",taskContentType:"json",folderID:H,name:I,description:G};C.call(E,F,D);}function B(E,I,F){if(!E){mstrmojo.alert(mstrmojo.desc(3380));return false;}var G=this,H=G.fId,D={success:function(J){G.contPanel.name.set("value","");G.contPanel.desc.set("value","");if(G.okFn){G.okFn(J,F);}},failure:function(J){var K="";if(J.getResponseHeader){K=J.getResponseHeader("X-MSTR-TaskFailureMsg");}else{if(J.message){K=J.message;}}K&&mstrmojo.alert(K);}};if(mstrApp.isSingleTier&&this.dp){this.dp.newFolder(H,E,I,D);}else{A.call(G,H,E,I,D);}}mstrmojo.NewFolderEditor=mstrmojo.declare(mstrmojo.Editor,null,{scriptClass:"mstrmojo.NewFolderEditor",cssClass:"mstrmojo-NewFolderEditor",title:mstrmojo.desc(663,"Create Folder"),help:"Create_a_new_folder.htm",navigateAfter:false,okFn:mstrmojo.emptyFn,path:mstrConfig.taskURL,fId:null,children:[{scriptClass:"mstrmojo.Table",cssClass:"mstrmojo-Input-Panel",rows:2,cols:2,alias:"contPanel",children:[{scriptClass:"mstrmojo.Label",cssClass:"mstrmojo-Name-Label",slot:"0,0",text:mstrmojo.desc(2211,"Name:")},{scriptClass:"mstrmojo.TextBox",slot:"0,1",value:mstrmojo.desc(8116,"New Folder"),alias:"name",cssClass:"mstrmojo-SaveAsEditor-nameInput"},{scriptClass:"mstrmojo.Label",cssClass:"mstrmojo-Desc-Label",slot:"1,0",text:mstrmojo.desc(1154,"Description:")},{scriptClass:"mstrmojo.TextArea",cssClass:"mstrmojo-SaveAsEditor-descInput",slot:"1,1",alias:"desc",rows:5}]},{scriptClass:"mstrmojo.HBox",alias:"btns",slot:"buttonNode",cssClass:"mstrmojo-Editor-buttonBar",children:[{scriptClass:"mstrmojo.Button",cssClass:"mstrmojo-WebButton hot",alias:"ok",text:mstrmojo.desc(1442,"OK"),onclick:function(){var E=this.parent.parent,G=E&&E.opener,D=E.contPanel.name.value,F=E.contPanel.desc.value;if(!B.call(E,D,F,E.navigateAfter)){E.close();}}},{scriptClass:"mstrmojo.Button",cssClass:"mstrmojo-WebButton",alias:"cancel",text:mstrmojo.desc(221,"Cancel"),onclick:function(){this.parent.parent.close();}}]}]});}());(function(){mstrmojo.requiresCls("mstrmojo.array","mstrmojo.css","mstrmojo.expr","mstrmojo.func","mstrmojo.string","mstrmojo.Box","mstrmojo.HBox","mstrmojo.TextBox","mstrmojo.Button","mstrmojo.Label","mstrmojo._HasLayout","mstrmojo.Editor","mstrmojo.ui.CheckList","mstrmojo.ui.ToggleButton","mstrmojo.mstr.EnumDSSXMLObjectTypes");mstrmojo.requiresDescs(10,1763,15120,15801);var L=mstrmojo.array,Z=mstrmojo.css,D=mstrmojo.dom,Q=mstrmojo.expr,U=mstrmojo.func,B=mstrmojo.string,R=mstrmojo.Button.newWebButton,b=mstrmojo.mstr.EnumDSSXMLObjectTypes;var W=mstrmojo.desc(1763,"Clear All");mstrmojo.vi.ui.IncCheckList=mstrmojo.declare(mstrmojo.ui.CheckList,[mstrmojo.ui._IsIncFetchList],{scriptClass:"mstrmojo.vi.ui.IncCheckList",allowUnlistedValues:false,cssClass:"elementsList",initElements:function Y(e){var d=this.ifDataHelper,c=this;if(!d){return ;}e=U.wrapMethods({success:function(f){c.clearSelect(true);c.set("items",[]);c.initScroll();c.addItems(f&&f.es);}},e);d.getItems(1,e,{hideFailureErr:true});},addItems:function N(c){this._super(c||[]);this.postAddItems();this.updateScrollbars();},postAddItems:mstrmojo.emptyFn});function F(c){return !L.filterOne(c.fs,function(d){return d.isbf&&(!!d.dtp?d.dtp:Q.mapBaseFormTypeToDataType(d.bftp))!==Q.DTP.CHAR;});}mstrmojo.vi.ui.ElementsBrowser=mstrmojo.declare(mstrmojo.Box,[mstrmojo._HasLayout],{scriptClass:"mstrmojo.vi.ui.ElementsBrowser",markupString:'<div id="{@id}" class="mstrmojo-Box mstrmojo-ui-vi-ElementsBrowser {@cssClass}" style="{@cssText}"><div></div><div></div><div></div></div>',markupSlots:{containerNode:function(){return this.domNode;},searchBoxNode:function(){return this.domNode.firstChild;},buttonPanelNode:function(){return this.domNode.childNodes[1];},elementListNode:function(){return this.domNode.childNodes[2];}},layoutConfig:{h:{searchBoxNode:"26px",buttonPanelNode:"36px",elementListNode:"100%"},w:{searchBoxNode:"100%",buttonPanelNode:"100%",elementListNode:"100%"},xt:true},onBrowseElementsFailure:mstrmojo.emptyFn,onUpdateBrowseElementsParams:mstrmojo.emptyFn,children:[{scriptClass:"mstrmojo.HBox",slot:"searchBoxNode",alias:"util",cssClass:"elemsBrowser-utils-bar",children:[{scriptClass:"mstrmojo.Box",cssClass:"eb-box-search",alias:"box",children:[{scriptClass:"mstrmojo.TextBox",alias:"searchBox",hint:mstrmojo.desc(10,"Search"),cssClass:"eb-searchBox",valueChangeDelay:300,onEnter:function I(){var d=this.value,c=this.parent.parent.parent;c.set("searchPattern",d);},onvalueChange:function P(){var d=this.value,c=this.parent.parent.parent;c.set("searchPattern",d);}},{scriptClass:"mstrmojo.Button",cssClass:"eb-searchBox-clear",text:"",onclick:function(){var c=this.parent.searchBox;c.set("value","");c.cleanUp();c.focus();},bindings:{visible:"(this.parent.searchBox.value || '').length > 0"}}]},{scriptClass:"mstrmojo.Label",text:mstrmojo.desc(15120,"View Selected"),cssClass:"eb-viewSelected",title:mstrmojo.desc(15120,"View Selected")},{scriptClass:"mstrmojo.ui.ToggleButton",alias:"toggleSelected",oncheckedChange:function J(){var c=this.parent.parent;c.onsearchPatternChange();}}]},{scriptClass:"mstrmojo.HBox",slot:"buttonPanelNode",alias:"buttonPanel",cssClass:"elemsBrowser-button-panel",children:[{scriptClass:"mstrmojo.Button",text:W,title:W,alias:"clearAllBtn",cssClass:"eb-clearAll",useRichTooltip:true,updateTooltipConfig:function V(){var c=D.position(this.domNode);this.richTooltip={content:mstrmojo.desc(16192,"This function is currently not supported for non-text elements in the searching result."),cssClass:"vi-info vi-tooltip-C",left:c.x+60,top:c.y+5};},onclick:function(){var d=this.parent.parent,f=d.elementList;f.clearSelect(false);var c=d.getLocalSearchItems(),e=d.itemIdField;d.onItemsSelectionChange({added:[],removed:c,itemIdField:e});L.removeItems(d.selectedItems,e,c);},showTooltip:function C(f,d){var c=this.parent.parent;if(!this.enabled&&!B.isEmpty(c.getSearchBox().value)&&!F(c.attribute)){mstrmojo._HasTooltip.showTooltip.call(this,f,d);}}},]},{scriptClass:"mstrmojo.vi.ui.IncCheckList",alias:"elementList",slot:"elementListNode",itemIdField:null,bindings:{ifDataHelper:"this.parent.ifDataHelper",itemIdField:"this.parent.itemIdField"},postAddItems:function(){var c=this.parent.selectedItems||[];this.setSelectedItems(c);}}],itemIdField:"v",ifDataSource:null,searchPattern:null,ifDataHelper:null,attribute:null,attributeId:null,selectedItems:[],init:function(c){this._super(c);this.set("ifDataHelper",new mstrmojo.mstr.DocElementDataHelper({source:this.ifDataSource}));if(this.ifDataSource&&this.attribute){this.onattributeChange();}this.elementList.attachEventListener("selectionChange",this.id,"onElementsListchange");},updateClearAllBtnState:function O(){this.buttonPanel&&this.buttonPanel.clearAllBtn.set("enabled",(B.isEmpty(this.getSearchBox().value)||F(this.attribute))&&(this.getLocalSearchItems().length>0));},onElementsListchange:function H(j){var h=j&&j.added||[],f=j&&j.removed||[],g=this.elementList.items,c=this.itemIdField;if(!this.selectedItems){this.selectedItems=[];}var e=this.selectedItems,d=[],k=L.get(g,f);L.removeItems(e,c,k);var l;L.forEach(h,function(m){l=g[m];if(l&&L.find(e,c,l[c])<0){e.push(l);d.push(l);}});this.updateClearAllBtnState();if(k.length>0||d.length>0){this.onItemsSelectionChange({added:d,removed:k,itemIdField:c});}},onItemsSelectionChange:mstrmojo.emptyFn,updateBrowseConfig:function K(){var e=this,j=this.attributeId,c=this.attribute,h=this.searchPattern,g=function(l,m){l.set("textValid",!m);l.domNode.title=B.encodeHtmlString(m,true);};if(!j){return ;}this.ifDataHelper.set("items",null);var d={attributeID:j};if(h&&h!==""){d.searchPattern=h;d.matchCase=false;d.otp=c.t||b.Attribute;}this.onUpdateBrowseElementsParams(d);this.ifDataHelper.set("browseConfig",d);var k=e.getSearchBox();this.elementList.initElements({success:function(l){g(k,"");},failure:function(q){var n=parseInt(q.code,10)+4294967296,p=2147762269,l=2147762227,m=2147762262,o=2147894808;if(n===l||n===m){g(k,"");}else{if(n!==p){var r=(n!==o)?e.onBrowseElementsFailure.bind(e):null;var t={shortDesc:mstrmojo.desc(15402,"This object is not available at this time."),longDesc:q.message},u={title:mstrmojo.desc(15403,"Invalid Object"),buttons:[R(mstrmojo.desc(13197,"Got it"),r,false)]};mstrmojo.error(t,undefined,u);g(k,"");}else{g(k,q.message);}}}});var f=this.util&&this.util.toggleSelected;if(f){f.checked=false;Z.toggleClass(f.domNode,"checked",false);}this.updateClearAllBtnState();},isObjSearchable:function E(c){return !(c&&c.t===b.Consolidation);},onattributeChange:function A(){var c=this.attribute;this.attributeId=c&&c.did;this.searchPattern=null;this.selectedItems=[];this.updateBrowseConfig();var e=this.getSearchBox(),d=this.isObjSearchable(c);if(e){e.set("enabled",d);e.set("hint",d?mstrmojo.desc(10,"Search"):mstrmojo.desc(15801,"Not searchable"));}},getSearchBox:function M(){var c=this.util,d=this.util&&this.util.box;return d&&d.searchBox;},onifDataSourceChange:function G(){this.ifDataHelper.set("source",this.ifDataSource);this.ifDataHelper.set("items",null);},onsearchPatternChange:function X(){var d=this.util&&this.util.toggleSelected;if(!d||!d.checked){this.updateBrowseConfig();}else{var c=this.getLocalSearchItems();this.elementList.clearSelect(true);this.elementList.set("items",[]);this.elementList.addItems(c);this.updateClearAllBtnState();}},getLocalSearchItems:function S(){var d=[],c;if(this.searchPattern&&this.searchPattern!==""){var e=this.searchPattern.toLowerCase();L.forEach(this.selectedItems,function(f){c=(f.n||"").toLowerCase();if(c.indexOf(e)>-1){d.push(f);}});}else{d=(this.selectedItems||[]).slice(0);}return d;},_set_selectedItems:function a(g,c){var f=this.selectedItems,e=this.itemIdField;c=c||[];this.selectedItems=c;this.updateClearAllBtnState();if(f.length!==c.length){return true;}var d=L.intersection(f,c,e);return d.length!==f.length;},onselectedItemsChange:function(){this.elementList.setSelectedItems(this.selectedItems);}});}());(function(){mstrmojo.requiresCls("mstrmojo.Editor","mstrmojo.Button","mstrmojo.Label","mstrmojo.Box","mstrmojo.ui.Checkbox","mstrmojo.ui.CheckList","mstrmojo.ui.editors.controls.TwoColumnContainer","mstrmojo.array");mstrmojo.requiresDescs(15677,15678,15679,15681,15682,15683,15684);var C=mstrmojo.Button.newWebButton,B={discard:0,open:2,closed:4};mstrmojo.vi.ui.editors.PromptOptionEditor=mstrmojo.declare(mstrmojo.Editor,null,{scriptClass:"mstrmojo.vi.ui.editors.PromptOptionEditor",cssClass:"mstrmojo-PromptOptionEditor-Editor",title:mstrmojo.desc(15681,"Change Prompt Option and Save"),help:null,optVal:B.open,children:[{scriptClass:"mstrmojo.Box",cssClass:"icon-box"},{scriptClass:"mstrmojo.Box",alias:"box",children:[{scriptClass:"mstrmojo.Label",cssClass:"prompt-confirm",text:mstrmojo.desc(15682,"We have detected that this dossier contains prompts. Please confirm your prompt option.")},{scriptClass:"mstrmojo.ui.editors.controls.TwoColumnContainer",col1Width:"20%",col2Width:"80%",cssClass:"chkBox",alias:"chkBox",children:[{scriptClass:"mstrmojo.ui.Checkbox",cssDisplay:"inline-block",slot:"col1Node",alias:"chk",oncheckedChange:function D(){var G=this.parent.parent,F=G.optPrompt,H=G.defaultLabel;F.set("visible",this.checked);H.set("visible",!this.checked);}},{scriptClass:"mstrmojo.Label",slot:"col2Node",text:mstrmojo.desc(15677,"Display prompt when opening this dossier")}]},{scriptClass:"mstrmojo.ui.CheckList",alias:"optPrompt",multiSelect:false,orientation:"v",selectedIndex:0,items:[{n:mstrmojo.desc(15678,"And use current answers as default answers"),v:B.open},{n:mstrmojo.desc(15679,"And discard current answers"),v:B.discard}]},{scriptClass:"mstrmojo.Label",alias:"defaultLabel",cssClass:"indent",text:mstrmojo.desc(15683,"It will use current answer as default answer")}]},{alias:"buttonBar",scriptClass:"mstrmojo.Box",slot:"buttonNode",children:[C(mstrmojo.desc(221,"Cancel"),function(){this.parent.parent.close();}),C(mstrmojo.desc(15684,"Confirm and Save"),function(){var G=this.parent.parent,H=G.box,F=H.chkBox.chk;G.optVal=F.checked?(H.optPrompt.selectedIndex===0?B.open:B.discard):B.closed;G.onSave();G.close();},true)]}],onOpen:function A(){var G=this.box,F=G.chkBox.chk,I=G.optPrompt,H=G.defaultLabel;F.set("checked",this.optVal!==B.closed);I.set("visible",F.checked);I.set("selectedIndex",this.optVal===B.discard?1:0);H.set("visible",!F.checked);H.set("enabled",false);},onSave:mstrmojo.emptyFn,onClose:function E(){this.destroy();}});mstrmojo.vi.ui.editors.PromptOptionEditor.OptValue=B;}());(function(){mstrmojo.requiresCls("mstrmojo.Editor","mstrmojo.Button","mstrmojo.Label","mstrmojo.List","mstrmojo.Pulldown","mstrmojo.ui.ButtonBar","mstrmojo.Box","mstrmojo.ui.Checkbox","mstrmojo.ui.CheckList","mstrmojo.ui.IconTooltipCheckList","mstrmojo.ui.LabelWithIconTooltip","mstrmojo.ValidationTextBox","mstrmojo.hash","mstrmojo.func","mstrmojo.desc","mstrmojo.css","mstrmojo.form","mstrmojo.date","mstrmojo.dom","mstrmojo.alert","mstrmojo.NumberFormat");mstrmojo.requiresDescs(6,7,295,3437,15153,15156,2879,2140,5212,5592,5374,1345,34,5875,29,32,6213,15581,15582,5876,35,15583,2696,18,15631,15632,15633,15634,2033,4604,2058,8378,15836,15837,15838,15839,15840,15841,15842,15843,15846,15847,15849,15948,15956);var H=mstrmojo.desc,P=mstrmojo.hash,R=mstrmojo.Button.newWebButton,X=mstrmojo.css,J={GENERAL:0,SECURITY:1,LAYOUT:2},A={ALL_CHAPTERS:0,CURRENT_CHAPTER:1,CURRENT_PAGE:2},O={FULL_PAGE:1,VISUALIZATIONS:2,BOTH:3},Q={DISABLE:0,ENABLE:1};var Y={range:A.CURRENT_CHAPTER,overviewViz:O.FULL_PAGE,paperHeight:"8.5",paperWidth:"11",pageOrientation:-1,mode:0,enableFooter:Q.ENABLE,enableHeader:Q.ENABLE,pdfPwd:"",selectedTabIndex:J.GENERAL,hideTabIndex:undefined};function F(){return true;}function U(){var c={},a=this.general,b=this.layout;c.range=a.exportChapters.chapterContent.getSelectedItem().v;c.overviewViz=this.singleVis?O.VISUALIZATIONS:a.exportIndiVis.checkbox.checked?O.BOTH:O.FULL_PAGE;c.pageOrientation=a.pageOrientation.oriCheckList.selectedItem.v;c.paperHeight=b.exportPages.paperSize.sizeOptions.getSelectedItem().eph;c.paperWidth=b.exportPages.paperSize.sizeOptions.getSelectedItem().epw;c.pageOrientation=b.pageOrientation.oriCheckList.selectedItem.v;c.mode=0;c.enableHeader=b.pdfHeader.checkbox.checked?Q.ENABLE:Q.DISABLE;c.enableFooter=b.pdfFooter.checkbox.checked?Q.ENABLE:Q.DISABLE;c.pdfPwd="";return c;}function B(c){var a=this.general,b=this.layout;this.exOpts=c;a.exportChapters.chapterContent.set("selectedIndex",W(M,c.range));a.exportIndiVis.checkbox.set("checked",c.overviewViz===O.BOTH);a.pageOrientation.oriCheckList.set("selectedIndex",W(N,c.pageOrientation));b.exportPages.paperSize.sizeOptions.set("selectedIndex",W(I,L(c.paperWidth,c.paperHeight)));b.pageOrientation.oriCheckList.set("selectedIndex",W(N,c.pageOrientation));b.pdfHeader.set("checked",c.enableHeader===Q.ENABLE);b.pdfFooter.set("checked",c.enableFooter===Q.ENABLE);}var M=[{n:H(2058,"All"),v:A.ALL_CHAPTERS},{n:H(15846,"Current Chapter"),v:A.CURRENT_CHAPTER}];var I=[{n:H(1345,'A3 11.69" x 16.54"'),eph:"11.69",epw:"16.54"},{n:H(34,'A4 8.27" x 11.69"'),eph:"8.27",epw:"11.69"},{n:H(5875,'A5 5.83" x 8.27"'),eph:"5.83",epw:"8.27"},{n:H(29,'Letter 8.5" x 11"'),eph:"8.5",epw:"11"},{n:H(32,'Legal 8.5" x 14"'),eph:"8.5",epw:"14"},{n:H(6213,'Ledger 11" x 17"'),eph:"11",epw:"17"},{n:H(15581,'B4 13.9" x 9.8"'),eph:"13.9",epw:"9.8"},{n:H(15582,'B5 9.8" x 6.9"'),eph:"9.8",epw:"6.9"},{n:H(5876,'Executive 7.25" x 10.5"'),eph:"7.25",epw:"10.5"},{n:H(35,'Folio 8.5" x 13"'),eph:"8.5",epw:"13"},{n:H(15583,'Statement 5.5" x 8.5"'),eph:"5.5",epw:"8.5"}];var N=[{n:H(4604,"Auto"),tx:true,css:"pdfAuto",v:-1},{n:H(6,"Portrait"),css:"pdfPortrait",v:0},{n:H(7,"Landscape"),css:"pdfLandscape",v:1}];function L(b,a){if(parseFloat(b)<parseFloat(a)){return{eph:b,epw:a};}return{eph:a,epw:b};}function W(b,c){var a=0;if(typeof c==="object"){var d=P.keyarray(c);P.forEach(b,function(f,e){if(P.equals(P.copyProps(d,f),c)){a=e;return false;}});}else{P.forEach(b,function(f,e){if(f.v===c){a=e;return false;}});}return parseInt(a);}function E(a){return{scriptClass:"mstrmojo.Box",alias:"pageOrientation",cssClass:"page-orientation",bindings:{visible:"this.parent.parent.basic||this.parent.parent.tabBar.tabs.selectedIndex===2"},children:[{scriptClass:"mstrmojo.Label",text:H(2879,"Orientation")},{scriptClass:"mstrmojo.ui.ButtonBar",renderOnScroll:false,showIcon:true,alias:"oriCheckList",selectedIndex:W(N,a.exOpts.pageOrientation),items:N,postselectionChange:function(b){a.exOpts.pageOrientation=this.selectedItem.v;a.raiseEvent({name:"updateOrientation"});}}]};}function D(c,a){var b=this;return[{scriptClass:"mstrmojo.Box",alias:"tabBar",cssClass:"tabBar",children:[{scriptClass:"mstrmojo.ui.ButtonBar",renderOnScroll:false,showIcon:false,alias:"tabs",selectedIndex:J.GENERAL,postselectionChange:function(d){var h=this.parent.parent,e=h.tabBar.tabs.selectedItem.v,g=[h.general,h.security,h.layout];for(var f=0;f<g.length;f++){g[f].set("visible",f+1==e);}},items:[{n:H(295,"General"),v:J.GENERAL+1},{n:H(2696,"Security"),v:J.SECURITY+1},{n:H(3437,"Layout"),v:J.LAYOUT+1}]}]},{scriptClass:"mstrmojo.Box",alias:"general",cssClass:"general",children:[{scriptClass:"mstrmojo.Box",alias:"exportChapters",cssClass:"mstrmojo-Pulldown-Box",children:[{scriptClass:"mstrmojo.Label",text:H(5374,"Content")},{scriptClass:"mstrmojo.ui.Pulldown",alias:"chapterContent",selectedIndex:W(M,c.range),items:M}]},{scriptClass:"mstrmojo.Box",alias:"exportIndiVis",cssClass:"mstrmojo-CheckBoxes-Box",bindings:{visible:"!this.parent.parent.basic"},children:[{scriptClass:"mstrmojo.CheckBox",alias:"checkbox",checked:c.overviewViz===O.BOTH?true:false,label:"",oncheckedChange:function(){c.overviewViz=this.checked?O.BOTH:O.FULL_PAGE;}},{scriptClass:"mstrmojo.ui.LabelWithIconTooltip",text:H(15849,"Export Individual Visualizations"),alias:"iconTooltipLabel",iconCss:"info-icon",tooltip:H(15836,"Visualizations will be exported individually on separate pages.")}]},this.orientationSettings,]},{scriptClass:"mstrmojo.Box",alias:"security",cssClass:"security",visible:false},{scriptClass:"mstrmojo.Box",alias:"layout",cssClass:"layout",visible:false,children:[{scriptClass:"mstrmojo.Box",alias:"exportPages",cssClass:"mstrmojo-Pulldown-Box",children:[{scriptClass:"mstrmojo.Box",alias:"paperSize",children:[{scriptClass:"mstrmojo.Label",text:H(15156,"Paper Size")},{scriptClass:"mstrmojo.ui.Pulldown",alias:"sizeOptions",selectedIndex:W(I,L(c.paperWidth,c.paperHeight)),items:I}]}]},this.orientationSettings,{scriptClass:"mstrmojo.Label",cssClass:"wrap",text:H(15839,"Header and Footer")},{scriptClass:"mstrmojo.Box",alias:"pdfHeader",cssClass:"mstrmojo-CheckBoxes-Box",children:[{scriptClass:"mstrmojo.CheckBox",alias:"checkbox",checked:c.enableHeader===Q.ENABLE?true:false,label:"",oncheckedChange:function(){c.enableHeader=this.checked?Q.ENABLE:Q.DISABLE;}},{scriptClass:"mstrmojo.ui.LabelWithIconTooltip",text:H(2033,"Header"),alias:"iconTooltipLabel",iconCss:"info-icon",tooltip:H(15956,"Display the dossier, chapter, and page name on every page.")}]},{scriptClass:"mstrmojo.Label",text:""},{scriptClass:"mstrmojo.Box",alias:"pdfFooter",cssClass:"mstrmojo-CheckBoxes-Box",children:[{scriptClass:"mstrmojo.CheckBox",alias:"checkbox",checked:c.enableFooter===Q.ENABLE?true:false,label:H(15948,"Page Numbers"),oncheckedChange:function(){c.enableFooter=this.checked?Q.ENABLE:Q.DISABLE;}}]}]},{scriptClass:"mstrmojo.Box",alias:"buttonNode",slot:"buttonNode",children:[R(H(2140,"Cancel"),function(){this.parent.parent.close();}),R(b.exportDisplayText,function(){var d=this.parent.parent;if(!F.call(d)){return ;}var e=U.call(d);d.exOpts=e;d.exportHandler(e);d.close();},true),R(H(8378,"Advanced Settings"),function(){a=!a;this.parent.parent.set("basic",a);this.parent.parent.toggleMode();this.set("text",a?H(8378,"Advanced Settings"):H(15840,"Basic Settings"));},false,{cssClass:"togglerBtn"+(this.singleVis?" hidden":"")})]}];}function V(b){var a=P.copy(Y);if(typeof b==="object"){if(b.hasOwnProperty("range")){a.range=parseInt(b.range);}if(b.hasOwnProperty("overviewViz")){a.overviewViz=parseInt(b.overviewViz);}if(b.hasOwnProperty("paperHeight")){a.paperHeight=b.paperHeight.toString();}if(b.hasOwnProperty("paperWidth")){a.paperWidth=b.paperWidth.toString();}if(b.hasOwnProperty("pageOrientation")){a.pageOrientation=parseInt(b.pageOrientation);}if(b.hasOwnProperty("mode")){a.mode=parseInt(b.mode);}if(b.hasOwnProperty("enableFooter")){a.enableFooter=parseInt(b.enableFooter);}if(b.hasOwnProperty("enableHeader")){a.enableHeader=parseInt(b.enableHeader);}if(b.hasOwnProperty("pdfPwd")){a.pdfPwd=b.pdfPwd.toString();}if(b.hasOwnProperty("selectedTabIndex")){a.selectedTabIndex=parseInt(b.selectedTabIndex);}a.hideTabIndex=b.hideTabIndex;}return a;}mstrmojo.vi.ui.editors.ExportPDFEditor=mstrmojo.declare(mstrmojo.Editor,null,{scriptClass:"mstrmojo.vi.ui.editors.ExportPDFEditor",cssClass:"mstrmojo-ExportPDFEditor",title:H(5212,"Export to PDF"),help:"intro_export_dossier.htm",exportHandler:mstrmojo.emptyFn,exportDisplayText:H(5592,"Export"),basic:true,singleVis:false,exOpts:Y,orientationSettings:undefined,useCache:false,zIndex:12,init:function S(a){this._super(a);this.basic=!this.singleVis;this.exOpts=V.call(this,a.exOpts);this.orientationSettings=E(this,this);this.set("children",D.call(this,this.exOpts,this.basic));this.attachEventListener("updateOrientation",this.id,function(){var b=W(N,this.exOpts.pageOrientation);this.general.pageOrientation.oriCheckList.set("selectedIndex",b);this.layout.pageOrientation.oriCheckList.set("selectedIndex",b);});},updatePopupConfig:function K(a,b){B.call(this,this.exOpts);},onOpen:function G(){var b=this.exOpts,a=this.tabBar.tabs.itemsContainerNode.childNodes;if(b.hideTabIndex!==undefined&&0<=b.hideTabIndex&&b.hideTabIndex<a.length){X.addClass(a[b.hideTabIndex],"hidden");}this.toggleMode();this.positionDialog();},onClose:function C(){if(!this.useCache){this.destroy();}},toggleMode:function Z(){var e=this.tabBar.tabs.itemsContainerNode.childNodes,d=this.basic;X.toggleClass(this.editorNode,"advanced",!d);X.toggleClass(e[J.LAYOUT],"hidden",d);var a=mstrApp&&mstrApp.featureFlagsCache&&mstrApp.featureFlagsCache["EE/PDFEncrypt"];X.toggleClass(e[J.SECURITY],"hidden",d||!a);var b=e.length;for(var c=0;c<e.length;c++){if(e[c].className.match(/\bhidden\b/)){b--;}}this.tabBar.set("visible",b>1);this.tabBar.tabs.set("selectedIndex",this.exOpts.selectedTabIndex);if(!this.singleVis){this.set("title",d?H(15841,"Export to PDF - Basic"):H(15842,"Export to PDF - Advanced"));}}});mstrmojo.vi.ui.editors.ExportPDFEditor.singleVisSettings={hideTabIndex:J.GENERAL,selectedTabIndex:J.LAYOUT,overviewViz:O.VISUALIZATIONS,enableFooter:Q.DISABLE};}());(function(){mstrmojo.requiresCls("mstrmojo.css","mstrmojo.Editor","mstrmojo.TextBox","mstrmojo.Label","mstrmojo.Button");var E=mstrmojo.Button.newWebButton;function D(){this.close();this.destroy();}mstrmojo.onetier.vi.prefs.LoginEditor=mstrmojo.declare(mstrmojo.Editor,null,{scriptClass:"mstrmojo.onetier.vi.prefs.LoginEditor",title:mstrmojo.desc(13696,"Login Required"),cssClass:"mstrmojo-ot-prefs-LoginEditor",userName:undefined,password:undefined,loginTitleLabel:undefined,loginTitle:undefined,zIndex:99999,authenticateCredentials:function C(I,H){this.throwAbstractMethodError("authenticateCredentials");},onLoginCancelled:mstrmojo.emptyFn,init:function F(H){this._super(H);if(this.loginTitle){var I=this.loginTitleLabel;I.text=this.loginTitle;I.visible=true;}},onPreClose:function A(){this.onLoginCancelled();return this._super();},onLogin:function B(){var H=this;H.authenticateCredentials(H.userName.value,H.password.value);D.call(H);},children:[{scriptClass:"mstrmojo.Label",text:"",visible:false,cssClass:"login-title",alias:"loginTitleLabel",useRichTooltip:true,getItemTooltip:function(){var H=mstrmojo.dom.position(this.domNode),I="<div>"+mstrmojo.string.encodeHtmlString(this.text,true)+"</div>";return{cssClass:"vi-regular vi-tooltip-C loginEditorTooltip",content:I,top:H.y-10,left:H.x+H.w+9,enableHover:false};},showTooltip:function G(H,I){this.richTooltip=this.getItemTooltip();if(this.richTooltip&&this.text.length>50){this.constructor.prototype.showTooltip.call(this,H,I);}}},{scriptClass:"mstrmojo.TextBox",emptyText:mstrmojo.desc(5135,"User Name"),alias:"userName",cssDisplay:"block",onEnter:function(){var H=this.parent;H.onLogin.call(H);}},{scriptClass:"mstrmojo.TextBox",emptyText:mstrmojo.desc(18,"Password"),alias:"password",cssDisplay:"block",type:"password",onEnter:function(){var H=this.parent;H.onLogin.call(H);}}],buttons:[E(mstrmojo.desc(26,"Login"),function(){var H=this.parent.parent;H.onLogin.call(H);},true),E(mstrmojo.desc(221,"Cancel"),function(){var H=this.parent.parent;H.onLoginCancelled();D.call(H);})]});}());(function(){mstrmojo.requiresCls("mstrmojo.Slider","mstrmojo.vi.ui.rw.selectors.Slider","mstrmojo.vi.ui.rw.selectors.SliderHelper","mstrmojo.vi.ui.rw.selectors.MetricValueSliderHelper","mstrmojo.vi.ui.rw.selectors.MetricRankSliderHelper","mstrmojo.css","mstrmojo.dom","mstrmojo.hash","mstrmojo.MetricSelectorUtility","mstrmojo.num","mstrmojo.boxmodel");var J=mstrmojo.css,I=mstrmojo.dom,D=mstrmojo.hash,G=mstrmojo.num,F=mstrmojo.MetricSelectorUtility,K=mstrmojo.boxmodel;mstrmojo.vi.ui.rw.selectors.MetricSlider=mstrmojo.declare(mstrmojo.vi.ui.rw.selectors.Slider,[mstrmojo._HasPopup],{scriptClass:"mstrmojo.vi.ui.rw.selectors.MetricSlider",cachedClickHandler:null,updateTypeHelper:function C(){var S=this.qua,R=F.typeHelperCls[S]||F.typeHelperCls.defaultCls,U=D.walk("vi.ui.rw.selectors."+R,mstrmojo);this.typeHelper=new U({slider:this});J[(S!==F.Q._G?"add":"remove")+"WidgetCssClass"](this,"rank");},configureGhost:function H(R){if(!this.staticStatus){return this._super(R);}},initDrag:function N(S,R){if(!this.staticStatus&&!this.da.nov){this._super(S,R);}},ondrag:function Q(S,R){if(this.dnd.initD&&!this.staticStatus){this._super(S,R);}},ondrop:function L(W){if(this.dnd.initD&&!this.staticStatus&&!this.da.nov){this._super(W);}else{var S=this.dnd,R=this,V=S.afterDragEnd;S.afterDragEnd=null;S._dragEndCallback();S.afterDragEnd=V;this.cachedClickHandler=this.onclick;this.onclick=null;var U=function(){R.onclick=R.cachedClickHandler;};window.setTimeout(U,0);}},onclick:function P(R){var S=R.getTarget();if(S===this.handle1Node||S===this.handle2Node){window.clearTimeout(this._tooltipTimeOut);this.hideTooltip();this.openPopup("editValueRef",{tgt:S});}else{this._super(R);}},onincludeChange:function B(){if(!this.staticStatus){this.changeInclude=true;this.onselectionChange();}},onquaChange:function O(R){var V=R.valueWas,W=R.value,S=F.getFuncInfo(this.opId,V),U=F.getFuncInfo(this.opId,W);if(S.ft!==U.ft){if(!this.staticStatus){this.items=[];this.cs=[];this.f=this.ft=null;this.refresh();}}else{this.f=F.getFuncInfo(this.opId,R.value).f;}this.changeQual=true;this.onselectionChange();},updateData:function E(R,S){this.da=R;this.updateExpr(S);},updateExpr:function A(R){if(R){this.cs=R.cs;this.f=R.f;this.ft=R.ft;this.qua=R.qua;}this.refresh();},editValueRef:{cssClass:"edvl mstrmojo-Tooltip",contentNodeCssClass:"mstrmojo-Tooltip-content",scriptClass:"mstrmojo.Popup",locksHover:true,onOpen:function(){var V=this.opener,S=this.edt,U=(this.tgt===V.handle1Node),R=K.offset(V.tooltipNode[U?0:1]);J.addClass(this.domNode,V.richTooltip.cssClass);this.set("left",R.left+"px");this.set("top",R.top-this.containerNode.offsetHeight+"px");S.set("value",G.toLocaleString(U?V.cs1Vl:V.cs2Vl));I.setInputSelection(S.inputNode);},onClose:function(){this.opener.set("validation",{invalid:false,position:1});},children:[{scriptClass:"mstrmojo.TextBox",alias:"edt",apply:function(){var U=this.parent,W=U.opener,S=W.typeHelper,V=(U.tgt===W.handle1Node),R=G.parseNumeric(this.value);if(String(R).length>0){R=R<W.low?W.low:(R>W.high?W.high:R);W[V?"cs1Vl":"cs2Vl"]=S.fixDigitByNumFormat(R,W.numFmts);W.onselectionChange();S.updateThumb();U.close();}},onEnter:function(){var S=this.parent.opener,R=F.doValidation(this.value,S,{refNode:this.parent.domNode,position:1},false);if(R.invalid){S.set("validation",R);}else{this.apply();}}}]},showTooltip:function M(S,R){if(!this.editValueRef.visible){this._super(S,R);}}});mstrmojo.vi.ui.rw.selectors.MetricSlider.METRICSLIDERDEFAULTWIDTH=95;}());(function(){mstrmojo.requiresCls("mstrmojo.vi.ui.rw.selectors.Slider");mstrmojo.vi.ui.rw.selectors.PageBySlider=mstrmojo.declare(mstrmojo.vi.ui.rw.selectors.Slider,null,{scriptClass:"mstrmojo.vi.ui.rw.selectors.PageBySlider",slot:"containerNode",preBuildRendering:function A(){var C=this.parent;this.setDimensions(C.height,C.width);return this._super();},setDimensions:function B(D,C){this.height=D;this.width=C;this.synchronizeSlider();}});}());(function(){mstrmojo.requiresCls("mstrmojo.vi.ui.rw.selectors.Slider","mstrmojo.vi.ui.rw.selectors.SliderHelper","mstrmojo.hash","mstrmojo.dom","mstrmojo.tooltip","mstrmojo.gmaps.MapEnums");var G=mstrmojo.hash,B=mstrmojo.dom,D=mstrmojo.gmaps,A=D.EnumPropertyType;mstrmojo.mapbox.ui.selectors.ClusterMaxZoomSlider=mstrmojo.declare(mstrmojo.vi.ui.rw.selectors.Slider,null,{scriptClass:" mstrmojo.mapbox.ui.selectors.ClusterMaxZoomSlider",sliderDefaultWidth:140,multiSelect:false,init:function F(L){L=G.copy(L,{isHoriz:true,multiSelect:false,min:0,max:22});if(!L.host){throw new Error(this.scriptClass+"must be initialized with a host which is a mapbox");}var K=L.host,J=K.getEditingGridProps(),I=parseInt(J[A.clusterMaxZoom],10);L.selectedIndex=isNaN(I)?22:I;this._super(L);},onselectionChange:function(){var I=this.host;I.writeProperties(A.clusterMaxZoom,this.cs2Idx);},initDrag:function E(J,I){if(this.enabled){this._super(J,I);}},_updateTooltip:function C(O,M){var K=B.eventTarget(M,O),L,S,R,P,J=null,Q=null,N='<div class="name">{@content}</div>',I='<div class="dsc">{@description}</div>',V,U=false;switch(K){case this.handle2Node:L=String(this.cs2Nm).replace("$","$$$$");R=mstrmojo.tooltip.POS_TOPLEFT;P="vi-tooltip-A ";Q=this.handle2Node.offsetHeight+18;J=-4;U=true;break;case this.lowNode:L=mstrmojo.desc(15726,"This is the zoom level where you can see the whole world.");R=mstrmojo.tooltip.POS_TOPLEFT;P="vi-tooltip-C ";Q=-8;J=this.lowNode.offsetWidth+16;U=true;break;case this.highNode:L=mstrmojo.desc(15727,"This is the zoom level where you can see streets and buildings.");R=mstrmojo.tooltip.POS_TOPLEFT;P="vi-tooltip-C ";Q=-8;J=this.highNode.offsetWidth+16;U=true;break;default:break;}if(U&&this.enabled){V={cssClass:"mstrmojo-VISlider vi-regular "+P+mstrApp.getThemeClassName(),content:N.replace(/\{@content\}/g,L)+(S&&S.length>0?I.replace(/\{@description\}/g,S):""),contentNodeCssClass:"scm-tooltip",refNode:K,posType:R,left:J,top:Q};this.set("richTooltip",V);}},destroy:function H(I){if(this.baseLayer){delete this.baseLayer;}this._super(I);}});}());(function(){mstrmojo.requiresCls("mstrmojo.ui.PopupConfig","mstrmojo.ui.menus.Menu","mstrmojo.hash","mstrmojo.array");mstrmojo.ui.menus.MenuItemType=null;var B=mstrmojo.array,X="separator";mstrmojo.ui.menus.MenuConfig=mstrmojo.declare(mstrmojo.ui.PopupConfig,null,{scriptClass:"mstrmojo.ui.menus.MenuConfig",menus:null,menuCssClass:"",supportsScroll:false,maxHeight:0,hasToggleItem:false,hasMenuItems:function S(){var Y=B.filter(this.menus||[],function(Z){return Z.cls!==X;});return !!Y.length;},getMenuItems:function F(Y){var a=B.filter(this.menus.slice().reverse(),function(e,d,c){var b=c[d+1];return Y||e.cls!==X||(d&&b&&b.cls!==X);}).reverse();var Z=(a&&a.length)||0;if(!Y&&Z>0&&a[Z-1].cls===X){a.pop();}return a;},getMenuItem:function D(b){var a=this.menus,Y;if(a!==null){for(Y=0;Y<a.length;Y++){var Z=a[Y];if(Z.cls===b){return Z;}}}return null;},absorbMenuItems:function V(Y){this.menus=this.menus.concat(Y.menus);if(!this.hasToggleItem&&Y.hasToggleItem){this.hasToggleItem=true;}},addMenuItem:function K(f,b,d,Z,c){var e,a,Y;if(!f||typeof f==="string"){e=f;}else{e=f.n;a=f.ttp;}Y={n:e,ttp:a,cls:b,fn:d,ctxt:Z};if(isNaN(c)||c>=this.menus.length){this.menus.push(Y);}else{this.menus.splice(c,0,Y);}if(b.indexOf(/\bon\b/)>-1){this.hasToggleItem=true;}return Y;},addCustomMenuItem:function W(d,a,c,Z,Y){var b=this.addMenuItem(d,a,c,Y);b.getItemMarkup=Z;return b;},addDisabledMenuItem:function Q(Z,Y){this.addNonInteractiveMenuItem(Z,Y,true);},addNonInteractiveMenuItem:function O(c,Z,Y){var a=["non-int"];if(Z){a.push(Z);}if(Y){a.push("disabled");}if(c&&typeof c!=="string"&&c.ttp){this.useTooltip=true;}var b=this.addMenuItem(c,a.join(" "),mstrmojo.emptyFn);b.dsbld=true;},addSeparator:function E(){this.addMenuItem("",X,function(){return false;});},addPopupMenuItem:function U(f,a,e,b,Z,c){var d=["pop "];if(b){d.push(b);}var Y=this.addMenuItem(f,d.join(" "),e,Z,c);Y.pop=true;Y.scope=a;return Y;},addActionPopupMenuItem:function N(f,Z,d,e,a,Y,c){var b=this.addPopupMenuItem(f,Z,e,(a||"")+" ax",Y,c);b.actionFn=d;b.ax=true;},addSubMenuItem:function M(c,a,Z,b,Y){this.addPopupMenuItem(c,Z,b,a,Y);},addEditorMenuItem:function R(c,Z,b,Y,a){this.addPopupMenuItem(c,Z,b,"",Y,a);},getToggleItemStates:function G(g,j,Y,e,a,d){var b,c,Z,f;if(typeof g==="string"){b=c=g;Z=f="";}else{b=g.on||"";c=g.off||"";Z=g.ttpOn||"";f=g.ttpOff||"";}var h=[{n:b,ttp:Z,cls:j+" on",fn:e,ctxt:d},{n:c,ttp:f,cls:j,fn:Y,ctxt:d}];if(!a){h.reverse();}return h;},addToggleMenuItem:function L(f,b,d,a,Z,e,Y){var c=this.getToggleItemStates(f,b,d,a,e,Y);this.hasToggleItem=true;return this.addDualStateItem(Z,c[0],c[1]);},addDualStateItem:function I(Z,Y,a){return this.addMenuItem({n:Y.n,ttp:Y.ttp},Y.cls,this.getDualStateHandler(Z,Y,a),Y.ctxt);},getDualStateHandler:function J(Z,Y,a){return function(c,d){var b=[Y,a];if(c.cls===Y.cls){b.reverse();}b[1].fn.call(mstrmojo.all[Z],c,d);c.n=b[0].n;c.ttp=b[0].ttp;c.cls=b[0].cls;};},addRadioMenuGroup:function C(a,f,b,Z,Y,e,d){var c=[];this.hasToggleItem=true;b.forEach(function(k,g){if(k.separator){this.addSeparator();return ;}var m=k.text,l=(Z||"")+" "+(k.cls||"")+(e?"":" radio")+(k.value===a?" on":""),j=function(){if(f.call(this.ctxt,k.value,a,k)===false){return false;}a=k.value;c.forEach(function(n){n.cls=n.cls.replace(/ on$/,"")+(n.radioValue===a?" on":"");});return true;},h=d?this.addCustomMenuItem(m,l,j,d(k,g),Y):this.addMenuItem(m,l,j,Y);h.radioValue=k.value;c.push(h);},this);},clear:function P(){this._super();this.menus=[];},newInstance:function A(Y){return new mstrmojo.ui.menus.Menu(mstrmojo.hash.copy({popupConfig:this},Y));},addMenuTitle:function H(Y){this.addMenuItem(Y||"","menu-item-title",mstrmojo.emptyFn);}});}());(function(){mstrmojo.requiresCls("mstrmojo.ListBase","mstrmojo.ui.menus.Menu","mstrmojo._IsList","mstrmojo.vi.ui._HasMask","mstrmojo.dom","mstrmojo.hash","mstrmojo.string","mstrmojo.ui.menus._HasMenuPopup","mstrmojo.ui._HasListTooltip");var F=mstrmojo.dom;mstrmojo.vi.ui.toolbars.Toolbar=mstrmojo.declare(mstrmojo.ListBase,[mstrmojo._IsList,mstrmojo.ui.menus._HasMenuPopup,mstrmojo.vi.ui._HasMask,mstrmojo.ui._HasListTooltip],{scriptClass:"mstrmojo.vi.ui.toolbars.Toolbar",tooltipOrientation:"vertical",init:function G(I){this._super(I);mstrmojo.css.addWidgetCssClass(this,"mstrmojo-VIToolbar");},selectionPolicy:"reselect",toolbarCfg:null,toolbarClicked:mstrmojo.emptyFn,tooltipCss:null,_set_toolbarCfg:function(L,I){var J=this.toolbarCfg,K=(J!==I);if(K){if(J){J.destroy();}this.toolbarCfg=I;}return K;},getItemProps:function D(K,I){var J=this._super(K,I);J.addCls(K.cls);J.addStyle("display:inline-block");return J;},postBuildRendering:function C(){var I=document.createElement("div");I.className="mstrmojo-VIDND-mask";this.maskNode=this.domNode.appendChild(I);return this._super();},postselectionChange:function(I){var J=I.added;if(J){var K=this.items[J[0]];if(K.tp==="pb"&&K.isMenuClicked){K.menufn(K,this);}else{K.fn(K,this);}}},ontoolbarCfgChange:function H(I){var K=I.valueWas;if(K){K.destroy();}var J=I.value;if(!J){return ;}this.set("items",J.btns);if(this.hasRendered){this.raiseEvent({name:"renderComplete"});}},openMenu:function E(J,I){J.hostId=this.id;J.hostElement=this._getItemNode(I._renderIdx);this.openPopup(J.newInstance());},onclick:function A(I){var K=I.target||F.eventTarget(I.hWin,I.e),J=this.getItemFromTarget(K);if(J&&J.tp==="pb"){if(K&&K.className){J.isMenuClicked=K.className.indexOf("icn")===-1;}}this.toolbarClicked(I);this._super(I);},destroy:function B(J){var I=this.toolbarCfg;if(I){I.destroy();}delete this.items;this._super(J);}});}());(function(){mstrmojo.requiresCls("mstrmojo.ui.editors.controls.ControlGroup","mstrmojo.ui.editors.controls.TwoColumnContainer","mstrmojo.ValidationTextBox","mstrmojo.hash","mstrmojo.css","mstrmojo.num","mstrmojo.validation");var M=mstrmojo.hash,Q=mstrmojo.num,U=mstrmojo.css;var H=10,G=205,V=30,F=75;function E(a){var Z=a<0;a=Math.abs(a);["B","M","K"].every(function(d){var b={B:1000000000,M:1000000,K:1000}[d],c=a>=b;if(c){a=Math.round(a/b)+d;}return !c;});if(a<1){a=a.toPrecision(3);}if(Z){a="-"+a;}return String(a);}function L(){var c=this.minLabel,b=this.maxAutoLabel,d=this.min,Z=this.minCheck,a=5;if(d.domNode&&b){d.domNode.style.marginLeft=c.domNode.offsetWidth+a+"px";b.domNode.style.width=d.domNode.offsetWidth-Z.domNode.offsetWidth+"px";}if(this.auto===undefined){this.autoNode.style.height="0px";}}function C(g,j){var k=this[g+"Node"],d=this[j+"Node"],c=parseInt(k.style.left.replace("px",""),10)-F,q=parseInt(d.style.right.replace("px",""),10),n=this[g+"NodeLabel"],h=this[j+"NodeLabel"];if(c===0&&q===0){n.style.left=0;h.style.right=0;return ;}var p=mstrmojo.dom.position(n).w,Z=mstrmojo.dom.position(h).w,b=G-c-q,l=0,e=0;if(c>0){l=c<p/2?c:p/2;}if(q>0){e=q<Z/2?q:Z/2;}var a=b+l+e-p-Z,o=H-a;if(o>0){if(l===c){e=e+o;}else{if(e===q){l=l+o;}else{var m=o*p/(p+Z),f=o-m;if(l+m>c){e=e+o-(c-l);l=c;}else{if(e+f>q){l=l+o-(q-e);e=q;}else{l=l+m;e=e+f;}}}}}n.style.left=-Math.round(l)+"px";h.style.right=-Math.round(e)+"px";}function W(){var d=this.getRange(),k=this.getAuto();if(!d){return ;}if(!this.enabled){d=M.copyProps(["min","max"],d);}if(k){["Min","Max"].forEach(function(p){var n="auto"+p,o=p.toLowerCase()+"Check",m=k[n];this[o].set("checked",m);},this);}["Min","Max"].forEach(function(p){var n="custom"+p,o=p.toLowerCase(),m=d[n];if(!d.hasOwnProperty(n)){d[n]=d[o];}this[o].setValue(isNaN(m)||!this.enabled?"":Q.toLocaleString(m));},this);var l=M.keyarray(d).map(function(m){var n=m.indexOf("x")>-1;return{key:m,val:Number(d[m]),positionProp:n?"right":"left",positionValue:0};}).sort(function(n,m){return n.val-m.val;}),b=false,f=false,a=l[0].val,c=l[3].val,g=c-a,e=G,j,h;if(l[1].val===a){if(l[2].val!==c){j=h=l[2];}}else{j=l[1];h=(l[2].val!==c)?l[2]:l[1];}function Z(m,o){var r=(m==="left")?a:c,q=Math.abs(o.val-r),p=Math.round(q/g*e),n=p<V;p=n?V:p;o.unscaled=n;o.positionValue=(m===o.positionProp)?p:G-p;if(n){e-=V;g-=q;}return n;}if(j){b=Z("left",j);}if(h&&!h.unscaled){f=Z("right",h);if(h.unscaled&&!j.unscaled){b=Z("left",j);}}U.toggleClass(this.bgNode,"unscaleleft",b);U.toggleClass(this.bgNode,"unscaleright",f);l.forEach(function(n){var o=this[n.key+"Node"],q=this[n.key+"NodeLabel"],m=n.positionProp,p=(m==="left")?F:0;o.style[m]=n.positionValue+p+"px";q.innerHTML=this.getConvertValue(n.val);},this);C.call(this,"customMin","customMax");C.call(this,"min","max");L.call(this);}function N(){var c=this,b=this.getRange(),a=M.copy(b),Z=this;a.customMin=Q.parseNumeric(Z.min.value);a.customMax=Q.parseNumeric(Z.max.value);this.set("range",a);window.setTimeout(function(){c.rangeChanged(a,b);},75);}function P(){var a=this,c=this.getAuto(),b=M.copy(c),Z=this;b.autoMin=Z.minCheck.checked;b.autoMax=Z.maxCheck.checked;this.set("auto",b);window.setTimeout(function(){a.autoChanged();},75);}function A(a,c){var f="ctrlNodeLeft",d=mstrmojo.desc(5416,"Min"),b="min",e="max";if(a){f="ctrlNodeRight";d=mstrmojo.desc(5417,"Max");b="max";e="min";}var Z={scriptClass:"mstrmojo.ValidationTextBox",slot:f,hint:d,alias:b,valueChangeDelay:1000,dtp:5,required:true,useRichTooltip:true,constraints:{trigger:mstrmojo.validation.TRIGGER.NONE,min:null,max:null},setValue:function(h){var g=this._sync;this._sync=true;if(h===""&&this.hasRendered){this.clearValidation();}this.set("value",h);this._sync=g;},onvalueChange:function(){if(!this._sync){var h=this.parent,g=this.parent[e];g.resetConstraints(true);if(g.isValid()){this.updateConstraints();}else{this.resetConstraints(false);}this.validate();h.set("inputValid",g.isValid()&&this.isValid());if(h.inputValid){N.call(h);}}},resetConstraints:function(g){M.copyProps(["min","max"],this.parent.rangeConstraints[this.alias],this.constraints);if(g){this.validate();}},updateConstraints:function(){this.resetConstraints(false);var h=this.parent.rangeConstraints[this.alias][e],g=Q.parseNumeric(this.parent[e].value);if(!h){this.constraints[e]=g;}else{if(e==="min"){this.constraints[e]=h>g?h:g;}else{this.constraints[e]=h<g?h:g;}}},updateTooltipConfig:function(){if(!this.enabled){this.richTooltip=null;return ;}var k=this.validationStatus,h=(b==="min"?mstrmojo.desc(12119,"Custom minimum value"):mstrmojo.desc(12120,"Custom maximum value")),j=this.isValid()?h:this.getInvalidMsg(k),g=(this.isValid()?"vi-regular":"vi-warning")+" vi-tooltip-V";this.richTooltip={content:j,posType:mstrmojo.tooltip.POS_BOTTOMLEFT,cssClass:g,left:0,top:this.domNode.offsetHeight-30,refNode:this.domNode};}};M.copy(c,Z);return Z;}function S(Z,a){return{scriptClass:"mstrmojo.Label",text:Z?mstrmojo.desc(13731,"Max:"):mstrmojo.desc(13732,"Min:"),cssDisplay:"inline-block",alias:Z?"maxLabel":"minLabel",slot:a+(Z?"NodeRight":"NodeLeft")};}function B(Z){return{scriptClass:"mstrmojo.ui.Checkbox",cssDisplay:"inline-block",alias:Z?"maxCheck":"minCheck",slot:Z?"autoNodeRight":"autoNodeLeft",oncheckedChange:function a(){var c=this.alias==="maxCheck",d=this.parent,f=d,b=c?d.max:d.min,e=this.checked;b.set("enabled",!e);if(f.auto){P.call(f);}}};}function Y(Z){return{scriptClass:"mstrmojo.Label",text:mstrmojo.desc(12143,"Automatic"),cssClass:"autoLabel",cssDisplay:"inline-block",alias:Z?"maxAutoLabel":"minAutoLabel",slot:Z?"autoNodeRight":"autoNodeLeft"};}mstrmojo.ui.editors.controls.CustomRange=mstrmojo.declare(mstrmojo.ui.editors.controls.ControlGroup,null,{scriptClass:"mstrmojo.ui.editors.controls.CustomRange",range:null,rangeConstraints:{min:{min:null,max:null},max:{min:null,max:null}},inputValid:true,labelOfDataRange:mstrmojo.desc(13733,"Data Range"),labelOfCustomRange:"",markupString:'<div id="{@id}" class="mstrmojo-ui-CustomRange {@cssClass}"><div class="autoNode"><div class="autoNodeLeft"></div><div class="autoNodeRight"></div></div><div class="ctrlNode"><div class="ctrlNodeLeft"></div><div class="ctrlNodeRight"></div></div><div class="displayNode"><div class="bg"><div class="tip left"></div><div class="dot left"></div><div class="tip right"></div><div class="dot right"></div><div class="girder"></div></div><div class="custom min"><div class="tick-label"></div></div><div class="custom max"><div class="tick-label"></div></div><div class="actual min"><div class="tick-label"></div></div><div class="actual max"><div class="tick-label"></div></div><div class="lbl-cust-range" title="{@labelOfCustomRange}">{@labelOfCustomRange}</div><div class="lbl-data-range" title="{@labelOfDataRange}">{@labelOfDataRange}</div></div></div>',markupSlots:{autoNode:function(){return this.domNode.firstChild;},autoNodeLeft:function(){return this.domNode.firstChild.firstChild;},autoNodeRight:function(){return this.domNode.firstChild.lastChild;},ctrlNode:function(){return this.domNode.children[1];},ctrlNodeLeft:function(){return this.domNode.children[1].firstChild;},ctrlNodeRight:function(){return this.domNode.children[1].lastChild;},displayNode:function(){return this.domNode.lastChild;},bgNode:function(){return this.domNode.lastChild.firstChild;},customMinNode:function(){return this.domNode.lastChild.childNodes[1];},customMaxNode:function(){return this.domNode.lastChild.childNodes[2];},minNode:function(){return this.domNode.lastChild.childNodes[3];},maxNode:function(){return this.domNode.lastChild.childNodes[4];},customMinNodeLabel:function(){return this.domNode.lastChild.childNodes[1].firstChild;},customMaxNodeLabel:function(){return this.domNode.lastChild.childNodes[2].firstChild;},minNodeLabel:function(){return this.domNode.lastChild.childNodes[3].firstChild;},maxNodeLabel:function(){return this.domNode.lastChild.childNodes[4].firstChild;}},layoutConfig:{w:{ctrlNode:"100%",displayNode:"100%"},xt:true},init:function O(c){this._super(c);this.range={min:0,max:100000};M.copy(c,this);var Z=c.auto,a=Z?"auto":"ctrl",b=Z?[S(false,a),B(false),Y(false),this.getTextBoxCfg(false),S(true,a),B(true),Y(true),this.getTextBoxCfg(true)]:[S(false,a),this.getTextBoxCfg(false),S(true,a),this.getTextBoxCfg(true)];this.addChildren(b);},getTextBoxCfg:function J(Z,a){return A(Z,a);},getConvertValue:function D(Z){return E(Z);},afterLayout:function K(){this.min.resetConstraints();this.max.resetConstraints();W.call(this);},getRange:function X(){return M.copy(this.range);},getAuto:function R(){return M.copy(this.auto);},rangeChanged:function I(Z,a){},onrangeChange:function(){W.call(this);},updateDisplay:W});mstrmojo._HasMarkup.addMarkupMethods(mstrmojo.ui.editors.controls.CustomRange,{onenabledChange:function(){this.propagateChildProps("enabled");U.toggleClass(this.displayNode,"disabled",!this.enabled);W.call(this);this.set("inputValid",true);}});mstrmojo.ui.editors.controls.CustomRange.RangeType=null;}());(function(){mstrmojo.requiresCls("mstrmojo.Container","mstrmojo.List","mstrmojo.Button","mstrmojo.color","mstrmojo.Model","mstrmojo.Table","mstrmojo._CanValidate","mstrmojo.ValidationTextBox");var L=mstrmojo.color,C=mstrmojo.hash;function H(W,R,N,O,V,M,Q,U){var S={target:R,onEnd:function(){if(M){M();}},props:{}};S.props[N]={ease:Q,start:parseInt(O,10),stop:parseInt(V,10),suffix:"px"};S=C.copy(U,S);var P=new mstrmojo.fx.AnimateProp(S);P.play();}var D=function(Q){if(Q===null){return ;}var P=mstrmojo.locales.color.userPalette,M=P.length;if(M===8){P.remove(M-1,1);}P.add([{n:Q,v:Q}],0);var N="",O;for(O=0;O<8;O++){if(P[O]&&P[O].v){N+=P[O].v+",";}}N=N.replace(/,$/,"");mstrmojo.xhr.request("POST",mstrConfig.taskURL,{success:function(R){},failure:function(R){mstrmojo.alert(R.getResponseHeader("X-MSTR-TaskFailureMsg"));}},{taskId:"setPreference",prefs:"userPalette\u001E"+N});};var I=function(M,N,O){return{scriptClass:"mstrmojo.Label",text:M+":",cssClass:N,slot:O};};var K=function(M,P,O,N){return C.copy(N||{},{scriptClass:"mstrmojo.ValidationTextBox",cssDisplay:"block",cssText:"padding: "+(mstrmojo.dom.isIE7?"0":"1px"),bindings:{value:function(){return this.parent.parent.colorModel[O]||"0";}},onValid:function(){this.parent.parent.colorModel.set(O,this.value);},min:0,max:255,constraints:{trigger:mstrmojo.validation.TRIGGER.ONKEYUP,validator:function(R){var S=this.min,Q=this.max;R=parseInt(R,10);if(R>=S&&R<=Q){return{code:mstrmojo.validation.STATUSCODE.VALID};}return{code:mstrmojo.validation.STATUSCODE.INVALID,msg:mstrmojo.desc(7883,"Please enter an integer between ## and ###").replace("##",S).replace("###",Q)};}},slot:P});};var G=function(M){return C.copy({scriptClass:"mstrmojo.Slider",alias:M+"Slider",cssClass:"sc "+M,isHoriz:true,width:130,cssBkBW:0,items:[],getItemTooltip:function(){return this.items[this.min].n;},postCreate:function(){var N;for(N=0;N<{r:256,g:256,b:256,s:101,v:101,h:360}[M];N++){this.items.push({n:N,v:N});}},bindings:{selectedIndex:function(){return this.parent.parent.colorModel[M]||"0";}},onselectedIndexChange:function(){this.parent.parent.colorModel.set(M,this.selectedIndex);if(this.domNode){this.min=this.max=this.selectedIndex;this.typeHelper.updateThumb();}},select:function(N){this.set("selectedIndex",N);},slot:"1,3"});};var A=function(N,M,O){return'<div mstridx="'+M+'" class="mstrmojo-ColorPicker-item '+O.itemCssClas+'" style="background-color:'+N.v+';" type="button" title="'+N.n+'"></div>';};var F=C.copy({findIndex:function(M,O,N){return N.getAttribute("mstridx")||-1;}},C.copy(mstrmojo.ListMapper));var B=function(M,N){return C.copy(N,{scriptClass:"mstrmojo.List",cssClass:"mstrmojo-ColorPicker-list",itemMarkupFunction:A,listMapper:F,onchange:null,_onchange:function(){this.set("selectedColor",this.selectedItem.v);M.set("selectedColor",this.selectedItem.v);if((M.isSimple||!M.expanded)&&M.onChange){M.onChange();}},onselectedColorChange:function(){M.colorModel.set("hex",this.selectedColor);}});};mstrmojo.ColorPicker=mstrmojo.declare(mstrmojo.Container,[mstrmojo._HasPopup],{scriptClass:"mstrmojo.ColorPicker",markupString:'<div id={@id} class="mstrmojo-ColorPicker {@cssClass} {@shadowCssClass}" style="height:{@height}; width:{@width};{@cssText}"><div class="mstrmojo-ColorPicker-box"></div></div>',markupSlots:{containerNode:function(){return this.domNode.firstChild;}},markupMethods:{onvisibleChange:function(){this.domNode.style.display=this.visible?"block":"none";},onexpandedChange:function(){this.domNode.className=this.domNode.className.replace(/ expanded/,"")+(this.expanded?" expanded":"");}},useAnimate:true,useShadow:true,isSimple:false,showNoColor:true,showMoreColors:true,showGradients:false,showUserPalette:true,height:"168px",fullHeight:"326px",width:"158px",fullWidth:"366x",expanded:false,onexpandedChange:function(N){var Q=this.domNode,M=parseInt(this.height,10),P=parseInt(this.width,10),O=parseInt(this.fullHeight,10),R=Math.max(parseInt(this.fullWidth,10),Q.scrollWidth);if(this.useAnimate!==false){if(N.value){H(true,Q,"width",P,R);H(true,Q,"height",M,O);}else{H(true,Q,"width",R,P);H(true,Q,"height",O,M);}}else{if(N.value){Q.style.width=R+"px";Q.style.height=O+"px";}else{Q.style.width=P+"px";Q.style.height=M+"px";}}},selectedColor:null,onChange:null,_updateSelection:function(N){var O=(this.isSimple)?this:this.layout.cp;if(N){var M=mstrmojo.array.find(O.basicColors.items,"v",N);if(M>-1){O.basicColors.set("selectedIndex",M);}else{M=mstrmojo.array.find(O.userPalette.items,"v",N);if(M>-1){O.userPalette.set("selectedIndex",M);}}}},visible:false,onvisibleChange:function(){if(this.visible){this.selectedColor=(this.selectedColor&&this.selectedColor.replace(/transparent/,"#FFFFFF"))||"#FFFFFF";this.colorModel.set("hex",this.selectedColor);this._updateSelection(this.selectedColor);}},onselectedColorChange:function(){this._updateSelection(this.selectedColor);},init:function(M){var N=this;this.colorModel=new mstrmojo.Model({h:0,s:0,v:100,_hsvChange:function(){this.hex="#"+L.hsv2hex(this.h,this.s,this.v);var O=L.hsv2rgb(this.h,this.s,this.v);this.r=O[0];this.g=O[1];this.b=O[2];N.set("colorModel",C.copy(this,{}));},_rgbChange:function(){this.hex="#"+L.rgb2hex(this.r,this.g,this.b);var O=L.rgb2hsv(this.r,this.g,this.b);this.h=O[0];this.s=O[1];this.v=O[2];N.set("colorModel",C.copy(this,{}));},onhChange:function(){this._hsvChange();},onsChange:function(){this._hsvChange();},onvChange:function(){this._hsvChange();},onrChange:function(){this._rgbChange();},ongChange:function(){this._rgbChange();},onbChange:function(){this._rgbChange();},onhexChange:function(){var P=L.hex2rgb(this.hex);this.r=P[0];this.g=P[1];this.b=P[2];var O=L.hex2hsv(this.hex);this.h=O[0];this.s=O[1];this.v=O[2];N.set("colorModel",C.copy(this,{}));}});this._super(M);},postBuildRendering:function(){if(this._super){this._super();}this.colorModel.set("hex",this.selectedColor||"#FFFFFF");this.colorModel.set("s",50);},preBuildRendering:function(){if(this._super){this._super();}var P=this.isSimple?100:124;if(this.showNoColor){P+=20;}if(this.showUserPalette){P+=25;}this.height=P+"px";if(this.isSimple){this.width="155px";}this.shadowCssClass=this.useShadow?"shadow":"";var Q=this,M={scriptClass:"mstrmojo.Button",cssClass:"nocolor",text:mstrmojo.desc(959,"Default"),visible:this.showNoColor,onclick:function(){Q.set("selectedColor","transparent");if(Q.onChange){Q.onChange();}}},O=B(this,{alias:"basicColors",items:mstrmojo.locales.color.colors,onchange:function(){if(this.selectedIndex>-1){this.parent.userPalette.set("selectedIndex",-1);this._onchange();}}}),R=B(this,{alias:"userPalette",cssClass:"mstrmojo-ColorPicker-list userPalette",makeObservable:true,visible:this.showUserPalette,bindings:{items:function(){return Q.showUserPalette!==false?mstrmojo.locales.color.userPalette:[];}},onchange:function(){if(Q.visible){if(this.selectedIndex>-1){this.parent.basicColors.set("selectedIndex",-1);this._onchange();}}},onadd:function(){this.refresh();if(Q.visible){this.parent.basicColors.set("selectedIndex",-1);this.set("selectedIndex",0);}}});if(this.isSimple){if(this.showNoColor){this.addChildren(M,0);}this.addChildren(O);this.addChildren(R);return ;}var N={scriptClass:"mstrmojo.Table",alias:"layout",rows:2,cols:5,layout:[{cells:[{colSpan:2},{colSpan:2},{}]},{cells:[{},{},{},{},{}]}],children:[{scriptClass:"mstrmojo.VBox",cssClass:"mstrmojo-ColorPicker-palette shadow",alias:"cp",children:[M,O,R],slot:"0,0"},{scriptClass:"mstrmojo.Container",cssClass:"sbSlider",markupString:'<div class="{@cssClass}" style="position:relative; {@cssText}" mstrAttach:click,mouseover,mousemove,mousedown,mouseup,mouseout><div class="sbThumb"></div></div>',markupSlots:{containerNode:function(){return this.domNode;},thumbNode:function(){return this.domNode.firstChild;}},markupMethods:{onbgColorChange:function(){this.domNode.style.backgroundColor=this.bgColor;}},hex:null,bindings:{hex:"this.parent.parent.colorModel.hex",bgColor:function(){return"#"+L.hsv2hex(this.parent.parent.colorModel.h,100,100);}},onhexChange:function(){if(this.domNode){this.thumbNode.style.left=this.parent.parent.colorModel.s/100*160-3+"px";this.thumbNode.style.top=(1-this.parent.parent.colorModel.v/100)*160-3+"px";}},onmousedown:function(){var U=this.domNode.getBoundingClientRect();this.mouseX0=U.left;this.mouseY0=U.top;this.onmousemove=this._update;var S=this;this.onmouseup=function(){S.onmousemove=null;mstrmojo.dom.detachEvent(document.body,"mouseup",S.onmouseup);};mstrmojo.dom.attachEvent(document.body,"mouseup",this.onmouseup);},onclick:function(S){this._update(S);},_update:function(S){var W={x:S.e.clientX,y:S.e.clientY},V=Math.min(Math.max(0,W.x-this.mouseX0),160),U=Math.min(Math.max(0,W.y-this.mouseY0),160);this.thumbNode.style.left=(V-3)+"px";this.thumbNode.style.top=(U-3)+"px";this.parent.parent.colorModel.s=Math.floor(100*V/160);this.parent.parent.colorModel.set("v",Math.floor(100*(1-U/160)));},slot:"0,1"},{scriptClass:"mstrmojo.Container",cssClass:"hueSlider",markupString:'<div class="{@cssClass}" style="position:relative; {@cssText}" mstrAttach:click,mouseover,mousedown,mouseup,mousemove,mouseout><div class="hThumb"></div></div>',markupSlots:{containerNode:function(){return this.domNode;},thumbNode:function(){return this.domNode.firstChild;}},bindings:{hex:"this.parent.parent.colorModel.hex",h:"this.parent.parent.colorModel.h"},onhexChange:function(){this._moveThumb();},onhChange:function(){this._moveThumb();},_moveThumb:function(){if(this.thumbNode){this.thumbNode.style.top=(1-this.parent.parent.colorModel.h/360)*160-1+"px";}},onmousedown:function(){this.mouseY0=this.domNode.getBoundingClientRect().top;this.onmousemove=this._update;var S=this;this.onmouseup=function(){S.onmousemove=null;mstrmojo.dom.detachEvent(document.body,"mouseup",S.onmouseup);};mstrmojo.dom.attachEvent(document.body,"mouseup",S.onmouseup);},onclick:function(S){this._update(S);},_update:function(S){var V={x:S.e.clientX,y:S.e.clientY},U=Math.min(Math.max(0,V.y-this.mouseY0),160);this.thumbNode.style.top=(U-1)+"px";this.parent.parent.colorModel.set("h",Math.max(0,Math.floor(360*(1-U/160))));},slot:"0,2"},{scriptClass:"mstrmojo.Label",cssClass:"mstrmojo-ColorPicker-preview",markupMethods:{onbgColorChange:function(){this.domNode.style.backgroundColor=this.bgColor;}},bindings:{bgColor:"this.parent.parent.colorModel.hex"},onclick:function(){if(Q.showUserPalette){D(this.bgColor);}},slot:"1,0"},I(mstrmojo.desc(7848,"Hex"),"Hex","1,0"),K(mstrmojo.desc(7848,"Hex"),"1,0","hex",{cssClass:"hex",cssDisplay:"block",inputNodeCssClass:"hex",dtp:25,constraints:{trigger:mstrmojo.validation.TRIGGER.ONKEYUP,validator:function(S){if(/^#[0-9a-fA-F]{6}$/.test(S)){return{code:mstrmojo.validation.STATUSCODE.VALID};}return{code:mstrmojo.validation.STATUSCODE.INVALID,msg:mstrmojo.desc(7882,"Please enter a 6-digit HEX color value in format: #xxxxxx")};}}}),I(mstrmojo.desc(3604,"Red"),"Red","1,1"),I(mstrmojo.desc(3606,"Green"),"Green","1,1"),I(mstrmojo.desc(3608,"Blue"),"Blue","1,1"),I(mstrmojo.desc(3605,"Hue"),"Hue","1,1"),I(mstrmojo.desc(3607,"Saturation"),"Saturation","1,1"),I(mstrmojo.desc(3609,"Brightness"),"Brightness","1,1"),K(mstrmojo.desc(3604,"Red"),"1,2","r"),G("r"),K(mstrmojo.desc(3606,"Green"),"1,2","g"),G("g"),K(mstrmojo.desc(3608,"Blue"),"1,2","b"),G("b"),K(mstrmojo.desc(3695,"Hue"),"1,2","h",{cssClass:"h",max:360}),G("h"),K(mstrmojo.desc(3607,"Saturation"),"1,2","s",{max:100}),G("s"),K(mstrmojo.desc(3609,"Brightness"),"1,2","v",{max:100}),G("v")]};if(this.showMoreColors){N.children.push({scriptClass:"mstrmojo.Button",cssClass:"more",alias:"more",title:mstrmojo.desc(7833,"More >>>"),onclick:function(){var S=this.parent.parent;S.set("expanded",!S.expanded);this.domNode.setAttribute("title",S.expanded?mstrmojo.desc(7834,"Less Colors"):mstrmojo.desc(7833,"More Colors"));this.domNode.className=S.expanded?"less":"more";},slot:"0,0"});}if(this.showGradients){N.children.push({scriptClass:"mstrmojo.Button",alias:"showGradients",cssClass:"ge",text:mstrmojo.desc(4786,"Gradients..."),title:mstrmojo.desc(7970,"Open Graident Editor"),onclick:function(){var S=this.parent.parent;S.set("show",false);S.parent.ge.set("show",true);},slot:"0,0"});}this.addChildren(N);this.addChildren({scriptClass:"mstrmojo.HBox",cssClass:"mstrmojo-ColorPicker-buttonBar",children:[mstrmojo.Button.newInteractiveButton(mstrmojo.desc(1442,"Ok"),function(){var S=this.parent.parent;if(!S.useAnimate){S.set("visible",false);}var U=S.colorModel.hex;if(S.showUserPalette){D(U);}S.set("selectedColor",U);if(S.onOK){S.onOK();}},"#999",{alias:"ok",cssClass:"mstrmojo-Editor-button"}),mstrmojo.Button.newInteractiveButton(mstrmojo.desc(221,"Cancel"),function(){var S=this.parent.parent;if(!S.useAnimate){S.set("visible",false);}if(S.onCancel){S.onCancel();}},"#999",{alias:"cancel",cssClass:"mstrmojo-Editor-button"})]});}});var J={scriptClass:"mstrmojo.Popup",slot:"popupNode",contentNodeCssClass:"mstrmojo-ColorPicker-popup-content",autoCloses:false,locksHover:true,colorPicker:null,onOpen:function(){this.colorPicker.set("selectedColor",this.opener.fillColor);var N=this;var M=function(){N.lastOpener=N.lastOpener||N.opener;if(N.opener!==N.lastOpener){N.opener.popupNode.appendChild(N.lastOpener.popupRef.domNode);N.lastOpener=N.opener;}N.colorPicker.set("show",true);};window.setTimeout(function(){M();},100);},onClose:function(){this.colorPicker.set("show",false);if(this.ge){this.ge.set("show",false);}},postCreate:function(){this.markupMethods=C.copy(this.markupMethods);this.markupMethods.onvisibleChange=null;},preBuildRendering:function(){if(this.showGradients||this.colorPicker.showGradients){this.addChildren(this.gradientRef);}},gradientRef:{scriptClass:"mstrmojo.GradientEditor",alias:"ge",cssText:"height:0; display:none; position:absolute; z-index: 4;",left:"0px",top:"0px",visible:false,showTitle:false,height:245,_resizeHandler:function(){},onOK:function(){this.parent.opener.set("gradient",this.gradient);this.parent.opener.set("gradientCss",this.gradient.css);this.set("show",false);},onCancel:function(){this.set("show",false);},onshowChange:function(O){var N=O.value,M=parseInt(this.height,10);var R=this.domNode.firstChild;if(N){this.set("model",this.parent.opener.gradient);R.style.display="block";}if(this.useAnimate!==false){var S=N?0:M,P=M-S,Q=this;R.style.overflow="hidden";if(N){R.style.display="block";}H(N,R,"height",S,P,function(){if(!N){R.style.display="none";var U=Q.parent.opener;if(U){U.closePopup();}}else{R.style.overflow="visible";}});}else{R.style.height=N?M+"px":0;R.style.display=N?"block":"none";}},postCreate:function(){this.bindings={useAnimate:"this.parent.opener.useAnimate"};}},children:[{scriptClass:"mstrmojo.ColorPicker",alias:"colorPicker",onChange:function(){if(!this.parent.opener){return ;}this.parent.opener.set("fillColor",this.selectedColor);this.set("show",false);this.parent.opener.closePopup();},onOK:function(){this.onApply();this._closePopup();},onApply:function(){this.parent.opener.set("fillColor",this.selectedColor);},onCancel:function(){this._closePopup();},_closePopup:function(){this.set("show",false);if(!this.showGradients||!this.parent.ge||(this.parent.ge&&!this.parent.ge.show)){this.parent.opener.closePopup();}},show:false,onEnd:function(){this.set("visible",this.show);},onshowChange:function(){var M=parseInt(this.expanded?this.fullHeight:this.height,10);if(this.useAnimate!==false){var Q=this.show?0:M,O=M-Q,P=this,N=(!this.show?function(){P.onEnd();}:null);if(this.show){this.set("visible",true);}H(this.show,this.domNode,"height",Q,O,N);}else{this.set("visible",this.show);this.domNode.style.height=M+"px";}},postCreate:function(){this.showGradients=this.parent.showGradients;this.bindings={showUserPalette:function(){return this.parent.opener?this.parent.opener.showUserPalette:this.showUserPalette;},useAnimate:function(){return this.parent.opener?this.parent.opener.useAnimate:this.useAnimate;},isSimple:function(){return this.parent.opener?this.parent.opener.isSimple:this.isSimple;},showNoColor:function(){return this.parent.opener?this.parent.opener.showNoColor:this.showNoColor;}};}}]};mstrmojo.colorPickerPopupRef=mstrmojo.insert(J);mstrmojo.simpleColorPickerPopupRef=mstrmojo.insert(C.copy({isSimple:true},C.copy(J)));mstrmojo.gradientColorPickerPopupRef=mstrmojo.insert(C.copy({showGradients:false},C.copy(J)));mstrmojo.ColorPicker.createDropDown=function E(O,N){O=O||{};var M=mstrmojo.colorPickerPopupRef;if(N){if(N.isSimple){M=mstrmojo.simpleColorPickerPopupRef;O.isSimple=N.isSimple;}else{if(N.showGradients){M=mstrmojo.gradientColorPickerPopupRef;O.showGradients=N.showGradients;}}}else{if(O){if(O.isSimple){M=mstrmojo.simpleColorPickerPopupRef;}else{if(O.showGradients){M=mstrmojo.gradientColorPickerPopupRef;}}}}return C.copy(O,{scriptClass:"mstrmojo.DropDownButton",cssClass:"mstrmojo-ColorPicker-DropDownButton",markupMethods:{onfillColorChange:function(){if(this.boxNode&&this.fillColor){this.boxNode.style.cssText="background-color: "+this.fillColor;this.gradient=null;this.gradientCss=null;}},ongradientCssChange:function(){if(this.boxNode&&this.gradientCss){this.boxNode.style.cssText=this.gradientCss;this.fillColor=null;}}},popupRef:M,showUserPalette:true,useAnimate:true,showGradients:false,isSimple:false,fillColor:undefined});};}());(function(){mstrmojo.requiresCls("mstrmojo.ValidationTextBox","mstrmojo.hash");var A=mstrmojo.hash;mstrmojo.ui.editors.controls.ValidationTextBox=mstrmojo.declare(mstrmojo.ValidationTextBox,null,{scriptClass:"mstrmojo.ui.editors.controls.ValidationTextBox",errRevert:true,dtp:null,validationDelay:3000,orignText:null,trigger:mstrmojo.validation.TRIGGER.ONKEYUP,init:function(B){B=B||{};B.constraints=B.constraints||{};B.constraints.trigger=this.trigger;this._super(B);},prekeyup:function(B){if(B.e.keyCode===13){this.blur();return ;}this._super(B);},onfocus:function(){this.orignText=this.value;},onblur:function(){if(this.value!=this.orignText){this.validate();}},validate:function(){this._super();this.orignText=this.value;this.clearValDelayTimer();},preinput:mstrmojo.emptyFn,postinput:function(){var B=this.doValidation(this.value);if(B.code<=mstrmojo.validation.STATUSCODE.VALID){this.clearValidation();if(!this.errRevert){this.hideTooltip();}}},updateTooltipConfig:function(){this.richTooltip={posType:mstrmojo.tooltip.POS_BOTTOMLEFT,cssClass:"vi-warning vi-tooltip-C vi-calculation-warning",left:this.domNode.offsetWidth+12,top:this.domNode.offsetHeight+5,refNode:this.domNode,content:mstrmojo.desc(13819,"Invalid input")};},onInvalid:function(){if(!this.errRevert){this.hideTooltip();this.showTooltip();}else{this.clearValidation();this.set("value",this.orignText);}}});}());(function(){mstrmojo.requiresCls("mstrmojo.ValidationTextBox","mstrmojo._IsInputControl","mstrmojo.dom","mstrmojo.num");var J=mstrmojo.validation,C=J.STATUSCODE,F=J.VALIDATOR,D=mstrmojo.expr.DTP,B=0,A=1,I=2,H=3,G=4,E=5;mstrmojo.DICAutoFocusButton=mstrmojo.declare(mstrmojo.Button,null,{scriptClass:"mstrmojo.DICAutoFocusButton",markupString:'<div id="{@id}" class="mstrmojo-Button {@cssClass} {@iconClass}" title="{@title}" style="{@cssText}" tabindex="1" mstrAttach:touchstart,click,mousedown,mouseup><div class="mstrmojo-Button-text {@innerIconClass}"></div></div>',postBuildRendering:function(){this._super();var K=this;setTimeout(function(){K.domNode.focus();},200);}});mstrmojo.TextFieldDIC=mstrmojo.declare(mstrmojo.ValidationTextBox,[mstrmojo._IsInputControl],{scriptClass:"mstrmojo.TextFieldDIC",cssClass:"mstrmojo-TextFieldDIC",dtp:D.VARCHAR,validationDelay:0,getInputNode:function(){return this.inputNode;},focus:function(){this.validate();mstrmojo.dom.setCaret(this.domNode,(this.value&&this.value.length||0));},init:function(K){if(this._super){this._super(K);}this.constraints=mstrmojo.hash.copy();var M=K.dic,N=this.constraints={trigger:mstrmojo.validation.TRIGGER.ONKEYUP},L=M.dt;if(M.ml){this.maxLength=M.ml;}if(M.psw){this.type="password";this.value=this.lv="";this.owner.applyPasswordMask&&this.owner.applyPasswordMask();}if(J.isNumeric(L)||J.isInt(L)||J.isString(L)){this.dtp=L;}switch(M.vm){case A:N.validator=F.VALIDATE_PHONENO;break;case I:N.validator=F.VALIDATE_EMAIL;break;case H:N.validator=F.VALIDATE_ZIPCODE;break;case G:N.validator=F.VALIDATE_SSN;break;case E:N.regExp=new RegExp("^"+M.rgx+"$");break;}N.min=M.emin?M.min:null;N.max=M.emax?M.max:null;N.maxLen=(M.ml!==undefined)?M.ml:null;N.minLen=(M.mnl!==undefined)?M.mnl:null;if(M.req){this.required=true;}},onInvalid:function(){if(this.popup){this.popup.set("hasInvalidData",true);}},onValid:function(){if(this.popup){this.popup.set("hasInvalidData",false);}},_set_value:function(L,K){if(this.value===undefined&&K===""){return ;}return this._super(L,K);},applyChanges:function(){this.validate();if(this.isValid()){this._super();}else{if(!this.showByDefault){this.handleInvalid();return false;}}return true;},handleInvalid:function(){if(mstrmojo.all.mojoConfirmx9){return ;}var K=this;mstrmojo.confirm(this.validationStatus.msg+"\n("+mstrmojo.desc(9199)+")",null,{buttons:[{scriptClass:"mstrmojo.DICAutoFocusButton",text:mstrmojo.desc(1442),onclick:function(){K.focus();}},{scriptClass:"mstrmojo.Button",text:mstrmojo.desc(221),onclick:function(){if(K.popup){K.popup.onCancel();}else{K.undoValidate&&K.undoValidate();}}}],title:mstrmojo.desc(7548),cssClass:"mstrmojo-TextFieldDIC-ValidationError"});},cancelChanges:function(){this.inputNode.blur();this.value=this.lv;this.clearValidation();}});})();(function(){mstrmojo.requiresCls("mstrmojo.Slider","mstrmojo.MetricSelectorUtility","mstrmojo.expr","mstrmojo.ValidationTextBox","mstrmojo.array","mstrmojo._FormatDefinition.NumberFormatCategory","mstrmojo.hash");mstrmojo.requiresDescs(8153,8154,8155,8156,8157,8158,8159,8160,8161,8162,8163,8164,8165,8166,8167,8168,8169,8170,7839,587,2204,2202,2203,7576,7575,7622);var V=mstrmojo.dom,N=mstrmojo.hash,S=mstrmojo.MetricSelectorUtility,k=mstrmojo._FormatDefinition.NumberFormatCategory,J=mstrmojo.desc,W=mstrmojo.css,Y=mstrmojo.num,B=Math,c=B.max,H=B.min,e=B.floor,X=B.round,a=9;function M(AC,AB,z,x){var AA="px",r=AC._length,p=AC.handleSize,o=AC.orCfg,AG=o.posCssP,t=o.lenCssP,u=false;z=c(z,-1);x=H(x+a,r);if(z>x){u=true;}var AD=H(z,x),AE=c(z,x),AF=AE-AD-(u?0:p+a),v=c(r-AE,0);if(AC.hasRendered){AB.handle1Node.style[AG]=z+AA;AB.handle2Node.style[AG]=(x-a)+AA;var n=AB.lowerRange.style,w=AB.thumbNode.style,q=AB.upperRange.style;n[AG]=0;w[AG]=(AD+(u?0:p))+AA;q[AG]=(AE+p-a)+AA;n[t]=c(AD,0)+AA;w[t]=AF+AA;q[t]=v+AA;}else{AA+=";";AG+=":";t+=":";AC.handle1CssText=AG+z+AA;AC.handel2CssText=AG+(x-a)+AA;AC.lowerRangeCssText=t+c(AD,0)+AA;AC.thumbCssText=AG+(AD+p)+AA+t+AF+AA;AC.upperRangeCssText=AG+(AE+p-a)+AA+t+v+AA;}return{handle1:z,handle2:x};}function O(n){this.getUnit=function(){return n._length/c((n.items.length-1),1);};this.calcMinMax=function(q,p){var r=n.unit;return{min:e(q/r+0.5),max:e(p/r+0.5)};};this.calcPxIdx=function(p){return e(p/n.unit+0.5);};this.getStep=function(){var q=n.high-n.low,p=parseInt(n.numFmts.cat,10),r=(p===4)?2:(p===5)?4:0;q=(q===0)?1:q;if(q>1){return(q>(n._length-2))?Number(Number(q/(n._length-2)).toFixed(n.numFmts.dp+r)):1;}return q/(n._length-2);};this.getIdx=function(p){return H(c(X((p-n.low)/n.step),0),n.items.length-1);};this.initialMetricSlider=function o(){var u=function(AH){return AH!==undefined&&AH!==null;},r=function(AH){return(u(AH.da)&&u(AH.da.low)&&u(AH.da.high)&&u(AH.da.cnt)&&u(AH.f)&&u(AH.ft)&&u(AH.qua));},q=function(AH){var AL=true,AK=true,AI=parseInt(AH.ft,10),AJ=parseInt(AH.f,10);if(AI===S._GENERIC){AL=AJ!==S.FN.ISNULL&&AJ!==S.FN.ISNOTNULL&&AJ!==S.FN.NOTIN&&AJ!==S.FN.IN;}else{if(AI===S._PERCENT||AI===S._RANK){AK=AJ!==S.MRPFN.INASCENDING&&AJ!==S.MRPFN.INDESCENDING&&AJ!==S.MRPFN.NOTINDESCENDING&&AJ!==S.MRPFN.NOTINASCENDING;}}return !AL||!AK;},AE=0;n.include=n.parent.include;n.clsType="scm ";n.staticStatus=!(u(n.da)&&u(n.da.low)&&u(n.da.high)&&u(n.da.cnt)&&u(n.qua));if(n.staticStatus){n.da.low=1;n.da.high=7;n.ft=S._GENERIC;n.f=S.FN.BETWEEN;n.qua=S.Q._G;n.cs=[{n:"",v:1},{n:"",v:7}];n.numFmts={cat:9,dp:0,fm:""};}switch(n.qua){case 0:var AD=parseInt(n.numFmts.cat,10);AE=AD===4?2:AD===5?4:0;n.low=Number(Number(n.da.low).toFixed(n.numFmts.dp+AE));n.high=Number(Number(n.da.high).toFixed(n.numFmts.dp+AE));break;case 1:case 2:n.low=1;n.high=n.da.cnt;break;case 3:case 4:n.low=0;n.high=100;break;}var AG=!n.staticStatus&&!n.da.nov;n.set("lowText",AG?n.formatNumber(n.low):"");n.set("highText",AG?n.formatNumber(n.high):"");n.step=(n.qua===1||n.qua===2)?1:this.getStep();n.cs1Vl=n.low;n.cs2Vl=n.high;var t=n.low,AA=n.high,AF=[],AC=0;if(u(t)&&u(AA)){var w=t,z;for(z=0;w<=AA;z++,w+=n.step){AF[z]={n:S.formatNumber(n.qua,w,n.numFmts),v:Number(Number(w).toFixed(n.numFmts.dp+AE))};}AC=AF.length;if(AC>0&&AF[AC-1].v!==AA){AF[AC-1]={n:S.formatNumber(n.qua,AA,n.numFmts),v:AA};}}n.items=AF;var p=S.OP,AB=n.cs,x=(AB&&AB.length>0)?Y.parseNumeric(String(AB[0].v).replace("%","")):t,v=(AB&&AB.length>1)?Y.parseNumeric(String(AB[1].v).replace("%","")):AA;if(x<n.low){n.frtUst=true;}if(v>n.high){n.ndUst=true;}n.opId=(n.f!==null&&n.ft!==null)?S.getOpIdxByfunc(n.f,n.ft):p._BETWEEN;switch(n.opId){case p._EQUALS:case p._NOT_EQUALS:n.cs1Vl=n.cs2Vl=x;break;case p._LESS_EQUAL:case p._GREATER:n.cs1Vl=t;n.cs2Vl=x;break;case p._GREATER_EQUAL:case p._LESS:n.cs1Vl=x;n.cs2Vl=AA;break;case p._IN:case p._NOT_IN:case p._IS_NULL:case p._IS_NOT_NULL:break;default:n.cs1Vl=x;n.cs2Vl=v;break;}n.cs1Idx=this.getIdx(n.cs1Vl);n.cs2Idx=this.getIdx(n.cs2Vl);n.cs1Nm=u(n.cs1Vl)?S.formatNumber(n.qua,n.cs1Vl,n.numFmts):n.items[n.cs1Idx].n;n.cs2Nm=u(n.cs2Vl)?S.formatNumber(n.qua,n.cs2Vl,n.numFmts):n.items[n.cs2Idx].n;n.unit=this.getUnit();n.set("unSet",(!r(n)||q(n)||(!n.cs||n.cs.length===0))&&!n.staticStatus);};this.updateOpCs=function(){var t=(n.cs1Vl>n.cs2Vl)?n.cs2Vl:n.cs1Vl,z=(n.cs1Vl>n.cs2Vl)?n.cs1Vl:n.cs2Vl,r=n.low,v=n.high,x=n.include,p=S.OP,u=parseInt(n.qua,10),q=(u===S.Q._PT||u===S.Q._PB),AA,w=[];if((t>=r&&z<=v)||t<r||z>v){n.opId=x?p._BETWEEN:p._NOT_BETWEEN;}if(t===z){n.opId=x?p._EQUALS:p._NOT_EQUALS;}if(t===r&&z<v){n.opId=x?p._LESS_EQUAL:p._GREATER;}if(t>r&&z===v){n.opId=x?p._GREATER_EQUAL:p._LESS;}AA=r==t&&z==v;if(!AA){switch(n.opId){case p._BETWEEN:case p._NOT_BETWEEN:w.push({dtp:5,v:Y.toLocaleString(t)+(q?"%":"")});case p._EQUALS:case p._NOT_EQUALS:w.push({dtp:5,v:Y.toLocaleString(z)+(q?"%":"")});break;default:if(t>r){w.push({dtp:5,v:Y.toLocaleString(t)+(q?"%":"")});}if(z<v){w.push({dtp:5,v:Y.toLocaleString(z)+(q?"%":"")});}}}n.cs=w;n.parent.node.data.cs=w;n.set("unSet",AA);};this.updateThumb=function(){var p=n.cs1Idx,t=n.cs2Idx;if(p!==undefined&&t!==undefined){var q=n.unit,r=n.gap;N.copy(M(n,n,X(p*q-r),X(t*q-r)),n);}};this.joinConst=function(){var r=n.cs;if(r){var p=[],q;for(q in r){p.push(r[q].v);}return p.join(",");}};}var E="<span {@ttpCssText}>{@content}</span>";function D(){if(this.staticStatus){return null;}var q=this.ghost;if(!q){var u=this.containerNode.cloneNode(true),t=u.childNodes;W.addClass(u,["gh"]);q=this.ghost={containerNode:u,lowerRange:t[0],handle1Node:t[1],thumbNode:t[2],handle2Node:t[3],upperRange:t[4]};this.sdcNode.appendChild(u);}var o=this.orCfg,n=o.posCssP,p=o.lenCssP,r=this.id;mstrmojo.array.forEach(["lowerRange","containerNode","thumbNode","upperRange"],function(AA,v){var z=mstrmojo.all[r],x=z[AA].style,w=q[AA].style;if(v){w[n]=x[n];}w[p]=x[p];});q.containerNode.style.display="block";return q;}mstrmojo.MetricSlider=mstrmojo.declare(mstrmojo.Slider,[mstrmojo._HasPopup],{scriptClass:"mstrmojo.MetricSlider",markupString:'<div><div class="mstrmojo-Slider-summary"></div><div class="mstrmojo-Slider {@cssClass} {@clsType} {@clsOrientation}" style="{@cssText}" ><div class="cont" style=""><div class="sdc" style="position:absolute;{@sdcCssText}"><div class="sd" style="{@sdCssText}"><div class="bk left" style="{@lowerRangeCssText}"></div><div class="t1" style="{@handle1CssText}" mstrAttach:mouseover,mouseout,click></div><div class="t2 bk" style="{@thumbCssText}"></div><div class="t3" style="{@handel2CssText}" mstrAttach:mouseover,mouseout,click></div><div class="bk right" style="{@upperRangeCssText}"></div></div></div><div class="mstrmojo-Label" style="margin-top:9px;float:left;"></div><div class="mstrmojo-Label" style="margin-top:9px;float:right;"></div></div></div></div>',markupSlots:{summaryNode:function(){return this.domNode.childNodes[0];},sliderNode:function(){return this.domNode.childNodes[1];},dndNode:function(){return this.domNode.childNodes[1].childNodes[0];},sdcNode:function(){return this.domNode.childNodes[1].childNodes[0].childNodes[0];},containerNode:function(){return this.domNode.childNodes[1].childNodes[0].childNodes[0].childNodes[0];},lowerRange:function(){return this.domNode.childNodes[1].childNodes[0].childNodes[0].childNodes[0].childNodes[0];},handle1Node:function(){return this.domNode.childNodes[1].childNodes[0].childNodes[0].childNodes[0].childNodes[1];},thumbNode:function(){return this.domNode.childNodes[1].childNodes[0].childNodes[0].childNodes[0].childNodes[2];},handle2Node:function(){return this.domNode.childNodes[1].childNodes[0].childNodes[0].childNodes[0].childNodes[3];},upperRange:function(){return this.domNode.childNodes[1].childNodes[0].childNodes[0].childNodes[0].childNodes[4];},tooltipNode:function(){return this.domNode.childNodes[1].childNodes[0].childNodes[0];},lowNode:function(){return this.domNode.childNodes[1].childNodes[0].childNodes[1];},highNode:function(){return this.domNode.childNodes[1].childNodes[0].childNodes[2];},editValueNode:function(){return this.domNode;}},markupMethods:{onlowTextChange:function(){this.lowNode.innerHTML=this.lowText||"";},onhighTextChange:function(){this.highNode.innerHTML=this.highText||"";},onfontChange:function(){this.lowNode.style.font=this.highNode.style.font=String(this.font);}},init:function g(n){this._super(n);this.handleSize=mstrmojo.MetricSlider.METRICSLIDERTHUMBWIDTH;this.clsType="scm";this.typeHelper=new O(this);this.useRichTooltip=false;},typeHelper:null,unSet:false,preBuildRendering:function A(){var q=this.orCfg,p=this.isHoriz;q.cPosCssP=p?"right":"bottom";q.cLenCssP=p?"height":"width";var u=q.lenCssP,t=this[u],r=parseInt(t,10),o=this.handleSize;var n=this._length=(isNaN(r))?0:(r-o-a);if(n<=0){n=this._length=mstrmojo.MetricSlider.METRICSLIDERDEFAULTWIDTH-o;}if(t){this.bkCssText=u+":"+c(r-(2*this.cssBkBW),0)+"px;";this.sdcCssText=q.posCssP+":"+a+"px;"+u+":"+n+"px;"+q.opPosCssP+":0px;";}this.typeHelper.initialMetricSlider();this.typeHelper.updateThumb();},postBuildRendering:function R(){this._super();if(!this.staticStatus&&!this.da.nov){var o=this.lowNode,n=parseInt(o.style.fontSize,10);if(isNaN(n)){o.style.fontSize=8*this.parent.model.getZoomFactor()+"pt";}this.updateSummary();}this.lowNode.style.marginLeft=a+"px";this.highNode.style.marginRight=a+"px";this.sliderNode.style.height="0px";},onmouseover:function G(n){this.showTooltip(n.e,self);},onmouseout:function f(n){this.hideTooltip(n.e,self);},summaryLabels:{db:J(8153,"Between ## and ###"),dnb:J(8154,"Not between ## and ###"),din:J(587,"In"),dnin:J(2204,"Not in"),dnull:J(2202,"Is Null"),dnnull:J(2203,"Is not Null"),req:J(8155,"Rank ="),rneq:J(8156,"Rank <>").replace("<>",String.fromCharCode(8800)),rexb:J(8157,"Rank exclude bottom"),rext:J(8158,"Rank exclude top"),rb:J(8159,"Rank bottom"),rt:J(8160,"Rank top"),rbt:J(8161,"Rank between ## and ###"),rnbt:J(8162,"Rank not between ## and ###"),rin:J(8163,"Rank in"),rnin:J(8164,"Rank not in"),peq:J(8165,"Percent ="),pneq:J(8166,"Percent <>").replace("<>",String.fromCharCode(8800)),pexb:J(8167,"Exclude bottom"),pext:J(8168,"Exclude top"),pb:J(7576,"Bottom"),pt:J(7575,"Top"),pbt:J(8153,"Between ## and ###"),pnbt:J(8154,"Not between ## and ###"),pin:J(8169,"Percent in"),pnin:J(8170,"Percent not in")},formatNumber:function h(u){var p=this,AA=Math.abs(u),z=p.numFmts.cat,o=1000,AB=["K","M","B","T","P","E","Z","Y"],w=AB.length,t;if(AA>=o&&(z===k.Default||z===k.Fixed||z===k.General||z===k.Currency)){for(t=0;t<w;t++,o*=1000){if(AA<o*1000){var n=AA/o,r=(n*10).toFixed(0)%10>0?1:0,x=n.toFixed(r)+AB[t];return u<0?"("+x+")":x;}}}return S.formatNumber(p.qua,u,p.numFmts);},updateSummary:function L(){if(this.summaryNode&&!this.staticStatus){var AH=this.f,p=this.ft,AG=S,AB=S.FN,o=S.MRPFN,x="",AE=(this.cs1Vl<this.cs2Vl)?this.cs1Vl:this.cs2Vl,AC=(this.cs1Vl>this.cs2Vl)?this.cs1Vl:this.cs2Vl,v=this.formatNumber(AE),u=this.formatNumber(AC),t=this.typeHelper,w=this.summaryLabels,n=parseInt(p,10),q=parseInt(AH,10),AD=(n===AG._GENERIC&&(q===AB.ISNULL||q===AB.ISNOTNULL||q===AB.NOTIN||q===AB.IN))||((n===AG._PERCENT||n===AG._RANK)&&(q===o.INASCENDING||q===o.INDESCENDING||q===o.NOTINDESCENDING||q===o.NOTINASCENDING));if(this.unSet||AE<=this.low&&AC>=this.high&&this.include){x=mstrmojo.desc(2058,"All");}if(!this.unSet||AD){switch(p){case AG._GENERIC:switch(AH){case AB.EQUALS:x="= "+v;break;case AB.NOTEQUALS:x=String.fromCharCode(8800)+" "+v;break;case AB.GREATERTHAN:x="> "+u;break;case AB.GREATERTHANEQUALS:x=String.fromCharCode(8805)+" "+v;break;case AB.LESSTHAN:x="< "+v;break;case AB.LESSTHANEQUALS:x=String.fromCharCode(8804)+" "+u;break;case AB.BETWEEN:x=v+" - "+u;break;case AB.NOTBETWEEN:x=mstrmojo.desc(1099)+" "+v+" - "+u;break;case AB.ISNULL:x=w.dnull;break;case AB.ISNOTNULL:x=w.dnnull;break;case AB.IN:x=w.din+" "+t.joinConst();break;case AB.NOTIN:x=w.dnin+" "+t.joinConst();break;}break;case AG._PERCENT:case AG._RANK:var AF="r";if(parseInt(p,10)===AG._PERCENT){AF="p";}switch(AH){case o.EQUALSDESCENDING:case o.EQUALSASCENDING:x=w[AF+"eq"]+" "+v;break;case o.NOTEQUALSDESCENDING:case o.NOTEQUALSASCENDING:x=w[AF+"neq"]+" "+v;break;case o.GREATERTHANEQUALSASCENDING:x=w[AF+"exb"]+" "+v;break;case o.GREATERTHANASCENDING:x=w[AF+"exb"]+" "+u;break;case o.GREATERTHANEQUALSDESCENDING:x=w[AF+"ext"]+" "+v;break;case o.GREATERTHANDESCENDING:x=w[AF+"ext"]+" "+u;break;case o.LESSTHANASCENDING:x=w[AF+"b"]+" "+v;break;case o.LESSTHANEQUALSASCENDING:x=w[AF+"b"]+" "+u;break;case o.LESSTHANDESCENDING:x=w[AF+"t"]+" "+v;break;case o.LESSTHANEQUALSDESCENDING:x=w[AF+"t"]+" "+u;break;case o.BETWEENDESCENDING:case o.BETWEENASCENDING:x=w[AF+"bt"].replace("##",v).replace("###",u);break;case o.NOTBETWEENASCENDING:case o.NOTBETWEENDESCENDING:x=w[AF+"nbt"].replace("##",v).replace("###",u);break;case o.INASCENDING:case o.INDESCENDING:x=w[AF+"in"]+" "+t.joinConst();break;case o.NOTINDESCENDING:case o.NOTINASCENDING:x="";x=w[AF+"nin"]+" "+t.joinConst();break;}break;}}var z=this.summaryNode,AA=(x!=="")?"":0;z.innerHTML=x;z.style.margin=AA;}},getClientHeight:function U(){return this.dndNode.clientHeight+this.summaryNode.clientHeight+15;},initDrag:function l(r,n){if(!this.staticStatus&&!this.da.nov){n=n||window;var t=V.eventTarget(n,this.dnd.startE);if(t===this.handle1Node||t===this.handle2Node){var q=D.call(this),o=this.orCfg,p=this.dnd;p.initD={handle1:parseFloat(this.handle1,10),handle2:parseFloat(this.handle2,10)-a,length:this._length,contL:q.containerNode[o.lenP],offset:V.getMousePosition(this.dnd.startE,n)[o.offsetP]};p.initD.td=t;W.removeClass(this.domNode.childNodes[1],["invalid"]);}}},ondrag:function K(u,t){if(!this.staticStatus){t=t||window;var w=this.dnd.initD;if(w){var AD=this.ghost,AE=w.handle1,q=w.handle2,r=this.cs1Idx,p=this.cs2Idx,AB=this.unit,z=this.gap,o=w.length;var AA=V.getMousePosition(u,t)[this.orCfg.offsetP]-w.offset;switch(w.td){case this.handle1Node:AE=c(H(c(w.handle1+AA,0),o)-z,-1);r=c(e(AE/AB+0.5),0);break;case this.handle2Node:q=c(H(c(w.handle2+AA,0),o)-z,-1);p=c(B.ceil(q/AB+0.5),0);break;default:return ;}M(this,AD,AE,q);var v=this.items,n=(v&&v.length)||0;if(n&&r>=0&&r<n&&p>=0&&p<n){var AC=false,x;if(r!==this.cs1Idx){this.cs1Idx=r;x=this.items[r];this.cs1Vl=x.v;this.cs1Nm=x.n;AC=true;}if(p!==this.cs2Idx){this.cs2Idx=p;x=this.items[p];this.cs2Vl=x.v;this.cs2Nm=x.n;AC=true;}if(AC){this.typeHelper.updateThumb();this._updateTooltip(w.td);}}}}},ondrop:function Z(o){if(!this.staticStatus&&!this.da.nov){this.typeHelper.updateThumb();var n=this.ghost;if(n){n.containerNode.style.display="none";}this.hideTooltip(o,self);var p=this.dnd&&this.dnd.initD;if(this.makeSelection&&p){this.makeSelection({selItem:p.td});}if(this.items&&this.items.length&&this.ghost){this[(V.eventTarget(self,o)===this.ghost.handle1Node)?"frtUst":"ndUst"]=false;this.selectRange();}this.dnd.initD=null;}},selectRange:function Q(){var n=this.typeHelper,p=this.cs1Vl,o=this.cs2Vl,t=this.qua,r=this.numFmts;this.cs1Idx=n.getIdx(p);this.cs2Idx=n.getIdx(o);this.cs1Nm=S.formatNumber(t,p,r);this.cs2Nm=S.formatNumber(t,o,r);n.updateOpCs();this.onselectionChange();this.updateSummary();},onincludeChange:function C(){if(!this.staticStatus){this.changeInclude=true;this.selectRange();}},showTooltip:function m(o,n){var p=V.eventTarget(n,o);this._updateTooltip(p);mstrmojo.tooltip.open(this,o,n);},_updateTooltip:function P(r){if(N.walk("handle1Node",this.ghost)===r||N.walk("handle2Node",this.ghost)===r){return ;}var o=this.orCfg,q=o.posCssP,n,p={contentNodeCssClass:"scm-tooltip",refNode:this.domNode.childNodes[1],posType:this._tooltip_pos};p[o.opPosCssP]=-parseInt(this.font,10)/2;p[q]=r.style[q];n=String((r===this.handle1Node)?this.cs1Nm:this.cs2Nm);p.content=E.replace(/\{@content\}/g,n);this.set("richTooltip",p);},onclick:function b(n){if(!this.staticStatus&&!this.da.nov){var o=V.eventTarget(n.hWin||window,n.e);this.hideTooltip(n.e,self);this.dnd.initD={makeMetricSilderSelectionByClick:true,td:((o===this.handle1Node)?this.handle1Node:((o===this.handle2Node)?this.handle2Node:null))};this.openEditValue({isfrt:(o===this.handle1Node),tgt:o});if(this._onThumb){this._onThumb(n);}}},onselectionChange:function I(n){this._super(n);if(this.dnd.initD&&this.dnd.initD.makeMetricSilderSelectionByClick){this.dnd.initD=null;}},onquaChange:function d(n){var p=S.getFuncInfo(this.opId,n.valueWas),q=S.getFuncInfo(this.opId,n.value),o;if(p.ft!==q.ft){if(!this.staticStatus){this.items=[];this.cs=[];this.f=this.ft=null;this.refresh();o=true;}}else{this.f=S.getFuncInfo(this.opId,n.value).f;o=false;}this.unSet=o||this.unSet;this.changeQual=true;this.selectRange();},updateData:function F(n,o){this.da=n;this.updateExpr(o);},updateExpr:function j(n){if(n){this.cs=n.cs;this.f=n.f;this.ft=n.ft;this.qua=n.qua;}this.refresh();},editValueRef:{cssClass:"edvl",slot:"editValueNode",scriptClass:"mstrmojo.Popup",locksHover:true,onOpen:function(){if(this.tgt){this.set("left",H(c(parseInt(this.tgt.style.left,10),0),parseInt(this.opener.width,10)-90)+"px");this.set("top",this.tgt.style.top);}var p=this.opener,o=this.children[0];if(p){var n=this.isfrt?p.cs1Vl:p.cs2Vl;o.edt.set("value",Y.toLocaleString(n));}},children:[{scriptClass:"mstrmojo.Table",rows:1,cols:2,layout:[{cells:[{cssText:"width: 40px; padding: 3px;"},{cssText:"width: 16px;padding: 3px;"}]}],children:[{slot:"0,0",scriptClass:"mstrmojo.ValidationTextBox",alias:"edt",cssText:"color:black",dtp:mstrmojo.expr.DTP.NUMERIC,constraints:{trigger:mstrmojo.validation.TRIGGER.ALL},onValid:function(){if(this.parent.apply){this.parent.apply.set("enabled",String(this.value).length!==0);}},onInvalid:function(){if(this.parent.apply){this.parent.apply.set("enabled",false);}},onkeyup:function(o){if(this.parent.apply.enabled){var n=o.hWin,p=o.e||n.event;if(p.keyCode===13){this.parent.apply.onclick();}}}},{slot:"0,1",scriptClass:"mstrmojo.Button",cssClass:"icn apply",alias:"apply",onclick:function(){var o=this.parent.parent,q=o.opener,n=this.parent.edt.value;if(o&&q&&String(n).length>0){q[o.isfrt?"cs1Nm":"cs2Nm"]=n;n=Y.parseNumeric(n);q[o.isfrt?"cs1Vl":"cs2Vl"]=n;}q[o.isfrt?"frtUst":"ndUst"]=true;q.selectRange();q.typeHelper.updateThumb();o.close();}}]}]},openEditValue:function(n){this.openPopup("editValueRef",n);}});mstrmojo.MetricSlider.METRICSLIDERTHUMBWIDTH=14;mstrmojo.MetricSlider.METRICSLIDERDEFAULTWIDTH=95;}());(function(){mstrmojo.requiresCls("mstrmojo.css","mstrmojo.hash","mstrmojo.Box","mstrmojo.Label","mstrmojo.expr","mstrmojo.ValidationTextBox","mstrmojo.Dialog","mstrmojo.cookies","mstrmojo.string");mstrmojo.requiresDescs(17,18,221,9772,11773,14028,16220,16227,14138,14139,14140,14149,14522,14523,14524,16224,14526,14527);var M=mstrmojo.css,W=mstrmojo.dom,I=mstrmojo.hash;var D=mstrmojo.validation,G=D.STATUSCODE,H=D.TRIGGER,V=D.VALIDATOR,K=mstrmojo.expr.DTP;var c={intervalCtr:0,qrLoaded:false,maxPollingAttempts:80,timeDelay:3000};var Q={mini_badge:"#ddd",mini_badge_icon:"../style/mstr/images/badge-placeholder-m.png",t_color:"#797979",appName:"",name:""};var F={firstName:"",badgeId:""};var J={duration:undefined,elem:undefined,callback:undefined,timerInterval:null,init:function(e,d,f){this.duration=e;this.elem=d;this.callback=f;},startTimer:function(){this.stopTimer();var j=Date.now(),f,d,g;var e=this;function h(){f=e.duration-(((Date.now()-j)/1000)|0);d=(f/60)|0;g=(f%60)|0;d=d<10?"0"+d:d;g=g<10?"0"+g:g;e.elem.set("text",d+":"+g);if(f<=0){j=Date.now()+1000;e.callback();e.stopTimer();}}h();this.timerInterval=setInterval(h,1000);},stopTimer:function(){if(this.timerInterval){clearInterval(this.timerInterval);}}};function B(d){d.sn=this.serverName||mstrConfig.serverName;d.sp=this.serverPort||mstrConfig.serverPort;d.connectionId=this.connectionId||"";return d;}function R(){this.set("expired",true);this.usherProps.qrLoaded=false;}function N(){try{var f=this.usherProps;var d=this;if(f.qrLoaded){if(f.intervalCtr>f.maxPollingAttempts){R.call(d);}else{clearTimeout(this.pullTimeout);this.pullTimeout=setTimeout(function(){f.intervalCtr+=1;if(!d.stopPolling){X.call(d);}},f.timeDelay);}}}catch(g){}}function P(f,e,d){if(mstrApp.serverRequest){mstrApp.serverRequest(f,e,d);}else{mstrmojo.xhr.request("POST",mstrConfig.taskURL,e,f);}}function X(){var e=this,f=this.usherProps,g={taskId:"usherLoginWeb",pollOnly:"true",server:this.serverName||mstrConfig.serverName,port:this.serverPort||mstrConfig.serverPort,project:this.projectName||mstrConfig.projectName,connectionId:this.connectionId},d={success:function(j){try{if(j.status=="invalid"){N.call(e);}else{if(j.status=="success"){function h(n){e.onUsherLogin(n);f.qrLoaded=false;}if(e.rememberMe===true){var k={success:function(n){h(n);},failure:function(n){e.onUsherError(n);}};var m={taskId:"usherRememberMe"};m.deviceId=mstrmojo.cookies.getCookieSetting("usher_sso_device")?mstrmojo.cookies.getCookieSetting("usher_sso_device"):"";P(m,k,{doNotHold:true});}else{h(j);}}}}catch(l){mstrmojo.alert("usherPollForScan:\n "+l.messsage);}},failure:function(h){R.call(e);e.onUsherError(h);}};P(g,d,{doNotHold:true});}function a(d){this.userDetails.set("text",d||"");}function L(d){var e=this;e.loginButton.set("visible",d);e.loginNotificationBox.set("visible",!d);}function C(){var g=this.usherProps;var f=this.notificationTimer;var e=this,d={success:function(k){try{if(k.status==1){function n(){L.call(e,true);}function j(){if(e.pullTimeout){clearTimeout(e.pullTimeout);}e.usherProps.intervalCtr=0;g.qrLoaded=true;N.call(e);}var m=60*5;f.init(m,e.loginNotificationBox.timer,n);f.startTimer();L.call(e,false);j();}else{e.onUsherError(k);}}catch(l){mstrmojo.alert("Error:\n"+l.message);}},failure:function(j){e.onUsherError(j);}},h={taskId:"usherNotifyMe"};h.deviceId=mstrmojo.cookies.getCookieSetting("usher_sso_device")?mstrmojo.cookies.getCookieSetting("usher_sso_device"):"";P(B.call(this,h),d,{doNotHold:true});}function A(){var e=this,d={success:function(g){try{e.set("notificationMode",false);e.reloadQR();}catch(h){mstrmojo.alert("Error:\n"+h.messsage);}},failure:function(g){e.onUsherError(g);}},f={taskId:"usherRememberMe",rememberMe:false};if(e.userInfo.badgeId!==""){f.badgeId=e.userInfo.badgeId;}f.deviceId=mstrmojo.cookies.getCookieSetting("usher_sso_device")?mstrmojo.cookies.getCookieSetting("usher_sso_device"):"";P(B.call(this,f),d,{doNotHold:true});}function O(h){if(this.notificationMode==true&&!h){return ;}var f=this.usherProps;this.showQRLoading(true);var e=this,d={success:function(k){try{if(k.img){e.set("notificationMode",false);e.updateQRCode(k.img);e.set("badge",k.badgeInfo&&k.badgeInfo[0]);f.intervalCtr=0;f.qrLoaded=true;this.stopPolling=false;N.call(e);}else{var l=JSON.parse(k.data);var j=l.pnEnabled||l.isPNEnabled;e.set("isPnEnabled",j);if(l.code||l.proximityBasedLogin){e.set("notificationMode",false);if(l.proximityBasedLogin&&!h){e.updateQRCodeProximity();e.set("proximityMode",true);}else{e.updateQRCode(l.code);e.set("proximityMode",false);}e.set("badge",k.badgeInfo&&k.badgeInfo[0]);f.intervalCtr=0;f.qrLoaded=true;this.stopPolling=false;mstrmojo.cookies.updateCookieSetting("usher_sso_device",k.device_id);N.call(e);}else{e.set("proximityMode",false);e.set("notificationMode",true);e.refresh.set("visible",false);if(l.photoData&&e.userInfoNode){e.userInfoNode.src="data:image/png;base64,"+l.photoData;}e.userInfo.firstName=l.firstName;e.userInfo.badgeId=l.badgeId;L.call(e,true);e.set("badge",k.badgeInfo&&k.badgeInfo[0]);}}}catch(m){mstrmojo.alert("getQRCode:\n "+m.messsage);}},failure:function(j){e.handleQRCodeError(j);R.call(e);e.onUsherError(j);},complete:function(){e.showQRLoading(false);}},g={taskId:"usherQRWeb"};g.deviceId=mstrmojo.cookies.getCookieSetting("usher_sso_device")?mstrmojo.cookies.getCookieSetting("usher_sso_device"):"";P(B.call(this,g),d,{doNotHold:true});}function E(){var f=this,j=this.registerButton,g=this.parent.badgeNode.childNodes[1];if(j.enabled){j.set("enabled",false);M.addClass(g,["anim"]);var d={},e={success:function(k){var l=k&&k.name==f.user.value;d={msg:l?mstrmojo.desc(14139,"You've successfully registered. Please check your email to continue.")+" "+mstrmojo.desc(16222,"Or perform a MicroStrategy badge recovery."):k.getResponseHeader("X-MSTR-TaskFailureMsg"),successful:l};},failure:function(k){d={msg:k.getResponseHeader("X-MSTR-TaskFailureMsg"),successful:false};},complete:function(){j.set("enabled",true);M.removeClass(g,["anim"]);f.set("regMsg",d);}},h={taskId:"usherRegUsr",server:this.serverName||mstrConfig.serverName,project:mstrConfig.projectName,port:this.serverPort||mstrConfig.serverPort,email:this.email.value,userid:this.user.value,password:this.pwd.value};P(h,e);}}function U(d){return mstrmojo.hash.copy(d,{scriptClass:"mstrmojo.ValidationTextBox",cssDisplay:"block",postCreate:function(){if(W.isIE9||W.isIE8||W.isIE7){this.emptyText=this.hint;}},onEnter:function(){E.call(this.parent);}});}mstrmojo.UsherLogin=mstrmojo.declare(mstrmojo.Container,null,{scriptClass:"mstrmojo.UsherLogin",markupString:'<div id="{@id}" class="mstrmojo-UsherLogin-Container {@cssClass}" style="{@cssText}" ><div class="mstrmojo-UsherLogin-badge"><div class="icn"><img src="../images/1ptrans.gif"/></div><div class="dots"><div class="dot1"></div><div class="dot2"></div><div class="dot3"></div></div><div class="app"><img src="../style/mstr/images/badge-app.png"/></div></div><div class="mstrmojo-UsherLogin-badgeLabel"><div class="app-name"></div><div id="badgename" class="badge-name"></div></div><div class="mstrmojo-UsherLogin"><div class="mstrmojo-UsherLogin-QR mode"><img class="QR" src="../images/1ptrans.gif" alt="" /></div><div class="mstrmojo-UsherLogin-register mode"></div></div><div class="mstrmojo-UsherLogin-userInfo mode"><img class="userInfo" src="../images/1ptrans.gif" alt="" /></div><div class="mstrmojo-UsherLogin-notification"></div><div class="mstrmojo-UsherLogin-remember-setting"><div class = "mstrmojo-UsherLogin-remember"></div><div class = "mstrmojo-UsherLogin-forget"></div></div><div class="mstrmojo-UsherLogin-link"></div></div>',markupSlots:{containerNode:function(){return this.domNode;},badgeNode:function(){return this.domNode.firstChild;},badgeIconNode:function(){return this.domNode.firstChild.firstChild.firstChild;},badgeLabelNode:function(){return this.domNode.childNodes[1];},usherNode:function(){return this.domNode.childNodes[2];},qrNode:function(){return this.domNode.childNodes[2].firstChild;},qrCodeNode:function(){return this.domNode.childNodes[2].firstChild.firstChild;},refreshNode:function(){return this.domNode.childNodes[2].firstChild.lastChild;},registerNode:function(){return this.domNode.childNodes[2].lastChild;},userNode:function(){return this.domNode.childNodes[3];},userInfoNode:function(){return this.domNode.childNodes[3].firstChild;},notificationNode:function(){return this.domNode.childNodes[4];},rememberSettingsNode:function(){return this.domNode.childNodes[5];},rememberNode:function(){return this.domNode.childNodes[5].firstChild;},forgetNode:function(){return this.domNode.childNodes[5].lastChild;},linksNode:function(){return this.domNode.lastChild;}},markupMethods:{onqrCodeChange:function(){if(this.qrCodeNode){this.qrCodeNode.src=this.qrCode;}},onbadgeChange:function(){var e=this.badge||Q,j=e.badgeFormat,d=j&&JSON.parse(j)||{isnull:true},g=this.badgeLabelNode,f=this.badgeIconNode,h=this.domNode;if(this.showBadgeBackgroundImage){h.style.backgroundColor=d.mini_badge;if(d.bg_4){h.style.backgroundImage="url("+d.bg_4+")";}}f.src=d.mini_badge_icon||Q.mini_badge_icon;if(!d.isnull&&!d.mini_badge_icon){M.addClass(f.parentNode,"default");}g.firstChild.innerHTML=mstrmojo.string.encodeHtmlString(e.appName||Q.appName);g.lastChild.innerHTML=mstrmojo.string.encodeHtmlString(e.name||Q.name);g.lastChild.title=e.name||Q.name;g.style.color=d.t_color||Q.t_color;this.linksNode.style.color=d.t_color||Q.t_color;},onexpiredChange:function(){M.toggleClass(this.usherNode,"expired",this.expired);},onloadingChange:function(){M.toggleClass(this.usherNode,"loading",this.loading);},onvisibleChange:function(){this.domNode.style.display=this.visible?"block":"none";if(this.visible&&this.canRequestQR()&&!this._lastVisible){O.call(this);}this.stopPolling=!this.visible;this._lastVisible=this.visible;},onnotificationModeChange:function(d){M.toggleClass(this.containerNode,"notificationMode",this.notificationMode);},onproximityModeChange:function(d){M.toggleClass(this.containerNode,"proximityMode",this.proximityMode);},onisPnEnabledChange:function(){this.hideRememberMe(!this.isPnEnabled);}},qrCode:"../images/1ptrans.gif",badge:Q,expired:false,onUsherLogin:mstrmojo.emptyFn,onUsherError:mstrmojo.emptyFn,showBadgeBackgroundImage:true,usherProps:null,serverName:null,serverPort:null,rememberMe:false,userInfo:null,notificationTimer:null,loadQR:false,notificationMode:false,isPnEnabled:false,init:function S(d){if(this._super){this._super(d);}M.addWidgetCssClass(this,"");this.usherProps=this.usherProps?I.copy(this.usherProps,I.clone(c)):I.clone(c);this.userInfo=this.userInfo?I.copy(this.userInfo,I.clone(F)):I.clone(F);this.notificationTimer=this.notificationTimer?I.copy(this.notificationTimer,I.clone(J)):I.clone(J);},destroy:function Y(d){this.stopPolling=true;clearTimeout(this.pullTimeout);this._super(d);},canRequestQR:function(){return this.usherProps&&(this.loadQR||(this.serverName||mstrConfig.serverName));},showUserInfo:function(d){this.refresh.set("visible",false);this.refresh.set("visible",false);},updateQRCode:function(d){this.set("qrCode","data:image/png;base64,"+d);this.set("expired",false);this.refresh.set("visible",false);},updateQRCodeProximity:function(){this.set("qrCode","../images/WaitUsherRadar.gif");this.set("expired",false);this.refresh.set("visible",false);},handleQRCodeError:function(){this.set("qrCode","../style/mstr/images/msgError.gif");this.set("expired",true);this.refresh.set("visible",true);},showQRLoading:function Z(d){this.set("loading",d);if(d){this.refresh.set("visible",false);}},postBuildRendering:function(){this._super();this.registerForm.set("tabIndex",-1);},toggleRegister:function(d){this.registerVisible=(d!==undefined)?d:!this.registerVisible;M.toggleClass(this.usherNode,"show-register",this.registerVisible);this.registerLink.set("text",this.registerLink.texts[this.registerVisible?1:0]);if(this.isPnEnabled===true){this.hideRememberMe(this.registerVisible&&this.isPnEnabled);}},hideRememberMe:function(d){M.toggleClass(this.rememberSettingsNode,"hide-rememeber",d);},reloadQR:function(){if(this.canRequestQR()){if(this.pullTimeout){clearTimeout(this.pullTimeout);}this.usherProps.intervalCtr=0;this.usherProps.qrLoaded=false;if(this.visible){O.call(this);}}},children:[{scriptClass:"mstrmojo.Label",slot:"qrNode",alias:"refresh",cssClass:"refresh",text:mstrmojo.desc(14028,"Refresh QR Code"),visible:false,onclick:function(){O.call(this.parent);}},{scriptClass:"mstrmojo.Box",slot:"registerNode",alias:"registerForm",regMsg:null,children:[U({alias:"user",cssClass:"login-username",cssDisplay:"block",hint:mstrmojo.desc(17,"User name")}),U({alias:"pwd",cssClass:"login-pwd",hint:mstrmojo.desc(18,"Password"),type:"password"}),U({alias:"email",cssClass:"login-email",dtp:K.VARCHAR,constraints:{validator:V.VALIDATE_EMAIL,trigger:mstrmojo.validation.TRIGGER.ONKEYUP},bindings:{visible:"this.parent.parent.usherRegistrationOption > 2"},hint:mstrmojo.desc(9772,"Email")}),U({alias:"confirmEmail",cssClass:"login-email",bindings:{visible:function(){return this.parent.parent.usherRegistrationOption>2;}},hint:mstrmojo.desc(14149,"Confirm Email"),onpaste:function(d){W.preventDefault(d.hWin,d.e||d.hWin.event);}}),{scriptClass:"mstrmojo.Box",alias:"regMsg",cssClass:"register-msg",bindings:{regMsg:function(){return this.parent.regMsg;},visible:function(){return this.parent.regMsg;}},onregMsgChange:function(){if(this.domNode){this.domNode.style.color=this.regMsg&&this.regMsg.successful?"#42C31E":"#f00";}},children:[{scriptClass:"mstrmojo.Label",alias:"msg",cssClass:"register-msg-txt",bindings:{text:function(){return this.parent.regMsg.msg;}}},{scriptClass:"mstrmojo.Label",alias:"icn",cssClass:"register-msg-icn",onclick:function(){this.parent.parent.parent.toggleRegister();this.parent.parent.set("regMsg",null);}}]},{scriptClass:"mstrmojo.Button",alias:"registerButton",cssClass:"register mstrmojo-WebButton hot",cssDisplay:"inline-block",text:mstrmojo.desc(11773,"Register"),bindings:{enabled:function(){var k=this.parent.user.value,g=this.parent.email.value,e=this.parent.confirmEmail.value;var f=k.length>0;if(f){if(this.parent.parent.usherRegistrationOption>1){var j=g.length>=3&&e.length>=3&&g.toUpperCase()===e.toUpperCase()&&this.parent.email.validationStatus.code===G.VALID;if(j){if(this.parent.parent.usherRegistrationOption==7){var h=this.parent.parent.usherRegistrationDomain.toUpperCase();var d=g.substr(g.indexOf("@")+1).toUpperCase();return h.indexOf(d)>=0;}}return j;}}return f;}},onclick:function(){E.call(this.parent);}},{scriptClass:"mstrmojo.Button",alias:"registerCancelButton",cssClass:"register-cancel",cssDisplay:"inline-block",text:mstrmojo.desc(221,"Cancel"),onclick:function(){var d=this.parent;d.parent.toggleRegister();d.set("regMsg",null);d.user.set("value","");d.pwd.set("value","");d.email.set("value","");d.confirmEmail.set("value","");d.user.domNode.focus();}}]},{scriptClass:"mstrmojo.CheckBox",slot:"rememberNode",alias:"remember-me",label:mstrmojo.desc(14522,"Remember me"),onclick:function b(){this.parent.set("rememberMe",this.checked);}},{scriptClass:"mstrmojo.Label",slot:"forgetNode",allowHTML:true,text:mstrmojo.desc(14527,"Forget me/Switch user"),onclick:function(){A.call(this.parent);}},{scriptClass:"mstrmojo.Label",slot:"linksNode",allowHTML:true,text:'<a id="proximityProblems" href="#">Login via Phone</a>',onclick:function(d){O.call(this.parent,true);return false;},bindings:{visible:"this.parent.proximityMode"},},{scriptClass:"mstrmojo.Label",slot:"linksNode",allowHTML:true,text:mstrmojo.desc(16220,"Use your ###MicroStrategy Badge## app to scan the QR Code.").replace("###","").replace("##",""),},{scriptClass:"mstrmojo.Label",slot:"linksNode",alias:"registerLink",cssClass:"register-label",allowHTML:true,bindings:{visible:"this.parent.usherRegistrationOption > 0"},text:"",texts:[mstrmojo.desc(16227,"Don't have MicroStrategy Badge? Click ###here## to register."),mstrmojo.desc(14140,"Display your ###QR Code##.")],postCreate:function(){this.set("text",this.texts[0]);},ontextChange:function(){this.text=this.text.replace("###",'<a href="#" onclick="mstrmojo.all.'+this.parent.id+'.toggleRegister(); return false;">').replace("##","</a>");}},{scriptClass:"mstrmojo.Label",alias:"userDetails",cssClass:"user-details",slot:"userNode"},{scriptClass:"mstrmojo.Button",alias:"loginButton",cssClass:"mstrmojo-WebButton login-button .mstrButton",cssDisplay:"inline-block",text:mstrmojo.desc(16224,"Login with MicroStrategy Badge"),slot:"notificationNode",visible:false,onclick:function(){C.call(this.parent);},onvisibleChange:function(){var d=this.parent,e=mstrmojo.desc(14523,"Hi ")+" "+d.userInfo.firstName;this.visible?e+="!":e+=mstrmojo.desc(14524,", please approve on your device.");a.call(d,e);}},{scriptClass:"mstrmojo.Box",alias:"loginNotificationBox",cssClass:"login-notification",slot:"notificationNode",visible:false,children:[{scriptClass:"mstrmojo.Label",alias:"timer",cssClass:"notification-timer"},{scriptClass:"mstrmojo.Label",alias:"notificationFailure",cssClass:"notification-failure",text:mstrmojo.desc(14526,"Did not get notification"),onclick:function(){L.call(this.parent.parent,true);}}]},]});}());(function(){mstrmojo.requiresCls("mstrmojo.Button","mstrmojo.vi.ui.rw.selectors._HasWarningMessage","mstrmojo.vi.ui.rw._ValidInputLocalImage","mstrmojo.imageUtils");var A;$IMGUTIL=mstrmojo.imageUtils;mstrmojo.vi.ui.ImageEditorPanelImagePicker=mstrmojo.declare(mstrmojo.Container,[mstrmojo.vi.ui.rw.selectors._HasWarningMessage,mstrmojo.vi.ui.rw._ValidInputLocalImage],{scriptClass:"mstrmojo.vi.ui.ImageEditorPanelImagePicker",cssClass:"",markupString:'<div class=\'mstrmojo-ImageEditorModel-ImagePicker {@cssClass}\'><label><input style="position: absolute; left: -10000px" type="file" accept=".png, .jpg, .jpeg, .gif, .bmp" onchange="mstrmojo.all.{@id}.syncFile();"/><div class="browseBtnLabel"></div></label></div>',markupSlots:{containerNode:function(){return this.domNode;},fileNode:function(){return this.domNode.children[0].firstChild;},browseBtnNode:function(){return this.domNode.children[0].lastChild;}},children:[mstrmojo.Button.newWebButton(mstrmojo.desc(1825,"Browse"),function(){if(mstrApp.isSingleTier){A=this.parent;var C=window.FormWrapper;C.openImageFileDialog("mstrmojo.vi.ui.ImageEditorPanelImagePicker.onOneTierFileSelected");}},false,{alias:"browseBtn",slot:"browseBtnNode",enabled:true})],init:function B(C){this._super(C);this.bindWarningHandler(this);},validationFailed:function(){this._super();this.set("validation",this.getValidationObj());},syncFile:function(){if(this.fileNode.files.length===1){var C=this.fileNode.files[0];this.fileSelected.call(this,C);}}});mstrmojo.vi.ui.ImageEditorPanelImagePicker.onOneTierFileSelected=function(E){if(E&&E.data&&E.filename){var D=";base64,";if(E.data.indexOf(D)===-1){E.data="data:image/jpeg;base64,"+E.data;}var C=$IMGUTIL.dataURLToBlob(E.data);var F={fileBlob:C,name:E.filename};A.fileSelected.call(A,F);}};}());(function(){mstrmojo.requiresCls("mstrmojo.hash","mstrmojo.vi.ui.rw.selectors._HasWarningMessage","mstrmojo.vi.ui.rw._ValidInputLocalImage","mstrmojo.Button","mstrmojo.dom","mstrmojo.imageUtils","mstrmojo.string","mstrmojo.vi.ui.rw.ImageBoxOverlay");mstrmojo.requiresDescs(1825);var I=mstrmojo.string,J=mstrmojo.imageUtils,D=mstrmojo.dom,C;mstrmojo.vi.ui.rw.ImageBoxOverlayEmbeded=mstrmojo.declare(mstrmojo.vi.ui.rw.ImageBoxOverlay,[mstrmojo.vi.ui.rw.selectors._HasWarningMessage,mstrmojo.vi.ui.rw._ValidInputLocalImage],{scriptClass:"mstrmojo.vi.ui.rw.ImageBoxOverlayEmbeded",markupString:'<div id="{@id}" class="mstrmojo-ImageBoxOverlayEmbeded {@cssClass}" style="{@domNodeCssText}" mstrAttach:dragover,dragleave,drop><div class="container-scroll-host"><div class="container"><div class="lbl"></div><div class="txt"></div><div class="buttons"><label><input class="mstrmojo-imageBoxOverlayEmbeded-file" type="file" accept=".png, .jpg, .jpeg, .gif, .bmp" onchange="mstrmojo.all.{@id}.syncFile();"/><div class="browseBtnLabel"></div></label><div class="okBtn"></div></div></div></div></div>',markupSlots:{containerNode:function(){return this.domNode.firstChild;},labelNode:function(){return this.domNode.firstChild.firstChild.firstChild;},textNode:function(){return this.domNode.firstChild.firstChild.children[1];},fileNode:function(){return this.domNode.firstChild.firstChild.children[2].firstChild.firstChild;},browseBtnNode:function(){return this.domNode.firstChild.firstChild.children[2].firstChild.lastChild;},buttonNode:function(){return this.domNode.firstChild.firstChild.children[2].lastChild;}},postBuildRendering:function A(){this._super();this.bindWarningHandler(this);},children:[{scriptClass:"mstrmojo.Label",slot:"labelNode",cssClass:"init-label"},mstrmojo.Button.newWebButton(mstrmojo.desc(1442,"OK"),function(){var L=this.parent;if(L.imgURL.value!==L.origURLStr){L.imageBox.urlEdited(L.imgURL.value);}else{L.imageBox.hideControlOverlay();}},true,{alias:"okBtn",slot:"buttonNode",enabled:false}),{scriptClass:"mstrmojo.TextBox",cssClass:"init-input",alias:"imgURL",slot:"textNode",bindings:{hint:function(){if(this.parent.parent.parent.isEmbeddedImageFeatureEnabled){return mstrmojo.desc(14552,"Enter an image URL or choose a file.");}else{return mstrmojo.desc(10493,"Image URL");}}},onkeydown:function(L){if(L.e.keyCode===13){var M=this.parent;if(M.imgURL.value!==M.origURLStr){M.imageBox.urlEdited(this.value);}else{M.imageBox.hideControlOverlay();}}},onmousedown:function(L){D.stopPropogation(L.hWin,L.e);},onblur:function(L){this.parent.hasChanged();},getLayoutOffsets:function H(){return{h:0,w:2};},_set_value:function(O,L){var M=this.value;if(M!==L){this.value=L;var N=this.parent.okBtn;N.set("enabled",!I.isEmpty(L));}}},mstrmojo.Button.newWebButton(mstrmojo.desc(1825,"Browse"),function(){if(mstrApp.isSingleTier){C=this.parent;var L=window.FormWrapper;L.openImageFileDialog("mstrmojo.vi.ui.rw.ImageBoxOverlayEmbeded.onOneTierFileSelected");}},false,{alias:"browseBtn",slot:"browseBtnNode",enabled:true})],droppable:true,ondragover:function B(L){if(!this.droppable){return ;}var N=L.e;N.stopPropagation();N.preventDefault();var M=N.dataTransfer.items;if(M){N.dataTransfer.dropEffect=this.VALID_MIME_TYPES.indexOf(M[0]&&M[0].type)!==-1?"copy":"none";}mstrmojo.css.addClass(this.dnDNode,"dragging");},ondragleave:function K(){if(!this.droppable){return ;}this.className="";mstrmojo.css.removeClass(this.dnDNode,"dragging");},ondrop:function F(L){if(!this.droppable){return ;}var O=L.e;O.preventDefault();var N=O.dataTransfer.files;mstrmojo.css.removeClass(this.dnDNode,"dragging");if(N&&N.length>0){var M=N[0];this.fileSelected.call(this,M);}},validationFailed:function E(){this._super();var L=this.getValidationObj();if(L){L.refNode=this.textNode;}this.set("validation",L);this.okBtn.set("enabled",false);},validationSuccess:function G(L){this._super(L);this.okBtn.set("enabled",true);},syncFile:function(){if(this.fileNode.files.length===1){var M=this.fileNode.files[0];var L=M.size/1024;this.imgURL.set("value",M.name+" - "+L.toFixed(2)+"KB");this.fileSelected.call(this,M);}}});mstrmojo.vi.ui.rw.ImageBoxOverlayEmbeded.onOneTierFileSelected=function(N){if(N&&N.data&&N.filename){var M=";base64,";if(N.data.indexOf(M)===-1){N.data="data:image/jpeg;base64,"+N.data;}var L=J.dataURLToBlob(N.data);C.imgURL.set("value",N.filename);var O={fileBlob:L,name:N.filename};C.fileSelected.call(C,O);}};}());(function(){mstrmojo.requiresCls("mstrmojo._IsInputControl","mstrmojo.Box","mstrmojo.ElasticTextArea","mstrmojo.hash","mstrmojo.css");var G=4,F=5,E=6,C=7,B=10;var D=mstrmojo.hash,A=mstrmojo.css;mstrmojo.TextAreaDIC=mstrmojo.declare(mstrmojo.Box,[mstrmojo._IsInputControl],{scriptClass:"mstrmojo.TextAreaDIC",applyOnEnter:false,onfontChange:function(){var H=this.font;if(this.etab){this.etab.set("font",H);}else{if(this.eta){this.eta.set("font",H);}}},focus:function(){if(this.eta){this.eta.focus();}else{if(this.etab){this.etab.premousedown();}}},init:function(J){if(this._super){this._super(J);}if(this.showByDefault){var I,K=this.dic;if(K.siwc){I={cssText:"position:relative;min-height:18px;",ontextChange:function(){this.preview.set("text",this.text);},onvalueChange:function(){if(K.sp){var L=this.value,M=this.dv||"",O="",N="";switch(this.ts){case E:N="mailto:";case F:O=L.substring(0,K.pl);this.dv=M.replace(/(.*href=['"])(.*)(['"].*>)(.*)(<.*)/i,"$1"+N+L+"$3"+O+"$5");break;default:O=M.substring(0,K.pl);break;}this.preview.set("text",(K.pl>0&&M.length>K.pl)?O+"...   ":(K.pl>0&&O.length>0)?O:"");}if(this.etab.domNode){if(this.value&&this.value.length!==0){A.addClass(this.etab.domNode,"filled");}else{A.removeClass(this.etab.domNode,"filled");}}this.etab.value=this.value;this.applyChanges();},onpopupwidthChange:function(){this.etab.set("popupWidth",this.popupwidth||200);},onheightChange:function(){if(this.height){this.domNode.style.height=this.height+"px";}}};}else{I={cssText:"position:relative",onpopupwidthChange:function(){this.eta.set("width",(this.popupwidth-4)||200);},onheightChange:function(){if(this.domNode&&this.height){this.domNode.style.height=this.height+"px";this.eta.set("height",this.height-4);}}};}D.copy(I,this);if(K.siwc){this.addChildren([{alias:"preview",scriptClass:"mstrmojo.Label"},{alias:"etab",popupToBody:true,maxLength:K.ml||250,cssText:"position:absolute;right:0;top:0px",bindings:{enabled:"this.parent.enabled"},onvalueChange:function(){if(this.value!==this.parent.value){var M=this.parent,L="";switch(M.ts){case E:L="mailto:";case F:if(!M.dv){M.dv='<a href="mailto:"></a>';}var N=/(.*href=['"])(.*)(['"].*>)(.*)(<.*)/i;M.set("dv",M.dv.replace(N,"$1"+L+this.value+"$3"+this.value+"$5"));break;default:M.set("dv",this.value);break;}M.set("value",this.value);}},lockAutoClose:function(){var L=this.parent.showByDefault;if(L){this.parent.setInfoWindowLock(true);}},unlockAutoClose:function(){var L=this.parent.showByDefault;if(L){this.parent.setInfoWindowLock(false);}},premousedown:function(){var M=!this.popupRef.hasRendered;mstrmojo.ElasticTextAreaButton.prototype.premousedown.apply(this,arguments);if(M){var L=this.popupRef,N=this.parent;mstrmojo.dom.attachEvent(L.domNode,"keydown",function(O){var P=O||window.event;if(P.keyCode==9){L.close();N.onTabDown(O);}});}},scriptClass:"mstrmojo.ElasticTextAreaButton"}]);}else{var H=K.vm?{scriptClass:"mstrmojo.TextAreaValidation",dic:K}:{scriptClass:"mstrmojo.TextArea"};this.addChildren(D.copy(H,{alias:"eta",maxLength:K.ml||250,onheightChange:function(){if(this.hasRendered&&this.height){this.domNode.style.height=this.height+"px";}},onfontChange:function(){if(this.hasRendered&&this.font){D.copy(this.font,this.domNode.style);}},onblur:function(){if(!this.validate){this.parent.set("value",this.value);}else{this.validate();if(!this.isValid()){this.handleInvalid();}else{this.parent.set("value",this.value);}}},onwidthChange:function(){if(this.hasRendered&&this.width){this.domNode.style.width=this.width+"px";}},placeholderText:this.placeholderText,bindings:{value:"this.parent.value",enabled:"this.parent.enabled"}}));}this.onvalueChange();}else{this.addChildren({alias:"eta",scriptClass:"mstrmojo.ElasticTextArea",maxLength:this.dic.ml,value:this.value,onvalueChange:function(){this.parent.set("value",this.value);},bindings:{enabled:"this.parent.enabled"}});this.onpopupwidthChange=function(){this.eta.set("width",(this.popupwidth-4)||200);};}},postBuildRendering:function(){this._super();var H=this.dic;if(!mstrmojo.isDescendant(this.owner,this)){if(this.showByDefault&&!H.siwc){this.set("height",this.openerStyle.ih);this.set("popupwidth",this.openerStyle.iw);}else{if(H.wm&&H.w){this.set("popupwidth",H.w);}}}}});}());(function(){mstrmojo.requiresCls("mstrmojo.DocImage","mstrmojo.HBox","mstrmojo.Label","mstrmojo.TextBox","mstrmojo.Button","mstrmojo._HasDocLink","mstrmojo.css","mstrmojo.dom","mstrmojo.DocDataService","mstrmojo.vi.models.EnumFieldTypes");var F=mstrmojo.dom;var P=-1,e=0,b=1,K=2,O=3,E=4,a=mstrmojo.boxmodel.px2Inches,f=mstrmojo.models.FormatModel,N=f.ENUM_PROPERTY_NAMES,G=mstrmojo.vi.models.EnumFieldTypes,R=function R(){var g=this.domNode;if(!g){return ;}mstrmojo.css.toggleClass(g,"hasLink",this.hasActiveLink());},d=function d(){var h=this.imgNode.firstChild;this.originalImgDim={w:h.naturalWidth,h:h.naturalHeight};var g=this.getCalculatedImageDimensions();this.defn.ih=this.imgNode.style.height=g.h+"px";this.defn.iw=this.imgNode.style.width=g.w+"px";if(g.ml){this.imgNode.style.marginLeft=g.ml+"px";}if(g.mt){this.imgNode.style.marginTop=g.mt+"px";}};function I(){if(this._isNewUrl){Y.call(this);delete this._isNewUrl;}else{if(this._isNewEmbeddedImg){V.call(this);delete this._isNewEmbeddedImg;}}d.call(this);this.set("imgReady",true);}function c(g,l){var j=this.parent,p=this.imgNode.firstChild,r=this.model.getZoomProps(),h={},q=f.getFormatUpdate,o=p.naturalHeight,k=p.naturalWidth,n,m;if(o===0||k===0){n="30";m="30";}else{n=o;m=k;}q(N.IMAGE_HEIGHT,a(r,parseFloat(n)),h);q(N.IMAGE_WIDTH,a(r,parseFloat(m)),h);j.model.editField(j,G.IMAGE,{success:function(){j.selectVIUnit(true);}.bind(this)},g,l,{actions:[this.model.getUnitFormatAction(this,1,h,true)],extras:mstrmojo.DocDataService.REQUEST_DEFN_DATA});}function V(){c.call(this,"","");}function Y(){c.call(this,this.v,null);}mstrmojo.vi.ui.rw.DocImage=mstrmojo.declare(mstrmojo.DocImage,[mstrmojo._HasDocLink],{scriptClass:"mstrmojo.vi.ui.rw.DocImage",markupString:'<div id="{@id}" class="mstrmojo-DocImage {@imgStateClass}" style="{@domNodeCssText}" mstrAttach:dblclick><div class="img-cntr"><img src="{@en@v}" mstrAttach:load,error><div mstrAttach:click></div></div>{@buttonNodeMarkup}</div>',markupMethods:{onheightChange:function L(){this.domNode.style.height=this.height;},onwidthChange:function M(){this.domNode.style.width=this.width;},onvisibleChange:mstrmojo.Widget.visibleMarkupMethod},formatHandlers:{domNode:["BG"]},originalImgDim:undefined,model:undefined,onload:function Z(){I.call(this);},onerror:function C(){I.call(this);},ondblclick:function H(g){this.cancelDocLink=true;if(!mstrApp.isAppStatePresentation()){this.parent.switchToEditMode();}if(this._super){this._super(g);}},update:function J(n){var m=this;var h=this._super;var k=function(){h.call(this,n);var p=this.parent;if(p){p.updateOverlay();}R.call(this);}.bind(this);var l=n&&n.defn&&n.defn.oid;if(l){var g=n.defn.fmts,j=g&&g["img-name"];if(this.parent&&j){this.parent.embeddedImageName=decodeURIComponent(j);}this.loadImage(n,function o(){k();m.refresh();});}k();},loadImage:function D(h,k){if(mstrApp.isSingleTier){var g={taskId:"getRWEmbeddedImage",fieldKey:h.k,oid:h.defn.oid};var l={success:function(m){if(m&&m.imageData){h.data.v=m.imageData;}k();}};mstrApp.serverRequest(g,l);}else{var j=this.model.getDataService();h.data.v=mstrConfig.taskURL+"?taskId=getRWEmbeddedImage&msgID="+j.msgId+"&oid="+h.defn.oid;}},postBuildRendering:function X(){this._super();R.call(this);d.call(this);},unrender:function W(g){this.clearCache();this._super(g);},isAspectRatioLocked:function A(){return this.defn.lock;},getSizeMode:function U(){return this.defn.ism;},getImageWidth:function Q(){return this.defn.iw;},getImageHeight:function B(){return this.defn.ih;},updateDimensionsFromFormats:mstrmojo.emptyFn,getCalculatedImageDimensions:function S(k){k=k||{mode:this.getSizeMode(),iw:parseFloat(this.getImageWidth()),ih:parseFloat(this.getImageHeight()),lock:this.isAspectRatioLocked()};var v={},p=this.parent,u=this.originalImgDim,m=k.mode;if(!u||!p.width){return v;}var j={w:parseFloat(p.width),h:parseFloat(p.height)};var o=(u.h!==0)?u.w/u.h:1,t=j.w/j.h;switch(m){case P:case b:var h=k.iw,n=k.ih;if(k.lock&&(h!==undefined||n!==undefined)&&(u.h!==0&&u.w!==0)){var r=n===undefined;if(r){v.w=h;v.h=(h/o).toFixed(0);}else{v.h=n;v.w=(n*o).toFixed(0);}}else{v.w=h;v.h=n;}break;case K:case O:var l=((m===O&&(o>t))||(m===K&&(o<t))),g=F.isFF;if(l){v.h=j.h;v.w=parseInt(j.h*o);if(g){v.ml=parseFloat((j.w-v.w)/2);}}else{v.w=j.w;v.h=parseInt(j.w/o);if(g){v.mt=parseFloat((j.h-v.h)/2);}}break;case E:case e:var q=m===E?j:u;v.w=q.w;v.h=q.h;break;default:break;}return v;}});mstrmojo.vi.ui.rw.DocImage.EnumSizeModes={ORIGINAL:e,FIT_TO_CONTAINER:K,FILL_CONTAINER:O,STRETCH:E,FIXED:b};mstrmojo.vi.ui.rw.DocImage.ImgDimConfigType=null;}());(function(){mstrmojo.requiresCls("mstrmojo.vi.ui.ScrollableDocTextfield","mstrmojo._HasEditableText","mstrmojo.vi._MonitorsAppState","mstrmojo._HasDocLink","mstrmojo.string","mstrmojo.css","mstrmojo.dom");var A=mstrmojo.dom,S=mstrmojo.css;function C(V){return V.data.dl||V.defn.dl;}function O(V){this.getAnchor()[A.isFF?"textContent":"innerText"]=V;}function N(){S.toggleClass(this.domNode,"hasLink",this.hasActiveLink());}function P(){var X=this.defn.fmts,W,V,Z=0,Y=this.valueNode.className.indexOf(" hasVertical ")>-1;if(X&&(X.font||"").split(" ").indexOf("italic")>=0&&(X["text-align"]||"").toLocaleLowerCase()==="right"){W=(X.font||"").match(/([0-9]+)[,\.]?[0-9]*pt/);W=(W&&W[1])||8;V=this.valueNode&&this.valueNode.style;Z=Math.round(W/3)+(Y?30:0);V.paddingRight=Z+"px";}return Z;}mstrmojo.vi.ui.rw.DocTextfield=mstrmojo.declare(mstrmojo.vi.ui.ScrollableDocTextfield,[mstrmojo._HasEditableText,mstrmojo.vi._MonitorsAppState,mstrmojo._HasDocLink],{scriptClass:"mstrmojo.vi.ui.rw.DocTextfield",markupString:'<div id="{@id}" class="mstrmojo-DocTextfield {@cssClass}" style="{@domNodeCssText}"><div class="mstrmojo-DocTextfield-valueNode" style="{@valueNodeCssText}" mstrAttach:click ><div class="vi-doc-tf-value-text">{@en@v}</div></div>{@buttonNodeMarkup}</div>',editableSlot:"valueTextNode",editOnClick:false,editOnDoubleClick:true,allowEmptyText:true,allowNewLine:true,formatHandlers:{domNode:["background-color"],valueNode:["F","fx","text-align","white-space"]},markupSlots:{valueNode:function F(){return this.domNode.firstChild;},valueTextNode:function F(){return this.domNode.firstChild.firstChild;}},update:function H(X){delete this.fmts;this._super(X);this.text=this.v;var V=C(X);if(V){this.tooltip=V.items[0].n;}var W=this.parent;if(W){W.updateOverlay();}N.call(this);},postBuildRendering:function R(){if(mstrApp.isAppStatePresentation()&&this.node&&this.node.data&&this.node.data.v){this.text=this.node.data.v;}this._super();this.attachEventListener("renderComplete",this.id,function(){P.call(this);}.bind(this));N.call(this);if(this.getFormats().overflow==="auto"&&!this.hasCustomScrollbar){this.valueTextNode.style.overflow="auto";}},getAnchor:function B(){return this.valueTextNode;},getRawText:function I(){return this.node.data.rv||this.v;},ondblclick:function G(V){this.cancelDocLink=true;if(!this.isEditing&&mstrApp.isAppStatePresentation&&!mstrApp.isAppStatePresentation()){O.call(this,this.getRawText());this._super(V);}},onTextEditComplete:function L(W,V){if(W){this.parent.textEdited(this.text,W,V);this.updateScrollbars();}else{O.call(this,this.v);}if(!this.text){this.parent.updateOverlay();}},unrender:function Q(V){this.clearCache();this.isEditing=false;this._super(V);},setupScrollNodes:function J(){var V=this.getFormats();if(!V.overflow||V.overflow==="auto"){this.scrollNode=this.valueTextNode;}},updateScrollbars:function U(){this._super();if(this.scrollNode&&parseInt(this.height,10)<=24){var V=this.getDefaultScrollBarProps("v");S.toggleClass(this.scrollNode.parentNode,V.hostCls,false);S.toggleClass(this.scrollNode,V.scrollNodeCls,false);}},handleRotatedText:function E(){if(this.isTextFieldRotated()){this.valueNode.style.cssText="";window.setTimeout(function(){if(this.hasRendered){this.valueNode.style.cssText=this.valueNodeCssText;var a="px",W=this.getFormats(),V=this.valueNode,c=V.style,Y=W.fx&&W.fx.rt,b=V.offsetWidth,X=V.offsetHeight,Z=P.call(this);switch(Y){case 1:c.left=b+a;break;case 3:c.top=X-1+a;break;}c.height=b+a;c.width=X-Z+a;}}.bind(this),0);}},onAppStateChange:function M(V){var X=mstrApp.isAppStatePresentation(),W=mstrApp.isAppStatePause();this.editOnClick=this.editOnDoubleClick=!X;this.isEditing=!X&&!W;},onisEditingChange:function D(V){this._super(V);this.parent.set("useRichTooltip",!V.value);if(this.isEditing){this.parent.hideLinkButton();}else{this.parent.unhideLinkButton();}},canShowContentTooltip:function K(X,W){var V=A.eventTarget(W,X);return V===this.valueNode||V===this.valueTextNode;}});}());(function(){mstrmojo.requiresCls("mstrmojo.TableLayoutList","mstrmojo._IsTableLayoutListDIC","mstrmojo._IsInputControl","mstrmojo.css");function A(H){var G=[];E.forEach(H,function(I){G.push(I.n);});return G;}var D=mstrmojo.css,E=mstrmojo.array;mstrmojo.LikertScaleDIC=mstrmojo.declare(mstrmojo.TableLayoutList,[mstrmojo._IsTableLayoutListDIC,mstrmojo._IsInputControl],{scriptClass:"mstrmojo.LikertScaleDIC",styleCssClass:"scale",init:function(G){this._super(G);this.items=this.getItems();this.titleItems=A(this.items);},getDisplayValue:function C(){return(this.selectedIndex>=0)?this.items[this.selectedIndex].n:this.dv;},getLeftEndTitle:function F(G){return G>=0?(this.dic.mint||""):"";},getRightEndTitle:function(G){return G>=0?(this.dic.maxt||""):"";},postvalueChange:function(){this._super&&this._super();if(this.owner&&this.owner.model){var G=this.owner.model,J=G.getZoomFactor&&G.getZoomFactor()||1;if(J!==1){var I=this.domNode.getElementsByClassName("item_wrapper"),H=[];E.forEach(I,function(K){H.push(K.firstChild);});this.zoomBackground(J,H);}}},postBuildRendering:function(){this._super();if(this.owner&&this.owner.model){var G=this.owner.model;zf=G.getZoomFactor&&G.getZoomFactor()||1;var K=this.domNode.getElementsByClassName("item_title"),H=window.getComputedStyle(K[0],null).getPropertyValue("width");if(H){E.forEach(K,function(L){L.style.width=parseFloat(H)*zf+"px";});}var J=this.domNode.getElementsByClassName("item_wrapper"),I=[];E.forEach(J,function(M,L){M.style.textAlign="center";I.push(M.firstChild);if(K[L]){K[L].controlTo=M;}});this.zoomStyle(zf,I,100,500);}if(!mstrmojo.isDescendant(this.owner,this)&&this.showByDefault){this.set("height",(this.openerStyle.ih||0)+"px");this.set("width",(this.openerStyle.iw||0)+"px");}D.toggleClass(this.domNode,"disabled",!this.enabled);},getItemNodeFromTarget:function B(G){if(G.className==="item_title"){G=G.controlTo;}return this._super(G);}});}());(function(){mstrmojo.requiresCls("mstrmojo._IsInputControl","mstrmojo.TableLayoutList","mstrmojo._IsTableLayoutListDIC","mstrmojo.dom","mstrmojo.hash","mstrmojo.css");var A=mstrmojo.dom,C=mstrmojo.css,E=mstrmojo.hash,D={0:"default",1:"stars_dots"};function B(G){if(G.owner&&G.owner.model){var F=G.owner.model,J=F.getZoomFactor&&F.getZoomFactor()||1;if(J!==1){var I=G.domNode.getElementsByClassName("item_wrapper"),H=[];$A.forEach(I,function(K){H.push(K.firstChild);});G.zoomBackground(J,H);}}}mstrmojo.RatingDIC=mstrmojo.declare(mstrmojo.TableLayoutList,[mstrmojo._IsTableLayoutListDIC,mstrmojo._IsInputControl],{scriptClass:"mstrmojo.RatingDIC",styleCssClass:"rate",markupString:'<div id="{@id}" class="mstrmojo-ListBase {@cssClass}" style="{@cssText}" mstrAttach:click,mouseover,mouseout><div class="{@icnCss}" style="{@icnCssText}">{@itemsHtml}</div></div>',lastIdx:null,init:function(F){this._super(F);this.items=this.getItems();this.starCount=this.items&&this.items.length;C.addWidgetCssClass(this,D[this.dic.stl||0]);},setRating:function(F){var H=0,I=this.starCount,G="less_equal";if(this.lastIdx==undefined||this.lastIdx!=F){for(H;H<I;H++){if(H<=F){C.addClass(this._getItemNode(H),G);}else{C.removeClass(this._getItemNode(H),G);}}this.lastIdx=F;B(this);}},onvalueChange:function(){this._super&&this._super();var F=mstrmojo.array.find(this.items,"v",this.value);this.setRating(F);},onmouseover:function(G){this._super&&this._super(G);var H=G.target||A.eventTarget(G.hWin,G.e),F=H&&H.getAttribute("idx");if(F!=undefined){this.setRating(F);}},onmouseout:function(G){this._super&&this._super(G);var F=mstrmojo.array.find(this.items,"v",this.value);this.setRating(F);},postBuildRendering:function(){this._super();if(!mstrmojo.isDescendant(this.owner,this)&&this.showByDefault){this.set("height",(this.openerStyle.ih||0)+"px");this.set("width",(this.openerStyle.iw||0)+"px");}var F=mstrmojo.array.find(this.items,"v",this.value);if(F>-1){this.setRating(F);}if(this.owner&&this.owner.model){var G=this.owner.model;zf=G.getZoomFactor&&G.getZoomFactor()||1;if(zf!==1){var I=this.domNode.getElementsByClassName("item_wrapper"),H=[];$A.forEach(I,function(J){H.push(J.firstChild);});this.zoomStyle(zf,H,42,41);}}C.toggleClass(this.domNode,"disabled",!this.enabled);}});}());(function(){mstrmojo.requiresCls("mstrmojo.Container","mstrmojo._HasLayout","mstrmojo._HasOwnAvatar","mstrmojo.vi.ui._IsBoxLayoutChild","mstrmojo.vi.ui.BoxPanel","mstrmojo.vi.ui.IconTabList","mstrmojo.vi.ui._HasMask","mstrmojo.vi._MonitorsAppState","mstrmojo.vi._MonitorsLayoutMode","mstrmojo.dom","mstrmojo.hash","mstrmojo.array","mstrmojo.css");var K=mstrmojo.dom,N=mstrmojo.hash,c=mstrmojo.array,D=mstrmojo.css,q="hidden",A="drop-shadow",v="highlightSelected",w="fadeout";function p(){return(this.children||[]).filter(function(x){return x.slot==="containerNode";});}function h(x){return x.src.data.tabInfo;}function l(x){return(this.children||[]).filter(function(z){return z.alias===x.item.id;})[0];}function m(z,x){D.toggleClass(z.src.data.avatar,q,!x);}function J(x){this.tabList.removeTab(x.alias);this.removeChildren(x);}function o(){K.detachEvent(document,"mousemove",this._checkAndExtractTab);delete this._checkAndExtractTab;}function V(z,AA){var x=this.tabList;x.exitDragMode(z);J.call(this,z.panel);m(AA,true);if(!z.extractedFromSrcBPC){z.extractedFromSrcBPC=true;o.call(this);}}function I(z,AA){this.resetMask();m(AA,false);this.addChildren([z.panel]);var x=this.tabList;N.copy(x.addTab(z.item,NaN,true),z);x.enterDragMode(z,AA);}function S(x){return x.some(function(z){return z instanceof mstrmojo.vi.ui.VIBoxPropertyEditor;});}mstrmojo.vi.ui.BoxPanelContainer=mstrmojo.declare(mstrmojo.Container,[mstrmojo._HasLayout,mstrmojo._HasOwnAvatar,mstrmojo.vi.ui._IsBoxLayoutChild,mstrmojo.vi.ui._HasMask,mstrmojo.vi._MonitorsAppState,mstrmojo.vi._MonitorsLayoutMode],{scriptClass:"mstrmojo.vi.ui.BoxPanelContainer",markupString:'<div id="{@id}" class="mstrmojo-VIBoxPanelContainer {@cssClass}" style="{@cssText}" mstrAttach:click><div class="mstrmojo-VIBoxPanelContainer-header"><div class="mstrmojo-VIBoxPanelContainer-handle"><div mstrAttach:click></div></div><div class="mstrmojo-VIBoxPanelContainer-tabs"></div><div class="mstrmojo-VIBoxPanelContainer-closeBtn enable" tooltip="'+mstrmojo.desc(1995,"Hide")+'"></div></div><div class="mstrmojo-VIBoxPanelContainer-content"></div><div class="mstrmojo-VIDND-mask"></div></div>',markupSlots:{headerNode:function(){return this.domNode.firstChild;},handleNode:function(){return this.domNode.firstChild.firstChild;},tabsNode:function(){return this.domNode.firstChild.childNodes[1];},closeNode:function(){return this.domNode.firstChild.lastChild;},containerNode:function(){return this.domNode.childNodes[1];},maskNode:function(){return this.domNode.lastChild;}},layoutConfig:{h:{handleNode:"11px",tabsNode:"18px",containerNode:"100%"},w:{handleNode:"100%",tabsNode:"100%",containerNode:"100%"},xt:true},markupMethods:{onvisibleChange:mstrmojo.Widget.visibleMarkupMethod},draggable:true,dropZone:true,headerNode:null,tabsNode:null,tabList:null,model:null,parent:null,slot:"containerNode",children:[{scriptClass:"mstrmojo.vi.ui.IconTabList",slot:"tabsNode",alias:"tabList",selectedIndex:0,tabSelected:function(AA){var z=this.parent,x=z.parent;p.call(z).forEach(function(AC){var AB=AC.alias===AA.id;AC.set("visible",AB);if(AB){AC.doLayout();}});this.parent.ontabSelected();if(x){x.model.updateRootDefn({root:{layoutXML:x.getBoxLayoutConfig().box}});}}}],init:function r(x){this._super(x);if(!!mstrApp.isWSStyling){this.layoutConfig={h:{handleNode:"11px",tabsNode:"23px",containerNode:"100%"},w:{handleNode:"100%",tabsNode:"100%",containerNode:"100%"},xt:true};}this.tabList.attachEventListener("click",this.id,function(z){var AB=z.src.getItemFromTarget(z.getTarget());var AA;if(AB!=null){this.parent.model.raiseEvent(N.copy({name:"viIconTabClicked",id:AB.id},AA));}});this.model.attachEventListener("viUnitSelected",this.id,function(z){var AC=mstrmojo.all[z.id],AD=mstrmojo.vi.ui.rw.DocLayoutViewer.getViPanelType,AA=null;if(z.isAddAction){AA=this[AD(AC.getPanelForAddAction())];}else{var AB=AC?AC.getExcludedPanels().map(function(AF){return AD(AF);}):[];if(AB.indexOf(this.tabList.getSelectedItems()[0].id)>-1){var AE=mstrmojo.vi.ui.BoxPanel.PANEL_TYPES;Object.keys(AE).some(function(AG){var AH=AE[AG],AF=this[AH];if(AF&&AB.indexOf(AH)<0){AA=AF;return true;}return false;},this);}}if(AA){this.selectPanel(AA);}});},postBuildRendering:function R(){if((mstrApp.isAppStatePresentation&&mstrApp.isAppStatePresentation())||(mstrApp.isLayoutModePreview&&mstrApp.isLayoutModePreview())||(mstrApp.isAppStateSelection&&mstrApp.isAppStateSelection())){this.draggable=false;}this.toggleCloseButton(!mstrApp.isInVFConfigMode);this._super();},onRender:function(){if(this._super){this._super();}this.set("isMasked",mstrApp.isAppStateSelection());},toggleCloseButton:function(x){D.toggleClass(this.closeNode,"enable",x);},onAppStateChange:function k(x){this._super(x);var z=mstrApp.isAppStateSelection();this.set("isMasked",z);this.draggable=!(mstrApp.isAppStatePresentation()||mstrApp.isLayoutModePreview()||z);},onLayoutModeChange:function L(x){this.draggable=!(mstrApp.isAppStatePresentation()||mstrApp.isLayoutPreview(x.value)||mstrApp.isAppStateSelection());},getIdentifier:function u(){return this.tabList.getTabIds();},getDragData:function f(z){var AB={},AA=z.src.node;if(K.contains(this.tabsNode,AA,true,this.domNode)){var x=this.tabList.getDragTabInfo(AA);if(x){x.panel=l.call(this,x);AB.tabInfo=x;x.extractedFromSrcBPC=false;}}return AB;},isDragValid:function U(x){return K.contains(this.headerNode,x.src.node,true,this.domNode);},ondragstart:function j(x){if(!h(x)){this.domNode.style.display="none";}this._super(x);},initializeDrag:function B(z){this._super(z);var x=h(z);if(x){if(x.isSingleTab){this.set("visible",false);V.call(this,x,z);}else{this.tabList.enterDragMode(x,z);}}var AA=this;this._checkAndExtractTab=function AB(){var AC=h(z);if(AC&&!AC.extractedFromSrcBPC&&z.tgt&&AA!==z.tgt.widget){V.call(AA,AC,z);}};K.attachEvent(document,"mousemove",this._checkAndExtractTab);},createAvatar:function X(AD,AB){var AE=AB.src.data,x=AE.tabInfo,AC=mstrApp.rootCtrl.view.themeClassName;var AA=document.createElement("div");AA.className=this.domNode.className+" panelAvatar";AA.style.width=this.width;var z=this.headerNode.cloneNode(true);if(x){var AF=Array.prototype.slice.call(z.getElementsByClassName("item"),0);if(x.isSingleTab){D.addClass(AF[0],"selected");}else{AF.forEach(function(AG){if(AG.className.indexOf("selected")===-1){AG.parentNode.removeChild(AG);}else{AG.style.left=0;}});}}AA.appendChild(z);D.addClass(AA,AC);AE.avatar=AA;m(AB,!x||x.isSingleTab);return this.offsetAvatar(AA);},cacheCtxtBoxPosition:function n(AA){this._super(AA);if(h(AA)){var AB=AA.boxCache[this.id],z=K.position(this.tabsNode),x=z.y;AB.tabTop=x;AB.tabBottom=x+z.h;}},getTargetDropZone:function a(AB){var AD=this._super(AB),AC=AB.boxCache[this.id],AA=AB.tgt.pos.y,z=this.parent.boxLayoutConfig.getBoxPath(this).indexOf("|")>-1,x=AA-AC.y<AC.h/2;if(h(AB)){if(AA<AC.tabTop){return"Top";}else{if(AA<AC.tabBottom){return"Tab";}else{if(z){return x?"Tab":"Bottom";}else{if(AD==="Top"){return"Tab";}return AD;}}}}if(z){return x?"Top":"Bottom";}return AD;},highlightMask:function F(AB,z){var x=h(z);if(x){var AA=x.active;if(AB==="Tab"){if(!AA){I.call(this,x,z);}this.tabList.dragTab(x,z);return true;}if(AA){V.call(this,x,z);}}return this._super(AB,z);},ondragleave:function O(z){this._super(z);var x=h(z);if(x&&x.active){V.call(this,x,z);}},wasDropped:function e(AA){var z=h(AA);if(z){if(!z.active){var x=new mstrmojo.vi.ui.BoxPanelContainer({model:this.model}),AB=AA.box;delete AB.initState;AB.boxId=x.id;this.parent.addChildren([x]);x.addPanel(z.item,z.panel,z.idx,true);}}this._super(AA);},ondrop:function b(AA){var z=h(AA);if(z){if(z.active){var x=this.tabList;x.pivotTab(z);x.exitDragMode(z);this.doLayout();AA.dropSuccessful=true;this.parent.saveBoxLayout();this.setMaskVisibility(false);return ;}AA.box.parentPath+="x";}this._super(AA);},ondragend:function E(z){if(!h(z)){this.domNode.style.display="block";}this._super(z);if(z.dropSuccessful){var x=p.call(this);if(!x.length){this.parent.removeChildren(this);this.destroy();}}o.call(this);},cancelBoxMove:function W(AA){var z=h(AA),x=this.tabList;if(!z){return false;}if(z.active){x.exitDragMode(z);return true;}this.addChildren([z.panel]);if(z.isSingleTab){this.set("visible",true);z.panel.domNode.style.display="block";}x.addTab(z.item,z.homeIdx,true);return false;},addPanel:function Y(AH,x,AG,z){var AC=AH.id,AB=this[AC];if(AB){this.removeChildren(AB);}if(x){x.alias=AC;x.width=this.width;x.visible=!!z;this.addChildren([x]);var AA=this.tabList.addTab(AH,AG,z);var AE=this.vi_drz&&this.vi_drz.editorNode,AD=AE&&AE.style,AF=AH.disabled;if(AE&&AH.id==="vi_drz"){if(AD.visibility==="hidden"&&AF){this.tabList.enableItem(AA.idx);}else{if(AD.visibility==="visible"&&!AF){this.tabList.disableItem(AA.idx);}}}}},removeAllPanels:function H(){var x=p.call(this),AA=this.model.getDataService().newUpdateWithoutCmd();AA.addExtras(mstrmojo.DocDataService.SUPPRESS_DATA);c.forEach(x,function(AB){AB.setOpenStatus(false,false,AA);});var z=AA.actions;if(z&&z.length){AA.submit();}},removePanel:function Q(x,AC,AA,AB){J.call(this,x);if(x.alias===mstrmojo.vi.ui.BoxPanel.PANEL_TYPES.FILTERS){x.unrender();}else{x.destroy();}var z=this.parent;if(!AA){z.saveBoxLayout(undefined,undefined,undefined,AC);}if(!p.call(this).length){if(AA){z.deleteBox(this,AB);}else{z.deleteBoxAndSubmitDeferred(AC,this,undefined,true);}this.destroy();}},highlightSelected:function C(){var x=this;D.addClass(x.domNode,v);x._highlightTimeout=window.setTimeout(function(){D.addClass(x.domNode,w);D.removeClass(x.domNode,v);window.setTimeout(function(){D.removeClass(x.domNode,w);},500);},1000);},removeHighlightSelected:function G(){if(this._highlightTimeout){window.clearTimeout(this._highlightTimeout);}D.removeClass(this.domNode,w);D.removeClass(this.domNode,v);},ontabSelected:function d(){this.removeHighlightSelected();var x=this.parent&&this.parent.children;c.forEach(x,function(AA){var z=AA.vi_flt;if(AA instanceof mstrmojo.vi.ui.BoxPanelContainer&&z&&z.onStatusChange){z.onStatusChange();}});},selectPanel:function M(z){var x=this.tabList;x.doItemSelect(x.items.filter(function(AA){return AA.id===z.alias;})[0],{});},onclick:function g(x){if(x.getTarget()===this.closeNode){this.removeAllPanels();}var AA=this.tabList.selectedItem;var z;this.parent.model.raiseEvent(N.copy({name:"viIconTabClicked",id:AA.id},z));},getPanelByType:function P(x){return(this.children||[]).filter(function(z){return z.viPanelType===x;})[0];},addChildren:function Z(AB,x,z){var AA=this._super(AB,x,z);this.doLayout();return AA;},onremoveChild:function(x){if(S((x&&x.value)||[])){D.removeClass(this.domNode,A);}},onaddChild:function(x){if(S((x&&x.value)||[])){var z=this.hasRendered;D[z?"addClass":"addWidgetCssClass"](z?this.domNode:this,A);}},getBoxBorderWidth:function t(){return 2;}});mstrmojo.vi.ui.BoxPanelContainer.boxConfiguration={f:{h:185,v:150},o:"h"};mstrmojo.vi.ui.BoxPanelContainer.boxConfigurationWS={f:{h:172,v:150},o:"h"};}());(function(){mstrmojo.requiresCls("mstrmojo.ui.menus.PopupConfig","mstrmojo.ui.menus.MenuEditor");mstrmojo.ui.menus.EditorConfig=mstrmojo.declare(mstrmojo.ui.menus.PopupConfig,[mstrmojo._HasBindings],{scriptClass:"mstrmojo.ui.menus.EditorConfig",data:null,fnOk:null,fnCancel:null,okEnabled:true,cancelEnabled:true,okVisible:true,cancelVisible:true,init:function D(E){this._super(E);if(this.data&&!mstrmojo.all[this.data.id]){mstrmojo.hash.make(this.data,mstrmojo.Obj);}this.initBindings();},clear:function A(){this._super();this.data=null;this.fnOk=this.fnCancel=mstrmojo.emptyFn;},newInstance:function C(){return new mstrmojo.ui.menus.MenuEditor({popupConfig:this});},destroy:function B(){if(this.data){this.data.destroy();}this.destroyBindings();this._super();}});}());(function(){mstrmojo.requiresCls("mstrmojo.ui.PopupButton","mstrmojo._HasTooltip","mstrmojo.ui._IsPulldown","mstrmojo.ui.PopupList","mstrmojo.hash","mstrmojo.dom","mstrmojo.string","mstrmojo.css","mstrmojo.array","mstrmojo._CanAutoClose");var U=mstrmojo.css,L=mstrmojo.array,F=mstrmojo.dom,B=mstrmojo.string;function H(W){this.set("richTooltip",{cssClass:"vi-regular vi-tooltip-C",content:B.encodeHtmlString(W)});}mstrmojo.ui.Pulldown=mstrmojo.declare(mstrmojo.ui.PopupButton,[mstrmojo.ui._IsPulldown,mstrmojo._HasTooltip],{scriptClass:"mstrmojo.ui.Pulldown",onitemSelected:mstrmojo.emptyFn,onSelectedItemChange:mstrmojo.emptyFn,useRichTooltip:true,allowHTML:false,useDarkTheme:false,init:function P(W){this._super(W);U.addWidgetCssClass(this.getPopupList(),"ctrl-popup-list");},initChildren:function C(){this.children=this.getPopupListConfig();this._super();},postBuildRendering:function Q(){if(this._super){this._super();}var W=this.getSelectedItem();if(W){H.call(this,W.n);}},showTooltip:function D(a,Z){var X=this.selectedNode,Y=this.richTooltip;if(X.offsetWidth>=X.scrollWidth){return ;}if(!Y.top){var W=F.position(this.selectedNode);Y.top=W.y-3;Y.left=W.x+W.w+6;}if(this._super){this._super(a,Z);}},getSelectedItem:function M(){var W=this.items;return W&&W[this.selectedIndex];},selectItemByField:function A(X,W){this.set("selectedIndex",L.find(this.items||[],X,W));},getPopupWidget:function E(){return this.list;},getPopupList:function J(){return this.list;},_set_items:function I(Z,W){var Y=this.items;this.items=W;delete this.selectedIndex;if(Y!==W){var X=this.hasRendered;if(X){this.refresh();}return true;}return false;},onclick:function V(W){this._super(W);var Y=this,X=Y.getPopupWidget();Y.mw=Y.mw||function(Z){if(!F.contains(X.domNode,F.eventTarget(self,Z),true,document.body)){X.close();F.detachEvent(document,F.isFF?"DOMMouseScroll":"mousewheel",Y.mw);}};F.attachEvent(document,F.isFF?"DOMMouseScroll":"mousewheel",Y.mw);if(Y.focusOnPopup){X.domNode.focus();}},_set_selectedIndex:function N(d,a,Y){if((a!==0&&!a)||a<0){return false;}var X=this.selectedIndex=a,W=this.getPopupList(),Z=W&&W.items,c=Z&&Z[X],b=this.selectedNode;if(c&&c.dsbld){return false;}if(W){mstrmojo._ListSelections._set_selectedIndex.call(W,"selectedIndex",X,Y);}if(b&&Z&&Z[X]){b.innerHTML=this.getPulldownTextInnerHTML(Z[X]);b.title=Z[X].title||"";}if(Z&&Z[X]){if(this.focusOnPopup&&W&&!W.closeAfterSelection){W.itemsContainerNode.children[X].style.color="";}else{this.onitemSelected(Z[X],X);}}return true;},getPulldownTextInnerHTML:function G(W){return this.allowHTML?W.n:B.encodeHtmlString(W.n,true);},postselectedIndexChange:function O(W){var a=W.value,Y=W.valueWas;if(a!==Y){var X=this.items,Z=X[a];if(Z){H.call(this,Z.n);}this.onSelectedItemChange(Z,X[Y]);}},getPopupConfig:function K(){var W=this._super();W.useDarkTheme=this.useDarkTheme;return W;},getPopupListConfig:function S(){return{scriptClass:"mstrmojo.ui.PopupList",alias:"list",selectionPolicy:"reselect",locksHover:true,useRichTooltip:true,showTooltipForLargeText:true,scrollNodeMaxHeight:this.scrollNodeMaxHeight,listHooks:{select:function W(a,b,Z){this.parent.set("selectedIndex",Z);if(this.visible&&this.closeAfterSelection&&!this.selectedItem.dsbld){this.close();}}},getItemProps:function X(b,Z){var a=mstrmojo._IsList.getItemProps.call(this,b,Z);a.style=this.parent.itemCssText||"";return a;},suppressClose:function Y(Z){return mstrmojo._CanAutoClose.suppressClose.call(this,Z)||F.contains(this.parent.domNode,Z,true,document.body);}};},children:[]});mstrmojo.ui.Pulldown.newPulldown=function R(X,b,W,a,Z){a=a||{};a.items=X;var Y;if(Z===true){Y=mstrmojo.hash.copy({scriptClass:"mstrmojo.ui.Pulldown",selectedIndex:W||0},a);}else{Y=new mstrmojo.ui.Pulldown(a);if(W!==undefined){Y.set("selectedIndex",W);}}Y.onSelectedItemChange=b||mstrmojo.emptyFn;return Y;};}());(function(){mstrmojo.requiresCls("mstrmojo.ui.editors.controls.PreviewButton","mstrmojo.ui.PopupList","mstrmojo.array","mstrmojo.css");var F=mstrmojo.css,E=mstrmojo.array;mstrmojo.ui.editors.controls.ListPreviewButton=mstrmojo.declare(mstrmojo.ui.editors.controls.PreviewButton,null,{scriptClass:"mstrmojo.ui.editors.controls.ListPreviewButton",init:function G(L){this._super(L);var M=this.getListCfg(),K=this.itemValueField;M.alias="list";M.locksHover=true;M.slot="widgetHostNode";M.listHooks={select:function J(N,O){this.parent.set("selectedValue",O[K]);this.close();}};M.setDimensions=mstrmojo.emptyFn;this.addChildren([M]);F.addWidgetCssClass(this.list,"ctrl-popup-list");},getPopupWidget:function D(){return this.list;},items:null,onitemsChange:function H(){var J=this.items;if(J){this.list.set("items",J);}},selectedValue:"",itemValueField:"n",onselectedValueChange:function C(){var K=this.selectedValue,J=this.itemValueField,L=this.list;L.selectItems(E.filter(L.items||[],function(M){return M[J]===K;}),true);this.updatePreview();},updatePreview:function B(){throw new Error(this.scriptClass+" must implement updatePreview.");},getListCfg:function I(){return{scriptClass:"mstrmojo.ui.PopupList",selectionPolicy:"reselect"};},postBuildRendering:function A(){this.onitemsChange();this.onselectedValueChange();return this._super();}});}());(function(){mstrmojo.requiresClsP("mstrmojo","hash","Button","Box","express.ui.SubtotalsWidget");var B=mstrmojo.hash;mstrmojo.express.ui.SubtotalMenuEditor=mstrmojo.declare(mstrmojo.Box,null,{scriptClass:"mstrmojo.express.ui.SubtotalMenuEditor",checkList:undefined,btnContainer:undefined,onSubmenuOpen:function A(){this.checkList.set("selectedItems",this.cell.ast);},children:[{scriptClass:"mstrmojo.express.ui.SubtotalsWidget",alias:"checkList"},{scriptClass:"mstrmojo.Box",alias:"btnContainer",cssClass:"mstrmojo-subtotals-button cf",cancelBtn:undefined,children:[{scriptClass:"mstrmojo.Button",alias:"cancelBtn",text:mstrmojo.desc(221,"Cancel"),onclick:function(){this.parent.parent.onSubmenuClosed();}},{scriptClass:"mstrmojo.Button",alias:"okBtn",text:mstrmojo.desc(1442,"OK"),onclick:function(){var H=this.parent.parent,K=H.cell,L=H.xtab,C=[],J=[],E=H.checkList.selectedIndices,G=K.ast,I=[],F,D;B.forEach(E,function(P,O){var R=H.checkList.items[O].v,Q=true;C.push(R);if(G){for(F=0;F<G.length;F++){if(R===G[F].t){Q=false;break;}}if(Q){J.push(R);}}});if(G){for(F=0;F<G.length;F++){var M=G[F].t,N=false;for(D=0;D<C.length;D++){if(C[D]===M){N=true;}}if(!N){I.push(M);}}}L.showTotal(K,G?J:C,I);H.onSubmenuClosed();}}]}]});}());(function(){mstrmojo.requiresCls("mstrmojo.express.ui.SubtotalsWidget");mstrmojo.vi.ui.SubtotalsWidget=mstrmojo.declare(mstrmojo.express.ui.SubtotalsWidget,null,{scriptClass:"mstrmojo.vi.ui.SubtotalsWidget"});}());(function(){mstrmojo.requiresCls("mstrmojo.ui.HierarchyCheckList","mstrmojo.ui._HierarchyListSelection","mstrmojo.EnumSelectionType","mstrmojo.hash","mstrmojo.array","mstrmojo.css");var L=mstrmojo.hash,S=mstrmojo.css,H=mstrmojo.array,A=mstrmojo.EnumSelectionType;var R="dynamic",K="hasSelectedDsct";var W=7;function G(a,X,Z){var b=[],Y={};H.forEach(a,function(d){var c=d.v;if(c>=Z){b.push(d);if(X.isLevelSelected(c)){Y[b.length-1]=true;}}});return{items:b,selectedIndices:Y};}mstrmojo.vi.ui.HierarchyCheckList=mstrmojo.declare(mstrmojo.ui.HierarchyCheckList,[mstrmojo.ui._HierarchyListSelection],{scriptClass:"mstrmojo.vi.ui.HierarchyCheckList",getItemMarkup:function D(Y,X){return'<{@tag} class="item {@cls}" idx="{@idx}" style="{@style}" title="{@tt}"><div class="right"><span class="refresh" title="{@refreshTitle}"></span><span class="branch" title="{@branchTitle}"></span><span class="level" title="{@levelTitle}"></span></div><div class="content"><span class="indent" style="padding-left: {@indent}px;"></span><span class="triangle"></span><span class="checkbox"></span><span class="text">{@en@n}</span></div></{@tag}>';},getItemProps:function U(Z,X){var Y=this._super(Z,X);if(Z.isBranchSelected){Y.addCls(R);}if(Z.hasDsctSelected){Y.addCls(K);}L.copy({refreshTitle:mstrmojo.desc(15251,"Dynamic"),branchTitle:Z.isSelected?mstrmojo.desc(15921,"Single Deselect"):mstrmojo.desc(15920,"Single Select"),levelTitle:mstrmojo.desc(15919,"Level Select"),},Y);return Y;},onclick:function V(X){var Z=X.getTarget(),a=this.getItemNodeFromTarget(Z),Y=this.getItemFromTarget(Z);if(Y){if(S.hasClass(Z,"triangle")){if(Y.hcd){this.doExpandCollapse(a,Y);}}else{if(S.hasClass(Z,"branch")){this.doElementSelect(a,Y,!Y.isSelected);}else{if(S.hasClass(Z,"level")){this.openLevelPopup(a,Y,Z);}else{if(!S.hasClass(Z,"indent")&&!S.hasClass(Z,"refresh")){this.doBranchSelect(a,Y,!Y.isSelected);}}}}X.cancel();}},onSelectionChange:function I(Y,X,Z,a){if(Y===A.ALL&&X){this.clearSelections();(this.raad?this.getInitialDisplayRoots():this.getRootItems()).forEach(function(b){if(b.v){this.selectionList.push({func:A.BRANCH,itemValue:b.v,isNot:false});}},this);if(this.postSelectionChange){this.postSelectionChange();}}else{this._super(Y,X,Z,a);}},updateItemNodesStatus:function M(){var X=this.itemsContainerNode&&this.itemsContainerNode.childNodes;this._super();H.forEach(X,function(a){var Z=this.getItemFromTarget(a),Y=a.getElementsByClassName("branch")[0];if(Z){S.toggleClass(a,R,Z.isBranchSelected);S.toggleClass(a,K,Z.hasDsctSelected);if(Y){Y.title=Z.isSelected?mstrmojo.desc(15921,"Single Deselect"):mstrmojo.desc(15920,"Single Select");}}},this);},getSummaryText:function J(){return"";},getLevels:function E(){return[];},getLevelItems:function B(Y){var a=this.getLevels(),b=Y?[{v:-1,n:mstrmojo.desc(15824,"All Levels")}]:[];if(a.length>0){return b.concat(a);}var X=this.getMaxLevel();for(var Z=0;Z<=X;Z++){b.push({v:Z,n:mstrmojo.desc(493,"Level")+" "+(Z+1)});}return b;},postBuildRendering:function Q(){var Z=this.levelPopup,Y=this.domNode;if(!Z){var X=this.getLevelPopupConfig(),a=L.walk(X.scriptClass,window);delete X.scriptClass;Z=this.levelPopup=new a(X);this.addDisposable(Z);}Z.placeholder=Y.insertBefore(document.createElement("div"),Y.firstChild);Z.render();return this._super();},unrender:function P(X){var Y=this.levelPopup;if(Y){Y.unrender(X);}return this._super(X);},onScrollEnd:function C(){var Y=this.levelPopup,X=Y&&Y.getPopupWidget();if(X&&X.visible){Y.closePopup();}this.hideTooltip();},openLevelPopup:function O(b,Z,Y){var a=this.levelPopup,X=a.getPopupWidget();if(a&&Z.hcd&&this.isHiearachyDisplay()){a.openPopup(X,{branch:Z,branchNode:b});if(Y){X.domNode.style.left=Y.offsetLeft+"px";X.domNode.style.top=Y.offsetTop+Y.offsetHeight-this.scrollNode.scrollTop+"px";}}},getLevelPopupConfig:function N(Z){return L.copy(Z,{scriptClass:"mstrmojo.ui.PopupButton",markupString:'<div id="{@id}" class="level-popup-btn" title="{@title}" mstrAttach:click></div>',title:mstrmojo.desc(15919,"Level Select"),isHostedWithin:false,parent:this,widget:this,children:{scriptClass:"mstrmojo.ui.PopupWidget",alias:"levelPopup",visible:false,children:[{scriptClass:"mstrmojo.ui.CheckList",alias:"checklist",doItemSelect:function b(j,g){var f=this.parent,k=f.opener.widget,h=!this.selectedIndices[j._renderIdx];if(f.branch&&f.branchNode){k.doBranchLevelSelect(f.branchNode,f.branch,j.v,h);}else{k.doLevelSelect(j.v,h);}mstrmojo._IsList.doItemSelect.call(this,j,g);},onclick:function Y(f){if(!S.hasClass(f.getTarget(),"refresh")){mstrmojo._IsList.onclick.call(this,f);}},getItemMarkup:function d(f){return mstrmojo.ui.CheckList.prototype.getItemMarkup.call(this,f).replace('<span class="text">{@en@n}</span>','<span class="refresh"></span><span class="text">{@en@n}</span>');}}],onOpen:function X(){var h=this.opener.widget,f=this.branch,g=G(h.getLevelItems(),h.getLevelSelection(f),f&&f.lv+1||0);this.checklist.set("items",g.items);this.checklist.set("selectedIndices",g.selectedIndices);}},getPopupWidget:function c(){return this.levelPopup;},onPopupWidgetOpened:function a(){S.addClass(this.levelPopup.branchNode,"level-popup-open");},onPopupWidgetClosed:function e(){S.removeClass(this.levelPopup.branchNode,"level-popup-open");}});},getAllButtonConfig:function F(Y,X){return L.copy(X,Y?{scriptClass:"mstrmojo.Button",text:mstrmojo.desc(3474,"Select All"),alias:"selectAllBtn",cssClass:"selectAll",widget:this,onclick:function(){this.widget.doAllSelect(true);}}:{scriptClass:"mstrmojo.Button",text:mstrmojo.desc(1763,"Clear All"),alias:"clearAllBtn",cssClass:"clearAll",widget:this,onclick:function(){this.widget.doAllSelect(false);}});}});}());(function(){mstrmojo.requiresCls("mstrmojo._InputList","mstrmojo._InputListHoriz","mstrmojo.hash");mstrmojo.CheckList=mstrmojo.declare(mstrmojo._InputList,null,{scriptClass:"mstrmojo.CheckList",inputType:"checkbox",cssClass:"mstrmojo-CheckList",itemCssClass:"mstrmojo-CheckList-item"});mstrmojo.requiresCls("mstrmojo._InputListHoriz");mstrmojo.CheckListHoriz=mstrmojo.declare(mstrmojo._InputListHoriz,null,{scriptClass:"mstrmojo.CheckListHoriz",inputType:"checkbox",cssClass:"mstrmojo-CheckListHoriz",itemCssClass:"mstrmojo-CheckListHoriz-item"});})();(function(){mstrmojo.requiresCls("mstrmojo._InputList","mstrmojo._InputListHoriz");mstrmojo.RadioList=mstrmojo.declare(mstrmojo._InputList,null,{scriptClass:"mstrmojo.RadioList",inputType:"radio",cssClass:"mstrmojo-RadioList",itemCssClass:"mstrmojo-RadioList-item",onenabledChange:function A(B){for(var C=0;C<this.items.length;C++){this._getItemNode(C).firstChild.disabled=!B.value;}}});mstrmojo.RadioListHoriz=mstrmojo.declare(mstrmojo._InputListHoriz,null,{scriptClass:"mstrmojo.RadioListHoriz",inputType:"radio",cssClass:"mstrmojo-RadioListHoriz",itemCssClass:"mstrmojo-RadioListHoriz-item"});})();(function(){mstrmojo.requiresCls("mstrmojo.Container","mstrmojo._HasScrollbox","mstrmojo.XtabZone","mstrmojo._ShowsStatus","mstrmojo.boxmodel","mstrmojo._IsLockableXtab","mstrmojo._IsDocumentTemplate","mstrmojo.hash","mstrmojo.dom","mstrmojo.chart.model.enums.EnumDSSBaseFormType");var Q=1,Y=2,Z=0,C=1,AA=2,N=3;var M=1;var AC=2;var I=4;var h=8;var e=mstrmojo.dom,q;function AG(AI){var AJ=null;if(AI&&AI.length>1){AJ=new mstrmojo.XtabVACP();AJ.cps=AI;}return AJ;}function J(AK){if(!AK||this._onDemandCP){return null;}var AT=AK.bc,AR=AK.tc,AL=AK.tbc,AU=AK.rm===2,AJ=AU?this.gridData.ghs.rhs.items.length:AT,AM=AR-AJ,AN=AU?AL-AT:AR-AJ,AS=Math.ceil(AN/AT),AP=[],AQ=[],AO;if(AU){AT=Math.floor(AM/AS);}for(AO=0;AO<AS;++AO){if(AU&&AS===(AO+1)&&AM>AT){AT=AM;}var AI=Math.min(AM,AT);AP.push(this.createOnDemandCP(AO+1,AI,I));AQ.push(this.createOnDemandCP(AO+1,AI,h));AM-=AT;}this._onDemandCP={rhs:AP,vls:AQ};return this._onDemandCP;}mstrmojo.XtabTitlesCP.prototype.shouldClonedLastTitleCell=function(){return false;};mstrmojo.XtabBase=mstrmojo.declare(mstrmojo.Container,[mstrmojo._IsLockableXtab,mstrmojo._HasScrollbox,mstrmojo._ShowsStatus,mstrmojo._IsDocumentTemplate],{scriptClass:"mstrmojo.XtabBase",dataRenderMode:"vscroll",shouldClipLockableXtab:true,handleClicks:function H(){return true;},markupString:'<div id="{@id}" k="{@k}" class="mstrmojo-Xtab {@cssClass}" title="{@tooltip}" style="{@domNodeCssText}"><div style="display: none;{@msgNodeCssText}"><div class="text"><div class="warning-icon"></div><div>&nbsp;</div></div></div><div class="mstrmojo-Xtab-overlay"></div><div class="mstrmojo-Xtab-content {@cssDefault}" title="{@tooltip}" style="{@viewportCssText}" mstrAttach:click,selectstart,touchstart><table cellspacing="0" cellpadding="0"><tr><td style="vertical-align:top;padding:0;"><div style="position: relative;"><div class="mstrmojo-progress" style="display:none"><div class="mstrmojo-progress-barbg"><div class="mstrmojo-progress-bar"></div></div><div class="mstrmojo-progress-text"></div></div><div id="{@id}_scrollbox" style="position:relative;{@scrollboxNodeCssText};{@scrollboxNodeOverflow}"></div></div></td></tr></table></div></div>',markupSlots:{overlayNode:function(){return this.domNode;},msgNode:function(){return this.domNode.firstChild;},maskNode:function(){return this.domNode.childNodes[1];},viewport:function(){return this.domNode.lastChild;},contentNode:function(){return this.domNode.lastChild.firstChild;},scrollboxNode:function(){return this.domNode.lastChild.firstChild.rows[0].cells[0].firstChild.lastChild;},tableContainerNode:function(){return this.domNode.lastChild.firstChild.rows[0].cells[0].firstChild;},_STATUS:function(){return this.domNode.lastChild.firstChild.rows[0].cells[0].firstChild.firstChild;},_STATUS_TXT:function(){return this.domNode.lastChild.firstChild.rows[0].cells[0].firstChild.firstChild.lastChild;},_STATUS_BAR:function(){return this.domNode.lastChild.firstChild.rows[0].cells[0].firstChild.firstChild.firstChild;},_TB_CELL:function(){return this.domNode.lastChild.firstChild.rows[0].cells[0];}},markupMethods:{onvisibleChange:function(){this.domNode.style.display=(this.visible)?"block":"none";}},zone:null,lockHeadersCase:N,interactiveCellsArray:null,titlesCP:null,chsCP:null,rhsCP:null,valuesCP:null,onDemandIF:true,numRowFixed:false,heightLimit:0,height:0,widthLimit:0,width:0,useTouchScrolling:false,scrollInterval:0,selections:null,dataBlocks:null,getCellUnitIndex:function n(AI){return(AI.o!==undefined)?AI.o:AI._ei;},getCellTitleId:function f(AI){var AJ="";if(AI.axis&&AI.ui!==undefined){AJ=AI.axis+"A"+(AI.ui+1);}else{if(AI.mix!==undefined){AJ="0A"+AI.mix;}}return AJ;},update:function l(AJ){this.set("gridData",AJ.data[0]||AJ.data);var AI=this.defn||AJ.defn;this.sid=this.gridData.sid;this.treeType=(AI&&AI.tt)||1;this.interactiveCellsArray=[];if(this._super){return this._super(AJ);}return true;},initCP:function F(AK,AJ,AP,AM,AO,AL,AN){var AI={gridData:AK,type:AP,interactiveCellsArray:AJ,defn:this.defn};AI.base=AM||AI.base;AI.lookupBase=AO||AI.lookupBase;AI.axis=AL||AI.axis;if(!AN){if(AP===M){AN=new mstrmojo.XtabTitlesCP(AI);}else{AN=new mstrmojo.XtabCP(AI);}}else{mstrmojo.hash.copy(AI,AN);}return AN;},preBuildRendering:function D(){var AK=this.gridData,AI=this.height,AJ=this.width;this.lockHeadersCase=AK.lhv||Z;this.selections={};this.numRowFixed=!!(!AI&&AK.rw&&AK.rw.row&&(AK.rw.row.bc<AK.rw.row.tc));this.rw=AK.rw;this._onDemandCP=null;if(AJ){this.widthLimit=parseInt(AJ,10);}if(AI){this.heightLimit=parseInt(AI,10);}return this._super();},renderEmptyGrid:function r(){var AL=this.gridData,AJ=this.msgNode,AK=AJ.style,AI=this.viewport;AJ.firstChild.childNodes[1].innerHTML=AL.eg;if(AL.eg!==""&&!this.excludeData){AK.display="block";AK.overflow="hidden";AJ.className="mstrmojo-message";AI.style.display="none";}return true;},postBuildRendering:function V(){var AN=this.gridData,AK=!!this.viewport&&AN,AJ=this.msgNode,AI=this.viewport,AM;if(AN.eg===undefined){if(AJ.style.display==="block"){AJ.style.display="none";AI.style.display="block";}}else{return this.renderEmptyGrid();}if(!this.interactiveCellsArray){this.interactiveCellsArray=[];}if(AK){AN.ghs=AN.ghs||[];AN.gts=AN.gts||[];this._setupZone(AN);this._setupCP(AN);var AP=this.zone;if(AP.parent!==this){this.addChildren(AP);}if(this.scrollboxNode){var AL=this.heightLimit;this.scrollboxHeightFixed=!isNaN(AL)&&(AL>0);if(this.scrollboxHeightFixed){this.scrollboxHeight=AL;}this.scrollboxLeft=this.scrollboxTop=0;this.connectScrollbox(this);}}this.renderChildren();if(this.controller&&this.controller.getScrollPosition){var AO=this.controller.getScrollPosition(this.controller.model.oid+"."+this.gridData.k);if(AO){this.scrollTo(AO);}}AM=this._super();if(this.numRowFixed){if(!this.height){this.heightLimit=this.zone.getPageHeight(0);this.height=this.heightLimit+"px";}else{this.heightLimit=parseInt(this.height,10);}}if((AK&&this.scrollboxNode&&AN.afc)||this.numRowFixed){this.resizeScrollBox();}this.onGridWidthChanged(AN.afc||AN.afw);this._onContainerGrowShrink(this.widthLimit,this.heightLimit);if(this.scrollboxNode&&this.scrollboxNode.childNodes&&this.scrollboxNode.childNodes[0]){this.scrollboxNode.style.zIndex=this.scrollboxNode.childNodes[0].style.zIndex;}if(this.lockHeadersCase&&this.initLock){this.initLock({top:this.scrollboxTop,left:this.scrollboxLeft});}if(this.configureActions){this.configureActions();}return AM;},onclick:function o(AJ){var AL=mstrmojo.dom,AN=AJ.getTarget(),AM=AN&&AL.findAncestorByName(AN,"td",true,this.viewport);if(AN.nodeName.toLowerCase()==="a"&&AM.getAttribute("ei")){try{var AK=this.interactiveCellsArray[parseInt(AM.getAttribute("ei"),10)];if(AK&&AK.ts===mstrmojo.chart.model.enums.EnumDSSBaseFormType.DssBaseFormHTMLTag){AN.href=mstrmojo.addCSRFTokenToURL(AN.href);}}catch(AO){}}if(AM){var AI=AL.findAncestorByName(AN,"span",true,AM);if(AI&&!AJ.shiftKey&&!AJ.ctrlKey){this.defaultAction(AM);}else{this.doSelection(AJ.e,AJ.hWin,AM);}}if(this.isSelectingText){this.isSelectingText=false;}},ontouchend:function j(AJ,AI){this.onclick(mstrmojo._HasMarkup.newDomEvent("click",AI,AJ));},onselectstart:function t(AJ,AI){if(this.isHandleNode&&this.isHandleNode(AJ.getTarget())){e.preventDefault(AI,AJ);}return false;},onscroll:function u(){this._alignHeaders();if(this.controller&&this.controller.addScrollPosition){this.controller.addScrollPosition(this.controller.model.oid+"."+this.gridData.k,this.scrollboxLeft,this.scrollboxTop);}},resizeScrollBox:function K(){var AL=this.scrollboxNode,AK=AL&&AL.style,AJ=this._TB_CELL;if(!AK||!AJ){return ;}var AI=this.heightLimit;if(!AI){AK.height="auto";this.scrollboxHeightFixed=false;}else{if(AI>0){AK.height=AI+"px";this.scrollboxHeight=AI;this.scrollboxHeightFixed=true;}}this._resizeScrollBoxWidth();},_onContainerGrowShrink:function AH(AJ,AM){var AI=mstrmojo.findAncestor(this,"fixedSizeCanGrowShrink",null,mstrmojo.DocSection),AL=AJ||null,AK=AM||null;if(AL||AK){if(AI){AI.fixedSizeCanGrowShrink(this,AK,AL);}}else{if(AI){AI.performCanGrowCanShrink([this],true);}}},_resizeScrollBoxWidth:function W(){var AO=this.scrollboxNode,AM=AO.scrollWidth+(AO.offsetWidth-AO.clientWidth),AK=AO&&AO.style,AJ=this._TB_CELL;if(this.useTouchScrolling||!AK||!AJ){return ;}var AL=this.widthLimit;if(!AL){var AN=AO.firstChild.style,AI=AN.position;AN.position="relative";AK.width="auto";AM=AO.firstChild.firstChild.offsetWidth+(AO.offsetWidth-AO.clientWidth);AO.firstChild.style.position=AI;}if((AM&&(AM>0))&&(!AL||(AL&&(AM<AL)))&&(AO.firstChild.firstChild.offsetWidth>=AO.clientWidth)){AK.width=AM+"px";}},onGridWidthChanged:function d(AJ){if(!AJ){this._resizeScrollBoxWidth();}var AI=this.widthLimit;if(!AI){this.width=q;}this._onContainerGrowShrink(AI,null);},getGridDimension:function R(AL){var AJ=1,AK=AL===AJ?"Height":"Width",AM=AK.toLowerCase(),AI=this[AM+"Limit"];if(!AI&&(this[AM]===q||this[AM]===0)){AI=this.viewport["offset"+AK];this[AM]=AI+"px";return AI;}return AI||parseInt(this[AM],10);},_alignHeaders:function B(AI){var AK=this.scrollboxLeft,AJ=this.scrollboxTop;if(this.lockHeadersCase&&this.alignLockNodes){this.alignLockNodes(AK,AJ);}},defaultAction:function S(AN,AJ){var AI=AJ||this.getCellForNode(AN),AM=AN&&AN.className.indexOf("sc_")>0;if(this.model&&this.model.data&&this.model.data.visName&&this.model.data.visName==="InteractiveGridAjaxVisualizationStyle"){AM=this.isReselectedTD(AI);if(AM&&this.hasSelectAll&&this.hasSelectAll(AI)){this.IGCurrentSelectedCell=null;}else{this.IGCurrentSelectedCell=AI;}}var AL=this.model.getAction(this.getActionCells(AI),AN,AM),AK=AL&&AL.h;this._currentSelectedTD=AN;if(AK&&this.controller[AK]){this.controller[AK](this,AL.a);return true;}return false;},createZone:function m(AJ){var AK=AJ||{},AI=this._super&&this._super(AK);if(!AI){AI=new mstrmojo.XtabZone(AK);}return AI;},_setupZone:function v(AM){this.zones={};if(!this.zone){this.zone=this.createZone({renderMode:this.dataRenderMode,cssText:"z-index: 1",slot:"scrollboxNode"});}var AI=this.zone;this.zones.origin=AI;AI.rh=AM.rh;AI.autoFitWindow=!!AM.afw;AI.autoFitContent=!!AM.afc;if(!this.isVIXtab){AI.tableCssClass="r-cssDefault"+(this.k?"_"+this.k:"");}AI.numColumnCanMerge=AM.gts&&AM.gts.cws?(AM.gts.cws.length-1):0;var AN=[],AK=undefined,AO=null,AL,AJ;mstrmojo.array.forEach(AM.gts&&AM.gts.row,function(AP){AL=AO&&AO.id===AP.id;if(AL){AN[AN.length-1]+=AP.fs&&AP.fs.length||1;}else{if(AP.otp===-1){AK=0;mstrmojo.array.forEach(AN,function(AQ){AK+=AQ;});}AN.push(AP.fs&&AP.fs.length||1);}AO=AP;});AI.acws=AN;AI.rowMerge=AM.gsi&&AM.gsi.prop&&AM.gsi.prop.rows&&AM.gsi.prop.rows.mg!=="0";AJ=AM.ghs&&AM.ghs.chs;AI.headerOffset=AJ&&(AJ.show?(AJ.items&&AJ.items.length||1):0)-1;AI.mxPos=AK;},getHACP:function AF(AJ){var AI;if(AJ){AI=new mstrmojo.XtabLevelHACP();if(this.outlineState){AI.outlineState=this.outlineState;}}else{AI=(this._super&&this._super())||new mstrmojo.XtabHACP();}return AI;},_setupCP:function X(AO){var AL=this.titlesCP=this.getTitleCP(AO),AN=this.chsCP=this.getColumnHeadersCP(AO),AJ=this.rhsCP=this.getRowHeadersCP(AO),AK=this.valuesCP=this.getValuesCP(AO);AL.forceAutoRowHeight=AN.forceAutoRowHeight=AO.rh;var AR=new mstrmojo.XtabVACP();var AI=this.getHACP();AI.cps=[AL,AN];AR.cps=[AI];var AP=this.getHACP(this.isOutlineMode);AP.cps=[AJ,AK];AR.cps.push(AP);var AQ=AO.gmh&&AO.gmh.gmrh,AM=AO.rw&&AO.rw.row;if(AQ&&AM){AR.gsmh={};AR.gemh={};AR.gsmh[AM.bb]=AQ.gsmh;AR.gemh[AM.bb+AM.bc-1]=AQ.gemh;}this.zone.cp=AR;},ongridDataChange:function a(){var AI=this.model;if(AI){AI.set("data",this.gridData);if(!this.dataBlocks){this.dataBlocks=[];}this.dataBlocks[0]=this.gridData;}},gridPagesRendered:function c(){if(this._super){this._super();}},getTitleCP:function G(AI){return this.initCP(AI,this.interactiveCellsArray,M);},getColumnHeadersCP:function AB(AI){return this.initCP(AI,this.interactiveCellsArray,AC,AI.ghs&&AI.ghs.chs,AI.gts&&AI.gts.col,Y);},getRowHeadersCP:function AD(AI){var AJ=this.initCP(AI,this.interactiveCellsArray,I,AI.ghs&&AI.ghs.rhs,AI.gts&&AI.gts.row,Q);if(this.onDemandIF&&this.rw){if(!this._onDemandCP){J.call(this,this.rw&&this.rw.row);}this.rhsCPList=[AJ].concat(this._onDemandCP.rhs);return AG(this.rhsCPList)||AJ;}return AJ;},getValuesCP:function b(AJ){var AI=this.initCP(AJ,this.interactiveCellsArray,h,AJ.gvs,AJ.gts&&AJ.gts.col);if(this.onDemandIF&&this.rw){if(!this._onDemandCP){J.call(this,this.rw&&this.rw.row);}this.valuesCPList=[AI].concat(this._onDemandCP.vls);return AG(this.valuesCPList)||AI;}return AI;},createOnDemandCP:function g(AJ,AK,AI){var AL=new mstrmojo.XtabOnDemandCP();AL.dataSource=this;AL.blockNum=AJ;AL.rc=AK;return AL;},dataDownloaded:function U(AJ,AP){var AR=AP.blockNum,AI=this.rhsCPList[AR],AK=this.valuesCPList[AR],AQ=AJ.data,AN=this.gridData;AQ._bidx=AR;this.dataBlocks[AR]=AQ;if(!AI||!AK){return ;}this.initCP(AQ,this.interactiveCellsArray,I,AQ.ghs&&AQ.ghs.rhs,AQ.gts&&AQ.gts.row,Q,AI);this.initCP(AQ,this.interactiveCellsArray,h,AQ.gvs,AN.gts&&AN.gts.col,null,AK);AI.initContent();AK.initContent();this.numRowsDownloaded+=parseInt(AI.rc,10);this.updateStatus(mstrmojo.desc(8301,"Retrieving Data ..."),this.numRowsDownloaded*100/this.numRowsToDownload);var AM=this.zone;if(AM){var AO=AM.cp;if(AO){var AS=AQ.gmh&&AQ.gmh.gmrh,AL=AQ.rw&&AQ.rw.row;if(AS&&AL){AO.gsmh[AL.bb]=AS.gsmh;AO.gemh[AL.bb+AL.bc-1]=AS.gemh;}}AM.dataDownloaded();}},showDownloadStatus:function P(AI){if(!AI){return ;}if(this.showingStatus){this.numRowsToDownload+=AI;}else{this.numRowsToDownload=AI;this.numRowsDownloaded=0;}if(this.showStatus){this.showStatus(true,mstrmojo.desc(8301,"Retrieving Data ..."),this.numRowsDownloaded*100/this.numRowsToDownload);}},closeDownloadStatus:function k(){this.numRowsToDownload=0;if(this.showStatus){this.showStatus(false);}},download:function L(AL,AI,AP){var AO=this.gridData.rw,AK=AO.row,AM=AO.col,AN=AK.rm,AJ=AK.bc;this.rhsCPList[AL].isDownloading=this.valuesCPList[AL].isDownloading=true;if(AJ){this.controller.onDownloadGridData(this,this.model.getDownloadAction(AL*AJ+1,AJ,AM.bb,AM.bc,this.id,AN,{blockNum:AL},AI),AP);}},unrender:function E(AI){this.width=this.widthLimit=this.height=this.heightLimit=0;this.disconnectScrollbox(this);this._super(AI);},getCellForNode:function z(AJ){var AI=AJ&&parseInt(AJ.getAttribute("ei"),10);if(isNaN(AI)){return null;}return this.interactiveCellsArray[parseInt(AI,10)];},getActionCells:function O(AI){var AJ=[],AL=this.selections;var AM=AI.axis+"A"+(AI.ui+1),AN=AL[AM],AK;if(AN&&AN[AI.o]){for(AK in AN){var AO=this.getCellForNode(AN[AK][0]);AJ.push(AO);}}else{AJ.push(AI);}return AJ;},setModel:function AE(AI){this.model=AI;if(AI.data){this.set("gridData",AI.data);}},delegateGridAction:function A(AI,AJ){if(this._shouldResponseToAction(AJ)){AI(this.zone);}},_shouldResponseToAction:function w(AI){return AI!=="refreshOnDataDownloaded";},getTargetZone:function p(){return this.zone;},destroy:function x(){var AI=this.model;if(this.controller&&this.controller.addScrollPosition){this.controller.addScrollPosition(this.gridData.datasetId+"."+this.gridData.k,this.scrollboxLeft,this.scrollboxTop);}if(AI&&AI.destroy){AI.destroy();}this._super();}});mstrmojo.XtabBase.EnumLockedHeaders={OFF:Z,ROW:C,COL:AA,BOTH:N};}());(function(){mstrmojo.requiresCls("mstrmojo.XtabBase","mstrmojo._Formattable","mstrmojo._IsSelectorTarget","mstrmojo._IsDocXtab","mstrmojo._XtabSelections","mstrmojo._XtabCellHoverMgr","mstrmojo.XtabCellHoverPopup","mstrmojo._HasPopup","mstrmojo.dom","mstrmojo.array","mstrmojo.vi.ui.rw.CustomSortDisplayPanel","mstrmojo.mstr.EnumWebAPIErrorCodes");var W=0,b="overflow:auto",Z="overflow:hidden",L=mstrmojo.dom,R=L.position,a=mstrmojo.array,n="mstrmojo.DocPanelStack",r="px",D=mstrmojo.DocDataService.SUPPRESS_DATA,h=mstrmojo.models.template.DataInterface,I=h.ENUM_GRID_RESIZE,m=I.FIXED,M=I.FIT_TO_WINDOW,H=I.FIT_TO_CONTENTS,G=L.isIOSTouch;var d=function K(u,v){var x=u&&u.parent;while(x&&x.scriptClass!==n){if(x.scriptClass===v){return x;}x=x.parent;}return x;};function l(){var AB=36;var v=this.model.docModel.getPanel(),x=v.containerNode,w=R(x),u=mstrApp.rootCtrl.view.toolbar,AC=R(u.domNode);var AA={};AA.x=w.x;AA.w=w.w;AA.y=(AC.y+AC.h)-AB;AA.h=(w.y+w.h)-AA.y;var z=w.y-(AC.y+AC.h);return{csPanelPos:AA,spacerHeight:z};}mstrmojo.Xtab=mstrmojo.declare(mstrmojo.XtabBase,[mstrmojo._Formattable,mstrmojo._IsSelectorTarget,mstrmojo._IsDocXtab,mstrmojo._XtabSelections,mstrmojo._HasPopup],{scriptClass:"mstrmojo.Xtab",cellHoverMgr:"mstrmojo._XtabCellHoverMgr",cellHoverPopupRef:"mstrmojo.XtabCellHoverPopup",preBuildRendering:function A(){var w=this._super();var v=this.gridData;var u=this.lockHeadersCase===W&&v.co;this.scrollboxNodeOverflow=u&&!this.numRowFixed?Z:b;var x=this.getFormats();if(mstrmojo.dom.isIE8&&!v.co&&this.lockHeadersCase===W&&(!v.rw||(v.rw&&(v.rw.row.bc>=v.rw.row.tc)))&&mstrmojo.string.isEmpty(x.height)&&mstrmojo.string.isEmpty(x.width)){this.scrollboxNodeOverflow="";}this._useFilter=this._useFilter||v.cssflt||false;return w;},postBuildRendering:function e(){var w=this.gridData,v=this._super(),AA=this.scrollboxNode;var z=this;if(this.viewport){var AB=function(){z.addDisposable(z.requiresContrib("cellHoverMgr",true));if(G){z.viewport.ontouchstart=null;}else{z.viewport.onmouseover=null;}};if(G){this.viewport.ontouchstart=AB;}else{this.viewport.onmouseover=AB;}}if(!this.getFormats().width&&this.model.docModel.addAutoWidthID&&(this.parent&&this.parent.scriptClass!=="mstrmojo.ExpressDocPanel")){this.model.docModel.addAutoWidthID(this.id);w=this.gridData;var u=w&&w.afc;if(u&&mstrmojo.dom.isIE7){var x=d(this,n);if(x&&x.scriptClass===n){this.viewport.style.width=this.contentNode.offsetWidth+(this.scrollboxNode.offsetWidth-this.scrollboxNode.clientWidth)+"px";}}}if(L.isIE&&!L.isIE8&&this._useFilter){window.setTimeout(function(){var AC=document.createElement("img");AA.appendChild(AC);AA.removeChild(AC);},0);}return v;},onCGBMapChange:function(u){if(this._resolveCGBToTKS(u.cgbMap)&&this._currentSelectedTD){this.defaultAction(this._currentSelectedTD);}},_resolveCGBToTKS:function k(AD){if(!AD){return false;}var AB=this.model.scm,w="\u001E",z,v,AA,x,u,AC=false;for(v in AB){AA=AB[v];x=AA.cgb;for(z in x){u=AD[x[z]];if(u){if(!AA.tks){AA.tks=u;AC=true;}else{if(AA.tks&&(AA.tks.indexOf(u)<0)){AA.tks+=w+u;AC=true;}}}}}return AC;},onGridWidthChanged:function Y(u){if(this._super){this._super(u);}if(this.cellHoverMgr.onXtabWidthChanged){this.cellHoverMgr.onXtabWidthChanged();}},getDim:function(){var u=this.contentNode;return{w:u.scrollWidth,h:u.scrollHeight};},unrender:function B(u){var v=this.cellHoverMgr;if(v&&v.shutdown){v.shutdown();}this._super(u);},link:function E(v,u){this.controller.onLink(this,this.model.getLinkAction(v,u));},sort:function p(u,v){this.controller.onSort(this,this.model.getSortAction(u,v));},advSort:function P(u,v,w){this.controller.onGetAdvSortData(this,v,u._e&&u._e.otp,w);},customSort:function q(AC,w){var AA=this,AE=this.model,AB=AE.getDataService(),AD=AE.docModel,u=AD.getUnitDefinitions(this.k)[this.k].pnk,z=AD.currlaykey,v=AD.getNextKey(),x=AE.getCreateCSVizActions(AC,w,v);AB.submitUpdates(x,{success:function(AK,AG){var AJ=AK.data,AI=a.filterOne(AJ.layouts,function(AO){return AO.k===z;}),AF={};AF[v]=AI.xtabStyles[v];AD.controller.view.updateXtabStyles(z,AF);AD.updateDefnCache(AK.defn,[v,u]);AD.updateDataCache(AJ,AD.getTargetDefn(v));var AN=l.call(AA),AL=R(AA.domNode),AH=600,AM=mstrmojo.insert({scriptClass:"mstrmojo.vi.ui.rw.CustomSortDisplayPanel",model:AD,nodeKey:v,srcPanelKey:u,srcLayoutKey:z,srcViz:AA,srcUnit:AC,srcAxis:w,width:Math.max(AL.w,AH)+"px",height:AN.csPanelPos.h+"px",left:((typeof AL.x==="number")?AL.x:0)+"px",top:((typeof AN.csPanelPos.y==="number")?AN.csPanelPos.y:0)+"px",spacer:AN.spacerHeight});AM.setVizBoxPortalStateRestore();AM.open();AM.parent=mstrmojo.findAncestor(AA,"openXtabCellMenu");},failure:function(AI,AJ){var AG=6,AK=10000,AH=0,AF=function(){AB.submitUpdates({act:"undo",stid:AB.stid},{success:function(AL,AM){mstrApp.hideWait();},failure:function(AL,AM){if(++AH<AG&&AL.code==mstrmojo.mstr.EnumWebAPIErrorCodes.MSI_ADDUSERJOB_ERROR){setTimeout(AF,AK);}else{mstrApp.hideWait();}}},{config:{silent:true},hideCancel:true,noUpdate:true,preserveStid:true,noDeltaXML:true});};mstrApp.showWait();AF();}},{style:{params:{treesToRender:3}},noUpdate:true,preserveStid:true,noDeltaXML:true,hideCancel:true});},pivot:function N(u,v){this.controller.onPivot(this,this.model.getPivotAction(u,v));},drill:function o(u,v){this.controller.onDrill(this,this.model.getDrillAction(this.getActionCells(u),v));},removeUnit:function S(u){this.controller.onRemoveUnit(this,this.model.getRemoveTemplateUnitAction({id:u._e?u._e.oid:u.id,t:u._e?u._e.otp:u.otp}));this.onDemandDrillItems=null;this.onDemandDrillDynamicItems=null;},showViewFilter:function V(u){this.controller.onShowFilterEditor(this,u);},showTotal:function J(u,w,v){this.controller.onShowTotals(this,this.model.getTotalsAction(u,w,v));},derivedMetric:function j(u,AA){var v,z=u._e.oid,w={did:z,alias:u._e.n,n:u._e.n,v:u.um?u.formula:u._e.v,idx:u.mix,host:this,nodeKey:this.k,dsid:this.controller.model.findDatasetIdFromUnit(z)||this.model.data.datasetId},AB;if(AA==="edit"){v={metricId:w.did,action:{cmd:"edit",n:w.n,alias:w.alias}};AB=this.controller.model.getDataService().getEditDerivedMetricSubmitFunc(w);}else{v={metricId:"",action:{cmd:"editNew",refOi:{did:w.did,n:w.n}}};AB=this.controller.model.getDataService().getAddNewDerivedMetricToXtabSubmitFunc(w);}var x=this.controller.model;if(x.isFromSolrCube&&x.isFromSolrCube(w.did)||x.isFromMDXCube(w.did)){v.disableAFB=true;}this.controller.openDME(this,v,AB);},deleteSelectorControl:function Q(){var u=this.gridData,v=u.sc;if(v&&parseInt(v.ct,10)===6){delete u.sc;}},findSelectorControl:function C(){var u=this.gridData.sc;if(u&&parseInt(u.ct,10)===6){this.selectorControl=u;}else{delete this.selectorControl;}return this.selectorControl;},handlesMultiSelection:function g(v){var u=this.getCellForNode(L.findAncestorByName(v.getTarget(),"td",true,this.viewport)),x=u&&this.model.data.gts[u.axis===1?"row":"col"][u.tui||u.ui],w=x&&x.id&&x.sc;return !!(this.findSelectorControl()||w);},getBasicSubtotalEditorConfig:function c(w){var u=new mstrmojo.ui.menus.EditorConfig({contents:new mstrmojo.express.ui.SubtotalsWidget({onchange:function v(){var x=this.getSubtotalTypes(),z=x[0].length>0||x[1].length>0;u.set("okEnabled",z);}}),data:{},okEnabled:false});if(!this.model.data.gsi.hidesb){u.contents.set("selectedItems",w||[]);}return u;},updateRelatedColWidths:function O(v){if(this.isCustomSort&&this.getActionMgr().isCurrentActionSilent()){return ;}var AB=(new mstrmojo.models.template.DataInterface(this.gridData)).getColumnHeaderData(true),z=this.gridData.twm||{},x=z.bottom,u=z.top,w=this.getTargetZone,AA;(v||[]).forEach(function(AE){var AD=AE.colIndex,AF=AB[AD],AC=AF._ridx||[];AA=AE.value;if(AC.length>1){AC.forEach(function(AG){u[AG]=u[AG]||{};u[AG].w=x[AG].w=AA;});}else{u[AD]=u[AD]||{};u[AD].w=x[AD].w=AA;}w.autoFitWindow=false;w.autoFitContent=false;});this.refresh();},updateScenario:function F(v){var u=this.gridData;u.afc=v===H;u.afw=v===M;if(v!==m){this.setAllXtabWidths("");}this.refresh();},setAllXtabWidths:function t(u){},changeResizeScenario:function f(AD,AI,AJ,AE){var AL=new mstrmojo.models.template.DataInterface(this.gridData),w=this.gridData.twm||{},x=w.bottom,u=AL.getColumnHeaderData(true),AF=this,AB=this.model,v=this.id,AK=this.k,z=[],AA=[],AC=1,AH=[];if(AI){z.push({act:"changeXtabColWidthScenario",value:AD});u.forEach(function(AN,AM){var AQ=AN.oid||AN.id,AP=function(AR){return AR.unitId===AQ&&AR.depth===AC;};if(!(AN.fs&&AN.fs.length>0)){AC=1;}var AO=AQ===(AJ&&AJ.did)&&AC===AJ.depth;if(!AH.some(AP)){AH.push({unitId:AQ,depth:AC});AA.push({colIndex:AM,value:AO?AJ.width+r:x[AM].w});if(AD===m){z.push(AB.getColumnResizeAction(AQ,AN.otp,AO?AJ.width:parseInt((x[AM].w)||0,10),AC,AO?AJ.isExtra:false));}}AC++;});var AG=function AG(AM,AO){var AN=mstrmojo.all[v];if(AM===m){AF.updateRelatedColWidths(AO);}AF.updateScenario(AM);};AG(AD,AA);AF.submitColumnWidthChange(z,AE);}return AE?z:undefined;},submitColumnWidthChange:function X(w,u){if(!u){this.model.getDataService().submitTemplateUpdates(this.k,w,{success:function v(){}},D);}},changeColumnWidth:function U(z,AG,v,AH,w,AD){var AJ=new mstrmojo.models.template.DataInterface(this.gridData),u=AJ.getColumnHeaderData(true),AB=this.model,x=[],AF=this,AA=[],AC=1,AE=-1,AI=[];if(AJ.getColResizeScenario()!==m){x=this.changeResizeScenario(m,true,{did:z,t:AG,width:v,depth:AH,isExtra:w},AD);return AD?x:undefined;}if(z==="all"){u.forEach(function(AL,AK){var AO=AL.oid||AL.id,AN=function(AP){return AP.unitId===AO&&AP.depth===AC;},AM=u[AK-1];if(!(AL.fs&&AL.fs.length>0)||(AM&&AO!==(AM.oid||AM.id))){AC=1;}if(!AI.some(AN)){AI.push({unitId:AO,depth:AC});AA.push({colIndex:AK,value:v+r});x.push(AB.getColumnResizeAction(AO,AL.otp,v,AC,false));}AC++;});}else{u.every(function(AL,AK){var AM=(AL.oid===z||AL.id===z);if(AM){AE=AK+AH-1;}return !AM;});if(AE>=0){AA.push({colIndex:AE,value:v+r});x.push(AB.getColumnResizeAction(z,AG,v,AH,w));}}AF.updateRelatedColWidths(AA);AF.submitColumnWidthChange(x,AD);return AD?x:undefined;}});}());(function(){mstrmojo.requiresCls("mstrmojo.array","mstrmojo.hash","mstrmojo.dom","mstrmojo.num","mstrmojo._HasOwnAvatar","mstrmojo.XtabBase","mstrmojo.models.template.DataInterface");var Y=mstrmojo.array,D=mstrmojo.dom,Q=mstrmojo.num,W=mstrConfig,I="px",B="xrsz",Z="t",M=3,R=mstrmojo.XtabBase.EnumLockedHeaders,V=R.ROW,c=R.BOTH;function J(){var d=this.gridData.gts;return d.row.concat(d.col);}function N(){var v=this.gridData,h=this.lockHeadersCase,g=v.gts,m=v.ghs,d=m.rhs||[],r=m.chs||[],q=d.cws||[],w=(g.cws||[]).concat(r.cws||[]),p=v.gvs||[],n=q.concat(p.cws||[]),u=this.zone.domNode.getElementsByTagName("tr"),t=u&&u[u.length-1],j=false,o=this.isOutlineMode;if(t){var e=t.getElementsByTagName("td")[0];v.xrh=(e&&e.offsetHeight)||0;}j=Y.some(q,function(x){return x.w==="";});if(v.afw||v.afc||j){var l=this.rszmap;if(window.neeHandlingForSvgImgs){neeHandlingForSvgImgs(this.zone.domNode);}var f=Math.max(w.length,n.length);Y.forEach(u,function(x){var AA=x.childNodes;if(AA.length===f||o){var z=bottomIndex=0;Y.forEach(x.getElementsByTagName("td"),function(AF,AD){var AE=D.position(AF).w;var AC=parseInt(AF.colSpan,10),AG=AE/AC;if(w[z]&&AF.offsetParent!==null){if(!AF.colSpan||AF.colSpan===1){w[z++].w=AE+I;}else{for(var AB=0;AB<AC;AB++){if(!w[z]){w[z]={};}w[z].w=AG+I;z=z+1;}}}if(n[bottomIndex]&&AF.offsetParent!==null){if(!AF.colSpan||AF.colSpan===1){n[bottomIndex++].w=AE+I;}else{for(var AB=0;AB<AC;AB++){if(!n[bottomIndex]){n[bottomIndex]={};}n[bottomIndex].w=AG+I;bottomIndex=bottomIndex+1;}}}});return false;}});}if(n.length!==w.length){var k=J.call(this);Y.forEach(k,function(AC,x){var z=AC.fs,AD=(z&&z.length)||0;if(AD>1){var AA=w[x],AB;for(AB=0;AB<AD-1;AB++){w.splice(x+AB+1,0,AA);}}});if(n.length>w.length){w.push(n[n.length-1]);}}return{top:w,bottom:n};}function S(){var m=this.gridData,f=this.isOutlineMode,g=f?2:0;if(!m.gts.show&&f&&mstrApp.isExpress){return ;}var l=this.rszmap=[],k=0,h=0,e=m.twm=N.call(this),o=e.bottom,p=new mstrmojo.models.template.DataInterface(m),d=p.getColumnHeaderData(true),n=d.length;var j=0;Y.forEach(o,function(t,q){if(q>=n){return false;}var r=parseInt(t.w,10);if(isNaN(r)){return false;}if(f&&d&&d[q]&&d[q+1]&&d[q].id===d[q+1].id&&!d[q]._ridx){j=j+r;}else{j=j+r;k+=j;h+=j;if(q===n-1){k=k-1-g;h=h-1-g;}l.push({left:k,offsetLeft:h});j=0;}});Y.forEach(l,function(z,q){var u=l[q+1],t=(u&&u.left),r=(t-z.left),x=[this.zone.domNode],v=this.getColClonedZone&&this.getColClonedZone();if(v){x.push(v);}if(!u||(r>(M*2))){Y.forEach(x,function w(AB){var AD=document.createElement("div"),AA=AD.style,AC=this;AD.setAttribute("idx",String(q));AD.setAttribute(Z,B);AD.className=B+((q>0&&l[q-1].skipped)?" zero":"");AA.left=isNaN(z.offsetLeft)?"":((z.offsetLeft-M)+I);AB.appendChild(AD);AD.ondblclick=function(AE){AC.onHandleDblClick(AE);};},this);}else{z.skipped=true;}},this);}function a(f){if(!f){return ;}var d=f.getElementsByClassName(B),e=d.length-1;for(;e>-1;e--){f.removeChild(d[e]);}}function H(g,f){var d=g.getElementsByClassName(B),e=0;for(e=0;e<d.length;e++){f.appendChild(d[e].cloneNode());}}mstrmojo.rw.xtab._XtabColResize=mstrmojo.provide("mstrmojo.rw.xtab._XtabColResize",{_mixinName:"mstrmojo.rw.xtab._XtabColResize",rszmap:undefined,onRender:function F(){if(this._super){this._super();}if(this.gridData.eg!==undefined){return ;}var e=this;var d=mstrApp&&D.isMac()&&mstrApp.getWSLiveMode&&mstrApp.getWSLiveMode();window.setTimeout(function(){if(!e.hasRendered){return ;}if(!mstrApp.isExpress||mstrApp.features["grid-layout"]){S.call(e);}e.raiseEvent({name:"xtabColsMeasured"});},d?500:0);D.attachMarkupEvent(this.id,this.domNode,"mousedown");},unrender:function X(d){D.detachEvent(this.domNode,"mousedown",mstrmojo.emptyFn);this._super(d);},refreshResizeHandlers:function G(){if(!mstrApp.isExpress||mstrApp.features["grid-layout"]){a(this.getTargetZone().domNode);a(this.getColClonedZone&&this.getColClonedZone());S.call(this);if(this.clonedRowHeader&&this.clonedRowHeader.domNode){a(this.clonedRowHeader.domNode.firstChild);H(this.getTargetZone().domNode,this.clonedRowHeader.domNode.firstChild);}if(this.clonedTitle&&this.clonedTitle.domNode){a(this.clonedTitle.domNode.firstChild);H(this.getTargetZone().domNode,this.clonedTitle.domNode.firstChild);}}},gridPagesRendered:function A(){this.refreshResizeHandlers();if(this._super){this._super();}},isColResizeNode:function P(d){return(d.className||"").indexOf(B)>=0;},isDragValid:function C(d){return this.isColResizeNode(d.src.node)||(this._super&&this._super(d))||false;},ondragstart:function b(f){if(this.isColResizeNode(f.src.node)){var d=D.position(this.domNode),k=D.findAncestorByAttr(f.src.node,"idx",true,this.domNode),n=k&&parseInt(k.value,10),j=this.rszmap,e=j[n].left-(n>0?j[n-1].left:0),o=Math.max(d.x,(f.src.pos.x-e)),r=new mstrmojo.models.template.DataInterface(this.gridData),q=this.gridData,g=this.isOutlineMode,h=this.zone.domNode.getElementsByTagName("tr");if(g){var m=h[0],l=m.getElementsByTagName("td"),p=0;Y.forEach(l,function(v,u){var t=parseInt(v.colSpan,10)||1;if(u<=n){p=u>0?p+1:p;p=p+t-1;}else{return false;}});n=p;}this.rszData={idx:n,originalWidth:e,min:o,max:d.x+d.w,colName:r.getColumnHeaderData(true)[n].n};}if(this._super){this._super(f);}this.ignoreHover=true;},ondragmove:function L(f){if(this.rszData){var e=this.rszData,d=f.src.pos,g=Math.max((e.originalWidth+(f.tgt.pos.x-d.x)),0);this.avatar.firstChild.innerHTML=e.colName+" "+((Q.UNIT.PX==W.units)?g:parseFloat(Q.convertUnits(Q.UNIT.PX,W.units,g)).toFixed(2))+" "+W.unitsLabel;}this._super(f);},ondragend:function E(h){if(this.rszData){var g=this.gridData,f=this.rszData.idx,k=(new mstrmojo.models.template.DataInterface(g)).getColumnHeaderData(true),l=k[f],e=l.fs,d=l.fix||1;if(e&&e.length>0){d=f-Y.find(k,"id",l.id)+1;}var j=l.oid||l.id;this.changeColumnWidth(j,l.otp,Math.max((parseInt(N.call(this).bottom[f].w,10)+(h.tgt.pos.x-h.src.pos.x)),0),d,(j===""&&l.axis===2));delete this.rszData;}this._super(h);this.ignoreHover=false;},createAvatar:function O(h){var k=document.createElement("div"),e=k.style,d=D.position(h),g=D.position(this.domNode);if(this.isColResizeNode(h)){this.avatarCssClass=B;e.top=g.y+I;e.left=d.x+I;e.height=g.h+I;var j=document.createElement("div");j.className=B+"-ttp";var f=document.createElement("div");f.className=B+"-anchr";k.appendChild(j);k.appendChild(f);}else{delete this.avatarCssClass;}return k;},positionAvatar:function K(h,f){if(this.rszData){var e=this.avatar,g=e.style,d=this.rszData;if(!this.avatar||!this.rszData){return ;}g.left=Math.min(Math.max(h.x,d.min),d.max)+"px";}else{this._super(h,f);}},isHandleNode:function U(d){return !!d&&d.getAttribute&&d.getAttribute(Z)===B;},onHandleDblClick:mstrmojo.emptyFn});}());(function(){mstrmojo.requiresClsP("mstrmojo","Box","Button","RadioList","Label","array");mstrmojo.requiresClsP("mstrmojo.ui","Pulldown");var H=mstrmojo.desc,R=mstrmojo.css,K=mstrmojo.array;function P(){R.addClass(this.list.domNode,"AdvancedSort-PopupList");this.parent.isActive(true);}mstrmojo.SortRow=mstrmojo.declare(mstrmojo.Box,null,{scriptClass:"mstrmojo.SortRow",markupString:'<div id="{@id}" class="mstrmojo-SortRow {@cssClass}" style="{@cssText}" mstrAttach:click><div></div><div class="mstrmojo-sort-rule-delete"></div><div style="clear:both;"></div></div>',markupSlots:{containerNode:function O(){return this.domNode.firstChild;},deleteNode:function J(){return this.domNode.children[1];}},sortRule:undefined,sortOrder:undefined,rank:undefined,originalPos:null,isActive:function L(V){this.parent&&this.parent.pulldownActive(V);},onclick:function S(V){if(V.getTarget()===this.deleteNode){this.parent.deleteSortRule(this);}},isAscending:function U(){return this.sortOrder.value===0;},isCustomSort:function C(){return this.sortOrder&&this.sortOrder.value===2;},getSortKey:function F(){return this.sortRule.value;},setPulldownOptions:function Q(W){var V=this.sortRule;V.set("items",V.items.concat(W));},resetPulldownOptions:function E(){this.sortRule.set("selectedIndex",0);this.sortRule.set("items",[{v:"",n:" ",cls:"firstItem"}]);},setSelected:function N(b,X,a){var V=K.find(this.sortRule.items,"v",b);if(X===2){if(V===-1){var W=mstrApp.rootCtrl.docCtrl.model,c=W.findUnitInDataSet&&(W.findUnitInDataSet((b||"").split("!")[1])||{}).n;this.sortRule.set("items",this.sortRule.items.concat([{v:b,n:c}]));V=this.sortRule.items.length-1;}this.sortRule.set("selectedIndex",V);this.sortRule.set("enabled",false);var Y=K.find(this.sortOrder.items,"v",2);if(Y===-1){this.sortOrder.set("items",this.sortOrder.items.concat({n:H(5705,"Custom Sort"),v:2}));Y=this.sortOrder.items.length-1;}this.sortOrder.set("selectedIndex",Y);this.sortOrder.set("enabled",false);}else{if(V===-1){if(!a){this.sortRule.set("selectedIndex",0);this.sortOrder.set("selectedIndex",0);return ;}else{this.sortRule.set("items",this.sortRule.items.concat([{v:b,n:a}]));V=K.find(this.sortRule.items,"v",b);}}this.sortRule.set("selectedIndex",V);var Z=this.sortOrder.items;if(Z.length>2){this.sortOrder.set("items",Z.slice(0,2));}this.sortOrder.set("selectedIndex",(X===0?1:0));}},setRank:function B(V){this.rank.set("number",V);},getRank:function G(){return this.rank.number;},children:[{scriptClass:"mstrmojo.Widget",alias:"rank",number:0,markupString:'<div class="order-column"><div class="draggable-icon"></div><div class="order">{@number}</div></div>',markupMethods:{onnumberChange:function D(){this.domNode.children[1].innerText=this.number;this.refresh();}}},{scriptClass:"mstrmojo.ui.Pulldown",alias:"sortRule",cssClass:"mstrmojo-sort-rule-pulldown",selectedIndex:0,value:"",allowHTML:false,items:[{v:"",n:" ",cls:"firstItem"}],bindings:{enabled:"this.items && this.items.length > 1"},isHostedWithin:false,onPopupWidgetOpened:function M(){P.call(this);},onPopupWidgetClosed:function A(){this.parent.isActive(false);},onitemSelected:function I(V){this.value=V.v;this.parent.parent.itemSelected();}},{scriptClass:"mstrmojo.ui.Pulldown",alias:"sortOrder",cssClass:"mstrmojo-sort-rule-order",value:0,selectedIndex:0,bindings:{enabled:"this.parent.sortRule.items && this.parent.sortRule.items.length > 1"},isHostedWithin:false,onPopupWidgetOpened:function M(){P.call(this);},onPopupWidgetClosed:function A(){this.parent.isActive(false);},onitemSelected:function I(V){this.value=V.v;},items:[{n:H(1885,"Ascending"),v:0},{n:H(1886,"Descending"),v:1}]}]});}());(function(){mstrmojo.requiresCls("mstrmojo.css","mstrmojo.vi.ui.HierarchyCheckList","mstrmojo.ui._IsIncFetchHierarchyList");var A=mstrmojo.css;mstrmojo.vi.ui.IncHierarchyCheckList=mstrmojo.declare(mstrmojo.vi.ui.HierarchyCheckList,[mstrmojo.ui._IsIncFetchHierarchyList],{scriptClass:"mstrmojo.vi.ui.IncHierarchyCheckList",cssClass:"elementsList"});}());(function(){mstrmojo.requiresCls("mstrmojo.vi.ui.HierarchyCheckList","mstrmojo.EnumSelectionType","mstrmojo.ui.PopupButton","mstrmojo.hash","mstrmojo.array","mstrmojo.css","mstrmojo.func","mstrmojo.dom","mstrmojo.tooltip","mstrmojo._HasTooltip","mstrmojo.fe.FilterUtils","mstrmojo.vi.ui.rw.selectors._CanSearchOnServer");mstrmojo.requiresDescs(3474,2119,2461,493);var O=mstrmojo.array,f=mstrmojo.css,V=mstrmojo.hash,G=mstrmojo.dom,g=mstrmojo.fe.FilterUtils,A=mstrmojo.EnumSelectionType;var K=28,e=70,Y=196;function X(m,n){var l=[],k=m.parent;n=n||"n";while(k){if(!k.hid&&k[n]){l.push(k[n]);}k=k.parent;}return l;}mstrmojo.vi.ui.rw.selectors.HierarchyCheckList=mstrmojo.declare(mstrmojo.vi.ui.HierarchyCheckList,[mstrmojo.vi.ui.rw.selectors._CanSearchOnServer],{scriptClass:"mstrmojo.vi.ui.rw.selectors.HierarchyCheckList",markupString:'<div id="{@id}" class="mstrmojo-ui-CheckList hierarchy {@cssClass}" style="{@cssText}" mstrAttach:click,contextmenu><div class="header"><span class="search-bar"><span class="ph"></span></span><span class="level-bar"><span class="ph"></span></span></div><div class="scroll-container"><div class="{@icnCss}" style="{@icnCssText}">{@itemsHtml}</div></div><div class="footer"><div class="all-bar"><span class="allBtn select">'+mstrmojo.desc(3474,"Select All")+'</span><span class="allBtn clear">'+mstrmojo.desc(2119,"Clear All")+"</span></div></div></div>",markupSlots:{headerNode:function F(){return this.domNode.firstChild;},footerNode:function C(){return this.domNode.lastChild;},searchboxNode:function N(){return this.domNode.firstChild.firstChild.firstChild;},levelBtnNode:function S(){return this.domNode.firstChild.lastChild.firstChild;},scrollboxNode:function I(){return this.domNode.children[1];},itemsContainerNode:function h(){return this.domNode.children[1].firstChild;},tooltipNode:function H(){return this.domNode.children[1].firstChild;}},useRichTooltip:true,init:function b(k){this._super(k);if(G.isEdge){f.addWidgetCssClass(this,"edge");}},postBuildRendering:function d(){var l=this.levelBtn;if(!l){var k=this.getLevelPopupConfig(),m=V.walk(k.scriptClass,window);delete k.scriptClass;l=this.levelBtn=new m(k);this.addDisposable(l);}l.placeholder=this.levelBtnNode;l.render();return this._super();},unrender:function c(l){var k=this.levelBtn;if(k){k.unrender(l);}return this._super(l);},onclick:function j(k){var l=k.getTarget();if(f.hasClass(l,"allBtn")){this.doAllSelect(f.hasClass(l,"select"));k.cancel();}else{this._super(k);}},onSelectionChange:function P(l,k,m,n){this._super(l,k,m,n);this.onchange();},doExpandCollapse:function R(p,n){var m=this,l=!n.epd,o=this.scrollNode.scrollTop,k=false;if(this.delegateExpandCollapse){k=this.delegateExpandCollapse({elementId:n.v,isExpand:l},{success:function(q){m.scrollNode.scrollTop=o;}});}if(!k){this._super(p,n);}},searchLevel:-1,searchItems:[],updateItems:function M(k,l){this._super(k,l);this.clearSearch();},isHiearachyDisplay:function E(){return !this.isOnSearch();},showTooltip:function D(k,o){var n=k.target||G.eventTarget(k.hWin,k.e),l=this.getItemFromTarget(n);if(l&&!this.isHiearachyDisplay()){var p=this.getItemNodeFromTarget(n),m=G.position(p);this.tooltipOpenDelay=mstrmojo._HasTooltip.TOOLTIP_OPEN_DELAY;this.richTooltip={cssClass:"vi-regular vi-tooltip-A",content:X(l).reverse().join(" > "),refNode:p,top:m.h,left:10};this._super(k,o);}},getSourceDefn:function Q(){var k=this.docSelector;return k&&k.node&&k.node.defn;},getDataService:function J(){var k=this.docSelector;return k&&k.model&&k.model.getDataService();},onSearchSuccess:function U(k,l){var m=[];k.forEach(function(o){var n=this.getItemByValue(o.v);if(!o.hid){m.push(o);}V.copy({lv:o.lv||0,dhid:!n||n.dhid,pid:o.pid?o.pid+";"+l.attributeId:o.pi>-1?k[o.pi].v:""},o);delete o.hcd;delete o.hid;delete o.epd;delete o.pi;},this);this.searchItems=this.searchItems.concat(k);this.addItems(k);m=m.map(function(n){return this.getItemByValue(n.v);},this);this._super(m,l);},widgetResized:function L(){var l=this.searchbox,k=this.footerNode;this._super();if(l&&l.hasRendered){l.onwidthChange();}if(k){f.toggleClass(k,"multi",parseInt(this.width)<Y);this.updateScrollbars();}},getSearchbarCfg:function Z(){return V.copy({scriptClass:"SearchWidget2",hasFilter:true,useRichTooltip:true,showTooltip:function k(o,n){var l=this.filter.selectedNode,m=G.eventTarget(n,o);if(m===l&&m.scrollWidth>m.clientWidth){this.richTooltip={cssClass:"vi-regular vi-tooltip-A",content:l.innerText,refNode:l,top:G.position(l).h+6};this.constructor.prototype.showTooltip.call(this,o,n);}},onwidthChange:function(l){var n=this.filter.selectedNode,m=Math.max(Math.min(this.domNode.clientWidth,this.domNode.parentNode.clientWidth)*0.7-K,e);n.style.width="";if(n.scrollWidth>m){n.style.width=m+"px";}},onfilterItemSelected:function(n,p){var o=this.parent,m=o.searchLevel,l=n.v;o.searchLevel=l;o.expressionXML=l>=0?g.getExprXml(o.getLevelExpression(l)):"";if(this.hasRendered){this.onwidthChange();}},postCreateChildren:function(){this.filter.isHostedWithin=false;},preBuildRendering:function(){var m=this.parent,l=m.getLevelItems(true),n=m.searchLevel;this.filterSelectedIndex=0;this.set("filterItems",l);this.set("filterSelectedIndex",Math.max(O.find(l,"v",n),0));},postBuildRendering:function(){this.constructor.prototype.postBuildRendering.call(this);this.onwidthChange();}},this._super());},renderFilteredItems:function W(k){f.toggleClass(this.footerNode,"hidden",true);this._super(k);},renderOriginalItems:function B(){f.toggleClass(this.footerNode,"hidden",false);this._super();},clearSearchItems:function a(){this.searchItems=[];this._super();}});}());(function(){mstrmojo.requiresCls("mstrmojo.registry","mstrmojo.boxmodel","mstrmojo.Popup","mstrmojo.MenuItem","mstrmojo.Box");mstrmojo.requiresClsP("mstrmojo.express.ui","SubmenuEditor","SubtotalMenuEditor");mstrmojo.requiresDescs(1018);var F="mstrXtabCellMenu",Q="mstrmojo.all['"+F+"'].selectedData",G="mstrmojo.all['"+F+"'].xtab",H="mstrmojo-InteractiveButton",J="mstrmojo.Box",B="mstrmojo-Menu-Box",I="mstrmojo.MenuItem";function M(W,S){var V=mstrmojo.all[F],U=V.xtab,R=[V.selectedData].concat(S||[]);V.close();U[W].apply(U,R);}function L(){M("link",[this.index]);}function A(U,W,V,R){var S={scriptClass:I,text:U,iconClass:"mstrmojo-oivmSprite "+W,cssClass:H,onclick:V};if(R){S.bindings=R;}return S;}function C(S,V,U){var R=A(S,"tbPivot"+V,function(){M("pivot",[U]);});R.bid=U;return R;}function K(S,U,R){return A(S,"tbSort"+U,function(){M("sort",[(R==="true")]);},{selected:"mstrmojo.all['"+F+"Sort'].so === "+R});}function P(V,U,S){if(!V){return null;}var R=U.model.getCellDrillsInfo(S);if(!R||!R.k){return null;}return A(mstrmojo.desc(183,"Drill to")+" "+(R.n||""),"tbDrill",function(){M("drill");});}function O(R,U,S){return A(R,"tbDerivedMetric"+U,function(){M("derivedMetric",[S]);});}mstrmojo.XtabCellMenu=mstrmojo.registry.ref({id:F,slot:"popupNode",scriptClass:"mstrmojo.Popup",cssClass:"mstrmojo-Menu",shadowNodeCssClass:mstrmojo.dom.isIE7||mstrmojo.dom.isIE8?"mstrmojo-Menu-shadow":"",contentNodeCssClass:"mstrmojo-Menu-content",autoCloses:false,locksHover:true,disposable:false,derivedMetricOptions:null,updatePopupConfig:function E(Y){Y=Y||{};var e=this.xtab=Y.xtab,h;this.selectedNode=Y.td;var V=this.selectedData=Y.data||(e&&Y.td&&e.getCellForNode(Y.td));this.onClose=Y.onClose;var b=this.sortOptions,R=((V&&V.at)||0)&8,W=V&&(V.mix!==undefined&&V._e&&V._e.otp===4);b.set("visible",R||W);b.children[0].set("visible",R);b.children[1].set("visible",R);b.children[2].set("visible",R||W);b.set("so",V&&V.so);b.children[2].set("onclick",function(){M("advSort",[V.axis]);});b=this.pivotOptions;var g=((V&&V.at)||0)&16;if(g){var U;for(U=0;U<b.children.length;U++){var Z=b.children[U];Z.set("visible",e.model.isPvtButtonVisible(V,Z.bid));}}b.set("visible",g);b=this.linkOptions;h=e.model.getCellLinksInfo(V);b.set("visible",(((V&&V.at)||0)&4)&&(h&&h.links&&h.links.length>0));b=this.drillOptions;var d=((V&&V.at)||0)&1,f=P(d,e,V);b.set("visible",d&&f);b.set("children",[f]);b=this.derivedMetricOptions;var X=mstrApp.isVI&&V&&V.hasOwnProperty("mix");if(X){b.children[0].set("visible",X);b.children[1].set("visible",V.um);}b.set("visible",X);b=this.subtotalsOptions;var a=e.model.getCellTitleInfo(V),S=V&&!V.hasOwnProperty("mix")&&a.isSrcTitle&&V.otp!==-1;b.set("visible",S);if(S){b.set("children",[this.getSubtotalMenuCfg(mstrmojo.desc(6193,"Show Totals"))]);b.showSubtotalsBtn.set("xtab",e);b.showSubtotalsBtn.set("cell",this.selectedData);}this.cfg=Y;},getSubtotalMenuCfg:function N(R){return{scriptClass:"mstrmojo.express.ui.SubmenuEditor",text:R,cssClass:H,alias:"showSubtotalsBtn",contentScriptClass:"mstrmojo.express.ui.SubtotalMenuEditor",parentID:F};},nudge:function D(){var Y=this.cfg,X=Y.opener,f=X&&X.domNode&&mstrmojo.dom.position(X.domNode),g=f.y||0,a=Y.cmPos,c,Z,e;if(a){c=a.x;Z=a.y-g;}else{var S=Y.el||(Y.btn&&Y.btn.domNode);e=mstrmojo.boxmodel.offset(S,X&&X[this.slot]);c=e.left;Z=e.top+((S&&S.offsetHeight)||0);}var W=mstrmojo.dom.windowDim(),U=this.domNode;var V=U.offsetHeight,b=W.h-g;e=Math.max(0,Z+V-b);this.set("top",Z-e+"px");var d=U.offsetWidth,R=W.w;e=Math.max(0,c+d-R);this.set("left",c-e+"px");},subtotalsOptions:null,children:[{id:F+"Links",alias:"linkOptions",scriptClass:J,cssClass:B,visible:false,children:[{scriptClass:"mstrmojo.WidgetList",autoHide:true,itemFunction:function(S,R){if(R===0){mstrmojo.requiresCls(I);}return new mstrmojo.MenuItem({text:S.n||S.url||(S.target&&(S.target.n||S.target.did)),cssClass:H,cssText:(R===this.itemsInfo&&this.itemsInfo.di)?"font-weight: bold":"",index:R,onclick:L});},bindings:{itemsInfo:"this.parent.parent.visible ? "+G+".model.getCellLinksInfo("+Q+") : null",items:"this.itemsInfo.links"}}]},{id:F+"Drill",alias:"drillOptions",scriptClass:J,cssClass:B,visible:false},{id:F+"Sort",alias:"sortOptions",scriptClass:J,cssClass:B,children:[K(mstrmojo.desc(7974,"Sort Ascending"),"Asc","true"),K(mstrmojo.desc(7975,"Sort Descending"),"Desc","false"),A(mstrmojo.desc(11099,"Advanced Sort ..."),"tbAdvSort",mstrmojo.emptyFn)]},{id:F+"Pivot",alias:"pivotOptions",scriptClass:J,cssClass:B,children:[C(mstrmojo.desc(11110,"Move to Beginning"),"Beginning","b"),C(mstrmojo.desc(5362,"Move Left"),"Left","l"),C(mstrmojo.desc(5363,"Move Right"),"Right","r"),C(mstrmojo.desc(7978,"Move Up"),"Up","u"),C(mstrmojo.desc(7979,"Move Down"),"Down","d"),C(mstrmojo.desc(7976,"Move to Columns"),"Cols","2"),C(mstrmojo.desc(7977,"Move to Rows"),"Rows","1")]},{id:F+"DerivedMetric",alias:"derivedMetricOptions",scriptClass:J,cssClass:B,children:[O(mstrmojo.desc(11649,"Add Derived Metric"),"Add","add"),O(mstrmojo.desc(11648,"Edit Derived Metric"),"Edit","edit")]},{id:F+"Subtotals",alias:"subtotalsOptions",scriptClass:J,cssClass:B,visible:true}]});}());(function(){mstrmojo.requiresCls("mstrmojo.ui.editors.controls.ListPreviewButton","mstrmojo.css");var C,D=mstrmojo.css;var J=mstrmojo.declare(mstrmojo.ui.PopupList,null,{getItemMarkup:function G(K){if(!C){C=this._super(K).replace(">{@en@n}<","><div>{@en@n}</div><");}return C;},getItemProps:function F(M,K){var L=this._super(M,K);L.addCls("bst"+K);if(K){L.title=M.n;L.n="";}else{L.tt="";}return L;}});mstrmojo.ui.editors.controls.LineStyleButton=mstrmojo.declare(mstrmojo.ui.editors.controls.ListPreviewButton,null,{scriptClass:"mstrmojo.ui.editors.controls.LineStyleButton",itemValueField:"id",showThickOption:true,markupMethods:{onenabledChange:function E(){D.toggleClass(this.domNode,"disabled",!this.enabled);}},init:function H(L){this._super(L);var K=["mstrmojo-ui-LineStyle"];if(!this.showThickOption){K.push("no-thick");}D.addWidgetCssClass(this,K);},getListCfg:function I(){return new J({selectionPolicy:"reselect",items:[{n:mstrmojo.desc(2258,"None"),id:"none"},{n:mstrmojo.desc(2259,"Dashed"),id:"1pt dashed"},{n:mstrmojo.desc(2260,"Dotted"),id:"1pt dotted"},{n:mstrmojo.desc(2262,"Thin"),id:"1pt solid"},{n:mstrmojo.desc(2264,"Thick"),id:"2pt solid"}]});},postBuildRendering:function A(){this.borderStyleNode=this.previewNode.appendChild(document.createElement("div"));return this._super();},updatePreview:function B(){var N=this.borderStyleNode,L=this.selectedValue.split(" "),K=this.selectedValue==="conflict";D.toggleClass(this.previewNode,"conflict",K);if(N&&!K){var M=N.style;if(L.length===1){M.borderTopStyle=L[0];if(L[0]==="none"){M.position="static";N.innerHTML=mstrmojo.desc(2258,"None");N.classList.add("ellipsis");}}else{M.borderTopWidth=L[0];M.borderTopStyle=L[1];M.position="";N.innerHTML="";}}}});}());(function(){mstrmojo.requiresCls("mstrmojo.ui.editors.controls.ListPreviewButton","mstrmojo.ui.editors.controls.ValidationTextBox","mstrmojo.EditableLabel");var A=mstrmojo.css,E=mstrmojo.validation.STATUSCODE;mstrmojo.ui.editors.controls.ComboBox=mstrmojo.declare(mstrmojo.ui.editors.controls.ListPreviewButton,null,{scriptClass:"mstrmojo.ui.editors.controls.ComboBox",markupMethods:{onenabledChange:function D(){this.txtLabel.set("enabled",this.enabled);this.txtLabel.set("editOnClick",this.enabled);A.toggleClass(this.domNode,"disabled",!this.enabled);}},init:function B(F){this._super(F);mstrmojo.css.addWidgetCssClass(this,"mstrmojo-ui-ComboBox");},updatePreview:function C(){this.txtLabel.set("value",this.selectedValue||"");},updateSelection:function(){this.set("selectedValue",this.txtLabel.value);},validateTextInput:function(F){return true;},txtLabel:null,children:[{scriptClass:"mstrmojo.ui.editors.controls.ValidationTextBox",alias:"txtLabel",slot:"previewNode",constraints:{validator:function(){if(!this.parent.validateTextInput(this.value)){return{id:this.id,code:E.INVALID,msg:""};}}},onValid:function(){this.parent.updateSelection();}}]});}());(function(){mstrmojo.requiresCls("mstrmojo.Container","mstrmojo.hash","mstrmojo.util.ui.ColorPicker","mstrmojo.ui.editors.controls.ColorList","mstrmojo.ui.editors.controls.ColorWheel","mstrmojo.Label","mstrmojo.ui.Pulldown","mstrmojo.TextBoxWithLabel","mstrmojo.ui.ButtonBar","mstrmojo.Button","mstrmojo.css","mstrmojo.util.color");mstrmojo.requiresDescs(16164);var R=1,a=2,S=mstrmojo,B=S.css,U=S.array,W=mstrmojo.util.ui.ColorPicker,J=S.util.color,P=Math.round,Z=R,N=0,D=1,X=2,c="txtColor",f="automatic",j="#ffffff",A="transparent";var F=[{n:mstrmojo.desc(12071,"Color fill"),id:N},{n:mstrmojo.desc(12072,"No fill"),id:D},{n:mstrmojo.desc(12073,"Gradient"),id:X}];function O(){return this.color!==f?this.color:this.autoPreviewColor;}function V(m){return J.getCSSColorString(m);}function b(o,n,m){return mstrmojo.Button.newWebButton(o,m,n,{slot:"buttonNode",cssDisplay:"inline-block"});}function l(n){var o={},m=O.call(this);if(n&&(typeof m==="string")){m=V(m);var p=m.toLocaleLowerCase();n.forEach(function(r,q){if((p===r.id.toLocaleLowerCase())&&(p!==A)){o[q]=true;}});}return o;}function Q(m){return{scriptClass:"mstrmojo.ui.editors.controls.ColorList",items:m,selectedIndices:l.call(this,m),postselectionChange:function(n){var q=n.added;if(q){var p=this.parent,o=this.items[q[0]].id;p.set("color",o);p.colorChanged(o);}}};}function G(m){return"#"+m.replace("#","");}function E(){var m=this.txtColor1,p=this.txtColor2,n=this.color,o=false,q=this.colorStyle;switch(q.items[q.selectedIndex].id){case N:n=G(m.value);break;case D:n=A;break;case X:n={or:this.gradientOrientation.getSelectedItems()[0].id,c1:G(m.value),c2:G(p.value)};o=true;break;}B.toggleClass(this.containerNode,"grad",o);this.set("color",n);}function L(m){this.set("activeColor",m);var n=this[m];U.forEach([1,2],function(p){var o=this[c+p];B.toggleClass(o.domNode,"on",o===n);},this);this.colorWheel.set("color",G(n.value));}function K(m,n,o,p){if(typeof o==="string"){if(o===A){o=j;}}else{if(!!o&&o.c1){o=o["c"+m];}else{o=j;}}o=V(o);return{scriptClass:"mstrmojo.TextBoxWithLabel",alias:c+m,cssDisplay:"block",label:n,autoCorrect:false,maxLength:6,size:6,value:o.replace("#",""),bindings:p,onfocus:function(){L.call(this.parent,this.alias);},onvalueChange:function(q){if(!/^[0-9a-fA-F]{0,6}$/.test(q.value)){this.value=q.valueWas;}else{if(this.value.length===6){var r=this.parent;r.colorWheel.set("color",G(this.value));E.call(r);}}}};}function H(){var p=O.call(this),o="this.parent.colorStyle.items[ this.parent.colorStyle.selectedIndex ].id",t=o+" === "+X,r=o+" !== "+D,w=(this.showNoFill&&p===A)?1:0,u=F.slice(0,this.showGradient?3:2),m=0,n=this.showGradient,v=!!p&&p.c1;if(!this.showNoFill){u.splice(1,1);}if(v){w=U.find(u,"id",X);m=p.or?0:1;}this.addChildren([{scriptClass:"mstrmojo.ui.Pulldown",alias:"colorStyle",selectedIndex:w,items:u,visible:(u.length!=1||(v&&!n)),onRender:function q(){if(!n&&v){this.selectedNode.innerHTML='<div class="mstrmojo-ui-Pulldown-Gradient" style="color:#C0C0C0">'+mstrmojo.desc(16164,"Gradient (Not supported)")+"</div>";}},onitemSelected:function(){E.call(this.parent);}},{scriptClass:"mstrmojo.ui.ButtonBar",alias:"gradientOrientation",items:[{n:mstrmojo.desc(2066,"Horizontal"),id:1,css:"h"},{n:mstrmojo.desc(2069,"Vertical"),id:0,css:"v"}],selectedIndex:m,bindings:{visible:t},postselectionChange:function(x){if(x.added){E.call(this.parent);}}},{scriptClass:"mstrmojo.Button",cssClass:"simpleButton",text:mstrmojo.desc(11658,"Swap"),bindings:{visible:t},onclick:function(){var AA=this.parent,z=AA.txtColor1,AB=AA.txtColor2,x=z.value;z.set("value",AB.value);AB.set("value",x);E.call(AA);}},K(1,mstrmojo.desc(12074,"Color HEX:"),p,{visible:r,label:o+" === "+X+' ? "'+mstrmojo.desc(12075,"Color 1 HEX:")+'" : "'+mstrmojo.desc(12074,"Color HEX:")+'";'}),K(2,mstrmojo.desc(12076,"Color 2 HEX:"),p,{visible:t}),{scriptClass:"mstrmojo.ui.editors.controls.ColorWheel",alias:"colorWheel",color:(!!p&&!!p.c1)?p.c1:(p||j),onColorPicked:function(x){var z=this.parent;z[z.activeColor].set("value",x.replace("#",""));},bindings:{visible:r}},b(mstrmojo.desc(1442,"Ok"),true,function(){var z=this.parent,x=z.color;if(!x.c1){W.addCustomColor(x);}z.colorChanged(x);}),b(mstrmojo.desc(2140,"Cancel"),false,function(){this.parent.colorCanceled();})]);L.call(this,c+"1");}function e(o){var q=this.sampleNode,p=q.offsetWidth-q.clientWidth,n=q.clientWidth,r=q.clientHeight,t=Math.sqrt(n*n+r*r)-p,m=Math.atan2(r,n)*(-180)/Math.PI+2;q.style.backgroundColor="#FFFFFF";o.display="block";o.top=q.offsetTop+P(r/2)+"px";o.left=q.offsetLeft+"px";o.width=P(t)+"px";o[mstrmojo.dom.CSS3_TRANSFORM]="rotate("+P(m)+"deg)";}function k(){var o=O.call(this),n=this.sampleNode.style;if(o){if(o.c1){var p=B.buildGradient(o.or,o.c1,o.c2);n[B.convertCssToCamelCase(p.n)]=p.v;}else{n.background=o;if(this.showNoFill&&this.noFillNode&&this.enabled){var m=this.noFillNode.style;if(A===o){e.call(this,m);}else{m.display="none";}}}}n.backgroundOrigin="border-box";}mstrmojo.ui.editors.controls.AdvancedColorPicker=mstrmojo.declare(mstrmojo.Container,null,{scriptClass:"mstrmojo.ui.editors.controls.AdvancedColorPicker",markupString:'<div id="{@id}" class="mstrmojo-ui-AdvColorPicker {@cssClass}" style="{@cssText}" mstrAttach:click><div class="acpToolbar"><div class="acpBtn acpSwatchBtn"></div><div class="acpBtn acpPaletteBtn"></div><div class="acpColor"></div><div class="slash"></div></div><div class="acpContent" ></div><div class="acpButtons" ></div></div>',markupSlots:{swatchBtnNode:function(){return this.domNode.firstChild.firstChild;},paletteBtnNode:function(){return this.domNode.firstChild.childNodes[1];},sampleNode:function(){return this.domNode.firstChild.childNodes[2];},noFillNode:function(){return this.domNode.firstChild.lastChild;},containerNode:function(){return this.domNode.firstChild.nextSibling;},buttonNode:function(){return this.domNode.lastChild;}},markupMethods:{onvisibleChange:mstrmojo.Widget.visibleMarkupMethod,onpickerModeChange:function M(){Z=this.pickerMode;this.renderContent();},oncolorChange:function d(){k.call(this);},onautoPreviewColorChange:function h(){k.call(this);}},color:"#000fff",showGradient:false,showNoFill:true,showAutomatic:false,autoPreviewColor:null,activeColor:c+"1",swatchBtnNode:null,paletteBtnNode:null,colorStyle:null,gradientOrientation:null,txtColor1:null,txtColor2:null,colorWheel:null,pickerMode:R,init:function g(m){this._super(m);this.pickerMode=Z;},renderContent:function I(){this.showPickerForCurrentMode();},showPickerForCurrentMode:function C(){var o=this;this.removeChildren();var p=Z===R;if(p){var n=W.getBasicColors();if(!this.showNoFill){n.shift();if(n[0]._renderIdx!==0){U.forEach(n,function(r,q){r._renderIdx=q;});}}if(this.showAutomatic&&this.color!==f){this.addChildren([{scriptClass:"mstrmojo.Label",text:mstrmojo.desc(4531,"Automatic"),cssClass:"AutomaticOption",onclick:function m(){o.set("color",f);o.colorChanged(f);}}]);}this.addChildren([mstrmojo.hash.copy({alias:"basicColors"},Q.call(o,n)),Q.call(o,(mstrApp&&mstrApp.getPreferredColors)?U.map(mstrApp.getPreferredColors(),function(q){return{n:q,id:q};}):[]),Q.call(o,W.getCustomColors())]);}else{H.call(this);}B.toggleClass(this.swatchBtnNode,"on",p);B.toggleClass(this.paletteBtnNode,"on",!p);this.buttonNode.style.display=p?"none":"block";},colorChanged:mstrmojo.emptyFn,colorCanceled:mstrmojo.emptyFn,onclick:function Y(m){var n=m.getTarget(),o=this.pickerMode;if(n===this.swatchBtnNode){o=R;this.set("pickerMode",o);}else{if(n===this.paletteBtnNode){o=a;this.set("pickerMode",o);}}}});mstrmojo.ui.editors.controls.AdvancedColorPicker.VAL_AUTOMATIC=f;}());(function(){mstrmojo.requiresCls("mstrmojo.Box","mstrmojo.num","mstrmojo.dom","mstrmojo.string","mstrmojo.expr","mstrmojo.ui.Pulldown","mstrmojo.MetricSelectorUtility","mstrmojo.hash");var O=mstrmojo.MetricSelectorUtility,N=mstrmojo.vi.ui.rw.selectors.EnumWarningPosition,G=O.OP,a=O.EnumNumberCategory,W=mstrmojo.num,U=mstrmojo.dom,M=mstrmojo.string,R=mstrmojo.expr,Z=R.DTP,K=mstrmojo.hash,I=O.ErrorCode,V={FILTERBYVALUE:0,HIGHEST:1,LOWEST:2,HIGHESTPERCENT:3,LOWESTPERCENT:4},Y=O.OP_NAMES.slice(0),e=O.RANK_OP_NAMES.slice(0),l=function(){var o=function(q){return q===undefined||q===null;},p;for(p=0;p<arguments.length;p++){if(o(arguments[p])){return false;}}return true;},E=function(o){return o===O.Q._G;},b=function(o){return o===O.Q._PT||o===O.Q._PB;},Q=function(p,o){return !(E(p)&&(o===G._IS_NULL||o===G._IS_NOT_NULL));},f=function(p,o){return E(p)&&(o===G._BETWEEN||o===G._NOT_BETWEEN);},B=function(o){return !o.visible||M.isEmpty(o.value);},H=function(p,o){return((p===a.Date||p===a.Time)&&o===O.Q._G)?Z.DATE:Z.REAL;},C=function(p,o){return o+((p&&!M.isEmpty(o)&&!String(o).match(/^\d+%$/))?"%":"");},j=function(p,q,o){if(W.isBigDecimal(q)){return{dtp:Z.BIGDECIMAL,v:q};}else{return{dtp:p,v:C(o,q)};}},c=function(p){if(!p){return p;}if(p.dtp===Z.BIGDECIMAL){var o=String(p.v);if(o&&o.indexOf("#")===-1){return"#"+o+"#";}else{return o;}}else{return p.v;}},A=function(o){return E(o)?G._GREATER_EQUAL:G._LESS_EQUAL;},g=function(p,x,u,o,t){var w=[],v=H(p,x),z=b(x);if(u===G._IN||u===G._NOT_IN){var q=String(o).split(";"),r;for(r=0;r<q.length;r++){if(!mstrmojo.string.isEmpty(q[r])){w.push(j(v,q[r],z));}}}else{if(o!==null){w.push(j(v,o,z));}if(t!==null){w.push(j(v,t,z));}}return w;},h=function(o){this.parent.submit(this,true);},S=function(o){var p=this.parent;if(p.valueChanged||this.value===""){p.submit(this);}},J=function(){this.set("value","");},X=function(){var o=this.parent;o.docSelector.hideWarning();o.valueChanged=true;};mstrmojo.vi.ui.rw.selectors.MetricQualification=mstrmojo.declare(mstrmojo.Box,[mstrmojo._HasLayout,mstrmojo._HasPopup],{scriptClass:"mstrmojo.vi.ui.rw.selectors.MetricQualification",markupString:'<div id="{@id}" class="mstrmojo-vi-metric-qual {@cssClass}" style="{@cssText}"><div class="pulldown"></div><div class="v1"></div><div class="v2"></div></div>',markupSlots:{containerNode:function(){return this.domNode.firstChild;},leftTextNode:function(){return this.domNode.childNodes[1];},rightTextNode:function(){return this.domNode.childNodes[2];}},children:[{scriptClass:"mstrmojo.ui.Pulldown",alias:"func",isHostedWithin:false,items:Y,isSilentSelected:false,onitemSelected:function(){var u=this.parent,q=u.qua,o=u.opId,v=u.leftText,r=u.rightText,t=u.func.getSelectedItem().v,p=o;if(this.isSilentSelected){return ;}o=u.opId=E(q)?t:G._LESS_EQUAL;if(p!==o){u.opChanged=true;}v.set("visible",Q(q,o));r.set("visible",f(q,o));if(v.hasRendered&&v.visible){u.valueChanged=false;}if(E(q)){this.parent.submit();}else{u.set("qua",t);}}},{scriptClass:"mstrmojo.TextBox",alias:"leftText",slot:"leftTextNode",onEnter:S,onblur:h,onfocus:S,onvisibleChange:J,onvalueChange:X},{scriptClass:"mstrmojo.TextBox",alias:"rightText",slot:"rightTextNode",onEnter:S,onblur:h,onfocus:S,onvisibleChange:J,onvalueChange:X}],init:function k(o){this._super(o);this.func.set("useDarkTheme",!this.docSelector.isInFilterPanel()&&mstrApp.getRootController().isDarkThemeSelected());},parseModel:function d(){var AA=this.qua,z=this.cs,AE=this.da,x=this.f,w=this.ft,q=E(AA),AB=q?Y:e,AC=l(x,w)?O.getOpIdxByfunc(x,w):A(AA),r,t;this.opId=AC;if(AE){var o,v;switch(AA){case O.Q._G:o=Number(AE.low).toFixed(0);v=Number(AE.high).toFixed(0);break;case O.Q._RB:case O.Q._RT:o=1;v=AE.cnt;break;case O.Q._PB:case O.Q._PT:o=0;v=100;break;}this.set("low",o);this.set("high",v);}r=(z&&z.length>0)?W.toLocaleString(c(z[0])):"";if(AC===G._IN||AC===G._NOT_IN){for(t=1;t<z.length;t++){r+=";"+W.toLocaleString(String(c(z[t])));}}else{this.set("cs2",(z&&z.length>1)?W.toLocaleString(c(z[1])):"");}if(z&&z.length>0&&b(AA)&&!r.match("%")){r=W.toLocaleString(Math.round(z[0].v*10000)/100);}this.set("cs1",r);var AD=this.leftText,u=this.rightText,p=this.func;AD.set("visible",Q(AA,AC));AD.set("value",this.cs1);u.set("visible",f(AA,AC));u.set("value",this.cs2);p.set("items",AB);p.isSilentSelected=true;p.selectItemByField("v",q?AC:AA);p.isSilentSelected=false;this.valueChanged=false;},onquaChange:function L(z){var o=z.valueWas,v=z.value,q=O.getFuncInfo(this.opId,o).ft,u=O.getFuncInfo(this.opId,v).ft,r,p,t;this.opId=A(v);this.changeQual=true;if(o===V.FILTERBYVALUE||v===V.FILTERBYVALUE){var x=O.getFuncInfo(this.opId,v);this.f=x.f;this.ft=x.ft;this.cs=[];this.qualifyOnChanged=true;this.parseModel();this.submit();return ;}if(u!==q){var w=O.getFuncInfo(this.opId,v);if(this.cs&&this.cs.length!==0&&!this.da.nov){r=this.cs[0].v;t=this.da.cnt;if(v===V.HIGHEST||v===V.LOWEST){if(typeof r==="string"){r=W.toString(r,true).replace("%","")/100;}this.cs=[{v:Math.floor(r*t)}];}else{p=Math.ceil((r/t)*10000)/10000;this.cs=[{v:p>1?1:p}];}}else{this.cs=[];}this.f=w.f;this.ft=w.ft;this.parseModel();}if(this.cs&&this.cs.length!==0){this.submit();}},validateValues:function m(z){var AA=this.leftText,t=this.rightText,w=this.qua,x=this.opId,r;if(x===G._IS_NULL||x===G._IS_NOT_NULL){this.docSelector.hideWarning();return null;}if(x===G._IN||x===G._NOT_IN){var p=String(AA.value).split(";"),v;for(v=0;v<p.length;v++){r=O.doValidation(p[v],this,{refNode:AA.inputNode,position:N.TOP,closeOnClick:false},true);if(r.invalid){if(r.errorCode===I.EmptyValue){r.clearValue=true;}return r;}}}else{z=z||AA;r=O.doValidation(z.value,this,{refNode:z.inputNode,position:N.TOP,closeOnClick:false},true);var q,u;if(f(w,x)){var o=(z===AA)?t:AA;q=O.doValidation(o.value,this,{refNode:o.inputNode,position:N.TOP,closeOnClick:false},true);}if(r.errorCode===I.EmptyValue&&(!q||q.errorCode===I.EmptyValue)){u=true;}if(!r.invalid&&!!q){r=q;}if(u){r.clearValue=u;}return r.invalid?r:null;}return null;},submit:function P(AA,p){var AB=this.validation&&this.validation.errorCode,o=this.validateValues(AA),r=AA?AA.parent.parent.warning:null,q=r?r.visible:null,x=this.valueChanged||this.value==="",z=!!(x&&o&&o.clearValue),AC=function(){if(q&&p&&o.errorCode===AB){this.set("validation",null);}else{this.set("validation",o);U.setInputSelection(o.refNode);}};if(!o||!o.invalid||z){if(x||this.changeQual||!!this.opChanged){var w=this.qua,v=this.opId,u=this.cs1=Q(w,v)?this.leftText.value:null,t=this.cs2=f(w,v)?this.rightText.value:null;this.cs=g(this.numFmts.cat,w,v,u,t);this.parent.node.data.cs=this.cs;this.changeQual=true;this.forceUnset=z;this.onchange();this.valueChanged=false;this.opChanged=false;this.changeQual=false;if(AA){AA.blur();}}}else{if(AA){AC.call(this);}}if(z||this.qualifyOnChanged){AC.call(this);this.qualifyOnChanged=false;}return !o;},updateData:function D(o,p){this.da=o;this.updateExpr(p);},updateExpr:function n(o){if(o){this.cs=o.cs;this.f=o.f;this.ft=o.ft;this.qua=o.qua;}this.parseModel();},doLayout:function F(){this.layoutConfig=this.layoutConfig?K.copy({xt:true},this.layoutConfig):{xt:true};if(this.parent.isInFilterPanel()){this.layoutConfig.w={containerNode:"65%",leftTextNode:"30%",rightTextNode:"30%"};}this._super();}});}());(function(){mstrmojo.requiresCls("mstrmojo.ui.editors.controls.ControlGroup","mstrmojo.Label","mstrmojo.num","mstrmojo.expr","mstrmojo.ui.Pulldown","mstrmojo.ui.editors.controls.TwoColumnContainer","mstrmojo.ValidationTextBox","mstrmojo.ui.editors.controls.ValidationTextBox","mstrmojo.models.template.DataInterface");var E="selColScenario",N="colTargetAndWidth",D="selRowScenario",G="rowHeightContainer",C=mstrmojo.num,I=mstrConfig,F=mstrmojo.expr,H=mstrmojo.models.template.DataInterface.ENUM_GRID_RESIZE,M=H.FIXED,A=mstrmojo.ui.Pulldown.newPulldown;function B(P,O,Q){O.slot="col1Node";return{scriptClass:"mstrmojo.ui.editors.controls.TwoColumnContainer",alias:P,col1Width:"100%",col2Width:"56px",children:[O,{scriptClass:"mstrmojo.Box",slot:"col2Node",value:0,enabled:true,children:[{scriptClass:"mstrmojo.ui.editors.controls.ValidationTextBox",cssText:"text-align:right;width:36px",cssDisplay:"inline-block",bindings:{value:"this.parent.value",enabled:"this.parent.enabled"},dtp:F.DTP.NUMERIC,onValid:function(){var R,S;if(C.UNIT.PX!==I.units){R=parseFloat(this.value).toFixed(2);S=R!==parseFloat(this.orignText);}else{R=parseInt(this.value,10);S=R!==parseInt(this.orignText,10);}if(S){Q.call(this.parent.parent.parent,R);}}},{scriptClass:"mstrmojo.Label",cssDisplay:"inline-block",cssText:"width:16px;padding-left:2px;",text:C.UNIT_SYMBOL[I.units],title:I.unitsLabel}]}]};}function J(R,Q,P){var O=[{n:mstrmojo.desc(2987,"Fit to contents"),v:H.FIT_TO_CONTENTS},{n:mstrmojo.desc(2050,"Fixed"),v:M}];if(P){O.unshift({n:mstrmojo.desc(13580,"Fit to container"),v:H.FIT_TO_WINDOW});}return A(O,function(S){var U=this.parent;U[Q].set("enabled",S.v===M);if(!U._sync){U.targetXtab.changeResizeScenario(S.v,P);}},undefined,{alias:R,isHostedWithin:false});}mstrmojo.ui.editors.controls.XtabResizeGroup=mstrmojo.declare(mstrmojo.ui.editors.controls.ControlGroup,null,{scriptClass:"mstrmojo.ui.editors.controls.XtabResizeGroup",init:function K(O){this._super(O);mstrmojo.css.addWidgetCssClass(this,"mstrmojo-ui-XtabResize");var P=this;this.addChildren([{scriptClass:"mstrmojo.Label",text:mstrmojo.desc(159,"Columns")},J(E,N,true),B(N,A([],function(W){var R=this.parent,V=W.width,Q=P.xtabInterface.getColResizeScenario()===M,U=P.xtabInterface.getColResizeInfo(P.targetXtab.model.docModel.datasets).widths||[{}];if(U.length){var S=U[0].width;if(Q&&W._renderIdx!==undefined){P.targetXtab.edtModel._lsfcw=W._renderIdx;}if(V===""){var X=U.every(function(Y){return Y.width===S;});if(X){V=S;}}R.parent.syncControls(function(){R.getControl(2).set("value",(Q&&V!=="")?((C.UNIT.PX===I.units)?V:parseFloat(C.convertUnits(C.UNIT.PX,I.units,V)).toFixed(2)):"");});}}),function(R){var Q=this[N].getControl(1).getSelectedItem();this.targetXtab.changeColumnWidth(Q.did,Q.t,Math.round(C.convertUnits(I.units,C.UNIT.PX,R)),Q.depth||1,false);}),{scriptClass:"mstrmojo.Label",text:mstrmojo.desc(113,"Rows")},J(D,G,false),B(G,{scriptClass:"mstrmojo.Label",text:mstrmojo.desc(13581,"Row height:")},function(Q){this.targetXtab.changeRowHeight(Math.round(C.convertUnits(I.units,C.UNIT.PX,Q)));})]);},targetXtab:null,xtabInterface:null,setFormatSource:function L(U){var S=this,R=S.xtabInterface=this.addDisposable(new mstrmojo.models.template.DataInterface(U.model.data)),V=R.isEmpty(),Q=U.edtModel,O=Q._lsfcw=Q._lsfcw===undefined?1:Q._lsfcw,P=!V&&!U.excludeData;S.targetXtab=U;S.set("enabled",P);if(P){this.syncControls(function(){var b=R.getColResizeInfo(U.model.docModel.datasets),W=b.widths||[];S[E].selectItemByField("v",b.v);var Z=S[N],Y=Z.getControl(1);W.unshift({n:mstrmojo.desc(2429,"All Columns"),did:"all",width:""});Y.set("items",W);Y.set("selectedIndex",b.v===M?Math.min(O,W.length-1):0);var c=R.getRowResizeInfo(),a=c.v,X=c.height;S[D].selectItemByField("v",a);S[G].getControl(2).set("value",a===M?((C.UNIT.PX===I.units)?X:parseFloat(C.convertUnits(C.UNIT.PX,I.units,X)).toFixed(2)):"");});}}});}());(function(){mstrmojo.requiresClsP("mstrmojo","Editor","HBox","Button","Label","TextBox","hash","dom","css","array","desc");mstrmojo.requiresCls("mstrmojo.warehouse.EnumDatabaseType","mstrmojo.ui.Checkbox","mstrmojo.ui.Pulldown","mstrmojo.ui.CheckList");mstrmojo.requiresDescs(959,2056,15656,15657,15658,15659,15660,15661,2397,2399);var M=mstrmojo.warehouse.EnumDatabaseType,D=mstrmojo.hash,J=mstrmojo.array,I=mstrmojo.dom,L=mstrmojo.css,F=mstrmojo.desc;var Q=[{v:"",n:F(959,"Default")},{v:"General Number",},{v:"Standard"},{v:"Currency"},{v:"Percent"},{v:"Scientific"},{v:"General Date"},{v:"Long Date"},{v:"Short Date"},{n:F(2056,"Custom")}];Q.forEach(function(R){if(R.n===undefined){R.n=R.v;}});var G={};G[M.MSAS]={min:0,max:65535,maxlength:5};G[M.EssBase]={min:0,max:126,maxlength:3};function O(U,W){var S=null,V=G[W],R=/^-?\d+$/;if(R.test(U)){U=parseInt(U);if(V&&U>=V.min&&U<=V.max||!V){S=U;}}return S;}function C(R){var S=/(\"|\-\-|\/\/|\/\*|\*\/)/;return R&&R.length&&!S.test(R);}var K={mptf:{mptso:{pru:1,v:500},mptsim:{pru:1,v:0},mptfms:""},dbt:M.MSAS,so_dft:0,sim_dft:0};function P(){return D.clone(K);}function B(R){switch(R){case"so":return this.config.mptf.mptso;case"si":return this.config.mptf.mptsim;case"fs":return this.config.mptf.mptfms;case"dbt":return this.config.dbt;case"soDefault":return this.config.so_dft;case"siDefault":return this.config.sim_dft;}}function N(){return{mptso:{pru:this.soBox.soDefaultCb.checked?1:0,v:parseInt(this.soBox.soTB.value)},mptsim:{pru:this.siBox.siDefaultCbBox.siDefaultCb.checked?1:0,v:this.siBox.siClBox.siCl.selectedIndex},mptfms:this.fsBox.fsTbBox.fsTb.value};}mstrmojo.PassThroughOptions=mstrmojo.declare(mstrmojo.Editor,null,{scriptClass:"mstrmojo.PassThroughOptions",cssClass:"mstrmojo-PassThroughOptions",title:F(15656,"Pass-through Options"),updatePopupConfig:function H(R,U){if(R){this.onOK=R.onOK;delete R.onOK;}["left","top","width","height","zIndex"].forEach(function(V){if(R[V]!==undefined){this.set(V,R[V]);delete R[V];}}.bind(this));var S=P();D.forEach(R,function(W,V){if(W===undefined){delete R[V];}});this.config=D.copy(R,S);},onOpen:function E(){this.soBox.set("dirty",false);this.soBox.set("valid",true);this.siBox.set("dirty",false);this.fsBox.set("dirty",false);this.fsBox.set("valid",true);var U=B.call(this,"dbt")===M.EssBase,W=B.call(this,"so");L.toggleClass(this.editorNode,"ess",U);this.soBox.soDefaultCb.set("checked",W.pru);if(!W.pru){this.soBox.soTB.set("value",W.v);}else{this.soBox.soTB.set("value",B.call(this,"soDefault"));}if(!U){var S=B.call(this,"si"),R=B.call(this,"fs"),V;this.siBox.siDefaultCbBox.siDefaultCb.set("checked",S.pru);if(!S.pru){this.siBox.siClBox.siCl.select(S.v);}else{this.siBox.siClBox.siCl.select(B.call(this,"siDefault"));}V=J.find(Q,"v",R);if(V<0){V=J.find(Q,"v",undefined);}this.fsBox.fsPdBox.fsPd.set("selectedIndex",V);this.fsBox.fsTbBox.fsTb.set("value",R);}},children:[{scriptClass:"mstrmojo.Box",alias:"soBox",cssClass:"mstrmojo-PassThroughOptions-soBox",processDirty:function A(){var Y=this.parent,V=B.call(Y,"so"),X=V.pru,R=V.v,U=this.soDefaultCb.checked,S=this.soTB.value,W=X!=U||(!U&&R!=S);this.set("dirty",W);},children:[{scriptClass:"mstrmojo.Label",cssDisplay:"inline-block",text:F(15657,"Solve Order:")},{scriptClass:"mstrmojo.TextBox",alias:"soTB",cssClass:"mstrmojo-PassThroughOptions-soTB",cssDisplay:"inline-block",useRichTooltip:true,enabled:false,updateTooltipConfig:function(){var W=this.parent.parent,U=this.domNode,R=I.position(U),V=B.call(W,"dbt"),S=F(15658,"The value has to be between # and ##.").replace("#",G[V].min).replace("##",G[V].max);this.richTooltip={cssClass:"vi-regular vi-tooltip-V",posType:mstrmojo.tooltip.POS_BOTTOMLEFT,content:S,top:R.y,left:R.x};},onvalueChange:function(){var V=this.parent.parent,U=B.call(V,"dbt"),S=O(this.value,U),R=(S!=null);this.set("textValid",R);if(!R){this.showTooltip();}else{this.hideTooltip();}this.parent.set("valid",R);this.parent.processDirty();}},{scriptClass:"mstrmojo.Label",cssDisplay:"inline-block",cssClass:"right",text:F(959,"Default")},{scriptClass:"mstrmojo.ui.Checkbox",alias:"soDefaultCb",cssDisplay:"inline-block",cssClass:"right",checked:true,oncheckedChange:function(R){var V=this.parent.parent,S=this.parent.soTB,U=this.checked;S.set("enabled",!U);if(U){S.set("value",B.call(V,"soDefault"));}this.parent.processDirty();}}]},{scriptClass:"mstrmojo.Box",alias:"siBox",cssClass:"mstrmojo-PassThroughOptions-siBox",processDirty:function A(){var Y=this.parent,X=B.call(Y,"si"),W=X.pru,R=X.v,U=this.siDefaultCbBox.siDefaultCb.checked,S=this.siClBox.siCl.selectedIndex,V=W!=U||(!U&&R!=S);this.set("dirty",V);},children:[{scriptClass:"mstrmojo.HBox",alias:"siDefaultCbBox",cssClass:"mstrmojo-PassThroughOptions-siDefaultCbBox",children:[{scriptClass:"mstrmojo.Label",text:F(15659,"Scope Isolation:")},{scriptClass:"mstrmojo.ui.Checkbox",alias:"siDefaultCb",checked:true,oncheckedChange:function(R){var S=this.parent.parent,V=S.parent,U=S.siClBox.siCl;U.set("enabled",!this.checked);if(this.checked){U.select(B.call(V,"siDefault"));}S.processDirty();}},{scriptClass:"mstrmojo.Label",text:F(959,"Default")}]},{scriptClass:"mstrmojo.HBox",alias:"siClBox",cssClass:"mstrmojo-PassThroughOptions-siClBox",children:[{scriptClass:"mstrmojo.ui.CheckList",alias:"siCl",multiSelect:false,orientation:"h",selectedIndex:1,items:[{n:"NONE",v:0},{n:"CUBE",v:1}],onchange:function(R){this.parent.parent.processDirty();}}]}]},{scriptClass:"mstrmojo.Box",alias:"fsBox",cssClass:"mstrmojo-PassThroughOptions-fsBox",children:[{scriptClass:"mstrmojo.HBox",alias:"fsPdBox",cssClass:"mstrmojo-PassThroughOptions-fsPdBox",children:[{scriptClass:"mstrmojo.Label",text:F(15660,"Format String:")},{scriptClass:"mstrmojo.ui.Pulldown",alias:"fsPd",selectedIndex:0,items:Q,onselectedIndexChange:function(){var S=this.getSelectedItem(),R=S&&S.v===undefined,U=this.parent.parent.fsTbBox.fsTb;U.set("visible",R);if(R){U.set("value","");}else{U.set("value",S&&S.v);}}}]},{scriptClass:"mstrmojo.HBox",alias:"fsTbBox",cssClass:"mstrmojo-PassThroughOptions-fsTbBox",children:[{scriptClass:"mstrmojo.TextBox",alias:"fsTb",updateTooltipConfig:function(){var U=this.domNode,R=I.position(U),S=F(15661,'Custom Format String should not be empty or contain ", //, --, /*, */.');this.richTooltip={cssClass:"vi-regular vi-tooltip-V",posType:mstrmojo.tooltip.POS_BOTTOMLEFT,content:S,top:R.y,left:R.x};},onvalueChange:function(){var R=this.parent.parent;R.processDirty();},bindings:{textValid:function(){var R=this.parent.parent.fsPdBox.fsPd.selectedIndex,U=this.parent.parent,W=U.fsPdBox.fsPd.getSelectedItem(),S=W&&W.v===undefined,V=!S||C(this.value);U.set("valid",V);if(!V){this.showTooltip();}else{this.hideTooltip();}return V;}}}]}],processDirty:function(){var S=this.fsTbBox.fsTb.value,R=B.call(this.parent,"fs");this.set("dirty",S!==R);}},{scriptClass:"mstrmojo.HBox",alias:"buttonBar",slot:"buttonNode",cssClass:"mstrmojo-Editor-buttonBar",cellCssClass:"subBox",children:[{scriptClass:"mstrmojo.Button",cssClass:"mstrmojo-Editor-button mstrmojo-WebButton hot",alias:"saveokButton",text:F(2397,"OK"),bindings:{enabled:function(){var U=this.parent.parent.soBox.dirty,S=this.parent.parent.siBox.dirty,W=this.parent.parent.fsBox.dirty,V=this.parent.parent.soBox.valid,R=this.parent.parent.fsBox.valid;return(U||S||W)&&(V&&R);}},onclick:function(){if(this.enabled){var R=this.parent.parent;if(R.onOK){R.onOK(N.call(R));}R.close();}}},{scriptClass:"mstrmojo.Button",cssClass:"mstrmojo-Editor-button mstrmojo-WebButton",text:F(2399,"Cancel"),onclick:function(){var R=this.parent.parent;R.close();}}]}]});}());(function(){mstrmojo.requiresCls("mstrmojo.Editor","mstrmojo.hash","mstrmojo.array","mstrmojo.Button","mstrmojo.Label","mstrmojo.ToolSeparator","mstrmojo.ui.ScrollableContainer","mstrmojo.ui.Pulldown");mstrmojo.requiresDescs(1442,8689,11952,11953,11954,11955,11956,11957,12136);var D=mstrmojo.hash,K=mstrmojo.array,G=mstrmojo.Button.newWebButton,O=function(Q){if(Q){var P=Q.t;return Math.round(P/10)==52||P==115;}return false;},M={},L,E,I,F,H,B=function(){var e=this,U=e.vis,X=[{scriptClass:"mstrmojo.Label",cssClass:"mstrmojo-title-label",allowHTML:true,text:mstrmojo.desc(11952,"Use  <span>#</span> to filter the following targets:").replace("#",U.title),visible:true},{scriptClass:"mstrmojo.ui.ScrollableContainer",alias:"VisContainer",cssClass:"mstrmojo-scrollable-container",children:[]},{scriptClass:"mstrmojo.ToolSeparator"},{scriptClass:"mstrmojo.ui.Pulldown",cssClass:"mstrmojo-filter-type",cssDisplay:"table-cell",alias:"filterType",selectedIndex:(!!H&&H.length>0)&&!E&&!L?1:0,isHostedWithin:true,enabled:false,items:[{n:mstrmojo.desc(8689,"Filter"),v:true},{n:mstrmojo.desc(11953,"Highlight"),v:false}],onitemSelected:function(h){M.isFilter=h.v;this.isFilter=h.v;e.csl.set("enabled",Q>0&&this.isFilter);e.forType.set("enabled",this.isFilter);},onenabledChange:function(){mstrmojo.css[this.enabled?"removeClass":"addClass"](this.domNode,["disabled"]);}},{scriptClass:"mstrmojo.Label",cssClass:"mstrmojo-type-label",cssDisplay:"table-cell",text:mstrmojo.desc(11954,"data on selection"),visible:true},{scriptClass:"mstrmojo.ui.Pulldown",cssClass:"mstrmojo-for-type",cssDisplay:"table-cell",alias:"forType",value:0,visible:false,selectedIndex:0,isHostedWithin:true,enabled:false,items:[{n:mstrmojo.desc(11955,"for #").replace("#",(I[0]||{}).n),v:false},{n:mstrmojo.desc(11956,"for All Data"),v:true}],onitemSelected:function(h){M.forAllData=h.v;},onenabledChange:function(){mstrmojo.css[this.enabled?"removeClass":"addClass"](this.domNode,["disabled"]);}},{scriptClass:"mstrmojo.CheckBox",cssClass:"mstrmojo-clear-check",alias:"csl",checked:(L?L.showall:true),cssDisplay:"block",label:mstrmojo.desc(11957,"Allow users to clear all selections"),enabled:false,oncheckedChange:function(){M.clearAll=this.checked;}}],R=U.parent.children,b,Z={},Q=0,V=function(l){var k=R[l],j=k.boxContent,n=j.isVisMap,o,p,h,m;if(H){o=mstrmojo.array.find(H,"k",k.k)!==-1;}else{if(I.length>0){if(I[0]&&I[0].sc&&I[0].sc.tks){o=I[0].sc.tks.indexOf(k.k)>-1;}}}Q+=o?1:0;if(k!==U&&O(k.defn)){p=k.boxContent.getFilterType();h=k.boxContent.model.getSelectorControlMapInfo();if(n){m=j.getAllLayerKeys(true);K.forEach(m,function(q){Z[q]={c:false,v:o,ft:p,cgbs:h};});}else{Z[k.k]={c:false,v:o,ft:p,cgbs:h};}X[1].children.unshift({scriptClass:"mstrmojo.CheckBox",cssDisplay:"block",label:k.title,checked:o,oncheckedChange:function(){var q=this.checked;if(n){m=j.getAllLayerKeys(true);K.forEach(m,function(r){Z[r]={c:true,v:q,ft:p,cgbs:h};});}else{Z[k.k]={c:true,v:q,ft:p,cgbs:h};}M.targetKeys=Z;Q+=this.checked?1:-1;e.forType.set("enabled",Q>0&&e.filterType.isFilter);e.filterType.set("enabled",Q>0);e.csl.set("enabled",Q>0&&e.filterType.isFilter);}});}};for(b=R.length-1;b>=0;b--){V(b);}var Y=U.boxContent,f=Y&&Y.isVisMap;if(f){var c=mstrmojo.desc(14751,"Use % of <span>#</span> to filter the following targets:"),S=c.split("%"),a=S&&S.length,g,P,W,d=K.map(Y.getGraphicLayerNameArr(),function(h){return{n:h.n,v:h.k};});if(a!==2){return ;}g=S[0].replace("#",U.title);P=S[1].replace("#",U.title);W={scriptClass:"mstrmojo.HBox",cssClass:"",children:[{scriptClass:"mstrmojo.Label",cssClass:"mstrmojo-title-label",allowHTML:true,text:g,visible:true},{scriptClass:"mstrmojo.ui.Pulldown",cssClass:"",cssDisplay:"table-cell",alias:"sourceLayer",selectedIndex:K.find(d,"v",Y.getKeyForTemplateSelection()),isHostedWithin:true,enabled:true,items:d,onitemSelected:function(h){M.layerKey=h.v;M.isLayerChanged=h.v!==Y.getKeyForTemplateSelection();}},{scriptClass:"mstrmojo.Label",cssClass:"mstrmojo-title-label",allowHTML:true,text:P,visible:true}]};X.splice(0,1,W);}this.addChildren(X);this.targetKeys=Z;};mstrmojo.vi.ui.editors.VisAsFilterDialog=mstrmojo.declare(mstrmojo.Editor,null,{scriptClass:"mstrmojo.vi.ui.editors.VisAsFilterDialog",title:mstrmojo.desc(12136,"Filtering options"),cssClass:"mstrmojo-vis-as-filter",btnAlignment:"right",vis:null,buttons:null,modal:true,visible:false,help:"filtering_options_dialog_box_html5.htm",onOpen:function C(){this.VisContainer.onOpen();},postBuildRendering:function A(){this._super();M={};},toggleFields:function J(){if(I.length!==0){this.forType.set("visible",true);this.filterType.set("enabled",true);}if(H&&H.length>0){this.filterType.set("enabled",true);}if(L){this.csl.set("enabled",true);}},preBuildRendering:function N(){var U=this,P=U.id,W=U.vis,V=W.boxContent,S=V.isVisMap,R=S?V.getWidgetForTemplateSelection().node.defn:W.defn,Q=V.model;I=(Q.getSelectorControlMapInfo?Q.getSelectorControlMapInfo():[]);if(I.length>0){L=I[0].sc;F=I[0].did;E=true;}else{H=R.an;L=V.selectorControl||(V.findSelectorControl&&V.findSelectorControl());E=false;}this.set("buttons",[G(mstrmojo.desc(1442,"OK"),function(){if(!D.isEmpty(M)){M.targetKeys=U.targetKeys;M.singleUnit=E;if(E){M.unitId=F;}M.sc=L;W.model.setVisAsFilter(W,M);}mstrmojo.all[P].destroy();},true),G(mstrmojo.desc(221,"Cancel"),function(){mstrmojo.all[P].destroy();})]);B.call(this);this.toggleFields();this._super();}});mstrmojo.vi.ui.editors.VisAsFilterDialog.open=function(Q){var P=mstrmojo.insert({scriptClass:"mstrmojo.vi.ui.editors.VisAsFilterDialog",vis:Q});P.open();};}());(function(){mstrmojo.requiresCls("mstrmojo.hash","mstrmojo.array","mstrmojo.dom","mstrmojo.expr","mstrmojo.Button","mstrmojo.ui._HasListTooltip","mstrmojo.ui.PopupWidget","mstrmojo.ui.Pulldown","mstrmojo.ui.CheckList");var E=mstrmojo.hash,L=mstrmojo.array,K=mstrmojo.dom,G=mstrmojo.Button.newWebButton,F=mstrmojo.expr.TP.DIM;function H(Q){var R=this.parent,S=this.list;if(Q){this.saveSelection();R.submitSelections();}else{S.selectedIndices=E.copy(R.selectedIndices);}this.close();}mstrmojo.ui.PulldownCheckList=mstrmojo.declare(mstrmojo.ui.PopupWidget,[mstrmojo.ui._HasListTooltip],{scriptClass:"mstrmojo.ui.PulldownCheckList",visible:false,itemCssText:"",onOpen:function C(){var Q=this.list;Q.updateScrollbars();},onClose:function N(){this.list.refresh();},adjustCheckListForPopupOverflow:function M(S){var V=this.domNode,U,R,Y=this.list,X=Y&&(Y.scrollNode||Y.scrollboxNode);if(S&&X){U=K.position(V);R=U.y;if(R+U.h>K.position(document.body).h){var Q=V.offsetHeight,W=X&&X.offsetHeight;X.style.maxHeight=K.getMaxScrollHeight()-(Q-W)+"px";Y.updateScrollbars();}}},getItemFromTarget:function O(Q){return this.list.getItemFromTarget(Q);},getItemNodeFromTarget:function B(Q){return this.list.getItemNodeFromTarget(Q);},adjustCornersForPopupOverflow:function J(){var Q=this._super();this.adjustCheckListForPopupOverflow(Q);return Q;},saveSelection:function D(){this.parent.set("selectedIndices",E.copy(this.list.selectedIndices));},postselectionChange:function I(a){var Z=this.list,X=Z.items,Y=a.added||[],V=a.removed||[],U=Z.selectedIndices,Q=this.parent.allIdx,W=X[Q],S=Y.length+V.length,R=false;if(W&&W.t===F&&S===1){if(Q===Y[0]){X.forEach(function(c,b){if(!U[b]){R=true;U[b]=L.indexOf(V,b)===-1;}});}else{if(Q===V[0]){U={};L.forEach(Y,function(b){U[b]=true;});R=true;}else{if(U[Q]){delete U[Q];R=true;}}}}if(R){Z.set("selectedIndices",E.copy(U));Z.refresh();}},onitemsChange:mstrmojo.emptyFn,children:[{scriptClass:"mstrmojo.ui.CheckList",alias:"list",postBuildRendering:function A(){this.icnCssText=this.parent.itemCssText||this.icnCssText;this.parent.adjustCheckListForPopupOverflow();},postselectionChange:function I(Q){this.parent.postselectionChange(Q);},onitemsChange:function P(Q){this.parent.onitemsChange(Q);}},{scriptClass:"mstrmojo.Box",cssClass:"mstrmojo-Buttons",children:[G(mstrmojo.desc(1442,"Ok"),function(){H.call(this.parent.parent,true);},true,{cssDisplay:"inline-block"}),G(mstrmojo.desc(2140,"Cancel"),function(){H.call(this.parent.parent,false);},false,{cssDisplay:"inline-block"})]}]});}());(function(){mstrmojo.requiresCls("mstrmojo.Widget","mstrmojo.dom","mstrmojo.css","mstrmojo.hash","mstrmojo.SearchWidget","mstrmojo.ui.Pulldown");var C=mstrmojo.css,F=mstrmojo.dom,H=mstrmojo.hash,E={9:"Tab",13:"Enter",27:"Esc",38:"ArrowUp",40:"ArrowDown"},A="sbClear",B="sbSearch";mstrmojo.SearchWidget2=mstrmojo.declare(mstrmojo.SearchWidget,null,{scriptClass:"mstrmojo.SearchWidget2",markupString:'<table id={@id} cellspacing="0" cellpadding="0" class="mstrmojo-SearchWidget mstrmojo-SearchBox-Wrapper {@cssClass}" style="{@cssText};"><tr><td class="mstrmojo-searchBox-firstCell"><div></div></td><td><div class="mstrmojo-SearchBox" mstrAttach:click ><input class="mstrmojo-SearchBox-input" type="text" style="width:{@width};" placeholder="{@placeholderText}" autocomplete="off" autocorrect="off" autocapitalize="off" spellcheck="false" mstrAttach:keyup,blur/></div></td><td><div class="mstrmojo-SearchBox-clear" id="{@id}'+A+'" mstrAttach:click></div></td><td><div class="mstrmojo-SearchBox-bg"><div class="mstrmojo-SearchBox-search" id="{@id}'+B+'" mstrAttach:click ></div></div></td></tr></table>',markupSlots:{filterNode:function(){return this.domNode.rows[0].cells[0].firstChild;},inputNode:function(){return this.domNode.rows[0].cells[1].firstChild.firstChild;},clearNode:function(){return this.domNode.rows[0].cells[2].firstChild;},searchNode:function(){return this.domNode.rows[0].cells[3].firstChild.firstChild;}},filterNode:null,hasFilter:false,onfilterItemSelected:mstrmojo.emptyFn,filterSelectedIndex:null,filterItems:[],onfilterItemsChange:function(){this.filter.set("items",this.filterItems);this.filter.set("selectedIndex",this.filterSelectedIndex);},onfilterSelectedIndexChange:function(){this.filter.set("selectedIndex",this.filterSelectedIndex);},init:function G(J){if(this.hasFilter||J.hasFilter){this.children=[{scriptClass:"mstrmojo.ui.Pulldown",slot:"filterNode",alias:"filter",items:J.filterItems||[],selectedIndex:J.filterSelectedIndex||0,onitemSelected:function I(M,L){var N=this.selectedNode;this.parent.filterSelectedIndex=L;this.parent.onfilterItemSelected(M,N);},getPopupListConfig:function K(){return H.copy({useRichTooltip:true,showTooltip:function L(P,O){var N=F.eventTarget(O,P),M=this.getItemNodeFromTarget(N);if(M&&(M.scrollWidth>M.clientWidth)){this.constructor.prototype.showTooltip.call(this,P,O);}}},this.constructor.prototype.getPopupListConfig.call(this));}}];}this._super(J);},postBuildRendering:function D(){if(this._super){this._super();}if(this.hasFilter){this.filter.set("items",this.filterItems||[]);this.filter.set("selectedIndex",this.filterSelectedIndex||0);}}});}());(function(){mstrmojo.requiresCls("mstrmojo.Editor","mstrmojo.ui.Pulldown");var B={DATA_SOURCES:0,CATALOGS:1,CUBES:2};function D(F,G){return mstrmojo.array.map(F,function(H){H.lv=G;return H;});}mstrmojo.mstr.MDXCubeBrowser=mstrmojo.declare(mstrmojo.Editor,null,{title:mstrmojo.desc(4380,"Select MDX Cube"),help:"Select_MDX_Cube_dialog_box.htm",items:null,selectedItem:null,loadMDXData:function(G){G=G||{};var F=G.item||{};mstrmojo.xhr.request("GET",mstrConfig.taskURL,{success:function(H){G.success(H);},failure:function(H){mstrmojo.alert(H);}},{taskId:"browseMDX",level:F.lv||B.DATA_SOURCES,unitId:F.did||"",roleId:F.roleId||""});},init:function E(F){this._super(F);mstrmojo.css.addWidgetCssClass(this,"mstrmojo-MDXCubeBrowser");},children:[{scriptClass:"mstrmojo.ui.Pulldown",cssClass:"mstrmojo-MDXCubeBrowser-sources",alias:"mdxPulldown",selectedIndex:0,makeObservable:true,items:[{n:mstrmojo.desc(4381,"Data Sources"),did:"",lv:B.DATA_SOURCES}],getPopupListConfig:function(){var G=this;var F=mstrmojo.ui.Pulldown.prototype.getPopupListConfig();F.postclick=function(){G.handleSelection();};return F;},handleSelection:function(){var H=this,F=H.parent;H.set("items",this.items.slice(0,this.selectedIndex+1));H.set("selectedIndex",this.items.length-1);var G=this.selectedItem||this.items[this.selectedIndex];F.set("items",G.items);F.set("selectedItem",null);},addItem:function(F){F.cls="lv-"+F.lv;this.set("items",this.items.concat(F));this.set("selectedIndex",this.items.length-1);}},{scriptClass:"mstrmojo.Button",cssClass:"mstrmojo-OBListItemIcon up mstrmojo-MDXCubeBrowser-sources-btn",bindings:{enabled:function(){return this.parent.mdxPulldown.selectedIndex>0;}},onenabledChange:function(){mstrmojo.css.toggleClass(this.domNode,"disabled",!this.enabled);},onclick:function(){var F=this.parent.mdxPulldown;F.set("selectedIndex",F.selectedIndex-1);F.handleSelection();}},{scriptClass:"mstrmojo.ui.List",cssClass:"mstrmojo-MDXCubeBrowser-cubes",alias:"cubeList",bindings:{items:function(){return this.setCssClass(this.parent.items);}},setCssClass:function(F){var G=this;return mstrmojo.array.map(F,function(H){H.cls=G.getItemCssClass(H);return H;});},selectionAdded:function(F){if(!F.isReselect){var J=this,H=J.parent,I=J.items[F.added];if(I.lv===B.CUBES+1){H.set("selectedItem",I);return ;}var G=this.parent.mdxPulldown;H.loadMDXData({item:I,success:function(L){var K=L.items;if(I.lv==B.CATALOGS){mstrmojo.array.map(K,function(M){M.roleId=I.did;return M;});}H.set("items",D(K,I.lv+1));I.items=K;G.addItem(I);}});}},getItemMarkup:function C(G,F){return'<{@tag} class="item" idx="{@idx}" style="{@style}" title="{@title}"><span class="{@cls}"></span>{@en@n}</{@tag}>';},getItemCssClass:function(F){return"mstrIcon-lv mstrIcon-lv-"+{"1048583":"fDataSource","1048584":"fCatalog","1048585":"qc"}[F.dt];}},{scriptClass:"mstrmojo.Label",bindings:{text:function(){return mstrmojo.desc(2107,"## items found").replace("##",(this.parent.items&&this.parent.items.length)||0);}}},{scriptClass:"mstrmojo.HBox",alias:"btnHBox",slot:"buttonNode",cssClass:"mstrmojo-Editor-buttonBar",children:[mstrmojo.Button.newWebButton(mstrmojo.desc(547,"Select"),function A(){var F=this.parent.parent;F.close();F.onOK(F.selectedItem);},true,{bindings:{enabled:function(){return this.parent.parent.selectedItem.lv===3;}}}),mstrmojo.Button.newWebButton(mstrmojo.desc(221,"Cancel"),function A(){this.parent.parent.close();})]}],postBuildRendering:function(){var G=this;this._super();var F=this.mdxPulldown;this.loadMDXData({success:function(H){G.set("items",D(H.items,B.CATALOGS));F.items[0].items=G.items;}});}});}());(function(){mstrmojo.requiresCls("mstrmojo.ui.editors.controls.ControlGroup","mstrmojo.Label","mstrmojo.TextBox","mstrmojo.ui.Pulldown","mstrmojo.ui.Checkbox","mstrmojo.array","mstrmojo.threshold.ThresholdModel");var G=mstrmojo.array;var I=[{n:mstrmojo.desc(5999,"Replace Text"),v:3},{n:mstrmojo.desc(6000,"Quick Symbol"),v:10},{n:mstrmojo.desc(11898,"Replace With Image"),v:4}];var F=mstrmojo.threshold.ThresholdModel.REPLACE_SYMBOL;function B(N,O,M){this.parent.raiseFormatValueChange(N,O,M);}function E(O){var N=this.parent.model,M=N.threshold;this.replaceType.set("enabled",O);this.replaceText.set("enabled",O);this.replaceSymbol.set("enabled",O);if(!O){delete M[N.getReplaceTypeName()];delete M[N.getReplaceTextName()];}}mstrmojo.threshold.TextGroup=mstrmojo.declare(mstrmojo.ui.editors.controls.ControlGroup,null,{scriptClass:"mstrmojo.threshold.TextGroup",nameRow:undefined,replaceRow:undefined,replaceType:undefined,replaceText:undefined,replaceSymbol:undefined,preBuildRendering:function K(){this._sync=true;if(this._super){this._super();}},postBuildRendering:function A(){if(this._super){this._super();}this._sync=false;},children:[{scriptClass:"mstrmojo.ui.editors.controls.TwoColumnContainer",alias:"replaceRow",col1Width:"10%",col2Width:"90%",replaceChk:undefined,children:[{scriptClass:"mstrmojo.ui.Checkbox",slot:"col1Node",alias:"replaceChk",oncheckedChange:function D(){E.call(this.parent.parent,this.checked);}},{scriptClass:"mstrmojo.Label",slot:"col2Node",text:mstrmojo.desc(11888,"Enable Data Replace")}]},{scriptClass:"mstrmojo.ui.Pulldown",alias:"replaceType",selectedIndex:0,enabled:false,items:I,onenabledChange:function H(){if(this.enabled){B.call(this,"rtp",this.items[this.selectedIndex].v);}},postselectedIndexChange:function(O){var S=O.value,P=O.valueWas,N=this.parent,M=N.replaceText,R=N.replaceSymbol;if(S!==P){var Q=S===1;M.set("visible",!Q);M.set("hint",S===2?mstrmojo.desc(11889,"Image URL"):"");R.set("visible",Q);B.call(this,"rtp",this.items[S].v);}}},{scriptClass:"mstrmojo.TextBox",alias:"replaceText",enabled:false,onenabledChange:function H(){if(this.enabled){B.call(this,"rtxt",this.value);}},onvalueChange:function J(){B.call(this,"rtxt",this.value);var M=this.parent,N=M.replaceType;if(!M.parent.model.threshold.rtp){B.call(this,"rtp",N.items[N.selectedIndex]);}}},{scriptClass:"mstrmojo.ui.Pulldown",alias:"replaceSymbol",selectedIndex:0,isHostedWithin:false,enabled:false,visible:false,items:F,allowHTML:true,getPopupListConfig:function C(){var M=mstrmojo.ui.Pulldown.prototype.getPopupListConfig();M.getItemMarkup=function N(){return'<{@tag} class="item {@cls}" idx="{@idx}" style="{@style}" title="{@title}">{@n}</{@tag}>';};return M;},onenabledChange:function H(){if(this.enabled){B.call(this,"rtxt",this.items[this.selectedIndex].v);}},postselectedIndexChange:function(M){var O=M.value,N=M.valueWas;if(O!==N){B.call(this,"rtxt",this.items[O].v);}}}],setFormatSource:function L(M){var N=this,O=N.parent.model;this.syncControls(function(){var P=M[O.getReplaceTextName()],S=M[O.getReplaceTypeName()];N.replaceRow.replaceChk.set("checked",!!P);var Q=G.find(I,"v",S);N.replaceType.set("selectedIndex",Q===-1?0:Q);if(S!==10){N.replaceText.set("value",P||"");N.replaceSymbol.set("selectedIndex",0);}else{var R=Math.max(G.find(F,"v",P),0);N.replaceSymbol.set("selectedIndex",R);N.replaceText.set("value","");}});}});}());(function(){mstrmojo.requiresCls("mstrmojo.ui.editors.controls.ControlGroup","mstrmojo.Label","mstrmojo.StackContainer","mstrmojo.TabContainer","mstrmojo.TabStrip","mstrmojo.mstr.EnumDSSXMLObjectTypes","mstrmojo.ui.Pulldown","mstrmojo.ui.editors.controls.TwoColumnContainer","mstrmojo.TextBox","mstrmojo.Button","mstrmojo.array","mstrmojo.css","mstrmojo.hash","mstrmojo.string","mstrmojo.vi.ui._IsValidURL","mstrmojo.ui.Checkbox");var H=mstrmojo.array,S=mstrmojo.Button,X=mstrmojo.css,O=mstrmojo.hash,A=mstrmojo.string,P=S.newWebButton,K=mstrmojo.mstr.EnumDSSXMLObjectTypes,Q="http://",N={DISABLED:-1,URL:0,LINK_MSTR:1,LINK_PAGE:3},D=function(a,o,d,k,p){var q=function(r,u,t){if(t){return"<"+r+u+">"+t+"</"+r+">";}return"<"+r+u+"/>";},n=function(t,r){return(t!==undefined?" "+r+'="'+t+'"':"");},h=k?1:undefined,j=2,m=(a===N.URL?A.encodeXMLAttribute(o||""):undefined),c=0,f=(a===N.LINK_MSTR?d.did:undefined),Z=(a===N.LINK_MSTR?d.t:undefined),b=(a===N.LINK_MSTR?d.st:undefined),e=(a===N.LINK_PAGE?d.navPage:undefined),l=A.encodeXMLAttribute(p||""),g=1;return q("hls",n(h,"onw"),q("hl",n(g,"idf")+n(j,"aopam")+n(l,"dtxt")+n(m,"url")+n(a,"lt")+n(Z,"ttp")+n(f,"tid")+n(b,"tstp")+n(e,"np")+n(c,"so")));},B=N.DISABLED,F={},I=function I(Z){if(Z.linkType!==undefined){return Z.linkType;}if(Z.node.data.tid){return N.LINK_MSTR;}if(Z.node.data.navpage){return N.LINK_PAGE;}if(Z.url){return N.URL;}return N.DISABLED;},G=function G(Z){return A.decodeHtmlString((Z.defn.dl&&Z.defn.dl.items&&Z.defn.dl.items[0]&&Z.defn.dl.items[0].n)||Z.tooltip||"");},J=false,E=false,L=function L(){var f=mstrmojo.all[this.hostId],Z=f.node&&f.node.data,e=this.tabgroup.tabstack,b=e.selectedLinkType,d=(B!==b),g=(G(f)!==this.tooltip.text.value),c,a,h=false;if(this.hasRendered&&!J){switch(b){case N.DISABLED:h=d;break;case N.URL:c=e.linkText.text.value;if(!mstrmojo.string.isEmpty(c)&&c!==Q&&this.isValidURL(c)){h=d||(c!==f.url)||g;}break;case N.LINK_MSTR:a=(f.target==="_blank");if(F.did){h=d||(!Z||Z.tid!==F.did)||(a!==this.openNewWin.check.checked)||g;}break;case N.LINK_PAGE:if(F.navPage){h=d||(!Z||Z.navpage!==F.navPage)||g;}break;}this.set("dirty",h);}},C=function(j){if(j){var f=this,o=f.docModel,k=mstrmojo.all[this.hostId],g=this.tabgroup.tabstack,l=g.rwSelector,h=g.pageSelector&&g.pageSelector.text,a=g.selectedLinkType,Z=a===N.URL?true:a===N.LINK_PAGE?false:this.openNewWin&&this.openNewWin.check.checked,c=this.tooltip.text.value,n=A.encodeHtmlString(c),d=a!==N.URL?undefined:g.linkText.text.value,b,e,p,q,r=function(){if(k&&k.model.getSelectedViUnit().k===k.parent.k&&k.parent.id){k.model.selectVIUnit(k.parent.id,true);}k.parent.generateToolbar();},m=function(t){E=true;k.defn.dl=t.dl;k.target=t.target;k.url=t.url;k.tooltip=t.tooltip;k.linkType=t.linkType;k.node.data.tnm=t.linkObjInfo.n;k.node.data.tid=t.linkObjInfo.did;k.node.data.ttp=t.linkObjInfo.t;k.node.data.tstp=t.linkObjInfo.st;k.node.data.navpage=t.linkObjInfo.navPage;k.node.data.navpagenm=t.linkObjInfo.n;g.set("selectedLinkType",t.linkType);g.linkText.text.set("value",t.url||"");f.tooltip.text.set("value",t.tooltip);if(l){l.search.text.set("value",t.linkObjInfo.n||"");f.openNewWin.check.set("checked",t.target==="_blank");}if(h){h.set("selectedIndex",t.linkObjInfo.idx||0);}E=false;r();};if(!E){if(a===N.DISABLED){b="";q=true;}else{if(d||F||Z!==undefined){b=D(a,d,F,Z,n);}}e={dl:O.clone(k.defn.dl),target:k.target,url:k.url,tooltip:k.tooltip,linkType:k.linkType,linkObjInfo:{n:k.node.data.tnm||k.node.data.navpagenm,did:k.node.data.tid,navPage:k.node.data.navpage,t:k.node.data.ttp,st:k.node.data.tstp}};if(c!==undefined||q!==undefined){k.tooltip=q?"":n;if(k.defn.dl){k.parent.defn.dl.items[0].n=q?"":n;}}o.editLink(k.parent,f.hostType,b,{success:function(t){k.linkType=a;o.partialUpdate(t.data,o.getTargetDefn(k.k),t.defn);if(a===N.LINK_MSTR){g.linkText.text.set("value","");if(l){l.search.text.set("value",F.n);}if(h){h.set("selectedIndex",0);}}if(a===N.LINK_PAGE){g.linkText.text.set("value","");if(l){l.search.text.set("value","");}if(h){h.set("selectedIndex",F.idx);}}if(a===N.URL){g.linkText.text.set("value",d);if(l){l.search.text.set("value","");}if(h){h.set("selectedIndex",0);}}if(a===N.DISABLED){delete k.defn.dl;delete k.node.data.dl;delete k.target;delete k.url;g.linkText.text.set("value","");if(l){l.search.text.set("value","");}if(h){h.set("selectedIndex",0);}}else{k.target=Z?"_blank":"";f.tooltip.text.set("value",c);if(l&&l.visible){f.openNewWin.check.set("checked",Z);}}p={dl:O.clone(k.defn.dl),target:k.target,url:k.url,tooltip:k.tooltip,linkType:g.selectedLinkType,linkObjInfo:{n:k.node.data.tnm||k.node.data.navpagenm,did:k.node.data.tid,navPage:k.node.data.navpage,t:k.node.data.ttp,st:k.node.data.tstp}};r();},undo:function(){m(e);},redo:function(){m(p);}});}}this.close();},Y=function(d){var c=0,b=[{n:mstrmojo.desc(15776,"Select a page in this dossier"),idx:c++}],f=d.defn.layouts,a,Z,e;H.forEach(f,function(g){a=g.units;b.push({n:g.title,idx:c++});Z=d.getVisPanelKeys(g.k,true);H.forEach(Z,function(h){e=a[h];b.push({n:e.ttl,navPage:h,idx:c++});});});return b;},M=function M(Z){return Z.node.data.tnm;},U=function U(d,b){var a=d.children,Z=H.find(a,"alias",this._pageTab.alias),c=(Z>-1),e=H.filter(b,function(f){return f.navPage;}).length>1;if(!c&&e){H.insert(a,1,this._pageTab);}else{if(c&&!e){H.removeIndices(a,Z,1);if(d.selectedLinkType===N.LINK_PAGE){d.set("selectedLinkType",N.URL);}}}},W=function W(){var l=mstrmojo.all[this.hostId],c=l.node.data.navpage,j=Y(this.docModel),e=this.tabgroup,d=e.tabstrip,k=e.tabstack;U.call(this,k,j);d.clearButtons();d.ontargetChange();var a=k.linkText,f=k&&k.rwSelector,Z=k.pageSelector,h=Z&&Z.text,g=this.openNewWin,m=G(l);B=I(l);if(B===N.LINK_MSTR){if(mstrApp.isSingleTier){F={};m="";l.set("tooltip",m);B=N.DISABLED;}else{F={n:l.node.data.tnm,did:l.node.data.tid,t:l.node.data.ttp,st:l.node.data.tstp};}}else{if(B===N.LINK_PAGE){var b=H.filterOne(j,function(n){return n.navPage===c;});F=b?{navPage:c,n:l.node.data.navpagenm,idx:b.idx}:{};}else{F={};if(B===N.DISABLED){m="";l.set("tooltip",m);}}}k.set("selectedLinkType",B===N.DISABLED?k.selected.linkType:B);a.tooltip="";a.text.set("value",l.url||"");if(f){f.tooltip="";f.search.text.set("value",M(l));}if(h){Z.tooltip="";h.set("items",j);h.set("selectedIndex",F.idx||0);}if(g){g.check.set("checked",B===N.LINK_MSTR?l.target==="_blank":true);}this.tooltip.text.set("value",m);k.selected.tooltip=m;this.set("dirty",false);};mstrmojo.ui.editors.controls.LinkGroup=mstrmojo.declare(mstrmojo.ui.PopupWidget,[mstrmojo.vi.ui._IsValidURL],{scriptClass:"mstrmojo.ui.editors.controls.LinkGroup",dirty:false,onOpenCallback:mstrmojo.emptyFn,onCloseCallback:mstrmojo.emptyFn,init:function R(j){this._super(j);var h=[],g=this,m=mstrmojo.all[this.hostId],a=m.url||"",f=M(m),l=Y(this.docModel),b=[],Z=new mstrmojo.ui.editors.controls.TwoColumnContainer({alias:"linkText",linkType:N.URL,n:mstrmojo.desc(9922,"URL"),tooltip:"",children:[{scriptClass:"mstrmojo.Label",slot:"col1Node",text:mstrmojo.desc(9922,"URL")},{scriptClass:"mstrmojo.TextBox",slot:"col2Node",alias:"text",hint:Q,value:a||Q,onfocus:function(){if(!this.value){this.set("value",Q);}},onblur:function(){if(this.value===Q){this.set("value","");}},onkeydown:function(n){if(n.e.keyCode===13){this.blur();}},onvalueChange:function k(){var n=this,o=function(){n.set("textValid",false);n.domNode.setAttribute("title","");};if(this.hasRendered){if(g.isValidURL(this.value)){o();}else{if(this.value){this.setInvalidState(mstrmojo.desc(12068,"Invalid URL"));}else{o();}}L.call(g);}}}]}),c=new mstrmojo.ui.editors.controls.TwoColumnContainer({alias:"rwSelector",linkType:N.LINK_MSTR,n:mstrmojo.desc(2711,"File"),tooltip:"",children:[{scriptClass:"mstrmojo.Label",slot:"col1Node",text:mstrmojo.desc(2711,"File")},{scriptClass:"mstrmojo.Box",alias:"search",slot:"col2Node",cssClass:"linkDoss",children:[{scriptClass:"mstrmojo.TextBox",alias:"text",cssClass:"rwselector"+(f?"":" mstrmojo-empty"),readOnly:true,hint:mstrmojo.desc(13864,"Choose a file"),tooltip:f,value:f,onvalueChange:function(n){if(this._super){this._super(n);}X.toggleClass(this.domNode,"mstrmojo-empty",!this.value);}},S.newIconButton("","icon",function(){var p=this,o=mstrmojo.vi.ui.DatasetUnitMenuUtils,n;g.set("closeOnClick",false);o.showObjectPicker(function q(r){p.parent.text.set("value",r.n);F=r;L.call(g);},[K.DocumentDefinition,K.ReportDefinition])();n=o.getObjectPicker();if(!this._editorCloseFunction){this._editorCloseFunction=n.onClose;n.onClose=mstrmojo.func.composite([n.onClose,function(){g.set("closeOnClick",true);}]);}})]}]}),e=new mstrmojo.ui.editors.controls.TwoColumnContainer({alias:"pageSelector",linkType:N.LINK_PAGE,n:mstrmojo.desc(3687,"Page"),tooltip:"",children:[{scriptClass:"mstrmojo.Label",slot:"col1Node",text:mstrmojo.desc(15697,"Page Name")},{scriptClass:"mstrmojo.ui.Pulldown",alias:"text",slot:"col2Node",cssClass:"linkPage"+(F.idx?"":" mstrmojo-empty"),items:l,selectedIndex:F.idx||0,allowHTML:false,onSelectedItemChange:function(n){var o=(n.idx<=0);if(!o){F=n;L.call(g);}if(!this.value){this.set("value",n.n);}X.toggleClass(this.domNode,"mstrmojo-empty",o);},getPopupListConfig:function d(){var n=this.addDisposable(mstrmojo.ui.Pulldown.prototype.getPopupListConfig());n.listHooks={select:function(q,r,o){var t=r.navPage,p=g.docModel.getVizContentPanel().k;if(!t||p===t){return true;}this.parent.set("selectedIndex",o);if(this.visible&&this.closeAfterSelection){this.close();}},unselect:function(){var o=this.selectedItem,q=o&&o.navPage,p=g.docModel.getVizContentPanel().k;if(!q||p===q){return true;}}};n.getItemProps=function(q,o){var r=mstrmojo._IsList.getItemProps.call(this,q,o),t=q.navPage,p=g.docModel.getVizContentPanel().k;r.style=this.parent.itemCssText||"";if(o===0){r.addCls("hidden");}else{if(!t){r.addCls("chap");}else{if(t===p){r.addCls("curr_pg");}}}return r;};n.getItemMarkup=function(q){var r=q.navPage,p=g.docModel.getVizContentPanel().k,o="<span>"+mstrmojo.desc(15777,"(current page)")+"</span>";if(!r){return'<{@tag} class="item {@cls}" idx="{@idx}" style="{@style}" title="{@title}">{@en@n}</{@tag}>';}return'<{@tag} class="item {@cls}" idx="{@idx}" style="{@style}" title="{@title}"><div></div>{@en@n}'+(r===p?o:"")+"</{@tag}>";};return n;}}]});this._pageTab=e;h.push(Z);h.push(e);if(!mstrApp.isSingleTier){h.push(c);}b.push({scriptClass:"mstrmojo.TabContainer",alias:"tabgroup",children:[{scriptClass:"mstrmojo.TabStrip",autoHide:true,alias:"tabstrip",target:this.parent.tabstack},{scriptClass:"mstrmojo.StackContainer",slot:"stack",alias:"tabstack",cssClass:"linkGroup",selectedLinkType:N.URL,onselectedChange:function(){this.set("selectedLinkType",this.selected.linkType);if(g.tooltip){g.tooltip.text.set("value",this.selected.tooltip);}if(g.tabgroup){L.call(g);}},onselectedLinkTypeChange:function(){var n=false;switch(this.selectedLinkType){case N.DISABLED:return ;case N.URL:this.set("selected",Z);break;case N.LINK_MSTR:this.set("selected",c);n=true;break;case N.LINK_PAGE:if(this.hasRendered&&!e.hasRendered){e.render();}this.set("selected",e);break;}if(g.openNewWin){g.openNewWin.set("visible",n);}},postCreate:function(){this.set("selected",Z);},children:h}]},{scriptClass:"mstrmojo.ui.editors.controls.TwoColumnContainer",alias:"tooltip",cssClass:"linkGroup",children:[{scriptClass:"mstrmojo.Label",alias:"label",slot:"col1Node",text:mstrmojo.desc(15698,"Tooltip")},{scriptClass:"mstrmojo.TextBox",alias:"text",slot:"col2Node",valueChangeDelay:3000,value:G(m),hint:mstrmojo.desc(12070,"Hyperlink#").replace("#",""),onkeydown:function(n){if(n.e.keyCode===13){this.blur();}},onvalueChange:function k(){g.tabgroup.tabstack.selected.set("tooltip",this.value);L.call(g);}}]});if(!mstrApp.isSingleTier){b.push({scriptClass:"mstrmojo.HBox",alias:"openNewWin",cssClass:"linkNewWindow",visible:false,children:[new mstrmojo.ui.Checkbox({alias:"check",cssDisplay:"inline-block",checked:m.target==="_blank",oncheckedChange:function(){L.call(g);}}),new mstrmojo.Label({cssDisplay:"inline-block",text:mstrmojo.desc(3593,"Open in new window")})]});}b.push({scriptClass:"mstrmojo.Box",alias:"buttons",cssClass:"buttonBox",children:[{scriptClass:"mstrmojo.Box",alias:"rmvBtn",cssDisplay:"inline-block",children:[P(mstrmojo.desc(15701,"Remove Link"),function(){g.tabgroup.tabstack.set("selectedLinkType",N.DISABLED);C.call(g,true);g.close();},false,{alias:"btn",onenabledChange:function(){X.toggleClass(this.domNode,"disabled",!this.enabled);}})]},{scriptClass:"mstrmojo.Box",alias:"rtBtns",cssClass:"buttonBoxRt",cssDisplay:"inline-block",children:[P(mstrmojo.desc(118,"Save"),function(){C.call(g,true);},true,{alias:"saveBtn",cssDisplay:"inline-block",enabled:false,onenabledChange:function(){X.toggleClass(this.domNode,"disabled",!this.enabled);}}),P(mstrmojo.desc(221,"Cancel"),function(){C.call(g,false);},false,{cssDisplay:"inline-block"})]}]});this.addChildren(b);W.call(this);},onOpen:function(){W.call(this);this.buttons.rmvBtn.btn.set("enabled",B!==N.DISABLED);this.onOpenCallback();},onClose:function(){this.onCloseCallback();},oncloseOnClickChange:function(){if(this.closeOnClick&&this._zIndex!==undefined){this.domNode.parentNode.style.zIndex=this._zIndex;delete this._zIndex;this.hoverLock(false);this.lockHover();}else{if(!this.closeOnClick){this._zIndex=this.domNode.parentNode.style.zIndex;this.domNode.parentNode.style.zIndex="1";this.unlockHover();this.hoverLock(true);}}},ondirtyChange:function(){this.buttons.rtBtns.saveBtn.set("enabled",this.dirty);},destroy:function V(Z){this._pageTab.destroy();if(this._super){this._super(Z);}}});}());(function(){mstrmojo.requiresCls("mstrmojo.hash","mstrmojo.Obj","mstrmojo.ui.ButtonBar","mstrmojo.ui.Checkbox","mstrmojo.Label","mstrmojo.ui.Pulldown","mstrmojo.ui.editors.controls.TwoColumnContainer","mstrmojo.ui.editors.controls.ThreeColumnContainer");var D=mstrmojo.hash;mstrmojo.vi.models.editors.ControlsViewFactory=mstrmojo.declare(mstrmojo.Obj,null,{scriptClass:"mstrmojo.vi.models.editors.ControlsViewFactory",getEditorGroup:function B(H,I){return new mstrmojo.vi.ui.editors.EditorGroup(D.copy(I,{children:H}));},getLabelAndControl:function G(J,K,M,O,L,N){var P=new mstrmojo.Label({text:J,setDimensions:function(S,Q){var R=this.domNode;if(R){R.style.width=Q;}}}),I=P,H=K;if(L){I=K;H=P;}I.slot="col1Node";H.slot="col2Node";return new mstrmojo.ui.editors.controls.TwoColumnContainer(D.copy(N,{col1Width:M||"40%",col2Width:O||"60%",children:[I,H],getLabel:function(){return P;},getCtrl:function(){return this.children.filter(function(Q){return Q!==P;})[0];}}));},getLabelAndControlWithMsg:function C(L,M,P,O,S,H,N,Q){var R=new mstrmojo.Label({text:L,setDimensions:function(X,V){var W=this.domNode;if(W){W.style.width=V;}}}),U=new mstrmojo.Label({text:P?mstrmojo.desc(14548,"Changes will be applied after Desktop is restarted."):"",setDimensions:function(X,V){var W=this.domNode;if(W){W.style.width=V;}},setText:function(V){this.text=V;}}),K=R,J=M,I=U;if(N){K=M;J=R;}K.slot="col1Node";J.slot="col2Node";I.slot="col3Node";return new mstrmojo.ui.editors.controls.ThreeColumnContainer(D.copy(Q,{col1Width:O||"30%",col2Width:S||"30%",col3Width:H||"40%",children:[K,J,I],getLabel:function(){return R;},getCtrl:function(){return this.children.filter(function(V){return V!==R;})[0];},getMessage:function(){return U;}}));},getPulldown:function F(I,L,H,K,J){return mstrmojo.ui.Pulldown.newPulldown(I,function(M,N){L.call(this,M.v,N&&N.v);},H,K,J);},getCheckboxAndLabel:function A(N,L,K){var J=new mstrmojo.ui.Checkbox({checked:N,oncheckedChange:function(){var O=this.checked;K.call(this,O,!O);}});var M=this.getLabelAndControl(L,J,"14px","100%",true);M.cssClass="checkLabel";var I=M.getLabel();I.onclick=function H(){J.onclick();};I.cssDisplay="inline-block";return M;},getButtonBar:function E(J,H,L,K){K=K||{};K.items=J;var I=new mstrmojo.ui.ButtonBar(K);I.singleSelect(H);I.postselectionChange=function(M){var N=this.items,O=N[M.removed&&M.removed[0]];L.call(this,N[M.added[0]],O);};return I;}});}());(function(){mstrmojo.requiresCls("mstrmojo.array","mstrmojo.css","mstrmojo.dom","mstrmojo.hash","mstrmojo._HasEditableText","mstrmojo.ui.Pulldown");var K=mstrmojo.array,H=mstrmojo.dom,D=mstrmojo.hash,A=mstrmojo.Enum_Keys,C=19,M=A.ENTER,E=A.ESCAPE,N=A.DOWN_ARROW,F=A.UP_ARROW;mstrmojo.ui.SearchablePulldown=mstrmojo.declare(mstrmojo.ui.Pulldown,[mstrmojo._HasEditableText],{scriptClass:"mstrmojo.ui.SearchablePulldown",editableSlot:"selectedNode",allowCustomText:false,isSearching:false,editOnClick:false,init:function P(V){this._super(V);var Q=this.getPopupList();Q.renderOnScroll=this.renderOnScroll||Q.renderOnScroll;Q.renderBlockSize=this.renderBlockSize||Q.renderBlockSize;var U=[];if((mstrApp.isWorkstation&&H.isMac())||H.isSafari){U=["clip-safari"];}mstrmojo.css.addWidgetCssClass(this,["mstrmojo-ui-SearchablePulldown"].concat(U));var S=Q.constructor.prototype,R=Q.getItemProps||S.getItemProps,W=Q.getItemMarkup||S.getItemMarkup;Q.getItemProps=function(b,Y){var Z=this._spft||"",d=b.n,a=d?d.toUpperCase().indexOf(Z):-1,X=function(f){var e=[],g;K.forEach(f.split(";"),function(h){g=h.split(":");if(g.length===2&&g[0].toLowerCase()!=="color"){e.push(h);}});return e.join(";");};if(a===-1){Z="";}var c=R.call(this,b,Y);if(this.selectedIndices[Y]){c.style=X(c.style);}if(d){c.before=d.slice(0,a);c.input=d.substring(a,a+Z.length);c.after=d.slice(a+Z.length,d.length);}return c;};Q.getItemMarkup=function(Z,X){var Y=W.call(this,Z,X);if(Z.n&&Z.v!=="u;"){return Y.replace("{@en@n}","{@en@before}<span class='sp-highlight'>{@en@input}</span>{@en@after}");}return Y;};this._originalFocusOnPopup=this.focusOnPopup;this.focusOnPopup=false;},onclick:function O(Q){if(this._originalFocusOnPopup!==undefined){this.focusOnPopup=false;}if(this.isClickingAnchorSlot(Q)){var S=Q.e.offsetX>=(this.selectedNode.offsetWidth-C),R=this.getPopupWidget().visible;if(!R||(R&&S)){this.set("isEditing",!R);this._super(Q);}else{if(!this.isEditing){this.set("isEditing",true);}}}},setDefaultListAndIndex:function(V,W){var U=this.getPopupList(),R=this.text,Q=K.find(V,"n",R);if(Q===-1&&!this.allowCustomText){var S=U.items[0]||V[0];Q=K.find(V,"n",S.n);}U.set("items",V);if(W){this.set("selectedIndex",Q);}},onPopupWidgetClosed:function I(Q){this.set("isEditing",false);var R=this.getPopupList(),S=R._oldItems;delete R._oldItems;if(S){this.setDefaultListAndIndex(S,Q&&Q.pressingEnter);}},_set_selectedIndex:function G(S,Q){if(this.allowCustomText&&Q===-1){this.selectedIndex=-1;this.onitemSelected(null,Q);}else{this.isSearching=false;this._super(S,Q,true);if(this.hasRendered){var R=this.selectedNode;this.text=R.innerText||R.textContent;}}return true;},onkeydown:function J(S){this._super(S);var R=window.event||S.e,U=R.keyCode,Q=this.getPopupWidget();if(U===M){Q.close({pressingEnter:true});}else{if(this._originalFocusOnPopup&&(U===N||U===F)){this.focusOnPopup=true;if(Q.focus){Q.focus();}Q.raiseEvent(S);}}},onkeyup:function B(S){var Q=window.event||S.e,U=Q.keyCode,R=this.getPopupWidget();this._super(S);if(U===E||U===M){R.close();}else{if(U!==N&&U!==F){this.processSearch();}}},processSearch:function L(){this.isSearching=true;this.hideTooltip();var Q=[],S=this.getPopupList(),V=this.selectedNode.innerHTML,W=S._oldItems||S.items,R=V.toUpperCase(),U;R=R.replace(/<BR>/,"");if(R.length>0){K.forEach(W,function(X){U=X.n;if(U&&U.toUpperCase().indexOf(R)>-1){Q.push(D.clone(X));}},this);}else{Q=W;}S._spft=R;if(this.customizeSearchResult){this.customizeSearchResult(Q);}S.set("items",Q);if(S.adjustCornersForPopupOverflow){S.adjustCornersForPopupOverflow();}delete S._spft;S._oldItems=W;S.set("visible",S.items.length!==0);}});}());(function(){mstrmojo.requiresCls("mstrmojo.array","mstrmojo.css","mstrmojo.dom","mstrmojo.hash","mstrmojo._FillsBrowser","mstrmojo.Container","mstrmojo.EnumRWUnitType","mstrmojo.Label","mstrmojo.ui.PopupButton","mstrmojo.ui.Pulldown","mstrmojo.vi.ui.TargetSelector","mstrmojo.vi.ui.TruncatedList");var b=mstrmojo.hash,U=mstrmojo.array,j=mstrmojo.css,J=mstrmojo.dom,a=mstrmojo.Button.newWebButton,h=mstrmojo.EnumRWUnitType,k=null,E=function(l){var m=this.vis.model,o=l.panelKey,n=this.currentPanelKey||m.getVizContentPanel().k;if(o===n){return ;}if(this.targetContainer.getTargetChildren().length===0){this.goToPage(l);return ;}this._tocNavWarn(l);},M=function(){var l=mstrApp.rootCtrl,u=l.view,o=l.toggleViewBar,t=l.tocPanel,p=l.galleryPanel,m=l.datasetsPanel,q=this.vis.model,v=[],r,n;r=[o,m,p];this.isCPVisible=n=u.isCPVisible;U.forEach(r,function(w){v.push(w&&w.getOpenStatus());});this.panelsIsOpen=v;this.panels=r;if(this.tocEnabled){if(!n){u.setIsCPVisible(true,true);}this.isTocNav=t.visible;t.set("isMasked",false);this.setNavIcon(true,true);}if(q.attachEventListener){this.layoutSelectedSubscription=q.attachEventListener("targetLayoutSelected",this.id,E.bind(this));}},F=function(){var o=this.vis.model,m=mstrApp.rootCtrl.view,n=this.panelsIsOpen,l=this.isCPVisible;U.forEach(this.panels,function(p,q){p.setOpenStatus(n[q],true,undefined,false);});if(this.tocEnabled){if(!l){m.setIsCPVisible(l,true);}this.setNavIcon(false,true);}if(o.detachEventListener){o.detachEventListener(this.layoutSelectedSubscription);}},Z=function(v){var w=v.length,m=this.targetContainer.getTargetChildren(),p=m.map(function(x){return x.key;}).sort(U.stringSorter),r=p.length,l,n,t,q,u,o=[];if(w>r){l=r;n=v;q=true;}else{l=w;n=p;q=false;}for(t=0;t<l;t++){if(v[t]!==p[t]){this.targetContainer.addAndRemoveKeys([this.targetKeys[n[t]]],q);return ;}}for(t;t<n.length;t++){u=this.targetKeys[n[t]];if(u){o.push(u);}}if(o.length){this.targetContainer.addAndRemoveKeys(o,q);}},S=function(l){var m=l.getVizContentPanel()._tgtSelections;if(m){m.notify();}},e=function(l){if(this.options){this.csl.set("enabled",l);this.options.set("enabled",l);}};function W(){var l=this.vis.model,n=this.vis.k,m;if(!this.targetSelector){this.targetSelector=this._createTargetSelector();}else{this.targetSelector.set("hostId",this.id);if(!mstrmojo.all[this.vis.id]){m=l.getLayoutKeyByUnitKey(n);if(m===l.getCurrentLayoutKey()){this.targetSelector.setSourceByKey(n);}}}this.showControlOverlay([this.targetSelector]);this.targetSelector.enterSelectMode();}function D(){var n,o=this.sc,l=o&&o.isNavigation&&o.navPage,m=this.options;if(this.vis.model.getVizContentPanel().children){if(m){m.closeDialog();}delete this.children;this.refresh();if(!l||l===this.currentPanelKey){n=b.valarray(this.targetKeys).filter(function(p){return p.v;}).map(function(p){return p.k;}).sort(U.stringSorter);if(n.length){Z.call(this,n);}}}}function V(m){var l=m.boxContent,u=l.isVisMap,r=u?l.getWidgetForTemplateSelection().node.defn:m.defn,n=l.model,o=(this.srcPanelKey===m.model.getVizContentPanel().k),t,q,p;this.cgbs=p=(n&&n.getSelectorControlMapInfo?n.getSelectorControlMapInfo():[]);if(p.length>0){t=p[0].sc;this.unitId=p[0].did;this.singleUnit=true;}else{q=r.an;t=l.selectorControl||(n&&l.findSelectorControl&&l.findSelectorControl());this.singleUnit=false;}this.cachedFiltertypeIndex=(!!q&&q.length>0)&&!this.singleUnit&&!t?1:0;if(k===null){k=o&&(t?t.showall:true);}this.sc=t;this.an=q;}mstrmojo.vi.ui.InlineDialogBase=mstrmojo.declare(mstrmojo.Container,[mstrmojo._FillsBrowser],{scriptClass:"mstrmojo.vi.ui.InlineDialogBase",cssClass:"mstrmojo-inline-dialog",title:mstrmojo.desc(12136,"Filtering options"),targetKeys:null,vis:null,buttons:null,origTargetKeys:[],changes:{},sc:null,singleUnit:null,cgbs:null,unitId:null,an:null,panelsIsOpen:null,panels:null,isCPVisible:null,srcPanelKey:null,shouldNavigate:true,cachedFiltertypeIndex:0,numBoxesChecked:0,optionsStateForRefresh:{openOnRefresh:false,showAll:false},layoutSelectedSubscription:null,tocEnabled:true,isTocNav:false,isOnTocChange:false,selectFilters:false,targetSelector:null,markupString:'<div id="{@id}" class="mstrmojo-Dialog-Bar {@cssClass}" tabindex="0" mstrAttach:click><div class="win mstrmojo-bar"><div class="mstrmojo-bar-content"></div><div class="mstrmojo-bar-buttons"></div></div></div>',markupSlots:{editorNode:function(){return this.domNode.firstChild;},containerNode:function(){return this.domNode.firstChild.childNodes[0];},buttonNode:function(){return this.domNode.firstChild.lastChild;}},init:function c(m){if(this._super){this._super(m);}this.srcPanelKey=this.vis.parent.k;var l=this.vis.model;if(l.attachEventListener){l.attachEventListener("buildBoxLayoutComplete",this.id,this.buildBoxLayoutComplete);}},buildBoxLayoutComplete:function O(){var l=this.vis.model;if(this.tocEnabled&&!this.isTocNav){this.setNavIcon(true,true);}D.call(this);if(this.isOnTocChange){var n=l.getVizContentPanel()._tgtSelections,m=b.valarray(this.targetKeys).filter(function(o){return o.v;}).map(function(o){return o.k;});if(n){U.forEach(m,function(o){l.getUnitInstance(o,1).parent.toggleBoxSelection(true);if(!n.toggleSelection(o)){n.toggleSelection(o);}});this.isOnTocChange=false;}}S(l);},_createTargetSelector:function B(){return new mstrmojo.vi.ui.TargetSelector({alias:"targetSelector",orientation:"h",hostId:this.id,srcId:this.vis.id});},_createOptionsButton:function R(){var o=this,q=o.vis,m=q.model,n=(this.srcPanelKey===(this.currentPanelKey||m.getVizContentPanel().k));return{scriptClass:"mstrmojo.ui.PopupButton",alias:"options",cssDisplay:"inline-block",isHostedWithin:false,anchorSlot:"btnNode",markupString:'<div id="{@id}" class="mstrmojo-ui-OptionsButton {@cssClass}" style="{@cssText}"><div class="opts" mstrAttach:click></div></div>',markupSlots:{btnNode:function(){return this.domNode.firstChild;}},markupMethods:{onvisibleChange:mstrmojo.Widget.visibleMarkupMethod},onRender:function(){if(this._super){this._super();}j.toggleClass(this.domNode,"disabled",!this.enabled);},onenabledChange:function(){j.toggleClass(this.domNode,"disabled",!this.enabled);},getPopupWidget:function p(){return this.optionEditor;},getPopupConfig:function l(){var t=mstrmojo.ui.PopupConfig.ENUM_CORNERS,r=this.constructor.prototype.getPopupConfig.call(this);r.alignment={host:t.BOTTOM_RIGHT,popup:t.TOP_RIGHT};return r;},openDialog:function(){var t=o.optionsStateForRefresh,r=this.optionEditor;if(t.openOnRefresh){t.openOnRefresh=false;r.clrSel.set("checked",t.showAll);r.open();}},closeDialog:function(){var t=o.optionsStateForRefresh,r=this.optionEditor;if(r.visible){t.openOnRefresh=true;t.showAll=r.clrSel.checked;r.close();}},children:[{scriptClass:"mstrmojo.ui.PopupWidget",alias:"optionEditor",visible:false,onClose:function(){this.clrSel.set("checked",k);this.buttons.enableApply(false);},handleSelectionSubmit:function(r){var t=o.changes;if(r){if(t.clearAll!==undefined){delete t.clearAll;}else{t.clearAll=o.csl.checked;}k=o.csl.checked;S(m);}this.close();},children:[{scriptClass:"mstrmojo.CheckBox",cssClass:"mstrmojo-clear-check",cssDisplay:"inline-block",alias:"clrSel",enabled:false,checked:k,label:mstrmojo.desc(11957,"Allow users to clear all selections"),onenabledChange:function(){if(!n){this.enabled=false;this.set("checked",false);}else{if(!o.filterType.isFilter){this.set("checked",true);}else{this.set("checked",k);}}},oncheckedChange:function(){var r=this.parent;if(r){r.buttons.enableApply(this.enabled&&this.checked!==k);}}},{scriptClass:"mstrmojo.Box",alias:"buttons",cssClass:"buttonBox",children:[a(mstrmojo.desc(8473,"Done"),function(){var r=this.parent.parent;r.handleSelectionSubmit(true);},true,{cssDisplay:"inline-block",enabled:false}),a(mstrmojo.desc(221,"Cancel"),function(){var r=this.parent.parent;r.handleSelectionSubmit(false);},false,{cssDisplay:"inline-block"})],enableApply:function(r){this.children[0].set("enabled",r);}}]}]};},validT:function d(m){if(m){var l=m.t;if(this.selectFilters){return Math.round(l/10)===52||l===h.SELECTOR||l===h.MOJOVISUALIZATION;}else{return Math.round(l/10)===52||l===h.MOJOVISUALIZATION;}}return false;},setNavIcon:function I(o,r){var v=this.vis,p=v.model,u=p.getVizContentPanel().parent.selector,t=p.controller.view,m=t.layoutViewer.docLayout.selector,l=mstrApp.rootCtrl,q=l.tocPanel,n=v.k;if(this.isTocNav){q.setTOCIcon(o,r);}else{if(r||!o){m.setLinkIcon(o,r?p.getLayoutKeyByUnitKey(n):null);}u.setLinkIcon(o,r&&v.defn.pnk);}},getTargetKeys:function(){var l=[];b.forEach(this.targetKeys,function(n,m){if(n.v){l.push(m);}});l.sort(U.stringSorter);return this.origTargetKeys=l;},setTargets:function(w){var p=this.targetKeys,m=this.vis,o=m.model,n=this.currentPanelKey||o.getVizContentPanel().k,q=[],v=this.changes,r=this.singleUnit,t=this.srcPanelKey,l=this.filterType;w=o.updateFilterTargetsForSdp(w);U.forEach(this.an,function(x){if(!p[x.k]){p[x.k]={c:false,v:true};}});b.forEach(p,function(z,x){if(U.some(w,function(AA){return AA===x;})){q.push(x);if(!z.v){z.v=true;z.c=true;}}else{if(z.v){z.v=false;z.c=true;}}});v.filterKeys=q;v.targetKeys=p;v.singleUnit=r;if(r){v.unitId=this.unitId;}if(t!==n){v.isNav=true;v.navPage=n;v.srcKey=t;}v.sc=this.sc;v.isFilter=l&&l.isFilter;var u=mstrmojo.vi.VisualInsightApp.APP_STATES;mstrApp.set("appState",mstrApp.isAppStatePause()?(u.PAUSE|u.SELECTOR_TARGETING):u.SELECTOR_TARGETING);this._setTargetsFunc();},_setTargetsFunc:mstrmojo.emptyFn,isSelectionDirty:function A(o){var m=false,l=o.length,p=this.origTargetKeys,n=this.changes;o.sort(U.stringSorter);Z.call(this,o);if(l===p.length){U.forEach(o,function(r,q){if(r!==p[q]){m=true;return false;}});if(m){return m;}if(l>0){if(this.cachedFiltertypeIndex!==this.filterType.selectedIndex){return true;}if(n.isLayerChanged){return true;}if(n.clearAll!==undefined){return true;}}return false;}return true;},goToPage:function Q(l){var m=this.vis.model,n=l.layoutKey,o=l.panelKey;m.raiseEvent({name:"layoutSelected",panelKey:o,layoutKey:n});},_tocNavWarn:mstrmojo.emptyFn,onTocPageChange:function(n){var m,l;if(this._super){this._super(n);}if(this.visible){if(this.srcPanelKey===this.currentPanelKey){m=this.vis.model.getVizContentPanel().children;if(m){l=U.find(m,"k",this.vis.k);if(l!==-1){this.vis=m[l];}}else{return ;}}this.setNavIcon();if(!this.isTocNav){this.setNavIcon(true,true);}this.isOnTocChange=true;D.call(this);}},open:function K(){var l=this.vis;this.shouldNavigate=false;W.call(this);M.call(this);if(l.setSelectTargetsState){l.setSelectTargetsState(false);}},close:function X(){var m=this.vis;mstrApp.rootCtrl.view.closeInlineDialog();F.call(this);this.targetContainer.addAndRemoveKeys(this.targetContainer.getTargetChildren());var l=mstrmojo.vi.VisualInsightApp.APP_STATES;mstrApp.set("appState",mstrApp.isAppStatePause()?l.PAUSE:l.DEFAULT);k=null;if(m.setSelectTargetsState){m.setSelectTargetsState(true);}},cancel:function P(){var l=this.vis.model,n=l.getLayoutKeyByUnitKey(this.vis.k);var m=mstrmojo.vi.VisualInsightApp.APP_STATES;mstrApp.set("appState",mstrApp.isAppStatePause()?(m.PAUSE|m.SELECTOR_TARGETING):m.SELECTOR_TARGETING);l.raiseEvent({name:"layoutSelected",panelKey:this.srcPanelKey,layoutKey:n});},onwidthChange:function(){if(this.editorNode){this.editorNode.style.width=this.width;}},updateViz:function N(l){this.vis=l;this.srcPanelKey=this.vis.parent.k;this.targetSelector.set("srcId",this.vis.id);this.shouldNavigate=true;D.call(this);this.shouldNavigate=false;},toggleFields:function g(){var m=this.filterType,l=this.cgbs;if(l.length!==0){this.forType.set("visible",true);}if(this.sc){e.call(this,true);}if(this.srcPanelKey===(this.currentPanelKey||this.vis.model.getVizContentPanel().k)&&(b.keyarray(this.targetKeys).length>0||l.length!==0)){m.set("enabled",true);}else{m.set("enabled",false);m.set("selectedIndex",0);}},_createTruncatedList:function H(){var l=this;return{scriptClass:"mstrmojo.vi.ui.TruncatedList",alias:"targetContainer",cssDisplay:"inline-block",items:[{alias:"defaultItem",cls:"tgtDefault",n:mstrmojo.desc(15090,"Please click on visualizations to select targets"),key:"-1"}],padding:12,overflowCls:"truncMore",cmCssClass:"mstrmojo-bar-overflow",setWidth:function m(){var q=this.parent,o=this.id,r,t=this.padding,p=parseInt(q.width,10);if(!this.width&&J.position(q.buttonNode).w){U.forEach(q.children,function(u){r=u.domNode;if(r&&u.id!==o){p-=Math.ceil(J.position(r).w+(u.scriptClass==="mstrmojo.ui.Pulldown"||u.alias==="ctrlOverlay"?0:t));}});if(J.isMac()&&(J.isSafari||mstrApp.isWorkstation)){p-=t;}this.width=p+"px";}this.domNode.style.width=this.width;},getAdditionalProperties:function n(p,o){if(o===0&&this.items.length>2){p.addCls("hide");}return p;},updateFields:function(){var p,o=l.filterType&&l.filterType.isFilter;l.numBoxesChecked=this.items.length-1;p=l.numBoxesChecked>0;l.forType.set("enabled",p&&o);e.call(l,p&&o);},getTargetChildren:function(){return this.items.slice(1);},addAndRemoveKeys:function(r,p){var o,t=false,q=this.items;if(p){t=true;U.forEach(r,function(u){if(!u.mp||u.mp===u.k){q.push({n:u.t,cls:"tgtItem",cssClass:"tgtItem",key:u.k});}});}else{U.forEach(r,function(u){o=u?U.find(q,"key",u.k||u.key):-1;if(o>-1){t=true;q.splice(o,1);}});}if(t){this.refresh();this.updateFields();l.setNavIcon(q.length!==1);}}};},_addVis:function Y(m,n){var v=this,l=v.vis,o=m.boxContent,w=o.isVisMap,t=v.cgbs||[],u=v.an,z,r,q,p;if(u){z=mstrmojo.array.find(u,"k",m.k)!==-1;}else{if(t.length>0){if(t[0]&&t[0].sc&&t[0].sc.tks){z=t[0].sc.tks.indexOf(m.k)>-1;}}}v.numBoxesChecked+=z?1:0;if(m!==l&&v.validT(m.defn)){var x=m.defn.t===h.SELECTOR;if(!x){r=o.getFilterType();q=o.model.getSelectorControlMapInfo();}if(w){p=o.getAllLayerKeys(true);U.forEach(p,function(AA){n[AA]={c:false,v:z,ft:r,cgbs:q,t:m.title,k:AA,mp:m.k};});}else{n[m.k]={c:false,v:z,ft:r,cgbs:q,t:m.title,k:m.k};}}},_addChildren:function L(){var AA=this,n=AA.vis,w=n.model,p={scriptClass:"mstrmojo.ui.Pulldown",cssClass:"mstrmojo-filter-type",cssDisplay:"inline-block",alias:"filterType",selectedIndex:AA.filterType?AA.filterType.selectedIndex:this.cachedFiltertypeIndex,isHostedWithin:true,isFilter:true,enabled:false,items:[{n:mstrmojo.desc(8689,"Filter"),v:true},{n:mstrmojo.desc(11953,"Highlight"),v:false}],onitemSelected:function(AD){this.isFilter=AD.v;e.call(AA,AA.numBoxesChecked>0&&this.isFilter);AA.forType.set("enabled",this.isFilter);if(this.enabled){S(w);}},onenabledChange:function(){j.toggleClass(this.domNode,"disabled",!this.enabled);}},q=[{scriptClass:"mstrmojo.Label",cssClass:"mstrmojo-title-label",cssDisplay:"inline",allowHTML:true,text:mstrmojo.desc(15031,"Use visualization <span>#</span> to").replace("#",n.title),visible:true},p,{scriptClass:"mstrmojo.Label",cssClass:"mstrmojo-type-label",cssDisplay:"inline-block",text:mstrmojo.desc(15032,"data on selection in"),visible:true},AA._createTruncatedList(),{scriptClass:"mstrmojo.ui.Pulldown",cssClass:"mstrmojo-for-type",cssDisplay:"inline-block",alias:"forType",value:0,visible:false,selectedIndex:0,isHostedWithin:true,enabled:false,items:[{n:mstrmojo.desc(11955,"for #").replace("#",(this.cgbs[0]||{}).n),v:false},{n:mstrmojo.desc(11956,"for All Data"),v:true}],onitemSelected:function(AD){AA.changes.forAllData=AD.v;},onenabledChange:function(){j.toggleClass(this.domNode,"disabled",!this.enabled);}},AA._createOptionsButton()],l=w.getPanel(this.currentPanelKey,this.currentLayoutKey).children||[],v,t={};for(v=l.length-1;v>=0;v--){AA._addVis(l[v],t);}var r=n.boxContent,AB=r&&r.mapViewer&&r.isVisMap;if(AB){var u=n.title,AC="Use % of <span>#</span> to % the following targets:",x=mstrmojo.desc(15162,AC),m=x.split("%")||[],o,z=U.map(r.getGraphicLayerNameArr(),function(AD){return{n:AD.n,v:AD.k};});if(m.length!==3){m=AC.split("%");}o=[{scriptClass:"mstrmojo.Label",cssClass:"mstrmojo-title-label",cssDisplay:"inline",allowHTML:true,text:m[0].replace("#",u),visible:true},{scriptClass:"mstrmojo.ui.Pulldown",cssClass:"",cssDisplay:"inline-block",alias:"sourceLayer",selectedIndex:U.find(z,"v",r.getKeyForTemplateSelection()),isHostedWithin:true,enabled:true,items:z,onitemSelected:function(AE){var AD=AA.changes;AD.layerKey=AE.v;AD.isLayerChanged=AE.v!==r.getKeyForTemplateSelection();S(w);}},{scriptClass:"mstrmojo.Label",cssClass:"mstrmojo-title-label",cssDisplay:"inline",allowHTML:true,text:m[1].replace("#",u),visible:true},p,{scriptClass:"mstrmojo.Label",cssClass:"mstrmojo-title-label",cssDisplay:"inline",allowHTML:true,text:m[2].replace("#",u),visible:true}];q.splice(0,3);q=o.concat(q);}this.addChildren(q);this.targetKeys=t;this.csl=this.options.optionEditor.clrSel;},preBuildRendering:function C(){var o=this,p=o.vis,l=p.model,q,n,m,r;V.call(this,p);q=this.sc;n=this.an;if(this.shouldNavigate&&n&&n.length){m=l.getLayoutKeyByUnitKey(n[0].k);r=q&&q.isNavigation&&q.navPage;if(r&&r!==this.currentPanelKey){this.shouldNavigate=false;l.raiseEvent({name:"layoutSelected",panelKey:r,layoutKey:m});}}this._addChildren();this.addChildren([{scriptClass:"mstrmojo.Box",cssClass:"ctrlOverlay",alias:"ctrlOverlay",slot:"buttonNode"}]);this.toggleFields();this._super();},postBuildRendering:function f(){var l=this.targetContainer,m=this.sc;this.editorNode.style.width=this.width;this._super();this.changes={};if(k!==(m?m.showall:true)){this.changes.clearAll=k;S(this.vis.model);}W.call(this);if(l&&!l.width){l.setWidth();}if(this.options){this.options.openDialog();}},showControlOverlay:function G(n,m){var o=this.ctrlOverlay,q=o.domNode;function p(r){var t=r.children;if(t&&t.length){r.removeChildren();t.forEach(function(u){u.destroy();});}}if(q){var l=["ctrlOverlay","or-h"];if(m){l.push(m);}q.className=l.join(" ");}o.set("visible",true);p(o);o.addChildren(n);j.addClass(this.domNode,"overlay");}});}());(function(){mstrmojo.requiresCls("mstrmojo.Container","mstrmojo.ListBase","mstrmojo._IsList","mstrmojo.ui._HasScroller","mstrmojo.ui.menus.MenuConfig","mstrmojo.ui.menus.EditorConfig","mstrmojo.ui.menus._HasMenuPopup","mstrmojo.gm.GMEnums");var Z=mstrmojo.Widget,b=mstrmojo.css,N=mstrmojo.array,Y=mstrmojo.num,U=mstrmojo.hash,a=mstrmojo.expr.DTP,d=mstrmojo.gm.EnumRefLineModelType,D=mstrmojo.gm.WidgetPropertyTag;var c;var K=["Reserved",mstrmojo.desc(2125,"Maximum"),mstrmojo.desc(2127,"Minimum"),mstrmojo.desc(2122,"Average"),mstrmojo.desc(2126,"Median"),mstrmojo.desc(4046,"First"),mstrmojo.desc(4049,"Last"),mstrmojo.desc(7194,"Constant")];function Q(o,p,h){var l=mstrmojo.dom.position(p),g=l.x,n=l.x+l.w,m=l.y,f=l.y+l.h,k=o.pageX,j=o.pageY;if(h){g+=1;n-=1;m+=1;f-=1;}return k>=g&&k<=n&&j>=m&&j<=f;}mstrmojo.ui.editors.controls.GMReferenceLineItemContainer=mstrmojo.declare(mstrmojo.ListBase,[mstrmojo._IsList,mstrmojo.ui._HasScroller],{scriptClass:"mstrmojo.ui.editors.controls.GMReferenceLineItemContainer",cssClass:"GMReferenceLineItemContainer",icnCss:"GMReferenceLineItemContainer-container",setupScrollNodes:function L(){this.scrollNode=this.itemsContainerNode;},getItemMarkup:function C(f){if(!c){c=this._super(f).replace(">{@en@n}<",'><span class="txt" title="{@en@n}">{@en@n}</span><span class="rmv hidden" rmv></span><');}return c;},onclick:function e(f){try{var j=f.getTarget(),h=this.getItemFromTarget(j);if(h){f.cancel();if(j.hasAttribute("rmv")){this.doItemRemove(h);}else{this.doItemSelect(h,f||{});}}}catch(g){mstrApp.onerror(g);}},onmouseover:function F(f){try{var j=f.getTarget(),g=j.className;if(g==="txt"||g==="rmv"){j=j.parentNode;}if(Q(f.e,j,false)){b.removeClass(j.children[1],"hidden");}}catch(h){mstrApp.onerror(h);}},onmouseout:function E(f){try{var j=f.getTarget(),g=j.className;if(g==="txt"||g==="rmv"){j=j.parentNode;}if(!Q(f.e,j,true)){b.addClass(j.children[1],"hidden");}}catch(h){mstrApp.onerror(h);}},doItemRemove:function I(g){var f=this.items.slice();N.removeItem(f,g);this.set("items",f);this.onremoveItem(g);},onremoveItem:function A(f){}});function R(){return{scriptClass:"mstrmojo.ui.editors.controls.GMReferenceLineItemContainer",items:[],alias:"refLnList",getItemDisplayName:function(g){var f=K[g.refType]||"";if(g.refType===d.CONST){if(!!g.lin){f=g.lin;}else{if(g.c!==undefined){f+=(" "+Y.toLocaleString(g.c));}}}return f;},postselectionChange:function(){this.parent.onselectRefLine(this.selectedItem);},ondblclick:function(f){var g=this,j=f.getTarget(),h=g.selectedItem;if(h.refType===d.CONST){j.contentEditable=true;j.onkeydown=function(k){if(k.keyCode===13){this.contentEditable=false;if(this.title!==this.textContent){this.title=this.textContent;h[D.REF_LINE_NAME]=this.title;g.parent.onrenameRefLine(h);}return false;}};j.onblur=function(k){if(this.contentEditable&&this.title!==this.textContent){this.contentEditable=false;this.title=this.textContent;h[D.REF_LINE_NAME]=this.title;g.parent.onrenameRefLine(h);}};}},onremoveItem:function(f){this.parent.onremoveRefLine(f);}};}function G(){function g(n){var o=this.refLnList.items;return(this.restrictedTypes||[]).indexOf(n)===-1&&(n===d.CONST||N.find(o,"refType",n)===-1);}function m(n,o){var p=this.generateNewRefLineItem(n,o);this.refLnList.addItems(p);this.onaddRefLine(p);}var f="propEditor-Menu",k=mstrApp.getThemeClassName(),h=this,l=new mstrmojo.ui.menus.MenuConfig({menuCssClass:f,hostId:h.id,hostElement:h.containerNode,isHostedWithin:false});var j=U.valarray(d);(j.slice(0,-1)).forEach(function(n){if(!g.call(h,n)){return ;}l.addMenuItem(K[n],"",function(){if(h.manager&&h.manager.host){h.manager.host.checkCustomScaleNotificationForReferenceLine(h.metricOpt.key);}m.call(h,n);});});l.addPopupMenuItem(K[7],h.id,function(){return new mstrmojo.ui.menus.EditorConfig({cssClass:f+" "+k,data:{constantValid:false},contents:[{scriptClass:"mstrmojo.ValidationTextBox",alias:"constVal",cssClass:"reference-line-constant",dtp:a.FLOAT,required:true,valueChangeDelay:1000,constraints:{trigger:mstrmojo.validation.TRIGGER.NONE},onEnter:function(){this.blur();},onvalueChange:function(){this.validate();},onValid:function(){this.parent.data.set("constantValid",true);},onInvalid:function(){this.parent.data.set("constantValid",false);}}],bindings:{okEnabled:"this.data.constantValid"},fnOk:function(o,n){var p=n.constVal;if(p.isValid()){if(h.manager&&h.manager.host){h.manager.host.checkCustomScaleNotificationForReferenceLine(h.metricOpt.key);}m.call(h,d.CONST,p.value);}}});},"",h);h.openPopup(new mstrmojo.ui.menus.Menu({popupConfig:l,themeClassName:k}));}function H(){return{scriptClass:"mstrmojo.Label",text:mstrmojo.desc(531,"Add"),alias:"addBtn",cssClass:"link-btn",onclick:function(){G.call(this.parent);}};}mstrmojo.ui.editors.controls.GMReferenceLineList=mstrmojo.declare(mstrmojo.Container,[mstrmojo.ui.menus._HasMenuPopup],{scriptClass:"mstrmojo.ui.editors.controls.GMReferenceLineList",markupString:'<div id="{@id}" class="mstrmojo-ui-GMReferenceLineList {@cssClass}" style="{@cssText}"></div>',markupSlots:{containerNode:function(){return this.domNode;}},markupMethods:{onvisibleChange:Z.visibleMarkupMethod,onenabledChange:mstrmojo.Container.enabledMarkupMethod,onheightChange:Z.heightMarkupMethod,onwidthChange:Z.widthMarkupMethod},restrictedTypes:undefined,items:undefined,shouldPropagateEnabled:true,children:[R(),H()],init:function W(f){this._super(U.copy(f,{items:[],restrictedTypes:[]}));this.onitemsChange();},onitemsChange:function V(){this.refLnList.set("items",this.items);},generateNewRefLineItem:function J(f,g){},getSelectedItem:function O(){return this.refLnList.selectedItem;},selectItemByField:function B(g,f){this.refLnList.singleSelect(N.find(this.refLnList.items,g,f));},onselectRefLine:function X(f){},onaddRefLine:function P(f){},onremoveRefLine:function M(f){},onrenameRefLine:function S(f){}});mstrmojo.ui.editors.controls.GMReferenceLineList.ItemType=null;}());(function(){mstrmojo.requiresCls("mstrmojo.array","mstrmojo.dom","mstrmojo.hash","mstrmojo.express.ui.SubtotalsWidget","mstrmojo.mstr.EnumDSSXMLDrillType","mstrmojo.ui.menus.EditorConfig","mstrmojo.vi.enums.EnumFeatures");var M=mstrmojo.hash,I=mstrmojo.array,G=mstrmojo.mstr.EnumDSSXMLDrillType,O={STATIC:0,DRILLING:1,SELECTOR_CONTROL:2,HYPERLINK:4,SORT:8,PIVOT:16,EDIT:32,GROUP:64,CALCULATION:128,GROUP_EDIT:256,KEEP_ONLY:512,TOTAL_HEADER:1024},C=mstrmojo.vi.enums.EnumFeatures;function F(X){return mstrmojo.resolveFeature("web-sort")&&!!(X&&(X.mix!==undefined&&X._e&&X._e.otp===4));}function R(Y){var c=new mstrmojo.ui.menus.MenuConfig(),b=Y.data,X=Y.cfg,a=[{n:mstrmojo.desc(1893,"Left"),btp:"l"},{n:mstrmojo.desc(1894,"Right"),btp:"r"},{n:mstrmojo.desc(13834,"To Beginning"),btp:"b"}],Z=this.delegateActionToXtab;if(!X.tabularGrid){a.push({n:mstrmojo.desc(152,"Up"),btp:"u"},{n:mstrmojo.desc(153,"Down"),btp:"d"},{n:mstrmojo.desc(1891,"To Columns"),btp:"2"},{n:mstrmojo.desc(1890,"To Rows"),btp:"1"});}I.forEach(a,function(d){if(Y.xtab.model.isPvtButtonVisible(b,d.btp)){c.addMenuItem(d.n,"xt",function(){Z(Y,"pivot",[d.btp]);});}});return c;}function B(a,e){if(!a.onDemandDrillDynamicItems){a.onDemandDrillDynamicItems={};}var d="drill"+e,Z=a.onDemandDrillItems,Y=a.onDemandDrillDynamicItems[d];if((!a.onDemandDrillItems||a.shouldUpdateDrillMenus)&&!a.loadingDCM&&a.gridData.odd){a.loadingDCM=true;delete a.shouldUpdateDrillMenus;var c=new mstrmojo.SimpleXHR({async:false});c.request("POST",mstrConfig.taskURL,{success:function b(f){I.forEach(f.dynamicMenus,function(g){a.onDemandDrillDynamicItems[g.n]=g.items;if(g.n===d){Y=g.items;}});Z=f.menuItems;a.onDemandDrillItems=Z;delete a.loadingDCM;}},{taskId:"RWOnDemandDrill",styleName:"OndemandDrillContextMenusStyle",viewMode:1,usePartDisplay:1,docGridKey:a.k,rwb:a.model.docModel.bs});}var X=[];I.forEach(Y,function(k){var f=k.idx,g=Z[f],j=JSON.parse(g.subMenuIndices||"[]");if(j.length>0){var h=[];I.forEach(j,function(l){h.push(Z[l]);});g.items=h;}X.push(g);});return X;}function S(Y){var X="";switch(Y){case G.DssXmlDrillToChild:X="drillDown";break;case G.DssXmlDrillToParent:X="drillUp";break;case G.DssXmlDrillToTemplate:X="drillTemplate";break;}return X;}function K(Y){var X=I.filter(Y,function(Z){return[G.DssXmlDrillToChild,G.DssXmlDrillToParent].indexOf(Z.dt)>-1;});return X.length>0?"drill":"";}function V(X){return X&&X.mix!==undefined&&!!X._e;}function D(X){return X&&X.otp===12;}mstrmojo.rw.xtab.XtabMenuConfig=mstrmojo.declare(mstrmojo.ui.menus.MenuConfig,null,{scriptClass:"mstrmojo.rw.xtab.XtabMenuConfig",xtab:undefined,data:undefined,isActionAvailable:function J(Y,X){return((((Y&&Y.at)||0)&X)>0);},delegateActionToXtab:function L(X,a,Y){var Z=X.xtab;Z[a].apply(Z,[X.data].concat(Y||[]));},buildXtabMenuConfig:function A(c){var h=this.xtab=c.xtab,a=h.id,b=this.selectedData=c.data=c.data||(h&&c.td&&h.getCellForNode(c.td)),e=h.model.getCellTitleInfo(b),d={xtab:h,data:b,cfg:c},g=this.delegateActionToXtab;this.selectedNode=c.td;if(c.onClose){this.addPopupHandlers(a,mstrmojo.emptyFn,c.onClose);}var j=h.model.getCellLinksInfo(b)||{},Z=j.links||[],X=this.isActionAvailable(b,O.HYPERLINK)&&Z.length>0&&(b.slm==undefined),Y=this.isActionAvailable(b,O.DRILLING)&&(b.sdm==undefined)&&!!mstrmojo.resolveFeature(C.WEB_DRILL_AND_LINK),f=(b&&b.mix===undefined&&e.isSrcTitle&&b.otp!==-1&&b.avst>0);if(Y){Y=this.addDrillMenuItem(d)?true:false;}if(X){Z.forEach(function(l,k){this.addMenuItem(l.n||l.url||(l.target&&(l.target.n||l.target.did)),"",function(){g(d,"link",[k]);});},this);}if(Y||X){this.addSeparator();}if(!mstrApp.isDossier){this.addPivotMenuItem(d);}this.addSortMenuItem(d);if(f){this.addSeparator();this.addShowTotalMenuItem(d);}if(!mstrApp.isInVFConfigMode&&!mstrApp.isInVFInteractMode&&(mstrApp.isOIVM&&mstrApp.isOIVM()&&(D(b)||V(b)))){this.addViewFilterEditor(d);}this.addRemoveMenuItem(d);},addPivotMenuItem:function H(X){if(this.isActionAvailable(X.data,O.PIVOT)){var Y=R.call(this,X);if(Y.menus.length){this.addSubMenuItem(mstrmojo.desc(1889,"Move"),"",this.id,function(){return Y;},X);this.addSeparator();}}},addDrillMenuItem:function P(b,d){var f=b.xtab,Z=b.data,e=this.delegateActionToXtab,X=function(g){g.onDemandDrillItems=null;g.onDemandDrillDynamicItems=null;};var a=d?[d]:f.model.getAllDrillPathsForCell(Z),c=f.model.getCellTitleInfo(this.selectedData),Y=B(f,c.title.id);if(a.length<1&&Y.length<1){return ;}this.addPopupMenuItem(mstrmojo.desc(145,"Drill"),this.id,function(){var g=new mstrmojo.ui.menus.MenuConfig({menuCssClass:K(a),isHostedWithin:false,supportsScroll:true,alignWithAnchor:true,maxHeight:mstrmojo.dom.windowDim().h-50});I.forEach(a,function(h){if(h&&h.k){if(mstrApp.isDossier&&!h.within){return ;}g.addMenuItem(h.n||"",S(h.dt),function(){f.shouldUpdateDrillMenus=true;e(b,"drill",[h]);X(f);});}});I.forEach(Y,function(j){if(mstrApp.isDossier){var h=I.filter(j.items,function(k){return k.within;});if(h.length===0){return ;}}g.addPopupMenuItem(j.n,"",function(){var k=new mstrmojo.ui.menus.MenuConfig({supportsScroll:true,maxHeight:350,isHostedWithin:false,alignWithAnchor:true,menuCssClass:K(j.items)});I.forEach(j.items,function(l){if(mstrApp.isDossier&&!l.within){return ;}k.addMenuItem(l.n,S(l.dt),function(){f.shouldUpdateDrillMenus=true;e(b,"drill",[l]);X(f);});});return k;});});return g;});},addViewFilterEditor:function W(X){if(!mstrmojo.resolveFeature("use-view-filter-editor")){return ;}this.addMenuItem(mstrmojo.desc(3938,"edit view filter..."),"xt",this.delegateActionToXtab.bind(this,X,"showViewFilter"),X);},addRemoveMenuItem:function N(Y){if(!mstrmojo.resolveFeature("modify-grid-level-in-documents")){return ;}if(Y.data._e){if(Y.data._e.otp!==4){return ;}}if(Y.data.otp===-1){return ;}if(Y.data._tp){var X=Y.data._tp._e;if(X){if(X.otp===4){return ;}}}this.addSeparator();this.addMenuItem(mstrmojo.desc(190,"Remove"),"xt",this.delegateActionToXtab.bind(this,Y,"removeUnit"),Y);},addSortMenuItem:function U(X){var b=X.data,Z=this.delegateActionToXtab,c=this.isActionAvailable(b,O.SORT),a=X.xtab.model,Y=a.isRecursiveAttribute&&a.isRecursiveAttribute(b.id),d=Y&&mstrApp.isAppStateDefault&&mstrApp.isAppStateDefault()&&!mstrApp.isDossier;if(c){this.addMenuItem(mstrmojo.desc(7974,"Sort Ascending"),"xt",function(){Z(X,"sort",[true]);},X);this.addMenuItem(mstrmojo.desc(7975,"Sort Descending"),"xt",function(){Z(X,"sort",[false]);},X);if(d){this.addMenuItem(mstrmojo.desc(15676,"Custom Sort..."),"xt",function(){Z(X,"customSort",[b.axis]);},X);}}if(!X.cfg.hideAdvancedSort&&(c||F(b))&&!mstrApp.isDossier){this.addMenuItem(mstrmojo.desc(11099,"Advanced Sort..."),"xt",function(){Z(X,"advSort",[b.axis,X.ndeInfo]);},X);}},addShowTotalMenuItem:function E(X){this.addEditorMenuItem(mstrmojo.desc(6193,"Show Totals"),this.id,this.getSubtotalEditorConfig,M.copy(X,{isTotals:true}));},getSubtotalEditorConfig:function Q(Y){var Z=Y.data,b=Y.xtab,X=b.getBasicSubtotalEditorConfig(Z.ast);X.fnOk=function a(){var d=X.contents.getSubtotalTypes(),c=b.model;b.controller.onShowTotals(b,c.getShowTotalsUnitAction(Z.id,Z.otp,d[0],d[1]));};return X;}});mstrmojo.rw.xtab.XtabMenuConfig.ACTION_TYPES=O;mstrmojo.rw.xtab.XtabCellMenuItemContextType=null;}());(function(){mstrmojo.requiresCls("mstrmojo.Editor","mstrmojo.TextBox","mstrmojo.Button","mstrmojo.HBox","mstrmojo.EnumAuthenticationModes","mstrmojo.UsherLogin","mstrmojo.string","mstrmojo.cookies");mstrmojo.requiresDescs(17,18,221,11804,11863);var F=mstrmojo.EnumAuthenticationModes,D={};D[F.LDAP]=mstrmojo.desc(1947,"LDAP Authentication");D[F.DATABASE]=mstrmojo.desc(1948,"Database Authentication");var L={LIVE_OR_HL:0,PERSISTED:1};function B(){return(JSON.parse(decodeURIComponent(mstrmojo.cookies.getCookieSetting("lastMsgID")||"{}")))[mstrConfig.lastMsgKey];}function C(){var Q=this,R=Q.stdLoginInfo,O=R.user.value,N=R.tsvCode.value,S=R.pwd.value,U={taskId:"login",server:mstrConfig.serverName,project:mstrmojo.string.decodeHtmlString(mstrConfig.projectName),port:mstrConfig.serverPort,authMode:mstrConfig.authMode,setAsActiveSession:true};var P=B();if(P){U.msgID=P;}if((this.authMode&(F.STANDARD|F.LDAP|F.DATABASE))>0){U.userid=O;U.password=S;U.tsvCode=N;}mstrmojo.xhr.request("POST",mstrConfig.taskURL,{success:function(X){if(X&&X.sessionState){mstrApp.updateSessionState(X.sessionState);if(mstrApp.sessionManager){mstrApp.sessionManager.restart();}var a=X;var Z=a.servletState;if(Z){if(mstrApp){mstrApp.servletState=Z;}if(mstrConfig){mstrConfig.servleState=Z;}}var W=X.resCode;if(W==L.LIVE_OR_HL&&(mstrApp.isVI||mstrApp.scriptClass==="mstrmojo.OIVMApp"||mstrApp.analysisID)){mstrmojo.xhr.request("post",mstrConfig.taskURL,{success:function(){var b=Q.config.callback,c=b.success;if(c){c(a);}},failure:function(){mstrmojo.form.send({evt:3010,src:mstrApp.name+".3010"},null,"POST");}},{taskId:"docXMLResults",sessionState:X.sessionState,msgID:X.msgID,resultFlags:33554432});}else{var V=Q.config.callback,Y=V.success;if(Y){Y(a);}}}Q.destroy();},failure:function(V){if(Q.authMode===mstrmojo.EnumAuthenticationModes.NTCREDENTIAL){Q.set("visible",true);}mstrmojo.alert(V.getResponseHeader("X-MSTR-TaskFailureMsg"),null,null,Q.zIndex);}},U);}function M(){if(mstrApp.sessionManager){mstrApp.sessionManager.gotoLogoutPage();}}mstrmojo.LoginEditor=mstrmojo.declare(mstrmojo.Editor,null,{scriptClass:"mstrmojo.LoginEditor",cssClass:"mstrmojo-LoginEditor",title:mstrmojo.desc(11804,"Log in to"),btnAlignment:"right",help:null,config:{callback:{},taskParams:{}},authMode:F.STANDARD,usherEnabled:false,init:function K(N){this._super(N);this.title+=" "+mstrApp.projectName;this.set("authMode",parseInt(mstrConfig.authMode,10));if(this.isUsherLogin()){mstrmojo.css.addWidgetCssClass(this,"usher");}},isUsherLogin:function(){return this.authMode===F.USHER;},onvisibleChange:function J(){if(this.visible&&(mstrmojo.dom.isFF||mstrmojo.dom.isWK)){var N=this.stdLoginInfo.user;window.setTimeout(function(){N.focus();},50);}},onOpen:function E(){if(this.authMode===mstrmojo.EnumAuthenticationModes.NTCREDENTIAL){this.set("visible",false);}},onClose:function G(){M();},destroy:function I(){mstrmojo.dom.detachEvent(document.body,"mousedown",this.stopPropagation,true);this._super();},postBuildRendering:function A(){if(this.authMode===mstrmojo.EnumAuthenticationModes.NTCREDENTIAL){C.call(this);return ;}else{var N=this._super();this.stopPropagation=function(O){O.stopPropagation();};mstrmojo.dom.attachEvent(document.body,"mousedown",this.stopPropagation,true);return N;}},preBuildRendering:function H(){if(this.isUsherLogin()){var O=this,N=mstrmojo.insert({scriptClass:"mstrmojo.UsherLogin",alias:"usherLogin",onUsherLogin:function(){mstrConfig.authMode=F.USHER;C.call(O);}});this.addChildren([N],1);}return this._super();},children:[{scriptClass:"mstrmojo.Label",cssText:"margin-bottom: 20px; line-height: 1.5em;",text:mstrmojo.desc(11863,"Your user session has timed out due to inactivity, and you have been automatically logged out. Please log in again.")},{scriptClass:"mstrmojo.Box",alias:"stdLoginInfo",cssClass:"std-login-container",bindings:{visible:function(){return this.parent.authMode!==F.USHER;}},children:[{scriptClass:"mstrmojo.TextBox",alias:"user",cssClass:"login-username",cssDisplay:"block",hint:mstrmojo.desc(17,"User name"),postCreate:function(){if(mstrmojo.dom.isIE9||mstrmojo.dom.isIE8||mstrmojo.dom.isIE7){this.emptyText=mstrmojo.desc(17,"User name");}},onEnter:function(){C.call(this.parent.parent);}},{scriptClass:"mstrmojo.TextBox",alias:"pwd",cssClass:"login-pwd",cssDisplay:"block",hint:mstrmojo.desc(18,"Password"),type:"password",postCreate:function(){if(mstrmojo.dom.isIE9||mstrmojo.dom.isIE8||mstrmojo.dom.isIE7){this.emptyText=mstrmojo.desc(18,"Password");}},onEnter:function(){C.call(this.parent.parent);}},{scriptClass:"mstrmojo.TextBox",alias:"tsvCode",cssClass:"login-tsvCode",cssDisplay:"block",hint:mstrmojo.desc(13825,"Usher code"),bindings:{visible:function(){return mstrConfig.features["is-two-step-verification-required"];}},postCreate:function(){if(mstrmojo.dom.isIE9||mstrmojo.dom.isIE8||mstrmojo.dom.isIE7){this.emptyText=mstrmojo.desc(13825,"Usher code");}},onEnter:function(){C.call(this.parent.parent);}},{scriptClass:"mstrmojo.Label",cssClass:"mstrmojo-LoginEditor-authMode",bindings:{visible:function(){return this.parent.parent.authMode===F.LDAP||this.parent.parent.authMode===F.DATABASE;},text:function(){return D[this.parent.parent.authMode]||"";}}}]},{scriptClass:"mstrmojo.HBox",slot:"buttonNode",alias:"btns",cssClass:"mstrmojo-Editor-buttonBar",children:[{scriptClass:"mstrmojo.Button",cssClass:"mstrmojo-Button mstrmojo-WebButton hot",text:mstrmojo.desc(26,"Login"),bindings:{enabled:"this.parent.parent.stdLoginInfo.user.value.length > 0",visible:function(){return this.parent.parent.authMode!==F.USHER;}},onclick:function(){C.call(this.parent.parent);}},{scriptClass:"mstrmojo.Button",cssClass:"mstrmojo-Button mstrmojo-WebButton",text:mstrmojo.desc(221,"Cancel"),onclick:function(){M();}}]}]});}());(function(){mstrmojo.requiresCls("mstrmojo.Stepper","mstrmojo._HasLayout","mstrmojo.ui.editors.controls.ValidationTextBox","mstrmojo.expr","mstrmojo.css");var C=mstrmojo.expr.DTP,B=mstrmojo.css,A="mstrmojo-Stepper-ErrValidation";mstrmojo.ui.editors.controls.Stepper=mstrmojo.declare(mstrmojo.Stepper,[mstrmojo._HasLayout],{scriptClass:"mstrmojo.ui.editors.controls.Stepper",markupString:'<div id="{@id}" class="mstrmojo-Stepper {@orientation} {@cssClass}" mstrAttach:click,mousedown,mouseup,mousemove,selectstart><div class="title">{@title}</div><div class="next">+</div><div class="text"></div><div class="prev">-</div></div>',layoutConfig:{w:{textNode:"100%"},xt:true},textInput:null,init:function E(F){var G=F.provider;if(!!mstrApp.isWSStyling){this.layoutConfig=null;}this.children=[{scriptClass:"mstrmojo.ui.editors.controls.ValidationTextBox",alias:"textInput",slot:"textNode",dtp:G.dtp||C.INTEGER,maxLength:G.maxLength,constraints:{validator:G.validator,max:G.max,min:G.min},onValid:function(){var H=this.parent;B.removeClass(H.domNode,A);G.setVal(parseInt(this.value,10)||0);H.updateDisplayText();}}];this._super(F);this.addDisposable(G);B.addWidgetCssClass(this,"mstrmojo-ui-ctrl-Stepper");},postBuildRendering:function(){this.updateDisplayText();this._super();},updateDisplayText:function D(){this.textInput.set("value",this.provider.getVal());}});}());(function(){mstrmojo.requiresCls("mstrmojo.Container","mstrmojo.FieldSet","mstrmojo._FormatDefinition","mstrmojo.Label","mstrmojo.Pulldown","mstrmojo.ColorPicker");var C=mstrmojo.hash,A=mstrmojo.color,D=mstrmojo._FormatDefinition;var B=function(F,I,E){var H=["Left","Right","Top","Bottom"];for(var G=0;G<3;G++){F[H[G]+I]=E;}F.set(H[3]+I,E);};mstrmojo.BorderFormatter=mstrmojo.declare(mstrmojo.Container,null,{scriptClass:"mstrmojo.BorderFormatter",cssClass:"mstrmojo-BorderFormatter",markupString:'<div id={@id} class="{@cssClass}" style="{@cssText}"></div>',markupSlots:{containerNode:function(){return this.domNode;}},markupMethods:{onvisibleChange:function(){this.domNode.style.display=this.visible?"block":"none";}},postCreate:function(){this.onmodelChange();},onmodelChange:function(){if(this.model&&!this.model.scriptClass){C.make(this.model,mstrmojo.Obj);}},children:[{scriptClass:"mstrmojo.FieldSet",alias:"borders",cssClass:"mstrmojo-FormatEditor-border",legend:mstrmojo.desc(2886),children:[{scriptClass:"mstrmojo.Table",alias:"borderTable",cssText:"width:100%;",rows:1,cols:2,children:[{scriptClass:"mstrmojo.List",alias:"borderTypes",selectedIndex:0,cssClass:"borderTypes",items:[{n:'<img border="0" align="absmiddle" src="../images/borders_none.gif" alt=""> '+mstrmojo.desc(2057),v:1},{n:'<img border="0" align="absmiddle" src="../images/borders_all.gif" alt=""> '+mstrmojo.desc(2058),v:2},{n:'<img border="0" align="absmiddle" src="../images/borders_custom.gif" alt=""> '+mstrmojo.desc(2056),v:3}],slot:"0,0",bindings:{m:"this.parent.parent.parent.model",selectedIndex:function(){var E=this.m;if(C.isEmpty(E)){return 0;}if(E.LeftStyle==0&&E.TopStyle==0&&E.RightStyle==0&&E.BottomStyle==0){return 0;}else{if(E.LeftStyle==E.TopStyle&&E.LeftStyle==E.RightStyle&&E.LeftStyle==E.BottomStyle){return 1;}}return 2;}},onchange:function(E){if(this.m){var G=this.parent.borderAndColor;if(!G){return ;}if(this.selectedIndex===0){var H=["Left","Right","Top","Bottom"];for(var F=0;F<4;F++){this.m.set(H[F]+"Style","0");this.m.set(H[F]+"Color","0");}}}}},{scriptClass:"mstrmojo.Container",alias:"borderAndColor",markupString:'<div class="borderStyles"></div>',markupSlots:{containerNode:function(){return this.domNode;}},markupMethods:{onvisibleChange:function(){this.domNode.style.display=this.visible?"block":"none";}},children:[{scriptClass:"mstrmojo.Container",alias:"allBordersContainer",markupString:'<div class="mstrmojo-FormatEditor-ColorLine-borders"></div>',markupSlots:{containerNode:function(){return this.domNode;}},markupMethods:{onvisibleChange:function(){this.domNode.style.display=this.visible?"block":"none";}},bindings:{visible:"this.parent.parent.borderTypes.selectedIndex==1"},children:[{scriptClass:"mstrmojo.Table",alias:"allBorders",rows:1,cols:3,onshowChange:function(){if(this.show){B(this.m,"Style",this.styles.value);B(this.m,"Color",A.encodeColor(this.colors.fillColor));}},bindings:{m:"this.parent.parent.parent.parent.parent.model"},postCreate:function(){var F=["Left","Right","Top","Bottom"];var E=[{scriptClass:"mstrmojo.Pulldown",alias:"styles",items:D.BorderStyles,itemIdField:"v",bindings:{m:"this.parent.m",value:function(){var I=this.m.LeftStyle,K=this.m.RightStyle,J=this.m.TopStyle,H=this.m.BottomStyle;var G=0;if(I==K&&K==H&&H==J){G=mstrmojo.array.find(D.BorderStyles,"v",I);}G=G==-1?0:G;return this.items[G][this.itemIdField];}},onvalueChange:function(){if(this.parent.parent.visible){B(this.m,"Style",this.value);}},slot:"0,1"},mstrmojo.ColorPicker.createDropDown({alias:"colors",bindings:{m:"this.parent.m",fillColor:function(){var H=this.m.LeftColor,K=this.m.RightColor,J=this.m.TopColor,G=this.m.BottomColor;if(H==K&&K==G&&G==J){var I=H;}if(typeof (I)!="undefined"&&/^\d{1,8}$/.test(I)){return A.decodeColor(I);}return"transparent";}},onfillColorChange:function(){if(this.parent.parent.visible){B(this.m,"Color",this.fillColor=="transparent"?"pru":A.encodeColor(this.fillColor));}},slot:"0,2"})];this.addChildren(E);}}]},{scriptClass:"mstrmojo.Container",alias:"customBordersContainer",markupString:'<div class="mstrmojo-FormatEditor-ColorLine-borders"></div>',markupSlots:{containerNode:function(){return this.domNode;}},markupMethods:{onvisibleChange:function(){this.domNode.style.display=this.visible?"block":"none";}},bindings:{visible:"this.parent.parent.borderTypes.selectedIndex==2"},children:[{scriptClass:"mstrmojo.Table",alias:"customBorders",rows:1,cols:3,bindings:{m:"this.parent.parent.parent.parent.parent.model"},postCreate:function(){var H=["Left","Right","Top","Bottom"];var G=[];for(var F=0;F<H.length;F++){var E=H[F];G.push({scriptClass:"mstrmojo.Label",text:mstrmojo.desc({Left:3528,Right:3529,Top:3526,Bottom:3527}[E]),alias:E,slot:"0,0"},{scriptClass:"mstrmojo.Pulldown",items:D.BorderStyles,itemIdField:"v",pr:E+"Style",bindings:{m:"this.parent.m",value:function(){var K=this.m.LeftStyle,M=this.m.RightStyle,L=this.m.TopStyle,J=this.m.BottomStyle;var I=mstrmojo.array.find(D.BorderStyles,"v",this.m[this.pr]);I=I==-1?0:I;return this.items[I][this.itemIdField];}},onvalueChange:function(){if(this.parent.parent.visible){this.m.set(this.pr,this.value);}},slot:"0,1"},mstrmojo.ColorPicker.createDropDown({cssClassx:"mstrmojo-FormatEditor-colorPicker",alias:E+"Color",pr:E+"Color",bindings:{m:"this.parent.m",fillColor:function(){var J=this.m.LeftColor,M=this.m.RightColor,L=this.m.TopColor,I=this.m.BottomColor;var K=this.m[this.pr];if(typeof (K)!="undefined"&&/^\d{1,8}$/.test(K)){return A.decodeColor(K);}return"transparent";}},onfillColorChange:function(){if(this.parent.parent.visible){this.m.set(this.pr,this.fillColor=="transparent"?"pru":A.encodeColor(this.fillColor));}},slot:"0,2"}));}this.addChildren(G);}}]}],slot:"0,1"}]},{scriptClass:"mstrmojo.Label",cssClass:"borderPreview",text:mstrmojo.desc(7941),bindings:{m:"this.parent.parent.model",cssText:function(){var G={0:"None",3:"Dashed",4:"Dotted",6:"Double",7:"Solid"},E={1:"Thin",5:"Thick",6:"medium"};var F=this.parent.borderTable.borderTypes.selectedIndex;return";border-left-style: "+(G[this.m.LeftStyle]||"solid")+";border-right-style: "+(G[this.m.RightStyle]||"solid")+";border-top-style: "+(G[this.m.TopStyle]||"solid")+";border-bottom-style: "+(G[this.m.BottomStyle]||"solid")+";border-left-color: "+A.decodeColor(this.m.LeftColor||"0")+";border-right-color: "+A.decodeColor(this.m.RightColor||"0")+";border-top-color: "+A.decodeColor(this.m.TopColor||"0")+";border-bottom-color: "+A.decodeColor(this.m.BottomColor||"0")+";border-left-width: "+(E[this.m.LeftStyle]||"thin")+";border-right-width: "+(E[this.m.RightStyle]||"thin")+";border-top-width: "+(E[this.m.TopStyle]||"thin")+";border-bottom-width: "+(E[this.m.BottomStyle]||"thin");}}}]}]});})();(function(){mstrmojo.requiresCls("mstrmojo.Container","mstrmojo.FieldSet","mstrmojo.Label","mstrmojo.ColorPicker");var A=mstrmojo.hash,B=mstrmojo.color;mstrmojo.FillFormatter=mstrmojo.declare(mstrmojo.Container,null,{scriptClass:"mstrmojo.FillFormatter",cssClass:"mstrmojo-FillFormatter",isChart:false,markupString:'<div id={@id} class="{@cssClass}" style="{@cssText}"></div>',markupSlots:{containerNode:function(){return this.domNode;}},markupMethods:{onvisibleChange:function(){this.domNode.style.display=this.visible?"block":"none";}},postCreate:function(){this.onmodelChange();},onmodelChange:function(){if(this.model&&!this.model.scriptClass){A.make(this.model,mstrmojo.Obj);}},children:[{scriptClass:"mstrmojo.FieldSet",alias:"fill",cssClass:"mstrmojo-FormatEditor-fill",legend:mstrmojo.desc(2885,"Fill"),bindings:{legend:"this.parent.isChart ? mstrmojo.desc(3902, 'Series Colors') : mstrmojo.desc(2885, 'Fill')"},children:[{scriptClass:"mstrmojo.Label",text:mstrmojo.desc(2060,"Color"),cssClass:"label"},mstrmojo.ColorPicker.createDropDown({bindings:{m:"this.parent.parent.model",fillStyle:function(){var H=this.m,J=parseInt(H.FillStyle,10);if(J===2){var E=parseInt(H.GradientAngle,10),I=E===0?1:0,D=B.decodeColor(H.FillColor),K=B.decodeColor(H.GradientColor),C=parseInt(H["Gradient"+(E===0?"X":"Y")+"Offset"],10)===100?1:0,G=(C!==1)?mstrmojo.css.buildGradient(I,D,K):mstrmojo.css.buildGradient(I,K,D);this.set("gradientCss",G.n+":"+G.v);this._updateGradientInfo();}else{var F=this.m.FillColor;if(F!==undefined&&/^\d{1,8}$/.test(F)){F=B.decodeColor(F);}else{F="transparent";}this.set("fillColor",F);}return J||0;}},_updateGradientInfo:function(){var C=this.m;this.gradient=mstrmojo.hash.copy({FillColor:B.decodeColor(C.FillColor),GradientColor:B.decodeColor(C.GradientColor)},A.copy(C));},onfillColorChange:function(){this.m.FillColor=(this.fillColor==="transparent"?"pru":B.encodeColor(this.fillColor));this.m.FillStyle=0;},ongradientChange:function(C){var F=["FillStyle","FillColor","GradientColor","GradientXOffset","GradientYOffset","GradientAngle"],E;for(E=0;E<F.length;E++){var D=C.value[F[E]];this.m[F[E]]=/Color$/.test(F[E])?B.encodeColor(D):D;}this.m.FillStyle=2;}},{showGradients:false})]}]});}());(function(){mstrmojo.requiresCls("mstrmojo.hash","mstrmojo._FormatDefinition","mstrmojo.Table","mstrmojo._HasLayout","mstrmojo.color","mstrmojo.ColorPicker");var D=mstrmojo.hash,C=mstrmojo.array,F=mstrmojo._FormatDefinition,B=mstrmojo.color;var A=function(G){var H={scriptClass:"mstrmojo.List",cssClass:"mstrmojo-FormatEditor-fontFamily",itemCssClass:"mstrmojo-FormatEditor-bullet",selectedIndex:0,itemIdField:"v",itemMarkup:'<div class="mstrmojo-FormatEditor-bullet"><div class="mstrmojo-text">{@n}</div></div>'};return D.copy(G,H);};var E=function(I){var H=I.alias,G=I.label,J=I.pr;return{alias:H,scriptClass:"mstrmojo.TristateCheckBox",text:G,checked:false,grayed:false,bindings:{m:I.modelBinding,checked:function(){return this.m[J]==-1;},grayed:function(){return(typeof this.m[J]=="undefined")||this.m[J]=="pru";}},oncheckedChange:function(K){if(this.m){this.m.set(J,this.checked?-1:0);}}};};mstrmojo.FontFormatter=mstrmojo.declare(mstrmojo.Container,null,{scriptClass:"mstrmojo.FontFormatter",cssClass:"mstrmojo-FontFormatter",markupString:'<div id={@id} class="{@cssClass}" style="{@cssText}"></div>',markupSlots:{containerNode:function(){return this.domNode;}},markupMethods:{onvisibleChange:function(){this.domNode.style.display=this.visible?"block":"none";}},postCreate:function(){this.onmodelChange();},onmodelChange:function(){if(this.model&&!this.model.scriptClass){D.make(this.model,mstrmojo.Obj);}},children:[{scriptClass:"mstrmojo.Table",layout:[{cells:[{},{},{}]},{cells:[{},{colSpan:2}]}],children:[{scriptClass:"mstrmojo.Label",text:mstrmojo.desc(2172),slot:"0,0"},A({items:F.Families,itemMarkup:'<div class="mstrmojo-FormatEditor-bullet"><div class="mstrmojo-text" style="font-family:{@n}">{@n}</div></div>',pr:"Name",bindings:{selectedIndex:function(){var H=this.parent.parent.model;if(H){var I=H.Name,G=C.find(this.items,this.itemIdField,I);return G==-1?0:G;}}},onchange:function(){var G=this.parent.parent.model;if(G){G.set("Name",this.selectedItem.v);}},slot:"0,0"}),{scriptClass:"mstrmojo.Label",text:mstrmojo.desc(3059),slot:"0,1"},A({items:F.Styles,cssClass:"mstrmojo-FormatEditor-fontStyle",bindings:{selectedIndex:function(){var K=this.parent.parent.model;if(K){var I=K.Bold||"",H=K.Italic||"",J=I==""&&H==""?"":I+","+H,G=mstrmojo.array.find(this.items,this.itemIdField,J);G=G==-1?mstrmojo.array.find(this.items,"v2",J):G;return(G==-1?0:G);}}},onchange:function(){var I=this.parent.parent.model;if(I&&this.selectedItem){var H=this.selectedItem.v.split(","),G=italic="pru";if(H[0]!="pru"){G=H[0]=="-1"?"-1":"0";italic=H[1]=="-1"?"-1":"0";}I.set("Bold",G);I.set("Italic",italic);}},slot:"0,1"}),{scriptClass:"mstrmojo.Label",text:mstrmojo.desc(2178),slot:"0,2"},A({items:F.Sizes,cssClass:"mstrmojo-FormatEditor-fontSize",bindings:{selectedIndex:function(){var H=this.parent.parent.model;if(H){var I=H.Size,G=C.find(this.items,this.itemIdField,I);return G==-1?0:G;}}},onchange:function(){var G=this.parent.parent.model;if(G){G.set("Size",this.selectedItem.v);}},slot:"0,2"}),{scriptClass:"mstrmojo.Label",text:mstrmojo.desc(3060),slot:"1,0"},{scriptClass:"mstrmojo.VBox",cssClass:"mstrmojo-FormatEditor-fontEffect",postCreate:function(){this.addChildren(E({alias:"Underline",label:mstrmojo.desc(3061),pr:"Underline",modelBinding:"this.parent.parent.parent.model"}));this.addChildren(E({alias:"Strikeout",label:mstrmojo.desc(3062),pr:"Strikeout",modelBinding:"this.parent.parent.parent.model"}));},slot:"1,0"},{scriptClass:"mstrmojo.Label",text:mstrmojo.desc(3063),slot:"1,1"},mstrmojo.ColorPicker.createDropDown({pr:"Color",bindings:{fillColor:function(){var G=this.parent.parent.model;if(G){var H=G[this.pr];if(typeof (H)!="undefined"&&/^\d{1,8}$/.test(H)){return B.decodeColor(H);}}return"transparent";}},onfillColorChange:function(){if(this.parent.parent.model){this.parent.parent.model.set(this.pr,this.fillColor=="transparent"?"pru":B.encodeColor(this.fillColor));}},slot:"1,1"}),{scriptClass:"mstrmojo.Label",text:mstrmojo.desc(2036),slot:"1,1"},{scriptClass:"mstrmojo.Label",cssClass:"mstrmojo-FormatEditor-fontPreview",text:mstrmojo.desc(2037),bindings:{m:"this.parent.parent.model",cssText:function(){var H=this.m.Color,J=this.m.Size,K=this.m.Name,I=this.m.Bold,G=this.m.Italic,M=this.m.Underline,L=this.m.Strikeout;H=/^\d{1,8}$/.test(H)?B.decodeColor(H):B.decodeColor(F.DefaultFormat.FormattingFont.Color);J=J||F.DefaultFormat.FormattingFont.Size;K=K||F.DefaultFormat.FormattingFont.Name;I=I=="-1"?"bold":"normal";G=G=="-1"?"italic":"normal";M=parseInt(M)==-1;L=parseInt(L)==-1;return";font-family:"+K+";font-style:"+G+";font-weight:"+I+";font-size:"+J+"pt;color:"+H+";text-decoration:"+(M?" underline ":"")+(L?" line-through ":"");}},slot:"1,1"}]}]});})();(function(){mstrmojo.requiresCls("mstrmojo.vi.ui.toolbars.Toolbar","mstrmojo.css");var D=mstrmojo.css;var B;mstrmojo.vi.ui.toolbars.TitleToolbar=mstrmojo.declare(mstrmojo.vi.ui.toolbars.Toolbar,null,{scriptClass:"mstrmojo.vi.ui.toolbars.TitleToolbar",init:function F(H){this._super(H);D.addWidgetCssClass(this,"mstrmojo-VITitleToolbar");},markupMethods:{onvisibleChange:function A(){var H=this.visible,I=this.domNode;D.toggleClass(I,"visible",H);if(!H){D.onTransitionEnd(I,function(){D.addClass(I,"hidden");});}else{D.removeClass(I,"hidden");}}},getItemMarkup:function E(H){if(!B){B=this._super(H).replace("{@en@n}",'<div class="icn"></div>');}return B;},ontoolbarCfgChange:function G(H){var I=H.value;if(I){if(I.showContextMenu){I.addMenuToolbarBtn("","mnu");}if(I.hasCloseButton){I.addToolbarBtn(I.closeButtonText,"cls",function(K,J){J.parent.close();});}}this._super(H);},onItemContextMenu:function C(H){this.closePopup();if(H.fn){H.fn(H,this);return true;}}});}());(function(){mstrmojo.requiresCls("mstrmojo.Container","mstrmojo.ui.menus._HasMenuPopup","mstrmojo.vi._MonitorsAppState","mstrmojo.vi._MonitorsLayoutMode","mstrmojo._HasOwnAvatar","mstrmojo.vi.ui._IsDropTarget","mstrmojo.EditableLabel","mstrmojo.ui.menus.MenuConfig","mstrmojo.css");var A=mstrmojo.css,N=mstrmojo.dom,M="draggedTab",J="stopDragging",m=1,L=2,q=4,G=8,l=16;function n(r){return function(){A.toggleClass(this.tabStripMenuNode,"active",r);};}function h(AD){var x=new mstrmojo.ui.menus.MenuConfig({supportsScroll:true,maxHeight:N.getMaxScrollHeight()}),r=this.getMenuActions(),AB=this.index,u=this.id,v=this.total,z=this.parent,t=function(){var AE=z&&z.getTabs();return AE&&AE.length>AB?AE[AB]:mstrmojo.all[u];};if((r&l)>0){this.addNewTabMenuItem(x);}if((r&q)>0){var AA=mstrmojo.desc(3397,"Duplicate"),AC=this.parent.scriptClass;if(AC.indexOf("LayoutTabStrip")>=0){AA=mstrmojo.desc(15022,"Duplicate Chapter");}else{if(AC.indexOf("PanelTabStrip")>=0){AA=mstrmojo.desc(14923,"Duplicate Page");}}x.addMenuItem(AA,"dup",function(){t().tabDuplicated();});}if((r&L)>0){if(AB){x.addMenuItem(mstrmojo.desc(5362,"Move Left"),"lft",function(){t().tabMoved(true);});}if(AB<v-1){x.addMenuItem(mstrmojo.desc(5363,"Move Right"),"rgt",function(){t().tabMoved(false);});}}x.addSeparator();if((r&m)>0){x.addMenuItem(mstrmojo.desc(1388,"Rename"),"rnm",function(){t().lbl.set("isEditing",true);});}if((r&G)>0){if(v>1){x.addMenuItem(mstrmojo.desc(629,"Delete"),"cls",function(){t().tabDeleted();});}}var w=this.getCustomMenu();if(w&&w.hasMenuItems()){x.addSeparator();x.absorbMenuItems(w);}x.addPopupHandlers(this.id,n(true),n(false));this.showTabMenu(this.updateMenuCfg(x),AD);}mstrmojo.vi.ui.tabs.Tab=mstrmojo.declare(mstrmojo.Container,[mstrmojo.ui.menus._HasMenuPopup,mstrmojo._HasOwnAvatar,mstrmojo.vi.ui._IsDropTarget,mstrmojo.vi._MonitorsAppState,mstrmojo.vi._MonitorsLayoutMode],{scriptClass:"mstrmojo.vi.ui.tabs.Tab",markupString:'<div id="{@id}" class="mstrmojo-VITab unselectable {@cssClass}" style="{@cssText}" unselectable="on" mstrAttach:contextmenu,click><div><div class="mstrmojo-VITab-tab"></div><div class="mstrmojo-VITab-menu"></div></div></div>',markupSlots:{containerNode:function S(){return this.domNode.firstChild.firstChild;},menuBtnNode:function p(){return this.domNode.firstChild.lastChild;}},markupMethods:{ontitleChange:function I(){this.lbl.set("text",this.title);},onisSelectedChange:function j(){mstrmojo.css.toggleClass(this.domNode,"selected",this.isSelected);},onzIndexChange:function k(){this.domNode.style.zIndex=this.zIndex;}},zIndex:1,menuBtnNode:null,lbl:null,title:"",index:-1,total:-1,isSelected:false,isCutoff:false,isHidden:false,isLeftMost:false,isRightMost:false,leftEdgeHiddenWidth:0,rightEdgeHiddenWidth:0,children:[{scriptClass:"mstrmojo.EditableLabel",alias:"lbl",editOnClick:false,onTextEditComplete:function W(t,r){if(t){this.parent.titleEdited(this.text,r);}}}],postBuildRendering:function Q(){var r=this.isValidMode();if(!r||(mstrApp.isLayoutModePreview&&mstrApp.isLayoutModePreview())){this.draggable=false;}this.lbl.set("editOnDoubleClick",r);this._super();},oncontextmenu:function b(r){this.onclick(r);r.preventDefault();},onclick:function e(r){var u=this.domNode;if(A.hasClass(u,J)){A.removeClass(u,J);return ;}var t=function(){if(this.isValidMode()){this.postTabClicked(this,r);}};if(!this.isSelected){this.tabSelected({success:t.bind(this)});}else{t.call(this);}},postTabClicked:function o(v,t){v=this.findSelectedTab(this)||v;var r=v.menuBtnNode,w=t.getTarget().className===r.className,u;if(w){u=N.position(r);}if(t.name==="contextmenu"||(w&&!(u.x||u.y))){u={x:t.e.clientX,y:t.e.clientY};}if(u){h.call(v,u);}},getMenuActions:function d(){return 0;},getCustomMenu:function Y(){return null;},isDragValid:function R(){return this.parent.children.length>1&&!this.lbl.isEditing&&this.isValidMode();},createAvatar:function U(){var r=document.createElement("div");r.appendChild(this.domNode.cloneNode(true));r.style.margin="-5px 0 0 10px";return r;},addTabDnDStyle:function X(){var r=this.lbl.domNode;if(r&&!this.isSelected){A.addClass(r,M);}},clearTabDnDStyle:function F(){var r=this.lbl.domNode;if(r&&!this.isSelected){A.removeClass(r,M);}},allowDrop:function D(r){var t=r.src.widget;return t&&t.parent===this.parent;},dropTab:function K(r){var v=r.src,u=v.data,t=v.widget;t.clearTabDnDStyle();this.parent.moveTab(u.idx,this.index,u.fromIdx);},ondragenter:function H(t){this._super(t);var v=t.src.data,u=t.src.widget,r=this.index;this.parent.moveTab(v.idx,r);v.idx=r;},ondragover:function a(u){var r=u.tgt.node,t=u.tgtData,v=t&&t.node,w=u.src.widget;if(!t||v!==r){u.tgtData={node:r};}if(w&&!w.isSelected){w.addTabDnDStyle();}},ondragleave:function P(r){this._super(r);var t=r.src.widget;if(t&&!t.isSelected){t.addTabDnDStyle();}},ondragend:function C(r){this._super(r);A.addClass(this.domNode,J);this.dropTab(r);},getDragData:function c(){var u=this.id,r=this.index;return{setAvatarClass:function t(v){var z=mstrmojo.all[u],w=z.avatar;if(w){var x=[z.avatarCssClass,"hasOwnAvatar",v];w.className=x.join(" ");}},fromIdx:r,idx:r};},getDropAvatarIcon:function B(){return"pivot";},isValidMode:function E(){return !((mstrApp.isAppStatePresentation&&mstrApp.isAppStatePresentation())||(mstrApp.isAppStateSelection&&mstrApp.isAppStateSelection())||(mstrApp.allowWebDashboardDesign&&!mstrApp.allowWebDashboardDesign()));},cleanUpAfterTarget:function f(r){this.clearTabDnDStyle();this._super(r);},onAppStateChange:function g(t){var v=this.lbl,u=this.isValidMode(),r=mstrApp.isLayoutPreview(t.value);v.set("isEditing",false);v.set("editOnDoubleClick",u);this.draggable=u&&!r;},onLayoutModeChange:function O(t){var u=this.isValidMode(),r=mstrApp.isLayoutPreview(t.value);this.draggable=u&&!r;},addNewTabMenuItem:function V(r){this.throwAbstractMethodError("addNewTabMenuItem");},findSelectedTab:mstrmojo.emptyFn,tabSelected:mstrmojo.emptyFn,titleEdited:mstrmojo.emptyFn,tabMoved:mstrmojo.emptyFn,tabDeleted:mstrmojo.emptyFn,tabDuplicated:mstrmojo.emptyFn,showTabMenu:mstrmojo.emptyFn,updateMenuCfg:function Z(r){return r;}});mstrmojo.vi.ui.tabs.Tab.ACTIONS={NEW_TAB:l,RENAME:m,MOVE:L,DUPLICATE:q,DELETE:G};}());(function(){mstrmojo.requiresCls("mstrmojo.Widget","mstrmojo.string","mstrmojo.dom","mstrmojo.css","mstrmojo.ui.menus._HasMenuPopup","mstrmojo.ui.menus.MenuConfig");var D=mstrmojo.string,A=mstrmojo.dom,E=mstrmojo.ui.PopupConfig.ENUM_CORNERS;function B(){var K=this,J=K.statusList,F=J&&J.length||0,G=K.statusConfig||new mstrmojo.ui.menus.MenuConfig(),L=function(M){return function(N){K.set("status",M);K.onStatusClick(M);};};if(!G.hasMenuItems()&&F){for(var H=0;H<F;H++){var I=J[H];G.addMenuItem(I.n,I.cls||"",L(I),K);}}else{}if(G.hasMenuItems()){G.alignment=K.alignment||{host:E.BOTTOM_LEFT,popup:E.TOP_LEFT};G.hostId=K.id;G.hostElement=K[K.hostElementName]||K.domNode;K.openPopup(G.newInstance());}}function C(){var F=this.statusConfig||this.statusList&&this.statusList.length>1;this.menuButtonNode.style.display=F?"":"none";}mstrmojo.ui.StatusButton=mstrmojo.declare(mstrmojo.Widget,[mstrmojo.ui.menus._HasMenuPopup],{scriptClass:"mstrmojo.ui.StatusButton",markupString:'<div id="{@id}" class="mstrmojo-StatusButton {@cssClass} {@iconClass}" title="{@title}" style="{@cssText}"><div class="mstrmojo-Button {@innerIconClass}"  mstrAttach:click><span class="mstrmojo-text"></span></div><div class="menuButton" mstrAttach:click></div></div>',markupSlots:{textNode:function(){return this.domNode.firstChild;},textSpanNode:function(){return this.domNode.firstChild.firstChild;},menuButtonNode:function(){return this.domNode.lastChild;}},markupMethods:{onvisibleChange:mstrmojo.Widget.visibleMarkupMethod,onstatusChange:function(){this.textSpanNode.innerHTML=D.encodeHtmlString(this.status&&this.status.n||"");},onstatusListChange:function(){C.call(this);},onstatusConfigChange:function(){C.call(this);}},status:null,statusList:null,statusConfig:null,onclick:function(F){var G=A.eventTarget(F.hWin,F.e);if(A.contains(this.menuButtonNode,G,true)){B.call(this);}else{if(A.contains(this.textNode,G,true)){this.onButtonClick(this.status,F);}}},onButtonClick:mstrmojo.emptyFn,onStatusClick:mstrmojo.emptyFn});}());(function(){mstrmojo.requiresCls("mstrmojo.func","mstrmojo.ui.menus.MenuConfig");var A=mstrmojo.func,J=mstrmojo.desc(2177,"Close");function G(L){return function(N,M){M.openMenu(L,N);};}mstrmojo.ui.menus.ToolbarConfig=mstrmojo.declare(mstrmojo.ui.menus.MenuConfig,null,{scriptClass:"mstrmojo.ui.menus.ToolbarConfig",btns:null,hasCloseButton:false,closeButtonText:J,showContextMenu:true,addCloseButton:function E(L){this.hasCloseButton=true;if(L){this.closeButtonText=L;}},preShowMenu:mstrmojo.emptyFn,addToolbarBtn:function I(R,M,P,L,N,Q){var O={n:R,cls:M,fn:P,ctxt:L,ttp:Q};if(isNaN(N)||N>=this.btns.length){this.btns.push(O);}else{this.btns.splice(N,0,O);}return O;},addDisabledToolbarBtn:function I(O,M,L){var N=this.addToolbarBtn(O,(M||"")+" disabled",mstrmojo.emptyFn,L);N.dsbld=true;},addToolbarPickerBtn:function B(R,M,P,Q,L,N){var O={n:R,cls:M,fn:P,ctxt:L,tp:"pb",menufn:G(Q||this)};if(isNaN(N)||N>=this.btns.length){this.btns.push(O);}else{this.btns.splice(N,0,O);}},addMenuToolbarBtn:function H(P,L,O,M,N){if(!O&&!this.hasMenuItems()){return ;}this.addToolbarBtn(P,L,A.composite([this.preShowMenu,G(O||this),(N||mstrmojo.emptyFn)]),null,M);},addToggleToolbarButton:function D(S,O,Q,N,M,R,L){var P=this.getToggleItemStates(S,O,Q,N,R,L);this.addDualStateItem(M,P[0],P[1],true);},addDualStateItem:function K(M,L,N,O){this["add"+(O?"ToolbarBtn":"MenuItem")](L.n,L.cls,this.getDualStateHandler(M,L,N),L.ctxt,undefined,L.ttp);},getDualStateHandler:function C(M,L,N){var O=this._super(M,L,N);return function(P,Q){O.call(this,P,Q);Q.refresh();};},clear:function F(){this.btns=[];this.hasCloseButton=false;this.closeButtonText=J;this._super();}});}());(function(){mstrmojo.requiresCls("mstrmojo.ui.menus.MenuConfig","mstrmojo.ui.ScrollableContainer","mstrmojo.css","mstrmojo.dom","mstrmojo.hash","mstrmojo.Button");var H=mstrmojo.Button.newWebButton,E=mstrmojo.hash,L=mstrmojo.css,J=mstrmojo.dom;var B="grouping",C="highlight",I="disabled";function F(O,Q){J.preventDefault(window,O);J.stopPropogation(window,O);if(this.groupingOverlay.domNode.className.indexOf(C)===-1&&this.domNode.className.indexOf("selected")===-1){return ;}Q=E.copy(Q,{supportsScroll:true,isHostedWithin:false,maxHeight:J.getMaxScrollHeight()});var P=this.parent.getGroupContextMenuConfig(new mstrmojo.ui.menus.MenuConfig(Q),this.k);if(P.hasMenuItems()){this.openPopup(P.newInstance());}}mstrmojo.vi.ui._CanGroup=mstrmojo.provide("mstrmojo.vi.ui._CanGroup",{_mixinName:"mstrmojo.vi.ui._CanGroup",startGrouping:function G(O){L.addClass(this.domNode,B);var Q=this.groupingOverlay;if(!Q){var P=this,S=this.id;this.addChildren({scriptClass:"mstrmojo.ui.ScrollableContainer",cssClass:"groupingOverlay",alias:"groupingOverlay",cssDisplay:"",slot:"domNode",children:[H(mstrmojo.desc(1911,"Group"),function(U){U.cancel();P.groupSelection();},true,{cssClass:"btnGroup",cssDisplay:""}),H("",function(U){var V=mstrmojo.ui.PopupConfig.prototype.ENUM_CORNERS;F.call(mstrmojo.all[S],U.e,{hostId:S,hostElement:this.domNode,alignment:{host:V.BOTTOM_LEFT,popup:V.TOP_LEFT}});},false,{cssClass:"btnMenu",cssDisplay:""})]});this.groupingOverlay.render();var R=this.groupingOverlay.domNode;J.attachEvent(R,"contextmenu",function(U){F.call(P,U,{position:J.getMousePosition(U,window)});});J.attachEvent(R,"click",function(U){var V=U.target;if(V.className.indexOf("mstrmojo-scrollbar")!==-1){J.stopPropogation(window,U);}});}this.setGroupingStatus(O?"":I);this._menuBtnInfo=this.menuBtnInfo;this.menuBtnInfo=null;this._originalContextMenu=this.shouldShowCustomizeContextMenu;this.shouldShowCustomizeContextMenu=function(){return false;};},setGroupingStatus:function K(O){var Q=this,P=[I,C];P.forEach(function(R){L.toggleClass(Q.groupingOverlay.domNode,R,O===R);});},endGrouping:function N(){L.removeClass(this.domNode,B);this.setGroupingStatus("");this.menuBtnInfo=this._menuBtnInfo;delete this._menuBtnInfo;this.shouldShowCustomizeContextMenu=this._originalContextMenu;delete this._originalContextMenu;},initializeDrag:function A(){return this.domNode.className.indexOf(B)===-1;},groupSelection:function D(){this.parent.groupSelection();},widgetResized:function M(){if(this._super){this._super();}var O=this.groupingOverlay;if(O){this.groupingOverlay.updateScrollbars();}}});}());(function(){mstrmojo.requiresCls("mstrmojo.Container","mstrmojo.ui.menus._HasMenuPopup","mstrmojo.vi.ui._HasMask","mstrmojo.vi._MonitorsAppState","mstrmojo.EditableLabel","mstrmojo.vi.ui.rw.PanelSelectorList","mstrmojo.ui.menus.MenuConfig");mstrmojo.vi.ui.rw.DockedPanelSelector=mstrmojo.declare(mstrmojo.Container,[mstrmojo.ui.menus._HasMenuPopup,mstrmojo.vi.ui._HasMask,mstrmojo.vi._MonitorsAppState],{scriptClass:"mstrmojo.vi.ui.rw.DockedPanelSelector",markupString:'<div id="{@id}" class="mstrmojo-DockedPanelSelector {@cssClass}" style="{@cssText}"><div class="panel-title"><div class="panel-name"></div><div class="panel-menu" mstrAttach:click>&nbsp;</div></div><div class="panel-list"></div><div class="panel-addBtn" mstrAttach:click></div><div class="mstrmojo-VIDND-mask"></div></div>',markupSlots:{titleNode:function D(){return this.domNode.firstChild.firstChild;},menuNode:function E(){return this.domNode.firstChild.lastChild;},containerNode:function C(){return this.domNode.childNodes[1];},addBtnNode:function H(){return this.domNode.childNodes[2];},maskNode:function I(){return this.domNode.lastChild;}},markupMethods:{onvisibleChange:mstrmojo.Widget.visibleMarkupMethod},children:[{scriptClass:"mstrmojo.EditableLabel",alias:"title",slot:"titleNode",editOnClick:false,editOnDoubleClick:true,onTextEditComplete:function A(M){if(M){var L=this.parent;L.parent.renamePanel(L.panels[L.list.getSelectedItems()[0].idx],this.text);this.set("title",this.text);}}},{scriptClass:"mstrmojo.vi.ui.rw.PanelSelectorList",alias:"list",slot:"containerNode",postselectionChange:function G(L){var M=L.added;if(M){var N=this.items[M[0]],O=this.parent;O.parent.selectPanel(N.id);O.title.set("text",N.n);O.title.set("title",N.n);}}}],init:function K(L){this._super(L);this.title.set("editOnDoubleClick",!mstrApp.isAppStatePresentation()&&mstrApp.allowWebDashboardDesign());},panels:null,onAppStateChange:function B(L){this._super(L);this.set("isMasked",mstrApp.isAppStateSelection());this.title.set("editOnDoubleClick",!mstrApp.isAppStatePresentation()&&mstrApp.allowWebDashboardDesign());},setPanels:function F(L,N){this.panels=L;this.set("visible",L.length>1);var M=this.list;M.set("items",L.map(function(P,O){return{n:P.titleText,id:P.k,idx:O};}));M.singleSelect(N);},onclick:function J(V){var P=V.getTarget(),S=this.parent;if(P===this.addBtnNode){S.addPanel();}else{if(P===this.menuNode){var R=new mstrmojo.ui.menus.MenuConfig(),N=mstrmojo.ui.PopupConfig.ENUM_CORNERS;R.hostId=this.id;R.hostElement=this.menuNode;R.setAlignment(N.TOP_LEFT,N.BOTTOM_LEFT);var Q=this.list,O=Q.items.length,U=Q.getSelectedItems()[0].idx,L=this.panels[U],M=this.title;R.addMenuItem(mstrmojo.desc(4719,"Add Panel"),"",function(){S.addPanel();});R.addMenuItem(mstrmojo.desc(3397,"Duplicate"),"dup",function(){S.duplicatePanel(L);});if(U){R.addMenuItem(mstrmojo.desc(5362,"Move Left"),"lft",function(){S.movePanel(U,U-1);});}if(U<O-1){R.addMenuItem(mstrmojo.desc(5363,"Move Right"),"rgt",function(){S.movePanel(U,U+1);});}R.addSeparator();R.addMenuItem(mstrmojo.desc(1388,"Rename"),"rnm",function(){M.set("isEditing",true);});if(O>1){R.addMenuItem(mstrmojo.desc(629,"Delete"),"cls",function(){S.deletePanel(L);});}this.openPopup(R.newInstance());}}}});}());(function(){mstrmojo.requiresCls("mstrmojo.dom","mstrmojo.css","mstrmojo.string","mstrmojo.Widget","mstrmojo.ui.menus._HasMenuPopup","mstrmojo.mstr.EnumDSSXMLObjectTypes","mstrmojo.mstr.EnumDSSXMLObjectSubTypes","mstrmojo.ME.MetricDataService");mstrmojo.requiresDescs(3224);var Z=["(",")","{","}","-","+","*","/","<",">","|","~",","],I={" ":true,"@":true},Y=null,X=mstrmojo.dom,K=mstrmojo.css,H=mstrmojo.mstr.EnumDSSXMLObjectTypes,D=mstrmojo.mstr.EnumDSSXMLObjectSubTypes,a=mstrmojo.ME.MetricDataService;function O(f){if(!Y){Y={};var e,d;for(e=0,d=Z.length;e<d;e++){Y[Z[e]]=true;}}return Y.hasOwnProperty(f);}function b(f){if(!f){return false;}var d=f.length,e,g;for(e=0;e<d;e++){g=f.charAt(e);if(g==="["){return false;}if(O(g)||I[g]){return true;}}return false;}function A(c){return b(c)?"["+c+"]":c;}function M(g){if(!g){return null;}var c=g.length,f=g.split("["),e=f.length,j,h;if(e===1){return g.split("@");}else{if(e===3){j=f[1];j="["+j.substring(0,j.length-1);h="["+f[2];}else{if(f[0].length===0){var k=f[1],d=k.indexOf("]");j="["+k.substring(0,d+1);if(d===k.length-1){return[j];}else{h=k.substring(d+2);}}else{var k=f[0];j=k.substring(0,k.length-1);h="["+f[1];}}}return[j,h];}var R={8:true,9:true,10:true};var C=function(d,c){return R[d]&&!/^\".*\"$/.test(c)?'"'+c+'"':c;};var F=function(d,c,e){var f=typeof e==="undefined"?true:R[e];if(c.length===2&&c==='""'){return c;}return d.tp===261&&c.length>=2&&f?(/^\s+$/.test(c.substr(1,c.length-2))?c:c.substr(1,c.length-2)):c;};mstrmojo.ME.MetricToken=mstrmojo.declare(mstrmojo.Widget,[mstrmojo.ui.menus._HasMenuPopup],{data:null,markupString:'<span id={@id} class="mstrmojo-token {@cssClass}" mstrAttach:contextmenu></span>',active:false,markupMethods:{ondataChange:function(){var e=this.data,f=this.isEmbeddedFilter(),c=f?"&nbsp;":mstrmojo.string.encodeHtmlString(String(e.v));if(e.v===","){this.domNode.innerHTML=c+"&nbsp;";}else{if(e.tp===259&&e.v==="Desc"){this.domNode.innerHTML="&nbsp;"+c;}else{if(a.isLogicOrCompFunc(e)){this.domNode.innerHTML="&nbsp;"+c+"&nbsp;";}else{this.domNode.innerHTML=c;}}}K.toggleClass(this.domNode,["mstr"],this.isMstrO());K.toggleClass(this.domNode,["nfn"],!this.isFunction());K.toggleClass(this.domNode,["invalid"],e.sta===-1);K.toggleClass(this.domNode,["embeddedFilter"],f);},onactiveChange:function(){mstrmojo.css.toggleClass(this.domNode,["active"],this.active);}},oncontextmenu:function V(c){this.closePopup();if(this.isEmbeddedFilter()){var e=new mstrmojo.ui.menus.MenuConfig({position:X.getMousePosition(c.e,c.hWin),isHostedWithin:false,alignWithAnchor:true});var d=this;e.addMenuItem(mstrmojo.desc(3224,"Edit..."),"",function(){var f=d.parent;if(f&&f.editEmbeddedFilterToken){f.editEmbeddedFilterToken(d);}});this.openPopup(e.newInstance());}},isMstrO:function W(){return !!this.data.oi||!!this.data.rfd;},isFunction:function B(){return this.isMstrO()&&(this.data.oi&&this.data.oi.t===H.Function);},isEmbeddedFilter:function J(){var e=this.data.oi,d=e&&e.t,c=e&&e.st;return this.isMstrO()&&d===H.Filter&&c===D.Filter&&e.isEmbedded;},brackets:A,length:function E(){return this.isEmbeddedFilter()?1:this.data.v.toString().length;},isDelimiter:function U(){return this.data.isDelimiter||(this.length()===1&&O(this.data.v));},split2Tokens:function L(g){var f=this.data,e=f&&f.v.toString(),h=e.substring(0,g),c=e.substring(g);return[{v:h,isNew:true},{v:c,isNew:true}];},mergeTo:function N(e){var g=this.data,f=g&&g.v.toString(),c=e.data.v.toString();return{v:f+c,isNew:true};},brackets:A,setItemInfo:function S(c){var e=this.data;e.v=this.brackets(c.n);e.oi=c;e.sta=1;e.isNew=true;this.set("data",e);this.paint();},spliceContent:function P(k,h,e){var j=this.data,g=j&&j.v.toString(),l=g.substring(0,k);h=(h===null||h===undefined)?(g.length-k):h;var c=g.substring(k+h),f=l+(e||"")+c;j.v=f;j.isNew=true;j.sta=1;j.ift=(this.isAttributeToken()||j.at)&&(j.v.indexOf("@")>=0);if(j.ift){j.at=j.oi||j.at;}else{delete j.at;}delete j.oi;delete j.exv;delete j.extp;delete j.tp;this.set("data",j);this.paint();},isAttributeToken:function G(){return this.data&&this.data.oi&&this.data.oi.t===H.Attribute;},setFormInfo:function Q(e){var f=this.data,c=f.oi||f.at;f.v=this.brackets(c.n)+"@"+this.brackets(e.n);f.exv=e.did;f.extp=8;f.sta=1;f.isNew=true;f.oi=f.at;delete f.at;this.set("data",f);this.paint();}});mstrmojo.ME.MetricToken.isDelimiter=O;mstrmojo.ME.MetricToken.brackets=A;mstrmojo.ME.MetricToken.splitAttrAndAttrForm=M;mstrmojo.ME.MetricToken.quotes=C;mstrmojo.ME.MetricToken.unquotes=F;mstrmojo.ME.MetricToken.QUOTABLE_DATATYPES=R;mstrmojo.ME.MetricToken.argDelimiter={".":",",",":";"}[mstrConfig&&mstrConfig.decimalSep]||",";})();(function(){mstrmojo.requiresClsP("mstrmojo","Widget","css","dom","num");var I=mstrmojo.css,D=mstrmojo.dom,G=mstrmojo.num;mstrmojo.threshold.ColorMarker=mstrmojo.declare(mstrmojo.Widget,[mstrmojo.ui.menus._HasMenuPopup],{scriptClass:"mstrmojo.threshold.ColorMarker",markupString:'<div class = "marker {@cssClass}" id="{@id}" style="{@cssText}" mstrAttach:contextmenu,mousedown,mouseover,mouseout></div>',markupMethods:{onleftChange:mstrmojo.Widget.leftMarkupMethod},hovered:false,selected:false,index:undefined,position:0,updatePosition:function E(M){this.set("position",M);},compValue:undefined,updateCompValue:function K(M){this.set("compValue",M);},realValue:undefined,updateRealValue:function F(M){this.set("realValue",M);},select:function(){this.set("selected",true);},unselect:function(){this.set("selected",false);},onselectedChange:function C(M){if(M.valueWas===false&&M.value===true){I.toggleClass(this.domNode,"selected",true);this.parent.onMarkerSelected(this.index);}else{I.toggleClass(this.domNode,"selected",false);this.parent.onMarkerUnselected(this.index);}this.parent.onMarkerUnhovered(this.index);},oncontextmenu:function H(N){D.preventDefault(window,N.e);var M=this,O=M.parent.parent;var P=new mstrmojo.ui.menus.MenuConfig({position:D.getMousePosition(N.e,N.hWin),isHostedWithin:false});P.addMenuItem(mstrmojo.desc(629,"Delete"),"",function(){O.bands.remove(M.index);O.markers.remove(M.index);O.update();});this.openPopup(P.newInstance());},onmousedown:function B(M){this.set("selected",!this.selected);},onmouseover:function L(){this.set("hovered",true);},onmouseout:function J(){this.set("hovered",false);},onhoveredChange:function A(M){if(!this.selected){if(M.valueWas===false&&M.value===true){I.toggleClass(this.domNode,"selected",true);this.parent.onMarkerHovered(this.index);}else{I.toggleClass(this.domNode,"selected",false);this.parent.onMarkerUnhovered(this.index);}}}});}());(function(){mstrmojo.requiresCls("mstrmojo.dom","mstrmojo.GraphBase","mstrmojo._Formattable","mstrmojo._IsSelectorTarget","mstrmojo.tooltip","mstrmojo.vi.enums.EnumFeatures");var S=mstrmojo.dom,L=mstrmojo.array,J=mstrmojo.mstr.EnumDSSXMLDrillType,R={SORT:8},C=mstrmojo.vi.enums.EnumFeatures;function B(Z){var a=Z.getFormats();if(!a.width&&"gp" in a){a=a.gp;}Z.resizeForDisplayState(parseInt(a.height,10),parseInt(a.width,10),false);}function V(a){var Z="";switch(a){case J.DssXmlDrillToChild:Z="drillDown";break;case J.DssXmlDrillToParent:Z="drillUp";break;case J.DssXmlDrillToTemplate:Z="drillTemplate";break;}return Z;}function F(a){var Z=S.position(this.domNode,true),b=S.getMousePosition(a);return{x:b.x-Math.floor(Z.x),y:b.y-Math.floor(Z.y)};}function M(Z,b){var c={x:b.offsetX,y:b.offsetY},a=Z.coords.split(",");switch(Z.shape){case"rect":case"poly":c=F.call(this,b);break;case"circle":c.x=a[0];c.y=a[1];break;}return{x:parseInt(c.x,10),y:parseInt(c.y,10)};}function I(h,g){var b=S.eventTarget(g,h),f=b&&b.parentNode,j=f&&f.children,Z=[],d=b.getAttribute("coords");if(j&&!!d){for(var a=0;a<j.length;++a){if(j[a]&&j[a].getAttribute&&j[a].getAttribute("coords")==d){Z.push(j[a]);}}}return Z;}function E(c,d,b,a,Z){return function(){var g=F.call(c,d),f={taskId:"getElementFromGraph",msgID:c.model.docModel.mid,nodeKey:c.node.k,sliceID:c.node.data.sid,x:parseInt(g.x),y:parseInt(g.y)},e={success:function(j){var h={mix:a,els:j.els},k=c.model.getLinkActionImpl(h,b,Z);c.controller.onLink(c,k);},failure:function(h){}};mstrmojo.xhr.request("POST",mstrConfig.taskURL,e,f);};}function N(a,Z){return((((a&&a.actions)||0)&Z)>0);}mstrmojo.DocXtabGraph=mstrmojo.declare(mstrmojo.GraphBase,[mstrmojo._Formattable,mstrmojo._IsSelectorTarget,mstrmojo.ui.menus._HasMenuPopup],{scriptClass:"mstrmojo.DocXtabGraph",cssClassPrefix:"mstrmojo-DocXtabGraph",areaMarkup:'<area shape="{@shape}" coords="{@coords}" ttl="{@tooltip}" aid="{@aid}" onclick="mstrmojo.all[\'{@id}\'].onClickArea(this, event);" oncontextmenu="mstrmojo.all[\'{@id}\'].onContextMenu(this, event);" onmousemove="mstrmojo.all[\'{@id}\']._updateTooltip(event, self);" {@extra}/>',_att:"",markupSlots:{imgNode:function(){return this.domNode.childNodes[1];},mapNode:function(){return this.domNode.childNodes.length>2?this.domNode.childNodes[2]:null;},textNode:function(){return this.domNode.firstChild;}},formatHandlers:{domNode:["RW","B","background-color","fx"]},markupMethods:{onvisibleChange:function(){this.domNode.style.display=(this.visible)?"block":"none";}},onClickArea:function U(b,d){d=d||window.event;var k=F.apply(this,[d]),f=this.defn,Z=S.position(this.domNode,true),a=this.as[b.getAttribute("aid")],j=this.k,h=k.x,g=k.y,c={getBoundingClientRect:function(){var l=Z.x+h,e=Z.y+g;return{left:l,top:e,right:l+1,bottom:e+1};},w:this};this.showInfoWin(a.ifw,a.tks,c);this.model.docModel.slice({type:parseInt(f.t,10)||mstrmojo.EnumRWUnitType.GRAPH,src:j,ck:f.ck,gk:j,tks:a.tks,cks:a.cks,sid:this.node.data.sid,x:h,y:g,anchor:c,tty:a.tty});},onContextMenu:function Q(d,k){k=k||window.event;var m=this,p=this.getFormats(),Z=parseInt(p.height,10),h=parseInt(p.width,10),c=this.as[d.getAttribute("aid")],l=c.lm||[],g=c.dp||[];mstrmojo.dom.preventDefault(window,k);var j=new mstrmojo.ui.menus.MenuConfig({hostId:this.id,isHostedWithin:false,hostElement:this,position:{x:k.pageX,y:k.pageY}});if(l.length!==0){j.addPopupMenuItem(mstrmojo.desc(5752,"Links"),this.id,function(){var t=new mstrmojo.ui.menus.MenuConfig();for(var r=0;r<l.length;r++){var e=l[r].links;for(var q=0;q<e.length;q++){t.addMenuItem(e[q].n||e[q].url||(e[q].target&&(e[q].target.n||e[q].target.did)),"",E(m,k,c,r,q));}}return t;});}var o=function o(t){var r=t.onDemandDrillItems;var q=t.onDemandDrillDynamicItems;if((!t.onDemandDrillItems||t.shouldUpdateDrillMenus)&&!t.loadingDCM){t.loadingDCM=true;delete t.shouldUpdateDrillMenus;var v=new mstrmojo.SimpleXHR({async:false});v.request("POST",mstrConfig.taskURL,{success:function u(x){var w=x.dynamicMenus[0];if(w&&w.items){q=w.items;}r=x.menuItems;t.onDemandDrillItems=r||[];t.onDemandDrillDynamicItems=q||[];delete t.loadingDCM;}},{taskId:"RWOnDemandDrill",styleName:"OndemandDrillContextMenusStyle",viewMode:2,docGridKey:t.k,rwb:mstrApp.docModel.bs});}var e=[];L.forEach(q,function(AB){var w=AB.idx,x=r[w],AA=JSON.parse(x.subMenuIndices||"[]");if(AA.length>0){var z=[];mstrmojo.array.forEach(AA,function(AC){z.push(r[AC]);});x.items=z;}e.push(x);});return e;};var f=o(this.model.xtab);if((g.length>0||f.length>0)&&mstrmojo.resolveFeature(C.WEB_DRILL_AND_LINK)){var n=M.call(this,c,k);var b=this.model.data.sid;j.addPopupMenuItem(mstrmojo.desc(145,"Drill"),this.id,function(){var q=new mstrmojo.ui.menus.MenuConfig({menuCssClass:"drill",isHostedWithin:false,supportsScroll:true,maxHeight:mstrmojo.dom.windowDim().h-50});L.forEach(g,function(t){if(mstrApp.isDossier&&!t.dwi){return ;}q.addMenuItem(t.n,V(t.tp),function r(){m.model.xtab.shouldUpdateDrillMenus=true;m.controller.onDrillGraph(m,{displayType:t.displayMode||2,drillPathKey:this.ctxt.key,x:n.x,y:n.y,graphHeight:Z,graphWidth:h,n:this.ctxt.n,isWithin:this.ctxt.dwi,sliceId:b},{});},t);});var e=function(){m.model.xtab.onDemandDrillItems=null;m.model.xtab.onDemandDrillDynamicItems=null;};L.forEach(f,function(r){if(mstrApp.isDossier&&!L.some(r.items,function(t){return(t.within);})){return ;}q.addPopupMenuItem(r.n,"",function(){var t=new mstrmojo.ui.menus.MenuConfig({menuCssClass:"drill",isHostedWithin:false,supportsScroll:true,maxHeight:350});L.forEach(r.items,function(u){if(mstrApp.isDossier&&!u.within){return ;}t.addMenuItem(u.n,V(u.dt),function(){m.model.xtab.shouldUpdateDrillMenus=true;var v=this.ctxt;m.controller.onDrillGraph(m,{displayType:u.displayMode||2,drillPathKey:v.k,x:n.x,y:n.y,graphHeight:Z,graphWidth:h,n:this.ctxt.n,isWithin:v.within,sliceId:b},{});e();},u);});return t;});});return q;});}if(N(this.model.data,R.SORT)){if(!mstrApp.isDossier){j.addMenuItem(mstrmojo.desc(6089,"Sort graph"),this.id,function(){m.controller.onGetAdvSortData(m,1,-1);});}}if(mstrmojo.resolveFeature("use-view-filter-editor")){j.addMenuItem(mstrmojo.desc(3938,"edit view filter..."),this.id,function(){m.controller.onShowFilterEditor(m);});}if(j.hasMenuItems()){var a=j.newInstance();if(this._lastOpened){mstrmojo.css.removeClass(this._lastOpened?this._lastOpened.popupConfig.hostElement:null,"open");mstrmojo._HasPopup.closePopup.call(this);}mstrmojo._HasPopup.openPopup.call(this,a);mstrmojo.css.addClass(a?a.popupConfig.hostElement:null,"open");}return false;},showInfoWin:function P(d,e,a){var Z=this.model.docModel,c=[].concat(Z.getTargetInfoWin(d)).concat(Z.getTargetInfoWin(e));if(c&&c.length){for(var b=0;b<c.length;b++){Z.showInfoWin(c[b],a,"h");}}},showTooltip:function D(b,a){this._updateTooltip(b,a);var Z=I(b,a);if(Z&&Z.length>1){mstrmojo.DocXtabGraph.multiTooltip.open(this,b,a,Z);}else{this._super(b,a);}},_updateTooltip:function O(Z,a){this.updatingTooltipHelper(S.eventTarget(a,Z),F.apply(this,[Z]));},hideTooltip:function H(c,b){var a=S.eventTarget(b,c);if(a.getAttribute("aid")===this.cAreaIdx){this.cAreaIdx=-1;var Z=I(c,b);if(Z&&Z.length>1){mstrmojo.DocXtabGraph.multiTooltip.close(this,c,b,Z);}else{this._super(c,b);}}},update:function K(Z){this.node.data=Z.data;this.as=Z.data.as;var p="\u001E",c=this.model.docModel,l=c.getCGBMap&&c.getCGBMap(),b=this.as||[],g,e;for(g=0;g<b.length;g++){var n=b[g],f=n&&n.tgbs;if(f){var h=f.split(p);var o={};for(e=0;e<h.length;e++){var d=l&&l[h[e]];if(d){o[d]=true;}else{o[h[e]]=true;}}n.tks=mstrmojo.hash.keyarray(o).join(p);}}this.eg=Z.data.eg;this.gridInfo=Z.data.gsi;if(Z.defn&&Z.defn.tooltip){this.defaultTooltip=Z.defn.tooltip;}var c=this.model;if(c){c.set("data",Z.data);}},retrieveGraphSrc:function G(a,Z){var c=mstrConfig.taskURL+"?taskId=getRWGraphImage&taskEnv=xhr&__ts__="+(new Date().getTime())+"&messageID="+this.model.docModel.mid+"&nodeKey="+this.k+"&sliceID="+parseInt(this.node.data.sid,10)+"&imgType=4&width="+parseInt(Z,10)+"&height="+parseInt(a,10),b=this.imgNode;if(b.src!==c){b.src=c;}},resize:function(){B(this);},resizeForDisplayState:function Y(b,a,e){var d=this.getFormats(),c=this.imgNode;if(e){var Z=this.domNode.style;Z.top=d.top;Z.left=d.left;Z.height=d.height;Z.width=d.width;}if(c){c.style.height=b+"px";}if(this.eg===undefined){if(b){this.retrieveGraphSrc(b,a);this.refreshMap();}}}});function X(Z){var b=Z&&Z.getAttribute&&Z.getAttribute("coords");b=(b&&b.split(","))||[];switch(b.length){case 3:return b[2]*2;case 4:return b[2]-b[0];default:return 10;}}function A(b){var a=[],f=document.body.offsetWidth,Z=document.body.offsetHeight,g=0,d=0,j=W[0]&&W[0].domNode?W[0].domNode.offsetLeft:0,h=W[0]&&W[0].domNode?W[0].domNode.offsetTop:0,m=Math.ceil(W.length/2),c=5,l=function(o,n){if(o+b+n+c>f){return f-b-n-c;}else{if(W.length>1&&o-n-c<0){return n+c;}}return o;},k=function(q,o,n){q+=o;var p=n==1?o:(n*o+(n-1)*c)/2;if(p>q){return 0;}else{if(p+q>Z){return Z-p*2;}else{return q-p;}}};for(var e=0;e<W.length;++e){g=Math.max(g,W[e].containerNode.offsetWidth);d=Math.max(d,W[e].containerNode.offsetHeight);}j=l(j,g);h=k(h,d,m);for(var e=0;e<W.length;++e){if(e%2==0){a.push({l:j+b+c,t:h});}else{a.push({l:j-W[e].containerNode.offsetWidth-c,t:h});h+=d+c;}}return a;}var W=[];mstrmojo.DocXtabGraph.multiTooltip={_posMultiTp:function(a){for(var Z=0;Z<W.length;++Z){W[Z].domNode.style.left=a[Z].l+"px";W[Z].domNode.style.top=a[Z].t+"px";}},open:function(k,g,f,a,Z){if(!Z){Z={};}Z.e=g;Z.win=f;var c=0;if(a&&a.length){c=X(a[0]);}for(var b=0;b<a.length;++b){var j=W[b];if(!j||!mstrmojo.all[j.id]){j=new mstrmojo.Tooltip();var d=0,h=this;j.optimizePos=function(){d++;if(d>=W.length){d=0;h._posMultiTp(A(c));}};W.push(j);}k.richTooltip.content=a[b]&&a[b].getAttribute("ttl");j.open(k,Z);}},close:function(){for(var Z=W.length-1;Z>=0;--Z){W[Z].close();}W=[];}};}());(function(){mstrmojo.requiresCls("mstrmojo.Widget","mstrmojo._HasLayout","mstrmojo._HasSuggestion","mstrmojo.css");var G=mstrmojo.css,D="clear";function E(){this.searchTriggered(this.inputNode.value);}mstrmojo.ui.SearchBox=mstrmojo.declare(mstrmojo.Widget,[mstrmojo._HasLayout],{scriptClass:"mstrmojo.ui.SearchBox",markupString:'<div id={@id} class="mstrmojo-ui-SearchBox cf {@cssClass}" style="{@cssText}"><input class="mstrmojo-ui-sb-input" type="text" autocomplete="off" autocorrect="off" autocapitalize="off" spellcheck="false" mstrAttach:keyup,blur,focus/><div class="mstrmojo-ui-sb-btn" mstrAttach:click ></div></div>',markupSlots:{inputNode:function I(){return this.domNode.firstChild;},searchNode:function B(){return this.domNode.lastChild;}},markupMethods:{onvisibleChange:mstrmojo.Widget.visibleMarkupMethod},layoutConfig:{h:{inputNode:"20px",searchNode:"20px"},w:{inputNode:"100%",searchNode:"22px"},xt:true},getLayoutOffsets:function(){return{w:2,h:0};},searchNode:undefined,inputNode:undefined,searchDelay:-1,init:function M(P){this._super(P);var O=this.searchDelay;if(O===-1||isNaN(O)){this.searchDelay=parseInt(mstrApp.getSearchAutoCompleteDelay(),10);}},onfocus:function N(O){var P=O.getTarget();if(P===this.inputNode){this.inputNode.placeholder="";G.addClass(this.domNode,"onInputFocus");}},onblur:function H(O){var P=O.getTarget();if(P===this.inputNode){this.inputNode.placeholder="Search...";G.removeClass(this.domNode,"onInputFocus");}},onclick:function L(O){var P=O.getTarget();if(P===this.searchNode){if(this._hasText){this.clearSearch();}else{E.call(this);}}},onkeyup:function A(Q){var P=Q.hWin,U=Q.e||P.event;if(U.keyCode===27){this.clearSearch();return ;}var S=this,O=this.text,V=this.text=this.inputNode.value,R=this._hasText=V.length>0;if(O!==V){G.toggleClass(this.searchNode,[D],R);window.clearTimeout(this._searchTimeoutId);this._searchTimeoutId=window.setTimeout(function(){E.call(S);},this.searchDelay);}},unrender:function F(){this.text="";this._super();},clearSearch:function J(O){this.text=this.inputNode.value="";G.removeClass(this.searchNode,[D]);delete this._hasText;if(!O){E.call(this);}this.postClearSearch();},isClear:function C(){return !this.text||this.text.length===0;},postClearSearch:mstrmojo.emptyFn,searchTriggered:function K(O){}});}());(function(){mstrmojo.requiresCls("mstrmojo.hash","mstrmojo.array","mstrmojo._HasSuggestion");var F=-1,E=0,D=1;mstrmojo._ValidateSuggestions=mstrmojo.provide("mstrmojo._ValidateSuggestions",mstrmojo.hash.copy(mstrmojo._HasSuggestion,{_mixinName:"mstrmojo._ValidateSuggestions",itemValidationField:"did",verifyObject:function C(J,H){var M=this.candidates,L;if(M){var I=M.items,G=mstrmojo.array.find(I,this.itemValidationField,H.data[this.itemValidationField]);G=G>-1?G:mstrmojo.array.find(I,this.itemField,J);if(G>-1){H.updateData(I[G]);L=E;}else{if(M.isComplete){L=D;}}}if(L!==undefined){return L;}var K=this._vqueue=this._vqueue||[];K.push({pattern:J,id:H.data[this.itemIdField]});if(!this._vInProgress){this.verifyNextCandidate();}return F;},verifyNextCandidate:function B(){var G=this._vqueue;if(!G||G.length===0){this._vInProgress=false;return ;}this.verifyCandidate(G.shift());},verifyCandidate:function A(H){var G=this;this._vInProgress=true;this.getCandidatesThroughTaskCall({pattern:H.pattern,blockBegin:1,blockCount:G.noCache?-1:this.suggestCount,isVerify:true},{success:function(N){var K=G.ctxtBuilder.itemWidgets,J=K&&K.length,O,M;for(M=0;M<J;M++){if(K[M].data[G.itemIdField]===H.id){O=K[M];break;}}if(!O){return ;}var L=N.items;if(L&&L.length===1){O.updateData(L[0]);}else{if(L&&L.length>1){var I=mstrmojo.array.find(L,"did",O.data.did);if(I>-1){O.updateData(L[I]);}else{O.set("state",D);}}else{O.set("state",D);}}},failure:function(I){mstrmojo.alert(I.getResponseHeader("X-MSTR-TaskFailureMsg"));},complete:function(){G.verifyNextCandidate();}});}}));mstrmojo._ValidateSuggestions.ENUM_STATES={UNDETERMINED:F,VALID:E,INVALID:D};}());(function(){mstrmojo.requiresCls("mstrmojo.Container","mstrmojo._HasEditableText","mstrmojo._Formattable","mstrmojo.UUID","mstrmojo.Editor","mstrmojo.vi.ui.TextBoxURLEditor","mstrmojo.css","mstrmojo.models.FormatModel","mstrmojo.hash");var I=mstrmojo.hash,D=mstrmojo.css,d="\u01EF",M="\u00df",k="user",n="800000",F="8",S="https://www.microstrategy.com",a=mstrmojo.array,B="13",b=mstrmojo.models.FormatModel.ENUM_PROPERTY_NAMES,H=false;mstrmojo.vi.ui.rw.DocQuillTextField=mstrmojo.declare(mstrmojo.Container,[mstrmojo._Formattable],{scriptClass:"mstrmojo.vi.ui.rw.DocQuillTextField",markupString:'<div id="{@id}" class="mstrmojo-DocQuillTextField {@cssClass}" style="{@domNodeCssText}" mstrAttach:click,blur ></div>',hasActiveLink:mstrmojo.emptyFn,stringToSend:"",currentRawDeltaopsArr:null,isQuillselected:false,cachedDelta:null,cacheGProps:null,dirCachDel:null,savedCurPos:null,isQuill:true,hlText:null,hasFocus:false,arrFonts:["arialblack","arialnarrow","arialunicodems","batang","bookantiqua","bookmanoldstyle","bookshelfsymbolone","bookshelfsymboltwo","bookshelfsymbolthree","comicsansms","couriernew","garamond","haettenschweiler","helvetica","impact","lucidaconsole","lucidasansunicode","mapsymbols","marlett","monotypecorsiva","monotypesorts","msgothic","msoutlook","mssansserif","mtextra","symbol","tahoma","timesnewroman","trebuchetms","verdana","webdings","windings","windings2","windings3"],stringsOfFonts:["Arial Black","Arial Narrow","Arial Unicode MS","Batang","Book Antiqua","Bookman Old Style","Bookshelf Symbol 1","Bookshelf Symbol 2","Bookshelf Symbol 3","Comic Sans MS","Courier New","Garamond","Haettenschweiler","Helvetica","Impact","Lucida Console","Lucida Sans Unicode","Map Symbols","Marlett","Monotype Corsiva","Monotype Sorts","MS Gothic","MS Outlook","Microsoft Sans Serif","MT Extra","Symbol","Tahoma","Times New Roman","Trebuchet MS","Verdana","Webdings","Windings","Windings 2","Windings 3"],arrFontSizes:["size8","size9","size10","size11","size12","size14","size16","size18","size20","size22","size24","size36","highlight","nohighlight"],arrFontSzNums:[8,9,10,11,12,14,16,18,20,22,24,36],getRawText:function W(){return this.quillInstance.editor.delta;},init:function g(p){this._super(p);var o;if(!H){o=mstrmojo.getJsRoot();mstrmojo.requiresDepLib(o+"libraries/quill/quill.js");mstrmojo.insertCSSLinks([o+"libraries/quill/quill.bubble.css"]);H=true;}},setUpFontsSizes:function P(){var p=Quill["import"]("formats/font"),o=Quill["import"]("formats/size");p.whitelist=this.arrFonts;Quill.register(p,true);o.whitelist=this.arrFontSizes;Quill.register(o,true);},postBuildRendering:function N(){if(this._super){this._super();}this.domNode.addEventListener("blur",function(AK){},true);var x=typeof this.quillInstance==="undefined",AI;if(!x){AI=this.quillInstance.editor.delta;}else{AI=null;}this.setUpFontsSizes();this.quillInstance=new Quill("#"+D.cssEscape(this.id),{modules:{toolbar:[],formula:false,syntax:false},placeholder:"Enter rich text here, and highlight and format to edit...",theme:"bubble"});if(!this.quillInstance.editor){return ;}var AF=this.quillInstance,t=AF&&AF.editor,AE=AF.root,z=this,AA=z.parent,AD=this.node,AJ=AD&&AD.data,AB=AA.ctrlOverlay;AE.tabindex="1";AE.onpaste=function(AK){AK.preventDefault();AK.cancelBubble=true;};AE.onfocus=function(AK){if(mstrApp.isAppStatePresentation()){return ;}AK.cancelBubble=true;};AE.onblur=function(AO){if(mstrApp.isAppStatePresentation()){return ;}AO.preventDefault();AO.stopPropagation();z.hlText=AF.getSelection();var AK=z.hlText,AM="",AN=t.delta.ops;a.forEach(AN,function(AR){AM+=AR.insert;AM+=M;});var AP=z.utf8_to_b64(JSON.stringify(AN));AM+=d+AP;var AQ=z.utf8_to_b64(z.domNode.style.background);AM+=d+AQ;var AL=(z.node.data.rv&&z.node.data.rv!==AM);if(z.node.data.rv===undefined){AL=true;}if(AL){z.dirCachDel=null;}AA.textEdited(AM,AL,"");z.updatedirCachDel();AA.showControlOverlay();z.isEditing=false;};AF.on("selection-change",function(AK,AO,AN){var AM=z.controller,AL=AM&&AM.getViPanel("prps");if(AL!==null){AM.getViPanel("prps").refresh();}});AA.showControlOverlay();AB.domNode.onclick=mstrmojo.emptyFn();var u,q=this.dirCachDel,AG=this.cacheGProps,p,AC,AH,r,w;AB.domNode.ondblclick=function(){if(!mstrApp.isAppStatePresentation()){AA.hideControlOverlay();z.isEditing=true;if(AJ&&AJ.rv){if(q&&!a.isArray(q.ops)){AF.setContents(q);}else{u=(AJ.rv).split(d);var AL=z.b64_to_utf8(u[1]),AK=JSON.parse(AL);if(a.isArray(AK)){AF.setContents(AK);z.cachedDelta=AK;z.cacheGProps=z.b64_to_utf8(u[2]);z.domNode.style.background=AG;}}}}};if(mstrApp.isAppStatePresentation()){if(AJ.v){p=(AJ.v).split(d);AC=this.b64_to_utf8(p[1]);r=JSON.parse(AC);w=p[0].split(M);r=this.resolveDelta(r,w);if(r){AF.setContents(r);}this.cacheGProps=this.b64_to_utf8(p[2]);this.domNode.style.background=this.cacheGProps;AE.style["user-select"]="none! important";}AA.showControlOverlay();if(AA.ctrlOverlay.domNode.style.visibility!=="visible"){AA.ctrlOverlay.domNode.style.visibility="visible";}}else{if(AI!==null&&!AJ.rv){AF.setContents(AF.editor.delta);}else{if(AJ.v){p=(AJ.v).split(d);AC=this.b64_to_utf8(p[1]);r=JSON.parse(AC);w=p[0].split(M);r=this.resolveDelta(r,w);if(r){AF.setContents(r);}this.cacheGProps=this.b64_to_utf8(p[2]);this.domNode.style.background=this.cacheGProps;}else{if(this.isQuillselected&&this.dirCachDel){AA.hideControlOverlay();z.isEditing=true;AF.setContents(this.dirCachDel);var v=this.cacheGProps,o=this.savedCurPos;if(v){this.domNode.style.background=v;}if(o&&o>=0){this.isEditing=true;}}else{if(AI&&AJ&&AJ.rv&&this.isQuillselected){u=(AJ.rv).split(d);AH=this.b64_to_utf8(u[1]);AF.setContents(JSON.parse(AH));this.cachedDelta=JSON.parse(AH);this.cacheGProps=this.b64_to_utf8(u[2]);this.domNode.style.background=this.cacheGProps;}}}}}},onTextEditComplete:function U(p,o){var r=this.parent,q=this.text;if(p){r.textEdited(q,p,o);this.updateScrollbars();}if(!q){r.updateOverlay();}},setDelta:function X(p){var o=this.quillInstance;if(o!==null){o.setContents(p);}},unrender:function A(o){if(this._super){this._super();}},onisEditingChange:function Y(o){if(this._super){this._super(o);}this.parent.set("useRichTooltip",!o.value);},updatedirCachDel:function e(){var o=this.quillInstance,p=o&&o.editor;if(!p||!p.delta){return ;}this.dirCachDel=p.delta;},clickOrUnclick:function G(o){var p=this.parent;p.showControlOverlay();this.isEditing=false;if(this.quillInstance&&o){this.onSelected();}else{this.onUnselected();}},onSelected:function m(){var q=this.quillInstance,v=q&&q.editor,r=this.node,x=this.parent,u=r&&r.data;this.isEditing=false;if(q){this.isQuillselected=true;if(u){if(u.v){var p=(u.v).split(d),z=this.b64_to_utf8(p[1]),AC=JSON.parse(z),t=p[0].split(M);AC=this.resolveDelta(AC,t);if(AC){q.setContents(AC);}this.cachedDelta=v.delta;this.cachedDelta.ops=JSON.parse(z);}else{if(u.rv){var w=(u.rv).split(d),AB=this.b64_to_utf8(w[1]),AA=v.delta;AA.ops=JSON.parse(AB);q.setContents(AA);this.cachedDelta=v.delta;this.cachedDelta.ops=JSON.parse(AB);var o=this.b64_to_utf8(w[2]);this.domNode.style.background=o;}}}}},onUnselected:function h(){var o=this.quillInstance,t=o&&o.editor,p=this.node,w=this.parent,r=p&&p.data;if(w.ctrlOverlay&&w.ctrlOverlay.visible){return ;}if(o){this.isQuillselected=false;var v="",x=this.dirCachDel&&this.dirCachDel.ops;a.forEach(x,function(AC){if(!AC.insert.image){v+=AC.insert;v+=M;}else{v+=JSON.stringify(AC.insert);v+=M;}});this.updatedirCachDel();var q=this.utf8_to_b64(JSON.stringify(x));v+=d+q;var AA=this.utf8_to_b64(this.domNode.style.background);v+=d+AA;this.cachedDelta=I.clone(t.delta);if(!r.v){return ;}var u=(r.v).split(d),z=this.b64_to_utf8(u[1]);this.cachedDelta.ops=JSON.parse(z);var AB=(JSON.stringify(t.delta.ops)!==JSON.stringify(this.cachedDelta.ops))||(AA!==u[2]);w.textEdited(v,AB,"");if(!AB){this.refresh();}}},saveWithoutUnselecting:function E(){var o=this.quillInstance,t=o&&o.editor,v=this.parent;if(o){this.isQuillselected=true;var r=o.getSelection();if(r){this.savedCurPos=r.index+r.length;}var p="",q=t.delta.ops;a.forEach(q,function(x){p+=x.insert;p+=M;});var u=this.utf8_to_b64(JSON.stringify(q));p+=d+u;var w=this.utf8_to_b64(this.domNode.style.background);p+=d+w;v.textEdited(p,true,"");this.updatedirCachDel();}},processLocalFormat:function c(z){var AA=z[0],AB,r=this.quillInstance,o=AA.oldValue,p=AA.newValue,q=o===false&&p===true,x=AA.propertyName,v={2:"center",1:"right",6:"justify",0:""},t;if(x===b.FONT_WEIGHT){r.format("bold",q);}else{if(x===b.FONT_STYLE){r.format("italic",q);}else{if(x===b.UNDERLINE){r.format("underline",q);}else{if(x===b.LINE_THROUGH){r.format("strike",q);}else{if(x===b.FONT_SIZE){var AD=parseInt(p.replace(/[^\d.]/g,"")),u=this.arrFontSzNums,w=this.arrFontSizes;for(t=0;t<u.length;t++){if(AD===u[t]){r.format("size",w[t]);break;}}}else{if(x===b.COLOR){r.format("color",p);}else{if(x===b.TEXT_ALIGN){r.format("align",v[p]);}else{if(x===b.BACKGROUND_COLOR){this.domNode.style.background=p;this.cacheGProps=p;}else{if(x===b.FONT_FAMILY){var AC=this.stringsOfFonts;for(t=0;t<AC.length;t++){if((p).indexOf(AC[t])!==-1){AB=t;break;}}if(AB||AB===0){r.format("font",this.arrFonts[AB]);}}}}}}}}}}},formatHlText:function O(AB){var AD=AB[0],AE,r=this.quillInstance,o=AD.oldValue,p=AD.newValue,q=o===false&&p===true,AA=AD.propertyName,t,AC=this.hlText,z=AC.index,x=AC.length,v={2:"center",1:"right",6:"justify",0:""};this.renderRVText();if(AA===b.FONT_WEIGHT){r.formatText(z,x,"bold",q);}else{if(AA===b.FONT_STYLE){r.formatText(z,x,"italic",q);}else{if(AA===b.UNDERLINE){r.formatText(z,x,"underline",q);}else{if(AA===b.LINE_THROUGH){r.formatText(z,x,"strike",q);}else{if(AA===b.FONT_SIZE){var AG=parseInt(p.replace(/[^\d.]/g,"")),u=this.arrFontSzNums,w=this.arrFontSizes;for(t=0;t<u.length;t++){if(AG===u[t]){r.formatText(z,x,"size",w[t]);break;}}}else{if(AA===b.COLOR){r.formatText(z,x,"color",p);}else{if(AA===b.TEXT_ALIGN){r.formatLine(z,x,"align",v[p]);}else{if(AA===b.BACKGROUND_COLOR){this.domNode.style.background=p;this.cacheGProps=p;}else{if(AA===b.FONT_FAMILY){var AF=this.stringsOfFonts;for(t=0;t<AF.length;t++){if((p).indexOf(AF[t])!==-1){AE=t;break;}}if(AE||AE===0){r.formatText(z,x,"font",this.arrFonts[AE]);}}}}}}}}}}},getSelectionLength:function Z(){var o=this.quillInstance.getSelection();return(o&&o.length)||0;},utf8_to_b64:function J(o){return window.btoa(encodeURIComponent(o));},b64_to_utf8:function j(o){return decodeURIComponent(window.atob(o));},resolveDelta:function C(q,p){var o=0;a.forEach(q,function(r){if(!(r.insert&&r.insert.image)){var u;try{u=JSON.parse(p[o]);if(u.image){r.insert=u;}}catch(t){}if(!u){q[o].insert=p[o];}}o++;});return q;},uploadImage:function f(){var r=this,t=document.createElement("input"),p=this.quillInstance,q=p&&p.editor,o=p.container;t.setAttribute("type","file"),t.setAttribute("accept","image/png, image/gif, image/jpeg, image/bmp, image/x-icon"),t.classList.add("ql-image"),t.addEventListener("change",function(){var u=new FileReader();u.onload=function(w){if(t.files[0].size<n){r.renderRVText();var v=q.delta.insert({image:w.target.result});p.setContents(v,k);t.value="";o.removeChild(t);r.saveWithoutUnselecting();}else{mstrmojo.alert(mstrmojo.desc(14650,"Cannot embed an image larger than ##MB. Your image is too large to be compressed up to ###MB").replace("###",F).replace("##",F));}};u.readAsDataURL(t.files[0]);});o.appendChild(t);t.click();},openURLBox:function R(o){var q=this;var p=new mstrmojo.vi.ui.TextBoxURLEditor({top:o.y+"px",left:o.x+"px",quill:q});p.open();this.setEditorFormatStyle(p);},retSelLink:function V(u){if(!u){return false;}var o=u.index,q=this.quillInstance,t=q.editor.delta.ops,r=0;while(r<t.length){var v=t[r];if(v&&v.insert.length<=o){o=o-v.insert.length;r++;}else{var p=v&&v.attributes;if(p&&p.link){return p.link;}return null;}}return null;},editURLLink:function Q(o,p){var t=this,q=new mstrmojo.vi.ui.TextBoxURLEditor({top:o.y+"px",left:o.x+"px",quill:t}),u=q.text;q.open();var r=u.inputNode;r.value=p;this.setEditorFormatStyle(q);},removeURLLink:function l(){this.quillInstance.format("link","");},setEditorFormatStyle:function K(o){var p=o.text.inputNode;p.onkeypress=function(r){var q=r.keyCode||r.which;if(q==B){o.close();}};p.placeholder=S;},renderRVText:function L(){var r=this.quillInstance,o=r.editor.delta,q=this,u=q.node.data,t=(u.rv).split(d),p=q.b64_to_utf8(t[1]);if(!a.isArray(p)){p=JSON.parse(p);}if(p.ops){o=p;}else{o.ops=p;}q.cacheGProps=q.b64_to_utf8(t[2]);q.domNode.style.background=this.cacheGProps;r.setContents(o);}});}());(function(){mstrmojo.requiresCls("mstrmojo.css","mstrmojo.array","mstrmojo.WidgetTree","mstrmojo.TreeBrowserNode","mstrmojo.TreeBrowserSelector");mstrmojo.TreeBrowserEnum={};var I=mstrmojo.TreeBrowserEnum;I.BRANCH_POLICY_TOGGLE="toggle";I.BRANCH_POLICY_SELECT="select";mstrmojo.TreeBrowser=mstrmojo.declare(mstrmojo.WidgetTree,null,{scriptClass:"mstrmojo.TreeBrowser",cssClass:"mstrmojo-TreeBrowser",browserNodeClass:mstrmojo.TreeBrowserNode,blockCount:30,noCheckBox:false,selectionAcrossBranch:true,branchClickPolicy:I.BRANCH_POLICY_TOGGLE,contentRetrieved:false,listSelector:mstrmojo.TreeBrowserSelector,handleNodeClicked:function(J){},getContentThroughTaskCall:function H(K,J){},isBranch:function F(J){},item2textCss:function C(J){return{"-1":"failed","-2":"loading","-3":"next","-4":"prev"}[J.st]||"";},failItemCreaterFunc:function(){return{n:"Loading Failed!",did:"-1",tp:"-1",st:"-1"};},loadingItemCreaterFunc:function(){return{n:mstrmojo.desc(5674,"Loading..."),did:"-2",tp:"-2",st:"-2"};},nextItemCreaterFunc:function(J){return{n:mstrmojo.desc(4507,"Next ##  item(s)...").replace("##",J?Math.min(J,this.blockCount):this.blockCount),did:"-3",tp:"-3",st:"-3"};},prevItemCreaterFunc:function(){return{n:mstrmojo.desc(4508,"Previous ##  item(s)...").replace("##",this.blockCount),did:"-4",tp:"-4",st:"-4"};},updateTreeContent:function(K,M){K.contentRetrieved=true;var L=M[K.itemChildrenField]||[],J=K.tree||K,O=M.bc,N=M.sz,P=M.bb;if(O!==-1){if(P+O<=N){L.push(J.nextItemCreaterFunc(N-P-O+1));}if((P-O)>-1){L.unshift(J.prevItemCreaterFunc());}}K.blockBegin=P;J.initializing=true;K.clearSelect(false);K.set("items",L);K.setSelectedItems(J.getTotalSelections(),true);J.initializing=false;if(J.onNodeExpand){J.onNodeExpand(K);}},getContent:function(K,O){var L=(K===this),J=this,P=function(Q){if(L){mstrmojo.css.removeClass(J.domNode,["loading"]);}J.updateTreeContent(K,Q);},M=function(Q){K.contentRetrieved=true;K.set("items",[J.failItemCreaterFunc()]);},N={success:P,failure:M};if(L){mstrmojo.css.addClass(J.domNode,["loading"]);}this.getContentThroughTaskCall({isRoot:L,data:K.data,blockBegin:L?0:(O||K.blockBegin),blockCount:J.blockCount},N);},postBuildRendering:function A(){this._super();if(!this.contentRetrieved){var J=this;setTimeout(function(){J.getContent(J);},0);}},itemFunction:function G(N,K,L){var J=L.tree||L,M=new J.browserNodeClass({data:N,state:0,parent:L,tree:J,multiSelect:L.multiSelect,text:N[L.itemDisplayField],textCssClass:J.item2textCss(N),items:N[L.itemChildrenField],itemIdField:L.itemIdField,itemDisplayField:L.itemDisplayField,itemIconField:L.itemIconField,itemChildrenField:L.itemChildrenField,itemFunction:L.itemFunction,listSelector:L.listSelector});return M;},clearTreeSelect:function E(){if(!this.selectionAcrossBranch){this._super();}else{var L=this._selectionParentNode,J=L&&L.length,K;for(K=0;K<J;K++){L[K].clearSelect();}this._selectionParentNode=null;this._totalSelections=null;}},onnodechange:function D(U){if(this.initializing){return ;}if(!this.selectionAcrossBranch){this._super(U);}else{this._totalSelections=this._totalSelections||[];this._selectionParentNode=this._selectionParentNode||[];var R=this._totalSelections,J=this._selectionParentNode,S=U.added,P=U.removed,Q=[],L=[],K=U.src,N,M,O,V;J.push(K);for(N=0,O=P&&P.length;N<O;N++){L.push(K.items[P[N]]);}mstrmojo.array.removeItems(R,"did",L);for(M=0,V=S&&S.length;M<V;M++){Q.push(K.items[S[M]]);}this._totalSelections=R.concat(Q);}},getTotalSelections:function B(){if(this.selectionAcrossBranch){return this._totalSelections||[];}var J=this.selectionParentNode;return J&&J.getSelectedItems();}});}());(function(){mstrmojo.requiresCls("mstrmojo.WidgetTree","mstrmojo.expr","mstrmojo.mstr.EnumNodeProperties","mstrmojo.AndOrNode","mstrmojo.ConditionNode");var H=mstrmojo.expr,B=mstrmojo.mstr.EnumNodeProperties,C=H.ET;function A(I){var K=I&&I.src,L=K&&K.data,J=L&&L.et;return(J in H.ETs);}function E(I){return I&&I.et===C.ANDOR&&!(I.node&B.CONDITION);}mstrmojo.FilterExpr=mstrmojo.declare(mstrmojo.WidgetTree,null,{scriptClass:"mstrmojo.FilterExpr",allowDrop:A,renderOnScroll:false,itemIdField:null,nodeClassMap:{14:mstrmojo.AndOrNode,"*":mstrmojo.ConditionNode},onBlankClick:function(I){this.clearTreeSelect();},onnodemousedown:function(J){var K=mstrmojo.dom.eventTarget(J.hWin,J.e),L=J.src,I=L.listMapper.findIndex(L,L.itemsContainerNode,K),M=I>=0?L.ctxtBuilder.itemWidgets[I]:null;if(!M||(M.isSelectableArea&&!M.isSelectableArea(K))){this.onBlankClick(J);}},getItemIdentityProp:function(I){return I.et;},itemFunction:function(N,K,O){var J=O.tree,L=J.getItemConfig(N,K,O),M=J.nodeClassMap,I=M[J.getItemIdentityProp(N)]||M["*"];return I&&(new I(L));},getItemConfig:function(L,I,M){var J=E(L),K=M.tree||M;return{data:L,tree:K,parent:M,bindings:{prefixedAndOrEditable:"this.parent.editable"},itemFunction:(J)?M.itemFunction:null,draggable:J?K.draggable:false,dropZone:J?K.dropZone:false,allowDrop:J&&K.dropZone?K.allowDrop:null,allowCopy:J?K.allowCopy:false,editable:K.isEditable?K.isEditable(L):K.editable,makeObservable:J&&M.makeObservable,onclick:K.onnodeclick,onadd:K.onnodeadd,onremove:K.onnoderemove};},getDragData:function(I){var K=this._super(I);if(K&&!K.html){var J=K.et&&H.ET2TGT[K.et];K.html=J?K[J]&&K[J].n||"":K.n||"";}return K;},newCondition:function G(M){M=M||{et:C.AQ};var L=this.selectionParentNode,I;L=(L&&L.hasRendered)?L:this;if(L!==this){I=L.add([M]);}else{var K=this.addCondition([M],null,true);I=K.index;L=K.widget;}var J={widget:L,index:I,data:M};if(this.onNew){this.onNew(J);}return J;},addCondition:function F(K,M){var N=this.items,J=N&&N.length,P=K&&K.length;if(!P){return null;}var L,I;if(J&&E(N[0])){L=this.ctxtBuilder.itemWidgets[0];I=L.add(K,null);}else{if(!J&&(P===1)){L=this;I=0;this.add(K,0);}else{if(J){var O=N[0];this.remove(O);K.unshift(O);}this.add([{et:C.ANDOR,fn:H.FN.AND,nds:K}],0);L=this.ctxtBuilder.itemWidgets[0];I=J?1:0;}}return{widget:L,index:I};},addSingleCondition:function D(J,I){var K=this.addCondition([J],I);return K.widget.ctxtBuilder.itemWidgets[K.index];},ondrop:function(L){if(this._super){this._super(L);}var J=this.items,I=J&&J.length,K=J.concat();if(I>1){if(J.remove){J.remove(0,J.length);}else{this.set("items",null);}this.add([{et:C.ANDOR,fn:H.FN.AND,nds:K}],0);}}});})();(function(){mstrmojo.requiresCls("mstrmojo.AndOrNode","mstrmojo.fe._IsRelationTreeNode","mstrmojo.expr","mstrmojo.dom","mstrmojo.array","mstrmojo.css");var L=mstrmojo.expr,N=mstrmojo.dom,C=mstrmojo.array,A=mstrmojo.css,F=mstrmojo.fe._IsRelationTreeNode.createSetHtml;var M=function(){var U="noRelationOperator",P=this[U],R=this.ctxtBuilder&&this.ctxtBuilder.itemWidgets||[],S=mstrmojo.array.filter(R,function(V){return V&&V[U]!==P&&V.data.et!==L.ET.RLS;}),O=S.length;for(var Q=0;Q<O;Q++){S[Q].set(U,P);}};mstrmojo.fe.AndOrNode=mstrmojo.declare(mstrmojo.AndOrNode,[mstrmojo.fe._IsRelationTreeNode],{scriptClass:"mstrmojo.fe.AndOrNode",markupString:'<div id="{@id}" class="mstrmojo-andor mstrmojo-AndOrNode {@cssClass}"  style="position:relative;{@cssText}" mstrAttach:mousedown><div class="mstrmojo-onhoverparent mstrmojo-andor-prefix" mstrAttach:click><span class="mstrmojo-textset mstrmojo-andor-prefix-text"></span><span class="mstrmojo-onhover-in mstrmojo-andor-tools {@cssClass}">{@_prefixAndOrToolsMarkup}</span></div><div class="mstrmojo-andor-top"></div><div class="mstrmojo-andor-contentsWrapper" style="position:relative"><div class="mstrmojo-andor-contents" style="position:relative;{@itemsContainerCssText}">{@itemsHtml}</div><div class="mstrmojo-ListBase2-dropCue mstrmojo-AndOrNode-dropCue {@cssClass}"><div class="mstrmojo-ListBase2-dropCue-inner mstrmojo-AndOrNode-dropCue-inner"></div></div></div><div class="mstrmojo-andor-bottom"></div></div>',getPrefixAndOrToolsMarkup:function(){return(F+this._super());},markupSlots:mstrmojo.hash.copy({createSetNode:function(){return this.domNode.firstChild.childNodes[1].firstChild;}},mstrmojo.hash.copy(mstrmojo.AndOrNode.prototype.markupSlots)),markupMethods:mstrmojo.hash.copy({onnoRelationOperatorChange:function(){A.toggleClass(this.prefixHoverNode,["noRelation"],this.noRelationOperator);}},mstrmojo.hash.copy(mstrmojo.AndOrNode.prototype.markupMethods)),removeSet:function G(P){var O=P.childIndex(),Q=P.data,R=[Q];if(O>=0){this.remove(O,true);if(Q.nds&&Q.nds.length>0){R=Q.nds;if(Q.not){R[0].not=true;}}else{delete Q.dmy;delete Q.relation;delete Q.applySubExpr;delete Q.relation;delete Q.useSchema;delete Q.dmt;}this.add(R,O);this.consolidate(false);}},createSet:function E(Q,O){var P=this._ndsToMove(this,Q);if(!P){return ;}this.remove(P.idxs,true);var V=P.nds,U;if(V){if(V.length>1){var S={et:L.ET.ANDOR,nds:V};S.fn=this.data.fn;V=[S];U=S.nds[0].not;}else{var W=V[0];if(W&&W.not&&W.et===L.ET.ANDOR){U=W.not;delete W.not;}}}if(O&&O.rq){var R;if(O.isMetric){R=O.cq;mstrmojo.hash.copyProps(["applySubExpr","dmy","dmt","relation","useSchema"],O.rq,R);}else{R=O.rq;R.nds=V;if(U){R.not=U;}}this.add([R],P.idxs[0]);}this.consolidate(false);},preclick:function H(O){var R=null,Q=N.eventTarget(O.hWin,O.e),P=this._super(O);if(N.contains(this.createSetNode,Q,true)&&!this.noRelationOperator){R="createSetOpt";}O.part=R||O.part;return P;},preadd:function I(O){if(this._super){this._super(O);}this.updateRelationOperator();},preremove:function K(O){if(this._super){this._super(O);}this.updateRelationOperator();},consolidate:function B(){this._super();this.updateRelationOperator();},postBuildRendering:function J(){var O=this._super();this.updateRelationOperator();return O;},updateRelationOperator:function D(){var O=this.ctxtBuilder&&this.ctxtBuilder.itemWidgets||[],P=!!C.filterOne(O,function(R){return R&&(R.data.et===L.ET.RLS||(R.data.et===L.ET.ANDOR&&R.noRelationOperator));}),Q=this.parent;this.set("noRelationOperator",P);M.call(this);if(Q&&Q.hasRendered&&Q.updateRelationOperator){Q.updateRelationOperator();}},onmouseover:function(){this.toggleGroupBorder(true);},onmouseout:function(){this.toggleGroupBorder(false);}});})();(function(){mstrmojo.requiresCls("mstrmojo.AndOrNode");mstrmojo.threshold.AndOrNode=mstrmojo.declare(mstrmojo.AndOrNode,null,{scriptClass:"mstrmojo.threshold.AndOrNode",cssClass:"adv-threshold",avatarCssCls:"mstrmojo-thresholdRow",onmouseover:function(){this.toggleGroupBorder(true);},onmouseout:function(){this.toggleGroupBorder(false);},consolidate:function A(){if(this.parent!==this.tree||this.itemCnt===0){this._super();}}});})();(function(){mstrmojo.requiresCls("mstrmojo.Button","mstrmojo.hash","mstrmojo.func","mstrmojo.css","mstrmojo.string","mstrmojo.HBox","mstrmojo.Box","mstrmojo.DropDownButton","mstrmojo.Popup","mstrmojo.WidgetTree","mstrmojo.ObjectBrowserDataProvider","mstrmojo.OBList","mstrmojo.FishEyeContainer","mstrmojo.SearchBox2","mstrmojo.Booklet","mstrmojo.IncFetch","mstrmojo.chart.model.enums.EnumDSSObjectType","mstrmojo.mstr.ui.IncFetchOBList","mstrmojo.DI.DIConstants");var Q=mstrmojo.hash,Z=mstrmojo.func,A=mstrmojo.string,M=mstrmojo.meta.TP,G="5CECE58CC1D549F890EB61C4DB2156A3",W="E0CCB9CF22104A489CBE78D974AFD19E",S=mstrmojo.chart.model.enums.EnumDSSObjectType,L=mstrmojo.array,E=mstrmojo.dom,P=mstrmojo.DI.DIConstants,b=function(k,l,e){var h=k.scrollableIncFetch,g=h?"mstrmojo.mstr.ui.IncFetchOBList":"mstrmojo.OBList",j={scriptClass:g,items:l.items,multiSelect:e};if(h){j.browseConfig={blockBegin:l.bb,blockCount:l.bc,totalSize:l.sz,folderLinksContextId:k.folderLinksContextId,rootFolderID:l.did,browsableTypes:k.browsableTypes,browsableViewMedias:k.browsableViewMedias,dataProvider:k.dataProvider};j.onwaitingChange=function(){if(k.booklet){k.booklet.set("waiting",this.waiting);}};}var f=mstrmojo.insert(j);f.render();return f;},B=function(g,j,e){var f=mstrmojo.ObjectBrowser.widgetHandler||b;return f(g,j,e);},O={success:function(g){var h=this.ob,f=g.items,j=h.pageCache[h.currentPage],e=j._w;j.items=f;e.set("items",f);this.ob=null;this.item=null;window.clearTimeout(h._btm);h.booklet.set("waiting",false);if(h.scrollableIncFetch&&e.scrollNode){e.initScroll();e.updateScrollbars();}},failure:function(e){window.alert(e.getResponseHeader("X-MSTR-TaskFailureMsg"));this.ob.booklet.set("waiting",false);}},V=function(k,j,g){var h=g?-1:1,f=k.pageCache.length,l;for(l=k.currentPage+h;l<f&&l>=0;l+=h){var e=k.pageCache[l];if(e._k===j.k){return{steps:l-k.currentPage,cache:e};}}return null;},D=function(j,h,g,k){var m=j.currentPage+1,f=j.pageCache.length,e;for(e=m;e<f;e++){j.pageCache[e]._w.destroy();delete j.pageCache[e].items;}j.pageCache=j.pageCache.slice(0,m);k._w=g;k._k=h.k;j.pageCache[m]=k;j.cacheChange();},I=function(f){var e=mstrmojo.hash.walk("anc.items.0.items",f);this.set("canGoUp",!(!f.pf||!e));},J=function(j,h,k,g,f){delete j._btm;var e;if(!g){e=B(j,k,j.multiSelect);e.attachEventListener("change",j.id,"navigate");if(j.useDblSelect||j.useBothSglDblSelect){e.attachEventListener("dblclick",j.id,"dblselect");}}else{e=k._w;}j.obList=e;j.booklet.turn(e,f>0);window.setTimeout(function(){j.onBrowsing=false;},300);if(!g){D(j,h,e,k);}j.set("currentFolder",k);j.set("currentPage",j.currentPage+f);j.updateUpButton(k);if(j.scrollableIncFetch&&e.scrollNode){e.initScroll();e.updateScrollbars();}},R=function(g,f,e){var h=V(g,f,false);h=h||V(g,f,true);if(!h){window.clearTimeout(g._btm);g._btm=window.setTimeout(function(){g.booklet.set("waiting",true);},300);e.ob=g;e.item=f;g.getDataProvider().fetchFolderContents(g,f,e);}else{J(g,f,h.cache,true,h.steps);}},C=function(f,g,h,e){R(f,{fid:f.pageCache[f.currentPage].did,blockBegin:g,searchPattern:h,recursive:e},O);},K={success:function(f){var g=this.ob;if(g){window.clearTimeout(g._btm);if(!f.items){f.items=[{did:"empty",n:"("+mstrmojo.desc(2210)+")",t:"e"}];}var e=function j(k){var n=k.length,l;for(l=0;l<n;l++){var m=k[l];if(m.did===G||m.did===W){m.n=(m.did===G)?mstrmojo.desc(8112):mstrmojo.desc(9277);}if(m.items){e(m.items);}}};if(f.did===G||f.did===W){f.n=(f.did===G)?mstrmojo.desc(8112):mstrmojo.desc(9277);if(f.anc&&f.anc.items){e(f.anc.items);}}if(f&&f.items&&g.browsableViewMedias){var h={};L.forEach(g.browsableViewMedias.split(","),function(k){h[parseInt(k,10)]=true;});f.items=L.filter(f.items,function(k){return(k.t!==S.DssTypeDocumentDefinition)||h[k.dvm];});}if(f&&f.items&&mstrApp&&mstrApp.isSingleTier){f.items=L.filter(f.items,function(k){return(k.st!==772);});}if(g.isImportFromCube){f.items=L.filter(f.items,function(k){return(k.et!==P.DSSExType.DSSEXDISPARK);});}if(f.did&&this.item.k!==f.did){this.item.k=f.did;}J(g,this.item,f,false,1);this.ob=null;this.item=null;}},failure:function(e){this.ob.booklet.set("waiting",false);if(this.ob.onError){this.ob.onError(e);}else{if(e.getResponseHeader){mstrmojo.alert(e.getResponseHeader("X-MSTR-TaskFailureMsg"));}else{mstrmojo.alert(e.message);}}},complete:function(){if(this.ob){this.ob.onBrowsing=false;}}},d=function(g){var f=g.pageCache.length,e;for(e=0;e<f;e++){g.pageCache[e]._w.destroy();}g.pageCache=[];g.currentPage=-1;g.cacheChange();},N=function(h,g,j){var e=h.onBrowseFolder;if(e){e[0][e[1]](g);}if(g&&parseInt(g.acg,10)===33){return ;}var f={};if(g){f.k=g.did;f.fid=g.did;}else{if(h.rootFolderID){f.k=h.rootFolderID;f.fid=h.rootFolderID;}else{if(h.rootFolderType){f.k=h.rootFolderType;f.fty=h.rootFolderType;}else{if(h.folderLinksContextId){f.k=h.folderLinksContextId;}}}}R(h,f,Z.wrapMethods(j,Q.copy(K)));},Y=function(k,e,g){if(!g){return e;}var h=k.showCompletePath,m=e[0],j,f;while(m){var l;for(l=g.length-1;l>=0;l--){if(m.did===g[l].did){g.splice(l,1);m._isSc=true;}}f=m;m._open=true;m=m.items;m=m&&m[0];if(!m){f.lastLeaf=true;}}if(!h){m=e[0];while(m){if(m._isSc){e[0]=m;break;}m=m.items;m=m&&m[0];}}return e.concat(g);},X=function(f,e,g){f._naviInfo=Y(f,e,g);};mstrmojo.ObjectBrowser=mstrmojo.declare(mstrmojo.Box,null,{scriptClass:"mstrmojo.ObjectBrowser",rootFolderType:null,rootFolderID:null,sId:null,closeOnSelect:true,browsableTypes:null,browsableViewMedias:null,includeObjectDesc:false,closeable:true,fishEyeVisible:false,searchVisible:true,upButtonVisible:false,currentFolder:null,pageCache:[],currentPage:-1,blockCount:50,canGoUp:true,folderLinksContextId:null,minSearchLength:2,showCompletePath:true,multiSelect:false,onCloseCB:null,onSelectCB:null,onBrowseFolder:null,scrollableIncFetch:false,useBothSglDblSelect:false,displaySaveLabel:false,useOldSearch:false,getDataProvider:function(){if(!this.dataProvider){this.dataProvider=mstrmojo.insert({scriptClass:"mstrmojo.ObjectBrowserDataProvider"});}return this.dataProvider;},markupMethods:{onvisibleChange:function(){this.domNode.style.display=this.visible?"block":"none";}},children:[{scriptClass:"mstrmojo.HBox",alias:"titleBar",cssClass:"mstrmojo-OB-titleTable",children:[{alias:"saveLabel",scriptClass:"mstrmojo.Label",cssClass:"msrmojo-save-label",text:mstrmojo.desc(3178,"Save in:"),bindings:{visible:"this.parent.parent.displaySaveLabel"}},{alias:"title",scriptClass:"mstrmojo.DropDownButton",cssClass:"mstrmojo-FormatEditor-DropDownButton",cssText:"margin:0px;",popupRef:{scriptClass:"mstrmojo.Popup",alias:"popup",contentNodeCssClass:"mstrmojo-OBNavigatorPopup",cssText:"position:relative;",slot:"popupNode",locksHover:true,onOpen:function(){var e=this.opener.parent.parent,h=this.tree,g=e._naviInfo,f=this.parent.parent.parent.extraDDItems;if(h.items!==g){h._pup=this;this.ob=e;if(f){L.forEach(f,function(j){j.isExtra=true;});g=g.concat(f);}h.set("items",g);}if(e.getRecents&&!mstrApp.isSingleTier){e.getRecents(this);}},children:[{alias:"tree",scriptClass:"mstrmojo.WidgetTree",itemIdField:"did",itemFunction:function(j,e,f){var h=mstrmojo.WidgetTree.prototype.itemFunction(j,e,f);if(j.isExtra){if(j.cssClass){h.cssClass=j.cssClass;}h.onmousedown=j.onmousedown||mstrmojo.emptyFn;return h;}if(j._open){h.state=1;}h._ll=!!j.lastLeaf;h._pup=f._pup;h.onmousedown=function(k){var l=mstrmojo.dom.eventTarget(k.hWin,k.e),m=this._pup;if(l===this.domNode||l===this.textNode){if(!this._ll){N(m.ob,this.data);}m.close();}};h.markupMethods=Q.copy(h.markupMethods);h.markupMethods.onstateChange=function(){var k=this.data.items?this.state:0;this.stateNode.className="mstrmojo-TreeNode-state "+({0:"closed",1:"opened",2:"leaf"}[k]||"closed");this.itemsContainerNode.style.display=(k===1)?"block":"none";};h.useRichTooltip=true;var g=h.postBuildRendering;h.postBuildRendering=function(){if(g){g.call(h);}if(h.textNode.parentNode.clientWidth){h.textNode.style.width=(h.textNode.parentNode.clientWidth-20)+"px";}};h.premouseover=function(m){if(this.useRichTooltip){var l=this.textNode;if(l.clientWidth<l.scrollWidth){var k=E.position(l);this.richTooltip={areaId:this.id,cssClass:"vi-regular vi-tooltip-C",contentNodeCssClass:"regular-unitlist-tooltips",posType:mstrmojo.tooltip.POS_TOPLEFT,content:A.encodeHtmlString(this.data[this.itemDisplayField]),top:k.y-2,left:k.x+k.w+6};}else{this.richTooltip=null;}mstrmojo.dom.stopPropogation(m.hWin,m.e);}return true;};return h;}}]}},{alias:"upButton",scriptClass:"mstrmojo.Button",cssClass:"mstrmojo-OBListItemIcon up",title:mstrmojo.desc(1152,"Up One Level"),onclick:function(){this.parent.parent.goUp();},bindings:{enabled:"this.parent.parent.canGoUp",visible:"this.parent.parent.upButtonVisible"}},{alias:"closebtn",scriptClass:"mstrmojo.Button",iconClass:"mstrmojo-OBCloseButton",title:mstrmojo.desc(2102,"Close"),bindings:{visible:"this.parent.parent.closeable"},onclick:function(){this.parent.parent.close();}}]},{alias:"fishEye",scriptClass:"mstrmojo.FishEyeContainer",cssText:"width:100%",bindings:{visible:"this.parent.fishEyeVisible"}},{alias:"searchUpBar",scriptClass:"mstrmojo.HBox",cssClass:"searchBox",children:[{alias:"obSearchBox",scriptClass:"mstrmojo.SearchBox2",cssClass:"mstrmojo-charcoalbox mstrmojo-dxsprite",cssText:"margin: 3px 0; ",contentWidget:mstrmojo.all.obList,taskId:"searchMetadata",searchIncFetch:true,enableMatchCase:false,forceResetCache:true,bindings:{minSearchLength:"this.parent.parent.minSearchLength",quickSearch:"this.parent.parent.quickSearch"},serverRequest:function(e,f){this.parent.parent.getDataProvider().serverRequest(e,f);},preFetch:function(){this.objectTypes=this.parent.parent.browsableTypes||this.objectTypes;this.parent.parent.booklet.set("waiting",true);},postFetch:function(){this.parent.parent.booklet.set("waiting",false);},postBuildRendering:function a(){if(this._super){this._super();}this.inputNode.setAttribute("placeholder"," "+mstrmojo.desc(12666,"Search..."));},onUpdateSearchParams:function H(g){var f=this.parent.parent,e=f.sId;if(e){g.sessionState=e;}if(f.useOldSearch){g.quickSearch=0;g.nameWildcards=1;g.sortKey=6;}}}],bindings:{visible:"this.parent.searchVisible"}},{scriptClass:"mstrmojo.Booklet",cssClass:"mstrmojo-OB-booklet",alias:"booklet",hasAnimation:false,bindings:{scrollableIncFetch:"this.parent.scrollableIncFetch"}},{alias:"obIncFetch",scriptClass:"mstrmojo.IncFetch",height:"17px",cssText:"height:0px;overflow:hidden;",visible:false,np:0,cp:0,ds:{f:mstrmojo.desc(4046,"First"),p:mstrmojo.desc(1058,"Previous"),n:mstrmojo.desc(1059,"Next"),l:mstrmojo.desc(4049,"Last"),pgs:mstrmojo.desc(5972,"## of ### pages"),gt:mstrmojo.desc(5878,"Go to:"),v:mstrmojo.desc(6079,"This field should be # between ## and ###.")},onvisibleChange:function(f){var j=parseInt(this.height,10),e=this.np>1,g={target:this.domNode,props:{height:{start:(e?0:j),stop:(e?j:0),suffix:"px"}},onEnd:function(){if(e){this.target.style.overflow="visible";}}},k=new mstrmojo.fx.AnimateProp(g);this.domNode.style.overflow="hidden";mstrmojo.css.toggleClass(this.parent.domNode,"show-inc-fetch",this.visible);k.play();},onifsChange:function(e){var f=this.np;mstrmojo.hash.copy(e.value,this);if(this.np>1){this.children=null;this.refresh();}if((f<=1&&this.np>1)||(f>1&&this.np<=1)||(f===0&&this.np>0)){this.set("visible",this.np>1);}this.cssText="";}}],destroy:function c(){d(this);if(this._super){this._super();}},postBuildRendering:function(){if(this._super){this._super();}if(this.fishEye&&this.fishEyeVisible){this.fishEye.attachEventListener("selectedIndexChange",this.id,"onFishEyeChange");}var g=this.searchUpBar;if(g&&g.obSearchBox&&this.searchVisible){this.obSearchBox=this.searchUpBar.obSearchBox;this.obSearchBox.attachEventListener("itemsChange",this.id,"onSearchItemsChange");var e=this.obSearchBox.contentWidget||this.obSearchBox;if(!this.scrollableIncFetch){e.attachEventListener("ifsChange",this.id,function(h){if(!this.scrollableIncFetch){this.obIncFetch.set("ifs",h.value);}});}}if(!this.scrollableIncFetch&&this.obIncFetch){var f=this.obIncFetch;f.attachEventListener("fetch",this.id,function(h){f.cp=h.v;f.children=null;f.refresh();C(this,(h.v-1)*this.blockCount+1,this.searchVisible?this.obSearchBox.inputNode.value:"",1);});}mstrmojo.css.addClass(this.domNode,"mstrmojo-ObjectBrowser");},onSearchItemsChange:function(f){var g=f.value,e=this.pageCache[this.currentPage]._w;if(!g||g.length===0){g=[{did:"empty",n:"("+mstrmojo.desc(2210,"")+")",t:"e"}];}else{if(this.browsableViewMedias){var h={};L.forEach(this.browsableViewMedias.split(","),function(j){h[parseInt(j,10)]=true;});g=L.filter(g,function(j){return(j.t!==S.DssTypeDocumentDefinition)||h[j.dvm];});}}e.set("items",g);},navigate:function(n){var e=n.src,o=e.selectedItem,g=this.multiSelect,k=g&&e.getSelectedItems(),l=this,f=n.added&&n.added.length,j=n.removed&&n.removed.length,h=g?k.length===1&&(!j||f):!!o;if(h&&o.did==="empty"){return ;}if(h&&parseInt(o[M],10)===8){if(!this.onBrowsing){this.onBrowsing=true;N(this,o);}}else{if((o&&(!this.useDblSelect||this.useBothSglDblSelect))||k){this.select(g?k:o);}}},browseFolder:function(e,f){N(this,{did:e,n:f});},onFishEyeChange:function(e){this.goToPage(e.value);},goToPage:function(e){if(e<this.pageCache.length&&e!==this.currentPage){var g=e>this.currentPage,f=this.pageCache[e];this.set("currentPage",e);this.booklet.turn(f._w,g);this.set("currentFolder",f);I.call(this,f);}},oncurrentPageChange:function(e){if(this.fishEye){this.fishEye.setSelectedIndex(e.value);}var f=this.pageCache[this.currentPage];this.titleBar.title.set("text",mstrmojo.string.encodeHtmlString(f.n));if(this.searchVisible&&this.obSearchBox){this.obSearchBox.set("rootCacheItems",f.items||[]);this.obSearchBox.set("totalSize",f.sz);this.obSearchBox.set("rootID",f.did);this.obSearchBox.clearSearch();}if(!this.scrollableIncFetch&&this.obIncFetch){this.obIncFetch.set("ifs",{np:Math.floor(f.sz/f.bc)+((f.sz%f.bc>0)?1:0),cp:Math.floor(f.bb/f.bc)+((f.bb%f.bc>0)?1:0)});}},cacheChange:function(){if(this.fishEye&&this.fishEyeVisible){this.fishEye.setItems(this.pageCache);}},browse:function(f,e){Q.copy(f,this);if(this.searchVisible&&this.obSearchBox){this.obSearchBox.clear();}d(this);N(this,undefined,e);},close:function(){var f=this.ctx||this,e=f.onCloseCB;if(e){e[0][e[1]]();}f.set("visible",false);},select:function(f){var e=this.onSelectCB;if(e){e[0][e[1]](f);}if(this.closeOnSelect){this.close();}},dblselect:function U(f){var g=f&&f.src.selectedItem;if(!g||(g&&g.did==="empty")||g[M]===8){return ;}if(this.useBothSglDblSelect){var e=this.onDblSelectCB;if(e){e[0][e[1]](g);}if(this.closeOnSelect){this.close();}}else{this.select(g);}},goUp:function(){if(this.canGoUp){N(this,{did:this.currentFolder.pf});}},updateUpButton:function F(e){I.call(this,e);},oncurrentFolderChange:function(e){var f=e.value;X(this,f.anc.items,f.sc);},refreshContent:function(e){C(this,e);},onError:null,onheightChange:function(){var e=["titleBar","fishEye","searchUpBar","obIncFetch"],g=0,f;for(f in e){g+=parseInt(this[e[f]].domNode.offsetHeight,10);}this.booklet.set("height",parseInt(this.height,10)-g+"px");}});}());(function(){mstrmojo.requiresCls("mstrmojo.Editor","mstrmojo.ObjectBrowser");var H=mstrmojo.array;var E=[257,1024,3072,12032];mstrmojo.vi.ui.editors.ObjectPicker=mstrmojo.declare(mstrmojo.Editor,null,{scriptClass:"mstrmojo.vi.ui.editors.ObjectPicker",cssClass:"mstrmojo-vi-ObjectPicker",zIndex:9,title:mstrmojo.desc(11496,"Select Object"),help:null,rootFolderID:null,rootFolderType:null,folderLinksContextId:4,supportedTypes:H.hash(E),item:null,OKFn:null,children:[{scriptClass:"mstrmojo.ObjectBrowser",alias:"ob",closeable:false,browsableTypes:"8,"+E.join(","),closeOnSelect:false,showCompletePath:false,searchVisible:false,scrollableIncFetch:true,bindings:{rootFolderID:"this.parent.rootFolderID",rootFolderType:"this.parent.rootFolderType",folderLinksContextId:"this.parent.folderLinksContextId",isImportFromCube:"this.parent.isImportFromCube",}},{scriptClass:"mstrmojo.HBox",slot:"buttonNode",alias:"btnHBox",cssClass:"mstrmojo-Editor-buttonBar",children:[{scriptClass:"mstrmojo.Button",cssClass:"mstrmojo-WebButton hot",text:mstrmojo.desc(1442,"OK"),onclick:function C(){var J=this.parent.parent;this.parent.parent.close({item:J.item});var I=J.OKFn;if(I){I(J.item);}J.set("item",null);},bindings:{enabled:function B(){return !!this.parent.parent.item;}}},{scriptClass:"mstrmojo.Button",cssClass:"mstrmojo-WebButton",text:mstrmojo.desc(2399,"Cancle"),onclick:function C(){var I=this.parent.parent;this.parent.parent.close();I.set("item",null);}}]}],preBuildRendering:function A(){if(this._super){this._super();}this.ob.onSelectCB=[this,"onOBSelect"];},postBuildRendering:function D(){if(this._super){this._super();}this.browse();},onOBSelect:function F(I){this.set("item",((this.supportedTypes[I.t]||this.supportedTypes[I.st])?I:null));},browse:function G(){this.ob.browse();}});}());(function(){mstrmojo.requiresCls("mstrmojo.VBox","mstrmojo.ObjectBrowser","mstrmojo.HTMLButton");mstrmojo.requiresDescs(1059,1441,3413,3414,4996,7972,9893);var A={768:true,769:true,774:true,776:true,779:true};mstrmojo.IVEDatasetPicker=mstrmojo.declare(mstrmojo.Editor,null,{scriptClass:"mstrmojo.IVEDatasetPicker",cssClass:"mstrmojo-vi-dataset-picker",title:mstrmojo.desc(11940,"Select Existing Dataset"),help:"add_existing_datasets.htm",startingFolder:null,item:null,multiSelect:false,selectedItems:null,children:[{alias:"newLabel",scriptClass:"mstrmojo.FieldSet",legend:mstrmojo.desc(4996,"New"),cssClass:"mstrmojo-ive-fs"},{alias:"btnImport",scriptClass:"mstrmojo.Button",text:mstrmojo.desc(13550,"Access External Data"),cssClass:"mstrmojo-ive-import",onclick:function(){this.parent.close({action:"import"});}},{alias:"useExistingLabel",scriptClass:"mstrmojo.FieldSet",legend:mstrmojo.desc(9893,"Use Existing"),cssClass:"mstrmojo-ive-fs"},{scriptClass:"mstrmojo.ObjectBrowser",alias:"ob",cssText:"border-width:1px;border-color:#DDDDDD;",closeable:false,browsableTypes:"8,768,769,774,776,779",closeOnSelect:false,showCompletePath:false,searchVisible:true,upButtonVisible:true,folderLinksContextId:1,bindings:{rootFolderID:function(){return this.parent.startingFolder;},multiSelect:"this.parent.multiSelect"}},{scriptClass:"mstrmojo.HBox",alias:"btnHBox",slot:"buttonNode",cssClass:"mstrmojo-Editor-buttonBar",children:[{scriptClass:"mstrmojo.HTMLButton",cssClass:"mstrmojo-Editor-button",text:mstrmojo.desc(1059,"Next"),onclick:function(){this.parent.parent.close({item:this.parent.parent.item});},bindings:{enabled:function(){return !!(this.parent.parent.multiSelect?this.parent.parent.selectedItem.length:this.parent.parent.item);}}}]}],preBuildRendering:function(){if(this._super){this._super();}this.ob.onSelectCB=[this,"onOBSelect"];this.ob.onBrowseFolder=[this,"onOBBrowseFolder"];this.ob.booklet.set("animates",false);this.ob.rootFolderID=this.startingFolder;},postBuildRendering:function(){if(this._super){this._super();}this.ob.browse();},onOBSelect:function(B){if(this.multiSelect){this.set("selectedItems",mstrmojo.array.filter(B,function(C){return A[C.st];}));}else{this.set("item",(A[B.st]?B:null));}},onOBBrowseFolder:function(B){if(this.multiSelect){this.set("selectedItems",null);}else{this.set("item",null);}},onstartingFolderChange:function(){this.ob.rootFolderID=this.startingFolder;this.ob.browse();}});}());(function(){mstrmojo.requiresCls("mstrmojo.Button","mstrmojo.HTMLButton","mstrmojo.Label","mstrmojo.TextBox","mstrmojo.TextArea","mstrmojo.Table","mstrmojo.HBox","mstrmojo.Editor","mstrmojo.ObjectBrowser","mstrmojo.NewFolderEditor","mstrmojo.DI.DIHelpers");var C=mstrmojo.func,F=mstrmojo.DI.DIHelpers,E=mstrmojo.array;function B(){var H={alias:"newFolder",scriptClass:"mstrmojo.Label",cssClass:"mstrmojo-createfolder",text:mstrmojo.desc(3245,"Create New Folder"),onclick:function(){var J=this.parent.parent,I={zIndex:J.zIndex+10,navigateAfter:false,fId:J.ob.currentFolder.did,okFn:function(K,L){J.ob.refreshContent();if(L){J.ob.browseFolder(K.fid,J.newFolder);}}};if(J.ob.dataProvider){I.dp=J.ob.dataProvider;}J.openPopup("newFolder",I);},postCreate:function(){this.set("visible",false);}},G=mstrmojo.hash.clone(mstrmojo.ObjectBrowser.prototype.children);G.push(H);return G;}mstrmojo.SaveAsObjectBrowser=mstrmojo.declare(mstrmojo.ObjectBrowser,null,{scriptClass:"mstrmojo.SaveAsObjectBrowser",cssClass:"mstrmojo-SaveAs-OB",children:B(),getRecents:function(G){var H=this;G.onClose=function(){if(H.recentFolders){this.removeChildren(this.recentLable);this.removeChildren(this.recentList);delete H.recentFolders;}};this.getDataProvider().loadRecentSaveAsFolders({success:function(I){if(H.recentFolders){G.removeChildren(G.recentLable);G.removeChildren(G.recentList);delete H.recentFolders;}if(I&&I!==""){H.recentFolders=H.getList(I.objects,G);G.addChildren(H.recentFolders);}},failure:function(I){mstrmojo.alert(I.message||I.getResponseHeader("X-MSTR-TaskFailureMsg"));},});},getList:function(H,G){var I=this;return[{scriptClass:"mstrmojo.Label",alias:"recentLable",cssClass:"recentLabel",text:mstrmojo.desc(14354,"Recents")},{scriptClass:"mstrmojo.ui.List",alias:"recentList",items:H,cssClass:"recentList",onclick:function(J){var K=this.getItemFromTarget(J.getTarget());I.browseFolder(K.did,"");G.close();}}];}});var A={success:function(G){var H=this.parent;if(H.onObjectSaved){H.onObjectSaved({name:H.name,did:G.did,desc:H.desc});}mstrmojo.alert(mstrmojo.desc(7987,"The ## '###' has been saved successfully.").replace("##",H.typeDesc||"Object").replace("###",H.name),null,mstrmojo.desc(7984,"Object Saved"));H.ob.refreshContent();H.close();},failure:function(H){var G=parseInt(H.getResponseHeader("X-MSTR-TaskErrorCode"),10)+4294967296,I=this.parent;if(G===2147749923){mstrmojo.confirm(mstrmojo.desc(7986,"The ## '###' already exists. Do you want to replace the existing one?").replace("##",I&&I.typeDesc||"Object").replace("'###'",I&&I.name?'"'+I.name+'"':""),{confirmBtn:{fn:function(){I.saveAs(true);}}},{title:mstrmojo.desc(3179),zIndex:I&&I.zIndex+10});}else{mstrmojo.alert(mstrmojo.desc(7985,"Error while saving: ")+H.getResponseHeader("X-MSTR-TaskFailureMsg"));}}};mstrmojo.SaveAsEditor=mstrmojo.declare(mstrmojo.Editor,null,{scriptClass:"mstrmojo.SaveAsEditor",cssClass:"mstrmojo-SaveAsEditor",title:mstrmojo.desc(3167,"Save As"),sId:null,rootFolderID:null,rootFolderType:null,folderLinksContextId:null,browsableTypes:null,showCompletePath:true,desc:"",name:"",displaySaveLabel:true,searchVisible:true,upButtonVisible:true,children:[{scriptClass:"mstrmojo.SaveAsObjectBrowser",alias:"ob",closeable:false,closeOnSelect:false,fishEyeVisible:false,bindings:{showCompletePath:"this.parent.showCompletePath",rootFolderID:"this.parent.rootFolderID",rootFolderType:"this.parent.rootFolderType",folderLinksContextId:"this.parent.folderLinksContextId",browsableTypes:"this.parent.browsableTypes",displaySaveLabel:"this.parent.displaySaveLabel",searchVisible:"this.parent.searchVisible",upButtonVisible:"this.parent.upButtonVisible",sId:"this.parent.sId"},postCreate:function(){this.onSelectCB=[this.parent,"onOBSelect"];this.onBrowseFolder=[this.parent,"onOBBrowseFolder"];}},{scriptClass:"mstrmojo.Table",cssClass:"mstrmojo-Input-Panel",rows:2,cols:2,alias:"contPanel",children:[{scriptClass:"mstrmojo.Label",cssClass:"mstrmojo-Name-Label",slot:"0,0",text:mstrmojo.desc(2211,"Name:")},{scriptClass:"mstrmojo.TextBox",slot:"0,1",value:mstrmojo.desc(8116,"New Folder"),alias:"name",cssClass:"mstrmojo-SaveAsEditor-nameInput",bindings:{value:"this.parent.parent.name"}},{scriptClass:"mstrmojo.Label",cssClass:"mstrmojo-Desc-Label",slot:"1,0",text:mstrmojo.desc(1154,"Description:")},{scriptClass:"mstrmojo.TextArea",cssClass:"mstrmojo-SaveAsEditor-descInput",slot:"1,1",alias:"desc",bindings:{value:"this.parent.parent.desc"},rows:5}]},{scriptClass:"mstrmojo.HBox",alias:"buttonBox",slot:"buttonNode",cssClass:"mstrmojo-Editor-buttonBar",children:[{alias:"newFolder",scriptClass:"mstrmojo.Button",cssClass:"mstrmojo-WebButton mstrmojo-createfolder",text:mstrmojo.desc(3245,"Create New Folder"),onclick:function(){var H=this.parent.parent,G={zIndex:H.zIndex+10,navigateAfter:false,fId:H.ob.currentFolder.did,okFn:function(I,J){H.ob.refreshContent();if(J){H.ob.browseFolder(I.fid,H.newFolder);}},cssClass:F.getEnvObj().isAppSchema()?"workstation":undefined};if(H.ob.dataProvider){G.dp=H.ob.dataProvider;}H.openPopup("newFolder",G);},postCreate:function(){this.set("visible",mstrmojo.resolveFeature("create-folder")||F.getEnvObj().isAppSchema());}},{scriptClass:"mstrmojo.Button",cssClass:"mstrmojo-WebButton hot okButton",alias:"ok",text:mstrmojo.desc(2400,"Save"),onclick:function(){this.parent.parent.saveAs();}},{scriptClass:"mstrmojo.Button",cssClass:"mstrmojo-WebButton",alias:"cancel",text:mstrmojo.desc(221,"Cancel"),onclick:function(){this.parent.parent.close();}}]}],newFolder:{scriptClass:"mstrmojo.NewFolderEditor"},onOpen:function(){this.ob.browse();},onOBBrowseFolder:mstrmojo.emptyFn,onOBSelect:function(G){this.set("name",G.n);},saveAsCallback:function D(){return A;},saveAs:function(J){var H=this.contPanel;this.name=H.name.value;this.desc=H.desc.value;if(!this.name){mstrmojo.alert(mstrmojo.desc(3380,"Please enter valid name"));return ;}var L=this.saveParams||{};L.folderID=this.ob.currentFolder.did;L.description=this.desc||"";L.name=this.name||"";L.saveAsOverwrite=!!J;var G=this.saveAsCallback(),K=this,I={success:function(){K.saveRecentFolders(K.ob.currentFolder.did);},failure:function(M){mstrmojo.alert(M.message||M.getResponseHeader("X-MSTR-TaskFailureMsg"));}};G.parent=this;if(!mstrApp.isSingleTier){G=C.wrapMethods(G,I);}mstrmojo.xhr.request("POST",mstrConfig.taskURL,G,L);},saveRecentFolders:function(K){var I,G,H,J=this;J.ob.getDataProvider().loadRecentSaveAsFolders({success:function(L){G=[];E.forEach(L.objects,function(O){G.push(O.did);});H=mstrmojo.array.indexOf(G,K);if(H!==-1){G.splice(H,1);}G.unshift(K);I=G.slice(0,3).join(",")+",";var M={taskId:"setPreference",prefs:"recentFolders\u001E"+I};var N={success:function(){mstrConfig.recentFolders=I;},failure:function(O){mstrmojo.alert(O.message||O.getResponseHeader("X-MSTR-TaskFailureMsg"));}};J.ob.getDataProvider().serverRequest(M,N);},failure:function(L){mstrmojo.alert(L.message||L.getResponseHeader("X-MSTR-TaskFailureMsg"));}});}});mstrmojo.SaveAsEditor.SAVEAS_CALLBACK=A;})();(function(){mstrmojo.requiresCls("mstrmojo.FilterExpr","mstrmojo.threshold.AndOrNode","mstrmojo.threshold.ConditionNode","mstrmojo.expr");var H=mstrmojo.expr,G=H.ET,F=mstrmojo.mstr.EnumNodeProperties;mstrmojo.threshold.ThresholdExprTree=mstrmojo.declare(mstrmojo.FilterExpr,null,{scriptClass:"mstrmojo.threshold.ThresholdExprTree",cssClass:"mstrmojo-ThresholdExprTree",allowCopy:false,containerResizable:false,draggable:true,dropZone:true,editable:true,makeObservable:true,supportRelation:true,nodeClassMap:{14:mstrmojo.threshold.AndOrNode,"*":mstrmojo.threshold.ConditionNode},getItemIdentityProp:function(I){if(I.node&F.CONDITION){return"*";}return this._super(I);},onConditionEdit:mstrmojo.emptyFn,editor:undefined,isEditable:function C(I){if(!this.editable){return false;}if(I&&I.et===G.XML){return !I.xml;}return true;},onNew:function E(I){I.data.isNew=true;this.editor.openConditionWalk(I.data,I.widget.ctxtBuilder.itemWidgets[I.index]);},onnodeclick:function D(I){var J=I.part;if(!I||!J){return ;}var L=J==="andor",K=this.tree.editor;if(!((L&&this.prefixedAndOrEditable)||(!L&&this.editable))){return ;}if(!this.editable){return ;}if(L){K.openAndORPopup(this,I.getTarget());return ;}else{if(J==="addCondition"){this.tree.newCondition({et:G.AE});return ;}}K.openConditionWalk(this.data,this);},allowDrop:function B(I){var N=I&&I.src,M=N&&N.data,K=M&&M.et,L=this.tree,J=N&&N.widget&&N.widget.tree;return K&&(this===L?(J!==L):true);},remove:function A(J){var I=this._super(J);if(this.items.length===0&&J.et===G.ANDOR&&J.nds.length===0&&this.parent.removeFromModel){this.parent.removeFromModel();}return I;}});}());(function(){mstrmojo.requiresCls("mstrmojo.Container","mstrmojo._IsExprNode","mstrmojo.fe._IsRelationTreeNode","mstrmojo._HasPopup","mstrmojo.fe.AndOrNode","mstrmojo.fe.DynamicNode","mstrmojo.ConditionNode","mstrmojo.css","mstrmojo.string","mstrmojo.dom","mstrmojo.hash","mstrmojo.expr");var E=mstrmojo,A=E.css,I=E.dom,F=E.hash,G=E.string,C=function(N){var O=N.data,M=O.dmy&&O.dmy.uts||[],K=M.length,J=[],L;for(L=0;L<K;L++){J.push(G.encodeHtmlString(M[L].n));}return'<span class="mstrmojo-text">'+J.join(", ")+"</span>";};mstrmojo.fe.RelationNode=mstrmojo.declare(mstrmojo.Container,[mstrmojo._IsExprNode,mstrmojo.fe._IsRelationTreeNode,mstrmojo._HasPopup],{scriptClass:"mstrmojo.fe.RelationNode",markupString:'<div id="{@id}" class="mstrmojo-relation {@cssClass}"  style="position:relative;{@cssText}" mstrAttach:mousedown><div class="mstrmojo-onhoverparent mstrmojo-relation-prefix {@cssClass}"><span class="mstrmojo-textset mstrmojo-relation-prefix-text" mstrAttach:click></span><span class="mstrmojo-onhover-in mstrmojo-andor-tools {@cssClass}"><span class="mstrmojo-indent" onclick="mstrmojo.all[\'{@id}\'].ind()">'+mstrmojo.desc(5895,"Group conditions")+'</span><span class="mstrmojo-outdent" onclick="mstrmojo.all[\'{@id}\'].out()">'+mstrmojo.desc(5896,"Ungroup Conditions")+'</span></span></div><div class="mstrmojo-relationNode"><span class="mstrmojo-relationNode-inf"><span class="mstrmojo-relation-prefix-text">'+mstrmojo.desc(2790,"Set of").replace(/##/g,"")+'</span><span class="mstrmojo-textset"  mstrAttach:click></span><span class="mstrmojo-relation-postfix-text">'+mstrmojo.desc(2793,"Where").replace(/##/g,"")+'</span><span class="mstrmojo-relation-convert-text"  mstrAttach:click >'+mstrmojo.desc(15412,"Convert to Condition")+'</span><img class="mstrmojo-del" src="../images/1ptrans.gif" title="'+mstrmojo.desc(7931,"Delete condition")+'"onclick="mstrmojo.all[\'{@id}\'].del()" /></span><div class="mstrmojo-relation-childTreeNode" style="position:relative;"></div></div></div>',markupSlots:{prefixHoverNode:function(){return this.domNode.firstChild;},prefixNode:function(){return this.domNode.firstChild.firstChild;},relationNode:function(){return this.domNode.lastChild;},textNode:function(){return this.domNode.childNodes[1].firstChild.childNodes[1];},convertNode:function(){return this.domNode.childNodes[1].firstChild.childNodes[3];},containerNode:function(){return this.domNode.childNodes[1].childNodes[1];}},markupMethods:{onprefixedAndOrEditableChange:function(){A.toggleClass(this.prefixNode,["editable"],this.prefixedAndOrEditable);},onselectedChange:function(){A.toggleClass(this.relationNode,["selected"],this.selected);},ondataChange:function(){this.prefixNode.innerHTML=this.andOrTxt();this.textNode.innerHTML=C(this);}},noRelationOperator:true,children:[{scriptClass:"mstrmojo.fe.RelationFilterExprTree",alias:"childTree",ignoreLayout:true,dropZone:false,draggable:false,nodeClassMap:{14:mstrmojo.fe.AndOrNode,ph:mstrmojo.fe.DynamicNode,"*":mstrmojo.fe.ConditionNode},onNew:function(J){this.parent.tree.onNew(J);},getItemConfig:function(M,J,N){var K=mstrmojo.fe.RelationFilterExprTree.prototype.getItemConfig.call(this,M,J,N),L=N.tree||N;return F.copy({tree:L,rootTree:this.parent.tree,noRelation:true,inRelation:true},K);},prenodeclick:function(J){if(!J||!J.part){return ;}var K=this.rootTree;if(K&&K.onnodeclick&&this.editable){J.editor=K.editor;K.onnodeclick.call(this,J);}}}],premousedown:function(J){if(this._super){this._super(J);}var K=I.eventTarget(J.hWin,J.e);if(!I.contains(this.childTree.domNode,K,true)){this.childTree.clearTreeSelect();}},preselectedChange:function(J){if(!J.value){this.childTree.clearTreeSelect();}},init:function(J){this._super(J);var K=this.data;if(K){delete this.data;this._set_data(null,K);}},_set_data:function(M,J){var K=this.data;if(J&&(!J.relation)){J.relation={};}var L=(K!==J);if(L){this.data=J;if(J){this.childTree.set("items",J.nds||[J]);}}return L;},isSelectableArea:function(J){return mstrmojo.dom.contains(this.relationNode,J,true);},preclick:function D(J){var L=null,K=I.eventTarget(J.hWin,J.e);if(I.contains(this.prefixNode,K,true)){L="andor";}else{if(I.contains(this.textNode,K,true)){L="createSet";}else{if(I.contains(this.convertNode,K,true)){this.parent.removeSet(this);return false;}}}J.part=L;},del:function H(){var J=this.parent;if(J&&J.remove&&this.data){J.remove(this.data);}},newCondition:function B(J){this.childTree.newCondition(J);},avatarCssCls:"mstrmojo-FE mstrmojo-relationNode",getAvatarNode:function(){return this.relationNode.cloneNode(true);}});})();(function(){mstrmojo.requiresCls("mstrmojo.array","mstrmojo.css","mstrmojo.expr","mstrmojo.hash","mstrmojo.Box","mstrmojo.Button","mstrmojo.Editor","mstrmojo.FilterExpr","mstrmojo.Label","mstrmojo.Obj","mstrmojo.ui.Checkbox","mstrmojo.ui.CheckList","mstrmojo.warehouse.EnumObjectTypes");var H=mstrmojo.expr,I=H.ET,C=mstrmojo.array,F=mstrmojo.string,E=mstrmojo.warehouse.EnumObjectTypes,G=mstrmojo.mstr.EnumNodeDimty,D=mstrmojo.hash;mstrmojo.fe.CreateSetEditor=mstrmojo.declare(mstrmojo.Editor,null,{onOpen:function(){var Q=this.model,X=this.condition.data,R=!X.m,N=this.attrsBox.attrsList,J=this.relBox.relPd,S=C.filter(Q.metrics,function(a){return !a.um;}),Y=[{n:mstrmojo.desc(12037,"System Default"),t:-1,did:"default"}].concat(S),L=this.appQualBox.appQual,Z=D.clone(Q.attrs);C.forEach(Z,function(b){var a=false;if(b.t===E.ATTRIBUTE){C.forEach(b.fs,function(c){if(c.fgr>0){a=true;return false;}});}b.css=(b.css||"")+" "+(b.t?("t"+b.t+((b.da||b.um)?"d":"")+(a?"g":"")+(b.st?(" st"+b.st):"")):"");});N.set("items",Z);mstrmojo.array.forEach(["relBox","appQualBox"],function(a){this[a].set("visible",R);},this);if(X.dmt===4&&X.dmy.uts){var M={};C.forEach(X.dmy.uts,function(b){var a=C.find(Q.attrs,"did",b.utgt.did);if(a>=0){M[a]=true;}});N.set("selectedIndices",M);}if(R){J.set("items",Y);if(X.relation&&X.relation.guide){var O=X.relation.guide,W=C.find(Y,"did",O.did);J.set("selectedIndex",W>=0?W:0);}else{J.set("selectedIndex",0);}L.set("checked",!!X.applySubExpr);}if(mstrApp.isWSStyling){var V={left:parseInt(this.left,10),top:parseInt(this.top,10)},K=this.editorNode.getBoundingClientRect(),U={width:window.innerWidth,height:window.innerHeight},P={width:K.right-K.left,height:K.bottom-K.top};if(K.right>U.width){this.set("left",(V.left-P.width)+"px");}if(K.bottom>U.height){this.set("top",(V.top-P.height)+"px");}}},onOK:function(){var Q=this.model,U=this.condition,W=this.condition.data,N=this.attrsBox.attrsList,J=this.relBox.relPd,L=this.appQualBox.appQual;var Y=N.getSelectedItems(),K=[];C.forEach(Y,function(a){K.push({utgt:{n:a.n,did:a.did},utp:H.DMY_TP.ATTR,agg:1,flt:2,gb:true,rps:0,n:a.n});});var X;if(J.selectedIndex>0){var O=J.items[J.selectedIndex];X={n:O.n,did:O.did,t:E.METRIC,st:1024};}var M;if(W.et===15){W.dmt=G.NodeDimtyOutputLevel;W.dmy=W.dmy||{};W.dmy.uts=K;M=W.relation=W.relation||{};if(X){M.guide=X;W.useSchema=false;}else{delete M.guide;delete M.rsTp;delete M.joTp;delete M.paTp;delete M.erTp;W.useSchema=true;}W.applySubExpr=L.checked;U.set("data",W);}else{var V={et:15};V.dmt=G.NodeDimtyOutputLevel;V.dmy={};V.dmy.uts=K;M=V.relation={};if(X){M.guide=X;}else{V.useSchema=true;}V.applySubExpr=L.checked;var P=U,R={rq:V,cq:W},S=[U.childIndex()];if(W.et===I.ANDOR){if(W.nds&&W.nds.length>2){var Z=Q.childIdx;S=[Z,Z-1];}else{P=U.parent;}}else{P=U.parent;R.isMetric=!!W.m;}P.createSet(S,R);}},children:[{scriptClass:"mstrmojo.Box",alias:"attrsBox",cssClass:"Attributes-Box",children:[{scriptClass:"mstrmojo.Label",text:mstrmojo.desc(14613,"Select attributes to create the set"),cssClass:"Label",alias:"attrsBoxLabel"},{scriptClass:"mstrmojo.ui.CheckList",alias:"attrsList",cssClass:"CheckList"}]},{scriptClass:"mstrmojo.Box",alias:"relBox",cssClass:"RelatedBy-Box",children:[{scriptClass:"mstrmojo.Label",text:mstrmojo.desc(12036,"Related by"),cssClass:"Label",cssDisplay:"inline-block"},{scriptClass:"mstrmojo.ui.Pulldown",alias:"relPd",cssClass:"Pulldown",cssDisplay:"inline-block",allowHTML:false,onitemSelected:function B(J){}}]},{scriptClass:"mstrmojo.Box",alias:"appQualBox",cssClass:"AppQual-Box",children:[{scriptClass:"mstrmojo.ui.Checkbox",alias:"appQual",cssClass:"AppQual-CheckBox"},{scriptClass:"mstrmojo.Label",cssClass:"AppQual-Label",text:mstrmojo.desc(12038,"Apply this qualification independently of the relationship filter"),postBuildRendering:function(){if(this._super){this._super();}if(mstrApp.isWSStyling){this.set("text",mstrmojo.desc(15015,"Apply this qualification to define the set, and also to the results of the visualization."));}}}]},{scriptClass:"mstrmojo.HBox",slot:"buttonNode",cssText:"float: right; border-collapse: separate; display: table;",children:[{scriptClass:"mstrmojo.Button",cssClass:"mstrmojo-WebButton hot",text:mstrmojo.desc(2397,"OK"),onclick:function(){var J=this.editor;J.onOK();J.close();},bindings:{enabled:function(){var K=this.parent.parent.attrsBox.attrsList,J=this.parent.parent.attrsBox.attrsList.selectedIndices;return K.getSelectedItems().length>0;},editor:"this.parent.parent"}},{scriptClass:"mstrmojo.Button",cssClass:"mstrmojo-WebButton",text:mstrmojo.desc(221,"Cancel"),onclick:function(){this.editor.close();},bindings:{editor:"this.parent.parent"}}]}],postBuildRendering:function A(){this._super();if(mstrApp&&mstrApp.isWSStyling){this.attrsBox.attrsBoxLabel.set("text",mstrmojo.desc(15013,"Select the attributes that you look for."));}}});})();(function(){mstrmojo.requiresCls("mstrmojo.expr","mstrmojo.hash","mstrmojo.FilterExpr");var D=mstrmojo.hash,B=mstrmojo.expr.ET;mstrmojo.fe.FilterExprTree=mstrmojo.declare(mstrmojo.FilterExpr,null,{scriptClass:"mstrmojo.fe.FilterExprTree",allowCopy:false,containerResizable:false,draggable:true,dropZone:true,editable:true,makeObservable:true,onConditionEdit:mstrmojo.emptyFn,modifyConditionNode:function(G,F){var H=G.data,E=H.isNew;D.copy(D.clone(F),D.clear(H));delete H.isNew;G.paint();if(H.et===B.MQ||H.et===B.MC){G.set("noCreateSet",!mstrApp.supportAdvFilter);}if(G.tree.onConditionEdit){G.tree.onConditionEdit(G,E);}},getItemConfig:function(H,E,I){var F=this._super(H,E,I),G=I.tree;return D.copy({onclick:G.prenodeclick,containerResizable:G.containerResizable,ondragend:G.ondragend,ondrop:G.ondrop},F);},ondragenter:function A(E){this.dropCuePos={left:0,top:0,idx:0,idxActual:0};this._super(E);},ondragend:function(E){if(this===this.tree){return this._super(E);}else{return this.constructor.prototype.ondragend.call(this,E);}},ondrop:function(E){if(this===this.tree){return this._super(E);}else{return this.constructor.prototype.ondrop.call(this,E);}},isEditable:function C(F){if(!this.editable){return false;}var E=false;switch(F&&F.et){case B.R:case B.F:E=false;break;case B.ANDOR:case B.MQ:case B.AQ:case B.AL:case B.AC:case B.MC:case B.AE:E=true;break;case B.XML:E=!F.xml||!!F.ph;}return E;},prenodeclick:function(E){if(!E||!E.part){return ;}if(E.part!=="createSet"&&E.part!=="createSetOpt"&&!(E.part==="andor"?this.prefixedAndOrEditable:this.editable)){return ;}var F=this.tree;if(F.onnodeclick){F.onnodeclick.call(this,E);}},getSelectedItemWidget:function(){var E=function(K){var I=K&&K.ctxtBuilder&&K.ctxtBuilder.itemWidgets,G=K.selectedIndex,F=I&&I.length||0;if(!I){return ;}if(G===-1){for(var H=0;H<F;H++){var J=E(I[H]);if(J){return J;}}}else{return I[G];}};return E(this);}});})();(function(){mstrmojo.requiresCls("mstrmojo.TreeBrowserNode","mstrmojo.TreeBrowser","mstrmojo.ACL.UserDataService");mstrmojo.ACL.UserTreeBrowser=mstrmojo.declare(mstrmojo.TreeBrowser,null,{scriptClass:"mstrmojo.ACL.UserTreeBrowser",itemIdField:"did",branchClickPolicy:mstrmojo.TreeBrowserEnum.BRANCH_POLICY_SELECT,getACLUserDataService:function D(){return mstrmojo.ACL.UserDataService;},getContentThroughTaskCall:function C(G,E){var F=this.getACLUserDataService();E.failure=mstrmojo.func.composite([function(H){if(H.getResponseHeader){mstrmojo.alert(H.getResponseHeader("X-MSTR-TaskFailureMsg"));}},E.failure]);if(G.isRoot){F.getTopLevelGroups(G,E);}else{F.getMembers(G,E);}},isBranch:function B(E){return E.isGroup;},item2textCss:function A(E){return(this._super&&this._super(E))||"mstrmojo-ACLInputBox-user "+{8704:"u",8705:"ug"}[E.st];}});})();(function(){mstrmojo.requiresCls("mstrmojo.dom","mstrmojo.hash","mstrmojo._ValidateSuggestions","mstrmojo.WidgetList","mstrmojo.Editor","mstrmojo.LegacySuggestionList");mstrmojo.Enum_OIB_States=mstrmojo.hash.copy(mstrmojo._ValidateSuggestions.ENUM_STATES,{EDITING:2,ADDING:3,EMPTY:4});mstrmojo.Enum_OIB_States_CSS=(function(){var AG=mstrmojo.Enum_OIB_States,AF={},AH;for(AH in AG){if(AG.hasOwnProperty(AH)){AF[String(AG[AH])]=AH;}}return AF;}());var Q=mstrmojo.dom,S=mstrmojo.hash,b=mstrmojo.Enum_OIB_States,I=0,d="_did_",AB=mstrmojo.Enum_Keys,AD=80,V=200;function Y(){return(mstrApp&&mstrApp.searchAutoCompleteDelay&&mstrApp.searchAutoCompleteDelay())?mstrApp.searchAutoCompleteDelay():V;}function P(){return I++;}function j(AF){return(AF&&AF.state===b.ADDING);}function r(AF){var AG={n:AF||"",state:b.EMPTY};AG[d]=-2;return AG;}function O(AF){return(AF&&AF.state===b.EMPTY);}function w(AG){var AH=AG.items,AF=AH&&AH.length;if(!AF){return true;}return(AF===1&&j(AH[0]))||(AF===2&&O(AH[0])&&j(AH[1]));}function n(){var AG=this.ctxtBuilder.itemWidgets,AF=AG[AG.length-1];if(AF&&AF.isAdding){var AH=this;Q.attachEvent(AF.domNode,"click",function(){AH.editingIdx=null;});return AF;}return null;}function L(){var AF=this.editingIdx;if(AF!==null){return this.ctxtBuilder.itemWidgets[AF];}return n.call(this);}function D(){this.isActive=false;var AG=this.emptyText||"",AH=this.items;if(w(this)&&!O(AH[0])&&(AG.length>0)){this.add([r(AG)],0);var AI=this.ctxtBuilder.itemWidgets[0];AI.set("shouldEllipsize",true);AI.doEllipsize();}var AF=L.call(this);if(AF){if(j(AF)&&this.showEmptyItem){AF.domNode.style.visibility="hidden";}AF.blur();}Q.detachEvent(document.body,"mousedown",this._mousedownHandler);if(this.tabNavigable){Q.detachEvent(AF.inputNode,"keydown",this._tabKeyHander);}}function N(){if(!this.enabled){return ;}this.isActive=true;if(O(this.items[0])){this.remove(0);}var AF=L.call(this);if(AF){if(j(AF)&&!this.isFull){AF.domNode.style.display="block";AF.domNode.style.visibility="visible";}this.scrollTo(AF.data);AF.focus();}Q.attachEvent(document.body,"mousedown",this._mousedownHandler);if(this.tabNavigable){Q.attachEvent(AF.inputNode,"keydown",this._tabKeyHander);}}mstrmojo.ObjectInputBox=mstrmojo.declare(mstrmojo.WidgetList,[mstrmojo._ValidateSuggestions],{scriptClass:"mstrmojo.ObjectInputBox",cssClass:"mstrmojo-ObjectInputBox",emptyText:"",showEmptyItem:true,items:null,itemField:"n",dynamicVerify:true,suggestCount:10,candidates:null,makeObservable:true,renderOnScroll:false,editingIdx:null,isActive:false,maxObjectCount:null,isFull:false,suggestionListClass:"mstrmojo.LegacySuggestionList",acptSugItemOnly:false,useKeyDelay:false,showSuggestionOnEdit:true,tabNavigable:false,getSearchPattern:function(){var AF=L.call(this);if(AF){return AF.getSearchPattern();}return"";},getSuggestionTarget:function o(){return this.suggestTarget;},onsuggestTargetChanged:function q(AF){this._request_pattern=null;},getSuggestionPos:function e(){return this._pop_cfg;},onSuggestionItemSelect:function x(AF){if(this.suggestTarget){this.suggestTarget.setItem(AF[this.itemField],AF,false);}this.hideSuggestion();this.closePopup();},hideEditButton:function(AF){return !!this.noEditButton;},_set_items:function m(AK,AH){AH=mstrmojo.hash.clone(AH)||[];var AJ=this.maxObjectCount;this.set("isFull",(AJ&&AH.length>=AJ));if(AH.length===0){var AG=this.emptyText||"";if(AG.length>0){AH.push(r(AG));}}var AI={n:"",state:b.ADDING};AI[d]=-1;AH.push(AI);var AF=AH[AH.length-1];if(AF&&j(AF)&&this.maxObjectCount&&(this.getSelectedObjects().length>=this.maxObjectCount)){this.set("isFull",true);}this.itemIdField=d;return this._super(AK,AH);},add:function E(AG,AF){var AH=n.call(this);if(!this.maxObjectCount||this.getSelectedObjects().length<this.maxObjectCount){this._super(AG,AF);}if(!w(this)&&O(this.items[0])){this.remove(0);}if(AH){AH.adjustInputWidth();if(this.maxObjectCount&&(this.getSelectedObjects().length===this.maxObjectCount)){this.set("isFull",true);AH.domNode.style.display="none";}else{AH.domNode.style.display=this.showEmptyItem?"none":"";}}},remove:function c(AF){this._super(AF);var AG=n.call(this);if(AG){if(this.maxObjectCount&&(this.getSelectedObjects().length<this.maxObjectCount)){this.set("isFull",false);}AG.adjustInputWidth();}},preBuildRendering:function(){if(this.items==null||this.items.length==0){this.set("items",[]);}if(this._super){this._super();}},postBuildRendering:function a(){this._super();var AG=this,AF=n.call(AG);if(AF&&(this.showEmptyItem||this.isFull)){AF.domNode.style.display="none";}this._clickHandler=function(){N.call(AG);};this._mousedownHandler=function(AH){if(!AG.isActive||AG.browserShown){return ;}var AI=Q.eventTarget(self,AH);if(AI&&AI.parentNode&&!Q.contains(L.call(AG).domNode,AI,false,document.body)&&!Q.contains(AG.suggestionPopup.domNode,AI,false,document.body)){D.call(AG);}};if(this.tabNavigable){this._tabKeyHander=function(AH){var AI=parseInt(AH.keyCode||AH.charCode,10);if(AI===AB.TAB){if(!AG.isActive||AG.browserShown){return ;}D.call(AG);}};}Q.attachEvent(this.domNode,"click",this._clickHandler);},nextId:P,item2textCss:function M(AF){return AF.cssClass||"";},itemFunction:function G(AH,AF,AG){AH[AG.itemIdField]=P();var AI=new mstrmojo.ObjectItem({parent:AG,itemField:AG.itemField,cssClass:AG.item2textCss(AH),data:AH,showSuggestionOnEdit:this.showSuggestionOnEdit,enabled:AG.enabled});AG.attachEventListener4ItemWidget(AI,AG);return AI;},attachEventListener4ItemWidget:function k(AJ,AH){var AG=["ItemEditBegin","ItemEditEnd","ItemDeletePrev","ItemDelete","ItemAdd","SuggestionOn","SuggestionOff","ItemEditing"],AF=AG.length,AI;for(AI=0;AI<AF;AI++){AJ.attachEventListener(AG[AI],AH.id,"_itemChangeHandler");}return AJ;},getSelectedObjects:function l(){if(w(this)){return[];}var AF=this.items,AG=AF.length-1;if((AG>-1)&&j(AF[AG])){return AF.slice(0,AG);}return AF.concat();},isValid:function C(){var AG=this.ctxtBuilder.itemWidgets,AF=AG&&AG.length,AH;for(AH=0;AH<AF;AH++){if(!AG[AH].isValid()){return false;}}return true;},isEmpty:function W(){return w(this);},_itemChangeHandler:function(AI){var AK=AI.name,AL=AI.d,AG,AF=this.items.length,AH;switch(AK){case"ItemEditBegin":if(this.editingIdx!==null){AH=L.call(this);if(AH){AH.blur();}}AG=this.itemIndex(AL);this.editingIdx=AG;N.call(this);break;case"ItemEditEnd":this.editingIdx=null;if(AI.deactivate){D.call(this);}else{N.call(this);}AH=n.call(this);if(AH){AH.adjustInputWidth();}break;case"ItemDelete":if(this.editingIdx!==null){AH=L.call(this);if(AH){AH.blur();}this.editingIdx=null;}AG=this.itemIndex(AL);this.remove(AG);if(!AI.deactivate){this.editingIdx=null;N.call(this);}else{if(!this.isActive){D.call(this);}else{N.call(this);}}break;case"ItemDeletePrev":if(AF>1){this.remove(AF-2);}break;case"ItemAdd":var AJ=S.copy(AI.d);this.add([AJ],AF-1);if(AI.deactivate){D.call(this);}else{N.call(this);}break;case"SuggestionOn":this.set("suggestTarget",AI.target);this._pop_cfg={target:AI.target,left:AI.l,top:AI.t,zIndex:this.zIndex?this.zIndex:100};this.showSuggestion(AI.pattern);break;case"SuggestionOff":this.set("suggestTarget",null);this.hideSuggestion();break;}if(this.onitemchange&&(AK==="ItemEditEnd"||AK==="ItemAdd"||AK==="ItemDelete"||AK==="ItemDeletePrev"||AK==="ItemEditing")){this.onitemchange();}},unrender:function B(AG){var AF=this.suggestionPopup;if(AF.hasRendered){AF.unrender(false);}if(this._super){this._super(AG);}},destroy:function v(AG){var AF=this.suggestionPopup;if(AF&&AF.hasRendered){AF.destroy(false);}if(this._super){this._super(AG);}}});mstrmojo._HasMarkup.addMarkupMethods(mstrmojo.ObjectInputBox,{onenabledChange:mstrmojo.Widget.enabledMarkupMethod});mstrmojo.requiresCls("mstrmojo.Widget","mstrmojo._HasEllipsis");var t="mstrmojo-ObjectItem-text";mstrmojo.ObjectItem=mstrmojo.declare(mstrmojo.Widget,[mstrmojo._HasEllipsis],{scriptClass:"mstrmojo.ObjectItem",markupString:'<div id={@id} class="mstrmojo-ObjectItem" style="{@cssText}"><div class="mstrmojo-ObjectItem-displayNode"><span title=" {@en@title}" class="'+t+' {@cssClass}"></span><img class="mstrmojo-ObjectItem-edit" src="../images/1ptrans.gif" title="'+mstrmojo.desc(1088,"Edit")+'" onclick="mstrmojo.all[\'{@id}\'].edit()"/><img class="mstrmojo-ObjectItem-del" src="../images/1ptrans.gif" title="'+mstrmojo.desc(629,"Delete")+'" onclick="mstrmojo.all[\'{@id}\'].del(arguments[0])"/></div><div class="mstrmojo-ObjectItem-editNode"><input type="text" class="mstrmojo-ObjectItem-input" mstrAttach:keyup,keydown/></div></div>',markupSlots:{displayNode:function(){return this.domNode.firstChild;},editNode:function(){return this.domNode.childNodes[1];},textNode:function(){return this.domNode.firstChild.firstChild;},editButtonNode:function(){return this.domNode.firstChild.childNodes[1];},delButonNode:function(){return this.domNode.firstChild.lastChild;},inputNode:function(){return this.domNode.childNodes[1].firstChild;}},markupMethods:{oncssClassChange:function(){this.textNode.className=t+" "+this.cssClass;},onstateChange:function(){var AH=this.state,AG=mstrmojo.Enum_OIB_States_CSS[AH],AF=this.domNode;if(AH===b.EMPTY){AF.innerHTML=this.enabled?'<div class="mstrmojo-ObjectItem-emptyText">'+this.text+"</div>":"";}else{if(AH===b.EDITING){this.reduceWidth();}}AF.className="mstrmojo-ObjectItem "+AG;this.updateButtonsVisibility(this.data);},ontextChange:function(){this.inputNode.value=this.text;this.textNode.innerHTML=mstrmojo.string.encodeHtmlString(this.text);}},reduceWidth:function(){var AF=Math.round(this.displayNode.clientWidth);this.editNode.style.width=AF-4+"px";this.inputNode.style.width=AF-9+"px";},updateButtonsVisibility:function AE(){if(this.parent.hideEditButton(this.data)){this.editButtonNode.style.display="none";}},state:b.VALID,onstateChange:function g(AF){this.data.state=this.state;},ontextChange:function H(AF){this.data[this.itemField]=this.text;},onfocus:function z(){N.call(this.parent);},updateData:function F(AF){S.copy(AF,this.data);this.set("state",b.VALID);this.set("text",this.data[this.itemField]);this.set("cssClass",this.parent.item2textCss(this.data));},init:function AA(AG){this._super(AG);var AI=this.data,AF=AI.state,AH=this.parent;AF=this.initState();this.cssClass=AH.item2textCss(AI);this.text=AI[this.itemField];this.state=AF;this.isAdding=j(AI);this.useRichTooltip=true;this.title=this.text;},initState:function K(){var AG=this.parent,AH=this.data,AF=AH.state;if(AH&&AH.did){AH.state=b.VALID;return AH.state;}if(typeof AF==="undefined"){AF=AG.dynamicVerify?AG.verifyObject(AH[this.itemField],this):b.UNDETERMINED;AH.state=AF;}return AF;},isValid:function C(){var AF=parseInt(this.state,10);return(AF!==b.INVALID&&AF!==b.UNDETERMINED);},adjustInputWidth:function A(){if(this.isAdding){var AI=this.inputNode.style;AI.width=AD+"px";var AH=this.domNode.parentNode,AF=AH.parentNode.offsetWidth,AG=Math.max(AF-AH.offsetLeft-20,AD);if(!isNaN(AG)){AI.width=AG+"px";}}},blur:function U(){this.hideSuggestion();if(!this.isActive){return ;}this.isActive=false;var AH=this.inputNode,AF=AH.value,AG=this.parent;window.setTimeout(function(){try{AH.blur();}catch(AI){}},0);if(!AF){return ;}if(AG.acptSugItemOnly&&this._tWas_){this.set("text",AF);this.set("text","");this._tWas_=null;return ;}this.setItem(AF,null,true);},focus:function u(){var AG=this.inputNode,AF=this.isActive;window.setTimeout(function(){try{AG.focus();if(AG.createTextRange&&!AF){var AI=AG.createTextRange(),AH=AG.value.length;AI.move("character",AH);AI.select();}else{if(AG.setSelectionRange&&!AF){var AH=AG.value.length;AG.setSelectionRange(AH,AH);}}}catch(AJ){}},0);this.isActive=true;},prekeydown:function J(AF){var AH=this.inputNode.value,AG=parseInt(AF.e.keyCode||AF.e.charCode,10),AJ=this.parent;if(!AH){return ;}if(AG===AB.TAB||AG===AB.ENTER){if(AG===AB.ENTER){Q.preventDefault(AF.hWin,AF.e);}var AI=AJ.getSelected();if(AI&&AI.did){AJ.handleSuggestionItemSelect(AI);}else{this.hideSuggestion();if(!AJ.acptSugItemOnly){this.setItem(AH,null,false);}else{this.set("text",AH);this.set("text","");}}}else{if(AG===AB.DOWN_ARROW){if(!AJ.noCache&&!AJ.suggestionShown){this.showSuggestion(AH);AJ.preHighlight();}AJ.nextHighlight();}else{if(AG===AB.UP_ARROW){AJ.preHighlight();}}}},prekeyup:function AC(AF){var AH=this.inputNode.value,AG=parseInt(AF.e.keyCode||AF.e.charCode,10),AK=this.isAdding,AJ=this.parent;if(!AH){if(AK){if(AG===AB.BACKSPACE&&!this._tWas_){this.raiseEvent({name:"ItemDeletePrev"});Q.preventDefault(AF.hWin,AF.e);}this._tWas_=null;}else{this.raiseEvent({name:"ItemDelete",d:this.data});}this.hideSuggestion();return ;}if(AG===AB.ESCAPE||AG===AB.TAB){this.hideSuggestion();if(AJ.acptSugItemOnly){this.set("text",AH);this.set("text","");this._tWas_=null;return ;}}else{if(this._tWas_!==AH){this.textChanged=true;this.raiseEvent({name:"ItemEditing",d:this.data});if(AJ.useKeyDelay){window.clearTimeout(this._timerID);var AI=this;this._timerID=window.setTimeout(function(){var AL=AI.inputNode.value;if(AL){AI.showSuggestion(AL);}AI._timerID=null;},Y());}else{this.showSuggestion(AH);}}}this._tWas_=AH;},setItem:function(AF,AH,AG){var AI=this.isAdding;AG=AG||false;this.set("text",AF);if(AI){this.setItem_Adding(AF,AH,AG);}else{this.setItem_Editing(AF,AH,AG);}this._tWas_=null;},setItem_Adding:function(AF,AH,AG){this.set("text","");if(!AH){AH={};AH[this.itemField]=AF;}else{AH.state=b.VALID;}this.raiseEvent({name:"ItemAdd",d:AH,deactivate:AG});},setItem_Editing:function(AF,AH,AG){var AI=this.parent;this.set("text",AF);if(AH){this.updateData(AH);}else{if(this.textChanged){var AJ={};AJ[d]=this.data[d];delete this.data.did;this.data=AJ;this.textChanged=false;}this.set("state",AI.verifyObject(AF,this));this.set("cssClass",AI.item2textCss(this.data));}this.isActive=false;this.raiseEvent({name:"ItemEditEnd",d:AH,deactivate:AG});},getSearchPattern:function X(){return(this.inputNode?this.inputNode.value:"");},showSuggestion:function p(AF){var AG=mstrmojo.dom.position(this.domNode,true);this.raiseEvent({name:"SuggestionOn",l:Math.round(AG.x)+"px",t:Math.round(AG.y+AG.h)+"px",pattern:AF,target:this});},hideSuggestion:function h(){this.raiseEvent({name:"SuggestionOff"});},del:function R(AF){AF=AF||self.event;Q.stopPropogation(self,AF);this.raiseEvent({name:"ItemDelete",d:this.data,deactivate:true});if(this.useRichTooltip&&this.hideTooltip){this.hideTooltip();}},edit:function Z(){this.set("state",b.EDITING);this.raiseEvent({name:"ItemEditBegin",d:this.data});if(this.showSuggestionOnEdit){this.showSuggestion(this.text);}},doEllipsize:function f(){if(!this.shouldEllipsize){return ;}var AG=this.maxItemWidth,AF;if(AG){this.domNode.style.maxWidth=AG;switch(parseInt(this.state,10)){case b.VALID:case b.UNDETERMINED:case b.INVALID:AF=this.textNode;break;case b.EMPTY:AF=this.domNode.firstChild;break;}if(AF){this.set("richTooltip",{content:this.text,contentNodeCssClass:"sp-tooltip",posType:mstrmojo.tooltip.POS_TOPLEFT,left:0,top:30,refNode:this.domNode});mstrmojo.css.addClass(AF,"truncated");}}}});}());(function(){mstrmojo.requiresCls("mstrmojo.vi.ui.rw.selectors.CheckList","mstrmojo.ui.SearchBox","mstrmojo.string","mstrmojo.css","mstrmojo.hash","mstrmojo.dom");var B=mstrmojo.string,Y=mstrmojo.css,O=mstrmojo.hash,E=mstrmojo.dom,R=mstrmojo.tooltip,P="\u001E",F="\u001F";function K(a,d){var c=a.n;if(!d){return c;}var b=new RegExp(B.regEscape(d),"ig");if(c!==undefined&&b.test(c)){return c.replace(b,function(e){return P+e+F;});}return undefined;}function M(){return this.orientation==="v"?this.width:"135px";}function G(){return function(a){if(this._super){this._super(a);}var b=this.searchInput;if(b){b.set("width",M.call(this));}};}mstrmojo.vi.ui.rw.selectors.SearchableCheckList=mstrmojo.declare(mstrmojo.vi.ui.rw.selectors.CheckList,null,{scriptClass:"mstrmojo.vi.ui.rw.selectors.SearchableCheckList",init:function Q(a){this._super(a);Y.addWidgetCssClass(this,"searchable");},searchInput:null,_set_items:function N(b,c){this._super(b,c);var a=this.searchInput;if(a){a.set("visible",c.length>15);}},buildRendering:function I(){if(this.isHoriz&&this.itemWidthMode===0){this.renderOnScroll=false;}this._super();var c=document.createElement("div"),e=c.appendChild(document.createElement("div")),d=this.scrollboxNode,b=this.items,f=this.id;c.className="search";this.domNode.insertBefore(c,d);var a=this.searchInput;if(!a){a=this.searchInput=new mstrmojo.ui.SearchBox({width:M.call(this),searchTriggered:function(h){var g=mstrmojo.all[f];g.filterItems(h);g.hideTooltip();}});this.addDisposable(a);}a.visible=b&&b.length>15;a.placeholder=e;a.render();},preBuildRendering:function C(){var a=this._super();if(this.idx2ridx){delete this.idx2ridx;}return a;},onorientationChange:G(),onwidthChange:G(),updateScrollbars:function Z(){var a=this.scrollboxNode;if(this.hasRendered&&this.orientation==="v"){a.style.height=this.getScrollboxHeight()+"px";}this._super();},getScrollboxHeight:function L(){var a=this.searchInput,b=E.position(a.domNode);if(a.visible){return parseInt(this.height,10)-b.h-8;}return parseInt(this.height,10);},unrender:function V(b){var a=this.searchInput;if(a){a.unrender(b);}return this._super(b);},getItemProps:function W(b,a){var c=this._super(b,a);c.html=B.encodeHtmlString(c.n).replace(new RegExp(P,"ig"),"<em>").replace(new RegExp(F,"ig"),"</em>");return c;},getItemMarkup:function J(b,a){return this._super(b,a).replace("@en@n","@html");},_getItemNode:function H(a){var b;if(O.isEmpty(this.idx2ridx)){b=a;}else{if(this.idx2ridx[a]!==undefined){b=this.idx2ridx[a];}else{return null;}}return this._super(b);},updateTooltipConfig:function U(k,f){var h=k.target||E.eventTarget(k.hWin,k.e),a="vi-tooltip-C",j=R.POS_TOPLEFT;var d=h.parentElement||h,g=d.children[1],e=E.position(d);var b=e.w,c=E.windowDim().w;if(c<(e.x+b+300)){a="vi-tooltip-D";b=-10;j=R.POS_TOPRIGHT;}this.richTooltip={content:this.getTooltipContent(k),cssClass:"vi-regular "+a,top:-4,left:b,refNode:g||d,posType:j};},filterItems:function S(){var a=[];this.renderIndex=0;this.itemsContainerNode.innerHTML="";this.idx2ridx={};this.updateRenderableItems();this.renderableItems.forEach(function(c,b){a.push(this.itemRenderer.render(c,c._renderIdx,this));this.idx2ridx[c._renderIdx]=b;},this);this.itemsContainerNode.innerHTML=a.join("");this.updateScrollbars();},updateRenderableItems:function D(){var f=this.itemsContainerNode.lastChild,d=f&&parseInt(f.getAttribute("idx"),10)+1,c=typeof d==="number"?d:0,a=this.items.length,b=this.renderOnScroll?this.renderBlockSize:a,e;this.renderableItems=[];while(c<a&&this.renderableItems.length<b){e=this.getFilteredItem(c);if(e){this.renderableItems.push(e);}c++;}},getFilteredItem:function X(a){var f=this.items[a],d=this.searchInput;if(!d||d.isClear()){f._renderIdx=a;return f;}else{var e=d.text,c=K(f,e),b=e&&(!c||a===this.allIdx);if(!b){var g=JSON.parse(JSON.stringify(f));g._renderIdx=a;g.n=c;f._renderIdx=a;return g;}}return null;},onScrollEnd:function A(){var c={v:{dimension:"h",offsetDimension:"offsetHeight",scroll:"scrollTop",scrollDimension:"scrollHeight"},h:{dimension:"w",offsetDimension:"offsetWidth",scroll:"scrollLeft",scrollDimension:"scrollWidth"}},f=c[this.isHoriz?"h":"v"];if(this.renderOnScroll){var d=this.scrollNode,a=(this.renderIndex+1)*this.renderBlockSize;if(a>=this.items.length){return ;}if(d[f.offsetDimension]+Math.ceil(d[f.scroll])>=d[f.scrollDimension]){var b=[],e=this.itemsContainerNode.childElementCount;this.renderIndex++;this.updateRenderableItems();this.renderableItems.forEach(function(h,g){b.push(this.itemRenderer.render(h,h._renderIdx,this));if(this.idx2ridx){this.idx2ridx[h._renderIdx]=e+g;}},this);this.itemsContainerNode.innerHTML+=b.join("");}}},renderOnScroll:true,renderIndex:0,renderBlockSize:150});}());(function(){mstrmojo.requiresCls("mstrmojo.DocXtabGraph");var C=mstrmojo.dom,F=mstrmojo.array;function E(K){var I={},H={},J={};F.forEach(K,function(M){var L=M.goid+"."+M.ggid+"."+((M.gsid===undefined)?-1:M.gsid);if(!I[L]){I[L]={};}if(!H[M.co+"."+L]){if(J[L]===undefined){J[L]=0;}else{J[L]++;}I[L][J[L]]={co:M.co,sh:M.sh};H[M.co+"."+L]="true";}});return I;}function B(H,J){var K={},I="";F.forEach(H,function(L){I=L.goid+"."+L.ggid+"."+((L.gsid===undefined)?-1:L.gsid);if(K[I]===undefined){K[I]=0;}else{K[I]++;}var M=J[I]&&J[I][K[I]];if(M){L.coords=M.co;L.shape=M.sh;}});}mstrmojo.OIVMDocXtabGraph=mstrmojo.declare(mstrmojo.DocXtabGraph,null,{scriptClass:"mstrmojo.OIVMDocXtabGraph",unrender:function G(){this.clearCache();delete this.preLoader;this._super();},postBuildRendering:function D(){if(!this.preLoader){this.preLoader=document.createElement("img");}return this._super();},retrieveGraphSrc:function A(N,S){if(!N||parseInt(N,10)===0||parseInt(S,10)===0){return ;}if(isNaN(parseInt(this.node.data.sid,10))){return ;}var H=mstrConfig.taskURL+"?taskId=getRWGraphImage&taskEnv=xhr&__ts__="+(new Date().getTime())+"&messageID="+this.model.docModel.mid+"&nodeKey="+this.k+"&sliceID="+parseInt(this.node.data.sid,10)+"&imgType=4&width="+parseInt(S,10)+"&height="+parseInt(N,10),V=this.preLoader,W=this.imgNode,I=this.id,R=this;H=mstrmojo.addCSRFTokenToURL(H);if(V.dsrc!==H){V.dsrc=H;var M=function(){mstrApp.removeLoadingGraph(I);},U="load",L="error",Q,K,P,J;K=C.attachOneTimeEvent(V,U,function(){J=C.attachOneTimeEvent(W,U,function(){M();W.style.background="none";mstrmojo.all[I].defn.set("readyState",mstrmojo.EnumReadystate.IDLE);C.detachEvent(W,L,P);},true);P=C.attachOneTimeEvent(W,L,function(){M();C.detachEvent(W,U,J);},true);C.detachEvent(V,L,Q);W.src=V.src;},true);Q=C.attachOneTimeEvent(V,"error",function(){M();C.detachEvent(V,U,K);},true);var O=this.model.docModel.zt;this.model.docModel.dataService.getRWGraphImage({k:this.k,sid:parseInt(this.node.data.sid,10),w:S,h:N,encodeImage:true,needCoordinate:mstrApp.optimizeFitToPage&&(O===1||O===2)?1:0},{success:function(X){V.src="data:image/png;base64,"+(X.image||X);if(X.coords){var Z=JSON.parse(X.coords),Y={};Y=E.call(R,Z);B.call(R,R.as,Y);R.refreshMap();}},failure:function(){Q();}});}}});}());(function(){mstrmojo.requiresCls("mstrmojo.color","mstrmojo.dom","mstrmojo.css","mstrmojo._HasOwnAvatar","mstrmojo.Container","mstrmojo.threshold.ThresholdModel","mstrmojo.threshold.ColorMarker");var Q=mstrmojo.color,D=mstrmojo.dom,R=mstrmojo.css;function B(X){var W=this.parent,V=W.width,Y=Math.min(Math.max(X.last.x-D.position(this.domNode).x,0),V-1);return Y/V;}mstrmojo.threshold.MarkersNode=mstrmojo.declare(mstrmojo.Container,[mstrmojo._HasOwnAvatar],{scriptClass:"mstrmojo.threshold.MarkersNode",cssClass:"markers",markupString:'<div id="{@id}" class="{@cssClass}" style="{@cssText}"  mstrAttach:click,mousedown,mouseover,mouseout></div>',markupSlots:{containerNode:function O(){return this.domNode;}},dropZone:true,draggable:true,avatarCssClass:"marker-drag-avatar",addMarker:function P(c){this.parent.parent.switchToCustomScheme();var V=this.parent,f=V.parent.model,e=D.position(this.containerNode).w,W=V.getPalette(),a=c/e,Y=V.addMarkerToMap(a),b=W.length,Z=new mstrmojo.threshold.ColorMarker();Z.updateCompValue(a);Z.updateRealValue(f.getRealValue(a,V.selectedOption,V.minValue(),V.maxValue()));Z.set("index",Y);this.addChildren([Z]);if(b===(Y+1)){Y--;}if(this.selectedIndex!==undefined&&this.selectedIndex>-1&&this.selectedIndex<this.children.length){this.children[this.selectedIndex].unselect();}this.selectedIndex=Z.index;var X=W[Y+1],d=Y===-1?X:W[Y];W.splice(Y+1,0,Q.findMidColorHex(d,X));V.update();this.children[this.selectedIndex].select();},remove:function M(V){if(V<0||V>=this.children.length){return ;}this.children[V].unselect();this.children.splice(V,1);this.domNode.removeChild(this.domNode.children[V]);},onclick:function U(W){if(this.parent.sliderMode===mstrmojo.threshold.ThresholdModel.SLIDER_MODE.COLOR_BASED&&W.getTarget()===this.domNode){var X=D.position(this.containerNode),V=W.e.clientX-X.x;this.addMarker(V);}},premousedown:function L(){this.parent.unselectAll();},createAvatar:function K(Y,X){var W;for(W=0;W<this.children.length;W++){if(this.children[W].id===Y.id){X.tgtNode=this.children[W];X.i=W;}}var V=Y.cloneNode(true),Z=document.createElement("div");R.addClass(Z,"bar");V.appendChild(Z);return V;},positionAvatar:function I(b){var V=this.avatar,X=V.style,Z=this.restrictedToAxis,W=D.position(this.domNode),Y=W.y;if(V){if(Z!=="y"){var a=b.x;if(a<W.x){a=W.x;}if(a>W.x+W.w){a=W.x+W.w-1;}X.left=a-2+"px";}if(Z!=="x"){X.top=Y+"px";}}},getMarkerComps:function H(V){if(!this.children){return undefined;}var W=this.children.map(function(X){return X.compValue;});return !!V?W.sort(V):W;},getMarkerRealValues:function N(V){if(!this.children){return undefined;}var W=this.children.map(function(X){return X.realValue;});return !!V?W.sort(V):W;},setMarkerRealValues:function F(W,Y,V,X){if(!this.children){return ;}this.children.forEach(function(a,Z){a.updateRealValue(W(a.compValue,Y,V,X));});},isDragValid:function A(V){return V.src.node!==this.domNode;},ondragstart:function S(W){this._super(W);var V=this.parent.getComp();this.selectedIndex=W.i;V.splice(W.i,1);},ondragmove:function J(W){this._super(W);var Z=this.parent,Y=Z.getComp(),d=Z.parent.model,X=B.call(this,W),a=this.children[W.i],V=W.tgt.pos.x-W.src.pos.x,b=V<0,c=V>0;if((a.compValue===0&&b)||(a.compValue===1&&c)){return ;}a.updateCompValue(X);a.updateRealValue(d.getRealValue(X,Z.selectedOption,Z.minValue(),Z.maxValue()));Z.editableBubble.showBubble(X,a.realValue);},ondragend:function E(X){var W=this.parent;comp=W.getComp(),currentMarker=this.children[X.i],newIndex=currentMarker.index,crossedIndices=this.children.filter(function(Z){return(Z.index>currentMarker.index&&Z.compValue<currentMarker.compValue)||(Z.index<currentMarker.index&&Z.compValue>currentMarker.compValue);}).map(function(Z){return Z.index;});if(crossedIndices.length>0){var V=crossedIndices[0],Y=crossedIndices[crossedIndices.length-1];newIndex=(currentMarker.index>V)?V:Y;}comp.splice(newIndex,0,currentMarker.compValue);this.remove(currentMarker.index);W.update();this.children[newIndex].select();this._super(X);},onmouseover:function G(W){if(this.parent.sliderMode===mstrmojo.threshold.ThresholdModel.SLIDER_MODE.COLOR_BASED&&!this._cursorAvatar){var Z=document,Y=this.domNode,X=this._cursorAvatar=Z.createElement("div"),V=this._mouseMoveHandler=function(d){var c=D.eventTarget(self,d),b=D.getMousePosition(d,self),a=X.style;a.top=b.y+12+"px";a.left=b.x+12+"px";a.display=(c===Y&&mstrApp.isInteractive())?"block":"none";};Z.body.appendChild(X);R.addClass(X,"mstrmojo-SimpleThresholdEditor add-cursor");D.attachEvent(Y,"mousemove",V);}if(this._super){return this._super(W);}},onmouseout:function C(V){if(this.parent.sliderMode===mstrmojo.threshold.ThresholdModel.SLIDER_MODE.COLOR_BASED){D.detachEvent(this.domNode,"mousemove",this._mouseMoveHandler);var W=this._cursorAvatar;W.parentNode.removeChild(W);delete this._cursorAvatar;delete this._mouseMoveHandler;}if(this._super){return this._super(V);}}});}());(function(){mstrmojo.requiresCls("mstrmojo.array","mstrmojo.hash","mstrmojo.css","mstrmojo.dom","mstrmojo.expr","mstrmojo.range","mstrmojo.Widget","mstrmojo.WidgetList","mstrmojo.WidgetListMapper","mstrmojo._HasSuggestion","mstrmojo.ME.MetricToken","mstrmojo.ME.MetricDataService","mstrmojo.ui.ScrollableSuggestionList","mstrmojo.mstr.EnumDSSXMLObjectTypes");var R=mstrmojo.dom,U=mstrmojo.css,AJ=mstrmojo.Enum_Keys,H=mstrmojo.range,l=H.EDGE,AB=mstrmojo.ME.MetricToken.isDelimiter,Q=mstrmojo.expr,t=mstrmojo.array,K=mstrmojo.hash;var M=R.isIE||R.isIEW3C;function AR(E){return E.ctrlKey||R.isMetaKey(window,E)||(E.charCode||E.keyCode)===AJ.CTRL;}mstrmojo.ME.SpanListMapper=mstrmojo.provide("mstrmojo.ME.SpanListMapper",mstrmojo.mixin({itemWrapperPrefix:function(E){return'<span class="'+this.getWrapperCss(E)+'">';},itemWrapperPrefill:"&nbsp;",itemWrapperSuffix:"</span>",createWrapperNode:function S(E){var AS=E.ownerDocument,AT=AS.createElement("span");return AT;},_iw2idx:function V(AS,AV,AU){var AT=this.wrapperNodes(AV),E=mstrmojo.array.indexOf(AT,AU);return E===-1?AT.length:E;},itemOffsetLeft:function j(AS,AW,E,AU){if(!AU){var AT=this.wrapperNodes(AW);AU=AT&&AT[E];if(!AU){return 0;}}var AV=AW.firstChild;if(!AV||(AV===AU)){return 0;}return AU.offsetLeft-AV.offsetLeft;},whereDrop:function AQ(Aa,E,AU,AZ,AS){var AW=this._nd2iw(Aa,E,AU),Ab,AY,AV,AX,AT;if(AW){AY=this._iw2idx(Aa,E,AW);Ab=AY;AV=this.itemOffsetLeft(Aa,E,null,AW);AX=AW.offsetTop;AT=AW.offsetWidth;if(AZ.x>AS.left+AV+AT/2){Ab++;AV+=AT;}}else{return Aa.dropCuePos;}return{left:AV,top:AX,idx:Ab,idxActual:AY};}},mstrmojo.hash.copy(mstrmojo.WidgetListMapper)));mstrmojo.ME.TokenInputBox=mstrmojo.declare(mstrmojo.WidgetList,[mstrmojo._HasSuggestion],{scriptClass:"mstrmojo.ME.TokenInputBox",containerResizable:false,dropZone:true,suggestionPopupCssClss:"mstrmojo-ME-TokenInputBox-suggest",allowDrop:function G(E){var AS=E.src.data;return !!AS;},createToken:function A(E){return{v:mstrmojo.ME.MetricToken.brackets(E.n),oi:K.copyProps(["did","n","t"],E),isNew:true};},ondrop:function(AS){AS.src.data=this.createToken(AS.src.data.item);if(this.prepareDropItem){this.prepareDropItem(AS);}var E=this.insertTokens([AS.src.data]);this.set("dropCuePos",null);mstrmojo.css.removeClass(this.domNode,"unselectable");return E;},ondragenter:function I(E){this.dragdata=E.src.data;this._super(E);this.set("dropCuePos",{left:0,top:0});mstrmojo.css.addClass(this.domNode,"unselectable");},ondragleave:function W(){this.set("dropCuePos",null);mstrmojo.css.removeClass(this.domNode,"unselectable");},ondropCuePosChange:function Y(AS){var AT=AS.value,E=this.dragdata;if(E&&E.setAvatarClass){if(AT){E.setAvatarClass("add");}else{E.setInvalidAvatarClass();}}},makeObservable:true,showDesc:true,showPath:true,showFunctionSyntaxAsPath:true,blockCount:mstrmojo.ME.MetricDataService.blockCount,suggestCount:mstrmojo.ME.MetricDataService.suggestCount,markupString:'<div id={@id} class="mstrmojo-TokenInputBox {@cssClass}" style="{@cssText}"><div class="mstrmojo-TokenInputBox-edit" contenteditable="true" tabindex="1" spellcheck="false"ondragstart = "return false;" oncontextmenu = "return false;" onkeydown = "return mstrmojo.all.{@id}.handlekeydown(event);" onkeypress = "return mstrmojo.all.{@id}.handlekeypress(event);" onkeyup = "return mstrmojo.all.{@id}.handlekeyup(event);" onmouseup = "return mstrmojo.all.{@id}.handlemouseup(event);" onpaste = "return mstrmojo.all.{@id}.handlepasteDirect(event);" onblur = "return mstrmojo.all.{@id}.handleblur(event);" >{@itemsHtml}</div><textarea class = "mstrmojo-TokenInputBox-clipboard" onkeyup = "return mstrmojo.all.{@id}.handlepaste(event);"></textarea><div class="mstrmojo-ListBase2-dropCue {@cssClass}"><div class="mstrmojo-ListBase2-dropCue-inner"></div></div></div>',markupSlots:{editNode:function(){return this.domNode.firstChild;},itemsContainerNode:function(){return this.domNode.firstChild;},clipboardNode:function(){return this.domNode.childNodes[1];},scrollboxNode:function(){return this.domNode.firstChild;},dropCueNode:function(){return this.domNode.lastChild;}},suggestionListClass:"mstrmojo.ui.ScrollableSuggestionList",items:null,itemFunction:function J(AT,E,AS){return new mstrmojo.ME.MetricToken({data:AT,parent:AS});},listMapper:mstrmojo.ME.SpanListMapper,_set_items:function X(AS,E){if(this._super){this._super(AS,E);}if(this.oi){this.oi.tks.items=this.items;}if(!this.tokensCacheInitilized){this.pretokensModify();this.tokensCacheInitilized=true;}},tokensCache:[],tokensCachePointer:0,isDelimiter:AB,postBuildRendering:function e(){if(this._super){this._super();}this._eros=false;if(R.isFF){document.body.spellCheck=false;}mstrmojo.dom.attachEvent(this.editNode,"compositionstart",function(){this.saveStateForIME();this.composing=true;this.toggleIMEStatusBar(true);}.bind(this));mstrmojo.dom.attachEvent(this.editNode,"compositionupdate",function AS(AT){if(R.isIEW3C){this.lastImeChar=AT.data||(M&&this.lastImeChar);}else{this.lastImeChar=AT.data||this.lastImeChar;}}.bind(this));mstrmojo.dom.attachEvent(this.editNode,"compositionend",function E(AV){this.composing=false;if(R.isIE9||R.isIE10){var AU=H.getRangeInfo();this.imeBuffer=AU.startContainer.data.slice(this.prev_rInfo.startOffset,AU.startOffset).split("");}else{if(R.isIEW3C){var AU=H.getRangeInfo();this.imeBuffer=AU.startContainer.data.slice((this.prev_rInfo.startOffset-1)<0?0:this.prev_rInfo.startOffset,AU.startOffset).split("");}else{if(R.isEdge){var AT=AV.data||"";this.imeBuffer=(this.imeBuffer||[]).concat(AT.split(""));}else{var AT=AV.data||this.lastImeChar||"";this.imeBuffer=(this.imeBuffer||[]).concat(AT.split(""));}}}}.bind(this));},fnContextMenu:function N(E){if(E){E.cancelBubble=true;E.returnValue=false;}return false;},saveStateForIME:function h(){if(!this.doubleByte){this.doubleByte=true;this.prev_rInfo=H.getRangeInfo();this.prev_items=this.items;}},handleblur:function L(){if(this.doubleByte){this.doubleByte=false;this.widgetHandleImeInput(this.prev_rInfo);this.prev_items=this.items;}},processDeleteKeyDown:function D(AS){if(!this.doubleByte){try{this.widgetHandleDelete(AS);this.startTokenSuggestion();this.raiseChangeEvent({type:"delete"});}catch(E){}return true;}},processBackspaceKeyDown:function AP(AS){if(!this.doubleByte){try{this.widgetHandleBackspace(AS);this.raiseChangeEvent({type:"backspace"});this.startTokenSuggestion();this.editNode.focus();}catch(E){}return true;}},handlekeydown:function b(AU){AU=AU||window.event;var E=AU.keyCode||AU.charCode,AS=false,AT=H.getRangeInfo();if((E===AJ.LEFT_ARROW||E===AJ.RIGHT_ARROW||E===AJ.BACKSPACE)&&this.doubleByte){if(this.composing){return ;}this.doubleByte=false;if(E===AJ.BACKSPACE){this.imeBuffer.pop();}this.widgetHandleImeInput(this.prev_rInfo);mstrmojo.dom.stopPropogation(window,AU);mstrmojo.dom.preventDefault(window,AU);return false;}switch(E){case AJ.DELETE:AS=this.processDeleteKeyDown(AT);break;case AJ.BACKSPACE:AS=this.processBackspaceKeyDown(AT);break;case AJ.ENTER:if(this.breakOnEnterKeyDown&&this.breakOnEnterKeyDown()){break;}case AJ.TAB:this._startDebug=true;if(this.suggestionShown){this.handleSuggestionItemSelect(this.getSelected());}else{this.startTokenSuggestion();}AS=true;break;case AJ.ESCAPE:this.endTokenSuggestion();AS=true;break;case 86:if(AR(AU)){this.handlePasteTriggeredDeletion();AS=false;}break;case 89:if(AR(AU)){this.widgetHandleUndoRedo("redo");AS=true;}break;case 90:if(AR(AU)){this.widgetHandleUndoRedo("undo");AS=true;}break;case 229:this.saveStateForIME();break;default:}if(AS){R.stopPropogation(window,AU);R.preventDefault(window,AU);return false;}return true;},handlePasteTriggeredDeletion:function F(){this.set("_saveRangeInfo",H.getRangeInfo());if(!this._saveRangeInfo.collapsed){this.widgetHandleDelete(this._saveRangeInfo);this.set("_saveRangeInfo",H.getRangeInfo());}this.clipboardNode.focus();},getCharacter:function AL(AS){var E=(R.isIE&&!R.isIE9)?AS.keyCode:AS.charCode;return(E>0)?String.fromCharCode(E):null;},handleCharacter:function AC(AU){var AV=this.getCharacter(AU),AS=false;if(AV&&!((AV==="c"||AV==="a")&&AR(AU))){try{this.widgetHandleInput(H.getRangeInfo(),AV);this.raiseChangeEvent({type:"input",character:AV});if(!this.isDelimiter(AV)){if(this.useKeyDelay){var AT=this;window.clearTimeout(this.tmr);this.tmr=window.setTimeout(function(){AT.startTokenSuggestion();},mstrmojo.ME.MetricDataService.suggestDelay);}else{this.startTokenSuggestion();}}else{this.endTokenSuggestion(true);}}catch(E){}AS=true;}return AS;},handlekeypress:function B(E){E=E||window.event;if(this.doubleByte){this.toggleIMEStatusBar(false);this.doubleByte=false;this.widgetHandleImeInput(this.prev_rInfo);window.setTimeout(function(){this.handleCharacter(E);}.bind(this),10);return false;}if(this.handleCharacter(E)){R.stopPropogation(window,E);R.preventDefault(window,E);return false;}return true;},handlekeyup:function g(AT){var E=AT.keyCode||AT.charCode,AS;if(E===AJ.LEFT_ARROW||E===AJ.RIGHT_ARROW){AS=this.findObjectToken();if(AS&&AS===this._saveActiveToken){this.startTokenSuggestion(AS);}else{this.endTokenSuggestion();}}else{if(E===AJ.UP_ARROW){this.preHighlight();}else{if(E===AJ.DOWN_ARROW){this.nextHighlight();}else{if(E===AJ.BACKSPACE&&this.doubleByte){if(E===AJ.BACKSPACE&&!this.composing&&!R.isIE9){this.doubleByte=false;this.imeBuffer.pop();this.widgetHandleImeInput(this.prev_rInfo);this.prev_items=this.items;}}}}}this.set("_saveRangeInfo",H.getRangeInfo());},handlemouseup:function q(AU){if(this.dropCuePos){return false;}var AS=this.findObjectToken();if(AS&&AS===this._saveActiveToken){this.startTokenSuggestion(AS);}else{this.endTokenSuggestion();}var AT=H.getRangeInfo();if(this.doubleByte){this.doubleByte=false;var E=this.widgetHandleImeInput(this.prev_rInfo);this.prev_items=this.items;AS=R.findWidget(AT.startContainer);if(AS){this._delaySetTextCaretPos(AS.domNode,AT.startOffset);}else{this._delaySetTextCaretPos(E.domNode,AT.startOffset-1);}this.prev_rInfo=AT;}this.set("_saveRangeInfo",AT);},handlepasteDirect:function AG(E){this.clipboardNode.value=E.clipboardData.getData("Text");this.handlepaste(E);R.stopPropogation(window,E);R.preventDefault(window,E);this.handlePasteTriggeredDeletion();return false;},handlepaste:function o(AW){var AS=this.clipboardNode.value;this.clipboardNode.value="";var AV=[],E=AS&&AS.length,AU,AT="",AX;if(E>0){for(AU=0;AU<E;AU++){AX=AS.charAt(AU);if(this.isDelimiter(AX)){if(!mstrmojo.string.isEmpty(AT)){AV.push({v:AT,isNew:true});AT="";}AV.push({v:AX,isDelimiter:true,isNew:true});}else{AT=AT+AX;}}if(!mstrmojo.string.isEmpty(AT)){AV.push({v:AT,isNew:true});AT="";}this.insertTokens(AV);}},raiseChangeEvent:function(E){E.name="tokensModify";this.raiseEvent(E);},getTokensAsString:function AO(){var AS=[],AU=this.items,AT,E;for(AT=0,E=AU.length;AT<E;AT++){AS[AT]=AU[AT].v;}return AS.join("| ");},replaceErrorToken:function r(AU){var AT=this.items||[],AV=mstrmojo.array.find(AT,"sta",-1),AS,AW=function(Ac,Aa,Ad){var AZ=(Ac&&Ac.items)||[],AY=t.find(AZ,"did",Aa),AX,Ab;if(AY>-1){AX=AZ[AY].fs;Ab=t.filterOne(AX,function(Ae){return Ae.fnm&&Ae.fnm.toUpperCase()===Ad.toUpperCase();});}return Ab;},E=function(Ac,Aa,Ab){var AX={v:Aa.n,oi:Aa,isNew:true},AZ=Ac.v&&Ac.v.split("@"),AY;if(AZ&&AZ.length>1){AY=AW(Ab,Aa.did,AZ[1]);if(AY){AX.exv=AY.fmdid||AY.fid;AX.extp=8;AX.v=mstrmojo.ME.MetricToken.brackets(Aa.n)+"@"+AY.fnm;}}return AX;};if(AV>-1){AS=E(AT[AV],AU,this.candidates);this.remove(AV);this.add([AS],AV);}},widgetHandleDelete:function f(AV){if(AV.collapsed){var AU,AT,E,AW=AV.startOffset,AS=this.ctxtBuilder.itemWidgets;if(!R.contains(this.editNode,AV.startContainer,false,document.body)){H.collapseOnNode(this.editNode,false);return ;}AU=H.getEdgeInfo(AV.startContainer,AV.startOffset);AT=R.findWidget(AV.startContainer);E=this.itemIndex(AT.data);if(AU===l.EDGE_END){E++;AT=AS[E];AW=0;}if(!AT){H.collapseOnNode(this.editNode,false);return ;}if(AT.length()===1){this.remove(E);AT=AS[E];if(AT){H.collapseOnNode(AT.domNode,true);}else{H.collapseOnNode(this.editNode,false);}this.checkMergeTwoTokens(E-1,E);}else{AT.spliceContent(AW,1);H.collapseOnTextNode(AT.domNode,AW);}}else{this.widgetDeleteTokens(AV);}},widgetHandleBackspace:function AA(AV){if(AV.collapsed){var AU,AT,E,AW=AV.startOffset,AS=this.ctxtBuilder.itemWidgets;if(!R.contains(this.editNode,AV.startContainer,false,document.body)){if(AV.startOffset>0&&R.isFF){AT=AS[this.items.length-1];H.collapseOnNode(AT.domNode,false);AV=H.getRangeInfo();AU=H.getEdgeInfo(AV.startContainer,AV.startOffset);}else{H.collapseOnNode(this.editNode,true);return ;}}AU=H.getEdgeInfo(AV.startContainer,AV.startOffset);AT=R.findWidget(AV.startContainer);E=this.itemIndex(AT.data);if(AU===l.EDGE_BEGIN){E--;AT=AS[E];AW=AT.length();}if(!AT){H.collapseOnNode(this.editNode,true);return ;}if(AT.length()===1){this.remove(E);AT=AS[E-1];if(AT){H.collapseOnNode(AT.domNode,false);this.checkMergeTwoTokens(E-1,E);AT=AS[E-1];}else{H.collapseOnNode(this.editNode,true);}}else{AT.spliceContent(AW-1,1);H.collapseOnTextNode(AT.domNode,AW-1);}}else{this.widgetDeleteTokens(AV);}},widgetHandleInput:function AD(AW,AX){if(!AW.collapsed){this.widgetDeleteTokens(AW);AW=H.getRangeInfo();}var AT,AY,AZ,Aa,E,AS,AU=this.ctxtBuilder.itemWidgets;if(!R.contains(this.editNode,AW.startContainer,false,document.body)){this.add([{v:AX,isDelimiter:this.isDelimiter(AX),isNew:true}],0);AY=AU[0];H.collapseOnTextNode(AY.domNode,1);return ;}AT=H.getEdgeInfo(AW.startContainer,AW.startOffset);AY=R.findWidget(AW.startContainer);AZ=this.itemIndex(AY.data);if(this.isDelimiter(AX)){Aa={v:AX,isDelimiter:true,isNew:true};if(AT===l.EDGE_MIDDLE){var AV=AY.split2Tokens(AW.startOffset);this.remove(AZ);this.add([AV[0],Aa,AV[1]],AZ);AZ=AZ+1;}else{AZ=(AT===l.EDGE_BEGIN)?AZ:AZ+1;this.add([Aa],AZ);}AY=AU[AZ];H.collapseOnTextNode(AY.domNode,(AY.domNode.innerText||AY.domNode.textContent).length);}else{AS=AW.startOffset;if(AY.isDelimiter()){E=AU[(AT===l.EDGE_BEGIN)?AZ-1:AZ+1];if(E&&!E.isDelimiter()){AY=E;AS=(AT===l.EDGE_BEGIN)?AY.length():0;}}if(!AY.isDelimiter()){AY.spliceContent(AS,0,AX);H.collapseOnTextNode(AY.domNode,AS+1);}else{this.add([{v:AX,isNew:true}],(AT===l.EDGE_BEGIN)?AZ:AZ+1);AY=AU[(AT===l.EDGE_BEGIN)?AZ:AZ+1];H.collapseOnNode(AY.domNode,false);}}},widgetHandleImeInput:function AD(AV,AW){AW=AW||this.imeBuffer.join("");this.imeBuffer=[];this.lastImeChar=null;if(!AW){return ;}if(!AV.collapsed){this.widgetDeleteTokens(AV);AV=H.getRangeInfo();}var AT,AX,AY,AZ,E,AS,AU=this.ctxtBuilder.itemWidgets;if(!R.contains(this.editNode,AV.startContainer,false,document.body)||this.items.length==0){this.clearTokens();this.add([{v:AW,isDelimiter:this.isDelimiter(AW),isNew:true}],0);AU=this.ctxtBuilder.itemWidgets;AX=AU[0];H.collapseOnTextNode(AX.domNode,1);this._delaySetCaretPos(AX.domNode,false);return ;}AT=H.getEdgeInfo(AV.startContainer,AV.startOffset);AX=R.findWidget(AV.startContainer);AY=this.itemIndex(AX.data);AS=AV.startOffset;if(AX.isDelimiter()){this.clearTokens();this.add(this.prev_items);AU=this.ctxtBuilder.itemWidgets;E=AU[(AT===l.EDGE_BEGIN)?AY-1:AY+1];if(E&&!E.isDelimiter()){AX=E;AS=(AT===l.EDGE_BEGIN)?AX.length():0;}}if(!AX.isDelimiter()){AX.spliceContent(AS,0,AW);this._delaySetTextCaretPos(AX.domNode,AS+AW.length);}else{this.add([{v:AW,isNew:true}],(AT===l.EDGE_BEGIN)?AY:AY+1);AX=AU[(AT===l.EDGE_BEGIN)?AY:AY+1];this._delaySetCaretPos(AX.domNode,false);}this.startTokenSuggestion();return AX;},findObjectToken:function C(){var AV=H.getRangeInfo(),AT=R.findWidget(AV.startContainer);if(!R.contains(this.editNode,AV.startContainer,false,document.body)){return null;}if(!AT||AT===this||!AT.isDelimiter){return null;}if(AT&&!AT.isDelimiter()){return AT;}var AU=H.getEdgeInfo(AV.startContainer,AV.startOffset),AS=this.ctxtBuilder.itemWidgets,E=this.itemIndex(AT.data);AT=AS[(AU===l.EDGE_BEGIN)?E-1:E+1];if(AT&&!AT.isDelimiter()){return AT;}return null;},checkMergeTwoTokens:function x(AV,AT){var AU=this.ctxtBuilder.itemWidgets,AS=AU[AV],E=AU[AT];if((AS&&!AS.isDelimiter())&&(E&&!E.isDelimiter())){this.remove([AV,AT]);this.add([AS.mergeTo(E)],AV);H.collapseOnTextNode(AU[AV].domNode,AS.length());}},insertTokens:function AF(AW){var AZ=0,AY=this.editNode;var AT=this._saveRangeInfo||H.getRangeInfo();if(!AT||!R.contains(AY,AT.startContainer,false,document.body)){this.add(AW);AZ=this.items.length-1;if(AZ===0){this._delaySetTextCaretPos(AY,(AY.innerText||AY.textContent).length);}else{var E=this.ctxtBuilder.itemWidgets[AZ].domNode;this._delaySetTextCaretPos(E,(E.innerText||E.textContent).length);}}else{var AS=H.getEdgeInfo(AT.startContainer,AT.startOffset),AX=R.findWidget(AT.startContainer);AZ=this.itemIndex(AX.data);if(AS===l.EDGE_MIDDLE){var AU=AX.split2Tokens(AT.startOffset);this.remove(AZ);AW.unshift(AU[0]);AW.push(AU[1]);this.add(AW,AZ);}else{AZ=(AS===l.EDGE_BEGIN?AZ:AZ+1);this.add(AW,AZ);}AZ=AZ+AW.length-1;AX=this.ctxtBuilder.itemWidgets[AZ];this._delaySetCaretPos(AX.domNode,false);}this.raiseChangeEvent({type:"insert"});var AV=this;window.setTimeout(function(){AV.set("_saveRangeInfo",H.getRangeInfo());},50);return AZ;},insertParenthesisTokens:function AI(AS){var E=this;window.setTimeout(function(){var AT=E.insertTokens([{v:"(",isDelimiter:true,isNew:true},{v:")",isDelimiter:true,isNew:true}]);E._delaySetTextCaretPos(E.itemsContainerNode.childNodes[AT-1],1);},AS||50);},clearTokens:function w(E){this.set("items",E||[]);this.set("_saveRangeInfo",null);this._delaySetCaretPos(this.editNode,false);},focus:function AE(){var AS=this.ctxtBuilder.itemWidgets,E=AS.length;this._delaySetCaretPos(E>0?AS[E-1].domNode:this.editNode,false);},startTokenSuggestion:function AK(E){this.endTokenSuggestion();if(!E){E=this.findObjectToken();}if(E&&!E.isDelimiter()){E.set("active",true);this._saveActiveToken=E;this.showSuggestion(this.getSearchPattern());}if(!E||this.getSearchPattern().length===0){this.hideSuggestion();}},browseItemVisible:true,folderLinksContextId:25,browsableTypes:[Q.TP.FOLDER,Q.TP.FACT,Q.TP.ATTR,Q.TP.FUNCTION,Q.TP.FILTER,Q.STP.PROMPT_OBJECTS,Q.TP.ATTR,Q.TP.DIM,Q.TP.METRIC,Q.TP.ROLE].join(","),getSearchPattern:function a(){var AS=this._saveActiveToken,AU=AS&&AS.data.v,E=AU&&AU.length;if(E>2){if(AU.charAt(0)==="["){AU=AU.substring(1);}if(AU.charAt(AU.length-1)==="]"){AU=AU.substring(0,AU.length-1);}}if(AS&&AS.data.ift){var AT=AS.data.v,AV=AT&&AT.indexOf("@");if(AV>=0){AU=AT.substring(AV);}}return AU||"";},getSuggestionPos:function k(){var E=this._saveActiveToken,AS=null,AU,AT;if(E){AU=E.data&&E.data.ift;AT=mstrmojo.dom.position(E.domNode,true);AS={left:Math.round(AT.x+(AU?AT.w:0))+"px",top:Math.round(AT.y+AT.h)+"px",zIndex:100};}return AS;},item2textCss:function O(AS){var E=(this._super&&this._super(AS))||{4:"m",11:"fx",12:"a",13:"fc",43:"tr",21:"afm","-99":"br"}[AS.t]||"";E+=AS.da?" da":"";E+=(AS.dm||AS.um)?" dm":"";E+=AS.de?" de":"";E+=AS.fs&&AS.fs.length&&AS.fs.some(function(AT){return AT.fgr>0;})?" g":"";return E;},onBrowserOpen:function z(){this.editNode.blur();},onSuggestionItemSelect:function AH(AS){var E=this._saveActiveToken;this.endTokenSuggestion();if(E){if(E.data.ift&&AS.t===21){E.setFormInfo(AS);}else{E.setItemInfo(AS);if(AS.t===mstrmojo.mstr.EnumDSSXMLObjectTypes.Function){this.insertParenthesisTokens();}}this._delaySetCaretPos(E.domNode,false);}this.closePopup();},_delaySetCaretPos:function AM(E,AT){var AS=this.editNode,AU=this,AV=function(){AS.focus();AS.focus();H.collapseOnNode(E,AT);AU.set("_saveRangeInfo",H.getRangeInfo());};window.setTimeout(AV,0);},_delaySetTextCaretPos:function AM(E,AV){var AS=this.editNode,AT=this,AU=function(){AS.focus();AS.focus();H.collapseOnTextNode(E,AV);AT.set("_saveRangeInfo",H.getRangeInfo());};window.setTimeout(AU,0);},getCandidatesThroughTaskCall:function d(AS,E){AS.objectType="11,12,13,43,4";AS.rootFolderType=39;AS.blockCount=this.blockCount;mstrmojo.ME.MetricDataService.getMetricComponents(AS,E);},filterCandidates:function v(AV,AU,E){var AS=this._saveActiveToken,AW=AS&&(AS.data.oi||AS.data.at),AT;if(AW&&AS.data.ift){E=E||this.suggestCount;AU=mstrmojo.string.regEscape(AU);AT=t.filter(AV,function(AX){return AX.t===21&&AX.attid===AW.did&&(new RegExp("^"+AU,"i")).test("@"+AX.n);},{max:E});}else{AT=t.filter(AV,function(AX){return AX.t!==21;});AT=this._super(AT,AU,E);}return AT;},endTokenSuggestion:function AN(AS){var E=this._saveActiveToken;if(E){if(AS){this.hideSuggestion();}E.set("active",false);this._saveActiveToken=null;}},widgetDeleteTokens:function p(Aa){var AS=Aa.startOffset,E=Aa.endOffset,Ad=R.findWidget(Aa.startContainer),Ab=R.findWidget(Aa.endContainer),AW=this.itemIndex(Ad.data),AU=this.itemIndex(Ab.data),AX=[],AY=H.getEdgeInfo(Aa.startContainer,AS),Ac=H.getEdgeInfo(Aa.endContainer,E),AZ=(AY===l.EDGE_BEGIN?AW:AW+1),AT=(Ac===l.EDGE_END?AU:AU-1),AV;if(Ad===Ab){if((AY===l.EDGE_BEGIN)&&(Ac===l.EDGE_END)){this.remove(AW);Ab=this.ctxtBuilder.itemWidgets[AW===0?AW:AW-1];if(Ab){H.collapseOnNode(Ab.domNode,AW===0);}else{H.collapseOnNode(this.editNode,true);}}else{Ad.spliceContent(AS,E-AS);H.collapseOnTextNode(Ab.domNode,AS);}}else{for(AV=AZ;AV<=AT;AV++){AX.push(AV);}this.remove(AX);if(AY===l.EDGE_MIDDLE){Ad.spliceContent(AS);}if(Ac===l.EDGE_MIDDLE){Ab.spliceContent(0,E);}if(AY===l.EDGE_BEGIN){Ad=this.ctxtBuilder.itemWidgets[AW===0?AW:AW-1];}if(Ad){H.collapseOnNode(Ad.domNode,AW===0);}else{H.collapseOnNode(this.editNode,false);}AW=(AY===l.EDGE_BEGIN)?AW-1:AW;this.checkMergeTwoTokens(AW,AW+1);}this.editNode.focus();},oncandidatesChange:function u(){var AS=this.candidates,E=(AS&&AS.items)||[];if(!this.noCache&&AS&&AS.isComplete){this.suggestCount=this.REQUEST_THRESHOLD=E.length;}else{this.suggestCount=mstrmojo.ME.MetricDataService.suggestCount;this.REQUEST_THRESHOLD=20;}},nudge:function(E){var AS=this.getSuggestionPos();if(AS){E.set("left",AS.left);E.set("top",AS.top);}},pretokensModify:function P(){this.tokensCache=this.tokensCache.slice(0,this.tokensCachePointer);var E=this.findObjectToken();this.tokensCache.push({items:K.clone(this.items),rInfo:H.getRangeInfo(),idx:E!==null?this.itemIndex(E.data):-1});this.tokensCachePointer=this.tokensCache.length;},widgetHandleUndoRedo:function n(AT){var AU,E,AS=function(AW){if(!AW){return ;}AW=AW||{};this.set("items",K.clone(AW.items));var AZ=this.ctxtBuilder.itemWidgets,AV=AZ[AW.idx],AY=AV&&AV.domNode||this.editNode,AX=AW.rInfo;this._delaySetTextCaretPos(AY,AX&&AX.startOffset||0);};switch(AT){case"undo":AU=--this.tokensCachePointer;if(AU>-1){E=this.tokensCache[AU-1];AS.call(this,E);}else{this.tokensCachePointer=1;}break;case"redo":AU=this.tokensCachePointer++;if(AU>-1&&AU<this.tokensCache.length){E=this.tokensCache[AU];AS.call(this,E);}else{this.tokensCachePointer=Math.min(Math.max(this.tokensCachePointer,1),this.tokensCache.length);}break;}},resetTokensCache:function Z(){this.tokensCache=[];this.tokensCachePointer=-1;this.tokensCacheInitilized=false;},toggleIMEStatusBar:function c(E){if((R.isIE9||R.isIE10||R.isIEW3C||R.isEdge)&&this.detectKoreanLocale()){if(E){if(!this.elStatus||!this.elStatus.offsetParent){var AS=this.elStatus=document.createElement("div");AS.innerText=mstrmojo.desc(15003,"Please enter space key to finish IME typing");AS.className="mstrmojo-TokenInputBox-status";this.domNode.appendChild(AS);}}else{this.domNode.removeChild(this.elStatus);delete this.elStatus;}}},detectKoreanLocale:function m(){var E=window.navigator;if(window.mstrConfig&&(window.mstrConfig.browserLang||[]).indexOf("ko")>=0){return true;}else{if(E.userLanguage=="ko"||E.userLanguage=="ko-KR"||E.browserLanguage=="ko"||E.browserLanguage=="ko-KR"){return true;}}return false;}});}());(function(){mstrmojo.requiresCls("mstrmojo.css","mstrmojo.hash","mstrmojo.array","mstrmojo.UUID","mstrmojo.ui.menus.ToolbarConfig");var J=mstrmojo.hash,G=mstrmojo.array,M=mstrmojo.css,D=mstrmojo.UUID;function Q(){var U=this.children,S=this.groupInfo,V=(S&&S._isDeleted)?S:{};delete V._isDeleted;U.forEach(function(X){var W=X.defn.gi;if(W&&W!==""){var Y=V[W];if(!Y){Y=V[W]=[];}Y.push(X.k);}});return V;}mstrmojo.vi.ui._HasGroup=mstrmojo.provide("mstrmojo.vi.ui._HasGroup",{_mixinName:"mstrmojo.vi.ui._HasGroup",clearGroupSelection:function O(){var V=this._tgtSelections;if(V){var U=this,S=V.getSelections();(S||[]).forEach(function(W){U.getUnitByKey(W).toggleBoxSelection(false);U.setLastSelectionClass(null,W);V.remove(W);});}},getGroupInfo:function I(){var S=this.groupInfo;if(!S||S._isDeleted){S=this.groupInfo=Q.call(this);J.forEach(S,function(V,U){if(V.length<2){delete S[U];}});}return S;},findGroupByKey:function R(U){var S=null;J.forEach(this.getGroupInfo(),function(W,V){G.forEach(W,function(X){if(U===X){S=V;return false;}});if(S){return false;}});return S;},getGroupContextMenuConfig:function N(b,c){var V=this._tgtSelections;if(V){var U=this.id,S=this.groupInfo,W,Y=1,Z=this.findGroupByKey(c);var a=function(d){return function(){S[d].push(c);V.notify(true,{selectedGroupId:d});};},X=function(e,d){return function(){var g=S[e],f=function(h){var j=mstrmojo.all[U].getUnitByKey(h);j.toggleBoxSelection(false);j.setGroupingStatus("");};g.splice(g.indexOf(c),1);if(g.length===1){f(g[0]);delete S[e];}if(d){S[d].push(c);}else{f(c);}V.notify(true,{selectedGroupId:d||e});};};for(W in S){if(W===Z){b.addMenuItem(mstrmojo.desc(15197,"Remove from Group ##").replace("##",Y),"",X(W,null),null,0);}else{if(Z){b.addMenuItem(mstrmojo.desc(15198,"Move to Group ##").replace("##",Y),"",X(Z,W));}else{b.addMenuItem(mstrmojo.desc(15199,"Add to Group ##").replace("##",Y),"",a(W));}}Y++;}if(Z){b.addMenuItem(mstrmojo.desc(12195,"Ungroup"),"",function(){V.notify(true,{deleteGroupId:Z});});}return b;}},groupSelection:function E(){var S=this._tgtSelections;if(S){S.notify(true);}},addGroup:function F(S){var U=D.create();this.groupInfo[U]=S;return U;},selectGroup:function K(U){var S=this;var V=this._tgtSelections;if(V){U.forEach(function(W){V.toggleSelection(W);var X=S.getUnitByKey(W);X.toggleBoxSelection(true);X.setGroupingStatus("");});}},highlightGroup:function L(S){var V=this,U=this.getGroupInfo()[S];(U||[]).forEach(function(W){var X=V.getUnitByKey(W);X.setGroupingStatus("highlight");});},disableGroup:function H(S){var V=this,U=this.getGroupInfo()[S];var W=this._tgtSelections;if(W){(U||[]).forEach(function(X){var Y=V.getUnitByKey(X);Y.setGroupingStatus("disabled");Y.toggleBoxSelection(false);W.remove(X);});}},deleteGroup:function P(U){var W=this,S=this.getGroupInfo(),V=S[U];(V||[]).forEach(function(X){var Y=W.getUnitByKey(X);Y.setGroupingStatus("");});delete S[U];},clearGroupInfo:function A(){this.clearGroupSelection();var S=this.groupInfo;if(S){J.forEach(S,function(V,U){S[U]=[];});S._isDeleted=true;}},toggleHasGroupCSS:function B(S){M.toggleClass(this.domNode,"hasGroup",S);},submitGroupInfo:function C(){var W=this.getGroupInfo(),S=Q.call(this),V={},U={};J.forEach(W,function(Y,X){Y.forEach(function(a){var Z=S[X],b=Z?Z.indexOf(a):-1;if(b===-1){V[a]=X;U[a]="";}else{Z.splice(b,1);}});});J.forEach(S,function(Y,X){Y.forEach(function(Z){if(!V[Z]){V[Z]="";}U[Z]=X;});});if(Object.keys(V).length>0){this.model.saveGroupInfo(V,U,this);}}});}());(function(){mstrmojo.requiresCls("mstrmojo.ui.menus.ToolbarConfig");mstrmojo.vi.ui.toolbars._HasToolbar=mstrmojo.provide("mstrmojo.vi.ui.toolbars._HasToolbar",{_mixinName:"mstrmojo.vi.ui.toolbars._HasToolbar",preBuildRendering:function A(){this.generateToolbar();return this._super();},generateToolbar:function B(){this.passToolbarCfg(this.updateToolbar(new mstrmojo.ui.menus.ToolbarConfig()));},updateToolbar:function D(E){if(this._super){E=this._super(E);}return E;},passToolbarCfg:function C(E){var F=this.toolbar.toolbarCfg;if(F){F.destroy();}this.toolbar.set("toolbarCfg",E);}});}());(function(){mstrmojo.requiresCls("mstrmojo.Container","mstrmojo._HasLayout","mstrmojo.ui.menus._HasMenuPopup","mstrmojo.vi._MonitorsAppState","mstrmojo.vi.ui.tabs.Tab","mstrmojo.dom","mstrmojo.css");var N=mstrmojo.dom,b=mstrmojo.array,B=mstrmojo.css,h="animate",j="90px",o="70px",F="52px",w=200,Q=700,A=750;function D(){var AF=window.Modernizr,AE="transition";if(AF&&AF.testProp(AE)){return N.transEndEvtNames[AF.prefixed(AE)];}return null;}function z(AE){return function(){this.menuNode.style.display=AE?"block":"none";};}function P(AE){return Math.min(AE.offsetWidth-AE.firstChild.offsetWidth,0);}function x(AE){return AE.isAlignRight?"right":"left";}function AC(AE,AF){return parseInt(AE.style[x(AF)],10)||0;}function L(){var AI=this.tabContainerNode,AH=false,AG=false,AJ=false,AK=this.leftBtnNode,AE=this.rightBtnNode,AF=this.isValidMode();window.setTimeout(function(){if(P(AI)<0){var AM=N.position(AI),AL=N.position(AI.firstChild);AH=(AL.x<AM.x);AG=(AL.x+AL.w>AM.x+AM.w+1);}AJ=AH||AG;B.toggleClass(this.btnBarNode,"highlightBar",AJ);AK.style.display=AE.style.display=AJ?"block":"none";AK.disabled=!AH;AE.disabled=!AG;B.toggleClass(AK,"disable",!AH);B.toggleClass(AE,"disable",!AG);if(this.domNode){this.addBtnNode.style.display=this.tabStripMenuNode.style.display=AF?"block":"none";this.bufferNode.style.display=AF?"none":"block";this.floaterNode.style.display=this.hasFloater&&AH?"block":"none";}this.widgetResized();}.bind(this),w);}function U(AE,AF){AE=(AE||[]);if(!AE.filter){return b.filter(AE,AF);}return AE.filter(AF);}function X(AE,AF){AE=(AE||[]);if(!AE.map){return b.map(AE,AF);}return AE.map(AF);}function t(AU,AG,AH){var AS=this.tabContainerNode,AL=this.domNode;if(this.isStatic||!AS||!AL||AL.style.display==="none"){return ;}var AN=AS.firstChild,AT=P(AS),AK=AC(AN,this),AE=Math.max(AK,AT),AR=U(this.children,function(AV){return AV.isSelected;})[0],AP=AH&&AH.domNode||AR&&AR.domNode;if(AU&&AP){if(AT<0){var AM=N.position(AP),AI=N.position(AS),AO=Math.floor(AM.x-AI.x),AQ=Math.floor(AM.x+AM.w-(AI.x+AI.w));if(AH){var AF=Math.ceil(AP.offsetWidth);AO=AO===0?Math.max(AT,-AF):AO;AQ=AQ===0?Math.min(-AT,AF):AQ;}var AJ=AO<0?AO:(AQ>0?AQ:0);AE=this.isAlignRight?AE+AJ:AE-AJ;}}if(AE!==AK){if(AG){this.setAnimation(AN);}AN.style[x(this)]=Math.max(AT,Math.min(AE,0))+"px";}L.call(this);}function C(AE){return AE.hasOwnProperty("index");}function J(){var AF=this.tabContainerNode,AG=N.position(AF),AE=this.isAlignRight;b.forEach(this.children||[],function(AI){var AO=AI.domNode,AP=N.position(AO),AL=Math.floor(AP.x-AG.x),AM=Math.floor(AP.x+AP.w-(AG.x+AG.w)),AH=AI.isSelected,AN=Math.ceil(AO.offsetWidth),AJ=0;AI.isCutoff=AI.isHidden=AI.isLeftMost=AI.isRightMost=false;AI.leftEdgeHiddenWidth=AI.rightEdgeHiddenWidth=0;if(AL<0){var AK=Math.abs(AL);AJ=AN-AK;AI.isLeftMost=AJ>=0;AI.isCutoff=AI.isLeftMost&&AK>0&&AJ>0;AI.isHidden=AJ<=0;AI.leftEdgeHiddenWidth=AK;}else{if(AM>0){AJ=AN-AM;AI.isRightMost=AJ>=0;AI.isCutoff=AI.isRightMost&&AM>0&&AJ>0;AI.isHidden=AJ<=0;AI.rightEdgeHiddenWidth=AM;}}});}function Z(){var AE=this.children,AF=0;(AE||[]).every(function(AH,AG){if(!C(AH)){return false;}AF++;AH.index=AG;return true;});(AE||[]).every(function(AG){if(!C(AG)){return false;}AG.total=AF;return true;});}function g(AK,AG){var AJ=AK.ENUM_CORNERS,AL=[AJ.TOP_LEFT,AJ.BOTTOM_LEFT],AF=this.parent;if(AF.position!=="bottom"){AL.reverse();}AK.setAlignment(AL[0],AL[1]);var AE=N.position(AF.domNode),AI=AF.menuNode;var AH=AI.style;AH.top=(AG.y-AE.y)+"px";AH.left=(AG.x-AE.x)+"px";AK.addPopupHandlers(AF.id,z(true),z(false));AK.hostId=AF.id;AK.hostElement=AI;AK.isHostedWithin=false;AF.openPopup(AK.newInstance());}function k(AE){AE.raiseEvent({name:"TabsChange"});}mstrmojo.vi.ui.tabs.TabStrip=mstrmojo.declare(mstrmojo.Container,[mstrmojo._HasLayout,mstrmojo.ui.menus._HasMenuPopup,mstrmojo.vi._MonitorsAppState],{scriptClass:"mstrmojo.vi.ui.tabs.TabStrip",markupString:'<div id="{@id}" class="mstrmojo-VITabStrip {@cssClass}" style="{@cssText}" ><div class="mstrmojo-VITabStrip-menu" mstrAttach:click><div id="tabCommonIcon" class="mstrmojo-VITabStrip-menuIcon"></div><div id="tabCommonButton" class="mstrmojo-VITabStrip-menuButton"></div><div id="tabCommonMenuHost" class="mstrmojo-VITabStrip-menuButtonHost"></div></div><div class="mstrmojo-VITabStrip-tabs"><div style="display:table"><div style="display:table-row"></div></div></div><div class="mstrmojo-VITabStrip-buffer"></div><div class="mstrmojo-VITabStrip-btnBar"><div class="mstrmojo-VITabStrip-addBtn" mstrAttach:click><div class="mstrmojo-VITabStrip-addBtn-Img"></div><div class="mstrmojo-VITabStrip-addBtn-Text"></div></div><div class="mstrmojo-VITabStrip-navBtns"><div id="tabRightButton" class="mstrmojo-VITabStrip-rightBtn" mstrAttach:click,mousedown,mouseup,mouseover,mouseout><div class="navBtnIcon"></div></div><div id="tabLeftButton" class="mstrmojo-VITabStrip-leftBtn" mstrAttach:click,mousedown,mouseup,mouseover,mouseout><div class="navBtnIcon"></div></div></div></div><div class="mstrmojo-VITabStrip-floater"></div><div class="mstrmojo-VITabStrip-menuHost"></div><div class="mstrmojo-VIDND-mask"></div></div>',markupSlots:{tabStripMenuNode:function(){return this.domNode.firstChild;},menuImgNode:function(){return this.domNode.firstChild.firstChild;},menuBtnNode:function(){return this.domNode.firstChild.childNodes[1];},menuBtnHostNode:function(){return this.domNode.firstChild.lastChild;},tabContainerNode:function(){return this.domNode.childNodes[1];},containerNode:function(){return this.domNode.childNodes[1].firstChild.firstChild;},bufferNode:function(){return this.domNode.childNodes[2];},btnBarNode:function(){return this.domNode.childNodes[3];},addBtnNode:function(){return this.domNode.childNodes[3].firstChild;},addBtnImgNode:function(){return this.domNode.childNodes[3].firstChild.firstChild;},addBtnTxtNode:function(){return this.domNode.childNodes[3].firstChild.lastChild;},navBtnsNode:function(){return this.domNode.childNodes[3].lastChild;},rightBtnNode:function(){return this.domNode.childNodes[3].lastChild.firstChild;},leftBtnNode:function(){return this.domNode.childNodes[3].lastChild.lastChild;},floaterNode:function(){return this.domNode.childNodes[4];},menuNode:function(){return this.domNode.childNodes[5];},maskNode:function(){return this.domNode.lastChild;}},isStatic:false,isAlignRight:true,tabStripMenuNode:null,menuImgNode:null,menuBtnNode:null,menuBtnHostNode:null,tabContainerNode:null,addBtnNode:null,bufferNode:null,navBtnsNode:null,leftBtnNode:null,rightBtnNode:null,menuNode:null,position:"bottom",selectMovedTab:false,hasFloater:false,tabObjects:null,layoutConfig:{w:{tabContainerNode:"100%",bufferNode:"6px",addBtnNode:j,navBtnsNode:F,tabStripMenuNode:o},xt:true},onAppStateChange:function q(AL){var AJ=mstrmojo.vi.VisualInsightApp.APP_STATES,AK=AJ.PRESENTATION,AE=AJ.SELECTOR_TARGETING,AF=AL.value,AM=AL.valueWas,AI=this.isValidMode();if(AF&AK||AM&AK||AF&AE||AM&AE){var AG=this.addBtnNode,AH=this.tabStripMenuNode;if(AG&&AH){AG.style.display=AH.style.display=AI?"block":"none";this.bufferNode.style.display=AI?"none":"block";this.doLayout();}}},setStatic:function R(AE,AF){this.isStatic=AE;if(!AE){t.call(this,true,AF);}},setTabs:function p(AG,AE){this.removeChildren();this.tabObjects=AG;var AH=this,AF=(AG&&AG.length)||0;this.addChildren(X(AG,function(AK,AI){var AJ=AK.k;return AH.getTabCfg(AG,AK,{scriptClass:"mstrmojo.vi.ui.tabs.Tab",index:AI,total:AF,draggable:!!AF,dropZone:!!AF,k:AJ,isSelected:AJ===AE,showTabMenu:g,tabMoved:function(AM){var AL=this.index;AH.moveTab(AL,AL+(AM?-1:1),AL);}});}));t.call(this,true);k(this);},getTabs:function l(){return U(this.children,C);},getTabCfg:function AD(AF,AG,AE){return AE;},deleteTab:function I(AE){var AK=this.id,AJ=this.children[AE],AI=D(),AH=function(){var AL=mstrmojo.all[AK];AL.removeChildren(AJ);AJ.destroy();Z.call(AL);L.call(AL);k(AL);};if(AI){var AG=AJ.domNode.firstChild,AF=AG.style;AF.width=AG.offsetWidth+"px";window.setTimeout(function(){B.addClass(AG,h);N.attachOneTimeEvent(AG,AI,AH);AF.width=0;},0);}else{AH();}},buildRendering:function c(){this._super();B.toggleClass(this.domNode,"alignLeft",!this.isAlignRight);},postBuildRendering:function V(){var AE=this._super();t.call(this,true);return AE;},doLayout:function K(){this._super();t.call(this,true);},isValidMode:function E(){return !((mstrApp.isAppStatePresentation&&mstrApp.isAppStatePresentation())||(mstrApp.isAppStateSelection&&mstrApp.isAppStateSelection())||(mstrApp.allowWebDashboardDesign&&!mstrApp.allowWebDashboardDesign()));},setSelectedTab:function S(AE){b.forEach(this.children||[],function(AF){AF.set("isSelected",AF.k===AE);});k(this);},getSelectedTab:function f(){var AG=null,AF=this.children||[],AE;for(AE=0;AE<AF.length;AE++){if(AF[AE].isSelected){AG=AF[AE];break;}}return AG;},onclick:function n(AE){if(!this.isValidMode()){return ;}if(AE.getTarget()===this.addBtnImgNode||AE.getTarget()===this.addBtnTxtNode){this.addTab();}},addTab:mstrmojo.emptyFn,clearBtnTooltips:function O(AG){var AE=(AG===this.leftBtnNode),AF=(AG===this.rightBtnNode);if(AE||AF){this.clearTooltips();return true;}return false;},showBtnTooltips:function G(AE){var AG=AE.getTarget().parentNode,AF=this.clearBtnTooltips(AG);if(AF){this.toggleTooltip(AG);}},onmouseout:function u(AE){var AF=AE.getTarget().parentNode;this.clearBtnTooltips(AF);},onmouseover:function H(AE){this.showBtnTooltips(AE);},onmouseup:function a(AE){window.setTimeout(function(){this.showBtnTooltips(AE);}.bind(this),w);},onmousedown:function e(AN){var AJ=AN.getTarget().parentNode,AO=(AJ===this.leftBtnNode),AH=(AJ===this.rightBtnNode);if(AO||AH){var AM=this.tabContainerNode,AI=AM.firstChild,AE=this.id,AK=this,AG;if(mstrApp.setInteractive){mstrApp.setInteractive(false);}B.addClass(AJ,"active");var AL=function(){window.clearInterval(AG);B.removeClass(AJ,"active");L.call(mstrmojo.all[AE]);if(mstrApp.setInteractive){mstrApp.setInteractive(true);}};N.attachOneTimeEvent(document.body,"mouseup",AL);var AF=function(){var AR=P(AM),AU=AC(AI,AK),AV=AU-AR,AT=0-AU;J.call(AK);AK.setAnimation(AI);var AP=AK.getCornerTabs()||[],AS=U(AP,function(AW){if(AO&&AW.isLeftMost||AH&&AW.isRightMost){return AW;}})[0],AQ=0;if(AS){AQ=AS.isCutoff?(AO?AS.leftEdgeHiddenWidth:AS.rightEdgeHiddenWidth):Math.ceil(AS.domNode.offsetWidth);AQ=Math.min(AQ,AO?AT:AV);AQ=AK.isAlignRight?(AO?-AQ:AQ):(AO?AQ:-AQ);}AI.style[x(AK)]=parseInt(AI.style[x(AK)]||0)+AQ+"px";};AF();AG=window.setInterval(function(){AF();},A);}},getCornerTabs:function d(){return U(this.children,function(AE){return AE.isLeftMost||AE.isRightMost;});},setAnimation:function Y(AE){var AF=D();if(AF){B.addClass(AE,h);N.attachOneTimeEvent(AE,AF,function(){B.removeClass(AE,h);});}},createTooltip:function AA(AF){var AH=document.createElement("div");AH.className="navBtnTooltip";AH.appendChild(document.createTextNode(AF.getAttribute("tooltip")||""));var AK=document.body.firstChild;AK.parentNode.insertBefore(AH,AK);var AI=5,AL=AH.offsetWidth-25,AG=AF.getBoundingClientRect(),AJ=AH.getBoundingClientRect(),AE=AG.top-(AJ.height+AI);AH.style.top=AE+"px";AH.style.left=(AG.left-AL)+"px";return AH;},clearTooltips:function m(){window.clearTimeout(this._tooltipTimeOut);var AE=document.querySelectorAll(".navBtnTooltip");b.forEach(AE||[],function(AF){AF.parentNode.removeChild(AF);});},toggleTooltip:function AB(AE){window.clearTimeout(this._tooltipTimeOut);if(AE.disabled){this._tooltipTimeOut=window.setTimeout(function(){this.createTooltip(AE);}.bind(this),Q);}},moveTab:function M(AE,AM,AK,AJ){var AF=this.children,AN=AF.splice(AE,1)[0];AF.splice(AM,0,AN);Z.call(this);this.setAnimation(this.tabContainerNode.firstChild);var AG=this.containerNode,AH=AG.childNodes,AL=AG.removeChild(AH[AE]),AI=AH[AM];if(AI){AG.insertBefore(AL,AI);}else{AG.appendChild(AL);}if(this.selectMovedTab||AN.isSelected){t.call(this,true,true,AN);}if(!AJ&&AK!==undefined&&AK!==AM){this.commitTabMove(AK,AM);k(this);}},commitTabMove:function v(AE,AF){throw new Error(this.scriptClass+" must implement commitTabMove.");},updateTabTable:function r(){if(!this.isStatic){t.call(this,true);}},setLinkIcon:function W(AE,AH){var AG,AF;if(AE){if(AH){AF="src";b.some(this.getTabs(),function(AI){if(AI.k===AH){AG=AI;}return AG;});if(!AG){return ;}}else{AF="tgt";AG=this.getSelectedTab();}B.addClass(AG.domNode,AF);}else{AF=AH?["src","tgt"]:"tgt";b.forEach(this.children,function(AI){B.removeClass(AI.domNode,AF);});}}});}());(function(){mstrmojo.requiresCls("mstrmojo.Container","mstrmojo._HasLayout","mstrmojo.vi._MonitorsAppState","mstrmojo.EditableLabel","mstrmojo.vi.ui.toolbars.TitleToolbar");var J=mstrmojo.dom;mstrmojo.vi.ui.TitleBar=mstrmojo.declare(mstrmojo.Container,[mstrmojo._HasLayout,mstrmojo.vi._MonitorsAppState],{scriptClass:"mstrmojo.vi.ui.TitleBar",markupString:'<div id="{@id}" class="mstrmojo-VITitleBar {@cssClass}" style="{@cssText}" mstrAttach:contextmenu,click><div class="left-toolbar"></div><div class="title-text"></div><div class="right-toolbar"></div></div>',markupSlots:{leftToolNode:function(){return this.domNode.firstChild;},textNode:function(){return this.domNode.childNodes[1];},rightToolNode:function(){return this.domNode.lastChild;},containerNode:function(){return this.domNode;}},markupMethods:{onhasContextMenuButtonChange:function(){var P=this.hasContextMenuButton;this.tbToolbar.set("visible",P);this.tbToolbar.set("enabled",P);},ontitleChange:function(){this.lblTitle.set("text",this.title||" ");},ontoolbarCfgChange:function(){var P=this.toolbarCfg;if(!P){return ;}this.tbToolbar.set("toolbarCfg",P);this.doLayout();},onvisibleChange:mstrmojo.Widget.visibleMarkupMethod},layoutConfig:{w:{leftToolNode:"auto",textNode:"100%",rightToolNode:"auto"},h:{leftToolNode:"100%",textNode:"100%",rightToolNode:"100%"},xt:true},lblTitle:null,tbToolbar:null,hasContextMenuButton:true,editTitleOnClick:false,editTitleOnDoubleClick:true,editTitleOnTwoClicks:false,title:"",close:mstrmojo.emptyFn,toolbarCfg:null,beganEditingTitlebar:mstrmojo.emptyFn,titleEdited:mstrmojo.emptyFn,useRichTooltip:true,init:function O(P){this._super(P);this.addChildren([].concat(this.getLeftToolbarChildren()).concat(this.getTitleChildren()).concat(this.getRightToolbarChildren()));},shouldShowTooltip:function K(P,R){var Q=P.target||J.eventTarget(P.hWin,P.e);return Q===this.textNode.firstChild&&(Q.scrollWidth>Q.clientWidth);},getTooltipContent:function L(P){var R=P.target||J.eventTarget(P.hWin,P.e),Q=R.innerHTML;return Q;},showTooltip:function M(P,Q){if(this.shouldShowTooltip(P,Q)){this._super(P,Q);}},updateTooltipConfig:function I(Q){var R=Q.target||J.eventTarget(Q.hWin,Q.e),P=J.position(R);this.richTooltip={posType:mstrmojo.tooltip.POS_TOPLEFT,content:this.getTooltipContent(Q),top:P.y+P.h+3,left:P.x+4,cssClass:"vi-regular vi-tooltip-A"};},getLabelNode:function C(){return this.lblTitle.domNode;},getMenuConfig:function B(){var P=this.toolbarCfg;if(P){if(P.hasMenuItems()){return P;}}return null;},setToolbarVisibility:function D(P){this.tbToolbar.set("visible",P);},editTitle:function N(){this.lblTitle.set("isEditing",true);},onAppStateChange:function F(P){var Q=this.lblTitle,R=mstrApp.isAppStatePresentation(),S=!!(P.valueWas&mstrmojo.vi.VisualInsightApp.APP_STATES.PRESENTATION);if(R&&this._confgTitleEditable===undefined){this._confgTitleEditable=this.editTitleOnClick||this.editTitleOnDoubleClick||this.editTitleOnTwoClicks;}Q.set("isEditing",false);if(R||S){Q.set("editOnDoubleClick",!R&&this._confgTitleEditable);}},getLeftToolbarChildren:function A(){},getTitleChildrenLayoutOffsets:function H(){return{h:2,w:2};},getTitleChildren:function G(){return[{scriptClass:"mstrmojo.EditableLabel",slot:"textNode",alias:"lblTitle",bindings:{editOnClick:"this.parent.editTitleOnClick",editOnDoubleClick:"this.parent.editTitleOnDoubleClick",selectable:"this.isEditing",editOnTwoClicks:"this.parent.editTitleOnTwoClicks"},onTextEditBegin:function(){this.parent.beganEditingTitlebar();},onTextEditComplete:function(R,Q){this.parent.titleEdited(this.text,R,Q);},getLayoutOffsets:function P(){return this.parent.getTitleChildrenLayoutOffsets();}}];},getRightToolbarChildren:function E(){return[{scriptClass:"mstrmojo.vi.ui.toolbars.TitleToolbar",slot:"rightToolNode",alias:"tbToolbar",visible:true,useRichTooltip:true,bindings:{hasContextMenuButton:"this.parent.hasContextMenuButton",}}];}});}());(function(){mstrmojo.requiresCls("mstrmojo.hash","mstrmojo.Editor","mstrmojo._FormatDefinition","mstrmojo.FontFormatter","mstrmojo.NumberFormatter","mstrmojo.AlignmentFormatter","mstrmojo.PaddingFormatter","mstrmojo.FillFormatter","mstrmojo.BorderFormatter");var B=mstrmojo.hash,C=mstrmojo._FormatDefinition;var A=["header_format","grid_format","child_header_format","child_grid_format"];mstrmojo.CGFormatEditor=mstrmojo.declare(mstrmojo.Editor,null,{scriptClass:"mstrmojo.CGFormatEditor",cssClass:"mstrmojo-FormatEditor",title:mstrmojo.desc(2116),model:null,obModel:null,_initModel:function(){if(!this.obModel){var D=this;this.obModel=new mstrmojo.Model({level1Index:A[0],onlevel0IndexChange:function(E){if(E.valueWas>-1){this._updateModel(E.valueWas,this.level1Index);}this._setCurrentFormat();},onlevel1IndexChange:function(E){if(E.valueWas!=undefined){this._updateModel(this.level0Index,E.valueWas);}this._setCurrentFormat();},onmodelChange:function(){return this.model.items.length>0?this._setCurrentFormat():false;},_updateModel:function(H,F){H=(typeof H!="undefined")?H:this.level0Index;F=F||this.level1Index;var G=mstrmojo.hash.copy(this.currentFormat);var E=this.model.items[H][F]||{};C.extractModel(G,E);this.model.items[H].set(F,E);},_setCurrentFormat:function(){var E=mstrmojo.hash.copy(this.model.items[this.level0Index||0][this.level1Index]);E=C.getStandardFormat(E);this.set("currentFormat",E);}});}},init:function(D){this._initModel();this._super(D);},onmodelChange:function(){this._initModel();var E=this.obModel;E.level0Index=E.level0Index||0;E.set("model",mstrmojo.hash.clone(this.model));var D=E.model.selectedIndex;E.set("level0Index",(D==-1?0:D));},onClearFormat:function(){var D=this.obModel.currentFormat;for(var G in D){delete D[G];}for(var F=0;F<A.length;F++){var E=this.obModel;delete E.model.items[E.level0Index][A[F]];}this.obModel._setCurrentFormat();},onOK:function(){this.obModel._updateModel();var D=this.obModel.model;for(var E=0;E<D.items.length;E++){C.saveFormatModel(D.items[E],this.model.items[E],A);}},postBuildRendering:function(){if(this._super){this._super();}var D=this.obModel.model.selectedIndex;this.obModel.set("level0Index",(D==-1?0:D));},children:[{scriptClass:"mstrmojo.VBox",children:[{scriptClass:"mstrmojo.HBox",alias:"btns",children:[{scriptClass:"mstrmojo.Pulldown",itemIdField:"did",bindings:{items:function(){return this.parent.parent.parent.obModel.model.items||[];},value:function(){var D=this.parent.parent.parent.obModel.level0Index;D=(D==-1?0:D);return this.items[D][this.itemIdField];}},cssClass:" mstrmojo-FormatEditor-DropDownButton",popupZIndex:100,value:1,allowHTML:false,onvalueChange:function(){var D=this.parent.parent.parent;if(D&&D.obModel){D.obModel.set("level0Index",this.selectedIndex);}}},{scriptClass:"mstrmojo.Pulldown",alias:"targetSelector",itemIdField:"v",cssClass:" mstrmojo-FormatEditor-DropDownButton",popupZIndex:100,value:1,items:C.FormatTarget,onvalueChange:function(){var D=this.parent.parent.parent;if(D&&D.obModel){D.obModel.set("level1Index",this.selectedItem.p);}}},new mstrmojo.Button.newInteractiveButton(mstrmojo.desc(5976),function(D){var E=this.parent.parent.parent;if(E.onClearFormat){E.onClearFormat();}},"#999",{alias:"btnClear",cssClass:"mstrmojo-Editor-button mstrButton clear"})]},{scriptClass:"mstrmojo.HBox",alias:"formatPanels",cssClass:"mstrmojo-FormatEditor-box",bindings:{currentModel:"this.parent.parent.obModel.currentFormat"},children:[{scriptClass:"mstrmojo.VBox",alias:"formatList",cssClass:"mstrmojo-FormatEditor-leftPanel",children:[{scriptClass:"mstrmojo.List",alias:"feFMTList",cssClass:"mstrmojo-FormatEditor-formatList",items:C.Formats,selectedIndex:0,itemMarkup:'<div class="mstrmojo-FormatEditor-bullet"><div class="mstrmojo-text">{@n}</div></div>',height:"200px"}]},{scriptClass:"mstrmojo.Container",alias:"rightPanelContainer",cssClass:"mstrmojo-FormatEditor-rightPanel-container mstrmojo-FormatEditor-rightPanel",markupString:'<div id={@id} class="{@cssClass}"></div>',markupSlots:{containerNode:function(){return this.domNode;}},children:[{scriptClass:"mstrmojo.FontFormatter",cssClass:"mstrmojo-FormatEditor-fontTable",cellPadding:5,bindings:{visible:"this.parent.parent.formatList.feFMTList.selectedIndex==0",model:"this.parent.parent.currentModel.FormattingFont"}},{scriptClass:"mstrmojo.NumberFormatter",bindings:{visible:"this.parent.parent.formatList.feFMTList.selectedIndex==1",model:"this.parent.parent.currentModel.FormattingNumber"}},{scriptClass:"mstrmojo.AlignmentFormatter",bindings:{visible:"this.parent.parent.formatList.feFMTList.selectedIndex==2",model:"this.parent.parent.currentModel.FormattingAlignment"}},{scriptClass:"mstrmojo.PaddingFormatter",bindings:{visible:"this.parent.parent.formatList.feFMTList.selectedIndex==2",model:"this.parent.parent.currentModel.FormattingPadding"}},{scriptClass:"mstrmojo.FillFormatter",bindings:{visible:"this.parent.parent.formatList.feFMTList.selectedIndex==3",model:"this.parent.parent.currentModel.FormattingPatterns"}},{scriptClass:"mstrmojo.BorderFormatter",bindings:{visible:"this.parent.parent.formatList.feFMTList.selectedIndex==3",model:"this.parent.parent.currentModel.FormattingBorder"}}]}]}]},{scriptClass:"mstrmojo.HBox",cssClass:"mstrmojo-Editor-buttonBar",slot:"buttonNode",children:[new mstrmojo.Button.newInteractiveButton(mstrmojo.desc(2397),function(){var D=this.parent.parent;D.close();if(D.onOK){D.onOK();}},"#999",{alias:"btnOk",cssClass:"mstrmojo-Editor-button mstrButton"}),new mstrmojo.Button.newInteractiveButton(mstrmojo.desc(2399),function(){var D=this.parent.parent;D.close();},"#999",{alias:"btnCancel",cssClass:"mstrmojo-Editor-button mstrButton"})]}]});})();(function(){mstrmojo.requiresCls("mstrmojo.publisher","mstrmojo.Widget","mstrmojo.fx","mstrmojo.locales","mstrmojo.expr","mstrmojo.Button","mstrmojo.date","mstrmojo.ui.editors.controls.Stepper","mstrmojo.css");var AE=function(){return mstrmojo.locales.datetime;},k=mstrmojo.dom,j=mstrmojo.expr,AB=j.DTP,a=mstrmojo.date,J=mstrmojo.publisher,f=mstrmojo.hash,m=mstrmojo.array,N=m.removeIndices,l=mstrmojo.css;var AD=0,C=3,M=4,p=5,Q=6;var AF="month",d="day",W="year",Y="hour",AI="minute",x="second";var G='<table border="0" cellpadding="0" cellspacing="0">',w="</table>";function O(AJ){return'<table border="0" cellpadding="0" cellspacing="0" style="'+AJ+'">';}function H(AM,AJ,AK){var AL=a.getFirstDateOfMonth(AM,AJ);return(AL.getDay()-AK+8)%7;}function n(AM){var AL=a.parseDateAndOrTime(AM),AN,AJ,AK;if(AL){AK={};AN=AL.date;AJ=AL.time;if(AN){f.copy(AN,AK);}if(AJ){f.copy(AJ,AK);}}return AK;}function F(AK,AN,AM,AL,AJ){var AO=a.formatDateInfo({day:AK,month:AN,year:AM},AE().DATEOUTPUTFORMAT);return a.inDateTimeRange(AO,AL,AJ)===0;}function U(AN,AM,AL){var AK=AN.decreaseButton,AJ=AN.increaseButton,AO="mstrmojo-Calendar";AK.className=(AO+"-decrease");AJ.className=(AO+"-increase");}function X(AN,AK,AP,AM){var AL=0,AJ=AN.length,AO;for(AL=0;AL<AJ;AL++){AO=AN[AL];if(AO&&AO.day===AK&&AO.month===AP&&AO.year===AM){return AL;}}return -1;}function q(AJ,AL,AK){var AM=new Date();return(AM.getFullYear()===AK)&&((AM.getMonth()+1)===AL)&&(AM.getDate()===AJ);}function v(AQ,AR){var AV=AQ.dayView.getElementsByTagName("div"),AT=AQ.selectedDates,AL=AT[AR],AU=AQ.browseYear,AK=AQ.browseMonth,AN=a.getDaysOfMonth(AU,AK),AM=a.getPreMonth(AU,AK),AP=a.getDaysOfMonth(AM.y,AM.m),AJ=H(AU,AK,AQ.firstDayOfWeek),AO=((AL.month===AK)?AL.day+AJ-1:(AL.month>AK?AL.day+AJ+AN-1:AJ-AP+AL.day-1)),AS=AV[AO];if(AS){c(AS,AQ,false);}N(AT,AR,1);}function B(AJ){var AK=AJ.selectedDates;while(AK.length){v(AJ,0);}}function AH(AL,AJ){var AK=K(AL,AJ),AM=AL.selectedDates;AM.push({day:AK.d,month:AK.m,year:AK.y});c(AJ,AL,true);}function o(AL,AM){if(!AM||!AM.length){return null;}var AO=AL.selectedDates;for(var AK=0,AJ=AM.length;AK<AJ;AK++){var AN=AM[AK],AP=r(AL,AN);AO.push({day:AN.d,month:AN.m,year:AN.y});if(AP){c(AP,AL,true);}}}function r(AR,AT){var AV=AR.dayView.getElementsByTagName("div"),AM=AV.length,AU=AR.browseYear,AK=AR.browseMonth,AN=a.getPreMonth(AU,AK),AO=a.getDaysOfMonth(AN.y,AN.m),AZ=a.getNextMonth(AU,AK),AL=a.getDaysOfMonth(AU,AK),AJ=H(AU,AK,AR.firstDayOfWeek);var AP=AJ>0?{y:AN.y,m:AN.m,d:AV[0].innerHTML}:{y:AU,m:AK,d:AV[0].innerHTML},AX=(AV.length-AL-AJ)>0?{y:AZ.y,m:AZ.m,d:AV[AM-1].innerHTML}:{y:AU,m:AK,d:AV[AM-1].innerHTML},AY=S(AP,AT),AQ=S(AT,AX),AS=null;if(AY>=0&&AQ>=0){var AW=0;if(AY<AJ){AW=-1;}if(AQ<(AV.length-AJ-AL)){AW=1;}AS=((AW===0)?AT.d+AJ-1:(AW===1?AT.d+AJ+AL-1:AJ-AO+AT.d-1));return AV[AS];}else{return null;}}function g(AR,AJ){var AT=AR.selectedDates,AL=AT.length;if(!AL){return null;}var AK=AT[AL-1],AM=K(AR,AJ),AW=S({y:AK.year,m:AK.month,d:AK.day},AM),AX=[],AO=AW>0,AU=Math.abs(AW);for(var AQ=0;AQ<=AU;AQ++){var AP=new Date(AM.y,AM.m-1,AM.d);AP.setDate(AP.getDate()+(AO?-AQ:AQ));var AV=AP.getFullYear(),AN=AP.getMonth()+1,AS=AP.getDate();if(AR.isDateDisabled(AS,AN,AV,AR.min,AR.max)&&!AR.canSelectDisabledDate){continue;}AX.push({y:AV,m:AN,d:AS});}return AX;}function S(AM,AL){var AJ=new Date(AM.y,AM.m-1,AM.d),AK=new Date(AL.y,AL.m-1,AL.d);return(AK-AJ)/1000/3600/24;}function K(AL,AJ){var AM=AL.browseYear,AO=AL.browseMonth,AN=parseInt(AJ.innerHTML,10),AP=parseInt(AJ.getAttribute("m"),10),AK=null;AK=(AP===0)?{y:AM,m:AO}:(AP===1?a.getNextMonth(AM,AO):a.getPreMonth(AM,AO));AK.d=AN;return AK;}function h(AJ){var AL=AJ.selectedDates,AK=AL.length;return(AK===0)?null:AL[AK-1];}function c(AK,AL,AJ){var AM=AL.selectedColor;l.toggleClass(AK,["selected",AL.selectedCssStyle],AJ);AK.parentNode.style.backgroundColor=AJ?AM:"";AK.style.backgroundColor=AJ?AM:"";}function AA(AJ){return AJ.selectedColor?('style="background-color:'+AJ.selectedColor+';"'):"";}function P(AJ){return(AJ.tagName.toLowerCase()==="td")?AJ.firstChild:AJ;}function R(AK,AL){var AM=a.getDateJson(AK),AJ=a.formatDateInfo(AM,mstrmojo.locales.datetime.DATEOUTPUTFORMAT);if(AL===AB.TIMESTAMP){AJ+=" "+a.formatTimeInfo(this.timeVal,mstrmojo.locales.datetime.TIMEOUTPUTFORMAT);}return AJ;}function t(AO,AL){var AJ=this.advancedValues,AK=null;AJ.set(AO,AL);switch(AJ.baseDate){case C:AK=new Date();break;case M:break;case p:break;case Q:break;default:return ;}var AM=AJ.monthsToAdjust;if(AM>0){AK.setMonth(AK.getMonth()+(AJ.toAddMonths?AM:-AM));}var AN=AJ.daysToAdjust;if(AN>0){AK.setDate(AK.getDate()+(AJ.toAddDays?AN:-AN));}this.set("value",R.call(this,AK,this.dtp));}function V(){var AJ=this.advancedValues,AK=["isDyn"];if(AJ.baseDate===AD){return null;}AK.push(AJ.baseDate);AK.push(AJ.toAddDays?AJ.daysToAdjust:-AJ.daysToAdjust);AK.push(AJ.toAddMonths?AJ.monthsToAdjust:-AJ.monthsToAdjust);AK.push(0);AK.push(0);AK.push(0);AK.push(0);AK.push(this.value);AK.push(this.timeVal.hour);AK.push(this.timeVal.min);AK.push(this.timeVal.sec);return AK.join("::");}function AG(AJ){if(AJ.value!==undefined&&this.hasRendered){this.updateSelectedDate();}}function I(AL,AK){var AM=this,AJ=function(AN){return AN[0].toUpperCase()+AN.substring(1);};return{scriptClass:"mstrmojo.HBox",cssClass:"dateAdjustBox",alias:AL+"AdjustBox",children:[{scriptClass:"mstrmojo.ui.Pulldown",selectedIndex:AK>0?0:1,onitemSelected:function(AO,AN){t.call(AM,"toAdd"+AJ(AL),AN===0);},items:[{did:0,n:mstrmojo.desc(9424,"plus")},{did:1,n:mstrmojo.desc(9425,"minus")}]},{scriptClass:"mstrmojo.ui.editors.controls.Stepper",width:null,height:null,provider:new mstrmojo.NumStepperContentProvider({item:{interval:1,min:0,value:Math.abs(AK)},onTraverse:function(){t.call(AM,AL+"ToAdjust",this.curVal);}})},{scriptClass:"mstrmojo.Label",text:AL==="days"?mstrmojo.desc(707,"Days"):mstrmojo.desc(710,"Months")}]};}function Z(){this.buttonsNode.style.display=(this.wasAdvanced||this.changeValueOnOK||(this.showAdvanced&&this.isAdvanced)?"block":"none");this.advancedNode.style.display=this.showAdvanced?"block":"none";}mstrmojo.Calendar=mstrmojo.declare(mstrmojo.Container,null,{scriptClass:"mstrmojo.Calendar",cssPrefix:"",browseMonth:null,browseYear:null,yearRangStart:null,selectedDates:null,selectedColor:"",isMultiSelect:false,hilightToday:false,yearViewSize:5,cssTextDay:"",cssTextMonth:"",cssTextYear:"",cssTextWeekDay:"",cssTextHeader:"",cssTextMonthYearLabel:"",forceNonEmptySelection:false,showCurMonthDatesOnly:false,currentView:d,duration:600,timeDelimiter:":",dtp:AB.DATE,value:"",firstDayOfWeek:1,changeValueOnOK:false,wasAdvanced:false,showAdvanced:false,isAdvanced:false,dynDateValue:null,canSelectDisabledDate:false,monthNames:function(AJ){return AE().MONTHNAME_SHORT[AJ];},dayNames:function(AJ){return AE().dayShortNames[AJ];},min:null,max:null,supportedViews:{day:true,month:true,year:true,hour:true,minute:true,second:true},sDirMatrix:{day:{month:"down",year:"down",hour:"up",minute:"up",second:"up"},month:{day:"up",year:"left",hour:"up",minute:"up",second:"up"},year:{day:"up",month:"right",hour:"up",minute:"up",second:"up"},hour:{day:"down",month:"down",year:"down",minute:"left",second:"left"},minute:{day:"down",month:"down",year:"down",hour:"right",second:"left"},second:{day:"down",month:"down",year:"down",hour:"right",minute:"right"}},markupString:'<div id="{@id}" class="{@cssPrefix} mstrmojo-Calendar {@cssClass}" style="{@cssText}" mstrAttach:mousedown,mouseup,mouseover,mouseout><div class="mstrmojo-Calendar-header" style="{@cssTextHeader}"><div class="mstrmojo-Calendar-decrease"></div><div class="mstrmojo-Calendar-increase"></div><div class="mstrmojo-Calendar-title"><span class="mstrmojo-Calendar-monthLabel" style="{@cssTextMonthYearLabel}">{@browseMonth}</span><span class="mstrmojo-Calendar-yearLabel" style="{@cssTextMonthYearLabel}">{@browseYear}</span></div></div><div class="mstrmojo-Calendar-body" style="{@cssTextBody}"><div class="mstrmojo-Calendar-dayView"></div></div><div class="mstrmojo-Calendar-timePart"><span class="mstrmojo-Calendar-hourLabel">00</span><span class="mstrmojo-Calendar-timeDelimiter">{@timeDelimiter}</span><span class="mstrmojo-Calendar-minuteLabel">00</span><span class="mstrmojo-Calendar-timeDelimiter">{@timeDelimiter}</span><span class="mstrmojo-Calendar-secondLabel">00</span><span class="mstrmojo-Calendar-AMPMLabel">AM</span></div><div class="mstrmojo-Calendar-advanced"></div><div class="mstrmojo-Calendar-buttons cf"></div></div>',markupMethods:{onvisibleChange:function(){this.domNode.style.display=this.visible?"block":"none";},onbrowseMonthChange:function(){this.monthLabel.innerHTML=this.monthNames(this.browseMonth-1);},onbrowseYearChange:function(){this.yearLabel.innerHTML=this.browseYear;},ondtpChange:function(){this.timePart.style.display=(this.dtp===AB.TIMESTAMP||this.dtp===AB.TIME)?"block":"none";this.advancedNode.style.display=this.showAdvanced?"block":"none";},onvalueChange:function(){if(this.lastValue===undefined||this.value!==this.lastValue){this.updateSelectedDate();}},onchangeValueOnOKChange:Z,onisAdvancedChange:Z},markupSlots:{monthLabel:function(){return this.domNode.firstChild.lastChild.firstChild;},yearLabel:function(){return this.domNode.firstChild.lastChild.lastChild;},decreaseButton:function(){return this.domNode.firstChild.firstChild;},increaseButton:function(){return this.domNode.firstChild.childNodes[1];},bodyContainer:function(){return this.domNode.childNodes[1];},dayView:function(){return this.domNode.childNodes[1].firstChild;},monthView:function(){return this.domNode.childNodes[1].firstChild;},yearView:function(){return this.domNode.childNodes[1].firstChild;},hourView:function(){return this.domNode.childNodes[1].firstChild;},minuteView:function(){return this.domNode.childNodes[1].firstChild;},secondView:function(){return this.domNode.childNodes[1].firstChild;},timePart:function(){return this.domNode.childNodes[2];},hourLabel:function(){return this.domNode.childNodes[2].firstChild;},minuteLabel:function(){return this.domNode.childNodes[2].childNodes[2];},secondLabel:function(){return this.domNode.childNodes[2].childNodes[4];},AMPMLabel:function(){return this.domNode.childNodes[2].childNodes[5];},advancedNode:function(){return this.domNode.childNodes[3];},buttonsNode:function(){return this.domNode.childNodes[4];}},init:function AC(AJ){if(this._super){this._super(AJ);}if(this.duration<1){this.duration=1;}if(!this.selectedDates){this.selectedDates=[];}this.timeVal={hour:0,min:0,sec:0};},ondynDateValueChange:function u(AJ){if(AJ.value!==undefined&&this.hasRendered){this.updateSelectedDate();this.buildChildren();}},onminChange:AG,onmaxChange:AG,buildChildren:function b(){var AP=this;if(this.showAdvanced){var AM=this.dynDateValue,AL=this.advancedValues||this.addDisposable(new mstrmojo.Model({})),AS=AM&&AM.split("::")||[],AO=AS[1]||AD,AK=AS[2]||0,AT=AS[3]||0,AQ=function AQ(){if(AP.isAdvanced){AP.wasAdvanced=true;AP.changeValueOnOK=true;}AP.set("isAdvanced",!AP.isAdvanced);mstrmojo.css.toggleClass(AP.markupSlots.dayView.call(AP),["ddSelected"],AP.isAdvanced);t.call(AP,"baseDate",AP.isAdvanced?3:0);if(AP.parent&&AP.parent.nudge&&AP.isAdvanced){AP.parent.nudge();}};this.advancedValues=AL;AL.baseDate=parseInt(AO);AL.toAddDays=AK>=0;AL.daysToAdjust=Math.abs(AK);AL.toAddMonths=AT>=0;AL.monthsToAdjust=Math.abs(AT);this.isAdvanced=!!this.dynDateValue;if(this.domNode){mstrmojo.css.toggleClass(this.markupSlots.dayView.call(this),["ddSelected"],this.isAdvanced);}if(this.isAdvanced&&this.value){var AJ=n(this.value),AN=this.timeVal;if(AJ&&AJ.hour!==undefined){AN.hour=AJ.hour;AN.min=AJ.min;AN.sec=AJ.sec;}}t.call(AP,"baseDate",this.isAdvanced?3:0);this.destroyChildren(false);this.addChildren([{scriptClass:"mstrmojo.HBox",alias:"checkLabel",slot:"advancedNode",children:[{scriptClass:"mstrmojo.ui.Checkbox",alias:"checkbox",checked:!!AP.isAdvanced,oncheckedChange:AQ},{scriptClass:"mstrmojo.Label",text:mstrmojo.desc(13844,"Dynamic Date"),onclick:function AR(){this.parent.checkbox.onclick();}}]},{scriptClass:"mstrmojo.Box",alias:"advancedPanel",slot:"advancedNode",bindings:{visible:"this.parent.isAdvanced"},children:[{scriptClass:"mstrmojo.Label",text:mstrmojo.desc(9423,"Today"),cssClass:"tdLabel"},I.call(this,"days",AK),I.call(this,"months",AT)]},]);}else{this.destroyChildren(false);}this.addChildren([mstrmojo.Button.newWebButton(mstrmojo.desc(2140,"Cancel"),function(){AP.parent.close();},false,{slot:"buttonsNode"}),mstrmojo.Button.newWebButton(mstrmojo.desc(1442,"OK"),function(){if(AP.changeValueOnOK||AP.isAdvanced||AP.wasAdvanced){AP.updateValue(true);}},true,{slot:"buttonsNode"})]);},preBuildRendering:function A(){this.buildChildren();return this._super();},getSelectedDatesAsString:function E(AK){var AJ=[];m.forEach(this.selectedDates,function(AL){AJ.push(a.formatDateInfo(AL,AK||AE().DATEOUTPUTFORMAT));});return AJ;},updateSelectedDate:function L(AO){var AJ=this.value,AL=this.timeVal,AN=this.selectedDates,AM,AP=function(AR,AQ){AR.set("browseYear",AQ.year);AR.set("browseMonth",AQ.month);AR.updateTimePart();AR.updateView(AR.currentView);if(!AR.changeValueOnOK&&AR.hasRendered&&AR.closeOnValueChange!=true){AR.updateValue();}};if(this.wasAdvanced){this.wasAdvanced=false;this.changeValueOnOK=false;}if(AJ){AM=n(AJ);if(AM&&AM.hour!==undefined){AL.hour=AM.hour;AL.min=AM.min;AL.sec=AM.sec;if(this.dtp===AB.TIME&&(AM.year===undefined||AM.month===undefined||AM.day===undefined)){var AK=a.getDateJson(new Date());AM.year=AK.year;AM.month=AK.month;AM.day=AK.day;}}}if((AM&&!this.isMultiSelect)||AO){B(this);}if(AN.length===0){if(!AM){if(this.parent.opener&&this.parent.opener.defaultDate){AM=n(this.parent.opener.defaultDate);}else{AM=a.getDateJson(new Date());}}if(!this.canSelectDisabledDate&&this.isDateDisabled(AM.day,AM.month,AM.year,this.min,this.max)){if(this.min&&a.compareDate(AM,this.min)<0){AM=n(this.min);}else{if(this.max&&a.compareDate(AM,this.max)>0){AM=n(this.max);}}}AN.push(AM);AP(this,AM);}else{AM=AN[0];if(this.value!==null){AP(this,AM);}}},updateValue:function e(AJ){var AL=h(this),AK="";if(AL){AK=a.formatDateInfo(AL,AE().DATEOUTPUTFORMAT);if(this.dtp!==AB.DATE){var AM=a.formatTimeInfo(this.timeVal,AE().TIMEOUTPUTFORMAT);if(this.dtp===AB.TIME){AK=AM;}else{AK+=" "+AM;}}}this.lastValue=AK;this.set("value",AK);if(this.showAdvanced){this.set("dynDateValue",AJ?V.call(this):null);}if(this.onValueUpdate){this.onValueUpdate();}},updateTimePart:function z(){var AK=this.timeVal,AJ=AK.hour||0,AL=(AJ%12===0)?12:(AJ%12);this.hourLabel.innerHTML=AL;this.minuteLabel.innerHTML=a.formatInteger(AK.min||0,2);this.secondLabel.innerHTML=a.formatInteger(AK.sec||0,2);this.AMPMLabel.innerHTML=AJ<12?" "+AE().AM_NAME:" "+AE().PM_NAME;},premousedown:function(AJ){var AL=AJ.e,AK=k.eventTarget(AJ.hWin,AL);if(AK===this.decreaseButton||AK===this.increaseButton){if(k.isFF){k.stopPropogation(window,AL);}return true;}else{return this.processEvent(AK,AL);}},premouseup:function(AJ){var AL=AJ.e;if(AL.ctrlKey||AL.shiftKey){k.clearBrowserHighlights();}var AK=k.eventTarget(AJ.hWin,AL);if(AK===this.decreaseButton&&!AK.disabled){this.decrease();return true;}if(AK===this.increaseButton&&!AK.disabled){this.increase();return true;}},processEvent:function(AU,Ab){var AM=this.currentView,AN=this.selectedDates,AR,AW,Ac,AJ,AT;if(AU===this.monthLabel){if(AM!==AF){this.switchViewTo(AF);}return true;}if(AU===this.yearLabel){if(AM!==W){this.adjustYearStart();this.switchViewTo(W);return true;}}if(AU===this.hourLabel){if(AM!==Y){this.switchViewTo(Y);}return true;}if(AU===this.minuteLabel){if(AM!==AI){this.switchViewTo(AI);}return true;}if(AU===this.secondLabel){if(AM!==x){this.switchViewTo(x);}return true;}if(AU===this.AMPMLabel){if(AM!==Y){this.switchViewTo(Y);}return true;}if(AM===Y){var AP=AU.getAttribute("h");AT=parseInt(AU.innerHTML,10);if(!isNaN(AP)&&!isNaN(AT)){AP=parseInt(AP,10);this.timeVal.hour=AT%12+AP*12;this.updateTimePart();this.switchViewTo(d);if(!this.changeValueOnOK){this.updateValue();}}return true;}if(AM===AI){AT=parseInt(AU.innerHTML,10);if(!isNaN(AT)){this.timeVal.min=AT;this.updateTimePart();this.switchViewTo(d);if(!this.changeValueOnOK){this.updateValue();}}return true;}if(AM===x){AT=parseInt(AU.innerHTML,10);if(!isNaN(AT)){this.timeVal.sec=AT;this.updateTimePart();this.switchViewTo(d);if(!this.changeValueOnOK){this.updateValue();}}return true;}if(AM===d){var Aa=this.browseYear,AK=this.browseMonth,AL;AU=P(AU);Ac=parseInt(AU.innerHTML,10);AJ=parseInt(AU.getAttribute("m"),10);if(!isNaN(Ac)&&!isNaN(AJ)){AL=(AJ===0)?{y:Aa,m:AK}:(AJ===1?a.getNextMonth(Aa,AK):a.getPreMonth(Aa,AK));if((!this.canSelectDisabledDate&&this.isDateDisabled(Ac,AL.m,AL.y,this.min,this.max))||Ab.button===2){return true;}if(this.isAdvanced){return true;}var AX=X(AN,Ac,AK,Aa),AV=AN.length>1,AS=this.forceNonEmptySelection,AY=this.isMultiSelect,AQ=AY&&Ab.ctrlKey,AZ=AY&&Ab.shiftKey,AO=null;if(AZ){AO=g(this,AU);B(this);o(this,AO);}else{if(AQ){if(AX===-1){AH(this,AU);}else{if(!AS||AV){v(this,AX);}}}else{B(this);if(AV||AX===-1||AS){AH(this,AU);}}}if(this.onselect||J.hasSubs(this.id,"select")){this.raiseEvent({name:"select",value:this.selectedDates});}if(AJ===1){this.increase();}else{if(AJ===-1){this.decrease();}}if(!this.changeValueOnOK){this.updateValue();}else{if(this.showAdvanced){this.checkLabel.checkbox.set("checked",false);t.call(this,"baseDate",0);}}}return true;}if(AM===AF){AU=P(AU);AW=parseInt(AU.getAttribute("m"),10);if(!isNaN(AW)){this.set("browseMonth",AW+1);this.switchViewTo(d);}return true;}if(AM===W){AU=P(AU);AR=parseInt(AU.innerHTML,10);if(!isNaN(AR)){this.set("browseYear",AR);this.switchViewTo(d);}return true;}return true;},decrease:function(){var AL=this.currentView,AO=AL,AN=this.browseYear,AJ=this.browseMonth,AK=this.yearRangStart,AM;switch(AL){case d:AM=a.getPreMonth(AN,AJ);this.set("browseMonth",AM.m);this.set("browseYear",AM.y);break;case AF:this.set("browseYear",AN-1);break;case W:this.yearRangStart=AK-this.yearViewSize*this.yearViewSize;break;case Y:AO=x;break;case AI:AO=Y;break;case x:AO=AI;break;}this.switchViewTo(AO,"right");},increase:function(){var AL=this.currentView,AO=AL,AN=this.browseYear,AJ=this.browseMonth,AK=this.yearRangStart,AM;switch(AL){case d:AM=a.getNextMonth(AN,AJ);this.set("browseMonth",AM.m);this.set("browseYear",AM.y);break;case AF:this.set("browseYear",AN+1);break;case W:this.yearRangStart=AK+this.yearViewSize*this.yearViewSize;break;case Y:AO=AI;break;case AI:AO=x;break;case x:AO=Y;break;}this.switchViewTo(AO,"left");},updateView:function(AJ){var AK=this[AJ+"ViewHTML"]();this[AJ+"View"].innerHTML=AK;},adjustYearStart:function(){this.yearRangStart=this.browseYear-10-this.browseYear%5;},switchViewTo:function(AK,AM){var AQ="mstrmojo-Calendar-"+AK+"View",AP=document.createElement("div"),AJ=this[this.currentView+"View"],AN=AK+"ViewHTML",AO=this[this.currentView+"Label"],AL=this[AK+"Label"];if(!this.supportedViews[AK]){return ;}if(!AM){AM=this.sDirMatrix[this.currentView][AK];}AP.className=AQ;AP.innerHTML=this[AN]();this.currentView=AK;this[AK+"View"]=AP;mstrmojo.css.toggleClass(AP,["ddSelected"],this.isAdvanced);this._slideIntoView(AJ,AP,AM);},_slideIntoView:function(AN,AR,AL){var AJ=this.bodyContainer,AP=(AL==="left"||AL==="right")?AN.offsetWidth:AN.offsetHeight,AK=(AL==="left"||AL==="right")?"left":"top",AQ=(AL==="left"||AL==="up")?AP:-AP,AO=new mstrmojo.fx.AnimateProp({props:{},duration:this.duration,interval:this.duration/10,target:AN,onEnd:function(){AJ.removeChild(AN);}}),AM=new mstrmojo.fx.AnimateProp({props:{},duration:this.duration,interval:this.duration/10,target:AR});AR.style[AK]=AQ+"px";AJ.appendChild(AR);AO.props[AK]={start:0,stop:-AQ,suffix:"px"};AM.props[AK]={start:AQ,stop:0,suffix:"px"};AO.play();AM.play();},dayViewHTML:function(){var AO=this.browseYear,AR=this.browseMonth,AW=a.getDaysOfMonth(AO,AR),Aa=a.getPreMonth(AO,AR),AL=a.getDaysOfMonth(Aa.y,Aa.m),AK=a.getNextMonth(AO,AR),AS=H(AO,AR,this.firstDayOfWeek),AP=[],AM=AA(this),Ac=0,AJ=this.selectedDates,AU=this.min,AY=this.max,Ad,AV,AZ,AX,Ab=this.showCurMonthDatesOnly?'style="visibility:hidden;"':"";U(this,{d:AL,m:Aa.m,y:Aa.y},{d:1,m:AK.m,y:AK.y});AP.push(O(this.cssTextDay));AP.push(this._dayViewTHead());AP.push("<tr>");for(AZ=0;AZ<AS;AZ++){Ad=AL-AS+AZ+1;AV=this.isDateDisabled(Ad,Aa.m,Aa.y,AU,AY)?"disabled":"";AP.push("<td "+Ab+'><div class="mstrmojo-Calendar-day-pre '+AV+'" m="-1">');AP.push(Ad);AP.push("</div></td>");Ac++;}for(AZ=0;AZ<AW;AZ++){Ad=AZ+1;AV=this.isDateDisabled(Ad,AR,AO,AU,AY)?" disabled":"";var AN=q(Ad,AR,AO),AQ=AN?" today":"",AT=X(AJ,Ad,AR,AO)!==-1;AQ=(this.hilightToday&&AN)?" hilightToday":AQ;AP.push("<td "+(AN?('class="'+AQ+'" '):" ")+(AT?AM:"")+'><div class="mstrmojo-Calendar-day-cur'+(AT?(" selected "):"")+AV+'" m="0"'+(AT?AM:"")+">");AP.push(AZ+1);AP.push("</div></td>");if((++Ac)%7===0){AP.push("</tr><tr>");}}for(AX=Ac;AX<42;AX++){Ad=Ac-AW-AS+1;AV=this.isDateDisabled(Ad,AK.m,AK.y,AU,AY)?"disabled":"";AP.push("<td "+Ab+'><div class="mstrmojo-Calendar-day-next '+AV+'" m="1">');AP.push(Ad);AP.push("</div></td>");if((++Ac)%7===0&&Ac!==42){AP.push("</tr><tr>");}}AP.push("</tr>");AP.push(w);return AP.join("");},_dayViewTHead:function(){var AM=[],AN='<thead><tr class="mstrmojo-Calendar-thead" style="'+this.cssTextWeekDay+';">',AL="</tr></thead>",AK=this.firstDayOfWeek-1,AO=this.dayNames,AJ;AM.push(AN);for(AJ=AK;AJ<AK+7;AJ++){AM.push("<td>");AM.push(AO(AJ%7));AM.push("</td>");}AM.push(AL);return AM.join("");},monthViewHTML:function(){var AK=[],AM=this.browseMonth-1,AL=this.browseYear,AJ;U(this,{d:31,m:12,y:AL-1},{d:1,m:1,y:AL+1});AK.push(O(this.cssTextMonth));AK.push("<tr>");for(AJ=0;AJ<12;AJ++){AK.push("<td "+((AJ===AM)?AA(this):"")+'><div class="mstrmojo-Calendar-month'+((AJ===AM)?" selected":"")+'" m="');AK.push(String(AJ));AK.push('">');AK.push(this.monthNames(AJ));AK.push("</div></td>");if(AJ%3===2){AK.push("</tr><tr>");}}AK.pop();AK.push("</tr>");AK.push(w);return AK.join("");},yearViewHTML:function(){var AO=this.yearRangStart,AK=[],AM=this.browseYear,AN,AJ,AL=this.yearViewSize;U(this,{d:31,m:12,y:AO-1},{d:1,m:1,y:AO+AL*AL});AK.push(O(this.cssTextYear));AK.push("<tr>");for(AJ=0;AJ<AL*AL;AJ++){AN=AO+AJ;AK.push("<td "+((AM===AN)?AA(this):"")+'><div class="mstrmojo-Calendar-year'+((AM===AN)?" selected":"")+'">');AK.push(AN);AK.push("</div></td>");if(AJ%AL===(AL-1)){AK.push("</tr><tr>");}}AK.pop();AK.push("</tr>");AK.push(w);return AK.join("");},hourViewHTML:function(){var AL=[],AK=this.timeVal.hour,AJ;AL.push(G);AL.push('<tr><td colspan="6"><div class="mstrmojo-Calendar-hourTitle">');AL.push(AE().AM_NAME);AL.push("</div></td></tr>");for(AJ=0;AJ<12;AJ++){AL.push('<td><div class="mstrmojo-Calendar-hour'+((AJ===AK)?" selected":"")+'" h="0">');AL.push((AJ===0)?12:AJ);AL.push("</div></td>");if(AJ===5){AL.push("</tr><tr>");}}AL.push('</tr><tr><td colspan="6"><div class="mstrmojo-Calendar-hourTitle">');AL.push(AE().PM_NAME);AL.push("</div></td></tr>");for(AJ=0;AJ<12;AJ++){AL.push('<td><div class="mstrmojo-Calendar-hour'+(((12+AJ)===AK)?" selected":"")+'" h="1">');AL.push((AJ===0)?12:AJ);AL.push("</div></td>");if(AJ===5){AL.push("</tr><tr>");}}AL.push("</tr>");AL.push(w);return AL.join("");},minuteViewHTML:function(){return this._minuteSecondViewHTML(this.timeVal.min,"mstrmojo-Calendar-minute");},secondViewHTML:function(){return this._minuteSecondViewHTML(this.timeVal.sec,"mstrmojo-Calendar-second");},_minuteSecondViewHTML:function(AL,AM){var AK=[],AJ;AK.push(G);AK.push("<tr>");for(AJ=0;AJ<60;AJ++){AK.push('<td><div class="');AK.push(AM);AK.push((AJ===AL)?' selected">':'">');AK.push(AJ);AK.push("</div></td>");if(AJ%10===9){AK.push("</tr><tr>");}}AK.pop();AK.push("</tr>");AK.push(w);return AK.join("");},isDateDisabled:function(AJ,AL,AK){return !F(AJ,AL,AK,this.min,this.max);},unrender:function D(AJ){delete this.lastValue;this._super(AJ);}});}());(function(){mstrmojo.requiresCls("mstrmojo.dom","mstrmojo.Dialog","mstrmojo.Button","mstrmojo.HTMLButton","mstrmojo.Label","mstrmojo.form","mstrmojo.LoginEditor");mstrmojo.requiresDescs(2699,7773,11812,11865,13380,13381,13382);var D=mstrmojo.desc(13382,"Your user session will time out due to inactivity in # ##."),S=60,M=false,G=null,A=null,H=null;function N(){return mstrApp.sessionState||window.microstrategy&&microstrategy.sessionState;}function K(W,V){if(mstrApp.is508){for(var U in V){W.setAttribute(U,V[U]);}}}mstrmojo.SessionManager=mstrmojo.declare(mstrmojo.Editor,null,{scriptClass:"mstrmojo.SessionManager",cssClass:"mstrmojo-SessionManager",width:"370px",title:mstrmojo.desc(11812,"Notification"),msgInterval:1,checkSessionInterval:20,zIndex:10000,maxSessionIdleTime:600,timeBeforeSessionTimeoutWarning:60,remainingTime:60,sessionTimedout:false,buttons:[mstrmojo.Button.newWebButton(mstrmojo.desc(13381,"Stay logged in"),function(){var U=this.parent.parent;if(A){U.keepSessionAlive();}U.hideMessage();},true,{onRender:function(){K(this.domNode,{tabindex:0,role:"button","aria-label":mstrmojo.desc(13381,"Stay logged in")});}}),mstrmojo.Button.newWebButton(mstrmojo.desc(13380,"Log out"),function(){this.parent.parent.hideMessage();mstrmojo.form.send({evt:3019,src:mstrApp.name+".3019"});},null,{onRender:function(){K(this.domNode,{tabindex:0,role:"button","aria-label":mstrmojo.desc(13380,"Log out")});}})],children:[{scriptClass:"mstrmojo.Label",alias:"message",cssClass:"mstrmojo-SessionManager-msg",text:"",allowHTML:true,ontextChange:function(){if(mstrApp.is508){this.refresh();var U=this.domNode;K(U,{tabindex:-1,role:"alert"});window.setTimeout(function(){U.focus();},0);}}}],postBuildRendering:function(){this._super();if(mstrApp.is508){this.msgInterval=10;K(this.editorNode,{role:"alertdialog",tabindex:-1});}},updateMsg:function B(V){var U;if(V>60){U=D.replace("##",mstrmojo.desc(2699,"minutes")).replace("#","<b>"+Math.ceil(V/S)+"</b>");}else{if(V>-1){U=D.replace("##",mstrmojo.desc(7773,"seconds")).replace("#","<b>"+V+"</b>");}else{U=mstrmojo.desc(11865,"Your session is expired.");}}this.message.text="";this.message.set("text",U);this.remainingTime=V;},showMessage:function F(U){this.updateMsg(U);this.set("visible",true);M=true;},hideMessage:function I(){if(A){window.clearInterval(A);A=null;window.clearInterval(H);H=null;}this.set("visible",false);M=false;},popupTimeoutWarning:function L(Y){if(M){return ;}var W=this,X=(typeof Y==="number")?Y:W.timeBeforeSessionTimeoutWarning,U=X,V=mstrmojo.now();if(mstrApp.enableWarningSessionTimeout){if(!this.hasRendered){this.render();}this.showMessage(U);}window.clearInterval(A);A=window.setInterval(function(){if(U<1){window.clearInterval(A);A=null;window.clearInterval(H);H=null;window.setTimeout(function(){if(mstrApp.enableWarningSessionTimeout){W.gotoLogoutPage();}else{W.sessionTimedout=true;W.closeSession();}},200);}var Z=Math.round((mstrmojo.now()-V)/1000);U=X-Z;W.updateMsg(U);},this.msgInterval*1000);window.clearInterval(H);H=window.setInterval(function(){W.isSessionAlive();},this.checkSessionInterval*1000);},warningTimeoutTimer:function Q(U){var V=this;window.clearTimeout(G);G=window.setTimeout(function(){G=null;V.isSessionAlive();},(U-this.timeBeforeSessionTimeoutWarning)*1000);},isSessionAlive:function E(){var U=this,W={success:function(X){var Y=parseInt(X,10);if(Y!==-1){if(Y>U.remainingTime){U.hideMessage();}if(Y>U.timeBeforeSessionTimeoutWarning){U.warningTimeoutTimer(Y);}else{U.popupTimeoutWarning(Y);}}else{window.clearInterval(H);U.popupTimeoutWarning(0);}},failure:function(){mstrmojo.alert("Problems encountered during checking for whether session is alive. Connection is down or session already time out.");}},V={taskId:"isSessionAlive",notRestartSessionManager:true};mstrmojo.xhr.request("POST",mstrConfig.taskURL,W,V);},keepSessionAlive:function R(){var U=this,W={success:function(X){if(X){U.warningTimeoutTimer(U.maxSessionIdleTime);}else{U.sessionTimedout=true;mstrmojo.alert("Your session is expired.");}},failure:function(){mstrmojo.alert("Problems encountered during activating session. Connection is down or session already time out.");}},V={taskId:"keepSessionAlive"};mstrmojo.xhr.request("POST",mstrConfig.taskURL,W,V);},closeSession:function J(){var U=this;mstrmojo.xhr.request("POST",mstrConfig.taskURL,{success:function(){U.sessionTimedout=true;}},{taskId:"closeSessions",sessionStates:N(),notRestartSessionManager:true});},restart:function(){this.sessionTimedout=false;this.hideMessage();if(this.maxSessionIdleTime>this.timeBeforeSessionTimeoutWarning){this.warningTimeoutTimer(this.maxSessionIdleTime);}},start:function C(){var W=mstrConfig.lastMsgKey;if(this.maxSessionIdleTime>this.timeBeforeSessionTimeoutWarning){this.warningTimeoutTimer(this.maxSessionIdleTime);}var V=function(){window.localStorage.setItem("msg_recovery_notify"+W,1);};if(window.addEventListener){window.addEventListener("beforeunload",V);}else{window.attachEvent("onbeforeunload",V);}var U=window.sessionStorage;if(U){U.setItem("msg_browser_not_closed"+W,1);U.setItem("msg_user_login",0);}},openLoginEditor:function P(W){if(window.mstrmobile&&window.mstrmobile.onSessionExpired){window.mstrmobile.onSessionExpired();return ;}var V="LoginEditor",U=mstrmojo.all[V];if(!U){U=mstrmojo.insert({id:V,scriptClass:"mstrmojo.LoginEditor",config:{callback:{}},zIndex:10000});}U.config.callback=W;U.open();},gotoLogoutPage:function O(){mstrmojo.form.send({evt:3008,src:mstrApp.name+".3008",autoLoggedout:true,Server:mstrConfig.serverName,Port:mstrConfig.serverPort,Project:mstrmojo.string.decodeHtmlString(mstrConfig.projectName),loginReq:true},null,"POST");}});}());(function(){mstrmojo.requiresCls("mstrmojo._HasPopup","mstrmojo.rw.xtab.XtabMenuConfig","mstrmojo.dom","mstrmojo.hash");var G=mstrmojo.dom;function B(I,H){if(H){H.opener=this;}this.openPopup(I,H);}mstrmojo.express.ui._IsDocumentView=mstrmojo.provide("mstrmojo.express.ui._IsDocumentView",mstrmojo.hash.copy(mstrmojo._HasPopup,{_mixinName:"mstrmojo.express.ui._IsDocumentView",openXtabCellMenu:function A(H){var I=this.getXtabCellMenuConfig({isHostedWithin:false,position:H.cmPos||G.position(H.btn.domNode),hostId:this.id});I.buildXtabMenuConfig(H);if(I.hasMenuItems()){B.call(this,I.newInstance(),H);}},openXtabCellMenuWithSelectionStyleControl:function D(H){var J=null,I=this.getXtabCellMenuConfig({isHostedWithin:false,position:H.cmPos||G.position(H.btn.domNode),hostId:this.id});I.buildXtabMenuConfig(H);if(I.hasMenuItems()){J=I.newInstance();B.call(this,J,H);}return J;},getXtabCellMenuConfig:function(H){return new mstrmojo.rw.xtab.XtabMenuConfig(H);},drillLinkMenuRef:"mstrmojo.DrillLinkMenu",openDrillLinkMenu:function E(H){B.call(this,"drillLinkMenuRef",H);},goToLink:function C(H){if(H){mstrmojo.form.sendLink(H.url,H.target||"_self");}},openPopupMenu:function F(I,H){B.call(this,I,H);}}));}());(function(){mstrmojo.requiresCls("mstrmojo.vi.ui._MonitorsTocPage","mstrmojo.vi.ui.LinkTargetSelector","mstrmojo.vi.ui.InlineDialogBase");mstrmojo.vi.ui.VisAsFilterInlineDialog=mstrmojo.declare(mstrmojo.vi.ui.InlineDialogBase,[mstrmojo.vi.ui._MonitorsTocPage],{scriptClass:"mstrmojo.vi.ui.VisAsFilterInlineDialog",_createTargetSelector:function C(){return new mstrmojo.vi.ui.LinkTargetSelector({alias:"targetSelector",orientation:"h",hostId:this.id,srcId:this.vis.id});},_setTargetsFunc:function B(){var E=this.vis,D=E.model;D.setVisAsFilter(E,this.changes);},_tocNavWarn:function A(D){var F=this,E=F.vis.model;mstrmojo.warn(mstrmojo.desc(15094,"Selecting targets on another page will discard all the selected targets on the current page."),{confirmBtn:{t:mstrmojo.desc(212,"Continue"),fn:function(){var G=E.getVizContentPanel()._tgtSelections;G&&G.clear();F.goToPage(D);},hot:true},cancelBtn:{t:mstrmojo.desc(221,"Cancel")}},{title:mstrmojo.desc(15093,"Do you want to target visualizations on another page?")});}});}());(function(){mstrmojo.requiresCls("mstrmojo.array","mstrmojo.css","mstrmojo.dom","mstrmojo.EnumRWUnitType","mstrmojo.Label","mstrmojo.ui.Pulldown","mstrmojo.vi.ui.TargetSelector","mstrmojo.vi.ui.TruncatedList","mstrmojo.vi.ui.InlineDialogBase");mstrmojo.requiresDescs(16166,11955,11956);var G=mstrmojo.array,A=mstrmojo.css,D=mstrmojo.dom;mstrmojo.vi.ui.FilterBoxInlineDialog=mstrmojo.declare(mstrmojo.vi.ui.InlineDialogBase,null,{scriptClass:"mstrmojo.vi.ui.FilterBoxInlineDialog",tocEnabled:false,selectFilters:true,init:function F(H){this._super(H);A.addWidgetCssClass(this,"filter-box-dialog");},_setTargetsFunc:function E(){this.vis.setTargets(this.changes.filterKeys);},toggleFields:function B(){if(this.cgbs.length!==0){this.forType.set("visible",true);}},_addChildren:function C(){var K=this,M=K.vis,I=M.model,N=[{scriptClass:"mstrmojo.Label",cssClass:"mstrmojo-title-label",cssDisplay:"inline",allowHTML:true,text:mstrmojo.desc(16166,"Use <span>#</span> to filter data in").replace("#",M.title),visible:true},K._createTruncatedList(),{scriptClass:"mstrmojo.ui.Pulldown",cssClass:"mstrmojo-for-type",cssDisplay:"inline-block",alias:"forType",value:0,visible:false,selectedIndex:0,isHostedWithin:true,enabled:false,items:[{n:mstrmojo.desc(11955,"for #").replace("#",(K.cgbs[0]||{}).n),v:false},{n:mstrmojo.desc(11956,"for All Data"),v:true}],onitemSelected:function(O){K.changes.forAllData=O.v;},onenabledChange:function(){A.toggleClass(this.domNode,"disabled",!this.enabled);}}],H=I.getPanel(this.currentPanelKey,this.currentLayoutKey).children||[],J,L={};for(J=H.length-1;J>=0;J--){K._addVis(H[J],L);}this.addChildren(N);this.targetKeys=L;}});}());(function(){mstrmojo.requiresCls("mstrmojo.Editor","mstrmojo.array","mstrmojo.Button","mstrmojo.css","mstrmojo.hash","mstrmojo.Label","mstrmojo.Box","mstrmojo.ui.Pulldown","mstrmojo.ui.SearchablePulldown","mstrmojo.func");mstrmojo.requiresDescs(221,1442,2751,2891,11949,11950,11951,11942,13397,13398,14640,14648);var R=mstrmojo.array,V=mstrmojo.css,N=mstrmojo.hash,O=mstrmojo.func,M=mstrmojo.Button.newWebButton,P=mstrmojo.dom,U="mstrmojo-link-validation",Q="mstrmojo-link-vt",F=function F(W){if(W.old){this.removedLinks.push(W);}this.links.removeChildren(W);},S=function S(){var u=this.dsMap,q=this.docModel,Z=q.datasets,w=function w(j,x,a){var k={n:a||"",did:x||null,parent:j||null,lv:(j?j.lv+1:-1),children:[]};if(j){j.children.push(k);}return k;},f=w(),Y,X,W,h,b,r,m,v,t,p,o,n,d,c,e,l,g;N.forEach(Z,function(a){if(q.isMDXDataset(a)){b=a.tables;for(p=0,c=b.length;p<c;p++){r=b[p];Y=w(f,r.did,r.n);Y.isMDX=true;for(o=0,e=r.dimensions.length;o<e;o++){m=r.dimensions[o];X=w(Y,m.did,m.n);for(n=0,l=m.hierarchies.length;n<l;n++){v=m.hierarchies[n];W=w(X,v.did,v.n);for(d=0,g=v.att.length;d<g;d++){t=v.att[d];h=w(W,t.did,t.n);h.att=t;u[r.did+":"+t.did]=h;}}}}}else{Y=w(f,a.did,a.name);Y.isMDX=false;R.forEach(a.att,function(j){h=w(Y,j.did,j.n);h.att=j;u[a.did+":"+j.did]=h;});}});return f;},B=function B(c,d){c=R.ensureArray(c);var b=this,a=this.attribute.did,e=this.docModel,Y=this.datasetId,X="\u001F",W={success:function(g){var j=g.als,f=(e.als&&e.als.links)||{},h=b.dsTree;R.forEach(c,function(r,m){var t={},k={},l=[],n={},q=a+" "+r,o=R.filter(j[m].ats,function(u){return !e.isInDataset(Y,u.at,["att"]);}),p=function p(u,v){if(!n[u]){n[u]={};}if(!n[u][v]){n[u][v]=true;}};R.forEach(o,function(w){var u=w.at,v=w.fms;t[u]=true;if(v){R.forEach(v,function(x){p(u,x.fm);});}});N.keyarray(f).forEach(function(u){if(u===q){R.forEach(f[u],function(v){v=v.split(" ");t[v[0]]=true;p(v[0],v[1]);});}});if(N.keyarray(t).length>0){R.forEach(h.children,function(v){var u=function(w){var x;if(!w.att){return ;}w=w.att;if(t[w.did]){if(!k[w.n]){k[w.n]={};}if(!k[w.n][w.did]){k[w.n][w.did]=[];}k[w.n][w.did].push(v.n);x=N.copy(w,x);x.dsId=v.did;l.push(x);}};if(v.isMDX){R.forEach(v.children,function(w){R.forEach(w.children,function(x){R.forEach(x.children,u);});});}else{R.forEach(v.children,u);}});}b.tgtAttrs[r]=l;b.tgtForms[r]=n;b.namesHash[r]=k;});}},Z={taskId:"validateDocumentLinks",msgID:e.mid,action:1,attributeList:a,attributeFormList:c.join(X)};mstrApp.serverRequest(Z,O.wrapMethods(W,d));},E=function(Z,b,X,a){Z.richTooltip=null;if(!Z.isSearching){var Y=b&&b.scrollWidth>b.clientWidth;X=Y?mstrmojo.desc(14648,"## from ###").replace("##",X):"";if(a){if(!Y){X=mstrmojo.desc(14640,"From ###");}X=X.replace("###",a);}var W=mstrmojo.dom.position(b);Z.richTooltip={cssClass:"vi-regular vi-tooltip-V",contentNodeCssClass:"regular-unitlist-tooltips",posType:mstrmojo.tooltip.POS_BOTTOMLEFT,content:X,top:W.y-6,left:W.x};}},D=function D(d){var e=this,g=function(o){var m=o.fs,p=o.de,n=[];(m||[]).forEach(function(q){if(q.obf&&(!p||q.idf)){n.push({n:q.fnm,v:q.fid,idf:q.idf});}});return n;},h=g(this.attribute),a=function(p,n){var m=g(p);var q=(e.tgtForms[n]&&e.tgtForms[n][p.did])||{};var o=[];R.forEach(m,function(r){if(q[r.v]){o.push(r);}});return o;},c=function c(n){var m=[];R.forEach(e.tgtAttrs[n],function(o){if(a(o,n||e.idFormId).length>0){var q=e.namesHash[n],p=o.n;if(q[o.n]&&N.keyarray(q[o.n]).length>1){p=p+" ("+q[o.n][o.did].join(",")+")";}m.push({n:o.n,v:o,tt:p});}});if(m.length===0){m.push({n:mstrmojo.desc(13398,"No valid object"),v:{did:null},cls:"nvo",t:1});}return m;},j=c((d&&d.srcFormId)||this.idFormId),k=function(m,n){return R.find(m.fs,n?"fid":"idf",n||true);},l=function(n){var m=-1;j.forEach(function(p,o){if(p.v.did===n){m=o;}});return m;},X=function(n){var m=j[n];if(!m){return mstrmojo.desc(13397,"Select an attribute");}else{return m.n;}},Y=function(n){var o=n.items,m=n.selectedIndex;if(m>=0){if(o[m].idf){return ;}}o.forEach(function(q,p){if(q.idf){n.set("selectedIndex",p);}});};this.links.addChildren({scriptClass:"mstrmojo.Box",cssClass:"mstrmojo-linkRow",slot:"containerNode",old:!!d,oldMeta:d,getMeta:function(){var m=this.linkFromForm,o=this.linkToAtt,n=this.linkToForm;return{srcAttrId:e.attribute.did,srcFormId:m.items[m.selectedIndex].v,tgtAttrId:o.items[o.selectedIndex]&&o.items[o.selectedIndex].v.did,tgtFormId:n.items[n.selectedIndex]&&n.items[n.selectedIndex].v};},children:[{scriptClass:"mstrmojo.Label",cssClass:"mstrmojo-attName",text:e.attribute.n,useRichTooltip:true,updateTooltipConfig:function(q){var p=q.target,m=this.text,n=e.datasetId,o=n?e.docModel.datasets[n].name:"";E(this,p,m,o);}},{scriptClass:"mstrmojo.ui.Pulldown",cssClass:"mstrmojo-linkFormFromPD",alias:"linkFromForm",value:"ID",isHostedWithin:true,items:h,selectedIndex:k(e.attribute,d&&d.srcFormId),onitemSelected:function(n){var m=this,o=function(){var q=m.parent.linkToAtt;j=c(n.v);q.set("items",j);q.set("selectedIndex",-1);q.set("text",mstrmojo.desc(13397,"Select an attribute"));V.addClass(q.selectedNode,"nvo");},p={success:o};if(this.hasRendered){if(this.parent.old){this.parent.oldUpdated=true;}if(!n.idf){Y(this.parent.linkToForm);if(!e.tgtForms[n.v]){B.call(e,n.v,p);return ;}}o();}}},{scriptClass:"mstrmojo.Label",cssClass:"mstrmojo-linksToLabel",text:mstrmojo.desc(11949,"links to")},{scriptClass:"mstrmojo.ui.SearchablePulldown",cssClass:"mstrmojo-linkToAtt",alias:"linkToAtt",useRichTooltip:true,isHostedWithin:false,items:j,text:X(l(d&&d.tgtAttrId)),selectedIndex:l(d&&d.tgtAttrId),allowCustomText:true,allowEmptyText:true,updateTooltipConfig:function(r){var q=r.target,m=q.getAttribute("tt"),o=this.getSelectedItem(),n=o?o.v.dsId:null,p=n?e.docModel.datasets[n].name:"";if(this.selectedNode===q&&o){m=o.tt;}E(this,q,m,p);},onitemSelected:function(q){if(!q||q.v.did===null){return ;}var p=this.parent.linkToForm,o=this.parent.linkFromForm,n=a(q.v,o.items[o.selectedIndex].v),r=function r(t,v){var u=R.find(t,v?"v":"idf",v||true);if(u===-1&&t.length>0){u=0;}return u;},m;R.forEach(n,function(t){if(t.idf){m=false;return false;}});if(m){K.call(e,true);}p.set("items",n);p.set("selectedIndex",r(n,!this.hasRendered&&d&&d.tgtFormId));if(this.hasRendered&&this.parent.old){this.parent.oldUpdated=true;}J.call(e);},onPopupWidgetOpened:function b(){if(this.selectedIndex===-1){this.set("text","");}V.removeClass(this.selectedNode,"nvo");},onPopupWidgetClosed:function f(){mstrmojo.ui.SearchablePulldown.prototype.onPopupWidgetClosed.call(this);if(this.selectedIndex===-1&&this.text===""){this.set("text",mstrmojo.desc(13397,"Select an attribute"));V.addClass(this.selectedNode,"nvo");}else{V.removeClass(this.selectedNode,"nvo");}this.hideTooltip();R.forEach(e.collapseTargets,function(m){m.className="arrow-b";V.removeClass(m.parentNode.parentNode,"collapse");});R.forEach(e.collapseTreeNodes,function(m){delete m.collapse;});R.forEach(this.list.itemsContainerNode.childNodes,function(m){m.style.display="";});},postBuildRendering:function W(){mstrmojo.ui.SearchablePulldown.prototype.postBuildRendering.call(this);if(this.selectedIndex===-1){V.addClass(this.selectedNode,"nvo");}this.list.popupConfig.clear();},getPopupListConfig:function Z(){return{scriptClass:"mstrmojo.ui.PopupList",alias:"list",width:"170px",tooltipOrientation:"vertical",selectionPolicy:"reselect",useRichTooltip:true,locksHover:true,listHooks:{select:function m(t,u,r){this.parent.set("selectedIndex",r);this.close();}},onclick:function n(AB){try{var t=AB.getTarget(),AC=this.getItemFromTarget(t),x=P.findAncestorByAttr(t,"idx",true,this.domNode),w=this.items;if(w){this.parent.set("items",w);}if(AC){AB.cancel();if(t.className==="arrow-b"||t.className==="arrow-r"){var r=this.itemsContainerNode.childNodes,v=function v(AE){var AD;while(AE){AD=AE.className||"";if(AD.indexOf("lv")===0){return window.parseInt(AD.substring(2),10);}AE=AE.firstChild;}return null;},AA=function AA(AD,AG){var AF=e.dsMap,AE=AF[AD.dsId+":"+AD.did];while(AE){if(AE.lv===AG){return AE;}AE=AE.parent;}return null;},z=function z(){var AM=(t.className==="arrow-b"),AG=t.parentNode.parentNode,AD=v(AG),AH=AC._renderIdx,AE=AA(AC.v,AD),AK=w.length,AJ,AF,AI,AL,AO,AN;t.className=AM?"arrow-r":"arrow-b";if(!e.collapseTargets){e.collapseTargets=[];}e.collapseTargets.push(t);V.toggleClass(AG,"collapse",AM);AE.collapse=AM;if(!e.collapseTreeNodes){e.collapseTreeNodes=[];}e.collapseTreeNodes.push(AE);for(AJ=AH+1;AJ<AK;AJ++){AF=r[AJ];AI=v(AF);if(AI<=AD){break;}AL=AA(w[AJ].v,AI);AO=AL.parent;AN=true;while(AO){if(AO.collapse){AN=false;break;}AO=AO.parent;}AF.style.display=(AN?"":"none");}};z();}else{if(x&&x.node.className.indexOf("item")!==-1){this.doItemSelect(AC,AB||{});}}}}catch(u){mstrApp.onerror(u);}},getItemProps:function o(u,r){var t=mstrmojo._IsList.getItemProps.call(this,u,r);var v=u.cls;if(v){t.addCls(v);}return t;},getItemMarkup:function q(AD,AC){if(AD.v.did===null){return'<{@tag} class="item {@cls}" did="'+AD.v.did+'" idx="{@idx}" style="{@style}">{@n}</{@tag}>';}var AE=[],AA=AD.v.did,u=AD.v.dsId,v=u?e.docModel.datasets[u]:null,t=v?v.name:"",AB=AC>0&&this.items[AC-1].v,x=e.dsMap,w=x[AD.v.dsId+":"+AA],r=x[(AB&&(AB.dsId+":"+AB.did))];AE.push("</div>");while(w){if(w.lv===-1){break;}if(w.att){var z=w.att.da?"derived-attr":"attr";AE.push('<div class="lv'+w.lv+' dim item {@cls}" tt="'+AD.tt+'" did="'+AA+'" dsName="'+t+'" idx="{@idx}" style="{@style}"><div><div class="'+z+'"></div></div>{@n}</div>');}else{if(w!==r){AE.push('<div class="lv'+w.lv+' dim" dtt="'+w.n+'" idx="{@idx}"><div><div class="arrow-b"></div></div>'+w.n+"</div>");}else{break;}}w=w.parent;r=(r&&r.parent)||null;}AE.push("<div>");return AE.reverse().join("");},updateTooltipConfig:function p(x){var w=x.target,u=w.getAttribute("tt"),t=w.getAttribute("dtt"),v=w.getAttribute("dsName"),r=u||t;if(r){E(this,w,r,v);}}};}},{scriptClass:"mstrmojo.ui.Pulldown",cssClass:"mstrmojo-linkFormToPD",alias:"linkToForm",value:"ID",isHostedWithin:true,items:[],onitemSelected:function(m){if(this.hasRendered){if(this.parent.old){this.parent.oldUpdated=true;}if(!m.idf){Y(this.parent.linkFromForm);}}}},M("",function(){F.call(e,this.parent);},false,{cssClass:"mstrmojo-removeLink"})]});this.links.renderChildren();},K=function(W){V.toggleClass(this.editorNode,"mstrmojo-advanced",W);},L=function(Z){var X=this,a=U,W;try{mstrmojo.all[a].destroy();}catch(Y){}W={scriptClass:"mstrmojo.Editor",id:a,title:mstrmojo.desc(2751,"Message"),cssClass:"mstrmojo-alert",buttons:[M(mstrmojo.desc(1442,"Ok"),function(){mstrmojo.all[a].destroy();H.call(X);},true)],children:[{scriptClass:"mstrmojo.Label",text:Z}],visible:true,zIndex:1000};mstrmojo.insert(W).render();},H=function(){var Y=this,X=this.illLinks,W=this.links.children,Z=Q;R.forEach(X,function(a){a=a.al;R.forEach(W||[],function(c){var e=c.getMeta(),f=c.linkToAtt,b,d;if(e.srcAttrId===a.alaid1&&e.tgtAttrId===a.alaid2){if(!mstrmojo.all[Z]){d=new mstrmojo.Tooltip({id:Z,cssClass:Y.themeClassName+" vi-warning vi-tooltip-V",contentNodeCssClass:"regular-unitlist-tooltips",posType:mstrmojo.tooltip.POS_BOTTOMLEFT,updatePopupConfig:null});P.attachEvent(Y.editorNode,"click",function(){d.close();V.toggleClass(f.selectedNode,"mstrmojo-Warning",false);});}else{d=mstrmojo.all[Z];}d.close();b=mstrmojo.dom.position(f.selectedNode);d.set("top",b.y-6);d.set("left",b.x);d.set("content",a.alstmsg);V.toggleClass(f.selectedNode,"mstrmojo-Warning",true);d.open();return false;}});});},A=function(){var W=mstrmojo.all[Q];if(W){W.close();}},J=function J(){this.buttons[0].enabled=true;if(this.btnHbox){this.btnHbox.children[0].set("enabled",true);}},G=function G(){var W=this,X=[{scriptClass:"mstrmojo.Box",cssClass:"mstrmojo-toolBox",alias:"tools",children:[{scriptClass:"mstrmojo.Button",cssClass:"mstrmojo-WebHoverButton mstrmojo-addLink",text:mstrmojo.desc(11950,"Add A Link"),title:mstrmojo.desc(11950,"Add A Link"),onclick:function(){D.call(W);A.call(W);}},{scriptClass:"mstrmojo.Button",cssClass:"mstrmojo-WebHoverButton mstrmojo-showForms",text:mstrmojo.desc(2891,"Show Attribute Forms"),title:mstrmojo.desc(2891,"Show Attribute Forms"),onclick:function(){K.call(W,true);A.call(W);}},{scriptClass:"mstrmojo.Button",cssClass:"mstrmojo-WebHoverButton mstrmojo-hideForms",text:mstrmojo.desc(11951,"Hide Attribute Forms"),title:mstrmojo.desc(11951,"Hide Attribute Forms"),onclick:function(){K.call(W,false);A.call(W);}}],slot:"containerNode"},{scriptClass:"mstrmojo.Box",cssClass:"mstrmojo-linksBox mstrmojo-advanced",alias:"links",slot:"containerNode"}];this.addChildren(X);};mstrmojo.vi.ui.editors.AttributeLinkEditor=mstrmojo.declare(mstrmojo.Editor,null,{scriptClass:"mstrmojo.vi.ui.editors.AttributeLinkEditor",title:mstrmojo.desc(11942,"Link Attributes"),cssClass:"mstrmojo-att-link",btnAlignment:"right",buttons:null,modal:true,visible:false,help:"link_attributes_editor.htm",attribute:null,tgtAttrs:null,tgtForms:null,docModel:null,datasetId:null,namesHash:null,removedLinks:null,preBuildRendering:function C(){var Z=this,X=this.docModel,Y=function(){var a=(X.als&&X.als.links)||{},b=[];N.keyarray(a).forEach(function(c){if(c.indexOf(Z.attribute.did+" ")===0){a[c].forEach(function(d){b.push({srcAttrId:c.split(" ")[0],srcFormId:c.split(" ")[1],tgtAttrId:d.split(" ")[0],tgtFormId:d.split(" ")[1]});});}});return b;},W;this.set("buttons",[M(mstrmojo.desc(1442,"OK"),function(){var h=[],b=Z.links.children,a=function(){var j=X.controller,k=X.controller.getRefreshCallback();if(h.length>0){j.cmdMgr.execute({execute:function(){this.submit(h,k,{style:{params:{treesToRender:3}}});},urInfo:{callback:k}});}Z.close();},g=false,d,e;Z.removedLinks.forEach(function(j){d=N.copy(j.oldMeta,{act:"applyAttributeLinking",unlink:true});h.push(d);});(b||[]).forEach(function(j){if(j.old&&j.oldUpdated){d=N.copy(j.oldMeta,{act:"applyAttributeLinking",unlink:true});h.push(d);}if(!j.old||(j.old&&j.oldUpdated)){e=j.getMeta();if(!e.tgtAttrId){return ;}d=N.copy(e,{act:"applyAttributeLinking",unlink:false});h.push(d);}});R.forEach(h,function(j){if(!j.unlink){g=true;return false;}});if(!g){a();return ;}var f={taskId:"validateDocumentLinks",msgID:X.mid,action:2,manipulationList:'{"ml":'+JSON.stringify(h)+"}"},c={success:function(j){if(j.als&&j.als.length>0){var k="";R.forEach(j.als,function(l){k+=l.al.alstmsg+"\n";});Z.illLinks=j.als;L.call(Z,k);return ;}a();}};mstrApp.serverRequest(f,c);},true,{enabled:false}),M(mstrmojo.desc(221,"Cancel"),function(){Z.close();})]);G.call(this);W=Y(this.attribute.did);if(W.length>0){W.forEach(function(a){D.call(Z,a);});J.call(this);}else{D.call(this);}this._super();},close:function I(){A.call(this);this.destroy();}});mstrmojo.vi.ui.editors.AttributeLinkEditor.open=function(c){var X=mstrmojo.insert(N.copy(c,{scriptClass:"mstrmojo.vi.ui.editors.AttributeLinkEditor",tgtAttrs:{},tgtForms:{},namesHash:{},removedLinks:[]})),a=X.attribute,d=a.did,W=X.docModel,Z=(W.als&&W.als.links)||{},Y=[],b={success:function(){X.set("visible",true);X.render();}};R.forEach(a.fs,function(e){if(e.idf){X.idFormId=e.fid;return false;}});N.keyarray(Z).forEach(function(f){var e=f.split(" ");if(e[0]===d){Y.push(e[1]);}});if(R.indexOf(Y,X.idFormId)===-1){Y.push(X.idFormId);}X.dsMap={};X.dsTree=S.call(X);B.call(X,Y,b);};}());(function(){mstrmojo.requiresCls("mstrmojo.Obj","mstrmojo.onetier.vi.prefs.LoginEditor","mstrmojo.vi.models.editors.ControlsViewFactory","mstrmojo.Editor","mstrmojo.hash");var V=mstrmojo.hash;function I(l){var m=mstrmojo.desc(14575,"Login failure."),o={"-50":mstrmojo.desc(15505,"Desktop cannot download dossiers with prompts that require an answer but do not have a default answer set."),"-51":mstrmojo.desc(15507,"You are not allowed to download dossiers from the server. Please check with the administrator of the project."),"-52":mstrmojo.desc(15543,"You are not allowed to upload dossiers to the server. Please check with the administrator of the project."),"-2147202292":m,"-2147216959":m};var n=o[l.taskErrorCode]||l.errorMessage||l.message||(l.taskErrorCode&&"TaskErrorCode:"+l.taskErrorCode+" (No error message).")||(l.getResponseHeader&&l.getResponseHeader("X-MSTR-TaskFailureMsg"));if(l.taskErrorCode!==-2147028992&&n!==undefined){mstrmojo.error({longDesc:n},undefined,{zIndex:100000});}return !n;}mstrmojo.onetier.vi.prefs.DesktopConnectivityProxyBase=mstrmojo.declare(mstrmojo.Obj,null,{scriptClass:"mstrmojo.onetier.vi.prefs.DesktopConnectivityProxyBase",showPreferencesEditor:function B(){this.throwAbstractMethodError("savePreferences");},savePreferences:function d(l){this.throwAbstractMethodError("savePreferences");},getSavedPreferences:function h(l){this.throwAbstractMethodError("getSavedPreferences");},deleteServerConnections:function F(l){this.throwAbstractMethodError("deleteServerConnections");},testServerConnection:function J(l,m){this.throwAbstractMethodError("testServerConnection");},loginToWebserver:function C(m,o,l,n){this.throwAbstractMethodError("loginToWebserver");},loginToProxy:function D(p,o,l,m,n){this.throwAbstractMethodError("loginToProxy");},httpStatusCodeHandler:function k(p,l,n){var m=this,o;if(p===401||p===407){o=new mstrmojo.onetier.vi.prefs.LoginEditor(V.copy(n,{onLoginCancelled:function q(){m.authenticationCancelled();}}));}switch(p){case 200:l();break;case 401:case 407:o.open();break;case 404:case 500:mstrmojo.alert(mstrmojo.desc(13690,"Unable to connect to the server now. Please check your connection."));break;}},authenticationCancelled:function R(){this.throwAbstractMethodError("authenticationCancelled");},resumeDashboardExecution:function M(){this.throwAbstractMethodError("authenticationCancelled");},checkForDesktopUpdates:function a(){this.throwAbstractMethodError("checkForDesktopUpdates");},showProxyEditor:function O(){this.throwAbstractMethodError("showProxyEditor");},getProjects:function L(l,m){this.throwAbstractMethodError("getProjects");},getSessionState:function Z(n,m,l,o,p){this.throwAbstractMethodError("getSessionState");},getLoginFirstSessionState:function e(l,m){this.throwAbstractMethodError("getLoginFirstSessionState");},login:function S(l,m){this.throwAbstractMethodError("login");},loginFirst:function S(l,m){this.throwAbstractMethodError("loginFirst");},sendWebServerRequest:function Y(m,n,l){this.throwAbstractMethodError("sendWebServerRequest");},saveToServer:function E(l,m){this.throwAbstractMethodError("saveToServer");},openFromServer:function A(l,m){this.throwAbstractMethodError("openFromServer");},loadCube:function b(l,m){this.throwAbstractMethodError("loadCube");},getCubeInfo:function G(l,m){this.throwAbstractMethodError("getCubeInfo");},getPublicCloudSession:function N(l,m){this.throwAbstractMethodError("getPublicCloudSession");},saveToPublicCloud:function U(l,m){this.throwAbstractMethodError("saveToPublicCloud");},logout:function c(l,m){this.throwAbstractMethodError("saveToPublicCloud");},getWebServersProjects:function K(r){var l={},q=0,o=false,p=function(u){if(u&&!u.wsservlet){var w=this.parseServerURL(u.url);u.wsservlet=w.wsservlet;u.wsfolderpath=w.wsfolderpath;}return{success:function x(z){l[u.id]={};l[u.id].connection=u;l[u.id].loginInfo=z.loginInfo;if(z.loginRequired){l[u.id].loginFirst=true;}else{l[u.id].clusters=z.clusters;}},failure:function v(z){if(z.code===403){o=true;}else{if(!I(z)){if(z.status===401){l[u.id]={};l[u.id].connection=u;l[u.id].loginFirst=true;}}}},complete:function t(){q--;if(q===0){r.success(l,o);}}};}.bind(this),n=function n(t){this.getSavedPreferences({success:function v(w){t.success((w&&w.server&&w.server.conn)||[]);},failure:function u(w){t.failure(w);}});},m=function m(u,t){this.getProjects(u,t);};n.call(this,{success:function(t){t.forEach(function(u){if(u.url){q++;var w={connectionId:u.id},v=function(){m.call(this,w,p(u));}.bind(this);this.getLoginFirstSessionState(u.id,{success:function(x){w.sessionState=x.sessionState;v();},failure:function(){v();}});}}.bind(this));if(q===0){r.success(l);}}.bind(this),failure:function(t){r.failure(t);}});},getObjectInfo:function Q(l,m){this.throwAbstractMethodError("getObjectInfo");},getUserServices:function H(l,m){this.throwAbstractMethodError("getUserServices");},saveObjectACL:function P(l,m){this.throwAbstractMethodError("saveObjectACL");},getUserEntityInfo:function X(l,m){this.throwAbstractMethodError("getUserEntityInfo");},isCurrentProject:function j(m,l){this.throwAbstractMethodError("isCurrentProject");},getCleanDocModel:function g(l){this.throwAbstractMethodError("getCleanModel");},getDefaultPort:function W(l){return l==="https:"?443:80;},parseServerURL:function f(n){var t=document.createElement("a"),m="j2ee",o="asp";t.href=n;var q={};if(t.protocol!=="http:"&&t.protocol!=="https:"){t.href="http://"+n;}t.search.substr(1).split("&").forEach(function(v){var u=v.split("=");if(u.length===2){q[u[0].toLowerCase()]=u[1];}});var l=t.pathname.split("/"),r=l.pop(),p=l.splice(1,1)[0];return{url:n,conntp:t.protocol,wsn:t.hostname,wsport:t.port||this.getDefaultPort(t.protocol),wsfolderpath:l.join("/"),wsservlet:r,wspath:p,wstp:r.indexOf(".aspx")===-1?m:o,search:q};}});mstrmojo.onetier.vi.prefs.handleErrorMessage=I;}());(function(){mstrmojo.requiresCls("mstrmojo.css","mstrmojo.Widget","mstrmojo.ui.editors.controls.LinkGroup","mstrmojo.ui.PopupButton","mstrmojo.ui.PopupWidget");var D=mstrmojo.css,H="hidden";function E(){var K=this;this._hideLinkHandler=window.setTimeout(function(){if(!K._disableHide){D.addClass(K.linkBtnNode,H);}},200);}mstrmojo.vi.ui.rw._IsLinkBox=mstrmojo.provide("mstrmojo.vi.ui.rw._IsLinkBox",{_mixinName:"mstrmojo.vi.ui.rw._IsLinkBox",linkBtnNode:null,linkMenuCfg:null,init:function(L){if(this._super){this._super(L);}if(mstrApp.isDossier){return ;}var M=this,O=this.boxContent,K=this.model;this.linkMenuCfg=new mstrmojo.ui.PopupButton({cssDisplay:"",cssClass:H,isHostedWithin:false,anchorSlot:"domNode",alias:"linkMenu",markupString:'<div id="{@id}" class="hover-link-btn {@cssClass}" style="{@cssText}" mstrAttach:click></div>',markupSlots:{btnNode:function(){return this.domNode.firstChild;}},markupMethods:{onvisibleChange:mstrmojo.Widget.visibleMarkupMethod},postBuildRendering:function(){if(this._super){this._super();}M.linkBtnNode=this.domNode;},getPopupWidget:function N(){return this.linkPopup;},children:[{scriptClass:"mstrmojo.ui.editors.controls.LinkGroup",alias:"linkPopup",cssClass:"link-selection-editor "+mstrApp.getThemeClassName(),docModel:K,hostId:O.id,visible:false,onOpenCallback:function(){M._disableHide=true;},onCloseCallback:function(){M._disableHide=false;E.call(M);},postBuildRendering:function(){this.constructor.prototype.postBuildRendering.call(this);if(!this.popupConfig){this.popupConfig=this.parent.getPopupConfig();}}}]});this.addChildren([this.linkMenuCfg]);this._targetNameChangeListener=K.attachEventListener("ontitleChange",this.id,function(P){var Q=O&&O.node&&O.node.data;if(Q&&Q.navpage===P.panelKey){Q.navpagenm=P.newTitle;}});},destroy:function F(){if(this._targetNameChangeListener){this.model.detachEventListener(this._targetNameChangeListener);}this.linkMenuCfg=null;if(this._super){this._super();}},updateToolbar:function J(K){var L=this,M;if(this._super){K=this._super(K);}if(!mstrApp.isAppStatePresentation()){M=this.boxContent.hasActiveLink()?mstrmojo.desc(15703,"Edit Link..."):mstrmojo.desc(15702,"Link...");K.addMenuItem(M,"lnk",function(){var N=L.linkBtnNode;D.removeClass(N,H);N.click();});}return K;},addContextMenuItems:function B(K){return this.updateToolbar(K);},onmouseover:function I(K){if(!this._disableShow){this._super(K);if(this.boxContent.hasActiveLink()&&!mstrApp.isAppStatePresentation()){window.clearTimeout(this._hideLinkHandler);D.removeClass(this.linkBtnNode,H);}}},onmouseout:function G(K){this._super(K);E.call(this);},hideLinkButton:function A(){this.onmouseout();this._disableShow=true;},unhideLinkButton:function C(){this._disableShow=false;}});}());(function(){mstrmojo.requiresCls("mstrmojo.css","mstrmojo.hash","mstrmojo.ui.PopupButton","mstrmojo.ui.PulldownCheckList");var G=mstrmojo.css,D=mstrmojo.hash,E={0:true};function B(){var O=this.selectedIndices=D.copy(this.getPopupList().selectedIndices),K=this.items,N=[],M=this.allIdx,L=this.noneIdx;if(K){if(O[M]){N.push(K[M].n);}else{if(O[L]){N.push(K[L].n);}else{mstrmojo.array.forEach(K,function(Q,P){if(O[P]){N.push(Q.n);}});}}}this.set("value",N.join(", "));}mstrmojo.ui.MultiSelectPulldown=mstrmojo.declare(mstrmojo.ui.PopupButton,[mstrmojo.ui._IsPulldown],{scriptClass:"mstrmojo.ui.MultiSelectPulldown",isHostedWithin:false,popupWidget:undefined,init:function J(K){this._super(K);G.addWidgetCssClass(this,"multi");this.hostedCSSClass=this.hostedCSSClass+" multi";},submitSelections:function A(){B.call(this);this.onchange();},_set_selectedIndices:function F(M,K){var L=this.selectedIndices=D.copy(K||this.selectedIndices||E);this.getPopupList().set("selectedIndices",L);B.call(this);return true;},select:function H(K){this.getPopupList().select(K);},getPopupWidget:function C(){return this.popupWidget;},getPopupList:function I(){return this.popupWidget.list;},children:[{scriptClass:"mstrmojo.ui.PulldownCheckList",alias:"popupWidget",useRichTooltip:true,showTooltipForLargeText:true}]});}());(function(){mstrmojo.requiresCls("mstrmojo.array","mstrmojo.hash","mstrmojo.Label","mstrmojo.mstr.EnumDSSXMLObjectTypes","mstrmojo.ui.PulldownCheckList");var G=mstrmojo.array,A=mstrmojo.hash,D=mstrmojo.mstr.EnumDSSXMLObjectTypes.Dimension;mstrmojo.ui.SearchablePulldownCheckList=mstrmojo.declare(mstrmojo.ui.PulldownCheckList,null,{scriptClass:"mstrmojo.ui.SearchablePulldownCheckList",_changeList:null,useRichTooltip:true,showTooltipForLargeText:true,children:[{scriptClass:"mstrmojo.Label",alias:"noResults",cssClass:"nores",text:mstrmojo.desc(15559,"No result matches your search.")}].concat(mstrmojo.ui.PulldownCheckList.prototype.children),onOpen:function B(){var L=this.parent;if(this._super){this._super();}this._changeList=A.copy(L.selectedIndices);},onClose:function I(L){if(this._super){this._super(L);}this._changeList=null;},showTooltip:function J(L,N){var M=L.target||mstrmojo.dom.eventTarget(L.hWin,L.e);M=this.getItemNodeFromTarget(M);if(M){L=A.copy(L);L.srcElement=M;}this._super(L,N);},saveSelection:function C(){this.toggleCacheMode(true);this.parent.set("selectedIndices",A.copy(this._changeList));this.toggleCacheMode(false);},getChanges:function F(){return this._changeList;},onclearSelection:function(){var Q=this.list,O=this._changeList,M=Q.selectedIndices,P=this.parent.items,N=Q.items,L;if(A.isEmpty(M)){M={};A.forEach(O,function(S,R){if(S){L=G.find(N,"v",P[R].v);if(L>=0){M[L]=O[R];}}});Q.selectedIndices=M;}},onvisibleChange:function(){this.list.set("visible",this.visible);},postselectionChange:function E(W){if(this._super){this._super(W);}if(this._restoreSelection){delete this._restoreSelection;return ;}var P=this.parent.items,R=this.list.items,O=(P.length===R.length),S=W.added||[],N=W.removed||[],V=this._changeList,L=this.parent.allIdx,Q=R[L],U,M=function(){G.forEach(S,function(X){U=G.find(P,"v",R[X].v);V[U]=true;});G.forEach(N,function(X){U=G.find(P,"v",R[X].v);delete V[U];});};if(!V){return ;}if(Q&&(Q.t===D)){if(L===S[0]){G.forEach(R,function(X){if(X.t!==D||O){U=G.find(P,"v",X.v);if(U!==-1&&!V[U]){V[U]=true;}}});return ;}if(L===N[0]){G.forEach(R,function(X){U=G.find(P,"v",X.v);if(U!==-1&&V[U]){delete V[U];}});return ;}}if(V[L]){delete V[L];}M();},onitemsChange:function K(){var L=this.list.items;this.noResults.set("visible",L&&L.length===0);},toggleCacheMode:function H(L){this._restoreSelection=L;}});}());(function(){mstrmojo.requiresCls("mstrmojo.ui.editors.controls.AdvancedColorPicker","mstrmojo._IsPopup","mstrmojo._CanAutoClose","mstrmojo.hash","mstrmojo.css");var A=mstrmojo.hash.copy;mstrmojo.ui.editors.controls.AdvancedColorPickerPopup=mstrmojo.declare(mstrmojo.ui.editors.controls.AdvancedColorPicker,[mstrmojo._IsPopup,mstrmojo._CanAutoClose],{scriptClass:"mstrmojo.ui.editors.controls.AdvancedColorPickerPopup",locksHover:true,init:function E(F){this._super(F);mstrmojo.css.addWidgetCssClass(this,"mstrmojo-ui-AdvColorPickerPopup");},showPickerForCurrentMode:function D(){this._super();var G=this,F=function F(){if(G.visible){G.adjustCornersForPopupOverflow();}};if(this.pickerMode===2){this.colorStyle.markupMethods=A({onselectedIndexChange:F},A(this.colorStyle.markupMethods));}F();},onOpen:function C(){var F=this.parent;this.set("color",F?F.selectedValue:this.color);this.renderContent();this._super();},colorCanceled:function B(){this.close();}});}());(function(){mstrmojo.requiresCls("mstrmojo.css","mstrmojo.array","mstrmojo.num","mstrmojo.dom","mstrmojo.date","mstrmojo.Container","mstrmojo.VBox","mstrmojo.Button","mstrmojo.locales","mstrmojo._FormatDefinition","mstrmojo.mstr.EnumFunction","mstrmojo.ui.editors.controls.ComboBox","mstrmojo.vi.util.NumberFormatUtility");var M=mstrmojo.hash,c=mstrmojo.array,G=mstrmojo.num,J=mstrmojo._FormatDefinition,B=mstrmojo.css,a=mstrmojo.mstr.EnumFunction,L=mstrmojo.locales,H=mstrmojo.Button.newIconButton,O=mstrmojo.date,I=mstrmojo.vi.util.NumberFormatUtility,t="1234.12",E=J.NumberFormatCategory,q=J.FixedNegative,F=J.CurrencyNegative,f=J.PercentNegative,K=J.DefaultFormat.FormattingNumber,o="nf-MiddleRow ",X="nf-MiddleRow nf-HasWidget ",Z,U,e=function e(v,u){return{cls:this.value===v.v?"selected":"",v:v.v||"",n:v.n||"",style:v.r?"color:red;":"color:#fff;",sel:parseInt(this.idx,10)===u?"selected":""};},p={RIGHT:1,LEFT_WITH_SPACE:2,RIGHT_WITH_SPACE:3};var S=[{n:mstrmojo.desc(4531,"Automatic"),v:-3}].concat(J.Category.slice(2)),d=[{n:"$"},{n:"£"},{n:"€"},{n:"¥"},{n:"fr."}];function D(w,v){var u=c.find(w,"v",v);return u===-1?"":w[u].f;}function N(u){var w=this.parent.parent.parent.myData,v=u.v;w.set("format",D(this.items,v));w.set("negativeNumbers",v);B.toggleClass(this.selectedNode,"red",u.r);}function Y(w,x,u){return{scriptClass:"mstrmojo.ui.Pulldown",isHostedWithin:false,items:w,onitemSelected:function v(z){var AA=this.parent;while(AA&&(!AA.data||typeof AA.data[x]==="undefined")){AA=AA.parent;}if(AA){AA.data.set(x,z.v);if(u){AA.children[0].preview.preview_label.set("text",z.n);}}}};}function j(AF,AA,z,AI,AE){var AH=M.clone(AF),v=AA>0?L.number.DECIMALSEPARATOR:"",w=AA>0?".":"",x=J.DefaultFormat.FormattingNumber,AG=new RegExp("\\"+L.number.THOUSANDSEPARATOR,"g"),u=new RegExp("\\"+L.number.DECIMALSEPARATOR+"\\d{2}","g"),AC;for(AC=0;AC<AA;AC++){v+=AC%9;w+="0";}for(AC=0;AC<AH.length;AC++){var AD=AH[AC];AD.n=AD.n.replace(/,/g,"@");AD.n=AD.n.replace(/\./g,L.number.DECIMALSEPARATOR);AD.n=AD.n.replace(/@/g,L.number.THOUSANDSEPARATOR);if(z){AD.n=AD.n.replace(AG,"");AD.f=AD.f.replace(/,/g,"");}if(AI&&AI!==x.CurrencyPosition){switch(AI){case p.RIGHT:AD.n=AD.n.replace(/\$/g,"").replace(u,L.number.DECIMALSEPARATOR+"12$");AD.f=AD.f.replace(/"\$"/g,"").replace(/\.\d{2}/g,'.00"$"');break;case p.LEFT_WITH_SPACE:AD.n=AD.n.replace(/\$/g,"$ ");AD.f=AD.f.replace(/\$/g,"$ ");break;case p.RIGHT_WITH_SPACE:AD.n=AD.n.replace(/\$/g,"").replace(u,L.number.DECIMALSEPARATOR+"12 $");AD.f=AD.f.replace(/"\$"/g,"").replace(/\.\d{2}/g,'.00" $"');break;default:}}AD.n=AD.n.replace(u,v);AD.f=AD.f.replace(/\.\d{2}/g,w);if(AE&&AE!==x.CurrencySymbol){var AB=AE.replace(/\$/g,"$$$$");AD.n=AD.n.replace(/\$/g,AB);AD.f=AD.f.replace(/\$/g,AB);}AD.cls=AD.r?"red":null;}return AH;}function V(x){var u="1"+(x>0?".":"").toString(),z="0"+(x>0?".":"").toString(),w;for(w=0;w<x;w++){u+=w%10;z+="0";}return[u+"E+03",z+"E+0#"];}function R(AI,AK){var AC="\u00A4",AG=/"[^"]*"/g,w=AI.match(AG),AL="\u0091",AH=/\[[^\]]*\]/g,u=AI.match(AH),AF,AJ;AF=AI.replace(AG,AC);AF=AF.replace(AH,AL);var z=AI.indexOf("."),AE=G.getDecimalLength(AI),AB=Math.max(0,AE+AK),x=AI.match(/\d(?!((\d)|(,\d)))/g),v=z!==-1?AI.charAt(z-1):x&&x[0],AD=(v||"0")+(AB>0?".":"").toString();for(var AA=0;AA<AB;AA++){AD+="0";}AF=AF.replace(AE===0?/\d(?!((\d)|(,\d)))/g:/\d\.\d+/g,AD);AF=AF.split(AC);AJ=AF[0];c.forEach(w,function(AN,AM){AJ+=AN+AF[AM+1];});AF=AJ.split(AL);AJ=AF[0];c.forEach(u,function(AN,AM){AJ+=AN+AF[AM+1];});return AJ;}function P(AC,u,AB,AA,w,v){var z=AC.parent.parent.parent,x=j(u,AB.decimalPlaces,AA,w,v);AB.set("format",D(x,AB.negativeNumbers.toString()));AC.set("items",x);AC.set("selectedIndex",c.find(x,"v",AB.negativeNumbers.toString()));z.preview.preview_label.set("text",I.applyFormatToNumber(z.myData.format,t.replace(/\./g,L.number.DECIMALSEPARATOR)));}function m(){var AD=this.parent.parent,AH=AD.myData,x=AD.formatterContainer,v=S[AD.categoryPicker.selectedIndex].v,AK=this.funcType===a.FunctionLeftStr?1:-1,AA=null,AC=null,z=false,AJ=0,AE=null,w=false,AG;switch(v){case E.Fixed:AA=x.fixed_hBox.negativeDDL;AC=q;z=!AH.thousandSeparator;break;case E.Currency:AA=x.currency_hBox2.negativeDDL;AC=F;AJ=AH.currencyPosition;AE=AH.currencySymbol;break;case E.Percentage:AA=x.percentage_hBox.negativeDDL;AC=f;break;case E.Scientific:w=true;break;case E.Custom:AG=true;break;default:return ;}if(AG){var AI=R(AH.format,AK);AD.preview.preview_label.set("text",I.applyFormatToNumber(AI,t.replace(".",L.number.DECIMALSEPARATOR)));AD.formatterContainer.custom_text.set("value",AI);return ;}var AB=AH.decimalPlaces,u=AB+AK;u=Math.max(0,u);u=Math.min(J.MaxNegativeDidigts,u);AH.set("decimalPlaces",u);if(w){var AF=V(u);AH.set("format",AF[1]);AD.preview.preview_label.set("text",AF[0]);}else{P(AA,AC,AH,z,AJ,AE);}}function r(u,v){return Math.max(c.find(u,"v",v),0);}function C(w){var v=this.parent.parent.categoryPicker,u=S.map(function(x){return x.v;}).indexOf(w);v.set("selectedIndex",u);}function n(u,v,x,w){return H(undefined,u,v,undefined,M.copy(w,{useRichTooltip:true,updateTooltipConfig:function(){this.richTooltip={cssClass:"vi-regular vi-tooltip-A A-center",content:x,refNode:this.domNode,posType:mstrmojo.tooltip.POS_TOPCENTER,left:15,top:33};}}));}function b(){if(mstrApp.isSingleTier&&!mstrmojo.dom.isMac()){var AA=this.formatterContainer,z=L.datetime,u={day:7,month:4,year:1998},w={hour:9,min:41,sec:46},x=z&&z.DATEINPUTFORMATS,v=z&&z.TIMEINPUTFORMATS;Z=[];U=[];x.forEach(function(AB){Z.push({v:AB,n:O.formatDateInfo(u,AB)});});v.forEach(function(AB){U.push({v:AB,n:O.formatTimeInfo(w,AB)});});AA.date_ddl.set("items",Z);AA.time_ddl.set("items",U);}else{Z=J.Date;U=J.Time;}}mstrmojo.vi.ui.NumberFormatter=mstrmojo.declare(mstrmojo.VBox,null,{scriptClass:"mstrmojo.vi.ui.NumberFormatter",cssClass:"NumberFormatter-content",formatValue:null,myData:null,oldData:null,categoryPicker:null,formatterContainer:null,preview:null,shortcutRow:null,adjustAfterCategoryChange:mstrmojo.emptyFn,preBuildRendering:function(){if(this._super){this._super();}b.call(this);var u=this.formatterContainer;if(this.formatValue){u.currency_hBox1.currency_symbol.selectedValue=this.formatValue.currencySymbol;u.fixed_btn.checked=!!this.formatValue.thousandSeparator;B.addWidgetCssClass(u.fraction_ddl,f[c.find(f,"v",this.formatValue.negativeNumbers)].r?" red":"");}},postBuildRendering:function Q(){if(this._super){this._super();}if(this.formatValue){this.categoryPicker.set("selectedIndex",r(this.categoryPicker.items,this.formatValue.category.toString()));}},children:[M.copy({alias:"categoryPicker",cssClass:"nf-category",onitemSelected:function l(AI){if(!this.hasRendered){return ;}var AD=this,AG=AD.parent,x=AG.formatterContainer,u=AG.shortcutRow,AH=AG.preview.preview_label,AF=AI.v,AA=AF===E.Automatic,w=AF===E.Scientific,v=[],AC=AG.myData;c.forEach(x.children,function(AJ){AJ.set("visible",false);});AG.border.set("visible",!AA);AG.preview.set("visible",!AA);AG.borderBottom.set("visible",!(!mstrApp.isWSStyling||AA||w));["border","moveLeftBtn","moveRightBtn"].forEach(function(AJ){u[AJ].set("visible",!AA);});AC.set("category",AF);AC.set("thousandSeparator",AF?K.ThousandSeparator:AG.formatValue.thousandSeparator);switch(AF){case E.Currency:P(x.currency_hBox2.negativeDDL,F,AC,false,AC.currencyPosition,AC.currencySymbol);x.currency_hBox1.currency_position.set("selectedIndex",r(J.CurrencyPosition,AC.currencyPosition.toString()));v=["currency_hBox1","currency_hBox2"];break;case E.Date:x.date_ddl.set("selectedIndex",r(Z,AC.format));v=["date_ddl"];break;case E.Time:x.time_ddl.set("selectedIndex",r(U,AC.format));v=["time_ddl"];break;case E.Percentage:P(x.percentage_hBox.negativeDDL,f,AC,false,0,null);v=["percentage_hBox"];break;case E.Fraction:x.fraction_ddl.set("selectedIndex",r(J.Fraction,AC.format));v=["fraction_ddl"];break;case E.Scientific:var AB=V(AC.decimalPlaces||0);AC.set("format",AB[1]);AH.set("text",AB[0]);break;case E.Custom:var z=AC.customText||AC.format,AE=x.custom_text;AC.set("format",z);AE.value=z;AE.refresh();AH.set("text",I.applyFormatToNumber(z,t.replace(".",L.number.DECIMALSEPARATOR)));v=["custom_condense","custom_text"];break;case E.Fixed:P(x.fixed_hBox.negativeDDL,q,AC,!AC.thousandSeparator,0,null);v=["fixed_hBox","fixed_btn"];break;}c.forEach(v,function(AJ){x[AJ].set("visible",true);});AG.adjustAfterCategoryChange();}},Y(S,"category")),{scriptClass:"mstrmojo.Box",cssClass:o+"nf-shortcut",alias:"shortcutRow",border:null,moveLeftBtn:null,moveRightBtn:null,children:[n("nf-shortcut-currency",function h(){C.call(this,E.Currency);},mstrmojo.desc(2051,"Currency"),undefined),n("nf-shortcut-percentage",function h(){C.call(this,E.Percentage);},mstrmojo.desc(2053,"Percentage"),undefined),n("nf-shortcut-fixed",function h(){C.call(this,E.Fixed);this.parent.parent.formatterContainer.fixed_btn.set("checked",true);},mstrmojo.desc(2050,"Fixed"),undefined),{scriptClass:"mstrmojo.Label",cssClass:"shortcut-border",alias:"border"},n("nf-MoveDecimalPoint left",function h(){m.call(this);},mstrmojo.desc(2189,"Increase Decimal"),{funcType:a.FunctionLeftStr,alias:"moveLeftBtn"}),n("nf-MoveDecimalPoint right",function h(){m.call(this);},mstrmojo.desc(2188,"Decrease Decimal"),{funcType:a.FunctionRightStr,alias:"moveRightBtn"})]},{scriptClass:"mstrmojo.Label",alias:"border",cssClass:"nf-border"},{scriptClass:"mstrmojo.Container",alias:"formatterContainer",cssClass:"nf-buttons",markupString:'<div id="{@id}" class="{@cssClass}" style="{@cssText}"></div>',fixed_hBox:null,fixed_btn:null,currency_hBox1:null,currency_hBox2:null,date_ddl:null,time_ddl:null,percentage_hBox:null,fraction_ddl:null,custom_condense:null,custom_text:null,markupSlots:{containerNode:function W(){return this.domNode;}},children:[{scriptClass:"mstrmojo.HBox",alias:"fixed_hBox",cssClass:X,negativeDDL:null,children:[{scriptClass:"mstrmojo.Label",cssClass:"negative-label",text:mstrmojo.desc(13891,"Negative:")},M.copy({alias:"negativeDDL",cssClass:"nf-NegativePullDown",getOptionProps:e,onitemSelected:function l(u){N.call(this,u);}},Y([],"format"))]},{scriptClass:"mstrmojo.CheckBox",alias:"fixed_btn",cssClass:o,label:"",onclick:function h(){var u=this.parent.parent;u.myData.set("thousandSeparator",this.checked?-1:0);P(this.parent.fixed_hBox.negativeDDL,q,u.myData,!this.checked,0,null);},preBuildRendering:function A(){this.set("label",mstrmojo.desc(13898,"Use 1000 Separator(#)").replace("#",L.number.THOUSANDSEPARATOR));}},{scriptClass:"mstrmojo.HBox",alias:"currency_hBox1",cssClass:X,visible:true,currency_symbol:null,currency_position:null,children:[{scriptClass:"mstrmojo.ui.editors.controls.ComboBox",alias:"currency_symbol",cssClass:"nf-CurrencySymbol",selectedValue:"$",items:d,postselectedValueChange:function k(u){var z=this,x=z.parent.parent.parent,w=u.value,v=x.myData;v.set("currencySymbol",w);P(this.parent.parent.currency_hBox2.negativeDDL,F,v,false,parseInt(v.currencyPosition,10),w);}},M.copy({cssClass:"nf-CurrencyPosition align-right",alias:"currency_position",onitemSelected:function l(u){var x=this,w=x.parent.parent.parent,v=u.v;w.myData.set("currencyPosition",parseInt(v,10));P(this.parent.parent.currency_hBox2.negativeDDL,F,w.myData,false,parseInt(v,10),w.myData.currencySymbol);}},Y(J.CurrencyPosition,"currencyPosition"))]},{scriptClass:"mstrmojo.HBox",alias:"currency_hBox2",cssClass:X,negativeDDL:null,children:[{scriptClass:"mstrmojo.Label",cssClass:"negative-label",text:mstrmojo.desc(13891,"Negative:")},M.copy({alias:"negativeDDL",cssClass:"nf-NegativePullDown",getOptionProps:e,onitemSelected:function l(u){N.call(this,u);}},Y([],"format"))]},M.copy({alias:"date_ddl",cssClass:X},Y(J.Date,"format",true)),M.copy({alias:"time_ddl",cssClass:X},Y(J.Time,"format",true)),{scriptClass:"mstrmojo.HBox",alias:"percentage_hBox",cssClass:X,negativeDDL:null,children:[{scriptClass:"mstrmojo.Label",cssClass:"negative-label",text:mstrmojo.desc(13891,"Negative:")},M.copy({alias:"negativeDDL",cssClass:"nf-NegativePullDown",getOptionProps:e,onitemSelected:function l(u){N.call(this,u);}},Y([],"format"))]},M.copy({alias:"fraction_ddl",cssClass:X},Y(J.Fraction,"format",true)),mstrmojo.Button.newWebButton(mstrmojo.desc(13893,"Condense (e.g.10M)"),function(){this.parent.custom_text.set("value",'[>=1000000]#,##0,,"M";[>=1000]#,##0,"K";0;[<=-1000000]#,##0,,"M";[<=-1000]#,##0,"K"');},false,{cssClass:"nf-condense",alias:"custom_condense"}),{scriptClass:"mstrmojo.TextBox",alias:"custom_text",cssClass:"nf-custom",onvalueChange:function g(){var w=this,v=w.parent.parent,u=w.value;v.myData.set("format",u);v.myData.set("customText",u);w.parent.parent.preview.preview_label.set("text",I.applyFormatToNumber(u,t.replace(".",L.number.DECIMALSEPARATOR)).replace(/\s/g,"&nbsp;"));}}]},{scriptClass:"mstrmojo.Label",alias:"borderBottom",cssClass:"nf-border"},{scriptClass:"mstrmojo.HBox",alias:"preview",cssClass:o+"nf-PreviewRow",preview_label:null,children:[{scriptClass:"mstrmojo.Label",cssClass:"preview_lable",text:mstrmojo.desc(13892,"Preview:")},{scriptClass:"mstrmojo.Label",cssClass:"align-right preview-info-label",alias:"preview_label"}]}]});}());(function(){mstrmojo.requiresCls("mstrmojo.Box","mstrmojo.HBox","mstrmojo.TextBox","mstrmojo.Button","mstrmojo.css","mstrmojo.vi.ui.ElementsBrowser","mstrmojo.vi.ui.IncHierarchyCheckList","mstrmojo.mstr.EnumDSSXMLObjectTypes");var G=mstrmojo.css,A=mstrmojo.mstr.EnumDSSXMLObjectTypes;var E="36px";mstrmojo.vi.ui.HierarchyElementsCheckListBrowser=mstrmojo.declare(mstrmojo.vi.ui.ElementsBrowser,null,{scriptClass:"mstrmojo.vi.ui.HierarchyElementsCheckListBrowser",children:[{scriptClass:"mstrmojo.HBox",slot:"searchBoxNode",alias:"util",cssClass:"elemsBrowser-utils-bar",children:[{scriptClass:"mstrmojo.Box",cssClass:"eb-box-search",alias:"box",children:[{scriptClass:"mstrmojo.TextBox",alias:"searchBox",hint:"Search",cssClass:"eb-searchBox",onEnter:function B(){var O=this.value,M=this.parent.parent.parent,N=!M.searchPattern&&!O;if(!N){M.set("searchPattern",O);}this.blur();}},{scriptClass:"mstrmojo.Button",cssClass:"eb-searchBox-clear",text:"",onclick:function(){var M=this.parent.searchBox;M.set("value","");M.cleanUp();M.focus();M.onEnter();},bindings:{visible:"(this.parent.searchBox.value || '').length > 0"}},{scriptClass:"mstrmojo.Button",cssClass:"eb-searchBox-search",text:"",onclick:function(){var M=this.parent.searchBox;M.focus();M.onEnter();}}]}]},{scriptClass:"mstrmojo.HBox",slot:"buttonPanelNode",alias:"buttonPanel",cssClass:"elemsBrowser-button-panel"},{scriptClass:"mstrmojo.vi.ui.IncHierarchyCheckList",alias:"elementList",slot:"elementListNode",allowUnlistedValues:false,bindings:{disableLevel:"this.parent.disableLevel"},getDataHelper:function(){return this.parent.ifDataHelper;},getAttribute:function(){return this.parent.attribute;},isHiearachyDisplay:function F(){var M=this.parent;return !M.searchPattern||M.searchPattern==="";},setSelectedItems:function J(M){if(typeof M==="object"){this.setSelectionByExprJSON(M);}},postSelectionChange:function I(){var M=this.getAttribute();if(M){this.parent.onItemsSelectionChange(this.buildSelectionExprJSON(M));}}}],init:function L(M){this._super(M);G.addWidgetCssClass(this,"hierarchy");if(this.disableLevel){G.addWidgetCssClass(this,"disable-level");}},postCreateChildren:function D(){var M=this.elementList;this.util.addChildren(M.getLevelPopupConfig());this.buttonPanel.addChildren([M.getAllButtonConfig(true),M.getAllButtonConfig(false)]);},onattributeChange:function H(M){var N=this.elementList;N.clearItems();this._super(M);},onsearchPatternChange:function C(){var N=this.elementList,M=N.isHiearachyDisplay();this._super();this.buttonPanel.set("visible",M);this.layoutConfig.h.buttonPanelNode=M?E:"0px";this.doLayout();},isObjSearchable:function K(M){return true;},onElementsListchange:mstrmojo.emptyFn,updateClearAllBtnState:mstrmojo.emptyFn,_set_selectedItems:null});}());(function(){mstrmojo.requiresClsP("mstrmojo","Editor","HBox","HTMLButton","Label","SortRow","ButtonSwitch","CheckBox","_HasOwnAvatar","hash");mstrmojo.requiresCls("mstrmojo.ui._HasScroller","mstrmojo.mstr.EnumDSSXMLObjectTypes");mstrmojo.requiresDescs(11591,3095,11592,2968,122,221,1442,12420,13153);var I=mstrmojo.desc,U=mstrmojo.array,Y=mstrmojo.hash,E=mstrmojo.dom,f=mstrmojo.css,L=0,h="top",V="bottom",g;mstrmojo.AdvancedSortData=null;function A(l,k){var m=new mstrmojo.SortRow(),j=mstrmojo.all[g];m.setPulldownOptions(k===L?j.sortData.rows:j.sortData.cols);m.setRank(l.children.length+1);l.addChildren([m]);}function K(j){return j&&j.isAsc===2;}function Q(t,l,p){var n,m,q,k=t.children,o=mstrmojo.all[g],r=function(){var AA,z,x,w,AC,v=(p===L?o.sortData.rows:o.sortData.cols),u=[];for(AA=0,z=l.length;AA<z;AA++){AC=l[AA];if(K(AC)){var AB=AC.value.split("!").slice(0,2).join("!");if(U.some(v,function(j){return AB===j.v.split("!").slice(0,2).join("!");})){u.push(AC);}}else{for(x=0,w=v.length;x<w;x++){if(AC.value===v[x].v){u.push(AC);break;}}}}return u;};if(!o.isDesignMode){l=r();}for(n=0,m=0;n<k.length&&m<l.length;n++,m++){q=l[m];k[n].setSelected(q.value,q.isAsc,q.n);}for(;n<k.length;n++){k[n].setSelected("",1);}for(;m<l.length;m++){q=l[m];A(t,p);k[m].setSelected(q.value,q.isAsc,q.n);}}function J(){var j=this.children;if(j[j.length-1].getSortKey()===""){return ;}A(this,this.type);}function F(){var k,l=this.children;for(k=0;k<l.length;k++){var m=l[k];if(m.getRank()!==k+1){m.setRank(k+1);}}}function M(n,k){var m=this.xtab&&this.xtab.model,j;if(m){var l=((m.data||{}).gsi||{}).sorts;if(l){l=l[n.isRow?0:1]||[];j=U.filterOne(l,function(o){return o.key&&o.key.search(k)==0;});}}return j;}function Z(j){var k=j&&j.split&&j.split("!");return{unitType:k[0],unitId:k[1],axis:k[5]};}function P(){var o,m,l,q=[],t=mstrmojo.all[g],v=["appliedRows","appliedCols"],k=[];k.push(t.tabContainer.children[0].children);k.push(t.tabContainer.children[1].children);for(m=0;m<2;m++){var x=[],n;for(o=0;o<k[m].length;o++){n=k[m][o];l=n.getSortKey();if(l&&l!==" "){if(n.isCustomSort()){var r=M.call(t,n.originalPos,l),z=Y.copy(Z(r.key),{actions:r.actions,isCustomSort:true});x.push(z);}else{x.push({key:l,isAsc:n.isAscending()});}}}if(x.length===0){if(t.sortData[v[m]].length===0){x=null;}}q.push(x);}var w=t.sortData.hierarchicalSort,u=t.hrlSortBox.checked?w.stt:null,p=t.resHrlBox.checked?"1":"0";t.controller.onAdvancedSort(t.xtab,q,null,u,p);}mstrmojo.AdvancedSortEditor=mstrmojo.declare(mstrmojo.Editor,null,{scriptClass:"mstrmojo.AdvancedSortEditor",help:"advanced_sort_editor.htm",cssClass:"mstrmojo-AdvancedSortEditor",title:I(11591,"Advanced Sort"),tabSwitcher:undefined,tabContainer:undefined,hrlSortBox:undefined,sortData:undefined,sourceAxis:1,init:function b(j){this._super(j);g=this.id;},onOpen:function H(){var j=this.sortData,m,p=["appliedRows","appliedCols"],l=this.sourceAxis-1,o=this.xtab,k=this.tabContainer,n=k.children;if(o&&o.isInFilterPanel&&o.isInFilterPanel()&&mstrApp&&mstrApp.isInVFInteractMode){f.addClass(this.domNode,"forVisFilter");}U.forEach(n,function(q,t){m=j[p[t]];U.forEach(q.children,function(u){u.setPulldownOptions(j[t===L?"rows":"cols"]);});Q(q,m,t);var r;U.forEach(q.children,function(v,u){r=v.getSortKey();if(r&&r.trim&&r.trim()){v.originalPos={isRow:t===L,index:u};}});J.call(q);F.call(q);});if(this.sourceType===mstrmojo.mstr.EnumDSSXMLObjectTypes.Metric){l^=1;}this.tabSwitcher.set("selected",l>=n.length?L:l);k.updateScrollbars();this.updateUseHierarchicalSort(l);},onClose:function(){U.forEach(this.tabContainer.children,function(j){U.forEach(j.children,function(k){k.resetPulldownOptions();});});},onTabChange:function(k){var j=this.tabContainer;j.children[k].set("visible",true);j.children[1-k].set("visible",false);j.set("selected",k);j.updateScrollbars();this.updateUseHierarchicalSort(k);},updateUseHierarchicalSort:function S(o){var n=(o===L)?"rows":"cols",u=(o===L)?"appliedRows":"appliedCols",k=this.sortData,r=k.hierarchicalSort,p=r.pref,v=r.rp,m=r.isOutlineMode,q=r.isRA,t=k[u],l=this.hrlSortBox,j=this.resHrlBox;l.set("visible",p==="1");l.set("checked",m||(p==="1"&&(t.length===0||q)));j.set("visible",false);j.set("checked",v);},updateTooltipConfig:function c(){if(E.isIE8){this.richTooltip.cssClass+=" ie8";c.repaint=!!!c.repaint;this.richTooltip.cssClass+=(c.repaint?" repaint":"");}},postBuildRendering:function d(){this._super();this.tabContainer.domNode.onselectstart=function(){return false;};},children:[{scriptClass:"mstrmojo.ButtonSwitch",alias:"tabSwitcher",label1:I(2968,"Rows"),label2:I(122,"Columns"),switchFn:function a(){this.parent.onTabChange(this.selected);}},{scriptClass:"mstrmojo.Widget",markupString:"<div class='rulesTitles'><div>"+I(3095,"Order")+"</div><div>"+I(11592,"Sort by")+"</div></div>"},{scriptClass:"mstrmojo.SortRulesPanelContainer",alias:"tabContainer",cssClass:"mstrmojo-AdvancedSortEditor-RulesPanelContainer"},{scriptClass:"mstrmojo.CheckBox",alias:"hrlSortBox",cssClass:"hrlSortBox",oncheckedChange:function(){if(E.isIE8){f[this.checked?"addClass":"removeClass"](this.labelNode,"checked");}},postBuildRendering:function d(){if(E.isIE8){var k=this,j=this.labelNode;E.attachEvent(j,"click",function(){k.set("checked",!k.checked);});}},label:I(13153,"Sort metrics hierarchically")},{scriptClass:"mstrmojo.CheckBox",alias:"resHrlBox",cssClass:"resHrlBox",oncheckedChange:function(){if(E.isIE8){f[this.checked?"addClass":"removeClass"](this.labelNode,"checked");}},postBuildRendering:function d(){if(E.isIE8){var k=this,j=this.labelNode;E.attachEvent(j,"click",function(){k.set("checked",!k.checked);});}},label:I(12420,"Respect Hierarchy")},{scriptClass:"mstrmojo.Button",slot:"buttonNode",cssClass:"mstrmojo-WebButton Advanced-Sort-Editor-Button",text:I(221,"Cancel"),onclick:function(){mstrmojo.all[g].close();}},{scriptClass:"mstrmojo.Button",slot:"buttonNode",cssClass:"mstrmojo-WebButton Advanced-Sort-Editor-Button",iconClass:"hot",text:I(1442,"OK"),onclick:function(){P();mstrmojo.all[g].close();}}]});function X(l,k){var j=Math.floor((l-k.y0-E.getVerticalScroll())/k.h);if(j<0){j=0;}else{if(j>=this.children.length){j=this.children.length-1;}}return j;}function B(n,l){var k=h,m=(Math.floor(n-l.y0)%l.h)/l.h,j=X.call(this,n,l);if(j===this.children.length-1){if(m>0.5||Math.floor((n-l.y0)/l.h)>j){k=V;}}else{if(m>0.5){if(j<this.children.length-1){j+=1;}}}return{edge:k,idx:j};}mstrmojo.SortRulesPanelContainer=mstrmojo.declare(mstrmojo.Box,[mstrmojo.ui._HasScroller],{scriptClass:"mstrmojo.SortRulesPanelContainer",selected:undefined,setupScrollNodes:function O(){var j=this.children[this.selected||0];this.scrollNode=j.domNode;if(!j.hasEventListener){f.addClass(this.scrollNode,"mstrmojo-scrollNode");E.attachMarkupEvent(this.id,this.scrollNode,"scroll");j.set("hasEventListener",true);}},onscroll:function e(){if(this._super){this._super();}var j;U.forEach(this.children,function(k){if(!j){U.forEach(k.children,function(n){if(!j){var m=n.sortRule.list,l=n.sortOrder.list;if(m.visible){j=m;}else{if(l.visible){j=l;}}}});}});if(j){j.set("visible",false);}},children:[{scriptClass:"mstrmojo.SortRulesPanel",cssClass:"mstrmojo-AdvancedSortEditor-RulesPanel",type:0},{scriptClass:"mstrmojo.SortRulesPanel",cssClass:"mstrmojo-AdvancedSortEditor-RulesPanel",type:1}]});mstrmojo.SortRulesPanel=mstrmojo.declare(mstrmojo.Box,[mstrmojo._HasOwnAvatar],{scriptClass:"mstrmojo.SortRulesPanel",dropZone:true,draggable:true,avatarCssClass:"sort-rule-drag-avatar",type:undefined,hasEventListener:undefined,getDragData:function D(){return{};},createAvatar:function W(m,l){var n=l.src.data,k,j;n.y0=E.position(this.domNode).y;n.h=E.position(this.children[0].domNode).h;n.left=E.position(this.children[0].domNode).x;k=X.call(this,l.src.pos.y,n);j=this.children[k].domNode.cloneNode(true);n.index=k;n.node=this.children[k];if(mstrApp.getThemeClassName){f.addClass(j,mstrApp.getThemeClassName());}return j;},positionAvatar:function N(k,j){k.x=j.src.data.left+10;this._super(k,j);},isDragValid:function C(j){if(this.children.length===1){return false;}var k=this.domNode,m=this.children[Math.floor((j.src.pos.y-E.position(k).y-E.getVerticalScroll())/E.position(this.children[0].domNode).h)],l=j.src.e.target;return !(E.contains(m.sortRule.domNode,l,true,k)||E.contains(m.sortOrder.domNode,l,true,k));},ondragstart:function(j){this._super(j);var k=j.src.data;this.removeChildren(this.children[k.index]);k.y0=E.position(this.domNode).y;},ondragmove:function R(j){var p=j.src.data,q=j.last.y,o=p.tgtIdx,m=p.tgtEdge,n=B.call(this,q,p),l=n.idx,k=n.edge;if(o!==l||m!==k){if(o!==undefined){f.removeClass(this.children[o].domNode,m);}f.addClass(this.children[l].domNode,k);p.tgtIdx=l;p.tgtEdge=k;}this._super(j);},ondragend:function G(k){var l=k.src.data,j=l.tgtIdx;if(j!==undefined){f.removeClass(this.children[j].domNode,l.tgtEdge);}if(l.tgtEdge===V){j++;}this.addChildren([l.node],j);this.updatePanel();this._super(k);},pulldownActive:function(j){mstrmojo.css.toggleClass(mstrmojo.all[g].tabContainer.domNode,"disableScroller",j);},updatePanel:function(){F.call(this);J.call(this);mstrmojo.all[g].tabContainer.updateScrollbars();},deleteSortRule:function(j){this.removeChildren(j);this.updatePanel();},itemSelected:function(){this.updatePanel();},children:[{scriptClass:"mstrmojo.SortRow"},{scriptClass:"mstrmojo.SortRow"},{scriptClass:"mstrmojo.SortRow"}]});}());(function(){mstrmojo.requiresCls("mstrmojo.Box","mstrmojo.desc","mstrmojo.vi.ui.NumberFormatter");var B=mstrmojo.desc;mstrmojo.vi.ui.NumberFormatterEditor=mstrmojo.declare(mstrmojo.Box,null,{scriptClass:"mstrmojo.vi.ui.NumberFormatterEditor",onSubmenuOpen:function A(){},myData:null,oldData:null,formatValue:null,onOK:mstrmojo.emptyFn,children:[{scriptClass:"mstrmojo.vi.ui.NumberFormatter",bindings:{myData:"this.parent.myData",oldData:"this.parent.oldData",formatValue:"this.parent.formatValue"}},{scriptClass:"mstrmojo.Box",cssClass:"mstrmojo-subtotals-button",children:[{scriptClass:"mstrmojo.Button",text:B(221,"Cancel"),onclick:function(){this.parent.parent.onSubmenuClosed();}},{scriptClass:"mstrmojo.Button",text:B(1442,"OK"),onclick:function(){var C=this.parent.parent,D=C.xtab;C.onSubmenuClosed();this.parent.parent.onOk();}}]}]});}());(function(){mstrmojo.requiresCls("mstrmojo.ui.editors.controls.PreviewButton","mstrmojo.ui.editors.controls.AdvancedColorPicker","mstrmojo.ui.editors.controls.AdvancedColorPickerPopup","mstrmojo.css");var G=mstrmojo.css,F=Math.round;function J(O){var P=this.previewNode,N=P.clientWidth,R=P.clientHeight,Q=P.offsetWidth-N,S=Math.sqrt(N*N+R*R)-Q/2,M=Math.atan2(R,N)*(-180)/Math.PI;P.style.backgroundColor="#FFFFFF";O.display="block";O.top=F((P.offsetHeight+Q)/2)+"px";O.left=F((N-S+Q)/2)+P.offsetLeft+"px";O.width=F(S)+"px";O[mstrmojo.dom.CSS3_TRANSFORM]="rotate("+F(M)+"deg)";}mstrmojo.ui.editors.controls.ColorPickerButton=mstrmojo.declare(mstrmojo.ui.editors.controls.PreviewButton,null,{scriptClass:"mstrmojo.ui.editors.controls.ColorPickerButton",markupMethods:{onvisibleChange:mstrmojo.Widget.visibleMarkupMethod,onselectedValueChange:function(){this.updatePreview();this.colorPicker.set("color",this.selectedValue);},onautoPreviewColorChange:function D(){this.getPopupWidget().set("autoPreviewColor",this.autoPreviewColor);this.updatePreview();},onenabledChange:function H(){G.toggleClass(this.domNode,"disabled",!this.enabled);}},isHostedWithin:false,showGradient:false,showNoFill:true,showAutomatic:false,autoPreviewColor:null,selectedValue:null,init:function L(N){this._super(N);var M=this.colorPicker;M.showGradient=this.showGradient;if(this.showNoFill!==undefined){M.showNoFill=this.showNoFill;M.showAutomatic=this.showAutomatic;}M.showAutomatic=this.showAutomatic;G.addWidgetCssClass(this,"mstrmojo-ColorPickerBtn");},preBuildRendering:function K(){this.colorPicker.showNoFill=this.showNoFill;return this._super();},setDimensions:function I(N,M){this._super(N,M);window.setTimeout(function(){this.updatePreview();}.bind(this),0);},afterLayout:function C(){var M=this.previewNode,N=M.style,P=N.width,O=M.offsetWidth;if(O>0){N.width=(O-4)+"px";}else{if(P!==""){N.width=(parseInt(P,10)-4)+"px";}}if(N.height===""){N.height=(M.offsetHeight-4)+"px";}},postBuildRendering:function A(){var M=this.noFillNode=document.createElement("div");M.style.display="none";M.className="slash";this.domNode.firstChild.appendChild(M);this._super();},updatePreview:function B(){var Q=this.previewNode;if(Q){var O=this.selectedValue===mstrmojo.ui.editors.controls.AdvancedColorPicker.VAL_AUTOMATIC?this.autoPreviewColor:this.selectedValue;if(O){var R=Q.style;if(O.c1){var S=G.buildGradient(O.or,O.c1,O.c2);if(S&&S.n){R[G.convertCssToCamelCase(S.n)]=S.v;}}else{var M=G.buildGradient(0,"0","0");if(M&&M.n){R[G.convertCssToCamelCase(M.n)]=null;}var P="conflict"===O;G.toggleClass(Q,"conflict",P);R.backgroundColor=!P?O:null;}if(this.showNoFill&&this.noFillNode&&this.enabled){var N=this.noFillNode.style;if("transparent"===O){J.call(this,N);}else{N.display="none";}}}Q.style.backgroundOrigin="border-box";}},getPopupWidget:function E(){return this.colorPicker;},children:[{scriptClass:"mstrmojo.ui.editors.controls.AdvancedColorPickerPopup",alias:"colorPicker",slot:"widgetHostNode",color:this.selectedValue,isHostedWithin:true,colorChanged:function(M){this.parent.set("selectedValue",M);this.close();}}]});}());(function(){mstrmojo.requiresCls("mstrmojo.array","mstrmojo.css","mstrmojo.dom","mstrmojo.hash","mstrmojo.string","mstrmojo.ui.SearchablePulldownCheckList","mstrmojo.ui.SearchablePulldown");var I=mstrmojo.array,K=mstrmojo.css,G=mstrmojo.dom,E=mstrmojo.hash,M=mstrmojo.string,F={0:true};function C(){var V=this.selectedIndices=E.copy(this.getPopupList().selectedIndices),P=this.items,S=[],U,R=this.allIdx,Q=this.noneIdx;if(P&&P.length){if(V[R]){S.push(P[R].n);}else{if(V[Q]){S.push(P[Q].n);}else{I.forEach(P,function(X,W){if(V[W]){S.push(X.n);}});}}}U=S.join(", ");this.set("value",U);this.set("text",U);this.set("richTooltip",{cssClass:"vi-regular vi-tooltip-C",content:M.encodeHtmlString(U)});}mstrmojo.ui.MultiSelectSearchablePulldown=mstrmojo.declare(mstrmojo.ui.SearchablePulldown,[],{scriptClass:"mstrmojo.ui.MultiSelectSearchablePulldown",isHostedWithin:false,init:function O(P){this._super(P);K.addWidgetCssClass(this,"multi");this.hostedCSSClass=this.hostedCSSClass+" multi";},submitSelections:function B(){this.onchange();},_set_selectedIndices:function H(S,Q){var P=this.getPopupList(),R=E.copy(this.selectedIndices);P.set("selectedIndices",Q||R||F);C.call(this);return true;},select:function L(P){this.getPopupList().select(P);},getPopupWidget:function D(){return this.popupWidget;},getPopupList:function N(){return this.popupWidget.list;},getPopupListConfig:function A(){return[{scriptClass:"mstrmojo.ui.SearchablePulldownCheckList",alias:"popupWidget",_unlockHoverCheck:function P(U,Q){var S=G.eventTarget(Q,U),R=this.opener;if(G.contains(R.domNode,S,true,document.body)){R.set("isEditing",true);}else{if(!G.contains(this.domNode,S,true,document.body)){this.close();}}},bindings:{itemCssText:function(){return(this.parent&&this.parent.itemCssText)||"";}}}];},processSearch:function J(){var P=this.getPopupWidget();P.toggleCacheMode(true);if(this._super){this._super();}P.toggleCacheMode(false);}});}());(function(){mstrmojo.requiresCls("mstrmojo.onetier.vi.prefs.DesktopConnectivityProxyBase","mstrmojo.hash");var W=mstrmojo.hash;mstrmojo.onetier.vi.prefs.DesktopConnectivityProxy=mstrmojo.declare(mstrmojo.onetier.vi.prefs.DesktopConnectivityProxyBase,null,{scriptClass:"mstrmojo.onetier.vi.prefs.DesktopConnectivityProxy",showPreferencesEditor:function B(l){window.FormWrapper.showPreferencesEditor(JSON.stringify(l));},savePreferences:function e(l){mstrApp.serverRequest({taskId:"updatePreference",value:l});},getSavedPreferences:function h(l){mstrApp.serverRequest({taskId:"getPreferences"},l);},deleteServerConnections:function G(l){mstrApp.serverRequest({taskId:"deleteServerConnections",value:l});},testServerConnection:function K(l,m){mstrApp.serverRequest(W.copy(l,{taskId:"testServerConnection"}),m);},cancelRequest:function E(m,l){mstrApp.serverRequest({taskId:"cancelRequest",id:m},l,{});},loginToWebserver:function C(m,o,l,n){mstrApp.serverRequest({taskId:"loginToWebserver",wsn:m,username:o,password:l},n,{doNotHold:true});},loginToProxy:function D(p,o,l,m,n){mstrApp.serverRequest({taskId:"loginToProxy",proxyUrl:p,username:o,password:l,saveToPrefs:m},n,{doNotHold:true});},authenticationCancelled:function S(){var l={taskId:"authenticationCancelled"};if(mstrApp.recoveryIndex!=undefined){l.recoveryIndex=mstrApp.recoveryIndex;}mstrApp.serverRequest(l,null,{doNotHold:true});mstrApp.recoveryIndex=undefined;},resumeDashboardExecution:function N(m){var p=m&&m.callback;if(p){delete m.callback;}var o=W.copy(m,{taskId:"resumeDashboardExecution"}),p=W.copy(p,{success:function n(q){if(q&&q.statusOnly!==true){mstrApp.start(q);}},failure:function l(){if(mstrApp.hideWait){mstrApp.hideWait();}}});if(mstrApp.recoveryIndex!=undefined){o.recoveryIndex=mstrApp.recoveryIndex;}mstrApp.serverRequest(o,p,{doNotHold:true});mstrApp.recoveryIndex=undefined;},checkForDesktopUpdates:function a(){window.FormWrapper.runCheckUpdate();},showProxyEditor:function P(){window.FormWrapper.showProxyEditor();},getProjects:function M(l,m){mstrApp.serverRequest(W.copy(l,{taskId:"getProjectsInfo",dataFlag:2}),m,{silent:true});},getSessionState:function Z(n,m,l,o,p){mstrApp.serverRequest({taskId:"getSessionState",connectionId:n,isLoginFirst:false,project:o,server:m,port:l},p);},getLoginFirstSessionState:function f(l,n){var m={taskId:"getSessionState",connectionId:l,isLoginFirst:true};mstrApp.serverRequest(m,n);},login:function U(l,m){mstrApp.serverRequest(W.copy(l,{taskId:"login"}),m,{silent:true,doNotHold:true});},usherLoginWeb:function L(l,m){mstrApp.serverRequest(W.copy(l,{taskId:"usherLoginWeb"}),m,{silent:true,doNotHold:true});},loginFirst:function U(l,m){mstrApp.serverRequest(W.copy(l,{taskId:"loginFirst"}),m,{silent:true,doNotHold:true});},saveToServer:function F(l,m){mstrApp.serverRequest(W.copy(l,{taskId:"desktopImportSaveDashboard"}),m,{silent:true});},loadCube:function b(l,m){mstrApp.serverRequest(W.copy(l,{taskId:"loadCube",keepPolling:"true",maxWait:500}),m,{silent:true});},getCubeInfo:function I(l,m){mstrApp.serverRequest(W.copy(l,{taskId:"checkCube"}),m,{silent:true});},openFromServer:function A(l,m){mstrApp.serverRequest(W.copy(l,{taskId:"exportDocument",executionMode:18,keepPolling:"true",executeDefaultPromptOrFail:"true"}),m,{silent:true});},getPollingStatus:function H(l,m){mstrApp.serverRequest(W.copy(l,{taskId:"getPollingStatus"}),m,{silent:true});},shutDownDesktop:function k(m,l){mstrApp.serverRequest({taskId:"shutDownDesktop",force:!!l},m,{silent:true,doNotHold:true});},refreshNativeDialogMenu:function c(){mstrApp.serverRequest({taskId:"refreshNativeDlgMenu"},{},{silent:true});},sendWebServerRequest:function Y(m,n,l){mstrApp.serverRequest(m,n,l);},saveToPublicCloud:function V(l,m){mstrApp.serverRequest({taskId:"desktopPublishPublicDashboard",sessionState:l},m);},logout:function d(l,m){mstrApp.serverRequest(W.copy(l,{taskId:"logout"}),m);},getPublicCloudSession:function O(l,m){mstrApp.serverRequest(W.copy(l,{taskId:"publicCloudLogin"}),m,{silent:true});},getObjectInfo:function R(l,m){mstrApp.serverRequest(W.copy(l,{taskId:"getObjectInfo"}),m,{silent:true});},getUserServices:function J(l,m){mstrApp.serverRequest(W.copy(l,{taskId:"getUserServices"}),m,{silent:true});},saveObjectACL:function Q(l,m){mstrApp.serverRequest(W.copy(l,{taskId:"saveObjectACL"}),m,{silent:true});},getUserEntityInfo:function X(l,m){mstrApp.serverRequest(W.copy(l,{taskId:"getUserEntityInfo"}),m,{silent:true});},isCurrentProject:function j(m,l){mstrApp.serverRequest({taskId:"IsCurrentProj",pn:m.project.name,sn:m.iServer.name,isp:m.iServer.port},{success:function(n){l.success(!!n.ic);},failure:function(n){mstrmojo.error({longDesc:"Failure on IsCurrentProj task "+JSON.stringify(n||{})},undefined,{zIndex:100000});}},{silent:true});},getCleanDocModel:function g(l){mstrApp.serverRequest({taskId:"createDocInstance"},W.copy({failure:function(m){mstrmojo.error({longDesc:"Failure on createDocInstance task "+JSON.stringify(m||{})},undefined,{zIndex:100000});}},l),{silent:true});}});}());(function(){mstrmojo.requiresCls("mstrmojo.onetier.vi.prefs.DesktopConnectivityProxyBase","mstrmojo.array","mstrmojo.hash","mstrmojo.func");var S=mstrmojo.array,X=mstrmojo.hash,e=mstrmojo.func,K="mstrTestOneTierPreferences",E={};function Y(k){return k&&[k.conntp,"//",k.wsn,k.wsport?(":"+k.wsport):"","/",k.wspath,k.wstp==="j2ee"?"/servlet/taskProc":"/asp/taskProc.aspx"].join("");}function R(l){var k=E[l];if(!k){k=E[l]={};}return k;}mstrmojo.onetier.vi.prefs.HostedDesktopConnectivityProxy=mstrmojo.declare(mstrmojo.onetier.vi.prefs.DesktopConnectivityProxyBase,null,{scriptClass:"mstrmojo.onetier.vi.prefs.HostedDesktopConnectivityProxy",showPreferencesEditor:function B(){mstrApp.executeCommand("showPrefsEditor");},savePreferences:function g(k){this.getSavedPreferences({success:function l(m){sessionStorage.setItem(K,JSON.stringify(X.mergeHashes(m,k)));}});},getSavedPreferences:function j(m){var k={};try{k=JSON.parse(sessionStorage.getItem(K));}catch(l){console.error("Error retrieving the saved preferences (Error: ##).".replace("##",l));}m.success(k);},deleteServerConnections:function G(k){this.getSavedPreferences({success:function l(o){var m=o.server,n=m.conn;k.forEach(function(p){n.splice(n.map(function(q){return q.id;}).indexOf(p),1);});sessionStorage.setItem(K,JSON.stringify(o));}.bind(this)});},testServerConnection:function J(k,l){window.setTimeout(function(){l.success({code:200});},2000);},loginToWebserver:function C(l,n,k,m){window.setTimeout(function(){m.success({code:401,wsn:"localhost"});},500);},loginToProxy:function D(o,n,k,l,m){window.setTimeout(function(){m.success({code:407,proxyUrl:"localhost"});},500);},authenticationCancelled:function U(){console.log("authenticationCancelled");},resumeDashboardExecution:function M(){console.log("resumeDashboardExecution");},checkForDesktopUpdates:function c(){window.alert("Checking for updates: Native code.");},showProxyEditor:function O(){window.alert("Show proxy editor: Native code.");},getSessionState:function b(p,o,l,r,t){var k=R(p),n=k[o]&&k[o][l],q=n&&n[r],m=function m(u,w){var v={taskId:"isSessionAlive",notRestartSessionManager:true,sessionState:u,connectionId:p};this.sendWebServerRequest(v,w);}.bind(this);if(q){m(q.sessionState,{success:function(u){if(u.data===-1){t.failure({statusCode:401});}else{t.success(q);}}});}else{t.failure({statusCode:401});}},getLoginFirstSessionState:function h(m,n){var l=R(m),k=l.loginFirst;if(k){n.success(k);}else{n.failure({statusCode:401});}},getProjects:function L(k,l){this.sendWebServerRequest(X.copy(k,{taskId:"getProjectsInfo",dataFlag:2}),l);},login:function V(k,l){this.sendWebServerRequest(X.copy(k,{taskId:"login"}),e.wrapMethods({success:function(o){var m=R(k.connectionId),n=m[k.server],p;if(!n){n=m[k.server]={};}p=n[k.port];if(!p){p=n[k.port]={};}p[k.project]=o;}.bind(this)},l));},loginFirst:function V(k,l){this.sendWebServerRequest(X.copy(k,{taskId:"loginFirst"}),{success:function(n){var m=R(k.connectionId);if(!m){m={};m.loginFirst={};}m.loginFirst={sessionState:n.sessionState,Uid:k.Uid,Pwd:k.Pwd};l.success(m.loginFirst);}.bind(this),failure:function(m){if(l&&l.failure){l.failure(m);}}});},saveToServer:function F(k,l){l.success({did:"250BFCDB4CA5AF712A36C68E92451AB7",n:"New Dashboard",fdid:"0C77FD3642136F4728D87283759C3CE8",servletPath:"http://was-gespinola:8080/Connectivity/servlet/"});},loadCube:function d(k,l){if(!k.addDatasetToDocument){l.success({did:"D28CB3AB48BCAB8E7D9A2BA4A7C9C2A0"});}else{l.success();}},getCubeInfo:function H(k,l){window.setTimeout(function(){l.success({hsf:false,acld:false,dda:true,cs:111,mmf:2});},100);},openFromServer:function A(k,l){l.success({cubeDLInfo:{maxcs:10,cubes:[{n:"cube1",id:"1234134...1234",dda:1},{n:"cube3",id:"1234134...1234",acld:1},{n:"cube2",id:"234...1234",cs:1500}]}});},getPublicCloudSession:function N(k,l){window.setTimeout(function(){l.success({status:true,message:"",code:0,session:"sessionstate",public_url:"http://was-gespinola:8080/MstrMain/servlet/mstrWeb"});},100);},saveToPublicCloud:function W(k,l){l.success({url:"http://google.com"});},logout:function f(k,l){window.setTimeout(function(){var m=R(k.connectionId),n=m[k.server],o;if(n){n=m[k.server];o=n[k.port];if(o){o=n[k.port];delete m.loginFirst;delete o[k.project];}}l.success();}.bind(this),0);},sendWebServerRequest:function a(l,m){this.getSavedPreferences({success:function k(o){var n="http://localhost:8080/main/servlet/taskProc";if(o){var p=o.server.conn;n=Y(p[S.find(p,"id",l.connectionId)]);delete l.connectionId;}mstrmojo.xhr.request("POST","taskProc",m,l,undefined,n);}});},getObjectInfo:function Q(k,l){this.sendWebServerRequest(X.copy(k,{taskId:"getObjectInfo"}),l);},getUserServices:function I(k,l){this.sendWebServerRequest(X.copy(k,{taskId:"getUserServices"}),l);},saveObjectACL:function P(k,l){this.sendWebServerRequest(X.copy(k,{taskId:"saveObjectACL"}),l);},getUserEntityInfo:function Z(k,l){this.sendWebServerRequest(X.copy(k,{taskId:"getUserEntityInfo"}),l);}});}());(function(){mstrmojo.requiresCls("mstrmojo.StackContainer","mstrmojo._IsRwDocument","mstrmojo._HasBuilder","mstrmojo._HasLayout","mstrmojo.express.ui._IsDocumentView","mstrmojo.array");mstrmojo.Doc=mstrmojo.declare(mstrmojo.StackContainer,[mstrmojo._HasBuilder,mstrmojo._IsRwDocument,mstrmojo._HasLayout,mstrmojo.express.ui._IsDocumentView],{scriptClass:"mstrmojo.Doc",cssClass:"mstrmojo-Doc",markupSlots:{containerNode:function(){return this.domNode;},popupNode:function(){return this.domNode;},drillLinkMenuNode:function(){return this.domNode;}},layoutConfig:{h:{containerNode:"100%"},w:{containerNode:"100%"}},getLayouts:function(){return mstrmojo.array.filter(this.children,function(G){return !!G.layoutConfig;});},buildChildren:function D(H){if(this._super(false)){var G=this.model.getSelectedKey(this.node),I=(G!==null)?mstrmojo.array.find(this.children,"k",G):-1,J=(I>-1)?this.children[I]:null;if(J){this.set("selected",J);}return true;}return false;},restoreLayoutState:function B(H){this._super(H);var G=H.defn.zf;if((this.zf!==G||this.model.getZoomFactor()!==G)&&this.updateZoom){this.zf=G;this.updateZoom();}},_set_selected:function F(K,I){if(!this.selected){return this._super(K,I);}if(I){var H=this,G=this._super,J=I.k;this.getNewLayout({layoutKey:J},this.children,(J!==this.model.currlaykey),{success:function(P){var L=H.selected;G.call(H,K,P);H.raiseEvent({name:"selectedChange",prop:"selected",value:P,valueWas:L});if(!mstrApp.optimizeFitToPage){var O=H.model.zt;if(O===1||O===2){var S=mstrApp.docModel.controller,R=S.zoom,N=S.view.zoomValue,M=N&&N.dssid,Q=(M&&String(M).split(":"))||[];if(R&&O===parseInt(Q[0],10)){R.call(S,N&&N.dssid);}}}}});}return true;},onLayoutRebuilt:function E(G){this._set_selected("selected",G);},replaceLayout:function C(I,H){var G=this.removeChildren(I);I.destroy();var J=this.builder.build([H],this.model);this.addChildren(J,G);return J[0];},getSelectedLayoutWidget:function A(){return this.selected;},selectorMenuRef:"mstrmojo.SelectorMenu",fpMenuRef:"mstrmojo.FilterPanelMenu"});}());(function(){mstrmojo.requiresCls("mstrmojo.func","mstrmojo.dom","mstrmojo.hash","mstrmojo.ServerProxy","mstrmojo.XHRServerTransport","mstrmojo.LoginEditor","mstrmojo.util.ThemeHelper","mstrmojo.SessionManager");function Q(j,g){var h=(g?"add":"remove")+"LoadingGraph";this.serverProxy[h](j);}var M=true,R=mstrmojo.hash,P="waitBox",W=".htm";function A(g){return g&&(g.sections||g.subsections||g.objects||g.panels||g.layouts||g.children);}mstrmojo._IsWebApp=mstrmojo.provide("mstrmojo._IsWebApp",{_mixinName:"mstrmojo._IsWebApp",serverProxy:null,init:function Z(g){this._super(g);if(!this.serverProxy){this.serverProxy=new mstrmojo.ServerProxy({transport:mstrmojo.XHRServerTransport});}},start:mstrmojo.emptyFn,styleName:"RWDocumentMojoStyle",modelFactory:null,enableWaitBox:false,primaryScdpMap:{},onMobileDevice:function E(){return false;},isTouchApp:function H(){return false;},getContentDimensions:function e(g){return null;},getConfiguration:mstrmojo.emptyFn,setInteractive:function L(g){if(M!==g){M=g;mstrmojo.dom.toggleSelection(window.document.body,g);return true;}return false;},isInteractive:function c(){return M;},addLoadingGraph:function G(g){Q.call(this,g,true);},removeLoadingGraph:function a(g){Q.call(this,g);},serverRequest:function V(n,o,h){try{o=o||{};h=h||{};var k=h.src||(arguments.callee&&arguments.callee.caller.name),g=!this.enableWaitBox||h.silent,m=h.hideFailureErr,l=this;if(!n.noStyle){n.styleName=n.styleName||this.styleName;}o=mstrmojo.func.wrapMethods(o,{submission:function(p){if(!g&&mstrmojo.all[P]){mstrmojo.all[P].requestId=p;}},failure:function(p){if(!g){p.method=k;if(!(mstrApp.isSingleTier&&p.code===403)&&!m){mstrmojo.err(typeof p.mstrerr==="object"?p.mstrerr:p);}}},complete:function(){if(!g){if(mstrmojo.all[P]){delete mstrmojo.all[P].requestId;}l.hideWait();}}});if(!g){this.showWait(h&&h.waitBoxCfg);}window.setTimeout(function(){l.serverProxy.request(o,n,!!h.override,h);},0);}catch(j){mstrmojo.err(j);}},serverRequestParallelNative:function I(j,k,h){var g=h||new mstrmojo.QueueNative();g.queueHandle(j,k);},hasRequests:function U(){return this.serverProxy.hasRequests();},getWaitBoxPosition:function(){return null;},isWaiting:function C(){var g=mstrmojo.all[P];return !!(g&&g.visible);},showWait:function F(k){var m=this,o=mstrmojo.all[P]||mstrmojo.insert({scriptClass:"mstrmojo.Editor",id:P,cssClass:"mstrWaitBox",draggable:false,refreshOnNextShow:false,showTitle:false,zIndex:99999,counter:0,displayMsg:null,position:null,ondisplayMsgChange:function l(){this.msgfield.set("text",this.displayMsg);},oncounterChange:function h(){var q=this.counter,u=this.visible;if(q===0&&u){this.close();}else{if(q>0&&!u){this.open();mstrmojo.dom.center(this.editorNode);var p=this.position||m.getWaitBoxPosition();if(p){var t=p.top,r=p.left;if(t!==undefined){this.set("top",t+"px");}if(r!==undefined){this.set("left",r+"px");}}}}},children:[{scriptClass:"mstrmojo.Box",cssClass:"mstrIcon-wait",alias:"icon"},{scriptClass:"mstrmojo.Label",cssClass:"mstrWaitMsg",alias:"msgfield"},{scriptClass:"mstrmojo.Button",cssClass:"mstrmojo-Button mstrmojo-WebButton mstrWaitCancel",alias:"cancelBtn",text:mstrmojo.desc(2140,"Cancel")}]});o.cancelBtn.set("visible",!!(k&&k.showCancel));o.cancelBtn.onclick=function(){m.serverProxy.cancelRequests();if(k&&k.onCancel&&k.onCancel instanceof Function){k.onCancel.call(m);}};var g=k&&k.position;if(g&&((g.top||g.left)!==undefined)){o.position=k.position;}else{o.position=null;}o.set("displayMsg",(k&&k.message)||mstrmojo.desc(11960,"Loading Data..."));if(k&&k.cssClass){o.set("cssClass","mstrWaitBox "+((k&&k.cssClass)||""));o.refresh();o.refreshOnNextShow=true;}else{if(o.refreshOnNextShow){o.refresh();o.refreshOnNextShow=false;}}if(!this._waitUserLogin){o.set("counter",o.counter+1);}else{this._waitCounter=this._waitCounter+1;}var n;function j(){mstrApp.hideWait();clearTimeout(n);}if(k&&k.timeout){n=window.setTimeout(function(){j();},k.timeout);}if(k&&k._autoClose){mstrmojo.all.waitBox.curtainNode.onclick=function(){j();};}return o;},hideWait:function N(g){var h=mstrmojo.all[P];if(this._autoCloseFn){mstrmojo.dom.detachEvent(h.curtainNode,"mousedown",this._autoCloseFn,true);delete this._autoCloseFn;}if(h){h.set("cssClass","mstrWaitBox");if(!this._waitUserLogin){h.set("counter",g?0:Math.max(0,h.counter-1));}else{this._waitCounter=g?0:Math.max(0,h.counter-1);}}},getWaitBox:function(){return mstrmojo.all[P];},showProgress:mstrmojo.emptyFn,hideProgress:mstrmojo.emptyFn,startSessionManager:function Y(h){var j=mstrApp,g=j.enableAutomaticSessionRecovery&&j.maxSessionIdleTime;j.sessionManager=j.addDisposable(new mstrmojo.SessionManager(mstrmojo.hash.copy(h,g?{timeBeforeSessionTimeoutWarning:mstrApp.timeBeforeSessionTimeoutWarning,maxSessionIdleTime:j.maxSessionIdleTime}:{})));if(g){j.sessionManager.start();}},isSessionExpiredError:function f(l){var k=2147760371,j=2147760372,h=2147758245,g=2147759877;l=(l<0)?(4294967296+parseInt(l,10)):l;switch(l){case k:case j:case h:case g:return true;}return false;},onSessionExpired:function b(j){if(!mstrConfig.features["enable-login-editor"]){var m=mstrApp.launchingApp||mstrApp;var n={evt:5005,src:m.name+"."+m.pageName+".5005"},h=(m.docModel&&m.docModel.bs)||(m.rootCtrl&&m.rootCtrl.docCtrl&&m.rootCtrl.docCtrl.model&&m.rootCtrl.docCtrl.model.bs)||(m.docModelData&&m.docModelData.bs);if(h){n.rwb=h;}mstrmojo.form.send(n);return ;}if(mstrApp.sessionManager){var l=mstrmojo.all[P],g=l&&l.counter>0,k=this;this._waitCounter=-1;if(g){this._waitCounter=l.counter-1;k.hideWait(true);}this._waitUserLogin=true;mstrApp.sessionManager.openLoginEditor({success:function(o){k._waitUserLogin=false;if(o&&o.sessionState){if(j){if(j.params.sessionState){j.params.sessionState=o.sessionState;}if(g){l.counter=k._waitCounter;k.showWait();}mstrmojo.xhr.request(j.method,j.baseUrl,j.callback,j.params);}}},cancelRequests:function(){mstrApp.serverProxy.cancelRequests();}});}},updateSessionState:function O(g){this.sessionState=g;},onNavigateOut:mstrmojo.emptyFn,showHelpTopic:function B(l,h){var k=h?h+"HelpPath":"helpPath",g=mstrmojo[k].call(),n=mstrApp.isSingleTier,m=mstrApp.isWorkstation,j=-1;if(l&&typeof l==="string"){g+=l;}if(n||m){window.FormWrapper.openPage(g);}else{mstrApp.openPage(g);}return false;},getSearchAutoCompleteDelay:function S(){return parseInt(mstrConfig&&mstrConfig.searchAutoCompleteDelay,10)||200;},getThemeClassName:function D(){return"mojo-theme-light";},openPage:function K(g,h){window.open(g,h);},modalEditorChange:function J(h,g){if(mstrApp&&mstrApp.isOIVM&&mstrApp.isOIVM()){if(!mstrApp.modalOpenEditors){mstrApp.modalOpenEditors={};}if(g){mstrApp.modalOpenEditors[h]=true;}else{delete mstrApp.modalOpenEditors[h];}}},parseSecondaryDataProviders:function X(l){var k,n,h,m=l.defn,o=m&&m.layouts,j=(o&&o.length)||0,g=mstrApp.primaryScdpMap;for(k=0;k<j;k++){n=o[k];h=n&&n.units;R.forEach(h,function(p,q){if(p&&p.scdp){g[q]=p.scdp.split(",");}});}},getPluginsRoot:function(){return((mstrApp.isSingleTier||mstrApp.isWorkstation)?"file://":"")+(this.pluginRoot||(mstrConfig&&mstrConfig.pluginRoot)||"../plugins/");},upload:function(n,m,l,h,k,j,g){this.serverProxy.upload(n,m,l,h,k,j,g);},getThemeProps:function d(g){var h;if(mstrApp&&mstrApp.isOIVM&&mstrApp.isOIVM()){if(!mstrApp.themeProps){mstrApp.themeProps=mstrmojo.util.ThemeHelper.getThemePropConfig({layoutstyle:mstrApp.docModel.getCurrentLayoutStyle()});}h=mstrApp.themeProps;}else{h=mstrApp.getRootController().view.themeProps;}return g?h[g]:h;}});window.$MAPF=function(){return false;};}());(function(){mstrmojo.requiresCls("mstrmojo.ValidationTextBox","mstrmojo.Calendar","mstrmojo.Popup","mstrmojo._HasPopup","mstrmojo.locales","mstrmojo.date","mstrmojo.string");var B=mstrmojo.ValidationTextBox.prototype.markupMethods,D=mstrmojo.string,A=function(){return mstrmojo.locales.datetime;},C=mstrmojo.date;mstrmojo.DateTextBox=mstrmojo.declare(mstrmojo.ValidationTextBox,[mstrmojo._HasPopup],{scriptClass:"mstrmojo.DateTextBox",calendarToBody:false,calendarZIndex:100,changeValueOnOK:false,dynDateValue:null,showAdvanced:false,canSelectDisabledDate:false,isList:false,dtp:14,defaultDate:null,autoFormat:true,enabled:true,min:"",max:"",markupString:'<div id="{@id}" class="mstrmojo-DateTextBox {@cssClass}" style="{@cssText}"><input class="mstrmojo-DateTextBox-input" type="text" title="{@tooltip}"value="{@value}" size="{@size}" maxlength="{@maxLength}" index="{@tabIndex}" mstrAttach:focus,keyup,blur /><div class="mstrmojo-DateTextBox-icon" mstrAttach:click> </div><div class="mstrmojo-DateTextBox-popup"></div></div>',markupSlots:{inputNode:function(){return this.domNode.firstChild;},iconNode:function(){return this.domNode.childNodes[1];},popupNode:function(){return this.domNode.lastChild;}},markupMethods:{onvisibleChange:function(){this.domNode.style.display=this.visible?this.cssDisplay:"none";},onwidthChange:function(){if(this.width){this.inputNode.style.width=(this.width-20)+"px";this.iconNode.style.left=(this.width-18)+"px";this.domNode.style.width=this.width+"px";}},onvalueChange:B.onvalueChange,onenabledChange:B.onenabledChange,onvalidationStatusChange:B.onvalidationStatusChange},calConfig:null,calendar:{scriptClass:"mstrmojo.Popup",cssClass:"mstrmojo-DateTextBox-calendar",locksHover:true,slot:"popupNode",onOpen:function(){var H=this.opener,G=H&&H.calendarZIndex,I=this.cal,E=H&&H.calConfig;if(G){this.domNode.style.zIndex=G;}for(var F in E){I.set(F,E[F]);}},children:[{scriptClass:"mstrmojo.Calendar",alias:"cal",forceNonEmptySelection:true,bindings:{showAdvanced:"this.parent.opener.showAdvanced",dtp:"this.parent.opener.dtp",value:"this.parent.opener.value",dynDateValue:"this.parent.opener.dynDateValue",enabled:"this.parent.opener.enabled",min:"this.parent.opener.min",max:"this.parent.opener.max",canSelectDisabledDate:"this.parent.opener.canSelectDisabledDate",changeValueOnOK:function(){var F=this.parent.opener.dtp,E=this.parent.opener.changeValueOnOK;return F===15||F===16||E;}},closeOnValueChange:true,onValueUpdate:function(F){var I=this.parent&&this.parent.opener;if(I){var G=I.value,E=window.mstrConfig&&window.mstrConfig.listSep||";",H=I.dtp===15?C.formatTimeInfo(this.timeVal,A().TIMEOUTPUTFORMAT):this.value;if(I.isList&&!D.isEmpty(G)){I.set("value",I.value+E+H);}else{I.set("dynDateValue",this.dynDateValue);I.set("value",H);}I.closePopup();}}}]},onclick:function(E){var F=this._lastOpened,G=this._calendarConfig;if(!G){G={};if(this.calendarToBody){delete this.calendar.slot;G.placeholder=document.body.appendChild(document.createElement("div"));G.nudge=function(){var M=this.opener;if(M){var H=mstrmojo.dom.position(M.popupNode,true),L=this.domNode,P=L.offsetHeight,I=L.offsetWidth,J=mstrmojo.dom.windowDim(),K=H.x,N=H.y;if(N+P>=J.h){N=Math.max(N-P,0);}if(K+I>=J.w){K=Math.max(K-I,0);}var O=L.style;O.top=N+"px";O.left=K+"px";}};}this._calendarConfig=G;}G.lockIW=this;if(F&&F.visible){this.closePopup();}else{this.openPopup("calendar",G);this.calendar.cal.updateSelectedDate(true);}},unrender:function(){this._super();if(this.calendarToBody&&this._calendarConfig){delete this._calendarConfig;}if(this.calendar.hasRendered){this.calendar.unrender();}},_set_value:function(H,F){var G=this.value,E=(G!==F);if(E){this.value=F;this.validate(F);}if(this.showAdvanced&&this.dynDateChanged){this.dynDateChanged=false;E=true;}return E;},_set_dynDateValue:function(H,F){var G=this.dynDateValue,E=(G!==F);if(E){this.dynDateValue=F;this.dynDateChanged=true;}return E;}});})();(function(){mstrmojo.requiresCls("mstrmojo.vi.ui.TitleBar","mstrmojo.ui.menus._HasMenuPopup");function E(H,F){var G=this.domPopupPH;G.style.top=H.y+"px";G.style.left=H.x+"px";G.innerHTML="";document.body.appendChild(G);F.hostId=this.id;F.hostElement=G;mstrmojo.css.toggleClass(G,mstrApp.getThemeClassName(),true);this.openPopup(F.newInstance());}function B(){var G=this.domPopupPH,H=G.firstChild,F=G.parentNode;if(H){G.removeChild(H);}if(F){F.removeChild(G);}}function A(G){var F;if(typeof this.parent.boxContent.getTitleRMCPopup==="function"){F=this.parent.boxContent.getTitleRMCPopup.call(this);}if(F){E.call(this,G,F);}}mstrmojo.vi.ui.TitleBarWithRMCPopup=mstrmojo.declare(mstrmojo.vi.ui.TitleBar,[mstrmojo.ui.menus._HasMenuPopup],{scriptClass:"mstrmojo.vi.ui.TitleBarWithRMCPopup",markupString:'<div id="{@id}" class="mstrmojo-VITitleBar {@cssClass}" style="{@cssText}" mstrAttach:contextmenu, click><div class="left-toolbar"></div><div class="title-text"></div><div class="right-toolbar"></div></div>',init:function D(F){this._super(F);var G=document.createElement("div");G.setAttribute("class","gm-menu-placeholder");this.domPopupPH=G;},oncontextmenu:function C(F){A.call(this,{x:F.e.pageX+2,y:F.e.pageY+2});},unrender:function(){this._super();B.call(this);},onclick:function(){B.call(this);}});}());(function(){mstrmojo.requiresCls("mstrmojo.vi.ui.TitleBar","mstrmojo.vi.ui.PanelContents");function D(H,I,G){if(I){this.targetUnit.updateDisplayName(H,G);if(mstrApp.isInVFConfigMode){mstrmojo.all.visualizationFilterToolbar.updateDisplayFilterName(H);}}}function A(G){this.set("title",G.value);}function B(G){if(this.layoutKey!==this.model.currlaykey){return ;}if(this._vizTitleSub){this._vizTitleSub.clear();delete this._vizTitleSub;}this.set("title","");var I=this.contents,H=(I.children||[]).slice();I.removeChildren();H.forEach(function(K){K.destroy();});var J=mstrmojo.all[G.id];if(J){this.targetUnit=J;this.set("title",J.getDisplayName());this._vizTitleSub=J.attachEventListener("titleChange",this.id,A);this.onVIUnitSelected(J);}}mstrmojo.vi.ui._IsUnitDependentPanel=mstrmojo.provide("mstrmojo.vi.ui._IsUnitDependentPanel",{_mixinName:"mstrmojo.vi.ui._IsUnitDependentPanel",markupMethods:{onvisibleChange:mstrmojo.Widget.visibleMarkupMethod,ontitleChange:function(){var G=this.toolbar;if(G){G.set("title",this.title||"");}}},targetUnit:null,init:function E(G){this._super(G);this.model.attachEventListener("viUnitSelected",this.id,B);this.toolbar.set("editTitleOnDoubleClick",mstrApp.allowWebDashboardDesign());},children:[{scriptClass:"mstrmojo.vi.ui.TitleBar",slot:"controlNode",alias:"toolbar",useRichTooltip:true,titleEdited:function(H,I,G){D.call(this.parent,H,I,G);},layoutConfig:{w:{textNode:"100%",rightToolNode:"23px"},h:{textNode:"all",rightToolNode:"all"},xt:true},getTitleChildrenLayoutOffsets:function F(){return{h:0,w:16};}},{scriptClass:"mstrmojo.vi.ui.PanelContents",slot:"containerNode",alias:"contents"}],onRender:function C(){var G=this.model.getSelectedViUnit();if(G){B.call(this,{id:G.id});}if(this._super){this._super();}},onVIUnitSelected:function(G){}});}());(function(){mstrmojo.requiresCls("mstrmojo.vi.ui.TitleBar","mstrmojo.Image","mstrmojo.css");mstrmojo.vi.ui.CollapsibleTitleBar=mstrmojo.declare(mstrmojo.vi.ui.TitleBar,null,{scriptClass:"mstrmojo.vi.ui.CollapsibleTitleBar",btnCollapse:null,canCollapse:false,isCollapsed:false,collapse:mstrmojo.emptyFn,onToggleCollapseByUI:mstrmojo.emptyFn,setToolbarVisibility:function C(D){if(!D||!this.isCollapsed){this._super(D);}},onisCollapsedChange:function B(){if(this.canCollapse){var D=this.isCollapsed;this.parent.set("isCollapsed",D);}},getLeftToolbarChildren:function A(){var D=this;return[{scriptClass:"mstrmojo.Image",slot:"leftToolNode",alias:"btnCollapse",onclick:function(F){var G=this.parent,E=G.parent;if(G.canCollapse){G.set("isCollapsed",!G.isCollapsed);D.onToggleCollapseByUI();var H=F.e;if(H&&H.stopPropagation){H.stopPropagation();}}if(E&&E.clickToCollapse){E.clickToCollapse();}}}];}});mstrmojo._HasMarkup.addMarkupMethods(mstrmojo.vi.ui.CollapsibleTitleBar,{oncanCollapseChange:function(){this.btnCollapse.set("visible",this.canCollapse);},onisCollapsedChange:function(){mstrmojo.css.toggleClass(this.domNode,"collapsed",this.isCollapsed);}});}());(function(){mstrmojo.requiresCls("mstrmojo.vi.ui.tabs.TabStrip","mstrmojo.vi.ui._HasMask","mstrmojo.hash","mstrmojo.dom","mstrmojo.css","mstrmojo.string","mstrmojo.models.FormatModel","mstrmojo.vi._MonitorsLayoutMode","mstrmojo.vi.ui.tabs.LayoutTabHelper","mstrmojo.vi.models.VIComponentMap","mstrmojo.vi.controllers.EnumLayoutManipulationType","mstrmojo.vi.controllers.EnumLayoutSelectorPosition","mstrmojo.vi.controllers.EnumPanelManipulationType","mstrmojo.vi.controllers.EnumEvents");mstrmojo.requiresDescs(13768,13769,14918,14919,15127,15128);var Q=mstrmojo.hash,H=mstrmojo.dom,O=mstrmojo.array,c=mstrmojo.css,C=mstrmojo.string,A=mstrmojo.vi.ui.tabs.Tab.ACTIONS,F=A.DELETE+A.DUPLICATE+A.MOVE+A.RENAME+A.NEW_TAB,V=mstrmojo.vi.models.VIComponentMap.TYPES,g=mstrmojo.models.FormatModel,X=mstrmojo.vi.ui.tabs.LayoutTabHelper,P=144,L=70,U=90,W=52,M=6,a=2,b=mstrmojo.vi.controllers.EnumLayoutManipulationType,d=mstrmojo.vi.controllers.EnumPanelManipulationType,G=mstrmojo.vi.controllers.EnumLayoutSelectorPosition,B=mstrmojo.vi.controllers.EnumEvents;function D(h){return function(){c.toggleClass(this.menuBtnNode,"expand",h);this.menuBtnHostNode.style.display=h?"block":"none";};}mstrmojo.vi.ui.tabs.LayoutTabStrip=mstrmojo.declare(mstrmojo.vi.ui.tabs.TabStrip,[mstrmojo.vi.ui._HasMask,mstrmojo.vi._MonitorsLayoutMode],{scriptClass:"mstrmojo.vi.ui.tabs.LayoutTabStrip",docModel:null,isAlignRight:false,alignPosition:G.LEFT,selectMovedTab:true,cssClass:"mstrmojo-LayoutTabStrip",markupMethods:{onalignPositionChange:function(){var h=this.alignPosition===G.TOP;c.toggleClass(this.domNode,"alignTop",h);c.toggleClass(this.menuImgNode,"topButton",h);this.visible=this.alignPosition===G.LEFT?false:true;},onvisibleChange:mstrmojo.Widget.visibleMarkupMethod},layoutConfig:{w:{bufferNode:M+"px",addBtnNode:U+"px",navBtnsNode:W+"px"},xt:true},onRender:function J(){this._super();var k=this.leftBtnNode,h=this.rightBtnNode,j=mstrApp.isWSStyling?mstrmojo.desc(15127,"Chapter"):mstrmojo.desc(15128,"Sheet");if(k&&!k.getAttribute("tooltip")){this.leftBtnNode.setAttribute("tooltip",mstrmojo.desc(15820,"This is the first ##").replace("##",j));}if(h&&!h.getAttribute("tooltip")){this.rightBtnNode.setAttribute("tooltip",mstrmojo.desc(15821,"This is the last ##").replace("##",j));}},onLayoutModeChange:function K(h){this.adjustInPreviewMode();},widgetResized:function N(){var h=function(){if(mstrApp.isLayoutModePreview&&mstrApp.isLayoutModePreview()){this.adjustInPreviewMode();}else{var l=!this.isValidMode(),k=H.position(this.domNode).w||parseInt(this.width,10)||0,n=l?W+a+M:P+L,m=Math.max(k-n,0),j=this.tabContainerNode;if(j&&m){j.style.maxWidth=m+"px";}}};if(this.hasRendered){h.call(this);return ;}this.attachEventListener("renderComplete",this.id,h);},buildRendering:function S(){this._super();var h=this.borderNode=document.createElement("div");h.className="mstrmojo-VILayoutTabs-divider";h.style.zIndex=this._borderZIndex;this.domNode.appendChild(h);this.addBtnTxtNode.innerHTML=mstrApp.isWSStyling?mstrmojo.desc(15127,"Chapter"):mstrmojo.desc(15128,"Sheet");},adjustInPreviewMode:function R(){var q=parseInt(this.parent.width,10)||0,k=mstrmojo.vi.ui.rw.DocRelativePanel.getLayoutBreakPoint(),p=!this.isValidMode(),h=mstrApp.isLayoutModePreview(),n=p?W+a:P+L,m=this.domNode,l=this.tabContainerNode;var j=h?Math.min(q,k):q,o=Math.max(j-n,0);this.set("width",j+"px");if(m){m.style.left=h?Math.max(q-k,0)/2+"px":"0px";if(l&&o){l.style.maxWidth=o+"px";}}},getTabCfg:function E(v,k,q){var m=q.k,h=this.id,n=k.model,x=n.controller.view;Q.copy({title:k.n,getMenuActions:function p(){return F;},addNewTabMenuItem:function t(AA){AA.addMenuItem(mstrApp.isWSStyling?mstrmojo.desc(14919,"Insert Page"):mstrmojo.desc(13768,"Insert Panel"),"",function(){var AD=(v||[]).filter(function(AF){return AF.k===m;})[0];var AC=AD.model,AB=AC.getVIComponent(V.VIZ_CONTENT,AC.getCurrentLayoutKey()),AE=AB&&AB.k;AC.raiseEvent({name:B.MANIPULATE_PANEL,type:d.NEW,layoutKey:AC.getCurrentLayoutKey(),panelStackKey:AE});});AA.addSeparator();AA.addMenuItem(mstrApp.isWSStyling?mstrmojo.desc(14918,"Insert Chapter"):mstrmojo.desc(13769,"Insert Sheet"),"",function(){mstrmojo.all[h].addTab();});},findSelectedTab:function l(AA){var AB=x.getSelectedLayoutWidget();return AB.getSelector().getSelectedTab();},tabSelected:function j(AC){var AB=mstrApp.isAppStateSelection&&mstrApp.isAppStateSelection();if(AB){n.raiseEvent({name:"targetLayoutSelected",layoutKey:m});}else{n.execute({execute:function AA(){x.showLayout((v||[]).filter(function(AD){return AD.k===m;})[0],AC);},urInfo:{treesToRender:3}});}},tabDeleted:function w(){n.raiseEvent({name:B.MANIPULATE_LAYOUT,type:b.DELETE,layoutKey:m});},tabDuplicated:function u(){n.raiseEvent({name:B.MANIPULATE_LAYOUT,type:b.DUPLICATE,layoutKey:m});},titleEdited:function z(AB,AA){n.raiseEvent({name:B.MANIPULATE_LAYOUT,type:b.RENAME,layoutKey:m,oldText:AA,newText:AB});this.parent.updateTabTable();},postCreateChildren:function r(){Q.copy({autoApplyDelay:3000,editOnDoubleClick:mstrApp.allowWebDashboardDesign()},this.lbl);},useRichTooltip:true,updateTooltipConfig:function o(AB){var AC=AB.target;if(AC===this.lbl.domNode&&AC.scrollWidth>AC.clientWidth){var AA=H.position(AC);this.richTooltip={posType:mstrmojo.tooltip.POS_BOTTOMCENTER,cssClass:"vi-regular vi-tooltip-V V-center",content:C.encodeHtmlString(this.title),top:AA.y,left:AA.x+AA.w/2};}else{this.richTooltip=null;}}},q);this.docModel=k.model;return q;},addTab:function Y(){var h=this.parent.model;h.raiseEvent({name:B.MANIPULATE_LAYOUT,type:b.NEW});},commitTabMove:function Z(h,j){this.docModel.controller.view.moveLayout(h,j);},onclick:function f(h){this._super(h);if(h.getTarget().parentNode===this.tabStripMenuNode&&this.isValidMode()){var k=this.parent.model,j=k.controller.rootCtrl,l=j.getSelectorTabMenu(k);l.addPopupHandlers(this.id,D(true),D(false));l.hostId=this.id;l.hostElement=this.menuBtnHostNode;l.isHostedWithin=false;this.openPopup(l.newInstance());}},onmousedown:function e(j){this._super(j);var l=this,n=j.getTarget().parentNode,h=(n===this.leftBtnNode),m=(n===this.rightBtnNode);if(h||m){var k=function(){X.saveTabBarPosition(l);};H.attachOneTimeEvent(document.body,"mouseup",k);}},layoutSelected:function I(h){var k=this.docModel,o=k.controller.view,j=this.getSelectedTab(),l=this;var n=function n(p){k.raiseEvent({name:"selectPage",panelKey:p.panelKey,callback:p.callback});};if(j.k!==h.layoutKey){k.execute({execute:function m(){o.showLayout((l.tabObjects||[]).filter(function(p){return p.k===h.layoutKey;})[0],h.callback,undefined,h.panelKey);},urInfo:{treesToRender:3},isUntracked:mstrApp.isAppStateSelection()});}else{n(h);}}});}());(function(){mstrmojo.requiresCls("mstrmojo.vi.ui.tabs.TabStrip","mstrmojo.vi.ui._HasMask","mstrmojo.vi.ui.tabs.Tab","mstrmojo.hash","mstrmojo.dom","mstrmojo.css","mstrmojo.string","mstrmojo.vi.controllers.EnumLayoutSelectorPosition");mstrmojo.requiresDescs(3687,4780,14919,13768);var L=mstrmojo.hash,G=mstrmojo.dom,U=mstrmojo.css,C=mstrmojo.string,A=mstrmojo.vi.ui.tabs.Tab.ACTIONS,D=A.DELETE+A.DUPLICATE+A.MOVE+A.RENAME+A.NEW_TAB,F=mstrmojo.vi.controllers.EnumLayoutSelectorPosition,K=144,O=90,P=52,I=6,S=2;mstrmojo.vi.ui.tabs.PanelTabStrip=mstrmojo.declare(mstrmojo.vi.ui.tabs.TabStrip,[mstrmojo.vi.ui._HasMask],{scriptClass:"mstrmojo.vi.ui.tabs.PanelTabStrip",cssClass:"mstrmojo-PanelTabStrip",docModel:null,isAlignRight:false,alignPosition:F.LEFT,selectMovedTab:true,hasFloater:true,markupMethods:{onalignPositionChange:function(){U.toggleClass(this.domNode,"alignTop",this.alignPosition===F.TOP);this.visible=this.alignPosition===F.LEFT?false:true;},onvisibleChange:mstrmojo.Widget.visibleMarkupMethod},layoutConfig:{w:{bufferNode:I+"px",addBtnNode:O+"px",navBtnsNode:P+"px"},xt:true},onRender:function H(){this._super();var X=this.leftBtnNode,V=this.rightBtnNode,W=mstrApp.isWSStyling?mstrmojo.desc(3687,"Page"):mstrmojo.desc(4780,"Panel");if(X&&!X.getAttribute("tooltip")){this.leftBtnNode.setAttribute("tooltip",mstrmojo.desc(15820,"This is the first ##").replace("##",W));}if(V&&!V.getAttribute("tooltip")){this.rightBtnNode.setAttribute("tooltip",mstrmojo.desc(15821,"This is the last ##").replace("##",W));}},widgetResized:function J(){var V=function(){var Y=!this.isValidMode(),X=G.position(this.domNode).w||parseInt(this.width,10)||0,a=Y?P+S+I:K,Z=Math.max(X-a,0),W=this.tabContainerNode;if(W&&Z){W.style.maxWidth=Z+"px";}};if(this.hasRendered){V.call(this);return ;}this.attachEventListener("renderComplete",this.id,V);},buildRendering:function M(){this._super();var V=this.borderNode=document.createElement("div");V.className="mstrmojo-VIPanelTabs-divider";V.style.zIndex=this._borderZIndex;this.domNode.appendChild(V);this.addBtnTxtNode.innerHTML=mstrApp.isWSStyling?mstrmojo.desc(3687,"Page"):mstrmojo.desc(4780,"Panel");this.set("visible",this.children.length>1);},getTabCfg:function E(e,W,Z){var c=this.parent;L.copy({title:W.titleText,getMenuActions:function Y(){return D;},addNewTabMenuItem:function b(h){h.addMenuItem(mstrApp.isWSStyling?mstrmojo.desc(14919,"Insert Page"):mstrmojo.desc(13768,"Insert Panel"),"",function(){c.addPanel();});},tabSelected:function V(l){var j=mstrApp.isAppStateSelection&&mstrApp.isAppStateSelection(),h=W.model,k=W.k;if(j){h.raiseEvent({name:"targetLayoutSelected",layoutKey:h.getLayoutKeyByUnitKey(k),panelKey:k});}else{c.selectPanel(k,false,false,null,l);}},tabDeleted:function f(){c.deletePanel(W);},tabDuplicated:function d(){c.duplicatePanel(W);},titleEdited:function g(j,h){c.renamePanel(W,j);},postCreateChildren:function a(){L.copy({autoApplyDelay:3000,editOnDoubleClick:mstrApp.allowWebDashboardDesign()},this.lbl);},useRichTooltip:true,updateTooltipConfig:function X(j){var k=j.target;if(k===this.lbl.domNode&&k.scrollWidth>k.clientWidth){var h=G.position(k);this.richTooltip={posType:mstrmojo.tooltip.POS_BOTTOMCENTER,cssClass:"vi-regular vi-tooltip-V V-center",content:C.encodeHtmlString(this.title),top:h.y,left:h.x+h.w/2};}else{this.richTooltip=null;}}},Z);this.docModel=W.model;return Z;},addTab:function Q(){this.parent.addPanel();},commitTabMove:function R(V,W){this.parent.movePanel(V,W);},onTabsChange:function B(){var V=this.children||[];this.set("visible",V.length>1);},selectPage:function N(V){this.parent.selectPanel(V.panelKey,undefined,undefined,undefined,V.callback);}});}());(function(){mstrmojo.requiresCls("mstrmojo.array","mstrmojo.hash","mstrmojo.Container","mstrmojo.desc","mstrmojo.ME.TokenInputBox","mstrmojo.mstr.EnumDSSXMLTokenTypes","mstrmojo.ME.Enum","mstrmojo._HasTooltip","mstrmojo.dom","mstrmojo.string");mstrmojo.requiresDescs(221,547,9106,9565,9566,9567,9568,11897,13542,13543,15665);var M=mstrmojo.array,S=mstrmojo.hash,I=mstrmojo.desc,O=mstrmojo.mstr.EnumDSSXMLTokenTypes,N=mstrmojo.ME.Enum.METRIC_EDIT_TYPES,L=mstrmojo.string.escape4HTMLText,E=mstrmojo.dom;var Q={VALID:0,UNKNOWN:1,VALIDATING:2,ERROR:3,AMBIGUITY:4},G={0:"valid",1:"unknown",2:"validating",3:"error",4:"ambiguity"},R={0:I(9565,"Valid Metric Formula."),1:I(9106,"Require Validation?"),2:I(9566,"Validation in Progress..."),3:I(9567,"Validation Failed with Syntax Error!"),4:I(9568,"Validation Failed with Object Ambiguity!")},U={ERROR:"-2147214845",AMBIGUITY:"-2147214846"},B={};B[U.ERROR]=Q.ERROR;B[U.AMBIGUITY]=Q.AMBIGUITY;function P(a){if(!a){return Q.VALID;}return B[a]||Q.ERROR;}mstrmojo.ME.MetricEditBox=mstrmojo.declare(mstrmojo.Container,[mstrmojo._HasPopup,mstrmojo._HasTooltip],{scriptClass:"mstrmojo.MetricEditBox",vStatus:Q.VALID,iStatus:"",showStatus:true,browseItemVisible:true,absorbAmbiguity:true,validateFunc:null,isObjectVisible:function(a){return true;},markupString:'<div id="{@id}" class="mstrmojo-MEBox {@cssClass}" style="{@cssText}"><div class="mstrmojo-MEBox-edit"></div><div class="mstrmojo-MEBox-status {@statusCssClass}"><div class="mstrmojo-MEBox-vStatus"></div><div class="mstrmojo-MEBox-iStatus"></div></div></div>',markupSlots:{editNode:function(){return this.domNode.firstChild;},iStatusNode:function(){return this.domNode.lastChild.lastChild;},vStatusNode:function(){return this.domNode.lastChild.firstChild;},statusNode:function(){return this.domNode.lastChild;}},markupMethods:{onvStatusChange:function(){var b=this.vStatus,a=this.vStatusNode;a.className="mstrmojo-MEBox-vStatus "+G[b];a.innerHTML=(this.getStatusDesc&&this.getStatusDesc(b))||R[b]||"";if(this.vStatus===Q.VALID){this.set("cValid",true);}},oniStatusChange:function(){this.iStatusNode.innerHTML=this.iStatus;}},children:[{scriptClass:"mstrmojo.ME.TokenInputBox",alias:"inputBox",slot:"editNode",renderOnScroll:false,renderBlockSize:0,bindings:{browseItemVisible:"this.parent.browseItemVisible",candidates:"this.parent.candidates"},editEmbeddedFilterToken:function(a){var b=this.parent;if(b.editEmbeddedFilterToken){b.editEmbeddedFilterToken(a);}}}],init:function V(a){var b=this,c=a.validateFunc||this.validateFunc;if(c){b.children=[{scriptClass:"mstrmojo.Button",alias:"validateBtn",slot:"statusNode",text:I(11897,"Validate"),cssClass:"mstrmojo-WebHoverButton right hoverLink",cssDisplay:"inline-block",onclick:c}].concat(this.children);}if(this._super){this._super(a);}this.statusCssClass=this.showStatus?"":"hidden";},getSearchPattern:function Z(){return this.inputBox.getSearchPattern();},getHighlightedText:function W(b,a){return this.inputBox.getHighlightedText(b,a);},item2textCss:function K(a){return{4:"m",7:"am",11:"fx",12:"a",13:"fc",43:"tr",47:"cs"}[a.t]||"";},handleSuggestionItemSelect:function J(a){var b=this.ambiguityDialog;if(a){b.onItemSelect(a);}b.close();},showDesc:true,showPath:true,ambiguityDialog:{scriptClass:"mstrmojo.Editor",cssClass:"mstrmojo-ME-ambiguityDialog",onOpen:function(){this.set("title",I(13542,"Object Ambiguity - ##").replace("##",this.ambiguousName));this.list.clearSelect();this.list.set("items",this.items);this.list.singleSelect(0);this.label.set("text",I(13543,"More than one object with the name '##' were found.").replace("##",this.ambiguousName));},children:[{scriptClass:"mstrmojo.Label",alias:"label",text:""},{scriptClass:"mstrmojo.ui.ScrollableSuggestionList",alias:"list",cssClass:"mstrmojo-ME-ambiguityList",bindings:{items:"this.parent.opener.suggestionItems"},onclick:function(a){mstrmojo._IsList.onclick.call(this,a);},getItemMarkup:function(d,a){var c=this.parent.opener,b=mstrmojo.string.escape4HTMLText;var f=(c&&c.item2textCss(d))||"";var e="";if(d.path){e='<div class="mstrmojo-object-additional-info" idx="'+a+'">'+mstrmojo.desc(16154,"From Dataset:")+" "+L(d.path)+"</div>";}else{d.standalone=true;}return'<div class="mstrmojo-object-item" idx="'+a+'"><div class="mstrmojo-object-name '+f+'" idx="'+a+'">'+L(d.n)+"</div>"+e+"</div>";},buildTooltip:function(a,b){if(a.standalone){return L(a.path)+"> "+L(a.n);}else{return L(a.n)+'<div class="mstrmojo-object-additional-info">'+mstrmojo.desc(16154,"From Dataset:")+" "+L(a.path)+"</div>";}}}],buttons:[{scriptClass:"mstrmojo.Button",cssClass:"mstrmojo-Button mstrmojo-WebButton hot",text:I(547,"Select"),onclick:function(){var a=this.parent.parent;a.opener.handleSuggestionItemSelect(a.list.selectedItem);}},{scriptClass:"mstrmojo.Button",cssClass:"mstrmojo-Button mstrmojo-WebButton",text:I(221,"Cancel"),onclick:function(){this.parent.parent.close();}}]},defaultOnTokensModify:function(){this.set("vStatus",Q.UNKNOWN);this.set("iStatus","");},postBuildRendering:function Y(){this._super();this.inputBox.attachEventListener("tokensModify",this.id,"defaultOnTokensModify");this.inputBox.attachEventListener("tokensModify",this.id,"ontokensModify");},updateInputBoxItems:function H(a){this.inputBox.set("items",a.items);},replaceErrorToken:function C(a){this.inputBox.replaceErrorToken(a);},clientSideValidation:function A(g){if(!g){return ;}var c=false,f=false,b=g.items;try{c=mstrApp.rootCtrl.docCtrl.model.isMDXDataset(S.any(this.parent.parent.datasets));f=g.met==N.ADVANCED&&b[0].tp==O.SimpPrefixFun&&b[0].v==="ApplySimple";}catch(h){}if(c&&f){var a=M.filterOne(b,function(e){return e.tp===O.DoubleQString;});var d=/(\'|\/\/|\-\-|\/\*|\*\/)/;if(a&&d.test(a.v)){g.vs=Q.ERROR;g.rjec=U.ERROR;g.rjed=I(15665,"MDX pass-through expression should not contain ', //, --, /*, */.");}}},handleValidation:function F(a){if(!a){this.set("vStatus",Q.ERROR);return ;}a.vs=P(a.rjec);this.set("vStatus",a.vs);this.set("iStatus",mstrmojo.string.encodeHtmlString(a.rjed)||"");this.updateInputBoxItems(a);this.inputBox.focus();if(a.vs===Q.AMBIGUITY){var l=this,h=a.items,g=M.find(h,"sta",-1),b=h[g].v,j=function(c){l.replaceErrorToken(c);l.set("iStatus","");l.set("vStatus",Q.UNKNOWN);if(l.continueValidataion){l.continueValidataion();}else{l.set("vStatus",Q.VALID);}};var d=M.filter(a.srfd.items,this.isObjectVisible);var k=this.parent.candidates,e=k&&k.items;if(e){M.forEach(d,function(f){var c=M.find(e,"did",f.did);if(c===-1){if(this.absorbAmbiguity){e.push(f);}}else{f.path=e[c].path;}});}if(d.length===1){j(d[0]);return ;}this.openPopup("ambiguityDialog",{zIndex:100,items:d,ambiguousName:b,onItemSelect:j});}else{if(this.postHandleValidation){this.postHandleValidation();}}},tooltip:"",useRichTooltip:true,updateTooltipConfig:function X(b){var c=b.target||E.eventTarget(b.hWin,b.e),a=E.position(c);this.richTooltip={posType:mstrmojo.tooltip.POS_TOPLEFT,content:this.getTooltipContent(b),top:a.y+a.h,left:a.x+10,cssClass:"vi-regular vi-tooltip-A"};},getTooltipContent:function(a){return this.iStatus;},showTooltip:function D(a,b){if(a.target===this.iStatusNode){this._super(a,b);}}});mstrmojo.ME.MetricEditBox.VALIDATION_STATUS=Q;mstrmojo.ME.MetricEditBox.VALIDATION_STATUS_CSS=G;mstrmojo.ME.MetricEditBox.VALIDATION_STATUS_DESC=R;}());(function(){mstrmojo.requiresCls("mstrmojo.Container","mstrmojo._HasLayout","mstrmojo.vi.ui.rw.selectors._IsLevelList","mstrmojo.ui.Pulldown","mstrmojo.vi.ui.rw.selectors.SearchableCheckList","mstrmojo.Box","mstrmojo.Widget","mstrmojo.Button.newWebButton","mstrmojo.css");var G=mstrmojo.Widget,F=mstrmojo.Button.newWebButton,C=mstrmojo.css;var E="all";mstrmojo.vi.ui.rw.selectors.LevelCheckList=mstrmojo.declare(mstrmojo.Container,[mstrmojo._HasLayout,mstrmojo.vi.ui.rw.selectors._IsLevelList],{scriptClass:"mstrmojo.vi.ui.rw.selectors.LevelCheckList",markupString:'<div id="{@id}" style="{@cssText}" class="mstrmojo-vi-sel-LevelCheckList {@cssClass}"><div class="level-control"></div><div class="level-container"></div><div class="level-buttonBar"></div></div>',markupSlots:{controlNode:function B(){return this.domNode.firstChild;},containerNode:function A(){return this.domNode.children[1];},buttonBarNode:function D(){return this.domNode.lastChild;}},markupMethods:{onvisibleChange:G.visibleMarkupMethod,onheightChange:G.heightMarkupMethod,onwidthChange:G.widthMarkupMethod,onapplyEnabledChange:function(){var I=this.applyEnabled;C.toggleClass(this.domNode,"noApply",!I);this.layoutConfig.h.buttonBarNode=I?"36px":"0px";this.doLayout();}},layoutConfig:{h:{controlNode:"30px",containerNode:"100%"},w:{controlNode:"100%",containerNode:"100%",buttonBarNode:"100%"},xt:true},children:[{scriptClass:"mstrmojo.ui.Pulldown",slot:"controlNode",alias:"levelPulldown",cssClass:"level",isHostedWithin:false,bindings:{levels:"this.parent.levels",level:"this.parent.level"},onlevelsChange:function(I){var L=this.level,J=parseInt(L,10)>=0,K=I.value;this.set("items",this.parent.getLevels(K));this.selectItemByField("v",(J&&!K[L])?E:L);},onlevelChange:function(I){this.selectItemByField("v",I.value);},onitemSelected:function(I){this.parent.set("level",I.v);}},{scriptClass:"mstrmojo.vi.ui.rw.selectors.SearchableCheckList",slot:"containerNode",alias:"checklist",bindings:{level:"this.parent.level"}},{scriptClass:"mstrmojo.Box",slot:"buttonBarNode",alias:"buttons",children:[F(mstrmojo.desc(134,"Apply"),function(){var I=this.parent.parent;if(I.applyEnabled){I.handleSelectionSubmit(true);}},true),F(mstrmojo.desc(221,"Cancel"),function(){this.parent.parent.handleSelectionSubmit(false);},false)]}],getCheckList:function H(){return this.checklist;}});}());(function(){mstrmojo.requiresCls("mstrmojo.ui.PopupButton","mstrmojo.vi.ui.rw.selectors._IsLevelList","mstrmojo.ui.ButtonBar","mstrmojo.ui.PopupWidget","mstrmojo.vi.ui.rw.selectors.SearchableCheckList","mstrmojo.Box","mstrmojo.Widget","mstrmojo.Button.newWebButton","mstrmojo.css");var O=mstrmojo.Widget,K=mstrmojo.Button.newWebButton,D=mstrmojo.dom,Q=mstrmojo.css;var R="expand";function F(){var S=this.docSelector.model;if(S&&!this.refreshListener){this.refreshListener=S.attachEventListener("panelDisplaying",this.id,function(U){this.refresh();S.detachEventListener(this.refreshListener);});}}function I(d){var S=this.domNode.offsetWidth,a=Array.prototype.slice.call(d.itemsContainerNode.childNodes),W=0,Z=a[W],e=1,U=a.length-1,b=a[U],c=U-1;if(S===0){F.call(this);return ;}if(U===e+1){b.style.display="none";}var X=function(g){var f=g.offsetWidth;return f>0?Math.max(f+6,50):0;},V=a.map(function(f){return X(f);}),Y=V.reduce(mstrmojo.array.fnReduceNumber);if(Y>S+V[U]){while(Y>S){if(c===e){Z.title=Z.innerHTML;Z.innerHTML="";Y-=V[W];Y+=V[W]=X(Z);break;}else{a[c].style.display="none";Y-=V[c];c--;}}}else{b.style.display="none";Y-=V[U];}this.set("hiddenLevel",d.items[c+1].v);a.forEach(function(g,f){g.style.width=(V[f]/Y)*S+"px";});}function G(S){var V=this.parent.parent,U=parseInt(this.hiddenLevel,10)||0;this.set("items",V.getLevels(this.levels).filter(function(W){return W.v>=U;}));this.selectItemByField("v",U);}mstrmojo.vi.ui.rw.selectors.LevelPopupList=mstrmojo.declare(mstrmojo.ui.PopupButton,[mstrmojo.vi.ui.rw.selectors._IsLevelList],{scriptClass:"mstrmojo.vi.ui.rw.selectors.LevelPopupList",markupString:'<div id="{@id}" style="{@cssText}" class="mstrmojo-vi-sel-LevelPopupList {@cssClass}"><div class="level-control"></div><div class="level-container"></div></div>',markupSlots:{controlNode:function J(){return this.domNode.firstChild;},containerNode:function M(){return this.domNode.lastChild;}},markupMethods:{onvisibleChange:O.visibleMarkupMethod,onheightChange:O.heightMarkupMethod,onwidthChange:O.widthMarkupMethod,onapplyEnabledChange:function(){var S=this.getPopupWidget(),U=this.applyEnabled;if(S.hasRendered){Q.toggleClass(S.domNode,"noApply",!U);}else{Q[(U?"remove":"add")+"WidgetCssClass"](S,"noApply");}}},isHostedWithin:false,anchorSlot:"controlNode",hiddenLevel:R,children:[{scriptClass:"mstrmojo.ui.ButtonBar",slot:"controlNode",alias:"levelList",multiSelect:false,showIcon:false,selectionPolicy:"reselect",bindings:{levels:"this.parent.levels"},onlevelsChange:function(S){this.set("items",this.parent.getLevels(S.value));},postselectionChange:function(b){var V=b.added&&b.added[0],c=this.items[V];if(c){var a=this.parent,W=a.getPopupWidget(),U=c.v,S=U===R;if(!S){a.set("level",U);}a.openPopupWidget(S);if(W.visible){var X=this._getItemNode(V),Y=X.offsetLeft,Z=(X.offsetWidth-W.domNode.offsetWidth)/2;if(V===0){Y+=Math.max(Z,0);}else{if(V>=this.items.length-2){Y+=Z+Math.min(Z,0);}else{Y+=Z;}}W.offsetLeft=Y;W.domNode.style.left=Y+"px";}}}},{scriptClass:"mstrmojo.ui.PopupWidget",alias:"popupList",visible:false,autoCloses:false,adjustCornersForPopupOverflow:function P(){var S=mstrmojo._IsPopup.adjustCornersForPopupOverflow.call(this);this.adjustCheckListForPopupOverflow(S);this.domNode.style.left=this.offsetLeft+"px";return S;},adjustCheckListForPopupOverflow:function L(V){var Y=this.domNode,X,U,W=this.checklist,a=W&&(W.scrollNode||W.scrollboxNode);if(V&&a){X=D.position(Y);U=X.y;if(U+X.h>D.position(document.body).h){var S=Y.offsetHeight,Z=a&&a.offsetHeight;a.style.maxHeight=D.getMaxScrollHeight()-(S-Z)+"px";W.updateScrollbars();}}},shouldPropagateLockHover:function(){return false;},children:[{scriptClass:"mstrmojo.ui.Pulldown",alias:"levelPulldown",isHostedWithin:false,visible:false,bindings:{levels:"this.parent.parent.levels",hiddenLevel:"this.parent.parent.hiddenLevel"},onlevelsChange:G,onhiddenLevelChange:G,onvisibleChange:function(S){var U=this.getSelectedItem();if(S.value&&U){this.parent.parent.set("level",U.v);}},onitemSelected:function(S){this.parent.parent.set("level",S.v);}},{scriptClass:"mstrmojo.vi.ui.rw.selectors.SearchableCheckList",alias:"checklist",bindings:{level:"this.parent.parent.level"}},{scriptClass:"mstrmojo.Box",alias:"buttons",children:[K(mstrmojo.desc(134,"Apply"),function(){var S=this.parent.parent.parent;if(S.applyEnabled){S.handleSelectionSubmit(true);S.closePopup();}},true),K(mstrmojo.desc(221,"Cancel"),function(){var S=this.parent.parent.parent;S.handleSelectionSubmit(false);S.closePopup();},false)]}]}],getPopupWidget:function B(){return this.popupList;},getCheckList:function H(){return this.getPopupWidget().checklist;},getLevels:function E(S){var U=this._super(S);U[0].cls="iconRA-selItem";U.push({v:R,cls:"iconRA-epdItem"});return U;},preBuildRendering:function A(){var S=this.getPopupWidget(),U=this.labelCssText;this._super();if(S.cssText.indexOf(U)===-1){S.cssText+=U;}},postBuildRendering:function N(){this._super();this.closePopup();I.call(this,this.levelList);},openPopupWidget:function C(V){var S=this.getPopupWidget(),U=this.getCheckList();if(!S.visible){S.levelPulldown.set("visible",V);this.openPopup(S);Q.toggleClass(U.domNode,"strikeout",!this.include);U.updateScrollbars();}else{this.closePopup();}}});}());(function(){mstrmojo.requiresCls("mstrmojo.ObjectInputBox","mstrmojo.ACL.UserDataService");mstrmojo.ACL.UserInputBox=mstrmojo.declare(mstrmojo.ObjectInputBox,null,{suggestionPopupCssClss:"mstrmojo-ACLInputBox-suggest",blockCount:10,useKeyDelay:true,getACLUserDataService:function C(){return mstrmojo.ACL.UserDataService;},item2textCss:function A(D){return(this._super&&this._super(D))||"mstrmojo-ACLInputBox-user "+{8704:"u",8705:"ug"}[D.st]||"";},getCandidatesThroughTaskCall:function B(E,D){this.getACLUserDataService().searchUserCandidates(E.pattern,!E.isVerify,E.blockCount,D);}});})();(function(){mstrmojo.requiresCls("mstrmojo.expr","mstrmojo.mstr.EnumNodeProperties","mstrmojo.fe.FilterExprTree","mstrmojo.fe.AndOrNode","mstrmojo.fe.RelationNode","mstrmojo.fe.DynamicNode","mstrmojo.fe.ConditionNode");var M=mstrmojo.expr.ET,K=mstrmojo.mstr.EnumNodeProperties;mstrmojo.fe.RelationFilterExprTree=mstrmojo.declare(mstrmojo.fe.FilterExprTree,null,{scriptClass:"mstrmojo.fe.RelationFilterExprTree",nodeClassMap:{14:mstrmojo.fe.AndOrNode,15:mstrmojo.fe.RelationNode,ph:mstrmojo.fe.DynamicNode,"*":mstrmojo.fe.ConditionNode},getItemIdentityProp:function(N){if(N.node&K.CONDITION){return"*";}if(N.ph){return"ph";}if((N.et===10||N.et===12)&&N.dmt===4){return M.RLS;}return N.et;},isEditable:function L(O){var N=false;switch(O&&O.et){case M.RLS:N=true;break;}return N||this._super(O);},getItemConfig:function B(Q,N,R){var O=this._super(Q,N,R),P=(Q.et===M.RLS||!!Q.relation);if(P){O.itemFunction=R.itemFunction;}return O;},newCondition:function F(P){var O=this.getSelectedItemWidget(),N=0;if((typeof microstrategy!=="undefined")&&microstrategy.bones&&microstrategy.bones.rwb_viewer){N=microstrategy.bones.rwb_viewer.nextPhIndex;}else{if(mstrApp&&mstrApp.docModelData&&mstrApp.docModelData.phIndex){N=mstrApp.docModelData.phIndex;}}if(P&&P.ph&&!P.ph.idx){P.ph.idx=N++;}if(O&&O.selected&&O.newCondition){return O.newCondition(P);}else{return this._super(P);}},createSet:function E(O,N){var P=N.rq,Q=N.cq;if(P&&Q){this.remove(Q);if(N.isMetric){mstrmojo.hash.copyProps(["applySubExpr","dmy","dmt","relation","useSchema"],P,Q);P=Q;}else{P.nds=[Q];}this.add([P],O[0]);}},removeSet:function I(N){var O=N.data,P=[O];this.remove(O);if(O.nds&&O.nds.length>0){P=O.nds;}else{delete O.dmy;delete O.relation;delete O.applySubExpr;delete O.relation;delete O.useSchema;delete O.dmt;}this.add(P,0);},nameFactory:{counter:1,names:{},clear:function(){this.resetCounter();this.names={};},resetCounter:function D(){this.counter=1;},isNameExist:function J(N){return !!this.names[N];},setName:function H(N,O){this.names[N]=O;},changeName:function C(O,N,P){this.removeName(O);this.setName(N,P);},getNewName:function G(Q,P,S){var R=P||"",O=S||"",N;while(this.isNameExist(R+this.counter+O)){this.counter++;}N=R+this.counter+++O;this.names[N]=Q;return N;},removeName:function A(N){delete this.names[N];this.resetCounter();}}});})();(function(){mstrmojo.requiresCls("mstrmojo.Editor");var B=null;function A(D){if(!B){B=new mstrmojo.IVEDatasetPicker({onRender:function C(){var F=false;this.btnImport.set("visible",F);this.newLabel.set("visible",F);this.useExistingLabel.set("visible",F);this.btnHBox.destroyChildren();var E=mstrmojo.Button.newWebButton(mstrmojo.desc(8708,"OK"),function(){B.close(B.item);},true);E.cssText="margin-right: 10px";E.bindings={enabled:function(){return !!this.parent.parent.item;}};var G=mstrmojo.Button.newWebButton(mstrmojo.desc(221,"Cancel"),function(){B.close();},false);this.btnHBox.addChildren([E,G]);}});B.render();}B.onClose=function(E){if(E){D(E);}};B.open();}mstrmojo.vi.ui.SelectDatasetWizardEditor=mstrmojo.declare(mstrmojo.Editor,null,{scriptClass:"mstrmojo.vi.ui.SelectDatasetWizardEditor",title:mstrmojo.desc(11677,"Select a Dataset"),cssClass:"mstrmojo-SelectDatasetWizardEditor",callback:mstrmojo.emptyFn,children:[{scriptClass:"mstrmojo.Label",text:mstrmojo.desc(11678,"Selecting Existing Dataset"),cssClass:"SelectDatasetWizardEditor-h1"},{scriptClass:"mstrmojo.Label",text:mstrmojo.desc(11679,"Browse Dataset..."),cssClass:"SelectDatasetWizardEditor-entry",onclick:function(){var C=this.parent;A(function(D){C.callback(D);});}},{scriptClass:"mstrmojo.Label",text:mstrmojo.desc(11680,"Import New Data"),cssClass:"SelectDatasetWizardEditor-h2"},{scriptClass:"mstrmojo.Label",text:mstrmojo.desc(3250,"File..."),cssClass:"SelectDatasetWizardEditor-entry"},{scriptClass:"mstrmojo.Label",text:mstrmojo.desc(11681,"URL..."),cssClass:"SelectDatasetWizardEditor-entry"},{scriptClass:"mstrmojo.Label",text:mstrmojo.desc(11480,"Database..."),cssClass:"SelectDatasetWizardEditor-entry"},{scriptClass:"mstrmojo.Label",text:mstrmojo.desc(3190,"Freeform SQL"),cssClass:"SelectDatasetWizardEditor-entry"},{scriptClass:"mstrmojo.Label",text:mstrmojo.desc(11682,"Salesforce..."),cssClass:"SelectDatasetWizardEditor-entry"},{scriptClass:"mstrmojo.Label",text:mstrmojo.desc(11683,"More Data Sources..."),cssClass:"SelectDatasetWizardEditor-entry"},{scriptClass:"mstrmojo.Label",text:mstrmojo.desc(11684,"Create New Dataset"),cssClass:"SelectDatasetWizardEditor-h2"},{scriptClass:"mstrmojo.Label",text:mstrmojo.desc(11685,"Enter Data Manually..."),cssClass:"SelectDatasetWizardEditor-entry"},{scriptClass:"mstrmojo.Label",text:mstrmojo.desc(11686,"Browse All Objects..."),cssClass:"SelectDatasetWizardEditor-entry last"},{scriptClass:"mstrmojo.HTMLButton",cssClass:"mstrmojo-Editor-button",iconClass:"mstrmojo-Editor-button-Close",text:mstrmojo.desc(221,"Cancel"),onclick:function(){this.parent.close();}}]});})();(function(){mstrmojo.requiresCls("mstrmojo.hash","mstrmojo.array","mstrmojo.css","mstrmojo.string","mstrmojo.fe.RelationNode","mstrmojo.fe.RelationFilterExprTree","mstrmojo.mstr.EnumDSSXMLObjectTypes","mstrmojo.mstr.EnumNodeDimty","mstrmojo.Box","mstrmojo.ui.Pulldown","mstrmojo.Label","mstrmojo.vi.ui.toolbars.TitleToolbar","mstrmojo.vi.ui.toolbars._HasToolbar");mstrmojo.requiresDescs(2790,5895,5896,7931,12036,12037,15121,15122);var F=mstrmojo.hash,A=mstrmojo.array,G=mstrmojo.mstr.EnumDSSXMLObjectTypes,H=mstrmojo.mstr.EnumNodeDimty,C=mstrmojo.css,E=mstrmojo.string,D=function(P){var Q=P.data,O=Q.dmy&&Q.dmy.uts||[],L=O.length,K=[],N,M;for(N=0;N<L;N++){K.push(E.encodeHtmlString(O[N].n));}M=K.join(", ");return'<span class="mstrmojo-text" title="'+M+'">'+M+"</span>";};var I=function(){var M=mstrmojo.desc(2790,"Set of ##"),L=M.split("##")[0];var K=L.length;if(K>0&&L[K-1]===" "){L+="&nbsp;";}return L;};mstrmojo.vi.ui.editors.fe.RelationNode=mstrmojo.declare(mstrmojo.fe.RelationNode,[mstrmojo.vi.ui.toolbars._HasToolbar],{scriptClass:"mstrmojo.vi.ui.editors.fe.RelationNode",markupString:'<div id="{@id}" class="mstrmojo-relation {@cssClass}"  style="position:relative;{@cssText}" mstrAttach:mousedown><div class="mstrmojo-onhoverparent mstrmojo-relation-prefix {@cssClass}"><span class="mstrmojo-textset mstrmojo-relation-prefix-text" mstrAttach:click></span><span class="mstrmojo-onhover-in mstrmojo-andor-tools {@cssClass}"><span class="mstrmojo-indent" onclick="mstrmojo.all[\'{@id}\'].ind()">'+mstrmojo.desc(5895,"Group conditions")+'</span><span class="mstrmojo-outdent" onclick="mstrmojo.all[\'{@id}\'].out()">'+mstrmojo.desc(5896,"Ungroup Conditions")+'</span></span></div><div class="mstrmojo-relationNode"><div class="mstrmojo-relationNode-inf"><div class="mstrmojo-relation-prefix-text">'+I()+'</div><div class="mstrmojo-textset"  mstrAttach:click></div><div class="mstrmojo-relation-prefix-text">'+(mstrmojo.desc(2790,"Set of ##").split("##")[1]||"")+'</div><div class="mstrmojo-relation-postfix-text">'+mstrmojo.desc(15121,"filtered by")+'</div><div class="mstrmojo-relation-related-by-box"></div><div class="mstrmojo-relation-toolbar"></div><img class="mstrmojo-del" src="../images/1ptrans.gif" title="'+mstrmojo.desc(7931,"Delete condition")+'"onclick="mstrmojo.all[\'{@id}\'].del()" /></div><div class="mstrmojo-relation-childTreeNode" style="position:relative;"></div></div></div>',markupSlots:{prefixHoverNode:function(){return this.domNode.firstChild;},prefixNode:function(){return this.domNode.firstChild.firstChild;},relationNode:function(){return this.domNode.lastChild;},textNode:function(){return this.domNode.childNodes[1].firstChild.childNodes[1];},relatedByBoxNode:function(){return this.domNode.childNodes[1].firstChild.childNodes[4];},toolbarNode:function(){return this.domNode.childNodes[1].firstChild.childNodes[5];},containerNode:function(){return this.domNode.childNodes[1].childNodes[1];}},markupMethods:{onprefixedAndOrEditableChange:function(){C.toggleClass(this.prefixNode,["editable"],this.prefixedAndOrEditable);},onselectedChange:function(){C.toggleClass(this.relationNode,["selected"],this.selected);},ondataChange:function(){this.prefixNode.innerHTML=this.andOrTxt();this.textNode.innerHTML=D(this);}},children:[{scriptClass:"mstrmojo.fe.RelationFilterExprTree",alias:"childTree",ignoreLayout:true,dropZone:false,draggable:false,nodeClassMap:{14:mstrmojo.fe.AndOrNode,ph:mstrmojo.fe.DynamicNode,"*":mstrmojo.fe.ConditionNode},onNew:function(K){this.parent.tree.onNew(K);},getItemConfig:function(N,K,O){var L=mstrmojo.fe.RelationFilterExprTree.prototype.getItemConfig.call(this,N,K,O),M=O.tree||O;return F.copy({tree:M,rootTree:this.parent.tree,noRelation:true,inRelation:true,onremove:function(){if(this.rootTree&&this.rootTree.onremove){this.rootTree.onremove();}},onadd:function(){if(this.rootTree&&this.rootTree.onadd){this.rootTree.onadd();}}},L);},prenodeclick:function(K){if(!K||!K.part){return ;}var L=this.rootTree;if(L&&L.onnodeclick&&this.editable){K.editor=L.editor;L.onnodeclick.call(this,K);}}},{scriptClass:"mstrmojo.Box",alias:"relBox",slot:"relatedByBoxNode",cssClass:"RelatedBy-Box",cssDisplay:"inline-block",children:[{scriptClass:"mstrmojo.Label",text:mstrmojo.desc(12036,"Related by"),cssClass:"Label",cssDisplay:"inline-block"},{scriptClass:"mstrmojo.ui.Pulldown",alias:"relPd",cssClass:"Pulldown",cssDisplay:"inline-block",isHostedWithin:false,allowHTML:false,onitemSelected:function B(O){var N=this.parent.parent,L=N.data,K=null;if(this.selectedIndex>0){K={n:O.n,did:O.did,t:O.t||G.Metric,st:O.st||1024};}L.dmt=H.NodeDimtyOutputLevel;L.dmy=L.dmy||{};var M=L.relation=L.relation||{};if(K){M.guide=K;L.useSchema=false;}else{delete M.guide;delete M.rsTp;delete M.joTp;delete M.paTp;delete M.erTp;L.useSchema=true;}N.set("data",L);}}]},{scriptClass:"mstrmojo.vi.ui.toolbars.TitleToolbar",slot:"toolbarNode",alias:"toolbar",visible:true,hasContextMenuButton:true,cssClass:"relation-toolbar",cssDisplay:"inline-block"}],_set_data:function(N,S){var O=this._super(N,S);var L=this.data,P=!L.m,K=this.relBox.relPd,Q=A.filter(this.tree.editor.targetMetrics,function(V){return !V.um;}),U=[{n:mstrmojo.desc(12037,"System Default"),t:-1,did:"default"}].concat(Q);this.relBox.set("visible",P);if(P){var R=0;if(L.relation&&L.relation.guide){var M=L.relation.guide;R=A.find(U,"did",M.did);}if(R!==K.selectedIndex){K.set("items",U);K.set("selectedIndex",R>=0?R:0);}}return O;},updateToolbar:function J(K){var L=this;if(this._super){K=this._super(K);}K.addMenuItem(mstrmojo.desc(15122,"Convert to Condition"),"convert",function(){L.parent.removeSet(L);});K.isHostedWithin=false;return K;}});}());(function(){mstrmojo.requiresCls("mstrmojo.dom","mstrmojo.array","mstrmojo.hash","mstrmojo.func","mstrmojo.Button","mstrmojo.HTMLButton","mstrmojo.HBox","mstrmojo.List","mstrmojo.Label","mstrmojo.ListMapperHoriz","mstrmojo.WidgetList","mstrmojo.WidgetListMapper","mstrmojo.TristateCheckBox","mstrmojo.Pulldown","mstrmojo.ACL.UserTreeBrowser","mstrmojo.DataGrid","mstrmojo.DropDownButton","mstrmojo.ListBox","mstrmojo.DivItemRenderer","mstrmojo.VBox","mstrmojo.Box","mstrmojo.ACL.UserInputBox","mstrmojo.Editor","mstrmojo.ACL.UserDataService","mstrmojo.CheckList","mstrmojo.TextBox","mstrmojo.TextBoxWithLabel","mstrmojo.CheckBox","mstrmojo.MouseOverContainer","mstrmojo.util.LibraryHelper");mstrmojo.requiresDescs(1825,8078,8079,629,8080,8081,8082,3336,9048,8083,8084,955,8085,531,8086,8087,8088,8089,8090,767,2056,8091,8093,1442,221,8092,13621,9772,9773,9774,272,271,8145,2509,8146,8147,9775,9776,9777,9771,12299,9151,2156,9892,9890,9891,9099,2140,2102);var W=mstrmojo.dom,E=mstrmojo.css,q=mstrmojo.array,r=mstrmojo.util.LibraryHelper,j=[],x=[{n:mstrmojo.desc(16034,"Grant"),v:0},{n:mstrmojo.desc(16035,"Deny"),v:1},{n:mstrmojo.desc(8441,"Default"),v:2}],Y="sharingEditor",u=199,X="294DEDC011D2F1D56000D98E67019608",I="C82C6B1011D2894CC0009D9F29718E4F",F=[1,4,8,16,32,64,128],B=[mstrmojo.desc(1825,"Browse"),mstrmojo.desc(8078,"Read"),mstrmojo.desc(8079,"Write"),mstrmojo.desc(629,"Delete"),mstrmojo.desc(8080,"Control"),mstrmojo.desc(8081,"Use"),mstrmojo.desc(8082,"Execute")],f=["B","R","W","D","C","U","E"],h=false,w=true,Z=257,v=1024,b=772,d=776,O=777,l=mstrmojo.Button.newWebButton,t=mstrmojo.Button.newActionButton;function g(AB,AC,AA){return{scriptClass:"mstrmojo.HBox",alias:AB,right:AC,cssText:"height:20px;",children:[{scriptClass:"mstrmojo.Label",text:AA,cssText:"width:80px"},{scriptClass:"mstrmojo.Pulldown",cssText:"width:100px",itemIdField:"v",items:x,defaultSelection:2,selectionPolicy:"reselect",_set_value:function(AE,AD){this.value=AD;}}]};}function V(AA){return(AA&&AA.t===8);}function z(AA){return AA&&AA.st!=Z&&AA.st!=v&&AA.st!=b&&AA.st!=d&&AA.st!=O;}function N(AA){return{"253000":255000,"253":255,"221":223,"197":199,"69":71}[AA]||AA;}function K(AA){return{"253000":255000,"253":255,"32221":223,"56197":199}[AA]||AA;}function c(AG){var AF=[].concat(AG.acls),AA=AG.inhs,AE=AG.acls,AI,AC,AH,AB,AD;AE.splice(0,AE.length);if(V(AG)){AF=AF.concat(mstrmojo.hash.valarray(AA));}for(AB=0,AD=AF.length;AB<AD;AB++){AI=AF[AB];AH=AI.rgt;if(AH>1000){AC=mstrmojo.hash.copy(AI);AC.den=true;AC.rgt=Math.floor(AH/1000);AE.push(AC);}if((AH%1000)>0){AC=mstrmojo.hash.copy(AI);AC.den=false;AC.rgt=AH%1000;AE.push(AC);}}return AG;}function U(AB){var AA={isSerializable:function(AE,AD,AC){switch(AE){case"did":case"rgt":case"n":case"acls":case"t":case"st":case"inh":case"den":return true;}return false;},getArrItemName:function(AE,AC,AD){if(AE==="acls"){return"acl";}},convertBoolean:true};return mstrmojo.string.json2xml("oi",AB,AA);}function o(AF,AE){var AC=AF&&AF.oi,AB,AA,AG,AD=AF.oneTierConnectivity;if(AC){AC=c(AC);AB=U(AC);AG={taskId:"saveObjectACL",objectXML:AB,objectType:AC.t,objectID:AC.did,propagateToChildren:AF.childrenAccessPulldown.value};AA={success:function(AH){if(AE){AF.close();}else{mstrmojo.alert(mstrmojo.desc(3336,"## has been saved successfully.").replace("##",AH.n));AF.set("hasChanged",false);}},failure:function(AH){if(AH.getReponseHeader){mstrmojo.alert(AH.getResponseHeader("X-MSTR-TaskFailureMsg"));}if(AE){AF.close();}}};if(AD){delete AG.taskId;AG.connectionId=AD.connectionId;AG.sessionState=AD.sessionState;AD.connectivityProxy.saveObjectACL(AG,mstrmojo.func.wrapMethods(AA,{failure:function(AH){mstrmojo.onetier.vi.prefs.handleErrorMessage(AH);}}));}else{mstrmojo.xhr.request("POST",mstrConfig.taskURL,AA,AG);}}}function p(AI){var AM=AI.aclList,AN=AI.objectInputer,AD=AN.getSelectedObjects(),AF=AD.length,AJ=[],AC,AL=199,AB,AK,AA;if(!AN.isValid()){mstrmojo.alert(mstrmojo.desc(9048,"Some users/groups do not exist. Please remove them in order to proceed."),null,AI.alertTitle);return false;}for(AB=0;AB<AF;AB++){AC=AD[AB];if(AC.did===X||AC.did===I){var AE=mstrmojo.all[Y];if(AL===AE.currentPublicRight){if(w){E.removeClass(AE.userMessage.domNode,"hideMsg");}}}AK=q.find(AM.items,"did",AC.did);if(AK!==-1){AA=AM.items[AK];if(AI.uneditableRights[AA.rgt]){continue;}}AJ.push(new mstrmojo.Obj({n:AC.n,did:AC.did,st:AC.st,rgt:AL,newItem:true}));}if(AJ.length>0){var AH=q.findMulti(AM.items,"did",AJ);if(AH.count){var AG=AH.indices.concat().sort(q.numSorter).slice(0,AH.count);for(AB=AG.length-1;AB>-1;AB--){AM.remove(AG[AB]);}}AM.add(AJ);AI.set("hasChanged",true);}AN.set("items",[]);return true;}function P(AA){var AC=[],AF=Math.floor(AA/1000),AD=AA%1000,AG=F,AH=B,AE=AG.length,AI,AB;for(AB=0;AB<AE;AB++){AC.push(AH[AB]);AC.push(" ");if((AD&AG[AB])>0){AC.push(mstrmojo.desc(8083,"Granted"));}else{if((AF&AG[AB])>0){AC.push(mstrmojo.desc(8084,"Denied"));}else{AC.push(mstrmojo.desc(959,"Default"));}}AC.push(",");}AI=AC.join("");return AI.substring(AI,AI.length-1);}function k(AH){var AE=[],AG=AH%1000,AC=F,AF=f,AA=AC.length,AD,AB;for(AB=0;AB<AA;AB++){if((AG&AC[AB])>0){AE.push(AF[AB]);AE.push(",");}}AD=AE.join("");return AD.substring(AD,AD.length-1);}function R(AC,AD){var AE=AC.items,AB=q.find(AE,AC.itemIdField,AD),AG=AC.customItem,AA=AE.length-2;if(AB===-1){var AF={n:k(AD),rgt:AD};if(AG){AE.splice(AA,1);}AA=AE.length-1;AE.splice(AA,0,AF);AC.customItem=AF;}else{if(AG&&AB!==AA){AE.splice(AA,1);AC.customItem=null;}}if(mstrmojo.all[Y].showACLHint!==false){AC.set("title",P(AD));}AC.value=AD;}function C(AA){return{"776":[{n:mstrmojo.desc(8085,"Consume"),rgt:71},{n:mstrmojo.desc(531,"Add"),rgt:199},{n:mstrmojo.desc(8086,"Collaborate"),rgt:223},{n:mstrmojo.desc(8087,"Full control"),rgt:255},{n:mstrmojo.desc(8088,"Denied all"),rgt:255000},{n:mstrmojo.desc(8089,"Custom ..."),rgt:-1}],"779":[{n:mstrmojo.desc(8085,"Consume"),rgt:71},{n:mstrmojo.desc(531,"Add"),rgt:199},{n:mstrmojo.desc(8086,"Collaborate"),rgt:223},{n:mstrmojo.desc(8087,"Full control"),rgt:255},{n:mstrmojo.desc(8088,"Denied all"),rgt:255000},{n:mstrmojo.desc(8089,"Custom ..."),rgt:-1}]}[AA]||[{n:mstrmojo.desc(8090,"View"),rgt:199},{n:mstrmojo.desc(767,"Modify"),rgt:223},{n:mstrmojo.desc(8087,"Full control"),rgt:255},{n:mstrmojo.desc(8088,"Denied all"),rgt:255000},{n:mstrmojo.desc(8089,"Custom ..."),rgt:-1}];}function S(AH,AF){var AE="";if(AF){var AB=this.widthInput.value,AI=this.heightInput.value,AA=' src="'+AH,AJ="",AC=this.toolbarOptions.checkBoxList,AG=AC.items,AD;for(AD=0;AD<AG.length;AD++){if(!AC.selectedIndices.hasOwnProperty(AD)){if(AJ==""){AJ="&hiddensections="+AG[AD].alias;}else{AJ+=","+AG[AD].alias;}}}AE='<iframe width="'+AB+'" ';AE+='height="'+AI+'" ';AE+=AA;AE+=AJ;AE+='"></iframe>';}else{AE='<iframe width="640" height="480" src="';AE+=AH;AE+='&hiddensections=header,path,dockTop,dockLeft,footer"></iframe>';}return AE;}function n(AC){var AE=mstrmojo.string.parseUri(AC).queryKey,AF=AC.indexOf("?"),AB=AF>0?AC.substring(0,AF):AC;var AA=AB.indexOf(";jsessionid");AB=AA>0?AB.substring(0,AA):AB;if(AE.hasOwnProperty("iframe")){delete AE.iframe;}if(AE.hasOwnProperty("validateRandNum")){delete AE.validateRandNum;}if(!AE.hasOwnProperty("server")){AE.Server=encodeURIComponent(mstrApp.serverName);}if(!AE.hasOwnProperty("Project")){AE.Project=encodeURIComponent(mstrmojo.string.decodeHtmlString(mstrApp.projectName));}if(!AE.hasOwnProperty("port")){AE.Port=mstrApp.serverPort;}if(h&&mstrConfig.shareToGuestWhenEnabled){AE.connmode=8;AE.ru=1;}if(AE.evt!=="3185"){AE.share=1;}AB+="?";for(var AD in AE){AB+=AD+"="+AE[AD]+"&";}AB=AB.substring(0,AB.length-1);return AB;}function M(AA){AA.select();document.execCommand("copy");AA.value=AA.value;mstrmojo.alert(mstrmojo.desc(15340,"The link has been successfully copied to your clipboard"));}function D(AB,AA){return(r.isLibraryConfigured()&&(AB===55||(AB===18&&AA&&AA.contains("documentID"))));}function H(AC,AB,AA){if(AB===18&&D(AB,AA)){var AD=mstrmojo.string.parseUri(AA).queryKey;AC=AD.documentID;}return AC;}function a(AC,AB){var AD=window.location.protocol,AA="mailto:?body="+window.encodeURIComponent(AB)+"&subject="+encodeURI(AC.objectName);if(mstrApp.isSingleTier){window.FormWrapper.openPage(AA);}else{if(!!W.isChrome&&AD==="https:"){window.open(AA,"_self");window.setTimeout("iframe.hideWaitPage()",2000);}else{window.open(AA,"mailtoIframe");}}}function L(AB){var AA;switch(AB){case 199:AA="read";break;case 223:AA="write";break;case 255:AA="full";break;case 255000:AA="deny";break;default:AA="custom";}return"sharingEditor-privilegeIcon "+AA;}function J(AD){var AA=new Date(),AC=this.objectName+" "+AA.toLocaleDateString()+" "+AA.toLocaleTimeString(),AB=this,AE={success:function(AH){var AG=n(AH.url);AB.topSection.authorLinkRow.authorLinkBox.set("value",AG);AB.url=AG;AB.topSection.htmlPanel.htmlLinkRow.htmlBox.set("value",S(AG));var AF=AB.topSection.authorEmail.emailLink;AF.set("url",window.encodeURIComponent(AG));AF.set("name",AB.objectName);},failure:function(AF){mstrmojo.alert(AF.getResponseHeader("X-MSTR-TaskFailureMsg"));},complete:function(){AB.hideWait();if(AD){var AF="mailto:?body="+window.encodeURIComponent(AB.url)+"&subject="+encodeURI(AB.objectName);var AG=mstrApp.openPage||mstrmojo._IsWebApp.openPage;AG(AF,"mailtoIframe");}}};this.showWait();mstrmojo.xhr.request("POST",mstrConfig.taskURL,AE,{taskId:"savePersonalView",messageID:this.mid,objectType:this.oi.t,subName:AC,objectSubType:0,viewMode:this.viewMode||0,isPVPublic:true});}function e(AD){var AB=this.getAvailableRightsForSelection(),AA=AB.length,AC;for(AC=0;AC<AA;AC++){if(AB[AC].rgt===AD){return AB[AC].n;}}return mstrmojo.desc(2056,"Custom");}function Q(AA){return(((AA.acg&32)>0)&&((AA.acg&8)>0));}mstrmojo.SharingEditor=mstrmojo.declare(mstrmojo.Editor,null,{scriptClass:"mstrmojo.SharingEditor",cssClass:"mstrmojo-SharingEditor",showSharingOptions:true,showButtonBar:true,showPublisAccess:true,hasChanged:false,help:"sharing_dialog_box.htm",zIndex:199,defaultRight:223,showButtonText:true,uneditableRights:{},currentPublicRight:199,userSelectorTitle:mstrmojo.desc(8091,"User/User Group Browser"),showLinkOnOpen:true,closeEditorAfterSave:true,allowHTMLTitle:true,init:function(AA){Y=AA.id||Y;this._super(AA);},onShowLink:function(AD){var AA=["libraryLink","showLink","htmlCode"];for(var AC=0;AC<AA.length;AC++){if(AA[AC]!==AD){var AB=this.topSection.tabDock[AA[AC]];AB.set("selected",false);E.removeClass(AB.domNode,"selected");}}},showWait:mstrmojo.emptyFn,hideWait:mstrmojo.emptyFn,checkPublicAccess:function(){var AH=this.oi.acls,AC,AK=q.find(AH,"did",I),AF=this.aclList.itemsContainerNode,AG=this.publicAccessSection.publicLabel,AE,AJ=false,AA=q.find(AH,"did",X),AI;if(AK!==-1&&h&&AA!==-1){var AB=AH[AK].rgt,AD=AH[AA].rgt;if(AB===AD){AJ=true;AI=AD;}}if(AK!==-1&&!h){AJ=true;AI=AH[AK].rgt;}AE=AF.children[0].tBodies;if(h&&AE[AA]){E.toggleClass(AE[AA].rows[0],"hide",AJ);}if(AE[AK]){E.toggleClass(AE[AK].rows[0],"hide",AJ);}AG.set("checked",AJ);if(AI){this.set("currentPublicRight",AI);}},oncurrentPublicRightChange:function(){var AA=this.publicAccessSection.publicMouseOver;AA.publicRight.set("value",this.currentPublicRight);AA.publicRightLabel.set("text",e.call(this,this.currentPublicRight));},onOpen:function(){var AL=this.oi,AC=AL.n,AJ=AL.t,AM=AL.acls,AE=this.topSection,AH=AE.tabDock,AD=false;var AF=H(AL.did,AJ,this.href);if(this.objectId&&this.objectId===AF&&!this.isLinkDirty){AD=true;}this.objectId=AF;this.objectName=AC;this.set("showACL",!!AM);h=this.guestModeEnabled;if(z(AL)&&this.showSharingOptions){if(!AD){if(this.href&&!this.isLinkDirty){var AB=!this.urlReady?n(this.href):this.href,AI=AE.authorEmail.emailLink;this.url=AB;AI.set("url",window.encodeURIComponent(AB));AI.set("name",AC);AE.htmlPanel.htmlLinkRow.htmlBox.set("value",S(AB));AE.authorLinkRow.authorLinkBox.set("value",AB);}else{J.call(this);this.set("isLinkDirty",false);}if(D(AJ,this.href)){var AB=r.constructLibraryUrl(AF);var AK=AE.libraryLaunchButtons.libraryEmailLink;this.libraryUrl=AB;AE.libraryLinkRow.libraryLinkBox.set("value",this.libraryUrl);AK.set("url",window.encodeURIComponent(AB));AK.set("name",AC);}}if(this.initTab=="shareByLinkMSTRLibrary"){this.onShowLink("libraryLink");AH.libraryLink.set("selected",true);E.addClass(AH.libraryLink.domNode,"selected");}else{if(this.initTab=="shareByLinkEmbed"){this.onShowLink("htmlCode");AH.htmlCode.set("selected",true);E.addClass(AH.htmlCode.domNode,"selected");}else{this.onShowLink("showLink");AH.showLink.set("selected",true);E.addClass(AH.showLink.domNode,"selected");}}}this.set("title",mstrmojo.desc(8093,"share").replace("##",mstrmojo.string.encodeHtmlString(AC)));if(AM){this.checkPublicAccess();var AN=this.objectInputer,AG=this.userSelector,AA=AG&&AG.userBrowser;AN.zIndex=this.zIndex;if(AA&&AA.hasRendered){AG.opener=this;AA.set("items",[]);AA.getContent(AA);}this.set("hasChanged",false);}this.aclList.updateScrollbars();this.positionDialog();},_set_hasChanged:function(AC,AA){var AB=(AA!==this.hasChanged);this.hasChanged=AA;if(AA===true){this.checkPublicAccess();return AA;}return AB;},_set_oi:function(AB,AA){this.oi=this.preProcessACLs(AA);return true;},postCreate:function(){this.oi=this.preProcessACLs(this.oi);},getAvailableRightsForSelection:function(){return C(this.oi.st);},preProcessACLs:function(AH){if(AH&&AH.acls){var AF=AH.acls,AE=AF&&AF.length,AG=V(AH),AB={},AI,AA,AC,AD;if(AG){AC={};AH.inhs=AC;}for(AD=0;AD<AE;AD++){AI=new mstrmojo.Obj(AF[AD]);if(AI.den){AI.rgt=AI.rgt*1000;}if(AG&&AI.inh){AC[AI.n]=mstrmojo.hash.copy(AI);continue;}AA=AB[AI.n];if(!AA){AA=mstrmojo.hash.copy(AI);AA.rgt=0;delete AA.den;AB[AI.n]=AA;}AA.rgt=AA.rgt+AI.rgt;if(AA.rgt>255000){AA.rgt=Math.floor(AA.rgt/1000)*1000;}}AF=mstrmojo.hash.valarray(AB);AH.acls=AF;}return AH;},getACLItems:function(){var AD=this.aclList&&this.aclList.items,AB=[];for(var AC=0,AA=AD.length;AC<AA;AC++){AB.push(AD[AC]);}return AB;},onClose:function(){var AA=this.objectInputer;AA.set("items",[]);this.aclList.clearSelect();this.onShowLink("showLink");},getACLUserDataService:function m(){return mstrmojo.ACL.UserDataService;},userSelector:{scriptClass:"mstrmojo.Editor",cssClass:"mstrmojo-UserEditor",help:"user_group_browser.htm",onClose:function(){this.userBrowser.clearTreeSelect();},children:[{scriptClass:"mstrmojo.ACL.UserTreeBrowser",alias:"userBrowser",getACLUserDataService:function m(){return this.parent.opener.getACLUserDataService();},updateTreeContent:function(AB,AD){AB.contentRetrieved=true;var AC=AD[AB.itemChildrenField],AA=AB.tree||AB,AF=AD.bc,AE=AD.sz,AG=AD.bb;if(AF!==-1){if(AG+AF<=AE){AC.push(AA.nextItemCreaterFunc());}if((AG-AF)>-1){AC.unshift(AA.prevItemCreaterFunc());}}AB.blockBegin=AG;AA.initializing=true;AB.clearSelect(false);AB.set("items",AC);AB.setSelectedItems(AA.getTotalSelections(),true);AA.initializing=false;},selectionAcrossBranch:true,multiSelect:true},{scriptClass:"mstrmojo.HBox",cssClass:"mstrmojo-Editor-buttonBox",slot:"buttonNode",children:[{scriptClass:"mstrmojo.HTMLButton",cssClass:"mstrmojo-Editor-button",iconClass:"mstrmojo-Editor-button-OK",text:mstrmojo.desc(1442,"OK"),onclick:function(AB){var AA=this.parent.parent,AF=AA.opener,AE=AF.objectInputer,AD=AA.userBrowser,AC=AD.getTotalSelections();if(AC&&AC.length>0){AE.add(AC,AE.items.length-1);}AA.close();},preBuildRendering:function(){if(!this.parent.parent.opener.showButtonText){this.set("text","");}}},{scriptClass:"mstrmojo.HTMLButton",cssClass:"mstrmojo-Editor-button",iconClass:"mstrmojo-Editor-button-Cancel",text:mstrmojo.desc(221,"Cancel"),onclick:function(AA){this.parent.parent.close();},preBuildRendering:function(){if(!this.parent.parent.opener.showButtonText){this.set("text","");}}}]}],onOpen:function(){this.set("title",this.opener.userSelectorTitle);}},customACL:{scriptClass:"mstrmojo.Editor",title:mstrmojo.desc(8092,"Custom Permission Level"),cssClass:"mstrmojo-CustomACLEditor",help:"Custom_Permission_Level_dialog_box.htm",onOpen:function(){var AG=this.rgt,AH=Math.floor(AG/1000),AF=AG%1000,AC=this.children,AD,AE,AB,AA;for(AB=0,AA=7;AB<AA;AB++){AD=AC[AB];AE=AD.right;if((AF&AE)>0){AD.children[1].value=0;}else{if((AH&AE)>0){AD.children[1].value=1;}else{AD.children[1].value=2;}}}this.refresh();},getACLValue:function(){var AE=0,AF=0,AC=this.children,AD,AB,AA;for(AB=0,AA=7;AB<AA;AB++){AD=AC[AB];if(AD.children[1].value==0){AE+=AD.right;}else{if(AD.children[1].value==1){AF+=AD.right;}}}return AF*1000+AE;},children:[g("browse",1,mstrmojo.desc(1825,"Browse")),g("read",4,mstrmojo.desc(8078,"Read")),g("write",8,mstrmojo.desc(8079,"Write")),g("delete",16,mstrmojo.desc(629,"Delete")),g("control",32,mstrmojo.desc(8080,"Control")),g("use",64,mstrmojo.desc(8081,"Use")),g("execute",128,mstrmojo.desc(8082,"Execute")),{scriptClass:"mstrmojo.HBox",cssClass:"mstrmojo-Editor-buttonBox",slot:"buttonNode",children:[{scriptClass:"mstrmojo.HTMLButton",cssClass:"mstrmojo-Editor-button",iconClass:"mstrmojo-Editor-button-OK",text:mstrmojo.desc(1442,"OK"),onclick:function(AA){var AB=this.parent.parent;if(AB.onOK){AB.onOK();}AB.close();}},{scriptClass:"mstrmojo.HTMLButton",cssClass:"mstrmojo-Editor-button",iconClass:"mstrmojo-Editor-button-Cancel",text:mstrmojo.desc(221,"Cancel"),onclick:function(AA){var AB=this.parent.parent;if(AB.onCancel){AB.onCancel();}AB.close();}}]}]},children:[{scriptClass:"mstrmojo.Box",alias:"topSection",cssClass:"sharingEditor-topSection",bindings:{visible:function(){return z(this.parent.oi)&&this.parent.showSharingOptions;}},children:[{scriptClass:"mstrmojo.HBox",alias:"tabDock",cssClass:"sharingEditor-tabDock",bindings:{visible:function(){return z(this.parent.parent.oi)&&this.parent.parent.showSharingOptions;}},children:[{scriptClass:"mstrmojo.Label",alias:"showLink",text:mstrmojo.desc(9773,"Link"),cssClass:"SharingEditor-ShowLink",selected:false,onclick:function(AA){var AB=this.parent.parent.parent;if(!this.selected){AB.onShowLink(this.alias);this.set("selected",true);E.addClass(this.domNode,"selected");}},},{scriptClass:"mstrmojo.Label",alias:"libraryLink",text:mstrmojo.desc(15572,"Library link"),cssClass:"SharingEditor-libraryLink",selected:false,onclick:function(AA){var AB=this.parent.parent.parent;if(!this.selected){AB.onShowLink(this.alias);this.set("selected",true);E.addClass(this.domNode,"selected");}},bindings:{visible:function(){return D(this.parent.parent.parent.oi.t,this.parent.parent.parent.href);}}},{scriptClass:"mstrmojo.Label",cssClass:"SharingEditor-ShowHtml",alias:"htmlCode",text:mstrmojo.desc(9774,"Show HTML"),selected:false,onclick:function(AA){var AB=this.parent.parent.parent;if(!this.selected){AB.onShowLink(this.alias);this.set("selected",true);E.addClass(this.domNode,"selected");}}}]},{scriptClass:"mstrmojo.Box",alias:"htmlPanel",cssClass:"mstrmojo-SharingEditor-html-panel",children:[{scriptClass:"mstrmojo.HBox",alias:"htmlLinkRow",cssClass:"SharingEditor-LinkRow",children:[{scriptClass:"mstrmojo.TextBox",alias:"htmlBox",cssClass:"SharingEditor-Html"},{scriptClass:"mstrmojo.Button",alias:"copyHtmlLink",cssClass:"SharingEditor-CopyHtmlLink",onclick:function(AA){var AB=this.parent.htmlBox.inputNode;M(AB);},bindings:{visible:"this.parent.parent.parent.tabDock.htmlCode.selected"}}]},{scriptClass:"mstrmojo.Label",alias:"IframeSize",text:mstrmojo.desc(9735,"Size:"),cssClass:"SharingEditor-Html-Size"},{scriptClass:"mstrmojo.TextBoxWithLabel",alias:"widthInput",label:mstrmojo.desc(272,"Width:"),value:640,onvalueChange:function(AA){var AB=this.parent,AC=mstrmojo.all[Y];AB.htmlLinkRow.htmlBox.set("value",S.call(AB,AC.url,true));}},{scriptClass:"mstrmojo.TextBoxWithLabel",label:mstrmojo.desc(271,"Height:"),alias:"heightInput",value:480,onvalueChange:function(){var AA=this.parent,AB=mstrmojo.all[Y];AA.htmlLinkRow.htmlBox.set("value",S.call(AA,AB.url,true));}},{scriptClass:"mstrmojo.HBox",alias:"toolbarOptions",cssClass:"SharingEditor-toolbarRow",children:[{scriptClass:"mstrmojo.Label",alias:"IframeShow",text:mstrmojo.desc(15341,"Show:"),cssClass:"SharingEditor-Html-Show"},{scriptClass:"mstrmojo.CheckListHoriz",alias:"checkBoxList",items:[{n:mstrmojo.desc(8145,"Navigation bar"),alias:"path"},{n:mstrmojo.desc(2509,"Toolbar"),alias:"dockTop"},{n:mstrmojo.desc(8146,"Tools panel"),alias:"dockLeft"},{n:mstrmojo.desc(8147,"Footer"),alias:"footer"}],multiSelect:true,onselectionChange:function(AA){var AB=this.parent.parent,AC=mstrmojo.all[Y];AB.htmlLinkRow.htmlBox.set("value",S.call(AB,AC.url,true));}}]}],bindings:{visible:"this.parent.tabDock.htmlCode.selected"}},{scriptClass:"mstrmojo.HBox",alias:"authorLinkRow",cssClass:"SharingEditor-LinkRow",bindings:{visible:function(){return this.parent.tabDock.showLink.selected;}},children:[{scriptClass:"mstrmojo.TextBox",alias:"authorLinkBox",cssClass:"SharingEditor-Link",},{scriptClass:"mstrmojo.Button",alias:"authorCopyLink",cssClass:"SharingEditor-CopyLink",onclick:function(AA){var AB=this.parent.authorLinkBox.inputNode;M(AB);}},]},{scriptClass:"mstrmojo.HBox",alias:"libraryLinkRow",cssClass:"SharingEditor-LinkRow",bindings:{visible:function(){return this.parent.tabDock.libraryLink.selected;}},children:[{scriptClass:"mstrmojo.TextBox",alias:"libraryLinkBox",cssClass:"SharingEditor-Link",},{scriptClass:"mstrmojo.Button",alias:"libraryCopyLink",cssClass:"SharingEditor-CopyLink",onclick:function(AA){var AB=this.parent.libraryLinkBox.inputNode;M(AB);}},]},{scriptClass:"mstrmojo.HBox",alias:"libraryLaunchButtons",cssClass:"SharingEditor-LaunchButtons",bindings:{visible:function(){return this.parent.tabDock.libraryLink.selected;}},children:[{scriptClass:"mstrmojo.Widget",markupString:'<div id = "{@id}" class ="sharingEditor-launchLink" style="{@cssText}" mstrAttach:click>'+mstrmojo.desc(15334,"Launch")+' <iframe name="launchToIframe" target="_blank" style="display:none"></iframe> </div>',alias:"launchLink",onclick:function(){var AA=this.parent.parent.parent;r.createTokenAndOpenLink(AA.libraryUrl);},bindings:{visible:function(){return this.parent.parent.tabDock.libraryLink.selected&&this.parent.parent.parent.oi.t==55;}}},{scriptClass:"mstrmojo.Widget",markupString:'<div id = "{@id}" class ="sharingEditor-emailLink" style="{@cssText}"" mstrAttach:click>'+mstrmojo.desc(15333,"Email Link")+' <iframe name="mailtoIframe" style="display:none"></iframe> </div>',alias:"libraryEmailLink",onclick:function(){var AA=this.parent.parent.parent;if(!AA.libraryUrl){r.constructLibraryUrl(AA.objectId);}else{a(AA,AA.libraryUrl);}}}]},{scriptClass:"mstrmojo.HBox",alias:"authorEmail",cssClass:"SharingEditor-LaunchButtons email",bindings:{visible:function(){return this.parent.tabDock.showLink.selected;}},children:[{scriptClass:"mstrmojo.Widget",markupString:'<div id = "{@id}" class ="sharingEditor-emailLink" style="{@cssText}"" mstrAttach:click>'+mstrmojo.desc(15333,"Email Link")+' <iframe name="mailtoIframe" style="display:none"></iframe> </div>',alias:"emailLink",onclick:function(){var AA=this.parent.parent.parent;if(!AA.url||AA.isLinkDirty){J.call(AA,true);AA.set("isLinkDirty",false);}else{a(AA,AA.url);}}}]}]},{scriptClass:"mstrmojo.Label",text:mstrmojo.desc(9775,"Who Has Access"),cssClass:"SharingEditor-title",bindings:{visible:"this.parent.showACL"}},{scriptClass:"mstrmojo.Label",alias:"userMessage",text:mstrmojo.desc(9771,"The permission you added is already granted"),cssClass:"sharingEditorUserMessage hideMsg",bindings:{visible:"this.parent.showACL"},onclick:function(){E.addClass(this.domNode,"hideMsg");w=false;}},{scriptClass:"mstrmojo.Box",cssClass:"sharingEditor-ACLUserPanel",bindings:{visible:"this.parent.showACL"},children:[{scriptClass:"mstrmojo.HBox",cssClass:"sharingEditor-CPSection",children:[{scriptClass:"mstrmojo.ACL.AddUserInputBox",emptyText:mstrmojo.desc(15335,"Type to add users or groups here..."),getACLUserDataService:function m(){return this.parent.parent.parent.getACLUserDataService();},noCache:true,postCreate:function(){var AA=this.parent.parent.parent;if(AA){this.zIndex=AA.zIndex+1;}},onRender:function(){var AA=this.parent.parent.parent;if(AA){AA.objectInputer=this;}},bindings:{enabled:function(){return Q(this.parent.parent.parent.oi);}}},t(mstrmojo.desc(1825,"Browse"),function(AA){var AB=this.parent.parent.parent;AB.openPopup("userSelector",{zIndex:AB.zIndex+10});},{bindings:{enabled:function(){return Q(this.parent.parent.parent.oi);}}})]}]},{scriptClass:"mstrmojo.HBox",alias:"publicAccessSection",cssClass:"sharingEditor-publicAccessSection",bindings:{visible:"this.parent.showACL && this.parent.showPublisAccess"},children:[{scriptClass:"mstrmojo.CheckBox",alias:"publicLabel",cssClass:"SharingEditor-Public",bindings:{label:function(){if(this.parent.parent.guestModeEnabled){return mstrmojo.desc(9776,"Public (Login not required)");}return mstrmojo.desc(9777,"Everyone (Login not required)");},enabled:function(){return Q(this.parent.parent.oi);}},oncheckedChange:function(){E.toggleClass(this.domNode.children[1],"label-disabled",!this.checked);},getUserGroupsInfo:function(){if(h){this.getUserGroupFromTaskCall(X);}this.getUserGroupFromTaskCall(I);},getUserGroupFromTaskCall:function(AG){var AC=mstrmojo.all[Y],AD=AC.aclList,AE=AC.getACLUserDataService(),AF=function(AI){var AH=new mstrmojo.Obj({n:AI.n,did:AI.did,st:AI.st,rgt:u,newItem:true});j.push(AH);},AB=function(AH){},AA=function(){if(!h||(h&&j.length==2)){AD.add(j);AC.set("hasChanged",true);}};AE.getMembers({blockBegin:0,blockCount:1,outputElements:1,data:{did:AG}},{success:AF,failure:AB,complete:AA});},onclick:function(){var AB=mstrmojo.all[Y];var AC=AB.aclList.items;var AD=q.find(AC,"did",I);if(AD!==-1){AC.remove(AD);}var AA=q.find(AC,"did",X);if(h&&AA!==-1){AC.remove(AA);}if(this.checked===true){if(j.length<1){this.getUserGroupsInfo();}else{mstrmojo.array.forEach(j,function(AE){AE.rgt=u;});AC.add(j);AB.set("hasChanged",true);}}else{AB.set("currentPublicRight",u);AB.set("hasChanged",true);}}},{scriptClass:"mstrmojo.MouseOverContainer",alias:"publicMouseOver",setupSelectedItem:function A(){this.mouseoverItem=this.publicRight;this.mouseoutItem=this.publicRightLabel;},bindings:{visible:"this.parent.publicLabel.checked",enabled:function(){return Q(this.parent.parent.oi);}},children:[{scriptClass:"mstrmojo.Label",markupMethods:{oncssClassChange:function(){this.domNode.className="mstrmojo-Label "+this.cssClass;}},bindings:{cssClass:function(){return L(this.parent.parent.parent.currentPublicRight);}}},{scriptClass:"mstrmojo.Label",alias:"publicRightLabel",cssClass:"sharingEditor-rightLabel",bindings:{text:function(){var AA=this.parent.parent.parent;return e.call(AA,AA.currentPublicRight);},enabled:function(){return Q(this.parent.parent.parent.oi);}}},{scriptClass:"mstrmojo.Pulldown",cssClass:"sharingEditor-pulldown",itemIdField:"rgt",alias:"publicRight",visible:false,postCreate:function(){this.items=this.parent.parent.parent.getAvailableRightsForSelection();},bindings:{value:"this.parent.parent.parent.currentPublicRight",enabled:function(){return Q(this.parent.parent.parent.oi);}},selectionPolicy:"reselect",onvalueChange:function(){var AA=this.parent;var AB=AA.parent.parent;AA.publicRightLabel.set("text",e.call(AB,this.value));},_set_value:function(AF,AB){var AC=this.value,AA=(AC!==AB);if(AA){if(AB===-1){var AE=this.parent.parent.parent,AD=this;AE.openPopup("customACL",{zIndex:AE.zIndex+10,rgt:AC,twoStates:true,onOK:function(){AD.set("value",this.getACLValue());},onCancel:function(){AD.set("value",AC);}});return false;}AB=K(AB);R(this,AB);this.updatePublicRight(AB);return true;}return true;},updatePublicRight:function(AB){var AC=this.parent.parent.parent;if(AC.aclList){var AD=AC.aclList.items;var AA=q.find(AD,"did",X);var AE=q.find(AD,"did",I);if(h&&AA!==-1){AD[AA].rgt=AB;}if(AE!==-1){AD[AE].rgt=AB;}AC.set("hasChanged",true);AC.set("currentPublicRight",AB);}}}]}]},{scriptClass:"mstrmojo.DataGrid",alias:"aclList",cssClass:"aclList",renderOnScroll:false,makeObservable:true,itemDisplayField:"n",itemIdField:"did",dropZone:true,bindings:{items:function(){return this.parent.oi.acls||[];},visible:"this.parent.showACL"},onremove:function(AB){var AF=this.parent.oi;var AE=this;window.setTimeout(function(){AE.updateScrollbars();},10);if(!V(AF)){return ;}var AG=AF.inhs,AD=AB.value,AA=AD&&AD.length,AH,AC;for(AC=0;AC<AA;AC++){AH=AD[AC].n;delete AG[AH];}},onadd:function(AB){var AF=this.parent.oi;var AE=this;window.setTimeout(function(){AE.updateScrollbars();},10);if(!V(AF)){return ;}var AG=AF.inhs,AD=AB.value,AA=AD&&AD.length,AH,AC;for(AC=0;AC<AA;AC++){AH=AD[AC].n;AG[AH]=mstrmojo.hash.copy(AD[AC]);AG[AH].inh=true;}},onACLChanged:function(AB){var AA=this.parent.oi;this.parent.set("hasChanged",true);if(!V(AA)){return ;}if(this.parent.childrenAccessPulldown.value==1){AA.inhs[AB.n]=mstrmojo.hash.copy(AB);AA.inhs[AB.n].inh=true;}},columns:[{dataFunction:function(AC,AA,AB){return'<div class="mstrmojo-ACLEditor-user '+(AC.st===8705?"ug":"u")+'">'+mstrmojo.string.encodeHtmlString(AC.n)+"</div>";}},{dataWidget:{scriptClass:"mstrmojo.MouseOverContainer",alias:"mouseOverContainer",bindings:{enabled:function(){return Q(this.parent.parent.parent.oi);}},setupSelectedItem:function A(){this.mouseoverItem=this.dataGridPulldown;this.mouseoutItem=this.dataGridLabel;},children:[{scriptClass:"mstrmojo.Label",markupMethods:{oncssClassChange:function(){this.domNode.className="mstrmojo-Label "+this.cssClass;}},bindings:{cssClass:function(){return L(this.parent.parent.data.rgt);}}},{scriptClass:"mstrmojo.Label",cssClass:"sharingEditor-rightLabel",alias:"dataGridLabel",bindings:{text:function(){return e.call(mstrmojo.all[Y],this.parent.parent.data.rgt);},enabled:function(){return Q(this.parent.parent.parent.parent.oi);}}},{scriptClass:"mstrmojo.HBox",alias:"dataGridPulldown",cssClass:"sharingEditor-datagridContainer",visible:false,children:[{scriptClass:"mstrmojo.Pulldown",cssClass:"sharingEditor-datagridPulldown",itemIdField:"rgt",popupToBody:true,selectionPolicy:"reselect",popupZIndex:1001,postCreate:function(){this.markupMethods=mstrmojo.hash.copy({ondataChange:function(){var AA=this.parent.parent.data;this.set("value",AA[this.itemIdField]);},onvisibleChange:function(){this.domNode.style.display=this.visible?"block":"none";if(!this.visible&&this.popupRef){this.popupRef.set("visible",false);}}},mstrmojo.hash.copy(this.markupMethods));this.items=this.parent.parent.dataGrid.parent.getAvailableRightsForSelection();},_set_value:function(AF,AB){var AC=this.value,AA=(AC!==AB);if(AA){if(AB===-1){var AE=this.parent.parent.dataGrid.parent,AD=this;AE.openPopup("customACL",{zIndex:AE.zIndex+10,rgt:AC,twoStates:!!this.parent.parent.data.newItem,onOK:function(){AD.set("value",this.getACLValue());},onCancel:function(){AD.set("value",AC);}});return false;}AB=N(AB);R(this,AB);this.parent.parent.data.set(this.itemIdField,AB);if(AC!==null){this.parent.parent.dataGrid.onACLChanged(this.parent.parent.data);}return true;}return true;},bindings:{enabled:function(){return Q(this.parent.parent.parent.parent.parent.oi);}}},{scriptClass:"mstrmojo.Button",cssClass:"mstrmojo-ACLEditor-delete",text:"&nbsp",title:mstrmojo.desc(629,"Delete"),onclick:function(AA){var AB=this,AC=function(){var AD=AB.parent.parent.dataGrid;AD.remove(AB.parent.parent.data);AD.parent.set("hasChanged",true);};mstrmojo.confirm(mstrmojo.desc(12299,"Are you sure you want to delete the user/user group #?").replace("#",this.parent.parent.data.n),{confirmBtn:{fn:AC}},{zIndex:2000});},bindings:{enabled:function(){return Q(this.parent.parent.parent.parent.parent.oi);}}}]}]}}]},{scriptClass:"mstrmojo.Label",text:mstrmojo.desc(9892,"Children Access"),cssClass:"SharingEditor-title",bindings:{visible:function(){return this.parent.showACL&&V(this.parent.oi);}}},{scriptClass:"mstrmojo.Pulldown",alias:"childrenAccessPulldown",value:0,items:[{n:mstrmojo.desc(9890,"Preserve children's access control lists"),idx:0},{n:mstrmojo.desc(9891,"Overwrite children's access control lists"),idx:1}],itemIdField:"idx",bindings:{visible:function(){return this.parent.showACL&&V(this.parent.oi);}}},{scriptClass:"mstrmojo.HBox",cssClass:"Editor-buttonBox",slot:"buttonNode",bindings:{visible:"this.parent.showButtonBar"},children:[l(mstrmojo.desc(8473,"Done"),function(AA){var AB=this.parent.parent;if(p(AB)){o(AB,AB.closeEditorAfterSave);}},true,{iconClass:"mstrmojo-Editor-button-OK",bindings:{visible:"this.parent.parent.showACL",enabled:function(){return Q(this.parent.parent.oi)&&this.parent.parent.hasChanged;},text:function(){return mstrmojo.desc(8473,"Done");}},preBuildRendering:function(){if(!this.parent.parent.showButtonText){this.set("text","");}}}),l("",function(AA){var AB=this.parent.parent;AB.close();AB.set("hasChanged",false);},false,{iconClass:"mstrmojo-Editor-button-Close",bindings:{iconClass:function(){var AA=this.parent.parent;if(AA.hasChanged){return"mstrmojo-Editor-button-Cancel";}return"mstrmojo-Editor-button-Close";},text:function(){return mstrmojo.desc(2140,"Cancel");}}})]}]});mstrmojo.ACL.AddUserInputBox=mstrmojo.declare(mstrmojo.ACL.UserInputBox,null,{scriptClass:"mstrmojo.ACL.AddUserInputBox",add:function G(AB,AA){var AC=this.parent.parent.parent;this._super(AB,AA);p(AC);},});}());(function(){mstrmojo.requiresCls("mstrmojo.vi.ui.tabs.TabStrip","mstrmojo.vi.ui.tabs.Tab","mstrmojo.Label","mstrmojo.Button","mstrmojo.Pulldown","mstrmojo.Box","mstrmojo.dom","mstrmojo.css","mstrmojo.tooltip","mstrmojo.ME.MetricEditBox","mstrmojo.array","mstrmojo.hash","mstrmojo.mstr.EnumDSSXMLBaseFormType");var f=mstrmojo.array,N=mstrmojo.hash,M=mstrmojo.ME.MetricToken.brackets,B=mstrmojo.css,S=mstrmojo.vi.ui.tabs.Tab.ACTIONS,n=S.DELETE+S.RENAME,o=mstrmojo.ME.MetricEditBox.VALIDATION_STATUS,p=mstrmojo.ME.MetricEditBox.VALIDATION_STATUS_CSS,O=mstrmojo.ME.MetricEditBox.VALIDATION_STATUS_DESC,W=mstrmojo.mstr.EnumDSSXMLObjectTypes,D=mstrmojo.string,r="This@ID",Y="45C11FA478E745FEA08D781CEA190FE5",V=mstrmojo.mstr.EnumDSSXMLBaseFormType,u=[{n:mstrmojo.desc(959,"Default"),v:V.DssXmlBaseFormReserved},{n:mstrmojo.desc(12276,"String"),v:V.DssXmlBaseFormText},{n:mstrmojo.desc(2052,"Date"),v:V.DssXmlBaseFormDate},{n:mstrmojo.desc(3434,"Number"),v:V.DssXmlBaseFormNumber}],Z=function(){var z="analytical_engine_version.htm",x=mstrApp.showHelpTopic;if(x){x(z,"upgrade");}else{window.open(mstrmojo.upgradeHelpPath()+z,"_blank");}};function H(x){return{n:x,k:x,ftk:[],vs:1,is:"",bft:V.DssXmlBaseFormReserved,bftp:V.DssXmlBaseFormReserved};}function Q(AE,AF,x,AC){var AA=AE.forms[AF]||{},AD=AE.forms[x],z=AE.inputBox,AB=AE.statusBox.pulldownBox.pulldown;if(AF!==x){AA.vs=AE.vStatus;AA.is=AE.iStatus;AA.bft=AE.formType||AB.getSelectedItem().v;AA.bftp=AE.formType||AB.getSelectedItem().v;AA.ftk=z.items;AE.set("vStatus",o.UNKNOWN);}AE.set("vStatus",AD.vs);AE.set("iStatus",AD.is);AE.updateInputBoxItems({items:AD.ftk});if(AE.curFormIdx!==x){AE.curFormIdx=x;AE.tabstrip.setSelectedTab(AD.k);}AB.set("selectedIndex",f.find(AB.items,"v",AD.bft));AE.raiseEvent({name:"tabSwitch",tks:AD.ftk,vs:AD.vs,is:AD.is,bft:AD.bft,bftp:AD.bftp,oidx:AF,nidx:x,toNewTab:AC});}function P(z){var x=z.forms[z.curFormIdx];if(x){x.ftk=z.inputBox.items;x.vs=z.vStatus;x.is=z.iStatus;}}var m=0;function c(x){m=Math.max(x.length-1,m);}function b(){m=0;}function t(x){var z="DESC"+(m?" "+m:"");m++;if(f.find(x,"n",z)>=0){return t(x);}return z;}function J(AB){var AA={v:M(AB.n),oi:AB,isNew:true},z,x;if(AB.t===12){z=f.filter(AB.fs,function(AC){return AC.obf||AB.da;}).length;if(z===1){x=AB.fs[0];AA=N.copy({v:M(AB.n)+"@"+M(x.fnm),ift:true,exv:x.fid,extp:8},AA);}else{AA=N.copy({v:M(AB.n)+"@",ift:true},AA);}}return AA;}function E(z,x){z.set("enabled",!x);var AA="mstrmojo-InlineWaitIcon";if(z.iconClass){z.set("iconClass",z.iconClass.replace(new RegExp(AA),"")+" "+(x?AA:""));}else{mstrmojo.css.toggleClass(z.domNode,AA,x);}}function L(x){return x.tp===33||x.tp===37;}function F(x){return x.tp===-1;}var a=function(AE){var AC=AE.items,z=AC.length,AB,AD,AA=[],x="";AA.push({v:"!",tp:33,lv:4,sta:2});for(AB=0;AB<z;AB++){AD=AC[AB];if((AB===0&&L(AD))||F(AD)){continue;}if(AD.isNew&&!AD.oi){x+=AD.v;}else{if(!D.isEmpty(x)){AA.push({v:x,tp:2,lv:1});x="";}if(AD.v&&AD.v.indexOf(r)>=0){AD.v=AD.v.replace("["+r+"]",r);AD.exv=Y;AD.extp=8;delete AD.oi;}AA.push(AD);}}if(!D.isEmpty(x)){AA.push({v:x,tp:2,lv:1});x="";}AA.push({v:"",tp:-1,lv:4,sta:2});return{items:AA};},g=function(AA){var x=AA.items||[],z=x[x.length-1];if(z&&z.tp===-1){x.pop();}if(x[0]&&L(x[0])){x.splice(0,1);}f.forEach(x,function(AB){if(AB.v&&AB.v.indexOf(r)>=0){N.copy({extp:8,exv:Y,oi:{n:"This",did:"This",t:12}},AB);}});},e=function(x){if(!x){return o.VALID;}return{"-2147214845":o.ERROR,"-2147214846":o.AMBIGUITY}[x]||o.ERROR;},U=function(AA){AA=a(AA);var z={items:true,v:true,tp:true,lv:true,oi:true,n:true,did:true,t:true,st:true,exv:true,extp:true,asc:true,vtp:true},x={getArrItemName:function(){return"tkn";},isSerializable:function(AB){return(z[AB])?true:false;}};return D.json2xml("tknstrm",AA,x);},G=function(AA,AD,AC,z){var AB=U(AD),AE=function(AF){if(AF&&AF.tks){var AG=AF.tks;g(AG);AG.vs=e(AG.rjec);AG.tokenXML=AB;if(z){z(AG);}}},x=function(AF){mstrmojo.alert(AF.message||AF.getResponseHeader&&AF.getResponseHeader("X-MSTR-TaskFailureMsg"));};mstrmojo.ME.MetricDataService.validateMetric({tokenStreamXML:AB,localSymbolFolderXML:"",metricXML:"",metricId:AA||"",isNew:true,objectType:12,isIDForm:AC,msgID:mstrApp.getMsgID()},{success:AE,failure:x});};mstrmojo.ME.DerivedAttributeFormTab=mstrmojo.declare(mstrmojo.vi.ui.tabs.Tab,null,{scriptClass:"mstrmojo.ME.DerivedAttributeFormTab",valid:true,editable:true,postBuildRendering:function X(){if(this._super){this._super();}var x=this,z=x.lbl;z.editOnDoubleClick=this.editable;z.onTextEditComplete=function(AB,AA){if(x.validate(z.text)){x.titleEdited(z.text,AA);}};},onclick:function l(x){var z=mstrmojo.dom.eventTarget(x.hWin,x.e);if(z===this.menuBtnNode){this.tabDeleted();}else{if(!this.isSelected){this.tabSelected();}}},validate:function(x){var z=!/[\[\]\"\\]/g.test(x);if(!z){this.lbl.set("isEditing",true);}this.set("valid",z);return z;},showErrTooltip:function w(AC,AA){var x=mstrmojo.dom.position(this.domNode),z=this,AB=z.errTooltip;if(!AB){z.errTooltip=AB=new mstrmojo.Tooltip({contentNodeCssClass:"me-tooltip-content up me-err",updatePopupConfig:null});this.addDisposable(AB);}AB.set("top",x.y+x.h+2);AB.set("left",x.x+x.w/2-AA);AB.set("content",'<div class="content"><span>'+AC+"</span></div>");AB.open();window.setTimeout(function(){AB.close();},2500);},onvalidChange:function(){if(this.valid){this.hideTooltip();}else{this.showErrTooltip(mstrmojo.desc(11569,"Input contains invalid character"),95);}}});function k(AB,AC,AD){var AA=f.find(AC,"k",AD.k);return{scriptClass:"mstrmojo.ME.DerivedAttributeFormTab",title:AD.n,draggable:false,editable:AA!==0,cssClass:"mstrmojo-AEB-Tab "+(AA===0?"mstrmojo-AEB-IDTab":""),getMenuActions:function(){return n;},tabSelected:function(){Q(AB,AB.curFormIdx,AA);},titleEdited:function z(AF,AE){if(AF!==AE){if(f.find(AB.forms,"n",AF)>=0){this.showErrTooltip(mstrmojo.desc(7209,"Name already exists"),69);}else{var AG=AB.forms[AA];AG.n=AF;AB.set("dirty",true);}}},tabDeleted:function x(){var AE=AB.forms.length,AH=(AB.curFormIdx===AE-1)?0:AB.curFormIdx,AF=AB.forms.slice(0),AG=AF[AA];if(AG&&AG.did){AB.delForms.push({n:AG.n,did:AG.did});}AF.splice(AA,1);AB.curFormIdx=AH;AB.set("forms",AF);Q(AB,-1,AH);AB.set("dirty",true);}};}mstrmojo.ME.AttributeEditBox=mstrmojo.declare(mstrmojo.ME.MetricEditBox,null,{scriptClass:"mstrmojo.ME.AttributeEditBox",markupString:'<div id="{@id}" class="mstrmojo-MEBox {@cssClass}" style="{@cssText}"><div class="mstrmojo-AEB-TabStrip"></div><div class="mstrmojo-MEBox-edit mstrmojo-AEB-edit"></div><div class="mstrmojo-AEBox-status {@statusCssClass}"></div></div>',markupSlots:{tabstripNode:function(){return this.domNode.firstChild;},editNode:function(){return this.domNode.childNodes[1];},statusNode:function(){return this.domNode.lastChild;}},markupMethods:{onvStatusChange:function(){var z=this.vStatus,AD=(z===o.VALID),AB=(z===o.UNKNOWN||z===o.VALIDATING),AA=this.statusBox.infoBox;this.validateBtn.set("visible",AB);AA.set("visible",!AB);if(!AB){AA.infoLabel.set("text",AD?mstrmojo.desc(11655,"Valid formula."):mstrmojo.desc(15953,"Validation failed."));var AC=p[z],x=AA.infoIcon.domNode;if(!B.hasClass(AC)){B.removeClass(x,[p[o.VALID],p[o.ERROR],p[o.AMBIGUITY]]);B.addClass(x,AC);}}},oniStatusChange:function(){var AA=this.vStatus,x=(AA===o.ERROR||AA===o.AMBIGUITY),z=this.statusBox.infoBox.infoIcon;z.title=x?(this.getStatusDesc&&this.getStatusDesc(AA))||O[AA]+" "+this.iStatus:"";}},forms:null,delForms:[],curFormIdx:0,attrid:null,absorbAmbiguity:false,init:function q(AB){var AC=this,AE=function(){AC.validateCurrentForm();},AA=[{scriptClass:"mstrmojo.vi.ui.tabs.TabStrip",alias:"tabstrip",position:"top",slot:"tabstripNode",isAlignRight:false,getTabCfg:function z(AH,AI,AG){return N.copy(k(AC,AH,AI),AG);},addTab:function AF(){var AI=AC.forms,AG=AI.length,AJ=t(AI),AH=AI.slice(0);AH.push(H(AJ));AC.set("forms",AH);Q(AC,AC.curFormIdx,AG,true);AC.set("dirty",true);},clear:function x(){f.forEach(this.children,function(AG){AG.hideTooltip();});}},{scriptClass:"mstrmojo.Button",alias:"clearBtn",slot:"tabstripNode",text:mstrmojo.desc(2827,"Clear"),cssClass:"mstrmojo-WebHoverButton mstrmojo-AEB-clearAll hoverLink",onclick:function(){AC.inputBox.clearTokens([]);AC.inputBox.raiseChangeEvent({type:"clear"});}},{scriptClass:"mstrmojo.Box",alias:"statusBox",slot:"statusNode",cssClass:"statusBox",children:[{scriptClass:"mstrmojo.Box",alias:"pulldownBox",cssClass:"pulldownBox",cssDisplay:"inline-block",children:[{scriptClass:"mstrmojo.Label",cssClass:"mstrmojo-AEBox-pulldownLabel AEBox-item",text:mstrmojo.desc(9918,"Data Type")},{scriptClass:"mstrmojo.ui.Pulldown",alias:"pulldown",cssClass:"mstrmojo-AEBox-pulldown AEBox-item",selectedIndex:0,items:u,onitemSelected:function(AJ){var AG=AC.curFormIdx,AH=AC.forms,AI=AH&&AH.length>AG&&AH[AG];if(AI){if(AI.bft!==AJ.v){AI.bft=AI.bftp=AJ.v;AC.set("dirty",true);}}}}]},{scriptClass:"mstrmojo.Box",cssClass:"helpIcon",cssDisplay:"inline-block",richTooltip:{cssClass:"vi-regular vi-tooltip-A A-center AE-tooltip",posType:mstrmojo.tooltip.POS_TOPCENTER,enableHover:true},useRichTooltip:true,tooltipCloseDelay:500,updateTooltipConfig:function AD(){var AH=this.richTooltip,AG=mstrmojo.dom.position(this.domNode);AH.left=AG.x+AG.w-8;AH.top=AG.y+28;AH.content=mstrmojo.desc(16313,"Data Type options for derived attribute forms are only available for data engine version 11.1 and later.");AH.content+="<br /><div class='help-link-label' onclick='mstrmojo.ME.AttributeEditBox.AEHelpFn()'>"+mstrmojo.desc(9849,"Learn More")+"</div>";}},{scriptClass:"mstrmojo.Box",alias:"infoBox",cssClass:"infoBox",cssDisplay:"inline-block",children:[{scriptClass:"mstrmojo.Button",alias:"infoIcon",cssClass:"mstrmojo-AEBox-infoIcon AEBox-item",title:"",tooltipOpenDelay:0,useRichTooltip:true,updateTooltipConfig:function(){var AG=mstrmojo.dom.position(this.domNode);this.richTooltip={cssClass:"vi-regular A-center vi-tooltip-A",top:Math.max(AG.y+26,0),left:Math.max(AG.x+10,0),posType:mstrmojo.tooltip.POS_TOPCENTER,content:this.title};}},{scriptClass:"mstrmojo.Label",alias:"infoLabel",cssClass:"mstrmojo-AEBox-infoLabel AEBox-item"}]}]}];this.validateFunc=AE;AC.children=AA.concat(this.children);this._super(AB);},item2textCss:function K(x){return this._super(x)||{21:"afm"}[x.t]||"";},onformsChange:function d(){var x=this.forms,z=x[this.curFormIdx].k;f.forEach(x,function(AA){g({items:AA.ftk});});this.tabstrip.setTabs(x,z);c(x);},selectFormTab:function A(x){Q(this,this.curFormIdx,x);},postBuildRendering:function X(){if(this._super){this._super();}this.clear();var x=this;this.inputBox.ondrop=function(AC){if(!AC.src.data||!AC.src.data.item){return ;}var AB=x.inputBox,AE=AB.ctxtBuilder.itemWidgets,AF=N.copyProps(["did","n","t","fs"],AC.src.data.item),AH=J(AF),z,AG,AA;AC.src.data=AH;mstrmojo.ListBase2.prototype.ondrop.call(this,AC);var AD=function(AI){return AI.t===W.Function&&!(!isNaN(AI.fdid)&&AI.fdid<0);};if(AD(AH.oi)){this.insertParenthesisTokens();}if(x.ontokensModify){x.ontokensModify();}z=this.selectedIndices;if(AF.t===12&&AH.ift&&!AH.exv){for(AG in z){AA=AE[AG];if(AA){AB.startTokenSuggestion(AA);}}}AB.clearSelect(true);B.removeClass(AB.domNode,"unselectable");};},clear:function j(){this.curFormIdx=0;this.delForms=[];this.attrid=null;b();this.set("forms",[H("ID")]);this.inputBox.set("items",[]);this.inputBox.resetTokensCache();this.set("vStatus",o.UNKNOWN);this.set("iStatus","");this.tabstrip.clear();},validateCurrentForm:function C(z){var AA=this,AB=this.validateBtn,x=function(AC){E(AB,false);AA.set("vStatus",AC.vs);AA.set("iStatus",AC.rjed||"");AA.updateInputBoxItems({items:AC.items});AA.statusNode.style.display="block";AA.handleValidation(AC);if(z){z(AC.items,AC.vs===o.VALID);}};AA.set("vStatus",o.VALIDATING);E(AB,true);G(this.attrid,{items:this.inputBox.items},AA.curFormIdx===0,x);},validateAllForms:function v(AA){var AB=this,z=AB.forms,x=0,AC=function(AF){var AE=(x===0);if(AF){var AD=z[x-1];AD.ftk=AF.items;AD.vs=AF.vs;AD.is=AF.rjed||"";AD.tokenXML=U({items:AF.items});if(AF.vs!==o.VALID){AB.selectFormTab(x-1);AB.handleValidation(AF);if(AA){AA(null,false);}return ;}}if(x===z.length){if(AA){AA(z,true);}return ;}G(AB.attrid,{items:z[x++].ftk},AE,AC);};P(AB);AC();},continueValidataion:function R(){this.validateCurrentForm();},getStatusDesc:function h(x){return{0:mstrmojo.desc(11655,"Valid Formula.")}[x];},onObjectInsert:function I(AB){var AC=this.inputBox,AA=J(AB),x=AC.insertTokens([AA]),z;if(AB.t===12&&AA.ift&&!AA.exv){z=AC.ctxtBuilder.itemWidgets[x];if(z){AC.startTokenSuggestion(z);}}}});mstrmojo.ME.AttributeEditBox.preprocessTokenStream=g;mstrmojo.ME.AttributeEditBox.postprocessTokenStream=a;mstrmojo.ME.AttributeEditBox.mapErrorCode=e;mstrmojo.ME.AttributeEditBox.getTokenStreamXML=U;mstrmojo.ME.AttributeEditBox.validateSyntax=G;mstrmojo.ME.AttributeEditBox.prepareInsertToken=J;mstrmojo.ME.AttributeEditBox.AEHelpFn=Z;}());(function(){mstrmojo.requiresCls("mstrmojo.array","mstrmojo.hash","mstrmojo.expr","mstrmojo.string","mstrmojo.form","mstrmojo._FormatDefinition","mstrmojo.ME.MetricDataService","mstrmojo.ME.MetricEditBox","mstrmojo.mstr.EnumDataType","mstrmojo.ME.Enum","mstrmojo.mstr.EnumDSSXMLObjectTypes","mstrmojo.mstr.EnumDSSXMLObjectSubTypes","mstrmojo.PassThroughOptions");mstrmojo.requiresDescs(218,219,221,531,628,1442,1918,2102,2116,2154,2213,2919,5298,5424,5728,5891,7558,7984,7987,11566,13249,15656);var p=mstrmojo.array,F=mstrmojo.string,u=mstrmojo.mstr.EnumDataType,A=mstrmojo.ME.MetricDataService,t=mstrmojo.mstr.EnumDSSXMLObjectTypes,W=mstrmojo.mstr.EnumDSSXMLObjectSubTypes,H=mstrmojo.hash;function V(AB){var x=AB.items,S=x.length,AA="",z;for(z=0;z<S;z++){AA+=x[z].v;}return AA;}var L=mstrmojo.dom,E=mstrmojo.string,R=mstrmojo._FormatDefinition,o=mstrmojo.ME.MetricEditBox.VALIDATION_STATUS,C=mstrmojo.ME.Enum.METRIC_EDIT_TYPES;var Y=function(S){if(!S){return o.VALID;}return{"-2147214845":o.ERROR,"-2147214846":o.AMBIGUITY}[S]||o.ERROR;},X=function(AE){var AB=AE.items,x=AB.length,AD=AB[AB.length-1],AA,AC,z=[],S="";if(AB[0]&&AB[0].tp!==38){z.push({v:"&",tp:38,lv:4,sta:2});}for(AA=0,x=AB.length;AA<x;AA++){AC=AB[AA];if(AC.isNew&&!AC.oi&&AC.tp!==283){S+=AC.v;}else{if(!E.isEmpty(S)){z.push({v:S,tp:2,lv:1});S="";}z.push(AC);}}if(!E.isEmpty(S)){z.push({v:S,tp:2,lv:1});S="";}if(AD&&AD.tp!==-1){z.push({v:"",tp:-1,lv:4,sta:2});}return{items:z};},P=function(z){var AA=X(z.tks);var x={items:true,v:true,tp:true,lv:true,oi:true,n:true,did:true,t:true,st:true,exv:true,extp:true,asc:true},S={getArrItemName:function(AD,AB,AC){return"tkn";},isSerializable:function(AD,AC,AB){return(x[AD])?true:false;}};return E.json2xml("tknstrm",AA,S);},n=function(AA){var x=AA.items,S=x.length,z=x[x.length-1];if(z&&z.tp===-1){x.pop();}if(x[0]&&x[0].tp===38){x.splice(0,1);}},q=function(S){return"";},l=function(S,z){var x=[];S.oi.tks.items=x;z.clearTokens(x);},M=function(AC,AB){var AA=[];AA.push("<mt>");if(AC.fmt&&!AB){var S={getArrItemName:function(AF,AD,AE){return AF.substr(0,AF.length-1);},isSerializable:function(AK,AI,AH){if(mstrmojo.array.indexOf(["header_format","grid_format"],AK)>-1){var AL=AI[AH][AK];if(!AL){return{};}var AF="<"+AK+">",AJ;for(AJ in AL){AF+="<prs n='"+AJ+"'>";var AE=AL[AJ],AD;for(AD in AE){var AG=AE[AD];AF+="<pr n='"+AD+"' v='"+(AG==="pru"?"":AG)+"'";AF+=AG==="pru"?' pru="1"':"";AF+="/>";}AF+="</prs>";}AF+="</"+AK+">";return{child:AF};}return true;},skipNull:true};AA.push(E.json2xml("fmt",AC.fmt,S));}if(AC.prss&&!AB){var z={getArrItemName:function(AF,AD,AE){return AF.substr(0,AF.length-1);},isSerializable:function(AK,AH,AF){if(mstrmojo.array.indexOf(["AnalyticalEngineProperties","DatamartProperties","VLDBSelect","VLDBFunction","VLDBReport"],AK)>-1){var AG=AH[AF][AK];if(!AG){return{};}var AE=[],AI=[],AJ;AE.push("<prs n='"+AK+"' ");for(AJ in AG){var AD=AG[AJ];if(AD!=null){if(typeof AD==="object"){AI.push(E.json2xml("pr",AD,{skipNull:true,convertBoolean:true,isSerializable:function(AN,AM,AL){return true;}}));}else{AE.push(AJ+"='"+AD+"' ");}}}AE.push(">");AE.push(AI.join(""));AE.push("</prs>");return{child:AE.join("")};}return true;},skipNull:true};AA.push(E.json2xml("prss",AC.prss,z));}if(AC.mps){AA.push(E.json2xml("mps",AC.mps,{skipNull:true,convertBoolean:true,isSerializable:function(AF,AE,AD){return true;}}));}if(AC.datp&&!AB){AA.push(E.json2xml("datp",AC.datp,{skipNull:true,convertBoolean:true,isSerializable:function(AF,AE,AD){return true;}}));}if(AC.sbs&&!AB){var x={getArrItemName:function(AF,AD,AE){return(AF==="avs")?"sb":AF.substr(0,AF.length-1);},isSerializable:function(AF,AE,AD){return true;},skipNull:true};AA.push(E.json2xml("sbs",AC.sbs,x));}AA.push("</mt>");return AA.join("");},G=function(x,S){x.set("enabled",!S);var z="mstrmojo-InlineWaitIcon";if(x.iconClass){x.set("iconClass",x.iconClass.replace(new RegExp(z),"")+" "+(S?z:""));}else{mstrmojo.css.toggleClass(x.domNode,z,S);}},I=function(x,S){var z={taskId:"saveMetricDefinition",tokenStreamXML:P(x),localSymbolFolderXML:q(x),metricXML:M(x),metricId:x.did||"",outputFlags:327695,description:x.desc||"",name:x.n||"",saveAs:S};if(E.isEmpty(x.metricId)){z.isNew=true;}return z;},O=function(z){var x=function(AA){var AC=this.parent;var AB=mstrmojo.desc(7987,"The ## '###' has been saved successfully.").replace("##","Object").replace("'###'","");if(AC){AC.ob.refreshContent();AC.onObjectSaved({name:AC.name,did:AA.did,desc:AC.desc});AB=mstrmojo.desc(7987,"The ## '###' has been saved successfully.").replace("##",AC.typeDesc||"Object").replace("###",AC.name);}mstrmojo.alert(AB,z.onSaved,mstrmojo.desc(7984,"Object Saved"));if(AC){AC.close();}z.dirty=false;},S={success:x,failure:mstrmojo.SaveAsEditor.SAVEAS_CALLBACK.failure};return S;},K=function K(AE){var AA=AE.items,S;for(var z=0;z<AA.length;z++){var AF=AA[z];if(AF&&AF.oi&&A.hasLookupForAttributesProps(AF.oi.did)){var AD=AA[z+1];if(AD.v==="<"){var AB=false;for(var AC=z+2;AC<AA.length&&AA[AC].v!==">";AC++){var x=AA[AC];if(x&&x.v==="UseLookupForAttributes"){AB=true;break;}}if(!AB){S=z+2;AA.splice(S,0,{v:"UseLookupForAttributes"},{v:"="},{v:"False"},{v:","});z=z+5;}}else{S=z+1;AA.splice(S,0,{v:"<"},{v:"UseLookupForAttributes"},{v:"="},{v:"False"},{v:">"});z=z+5;}}}},N=function(AE,AB){var z=this;G(z,true);var AF=mstrmojo.ME._MetricEditorHelper.oi=AE.oi,AA=P(AF),AC=q(AF),AD=M(AF,true),AG=function(AJ){if(AJ&&AJ.tks){var AK=AJ.tks;n(AK);var AI=AK.items;if(mstrApp&&mstrApp.isVI){AF.conditions=[];var AH=mstrApp&&mstrApp.getRootController().docCtrl.model;p.forEach(AI,function(AN){var AO=AN.oi,AP=AO&&AO.t,AL=AO&&AO.st,AM=AO&&AO.did;if(AP===t.Filter&&AL===W.Filter){var AQ=AH.getEmbeddedFilter(AM);if(AQ){AO.isEmbedded=true;AF.conditions.push(AQ);}}});}AF.tks=AK;if(AE.clientSideValidation){AE.clientSideValidation(AK);}AE.checkEditorFallback(AE.ide.candidates.items,AF);AK.vs=Y(AK.rjec);AE.set("vStatus",AK.vs);AE.set("iStatus",AK.rjed||"");if(AE.handleValidation){AE.handleValidation(AK);}if(AB&&(AK.vs===o.VALID)){K(AK);switch(AB){case"save":case"saveAs":if(AE.isDME){AE.handleDerivedMetricAction(AB,AF);}else{AE.handleMetricAction(AB,AF);}break;case"switch":if(AE.cbSwtichEditor){AE.cbSwtichEditor(AE);}break;}}else{if(AB&&AK.vs===o.ERROR){mstrmojo.alert(mstrmojo.desc(9826,"The metric definition has an error. Please correct before proceeding."),null,mstrmojo.desc(9571,"Syntax Error!"));}}}},x=function(AH){mstrmojo.alert(AH.message||AH.getResponseHeader("X-MSTR-TaskFailureMsg"));},S=function(AH){G(z,false);};A.validateMetric({tokenStreamXML:AA,localSymbolFolderXML:AC,metricXML:AD,metricId:AF.did,isNew:E.isEmpty(AF.did),msgID:AE.ide.isDME?mstrApp.getMsgID():null},{success:AG,failure:x,complete:S});},D=function(x,AA){var AB=AA,S=AB.oi.fmt,z=R.MetricFormatTarget;G(x,true);window.setTimeout(function(){if(!S){S=AB.oi.fmt={};var AC;for(AC=0;AC<z.length;AC++){S[z[AC].p]={};}}var AD=L.position(x.domNode,true);AB.openPopup("formatPopupRef",{zIndex:AB.zIndex+10,model:S,left:Math.max(0,(AD.x-(AB.formatPopupRef.width||565)))+"px",top:AD.y+"px"});G(x,false);},50);},j=function(z,AA){var AB=AA,S=AB.oi,x=function(){var AC=L.position(z.domNode,true);AB.openPopup(mstrmojo.all.mstrMEOptionsDialog||"optionPopupRef",{zIndex:AB.zIndex+10,model:S,funcs:AB.funcs,left:Math.max(0,(AC.x-(AB.optionPopupRef.width||565)))+"px",top:AC.y+"px"});};if(!AB.isDME&&!AB.funcs){G(z,true);A.getSubtotalFunctions(null,{success:function(AC){if(AC.items){AB.funcs=AC.items;x();G(z,false);}},failure:function(AC){mstrmojo.alert(AC.message||AC.getResponseHeader("X-MSTR-TaskFailureMsg"));G(z,false);}});}else{x();}},v=function(x,z){var AB=L.position(x.domNode,true),AA=H.any(z.ide.datasets),S={zIndex:z.zIndex+10,left:Math.max(0,(AB.x-(z.ptoPopupRef.width||333)+AB.w/2))+"px",top:AB.y+"px",mptf:z.mptf||_getMptfFromDataset(z),dbt:AA.tables[0].dbt,so_dft:AA.so_dft,sim_dft:AA.sim_dft,onOK:function(AD){z.mptf=AD;var AC=_getMptfFromDataset(z);if(!H.equals(AC,AD)){AD.dirty=true;}}};z.openPopup("ptoPopupRef",S);};_getMptfFromDataset=function(z){var S=mstrApp&&mstrApp.getRootController().docCtrl.model,AB=z.oi.did,AA=S.findUnitInDataSet(AB),x;if(AA){x=H.clone(AA.mptf);}else{x={mptso:{pru:1,v:0},mptsim:{pru:1,v:0},mptfms:""};}return x;};mstrmojo.ME._MetricEditorHelper=mstrmojo.provide("mstrmojo.ME._MetricEditorHelper",{noCache:true,useKeyDelay:true,tbBrowsable:true,functionNameRef:{scriptClass:"mstrmojo.Label",alias:"fnLabel",cssClass:"mstrmojo-ME-fct-name",bindings:{visible:function(){return !this.parent.insertMode;},text:function(){return mstrmojo.desc(5424,"Function:")+" "+this.parent.fctName;}}},nameEditBoxRef:{scriptClass:"mstrmojo.Box",alias:"nameEditBox",cssClass:"mstrmojo-ME-nameEditBox",cssDisplay:"inline-block",visible:false,bindings:{visible:function(){return !this.parent.insertMode&&this.parent.visible;}},onvisibleChange:function(S){if(S.value==false){return ;}var x=this;if(!x.tmr){x.tmr=window.setInterval(function(){if(x.domNode){window.clearInterval(x.tmr);delete x.tmr;x.nameInput.inputNode.select();}},50);}},children:[{alias:"nameInput",scriptClass:"mstrmojo.TextBoxWithLabel",inputNodeCssClass:"mstrmojo-ME-nameInput",value:mstrmojo.desc(2213,"New metric"),size:20,useRichTooltip:true,showErrTooltip:function w(){var x=L.position(this.domNode),S=E.isEmpty(this.value)?mstrmojo.desc(9122,"Name cannot be empty"):mstrmojo.desc(11569,"Input contains invalid character");this.richTooltip={contentNodeCssClass:"me-tooltip-content left me-err",content:'<div class="content"><span>'+S+"</span></div>",top:x.y-5,left:x.x+x.w+10};this.hasOpenTooltip=false;this.showTooltip();},bindings:{value:function(){var S=this.parent.visible;return this.parent.parent.oi.alias||this.parent.parent.oi.n;},label:function(){var x=this.parent.parent.ide||{},S=x.nameLabel||mstrmojo.desc(11566,"Metric Name:");return this.parent.parent.oi.alias?mstrmojo.desc(13249,"Display Name:"):S;}},onvalueChange:function(z){var S=this.parent.parent.ide.action.alias,AD=function(AE){return !E.isEmpty(AE)&&(S?true:!/[\[\]\"\\]/g.test(AE));},AC=AD(this.value);if(AC){this.hideTooltip();}else{this.showErrTooltip();}mstrmojo.css.toggleClass(this.parent.domNode,"err",!AC);var AA=this.parent.parent;AA.set("cValid",AC);var AB=AA.oi;if(AB){var x={n:AB.n,alias:AB.alias};AB.n=this.value;AB.alias=this.value;if(AB.n!==x.n&&AB.alias!==x.alias){AA.dirty=true;}}}}]},saveasRef:{scriptClass:"mstrmojo.SaveAsEditor",typeDesc:"Metric",browsableTypes:"4,8",onObjectSaved:function(z){var x=this.opener,S=x&&x.oi;if(x&&S){S.did=z.did;S.n=z.name;S.desc=z.desc;x.set("title",mstrmojo.desc(2154,"Metric:")+" "+z.name);}}},optionPopupRef:{id:"mstrMEOptionsDialog",scriptClass:"mstrmojo.ME.OptionDialog",title:mstrmojo.desc(9572,"Advanced Metric Options"),help:"Advanced_Metric_Options_dialog_box.htm",height:340},ptoPopupRef:{scriptClass:"mstrmojo.PassThroughOptions",help:"create_derived_metric_mdx_hierarchy_reports.htm",width:333},formatPopupRef:{scriptClass:"mstrmojo.ME.MetricFormatEditor",contentNodeCssClass:"mstrmojo-balloon",alias:"formatEditor",title:mstrmojo.desc(2116,"Format"),left:"100px",top:"100px",useAnimate:false,height:360,width:565,help:"Format_Metric_dialog_box.htm",locksHover:true},ob:{scriptClass:"mstrmojo.Editor",title:mstrmojo.desc(5298,"Select an Object"),help:"Select_Objects_dialog_box_.htm",children:[{scriptClass:"mstrmojo.ObjectBrowser",alias:"browser",cssText:"width:200px;",fishEyeVisible:false,closeable:false,closeOnSelect:false}]},switchRef:{scriptClass:"mstrmojo.Button",slot:"buttonNode",alias:"switchToMetricEdtior",cssClass:"mstrmojo-ME-switch mstrmojo-Editor-button mstrmojo-WebButton",text:mstrmojo.desc(9563,"Switch to Formula Editor"),closeAfterSwitch:true,bindings:{visible:function(){return !this.parent.insertMode;}},getEditor:function(){return this.parent;},getFormulaEditorId:function(){var S=this.getEditor();return(S.ide&&S.ide.formulaEditorId)||"mstrME";},onclick:function(){var z=this.getEditor(),x=this.getFormulaEditorId();z.oi.tks.items=z.getMetricDefAsTokens();var S={vStatus:mstrmojo.ME.MetricEditBox.VALIDATION_STATUS.UNKNOWN,oi:z.oi,did:z.oi.did,cValid:true};if(z.dirty){S.dirty=z.dirty;}if(z.mptf){S.mptf=z.mptf;}z.switch2Editor(x,S);if(z.ide){z.ide.set("showLeftPanel",true);z.set("simple",false);}}},formatAndOptionsBarRef:{scriptClass:"mstrmojo.HBox",alias:"formatbar",cssClass:"mstrmojo-ME-formatbar",children:[{scriptClass:"mstrmojo.Button",cssClass:"mstrmojo-ME-link format",alias:"formatButton",text:mstrmojo.desc(1918,"Format"),bindings:{visible:function(){return this.parent.parent.tbFormatable&&!this.parent.parent.insertMode;}},onclick:function(){D(this,this.parent.parent);}},{scriptClass:"mstrmojo.Button",cssClass:"mstrmojo-ME-link property",alias:"optButton",text:mstrmojo.desc(13035,"Metric Options"),bindings:{visible:function(){var S=this.parent.parent;return !S.insertMode&&!S.ide.disableAFB;}},onclick:function(){j(this,this.parent.parent);}},{scriptClass:"mstrmojo.Button",cssClass:"mstrmojo-ME-link property",alias:"ptoButton",text:mstrmojo.desc(15656,"Pass-through Options"),bindings:{visible:function(){var S=this.parent.parent;return !S.insertMode&&S.ide.enablePTO&&(S.id===((S.ide&&S.ide.formulaEditorId)||"mstrME"));}},onclick:function(){v(this,this.parent.parent);}}]},saveLabel:mstrmojo.desc(5891,"Save"),saveAsLabel:mstrmojo.desc(628,"Save As"),closeLabel:mstrmojo.desc(221,"Cancel"),saveAsEnabled:true,cValid:true,buttonBarRef:{scriptClass:"mstrmojo.HBox",alias:"buttonBar",slot:"buttonNode",cssClass:"mstrmojo-ME-buttonBox",cellCssClass:"subBox",children:[{scriptClass:"mstrmojo.Button",cssClass:"mstrmojo-Editor-button mstrmojo-WebButton hot",alias:"saveokButton",text:"",bindings:{enabled:function(){return this.parent.parent.cValid;},text:function(){return this.parent.parent.insertMode?mstrmojo.desc(531,"Add"):this.parent.parent.saveLabel;}},onclick:function(){var x=this.parent.parent;if(!x.insertMode&&x.isDirty&&!x.isDirty()){x.close();x.onCancel();return ;}if(!x.cValid){return ;}if(x.insertMode){x.insertOnFinish(x.getMetricDefAsTokens());x.close();}else{if(x.getMetricDefAsTokens){x.oi.tks.items=x.getMetricDefAsTokens();}var S=this;if(x.validateAndSave){G(S,true);x.validateAndSave(x.oi,function(){G(S,false);});}else{if(x.ide&&x.ide.validateAndSave){G(S,true);x.ide.validateAndSave(x.oi,function(){G(S,false);});}else{x.tbValidate=this;N.call(this,x,"save");}}}}},{scriptClass:"mstrmojo.Button",cssClass:"mstrmojo-Editor-button mstrmojo-WebButton",alias:"btnSaveAs",text:mstrmojo.desc(628,"Save As"),bindings:{visible:function(){return !this.parent.parent.insertMode&&!this.parent.parent.isDME;},text:function(){return this.parent.parent.saveAsLabel;}},onclick:function(){var S=this.parent.parent;if(S.getMetricDefAsTokens){S.oi.tks.items=S.getMetricDefAsTokens();}S.tbValidate=this;N.call(this,this.parent.parent,"saveAs");}},{scriptClass:"mstrmojo.Button",cssClass:"mstrmojo-Editor-button mstrmojo-WebButton",bindings:{text:function(){return this.parent.parent.closeLabel;}},onclick:function(){var S=this.parent.parent;if(S.onPreClose()){S.close();if(!S.insertMode){S.onCancel();}}}}]},validateSyntax:function B(S){N.call(S,this);},validateSyntaxAndSwitch:function c(S){N.call(S,this,"switch");},preprocessTokenStram:function U(S){n(S);},isDirty:function k(){if(this.insertMode){return false;}return this.dirty||this.oi.dirty||(this.oi.fmt||{}).dirty||(this.oi.mps||{}).dirty||(this.mptf||{}).dirty;},onmetricModify:function h(){this.dirty=true;},save:function Q(){this.buttonBar.btnSaveAs.onclick();},prompt2saveRef:{scriptClass:"mstrmojo.Editor",cssText:"width:350px;",title:mstrmojo.desc(5728,"Confirm save"),children:[{scriptClass:"mstrmojo.Label",cssText:"margin:5px 5px 20px;",allowHTML:true,bindings:{text:function(){return mstrmojo.desc(9573,"Do you want to save changes made to #?").replace("#","<b>"+mstrmojo.string.encodeHtmlString(this.parent.opener.oi.n)+"</b>");}}},{scriptClass:"mstrmojo.HBox",alias:"buttonBar",slot:"buttonNode",cssClass:"mstrmojo-ME-buttonBox",cellCssClass:"subBox",children:[{scriptClass:"mstrmojo.HBox",cssClass:"left",cssText:"width:10px;"},{scriptClass:"mstrmojo.HTMLButton",cssClass:"mstrmojo-Editor-button",text:mstrmojo.desc(219,"Yes"),onclick:function(){var S=this.parent.parent;S.opener.save();S.close();}},{scriptClass:"mstrmojo.HTMLButton",cssClass:"mstrmojo-Editor-button",text:mstrmojo.desc(218,"No"),onclick:function(){var S=this.parent.parent;S.opener.close();if(S.opener.onCancel){S.opener.onCancel();}S.close();}},{scriptClass:"mstrmojo.HTMLButton",cssClass:"mstrmojo-Editor-button",text:mstrmojo.desc(221,"Cancel"),onclick:function(){var S=this.parent.parent;S.close();}}]}]},prompt2save:function(){if(this.getMetricDefAsTokens){this.oi.tks.items=this.getMetricDefAsTokens();}this.openPopup("prompt2saveRef",{zIndex:this.zIndex+1});},handleMetricAction:function f(z,x){var S=this;var AA=I(x,false);if((z==="save")&&x.did){mstrmojo.xhr.request("POST",mstrConfig.taskURL,O(S),AA);}else{if(((z==="save")&&E.isEmpty(x.did))||z==="saveAs"){AA.saveAs=true;S.openPopup("saveasRef",{zIndex:S.zIndex+10,folderLinksContextId:17,name:x.n||x.name||(S.name&&S.name.value)||mstrmojo.desc(2213,"New Metric"),saveParams:AA,saveAsCallback:function(){var AB=O(S);if(AB.success){var AC=AB.success;AB.success=function(AD){AC.call(this,AD);if(S.ide.noRefresh!==true){var AE=mstrApp;mstrmojo.form.send({evt:5005,src:AE.name+"."+AE.pageName+".5005"});}};}return AB;}});}}},handleDerivedMetricAction:function g(AB,AA){AA=AA||this.oi;if(AB==="save"){var S={tokenStreamXML:P(AA),alias:AA.n};var x=AA.mps||{};if(x.dirty){if(x.fbf===0){x.afb=x.sfb=-1;}S.afb=x.afb;S.sfb=x.sfb;}if(this.originTks){S.originTokenStream=P({tks:{items:this.originTks}});S.originAfb=this.originAfb;S.originSfb=this.originSfb;}var AC=mstrmojo.all.mstrMetricIDE,z=AC.disableAFB;if(z){S.afb=0;S.sfb=1;}if((this.mptf||{}).dirty){S.mptf=this.mptf;}AC.onApplyMetricCallback(S);AC.close();}},onPreClose:function(){var S=this;if(S.isDirty&&S.isDirty()&&!this.isDME){S.prompt2save();return false;}return true;},onClose:function a(){this.dirty=false;delete this.mptf;if(this.onPostClose){this.onPostClose();}},init:function r(z){if(this._super){this._super(z);}var AA=mstrApp,S=AA&&AA.useQuickSearch&&AA.useQuickSearch(),x=S?((AA&&AA.searchAutoCompleteDelay&&AA.searchAutoCompleteDelay())||0):0;this.suggestDelay=x||200;this.noCache=this.noCache&&S&&!this.isDME;this.ob.children[0].quickSearch=S;A.suggestDelay=this.suggestDelay;A.noCache=this.noCache;},_setupCandidatesCache:function m(S){if(this.candidates&&S){S.candidates=null;S.set("candidates",this.candidates);}},item2textCss:function J(S){return"mstrmojo-ME-icon t"+S.t+(S.st?" st"+S.st:(S.um||S.da?"d":""));},getSpecialFunctionEditorId:function e(S,AA){var z=S&&S.did,x;if(z){if(A.isBasicAggMap(z)){x="mstrSME";}else{if(A.isRank(z)){x="mstrRFE";}else{if(A.isOLAPAgg(z)){x="mstrOFE";}else{x="mstrFE";}}}if(x){x+=AA?"_1":"";}}return x;},isDimty:function(x,S){return(/^@[a-z]{1,}(\s*[+-]\s*\d{1,})?$/i).test(F.trim(x));},validateByDataType:function d(x,S){var z=false;switch(x){case u.DataTypeInteger:z=/^(-)?\d+$/.test(S);break;case u.DataTypeNumeric:case u.DataTypeReal:case u.DataTypeDouble:z=mstrmojo.num.isNumeric(S);break;case u.DataTypeChar:case u.DataTypeVarChar:z=true;break;case u.DataTypeDate:case u.DataTypeTimeStamp:z=true;break;default:z=true;}return z;},getRootFunction:function b(z){var x,S=z&&z.tks&&z.tks.met;if(S!==C.ADVANCED){var AA=z.tks.items[0];x=AA&&AA.oi;}return x;},checkEditorFallback:function Z(S,AA){var x=this.getRootFunction(AA),z=mstrmojo.array.find(S,"did",x&&x.did)===-1;if(z&&AA&&AA.tks&&AA.tks.items&&AA.tks.items.length>0){AA.tks.met=C.ADVANCED;}return z;}});mstrmojo.ME._MetricEditorHelper.getTokenStreamXML=P;}());(function(){mstrmojo.requiresCls("mstrmojo.Container","mstrmojo.css","mstrmojo._HasLayout","mstrmojo._HasBuilder","mstrmojo._IsPanelStack","mstrmojo._IsSelectorTarget","mstrmojo.string","mstrmojo.vi._MonitorsAppState","mstrmojo.vi.ui.rw._IsPanelStack","mstrmojo.vi.ui.rw.DockedPanelSelector","mstrmojo.vi.ui.rw._SavesChildPositions","mstrmojo.vi.ui.tabs.PanelTabStrip","mstrmojo.vi.controllers.EnumLayoutSelectorPosition","mstrmojo.vi.controllers.EnumPanelManipulationType","mstrmojo.vi.controllers.EnumEvents","mstrmojo.vi.ui.rw._HasBufferSlice","mstrmojo.array");mstrmojo.requiresDescs(4780);var L=mstrmojo.array,b=mstrmojo.css,D=mstrmojo.string,c="#d6d6d6",O="#323335",F=mstrmojo.vi.controllers.EnumLayoutSelectorPosition,e=mstrmojo.vi.controllers.EnumPanelManipulationType,E=mstrmojo.vi.controllers.EnumEvents;function P(j){var k=this.model,h=k.tsp,g=j.visible,f=this.selector,l=f.hasRendered;var m=(h===F.LEFT||!g)?"":(h!==F.TOP?"bottom":"top");if(l||m){this.removeChildren(f);}f.slot=m+"SelectorNode";f.set("alignPosition",h);if(l||m){this.addChildren([f]);}if(k.getCurrentLayoutKey()===k.getLayoutKeyByUnitKey(this.k)){this.doLayout();}}function Z(){var f=this.selector,h=this.model,g=h.tsp,j=f.hasRendered;var k=g===F.LEFT||!mstrApp.rootCtrl.view.isCPVisible?"":(g!==F.TOP?"bottom":"top");if(j||k){this.removeChildren(f);}f.slot=k+"SelectorNode";f.set("alignPosition",g);if(j||k){this.addChildren([f]);}if(h.getCurrentLayoutKey()===h.getLayoutKeyByUnitKey(this.k)){this.doLayout();}}mstrmojo.vi.ui.rw.DocVIVisualizationsPanelStack=mstrmojo.declare(mstrmojo.Container,[mstrmojo._HasLayout,mstrmojo._HasBuilder,mstrmojo._IsPanelStack,mstrmojo.vi.ui.rw._IsPanelStack,mstrmojo.vi._MonitorsAppState,mstrmojo._IsSelectorTarget,mstrmojo.vi.ui.rw._SavesChildPositions,mstrmojo.vi.ui.rw._HasBufferSlice],{scriptClass:"mstrmojo.vi.ui.rw.DocVIVisualizationsPanelStack",markupString:'<div id="{@id}" class="mstrmojo-VIVizPanel {@cssClass}" style="{@cssText}"><div class="mstrmojo-VIVizPanel-top-selector"></div><div class="mstrmojo-VIVizPanel-content"></div><div class="mstrmojo-VIVizPanel-selector"></div><div class="mstrmojo-VIDND-mask"></div></div>',markupSlots:{topSelectorNode:function(){return this.domNode.firstChild;},containerNode:function(){return this.domNode.childNodes[1];},bottomSelectorNode:function(){return this.domNode.childNodes[2];},maskNode:function(){return this.domNode.lastChild;}},markupMethods:{onvisibleChange:mstrmojo.Widget.visibleMarkupMethod},layoutConfig:{h:{topSelectorNode:"auto",containerNode:"100%",bottomSelectorNode:"auto"},w:{topSelectorNode:"100%",containerNode:"100%",bottomSelectorNode:"100%"},xt:true},getLayoutOffsets:function Y(){return{h:2,w:2};},panels:null,model:null,selector:null,init:function U(g){this._super(g);var f=this.model;f.attachEventListener("tspChange",this.id,Z);if(mstrApp.supportFeature(mstrmojo.vi.enums.EnumFeatures.SUPPORT_TOC_UPDATEPOISITION)){mstrApp.rootCtrl.view.attachEventListener(E.CONTENTS_PANEL_VISIBILITY_CHANGE,this.id,P);}Z.call(this);},children:[{scriptClass:"mstrmojo.vi.ui.tabs.PanelTabStrip",alias:"selector"}],postBuildRendering:function X(){this._super();var h=this.parent,f=h&&h.defn&&h.defn.fmts,g=f&&f.fx&&f.fx.gd,j=f&&f["background-color"];if(g&&g.sc){var k=b.buildGradient(g.t,g.sc,g.ec);k&&(this.domNode.style[k.n]=k.v);}else{if(j&&!(j===c||j===O)){this.domNode.style.backgroundColor=j;}}},addChildren:function J(h,f,g,k){var j=h[0];if(j&&j.hasOwnProperty("k")){this.panels=(this.panels||[]).concat(h);if(!k){this.notifyPanelSelector();}}return this._super(h,f,g);},removeChildren:function S(h,g){if(h){var f=[].concat(h).map(function(j){return j.k;});this.panels=(this.panels||[]).filter(function(j){return f.indexOf(j.k)===-1;});}this._super(h,g);},_set_children:function V(j,h,g){if(h!==this.children){var f=this.selector;if(f){h.push(f);}}return this._super(j,h,g);},onAppStateChange:function Q(g){var l=mstrmojo.vi.VisualInsightApp.APP_STATES,f=l.PRESENTATION,h=l.PAUSE;if(g.value&f||g.valueWas&f){Z.call(this);}var k=g.value&h,j=g.valueWas&h;if(k&&!j){this.defn.set("disableSelectionApply",true);}if(j&&!k){this.defn.set("disableSelectionApply",false);}},hasDisabledSelectionApply:function R(){var f=this.defn||this.node.defn;return !!f.disableSelectionApply;},notifyPanelSelector:function H(f){this.selector.setTabs(this.panels,this.selectedKey);if(!f){this.doLayout();}},selectPanelDeferred:function(j,g,h,f){if(g!==this.selectedKey){this._super(j,g,h,f);}},onpanelSelected:function G(){this.notifyPanelSelector();this.getSelectedPanel().buildBoxLayout();},removePanel:function N(f){var g=this.panels,k=g.indexOf(f),j=g[k],h;g.splice(k,1);h=this.removeChildren(j);return h;},removePanelsByIndex:function N(g){var f=this.panels,l=this,k=[].concat(g),j=[],h;L.forEach(k,function(m){j.push(f[m]);});k.sort(function(n,m){return m-n;});L.forEach(k,function(m){f.splice(m,1);});L.forEach(j,function(m){l.removeChildren(m);m.selected=false;});},changePanelPosition:function a(j,m,l,f,k){var h=this.children,g=this.panels;g.splice(m,1);h.splice(f,1);g.splice(l,0,j);h.splice(f+l-m,0,j);this.selectedIdx=k;this.notifyPanelSelector();},sortPanels:function K(h){var g=this.children||[],f=this.panels||[];f.sort(function(k,j){return k.defn.chdidx-j.defn.chdidx;});L.forEach(f,function(j){var k=g.indexOf(j);g.splice(k,1);});L.forEach(f,function(j){g.push(j);});this.selectedIdx=h;this.notifyPanelSelector();},deletePanel:function C(g){var h=this.model,f=this;h.raiseEvent({name:E.MANIPULATE_PANEL,type:e.DELETE,panelKeys:[g.k],panelStackKey:f.k,layoutKey:h.getLayoutKeyByUnitKey(f.k)});},movePanel:function W(j,k){var h=this.model,f=this,g=f.panels[j];h.raiseEvent({name:E.MANIPULATE_PANEL,type:e.MOVE,panelKey:g.k,panelKeys:[g.k],panelStackKey:f.k,layoutKey:h.getLayoutKeyByUnitKey(f.k),fromIdx:j,toIdx:k});},renamePanel:function B(g,j){var h=this.model,f=this;h.raiseEvent({name:E.MANIPULATE_PANEL,type:e.RENAME,panelKey:g.k,panelStackKey:f.k,layoutKey:h.getLayoutKeyByUnitKey(f.k),newTitle:j,oldTitle:g.title});},addPanel:function I(){var g=this.model,f=this;g.raiseEvent({name:E.MANIPULATE_PANEL,type:e.NEW,panelStackKey:f.k,layoutKey:g.getLayoutKeyByUnitKey(f.k)});},duplicatePanel:function A(g){var h=this.model,f=this;h.raiseEvent({name:E.MANIPULATE_PANEL,type:e.DUPLICATE,panelKey:g.k,panelStackKey:f.k,layoutKey:h.getLayoutKeyByUnitKey(f.k)});},getUIState:function d(){var g={},f=this.getSelectedPanel();g.pk=f.k;g.boxState=f.getBoxState();g.viUnitKey=this.model.getSelectedViUnit()&&this.model.getSelectedViUnit().k;return g;},restoreUIState:function M(k){var f=this.getSelectedPanel(),j=k.pk;if(j&&f.k!==j){this.selectPanel(j,null,true);f=this.getSelectedPanel();}var g=k.viUnitKey;if(g){var h=f.getUnitByKey(g);if(h){this.model.selectVIUnit(h.id,true);}}var l=k.boxState;if(l!==f.getBoxState()){f.restoreBoxState(l);}}});}());(function(){mstrmojo.requiresCls("mstrmojo.vi.ui.CollapsibleTitleBar","mstrmojo.ui.menus.ToolbarConfig","mstrmojo.ui.menus.Menu","mstrmojo.dom","mstrmojo.css");var F=mstrmojo.css,C="visible",G="containerNode";function E(Q){Q.btn.style.display=!!Q.menuCfg?"block":"none";}mstrmojo.vi.ui._IsPanel=mstrmojo.provide("mstrmojo.vi.ui._IsPanel",{_mixinName:"mstrmojo.vi.ui._IsPanel",markupString:'<div id="{@id}" class="mstrmojo-VIPanel {@cssClass}" style="{@cssText}" mstrAttach:mouseover,mouseout,click><div class="mstrmojo-VIPanel-titlebar"></div><div class="mstrmojo-VIPanel-content"></div><div class="mstrmojo-VIDND-mask"></div><div class="mstrmojo-VIPanel-handle splitter v"></div></div>',markupSlots:{titlebarNode:function(){return this.domNode.firstChild;},containerNode:function(){return this.domNode.childNodes[1];},maskNode:function(){return this.domNode.childNodes[2];},handleNode:function(){return this.domNode.lastChild;}},markupMethods:{onvisibleChange:mstrmojo.Widget.visibleMarkupMethod,onisCollapsedChange:function L(){if(this.canCollapse){this.containerNode.style.display=this.isCollapsed?"none":"block";if(!this.isCollapsed){this.doLayout();}}}},title:"",titleBar:null,titlebarNode:null,containerNode:null,maskNode:null,handleNode:null,bubbleMouseOver:true,canCollapse:false,isCollapsed:false,autoHideToolbar:false,init:function K(Q){this._super(Q);this.addChildren([this.getTitleBarCfg()]);this.menuBtnInfo={};},skipsSlotLayout:function(Q){return Q===G&&this.isCollapsed;},getTitleBarCfg:function P(){return{scriptClass:"mstrmojo.vi.ui.CollapsibleTitleBar",slot:"titlebarNode",alias:"titleBar",isCollapsed:this.isCollapsed,title:this.title,close:function(){this.parent.setOpenStatus(false);mstrApp.rootCtrl.generateToolbar();},collapse:function(Q){this.parent.set("isCollapsed",Q);}};},ontitleChange:function H(){this.titleBar.set("title",this.title);},_set_children:function A(U,R,Q){if(R!==this.children){var S=this.titleBar;if(S){R.push(S);}}return this._super(U,R,Q);},preBuildRendering:function I(){this.generateToolbar();this.titleBar.setToolbarVisibility(!this.autoHideToolbar);return this._super();},generateToolbar:function B(){var Q=this.titleBar;Q.set("toolbarCfg",this.updateToolbar(new mstrmojo.ui.menus.ToolbarConfig()));if(!Q.visible){this.menuBtnInfo.menuCfg=Q.getMenuConfig();}},updateToolbar:function O(Q){return Q;},setOpenStatus:function N(Q){if(this.visible!==Q){this.set("visible",Q);this.parent.doLayout();}},setTitleBarVisibility:function D(Q){var S=this.titleBar;S.set("visible",Q);this.generateToolbar();var U=this.menuBtnInfo,R=U.btn;if(!R){R=U.btn=document.createElement("div");R.className="hover-menu-btn";var V=this.id;mstrmojo.dom.attachEvent(R,"click",function(){var X=mstrmojo.all[V],W=U.menuCfg;W.hostId=V;W.hostElement=R;X.openPopup(new mstrmojo.ui.menus.Menu({popupConfig:W}));});this.domNode.appendChild(R);}U.menuCfg=Q?null:S.getMenuConfig();E(U);this.doLayout();},onmouseover:function M(Q){if(!mstrApp.isInteractive()){return ;}if(!this.bubbleMouseOver){Q.cancel();}var S=this._panelTimeout;if(S){window.clearTimeout(S);delete this._panelTimeout;}if(this.autoHideToolbar){this.titleBar.setToolbarVisibility(true);}var R=this.menuBtnInfo;if(!!R.menuCfg){F.addClass(R.btn,C);}},onmouseout:function J(){var Q=this.id;this._panelTimeout=window.setTimeout(function(){var R=mstrmojo.all[Q];if(R){if(R.autoHideToolbar){R.titleBar.setToolbarVisibility(false);}var S=R.menuBtnInfo;if(!!S.menuCfg){F.removeClass(S.btn,C);}}},200);}});}());(function(){mstrmojo.requiresCls("mstrmojo.vi.ui.BoxPanel","mstrmojo.vi.ui.toolbars._HasToolbar","mstrmojo.vi.ui._IsUnitDependentPanel","mstrmojo.vi._MonitorsAppState","mstrmojo.css");mstrmojo.vi.ui.VIBoxPropertyEditor=mstrmojo.declare(mstrmojo.vi.ui.BoxPanel,[mstrmojo.vi.ui._IsUnitDependentPanel,mstrmojo.vi.ui.toolbars._HasToolbar,mstrmojo.vi._MonitorsAppState],{scriptClass:"mstrmojo.vi.ui.VIBoxPropertyEditor",layoutConfig:{h:{controlNode:"25px",containerNode:"100%"},w:{controlNode:"all",containerNode:"all"},xt:true},init:function E(F){this._super(F);mstrmojo.css.addWidgetCssClass(this,"mstrmojo-vi-PropEditor");},onAppStateChange:function B(N){var L=mstrmojo.vi.VisualInsightApp.APP_STATES,O=L.PAUSE,M=mstrApp.isAppStatePause&&mstrApp.isAppStatePause();var J=!!(N.valueWas&O);if(M!==J&&!(mstrApp.enableUpdate&&J)){var I=this.targetUnit,P=I&&I.id,F=this.model&&this.model._selectedUnitId;if(P!==F){return ;}var K=this.contents,H=(K.children||[]).slice(),G=I&&I.boxContent;if(G){G.excludeData=M;}K.removeChildren();H.forEach(function(Q){Q.destroy();});this.onVIUnitSelected(I);}},onVIUnitSelected:function C(I){var H=I&&I.getEditorModel(),F=function(){this.updateScrollbars();},G=H&&H.getEditorContents(F.bind(this));if(G){G.forEach(function(J){J.slot="containerNode";});this.contents.addChildren(G);this.generateToolbar();this.doLayout();}else{if(H&&H.getDelayedEditorContents){H.getDelayedEditorContents(this,I);}}},onvisibleChange:function A(F){if(this.viPanelType===mstrmojo.vi.ui.BoxPanel.PANEL_TYPES.PROPS&&F.value){this.refresh();}},updateToolbar:function D(F){var H=this.targetUnit,G=H&&H.getEditorModel();this.addRenameTargetMenuItem(F);this.addHelpTopicMenuItem(F,mstrmojo.desc(1143,"Help"),G&&G.help);return this._super(F);}});}());(function(){mstrmojo.requiresCls("mstrmojo.vi.ui.TitleBarWithRMCPopup","mstrmojo.vi.ui._IsUnitContainerTitleBar","mstrmojo.vi.ui.toolbars.TitleToolbar");function C(F,D,E){return[{scriptClass:"mstrmojo.vi.ui.toolbars.TitleToolbar",slot:F+"ToolNode",alias:D,visible:true,useRichTooltip:E}];}mstrmojo.vi.ui.VizBoxTitleBar=mstrmojo.declare(mstrmojo.vi.ui.TitleBarWithRMCPopup,[mstrmojo.vi.ui._IsUnitContainerTitleBar],{scriptClass:"mstrmojo.vi.ui.VizBoxTitleBar",leftToolbar:undefined,getLeftToolbarChildren:function A(){return C("left","leftToolbar",false);},getRightToolbarChildren:function B(){return C("right","tbToolbar",true);}});}());(function(){mstrmojo.requiresCls("mstrmojo.hash","mstrmojo.array","mstrmojo.registry","mstrmojo.css","mstrmojo.Arr","mstrmojo.expr","mstrmojo.Label","mstrmojo.AjaxCall","mstrmojo.HTMLButton","mstrmojo.Container","mstrmojo._HasPopup","mstrmojo.HBox","mstrmojo.Dial","mstrmojo.WidgetDial","mstrmojo.ValidationTextBox","mstrmojo.Calendar","mstrmojo.DateTextBox","mstrmojo.Editor","mstrmojo.ObjectBrowser","mstrmojo.ElementsBrowser","mstrmojo.ConditionModel","mstrmojo.mstr.EnumNodeDimty");var D=mstrmojo.css,A=mstrmojo.registry,V=mstrmojo.hash,w=mstrmojo.array,F=w.find,H=mstrmojo.Arr,S=mstrmojo.expr,U=mstrmojo.dom,M=S.ET,AD=S.DTP,n=S.DTP2FN_DTP,X=S.ET2TGT,l=S.ET2TP,C=mstrmojo.meta.TP,P=mstrmojo.meta.STP,AB=mstrmojo.string.encodeXMLAttribute,I=mstrmojo.mstr.EnumNodeDimty;var AK=w.hash([I.NodeDimtyOutputLevel]);var O={};O[M.AQ]={target:1,fm:1,fn:1,c0:1,c1:1};O[M.AL]={target:1,fm:1,fn:1,c0:1};O[M.AE]={target:1,fm:1,es:1};O[M.AC]={target:1,fm:1,fm2:1,fm3:1,fn:1,c0:1,c1:1};O[M.MQ]={target:1,fn:1,c0:1,c1:1,dmy:1};O[M.MC]=O[M.MQ];O["*"]={target:1};var z={};z[M.MQ]={key:"metricFns",def:S.METRIC_FNS};z[M.MC]={key:"metricFns",def:S.METRIC_FNS};z[M.AQ]={key:"formFns",def:S.FORM_FNS};z[M.AL]={key:"formFns",def:S.FORM_FNS};z[M.AC]={key:"formFns",def:S.FORM_FNS};z[M.AE]={key:"elemFns",def:S.ELEM_FNS};var AF={};AF[M.AQ]=mstrmojo.desc(7925,"Select Attribute...");AF[M.AL]=mstrmojo.desc(7926,"Browse...");AF[M.MQ]=mstrmojo.desc(7927,"Select Metric...");AF[M.MC]=mstrmojo.desc(7927,"Select Metric...");AF[M.AC]=mstrmojo.desc(7925,"Select Attribute...");function AH(AP,AR,AO){var AQ=AP[AR].style;if(mstrmojo.dom.isFF){AQ.overflow="hidden";AQ.width=AO?"auto":"0px";AQ.visibility=AO?"inherit":"hidden";}else{AQ.display=AO?"block":"none";}}function v(AS){var AR=true,AO=AS.model,AP,AQ=AO&&S.fnCstCount(AO.fn,AO.fnt);if(!AO){return ;}switch(AO.et){case M.AQ:case M.AL:case M.MQ:for(AP=0;AP<AQ;AP++){AR=AR&&!AS["invalid"+AP];}break;}AS.okBtn.set("enabled",AR&&!!AO.completed);}function AI(AU){var AP=AU.model,AX=AP&&AP.et,AV=O[AX]||O["*"],AO=AU.children,AQ,AR=AO.length;for(AQ=0;AQ<AR;++AQ){var AT=AO[AQ];if(!AT.isStep){continue;}var AW=AT.alias,AS=AV[AW];AH(AU,AT.slot,AS);if(AS&&AT&&AT.update){AT.update();}}if(!AV.c1){AH(AU,"btwnNode",false);}if(!AV.dmy){AH(AU,"atNode",false);}v(AU);}function x(){var AP=this.parent,AO=((AP&&AP.cssText)||"").match(/height:\s*(\d*)px/);this.cssText=AO&&AO[0];}var d="dummy",B={did:"idBrowse",v:"idBrowse",n:mstrmojo.desc(6571,"Browse..."),t:d,css:"unselectable link"},J={did:"idErr",v:"idErr",n:mstrmojo.desc(7929,"Error loading data."),t:d,css:"unselectable"},r={did:"idWait",v:"idWait",n:mstrmojo.desc(2901,"Loading..."),t:d,css:"unselectable"};function a(AQ){if(this.updating){return ;}var AR=this.multiSelect,AT=this.selectedItem;if(AT&&AT[C]===d){this.updating=true;if(AR){this.removeSelect([this.selectedIndex]);}else{var AP=AQ&&AQ.removed&&Number(AQ.removed[0]);AP=(AP==null)?-1:AP;this.set("selectedIndex",AP);}this.updating=false;if(AT===B){this.parent.browse(this);}}else{var AO=this.parent.model;if(AR){var AS=this.items;AO.edit(this.alias,{added:AQ.added&&w.get(AS,AQ.added),removed:AQ.removed&&w.get(AS,AQ.removed),itemIdField:this.itemIdField});}else{AO.edit(this.alias,AT);}}}function E(AQ,AS,AP){var AR=AQ.items,AO=w.indexOf(AR,AS);if((AO===0)&&(AR.length===1)){AP=mstrmojo.Arr.makeObservable((AP&&AP.length)?AP.concat():[]);AQ.set("items",AP);}else{if(AO>-1){AR.remove(AO,1);}if(AP&&AP.length){AR.add(AP,(AO>-1)?AO:null);}}}function L(AO){return V.copy(AO,{scriptClass:"mstrmojo.Dial",slot:AO.alias+"Node",isStep:true,cssClass:"mstrmojo-walkstep mstrmojo-"+AO.alias,itemIdField:"did",itemMarkupFunction:function(AQ,AP,AR){var AS=AB(AQ.n);return'<div class="dial-item '+AQ.css+'" title="'+AS+'">'+AS+"</div>";},allowUnlistedValues:true,insertUnlistedValuesAt:0,onchange:a,postCreate:x});}function o(AQ,AO,AR){var AP=AQ.cfg;if(AP){AP.data=AQ;AP.parent=AR;return A.ref(AP);}AP=new mstrmojo.Label({text:AQ.n,cssClass:"dial-item"});AP.markupMethods.onselectedChange=function(){mstrmojo.css.toggleClass(this.domNode,["selected"],this.selected);};AP.data=AQ;AP.parent=AR;return AP;}function AM(AP,AO){var AQ=AO+S.FN_SEP+AP;return(AP!=null)?{did:AQ,n:AQ}:null;}function N(){var AO=this.model;if(AO){if(!AO.attachEventListener){mstrmojo.hash.make(AO,mstrmojo.ConditionModel,{});}AO.attachEventListener("edit",this.id,"onmodeledit");}}function j(AO){return AO.targets?w.filter(AO.targets,function(AP){return AP[C]===S.TP.ATTR;}):[];}function Z(AP,AO){if(AO&&AO.detachEventListener){AO.detachEventListener("edit",AP.id,"onmodeledit");}}function q(AP,AO,AQ,AT){AP.updating=true;AH(AP.parent,AP.slot,AO);if(AO){if(AQ!=null){AP.clearSelect();AP.set("items",AQ);}var AS=AP.itemIdField,AR=AP.selectedItem;if((AR&&AR[AS])!=(AT&&AT[AS])){AP.set("selectedItem",AT);}else{AP.center();}}AP.updating=false;}function m(AO,AP,AR,AQ){AO.updating=true;if(AP!=null){}AO.clearSelect();if(AP){AO.set("items",AP);}if(AR&&AR.length){AO.setSelectedItems(AR);}else{if(AQ&&AQ.length){AO.select(AQ);}else{AO.center();}}AO.updating=false;}function c(AP,AO,AQ,AS,AR){AH(AP.parent,AP.slot,AO);if(AO){m(AP,AQ,AS,AR);}}function G(AQ,AP){var AO=AQ.model||{},AR=AO.fn;return(AR!=null)&&((AO.et===M.MQ)||(AO.et===M.MC)||(AO.et===M.AQ)||(AO.et===M.AL)||(AO.et===M.AC))&&(S.fnCstCount(AR,AO.fnt)>AP);}var AL={};AL[AD.DATE]=1;AL[AD.TIME]=1;AL[AD.TIMESTAMP]=1;function k(AR,AQ,AT){var AP=[],AO=AR.length,AS;for(AS=0;AS<AO;AS++){if(F(AQ,AT,AR[AS][AT])<0){AP.push(AR[AS]);}}return AP;}function AJ(AO,AQ){var AP;if(AQ){switch(X[AO.et]){case"a":AP=AQ[M.AC];break;case"m":AP=AQ[M.MC];break;default:AP=false;break;}}else{AP=true;}return AP&&S.fn_AC_MC(AO&&AO.fn);}function p(AP){var AS=AP&&l[AP.et],AR=AP&&AP.fm&&AP.fm.dtp,AO=AR&&S.DTP2PROMPT_STP[AR],AQ={};AQ[AS]=true;if(AO){AQ[AO]=true;}return AQ;}function h(AU){var AO=this.targetsLastMod,Af=AU.targetsLastMod,AR=AU.model,Ae=this._lastTargetId,AP=AR&&AR[X[AR.et]]&&AR[X[AR.et]][AU.target.itemIdField],AY=AR&&AR.fm,Aa=AY&&AY.dtp,Ab=AJ(AR,AU.ets),AV=false;if(!AO||!Af||(AO!=Af)||Ae!==AP){this.targetsLastMod=AU.targetsLastMod;AV=true;}else{if(this.lastFmDtp!==Aa){this.lastFmDtp=Aa;AV=true;}else{if(this.lastFnTp!==Ab){this.lastFnTp=Ab;AV=true;}}}if(AV){if(!Ab){this.clearSelect();if(this.items.length!==this.preLen){this.set("items",this.items.slice(0,this.preLen));}}else{var AW=p(AR),AS=AU.targets?w.filter(AU.targets,function(Ag){return AW[Ag[C]]||AW[Ag[P]];}):[],AZ=this.items.slice(this.preLen),AX=this.itemIdField,Ad=k(AZ,AS,AX)||[],AT=k(AS,AZ,AX)||[],Ac,AQ;for(Ac=0,AQ=Ad.length||0;Ac<AQ;Ac++){this.remove(Ad[Ac]);}if(AT.length>0){this.add(AT,-1);}}this._lastTargetId=AP;}}function K(Ag,AV){Ag.updating=true;var AS=Ag.parent,Ae=G(AS,AV);AH(Ag.parent,Ag.slot,Ae);if(Ae){var AY=AS.model||{},AR=AY.cs,Ad=AR&&AR[AV],AU=Ad&&Ad.v,AT;h.call(Ag,AS);switch(AY.et){case M.MQ:case M.MC:AT=S.METRIC_DTP;break;case M.AQ:case M.AC:case M.AE:AT=AY.fm&&AY.fm.dtp;break;case M.AL:AT=AY.fm&&AY.fm.dtp;AU=[];for(var AZ=0,Ab=AR&&AR.length;AZ<Ab;AZ++){AU.push(AR[AZ].v);}AU=AU.join(mstrConfig.listSep);break;}AT=AT||AD.CHAR;var AW=S.fn_List(AY.fn,AY.fnt),Aa=AL[AT],Ac=Aa&&!AW;var AP=Ag.ctxtBuilder,AO=AP&&AP.itemWidgets,Af=Aa?(Ac?Ag.calIndex:Ag.dtxtIndex):Ag.txtIndex,AX=AO&&AO[Ag.bwIndex],AQ;for(var AZ=0,Ab=Ag.preLen-1;AZ<Ab;AZ++){AQ=AO[AZ];if(AZ==Af){AQ.set("dtp",AT);AQ.set("isList",AW);AQ.set("value",AU);AQ.set("visible",true);if(AQ.clearValidation){AQ.clearValidation();}}else{AQ.set("visible",false);}if(AW){AQ.set("tooltip",mstrmojo.desc(8191,"value1## value2## ...## valueN").replace(/##/g,mstrConfig.listSep));}else{AQ.set("tooltip","");}}if(AX){AX.set("text",AF[AY.et]);AX.set("visible",AS.objectBrowsingEnabled&&AJ(AY,AS.ets));}switch(AY.et){case M.AQ:case M.AL:case M.MQ:if(Ad&&Ad.p){Ag.set("selectedItem",Ad.p);}else{Ag.set("selectedIndex",Af);}break;case M.MC:case M.AC:Ag.set("selectedItem",AY[X[AY.et]+(2+AV)]);break;}}AH(AS,"btwnNode",Ae);Ag.refreshScroll();Ag.updating=false;}function AG(){var AR=this.parent,AP=AR.parent,AQ=(this.isValid&&this.isValid())||(!this.isValid&&!mstrmojo.string.isEmpty(this.value)),AO=AP.model;AP["invalid"+AR.cstIndex]=!AQ;if(!this.updating&&AQ){this.updating=true;if(AO){AO.edit(AR.alias,{v:this.value,dtp:this.dtp});}this.updating=false;}v(AP);}function Y(){var AP=this.parent,AO=AP.parent;AO["invalid"+AP.cstIndex]=false;}function g(AO){return L(V.copy(AO,{scriptClass:"mstrmojo.WidgetDial",makeObservable:true,itemFunction:o,selectionPolicy:"reselect",items:[{did:0,cfg:{scriptClass:"mstrmojo.ValidationTextBox",required:true,constraints:{trigger:mstrmojo.validation.TRIGGER.ALL},onValid:AG,onInvalid:AG,onClearValidation:Y,size:6,cssText:"text-align:right",visible:false}},{did:1,cfg:{scriptClass:"mstrmojo.Calendar",onvalueChange:AG,visible:false}},{did:2,cfg:{scriptClass:"mstrmojo.DateTextBox",required:true,constraints:{trigger:mstrmojo.validation.TRIGGER.ALL},onValid:AG,onInvalid:AG,onClearValidation:Y,calendarToBody:true,calConfig:{onmousedown:function(AP){mstrmojo.dom.stopPropogation(AP.hWin,AP.e);}},visible:false}},{did:3,t:d,cfg:{scriptClass:"mstrmojo.Label",cssClass:"dial-item link",text:"Browse...",onclick:function(){this.parent.parent.browse(this.parent);},visible:false}}],txtIndex:0,calIndex:1,dtxtIndex:2,bwIndex:3,preLen:4,insertUnlistedValuesAt:-1,update:function(){K(this,this.cstIndex);}}));}function e(AO){return L(V.copy(AO,{insertUnlistedValuesAt:-1,postCreate:function(){x.apply(this,[]);this.ajx=mstrmojo.insert({parent:this,scriptClass:"mstrmojo.AjaxCall",isTask:true,readCache:true,writeCache:true,params:{taskId:"getAttributeForms",attributeId:null,displayedForms:"0",styleName:"MojoAttributeStyle"},onsuccess:function(){var AW=this.parent,AR=AW&&AW.parent&&AW.parent.model,AT=this.response;if((AT&&AT.did)!==AW.lastAttrId){return ;}var AS=AT.fms||[],AV=AW.selectedItem;AS=w.filter(AS,function(AX){return(!AX.icf);});if(AV){var AQ=w.find(AS,AW.itemIdField,AV[AW.itemIdField]);if(AQ>-1){AS=AS.concat();AS.splice(AQ,1);}}E(AW,r,AS);var AU=AW.items,AP=AU.length;if(AP===1){AW.singleSelect(0);}},onerr:function(){E(this.parent,r,[J]);}});},update:function(){var AZ=this.fmPost,AP=this.parent,AR=AP.model,AX=AR&&AR["a"+AZ],AV=!!AX,AQ,AU,Aa=AR&&AR.tfm,AT=Aa&&Aa.dtp,AY;if(AV){switch(AR.et){case M.AQ:case M.AL:AU=AR.fm;break;case M.AC:AU=AR["fm"+AZ];break;case M.AE:AU=AM(AR.fn,1);break;}if(this.lastAttrId!==AX.did){this.lastAttrId=AX.did;AQ=[];if(AR.et!==M.AC){if(!AX.ilk&&(!AP.ets||AP.ets[M.AE])){var AS=z[M.AE],AW=AS&&AS.key;AQ=AQ.concat((AW&&AP[AW])||AS.def||[]);}}if(AU&&(AR.et!==M.AE)){AQ.push(AU);}AY=this.ajx;AY.params.attributeId=AX.did;AQ.push(r);H.makeObservable(AQ);}}q(this,AV,AQ,AU);if(AV&&AY){if(AY._delayId){window.clearTimeout(AY._delayId);delete AY._delayId;}AY._delayId=window.setTimeout(function(){delete AY._delayId;AY.send();},500);}}}));}var Q=[S.STP.PROMPT,S.STP.PROMPT_OBJECTS,S.STP.PROMPT_ELEMENTS,S.STP.PROMPT_EXPRESSION,S.STP.PROMPT_EXPRESSION_DRAFT];function AN(AO){if(AO&&!V.isEmpty(AO)){var AP=w.hash(Q);V.forEach(AO,function(AR,AQ){if(AR){AP[l[AQ]]=true;}});return AP;}return null;}function b(AR,AQ,AT){AR.openPopup("eb",{zIndex:AR.parent.zIndex+10,left:Math.round(AT.x)+"px",top:Math.round(AT.y)+"px"});var AP=AR.eb.browser,AO=AR.model,AS=AO&&AO.a&&AO.a.did;if(!AS){return ;}AP.set("attributeID",AS);AP.set("selectedItems",AO.es?V.clone(AO.es):[]);AP.initBrowser();}function AE(AV,AO,AP){AV.openPopup("ob",{zIndex:AV.parent.zIndex+10,left:Math.round(AP.x)+"px",top:Math.round(AP.y)+"px"});var AQ=AV.ob.browser;AQ.target=AO;var AR;switch(AO.alias){case"dmy":AR=[S.TP.ATTR,S.TP.DIM];break;case"c0":case"c1":var AT=AV.model,AS=AT&&AT.et,AW=AT&&AT.fm,AU=AW&&AW.dtp||(AT.m?S.DTP.DECIMAL:S.DTP.UNKNOWN);AR=(AS===M.MQ||AS===M.MC)?[S.TP.METRIC,S.DTP2PROMPT_STP[AU]]:[S.TP.ATTR,S.DTP2PROMPT_STP[AU]];break;default:if(AV.browsableTypes){AR=AV.browsableTypes;}else{AR=AN(AV.ets);AR=AR?V.keyarray(AR,true):[S.TP.ATTR,S.TP.METRIC,S.STP.REPORT_GRID,S.STP.REPORT_GRAPH,S.STP.REPORT_ENGINE,S.STP.REPORT_TEXT,S.STP.REPORT_DATAMART,S.STP.REPORT_BASE,S.STP.REPORT_GRIDGRAPH,S.STP.REPORT_NONINTERACTIVE,S.STP.FILTER].concat(Q);}}AR[AR.length]=S.TP.FOLDER;AQ.browse({folderLinksContextId:AT&&(AT.et===M.MQ||AT.et===M.MC)?27:23,onSelectCB:[AV,"onOBSelect"],browsableTypes:AR.join(",")});}mstrmojo.ConditionWalk=mstrmojo.declare(mstrmojo.Container,[mstrmojo._HasPopup],{scriptClass:"mstrmojo.ConditionWalk",markupString:'<table id="{@id}" class="mstrmojo-walk mstrmojo-ConditionWalk {@cssClass}" style="{@cssText}" cellspacing="0" cellpadding="0" mstrAttach:click><tr><td class="mstrmojo-walkcell mstrmojo-ConditionWalk-notNode"><div class="mstrmojo-walkstep-wrapper"></div></td><td class="mstrmojo-walkcell mstrmojo-ConditionWalk-targetNode"><div class="mstrmojo-walkstep-wrapper"><div class="mstrmojo-walkstep-browse">'+mstrmojo.desc(7926,"Browse...")+'</div></div></td><td class="mstrmojo-walkcell mstrmojo-ConditionWalk-fmNode"><div class="mstrmojo-walkstep-wrapper"></div></td><td class="mstrmojo-walkcell mstrmojo-ConditionWalk-esNode"><div class="mstrmojo-walkstep-wrapper"><div class="mstrmojo-walkstep-browse">'+mstrmojo.desc(7928,"Browse elements...")+'</div></div></td><td class="mstrmojo-walkcell mstrmojo-ConditionWalk-fnNode"><div class="mstrmojo-walkstep-wrapper"></div></td><td class="mstrmojo-walkcell mstrmojo-ConditionWalk-c0Node"><div class="mstrmojo-walkstep-wrapper"></div></td><td class="mstrmojo-walkcell mstrmojo-ConditionWalk-fm2Node"><div class="mstrmojo-walkstep-wrapper"></div></td><td class="mstrmojo-walkcell mstrmojo-ConditionWalk-btwnNode"><div class="mstrmojo-walkstep-wrapper">{@betweenText}</div></td><td class="mstrmojo-walkcell mstrmojo-ConditionWalk-c1Node"><div class="mstrmojo-walkstep-wrapper"></div></td><td class="mstrmojo-walkcell mstrmojo-ConditionWalk-fm3Node"><div class="mstrmojo-walkstep-wrapper"></div></td><td class="mstrmojo-walkcell mstrmojo-ConditionWalk-atNode"><div class="mstrmojo-walkstep-wrapper">{@atText}</div></td><td class="mstrmojo-walkcell mstrmojo-ConditionWalk-dmyNode"><div class="mstrmojo-walkstep-wrapper"><div class="mstrmojo-walkstep-browse">'+mstrmojo.desc(7925,"Select Attribute...")+'</div></div></td><td class="mstrmojo-walkcell mstrmojo-ConditionWalk-okNode"><div class="mstrmojo-walkstep-wrapper"><div></div></td></tr></table>',markupSlots:{notNode:function(){return this.domNode.rows[0].cells[0].firstChild;},targetNode:function(){return this.domNode.rows[0].cells[1].firstChild;},fmNode:function(){return this.domNode.rows[0].cells[2].firstChild;},esNode:function(){return this.domNode.rows[0].cells[3].firstChild;},fnNode:function(){return this.domNode.rows[0].cells[4].firstChild;},c0Node:function(){return this.domNode.rows[0].cells[5].firstChild;},fm2Node:function(){return this.domNode.rows[0].cells[6].firstChild;},btwnNode:function(){return this.domNode.rows[0].cells[7].firstChild;},c1Node:function(){return this.domNode.rows[0].cells[8].firstChild;},fm3Node:function(){return this.domNode.rows[0].cells[9].firstChild;},atNode:function(){return this.domNode.rows[0].cells[10].firstChild;},dmyNode:function(){return this.domNode.rows[0].cells[11].firstChild;},okNode:function(){return this.domNode.rows[0].cells[12].firstChild;}},markupMethods:{onvisibleChange:function(){this.domNode.style.display=this.visible?D.DISPLAY_TABLE:"none";},onobjectBrowsingEnabledChange:function(){this.targetNode.firstChild.style.display=this.objectBrowsingEnabled?"":"none";}},okBtn:undefined,updateBrowseElementsParams:function(AP,AO){AP.attributeID=AO.did;},children:[L({alias:"target",insertUnlistedValuesAt:0,makeObservable:true,hideIfEmpty:true,update:function(){var AS=this.parent,AP=AS.model;if(this.lastModel!==AP){this.lastModel=AP;var AO=AS.targets,AU=AS.ets;if(AU&&AO&&AO.length){var AR=AN(AS.ets);AO=w.filter(AO,function(AV){return AR[AV[C]];});}else{AO=AO?AO.concat():[];}var AT=AP&&AP.et,AQ=AP&&AP[X[AT]];q(this,true,AO,AQ);}}}),e({alias:"fm",fmPost:"",filter:false}),L({alias:"es",itemIdField:"v",insertUnlistedValuesAt:0,makeObservable:true,itemMarkupFunction:function(AP,AO,AQ){var AR=AB(AP.n);return'<div class="dial-checkitem '+AP.css+'" title="'+AR+'">'+AR+"</div>";},multiSelect:true,selectionPolicy:"toggle",postCreate:function W(){x.apply(this,[]);this.ajx=mstrmojo.insert({parent:this,scriptClass:"mstrmojo.AjaxCall",isTask:true,params:{taskId:"browseElements",attributeID:null,styleName:"MojoAttributeStyle",blockBegin:1,blockCount:mstrApp.elementsBlockCount||30},onsuccess:function(){var AQ=this.parent,AO=this.response;if((AO&&AO.did)!==AQ.lastAttrId){return ;}var AP=(AO&&AO.es)?AO.es.concat():[];m(AQ,AP,AQ.parent.model&&AQ.parent.model.es,null);},onerr:function(){E(this.parent,r,[J]);}});},update:function R(){var AU=this.parent,AQ=AU.model,AT=AQ&&AQ.a,AV=!!AT&&!AT.ilk,AW,AO,AS,AX;if(AV){if(this.lastAttrId!==AT.did){this.lastAttrId=AT.did;AW=AQ.es;var AR=AW&&AW.length;AW=AR?AW.concat():[];AW.push(r);if(AR){AS=[];for(var AP=1;AP<=AR;AP++){AS[AP]=AP;}}AX=this.ajx;AU.updateBrowseElementsParams(AX.params,AT);}else{AO=AQ.es;}}c(this,AV,AW,AO,AS);if(AV&&AX){AX.send();}}}),L({alias:"fn",allowUnlistedValues:false,update:function(){var AO=this.parent,AQ=AO.model||{},AU=AQ.et,AT,AV=false,AW,AP;switch(AU){case M.AE:AV=!!AQ.a;break;case M.AQ:case M.AC:case M.AL:AV=!!(AQ.fm&&AQ.fm.did);AT=AV?AQ.fm.dtp:null;break;case M.MQ:case M.MC:AV=!!AQ.m;AT=AV?S.METRIC_DTP:null;break;}if(AV){var AX=n[AT];if((this.lastEt!==AU)||(this.lastFnDtp!==AX)){this.lastEt=AU;this.lastFnDtp=AX;var AS=AU?z[AU]:null,AR=AS&&AS.key;AW=(AR&&AO[AR])||AS.def||[];if(typeof (AW)==="object"){AW=AW[AX]||AW["*"];}}AP=AM(AQ.fn,AQ.fnt||1);}q(this,AV,AW,AP);}}),g({alias:"c0",cstIndex:0}),e({alias:"fm2",fmPost:"2"}),g({alias:"c1",cstIndex:1}),e({alias:"fm3",fmPost:"3"}),L({alias:"dmy",itemIdField:"did",hideIfEmpty:true,itemMarkupFunction:function(AP,AO,AQ){var AR=AB(AP.n);return'<div class="dial-checkitem '+AP.css+'" title="'+AR+'">'+AR+"</div>";},multiSelect:true,selectionPolicy:"toggle",insertUnlistedValuesAt:0,makeObservable:true,postCreate:function(){x.apply(this,[]);this.set("items",j(this.parent));},update:function u(){var AQ=this.parent,AU=AQ.model,AW=AU.et,AZ=AU&&AU.m,AX=!!AZ&&(AU.fn!==null)&&((AW===M.MQ)||(AW===M.MC))&&AU.dimtyTypes[I.NodeDimtyOutputLevel],AV,AR;if(AX){var AS=this.targetsLastMod,Aa=AQ.targetsLastMod;if(!AS||!Aa||(AS!=Aa)){this.targetsLastMod=AQ.targetsLastMod;AV=j(AQ);}AR=[];var AP=AU.dmy&&AU.dmy.uts;for(var AY=0,AO=(AP&&AP.length)||0;AY<AO;AY++){var AT=AP[AY];AR.push(AT.utgt?AT.utgt:AT);}}c(this,AX,AV,AR);AH(AQ,"atNode",AX);}}),{alias:"okBtn",slot:"okNode",scriptClass:"mstrmojo.HTMLButton",cssClass:"mstrmojo-Editor-button",text:mstrmojo.desc(1442,"OK"),cssText:"width:66px;min-width:58px;",onclick:function(){var AO=this.parent;if(AO.onOK){AO.onOK();}}},{alias:"cancelBtn",slot:"okNode",scriptClass:"mstrmojo.HTMLButton",cssClass:"mstrmojo-Editor-button",cssText:"width:66px;min-width:58px;",text:mstrmojo.desc(221,"Cancel"),onclick:function(){var AO=this.parent.parent;if(AO&&AO.close){AO.close();}}}],eb:{scriptClass:"mstrmojo.Editor",cssClass:U.isIE7?"mstrmojo-ElementsEditorIE7":"mstrmojo-ElementsEditor",title:mstrmojo.desc(6149,"Select Elements"),help:"element_browser_dialog_box.htm",children:[{scriptClass:"mstrmojo.ElementsBrowser",alias:"browser",onUpdateBrowseElementsParams:function(AP){var AO=this.parent.opener;AO.updateBrowseElementsParams(AP,AO.model.a);}},{scriptClass:"mstrmojo.HBox",cssClass:"mstrmojo-Editor-buttonBox",slot:"buttonNode",children:[{scriptClass:"mstrmojo.HTMLButton",alias:"ok",text:mstrmojo.desc(1442,"OK"),cssClass:"mstrmojo-Editor-button",cssText:"width:72px;margin-right:2px;",onclick:function(){var AO=this.parent.parent,AP=AO&&AO.opener;if(AP){AP.onEBSelect();AP.closePopup();}}}]}]},ob:{scriptClass:"mstrmojo.Editor",title:mstrmojo.desc(5298,"Select an Object"),help:"Select_Objects_dialog_box_.htm",children:[{scriptClass:"mstrmojo.ObjectBrowser",alias:"browser",cssText:"width:302px;",fishEyeVisible:false,closeable:false,closeOnSelect:false,browsableTypes:"3,4,8,10,12,256",includeObjectDesc:true,quickSearch:true}]},betweenText:mstrmojo.desc(308,"and"),atText:mstrmojo.desc(5923,"at"),model:null,targets:null,ets:null,defaultEt:null,defaultAttrEt:null,metricFns:null,formFns:null,elemFns:null,metricLevels:null,defaultMetricLevel:null,browsableTypes:null,postBuildRendering:function AC(){N.call(this);AI(this);return this._super();},_set_model:function f(AR,AO){var AP=this.model,AQ=(AO!==AP);if(AQ){Z(this,AP);AO.dimtyTypes=this.dimtyTypes||AK;this.model=AO;N.call(this);if(this.hasRendered){AI(this);}}return AQ;},onmodeledit:function(AO){switch(AO&&AO.prop){case"es":case"dmy":v(this);return ;}AI(this);},browse:function t(AO){var AQ=this.parent.editorNode,AP=function(AS,AU){var AR=mstrmojo.dom.position(AS,true),AT=mstrmojo.dom.position(AU,true);return{x:AR.x+AR.w,y:AT.y};};switch(AO&&AO.alias){case"target":case"dmy":AE(this,AO,AP(AO.alias=="target"?this.targetNode:this.dmyNode,AQ));break;case"c0":case"c1":AE(this,AO,AP(AO.alias=="c0"?this.c0Node:this.c1Node,AQ));break;case"es":b(this,AO,AP(this.esNode,AQ));break;}},onOBSelect:function(AR){var AP=this.ob.browser,AT=AP.target;this.closePopup();var AS=AT.itemIdField,AQ=this.targets||[],AO=w.find(this.targets,AS,AR[AS]);if(AO===-1){AQ.push(AR);this.targets=AQ;this.targetsLastMod=new Date();}AT.setSelectedItems([AR],AT.multiSelect);AT.refreshScroll();},onEBSelect:function(){var AO=this.eb.browser;var AP=this.es;AP.set("selectedIndices",{});AP.setSelectedItems(AO.selectedItems,false);},onclick:function AA(AO){var AP=mstrmojo.dom.eventTarget(AO.hWin,AO.e);if(AP==this.targetNode.firstChild){this.browse(this.target);}else{if(AP==this.esNode.firstChild){this.browse(this.es);}else{if(AP==this.dmyNode.firstChild){this.browse(this.dmy);}}}},objectBrowsingEnabled:true});})();(function(){mstrmojo.requiresCls("mstrmojo.css","mstrmojo.date","mstrmojo.DateTextBox","mstrmojo._IsInputControl");var B=mstrmojo.css,A=mstrmojo.expr.DTP;mstrmojo.CalendarDIC=mstrmojo.declare(mstrmojo.DateTextBox,[mstrmojo._IsInputControl],{scriptClass:"mstrmojo.CalendarDIC",autoFormat:false,constraints:{trigger:mstrmojo.validation.TRIGGER.ALL},onvalueChange:function(){if(!this.showByDefault){var F=this.calendar.cal,D=mstrmojo.date,E=this.dic.min,C=this.dic.max;this.invalid=mstrmojo.string.trim(this.value||"").length===0||this.validationStatus.code>mstrmojo.validation.STATUSCODE.VALID;if(F.value!==this.value){F.set("value",this.value);}else{if(E&&D.compareDateAndOrTime(E,F.value)>0){this.value=E;}else{if(C&&D.compareDateAndOrTime(F.value,C)>0){this.value=C;}}}}},getInputNode:function(){return this.inputNode;},init:function(C){this._super(C);this.dtp=this.dic.ict?A.TIMESTAMP:A.DATE;},focus:function(){mstrmojo.dom.setCaret(this.inputNode,((this.value&&this.value.length)||0));this.openPopup("calendar");this.adjustCalendarPopup();},adjustCalendarPopup:function(){var F=this.domNode,E=this.calendar.domNode,D=E.scrollWidth,I=mstrmojo.boxmodel.offset(this.openerNode,document.body),H=I.left,G,C=(document.body.offsetWidth-H-D-parseInt(B.getStyleValue(F,"paddingLeft"),10)-parseInt(B.getStyleValue(F,"paddingRight"),10));if(C<0){E.style.left=C+"px";}G=parseInt(I.top,10);if(G+this.inputNode.offsetHeight+E.offsetHeight<=mstrmojo.dom.windowDim().h){E.style.top=this.inputNode.offsetHeight+"px";}else{E.style.top=-E.offsetHeight+"px";}}});}());(function(){mstrmojo.requiresCls("mstrmojo.Box","mstrmojo.array","mstrmojo.string","mstrmojo.expr","mstrmojo.date","mstrmojo.ValidationTextBox","mstrmojo.DateTextBox");var U=mstrmojo.array,R=mstrmojo.css,J=mstrmojo.string,Q=mstrmojo.date,P=mstrmojo.expr,B=P.FN,E=mstrmojo.validation;var A={};A[B.BETWEEN]=B.NOT_BETWEEN;A[B.NOT_BETWEEN]=B.BETWEEN;A[B.GREATER_EQUAL]=B.LESS;A[B.LESS]=B.GREATER_EQUAL;A[B.LESS_EQUAL]=B.GREATER;A[B.GREATER]=B.LESS_EQUAL;A[B.SEARCH]=B.SEARCH;function I(V){if(this.value!==this._lastInput){S.call(this,V,true);}}function N(V){mstrmojo.DateTextBox.prototype.onclick.call(this,V);R.addClass(this.calendar&&this.calendar.domNode,mstrApp.getThemeClassName());}function S(V,a){var Z=this.parent.parent;if(!Z._inSyncPhase){var X=this.calendar&&this.calendar.cal,Y=this,W=Z.submitTimer;if(W){window.clearTimeout(W);}if(!mstrApp.isWaiting()){if(a||X&&X.value===this.value){this._lastInput=this.value;Z.submit(Y);}else{Z.submitTimer=window.setTimeout(function(){Y._lastInput=Y.value;Z.submit(Y);},3000);this.set("dynDateValue",null);if(X){X.set("value",this.value);}}}else{if(this._lastInput){this.set("value",this._lastInput);}}}}function L(Y){if(!Y.isDyn){return null;}var X=["isDyn"];X.push(Y.dyt||0);X.push(Y.ddo||0);X.push(Y.dmo||0);X.push(Y.dm||0);X.push(Y.dd||0);X.push(Y.dw||0);X.push(Y.dow||0);X.push(Y.v||"");if(Y.dtp===P.DTP.TIMESTAMP){var W=Q.parseDateAndOrTime(Y.v||""),V=W&&W.time;if(V){Y.dh=V.hour;Y.dmi=V.min;Y.ds=V.sec;}}X.push(Y.dh||0);X.push(Y.dmi||0);X.push(Y.ds||0);return X.join("::");}function C(b,V,Y){return{parent:b,dt:V,f:Y,setDataType:function Z(e){this.dt=e;},setFunction:function c(e){this.f=e;},hasSecTextBox:function W(){var e=this.f;return e!==B.SEARCH;},adjustVisibleFields:function a(){var e=this.parent;if(!this.hasSecTextBox()){e.toBox.set("visible",false);e.fromBox.fromLabel.set("visible",false);}if(V===P.DTP.DATE||V===P.DTP.TIMESTAMP){e.fromBox.fromInput.set("visible",false);e.toBox.toInput.set("visible",false);}else{e.fromBox.fromPicker.set("visible",false);e.toBox.toPicker.set("visible",false);}},setMinMaxToInputs:function d(h,g){if(!this.hasSecTextBox()){return ;}var e=h.value&&h.validationStatus&&h.validationStatus.code===E.STATUSCODE.VALID,f=g.value&&g.validationStatus&&g.validationStatus.code===E.STATUSCODE.VALID;if(h.constraints){h.constraints.min=null;h.constraints.max=f?g.value:null;}if(g.constraints){g.constraints.min=e?h.value:null;g.constraints.max=null;}},passValueToInputs:function X(f){var h=this.parent,k,j,g=this,e=function(l,m){if(g.f===B.SEARCH||l.v!=="*"){m.set("value",l.v);m._lastInput=l.v;if(V===P.DTP.DATE||V===P.DTP.TIMESTAMP){m.set("dynDateValue",L(l));}}};if(V===P.DTP.DATE||V===P.DTP.TIMESTAMP){k=h.fromBox.fromPicker;j=h.toBox.toPicker;}else{k=h.fromBox.fromInput;j=h.toBox.toInput;}if(Y===B.BETWEEN||Y===B.NOT_BETWEEN){if(f&&f[0]){e(f[0],k);}else{k.set("value",k.min||"");k._lastInput=k.min||"";}if(this.hasSecTextBox()&&f&&f[1]){e(f[1],j);}else{j.set("value",j.max||"");j._lastInput=j.max||"";}}else{if(Y===B.GREATER_EQUAL||Y===B.LESS){if(f&&f[0]){e(f[0],k);j.set("value",j.max||"");j._lastInput=j.max||"";}}else{if(Y===B.LESS_EQUAL||Y===B.GREATER){if(f&&f[0]){e(f[0],j);k.set("value",k.min||"");k._lastInput=k.min||"";}}}}this.setMinMaxToInputs(k,j);}};}mstrmojo.vi.ui.rw.selectors.AttrQualInputBox=mstrmojo.declare(mstrmojo.Box,[mstrmojo.ui._HasScroller],{scriptClass:"mstrmojo.vi.ui.rw.selectors.AttrQualInputBox",markupString:'<div id="{@id}" class="{@cssClass}" style="{@cssText}"></div>',markupSlots:{containerNode:function(){return this.domNode;}},cssClass:"Attr-Qual-InputBox",children:[{scriptClass:"mstrmojo.Box",alias:"fromBox",cssClass:"from-box",children:[{scriptClass:"mstrmojo.Label",alias:"fromLabel",cssDisplay:"inline-block",cssClass:"input-label",text:"<span>"+mstrmojo.desc(146,"From:")+"</span>",allowHTML:true},{scriptClass:"mstrmojo.ValidationTextBox",alias:"fromInput",cssDisplay:"inline-block",required:false,constraints:{trigger:E.TRIGGER.ALL},autoFormat:false,onEnter:I,onblur:I,_lastInput:null,bindings:{dtp:"this.parent.parent.dt"}},{scriptClass:"mstrmojo.DateTextBox",alias:"fromPicker",cssDisplay:"inline-block",required:false,calendarToBody:true,constraints:{trigger:E.TRIGGER.ALL},autoFormat:false,onvalueChange:S,onEnter:I,onblur:I,_lastInput:null,bindings:{dtp:"this.parent.parent.dt",min:"this.parent.parent.min",max:"this.parent.parent.max",defaultDate:"this.parent.parent.min",showAdvanced:"this.parent.parent.showAdvanced",canSelectDisabledDate:"this.parent.parent.canSelectDisabledDate"},onclick:N}]},{scriptClass:"mstrmojo.Box",alias:"toBox",cssClass:"to-box",children:[{scriptClass:"mstrmojo.Label",alias:"toLabel",cssDisplay:"inline-block",cssClass:"input-label",text:"<span>"+mstrmojo.desc(147,"To:")+"</span>",allowHTML:true},{scriptClass:"mstrmojo.ValidationTextBox",alias:"toInput",cssDisplay:"inline-block",required:false,constraints:{trigger:E.TRIGGER.ALL},autoFormat:false,onEnter:I,onblur:I,_lastInput:null,bindings:{dtp:"this.parent.parent.dt"}},{scriptClass:"mstrmojo.DateTextBox",alias:"toPicker",cssDisplay:"inline-block",required:false,calendarToBody:true,constraints:{trigger:E.TRIGGER.ALL},autoFormat:false,onvalueChange:S,onEnter:I,onblur:I,_lastInput:null,bindings:{dtp:"this.parent.parent.dt",min:"this.parent.parent.min",max:"this.parent.parent.max",defaultDate:"this.parent.parent.max",showAdvanced:"this.parent.parent.showAdvanced",canSelectDisabledDate:"this.parent.parent.canSelectDisabledDate"},onclick:N}]}],setupScrollNodes:function F(){this.scrollNode=this.supportScrollbar?this.containerNode:null;},widgetResized:function(){var Y=this,V=parseInt(this.width,10),W=["fromBox","toBox"],Z,X,a;if(!this.widgetHelper.hasSecTextBox()){W=["fromBox"];}if(V>368){X=true;}else{X=false;}if(Y.parent.isInFilterPanel()||!this.widgetHelper.hasSecTextBox()){X=false;return ;}window.setTimeout(function(){Z=Y.hasRendered;if(Y.fromBox&&Y.fromBox.domNode){a=Y.fromBox.fromLabel.domNode.children[0].offsetWidth+Y.fromBox.fromPicker.domNode.offsetWidth;a+=Y.toBox.toLabel.domNode.children[0].offsetWidth+Y.toBox.toPicker.domNode.offsetWidth;a+=80;}U.forEach(W,function(b){if(Z){if(a>V){X=false;}R.toggleClass(Y[b].domNode,"onerow",X);Y[b].domNode.style.display=X?"inline-block":"block";}else{if(X){R.addWidgetCssClass(Y[b],"onerow");Y[b].cssDisplay="inline-block";}else{R.removeWidgetCssClass(Y[b],"onerow");Y[b].cssDisplay="block";}}});if(Y.supportScrollbar){Y.updateScrollbars();}},0);},init:function O(V){if(this._super){this._super(V);}if(this.supportScrollbar){mstrmojo.hash.copy({markupString:'<div id="{@id}" class="{@cssClass}" style="{@cssText}"><div style="height: {@height}; width: {@width}"></div></div>',markupSlots:{containerNode:function(){return this.domNode.firstChild;}}},this);}this.widgetHelper=C(this,this.dt,this.f);this.updateWidgetByData();},update:function D(V){if(V){this.cs=V.cs;if(V.f){this.f=V.f;}if(V.ft){this.ft=V.ft;}if(V.fid){this.fid=V.fid;}if(V.min){this.set("min",V.min);}if(V.max){this.set("max",V.max);}}this.updateWidgetByData();},updateWidgetByData:function M(){var V=this.widgetHelper,W=this.cs;this._inSyncPhase=true;V.adjustVisibleFields();V.passValueToInputs(W);this._inSyncPhase=false;},onincludeChange:function G(){this.f=A[this.f];if(!this._inSyncPhase){this.onchange();}},submit:function H(c){var a=this.cs=[],Y=this.parent.include,X=this.widgetHelper,W=(c.validationStatus.code===E.STATUSCODE.VALID),f=this.parent.model,d=c,e=c,Z;if(X.hasSecTextBox()){if(c.alias==="toInput"){Z=this.fromBox.fromInput;}else{if(c.alias==="toPicker"){Z=this.fromBox.fromPicker;}else{if(c.alias==="fromInput"){Z=this.toBox.toInput;}else{if(c.alias==="fromPicker"){Z=this.toBox.toPicker;}}}}d=(c.alias.indexOf("from")===0)?c:Z;e=(c.alias.indexOf("to")===0)?c:Z;X.setMinMaxToInputs(d,e);Z.validate();if(Z.validationStatus.code!==E.STATUSCODE.VALID){W=false;}}if(W){if(X.hasSecTextBox()){var V=d.dynDateValue||d.value,b=e.dynDateValue||e.value;this.unset=J.isEmpty(V)&&J.isEmpty(b);if(!J.isEmpty(V)&&!J.isEmpty(b)){a[0]={v:V};a[1]={v:b};this.f=Y?B.BETWEEN:B.NOT_BETWEEN;}else{if(!J.isEmpty(V)){if(f.isFromSolrCube&&f.isFromSolrCube(this.srcid)){a[0]={v:V};a[1]={v:"*"};this.f=Y?B.BETWEEN:B.NOT_BETWEEN;}else{a[0]={v:V};this.f=Y?B.GREATER_EQUAL:B.LESS;}}else{if(!J.isEmpty(b)){if(f.isFromSolrCube&&f.isFromSolrCube(this.srcid)){a[0]={v:"*"};a[1]={v:b};this.f=Y?B.BETWEEN:B.NOT_BETWEEN;}else{a[0]={v:b};this.f=Y?B.LESS_EQUAL:B.GREATER;}}}}X.setMinMaxToInputs(d,e);}else{a[0]={v:c.value};this.unset=J.isEmpty(a[0].v);this.f=B.SEARCH;}this.onchange();if(this.makeSelection){this.makeSelection({selItem:this.domNode});}}},getSummaryText:function K(){var X=this.cs||[],Y=this.f;if(this.unset||!X.length||J.isEmpty(X[0].v)&&(X.length<=1||J.isEmpty(X[1].v))){return"";}var W="",V=this.parent.include;switch(Y){case B.BETWEEN:case B.NOT_BETWEEN:W=mstrmojo.desc(4804).replace("##",X[0].v).replace("###",X[1].v);break;}if(!V){W=mstrmojo.desc(1099,"Not")+" "+W;}return W;}});}());(function(){mstrmojo.requiresCls("mstrmojo.array","mstrmojo.Model","mstrmojo.Container","mstrmojo.Button","mstrmojo.Label","mstrmojo.DateTextBox","mstrmojo.TextArea","mstrmojo.ui.CheckList","mstrmojo.ui.Pulldown","mstrmojo.ui.MultiSelectPulldown","mstrmojo.ui.editors.controls.TwoColumnContainer","mstrmojo._HasPopup");mstrmojo.requiresDescs(2,3,520,686,687,688,698,699,1050,5688,6013,8956,9163);var H=mstrmojo.desc,I=mstrmojo.array,C=mstrmojo.hash,K=mstrmojo.validation,F=mstrmojo.Button.newWebButton;var J;var E=function(P,N,O){if(!this.hasRendered){return ;}mstrmojo.all[J].model.settings[P]=N;if(O!==false){mstrmojo.all[J].onmodelChange();}};var G=function(O,N){N=N||{};return C.copy(N,{scriptClass:"mstrmojo.ui.CheckList",orientation:N.isVertical===false?"h":"v",multiSelect:!N.isRadio,items:O});};var L=function(P,O,N){return new mstrmojo.Box({alias:N,cssClass:"mstrmojo-SearchSettings-panel "+N,cssDisplay:"inline-block",children:[{scriptClass:"mstrmojo.Label",text:P}].concat(O)});};var B=function(N){var O=this;return{scriptClass:"mstrmojo.DateTextBox",alias:N,cssDisplay:"block",cssClass:N,width:120,required:false,calendarToBody:true,calendarZIndex:112,constraints:{trigger:K.TRIGGER.ALL},autoFormat:false,bindings:{value:function(){return O.model.settings[N];}},onfocus:function(){this.parent.parent.dateSubType.set("selectedIndex",1);},getSetting:function(){return{p:this.alias,v:this.value};}};};mstrmojo.mstr.search.SearchSettings=mstrmojo.declare(mstrmojo.Container,[mstrmojo._HasPopup],{scriptClass:"mstrmojo.mstr.search.SearchSettings",visible:false,markupString:'<div class="mstrmojo-SearchSettings {@cssClass}" style="{@cssText}"><div class="mstrmojo-SearchSettings-container"></div></div>',markupSlots:{containerNode:function(){return this.domNode.firstChild;}},markupMethods:{onvisibleChange:mstrmojo.Widget.visibleMarkupMethod},onmodelChange:mstrmojo.emptyFn,init:function M(N){if(this._super){this._super(N);}J=this.id;},postBuildRendering:function A(){var O=this;this.prepareObjectTypes();var N=[];this.addChildren([L(H(8956,"Object type"),{scriptClass:"mstrmojo.ui.MultiSelectPulldown",alias:"objectType",isHostedWithin:true,orientation:"v",multiSelect:true,items:I.map(this.allowedObjectTypesData,function(R,Q){if(I.indexOf(O.model.settings.objectType,R.t)>-1){N[Q]=true;}return{n:R.d,t:R.t};}),selectedIndices:N,allIdx:-1,onselectionChanged:function(){var Q=this.items;E.call(this,this.alias,I.map(C.keyarray(this.selectedIndices),function(R){return Q[R].t;}));},onchange:function(){var Q=this.items;E.call(this,this.alias,I.map(C.keyarray(this.selectedIndices),function(R){return Q[R].t;}));},getPopupWidget:function P(){var Q=this;this.popupWidget.onClose=function(){this.list.selectedIndices=mstrmojo.hash.copy(Q.selectedIndices);this.list.refresh();};return this.popupWidget;}},"objectTypePanel"),L(H(60,"Owner"),mstrmojo.ui.Pulldown.newPulldown([{n:H(698,"Created by any user"),v:1},{n:H(699,"Created only by me"),v:2}],function(Q,R){if(Q.v!==R.v){E.call(this,this.alias,Q.v);}},0,{alias:"ownerType"}),"ownerPanel"),L(H(2052,"Date"),[mstrmojo.ui.Pulldown.newPulldown([{n:mstrmojo.desc(2058,"All"),v:0},{n:mstrmojo.desc(694,"Created"),v:1},{n:mstrmojo.desc(61,"Modified"),v:2}],function(Q,R){if(Q.v!==R.v){E.call(this,"dateType",Q.v===0?1:2,false);E.call(this,this.alias,Q.v,Q.v===0);}},0,{alias:"created",cssClass:"mstrmojo-SearchSettings-date-pulldown"}),mstrmojo.Button.newIconButton(H(5688,"Show dates"),"mstrmjo-SearchSettings-calendar",function(){this.parent.datePopup.open();},{visible:function(){var Q=this.parent.created.selectedIndex!==0;if(Q){this.parent.datePopup.open();}return Q;}},{alias:"calIcon"}),{scriptClass:"mstrmojo.ui.PopupWidget",cssClass:"mstrmojo-SearchSettings-dates-popupWidget",alias:"datePopup",visible:false,children:[{scriptClass:"mstrmojo.ui.editors.controls.TwoColumnContainer",alias:"dateContainer",cssClass:"mstrmojo-SearchSettings-dates",width:"238px",col1Width:"80px",col2Width:"130px",children:[G([{n:mstrmojo.desc(4049,"Last"),v:1},{n:mstrmojo.desc(294,"Between"),v:2}],{alias:"dateSubType",isRadio:true,bindings:{selectedIndex:function(){return I.find(this.items,"v",O.model.settings.dateSubType);}},postselectionChange:function(){if(this.hasRendered){if(this.selectedIndex===0){this.parent.intervalBox.intervalValue.inputNode.focus();}else{this.parent.intervalBox.startDate.inputNode.focus();}}},getSetting:function(){return{p:this.alias,v:this.items[this.selectedIndex].v};},slot:"col1Node"}),{scriptClass:"mstrmojo.Box",cssDisplay:"inline-block",alias:"intervalBox",children:[{scriptClass:"mstrmojo.TextBox",alias:"intervalValue",cssClass:"intervalValue",cssDisplay:"inline-block",size:1,maxLength:4,bindings:{value:function(){return mstrmojo.all.searchSettings.model.settings.intervalValue;}},onvalueChange:function(){},onfocus:function(){this.parent.parent.dateSubType.set("selectedIndex",0);},getSetting:function(){return{p:this.alias,v:this.value||""};}},mstrmojo.ui.Pulldown.newPulldown([{n:mstrmojo.desc(708,"Hours"),v:1},{n:mstrmojo.desc(707,"Days"),v:2},{n:mstrmojo.desc(714,"Weeks"),v:3},{n:mstrmojo.desc(710,"Months"),v:4},{n:mstrmojo.desc(709,"Years"),v:5}],function(Q,R){if(Q.v!==R.v){}},0,{alias:"intervalUnit",cssClass:"intervalUnit",cssDisplay:"inline-block",getSetting:function(){return{p:this.alias,v:this.items[this.selectedIndex].v};}}),B.call(this,"startDate"),B.call(this,"endDate")],slot:"col2Node"}]},{scriptClass:"mstrmojo.Box",cssClass:"mstrmojo-Buttons",children:[F(mstrmojo.desc(1442,"Ok"),function(){var R=this.parent.parent.dateContainer,Q=R.intervalBox;var S=[R.dateSubType,Q.intervalValue,Q.intervalUnit,Q.startDate,Q.endDate];I.forEach(S,function(U){var V=U.getSetting();mstrmojo.all[J].model.settings[V.p]=V.v;mstrmojo.all[J].onmodelChange();});this.parent.parent.close();},true,{cssDisplay:"inline-block"}),F(mstrmojo.desc(2140,"Cancel"),function(){this.parent.parent.close();},false,{cssDisplay:"inline-block"})]}]}],"datepanel"),L(H(6013,"Description (contains)"),{scriptClass:"mstrmojo.TextArea",alias:"description",rows:1,bindings:{value:function(){return mstrmojo.all.searchSettings.model.settings.description;}},onvalueChange:function(){E.call(this,this.alias,this.value);}},"descriptionPanel")]);if(this._super){this._super();}},prepareObjectTypes:function D(){var P=[],Q=[];this.allowedObjectTypes=this.allowedObjectTypesData.concat([]);I.forEach(this.allowedObjectTypes,function(S,R){P[R]=parseInt(S.t,10);Q[P[R]]=S.d;});if(this.allowedObjectTypes.length===0){this.model.settings.objectType=[];return ;}var N=this.allowedObjectTypes,O=this.model.settings.objectType;I.forEach([].concat(O),function(R){I.removeItems(O,"t",I.find(N,"t",parseInt(R,10))===-1?[R]:null);});if(O.length===0&&!(this.isMiniSearchBox||this.isDesktopSearchBox)){O=I.map(this.allowedObjectTypes,function(R){return R.t;});}this.model.settings.objectType=O;}});mstrmojo.mstr.search.SearchSettings.getLocationPulldown=function(N){var P=[{n:mstrApp.projectAlias||mstrConfig.projectName,v:39},{n:H(2,"Shared Reports"),v:7},{n:H(3,"My Reports"),v:20}],Q=0;if(N.rootFolderType===0){P.push({n:N.rootFolderName||"",v:0});Q=3;}else{Q=I.find(P,"v",N.rootFolderType);}return mstrmojo.ui.Pulldown.newPulldown(P,function O(R,S){if(R.v!==S.v){E.call(this,"rootFolderType",R.v);}},Q,mstrmojo.hash.copy(N,{cssDisplay:"inline-block"}));};mstrmojo.mstr.search.SearchSettings.getSearchTypePulldown=function(N){return mstrmojo.ui.Pulldown.newPulldown([{n:H(686,"Contains"),v:N.qse?16:1},{n:H(520,"Exactly"),v:2},{n:H(687,"Begins With"),v:4},{n:H(688,"Ends with"),v:8}],function O(P,Q){if(P.v!==Q.v){E.call(this,"nameWildcards",P.v);}},0,mstrmojo.hash.copy(N,{cssDisplay:"inline-block",cssClass:"searchType"}));};}());(function(){mstrmojo.requiresCls("mstrmojo.Obj","mstrmojo.array","mstrmojo.Arr","mstrmojo.AjaxCall","mstrmojo.css","mstrmojo.Calendar","mstrmojo.WidgetDial","mstrmojo.Label","mstrmojo.dom","mstrmojo.expr","mstrmojo.hash","mstrmojo.registry","mstrmojo.string","mstrmojo.ListBase","mstrmojo._IsList","mstrmojo.ValidationTextBox","mstrmojo.DateTextBox","mstrmojo.mstr.EnumDataType","mstrmojo.mstr.EnumDSSXMLObjectTypes","mstrmojo.mstr.EnumDSSXMLObjectSubTypes","mstrmojo.mstr.EnumDSSConsolidationType");var t=mstrmojo.array,AI=t.map,J=mstrmojo.Arr,E=mstrmojo.css,V=mstrmojo.dom,W=mstrmojo.hash,AJ=mstrmojo.string,A=mstrmojo.registry,U=mstrmojo.expr,O=U.ET,h=mstrmojo.mstr.EnumDataType,l=U.ET2TP,X=U.ET2TGT,AF=U.DTP,D=mstrmojo.meta.TP,P=mstrmojo.meta.STP,AP=mstrmojo.mstr.EnumDSSXMLObjectTypes,AB=mstrmojo.mstr.EnumDSSXMLObjectSubTypes,G=mstrmojo.mstr.EnumDSSConsolidationType;var f="dummy",K={did:"idErr",v:"idErr",n:mstrmojo.desc(7929,"Error loading data."),t:f,css:"unselectable",cls:"temp"},q={did:"idWait",v:"idWait",n:mstrmojo.desc(2901,"Loading..."),t:f,css:"unselectable",cls:"temp"},C={did:"idAttribute",v:"idAttribute",n:mstrmojo.desc(518,"Attribute"),t:f,css:"unselectable"},AD={did:"idMetric",v:"idMetric",n:mstrmojo.desc(517,"Metric"),t:f,css:"unselectable"},AC={did:"idSelect",v:"idSelect",n:mstrmojo.desc(547,"Select"),t:f,css:"unselectable"},w={did:"idWait",v:"idQualification",n:mstrmojo.desc(5225,"Qualification"),t:f,css:"unselectable"},B={did:"idWait",v:"idQualification",n:mstrmojo.desc(15008,"Qualify on"),t:f,css:"unselectable"};var AO={};AO[AF.DATE]=1;AO[AF.TIME]=1;AO[AF.TIMESTAMP]=1;var x={};x[O.MQ]={key:"metricFns",def:U.METRIC_FNS};x[O.MC]={key:"metricFns",def:U.METRIC_FNS};x[O.AQ]={key:"formFns",def:U.FORM_FNS};x[O.AL]={key:"formFns",def:U.FORM_FNS};x[O.AC]={key:"formFns",def:U.FORM_FNS};x[O.AE]={key:"elemFns",def:U.ELEM_FNS};var S=[U.STP.PROMPT,U.STP.PROMPT_OBJECTS,U.STP.PROMPT_ELEMENTS,U.STP.PROMPT_EXPRESSION,U.STP.PROMPT_EXPRESSION_DRAFT];function Z(AQ){if(AQ&&AQ.t===AP.Consolidation&&AQ.st===AB.ConsolidationManaged){return true;}return false;}function F(AS,AU,AR){var AT=AS.items,AQ=t.indexOf(AT,AU);if((AQ===0)&&(AT.length===1)){AR=mstrmojo.Arr.makeObservable((AR&&AR.length)?AR.concat():[]);AS.set("items",AR);}else{if(AQ>-1){AT.splice(AQ,1);}if(AR&&AR.length){t.insert(AT,(AQ>-1)?AQ:AT.length,AR);}AS.refresh();}}function b(AY,AX){if(this.updating){return ;}var AQ=this.multiSelect,AS=this.selectedItem,AV=AY&&AY.added,AU=AY&&AY.removed;AX=AX||this.alias;if(!AQ&&AV&&AU&&AV[0]===AU[0]){return ;}if(AS&&AS[D]===f){this.updating=true;if(AQ){this.removeSelect([this.selectedIndex]);}else{var AW=AU&&Number(AU[0]);AW=(AW==null)?-1:AW;this.set("selectedIndex",AW);}this.updating=false;}else{var AR=this.parent.parent.parent.model;if(AQ){var AT=this.items;AR.edit(AX,{added:AV&&t.get(AT,AV),removed:AU&&t.get(AT,AU),itemIdField:this.itemIdField});}else{AR.edit(AX,AS);}}}function R(AQ,AS,AT){if(this.updating){return ;}AT=AT||this.alias;var AR=AQ.model;AR.edit(AT,AS);}function u(){var AR=this.parent,AQ=((AR&&AR.cssText)||"").match(/height:\s*(\d*)px/);this.cssText=AQ&&AQ[0];}function N(AQ){return mstrmojo.mixin(AQ,{scriptClass:"mstrmojo.rw.ConditionList",cssClass:"mstrmojo-"+AQ.alias,postCreate:u});}function Y(){var AR=this.parent,AQ=AR.parent;AQ["invalid"+AR.cstIndex]=false;}function n(AS,AQ,AT){var AR=AS.cfg;if(AR){AR.data=AS;AR.parent=AT;return A.ref(AR);}AR=new mstrmojo.Label({text:AS.n||"&nbsp;",cssClass:"dial-item "+(AS.t?("t"+AS.t):"")});AR.markupMethods.onselectedChange=function(){E.toggleClass(this.domNode,["selected"],this.selected);};AR.data=AS;AR.parent=AT;return AR;}function AA(AQ){switch(AQ){case h.DataTypeInteger:case h.DataTypeUnsigned:case h.DataTypeDecimal:case h.DataTypeReal:case h.DataTypeDouble:case h.DataTypeFloat:case h.DataTypeCellFormatData:return h.DataTypeNumeric;default:return AQ;}}function H(AS,AR){var AQ=AS.model||{},AT=AQ.fn;return(AT!=null)&&((AQ.et===O.MQ)||(AQ.et===O.MC)||(AQ.et===O.AQ)||(AQ.et===O.AL)||(AQ.et===O.AC))&&(U.fnCstCount(AT,AQ.fnt)>AR);}function p(AR){var AU=AR&&l[AR.et],AT=AR&&AR.fm&&AR.fm.dtp,AQ=AT&&U.DTP2PROMPT_STP[AT],AS={};AS[AU]=true;if(AQ){AS[AQ]=true;}return AS;}function AL(AQ,AS){var AR;if(AS){switch(X[AQ.et]){case"a":AR=AS[O.AC];break;case"m":AR=AS[O.MC];break;default:AR=false;break;}}else{AR=true;}return AR&&U.fn_AC_MC(AQ&&AQ.fn);}function k(AQ){var AT=AQ.model,AX=AT&&AT[X[AT.et]]&&AT[X[AT.et]][AQ.columnWalk.target.itemIdField||"did"],AS=AT&&AT.fm,AZ=AS&&AS.dtp,AR=AL(AT,AQ.ets);if(this.targetsLastMod&&this.targetsLastMod===AQ.targetsLastMod&&AX&&AX===this._lastTargetId&&this.lastFmDtp===AZ&&this.lastFnTp===AR){return ;}if(!AR){this.clearSelect();if(this.items.length!==this.preLen){this.set("items",this.items.slice(0,this.preLen));}}else{var AV=AT.a?[C]:AT.m?[AD]:[],AU=e(AQ),AY=AV.concat(AU),AW=this.items.slice(this.preLen);t.forEach(AW.reverse(),function(Aa){this.remove(Aa);},this);this.add(AY,-1);}this._lastTargetId=AX;this.lastFnTp=AR;this.lastFmDtp=AZ;this.targetsLastMod=AQ.targetsLastMod;}function e(AQ){var AR=AQ.model,AS=p(AR),AT=AR[X[AR.et]];return U.getSortedObjectsByTypeGroup(t.filter(AQ.targets,function(AU){return(AU.t!==4||AU.did!==AT.did)&&(AS[AU[D]]||AS[AU[P]]);}));}function a(AR,AQ){var AS=AR.model||{},AT=AS.cs,AU=AT&&AT[AQ];if(AS.et==O.MC&&AS["c"+(AQ+2)]){AU=AS["c"+(AQ+2)];}return AU;}function I(AQ,AT){var AS=AQ.model||{},AR;switch(AS.et){case O.MC:case O.MQ:AR=(AT&&AT.dtp)||AA(AS.m.dt)||U.METRIC_DTP;if(AR===AF.BIGDECIMAL){AR=U.METRIC_DTP;}break;case O.AQ:case O.AC:case O.AE:case O.AL:AR=AS.fm&&AS.fm.dtp;break;}return AR||AF.CHAR;}function AN(AR,AS){if(!AR){return AR;}if(AR.dtp===AF.BIGDECIMAL&&AS===O.MQ){var AQ=String(AR.v);if(AQ&&AQ.indexOf("#")===-1){return"#"+AQ+"#";}else{return AQ;}}else{return AR.v;}}function z(AR,AQ){var AT=AR.model||{},AU=AT.cs,AV,AS;if(AT.et===O.AL){AS=[];t.forEach(AU,function(AW){AS.push(AW&&AW.v);});AS=AS.join(mstrConfig.listSep);}else{AV=a(AR,AQ);AS=AN(AV,AT.et);}return AS;}function L(Ak,Ac){Ak.updating=true;var AY=Ak.parent.parent.parent,Aj=H(AY,Ac),Ad,Ae;if(Aj){k.call(Ak,AY);var AT=AY.model||{},Ai=a(AY,Ac),AZ=I(AY,Ai),Ab=z(AY,Ac);var AX=AT.fn,AV=U.fn_List(AX,AT.fnt),Al=AO[AZ],Af=Al&&!AV;var AR=Ak.ctxtBuilder,Ah=AR&&AR.itemWidgets,AS=Al?(Af?Ak.calIndex:Ak.dtxtIndex):Ak.txtIndex,AW;for(Ad=0,Ae=Ak.preLen;Ad<Ae;Ad++){AW=Ah[Ad];if(Ad==AS){AW.set("dtp",AZ);AW.set("isList",AV);var AQ=AW.value,AU=AJ.isEmpty(AQ),Ag=AJ.isEmpty(Ab);if(!(AU&&Ag)&&AQ!==Ab){AW.set("value",Ab);}AW.set("visible",true);AW.set("hint",AV?mstrmojo.desc(8191,"value1## value2## ...## valueN").replace(/##/g,mstrConfig.listSep||";"):"");try{if(Ak.alias!=="c1"||Ak.parent.c1Selected){AW.focus&&AW.focus();}}catch(Aa){}if(AX===1||AX===2){AW.constraints.min=0;}if(AW.clearValidation){AW.clearValidation();}}else{AW.set("visible",false);}}if(AY.hasPrompt&&Ak.selectedItem&&Ak.selectedItem.st===U.STP.PROMPT_STRING){AY.invalid0=false;}switch(AT.et){case O.AQ:case O.AL:case O.MQ:if(Ai&&Ai.p){Ak.set("selectedItem",Ai.p);}else{Ak.set("selectedIndex",AS);}break;case O.MC:case O.AC:Ak.set("selectedItem",AT[X[AT.et]+(2+Ac)]);break;}}Ak.updating=false;}function AK(){var AT=this.parent,AR=AT.parent.parent.parent,AS=(this.isValid&&this.isValid())||(!this.isValid&&!AJ.isEmpty(this.value)),AQ=AR.model;AR["invalid"+AT.cstIndex]=!AS;if(!this.updating&&AS){this.updating=true;if(AQ){AQ.edit(AT.alias,{v:this.value,dtp:this.dtp});}this.updating=false;}if(AR.updateOkBtn){AR.updateOkBtn();}}function j(AR){var AQ=[{did:660,cfg:{scriptClass:"mstrmojo.ValidationTextBox",required:true,constraints:{trigger:mstrmojo.validation.TRIGGER.ONKEYUP|mstrmojo.validation.TRIGGER.VALUESET},onValid:AK,onInvalid:AK,onClearValidation:Y,size:6,visible:false}},{did:154,cfg:{scriptClass:"mstrmojo.Calendar",onvalueChange:AK,visible:false}},{did:23,cfg:{scriptClass:"mstrmojo.DateTextBox",cssText:"margin-left:9px;",cssDisplay:"inline-block",required:true,constraints:{trigger:mstrmojo.validation.TRIGGER.ALL-mstrmojo.validation.TRIGGER.ALL.ONBLUR},onValid:AK,onInvalid:AK,onClearValidation:Y,calendarToBody:true,autoFormat:false,calConfig:{onmousedown:function(AS){V.stopPropogation(AS.hWin,AS.e);}},visible:false}}];return N(W.copy(AR,{scriptClass:"mstrmojo.WidgetDial",makeObservable:true,itemFunction:n,selectionPolicy:"reselect",items:AQ.concat(),txtIndex:0,calIndex:2,dtxtIndex:2,preLen:AQ.length,insertUnlistedValuesAt:-1,itemIdField:"did",update:function(){L(this,this.cstIndex);this.parent.updateScrollbars();},postCreate:function(){this._super();this.parent.parent.parent.attachEventListener("updateTargets",this.id,function(){this.update();});},itemsEffect:undefined,onchange:b}));}function AM(AR,AQ){var AS=AQ+U.FN_SEP+AR;return(AR!=null)?{did:AS,n:AS}:null;}function Q(AS){var AU=this.selectedItem;AS=t.filter(AS,function(AV){return(!AV.icf);});if(AU){var AR=t.find(AS,this.itemIdField,AU[this.itemIdField]);if(AR>-1){AS=AS.concat();AS.splice(AR,1);}}F(this,q,AS);var AT=this.items,AQ=AT.length;if(AQ===1){this.singleSelect(0);}this.updateScrollbars&&this.updateScrollbars();this.parent.updateScrollbars();}function o(AS,AR,AT,AW){AS.updating=true;if(AR){if(AT!=null){AS.set("items",[]);AS.clearSelect();AS.set("items",AT);}var AV=AS.itemIdField,AU=AS.selectedItem;if((AU&&AU[AV])!=(AW&&AW[AV])){var AQ=Math.max(t.indexOf(AI((AT||[]),function(AX){return AX[AV];}),AW&&AW[AV]),0);AS.set("selectedIndex",AQ);}}AS.updating=false;}function M(AS,AR,AT,AW){AS.updating=true;if(AR){if(AT!=null){AS.set("items",AT);}var AV=AS.itemIdField,AU=AS.getSelectedItem();if((AU&&AU[AV])!=(AW&&AW[AV])){var AQ=Math.max(t.indexOf(AI((AT||[]),function(AX){return AX[AV];}),AW&&AW[AV]),0);AS.set("selectedIndex",AQ);}}AS.updating=false;}function g(AQ){return N(W.copy(AQ,{insertUnlistedValuesAt:-1,hasDummyLabel:true,postCreate:function(){u.apply(this,[]);this.ajx=mstrmojo.insert({parent:this,scriptClass:"mstrmojo.AjaxCall",isTask:true,readCache:true,writeCache:true,params:{taskId:"getAttributeForms",attributeId:null,displayedForms:"0",styleName:"MojoAttributeStyle"},onsuccess:function(){var AT=this.parent,AS=this.response;if((AS&&AS.did)!==AT.lastAttrId){return ;}Q.call(this.parent,AS.fms||[]);},onerr:function(){F(this.parent,q,[K]);}});},update:function AR(){var Ah=this.fmPost,Aa=this,AU=this.parent.parent.parent,AX=AU.model,Af=AX&&AX["a"+Ah],Ac=!!Af,AW,Ab,Ag,AT=AU.disableElementsBrowsing,AS=Af&&AT&&AT(Af),Ae=Z(Af);if(Ac){switch(AX.et){case O.AQ:case O.AL:Ab=AX.fm;break;case O.AC:Ab=AX["fm"+Ah];break;case O.AE:Ab=AM(AX.fn,1);break;}if(this.lastAttrId!==Af.did){this.lastAttrId=Af.did;AW=[];if(this.isFirstFm){if(!AS&&(!Af.ilk&&(!AU.ets||AU.ets[O.AE]))){if(this.hasDummyLabel){AW.push(AC);}var AZ=x[O.AE],Ad=AZ&&AZ.key,AV=AZ.def;AW=AW.concat((Ad&&AU[Ad])||(Ae?t.filter(AV,function(Ai){return Ai.did!=="1,57";}):AV)||[]);t.forEach(AW,function(Ai){Ai.cls="fn";});}if(this.hasDummyLabel){AW.push(mstrApp.isWSStyling?B:w);}}if(Ab&&(AX.et!==O.AE)){AW.push(Ab);}Ag=this.ajx;Ag.params.attributeId=Af.did;Ag.params.otp=Af.t||12;AW.push(q);J.makeObservable(AW);}}if(AS&&AX.et===O.AE){Ab=null;}o(this,Ac,AW,Ab);if(Ac&&Ag){var AY;if(AU.getAttributeForms){AY=AU.getAttributeForms(Af.did);}else{if(Af.fms){AY=Af.fms;}}if(AY&&AY.length>0){Q.call(this,AY);}else{if(Af&&Af.t===AP.Consolidation){Q.call(this,[]);}else{if(Ag){if(mstrApp&&mstrApp.isWorkstation){mstrApp.serverRequest(Ag.params,{success:function(Ai){if((Ai&&Ai.did)!==Aa.lastAttrId){return ;}Q.call(Aa,Ai.fms||[]);},failure:Ag.onerror});}else{if(Ag._delayId){window.clearTimeout(Ag._delayId);delete Ag._delayId;}Ag._delayId=window.setTimeout(function(){delete Ag._delayId;Ag.send();},500);}}}}}}}));}function AH(AQ){if(AQ&&!W.isEmpty(AQ)){var AR=t.hash(S);W.forEach(AQ,function(AT,AS){if(AT){AR[l[AS]]=true;}});return AR;}return null;}function m(AQ,AR,AT,AS){AQ.updating=true;AQ.clearSelect();t.forEach(AR,function(AU){AU.title=AJ.encodeHtmlString(AU.title||AU.n||"");});if(AR){AQ.set("items",AR);}if(AT&&AT.length){AQ.setSelectedItems(AT);}else{if(AS&&AS.length){AQ.select(AS);}}AQ.updating=false;}function d(AR,AQ,AS,AU,AT){if(AQ){m(AR,AS,AU,AT);}}mstrmojo.rw.ConditionList=mstrmojo.declare(mstrmojo.ListBase,[mstrmojo._IsList],{scriptClass:"mstrmojo.rw.ConditionList",allowUnlistedValues:true,itemIdField:"did",getItemProps:function v(AU,AQ){var AT=!!this.selectedIndices[AQ],AW=AU.n,AS=false,AV=AU.ndetype===G.DssRecursiveDerivedElement;if(AU.t===12){var AR=t.filter(AU.fs,function(AX){return AX.fgr>0;});if(AR.length>0){AS=true;}}return W.copy({cls:(AT?mstrmojo._IsList.SELECTED_CLS:"")+" "+(AU.css||"")+" "+(AU.t?("t"+AU.t+((AU.da||AU.um)?"d":"")+(AS?"g":"")+(AU.st?(" st"+AU.st+(AV?" nde4ra":"")):"")):""),n:AW||"&nbsp;"},this._super(AU,AQ));},onselectionChange:function AE(AQ){this._super(AQ);b.call(this,AQ);}});mstrmojo.rw.ConditionWalkProviderBase=mstrmojo.declare(mstrmojo.Obj,null,{scriptClass:"mstrmojo.rw.ConditionWalkProviderBase",browseEs:function c(AT,AS,AV){AT.openPopup("eb",{zIndex:AT.parent.zIndex+10,left:Math.round(AV.x)+"px",top:Math.round(AV.y)+"px"});var AR=AT.eb.browser,AQ=AT.model,AU=AQ&&AQ.a&&AQ.a.did;if(!AU){return ;}AR.set("attributeID",AU);AR.set("selectedItems",AQ.es?W.clone(AQ.es):[]);AR.initBrowser();},browseObjs:function AG(AX,AQ,AR){AX.openPopup("ob",{zIndex:AX.parent.zIndex+10,left:Math.round(AR.x)+"px",top:Math.round(AR.y)+"px"});var AS=AX.ob.browser;AS.target=AQ;var AT;switch(AQ.alias){case"dmy":AT=[U.TP.ATTR,U.TP.DIM];break;case"c0":case"c1":var AV=AX.model,AU=AV&&AV.et,AY=AV&&AV.fm,AW=AY&&AY.dtp||(AV.m?U.DTP.DECIMAL:U.DTP.UNKNOWN);AT=(AU===O.MQ||AU===O.MC)?[U.TP.METRIC,U.DTP2PROMPT_STP[AW]]:[U.TP.ATTR,U.DTP2PROMPT_STP[AW]];break;default:AT=AH(AX.ets);AT=AT?W.keyarray(AT,true):[U.TP.ATTR,U.TP.METRIC,U.STP.REPORT_GRID,U.STP.REPORT_GRAPH,U.STP.REPORT_ENGINE,U.STP.REPORT_TEXT,U.STP.REPORT_DATAMART,U.STP.REPORT_BASE,U.STP.REPORT_GRIDGRAPH,U.STP.REPORT_NONINTERACTIVE,U.STP.FILTER].concat(S);}AT[AT.length]=U.TP.FOLDER;AS.browse({rootFolderType:AV&&(AV.et===O.MQ||AV.et===O.MC)?5:26,folderLinksContextId:33,onSelectCB:[AX,"onOBSelect"],browsableTypes:AT.join(",")});},});var r=mstrmojo.rw.ConditionWalkProviderBase;r.onWalkChange=b;r.replaceItem=F;r.getChildJSON=N;r.walkChildPostCreateFn=u;r.cstJson=j;r.isComparisonAllowed=AL;r.clearInvalid=Y;r.updateCst=L;r.widgetItemFn=n;r.shouldShowCst=H;r.getConstant=a;r.getConstantDataType=I;r.getConstantValue=z;r.isDATE=AO;r.getCstListCompareTgts=e;r.fmJson=g;r.fnItem=AM;r.updateList=o;r.allowedTargetTypes=AH;r.updatePulldown=M;r.onWalkChangeThroughPulldown=R;r.updateListMultiData=m;r.updateListMulti=d;})();(function(){mstrmojo.requiresCls("mstrmojo.form","mstrmojo.hash","mstrmojo.date","mstrmojo.dom","mstrmojo.expr","mstrmojo.NumberFormat","mstrmojo.mstr.EnumDSSXMLObjectTypes","mstrmojo.Button","mstrmojo._IsWebApp");var N=mstrmojo.dom,J=mstrmojo.expr,F=J.STP,C=256;var E=mstrmojo.mstr.EnumDSSXMLObjectTypes;var G={ExecuteCubeReport:"web-execute-cube-report",CreateAnalysis:"create-analysis"};function L(Q,O,S,P){var R=mstrApp.sessionManager;if(R&&R.sessionTimedout){R.openLoginEditor({success:function(){if(P!=="_blank"){mstrApp.showWait();}mstrmojo.form.send(Q,O,S,P);}});}else{if(mstrApp.pageName=="homecards"&&Q.exportMode&&Q.exportMode==1){if(!P){P=!!mstrApp.features["export-new-window"]?"_blank":"mstrExportWindow";}}if((P!=="_blank")&&(P!=="mstrExportWindow")){mstrmojo._IsWebApp.showWait({message:mstrmojo.desc(97,"Executing...")});}mstrmojo.form.send(Q,O,S,P);}}function M(O){L(O,null,"post");}mstrmojo.mstr._ObjectActions=mstrmojo.provide("mstrmojo.mstr._ObjectActions",{_mixinName:"mstrmojo.mstr._ObjectActions",execute:function I(d,P){mstrmojo.hash.copy(mstrApp.searchAppFeatures,mstrApp.features);var R=mstrApp.features;var b=mstrApp.name;var V=parseInt(d.tp||d.t,10),a=parseInt(d.stp||d.st,10),g=d.et&&parseInt(d.et,10),h=d.dssid||d.did,c=d.viewMedia||d.dvm,Y=d.visMode||0,e={};switch(V){case E.Filter:switch(a){case 256:e={evt:3113,filterID:h,src:b+".3113"};break;case 257:this.openCustomGroupEditor(d,P);return ;}break;case E.Metric:this.openMetricEditor(d,P);return ;case E.Folder:e={evt:2001,folderID:h,src:b+".2001"};break;case E.ReportDefinition:if(this.designMode){e={evt:3005,src:b+".3005",reportID:h,reportDesignMode:this.designMode};break;}var f=1;switch(a){case F.REPORT_CUBE:case F.REPORT_EMMACUBE:if(!mstrApp.features[G.CreateAnalysis]){return ;}var U=!R.IE9Pre||R.IE9Pre&&(R["run-vi-flash"]||R["run-vi-smart"]);if(U){var Q=R.flashvi?"analysis":"HTML5VI";B.convertFromCube({st:a,type:Q,did:h,folderId:H(d),et:g});}else{mstrmojo.alert(mstrmojo.desc(15474,"Please upgrade your browser or turn off Internet Explorer Compatibility View to work with HTML5 dossiers."));}return ;case F.REPORT_GRID:f=1;break;case F.REPORT_GRAPH:f=2;break;case F.REPORT_GRIDGRAPH:f=3;break;}e={reportID:h,evt:4001,src:b+".4001",visMode:Y,reportViewMode:f};break;case E.DocumentDefinition:var X={Reserved:0,ViewStatic:1,ViewInteractive:2,ViewEditable:4,ViewFlash:8,ExportExcel:16,ExportPDF:32,ExportHTML:64,ExportFlash:128,ExportExcelPlainText:256,ExportCSV:512,ExportPlainText:1024,ViewAnalysis:2048,HTML5Dashboard:8192,All:134217727},O={DATA:1,DESIGN:2,PDF:3,EXCEL:4,SAVE:5,DETAILS:6,FLASH_EXPORT:7,FLASH_VIEW:8,FLASH_BINARY_VIEW:9};var Z={};Z[X.ExportPDF]=O.PDF;Z[X.ExportExcel]=O.EXCEL;Z[X.ExportFlash]=O.FLASH_EXPORT;var S={};S[X.ViewStatic]=2048001;S[X.ViewInteractive]=2048001;S[X.ViewEditable]=2048001;S[X.ExportHTML]=3130;S[X.ExportExcel]=3069;S[X.ExportFlash]=3069;S[X.ExportPDF]=3069;S[X.ViewAnalysis]=2048001;S[X.HTML5Dashboard]=3140;var W=2048001;if(a===14081){if(this.designMode){W=3104;e={evt:W,objectID:h,src:b+"."+W,rwDesignMode:this.designMode,executionMode:2};}else{if(c>8){W=S[c];e={evt:W,documentID:h,src:b+"."+W,};if((c===X.ExportExcel)||(c===X.ExportPDF)||(c===X.ExportHTML)||(c===X.ExportFlash)||(c===X.ExportExcelPlainText)||(c===X.ExportCSV)||(c===X.ExportPlainText)){e.exportMode=1;}if(c===X.HTML5Dashboard){if(N.ISDXIE&&!N.isIE9){mstrmojo.alert(mstrmojo.desc(15474,"Please upgrade your browser or turn off Internet Explorer Compatibility View to work with HTML5 dossiers"));return false;}}else{e.executionMode=Z[c]||0;}}else{W=2048001;e={evt:W,documentID:h,src:b+"."+W,visMode:Y||0,currentViewMedia:c||2};if(mstrApp.optimizeFitToPage){e.innerWidth=window.innerWidth;e.innerHeight=window.innerHeight;}}}}else{if(a===14080){e={evt:32001,documentID:h,src:b+".32001"};}}break;case E.Prompt:e={evt:3119,objectID:h,promptType:d.pt,src:b+".3119"};break;default:return false;}M(e);},openCustomGroupEditor:function(V,X){var R=V.did;var P="mstrCGE",U=mstrmojo.all[P],W=function(Y){if(!U){return ;}Y.scriptClass="mstrmojo.Obj";U.set("model",mstrmojo.insert(Y));U.open();},Q=function(){var Y={success:function(Z){if(!Z){mstrmojo.alert("Error retrieving the Custom Group definition!");return ;}W(Z);},failure:function(Z){mstrmojo.alert(Z.getResponseHeader("X-MSTR-TaskFailureMsg"));}};mstrmojo.xhr.request("POST",mstrConfig.taskURL,Y,{taskId:"getCustomGroup",customGroupId:R,styleName:"MojoCustomGroupStyle"});},S=function(){W({cgp:{agg:1,flat:false,pf:true,rfi:-1,ce:true,isp:true}});},O=R?Q:S;if(!U){U=mstrmojo.insert(mstrmojo.CustomGroupEditor);U.set("noRefresh",true);if(X&&X.zIndex){U.set("zIndex",X.zIndex);}}O();},openMetricEditor:function(Q,O){var P=Q.did;var S="mstrMetricIDE",R=mstrmojo.all[S];if(!R){R=mstrmojo.insert({scriptClass:"mstrmojo.ME.MetricIDE",id:S,metricId:P,noRefresh:(mstrApp.pageName!=="my"&&mstrApp.pageName!=="shared")});if(O&&O.zIndex){R.zIndex=O.zIndex;}}else{R.set("metricId",P);}R.open(null,{action:{cmd:P?"edit":"add"}});},openDataImport:function(O){K(O||{});},createFilter:function(){var O={evt:3113,src:(mstrApp.servletName||mstrApp.name)+".3113",isNew:true};L(O);},createDashboard:function(){var P=!mstrmojo.resolveFeature("flashvi"),O={evt:3187,src:(mstrApp.servletName||mstrApp.name)+".3187"};if(P&&mstrmojo.dom.isIE8){mstrmojo.alert(mstrmojo.desc(15474));return false;}if(P&&mstrApp.currentFolderId){O.parentFolderId=mstrApp.currentFolderId();}L(O);},openSharingEditor:A});var B={isCubeSupportDDA:function(O){return !!(O&&(O.dda===1||O.dda===3));},allowCreateReport:function(O){if(O&&O.ddam===2){mstrmojo.alert(mstrmojo.desc(13384,"The 'Create Report' option is currently not available for Live Connection Datasets."));}return true;},getCubesInfo:function(O,P){mstrmojo.xhr.request("POST",mstrConfig.taskURL,{success:function(Q){P(Q);}},{taskId:"getUserDICubeInfo",cubeIds:O.join(",")});},convertFromCube:function(P){var S=this,R=P.type,O=P.did,Q=P.folderId;this.getCubesInfo([O],function(V){var W=V[O],a=mstrApp.name,Z=(W&&!W.published&&S.isCubeSupportDDA(W)),Y=!!Z?128:0,X={};if(W&&W.ddam!==2&&!W.published){if(window.mstrApp&&!mstrApp.features["web-execute-cube-report"]){mstrmojo.alert(mstrmojo.desc(14111,"This cube has not been published")+" "+mstrmojo.desc(12933,"You do not have enough privileges to perform this operation"));}else{mstrmojo.confirm(mstrmojo.desc(14111,"This cube has not been published"),{confirmBtn:{t:mstrmojo.desc(9242,"Republish"),fn:function U(){if(P.st===779&&(P.et&C)>0){K({CubeDesc:"",CubeName:P.executeReport,ReportId:O,folderId:Q,StatusCode:2,isEdit:false,callback:function(){S.convertFromCube(P);}});}else{var b={evt:4001,src:mstrApp.name+".4001",reportID:O,visMode:0,reportViewMode:1};M(b);}}}});}return ;}switch(R){case"document":X={evt:"3104",src:a+".3104",executionMode:"2",rwDesignMode:"1",objectType:"3",objectID:O,rwCreateFlags:0};if(Q){X.saveFolderId=Q;}break;case"analysis":X={evt:"3104",src:a+".3104",executionMode:"1",rwDesignMode:"0",objectType:"3",objectID:O,rwCreateFlags:16,rwViewMode:8192};break;case"HTML5VI":X={evt:"3185",src:a+".3185",executionMode:"1",rwDesignMode:"0",objectType:"3",objectID:O,rwCreateFlags:32};if(Q){X.saveFolderId=Q;}break;case"report":if(!S.allowCreateReport(W)){return ;}X={evt:"3005",src:a+".3005",srcID:O,srcType:2,reportDesignMode:1};break;}if(typeof X.rwCreateFlags==="number"){X.rwCreateFlags|=Y;}M(X);});}};function H(Q){if(Q.fdid){return Q.fdid;}var O=Q.anc&&Q.anc.items||[],P=O[O.length-1];return P&&P.did;}function D(P){var O=function(){mstrmojo.xhr.request("POST",mstrConfig.taskURL,{success:function(Q){if(Q){var S=Q.descriptors.length,R;for(R=0;R<S;R++){var U=Q.descriptors[R];mstrmojo.descriptors[U.key]=U.v;}}if(P.callback){P.callback();}},failure:function(){if(P.callback){P.callback();}}},{taskId:"getBundleDescriptors",bundle:P.bundle});};O();}function K(Q){var S=Q.folderId,U=this,R=window.microstrategy;R?R.showWait():mstrmojo._IsWebApp.showWait();var P=function(){var W;if(U.dataImportId){W=mstrmojo.all[U.dataImportId];}if(!W){O();mstrmojo.requiresBundle("mojo-di.js");W=mstrmojo.insert({scriptClass:"mstrmojo.DI.DIContainer"});W.dataImportCallback=function(X){var Y=document.getElementById("formRefresh");if(Y&&X&&X.length>0){Y.submit();}};U.dataImportId=W.id;}if(Q){mstrmojo.hash.copy(Q,W.dataImportParams);if(Q.callback){W.dataImportCallback=function(X){Q.callback(X);};}else{if(Q.isCalledByFlex){W.dataImportCallback=function(Y){if(Y&&Y.length>0){var X;if(navigator.appName.indexOf("Microsoft")!==-1){X=window.MstrFlashFlashViewer;}else{X=document.MstrFlashFlashViewer;}if(X){X.onCloseDI(Y);}}};}}}if(S){mstrmojo.hash.copy({cubeSaveFolderId:S},W.dataImportParams);}W.open();R?R.showWait(false):mstrmojo._IsWebApp.hideWait();};var V=function(){var X={success:function(Y){if(Y){P();}else{if(mstrApp.onSessionExpired){mstrApp.onSessionExpired();}}}},W={taskId:"keepSessionAlive"};mstrmojo.xhr.request("POST",mstrConfig.taskURL,X,W);};var O=function(){var W="data-import.css";if(N.isIE8||N.isIE9){W="data-import-ie.css";}var X=document.createElement("link");X.rel="stylesheet";X.href="../javascript/mojo/css/"+W;X.type="text/css";document.head.appendChild(X);};if(!this.dataImportId){D({bundle:"mojo-di",callback:V});}else{V();}}function A(Q,Z,P,W){var V="sharingEditor",O=mstrApp.oi,U=(Z&&Z.objId)||O.objId,R=(Z&&Z.objType)||O.objType,Y=(Z&&Z.mid)||mstrApp.getMsgID&&mstrApp.getMsgID(),X=W&&W.showLinkOnOpen,a=function(d){var c=mstrmojo.all[V];if(!c){W=W||{};d.acls=W.acls||d.acls;c=mstrmojo.insert(mstrmojo.hash.copy(W,{scriptClass:"mstrmojo.SharingEditor",guestModeEnabled:mstrApp.guestModeEnabled,mid:Y,id:V,oi:d,href:Q,isLinkDirty:P,viewMode:Z?Z.viewMode:1,lastState:Z?Z.lastState:0,showWait:function(){mstrApp.showWait();},hideWait:function b(){mstrApp.hideWait();},onClose:function(){this.destroy();}}));}else{c.set("oi",d);c.href=Q;c.mid=Y;c.isLinkDirty=P;c.viewMode=Z?Z.viewMode:1;c.lastState=Z?Z.lastState:0;c.showLinkOnOpen=X;}c.open();},S=function(){var b={success:function(c){a(c.objects[0]);},failure:function(c){mstrmojo.alert(c.getResponseHeader("X-MSTR-TaskFailureMsg"));},complete:function(){mstrApp.hideWait();}};mstrmojo.xhr.request("POST",mstrConfig.taskURL,b,{taskId:"getObjectInfo",objectIDs:U,objectTypes:R,includeACL:mstrmojo.resolveFeature("web-use-sharing-editor"),sessionState:mstrApp.sessionState});};mstrApp.showWait();S();}}());(function(){mstrmojo.requiresCls("mstrmojo.ui.editors.controls.ControlGroup","mstrmojo.ui.editors.controls.TwoColumnContainer","mstrmojo.ui.editors.controls.ColorPickerButton","mstrmojo.ui.editors.controls.ValidationTextBox","mstrmojo.hash","mstrmojo.array","mstrmojo.ValidationTextBox","mstrmojo.expr");var K=mstrmojo.emptyFn,B=mstrmojo.hash,H=mstrmojo.array,I=mstrmojo.expr.DTP,F={FILL_COLOR:"Clr",FILL_TRANSPARENT:"FillTrans"},C=1,J=2;function N(U,Q,P,S,R){return{scriptClass:"mstrmojo.ui.editors.controls.ColorPickerButton",alias:"fillColor",slot:U,showNoFill:S!==false,showAutomatic:!!R,showGradient:false,selectedValue:"#000000",isHostedWithin:Q||false,postselectedValueChange:function(V){if(this.propName&&this.parent&&this.parent.parent){this.parent.parent.raiseFormatValueChange(this.propName,V.value,V.valueWas);}},postclick:function(V){this.parent.parent.postclick(V);}};}function O(Q){return{scriptClass:"mstrmojo.ui.editors.controls.TwoColumnContainer",alias:"fillAlpha",slot:Q,col1Width:"100%",col2Width:"10px",children:[{scriptClass:"mstrmojo.ui.editors.controls.ValidationTextBox",alias:"fillAlphaText",slot:"col1Node",value:"100",cssText:"text-align:right",dtp:I.INTEGER,required:true,constraints:{min:0,max:100},onvalueChange:function(R){this.valueWas=R.valueWas;},onValid:function P(){if(this.propName&&this.value!==this.valueWas){this.parent.parent.parent.raiseFormatValueChange(this.propName,this.value,this.valueWas);}},postclick:function(R){this.parent.parent.parent.postclick(R);}},{scriptClass:"mstrmojo.Label",slot:"col2Node",text:"%"}]};}mstrmojo.ui.editors.controls.FillConfigGroup=mstrmojo.declare(mstrmojo.ui.editors.controls.ControlGroup,null,{scriptClass:"mstrmojo.ui.editors.controls.FillConfigGroup",propNames:undefined,postclick:K,visibleControls:C+J,fillColorAndTrans:undefined,init:function M(U){this._super(U);var Q=[],X="col1Node",R=U&&U.colorPickerHostWithin,P=U&&U.showGradient,W=U&&U.showNoFill,S=U&&U.showAutomaticInColor,V;if((this.visibleControls&C)>0){Q.push(N(X,R,P,W,S));X="col2Node";}if((this.visibleControls&J)>0){Q.push(O(X));}if(Q.length===1){V={col1Width:"100%",dividerWidth:"0",col2Width:"0"};}this.addChildren([B.copy(V,{scriptClass:"mstrmojo.ui.editors.controls.TwoColumnContainer",alias:"fillColorAndTrans",children:Q})]);},getChildComp:function L(P){if(P.indexOf(F.FILL_COLOR)!==-1){return this.fillColorAndTrans.fillColor;}if(P.indexOf(F.FILL_TRANSPARENT)!==-1){return this.fillColorAndTrans.fillAlpha.fillAlphaText;}return undefined;},iniChildrenComp:function E(P){this.propNames=P;H.forEach(P,function(R){var Q=this.getChildComp(R);if(Q!==undefined){Q.propName=R;}},this);},setChildValue:function D(Q,R){var P=this.getChildComp(Q);if(P===undefined){return false;}switch(P.alias){case"fillColor":if(R!==P.selectedValue){P.set("selectedValue",R==="undefined"?"conflict":R);}break;case"fillAlphaText":if(R!==P.value){P.set("value",R==="undefined"?"":R);}break;}},setChildEnable:function G(R,Q){var P=this.getChildComp(R);if(P!==undefined){P.set("enabled",Q);}},setChildrenValue:function A(P){var Q=this;P.forEach(function(R){Q.setChildValue(R[0],R[1]);});}});mstrmojo.ui.editors.controls.FillConfigGroup.CTRL_FLAGS={FILL_COLOR:C,FILL_TRANSPARENCY:J};mstrmojo.ui.editors.controls.FillConfigGroup.FillCompName=F;}());(function(){mstrmojo.requiresCls("mstrmojo.Widget","mstrmojo._HasMarkup","mstrmojo.ui.menus._HasMenuPopup","mstrmojo.dom","mstrmojo.ui.editors.controls.ColorPickerButton","mstrmojo.css");var E=mstrmojo.css,F=mstrmojo.dom;mstrmojo.threshold.ColorBand=mstrmojo.declare(mstrmojo.ui.editors.controls.ColorPickerButton,[mstrmojo.ui.menus._HasMenuPopup],{scriptClass:"mstrmojo.threshold.ColorBand",hovered:false,selected:false,index:undefined,showGradient:false,showNoFill:false,markupString:'<div class = "color-band mstrmojo-ui-PreviewButton {@cssClass}" id="{@id}" style="{@cssText}" mstrAttach:click,keyup,contextmenu,mouseover,mouseout><div class="host mstrmojo-ui-PreviewButton"></div></div>',markupSlots:{previewNode:function(){return this.domNode;},btnNode:function(){return this.domNode;},clickableNode:function(){return this.domNode;},widgetHostNode:function(){return this.domNode.lastChild;}},select:function(){this.set("selected",true);},unselect:function(){this.set("selected",false);},onhoveredChange:function C(I){if(I.valueWas===false&&I.value===true){E.toggleClass(this.domNode,"selected",true);this.parent.onBandHovered(this.index);}else{E.toggleClass(this.domNode,"selected",false);this.parent.onBandUnhovered(this.index);}},onselectedChange:function B(I){if(I.valueWas===false&&I.value===true){E.toggleClass(this.domNode,"selected",true);this.parent.onBandSelected(this.index);}else{E.toggleClass(this.domNode,"selected",false);this.parent.onBandUnselected(this.index);}this.parent.onBandUnhovered(this.index);},onmouseover:function H(){this.set("hovered",true);},onmouseout:function D(){this.set("hovered",false);},oncontextmenu:function G(I){F.preventDefault(window,I.e);var K=this,J=K.parent.parent;var L=new mstrmojo.ui.menus.MenuConfig({position:F.getMousePosition(I.e,I.hWin),isHostedWithin:false});L.addMenuItem(mstrmojo.desc(7604,"Change Color"),"",function(){K.onclick(I);});L.addMenuItem(mstrmojo.desc(13386,"Add Color Band"),"",function(){var N=J.markers;var O=F.position(N.containerNode),M=I.e.clientX-O.x;N.addMarker(M);});L.addMenuItem(mstrmojo.desc(629,"Delete"),"",function(){K.unselect();J.bands.remove(K.index);J.update();});this.openPopup(L.newInstance());},postselectedValueChange:function(J){var K=this.parent.parent,I=K.parent,M=K.getPalette().concat();if(J){var L=J.value;if(K.getReversedValue()){M.reverse();}this.backgroundColor=M[this.index]=L;I.switchToCustomScheme(undefined,M);}}});mstrmojo._HasMarkup.addMarkupMethods(mstrmojo.threshold.ColorBand,{onwidthChange:mstrmojo.Widget.widthMarkupMethod,onleftChange:mstrmojo.Widget.leftMarkupMethod,onbackgroundColorChange:function A(){this.selectedValue=this.backgroundColor;this.updatePreview();this.colorPicker.set("color",this.selectedValue);}});}());(function(){mstrmojo.requiresCls("mstrmojo.ui.Pulldown","mstrmojo.string","mstrmojo.ui.ButtonBar","mstrmojo.ui.editors.controls.ComboBox","mstrmojo.ui.editors.controls.ColorPickerButton","mstrmojo.NumGroupStepperContentProvider","mstrmojo._FormatDefinition","mstrmojo.models.FormatModel");var C=mstrmojo.string,H=mstrmojo._FormatDefinition,V=mstrmojo.models.FormatModel,L=V.ENUM_PROPERTY_NAMES,K=1,G=2,P=4,F=8,J=16;var R;var M;var I={bold:L.FONT_WEIGHT,italic:L.FONT_STYLE,underline:L.UNDERLINE,strikeout:L.LINE_THROUGH};function D(W){return(W&J)>0;}function S(X){var b=L.FONT_FAMILY,W=X&&(X[b]||V.getFormatBlockValue(X,b)),Z=this.hcgControls.fontFamily,Y=this.getFontFamilyItems();if(W===-1){var a=Z&&Z.list;if(!a){return ;}a.clearSelect();delete Z.selectedIndex;if(Z.hasRendered){Z.refresh();}}else{if(Y){Z.set("selectedIndex",Math.max(Y.map(function(c){return c.n;}).indexOf(W)));}}}function Q(W){var X=[],Y=function(b,c,Z){var a=W[b];if(a===undefined){a=V.getFormatBlockValue(W,b);}if(a){X.push(Z);}};Y(L.FONT_WEIGHT,"bold",0);Y(L.FONT_STYLE,"italic",1);Y(L.UNDERLINE,"underline",2);Y(L.LINE_THROUGH,"line-through",3);this.hcgControls.fontStyle.select(X);}function N(W){var c=this.hcgControls,Z=L.FONT_SIZE,X=L.COLOR,b=W[Z]||V.getFormatBlockValue(W,Z),Y=c.fontSize;var a=W[X];if(typeof a==="undefined"||a===null){a=V.getFormatBlockValue(W,X);}if(typeof a==="undefined"||a===null){a="";}if(D(this.visibleControls)){if(b.length){Y.provider.set("curValGroup",b);}}else{if(b===-1){Y.list.clearSelect();Y.selectedValue="";Y.updatePreview();}else{Y.set("selectedValue",b?(parseInt(b,10)).toString():Y.items[0].n);}}c.fontColor.set("selectedValue",a===""?"conflict":V.decodeValue(L.COLOR,a));}function O(){if(R&&M){return ;}R=H.SizesInVI.map(function(W){return{idx:parseInt(W.n,10),n:W.n};});M=mstrmojo._FormatDefinition.Families.slice(1).map(function(W){return{n:W.n,id:W.n,preview:!W.symbolic};});}mstrmojo.ui.editors.controls._HasCharacterGroup=mstrmojo.provide("mstrmojo.ui.editors.controls._HasCharacterGroup",{_mixinName:"mstrmojo.ui.editors.controls._HasCharacterGroup",visibleControls:K+G+P,showNoFillInColor:true,hcgControls:null,getFontFamilyItems:function A(){return M;},getFontStyleItems:function U(){return[{n:mstrmojo.desc(2718,"Bold"),id:"b",css:"bold"},{n:mstrmojo.desc(2719,"Italic"),id:"i",css:"italic"},{n:mstrmojo.desc(2720,"Underline"),id:"u",css:"underline"},{n:mstrmojo.desc(3062,"Strikeout"),id:"s",css:"strikeout"}];},getHCGControls:function E(Z){O();var X=this.hcgControls={},W=this.visibleControls;if((W&K)>0){X.fontFamily=mstrmojo.ui.Pulldown.newPulldown(this.getFontFamilyItems(),function(b,c){Z(L.FONT_FAMILY,b.id,c&&c.id);},0,{isHostedWithin:false,scrollNodeMaxHeight:350,getPopupListConfig:function Y(){var b=mstrmojo.ui.Pulldown.prototype.getPopupListConfig.call(this);b.getItemProps=function c(f,d){var e=mstrmojo._IsList.getItemProps.call(this,f,d);e.style=f.preview?"font-family:'"+C.encodeHtmlString(f.n,true)+"';":"";return e;};return b;}});}if((W&G)>0||(W&F)>0){var a=X.fontStyle=new mstrmojo.ui.ButtonBar({hasSpacing:true,multiSelect:true,items:this.getFontStyleItems(),postselectionChange:function(b){var d=b.added,e=this.items[d?d[0]:b.removed[0]],c=!!d;if(e){Z(I[e.css],c,!c);}}});if((W&F)>0){a.items.pop();}}if((W&P)>0){X.fontSize=D(W)?new mstrmojo.ui.editors.controls.Stepper({provider:new mstrmojo.NumGroupStepperContentProvider({item:{interval:1},curValGroup:[],min:Math.min.apply(Math,R.map(function(b){return b.idx;})),max:Math.max.apply(Math,R.map(function(b){return b.idx;})),container:this,onTraverse:function(){var b=this.container.fontSize;if(b._sync){return ;}this.container.raiseFormatValueChange(L.FONT_SIZE,b.provider.getValGroup());},oncurValGroupChange:function(){var b=this.container.fontSize;if(b.textNode){b.updateDisplayText();}}})}):new mstrmojo.ui.editors.controls.ComboBox({selectedValue:"10",items:R,isHostedWithin:false,validateTextInput:function(b){return(/^[0-9]+(pt)?$/.test(b));},updateSelection:function(){this.set("selectedValue",parseInt(this.txtLabel.value,10).toString());},postselectedValueChange:function(b){Z(L.FONT_SIZE,parseInt(b.value,10)+"pt",parseInt(b.valueWas,10)+"pt");}});X.fontColor=new mstrmojo.ui.editors.controls.ColorPickerButton({showGradient:false,showNoFill:this.showNoFillInColor,selectedValue:"#000000",postselectedValueChange:function(b){Z(L.COLOR,b.value,b.valueWas);}});}return X;},setFormatSource:function B(W){var X=this;this.syncControls(function(){var Y=this.visibleControls;if((Y&K)>0){S.call(X,W);}if((Y&G)>0||(Y&F)>0){Q.call(X,W);}if((Y&P)>0){N.call(X,W);}});}});mstrmojo.ui.editors.controls._HasCharacterGroup.CTRL_FLAGS={FONT_FAMILY:K,FONT_STYLE:G,FONT_SIZE_AND_COLOR:P,FONT_STYLE_NO_STRIKEOUT:F,FONT_SIZE_USE_STEPPER:J};mstrmojo.ui.editors.controls._HasCharacterGroup.ControlsType=null;}());(function(){mstrmojo.requiresCls("mstrmojo.ui.editors.controls.ControlGroup","mstrmojo.Label","mstrmojo.ui.editors.controls.TwoColumnContainer","mstrmojo.ui.editors.controls.ColorPickerButton","mstrmojo.ui.editors.controls.LineStyleButton","mstrmojo.color","mstrmojo.hash","mstrmojo.models.FormatModel");var N=mstrmojo.color,K="fillColor",C="border",B=1,I=2,D=mstrmojo.models.FormatModel,H=D.ENUM_PROPERTY_NAMES,E=H.BACKGROUND_COLOR,A={all:{c:H.BORDER_COLOR,s:H.BORDER_STYLE},top:{c:H.BORDER_TOP_COLOR,s:H.BORDER_TOP_STYLE},right:{c:H.BORDER_RIGHT_COLOR,s:H.BORDER_RIGHT_STYLE},bottom:{c:H.BORDER_BOTTOM_COLOR,s:H.BORDER_BOTTOM_STYLE},left:{c:H.BORDER_LEFT_COLOR,s:H.BORDER_LEFT_STYLE}};function G(Q,O){O.forEach(function(S,R){S.slot="col"+(R+1)+"Node";});var P=this.secondColumnWidth;return{scriptClass:"mstrmojo.ui.editors.controls.TwoColumnContainer",alias:Q,col1Width:(100-P)+"%",col2Width:P+"%",children:O};}function J(Q,O,P){return mstrmojo.hash.copy(P,{scriptClass:"mstrmojo.ui.editors.controls.ColorPickerButton",showGradient:!!O,postselectedValueChange:function(R){this.parent.parent.raiseFormatValueChange(Q,R.value,R.valueWas);}});}function F(R){var Q="transparent",O="none",P;if(R){P=R.indexOf("#");if(P===-1){P=R.indexOf(Q);}}if(!isNaN(P)&&P>-1){O=R.substr(0,P-1);Q=N.fixFullHexValue(R.substr(P));}else{O=R;}if(O.indexOf("none")>-1){O="none";}return{s:O,c:Q};}mstrmojo.ui.editors.controls.ContainerGroup=mstrmojo.declare(mstrmojo.ui.editors.controls.ControlGroup,null,{scriptClass:"mstrmojo.ui.editors.controls.ContainerGroup",borderTitle:mstrmojo.desc(13631,"Outer border"),fillColorTitle:mstrmojo.desc(7993,"Fill color"),showThickBorderStyle:true,showBackgroundNoFill:true,showBackgroundGradient:false,showBorderNoFill:true,visibleControls:B+I,targetBorder:"all",secondColumnWidth:60,init:function L(R){this._super(R);mstrmojo.css.addWidgetCssClass(this,"mstrmojo-ui-EditContainer");var Q=[],P=this.visibleControls,O=A[this.targetBorder];if((P&B)>0){Q.push(G.call(this,K,[{scriptClass:"mstrmojo.Label",text:this.fillColorTitle},J(E,this.showBackgroundGradient,{showNoFill:this.showBackgroundNoFill})]));}if((P&I)>0){Q.push(new mstrmojo.Label({text:this.borderTitle}));Q.push(G.call(this,C,[{scriptClass:"mstrmojo.ui.editors.controls.LineStyleButton",showThickOption:this.showThickBorderStyle,postselectedValueChange:function(S){var U=this.parent.parent;U.raiseFormatValueChange(O.s,S.value,S.valueWas);U[C].getControl(2).set("enabled",S.value!=="none");}},J(O.c,false,{showNoFill:this.showBorderNoFill})]));}this.addChildren(Q);},setFormatSource:function M(P){var O=this[K],S=this[C],R=this.targetBorder,Q=A[R];if(R==="all"){Q=A.top;}this.syncControls(function(){if(O){var W=D.decodeGradientValue(D.getGradientValues(P)),Z;if(!W){if(P[H.FILL_STYLE]===1){Z="transparent";}else{var V=P[E];if(typeof V==="undefined"||V===null){V=P["background-color"];}if(typeof V==="undefined"||V===null){V=-1;}Z=D.decodeValue(E,V);}}O.getControl(2).set("selectedValue",W||Z);}if(S){var X=P.border;if(!X){if(typeof (P.borderStyle)!=="undefined"&&P.borderStyle!==null){X=typeof (P.borderStyle)==="string"?P.borderStyle:D.decodeValue("borderStyle",P.borderStyle);}else{X=D.decodeValue(Q.s,P[Q.s]);}if(typeof P.borderColor!=="undefined"&&P.borderColor!==null){X+=" "+D.decodeValue("borderColor",P.borderColor);}else{if(typeof P[Q.c]!=="undefined"&&P[Q.c]!==null){X+=" "+D.decodeValue(Q.c,P[Q.c]);}else{X+=" "+D.decodeValue(Q.c,-1);}}}var Y=F(X),U=S.getControl(2);S.getControl(1).set("selectedValue",Y.s);U.set("enabled",Y.s!=="none");U.set("selectedValue",Y.c);}});}});mstrmojo.ui.editors.controls.ContainerGroup.CTRL_FLAGS={FILL_COLOR:B,BORDER:I};}());(function(){mstrmojo.requiresCls("mstrmojo.ui.editors.controls.ControlGroup","mstrmojo.array","mstrmojo.hash","mstrmojo.ui.editors.controls.ColorPickerButton","mstrmojo.ui.editors.controls.LineStyleButton");var L=mstrmojo.emptyFn,I=mstrmojo.array,C=mstrmojo.hash,E=mstrmojo.gm.EnumCombinedLineStyle;var J={LINE_COLOR:"Clr",LINE_STYLE:"Style"},A={"1pt solid":E.THIN,"2pt solid":E.THICK,"1pt dashed":E.DASHED,"1pt dotted":E.DOTTED,none:E.NONE};function D(P,O){return C.copy(O,{scriptClass:"mstrmojo.ui.editors.controls.ColorPickerButton",alias:"lineColor",slot:P,selectedValue:"#000000",postselectedValueChange:function(Q){if(this.propName){this.parent.parent.raiseFormatValueChange(this.propName,Q.value,Q.valueWas);}},postclick:function(Q){this.parent.parent.postclick(Q);}});}function K(P){return{scriptClass:"mstrmojo.ui.editors.controls.LineStyleButton",showThickOption:true,showNoneOption:true,hideDashOptions:false,defaultSelectedIndex:3,propName:undefined,alias:"lineStyle",slot:P,postInit:function O(){var Q=["mstrmojo-ui-LineStyle"];if(!this.showNoneOption){Q.push("no-none");}if(this.hideDashOptions){Q.push("no-dash");}mstrmojo.css.addWidgetCssClass(this,Q);(this.list.items||[]).forEach(function(R){R.v=(A[R.id]!==undefined?A[R.id]:A["not defined"]);});},onshowNoneOptionChange:function(Q){var R=["no-none"];if(!Q.value){mstrmojo.css.addWidgetCssClass(this,R);}else{mstrmojo.css.removeWidgetCssClass(this,R);}var S=this.hasRendered;if(S){this.refresh();}},postselectedValueChange:function(R){this._super();var Q=I.find(this.list.items,"id",R.value);if(Q===-1){Q=this.defaultSelectedIndex;}var S=this.list.items[Q].v;if(this.propName){this.parent.parent.setChildEnable(J.LINE_COLOR,S!==A.none);this.parent.parent.raiseFormatValueChange(this.propName,S,A[R.valueWas]);}},postclick:function(Q){this.parent.parent.postclick(Q);}};}mstrmojo.ui.editors.controls.LineConfigGroup=mstrmojo.declare(mstrmojo.ui.editors.controls.ControlGroup,null,{scriptClass:"mstrmojo.ui.editors.controls.LineConfigGroup",propNames:undefined,postclick:L,hideColorControl:false,showGradient:false,showNoFillInColor:true,showAutomaticInColor:false,showNoneOption:true,lineColorAndStyle:undefined,lineTitle:undefined,init:function N(Q){this._super(Q);var O=[],R;O.push(K("col1Node"));if(!this.hideColorControl){O.push(D("col2Node",{showGradient:this.showGradient,showNoFill:this.showNoFillInColor,showAutomatic:this.showAutomaticInColor}));}else{R={col1Width:"100%",dividerWidth:"0",col2Width:"0"};}var P=[];if(this.lineTitle&&this.lineTitle!==""){P.push(new mstrmojo.Label({text:this.lineTitle}));}P.push(C.copy(R,{scriptClass:"mstrmojo.ui.editors.controls.TwoColumnContainer",alias:"lineColorAndStyle",children:O}));this.addChildren(P);},getChildComp:function M(O){if(O.indexOf(J.LINE_COLOR)!==-1){return this.lineColorAndStyle.lineColor;}if(O.indexOf(J.LINE_STYLE)!==-1){return this.lineColorAndStyle.lineStyle;}return null;},iniChildrenComp:function G(P){I.forEach(P,function(R){var Q=this.getChildComp(R);if(Q!==undefined){Q.propName=R;}},this);var O=this.lineColorAndStyle.lineStyle;O.showNoneOption=this.showNoneOption;O.hideDashOptions=this.hideDashOptions;O.postInit();},onshowNoneOptionChange:function(O){this.lineColorAndStyle.lineStyle.set("showNoneOption",O.value);},setChildValue:function F(Q,R){var O=this.getChildComp(Q);if(O===undefined){return false;}var P;switch(O.alias){case"lineColor":if(R!==O.selectedValue){O.set("selectedValue",typeof R==="undefined"?"conflict":R);}break;case"lineStyle":if(typeof R==="undefined"){O.list.clearSelect();this.syncControls(function(){O.set("selectedValue","conflict");});}else{P=I.find(O.list.items,"v",R);if(P===-1){P=O.defaultSelectedIndex;}var S=O.list.items[P].id;if(S!==O.selectedValue){O.set("selectedValue",S);}}break;}},setChildEnable:function H(Q,P){var O=this.getChildComp(Q);if(O!==undefined){O.set("enabled",P);}},setChildrenValue:function B(O){O.forEach(function(P){this.setChildValue(P[0],P[1]);});}});}());(function(){mstrmojo.requiresCls("mstrmojo.ui.editors.controls.ControlGroup","mstrmojo.ui.editors.controls._HasCharacterGroup","mstrmojo.ui.editors.controls.TwoColumnContainer","mstrmojo.css");mstrmojo.ui.editors.controls.CharacterGroup=mstrmojo.declare(mstrmojo.ui.editors.controls.ControlGroup,[mstrmojo.ui.editors.controls._HasCharacterGroup],{scriptClass:"mstrmojo.ui.editors.controls.CharacterGroup",init:function A(E){this._super(E);mstrmojo.css.addWidgetCssClass(this,"mstrmojo-ui-EditCharacter");var H=this,C=this.getHCGControls(function(K,L,J){if(!H._sync){H.raiseFormatValueChange(K,L,J);}}),D=[];Object.keys(C).forEach(function(J){this[J]=C[J];}.bind(this));var B=this.fontFamily,I=this.fontStyle,G=this.fontSize,F=this.fontColor;if(B){D.push(B);}if(I){D.push(I);}if(G){G.slot="col1Node";F.slot="col2Node";D.push({scriptClass:"mstrmojo.ui.editors.controls.TwoColumnContainer",children:[G,F]});}if(D.length){this.addChildren(D);}}});mstrmojo.ui.editors.controls.CharacterGroup.CTRL_FLAGS=mstrmojo.ui.editors.controls._HasCharacterGroup.CTRL_FLAGS;}());(function(){mstrmojo.requiresCls("mstrmojo.ui.editors.ToolbarPopup","mstrmojo.ui.editors._HostsControls","mstrmojo.ui.editors.controls._HasCharacterGroup","mstrmojo.vi.ui.TextAlignButtonBar","mstrmojo.models.FormatModel","mstrmojo.css");var B=mstrmojo.models.FormatModel;mstrmojo.ui.editors.CharacterToolbarPopup=mstrmojo.declare(mstrmojo.ui.editors.ToolbarPopup,[mstrmojo.ui.editors._HostsControls,mstrmojo.ui.editors.controls._HasCharacterGroup],{scriptClass:"mstrmojo.ui.editors.CharacterToolbarPopup",textAlignJustify:true,textAlignValueMap:null,textAlignFmtName:mstrmojo.models.FormatModel.ENUM_PROPERTY_NAMES.TEXT_ALIGN,btnTextAlign:null,init:function D(I){this._super(I);mstrmojo.css.addWidgetCssClass(this,"mstrmojo-ui-EditCharacter");var K=this.textAlignJustify,H=this,F=function(P,Q,O){H.raiseFormatValueChange(P,Q,O);},L=this.getHCGControls(F),J=L.fontFamily,N=L.fontSize,G=L.fontColor,M={alias:"btnTextAlign",includeJustify:K,onValueChange:function(P,O){F(H.textAlignFmtName,P,O);}};J.width="125px";N.width="50px";G.width="50px";this.width=K?"505px":"476px";var E=this.textAlignValueMap;if(E){M.itemsValueMap=E;}this.addChildren([J,L.fontStyle,N,G,new mstrmojo.vi.ui.TextAlignButtonBar(M)]);},shouldPropagateLockHover:function C(){return false;},setFormatSource:function A(E){this._super(E);this.syncControls(function(){if(this.textAlignFmtName in E){this.btnTextAlign.singleSelectByField(E[this.textAlignFmtName],"v");}else{this.btnTextAlign.singleSelectByField(B.getFormatBlockValue(E,B.ENUM_PROPERTY_NAMES.TEXT_ALIGN),"id");}});}});}());(function(){mstrmojo.requiresClsP("mstrmojo","Widget","num","css","Container","Box","Label","EditableLabel","Image");mstrmojo.requiresClsP("mstrmojo.threshold","ColorBand","ImageBand","MarkersNode","ColorMarker","ThresholdModel");var L=mstrmojo.dom,H=mstrmojo.num,B=mstrmojo.css,c=mstrmojo.array,N=mstrmojo.hash,t=["bands","markers"];var A=0,v=1;var a=mstrmojo.threshold.ThresholdModel,W=a.SLIDER_MODE,V=a.BASED_ON_TYPES,C=function(z,x){return z-x;},f=function(z,x){return x-z;},F=5;function P(x){var z;if(x===t[A]){z=this.sliderMode===W.IMAGE_BASED?new mstrmojo.threshold.ImageBand():new mstrmojo.threshold.ColorBand();}else{z=new mstrmojo.threshold.ColorMarker();}this[x].addChildren([z]);}function g(AD,AF,AG,AB){var z=AD.length-1,AE=AB?0:1,AA=AB?z-1:z-2;for(var AC=AE;AC<=AA;AC++){if(AC===AE&&AD[AC]<=0){AD[AC]=AF;}else{var x=AD[AC]-AD[AC-1];AD[AC]+=(x<AF)?(AF-x):0;AD[AC]=AD[AC]>=AG?(AG-AF):AD[AC];}}for(var AC=AA;AC>AE;AC--){if(AC===AA&&AD[AA]>=AG){AD[AC]=AG-AF;}else{var x=Math.abs(AD[AC+1]-AD[AC]);AD[AC]-=(x<AF)?(AF-x):0;}}AD.sort(C);}function S(AB){var AC=this[t[AB]],AD=AC.children,z=AD?AD.length:0,AM=this.getComp().sort(C),AL=this.getPalette(),AA=this.width,AO=AB?AM.length-1:AM.length,x=this.sliderMode===W.IMAGE_BASED,AP=this.parent.model.globalMinMax(this.minValue(),this.maxValue()),AK,AE,AH;var AJ=c.map(AM,function(AQ){return parseInt(AA*AQ,10);});g(AJ,F,AA,this.selectedOption===V.VALUE);if(z>AO){for(AK=z-AO-1;AK>=0;AK--){AC.removeChildren(AD[AK]);}}else{if(AO>z){for(AK=0;AK<AO-z;AK++){P.call(this,t[AB]);}}}if(AB===0&&this.getReversedValue()){AL=AL.concat().reverse();}AD=AC.children;var AG,AF;for(AK=0;AK<AO;AK++){AE=AD[AK];AG=(AK===0)?0:AJ[AK-1];AF=AJ[AK];if(AB===0){AE.set("left",(this.containerNode.offsetLeft+AG+1)+"px");AH=AF-AG;B.toggleClass(AE.domNode,"no-border",!AH);AE.set("width",AH+"px");if(x){AE.set("src",AL[AK]);AE.domNode.firstChild.style.left=AE.domNode.clientWidth/2-12+"px";}else{AE.set("backgroundColor",AL[AK]);}}else{AE.set("left",AF-(x?0:1)+"px");AE.updateCompValue(AM[AK]);var AN=this.parent.model,AI=AN.getRealValue(AM[AK],this.selectedOption,this.minValue(),this.maxValue());AE.updateRealValue(AI);AE.updatePosition(AJ[AK]);}AE.set("index",AK);}}function p(z,x,AA){x.forEach(function(AC){var AB=z[AC.id]={palette:[],comp:[],reversed:false};AC.bands.forEach(function(AD){AB.palette.push(AD[AA?"url":"bc"]);AB.comp.push(AD.end/100);});});}function D(){var x=this.parent.model,z={};p(z,x.getDefaultColors(),false);p(z,x.getDefaultImages(),true);return z;}function w(AA){var x=H.parseNumeric(AA);if(isNaN(x)&&window.numeral){var z=window.numeral(AA.toLowerCase()).value();x=typeof z==="number"?z:x;}return x;}mstrmojo.threshold.TextBubble=mstrmojo.declare(mstrmojo.EditableLabel,null,{scriptClass:"mstrmojo.EditableLabel",visible:false,cssClass:"editable-bubble",text:"",isPercentage:true,maxValue:1,showBubble:function(x,AA,z){this.updatePosition(x,z);this.updateText(AA);this.set("visible",true);},hideBubble:function(){this.set("visible",false);},updatePosition:function U(z,x){var AA=(x!==undefined)?x:this.parent.width*z;this.domNode.style.left=AA+"px";},updateText:function(AB){var AA=this.parent,x=AA.parent.model,z=AB;if(AA.selectedOption===V.VALUE){this.realValue=z;z=H.formatByMask(x.getFormatString(),z);}if(this.isPercentage){z+="%";}this.set("text",String(z));}});mstrmojo.threshold.ColorSlider=mstrmojo.declare(mstrmojo.Container,null,{scriptClass:"mstrmojo.threshold.ColorSlider",markupString:'<div class = "mstrmojo-color-slider {@cssClass}"  style="{@cssText}" mstrAttach:click,keyup><div class="labels"></div><input type="text" class="hidden-field"></div>',markupSlots:{containerNode:function X(){return this.domNode;},labelsNode:function Q(){return this.domNode.firstChild;},hiddenField:function e(){return this.domNode.lastChild;}},sliderMode:W.COLOR_BASED,baseColor:undefined,editableBubble:undefined,hoverBubble:undefined,bands:undefined,markers:undefined,colorMap:undefined,selectedOption:undefined,userComp:[],getComp:function Y(){return this.userComp;},getPalette:function M(){return this.colorMap[this.baseColor].palette;},getReversedValue:function n(){var x=this.colorMap;return x&&x[this.baseColor].reversed||false;},postBuildRendering:function R(){this.width=L.position(this.containerNode).w;this.resetColorMap();if(this._super){this._super();}this.update();},resetColorMap:function u(){var x=undefined;if(this.colorMap){x=this.colorMap.custom;}this.colorMap=D.call(this);if(x){this.colorMap.custom=x;}if(this.baseColor in this.colorMap){this.userComp=N.clone(this.colorMap[this.baseColor].comp);}},onkeyup:function(AB){var z=window.event||AB.e,AC=z.keyCode;if(this.sliderMode===W.COLOR_BASED&&(AC===mstrmojo.Enum_Keys.DELETE||AC===mstrmojo.Enum_Keys.BACKSPACE)){if(this.editableBubble.isEditing){return ;}var AA,x;if(this.bands.isSelected){AA=this.bands;}else{if(this.markers.isSelected){AA=this.markers;}else{return ;}}x=AA.selectedIndex;AA.children[x].unselect();AA.remove(x);this.update();}},update:function d(){if(this.baseColor){S.call(this,A);S.call(this,v);}this.updateMinMax();},onsliderModeChange:function h(){B.toggleClass(this.domNode,"image-mode",this.sliderMode===W.IMAGE_BASED);this.resetMinMax();this.unselectAll();this.bands.removeChildren();},onbaseColorChange:function o(x){if(x.value&&x.value in this.colorMap){this.userComp=N.clone(this.colorMap[x.value].comp);}this.resetMinMax();this.unselectAll();this.update();},onselectedOptionChange:function K(z){var AA=this.parent.model,AB=this.editableBubble,AC=z.valueWas===V.VALUE?AB.realValue:AB.text;if(z.valueWas!==undefined){this.resetMinMax();this.markers.setMarkerRealValues(AA.getRealValue.bind(AA),z.value,this.minValue(),this.maxValue());this.update();}if(AB.visible){if(z.valueWas===V.LOWEST_PERCENT||z.valueWas===V.HIGHEST_PERCENT){AC=AC.slice(0,AC.length-1);}var x=this.markers.selectedIndex;AB.updateText(this.markers.children[x].realValue);}},updateLabels:function G(z){var AC=this.parent.model,AD=this.editableBubble,AB=this.hoverBubble,AE=this.markers.selectedIndex,AF,AA;z=z||this.selectedOption;if(z===V.LOWEST_PERCENT||z===V.HIGHEST_PERCENT){AF="0%";AA="100%";AD.set("isPercentage",true);AB.set("isPercentage",true);}else{if(z===V.LOWEST||z===V.HIGHEST){AF="0";AA=AC.getMetricsCount();AD.set("isPercentage",false);AB.set("isPercentage",false);}else{var x=AC.getFormatString();AF=(this.minValue()<AC.getMetricsMinValue())?"-&#8734":H.formatByMask(x,AC.getMetricsMinValue());AA=(this.maxValue()>AC.getMetricsMaxValue())?"&#8734":H.formatByMask(x,AC.getMetricsMaxValue());AD.set("isPercentage",false);AB.set("isPercentage",false);}}this.startLabel.set("text",AF);this.endLabel.set("text",AA);if(!!this.markers.children&&AE>-1&&AE<this.markers.children.length){AD.updateText(this.markers.children[AE].realValue);}},setColorComp:function j(z,x){this.userComp=N.clone(x);var AA=this.colorMap;if(AA){AA[z].comp=x;this.unselectAll();this.update();}},addCustomScheme:function(z,x){this.colorMap.custom={comp:z,palette:x,reversed:false};this.set("baseColor","custom");},addMarkerToMap:function O(AA){var AB=this.getComp(),z=AB.length,AC;if(AB[0]>AA){AC=0;}else{for(AC=1;AC<z;AC++){if(AB[AC-1]<=AA&&AB[AC]>=AA){break;}}}AB.splice(AC,0,AA);this.unselectAll();this.resetMinMax();return AC;},unselectAll:function r(){var z=this.bands,AA=z.children&&z.selectedIndex>-1&&z.children[z.selectedIndex];if(z.isSelected&&AA&&typeof (AA.unselect)==="function"){AA.unselect();}var AB=this.markers,x=AB.selectedIndex;if(AB.isSelected&&AB.children[x]){AB.children[x].unselect();}},reverseMapColor:function Z(){if(this.colorMap&&this.baseColor){var x=this.colorMap[this.baseColor];x.reversed=!x.reversed;this.unselectAll();this.update();}},_minRealValue:undefined,_maxRealValue:undefined,resetMinMax:function J(){this.set("_minRealValue",undefined);this.set("_maxRealValue",undefined);},updateMinMax:function k(){var AD=this.markers.getMarkerRealValues(C),AC=this.parent.model,AB=this.parent.model.globalMinMax(),AA=AB.min,x=AB.max,z=-1;if(c.isArray(AD)){while(++z<AD.length){if(AD[z]!==undefined){AA=AD[z];break;}}z=AD.length;while(--z>=0){if(AD[z]!==undefined){x=AD[z];break;}}}this.set("_minRealValue",AA);this.set("_maxRealValue",x);this.updateLabels(this.selectedOption);},minValue:function E(){return this._minRealValue;},maxValue:function I(){return this._maxRealValue;},children:[{scriptClass:"mstrmojo.Label",cssClass:"start-label",alias:"startLabel",slot:"labelsNode",text:"0%",allowHTML:true},{scriptClass:"mstrmojo.Label",cssClass:"end-label",alias:"endLabel",slot:"labelsNode",text:"100%",allowHTML:true},{scriptClass:"mstrmojo.threshold.TextBubble",alias:"editableBubble",slot:"labelsNode",allowEmptyText:true,onTextEditComplete:function(AF,AG){if(AF){var AK=this.parent,AD=AK.parent.model,AC=AK.markers.selectedIndex,AQ=AK.markers.children[AC];var AH=this.text;if(this.isPercentage){AH=AH.replace(/%$/,"");}var AM=AH.charAt(0),AR=1;if(AM==="-"||AM==="+"){AH=AH.substring(1);AR=(AM==="-")?-1:1;AM=AH.charAt(0);}if(AM.match(/\W/)!==null){AH=AH.replace(new RegExp("^\\"+AM),"");}var AI=AD.getFormatString(),AN=(AI||"").indexOf("%")>-1,AB=1,AE=AK.selectedOption===V.VALUE;if(AE&&AN&&AH.indexOf("%")===-1){AB=0.01;}AH=w(AH)*AB;if(isNaN(AH)){this.set("text",AG);return ;}AH=AH*AR;if(AH<0&&!AE){AH=0;}AQ.updateRealValue(AH);AK.updateMinMax();var AL=AK.markers.getMarkerRealValues(C);AC=AL.indexOf(AH);var AO=AL.map(function(AS){return AD.getNormalizedValue(AS,AK.selectedOption,AK.minValue(),AK.maxValue());}),AP=AK.getComp(),AA=AO[AC],z=AK.width,x=(AK.sliderMode===W.IMAGE_BASED),AJ=parseInt(z*AA,10);AO.forEach(function(AT,AS){AP[AS]=AT;AK.markers.children[AS].updateCompValue(AT);});this.updatePosition(AA);AQ.updateCompValue(AA);AQ.set("left",AJ-(x?0:1)+"px");AQ.unselect();AK.update();AK.markers.children[AC].select();}}},{scriptClass:"mstrmojo.threshold.TextBubble",alias:"hoverBubble",slot:"labelsNode",allowEmptyText:false},{scriptClass:"mstrmojo.Box",cssClass:"color-bands",alias:"bands",isSelected:false,selectedIndex:0,remove:function b(AA){if(this.children.length===1){return ;}var AB=this.parent;var z=AB.getComp(),x=AB.getPalette();if(AA===this.children.length-1){z.splice(AA-1,1);}else{z.splice(AA,1);}x.splice(AA,1);},onBandHovered:function(){this.isSelected=true;},onBandUnhovered:function(){this.isSelected=false;},onBandSelected:function(x){var z,AB=this.children,AA=this.parent,AC=AA.markers;for(z=0;z<AB.length;z++){if(z!==x&&AB[z].selected){AB[z].unselect();}}if(AC.isSelected===true){AC.children[AC.selectedIndex].unselect();}AA.hiddenField.focus();this.isSelected=true;this.selectedIndex=x;},onBandUnselected:function(x){var z,AA=this.children;for(z=0;z<AA.length;z++){if(z!==x&&AA[z].selected){return ;}}this.isSelected=false;}},{scriptClass:"mstrmojo.threshold.MarkersNode",alias:"markers",isSelected:false,selectedIndex:0,onMarkerSelected:function q(z){var x=this.parent,AD=this.children[z];x.editableBubble.showBubble(AD.compValue,AD.realValue,AD.position);var AA,AC=this.children;for(AA=0;AA<AC.length;AA++){if(AA!==z&&AC[AA].selected){AC[AA].unselect();}}var AB=x.bands;if(AB.isSelected===true){AB.children[AB.selectedIndex].unselect();}this.parent.hiddenField.focus();this.isSelected=true;this.selectedIndex=z;},onMarkerUnselected:function(x){var z,AA=this.children;for(z=0;z<AA.length;z++){if(z!==x&&AA[z].selected){return ;}}this.parent.editableBubble.hideBubble();this.isSelected=false;},onMarkerHovered:function m(z){var x=this.parent,AA=this.children[z];x.hoverBubble.showBubble(AA.compValue,AA.realValue,AA.position);this.isSelected=true;},onMarkerUnhovered:function l(){this.parent.hoverBubble.hideBubble();this.isSelected=false;}}]});}());(function(){mstrmojo.requiresCls("mstrmojo.css","mstrmojo.array","mstrmojo.Container","mstrmojo.Label","mstrmojo.ui.List","mstrmojo.ui._HasListTooltip","mstrmojo.mstr._ObjectActions","mstrmojo.mstr.search._IconCssClassBuilder");mstrmojo.requiresDescs(60,61,945,1050,3364,3366,9202);var D=mstrmojo.css,C=mstrmojo.array;var J,A=function(K){return mstrmojo.all[J].getBuilder(K,this.dataField);};mstrmojo.mstr.search.SearchGridView=mstrmojo.declare(mstrmojo.DataGrid,[mstrmojo.mstr._ObjectActions],{scritpClass:"mstrmojo.mstr.search.SearchGridView",cssClass:"mstrmojo-Search-GridView",makeObservable:true,banding:false,columns:[{headerText:mstrmojo.desc(945,"Name"),dataField:"n",dataWidgetBuilder:A,colCss:"name"},{headerText:mstrmojo.desc(60,"Owner"),dataField:"owner",dataWidgetBuilder:A,colCss:"owner"},{headerText:mstrmojo.desc(61,"Modified"),dataField:"mdt",dataWidgetBuilder:A,colCss:"mdt"},{headerText:mstrmojo.desc(1050,"Location"),dataField:"anc",dataWidgetBuilder:A,colCss:"anc"}],init:function I(K){this._super(K);J=this.id;},getBuilder:function B(L,N){var K=null;switch(N){case"n":K={scriptClass:"mstrmojo.mstr.search.SearchGridViewItem",items:[L]};break;case"anc":var M=L.anc.items.slice(2);K={scriptClass:"mstrmojo.Box",cssClass:"mstrmojo-Search-Ancester",children:[{scriptClass:"mstrmojo.Label",alias:"toggle",cssClass:"toggle",text:" ",fullPath:false,onclick:function(){this.fullPath=!this.fullPath;D.toggleClass(this.parent.domNode,"full",this.fullPath);},onRender:function(){this.set("bindings",{enabled:function(){return this.parent.path.ellipsized;}});}},{scriptClass:"mstrmojo.ui.List",alias:"path",ellipsized:false,items:C.map(M,function(O){if(O.hid){O.n="[...]";}return O;}),postclick:function(){if(!this.selectedItem.hid){this.parent.dataGrid.execute(this.selectedItem);}},onRender:function(){var P=this,O=P.domNode.firstChild;window.setTimeout(function(){P.set("ellipsized",O.clientWidth<O.scrollWidth);},10);}}]};break;default:K={scriptClass:"mstrmojo.Label",cssClass:"mstrmojo-Search-nonbreakable "+N,cssDisplay:"inline-block",text:L[N]};break;}K.alias="itemWidget";return K;}});mstrmojo.mstr.search.SearchGridViewItem=mstrmojo.declare(mstrmojo.ui.List,[mstrmojo.ui._HasListTooltip,mstrmojo.mstr.search._IconCssClassBuilder],{scritpClass:"mstrmojo.mstr.search.SearchGridViewItem",useRichTooltip:true,getItemMarkup:function G(L,K){return this._super(L,K).replace("{@en@n}",'<i class="{@icnCls}"></i>{@en@n}');},getItemProps:function E(L,K){var M=this._super(L,K);M.addCls("mstrmojo-Search-GridViewItem");M.icnCls="mstrmojo-ListIcon "+this.getIconCssClass(L);M.txtCls="mstrmojo-Search-nonbreakable name";return M;},onclick:function H(K){this._super(K);this.dataGrid.execute(this.selectedItem,{zIndex:mstrmojo.mstr.search.Search.zIndex+2});},showTooltip:function F(N,M){var L=mstrmojo.dom.eventTarget(M,N),K=this.getItemNodeFromTarget(L);if(K.scrollWidth>K.clientWidth){this._super(N,M);}}});}());(function(){mstrmojo.requiresCls("mstrmojo.css","mstrmojo.array","mstrmojo.string","mstrmojo.Container","mstrmojo.WidgetList","mstrmojo.ui._HasListTooltip","mstrmojo.mstr._ObjectActions");mstrmojo.requiresDescs(3364,3366,9202);var B=mstrmojo.desc,E=mstrmojo.css,G=mstrmojo.string.escape4HTMLText;mstrmojo.mstr.search.SearchIconView=mstrmojo.declare(mstrmojo.WidgetList,[mstrmojo.mstr._ObjectActions],{scriptClass:"mstrmojo.mstr.search.SearchIconView",init:function I(L){this._super(L);E.addWidgetCssClass(this,"mstrmojo-SearchIconView");},itemFunction:function C(O,L,M){var N=new mstrmojo.mstr.search.SearchIconItem({parent:M,idx:L,data:O});M.attachListener4ItemWidget(N,M);return N;},attachListener4ItemWidget:function K(O,P){var M=["ItemExecute"],L=M.length,N;for(N=0;N<L;N++){O.attachEventListener(M[N],P.id,"itemEventHandler");}return O;},itemEventHandler:function(L){var N=L.name,M=L.data;switch(N){case"ItemExecute":this.execute(M,{zIndex:mstrmojo.mstr.search.Search.zIndex+2});break;}}});mstrmojo.mstr.search.SearchIconItem=mstrmojo.declare(mstrmojo.Container,[mstrmojo.ui._HasListTooltip],{scritpClass:"mstrmojo.mstr.search.SearchIconItem",markupString:'<div class="mstrmojo-SearchIconItem" mstrAttach:click ><i class="mstrIcon-lg" data-role="icn"></i><div class="ttl" data-role="n"></div><div class="owner" data-role="owner"><label>'+B(3364,"Owner:")+'</label><span></span></div><div class="modified" data-role="mdt"><label>'+B(3366,"Modified:")+'</label><span></span></div><div class="desc" data-role="desc"></div></div>',markupSlots:{iconNode:function(){return this.domNode.firstChild;},titleNode:function(){return this.domNode.childNodes[1];},ownerNode:function(){return this.domNode.childNodes[2].lastChild;},modifiedNode:function(){return this.domNode.childNodes[3].lastChild;},descNode:function(){return this.domNode.lastChild;}},markupMethods:{ondataChange:function(){var L=this.data||{},M=L.desc||"";E.addClass(this.iconNode,this.getIconCls(L));this.titleNode.innerHTML=G(L.n);this.ownerNode.innerHTML=G(L.owner);this.modifiedNode.innerHTML=G(L.mdt);this.descNode.innerHTML=this.allowHTMLOnObjectDesc?M:G(M);}},data:{},useRichTooltip:true,getIconCls:function H(L){L=L||this.data;return L.ccss||("t"+L.t+(L.st?" st"+L.st:"")+(L.isc?" isc":"")+(L.dvm?" dvm"+L.dvm:""));},onclick:function J(L){var N=L.getTarget(),M=(N.dataset&&N.dataset.role)||N.getAttribute("data-role");if(M==="icn"||M==="n"){this.raiseEvent({name:"ItemExecute",data:this.data});}},getRole:function D(L){return L.getAttribute("data-role");},getItemFromTarget:function F(L){var M=this.getRole(L);if(M==="n"||M==="desc"||M==="owner"){return{ttp:this.data[M]};}return{};},getItemNodeFromTarget:function A(L){if(this.getRole(L)){return L;}return null;},showTooltip:function(M){var L=mstrmojo.dom.eventTarget(window,M);if(L.scrollWidth>L.clientWidth||L.scrollHeight>L.clientHeight){this._super(M);}}});}());(function(){mstrmojo.requiresCls("mstrmojo.Obj","mstrmojo.css","mstrmojo.AjaxCall","mstrmojo.hash","mstrmojo.array","mstrmojo.expr","mstrmojo.Label","mstrmojo.ListBase","mstrmojo.ui.CheckList","mstrmojo.ui.ColumnContainer","mstrmojo.rw.ConditionWalkProviderBase","mstrmojo.elementHelper");var G=mstrmojo.css,X=mstrmojo.hash,t=mstrmojo.array,W=mstrmojo.expr,M=W.ET,Z=W.ET2TGT,Y=W.FN,S=W.FN_MRP,n=W.DTP2FN_DTP,E=mstrmojo.meta.TP,AB=W.TP,J=W.STP,l=mstrmojo.elementHelper,q=mstrmojo.rw.ConditionWalkProviderBase;var P={};P[M.AQ]={target:1,fm:1,fn:1,c0:1,c1:1};P[M.AL]={target:1,fm:1,fn:1,c0:1};P[M.AE]={target:1,fm:1,es:1};P[M.AC]={target:1,fm:1,fm2:1,fm3:1,fn:1,c0:1,c1:1};P[M.MQ]={target:1,fn:1,c0:1,c1:1,dmy:1};P[M.MC]=P[M.MQ];P["*"]={target:1};var w={};w[M.MQ]={key:"metricFns",def:W.METRIC_FNS};w[M.MC]={key:"metricFns",def:W.METRIC_FNS};w[M.AQ]={key:"formFns",def:W.FORM_FNS};w[M.AL]={key:"formFns",def:W.FORM_FNS};w[M.AC]={key:"formFns",def:W.FORM_FNS};w[M.AE]={key:"elemFns",def:W.ELEM_FNS};var AG=mstrmojo.desc(14084,"Select a filter option or a qualification."),AF=mstrmojo.desc(15007,"Choose to select in list or qualify on an attribute form."),AE=mstrmojo.desc(14085,"Select one or more elements."),N=mstrmojo.desc(15009,"Select element(s)."),AD=mstrmojo.desc(14086,"Select an operator."),AC=mstrmojo.desc(14087,"Enter a value or select an attribute from the list."),C=mstrmojo.desc(15010,"Enter a specific value or select an attribute form as variable."),AA=mstrmojo.desc(14088,"Select an attribute form. When done, click ## button.").replace("##",'"√"'),z=mstrmojo.desc(14089,"Select a condition."),AI=mstrmojo.desc(15011,"Select an operator."),x=mstrmojo.desc(14090,"Enter a value or select a metric from the list."),R=mstrmojo.desc(15012,"Enter a specific value or select a metric as variable.");var k=0,r=1;var H=mstrmojo.ui.ColumnContainer.prototype.updateColumnContainer;var e="dummy",I={did:"idErr",v:"idErr",n:mstrmojo.desc(7929,"Error loading data."),t:e,css:"unselectable"},p={did:"idWait",v:"idWait",n:mstrmojo.desc(2901,"Loading..."),t:e,css:"unselectable"},AH={did:"idSelect",v:"idSelect",n:mstrmojo.desc(547,"Select"),t:e,css:"unselectable"},v={did:"idWait",v:"idQualification",n:mstrmojo.desc(5225,"Qualification"),t:e,css:"unselectable"},D={did:"idWait",v:"idQualification",n:mstrmojo.desc(15008,"Qualify on"),t:e,css:"unselectable"};var b=q.onWalkChange,F=q.replaceItem,L=q.getChildJSON,u=q.walkChildPostCreateFn,o=q.updateList,AM=q.fnItem,AL=q.isComparisonAllowed,h=q.cstJson,f=q.fmJson,d=q.updateListMulti,m=q.updateListMultiData;function j(AN){return AN.targets?t.filter(AN.targets,function(AO){return AO[E]===W.TP.ATTR;}):[];}function K(AN){this.tip.set("text",AN);}var V=[W.STP.PROMPT,W.STP.PROMPT_OBJECTS,W.STP.PROMPT_ELEMENTS,W.STP.PROMPT_EXPRESSION,W.STP.PROMPT_EXPRESSION_DRAFT];var AK=q.allowedTargetTypes;mstrmojo.rw.ConditionWalkProvider=mstrmojo.declare(mstrmojo.rw.ConditionWalkProviderBase,null,{scriptClass:"mstrmojo.rw.ConditionWalkProvider",browseEs:function c(AQ,AP,AS){AQ.openPopup("eb",{zIndex:AQ.parent.zIndex+10,left:Math.round(AS.x)+"px",top:Math.round(AS.y)+"px"});var AO=AQ.eb.browser,AN=AQ.model,AR=AN&&AN.a&&AN.a.did;if(!AR){return ;}AO.set("attributeID",AR);AO.set("selectedItems",AN.es?X.clone(AN.es):[]);AO.initBrowser();},browseObjs:function AJ(AU,AN,AO){AU.openPopup("ob",{zIndex:AU.parent.zIndex+10,left:Math.round(AO.x)+"px",top:Math.round(AO.y)+"px"});var AP=AU.ob.browser;AP.target=AN;var AQ;switch(AN.alias){case"dmy":AQ=[W.TP.ATTR,W.TP.DIM];break;case"c0":case"c1":var AS=AU.model,AR=AS&&AS.et,AV=AS&&AS.fm,AT=AV&&AV.dtp||(AS.m?W.DTP.DECIMAL:W.DTP.UNKNOWN);AQ=(AR===M.MQ||AR===M.MC)?[W.TP.METRIC,W.DTP2PROMPT_STP[AT]]:[W.TP.ATTR,W.DTP2PROMPT_STP[AT]];break;default:AQ=AK(AU.ets);AQ=AQ?X.keyarray(AQ,true):[W.TP.ATTR,W.TP.METRIC,W.STP.REPORT_GRID,W.STP.REPORT_GRAPH,W.STP.REPORT_ENGINE,W.STP.REPORT_TEXT,W.STP.REPORT_DATAMART,W.STP.REPORT_BASE,W.STP.REPORT_GRIDGRAPH,W.STP.REPORT_NONINTERACTIVE,W.STP.FILTER].concat(V);}AQ[AQ.length]=W.TP.FOLDER;AP.browse({rootFolderType:AS&&(AS.et===M.MQ||AS.et===M.MC)?5:26,folderLinksContextId:33,onSelectCB:[AU,"onOBSelect"],browsableTypes:AQ.join(",")});},getFm2NodeProps:function U(){return{alias:"fm2",children:[f({alias:"fm2",fmPost:2})],updateColumnContainer:function AN(){var AO=this.parent.parent;if(this.domNode){G.addClass(this.domNode,"lastStage");}this.fm2.update();K.call(AO,AA);H.call(this);}};},getC0NodeProps:function Q(){var AN=this;return{alias:"c0",c1Selected:false,children:[{scriptClass:"mstrmojo.Label",cssClass:"baseOn",text:mstrmojo.desc(527,"Value")},h({alias:"c0",cstIndex:0}),{scriptClass:"mstrmojo.Label",alias:"btwn",cssClass:"btwn",text:mstrmojo.desc(308,"and"),visible:false},h({alias:"c1",cstIndex:1,visible:false}),{alias:"browseLink",scriptClass:"mstrmojo.Label",cssClass:"mstrmojo-walkstep-browse",text:mstrmojo.desc(7926,"Browse..."),onclick:function(){this.parent.parent.parent.browse(this.parent.c0);},visible:false}],updateColumnContainer:function AO(){this.c0.update();var AY=this.parent,AU=AY.parent,AT=AY.parent.model,AW=AT&&AT.fn,AQ=AW===Y.BETWEEN||AW===Y.NOT_BETWEEN||AW===S.BETWEEN||AW===S.BETWEEN_DESCENDING,AV=AW===Y.EQUAL||AW===Y.NOT_EQUAL||AW===Y.GREATER||AW===Y.GREATER_EQUAL||AW===Y.LESS||AW===Y.LESS_EQUAL,AX=this.idx,AS=this.next;this.browseLink.set("visible",AU.objectBrowsingEnabled&&AL(AT,AU.ets));this.btwn.set("visible",AQ);this.c1.set("visible",AQ);if(AQ){this.c1.update();}else{AT.edit("c1",{v:null,dtp:null,skipET:true},true);}if(AT.a2&&AV){if(!(AS&&AS.fm2)){AY.insertAndRemoveTrailing(AX,AN.getFm2NodeProps());}}else{AY.removeTrailingContainer(AX);}var AR=mstrApp.isWSStyling?C:AC,AP=mstrApp.isWSStyling?R:x;K.call(AU,AT.a?AR:AT.m?AP:"");if((!AT.a)&&AT.m&&this.domNode){G.addClass(this.domNode,"lastStage");}H.call(this);}};},getFnNodeProps:function a(){var AN=this;return{alias:"fn",children:[{scriptClass:"mstrmojo.Label",cssClass:"baseOn",text:mstrApp.isWSStyling?mstrmojo.desc(15006,"Operator"):mstrmojo.desc(9579,"Condition")},f({alias:"fn",allowUnlistedValues:false,update:function(){var AU=this.parent.parent.parent,AQ=AU.model||{},AV=AQ.et,AT,AW=false,AX,AP;switch(AV){case M.AE:AW=!!AQ.a;break;case M.AQ:case M.AC:case M.AL:AW=!!(AQ.fm&&AQ.fm.did);AT=AW?AQ.fm.dtp:null;break;case M.MQ:case M.MC:AW=!!AQ.m;AT=AW?W.METRIC_DTP:null;break;}if(AW){var AY=n[AT];if((this.lastEt!==AV)||(this.lastFnDtp!==AY)){this.lastEt=AV;this.lastFnDtp=AY;var AS=AV?w[AV]:null,AR=AS&&AS.key;AX=(AR&&AU[AR])||AS.def||[];if(typeof (AX)==="object"){AX=AX[AY]||AX["*"];}}AP=AM(AQ.fn,AQ.fnt||1);}o(this,AW,AX,AP);this.parent.updateScrollbars();}})],updateColumnContainer:function AO(){this.fn.update();var AP=this.parent,AQ=AP.parent,AR=AQ.model,AT=AR&&AR.fn,AS=this.next,AV=AT===Y.IS_NULL||AT===Y.IS_NOT_NULL;if(AT&&AV){AP.removeTrailingContainer(this.idx);}else{if(AT&&!(AS&&AS.c0)){AP.insertAndRemoveTrailing(this.idx,AN.getC0NodeProps());}}var AU=mstrApp.isWSStyling?AI:z;K.call(AQ,AR.a?AD:AR.m?AU:"");AS=this.next;if(AS){AS.updateColumnContainer();}}};},getEsNodeProps:function B(){var AP=[{scriptClass:"mstrmojo.ui.CheckList",alias:"es",itemIdField:"v",allowUnlistedValues:true,insertUnlistedValuesAt:0,selectionPolicy:"toggle",postCreate:function AO(){u.apply(this,[]);this.ajx=mstrmojo.insert({parent:this,scriptClass:"mstrmojo.AjaxCall",isTask:true,params:{taskId:"browseElements",attributeID:null,styleName:"MojoAttributeStyle",blockBegin:1,blockCount:mstrApp.elementsBlockCount||30},onsuccess:function(){var Aa=this.parent,AU=this.response;if((AU&&AU.did)!==Aa.lastAttrId){return ;}var AW=(AU&&AU.es)?t.filter(AU.es,function(Ab){return !l.isNullElem(Ab.v);}):[],AZ=Aa.parent.parent.parent.model&&Aa.parent.parent.parent.model.es,AX=function(Ah,Ac){var Ag=Ah&&Ah.length||0,Af=Ac&&Ac.length||0,Ab=[],Ae,Ad;for(Ae=0;Ae<Af;Ae++){for(Ad=0;Ad<Ag;Ad++){if(Ac[Ae].n===Ah[Ad].n){break;}}if(Ad===Ag){Ab.push(Ac[Ae]);}}return Ab;},AY=function(Ab,Ac,Af){var Ae=[],Ad;t.forEach(Ab,function(Ag){Ad=t.filterOne(Ac,function(Ah){return Ag[Af]&&Ah[Af]&&Ag[Af]===Ah[Af];});if(Ad){Ae.push(Ad);}});return Ae.length===Ab.length?Ae:Ab;};AZ=AZ&&AY(AZ,AW,"v");if(Aa.allowUnlistedValues){var AV=AX(AW,AZ);AW=(Aa.insertUnlistedValuesAt===0)?AV.concat(AW):AW.concat(AV);}m(Aa,AW,AZ,null);Aa.parent.updateScrollbars();},onerr:function(){F(this.parent,p,[I]);}});},onselectionChange:function AS(AU){mstrmojo.ListBase.prototype.onselectionChange.call(this,AU);b.call(this,AU);},update:function AR(){var AX=this.parent.parent.parent,AW=AX.model,Ab=AW&&AW.a,Ac=!!Ab&&!Ab.ilk,Ad,AU,Aa,AY,AV,Ae;if(Ac){if(this.lastAttrId!==Ab.did){this.lastAttrId=Ab.did;Ad=AW.es;AY=Ad&&Ad.length;Ad=AY?Ad.concat():[];Ad.push(p);if(AY){Aa=[];for(AV=1;AV<=AY;AV++){Aa[AV]=AV;}}Ae=this.ajx;AX.updateBrowseElementsParams(Ae.params,Ab);}else{AU=AW.es;}}d(this,Ac,Ad,AU,Aa);if(Ac&&Ae){if(AX.getElements){var AZ=this;AX.getElements(Ab,{success:function(Af){m(AZ,Af.es||[],AX.model&&AX.model.es,null);AZ.parent.updateScrollbars();},failure:function(){F(AZ,p,[I]);}});}else{Ae.send();}}},setupScrollNodes:function AQ(){this.scrollNode=null;}}];if(!mstrApp.isSingleTier){AP.splice(0,0,{scriptClass:"mstrmojo.Label",cssClass:"mstrmojo-walkstep-browse",text:mstrmojo.desc(7928,"Browse elements..."),onclick:function AN(){this.parent.parent.parent.browse(this.parent.es);}});}return{alias:"es",children:AP,updateList:function(AU){d(this.es,true,AU,this.parent.parent.model.es,null);this.updateScrollbars();},updateColumnContainer:function AT(){var AU=this.parent.parent;if(this.domNode){G.addClass(this.domNode,"lastStage");}this.es.update();K.call(AU,mstrApp.isWSStyling?N:AE);}};},getFmNodeProps:function O(){var AN=this;return{alias:"fm",children:[f({alias:"fm",fmPost:"",filter:false,isFirstFm:true})],updateColumnContainer:function AO(){this.fm.update();var AY=this.parent,AT=AY.parent,AS=AT.model,AV=AS&&AS.fm,AX=this.idx,AW=AS&&AS.a,AQ=AT.disableElementsBrowsing,AP=AW&&AQ&&AQ(AW);var AU=(AS.etWas&&AS.etWas===M.AE)?r:k,AR=k;if(AS.et===M.AE&&!AP){AR=r;}if(AU!==AR||AR===k){AY.removeTrailingContainer(AX);if(AR===k&&AV){AY.addNextColumn(AN.getFnNodeProps());}else{if(AR===r){AY.addNextColumn(AN.getEsNodeProps());}}}K.call(AT,mstrApp.isWSStyling?AF:AG);H.call(this);}};},getTargetNodeProps:function g(){var AN=this;return{alias:"target",target:null,browseLink:null,children:[{scriptClass:"mstrmojo.Label",cssClass:"baseOn",text:mstrmojo.desc(11859,"Based On")},L({alias:"target",insertUnlistedValuesAt:0,makeObservable:true,hideIfEmpty:true,postCreate:function(){this._super();this.parent.parent.parent.attachEventListener("updateTargets",this.id,function(){this.update();});},onObjBrowsed:function(AQ){if(AQ.st===J.FILTER||AQ.t===AB.REPORT||AQ.t===AB.PROMPT){this.parent.parent.parent.onOK();}},update:function AP(){var AR=this.parent.parent.parent,AS=AR.model,AV=AR.targetsLastMod,AW=AS&&AS.et;if(this.lastModel!==AS||this.targetsLastMod!==AV){this.lastModel=AS;this.targetsLastMod=AV;var AQ=AR.targets,AX=AR.ets;if(AX&&AQ&&AQ.length){var AU=AK(AR.ets);AQ=t.filter(AQ,function(AY){return AU[AY[E]];});}var AT=AS&&AS[Z[AW]];o(this,true,W.getSortedObjectsByTypeGroup(AQ),AT);this.parent.updateScrollbars();}}}),{alias:"browseLink",scriptClass:"mstrmojo.Label",cssClass:"mstrmojo-walkstep-browse",text:mstrmojo.desc(7926,"Browse..."),onclick:function(){this.parent.parent.parent.browse(this.parent.target);}}],updateColumnContainer:function AO(){this.target.update();var AR=this.parent,AS=AR.parent,AT=AS.model,AV=AT&&AT.et,AQ=this.idx,AU=this.next;this.browseLink.set("visible",AS.objectBrowsingEnabled);if(AV){switch(AV){case M.AQ:case M.AL:case M.AC:case M.AE:if(AT.a&&!(AU&&AU.fm)){this.parent.insertAndRemoveTrailing(AQ,AN.getFmNodeProps());}break;case M.MQ:case M.MC:if(AT.m&&!(AU&&AU.fn)){this.parent.insertAndRemoveTrailing(AQ,AN.getFnNodeProps());}break;case M.R:case M.F:case M.XML:this.parent.removeTrailingContainer(AQ);break;}}AU=this.next;if(AU){AU.updateColumnContainer();}}};}});var A=mstrmojo.rw.ConditionWalkProvider;A.setTip=K;}());(function(){mstrmojo.requiresCls("mstrmojo.OIVMDICPopup","mstrmojo.SliderDIC","mstrmojo.TextFieldDIC","mstrmojo.CheckBoxDIC","mstrmojo.ListDIC","mstrmojo.CalendarDIC","mstrmojo.TimePickerDIC","mstrmojo.ToggleDIC","mstrmojo.TextAreaDIC","mstrmojo.MarkRowDIC","mstrmojo.DefaultDIC","mstrmojo.RatingDIC","mstrmojo.RankDIC","mstrmojo.StepperDIC","mstrmojo.LikertScaleDIC","mstrmojo._HasConditionLogicDIC","mstrmojo.DynamicClassFactory");var C=null,B=1,L=2,H=3,A=4,M=5,P=6,G=7,O=8,E=10,F=11,K=13,J=2,D=2;var I={1:"ActiveTextFieldDIC",3:"ActiveListDIC",8:"ActiveTextAreaDIC",10:"ActiveRatingDIC",11:"ActiveRankDIC",14:"ActiveLikertScaleDIC"};var N=mstrmojo.DynamicClassFactory.newComponent;mstrmojo.OIVMDICConfig=mstrmojo.provide("mstrmojo.OIVMDICConfig",{DICList:{1:mstrmojo.TextFieldDIC,2:mstrmojo.CheckBoxDIC,3:mstrmojo.ListDIC,4:mstrmojo.SliderDIC,5:mstrmojo.CalendarDIC,6:mstrmojo.TimePickerDIC,7:mstrmojo.ToggleDIC,8:mstrmojo.TextAreaDIC,9:mstrmojo.DefaultDIC,10:mstrmojo.RatingDIC,11:mstrmojo.RankDIC,12:mstrmojo.StepperDIC,13:mstrmojo.DefaultDIC,14:mstrmojo.LikertScaleDIC,102:mstrmojo.MarkRowDIC},getDICClass:function(R){if(R.t===K){if(!!R.em){return mstrmojo.ListDIC;}else{return mstrmojo.TextFieldDIC;}}if(R.act){var Q=I[R.t];if(!mstrmojo[Q]){mstrmojo[Q]=N(this.DICList[R.t],[mstrmojo._HasConditionLogicDIC],{scriptClass:Q});}return mstrmojo[Q];}return this.DICList[R.t];},showDICByDefault:function(R,Q){if(R.sbd===undefined){if(R.t==O&&R.dm==0&&R.siwc){R.sbd=true;}else{if(R.t==K){R.sbd=false;}else{if(this.DICList[R.t]==mstrmojo.DefaultDIC){R.sbd=0;}else{R.sbd=R.dm===1;}}}}return R.sbd;},hasDICPreview:function(R,Q){if(R.hpp===undefined){R.hpp=false;}return R.hpp;},isKeyNavigable:function(Q){if(Q.ikn===undefined){switch(Q.t){case B:case M:case H:case L:case G:case A:case P:case O:Q.ikn=true;break;default:Q.ikn=false;}}return Q.ikn;},DICPopup:{getInstance:function(Q,R){if(!C){C=new mstrmojo.OIVMDICPopup();C.render();}return C;},cancel:function(){if(C){C.onCancel();}}},canSlice:function(S,R){var U=S.tks,Q=S.ipt;if(!!U&&Q==D&&R==J){return true;}return false;}});mstrmojo.DICConfig=mstrmojo.OIVMDICConfig;mstrmojo.DICList=mstrmojo.DICConfig.DICList;mstrmojo.DICPopup=mstrmojo.DICConfig.DICPopup;})();(function(){mstrmojo.requiresCls("mstrmojo.hash","mstrmojo.expr","mstrmojo.dom","mstrmojo.form","mstrmojo.boxmodel","mstrmojo.Obj","mstrmojo.Arr","mstrmojo.string","mstrmojo.Box","mstrmojo.TBox","mstrmojo.HBox","mstrmojo.Label","mstrmojo.Button","mstrmojo.HTMLButton","mstrmojo.TextBox","mstrmojo.Popup","mstrmojo.Editor","mstrmojo.Dial","mstrmojo.WidgetList","mstrmojo.FilterExpr","mstrmojo.CGEOptions","mstrmojo.ConditionWalk","mstrmojo.SaveAsEditor","mstrmojo.CGFormatEditor");var W=mstrmojo.expr,E=W.ET,K=W.BRANCH_FNS,R=mstrmojo.hash,Z=mstrmojo.boxmodel,G=mstrmojo.Arr,S=mstrmojo.Obj,L=mstrmojo.string,X=mstrmojo.dom,U=mstrmojo.expr.TP,B=mstrmojo.expr.STP;function F(b){var g={};if(b){var e=b.items;for(var d=0,a=(e&&e.length)||0;d<a;d++){var f=e[d],c=f&&f.expr;if(c){W.findTargets(c,"did",g);}}}return R.valarray(g);}function P(c){var b=c.model;c.targets=F(b);c.targetsLastMod=new Date();if(!b){b=new S({});c.model=b;}var e=b.items;if(!e){e=mstrmojo.Arr.makeObservable([]);b.items=e;}else{if(!e.attachEventListener){e=R.make(e,G);}}for(var d=0,a=e.length;d<a;d++){var f=e[d];if(!f.attachEventListener){f=R.make(f,S);}}}var M=mstrmojo.desc(4778,"Element"),V=new RegExp(M+"\\s*(\\d+)","i"),C=10000;function N(f){var e=1;for(var c=0,b=(f&&f.length)||0;c<b;c++){var g=f[c].n,a=g&&g.match(V);if(a){var d=parseInt(a[1],10);e=Math.max(d+1,e);}}return M+" "+e;}var H=200;function D(e,d,c){var b=mstrmojo.all.mstrCGE,f=X.delta(d.domNode,b.editorNode);f.y+=(c=="andor"?16:parseInt(d.domNode.offsetHeight,10));var a={condition:d,zIndex:b.zIndex+10,left:f.x+"px",top:f.y+"px"},g;switch(c){case"andor":g="andOrPopupRef";break;case"condition":g="conditionPopupRef";a.model=R.clone(e);a.targets=b.targets;a.targetsLastMod=b.targetsLastMod;break;}b.openPopup(g,a);}function Y(b){var c=b.parent.data;if(c){var a=b.items;c.expr=a&&a[0];}}function J(d){if(d.constructor!==Array){d=[d];}var h,g={b:0,c:0},k,f,c;for(var e=0,a=d.length;e<a;e++){h=d[e];if(!(h&&h.et)){continue;}k=h.nds;if(k){f=J(k);g.b+=f.b;g.c+=f.c;}else{c=(h.et===E.B);g[c?"b":"c"]++;}}return g;}function O(a){var c=J(a.value),b=this.tree;b.set("bandingCount",b.bandingCount+c.b);b.set("conditionCount",b.conditionCount+c.c);}function A(a){var c=J(a.value),b=this.tree;b.set("bandingCount",b.bandingCount-c.b);b.set("conditionCount",b.conditionCount-c.c);}function I(b){var e=mstrmojo.all.mstrCGE,a=e.model,f=a.did,d=a.cgp,c=e.getXML();return{taskId:"saveCustomGroup",xml:c,objectID:f||"",description:a.desc||"",name:a.n||"",saveAs:b,aggregation:d.agg,flatten:d.flat,parentFirst:d.pf,reportFilterInteraction:d.rfi};}mstrmojo.CustomGroupEditor={id:"mstrCGE",title:mstrmojo.desc(7919,"Custom Group Editor"),scriptClass:"mstrmojo.Editor",cssClass:"mstrmojo-charcoalboxe",cssText:"width:750px;",zIndex:10,model:null,readOnly:false,help:"custom_group_editor.htm",formatPopupRef:{scriptClass:"mstrmojo.CGFormatEditor",contentNodeCssClass:"mstrmojo-balloon",alias:"formatEditor",title:mstrmojo.desc(2116),left:"100px",top:"100px",useAnimate:false,height:350,slot:"containerNode",help:"formatting_a_custom_group.htm",locksHover:true,model:null,_set_model:function(b,a){P(mstrmojo.all.mstrCGE);this.model=a;this.model.selectedIndex=mstrmojo.all.mstrCGEls.selectedIndex;return true;},bindings:{model:function(){return mstrmojo.all.mstrCGE.model;}},onOpen:function(){this.set("model",mstrmojo.all.mstrCGE.model);}},saveasRef:{scriptClass:"mstrmojo.SaveAsEditor",typeDesc:mstrmojo.desc(2105,"Custom Group"),browsableTypes:"8,257",onObjectSaved:function(c){var b=mstrmojo.all.mstrCGE,a=b&&b.model;if(a){a.set("did",c.did);a.set("n",c.name);a.set("desc",c.desc);}if(b.noRefresh!==true){b.needRefreshPage=true;}}},optionsRef:{scriptClass:"mstrmojo.Editor",cssClass:"mstrmojo-CGEOptions",contentNodeCssClass:"mstrmojo-balloon",left:"100px",top:"230px",slot:"containerNode",help:"Custom_Group_Options_dialog_box.htm",showTitle:true,title:mstrmojo.desc(7969,"Custom Group Options"),onOpen:function(){var a=mstrmojo.all.mstrCGE,b=this.optionsEditor;b.open(a.model,{closeCB:[this,"close"]});},children:[{scriptClass:"mstrmojo.CGEOptions",alias:"optionsEditor"}]},postCreate:function(){P(this);},_set_model:function(e,a){var c=this.model,d=c!==a,b=mstrmojo.all.mstrCGEls;if(d){this.model=a;P(this);if(b){b.clearSelect();}}return d;},children:[{scriptClass:"mstrmojo.TBox",alias:"header",cssText:"width: 100%",children:[{scriptClass:"mstrmojo.Label",alias:"name",cssClass:"mstrmojo-charcoalbox subtle mstrmojo-cge-name",emptyText:mstrmojo.desc(7920,"Enter Custom Group name here."),bindings:{text:function(){var a=mstrmojo.all.mstrCGE.model.n||this.emptyText;return a;}},onclick:function(){var a=mstrmojo.all.mstrCGE,b=X.delta(this.domNode,a.containerNode);a.openPopup("inlineTextRef",{left:b.x+"px",top:b.y-(X.isIE7?1:0)+"px",txtConfig:{cssClass:"mstrmojo-cge-name-edit",value:a.model.n||"",onEnter:function(){var c=L.trim(this.value);if(c){a.model.set("n",c);}this.parent.close({enter:true});},onCancel:function(){this.set("value",a.model.n);},prevTab:null,nextTab:a.header.desc}});}},{scriptClass:"mstrmojo.Label",alias:"desc",cssClass:"mstrmojo-charcoalbox subtle mstrmojo-cge-desc",emptyText:mstrmojo.desc(7921,"Enter Custom Group description here."),rows:1,bindings:{text:function(){var a=mstrmojo.all.mstrCGE.model.desc||this.emptyText;return a;}},onclick:function(){var a=mstrmojo.all.mstrCGE,b=X.delta(this.domNode,a.containerNode);a.openPopup("inlineTextRef",{left:b.x+"px",top:b.y-(X.isIE7?1:0)+"px",txtConfig:{cssClass:"mstrmojo-cge-desc-edit",value:a.model.desc||"",onEnter:function(){a.model.set("desc",L.trim(this.value));this.parent.close({enter:true});},onCancel:function(){this.set("value",a.model.desc);},prevTab:a.header.name,nextTab:null}});}}]},{scriptClass:"mstrmojo.Box",cssClass:"mstrmojo-CGE-content",alias:"content",children:[{id:"mstrCGEls",scriptClass:"mstrmojo.WidgetList",cssClass:"mstrmojo-CustomGroupEls",bindings:{items:"mstrmojo.all.mstrCGE.model.items"},multiSelect:false,renderOnScroll:false,draggable:true,dropZone:true,allowCopy:false,allowDrop:function(d){var b=d&&d.src,a=b&&b.widget;return(a===this);},itemIdField:null,itemDisplayField:"n",onchange:function(e){var b=this.selectedIndex,d=this.ctxtBuilder.itemWidgets,c;for(var f=0,a=d.length;f<a;f++){c=d[f];if(c&&f!=b){c.filterExpr.clearTreeSelect();}}},getNextId:function(){return ++C;},itemFunction:function(c,a,b){return new mstrmojo.CustomGroupEl({cssClass:"mstrmojo-charcoalbox",data:c,parent:b,state:c.isNew?1:0,onRender:c.isNew?function(){this.filterExpr.newCondition();delete this.data.isNew;}:mstrmojo.emptyFn,onclick:function(d){var e=X.eventTarget(d.hWin,d.e);if(e===this.titleNode){var f=mstrmojo.all.mstrCGE,h=X.delta(this.titleNode,f.containerNode),g=this;f.openPopup("inlineTextRef",{left:h.x+(X.isIE?1:0)+"px",top:h.y+(X.isIE7?-1:1)+"px",txtConfig:{cssClass:"mstrmojo-cge-elname-edit",value:this.data.n||"",onEnter:function(){var j=L.trim(this.value);if(j){g.data.n=j;g.paint();}this.parent.close({enter:true});},onCancel:function(){this.set("value",g.data.n);},prevTab:null,nextTab:null}});}},postCreate:function(){this.children=[{scriptClass:"mstrmojo.FilterExpr",slot:"exprNode",alias:"filterExpr",bindings:{items:"var ex = this.parent.data.expr; return ex ? [ex] : []"},draggable:true,dropZone:true,allowCopy:false,makeObservable:true,bandingCount:0,conditionCount:0,getItemConfig:function h(m,j,n){var l=this.constructor.prototype.getItemConfig.call(this,m,j,n);l.getPrefixAndOrToolsMarkup=function k(){return('<img class="mstrmojo-outdent disable" src="../images/1ptrans.gif" title="'+mstrmojo.desc(5896,"Ungroup conditions")+'" /><img class="mstrmojo-outdent" src="../images/1ptrans.gif" title="'+mstrmojo.desc(5896,"Ungroup conditions")+'" onclick="mstrmojo.all[\'{@id}\'].out()" /><img class="mstrmojo-indent disable" src="../images/1ptrans.gif" title="'+mstrmojo.desc(5895,"Group conditions")+'" /><img class="mstrmojo-indent" src="../images/1ptrans.gif" title="'+mstrmojo.desc(5895,"Group conditions")+'" onclick="mstrmojo.all[\'{@id}\'].ind()" />');};return l;},onadd:function(j){Y(this);O.apply(this,[j]);},onremove:function(j){Y(this);A.apply(this,[j]);},editable:true,onRender:function(){var k=J(this.items),j=this.tree;j.set("bandingCount",k.b);j.set("conditionCount",k.c);},isEditable:function g(k){if(!this.editable){return false;}var j=false;switch(k&&k.et){case E.ANDOR:case E.MQ:case E.AQ:case E.AL:case E.AC:case E.MC:case E.AE:case E.R:case E.F:j=true;break;case E.XML:j=!k.xml;}if(!j){mstrmojo.all.mstrCGE.set("readOnly",true);}return j;},onnodeclick:function f(j){if(!this.editable){return ;}D(this.data,this,j&&j.part);},onnodeadd:O,onnoderemove:A,allowDrop:function d(j){var l=j&&j.src,o=l&&l.data,n=o&&o.et,m=(n===E.B),k=this.tree;return n&&((m&&(k.conditionCount===0))||(!m&&(k.bandingCount===0)));},onNew:function e(j){D(j.data,j.widget.ctxtBuilder.itemWidgets[j.index],"condition");}},{scriptClass:"mstrmojo.Button",cssClass:"mstrmojo-CGE-addCondition",text:mstrmojo.desc(1994,"Add Condition"),slot:"exprToolsNode",onclick:function(){this.parent.filterExpr.newCondition(null,true);},bindings:{enabled:function(){return this.parent.filterExpr.bandingCount===0;}}}];}});}},{scriptClass:"mstrmojo.Button",cssClass:"mstrmojo-CGE-newElement",text:mstrmojo.desc(7922,"New Custom Group Element"),alias:"addBtn",title:mstrmojo.desc(7923,"Add new Custom Group Element"),onclick:function(){var a=mstrmojo.all.mstrCGEls;var b=a.add([{n:N(a.items),did:++C,isNew:true}]);a.scrollTo(b);}}]},{scriptClass:"mstrmojo.HBox",cssClass:"mstrmojo-Editor-buttonBar",cssText:"width: 100%",slot:"buttonNode",children:[{scriptClass:"mstrmojo.HBox",cssClass:"left",cssText:"border-collapse: separate",cellSpacing:3,children:[{scriptClass:"mstrmojo.HTMLButton",cssClass:"mstrmojo-Editor-button",text:mstrmojo.desc(4596,"Format..."),onclick:function(){var a=mstrmojo.all.mstrCGE;a.openPopup("formatPopupRef",{zIndex:a.zIndex+10});},bindings:{enabled:function(){return mstrmojo.all.mstrCGE.model.items.length>0;}}},{scriptClass:"mstrmojo.HTMLButton",cssClass:"mstrmojo-Editor-button",text:mstrmojo.desc(7924,"Options..."),onclick:function(){var a=mstrmojo.all.mstrCGE;a.openPopup("optionsRef",{zIndex:a.zIndex+10});}}]},{scriptClass:"mstrmojo.HBox",cssText:"float:right; border-collapse: separate",cellSpacing:3,children:[{scriptClass:"mstrmojo.HTMLButton",cssClass:"mstrmojo-Editor-button",text:mstrmojo.desc(5891,"Save"),onclick:function(){var b=mstrmojo.all.mstrCGE,a=b.model,g=a.did,e=b.isValid(true),d=mstrmojo.desc(8113,"New Custom Group");if(e){if(!g){b.openPopup("saveasRef",{name:a.n||d,desc:a.desc||"",folderLinksContextId:22,rootFolderID:a.pf,saveParams:I(true),zIndex:b.zIndex+10});return ;}var c=this,f=I(false);this.set("enabled",false);this.set("iconClass","mstrmojo-WaitIcon");mstrmojo.xhr.request("POST",mstrConfig.taskURL,{success:function(){c.set("enabled",true);c.set("iconClass","");},failure:function(h){c.set("enabled",true);c.set("iconClass","");mstrmojo.alert(h.getResponseHeader("X-MSTR-TaskFailureMsg"));}},f);}},bindings:{enabled:function(){return !mstrmojo.all.mstrCGE.readOnly&&mstrmojo.all.mstrCGE.model.items.length>0;}}},{scriptClass:"mstrmojo.HTMLButton",cssClass:"mstrmojo-Editor-button",text:mstrmojo.desc(628,"Save As"),onclick:function(){var b=mstrmojo.all.mstrCGE,a=b&&b.model,d=b.isValid(true),c=mstrmojo.desc(8113,"New Custom Group");if(d){b.openPopup("saveasRef",{name:a.n||c,desc:a.desc||"",folderLinksContextId:22,rootFolderID:a.pf,saveParams:I(true),zIndex:b.zIndex+10});}},bindings:{enabled:function(){return !mstrmojo.all.mstrCGE.readOnly&&mstrmojo.all.mstrCGE.model.items.length>0;}}},{scriptClass:"mstrmojo.HTMLButton",cssClass:"mstrmojo-Editor-button",text:mstrmojo.desc(221,"Cancel"),onclick:function(){mstrmojo.all.mstrCGE.close();}}]}]}],onOpen:function(){if(this.readOnly){mstrmojo.all.mstrCGE.set("title",mstrmojo.desc(8031,"Custom Group Editor (Read Only)"));mstrmojo.alert(mstrmojo.desc(8022));}},onClose:function(){this.readOnly=false;if(this.needRefreshPage){var a=mstrApp;mstrmojo.form.send({evt:5005,src:a.name+"."+a.pageName+".5005"});this.needRefreshPage=false;}},getXML:function Q(){var b=this.model;var h='<exp> <nd et="14" n="OR" fn="20" ce="'+(b.cgp.ce?-1:0)+'" isp="'+(b.cgp.isp?-1:0)+'" ><nds>',c="</nds></nd></exp>",g={a:true,a2:true,a3:true,agg:true,cc:true,ce:true,cgp:true,cs:true,desc:true,did:true,dmt:true,dmy:true,dtp:true,es:true,et:true,expr:true,f:true,flat:true,flt:true,fm:true,fm2:true,fm3:true,fn:true,fnt:true,fres:true,gb:true,isp:true,items:true,m:true,m2:true,m3:true,n:true,nds:true,not:true,pf:true,p:true,r:true,rps:true,st:true,t:true,utgt:true,utp:true,uts:true,v:true,xml:true},a={getArrItemName:function(p,m,o){return p.substr(0,p.length-1);},isSerializable:function(v,t,r){if(v=="xml"){var n=t[r].xml;return{att:'hasXML = "-1"',child:n};}else{if(mstrmojo.array.indexOf(["header_format","grid_format","child_header_format","child_grid_format"],v)>-1){var w=t[r][v];if(!w){return{};}var p="<"+v+">";for(var u in w){p+="<prs n='"+u+"'>";var o=w[u];for(var m in o){var q=o[m];p+="<pr n='"+m+"' v='"+(q=="pru"?"":q)+"'";p+=q=="pru"?' pru="1"':"";p+="/>";}p+="</prs>";}p+="</"+v+">";return{child:p};}}return(g[v])?true:false;},skipNull:true},f=b.items,l=[];for(var d=0,e=f.length;d<e;d++){var k=f[d],j=k.expr;j.n=k.n;if(j.fnt&&j.fnt==W.FNT.PER&&j.cs&&j.cs[0]){j.cs[0].v+="%";}l[d]=L.json2xml("nd",[{ce:k.ce||false,isp:k.isp||false,header_format:k.header_format,grid_format:k.grid_format,child_header_format:k.child_header_format,child_grid_format:k.child_grid_format},k.expr],a);}return h+l.join("")+c;},inlineTextRef:{scriptClass:"mstrmojo.Popup",locksHover:true,slot:"containerNode",children:[{scriptClass:"mstrmojo.TextBox",alias:"txt",onTab:function(b){if(this.onEnter){this.onEnter();}var a=X.shiftKey(b.hWin,b.e)?this.prevTab:this.nextTab;if(a&&a.onclick){a.onclick();}},onblur:function(){if(this.onEnter){this.onEnter();}},onEsc:function(){if(this.onCancel){this.onCancel();}this.parent.close({cancel:true});}}],onOpen:function(){var b=this.txt,d=this.txtConfig;if(d){for(var a in d){b.set(a,d[a]);}}b.focus();},onClose:function(a){if(!a||(!a.cancel&&!a.enter)){this.txt.onEnter();}}},andOrPopupRef:{scriptClass:"mstrmojo.Editor",cssClass:"mstrmojo-CGE-andOrPopup mstrmojo-ConditionWalk",cssText:"width: auto;",contentNodeCssClass:"mstrmojo-balloon",left:"250px",top:"15px",slot:"containerNode",autoClose:true,showTitle:false,draggable:false,openEffect:null,closeEffect:null,onOpen:function(){var a=this.condition,d=a&&a.data&&a.data.not,e=a&&a.parent,b=e&&e.data,c=(b&&b.fn)+(d?21:0);this.list.opening=true;this.list.set("selectedItem",isNaN(c)?null:{did:c});this.list.opening=false;},children:[{scriptClass:"mstrmojo.Dial",cssClass:"mstrmojo-CGE-andOrDial",alias:"list",itemMarkup:'<div class="dial-item {@css}">{@n}</div>',itemIdField:"did",items:[{did:19,n:K[19]},{did:20,n:K[20]},{did:19+21,n:K["19_21"]},{did:20+21,n:K["20_21"]}],onchange:function(){if(this.opening){return ;}var b=this.parent,a=b.condition,h=this.selectedItem,g=h&&h.did,f=g>21?true:null,e=g-(f?21:0);b.close();var c=a&&a.parent;if(c&&c.data&&c.data.et===W.ET.ANDOR){c.edit(a,e,f);}else{var j=a&&a.data;if(j&&(j.not!==f)){j.not=f;a.paint();}}}}]},conditionPopupRef:{scriptClass:"mstrmojo.Editor",cssClass:"mstrmojo-Editor-ConditionWalk",contentNodeCssClass:"mstrmojo-balloon",title:mstrmojo.desc(7953,"Condition Editor"),help:"condition_editor.htm",slot:"containerNode",onOpen:function(){this.walk.set("targets",this.targets);this.walk.set("targetsLastMod",this.targetsLastMod);this.walk.set("model",this.model);var a=[U.ATTR,U.METRIC,B.REPORT_GRID,B.REPORT_GRAPH,B.REPORT_ENGINE,B.REPORT_TEXT,B.REPORT_DATAMART,B.REPORT_BASE,B.REPORT_GRIDGRAPH,B.REPORT_NONINTERACTIVE,B.FILTER,B.PROMPT,B.PROMPT_ELEMENTS,B.PROMPT_EXPRESSION,B.PROMPT_EXPRESSION_DRAFT];this.walk.set("browsableTypes",a);},onClose:function(){var a=this.condition;if(a.isEmpty()){a.del();}},children:[{scriptClass:"mstrmojo.ConditionWalk",alias:"walk",cssText:"height:"+H+"px",targets:null,ets:null,onOK:function(){var a=this.parent,b=a.condition;R.copy(R.clone(this.model.get()),R.clear(b.data));b.paint();a.close();}}]},isValid:function(d){var c=mstrmojo.all.mstrCGE.model.items,a=c.length,b,e="";if(a>0){for(b=0;b<a;b++){if(!c[b].expr){e+=c[b].n+",";}}if(e){e=e.replace(/,$/,"");mstrmojo.alert(mstrmojo.desc(7947).replace("#",e));return false;}}else{mstrmojo.alert("Custom Group does not have any element defined. Please fix it before saving.");return false;}return true;}};})();(function(){mstrmojo.requiresCls("mstrmojo.Container","mstrmojo.array","mstrmojo.hash","mstrmojo.color","mstrmojo._HasLayout","mstrmojo.vi.ui._IsPanel","mstrmojo._HasPopup","mstrmojo._HasOwnAvatar","mstrmojo.vi.ui._HasTargets","mstrmojo.vi.ui._IsBoxLayoutChild","mstrmojo.vi.ui._IsDropTarget","mstrmojo.vi._MonitorsAppState","mstrmojo.vi._MonitorsLayoutMode","mstrmojo._Formattable","mstrmojo.vi.ui._IsUnitContainerTitleBar","mstrmojo.DynamicClassFactory","mstrmojo.Box","mstrmojo.css","mstrmojo.dom","mstrmojo.func","mstrmojo.models.FormatModel","mstrmojo.DocDataService","mstrmojo.vi.ui.TitleBar","mstrmojo.vi.models.EnumDragSources","mstrmojo.vi.enums.EnumThemeProperties","mstrmojo.vi.ui.rw._HasVisFilterIndicator","mstrmojo.EnumRWUnitType","mstrmojo.vi.ui._CanGroup","mstrmojo.EnumRWUnitType");mstrmojo.requiresDescs(629,1388,11477,11478);var W=mstrmojo.array,A3=mstrmojo.css,AQ=mstrmojo.dom,Z=mstrmojo.hash,AH=mstrmojo.color,A9=mstrmojo.vi.models.EnumDragSources,m=mstrmojo.models.FormatModel,g=m.ENUM_PROPERTY_NAMES,Ak=1,AM="visible",k="mouse-left",A1="no-menu",AX="ctrlOverlay",p="or-v",H="or-h";var An={SHORT:"ghost-short",TALL:"ghost-tall",GRANDE:"ghost-grande",VENTI:"ghost-venti",HIDE_TITLE:"ghost-hide-title",HIDE_DESC:"ghost-hide-desc"};var b={BLACK:"ghost-black",WHITE:"ghost-white",GREY:"ghost-grey"};var D=Z.valarray(An);var c=Z.valarray(b);var U=D.concat(c);var j={W_LV1:{H_LV1:[An.VENTI],H_LV2:[An.GRANDE],H_LV3:[An.TALL],H_LV4:[An.TALL,An.HIDE_TITLE],H_LV5:[An.SHORT,An.HIDE_TITLE],H_LV6:[An.SHORT,An.HIDE_TITLE,An.HIDE_DESC]},W_LV2:{H_LV1:[An.GRANDE],H_LV2:[An.GRANDE],H_LV3:[An.TALL],H_LV4:[An.TALL,An.HIDE_TITLE],H_LV5:[An.SHORT,An.HIDE_TITLE],H_LV6:[An.SHORT,An.HIDE_TITLE,An.HIDE_DESC]},W_LV3:{H_LV1:[An.TALL],H_LV2:[An.TALL],H_LV3:[An.TALL],H_LV4:[An.TALL,An.HIDE_TITLE],H_LV5:[An.SHORT,An.HIDE_TITLE],H_LV6:[An.SHORT,An.HIDE_TITLE,An.HIDE_DESC]},W_LV4:{H_LV1:[An.SHORT],H_LV2:[An.SHORT],H_LV3:[An.SHORT],H_LV4:[An.SHORT,An.HIDE_TITLE],H_LV5:[An.SHORT,An.HIDE_TITLE],H_LV6:[An.SHORT,An.HIDE_TITLE,An.HIDE_DESC]},W_LV5:{H_LV1:[An.SHORT],H_LV2:[An.SHORT],H_LV3:[An.SHORT],H_LV4:[An.SHORT,An.HIDE_TITLE],H_LV5:[An.SHORT,An.HIDE_TITLE,An.HIDE_DESC],H_LV6:[An.SHORT,An.HIDE_TITLE,An.HIDE_DESC]}};function Ag(BD){var BG=BD?BD.c1||BD:"",BF=AH.getLuminance(BG),BC=255,BH=68.7914,BE=Math.max(BC/BF,BF/BC),BI=Math.max(BH/BF,BF/BH);if(BE>=BI){return b.WHITE;}if(BF<190){return b.BLACK;}return b.GREY;}function A2(BG,BD){var BI,BH,BF;if(BG>=1024){BI="W_LV1";}else{if(BG>=640){BI="W_LV2";}else{if(BG>=320){BI="W_LV3";}else{if(BG>=100){BI="W_LV4";}else{BI="W_LV5";}}}}if(BD>=1024){BH="H_LV1";}else{if(BD>=640){BH="H_LV2";}else{if(BD>=320){BH="H_LV3";}else{if(BD>=200){BH="H_LV4";}else{if(BD>=100){BH="H_LV5";}else{BH="H_LV6";}}}}}BF=j[BI][BH];if(this.getFormats){var BC=this.getFormats(),BE=BC&&BC["background-color"];BF=BF.concat(Ag(BE));}return BF;}mstrmojo.vi.ui.rw.UnitContainerTitleBar=mstrmojo.DynamicClassFactory.newComponent(mstrmojo.vi.ui.TitleBar,[mstrmojo.vi.ui._IsUnitContainerTitleBar],{scriptClass:"mstrmojo.vi.ui.rw.UnitContainerTitleBar"});var Aq={n:mstrmojo.desc(11477,"Hide Titlebar"),cls:"htb",fn:function(){this.toggleTitleBar(false);},dsbld:false};var A5={n:mstrmojo.desc(11478,"Show Titlebar"),cls:"stb",fn:function(){this.toggleTitleBar(true);},dsbld:false};function R(BD,BC,BE){var BF=mstrApp.isAppStatePresentation(),BG=this.domNode;A3.toggleClass(this.domNode,"pulse",BD&&!BF&&!BE);if(BC){setTimeout(function(){A3.toggleClass(BG,"pulse",false);},500);}}function Ay(BD,BC){return mstrmojo.all[BD].getPanel().getUnitByKey(BC);}function t(){var BE=this.menuBtnInfo,BG=BE&&BE.menuCfg,BD=BG&&BG.menus,BF=(BD&&BD.length>0),BC=BE&&BE.btn;if(BC){BC.style.display=BF?"block":"none";}A3.toggleClass(this.domNode,A1,!BF);}function A6(BC,BE){var BD=this.getContextDragData(BC);return !!(BD&&(BD.src===BE));}function w(BC){return A6.call(this,BC,A9.FILTERS);}function AS(BC){return A6.call(this,BC,A9.DATASETS);}function AI(BC){return A6.call(this,BC,A9.ALL_OBJECT_LIST);}function Az(BC){var BD=BC.children;if(BD&&BD.length){BC.removeChildren();BD.forEach(function(BE){BE.destroy();});}}function O(){var BC=this.boxContent;if(BC&&BC.getFormats){return BC.getFormats();}return null;}function As(BC){if(BC.visible){if(BC.controls){this.showControlOverlay(BC.controls);}else{throw new Error('mstrmojo.vi.ui.rw.UnitContainer: "controls" should be provided when showing the control overlay');}}else{this.hideControlOverlay();}}function Aj(BG,BD){var BE=this.model.controller,BF="propertiesPanel",BC=function(){var BI=this.getFormatMenuItemTarget(BG);var BK=this.getEditorModel();if(BK.selectTargetByValue){BK.selectTargetByValue(BI);}if(BD){BD(BI);}var BH=BE.getViPanel(BF),BJ=BH&&BH.parent;if(BJ&&BJ.highlightSelected){BJ.highlightSelected();}}.bind(this);if(BE.getViPanel(BF)){BE.selectViPanel(BF);BC();}else{BE.openViPanel(BF,{success:BC});}}function K(BE,BC){var BD=BE?"titlebarNode":"domNode";this.clearCache();this.clearSlotBackgroundCSS(BD);this.applyCSSFormatToNode(BD,BC);}mstrmojo.vi.ui.rw.UnitContainer=mstrmojo.declare(mstrmojo.Container,[mstrmojo._HasLayout,mstrmojo._Formattable,mstrmojo._HasPopup,mstrmojo._HasOwnAvatar,mstrmojo.vi.ui._IsBoxLayoutChild,mstrmojo.vi.ui._IsDropTarget,mstrmojo.vi._MonitorsAppState,mstrmojo.vi._MonitorsLayoutMode,mstrmojo.vi.ui._HasTargets,mstrmojo.vi.ui.rw._HasVisFilterIndicator,mstrmojo.vi.ui._CanGroup],{scriptClass:"mstrmojo.vi.ui.rw.UnitContainer",markupString:'<div id="{@id}" class="mstrmojo-UnitContainer {@cssClass}" style="{@cssText} {@domNodeCssText}" mstrAttach:mouseenter,mouseleave,mouseover,mouseout,mousemove,click,contextmenu><div class="mstrmojo-UnitContainer-titlebar" style="{@titlebarNodeCssText}"></div><div class="mstrmojo-UnitContainer-content"></div><div class="mstrmojo-VIDND-mask"></div></div>',markupSlots:{titlebarNode:function(){return this.domNode.firstChild;},containerNode:function(){return this.domNode.childNodes[1];},maskNode:function(){return this.domNode.lastChild;}},markupMethods:{onvisibleChange:mstrmojo.Widget.visibleMarkupMethod,ontopChange:mstrmojo.Widget.topMarkupMethod,onleftChange:mstrmojo.Widget.leftMarkupMethod,onzIndexChange:function(){this.domNode.style.zIndex=this.zIndex||Ak;},onenabledChange:function(){A3.toggleClass(this.domNode,"inactive",!this.enabled);},onorientationChange:function(){var BD=this.ctrlOverlay.domNode,BC=this.orientation;A3.toggleClass(BD,p,BC==="v");A3.toggleClass(BD,H,BC==="h");this.orientationHasChanged();},onghostImgCssChange:function(){var BD=this.ctrlOverlay.domNode,BC=this.ghostImgCss;A3.removeClass(BD,U);A3.addClass(BD,BC);}},layoutConfig:{h:{titlebarNode:"auto",containerNode:"100%"},w:{titlebarNode:"100%",containerNode:"100%"},xt:true},formatHandlers:{domNode:["B","BG"],titlebarNode:{src:"ttl",props:["F","BG","text-align"]}},updateOverlay:mstrmojo.emptyFn,getCacheKey:function AL(){return this._super()+"-vi-uc";},getPanelForAddAction:function Ap(){return"propertiesPanel";},getExcludedPanels:function A4(){return["editPanel"];},titleBarCss:"",orientation:"h",k:"",boxContent:null,parent:null,enabled:true,draggable:true,ctrlOverlay:null,model:null,title:"",titleBar:null,showTitleBar:false,bubbleMouseOver:true,dimensionsSet:false,getEditOverlayControls:mstrmojo.emptyFn,isNewUnitContainer:true,ghostImgCss:[],shouldShowCustomizeContextMenu:function(BC){var BD=BC.getTarget(),BE=BD&&BD.nodeName.toLowerCase();return BE&&!(BE==="textarea"||(BE==="input"&&BD.type.toLowerCase()==="text"));},switchToEditMode:function Av(){this.showControlOverlay(this.getEditOverlayControls());},init:function AW(BE){this._super(BE);var BH=this.id,BD=this.model,BG=this.boxContent,BC;BD.attachEventListener("viUnitSelected",BH,function(BI){this.toggleBoxSelection(BH===BI.id);});BD.attachEventListener("viIconTabClicked",BH,function(BJ){var BI=BD.hgl;if(BD.getSelectedViUnit()&&BJ.id!=="vi_flt"&&!BI){R.call(this,BH===BD.getSelectedViUnit().id,true,false);}});BD.attachEventListener("viVizEditorDrag",BH,function(BJ){var BI=BD.hgl;if(BD.getSelectedViUnit()&&BJ.id!=="vi_flt"&&!BI){R.call(this,BH===BD.getSelectedViUnit().id,false,!BJ.isIn);}});this.addChildren([this.getTitleBarCfg(),{scriptClass:"mstrmojo.Box",cssClass:AX,alias:"ctrlOverlay",slot:"containerNode",visible:false}],0);BC=this.titleBar;if(BC&&BC.tbToolbar){BC.tbToolbar.toolbarClicked=function(){BD.selectVIUnit(BH);};}this.menuBtnInfo={};this.showTitleBar=!!this.defn.httl;this.draggable=mstrApp.allowWebDashboardDesign();BG.attachEventListener("toggleCtrlOverlay",this.id,As);var BF=BG.edtModel;if(BF){BF.attachEventListener("BEMFormatChange",this.id,"updateGhostImgCss");}},getDocModel:function J(){return this.model;},getBoxBorderWidth:function Ao(){var BC=O.call(this),BD=BC&&BC.border;if(BD){var BE=[2,4];if(mstrApp.isSingleTier&&AQ.getOSInfo().name.toLowerCase().indexOf("mac")>=0||mstrApp.isExporting){BE=[2.66,5.34];}return BD.indexOf("2pt")>-1?BE[1]:BE[0];}return 0;},onFormat:function x(){var BC=this.boxContent;if(BC.execFormatHandler){BC.execFormatHandler();return ;}Aj.call(this);},showControlOverlay:function F(BE,BD){var BF=this.ctrlOverlay,BG=BF.domNode;if(BG){var BC=[AX];BC.push((this.orientation==="v")?p:H);BC=BC.concat(this.ghostImgCss);if(BD){BC.push(BD);}BG.className=BC.join(" ");}BF.set("visible",true);Az(BF);BF.addChildren(BE);},hideControlOverlay:function At(){var BC=this.ctrlOverlay;BC.set("visible",false);Az(BC);},editingTitleCallback:function G(BC){var BD=this.menuBtnInfo;A3.toggleClass(BD.btn,"editing-title",BC);},getTitleBarCfg:function AN(){return{scriptClass:"mstrmojo.vi.ui.rw.UnitContainerTitleBar",slot:"titlebarNode",alias:"titleBar",title:this.title,editTitleOnDoubleClick:mstrApp.allowWebDashboardDesign(),beganEditingTitlebar:function BE(){this.parent.editingTitleCallback(true);},titleEdited:function BC(){this.parent.editingTitleCallback(false);},close:function(){this.parent.deleteSelf();},getLayoutOffsets:function BD(){return{h:mstrApp.getThemeProps(mstrmojo.vi.enums.EnumThemeProperties.SUBTYPE.LAYOUT).ucTBLOHeight,w:0};}};},getDisplayName:function Ab(){return this.title;},updateDisplayName:function AJ(BF,BG,BC){var BD=this.model,BE=this.k;if(BC){BD.renameRWUnitTitle(BF,BG,BE,{success:function(BH){this.set("title",BH);}.bind(this),failure:function(BH){mstrmojo.err(BH);this.set("title",BG);}.bind(this)});}else{BD.renameRWUnit(BF,BG,BE,{success:function(){this.synchronizeEditors();}.bind(this)});}},ontitleChange:function BB(){this.titleBar.set("title",this.title);},oncontextmenu:function Ai(BC){if(mstrApp.isInVFInteractMode||(this.boxContent&&this.boxContent.isCustomSort)){AQ.preventDefault(window,BC.e);}else{if(this.shouldShowCustomizeContextMenu(BC)){var BD=this.addContextMenuItems(new mstrmojo.ui.menus.MenuConfig({position:AQ.getMousePosition(BC.e,BC.hWin),isHostedWithin:false}),BC);AQ.preventDefault(window,BC.e);if(BD.hasMenuItems()){this.openPopup(BD.newInstance());}}}BC.cancel();},addContextMenuItems:function e(BF,BC){var BE=this.getEditorModel(),BD;if(BE.getFormattingToolbar){BD=function(BG){var BH=BE.getFormattingToolbar(BG,BC.getTarget());if(BH){this.openPopup(BH);}}.bind(this);}if(!mstrApp.isInVFConfigMode){this.addFormatMenuItem(BF,BC,BD);}return BF;},addFormatMenuItem:function L(BE,BD,BC){if(!mstrApp.isAppStatePresentation()&&mstrApp.allowWebDashboardDesign()){BE.addMenuItem(mstrmojo.desc(1918,"Format"),"",function(){this.selectVIUnit();Aj.call(this,BD,BC);}.bind(this));}return BE;},getFormatMenuItemTarget:function u(BC){return mstrmojo.vi.models.editors.BaseEditorModel.TITLE_CONTAINER_VALUE;},applyBoxSize:function h(BC,BE,BH,BG){this._super(BC,BE,BH,BG);this.dimensionsSet=true;var BF=parseInt(BE,10),BI=parseInt(BC,10);var BD=BF>BI?"h":"v";if(BD!==this.orientation){this.set("orientation",BD);}this.set("ghostImgCss",A2.call(this,BF,BI));},childRenderCheck:function Aa(BD){var BC=this._super(BD);if(BD===this.boxContent){BC=BC&&this.dimensionsSet;}return BC;},postUpdateLayout:function AA(){var BE=this.boxContent;if(!this.domNode){return ;}if(!BE.hasRendered){BE.render();var BC=this.model.getLatestSelectedViUnitKey(),BD=BC&&this.parent.getUnitByKey(BC);if(BD){this.model.selectVIUnit(BD.id);}else{this.parent.selectFirstBox();}}else{this.updateVisFilterIndicator();BE.refresh(null,!mstrApp.isPartialUpdate);}this.isNewUnitContainer=false;},orientationHasChanged:mstrmojo.emptyFn,onRender:function Af(){this._super();var BC=this.model.getSelectedViUnit();this.toggleBoxSelection(BC&&BC.k===this.k);},onAppStateChange:function Ad(BD){var BH=mstrmojo.vi.VisualInsightApp.APP_STATES,BJ=BH.SELECTOR_TARGETING,BC=BH.PRESENTATION,BE=BH.PAUSE,BI=mstrApp.isAppStatePresentation(),BF=mstrApp.isAppStatePause();if(BI||BD.valueWas&BC){this.draggable=!(BI||mstrApp.isLayoutModePreview());this.generateToolbar();}if(BD.valueWas&BJ||mstrApp.isAppStateSelection()||BF||BD.valueWas&BE){this.generateToolbar();}var BG=this.model.getSelectedViUnit();this.toggleBoxSelection(BG&&BG.k===this.k);},onLayoutModeChange:function E(BC){var BD=mstrApp.isLayoutPreview(BC.value);if(BD||mstrApp.isLayoutPreview(BC.valueWas)){this.draggable=!(mstrApp.isAppStatePresentation()||BD);this.generateToolbar();}},selectVIUnit:function X(BC){var BD=this.parent;if(this.enabled&&BD&&BD.selectVIUnit&&!(mstrApp.isAppStateSelection()&&mstrApp.isLayoutModePreview())){this.toggleBoxSelection(this.parent.selectVIUnit(this,BC));}},synchronizeEditors:function AD(){if(this.model.getLatestSelectedViUnitKey()===this.k){this.selectVIUnit(true);}},addToggleTitleMenuItem:function P(BC){var BD=[Aq,A5];if(!this.showTitleBar){BD.reverse();}BC.addDualStateItem(this.id,BD[0],BD[1]);},canShowDesignMenuItems:function q(){return mstrApp.allowWebDashboardDesign();},updateToolbar:function n(BC){var BD=BC.ENUM_CORNERS,BE=this.boxContent,BG=BE&&BE.node,BF=BG&&(!BG.defn.vis||!BG.defn.vis.ve);BC.setAlignment(BD.BOTTOM_RIGHT,BD.TOP_RIGHT);BC.isHostedWithin=false;BC.showContextMenu=false;if(this.canShowDesignMenuItems()&&!mstrApp.isAppStatePresentation()){BC.addSeparator();if(!(mstrApp.isInVFConfigMode&&!BF)){this.addFormatMenuItem(BC);}if(this.showTitleBar){BC.addMenuItem(mstrmojo.desc(1388,"Rename"),"rnm",function(){this.draggable=false;this.titleBar.editTitle();}.bind(this));}if(undefined!==this.getEditOverlayControls()){BC.addMenuItem(mstrmojo.desc(3272,"Edit"),"cls",this.switchToEditMode.bind(this));}this.addDeleteMenuItem(BC);}return BC;},addDeleteMenuItem:function Am(BD){if(!mstrApp.isLayoutModePreview()&&!(mstrApp.isInVFConfigMode||mstrApp.isInVFInteractMode)){var BC=this.k,BE=this.model.id;BD.addMenuItem(mstrmojo.desc(629,"Delete"),"cls",function(){Ay(BE,BC).deleteSelf();});}return BD;},deleteSelf:function AU(BP){var BO,BH=this.k,BD=this.model,BN=BD.id,BR=BD.data,BL=Ay(BN,BH).parent,BM=BL.k,BQ=[BM],BC=[],BJ=function(BS){return BS.sections||BS.subsections||BS.objects||BS.panels||BS.layouts||BS.children;},BE=function(BV,BU){var BT=BJ(BV),BS;for(BS=0;BT&&(BS<BT.length);BS++){if((BT[BS]&&BT[BS].k)===BU){W.removeIndices(BT,BS,1);return ;}else{BE(BT[BS],BU);}}},BG=BD.getRebuildCallback(),BF=function(BW){var BU=Ay(BN,BH),BV=mstrmojo.all[BN],BX=BV.getCurrentLayoutDef(),BT=(BX&&BX.units)||{},BS=BT[BH];if(BU){if(BW){BU.defn._isDeleted=true;}else{delete BU.defn._isDeleted;}}if(BS){if(BW){BS._isDeleted=true;}else{delete BS._isDeleted;}}BV.syncLayerDefn(BH,BO,BW);};BC=BC.concat(BD.getSourceFilterKeys(BH,true));BC=BC.concat(BD.getTargetFilterKeys(this));this.model.execute({execute:function(){var BT=Ay(BN,BH);if(BT){var BS=BT.parent,BU=mstrmojo.all[BN],BX=BU.getDataService().newUpdate();var BV=BS.hasMultipleChildren();BX.addUpdate(BT.createDeleteUpdate());BO=BU.getMapLayerKeys(BT.boxContent);BX.addActions(BU.getDeleteMapLayersActions(BO));BX.addCallbacks({success:function BW(BY){BU.partialUpdate(BY.data,BU.getTargetDefn(BC),BY.defn,BC);BE(BR,BH);BU.deleteDataCache(BT.boxContent&&BT.boxContent.id);BT.defn._isDeleted=true;BU.syncLayerDefn(BH,BO,true);BT.destroy();}});BS.deleteBoxAndSubmitDeferred(BX,BT,null,true);if(!BV){BU.addVisualizationDeferred(BX,BS.k);}BS.selectFirstBox();BX.addCallbacks(BP);BX.addExtras({style:{params:{treesToRender:0}}});this.submitUpdate(BX);}},urInfo:{undo:function BK(){BF(false);},redo:function BI(){BF(true);},puKeys:BQ,extras:mstrmojo.DocDataService.REQUEST_DEFN_DATA,callback:BG}});},undoInsert:function Ah(){var BC=this.parent,BD=mstrmojo.all[this.model.id];BC.deleteBoxAndSubmitDeferred(BD.getDataService().newUpdate(),this,null,true);BC.selectFirstBox();this.destroy();},createDeleteUpdate:function v(){},getTitleBarVisibility:function V(){return this.titleBar&&this.showTitleBar;},setTitleBarVisibility:function r(BC){var BE=this.titleBar;BE.set("visible",BC);var BF=this.menuBtnInfo,BD=BF&&BF.btn;if(BF){if(!BF.menuCfg){BF.menuCfg=BE.getMenuConfig();}if(mstrApp&&mstrApp.isInVFInteractMode){BF.menuCfg=null;}if(!BD){BD=BF.btn=document.createElement("div");BD.className="hover-menu-btn";var BG=this.id;AQ.attachEvent(BD,"click",function(BJ){var BI=mstrmojo.all[BG],BH=BF.menuCfg;BH.hostId=BG;BH.hostElement=BD;BH.supportsScroll=true;BH.isHostedWithin=false;BH.maxHeight=AQ.getMaxScrollHeight();BI.openPopup(new mstrmojo.ui.menus.Menu({popupConfig:BH}));BJ.preventDefault();});}this.domNode.appendChild(BD);}t.call(this);this.doLayout();},refresh:function Ar(){delete this._currentLayout;if(!this.parent.boxLayoutConfig.dirty){this._super();}else{K.call(this,false,this.getFormats());if(this.showTitleBar){K.call(this,true,this.getFormats());}}},addFormatProps:function a(BD,BC){return BD;},onclick:function AP(BC){BC.e.justSwitched=this.k!==this.getDocModel().getLatestSelectedViUnitKey();this.selectVIUnit();if(!BC.e.ptvSelected&&this.switchPropertyOnClick(BC)){this.boxContent.edtModel.selectTargetByValue(mstrmojo.vi.models.editors.BaseEditorModel.TITLE_CONTAINER_VALUE);}},switchPropertyOnClick:function AV(){var BC=this.boxContent.edtModel;return !!(BC&&BC.selectTargetByValue);},getZonesModel:function Al(){return null;},getEditorModel:function A8(){return this.boxContent.edtModel;},onmouseenter:function AZ(){var BC=this.menuBtnInfo;if(BC&&BC.menuCfg){A3.addClass(BC.btn,AM);A3.removeClass(BC.btn,k);}},onmouseleave:function BA(){var BC=this.menuBtnInfo;if(BC&&BC.menuCfg){A3.addClass(BC.btn,k);A3.removeClass(BC.btn,AM);}},onmouseover:function I(BC){if(!mstrApp.isInteractive()){return ;}if(!this.bubbleMouseOver){BC.cancel();}var BD=this._panelTimeout;if(BD){window.clearTimeout(BD);delete this._panelTimeout;}if(this.titleBar.visible&&!mstrApp.isAppStateSelection()){this.titleBar.setToolbarVisibility(true);}},onmouseout:function AB(){var BC=this.id;this._panelTimeout=window.setTimeout(function(){var BD=mstrmojo.all[BC];if(BD){BD.titleBar.setToolbarVisibility(false);}},200);},menuDisplayCallback:function M(BD){var BC=this.menuBtnInfo;A3.toggleClass(BC.btn,AM,BD);A3.toggleClass(BC.btn,k,!BD);},onmousemove:function AO(){var BC=this,BD=BC.menuBtnInfo;if(BC.titleBar&&!BC.titleBar.visible&&BD&&BD.menuCfg){if(!!BC.mouseMovingTimer){clearTimeout(BC.mouseMovingTimer);clearTimeout(BC.menuDisplayTimeout);}BC.mouseMovingTimer=setTimeout(function(){clearTimeout(BC.menuDisplayDelay);BC.menuDisplayDelay=null;clearTimeout(BC.menuDisplayTimeout);BC.menuDisplayTimeout=setTimeout(function(){BC.menuDisplayCallback(false);},1500);},100);if(!BC.menuDisplayDelay){BC.menuDisplayDelay=setTimeout(function(){BC.menuDisplayCallback(true);},500);}}},isDragValid:function AK(BD){var BF=BD.src.node,BC=BF.tagName,BE=BF.className;BC=(BC&&BC.toLowerCase())||"";BE=(BE&&BE.toLowerCase())||"";if(BC==="input"||BC==="textarea"||BE.indexOf("hover-menu-btn")>-1||BE.indexOf("icn")>-1){return false;}return this.parent.hasMultipleChildren();},initializeDrag:function AF(){if(this._super()!==false){this.selectVIUnit();}},getTargetDropZone:function AE(BC){if(AS.call(this,BC)||AI.call(this,BC)){return"";}return this._super(BC);},allowDrop:function B(BC){var BE=BC.src,BD=BE&&BE.widget;if(BD&&BD===this){return false;}if(w.call(this,BC)&&this.allowDropFromFilter(BC)){return true;}if(AS.call(this,BC)&&this.allowDropFromDataset(BC)){return true;}if(AI.call(this,BC)&&this.allowDropFromAllObjectsBrowser(BC)){return true;}return this._super(BC);},allowDropFromFilter:function Ax(BC){var BE=BC&&BC.src,BD=BE&&BE.widget;return mstrApp.allowWebDashboardDesign()&&!(BD&&BD.isVisFilter());},allowDropFromDataset:function Ae(BC){return false;},allowDropFromAllObjectsBrowser:function Q(BC){return this.allowDropFromDataset(BC);},close:function(){this.parent.deleteBoxAndSubmit(this);this.parent.removeChildren(this);mstrApp.rootCtrl.generateToolbar();this.destroy();},createAvatar:function S(){this.domNode.style.zIndex="-1";var BC=document.createElement("div");BC.className=this.getAvatarCls().join(" ");BC.textContent=this.getDisplayName();return this.offsetAvatar(BC);},ondragend:function Y(BC){this.domNode.style.zIndex=Ak;this._super(BC);},wasDropped:function l(BC){this.domNode.style.zIndex=Ak;this._super(BC);},ondrop:function A(BC){var BE=w.call(this,BC),BD=this.maskNode.zone,BG,BK=this.getDocModel(),BJ=this;if(BE){BG=BC.src.widget.selector.node;}this._super(BC);if(AS.call(this,BC)){BK.selectVIUnit(this.id);this.dropFromDataset(BC);}if(AI.call(this,BC)){var BH=BC.src.widget,BF=BH&&BH.dataProvider;if(BF){BF.loadObjects(BC.getCtxtDragData().items,{success:function(){BJ.dropFromAllObjects(BC);}});}}if(BE){var BI=this;if(!BD){BD=this.parent.getPanelTargetEdge(BC);if(BD){BI=null;}}this.model.insertExistingFilter(BG,BI,BD);}},postDropBox:function Aw(){this.domNode.style.zIndex=Ak;},rebuildBoxContent:function AG(BC){var BE=this.boxContent,BD=this.parent;this.removeChildren(BE);BE.destroy();if(BC){BE=BD.builder.build([BC],this.model,{pk:BD.k})[0].boxContent;}else{BE=this.model.rebuildUnitFromDataCache(BE.id,BD.k,BD.builder).boxContent;}this.addChildren([BE]);},dropFromDataset:mstrmojo.emptyFn,dropFromAllObjects:mstrmojo.emptyFn,generateToolbar:function C(){var BC=this.titleBar,BD=BC.toolbarCfg,BE=this.menuBtnInfo;if(BE){if(BD){BD.destroy();}if(BE.menuCfg&&BE.menuCfg.destroy){BE.menuCfg.destroy();}if(mstrApp&&mstrApp.isInVFInteractMode||mstrApp.isAppStateSelection()){BE.menuCfg=null;}else{BC.set("toolbarCfg",this.updateToolbar(new mstrmojo.ui.menus.ToolbarConfig()));BE.menuCfg=BC.getMenuConfig();}}if(this.hasRendered){t.call(this);}},getTitleVisibilityFmts:function d(BC){return{FormattingView:{ShowTitleBar:BC}};},toggleTitleBar:function AR(BD){var BI=this.boxContent.id,BG=this.model,BH=function BH(BJ){var BL=mstrmojo.all[BI],BK=BL.parent;clearTimeout(BK.mouseMovingTimer);clearTimeout(BK.menuDisplayTimeout);clearTimeout(BK.menuDisplayDelay);BK.setTitleBarVisibility(BJ);BK.parent.selectVIUnit(BK,true);BK.applyBoxSize(BK.height,BK.width,BK.top,BK.left);BK.showTitleBar=BJ;BK.generateToolbar();BL.refresh(null,true);},BC=this.id;BH(BD);BG.controller.cmdMgr.execute({execute:function(){var BJ=mstrmojo.all[BI].parent;this.submit([BG.getUnitFormatAction(BJ,BJ.defn.t===mstrmojo.EnumRWUnitType.SELECTOR?5:1,BJ.getTitleVisibilityFmts(BD?1:0),true)],{success:function BL(){mstrmojo.all[BC].defn.httl=BD;},failure:function BK(){BH(!BD);}},mstrmojo.DocDataService.RAPID_EXEC);BH(BD);},urInfo:{silent:true,undo:function BE(){BH(!BD);},redo:function BF(){BH(BD);}}});},getFormats:function AT(){var BC=this.boxContent;if(BC){return BC.getFormats();}return null;},clearFormats:function N(){var BC=this.boxContent;if(BC&&BC.clearFormats){BC.clearFormats();}},preBuildRendering:function f(){var BC=this.boxContent;if(BC){BC.attachEventListener("regenerateToolbar",this.id,"generateToolbar");}this.generateToolbar();return this._super();},postBuildRendering:function A7(){var BC=this.showTitleBar;this.setTitleBarVisibility(BC);if((mstrApp.isAppStatePresentation&&mstrApp.isAppStatePresentation())||(mstrApp.isLayoutModePreview&&mstrApp.isLayoutModePreview())){this.draggable=false;}this._super();this.titleBar.setToolbarVisibility(false);this.applyBoxSize(this.height,this.width,this.top,this.left);return true;},changeUnitFormats:function A0(BF,BI,BM,BK,BE,BC,BG,BJ){var BH=function(BR){if(BG){BR=BG(BR);}m.updateFormatBlock(BF?BM.ttl:BM,BK,BR);var BP=this.parent?this:this.model.getSelectedViUnit();K.call(BP,BF,BM);var BQ=this.boxContent;if(!BQ.excludeData){if(!BF&&BQ.restylePlotly){BQ.restylePlotly(BM);}}if(BJ){BJ(BR);}BP.synchronizeEditors();if(BF&&BK===g.FONT_SIZE){BP.doLayout();BP.postUpdateLayout();}},BL=function(BP){this.model.updateDefnCache(BP.defn,[this.k]);this.clearFormats();BM=this.getFormats();},BN={success:BH.bind(this,BE)};var BO="none",BD=mstrmojo.DocDataService.SUPPRESS_DATA;if(BK===g.BORDER_STYLE&&BC===BO){BD=mstrmojo.DocDataService.REQUEST_ONLY_DEFINITION;BN=mstrmojo.func.wrapMethods({success:BL.bind(this)},BN);}this.model.saveUnitFormatProperty(this,[{formatType:BI,propertyName:BK,newValue:BE,oldValue:BC}],BN,BD,{silent:true,undo:BH.bind(this,BC),redo:BH.bind(this,BE)});},redraw:function AC(){if(this.boxContent.redraw()===true){return true;}return this._super();},getAvatarCls:function Ac(){return["mstrmojo-VIUnit-avatar","icn-avi",mstrApp.getThemeClassName()];},addDragHandle:function z(){var BC=document.createElement("div");BC.className="uc-drag-handle";this.domNode.appendChild(BC);},toggleDragHandleVisibility:function Au(BC){A3.toggleClass(this.domNode,"no-handler",!BC);},toggleBoxSelection:function AY(BD){if(mstrApp.isInVFInteractMode){return ;}var BE=mstrApp.isAppStatePresentation(),BC=mstrApp.isAppStatePrintPreview(),BF=this.domNode;A3.toggleClass(BF,"selected",BD&&!(BE||BC));},updateGhostImgCss:function o(BC){if(BC.propertyName===g.BACKGROUND_COLOR&&!BC.isTitle){var BD=this.ghostImgCss||[];BD=W.filter(BD,function(BE){return c.indexOf(BE)===-1;});BD=BD.concat(Ag(BC.value));this.set("ghostImgCss",BD);}}});}());(function(){mstrmojo.requiresCls("mstrmojo.Container","mstrmojo._HasLayout","mstrmojo.vi.ui._IsPanel","mstrmojo.dom","mstrmojo.css");var G=mstrmojo.dom;mstrmojo.vi.ui.PanelPortlet=mstrmojo.declare(mstrmojo.Container,[mstrmojo._HasLayout,mstrmojo.vi.ui._IsPanel],{scriptClass:"mstrmojo.vi.ui.PanelPortlet",init:function H(I){this._super(I);if(!!mstrApp.isWSStyling){this.paddingCfg={levelDiff:10,paddingLeft:8};}mstrmojo.css.addWidgetCssClass(this,"mstrmojo-VIPanelPortlet");this.markupMethods=mstrmojo.hash.copy(this.markupMethods,{onenabledChange:mstrmojo.Widget.enabledMarkupMethod});},layoutConfig:{h:{titlebarNode:"20px",containerNode:"100%"},w:{titlebarNode:"100%",containerNode:"100%"},xt:true},showTitleBarContextMenu:false,preOpenContextMenu:mstrmojo.emptyFn,canCollapse:true,level:null,onCollapsedChange:mstrmojo.emptyFn,panelId:"",ignoreLayout:true,paddingCfg:{levelDiff:13,paddingLeft:9},togglePortlet:function F(I){if(this.canCollapse){this.titleBar.set("isCollapsed",I);}},customizeTitleBarCfg:function A(I){return I;},getTitleBarCfg:function D(){var I=this._super(),J=this;I.canCollapse=this.canCollapse;I.cssClass="small";I.editTitleOnDoubleClick=false;if(this.showTitleBarContextMenu){I.oncontextmenu=function(K){G.preventDefault(window,K.e);var L=K.getTarget();if(G.contains(this.textNode,L,true,this.domNode)){K.cancel();this.tbToolbar.closePopup();var M=this.getMenuConfig();if(M){M.hostId=this.tbToolbar.id;M.hostElement=this.tbToolbar.domNode;M.position=G.getMousePosition(K.e,K.hWin);J.preOpenContextMenu();this.tbToolbar.openPopup(M.newInstance());M.position=null;}}};}I.onToggleCollapseByUI=function(){J.onCollapsedChange();};return this.customizeTitleBarCfg(I);},onRender:function E(){this._super();if(this.level!==null){this.titleBar.leftToolNode.style.paddingLeft=(this.paddingCfg.paddingLeft)+this.level*(this.paddingCfg.levelDiff)+"px";this.titleBar.doLayout();}},updateToolbar:function C(I){var K=this;this.addMenuItems(I);I.preShowMenu=function(){K.preOpenContextMenu();};var J=this.panelId;if(J){mstrmojo.all[J].addPopupHandlers(I);}return this._super(I);},addMenuItems:function B(I){},getLayoutOffsets:function(){var I=this.portletSrc;return(I&&I.scriptClass==="mstrmojo.gmaps.MapLayerZone")?{h:0,w:26}:{h:0,w:18};}});}());(function(){mstrmojo.requiresCls("mstrmojo.Container","mstrmojo._HasLayout","mstrmojo.vi.ui._IsPanel","mstrmojo._HasBuilder","mstrmojo._IsPanelStack","mstrmojo.vi.ui.rw._SavesChildPositions","mstrmojo.vi.ui.rw._IsPanelStack");mstrmojo.vi.ui.rw.DocVIPanelStack=mstrmojo.declare(mstrmojo.Container,[mstrmojo._HasLayout,mstrmojo.vi.ui._IsPanel,mstrmojo._HasBuilder,mstrmojo._IsPanelStack,mstrmojo.vi.ui.rw._IsPanelStack,mstrmojo.vi.ui.rw._SavesChildPositions],{scriptClass:"mstrmojo.vi.ui.rw.DocVIPanelStack",layoutConfig:{h:{titlebarNode:"0px",containerNode:"100%"},w:{titlebarNode:"100%",containerNode:"100%"},xt:true}});}());(function(){mstrmojo.requiresCls("mstrmojo.hash","mstrmojo.array","mstrmojo.css","mstrmojo.expr","mstrmojo.ValidationTextBox","mstrmojo.HBox","mstrmojo.ui.menus.EditorConfig","mstrmojo.mstr.EnumFunction","mstrmojo.DropDownList","mstrmojo.ui.Pulldown","mstrmojo.SearchablePulldown","mstrmojo.ButtonList","mstrmojo.Box","mstrmojo.Label","mstrmojo.RadioList","mstrmojo.CheckList","mstrmojo.EditableLabel","mstrmojo.CheckBox","mstrmojo._FormatDefinition","mstrmojo.num","mstrmojo.locales","mstrmojo.vi.models.VIComponentMap","mstrmojo.func","mstrmojo.dom","mstrmojo.ME.AttributeEditBox","mstrmojo.ME.MetricToken","mstrmojo.string","mstrmojo.dom","mstrmojo.models.datasets.DataInterface","mstrmojo.chart.model.enums.EnumDSSObjectType","mstrmojo.vi.ui.editors.ObjectPicker","mstrmojo.vi.ui.editors.AttributeLinkEditor","mstrmojo.vi.ui.NumberFormatter","mstrmojo.mstr.EnumDSSXMLBaseFormType","mstrmojo.mstr.EnumDSSXMLObjectTypes","mstrmojo.mstr.EnumDSSXMLObjectSubTypes","mstrmojo.mstr.EnumDSSConsolidationType");mstrmojo.requiresDescs(1442,1885,1886,2022,2122,2123,2124,2125,2126,2127,2128,2129,2130,2131,2132,3993,4564,11494,11495,11496,11497,14612);var r=mstrmojo.mstr.EnumFunction,a=mstrmojo.hash,w=mstrmojo.array,D=mstrmojo.css,Y=mstrmojo.dom,AA=mstrmojo.Button.newWebButton,V=mstrmojo.ME.MetricToken.brackets,AG=mstrmojo.ME.MetricToken.argDelimiter,W=mstrmojo._FormatDefinition,u=mstrmojo.models.datasets.DataInterface,K=mstrmojo.vi.models.VIComponentMap.TYPES,X=mstrmojo.chart.model.enums.EnumDSSObjectType,t=mstrmojo.mstr.EnumDSSXMLBaseFormType,AT=mstrmojo.mstr.EnumDSSXMLObjectTypes,N=mstrmojo.mstr.EnumDSSXMLObjectSubTypes,AE=mstrmojo.mstr.EnumDSSConsolidationType;var b={SUM:mstrmojo.desc(2131,"Sum"),ADD:mstrmojo.desc(6017,"Add"),AVG:mstrmojo.desc(2122,"Average"),MAX:mstrmojo.desc(2125,"Maximum"),GST:mstrmojo.desc(5869,"Greatest"),MIN:mstrmojo.desc(2127,"Minimum"),LST:mstrmojo.desc(5868,"Least"),CNT:mstrmojo.desc(2123,"Count"),MTP:mstrmojo.desc(5418,"Multiply"),STD:mstrmojo.desc(2130,"Standard Deviation"),PTD:mstrmojo.desc(11494,"Population Standard Deviation")},g={SUM:{n:b.SUM,t:r.FunctionSum},ADD:{n:b.ADD,t:r.FunctionPlus},AVG:{n:b.AVG,t:r.FunctionAvg},MAX:{n:b.MAX,t:r.FunctionMax},GST:{n:b.GST,t:r.FunctionGreatest},MIN:{n:b.MIN,t:r.FunctionMin},LST:{n:b.LST,t:r.FunctionLeast},TMS:{n:b.MTP,t:r.FunctionTimes},CNT:{n:b.CNT,t:r.FunctionCount},GEM:{n:mstrmojo.desc(2124,"Geometric Mean"),t:r.FunctionGeomean},MED:{n:mstrmojo.desc(2126,"Median"),t:r.FunctionMedian},MOD:{n:mstrmojo.desc(2128,"Mode"),t:r.FunctionMode},PDT:{n:mstrmojo.desc(2129,"Product"),t:r.FunctionProduct},STD:{n:mstrmojo.desc(2130,"Standard Deviation"),t:r.FunctionStdev},VAR:{n:mstrmojo.desc(2132,"Variance"),t:r.FunctionVar}},c=[{n:b.SUM,t:r.FunctionOLAPSum},{n:b.AVG,t:r.FunctionOLAPAvg},{n:b.MIN,t:r.FunctionOLAPMin},{n:b.MAX,t:r.FunctionOLAPMax},{n:b.CNT,t:r.FunctionOLAPCount}],AR=[{n:b.SUM,t:r.FunctionOLAPSum},{n:b.AVG,t:r.FunctionOLAPAvg},{n:b.MIN,t:r.FunctionOLAPMin},{n:b.MAX,t:r.FunctionOLAPMax},{n:b.CNT,t:r.FunctionOLAPCount}],M=[{n:mstrmojo.desc(1058,"Previous"),t:r.FunctionLag},{n:mstrmojo.desc(1059,"Next"),t:r.FunctionLead},{n:mstrmojo.desc(4046,"First"),t:r.FunctionFirst},{n:mstrmojo.desc(4049,"Last"),t:r.FunctionLast}];var AB={YEAR:"Year",QUARTER:"Quarter",CONCAT:"Concat",QUARTERSTARTDATE:"QuarterStartDate",MONTH:"Month",TOSTRING:"ToString",MONTHSTARTDATE:"MonthStartDate",WEEK:"Week",WEEKSTARTDATE:"WeekStartDate",DAYOFMONTH:"DayOfMonth",DAYOFWEEK:"DayOfWeek",DAYOFYEAR:"DayOfYear"};var AK={};AK[AB.YEAR]="6F7DF5F8449111D5BEA300B0D01A55EF";AK[AB.QUARTER]="6F7DF5F7449111D5BEA300B0D01A55EF";AK[AB.CONCAT]="6F7DF5FF449111D5BEA300B0D01A55EF";AK[AB.QUARTERSTARTDATE]="59E10CE2ADDD4A6DAC2416A72999A9ED";AK[AB.MONTH]="6F7DF5F6449111D5BEA300B0D01A55EF";AK[AB.TOSTRING]="D1ED29645DEC4DBF99E8E09ED939074B";AK[AB.MONTHSTARTDATE]="7C63D4E70B2741C3A5B54A2EFD40961B";AK[AB.WEEK]="6F7DF5F5449111D5BEA300B0D01A55EF";AK[AB.WEEKSTARTDATE]="44681336D0DB4E43AC333FFB3CC4400D";AK[AB.DAYOFMONTH]="6F7DF5F2449111D5BEA300B0D01A55EF";AK[AB.DAYOFWEEK]="6F7DF5F3449111D5BEA300B0D01A55EF";AK[AB.DAYOFYEAR]="6F7DF5F4449111D5BEA300B0D01A55EF";var Q="@form";function d(AV){var AX=8,AY=1,AU=w.find(AV.fs,"idf",true);if(AU===-1){return null;}var AW=AV.fs[AU];return((AV.da||AW.obf)&&(AW.bftp===AX||AW.bftp===AY))?AW:null;}var AQ={Year:{ID:[AB.YEAR,"(",Q,")"]},Quarter:{ID:[AB.YEAR,"(",Q,") * 10 + ",AB.QUARTER,"(",Q,")"],DESC:[AB.CONCAT,'("Q"',AG,AB.QUARTER,"(",Q,")",AG,' ", "',AG,AB.YEAR,"(",Q,"))"],DATE:[AB.QUARTERSTARTDATE,"(",Q,")"]},QuarterOfYear:{ID:[AB.QUARTER,"(",Q,")"],DESC:[AB.CONCAT,'("Q"',AG,"This@ID)"]},Month:{ID:[AB.YEAR,"(",Q,") * 100 + ",AB.MONTH,"(",Q,")"],DESC:[AB.TOSTRING,'<Pattern="mmm yyyy">(',Q,")"],DATE:[AB.MONTHSTARTDATE,"(",Q,")"]},MonthOfYear:{ID:[AB.MONTH,"(",Q,")"],DESC:[AB.TOSTRING,'<Pattern="mmmm">(',Q,")"]},Week:{ID:[AB.YEAR,"(",Q,") * 100 + ",AB.WEEK,"(",Q,")"],DESC:[AB.CONCAT,'("W"',AG,AB.WEEK,"(",Q,")",AG,' ", "',AG,AB.YEAR,"(",Q,"))"],DATE:[AB.WEEKSTARTDATE,"(",Q,")"]},WeekOfYear:{ID:[AB.WEEK,"(",Q,")"]},DayOfMonth:{ID:[AB.DAYOFMONTH,"(",Q,")"]},DayOfWeek:{ID:[AB.DAYOFWEEK,"(",Q,")"],DESC:[AB.TOSTRING,'<Pattern="ddd">(',Q,")"]},DayOfYear:{ID:[AB.DAYOFYEAR,"(",Q,")"]}};function k(AW,AY,AX,AU){return{scriptClass:"mstrmojo.ui.Pulldown",isHostedWithin:false,items:AW,selectedIndex:AY,onitemSelected:function AV(AZ){var Aa=this.parent;while(!Aa.data||!Aa.data[AX]){Aa=Aa.parent;}Aa.data.set(AX,AU?AU(AZ):AZ.v);}};}function AC(AW,AV,AU){return{scriptClass:"mstrmojo.Box",cssClass:"breakByBox",children:[{scriptClass:"mstrmojo.Label",text:mstrmojo.desc(13903,"Break by:"),cssClass:"menu-info-text"},a.copy(AU,k(AW,AV,"breakBy",function(AX){return{id:AX.did,type:AX.t,dmy:AX.dmy};}))]};}function AO(AX){var AY=AX.metrics,AZ=AX.propName,AW=AX.optionValueField||"id",AU=w.find(AY,AW,AX.value),Aa=function Aa(Ac){var Ab=this.parent;while(!Ab.data||!Ab.data.hasOwnProperty(AZ)){Ab=Ab.parent;}Ab.data.set(AZ,Ac?{id:Ac[AW],type:4}:{cst:this.text});};return{scriptClass:"mstrmojo.ui.SearchablePulldown",isHostedWithin:false,cssClass:"Calculation-PullDown",items:AY,selectedIndex:AU,useRichTooltip:true,bindings:AX.bindings,valid:true,allowCustomText:true,allowEmptyText:true,allowHTML:false,onvalidChange:function AV(){mstrmojo.css.toggleClass(this.domNode,"invalid",!this.valid);if(this.hasRendered){this.hideTooltip();this.showTooltip();}},updateTooltipConfig:function(){if(this.valid){this.richTooltip=null;return ;}this.richTooltip={posType:mstrmojo.tooltip.POS_BOTTOMLEFT,cssClass:"vi-warning vi-tooltip-C vi-calculation-warning",left:this.domNode.offsetWidth+12,top:this.domNode.offsetHeight+5,refNode:this.domNode,content:mstrmojo.desc(13819,"Invalid input")};},onitemSelected:Aa,onTextEditComplete:function(){Aa.call(this,this.items[this.selectedIndex]);},onPopupWidgetOpened:function(){this.set("valid",true);},postkeyup:AX.postkeyup};}function U(AX,AW,AV){if(AX&&AX.datap){var AU=w.filterOne(AX.datap,function(AZ){return AZ.tbid===AW;}),AY=AU&&AU.maps.amps;return w.filterOne(AY,function(AZ){return AV===AZ.aimp.atid;});}return null;}function n(AU,AY){var AW=w.filterOne(AU&&AU.afmps,function(AZ){return AZ.fmid===AY;}),AX=AW&&(AW.sqc?AW:AW.col.oi),AV;if(AX&&AX.sqc){AV={did:AX.sqc.id,n:mstrmojo.string.decodeHtmlString(AX.cln),coldtp:AX.sqc.dt.tp,georole:AX.geo,timerole:AX.tim,der:AX.sqc.der};}else{if(AX){AV={did:AX.did,n:mstrmojo.string.decodeHtmlString(AX.def.cln),coldtp:AX.def.dt.tp,georole:AW.geo,timerole:AX.def.dicl.time,der:AX.def.dicl.der};}}return AV;}function C(AW,AV,AY){var AX={success:function(AZ){if(AZ&&AZ.msgid){mstrApp.serverRequest({taskId:"qBuilder.GetReportXDADefinition",msgid:AZ.msgid,bindingflag:2,previewflag:261,browsetype:5},AY);}},failure:function(AZ){mstrApp.onerror(AZ);}};var AU=!!(mstrConfig.resolveOnly||mstrApp.isAppStatePause&&mstrApp.isAppStatePause());mstrApp.serverRequest({taskId:"duplicateReportInstance",datasetID:AV,messageID:AW,skipRebuild:AU},AX);}function I(AZ,Aa,AX){var AV=AZ.srcTableId,Ac=AZ.tgtTableId,AU,AY,AW=function(Ag,Af){var Ai="<mpcs><mpc ",Ae,Ah;for(Ae in Af){Ah=Af[Ae];Ai+='$ACT="$VAL" '.replace("$ACT",Ae).replace("$VAL",Ah);}Ai+="/></mpcs>";return{act:"changeEMMAMapping",tbid:Ag,dsid:AZ.dsid,mapping:Ai};},Ab=function(){var Ae=[],Ah={},Af,Ag;if(!AU||!AY){return ;}Ah[AV]={};Ah[Ac]={};w.forEach(AU.afmps,function(Al){var Aj=w.find(AY.afmps,"fmid",Al.fmid),Am,Ak,Ai;if(Aj>=0){Af=n(AU,Al.fmid);Ag=n(AY,Al.fmid);if(Af.georole!==Ag.georole){Ai=(Af.georole===0)?AV:Ac;Am=(Af.georole===0)?Af.did:Ag.did;Ak=Af.georole||Ag.georole;Ah[Ai][Am]=a.copy({did:Am,georole:Ak},Ah[Ai][Am]);}if(Af.timerole!==Ag.timerole){Ai=(Af.timerole===0)?AV:Ac;Am=(Af.timerole===0)?Af.did:Ag.did;Ak=Af.timerole||Ag.timerole;Ah[Ai][Am]=a.copy({did:Am,timerole:Ak},Ah[Ai][Am]);}if(Af.der!==Ag.der){Ak=Af.der|Ag.der;Ah[AV][Af.did]=a.copy({did:Af.did,drvflg:Ak},Ah[AV][Af.did]);Ah[Ac][Ag.did]=a.copy({did:Ag.did,drvflg:Ak},Ah[Ac][Ag.did]);}}});a.forEach(Ah,function(Ai,Aj){a.forEach(Ai,function(Ak){Ae.push(AW(Aj,Ak));});});Af=n(AU,AU.afmps[0].fmid);Ae.push(AW(AV,{did:Af.did,oid:AY.aimp.atid}));if(AX){AX(Ae);}},Ad=function(Ag){var Ah={success:function(){Ab();}},Af,Ae;AU=U(Ag,AV,AZ.srcId);AY=U(Ag,Ac,AZ.tgtId);Af=n(AU,AU.afmps[0].fmid);Ae=[AW(AV,{did:Af.did,oid:AY.aimp.atid,fg:1})];Aa.getDataService().submitUpdates(Ae,Ah);};C(Aa.mid,AZ.dsid,{success:Ad});}function Z(AZ,AW,AV,Aa){var AU=0,AY=[],AX=function(Ab){var Ac=AV[AU-1];if(Ab&&Ab.tks&&Ac){AY.push({fid:Ac.fid,fnm:Ac.fnm,ftk:Ab.tks.items});}if(AU===AV.length){Aa(AY);return ;}Ac=AV[AU++];mstrmojo.ME.MetricDataService.validateMetric({metricId:AW,formID:Ac.fid,objectType:12,tokenStreamXML:"",metricXML:"",msgID:AZ},{success:AX});};AX();}function AH(AU,AV){return{v:V(AU.n)+"@"+V(AV.fnm),tp:275,lv:1,exv:AV.fid,extp:8,oi:{did:AU.did,t:AU.t,n:AU.n}};}function H(AV){var AX=(AV.t===AT.Filter||AV.t===AT.Consolidation),AW=(AV.t===AT.Attribute&&AV.de),AU=(AV.t===AT.Consolidation&&AV.st===N.ConsolidationManaged);return !!(AX&&!AU||AW);}mstrmojo.vi.ui.DatasetUnitMenuUtils=mstrmojo.provide("mstrmojo.vi.ui.DatasetUnitMenuUtils",{getAvailableShortcutMetricFunctionsGroup:function AN(AU){return{"12":[[g.AVG,g.CNT,g.MAX,g.MIN,g.STD,g.SUM,g.VAR]],"4":[[g.SUM,g.AVG,g.MIN,g.MAX,g.CNT],[g.GEM,g.MED,g.MOD,g.PDT,g.STD,g.VAR]]}[AU.t];},isAmongFunctions:function B(AV,AU){return AU.some(function(AW){return AW.some(function(AX){return AX.t===AV;});});},getMultiSelectionShortcutMetricFunctions:function J(AU){var AV=true;w.forEach(AU,function(AW){if(4!==AW.t){AV=false;return false;}return true;});return AV?[g.ADD,g.AVG,g.GST,g.LST,g.TMS]:[];},getRelativeReferenceMenu:function f(AY,AW,Ab,AU){var AX=0,AV=M[AX],Aa=0,AZ=Ab&&Ab[Aa];return new mstrmojo.ui.menus.EditorConfig({data:{item:AY,relativeRef:AV,breakBy:AZ},cssClass:"RelativeReference-MenuEditor",contents:[{scriptClass:"mstrmojo.Box",cssClass:"funcBox",children:[{scriptClass:"mstrmojo.Label",visible:AW&&AW.length,text:AW,cssClass:"menu-info-text"},a.copy({cssClass:"RelativeReferencePullDown"},k(M,AX,"relativeRef",function(Ac){return Ac.t;}))]},AC(Ab,Aa,{cssClass:"RelativeReferencePullDown"})],fnOk:function(Ac){return AU(Ac.item,Ac.relativeRef,[Ac.breakBy]);}});},getMovingTotalMenu:function A(Ae,AY,Aa){var Af=1,AX=AR[Af].t,AZ=1,AV=mstrmojo.desc(13289,"Starting previous##rows").split("##"),Ad=0,AW=AY&&AY[Ad];return new mstrmojo.ui.menus.EditorConfig({cssClass:"MovingTotal-MenuEditor",data:{item:Ae,funcType:AX,windowSize:AZ,breakBy:AW},contents:[a.copy({cssClass:"MovingTotalPullDown"},k(AR,Af,"funcType",function(Ag){return Ag.t;})),{alias:"winSzBox",scriptClass:"mstrmojo.HBox",children:[{scriptClass:"mstrmojo.Label",cssClass:"WinSzPrefix menu-info-text",text:AV[0]},{alias:"winSz",scriptClass:"mstrmojo.ValidationTextBox",required:true,dtp:mstrmojo.expr.DTP.INTEGER,constraints:{trigger:mstrmojo.validation.TRIGGER.ALL,min:1},postCreate:function Ac(){this.set("value",AZ);},_ontooltipover:function(){var Ag=mstrmojo.all[this.id];Ag._hovered=true;Ag.showTooltip();},_ontooltipout:function(){var Ag=mstrmojo.all[this.id];Ag._hovered=false;Ag.hideTooltip();},useRichTooltip:true,tooltipOpenDelay:0,onInvalid:function(){var Ag=this.validationStatus.msg,Ah=!(this.richTooltip&&Ag===this.richTooltip.content);this.richTooltip={posType:mstrmojo.tooltip.POS_BOTTOMLEFT,cssClass:"vi-warning vi-tooltip-V",top:-5,refNode:this.domNode,content:Ag};if(this._hovered&&Ah){this.hideTooltip();this.showTooltip();}},onValid:function(){this.richTooltip=null;this.hideTooltip();},postvalueChange:function Ab(){var Ag=this.isValid();this.parent.parent.popupConfig.data.set("windowSize",Ag?parseInt(this.value,10):0);}},{scriptClass:"mstrmojo.Label",cssClass:"WinSzSuffix menu-info-text",text:AV[1]}]},AC(AY,Ad,{cssClass:"MovingTotalPullDown BreakByBox"})],bindings:{okEnabled:function(){return !!this.data.windowSize;}},fnOk:function AU(Ag){if(Aa){Aa(Ae,Ag.funcType,Ag.windowSize,[Ag.breakBy]);}}});},getRunningTotalMenu:function AM(AX,Aa,AV){var AW=0,AU=c[AW].t,AZ=0,AY=Aa&&Aa[AZ];return new mstrmojo.ui.menus.EditorConfig({data:{item:AX,func:AU,breakBy:AY},cssClass:"RunningTotal-MenuEditor",contents:[a.copy({cssClass:"RunningTotalPullDown"},k(c,AW,"func",function(Ab){return Ab.t;})),AC(Aa,AZ,{cssClass:"RunningTotalPullDown BreakByBox"})],fnOk:function(Ab){return AV(Ab.item,Ab.func,[Ab.breakBy]);}});},getRankMetricEditor:function AD(AY,Ab,AW){var AU=[{n:mstrmojo.desc(1886,"Descending"),v:"0"},{n:mstrmojo.desc(1885,"Ascending"),v:"-1"}],AV=0,AX=AU[AV].v,Aa=0,AZ=Ab&&Ab[Aa];return new mstrmojo.ui.menus.EditorConfig({data:{item:AY,order:AX,breakBy:AZ},cssClass:"NewRankMetric-MenuEditor",contents:[{scriptClass:"mstrmojo.Box",children:[{scriptClass:"mstrmojo.Label",text:mstrmojo.desc(14612,"Sort:"),cssClass:"menu-info-text"},a.copy({cssClass:"NewRankMetricPullDown"},k(AU,AV,"order"))]},AC(Ab,Aa,{cssClass:"NewRankMetricPullDown"})],fnOk:function(Ac){return AW(Ac.item,Ac.order,[Ac.breakBy]);}});},insertAddUnitToFilterMenu:function G(AZ,AV,AU){var AX=this,AW=mstrmojo.desc(2022,"Add to Filter"),AY=w.ensureArray(AU).filter(function(Aa){return AX.isValidAddToFP(AV,Aa);});if(AY.length>0){AZ.addMenuItem(AW,"",function(){AV.addFilterStackSelectors(AY);});}else{AZ.addDisabledMenuItem(AW,"");}},isValidAddToFP:function O(AV,Aa,Ac){var AW=AV.controller.view.builder,AY=AW.getLayoutVIMap(AV.getCurrentLayoutKey()),AZ=AY.getComponent(K.FILTER_STACK),Ab=true;if(!Ac){Ab=(!AZ||w.find(AZ.getFilterDefinitions(),"srcid",Aa.did)===-1);}if(Ab&&Aa.lock){var AX=Aa.fs||[],AU;Ab=false;for(AU=0;AU<AX.length;AU++){if(AX[AU].iidx){Ab=true;break;}}}return Ab;},renameItem:function v(AZ,Ac,AV,AX){var AY=AZ.mstrmojoId,Ab=mstrmojo.dom.findWidget(AZ);AX=AX||{};if(!AY){var Aa=mstrmojo.insert({scriptClass:"mstrmojo.EditableLabel",editOnClick:false,editOnTwoClicks:true,text:Ac.n,title:Ac.dsc||"",allowEmptyText:AX.allowEmptyText,allowTrimming:AX.allowTrimming||false,cssClass:AX.cssClass||"",placeholder:AZ,onTextEditComplete:function AU(Ad){if(Ad){return AV(this);}},onmousedown:function AW(Ad){if(this.isEditing){Ad.cancel();}}});if(Ab&&Ab.draggable){Aa.parent=Ab;}Aa.render();AY=Aa.id;}mstrmojo.all[AY].set("isEditing",true);return mstrmojo.all[AY];},getMultipleMetricsCalculationMenus:function m(Ab,AU,Ae){var Aa=new mstrmojo.ui.menus.MenuConfig(),Ag=mstrmojo.vi.ui.DatasetUnitMenuUtils.getMultiSelectionShortcutMetricFunctions(Ab),AY=function(Ai,Aj,Ah){return{dsid:AU,funcType:Aj,funcType2:Ah,items:Ai};};Aa.useTooltip=true;Ag.forEach(function(Ah){Aa.addMenuItem(Ah.n,"",function(){Ae(AY(Ab,Ah.t));});});if(Ab.length===2){var AZ=mstrmojo.mstr.EnumFunction,AX=AZ.FunctionDivide,AV=AZ.FunctionMinus,Ad=Ab[0],Ac=Ab[1],Af=function(Al,Aj,Ah,Ak,Ai){Aa.addMenuItem(Al,"",function(){Ae(AY([Aj,Ah],Ak,Ai));});},AW=[{n:function(Ai,Ah){return Ai.n+"/"+Ah.n;},fn:AX},{n:function(Ai,Ah){return Ai.n+"-"+Ah.n;},fn:AV},{n:function(Ai,Ah){return"("+Ai.n+"-"+Ah.n+")/"+Ah.n;},fn:AV,fn2:AX}];AW.forEach(function(Ah){Aa.addSeparator();Af(Ah.n(Ad,Ac),Ad,Ac,Ah.fn,Ah.fn2);Af(Ah.n(Ac,Ad),Ac,Ad,Ah.fn,Ah.fn2);});}return Aa;},getCalculationMetricEditor:function L(Ac,Ad,Ab){var AW=[{n:"",css:"operator-plus",funcType:r.FunctionPlus},{n:"",css:"operator-minus",funcType:r.FunctionMinus},{n:"",css:"operator-multiply",funcType:r.FunctionTimes},{n:"",css:"operator-divide",funcType:r.FunctionDivide},{n:!mstrApp.isWSStyling?"%":"",css:"operator-percent-diff",funcType:r.FunctionMinus,funcType2:r.FunctionDivide}],AX={m1:Ad.did,m2:Ac[0].did,operator:r.FunctionPlus,u1:{id:Ad.did,type:4},u2:null},AV=function(Ae){return{}.hasOwnProperty.call(Ae,"cst");},Aa=function(Ae){return typeof Ae==="string"&&!!Ae.length&&!isNaN(Number(Ae));};var AU="this.parent.popupConfig.valid || this.selectedIndex !== -1 || (!!this.selectedNode && this.selectedNode.innerHTML.length === 0)",AZ=function AZ(){var Ae=this.parent.popupConfig;if(Ae){Ae.set("okEnabled",this[this.editableSlot].innerHTML.length!==0);}};return new mstrmojo.ui.menus.EditorConfig({cssClass:"Calculation-MenuEditor",contents:[AO({metrics:Ac,value:AX.m1,propName:"u1",optionValueField:"did",bindings:{valid:AU},postkeyup:AZ}),{scriptClass:"mstrmojo.ButtonListHoriz",items:AW,selectedIndex:0,postselectionChange:function AY(){this.parent.data.set("operator",this.selectedItem.funcType);this.parent.data.set("operator2",this.selectedItem.funcType2);}},AO({metrics:Ac,value:null,propName:"u2",optionValueField:"did",bindings:{valid:AU},postkeyup:AZ})],data:AX,okEnabled:false,bindings:{valid:function(){var Ag=this.data.u1,Af=this.data.u2,Ah=this.data.operator;if(!Ag||!Af||!Ah){return false;}var Ae=!(AV(Ag)&&AV(Af))&&(!AV(Ag)||Aa(Ag.cst))&&(!AV(Af)||Aa(Af.cst));this.set("okEnabled",Ae);return Ae;}},fnOk:function(Ae){return Ab(Ae.u1,Ae.u2,Ae.operator,Ae.operator2);}});},getCfgForAddUnitFromAllObject:function(AU,AV){var AW=null,AX=null,AY=[],AZ=function(Aa,Ab){if(!Ab){return false;}return w.find((Ab.att||[]).concat(Ab.mx||[]),"did",Aa.did)>-1;};a.forEach(AV,function(Ab,Aa){if(Ab.idd){AW=Aa;AX=Ab;return false;}return true;});if(!AW){AW="$GUID_141";AY.push({act:"createDataset",mgo:true,prm:true,name:mstrApp.projectName,idd:true,newObjectIds:[AW]});}w.forEach(AU,function(Aa){if(!AZ(Aa,AX)){AY.push({act:"addUnitToDataset",dsid:AW,unitId:Aa.did,unitType:Aa.t});}});return{actions:AY,dsid:AW};},getAggregateByMenu:function q(AZ,AX){var AV=new mstrmojo.ui.menus.MenuConfig(),AW=function(Ad,Ac){var Af,Ae;if(Ac){var Ab=Ad.mexp.args[0];Af=Ab.did;Ae=Ab.t;}else{Af=Ad.did;Ae=Ad.t;}return{did:Af,t:Ae};},AU=this.getAvailableShortcutMetricFunctionsGroup(AZ),Aa=AZ.mexp?AZ.mexp.ft:null,AY=AZ.mexp&&this.isAmongFunctions(Aa,AU);AU.forEach(function(Ab,Ac){if(Ac!==0){AV.addSeparator();}Ab.forEach(function(Ad){AV.addMenuItem(Ad.n,"",function(){AX(AW(AZ,AY),Ad.t);});});});return AV;},showObjectPicker:function p(AV,AU){var AW="object_picker";return function(){var AX=mstrmojo.all[AW];if(!AX){AX=new mstrmojo.vi.ui.editors.ObjectPicker({id:AW});if(AU){AX.supportedTypes=w.hash(AU);AX.ob.browsableTypes="8,"+AU.join(",");}AX.render();}else{if(AU){AX.supportedTypes=w.hash(AU);AX.ob.browsableTypes="8,"+AU.join(",");}AX.browse();}AX.OKFn=AV||mstrmojo.emptyFn;AX.open();};},getObjectPicker:function p(){var AU="object_picker";return mstrmojo.all[AU];},generateNumberFormat:function z(AZ){var AU=W.DefaultFormat.FormattingNumber,AV=W.NumberFormatCategory,AX=AZ||{},AW=AX.nct,AY=AW===AV.General&&AX.nfs==="General";return{category:(AW===undefined||AY)?AV.Automatic:AW,decimalPlaces:AX.ndp===undefined?2:AX.ndp,thousandSeparator:AX.nth===undefined?parseInt(AU.ThousandSeparator,10):(AX.nth?-1:0),currencySymbol:AX.ncs||AU.CurrencySymbol,currencyPosition:AX.ncp||AU.CurrencyPosition,format:AX.nfs||"",negativeNumbers:AX.nnn||AU.NegativeNumbers};},getNumberFormatEditor:function AF(AX,AW,AV){var AU=this.generateNumberFormat(AW),AY=a.clone(AU),Aa=a.clone(AU);return new mstrmojo.ui.menus.EditorConfig({data:AY,bindings:{okEnabled:function(){return !(this.data.category===Aa.category&&this.data.format===Aa.format);}},cssClass:"NumberFormat-MenuEditor",contents:[{scriptClass:"mstrmojo.vi.ui.NumberFormatter",formatValue:AU,myData:AY,oldData:Aa,adjustAfterCategoryChange:function(){this.parent.adjustCornersForPopupOverflow();}}],fnOk:function AZ(Ab){if(!(Ab.category===Aa.category&&Ab.format===Aa.format)){return AV(Ab,Aa);}}});},getHighlightElementHandler:function(AW,AV,AU){return function(){D.toggleClass(AV,AU||"open",AW);};},getConfDataTypeMenuCfg:function AJ(AU,Ap,Ah,A3){var Ay="ToString",Ao="ToNumber",Am="ToDateTime",Ag="keepOriginal",AX="Default",Az={ToString:t.DssXmlBaseFormText,ToNumber:t.DssXmlBaseFormNumber,ToDateTime:t.DssXmlBaseFormDate},Ac={ToString:"D1ED29645DEC4DBF99E8E09ED939074B",ToNumber:"399C3EC1041643F1ACE8F2A92B1C1F2F",ToDateTime:"0A558C7295DE42DAA8C5594F1724563F"},Aa="_pattern",A1="_func",Ak="_bft",A6="_state",A4={UNCHANGED:0,TO_CREATE:1,TO_UPDATE:2},AZ={n:"Default",v:"Default"},Aw=[{n:"MM-DD-Year",v:"MM-DD-Year"},{n:"MM/DD/Year",v:"MM/DD/Year"},{n:"DD-MM-Year",v:"DD-MM-Year"},{n:"DD/mm/Year",v:"DD/mm/Year"},AZ],AW=[{n:mstrmojo.desc(13772,"Keep Original"),v:Ag},{n:mstrmojo.desc(12276,"String"),v:Ay},{n:mstrmojo.desc(2052,"Date"),v:Am},{n:mstrmojo.desc(3434,"Number"),v:Ao}];if(mstrApp&&mstrApp.showMultiDataType){AW=[{n:mstrmojo.desc(13772,"Keep Original"),v:Ag},{isSeparator:true,cls:"separator"},{n:mstrmojo.desc(3434,"Number"),v:Ao,bft:t.DssXmlBaseFormNumber},{n:mstrmojo.desc(9920,"Big Decimal"),v:Ao,bft:t.DssXmlBaseFormBigDecimal},{isSeparator:true,cls:"separator"},{n:mstrmojo.desc(2052,"Date"),v:Am,bft:t.DssXmlBaseFormDate},{n:mstrmojo.desc(9919,"DateTime"),v:Am,bft:t.DssXmlBaseFormDateTime},{n:mstrmojo.desc(2170,"Time"),v:Am,bft:t.DssXmlBaseFormTime},{isSeparator:true,cls:"separator"},{n:mstrmojo.desc(3544,"Text"),v:Ay,bft:t.DssXmlBaseFormText},{n:mstrmojo.desc(9921,"HTML Tag"),v:Ay,bft:t.DssXmlBaseFormHTMLTag},{n:mstrmojo.desc(8984,"Phone Number"),v:Ay,bft:t.DssXmlBaseFormPhoneNumber},{n:mstrmojo.desc(4530,"Symbol"),v:Ay,bft:t.DssXmlBaseFormSymbol},{n:mstrmojo.desc(9922,"URL"),v:Ay,bft:t.DssXmlBaseFormUrl},{n:mstrmojo.desc(4699,"Email"),v:Ay,bft:t.DssXmlBaseFormEmail}];}var Af=a.clone(AW).slice(1),An=Ap.fs.filter(function(A8){return Ap.da||A8.obf;}),A7=An.length>1,Aj=An.length>5,Ab=false,Ax=false,Aq=[],Av=[{scriptClass:"mstrmojo.Label",text:mstrmojo.desc(13773,"Select Data Type for New Attribute:"),cssClass:"menu-info-text menu-header-text"}],A5={okEnabled:false},A0=function(){var A8=false;An.forEach(function(A9){A8=A8||(A5[A9.fnm+A1+A6]!==A4.UNCHANGED)||(A5[A9.fnm+Aa+A6]!==A4.UNCHANGED);});return A8;},Ar=function(BA,A9){var A8=0;if(BA.da){w.forEach([Ay,Am,Ao],function(BD,BB){var BC=new RegExp("^\\s*"+BD+"\\s*(<.*>)?\\s*\\((.+)\\)\\s*$","i").exec(A9.f);if(BC&&BC[2]){A8=BB+1;return false;}});}return A8;},Au=function(BA,A9){var A8=0;if(BA.da){var BB=A9&&A9.bftp;w.forEach(AW,function(BD,BC){if(BD.bft===BB){A8=BC;return false;}});}return A8;},At=function(BA,A9){var BB=AX;if(Ap.da){var A8=new RegExp("^\\s*"+A9+'\\s*<\\s*Pattern\\s*=\\s*"(.+)"\\s*>.*$',"i").exec(BA.f);if(!mstrmojo.string.isEmpty(A8&&A8[1])){BB=A8[1];}}return BB;},As=function(){return Aj?this.parent.parent.parent:(A7?this.parent.parent:this.parent);},Al=function(A8){if(Aj){A8.formList.updateScrollbars();}},AY=function(BF,BG,BE){var A8=BG.fnm,BB=Aj?BF.formList[BG.fnm+Aa]:BF[BG.fnm+Aa],BC=A7?BB.children[1]:BB,BD=A5[A8+A1],BA=Ab&&(BD===Am||BD===Ay),A9=BB.visible!==BA;if(A9){BB.set("visible",BA);if(BA){Al(BF);}else{BC.hideTooltip();}}if(BE){BC.set("text",At(BG,BD));BC.set("items",BD===Am?Aw:[AZ]);}},Ai=function(A8){var A9=false;An.forEach(function(BA){if(A5[BA.fnm+A1]===Am||A5[BA.fnm+A1]===Ay){A9=true;return false;}});A8.advancedLabel.set("visible",A9);},AV=function(BA,A8,BB){return{scriptClass:"mstrmojo.ui.Pulldown",isHostedWithin:false,items:BA,alias:BB.fnm+A1,selectedIndex:A8,onPopupWidgetOpened:function(){Al(As.call(this));},onitemSelected:function A9(BG,BE){var BF=As.call(this),BH=BF.data,BI=BB.fnm,BD=BG.v,BC=function(BJ){if(BJ){return(BA.length===3?A4.TO_UPDATE:A4.TO_CREATE);}return A4.UNCHANGED;};BH.set(BI+A1,BD);BH.set(BI+Aa,At(BB,BD));BH.set(BI+Ak,BD===Ag?BB.bftp:(BG.bft?BG.bft:Az[BD]));BH.set(BI+A1+A6,BC(BE!==A8));BH.set("okEnabled",A0());AY(BF,BB,true);Ai(BF);}};},Ae=function(BA,BB,A8){return{scriptClass:"mstrmojo.ui.SearchablePulldown",isHostedWithin:false,alias:BA.fnm+Aa,useRichTooltip:true,visible:A8,allowCustomText:true,allowEmptyText:true,onPopupWidgetOpened:function(){Al(As.call(this));},customizeSearchResult:function(BC){if(w.find(BC,"v","Default")===-1&&this.items.length>0){BC.push(AZ);}},onclick:function(BC){mstrmojo.ui.SearchablePulldown.prototype.onclick.call(this,BC);this.set("isEditing",true);},updateData:function(BE){var BC=As.call(this),BD=BC.data,BF=BA.fnm;BD.set(BF+Aa,BE);BD.set(BF+Aa+A6,BB!==BE?A4.TO_UPDATE:A4.UNCHANGED);BD.set("okEnabled",A0());},onitemSelected:function A9(BC){if(BC){this.updateData(BC.v);}},onkeyup:function(BC){mstrmojo.ui.SearchablePulldown.prototype.onkeyup.call(this,BC);var BD=this[this.editableSlot],BE=BD.innerText||BD.textContent;this.updateData(BE);},updateTooltipConfig:function(BD){this.tooltipOpenDelay=BD?500:0;var BC=Y.position(this.domNode);this.richTooltip={content:mstrmojo.desc(14114,'Pattern determines the formatting for the resulting string of characters. You can use the custom numeric, date, and time formatting symbols. <br/> Example: if pattern is defined as "0,000.00" for "1001", it returns the string "1,001.00"'),posType:mstrmojo.tooltip.POS_TOPLEFT,cssClass:"vi-regular vi-tooltip-C",top:BC.y-2,left:BC.x+BC.w+10};}};},A2=function(BG,BF,A8,A9,BE){var BB=mstrApp&&mstrApp.showMultiDataType?Au(BG,BF):Ar(BG,BF),BD=At(BF,AW[BB].v),BA=BF.fnm,BC=AW;if(BB>0){BC=Af;BB--;}A9[BA+Aa]="";A9[BA+A1]="";A9[BA+Ak]="";A9[BA+A1+A6]=A9[BA+Aa+A6]=A4.UNCHANGED;if(BE){A8.push({scriptClass:"mstrmojo.HBox",cssClass:"func-input",alias:BA+A1,children:[{scriptClass:"mstrmojo.Label",text:BA,useRichTooltip:true,updateTooltipConfig:function(BJ){this.tooltipOpenDelay=BJ?500:0;var BI=this.domNode;var BH=Y.position(BI);if(BI.scrollWidth>BI.offsetWidth){this.richTooltip={content:BI.innerText,posType:mstrmojo.tooltip.POS_TOPLEFT,cssClass:"vi-regular vi-tooltip-V",top:BH.y-BH.h-10,left:BH.x-10};}}},a.copy({cssClass:"ConfDataTypePullDown MeContentPullDown HBOXPullDown"},AV(BC,BB,BF,true))]});A8.push({scriptClass:"mstrmojo.HBox",cssClass:"pattern-input",alias:BA+Aa,children:[{scriptClass:"mstrmojo.Label",text:mstrmojo.desc(12078,"Pattern"),cssClass:"menu-info-text"},a.copy({cssClass:"ConfDataTypePullDown MeContentPullDown HBOXPullDown"},Ae(BF,BD,true))]});}else{A8.push(a.copy({cssClass:"ConfDataTypePullDown MeContentPullDown"},AV(BC,BB,BF,false)));A8.push(a.copy({cssClass:"ConfDataTypePullDown MeContentPullDown"},Ae(BF,BD,false)));}};w.forEach(Ap.fs,function(A8){if(AU.als&&AU.als.links[Ap.did+" "+A8.fid]){Ax=true;return false;}});if(A7){An.forEach(function(A8){A2(Ap,A8,Aj?Aq:Av,A5,true);});}else{A2(Ap,An[0],Av,A5,false);}if(Aj){Av.push({scriptClass:"mstrmojo.ui.ScrollableContainer",alias:"formList",cssClass:"formList",children:Aq});}Av.push({scriptClass:"mstrmojo.Label",cssClass:"advancedLabel",alias:"advancedLabel",allowHTML:true,text:"<span>"+mstrmojo.desc(702,"Advanced")+"</span>",onclick:function(){var A9=this.parent,BA,A8,BB=true;Ab=!Ab;D.toggleClass(this.domNode,"expanded",Ab);An.forEach(function(BC){AY(A9,BC,false);BA=Aj?A9.formList[BC.fnm+Aa]:A9[BC.fnm+Aa];A8=A7?BA.children[1]:BA;if(BA.visible&&BB&&!Aj){BB=false;A8.showTooltip();}});}});return new mstrmojo.ui.menus.EditorConfig({data:A5,cssClass:"ConfDataType-MenuEditor",contents:Av,onOpen:function(){Al(this);},bindings:{okEnabled:"this.data.okEnabled"},fnOk:function Ad(BA){var A8=[],BC=[],A9=false,BB=function(BF,BG,BE){var BI=[],BH=function(BJ){var BK=BJ.ftk&&BJ.ftk.slice(2,-2);if(!BK){return null;}while((BK.shift()).v!=="("){}return BK;},BD=BH(BE)||[AH(Ap,BE)];BI.push({v:"!",tp:33,lv:4});if(BF!==Ag){BI.push({v:BF,oi:{did:Ac[BF],t:11,st:2816,n:BF}});if(!mstrmojo.string.isEmpty(BG)&&BG!==AX&&(BF===Am||BF===Ay)){BI.push({v:'<Pattern="'+BG+'">(',tp:"2",lv:1});}else{BI.push({v:"(",tp:"2",lv:1});}BI=BI.concat(BD);BI.push({v:")",tp:"2",lv:1});}else{BI=BI.concat(BD);}BI.push({v:"",tp:-1,lv:4});return mstrmojo.ME.AttributeEditBox.getTokenStreamXML({items:BI});};if(Ax){A9=true;}else{An.forEach(function(BD){if(BA[BD.fnm+A1+A6]===A4.TO_CREATE){A9=true;return false;}else{if(BA[BD.fnm+A1+A6]===A4.TO_UPDATE||(BA[BD.fnm+Aa+A6]===A4.TO_UPDATE&&(BA[BD.fnm+A1]===Am||BA[BD.fnm+A1]===Ay))){BC.push(BD);}}});}if(A9){An.forEach(function(BD){A8.push({n:BD.fnm,formula:BB(BA[BD.fnm+A1],BA[BD.fnm+Aa],BD),bft:BA[BD.fnm+Ak]});});A3(A9,A8);}else{if(Ap.da){Z(AU.mid,Ap.did,BC,function(BD){BD.forEach(function(BE){A8.push({did:BE.fid,formula:BB(BA[BE.fnm+A1],BA[BE.fnm+Aa],BE),bft:BA[BE.fnm+Ak]});});A3(A9,A8);});}}}});},getCreateTimeDAEditorCfg:function P(AX,AW){var AU=d(AX);if(!AU){return null;}return new mstrmojo.ui.menus.EditorConfig({data:{okEnabled:false},cssClass:"CreateTimeAttribute-MenuEditor",contents:[{scriptClass:"mstrmojo.ui.CheckList",alias:"time_type",items:[{n:mstrmojo.desc(873,"Year"),v:"Year"},{n:mstrmojo.desc(10051,"Quarter of Year"),v:"QuarterOfYear"},{n:mstrmojo.desc(10050,"Quarter"),v:"Quarter"},{n:mstrmojo.desc(10049,"Month of Year"),v:"MonthOfYear"},{n:mstrmojo.desc(871,"Month"),v:"Month"},{n:mstrmojo.desc(10047,"Week of Year"),v:"WeekOfYear"},{n:mstrmojo.desc(10048,"Week"),v:"Week"},{n:mstrmojo.desc(11608,"Day of Year"),v:"DayOfYear"},{n:mstrmojo.desc(10046,"Day of Month"),v:"DayOfMonth"},{n:mstrmojo.desc(10045,"Day of Week"),v:"DayOfWeek"}],onchange:function AV(){var AZ=false;a.forEach(this.selectedIndices,function(Aa){if(Aa){AZ=true;return false;}});this.parent.data.set("okEnabled",AZ);}}],bindings:{okEnabled:function(){return this.data.okEnabled;}},fnOk:function AY(Ad,Ab){var Ac=Ab.time_type,Ag=Ac.selectedIndices,Aa=Ac.items,Af=[],AZ=[],Ae=function(Ah,Aj,Al){var Ak=[{v:"!",tp:33,lv:4}],Ai;Al.forEach(function(Am){if(Am===Q){Ak.push(AH(Ah,Aj));}else{Ai=AK[Am];if(Ai){Ak.push({v:Ai,oi:{did:Ai,t:11,st:2816,n:Ai}});}else{Ak.push({v:Am,tp:"2",lv:1});}}});Ak.push({v:"",tp:-1,lv:4});return mstrmojo.ME.AttributeEditBox.getTokenStreamXML({items:Ak});};a.forEach(Ag,function(Ah,Ai){if(Ah){AZ=[];a.forEach(AQ[Aa[Ai].v],function(Aj,Ak){AZ.push({n:Ak,formula:Ae(AX,AU,Aj),bft:(Ak==="DATE"?8:0)});});Af.push({isTokenStream:true,forms:AZ,name:AX.n+" ("+Aa[Ai].n+")"});}});return AW(Af);}});},RefreshAndCloseAllObjectBrowserCallback:function(AV,AU){return mstrmojo.func.wrapMethods(AU.getDatasetsUpdateCallback(),{success:function(){if(w.find(AV,"act","createDataset")!==-1){AU.controller.datasetsPanel.set("allObjectBrowserOpened",false);}}});},getUnitFromDataset:function e(AV,AX,AU){var AW=null;a.forEach(AV,function(AZ){var AY=AZ.att||[];if(AU===4){AY=AZ.mx||[];}w.forEach(AY,function(Aa){if(Aa.did===AX){AW=Aa;return false;}});if(AW){return false;}});return AW;},getDatasetFromId:function R(AU,AV){var AW=null;a.forEach(AU,function(AX){if(AX.did===AV){AW=AX;return false;}});return AW;},getDatasetFromAttributeId:function R(AU,AV){var AW=null;a.forEach(AU,function(AX){if(w.find(AX.att,"did",AV)>=0){AW=AX;return false;}});return AW;},getSortedDatasetUnits:function E(AU){var AV=function AV(AW){return AW.t===X.DssTypeMetric?2:1;};AU=AU.concat();AU.sort(function(AZ,AX){if(!AZ||!AX){return true;}var Aa=AV(AZ)-AV(AX),AY=AZ.n.toUpperCase(),AW=AX.n.toUpperCase();return Aa!==0?Aa:(AY!==AW?AY.localeCompare(AW):AZ.n.localeCompare(AX.n));});return AU;},isGeoAttr:function AL(AU,AV){return !!(AU.fs&&(AU.fs instanceof Array)&&AU.fs.length&&AU.fs.some(function(AW){return AW.fgr>0&&(!AV||(AV&&AW.obf));}));},isTimeAttr:function h(AU){return !!(AU.fs&&d(AU));},getUnitCssClass:function(AV){var AU=AV.t;if(this.isGeoAttr(AV,AV.useAvailGeoFmsOnly)){AU+="g";}else{if((AV.dm||AV.um)||AV.da){AU+="d";}else{if(AV.de){AU+="de";}else{if(this.isTimeAttr(AV)){AU+="t";}}}}if((AV.t===AT.Consolidation&&AV.st===N.ConsolidationManaged)||(AV.t===AT.Attribute&&AV.st&&AV.st===N.AttributeRecursive)){AU+=(" st"+AV.st);}if(AV.t===AT.Consolidation&&AV.st===N.ConsolidationManaged&&AV.ndetype===AE.DssRecursiveDerivedElement){AU+=" nde4ra";}return"ic"+AU;},hasMultiForms:function o(AV,AU){return u.getFormsByAttrId(AV,AU).length>1;},getDisplayFormsMenu:function F(Aj,Ah,Ab,Ag){var Af=[],Ai=[],AY=[],Ad=[{n:mstrmojo.desc(2411,"Off"),v:0},{n:mstrmojo.desc(2410,"On"),v:1},{n:mstrmojo.desc(8504,"Form Name Only"),v:2},{n:mstrmojo.desc(8505,"Show Attribute Name Once"),v:3},{n:mstrmojo.desc(4531,"Automatic"),v:4}];var Ac=Ah.model.data,AU=Ac.gts,Ae;var AX=Aj.t===AT.Consolidation&&Aj.st===N.ConsolidationManaged;w.forEach((AU.row||[]).concat(AU.col||[]),function(Ak){if(Ak.id===Aj.did){Ai=Ai.concat(Ak.fs);}});Ae=u.getFormsByAttrId(Aj.attId||Aj.did,Ab);w.forEach(Ae||[],function(Al){var Am=Al.fid;if(w.find(Af,"id",Am)<0){Af.push({id:Am,n:Al.fnm});var Ak=w.find(Ai,"id",Am);if(Ak>-1){AY[Af.length-1]=true;}}});var AZ=[{alias:"fs",scriptClass:"mstrmojo.ui.CheckList",minimumSelectCnt:1,items:Af,selectedIndices:AY},{scriptClass:"mstrmojo.Label",text:mstrmojo.desc(11918,"Display attribute form names:"),cssClass:"menu-info-text"},{alias:"longNames",scriptClass:"mstrmojo.ui.Pulldown",items:Ad,isHostedWithin:false,selectedIndex:w.find(Ad,"v",Ac.lnm||0),onitemSelected:function AV(Ak){this.v=String(Ak.v);}}];if(Ah.getChartStyle&&Ah.getChartStyle()==="NewGraphMatrixVisualizationStyle"){AZ.splice(-2,2);}if(AX){AZ.splice(-2,2);}return new mstrmojo.ui.menus.EditorConfig({cssClass:"displayForms",data:{item:Aj,oldSelected:a.copy(AY,{})},contents:AZ,okBtnText:mstrmojo.desc(1442,"Ok"),fnOk:function AW(Ap,At){var Ao=At.fs,Am=Ao.selectedIndices,Ar=Ao.items,Ax=[],Aq=[],Au=[];if(!Ao.getSelectedItems().length){mstrmojo.alert("Please select at least one form!");return ;}var Al=Ap.oldSelected,Aw=Am,An,As={},Av={};for(An=0;An<Ar.length;An++){if(Al[An]&&!Aw[An]){As[An]=true;}else{if(!Al[An]&&Aw[An]){Av[An]=true;}}}a.forEach(As,function(Ay,Az){if(Ay){Aq.push({act:"removeForm",unitId:Aj.did,unitType:Aj.t,attFormId:Ar[Az].id});}});var Ak=Ah.model.data.gts;(Ak.row||[]).concat(Ak.col||[]).forEach(function(Ay){if(Ay.id===Aj.did){(Ay.fs||[]).forEach(function(Az){if(w.find(Af,"id",Az.id)<0){Aq.push({act:"removeForm",unitId:Aj.did,unitType:Aj.t,attFormId:Az.id});}});}});a.forEach(Av,function(Ay,Az){if(Ay){Ax.push({act:"addForm",unitId:Aj.did,unitType:Aj.t,attFormId:Ar[Az].id,unitPos:0});}});Au.push({act:"putProperties",prs:"Template Formatting",pr:"LongNames",v:At.longNames?At.longNames.v:0});if(Ag){Ag([{act:"updateTemplate",keyContext:Ah.k,partialRetrieval:{nodes:[Ah.k]},actions:Aq.concat(Ax).concat(Au)}]);}},onOpen:function Aa(){this.fs.updateScrollbars();}});},getAttributeLinkMenu:function j(Ag,Aj,Ae,Ai,AZ){var Ak=-2147483648,Ab=Ai.datasets,Ac=Ab[Ae],Ah=Ac.tables||[],AU={},Ad=[],AX=(Aj.fs&&Aj.fs[0])||{},Af=[],Aa=779,AW=Aj.art>1,AV=!AW&&a.keyarray(Ab).length>1,AY=function(){mstrmojo.vi.ui.editors.AttributeLinkEditor.open({attribute:Aj,docModel:Ai,datasetId:Ae});};if((Ac.st!==Aa)||Ah.length<=1||Aj.da){if(AV){Ag.addMenuItem(mstrmojo.desc(11941,"Link to Other Dataset..."),"",AY);}return ;}w.forEach(Ac.att,function(An){var Ao=true,Am=null,Al=(An.fs&&An.fs[0])||{};if(An.da){return ;}if(AX.der===Ak||Al.der===Ak||AX.fgr===-1||Al.fgr===-1||AX.ftr===-1||Al.ftr===-1){return ;}if(AX.fgr&&Al.fgr&&AX.fgr!==Al.fgr){return ;}if(AX.ftr&&Al.ftr&&AX.ftr!==Al.ftr){return ;}w.forEach(Ah,function(Ap){var Aq=w.find(Ap.attRefs,"did",Aj.did),Ar=w.find(Ap.attRefs,"did",An.did);if(Aq>=0&&w.indexOf(Ad,Ap.did)<0){Ad.push(Ap.did);}if(Ar>=0){Am=Ap.did;}if(Aq>=0&&Ar>=0){Ao=false;}});if(Ao&&!An.hide){AU[An.did]=Am;Af.push(An);}});if(Af.length>0&&Ac.hcs!==true&&!Ai.isSparkDataset(Ac)){Ag.addEditorMenuItem(mstrmojo.desc(13172,"Map Attributes"),"",function(){return new mstrmojo.ui.menus.EditorConfig({data:{},cssClass:"mapAttribute",okVisible:false,cancelVisible:false,contents:[{scriptClass:"mstrmojo.ui.ScrollableContainer",children:[{scriptClass:"mstrmojo.vi.ui.InteractiveUnitList",draggable:false,CLS_HAS_MENU:"",items:Af,listHooks:{select:function Al(Am,An){Ai.warnForEditStandaloneDS(Ac,function(){w.forEach(Ad,function(Ao){I({dsid:Ae,srcId:Aj.did,srcTableId:Ao,tgtId:An.did,tgtTableId:AU[An.did]},Ai,AZ);});});}}}]}]});});}if(AV){Ag.addMenuItem(mstrmojo.desc(11941,"Link to Other Dataset..."),"",AY);}},isDocumentLevelItem:function x(AU){return AU&&(AU.um||AU.da||(AU.t===AT.Consolidation&&AU.st===N.ConsolidationManaged));},isLegalObjectName:function S(AU){var AV=/["\[\]\\]/g;if(AU.match(AV)){return false;}return true;},validateName:function l(AV,AW,AU){if(this.isLegalObjectName(AV)){AW();}else{mstrmojo.alert(mstrmojo.desc(8622,"The # cannot contain the reserved characters ##.").replace("##","'[', ']', '\"' and '\\'").replace("#",mstrmojo.desc(945,"Name")),AU,mstrmojo.desc(1388,"Rename"));}},hasCGorCon:function AS(AU){return AU.att.some(function(AV){return H(AV);});},isCGorCon:function AI(AU,AW){var AV=w.filterOne(AW&&AW.att,function(AX){return AX.did===AU.did;});return H(AV||AU);},hasOldDEOverDatasets:function(AX,AW){var AV=false,AU;a.forEach(AW,function(AY){AU=w.find((AY.att||[]),"did",AX);if(AU!==-1&&AY.att[AU].de){AV=true;return false;}});return AV;},getMarkGeoRoleEditorCfg:function AP(AU,A6,Ao,Al,BF,BH){var Ak=268435456,BC=536870912,AZ=1073741824,Ay=268435456,A9=805306368,A4=805306368,As=1879048192,BG=-2147483648,A7=0,A8=1,Ab=2,Aj=3,An=4,Ah=5,BE=6,Ae=7,Aq=8,Ap=9,A0=10,AX=2,Ax=3,A5={v:A7,n:mstrmojo.desc(2057,"None")},BI={v:Aj,n:mstrmojo.desc(7674,"Country"),der:Ak},A3={v:Ab,n:mstrmojo.desc(7676,"State"),parents:[BI],der:BC},Af={v:Ap,n:mstrmojo.desc(12919,"County"),parents:[BI,A3]},BA={v:A8,n:mstrmojo.desc(7675,"City"),parents:[BI,A3],der:AZ},At={v:Aq,n:mstrmojo.desc(7677,"Zip Code"),parents:[BI,A3,BA]},Am={v:Ah,n:mstrmojo.desc(7696,"Latitude")},A1={v:BE,n:mstrmojo.desc(7697,"Longitude")},Ai={v:An,n:mstrmojo.desc(7675,"City")+", "+mstrmojo.desc(7676,"State")},Aw={v:A0,n:mstrmojo.desc(12973,"Area Code")},Az={v:Ae,n:mstrmojo.desc(2056,"Custom")},Ag={ID:[A5,BI,A3,Af,BA,At,Am,A1,Ai,Aw,Az],ID_NUMERIC:[A5,At,Aw,Am,A1],NON_ID:[A5,BI,A3,Af,BA,At,Ai,Aw,Az],NON_ID_NUMERIC:[A5,At,Aw]},Au=w.filter(A6.fs,function(BJ){return(BJ.bftp===AX||BJ.bftp===Ax)&&BJ.der!==BG;});var A2=(Au.length>1),AW=w.find(Au,"idf",true),AY=(AW===-1?0:AW),Av=Au[AY],Ad,AV,Ar,Aa=[],Ac=function(BJ){var BK=(BJ.idf?"ID":"NON_ID")+(BJ.bftp===AX?"_NUMERIC":"");return Ag[BK];},BD=function(BK,BJ){return w.find(Ac(BJ),"v",BK);};if(Au.length===0||w.find(A6.fs,"fgr",-1)!==-1||Av.der===BG){return null;}w.forEach(Au,function(BL,BJ){var BK=a.clone(BL);BK.n=BK.fnm;Aa.push(BK);if(BL.fgr){Av=BK;AY=BJ;}});Ad=Av.fid;Ar=Av.fgr||0;AV=BD(Ar,Av);return new mstrmojo.ui.menus.EditorConfig({data:{item:A6,geoForm:Av,geoRole:Ar},cssClass:"MarkGeoRole-MenuEditor",contents:[{scriptClass:"mstrmojo.Label",text:mstrmojo.desc(13522,"Select Attribute Form:"),visible:A2},{scriptClass:"mstrmojo.ui.Pulldown",isHostedWithin:false,cssClass:"MarkGeoRolePullDown",items:Aa,selectedIndex:AY,alias:"formList",visible:A2,onitemSelected:function BB(BL){var BJ=this.parent.data,BK=this.parent.geoRoleList;if(BJ.geoForm.fid!==BL.fid){BJ.set("geoForm",BL);BJ.set("geoRole",BL.fgr);BK.set("items",Ac(BL));BK.set("selectedIndex",BD(BL.fgr,BL));}}},{scriptClass:"mstrmojo.ToolSeparator",visible:A2,markupMethods:{onvisibleChange:mstrmojo.Widget.visibleMarkupMethod}},{scriptClass:"mstrmojo.Label",text:mstrmojo.desc(13523,"Select Geographic Type:"),cssClass:"menu-info-text"},{scriptClass:"mstrmojo.ui.Pulldown",isHostedWithin:false,cssClass:"MarkGeoRolePullDown",items:Ac(Av),selectedIndex:AV,alias:"geoRoleList",onitemSelected:function BB(BP){var BO=this.parent,BJ=BO.data,BQ=BO.geoDrvList;var BL=[],BN=[],BK=Av.der,BM;BJ.set("geoRole",BP.v);w.forEach(BP.parents,function(BR,BS){BM=BR;BL.push({n:BM.n,der:BM.der});if((BK&BM.der)!==0){BN[BS]=true;}});BQ.set("items",BL);BQ.set("selectedIndices",BN);w.forEach(["geoDrvSeparator","geoDrvLabel","geoDrvList"],function(BR){BO[BR].set("visible",BL.length>0);});if(BO.adjustCornersForPopupOverflow){BO.adjustCornersForPopupOverflow();}}},{scriptClass:"mstrmojo.ToolSeparator",markupMethods:{onvisibleChange:mstrmojo.Widget.visibleMarkupMethod},alias:"geoDrvSeparator"},{scriptClass:"mstrmojo.Label",text:mstrmojo.desc(13524,"(Optional) Create Additional Attributes:"),alias:"geoDrvLabel",cssClass:"menu-info-text"},{scriptClass:"mstrmojo.ui.CheckList",alias:"geoDrvList"}],fnOk:function(BO,BN){var BK=function(BV){var BU=function(BZ){var Ba="<mpcs>";w.forEach(BZ,function(Bb){Ba+='<mpc did="'+Bb.did+'" n="'+Bb.n+'" georole="'+Bb.georole+'" drvflg="'+Bb.drvflg+'" />';});Ba+="</mpcs>";return Ba;},BQ=function(BZ,Bb,Bd,Ba){var Bc=function(Bh,Be,Bg){var Bf=U(BV,Bh,Be),Bi=n(Bf,Bg);return Bi&&Bi.did;};BF.forEach(function(Be,Bf){var Bg=Bc(Be.did,A6.did,Bb.fid);if(Bg){BZ[Bf]=BZ[Bf]||[];BZ[Bf].push({did:Bg,n:Bb.fnm,georole:Bd,drvflg:Ba});}});},BS=[],BY=[],BW=BN.geoDrvList,BR=0,BT=false,BX={2:Ay,1:A9,9:A4,8:As}[BO.geoRole]||0;a.forEach(BW.selectedIndices,function(Ba,BZ){if(Ba){BR|=BW.items[BZ].der;}});BR&=BX;if(Av.fgr!==BO.geoRole||Av.fid!==BO.geoForm.fid||Av.der!==BR){if(A2&&Av.fid!==BO.geoForm.fid){if(Av.fgr!==A7){BQ(BY,Av,A7,0);if(Av.der>0){BT=true;}}}if(BO.geoForm.fgr!==BO.geoRole||BO.geoForm.der!==BR){BQ(BY,BO.geoForm,BO.geoRole,BR);if((BR&BO.geoForm.der)!==BO.geoForm.der){BT=true;}}if(BY.length>0){BY.forEach(function(Ba,BZ){BS.push({act:"changeEMMAMapping",dsid:Ao,tbid:BF[BZ].did,mapping:BU(Ba)});});BH(BS,BT);}}},BL=function(){C(AU.mid,Ao,{success:BK});};var BM=mstrApp.isAppStatePause();if(!Al||BM){var BP,BJ=BM?mstrmojo.desc(212,"Continue"):mstrmojo.desc(219,"Yes");if(Al){BP=mstrmojo.desc(16237,"The operation requires the dataset to be unloaded from memory. It will be automatically reloaded when you resume data retrieval. Do you want to continue?");}else{BP=BM?mstrmojo.desc(16236,"The operation requires modifying the dataset and unloading it from memory. It will be automatically reloaded when you resume data retrieval, however the change will also affect other reports, documents, and dossiers that share the dataset. Do you want to continue?"):mstrmojo.desc(15493,"Modifications to this dataset will affect other reports, documents, and dossiers that share the dataset. Do you want to continue?");}mstrmojo.warn(BP,{},{buttons:[AA(BJ,function(){BL();},true,{cssText:"min-Width: 60px"}),AA(mstrmojo.desc(221,"Cancel"),function(){})]});}else{BL();}}});}});}());(function(){mstrmojo.requiresCls("mstrmojo.hash","mstrmojo.date","mstrmojo.dom","mstrmojo.NumberFormat","mstrmojo.Button","mstrmojo.Serializer","mstrmojo.vi.ui.editors.PromptOptionEditor","mstrmojo.vi.ui.editors.ExportPDFEditor","mstrmojo.vi.enums.EnumFeatures","mstrmojo.vi.util.NavUtility");var A=mstrmojo.desc,AU=mstrmojo.css,D=mstrmojo.Button.newWebButton,AF=mstrmojo.Serializer,AK=mstrmojo.date,c=mstrmojo.func,S=mstrmojo.hash,Q=mstrmojo.array,t=mstrmojo.dom,AO=mstrmojo.NumberFormat.getInstance(mstrConfig.decimalSep,mstrConfig.thousandsSep),H="1:Width",l="2:Page",R=44,AD=28,AH=29,AB=17,v=mstrmojo.vi.util.NavUtility,x=mstrmojo.vi.enums.EnumFeatures,z=function(){return mstrmojo.locales.datetime;};function AZ(Aa){v.checkSessionAndSendForm(Aa,null,"post");}function AX(Ab,Ad){var Aa=Ab.model;var Ac={evt:2048001,messageID:Aa.mid,rwb:Aa.bs};if(Ad<50||Ad===2048){Ac.visMode=0;Ac.currentViewMedia=Ad;}else{Ac.visMode=Ad;Ac.currentViewMedia=1;}AZ(Ac);}function AV(){var Ab=mstrApp.pathInfo.nb,Aa=mstrmojo.array.find(Ab,"n","Return");return Aa>-1?Ab[Aa].href:null;}function w(Aa){var Ab={};Ab.evt=3198;Ab.src=mstrApp.name+".3124";AZ(Ab);}function AM(Ad,Ac,Af,Ae){var Ab=Ad.model,Aa=mstrConfig&&mstrConfig.resolveOnly||mstrApp.isAppStatePause&&mstrApp.isAppStatePause()||false;AZ({evt:2048030,src:Ab.bp+".2048030",rePrompt:Ac,fresh:Af,resolveOnly:Aa,regenerate:Ae,rwb:Ab.bs});}function Y(Aj,Ab){var Af=Aj.model,Ag=(Af&&Af.zt)||0,Ac,Ae,Aa;switch(Ag){case 1:Ac="Width";Aa=H;Ae=A(4809);break;case 2:Ac="Page";Aa=l;Ae=A(4808);break;default:Ac=(Af&&Af.getZoomFactor())||1;Aa=Ag+":"+AO.format(Ac);Ae=parseInt(Ac*100,10)+"%";}var Ad=Aj.zoomOptions,Ah;if(Ad){var Ai=mstrmojo.array.find(Ad,"dssid",Aa);if(Ai>-1){Ah=Ad[Ai];}}if(!Ah){Ah={n:Ae,dssid:Aa,f:Ac,tp:Ag};}if(Ab===true){Aj.view.zoomValue=Ah;}else{Aj.view.set("zoomValue",Ah);}}function h(Ag,Aj,Aa,Ab,Ah,Ad,Af,Ai){var Ac=Ag.model,Ae=Ac&&Ac.isnew;if(!Ae&&(!Ai||!mstrmojo.resolveFeature("save-analysis")||!(Ag.isDocChanged&&Ag.isDocChanged()))){Ah(Ad);return ;}mstrmojo.warn(Ab,{confirmBtn:{t:mstrmojo.desc(118,"Save"),fn:function(){Ag.save(Af);}},cancelBtn:{t:mstrmojo.desc(2140,"Cancel")}},{title:Aj||mstrmojo.desc(11812,"Notification"),help:Aa});}function I(Ab){var Aa=Ab.model;Aa.showDialogBeforeSave=false;Aa.getDataService().setPreference("askBeforeSaveChanges\u001E2",{success:mstrmojo.emptyFn,failure:function(Ac){mstrmojo.alert(Ac.getResponseHeader("X-MSTR-TaskFailureMsg"));}});}var k=-1,AW=3,r=4,AS=7,AN=10,j=18;mstrmojo._DocToolbarActions=mstrmojo.provide("mstrmojo._DocToolbarActions",{_mixinName:"mstrmojo._DocToolbarActions",staticViewMode:function AA(){AX(this,1);},interactiveViewMode:function AY(){AX(this,2);},editableMode:function L(){this.model.updateWidgetsProps();AX(this,4);},flashViewMode:function J(){AX(this,8);},IVEMode:function C(){AX(this,2048);},IVEHelp:function C(){var Aa=mstrmojo.helpPath();window.open(Aa+"Displaying_a_visual_representation_of_your_data__V.htm","_blank");return true;},remainExpressViewMode:function E(){},designViewMode:function O(Aa,Ab){this.model.updateWidgetsProps();AZ({evt:3104,rwDesignMode:1,convertFromVI:(Ab===true)?1:0,messageID:this.model.mid,rwb:this.model.bs,jsonMode:false});},onmodelChange:function f(){Y(this,true);},convertToDoc:function o(Ab){var Aa=this;if(Aa.model.hasMDXRADataset()){mstrmojo.alert(mstrmojo.desc(14692,'The "Convert to Document" option is currently not available for MDX cube with Hierarchical Attributes.'),null,mstrmojo.desc(3610,"MicroStrategy Web"));}else{mstrmojo.warn(mstrmojo.desc(15498,"Converting a dossier to a document cannot be undone. Do you want to convert?"),{confirmBtn:{t:mstrmojo.desc(13654,"Convert"),fn:function(){Aa.designViewMode(undefined,Ab);}},cancelBtn:{t:mstrmojo.desc(221,"Cancel")}},{title:mstrmojo.desc(5180,"Convert to Document")});}},saveAs:function(Aa){this.save();},save:function X(Ab,Aa){if(mstrApp.isSingleTier){FormWrapper.saveas();return ;}this.model.saveAsRW(Ab,Aa);},dSave:function u(Ak,Ae,Aj){var Ah=this,Ab=Ah.model,Af=Ab&&Ab.isnew,Ad=Ab&&Ab.isRWReadonly,Ac=60,Ag=Ab.n;if(mstrApp.isExpress){this.model.updateWidgetsProps();}if(mstrApp.isSingleTier){if(Aj){FormWrapper.savePromptOption((Ab.prompt_option>=0)?Ab.prompt_option+1:3);}else{FormWrapper.save();}return ;}if(Ag.length>Ac){Ag=Ag.substr(0,Ac-1)+"...";}if(Af||Ad){this.save();}else{var Al=mstrApp.features["ask-before-save-changes"];if(Al){var Aa="dialogBeforeSave",Ai=function(){mstrmojo.all.dialogBeforeSave.destroy();};mstrmojo.insert({scriptClass:"mstrmojo.Editor",id:Aa,title:A(5728),cssClass:"mstrmojo-dta save",btnAlignment:"right",modal:true,visible:true,onClose:Ai,buttons:[D(A(1442),function(){var Am=mstrmojo.all[Aa];if(Am.t.ctrlChk.checked){Ah.setDontAskAgain();mstrApp.features["ask-before-save-changes"]=false;}Ah.directSave(Ak);Ai();},true),D(A(218),function(){var Am=mstrmojo.all[Aa];if(Am.t.ctrlChk.checked){I(Ah);}Ah.save();Ai();}),D(A(2140),Ai)],children:[{scriptClass:"mstrmojo.Table",alias:"t",rows:2,cols:1,children:[{scriptClass:"mstrmojo.Label",text:A(11165,"Are you sure you want to overwrite the existing copy of ##?").replace(/##/,"<b>"+Ag+"</b>"),visible:true,cssClass:"ucalert",slot:"0,0",allowHTML:true},{scriptClass:"mstrmojo.CheckBox",label:A(211),alias:"ctrlChk",visible:true,checked:false,slot:"1,0"}]}]}).render();}else{Ah.directSave(Ak);}}},setDontAskAgain:function AG(){var Ab=this,Aa=Ab.model;Aa.showDialogBeforeSave=false;Aa.getDataService().setPreference("askBeforeSaveChanges\u001E0",{success:mstrmojo.emptyFn,failure:function(Ac){mstrmojo.alert(Ac.getResponseHeader("X-MSTR-TaskFailureMsg"));}});},directSave:function W(Ah){Ah=Ah||{};var Ag=this,Ab=Ag.model,Aa=mstrmojo.string.decodeHtmlString(Ab.n),Ae=mstrmojo.emptyFn,Ai=Ah.success||Ae,Ad=Ah.failure||Ae,Ac=Ah.complete||Ae,Af=mstrConfig&&mstrConfig.resolveOnly||mstrApp.isAppStatePause&&mstrApp.isAppStatePause()||false;mstrApp.showWait({message:mstrmojo.desc(10492,"Saving..."),cssClass:"saving-in-progress",showCancel:true});mstrmojo.xhr.request("POST",mstrConfig.taskURL,{success:function(Aj){var Ak=function(){if(!Ah.ignoreOrgSucc){mstrApp.showWait({message:mstrmojo.desc(13781,"Saved Successfully"),cssClass:"save-successful-waitbox",_autoClose:true,timeout:2000});}Ag.cmdMgr.reset();};Ab.lastSavedStid=Ab.getDataService().stid;Ab.dty=false;Ai(Aj);if(Aj.needToGetResults){Ab.getDataService().retrieveServerJson({},c.wrapMethods(Ab.controller.getRefreshCallback(),{success:Ak}),{preserveUndo:true,style:{name:"ServerJsonRWDStyle",params:{treesToRender:3}},params:{styleName:"ServerJsonRWDStyle"}});}else{Ak();}},failure:function(Aj){var Al=Aj.getResponseHeader("X-MSTR-TaskErrorCode"),Ak=Aj.getResponseHeader("X-MSTR-TaskFailureMsg");if(Al==="-2147468986"||Al==="-2147217126"||Al==="-1"||mstrApp.isVI&&Al<0&&Ak){mstrmojo.alert(Ak);}else{if(!Ah.ignoreOrgFail){mstrmojo.alert(A(4107));}}Ad(Aj);},complete:function(Aj){mstrApp.hideWait();Ac(Aj);}},{taskId:"saveRW",msgID:(Ab.dataService&&Ab.dataService.msgId)||Ab.mid,folderID:Ab.sfid||Ab.pfid,objName:Aa,objDesc:mstrmojo.string.decodeHtmlString(Ab.dsc),saveAsFlags:(Ab.prompt_option>=0)?Ab.prompt_option+1:3,taskEnv:"xhr",skipRebuild:Af,taskContentType:"json"});},quickSave:function p(){this.model.saveRW();},browseParent:function m(){var Aa=this.model,Ab={evt:3010};if(!Aa.pfh){Ab.evt=2001;Ab.folderID=Aa.pfid;if(Aa.sysFolder){Ab.systemFolder=Aa.sysFolder;}}AZ(Ab);},close:function e(){w(this);},openPage:function AP(Ab){var Aa=this.model;AZ({evt:3124,src:mstrApp.name+"."+mstrApp.pageName+".3124",relativePageNumber:Ab,messageID:Aa.mid,rwb:Aa.bs});},saveToInbox:function d(){var Ab=this;mstrApp.serverRequest({taskId:"addDocToHistoryList",rwb:Ab.model.bs},{success:function(){var Ac=Ab.model.features;if(Ac){if(Ac.set){Ac.set("enable-add-history-list",false);}else{Ac["enable-add-history-list"]=false;}}mstrmojo.alert(A(8047));},failure:function Aa(Ac){if(Ac&&Ac.message){mstrmojo.alert(Ac.message);}else{mstrmojo.alert(A(15211));}}},{silent:true});},ShowSharingEditor:function AE(Aj){var Ad="sharingEditor",Ag=mstrmojo.all[Ad],Ah=this,Ae=Ah.model,Af=Ae.isnew,Ai=(Aj&&Aj.cls)?Aj.cls:null,Ac=Ae.getDataService().stid,Aa=function(Ak){if(Ag){Ag.set("oi",Ak);S.copy({objectName:Ae.n,href:null,initTab:Ai,mid:Ae.mid,isLinkDirty:Ag.lastState!==Ac,lastState:Ac},Ag);}else{Ag=new mstrmojo.SharingEditor({guestModeEnabled:mstrApp.guestModeEnabled,mid:Ae.mid,id:Ad,oi:Ak,href:null,initTab:Ai,isLinkDirty:true,viewMode:1,lastState:Ac});}Ag.open();},Ab={success:function(Ak){Aa(Ak.objects[0]);},failure:function(Ak){mstrmojo.alert(Ak.getResponseHeader("X-MSTR-TaskFailureMsg"));}};if(Af){mstrmojo.alert(mstrmojo.desc(15513,"You must save this dossier before you can share it."),null,mstrmojo.desc(8101,"Share ..."));}else{Ae.getDataService().getObjectInfo({objectIDs:this.model.oid,objectTypes:55,includeACL:mstrApp.features?!!mstrApp.features["web-use-sharing-editor"]:false},Ab);}},annotationMode:function F(){(mstrmojo.all.annotations||mstrmojo.insert({scriptClass:"mstrmojo.vi.ui.Annotations"})).displayAnnotations(this.rootCtrl.view);},createPersonalView:function n(){var Ad=this,Aa=Ad.model,Ab=Aa&&Aa.isnew;if(Ab){mstrmojo.alert(mstrmojo.desc(15504,"You must save your dossier before continuing."),null,mstrmojo.desc(9173,"Create Personal View"));}else{var Ah=Aa.n,Ac="mstrPVD",Ag={scriptClass:"mstrmojo.PersonalViewSaveAs",id:Ac,objectType:55,objectSubType:14081},Af=mstrmojo.all[Ac]||mstrmojo.insert(Ag);if(Ah){var Ae=AK.getDateJson(new Date());Ah+=" "+AK.formatDateInfo(Ae,z().DATEOUTPUTFORMAT)+" "+AK.formatTimeInfo(Ae,z().TIMEOUTPUTFORMAT);Af.set("name",Ah);}Af.msgID=this.model.mid;Af.open();}},reprompt:function V(){AM(this,true,false,false);},refresh:function q(){AM(this,false,false,false);},rerun:function B(){AM(this,false,true,false);},toggleAutoRefresh:function(Ad){var Ac=Ad.src,Ab=this.model.controller,Aa=Ab.isAutoRefreshStarted();Ab[(Aa?"stop":"start")+"AutoRefresh"]();Ac.set("iconClass",(Aa?"tbStart":"tbStop")+"AutoRefresh");Ac.domNode.setAttribute("title",Aa?"*Resume Auto Refresh*":"*Pause Auto Refresh*");},popPromptOption:function AI(Ad){var Aa=this.model,Ac=new mstrmojo.vi.ui.editors.PromptOptionEditor({optVal:Aa.prompt_option===undefined?2:Aa.prompt_option,onSave:function Ab(){Aa.prompt_option=this.optVal;Ad(Aa.prompt_option);}});Ac.open();},docVisualizationModeAJAX:function Z(){AX(this,51);},docVisualizationModeFlash:function AJ(){AX(this,50);},sendNow:function K(){h(this,mstrmojo.desc(2331,"Send Now"),"Sending_an_analysis_in_an_email.htm",mstrmojo.desc(2513,"You must save the report/document before you can send it."),AZ,{evt:3037,objectType:55,objectSubType:14081,messageID:this.model.mid},{saveAsOrigin:2},false);},scheduleHL:function AL(){h(this,A(5017,"Subscribe to History List"),"",A(15504,"You must save your dossier before continuing."),AZ,{evt:3128,objectType:55,objectSubType:14081,messageID:this.model.mid},{saveAsOrigin:3},false);},scheduleEmail:function AT(){h(this,A(3282,"Schedule Delivery to E-mail"),"",A(15504,"You must save your dossier before continuing."),AZ,{evt:3036,objectType:55,objectSubType:14081,messageID:this.model.mid},{saveAsOrigin:3},false);},zoomValue:null,getRequiredZoomFactor:function AC(Ah){var Ag=this.model,Ad=this.view.selected,Ae=(Ad&&Ad.docLayout)||null,Ak=Ae&&(Ae.containerNode||Ae.domNode),Ac=Ak&&Ak.ownerDocument.documentElement,Af=(Ag&&Ag.getZoomFactor())||1,Ai=Af;var Ab=function(Al){Al-=R;if(Ag.multiLayout){Al-=AD;}if(Ag.hasGroupby){Al-=AH;}return Al;};var Aa=function(An){var Al=Ak&&Ak["offset"+An];if(!Al){return Af;}var Am=Math.max(1,Ac["client"+An]);if(An==="Height"){Am=Ab(Am);}return Math.min(4,Math.max(0.1,Math.floor(Af*Am*100/Al)/100));};var Aj=function(Ao){var Al=Ak&&Ak.offsetHeight;if(Al){var Am=Math.max(1,Ac.clientWidth),An=Ab(Math.max(1,Ac.clientHeight));if(Al*Ao/Af>Math.max(1,An)){Ao=Math.floor(Ao*(Am-AB)*100/Am)/100;}}return Ao;};zf=Aa("Width");if(parseInt(Ah,10)===1){zf=Aj(zf);}if(Ah===2){zf=Math.min(zf,Aa("Height"));}return zf;},zoom:function N(Ad){var Ab=(Ad!==null)?String(Ad).split(":"):[],Ag=parseInt(Ab[0],10),Ah=Ab[1],Aa=AO.parse(Ah),Ac=false;if(isNaN(Ag)||(!Ag&&isNaN(Aa))){return ;}var Ae=this.model;if(Ag===1||Ag===2){Ah=AO.format(this.getRequiredZoomFactor(Ag));Ac=parseInt(Math.abs((AO.parse(Ah)-Ae.getZoomFactor())*100),10)>2;}else{Ac=Ah!==AO.format(Ae.getZoomFactor());}if(Ag!==Ae.zt||Ac){Ae.zoomFactorUpdating=true;var Ai=this;Ae.getDataService().setDocZoom({zoomType:Ag,zoomFactor:Ah,rwb:Ai.model.bs,currLayoutKey:Ae.currlaykey},{success:function(Am){Ae.zoomFactorUpdating=false;if(Ag!==0){var Ao=Ai.view.children,Al;for(Al in Ao){var An=Ao[Al];if(An.k===Ai.model.currlaykey){continue;}if(An.defn){An.defn.loaded=false;}}}Ae.zt=Am.zt;Ae.replaceLayout(Am.currlaykey,Am);Ae.raiseEvent({name:"rebuildLayout"});Y(Ai,false);Ai=null;},failureName:"zoom.set"});}else{if((Ag===1||Ag===2)&&this.view.selected){Ae.zoomFactorUpdating=false;var Af=this.view.selected.docLayout,Ak=Af&&(Af.containerNode||Af.domNode),Aj=Ak&&Ak.style;if(Aj){Aj.visibility="visible";}}}},syncZoom:function(){var Aa=this.model,Ab=AO.format(Aa.getZoomFactor());mstrApp.serverRequest({taskId:"setDocZoom",rwb:Aa.bs,styleName:"EmptyStyle",zoomFactor:Ab,zoomType:Aa.zt,layoutKey:Aa.currlaykey},null);},exportCmd:function AQ(Ag,Ao,As,Aq){Ao=typeof Ao!=="string"?undefined:Ao;if(!window.FormWrapper){var Aj=this.model,Af=this.view,Aa=(parseInt(Ag,10)===k)?3130:3132,Ak=Aj.exopt,An=Aj.huc&&Ag===AS,Ai=Ak.s&&(Ag===r||Ag===AW)&&!Ao,Am=false,Ar=false;if(Ai){if(!!(Aj.defn&&Aj.defn.layouts&&Aj.defn.layouts.length>1)){Ar=true;}else{var Ae=Af.selected,At=Ae&&Ae.gb&&Ae.children[1];Am=(!At||At.areUnitsSetToAll());if(Am){Ai=false;}}}var Ah=function(){var Aw={evt:Aa,src:mstrApp.name+"."+Aa};if(Aa===3132){Aw.executionMode=Ag;if(Ao!=null){Aw.gridKey=Ao;}if(As>0){Aw.sliceId=As;}}if(!Ai){Aw.rwb=Aj.bs;}else{var Au=[[2048062,Aj.bp+".2048062","mode",Ak.m,"range",Ak.r],[]];S.forEach(Aw,function(Ay,Ax){if(Ax==="executionMode"){Au[1]=Au[1].concat([Ax,Ay]);}else{Au[1].push(Ay);}});Aw.evt=1024001;Aw.src=Aj.bp+".1024001";Aw.events=AF.serializeValueGroup(Au);Aw["1024001"]=1;Aw.messageId=Aj.mid;}Aw.name=Date.parse(new Date());var Av=function(){var Ax=(!(Ak.n)&&Ag===AW&&(t.isIE||t.isIEW3C))?"GET":"POST";v.checkSessionAndSendForm(Aw,null,Ax,(Ak.n)?"_blank":"mstrExportWindow");};if(!t.isIE||Ag!==AS){Av();}else{mstrmojo.alert(A(5873),Av);}};var Ad;if(Ai||An){Ad=function(){var Av="mojoExOpx9",Au=function(){mstrmojo.all.mojoExOpx9.destroy();};mstrmojo.insert({scriptClass:"mstrmojo.Editor",id:Av,title:A(971),cssClass:"mstrmojo-dta export",btnAlignment:"right",onClose:Au,draggable:false,buttons:[D(A(1442),function(){var Aw=mstrmojo.all[Av];if(Ar){Ak.r=Aw.ctrlLyt.selectedIndex;}if(!Am){Ak.m=(Aw.ctrlChk.checked)?0:1;}Au();Ah();},true),D(A(2140),Au)],children:[{scriptClass:"mstrmojo.Label",cssClass:"ucalert",text:A(7482),visible:An},{scriptClass:"mstrmojo.ui.Pulldown",cssClass:"exp_opts",cssDisplay:"block",alias:"ctrlLyt",visible:!!Ar,selectedIndex:Ak.r,items:[{n:A(14583),v:0},{n:A(14582),v:1}]},{scriptClass:"mstrmojo.CheckBox",label:A(5165),cssDisplay:"block",alias:"ctrlChk",visible:!mstrApp.isVI&&!Am&&Ai,checked:(Ak.m===0)}]}).render();};}if(Ag===r&&Ak.ds["3809"]!==undefined&&!Ao){mstrmojo.confirm(A(3809),{confirmBtn:{fn:Ad||Ah,t:A(1442)},cancelBtn:{t:A(2140)}});}else{if(mstrApp.isVI&&Aq&&Ag==AW){var Ab;if(Ao){Ab=mstrmojo.vi.ui.editors.ExportPDFEditor.singleVisSettings;}var Al=function(Aw){var Ax={evt:3132,src:mstrApp.name+"."+3132};Ax.executionMode=AW;if(Ao){Ax.gridKey=Ao;}var Au=[[2048062,Aj.bp+".2048062"],[]];S.forEach(Aw,function(Az,Ay){Au[0].push(Ay);Au[0].push(Az);});S.forEach(Ax,function(Az,Ay){if(Ay==="executionMode"){Au[1]=Au[1].concat([Ay,Az]);}else{Au[1].push(Az);}});Ax.evt=1024001;Ax.src=Aj.bp+".1024001";Ax.events=AF.serializeValueGroup(Au);Ax["1024001"]=1;if(Aj.mid){Ax.messageId=Aj.mid;}Ax.name=Date.parse(new Date());var Av=function(){v.checkSessionAndSendForm(Ax,null,"post",(Aj.n)?"_blank":"mstrExportWindow");};if(!t.isIE||Ag!==AS){Av();}else{mstrmojo.alert(A(5873),Av);}};var Ac=new mstrmojo.vi.ui.editors.ExportPDFEditor({exOpts:Ab,exportHandler:Al,singleVis:!!Ao});Ac.open();}else{if(!Aq&&Ad){Ad();}else{Ah();}}}}else{if(Ao!==undefined){var Ap={3:{mode:"2",version:""},4:{mode:"1",version:"4"},10:{mode:"5",version:""}};FormWrapper.doExport(Ap[Ag].mode,Ap[Ag].version,Ao);}}},printPDF:function U(Aa){var Ab=this;if(window.FormWrapper){Ab.exportCmd(AW,Aa,null,true);}else{mstrApp.featureFlagsCache=mstrApp.featureFlagsCache||{};if(mstrApp.featureFlagsCache["EE/NewEEExportOption"]===undefined){mstrmojo.xhr.request("POST",mstrConfig.taskURL,{success:function(Ac){mstrmojo.hash.copy(Ac,mstrApp.featureFlagsCache);Ab.exportCmd(AW,Aa,null,Ac["EE/NewEEExportOption"]);}},{taskId:"getNeeFeatureFlags"});}else{Ab.exportCmd(AW,Aa,null,mstrApp.featureFlagsCache["EE/NewEEExportOption"]);}}},exportExcel:function g(Aa){this.exportCmd(r,Aa);},exportCSV:function P(Aa){this.exportCmd(AN,Aa);},exportHTML:function b(){this.exportCmd(k);},exportMSTR:function a(){var Ad=this,Ae=Ad.isDocChanged&&Ad.isDocChanged(),Ab=mstrmojo.resolveFeature(x.SAVE_ANALYSIS),Ac=Ae?Ab:true,Aa=function Aa(Af){Ad.exportCmd(Af);};if(Ac){h(this,null,"",A(15504,"You must save your dossier before continuing."),Aa,j,{saveAsOrigin:14},true);}else{mstrmojo.alert(A(12933,"You do not have enough privileges to perform this operation"));}},openHome:function G(Aa){AZ({evt:3010,src:mstrApp.name});},updateZoom:function M(){Y(this,false);},resetSelections:function AR(){var Ac=this,Ab=Ac.model,Aa=!!Ab.hasGroupby;Ab.getDataService().resetSelections(null,Aa,{success:function(Ag){var Aj=Ac.view.children,Ad=(Aj&&Aj.length)||0,Ak=Ab.getCurrentLayoutKey(),Af;for(Af=0;Af<Ad;Af++){var Ah=Aj[Af];if(Ah.defn&&Ah.defn.loaded&&Ak!==Ah.k){Ah.defn.loaded=false;}}if(Aa){Ab.loadLayout(Ag);return ;}if(Ag.pukeys){var Ai=Ab.partialUpdate(Ag.data,Ab.getUnitDefinitions(Ag.pukeys)),Ae=Ab.getLayoutDataCache(Ab.getCurrentLayoutKey());S.forEach(Ai.upd,function(An,Ap){var Am=mstrmojo.all[Ap];if(Am&&Am.defn&&Am.defn.t===mstrmojo.EnumRWUnitType.PANELSTACK){var Al=Ae&&Ae[Ap]&&Ae[Ap].data,Ao=Al&&Al.selKey;if(Ao&&Am.selectedKey!==Ao){Am.defn.set("selKey",Ao);}Am.setDirtyChildren();}});}}});}});}());(function(){mstrmojo.requiresCls("mstrmojo.vi.viz.DropZoneHelper","mstrmojo.string","mstrmojo.vi.ui.DatasetUnitMenuUtils");var G="mstrmojo-VIUnitList",I="icn clsx_sub",D=mstrmojo.vi.viz.DropZoneHelper.isMetricNames,C=mstrmojo.vi.ui.DatasetUnitMenuUtils,J=mstrmojo.string;mstrmojo.vi.ui.VIDragUnit=mstrmojo.declare(null,null,{scriptClass:"mstrmojo.vi.ui.VIDragUnit",getItemDisplayName:function F(K){return K.n;},getUnitAvatar:function A(N,Q){var M=document.createElement("div"),P=N.getCtxtDragData(),K=P.items,L=['<div class="',[G,mstrApp.getThemeClassName()].join(" "),'">'],O=this;K.forEach(function(S){var U=O.getItemDisplayName(S),R="item unit isAvatar "+C.getUnitCssClass(S);if(D(S)){U=mstrmojo.desc(3582,"Metrics");R+=" is-mh";}L.push('<div class="'+R+'"><span class="txt" unselectable="on">'+(Q?J.encodeHtmlString(U):U)+"</span></div>");});L.push("</div>");M.innerHTML=L.join("");return M.removeChild(M.firstChild);},getUnitDragData:function B(M,K){var L=this.setAvatarClass.bind(this);return{items:K,item:K[0],setAvatarClass:function N(P){L(M,P);},setInvalidAvatarClass:function O(){L(M,I);}};},getDragUnitOffsets:function E(){return{x:21,y:16};},setAvatarClass:function H(N,K){var L=N.avatar;if(L){var M=[G,"hasOwnAvatar",mstrApp.getThemeClassName(),K||""];L.className=M.join(" ");}}});}());(function(){mstrmojo.requiresCls("mstrmojo.Editor","mstrmojo.Button","mstrmojo.Label","mstrmojo.Box","mstrmojo.ui.CheckList","mstrmojo.DataGrid","mstrmojo.hash","mstrmojo.models.FormatModel","mstrmojo.ui.editors.controls.TwoColumnContainer","mstrmojo.ui.editors.controls.ValidationTextBox","mstrmojo.vi.ui.DatasetUnitMenuUtils","mstrmojo.func","mstrmojo.array","mstrmojo.dom");var J=mstrmojo.hash,f=mstrmojo.array,C=mstrmojo.css,V=mstrmojo.Button.newWebButton,n=mstrmojo.ui.Pulldown.newPulldown,j=mstrmojo.models.FormatModel.getFormatUpdate,a=mstrmojo.models.FormatModel.ENUM_PROPERTY_NAMES,d=mstrmojo.vi.ui.DatasetUnitMenuUtils,H,I=mstrmojo.dom;var B=1,k=2,G=3,D="480px",g="visfilter";var E=[{n:mstrmojo.desc(6031,"Off"),v:"0"},{n:mstrmojo.desc(6030,"On"),v:"1"},{n:mstrmojo.desc(8504,"Form name only"),v:"2"},{n:mstrmojo.desc(8505,"Show attribute name once"),v:"3"},{n:mstrmojo.desc(4531,"Automatic"),v:"4"}],Z=[{n:mstrmojo.desc(13786,"Show both nulls and zeros"),v:"-1"},{n:mstrmojo.desc(13787," Hide both nulls and zeros"),v:"2"},{n:mstrmojo.desc(9845,"Hide nulls only"),v:"0"},{n:mstrmojo.desc(9846,"Hide zeros only"),v:"1"}],N=[{n:mstrmojo.desc(13544,"Last selection only"),v:0},{n:mstrmojo.desc(13545,"Intersection of all selections"),v:1}],h=[{n:mstrmojo.desc(959,"Default"),v:"-1",title:mstrmojo.desc(959,"Default")},{n:mstrmojo.desc(9640,"Inner Join"),v:"0",title:mstrmojo.desc(9640,"Inner Join")},{n:mstrmojo.desc(9641,"Outer Join"),v:"1",title:mstrmojo.desc(9641,"Outer Join")}],M=[{n:mstrmojo.desc(959,"Default"),v:"-1",title:mstrmojo.desc(959,"Default")},{n:mstrmojo.desc(13177,"Inner Join"),v:"0",title:mstrmojo.desc(13178,"Results displaying only those attribute elements that have metric value")},{n:mstrmojo.desc(13179,"Outer Join - Ignore Filter"),v:"2",title:mstrmojo.desc(13180,"Outer join to attribute's look up table without considering the filter on template")},{n:mstrmojo.desc(13181,"Outer Join - Preserve Filter"),v:"3",title:mstrmojo.desc(13182,"Outer join to attribute's look up table after considering the filter on template")}];var c={"-1":mstrmojo.desc(959,"Default"),"0":mstrmojo.desc(9640,"Inner Join"),"2":mstrmojo.desc(13179,"Outer Join - Ignore Filter"),"3":mstrmojo.desc(13181,"Outer Join - Preserve Filter")},W={"-1":mstrmojo.desc(959,"Default"),"0":mstrmojo.desc(9640,"Inner Join"),"1":mstrmojo.desc(9641,"Outer Join")};var U;var e=false;function P(u,q,p,t){var r={scriptClass:"mstrmojo.ui.editors.controls.TwoColumnContainer",col1Width:u,col2Width:q,children:p};return J.copy(t,r);}function Q(q,r,p){return J.copy(p,{scriptClass:"mstrmojo.Label",slot:r,text:q});}function F(t,p){return[Q(t,"col1Node",{cssClass:"subTitle"}),{scriptClass:"mstrmojo.ui.CheckList",orientation:"h",slot:"col2Node",preBuildRendering:function q(){var x=mstrmojo.all[H].data[p],u=this.items,w=this.selectedIndices;if(x){f.forEach(u,function(AA,z){w[z]=x[AA.id]==="-1";});}var v=mstrmojo.all[H].olm;if(!!v&&p==="rows"){this.items[1].css="disabled";}else{this.items[1].css="";}},postselectionChange:function r(u){var w=this.items,v=[u.added,u.removed];v.forEach(function(z,x){if(z&&z.length>0){j(p+w[z[0]].id,x===0?"-1":"0",mstrmojo.all[H].newData);}});},items:[{n:mstrmojo.desc(2969,"Show"),id:a.SHOW_HEADER},{n:mstrmojo.desc(1095,"Merge"),id:a.MERGE_HEADER,css:""},{n:mstrmojo.desc(2970,"Lock"),id:a.LOCK_HEADER}]}];}function S(){var q=H.split("-"),p=q.length;if(!mstrApp.isInVFConfigMode&&q[p-1]===g){q.splice(q.length-1,1);}else{if(mstrApp.isInVFConfigMode&&q[p-1]!==g){q.splice(q.length,1,g);}}H=q.join("-");}function X(q){S();var p=mstrmojo.all[H];if(q){p.update=p.update.actions?p.update:{actions:[]};p.update.actions=p.update.actions.concat(mstrmojo.hash.valarray(p.joinActions));p.update.callback=mstrmojo.func.wrapMethods(p.update.callback,p.host.parent.model.getRebuildCallback());if(p.SelectionLimitSection&&p.limitVal){p.host.writeGlobalProperty("slctnLmt",p.limitVal);}p.submitAction(p.newData,p.update.actions,p.update.callback,p.update.extras);}p.newData=p.update={};p.joinActions={};p.close();}function O(q){var u=q.parent.data,r=mstrmojo.all[H],p=r.host.k,t=r.host.controller,v=new mstrmojo.ui.menus.MenuConfig();r.joinActions=r.joinActions||{};if(u.did==="AllAttr"){M.forEach(function(w){v.addMenuItem(w.n,"",function(){q.parent.jtValue.set("text",w.n);u.v=w.v;u.dv=w.n;r.joinActions.AllAttr=t.dataService().getSetAttributesJoinTypeAction(p,w.v);});});}else{h.forEach(function(w){v.addMenuItem(w.n,"",function(){q.parent.jtValue.set("text",w.n);u.v=w.v;u.dv=w.n;r.joinActions[u.did]=t.dataService().getSetMetricJoinTypeAction(p,u.did,u.dt,u.t,w.v);});});}v.hostId=H;v.isHostedWithin=false;v.hostElement=q.domNode;v.menuCssClass="joinbehavior";v.setAlignment(3,2);r.openPopup(v.newInstance());}mstrmojo.vi.ui.editors.MoreOptionsEditor=mstrmojo.declare(mstrmojo.Editor,[mstrmojo.ui.menus._HasMenuPopup],{scriptClass:"mstrmojo.vi.ui.editors.MoreOptionsEditor",host:undefined,showHeadersSection:false,showSelectionLimitSection:false,data:undefined,lockHeadersCase:undefined,update:undefined,newData:undefined,joinActions:undefined,cssClass:"mstrmojo-MoreOptions-Editor",title:mstrmojo.desc(9126,"More options"),help:"more_options_dialog_box.htm",submitAction:mstrmojo.emptyFn,init:function l(p){this._super(p);if(mstrApp.isInVFConfigMode){this.children.splice(2,1);}H=this.id;this.newData=this.update={};this.joinActions={};this.onshowHeadersSectionChange(this.showHeadersSection);this.onshowSelectionLimitSectionChange(this.showSelectionLimitSection);},onOpen:function R(){S();var p=this.host,q=p&&p.gridData,t=q&&q.olm&&!(q.rw&&q.rw.row.bc>0);this.olm=!!t;if(this.showSelectionLimitSection){var r=this.SelectionLimitSection.children[1].children[1].provider;r.curVal=p.readGlobalProperty("slctnLmt");this.limitVal=undefined;}this.refresh();},_set_lockHeadersCase:function Y(t,p){this.lockHeadersCase=p;var q=this.data,r=this.lockHeadersCase;if(!q){q=this.data={rows:{},cols:{}};}else{q.rows=q.rows||{};q.cols=q.cols||{};}q.rows.lhv=(r===G||r===B)?"-1":"0";q.cols.lhv=(r===G||r===k)?"-1":"0";},onshowHeadersSectionChange:function K(q){var r=q.value,p=this.headersSection;if(!r&&p){this._headersSecOrphan=p;this.removeChildren(p);}else{if(r&&!p){this.addChildren(this._headersSecOrphan,0);}}},onshowSelectionLimitSectionChange:function b(p){var r=p.value,q=this.SelectionLimitSection;if(!r&&q){this._selectionSecOrphan=q;this.removeChildren(q);}else{if(r&&!q){this.addChildren(this._selectionSecOrphan,2);}}},children:[P("26%","74%",[Q(mstrmojo.desc(2967,"Headers"),"col1Node",{cssClass:"title"}),P("20%","80%",F(mstrmojo.desc(2968,"Rows"),"rows"),{slot:"col2Node"}),P("20%","80%",F(mstrmojo.desc(122,"Columns"),"cols"),{slot:"col2Node"})],{alias:"headersSection",cssClass:"headers",width:D}),P("26%","74%",[Q(mstrmojo.desc(4083,"Display"),"col1Node",{cssClass:"title"}),{scriptClass:"mstrmojo.Box",slot:"col2Node",cssClass:"row1",children:[Q(mstrmojo.desc(8503,"Show attribute form names:"),"containerNode",null),n(E,function(p){j(a.LONG_NAME,p.v,mstrmojo.all[H].newData);},0,{width:"151px",preBuildRendering:function A(){var p=this.items.map(function(q){return q.v;}).indexOf(mstrmojo.all[H].data[a.LONG_NAME]);this.selectedIndex=Math.max(p,0);}},true)]},{scriptClass:"mstrmojo.Box",slot:"col2Node",cssClass:"row2",children:[Q(mstrmojo.desc(13200,"Hide Null/Zero"),"containerNode",null),n(Z,function(q){var p=q.v,r=p==="-1"?"-1":"0";if(p!=="-1"){j(a.HIDE_NULL,p,mstrmojo.all[H].newData);}j(a.SHOW_ALL_ROWS,r,mstrmojo.all[H].newData);},0,{width:"181px",preBuildRendering:function A(){var q=mstrmojo.all[H].data,p=q[a.SHOW_ALL_ROWS]==="-1"?0:this.items.map(function(r){return r.v;}).indexOf(q[a.HIDE_NULL]);this.selectedIndex=Math.max(p,0);}},true)]}],{alias:"viewSection",cssClass:"view",width:D}),P("26%","74%",[Q(mstrmojo.desc(13546,"Filtering"),"col1Node",{cssClass:"title"}),{scriptClass:"mstrmojo.Box",slot:"col2Node",cssClass:"row1",children:[Q(mstrmojo.desc(13547,"When this visualization is filtered by multiple other visualizations, filter by:"),"containerNode",{cssClass:"dropdownLabel"}),n(N,function(p){var q=mstrmojo.all[H],r=q.host;if(r.switchFilterType){q.update=r.switchFilterType(p.v);}},0,{width:"181px",preBuildRendering:function A(){var p=mstrmojo.all[H].host;if(p.getFilterType){this.selectedIndex=p.getFilterType();}}},true)]}],{alias:"filteringSection",cssClass:"filtering",width:D}),P("26%","73%",[Q(mstrmojo.desc(16265,"Selection Data Limit"),"col1Node",{cssClass:"title"}),{scriptClass:"mstrmojo.Box",slot:"col2Node",cssClass:"row1",children:[Q(mstrmojo.desc(16264,"Set a limit for the maximum quantity of data points that a user can select on this visualization."),"containerNode",{cssClass:"stepperLabel"}),{scriptClass:"mstrmojo.ui.editors.controls.Stepper",width:"75px",preBuildRendering:function A(){C.addWidgetCssClass(this,"selection");mstrmojo.ui.editors.controls.Stepper.prototype.preBuildRendering.call(this);},provider:new mstrmojo.NumStepperContentProvider({item:{interval:1},min:1,max:200000,onTraverse:function(){var p=mstrmojo.all[H];p.limitVal=this.item.value;}})},Q(mstrmojo.desc(16263,"(Max quantity should be no more than 200K.)"),"containerNode",{cssClass:"stepperLabel"})]}],{alias:"SelectionLimitSection",cssClass:"filtering",width:D}),P("26%","74%",[Q(mstrmojo.desc(4571,"Join Behavior"),"col1Node",{cssClass:"title"}),{scriptClass:"mstrmojo.DataGridWithTooltip",slot:"col2Node",cssClass:"jointype",banding:false,lockHeader:true,columns:[{headerText:mstrmojo.desc(5467,"Objects"),dataField:"n",headerCss:"objects-hd",tooltip:false,itemTooltipField:"tf",itemCSSField:"itemCss",colWidth:115,colHeight:24},{headerText:mstrmojo.desc(13176,"Join Type"),headerCss:"jointype-hd",dataWidget:{scriptClass:"mstrmojo.Box",cssClass:"jt-col",children:[{scriptClass:"mstrmojo.Label",cssClass:"jt-value",alias:"jtValue",bindings:{text:"this.parent.data.dv"}},{scriptClass:"mstrmojo.Button",cssClass:"jt-menu",alias:"jtBtn",onclick:function(){var p=mstrmojo.all[H];O.call(p,this);}}]}}],items:[],itemFunction:function(){var p=mstrmojo.DataGridWithTooltip.prototype.itemFunction.apply(this,arguments);p.themeClassName=!!mstrApp.isWSStyling?"":"mojo-theme-dark";return p;},preBuildRendering:function A(){var AA=mstrmojo.all[H].host,z=AA.model&&AA.model.docModel,r=AA.gridInfo||{},AB=r.rows||[],w=r.cols||[],x=r.mx||[],t=r.dmx||[],v=AA.tmsProps,p=v.tpltProp&&v.tpltProp["VLDB Select"]&&v.tpltProp["VLDB Select"][0].v,u=[];p=(p&&p.length)?p:"-1";(AB.concat(w)).some(function(AC){if(AC.t===12){u.push({did:"AllAttr",n:mstrmojo.desc(13185,"All Attributes"),v:p,dv:c[p],itemCss:"jt-allattr"});return true;}return false;});x=f.filter(x,function(AD){var AE=d.getUnitFromDataset(z.datasets,AD.did,4),AC=AD.isSmart&&AD.decomposable===2;return AE&&(!AE.um||AD.afb||!AD.isSmart||AC);});var q=[].concat(v.mxProp);t.forEach(function(AD){var AC={};AC[AD.did]=AD.prop;q.push(AC);});(x||[]).forEach(function(AD){var AC={v:"-1"};(q||[]).forEach(function(AE){if(AE[AD.did]){(AE[AD.did]["VLDB Select"]||[]).forEach(function(AF){if(AF.n==="Metric Join Type"){AC=AF;}});}});u.push({did:AD.did,n:AD.n,dt:AC.dt,t:4,v:AC.v,dv:W[AC.v],itemCss:"jt-metric"});});this.items=u;mstrmojo.DataGridWithTooltip.prototype.preBuildRendering.apply(this,arguments);},postBuildRendering:function L(){mstrmojo.DataGridWithTooltip.prototype.postBuildRendering.apply(this,arguments);this.domNode.style.overflow="hidden";}}],{alias:"JoinBehaviorSection",cssClass:"joinbehavior",width:D}),{alias:"buttonBar",scriptClass:"mstrmojo.Box",slot:"buttonNode",children:[V(mstrmojo.desc(221,"Cancel"),function(){X(false);}),V(mstrmojo.desc(118,"Save"),function(){X(true);},true)]}]});mstrmojo.DataGridWithTooltip=mstrmojo.declare(mstrmojo.DataGrid,[mstrmojo._HasTooltip],{scriptClass:"mstrmojo.DataGridWithTooltip",tooltip:"",useRichTooltip:true,itemFunction:function(r,p,q){var t=new mstrmojo.DataRow({columns:q.columns,data:r,idx:p,dataGrid:q,parent:q});q.dataTextCSSClass=t.dataTextCSSClass;return t;},updateTooltipConfig:function m(q){var r=q.target||I.eventTarget(q.hWin,q.e),p=I.position(r);this.richTooltip={posType:mstrmojo.tooltip.POS_BOTTOMRIGHT,content:this.getTooltipContent(q),top:p.y+1.5*p.h,left:p.x,cssClass:"vi-regular vi-tooltip-D"};},getTooltipContent:function(p){return mstrmojo.string.regEscape(p.target.innerText);},showTooltip:function o(p,q){if(p.target.className===this.dataTextCSSClass){this._super(p,q);}}});}());(function(){mstrmojo.requiresCls("mstrmojo.array","mstrmojo.css","mstrmojo.dom","mstrmojo.expr","mstrmojo.hash","mstrmojo.string","mstrmojo.vi.ui.HierarchyElementsCheckListBrowser","mstrmojo.vi.ui.ElementsBrowser","mstrmojo.ValidationTextBox","mstrmojo.DateTextBox","mstrmojo.Label","mstrmojo._IsList","mstrmojo.rw.ConditionWalkProviderBase","mstrmojo.ui.Pulldown","mstrmojo.ui.SearchablePulldown","mstrmojo.ui.CheckList","mstrmojo.ui.ColumnContainer","mstrmojo.vi.ui.DatasetUnitMenuUtils");var P=mstrmojo.array,W=mstrmojo.css,F=mstrmojo.string,M=mstrmojo.expr,X=mstrmojo.dom,Y=mstrmojo.hash,z=M.ET,a=M.ET2TGT,o=M.DTP2FN_DTP,Z=M.FN,n=M.FNT,S=M.FN_MRP,t=mstrmojo.rw.ConditionWalkProviderBase,d=t.onWalkChange,q=t.updateList,AJ=t.fnItem,AI=t.isComparisonAllowed,b=t.clearInvalid,D=t.shouldShowCst,e=t.getConstant,G=t.getConstantDataType,x=t.getConstantValue,AK=t.isDATE,f=t.getCstListCompareTgts,g=t.fmJson,AC=t.allowedTargetTypes,L=t.updatePulldown,U=t.onWalkChangeThroughPulldown,p=mstrmojo.mstr.EnumDSSXMLObjectTypes,AG=mstrmojo.mstr.EnumDSSXMLObjectSubTypes,AM=mstrmojo.vi.ui.DatasetUnitMenuUtils,B=mstrmojo.ui._HasListTooltip;var E=mstrmojo.ui.ColumnContainer.prototype.updateColumnContainer;var Q=mstrmojo.meta.TP,AF=mstrmojo.meta.STP,C="-2";var N={SELECT:0,QUALIFICATION:1};var h={TEMPLATE_LEVEL:0,DATASET_LEVEL:1};var V={VALUE:1,RANK_PERCENTAGE:2,BOTH:3};var m=0,r=1;var H=368,AE=H-5,AL=5,R=26,K=10;var w={};w[z.MQ]={key:"metricFns",def:M.METRIC_FNS};w[z.MC]={key:"metricFns",def:M.METRIC_FNS};w[z.AQ]={key:"formFns",def:M.FORM_FNS};w[z.AL]={key:"formFns",def:M.FORM_FNS};w[z.AC]={key:"formFns",def:M.FORM_FNS};w[z.AE]={key:"elemFns",def:M.ELEM_FNS};function AH(AN){return'<div class="unit item '+AM.getUnitCssClass(AN)+'">'+F.encodeHtmlString(AN.n)+"</div>";}function AB(AN){var AO=this.selectedNode;P.forEach(AO.classList,function(AP){if(AP&&F.startsWith(AP,"ic")){W.removeClass(AO,AP);}});W.addClass(AO,"unit");W.addClass(AO,"item");W.addClass(AO,AM.getUnitCssClass(AN));return F.encodeHtmlString(AN.n);}function l(AO,AW){var AS=AO.model,AV=AS.et,AX=AS&&AS[a[AV]]&&AS[a[AV]][AO.columnWalk.target.itemIdField||"did"],AR=AS&&AS.fm,Aa=AR&&AR.dtp,AP=AI(AS,AO.ets);if(this.targetsLastMod&&this.targetsLastMod===AO.targetsLastMod&&AX&&AX===this._lastTargetId&&this.lastFmDtp===Aa&&this.lastFnTp===AP&&this.lastEt===AV){return ;}var AU=this.attMxPd,AZ=this.attMxLabel;if(!AP){AU.set("items",[]);AZ.set("visible",false);AU.set("visible",false);}else{var AY=AS.a?mstrmojo.desc(518,"Attribute"):AS.m?mstrmojo.desc(517,"Metric"):"",AT=f(AO),AN=AS[a[AS.et]+(2+AW)],AQ=AN?P.find(AT,"did",AN.did):undefined;AZ.set("text",AY);AU.items=AT;AU.selectedIndex=AQ>=0?AQ:undefined;AU.refresh();AZ.set("visible",true);AU.set("visible",true);}this._lastTargetId=AX;this.lastFnTp=AP;this.lastFmDtp=Aa;this.lastEt=AV;this.targetsLastMod=AO.targetsLastMod;}function J(AV,AY){AV.updating=true;var AR=AV.parent.parent.parent,AX=D(AR,AY);if(!AX){AV.updating=false;return ;}var AP=AR.model||{},AU=e(AR,AY),AQ=G(AR,AU),AZ=x(AR,AY),AW=AP.fn,AT=M.fn_List(AW,AP.fnt),AN=AK[AQ];var AS=AN?AV.dateInput:AV.txtInput;var AO=AN?AV.txtInput:AV.dateInput;AO.set("visible",false);AS.updating=true;AS.set("dtp",AQ);AS.set("isList",AT);AS.set("value",AZ);AS.set("visible",true);AS.set("hint",AT?mstrmojo.desc(8191,"value1## value2## ...## valueN").replace(/##/g,mstrConfig.listSep||";"):"");AS.updating=false;if(AW===1||AW===2){AS.constraints.min=0;}if(AS.clearValidation&&AS.inputNode){AS.clearValidation();}l.call(AV,AR,AY);switch(AP.et){case z.AQ:case z.AL:case z.MQ:AV.attMxPd.set("selectedIndex",undefined);break;}AV.updating=false;}function AD(){var AQ=this.parent,AO=AQ.parent.parent.parent,AP=(this.isValid&&this.isValid())||(!this.isValid&&!F.isEmpty(this.value)),AN=AO.model;AO["invalid"+AQ.cstIndex]=!AP;if(!this.updating){this.updating=true;if(AN){AN.edit(AQ.alias,{v:this.value,dtp:this.dtp});}this.updating=false;}if(AO.updateOkBtn){AO.updateOkBtn();}}function I(AN){if(AN){var AP=AN.n,AO=AN.dsName;if(AP&&AO){return'<div class="name">'+F.encodeHtmlString(AP,true)+'</div><div class="dsc dataset">'+F.encodeHtmlString(AO,true)+"</div>";}else{return B.getTooltipText.call(this,AN);}}}function k(AN){return Y.copy(AN,{scriptClass:"mstrmojo.Box",children:[{scriptClass:"mstrmojo.ValidationTextBox",alias:"txtInput",cssText:"width: 100%",required:true,constraints:{trigger:mstrmojo.validation.TRIGGER.VALUESET},onValid:AD,onInvalid:AD,onClearValidation:b,size:6,visible:true},{scriptClass:"mstrmojo.DateTextBox",alias:"dateInput",cssDisplay:"inline-block",required:true,constraints:{trigger:mstrmojo.validation.TRIGGER.ALL},onValid:AD,onInvalid:AD,onClearValidation:b,calendarToBody:true,autoFormat:false,calConfig:{onmousedown:function(AQ){X.stopPropogation(AQ.hWin,AQ.e);}},visible:true},{scriptClass:"mstrmojo.Label",cssClass:"attMxLabel",text:"Attribute",alias:"attMxLabel"},{scriptClass:"mstrmojo.ui.Pulldown",alias:"attMxPd",itemIdField:"did",cssClass:"conditionWalk-attMxPd",onSelectedItemChange:function AO(AR,AS){if(this.hasRendered){var AQ=this.parent.parent.parent.parent;U.call(this,AQ,AR,"c0");}},getPulldownTextInnerHTML:AH,getPopupListConfig:function AP(){var AQ=mstrmojo.ui.Pulldown.prototype.getPopupListConfig.call(this);AQ.showTooltipForLargeText=false;AQ.getItemProps=function AR(AU,AS){var AT=mstrmojo._IsList.getItemProps.call(this,AU,AS);AT.title="";AT.style=this.parent.itemCssText||"";AT.addCls("unit "+AM.getUnitCssClass(AU));return AT;};AQ.getTooltipText=I;return AQ;}}],update:function(){J(this,this.cstIndex);this.parent.updateScrollbars();},postCreate:function(){this._super();this.parent.parent.parent.attachEventListener("updateTargets",this.id,function(){this.update();});}});}function u(AN){return AN[Q]===p.Attribute&&AN[AF]===AG.AttributeRecursive;}function v(AN){var AP=AN[Q]===p.Consolidation&&AN[AF]===AG.ConsolidationManaged,AO=mstrApp&&mstrApp.rootCtrl&&mstrApp.rootCtrl.docCtrl&&mstrApp.rootCtrl.docCtrl.model;if(AP&&AO&&AO.findUnitInDataSet){AN=AO.findUnitInDataSet(AN.did);if(AN&&AN.attId){return u(AO.findUnitInDataSet(AN.attId));}}}mstrmojo.vi.ui.ConditionWalkProvider=mstrmojo.declare(mstrmojo.rw.ConditionWalkProviderBase,null,{scriptClass:"mstrmojo.vi.ui.ConditionWalkProvider",getTargetNodeProps:function j(){var AX=this;return{alias:"target",isAttribute:false,isMetric:false,showChooseMethod:true,showLevel:false,children:[{scriptClass:"mstrmojo.Label",cssClass:"baseOn",text:mstrmojo.desc(15115,"Based on")},{scriptClass:"mstrmojo.ui.SearchablePulldown",alias:"target",itemIdField:"did",cssClass:"conditionWalk-target",allowEmptyText:true,onRender:function(){if(this.hasRendered){this[this.editableSlot].setAttribute("placeholder",mstrmojo.desc(10,"Search"));}},postCreate:function(){this.parent.parent.parent.attachEventListener("updateTargets",this.id,function(){this.update();});},getEditableTextInnerHTML:function AY(){var Aa=this.selectedIndex,AZ=this.getPopupList(),Ab=AZ&&AZ.items;if(this.selectedNode&&Ab&&Ab[Aa]){return this.getPulldownTextInnerHTML(Ab[Aa]);}else{return"";}},update:function AT(){var Ac=this.parent.parent.parent,Ab=Ac.model,AZ=Ac.targetsLastMod,Af=Ab&&Ab.et;if(this.lastModel!==Ab||this.targetsLastMod!==AZ){this.lastModel=Ab;this.targetsLastMod=AZ;var Aa=Ac.targets,Ad=Ac.ets;if(Ad&&Aa&&Aa.length){var Ae=AC(Ac.ets);Aa=P.filter(Aa,function(Ak){return Ae[Ak[Q]];});}var Ai=Ab&&Ab[a[Af]],Ah=Ac.objectBrowsingEnabled,Aj=Ah&&(!Aa||P.find(Aa,"did",C)===-1);if(Af===z.ANDOR){Ai=Ab.a||Ab.m||null;}this.set("objectBrowsingEnabled",Ah);if(Aj){Aa=Aa||[];var Ag=mstrmojo.desc(15346,"Browse Metadata Objects...");Aa.push({did:C,n:Ag,t:-1,title:Ag});}L(this,true,M.getSortedObjectsByTypeGroup(Aa),Ai);if((!Ah||Aj)&&!Ai){this.set("isEditing",true);this.openPopup(this.getPopupList());}}},onitemSelected:function AO(Ab,Aa){if(this.hasRendered){var AZ=this.parent.parent.parent;U.call(this,AZ,Ab,"target");}},preisEditingChange:function AU(){if(this.hasRendered&&this.isEditing){var AZ=this.selectedNode;this._lastText=AZ.innerHTML;W.removeClass(AZ,"unit");W.removeClass(AZ,"item");}return true;},postisEditingChange:function AV(){if(this.hasRendered&&!this.isEditing){var AZ=this.selectedNode;if(this._lastText){AZ.innerHTML=this._lastText;W.addClass(AZ,"unit");W.addClass(AZ,"item");}else{AZ.innerHTML="";}delete this._lastText;}},onPopupWidgetClosed:function AW(Ab){if(this.objectBrowsingEnabled&&Ab&&Ab.pressingEnter){var AZ=this.getPopupList(),Ae=AZ._oldItems,Ad=this.text;if(Ae&&Ad){var Ac=P.filterOne(Ae,function(Af){return Af.n===Ad;});Ac=Ac||AZ.items[0];if(!Ac){delete AZ._oldItems;AZ.set("items",Ae);return ;}if(Ac.did===C){var Aa=this.parent.parent.parent;Aa.browse(this);delete AZ._oldItems;AZ.set("items",Ae);return ;}}}mstrmojo.ui.SearchablePulldown.prototype.onPopupWidgetClosed.call(this,Ab);},getPulldownTextInnerHTML:AB,getPopupListConfig:function AN(){var AZ=mstrmojo.ui.SearchablePulldown.prototype.getPopupListConfig.call(this);AZ.showTooltipForLargeText=false;AZ.getItemProps=function Aa(Af,Ad){var Ae=mstrmojo._IsList.getItemProps.call(this,Af,Ad);Ae.title="";Ae.style=this.parent.itemCssText||"";Ae.addCls("unit "+AM.getUnitCssClass(Af));Ae.addCls(Af.isInvalid?"invalid":"");return Ae;};AZ.doItemSelect=function Ab(Ag,Ad){if(Ag.did===C){var Ae=this.parent;Ae.parent.parent.parent.browse(Ae);}else{if(Ag.isInvalid){var Af=this;window.setTimeout(function(){Af.showTooltip({target:Af._getItemNode(Ag._renderIdx)},window);},0);}else{mstrmojo._IsList.doItemSelect.call(this,Ag,Ad);}}};AZ.showTooltip=function Ac(Ai,Ah){if(!this.hasOpenTooltip&&!(this._lastOpened&&this._lastOpened.visible)){var Ag=X.eventTarget(Ah,Ai),Af=this.getItemFromTarget(Ag);if(Af&&Af.isInvalid){var Ae=this.getItemNodeFromTarget(Ag),Ad=X.position(Ae);this.richTooltip={content:mstrmojo.desc(15391,"This is an invalid object. Please contact your administrator for more information."),cssClass:"vi-warning triangle-warning vi-tooltip-C A-center",left:Ad.x+168,top:Ad.y};mstrmojo._HasTooltip.showTooltip.call(this,Ai,Ah);}else{this.constructor.prototype.showTooltip.call(this,Ai,Ah);}}};AZ.tooltipOpenDelay=700;AZ.getTooltipText=I;return AZ;}},{scriptClass:"mstrmojo.Label",cssClass:"baseOn",text:mstrmojo.desc(15116,"Choose elements by"),alias:"attrLabel",bindings:{visible:"this.parent.isAttribute && this.parent.showChooseMethod"}},{scriptClass:"mstrmojo.ui.Pulldown",alias:"chooseMethodPd",items:null,visible:false,bindings:{visible:"this.parent.isAttribute && this.parent.showChooseMethod"},onitemSelected:function AO(Ac){var Ab=this.parent.fm,Aa=Ab&&Ab.cssClass,AZ=Ab&&Ab.domNode,Ad=Ab&&Ab.selectedItem;if(Ac.v===N.SELECT){W.toggleClass(AZ,"forms",false);if((Aa||"").indexOf(" forms")>-1){Ab.cssClass=Aa.replace(" forms","");}if((!Ad)||Ad.did!=="1,22"&&Ad.did!=="1,57"){Ab.singleSelectByField("1,22","did");}}else{W.toggleClass(AZ,"forms",true);if((Aa||"").indexOf(" forms")===-1){Ab.cssClass=(Aa||"")+" forms";}if(!Ad||Ad.did==="1,22"||Ad.did==="1,57"){Ab.singleSelect(2);}}Ab.updateScrollbars();},update:function AT(){var Ae=this.parent.parent.parent,Ac=Ae&&Ae.model,Aa=Ae&&Ae.disableElementsBrowsing,AZ=Ac&&Ac.a,Ab=AZ&&Aa&&Aa(AZ);if(Ab){this.set("items",[{n:mstrmojo.desc(15117,"Qualification on"),v:N.QUALIFICATION}]);}else{if(AZ.ndetype===1){this.children[0].showTooltipForLargeText=false;this.set("items",[{n:mstrmojo.desc(15118,"Selecting in list"),v:N.SELECT,ttpDisabled:true},{n:mstrmojo.desc(15117,"Qualification on"),v:N.QUALIFICATION,cls:"disabled",dsbld:true,ttp:mstrmojo.desc(16184,"This method is not available for this object type.")}]);}else{this.set("items",[{n:mstrmojo.desc(15118,"Selecting in list"),v:N.SELECT},{n:mstrmojo.desc(15117,"Qualification on"),v:N.QUALIFICATION}]);}}var Ad=this.getSelectedItem();switch(Ac.et){case z.AQ:case z.AL:case z.AC:if(!Ad||Ad.v!==N.QUALIFICATION){this.selectItemByField("v",N.QUALIFICATION);}break;default:if(!Ad||Ad.v!==N.SELECT){this.selectItemByField("v",N.SELECT);}break;}}},g({scriptClass:"mstrmojo.ui.CheckList",alias:"fm",fmPost:"",itemIdField:"did",filter:false,isFirstFm:true,multiSelect:false,minimumSelectCnt:0,hasDummyLabel:false,lastAttrId:null,height:AE-R*4-K*2-AL+"px",onchange:function AR(AZ){d.call(this,AZ,"fm");},bindings:{visible:"this.parent.isAttribute && this.parent.showChooseMethod"},onvisibleChange:function(){this.lastAttrId=null;}}),{scriptClass:"mstrmojo.Label",text:mstrmojo.desc(15119,"Output Level"),cssClass:"baseOn",alias:"metricLabel",bindings:{visible:"this.parent.isMetric && this.parent.showLevel"}},{scriptClass:"mstrmojo.ui.Pulldown",alias:"outputLevelPd",items:[{n:mstrmojo.desc(12178,"Visualization level"),v:h.TEMPLATE_LEVEL},{n:mstrmojo.desc(13519,"Dataset level"),v:h.DATASET_LEVEL}],selectedIndex:0,bindings:{visible:"this.parent.isMetric && this.parent.showLevel"},onSelectedItemChange:function AP(Aa,Ab){var AZ=this.parent.parent.parent,Ac=AZ.condition;Ac.level=Aa.v;}}],updateColumnContainer:function AQ(){this.target.update();var Ac=this.parent,Ah=Ac.parent,Ak=Ah.model,As=Ak&&Ak.et,Al=this.idx,Ap=this.next,Aq=Ak&&Ak.a,Ai=Ak&&Ak.fm,Af=Ah&&Ah.inRelation;if(As){switch(As){case z.AQ:case z.AL:case z.AC:case z.AE:case z.ANDOR:if(Aq){this.set("isMetric",false);this.set("isAttribute",true);var Ao=Ah.disableElementsBrowsing,Ab=Aq&&Ao&&Ao(Aq),Am=Ah.getAttributeInfo(Aq.did),Ag=u(Am)||v(Am),Aj=Ah.disableHierarchyLevel;if(Ag){Ak.et=z.AE;this.set("showChooseMethod",false);}var Ae=(Ak.etWas&&Ak.etWas===z.AE)?r:m,An=m;if(Ak.et===z.AE&&!Ab){An=r;}if(Ae!==An||An===m||!Ac.next){Ac.removeTrailingContainer(Al);if(An===m&&Ai){Ac.addNextColumn(AX.getFnNodeProps());}else{if(An===r){Ac.addNextColumn(AX.getEsNodeProps(Ag,Aj));}}}Ah.condition.level=h.DATASET_LEVEL;var Ar=this.fm;Ar.updating=true;Ar.update();this.chooseMethodPd.update();Ar.updating=false;}break;case z.MQ:case z.MC:if(Ak.m){this.set("isMetric",true);this.set("isAttribute",false);var Aa=Ah.isMDXDM(Ak.m.did),AZ=Ah.condition.level,Ad=Ah.editor&&Ah.editor.showLimits;if(AZ!==h.TEMPLATE_LEVEL&&AZ!==h.DATASET_LEVEL){AZ=Ah.condition.level=Ad?h.TEMPLATE_LEVEL:h.DATASET_LEVEL;}if(!Af&&!Aa&&Ad){this.set("showLevel",true);this.outputLevelPd.set("selectedIndex",AZ);}else{this.set("showLevel",false);}if(!(Ap&&Ap.fn)){this.parent.insertAndRemoveTrailing(Al,AX.getFnNodeProps());}}break;case z.R:case z.F:case z.XML:this.set("isMetric",false);this.set("isAttribute",false);Ah.condition.level=h.DATASET_LEVEL;this.parent.removeTrailingContainer(Al);break;}}else{this.set("isMetric",false);this.set("isAttribute",false);}E.call(this);},setupScrollNodes:function AS(){this.scrollNode=null;}};},getEsNodeProps:function A(AU,AP){var AT=AU?"HierarchyElementsCheckListBrowser":"ElementsBrowser",AO=[{scriptClass:"mstrmojo.vi.ui."+AT,alias:"es",height:AE-5+"px",disableLevel:AP,update:function AS(){var AY=this.parent.parent.parent,AZ=AY.model,AX=AZ&&AZ.a,AW=!!AX&&!AX.ilk;if(!AW){return ;}this.set("ifDataSource",AY.getIfDataSource());this.onUpdateBrowseElementsParams=function(Ac){AY.onUpdateBrowseElementsParams(Ac);};if(!AZ.es){AZ.es=[];}if(AU){var Ab=AY.getAttributeInfo(AX.did);Y.copyProps(["t","st"],Ab,AX);if(Ab&&Ab.attId){Ab=AY.getAttributeInfo(Ab.attId);}Y.copyProps(["fs","lvfs"],Ab,AX);}else{if(!AX.fs){Y.copyProps(["fs"],AY.getAttributeInfo(AX.did),AX);}}var Aa=Y.clone(AU?AZ.data:AZ.es);this.set("attribute",AX);this.set("selectedItems",Aa);},onBrowseElementsFailure:function AN(){var AZ=this.attributeId,AW=this.parent.parent,AY=AW.parent,AX=P.filterOne(AY.targets,function(Ab){return Ab.did===AZ;});AX.isInvalid=true;AX.cls=(AX.cls||"")+" invalid";AY.set("model",{et:5,isNew:true,defaultETAttr:5});var Aa=AW.target.target;Aa.openPopup(Aa.getPopupWidget());},onItemsSelectionChange:function AV(AW){var AX=this.parent.parent.parent,AY=AX.model;AY.edit(AU?"data":"es",AW);}}];return{alias:"es",children:AO,cssClass:"lastStage",updateColumnContainer:function AQ(){this.es.update();},setupScrollNodes:function AR(){this.scrollNode=null;}};},getFnNodeProps:function c(){var AR=this,AO=[{scriptClass:"mstrmojo.Label",cssClass:"baseOn",text:mstrApp.isWSStyling?mstrmojo.desc(15006,"Operator"):mstrmojo.desc(9579,"Condition")},{scriptClass:"mstrmojo.ui.Pulldown",alias:"fnTypePulldown",items:[{n:mstrmojo.desc(15302,"By Value"),v:V.VALUE},{n:mstrmojo.desc(15303,"By Rank"),v:V.RANK_PERCENTAGE}],onSelectedItemChange:function AS(AU,AW){var AV=this.parent;AV.fn.update();}},g({scriptClass:"mstrmojo.ui.CheckList",alias:"fn",multiSelect:false,allowUnlistedValues:false,hideCheckMark:true,itemIdField:"did",onchange:function AN(AU){d.call(this,AU);},update:function(){var AW=this.parent,Aa=AW.parent.parent,AV=Aa.model||{},Ab=AV.et,AZ,Ac=false,Ad,AU,Af=V.BOTH;switch(Ab){case z.AE:Ac=!!AV.a;break;case z.AQ:case z.AC:case z.AL:Ac=!!(AV.fm&&AV.fm.did);AZ=Ac?AV.fm.dtp:null;break;case z.MQ:case z.MC:Ac=!!AV.m;AZ=Ac?M.METRIC_DTP:null;Af=AW.fnTypePulldown.getSelectedItem().v;break;}if(!Ac){return ;}var Ae=o[AZ];if((this.lastEt!==Ab)||(this.lastFnDtp!==Ae)||(this.lastFnTypeToDisplay!==Af)){this.lastEt=Ab;this.lastFnDtp=Ae;this.lastFnTypeToDisplay=Af;var AY=Ab?w[Ab]:null,AX=AY&&AY.key;Ad=(AX&&Aa[AX])||AY.def||[];if(typeof (Ad)==="object"){Ad=Ad[Ae]||Ad["*"];}if(Af!=V.BOTH){Ad=P.filter(Ad,function(Ag){var Ah=Ag.tp===n.PER||Ag.tp===n.RANK;return Af===V.RANK_PERCENTAGE?Ah:!Ah;});}AU=AJ(AV.fn,AV.fnt||1);AU=P.filterOne(Ad,function(Ag){return Ag.did===(AU&&AU.did);});q(this,Ac,Ad,AU);if(!AU){this.set("selectedIndex",0);}}this.parent.updateScrollbars();}})];return{alias:"fn",children:AO,updateColumnContainer:function AT(){var Ac=this.parent,AY=Ac.parent,AX=AY.model,AZ=AX&&AX.fn,Ab=AX&&AX.fnt,Aa=AX&&AX.et,AW=this.next,AV=AZ===Z.IS_NULL||AZ===Z.IS_NOT_NULL,AU=(Aa===z.MC||Aa===z.MQ);this.changeFnTypePdVisibility(AU);if(AU){this.fnTypePulldown.getPopupList().singleSelectByField((Ab===n.RANK||Ab===n.PER)?V.RANK_PERCENTAGE:V.VALUE,"v");}else{this.fn.update();}if(AZ&&AV){Ac.removeTrailingContainer(this.idx);}else{if(AZ&&!(AW&&AW.c0)){Ac.insertAndRemoveTrailing(this.idx,AR.getC0NodeProps());}}AW=this.next;if(AW){AW.updateColumnContainer();}},changeFnTypePdVisibility:function AQ(AV){this.fnTypePulldown.set("visible",AV);var AU=AE-AL-R;if(AV){AU-=(R+K);}this.fn.set("height",AU+"px");},setupScrollNodes:function AP(){this.scrollNode=null;}};},getC0NodeProps:function O(){var AP=this;return{alias:"c0",children:[{scriptClass:"mstrmojo.Label",cssClass:"baseOn",text:mstrmojo.desc(527,"Value")},k({alias:"c0",cstIndex:0}),{scriptClass:"mstrmojo.Label",alias:"btwn",cssClass:"btwn",text:mstrmojo.desc(308,"and"),visible:false},k({alias:"c1",cstIndex:1,visible:false}),{alias:"browseLink",scriptClass:"mstrmojo.Label",cssClass:"mstrmojo-walkstep-browse",text:mstrmojo.desc(7926,"Browse..."),onclick:function(){this.parent.parent.parent.browse(this.parent.c0);},visible:false},g({scriptClass:"mstrmojo.ui.CheckList",alias:"fm2",fmPost:2,itemIdField:"did",filter:false,multiSelect:false,minimumSelectCnt:0,hasDummyLabel:false,height:AE-R*4-K*2-AL+"px",onchange:function AN(AR){d.call(this,AR,"fm2");}})],updateColumnContainer:function AQ(){this.c0.update();var Aa=this.parent,AW=Aa.parent,AV=Aa.parent.model,AY=AV&&AV.fn,AR=AY===Z.BETWEEN||AY===Z.NOT_BETWEEN||AY===S.BETWEEN||AY===S.BETWEEN_DESCENDING,AX=AY===Z.EQUAL||AY===Z.NOT_EQUAL||AY===Z.GREATER||AY===Z.GREATER_EQUAL||AY===Z.LESS||AY===Z.LESS_EQUAL,AZ=this.idx,AU=this.next;this.browseLink.set("visible",AW.objectBrowsingEnabled&&AI(AV,AW.ets));this.btwn.set("visible",AR);var AT=this.c1;AT.set("visible",AR);if(AR){AT.update();}else{if(AV.c1){AV.edit("c1",{v:null,dtp:null,skipET:true},true);}}if((!AV.a)&&AV.m&&this.domNode){W.addClass(this.domNode,"lastStage");}var AS=this.fm2;if(AV.a2&&AX){AS.update();AS.set("visible",true);}else{AS.set("visible",false);}E.call(this);},setupScrollNodes:function AO(){this.scrollNode=null;}};},browseObjs:function AA(AS,AR,AU){var AQ=X.position(AS.parent.containerNode);AU=AU||{};AU.x=AQ.x+40;AU.y=AQ.y;this._super(AS,AR,AU);var AO=AS.ob.browser,AN=AS.parent.opener.docModel,AP=AR.alias,AT=AS.model.et;AN.controller.rootCtrl.loadDataProvider(function(AV){if(AP==="target"||AT===z.AQ){AO.rootFolder={did:"6F55FB47F9974EABA18CB0C5FF46785C"};}else{if(AT===z.MQ){AO.rootFolder={did:"E0CCB9CF22104A489CBE78D974AFD19E"};}}AO.model=AN;AO.set("dataProvider",AV);AO.set("opened",true);});}});}());(function(){mstrmojo.requiresCls("mstrmojo.ListBase","mstrmojo._IsList","mstrmojo.vi.ui.DatasetUnitMenuUtils");var B=mstrmojo.vi.ui.DatasetUnitMenuUtils;mstrmojo.vi.ui.UnitList=mstrmojo.declare(mstrmojo.ListBase,[mstrmojo._IsList],{scriptClass:"mstrmojo.vi.ui.UnitList",init:function C(D){this._super(D);mstrmojo.css.addWidgetCssClass(this,"mstrmojo-VIUnitList");},getItemProps:function A(F,D){var E=this._super(F,D);E.addCls("unit "+B.getUnitCssClass(F));return E;}});}());(function(){mstrmojo.requiresCls("mstrmojo.hash","mstrmojo.array","mstrmojo.elementHelper","mstrmojo.mstr.EnumFunction","mstrmojo.mstr.EnumDSSConsolidationType","mstrmojo.mstr.EnumDSSXMLObjectTypes","mstrmojo.mstr.EnumDSSXMLObjectSubTypes","mstrmojo.rw.xtab.XtabMenuConfig","mstrmojo.vi.ui.DatasetUnitMenuUtils","mstrmojo.vi.ui.NumberFormatterEditor","mstrmojo.vi.ui.CalculationMenuEditor","mstrmojo.vi.enums.EnumDerivedElementType","mstrmojo.array");mstrmojo.requiresDescs(14388,14717,13355,12197,15356,15599);var W=mstrmojo.hash,j=mstrmojo.array,V=mstrmojo.dom,f=mstrmojo.elementHelper,b=mstrmojo.vi.enums.EnumDerivedElementType,o=mstrmojo.vi.ui.DatasetUnitMenuUtils,O=mstrmojo.mstr.EnumFunction,D=mstrmojo.mstr.EnumDSSConsolidationType,F=mstrmojo.mstr.EnumDSSXMLObjectTypes,Z=mstrmojo.mstr.EnumDSSXMLObjectSubTypes,e=mstrmojo.vi.enums.EnumFeatures;var G=mstrmojo.rw.xtab.XtabMenuConfig.ACTION_TYPES,m=G.GROUP,h=G.CALCULATION,d=2,C=3,U=1;function Q(){return mstrApp.isAppStatePresentation();}function R(r){if(!r||!r.items||!r.data||!r.xtab){return{};}var x=new mstrmojo.ui.menus.MenuConfig({supportsScroll:true,isHostedWithin:false,alignWithAnchor:true,maxHeight:350}),t=r.items,v=r.data,w=r.xtab,u=[];if(mstrmojo.resolveFeature("sort-drill-paths")){t.sort(function(AA,z){if(AA.n>z.n){return 1;}if(AA.n<z.n){return -1;}return 0;});}t.forEach(function(AA,z){if(u.indexOf(AA.id)===-1){u.push(AA.id);if(AA.att){x.addPopupMenuItem(AA.n,this.id,R,"xt",{items:t[z].att,data:v,xtab:w});}else{x.addMenuItem(AA.n,"xt",function(){w.drill(v,t[z]);});}}});return x;}function q(AA){var AG=AA.xtab,v=AA.data,w=AG.model,z=w.getAllDrillWithinPathsForCell(v,undefined,true),AB=z.length,x=w.docModel,t=x.datasets[w.data.datasetId],AH,AC=[],AE=-1,AD,AF,u,r;if(t&&x.isMDXDataset(t)){z.sort(function(AJ,AI){AJ.did=AJ.id;AI.did=AI.id;if(AJ.id<AI.id){return -1;}if(AJ.id>AI.id){return 1;}return 0;});AH=t.tables[0];AH.dimensions.forEach(function(AI){u=true;AD=-1;AI.hierarchies.forEach(function(AJ){r=true;AJ.att.forEach(function(AK){if(AK){AF=j.findBin(z,AK,"did",AB);if(AF!==-1){if(u){AC.push({id:AI.did,n:AI.n,att:[]});AE++;u=false;}if(r){AC[AE].att.push({id:AJ.did,n:AJ.n,att:[]});AD++;r=false;}AC[AE].att[AD].att.push(z[AF]);}}});});});}else{AC=z;}return R({items:AC,data:v,xtab:AG});}function k(t){var w=new mstrmojo.ui.menus.MenuConfig({supportsScroll:true,maxHeight:250});var v=t.xtab,u=t.deObject,r=t.groups;r.forEach(function(z,x){if(z.t===b.LIST&&!z.ido){w.addMenuItem(z.n,"",function(){v.addElementsToGroup(u,r[x],x,v.getContextMenuSelections());});}});return w;}function l(t){var r=t&&t.des;return !!r&&r.some(function(u){return(u.t===b.LIST&&!u.ido);});}function g(r,x,u){var t=false,w=undefined;if(x){t=!f.isNonGroupNull(r.data)&&this.isActionAvailable(r.data,m)&&r.de===undefined;}else{if(u){var v=M.call(this,r);t=v.isActionAvailable;w=v.group;}}return{isAddToGroupSupported:t,group:w};}function M(t,u){var v,x=undefined,w=t.xtab,AA=0,z=w.cmSelCells;var r=z.filter(function(AB,AC){return z.indexOf(AB)===AC;});v=!r.some(function(AB){var AC=w.getCellForNode(AB);if(!f.isNonGroupNull(AC)&&this.isActionAvailable(AC,m)){if(AC.dei!==undefined){x=w.getDEInfo(AC).de;if(x.t!==b.LIST||++AA>1){return true;}}return false;}else{return true;}},this);if(u){v=(v)?!!x:v;}return{isActionAvailable:v,group:(v)?x:undefined};}function P(r){var t=r.xtab;return !t.cmSelCells.some(function(u){var v=t.getCellForNode(u);return f.isNonGroupNull(v)||!this.isActionAvailable(v,m)||v.dei!==undefined;},this);}function I(t){var r;return !t.cmSelCells.some(function(u){r=t.getCellForNode(u);return(f.isNonGroupNull(r)||!this.isActionAvailable(r,h));},this);}function X(v){var r=o.generateNumberFormat(v&&v.de&&v.de.nf),w=W.clone(r),z=W.clone(r),t=new mstrmojo.ui.menus.EditorConfig({contents:new mstrmojo.vi.ui.NumberFormatter({myData:w,oldData:z,formatValue:r}),data:w}),u=this.delegateActionToXtab;W.make(w,mstrmojo.Obj);W.make(z,mstrmojo.Obj);t.fnOk=function x(){u(v,"editQuickDECalculationNumberFormat",W.copy(this.data,{de:v.de}));};return t;}function a(w){var AH=new mstrmojo.ui.menus.MenuConfig(),AA=4,AK=5,AF=6,t=7,AI=" - ",z=" / ",AC={SINGLE:[{n:mstrmojo.desc(358,"Absolute"),v:O.FunctionAbs}],PAIR:[{n:mstrmojo.desc(6017,"Add"),v:O.FunctionAdd},{n:mstrmojo.desc(2122,"Average"),v:O.FunctionAverage},{n:mstrmojo.desc(5868,"Least"),v:O.FunctionLeast},{n:mstrmojo.desc(5869,"Greatest"),v:O.FunctionGreatest},{n:"A-B",v:O.FunctionMinus+";0"},{n:"B-A",v:O.FunctionMinus+";1"},{n:"A/B",v:O.FunctionDivide+";0"},{n:"B/A",v:O.FunctionDivide+";1"}],MORE:[{n:mstrmojo.desc(6017,"Add"),v:O.FunctionAdd},{n:mstrmojo.desc(2122,"Average"),v:O.FunctionAverage},{n:mstrmojo.desc(5868,"Least"),v:O.FunctionLeast},{n:mstrmojo.desc(5869,"Greatest"),v:O.FunctionGreatest}]},AG=w.isEdit,AJ=AG&&w.de,AN=w.data,AL=AJ&&AJ.es,AM=w.xtab,AE=AG?(AL&&AL.length):AM.getCxtMnuSelectionSize(),r=(AE===1)?"SINGLE":((AE===2)?"PAIR":"MORE"),AD=AC[r],x=(AJ&&AJ.func),v;if(r==="PAIR"){if(AG&&AJ){AD[AA].n=AL[0].n+AI+AL[1].n;AD[AK].n=AL[1].n+AI+AL[0].n;AD[AF].n=AL[0].n+z+AL[1].n;AD[t].n=AL[1].n+z+AL[0].n;}else{v=this.xtab.cmSelCells;var u=v[0].innerText||v[0].textContent,AB=v[1].innerText||v[1].textContent;AD[AA].n=u+AI+AB;AD[AK].n=AB+AI+u;AD[AF].n=u+z+AB;AD[t].n=AB+z+u;}}AD.forEach(function(AO){var AQ=AO.v,AP=AG&&((typeof AQ==="string"&&AQ.indexOf(x)===0&&AQ.indexOf(";0")>0)||AQ===x);AH.addMenuItem(AO.n,"xt "+(AP?"checked":""),function(){var AS=w.xtab,AR=AJ&&AJ.func;if((AJ&&AR===AQ)||(typeof AQ==="string"&&AQ.indexOf(AR)===0&&AQ.indexOf(";0")>0)){return ;}if(w.isEdit===true){AS.editDECalculation(AN,AQ);}else{AS.derivedElementCalculation(AN,AQ);}});},this);return AH;}function A(u){var AI=u.xtab,z=u.data,AC=AI.model,x=AC.getCellTitleInfo(z),AJ=AC.isRecursiveAttribute(z.id||x.title.id),AB=AI.getDEInfo(z),w=AB&&AB.deObject,AH=AB&&AB.de,AD=AH&&AH.t,AF=w&&AI.getOthersDEInfo(w),t=u.singleCellClick,AA=AI.isSingleContextMenuAttrSelection(),AE=true,v=AI.getContextMenuSelections(),r=AI.isSingleContextMenuSelection(),AG={de:AH,xtab:AI,data:z,td:u.td,singleClick:t};if(AF&&!r&&AA){v.forEach(function(AK){if(AK[0]&&AK[0].eid.indexOf(AF.id)>-1){AE=false;return false;}});}if(!mstrApp.isInVFConfigMode&&(t||AA)&&this.isActionAvailable(z,h)&&I.call(this,AI)&&mstrmojo.resolveFeature(e.INSERT_NEW_METRIC)){if(!AJ&&!(r&&AD===b.RESIDUE)&&AE){this.addSubMenuItem(mstrmojo.desc(5188,"Calculation"),"",this.id,a,W.copy(AG,{isEdit:false}));}else{if(AJ&&r&&!AD&&!z.ln){this.addMenuItem(mstrmojo.desc(15356,"Calculated Member..."),"",function(){AI.derivedElementCalculation(z,O.FunctionApplySimple);});}}}if(!mstrApp.isInVFConfigMode&&r&&AJ&&AD===b.CALCULATION){this.addMenuItem(mstrmojo.desc(15366,"Delete Calculated Member"),"",function(){this.delegateActionToXtab(AG,"removeQuickDE",AB);}.bind(this));this.addMenuItem(mstrmojo.desc(15599,"Edit Calculated Member..."),"",function(){this.delegateActionToXtab(AG,"derivedElementsEdit",[AB]);}.bind(this));}}function S(){var w=this.xtab,r=w.model,u=this.selectedData,t=w.getContextMenuSelections(),v=!u.olap;if(t.length>0){t.forEach(function(x){x.forEach(function(z){v=v&&r.supportsViewFilterActions(z.tid);});});}else{v=v&&r.supportsViewFilterActions(r.getCellTitleInfo(u).title.id);}if(u.mix!==undefined){v=v&&r.getCellDataUnion(u).every(function(x){return r.supportsViewFilterActions(x.tid);});}return v;}function c(r){return r&&r.mix!==undefined&&!!r._e;}function Y(r){return r&&r.otp===F.Attribute;}function E(r){return r&&r.otp===F.Consolidation&&r.ost===Z.ConsolidationManaged;}function n(r){var x=r.data,z=this.xtab,u=z.model,AA=c(x),w=AA?x._e:u.getCellTitleInfo(x).title,t=!AA&&w.otp===-1,v;if(t){j.forEach([x._lp,x._tp],function(AC){var AD=AC;while(AD&&AD!==AD._p&&!v){if(AD.stt){continue;}var AB=u.getCellTitleInfo(AD),AG=AB.title,AF=AG&&AG.id;if(AF&&AG.ost===12033){var AE=z.getDEInfo(AD),AH=AE&&AE.de;if(AH&&AH.t===b.CALCULATION&&AH.nf&&Object.keys(AH.nf).length>0){v={de:AH,xtab:z,data:AD,td:r.td,singleClick:r.singleClick};break;}}AD=AD._p;}return !v;});}if(!v){if(t){w={oid:u.data.gsi.mx[x.mix].did,otp:4};}v={did:w.oid||w.id,t:w.otp,stp:w.ost,fs:w.fs};}return v;}function K(u,r){var t=u&&r.td&&u.getCellForNode(r.td);if(c(t)){t.id=t._e.oid;t.otp=t._e.otp;}return t;}function B(u){var v=u.de?u:n.call(this,u),w=v.de,x=u.xtab,t=x.model,AB,r,AA,z=t.id;if(w){if(x.isSingleSelection()&&w.t===b.CALCULATION&&w.func!==O.FunctionApplySimple){AB=true;AA=v;r=X;z=this.id;}}else{AB=t.showNumberFormat(v);AA={item:v};r=t.getNumberFormatEditorCfg;}if(AB){this.addEditorMenuItem(mstrmojo.desc(13237,"Number Format"),z,r,AA);}}function p(u,r){var t=this.delegateActionToXtab;if(Y(u)||(u.otp===47&&u.ost===12033)){this.addMenuItem(mstrmojo.desc(14655,"Expand All Levels"),"",function(){t(r,"raExpandAll",[true]);});this.addMenuItem(mstrmojo.desc(14656,"Collapse All Levels"),"",function(){t(r,"raExpandAll",[false]);});}else{this.addMenuItem(mstrmojo.desc(14669,"Expand All Lower Levels"),"",function(){t(r,"raExpandDescendants");});}}mstrmojo.vi.ui.rw.xtab.XtabMenuConfig=mstrmojo.declare(mstrmojo.rw.xtab.XtabMenuConfig,null,{scriptClass:"mstrmojo.vi.ui.rw.xtab.XtabMenuConfig",buildXtabMenuConfig:function N(AJ){var AH=this.xtab=AJ.xtab,Aj=Q(),z=AH.model,At=this.selectedData=AJ.data=AJ.data||K(AH,AJ),Ar=o.getDatasetFromAttributeId(z.docModel.datasets,At.id),AX=At.stt===1,Ad=AH.getCellForNode(AJ.td),AB=z.isSubtotalValue(Ad),Aa=At.otp,Am=At.ost,Ao=z.getCellTitleInfo(At),Ag=AH.zonesModel,Af=Ag.id,v=Ag.docModel,Ap=this.delegateActionToXtab,Aq=AH.isSingleContextMenuAttrSelection(),AC=AJ.singleCellClick,AW=S.call(this),Al=AH.getDEInfo(At),AT=Al&&Al.deObject,AE=Al&&Al.de,AK=AE&&AE.t,Ai=z.isRecursiveAttribute(At.id||Ao.title.id),w=AH.isSingleContextMenuSelection(),AD=mstrmojo.desc(190,"Remove"),AP,AM,AL=!Ar||!v.isMDXDataset(Ar),As=AH.isInFilterPanel()&&mstrApp&&mstrApp.isInVFInteractMode,Ac={did:At.id||AT&&AT.did,t:Aa||AT&&AT.t,st:Am||AT&&AT.st,attId:AT&&AT.attId,ndetype:AT&&AT.ndetype},AU=Ac.attId&&E(At)&&z.getNDEFormsFromDataset(Ac.attId),u={n:At.n,did:At.id,t:Ac.t,st:Ac.st,ndeForms:AU},Ab={de:AE,ndeInfo:u,xtab:AH,data:At,cfg:AJ,td:AJ.td,singleClick:AC},AF=AH.isCustomSort;this.selectedNode=AJ.td;if(AJ.onClose){this.addPopupHandlers(AH.id,mstrmojo.emptyFn,AJ.onClose);}if(!AB){if(AF){if(Ai&&!AX){p.call(this,At,Ab);}}else{if(As){this.addSortMenuItem(Ab);return ;}var AO=AH.model.getAttributeFormsInTemplate(At.id||Ao.title.id).length,x=At.fix;if(AO>1&&(!Al||Ac.ndetype===D.DssRecursiveDerivedElement)){var AA="pivot";var Ak=AT&&AT.t||Aa||"";var AG=!Aj&&!mstrApp.isInVFConfigMode&&w&&AK===b.LIST;if(!Y(At)&&!E(At)&&!AG){x=Ao.title.fix||(Ab.data.fi||0)+1;AA+="Form";}if(x&&!AX&&!mstrApp.isDossier){if(x>1){this.addMenuItem(mstrmojo.desc(5362,"Move Left"),"",function(){Ap(Ab,AA,["l",Ak]);});}if(x<AO){this.addMenuItem(mstrmojo.desc(5363,"Move Right"),"",function(){Ap(Ab,AA,["r",Ak]);});}this.addSeparator();}}if(Ai&&!AX){p.call(this,At,Ab);}if(!Aj&&!mstrApp.isInVFConfigMode){if(c(At)&&At.um){this.addMenuItem(mstrmojo.desc(3224,"Edit..."),"",function(){Ap(Ab,"derivedMetric",["edit"]);});}if(Y(At)){if(AH.getDerivedAttribute(At.id)&&AL){this.addMenuItem(mstrmojo.desc(3224,"Edit..."),"",function(){Ag.editDerivedAttribute({item:{did:Ac.did,t:Ac.t,n:At.n}});});}}if(this.isActionAvailable(At,G.GROUP_EDIT)&&AT){this.addMenuItem(mstrmojo.desc(13296,"Edit Groups..."),"",function(){Ap(Ab,"derivedElementsEdit",[Al]);});}if(w&&AK===b.CALCULATION&&!Ai){this.addSubMenuItem(mstrmojo.desc(12196,"Edit Calculation"),"",this.id,a,W.copy(Ab,{isEdit:true}));}}this.addSeparator();this.addSortMenuItem(Ab);if(AH.model.getAllDrillPathsForCell(At).length>1){this.addSeparator();}if(!Aj&&!mstrApp.isInVFConfigMode){if(w&&AK===b.LIST){this.addSeparator();this.addMenuItem(mstrmojo.desc(13395,"Edit Group..."),"",function(){Ap(Ab,"derivedElementsEdit",Al);});}if(w&&AK===b.LIST){this.addMenuItem(mstrmojo.desc(12195,"Ungroup"),"",function(){Ap(Ab,"removeQuickDE",Al);});}if(w&&AK===b.RESIDUE){this.addMenuItem(mstrmojo.desc(12195,"Ungroup"),"",function(){Ap(Ab,"separateOthers",[AE]);});}if(Y(At)&&!Ag.isDynamicLink(Ac)){this.addSeparator();if((!Ar||!o.isCGorCon(Ac,Ar))&&AL&&mstrmojo.resolveFeature(e.INSERT_NEW_METRIC)){this.addMenuItem(mstrmojo.desc(13625,"Create Attribute..."),"",function(){Ap(Ab,"newDerivedAttribute");});this.addMenuItem(mstrmojo.desc(14717,"Create Links..."),"",function(){Ap(Ab,"newDynamicLinkAttr");});}if(this.isActionAvailable(At,G.GROUP_EDIT)&&!AT){this.addMenuItem(mstrmojo.desc(13295,"Create Groups..."),"",function(){Ap(Ab,"derivedElementsEdit",[Al]);});}this.addSeparator();}}if(AH.isLinkedFilterEnabled&&AH.isLinkedFilterEnabled()){var t=function(){AH.handleContextMenuSelectionData(true);};this.addSeparator();this.addMenuItem(mstrmojo.desc(15070,"Go to Targets"),"",t);}if(!AX&&this.isActionAvailable(At,G.KEEP_ONLY)&&AW){this.addSeparator();var AR=function(Av){return function(){Ap(Ab,"keepOnlyOrExclude",[Av]);};};if(!mstrApp.isInVFInteractMode){this.addMenuItem(mstrmojo.desc(11701,"Keep Only"),"",AR(true));this.addMenuItem(mstrmojo.desc(3946,"Exclude"),"",AR(false));}}if(!AX&&!(mstrApp.isInVFConfigMode||mstrApp.isInVFInteractMode)&&!Ai&&mstrmojo.resolveFeature(e.WEB_DRILL_AND_LINK)){this.addDrillMenuItem(Ab);}if(At&&At.mix===undefined&&Ao.isSrcTitle&&Aa!==-1&&Aa!==1&&!(Aa===47&&Am===12032)){this.addShowTotalMenuItem(Ab);}var AY=At.axis;if(!Aj){if(Ag.shouldShowDisplayFormsMenu(Ac)){this.addPopupMenuItem(mstrmojo.desc(11908,"Display Attribute Forms"),this.id,function(){return o.getDisplayFormsMenu(Ac,AH,AH.model.docModel.datasets,function(Av){Ag.submitDropZoneUpdates(Av);});});}this.addSeparator();if(!mstrApp.isInVFConfigMode&&(AC||Aq)&&this.isActionAvailable(At,m)&&P.call(this,Ab)&&mstrmojo.resolveFeature(e.INSERT_NEW_METRIC)){this.addMenuItem(mstrmojo.desc(1911,"Group"),"",function(){Ap(Ab,"derivedElementGroup");});}var Ae=l(AT)&&g.call(this,Ab,w,Aq);if(!!Ae.isAddToGroupSupported){this.addAddToGroupMenuItem(Ab.xtab,AT,Ae.group);}if(!mstrApp.isInVFConfigMode&&c(At)&&mstrmojo.resolveFeature(e.INSERT_NEW_METRIC)){var AS=AH&&AJ.td&&AH.getCellForNode(AJ.td)._e,An={did:AS.oid,t:AS.otp},AV={zone:{id:-1,items:AH.model.data.gsi.mx},axis:AY,idx:At.idx,item:An};this.addSeparator();if(v.findDatasetIdFromUnit(An.did)&&!v.isFromSolrCube(An.did)&&!v.isFromMDXCube(An.did)){this.addSubMenuItem(mstrmojo.desc(11806,"Aggregate By"),"",Af,Ag.getAggregateByMetricSubMenu,AV);this.addSeparator();}this.addSubMenuItem(mstrmojo.desc(5188,"Calculation"),"",Af,Ag.getCalculationEditorCfg,AV);this.addSubMenuItem(mstrmojo.desc(12287,"Shortcut Metric"),"",Af,Ag.getShortcutMetricSubMenu,AV);this.addMenuItem(mstrmojo.desc(13624,"Create Metric..."),"",function(){Ap(Ab,"derivedMetric",["editNew"]);});}if(!c(At)&&!Aa&&mstrmojo.resolveFeature(e.INSERT_NEW_METRIC)){A.call(this,AJ);}this.addSeparator();if(!AX){B.call(this,Ab);}if(c(At)||Y(At)){this.addThresholdMenuOptions(Ab);}}if(c(At)){this.addToggleMenuItem(mstrmojo.desc(6193,"Show Totals"),"",function(){Ag.showQuickSubtotals();},function(){Ag.hideDefinedSubtotals();},null,Ag.hasVisibleSubtotals());}if(!AX&&this.isActionAvailable(At,G.KEEP_ONLY)&&AW&&!mstrApp.isDossier&&!AH.excludeData){this.addSeparator();this.addMenuItem(mstrmojo.desc(13537,"Show Data..."),"",function(){mstrmojo.vi.ui.ViewDataDialog.open(AH.parent,true);});}var r=AH.gridData.gts,Ah,AQ=[r.rowSubPos,r.colSubPos],AZ,Au;if(AX){Au=AY===U;AZ=AQ[AY-1];if(AZ===d){Ah=Au?mstrmojo.desc(12206,"Move to Bottom"):mstrmojo.desc(13900,"Move to Right");AQ[AY-1]=C;}else{Ah=Au?mstrmojo.desc(12205,"Move to Top"):mstrmojo.desc(13901,"Move to Left");AQ[AY-1]=d;}this.addMenuItem(Ah,"",function(){z.moveSubTotals(Ab,AQ);});}if(this.isActionAvailable(At,G.TOTAL_HEADER)&&At.mix===undefined){AP=function(){Ap(Ab,"removeTotal");};}if(!Aj&&w){if(AK===b.LIST){AM=function(){Ap(Ab,"renameDEList",Al);};}else{if(AK===b.CALCULATION&&!mstrApp.isInVFConfigMode){AM=function(){this.delegateActionToXtab(Ab,"editDECalculation");}.bind(this);AP=function(){this.delegateActionToXtab(Ab,"removeQuickDE",Al);}.bind(this);AD=mstrmojo.desc(12197,"Delete Calculation");}}}this.addSeparator();}}if(!Aj&&!AF){var AN=AH.parent;if(AN.addFormatMenuItem){AN.addFormatMenuItem(this,{info:Ao,isMetricHeader:c(At)},function(Av){var Aw=AH.highlightFormatTarget(Av,AX||AB);AH.openPopup(AH.edtModel.getFormattingToolbar(Av,AJ.td,{onClose:function(){AH.restoreHighlights(Aw);}}));});}}if(!AB&&!AF){if(((Ao&&Ao.isSrcTitle)||c(At))&&(!Aj||!!mstrmojo.resolveFeature(e.WEB_DRILL_AND_LINK))){this.addPopupMenuItem(mstrmojo.desc(14003,"Replace with"),Af,Ag.getReplaceSubMenu,"",{zone:Ag.getZoneForObject(Ao.title.id||At.id),item:Ac});}if(AM){this.addMenuItem(mstrmojo.desc(2453,"Rename..."),"",AM);}if(AP&&!(Ai&&AK===b.CALCULATION)){this.addMenuItem(AD,"",AP);}if(!Aj){if((Ao&&Ao.isSrcTitle)||c(At)){if(!AM){this.addMenuItem(mstrmojo.desc(2453,"Rename..."),"",function(){Ap(Ab,"renameUnit");});}if(!AP){this.addMenuItem(AD,"",function(){Ap(Ab,"removeUnit");});}}}var AI=W.walk("node.data.olm",AH)&&!(W.walk("node.data.rw.row.bc",AH)>0);if(AH.isCopySupported&&!AX&&!Y(At)&&!c(At)&&!AI){this.addSeparator();this.addMenuItem(mstrmojo.desc(14388,"Copy Rows"),"",function(){Ap(Ab,"copyRowsFromXtab",[AH.cmSelCells]);});}}this.supportsScroll=true;this.isHostedWithin=false;this.maxHeight=V.getMaxScrollHeight();},addAddToGroupMenuItem:function(v,t,u){var r=(t&&t.des)||[];this.addPopupMenuItem(mstrmojo.desc(14553,"Add to Group"),this.id,k,"",{xtab:v,deObject:t,groups:u?[u]:r});},addDrillMenuItem:function J(r){var w=r.xtab,v=r.data,t=w.model.getUnHiddenDrillPathsForCell(v),u=t.length;if(!(c(v)||v.mix!==undefined)){if(u>1){this.addSubMenuItem(mstrmojo.desc(145,"Drill"),"",this.id,q,r);}else{if(u===1){this._super(r,t[0]);}else{this.addNonInteractiveMenuItem(mstrmojo.desc(145,"Drill"),"",true);}}}},getSubtotalEditorConfig:function H(t){var r=this._super(t),u=t.data,v=t.xtab;r.fnOk=v.getOnSubtotalsChangeFn(r,u);return r;},addThresholdMenuOptions:function L(t){var r=t.data._e||t.data,u={did:r.oid||r.id,t:r.otp,n:r.n};this.xtab.model.buildThresholdMenuOptions(this,{item:u},false,true);}});}());(function(){mstrmojo.requiresCls("mstrmojo.Editor","mstrmojo.ui.SearchablePulldown","mstrmojo.vi.ui.DatasetUnitMenuUtils","mstrmojo.hash","mstrmojo.array","mstrmojo.string","mstrmojo.DataGrid");var B=" ReplaceObjectEditor-item ",L={REMOVE:1,KEEP:2,NO_REPLACE:3},F=mstrmojo.hash,H=mstrmojo.array,M=mstrmojo.string,A=mstrmojo.vi.ui.DatasetUnitMenuUtils,I="did";function E(O){return O.t===47&&O.st===12033;}function K(R,Q){var O=[],P=function(S){return H.find(R.cubes,"did",S)>-1;};if(R.da||R.um||R.de||E(R)){O.push({n:mstrmojo.desc(11832,"Keep existing definition"),did:L.KEEP,cls:B});}if(!Q.source.all&&R.cubes.length>1&&!(R.cubes.length===2&&P(Q.source.did)&&P(Q.target.did))){O.push({n:mstrmojo.desc(11834,"Do not replace"),did:L.NO_REPLACE,cls:B});}O.push({n:(typeof (mstrApp)!=="undefined"&&mstrApp.pageName==="rwd")?mstrmojo.desc(14556,"Remove from document"):mstrmojo.desc(15472,"Remove from dossier"),did:L.REMOVE,cls:B});return O;}function C(U,P){var O={id:null,n:null,k:null,nr:null,r:null},S,R,Q;for(Q=0;Q<P.length;Q++){S=P[Q];R=S.did;if(S.did===U.did){O.id=S;break;}else{if(!O.n&&S.n===U.n){O.n=S;}else{switch(S.did){case L.KEEP:O.k=S;break;case L.NO_REPLACE:O.nr=S;break;case L.REMOVE:O.r=S;break;}}}}return O.id||O.n||O.k||O.nr||O.r;}function N(O){return" ReplaceObjectUnit-icon ReplaceObjectUnit-"+A.getUnitCssClass(O)+" ";}function D(R,Q,P){var O=R.map(function(S){return S[Q];});return O.join(P);}mstrmojo.vi.ui.ReplaceObjectEditor=mstrmojo.declare(mstrmojo.Editor,null,{scriptClass:"mstrmojo.vi.ui.ReplaceObjectEditor",source:null,target:null,conciliation:{},clearaf:false,showUnitTooltip:false,onOk:mstrmojo.emptyFn,onCancel:mstrmojo.emptyFn,onBack:mstrmojo.emptyFn,title:mstrmojo.desc(11674,"Replace Objects"),help:"replace_objects_dialog_box.htm",cssClass:"mstrmojo-ReplaceObject",getResizeHandler:function J(){var P=this,O=this._super();return mstrmojo.func.composite([O,function(){(P.dataGrid.ctxtBuilder.itemWidgets||[]).forEach(function(R){var Q=R.newObjSelector.selector.getPopupWidget();if(Q.visible){Q.adjustCornersForPopupOverflow();}});}]);},setUnits:function(Q){var P=this;["source","target"].forEach(function(R){if(Q[R]){P[R]=Q[R];}});this.conciliation={};var O=F.cloneArray(this.target.units);H.forEach(O,function(R){R.cls=(R.cls||"")+N(R)+B;});this.dataGrid.set("tgtitems",O);this.dataGrid.set("items",F.cloneArray(this.source.units));this.dataGrid.updateScrollbars();},onPreClose:function(){this.onCancel();return true;},onClose:function(){this.unrender();},children:[{scriptClass:"mstrmojo.Label",cssClass:"ReplaceObject-ExplainText",text:(typeof (mstrApp)!=="undefined"&&mstrApp.pageName==="rwd")?mstrmojo.desc(14554,"Replace or remove objects currently used in the document."):mstrmojo.desc(15485,"Replace or remove objects currently used in the dossier.")},{scriptClass:"mstrmojo.DataGrid",alias:"dataGrid",cssClass:"ReplaceObject-DataGrid",columns:[{headerText:mstrmojo.desc(11675,"Current Objects"),headerCss:"left-unit",dataWidget:{scriptClass:"mstrmojo.Label",bindings:{text:"this.data.n",cssClass:function(){return N(this.data)+" left-unit ReplaceObject-Unit ";},useRichTooltip:"!!this.parent.dataGrid.parent.showUnitTooltip"},updateTooltipConfig:function(){var P=this.parent.dataGrid.parent.source.units,O=this.data;if(P.some(function(Q){return(Q.n===O.n)&&(Q.did!==O.did);})){this.richTooltip={posType:mstrmojo.tooltip.POS_TOPLEFT,cssClass:"vi-regular vi-tooltip-A",top:28,refNode:this.domNode,content:this.data.n+" ("+D(this.data.cubes,"name",", ")+")"};}else{this.richTooltip=null;}}}},{headerText:mstrmojo.desc(11676,"New Objects"),dataWidget:{scriptClass:"mstrmojo.HBox",alias:"newObjSelector",children:[{scriptClass:"mstrmojo.ui.SearchablePulldown",alias:"selector",hostedCSSClass:"ReplaceObject-Pulldown-Popup",isHostedWithin:false,getPopupConfig:function(){var O=this.constructor.prototype.getPopupConfig.call(this);O.popupHandlers[this.list.id]={open:function(){var P=this.domNode;if(P.parentNode){P.parentNode.removeChild(P);}}};return O;},onitemSelected:function(O){this.selectedNode.className="mstrmojo-ui-Pulldown-text "+(O.cls||"");},postCreate:function(){var U=this.parent.data;var P=[];var R=this.parent.dataGrid.parent;var O=this.parent.dataGrid;P=mstrmojo.array.filter(O.tgtitems,function(V){return V.t===U.t&&!(E(U)&&U.did===V.did);});if(P.length){P[P.length-1]=F.clone(P[P.length-1]);P[P.length-1].cls+=" ReplaceObjectEditor-item-delimeter-above ";}var Q=K(U,R);if(Q.length){Q[0].cls+=" ReplaceObjectEditor-item-delimeter-below ";}P=P.concat(Q);var S=C(U,P);this.set("items",P);this.selectedIndex=H.find(P,I,S[I]);},postselectedIndexChange:function G(){var P=this.parent.data,Q=this.items[this.selectedIndex];var O=this.parent.dataGrid.parent;O.conciliation[P[I]]={source:P,target:Q};}}]}}]},{scriptClass:"mstrmojo.Box",cssClass:"ReplaceObject-overwrite",children:[{scriptClass:"mstrmojo.CheckBox",label:(typeof (mstrApp)!=="undefined"&&mstrApp.pageName==="rwd")?mstrmojo.desc(14555,"Clear object alias and number format on document"):mstrmojo.desc(15473,"Clear object alias and number format on dossier"),bindings:{checked:"this.parent.parent.clearaf"},oncheckedChange:function(){var O=this.isChecked();this.parent.parent.set("clearaf",O);}}]}],buttons:[{scriptClass:"mstrmojo.Button",cssClass:"mstrmojo-WebButton hot",text:mstrmojo.desc(1442,"OK"),onclick:function(){var S=this.parent.parent,R=[],a={},W=[],O={},Q={};F.forEach(S.conciliation,function(d){var c=d.target,b=d.source;a[b[I]]={source:b,target:c};if(c[I]===L.REMOVE){var e=b.dependentObjects;if(e){e.forEach(function(f){W.push({dependOn:b,dependent:f});});}}});W.forEach(function(c){var e=c.dependOn,d=c.dependent,f=a[d.did],b=f.target;if(b[I]!==L.REMOVE){f.target={ID:L.REMOVE};Q[d.did]=d;O[e.did]=e;}});F.forEach(a,function(e){var d=e.target,c=e.source;function b(g,f){if(c.cont_did){g.srcContDid=c.cont_did;g.srcContType=c.cont_tp;}if(f&&f.cont_did){g.tgtContDid=f.cont_did;g.tgtContType=f.cont_tp;}return g;}switch(d[I]){case L.REMOVE:R.push(b({srcid:c[I],srct:c.t}));break;case L.KEEP:case L.NO_REPLACE:break;default:R.push(b({tgtid:d[I],tgtt:d.t,srcid:c[I],srct:c.t},d));}});var P=F.valarray(O),X=F.valarray(Q),V=function V(){S.onOk(R,S.clearaf);S.close();};if(X.length){var Y=P.length,U=Y>=2?mstrmojo.desc(13367,"### and ##").replace("###",P.slice(0,Y-1).map(function(b){return M.encodeHtmlString(b.n);}).join(", ")).replace("##",M.encodeHtmlString(P[Y-1].n)):M.encodeHtmlString(P[0].n),Z=mstrmojo.desc(13368,"Deleting ## will result in removal of the following dependent objects:").replace("##",U)+"</br>"+X.map(function(b){return M.encodeHtmlString(b.n)+"</br>";}).join("")+mstrmojo.desc(13369,"Do you wish to continue?");mstrmojo.warn(Z,{confirmBtn:{t:mstrmojo.desc(1442,"OK"),fn:function(){V();}},cancelBtn:{t:mstrmojo.desc(221,"Cancel"),fn:function(){S.open();}}},{cssClass:"removeDependentConfirm",onPreClose:function(){S.open();return true;}});}else{V();}}},{scriptClass:"mstrmojo.Button",cssClass:"mstrmojo-WebButton",text:mstrmojo.desc(221,"Cancel"),onclick:function(){this.parent.parent.onCancel();this.parent.parent.close();}}]});}());(function(){mstrmojo.requiresCls("mstrmojo.hash","mstrmojo.array","mstrmojo.string","mstrmojo.models.template.DataInterface","mstrmojo.vi.ui.DatasetUnitMenuUtils");var D=mstrmojo.string,Y="TemplateObject",AC="Value",H=12,B=4,Q={},h={},o={},E={},f={},K=[],u={},n={},v=mstrmojo.array,L=mstrmojo.hash,C,AD=mstrmojo.vi.ui.DatasetUnitMenuUtils,z="\u200C",d={GEO:"geo",TIME:"time",CATEGORY:"category",SUBCATEGORY:"subcategory",PRODUCT:"product",DEPARTMENT:"department",BUSINESS_UNIT:"businessUnit",ALL_THE_REST:"allTheRest"},e={PROFIT:"profit",REVENUE:"revenue",COST:"cost",SOLD:"sold",SALES:"sales",AMOUNT:"amount",ALL_THE_REST:"allTheRest"},X={LEXICAL:0,OBJECT:1,CONDITION:2,AGGREGATION:3};function A(AK){var AH=C(AK,o).list[0].terms,AG=[],AJ=0,AF=[],AM=[],AL,AE=function AE(AN){var AO="";v.forEach(AN,function(AP){AO=AO+" "+AP;AO=AO.trim();if(o[AO]){AG.push(AO.replace(/ +/g,z));AO="";}});},AI=function AI(AO){var AP=C(AO.join(" ")).values().numbers(),AN;if(v.isArray(AP)&&AP.length>0){AN=AP[0];AG.push(AN);}};while(AJ<AH.length){AL=AH[AJ].normal;if(!AH[AJ].tags[Y]&&!AH[AJ].tags[AC]){if(AM.length>0){AI(AM);}AM=[];if(AF.length>0){AE(AF);}AG.push(AL);AF=[];}else{if(AH[AJ].tags[AC]&&!AH[AJ].tags[Y]){AM.push(AL);}else{AF.push(AL);}}AJ++;}if(AF.length>0){AE(AF);}if(AM.length>0){AI(AM);}return C(AG.join(" "),E);}function p(AH){var AG,AF,AE,AI={average:"Avg",maximum:"Max",max:"Max",minimum:"Min",min:"Min",sum:"Sum","sum of":"Sum",count:"Count","count of":"Count"};L.forEach(AI,function(AK,AJ){AG=AH.match(AJ+" #"+Y).list;v.forEach(AG,function(AL){AE=v.filter(AL.terms,function(AM){return !!AM.tags[Y];});AF=AE[0];AF.symboltp=X.AGGREGATION;AF.fn=AK;AF.isDM=true;});});return AH;}function k(AJ){var AE=["sort by","sorted by"],AI,AH=[],AG,AF;v.forEach(AE,function(AK){AI=AJ.match(AK+" #"+Y).list;v.forEach(AI,function(AL){AF=v.filter(AL.terms,function(AM){return !!AM.tags[Y];});AG=f[AF[0].normal];if(AG.t===H&&AG.fs&&AG.fs[0]){AG.fid=AG.fs[0].fid;}AH.push(AG);});});return AH;}function J(AM){var AH="greater",AN="less",AQ="equal",AR={"bigger than":AH,"larger than":AH,"greater than":AH,"smaller than":AN,"less than":AN,is:AQ,are:AQ},AK,AF,AG,AL=AL||window.nlp;L.forEach(AR,function(AT,AS){AK=AM.match("#"+Y+" * "+AS+" #value").list;v.forEach(AK,function(AU){AF=v.filter(AU.terms,function(AV){return !!AV.tags[Y];});AG=AF.slice(-1)[0];AG.symboltp=X.CONDITION;AG.condiOp=AT;AG.condiValue=v.filter(AU.terms,function(AV){return !!AV.tags[AC];})[0].normal;AG.condiValue=AL(AG.condiValue).values().numbers()[0];});});var AI=function AI(AS){var AT=["#"+Y+(AS?" with highest #":" with lowest #")+Y,"#"+Y+(AS?" with the highest #":" with the lowest #")+Y,"#"+Y+(AS?" with most #":" with fewest #")+Y,"#"+Y+(AS?" with the most #":" with the fewest #")+Y,"#"+Y+(AS?" with greatest #":" with least #")+Y,"#"+Y+(AS?" with the greatest #":" with the least #")+Y,"#"+Y+(AS?" with largest #":" with smallest #")+Y,"#"+Y+(AS?" with the largest #":" with the smallest #")+Y,"#"+Y+(AS?" with maximum #":" with minimum #")+Y,"#"+Y+(AS?" with the maximum #":" with the minimum #")+Y];return AT;};var AE=AI(true);var AJ=AI(false);var AO=function AO(AT){var AS=(AT==="top")?AE:AJ;v.forEach(AS,function(AV){var AU=AM.match(AV).list;v.forEach(AU,function(AW){AF=v.filter(AW.terms,function(AX){return !!AX.tags[Y];});AG=AF[1];AG.symboltp=X.CONDITION;AG.condiOp=AT;AG.condiValue=1;});});};AO("top");AO("bottom");var AP=["top #value #"+Y+" by #"+Y,"top #value #"+Y+" with the highest #"+Y];v.forEach(AP,function(AS){AK=AM.match(AS).list;v.forEach(AK,function(AT){AF=v.filter(AT.terms,function(AU){return !!AU.tags[Y];});AG=AF[1];AG.symboltp=X.CONDITION;AG.condiOp="top";AG.condiValue=v.filter(AT.terms,function(AU){return !!AU.tags[AC];})[0].normal;AG.condiValue=AL(AG.condiValue).values().numbers()[0];});});return AM;}function t(AF){var AE={kpi:"KPICardVisualizationStyle","geospatial map":"MapboxVisualizationStyle","heat map":"VIHeatMapVisualizationStyle",heatmap:"VIHeatMapVisualizationStyle","tree map":"VIHeatMapVisualizationStyle",treemap:"VIHeatMapVisualizationStyle",map:"GoogleMapVisualizationStyle",line:"LINE",bar:"BAR",pie:"PIE",bubble:"BUBBLE",network:"NetworkVisualizationStyle",table:"Grid",grid:"Grid"},AG="";L.forEach(AE,function(AI,AH){if(AF.match(AH).found){AG=AI;return false;}});return AG;}function g(AE){var AG=[],AI=[],AF,AH=A(AE);v.forEach(AH.list[0].terms,function(AJ){if(AJ.tags[Y]){AJ.symboltp=X.OBJECT;}});AH=p(AH);AH=J(AH);v.forEach(AH.list[0].terms,function(AJ){switch(AJ.symboltp){case X.CONDITION:AF=f[AJ.normal];AG.push({fn:AJ.condiOp,v:AJ.condiValue,did:AF.did,n:AF.n,t:AF.t,st:AF.st,dsid:AF.datasetId,isDM:AJ.isDM});AI.push(L.copy({fn:AJ.fn,isDM:AJ.isDM,dmName:AJ.fn+" "+AF.n,t:AJ.isDM?B:AF.t},L.clone(AF)));break;case X.OBJECT:case X.AGGREGATION:AF=f[AJ.normal];AI.push(L.copy({fn:AJ.fn,isDM:AJ.isDM,dmName:AJ.fn+" "+AF.n,t:AF.t},L.clone(AF)));break;default:break;}});return{items:AI,visType:t(AH),filter:AG,sorts:k(AH)};}function AA(AF,AE){var AG=AD.getUnitCssClass(AF);AE.push({n:AF.n,html:'<div class="icn '+AG+'"></div>'+D.encodeHtmlString(AF.n),dsName:AF.dsName});}function G(){K=[];L.forEach(h,function(AE){AA(AE,K);});L.forEach(Q,function(AE){AA(AE,K);});}function O(AG,AE){AE=v.ensureArray(AE);AG=AG.toLowerCase();var AF=false;v.forEach(AE,function(AH){if(AG.indexOf(AH)>-1){AF=true;return false;}return true;});return AF;}function V(AE){return AD.isTimeAttr(AE)||O(AE.n,["month","year","quarter","week","date"]);}function w(AE){if(AD.isGeoAttr(AE)){return d.GEO;}else{if(V(AE)){return d.TIME;}else{if(O(AE.n,["category","categories"])){return d.CATEGORY;}else{if(O(AE.n,["subcategory","subcategories","sub-category"])){return d.SUBCATEGORY;}else{if(O(AE.n,["product","products"])){return d.PRODUCT;}else{if(O(AE.n,["department","departments"])){return d.DEPARTMENT;}else{if(O(AE.n,["business unit","business units"])){return d.BUSINESS_UNIT;}else{return d.ALL_THE_REST;}}}}}}}}function b(AE){if(O(AE.n,["profit","profits"])){return e.PROFIT;}else{if(O(AE.n,["revenue"])){return e.REVENUE;}else{if(O(AE.n,["cost","costs"])){return e.COST;}else{if(O(AE.n,["sold","units sold"])){return e.SOLD;}else{if(O(AE.n,["sales"])){return e.SALES;}else{if(O(AE.n,["amount"])){return e.AMOUNT;}else{return e.ALL_THE_REST;}}}}}}}function q(){return{att:{geo:[],time:[],category:[],subcategory:[],product:[],department:[],businessUnit:[],preferredAttrs:[],allTheRest:[]},mx:{profit:[],revenue:[],cost:[],sold:[],sales:[],amount:[],preferredMetrics:[],allTheRest:[]}};}function F(){var AG=function AF(AJ,AI){return v.some(AI,function(AK){return AK.did===AJ.did&&AK.datasetId===AJ.datasetId;});};n={};u={};u=q();var AE=u.att,AH=u.mx;L.forEach(Q,function(AJ){var AL=AJ.datasetId;if(!n[AJ.datasetId]){n[AJ.datasetId]=q();}var AK=n[AL].att,AI=w(AJ);if(!AG(AJ,AE[AI])){AE[AI].push(AJ);}if(!AG(AJ,AK[AI])){AK[AI].push(AJ);}});AE.preferredAttrs=[].concat(AE.category).concat(AE.subcategory).concat(AE.product).concat(AE.department).concat(AE.businessUnit);v.forEach(L.keyarray(n),function(AJ){var AI=n[AJ].att;AI.preferredAttrs=[].concat(AI.category).concat(AI.subcategory).concat(AI.product).concat(AI.department).concat(AI.businessUnit);});L.forEach(h,function(AK){var AL=AK.datasetId;if(!n[AL]){n[AL]=q();}var AI=n[AL].mx,AJ=b(AK);if(!AG(AK,AH[AJ])){AH[AJ].push(AK);}if(!AG(AK,AI[AJ])){AI[AJ].push(AK);}});AH.preferredMetrics=[].concat(AH.profit).concat(AH.revenue).concat(AH.cost).concat(AH.sold).concat(AH.sales).concat(AH.amount);v.forEach(L.keyarray(n),function(AJ){var AI=n[AJ].mx;AI.preferredMetrics=[].concat(AI.profit).concat(AI.revenue).concat(AI.cost).concat(AI.sold).concat(AI.sales).concat(AI.amount);});}var N="%%METRIC_1%%";var M="%%METRIC_2%%";var I="%%ATTRIBUTE_1%%";var c="%%ATTRIBUTE_TIME_1%%";var r="%%ATTRIBUTE_GEO_1%%";var P='<div class="icn question"></div>';function U(AE){return z+AE+z;}function m(AE){return"<b>"+AE+"</b>";}var j=[{templates:[{n:"What is the total "+U(N)+"?",html:P+"What is the total "+m(N)+"?",type:"sample-question"}],config:{mx:1}},{templates:[{n:"Count ("+U(I)+")",html:P+"Count ("+m(I)+")",type:"sample-question"}],config:{att:1}},{templates:[{n:"What is the "+U(N)+" by "+U(c)+"?",html:P+"What is the "+m(N)+" by "+m(c)+"?",type:"sample-question"}],config:{att_time:1,mx:1}},{templates:[{n:"Show me the distribution of "+U(N)+" by "+U(r),html:P+"Show me the distribution of "+m(N)+" by "+m(r),type:"sample-question"},{n:"Show me a map of "+U(N)+" by "+U(r),html:P+"Show me a map of "+m(N)+" by "+m(r),type:"sample-question"}],config:{att_geo:1,mx:1}},{templates:[{n:"Show me the "+U(N)+" by "+U(I),html:P+"Show me the "+m(N)+" by "+m(I),type:"sample-question"}],config:{att:1,mx:1}},{templates:[{n:"Show me the "+U(N)+" by "+U(I)+" by "+U(c),html:P+"Show me the "+m(N)+" by "+m(I)+" by "+m(c),type:"sample-question"}],config:{att:1,att_time:1,mx:1}},{templates:[{n:"What is the correlation between "+U(N)+" and "+U(M)+" by "+U(I)+"?",html:P+"What is the correlation between "+m(N)+" and "+m(M)+" by "+m(I)+"?",type:"sample-question"}],config:{att:1,mx:2}},{templates:[{n:"What are the top 3 "+U(I)+" with the highest "+U(N)+"?",html:P+"What are the top 3 "+m(I)+" with the highest "+m(N)+"?",type:"sample-question"}],config:{att:1,mx:1}},{templates:[{n:"What is the "+U(N)+" by "+U(I)+" sorted by "+U(N)+"?",html:P+"What is the "+m(N)+" by "+m(I)+" sorted by "+m(N)+"?",type:"sample-question"}],config:{att:1,mx:1}}];function l(AE,AI){if(AE>AI){return 0;}var AH=1,AG=1;for(var AF=0;AF<AE;AF++){AH=AH*(AI-AF);AG=AG*(AE-AF);}return AH/AG;}function S(AG,AK){var AJ=AG.config,AR=AK.mx,AL=AK.att,AS=AL.time.length,AQ=AL.geo.length,AP=AL.preferredAttrs.length,AN=AL.allTheRest.length,AI=AR.preferredMetrics.length,AH=AR.allTheRest.length;var AO=AJ.att||0,AM=AJ.att_time||0,AF=AJ.att_geo||0,AE=AJ.mx||0;var AT={preferred:0,others:0,total:0};if(AM>AS||AF>AQ||AO>(AP+AN)||AE>(AI+AH)){return AT;}if(AO>AP||AE>AI){AT.preferred=0;}else{AT.preferred=l(AO,AP)*l(AE,AI)*l(AM,AS)*l(AF,AQ);}AT.total=l(AO,AP+AN)*l(AE,AI+AH)*l(AM,AS)*l(AF,AQ);AT.others=AT.total-AT.preferred;return AT;}function x(AG,AJ){var AF=AG.length;if(AF<AJ){return null;}if(AF===AJ){return AG;}var AI,AH=[],AE=[];while(AE.length<AJ){AI=Math.floor(Math.random()*AF);if(AH.indexOf(AI)>-1){continue;}AH.push(AI);AE.push(AG[AI]);}return AE;}function AB(AR,AV){var AI=AV.mx,AQ=AV.att,AH=AQ.preferredAttrs,AS=AQ.time,AF=AQ.geo,AO=AQ.allTheRest,AL=AI.preferredMetrics,AE=AI.allTheRest;var AG=AR.templates,AT=AR.config,AU=x(AG,1)[0];var AK=L.clone(AU);var AJ=x(AS,AT.att_time),AW=x(AF,AT.att_geo),AP=[].concat(x(AH,Math.min(AH.length,AT.att))).concat(x(AO,Math.max(0,AT.att-AH.length))),AM=[].concat(x(AL,Math.min(AL.length,AT.mx))).concat(x(AE,Math.max(0,AT.mx-AL.length)));var AN=function(AY,AX){if(AX){return D.encodeHtmlString(AY&&AY.n||"");}return AY&&AY.n||"";};AK.n=AK.n.replace(new RegExp(N,"g"),AN(AM[0],false)).replace(new RegExp(M,"g"),AN(AM[1],false)).replace(new RegExp(I,"g"),AN(AP[0],false)).replace(new RegExp(c,"g"),AN(AJ[0],false)).replace(new RegExp(r,"g"),AN(AW[0],false));AK.html=AK.html.replace(new RegExp(N,"g"),D.encodeHtmlString(AN(AM[0]))).replace(new RegExp(M,"g"),D.encodeHtmlString(AN(AM[1]))).replace(new RegExp(I,"g"),D.encodeHtmlString(AN(AP[0]))).replace(new RegExp(c,"g"),D.encodeHtmlString(AN(AJ[0]))).replace(new RegExp(r,"g"),D.encodeHtmlString(AN(AW[0])));return AK;}function a(){var AE=[],AF=[],AG={};v.forEach(L.keyarray(n),function(AH){AF.push(AH);AG[AH]=[];});v.forEach(L.keyarray(n),function(AJ){var AI=[];v.forEach(j,function(AL){var AK=S(AL,n[AJ]);AI.push(AK);});var AH=v.map(AI,function(AK){return AK.total;});AG[AJ]=AH;});v.forEach(j,function(AH,AQ){var AP=Math.floor(Math.random()*AF.length);if(AG&&AF&&AF[AP]){var AN=AF[AP];if(AG[AN][AQ]>0){AE.push(AB(AH,n[AN]));}else{if(AG[AN][AQ]===0){var AL=mstrmojo.hash.clone(AF),AJ=0,AO=AL[AP],AI=AG[AO];while(AI&&AI[AQ]===0&&AJ<AL.length){var AK=AO,AM=AL.indexOf(AK);if(AM>-1){AL.splice(AM,1);}AP=Math.floor(Math.random()*AL.length);AO=AL[AP];AI=AG[AO];AJ++;}if(AO&&AI&&AI[AQ]&&AI[AQ]>0){AE.push(AB(AH,n[AO]));}}}}});return AE;}mstrmojo.vi.models._IsNLPModel=mstrmojo.provide("mstrmojo.vi.models._IsNLPModel",{_mixinName:"mstrmojo.vi.models._IsNLPModel",isWordBaseBuilt:false,mapConfig:null,buildWordBase:function R(AG){if(AG){this.isWordBaseBuilt=false;}o={};E={};f={};if(!this.isWordBaseBuilt){var AE,AH,AF=true;Q={};h={};if(Object.keys){AF=Object.keys(this.datasets||{}).length>1;}L.forEach(this.datasets,function(AK,AI){var AJ=AK.name||"";v.forEach(AK.att,function(AL){if(AL.hide){return true;}AE=AL.n.toLowerCase();AH=AL.did.toLowerCase();AL.datasetId=AI;if(AF){AL.dsName=AJ;}Q[AE]=AL;o[AE]=Y;o[AH]=Y;AE=AE.replace(/\s/g,z);E[AE]=Y;E[AH]=Y;f[AE]=AL;f[AH]=AL;});v.forEach(AK.mx,function(AL){if(AL.hide){return true;}AL.datasetId=AI;if(AF){AL.dsName=AJ;}AE=AL.n.toLowerCase();AH=AL.did.toLowerCase();h[AE]=AL;o[AE]=Y;o[AH]=Y;AE=AE.replace(/\s/g,z);E[AE]=Y;E[AH]=Y;f[AE]=AL;f[AH]=AL;});});F();G();this.isWordBaseBuilt=true;}},getSuggestionListItems:function W(AF,AG){var AI=AF.pattern,AE=[];AI=D.regEscape((AI||"").trim());if(!(AF&&AF.showSampleQuestion)){AG=AG||1000;var AJ=v.filter(K,function(AK){return(new RegExp("\\s"+AI+"|^"+AI,"i")).test(AK.n);},{max:AG});v.forEach(AJ,function(AL,AK){AL.matchPos=((AL.n||"").toLowerCase()).indexOf((AI||"").toLowerCase())>-1?((AL.n||"").toLowerCase()).indexOf((AI||"").toLowerCase()):Infinity;AL.pos=AK;});var AH=function(AL,AK){if(AL.matchPos<AK.matchPos){return -1;}else{if(AL.matchPos===AK.matchPos){return AL.pos-AK.pos;}}return 1;};AJ=(AJ||[]).sort(AH);AE=AJ;}else{AE.push({n:"",html:"You may ask a question like",type:"dummy",cls:"label"});AE=AE.concat(a());}return AE;},getRelevantObjects:function Z(AE){C=C||window.nlp;AE=AE.replace(/\?+$/,"").toLowerCase();this.buildWordBase(true);var AF=AE.split(z);(AF||[]).forEach(function(AH,AG){if(o[AH]){if(Q[AH]){AF[AG]=Q[AH].did;}else{if(h[AH]){AF[AG]=h[AH].did;}}}});AE=AF.join("").toLowerCase();return g(AE);},checkForMapboxKey:function(){var AF=this;if(!AF.mapConfig){var AE={taskId:"getMultiMapConfig",key:"",taskEnv:"xhr",taskContentType:"json"},AG={success:function(AH){if(AH){AF.mapConfig=AH;}},failure:function(){}};mstrApp.serverRequest(AE,AG);}}});mstrmojo.vi.models._IsNLPModel.isTimeAttr=V;}());(function(){mstrmojo.requiresCls("mstrmojo.vi.ui.BoxPanel","mstrmojo._HasBuilder","mstrmojo._IsPanelStack","mstrmojo.vi.ui.rw._IsPanelStack","mstrmojo.vi.ui.rw._HasBufferSlice","mstrmojo.ui.menus._HasMenuPopup","mstrmojo.ui.menus.MenuConfig","mstrmojo.Label","mstrmojo.Button","mstrmojo.vi.ui.PanelPortlet","mstrmojo.vi.ui.DatasetUnitMenuUtils","mstrmojo.vi.models.PanelFormatSaver","mstrmojo.ui.CheckList","mstrmojo.vi.ui._HasMask","mstrmojo.array","mstrmojo.dom","mstrmojo.css","mstrmojo.string","mstrmojo.vi.ui.rw.selectors.EnumVizSelectorMode");mstrmojo.requiresDescs(134,1143,3581,3582,11473,11474,11815,11816,11817,11818,14594);var L=mstrmojo.array,F=mstrmojo.dom,U=mstrmojo.Button.newWebButton,C=mstrmojo.string,P={att:12,mx:4},N={CLEAR_TARGET:1,TARGET_ALL_BELOW:2},Y=mstrmojo.func,g=Y.wrapMethods,G=mstrmojo.vi.ui.DatasetUnitMenuUtils,I=mstrmojo.vi.ui.rw.selectors.EnumVizSelectorMode;function e(h){return(h||[]).map(function(j){return j.ckey;});}function V(){var l=this.model,m=this.getFilterDefinitions(),k=[],j={},n=this.id;function h(v,u){var t=l.getDatasetUnits([u],function(AB){var AA=AB.t;if(!j[AB.did]&&(AA===12||AA===4||AA===1||AA===47)){if(L.find(m,"srcid",AB.did)<0&&AB.hide){return false;}j[AB.did]=true;return true;}return false;});t=G.getSortedDatasetUnits(t);if(!t.length){return ;}var r=(l.datasetsSettings&&l.datasetsSettings.units)||{};t=t.filter(function(AA){return !(r[AA.n]&&r[AA.n].completeHide)&&G.isValidAddToFP(l,AA,true);});var p={};(t||[]).forEach(function(AB,AA){if(L.find(m,"srcid",AB.did)>-1){p[AA]=true;}});var o=l.datasets,x,z=0;for(x in o){if(o.hasOwnProperty(x)&&o[x].did){++z;}}var q=new mstrmojo.ui.CheckList({cssClass:"units",items:t.map(function(AA){AA.tt=AA.n+" ("+AA.ds+")";AA.css=G.getUnitCssClass(AA);return AA;}),selectedIndices:p,useRichTooltip:true,showTooltip:function w(AA,AD){var AC=AA.target||F.eventTarget(AA.hWin,AA.e),AB=this.getItemFromTarget(AC),AF=AC.firstChild,AE;AC.setAttribute("title","");if(AC.offsetWidth<AF.offsetWidth||z>0){AE=F.position(this.getItemNodeFromTarget(AC));this.richTooltip={posType:mstrmojo.tooltip.POS_TOPLEFT,cssClass:"vi-regular vi-tooltip-C",content:AB.tt,top:AE.y,left:AE.x+AE.w+18};mstrmojo.ui.CheckList.prototype.showTooltip.apply(this,AA,AD);}}});k.push({scriptClass:"mstrmojo.vi.ui.PanelPortlet",title:v,children:[q],t:P[u],getSelectedItems:function(){return(q.getSelectedItems()||[]).filter(function(AA){return L.find(m,"srcid",AA.did)===-1;});},getUnselectedFiltersDefns:function(){var AA=this.t;return m.filter(function(AB){return !(r[AB.ttl]&&r[AB.ttl].completeHide)&&(L.find(q.getSelectedItems()||[],"did",AB.srcid)===-1)&&(AB.srct===AA||AA===12&&AB.srct===47);}).sort(function(AC,AB){var AD=function(AE){return(AE.fmts&&AE.fmts["z-index"])||0;};return(AD(AC)>AD(AB))?1:-1;});},updateListScrollbars:function(){q.updateScrollbars();}});}h(mstrmojo.desc(3581,"Attributes"),"att");h(mstrmojo.desc(3582,"Metrics"),"mx");return new mstrmojo.ui.menus.EditorConfig({data:{},cssClass:"showFilters",contents:k,onOpen:function(){k.forEach(function(o){o.updateListScrollbars();});},fnOk:function(){var p=[],o=[];k.forEach(function(q){p=p.concat(q.getSelectedItems());o=o.concat(q.getUnselectedFiltersDefns());});mstrmojo.all[n].model.changeFilterStackSelectors(p,o);}});}function X(k){var l=this,j=l.model,m=j.getDataService(),n=g({success:function(){k=!k;l.set("autoApply",k);l.defn.set("cas",k);l.widgetResized();}},j.getRebuildCallback()),h=[];j.execute({execute:function(){var o=m.newUpdate(this);if(k){l.applyBufferedSlices(true,o,h);}l.set("autoApply",k);l.defn.set("cas",k);o.addActions(j.getUnitFormatAction(l,1,{FormattingLayout:{CtlAutoSubmit:(k?1:0)}}));o.addCallbacks({success:mstrmojo.emptyFn});o.submit();l.widgetResized();},urInfo:{extraPuKeys:h,callback:n}});}function E(){var r=this,o=new mstrmojo.ui.menus.MenuConfig({supportsScroll:true,isHostedWithin:false,maxHeight:F.getMaxScrollHeight()}),t=!!this.getFilters().length,j=mstrApp.isAppStatePresentation(),q=mstrApp.isAppStatePause(),p=0,u=1,n=function n(v){return !!r.getFilterDefinitions().filter(function(w){return w.ds===v;}).length;};if(!j){if(this.model.getDatasetUnits(["mx","att"]).length){var h=r.id;o.addEditorMenuItem(mstrmojo.desc(11815,"Add Filters"),h,V);o.addMenuItem(mstrmojo.desc(15288,"Add Visualization Filter..."),"",function(){var w=r.model,v=w.addVisFilterContainer(),x=w.getNextVisFilterTitle();w.addVisualizationSelector(v,I.CONFIGURATION,x);mstrApp.getRootController().enterVizFilterConfigMode(x,false);});}else{o.addDisabledMenuItem(mstrmojo.desc(11815,"Add Filters"));o.addDisabledMenuItem(mstrmojo.desc(15288,"Add Visualization Filter..."));}}if(t){o.addMenuItem(mstrmojo.desc(14594,"Unset All Filters"),"cf",function(){r.clearBuffSlices();r.contents.clearAllFilter();r.applyBufferedSlices();});}o.addSeparator();if(!j){if(!q){o.addToggleMenuItem(mstrmojo.desc(11818,"Auto-apply Filters"),"atc",function(){X.call(this,true);},function(){X.call(this,false);},r.id,r.autoApply);o.addSeparator();}var m=function(z){var AA=this.ctxt,w=AA.k,v=AA.model,AB=v.getDataService().getChangeFilteringAction(AA.k,z,true,[w]),AC={success:function(AD){v.partialUpdate(AD.data,v.getTargetDefn(w),AD.defn,e(AA.getFilterDefinitions()));}},x={style:{params:{treesToRender:3}}};v.execute({execute:function(){this.submit(AB,AC,x);},urInfo:{treesToRender:3}});};o.addMenuItem(mstrmojo.desc(11474,"Target All Filters Below"),"",function(){m.call(this,N.TARGET_ALL_BELOW);},this);o.addMenuItem(mstrmojo.desc(11473,"Clear All Targeting"),"",function(){m.call(this,N.CLEAR_TARGET);},this);o.addSeparator();}if(t){var l=n(u),k=n(p);o[l?"addMenuItem":"addDisabledMenuItem"](mstrmojo.desc(11816,"Expand All"),"fea",l?function(){r.contents.toggleFilters(false);}:null,null);o[k?"addMenuItem":"addDisabledMenuItem"](mstrmojo.desc(11817,"Collapse All"),"fca",k?function(){r.contents.toggleFilters(true);}:null,null);}if(!j){o.addSeparator();this.addHelpTopicMenuItem(o,mstrmojo.desc(1143,"Help"),"filter_panel.htm");}o.hostId=r.id;o.isHostedWithin=false;o.hostElement=r.fpsTitleBar.menuBtn.domNode;if(o.hasMenuItems()){r.openPopup(o.newInstance());}}mstrmojo.vi.ui.rw.FilterPanelStack=mstrmojo.declare(mstrmojo.vi.ui.BoxPanel,[mstrmojo._HasBuilder,mstrmojo._IsPanelStack,mstrmojo.vi.ui.rw._IsPanelStack,mstrmojo.vi.ui.rw._HasBufferSlice,mstrmojo.ui.menus._HasMenuPopup,mstrmojo.vi._MonitorsAppState,mstrmojo.vi.ui._HasMask],{scriptClass:"mstrmojo.vi.ui.rw.FilterPanelStack",markupMethods:{onvisibleChange:function(){if(this.visible){this.domNode.style.display=this.cssDisplay;this.getFilters().forEach(function(h){h.refresh();});}else{this.domNode.style.display="none";this.onStatusChange();}}},title:"",k:"",contents:null,applyEnabled:false,editTitleOnDoubleClick:true,setOpenStatus:function O(k,h,n,l){if(!h){if(n){var j=this.model,m=n.actions;m.push(j.getUnitFormatAction(this,1,{FormattingAppearance:{Visible:true}}));}else{mstrmojo.vi.models.PanelFormatSaver.getPanelSaver(this.model,{visible:{set:"FormattingAppearance",name:"Visible"}},this).saveProperty("visible",true);}}if(!k){this.onStatusChange();}this._super(k,h,n,l);},getOpenStatus:function K(){return this.parent;},children:[{scriptClass:"mstrmojo.Box",slot:"controlNode",alias:"fpsTitleBar",cssClass:"fp-titlebar",ignoreLayout:true,children:[{scriptClass:"mstrmojo.EditableLabel",cssClass:"fp-title",alias:"fpsTitle",editOnClick:false,useRichTooltip:true,bindings:{text:function(){return this.parent.parent.title;},editOnDoubleClick:function(){return this.parent.parent.editTitleOnDoubleClick;}},updateTooltipConfig:function Z(j){var k=j.target,h=F.position(k);this.richTooltip={posType:mstrmojo.tooltip.POS_TOPLEFT,cssClass:"vi-regular vi-tooltip-A",content:C.encodeHtmlString(this.parent.parent.title),top:h.y+h.h+3,left:h.x+4};},onTextEditComplete:function(k,h){if(k){var j=this.parent.parent;j.titleEdited(this.text,h);}},getLayoutOffsets:function d(){return{h:2,w:2};}},{scriptClass:"mstrmojo.Button",alias:"menuBtn",cssClass:"fp-menu",onclick:function(){E.call(this.parent.parent);}}]},{scriptClass:"mstrmojo.Box",slot:"controlNode",alias:"fpsBtnBar",cssClass:"fp-btnbar",ignoreLayout:true,bindings:{visible:"!this.parent.autoApply"},children:[U(mstrmojo.desc(134,"Apply"),function(){this.parent.parent.applyBufferedSlices();},true,{alias:"applyBtn",bindings:{enabled:"this.parent.parent.applyEnabled"}})]}],layoutConfig:{h:{controlNode:"auto",containerNode:"100%"},w:{controlNode:"100%",containerNode:"100%"},xt:true},init:function W(h){this._super(h);this.controller.view.attachEventListener("destroyLayout",this.id,function(k){var j=mstrmojo.vi.models.VIComponentMap.TYPES.FILTER_STACK;if(this.builder.getLayoutVIMap(k.key).getComponentKey(j)===this.k){this.destroy();}});if(mstrApp.isAppStatePause&&mstrApp.isAppStatePause()){this.defn.set("cas",false);}this.set("autoApply",this.isAutoApply());this.set("title",this.model.getCurrentLayoutDef().title||"");this.set("editTitleOnDoubleClick",mstrApp.allowWebDashboardDesign());},postBuildRendering:function a(){this._super();if(this.contents){this.contents.attachEventListener("filterPanelUpdated",this.id,this.updateScrollbars);}},postBuildDom:function D(){if(this._super){this._super();}if(mstrApp.isAppStatePause&&mstrApp.isAppStatePause()&&this.model&&this.model.hasRADataset()){this.set("isMasked",true);}},updateScrollbars:function f(){this._super();},getFilterDefinitions:function S(){return this.getFilters().map(function(h){return h.defn;});},getFilters:function B(){var h=this.contents;return h?(h.children||[]).map(function(j){return j.selector;}):[];},isEmpty:function M(){var h;try{h=this.node.data.panels[0].objects[0];}catch(j){}return !!h;},isAutoApply:function J(){var j=this.defn||this.node.defn;if(j.cas===undefined){var h=this.model;return !h.hasMDXRADataset(h.datasets);}return j.cas;},getFilterBySrcId:function A(h){return this.getFilters().filter(function(j){return j.defn.srcid===h;})[0];},widgetResized:function H(){if(this.hasRendered){this.containerNode.style.height=parseInt(this.height,10)-this.controlNode.offsetHeight+"px";}this._super();var h=this.fpsTitleBar&&this.fpsTitleBar.fpsTitle;if(h&&h.widgetResized){h.widgetResized();}},titleEdited:function c(k,h){var j=this.model;j.changeCurrLytTabTtl(k,h);},onscroll:function b(){this._super();var h=this.contents&&this.contents.children;if(h&&h[0]){h[0].updateForScroll();}},onAppStateChange:function Q(h){var m=mstrmojo.vi.VisualInsightApp.APP_STATES,j=m.PAUSE,k=mstrApp.isAppStatePause(),l=!!(h.valueWas&j);if(k!==l){if(k){this.casValue=this.defn&&this.defn.cas;this.set("autoApply",false);this.defn.set("cas",false);}else{this.defn.set("cas",this.casValue);delete this.casValue;this.set("autoApply",this.isAutoApply());}if(this.model&&this.model.hasRADataset()){this.set("isMasked",k);}}},onStatusChange:function R(){var h=this.contents&&this.contents.children;if(h&&h[0]){h[0].closeVisSelectorPanel();}}});}());(function(){mstrmojo.requiresCls("mstrmojo.Obj","mstrmojo.array","mstrmojo.hash","mstrmojo.func","mstrmojo.vi.ui.DatasetUnitMenuUtils","mstrmojo.vi.models.EnumDragSources","mstrmojo.chart.model.enums.EnumDSSObjectType","mstrmojo.vi.models.DatasetDoubleClick","mstrmojo.vi.models._CheckDataCards","mstrmojo.vi.util.TemplateUtils");var U=mstrmojo.hash,k=mstrmojo.array,AB=mstrmojo.func,a=mstrmojo.vi.util.TemplateUtils,u=mstrmojo.vi.ui.DatasetUnitMenuUtils,X="00000000000000000000000000000000",l=mstrmojo.vi.models.EnumDragSources,W=mstrmojo.chart.model.enums.EnumDSSObjectType,d=mstrmojo.vi.enums.EnumFeatures,Y=mstrmojo.vi.viz.EnumDSSDropZones;var Z={ABOVE:0,ON:1,BELOW:2};mstrmojo.vi.models.DropZoneItemType=null;mstrmojo.vi.models.DropZoneType=null;mstrmojo.vi.models.DropZonesEditorConfigType=null;function J(AK,AG,AI,AL,AO,AJ,AM,AN){var AH={act:AK,zoneId:AG,unitId:AI,unitType:AL};if(AO!==undefined){AH.unitPos=AO+1;}if(AN!==undefined){AH.is_disableonly=AN;}if(AJ){AH.datasetId=String(AJ);AH.datasetType=String(AM);}return AH;}function O(AG){return function(AH){var AI=[{t:AG,did:NaN}];return !!this.getAllowDropInfo(AH,AI,AH.items.length-1,Z.BELOW,{src:{data:{src:l.DATASETS}}}).allowedItems.length;};}mstrmojo.vi.models.DropZonesModel=mstrmojo.declare(mstrmojo.Obj,[mstrmojo.vi.models._CheckDataCards],{scriptClass:"mstrmojo.vi.models.DropZonesModel",hostId:"",docModel:null,getDropZones:mstrmojo.emptyFn,getDZFlatStruct:function L(){var AJ=this.getHost().model.data,AK=AJ.gsi||{},AG=(AK.rows||[]).concat(AK.cols||[]),AI={},AH={};AG.forEach(function(AL){if(AL.hasOwnProperty("st")&&AL.hasOwnProperty("did")){AI[AL.did]=AL.st;}});if(AJ.dz){Object.keys(AJ.dz).forEach(function(AN){var AL=AJ.dz[AN],AM=(AL.TemplateUnit||[]).concat(AL.TemplateMetric||[]);AM.forEach(function(AO){var AP=AO.id;if(AO.st===undefined&&AI.hasOwnProperty(AP)){AO.st=AI[AP];}});AH[AN]=AM;});}return AH;},getAvatarIconClass:function c(){throw new Error(this.scriptClass+" must implement getAvatarIconClass method.");},canSwapAxis:function t(){return false;},swapAxis:function A(){if(this.canSwapAxis()){throw new Error(this.scriptClass+" must implement swapAxis method if this.canSwapAxis returns true.");}},canDefineSubtotals:function(){var AG=this.getHost();if(AG&&AG.GMController&&AG.GMController.isWaterfall){return true;}return false;},hasVisibleSubtotals:function j(){var AG=this.getHost();return AG.getWidgetPropertyValue("totalShw")||(AG.getWidgetPropertyValue("intSumShw")&&AG.GMController.hasAttributesInDropzone("BreakBy"));},showQuickSubtotals:function I(){var AG=this.getHost();AG.writeGlobalProperty("totalShw:intSumShw",true);},hideDefinedSubtotals:function AA(){var AG=this.getHost();AG.writeGlobalProperty("totalShw:intSumShw",false);},getZoneMenuItems:function w(AH,AG){},getUnitMenuItems:function n(AH,AG,AJ,AI){},getMultiUnitsMenuItems:function h(AH,AG,AI){var AJ=this.id;if(!mstrApp.isInVFConfigMode&&u.getMultiSelectionShortcutMetricFunctions(AI).length&&mstrmojo.resolveFeature(d.INSERT_NEW_METRIC)){AH.addSubMenuItem(mstrmojo.desc(5188,"Calculation"),"",this.id,function(){return mstrmojo.all[AJ].getMultipleMetricsCalcMenus(AG,AI,true);});}AH.addMenuItem(mstrmojo.desc(190,"Remove"),"xt",function(){mstrmojo.all[AJ].deleteItems(AG,AI);});},deleteItem:function K(AH,AG){this.throwAbstractMethodError("deleteItem");},deleteItems:function K(AG,AH){this.throwAbstractMethodError("deleteItems");},addZoneItem:function g(AI,AJ){AI.t=AI.t||4;if(AI.did===undefined){AI.did=AI.id;}var AG=a.findUnitsById(this.getHost().model.data.gsi,AI.did)[0];if(AG){U.copyProps(["n","um"],AG,AI);}var AH=this.docModel.datasets,AL=false,AK=AI.t===4?"mx":"att";Object.keys(AH).every(function(AM){(AH[AM][AK]||[]).every(function(AO){if(AO.did===AI.did){AL=true;var AP,AN=AO.n;for(AP in AO){if(!AI.hasOwnProperty(AP)){AI[AP]=AO[AP];}}if(AN!==AI.n){AI.objectNameinDataset=AN;}}return !AL;});return !AL;});AJ.push(AI);},getZone:function v(AL,AK,AJ,AG,AH){var AI=[];(AJ||[]).forEach(function(AM){this.addZoneItem(U.copy(AM),AI,AH);},this);return{n:AL,id:AK,enabled:!AG,cssClass:(AH&&AH.allowSingle)?"singleUnitZone":"",getDropIconCls:function(){return"pivot";},title:(AH&&AH.title)||"",items:AI};},getZoneForObject:function R(AH){var AG=null;this.getDropZones().zones.every(function(AI){if(k.find(AI.items,"did",AH)>-1){AG=AI;return false;}return true;});return AG;},getUnitIndexInZone:function r(AG,AH){return k.find(AG.items,"did",AH.did);},isZoneDropAllowed:function V(AG){if(!AG.enabled){return false;}return true;},getAllowDropInfo:function C(AH,AI,AG,AJ){return{allowedItems:AI.concat(),removeReplaced:AJ===Z.ON&&AH&&AH.items&&AH.items[AG]&&k.find(AI,"did",AH.items[AG].did)===-1};},getTargetEdgePortion:function P(AG){return 0.33;},allowInsertNewMetric:O(4),allowInsertNewAttribute:O(12),unitsDropped:function AC(AG,AH,AI,AK,AJ){if(this.unitDropped!==mstrmojo.vi.models.DropZonesModel.prototype.unitDropped){return this.unitDropped(AG,AH,AI.idx,AI.edge,AK,AJ);}this.throwAbstractMethodError("unitsDropped");},getHost:function e(){return mstrmojo.all[this.hostId];},getHostModel:function B(){this.throwAbstractMethodError("getHostModel");},shouldMetricNameShowIcon:function AF(){return true;},addUnitsFromDataSource:function H(AN,AL,AJ,AH){var AO=this,AS=AO.docModel,AK=AS.controller,AG;AJ=AJ||[];var AI=false,AR=this.getHost(),AM=[],AT;[].concat(AN).forEach(function(AU){AT=this.isMetric(AU);AI=AT||AI;AG=mstrmojo.vi.models.DatasetDoubleClick.addObject(AU,AL,this);AJ=AJ.concat(AG);if(AT){AM.push(AU);}},this);if(AJ&&AJ.length){if(AI&&AG&&AG[0].actions){AG[0].actions.push(AR.model.getValuesDefaultFormatGridZoneAction(AM,true));}var AQ=AK._getXtabCallback(this.getHost());if(AH){AQ=AB.wrapMethods(AH,AQ);}var AP=function(){AS.checkAndNotifyVFChangeOnDZUnitsUpdate({actions:AJ,zm:AO},function(){AJ=AS.wrapUnsetVisualizationFilterAction(AJ);return AK.submitUndoRedoUpdates(AJ,{},AQ);},function(){return AK.submitUndoRedoUpdates(AJ,{},AQ);});};if(this.existLargeOrManyItems()){this.warnAndExecCallBackForAddUnits(function(){AP();});return ;}if(this.getHost().isOutlineMode){this.warnAndExecCallBackForOutlineAddUnits(function(){AP();});return ;}AP();}},changeZoneUnits:function q(AH,AG,AI){},getZoneAddCandidates:function b(AG){return[];},getRequiredItemsInfo:function m(AH){if(!AH){return 0;}var AG=[];this.getDropZones().zones.forEach(function(AI){AG=AG.concat(AI.items);});return Number(AG.reduce(function(AI,AJ){if(parseInt(AJ.did,10)!==-1&&AJ.t===AH){return AI+1;}return AI;},0));},getUpdateCallback:function S(){var AG=this.id;return{success:function(){var AK=mstrmojo.all[AG];if(!AK){return ;}var AM=AK.getHost();if(!AM){return ;}var AL=mstrmojo.all.visualizationFilterToolbar,AJ=AK.docModel,AO,AI,AN,AH;if(mstrApp.isInVFConfigMode){AO=AM.zonesModel;AM.parent.selectVIUnit(true);AH=AO&&AO.isTemplateContainAttCategoryItem();mstrApp.isEnableSaveBtn=AH;AL.toggleSaveBtn(AH);}else{AI=AM.parent&&AM.parent.k;AN=AJ.getPanel().getUnitByKey(AI);if(AN){AN.selectVIUnit(true);}}}};},getUpdateTemplateAction:function N(AG,AH){return this.docModel.getDataService().getUpdateTemplateAction(AH||this.getHost().k,AG);},getReplaceCandidates:function M(AJ,AO){var AK=[],AI=AO.t,AG=AO.did,AH=this.getHostModel().datasetId,AM=AJ.id===Y.AdditionalMetrics,AN=this.getHost(),AL=AN.getChartStyle&&AN.getChartStyle()==="NewGraphMatrixVisualizationStyle";this.getDropZones().zones.forEach(function(AP){((AP&&AP.items)||[]).forEach(function(AR){var AS=AR.t,AQ=AR.did;if(AS!=undefined&&AQ!=undefined&&AS!==21&&AQ!=="-1"&&AQ!==X&&((AS===4&&AI===4)||(AS!==4&&AI!==4))&&AQ!==AG&&k.find(AK,"did",AQ)===-1){AK.push(AR);}});});if(!AL||!AM){if(AH){this.docModel.getDatasetUnits(AI===4?["mx"]:["att"],null,AH).forEach(function(AP){if(k.find(AK,"did",AP.did)===-1&&AP.did!==AG&&!AP.hide&&!AN.model.hasSameRecursiveAttributeGroup(AP,AN.gridData,AO)){AK.push(AP);}});}}return u.getSortedDatasetUnits(AK);},getDropTargetIndex:function E(AH,AJ){var AG=AJ.idx,AI=(AJ.edge===Z.ON&&!AJ.removeReplaced)?Z.BELOW:AJ.edge,AL=AG,AK=this,AM={};AJ.allowedItems.forEach(function(AO){var AN=AK.getUnitIndexInZone(AH,AO);if(AN!==-1){AM[AN]=AO;}});U.forEach(AM,function(AO,AP){var AN=parseInt(AP,10);if(AN<AG){AL--;}else{if(AN===AG){AI=Z.ON;}}});return AI===Z.BELOW?(AL+1):AL;},getAddDropZoneUnitAction:function p(AH,AJ,AG,AI){return J("addDropZoneUnit",AH.id,AJ.did,AJ.t,AG,AI&&AI.datasetId,(AI&&AI.datasetType)||W.DssTypeReportDefinition);},getAddDropZoneUnitsActions:function AE(AH,AI,AG,AJ){return AI.reverse().map(function(AK){return J("addDropZoneUnit",AH.id,AK.did,AK.t,AG,AJ&&AJ.datasetId,(AJ&&AJ.datasetType)||W.DssTypeReportDefinition);});},getRemoveDropZoneUnitActions:function G(AK,AO,AM){if(AM===undefined||AM===null){AM=1;}var AH=[];if(AK.id===Y.ColorBy&&this.isMetric(AO)){var AG=AO.id||AO.did;var AJ=this.getHostModel(),AL=AJ&&AJ.gsi,AN=AL&&AL.thresholds&&AL.thresholds[AG]||[];for(var AI=AN.length-1;AI>=0;AI--){AH.push({act:"clearThreshold",unitId:AG,unitType:AO.t,tid:AN[AI].tid});}}if(AO){AH.push(J("removeDropZoneUnit",AK.id,AO.did,AO.t,undefined,undefined,undefined,AM));}return AH;},checkAndAddThresholdAction:function z(AI,AG,AH){return false;},getAllZones:function(){return this.getDropZones().zones||[];},getClearAllUnitsActions:function Q(){var AG=[];(this.getAllZones()).forEach(function(AH){((AH&&AH.items)||[]).forEach(function(AI){Array.prototype.push.apply(AG,this.getRemoveDropZoneUnitActions(AH,AI));},this);},this);return AG;},getClearAllUnitsUnTemplateActions:function f(){return[];},clearAllDropZones:function x(AK){var AH=this.docModel,AJ=this,AG=AJ.getAllZones().filter(function(AM){return AM&&AM.items&&AM.items.length;}).map(function(AM){return AM.id;}),AI=function(){AK=AK||{actions:[]};AK.actions=AH.wrapUnsetVisualizationFilterAction(AK.actions);AJ.clearAllDropZonesDeferred(AK);},AL=function(){AJ.clearAllDropZonesDeferred(AK);};return AH&&AH.checkAndNotifyVFChangeOnClearAll({zm:AJ,ca:AG,cmb:true},AI,AL);},clearAllDropZonesDeferred:function D(AP){var AI=this.getClearAllUnitsActions(),AK=this.getClearAllUnitsUnTemplateActions(),AR=this.getHost(),AN=AR.id,AJ=AR.gridData||AR.model.data||AR.node.data,AM=AJ.vlexpr,AS=this.docModel,AH=AR.model,AL=AS.controller,AO=AB.wrapMethods({success:function(){var AT=mstrmojo.all[AN];if(AT._viSelections){AT.clearSelections();AT.endSelections();}}},AL._getXtabCallback(AR),{success:function AQ(){mstrmojo.all[AN].raiseEvent({name:"regenerateToolbar"});}}),AG=AH.getKeepOnlyActionsForAssociatedNodes([],AO);if(AM){AG.actions.push(AL.dataService().getUpdateTemplateAction(AR.k,AH.getRemoveMetricLimitsAction(AM)));}if(AP){AP.actions=[].concat(AP.actions).concat(AG.actions);AP.callback=AB.wrapMethods(AP.callback,AG.callback);}else{AP=AG;}if(AK&&AK.length>0){AP.actions=AP.actions.concat(AK);}this.submitDropZoneTemplateUpdates(AI,AP);},submitDropZoneUpdates:function o(AM,AN,AI){var AK=this.getHost(),AH=this.docModel,AG=AH.controller,AJ=[].concat(AM||[]);if(AJ&&AJ.length){var AL=AN||AG._getXtabCallback(AK);AG.cmdMgr.execute({execute:function(){this.submit(AJ,AL,AI);},urInfo:{callback:AL}});}},submitDropZoneTemplateUpdates:function F(AG,AI){var AH=(AG&&AG.length)?[this.getUpdateTemplateAction(AG)]:[];if(AI&&AI.actions){AH=AH.concat(AI.actions);}this.submitDropZoneUpdates(AH,AI&&AI.callback,AI&&AI.extras);},getHighlightTargets:function AD(AH,AG){return[AG];}});mstrmojo.vi.models.DropZonesModel.ENUM_TARGET_POSITION=Z;mstrmojo.vi.models.DropZonesModel.ENUM_REQUIREMENT_TYPE={ATTRIBUTE:12,METRIC:4,LONGITUDE:"long",LATITUDE:"lat"};}());(function(){mstrmojo.requiresCls("mstrmojo.hash","mstrmojo.dom","mstrmojo.elementHelper","mstrmojo.func","mstrmojo.VisEnum","mstrmojo.num","mstrmojo.array","mstrmojo.VisMenuList","mstrmojo.mstr.EnumFunction","mstrmojo._HasMarkup","mstrmojo.chart.model.enums.EnumDSSObjectType","mstrmojo.models.FormatModel","mstrmojo._FormatDefinition","mstrmojo.css","mstrmojo.chart.enums.EnumFontStyle","mstrmojo.vi.ui.DatasetUnitMenuUtils","mstrmojo.chart.model.enums.EnumDSSBaseFormType","mstrmojo.string","mstrmojo.vi.viz.EnumVizStyles","mstrmojo.vi.enums.EnumFeatures","mstrmojo.vi.ui.rw.GhostImageContainer","mstrmojo.vi.ui.rw.FreezingImageContainer");mstrmojo.requiresClsP("mstrmojo.ui.menus","MenuConfig","EditorConfig");var N=document.getElementById("vis-measure-canvas"),E=document.getElementById("vis-measure-span"),f={},M={},q={},AD=mstrmojo.dom,d=mstrmojo.elementHelper,AU=mstrmojo.vi.ui.DatasetUnitMenuUtils,V=mstrmojo.VisEnum.EnumColorRankMode,p=mstrmojo.chart.model.enums.EnumDSSObjectType,AM=mstrmojo.chart.model.enums.EnumDSSBaseFormType,AS=mstrmojo.models.FormatModel.ENUM_PROPERTY_NAMES,AW=mstrmojo.chart.enums.EnumFontStyle,X=mstrmojo.hash,c=mstrmojo.string,Ad=mstrmojo.func.wrapMethods,Z=mstrmojo.VisEnum,Q=mstrmojo._FormatDefinition,Ag=Z.SERVER_JSON_ERROR_TYPE,w=mstrmojo.vi.viz.EnumVizStyles,AN=mstrmojo.vi.enums.EnumFeatures,D=mstrmojo.vi.ui.rw.FreezingImageContainer,Ab=mstrmojo.vi.ui.rw.GhostImageContainer;var u=64,AF=128,C=4,z=5,b=6,F=7,e=mstrmojo,S=e.array,Ae=mstrmojo.array,A=e.desc,j=e.mstr.EnumFunction,U=mstrmojo.vi.enums.EnumDerivedElementType,AZ=e._HasMarkup,Ac=e.css;var P;mstrmojo.requiresDescs(221,358,1422,2122,6017,5868,5869,11819,11827);function Af(Al,Ak){var Aj=mstrmojo.VisUtility;var Am=Aj.pluck(Ak,"tid"),An=Aj.pluck(Ak,"eid"),Ai=(Al.getDocModel&&Al.getDocModel())||Aj.getPropertyByPath(Al,"model.docModel");if(Aj.getPropertyByPath(Ai,"getColorBy") instanceof Function){return Ai.getColorBy(Am,An);}}function Aa(Ai,Ak,Am){var Al=Ak.id,Aj=Ak.getHost();if(Aj&&Aj.observableModel){Ai.forEach(function(Ao){var An=Aj.observableModel[Ao];if(An){An.attachEventListener("valueChanged",Al,Am);}});}}function Ah(Aj){var Ai={SINGLE:[{text:A(358,"Absolute"),value:j.FunctionAbs,n:A(358,"Absolute"),v:j.FunctionAbs}],PAIR:[{text:A(6017,"Add"),value:j.FunctionAdd,n:A(6017,"Add"),v:j.FunctionAdd},{text:A(2122,"Average"),value:j.FunctionAverage,n:A(2122,"Average"),v:j.FunctionAverage},{text:A(5868,"Least"),value:j.FunctionLeast,n:A(5868,"Least"),v:j.FunctionLeast},{text:A(5869,"Greatest"),value:j.FunctionGreatest,n:A(5869,"Greatest"),v:j.FunctionGreatest},{text:"A-B",value:j.FunctionMinus+";0",n:"A-B",v:j.FunctionMinus+";0"},{text:"B-A",value:j.FunctionMinus+";1",n:"B-A",v:j.FunctionMinus+";1"},{text:"A/B",value:j.FunctionDivide+";0",n:"A/B",v:j.FunctionDivide+";0"},{text:"B/A",value:j.FunctionDivide+";1",n:"B/A",v:j.FunctionDivide+";1"}],MORE:[{text:A(6017,"Add"),value:j.FunctionAdd,n:A(6017,"Add"),v:j.FunctionAdd},{text:A(2122,"Average"),value:j.FunctionAverage,n:A(2122,"Average"),v:j.FunctionAverage},{text:A(5868,"Least"),value:j.FunctionLeast,n:A(5868,"Least"),v:j.FunctionLeast},{text:A(5869,"Greatest"),value:j.FunctionGreatest,n:A(5869,"Greatest"),v:j.FunctionGreatest}]};return Ai[Aj];}function AR(Aj,Ai){return !!(((Aj&&Aj.at)||0)&Ai);}function Y(Ai){return !Ai.cmSelCells.some(function(Aj){var Ak=Ai.getCellForNode(Aj);return d.isNonGroupNull(Ak)||!AR(Ak,u)||Ak.dei!==undefined||Ai.model.isRecursiveAttribute(Ak.tid);});}function l(Aj){var Ai;return !Aj.cmSelCells.some(function(Ak){Ai=Aj.getCellForNode(Ak);return(d.isNonGroupNull(Ai)||!AR(Ai,AF))||Aj.model.isRecursiveAttribute(Ai.tid);});}function W(Al,Ak,An,Am,Aj){var Ai=An&&An.func;if((Ai===Am)||(typeof Am==="string"&&Am.indexOf(Ai)===0&&Am.indexOf(";0")>0)){return ;}if(Aj){Al.editDECalculation(Ak,Am);}else{Al.derivedElementCalculation(Ak,Am);}}function m(Au,As,Aq){var At=As&&As.es,Ai=(At&&At.length)||Au.cmSelCells.length,Al=(Ai===1)?"SINGLE":((Ai===2)?"PAIR":"MORE"),Ar=Ah(Al),Ak=(As&&As.func),Am,Av=Au.cmSelCells,Aj,Ap,Ao,An;if(Al==="PAIR"){if(As){An=At[0].v>At[1].v;if(An){Ao=At[0].n;Ap=At[1].n;Ar[4]={value:j.FunctionMinus+";1",v:j.FunctionMinus+";1"};Ar[5]={value:j.FunctionMinus+";0",v:j.FunctionMinus+";0"};Ar[6]={value:j.FunctionDivide+";1",v:j.FunctionDivide+";1"};Ar[7]={value:j.FunctionDivide+";0",v:j.FunctionDivide+";0"};}else{Ap=At[0].n;Ao=At[1].n;}}else{Ap=Aq(Av[0]);Ao=Aq(Av[1]);}Ar[C].text=Ap+" - "+Ao;Ar[z].text=Ao+" - "+Ap;Ar[b].text=Ap+" / "+Ao;Ar[F].text=Ao+" / "+Ap;Ar[C].n=Ap+" - "+Ao;Ar[z].n=Ao+" - "+Ap;Ar[b].n=Ap+" / "+Ao;Ar[F].n=Ao+" / "+Ap;}for(Am in Ar){if(typeof Ar[Am].value==="string"&&Ar[Am].value.indexOf(Ak)===0&&Ar[Am].value.indexOf(";0")>0){Aj=Ar[Am];break;}if(Ar[Am].value===Ak){Aj=Ar[Am];break;}}return{items:Ar,selectedItem:Aj};}function v(Ai,Al){if(!Ai){return Ai;}if(Al.length===1){return Ai[Al[0]];}var Ak=(Al&&Al.length)||0,Aj;for(Aj=0;Aj<Ak;Aj++){Ai=Ai[Al[Aj]];if(!Ai){break;}}return Ai;}function AT(Ak,Aj,Ai){return Ak.every(function(Al){return Al.ttp===Aj||Al.ttp===Ai;});}function G(Aj,Am,An){var Al=(Am&&Am.length)||0,Ak,Ai,Ao=Aj;for(Ak=0;Ak<Al-1;Ak++){Ai=Am[Ak];if(!Ao[Ai]){Ao[Ai]={};}Ao=Ao[Ai];}Ao[Am[Al-1]]=An;}function AC(Aq){var Ar,Ap,Al,An,Ai,Ao=this.model.docModel.datasets,Aj=false,Am=false,Ak={isDM:false};for(Ar in Ao){if(Ao.hasOwnProperty(Ar)){Ap=Ao[Ar].mx;S.forEach((Ap||[]),function(As){if(As.did===Aq){if(As.um||As.rdm){Am=true;}Aj=true;return false;}});if(Aj){break;}}}if(Am){Ai=this.model.data.gts.col;Al=(Ai&&Ai[Ai.length-1]);if(Al&&Al.otp===-1){An=Al.es;}S.forEach((An||[]),function(As){if(As.oid===Aq){Ak={isDM:true,id:As.id};return false;}});}return Ak;}function L(Ai,Al){var Ao=[],Ak={act:"updateElementsPropertiesMap",epm:Ao},Am=[],Aj={},Aq=[Aj],Ap=this;Ao.push({epmk:Am,epmv:Aq});Ai.forEach(function(As){var At=As.tid,Av=As.tp,Ar=At===-1,Au={ob:{did:Ar?"":At,tp:Av}};Am.push(Au);});if(Al&&Al.indexOf("default")<0){Aj.v={vv:Al};}var An=[];Aj.k={chn:An};Ai.forEach(function(At){var Au=At.tid,Ar=Au===-1,As;if(Ar){As=AC.call(Ap,At.eid);if(As.isDM){An.push({emt:2,ei:As.id});}else{An.push({emt:2,mt:{did:At.eid,tp:4,ql:0}});}}else{An.push({emt:1,ei:At.eid,at:{did:Au,tp:At.tp,ql:0}});}});return Ak;}function AO(Am,Ak){var Al="00000000000000000000000000000000",Aj=Am&&Am.dropZones,Ai=S.find(Aj,"id",Ak);return Ai===-1?[]:S.filter(Aj[Ai].items,function(An){return An.t===4&&An.id!==Al;});}function AI(An,Ak,Am,Aj,Ai){var Ao=Aj?An:An&&An.parentNode;while(Ao&&(Ao!==Ai)){var Al=Ao.getAttribute&&Ao.getAttribute(Ak);if(Al!==null&&Al.indexOf(Am)>=0){return true;}Ao=Ao.parentNode;}return false;}function AB(Aj,Ak){var Ai=X.walk("rootCtrl.docCtrl",mstrApp);if(Ai&&(typeof Ai.selectViPanel==="function")){Ai.selectViPanel(Ak);}Aj.getDocModel().selectVIUnit(Aj.parent.id,true);}var H={sessions:{},instances:[],init:function AJ(){this.supportedEventTypes=[];if(window.TouchEvent){this.supportedEventTypes.push("TouchEvent");}else{if(window.PointerEvent){this.supportedEventTypes.push("PointerEvent");}}if(window.MouseEvent){this.supportedEventTypes.push("MouseEvent");}return this;},startNewSessions:function AG(Ai){var Am=this;var Ak=this;var Aj=document;var Al=function(Aw){var Ar=Ai.callbacks.start.bind(Ai.callbackThis),As=Ai.callbacks.change.bind(Ai.callbackThis),At=Ai.callbacks.end.bind(Ai.callbackThis),Av=Ai.callbacks.context;var Ao={};Ao.identifier=Aw.identifier;Ao.context=X.clone(Av);Ao.clientX=Aw.clientX;Ao.clientY=Aw.clientY;var Aq=function Aq(Ax){var Ay=this.context;return Ar({api:Ak,event:Ax,session:this,context:Ay});};var Au=function Au(Ay,Ax){var Az=this.context,A1=0,A0=0;A1=Ax.clientX-this.clientX;A0=Ax.clientY-this.clientY;this.clientX=Ax.clientX;this.clientY=Ax.clientY;var A2={api:Ak,event:Ay,deltaX:A1,deltaY:A0,session:this,context:Az};return As(A2);};var Ap=function Ap(Ax){var Ay=this.context;return At({api:Ak,event:Ax,session:this,context:Ay});};Ao.onStart=Aq;Ao.onChange=Au;Ao.onEnd=Ap;return Ao;};var An=function(Ap,Ao){Ap.listeners={};Ap.listeners.change=function(Aq){var Ar=Am.getChangedSessions(Aq);for(var As=0;As<Ar.length;As++){if(Ap.identifier===Ar[As].identifier){return Am.sessions[Ap.identifier].onChange(Aq,Ar[As]);}}};Ap.listeners.end=function(Ar){var As=Am.getChangedSessions(Ar);for(var At=0;At<As.length;At++){if(Ap.identifier===As[At].identifier){if(window.TouchEvent&&window.TouchEvent.prototype.isPrototypeOf(Ao)){Aj.removeEventListener("touchmove",Ap.listeners.change);Aj.removeEventListener("touchend",Ap.listeners.end);Aj.removeEventListener("touchcancel",Ap.listeners.end);}else{if(window.PointerEvent&&window.PointerEvent.prototype.isPrototypeOf(Ao)&&(Ao.pointerType&&Ao.pointerType!=="mouse")){Aj.removeEventListener("pointermove",Ap.listeners.change);Aj.removeEventListener("pointerleave",Ap.listeners.end);Aj.removeEventListener("pointerup",Ap.listeners.end);}else{if(window.MouseEvent&&window.MouseEvent.prototype.isPrototypeOf(Ao)&&!Ao.pointerType){Aj.removeEventListener("mousemove",Ap.listeners.change);Aj.removeEventListener("mouseup",Ap.listeners.end);}}}var Aq=Am.sessions[Ap.identifier].onEnd(Ar);delete Am.sessions[Ap.identifier];return Aq;}}};if(window.TouchEvent&&window.TouchEvent.prototype.isPrototypeOf(Ao)){Aj.addEventListener("touchmove",Ap.listeners.change);Aj.addEventListener("touchend",Ap.listeners.end);Aj.addEventListener("touchcancel",Ap.listeners.end);}else{if(window.PointerEvent&&window.PointerEvent.prototype.isPrototypeOf(Ao)&&(Ao.pointerType&&Ao.pointerType!=="mouse")){Aj.addEventListener("pointermove",Ap.listeners.change);Aj.addEventListener("pointerleave",Ap.listeners.end);Aj.addEventListener("pointerup",Ap.listeners.end);}else{if(window.MouseEvent&&window.MouseEvent.prototype.isPrototypeOf(Ao)&&!Ao.pointerType){Aj.addEventListener("mousemove",Ap.listeners.change);Aj.addEventListener("mouseup",Ap.listeners.end);}}}};return function(Aq){var Ar=Am.getChangedSessions(Aq),Ap=Am.sessions,As=Ar.filter(function(At){if(Ap[At.identifier]){return false;}else{return true;}});As.forEach(function(At){Am.sessions[At.identifier]=Al(At);An(Am.sessions[At.identifier],Aq);});var Ao=[];As.forEach(function(At){Ao.push(Am.sessions[At.identifier].onStart(Aq));});return Ao;};},newInstance:function AL(Al,Ao,An){var Ak,Aj,Ai=this.getInstanceIndex(Al);if(Ai!==-1){for(Ak=0;Ak<this.supportedEventTypes.length;Ak++){Aj=this.supportedEventTypes[Ak];if(Aj==="TouchEvent"){Al.removeEventListener("touchstart",this.instances[Ai].starter);}else{if(Aj==="PointerEvent"){Al.removeEventListener("pointerdown",this.instances[Ai].starter);}else{if(Aj==="MouseEvent"){Al.removeEventListener("mousedown",this.instances[Ai].starter);}}}}delete this.instances[Ai];}var Am={domNode:Al,callbacks:Ao,callbackThis:An};Am.starter=this.startNewSessions(Am);if(Ai!==-1){this.instances[Ai]=Am;}else{this.instances.push(Am);}for(Ak=0;Ak<this.supportedEventTypes.length;Ak++){Aj=this.supportedEventTypes[Ak];if(Aj==="TouchEvent"){Al.addEventListener("touchstart",Am.starter);}else{if(Aj==="PointerEvent"){Al.addEventListener("pointerdown",Am.starter);}else{if(Aj==="MouseEvent"){Al.addEventListener("mousedown",Am.starter);}}}}return this;},getInstanceIndex:function J(Ai){return S.find(this.instances,"domNode",Ai);},getInstance:function o(Aj){var Ai=this.getInstanceIndex(Aj);return this.instances[Ai];},getChangedSessions:function AE(Ai){var Aj=[];if(window.TouchEvent&&window.TouchEvent.prototype.isPrototypeOf(Ai)){var Am=Ai.changedTouches;for(var Ak=0;Ak<Am.length;Ak++){var Al={};Al.identifier=Am[Ak].identifier;Al.clientX=Am[Ak].clientX;Al.clientY=Am[Ak].clientY;Aj.push(Al);}}else{if(window.PointerEvent&&window.PointerEvent.prototype.isPrototypeOf(Ai)&&(Ai.pointerType&&Ai.pointerType!=="mouse")){Aj.push({identifier:Ai.pointerId,clientX:Ai.clientX,clientY:Ai.clientY,});}else{if(window.MouseEvent&&window.MouseEvent.prototype.isPrototypeOf(Ai)&&!Ai.pointerType){Aj.push({identifier:"mouse",clientX:Ai.clientX,clientY:Ai.clientY,});}}}return Aj;}};var t=H.init();mstrmojo.VisUtility=mstrmojo.provide("mstrmojo.VisUtility",{getCache:function(){return JSON.stringify(q);},getUpdateColorMapAction:function(Aj,Ai){return L.call(this,Aj,Ai);},measureTextSize:function(Aj,Ai,Ak){return{width:this.measureTextWidth(Aj,Ai,Ak),height:this.measureTextHeight(Aj,Ai,Ak)};},measureTextWidth:function(Al,Ak,Am,Aj,Ai){if(AD.isIE||AD.isIEW3C){return this.measureTextWidthWithSpan(Al,Ak,Am,Aj,Ai);}return this.measureTextWidthWithCanvas(Al,Ak,Am);},measureTextWidthWithCanvas:function(Al,Am,Ap,An){An=An||false;if(Al===""){return 0;}if(Al===" "){Al="\u00A0";}var Ao=Am.fontFamily,Ar=Am.fontSize,Ak=Am.fontStyle,Aq=Am.fontWeight;if(typeof Ar==="number"){Ar+="pt";}Ak=Ak||"normal";Aq=Aq||"normal";Ap=Ap||0;var Aj=An?undefined:v(f,[Ao,Ar,Ak,Aq,Al]);if(!Aj){if(!N){N=document.createElement("canvas");N.width=0;N.height=0;N.id="vis-measure-canvas";N.style.position="absolute";N.style.top="0";N.style.fontSize="medium";document.body.appendChild(N);}var Ai=N.getContext("2d");Ai.font=Ak+" "+Aq+" "+Ar+" "+this.surroundWithQuotes(Ao);Aj=Math.ceil(Ai.measureText(Al).width);G(f,[Ao,Ar,Ak,Aq,Al],Aj);}return Aj+Ap;},measureTextWidthQuick:function(Al,Am,Ap,An){An=An||false;if(Al===""){return 0;}if(Al===" "){Al="\u00A0";}var Ao=Am.fontFamily,Ar=Am.fontSize,Ak=Am.fontStyle,Aq=Am.fontWeight;if(typeof Ar==="number"){Ar+="pt";}Ak=Ak||"normal";Aq=Aq||"normal";Ap=Ap||0;var Aj=An?undefined:v(f,[Ao,Ar,Ak,Aq,Al]);if(!Aj){if(!N){N=document.createElement("canvas");N.width=0;N.height=0;N.id="vis-measure-canvas";N.style.position="absolute";N.style.top="0";N.style.fontSize="medium";document.body.appendChild(N);}var Ai=N.getContext("2d");Ai.font=Ak+" "+Aq+" "+Ar+" "+this.surroundWithQuotes(Ao);Aj=Math.ceil(Ai.measureText(Al).width);G(f,[Ao,Ar,Ak,Aq,Al],Aj);}return Aj+Ap;},measureTextWidthWithSpan:function(Al,Am,Aq,As,An,Ai){if(Al===""){return 0;}if(Al===" "){Al="\u00A0";}var Ao=Am.fontFamily,At=Am.fontSize,Ak=Am.fontStyle,Ap=Am.fontWeight;if(typeof At==="number"){At+="px";}Ak=Ak||"normal";Ap=Ap||"normal";As=As||"auto";Aq=Aq||0;An=!!An;if(typeof As==="number"){As+="px";}var Aj=v(M,[Ao,At,Ak,Ap,As,Al]);if(!Aj||Ai){var Ar;if(!E){E=document.createElement("span");Ar=E.style;E.id="vis-measure-span";Ar.position="absolute";Ar.top="0";Ar.visibility="hidden";Ar.width="auto";Ar.height="auto";if(An){Ar.whiteSpace="nowrap";}else{Ar.whiteSpace="normal";}document.body.appendChild(E);}Ar=E.style;if(An){Ar.whiteSpace="nowrap";}else{Ar.whiteSpace="normal";}Ar.width="auto";Ar.height=As;Ar.fontFamily=this.surroundWithQuotes(Ao);Ar.fontSize=At;Ar.fontStyle=Ak;Ar.fontWeight=Ap;E.innerHTML=c.encodeHtmlString(Al);Aj=Math.ceil(E.clientWidth);G(M,[Ao,At,Ak,Ap,As,Al],Aj);}return Aj+Aq;},measureTextHeight:function(Ak,Al,Aq,At,Ai,An,Am){if(Ak===""){return 0;}if(Ak===" "){Ak="\u00A0";}var Ao=Al.fontFamily,Av=Al.fontSize,Aj=Al.fontStyle,Ap=Al.fontWeight,As=Al.lineHeight||"inherit";Ai=Ai||"normal";Am=!!Am;if(typeof Av==="number"){Av+="px";}Aj=Aj||"normal";Ap=Ap||"normal";At=At||"auto";Aq=Aq||0;if(typeof At==="number"){At+="px";}var Au=An?undefined:v(q,[Ao,Av,Aj,Ap,At,Ak]);if(!Au){var Ar;if(!E){E=document.createElement("span");Ar=E.style;E.id="vis-measure-span";Ar.position="absolute";Ar.top="0";Ar.visibility="hidden";Ar.width="auto";Ar.height="auto";if(Am){Ar.whiteSpace="nowrap";}else{Ar.whiteSpace="normal";}document.body.appendChild(E);}Ar=E.style;if(Am){Ar.whiteSpace="nowrap";}else{Ar.whiteSpace="normal";}Ar.heigth="auto";Ar.width=At;Ar.lineHeight=As;Ar.fontFamily=this.surroundWithQuotes(Ao);Ar.fontSize=Av;Ar.fontStyle=Aj;Ar.fontWeight=Ap;Ar.wordBreak=Ai;E.innerHTML=c.encodeHtmlString(Ak);Au=E.clientHeight;if(!An){G(q,[Ao,Av,Aj,Ap,At,Ak],Au);}}return Au+Aq;},getVisEmptyMsg:function(Ai,Aj){var Ak="";switch(Ai){case"AE_ERROR":Ak='<div class="gm-vis-msg-container"><div class="gm-vis-msg-vcenter"><div class="gm-vis-msg-hcenter"><div style="padding:25px"><div class="gm-warning-icon" style="padding-bottom:18px"></div><div style="padding-bottom:8px">'+(Aj||this.errorMsg||"")+"</div><div></div></div></div></div></div>";break;case"NODATA_OTHERERROR":Ak='<div class="error-msg"><div class="error-content"><div class="text" style="visibility: visible;padding-top:0px;"><div>'+(this.errorMsg||mstrmojo.desc(2388,"No data returned for this view. This might be because the applied filter excludes all data."))+"</div></div></div></div>";break;default:Ak='<div class="mstrmojo-Label dropMsg" style="display: block;" >'+mstrmojo.desc(11668,"Drag objects here.")+"</div>";}return Ak;},getVisEmptyMsgControls:function B(){var Ak=this.error,Ap,An=this.errorType,Aj;var Al=mstrmojo.VisUtility;if(this.excludeData){Ap=Al.getVisStyle.call(this);var Am=Al.getAttMetricCount.call(this);return[{scriptClass:"mstrmojo.vi.ui.rw.FreezingImageContainer",cssClass:Ap,visName:mstrConfig.pluginsVisList[Ap]&&mstrConfig.pluginsVisList[Ap].d,visDropzoneMsg:D.getVisDropzoneMsg(Am.attCount,Am.metricCount)}];}if(!this.hasError()){return ;}switch(An){case Ag.NO_DATASET:case Ag.NO_TEMPLATE_UNIT:if(mstrApp&&mstrApp.supportFeature&&mstrApp.supportFeature(AN.SUPPORT_GHOST_IMG)){Ap=Al.getVisStyle.call(this);var Aq="",Ao="",Ai="";if(Ap===w.HEAT_MAP){Aq="heatmap";Ao=mstrmojo.desc(11819,"Heat Map");Ai=Ab.getVisDesc("heatmap");}else{if(Ap===w.NETWORK){Aq="network";Ao=mstrmojo.desc(11827,"Network");Ai=Ab.getVisDesc("network");}else{if(Ap===w.KPICARD){Aq="kpicard";Ao=mstrmojo.desc(15800,"KPI");Ai=Ab.getVisDesc("kpicard");}}}Aj=[{scriptClass:"mstrmojo.vi.ui.rw.GhostImageContainer",cssClass:Aq,visName:Ao,visDesc:Ai}];}else{Aj=[{scriptClass:"mstrmojo.Label",cssClass:"dropMsg",text:Ak}];}break;case Ag.AE_ERROR:Aj=[{scriptClass:"mstrmojo.Container",cssClass:"error-msg",markupString:Al.getVisEmptyMsg("AE_ERROR",Ak),markupSlots:{containerNode:function(){return this.domNode;}}}];break;default:Aj=[{scriptClass:"mstrmojo.Container",cssClass:"error-msg",markupString:'<div class="{@cssClass}"><div class="error-content" style="visibility: visible">'+Ak+"</div></div>",markupSlots:{containerNode:function(){return this.domNode;}}}];break;}return Aj;},applyStyles2DomNode:function(An,Aq){var Ai,Ao=An.style;if(Object.prototype.hasOwnProperty.call(Aq,"backgroundColor")&&Aq.backgroundColor!==""&&Aq.backgroundColor!=="transparent"){var Am=1;if(Object.prototype.hasOwnProperty.call(Aq,"opacity")&&Aq.opacity!==""){Am=Aq.opacity;}var Aj=Aq.backgroundColor,Ap=function Ap(Ar){if(isNaN(Ar)){Ar=0;}Ar%=16777216;return{b:Ar%256,g:(Ar>>8)%256,r:(Ar>>16)%256};},Al="";if(Aj){var Ak=function Ak(As,At){if(As==="transparent"){return"rgba(0,0,0,0)";}As=this.parseCSSColor(As,false);var Ar=Ap(As);return"rgba("+Ar.r+" ,"+Ar.g+" ,"+Ar.b+" ,"+At+" )";}.bind(this);if(Aj.c1!==undefined&&Aj.c2!==undefined&&Aj.or!==undefined){Al=(Ac.buildGradient(Aj.or,Ak(Aj.c1,Am),Ak(Aj.c2,Am))).v;}else{Al=Ak(Aj,Am);}Ao.background=Al;}}else{Ao.backgroundColor="rgba(0,0,0,0)";}for(Ai in Aq){if(Ai!=="backgroundColor"&&Ai!=="opacity"&&Object.prototype.hasOwnProperty.call(Aq,Ai)&&Aq[Ai]&&Aq[Ai]!==""){Ao[Ai]=Aq[Ai];if(Ai==="fontFamily"){Ao[Ai]="'"+Aq[Ai]+"'";}}}},parseCSSColor:function(Am,Aj){var Ai,Ak;if(Am.length===7){if(Aj===true){Ai=Am[5]+Am[6]+Am[3]+Am[4]+Am[1]+Am[2];}else{Ai=Am.slice(1);}}else{Ai=[];var Al=Am.slice(1);if(Aj===true){for(Ak=2;Ak>=0;Ak--){Ai.push(Al[Ak]);Ai.push(Al[Ak]);}}else{for(Ak=0;Ak<3;Ak++){Ai.push(Al[Ak]);Ai.push(Al[Ak]);}}Ai=Ai.join("");}return parseInt(Ai,16);},positionDomNode:function(Ak,Am){var Aj,Ap,An,Al=["width","height","top","left","right","bottom"],Ao=Al.length,Ai=Ak.style;for(Aj=0;Aj<Ao;Aj++){Ap=Al[Aj];An=Am[Ap];if(An!==undefined){if((typeof An)==="number"){An+="px";}Ai[Ap]=An;}}},getComputedFontStyle:function K(Ak){var Ai=mstrmojo.css.getComputedStyle(Ak);var Al={};Al.fontFamily=Ai.fontFamily;Al.fontSize=Ai.fontSize;Al.fontStyle=Ai.fontStyle;Al.fontWeight=Ai.fontWeight;Al.fontVariant=Ai.fontVariant;var Aj=parseInt(Ai.paddingLeft)||0,Am=parseInt(Ai.paddingLeft)||0;Al.bonus=Aj+Am;return Al;},splitWordIfTooLong:function(As,Aq,Al){var Ao=[];var Ap=As.length;var Am;for(Am=0;Am<Ap;Am++){var Aj=As[Am];while(true){var At=this.measureTextWidth(Aj,Al);if(At>Aq){var Ar=(Aq/At)*Aj.length;var Ai=Math.max(Math.round(Ar),1);while(Ai>0){var An=Aj.substr(0,Ai);var Ak=Math.round(this.measureTextWidth(An,Al));if(Ak<=Aq||Ai===1){Ao.push(An);break;}else{Ai--;}}Aj=Aj.substr(Ai,Aj.length-Ai);}else{Ao.push(Aj);break;}}}return Ao;},truncateTextToLineWithWordWrap:function k(A8,A1,Az,Ao,A0,As){var Aw=A8.split(" "),A2=Aw.length;if(!As){Aw=this.splitWordIfTooLong(Aw,Az,A1);}var BF,Au=[],BA=[],Ai=0,Am=Aw.length,BH=this.measureTextWidth(" ",A1),Al=0,Ar=false,Ay=(A2===Aw.length);BA.push(0);for(BF=0;BF<Am;BF++){var A6=this.measureTextWidth(Aw[BF],A1);if(!As&&A6>Az){var Aj=Aw[BF];var BD=(Az/A6)*Aj.length;Aw[BF]=Aj.substr(0,parseInt(BD,10));A6=Az;}Au.push(A6);Ai+=A6;BA.push(Ai);if(BF!==Am-1){Ai+=BH;}}var BC,BE,A4=Ao;for(BC=0,BE=0;BE<BA.length;){var Aq=BA[BE]-BA[BC];if(BC>0&&BE!==BC){Aq-=BH;}var Ap=BA[BE+1]-BA[BC];if(BC>0&&BE+1!==BC){Ap-=BH;}if(Aq<=Az&&((BE+1===BA.length)||(Ap>Az))){Al=Math.max(Al,Aq);A4--;if(A4===0||BE===Am){break;}else{BC=BE;BE++;}}else{BE++;}}if(BE>Am){BE=Am;}var At=BA[BE]-BA[BC];if(BC>0&&BE!==BC){At-=BH;}var A7;if(BE>=Am&&At<Az){A7=Aw.join(" ");}else{Ar=true;Al=Az;A7=Aw.slice(0,BE).join(" ");var Av=this.measureTextWidth("...",A1);if(At+Av<=Az){if(At+BH+Av>Az){A7+="...";}else{var BG=Aw[BE],Ax;for(var A3=1;A3<BG.length;A3++){Ax=this.measureTextWidth(BG.substr(0,A3),A1);if(At+BH+Ax+Av>Az){break;}}A7+=" "+BG.substr(0,A3-1)+"...";}}else{if(A7.charAt(A7.length-1)===" "){A7=A7.substr(0,A7.length-1);}var A5=A7.lastIndexOf(" ");var Ak=A7.length-1-A5;if(Ak===3){A7=A7.substr(0,A7.length-3)+" ...";}else{var A9=0,An="",BB=0;while(A9<Av&&A7.length>BB){BB++;An=A7.substr(A7.length-BB,A7.length);A9=this.measureTextWidth(An,A1);}A7=A7.substr(0,A7.length-BB)+"...";}}}if(A0){return{text:A7,truncated:Ar,maxLineLen:Al,canWordWrap:Ay};}return A7;},measureSuperTextWidth:function x(Aj,Ak,Ai,Al){return Aj?this.measureTextWidth("<sup>"+Ak+"</sup>",Ai,Al):this.measureTextWidth(Ak,Ai,Al);},splitTokenIfTooLong:function h(At,Ar,Al){var Ap=[];var Aq=At.length;var Am,Aj,Au,Ao,Av;for(Am=0;Am<Aq;Am++){Aj=At[Am];Ao=Aj.isSuper;while(true){Au=Aj.v;if(Aj.textWidth!==undefined){Av=Aj.textWidth;}else{Av=Aj.textWidth=this.measureSuperTextWidth(Ao,Au,Al);}if(Av>Ar){var As=(Ar/Av)*Au.length;var Ai=Math.max(Math.round(As),1);while(Ai>0){var An=Au.substr(0,Ai);var Ak=Math.round(this.measureSuperTextWidth(Ao,An,Al));if(Ak<=Ar||Ai===1){Ap.push({v:An,isSuper:Ao,textWidth:Ak});break;}else{Ai--;}}Aj={v:Au.substr(Ai,Au.length-Ai),isSuper:Ao};}else{Ap.push(Aj);break;}}}return Ap;},truncateTextToLineWithWordWrapForTokens:function AX(As,Am,BB,A3,BC,Ay){var A6=As.length;As=this.splitTokenIfTooLong(As,BB,Am);var BA,Ax=[],Ai=0,A1=As.length,Aj=0,A2=false,Ao=(A6===As.length),Aq,Av,A4,Ak,A8,Ar,Aw;if(Ay&&!Ao){return{canWordWrap:Ao};}Ax.push(0);for(BA=0;BA<A1;BA++){Aq=As[BA];A4=Aq.v;Av=Aq.isSuper;if(Aq.textWidth!==undefined){Ak=Aq.textWidth;}else{Ak=Aq.textWidth=this.measureSuperTextWidth(Av,A4,Am);}if(Ak>BB){var A9=(BB/Ak)*A4.length;Aq.v=A4.substr(0,parseInt(A9,10));Ak=Aq.textWidth=BB;}Ai+=Ak;Ax.push(Ai);}var Au,A5,At=A3;for(Au=0,A5=0;A5<Ax.length;){var Ap=Ax[A5]-Ax[Au];var An=Ax[A5+1]-Ax[Au];if(Ap<=BB&&((A5+1===Ax.length)||(An>BB))){Aj=Math.max(Aj,Ap);At--;if(At===0||A5===A1){break;}else{Au=A5;A5++;}}else{A5++;}}if(A5>A1){A5=A1;}var A0=Ax[A5]-Ax[Au];var BD;if(A5>=A1&&A0<BB){BD=As;}else{A2=true;Aj=BB;BD=As.slice(0,A5);var Al=this.measureTextWidth("...",Am);if(A0+Al<=BB){Ar=As[A5];A4=Ar.v;Av=Ar.isSuper;for(A8=1;A8<A4.length;A8++){Aw=this.measureSuperTextWidth(Av,A4.substr(0,A8),Am);if(A0+Al+Aw>BB){break;}}if(A8>1){Aq={v:A4.substr(0,A8-1),isSuper:Av};Aq.textWidth=this.measureSuperTextWidth(Av,Aq.v,Am);BD.push(Aq);BD.push({v:"...",textWidth:Al});}}else{var Az=0,A7;for(BA=BD.length-1;BA>=0;BA--){Aq=BD[BA];A4=Aq.v;Av=Aq.isSuper;A7=0;for(A8=A4.length-1;A8>=0;A8--){A7=this.measureSuperTextWidth(Av,A4.substr(A8),Am);if(Az+A7>=Al){break;}}if(A8>=0){break;}else{Az+=A7;}}if(BA>=0){if(A8>0){Aq.v=A4.substr(0,A8);Aq.textWidth=this.measureSuperTextWidth(Av,Aq.v,Am);BD=BD.slice(0,BA+1);}else{if(A8===0){BD=BD.slice(0,BA);}}BD.push({v:"...",textWidth:Al});}else{BD=[{v:"...",textWidth:Al}];}}}if(BC){return{text:BD,truncated:A2,maxLineLen:Aj,canWordWrap:Ao};}return BD;},getRankMode:function O(Ao){var Aq=1,Ap=2,An=3,Aj=4,Al=5,Ai=6,Am=7,Ak=V.INVALID;if(Ao){if(AT(Ao,An,Ap)){Ak=V.TOP_PERCENT;}else{if(AT(Ao,An,Aq)){Ak=V.BOTTOM_PERCENT;}else{if(AT(Ao,Ai,Aj)){Ak=V.BOTTOM;}else{if(AT(Ao,Ai,Al)){Ak=V.TOP;}else{if(AT(Ao,Am)){Ak=V.VALUE;}}}}}}return Ak;},getColorByTitle:function a(Aj,Ai){if(Ai===V.BOTTOM_PERCENT||Ai===V.TOP_PERCENT){Aj=mstrmojo.desc(2787,"Percentage of ##").replace("'##'",Aj);}else{if(Ai===V.BOTTOM||Ai===V.TOP){Aj=mstrmojo.desc(2788,"Rank of ##").replace("'##'",Aj);}}return Aj;},getColorByFormatStr:function g(Aj,Ai){if(Ai===V.BOTTOM_PERCENT||Ai===V.TOP_PERCENT){Aj="0%;(0%)";}else{if(Ai===V.BOTTOM||Ai===V.TOP){Aj="";}}return Aj;},getColorByItems:function AY(Ai,As,Az,Av,Aq,Ao,Aw){var Au=[],A0,Ak,Ap=mstrmojo.num,An,Ar;if(Ai===undefined||Ai.length===0){return Au;}var A2=true;if(Ai.length>1){if(Ai[0].ceil===Ai[1].flr){A2=false;}else{A2=true;}}for(A0=0;A0<Ai.length;A0++){var A1=Ai[A0],Am={},Aj=A1.ceil,Ay=A1.flr;if((A0===0&&A2)||(A0===Ai.length-1&&!A2)){if(As===V.BOTTOM_PERCENT||As===V.TOP_PERCENT){Am.flr=Ay/100;Am.ceil=1;}else{if(As===V.TOP||As===V.BOTTOM){Ay+=1;Am.flr=Math.floor(Ay);Am.ceil=Aq;}else{Am.flr=Ay;Am.ceil=Az;}}Ar=Am.ceil;}else{if((A0===0&&!A2)||(A0===Ai.length-1&&A2)){if(As===V.BOTTOM_PERCENT||As===V.TOP_PERCENT){Am.flr=0;Am.ceil=Aj/100;}else{if(As===V.TOP||As===V.BOTTOM){Am.flr=0;Am.ceil=Math.floor(Aj);}else{Am.flr=Av;Am.ceil=Aj;}}An=Am.flr;}else{if(As===V.BOTTOM_PERCENT||As===V.TOP_PERCENT){Ay=Ay/100;Aj=Aj/100;}else{if(As===V.TOP||As===V.BOTTOM){Ay+=1;Ay=Math.floor(Ay);Aj=Math.floor(Aj);}}Am.flr=Ay;Am.ceil=Aj;}}if(As===V.TOP||As===V.BOTTOM){Am.ceil=Am.ceil>Aq?Aq:Am.ceil;}if(Ao){Am.label=Ap.formatByMask(Ao,Am.flr);if(Am.flr!==Am.ceil){Am.label+=" - "+Ap.formatByMask(Ao,Am.ceil);}}else{Am.label=Am.flr;if(Am.flr!==Am.ceil){Am.label+=" - "+Am.ceil;}}if(A1.fmt&&A1.fmt.bc){Am.color=A1.fmt.bc;}else{Am.color=Aw;}Au.push(Am);}Au=Au.filter(function(A3){return A3.flr<=A3.ceil&&!(A3.flr>Ar||A3.ceil<An);});if(As!==V.VALUE){if(Au[0]&&(Au[0].label===0)){Au.shift();}}if(As===V.TOP||As===V.BOTTOM){Ak=Aq;}else{if(Au.length>0){if(A2){Ak=Au[0].ceil-Au[(Au.length-1)].flr;}else{Ak=Au[(Au.length-1)].ceil-Au[0].flr;}}}var Ax=0,At,Al;for(A0=0;A0<Au.length;A0++){if(A0===Au.length-1){Au[A0].scopePercent=1-Ax;}else{if(As===V.TOP||As===V.BOTTOM){Al=Au[A0].ceil-Au[A0].flr+1;}else{Al=Au[A0].ceil-Au[A0].flr;}At=Al/Ak;Au[A0].scopePercent=At;Ax+=At;}}return Au;},getDefaultColorByItems:function(Al,Aj,Ak){var Ai={};Ai.label=Ak+" - "+Aj;Ai.flr=Ak;Ai.ceil=Aj;Ai.color=Al;Ai.scopePercent=1;return[Ai];},getNumberFormat:function(Al,Aj){var Am=Al.nf,Ak=Al.gvs;function Ai(){var Ap=(Ak&&Ak.items&&Ak.items[0]&&Ak.items[0].items)||[],Ao=Ap[Aj]||{},An=Ao.nfs;return typeof An==="string"?An:"";}if(Am[Aj]&&typeof Am[Aj].nfs!=="string"){Am[Aj].nfs=Ai();}return Am[Aj]&&Am[Aj].nfs;},hasOnlyMetricsOnColumn:function(Aj){var Ai=(Aj&&Aj.gts&&Aj.gts.col)||[];return Ai.every(function(Ak){return Ak.otp===p.DssTypeUnknown&&(Ak.es||[]).every(function(Al){return Al.otp===p.DssTypeMetric;});});},hasNoMetricOnRow:function(Aj){var Ak=(Aj&&Aj.gts&&Aj.gts.row)||[],Ai=function(Al){return Al.otp!==p.DssTypeMetric;};return Ak.every(Ai);},getAttMetricCount:function(){var Al=this.getEditingGridData&&this.getEditingGridData()||this.model&&this.model.data,Ap=Al&&Al.gsi,Ao=Ap&&Ap.rows||[],Ak=Ap&&Ap.cols||[],Aj=[].concat(Ao).concat(Ak),An=Ap&&Ap.mx||[],Ai=0,Am=An.length;Ae.forEach(Aj,function(Aq){if(Aq.t!==p.DssTypeMetric){Ai++;}});return{attCount:Ai,metricCount:Am};},isOnExpressMode:function(){return mstrApp.isExpress;},modifyScExp:function(Aq,Ai,Au,Ao){if(!Aq||!Ai){return ;}var Al=Aq.nds,Ap,Aj,Ar,At,As,An,Am,Ak;Ae.forEach(Al||[],function(Av){Ap=Av.nds;Ae.forEach(Ap||[],function(Aw){Aj=Aw.es;Ae.forEach(Aj||[],function(Ax){At=Ax.v;An=Ao[At];if(!An){An=Au.getNormalizedFormElementId(At);Ao[At]=An;}Ae.forEach(Ai||[],function(Ay){Ar=Ay.es;Ae.forEach(Ar||[],function(Az){Ak=false;As=Az.id;if(As===At){Ak=true;}else{Am=Ao[As];if(!Am){Am=Au.getNormalizedFormElementId(As);Ao[As]=Am;}if(An===Am){Ak=true;}}if(Ak){Ax.v=Az.id;Ax.n=Az.n;return false;}});if(Ak){return false;}});});});});},modifyScExpDeprecated:function(Ao,Ap,Am,Ak){if(!Ao||!Ap){return ;}var Al=Ao.nds,Aj,Ai,An;Ae.forEach(Al||[],function(Aq){Aj=Aq.nds;Ae.forEach(Aj||[],function(Ar){Ai=Ar.es;Ae.forEach(Ai||[],function(As){Ae.forEach(Ap||[],function(At){Ae.forEach(At||[],function(Au){An=Au.es;Ae.forEach(An||[],function(Av){if(Am.call(Ak,Av.id,As.v)){As.v=Av.id;As.n=Av.n;}});});});});});});},getMouseOffset:function(Aj){var Ai=(Aj.offsetX!==undefined)?Aj.offsetX:(Aj.layerX),Ak=(Aj.offsetY!==undefined)?Aj.offsetY:(Aj.layerY);return{x:Ai,y:Ak};},translateLineStyle:function(Ai){var Ak=["none","solid","solid","dashed","dotted"],Aj=["1px","1px","2px","1px","1px"];return{width:Aj[Ai]||"0px",style:Ak[Ai]||"none"};},getVisStyle:function(){var Ai=mstrmojo.VisUtility;return Ai.getPropertyByPath(this,"model.data.visName")||Ai.getPropertyByPath(this,"model.data.vis.vn");},getGroupAndCalculationContextMenuForDataPoints:function(At,A7){var Av,Ax=[],Ak=[],A4=[],Ap=A7.fnCellName,Az=A7.fnUnique,Ao=A7.fnMakeNode,A2=At.getCellForNode.bind(At),A9=A7.selection;var An=new e.ui.menus.MenuConfig(),Aj=new e.ui.menus.MenuConfig(),A1=new e.ui.menus.MenuConfig(),A6=new e.ui.menus.MenuConfig();function A8(BA){At.cmSelCells=Ax[BA].cmSelCells;At.derivedElementGroup(A2(At.cmSelCells[0]));}function Aq(BC){At.cmSelCells=Ak[BC].cmSelCells;var BB=A2(Ak[BC].cmSelCells[0]),BA=At.getDEInfo(BB);At.derivedElementsEdit(A2(At.cmSelCells[0]),BA);}function Ay(BB){At.cmSelCells=Ak[BB].cmSelCells;var BA=A2(Ak[BB].cmSelCells[0]);At.removeQuickDE(BA);}function Aw(BB){At.cmSelCells=Ak[BB].cmSelCells;var BA=A2(Ak[BB].cmSelCells[0]);At.renameDEList(BA);}function A0(BA){W(At,A2(At.cmSelCells[0]),null,BA,false);}function Ai(BA){W(At,A2(At.cmSelCells[0]),null,BA,true);}function Am(BB){var BA=A2(Ak[BB].cmSelCells[0]);At.removeQuickDE(BA);}function A5(BB){var BA=A2(Ak[BB].cmSelCells[0]);At.editDECalculation(BA);}function Ar(BB,BA){return function(){var BC=new e.ui.menus.MenuConfig();BC.addNonInteractiveMenuItem(mstrmojo.desc(11859,"Based on"),"xt",true);BC.addRadioMenuGroup(null,BB,BA,"checkMark",undefined,true);return BC;};}function Au(BA){BA=BA||[];function BB(BF){var BC=BF.extra||{},BG=BF.setup||mstrmojo.emptyFn,BD=BF.action||mstrmojo.emptyFn,BE=[];BG(BE,BC);BD(BE,BC);}BA.forEach(BB);}var Al=[{name:"group",setup:function(BA){Ax.forEach(function(BB){At.cmSelCells=Ax[BB.v].cmSelCells;if(!Object.prototype.hasOwnProperty.call(Ak,BB.v)&&Y(At)){BA.push(BB);}});},action:function(BB){var BA;if(BB.length===1){BA=BB[0].v;An.addMenuItem(mstrmojo.desc(1911,"Group"),"xt",function(){At.cmSelCells=Ax[BA].cmSelCells;At.derivedElementGroup(A2(At.cmSelCells[0]));});}if(BB.length>1){An.addPopupMenuItem(mstrmojo.desc(1911,"Group"),At.id,Ar(A8,BB),"xt");}}},{name:"edit-group",setup:function(BA){Ak.forEach(function(BE){var BD=A2(Ak[BE.v].cmSelCells[0]),BC=At.getDEInfo(BD),BB=BC&&BC.de;if(BB&&BB.t===U.LIST){BA.push(BE);}});},action:function(BB){var BA,BD,BC;if(BB.length===1){BA=Ak[BB[0].v].cmSelCells;BD=A2(BA[0]);BC=At.getDEInfo(BD);Aj.addMenuItem(mstrmojo.desc(13395,"Edit Group..."),"xt",function(){At.cmSelCells=BA;At.derivedElementsEdit(A2(At.cmSelCells[0]),BC);});Aj.addMenuItem(mstrmojo.desc(12195,"Ungroup"),"xt",function(){At.cmSelCells=BA;At.removeQuickDE(BD);});A6.addMenuItem(mstrmojo.desc(13968,"Rename Group..."),"xt",function(){At.cmSelCells=BA;At.renameDEList(BD);});}if(BB.length>1){Aj.addPopupMenuItem(mstrmojo.desc(13395,"Edit Group..."),At.id,Ar(Aq,BB),"xt");Aj.addPopupMenuItem(mstrmojo.desc(12195,"Ungroup"),At.id,Ar(Ay,BB),"xt");A6.addPopupMenuItem(mstrmojo.desc(13968,"Rename Group..."),At.id,Ar(Aw,BB),"xt");}}},{name:"calculation",setup:function(BA){A4.forEach(function(BD,BC,BB){At.cmSelCells=BB[BD.v].cmSelCells;var BF=A2(At.cmSelCells[0]),BE=At.getDEInfo(BF),BG=BE&&BE.de;if(!(BG&&BG.t===U.RESIDUE)&&l(At)){BA.push(BD);}});},action:function(BA){if(BA.length===1){An.addPopupMenuItem(mstrmojo.desc(5188,"Calculation"),At.id,function(){var BB=BA[0].v,BC=new e.ui.menus.MenuConfig();At.cmSelCells=A4[BB].cmSelCells;BC.addRadioMenuGroup(null,A0,m(At,null,Ap).items,"checkMark",undefined,true);return BC;},"xt");}if(BA.length>1){An.addPopupMenuItem(mstrmojo.desc(5188,"Calculation"),At.id,function(){return new mstrmojo.ui.menus.EditorConfig({cssClass:"base-on-calculation-editor",data:{},hasToggleItem:true,contents:[{scriptClass:"mstrmojo.Label",text:mstrmojo.desc(11859,"Based on")},{scriptClass:"mstrmojo.ui.Pulldown",alias:"attrList",items:BA,selectedIndex:0,onitemSelected:function(BB){var BC=BB.v;At.cmSelCells=A4[BC].cmSelCells;this.parent.checkList.set("items",[]);this.parent.checkList.set("items",m(At,null,Ap).items);this.parent.data.set("valid",false);}},{scriptClass:"mstrmojo.VisMenuList",alias:"checkList"}],bindings:{okEnabled:"this.valid",valid:function(){return this.data.valid;}},fnOk:function(BC,BB){W(At,A2(At.cmSelCells[0]),null,BB.checkList.selectedItem.v,false);}});});}}},{name:"edit-calculation",setup:function(BA){Ak.forEach(function(BE){var BD=A2(Ak[BE.v].cmSelCells[0]),BC=At.getDEInfo(BD),BB=BC&&BC.de;if(BB&&BB.t===U.CALCULATION&&l(At)){BA.push(BE);}});},action:function(BA){function BB(){var BC=BA[0].v;At.cmSelCells=Ak[BC].cmSelCells;var BG=A2(At.cmSelCells[0]),BF=At.getDEInfo(BG),BH=BF&&BF.de,BE=m(At,BH,Ap),BD=new e.ui.menus.MenuConfig();BD.addRadioMenuGroup(BE.selectedItem.value,Ai,BE.items,"checkMark",undefined,true);return BD;}if(BA.length===1){A1.addPopupMenuItem(mstrmojo.desc(12196,"Edit Calculation"),At.id,BB,"xt");A1.addMenuItem(mstrmojo.desc(12197,"Delete Calculation"),"xt",function(){var BC=BA[0].v;At.cmSelCells=Ak[BC].cmSelCells;var BD=A2(At.cmSelCells[0]);At.removeQuickDE(BD);});A6.addMenuItem(mstrmojo.desc(13967,"Rename Calculation..."),"xt",function(){var BC=BA[0].v;At.cmSelCells=Ak[BC].cmSelCells;var BD=A2(At.cmSelCells[0]);At.editDECalculation(BD);});}if(BA.length>1){A1.addPopupMenuItem(mstrmojo.desc(12196,"Edit Calculation"),At.id,function(){return new mstrmojo.ui.menus.EditorConfig({data:{},hasToggleItem:true,contents:[{scriptClass:"mstrmojo.Label",text:mstrmojo.desc(11859,"Based on")},{scriptClass:"mstrmojo.ui.Pulldown",alias:"attrList",items:BA,selectedIndex:0,onitemSelected:function(BF){var BG=BF.v;At.cmSelCells=Ak[BG].cmSelCells;var BE=A2(At.cmSelCells[0]),BD=At.getDEInfo(BE),BH=BD&&BD.de;var BC=m(At,BH,Ap);this.parent.checkList.set("items",[]);this.parent.checkList.set("items",BC.items);this.parent.checkList.set("selectedItem",BC.selectedItem);this.parent.data.set("valid",false);}},{scriptClass:"mstrmojo.VisMenuList",alias:"checkList"}],bindings:{okEnabled:"this.valid",valid:function(){return this.data.valid;}},fnOk:function(BD,BC){W(At,A2(At.cmSelCells[0]),null,BC.checkList.selectedItem.v,true);}});});A1.addPopupMenuItem(mstrmojo.desc(12197,"Delete Calculation"),At.id,Ar(Am,BA),"xt");A6.addPopupMenuItem(mstrmojo.desc(13967,"Rename Calculation..."),At.id,Ar(A5,BA),"xt");}}}];Av=Az(A9);Av.forEach(function(BB){var BD=Ao(BB),BA=A2(BD),BC,BE,BF;if(!At.model.supportsViewFilterActions(BA.tid)){return ;}BC=BA.dei===undefined?Ax:Ak;BE=BA.tid;BF=At.model.getObjectInfo(BE).n;if(BC[BE]===undefined){BC[BE]={};BC[BE].cmSelCells=[];BC.push({n:BF,v:BE,text:BF,value:BE});}BC[BE].cmSelCells.push(BD);if(A4[BE]===undefined){A4[BE]={};A4[BE].cmSelCells=[];A4.push({n:BF,v:BE,text:BF,value:BE});}A4[BE].cmSelCells.push(BD);});var As=mstrmojo.VisUtility;var A3=As.getVisStyle.call(At);if(A3===w.HEAT_MAP){Al.splice(2,2);}Au(Al);return{createDe:An,editGroup:Aj,editCalculation:A1,renameDe:A6};},getGroupAndCalculationContextMenu:function(Aq,A4,A1){var A3=Aq,Ax=A1.skipSingleAttrCheck||A3.isSingleAttrSelection(),Al=false,An=A3.isSingleContextMenuSelection(),Ar=A3.getDEInfo(A4),Am=Ar&&Ar.deObject,A0=Ar&&Ar.de,Av=Am&&A3.getOthersDEInfo(Am),At=A3.getContextMenuSelections(),Az=true,Ap=A1.fnCellName,A2=this.getPropertyByPath(A3,"model.data.visName")||this.getPropertyByPath(A3,"model.data.vis.vn");var Ao=new e.ui.menus.MenuConfig(),Aj=new e.ui.menus.MenuConfig(),Au=new e.ui.menus.MenuConfig(),Ay=new e.ui.menus.MenuConfig();A3.cmSelCells=A1.selection;if(Aq.model.supportsViewFilterActions(A4.tid)){if((Al||Ax)&&AR(A4,u)&&Y(A3)){Ao.addMenuItem(mstrmojo.desc(1911,"Group"),"xt",function(){Aq.derivedElementGroup(A4);});}if(An&&A0&&A0.t===U.LIST){Aj.addMenuItem(mstrmojo.desc(13395,"Edit Group..."),"xt",function(){Aq.derivedElementsEdit(A4,Ar);});Aj.addMenuItem(mstrmojo.desc(12195,"Ungroup"),"xt",function(){Aq.removeQuickDE(A4);});Ay.addMenuItem(mstrmojo.desc(13968,"Rename Group..."),"xt",function(){Aq.renameDEList(A4);});}var As=function(A5){W(A3,A4,A0,A5,false);},Aw=function(A5){W(A3,A4,A0,A5,true);};if(Av&&!An&&Ax){S.forEach(At,function(A5){if(A5[0]&&A5[0].eid.indexOf(Av.id)>-1){Az=false;return false;}});}if(A2!=="VIHeatMapVisualizationStyle"&&!(An&&A0&&A0.t===U.RESIDUE)&&(Al||Ax)&&AR(A4,AF)&&l(A3)){var Ai=function(){var A5=new e.ui.menus.MenuConfig(),A6=m(A3,null,Ap);A5.addRadioMenuGroup(null,As,A6.items,"checkMark",undefined,true);return A5;};Ao.addPopupMenuItem(mstrmojo.desc(5188,"Calculation"),this.id,Ai,"xt");}if(An&&A0&&A0.t===U.CALCULATION&&l(A3)){var Ak=function(){var A5=new e.ui.menus.MenuConfig(),A6=m(A3,A0,Ap);A5.addRadioMenuGroup(A6.selectedItem.value,Aw,A6.items,"checkMark",undefined,true);return A5;};Au.addPopupMenuItem(mstrmojo.desc(12196,"Edit Calculation"),this.id,Ak,"xt");Au.addMenuItem(mstrmojo.desc(12197,"Delete Calculation"),"xt",function(){Aq.removeQuickDE(A4);});Ay.addMenuItem(mstrmojo.desc(13967,"Rename Calculation..."),"xt",function(){Aq.editDECalculation(A4);});}}return{createDe:Ao,editGroup:Aj,editCalculation:Au,renameDe:Ay};},isHostedPopupNode:function(Al,Ak,Aj,Ai){return AI(Al,Ak,"mstrmojo-popup-widget-hosted",Aj,Ai);},isMojoEditorNode:function(Al,Ak,Aj,Ai){return AI(Al,Ak,"mstrmojo-Editor",Aj,Ai);},applyStyle2Legend:function(Al,Ak,Aj){var Ai,An={},Am={};for(Ai in Al){if(Ai.indexOf("font")>=0||Ai.indexOf("color")>=0||Ai.indexOf("textDecoration")>=0){An[Ai]=Al[Ai];}else{Am[Ai]=Al[Ai];}}if(Ak){Ak.style.background="";this.applyStyles2DomNode(Ak,Am);}if(Aj){this.applyStyles2DomNode(Aj,An);}},mergeMenuConfigs:function AH(Aj,Ai){function Ak(Am,An,Al){if(!An){return ;}if(!Al&&Am.hasMenuItems()&&An.hasMenuItems()){Am.addSeparator();}if(An.hasMenuItems()){Am.absorbMenuItems(An);}}return Ai.reduce(function(Al,Am){Ak(Al,Aj[Am.name],Am.noSeparator);return Al;},new mstrmojo.ui.menus.MenuConfig());},absorbMenuItems:function(Aj,Ai,Ak){Aj.addDisposable(Ai);Aj.absorbMenuItems(Ai);if(Ak&&Ai.menus.length>0){Aj.addSeparator();}},addWheelListener:(function(){var Al=mstrmojo.dom,Ak=Al.attachEvent,Aj=Al.preventDefault,Am;function Ai(Aq,Ap,Ar,Ao){var An=(Am==="wheel")?Ar:function(As){if(!As){As=window.event;}var Au={originalEvent:As,target:As.target||As.srcElement,type:"wheel",deltaMode:(As.deltaMode!==undefined?As.deltaMode:1),deltaX:0,deltaZ:0,preventDefault:function(){Aj(window,As);}},At=this;if(Am==="mousewheel"){Au.deltaY=-As.wheelDelta;if(As.wheelDeltaX!==undefined){Au.deltaX=-As.wheelDeltaX;}}else{Au.deltaY=As.detail;}return Ar.call(At,Au);};return Ak(Aq,Ap,An,Ao);}if(Object.prototype.hasOwnProperty.call(document.createElement("div"),"onwheel")){Am="wheel";}else{Am=document.onmousewheel!==undefined?"mousewheel":"DOMMouseScroll";}return function(Ao,Ap,An){return Ai(Ao,Am,Ap,An);};}()),addTouchSupportHelper:function AK(Ai,Ak,Aj,An,Am){Ai.style["touch-action"]="none";var Al={MINDRAG:function(Ao){return(((Ao.event.type.indexOf("touch")===0)||(Ao.event.type.indexOf("pointer")===0))?5:1);},TAPHOLDDELAY:250,DBLCLICKDELAY:300};t.newInstance(Ai,{context:Al,start:Aj,change:An,end:Am},Ak);},addBasicTouchSupport:function AA(An,Ap,As,Am,Ar){function At(Ax){var Aw={left:0,top:0};function Au(Ay){if(Ay===window||Ay===document||Ay===document.body){return Aw;}else{return Ay.getBoundingClientRect();}}function Av(A1,A2,Az){A2=A2||A1.currentTarget||A1.srcElement;if(!Array.isArray(Az)){Az=[0,0];}var Ay=A1.clientX||0;var A3=A1.clientY||0;var A0=Au(A2);Az[0]=Ay-A0.left;Az[1]=A3-A0.top;return Az;}return Av(Ax.changedTouches?Ax.changedTouches[0]:Ax,document.body);}function Al(Au,Aw){if(Au.touches.length>1||(Au.type==="touchend"&&Au.touches.length>0)){return undefined;}var Av=null,Ay=null;switch(Au.type){case"touchstart":Av="mousedown";Ay=Au.changedTouches[0];break;case"touchmove":Av="mousemove";Ay=Au.changedTouches[0];break;case"touchend":Av="click";Ay=Au.changedTouches[0];break;}if(Aw){Av=Aw;}var Ax={bubbles:Au.bubbles,cancelable:Au.cancelable,view:Au.view,screenX:Ay.screenX,screenY:Ay.screenY,clientX:Ay.clientX,clientY:Ay.clientY};if(Aw==="contextmenu"){Ax.button=2;Ax.buttons=2;}return new MouseEvent(Aw,Ax);}function Ao(Aw,Au){var Av;if(Aw.type.indexOf("touch")===0){Av=Al(Aw,Au);}else{var Ax=At(Aw),Ay={bubbles:Aw.bubbles,cancelable:Aw.cancelable,view:Aw.view,detail:Aw.detail,screenX:Aw.screenX,screenY:Aw.screenY,clientX:Ax[0],clientY:Ax[1]};if(Au==="contextmenu"){Ay.button=2;Ay.buttons=2;}Av=new MouseEvent(Au,Ay);}Av.originEvent=Aw;return Av;}function Ak(Au){if(Au.stopPropagation){Au.stopPropagation();}if(Au.preventDefault){Au.preventDefault();}Au.cancelBubble=true;return false;}function Ai(Av){var Ay=Av.event,Au=Av.context;Au.startOffset=At(Ay);Au._dragged=false;Au._dragging=true;Au._taphold=false;Au.initialTarget=Ay.target;var Ax=(new Date()).getTime();if(Ax-Au._mouseDownTime<Au.DBLCLICKDELAY){Au.numClicks+=1;}else{Au.numClicks=1;Au._mouseDownTime=Ax;}Au.tapholdTimeoutId=setTimeout(function(){if((new Date()).getTime()-Au._mouseDownTime>Au.TAPHOLDDELAY&&!Au._dragged){Au._taphold=true;}if(!Au._dragged&&Au._taphold){Av.session.listeners.end(Ay);}},Au.TAPHOLDDELAY+10);var Aw;if(As){Aw=As(Av);}if(Aw===undefined||(Aw&&Aw.pause)){Ak(Av.event);}}function Aq(Ay){var Au=Ay.event,Ax=Ay.context,A0=At(Au),Aw=A0[0]-Ax.startOffset[0],Av=A0[1]-Ax.startOffset[1];if(Math.abs(Aw)<Ax.MINDRAG(Ay)){Aw=0;}if(Math.abs(Av)<Ax.MINDRAG(Ay)){Av=0;}if(Aw||Av){Ax._dragged=true;}if((new Date()).getTime()-Ax._mouseDownTime>Ax.TAPHOLDDELAY&&!Ax._dragged){Ax._taphold=true;}var Az;if(Am){Az=Am(Ay);}if(Az===undefined||(Az&&Az.pause)){Ak(Ay.event);}}function Aj(Av){var Au=Av.context,Ax=Av.event;if(Au.tapholdTimeoutId){clearTimeout(Au.tapholdTimeoutId);}if(!Au._dragging){Au._dragged=false;return ;}Au._dragging=false;if((new Date()).getTime()-Au._mouseDownTime>Au.DBLCLICKDELAY){Au.numClicks=Math.max(Au.numClicks-1,1);}if((new Date()).getTime()-Au._mouseDownTime>Au.TAPHOLDDELAY&&!Au._dragged){Au._taphold=true;}var Aw;if(Ar){Aw=Ar(Av);}if(Ax.type.indexOf("mouse")===0){Au._dragged=false;Au._taphold=false;return ;}else{if(!Au._dragged){if(Au._taphold){Au.initialTarget.dispatchEvent(Ao(Ax,"contextmenu"));}else{Au.initialTarget.dispatchEvent(Ao(Ax,"click"));}}Au._dragged=false;Au._taphold=false;if(Aw===undefined||(Aw&&Aw.pause)){Ak(Av.event);}}}this.addTouchSupportHelper(An,Ap,Ai,Aq,Aj);},isNearZero:function(Aj,Ai){Ai=Ai||5;var Ak=1/Math.pow(10,Ai);return(Math.abs(Aj)<Ak);},hasMergedRowCells:function(Ai){return false;},getMockUpThresholds:function(Ak,Al){var Ai=[{tid:1,n:"threshold 0",scope:1,rtp:2,rtxt:"",fmt:{bc:"#cc2525",bgs:0},expr:{et:14,nds:[{et:10,dmt:7,m:{did:"4C051DB611D3E877C000B3B2D86C964F",n:"Profit"},cs:[{v:"10%",dtp:5}],fn:2,fnt:3}],fn:19},ttp:1,flr:0,ceil:10},{tid:2,n:"threshold 1",scope:1,rtp:2,rtxt:"",fmt:{bc:"#e34b4b",bgs:0},expr:{et:14,nds:[{et:10,dmt:7,m:{did:"4C051DB611D3E877C000B3B2D86C964F",n:"Profit"},cs:[{v:"10%",dtp:5},{v:"30%",dtp:5}],fn:3,fnt:3}],fn:19},ttp:3,flr:10,ceil:30},{tid:3,n:"threshold 2",scope:1,rtp:2,rtxt:"",fmt:{bc:"#e97d7d",bgs:0},expr:{et:14,nds:[{et:10,dmt:7,m:{did:"4C051DB611D3E877C000B3B2D86C964F",n:"Profit"},cs:[{v:"30%",dtp:5},{v:"50%",dtp:5}],fn:3,fnt:3}],fn:19},ttp:3,flr:30,ceil:50},{tid:4,n:"threshold 3",scope:1,rtp:2,rtxt:"",fmt:{bc:"#79d479",bgs:0},expr:{et:14,nds:[{et:10,dmt:7,m:{did:"4C051DB611D3E877C000B3B2D86C964F",n:"Profit"},cs:[{v:"50%",dtp:5},{v:"70%",dtp:5}],fn:3,fnt:3}],fn:19},ttp:3,flr:50,ceil:70},{tid:5,n:"threshold 4",scope:1,rtp:2,rtxt:"",fmt:{bc:"#57ba57",bgs:0},expr:{et:14,nds:[{et:10,dmt:7,m:{did:"4C051DB611D3E877C000B3B2D86C964F",n:"Profit"},cs:[{v:"70%",dtp:5},{v:"90%",dtp:5}],fn:3,fnt:3}],fn:19},ttp:3,flr:70,ceil:90},{tid:6,n:"threshold 5",scope:1,rtp:2,rtxt:"",fmt:{bc:"#2ca02c",bgs:0},expr:{et:14,nds:[{et:10,dmt:7,m:{did:"4C051DB611D3E877C000B3B2D86C964F",n:"Profit"},cs:[{v:"90%",dtp:5}],fn:5,fnt:3}],fn:19},ttp:1,flr:90,ceil:100}];S.forEach(Ai,function(An){var Am=An.expr.nds[0].m;Am.did=Ak;Am.n=Al;});var Aj={};Aj[Ak]=Ai;return Aj;},generateThresholdsInfo:function(Ak,Ap,Ai,Am){var Ao=Ai.length,Aj=[],As,Al,At=0,Ar=0;for(var An=0;An<Ao;An++){Al=Math.round(Am[An]*100);Ar=At;At=Al||100;As={tid:An+1,n:"threshold "+An,scope:1,rtp:2,rtxt:"",fmt:{bc:Ai[An],bgs:0},expr:{et:14,nds:[{et:10,dmt:7,m:{did:Ak,n:Ap},cs:[{v:Al+"%",dtp:5}],fn:2,fnt:3}],fn:19},ttp:1,ceil:At,flr:Ar};Aj.push(As);}var Aq={};Aq[Ak]=Aj;return Aq;},psPt2CssPt:function(Ak,Aj){var Ai=parseInt(Ak,10)*0.75;if(Aj instanceof Function){Ai=Aj(Ai);}return Ai+"pt";},captureEventOnce:function(An,Am,Ai,Al,Ak){function Aj(Ao){Am.call(Ai,AZ.newDomEvent(An,window,Ao||window.event),Ak);AD.detachEvent(Al,An,Aj);}Ak=Ak||{};Al=Al||document;AD.attachEvent(Al,An,Aj);},getPropertyByPath:function(Am,Al,Ai){var Aj,Ak;if(typeof Al!=="string"){return Ai;}Aj=Al.split(".");Ak=Aj.every(function(Ao){var An=Am[Ao];if(An!==undefined){Am=An;return true;}return false;});return Ak?Am:Ai;},mergeHashes:function(){return Array.prototype.slice.apply(arguments).reduce(function(Ai,Aj){if(Aj){Object.keys(Aj).forEach(function(Ak){Ai[Ak]=Aj[Ak];});}return Ai;},{});},toggleControlEnabled:function(Ai,Aj){[].concat(Ai).forEach(function(Ak){Ak.set("enabled",!!Aj);});},findInArray:function(Al,Ak,Aj){var An=-1,Am,Ai;if(!Array.isArray(Al)){return An;}for(Am=Aj===undefined?0:Aj,Ai=Al.length;Am<Ai;Am+=1){if(Ak(Al[Am])){return Am;}}return An;},arrayUnique:function(Ai,Ak){if(!Array.isArray(Ai)){return Ai;}var Aj=mstrmojo.VisUtility;return Ai.filter(function(Al,Am){return Aj.findInArray(Ai,function(An){return Ak(Al,An);},Am+1)===-1;});},range:function(Ai,Am,Al){Al=Al||1;var Ak,Aj=[];for(Ak=Ai;Ak!==Am;Ak+=Al){Aj.push(Ak);}return Aj;},drawDashLine:function I(Aq,Ak,Ao,Aj,Am,Ai,Ap){var An=(Ak===Aj),Al;Aq.beginPath();Aq.moveTo(Ak,Ao);if(An){Al=0;Ao+=Ai;while(Ao<=Am){if(Al%2===0){Aq.lineTo(Ak,Ao);Ao+=Ap;}else{Aq.moveTo(Ak,Ao);Ao+=Ai;}Al++;}if(Al%2===0){Aq.lineTo(Aj,Am);}}else{Al=0;Ak+=Ai;while(Ak<=Aj){if(Al%2===0){Aq.lineTo(Ak,Ao);Ak+=Ap;}else{Aq.moveTo(Ak,Ao);Ak+=Ai;}Al++;}if(Al%2===0){Aq.lineTo(Aj,Am);}}Aq.stroke();},repeat:function(Ak,Al){var Ai=[],Aj;Al=Math.max(0,Al);for(Aj=0;Aj<Al;Aj+=1){Ai[Aj]=Ak;}return Ai;},isHierarchyObject:function(Ai){return(Ai&&Ai.t)===p.DssTypeDimension;},selectDropZonePanel:function(Ai){AB(Ai,"editPanel");},selectPropertyPanel:function(Aj,Ak){AB(Aj,"propertiesPanel");var Ai=Aj.edtModel;if(Ai){Ai.selectTargetByValue(Ak);}},pluck:function(Aj,Ai){if(!S.isArray(Aj)){return Aj;}return Aj.map(function(Ak){return Ak&&Ak[Ai];});},pick:function(Aj,Ai){return Ai.reduce(function(Al,Ak){Al[Ak]=Aj[Ak];return Al;},{});},isColorManuallySet:function(Ak,Aj){var Ai=Af(Ak,Aj);if(Ai){return Ai.isManual;}},getCombColor:function(Ak,Aj){var Ai=Af(Ak,Aj);if(Ai){return Ai.color;}},setColorPickerShowAutomatic:function(Aj,Ai){Aj.children[0].fillColor.colorPicker.showAutomatic=Ai;},getCharGroupValueChangeCb:function(Ai){var Aj=(function(){var Ak={};Ak[AS.FONT_WEIGHT]=AW.FS_BOLD;Ak[AS.FONT_STYLE]=AW.FS_ITALIC;Ak[AS.UNDERLINE]=AW.FS_UNDERLINE;Ak[AS.LINE_THROUGH]=AW.FS_STRIKETHROUGH;return function(Al,Am){return Al^Ak[Am];};}());return function(Al,Ak){if(Ai instanceof Function){Ai=Ai();}if(!Ai){return ;}switch(Al){case AS.COLOR:Ai.fontColor.fill.value.setValue(Ak);break;case AS.FONT_SIZE:Ai.fontSize.setValue(Ak);break;case AS.FONT_FAMILY:Ai.fontFamily.setValue(Ak);break;case AS.FONT_WEIGHT:case AS.FONT_STYLE:case AS.UNDERLINE:case AS.LINE_THROUGH:Ai.fontStyle.setValue(Aj(Ai.fontStyle.getValue(),Al));break;}};},getMetricsInDropZone:AO,addLegendFontChangeListeners:function(Aj,Ak){var Ai=["lgdFntClr","lgdFntSz","lgdFntFml","lgdFntStyle"];Aa(Ai,Aj,Ak);},addLegendBackgroundChangeListeners:function(Aj,Ak){var Ai=["lgdBgFillClr","lgdBgFillTrans"];Aa(Ai,Aj,Ak);},isValidDropZone:function(Ai){if(Ai===undefined){return false;}var Ak=Object.keys(Ai).filter(function(Al){return Al!=="visProp";});var Aj=X.copyProps(Ak,Ai);return Ai&&!X.equals(Aj,{});},unitExistInTemplate:function(Al,Ai){var Ak,An,Am=Ai.row,Aj=Ai.col;for(Ak=0,An=Am.length;Ak<An;Ak++){if(Am[Ak].id===Al){return true;}}for(Ak=0,An=Aj.length;Ak<An;Ak++){if(Aj[Ak].id===Al){return true;}}return false;},findDisabledUnits:function(Ar,As){var An,Aj,Al=As.docModel.datasets,Ai=Ar.gts,Ap=Ar.datasetId,Am=Al[Ap]||{},Ao=Am.att||[],Aq=[];var Ak=mstrmojo.VisUtility;if(Ao){for(An=0,Aj=Ao.length;An<Aj;An++){if(!Ak.unitExistInTemplate(Ao[An].did,Ai)){Aq.push(Ao[An]);}}}return Aq;},getDrillCandidates:function(An,Ao){var Aq=An.modelData,As=An.model,Am=As.docModel.datasets,Ai=Aq.gts,Ak=mstrmojo.VisUtility,At=Ak.findDisabledUnits(Aq,As),Aj=[],Al=(function(){var Au;if(Ao){S.forEach(Ai.row.concat(Ai.col),function(Av){if(Av.id&&Av.id===Ao){Au=Av.dp;}});}return Au;}()),Ap=function(Au,Ax){var Av=S.find(Au,"did",Ax.id),Aw=Au[Av];if(Aw&&!Aw.hide){Ax.n=Aw.n;return true;}return false;},Ar=S.filter(Al,function(Aw){var Au;for(Au in Am){var Av=Am[Au];if(Ap(Av.att,Aw)){return true;}}return false;});if(Ar){Aj=S.filter(At,function(Av){for(var Au in Ar){if(Ar[Au].n===Av.n){return true;}}return false;});}return Aj;},getDrillSubMenu:function(Ai){if(!Ai||!Ai.items||!Ai.drillAction){return{};}var Am=new mstrmojo.ui.menus.MenuConfig({supportsScroll:true,isHostedWithin:false,alignWithAnchor:true,maxHeight:350}),Aj=Ai.items,Al=Ai.drillAction,Ak=[];if(mstrmojo.resolveFeature("sort-drill-paths")){Aj.sort(function(Ao,An){if(Ao.n>An.n){return 1;}if(Ao.n<An.n){return -1;}return 0;});}Aj.forEach(function(Ap,An){if(Ak.indexOf(Ap.did)===-1){Ak.push(Ap.did);if(Ap.att){var Ao=mstrmojo.VisUtility;var Aq={};X.copy(Ai,Aq);Aq.items=Aj[An].att;Am.addPopupMenuItem(Ap.n,this.id,Ao.getDrillSubMenu,"xt",Aq);}else{Am.addMenuItem(Ap.n,"xt",Al,X.copy(Ai,{drillUnit:Ap}));}}});return Am;},getDrillMenu:function(Ao,Ap,Au,Ai){var Aq=Ao.model,Al=mstrmojo.VisUtility,Ar=Al.getDrillCandidates(Ao,Ap),As=Ar.length,An=Aq.docModel,Ak=An.datasets[Ao.modelData.datasetId],Ay,At=[],Aw=-1,Av,Ax,Am,Aj;if(Ak&&An.isMDXDataset(Ak)){Al.sortMdxDrillCandidates(Ar);Ay=Ak.tables[0];Ay.dimensions.forEach(function(Az){Am=true;Av=-1;Az.hierarchies.forEach(function(A0){Aj=true;A0.att.forEach(function(A1){Ax=Ae.findBin(Ar,A1,"did",As);if(Ax!==-1){if(Am){At.push({id:Az.did,did:Az.did,n:Az.n,att:[]});Aw++;Am=false;}if(Aj){At[Aw].att.push({id:A0.did,did:A0.did,n:A0.n,att:[]});Av++;Aj=false;}At[Aw].att[Av].att.push(Ar[Ax]);}});});});}else{At=Ar;}return Al.getDrillSubMenu(X.copy(Ai,{items:At,drillAction:Au}));},sortMdxDrillCandidates:function(Ai){Ai.sort(function(Ak,Aj){if(Ak.did<Aj.did){return -1;}if(Ak.did>Aj.did){return 1;}return 0;});return Ai;},getDrillMenuItemsCallback:function(Ak,Al,Ai,Aj){return function(){var An=mstrmojo.VisUtility;var Ao=An.getDrillCandidates(Ak,Aj),Am=new mstrmojo.ui.menus.MenuConfig({supportsScroll:true,maxHeight:350});Ao.forEach(function(Ap){Am.addMenuItem(Ap.n,"xt",Al,X.copy(Ai,{drillUnit:Ap}));});return Am;};},doDrill:function(Ak,Ay,At,Az){var A0=Ak;function Aq(A2){return A2.model.controller.cmdMgr;}function Aw(){return{success:function A2(){var A3=mstrmojo.VisUtility;A3.visPrint("reaise");this.raiseEvent({name:"regenerateToolbar"});}.bind(this)};}var Aj=A0.model,Ax=(A0.getDocModel&&A0.getDocModel())||A0.model.docModel,Av=Ax.getDataService(),An=Av.newUpdate();var Ap=true;if(Ax.prefs&&Ax.prefs.rtprnt){Ap=parseInt(Ax.prefs.rtprnt,10)===1;}else{if(Aj.xtab.defn.tkp!==undefined){Ap=parseInt(Aj.xtab.defn.tkp,10)===-1;}}Az=Az||{};Az.keepParent=Ap;var Ao=At.call(Ak,Ay,Az);var Ar=A0.zonesModel,A1=Ar.getUpdateCallback(),As=A0.model.controller||Ax.controller,Al=As._getXtabCallback(A0);An.add(Ao,Ad(A1,Al));var Ai=Aj.getSelectorDataFromTemplateLimit(A0.model.data.tpl).concat({keepOnly:true,data:A0.getContextMenuSelections()}),Au=Ax.getKeepOnlyOrExcludeAction(A0.k,Ai);An.add(Au,Aw.call(A0));Aq(A0).execute({execute:function Am(){this.submitUpdate(An);},urInfo:{callback:An.callback}});},strStartsWith:function(Ak,Aj,Ai){Ai=Ai||0;return Ak.lastIndexOf(Aj,Ai)===Ai;},changeWidgetBackground:function(Ak,Al,Aj){var Ai=Ak.parent;if(Ai&&Al!==Aj){Ai.changeUnitFormats(false,1,Ak.getFormats(),AS.BACKGROUND_COLOR,Al,Aj);Ai.raiseEvent({name:"BEMFormatChange",propertyName:AS.BACKGROUND_COLOR,value:Al,isTitle:false});}},translateGridError:function(Aj,Ai){if(Ai===undefined){Ai=Ag.AE_ERROR;}if(Ai===Ag.EMPTY_DATA){Aj=mstrmojo.desc(2388,"No data returned for this view. This might be because the applied filter excludes all data.");}if(Ai===Ag.NO_DATASET||Ai===Ag.NO_TEMPLATE_UNIT){Aj=mstrmojo.desc(11668,"Drag objects here.");}if(!Aj){Aj=mstrmojo.desc(13687,"Unknown error");}return{msg:Aj,type:Ai};},hasValidValueInMetric:function(Al,Aj){var Ai=mstrmojo.VisUtility;var Ak=Ai.getPropertyByPath(Al,"model.data.gsi.mx");if(Ak===undefined||Ak.length<=Aj||Aj<0){return false;}var Am=Ak[Aj];return["min","max"].every(function(An){var Ao=Am[An];return Ao!==undefined&&Ao!==null&&Ao!=="";});},renderWidgetErrorRSD:function(Al,An,Aj){var Ap=document.createElement("div");var Ao='<div style="display: table; height: 100%; width: 100%; background-color:#F5F5F2; border: solid 1px #A7A7A7; box-sizing: border-box;"><div style="display: table-cell; vertical-align: middle; text-align: center; color: #000000; font-size: 14pt;">'+An+"</div></div>";Ap.innerHTML=Ao;Ap=Ap.firstChild;var Ai=Al.width,Ak=Al.height;if(Ai!==undefined){Ap.style.width=Ai+"px";}if(Ak!==undefined){Ap.style.height=Ak+"px";}var Am=Al.domNode;if(Am){Aj.forEach(function(Aq){Am["on"+Aq]=undefined;});while(Am.firstChild){Am.removeChild(Am.firstChild);}Am.appendChild(Ap);}else{Al.parent.domNode.appendChild(Ap);}},visPrint:function(){var Ai=mstrmojo.VisUtility.enableInVis;if(Ai&&window.mstr_profile&&mstr_profile.enabled&&console){Function.prototype.apply.call(console.log,console,arguments);}},hasCGorCon:function(Al,Ai){var Ak=Ai&&Ai.did,Aj=Al.model.data.datasetId||"",Am=null;if(Ak){Am=AU.getDatasetFromAttributeId(Al.model.docModel.datasets,Ak);}else{if(Aj){Am=AU.getDatasetFromId(Al.model.docModel.datasets,Aj);}}return Am&&AU.hasCGorCon(Am);},isCGorCon:function n(Al,Ai){var Ak=Ai&&Ai.did,Aj=Al.model.data.datasetId||"",Am=null;if(Ak){Am=AU.getDatasetFromAttributeId(Al.model.docModel.datasets,Ak);}else{if(Aj){Am=AU.getDatasetFromId(Al.model.docModel.datasets,Aj);}}return Am&&AU.isCGorCon(Ai,Am);},findElementsByAttribute:function R(Ak,Am,Al,Ai){Ai=!!Ai;var An=[];if(Al.constructor!==Array){Al=[Al];}var Ao=function(Ap){if(Ai){return Ap.identity&&Ap.identity.tlOpt&&Ap.identity.tlOpt[Am];}else{return Ap.getAttribute(Am);}};function Aj(Ar){var Ap=Ao(Ar),Aq;if(Ar.hasChildNodes()){Aq=Ar.firstChild;while(Aq){if(Aq.nodeType===1){Ap=Ao(Aq);if(Al.indexOf(Ap)!==-1){An.push(Aq);}else{Aj(Aq);}}Aq=Aq.nextSibling;}}}Aj(Ak);return An;},restoreEsForUnit:function AQ(Am){if(!Am){return ;}var An=Am.es,Aj=Am.fs,Al=Am.otp,Ai=Aj&&Aj.length||0;function Ak(Ao){var Ap=document.createElement("div");Ap.innerHTML=Ao;return Ap.innerText;}if(An){S.forEach(An,function(Ap,Ao){Ap.n=c.decodeHtmlString(Ap.n);if(Al===p.DssTypeAttribute&&Ai){switch(Aj[Ao%Ai].bftp){case AM.DssBaseFormHTMLTag:Ap.n=Ak(Ap.n);break;default:}}});}},isTrue:function AV(Ai){return Ai==="true"||Ai===true;},getFontFamilyItems:function r(){if(P){return P;}else{P=[];S.forEach(Q.Families.slice(1),function(Ai){P.push({n:Ai.n,id:Ai.n,did:Ai.n,preview:!Ai.symbolic});});return P;}},surroundWithQuotes:function AP(Ai){if(!Ai){return"";}return"'"+Ai.replace(/^['|"]+/,"").replace(/['|"]+$/,"")+"'";}});mstrmojo.VisUtility.enableInVis=true;}());(function(){mstrmojo.requiresCls("mstrmojo.Box","mstrmojo.Label","mstrmojo.hash","mstrmojo.array","mstrmojo.ui.Checkbox","mstrmojo.css","mstrmojo.string","mstrmojo.threshold.ThresholdExprTree","mstrmojo.ui.menus._HasMenuPopup","mstrmojo.models.FormatModel.getFormatUpdate","mstrmojo.vi.ui.DatasetUnitMenuUtils","mstrmojo.threshold.ThresholdModel.REPLACE_SYMBOL","mstrmojo.vi.util.NumberFormatUtility");mstrmojo.requiresDescs(2869,3397,5893,7978,7979,13788,13789,13790,13894,14599,14600,14601,14611);var M=mstrmojo.hash,I=mstrmojo.array,U=mstrmojo.css,B=mstrmojo.string,A=mstrmojo.models.FormatModel.decodeValue,J=mstrmojo.threshold.ThresholdModel.REPLACE_SYMBOL,D=mstrmojo.vi.ui.DatasetUnitMenuUtils,K=12,L=mstrmojo.models.FormatModel.ENUM_NUMBER_FORMAT_KEYS_OBJ,N=mstrmojo.vi.util.NumberFormatUtility;function S(W){this.threshold.scope=W;}function C(c,X,W,b){var Y=this.previewNode;switch(c){case 10:var a=I.filterOne(J,function(d){return d.v===X;});if(a){Y.innerHTML=a.n;}break;case 4:U.addClass(Y,"hasImage");Y.innerHTML='<img class="replaceImg" src="'+B.encodeHtmlString(X)+'" />';break;default:var Z=B.encodeHtmlString(X)||(W===K?mstrmojo.desc(14611,"Sample"):"1234.567");if(!!b){Z=N.applyFormatToNumber(b,Z);}Y.innerHTML=Z;}}function E(Y,W){W.fontFamily="'"+(Y.ff||"").replace(/\'/g,"")+"'";W.fontSize=parseInt(Y.fsz,10)+"pt";W.fontWeight=Y.fw?"bold":"normal";W.textDecoration=(Y.fun?"underline":"")+" "+(Y.fst?"line-through":"");W.fontStyle=Y.fit?"italic":"";W.color=Y.fc;var X;if(!!Y.bc&&!!Y.bc.c1){X=U.buildGradient(Y.bc.or,Y.bc.c1,Y.bc.c2);if(X&&X.n){W[X.n]=X.v;}}else{if(!!Y.gdc){X=U.buildGradient(Y.gda===90?0:1,Y.bc,Y.gdc);if(X&&X.n){W[X.n]=X.v;}}else{W.backgroundColor=Y.bc;}}W.textAlign=Y.alh;W.verticalAlign=Y.alv;W.wordWrap=Y.atw;W.direction=Y.atd;var Z=Y.bts;W.border=Y.borderStyle||(Z?A("bts",Z):"1px dotted");W.borderColor=Y.borderColor||Y.btc||"#e1e1e1";}mstrmojo.threshold.ThresholdRow=mstrmojo.declare(mstrmojo.Box,[mstrmojo.ui.menus._HasMenuPopup],{scriptClass:"mstrmojo.threshold.ThresholdRow",markupString:'<div id="{@id}" class="mstrmojo-thresholdRow cf {@cssClass}" style="{@cssText}" mstrAttach:click><div class="draggable-icon"></div><div class="container"></div><div class="previewWrap"><div class="preview"></div></div><div class="menu"></div><div class="delete"></div></div>',markupSlots:{containerNode:function P(){return this.domNode.children[1];},draggableNode:function O(){return this.domNode.firstChild;},previewNode:function P(){return this.domNode.children[2].firstChild;},menuNode:function P(){return this.domNode.children[3];},deleteNode:function G(){return this.domNode.children[4];}},threshold:undefined,idx:undefined,editor:undefined,model:undefined,lblIndex:undefined,chkBox:undefined,exprTree:undefined,postBuildRendering:function R(){this.destroyChildren(false);var W=this.threshold,X=this.model,Y=this.previewNode.style,a=M.copy(W.fmt,M.clone(X.getGridValueFormat())),Z=W.expr;C.call(this,W.rtp,W.rtxt,X.objectType,a.nfs);if(a){E(a,Y);}this.destroyChildren(false);this.addChildren([{scriptClass:"mstrmojo.Label",alias:"lblIndex",text:this.idx+1},{scriptClass:"mstrmojo.threshold.ThresholdExprTree",alias:"exprTree",editor:this.editor,model:this.model,items:[Z]}]);X.attachEventListener("selectedThresholdsChange",this.id,"onselectedThresholdsChange");return this._super();},onselectedThresholdsChange:function Q(){},onclick:function V(Z){var X=this.editor,b=Z.getTarget(),Y=this,W=this.model,a=X.objectType===K;if(b===this.deleteNode){this.removeFromModel();}else{if(b===this.menuNode){var c=new mstrmojo.ui.menus.MenuConfig();c.hostId=this.id;c.hostElement=this.menuNode;c.isHostedWithin=false;c.addSubMenuItem(mstrmojo.desc(13788,"Apply to"),"",X.id,function(){var d=new mstrmojo.ui.menus.MenuConfig();d.addRadioMenuGroup(Y.threshold.scope||1,S,[{value:1,text:a?mstrmojo.desc(14599,"Element Rows Only"):mstrmojo.desc(13789,"Metric Only")},{value:2,text:a?mstrmojo.desc(14600,"Subtotal Rows Only"):mstrmojo.desc(13790,"Subtotals Only")},{value:3,text:a?mstrmojo.desc(14601,"Elements and Subtotals"):mstrmojo.desc(13894,"Metric and Subtotals")}],"",Y,true);return d;});c.addMenuItem(mstrmojo.desc(2869,"Formatting"),"",function(){X.openPropertyPanel(Y);});if(W.showNumberFormat()){c.addEditorMenuItem(mstrmojo.desc(13237,"Number Format"),"",function(){var d=function(e){M.forEach(e,function(g,f){if(!Y.threshold.fmt){Y.threshold.fmt={};}Y.threshold.fmt[f]=g;});Y.model.raiseEvent(M.copy(Y.model,{name:"modelEdit"}));};return D.getNumberFormatEditor(Y,Y.threshold.fmt||{},function(f){var e={};e[L.CATEGORY]=f.category||-3;e[L.CURRENCY_POSITION]=f.currencyPosition||0;e[L.CURRENCY_SYMBOL]=f.currencySymbol||"$";e[L.DECIMAL_PLACES]=f.decimalPlaces||2;e[L.FORMAT]=f.format||"";e[L.NEGATIVE_NUMBERS]=f.negativeNumbers||3;e[L.THOUSAND_SEPARATOR]=f.thousandSeparator||0;d(e);});});}c.addMenuItem(mstrmojo.desc(3397,"Duplicate"),"",function(){W.duplicateThreshold(Y.idx);});if(this.idx!==0){c.addMenuItem(mstrmojo.desc(7978,"Move Up"),"",function(){W.moveThreshold(Y.idx,Y.idx-1);});}else{c.addNonInteractiveMenuItem(mstrmojo.desc(7978,"Move Up"),"",true);}if(this.idx!==W.thresholds[W.metricId].length-1){c.addMenuItem(mstrmojo.desc(7979,"Move Down"),"",function(){W.moveThreshold(Y.idx,Y.idx+1);});}else{c.addNonInteractiveMenuItem(mstrmojo.desc(7979,"Move Down"),"",true);}c.addMenuItem(mstrmojo.desc(5893,"New Condition"),"",function(){Y.exprTree.newCondition(null);});this.openPopup(c.newInstance());}else{if(b===this.previewNode||b===this.previewNode.firstChild){X.openPropertyPanel(this);}}}},removeFromModel:function F(){this.model.deleteThreshold(this.threshold);},onpropertyModelChange:function H(W){M.copy(W.threshold,M.clear(this.threshold));this.refresh();}});}());(function(){mstrmojo.requiresCls("mstrmojo.vi.models.EnumDragSources","mstrmojo.vi.ui.DatasetUnitMenuUtils");var A=mstrmojo.vi.ui.DatasetUnitMenuUtils;mstrmojo.vi.ui._CanDropFromSchema=mstrmojo.provide("mstrmojo.vi.ui._CanDropFromSchema",{_mixinName:"mstrmojo.vi.ui._CanDropFromSchema",augmentDropContextForSchema:function B(E,C){var F=E.getCtxtDragData();if(F.src===mstrmojo.vi.models.EnumDragSources.ALL_OBJECT_LIST){var D=A.getCfgForAddUnitFromAllObject(F.items,C.datasets||{});F.dsid=D.dsid;if(D.actions.length){E.actions=D.actions;E.callback=C.getDatasetsUpdateCallback();}}}});})();(function(){mstrmojo.requiresCls("mstrmojo.vi.ui.PanelPortlet","mstrmojo.vi.ui._IsDropTarget");var H=mstrmojo.css,C="dragIn";function E(J){var K=J.tgt,L=this.dropzoneTgt;if(L&&K){K.node=L.domNode.firstChild;K.widget=L;}}mstrmojo.vi.ui.VisualizationEditorPanelPortlet=mstrmojo.declare(mstrmojo.vi.ui.PanelPortlet,[mstrmojo.vi.ui._IsDropTarget],{scriptClass:"mstrmojo.vi.ui.VisualizationEditorPanelPortlet",dropzoneTgt:null,allowDrop:function F(J){E.call(this,J);return this.dropzoneTgt.allowDrop(J);},ondragover:function D(J){this.addBorder();E.call(this,J);this.dropzoneTgt.ondragover(J);},ondrop:function I(J){E.call(this,J);this.dropzoneTgt.ondrop(J);},addBorder:function G(){H.addClass(this.domNode,C);},clearBorder:function B(){H.removeClass(this.domNode,C);},postBuildRendering:function A(){if(this._super){this._super();this.dropzoneTgt=this.children[0];}},getLayoutOffsets:function(){return(!!mstrApp.isWSStyling)?{h:0,w:26}:this._super();}});}());(function(){mstrmojo.requiresCls("mstrmojo.vi._MonitorsAppState","mstrmojo.vi.ui.PanelPortlet","mstrmojo.dom","mstrmojo.hash","mstrmojo.css");var B=mstrmojo.css,G=mstrmojo.hash,E=mstrmojo.dom;function D(){B.toggleClass(this.titleBar.leftToolNode,"hidden",this.hideCollapse);}mstrmojo.vi.ui.DatasetPortlet=mstrmojo.declare(mstrmojo.vi.ui.PanelPortlet,[mstrmojo.vi._MonitorsAppState],{scriptClass:"mstrmojo.vi.ui.DatasetPortlet",cssClass:"docdataset-unitlist-portlet",suffix:"",showTitleBarContextMenu:true,init:function F(H){this._super(H);if(mstrApp.isWSStyling){this.paddingCfg.paddingLeft=3;}this.addChildren([this.getDatasetTypeCfg(H.dataset)]);if(this.dataset&&this.dataset.unpublished){this.unpublished=true;}},getDatasetTypeCfg:function(I){var J=(I.dsm===1)?mstrmojo.desc(14453,"In memory"):mstrmojo.desc(14452,"Live");if(I.connInfo&&I.dsm===2){J+="("+I.connInfo.isn+")";}return{scriptClass:"mstrmojo.Label",markupString:'<div id="{@id}" class="mstrmojo-Label {@cssClass}" style="{@cssText}" title="{@title} "mstrAttach:click,contextmenu></div>',slot:"titlebarNode",alias:"typeBar",text:J,cssClass:"dataset-type",useRichTooltip:true,oncontextmenu:function(L){E.preventDefault(window,L.e);var K=this.parent,M=G.walk("parent.titleBar",this),N=G.walk("src.parent.titleBar.lblTitle.domNode",L);if(M&&E.contains(M.textNode,N,true,M.domNode)){L.cancel();M.tbToolbar.closePopup();var O=M.getMenuConfig();if(O){O.hostId=M.tbToolbar.id;O.hostElement=M.tbToolbar.domNode;O.position=E.getMousePosition(L.e,L.hWin);K.preOpenContextMenu();M.tbToolbar.openPopup(O.newInstance());O.position=null;}}},updateTooltipConfig:function H(K){this.parent.titleBar.updateTooltipConfig(K);this.richTooltip=this.parent.titleBar.richTooltip;}};},postBuildRendering:function(){this._super();D.call(this);B.toggleClass(this.domNode,"unpublished",this.unpublished);},getTitleBarCfg:function C(){var H=this._super(),I=this;if(this.suffix&&this.suffix.length>0){H.getTitleChildren=function(){return[{scriptClass:"mstrmojo.Label",slot:"textNode",alias:"suffixNode",cssClass:"suffix",text:I.suffix}].concat(this.constructor.prototype.getTitleChildren.call(this));};}H.layoutConfig=(!!mstrApp.isWSStyling)?{w:{leftToolNode:"auto",textNode:"100%",rightToolNode:"auto"},h:{leftToolNode:"26px",textNode:"26px",rightToolNode:"26px",containerNode:"26px"},xt:true}:{w:{leftToolNode:"auto",textNode:"100%",rightToolNode:"auto"},h:{leftToolNode:"22px",textNode:"22px",rightToolNode:"22px",containerNode:"22px"},xt:true};return H;},onAppStateChange:function A(H){this._super(H);var I=mstrmojo.vi.VisualInsightApp.APP_STATES.PAUSE,K=!!(H.valueWas&I),J=mstrApp.isAppStatePause();if(K!==J){this.generateToolbar();}if(!!mstrApp.isWSStyling&&!mstrApp.isAppStatePresentation()&&this.parent.parent.visible){this.titleBar.refresh();}}});mstrmojo._HasMarkup.addMarkupMethods(mstrmojo.vi.ui.DatasetPortlet,{onhideCollapseChange:function(){D.call(this);}});}());(function(){mstrmojo.requiresCls("mstrmojo.vi.ui.rw.UnitContainer","mstrmojo.tooltip","mstrmojo.dom");var A=mstrmojo.dom;mstrmojo.vi.ui.rw.RichTooltipBox=mstrmojo.declare(mstrmojo.vi.ui.rw.UnitContainer,null,{scriptClass:"mstrmojo.vi.ui.rw.RichTooltipBox",tooltipOpenDelay:300,tooltipTopOffset:8,tooltipLeftOffset:16,useRichTooltip:true,showTooltip:function C(H,G){var F=this,E=this.boxContent;if(E.canShowContentTooltip&&!E.canShowContentTooltip(H,G)){return ;}if(!F.hasOpenTooltip&&E){var D=A.getMousePosition(H,G);F.richTooltip={cssClass:"vi-regular vi-tooltip-A",content:E.tooltip,top:Math.max(D.y+this.tooltipTopOffset,0),left:Math.max(D.x-this.tooltipLeftOffset,0),posType:mstrmojo.tooltip.POS_TOPLEFT};this._super(H,G);}},moveTooltip:function B(D,F){if(this._tooltipTimeOut){window.clearTimeout(this._tooltipTimeOut);this._tooltipTimeOut=null;if(this.hideTooltip){this.hideTooltip();}else{mstrmojo.tooltip.close();}}var H=this,E=D,G=F;this._tooltipTimeOut=setTimeout(function(){H.showTooltip(E,G);},this.tooltipOpenDelay);}});}());(function(){mstrmojo.requiresCls("mstrmojo.css","mstrmojo.dom","mstrmojo.string","mstrmojo.Label","mstrmojo.vi.ui.rw.UnitContainer","mstrmojo.vi.ui.ScrollableDocTextfield","mstrmojo.DocHTMLContainer","mstrmojo.ui.ScrollableTextArea");var a=mstrmojo.css,J=mstrmojo.dom,C=mstrmojo.string;var R=0,A=1;var U="url",N="htmlText";var K="http://",c=null,O=[{n:mstrmojo.desc(4555,"iFrame"),v:R,id:0},{n:mstrmojo.desc(4554,"Html Text"),v:A,id:1}];function d(e,f,g){this.model.editHtmlContainer(this,e,f,g);}function Q(e,f){var h=this.ctrlOverlay,g=parseInt(f.match(/\d+/),10);if(h&&h.visible){a.toggleClass(h.domNode,"v",g<310||parseInt(e.match(/\d+/),10)>g);}}function L(e,f,g){return function(){var p=e?N:U,n=mstrmojo.all[g],m=n.parent,l=n.node,k=m.defn,j=m.htmlType!==e;if(j){m.htmlType=e;var h={scriptClass:e===R?"mstrmojo.DocHTMLContainer":"mstrmojo.vi.ui.ScrollableDocTextfield",id:l.id,node:l,slot:"containerNode",alias:"boxContent",controller:n.controller,model:n.model,k:l.k,defn:l.defn,builder:n.builder,tooltip:n.tooltip,formatHandlers:{domNode:["D"]},edtModel:n.edtModel};m.removeAndDestroyChild(n);m.addChildren(h);if(mstrApp&&mstrApp.isSingleTier){m.boxContent.attachEventListener("renderComplete",m.id,function(){J.redirectUrlToFormWrapper(this.boxContent.domNode);});}m.boxContent.render();n=m.boxContent;}if(j||k[p]!==f){k[p]=f;l.data.v=l.data.rv=f;if(m.htmlType===A){n.updateScrollbars();}}n.update(l);n.refresh();m.selectVIUnit(true);var o=m.ctrlOverlay;if(o&&o.visible&&!mstrmojo.string.isEmpty(f)){m.hideControlOverlay();}};}function D(){return mstrApp.isSingleTier||mstrmojo.resolveFeature("create-html-container");}mstrmojo.vi.ui.rw.HtmlBox=mstrmojo.declare(mstrmojo.vi.ui.rw.UnitContainer,null,{scriptClass:"mstrmojo.vi.ui.rw.HtmlBox",htmlType:R,textArea:undefined,typeBtn:undefined,maskTooltip:mstrmojo.desc(15271,"HTML container cannot be selected as target"),init:function W(f){this._super(f);var e=this.defn,g=this.boxContent.node.data;this.htmlType=e.ht?A:R;e[this.htmlType?N:U]=C.decodeHtmlString(g.rv||g.v);a.addWidgetCssClass(this,"mstrmojo-HtmlBox");if(mstrApp&&mstrApp.isSingleTier){this.boxContent.attachEventListener("renderComplete",this.id,function(){J.redirectUrlToFormWrapper(this.boxContent.domNode);});}},postBuildRendering:function X(){this._super();this.addDragHandle();if(!this.boxContent.node.data.v&&mstrApp.allowWebDashboardDesign()&&D.call(this)){this.showControlOverlay(this.getEditOverlayControls());}},applyBoxSize:function V(e,g,k,j){this._super(e,g,k,j);var h=this.boxContent,f=h&&h.getFormats();if(f){h.clearCache();f.height=e;f.width=g;h.refresh();}Q.call(this,e,g);},getAvatarCls:function S(){return this._super().concat(["htmlAvatar"]);},getDisplayName:function M(){return this.defn.n||mstrmojo.desc(4538,"HTML Container");},createDeleteUpdate:function G(){return this.model.getRemoveFieldUpdate(this);},updateHtmlBox:function Z(g,h){var e=this.htmlType,f=this.defn[e?N:U],j=this.boxContent.node.id;if(e!==g||f!==h){d.call(this,g,h,{success:L(g,h,j),undo:L(e,f,j),redo:L(g,h,j)});}},setDefaultTextCaretPosition:function F(f,e){if(f.value===e){window.setTimeout(function(){var g=e===c?(e.indexOf("</body>")-1):(e.indexOf("//")+2);J.setCaret(f,g);},0);}},getHintText:function b(){return[K,c];},isDragValid:function B(e){if(!this._super(e)){return false;}var h=e.src,g=this.ctrlOverlay,f=g&&g.textArea;return !(f&&J.contains(f.domNode,J.eventTarget(h.hWin,h.e)));},getEditOverlayControls:function I(){var h=this,f=this.htmlType,g=this.boxContent.edtModel;return[{scriptClass:"mstrmojo.Label",cssClass:"icn"},{scriptClass:"mstrmojo.Label",cssClass:"title",text:mstrmojo.desc(13623,"HTML container:")},g.getButtonBar(O,f,function(l){var k=l.v,m=this.parent.textArea;m.set("emptyText",h.getHintText()[k]);m.set("value","");m.refresh();},{alias:"typeBtn",showIcon:false,cssClass:"htmlTypeBtn"}),{scriptClass:"mstrmojo.ui.ScrollableTextArea",emptyText:this.getHintText()[f],maxLength:undefined,alias:"textArea",cssClass:"htmlText",keepEmpty:true,onfocus:function j(){h.setDefaultTextCaretPosition(this.inputNode,this.emptyText);if(this.inputNode.value===this.emptyText){this.scrollNode.scrollTop=35;}},postvalueChange:function e(){this.parent.ctrlOkBtn.set("enabled",!!this.value);}},mstrmojo.Button.newWebButton(mstrmojo.desc(8708,"OK"),function(){var k=this.parent;h.updateHtmlBox(k.typeBtn.selectedItem.v,k.textArea.value);h.hideControlOverlay();},true,{alias:"ctrlOkBtn",enabled:false})];},showControlOverlay:function E(e){this.toggleDragHandleVisibility(false);this._super(e);this.boxContent.set("visible",false);},hideControlOverlay:function Y(){this._super();this.toggleDragHandleVisibility(true);this.boxContent.set("visible",true);},switchToEditMode:function P(){var h=this.boxContent.node.data,e=h.rv||h.v,g=this.ctrlOverlay,f=g.textArea;if(g.visible){f.focus();return ;}this._super();a.toggleClass(g.domNode,"v",parseInt(this.height.match(/\d+/),10)>parseInt(this.width.match(/\d+/),10));f=g.textArea;f.set("value",e);f.refresh();f.focus();},canShowDesignMenuItems:function H(){return this._super()&&D.call(this);}});mstrmojo.vi.ui.rw.HtmlBox.boxConfiguration={f:{h:150,v:140},minSize:{h:150,v:40},o:"v"};}());(function(){mstrmojo.requiresCls("mstrmojo.Widget","mstrmojo.ui.menus.MenuConfig","mstrmojo.mstr.ui.EnumWebPromptsList","mstrmojo.form","mstrmojo.IVEDatasetPicker","mstrmojo.mstr.MDXCubeBrowser","mstrmojo.NewFolderEditor","mstrmojo.CustomGroupEditor","mstrmojo.mstr._ObjectActions","mstrmojo.mstr.ui.MstrFileUploadHelper");var D=mstrmojo.tstid,H=mstrmojo.dom;var B={BLANK:"05B202B9999F4C1AB960DA6208CADF3D",XDA:"1ADEAA2C4754E2DE5DFEC08022DAFDC6",ICUBE:"DB8D5B064BBE3C24F541DAA81A507FDC"};function C(O,M,P,N){if(window.iframe){window.iframe.showWaitPage(true);}mstrmojo.form.send(O,M,P,N);}function I(M){if(mstrApp.currentFolderId){M.saveFolderId=mstrApp.currentFolderId();}}function E(O,S){function Q(b){function c(e){if(e){C(e.params,null,"post");}}var Z=b.config;if(b.config.did===B.ICUBE){var d="mstr-create-objectExpl",a=mstrmojo.all[d];if(!a){a=new mstrmojo.IVEDatasetPicker({id:d,cssClass:"mstr-create-menu-cubePicker",title:mstrmojo.desc(4354,"Select Intelligent Cube"),help:"Select_Intelligent_Cube_dialog_box.htm",onOk:function(){Z.params={evt:3005,src:V+".3005",srcType:2,srcID:this.item.did,reportDesignMode:1,name:"editReport"};I(Z.params);c(Z);},onCancel:function(){a.close();},onRender:function(){var g=false,f=this;this.btnImport.set("visible",g);this.newLabel.set("visible",g);this.useExistingLabel.set("visible",g);this.ob.set("scrollableIncFetch",false);this.btnHBox.destroyChildren();var e=mstrmojo.Button.newWebButton(mstrmojo.desc(547,"Select"),function(){if(this.enabled){f.onOk();f.onCancel();}},true);e.bindings={enabled:function(){return this.parent.parent.multiSelect?!!this.parent.parent.selectedItems.length:!!this.parent.parent.item;}};this.btnHBox.addChildren([e,mstrmojo.Button.newWebButton(mstrmojo.desc(221,"Cancel"),function(){f.onCancel();},false)]);}});}if(Z.title){a.set("title",Z.title);}if(Z.cssClass){a.set("cssClass",Z.cssClass);}a.open();}else{if(b.config.did===B.XDA){(new mstrmojo.mstr.MDXCubeBrowser({onClose:function(){this.destroy();},onOK:function(e){var f={evt:3005,src:(mstrApp.servletName||mstrApp.name)+".3005",srcType:1,srcID:e.did,reportDesignMode:1};I(f);C(f);}})).open();}else{if(Z.did){c(Z);}}}if(b.menuOpener.createMenu&&b.menuOpener.createMenu.close){b.menuOpener.createMenu.close();}return true;}function U(c,Z){var b=c.config,a='<a class="mstrMenuItem subMenuItem '+b.name+' {@cls} {@newGroup}" idx="{@idx}" value="'+b.value+'"title="'+(b.desc||"")+'"><span class=""></span><span class="label">{@n}</span></a>';return a;}var M=this,P=mstrmojo.hash.clone(S||M.createMenuData.rl)||[{n:mstrmojo.desc(3693,"(None)")}],V=mstrApp.servletName||mstrApp.name;for(var R=0;R<P.length;R++){if(P[R].did===B.BLANK){var N=P[R];P.splice(R,1);P.splice(0,0,N);continue;}if(P[R].did===B.XDA||P[R].did===B.ICUBE){var N=P[R];P.splice(R,1);P.splice(1,0,N);continue;}}for(var R=0;R<P.length;R++){var W=false;var X=P[R].did;if(X===B.ICUBE){if(mstrmojo.resolveFeature("web-define-view-report")){W=true;}}else{W=true;if(!mstrmojo.resolveFeature("template-reports")||(X===B.BLANK&&(!mstrmojo.resolveFeature("design-mode")||!mstrmojo.resolveFeature("modify-report-list")))||(X===B.XDA&&(!mstrmojo.resolveFeature("dhtml")||!mstrmojo.resolveFeature("web-define-view-report")||!mstrmojo.resolveFeature("define-query-report-builder")))){W=false;}}if(!W){continue;}var Y;if(P[R].t===8){Y=K(P[R],M,O,E);}else{Y=O.addCustomMenuItem(P[R].n,"",Q,U);P[R].params={reportID:P[R].did,blank_reportDesignMode:1,reportDesignMode:((mstrmojo.resolveFeature("design-mode")&&(this.reportCreationViewMode!="0"))?4:0),evt:3005,src:V+".3005",reportViewMode:1,promptStyle:"PromptsTransformCreateReport",promptsExecuteStyle:"PromptsTransformClassicSave",promptsCreateStyle:""};I(P[R].params);if(P[R].did===B.BLANK){P[R].params.reportDesignMode=1;}Y.config=P[R];Y.menuOpener=M;}}}function A(P){function V(Y){var Z={DssXmlViewMediaViewStatic:1,DssXmlViewMediaViewInteractive:2,DssXmlViewMediaViewEditable:4};var X=Z.DssXmlViewMediaViewStatic;if(Y!==0){if((Y&Z.DssXmlViewMediaViewEditable)>0){X=Z.DssXmlViewMediaViewEditable;}else{if((Y&Z.DssXmlViewMediaViewInteractive)>0){X=Z.DssXmlViewMediaViewInteractive;}else{if((Y&Z.DssXmlViewMediaViewStatic)>0){X=Z.DssXmlViewMediaViewStatic;}}}}return X;}var O=this,R=O.createMenuData.dl,W=O.createMenuData.docList,S=mstrApp.servletName||mstrApp.name;function Q(X){var Z="";if(!X){return Z;}for(var Y=0;Y<X.length;Y++){Z+='<a title="'+X[Y].n+" - "+X[Y].desc+'" id = vt_'+X[Y].did+' class="dashboardStyleTemplate mstrMenuItem subMenuItem" idx="{@idx}" rwviewmode = "'+V(X[Y].avm)+'" data-id = "'+X[Y].did+'"></a>';}return Z;}function N(X){if(!X){return"";}var Z="";for(var Y=0;Y<X.length;Y++){Z+='<a class="mstrMenuItem subMenuItem {@cls}" title = "'+X[Y].desc+'" idx="{@idx}" data-id = '+X[Y].did+' rwviewmode = "'+V(X[Y].avm)+'" >'+X[Y].n+"</a>";}return Z;}function M(){var Z='<div class = "mstr-dashboard-subMenu dashboardTemplates">'+Q(R)+"</div>";var Y='<div class = "mstr-dashboard-subMenu docList" >'+N(W)+"</div>";var X="";if(R){X+=Z;}if(W){X+="<hr>"+Y;}return X;}function U(Y,X){var Z={blank_rwDesignMode:1,rwDesignMode:1,evt:3104,src:S+".3104",createDocument:"*-1.*-1.0.0.0"};Z.rwViewMode=X._evtTarget.getAttribute("rwviewmode");Z.objectID=X._evtTarget.getAttribute("data-id");I(Z);C(Z,null,"post");return true;}P.addCustomMenuItem("DashDoc Templates","",U,M);}function G(U){function S(V){C(V.config.params);return true;}function M(X,V){var W=X.config;return"<a "+D(W.name+"Item")+' class="mstrMenuItem subMenuItem '+W.name+' {@cls} {@newGroup}" idx="{@idx}" value="'+W.value+'"><span class=""></span><span class="label">{@n}</span></a>';}var N=mstrmojo.mstr.ui.EnumWebPromptsList.get();for(var O=0;O<N.length;O++){var R=N[O],Q=mstrmojo.desc(R.descId)||R.n,P=U.addCustomMenuItem(Q,"",S,M);P.config=R;}}function K(O,R,M,N){if(!O.items&&!O.loading){O.loading=true;var Q=new mstrmojo.SimpleXHR({async:false});Q.request("POST",mstrConfig.taskURL,{success:function P(U){var V=U.items||[];if(V.length===0){V.push({n:mstrmojo.desc(3693,"(None)")});}O.items=V;delete O.loading;}},{folderID:O.did,taskId:"folderBrowse",styleName:R.folderBrowsingStyle,includeObjectDesc:true});}return M.addPopupMenuItem(O.n,"",function S(){var U=new mstrmojo.ui.menus.MenuConfig({menuCssClass:"mstr-create-menu",hostProxyCssClass:"mstrmojo-create-menu-host",isHostedWithin:false,includeScroll:false,alignWithAnchor:true});N.call(R,U,O.items);return U;});}function J(N){var O=this,M=N;return function(){var R=document.querySelector("[tstid="+N+"Item]"),Q=H.position(R),P=mstrmojo.insert({scriptClass:"mstrmojo.ui.menus.MenuConfig",menuCssClass:"mstr-create-menu",hostProxyCssClass:"mstrmojo-create-menu-host",noInheritTheme:true,tstid:N+"Sbm",supportsScroll:true,isHostedWithin:false,includeScroll:false,alignWithAnchor:true,maxHeight:Math.max(H.windowDim().h-Q.y-30,100)});switch(M){case"template":E.call(O,P);break;case"templateDoc":P.menuCssClass=P.menuCssClass+" mstr-dashboard-subMenu collapse";A.call(O,P);break;case"prompt":G.call(O,P);break;}return P;};}function F(Z){var N=this,S=N.createMenuData.sl;var a=mstrmojo.all["mscld-create-menuList"],V=mstrApp.servletName||mstrApp.name;if(!a){var W=mstrmojo.insert({scriptClass:"mstrmojo.ui.menus.MenuConfig",menuCssClass:N.cssClassName+" collapse",hostProxyCssClass:N.hostCssClassName,anchorElement:Z.domNode,hostId:Z.id,isHostedWithin:false,includeScroll:false,tstid:"createMenu"});if(N.alignMenuToRight){W.setAlignment(mstrmojo.ui.PopupConfig.ENUM_CORNERS.BOTTOM_RIGHT,mstrmojo.ui.PopupConfig.ENUM_CORNERS.TOP_RIGHT);}function U(g,d){var f=g.config;var e="<a "+D(f.name+"Item")+' class="mstrMenuItem '+f.name+' {@cls} {@newGroup}" idx="{@idx}" onclick=" mstrmojo.all[\''+N.id+"'].onclick('"+g.name+'\',event)" href="'+f.href+'" useIframe="'+f.iframe+'"';if(f.accept!==undefined){e+=' accept = "'+f.accept+'"';}e+=' name="'+f.name+'"><span class="micn"></span><span>{@n}</span></a>';return e;}function Y(g,d){var f=g.config;var e="<label "+D(f.name+"Item")+' for ="myFile" class="mstrMenuItem '+f.name+' {@cls} {@newGroup}" idx="{@idx}" onclick=" mstrmojo.all[\''+N.id+"'].onclick('"+g.name+'\',event)" href="'+f.href+'" target="'+f.target+'" useIframe='+f.iframe+'"';if(f.accept!==undefined){e+=' accept = "'+f.accept+'"';}e+='name="'+f.name+'"><span class="micn"></span><span>{@n}</span></label>';return e;}function Q(e){if(e.config.name==="folder"){var d=mstrmojo.insert({scriptClass:"mstrmojo.NewFolderEditor",fId:mstrApp.currentFolderId?mstrApp.currentFolderId():"",Index:a.domNode.style.zIndex+10,navigateAfter:true,okFn:function(){var f=this,g={evt:2001,src:V+"."+mstrApp.pageName+".fbb.fb.2001",folderID:f.fId};C(g,mstrApp.name,"POST");},onClose:function(){this.destroy();}});d.open();}if(a&&a.close){window.setTimeout(function(){a.close();},10);}return true;}var M=false;for(var R=0;R<S.sl.length;R++){var P=S.sl[R];if(P.grp){W.addSeparator();}var c={},O=M===false?"":"collapsable ";if(P.name==="prompt"||P.name==="template"||P.name==="templateDoc"){c=W.addPopupMenuItem(P.n,W.id,J.call(N,P.name));c.cls=c.cls+O+P.name;c.tstid=P.name+"Item";}else{if(P.name==="myFile"){c=W.addCustomMenuItem(P.n,O,Q,Y);var b='<form id="import_form" class="mstrmojo-FileUploadBox" target="hidden_import_iframe" enctype="multipart/form-data" method="post" action="'+mstrConfig.taskURL+'"><input id="myFile" name="myFile" type="file" class="mstrmojo-FileUploadBox-file mstr-create-menu-fileUpload" size="30" onchange="mstrApp.uploadMstrFileFn.upload(\'import_form\');" accept=".mstr" title=""><input type="hidden" name="fileFieldName" value="myFile"><input type="hidden" name="taskId" value="importAsyncSaveRWD"><input type="hidden" name="taskEnv" value="jsonp2"><input type="hidden" name="jsonp" value="parent.mstrApp.uploadMstrFileFn.callback(@R@)"><input type="hidden" name="myfile" value=""><input type="hidden" name="folderID" value="" id="import_folderID"></form>';b+='<iframe name="hidden_import_iframe" style="display:none;" src="about:blank"></iframe>';if(!document.getElementById("import_form")){var X=document.createElement("SPAN");X.innerHTML=b;document.body.appendChild(X);}}else{c=W.addCustomMenuItem(P.n,O,Q,U);c.tstid=P.name;}c.config=P;if(P.name==="folder"){c.config.params={evt:17001,src:V+"."+mstrApp.pageName+".OMDCreateFolder.17001",targetName:"fb",iframe:true,target:"frameManager"};}}c.name=P.name;}a=W.newInstance({id:"mscld-create-menuList"});}a.set("includeScroll",false);a.open(Z);N.createMenu=a;a.onClose=function(){Z.toggleButtonClass(false);};}function L(O){var S=this,Q=S.createMenuData;function M(V){mstrmojo.xhr.request("POST",mstrConfig.taskURL,{success:function U(W){V.createMenuData.dl=W.items;V.createMenuData.loadData.dlLoaded=true;P();}},{folderID:"FCA4BAFE4AF0D00088028989D7497A4F",taskId:"folderBrowse",styleName:V.folderBrowsingStyle,includeObjectDesc:true,objectType:"55"});mstrmojo.xhr.request("POST",mstrConfig.taskURL,{success:function U(W){V.createMenuData.docList=W.items;V.createMenuData.loadData.dlLoaded=true;P();}},{folderID:"6C87013036D94E65B9FD227CF919327E",taskId:"searchMetadata",styleName:V.folderBrowsingStyle,recursive:1,includeAncestorInfo:false,includeObjectDesc:true,objectType:"14081"});}function R(V){mstrmojo.xhr.request("POST",mstrConfig.taskURL,{success:function U(W){V.createMenuData.rl=W.items;V.createMenuData.loadData.rlLoaded=true;P();}},{taskId:"folderBrowse",systemFolder:"16",styleName:V.folderBrowsingStyle,includeObjectDesc:true,objectType:"55"});}function P(){if(S.createMenuData.sl&&N(S.createMenuData.loadData)){F.call(S,O);}}if(!Q){S.createMenuData={};mstrmojo.xhr.request("POST",mstrConfig.taskURL,{success:function(W){var V;S.createMenuData.sl=W;S.createMenuData.loadData={};for(V=0;V<W.sl.length;V++){var U=W.sl[V]["feature-id"];switch(U){case"create-view-reports":S.createMenuData.loadData.rlLoaded=false;R(S);break;case"template-documents;dhtml;documents-design-mode":S.createMenuData.loadData.dlLoaded=false;M(S);break;}}P();}},{taskId:"getShortcutsList",pageName:"createOptions"});}else{P();}function N(W){if(!W){return true;}var V=true;for(var U in W){V=V&&W[U];}return V;}}mstrmojo.mstr.ui.CreateMenu=mstrmojo.declare(mstrmojo.Widget,[mstrmojo.mstr._ObjectActions],{scriptClass:"mstrmojo.mstr.ui.CreateMenu",hostCssClassName:"mstrmojo-create-menu-host",cssClassName:"mstr-create-menu",opener:null,folderBrowsingStyle:"MobileFolderStyle",onclick:function(M,N){if(M!=="myFile"){mstrmojo.dom.preventDefault(window,N);}switch(M){case"customGroup":this.openCustomGroupEditor({});break;case"metric":this.openMetricEditor({});break;case"queryBuilder":this.openDataImport({});break;case"filter":this.createFilter();break;case"scNewIVE":this.createDashboard();break;case"appSchema":location.href="?evt=3199&src="+mstrApp.name+".3199";break;}},loadCreateMenu:function(){if(!this.opener){return ;}L.call(this,this.opener);}});}());(function(){mstrmojo.requiresCls("mstrmojo.array","mstrmojo.dom","mstrmojo.expr","mstrmojo.hash","mstrmojo.Container","mstrmojo._HasLayout","mstrmojo._HasPopup","mstrmojo.ui.ColumnWalk","mstrmojo.Button","mstrmojo.mstr.EnumNodeDimty","mstrmojo.ConditionModel","mstrmojo.rw.ConditionWalkProvider");var S=mstrmojo.Widget,J=mstrmojo.array,F=mstrmojo.dom,O=mstrmojo.hash,A=mstrmojo.mstr.EnumNodeDimty,K=mstrmojo.rw.ConditionWalkProvider.setTip,Q=mstrmojo.expr,I=Q.ET;var C=mstrmojo.desc(11899,"Select a dataset object.");var M=J.hash([A.NodeDimtyOutputLevel]);function E(){var X=this.model;if(X){if(!X.attachEventListener){O.make(X,mstrmojo.ConditionModel,{});}X.attachEventListener("edit",this.id,"onmodeledit");}}function N(Y,X){if(X&&X.detachEventListener){X.detachEventListener("edit",Y.id,"onmodeledit");}}function P(c,X){var a=X,b=[],Z=[],Y=[],d=false;O.forEach(a,function(e){b=b.concat(e.att.filter(function(f){return f.did===c;}));});d=b[0]&&b[0].da;b.forEach(function(e){Z=Z.concat(e.fs||[]);});Z.forEach(function(e){if((e.obf||d)&&Y.filter(function(f){return f.did===e.fid;}).length===0){Y.push({did:e.fid,dtp:mstrmojo.expr.mapBaseFormTypeToDataType(e.bftp),n:e.fnm,t:e.t,isbf:e.isbf});}});return Y;}function D(c,X){var Y,a=X,b,Z=false;if(typeof microstrategy!=="undefined"){a=a||microstrategy.bones.rwb_viewer.datasetInfos;}O.forEach(a,function(d){Y=d.mx;O.forEach(Y,function(e){if(e.did===c){b=d;Z=e.um||e.rdm;return false;}});return !b;});return Z&&b&&b.isMDX;}mstrmojo.rw.ConditionWalk=mstrmojo.declare(mstrmojo.Container,[mstrmojo._HasLayout,mstrmojo._HasPopup],{scriptClass:"mstrmojo.rw.ConditionWalk",markupString:'<div class="mstrmojo-rw-ConditionWalk" mstrAttach:click><div class="condition mstrmojo-ConditionNode"><div class="mstrmojo-cond-contents"></div></div><div class="walk"></div><div class="apply"></div></div>',markupSlots:{conditionNode:function(){return this.domNode.firstChild;},walkNode:function(){return this.domNode.children[1];},applyNode:function(){return this.domNode.lastChild;}},markupMethods:{onvisibleChange:function L(){S.visibleMarkupMethod.call(this);if(this.visible){this.initWalk();}},onheightChange:S.heightMarkupMethod,onwidthChange:S.widthMarkupMethod},layoutConfig:{h:{conditionNode:"auto",walkNode:"100%",applyNode:"auto"},xt:true},editor:undefined,columnWalk:undefined,tip:undefined,walkProvider:null,objectBrowsingEnabled:true,postCreate:function B(){if(this._super){this._super();}if(!this.walkProvider){this.walkProvider=mstrmojo.insert(mstrmojo.rw.ConditionWalkProvider);}},initWalk:function R(){var X=this.columnWalk,Y=this.walkProvider;K.call(this,C);X.removeTrailingContainer(-1);X.addNextColumn(Y.getTargetNodeProps());X.target.updateColumnContainer();this.updateOkBtn();},updateBrowseElementsParams:function(a,Z){a.attributeID=Z.did;a.otp=Z.t||12;var Y=this.editor,X=Y&&Y.onUpdateBrowseElementsParams;if(X){X.call(Y,a,Z);}},children:[{scriptClass:"mstrmojo.ui.ColumnWalk",alias:"columnWalk",slot:"walkNode",height:"333px",width:"750px"},{alias:"cancelBtn",slot:"applyNode",scriptClass:"mstrmojo.Button",cssClass:"cancelBtn",title:mstrmojo.desc(2399,"Cancel"),ignoreLayout:true,onclick:function(){var X=this.parent;if(X.close){X.close();}}},{alias:"okBtn",slot:"applyNode",scriptClass:"mstrmojo.Button",cssClass:"okBtn",title:mstrmojo.desc(2397,"OK"),onclick:function(){var X=this.parent;if(X.onOK){X.onOK();}}},{scriptClass:"mstrmojo.Label",alias:"tip",slot:"applyNode",cssClass:"tip",text:C,ignoreLayout:true}],eb:{scriptClass:"mstrmojo.Editor",cssClass:F.isIE7?"mstrmojo-ElementsEditorIE7":"mstrmojo-ElementsEditor",title:mstrmojo.desc(6149,"Select Elements"),help:"element_browser_dialog_box.htm",children:[{scriptClass:"mstrmojo.ElementsBrowser",alias:"browser",onUpdateBrowseElementsParams:function(Y){var X=this.parent.opener;X.updateBrowseElementsParams(Y,X.model.a);}},{scriptClass:"mstrmojo.HBox",cssClass:"mstrmojo-Editor-buttonBox",slot:"buttonNode",children:[{scriptClass:"mstrmojo.Button",alias:"ok",text:mstrmojo.desc(1442,"OK"),cssClass:"mstrmojo-WebButton hot",cssText:"width: 66px;",onclick:function(){var X=this.parent.parent,Y=X&&X.opener;if(Y){Y.onEBSelect();Y.closePopup();}}},{scriptClass:"mstrmojo.Button",alias:"ok",text:mstrmojo.desc(221,"Cancel"),cssClass:"mstrmojo-WebButton",cssText:"min-width: 66px; margin-left: 11px;",onclick:function(){var X=this.parent.parent,Y=X&&X.opener;if(Y){Y.closePopup();}}}]}]},ob:{scriptClass:"mstrmojo.Editor",title:mstrmojo.desc(5298,"Select an Object"),help:"Select_Objects_dialog_box_.htm",children:[{scriptClass:"mstrmojo.ObjectBrowser",alias:"browser",fishEyeVisible:false,upButtonVisible:true,scrollableIncFetch:true,showCompletePath:false,closeable:false,closeOnSelect:false,browsableTypes:"3,4,8,10,12,256",includeObjectDesc:true,quickSearch:true,minSearchLength:1}]},_set_model:function V(a,X){var Y=this.model,Z=(X!==Y);if(Z){N.call(this,Y);X.dimtyTypes=this.dimtyTypes||M;this.model=X;E.call(this,X);if(this.hasRendered&&this.visible){this.columnWalk.target.updateColumnContainer();}}return Z;},onmodeledit:function H(Y){var X=Y.prop,a=X==="c0"||X==="c1",Z=this.columnWalk[a?"c0":X];if(a){Z.c1Selected=X==="c1";}Z.updateColumnContainer();Z.c1Selected=false;this.updateOkBtn();},browse:function G(Z){var b=this.parent.editorNode,a=function(d,f){var c=mstrmojo.dom.position(d,true),e=mstrmojo.dom.position(f,true);return{x:c.x+c.w,y:e.y};},X=this.columnWalk,Y=this.walkProvider;switch(Z&&Z.alias){case"target":case"dmy":Y.browseObjs(this,Z,a(Z.alias==="target"?X.target.domNode:this.dmyNode,b));break;case"c0":case"c1":Y.browseObjs(this,Z,a(X.c0.domNode,b));break;case"es":Y.browseEs(this,Z,a(X.es.domNode,b));break;}},onOBSelect:function(b){var Z=this.ob.browser,d=Z.target;this.closePopup();var Y=this.targets,c=d.itemIdField,a=Y||[],X=J.find(Y,c,b[c]);if(X===-1){a.push(b);this.targets=a;this.targetsLastMod=new Date();this.raiseEvent({name:"updateTargets",targets:this.targets});}d.setSelectedItems([b],d.multiSelect);if(d.onObjBrowsed){d.onObjBrowsed(b);}},onEBSelect:function(){var Y=this.eb.browser,a=this.columnWalk.es.es;a.set("selectedIndices",{});var X=a.items,Z=[];J.forEach(Y.selectedItems||[],function(c){if(J.find(a.items,"v",c.v)<0){Z.push(c);}});var b=a.insertUnlistedValuesAt||0;if(b<0){b=X.length;}a.set("items",X.slice(0,b).concat(Z).concat(X.slice(b)));a.setSelectedItems(Y.selectedItems,false);},destroy:function U(Y){var X=this.walkProvider;if(X&&X.destroy){this.walkProvider.destroy();}this._super(Y);},updateOkBtn:function W(){var a=true,X=this.model,Y,Z=X&&Q.fnCstCount(X.fn,X.fnt);if(!X){return ;}switch(X.et){case I.AQ:case I.AL:case I.MQ:for(Y=0;Y<Z;Y++){a=a&&!this["invalid"+Y];}break;}a=a&&!!X.completed;this.okBtn.set("visible",a);this.raiseEvent({name:"conditionWalkUpdateOkBtn",valid:a});}});mstrmojo.rw.ConditionWalk.getAttForms=P;mstrmojo.rw.ConditionWalk.isMdxDM=D;}());(function(){mstrmojo.requiresCls("mstrmojo.Container","mstrmojo.css","mstrmojo.array","mstrmojo.Model","mstrmojo.IncFetch","mstrmojo.Label","mstrmojo.ui.ButtonBar","mstrmojo.ui.List","mstrmojo.mstr.search.SearchIconView","mstrmojo.mstr.search.SearchGridView","mstrmojo.mstr._ObjectActions");mstrmojo.requiresDescs(3364,3366,9202,14557);var D=mstrmojo.desc,H=mstrmojo.css,C=mstrmojo.hash;mstrmojo.mstr.search.SearchResults=mstrmojo.declare(mstrmojo.Container,[],{scriptClass:"mstrmojo.mstr.search.SearchResults",markupString:'<div id="{@id}" class="mstrmojo-SearchResults {@cssClass}"><div class="mstrmojo-SearchResults-list"></div><div class="mstrmojo-SearchResults-toolbar"></div><div class="mstrmojo-SearchResults-if"></idv></div>',markupSlots:{listNode:function(){return this.domNode.firstChild;},toolbarNode:function(){return this.domNode.childNodes[1];},incFetchNode:function(){return this.domNode.lastChild;}},markupMethods:{onresultsChange:function(){if(this.hasRendered){this.listNode.style.height=this.results&&this.results.items&&this.results.items.length>0?"":0;}}},height:"430px",supportIncFetch:true,results:{},iconView:false,init:function I(L){if(this._super){this._super(L);}this.addChildren([this.getViewRef(),{scriptClass:"mstrmojo.Label",alias:"notFoundMsg",cssText:"text-align: center",allowHTML:true,visible:false,ontextChange:function(){this.set("visible",!mstrmojo.string.isEmpty(this.text));},slot:"listNode"},{scriptClass:"mstrmojo.ui.ButtonBar",items:[{n:"Icon View",v:1,css:"iconView"},{n:"Grid View",v:2,css:"gridView"}],showIcon:true,cssClass:"viewModesButtonBar",selectedIndex:1,postselectionChange:function(O){var P=this.items,Q=P[O.added[0]],R=P[O.removed&&O.removed[0]];if(Q.v!==R.v){this.parent.set("iconView",Q.v===1);}},bindings:{visible:function(){return !this.parent.notFoundMsg.visible&&this.parent.list.visible;}},slot:"toolbarNode"}]);if(this.supportIncFetch){var M=this;this.addChildren([{scriptClass:"mstrmojo.IncFetch",alias:"incFetch",slot:"incFetchNode",np:0,cp:0,ds:{f:mstrmojo.desc(4046,"First"),p:mstrmojo.desc(1058,"Previous"),n:mstrmojo.desc(1059,"Next"),l:mstrmojo.desc(4049,"Last"),pgs:mstrmojo.desc(5972,"## of ### pages"),gt:mstrmojo.desc(5878,"Go to:"),v:mstrmojo.desc(6079,"This field should be # between ## and ###.")},onifsChange:function N(O){mstrmojo.hash.copy(O.value,this);if(this.np>1){this.children=null;this.refresh();}H.toggleClass(this.domNode,"show",this.np>1);},onfetch:function K(O){M.onfetch(O);}}]);}},getViewRef:function F(){var K=this.iconView?"mstrmojo.mstr.search.SearchIconView":"mstrmojo.mstr.search.SearchGridView";return{scriptClass:K,alias:"list",slot:"listNode",bindings:{visible:function(){return this.items&&this.items.length>0;}}};},oniconViewChange:function A(){this.removeChildren(this.list);this.addChildren([this.getViewRef()]);this.renderChildren();this.onresultsChange();},onresultsChange:function J(){this.list.set("items",this.results&&this.results.items);this.updateNotFoundMsg();this.updateIncFetch();},updateNotFoundMsg:function G(){var K=this.parent,L=K?K.getNotFoundMsg():"";this.notFoundMsg.set("text",K.hasUserInput()&&C.isEmpty(this.results&&this.results.items)?L:"");},updateIncFetch:function B(){var K=this.results;if(this.supportIncFetch){var L=this.getTotalSize(),N=K.bb,M=K.bc;this.incFetch.set("ifs",{np:Math.floor(L/M)+((L%M>0)?1:0),cp:Math.floor(N/M)+((N%M>0)?1:0)});}},getTotalSize:function E(){return Math.min(this.maxSearchResults,this.results.sz);}});}());(function(){mstrmojo.requiresClsP("mstrmojo","array","css","hash","color","Editor","Button","Box","Label","num");mstrmojo.requiresClsP("mstrmojo.ui","Pulldown","Checkbox","CheckList");mstrmojo.requiresClsP("mstrmojo.threshold","ColorSlider","ThresholdModel");mstrmojo.requiresClsP("mstrmojo.models","FormatModel");mstrmojo.requiresDescs(16098,16096,16094,16097,16095,16099,16100,16101,16102,16103,16104,2290,16105,16106,16107,16108,5585,7665,7666,7905,7907,7908,7909,7910,12110,12111,16110,16109,16106);var O=mstrmojo.array,d=mstrmojo.css,V=mstrmojo.hash,W=mstrmojo.Button.newWebButton,a=mstrmojo.num,F=mstrmojo.models.FormatModel.getFormatUpdate,R=mstrmojo.vi.viz.EnumVizStyles,D=mstrmojo.vi.viz.EnumVisualizationTemplates,A=4,Q=20,P=[{n:mstrmojo.desc(16111,"Sequential"),idx:0},{n:mstrmojo.desc(16134,"Diverging"),idx:14},{n:mstrmojo.desc(16135,"Accessible"),idx:20}],G={BUSINESS_BLUE:1,MARINE_BLUE:2,BUSINESS_TEAL:3,AQUAMARINE:4,EMERALD:5,YELLOW_TO_GREEN:6,TANGERINE:7,HONEY:8,SUNFLOWER:9,BUSINESS_RED:10,RASPBERRY:11,LAVENDER:12,GRAY:13,TROPICAL_JUNGLE:15,ORANGE_AND_TEAL:16,WILD_BERRY:17,TRAFFIC_LIGHTS:18,TEMPERATURE:19,ACCESSIBLE_GOLD_AND_PURPLE:21,ACCESSIBLE_GRAY:22,ACCESSIBLE_ORANGE_AND_TEAL:23};var b=mstrmojo.threshold.ThresholdModel.SLIDER_MODE,H=mstrmojo.threshold.ThresholdModel.FEATURES;var M=null,B=null,c=[{n:mstrmojo.desc(527,"Value"),v:7},{n:mstrmojo.desc(4405,"Lowest"),v:4},{n:mstrmojo.desc(529,"Highest"),v:5},{n:mstrmojo.desc(4406,"Lowest %"),v:1},{n:mstrmojo.desc(4407,"Highest %"),v:2}];function Y(u){var v=[],q=this.colorSlider,p=q.getComp(),k=q.getPalette(),r=this.basedOn.value,m=this.model,n=this.controller,w=m.orgThresholds,g=this.metricId,j=w&&w[g],f=this.breakBy.breakByList,o=f.items[f.selectedIndex],h=p.length,l,x;if(q.getReversedValue()){k=k.concat().reverse();}for(l=0;l<h;l++){x={};if(this.colorSlider.sliderMode===b.IMAGE_BASED){x.rtp=4;x.rtxt=k[l];}else{x.fmt=F("bc",k[l]);}if(l>0){x.flr=a.toLocaleString(m.getRealValue(p[l-1],r,q.minValue(),q.maxValue()));}if(l<h-1||h===1){x.ceil=a.toLocaleString(m.getRealValue(p[l],r,q.minValue(),q.maxValue()));}if(o&&o.did!==-1){x.dmy={did:o.did,t:o.t};}v.push(x);}n.onSubmitActions(v,j,g,n.supportsFeature(H.SHOW_BASED_ON)?this.basedOn.selectedMetric:g,this.basedOn.value,u,A);}function L(q){var m=this.model,AJ=m.data,h=m.thresholds&&m.thresholds[q],AE=AJ.gsi,u=this.colorSlider,o=[],AI=[],n=[],t,AH,f,w=this.colorPalettes,r=this.imageSelector,AC=w.colorPulldown,AG=this.typeSelector.typeCheckList,g=r.imagePulldown,p=this.basedOn,l=p.options,AA=p.metricsList,z=this.breakBy.breakByList,x=this.controller.supportsFeature(H.SHOW_BASED_ON);if(h&&h.length>0){t=m.getSimpleThresholdType(q);if(t!==-2){f=m.isImageBasedType(q);l.set("selectedIndex",O.find(l.items,"v",t));h.forEach(function(AK){var AM=V.copy(AK),AL=AM.ceil;if(AL!==Infinity){AM.comp=m.getNormalizedValue(AL,AK.ttp,u.minValue(),u.maxValue());}else{AM.comp=1;}o.push(AM);});o.sort(function(AL,AK){return AL.comp-AK.comp;});o.forEach(function(AK){AI.push(AK.comp);if(f){n.push(AK.rtxt);}else{n.push(AK.fmt.bc);}});AG.set("selectedIndex",f?b.IMAGE_BASED:b.COLOR_BASED);if(f){AH=m.getImageSetName(n);g.set("selectedIndex",O.find(B,"v",AH));}else{AH=m.getColorScheme(n);if(AH==="custom"){this.switchToCustomScheme(AI,n);u.unselectAll();u.update();}else{AC.set("items",M);AC.set("selectedIndex",O.find(M,"v",AH));}}u.set("baseColor",AH);u.setColorComp(AH,AI);if(m.isMapReversed(AH,n,f)){u.reverseMapColor();}if(x){var k=h[0].expr,v=k.m||k.nds[0].m;AA.set("selectedIndex",O.find(AE.mx,"did",(v&&v.did)||m.metricId));}var AF;try{AF=h[0].expr.nds[0].dmy.uts[0].utgt.did;}catch(AD){}z.set("selectedIndex",Math.max(0,O.find(z.items,"did",AF)));}}else{var AB=AJ.visName,j;AG.set("selectedIndex",b.COLOR_BASED);AC.set("items",M);if(AB===undefined){AC.set("selectedIndex",G.TRAFFIC_LIGHTS);}else{if(AB===R.HEAT_MAP){AC.set("selectedIndex",G.TRAFFIC_LIGHTS);}else{if(AB===R.NETWORK){AC.set("selectedIndex",G.BUSINESS_BLUE);}else{if(AB===R.ESRI_MAP||AB===R.GOOGLE_MAP||AB===R.MAPBOX){AC.set("selectedIndex",G.MARINE_BLUE);}else{j=parseInt(V.walk("dz.visProp.fmt.visType",AJ));switch(j){case D.GRAPHMATRIXVERTICALLINECLUSTERED:case D.GRAPHMATRIXVERTICALLINESTACKED:case D.GRAPHMATRIXVERTICALLINEPERCENT:case D.GRAPHMATRIXVERTICALLINEAUTOMATIC:case D.GRAPHMATRIXHORIZONTALLINECLUSTERED:case D.GRAPHMATRIXHORIZONTALLINESTACKED:case D.GRAPHMATRIXHORIZONTALLINEPERCENT:case D.GRAPHMATRIXHORIZONTALLINEAUTOMATIC:case D.GRAPHMATRIXVERTICALAREACLUSTERED:case D.GRAPHMATRIXVERTICALAREASTACKED:case D.GRAPHMATRIXVERTICALAREAPERCENT:case D.GRAPHMATRIXVERTICALAREAAUTOMATIC:case D.GRAPHMATRIXHORIZONTALAREACLUSTERED:case D.GRAPHMATRIXHORIZONTALAREASTACKED:case D.GRAPHMATRIXHORIZONTALAREAPERCENT:case D.GRAPHMATRIXHORIZONTALAREAAUTOMATIC:AC.set("selectedIndex",G.TRAFFIC_LIGHTS);break;case D.GRAPHMATRIXBUBBLECIRCLEMM:case D.GRAPHMATRIXBUBBLEGRIDCIRCLEAA:case D.GRAPHMATRIXBUBBLEGRIDSQUAREAA:case D.GRAPHMATRIXBUBBLESQUAREAM:case D.GRAPHMATRIXBUBBLESQUAREMM:AC.set("selectedIndex",G.MARINE_BLUE);break;default:AC.set("selectedIndex",G.BUSINESS_BLUE);break;}}}}}u.update();if(x){AA.set("selectedIndex",O.find(AE.mx,"did",q||m.metricId));}z.set("selectedIndex",0);}}function S(f){this.parent.colorSlider.set("baseColor",f);this.selectedColor=f;}function U(){return W("",function(){this.parent.parent.colorSlider.reverseMapColor(this.checked);},false,{cssClass:"reverse-btn"});}function N(){var f=this.model,h=this.basedOn.options,k=h.items,l=isNaN(f.getMetricsMaxValue())||isNaN(f.getMetricsMinValue()),g=(l||!this.controller.supportsFeature(H.SHOW_VALUE_ITEM))?c.slice(1):c,j=k[h.selectedIndex];if(g.length!==k.length){h.set("items",g);h.set("selectedIndex",Math.max(g.indexOf(j),0));}}mstrmojo.threshold.SimpleThresholdEditor=mstrmojo.declare(mstrmojo.Editor,null,{scriptClass:"mstrmojo.threshold.SimpleThresholdEditor",cssClass:"mstrmojo-SimpleThresholdEditor",title:mstrmojo.desc(3647,"Thresholds"),help:"thresholds_editor.htm",model:undefined,controller:undefined,metricId:undefined,metricName:undefined,typeSelector:undefined,basedOn:undefined,breakBy:undefined,colorSlider:undefined,colorPalettes:undefined,imageSelector:undefined,showAdvancedEditorLink:undefined,init:function X(h){this._super(h);var g=mstrApp.customization.getCustomThresholds(),f=function(j){return{n:mstrmojo.desc(j.title,"N/A"),v:j.id,cls:j.id};};if(!M){M=g.color.map(function(j){return f(j);});}O.forEach(P,function(j){M.splice(j.idx,0,{n:j.n,cls:"title",v:null});});this.colorPalettes.colorPulldown.set("items",M);if(!B){B=g.image.map(function(k){var j=f(k);j.bc=k.combinedImageUrl;return j;});this.imageSelector.imagePulldown.set("items",B);}},onOpen:function E(){var f=this.controller,g=this.model,l=this.basedOn,j=l.options,m=l.metricsList,h=this.metricId,k=g.data.gsi;this.colorSlider.resetColorMap();if(this.colorSlider.editableBubble){this.colorSlider.editableBubble.hideBubble();}d.toggleClass(this.containerNode,"hideImage",!f.supportsFeature(H.SHOW_IMAGE));if(f.supportsFeature(H.SHOW_BASED_ON)){d.addClass(j.domNode,"right-pulldown");m.set("items",k.mx);m.set("visible",true);}else{m.set("visible",false);d.removeClass(j.domNode,"right-pulldown");}this.breakBy.breakByList.set("items",[{n:mstrmojo.desc(2057,"None"),did:-1}].concat(this.targets.filter(function(n){return n.t===12;})));this.showAdvancedEditorLink.set("visible",f.supportsFeature(H.SHOW_ADVANCED_EDITOR));L.call(this,h);this.colorSlider.updateLabels();this.domNode.oncontextmenu=function(){if(mstrApp.isSingleTier){return false;}};},onClose:function C(){this.model.cleanUp();},switchToCustomScheme:function J(o,h){var j="custom",m=this.colorSlider,l=this.colorPalettes.colorPulldown,k=l.items,f=k.map(function(p){return p.v;}).indexOf(j)!==-1;o=o||m.getComp().concat();if(!h){var g=m.getPalette().concat();h=m.getReversedValue()?g.reverse():g;}m.addCustomScheme(o,h);if(!f){var n=V.clone(k);n.unshift({n:mstrmojo.desc(2056,"Custom"),v:j});l.set("items",n);}l.set("selectedIndex",O.find(l.items,"v",j));},children:[{scriptClass:"mstrmojo.Box",cssClass:"row",alias:"typeSelector",typeCheckList:undefined,children:[{scriptClass:"mstrmojo.Label",text:mstrmojo.desc(12112,"Thresholds Type:")},{scriptClass:"mstrmojo.ui.CheckList",alias:"typeCheckList",multiSelect:false,orientation:"h",postselectionChange:function K(t){var n=this.parent.parent,l=n.model,o=n.colorSlider,h=n.colorPalettes,k=h.colorPulldown,q=n.imageSelector,j=q.imagePulldown,g=k.items[k.selectedIndex],f=B[j.selectedIndex],r=t.added[0],m=r?f:g,p=r?l.getDefaultImages()[0].id:l.getDefaultColors()[0].id;h.set("visible",!r);q.set("visible",!!r);o.set("sliderMode",r);o.set("baseColor",(m&&m.v)||p);o.editableBubble.set("visible",false);if(r===b.IMAGE_BASED&&!j.selectedIndex){j.set("selectedIndex",0);}},selectedIndex:0,items:[{n:mstrmojo.desc(12113,"Color-based"),v:"color",cls:"color"},{n:mstrmojo.desc(12114,"Image-based"),v:"image",cls:"image"}]}]},{scriptClass:"mstrmojo.Box",cssClass:"row",alias:"colorPalettes",selectedColor:undefined,colorPulldown:undefined,children:[{scriptClass:"mstrmojo.Label",text:mstrmojo.desc(2060,"Color:")},{scriptClass:"mstrmojo.ui.Pulldown",cssClass:"color-pulldown",alias:"colorPulldown",onitemSelected:function I(g){S.call(this.parent,g.v);for(var f=0;f<=Q;f++){d.removeClass(this.selectedNode,["C"+f]);}if(g.cls){d.addClass(this.selectedNode,g.cls);}},getPopupListConfig:function Z(){return{scriptClass:"mstrmojo.ui.PopupList",alias:"list",selectionPolicy:"reselect",locksHover:true,useRichTooltip:true,showTooltipForLargeText:true,scrollNodeMaxHeight:this.scrollNodeMaxHeight,getItemMarkup:function h(k,j){if(k.cls==="title"){return'<{@tag} class="item {@cls}" idx="{@idx}" style="{@style}" title="{@title}">{@en@n}</{@tag}>';}return'<{@tag} class="item {@cls}" idx="{@idx}" style="{@style}" title="{@title}"><div class="text">{@en@n}</div></{@tag}>';},listHooks:{select:function f(k,l,j){this.parent.set("selectedIndex",j);if(this.visible&&this.closeAfterSelection){this.close();}}},getItemProps:function g(l,j){var k=mstrmojo._IsList.getItemProps.call(this,l,j);k.style=this.parent.itemCssText||"";return k;}};},selectedIndex:1,items:M},U()]},{scriptClass:"mstrmojo.Box",cssClass:"row",alias:"imageSelector",visible:false,selectedColor:undefined,imagePulldown:undefined,children:[{scriptClass:"mstrmojo.Label",text:mstrmojo.desc(6369,"Images:")},{scriptClass:"mstrmojo.ui.Pulldown",cssClass:"image-pulldown",alias:"imagePulldown",onitemSelected:function I(f){S.call(this.parent,f.v);},getPopupListConfig:function Z(){var f=mstrmojo.ui.Pulldown.prototype.getPopupListConfig.call(this);f.getItemMarkup=function h(){return'<{@tag} class="item {@cls}" idx="{@idx}" style="{@style}" title="{@title}"><div class="bc" style="{@bc}"></div><div class="text">{@n}</div></{@tag}>';};f.getItemProps=function g(l,j){var k=mstrmojo._IsList.getItemProps.call(this,l,j);k.bc="background:url("+l.bc+");background-size: contain;background-repeat: no-repeat;";return k;};return f;},items:B},U()]},{scriptClass:"mstrmojo.Box",cssClass:"row",alias:"basedOn",value:"",metricsList:undefined,options:undefined,children:[{scriptClass:"mstrmojo.Label",text:mstrmojo.desc(4402,"Based on:")},{scriptClass:"mstrmojo.ui.Pulldown",cssClass:"left-pulldown",alias:"metricsList",onitemSelected:function I(j){var h=this.parent,f=h.parent,g=j.did;h.selectedMetric=f.model.basedOnId=g;f.colorSlider.resetMinMax();f.colorSlider.update();f.colorSlider.updateLabels();N.call(f);}},{scriptClass:"mstrmojo.ui.Pulldown",selectedIndex:3,cssClass:"right-pulldown option",alias:"options",onitemSelected:function I(h){var l=this.parent,g=l.parent,k=g.breakBy,j=h.v,f=j===7;l.value=j;g.colorSlider.set("selectedOption",h.v);k.set("visible",!f);if(f){k.breakByList.set("selectedIndex",0);}},items:c}]},{scriptClass:"mstrmojo.Box",cssClass:"row",alias:"breakBy",breakByList:undefined,children:[{scriptClass:"mstrmojo.Label",text:mstrmojo.desc(4564,"Break By:")},{scriptClass:"mstrmojo.ui.Pulldown",alias:"breakByList"}]},{scriptClass:"mstrmojo.threshold.ColorSlider",alias:"colorSlider"},{scriptClass:"mstrmojo.Label",cssClass:"link",alias:"showAdvancedEditorLink",slot:"buttonNode",text:mstrmojo.desc(4569,"Advanced Thresholds Editor..."),onclick:function e(){var h=this.parent,g=h.breakBy.breakByList,f=g.items[g.selectedIndex].did!==-1,j=function(){h.colorSlider.unselectAll();h.close();h.model.editorMode=mstrmojo.threshold.ThresholdModel.EDITOR_TYPES.ADVANCED_EDITOR;};mstrmojo.warn(f?mstrmojo.desc(14160,"Save thresholds definition before proceeding to the Advanced Thresholds Editor? The Break By attribute will be lost."):mstrmojo.desc(14159,"Save thresholds definition before proceeding to the Advanced Thresholds Editor?"),undefined,{cssClass:"save-threshold-warning",buttons:[W(mstrmojo.desc(2827,"Clear"),function(){j();h.controller.openEditor();},false,{cssClass:"nosave"}),W(mstrmojo.desc(2223,"Cancel")),W(mstrmojo.desc(2031,"Apply"),function(){j();g.set("selectedIndex",0);Y.call(h,true);},true)]});}},{scriptClass:"mstrmojo.Box",cssClass:"editor-buttons",slot:"buttonNode",children:[W(mstrmojo.desc(221,"Cancel"),function e(){var f=this.parent.parent;f.colorSlider.unselectAll();f.close();}),W(mstrmojo.desc(1442,"OK"),function e(){var f=this.parent.parent;Y.call(f);f.colorSlider.unselectAll();f.close();},true),W(mstrmojo.desc(2031,"Apply"),function e(){var f=this.parent.parent;Y.call(f,true);f.colorSlider.unselectAll();},true)]}]});}());(function(){mstrmojo.requiresCls("mstrmojo.array","mstrmojo.css","mstrmojo.Model","mstrmojo.Container","mstrmojo._HasSuggestion","mstrmojo._IsWebApp","mstrmojo.mstr.search.SearchSettings","mstrmojo.mstr.search.SearchResults");var J=mstrmojo.desc,C=mstrmojo.css,g=mstrmojo.array,q=mstrmojo.string;var f=[16,1,2,4,8],b=f,G=[1,2,4,8],e=[3,8,14081],W=-1;var I={suggest:function(w){return{success:function(AA){if(!mstrmojo.all.search){return ;}if(!w.hasSearchPattern){w.clear();w.hideSuggestion();return ;}w.sItems=AA.items||[];var z,x=w.sItems.length;for(z=0;z<x;z++){w.sItems[z].t=W;}if(x){w.selectedSuggestionIndex=null;}else{w.hideSuggestion();}var AB=AA.items&&AA.items[0]&&AA.items[0].n.toLowerCase();if(AB){w.suggestInputNode.value=AB.replace(new RegExp("^"+q.regEscape(w.searchPattern),"i"),w.inputNode.value);w.syncInputWithSuggest();}else{AB=w.searchPattern;}w.suggest=AB;if(w.last_searchPattern!==AB){w.last_searchPattern=AB;window.setTimeout(function(){w.requestResults();},0);}},failure:function(x){mstrmojo.alert(x.status+" : "+x.statusText);},complete:function(x){w.showSpinnerIcon(false);w.handleSearchErrorAndModeSwitching(x);}};},search:function(w){return{success:function(z){if(!mstrmojo.all.search){return ;}var x;for(x in w){this[x]=w[x];}if(!w.hasSearchPattern&&!w.allowEmptyInput){w.clear();w.hideSuggestion();return ;}if(!z){mstrmojo.xhr.abort();w.requestResults();return ;}w.rItems=z.items||[{t:0,dssid:"",n:mstrmojo.desc(9135,"No match found")}];if(w.showAsPopup){w.renderResultsPopup(w.rItems);}else{w.renderResults(z||{});}},failure:function(x){mstrmojo.alert(x.status+" : "+x.statusText);},complete:function(x){w.showSpinnerIcon(false);w.handleSearchErrorAndModeSwitching(x);}};}};var N=function(x){var w=mstrApp.adminInfo;return x.replace("#",(w&&w.length>0?" ("+w+")":""));};var v=function(){if(mstrmojo.dom.isDXIE||mstrmojo.dom.isSafari){var w=this.inputNode;window.setTimeout(function(){w.focus();},10);}};mstrmojo.mstr.search.Search=mstrmojo.declare(mstrmojo.Container,[mstrmojo._HasSuggestion,mstrmojo._IsWebApp],{scriptClass:"mstrmojo.mstr.search.Search",noCache:true,suggestionPopupCssClss:"mstrmojo-Search-suggestion",resultsOnly:false,allowEmptyInput:false,showAsPopup:true,allowHTMLOnObjectDesc:false,searchDelay:200,doAutoComplete:true,minSearchLength:1,supportIncFetch:true,searchTootipText:mstrmojo.desc(9168,"Type to search"),enableSuggestion:true,hasSearchPattern:false,searchProps:null,quickSearch:false,includeObjectDesc:true,blockBegin:1,blockCount:10,rootFolderType:39,rootFolderID:null,nameWildcards:16,recursive:1,objectType:[3,8,14081],fields:"name",dereferenceshortcut:"1",dateType:1,created:0,dateSubType:1,intervalUnit:1,intervalValue:1,startDate:"",endDate:"",ownerType:1,description:"",maxObjects:100,searchDomain:2,styleName:"MojoFolderStyle",clearVisible:false,spinnerVisible:false,markupString:'<div class="mstrmojo-Search {@cssClass}" style="{@cssText}"><div class="mstrmojo-Search-settings1"></div><div class="mstrmojo-Search-container"><div class="mstrmojo-Search-input" style="position: relative"  mstrAttach:mousedown><div class="mstrmojo-Search-search" style="position: relative"><input class="searchPattern" maxlength="100" autocomplete="off" {@autofocus}                                   placeholder="{@searchTootipText}"mstrAttach:mousedown,keyup,keydown,blur,paste,cut,input /><div class="SearchBox-tip" n="searchTip"></div></div><div class="mstrmojo-Search-suggest" style="background: none transparent;"><input class="suggestPattern" maxlength="100" autocomplete="off" disabled="disabled" data-act="suggest"/></div></div><div class="mstrmojo-Search-btns" mstrAttach:click><div class="mstrmojo-Search-btnClear" data-act="clear"></div><div class="mstrmojo-Search-btnSpinner" data-act="spinner"></div><div class="mstrmojo-Search-btnSearch" data-act="search"></div></div></div><div class="mstrmojo-Search-btnSettings" data-act="settings" mstrAttach:click>'+mstrmojo.desc(14521,"Refineseaaa")+'</div><div class="mstrmojo-Search-infoIcon" data-act="info"></div><div class="mstrmojo-Search-settings"></div><div class="mstrmojo-Search-result"></div></div>',markupSlots:{settings1ContainerNode:function(){return this.domNode.firstChild;},suggestInputNode:function(){return this.domNode.childNodes[1].firstChild.childNodes[1].firstChild;},inputNode:function(){return this.domNode.childNodes[1].firstChild.childNodes[0].firstChild;},searchTipNode:function(){return this.domNode.childNodes[1].firstChild.childNodes[1].childNodes[1];},btnsNode:function(){return this.domNode.childNodes[1].childNodes[1];},clearNode:function(){return this.domNode.childNodes[1].childNodes[1].childNodes[0];},spinnerNode:function(){return this.domNode.childNodes[1].childNodes[1].childNodes[1];},searchNode:function(){return this.domNode.childNodes[1].childNodes[1].childNodes[2];},settingsBtnNode:function(){return this.domNode.childNodes[2].childNodes[2];},infoIconNode:function(){return this.domNode.childNodes[3];},settingsContainerNode:function(){return this.domNode.childNodes[4];},resultsContainerNode:function(){return this.domNode.childNodes[5];}},markupMethods:{onclearVisibleChange:function(){C.toggleClass(this.btnsNode,"clear",this.clearVisible);},onspinnerVisibleChange:function(){C.toggleClass(this.btnsNode,"spinner",this.spinnerVisible);C.toggleClass(this.domNode,"searching",this.spinnerVisible);}},init:function p(x){var z=this;this.autofocus=mstrmojo.dom.isSafari?"":"autofocus";if(this._super){this._super(x);}if(this.resultsOnly){C.addWidgetCssClass(this,"resultsOnly");}this.updateQuickSearchEnabled();mstrmojo.hash.copy(x.searchProps,this);this.objectType=g.filter(this.objectType,function(AA){return g.find(z.allowedObjectTypesData,"t",parseInt(AA,10))>-1;});this.maxObjects=parseInt(this.maxSearchResults||this.blockCount,10);var w=new Date();this.endDate=mstrmojo.date.formatDateInfo({day:w.getDate(),month:parseInt(w.getMonth(),10)+1,year:w.getFullYear()},mstrmojo.locales.datetime.DATEOUTPUTFORMAT);this.nameWildcards=(this.pqse?16:1);if(this.rootFolderID){this.rootFolderType=0;}else{this.rootFolderType=(parseInt(this.rootFolderType,10)>=0?this.rootFolderType:39);}this.updateQuickSearchEnabled();},preBuildRendering:function A(){var w=this;this.addChildren([mstrmojo.mstr.search.SearchSettings.getLocationPulldown({rootFolderName:this.rootFolderName,rootFolderType:this.rootFolderType,slot:"settings1ContainerNode"}),mstrmojo.mstr.search.SearchSettings.getSearchTypePulldown({className:"searchType",qse:this.qse,slot:"settings1ContainerNode"}),{scriptClass:"mstrmojo.mstr.search.SearchSettings",alias:"settingsWidget",allowedObjectTypesData:this.allowedObjectTypesData,model:new mstrmojo.Model({settings:{rootFolderType:this.rootFolderType,rootFolderID:this.rootFolderID,nameWildcards:this.nameWildcards,objectType:this.objectType,dereferenceshortcut:this.dereferenceshortcut,dateType:this.dateType,created:this.created,dateSubType:this.dateSubType,intervalUnit:this.intervalUnit,intervalValue:this.intervalValue,startDate:this.startDate,endDate:this.endDate,ownerType:this.ownerType,description:this.description}}),onmodelChange:function(){mstrmojo.hash.copy(this.model.settings,w);w.blockBegin=1;w.hasSearchPattern=((w.value&&(w.value.length>0))||(w.description&&(w.description.length>0)));w.delayedRequestResults();},slot:"settingsContainerNode"}]);if(this._super){this._super();}},postBuildRendering:function U(){if(this._super){this._super();}this.showSearchInfoIcon();if(this.showInfoIcon){this.addChildren([{scriptClass:"mstrmojo.Label",cssDisplay:"inline-block",bindings:{visible:function(){return this.showInfoIcon||true;}},useRichTooltip:true,richTooltip:{posType:mstrmojo.tooltip.POS_BOTTOMLEFT,cssClass:"vi-regular vi-tooltip-V",contentNodeCssClass:"mstrmojo-Search-infoIcon-tip",keepArrowXPos:true,refNode:this.infoIconNode,content:N(mstrmojo.desc(9264))},slot:"infoIconNode"}]);this.renderChildren();}v.call(this);if(this.searchPattern){this.inputNode.value=this.searchPattern;}},getSearchPattern:function O(){if(this.inputNode){this.searchPattern=mstrmojo.string.trim(this.inputNode.value);}else{this.searchPattern=null;}return this.searchPattern;},getRootFolderName:function r(){var w={0:this.rootFolderName,7:J(2,"Shared Reports"),20:J(3,"My Reports"),39:mstrConfig.projectName};return w[this.rootFolderType||39];},getNotFoundMsg:function a(){var w=function(z){return"<b>"+mstrmojo.string.escape4HTMLText(z)+"</b>";};var x=J(9202,"Your search for ## in ### returned no results").replace("###",w(this.getRootFolderName())).replace("##",w(this.getSearchPattern()));return x;},onmousedown:function h(){v.call(this);},onkeyup:function o(x){var AC=this;var AD=x.e;this.value=x.getTarget().value;var z=this.value;var AB=AD.keyCode;if(AB==32&&/^\s/.test(z)){this.value=z.replace(/^\s+/,"");x.cancel();return false;}AC.hasSearchPattern=((this.value&&(this.value.length>0))||(this.description&&(this.description.length>0)));if(!AC.doAutoComplete){if(AC.hasSearchPattern){AC.showClearIcon();}AC.searchPattern=this.value;if(AD.keyCode!==13){return ;}}var w=function(AF,AG){if(AG.indexOf("?")>-1||AG.indexOf("*")>-1){return false;}var AE=false;try{if(typeof AF==="string"){AE=(new RegExp("^"+AG,"")).test(AF);}else{var AH;for(AH in AF){AE=(new RegExp("^"+AG,"i")).test(AF[AH].n);if(!AE){break;}}}}catch(AI){}return AE;};var AA=function(){var AE=this.suggestInputNode.style.visibility,AG=mstrmojo.dom.position(this.inputNode),AF=(this.inputNode.scrollWidth>(AG&&AG.w))?"hidden":"visible";if(AE!==AF){this.suggestInputNode.style.visibility=AF;}};AA.apply(AC);if(AB&&g.indexOf([8,13,27,37,38,39,40],AB)===-1&&w(AC.suggestInputNode.value,this.value)&&w(AC.sItems,this.value)){return ;}AC.processInput(x);AC.syncInputWithSuggest();this.set("clearVisible",this.getSearchPattern().length>0);},onkeydown:function Q(w){if(mstrmojo.dom.isIE){var x=w.e;if(x.keyCode===27){x.cancelBubble=true;return false;}}},onpaste:function u(w){var x=this;window.setTimeout(function(){x.onkeyup(w);},0);},onclick:function l(z){var w=z.hWin,AA=z.e||w.event,AB=AA.target||AA.srcElement,x=AB&&((AB.dataset&&AB.dataset.act)||AB.getAttribute("data-act"));switch(x){case"search":this.forceSearch();break;case"clear":this.clear();break;case"settings":this.settingsWidget.set("visible",!this.settingsWidget.visible);break;}},processInput:function j(w){var AA=w.e,z=AA.keyCode,x=this.inputNode.value;this.searchPattern=x;this.blockBegin=1;if(!this.doAutoComplete&&z!==13){return ;}if(z===13||x.length<this.minKeyLength){if(!this.hasSearchPattern){this.clear();}this.hideSuggestion();this.forceSearch();return ;}else{switch(z){case 38:case 40:if(this.updateSelectedIndex(z)){this.delayedRequestResults();}else{if(this.tmrRR){window.clearTimeout(this.tmrRR);}}break;case 13:case 27:this.hideSuggestion();this.cancel();break;case 37:break;case 39:if(this.suggestInputNode.value&&this.inputNode.value!==this.suggestInputNode.value){this.inputNode.value=this.suggestInputNode.value;this.suggestInputNode.value="";}break;default:if(!this.enableSuggestion){return ;}this.showSpinnerIcon(true);this.suggestInputNode.value="";this.delayedRequestSuggestion(x);}}},cancel:function E(){mstrmojo.xhr.cancel();},requestSuggestion:function t(){return this.showSuggestion(this.getSearchPattern());},delayedRequestSuggestion:function t(w){if(this.tmrRS){window.clearTimeout(this.tmrRS);}if(this.tmrRR){window.clearTimeout(this.tmrRR);}var x=this;this.tmrRS=window.setTimeout(function(){x.requestSuggestion(w);},this.searchDelay);},requestResults:function K(){if(!this.hasUserInput()){return ;}if(!this.searchPattern){this.searchPattern="";}var x=this;var z=function(AD){if(!x.isMiniSearchBox){return AD.toString();}var AE=[],AB=e,AC;for(AC in AB){if(g.find(AD,AB[AC])>-1){AE.push(AB[AC]);}}return AE.toString();};var w=function(){var AC="";if(x.isMiniSearchBox||x.dereferenceshortcut=="1"){return AC;}if(x.objectType.length===0||g.indexOf(x.objectType,18)===-1){return AC;}var AD=[],AB;for(AB=0;AB<x.allowedObjectTypesData.length;AB++){AD.push(x.allowedObjectTypesData[AB].t);}return AD.toString();};var AA={taskId:"searchMetadata",searchId:this.blockBegin>this.blockCount?this.searchId||"":"",quickSearch:this.qse,fields:this.fields,styleName:this.styleName,searchPattern:this.last_searchPattern||this.searchPattern,objectType:z(this.objectType),targetObjectType:w(),rootFolderType:this.rootFolderType,rootFolderID:(this.rootFolderType=="0"?this.rootFolderID:""),dereferenceshortcut:this.dereferenceshortcut,searchDomain:this.searchDomain,servletName:mstrApp&&mstrApp.name,supportOMD:this.supportOMD,maxObjects:this.maxObjects,blockCount:this.blockCount,blockBegin:this.blockBegin,nameWildcards:this.nameWildcards,recursive:this.recursive,sortKey:this.qse?-1:6,dateType:this.dateType,created:this.created,dateSubType:this.dateSubType,intervalUnit:this.intervalUnit,intervalValue:this.intervalValue,startDate:this.startDate,endDate:this.endDate,ownerType:this.ownerType,description:this.description,includeObjectDesc:false,includeAncestorInfo:true,includeHiddenAncestors:true,uses:this.uses||""};this.serverRequest(AA,I.search(this));this.showSpinnerIcon(true);},delayedRequestResults:function K(){if(this.tmrRR){window.clearTimeout(this.tmrRR);}var w=this;this.tmrRR=window.setTimeout(function(){w.requestResults();},this.searchDelay);},renderResults:function V(w){var x=this;if(!this.resultsWidget){this.addChildren([{scriptClass:"mstrmojo.mstr.search.SearchResults",alias:"resultsWidget",slot:"resultsContainerNode",maxSearchResults:this.maxSearchResults,allowHTMLOnObjectDesc:this.allowHTMLOnObjectDesc,onfetch:function(z){x.fetchPage(z);}}]);this.renderChildren();}this.resultsWidget.set("results",w);},renderResultsPopup:function V(x){var w=this.suggestionPopup.list.selectedIndex;this.set("suggestionItems",x.concat(this.sItems));this.suggestionPopup.list.set("selectedIndex",w);},hasUserInput:function P(){if(!this.inputNode){return false;}var w=this.hasSearchPattern;w=w||!q.isEmpty(this.description)||this.ownerType==2||(this.dateType!=1)&&((this.dateSubType==1)&&!q.isEmpty(this.intervalValue)||(this.dateSubType==2)&&!q.isEmpty(this.startDate));return w||this.allowEmptyInput;},forceSearch:function c(){if(!this.hasUserInput()){return ;}this.suggestInputNode.value="";this.hideSuggestion();this.last_searchPattern=null;this.currentPage=1;this.blockBegin=1;this.requestResults();},updateQuickSearchEnabled:function d(){this.qse=!!this.isQuickSearchEngineEnabled&&this.enableQuickSearchPref;this.pqse=this.qse;this.qse=this.qse&&(g.indexOf(b,parseInt(this.nameWildcards,10))>-1);this.doAutoComplete=this.qse&&this.enableSearchAutoComplete;this.searchDelay=Math.max(0,this.searchAutoCompleteDelay);},syncInputWithSuggest:function Y(){return ;},getSelectedIndex:function(){return this.suggestionPopup.list.selectedIndex;},getSelectedItem:function(){return this.suggestionPopup.list.selectedItem;},updateSelectedIndex:function X(w){try{if(!this.suggestionShown){return ;}if(w==38||w==40||w==13){switch(w){case 40:this.nextHighlight();break;case 38:this.preHighlight();break;case 13:this.hideSuggestion();this.selectedIndex=-1;return ;}var x=this.getSelectedItem()||{};var AA=false;if(x.t=="-1"){AA=this.applySuggestionItem(x);}else{AA=false;this.selectedIndex=this.getSelectedIndex()-((this.sItems&&this.sItems.length)||0);}return AA;}}catch(z){}},clear:function k(){this.showClearIcon(false);this.showSpinnerIcon(false);this.searchPattern="";this.last_searchPattern="";this.hasSearchPattern=false;this.inputNode.value="";this.suggestInputNode.value="";if(this.resultsWidget){this.resultsWidget.set("results",{});}this.hideSuggestion();v.call(this);},showSpinnerIcon:function L(w){this.set("spinnerVisible",w);},showClearIcon:function D(w){this.set("clearVisible",w);},getCandidatesThroughTaskCall:function R(z,w){z={taskId:"getSearchSuggestions",keyword:this.searchPattern};var x=I.suggest(this);w=mstrmojo.func.wrapMethods(x,w);this.serverRequest(z,w);},getSuggestionPos:function Z(){var w=mstrmojo.dom.position(this.inputNode,true);return{left:Math.round(w.x)+"px",top:Math.round(w.y+w.h)+"px",zIndex:102};},onSuggestionItemSelect:function n(w){if(this.applySuggestionItem(w)){this.delayedRequestResults();}},applySuggestionItem:function B(w){this.inputNode.value=w.n;this.suggestInputNode.value=this.inputNode.value;var x=false;if(this.last_searchPattern!=this.suggestInputNode.value){this.last_searchPattern=this.suggestInputNode.value;x=true;}this.selectedSuggestionIndex=this.getSelectedIndex();return x;},fetchPage:function F(w){var x=Math.max(w.v-1,0);this.blockBegin=x*this.blockCount+1;this.requestResults();},serverRequest:function H(w,x){mstrmojo.xhr.request("POST",mstrConfig.taskURL,x,w);},handleSearchErrorAndModeSwitching:function M(AD){if(!AD){return ;}var z=this;if(z.qse){var x=AD.getResponseHeader("X-MSTR-TaskErrorCode"),AC=AD.getResponseHeader("X-MSTR-TaskFailureMsg")||"";if(!x||x==-2147209051){return ;}var AA=-2147212073;var AB=-2147212154;if(x==AA||x==AB){z.isQuickSearchEngineEnabled=false;z.updateQuickSearchEnabled();z.nameWildcards={16:1,2:2,4:4,8:8}[z.nameWildcards];z.requestResults();this.showInfoIconOnce=true;}else{mstrmojo.alert(z.addAdminInfo(AC));}}else{var w=JSON.parse(AD.responseText).qsr;if(this.enableQuickSearch&&w){this.isQuickSearchEnabled=true;z.updateQuickSearchEnabled();z.nameWildcards={1:16,2:2,4:4,8:8}[z.nameWildcards];z.requestResults();}}},showSearchInfoIcon:function S(w){this.set("showInfoIcon",!this.qse||w);},destroy:function m(w){this._super(w);this.destroyChildren(true);}});mstrmojo.mstr.search.Search.zIndex=10;}());(function(){mstrmojo.requiresCls("mstrmojo.array","mstrmojo.expr","mstrmojo.css","mstrmojo.Button","mstrmojo.Label","mstrmojo.rw.ConditionWalk","mstrmojo.ui.Pulldown","mstrmojo.ui.Checkbox","mstrmojo.ui._IsIncFetchList","mstrmojo.ui.ColumnWalk","mstrmojo.mstr.DocElementDataHelper");var F=mstrmojo.expr.ET.MQ,B=mstrmojo.expr.ET.MC,H=mstrmojo.css,G=mstrmojo.desc(14387,"Evaluate this condition independent of other dataset level conditions");var D=function(Q,S){var P=Q.et,N=this.parent&&this.parent.docModel&&this.parent.docModel.datasets,M=Q.m&&mstrmojo.rw.ConditionWalk.isMdxDM(Q.m.did,N),R=((P===F||P===B)&&!this.inRelation&&!M)?"block":"none",O=(((S===1)||P!==F)&&!M)?1:0;H.toggleClass(this.toolNode,"unselectable",P===B);this.toolNode.style.display=R;this.level.set("selectedIndex",O);this.includeExist.set("visible",O===1&&(P===B||P===F));this.includeExist.set("checked",Q.idcsi===undefined?false:Q.idcsi);};mstrmojo.vi.ui.editors.fe.ConditionWalk=mstrmojo.declare(mstrmojo.rw.ConditionWalk,[mstrmojo.ui._IsIncFetchList],{scriptClass:"mstrmojo.vi.ui.editors.fe.ConditionWalk",markupString:'<div class="mstrmojo-rw-ConditionWalk" mstrAttach:click><div class="condition mstrmojo-ConditionNode"><div class="mstrmojo-cond-contents"></div></div><div class="walk"></div><div class="tools"></div><div class="apply"></div></div>',markupSlots:mstrmojo.hash.copy({toolNode:function(){return this.domNode.childNodes[2];}},mstrmojo.hash.copy(mstrmojo.rw.ConditionWalk.prototype.markupSlots)),layoutConfig:{h:{conditionNode:"auto",walkNode:"100%",toolNode:"auto",applyNode:"auto"},xt:true},children:[{scriptClass:"mstrmojo.ui.ColumnWalk",alias:"columnWalk",slot:"walkNode",height:"333px",width:"800px"},{alias:"cancelBtn",slot:"applyNode",scriptClass:"mstrmojo.Button",cssClass:"cancelBtn",title:mstrmojo.desc(2399,"Cancel"),ignoreLayout:true,onclick:function(){var M=this.parent;if(M.close){M.close();}}},{alias:"okBtn",slot:"applyNode",scriptClass:"mstrmojo.Button",cssClass:"okBtn",title:mstrmojo.desc(2397,"OK"),onclick:function(){var M=this.parent;if(M.onOK){M.onOK();}}},{scriptClass:"mstrmojo.Label",alias:"tip",slot:"applyNode",cssClass:"tip",text:"",ignoreLayout:true}],init:function K(M){this._super(M);this.attachEventListener("conditionWalkUpdateOkBtn",this.id,function(N){var P=N.valid,O=this.parent;O.toggleOkButtonStatus(P);});},postCreate:function I(){this.children=mstrmojo.hash.clone(this.children).concat([{scriptClass:"mstrmojo.Label",slot:"toolNode",text:mstrmojo.desc(13517,"Calculate on")},{scriptClass:"mstrmojo.ui.Pulldown",slot:"toolNode",alias:"level",isHostedWithin:false,items:[{n:mstrmojo.desc(13518,"Template level"),v:0},{n:mstrmojo.desc(13519,"Dataset level"),v:1}],onitemSelected:function M(N){var O=this.parent;if(O&&O.condition&&O.visible){O.includeExist.set("visible",N.v===1);O.condition.level=N.v;}}},{scriptClass:"mstrmojo.ui.Checkbox",alias:"includeExist",slot:"toolNode",postBuildRendering:function(){this.domNode.innerHTML=G;},oncheckedChange:function(){var N=this.parent;if(N){N.model.set("idcsi",this.checked);}}}]);if(this._super){this._super();}},onvisibleChange:function J(M){var N=this.condition;if(N&&this.toolNode&&this.visible){D.call(this,N.data,N.tree.level);}if(this._super){this._super(M);}},onmodeledit:function A(M){if(this._super){this._super(M);}if(this.toolNode){D.call(this,this.model.get(),this.model.level);}},getAttributeForms:function L(M){return mstrmojo.rw.ConditionWalk.getAttForms(M,this.editor.docModel.datasets);},getElements:function E(P,R){var Q={},N=R.complete,O=this;this.scrollNode=this.columnWalk.es.scrollNode;var M=this.scrollNode&&this.scrollNode.style;if(M){M.height="100%";}if(!this.ifDataHelper){this.ifDataHelper=new mstrmojo.mstr.DocElementDataHelper({source:this.editor.docModel.getDataService()});}else{this.ifDataHelper.set("items",null);}this.columnWalk.es.es.allowUnlistedValues=false;this.updateBrowseElementsParams(Q,P);this.ifDataHelper.browseConfig=Q;R=mstrmojo.func.wrapMethods(R,{complete:function(S){O.initScroll();}});this.ifDataHelper.getItems(1,R);},postNext:function C(){this.columnWalk.es.updateList(this.ifDataHelper.items);}});}());(function(){mstrmojo.requiresCls("mstrmojo.array","mstrmojo.rw.ConditionWalk","mstrmojo.Label","mstrmojo.ui.Pulldown","mstrmojo.ui.Checkbox","mstrmojo.expr","mstrmojo.css");var F=mstrmojo.expr.ET.MQ,H=mstrmojo.expr.ET.MC,C=mstrmojo.css,B=mstrmojo.desc(14387,"Evaluate this condition independent of other dataset level conditions");var G=function(L,N){var K=L.et,I=L.m&&mstrmojo.rw.ConditionWalk.isMdxDM(L.m.did),M=((K===F||K===H)&&!this.inRelation&&!I)?"block":"none",J=(((N===1)||K!==F)&&!I)?1:0;C.toggleClass(this.toolNode,"unselectable",K===H);this.toolNode.style.display=M;this.level.set("selectedIndex",J);this.includeExist.set("visible",J===1&&(K===H||K===F));this.includeExist.set("checked",L.idcsi===undefined?false:L.idcsi);};mstrmojo.fe.ConditionWalk=mstrmojo.declare(mstrmojo.rw.ConditionWalk,null,{scriptClass:"mstrmojo.fe.ConditionWalk",markupString:'<div class="mstrmojo-rw-ConditionWalk" mstrAttach:click><div class="condition mstrmojo-ConditionNode"><div class="mstrmojo-cond-contents"></div></div><div class="walk"></div><div class="tools"></div><div class="apply"></div></div>',markupSlots:mstrmojo.hash.copy({toolNode:function(){return this.domNode.childNodes[2];}},mstrmojo.hash.copy(mstrmojo.rw.ConditionWalk.prototype.markupSlots)),layoutConfig:{h:{conditionNode:"auto",walkNode:"100%",toolNode:"auto",applyNode:"auto"},xt:true},postCreate:function E(){this.children=mstrmojo.hash.clone(this.children).concat([{scriptClass:"mstrmojo.Label",slot:"toolNode",text:mstrmojo.desc(13517,"Calculate on")},{scriptClass:"mstrmojo.ui.Pulldown",slot:"toolNode",alias:"level",isHostedWithin:false,items:[{n:mstrmojo.desc(13518,"Template level"),v:0},{n:mstrmojo.desc(13519,"Dataset level"),v:1}],onitemSelected:function I(J){var K=this.parent;if(K&&K.condition&&K.visible){K.includeExist.set("visible",J.v===1);K.condition.level=J.v;}}},{scriptClass:"mstrmojo.ui.Checkbox",alias:"includeExist",slot:"toolNode",postBuildRendering:function(){this.domNode.innerHTML=B;},oncheckedChange:function(){var J=this.parent;if(J){J.model.set("idcsi",this.checked);}}}]);if(this._super){this._super();}},onvisibleChange:function A(I){var J=this.condition;if(J&&this.toolNode&&this.visible){G.call(this,J.data,J.tree.level);}if(this._super){this._super(I);}},onmodeledit:function D(I){if(this._super){this._super(I);}if(this.toolNode){G.call(this,this.model.get(),this.model.level);}}});}());(function(){mstrmojo.requiresCls("mstrmojo.rw.ConditionWalk","mstrmojo.array","mstrmojo.css","mstrmojo.expr","mstrmojo.mstr.EnumNodeDimty","mstrmojo.mstr.DocElementDataHelper","mstrmojo.ui._IsIncFetchList");var E=mstrmojo.array,G=mstrmojo.css,C=mstrmojo.mstr.EnumNodeDimty,K=E.hash([C.NodeDimtyUnspecified,C.NodeDimtyNone]);function H(){var L=this.thresholdRow,M=this.editor;if(L){this.removeChildren(L);}G.toggleClass(M.content.domNode,"no-overflow",false);this.set("visible",false);M.setRowPanelVisibility(true);}mstrmojo.threshold.ConditionWalk=mstrmojo.declare(mstrmojo.rw.ConditionWalk,[mstrmojo.ui._IsIncFetchList],{objectBrowsingEnabled:false,dimtyTypes:K,targets:null,targetsLastMod:null,ets:null,condition:null,onOK:function B(){var L=this.editor;L.model.setConditionData(this.condition,this.model.get());H.call(this);L.toggleButtonStatus(true);},close:function I(){var O=this.editor;var Q=this.condition,M=Q.tree.parent,L=M.exprTree;if(Q.isEmpty()){Q.del();}var N=L&&L.items,P=N&&N.length;if(!P||P===0){O.model.deleteThreshold(M.threshold);}H.call(this);O.toggleButtonStatus(true);},browse:function F(L){this._super(L);if(L.alias==="es"){G.toggleClass(this.eb.domNode,"adv-threshold",true);}},getAttributeForms:function J(L){return mstrmojo.rw.ConditionWalk.getAttForms(L,this.editor.controller.datasets);},getElements:function D(O,R){var Q={},M=R.complete,N=this;this.scrollNode=this.columnWalk.es.scrollNode;var L=this.scrollNode&&this.scrollNode.style;if(L){L.height="100%";}if(!this.ifDataHelper){this.ifDataHelper=new mstrmojo.mstr.DocElementDataHelper({source:this.editor.controller.dataService});}else{var P=this.ifDataHelper;P.set("items",null);P.set("blockBegin",1);P.set("blockCount",0);P.set("totalSize",0);P.browseConfig.attributeID=O.did;}this.columnWalk.es.es.allowUnlistedValues=false;this.updateBrowseElementsParams(Q,O);this.ifDataHelper.browseConfig=Q;R=mstrmojo.func.wrapMethods(R,{complete:function(S){N.initScroll();N.set("isFetching",false);}});this.ifDataHelper.getItems(1,R);},postNext:function A(){this.columnWalk.es.updateList(this.ifDataHelper.items);}});}());(function(){mstrmojo.requiresCls("mstrmojo.Widget","mstrmojo.mstr.ui.CreateMenu","mstrmojo.ui.menus._HasMenuPopup");var B=mstrmojo.dom;var C="mscld-create-menu";mstrmojo.mstr.ui.CreateButton=mstrmojo.declare(mstrmojo.Widget,[mstrmojo.ui.menus._HasMenuPopup],{scriptClass:"mstrmojo.mstr.ui.CreateButton",markupString:'<div id="mscld-create" class="mstrmojo-CreateButton mscld-create analysis" title="'+mstrmojo.desc(3291,"Create")+'" mstrAttach:click><span class="mstrMenuItemcreate"><span id="mscld-create-menu" class="mscld-create-menu">'+mstrmojo.desc(3291,"Create")+"</span></span></div>",markupSlots:{menuButtonNode:function(){return this.domNode;}},onclick:function(){var D=mstrmojo.all[C];if(!D){D=mstrmojo.insert({scriptClass:"mstrmojo.mstr.ui.CreateMenu",id:"mscld-create-menu",opener:this,alignMenuToRight:this.alignMenuToRight,reportCreationViewMode:this.reportCreationViewMode});}this.toggleButtonClass(true);D.loadCreateMenu();},toggleButtonClass:function(D){if(this.domNode.className.indexOf("open")>0){mstrmojo.css.toggleClass(this.domNode,"open",D);}else{mstrmojo.css.toggleClass(this.domNode,"open",D);}},init:function(E){this._super(E);if(!this._listenerProc){var F=this;var D=this._listenerProc=function(){F.browserResized();};B.attachEvent(window,"resize",D);}},browserResized:function(){if(this.timer){clearTimeout(this.timer);}var D=mstrmojo.all[C];if(D){this.timer=setTimeout(function(){D.createMenu.adjustCornersForPopupOverflow();},100);}},destroy:function A(D){if(this._listenerProc){B.detachEvent(window,"resize",this._listenerProc);}this._super(D);},onButtonClick:mstrmojo.emptyFn,onStatusClick:mstrmojo.emptyFn});}());(function(){mstrmojo.requiresCls("mstrmojo.hash","mstrmojo.css","mstrmojo.string","mstrmojo.dom","mstrmojo.boxmodel","mstrmojo.vi.models.EnumFieldTypes","mstrmojo.vi.ui.rw._IsLinkBox","mstrmojo.vi.ui.rw.RichTooltipBox","mstrmojo.vi.ui.rw.ImageBoxOverlay","mstrmojo.vi.ui.rw.ImageBoxOverlayURL","mstrmojo.vi.ui.rw.ImageBoxOverlayEmbeded");mstrmojo.requiresDescs(3415,10493,12277,12963,14634);var X=mstrmojo.css,B=mstrmojo.string,O=mstrmojo.hash,V=mstrmojo.boxmodel.px2Inches,G=mstrmojo.dom,H=mstrmojo.desc(14634,"Embedded_Image");function W(){if(this.boxContent&&B.isEmpty(this.boxContent.origV)){this.showControlOverlay(this.getEditOverlayControls());K.call(this,this.height,this.width);}else{this.hideControlOverlay();}}function K(Y,a){var b=this.ctrlOverlay;if(b&&b.imageBoxOverlay){var Z=b.imageBoxOverlay;Z.set("height",Y);Z.set("width",a);Z.doLayout();Z.hasChanged();}}mstrmojo.vi.ui.rw.ImageBox=mstrmojo.declare(mstrmojo.vi.ui.rw.RichTooltipBox,[mstrmojo.vi.ui.rw._IsLinkBox],{scriptClass:"mstrmojo.vi.ui.rw.ImageBox",ctrlOverlay:null,mode:"o",fw:100,fh:100,lock:true,isDynamicTooltip:true,tooltipTopOffset:35,isEmbedded:false,isEmbeddedImageFeatureEnabled:true,embeddedImageName:undefined,maskTooltip:mstrmojo.desc(15272,"Image cannot be selected as target"),init:function Q(b){this._super(b);var a=this.defn,Y=a&&a.fmts,Z=Y&&Y["img-name"];this.isEmbeddedImageFeatureEnabled=!!mstrApp.enableEmbeddedImages&&!G.isIE9;this.isEmbedded=!!a&&a.oid;this.embeddedImageName=(Z)?decodeURIComponent(Z):H;X.addWidgetCssClass(this,"mstrmojo-ImageBox");this.hostType=mstrmojo.vi.models.EnumFieldTypes.IMAGE;},getDisplayName:function I(){return this.defn.n||mstrmojo.desc(2922,"Image");},applyBoxSize:function P(Y,a,d,c){this._super(Y,a,d,c);var Z=parseInt(a,10)>=302?"h":"v";if(Z!==this.orientation){this.set("orientation",Z);}var b=this.boxContent;b.fw=this.fw;b.fh=this.fh;b.mode=this.mode;b.lock=this.lock;if(b.hasRendered){b.refresh();}K.call(this,Y,a);},getBoxDimension:function C(Y){return(Y==="h")?{f:false,l:null}:{f:true,l:40};},getAvatarCls:function L(){return this._super().concat(["imageAvatar"]);},createDeleteUpdate:function E(){return this.model.getRemoveFieldUpdate(this);},postBuildRendering:function S(){this._super();W.call(this);},updateOverlay:function N(){W.call(this);},showControlOverlay:function D(Y){this._super(Y);this.boxContent.set("visible",false);},hideControlOverlay:function U(){this._super();this.boxContent.set("visible",true);},urlEdited:function R(Y){this.boxContent.v=Y;this.isEmbedded=false;this.refresh();this.boxContent._isNewUrl=true;},localImageAdded:function M(Y){var Z=this.boxContent;Y.fieldKey=Z.k;Y.fieldName=Z.defn&&Z.defn.n||Z.k;Y.nodeKey=Z.defn.pnk;Y.sectionKey=Z.defn.pnk;Y.fieldGroupKey=Z.defn.fgk;var a=this;var b={success:function(c){a.boxContent.v=Y.base64Str;a.isEmbedded=true;a.refresh();a.boxContent._isNewEmbeddedImg=true;},complete:function(){mstrApp.hideWait();}};mstrApp.showWait({message:mstrmojo.desc(12963,"Uploading File...")});this.model.controller.uploadImageToServer(Y,b);},addFormatProps:function A(c,b){var a=this.boxContent,Y=this.model;c=this._super(c,b)||this.model.getUnitFormatAction(this,NaN,null,b);if(a&&!B.isEmpty(a.origV)){var Z=c.format=O.copy(c.format,{FormattingSize:{}});Z.FormattingSize.ImageWidth=V(Y.getZoomProps(),parseFloat(a.getImageWidth()));Z.FormattingSize.ImageHeight=V(Y.getZoomProps(),parseFloat(a.getImageHeight()));}return c;},getEditOverlayControls:function F(){return[{scriptClass:this.isEmbeddedImageFeatureEnabled?"mstrmojo.vi.ui.rw.ImageBoxOverlayEmbeded":"mstrmojo.vi.ui.rw.ImageBoxOverlayURL",alias:"imageBoxOverlay",imageBox:this,defn:this.defn}];},switchToEditMode:function J(){var a=this.ctrlOverlay;if(a.visible){a.imageBoxOverlay.imgURL.focus();return ;}this._super();K.call(this,this.height,this.width);var Z=this.boxContent.origV,Y=a.imageBoxOverlay.imgURL;if(this.isEmbedded){Y.set("value",this.embeddedImageName);a.imageBoxOverlay.origURLStr=this.embeddedImageName;}else{if(Z){Y.set("value",Z);a.imageBoxOverlay.origURLStr=Z;}}Y.focus();}});mstrmojo.vi.ui.rw.ImageBox.boxConfiguration={f:{h:166,v:76},minSize:{h:38,v:40},o:"v"};}());(function(){mstrmojo.requiresCls("mstrmojo.vi.ui.rw.RichTooltipBox","mstrmojo._FormatDefinition","mstrmojo.css","mstrmojo.Label","mstrmojo.ui.menus.EditorConfig","mstrmojo.vi.ui._CanDropFromSchema","mstrmojo.vi.ui.rw._IsLinkBox","mstrmojo.vi.models.EnumDragSources","mstrmojo.vi.models.EnumFieldTypes","mstrmojo.hash");var e=mstrmojo.css,X=mstrmojo.hash,K=mstrmojo._FormatDefinition,D=mstrmojo.string,f=mstrmojo.vi.models.EnumDragSources,Q=mstrmojo.array,L=mstrmojo.vi.models.EnumFieldTypes;function P(j){this.boxContent.update({defn:this.defn,data:{v:j}});}function J(j){var m=j&&j.src&&j.src.data,k=this.model.datasets,l;if(!m||(m.src!==f.DATASETS&&m.src!==f.ALL_OBJECT_LIST)){return[];}l=k&&k[m.dsid];return(m.items||[]).filter(function(n){return !!n.n;}).map(function(o){var n=true;X.forEach(k,function(p){if(p.did!==m.dsid&&p.mx&&p.mx.some(function(q){return q.n===o.n;})){n=false;}});return l&&!n?"{["+l.name+"]:["+o.n+"]}":"{["+o.n+"]}";});}function U(){return !this.boxContent||D.isEmpty(this.boxContent.getRawText());}function c(){if(U.call(this)){this.showControlOverlay(this.getEditOverlayControls());}else{this.hideControlOverlay();}}function E(l,k,j){if(k!==j){P.call(mstrmojo.all[l],j);}}mstrmojo.vi.ui.rw.TextBox=mstrmojo.declare(mstrmojo.vi.ui.rw.RichTooltipBox,[mstrmojo.vi.ui._CanDropFromSchema,mstrmojo.vi.ui.rw._IsLinkBox],{scriptClass:"mstrmojo.vi.ui.rw.TextBox",isDynamicTooltip:true,tooltipTopOffset:35,maskTooltip:mstrmojo.desc(15273,"Text box cannot be selected as target"),selected:false,init:function Y(j){this._super(j);e.addWidgetCssClass(this,"mstrmojo-VITextBox");this.hostType=L.TEXT;},getDisplayName:function M(){return this.defn.n||mstrmojo.desc(1013,"Text");},textEdited:function S(l,k,j){if(k){var m=this.id;this.model.editField(this,L.TEXT,{fail:function(){E(m,l,j);}},l,j,null);}},getFormats:function h(){var j=X.clone(this._super());if(j){delete j.fx;}return j;},dropFromAllObjectsHandler:function Z(m,l,j,k){if(l){var n=this.id;this.model.editField(this,L.TEXT,{fail:function(){E(n,m,j);}},m,j,{actions:k.actions,callback:k.callback});}},applyBoxSize:function W(j,m,o,n){this._super(j,m,o,n);var l=this.boxContent,k=l&&l.getFormats();if(k){k.height=j;k.width=m;if(l.isQuill&&l.isEditing){l.updatedirCachDel();l.savedCurPos=null;l.refresh();}}},createDeleteUpdate:function G(){return this.model.getRemoveFieldUpdate(this);},addFormatProps:function B(l,k){l=this._super(l,k)||this.model.getUnitFormatAction(this,NaN,null,k);var j=l.format=X.copy(l.format,{FormattingSize:{}});j.FormattingSize.HeightMode=0;return l;},getBoxDimension:function F(k){var l=this.boxContent,j=l&&l.getFormats();return(k==="h")?{f:false,l:null}:{f:true,l:parseInt(j.height||"40px",10)};},getAvatarCls:function R(){return this._super().concat(["textAvatar"]);},ondrop:function b(n){this._super(n);var AB=J.call(this,n),v=this.boxContent,z=v.quillInstance,AD=z&&z.editor;if(AB.length&&v.isQuill){var AA=v.dirCachDel,l=AD.delta,u=v.node.data&&v.node.data.rv,r="\u00df",w="\u01EF",x,k,p,o,m,j;if(!AA&&!u){x={};x.insert=AB.join(" ")+" ";l.ops.unshift(x);z.setContents(l);k="";p=AD.delta.ops;Q.forEach(p,function(AF){k+=AF.insert;k+=r;});o=v.utf8_to_b64(JSON.stringify(p));k+=w+o;m=v.utf8_to_b64(v.domNode.style.background);k+=w+m;j=(v.node.data.rv&&v.node.data.rv!==k);if(j===undefined){j=true;}if(j){v.dirCachDel=null;}this.textEdited(k,j,"");}else{var AE=v.node.data;var q=(AE.rv).split(w),AC=v.b64_to_utf8(q[1]);if(!Q.isArray(AC)){AC=JSON.parse(AC);}if(AC.ops){l=AC;}else{l.ops=AC;}z.setContents(l);v.cacheGProps=v.b64_to_utf8(q[2]);v.domNode.style.background=this.cacheGProps;x={};x.insert=AB.join(" ")+" ";l.ops.unshift(x);z.setContents(l);k="";p=AD.delta.ops;Q.forEach(p,function(AF){k+=AF.insert;k+=r;});o=v.utf8_to_b64(JSON.stringify(p));k+=w+o;m=v.utf8_to_b64(v.domNode.style.background);k+=w+m;j=(AE.rv&&AE.rv!==k);if(j===undefined){j=true;}if(j){v.dirCachDel=null;}this.textEdited(k,j,"");}}else{if(AB.length){var t=v.getRawText();if(t){AB.unshift(t);}if(n.getCtxtDragData().src===f.ALL_OBJECT_LIST){this.augmentDropContextForSchema(n,this.getDocModel());this.dropFromAllObjectsHandler(AB.join(" "),true,t,n);}else{this.textEdited(AB.join(" "),true,t);}}}},allowDropFromDataset:function g(){return mstrApp.allowWebDashboardDesign();},getEditOverlayControls:function H(){return[{scriptClass:"mstrmojo.Widget",markupString:'<div class="init-img"></div>'},{scriptClass:"mstrmojo.Label",cssClass:"init-label",text:mstrmojo.desc(13034,"Type directly or drag objects here.")}];},switchToEditMode:function N(){var k=mstrApp.isAppStatePresentation();if(k){return ;}var j=this.boxContent;if(this.ctrlOverlay.visible){this.hideControlOverlay();}if(!j.isEditing){var l=j.getRawText();if(l&&j.isQuill){j.set("text",l);j.setDelta(l);}else{if(l){j.set("text",l);}}}this.boxContent.set("isEditing",true);},updateToolbar:function I(q){q.menus=[];var k=this.id,t=K.DefaultFormat.FormattingNumber,o=this.model;var n=this.boxContent,m=n.quillInstance,l=n.isQuill,r=mstrApp.isAppStatePresentation(),u,p=n&&l&&m;if(p&&n.retSelLink(m.getSelection())){q.menus=[];var j=n.retSelLink(m.getSelection());if(!r){u=mstrmojo.desc(15703,"Edit Link...");q.addMenuItem(u,"",function(){n.editURLLink(q.position,j);});u=mstrmojo.desc(15701,"Remove Link");q.addMenuItem(u,"",function(){n.removeURLLink(j);});u=mstrmojo.desc(15704,"Go To...");q.addMenuItem(u,"",function(){window.open(j);});}return q;}if(p&&n.getSelectionLength()>0){if(this._super){q=this._super(q);}q.menus=[];if(!r){u=n.hasActiveLink()?mstrmojo.desc(15703,"Edit Link..."):mstrmojo.desc(15702,"Link...");q.addMenuItem(u,"lnk",function(){if(n&&n.openURLBox){n.openURLBox(q.position);}});}return q;}if(p&&m.getSelection&&m.getSelection()){if(this._super){q=this._super(q);}q.menus=[];if(!r){u=mstrmojo.desc(11501,"Insert An Image");q.addMenuItem(u,"lnk",function(){n.uploadImage();});}return q;}else{if(this.canShowDesignMenuItems()&&!r){q.addPopupMenuItem(mstrmojo.desc(13237,"Number Format"),k,function(){var z=this.defn.numFmts||{},w=z.cat,v={category:w===undefined?K.NumberFormatCategory.Automatic:w,decimalPlaces:z.dp||2,thousandSeparator:z.ts||parseInt(t.ThousandSeparator,10),currencySymbol:z.cs||t.CurrencySymbol,currencyPosition:z.cp||t.CurrencyPosition,format:z.nfs||"",negativeNumbers:z.nn||t.NegativeNumbers},x=X.clone(v);return new mstrmojo.ui.menus.EditorConfig({data:x,cssClass:"NumberFormat-MenuEditor",contents:[{scriptClass:"mstrmojo.vi.ui.NumberFormatter",formatValue:v,myData:x,oldData:X.clone(v)}],fnOk:function AA(AC){o.execute({execute:function AB(){var AF=o.getDataService().newUpdate(this),AE=mstrmojo.all[k];AF.addActions(Object.keys(t).map(function(AG){var AH={};AH[AG]=AC[AG.substr(0,1).toLowerCase()+AG.substr(1)];return o.getUnitFormatAction(AE,1,{FormattingNumber:AH});}));AF.addCallbacks({success:function AD(AG){o.partialUpdate(AG.data,o.getTargetDefn(AE.k),AG.defn,[AE.k]);o.selectVIUnit(k);}});AF.addExtras({style:{params:{treesToRender:3}}});AF.submit();}});}});});}}return this._super(q);},isDragValid:function C(j){return this._super(j)&&!this.boxContent.isEditing;},postBuildRendering:function a(){this._super();this.ctrlOverlay.domNode.onclick=function j(){this.switchToEditMode();}.bind(this);},postUpdateLayout:function A(){var j=this.isNewUnitContainer;this._super();if(j&&U.call(this)){this.switchToEditMode();}},toggleBoxSelection:function O(j){this._super(j);this.selected=!this.selected;},destroy:function d(k){var j=this.ctrlOverlay.domNode;if(j){delete j.onclick;}this._super(k);},shouldShowCustomizeContextMenu:function(){var j=this.boxContent;if(j.isQuill&&j.getSelectionLength()>=0){return true;}return !j.isEditing;},updateOverlay:function V(){c.call(this);}});mstrmojo.vi.ui.rw.TextBox.boxConfiguration={f:{h:150,v:42},minSize:{h:150,v:24},o:"v"};}());(function(){mstrmojo.requiresCls("mstrmojo.DocPanel","mstrmojo.vi.ui._IsDropTarget","mstrmojo.vi.models.EnumDragSources","mstrmojo.models.FormatModel","mstrmojo.vi.ui._CanDropFromSchema","mstrmojo.css","mstrmojo.hash","mstrmojo.array","mstrmojo.vi.ui.DatasetUnitMenuUtils");var a=mstrmojo.vi.models.EnumDragSources,f=mstrmojo.models.FormatModel,I=f.getFormatUpdate,U=f.ENUM_PROPERTY_NAMES,G=mstrmojo.vi.ui.DatasetUnitMenuUtils,N=mstrmojo.array,e=mstrmojo.css,W=mstrmojo.hash;function C(h){var g=this.width;h.forEach(function(m){var k=m.getLayoutOffsets&&m.getLayoutOffsets(),l=(k&&k.w)||0,j=g;if(l){j=parseInt(j,10)-l+"px";}if(m.setDimensions){m.setDimensions(m.height,j);}});}function J(){this._dividers.forEach(function(g){g.style.height=0;});}function A(){var g=this.containerNode;this._dividers.forEach(function(h){g.removeChild(h);});this._dividers=[];}function d(){var p=this._orderedSelectors=(this.getPanelChildren()||[]).filter(function(v){return !!v.togglePortlet;}).sort(function(w,v){var x=function(z){return(z&&z.selector&&z.selector.defn&&z.selector.defn.fmts&&z.selector.defn.fmts["z-index"])||0;};return(parseInt(x(w))>parseInt(x(v)))?1:-1;});this.set("empty",!p.length);A.call(this);var o=p.map(function(w){var v=w.selector;return{node:w.domNode,selector:v,fmts:v.defn.fmts};}),j=this.containerNode,n=this.model,m=this._dividers=[],q="z-index",l=[];while(j.lastChild){j.removeChild(j.lastChild);}o.forEach(function(x,v){if(parseInt(x.fmts[q],10)!==v){l.push(n.getUnitFormatAction(x.selector,1,I(U.Z_INDEX,v)));}x.fmts[q]=v;var w=document.createElement("div");w.className="fp-divider";j.appendChild(w);m.push(w);j.appendChild(x.node);});var t=this.emptyMsgBoxNode;if(t){j.appendChild(t);}if(l.length){var r=n.controller.cmdMgr,h=r.getInterimCmd(),u,k=mstrmojo.DocDataService.SUPPRESS_DATA;if(h){u={success:mstrmojo.emptyFn};h.submit(l,u,k,r.CMD_PHASE.LAST);}else{var g=n.getDataService();u={success:function(){var v=n.getDataService().stid||0,w=n.lastSavedStid||0;if(v-w===1){n.lastSavedStid=v;}}};g.submitUpdates(l,u,W.copy(k,{preserveUndo:true}));}}}function B(h){var g=h&&h.src;return g&&(g===a.DATASETS||g===a.VIZ_EDITOR||g===a.ALL_OBJECT_LIST);}function P(j){var p=j.tgtData,o=j.tgt.pos.y,h=p.map,l=h&&h.length;if(!h){var k=mstrmojo.dom.position(this.domNode).y;h=j.tgtData.map=(this._orderedSelectors||[]).map(function(q){var r=q.domNode;return k+r.offsetTop+Math.round(r.offsetHeight/2);});l=h&&h.length;}(p.map||[]).every(function(r,q){if(o<r){l=q;return false;}return true;});if(p.tgtIdx===l){return ;}p.tgtIdx=l;J.call(this);var n=this._dividers[l],g=j.src.data,m=(g&&g.dim&&g.dim.h)||null;if(n){n.style.height=(m||"48")+"px";}}function Q(h){var g=this.model;return h.did!=="-1"&&h.t!==14&&G.isValidAddToFP(g,h);}mstrmojo.vi.ui.rw.FilterPanel=mstrmojo.declare(mstrmojo.DocPanel,[mstrmojo.vi.ui._IsDropTarget,mstrmojo.vi.ui._CanDropFromSchema],{scriptClass:"mstrmojo.vi.ui.rw.FilterPanel",markupMethods:{onvisibleChange:mstrmojo.Widget.visibleMarkupMethod,onwidthChange:function(){C.call(this,this.children||[]);},onemptyChange:function(){var g=this.empty;e.toggleClass(this.emptyMsgBoxNode,"hide",!g);e.toggleClass(this.containerNode,"fp-empty-center",g&&mstrApp.isAppStatePresentation());}},width:null,model:null,subPanelCssText:"background-color: transparent; background: transparent;",empty:true,init:function X(g){this._super(g);e.addWidgetCssClass(this,"mstrmojo-VIFilterPanel");this._dividers=[];this.attachEventListener("childrenRendered",this.id,d);},postBuildRendering:function b(){var g=this.containerNode;if(g&&!this.emptyMsgBoxNode){var j=document.createElement("div");var h=mstrApp.isAppStatePresentation();j.className="fp-empty-msgbox";j.innerHTML=h?mstrmojo.desc(16185,"There are no filters in this chapter."):mstrmojo.desc(13258,"Drag objects here.");j.style.textAlign=h?"center":"left";g.appendChild(j);this.addSlots({emptyMsgBoxNode:j});}return this._super();},isEmpty:function S(){return this.empty;},updateForPU:function Z(g){var j=g.defn&&g.defn.ck;this.node.data.objects=this.node.data.objects.filter(function(k){if(j&&j[k.k]){return true;}return false;});if(g.data&&g.data.objects){var h=this.node.data.objects;N.forEach(g.data.objects,function(k){if((j&&j[k.k]||k.sc)&&N.find(h,"k",k.k)<0){h.push(k);}});}this.update(g);},refresh:function D(j,h){var g=this.domNode.clientWidth-2*2;this.contentWidth=(g>0)?g:0;this._super(j,h);},refreshFP:function H(){d.call(this);},unrender:function Y(g){A.call(this);this._super(g);},addChildren:function M(j,g,h){var k=this.parent;if(j&&j.constructor!==Array){j=[j];}C.call(this,j);this._super(j,g,h);if(!j||!j.length){d.call(this);}if(k&&k.scrollNode){k.updateScrollbars();}},toggleFilters:function L(l){var o=this,m=o.model,n=l?1:0,g=mstrmojo.DocDataService,q=g.EMPTY_CALLBACK,j=g.SUPPRESS_DATA,k=l,h=function(){o.raiseEvent({name:"filterPanelUpdated"});};var p=function(){k=!k;(o.children||[]).forEach(function(r){if(!r.isVisFilter()){r.set("_onCollapseAll",true);r.togglePortlet(k);r.set("_onCollapseAll",false);}});h();};m.execute({execute:function(){var r=m.getDataService().newUpdate(this);(o.children||[]).forEach(function(t){if(!t.isVisFilter()&&t.togglePortlet){t.set("_onCollapseAll",true);t.togglePortlet(l);t.set("_onCollapseAll",false);r.addActions(m.getUnitFormatAction(t.selector,1,{FormattingView:{WindowState:n}}));}});r.addCallbacks({success:function(){if(!l){var t;(o.children||[]).forEach(function(u){if(!u.isVisFilter()){t=u.selector;if(t&&t.expandOrEditToFetchElements){t.expandOrEditToFetchElements();}}});}h();}});r.addExtras(g.REQUEST_ONLY_DEFINITION);r.submit();},urInfo:{undo:function(){p();},redo:function(){p();},callback:q,extras:j}});},getContextDragData:function(g){var h=this._super(g);if(h.src===a.ALL_OBJECT_LIST){this.augmentDropContextForSchema(g,this.model);g.preInfo={actions:g.actions,callback:g.callback};}return h;},allowDrop:function E(g){var k=this.getContextDragData(g);if(k){var j=k.src;if(B(k)){var h=this;return k.items.some(function(l){return Q.call(h,l);});}if(j===a.FILTERS){return true;}}return false;},ondragenter:function O(g){this._super(g);g.tgtData={tgtIdx:999};P.call(this,g);},ondragover:function V(g){P.call(this,g);},ondrop:function c(h){var k=h.tgtData;if(!k){return this._super(h);}var n=h.src&&h.src.data,j=n&&n.src,r=this.model,u=this,q=function(){return k.tgtIdx;};if(B(n)){var o=[];n.items.forEach(function(v){if(Q.call(u,v)){o.push(v);}});var g=function(v){r.addFilterStackSelectors(v,q(),{preInfo:h.preInfo,postInfo:h.postInfo});};if(j===a.ALL_OBJECT_LIST){var p=h.src.widget,m=p&&p.dataProvider;if(m){m.loadObjects(o,{success:function(v){g((v&&v.objects)||o);}},true,true);}}else{g(o);}}else{if(j===a.FILTERS){var t=parseInt(n.idx,10),l=q();if(t<l){l--;}if(t!==l){r.pivotFilterStackSelector(this._orderedSelectors[t].selector,t,l);}}}this._super(h);},getDropAvatarIcon:function R(h){var k=h.src.data,j=k&&k.src,g="unselectable";if(B(k)){g="add";}else{if(j===a.FILTERS){g="move";}}return g;},cleanUpAfterTarget:function K(g){J.call(this);this._super(g);},clearAllFilter:function F(){(this.children||[]).forEach(function(g){if(g.clearFilters){g.clearFilters();}});}});}());(function(){mstrmojo.requiresCls("mstrmojo.Widget","mstrmojo.hash","mstrmojo.Container","mstrmojo.threshold.TextGroup","mstrmojo.threshold.ThresholdRow","mstrmojo.ui.editors.controls.ContainerGroup","mstrmojo.ui.editors.controls.CharacterGroup");var G=mstrmojo.Widget,F=mstrmojo.hash,D="180px";mstrmojo.threshold.PropertyPanel=mstrmojo.declare(mstrmojo.Container,[mstrmojo.threshold.PropertyPanel],{markupString:'<div class="mstrmojo-threshold-PropertyPanel"><div class="condition"></div><div class="format mstrmojo-vi-PropEditor"><div class="text"><div class="title">'+mstrmojo.desc(5998,"Replace Data")+'</div></div><div class="font mstrmojo-vi-EditorGroup"><div class="title">'+mstrmojo.desc(3433,"Font")+'</div></div><div class="border"><div class="title">'+mstrmojo.desc(5616,"Color And Borders")+'</div></div></div><div class="apply"></div></div>',markupSlots:{conditionNode:function(){return this.domNode.firstChild;},textNode:function(){return this.domNode.children[1].firstChild;},fontNode:function(){return this.domNode.children[1].children[1];},borderNode:function(){return this.domNode.children[1].children[2];},applyNode:function(){return this.domNode.lastChild;}},markupMethods:{onvisibleChange:G.visibleMarkupMethod,onheightChange:G.heightMarkupMethod,onwidthChange:G.widthMarkupMethod},model:undefined,editor:undefined,textGroup:undefined,charGroup:undefined,containerGroup:undefined,onvisibleChange:function A(){if(this.visible){var J=this.model;J.updateControl(this);var H=F.clone(J.threshold),I=this.thresholdRow;if(I){this.removeChildren(I);}this.addChildren({scriptClass:"mstrmojo.threshold.ThresholdRow",alias:"thresholdRow",slot:"conditionNode",idx:J.thresholdRow.idx,model:this.editor.model,threshold:H,onclick:mstrmojo.emptyFn});this.refresh();}},onOK:function B(){this.model.submitChange();this.close();},close:function E(){var H=this.thresholdRow;if(H){this.removeChildren(H);}this.set("visible",false);this.editor.toggleButtonStatus(true);this.editor.setRowPanelVisibility(true);},children:[{scriptClass:"mstrmojo.threshold.TextGroup",slot:"textNode",alias:"textGroup",width:D,onGroupValueChange:function C(H,I){this.parent.model.changeFormatProperty("threshold",H,I);}},{scriptClass:"mstrmojo.ui.editors.controls.CharacterGroup",slot:"fontNode",alias:"charGroup",width:D,onGroupValueChange:function C(H,I){this.parent.model.changeFormatProperty("fmt",H,I);}},{scriptClass:"mstrmojo.ui.editors.controls.ContainerGroup",slot:"borderNode",alias:"containerGroup",width:D,onGroupValueChange:function C(H,I){this.parent.model.changeFormatProperty("fmt",H,I);}},{alias:"cancelBtn",slot:"applyNode",scriptClass:"mstrmojo.Button",cssClass:"cancelBtn",onclick:function(){var H=this.parent;if(H.close){H.close();}}},{alias:"okBtn",slot:"applyNode",scriptClass:"mstrmojo.Button",cssClass:"okBtn",onclick:function(){var H=this.parent;if(H.onOK){H.onOK();}}},{scriptClass:"mstrmojo.Label",alias:"tip",slot:"applyNode",cssClass:"tip",text:mstrmojo.desc(14000,"Press ## after finishing formatting.").replace("##",'"√"')}]});}());(function(){mstrmojo.requiresCls("mstrmojo.ui.menus.MenuConfig","mstrmojo.ui.menus.EditorConfig","mstrmojo.Box","mstrmojo.Label","mstrmojo.ui.CheckList","mstrmojo.vi.ui.DatasetUnitMenuUtils","mstrmojo.models.datasets.DataInterface","mstrmojo.expr","mstrmojo.array","mstrmojo.VisUtility");mstrmojo.requiresDescs(2031,3945,3946,11505,11571,13629,13630,13860,14595,15952);var K=mstrmojo.vi.ui.DatasetUnitMenuUtils,F=mstrmojo.models.datasets.DataInterface,Q=mstrmojo.expr.DTP,L=mstrmojo.array,D=mstrmojo.VisUtility;function R(c){var a=350,V={fontFamily:"Arial",fontSize:"12px"},Z=D.measureTextWidth(c,V);if(Z>a){var Y,W,X=c.indexOf(" "),b=X;while(X>-1){Y=c.substring(0,X);W=D.measureTextWidth(Y,V);if(W>=a){break;}b=X;X=c.indexOf(" ",X+1);}if(X>-1){c=c.substring(0,b)+"\n"+c.substring(b);}}return c;}function E(a){var Y,V=a.selector,X=a.fn(),c=X.keys,W=X.items,b=new mstrmojo.ui.CheckList({cssClass:"units",items:W.map(function(d){d.css=K.getUnitCssClass(d.src||{});return d;}),onchange:function(){if(Y){Y.set("okEnabled",true);}}}),Z=R(a.title);b.setSelectedItems(W.filter(function(d){return c.indexOf(d.id)>-1;}));Y=new mstrmojo.ui.menus.EditorConfig({contents:new mstrmojo.Box({cssClass:"mstrmojo-vi-FilterBox-content",children:[{scriptClass:"mstrmojo.Label",text:Z},b]}),okEnabled:false,data:{},onOpen:function(){b.updateScrollbars();},cssClass:"mstrmojo-vi-FilterBox-targets",okBtnText:mstrmojo.desc(2031,"Apply"),fnOk:function(){V.model.changeFilterTargets(V,c,b.getSelectedItems().map(function(d){return d.id;}),V.isInFilterPanel());}});return Y;}function J(V,W){return function(X,Y){var Z=X!==Y;if(Z){V.set(W,X);}return Z;};}mstrmojo.vi.ui.rw.selectors._HasFilterContextMenu=mstrmojo.provide("mstrmojo.vi.ui.rw.selectors._HasFilterContextMenu",{_mixinName:"mstrmojo.vi.ui.rw.selectors._HasFilterContextMenu",addModeMenuItems:function M(W,V,X){if(!V.supportsInclude()){return false;}var Y=function(b,Z){var a=V.include===Z;W.addMenuItem(b,a?"on":"",function(){if(!a){V.set("include",Z);this.generateToolbar();if(X){X();}}return !a;}.bind(this));}.bind(this);Y(mstrmojo.desc(3945,"Include"),true);Y(mstrmojo.desc(3946,"Exclude"),false);W.hasToggleItem=true;W.addSeparator();return true;},addShowAllMenuItem:function N(W,V){if(!V.supportsShowAllToggle()||V.isAttrQualSelector()||V.isRecursiveAttributeSelector()||V.isSearchBox()||mstrApp.isAppStatePresentation&&mstrApp.isAppStatePresentation()){return false;}var Y=mstrmojo.desc(4741,"Show option for all");if(!V.include){W.addNonInteractiveMenuItem(Y,"",true);return true;}var X=function(){var b=!V.defn.showall,Z=V.model,a=Z.getSelectorPropsChangeAction(V,{showAll:b}),c=a.concat(Z.getCtrlActionsByStyleForToggleShowAll(V,b));Z.submitToggleShowAllActions(V,c);};W.addToggleMenuItem(Y,"",X,X,this.id,V.defn.showall);return true;},addClearFilterMenuItem:function H(W,V,X){W.addMenuItem(mstrmojo.desc(14595,"Unset Filter"),"",function(){V.clearSelector(true);if(X){X();}});return true;},addMenuItemIfSelectTargetsValid:function U(W,V,X){if(!mstrApp.isAppStatePresentation()){var Y=this.getTargetInfo();if(Y.items.length){W.addEditorMenuItem(mstrmojo.desc(13629,"Select Targets"),this.id,E,{selector:V,fn:this.getTargetInfo.bind(this),title:X});}}},addFilterStyleMenuItem:function C(W,V){if(mstrApp.isAppStatePresentation()||V.isSolrSelector()){return false;}var X=V.getSelectorStyleList();if(!X.length){return false;}W.addSubMenuItem(mstrmojo.desc(11505,"Display Style"),"",this.id,function(){var Z=V.defn.style,Y=function(b){return function(){if(b!==Z){var c=mstrmojo.DocSelector.STYLES.ATTR_QUAL;if(b===c||Z===c){V.model.openSelWarnFlag(V.k);}V.model.changeFilterStyle(V,b);}};};var a=new mstrmojo.ui.menus.MenuConfig();if(V.isDynamicAttributeSelector()&&V.expr){a.useTooltip=true;X.forEach(function(c){var b=c.n;if(Z!==c.v){b=typeof b==="object"?b.n:b;a.addDisabledMenuItem({n:b,ttp:mstrmojo.desc(15952,"Please unset filter selections before switching to the # display style").replace("#",b)});}else{a.addMenuItem(b,"on",mstrmojo.emptyFn);}});}else{X.forEach(function(b){var c=b.v;a.addMenuItem(b.n,Z===c?"on":"",Y(c));},this);}a.hasToggleItem=true;return a;});return true;},addMultiSelectMenuItem:function I(W,V){if(!V.allowsTogglingMultiSelect()||mstrApp.isAppStatePresentation()){return false;}W.addMenuItem(mstrmojo.desc(13860,"Allow Multiple Selections"),V.multi?"on":"",function(){V.model.changeFilterStyle(V,V.style,!V.multi,V.iase);});W.hasToggleItem=true;return true;},addAutoSearchMenuItem:function G(W,V){if(!V.allowsTogglingAutoSearch()||mstrApp.isAppStatePresentation()){return false;}W.addMenuItem(mstrmojo.desc(15913,"Allow Instant Search"),V.iase?"on":"",function(){V.model.changeFilterStyle(V,V.style,V.multi,!V.iase);});W.hasToggleItem=true;return true;},addConfigVisSelectorMenu:function B(W,V){var X=this;W.addMenuItem(mstrmojo.desc(3224,"Edit..."),"",function(){X.closeVisSelectorPanel();var Z=V.model,Y=V.k;Z.checkLargeItemsForVisFilter(Y,function(){var a=Z.addVisFilterContainer(),c=Z.getSelectedViUnit(),b;Z.oldSelectedVizBoxId=c.id;mstrApp.isInVFConfigMode=true;mstrApp.restoreVFKey=Y;b=Z.insertVizBox(Y,a,{});Z.controller.rootCtrl.initPanelStautsInConfigMode();Z.selectVIUnit(b.id,true,{isAddAction:true});mstrApp.getRootController().enterVizFilterConfigMode(V.parent.baseTitle,true);});});},addQualMenuItems:function O(W,V){if(V.isSolrSelector()||!V.isMetricSelector()||V.isRankMetricSelector()||!V.isNumericMetricSelector()){return false;}W.addRadioMenuGroup(V.qua>0?1:0,J(V,"qua"),[{value:0,text:mstrmojo.desc(11571,"Qualify on Value")},{value:1,text:mstrmojo.desc(13630,"Qualify on Rank")}],"",undefined,true);W.addSeparator();return true;},addSetDisplayFormsMenuItem:function A(b,Y){var W=Y.node.data.dt;if(!Y.isAttributeSelector()&&!Y.isNewDerivedRecursiveElementSelector()||(Y.isAttrQualSelector()&&(W===Q.DATE||W===Q.TIMESTAMP))){return false;}var Z=Y.model,c=Y.defn,X=[],g=K.getUnitFromDataset(Z.datasets,c.srcid,c.srct),e=g&&g.attId,V=F.getFormsByAttrId(e||c.srcid,Z.datasets);if(Y.isRecursiveAttributeSelector()){V=L.filter(V,function(h){return h.fid!=="A9BFF03B4D72CC4F457ACBB4B185E91D"&&h.fnm!=="LEVEL_NUMBER";});}if(V.length<2){return false;}var d=c.fs;if(!d){var a=[],f=Z.getDatasetUnits(["att","mx"],function(h){return h.did===(e||c.srcid);})[0]||{};(f.fs||[]).forEach(function(h){if(h.isbf){a.push({did:h.fid});}});if(a.length){d=a;}}V=L.map(V,function(j,h){var k=j.fid;if(L.find(d,"did",k)!==-1){X[h]=true;}return{id:k,n:j.fnm};});if(mstrmojo.resolveFeature("set-attributeform-display")&&!mstrApp.isAppStatePresentation()){b.addPopupMenuItem(mstrmojo.desc(11908,"Display Attribute Forms"),this.id,function(){return new mstrmojo.ui.menus.EditorConfig({cssClass:"displayForms",data:{defn:c,oldSelectedIndices:X.slice()},contents:[{alias:"formCheckList",scriptClass:"mstrmojo.ui.CheckList",minimumSelectCnt:1,items:V,selectedIndices:X.slice()}],fnOk:function j(o,t){var m=[],q=t.formCheckList,u=q.items,k=q.selectedIndices,n=false,p;for(p=0;p<u.length;p++){var l=!!o.oldSelectedIndices[p],r=!!k[p];if(l!==r){n=true;break;}}if(!n){return ;}L.forEach(k,function(v,w){if(v){m.push(u[w]);}});Z.setFilterDisplayForms(Y,m);},onOpen:function h(){this.formCheckList.updateScrollbars();}});});}},addReplaceWithMenuItem:function S(W,V){var X=V.getSelectorReplaceUnitList();if(X.length===0){return false;}W.addEditorMenuItem(mstrmojo.desc(14003,"Replace with"),"",function(){return new mstrmojo.ui.menus.EditorConfig({data:{},cssClass:"replaceReference",okVisible:false,cancelVisible:false,contents:[{scriptClass:"mstrmojo.ui.ScrollableContainer",children:[{scriptClass:"mstrmojo.vi.ui.InteractiveUnitList",draggable:false,CLS_HAS_MENU:"",items:V.getSelectorReplaceUnitList(),listHooks:{select:function Y(Z,a){if(V.isInFilterPanel()){V.model.replaceFilterStackSelectors(V.defn,a);}else{V.model.replaceFilter(V,a);}}}}]}]});});return true;},getTargetInfo:function P(){this.throwAbstractMethodError("getTargetInfo");}});}());(function(){mstrmojo.requiresCls("mstrmojo.hash","mstrmojo.VisUtility","mstrmojo.vi.enums.EnumThemeProperties","mstrmojo.models.FormatModel","mstrmojo.chart.enums.EnumFontStyle");var B=mstrmojo.VisUtility,F=mstrmojo.hash,D=mstrmojo.models.FormatModel,C=D.ENUM_PROPERTY_NAMES,G=mstrmojo.chart.enums.EnumFontStyle,A=mstrmojo.vi.enums.EnumThemeProperties;mstrmojo.heatmap.vi.VisHeatmapUtility=mstrmojo.provide("mstrmojo.heatmap.vi.VisHeatmapUtility",{fontStyleValueMap:{bold:G.FS_BOLD,italic:G.FS_ITALIC,underline:G.FS_UNDERLINE,strikeout:G.FS_STRIKETHROUGH},setStepperEnabled:function(H,L,J){var K=["min","max"],I=["gt","lt"];K.forEach(function(O,M){var N=L.every(function(Q){var P=I[M],R=B.getPropertyByPath(J,[Q,O].join("."),P);return R===P;});H.getControl(M+1).set("enabled",N);});},getStepper:function(K,H){var J=new mstrmojo.Button(mstrmojo.Button.newIconButton(mstrmojo.desc(13608,"Decrease Font Size"),"single-operator minus",function(){K(-1);},undefined,{slot:"col1Node"})),I=new mstrmojo.Button(mstrmojo.Button.newIconButton(mstrmojo.desc(13607,"Increase Font Size"),"single-operator plus",function(){K(1);},undefined,{slot:"col2Node"}));H=F.copy(H,{col1Width:"50%",col2Width:"50%",dividerWidth:"10px",children:[J,I]});return new mstrmojo.ui.editors.controls.TwoColumnContainer(H);},isInvalidTemplate:function E(I){var H=I&&I.gts,J=H&&H.row;return(!(J&&J.length>0)||!B.hasOnlyMetricsOnColumn(I)||!B.hasNoMetricOnRow(I));},getInvalidTemplateErrMsg:function(H){return H||mstrmojo.desc(13685,"The Heat Map requires at least one attribute on the row axis to render properly; it is recommended that two metrics be placed on the column axis as well");},isSpatial:function(){return mstrApp.getThemeProps&&mstrApp.getThemeProps(A.SUBTYPE.HEATMAP).smallGap===A.DEFAULT_THEME_PROPS.HEATMAP.smallGap||false;},convertFontStyle:function(I,H){if((I&G.FS_BOLD)>0){H[C.FONT_WEIGHT]="bold";}if((I&G.FS_ITALIC)>0){H[C.FONT_STYLE]="italic";}if((I&G.FS_UNDERLINE)>0){H[C.UNDERLINE]="underline";}if((I&G.FS_STRIKETHROUGH)>0){H[C.LINE_THROUGH]="line-through";}},processFontStyle:function(H,I){H.fontWeight=(I&G.FS_BOLD?"bold":"normal");H.fontStyle=(I&G.FS_ITALIC?"italic":"normal");if((I&G.FS_STRIKETHROUGH)&&(I&G.FS_UNDERLINE)){H.textDecoration="line-through underline";}else{if(I&G.FS_STRIKETHROUGH){H.textDecoration="line-through";}else{if(I&G.FS_UNDERLINE){H.textDecoration="underline";}else{H.textDecoration="none";}}}},getFontStyleItems:function(){return[{n:mstrmojo.desc(2718,"Bold"),id:"b",css:"bold"},{n:mstrmojo.desc(2719,"Italic"),id:"i",css:"italic"},{n:mstrmojo.desc(2720,"Underline"),id:"u",css:"underline"},{n:mstrmojo.desc(3062,"Strikeout"),id:"s",css:"strikeout"}];},updateFontStyle:function(J,H){var I=[],K=function(N,O,L){var M=H[N];if(M){I.push(L);}};K(C.FONT_WEIGHT,"bold",0);K(C.FONT_STYLE,"italic",1);K(C.UNDERLINE,"underline",2);K(C.LINE_THROUGH,"line-through",3);J.select(I);},});}());(function(){mstrmojo.requiresCls("mstrmojo.Box","mstrmojo.dom","mstrmojo.css","mstrmojo.string","mstrmojo.VisUtility");var M=mstrmojo.css,I=mstrmojo.VisUtility,L=mstrmojo.array,N=mstrmojo.string,F="vis-tooltip",E=20,C=165,D="px";function Q(){var U=this.domNode;U.innerHTML="";var R=document.createElement("div");R.className=F+"-container";var V=document.createElement("table");V.className=F+"-table";for(var S=0;S<2;S++){V.appendChild(document.createElement("COL"));}R.appendChild(V);this.domNode.appendChild(R);return V;}function K(S){var R=[],U=false;L.forEach(S,function(V){if(!V.isSuper){R.push(V.v);}else{U=true;R.push("<sup>"+V.v+"</sup>");}});return{hasSuper:U,htmlText:R.join("")};}mstrmojo.VisTooltip=mstrmojo.declare(mstrmojo.Box,null,{scriptClass:"mstrmojo.VisTooltip",init:function P(R){this._super(R);M.addWidgetCssClass(this,(R&&R.widgetClass)?[R.widgetClass,F]:F);},toggle:function H(R){var S=mstrApp.isAppStatePrintPreview&&mstrApp.isAppStatePrintPreview();if(this.domNode){this.domNode.style.display=R&&!S?"block":"none";}},displayInfo:function O(X,a,R,S){var V=this.domNode,c=Q.call(this),Y=false,U=0,Z=0,b=c.childNodes[0],W=c.childNodes[1];X.forEach(function(l){var u,j,w,p,d,h,r,n,x,m,v,t,o=false,k=false;var e=c.insertRow(-1),g=e.insertCell(-1),q=e.insertCell(-1);e.className=F+"-tr";g.className=F+"-name "+F+"-td";q.className=F+"-value "+F+"-td";if(l===null){M.addClass(e,"separator");Y=true;}else{if(Y){M.addClass(e,"below-separator");}u=l.n;t=!l.skipEncode;g.innerHTML=t?N.encodeHtmlString(u,true):u;w=I.getComputedFontStyle(g);if(S){p=Math.ceil(I.measureTextWidthWithSpan(g.innerHTML,w,w.bonus,null,true,true));}else{p=Math.ceil(I.measureTextWidth(g.innerHTML,w,w.bonus));}r=3;if(p>C){n=I.truncateTextToLineWithWordWrap(u,w,C,r,true);if(n.canWordWrap){g.innerHTML=t?N.encodeHtmlString(n.text,true):n.text;}else{n=I.truncateTextToLineWithWordWrap(u,w,C,1);g.innerHTML=t?N.encodeHtmlString(n,true):n;}o=true;}U=Math.min(Math.max(U,p),C);j=l.v;m=l.isTrendLineFuncToken;if(m){x=K(j);}if(!m||!x.hasSuper){if(m){j=x.htmlText;}q.innerHTML=t?N.encodeHtmlString(j,true):j;d=I.getComputedFontStyle(q);if(S){h=Math.ceil(I.measureTextWidthWithSpan(q.innerHTML,w,w.bonus,null,true,true));}else{h=Math.ceil(I.measureTextWidth(q.innerHTML,d,d.bonus,null,true));}if(h>C){n=I.truncateTextToLineWithWordWrap(j,d,C,l.noTruncate?100:r,true);if(!n.canWordWrap){n=I.truncateTextToLineWithWordWrap(j,d,C,1,true);}q.innerHTML=t?N.encodeHtmlString(n.text,true):n.text;h=n.maxLineLen;k=true;}Z=Math.min(Math.max(Z,h),C);}else{q.innerHTML=x.htmlText;d=I.getComputedFontStyle(q);h=0;L.forEach(j,function(z){z.textWidth=I.measureSuperTextWidth(z.isSuper,z.v,d,d.bonus);h+=z.textWidth;});h=Math.ceil(h);if(h>C){n=I.truncateTextToLineWithWordWrapForTokens(j,d,C,l.noTruncate?100:r,true,true);if(!n.canWordWrap){n=I.truncateTextToLineWithWordWrapForTokens(j,d,C,1,true);}q.innerHTML=K(n.text).htmlText;h=n.maxLineLen;k=true;}Z=Math.min(Math.max(Z,h),C);}var f=parseInt(M.getComputedStyle(g).paddingRight);b.style.width=(U+f+1)+"px";W.style.width=(Z+1)+"px";v=U+Z+f;c.style.width=(v+2)+"px";Y=false;if(o||k){M.addClass(e,"wrapped");}}});if(a){this.moveTo(a.x,a.y);}},moveTo:function(a,Z){var Y=mstrmojo.dom.position(document.body),W=this.domNode,b=W.offsetWidth,X=W.offsetHeight,V=Y.x+Y.w,c=Y.y+Y.h,S=a+E,R=Z+E;if(S>V-b||R>c-X){if(S<=V-b){R=c-X;}else{if(R<=c-X){S=V-b;}else{S=V-b;R=Z-E-X;}}}var U=W.style;U.left=S+D;U.top=R+D;},doLayout:function A(R){var U=this.domNode.getElementsByTagName("table")[0];if(!U){return ;}var V=M.getComputedStyle(this.domNode),S=R-parseInt(V.paddingLeft,10)-parseInt(V.paddingRight,10);S-=U.rows[0].cells[0].offsetWidth;U.getElementsByClassName(F+"-value").forEach(function(W){W.style.maxWidth=S+D;});},posTo:function B(S){var R=this.domNode.style;R.left=S.x+D;R.top=S.y+D;},renderErrMsg:function G(R){Q.call(this).insertRow(-1).insertCell(-1).innerText=R;},hide:function J(){var R=this.domNode;this.toggle(false);if(R&&R.parentNode){R.parentNode.removeChild(R);R.innerHTML="";}}});}());(function(){mstrmojo.requiresCls("mstrmojo.dom","mstrmojo.css","mstrmojo.array","mstrmojo.color","mstrmojo.string","mstrmojo.vi.enums.EnumFeatures","mstrmojo.VisUtility");var v=mstrmojo,d=v.dom,C=v.css,w=v.array,Q=v.color,AP=v.string,AQ=mstrmojo.VisUtility,AK=90,e=-90,AC=180,J=-180,AE=true,R=v.vi.enums.EnumFeatures,z="http://www.w3.org/2000/svg";var I;function W(){var AX=navigator.userAgent.toLowerCase();return d.isIE||(AX&&AX.match(/rv:([\d.]+)\) like gecko/));}mstrmojo.gmaps.MapUtils=mstrmojo.provide("mstrmojo.gmaps.MapUtils",{_mixinName:"mstrmojo.gmaps.MapUtils",checkVal:function P(AX){return this.checkDefined(AX)&&!(isNaN(parseInt(AX)));},checkVals:function A(AY){var AX=true;w.forEach(AY,function(AZ){if(!this.checkVal(AZ)){AX=false;return false;}});return AX;},checkHasFunction:function r(AY,AX){return AY&&AY[AX]&&AY[AX] instanceof Function;},checkDefined:function B(AX){return(AX!==undefined)&&(AX!==null);},parseBoolean:function M(AX){return AX===true||AX==="true";},isAsp:function X(){return(window.location.pathname.indexOf("/asp/")>0);},trimString:function AN(AX){return mstrmojo.string.trim(AX);},log:function N(AX){if(console&&console.log){console.log(AX);}},replaceSpace:function m(AZ,AY){if(!this.checkDefined(AZ)){return ;}var AX=(this.checkDefined(AY))?AY:"_";return AZ.replace(/ /g,AX);},getProtocol:function O(){return this.isSingleTier()?"http:":window.location.protocol;},createMouseEvt:function AW(AY){var AX;if(W()||d.isFF){AX=document.createEvent("MouseEvents");AX.initEvent(AY,true,false);}else{if(window.MouseEvent){AX=new MouseEvent(AY);}}return AX;},isRMClick:function E(AX){var AY=false;if(AX){if(AX.which){AY=AX.which===3;}else{if(AX.button){AY=AX.button===2;}}}return AY;},createNormalNode:function AG(AX){if(!!AX){return document.createElement(AX);}},createSvgNode:function AH(AX){if(!!AX){return document.createElementNS(z,AX);}},appendNode:function AD(AX,AY){if(this.checkHasFunction(AX,"appendChild")&&AY){AX.appendChild(AY);}},appendSvgNode:function f(AX){if(!AX){return ;}var AY=this.createSvgNode("svg");this.setCssStyles(AY,{position:"absolute",width:AX.style.width,height:AX.style.height,top:"0px",left:"0px"});AX.appendChild(AY);return AY;},appendGNode:function K(AY){if(!this.checkHasFunction(AY,"appendChild")){return ;}var AX=this.createSvgNode("g");AY.appendChild(AX);return AX;},setNodeAttributes:function k(AY,AX){if(!this.checkHasFunction(AY,"setAttribute")||!AX){return ;}for(var AZ in AX){if(this.checkDefined(AX[AZ])){AY.setAttribute(AZ,AX[AZ]);}}},setCssStyles:function F(AZ,AY){var AX=AZ&&AZ.style,Aa;if(!AX||!AY){return ;}for(Aa in AY){if(this.checkDefined(AY[Aa])){AX[Aa]=AY[Aa];}}},setCssTransform:function l(AX,AY){if(!AY||!this.checkVal(AY.x)||!this.checkVal(AY.y)){return ;}w.forEach(w.ensureArray(AX),function(AZ){this.setNodeAttributes(AZ,{transform:"translate("+AY.x+" "+AY.y+")"});},this);},emptyDomElement:function a(AX){if(!this.checkHasFunction(AX,"removeChild")){return ;}while(AX.firstChild){AX.removeChild(AX.firstChild);}},insertAfter:function U(AZ,AY){var AX=AY&&AY.parentNode;if(AZ&&this.checkHasFunction(AX,"insertBefore")){if(AY.nextSibling){AX.insertBefore(AZ,AY.nextSibling);}else{AX.appendChild(AZ);}}},insertAsFirstChild:function AS(AX,AY){if(AX&&AY){if(AX.firstChild){AX.insertBefore(AY,AX.firstChild);}else{AX.appendChild(AY);}}},getEvtCoordInsideNode:function AB(AY,AX){var AZ=this.getBoundingRect(AX);if(!AY||!this.checkVal(AY.clientX)||!this.checkVal(AY.clientY)||!AZ||!this.checkVal(AZ.left)||!this.checkVal(AZ.top)){this.log("getEvtCoordInsideNode(): Invalid clientRect.");return ;}return{x:AY.clientX-AZ.left,y:AY.clientY-AZ.top};},getBoundingRect:function c(AX){if(this.checkHasFunction(AX,"getBoundingClientRect")){return AX.getBoundingClientRect();}},showWait:function AV(){if(this.checkHasFunction(mstrApp,"showWait")){mstrApp.showWait();}else{if(this.checkHasFunction(microstrategy,"showWait")){microstrategy.showWait(true);}}},hideWait:function j(AX){if(this.checkHasFunction(mstrApp,"hideWait")){mstrApp.hideWait(AX);}else{if(this.checkHasFunction(microstrategy,"showWait")){microstrategy.showWait(false);}}},isValidLatLng:function Z(AY,AX){if(!this.checkVal(AY)||!this.checkVal(AX)){return false;}return parseInt(AY)>=e&&parseInt(AY)<=AK&&parseInt(AX)>=J&&parseInt(AX)<=AC;},isExpress:function q(){return !!(mstrApp&&mstrApp.isExpress);},isVI:function AT(){return mstrApp&&mstrApp.isVI;},isOIVM:function AJ(){return mstrApp&&(mstrApp.isExpress||mstrApp.isVI);},isSingleTier:function AO(){return !!(mstrApp&&mstrApp.isSingleTier);},isWorkstation:function S(){return mstrApp&&mstrApp.isWorkstation;},isWSLiveMode:function Y(){return mstrApp&&mstrApp.supportFeature(R.SUPPORT_LIVEMODE)&&(typeof mstrApp.getWSLiveMode==="function")&&mstrApp.getWSLiveMode();},getEvent:function AR(AX){if(!d.supportsTouches){return AX;}else{return d.firstChangedTouch(window,AX);}},enableZoomLevelAndPosSaving:function h(){return !this.isWorkstation()||AE;},isCanvasSupported:function o(){var AX=document.createElement("canvas");return !!(AX.getContext&&AX.getContext("2d"));},convertImageUrl:function p(AX){if(mstrApp.isDossier&&AX&&AX.indexOf("../")===0){return v.getStyleRoot()+"/../"+AX.substr(3);}return AX;},encode:function H(AZ,AY){var Ab=AZ;if(!this.checkDefined(AY)){AY=false;}if(AZ&&AZ.length>0){Ab="";for(var Aa=0,AX=AZ.length;Aa<AX;Aa++){switch(AZ.charAt(Aa)){case"&":if((AZ.length!==(Aa+1))&&(AZ.charAt(Aa+1)==="#")){Ab+="&";}else{Ab+="&amp;";}break;case"<":Ab+="&lt;";break;case">":Ab+="&gt;";break;case"'":Ab+="&#039;";break;case"\n":if(!AY){Ab+="<br />";}else{Ab+=AZ.charAt(Aa);}break;case'"':Ab+="&quot;";break;case" ":if(Aa===0||(Aa<AZ.length-1&&AZ.charAt(Aa+1)===" ")){Ab+="&nbsp;";}else{Ab+=AZ.charAt(Aa);}break;default:Ab+=AZ.charAt(Aa);break;}}}return Ab;},loadCss:function t(AX,Ac){var Ab=document.styleSheets;if(Ab){var AZ,Aa;for(AZ=0;AZ<Ab.length;AZ++){Aa=Ab[AZ];if(Aa.id===AX){return ;}}}var AY=document.createElement("link");AY.setAttribute("rel","stylesheet");AY.setAttribute("type","text/css");AY.setAttribute("href",Ac);AY.setAttribute("id",AX);document.getElementsByTagName("head")[0].appendChild(AY);},getGraphicLayerById:function L(AX){var AY=mstrmojo.all[AX];if(!AY){this.hideWait();}return AY;},isEmbedded:function AM(){return mstrApp&&mstrApp.isEmbedded;},_verifyProtocol:function AI(AX){if("https:"===window.location.protocol&&(-1!==AX.search(/^http\:\/\/server\.arcgisonline\.com/i)||-1!==AX.search(/^http\:\/\/services\.arcgisonline\.com/i)||-1!==AX.search(/^http\:\/\/.+\.arcgis\.com/i))){AX=AX.replace(/http:/i,"https:");}return AX;},loadExternalScript:function V(AY,Ab,AZ){if(!AY){return ;}var AX=document.createElement("script");AX.type="text/javascript";AX.src=AY;if(AZ){AX.onerror=AZ;}if(AX.addEventListener){AX.addEventListener("load",function Aa(){AX.removeEventListener("load",Aa);AX.onerror=null;if(Ab){Ab();}},false);}else{if(AX.readyState){AX.onreadystatechange=function(){if(AX.readyState==="loaded"||AX.readyState==="complete"){AX.onreadystatechange=null;AX.onerror=null;if(Ab){Ab();}}};}}document.getElementsByTagName("head")[0].appendChild(AX);},getNoInternetMessage:function b(){var AY,AX;if(mstrApp.isSingleTier){AY="Unable to create the map. Please check you connection. You can configure an Internet proxy through your computer's #";AX='<a href="" style="color:#7CC5EC" onclick="window.FormWrapper.showProxyEditor(); return false;">'+mstrmojo.desc(7831,"Settings")+"</a>.";AY=AY.replace("#",AX);}else{AY="Unable to download the requested map. Please contact your administrator to resolve this issue.";}return AY;},getThemeClass:function g(){if(mstrApp&&mstrApp.getThemeClassName){return" "+mstrApp.getThemeClassName();}},adjustHSV:function u(Ah,AZ,Ab,Ag){if(!Ah||!this.checkVal(AZ)||!this.checkVal(Ab)||!this.checkVal(Ag)){return Ah;}var Ae,Ai,AY,AX,Ac,Ad,Aa,Af;if(!Ah){return Ah;}if(Ah.length===7){Ae=parseInt(Ah.substring(1,3),16);Ai=parseInt(Ah.substring(3,5),16);AY=parseInt(Ah.substring(5,7),16);}else{if(Ah.length===4){Ae=parseInt(Ah.substring(1,2)+Ah.substring(1,2),16);Ai=parseInt(Ah.substring(2,3)+Ah.substring(2,3),16);AY=parseInt(Ah.substring(3,4)+Ah.substring(3,4),16);}else{return Ah;}}AX=Q.rgb2hsv(Ae,Ai,AY);AX[0]=AX[0]*AZ;AX[1]=AX[1]*Ab;AX[2]=parseInt(AX[2]*Ag>100?100:AX[2]*Ag,10);Ac=Q.hsv2rgb(AX[0],AX[1],AX[2]);Ae=parseInt(Ac[0],10);Ai=parseInt(Ac[1],10);AY=parseInt(Ac[2],10);Ad=Ae<16?"0"+Ae.toString(16):Ae.toString(16);Aa=Ai<16?"0"+Ai.toString(16):Ai.toString(16);Af=AY<16?"0"+AY.toString(16):AY.toString(16);Ah="#"+Ad+Aa+Af;return Ah;},fillColorAjustForCMSelection:function D(AX){return this.adjustHSV(AX,1,0.5,1.2);},fillColorAjustForHover:function G(AX){return this.adjustHSV(AX,1,0.6,1.15);},setLayerNodeProps:function x(Aa,Ab,AZ,AY,AX){this.setNodeAttributes(Aa,{id:Ab,"class":AZ});this.setCssStyles(Aa,{position:"absolute",top:"0px",left:"0px"});if(this.checkVal(AY)&&this.checkVal(AX)){AY=parseInt(AY);AX=parseInt(AX);this.setCssStyles(Aa,{width:AY+"px",height:AX+"px"});}},destroyNode:function AA(AX){if(!AX){return ;}try{if(AX.parentNode){AX.parentNode.removeChild(AX);}if(d.isIE&&AX.outerHTML!==undefined){AX.outerHTML="";}}catch(AY){}},destroyObj:function AU(AX){if(AX&&AX.destroy instanceof Function){AX.destroy();}},removeHTMLTagsAndProps:function n(AY,Aa,AX){try{(AY.match(/<[^>]+>/g)||[]).forEach(function(Af){var Ai,Ad,Ac,Ae,Aj,Ab,Ag,Ak,Ah=Af.toLowerCase();Ad=Ah.match(/<\/?([a-z]+\b)/);if(Ad&&Ad.length===2){Ac=Ad[1];if(Aa.indexOf(Ac)<0){AY=AY.replace(Af,"");return ;}if(Ah.charAt(1)==="/"){Ah=Ah.substring(2);Ag="</";}else{Ah=Ah.substring(1);Ag="<";}Ai=Ah.length-2;if(Ah.charAt(Ai)==="/"){Ah=Ah.substring(0,Ai);Ak="/>";}else{Ah=Ah.substring(0,Ah.length-1);Ak=">";}Ah=Ah.replace(Ac,"");Ab="";Aj="";while(Ah!=Ab){Ab=Ah;Ah=AP.trim(Ah);Ad=Ah.match(/([^=]+)=\s*('[^']*'|"[^"]*")/);if(Ad&&Ad.length===3){Ae=AP.trim(Ad[1]).split(/\s+/);if(Ae&&Ae.length>0){Ae=Ae[Ae.length-1];if(AX.indexOf(Ae)>=0){Aj+=" "+Ae+"="+Ad[2];}}Ah=Ah.substring(Ad[0].length);}}AY=AY.replace(Af,Ag+Ac+Aj+Ak);}});}catch(AZ){console.log("HTML Parse Error: "+AZ);}finally{return AY;}},addArrowNode:function AF(AY){if(AY){var AX=this.createNormalNode("div");C.addClass(AX,"mstrmojo-Tooltip-arrow");this.appendNode(AY,AX);}},getFontFamilyItems:function AL(AX){if(I){return I;}else{I=w.filter(AQ.getFontFamilyItems(),function(AY){return w.indexOf(AX,AY.n)===-1;});return I;}},});}());(function(){mstrmojo.requiresCls("mstrmojo.ListBase","mstrmojo._IsList","mstrmojo._HasSuggestion","mstrmojo.Enum_Keys","mstrmojo.css","mstrmojo.VisUtility","mstrmojo.hash","mstrmojo.dom");var K=mstrmojo.dom,E=mstrmojo.css,R="srchBoxState",C=mstrmojo.Enum_Keys,S=mstrmojo.VisUtility,M=200,g,H=24,Q={fontFamily:"Arial",fontSize:"11px"};var e={2147762262:mstrmojo.desc(16256,"Please enter a numeric value"),2147762227:mstrmojo.desc(16257,"Unable to perform search with the operators provided")};var P={DEFAULT:1,ADDING:2,EMPTY:3,FULL:4};var l="mstrmojo-SimpleObjectInputBox-del";function F(){var q=this.inputBox,r=q&&q.value;if(r!==""&&(r!==this._lastPattern||!this.suggestionShown)){this.showSuggestion(r);this._isSearching=true;if(this.hitEnterToTest){this.inputBox.blur();}}this._lastPattern=r;delete this._timerHandle;}function D(){var q=this._timerHandle;if(q){window.clearTimeout(q);delete this._timerHandle;}}function A(){if(this.richTooltip){if(this.tooltip){this.tooltip.set("allowOtherTooltips",false);}this.hideTooltip();}}function b(q){var t=this._inputPos,r=!mstrApp.isAppStatePresentation||mstrApp.isAppStatePresentation(),u=this,v;if(this.richTooltip){v=this.richTooltip;if(!this.hasOpenTooltip&&!this.suggestionShown){v.top=(t.h+t.y)+"px";v.left=t.x+"px";if(!this.hitEnterToTest&&!r){window.setTimeout(function(){var z=u.tooltip,x=z&&z.contentNode,AA,w;AA=x?x.childNodes:null;if(AA&&AA.length>1){w=AA[1];AA=w.childNodes;if(AA&&AA.length>1){w=AA[1];}else{w=null;}}if(u.hasOpenTooltip&&w&&!E.hasClass(x,"lng")){if(v.onclick){u.tooltip.onclick=v.onclick;K.attachMarkupEvent(u.tooltip.id,w,"click");}E.addClass(x,"lng");}},3000);}this.showTooltip(q.e,q.hWin);this.set("allowOtherTooltips",!this.hitEnterToTest);}}}function G(){if(window.mstrLocalStorage===undefined){return{};}var q=(mstrLocalStorage.getLocalStorage()||{})[R];return(q&&JSON.parse(q))||{};}function Y(q){if(window.mstrLocalStorage!==undefined){mstrLocalStorage.setItem(R,JSON.stringify(q));}}mstrmojo.SimpleObjectInputBox=mstrmojo.declare(mstrmojo.ListBase,[mstrmojo._IsList,mstrmojo._HasSuggestion,mstrmojo.ui._HasScroller],{scriptClass:"mstrmojo.SimpleObjectInputBox",markupString:'<div id="{@id}" class="mstrmojo-ListBase mstrmojo-SimpleObjectInputBox {@cssClass}" style="{@cssText}" mstrAttach:click><div class="mstrmojo-SimpleObjectInputBox-container {@icnCss}" style="{@icnCssText}">{@itemsHtml}<input type="text" mstrAttach:keydown,keyup,blur,focus style="display: none;" autocomplete="off" autocorrect="off" autocapitalize="off" spellcheck="false" /><div class="mstrmojo-SimpleObjectInputBox-empty"><div>{@emptyText}</div></div></div></div>',markupSlots:{itemsContainerNode:function(){return this.domNode.firstChild;},emptyTextNode:function(){return this.domNode.firstChild.lastChild;},inputBox:function(){var q=this.domNode.firstChild.children;return q[q.length-2];},scrollboxNode:function(){return this.domNode.firstChild;}},markupMethods:{onvisibleChange:mstrmojo.Widget.visibleMarkupMethod,onheightChange:mstrmojo.Widget.heightMarkupMethod,onwidthChange:mstrmojo.Widget.widthMarkupMethod,onmaxItemWidthChange:function d(){var q=this.maxItemWidth;if(!isNaN(q)&&q>0){this.emptyTextNode.style.maxWidth=q+"px";}}},itemField:"n",emptyText:"",state:0,maxItemWidth:"none",useKeyDelay:false,hitEnterToTest:false,maxObjectCount:null,useRichTooltip:true,init:function m(q){this._super(q);if(mstrApp.isWorkstation){Q.fontFamily="Helvetica";}},showTooltip:function p(r,v){var u=r.target||K.eventTarget(r.hWin,r.e),t=this.getItemFromTarget(u);if(t&&t.n){var w=this.getItemNodeFromTarget(u).firstChild,q=K.position(w);this.richTooltip={posType:mstrmojo.tooltip.POS_TOPCENTER,cssClass:"vi-regular vi-tooltip-A A-center",refNode:w,content:mstrmojo.string.encodeHtmlString(t.n),top:q.h+11,left:q.w/2};this._super(r,v);}},getItemMarkup:function(q){if(!g){var r=this.itemField;g=this._super(q).replace(">{@en@n}<",'"><div class="elem">{@en@'+r+'}<div class="'+l+'"></div></div><');}return g;},getItemProps:function c(v,q){var t=this._super(v,q),w=this.itemField;var u=this.maxItemWidth;if(!isNaN(u)&&u>0){u=(u-H);}if(!mstrmojo.string.isEmpty(v[w])){var r=v[w];t[w]=r;if(u<S.measureTextWidth(r,Q)){t.title=r;}}t.addStyle("max-width:"+u+"px");return t;},getSuggestionPos:function U(){var q=this._inputPos;return{target:this.inputBox,left:q.x+"px",top:q.y+q.h+"px",zIndex:100};},updateSuggestion:function Z(q){var r=G();if(!r.srch){if(this._super){this._super(q);}}this.inputBox.focus();A.call(this);},failMessage:function B(r){var t=e[r.errCode]||r.msg,q=t?[{n:t,t:-101,cls:"nomatch"}]:[];this.updateSuggestion(q);},getSearchPattern:function N(){return this.inputBox?this.inputBox.value:"";},showInfoTooltip:function X(u){var v=G(),q=this.parent.parent,w=K.position(q.domNode),r=this.richTooltip,t=this;if(!v.hasShownInfo&&!mstrmojo.SimpleObjectInputBox.HAS_SHOWN_INFO){mstrmojo.SimpleObjectInputBox.HAS_SHOWN_INFO=true;v.hasShownInfo=true;this.set("richTooltip",{posType:mstrmojo.tooltip.POS_BOTTOMCENTER,cssClass:"vi-regular vi-tooltip-V vi-tooltip-leftcenter",contentNodeCssClass:"srch info",top:w.y+"px",left:w.x+w.w+8+"px",content:mstrmojo.desc(15909,'You can re-enable "Instant Search" from the menu.'),onClose:function(){t.set("richTooltip",r);}});this.showTooltip(window.event,window);if(this.tooltip){this.tooltip.set("allowOtherTooltips",false);}else{this.set("allowOtherTooltips",false);}}v.srch=u;Y(v);},onIncrementalFetch:function J(){this.inputBox.blur();},onSuggestionItemSelect:function j(q){D.call(this);this.set("items",this.items.concat(q));this._super();var r=this.id;window.setTimeout(function(){var t=mstrmojo.all[r];if(parseInt(t.state,10)!==P.FULL){t.set("state",P.ADDING);}},0);},onstateChange:function W(r){var t=r.value;this.emptyTextNode.style.display=(t===P.ADDING)?"none":"block";var q=this.inputBox,u=q.style;if(t===P.ADDING){u.display="";this.updateScrollbars();q.focus();this._inputPos=K.position(q,true);}else{D.call(this);u.display="none";q.value="";this._lastPattern="";this.updateScrollbars();if(this.parent.getFormats&&!this.parent.getFormats().height&&this.parent.parent.performCanGrowCanShrink){this.parent.parent.performCanGrowCanShrink(this.parent.parent.children);}}},postBuildRendering:function O(){var q,r=G();M=(mstrApp.getSearchAutoCompleteDelay&&mstrApp.getSearchAutoCompleteDelay())||M;this.state=0;this.setDefaultState();if(r.srch){this.inputBox.value=r.srch;this.set("state",P.ADDING);delete r.srch;Y(r);}q=this._super();return q;},preitemsChange:function L(){this.setDefaultState();},onclick:function f(r){var v=K.eventTarget(r.hWin,r.e);if(v&&v.className===l){var u=K.findAncestorByAttr(v,"idx",true,this.domNode),q=u&&parseInt(u.value,10);this.hideTooltip();if(q!==null&&!isNaN(q)){var t=this.items.concat();t.splice(q,1);this.set("items",t);}return ;}if(parseInt(this.state,10)!==P.FULL){this.set("state",P.ADDING);}},onblur:function V(){if(this._isSearching||this.tooltip){return ;}D.call(this);A.call(this);if(!this.suggestionShown){this.setDefaultState();}},onfocus:function k(){this._isSearching=false;if(this.suggestionShown){A.call(this);}},prekeydown:function I(r){var v=r.e;switch(parseInt(v.keyCode||v.charCode,10)){case C.DOWN_ARROW:this.nextHighlight();break;case C.UP_ARROW:this.preHighlight();break;case C.TAB:case C.ENTER:K.preventDefault(r.hWin,v);if(this.suggestionShown){var u=this.getSelected();if(u){this.handleSuggestionItemSelect(u);}else{this.hideSuggestion();}}else{if(this.hitEnterToTest){A.call(this);F.call(this);}}break;case C.ESCAPE:D.call(this);if(this.suggestionShown){this.hideSuggestion();}else{this.setDefaultState();}break;case C.BACKSPACE:if(!this.getSearchPattern()&&!mstrApp.hasRequests()){K.preventDefault(r.hWin,v);var t=this.items&&this.items.concat();if(t&&t.length){t.splice(t.length-1,1);mstrApp.ignoreBackSpace=true;this.set("items",t);var x=this.id;window.setTimeout(function(){mstrmojo.all[x].set("state",P.ADDING);mstrApp.ignoreBackSpace=false;},0);}}break;}var q=this.richTooltip,w=(q&&q.contentNodeCssClass)||"";if(w.indexOf("srch info")>-1){A.call(this);}},prekeyup:function o(q){var u=q.e,r=parseInt(u.keyCode||u.charCode,10),t=this.getSearchPattern();if(!t||t!==this._lastPattern){K.preventDefault(q.hWin,q.e);this.hideSuggestion();}if(this.inputBox.value.length&&r!==C.ENTER&&r!==C.TAB&&!this.suggestionShown){b.call(this,q);}else{A.call(this);}if(this.hitEnterToTest){return ;}if(this.useKeyDelay){var v=this.id;if(!this._timerHandle){this._timerHandle=window.setTimeout(function(){F.call(mstrmojo.all[v]);},M);}}else{F.call(this);}},widgetResized:function n(){if(this.hasRendered){var u=parseInt(this.width,10),w=this.items.length,x=this.itemsContainerNode.childNodes;if(w<=(x&&x.length)){var v=u-H;for(var t=0;t<w;t++){var q=x[t],r=q.textContent;q.style.maxWidth=v+"px";if(r&&v<S.measureTextWidth(r,Q)){q.title=r;}else{q.title="";}}}if(this.emptyTextNode){this.emptyTextNode.style.maxWidth=u+"px";}this.updateScrollbars();}},setupScrollNodes:function h(){this.scrollNode=this.scrollboxNode;},setDefaultState:function a(){var t=this.maxObjectCount,q=(this.items&&this.items.length)||0,r=(t!==null&&t!==undefined&&q>=t);this.set("state",!q?P.EMPTY:(r?P.FULL:P.DEFAULT));}});mstrmojo.SimpleObjectInputBox.HAS_SHOWN_INFO=false;}());(function(){mstrmojo.requiresCls("mstrmojo.css","mstrmojo.dom","mstrmojo.func","mstrmojo.Dialog","mstrmojo.Button","mstrmojo._IsPopup","mstrmojo._CanAutoClose","mstrmojo.VisUtility","mstrmojo.vi._MonitorsAppState","mstrmojo.PerformanceLogOutput");var k=60,Z=mstrmojo,C=Z.css,O=Z.dom,r=Z.func,W=Z.VisUtility,c=Z.Button.newWebButton,n=2,J=60,X=3,o=44,w=48,D=4,q=160,f=Z.PerformanceLogOutput;function B(){f.startTimer({functionName:"VisFilter.updateSelections",purpose:"from Apply filter to End"},"timerid_VisFilter_updateSelections");f.visPrint("VisFilter updateSelections start");var z=this.filterPortlet,AA=this._actionCache;if(z&&AA){z.selector.applySelections(AA);}this.destroy();}function g(){var z=this.vizBox;return z&&z.boxContent;}function S(){return mstrApp?mstrApp.getThemeClassName():"";}function L(){var AA=this.filterPortlet,z=AA&&AA.domNode;if(z){return z.getBoundingClientRect();}}function d(){var AA=this.filterPortlet,z=AA&&AA.parent;return z&&z.parent;}function R(AA){var AC=this.filterPortlet,z=AC&&AC.domNode,AB=z&&z.parentNode;if(AB){AB.style.paddingBottom=AA+"px";}}function H(){var AA=d.call(this),z=AA&&AA.containerNode;if(z){return z.getBoundingClientRect();}}function Q(){if(!this.model){return ;}var z=this.model.getMainPanelFormatting(),AB=L.call(this),AA={top:z.top,height:z.height};if(AB.left<z.left){AA.left=AB.right;AA.width=z.right-AA.left;}else{AA.left=z.left;AA.width=AB.left-AA.left;}return AA;}function v(){var AD=P.call(this),AA=L.call(this),AC=H.call(this),AB=n/2,z={top:Math.max(AA.top,AC.top)+AB};z.height=(AA.bottom<AC.bottom)?(AA.bottom-z.top)-AB:(AC.bottom-z.top)-AB;z.height=z.height<0?0:z.height;if(AA.left<AD.left){z.right=AD.left+n;z.left=AD.left-n*3;}else{z.left=AD.right+AB;z.right=AA.left+n*2;}z.width=z.right-z.left;return z;}function x(){var z=document.getElementById("VisFilterCurtain-main"),AA=Q.call(this);if(z){z.style.left=AA.left+"px";z.style.width=AA.width+"px";z.style.top=AA.top+"px";z.style.height=AA.height+"px";}}function b(){var AA=document.getElementById("VisFilterCurtain-border"),z=v.call(this);if(AA){AA.style.left=z.left+"px";AA.style.width=z.width+"px";AA.style.top=z.top+"px";AA.style.height=z.height+"px";}}function K(AA){var AE=this.filterPortlet,AB=AE&&AE.domNode,AF=AB&&AB.previousSibling&&AB.previousSibling.previousSibling,z=AF&&AF.querySelector(".splitter"),AC=AA?"block":"none",AD;if(AB){C.setStyleValue(AB.querySelector(".splitter"),["display"],[AC]);}if(z){AD=C.getStyleValue(z,"display");if(!AA&&AD==="none"){this.ignorePreDivider=true;}if(!this.ignorePreDivider){C.setStyleValue(z,["display"],[AC]);delete this.ignorePreDivider;}}}function m(){x.call(this);b.call(this);K.call(this,false);}function P(){var AB=this.model,z=AB.getMainPanelFormatting(),AD=AB.getFilterPanelFormatting(),AC=z.width>J?J:0,AA={top:z.top+X,height:z.height-o-X};if(AD.left<z.left){AA.left=AD.right-n;AA.right=z.right-AC;}else{AA.right=AD.left-n*2;AA.left=z.left+AC;}AA.bottom=AA.top+AA.height;AA.width=AA.right-AA.left;return AA;}function p(AB){var AC=AB,z=document.body;while(AC&&(AC!==z)){var AA=AC.getAttribute&&AC.getAttribute("class");if(AA!==null&&AA.indexOf("forVisFilter")>=0){return true;}AC=AC.parentNode;}return false;}function U(AB){var z=this.filterPortlet,AC=AB&&AB.getSelectionCache(),AA=(AC&&AC._viSelections)||{};if(z&&AB){z.updateSummaryBar(AA);}}mstrmojo.vi.ui.rw.VisFilterDisplayPanel=mstrmojo.declare(mstrmojo.Dialog,[mstrmojo._IsPopup,mstrmojo._CanAutoClose,mstrmojo.vi._MonitorsAppState],{scriptClass:"mstrmojo.vi.ui.rw.VisFilterDisplayPanel",markupString:'<div id="{@id}" class="mstrmojo-Dialog {@cssClass}" style="z-index: 8;" tabindex="0" mstrAttach:click,contextmenu><div class="mstrmojo-Editor" style="height:{@height}"><div class="mstrmojo-Editor-titlebar"><div class="mstrmojo-Editor-title">{@title}</div></div><div class="mstrmojo-Editor-content"></div></div><svg id="VisFilterCurtain-main" /><svg id="VisFilterCurtain-border" /><div class="mstrmojo-Editor-tip"></div></div>',cssClass:"mstrmojo-VisFilterDisplayPanel",children:[{scriptClass:"mstrmojo.Box",cssClass:"titlebar-container",slot:"titleNode",alias:"titleBar",children:[{scriptClass:"mstrmojo.Label",text:mstrmojo.desc(1763,"Clear All"),alias:"clearAllBtn",cssClass:"edt-link disabled",disabled:true,onclick:function(AB){var z=this.parent.parent,AA=g.call(z);if(!this.disabled&&AA){AA.clearAllSelectionsAndHighlight(AB);}}},{scriptClass:"mstrmojo.Box",alias:"btnBox",children:[c(mstrmojo.desc(221,"Cancel"),function(){var z=this.parent.parent.parent;if(z){z.cancelSelections();}}),c(mstrmojo.desc(8473,"Done"),function(){var z=this.parent.parent.parent;if(z){B.call(z);}},true,{alias:"savebtn",enabled:false})]}]},{scriptClass:"mstrmojo.Box",alias:"visContainer",slot:"containerNode"}],locksHover:true,nodeKey:null,vizBox:null,filterPortlet:null,include:null,model:null,_actionCache:null,_prevSelectionInfo:null,disposable:false,init:function t(z){this._super(z);if(!this.model){return ;}this.cssClass+=" "+S();},_addVizBox:function j(){var AA=this.vizBox=this.model.getVizBox(this.nodeKey,{width:parseInt(this.width),height:parseInt(this.height)-k}),z=AA&&AA.boxContent;if(z){z.filterCtrl=this;}this.visContainer.addChildren(AA);return AA;},preBuildRendering:function A(){var z=P.call(this),AB=this.vizBox;if(!z){return ;}this.height=z.height+"px";this.width=z.width+"px";this.left=z.left+"px";this.top=z.top+"px";var AA=this.selectedVizBox=document.querySelector(".mstrmojo-VIMainVizPanel .mstrmojo-UnitContainer.selected");C.removeClass(AA,"selected");if(!AB){this.vizBox=this._addVizBox();}else{AB.updateLayout({height:(z.height-k)+"px",width:z.width+"px"});}this._super();},postBuildRendering:function V(){this._super();m.call(this);this.updateTitleBar();this.updateVisFilterPortletStyle();},updateVisFilterPortletStyle:function u(){var AK=d.call(this),AB=AK.scrollNode;if(!AK||!AB){return ;}AK.disableScroll();var AD=this.filterPortlet.domNode,AF=AB.scrollTop,AL=AB.clientHeight,AM=AB.scrollHeight,AE=AB.getBoundingClientRect(),AA=AD.offsetTop,AH=AD.getBoundingClientRect(),AJ=AH.height,AC=AA+AJ,AG=this.model.getMainPanelFormatting(),AI=AE.bottom-AG.bottom+w,z;if(AA<AF){AB.scrollTop=AA;}else{if(AF+AL<AC+AI){z=AM-AC;if(z<AI){R.call(this,AI);}AB.scrollTop=AC+AI-AL;}}},close:function l(z){var AA=this.filterPortlet,AC=AA&&AA.domNode,AB=W.isHostedPopupNode(z,"class",true,document.body)||p(z),AD=W.isMojoEditorNode(z,"class",true,document.body);if(!(AC&&z&&AC.contains(z))&&!AB&&!AD){this._super();}},onClose:function Y(){K.call(this,true);this.cancelSelections();},onAppStateChange:function h(z){this._super(z);this.cancelSelections();},cacheUpdateAction:function E(z){this.updateTitleBar(true);this._actionCache=z;},updateTitleBar:function N(AC){var AA=this.titleBar,AB=AA&&AA.clearAllBtn,AD=g.call(this),z=AD?AD.getSelectionSize():0;if(!AB||!AD){return ;}U.call(this,AD);AA.btnBox.savebtn.set("enabled",!!AC);if(z>0){C.removeClass(AB.domNode,"disabled");AB.disabled=false;}else{C.addClass(AB.domNode,"disabled");AB.disabled=true;}},getResizeHandler:function e(){var z=this.id;return r.debounce(function(){var AA=mstrmojo.all[z];if(AA){AA.resizeDialog();AA.positionDialog();}},q);},resizeDialog:function M(){this._super();this.refresh();},cancelSelections:function F(){var z=g.call(this);if(z){z.setSelectionCache(z.getPrevSelectionInfo());z.clearHighlightsCache();}U.call(this,z);this.destroy();},updateFormats:function G(){b.call(this);},oncontextmenu:function a(z){O.stopPropogation(window,z);O.preventDefault(window,z);},updateVis:function I(z){var AA=g.call(this),AB=z&&z.data&&z.data.sc;if(AB){AB.exp=null;}if(AA&&z){AA.updateForInteractiveMode=true;AA.node=z;AA.update(z);AA.refresh();delete AA.updateForInteractiveMode;}},destroy:function(){var AD=this.vizBox,z=this.model,AC=g.call(this),AA=this.filterPortlet,AB=d.call(this);if(AB){AB.enableScroll();}R.call(this,D);K.call(this,true);if(AA){AA.resetVisFilterState();this.filterPortlet=null;}C.addClass(this.selectedVizBox,"selected");if(z&&AD){z.destroyVisualiztionselector(AD);}if(AC){AC.filterCtrl=null;}this.vizBox=null;this.model=null;this._super();mstrApp.isInVFInteractMode=false;}});}());(function(){mstrmojo.requiresCls("mstrmojo.locales");mstrmojo.requiresCls("mstrmojo.chart.enums.EnumFontStyle");mstrmojo.requiresCls("mstrmojo.VisUtility");mstrmojo.requiresClsP("mstrmojo.chart.common","DSSDateTime","ScalePlate");mstrmojo.requiresClsP("mstrmojo.chart.model.enums","EnumDSSGraphProperty","EnumDSSGraphDataTextShowType","EnumDSSGraphObject");var h=mstrmojo.chart,d=h.model,q=mstrmojo.VisUtility,Q=h.enums,E=Q.EnumFontStyle,S=d.enums,AB=S.EnumDSSGraphProperty,Y=S.EnumDSSGraphDataTextShowType,AC=S.EnumDSSGraphObject;var F=mstrmojo.gm.EnumDataLabels;var W=[["xAxLbFntClr","yAxLbFntClr","dlFntClr","lgdFntClr"],["xAxLbFntFml","yAxLbFntFml","dlFntFml","lgdFntFml"],["xAxLbFntSz","yAxLbFntSz","dlFntSz","lgdFntSz"],["xAxLbFntStyle","yAxLbFntStyle","dlFntStyle","lgdFntFml"]];var r=[["majorGridLnThk","minerGridLnThk","majorGridLnThk","minerGridLnThk"],["majorGridLnClr","minerGridLnClr","majorGridLnClr","minerGridLnClr"],["majorGridLnStyle","minerGridLnStyle","majorGridLnStyle","minerGridLnStyle"]];var Z=[["bgFillClr"],["bgFillStyle"],["bgFillTrans"]];function V(AL){switch(AL){case AB.DssGraphFontColor:return 0;case AB.DssGraphFontName:return 1;case AB.DssGraphFontSize:return 2;case AB.DssGraphFontStyle:return 3;case AB.DssGraphFontSize100:return 4;default:return -1;}}function w(AL){switch(AL){case AB.DssGraphAreaColor:return 0;case AB.DssGraphFillEffect:return 1;case AB.DssGraphAreaAlpha:return 2;}return -1;}function z(AL){var AM;switch(AL){case AC.DssGraphX1Body:case AC.DssGraphX1Label:case AC.DssGraphX1Major:case AC.DssGraphX1Minor:case AC.DssGraphUserLabel3:case AC.DssGraphUserLine3:AM="X1";break;case AC.DssGraphX2Body:case AC.DssGraphX2Label:case AC.DssGraphX2Major:case AC.DssGraphX2Minor:case AC.DssGraphUserLabel4:case AC.DssGraphUserLine4:AM="X2";break;case AC.DssGraphY1Body:case AC.DssGraphY1Label:case AC.DssGraphY1Major:case AC.DssGraphY1Minor:case AC.DssGraphUserLabel1:case AC.DssGraphUserLine1:AM="Y1";break;case AC.DssGraphY2Body:case AC.DssGraphY2Label:case AC.DssGraphY2Major:case AC.DssGraphY2Minor:case AC.DssGraphUserLabel2:case AC.DssGraphUserLine2:AM="Y2";break;case AC.DssGraphZBody:AM="Z";break;case AC.DssGraphO1Body:case AC.DssGraph2DO1Label:case AC.DssGraphO1Major:case AC.DssGraphO1Minor:AM="O1";break;case AC.DssGraphO2Body:case AC.DssGraph2DO2Label:case AC.DssGraphO2Major:case AC.DssGraphO2Minor:AM="O2";break;default:AM="No_Axis";break;}return AM;}function e(AL,AM){if(!!AL===false){return undefined;}return undefined;}function X(AQ,AL){if(!!AQ===false){return undefined;}var AV,AT,AS=AL.isVertical!==undefined?AL.isVertical:true,AN=AL.isGridChart||false,AW=AL.isPieShape||false,AR={Name:0,Value:0},AO=AQ.gaid,AP=AQ.goid,AM=AQ.gsid,AU=AQ.v;if(!!AO===false){return undefined;}switch(AO){case AB.DssGraphShowLBLFeeler:if(AW){AR.Name="DataLabel";if((AU&Y.DssGraphDataTextValue)!==0){AR.Value=F.SHOW_VALUE_ONLY;}else{if((AU&Y.DssGraphDataTextLabel)!==0){AR.Value=F.SHOW_TEXT_ONLY;}else{AR.Value=F.HIDE;}}}break;case AB.DssGraphAreaColor:case AB.DssGraphFillEffect:case AB.DssGraphAreaAlpha:AT=w.call(this,AO);if(AT<0){return undefined;}if(AP===AC.DssGraphBackground){AR.Name=Z[AT][0];if(AR.Name.search("Trans")!==-1){AR.Value=AU/255*100;}else{AR.Value=AU;}}break;case AB.DssGraphShowLegendText:AR.Name="LegendVisibleness";AR.Value=AU===0?false:true;break;case AB.DssGraphSDShowDataText:AR.Name="ShowSeriesDataLabel";AR.Value=AU!==0;break;case AB.DssGraphShowDataText:if(AW===false){AR.Name="DataLabel";AR.Value=F.HIDE;if(AU&Y.DssGraphDataTextValue){AR.Value=F.SHOW_VALUE_ONLY;}else{if(AU&Y.DssGraphDataTextLabel){AR.Value=F.SHOW_TEXT_ONLY;}}}break;case AB.DssGraphFontColor:case AB.DssGraphFontName:case AB.DssGraphFontSize100:case AB.DssGraphFontSize:case AB.DssGraphFontStyle:AR.Value=AU;AV=z.call(this,AP);AT=V.call(this,AO);if(AT<0){return undefined;}if(AT===4){AT=3;AR.Value/=100;}if(AV==="No_Axis"){if(AP===AC.DssGraphDataText){if(AW){return undefined;}AR.Name=W[AT][2];}else{if(AP===AC.DssGraphPieFeelerLabel||AP===AC.DssGraphPieFeelerLabel){if(AW===false){return undefined;}AR.Name=W[AT][2];}else{if(AP===AC.DssGraphLegendText){AR.Name=W[AT][3];}else{return undefined;}}}}else{if(AV[0]==="X"){AR.Name=W[AT][0];}else{if(AV[0]==="Y"){AR.Name=W[AT][1];}else{if(AV[0]==="O"){AR.Name=AS?W[AT][0]:W[AT][1];}else{return undefined;}}}}break;}return AR;}var U,k=String.fromCharCode,AF=mstrmojo.locales.datetime,AK=0,L=document.getElementById("measureText"),B={},j={};var o=0.03,K=0,R=0,H=0.2;function p(AM){var AL,AN=[],AO;for(AL=0;AL<=AM;AL++){AO=AL.toString(16);if(AO.length===1){AO="0"+AO;}AN[AL]=AO;}U=AN;return AN;}function AI(AL){var AM=parseFloat(AL);if(isNaN(AM)===false&&AM!==undefined&&AM!==null){return AM;}return 0;}function D(AL){AL=AL.replace(/ddd/g,"EEE");AL=AL.replace(/AM\/PM/g,"a");AL=AL.replace(/tt/g,"a");AL=AL.replace(/:'/g,":");AL=AL.replace(/'\/'/g,"/");AL=AL.replace(/\\/g,"");var AM,AO=true,AN=AL.length;for(AM=0;AM<AN;AM++){if(AL[AM]==="h"||AL[AM]==="H"||AL[AM]===":"){AO=true;}else{if(AL[AM]===" "&&AO){AO=true;}}if(AL[AM]==="m"&&AO){AL=AL.substring(0,AM)+"M"+AL.substring(AM+1);}}return AL;}mstrmojo.chart.common.Utility=mstrmojo.provide("mstrmojo.chart.common.Utility",{point2D:{},rect2D:{},tripleId:{create:function M(AM,AQ,AO,AN,AP){if(AM===null||AM===undefined){AM=-3;}if(AQ===null||AQ===undefined){AQ=-3;}if(AO===null||AO===undefined){AO=-3;}var AL={mObjectId:AM,mSeriesId:AQ,mGroupId:AO};if(AN!==undefined&&AN!==null){AL.angleByIndex=AN;}if(AP!==undefined&&AP!==null){AL.sliceById=AP;}return AL;},walks:function m(AP,AN){if(!!AP===false||!!AN===false){return null;}if(AP.length===1){return AN[AP[0]];}var AO=(AP&&AP.length)||0,AM,AL=AP[AM];for(AM=0;AM<AO;AM++){if(AN[AL]===undefined){AN[AL]={};}AN=AN[AL];}return AN;},equal:function b(AL,AM){return(AL.mObjectId===AM.mObjectId&&AL.mSeriesId===AM.mSeriesId&&AL.mGroupId===AM.mGroupId);},reset:function t(AN,AP,AO,AM,AL,AQ){AN.mObjectId=AP!==undefined?AP:-3;AN.mSeriesId=AO!==undefined?AO:-3;AN.mGroupId=AM!==undefined?AM:-3;if(AL!==undefined&&AL!==null){AN.angleByIndex=AL;}if(AQ!==undefined&&AQ!==null){AN.sliceById=AQ;}return AN;}},transformProperty:function A(AL,AN,AM){if(AN===0){return X.call(this,AL,AM);}return e.call(this,AL,AM);},abbreviateNumber:function c(AV,AL){var AW,AM,AX="",AO=(AV<0),AY=(this.isIntegar(AV)===false);if(AY){AL++;}if(AV<0){AL++;}var AR=AO?-AV:AV;var AS=0;if(AR>=1e+27){AR=999;AX="Y";}else{if(AR>=1e+24){AR/=1e+24;AX="Y";}else{if(AR>=1e+21){AR/=1e+21;AX="Z";}else{if(AR>=1000000000000000000){AR/=1000000000000000000;AX="E";}else{if(AR>=1000000000000000){AR/=1000000000000000;AX="P";}else{if(AR>=1000000000000){AR/=1000000000000;AX="T";}else{if(AR>=1000000000){AR/=1000000000;AX="B";}else{if(AR>=1000000){AR/=1000000;AX="M";}else{if(AR>=1000){AR/=1000;AX="K";}else{if(AR>=1){AS++;}else{if(AR>=0.001){AS++;}else{if(AR>=0.000001){AS++;}else{if(AR>=1e-9){AS++;}else{if(AR>=1e-12){AS++;}else{AO=false;}}}}}}}}}}}}}}if(this.isIntegar(AR)===false){AW=AR.toString();var AN=5,AQ=2,AZ;AM=AW.indexOf(".");AZ=AW.length-AM-1;if(AZ>AN||(AZ>AQ&&AZ>AM)){if(AZ>AN&&AL-AZ<0){AQ=Math.max(AQ,Math.min(AQ,AL-AZ));}else{AQ=Math.max(1,Math.min(AQ,AL-AZ));}AR=AR.toFixed(AQ);}}AW=AR.toString();if(this.isIntegar(AR)===false){var AU=AW.length-1;AM=AW.indexOf(".");if(AM!==-1){if(AM>=AU){AW=AW.substring(0,AM);}else{var AT,AP=true;for(AT=AU;AT>AM&&AP;--AT){if(AW[AT]!=="0"){AP=false;}}if(AP){AW=AW.substring(0,AM);}}}}if(AO){AW="-"+AW;}AW+=AX;return AW;},getScalePlate:function AH(AL){AL=AL||false;this.mScalePlate=mstrmojo.chart.common.ScalePlate;if(AL){this.mScalePlate.clear();}return this.mScalePlate;},prepareScalePlateOptions:function AE(AN,AM,AO){var AL={mUseLogarithmicScale:AN,mAlwaysIncludeZero:!AN&&(AM||!!(AO&1)||!!(AO&2)),mShowMinLabel:true,mShowMaxLabel:true,mDrawCustomLine:false,mAxisMinValue:0,mAxisMaxValue:0,mAxisCustomValue:0,mUseCustomMinMax:false};return AL;},evaluateTextMargin:function P(AL){this.mTextMargins=this.mTextMargins||{};var AM=this.mTextMargins;if(AM[AL]){return AM[AL];}var AN=[];AN[0]=Math.floor(AL*o+0.5);AN[1]=Math.floor(AL*K+0.5);AN[2]=Math.max(Math.floor(AL*R+0.5),1);AM[AL]=AN;return AN;},AlmostZero:function AA(AL){return(Math.abs(AL)<0.000001);},isValidNumber:function J(AL){if(typeof AL==="number"){if(AL===0){return true;}return !!AL;}return false;},isIntegar:function l(AL){return AL===+AL&&AL===(AL|0);},HasArrayIntersection:function O(AM,AL){var AN;for(AN=0;AN<AM.length;AN++){if(AL.indexOf(AM[AN])!==-1){return true;}}return false;},EscapeString:function C(AL){var AN='"',AM='\\"',AO=new RegExp(AN,"g");return String(AL).replace(/</g,"&lt;").replace(/>/g,"&gt;").replace(/\\/g,"\\\\").replace(AO,AM).replace(/\r\n/g,"<br/>").replace(/\r/g,"<br/>").replace(/\n/g,"<br/>");},EscapeStringForJSON:function N(AL){var AN='"',AM='\\"',AO=new RegExp(AN,"g");return String(AL).replace(/\\/g,"\\\\").replace(AO,AM).replace(/\r/g,"\\r").replace(/\n/g,"\\n");},TrimLastComma:function AG(AM){var AL;if(!AM.buf||AM.len===-1){return ;}AL=AM.len;var AN=String(AM.buf[AL]);if(AN&&AN[AN.length-1]===","){AM.buf[AL]=AN.slice(0,-1);}},decodeUTF8:function g(AL){var AM="",AO=0,AQ=0,AP=0,AN=0;while(AO<AL.length){AQ=AL.charCodeAt(AO);if(AQ<128){AM+=k(AQ);AO++;}else{if((AQ>191)&&(AQ<224)){AP=AL.charCodeAt(AO+1);AM+=k(((AQ&31)<<6)|(AP&63));AO+=2;}else{AP=AL.charCodeAt(AO+1);AN=AL.charCodeAt(AO+2);AM+=k(((AQ&15)<<12)|((AP&63)<<6)|(AN&63));AO+=3;}}}return AM;},formatDateTimeValue:function f(AM,AR){var AP=new mstrmojo.chart.common.DSSDateTime({ifTime:AR});var AL="";var AO="";var AS=0;while(AS<AM.length){var AN=1;switch(AM.charAt(AS)){case"[":AS++;while(AS<AM.length&&AM.charAt(AS)!=="]"){AO+=AM.charAt(AS);AS++;}if(AO.length>0&&(AO[0]===">"||AO[0]==="<"||AO[0]==="=")){AO="";}AS++;break;case"y":AS++;while(AS<AM.length&&AM.charAt(AS)==="y"){AN++;AS++;if(AN===4){break;}}if(AN===1||AN===2){AL+=this.fillZeroToWidth(AP.mnYear%100,2);}else{if(AN===3){AL+=this.fillZeroToWidth(AP.mnYear%100,2);AS--;}else{if(AN===4){AL+=AP.mnYear;}}}break;case"M":AS++;while(AS<AM.length&&AM.charAt(AS)==="M"){AN++;AS++;}if(AN<3){AL+=this.fillZeroToWidth(AP.mnMonth,AN);}else{if(AN===3){AL+=AF.MONTHNAME_SHORT[AP.mnMonth];}else{AL+=AF.MONTHNAME_FULL[AP.mnMonth];}}break;case"d":AS++;while(AS<AM.length&&AM.charAt(AS)==="d"){AN++;AS++;}if(AN<3){AL+=this.fillZeroToWidth(AP.mnDay,AN);}else{if(AN===3){AL+=AF.dayShortNames[AP.mnDay];}else{AL+=AF.dayNames[AP.mnDay];}}break;case"h":AS++;while(AS<AM.length&&AM.charAt(AS)==="h"){AN++;AS++;}var AQ=AP.mnHour;if(AQ===0){AQ=12;}if(AQ>12){AQ-=12;}AL+=this.fillZeroToWidth(AQ,AN);break;case"H":AS++;while(AS<AM.length&&AM.charAt(AS)==="H"){AN++;AS++;}AL+=this.fillZeroToWidth(AP.mnHour,AN);break;case"m":AS++;while(AS<AM.length&&AM.charAt(AS)==="m"){AN++;AS++;}AL+=this.fillZeroToWidth(AP.mnMinute,AN);break;case"s":AS++;while(AS<AM.length&&AM.charAt(AS)==="s"){AN++;AS++;}AL+=this.fillZeroToWidth(AP.mnSecond,AN);break;case"S":AS++;while(AS<AM.length&&AM.charAt(AS)==="S"){AN++;AS++;}AL+=this.fillZeroToWidth(AP.mnMillisecond,AN);break;case"a":AQ=AP.mnHour;if(AQ<12){AL+=AF.AM_NAME;}else{AL+=AF.PM_NAME;}AS++;break;default:AL+=AM.charAt(AS++);break;}}if(AO.length!==0){AL='<SPAN STYLE="COLOR: '+AO+'" >'+AL+"</SPAN>";}return AL;},fillZeroToWidth:function n(AP,AN){var AM="",AO=AM+AP;var AL=AO.length;while(AL<AN){AO="0"+AO;AL++;}return AO;},updateCache:function AJ(AM,AP,AQ){var AO=(AP&&AP.length)||0,AN,AL,AR=AM;for(AN=0;AN<AO-1;AN++){AL=AP[AN];if(!AR[AL]){AR[AL]={};}AR=AR[AL];}AR[AP[AO-1]]=AQ;},measureTextHeight:function(AQ,AN,AU,AR,AL){var AT,AP=AQ;if(AP===" "){AP="\u00A0";}AL=AL||"pt";if(typeof AU==="number"){AU=AU+AL;}var AM="none",AS="normal";if(AR&E.FS_ITALIC){AM="italic";}if(AR&E.FS_BOLD){AS="bold";}var AO={fontFamily:AN,fontSize:AU,fontStyle:AM,fontWeight:AS};if(j&&j.H&&j.H[AN]&&j.H[AN][AU]&&j.H[AN][AU][AR]){AT=j.H[AN][AU][AR];}else{AT=q.measureTextHeight("H",AO,1);this.updateCache(j,["H",AN,AU,AR],AT);}return AT;},measureText:function x(AS,AP,AY,AT,AN){var AM=true,AL,AW=AY+1;var AR=AS;if(AR===" "){AR="\u00A0";}AN=AN||"pt";if(typeof AY==="number"){AY=AY+AN;}if(B&&B[AR]&&B[AR][AP]&&B[AR][AP][AY]&&B[AR][AP][AY][AT]){return B[AR][AP][AY][AT];}if(AM){var AO="normal",AU="normal";if(AT&E.FS_ITALIC){AO="italic";}if(AT&E.FS_BOLD){AU="bold";}var AQ={fontFamily:AP,fontSize:AY,fontStyle:AO,fontWeight:AU};if(j&&j.H&&j.H[AP]&&j.H[AP][AY]&&j.H[AP][AY][AT]){AW=j.H[AP][AY][AT];}else{AW=q.measureTextHeight("H",AQ,true);this.updateCache(j,["H",AP,AY,AT],AW);}AL=q.measureTextWidth(AS,AQ,0);}else{if(!L){var AV=document.createElement("div");AV.id="measureText";AV.style.position="absolute";AV.style.top="0";AV.style.visibility="hidden";AV.style.height="auto";AV.style.width="auto";document.body.appendChild(AV);L=AV;}L.innerHTML="";L.appendChild(document.createTextNode(AR));L.style.fontFamily=AP;L.style.fontSize=AY;L.style.fontWeight="normal";L.style.fontStyle="none";if(AT&E.FS_ITALIC){L.style.fontStyle="italic";}if(AT&E.FS_BOLD){L.style.fontWeight="bold";}AL=L.scrollWidth+1;AW=L.scrollHeight+1;}var AX={Width:AL,Height:AW};this.updateCache(B,[AR,AP,AY,AT],AX);return AX;},ReplaceDecimalPoint:function AD(AM,AL){return AM.replace(".",AL);},ReplaceMinusSign:function v(AL,AM){return AL.replace("-",AM);},insert:function G(AM,AL,AN){if(typeof AM==="string"&&typeof AL==="string"&&AN<=AM.length){return AM.substr(0,AN)+AL+AM.substr(AN);}return AM;},InsertThousandSeparator:function u(AN,AO,AS){var AL=AS.mstrDecimalPoint;var AM=AN.indexOf(AL);if(AM===-1){AM=AN.length;}var AP=0;while(AP<AM&&!this.chk_val(AN.charAt(AP))){AP++;}var AR=AN;var AQ;for(AQ=AM-3;AQ>AP;AQ-=3){AR=this.insert(AR,AO,AQ);}return AR;},chk_val:function I(AL){return/^\d+$/.test(AL);},hFormatValue:function a(AY,AP,Aj,A8){var AW=0;var Ar=0;var Af=AY.length;var BG=false;if(!A8){A8={};var Ap=window.navigator.userLanguage||window.navigator.language;var BR=Ap.split("-");this.mstrLanguageCode=BR[0];this.mstrCountryCode=BR[1]||BR[0];A8.mstrThousandSeparator=mstrmojo.locales.number.THOUSANDSEPARATOR||",";A8.mstrCurrencySymbol="$";A8.mstrDecimalPoint=mstrmojo.locales.number.DECIMALSEPARATOR||".";A8.mstrPercentSign="%";A8.mstrMinusSign="-";}while(AW<Af){if(AY.charAt(AW)==='"'){AW++;while(AW<Af&&AY.charAt(AW)!=='"'){AW++;}AW++;}else{if(AY.charAt(AW)==="["){AW++;var Aq="";while(AW<Af&&AY.charAt(AW)!=="]"){Aq+=AY.charAt(AW);AW++;}if(Aq.length>1&&(Aq.charAt(0)===">"||Aq.charAt(0)==="<"||Aq.charAt(0)==="=")){var AM=-1;var BA=0;switch(Aq.charAt(0)){case">":if(Aq.charAt(1)>="0"&&Aq.charAt(1)<="9"){AM=1;BA=1;}else{if(Aq.charAt(1)==="="&&Aq.length>2&&Aq.charAt(2)>="0"&&Aq.charAt(2)<="9"){AM=2;BA=2;}}break;case"=":if(Aq.charAt(1)>="0"&&Aq.charAt(1)<="9"){AM=3;BA=1;}else{if(Aq.charAt(1)==="="&&Aq.length>2&&Aq.charAt(2)>="0"&&Aq.charAt(2)<="9"){AM=3;BA=2;}}break;case"<":if(Aq.charAt(1)>="0"&&Aq.charAt(1)<="9"){AM=5;BA=1;}else{if(Aq.charAt(1)==="="&&Aq.length>2&&Aq.charAt(2)>="0"&&Aq.charAt(2)<="9"){AM=4;BA=2;}}break;}if(AM>0){var Aa=Aq.substr(BA);var BJ=parseFloat(Aa);if((AM===1&&AP>BJ)||(AM===2&&AP>=BJ)||(AM===3&&AP===BJ)||(AM===4&&AP<=BJ)||(AM===5&&AP<BJ)){BG=true;}return mstrmojo.num.formatByMask(AY,AP);}}}else{if(AY.charAt(AW)===";"){if(BG){Af=AW;break;}else{Ar=AW+1;AW++;}}else{AW++;}}}}if(!BG){Ar=0;}AW=Ar;var Aw=false;while(AW<Af){if(AY.charAt(AW)==='"'){AW++;while(AW<Af&&AY.charAt(AW)!=='"'){AW++;}}else{if(AY.charAt(AW)==="["){AW++;while(AW<Af&&AY.charAt(AW)!=="]"){AW++;}}else{if(AY.charAt(AW)==="y"||AY.charAt(AW)==="M"||AY.charAt(AW)==="d"||AY.charAt(AW)==="h"||AY.charAt(AW)==="H"||AY.charAt(AW)==="m"||AY.charAt(AW)==="s"||AY.charAt(AW)==="S"){Aw=true;break;}else{AW++;}}}}if(Aw){var BE="";if(BG){BE=AY.substr(Ar,Af-Ar);}else{BE=AY;}return mstrmojo.num.formatByMask(BE,AP);}var BI;var An;var At=false;var AS=false;var BD=false;var Ae=false;var BO=[];var Ai="";var Ab=0;var A9=false;var AZ=0;var BP="";var AT="";var Am="";var A7="";var AX=0;var BL=0;var BK=false;var BB=A8.mstrCurrencySymbol;var A2=A8.mstrThousandSeparator;var Ay=A8.mstrDecimalPoint;var BC=A8.mstrPercentSign;var A6=A8.mstrMinusSign;AW=Ar;var Al="";if(AP<0&&!BG){while(AW<Af&&AY.charAt(AW)!==";"){if(AY.charAt(AW)==='"'){AW++;while(AW<Af&&AY.charAt(AW)!=='"'){AW++;}}AW++;}AW++;if(AW>=Af){if(AP<0){BP+="-";}AW=Ar;}}var BQ=false;while(AW<Af){var As=false;switch(AY.charAt(AW)){case"[":AW++;while(AW<Af&&AY.charAt(AW)!=="]"){Am+=AY.charAt(AW);AW++;}if(Am.length>0&&(Am.charAt(0)===">"||Am.charAt(0)==="<"||Am.charAt(0)==="=")){Am="";}AW++;break;case'"':AW++;while(AW<Af&&AY.charAt(AW)!=='"'){if(BQ){AT+=AY.charAt(AW);}else{BP+=AY.charAt(AW);}AW++;}AW++;break;case"#":case"0":var Ad=AY.charAt(AW);BQ=true;var Ah=1;AW++;while(AW<Af&&AY.charAt(AW)===Ad){Ah++;AW++;}if(AW+1<Af&&AY.charAt(AW)==="-"&&AY.charAt(AW+1)===Ad){Ae=true;BO.push(Ah);AW++;while(true){Ah=0;while(AW<Af&&AY.charAt(AW)===Ad){Ah++;AW++;}BO.push(Ah);if(AW>=Af||AY.charAt(AW)!=="-"){break;}AW++;}}while(AW<Af){if(AY.charAt(AW)===","){if(AW+1<Af&&AY.charAt(AW+1)===Ad){At=true;}else{break;}}else{if(AY.charAt(AW)!==Ad){break;}}AW++;}break;case".":BQ=true;AW++;Ab=0;while(AW<Af&&AY.charAt(AW)==="0"){Ab++;AW++;}if(Ab===0){while(AW<Af&&AY.charAt(AW)==="#"){Ab++;AW++;}}break;case"E":BL=6;while(AW<Af&&AY.charAt(AW)!=="0"){if(AY.charAt(AW)==="+"&&AW<Af&&AY.charAt(AW+1)==="0"){AS=true;}else{A7+=AY.charAt(AW);}AW++;}AX=0;while(AW<Af&&AY.charAt(AW)==="0"){AX++;AW++;}break;case"%":BL=4;AW++;break;case"(":AW++;BP+="(";break;case")":AW++;AT+=")";break;case"-":AW++;if(AP<0){BP+=A6;}break;case"?":AW++;break;case"/":if(AW>Ar&&AY.charAt(AW-1)==="?"&&AW+1<Af&&AY.charAt(AW+1)==="?"){BL=5;A9=false;An=AW-1;while(An>Ar&&AY.charAt(An)==="?"){An--;}while(An>Ar&&AY.charAt(An)===" "){An--;}if(An>=Ar&&(AY.charAt(An)==="#"||AY.charAt(An)==="0")){A9=true;}AZ=0;AW++;while(AW<Af&&AY.charAt(AW)==="?"){AZ++;AW++;}}else{AW++;}break;case",":if(AW>Ar&&(AY.charAt(AW-1)==="0"||AY.charAt(AW-1)==="#")){BD=true;AW++;}An=AW+1;while(An<Af){if(AY.charAt(An)===","){An++;continue;}else{break;}}if(An===Af||AY.charAt(An)==="."){BK=true;}if(BK||(!BK&&AW+1<Af&&AY.charAt(AW+1)===",")){while(AW<Af&&AY.charAt(AW)===","){AP/=1000;AW++;}AW--;}AW++;break;case";":As=true;break;case"$":if(BQ){AT+=BB;}else{BP+=BB;}AW++;break;case"_":if(BQ){AT+=" ";}else{BP+=" ";}AW++;AW++;break;default:if(BQ){AT+=AY.charAt(AW);}else{BP+=AY.charAt(AW);}AW++;}if(As){break;}}if(AP<0){AP=-AP;if(BP.length===0){BP=A6;}}var A0="";if(Ae){var Av=0;for(BI=0;BI<BO.length;BI++){Av+=BO[BI];}A0=Al=this.fillZeroToWidth(Av,AP.toFixed());for(BI=0;BI<BO.length-1;BI++){Av-=BO[BI];var Au=A0.length-Av;A0=A0.slice(0,Au)+"-"+A0.slice(Au);}}else{switch(BL){case 0:if(BD){AP/=1000;}var A4=AP;if(A4<0){A4=-A4;}var AL=0;while(A4>=10){A4/=10;AL++;}if(AL>=15){A0=Al=this.fillZeroToWidth((AP<0?-AP:AP),10);var Ao=A0.indexOf(".");if(Ao!==-1){A0=A0.slice(0,Ao)+A0.slice(Ao+1);}A0=A0.substr(0,16);if(A0.charAt(15)>="5"){var AV=14;while(AV>=0&&A0.charAt(AV)==="9"){A0=A0.slice(0,AV)+"0"+A0.slice(AV+1);AV--;}var AQ=A0.charAt(AV);AQ++;if(AV>=0){A0=A0.slice(0,AV)+AQ+A0.slice(AV+1);}else{A0="1"+A0;}}A0=A0.substr(0,15);var BH;for(BH=AL-14;BH>0;BH--){A0+="0";}if(AP<0){A0=A6+A0;}}else{Al+=(AP+Math.pow(0.1,Ab+6)).toFixed(Ab);A0=Al;A0=this.ReplaceDecimalPoint(A0,Ay);if(AP<0){A0=this.ReplaceMinusSign(A0,A6);}}if(At){A0=this.InsertThousandSeparator(A0,A2,A8);}if(BD){A0+=Ai;}break;case 5:if(BD){AP/=1000;}var Ak=10;for(BI=1;BI<AZ;BI++){Ak*=10;}var AN={numerator:0,denominator:1};var AU={numerator:1,denominator:1};var AR={numerator:1,denominator:2};var Az={numerator:0,denominator:1};var Ag=AP>=0;var A5=Math.abs(AP);var A3=parseInt(A5,10);A5-=A3;while(AR.denominator<Ak){if(Math.abs(AI.call(AR)-A5)<1e-15){Az=AR;break;}if(AI.call(AR)>A5){AU=AR;}else{AN=AR;}AR.denominator=AN.denominator+AU.denominator;AR.numerator=AN.numerator+AU.numerator;}if(AR.denominator>=Ak){if(A5-AI.call(AN)<AI.call(AU)-A5){Az=AN;}else{Az=AU;}}if(A3>0){Az.numerator+=A3*Az.denominator;}if(Az.denominator===0){A9=false;}var BF=false;var A1=false;var BN=Az.numerator;if(A9){A3=Math.floor(Az.numerator/Az.denominator);BN=Az.numerator%Az.denominator;A1=A1||(BN!==0);if(A3>0){BF=true;Al+=A3;if(A1){Al+=" ";}}}if(!A1&&!BF&&BN===0){Al+="0";}else{if(!A1&&BF&&BN===0){AK++;}else{Al+=BN;Al+="/";Al+=Az.denominator;}}A0=Al;if(!Ag){A0=A6+A0;}if(At){A0=this.InsertThousandSeparator(A0,A2,A8);}if(BD){A0+=Ai;}break;case 4:AP*=100;Al+=(AP+Math.pow(0.1,Ab+6)).toFixed(Ab);A0=Al;A0=this.ReplaceDecimalPoint(A0,Ay);if(AP<0){A0=this.ReplaceMinusSign(A0,A6);}if(At){A0=this.InsertThousandSeparator(A0,A2,A8);}A0+=BC;break;case 6:var Ax=AP;var BM=0;if(Ax>1){while(Ax>=10){Ax/=10;BM++;}}else{if(Ax!==0){while(Ax<1){Ax*=10;BM--;}}}Al+=(Ax+Math.pow(0.1,Ab+6)).toFixed(Ab);Al+=A7;if(AS&&BM>=0){Al<<"+";}if(BM<0){Al<<"-";BM=-BM;}Al+=this.fillZeroToWidth(BM,AX);A0=Al;A0=this.ReplaceDecimalPoint(A0,Ay);if(AP<0){A0=this.ReplaceMinusSign(A0,A6);}break;}}var AO=BP+A0+AT;var Ac=false;if(Am.length!==0&&Ac){AO='<SPAN STYLE="COLOR: '+Am+'" >'+AO+"</SPAN>";}return AO;}});}());(function(){mstrmojo.requiresCls("mstrmojo.vi.ui.rw.selectors.Slider","mstrmojo.vi.ui.rw.selectors.SliderHelper","mstrmojo.hash","mstrmojo.dom","mstrmojo.tooltip","mstrmojo.css","mstrmojo.VisUtility");var C=mstrmojo.hash,E=mstrmojo.dom,F=mstrmojo.css,G=mstrmojo.VisUtility;mstrmojo.mapbox.ui.selectors.OveralZoomSlider=mstrmojo.declare(mstrmojo.vi.ui.rw.selectors.Slider,null,{scriptClass:"mstrmojo.mapbox.ui.selectors.OveralZoomSlider",thumbWidth:3,cssBkBW:0,sliderDefaultWidth:140,multiSelect:true,disableDnD:false,worldLabel:mstrmojo.desc(8173,"World"),stateLabel:mstrmojo.desc(7676,"State"),cityLabel:mstrmojo.desc(7675,"City"),streetLabel:mstrmojo.desc(13821,"Street"),verticalLineHeight:"0px",markupString:'<div class="mstrmojo-VISlider mstrmojo-Slider {@cssClass} {@clsOrientation} mapbox-overal-zoom-slider" style="{@cssText}" ><div class="sl-title"></div><div class="sl-control"></div><div class="cont" style="position:relative;margin-top:21px;margin-bottom:10px"><div class="bk" style="{@bkCssText}"><div class="ruler" ></div><div class="ruler-label" >{@worldLabel}</div><div class="ruler-gap" ></div><div class="ruler" ></div><div class="ruler-label" >{@stateLabel}</div><div class="ruler-gap" ></div><div class="ruler" ></div><div class="ruler-label" >{@cityLabel}</div><div class="ruler-gap" ></div><div class="ruler" ></div><div class="ruler-label" >{@streetLabel}</div></div><div class="sdc" style="position:absolute;{@sdcCssText}"><div class="sd" style="{@sdCssText}" mstrAttach:click><div class="bk left" style="{@lowerRangeCssText}"></div><div class="t1" style="{@handle1CssText}" mstrAttach:mouseout></div><div class="bk middle" style="{@thumbCssText}"></div><div style="{@handel2CssText}"><div class="t3" mstrAttach:mouseout></div><div class="vertical-line" style="height:{@verticalLineHeight}"></div></div><div class="bk right" style="{@upperRangeCssText}"></div></div></div><div class="mstrmojo-Label subscript left">{@lowText}</div><div class="mstrmojo-Label subscript right">{@highText}</div></div></div>',markupSlots:{titleNode:function(){return this.domNode.firstChild;},controlNode:function(){return this.domNode.childNodes[1];},dndNode:function(){return this.domNode.childNodes[2];},bgNode:function(){return this.domNode.childNodes[2].firstChild;},sdcNode:function(){return this.domNode.childNodes[2].childNodes[1];},containerNode:function(){return this.domNode.childNodes[2].childNodes[1].firstChild;},lowerRange:function(){return this.domNode.childNodes[2].childNodes[1].firstChild.firstChild;},handle1Node:function(){return this.domNode.childNodes[2].childNodes[1].firstChild.childNodes[1];},thumbNode:function(){return this.domNode.childNodes[2].childNodes[1].firstChild.childNodes[2];},handle2NodeContainer:function(){return this.domNode.childNodes[2].childNodes[1].firstChild.childNodes[3];},handle2Node:function(){return this.domNode.childNodes[2].childNodes[1].firstChild.childNodes[3].firstChild;},upperRange:function(){return this.domNode.childNodes[2].childNodes[1].firstChild.lastChild;},lowNode:function(){return this.domNode.childNodes[2].childNodes[2];},highNode:function(){return this.domNode.childNodes[2].childNodes[3];},tooltipNode:function(){return[this.domNode.childNodes[2].childNodes[1].firstChild.childNodes[1],this.domNode.childNodes[2].childNodes[1].firstChild.childNodes[3]];}},markupMethods:{onvisibleChange:mstrmojo.Widget.visibleMarkupMethod,onenabledChange:mstrmojo.Widget.enabledMarkupMethod,onwidthChange:function(){this.synchronizeSlider();},onmultiSelectChange:function(){F.toggleClass(this.domNode,"scm",this.multiSelect);F.toggleClass(this.domNode,"sc1",!this.multiSelect);},oncurrentZoomLevelChange:function(){var N=this.typeHelper,O;this.cs2Idx=this.getIndexByValue(this.currentZoomLevel);O=this.items[this.cs2Idx];if(O){this.cs2Vl=O.v;this.cs2Nm=O.n;}if(N&&N.updateThumb){N.updateThumb();}}},init:function M(P){P=C.copy(P,{isHoriz:true,multiSelect:true,min:0,max:22});if(!P.baseLayer){throw new Error(this.scriptClass+" must be initialized with baseLayer.");}if(!P.items||!P.getIndexByValue){throw new Error(this.scriptClass+" must be initialized with items and getIndexByValue function.");}P.currentZoomLevel=P.baseLayer.getZoom();var N=P.getIndexByValue(P.currentZoomLevel),O={0:true};if(!P.multiSelect){P.selectedIndex=N;}else{O[N]=true;P.selectedIndices=O;}this._super(P);if(P.baseLayer){this.zoomLevelChangeListener=P.baseLayer.attachEventListener("zoomLevelChanged",this.id,function(Q){this.set("currentZoomLevel",Q.zoomLevel);});}},synchronizeSlider:function D(){this._super();if(!this.hasRendered){return ;}var N=[0,5,9,14,22],O=parseFloat(this.width)/2,Z=this._effectiveLength/22,X=this.bgNode,a=X.children,R,S,P=F.getComputedStyle(a[1]),Q={fontFamily:P.fontFamily,fontSize:P.fontSize,fontStyle:P.fontStyle,fontWeight:P.fontWeight},Y=parseFloat(P.paddingLeft)+parseFloat(P.paddingRight),V,U,W=false;for(R=0;R<4;R++){S=Math.round((R===0?0:this.thumbWidth/2)+N[R]*Z)+"px";if(R!==0){a[3*R-1].style.left=S;}V=Math.round((N[R+1]-N[R])*Z+(R===0||R===3?this.thumbWidth/2:0));a[3*R+1].style.left=S;a[3*R+1].style.width=V+"px";U=G.measureTextWidth(a[3*R+1].innerText,Q,Y);if(!W){W=U>V;}a[3*R].style.left="0px";a[3*R].style.width=Math.round((N[R+1]-N[0])*Z+(R===3?this.thumbWidth:this.thumbWidth/2))+"px";}if(W){F.toggleClass(a[1],"left",true);a[1].style.width=O+"px";F.toggleClass(a[4],"hide",true);F.toggleClass(a[7],"hide",true);F.toggleClass(a[10],"right",true);a[10].style.width=O+"px";a[10].style.left=O+"px";}else{F.toggleClass(a[1],"left",false);F.toggleClass(a[4],"hide",false);F.toggleClass(a[7],"hide",false);F.toggleClass(a[10],"right",false);}},updateTypeHelper:function B(){var N=C.walk("mapbox.ui.selectors.OveralSliderHelper",mstrmojo);this.typeHelper=new N({slider:this});},createGhost:function J(N){var O=this._super(N);O.handle2NodeContainer=O.handle2Node;O.handle2Node=O.handle2NodeContainer.firstChild;return O;},initDrag:function L(O,N){if(this.enabled&&!this.disableDnD){this._super(O,N);}},_updateTooltip:function I(V,S){var P=E.eventTarget(S,V),R,Z,Y,W,O=null,X=null,U='<div class="name">{@content}</div>',N='<div class="dsc">{@description}</div>',b,a=false,Q=this.dnd.initD!==null;switch(P){case this.handle2Node:R=Q?String(this.cs2Nm).replace("$","$$$$"):Number(this.currentZoomLevel).toFixed(4);Y=mstrmojo.tooltip.POS_BOTTOMLEFT;W="vi-tooltip-V ";X=0;O=-4;a=true;break;default:break;}if(a&&this.enabled){b={cssClass:"mstrmojo-VISlider vi-regular "+W+mstrApp.getThemeClassName(),content:U.replace(/\{@content\}/g,R)+(Z&&Z.length>0?N.replace(/\{@description\}/g,Z):""),contentNodeCssClass:"scm-tooltip",refNode:P,posType:Y,left:O,top:X};this.set("richTooltip",b);}},destroy:function H(N){if(this.baseLayer){if(this.zoomLevelChangeListener){this.baseLayer.detachEventListener(this.zoomLevelChangeListener);}delete this.baseLayer;}this._super(N);}});mstrmojo.mapbox.ui.selectors.OveralSliderHelper=mstrmojo.declare(mstrmojo.vi.ui.rw.selectors.SliderHelper,null,{scriptClass:" mstrmojo.mapbox.ui.selectors.OveralSliderHelper",updateSummary:function K(){},updateHandleNodeStyle:function A(R,N,Q,O,P){R.handle1Node.style[N]=Q+P;R.handle2NodeContainer.style[N]=O+P;}});}());(function(){mstrmojo.requiresCls("mstrmojo.array","mstrmojo.chart.model.enums.EnumDSSObjectType","mstrmojo.VisUtility","mstrmojo.vi.viz.EnumVizStyles");mstrmojo.requiresClsP("mstrmojo.vi.viz","VisualizationTransition","EnumDSSDropZones","NetworkVisualizationHelper");var V=mstrmojo,I=V.array,U=V.vi.viz,L=V.VisUtility,B=U.KnownVisualizations,P=V.chart.model.enums,N=P.EnumDSSObjectType,C=N.DssTypeMetric,A=mstrmojo.vi.viz.EnumVizStyles,F=["#CC2525","#E34B4B","#E97D7D","#79D479","#57BA57","#2CA02C"],K=[0.1,0.3,0.5,0.7,0.9];function G(Y,a,X){var Z=[];I.forEach(Y,function(b){I.forEach(a,function(c){if((b.id===c.did)||(b.did===c.did)){if((X&&(c.t===C))||(!X&&(c.t!==C))){Z.push(c);return false;}}});});return Z;}function E(Y,X){var Z=[];I.forEach(Y,function(a){var b=false;I.forEach(X,function(c){if(a.id===c.id){b=true;return false;}});if(!b){Z.push(a);}});return Z;}function H(X,Y){if(X&&X.ColorBy&&X.ColorBy.TemplateMetric){return G(X.ColorBy.TemplateMetric,Y,true);}return[];}function M(X,Y){if(X&&X.SizeBy&&X.SizeBy.TemplateMetric){return G(X.SizeBy.TemplateMetric,Y,true);}return[];}function S(X){return(X&&X.TemplateUnit)||[];}function O(X){return(X&&X.TemplateMetric)||[];}function W(X,a,c){var b=[],Y=0,Z;I.forEach(X,function(d){if(Y===c){Z=b.length;}Y++;if(d instanceof Array){b=b.concat(d);}else{if(a==="attribute"){b=b.concat(S(d));}else{b=b.concat(O(d));}}});if(a==="attribute"){return b;}return{metrics:b,idx:Z};}function J(a,d){var c=a.node.data,j=c.visName;if(j===A.ESRI_MAP||j===A.GOOGLE_MAP||j===A.MAPBOX){var Y=a.getTopLayerHost();c=Y.node.data;}var e=c.gsi,h=c.dz,g,X=(e.rows||[]).concat(e.cols||[]);switch(j){case A.GRAPH_MATRIX:var f=S(h.ColorBy),b=E(S(h.SliceBy),f),Z=E(S(h.BreakBy),f);g=W([b,h.Rows,h.YAxis,h.Columns,h.XAxis,f,Z],"attribute");break;case A.HEAT_MAP:g=W([h.Grp],"attribute");break;case A.ESRI_MAP:case A.GOOGLE_MAP:case A.MAPBOX:g=W([h.Geo,h.Lat,h.Long,h.AdditionalMetrics],"attribute");break;}if(g&&g.length>0){g=G.call(this,g,X,false);}else{g=X;}I.forEach(g,function(k){if(k.t!==N.DssTypeMetric&&k.t!==N.DssTypeDimension&&k.did!=="-1"){d.fromItemAttribute=k;return false;}});I.forEach(g,function(k){if(k.t!==N.DssTypeMetric&&k.t!==N.DssTypeDimension&&k.did!=="-1"&&k.did!==d.fromItemAttribute.did){d.toItemAttribute=k;return false;}});}function D(Z,f,c,Y){var d=Z.node.data,m=d.visName;if(m===A.ESRI_MAP||m===A.GOOGLE_MAP||m===A.MAPBOX){var X=Z.getTopLayerHost();d=X.node.data;}var l=d.dz,k=d.gsi.mx||[],j,e,b;k.forEach(function(n){n.t=4;});var h=H.call(this,l,k);if(h.length>0){f.edgeColorMetric=h[0];h=h.slice(1);}var a=M.call(this,l,k);switch(m){case A.GRAPH_MATRIX:case A.NEW_GRAPH_MATRIX:e=W([l.AngleBy,l.Rows,l.YAxis,l.Columns,l.XAxis,h,a,l.AdditionalMetrics],"metric",6);break;case A.HEAT_MAP:if(a.length>0){f.edgeSizeMetric=a[0];}e=W([l.AdditionalMetrics],"metric");var g=G.call(this,e.metrics,k,true);if(!f.edgeColorMetric){if(g.length>0){f.edgeColorMetric=g[0];if(g.length>1){f.nodeSizeMetric=g[1];}}}else{if(g.length>0){f.nodeSizeMetric=g[0];}}return ;case A.ESRI_MAP:case A.GOOGLE_MAP:case A.MAPBOX:e=W([h,a,l.AdditionalMetrics],"metric",1);break;default:j=k;break;}if(e){b=e.idx;j=e.metrics;}if(j&&j.length>0){j=G.call(this,j,k,true);}else{if(!l||!l.ColorBy){j=k;}}if(!f.edgeColorMetric&&j&&j[0]){f.edgeColorMetric=j[0];j=j.slice(1);b--;}if(a.length>0){f.nodeSizeMetric=a[0];if(b>=0){j=j.slice(0,b).concat(j.slice(b+1));}}if(!j&&d.visName&&B.getDefinition(d.visName).id===B.UNKNOWN){f.edgeColorMetric=null;f.nodeSizeMetric=null;f.edgeSizeMetric=null;j=k;}j.forEach(function(n){if(!f.nodeSizeMetric){f.nodeSizeMetric=n;}else{if(!f.edgeSizeMetric){f.edgeSizeMetric=n;}}});if(f.edgeColorMetric){this.addThresholds(Z.node,f.edgeColorMetric,Y,F,K);}}function R(b,c,Y,a){var X=new U.NetworkVisualizationHelper({node:b.node});J.call(this,b,X);D.call(this,b,X,Y,a);var Z=X.getAddDropZonesAction();Z.actions=Y.concat(Z.actions).concat(a);if(Z.actions.length){c.push(Z);}return{wp:X.getXml(),handled:false};}mstrmojo.vi.viz.NetworkVisualizationTransition=mstrmojo.declare(mstrmojo.vi.viz.VisualizationTransition,null,{scriptClass:"mstrmojo.vi.viz.NetworkVisualizationTransition",transitionDropZones:function Q(c,f){var Z=this.vis,b=Z.node,d=b.data,g=d.visName||"Grid",a=[],Y=[],e=L.getPropertyByPath(Z,"node.data.gsi.thresholds");if(g===B.GOOGLEMAP||g===B.ESRIMAP||g===B.MAPBOX){var X=Z.getTopLayerHost();e=L.getPropertyByPath(X,"data.gsi.thresholds");}this.clearImageThreshold(e,Y);if(B.getDefinition(g).id!==B.NETWORK){return R.call(this,Z,c,a,Y);}return{wp:"",handled:false};}});}());(function(){mstrmojo.requiresClsP("mstrmojo.chart.model.enums","EnumDSSObjectType","EnumDSSAxisName");mstrmojo.requiresCls("mstrmojo.hash","mstrmojo.array","mstrmojo.VisUtility");mstrmojo.requiresClsP("mstrmojo.vi.viz","KnownVisualizations","EnumVisualizationTemplates","VisualizationTransition","HeatMapVisualizationHelper","NetworkVisualizationHelper","ImageLayoutHelper","MapHelper");var b=mstrmojo,N=b.hash,J=b.array,a=b.vi.viz,B=a.KnownVisualizations,R=b.chart.model.enums,P=R.EnumDSSObjectType,G=R.EnumDSSAxisName,K="Grid",L=b.VisUtility,Y=[0.1,0.3,0.5,0.7,0.9],I=["#CC2525","#E34B4B","#E97D7D","#79D479","#57BA57","#2CA02C"];function C(d){var g=N.copy(d.data.gsi),e=g.tma===1?"rows":"cols",c=g[e],f=g.mx;g[e]=c.filter(function(h){return h.t!==-1&&h.did!=="-1";});if(f){f.forEach(function(h){h.t=4;});}return g;}function A(c){return c.did==="-1"||c.t===4;}function X(f,e,h,c,g){var d=e.getAddDropZonesAction();if(e.colorBy.length>0){var j=e.colorBy[0];if(A(j)){this.addThresholds(f,j,g,I,Y);}}d.actions=c.concat(d.actions).concat(g);if(d.actions.length){h.push(d);}return e.getXml();}function Z(g,d,k){var f,c,h=k.rows,e=k.cols;for(f=0,c=h.length;f<c;f++){var j=h[f];if(A(j)){d.push({act:"pivot",axis:G.DssAxisColumns,unitPos:e.length});}else{if(j.t!==P.DssTypeMetric&&!A(j)){g.groupingObjects.push(j);}}}}function M(g,h){var f,c,e=h.cols;for(f=0,c=e.length;f<c;f++){var d=e[f];if(d.t!==P.DssTypeMetric&&!A(d)){g.groupingObjects.push(d);}}}function V(f,e,c){var d=[],j=new a.HeatMapVisualizationHelper({node:e}),g,m=C(e);Z(j,d,m);M(j,m);var k=m.mx,n=m.rows,l=[];var h=new mstrmojo.threshold.ThresholdModel({});h.set("data",N.clone(e.data));h.objectType=e.defn.t;if(!N.isEmpty(m.thresholds)){l=J.filter(k,function(o){if(Object.keys(m.thresholds).indexOf(o.did)>-1){h.metricId=o.did;return !h.isAdvanced(o.did);}});}if(l.length===0){if(n.length>0){j.colorBy.push(n[n.length-1]);}if(k.length>0){j.sizeByMetric=k[0];}}else{j.colorBy.push(l[0]);j.sizeByMetric=k.length===1?k[0]:(k[0].did===l[0].did?k[1]:k[0]);}for(g=1;g<k.length;g++){if((j.sizeByMetric&&k[g].did!==j.sizeByMetric.did)&&(j.colorBy[0]&&k[g].did!==j.colorBy[0].did)){j.tooltipMetrics.push(k[g]);}}return X.call(this,e,j,f,d,c);}function U(h,g){var e,d,f=h.mx,c;if(f.length>0){for(e=0,d=f.length;e<d;e++){c=f[e];if(g.colorBy.length===0){g.colorBy.push(c);}else{if(!g.sizeByMetric){if(c.t===P.DssTypeMetric){g.sizeByMetric=c;}}else{if((c.did!==g.sizeByMetric.did)&&(c.did!==g.colorBy[0].did)&&c.t===P.DssTypeMetric){g.tooltipMetrics.push(c);}}}}}}function E(c,f,d,e){J.forEach(c,function(g){J.forEach(f[g],function(h){if(!A(h)){d.groupingObjects.push(h);}else{if(!d.sizeByMetric&&!e){d.sizeByMetric=h;}else{d.tooltipMetrics.push(h);}}});});}function F(c){var d=c.groupingObjects.length;if(c.colorBy.length===0&&d>0){c.colorBy.push(c.groupingObjects[d-1]);}}function O(j,g,h){var d=[],f=new a.HeatMapVisualizationHelper({node:g}),c=new a.NetworkVisualizationHelper({node:g});c.setData(g.data.dz);var k=f.groupingObjects;if(c.fromItemAttribute){k.push(c.fromItemAttribute);}if(c.toItemAttribute){k.push(c.toItemAttribute);}var e=c.edgeColorMetric;if(e){f.colorBy.push(e);}else{F(f);}if(c.edgeSizeMetric){f.sizeByMetric=c.edgeSizeMetric;}else{if(c.nodeSizeMetric){f.sizeByMetric=c.nodeSizeMetric;}}return X.call(this,g,f,j,d,h);}function W(j,g,c){var f=[],k=new a.HeatMapVisualizationHelper({node:g}),e=new a.GraphMatrixHelper({node:g}),l=C(g);l.mx=this.filterGMTrainingMetric(g.data.dz,l.mx);e.setData(g.data.dz);var h=["columnObjects","rowObjects","yAxisObjects","xAxisObjects","breakByObjects","sliceObjects"];E(h,e,k,true);k.colorBy=e.colorByObjects;F(k);k.sizeByMetric=e.angleObjects[0];if(!k.sizeByMetric){k.sizeByMetric=e.sizeByObjects[0];}else{if(e.sizeByObjects[0]){k.tooltipMetrics.push(e.sizeByObjects[0]);}}var d=[];J.forEach(k.tooltipMetrics,function(m){d.push(m.did);});J.forEach(e.tooltipMetrics,function(m){if(A(m)){if(!k.sizeByMetric){k.sizeByMetric=m;}else{if(d.indexOf(m.did)===-1){k.tooltipMetrics.push(m);}}}});return X.call(this,g,k,j,f,c);}function Q(j,h,c,l){var f=[],k=new a.HeatMapVisualizationHelper({node:h}),e=new a.GraphMatrixHelper({node:h}),m=C(h);m.mx=this.filterGMTrainingMetric(h.data.dz,m.mx);e.setData(h.data.dz);var g=["columnObjects","rowObjects","yAxisObjects","xAxisObjects","breakByObjects"];E(g,e,k,false);k.colorBy=e.colorByObjects;F(k);if(!k.sizeByMetric){k.sizeByMetric=e.sizeByObjects[0];}else{if(e.sizeByObjects[0]){k.tooltipMetrics.push(e.sizeByObjects[0]);}}if(!l){var d=[];J.forEach(k.tooltipMetrics,function(n){d.push(n.did);});J.forEach(e.tooltipMetrics,function(n){if(A(n)){if(!k.sizeByMetric){k.sizeByMetric=n;}else{if(d.indexOf(n.did)===-1){k.tooltipMetrics.push(n);}}}});}return X.call(this,h,k,j,f,c);}function H(j,f,g){var c=[],d=new a.HeatMapVisualizationHelper({node:f}),e=new a.ImageLayoutHelper({node:f}),h=C(f);e.setData(f.data.dz);if(e.geoAttribute){d.groupingObjects.push(e.geoAttribute);}if(e.colorByMetric){d.colorBy.push(e.colorByMetric);}if(e.sizeByMetric){d.sizeByMetric=e.sizeByMetric;}U.call(this,h,d);return X.call(this,f,d,j,c,g);}function D(k,f,e){var g,j,m=a.MapHelper,n=new a.HeatMapVisualizationHelper({node:f.node}),h=[],d=f.getTopLayerHost();g=new m({data:f.node.data});g.setWidget(d);var c=g.getSizeByUnit();n.sizeByMetric=c;var p=g.getAngleUnit();if(p){if(c){n.tooltipMetrics.push(p);}else{n.sizeByMetric=p;}}var q=g.getColorByUnit();if(q){if(A(q)){n.colorBy.push(q);}else{n.groupingObjects.push(q);}}j=g.getGeoUnit();if(j){n.groupingObjects.push(j);}var l=g.getSliceByUnits();if(l){n.groupingObjects=n.groupingObjects.concat(l);}var o=g.getTooltipUnits();J.forEach(o,function(r){if(A(r)){if(!n.sizeByMetric&&n.colorBy.length===0){n.sizeByMetric=r;}else{n.tooltipMetrics.push(r);}}else{n.groupingObjects.push(r);}});F(n);return X.call(this,f.node,n,k,h,e);}mstrmojo.vi.viz.HeatMapVisualizationTransition=mstrmojo.declare(mstrmojo.vi.viz.VisualizationTransition,null,{scriptClass:"mstrmojo.vi.viz.HeatMapVisualizationTransition",transitionDropZones:function S(k,p){var n="";var f=this.vis,m=f.node.data,q=m.visName?m.visName:K,g=B.getDefinition(q).id,e=[],l=L.getPropertyByPath(f,"node.data.gsi.thresholds");if(g===B.GOOGLEMAP||g===B.ESRIMAP||g===B.MAPBOX){var c=f.getTopLayerHost();l=L.getPropertyByPath(c,"node.data.gsi.thresholds");}this.clearImageThreshold(l,e);switch(g){case B.GRAPHMATRIX:case B.NEWGRAPHMATRIX:var h=f.getChartInfo(),j=h&&(h.isPie||h.isRing),o=h&&h.isHistogram,d=h&&h.isBoxPlot;if(j){n=W.call(this,k,f.node,e);}else{if(o||d){n=Q.call(this,k,f.node,e,true);}else{n=Q.call(this,k,f.node,e,false);}}break;case B.GOOGLEMAP:case B.ESRIMAP:case B.MAPBOX:n=D.call(this,k,f,e);break;case B.IMAGELAYOUT:n=H.call(this,k,f.node,e);break;case B.NETWORK:n=O.call(this,k,f.node,e);break;case B.HEATMAP:break;default:n=V.call(this,k,f.node,e);break;}return{wp:n,handled:false};}});}());(function(){mstrmojo.requiresCls("mstrmojo.ListBase","mstrmojo._IsList","mstrmojo.array","mstrmojo.hash","mstrmojo.ui.menus._HasMenuPopup","mstrmojo.vi.models.DropZonesModel");mstrmojo.requiresClsP("mstrmojo.vi.viz","EnumVisualizationTemplates","EnumVizStyles","EnumWidgetTypes");mstrmojo.requiresDescs(11819,11825,11827,16057,16058,16059,16060,16061,16062,16063,16064,16065,16066,16067,16068,16069,16070,16071,16072,16073,16074,16075,16076,16077,16078,16079,16080,16081,16082,16083,16084,16085,16086,16087,16088,16089,16090,16091,16092,16093,16208,16209);var c=mstrmojo,O=c.array,S=c.hash,G=mstrmojo.dom,V=mstrmojo.string,b=c.vi.viz,M=mstrmojo.vi.models.DropZonesModel.ENUM_REQUIREMENT_TYPE,N=M.ATTRIBUTE,W=M.METRIC,C=b.EnumVisualizationTemplates,R=b.EnumVizStyles,K=R.GRAPH_MATRIX,Z=R.NEW_GRAPH_MATRIX,e=b.EnumWidgetTypes.GRAPH_MATRIX,d=R.MAPBOX,B={},P="custom",U="plugins.";B[R.GOOGLE_MAP]=C.GOOGLEMAP;B[R.HEAT_MAP]=C.HEATMAP;B[R.ESRI_MAP]=C.ESRIMAP;B[R.NETWORK]=C.NETWORK;B[R.IMAGE_LAYOUT]=C.IMAGELAYOUT;var X=["plugins.KPIWidget.KPIWidget","plugins.SmartKPIWidget.SmartKPIWidget"];function H(j,h,m){var k=[],l=function(o,p){var n={t:o,r:p};if(o===W&&m){n.s=true;}k.push(n);};if(j){l(W,j);}if(h){l(N,h);}return k;}var Q=[{n:mstrmojo.desc(11820,"Bar Chart"),id:"BarChart",mr:H(1,1),vt:{v:C.GRAPHMATRIXVERTICALBARAUTOMATIC,h:C.GRAPHMATRIXHORIZONTALBARAUTOMATIC}},{n:mstrmojo.desc(8121,"Line Chart"),id:"LineChart",mr:H(1,1),vt:{v:C.GRAPHMATRIXVERTICALLINEAUTOMATIC,h:C.GRAPHMATRIXHORIZONTALLINEAUTOMATIC}},{n:mstrmojo.desc(11821,"Area Chart"),id:"AreaChart",mr:H(1,1),vt:{v:C.GRAPHMATRIXVERTICALAREAAUTOMATIC,h:C.GRAPHMATRIXHORIZONTALAREAAUTOMATIC}},{n:mstrmojo.desc(11822,"Bubble Chart"),id:"BubbleChart",mr:H(2,1),vt:C.GRAPHMATRIXBUBBLECIRCLEMM},{n:mstrmojo.desc(11823,"Pie Chart"),id:"PieChart",mr:H(1,1),vt:C.GRAPHMATRIXPIE},{n:mstrmojo.desc(11824,"Combo Chart"),id:"ComboChart",mr:H(2,1),vt:C.GRAPHCOMBINATIONBARAREADUALAXIS}];Q.forEach(function(h){h.s=K;h.wtp=e;});var g=[{n:mstrmojo.desc(15130,"Clustered Bar Chart"),id:"ClusteredBarChart",mr:H(1,1),vt:{v:C.GRAPHMATRIXVERTICALBARCLUSTERED,h:C.GRAPHMATRIXHORIZONTALBARCLUSTERED}},{n:mstrmojo.desc(15129,"Stacked Bar Chart"),id:"BarChart",mr:H(1,1),vt:{v:C.GRAPHMATRIXVERTICALBARSTACKED,h:C.GRAPHMATRIXHORIZONTALBARSTACKED}},{n:mstrmojo.desc(8121,"Line Chart"),id:"LineChart",mr:H(1,1),vt:{v:C.GRAPHMATRIXVERTICALLINEAUTOMATIC,h:C.GRAPHMATRIXHORIZONTALLINEAUTOMATIC}},{n:mstrmojo.desc(15233,"Stacked Area Chart"),id:"AreaChart",mr:H(1,1),vt:{v:C.GRAPHMATRIXVERTICALAREASTACKED,h:C.GRAPHMATRIXHORIZONTALAREASTACKED}},{n:mstrmojo.desc(11822,"Bubble Chart"),id:"BubbleChart",mr:H(2,1),vt:C.GRAPHMATRIXBUBBLECIRCLEMM},{n:mstrmojo.desc(350,"Histogram"),id:"Histogram",mr:H(1,1,true),vt:C.GRAPHMATRIXVERTICALHISTOGRAM},{n:mstrmojo.desc(15411,"Grid Chart"),id:"GridChart",mr:H(0,0),vt:C.GRAPHMATRIXGRIDCHART},{n:mstrmojo.desc(3156,"Box Plot"),id:"BoxPlot",mr:H(1,1),vt:{v:C.GRAPHMATRIXVERTICALBOXPLOT,h:C.GRAPHMATRIXHORIZONTALBOXPLOT}},{n:mstrmojo.desc(5594,"Waterfall"),id:"Waterfall",mr:H(1,1),vt:{v:C.GRAPHMATRIXVERTICALWATERFALL,h:C.GRAPHMATRIXHORIZONTALWATERFALL}}];g.forEach(function(h){h.cls="ngm";h.s=Z;h.wtp=e;});var L={GridChart:{summary:mstrmojo.desc(16057,"Displays data in a tabular format"),example:mstrmojo.desc(16058,"Example: Create directory with customer information and key performance indicators (KPIs)"),requirements:mstrmojo.desc(16059,"Uses 1+ ##attributes### and/or 1+ #metrics###")},BarChart:{summary:mstrmojo.desc(16060,"Uses length to compare data values across categories"),example:mstrmojo.desc(16061,"Example: Compare profit data of different sales teams"),requirements:mstrmojo.desc(16062,"Uses 1+ ##attributes### and 1+ #metrics###")},ClusteredBarChart:{summary:mstrmojo.desc(16060,"Uses length to compare data values across categories"),example:mstrmojo.desc(16061,"Example: Compare profit data of different sales teams"),requirements:mstrmojo.desc(16062,"Uses 1+ ##attributes### and 1+ #metrics###")},LineChart:{summary:mstrmojo.desc(16065,"Uses a line to show the value of a metric over time"),example:mstrmojo.desc(16066,"Example: Show stock prices over the past decade"),requirements:mstrmojo.desc(16067,"Uses 1+ ##attributes### and 1+ #metrics### (time attribute recommended)")},AreaChart:{summary:mstrmojo.desc(16068,"Uses the area within a line chart to show the value of a metric over time"),example:mstrmojo.desc(16069,"Example: Compare the amount of revenue from different sources over time"),requirements:mstrmojo.desc(16067,"Uses 1+ ##attributes### and 1+ #metrics### (time attribute recommended)")},BubbleChart:{summary:mstrmojo.desc(16070,"Uses position, color and size to show relationships and correlations"),example:mstrmojo.desc(16071,"Example: Compare GDP, population and life expectancy for different countries"),requirements:mstrmojo.desc(16072,"Uses 1+ ##attributes### and 2+ #metrics###")},PieChart:{summary:mstrmojo.desc(16073,"Shows the composition of a total value broken by category"),example:mstrmojo.desc(16074,"Example: Compare the proportions of funding sources for a university"),requirements:mstrmojo.desc(16075,"Uses 1+ ##attributes### and 1 #metric###")},ComboChart:{summary:mstrmojo.desc(16076,"Combines a line and bar chart for comparison of metrics with different units"),example:mstrmojo.desc(16077,"Example: Compare monthly precipitation and temperature in a given region"),requirements:mstrmojo.desc(16078,"Uses 1+ ##attributes### and 2+ #metrics###")},Histogram:{summary:mstrmojo.desc(16087,"Uses length to show the frequency of values within given categories/metric ranges"),example:mstrmojo.desc(16088,"Example: Determine the number of employees that fall within a given salary range"),requirements:mstrmojo.desc(16075,"Uses 1+ ##attributes### and 1 #metric###")},BoxPlot:{summary:mstrmojo.desc(16089,"Uses several data points to visualize means, medians, ranges and outliers"),example:mstrmojo.desc(16090,"Example: Show how customer satisfaction scores vary among different survey questions"),requirements:mstrmojo.desc(16091,"Uses 1+ ##attributes### and 1+ #metrics###")},Waterfall:{summary:mstrmojo.desc(16092,"Uses bars and colors to show how categories increase or decrease a metric value"),example:mstrmojo.desc(16093,"Example: Examine how different spending and income categories impact monthly budgeting"),requirements:mstrmojo.desc(16091,"Uses 1+ ##attributes### and 1+ #metrics###")},VIHeatMapVisualizationStyle:{summary:mstrmojo.desc(16063,"Uses rectangles of varying sizes and colors to show hierarchical data"),example:mstrmojo.desc(16064,"Example: Compare sales from different clothing categories at a retail store"),requirements:mstrmojo.desc(16062,"Uses 1+ ##attributes### and 1+ #metrics###")},MapboxVisualizationStyle:{summary:mstrmojo.desc(16079,"Uses Mapbox to visualize data geographically"),example:mstrmojo.desc(16080,"Example: Use layering and clustering features to visualize frequency of earthquakes around the world"),requirements:mstrmojo.desc(16081,"Uses 1+ ##attributes### (including one geographic) and 1+ #metrics###")},NetworkVisualizationStyle:{summary:mstrmojo.desc(16084,"Uses links and nodes to show relationships between data"),example:mstrmojo.desc(16085,"Example: Create a family tree"),requirements:mstrmojo.desc(16086,"Uses 2+ ##attributes### and 1+ #metrics###")},GoogleMapVisualizationStyle:{summary:mstrmojo.desc(16082,"Uses ESRI maps to visualize data geographically"),example:mstrmojo.desc(16083,"Example: Create a density map of world population"),requirements:mstrmojo.desc(16081,"Uses 1+ ##attributes### (including one geographic) and 1+ #metrics###")},KPICardVisualizationStyle:{summary:mstrmojo.desc(16208,"Provides quick performance indications as a single numeric or with an additional trend indicator"),example:mstrmojo.desc(16209,"Example: View daily unique visitor counts for a website over the last month"),requirements:mstrmojo.desc(16075,"Uses 1+ ##attributes### and 1 #metric###")}};var F={BUILT_IN_LIST:1,CUSTOM_LIST:2};function I(k){var l=[],h=mstrConfig.pluginsVisList||{},j=function(m,o,n){n=n||[];o=isNaN(o)?0:parseInt(o,10);if(o>0){n.push({t:m,r:o});}return n;};Object.keys(h).forEach(function(t){var u=h[t],v=u.s,m=u.d,o=u.c,q=o.indexOf(U)!==-1?F.CUSTOM_LIST:F.BUILT_IN_LIST;if(!(k&q)){return ;}if(v===K){u.st.forEach(function(x){var w=O.find(Q,"id",x);if(w>=0){l.push(Q[w]);}});return ;}if(v===Z){if(mstrApp.supportFeature("ngm")){var n=mstrApp.supportFeature("ngmPartial");u.st.forEach(function(x){var w=O.find(g,"id",x);if(w>=0){if(n){if(x==="Waterfall"||x==="Histogram"||x==="BoxPlot"){l.push(g[w]);}}else{l.push(g[w]);}}});}return ;}if(v===d&&!mstrApp.supportFeature("mbx")){return ;}if(v==="VisBuilderNew"&&!mstrApp.isVisBuilder){return ;}if(X.indexOf(o)>=0){return ;}var r=u.desc;if(r){m=mstrmojo.desc(r,"");}var p;if(v===R.KPICARD){p=H(u.mm,u.ma,true);}else{p=j(N,u.ma,j(W,u.mm));}l.push({n:m,s:v,mr:p,id:v,dz:u.dz,vt:B[v],wtp:u.wtp,isNS:u.isNS,pn:u.pn||null});});O.forEach(l,function(m){if(m.id in L){var n=L[m.id];m.summary=n.summary;m.example=n.example;m.requirements=n.requirements;}});return l;}function J(h){return I(F.BUILT_IN_LIST+F.CUSTOM_LIST).filter(function(j){return j.s===h;}).map(function(j){return{s:j.s,vt:j.vt||-1};})[0];}function A(h,j){window.FormWrapper.doVisRemove(h,j);}mstrmojo.vi.ui.VizGalleryList=mstrmojo.declare(mstrmojo.ListBase,[mstrmojo._IsList,mstrmojo.ui.menus._HasMenuPopup],{scriptClass:"mstrmojo.vi.ui.VizGalleryList",init:function Y(h){this._super(h);mstrmojo.css.addWidgetCssClass(this,"mstrmojo-VIGalleryList");this.items=(this.items||[]).concat(I(this.type));},items:null,useRichTooltip:true,itemMarkup:null,type:F.BUILT_IN_LIST,getItemMarkup:function E(h){if(!this.itemMarkup){this.itemMarkup=this._super(h).replace(">{@en@n}<",'><div><div><div class="unsafe-icn"></div></div></div><');}return this.itemMarkup;},getItemProps:function f(k,h){var j=this._super(k,h);j.addCls("ic-"+k.id);if(k.isNS){j.addCls("nonsafe");}if(this.type===F.CUSTOM_LIST){j.addCls(P);}return j;},select:function(k,h){if(!k){return ;}k=O.ensureArray(k);var m=this._removeAll(),o=this._addSelections(k),l;if(this.selectionPolicy!=="reselect"){for(l=m.length-1;l>=0;l--){var n=O.indexOf(o,m[l]);if(n>-1){m.splice(l,1);o.splice(n,1);}}}var j={name:"selectionChange",added:o,removed:m};if(h){if(this.onselectionChange){this.onselectionChange(j);}}else{this.raiseEvent(j);}},showTooltip:function D(u,n){var j=G.eventTarget(n,u);if(j.className.indexOf("unsafe-ic")===-1){return ;}G.stopPropogation(null,u);var p=G.findAncestorByAttr(j,"idx",true,this.domNode),l=p&&p.node,r=l&&l.className.indexOf(P)>-1,w=this.parent,q=r?w&&w.customVizList:w&&w.vizList,v=p&&q&&q.items[p.value],h=v&&v.n;if(!h||h===""){return ;}var m=G.position(l),t=mstrmojo.desc(15365,"Visualizations that use it may display as a grid when this dossier is opened in a context where these plugins are not available."),k=mstrmojo.desc(15364,"## plugin is only available on your local machine.").replace("##",h),o='<div class="name">'+k+'</div><div class="dsc">'+t+"</div>";this.richTooltip={posType:mstrmojo.tooltip.POS_TOPRIGHT,cssClass:"viGallery-tooltip vi-warning nsicn-tooltip vi-regular vi-tooltip-D",content:o,top:m.y-12,left:m.x-7,keepArrowYPos:true};this._super(u,n);},onItemContextMenu:function a(j,h){var k;if(j.pn&&!(mstrApp.supportFeature(mstrmojo.vi.enums.EnumFeatures.SUPPORT_LIVEMODE)&&mstrApp.getWSLiveMode())){this.hideTooltip();k=new mstrmojo.ui.menus.MenuConfig({position:mstrmojo.dom.getMousePosition(h.e,h.hWin),isHostedWithin:false});k.addMenuItem(mstrmojo.desc(629,"Delete"),"",function(){A(j.id,j.pn);});this.openPopup(k.newInstance());}}});mstrmojo.vi.ui.VizGalleryList.getVizList=I;mstrmojo.vi.ui.VizGalleryList.getVisType=J;mstrmojo.vi.ui.VizGalleryList.VIZ_LIST_TYPE=F;}());(function(){mstrmojo.requiresCls("mstrmojo.vi.ui.rw.xtab.XtabMenuConfig");var A=mstrmojo.rw.xtab.XtabMenuConfig.ACTION_TYPES;mstrmojo.vi.ui.rw.xtab.ViewDataXtabMenuConfig=mstrmojo.declare(mstrmojo.vi.ui.rw.xtab.XtabMenuConfig,null,{scriptClass:"mstrmojo.vi.ui.rw.xtab.ViewDataXtabMenuConfig",buildXtabMenuConfig:function B(C){this._super(C);this.menus=this.menus.filter(function(D){return D.ctxt&&!D.ctxt.isTotals&&(this.isActionAvailable(D.ctxt.data,A.SORT)||this.isActionAvailable(D.ctxt.data,A.PIVOT));},this);},addDrillMenuItem:mstrmojo.emptyFn});}());(function(){mstrmojo.requiresCls("mstrmojo.hash","mstrmojo.func","mstrmojo.array","mstrmojo.vi.models.editors.ControlsViewFactory","mstrmojo.Label","mstrmojo.vi.ui.TextAlignButtonBar","mstrmojo.vi.ui.editors.EditorGroup","mstrmojo.ui.editors.controls.CharacterGroup","mstrmojo.ui.editors.controls.ContainerGroup","mstrmojo.vi.ui.editors.MoreOptionsEditor");var J=mstrmojo.hash,H=mstrmojo.ui.editors.controls.ContainerGroup.CTRL_FLAGS,Q="mstrmojo-more-options-editor",F="mstrmojo-more-options-editor-visfilter";mstrmojo.vi.models.editors.EditorModel=mstrmojo.declare(mstrmojo.vi.models.editors.ControlsViewFactory,null,{scriptClass:"mstrmojo.vi.models.editors.EditorModel",hostId:"",help:"",getHost:function C(){return mstrmojo.all[this.hostId];},docModel:null,getEditorContents:mstrmojo.emptyFn,getGroupTitle:function D(S){return new mstrmojo.Label({cssClass:"edt-title",text:S});},getShowTitleCheckbox:function K(){var S=this.getHost();return this.getCheckboxAndLabel(S.parent.getTitleBarVisibility(),mstrmojo.desc(13599,"Show titlebar"),function(U){S.parent.toggleTitleBar(!!U);});},getTextAlign:function G(V,W,U){var S=new mstrmojo.vi.ui.TextAlignButtonBar(!U?null:{itemsValueMap:U});S.singleSelect(mstrmojo.array.find(S.items,"id",V));S.onValueChange=W;return S;},getWrapText:function P(U,S){return this.getCheckboxAndLabel(U,mstrmojo.desc(13577,"Wrap text"),S);},getTextDirection:function E(U,V){var S=0;if(U){S=U===3?1:2;}return this.getLabelAndControl(mstrmojo.desc(11914,"Direction:"),this.getPulldown([{n:mstrmojo.desc(2066,"Horizontal"),v:0},{n:mstrmojo.desc(5155,"90 degrees"),v:90},{n:mstrmojo.desc(5156,"-90 degrees"),v:-90}],V,S));},getOverflow:function L(U,S){return this.getLabelAndControl(mstrmojo.desc(11915,"Overflow:"),this.getPulldown([{n:mstrmojo.desc(2974,"Clip"),v:false},{n:mstrmojo.desc(2976,"Scroll"),v:true}],S,U?1:0));},getChangeFormatPropertyFn:function A(S,U){var V=this.id;return function(Y,W){var X=mstrmojo.all[V];X.docModel.changeUnitFormatProperty(X.getHost().parent,[{formatType:U||1,propertyName:S,newValue:Y,oldValue:W}]);};},getChangeGroupPropertyFn:function R(S){var U=this.id;return function(V,X,W){(mstrmojo.all[U].getChangeFormatPropertyFn(V,S))(X,W);};},getCharacterGroup:function B(W,S,U){var X={onGroupValueChange:W};if(U){X.visibleControls=U;}var V=new mstrmojo.ui.editors.controls.CharacterGroup(X);V.setFormatSource(S);return V;},getContainerGroup:function O(S,W,U,V){var X=new mstrmojo.ui.editors.controls.ContainerGroup(J.copy(V,{onGroupValueChange:W||this.getChangeGroupPropertyFn(),visibleControls:U||(H.FILL_COLOR+H.BORDER)}));X.setFormatSource(S);return X;},getMoreOptionsEditorLink:function M(U,S,V){return new mstrmojo.Label({text:mstrmojo.desc(9126,"More options"),cssClass:"edt-link",onclick:function(){this.openMoreOptionsEditor(U,S,V);}.bind(this)});},openMoreOptionsEditor:function N(X,S,Y){var W=this.getHost(),V;var U=function(b,Z,f,a){var c=this.host,d=c.controller,e=[];if(!J.isEmpty(b)){f=mstrmojo.func.wrapMethods(d._getXtabCallback(c),f);e=[d.dataService().getUpdateTemplateAction(c.k,[c.model.getAdvancedPropertiesAction(b)])];}e=e.concat(Z||[]);if(!J.isEmpty(e)){d.submitUndoRedoUpdates(e,null,f,a);}};if(mstrApp.isInVFConfigMode){V=mstrmojo.all[F]||new mstrmojo.vi.ui.editors.MoreOptionsEditor({id:F,submitAction:U});}else{V=mstrmojo.all[Q]||new mstrmojo.vi.ui.editors.MoreOptionsEditor({id:Q,submitAction:U});}V.set("data",X);V.set("showHeadersSection",!!S);V.set("showSelectionLimitSection",!!W.GMController);V.set("lockHeadersCase",Y);V.set("host",W);V.open();return V;},replaceChildControls:function I(V,U){var S=[].concat(V.children||[]);V.removeChildren();S.forEach(function(W){W.destroy();});V.addChildren(U);V.doLayout();}});}());(function(){mstrmojo.requiresCls("mstrmojo.css","mstrmojo.dom","mstrmojo.array","mstrmojo.vi.ui.theme","mstrmojo._HasOwnAvatar","mstrmojo.vi.ui.VIDragUnit","mstrmojo.hash");var G=mstrmojo.css,E=mstrmojo.dom,B=mstrmojo.vi.ui.theme,F=mstrmojo.array,C=mstrmojo.hash;function D(P,Q,O){var N=false;F.forEach(this.getSelectedItems(),function(R){if(R.itemNode===Q||R===P){N=true;}});if(P&&!N){this.doItemSelect(P,O||{});}}var M={avatarCssClass:"mstrmojo-VIUnitList",encodeUnitAvatar:true,getDragData:function L(N){var O=N.src.node,Q=E.findAncestorByAttr(O,"idx",true,this.domNode);N.src.node=Q?Q.node:O;var P=(N.dragUnitHelper=new mstrmojo.vi.ui.VIDragUnit()).getUnitDragData(N,this.getSelectedItems());if(this.getItemDisplayName){mstrmojo.func.override({getItemDisplayName:this.getItemDisplayName},N.dragUnitHelper);}P.srcId=this.id;return P;},createAvatar:function A(O,N){if(N.dragUnitHelper){return N.dragUnitHelper.getUnitAvatar(N,this.encodeUnitAvatar);}},selectDragNode:function K(N){var O=N.src;D.call(this,this.getItemFromTarget(O.node),this.getItemNodeFromTarget(O.node),O);},onItemContextMenu:function J(O,N){D.call(this,O,this.getItemNodeFromTarget(N.getTarget()),N);if(this._super){return this._super(O,N);}},positionAvatar:function H(O,N){N.dragOffsets=N.dragUnitHelper.getDragUnitOffsets();if(this._super){this._super(O,N);}}},I=C.copy(M);I._mixinName="mstrmojo.vi.ui._HasUnitListAvatar2";I.getDragData=function(N){if(this.isDraggingItem&&!this.isDraggingItem(N)){if(this._super){return this._super(N);}}else{return M.getDragData.call(this,N);}};mstrmojo.vi.ui._HasUnitListAvatar2=mstrmojo.provide("mstrmojo.vi.ui._HasUnitListAvatar2",I);mstrmojo.vi.ui._HasUnitListAvatar=mstrmojo.provide("mstrmojo.vi.ui._HasUnitListAvatar",mstrmojo.mixin(M,mstrmojo.mixin(mstrmojo._HasOwnAvatar)));}());(function(){mstrmojo.requiresCls("mstrmojo.vi.ui.UnitList","mstrmojo.vi.ui.PanelPortlet","mstrmojo.vi.ui._HasUnitListAvatar","mstrmojo.vi.models.EnumDragSources","mstrmojo._HasLayout","mstrmojo.dom","mstrmojo.array","mstrmojo.hash","mstrmojo.vi.ui.DatasetUnitMenuUtils");var L=mstrmojo.array,K=mstrmojo.dom,B=mstrmojo.func,F=mstrmojo.hash,J=mstrmojo.vi.ui.DatasetUnitMenuUtils,D="tbl",P="dmaList";function I(Y,W,Q){var R=this,U=this.setting&&this.setting.table&&this.setting.table(W.did);return({scriptClass:"mstrmojo.vi.ui.PanelPortlet",title:W.n,tableId:W.did,dataset:Y,tabelsWidget:this,ignoreLayout:false,showTitleBarContextMenu:true,level:R.level+1,getLayoutOffsets:function(){return{h:0,w:0};},setting:U,isCollapsed:U?!!(U.getCollapsed()):false,onclick:function(Z){if(K.contains(this.titleBar.leftToolNode,Z.getTarget(),true,this.domNode)){R.onTableCollapsedChange(this.tableId,this.isCollapsed);}},updateToolbar:function V(Z){Z.hostId=this.id;Z.isHostedWithin=false;Z.addMenuItem(mstrmojo.desc(1388,"Rename"),"rnm",function(){this.ctxt.titleBar.editTitle();},this);return Z;},postCreate:function S(){var Z=this;R.attachEventListener("toggleAllCollapsed",this.id,function(a){if(a.isRecover){Z.togglePortlet(Z.setting?Z.setting.getCollapsed():Z.defaultCollapsed?Z.defaultCollapsed:false);}else{if(a.changeSetting){Z.setting.isCollapsed=a.isCollapsed;}Z.togglePortlet(a.isCollapsed);}});},layoutConfig:(!!mstrApp.isWSStyling)?{h:{titlebarNode:"26px",containerNode:"100%"},w:{titlebarNode:"100%",containerNode:"100%"},xt:true}:{h:{titlebarNode:"20px",containerNode:"100%"},w:{titlebarNode:"100%",containerNode:"100%"},xt:true},getTitleBarCfg:function X(){var Z=this.constructor.prototype.getTitleBarCfg.call(this),a=this;return F.copy({editTitleOnDoubleClick:true,titleEdited:function c(e,g,d){if(g){var f=function(){a.titleBar.set("title",d);},h=function(){var j=a.parent.parent.docModel;j.warnForEditStandaloneDS(Y.set,function(){j.renameEmmaSrcTable(W.did,Y.id,e.trim(),B.wrapMethods(j.getDatasetsUpdateCallback()),{failure:function(k){mstrApp.onerror(k);a.titleBar.set("title",d);}});},f);};J.validateName(e,h,f);}},updateTooltipConfig:function b(e){var f=e.target||K.eventTarget(e.hWin,e.e);if(f.scrollWidth<=f.clientWidth){this.richTooltip=null;}else{var d=K.position(this.domNode);this.richTooltip={content:this.getTooltipContent(e),posType:mstrmojo.tooltip.POS_TOPLEFT,cssClass:"vi-regular vi-tooltip-C",top:d.y-2,left:d.x+d.w+6};}}},Z);},children:[{alias:"tulist",scriptClass:this.unitListScriptClass,draggable:false,panelId:this.panelId,docModel:this.docModel,bindings:{filterScope:"this.parent.tabelsWidget.filterScope",filterExpr:"this.parent.tabelsWidget.filterExpr",level:"this.parent.level + 1"},postCreate:function S(){this.doubleClickItem=B.composite([this.doubleClickItem,mstrmojo.all[this.panelId].doubleClickItemHandler]);},dataset:Y,getAllItems:function(){return[].concat(W.att).concat(W.mx);},onitemsChange:function(){this.parent.set("visible",!!this.items.length);}}]});}function O(){var V=this.dataset,R=[];L.forEach(V.set.tables,function(Y,X){R.push(I.call(this,V,Y,X));},this);var U=this.tbl;var W=[].concat(U.children||[]);U.removeChildren();W.forEach(function(X){X.destroy();});U.addChildren(R);U.children.forEach(function(X){X.doLayout();});if(!this[P]){this.addChildren({alias:P,scriptClass:this.unitListScriptClass,draggable:false,dataset:V,docModel:this.docModel,panelId:this.panelId,bindings:{filterScope:"this.parent.filterScope",filterExpr:"this.parent.filterExpr",level:"this.parent.level + 1"},postCreate:function S(){this.doubleClickItem=B.composite([this.doubleClickItem,mstrmojo.all[this.panelId].doubleClickItemHandler]);},getAllItems:function Q(){return[].concat(V.set.att).concat(V.set.mx).filter(function(X){return J.isDocumentLevelItem(X);});}});}}mstrmojo.vi.ui.DatasetTables=mstrmojo.declare(mstrmojo.Box,[mstrmojo._HasLayout],{layoutConfig:{w:{containerNode:"100%"},xt:true}});mstrmojo.vi.ui.DatasetTableView=mstrmojo.declare(mstrmojo.Box,[mstrmojo.vi.ui._HasUnitListAvatar,mstrmojo._HasLayout],{scriptClass:"mstrmojo.vi.ui.DatasetTableView",layoutConfig:{w:{containerNode:"100%"},xt:true},markupMethods:{ondatasetChange:function A(){O.call(this);},onfilterExprChange:function(){var Q=false;Q=this[D].children.some(function(R){return !!R.tulist.items.length;})||!!(this[P].items&&this[P].items.length);this.emptyIndicator.set("visible",!Q);}},draggable:true,avatarCssClass:"mstrmojo-VIUnitList",dataset:null,unitListScriptClass:"",docModel:null,panelId:"",setting:{},onTableCollapsedChange:mstrmojo.emptyFn,children:[{alias:"emptyIndicator",cssClass:"emptyIndicator",scriptClass:"mstrmojo.Label",bindings:{text:function(){if(!this.visible){return"";}return this.parent.filterExpr?mstrmojo.desc(11904,"No matched object"):mstrmojo.desc(11905,"No object");}}},{alias:D,scriptClass:"mstrmojo.vi.ui.DatasetTables"}],getTableWidgets:function H(){return this[D].children||[];},toggleAllNodesCollapsed:function G(Q,S,R){this.raiseEvent({name:"toggleAllCollapsed",isCollapsed:Q,changeSetting:S,isRecover:R});},getSelectedItems:function C(){var Q=this[P];return this[D].children.reduce(function(R,S){L.forEach(S.tulist.getSelectedItems(),function(U){if(L.find(R,"did",U.did)<0){R.push(U);}});return R;},[]).concat(Q.getSelectedItems());},clearSelect:function(){this[D].children.forEach(function(Q){Q.tulist.clearSelect();});this[P].clearSelect();},isDragValid:function M(Q){return !isNaN(parseInt(Q.src.node.getAttribute("idx"),10))||this._super(Q)||false;},ondragstart:function E(S){var U=null,R=this[P],Q=function(V){return K.contains(V.domNode,S.src.node,true,V.domNode);};L.forEach(this[D].children,function(W){var V=W.tulist;if(Q(V)){U=V;return false;}});if(!U&&Q(R)){U=R;}if(U){U.selectDragNode(S);}this._super(S);},getDragData:function N(Q){var R=this._super(Q);R.item=R.items&&R.items[0];R.dsid=this.dataset.id;R.src=mstrmojo.vi.models.EnumDragSources.DATASETS;return R;}});}());(function(){mstrmojo.requiresCls("mstrmojo.vi.ui.UnitList","mstrmojo.vi.ui._HasUnitListAvatar","mstrmojo.ui.menus._HasMenuPopup","mstrmojo.vi.ui.DatasetUnitMenuUtils","mstrmojo.dom","mstrmojo.css","mstrmojo.string","mstrmojo._CanHandleTwoClicks");mstrmojo.requiresDescs(629,6424);var I=mstrmojo.desc,F=mstrmojo.dom,J=mstrmojo.hash,B=mstrmojo.string,L="mnu",C="clsx",O="icn "+L+"_sub",M="icn "+C+"_sub",R;function Q(S,V,U){return function(){V.style.overflow=S?"visible":"hidden";if(U){U();}};}mstrmojo.vi.ui.InteractiveUnitList=mstrmojo.declare(mstrmojo.vi.ui.UnitList,[mstrmojo.vi.ui._HasUnitListAvatar,mstrmojo.ui.menus._HasMenuPopup,mstrmojo._CanHandleTwoClicks],{scriptClass:"mstrmojo.vi.ui.InteractiveUnitList",draggable:true,panelId:"",useRichTooltip:true,hasTooltipContent:function(U,V){var S=this.getLabelNode(V);return S.scrollWidth>S.clientWidth;},getItemTooltip:function(e,V,b){var c=this.getLabelNode(V);if(this.hasTooltipContent(e,V)){var W=F.position(c),Y=e.desc?e.desc:e.dsc,d=(this.zonesModel||{}).docModel,U,a='<div class="name">'+B.encodeHtmlString(e.n,true)+"</div>"+(e.objectNameinDataset?('<div class="dsc">'+B.encodeHtmlString(mstrmojo.desc(15112,"Name in Dataset:")+" "+e.objectNameinDataset,true)+"</div>"):"");if(e.dsName){U=e.dsName;}else{if(e.datasetId){U=d&&d.datasets&&d.datasets[e.datasetId].name;}else{if(e.id){var Z=d&&d.getObjectInfo(e.id),X=Z&&d.findDatasetIdFromUnit(Z.did);U=d&&d.datasets&&X&&d.datasets[X].name;}}}a+=(U?'<div class="dataset">'+B.encodeHtmlString(mstrmojo.desc(8502,"Dataset")+": "+U,true)+"</div>":"")+(Y?'<div  class="dsc">'+B.encodeHtmlString(Y,true)+"</div>":"");var S={areaId:e._renderIdx+"text",cssClass:"vi-regular vi-tooltip-V",contentNodeCssClass:"regular-unitlist-tooltips",posType:mstrmojo.tooltip.POS_BOTTOMLEFT,content:a,top:W.y-6,left:W.x,enableHover:true};return S;}return null;},showTooltip:function D(S,W){var V=S.target||F.eventTarget(S.hWin,S.e),U=this.getItemFromTarget(V);if(U&&U.n){var X=this.getItemNodeFromTarget(V);this.richTooltip=this.getItemTooltip(U,X,V);if(this.richTooltip){this._super(S,W);}}},getItemMarkup:function E(S){if(!R){R=this._super(S).replace(">{@en@n}",'><span class="txt" unselectable="on">{@en@n}</span><div class="'+L+'"><div title="'+I(6424,"Menu")+'" class="'+O+'"></div></div><div class="'+C+'"><div class="'+M+'"></div></div>').replace("<{@tag}",'<{@tag} unselectable="on" ');}return R;},getLabelNode:function N(S){return S.getElementsByClassName("txt")[0];},ondblclick:function H(S){var V=S.getTarget(),W=this.getItemNodeFromTarget(V),U=(F.findWidget(W)===this)&&this.getItemFromTarget(V);if(!!U){S.cancel();this.doubleClickItem(U);}},onItemContextMenu:function P(W,U){var Y=U.getTarget();if(W){this.closePopup();var S=mstrmojo.all[this.panelId],V=S&&S.getPanelSelectedItems&&S.getPanelSelectedItems(),X=V&&V.length>1;this[X?"showMultiSelectionMenu":"showItemMenu"](X?V:W,this.getItemNodeFromTarget(Y),F.getMousePosition(U.e,U.hWin));return true;}},configurePopup:function K(S,X,W,V){mstrmojo.all[this.panelId].addPopupHandlers(S);var U=X.parentNode;S.addPopupHandlers("iulMenuOverflow",Q(true,U,W),Q(false,U,V));S.hostId=this.id;S.isHostedWithin=false;S.hostElement=X;},showItemMenu:mstrmojo.emptyFn,showMultiSelectionMenu:mstrmojo.emptyFn,deleteItem:mstrmojo.emptyFn,doubleClickItem:mstrmojo.emptyFn,twoClicksItem:mstrmojo.emptyFn,onTwoClicks:function(S){if(S.firstTarget==S.secondTarget){var U=this.getItemFromTarget(S.secondTarget);S.cancel();if(!!U){this.twoClicksItem(U,S);}}},isDragValid:function A(S){return !isNaN(parseInt(S.src.node.getAttribute("idx"),10))||this._super(S)||false;},getSelectedItems:function G(){var W=this,S=this.items,V=null,U=[];J.forEach(this.selectedIndices,function(Y,X){V=S[X];if(Y&&V){V=J.copy(V);V.ulist=W;V.itemNode=W._getItemNode(V._renderIdx);U.push(V);}});return U;}});mstrmojo.vi.ui.InteractiveUnitList.CLS_HAS_MENU="has-m";mstrmojo.vi.ui.InteractiveUnitList.CLS_HAS_X="has-x";}());(function(){mstrmojo.requiresCls("mstrmojo.vi.ui.UnitList","mstrmojo.vi.ui.PanelPortlet","mstrmojo.vi.ui._HasUnitListAvatar","mstrmojo.vi.models.EnumDragSources","mstrmojo._HasMarkup","mstrmojo._HasLayout","mstrmojo.dom","mstrmojo.hash","mstrmojo.array","mstrmojo.vi.ui.DatasetUnitMenuUtils");var U=mstrmojo.hash,G=mstrmojo.dom,Z=mstrmojo.func,H=mstrmojo.vi.ui.DatasetUnitMenuUtils,Y=mstrmojo._HasMarkup.addMarkupMethods,O="dimensions",V="metricFolder",M="folders",J="metrics",Q="levels",L="derivedObjects",d="multiLevelHierarchies",b="singleLevelHierarchies",F="recursiveAttributes",P="_emptyIndicator";function C(n,h){var l=U.copy(h,{scriptClass:n.unitListScriptClass,treeContext:n,docModel:n.docModel,panelId:n.datasetsPanelId,_isUnitList:true,postCreate:function k(){this.doubleClickItem=Z.composite([this.doubleClickItem,n.doubleClickItemHandler]);},onallItemsChange:function j(){this.reloadItems();},getAllItems:function g(){return this.allItems||[];},isEmpty:function m(){return !(this.items&&this.items.length);}});l.bindings=U.copy(h.bindings,{dataset:function(){var o=this.treeContext.dataset;return o&&{id:o.did,set:o};},filterScope:"this.treeContext.filterScope",filterExpr:"this.treeContext.filterExpr",filterFunc:"this.treeContext.filterFunc",level:"this.parent.level + 1"});return l;}function a(h,g){return U.copy(g,{scriptClass:"mstrmojo.vi.ui.MDXTreeNodeList",treeContext:h});}function A(h,g){return U.copy(g,{treeContext:h});}mstrmojo.vi.ui._IsMDXTreeComponent=mstrmojo.provide("mstrmojo.vi.ui._IsMDXTreeComponent",{treeContext:null,data:null,setting:null,isEmpty:function S(){return this.getRealChildren().every(function(g){return g.isEmpty();});},isRealChild:function D(g){return !g.ignoredChild;},getRealChildren:function I(){return(this.children||[]).filter(this.isRealChild,this);},getSelectedItems:function K(){return this.getRealChildren().reduce(function(g,h){return g.concat(h.getSelectedItems());},[]);},clearSelect:function f(){this.getRealChildren().forEach(function(g){g.clearSelect();});}});mstrmojo.vi.ui.MDXTreePortletNode=mstrmojo.declare(mstrmojo.vi.ui.PanelPortlet,[mstrmojo.vi.ui._IsMDXTreeComponent],{scriptClass:"mstrmojo.vi.ui.MDXTreePortletNode",ignoreLayout:false,getLayoutOffsets:function(){return{h:0,w:0};},handleDataChange:mstrmojo.emptyFn,init:function X(g){var h=this;this._super(g);this.treeContext.view.attachEventListener("toggleAllCollapsed",this.id,function(j){if(j.isRecover){h.togglePortlet(h.setting?h.setting.getCollapsed():h.defaultCollapsed?h.defaultCollapsed:false);}else{if(j.changeSetting){h.setting.isCollapsed=j.isCollapsed;}h.togglePortlet(j.isCollapsed);}});},isRealChild:function D(g){return g.alias!=="titleBar"&&this._super(g);},onCollapsedChange:function(){this.treeContext.view.onNodeCollapsedChange(this);}});Y(mstrmojo.vi.ui.MDXTreePortletNode,{ondataChange:function W(){this.handleDataChange();}});mstrmojo.vi.ui.MDXTreeNodeList=mstrmojo.declare(mstrmojo.Box,[mstrmojo._HasLayout,mstrmojo.vi.ui._IsMDXTreeComponent],{scriptClass:"mstrmojo.vi.ui.MDXTreeNodeList",treeContext:null,data:null,createChildConfig:null,layoutConfig:{w:{containerNode:"100%"},xt:true}});Y(mstrmojo.vi.ui.MDXTreeNodeList,{ondataChange:function W(){this.destroyChildren();this.addChildren((this.data||[]).map(this.createChildConfig,this));}});mstrmojo.vi.ui.MDXDimension=mstrmojo.declare(mstrmojo.vi.ui.MDXTreePortletNode,null,{scriptClass:"mstrmojo.vi.ui.MDXDimension",handleDataChange:function N(){var h=this.data,g=[],j=[];if(h.recursiveAtt&&h.recursiveAtt.length>0){(h.recursiveAtt||[]).forEach(function(k){g.push(k);});}else{(h.hierarchies||[]).forEach(function(k){j.push(k);});}this[d].set("data",j);this[F].set("allItems",g);},init:function X(g){var h=this;this._super(g);this.addChildren([a(this.treeContext,{alias:d,createChildConfig:function(k){var j=h.setting&&h.setting.hierarchy&&h.setting.hierarchy(k.did);return A(this.treeContext,{scriptClass:"mstrmojo.vi.ui.MDXHierarchy",title:k.n,data:k,setting:j,defaultCollapsed:true,isCollapsed:j?!!(j.getCollapsed()):true,level:h.level+1});}}),C(this.treeContext,{alias:F})]);}});mstrmojo.vi.ui.MDXHierarchy=mstrmojo.declare(mstrmojo.vi.ui.MDXTreePortletNode,null,{scriptClass:"mstrmojo.vi.ui.MDXHierarchy",init:function X(g){this._super(g);this.addChildren([C(this.treeContext,{alias:Q,bindings:{allItems:"this.parent.data.att"}})]);}});mstrmojo.vi.ui.MDXMetricFolder=mstrmojo.declare(mstrmojo.vi.ui.MDXTreePortletNode,null,{scriptClass:"mstrmojo.vi.ui.MDXMetricFolder",init:function X(g){var h=this;this._super(g);this.addChildren([a(this.treeContext,{alias:M,bindings:{data:"this.parent.data && this.parent.data.folders"},createChildConfig:function(j){var k=h.setting&&h.setting.folder&&h.setting.folder(j.n);return A(this.treeContext,{scriptClass:"mstrmojo.vi.ui.MDXMetricFolder",title:j.n,data:j,setting:k,defaultCollapsed:true,isCollapsed:k?!!(k.getCollapsed()):true,level:h.level+1});}}),C(this.treeContext,{alias:J,bindings:{allItems:"this.parent.data.mx"}})]);}});function R(){var g=function(){if(this.isEmpty){var j=this.isEmpty();this.set("visible",!j);if(!j){var h=this.getRealChildren&&this.getRealChildren();if(h&&h.length){h.forEach(function(k){g.call(k);});}}}};this[P].set("visible",this.isEmpty());this.getRealChildren().forEach(function(h){g.call(h);});}mstrmojo.vi.ui.DatasetMDXView=mstrmojo.declare(mstrmojo.Box,[mstrmojo._HasLayout,mstrmojo.vi.ui._HasUnitListAvatar,mstrmojo.vi.ui._IsMDXTreeComponent],{scriptClass:"mstrmojo.vi.ui.DatasetMDXView",draggable:true,avatarCssClass:"mstrmojo-VIUnitList",data:null,unitListScriptClass:"",docModel:null,datasetsPanelId:"",layoutConfig:{w:{containerNode:"100%"},xt:true},onNodeCollapsedChange:mstrmojo.emptyFn,init:function X(h){this._super(h);var j=this;var k=this.treeContext=new mstrmojo.Model({view:this,docModel:this.docModel,datasetsPanelId:this.datasetsPanelId,unitListScriptClass:this.unitListScriptClass,bindings:{dataset:"this.view.data",table:"this.dataset && this.dataset.tables && this.dataset.tables[0]",filterExpr:"this.view.filterExpr",filterScope:"this.view.filterScope",filterFunc:"this.view.filterFunc"},doubleClickItemHandler:mstrmojo.all[this.datasetsPanelId].doubleClickItemHandler});var g=j.setting&&j.setting.rootMetricFolder;this.addChildren([a(k,{alias:O,bindings:{data:"this.treeContext.table && this.treeContext.table.dimensions",visible:'this.treeContext.filterScope !== "mx"'},createChildConfig:function(m){var l=j.setting&&j.setting.dimension&&j.setting.dimension(m.did);return A(this.treeContext,{scriptClass:"mstrmojo.vi.ui.MDXDimension",data:m,title:m.n,setting:l,defaultCollapsed:true,isCollapsed:l?!!(l.getCollapsed()):true,level:j.level+1});}}),A(this.treeContext,{alias:V,scriptClass:"mstrmojo.vi.ui.MDXMetricFolder",bindings:{data:"this.treeContext.table && this.treeContext.table.metricFolder",visible:'this.treeContext.filterScope !== "att"'},title:mstrmojo.desc(14007,"Measures"),setting:g,isCollapsed:g?!!(g.getCollapsed()):false,level:j.level+1}),C(k,{alias:L,bindings:{allItems:function(){var l=this.treeContext.dataset;return l&&[].concat(l.att).concat(l.mx).filter(function(m){return H.isDocumentLevelItem(m);})||[];}}})]);},markupMethods:{onfilterExprChange:function(){if(this.hasRendered){R.call(this);}}},onRender:function(){this._super();R.call(this);},toggleAllNodesCollapsed:function e(g,j,h){this.raiseEvent({name:"toggleAllCollapsed",isCollapsed:g,changeSetting:j,isRecover:h});},children:[{alias:P,cssClass:"emptyIndicator",scriptClass:"mstrmojo.Label",ignoredChild:true,bindings:{text:function(){if(!this.visible){return"";}return this.parent.filterExpr?mstrmojo.desc(11904,"No matched object"):mstrmojo.desc(11905,"No object");}}}],isDragValid:function B(g){return !isNaN(parseInt(g.src.node.getAttribute("idx"),10))||this._super(g)||false;},ondragstart:function c(g){var j=g.src.node;var h=G.findWidget(j);while(h&&h!==this){if(h._isUnitList&&h.treeContext===this.treeContext){h.selectDragNode(g);break;}h=h.parent;}return this._super(g);},getDragData:function E(g){var h=this._super(g);h.item=h.items&&h.items[0];h.dsid=this.data.id||this.data.did;h.src=mstrmojo.vi.models.EnumDragSources.DATASETS;return h;}});}());(function(){mstrmojo.requiresCls("mstrmojo.dom","mstrmojo.array","mstrmojo.hash","mstrmojo.array","mstrmojo.Container","mstrmojo.TreeBrowserNode","mstrmojo.TreeBrowser","mstrmojo.TreeBrowserSelector","mstrmojo.DynamicClassFactory","mstrmojo._HasLayout","mstrmojo.ObjectBrowserDataProvider","mstrmojo.ui._HasScroller","mstrmojo.ui.SearchBox","mstrmojo.ui._HasUITheme","mstrmojo.vi.ui._IsDropTarget","mstrmojo.vi.ui._IsViPanel","mstrmojo.vi.ui.UnitList","mstrmojo.vi.ui._HasUnitListAvatar","mstrmojo.vi.ui.toolbars._HasToolbar","mstrmojo.vi.ui.CollapsibleTitleBar","mstrmojo.vi.ui.DatasetUnitMenuUtils","mstrmojo.vi.models.EnumDragSources","mstrmojo.vi.ui._CanDropFromSchema","mstrmojo.css","mstrmojo.vi.ui.theme");var G=mstrmojo.DynamicClassFactory,V=mstrmojo.array,I=mstrmojo.hash,H=mstrmojo.dom,A=mstrmojo.css,h=mstrmojo.string,F=mstrmojo.vi.ui.theme,b=mstrmojo.vi.ui.DatasetUnitMenuUtils,g=[4,12,1,47];var J={n:mstrmojo.desc(15348,"No applicable objects"),t:0},R={n:mstrmojo.desc(15559,"No result matches your search."),t:0};function L(p){var o=[],n=[],u=this._shiftStartIndex,t=this.selectedIndices,r=Math.min(u,p),q=Math.max(u,p);V.forEach(this.items,function(w,x){if(r<=x&&x<=q){if(!t[x]){o.push(x);}}else{if(t[x]){n.push(x);}}});this.addSelect(o);this.removeSelect(n);}function P(){return !mstrmojo.resolveFeature("hide-objects-description");}function Y(o){var n=mstrmojo.vi.enums.EnumDSSAccessRightFlags;return o.acg&&(o.acg&n.DssAccessRightUseFlag)&&(o.acg&n.DssAccessRightExecuteFlag);}function j(o,r){var q=o.itemsContainerNode,p=H.isMetaKey(r.src.hWin,r.src.e),u=H.eventTarget(r.src.hWin,r.src.e),n=-1;if(q&&u){V.forEach(q.childNodes,function(w,x){if(H.contains(w,u,true,w)){n=x;return false;}});}if(n!==-1){var t=o.items[n];if(!p&&!o.selectedIndices[n]){o.tree.clearTreeSelect();}if(V.indexOf(g,t.t)>=0){o.addSelect(n);}return true;}return false;}function c(p,n){var o=this.listSelector;if(o){o[p](this,this.itemsContainerNode,n);}}function M(o,p){var n=false;if(o.itemsContainerNode){V.forEach(o.ctxtBuilder.itemWidgets,function(q){if(H.contains(q.itemsContainerNode,p,q.domNode)){n=true;}});}return n;}mstrmojo.vi.ui.BrowserNodesAvatarContent=G.newComponent(mstrmojo.vi.ui.UnitList,null,{getItemProps:function(p,n){var o=this._super(p,n);o.addCls("isAvatar");return o;}});mstrmojo.vi.ui.TreeBrowserSelector=I.copy({premousedown:function(o,q,n){o.tree._selectNode=H.eventTarget(n.hWin,n.e);},premouseup:function D(z,n,AB){if(H.isPrimaryMouseBtn(AB.e)){var r=AB.hWin,u=AB.e,v=H.eventTarget(r,u),q=H.shiftKey(AB.hWin,AB.e),AA=z._shiftStartIndex,t=M(z,v),x=z.listMapper.findIndex(z,n,v);if(x>-1&&!t&&z.tree._selectNode===v){var o=V.indexOf(g,z.items[x].t)!==-1;if(q&&AA>-1&&o){z.rangeSelect(x);}else{z.toggleSelect(x);if(z.selectedIndices[x]&&o){z._shiftStartIndex=x;}}}}}},mstrmojo.TreeBrowserSelector);mstrmojo.vi.ui.TreeBrowser=G.newComponent(mstrmojo.TreeBrowser,[mstrmojo.vi.ui._HasUnitListAvatar],{containerResizable:false,draggable:true,avatarCssClass:"mstrmojo-VIUnitList",rangeSelect:L,_selectNode:null,_shiftStartIndex:-1,blockBegin:1,blockCount:50,getContent:function(o,t){o=o||this;var p=(o===this),n=this,u=function(v){if(p){mstrmojo.css.removeClass(n.domNode,["loading"]);}n.updateTreeContent(o,v);},q=function(v){o.contentRetrieved=true;o.set("items",[n.failItemCreaterFunc()]);mstrmojo.err(v);},r={success:u,failure:q};if(p){mstrmojo.css.addClass(n.domNode,["loading"]);}if(mstrApp.objectsBlockCount){this.blockCount=parseInt(mstrApp.objectsBlockCount,10);}this.getContentThroughTaskCall({isRoot:p,data:o.data,blockBegin:t||o.blockBegin,blockCount:parseInt(mstrApp.objectsBlockCount,10)||n.blockCount},r);},getDragData:function k(o){o.dragUnitHelper=new mstrmojo.vi.ui.VIDragUnit();var r=this,t=function(x){V.forEach(x.ctxtBuilder.itemWidgets,function(z){var AA=H.eventTarget(o.src.hWin,o.src.e);if(AA&&H.contains(z.itemsContainerNode,AA,true,z.itemsContainerNode)){r=z;t(z);return false;}});};t(this);var p=j(r,o);var u=p?this.getSelectedItems().filter(function(x){return V.indexOf(g,x.t)!==-1;}):null;var n=this.id,q=function q(x){var AB=mstrmojo.all[n],z=AB.avatar;if(z){var AA=[AB.avatarCssClass,"hasOwnAvatar",x];z.className=AA.join(" ");}};return{items:u,item:u&&u[0],src:mstrmojo.vi.models.EnumDragSources.ALL_OBJECT_LIST,setAvatarClass:function v(x){q(x);},setInvalidAvatarClass:function w(){q("icn clsx_sub");}};},getSelectedItems:function(){var n=this.ctxtBuilder,o=[];if(n){V.forEach(n.itemWidgets,function(p){if(p.state===1){o=o.concat(p.getSelectedItems());}});}o=(this._super()||[]).concat(o);return o;},createAvatar:function(p,o){var n=document.createElement("div");this.avatarContent=new mstrmojo.vi.ui.BrowserNodesAvatarContent({items:o.src.data.items});this.avatarContent.render();A.addClass(this.avatarContent.domNode,[F.getThemeClass.call(this)]);n.appendChild(this.avatarContent.domNode);return n;},ondragend:function(n){this._super(n);if(this.avatarContent&&this.avatarContent.destroy){this.avatarContent.destroy();}delete this.avatarContent;},isDragValid:function S(o){var n=o.src.data.items;return(n&&n.length)||this._super(o)||false;},contentRetrieved:false,onvisibleChange:function(){if(!this.contentRetrieved){this.getContent(this);}}});mstrmojo.vi.ui.TreeBrowserNode=G.newComponent(mstrmojo.TreeBrowserNode,[{_mixinName:"newClass"}],{containerResizable:false,draggable:false,_shiftStartIndex:-1,rangeSelect:L,premousedown:function(n){this.tree._selectNode=H.eventTarget(n.hWin,n.e);},premouseup:function(o){if(H.isPrimaryMouseBtn(o.e)){var t=H.isMetaKey(o.hWin,o.e),r=H.shiftKey(o.hWin,o.e),u=H.eventTarget(o.hWin,o.e),v=H.contains(this.itemsContainerNode,u,true,this.domNode),q=v&&M(this,u),p=(this.state===2),n=!p&&(u!==this.stateNode&&u!==this.textNode)&&!v;if(q||this.tree._selectNode!==u){return ;}if((!t&&!r)||this.tree.isSelectedFolder||n){this.tree.clearTreeSelect();}if(n){this.tree.isSelectedFolder=true;}else{if(!v){this.tree.isSelectedFolder=false;}}if(!p&&(u===this.stateNode||u===this.textNode)){this.toggleState();this.tree.updateScroller();H.stopPropogation(o.hWin,o.e);}else{if(v){c.call(this,"premouseup",o);}else{this.handleNodeClicked();}}}},getSelectedItems:function(){var n=this.ctxtBuilder,o=[];if(n){V.forEach(n.itemWidgets,function(p){if(p.state===1){o=o.concat(p.getSelectedItems());}});}o=(this._super()||[]).concat(o);return o;}});function Z(p){var o=this;return I.copy(p,{scriptClass:"mstrmojo.vi.ui.TreeBrowser",alias:"contents",slot:"containerNode",isSelectedFolder:false,browserNodeClass:mstrmojo.vi.ui.TreeBrowserNode,noCheckBox:true,itemIdField:"did",useRichTooltip:true,dataProvider:this.dataProvider,listSelector:mstrmojo.vi.ui.TreeBrowserSelector,showTooltip:function t(v,AC){var AB=v.target||H.eventTarget(v.hWin,v.e),AA=H.findWidget(AB),z=AA.data;if(z&&z.n){var w=AA.domNode.firstChild;var x='<div class="name">'+h.encodeHtmlString(z.n,true)+"</div>"+(z.desc?'<div  class="dsc">'+h.encodeHtmlString(z.desc,true)+"</div>":"");var u=H.position(w);this.richTooltip={posType:mstrmojo.tooltip.POS_TOPLEFT,cssClass:"vi-regular vi-tooltip-C",content:x,top:u.y-4,left:u.x+u.w+6};this.constructor.prototype.showTooltip.call(this,v,AC);}},updateScroller:function(){o.updateScrollbars();},isBranch:function(u){return u.t===8;},items:null,bindings:{data:"this.parent.rootFolder"},setDimensions:mstrmojo.emptyFn,item2textCss:function n(v){var x={8:"folder",3:"report",12:"attribute",4:"metric",47:"consolidation",1:"custom-group",0:"no-obj"},u=mstrmojo.TreeBrowser.prototype.item2textCss(v)||x[v.t],w=this.parent&&this.parent.highlightItems;if(w&&w.indexOf(v.did)!==-1){u+=" highlight";}return u;},onnodechange:function r(u){this.constructor.prototype.onnodechange.call(this,u);this.parent.onSelectedItemsChange(u);},getTotalSelections:function(){return[];},getContentThroughTaskCall:function q(AC,z){var u=this.parent,x=AC.data||{fty:u.rootFolderType},w=AC.isRoot,v=u.folderList,AA=AC.blockBegin,AB=AC.blockCount;this.dataProvider.fetchFolderContents({sId:mstrApp.sessionState,browsableTypes:u.getObjectSubTypes().join(","),includeObjectDesc:true,folderLinksContextId:u.folderLinksContextId||29,blockCount:AB||50},{fid:x.did,fty:x.fty,blockBegin:AA||1},{success:function(AE){var AD=AE.items?AE.items.filter(function(AG){return AG.t===8||Y(AG);}):[];z.success({items:AD.length?AD:[J],sz:AE.sz,bb:AE.bb,bc:AE.bc});if(w&&!v.initialized){v.set("items",AE.sc);var AF=V.find(AE.sc,"did",AE.did);if(AF!==-1){v.set("selectedIndex",AF);}}v.initialized=true;o.updateScrollbars();},failure:z.failure});}});}function e(o,p){if(o.state===2){var n=o.data;A.toggleClass(o.textNode,"highlight",n&&(p.indexOf(n.did)!==-1));}else{o.ctxtBuilder.itemWidgets.forEach(function(q){e(q,p);});}}mstrmojo.vi.ui.AllObjectsBrowser=mstrmojo.declare(mstrmojo.Container,[mstrmojo._HasLayout,mstrmojo.vi.ui._IsDropTarget,mstrmojo.vi.ui._IsViPanel,mstrmojo.ui._HasScroller,mstrmojo.vi.ui.toolbars._HasToolbar,mstrmojo.ui._HasUITheme],{scriptClass:"mstrmojo.vi.ui.AllObjectsBrowser",markupString:'<div id="{@id}" class="mstrmojo-VIPanel mstrmojo-VIAllObjectsBrowser {@cssClass}" style="{@cssText}"><div class="mstrmojo-VIPanel-titlebar"></div><div class="filter"></div><div class="search-box"></div><div class="horizontal-line"></div><div class="mstrmojo-VIPanel-contentContainer"><div style="overflow:hidden;"><div class="mstrmojo-VIPanel-content"></div></div></div></div>',markupSlots:{titlebarNode:function l(){return this.domNode.firstChild;},filterNode:function B(){return this.domNode.childNodes[1];},searchBox:function Q(){return this.domNode.childNodes[2];},contentNode:function m(){return this.domNode.childNodes[4].firstChild;},containerNode:function U(){return this.domNode.childNodes[4].firstChild.firstChild;}},title:mstrmojo.desc(5679,"All Objects"),model:null,rootFolder:null,rootFolderType:null,highlightItems:null,getObjectSubTypes:function(){var n=[2048,3072,1024];if(!mstrApp.isSingleTier){n.push(12032);n.push(257);n.push(2560);}return n;},layoutConfig:{h:{titlebarNode:"30px",filterNode:"30px",searchBox:"33px",containerNode:"100%"},w:{titlebarNode:"100%",searchBox:"100%",containerNode:"100%"},xt:true},opened:false,dataProvider:null,onSelectedItemsChange:mstrmojo.emptyFn,onopenedChange:function(){if(!this.searchList&&this.opened){var n=this.folderList,o=n.getSelectedItem(),p=this.rootFolder;if(o&&p&&o.did!==p.did){n.initialized=false;}this.addChildren([Z.call(this,{ondataChange:function(){if(this.data){this.getContent(this);}},ondblclick:this.dblClickOnNodes.bind(this)}),Z.call(this,{alias:"searchList",visible:false,contentRetrieved:true,ondblclick:this.dblClickOnNodes.bind(this)})]);}},reset:function(){if(this.contents){this.removeChildren(this.contents);}if(this.searchList){this.removeChildren(this.searchList);}},dblClickOnNodes:function N(o){var r=o.getTarget(),q=H.findWidget(r).data,p=this.model,n=p.getSelectedViUnit();if(n&&q&&V.indexOf(g,q.t)!==-1){this.dataProvider.loadObjects([q],{success:function(){var t=b.getCfgForAddUnitFromAllObject([q],p.datasets);if(n){n.getZonesModel().addUnitsFromDataSource([q],t.dsid,t.actions,p.getDatasetsUpdateCallback());}}},true);}},getSelectedItems:function K(){var o=this.contents,n=o.visible?o:this.searchList;return n.getSelectedItems();},getLayoutOffsets:function(){return{w:18,h:0};},children:[{scriptClass:"mstrmojo.vi.ui.CollapsibleTitleBar",cssClass:"vi-allObjects-tb",slot:"titlebarNode",alias:"titleBar",editTitleOnDoubleClick:false,getLayoutOffsets:function(){return{w:0,h:5};},onclick:function W(){this.close();},close:function(){this.parent.close();},bindings:{title:"this.parent.title"}},{scriptClass:"mstrmojo.ui.Pulldown",slot:"filterNode",alias:"folderList",initialized:false,getLayoutOffsets:function(){return{w:0,h:9};},onitemSelected:function(n){if(this.initialized){this.parent.set("rootFolder",n);this.parent.obSearchBox.clearSearch(true);}}},{scriptClass:"mstrmojo.ui.SearchBox",slot:"searchBox",alias:"obSearchBox",getLayoutOffsets:function(){return{w:0,h:13};},searchTriggered:function O(t){this.text=t;if(!t){this.clearSearch(true);return ;}var n=this.parent,q=n.contents.visible?n.contents:n.searchList,v=q.getSelectedItems(),o=n.folderList,p=this.parent.dataProvider,u=o.items[o.selectedIndex].did,r=this;v.forEach(function(w){if(w.t===8){u=w.did;return false;}});A.addClass(q.domNode,["loading"]);p.fetchFolderContents({browsableTypes:n.getObjectSubTypes().join(","),includeObjectDesc:true,folderLinksContextId:n.folderLinksContextId||29,blockCount:50,enableQuickSearch:!!(mstrApp.useQuickSearch&&mstrApp.useQuickSearch())},{fid:u,searchPattern:t,recursive:1},{success:function(w){A.removeClass(q.domNode,["loading"]);if(r.inputNode.value===t){n.contents.set("visible",false);n.searchList.set("visible",true);(n.searchList||this).set("items",w.items||[R]);n.updateScrollbars();}}});},onkeyup:function f(o){var n=o.hWin,p=o.e||n.event;if((mstrApp.useQuickSearch&&mstrApp.useQuickSearch())||((p.keyCode===13||p.keyCode===27||!this.inputNode.value))){this.constructor.prototype.onkeyup.call(this,o);}},postClearSearch:function(){var n=this.parent,p=n.contents,o=n.searchList;if(p){p.set("visible",true);}if(o){o.set("visible",false);}}}],getDropAvatarIcon:function C(n){return" ";},passToolbarCfg:function E(n){this.titleBar.set("toolbarCfg",n);},updateToolbar:function a(n){n.hasCloseButton=true;n.closeButtonText="";return n;},onhighlightItemsChange:function X(){var n=this.highlightItems;if(n){e(this.contents,n);e(this.searchList,n);}},setupScrollNodes:function d(){this.scrollNode=this.containerNode;},updateScrollbars:function(){this._super();if(this.scrollNode&&this.hasCustomScrollbar){var o=this.scrollNode,n=H.getComputedScrollbarWidth(o);o.style.marginRight=-n+"px";o.style.paddingRight=n+"px";}}});}());(function(){mstrmojo.requiresCls("mstrmojo.boxmodel","mstrmojo.dom","mstrmojo.num","mstrmojo.Button","mstrmojo.TextBox","mstrmojo.models.FormatModel","mstrmojo.vi.ui.rw.DocImage","mstrmojo.vi.models.editors.EditorModel","mstrmojo.ui.editors.controls.TwoColumnContainer","mstrmojo.vi.ui.ImageEditorPanelImagePicker");mstrmojo.requiresDescs(12057,13580,12059,12060,14552);var J=mstrmojo.vi.ui.rw.DocImage.EnumSizeModes,U=J.FIXED,I=J.FIT_TO_CONTAINER,M=J.FILL_CONTAINER,E=J.STRETCH,F=mstrmojo.dom,S=mstrmojo.boxmodel.px2Inches,V=mstrmojo.models.FormatModel,L=V.ENUM_PROPERTY_NAMES,Q=mstrmojo.num;var N=[{n:mstrmojo.desc(12057,"Fixed to"),v:U},{n:mstrmojo.desc(13580,"Fit to container"),v:I},{n:mstrmojo.desc(12059,"Fill container"),v:M},{n:mstrmojo.desc(12060,"Stretch"),v:E}];function H(g,h){var k=g.model,j=k.getZoomProps(),e=[].concat(h),d=function(m,o){var n,l;for(n=0,l=e.length;n<l;n++){if(e[n].propertyName===m){return e[n][o];}}},Z=function(l){if(l!==undefined){l=typeof l==="number"?l:Q.parseNumeric(l);return(l*j.zf*j.dpi).toFixed();}return NaN;},a=function(l){return{ih:Z(d("ih",l)),iw:Z(d("iw",l)),ism:d("ism",l),lock:d("lockAspectRatio",l)};},W=a("oldValue"),X=a("newValue"),f=g.parent,Y=f.parent.k,c=f.k,b=function(o){var n=k.getCurrentLayoutKey(),m=k.getLayoutUnitDefn(c,n),l=k.getPanel(Y,n);if(!m){return ;}if(o.ih!==undefined){m.ih=o.ih+"px";}if(o.iw!==undefined){m.iw=o.iw+"px";}if(o.ism!==undefined){m.ism=o.ism;}if(o.lock!==undefined){m.lock=o.lock;}l.selectVIUnit(l.rebuildChild(l.getUnitByKey(c)),true);};k.saveUnitFormatProperty(f,e,{success:b.bind(this,X)},mstrmojo.DocDataService.SUPPRESS_DATA,{undo:b.bind(this,W),redo:b.bind(this,X)});}function O(f,j){var g=f.model.getZoomProps(),c=f.getImageWidth(),d=f.getImageHeight(),Y=function(k){if(typeof j[k]!=="undefined"&&isNaN(j[k])){j[k]=(k==="iw")?parseInt(c):parseInt(d);}};Y("iw");Y("ih");var a=f.getCalculatedImageDimensions(j),e=a.h,h=a.w,Z=j.mode,b=[{formatType:1,propertyName:L.IMAGE_HEIGHT,newValue:S(g,e===undefined?d:e),oldValue:S(g,d)},{formatType:1,propertyName:L.IMAGE_WIDTH,newValue:S(g,h===undefined?c:h),oldValue:S(g,c)}];if(Z!==U){var W=f.defn.lock,X=Z!==E;if(X!==W){b=b.concat({formatType:1,propertyName:L.LOCK_ASPECT_RATIO,newValue:X,oldValue:W});}}return b;}function G(W){return O(W,{mode:J.ORIGINAL});}function B(X,W){return new mstrmojo.TextBox({value:X,valueChangeDelay:3000,onvalueChange:W,onkeydown:function(Y){if(Y.e.keyCode===13){this.blur();}}});}function K(){var W=this.getHost();var X=W.v;if(W.parent.isEmbedded){X=W.parent.embeddedImageName;}return B(X,function Y(){var Z=this.value;if(Z!==X){W.parent.urlEdited(Z);}});}function R(){var X=this.getHost();var Z=X.v;if(X.parent.isEmbedded){Z=X.parent.embeddedImageName;}var W=new mstrmojo.vi.ui.ImageEditorPanelImagePicker();W.slot="col1Node";W.imageBox=X.parent;var b=mstrmojo.Button.newWebButton(mstrmojo.desc(1442,"OK"),function(){X.parent.urlEdited(a.value);},false,{alias:"okBtn",slot:"col2Node",enabled:false});var Y=new mstrmojo.ui.editors.controls.TwoColumnContainer({col1Width:"50%",col2Width:"50%",children:[W,b]});var a=new mstrmojo.TextBox({value:Z,hint:mstrmojo.desc(14552,"Enter an image URL or choose a file."),onvalueChange:function(){var d=this.value;var c=!mstrmojo.string.isEmpty(d)&&(d!==Z);Y.okBtn.set("enabled",c);Y.okBtn.set("iconClass",c?"hot":"");},onkeydown:function(c){if(c.e.keyCode===13){if(Y.okBtn.enabled===true){Y.okBtn.onclick();}else{this.blur();}}}});return this.getEditorGroup([a,Y]);}function A(){var X=this.getHost(),Y=X.getSizeMode(),W=Math.max(N.map(function(Z){return Z.v;}).indexOf(Y),0);return this.getLabelAndControl(mstrmojo.desc(9735,"Size:"),this.getPulldown(N,function(a,Z){var b={mode:a,lock:X.isAspectRatioLocked()};H(X,O(X,b).concat({formatType:1,propertyName:L.IMAGE_SIZE_MODE,newValue:a,oldValue:Z}));},W));}function C(){var X=this.getHost(),Y=function Y(c,a){var b={mode:X.getSizeMode(),lock:X.isAspectRatioLocked()};b[c]=parseFloat(a);H(X,O(X,b));},W=this.getLabelAndControl("X:",B(X.getImageWidth(),function(a){Y(L.IMAGE_WIDTH,a.value);}),"20%","70%"),Z=this.getLabelAndControl("Y:",B(X.getImageHeight(),function(a){Y(L.IMAGE_HEIGHT,a.value);}),"30%","70%");W.slot="col1Node";Z.slot="col2Node";W.cssClass=Z.cssClass="dim-input";Z.cssClass+=" y";return new mstrmojo.ui.editors.controls.TwoColumnContainer({col1Width:"50%",col2Width:"50%",children:[W,Z],visible:X.getSizeMode()===U});}function D(){var X=this.getHost(),a=X.getSizeMode(),Z=a===I||a===M,W=a===E,b=Z?true:(W?false:X.isAspectRatioLocked()),Y=this.getCheckboxAndLabel(b,mstrmojo.desc(13639,"Lock aspect ratio"),function(d){var c=[{formatType:1,propertyName:L.LOCK_ASPECT_RATIO,newValue:d,oldValue:!d}];c=c.concat(O(X,{lock:d}));H(X,c);});Y.enabled=!Z&&!W;return Y;}mstrmojo.vi.models.editors.ImageEditorModel=mstrmojo.declare(mstrmojo.vi.models.editors.EditorModel,null,{scriptClass:"mstrmojo.vi.models.ImageEditorModel",help:"format_panel_image.htm",getChangeFormatPropertyFn:function(W,X){var Y=this.id;return function(b,Z){var e=mstrmojo.all[Y],d=e.docModel,j=e.getHost().parent,a=j.parent,f=j.k,h="domNode",g=[{formatType:X||1,propertyName:W,newValue:b,oldValue:Z}],c=function(m){var l,k;d.partialUpdate(m.data,d.getTargetDefn(f),m.defn,[f]);l=a.rebuildChild(a.getUnitByKey(f));k=l.defn.fmts;a.selectVIUnit(l,true);l.clearCache();l.clearSlotBackgroundCSS(h);l.applyCSSFormatToNode(h,k);};d.saveUnitFormatProperty(j,g,{success:c.bind(j)},mstrmojo.DocDataService.REQUEST_ONLY_DEFINITION);};},getEditorContents:function P(){var c=this.getHost(),a=c.getFormats(),Y=mstrmojo.Button.newWebButton(mstrmojo.desc(12061,"Restore to Original Size"),function(){H(c,c.getSizeMode()===U?G(c):G(c).concat({formatType:1,propertyName:L.IMAGE_SIZE_MODE,newValue:U,oldValue:c.getSizeMode()}));}),Z=this.getChangeGroupPropertyFn(),d=!!c.v||!!c.oid,b={showDivider:false,enabled:d,shouldPropagateEnabled:true};if(!mstrApp.allowWebDashboardDesign()){return[];}var X=!!mstrApp.enableEmbeddedImages&&!F.isIE9;var W=X?[R.call(this)]:[this.getEditorGroup([K.call(this)])];return W.concat([this.getEditorGroup([A.call(this)],{showDivider:X,enabled:d,shouldPropagateEnabled:true}),this.getEditorGroup([C.call(this)],b),this.getEditorGroup([D.call(this)],b),this.getEditorGroup([Y],b),this.getEditorGroup([this.getContainerGroup(a,function(){c.parent.clearCache();Z.apply(null,arguments);},NaN,{showBackgroundNoFill:false,showBackgroundGradient:true,showBorderNoFill:false})])]);}});}());(function(){mstrmojo.requiresCls("mstrmojo.vi.models.editors.EditorModel","mstrmojo.models.FormatModel","mstrmojo.ui.editors.controls.CharacterGroup","mstrmojo.ui.editors.controls.ContainerGroup","mstrmojo.vi.ui.TextAlignButtonBar","mstrmojo.ui.editors.CharacterToolbarPopup","mstrmojo.array","mstrmojo.hash","mstrmojo.VisEnum");var B=0,I=mstrmojo.ui.editors.controls.ContainerGroup.CTRL_FLAGS,W=mstrmojo.models.FormatModel,H=W.ENUM_PROPERTY_NAMES.TEXT_ALIGN,L=mstrmojo.hash,X=B,P=B,K=mstrmojo.VisEnum.SERVER_JSON_ERROR_TYPE;function M(d,Y,a,e,b){var Z=d===this.getTitleFormatCode(),c;if(a===H){c=function(f){return this.titleAlignButtonBar.items.filter(function(g){return g.v===f;})[0].id;}.bind(this);}this.getHost().parent.changeUnitFormats(Z,d,Y,a,e,b,c,function(f){this.raiseEvent({name:"BEMFormatChange",propertyName:a,value:f,isTitle:Z});}.bind(this));}function U(Z,a){var Y=new mstrmojo.vi.ui.TextAlignButtonBar({includeJustify:false});this.titleAlignButtonBar=Y;Y.singleSelect(Y.items.map(function(b){return b.id;}).indexOf(Z));Y.onValueChange=function(c,b){a(H,c,b);};return Y;}function C(a){var d=this.getHost().getFormats(),g=d.ttl,e=[];if(g){var b=this,Y=M.bind(this,this.getTitleFormatCode(),d),f=this.getHost(),Z=f.parent.getTitleBarVisibility(),c=[this.getCharacterGroup(Y,g),U.call(this,W.getFormatBlockValue(g,H),Y),this.getContainerGroup(g,Y,I.FILL_COLOR,{showBackgroundNoFill:false})];c.forEach(function(h){h.set("enabled",Z);});e.push(this.getEditorGroup([this.getGroupTitle(mstrmojo.desc(4756,"Title")),this.getCheckboxAndLabel(Z,mstrmojo.desc(13599,"Show titlebar"),function(j){var h=b.getHost();if(h){h.parent.toggleTitleBar(!!j);}})].concat(c),{cssClass:"bem-tc-title",showDivider:false}));}e.push(this.getEditorGroup([this.getGroupTitle(mstrmojo.desc(11917,"Container")),this.getContainerGroup(d,M.bind(this,1,d),this.getContainerCtrlFlags(),{showBackgroundNoFill:false,showBorderNoFill:false})],{cssClass:"bem-tc-container"}));this.replaceChildControls(a,e.concat(this.getTitleAndContainerControls()));}function D(Y){var a=this.getTargetPulldownItems(Y);var Z=this.getPulldown(a,function(b){if(a.length>1){X=b;}else{X=P;}a[a.map(function(c){return c.v;}).indexOf(b)].h(b);if(Y&&Y.postUpdateFn){Y.postUpdateFn();}});if(Z.items&&Z.items.length){Z.set("selectedIndex",Math.max(a.map(function(b){return b.v;}).indexOf(X),0));}return Z;}mstrmojo.vi.models.editors.BaseEditorModel=mstrmojo.declare(mstrmojo.vi.models.editors.EditorModel,null,{scriptClass:"mstrmojo.vi.models.editors.BaseEditorModel",titleAlignButtonBar:null,init:function Q(Y){this._super(Y);P=this.getInitialTarget(X);X=P;},selectTargetByValue:function N(Y){if(Y!==undefined){var Z=this._targetPulldown;if(Z){Z.selectItemByField("v",Y);}}},getInitialTarget:function V(){return B;},getEditorContents:function R(Y){var Z=this.getEditorGroup([],{cssClass:"bem-dynamic-grp",showDivider:false,isNested:true,isContainer:true,postUpdateFn:Y});var b=this._targetPulldown=D.call(this,Z),a=[Z].concat(this.getCommonControls());if(b.items.length>1){a.unshift(this.getEditorGroup([b]));}this.addDisposable(b);return a;},getFormattingToolbar:function F(Z,e,a){if(Z===B){var d=this.getHost(),Y=d.getFormats(),c=Y.ttl;if(c){c=L.copy(c);c[H]=this.titleAlignButtonBar.items.filter(function(f){return f.id===c["text-align"];})[0].v;var b=new mstrmojo.ui.editors.CharacterToolbarPopup(L.copy({onGroupValueChange:M.bind(this,this.getTitleFormatCode(),Y),textAlignJustify:false,textAlignFmtName:H,anchorElement:e},a));b.setFormatSource(c);return b;}}return null;},getCommonControls:function E(){return[];},getContainerCtrlFlags:function A(){return I.FILL_COLOR+I.BORDER;},getTitleAndContainerControls:function S(){return[];},getTargetPulldownItems:function G(Z){var b=this.getHost(),Y=b.getFormats(),a=[];if(Y&&(b.showTitleAndContainerFormats!==false)&&!mstrApp.isInVFConfigMode){a.push({n:mstrmojo.desc(12049,"Title and Container"),v:B,h:C.bind(this,Z)});}return a;},getTitleFormatCode:function J(){return 2;},isNormalOrExcludeAllDataButNotInPauseMode:function O(a){var Y=!a.isEmpty()||a.errorType===K.EMPTY_DATA,Z=mstrApp.isAppStatePause&&mstrApp.isAppStatePause();return Y&&!Z;}});mstrmojo.vi.models.editors.BaseEditorModel.TITLE_CONTAINER_VALUE=B;}());(function(){mstrmojo.requiresCls("mstrmojo.vi.models.editors.EditorModel","mstrmojo.ui.editors.CharacterToolbarPopup","mstrmojo.ui.editors.controls.CharacterGroup","mstrmojo.ui.editors.controls.ContainerGroup","mstrmojo.hash");var C=mstrmojo.models.FormatModel,E=C.ENUM_PROPERTY_NAMES;mstrmojo.vi.models.editors.TextEditorModel=mstrmojo.declare(mstrmojo.vi.models.editors.EditorModel,null,{scriptClass:"mstrmojo.vi.models.TextEditorModel",help:"format_panel_text.htm",getEditorContents:function D(){var R=this.getHost(),N=R.getFormats(),F=R.quillInstance;if(F){try{var O=F.getFormat();if(R.cacheGProps){N["background-color"]=R.cacheGProps;}N.font="";if(!O.size){N.font="10pt 'Arial'";}else{var U=(O.size).replace(/\D/g,"");N.font=U+"pt 'Arial'";}var V=R.stringsOfFonts,L=R.arrayOfFonts;if(O.font){var I=L.indexOf(O.font);if(I>-1){if(N.font.includes("'Arial'")){var K=(N.font).replace("Arial",V[I]);N.font=K;}else{var P=(N.font).split(" ");for(var G=0;G<P.length;G++){if(P[G].includes("pt")&&(""+P[G]).length<=4){N.font=P[G]+" "+V[I];}}}}}if(O.bold&&!(N.font).includes("bold")){N.font="bold "+N.font;}if(O.color){N.color=O.color;}else{N.color="#000000";}if(O.italic===true&&!(N.font).includes("italic")){N.font="italic "+N.font;}if(O.underline===true){N["text-decoration"]="underline";}else{N["text-decoration"]="";}if(O.strike===true&&!(N["text-decoration"]).includes("line-through")){N["text-decoration"]="line-through "+N["text-decoration"];}if(O.align==="left"){N["text-align"]="left";}else{if(O.align==="center"){N["text-align"]="center";}else{if(O.align==="right"){N["text-align"]="right";}else{if(O.align==="justify"){N["text-align"]="justify";}else{if(!O.align){N["text-align"]="left";}}}}}}catch(J){}}var S=this.getChangeGroupPropertyFn(),Q=new mstrmojo.ui.editors.controls.CharacterGroup({onGroupValueChange:S,showNoFillInColor:false}),M=this,H=new mstrmojo.ui.editors.controls.ContainerGroup({showBackgroundNoFill:false,showBackgroundGradient:true,showBorderNoFill:false,onGroupValueChange:function(){M.getHost().parent.clearCache();S.apply(null,arguments);}});if(!mstrApp.allowWebDashboardDesign()){return[];}Q.setFormatSource(N);H.setFormatSource(N);return[this.getEditorGroup([Q]),this.getEditorGroup([this.getTextAlign(N["text-align"]||"left",this.getChangeFormatPropertyFn(E.TEXT_ALIGN)),this.getWrapText(N["white-space"]!=="nowrap",this.getChangeFormatPropertyFn(E.TEXT_WRAP)),this.getTextDirection(N.fx&&N.fx.rt,this.getChangeFormatPropertyFn(E.TEXT_DIRECTION)),this.getOverflow(N.overflow==="auto",this.getChangeFormatPropertyFn(E.TEXT_OVERFLOW))]),this.getEditorGroup([H])];},getChangeFormatPropertyFn:function B(F,G){var H=this.id;return function(O,K){var L=mstrmojo.all[H],N=L.getHost().parent,J=L.docModel,I=[{formatType:G||1,propertyName:F,newValue:O,oldValue:K}],M=L.getHost();if(M.isQuill){if(M.hlText){M.renderRVText();M.formatHlText(I);M.parent.hideControlOverlay();M.updatedirCachDel();M.onUnselected();}else{M.processLocalFormat(I);}}else{J.saveUnitFormatProperty(N,I,{success:function(R){if(!(N&&N.parent)){N=J.getSelectedViUnit();}var Q=N.parent,S=N.k,P=N.boxContent;J.partialUpdate(null,J.getTargetDefn(S),R.defn,[S]);P.update(P.node);N.refresh();Q.selectVIUnit(N,true);}},mstrmojo.DocDataService.REQUEST_ONLY_DEFINITION);}};},getFormattingToolbar:function A(F,I,G){var H=new mstrmojo.ui.editors.CharacterToolbarPopup(mstrmojo.hash.copy({onGroupValueChange:this.getChangeGroupPropertyFn(),anchorElement:I},G));H.setFormatSource(this.getHost().getFormats());return H;}});}());(function(){mstrmojo.requiresCls("mstrmojo.string","mstrmojo.Button","mstrmojo.vi.models.editors.EditorModel","mstrmojo.ui.editors.controls.ContainerGroup","mstrmojo.models.FormatModel","mstrmojo.ui.ScrollableTextArea");var E=mstrmojo.string,B=mstrmojo.models.FormatModel;var F="url",D="htmlText";var A=[{n:mstrmojo.desc(4555,"iFrame"),v:0,id:0},{n:mstrmojo.desc(4554,"Html Text"),v:1,id:1}];function G(H,I,N,J){var M=this.getHost(),L=M.parent,K=function(O){B.updateFormatBlock(H,I,O);if(!L.parent){L=this.getHost().parent;}L.clearSlotBackgroundCSS("domNode");L.applyCSSFormatToNode("domNode",H);L.selectVIUnit(true);};this.docModel.saveUnitFormatProperty(L,[{formatType:undefined,propertyName:I,newValue:N,oldValue:J}],{success:K.bind(this,N,J)},mstrmojo.DocDataService.SUPPRESS_DATA,{silent:true,undo:K.bind(this,J,N),redo:K.bind(this,N,J)});}mstrmojo.vi.models.editors.HtmlContainerEditorModel=mstrmojo.declare(mstrmojo.vi.models.editors.EditorModel,null,{scriptClass:"mstrmojo.vi.models.HtmlContainerEditorModel",help:"format_panel_html_container.htm",getEditorContents:function C(){if(!mstrApp.allowWebDashboardDesign()||(!mstrApp.isSingleTier&&!mstrmojo.resolveFeature("create-html-container"))){return[];}var H=this.id,O=this.getHost(),J=O.node.data,N=O.parent,L=N.getHintText(),M=O.getFormats(),K=new mstrmojo.ui.editors.controls.ContainerGroup({showBackgroundNoFill:false,showBackgroundGradient:true,showBorderNoFill:false,onGroupValueChange:function(Q,S,R){G.call(mstrmojo.all[H],M,Q,S,R);}}),I=N.htmlType;K.setFormatSource(M);return[this.getEditorGroup([this.getButtonBar(A,I,function(R){var Q=R.v,S=this.parent.textArea;S.set("emptyText",L[Q]);S.value=N.defn[Q?D:F];S.refresh();},{alias:"typeBtn",showIcon:false,cssClass:"htmlTypeBtn"}),{scriptClass:"mstrmojo.ui.ScrollableTextArea",alias:"textArea",cssClass:"htmlText",value:E.decodeHtmlString(J.rv||J.v),emptyText:L[I],maxLength:undefined,keepEmpty:true,onfocus:function P(){N.setDefaultTextCaretPosition(this.inputNode,this.emptyText);if(this.inputNode.value===this.emptyText){this.scrollNode.scrollTop=35;}}},mstrmojo.Button.newWebButton(mstrmojo.desc(8708,"OK"),function(){var Q=this.parent;N.updateHtmlBox(Q.typeBtn.selectedItem.v,Q.textArea.value);N.hideControlOverlay();},true)]),this.getEditorGroup([K])];}});}());(function(){mstrmojo.requiresCls("mstrmojo.Dialog","mstrmojo.dom","mstrmojo.array","mstrmojo.hash","mstrmojo.Box","mstrmojo.vi.ui.toolbars._HasToolbar","mstrmojo.vi.ui.toolbars.Toolbar","mstrmojo.vi.ui.DatasetUnitMenuUtils","mstrmojo.vi.ui.rw._IsViewDataGrid","mstrmojo.vi.ui.rw.xtab.ViewDataXtabMenuConfig");mstrmojo.requiresClsP("mstrmojo.vi.models","VIComponentMap");var g=mstrmojo.array,b=mstrmojo.hash,d=mstrmojo.dom,a=mstrmojo.Button.newWebButton,O=mstrmojo.vi.ui.DatasetUnitMenuUtils,L=mstrmojo.vi.models,Z=L.VIComponentMap.TYPES,J=4,D=3,N=10,W,V=function V(k,l){var j=[],m=k.getDatasetUnits(["mx","att"]),h=l&&l.getDropZones();if(h&&h.zones){h.zones.forEach(function(n){n.items.forEach(function(o){if(parseInt(o.did,10)!==-1){j.push(m[g.find(m,"did",o.did)]);}});});}return j;},C=function(j,h,l){var k=V(j,h);return j.getDatasetUnits(["mx","att"],null,l).filter(function(m){return g.find(k,"did",m.did)===-1&&!m.hide;});},I=function I(){var n=this.grid,t=this.model,r=t.getSelectedViUnit(),j=r.boxContent.model.data.datasetId,o=r.getZonesModel(),m=[],k=function(x){x.tooltip=x.n+" ("+x.ds+")";return x;},w=C(t,o,j),q=(w.filter(function(x){return x.t!==4&&!n.model.hasSameRecursiveAttributeGroup(x,n.gridData);})).map(k),v=(w.filter(function(x){return x.t===4;})).map(k),l=function(x){var z={};(x||[]).forEach(function(AB,AA){if(g.find(V(t,n.zonesModel),"did",AB.did)>-1){z[AA]=true;}});return z;},u=function(x){return(x||[]).filter(function(z){return !z.hide||z.usedInDropZones;});},h=function(x){x.unshift({t:"All",formType:3,n:mstrmojo.desc(4928,"All"),tooltip:"Select All Objects"});return x;};function p(AA,x){x=u(x);x=h(x);if(x.length){var z=new mstrmojo.ui.CheckList({cssClass:"units",allIdx:0,items:x.map(function(AB){AB.tt=AB.n+" ("+AB.ds+")";AB.css=O.getUnitCssClass(AB);return AB;}),selectedIndices:l(x)});m.push({scriptClass:"mstrmojo.vi.ui.PanelPortlet",title:AA,children:[z],getSelectedItems:function(){var AB=z.getSelectedItems();if(AB.length>0&&AB[0].t=="All"){AB.shift();}return AB||[];}});}}p(mstrmojo.desc(3581,"Attributes"),O.getSortedDatasetUnits(q));p(mstrmojo.desc(3582,"Metrics"),O.getSortedDatasetUnits(v));return new mstrmojo.ui.menus.EditorConfig({data:{},cssClass:"mstrmojo-ui-Menu visible datasetObjects",contents:m,hostId:this.id,fnOk:function(){var AC=[],AI,AE,x=n.zonesModel,AA=x.getDropZones().zones,AG=AA[1],AJ=AA[0],AD=[],z=AG.items.length+1,AH=AJ.items.length+1,AB=V(x.docModel,x),AF=V(t,o);m.forEach(function(AK){AC=AC.concat(AK.getSelectedItems());});AI=(AC||[]).filter(function(AK){return g.find(AB,"did",AK.did)===-1;});AE=(AB||[]).filter(function(AK){if(AK.did==="-1"){return false;}return g.find(AC,"did",AK.did)===-1&&g.find(AF,"did",AK.did)===-1;});AI.forEach(function(AK){AD.push(n.model.getAddTemplateUnitAction(AK,j,(AK.t===4?AG:AJ).id,AK.t===4?z++:AH++));});AE.forEach(function(AK){AD.push(n.model.getRemoveTemplateUnitAction(AK));});n.controller.onSubmitTemplateUpdates(n,AD);}});},M=function(k,l,h){return{success:function m(o){var n=mstrmojo.insert({scriptClass:"mstrmojo.vi.ui.ViewDataDialog",grid:o,model:k,isViewFilter:l,showUnits:h});n.set("visible",true);n.render();},failure:function j(n){throw {message:"Couldn't open view data dialog <br>("+(n.message||"")+")",name:"Something went wrong"};}};},E=function(j){var h=mstrApp.isInVFConfigMode?Z.FILTER_STACK:Z.VIZ_CONTENT;return mstrApp.rootCtrl.docCtrl.view.builder.getLayoutVIMap(j.getCurrentLayoutKey()).getComponent(h).selectedKey;},A,S=function S(h){if(h&&mstrmojo.dom.isMetaKey(null,h)&&h.keyCode===65&&A){A.selectAll();return false;}return true;},K=function K(j){var k=mstrApp.isSingleTier,h=mstrApp.isWorkstation&&mstrApp.supportFeature(mstrmojo.vi.enums.EnumFeatures.SUPPORT_LIVEMODE)&&mstrApp.getWSLiveMode();if(mstrApp.isInVFConfigMode){return ;}if((k||!!mstrApp.features["web-export-to-excel-privilege"])&&!h){j.push({n:mstrmojo.desc(3958,"Excel"),v:J});}if(k||!!mstrApp.features["web-export-to-pdf-privilege"]){j.push({n:mstrmojo.desc(1877,"PDF"),v:D});}if(k||!!mstrApp.features["web-export-to-csv-privilege"]){j.push({n:mstrmojo.desc(11807,"Data"),v:N});}};B=function B(h){return{scriptClass:"mstrmojo.vi.ui.toolbars.Toolbar",alias:"toolbar",useRichTooltip:true,visible:h.showUnits};};F=function F(h){var j=this;return{scriptClass:"mstrmojo.ui.Pulldown",cssClass:"mstrmojo-export-type",alias:"exportType",value:mstrmojo.desc(13287,"Export Data"),isHostedWithin:true,items:h,visible:h.length>0&&f(A)>0,onitemSelected:function(k){this.selectedNode.innerHTML=mstrmojo.desc(121,"Export Data");j.xport(k.v);}};};X=function X(){var h=this;return{scriptClass:"mstrmojo.Button",cssClass:"mstrmojo-addGridButton mstrmojo-WebHoverButton",text:mstrmojo.desc(11893,"Add as Grid"),onclick:function(){h.close(true);},bindings:{visible:function(){return mstrApp.allowWebDashboardDesign();},enabled:function(){return !mstrApp.isLayoutModePreview();}}};};Y=function Y(){return{scriptClass:"mstrmojo.Label",alias:"rowCount",cssClass:"mstrmojo-rowcount",text:""};};U=function U(n,k){var o=B(n),j=X.call(this),m=F.call(this,k),h=Y(),l=[o,j,m,h];if(mstrApp.isInVFConfigMode||mstrApp.isAppStatePresentation()){l.splice(1,1);}return l;};f=function f(h){var j=h.gridData;return b.walk("rw.row.tc",j)||0;};mstrmojo.vi.ui.ViewDataDialog=mstrmojo.declare(mstrmojo.Editor,[mstrmojo.vi.ui.toolbars._HasToolbar],{scriptClass:"mstrmojo.vi.ui.ViewDataDialog",title:mstrmojo.desc(11476,"Show Data"),help:"Show_Data_dialog_box.htm",cssClass:"mstrmojo-ViewDataDialog",modal:true,visible:false,btnAlignment:"right",init:function c(k){var j=k.grid,l=this,h=[];this.grid=j;j.viewDataDialog=this;A=j;j.openPopup=function(){};j.model.canShowCellMenu=function(m){var n=j.model.getCellDataUnion(m);return !!m&&(n.length===0||(n.length===1&&!n[0].eid));};this.set("buttons",[a(mstrmojo.desc(2177,"Close"),function(){l.close();})]);K.call(this,h);k.children=[{scriptClass:"mstrmojo.Box",cssClass:"mstrmojo-toolBox",alias:"tools",children:U.call(l,k,h),slot:"containerNode"},{scriptClass:"mstrmojo.Box",cssClass:"mstrmojo-gridBox",children:[j],slot:"containerNode"}];d.attachEvent(document.body,"keydown",S);this._super(k);},postBuildRendering:function e(){this._super();var j=this.tools.exportType;if(j.visible){j.list.popupConfig.clear();}var h=document.createElement("textarea");h.className="hiddenArea";h.onblur=function(){h.focus();h.select();};this.editorNode.appendChild(h);this.grid.hiddenField=h;},openXtabCellMenu:function R(h){var k=mstrApp.rootCtrl.document,j=new mstrmojo.vi.ui.rw.xtab.ViewDataXtabMenuConfig({isHostedWithin:false,position:h.cmPos||d.position(h.btn.domNode),hostId:this.id});j.buildXtabMenuConfig(b.copy({tabularGrid:true,hideAdvancedSort:true},h));if(j.hasMenuItems()){h.opener=this;k.openPopup(j.newInstance(),h);}},closePopup:function(){var h=mstrApp.rootCtrl.document;if(h){h.closePopup();}},close:function Q(k){var j=this;d.detachEvent(document.body,"keyup",S);A=null;if(mstrApp.isAppStatePresentation()){this.model.controller.startAutoRefresh();}this.model.removeViewDataGrid(this.grid,!!k,W,{failure:function h(l){throw {name:"Something went wrong.",message:"Couldn't close view data dialog <br>("+(l.message||"")+")"};}});j.destroy();},xport:function P(j){var h=this.model.controller;switch(j){case N:h.exportCSV(this.grid.k);break;default:h.exportVisualization(this.grid,j);}},updateToolbar:function H(j){var m=this,k=this.model,o=k.getSelectedViUnit(),n=o.boxContent.model.data.datasetId,h=o.getZonesModel(),l=C(k,h,n);j.btns.push({n:mstrmojo.desc(11780,"Add Data"),cls:"add "+(!!mstrApp.isWSStyling?"mojo-theme-light":"mojo-theme-dark")+" mstrmojo-Button mstrmojo-WebButton"+(l.length===0?" disabled":""),fn:function(q,p){if(l.length!==0){p.openMenu(I.call(m),q);}}});return j;},passToolbarCfg:function G(h){this.tools.toolbar.set("toolbarCfg",h);},oncontextmenu:function(h){d.preventDefault(window,h.e);return false;},updateToolbarChildren:function(h){this.tools.rowCount.set("text",h);if(f(A)>0){this.tools.exportType.set("visible",true);}}});mstrmojo.vi.ui.ViewDataDialog.openDS=function(h,k,j){W=h.createViewDataGrid(h.getDatasetUnits(["mx","att"],null,j),h.getCurrentLayoutKey(),null,M(h,false,false),j);};mstrmojo.vi.ui.ViewDataDialog.openDSTable=function(h,l,j,k){W=h.createViewDataGrid(h.getDatasetUnits(["mx","att"],null,j,k),h.getCurrentLayoutKey(),null,M(h,false,false),j);};mstrmojo.vi.ui.ViewDataDialog.open=function(t,p){var n=t.getDocModel(),o=n.controller;if(o.autoRefReqSent){mstrApp.serverProxy.cancelRequest(o.autoRefReqId);}o.pauseAutoRefresh();t.selectVIUnit();var h=t.boxContent,u=h.isVisMap,j=u&&h.getXtabForSelection()?h.getXtabForSelection():h,m=j.model,v=m.data,r=t.getZonesModel(),l=u?r.getDropZones(true,j.k):r.getDropZones(),k=(h.getContextMenuSelections&&h.getContextMenuSelections())||{},q,w=function w(){W=n.createViewDataGrid(null,E(n),q,M(n,p,true),null,j,l);};if(p){q=m.getSelectorDataFromTemplateLimit(v.tpl)||[];q=q.concat({keepOnly:true,data:k});w();}else{w();}};}());(function(){mstrmojo.requiresCls("mstrmojo.Obj");mstrmojo.requiresClsP("mstrmojo.vi.viz","KnownVisualizations","VisualizationTransition","BaseVisualizationTransition","GridVisualizationTransition","GMVisualizationTransition","HeatMapVisualizationTransition","NetworkVisualizationTransition","MapVisualizationTransition","MapboxVisualizationTransition","ImageLayoutVisualizationTransition","CustomVisualizationTransition","KPICardVisualizationTransition");var B=mstrmojo.vi.viz;mstrmojo.vi.factories.VisualizationTransitionFactory=mstrmojo.declare(mstrmojo.Obj,null,{scriptClass:"mstrmojo.vi.factories.VisualizationTransitionFactory",newVisualizationTransition:function A(D,F){var C=B.KnownVisualizations,E=C.getDefinition(D);if(E!==undefined){switch(E.id){case C.GRID:return new B.GridVisualizationTransition(F);case C.NETWORK:return new B.NetworkVisualizationTransition(F);case C.GRAPHMATRIX:case C.NEWGRAPHMATRIX:return new B.GMVisualizationTransition(F);case C.HEATMAP:return new B.HeatMapVisualizationTransition(F);case C.ESRIMAP:case C.GOOGLEMAP:return new B.MapVisualizationTransition(F);case C.MAPBOX:return new B.MapboxVisualizationTransition(F);case C.IMAGELAYOUT:return new B.ImageLayoutVisualizationTransition(F);case C.KPICARD:return new B.KPICardVisualizationTransition(F);case C.UNKNOWN:return new B.BaseVisualizationTransition(F);case C.CUSTOM:return new B.CustomVisualizationTransition(F);}}return null;}});}());(function(){mstrmojo.requiresCls("mstrmojo.Container","mstrmojo._HasLayout","mstrmojo.mapbox.ui.selectors.OveralZoomSlider","mstrmojo.mapbox.ui.selectors.ClusterMaxZoomSlider","mstrmojo.mapbox.ui.selectors._SliderCommon","mstrmojo.dom","mstrmojo.tooltip");var B=mstrmojo.dom,A=mstrmojo.mapbox.ui.selectors._SliderCommon.getIndexByValue;mstrmojo.mapbox.ui.selectors.ClusterMaxZoomControl=mstrmojo.declare(mstrmojo.Container,[mstrmojo._HasLayout,mstrmojo.mapbox.ui.selectors._SliderCommon],{scriptClass:"mstrmojo.mapbox.ui.selectors.ClusterMaxZoomControl",cssClass:"mapbox-control-container mapbox-cluster-maxzoom-container",layoutConfig:{w:{containerNode:"100%",leftPadding:"7px",rightPadding:"7px"},xt:true},markupString:'<div class="{@cssClass}" style="{@cssText}" ></div>',markupSlots:{containerNode:function(){return this.domNode;},tooltipNode:function(){return[];}},markupMethods:{onvisibleChange:mstrmojo.Widget.visibleMarkupMethod,onenabledChange:mstrmojo.mapbox.ui.selectors._SliderCommon.enabledMarkupMethod},init:function C(J){if(!J.host){throw new Error(this.scriptClass+"must be initialized with a host which is a mapbox");}var H=J.host,G=H.mapViewer,E=G&&G.baseLayer,F,K=E.minZoom,D=E.maxZoom;F=[{scriptClass:"mstrmojo.mapbox.ui.selectors.OveralZoomSlider",alias:"overalSlider",baseLayer:E,items:this.generateItems(K,D),getIndexByValue:A,onselectionChange:function(){var L=this.cs2Vl;E.setZoom(L);},multiSelect:false,disableDnD:true,thumbWidth:14,_updateTooltip:function I(R,P){var N=B.eventTarget(P,R),O,W,V,S,M=null,U=null,Q='<div class="name">{@content}</div>',L='<div class="dsc">{@description}</div>',Y,X=false;switch(N){case this.handle2Node:O=mstrmojo.desc(15724,"Current zoom level of map:")+" "+Number(this.currentZoomLevel).toFixed(1);W=mstrmojo.desc(15725,"The value will update when you zoom.");V=mstrmojo.tooltip.POS_TOPLEFT;S="vi-tooltip-C ";U=-8;M=this.handle2Node.offsetWidth+16;X=true;break;default:break;}if(X&&this.enabled){Y={cssClass:"mstrmojo-VISlider vi-regular "+S+mstrApp.getThemeClassName(),content:Q.replace(/\{@content\}/g,O)+(W&&W.length>0?L.replace(/\{@description\}/g,W):""),contentNodeCssClass:"scm-tooltip",refNode:N,posType:V,left:M,top:U};this.set("richTooltip",Y);}},},{scriptClass:"mstrmojo.mapbox.ui.selectors.ClusterMaxZoomSlider",host:H,cssClass:"sc mapbox-cluster-maxzoom",items:this.generateItems(K,D,1),getIndexByValue:A}];this.children=F;this._super(J);}});}());(function(){mstrmojo.requiresCls("mstrmojo.array","mstrmojo.hash","mstrmojo.num","mstrmojo.VisEnum","mstrmojo.VisUtility","mstrmojo.gm.GMEnums","mstrmojo.color","mstrmojo.chart","mstrmojo.chart.common.Utility");mstrmojo.requiresClsP("mstrmojo.chart.enums","EnumGraphMajorType");mstrmojo.requiresClsP("mstrmojo.chart.model.enums","EnumDSSGraphObject");var p=mstrmojo,B=p.css,q=mstrmojo.array,Q=mstrmojo.hash,I=mstrmojo.num,H=mstrmojo.VisUtility,c=mstrmojo.chart,L=c.enums,d=L.EnumGraphMajorType,K=c.common.Utility,V=c.model,N=V.enums,z=N.EnumDSSGraphObject,AD=mstrmojo.VisEnum.ControlType,AA=p.gm,W=mstrmojo.gm.EnumTextAlignH,t=mstrmojo.gm.EnumTextAlignV,x=";",l=",",A="_tmsp",M=" ",a=-20,m=mstrmojo.gm.EnumSelectionOptionLevel,AF=mstrmojo.gm.EnumShape,h=mstrmojo.color,J=mstrmojo.gm.EnumIdentityType,S=0.00001,E,b=Math.pow(2,30),e=Math.pow(2,60);var g=["Reserved",mstrmojo.desc(2125,"Maximum"),mstrmojo.desc(2127,"Minimum"),mstrmojo.desc(2122,"Average"),mstrmojo.desc(2126,"Median"),mstrmojo.desc(4046,"First"),mstrmojo.desc(4049,"Last"),mstrmojo.desc(7194,"Constant")];function n(AL,AK){var AM,AJ=AL.length;if(AJ!==AK.length){return false;}for(AM=0;AM<AJ;AM++){if(AL[AM]!==AK[AM]){return false;}}return true;}function AE(AM,AK,AN){var AL=false,AO=AN+A,AJ=AM[AO],AP=AK[AO];if(AK[AN]===undefined){AL=true;}else{if((AP===undefined&&AJ!==undefined)||(AP!==undefined&&AJ!==undefined&&AP<AJ)){AL=true;}}if(AL){AK[AN]=AM[AN];if(AP!==undefined){AK[AO]=AJ;}}}function AI(AK,AJ){var AL;for(AL in AK){if(AK.hasOwnProperty(AL)){AE(AK,AJ,AL);}}return AJ;}function Y(AN){var AM={},AL,AK=[],AJ;q.forEach(AN,function(AO){if(AO!==undefined){AK.push(AO);}});AJ=AK.length;if(AJ===1){return AK[0];}for(AL=0;AL<AJ;AL++){AI(AK[AL],AM);}return AM;}function AC(AJ){return{n:AJ,s:AJ.toString(),on:AJ};}function Z(AL,AJ,AN){if(AJ===AL){return 0;}var AK=AJ-AL,AM=1;while(AK<1){AK*=10;AM/=10;}while(AK>=10){AK/=10;AM*=10;}if(AK<1.8){AM*=0.2;}else{if(AK<3.1){AM*=0.4;}else{if(AK<4.6){AM*=0.5;}else{if(AK>=8.1){AM*=2;}}}}if(AN){AM=Math.round(AM);if(AM<1){AM=1;}}return AM;}function C(AM,AQ,AS,AK){var AO=[];if(AM===AQ){if(AM<0){AO.push(mstrmojo.gm.GMUtility.formatNumber(AM,"nearest"));}AO.push({n:0,s:"0",on:0});if(AM>0){AO.push(mstrmojo.gm.GMUtility.formatNumber(AM,"nearest"));}return AO;}var AJ=AK>0?AK:Z(AM,AQ,AS);var AL=Math.ceil(AQ/AJ)*AJ;if(AL-AQ>=AJ*0.9){AL=Math.floor(AQ/AJ)*AJ;}var AP=Math.floor(AM/AJ)*AJ;if(AM-AP>=AJ*0.9){AP=Math.ceil(AM/AJ)*AJ;}var AR=Math.floor((AL-AP+AJ/100)/AJ)+1,AN;for(AN=0;AN<AR;++AN){AO.push(mstrmojo.gm.GMUtility.formatNumber(AP+AN*AJ,"nearest"));}return AO;}function U(AJ,AM){var AL;AJ.mMaxTick=1;if(this.mChartContextPtr.mIsGraphMatrix){AJ.mStep=this.mMinimum<0?0.2:0.1;if(AM.mUseCustomMinMax){var AK=AM;AJ.mMaxTick=AK.mAxisMaxValue;AJ.mMinTick=AK.mAxisMinValue;AJ.mMaxTick=Math.min(1,AJ.mMaxTick);AJ.mMinTick=Math.max(-1,AJ.mMinTick);AJ.mStep=0.1;}else{if(this.mMaximum>=0.5){AJ.mMaxTick=1;AJ.mMinTick=Math.floor(this.mMinimum/AJ.mStep)*AJ.mStep;AJ.mMinTick=(AJ.mMinTick*this.mMinimum<0)?0:(AJ.mMinTick>0?0:AJ.mMinTick);if(this.mMinimum<-0.5){AJ.mMinTick=-1;}}else{if(this.mMaximum>0){AJ.mMaxTick=Math.ceil(this.mMaximum/AJ.mStep)*AJ.mStep;AJ.mMinTick=-1;}else{AJ.mStep=0.1;AJ.mMaxTick=0;AJ.mMinTick=-1;}}}}else{AJ.mMinTick=(this.mMinimum<0)?-1:0;if(w.call(this,AJ)){return ;}AJ.mStep=this.mMajorGrid.mUseManualGrid?this.mMajorGrid.mGridInterval:(AJ.mMaxTick-AJ.mMinTick)/10;}for(AL=AJ.mMinTick+AJ.mStep;AL+c.gModuleMain.mTolerance<AJ.mMaxTick;AL+=AJ.mStep){AJ.mTicks.push(Math.round(AL*100)/100);}}function P(AJ,AO){var AN,AK,AQ=AO,AP=AQ.mDrawCustomLine,AL=AQ.mAxisCustomValue,AM;AJ.mStep=1;if(this.mMaximum<=0){AJ.mMinTick=1;AJ.mMaxTick=10;if(AP&&AL<=1){AQ.mAxisCustomValue=AJ.mMinTick;}return ;}if(this.mMinimum<=0){AK=this.mMaximum>1?0:-1;AJ.mMinTick=Math.pow(10,AK);if(AQ.mUseCustomMinMax){AJ.mMaxTick=this.mMaximum;AN=Math.floor(j.call(this,this.mMaximum));if(j.call(this,this.mMaximum)===AN){AN--;}}else{AN=Math.ceil(j.call(this,this.mMaximum));AJ.mMaxTick=Math.pow(10,AN);}for(AM=AK+1;AM<AN;++AM){AJ.mTicks.push(Math.pow(10,Math.floor(AM)));}if(AP&&AL<=0){AQ.mAxisCustomValue=Math.max(AJ.mMinTick,AQ.mAxisCustomValue);}return ;}if(AQ.mUseCustomMinMax){AN=j.call(this,this.mMaximum);AK=j.call(this,this.mMinimum);AJ.mMaxTick=this.mMaximum;AJ.mMinTick=this.mMinimum;}else{AN=Math.ceil(j.call(this,this.mMaximum));AK=Math.floor(j.call(this,this.mMinimum));AJ.mMaxTick=Math.pow(10,AN);AJ.mMinTick=Math.pow(10,AK);}for(AM=AK+1;AM<AN;++AM){AJ.mTicks.push(Math.pow(10,Math.floor(AM)));}if(AP&&AL<=0){AQ.mAxisCustomValue=AJ.mMinTick;}}function u(AT,AO){var AL=AO,AJ,AM;AT.mStep=f.call(this,this.mMaximum,this.mMinimum,AL.mAlwaysIncludeZero);AT.mMaxTick=Math.ceil(this.mMaximum/AT.mStep)*AT.mStep;AT.mMinTick=Math.floor(this.mMinimum/AT.mStep)*AT.mStep;AT.mMaxTick=AT.mMaxTick<this.mMaxmum?this.mMaxmum:AT.mMaxTick;AT.mMinTick=AT.mMinTick>this.mMinimum?this.mMinimum:AT.mMinTick;AT.mMinTick=(AT.mMinTick*this.mMinimum<0)?0:AT.mMinTick;if(AL.mAlwaysIncludeZero){AT.mMaxTick=(this.mMaximum<0)?0:AT.mMaxTick;AT.mMinTick=(this.mMinimum>0)?0:AT.mMinTick;}var AN=AT.mMaxTick-AT.mMinTick;if(AT.mStep>=AN){return ;}if(w.call(this,AT)){return ;}AJ=Math.floor((AT.mMaxTick-AT.mMinTick+AT.mStep/100)/AT.mStep)+1;var AP=this.mNumberFormat;for(AM=1;AM<AJ-1;++AM){var AR=AT.mMinTick+AM*AT.mStep,AS,AK,AQ;if(AT.mStep<1&&AP.mFormatType===4&&AP.mCustomFormat.indexOf("%")!==-1){AS=AR*100;if(!K.isIntegar(AS)){AK=Math.round(AS);AQ=Math.abs(AS-AK);if(AQ<S){AR=AK/100;}}}AT.mTicks.push(AR);}}function D(AT,AN){var AS=AN,AM,AJ,AQ,AL,AP,AO,AK,AR;AT.mMaxTick=AS.mAxisMaxValue;AT.mMinTick=AS.mAxisMinValue;if(w.call(this,AT)){return ;}if(!X.call(this)||this.mMajorGrid.mUseManualGrid){AT.mStep=f.call(this,AT.mMaxTick,AT.mMinTick,false);AM=AT.mMaxTick-AT.mMinTick;if(AT.mStep>=AM){return ;}AJ=Math.floor(AM/AT.mStep);if(!(this.mChartContextPtr.mIsTimeSeriesChart)&&AM===AJ*AT.mStep){for(AL=1;AL<AJ;++AL){AT.mTicks.push(AT.mMinTick+AL*AT.mStep);}}else{AM=AT.mMaxTick-AT.mMinTick;AQ=10;AP=false;for(AL=3;AL<AJ;++AL){AO=AM/AL;while(AO<1){AO*=10;}while(AO>=10){AO/=10;}if(AO===Math.floor(AO)){AQ=AL;AP=true;break;}}if(AP){AT.mStep=AM/AQ;for(AL=1;AL<AQ;++AL){AT.mTicks.push(AT.mMinTick+AL*AT.mStep);}}else{AK=Math.ceil((AT.mMinTick+AT.mStep/100)/AT.mStep)*AT.mStep;AR=Math.floor((AT.mMaxTick-AT.mStep/100-AK)/AT.mStep)+3;for(AL=0;AL<AR-2;++AL){AT.mTicks.push(AK+AL*AT.mStep);}}}}else{AM=AT.mMaxTick-AT.mMinTick;AQ=10;for(AL=6;AL<=9;++AL){AO=AM/AL;while(AO<10){AO*=10;}while(AO>=100){AO/=10;}if(AO===Math.floor(AO)){AQ=AL;break;}}AT.mStep=AM/AQ;for(AL=1;AL<AQ;++AL){AT.mTicks.push(AT.mMinTick+AL*AT.mStep);}}}function F(AJ,AN){var AM,AK,AL;AJ.mMaxTick=AN.mAxisMaxValue;if(AJ.mMaxTick<=this.mMinimum){this.mMinimum=AJ.mMaxTick-1;}AJ.mStep=f.call(this,AJ.mMaxTick,this.mMinimum,AN.mAlwaysIncludeZero&&(AJ.mMaxTick>0));AM=(AN.mAlwaysIncludeZero&&(this.mMinimum>0))?0:this.mMinimum;if(X.call(this)){AJ.mMinTick=AJ.mMaxTick-Math.ceil((AJ.mMaxTick-AM)/AJ.mStep)*AJ.mStep;}else{AJ.mMinTick=Math.floor(AM/AJ.mStep)*AJ.mStep;}if(w.call(this,AJ)){return ;}AK=Math.floor((AJ.mMaxTick-AJ.mStep/100-AJ.mMinTick)/AJ.mStep)+2;for(AL=1;AL<AK-1;++AL){AJ.mTicks.push(AJ.mMinTick+AL*AJ.mStep);}}function k(AJ,AO){var AK,AN,AL,AM;AJ.mMinTick=AO.mAxisMinValue;if(AJ.mMinTick>=this.mMaximum){this.mMaximum=AJ.mMinTick+1;}AJ.mStep=f.call(this,this.mMaximum,AJ.mMinTick,AO.mAlwaysIncludeZero&&(AJ.mMinTick<0));AK=(AO.mAlwaysIncludeZero&&(this.mMaximum<0))?0:this.mMaximum;if(X.call(this)){AJ.mMaxTick=AJ.mMinTick+Math.ceil((AK-AJ.mMinTick)/AJ.mStep)*AJ.mStep;}else{AJ.mMaxTick=Math.ceil(AK/AJ.mStep)*AJ.mStep;}if(w.call(this,AJ)){return ;}AN=Math.ceil((AJ.mMinTick+AJ.mStep/100)/AJ.mStep)*AJ.mStep;AL=Math.floor((AJ.mMaxTick-AN+AJ.mStep/100)/AJ.mStep)+2;for(AM=0;AM<AL-2;++AM){AJ.mTicks.push(AN+AM*AJ.mStep);}}function f(AZ,AT,AL){var AS,AN;if(this.mMajorGrid.mUseManualGrid){return this.mMajorGrid.mGridInterval;}AS=0;if(AL){AS=Math.max(AZ,AZ-AT);AS=Math.max(AS,-AT);}else{AS=AZ-AT;}if(AS===0){this.mIsShown=false;return 1;}if(AS>=1&&AS<=4&&parseInt(AS)===AS){var Aa=this.PrimaryMetricIndex,AO=Aa.length;for(var AV=0;AV<AO;AV++){var AR=this.mChartContextPtr.mDatasetPtr,AU=AR.dataProvider,AM=AU.getSeriesCount(),AQ=AU.getGroupCount(),AK=Aa[AV],AP,AX;for(var AY=0;AY<AM;AY++){AP=AU.getMetricIndexForSeries(AY);if(AP===AK){AX=true;for(var AW=0;AW<AQ;AW++){var Ab=AR.GetData(AY,AW);if(parseInt(Ab)!==Ab){AX=false;break;}}}if(AX){return 1;}}}}var AJ=AS;AN=1;while(AS<1){AS*=10;AN/=10;}while(AS>=10){AS/=10;AN*=10;}if(AS<1.8){AN*=2;AN/=10;}else{if(AS<3.1){AN*=4;AN/=10;}else{if(AS<4.6){AN*=5;AN/=10;}else{if(AS>=8.1){AN*=2;}}}}AN=this.postProcessStep(AN,AJ);return AN;}function w(AJ){if(this.mChartContextPtr.mIsGraphMatrix){return false;}var AK=this.mMajorGrid;return AK.mUseManualGrid&&(AK.mGridInterval<(AJ.mMaxTick-AJ.mMinTick)/30);}function j(AJ){return Math.log(AJ)/Math.log(10);}function X(){return(this.mGraphMajorType===d.GMT_HISTOGRAM||this.mGraphMajorType===d.GMT_POLAR)&&this.mTripleId.mObjectId===z.DssGraphX1Body;}function AB(AM){var AN=this,AJ=AN.id,AL=AM.metricId,AK=new p.ui.menus.MenuConfig();(AM.options).forEach(function(AO){if(AO!==AA.EnumRefLineModelType.CONST){AK.addMenuItem(g[AO],"xt",function(){AN.toggleRefLineEnabled(AL,AO,true);});}else{AK.addEditorMenuItem(g[AA.EnumRefLineModelType.CONST],AJ,function(){return new mstrmojo.ui.menus.EditorConfig({data:{},contents:[{scriptClass:"mstrmojo.ValidationTextBox",alias:"constVal",dtp:mstrmojo.expr.DTP.FLOAT,constraints:{trigger:mstrmojo.validation.TRIGGER.ONBLUR},onEnter:function(){this.validate();}}],fnOk:function(AQ,AP){var AR=AP.constVal;if(AR.isValid()){AN.toggleRefLineEnabled(AL,AO,true,AR.value);}}});});}});return AK;}function v(AL){var AM=this,AK=AL.metricId,AJ=new p.ui.menus.MenuConfig();(AL.options).forEach(function(AP){var AN=AP.refType,AO=g[AN]+((AN===AA.EnumRefLineModelType.CONST)?("-["+I.toLocaleString(AP.c)+"]"):"");AJ.addMenuItem(AO,"xt",function(){AM.toggleRefLineEnabled(AK,AN,false,0,AP.modix);});});return AJ;}function AG(AN,AJ){var AM=AN.GMController,AK=AM.getForbiddenShapeForMetric(AJ),AL=[];[{text:mstrmojo.desc(12097,"Bar"),value:AF.BAR},{text:mstrmojo.desc(2059,"Line"),value:AF.LINE},{text:mstrmojo.desc(9738,"Area"),value:AF.AREA},{text:mstrmojo.desc(12100,"Circle"),value:AF.CIRCLE},{text:mstrmojo.desc(12101,"Square"),value:AF.SQUARE},{text:mstrmojo.desc(12102,"Tick"),value:AF.TICK}].forEach(function(AO){if(AK.indexOf(AO.value)<0){AL.push(AO);}});if(AM.chartType===mstrmojo.gm.EnumGraphType.BAR||AM.chartType===mstrmojo.gm.EnumGraphType.LINE){AL=AL.filter(function(AO){return AO.value!==AF.AREA;});}return AL;}function r(AK,AJ){return function(AM,AL){if(AM!==AL){AJ({ctxt:{sp:AM,mid:AK}});}};}function AH(AM){var AK=AM.options,AJ=this.getMenuHandler("changeShape"),AL=new mstrmojo.ui.menus.MenuConfig();AL.addRadioMenuGroup(AM.currValue,r(AM.metricId,AJ),AK,"checkMark",undefined,true);return AL;}mstrmojo.gm.GMUtility=mstrmojo.provide("mstrmojo.gm.GMUtility",{mTimers:[],mUseTimer:true,timerId:0,timerHistory:[],timerHistoryMax:50,startTimer:function R(AK){if(this.mUseTimer){var AJ=this.timerId++;this.mTimers.push({timeStamp:new Date(),timerId:AJ,desc:AK.functionName+": "+AK.purpose});return AJ;}},endTimer:function G(AN,AP){if(this.mUseTimer){var AK,AL=this.mTimers,AQ=0;if(AN===undefined){AK=AL.pop();}else{var AO,AR;for(AO=0;AO<AL.length;AO++){AR=AL[AO];if(AR.timerId===AN){AK=AR;AL.splice(AO,1);AO--;}}}if(AK){var AJ=new Date();var AM=(AJ-AK.timeStamp);if(AP){this.timerHistory[this.timerId%this.timerHistoryMax]={desc:AK.desc,duration:AM,start:AK.timeStamp.getTime(),end:AJ.getTime()};}H.visPrint("%c"+AK.desc+": "+AM+"ms","color: blue");AQ=new Date()-AK.timeStamp;}return AQ;}},computeTicksForPercentchart:function(AK,AJ,AL){return C(AK,AJ,false,AL);},computeTicksForFlexMinMax:function(AK,AJ,AL,AM){return C(AK,AJ,AL,AM);},formatNumber:function(AL,AK,AJ){return AC(AL,AK,AJ===undefined?3:AJ);},sizeCalculator:{sum:function(AJ,AN,AO){var AL,AK=0,AM=0;if(AO===undefined){AO=AJ.length;}AN=AN||1;for(AL=0;AL<AO;AL++){if(AJ[AL]>0){AM+=AJ[AL];AK+=1;}}if(AK>1){AM+=(AK-1)*AN;}return AM;},add:function(AL,AJ,AK){AK=AK||1;if(AJ>0){AL+=(AJ+AK);}return AL;},minus:function(AL,AJ,AK){if(AJ>0){AL-=(AJ+AK);}return AL;}},replaceSpecialChars:function(AJ){return AJ.replace(/&/g,"&amp;").replace(/</g,"&lt;").replace(/>/g,"&gt;").replace(/"/g,"&quot;");},restoreSpecialChars:function(AJ){return AJ.replace(/&nbsp;/g," ").replace(/&lt;/g,"<").replace(/&gt;/g,">").replace(/&quot;/g,'"').replace(/&#039;/g,"'").replace(/&amp;/g,"&");},removeExtraSpace:function(AJ){return AJ.replace(/ {2,}/g," ");},stringToJSON:function(AJ){if(AJ===undefined){return undefined;}if(typeof AJ==="string"){AJ=AJ.replace(/'/g,'"');try{return JSON.parse(AJ);}catch(AK){return AJ;}}return AJ;},everythingToString:function(AK){if(AK===undefined){return undefined;}var AJ;if(typeof AK==="object"){AJ=JSON.stringify(AK.jsonObj||AK);}else{AJ=AK.toString();}AJ=AJ.replace(/"/g,"'");return AJ;},compareElementObj:function(AN,AK){var AM=AN.tid.toString(),AJ=AK.tid.toString(),AO=AN.eid,AL=AK.eid;if(AM!==AJ){return AM>AJ?1:-1;}if(AO===AL){return 0;}return AO>AL?1:-1;},isEqualComb:function(AK,AJ){var AO=true,AN,AM=AK.length,AL=AJ.length;if(AM!==AL){return false;}if(AK.length>1){AK.sort(this.compareElementObj);}if(AJ.length>1){AJ.sort(this.compareElementObj);}for(AN=0;AN<AM;AN++){if(this.compareElementObj(AK[AN],AJ[AN])!==0){AO=false;break;}}return AO;},serializeCombination:function(AK){var AJ="";if(AK.length>1){AK.sort(this.compareElementObj);}q.forEach(AK,function(AL){if(AJ!==""){AJ+=x;}AJ+=(AL.tid+l+AL.eid);});return AJ;},deserializeCombination:function(AK){var AL=AK.split(x),AJ=[];q.forEach(AL,function(AP){var AM=AP.split(l);var AO=AM[0];var AN=AM[1];AJ.push({tid:AO,eid:AN});});return AJ;},getElementCombinationForMetric:function(AJ){var AK=[];AK.push({tid:-1,eid:AJ});return AK;},getResolvedFormatsObject:function(AJ){return Y(AJ);},isDigitalArrayEqual:function(AK,AJ){return n.call(this,AK,AJ);},indexOf:function(AK,AM){var AL,AJ=AK.length;for(AL=0;AL<AJ;AL++){if(n(AK[AL],AM)){return AL;}}return -1;},parseAxisScaleData:function(AN){var AL,AO,AK,AJ=AN.split(","),AM=[];for(AL=0,AO=AJ.length;AL<AO;AL++){AK=AJ[AL].split(":");AM.push(AK);}return AM;},parseCSSColor:function(AN,AK){var AM=AN.slice(1),AJ=[],AL;if(AM.length===6){if(AK===true){AJ[0]=AM[4];AJ[1]=AM[5];AJ[2]=AM[2];AJ[3]=AM[3];AJ[4]=AM[0];AJ[5]=AM[1];}else{for(AL=0;AL<6;AL++){AJ[AL]=AM[AL];}}}else{if(AK===true){for(AL=2;AL>=0;AL--){AJ.push(AM[AL]);AJ.push(AM[AL]);}}else{for(AL=0;AL<3;AL++){AJ.push(AM[AL]);AJ.push(AM[AL]);}}}return parseInt("0x"+AJ.join(""),16);},RGB_BRG_Switch:function(AK){var AM=(AK>>16)&255,AL=(AK>>8)&255,AJ=(AK>>0)&255;return(AJ<<16)|(AL<<8)|(AM<<0);},encodeColor:function(AK){if(AK===undefined||AK===null||AK==="transparent"||AK==="default"){return AK;}var AL=false,AJ={};if(AL){if(typeof AK==="object"){AJ.c1=this.RGB_BRG_Switch(h.encodeColor(AK.c1));AJ.c2=this.RGB_BRG_Switch(h.encodeColor(AK.c2));AJ.or=AK.or;return AJ;}return this.RGB_BRG_Switch(h.encodeColor(AK));}if(typeof AK==="object"){AJ.c1=h.encodeColor(AK.c1);AJ.c2=h.encodeColor(AK.c2);AJ.or=AK.or;return AJ;}return h.encodeColor(AK);},checkEquality:function(AK,AJ){if(typeof AK==="object"&&AK.c1!==undefined){if(AK.c1!==AJ.c1){return false;}if(AK.c2!==AJ.c2){return false;}if(AK.or!==AJ.or){return false;}return true;}return AK===AJ;},decodeColor:function(AK){if(AK===undefined||AK===null||AK==="transparent"||AK==="default"){return AK;}var AL=false,AJ={};if(AL){if(typeof AK==="object"){AJ.c1=h.decodeColor(this.RGB_BRG_Switch(AK.c1));AJ.c2=h.decodeColor(this.RGB_BRG_Switch(AK.c2));AJ.or=AK.or;return AJ;}return h.decodeColor(this.RGB_BRG_Switch(AK));}if(typeof AK==="object"){AJ.c1=h.decodeColor(AK.c1);AJ.c2=h.decodeColor(AK.c2);AJ.or=AK.or;return AJ;}return h.decodeColor(AK);},getTrendLineToggleHandler:function(AJ,AL,AK){return function(){AJ.switchOnOffTrendLineForMetric(AL,AK);};},getTrendLineToggleState:function(AJ,AK){return AJ.queryTrendLineStatusForMetric(AK);},getEditTrendLineHandler:function(AJ,AK){return function(){mstrApp.rootCtrl.docCtrl.selectViPanel("propertiesPanel");AJ.raiseEventCMSelection(J.TREND_LINE,AK);};},getEditRefLineHandler:function(AJ,AK){return function(){mstrApp.rootCtrl.docCtrl.selectViPanel("propertiesPanel");AJ.raiseEventCMSelection(J.REF_LINE,AK);};},getEditAxisScaleHandler:function(AJ,AK){return function(){mstrApp.rootCtrl.docCtrl.selectViPanel("propertiesPanel");AJ.raiseEventCMSelection(J.AXIS_SCALE,AK);};},getEditAxisOriginHandler:function(AJ,AK){return function(){mstrApp.rootCtrl.docCtrl.selectViPanel("propertiesPanel");AJ.raiseEventCMSelection(J.AXIS_ORIGIN_DEFINE,AK);};},getEditLogScaleHandler:function(AJ,AK){return function(){mstrApp.rootCtrl.docCtrl.selectViPanel("propertiesPanel");AJ.raiseEventCMSelection(J.LOG_SCALE,AK);};},getOptionObjArr:function(AJ,AL,AN){if(!E){E=mstrmojo.gm.GMUtility;}var AK={},AM;if(AL!==undefined){AL=AL.toLowerCase();if(AL==="x1"){AL="x";}else{if(AL==="y1"){AL="y";}}}if(AJ.length>1||(AN&&AJ.length===1)){if(AL==="x"){AK.opt=mstrmojo.desc(11712,"Bottom Axis");AK.key="XAxis";}else{if(AL==="x2"){AK.opt=mstrmojo.desc(11710,"Top Axis");AK.key="X2Axis";}else{if(AL==="y"){AK.opt=mstrmojo.desc(11715,"Left Axis");AK.key="YAxis";}else{if(AL==="y2"){AK.opt=mstrmojo.desc(11713,"Right Axis");AK.key="Y2Axis";}else{if(AL==="z"){AK.opt=mstrmojo.desc(12090,"SizeBy");AK.key="SizeBy";}}}}}AK.optLvl=m.AXIS;AK.mos=this.getMetricFormatFromIndexArray(AJ);}else{if(AJ.length===1){AM=this.getMetricFormat(AJ[0]);AK.opt=AM.n;AK.mos=[AM];AK.key=AM.mId;AK.comb=E.getElementCombinationForMetric(AM.mId);AK.optLvl=m.METRIC;if(AL==="z"){AK.sizeBy=true;}}}return AK;},filterInValidMetricIndex:function(AK){var AJ=[];q.forEach(AK,function(AL){if(AL!==a){AJ.push(AL);}});return AJ;},fillBackgroundDiv:function(AK){var AJ=document.createElement("div");AJ.setAttribute("class","gm-bk-div");AJ.style.backgroundColor="rgba(0,0,0,0)";AK.appendChild(AJ);},getSubMenu:function(AO,AP,AN,AM){var AL=AG(AO,AM),AJ=AO.getMenuHandler("changeShape"),AK=AO.GMController.getOnTheFlyShapeForMetric(AM);if(AL.length>1){AP.addSubMenuItem(mstrmojo.desc(11972,"Change Shape"),"",AO.id,AH,{currValue:AK,options:AL,metricId:AN});}else{AP.addRadioMenuGroup(AK,r(AN,AJ),AL,"checkMark",undefined,true);}},getReferenceLineSubMenu:function(AK,AO,AP,AJ){var AQ=mstrmojo.gm.EnumSubtype,AN=AK.GMController.chartSubType;if(AP&&AN===AQ.PERCENT){return ;}var AR=AK.id,AL=AK.getAvailableRefLineTypes(AJ)||[];if(AL.length>0){AO.addSubMenuItem(mstrmojo.desc(13021,"Add Reference Line"),"xt",AR,AB,{metricId:AJ,options:AL});}var AM=AK.getExistingRefLineOptions(AJ)||[];if(AM.length>0){AO.addMenuItem(mstrmojo.desc(13659,"Edit Reference Line"),"xt",E.getEditRefLineHandler(AK,AJ));AO.addSubMenuItem(mstrmojo.desc(13022,"Remove Reference Line"),"xt",AR,v,{metricId:AJ,options:AM});}},reverseMapping:function o(AK){var AM={},AL,AJ=AK.length;for(AL=0;AL<AJ;AL++){AM[AK[AL]]=AL;}return AM;},longIntAnd:function(AK,AJ){var AL;if(AK===AJ){return AK;}if(AK>e||AJ>e){throw new Error("Operand exceeds valid data range.");}if(AK<b&&AJ<b){return AK&AJ;}if(AK>=b||AJ>=b){if(AK<AJ){AL=AK;AK=AJ;AJ=AL;}}var AN=Math.floor(AK/b),AM=Math.floor(AJ/b),AP=AK-AN*b,AO=AJ-AM*b;return(AP&AO)+(AN&AM)*b;},longIntOr:function(AK,AJ){var AL;if(AK===AJ){return AK;}if(AK<b&&AJ<b){return AK|AJ;}if(AK<AJ){AL=AK;AK=AJ;AJ=AL;}AL=this.longIntAnd(AK,AJ);return AJ-AL+AK;},parseNumeric:function(AJ){return +AJ||parseFloat(AJ);},fillImageInDiv:function(AM,AL,AK,AJ){AJ=AJ||"gm-img";AM.innerType=AL;if(AL===4){AM.innerHTML="<img class="+AJ+' src="'+AK+'"/>';}else{if(AL===7){AM.innerHTML=AK;B.addClass(AM.firstChild,AJ);}}},fillTextInDiv:function(AJ,AS,AU,AK,AV,AL,AX,AN,AQ){if(AK===undefined){AK=AJ.offsetWidth;}if(AV===undefined){AV=AJ.offsetHeight;}if(AN===undefined){AN=W.MIDDLE;}if(AQ===undefined){AQ=t.MIDDLE;}if(AL===undefined){AL=false;}AU=this.replaceSpecialChars(AU);var AR,AT,AP,AW=AL?"gm-text-body":"gm-text-body-nowrap",AM=false,AO;AR=H.measureTextWidth(AU,AX,6);AO=H.measureTextWidth("...",AX,6);if(AR>AK&&AO>AK){return ;}AP=document.createElement("div");AP.setAttribute("class",AW);AP.setAttribute("type",AD.GM_TEXT_BODY);AP.identity=AS;H.applyStyles2DomNode(AP,AX);AP.innerHTML=AU;AJ.appendChild(AP);if(AL){if(AR>AK){AT=AP.offsetHeight;}else{AT=H.measureTextHeight(AU,AX,4);}}else{AT=H.measureTextHeight(AU,AX,4);AM=AR>AK;}AR=Math.min(AR,AK);AP.style.width=AR+"px";if(AL){AM=AP.scrollWidth>AR||AP.scrollHeight>AT;}if(AM){AP.setAttribute("title",AU);}else{AP.setAttribute("title","");}switch(AN){case W.LEFT:AP.style.left="0px";AP.style.textAlign="left";break;case W.MIDDLE:AP.style.left=((AK-AR)>>1)+"px";break;case W.RIGHT:AP.style.right="0px";AP.style.textAlign="right";break;}switch(AQ){case t.TOP:AP.style.top="0px";break;case t.MIDDLE:AP.style.top=((AV-AT)>>1)+"px";break;case t.BOTTOM:AP.style.bottom="0px";break;}},updateTextColorAndAlignment:function(AJ,AL,AM){var AN=AJ.firstChild,AO=AN.style,AK=AJ.clientWidth,AP=AN.clientWidth,AR=AJ.clientHeight,AQ=AN.clientHeight;AO.left="auto";AO.right="auto";switch(AL){case W.LEFT:AO.left="0px";break;case W.MIDDLE:AO.left=((AK-AP)>>1)+"px";break;case W.RIGHT:AO.right="0px";break;}AO.top="auto";AO.bottom="auto";switch(AM){case t.TOP:AO.top="0px";break;case t.MIDDLE:AO.top=((AR-AQ)>>1)+"px";break;case t.BOTTOM:AO.bottom="0px";break;}},toggleDisplay:function(AK,AJ){if(!AK){return ;}if(AJ){AK.style.display="block";}else{AK.style.display="none";}},isTrendLineAvailableForMetric:function(AN,AO,AR){var AY=AN&&AN.excludeData,AV=mstrmojo.gm.EnumSubtype,AQ=p.gm.EnumShape,AW=AN.GMController,AS=AW.chartSubType,AX=AN.model.data.dz,AL=AX.XAxis,AJ=AX.YAxis,AM=AX.BreakBy,AP=AX.SliceBy,AT=AR,AK=AW.getChartInfo(),AU=AW.getBreakByAttrsID().length>0||(AK.isABL&&((AL.MetricNames!==undefined)||(AJ.MetricNames!==undefined)||(AM.MetricNames!==undefined)||(AP.MetricNames!==undefined)));if(AT===undefined){AT=AW.getOnTheFlyShapeForMetric(AO);}if(AK.isABL&&AS===AV.PERCENT){AY=true;}if(AU&&!AK.isBubbleOrScatter&&(AT===AQ.BAR||AS===AV.STACKED||(AS===AV.AUTO&&AT===AQ.AREA))){AY=true;}if(AK.isABL){if(AL.TemplateUnit&&AL.TemplateUnit.length>1){AY=true;}if(AJ.TemplateUnit&&AJ.TemplateUnit.length>1){AY=true;}if(AL.TemplateUnit===undefined&&AJ.TemplateUnit===undefined){AY=true;}}AY=AY||this.isIgnoredMetric(AN,AO);return !AY;},isTrendLineAvailableForAnyMetric:function(AL){var AK=AL.model.data.gsi.mx,AJ;for(AJ in AK){if(this.isTrendLineAvailableForMetric(AL,AJ)){return true;}}return false;},isIgnoredMetric:function(AM,AK){var AL=AM.GMController,AN,AJ;if(AL.bubbleSeriesNum!==undefined){AN=AL.getMetricsOnYAxis();AJ=AN.indexOf(AK);if(AJ>=AL.bubbleSeriesNum){return true;}AN=AL.getMetricsOnXAxis();AJ=AN.indexOf(AK);if(AJ>=AL.bubbleSeriesNum){return true;}}return false;},getAxisMetricsInfo:function(AO){var AJ=AO.model.data.dz,AP=AO.model.data.gsi.mx,AK,AL,AN=[];if(!AJ||!AJ.ColorBy||!AP){return AP;}var AM=function(AQ){return(AQ&&AQ.TemplateMetric)||[];};AK=AM(AJ.YAxis).concat(AM(AJ.XAxis));q.forEach(AP,function(AQ){AL=false;q.forEach(AK,function(AR){if(AQ.did===AR.id){AL=true;return false;}});if(AL){AN.push(AQ);}});return AN;},isInvalidTemplate:function O(AM){if(AM.eg){return false;}var AK=AM.gts;var AJ=AK.row.length===0&&AK.col.length===0;q.forEach(AK.row,function(AP){if(AP.otp===-1){AJ=true;}});var AO=AK.col;if(AO.length>0){var AL,AN=AO.length-1;for(AL=0;AL<AN;AL++){if(AO[AL].otp===-1){AJ=true;}}}return AJ;},isNoData:function(AJ){return AJ.eg!==undefined;},getInvalidTemplateErrMsg:function(AJ){return AJ||mstrmojo.desc(12094,"The Graph Matrix requires:")+"\n"+mstrmojo.desc(12095,"- at least one attribute to be placed on the row or column axis")+"\n"+mstrmojo.desc(12096,"- all metrics to be placed on the column axis, below any attributes");},initColorPickerBtnWithGradientDir:function(AK,AL){mstrmojo.func.override({showPickerForCurrentMode:function AJ(){this._super();if(this.pickerMode===2&&typeof this.color!=="object"){var AM=this.gradientOrientation,AN=AL.getChartInfo().dirc===mstrmojo.gm.EnumABLDirection.VERTICAL;AM.set("selectedIndex",q.find(AM.items,"id",AN?0:1));}}},AK.colorPicker);},generateToolTipContent:function(AS,AN,AJ,AO,AQ,AP,AV){var AM,AK,AL,AR,AT,AU;for(AM=AS;AM<AN;AM++){AK=AO[AM];AR=AQ[AM];if(AM>AS){AL=AO[AM-1];AT=AQ[AM-1];if(AK.id===AL.id){if(AR===""){continue;}if(AK.fid===AL.fid&&AR.idx===AT.idx){continue;}if(AK.n===""){AP[AP.length-1].v+=M+AR.n;continue;}}}if(AV){AP.push({n:AK.n,tid:AK.id,v:AR.n});}else{AU=AJ===undefined?AK.isRowAttribute:AJ;AP.push({n:AK.n,tid:AK.id,v:AR.n,eid:AR.id,tp:AK.otp,axis:AU?1:2,tui:AK.tui,ui:AK.tui,dpt:AK.tui+1,at:AR.at,isRowAttribute:AU,dei:AR.dei,o:AR.o});}}},getAttributeFormCnt:function(AJ){var AK;if((AJ.fcnt===undefined||AJ.fcnt===null)&&AJ.fs){AJ.fcnt=AJ.fs.length||1;}if(AJ.fcnt!==undefined&&AJ.fcnt!==null){AK=AJ.fcnt;}else{if(AJ.t===47){AK=1;}else{AK=AJ.cs!==undefined?AJ.cs:AJ.rs;}}return AK;},isTrueForBoolValue:function(AJ){return AJ===true||AJ==="true";},computeTicksForAxis:function(AM,AK){var AL=AM.mOptions,AN,AJ={mTicks:[]};if(AK){AN=Q.copy(AL);Q.copy(AK,AN);}else{AN=AL;}if(AM.mIsPercent){U.call(AM,AJ,AN);return AJ;}if(AN.mUseLogarithmicScale){P.call(AM,AJ,AN);return AJ;}if(AM.mGraphMajorType===d.GMT_BUBBLE&&AM.mTripleId.mObjectId===z.DssGraphZBody){AJ.mMinTick=AN.mUseMinValue?AN.mAxisMinValue:AM.mMinimum;AJ.mMaxTick=AN.mUseMaxValue?AN.mAxisMaxValue:AM.mMaximum;if(AM.mMinTick>=AM.mMaxTick){AJ.mMaxTick=AJ.mMinTick+1;}return AJ;}if(!AN.mUseMaxValue&&!AN.mUseMinValue){u.call(AM,AJ,AN);}else{if(AN.mUseMaxValue&&AN.mUseMinValue){D.call(AM,AJ,AN);}else{if(AN.mUseMaxValue){F.call(AM,AJ,AN);}else{k.call(AM,AJ,AN);}}}return AJ;},computeTicksForLogScale:function(AL){var AK=AL.mOptions,AJ={mTicks:[]};P.call(AL,AJ,AK);return AJ;},destroyDisposable:function(AJ,AK){if(AK){q.removeItem(AJ.disposables,AK);AK.destroy();}},handleDestroy:function(AN,AM,AK){if(!AN){return ;}var AO,AL=0,AJ=AN.disposables,AP=(AJ&&AJ.length)||0;while(AL<AP){AO=AJ[AL];if((!AO.scriptClass||AM.indexOf(AO.scriptClass)<0)&&q.indexOf(AK,AO.id)===-1){this.destroyDisposable(AN,AO);}if(AJ.length<AP){AP=AJ.length;}else{AL++;}}}});}());(function(){mstrmojo.requiresCls("mstrmojo.array","mstrmojo.string","mstrmojo.Enum_Keys","mstrmojo.SimpleObjectInputBox");var D=mstrmojo.array,B=mstrmojo.dom,E=mstrmojo.Enum_Keys,A=mstrConfig.thousandsSep;var H={DEFAULT:1,ADDING:2,EMPTY:3,FULL:4};if(A===undefined){A=",";}var I;mstrmojo.TextBoxSelector=mstrmojo.declare(mstrmojo.SimpleObjectInputBox,null,{cssClass:"mstrmojo-TextBoxSelector",srcid:null,dataSourcesXML:null,maxItemWidth:"",preBuildRendering:function G(){this.set("maxItemWidth",parseInt(this.parent.contentNode.style.width,10));this._super();},prekeydown:function C(J){var L=J.e;switch(parseInt(L.keyCode||L.charCode,10)){case E.TAB:case E.ENTER:B.preventDefault(J.hWin,L);var M=this.inputBox.value;if(M){if(D.find(this.items,"v",M)===-1){this.onSuggestionItemSelect({n:M,v:M});}else{this.setDefaultState();}}break;case E.ESCAPE:this.setDefaultState();break;case E.BACKSPACE:if(!this.getSearchPattern()){B.preventDefault(J.hWin,L);var K=this.items&&this.items.concat();if(K&&K.length){K.splice(K.length-1,1);this.set("items",K);var N=this.id;window.setTimeout(function(){mstrmojo.all[N].set("state",H.ADDING);},0);}}break;}},prekeyup:function F(J){}});}());(function(){mstrmojo.requiresCls("mstrmojo.array","mstrmojo.string","mstrmojo.elementHelper","mstrmojo.SimpleObjectInputBox","mstrmojo._HasTooltip","mstrmojo.mstr.EnumDSSXMLObjectTypes");var N=mstrmojo.array,H=mstrmojo.dom,B=mstrmojo.Enum_Keys,P=mstrmojo.hash,c=mstrmojo.mstr.EnumDSSXMLObjectTypes,Q=mstrConfig.thousandsSep;if(Q===undefined){Q=",";}var K=2147762227,X=2147762262,I=2147762269,L=140,O=118,Y=350,J=-100,W=-101,C=64;var U;mstrmojo.SearchBoxSelectorList=mstrmojo.declare(mstrmojo.SuggestionList,null,{postBuildRendering:function V(){var f=this._super(),d=this.parent,h=d.id;if(!this.onScroll){this.onScroll=function e(){var j=mstrmojo.all[h],k=j.domNode;if(!j.isFetching&&Math.ceil(k.offsetHeight+k.scrollTop)>=k.scrollHeight){j.isFetching=true;j.opener.getCandidatesThroughTaskCall({isIncFetch:true},{});}};}var g=d.domNode;if(d.supportsIncFetch){H.attachEvent(g,"scroll",this.onScroll);}else{H.detachEvent(g,"scroll",this.onScroll);}return f;},getItemMarkup:function(e,d){if(!U){U=this._super(e,d).replace(">{@"+this.itemField+"}<",">{@"+this.itemField+"}{@weight}<");}return U;},getItemProps:function b(f,d){var e=this._super(f,d),g=f.wt;e.weight=g?"<em>("+mstrmojo.num.addSeparators(g,Q)+" "+this.parent.opener.wtStr+")</em>":"";return e;},onmouseover:function(f,g){var d=f.e.srcElement;if(d.scrollWidth<=d.offsetWidth){d.title="";}},onclick:function(e){var h=this.parent.opener.suggestionItems,d=h.length;this._super(e);if(d<=1){return ;}var f=N.find(h,"t",J),g=this.getItemFromTarget(e.getTarget());if(g&&g.t&&g.t===J){N.forEach(h,function(j,k){if(!this.selectedIndices[k]){this.doItemSelect(j,{});}},this);}else{if(this.selectedIndices[f]){this.doItemSelect(h[f],{});}}}});mstrmojo.SearchBoxSelector=mstrmojo.declare(mstrmojo.SimpleObjectInputBox,[mstrmojo._HasTooltip],{scriptClass:"mstrmojo.SearchBoxSelector",cssClass:"mstrmojo-SearchBoxSelector",srcid:null,srct:c.Attribute,dataSourcesXML:null,useClientForm:false,maxItemWidth:"",wtStr:"likes",suggestionListClass:"mstrmojo.SearchBoxSelectorList",useRichTooltip:false,postCreate:function A(){var d=P.clone(this.suggestionPopup);d.cssClass="mstrmojo-SearchBoxSelector-suggest";d.nudge=function(){var p=this.domNode,h=this.containerNode;if(!p){return ;}var m=Math.min(h&&h.offsetHeight||L,(mstrApp&&mstrApp.MAX_SUGGESTION_POPUP_HEIGHT)||L),e=p.offsetWidth,f=H.windowDim(),g=parseInt(this.left,10),k=parseInt(this.top,10);if(k+m>=f.h){k=Math.max(k-m-(this.target?this.target.offsetHeight:0),0);if(k+m>=f.h){k=5;m=H.getMaxScrollHeight();}}if(g+e>=f.w){g=Math.max(g-e,0);}var o=p.style;o.top=k+"px";o.left=g+"px";o.maxHeight=m+"px";var l=this.opener,n=l&&l.width,j=H.position(p).w;if(n!==undefined&&j<parseInt(n,10)&&o.maxWidth!==n){o.maxWidth=n;this.nudge();}};this.suggestionPopup=d;},preBuildRendering:function D(){var d=this.parent.contentNode.offsetWidth||this.parent.width;this.set("maxItemWidth",parseInt(d,10));this._super();},postBuildRendering:function V(){var d=this.parent.defn.fmts;if(!d.height){this.domNode.style.height="auto";}return this._super();},filterCandidates:function a(e,h,d){var j=e,f=this.suggestCount;if(!this.noCache){d=d||f;if(h==="*"){h="";}else{h=mstrmojo.string.regEscape(h);}var k=this.itemField,g=new RegExp(h,"i");j=N.filter(e,function(l){return g.test(l[k]);},{max:d});}if(j.length){N.forEach(this.items,function(m){var l=N.find(j,"v",m.v);if(l>-1){j.splice(l,1);}});}return j;},getCandidatesThroughTaskCall:function G(z,AD){var r=this.id,k=this.getSuggestionTarget(),o=z.pattern||"",n=o,l=this.parent,u=this.srcid,p=z.isIncFetch,m=this._last_hit,AB=this,w=false,j;if(p){o=z.pattern=m.pattern;}if(o===""||o.trim()==="%"){return ;}if(u){var AC={taskId:"browseElements",styleName:"MojoAttributeStyle",attributeID:u,dataSourcesXML:this.dsrc||"",blockBegin:p?m.loadedCount:1,blockCount:this.items.length+this.suggestCount,searchPattern:o,rawInput:n,browseFlags:1,otp:this.srct},q=null;var f=l.defn;if(f.dsid){q={};q.datasetID=f.dsid;q.messageID=l.model.mid;q.ctlKey=l.ckey;}if(this.srct===c.Consolidation){AC.browseFlags=C;}var x=f.fs||f.sfs;if(x){var v="",h="";N.forEach(x,function(AE){v+=h+AE.did;h=";";});AC.searchForms=v;if(l.model.isnew||this.useClientForm){var AA="",d="",g=l.model,t=N.filterOne(g.getDatasetUnits(["att"]),function(AE){return AE.did===u;}),e=t.fs||[];N.forEach(x,function(AE){var AF=N.filterOne(e,function(AG){return AG.fid===AE.did;});AA+=d+AE.did+":"+(AF&&AF.bftp||0);d=";";});AC.clientFormPatterns=AA;}}AD.success=function(AM){var AI=mstrmojo.all[r],AG=AI&&AI.suggestionPopup,AL,AK,AO,AN,AF=z.pattern,AE=AI&&AI._searchQueue,AH=!AE||AE.length<=(p?0:1)||!AI.stifleIntermediateSearch;if(AI){if(AM&&AM.es){AL=AI.getSuggestionTarget();AK=AM.es.length;if(!AM||!AL||(k!==AL)){return ;}AO=AL.getSearchPattern();AN=AM.es;if(u){AN=mstrmojo.elementHelper.buildElemsTerseID(AN,u,true);}AI._last_hit={items:AN,pattern:AF,loadedCount:AM.bb+AK};AG.isFetching=false;if(AH){AG.supportsIncFetch=(AM.bb+AM.bc)<AM.sz;if(AO&&AO.indexOf(AF)>-1){var AJ=AI.filterCandidates(AN,AO);AI.updateSuggestion(p?AI.suggestionItems.concat(AJ):AJ);}if(AI.inputBox){AI.inputBox.focus();}if(!AI._ListenerProc){AI._ListenerProc=function(){var AP=AI.suggestionPopup;if(AP.visibile){AP.nudge();}};H.attachEvent(window,"resize",AI._ListenerProc);}}}else{if(AH){AI.updateSuggestion([]);}}}};AD.failure=function(AF){var AH=mstrmojo.all[r],AE=parseInt(AF.code,10)+4294967296,AG=(AE===K||AE===X||AE===I);if(!AG){mstrmojo.alert(AF.message);}if(AH&&AH.failMessage){AH.failMessage(AG?{errCode:AE,msg:AF.message}:{});}};AD.complete=function(){var AF=AB._searchQueue,AE=AF&&AF.pop();mstrApp.hideWait();if(AF&&AF.length&&AB.showSuggestion){AB._searchQueue=[];AB.showSuggestion(AE);}};if(this.hitEnterToTest){if(p&&this.onIncrementalFetch){this.onIncrementalFetch();}mstrApp.showWait({message:mstrmojo.desc(15823,'Searching "#"...').replace("#",o)});}else{if(!p){j=this._searchQueue;w=j&&j.length;if(!j){this._searchQueue=[];}this._searchQueue.push(o);}}if(!w){mstrmojo.elementHelper.browseElements(AD,AC,q);}}},destroy:function Z(d){if(this._ListenerProc){H.detachEvent(window,"resize",this._ListenerProc);delete this._ListenerProc;}this._super(d);},onsuggestionItemsChange:function F(){var h=this.suggestionItems,e=this.suggestionPopup,g=e.editorNode,m=h&&(h.length>8),l="",j="";if(m){l=(mstrApp&&mstrApp.MAX_SUGGESTION_POPUP_HEIGHT)||L;j="px";}if(g){g.style.maxHeight=l+j;}else{if(m){j+=";";e.cssText=(e.cssText||"")+"max-height:"+l+j;}}if(mstrApp.isExpress){var f=this.parent.contentNode.offsetWidth,d=(f===null||O<f)?O:f,k=(f===null||Y>f)?Y:f;e.cssText=(e.cssText||"")+"min-width:"+d+"px; max-width:"+k+"px;";}},getSuggestionPos:function R(){var d=this._super();if(d){d.lockIW=this;}return d;},updateSuggestion:function S(e){var d=e&&e.length;this.autoSelect=true;this.set("disableClick",false);if(this.parent.defn.multi&&d&&d>1){e=N.filter(e,function(g){return(g.v!=="u;"&&g.t!==14)&&(g.t!==J);});e.unshift({n:mstrmojo.desc(13976,"(All search results)"),t:J});this.autoSelect=false;}if(!d){e=[{n:mstrmojo.desc(13779,"No elements match your search"),t:W,cls:"nomatch"}];}if(e.length===1&&e[0].t===W){this.autoSelect=false;this.set("disableClick",true);}this._super(e);var f=this;f.mw=f.mw||function(k){var g=f._lastOpened;if(!g||!g.visible){H.detachEvent(document,H.isFF?"DOMMouseScroll":"mousewheel",f.mw);return ;}var j=H.eventTarget(self,k);var h=g.domNode;if(!H.contains(h,j,true,document.body)){g.close();H.detachEvent(document,H.isFF?"DOMMouseScroll":"mousewheel",f.mw);}};H.attachEvent(document,H.isFF?"DOMMouseScroll":"mousewheel",f.mw);},handleSuggestionItemSelect:function M(e,f){if(N.isArray(e)||e.t===J){e=N.ensureArray(e);var d=N.filter(e,function(g){return g.t!==J;});if(d.length<e.length){d=N.filter(this.suggestionItems,function(g){return g.t!==J;});}this.onSuggestionItemSelect(d);}else{this._super(e,f);}},prekeydown:function E(n){this._super(n);var k=n.e,o=(mstrApp&&mstrApp.MAX_SUGGESTION_POPUP_HEIGHT)||L,h=8,f=o/h;var g=this.getSelected();if(g){var j=g._renderIdx,d=(j-h+1)*f,m=(j-1)*f,l=this.suggestionPopup.domNode.scrollTop;switch(parseInt(k.keyCode||k.charCode,10)){case B.DOWN_ARROW:if(l<=d){this.suggestionPopup.domNode.scrollTop=d;}else{if(l>m){this.suggestionPopup.domNode.scrollTop=m;}}break;case B.UP_ARROW:if(l<=d||l>m){this.suggestionPopup.domNode.scrollTop=m;}break;}}}});}());(function(){mstrmojo.requiresCls("mstrmojo.vi.ui.rw.selectors.Slider","mstrmojo.vi.ui.rw.selectors.SliderHelper","mstrmojo.gmaps.MapEnums","mstrmojo.gmaps.MapUtils","mstrmojo.hash","mstrmojo.dom","mstrmojo.tooltip","mstrmojo.css","mstrmojo.ui.menus.MenuConfig","mstrmojo.ui.menus._HasMenuPopup","mstrmojo.VisUtility");var B=mstrmojo.hash,E=mstrmojo.dom,F=mstrmojo.css,C=mstrmojo.gmaps,G=C.MapUtils,K=C.EnumPropertyType,H=mstrmojo.VisUtility;mstrmojo.mapbox.ui.selectors.LayerZoomSlider=mstrmojo.declare(mstrmojo.vi.ui.rw.selectors.Slider,[mstrmojo.ui.menus._HasMenuPopup],{scriptClass:"mstrmojo.mapbox.ui.selectors.LayerZoomSlider",thumbWidth:3,cssBkBW:0,sliderDefaultWidth:140,multiSelect:true,markupString:'<div class="mstrmojo-VISlider mstrmojo-Slider {@cssClass} {@clsOrientation}" style="{@cssText}"><div class="sl-title"></div><div class="sl-control"></div><div class="cont" style="position:relative"><div class="bk" style="{@bkCssText}"></div><div class="sdc" style="position:absolute;{@sdcCssText}"><div class="sd" style="{@sdCssText}" mstrAttach:click><div class="bk left" style="{@lowerRangeCssText}"></div><div class="t1 {@handle1Exlcude}" style="{@handle1CssText}" mstrAttach:mouseout></div><div class="bk middle" style="{@thumbCssText}"></div><div class="t3 {@handle2Exlcude}" style="{@handel2CssText}" mstrAttach:mouseout></div><div class="bk right" style="{@upperRangeCssText}"></div></div></div><div class="mstrmojo-Label subscript left">{@lowText}</div><div class="mstrmojo-Label subscript right">{@highText}</div></div></div>',markupSlots:{titleNode:function(){return this.domNode.firstChild;},controlNode:function(){return this.domNode.childNodes[1];},dndNode:function(){return this.domNode.childNodes[2];},bgNode:function(){return this.domNode.childNodes[2].firstChild;},sdcNode:function(){return this.domNode.childNodes[2].childNodes[1];},containerNode:function(){return this.domNode.childNodes[2].childNodes[1].firstChild;},lowerRange:function(){return this.domNode.childNodes[2].childNodes[1].firstChild.firstChild;},handle1Node:function(){return this.domNode.childNodes[2].childNodes[1].firstChild.childNodes[1];},thumbNode:function(){return this.domNode.childNodes[2].childNodes[1].firstChild.childNodes[2];},handle2Node:function(){return this.domNode.childNodes[2].childNodes[1].firstChild.childNodes[3];},upperRange:function(){return this.domNode.childNodes[2].childNodes[1].firstChild.lastChild;},lowNode:function(){return this.domNode.childNodes[2].childNodes[2];},highNode:function(){return this.domNode.childNodes[2].childNodes[3];},tooltipNode:function(){return[this.domNode.childNodes[2].childNodes[1].firstChild.childNodes[0],this.domNode.childNodes[2].childNodes[1].firstChild.childNodes[1],this.domNode.childNodes[2].childNodes[1].firstChild.childNodes[2],this.domNode.childNodes[2].childNodes[1].firstChild.childNodes[3],this.domNode.childNodes[2].childNodes[1].firstChild.childNodes[4]];}},init:function Q(X){X=B.copy(X,{isHoriz:true,cssClass:"mapbox_layer_zoom_slider"});if(!X.layer){throw new Error(this.scriptClass+"must be initialized with a graphic layer.");}if(!X.items||!X.getIndexByValue){throw new Error(this.scriptClass+"must be initialized with items and getIndexByValue function.");}var V=X.layer,W=V.getLayerProp(K.minLayerZoomLvl),S=V.getLayerProp(K.maxLayerZoomLvl),U,R;X.minLayerZoomLvl=!G.checkDefined(W)?X.minZoom:parseFloat(W);X.maxLayerZoomLvl=!G.checkDefined(S)?X.maxZoom:parseFloat(S);U=X.getIndexByValue(X.maxLayerZoomLvl);R=X.getIndexByValue(X.minLayerZoomLvl);X.selectedIndices={};X.selectedIndices[U]=true;X.selectedIndices[R]=true;this._super(X);},updateTypeHelper:function A(){var R=B.walk("mapbox.ui.selectors.LayerSliderHelper",mstrmojo);this.typeHelper=new R({slider:this});},positionLayerName:function P(){if(!this.hasRendered){return ;}var S=this.layer,R=S&&S.getLayerName(),U=F.getComputedStyle(this.thumbNode),W={fontFamily:U.fontFamily,fontSize:U.fontSize,fontStyle:U.fontStyle,fontWeight:U.fontWeight},V=parseFloat(U.paddingLeft)+parseFloat(U.paddingRight),X=H.measureTextWidth(R,W,V);this.thumbNode.innerText="";this.upperRange.innerText="";this.lowerRange.innerText="";if(X<=this.thumbNode.offsetWidth){this.layerNameNode=this.thumbNode;}else{if(X<=this.upperRange.offsetWidth){this.layerNameNode=this.upperRange;}else{if(X<=this.lowerRange.offsetWidth){this.layerNameNode=this.lowerRange;}else{this.layerNameNode=this.thumbNode;}}}this.layerNameNode.innerText=R;this.layerNameWidth=X;this.layerName=R;},synchronizeSlider:function D(){this._super();this.positionLayerName();},onselectionChange:function J(){this._super();this.parent.onLayerSelectionChange(this);},initDrag:function O(S,R){if(this.enabled){this._super(S,R);}},_updateTooltip:function M(X,V){var S=E.eventTarget(V,X),U,a,Y,R,Z,W='<div class="name">{@content}</div>',c,b=false;a=mstrmojo.tooltip.POS_BOTTOMLEFT;Y="vi-tooltip-V ";Z=0;R=-7;switch(S){case this.handle1Node:U=String(this.cs1Nm).replace("$","$$$$");b=true;break;case this.handle2Node:U=String(this.cs2Nm).replace("$","$$$$");b=true;if(parseFloat(U)<1.5){W='<div class="name" style="font-weight: bold">'+mstrmojo.desc(15861,"## is not a safe level to stop showing layer.").replace("##","{@content}")+'</div><div class="dsc">'+mstrmojo.desc(15862,"You might never see this layer under certain screen resolution.")+"</div>";}break;case this.lowerRange:case this.thumbNode:case this.upperRange:if(this.layerNameWidth>this.layerNameNode.offsetWidth){U=this.layerName;b=true;R=0;}break;default:break;}if(b&&this.enabled){c={cssClass:"mstrmojo-VISlider vi-regular "+Y+mstrApp.getThemeClassName(),content:W.replace(/\{@content\}/g,U),contentNodeCssClass:"scm-tooltip",refNode:S,posType:a,left:R,top:Z};}else{c=null;}this.set("richTooltip",c);},destroy:function I(R){delete this.layer;this._super(R);}});mstrmojo._HasMarkup.addMarkupMethods(mstrmojo.mapbox.ui.selectors.LayerZoomSlider,{onenabledChange:function(){F.toggleClass(this.handle1Node,"enable",this.enabled);F.toggleClass(this.handle2Node,"enable",this.enabled);}});mstrmojo.mapbox.ui.selectors.LayerSliderHelper=mstrmojo.declare(mstrmojo.vi.ui.rw.selectors.SliderHelper,null,{scriptClass:" mstrmojo.mapbox.ui.selectors.LayerSliderHelper",updateSummary:function N(){},initialSlider:function L(){var R=this.slider;this._super();R.min=R.cs1Idx;R.max=R.cs2Idx;}});}());(function(){mstrmojo.requiresCls("mstrmojo.ui.ScrollableList","mstrmojo.color","mstrmojo.css","mstrmojo.array");var R=mstrmojo.css,H=mstrmojo.array,Q=mstrmojo.color,Y=mstrmojo.models.FormatModel,I=Y.ENUM_PROPERTY_NAMES,X="transparent",A="#000000",S="#2f9ad3",G="#ffffff",V,N,E;function O(){return this.docSelector.style===mstrmojo.DocSelector.STYLES.LINK;}function F(){return(this.isHoriz&&(this.orientation!=="v"))||(!this.isHoriz&&this.orientation==="h");}function K(a,c){if(O.call(this)){var Z=a.style,b=this.stateCssText[c];Z.background=b.bg;Z.color=b.text;}}function J(){if(this.itemWidthMode===1){var Z=Array.prototype.slice.call(this.itemsContainerNode.childNodes);if(Z.length>0&&Z.length<100){var d=mstrmojo.emptyFn;if(this.isHoriz){var c=this,b=Z.map(function(e){return e.offsetWidth;}),a=b.reduce(mstrmojo.array.fnReduceNumber);this.scaleConst=(this.domNode.clientWidth-(Z.length-1)*(O.call(this)?this.itemGap:0))/a;if(a>0){d=function(g,e,h){var f=b[e];g.minWidth=f+"px";g.width=f*h.scaleConst+"px";};}}else{d=function(e){e.minWidth=e.width="auto";};}Z.forEach(function(f,e){d(f.style,e,c);});}}}function B(b){var Z=this.domNode,a=document.createElement("div");R.addClass(a,"content");a.innerText=b;Z.style.display="flex";Z.innerHTML="";Z.appendChild(a);}function L(Z){this.toggle(Z);var a=this.domNode.style;if(a.display==="block"){a.display="flex";}}mstrmojo.vi.ui.rw.selectors.LinkList=mstrmojo.declare(mstrmojo.ui.ScrollableList,null,{scriptClass:"mstrmojo.vi.ui.rw.selectors.LinkList",markupString:'<div id="{@id}" class="mstrmojo-ListBase {@cssClass}" style="{@cssText}" mstrAttach:click,dblclick,mousemove,mouseover,mouseout,contextmenu><div class="list-content"><div class="items-container {@icnCss}" style="{@icnCssText}">{@itemsHtml}</div></div></div>',renderOnScroll:true,itemGap:1,init:function M(Z){this._super(Z);R.addWidgetCssClass(this,"mstrmojo-vi-sel-LinkList");if(F.call(this)&&this.itemWidthMode===0){R.addWidgetCssClass(this,"mstrmojo-vi-sel-LinkList-iwm");}if(!N){N=new mstrmojo.VisTooltip({widgetClass:"LinkList-Vis-Tooltip"});N.hide();N.render();}},listHooks:{select:function(Z){K.call(this,Z,"selected");},unselect:function(Z){K.call(this,Z,"base");}},onmousemove:function(b){var a=b.getTarget();if(!a||H.indexOf(a.classList,"item-wrapper")===-1){L.call(N);return ;}var Z={x:b.e.pageX,y:b.e.pageY};L.call(N,true);N.moveTo(Z.x,Z.y);if(E===a){return ;}E=a;if(!N.domNode.parentNode){document.body.appendChild(N.domNode);}B.call(N,a[a.innerText!==undefined?"innerText":"textContent"]);},onmouseout:function(Z){N.hide();E=null;},getItemMarkup:function D(a,Z){if(mstrmojo.string.isEmpty(a.n)){return this._super(a,Z).replace("{@en@n}",'<div class="item-wrapper">&nbsp;</div>');}if(!V){V=this._super(a,Z).replace("{@en@n}",'<div class="item-wrapper">{@en@n}</div>');}return V;},getItemProps:function W(g,e){var d=this._super(g,e),f=F.call(this),c=this.items.length,b=e===c-1;if(O.call(this)){var a=this.stateCssText,h=d.sel?a.selected:a.base;d.addStyle("background:"+h.bg+";color:"+h.text);if(f&&!b){d.addStyle("margin-right:"+this.itemGap+"px");}}if(this.itemWidthMode===0){d.addCls("equal-width");if(f){var Z=100/c;if(b){Z=100-((c-1)*Z);}if(O.call(this)){d.addStyle("width:calc("+Z+"% - "+this.itemGap+"px)");}else{d.addStyle("width:"+Z+"%");}}}return d;},preBuildRendering:function C(){if(O.call(this)){var a=this.docSelector,Z=a.getFormats(),d=this.getPropertyDefaultValue(I.SELECTOR_SELECTION_COLOR)||S,c=this.getPropertyDefaultValue(I.COLOR)||G,b=a.defn.ssc!==undefined?Y.decodeValue(I.SELECTOR_SELECTION_COLOR,a.defn.ssc):d;this.stateCssText={base:{bg:Z["background-color"]||X,text:Z.color||A},selected:{bg:b,text:Q.encodeColor(b)===Q.encodeColor(d)?c:Q.getContrastingColor(b,"#ffffff","#000000")}};}return this._super();},postBuildRendering:function P(){if(!O.call(this)){R.addClass(this.domNode,"buttons");}J.call(this);return this._super();},onclick:function(Z){var a=this.getItemFromTarget(Z.getTarget());if(a){this.doItemSelect(a,Z||{});}},getPropertyDefaultValue:function(a){var b=mstrApp.getThemeClassName(),Z=null;switch(a){case I.SELECTOR_SELECTION_COLOR:Z=b==="mojo-theme-light"?"#34ABEB":"#34ABEB";break;case I.COLOR:Z=b==="mojo-theme-light"?"#444649":"#ffffff";break;}return Z;},updateScrollbars:function U(){if(this.hasRendered&&this.orientation==="v"){this.scrollboxNode.style.height=this.height;}this._super();}});mstrmojo._HasMarkup.addMarkupMethods(mstrmojo.vi.ui.rw.selectors.LinkList,{onorientationChange:function(){J.call(this);}});}());(function(){mstrmojo.requiresCls("mstrmojo.array","mstrmojo.css","mstrmojo.dom","mstrmojo.expr","mstrmojo.hash","mstrmojo.Box","mstrmojo.Button","mstrmojo.Dial","mstrmojo.Editor","mstrmojo.FilterExpr","mstrmojo.HBox","mstrmojo.Label","mstrmojo.Obj","mstrmojo.CheckBox","mstrmojo.mstr.EnumNodeProperties","mstrmojo.warehouse.EnumObjectTypes","mstrmojo.fe.FilterExprTree","mstrmojo.fe.RelationFilterExprTree","mstrmojo.fe.CreateSetEditor","mstrmojo.fe.ConditionWalk","mstrmojo.ui.Pulldown","mstrmojo.ui.StatusButton");var a=mstrmojo.expr,I=a.ET,O=a.BRANCH_FNS,Y=mstrmojo.Obj,X=mstrmojo.dom,b=mstrmojo.array,S=mstrmojo.hash,e=mstrmojo.css,F=mstrmojo.mstr.EnumNodeProperties,C=mstrmojo.warehouse.EnumObjectTypes,K={TEMPLATE:0,DATASET:1},E=mstrmojo.mstr.EnumNodeDimty,Q=b.hash([E.NodeDimtyUnspecified,E.NodeDimtyNone]),M=200,H=mstrmojo.ui.PopupConfig.ENUM_CORNERS;function Z(){var h=this.avatar;if(h){h.parentNode.removeChild(h);delete this.avatar;e.removeClass(h,[this.avatarCssClass]);}}mstrmojo.fe.FilterEditorBase=mstrmojo.declare(mstrmojo.Editor,null,{onSave:null,onCancel:null,title:mstrmojo.desc(12032,"View Filter Editor"),help:"view_filter_editor_for_report_services_documents.htm",cssClass:"mstrmojo-charcoalboxe mstrmojo-FE",showLimits:true,objectBrowsingEnabled:false,children:null,showCondWalk:false,isNewCond:false,vizTitle:"",init:function U(h){this.children=[{alias:"feContent",scriptClass:"mstrmojo.Box",cssClass:"mstrmojo-FE-content",postCreate:function(){this.children=[{scriptClass:"mstrmojo.Box",cssClass:"mstrmojo-FE-exprTool",children:[{scriptClass:"mstrmojo.ui.StatusButton",cssClass:"mstrmojo-FE-addCondition",postCreate:function j(){this.editor=this.parent.parent.parent;this.statusList=this.editor.getAddConditionList();this.status=this.statusList[0];},onButtonClick:function(k){if(k){k.handler.apply(this.editor);}}}]},this.parent.getExpressionContainerCfg()];}},this.getConditionWalkConfig(),{alias:"buttonBar",scriptClass:"mstrmojo.HBox",cssClass:"mstrmojo-Editor-buttonBar",slot:"buttonNode",toggleBtnStatus:function(j){this.children[0].btnSave.set("enabled",j);this.children[0].btnCancel.set("enabled",j);},children:[{scriptClass:"mstrmojo.HBox",cssText:"float:right; border-collapse: separate",cellSpacing:3,children:[{scriptClass:"mstrmojo.Button",cssClass:"mstrmojo-WebButton hot",text:mstrmojo.desc(118,"Save"),alias:"btnSave",onclick:function(){var j=this.editor;j.save();j.close();},bindings:{enabled:function(){return !this.editor.readOnly;},editor:"this.parent.parent.parent"}},{scriptClass:"mstrmojo.Button",cssClass:"mstrmojo-WebButton",alias:"btnCancel",text:mstrmojo.desc(221,"Cancel"),onclick:function(){var j=this.editor;if(j.onCancel){j.onCancel(j.model);}j.close();},bindings:{editor:"this.parent.parent.parent"}}]}]}];this._super(h);this.model=this.model||new Y();},save:function W(){var h=this.model;h.expr=f(h.exprForest);h.limitExpr=f(c(h.limitExprForest));this.onSave(h);},getExpressionContainerCfg:function(){var h=this;return{alias:"feExpr",scriptClass:"mstrmojo.Box",cssClass:"mstrmojo-FE-expr-list",postCreate:function(){this.children=h.getExpressionContentsConfig();},onRender:function(){X.attachMarkupEvent(this.id,this.domNode,"mousedown");},onmousedown:function(j){var k=X.eventTarget(j.hWin,j.e);if(this.isBlankArea(k)){this.clearSelect();}},isBlankArea:function(j){return j===this.domNode;},clearSelect:function(){}};},getExpressionContentsConfig:function(){return[];},getConditionWalkConfig:function(){var j=this;return{scriptClass:"mstrmojo.rw.ConditionWalk",width:"750px",objectBrowsingEnabled:false,dimtyTypes:Q,alias:"walk",visible:false,onOK:function h(){var l=this.condition;j.feContent.set("visible",true);this.set("visible",false);j.onConditionEdit(l,this.model.get());j.toggleButtonStatus(true);j.set("showCondWalk",false);},close:function k(){j.feContent.set("visible",true);this.set("visible",false);var l=this.condition;if(l&&l.isEmpty()){l.del();}j.toggleButtonStatus(true);j.set("showCondWalk",false);},targets:null,targetsLastMod:null,ets:null,condition:null,bindings:{disableElementsBrowsing:"this.parent.disableElementsBrowsing"}};},onConditionEdit:function(j,h){j.tree.modifyConditionNode(j,h);},getAddConditionList:function d(){return[{n:mstrmojo.desc(1994,"Add Condition"),handler:function(){this.mainExpr.newCondition(null,true);}}];},toggleButtonStatus:function B(h){this.buttonBar.toggleBtnStatus(h);},andOrPopupRef:{scriptClass:"mstrmojo.Editor",cssClass:"mstrmojo-FE-andOrPopup mstrmojo-CGE-andOrPopup mstrmojo-ConditionWalk",contentNodeCssClass:"mstrmojo-balloon",slot:"containerNode",modal:false,autoClose:true,showTitle:false,draggable:false,openEffect:null,closeEffect:null,onOpen:function(){var h=this.condition,l=h&&h.data&&h.data.not,m=h&&h.parent,j=m&&m.data,k=(j&&j.fn)+(l?21:0);this.list.opening=true;this.list.set("selectedItem",isNaN(k)?null:{did:k});this.list.opening=false;},children:[{scriptClass:"mstrmojo.Dial",cssClass:"mstrmojo-CGE-andOrDial",alias:"list",itemMarkup:'<div class="dial-item {@css}">{@n}</div>',itemIdField:"did",renderOnScroll:false,items:[{did:19,n:O[19]},{did:20,n:O[20]},{did:19+21,n:O["19_21"]},{did:20+21,n:O["20_21"]}],onchange:function(){if(this.opening){return ;}var j=this.parent,h=j.condition,o=this.selectedItem,n=o&&o.did,m=n>21?true:null,l=n-(m?21:0);j.close();var k=h&&h.parent;if(k&&k.data&&k.data.et===I.ANDOR){k.edit(h,l,m);}else{var p=h&&h.data;if(p&&(p.not!==m)){p.not=m;h.paint();}}}}]},createSetPopupRef:{scriptClass:"mstrmojo.fe.CreateSetEditor",contentNodeCssClass:"",cssClass:"CreateSet-Editor",title:mstrmojo.desc(12034,"Create a Set"),slot:"containerNode"},_set_busy:function(j,h){if(h){this.set("enabled",false);this.set("iconClass","mstrmojo-WaitIcon");}else{this.set("enabled",true);this.set("iconClass","");}},_set_model:function(m,j){var k=this.model,l=k!==j;if(l){this.model=j;this.modelLastSet=new Date();var h=function(n){return P(J(n));};j.exprForest=h(j.expr);j.limitExprForest=h(j.limitExpr);if(this.feContent&&this.feContent.feExpr.ve){this.feContent.feExpr.ve.nameFactory.clear();}}return l;},onUpdateBrowseElementsParams:mstrmojo.emptyFn,openWalk:function(q,r,w,x){var u=this,j=X.delta(r.domNode,u.containerNode);j.y+=(w==="andor"?16:parseInt(r.domNode.offsetHeight,10));var v={condition:r,zIndex:u.zIndex+10,left:j.x+"px",top:j.y+"px"},h;switch(w){case"andor":if(u.skipAndOrPopup){return ;}h="andOrPopupRef";break;case"createSet":case"createSetOpt":if(x&&x.e&&x.e.target){var m=x&&x.e&&x.e.target,p=X.delta(m,u.containerNode);v.left=p.x+"px";v.top=p.y+parseInt(m.offsetHeight,10)+"px";}var t=u.model.targets;h="createSetPopupRef";v.type=w;v.model={attrs:b.filter(t,function(n){return n.t===C.ATTRIBUTE;}),metrics:b.filter(t,function(n){return n.t===C.METRIC;})};if(w==="createSetOpt"){v.condition=r.parent;v.model.childIdx=r.childIndex();}break;case"condition":var o=u.walk,k=r.textNode.cloneNode(true),l=o.conditionNode.firstChild;e.removeClass(k,"editable");e.addClass(o.conditionNode,"mstrmojo-ConditionNode");if(l.firstChild){l.removeChild(l.firstChild);}l.appendChild(k);o.set("objectBrowsingEnabled",u.objectBrowsingEnabled);o.set("targets",u.model.targets);o.set("targetsLastMod",u.modelLastSet);o.set("ets",r.tree.validExprTypes||u.validExprTypes);o.set("condition",r);o.set("model",S.clone(q));o.set("hasPrompt",u.model.hasPrompt);o.set("disableElementsBrowsing",u.disableElementsBrowsing||o.disableElementsBrowsing);o.set("editor",u);o.set("inRelation",r.inRelation);u.feContent.set("visible",false);o.set("visible",true);o.columnWalk.target.updateScrollbars();u.toggleButtonStatus(false);u.set("showCondWalk",true);u.set("isNewCond",!!q.isNew);return ;}u.openPopup(h,v);}});mstrmojo.fe._isReportFilterEditor=mstrmojo.provide("mstrmojo.fe._isReportFilterEditor",{_mixinName:"mstrmojo.fe._isReportFilterEditor",getExpressionContainerCfg:function(){var h=this._super();return mstrmojo.mixin({clearSelect:function(){this.re.clearTreeSelect();}},h);},getExpressionContentsConfig:function(){return[{alias:"re",scriptClass:"mstrmojo.fe.ReportFilterExprTree",level:K.DATASET,bindings:{items:"this.editor.model.exprForest || []"},postApplyProperties:function(){this.editor=this.parent.parent.parent;this.editor.set("mainExpr",this);}}];}});mstrmojo.fe.ReportFilterEditor=mstrmojo.declare(mstrmojo.fe.FilterEditorBase,[mstrmojo.fe._isReportFilterEditor],{scriptClass:"mstrmojo.fe.ReportFilterEditor"});mstrmojo.fe.ReportFilterExprTree=mstrmojo.declare(mstrmojo.fe.FilterExprTree,null,{scriptClass:"mstrmojo.fe.ReportFilterExprTree",cssClass:"mstrmojo-expr mstrmojo-FE-datasetExpr",onNew:function(h){h.data.isNew=true;this.editor.openWalk(h.data,h.widget.ctxtBuilder.itemWidgets[h.index],"condition");},onnodeclick:function A(h){var j=h.editor||this.tree.editor;j.openWalk(this.data,this,h&&h.part,h);},allowDrop:function G(h){var k=h&&h.src,m=k&&k.data,l=m&&m.et,j=k&&k.widget&&k.widget.tree;return l&&this!==j;}});mstrmojo.fe.FilterEditor=mstrmojo.declare(mstrmojo.fe.FilterEditorBase,null,{getExpressionContainerCfg:function(){var h=this._super();return mstrmojo.mixin({isBlankArea:function(j){if(this._super(j)){return true;}return !b.filterOne([this.ve,this.vle,this.re],function(k){if(k&&X.contains(k.domNode,j,true)){return true;}});},clearSelect:function(){this.ve.clearTreeSelect();this.vle.clearTreeSelect();}},h);},getExpressionContentsConfig:function(){return[{scriptClass:"mstrmojo.Label",text:mstrmojo.desc(11746,"Dataset Level Conditions"),cssClass:"mstrmojo-FE-expr-header dl",bindings:{visible:"true || this.parent.parent.parent.showLimits"}},{alias:"ve",scriptClass:"mstrmojo.fe.RWViewFilterExprTree",level:K.DATASET,bindings:{items:"this.editor.model.exprForest || []"},onBlankClick:function(h){this.parent.clearSelect(h);},supportRelation:true,postApplyProperties:function(){this.editor=this.parent.parent.parent;this.editor.set("mainExpr",this);}},{scriptClass:"mstrmojo.Label",text:mstrmojo.desc(11747,"Template Level Conditions"),cssClass:"mstrmojo-FE-expr-header tl",bindings:{visible:"this.parent.parent.parent.showLimits"}},{alias:"vle",scriptClass:"mstrmojo.fe.RWViewLimitExprTree",level:K.TEMPLATE,bindings:{visible:"this.editor.showLimits",items:"this.editor.model.limitExprForest || []"},onBlankClick:function(h){this.parent.clearSelect(h);},postApplyProperties:function(){this.editor=this.parent.parent.parent;this.editor.set("limitExpr",this);}}];},getConditionWalkConfig:function(){var h=this._super();S.copy({scriptClass:"mstrmojo.fe.ConditionWalk"},h);return h;},getAddConditionList:function d(){var h=this._super();h.push({n:mstrmojo.desc(12055,"Add Dynamic Condition"),handler:function(){this.mainExpr.newCondition({et:I.XML,idc:1,ph:{}},true);}});return h;},onConditionEdit:function(k,j){if(k.tree.level===k.level||k.tree.level===undefined){this._super(k,j);}else{k.parent.remove(k.data);var h=K.TEMPLATE===k.level?this.limitExpr:this.mainExpr;h.addSingleCondition(j);}}});mstrmojo.fe.RWViewFilterExprTree=mstrmojo.declare(mstrmojo.fe.RelationFilterExprTree,null,{scriptClass:"mstrmojo.fe.RWViewFilterExprTree",cssClass:"mstrmojo-expr mstrmojo-FE-datasetExpr",levelSwitchValidTypes:[I.MQ],onNew:function(h){h.data.isNew=true;if(!h.data.ph){this.editor.openWalk(h.data,h.widget.ctxtBuilder.itemWidgets[h.index],"condition");}},onnodeclick:function A(j){var h=this.tree,l=j.editor||h.editor;this.level=h.level;var k=typeof (l.disableElementsBrowsing)==="function"&&l.disableElementsBrowsing();if(k&&this.data.et===I.AE){return ;}l.openWalk(this.data,this,j&&j.part,j);},ondragend:function N(k){var j=k&&k.tgt,h=j&&j.widget;if(this.tree&&h&&h.tree&&h.tree!==this.tree){Z.call(this);return ;}this._super(k);},getItemConfig:function(k,h,l){var j=this._super(k,h,l);return S.copy({getConditionTextPostfix:function(){if(this.data.et!==I.MQ){return"";}return'<img class="mstrmojo-moveToViewLimit" src="../images/1ptrans.gif" title="'+mstrmojo.desc(4978,"Move to view limit")+'"onclick="var w = mstrmojo.all[\''+this.id+"']; w.tree.moveMQNodeToViewLimit(w); return false;\" />";}},j);},moveMQNodeToViewLimit:function(k){if(b.indexOf(this.levelSwitchValidTypes,k.data.et)===-1){return ;}var j=S.copy(k.data);k.parent.remove(k.data);var h=this.editor.limitExpr;h.addSingleCondition(j);},allowDrop:function G(h){var k=h&&h.src,n=k&&k.data,m=n&&n.et,l=this.tree,j=k&&k.widget&&k.widget.tree;return m&&(this===l?(j!==l):true);}});mstrmojo.fe.RWViewLimitExprTree=mstrmojo.declare(mstrmojo.fe.FilterExprTree,null,{scriptClass:"mstrmojo.fe.RWViewLimitExprTree",cssClass:"mstrmojo-expr mstrmojo-FE-limitExpr",validExprTypes:b.hash([I.MQ]),levelSwitchValidTypes:[I.MQ],onnodeclick:function A(j){var h=this.tree,k=h.editor;this.level=h.level;k.openWalk(this.data,this,j&&j.part,j);},onConditionEdit:function(j,h){this._super(j,h);j.data.mdxUnitId=j.data.m.did;V(j);},addSingleCondition:function(j){var h=this._super(j);V(h);},allowDrop:function(h){var l=h&&h.src,n=l&&l.data,m=n&&n.et,k=this.tree,j=l&&l.widget&&l.widget.tree;if(k===j){return this!==j&&this.data&&(this===l.parent||this.data.mdxUnitId===(n&&n.mdxUnitId));}return !(b.indexOf(this.levelSwitchValidTypes,m)===-1);},ondrop:function L(j){var m=j&&j.src,h=m&&m.widget;if(h&&h.tree!==this.tree){var l=m&&m.data;if(l&&l.index!==null){var k=h.ctxtBuilder.itemWidgets[l.index];k.tree.moveMQNodeToViewLimit(k);}m.data=null;}this._super(j);},isEditable:function(h){return h.mdxUnitId&&this._super(h);},ondragend:function R(h){var l=h&&h.tgt,j=l&&l.widget;if(j&&j.tree!==this.tree){var k=h.src&&h.src.data;if(k&&(k.indices||(k.index!==null))){this.remove(k.indices||k.index);}Z.call(this);}else{this._super(h);}},moveMQNodeToViewFilter:function(j){var h=this.editor.mainExpr;j.parent.remove(j.data);h.addSingleCondition(j.data);},getItemConfig:function(k,h,l){k.mdxUnitId=D(k);var j=this._super(k,h,l);return S.copy({cssClass:g(k,h,l)?"per-metric-limit":"",forbidRelation:true,getConditionTextPostfix:function(){if(this.data.et!==I.MQ||mstrmojo.rw.ConditionWalk.isMdxDM(this.data.m.did)){return"";}return'<img class="mstrmojo-moveToViewFilter" src="../images/1ptrans.gif" title="'+mstrmojo.desc(9746,"Move to view filter")+'"onclick="var w = mstrmojo.all[\''+this.id+"']; w.tree.moveMQNodeToViewFilter(w); return false;\" />";}},j);}});function P(j){var h=[];b.forEach(j,function(k){if(!k){return ;}if(k.et===I.ANDOR&&!(k.node&F.CONDITION)){k.nds=P(k.nds);if(k.nds.length===0){return ;}else{if(k.nds.length===1){var l=k.nds[0];if(k.not){l.not=!l.not;}h.push(l);return ;}}}h.push(k);});return h;}function J(h){return h?[h]:[];}function f(h){return h&&h.length===1?h[0]:null;}function c(k){var j=P(k),h;if(!j[0]||j[0].mdxUnitId){h={et:I.ANDOR,fn:a.FN.AND,nds:j};}else{h=j[0];}return[h];}function g(j,h,k){return(k===k.tree||k.parent===k.tree)&&!!j.mdxUnitId;}function D(j){if(!("mdxUnitId" in j)){var h;switch(j.et){case I.MQ:case I.MC:h=j.m.did||null;break;case I.ANDOR:b.forEach(j.nds,function(l){var k=D(l);if(h===undefined){h=k;}else{if(h!==k){h=null;return false;}}return true;});break;default:h=undefined;break;}j.mdxUnitId=h;}return j.mdxUnitId;}function V(n){var p=n.tree,o=p.ctxtBuilder.itemWidgets[0],t=n.parent,q=b.indexOf(t.items,n.data),l=t.items[q],j=l.mdxUnitId;if(t===p){return ;}if(t.data.mdxUnitId===j){return ;}if(o.data.mdxUnitId){var k={et:I.ANDOR,fn:a.FN.AND,nds:[o.data,l]};p.remove(0);p.add([k]);p.ctxtBuilder.itemWidgets[0].ctxtBuilder.itemWidgets[0].remove(l);}else{var m=o,h;b.forEach(o.data.nds,function(v,u){if(v.mdxUnitId===l.mdxUnitId&&o.items[u]!==l){m=o.ctxtBuilder.itemWidgets[u];h=u;return false;}});if(m===t){return ;}if(m.data.et!==I.ANDOR){var r={et:I.ANDOR,fn:a.FN.AND,nds:[m.data,l]};o.add([r],h+1);o.remove(m.data);}else{m.add([l]);}t.remove(l);}}}());(function(){mstrmojo.requiresCls("mstrmojo.Button","mstrmojo.mstr.search.Search");mstrmojo.mstr.search.SearchButton=mstrmojo.declare(mstrmojo.Button,null,{scriptClass:"mstrmojo.mstr.search.SearchButton",cssClass:"mstrmojo-SearchButton",onclick:function A(B){this.searchEditor=new mstrmojo.Editor({cssClass:"mstrmojo-Search-editor",zIndex:mstrmojo.mstr.search.Search.zIndex,children:[{scriptClass:"mstrmojo.mstr.search.Search",id:"search",searchProps:this.searchProps,showAsPopup:false,isQuickSearchEngineEnabled:mstrConfig.isQuickSearchEngineEnabled,enableQuickSearchPref:mstrConfig.enableQuickSearchPref,enableSearchAutoComplete:mstrConfig.enableSearchAutoComplete,searchAutoCompleteDelay:mstrConfig.searchAutoCompleteDelay}],onOpen:function(){var C=45;this.set("top",mstrmojo.dom.getVerticalScroll()+C+"px");window.setTimeout(function(){mstrmojo.all.search.inputNode.focus();},200);},onClose:function(){this.destroy();}});this.searchEditor.open();}});}());(function(){mstrmojo.requiresCls("mstrmojo.Container","mstrmojo._HasLayout","mstrmojo.DynamicClassFactory","mstrmojo.ListBase","mstrmojo._IsList","mstrmojo.array","mstrmojo.ui.pathbar.PathStarBurst","mstrmojo.ui.pathbar.PathNavigation","mstrmojo.ui.pathbar.PathAncestors","mstrmojo.ui.pathbar.PathExtraLinks","mstrmojo.ui.pathbar.PathHamburger","mstrmojo.ui.pathbar._PreAppExit","mstrmojo.mstr.search.SearchButton","mstrmojo.mstr.ui.CreateButton"," mstrmojo.ui._HasListTooltip");mstrmojo.ui.pathbar.List=mstrmojo.DynamicClassFactory.newComponent(mstrmojo.ListBase,[mstrmojo._IsList,mstrmojo.ui.pathbar._PreAppExit,mstrmojo.ui._HasListTooltip]);mstrmojo.ui.pathbar.ScrollableList=mstrmojo.DynamicClassFactory.newComponent(mstrmojo.ui.ScrollableList,[mstrmojo.ui._HasListTooltip]);function B(){var G=false,F=mstrApp.getPersistParams().hiddensections;if(F){G=mstrmojo.array.indexOf(F.split(","),"path")>=0;}return G;}function C(G){var F;for(F in G){return false;}return true;}function A(I){var G=I&&I.items,F=G&&G.length,H;for(H=F-1;H>=0;H--){if(C(G[H])){G.splice(H,1);}H--;}}mstrmojo.ui.pathbar.PathBar=mstrmojo.declare(mstrmojo.Container,[mstrmojo._HasLayout],{scriptClass:"mstrmojo.ui.pathbar.PathBar",markupString:'<div id="{@id}" class="mojoPath {@cssClass}" style="{@cssText}"><div id="mojoPath-starburst" class="mojoPath-starburst"></div><div id="mojoPath-navigation" class="mojoPath-navigation"></div><div id="mojoPath-path" class="mojoPath-path"></div><div id="mojoPath-toolbar" class="mojoPath-toolbar"></div><div id="mojoPath-create" class="mojoPath-create"></div><div id="mojoPath-search" class="mojoPath-search"></div><div id="mojoPath-extraLinks" class="mojoPath-extraLinks"></div></div>',markupSlots:{starburstNode:function(){return this.domNode.firstChild;},navigationNode:function(){return this.domNode.childNodes[1];},pathNode:function(){return this.domNode.childNodes[2];},toolbarNode:function(){return this.domNode.childNodes[3];},createNode:function(){return this.domNode.childNodes[4];},searchNode:function(){return this.domNode.childNodes[5];},extraLinksNode:function(){return this.domNode.lastChild;}},layoutConfig:{h:{starburstNode:"auto",navigationNode:"auto",pathNode:"auto",toolbarNode:"auto",createNode:"auto",searchNode:"auto",extraLinksNode:"auto"},w:{starburstNode:"auto",navigationNode:"auto",pathNode:"100%",toolbarNode:"auto",createNode:"auto",searchNode:"50px",extraLinksNode:"auto"}},getLayoutOffsets:function E(){return{h:2,w:0};},init:function D(I){if(B()){this.visible=false;return ;}var L=[];this._super(I);var G=this.pathInfo,J=G.sb,F=G.nb,K=G.pt,H=G.el,M=G.tbModelData&&G.tbModelData.n;A(M);if(J&&J.length>0){L.push({scriptClass:"mstrmojo.ui.pathbar.PathStarBurst",slot:"starburstNode",items:J});}if(F&&F.length>0){L.push({scriptClass:"mstrmojo.ui.pathbar.PathNavigation",slot:"navigationNode",items:F});mstrApp.prevPageHref=F[1]&&F[1].href;}if(K&&K.length>0){L.push({scriptClass:"mstrmojo.ui.pathbar.PathAncestors",slot:"pathNode",items:K,delimiter:G.dlmt});}if(H&&H.length>0){L.push({scriptClass:"mstrmojo.ui.pathbar.PathExtraLinks",alias:"pathExtraLinks",slot:"extraLinksNode",items:H});}if(mstrmojo.resolveFeature("object-search")){L.push({scriptClass:"mstrmojo.mstr.search.SearchButton",slot:"searchNode",searchProps:mstrConfig.searchProps});}if(M&&M.items&&M.items.length>0){L.push({scriptClass:"mstrmojo.ui.pathbar.PathHamburger",slot:"toolbarNode",items:M.items});}if(this.showCreateButton){if(mstrmojo.resolveFeature("create-objects")||(mstrmojo.resolveFeature("dhtml")&&mstrmojo.resolveFeature("create-analysis"))){L.push({scriptClass:"mstrmojo.mstr.ui.CreateButton",slot:"createNode",useConfigClickHandler:false,alignMenuToRight:true});}}this.addChildren(L);}});}());(function(){mstrmojo.requiresCls("mstrmojo.expr","mstrmojo.hash","mstrmojo.fe.FilterEditor","mstrmojo.fe.AndOrNode","mstrmojo.fe.DynamicNode","mstrmojo.fe.ConditionNode","mstrmojo.ui._HasScroller","mstrmojo.vi.ui.editors.fe.RelationNode");var C=mstrmojo.hash,B=mstrmojo.expr,A=B.ET;mstrmojo.vi.ui.editors.fe.RWViewFilterExprTree=mstrmojo.declare(mstrmojo.fe.RWViewFilterExprTree,[mstrmojo.ui._HasScroller],{scriptClass:"mstrmojo.vi.ui.editors.fe.RWViewFilterExprTree",markupString:'<div id="{@id}"><div class="mstrmojo-ListBase2 {@cssClass}" style="position:relative;{@cssText}" mstrAttach:keyup,keypress,mousedown,mouseup,dblclick><div class="mstrmojo-ListBase2-itemsContainer" style="position:relative;{@itemsContainerCssText}">{@itemsHtml}</div><div class="mstrmojo-ListBase2-dropCue {@cssClass}"><div class="mstrmojo-ListBase2-dropCue-inner"></div></div></div></div>',markupSlots:{scrollboxNode:function(){return this.domNode.firstChild;},itemsContainerNode:function(){return this.domNode.firstChild.firstChild;},dropCueNode:function(){return this.domNode.firstChild.lastChild;}},nodeClassMap:{14:mstrmojo.fe.AndOrNode,15:mstrmojo.vi.ui.editors.fe.RelationNode,ph:mstrmojo.fe.DynamicNode,"*":mstrmojo.fe.ConditionNode},levelSwitchValidTypes:[A.MQ,A.MC],setupScrollNodes:function(){this.scrollNode=this.scrollboxNode;},getItemConfig:function(F,D,G){var E=this._super(F,D,G);return C.copy({getConditionTextPostfix:function(){return"";}},E);}});}());(function(){mstrmojo.requiresCls("mstrmojo.expr","mstrmojo.hash","mstrmojo.fe.FilterEditor","mstrmojo.ui._HasScroller");var C=mstrmojo.hash,B=mstrmojo.expr,A=B.ET;mstrmojo.vi.ui.editors.fe.RWViewLimitExprTree=mstrmojo.declare(mstrmojo.fe.RWViewLimitExprTree,[mstrmojo.ui._HasScroller],{scriptClass:"mstrmojo.vi.ui.editors.fe.RWViewLimitExprTree",markupString:'<div id="{@id}"><div class="mstrmojo-ListBase2 {@cssClass}" style="position:relative;{@cssText}" mstrAttach:keyup,keypress,mousedown,mouseup,dblclick><div class="mstrmojo-ListBase2-itemsContainer" style="position:relative;{@itemsContainerCssText}">{@itemsHtml}</div><div class="mstrmojo-ListBase2-dropCue {@cssClass}"><div class="mstrmojo-ListBase2-dropCue-inner"></div></div></div></div>',markupSlots:{scrollboxNode:function(){return this.domNode.firstChild;},itemsContainerNode:function(){return this.domNode.firstChild.firstChild;},dropCueNode:function(){return this.domNode.firstChild.lastChild;}},levelSwitchValidTypes:[A.MQ,A.MC],getItemConfig:function(F,D,G){var E=this._super(F,D,G);return C.copy({getConditionTextPostfix:function(){return"";}},E);},setupScrollNodes:function(){this.scrollNode=this.scrollboxNode;}});}());(function(){mstrmojo.requiresCls("mstrmojo.array","mstrmojo.hash","mstrmojo.expr","mstrmojo.Editor","mstrmojo.registry","mstrmojo.fe.FilterUtils","mstrmojo.fe.FilterEditor","mstrmojo.func");mstrmojo.requiresDescs(15544);var G=mstrmojo.array,F=mstrmojo.hash,D=mstrmojo.fe.FilterUtils.getExprXml,E=mstrmojo.expr,A=E.TP,C=E.STP;mstrmojo.fe._HasFilterEditor=mstrmojo.provide("mstrmojo.fe._HasFilterEditor",{filterEditorScriptClass:"mstrmojo.fe.FilterEditor",limitMdxUnitIdsHashTable:{},getLimitMdxUnitIdsHashTable:function B(I){var H=I&&I.limitExpr,K=H&&H.nds||[],L={};var J=function(M){G.forEach(M,function(N){if(N.mdxUnitId){L[N.mdxUnitId]=true;}else{if(N.m&&N.m.did){L[N.m.did]=true;}else{if(N.nds){J(N.nds);}}}});};J(K);return L;},onShowFilterEditor:function(Q){var O=this,V=this.model,L=this.getDataService?this.getDataService():V.getDataService(),H=this._getXtabCallback?this:V.controller,I="mfe",P={},N=Q.getNodeKeys?Q.getNodeKeys():[Q.k],M=function M(Y,a){var X,Z=Y.nds;if(Y.ph){a[Y.ph.idx]=true;}else{if(Z){for(X=0;X<Z.length;X++){M(Z[X],a);}}}return a;},K=function K(Z){var Y=O.getLimitMdxUnitIdsHashTable(Z),X=[];F.forEach(O.limitMdxUnitIdsHashTable,function(b,a){if(!Y[a]){X=X.concat({did:a,t:4});}});L.saveViewFilter({filterModel:Z,limitExp:D(Z.limitExpr),nodeKeys:N,limitMdxToRemove:X},mstrmojo.func.wrapMethods(H._getXtabCallback(Q),{success:function(){var a=Q.boxContent;a&&a.raiseEvent&&a.raiseEvent({name:"regenerateToolbar"});}}));},W=function(X){var Y=I&&window.mstrmojo&&mstrmojo.all[I];if(!Y){Y=mstrmojo.insert({id:I,scriptClass:O.filterEditorScriptClass,onUpdateBrowseElementsParams:function(b,a){var Z=this.model;b.datasetID=Z.dsid;b.messageID=Z.messageID;b.templateNodeKey=Q.k;}});}Y.editorTitle=mstrmojo.desc(15544,"Advanced Filter Editor");Y.set("vizTitle",Q.title);X.targets=G.filter(X.targets,function(Z){switch(Z.t){case A.FILTER:return(Z.st!==C.CUSTOMGROUP);case A.CONS:return Z.st===C.NDE;}return !Z.olap;});O.limitMdxUnitIdsHashTable=O.getLimitMdxUnitIdsHashTable(X);Y.set("onSave",K);Y.set("model",X);if(O.filterEditorScriptClass==="mstrmojo.vi.ui.editors.FilterEditor"){Y.set("docModel",V);}if(Y.mainExpr.items.length>0){P=M(Y.mainExpr.items[0],P);}Y.open();},R={taskId:"getRWGridViewFilter",nodeKey:N[0],rwb:V.bs,msgID:V.mid},S=V.newCallback({success:function U(Y){var X=mstrmojo.insert(Y);W(X);},failure:function J(X){mstrmojo.alert(X.code+": "+X.message);}});L.getViewFilter(R,S);}});}());(function(){mstrmojo.requiresCls("mstrmojo.Container","mstrmojo._HasLayout","mstrmojo.mapbox.ui.selectors.OveralZoomSlider","mstrmojo.mapbox.ui.selectors.LayerZoomSlider","mstrmojo.mapbox.ui.selectors._SliderCommon","mstrmojo.gmaps.MapUtils","mstrmojo.gmaps.MapEnums","mstrmojo.tooltip");var F=mstrmojo.gmaps,E=F.MapUtils,C=F.EnumPropertyType,D=3,B=mstrmojo.mapbox.ui.selectors._SliderCommon.getIndexByValue;mstrmojo.mapbox.ui.selectors.ZoomThroughLayersControl=mstrmojo.declare(mstrmojo.Container,[mstrmojo._HasLayout,mstrmojo.mapbox.ui.selectors._SliderCommon],{scriptClass:"mstrmojo.mapbox.ui.selectors.ZoomThroughLayersControl",cssClass:"mapbox-control-container mapbox-zoom-through-layers-container",layoutConfig:{w:{containerNode:"100%",leftPadding:"7px",rightPadding:"7px"},xt:true},markupString:'<div class="{@cssClass}" style="{@cssText}" ></div>',markupSlots:{containerNode:function(){return this.domNode;},tooltipNode:function(){return[];}},markupMethods:{onvisibleChange:mstrmojo.Widget.visibleMarkupMethod,onenabledChange:mstrmojo.mapbox.ui.selectors._SliderCommon.enabledMarkupMethod},init:function G(N){if(!N.host){throw new Error(this.scriptClass+"must be initialized with a host which is a mapbox");}var M=this,L=N.host,K=L.mapViewer,I=K&&K.baseLayer,J,O=I.minZoom,H=I.maxZoom;J=[{scriptClass:"mstrmojo.mapbox.ui.selectors.OveralZoomSlider",alias:"overalSlider",baseLayer:I,items:M.generateItems(O,H),getIndexByValue:B,verticalLineHeight:(8+K.getGraphicLayerCount()*22)+"px",onselectionChange:function(){var P=this.cs2Vl;I.setZoom(P);}}];K.forEachGraphicLayer(function(P){J.push({scriptClass:"mstrmojo.mapbox.ui.selectors.LayerZoomSlider",host:L,layer:P,items:M.generateItems(O,H),getIndexByValue:B,minZoom:O,maxZoom:H});},true,true);this.children=J;this._super(N);},onLayerSelectionChange:function A(J){if(!J){return null;}var X=this.host,Q=J.items,I=J.layer.key,K,P,R,M=this.children,H,S,O,N,L={},V=J.typeHelper,U=V&&V.getUnit(),W=U>0?D/U:D,Y;K=J.minLayerZoomLvl;P=K!==Q[J.min].v;R=P?J.min:J.max;for(N=1;N<M.length;N++){H=M[N];O=H.layer;S=O&&O.key;if(S!==I){if(Math.abs(R-H.min)<=W){Y=H.min;W=Math.abs(R-H.min);}if(Math.abs(R-H.max)<=W){Y=H.max;W=Math.abs(R-H.max);}}}if(E.checkDefined(Y)){R=Y;}if(R>=0&&R<Q.length){L[I]={};L[I][P?C.minLayerZoomLvl:C.maxLayerZoomLvl]=Q[R].v;X.writeMultipleProperties(L,true);}}});}());(function(){mstrmojo.requiresCls("mstrmojo.Container","mstrmojo._Formattable","mstrmojo.MetricSlider","mstrmojo.MetricQualification","mstrmojo.SearchBoxSelector","mstrmojo.TextBoxSelector","mstrmojo.css","mstrmojo.dom","mstrmojo.expr","mstrmojo.array","mstrmojo.hash","mstrmojo.func","mstrmojo.string","mstrmojo._IsSelectorTarget","mstrmojo.elementHelper","mstrmojo.MetricSelectorUtility","mstrmojo.vi.ui.DatasetUnitMenuUtils","mstrmojo.vi._MonitorsAppState","mstrmojo.mstr.EnumDSSXMLBaseFormType","mstrmojo.mstr.EnumDSSXMLObjectTypes","mstrmojo.mstr.EnumDSSConsolidationType");mstrmojo.requiresDescs(4729,4730,4732,4733,4734,4735,5225,5443,6738,8967,12297);var V=mstrmojo.array,a=mstrmojo.hash,AK=mstrmojo.dom,Ar=mstrmojo.expr,AW=Ar.BFTP,Ao=Ar.TP,j=Ar.STP,A7=mstrmojo.css,AX=mstrmojo.MetricSelectorUtility,Ae=mstrmojo.vi.ui.DatasetUnitMenuUtils,As=0,Am=1,Aw=2,Ad=3,AG=4,AM=5,Ag=6,AA=7,Ab=8,Ai=9,h=10,B=11,k=12,A8=mstrmojo.elementHelper,x=A8.ELEM_ALL_ID,BA=mstrmojo.func.wrapMethods,Q=mstrmojo.string.escapeIllegalXML,AH=mstrmojo.mstr,H=AH.EnumDSSXMLBaseFormType.DssXmlBaseFormHTMLTag,J=AH.EnumDSSConsolidationType,c=AH.EnumDSSXMLObjectTypes,AT=Ao.FILTER,Y=Ao.METRIC,Ac=Ao.ATTR,A5=Ao.CONS,Au=0,Ay=j.NDE,Aj=3076,z=3077,G=j.CUSTOMGROUP,AB=A8.ELEM_ALL,AO=338;mstrmojo.DocSelectorEvtType=null;var m={};m[AA]="MetricSlider";m[Ab]="MetricQualification";m[Ai]="SearchBoxSelector";m[h]="TextBoxSelector";var BE=2;var AR=function AR(){var BF={type:parseInt(this.type,10),src:this.k,ck:this.ck,ctlKey:this.ckey,tks:this.tks,include:this.include,isUConDS:!!this.defn.dsTks};if(this.style===Ab||this.style===AA){mstrmojo.hash.copy(BF,{srcid:this.srcid,srct:this.type,f:this.f,ft:this.ft,qt:this.qt,unset:!!this.unset,cs:this.cs});}return BF;},Ak=function Ak(){var BG=this.node,BI=BG&&BG.data,BF=BG&&BG.defn,BH=BF&&BF.srct;return((mstrApp.isAppStatePause&&mstrApp.isAppStatePause())||mstrConfig.resolveOnly)&&this.style!==Ai&&BH&&this.hasAttrData()&&!BI[C.ELMSREADY]&&!BI[C.ELMSREQUEST]&&parseInt(BF.ds,10)===Au&&!BI[C.DISABLED];},Ah=function Ah(BF){var BI=this.node.defn,BL=this.node.data,BH=mstrApp.isAppStatePause&&mstrApp.isAppStatePause()||mstrConfig.resolveOnly,BM={taskId:"browseElements",styleName:"MojoAttributeStyle",attributeID:BI.srcid||"",dataSourcesXML:BI.dsrc||"",browseFlags:1};if(!BI.srcid){return ;}var BG=function(BQ){var BN=this.model,BP=BN.datasets,BO=Object.keys(BP),BS=[],BR;V.forEach(BO,function(BT){BS=BP[BT].att;V.forEach(BS,function(BU){if(BU&&BU.did===BQ){BR=BT;return false;}});if(!!BR){return false;}});return BR;};if(!BF){BM.datasetID=BI.dsid||BG.call(this,BI.srcid);BM.messageID=this.model.mid;if(!BM.datasetID){return ;}}var BK=this,BJ={success:function(BN){BK.bGetElems=true;BK.set("wait",false);if(BN&&BN.es){BL.elms=(BI.srcid)?A8.buildElemsTerseID(BN.es,BI.srcid,true):BN.es;if(BH){BK.toggleDisplayAll(BI.showall);}var BO=BK.parent,BP=BO&&BO.parent;if(BI.sec&&BL.ces&&BL.elms&&BL.elms.length>0&&BO){BO.set("count",A8.buildElemsCountStr(BL.ces,BL.elms,BK.isSelectionExcluded()));}if(BK.isInvalid){BK.isInvalid=false;}if(BK.hasRendered){BK.refresh();if(BH&&BO){A7.toggleClass(BO&&BO.domNode,"invalid",false);if(BP){BP.rebuildChild(BO);}}if(BK.isInFilterPanel()){if(BO&&BO.defn&&BO.defn.ttl){BO.updateContentHeight();}if(BP&&BP.refreshFP){BP.refreshFP();}}}}},failure:function(BN){if(BH){BK.model.setDataReady(BK.k,BK.id,C.DISABLED,true);var BO=BK.parent;BK.isInvalid=true;A7.toggleClass(BO&&BO.domNode,"invalid",true);if(BK.isInFilterPanel()){if(BO){BO.canCollapse=false;if(BO.titleBar){BO.titleBar.canCollapse=false;}BO.generateToolbar();}}else{if(BO.hasRendered&&BO.showInvalidMessage){BO.showInvalidMessage();}}return ;}mstrmojo.alert(BN.getResponseHeader("X-MSTR-TaskFailureMsg"));},complete:function(){if(BH){BK.node.data[C.ELMSREQUEST]=false;BK.model.setDataReady(BK.k,BK.id,C.ELMSREQUEST,false);if(!mstrApp.isSingleTier){mstrApp.hideWait();}}}};this.set("wait",true);if(BH){BL[C.ELMSREQUEST]=true;this.model.setDataReady(this.k,this.id,C.ELMSREQUEST,true);}if(mstrApp.isSingleTier&&BH){mstrApp.serverRequest(BM,BJ,{hideFailureErr:true});}else{if(BH){mstrApp.showWait();}mstrmojo.xhr.request("POST",mstrConfig.taskURL,BJ,BM,false,null,true);}},n={getWidgetClass:function D(BI,BH,BG){var BF=m[BH];if(BF&&BF.constructor===Array){BF=BF[BG?0:1];}return BF;},getWidgetConfig:function U(BL,BH,BJ,BF){var BM=BH===2?false:BJ.horiz,BK=BL.getFormats(),BN=BK&&BK.height,BI={scriptClass:this.getWidgetClass(BL,BH,BM),docSelector:BL,enabled:this.enabled,multiSelect:BJ.multi,isHoriz:BM,include:BJ.include,itemWidthMode:BJ.iwm,allIdx:V.find(BF,"v",mstrmojo.elementHelper.ELEM_ALL_ID),noneIdx:BJ.include?-1:V.find(BF,"v",mstrmojo.elementHelper.ELEM_ALL_ID),renderAllItems:!BN,onchange:function BG(){if(!BL._inSyncPhase){BL.selectorControlChange(this);}}};if(BI.noneIdx!==-1){BI.allIdx=-1;}if(BK&&BH===mstrmojo.DocSelector.STYLES.PULLDOWN){if(BK.color){BI.itemCssText="color: "+BK.color+";";}if(BK.font){BI.itemCssText=(BI.itemCssText||" ")+"font:"+BK.font;}if(mstrApp.isExpress){BI.cssTextClass="express";}}return BI;},expandOrEditToFetchElements:function d(){var BF=this.node&&this.node.data;if(BF&&BF[C.DISABLED]){BF[C.DISABLED]=false;}this.model.setDataReady(this.k,this.id,C.disabled,false);this.checkAndFetchAllElemsForDelayed();},checkAndFetchAllElemsForDelayed:function L(BF){if(BF||Ak.call(this)){Ah.call(this);}},newSelectorWidget:function A1(BQ){var BM=BQ.style,BH=BQ.node,BP=BH.defn,BK=BH.data,BF=BK.elms||[],BL=BQ.isInFilterPanel(),BG,BO=this.getWidgetConfig(BQ,BM,BP,BF),BJ=BO.scriptClass,BN=function(BT){var BR=this.getPopupList(),BS=this.items;if(BR.items.length!==BS.length){this.selectedIndex=V.find(BS,"v",BT.v);}if(BT){this.set("text",BT.n||mstrmojo.desc(14561,"(null)"));}};if(!BJ){BG=new mstrmojo.Label({cssClass:"unsupported",text:"This selector is not supported."});}else{if(BM===As){if(mstrApp&&mstrApp.isVI){BO.useDarkTheme=!BL&&mstrApp.getRootController().isDarkThemeSelected();BO.scrollNodeMaxHeight=AO;BO.focusOnPopup=true;BO.allowEmptyText=true;BO.onitemSelected=BO.onitemSelected?mstrmojo.func.composite([BN,BO.onitemSelected]):BN;BO.customizeSearchResult=function(BT){var BW,BU=this.allIdx,BS=this.multiSelect,BR=BT.length,BV={v:"u;",n:mstrmojo.desc(13976,"(All search results)"),t:c.Dimension,_renderIdx:BU};if(BR!==this.items.length){if(BU>=0){BW=V.find(BT,"v","u;");if(BW>-1){if(BS&&BR>1){BT.splice(BW,1,BV);}else{BT.splice(BW,1);}}else{if(BS&&BR>0){BT.splice(BU,0,BV);}}}}};BO.setDefaultListAndIndex=function(BS){var BR=this.getPopupList();BR.set("items",BS);if(!this.multiSelect){BR.set("selectedIndex",this.selectedIndex);this.set("text",BS[this.selectedIndex].n||mstrmojo.desc(14561,"(null)"));}else{this.set("selectedIndices",this.selectedIndices);}};BO.onclearSelection=function(){var BS=this.getSelectedItem(),BR=this.getPopupList();if(BS){BR.set("selectedIndex",V.find(BR.items,"v",BS.v));}};}}delete BO.scriptClass;var BI=a.walk(BJ,mstrmojo);BG=new BI(BO);}return BG;},getCekEvtListener:function Ax(BG,BF){return function(BH){var BK=[],BI=this.node.data.elms,BJ={};V.forEach(BI,function(BM,BL){BJ[BM.v]=BL;});V.forEach(BH.value,function(BM){var BL=BJ[BM];if(BL>-1){BK.push(BL);}});this.handleActionInSyncPhase(function(){if(BF&&BF.select){BF.select(BK);}});};},newAndInitWidget:function AJ(BJ){var BL,BH=BJ._cekEvtListener,BG=BJ.node,BF=BG.defn,BI=BJ.id,BK;if(BH){BF.detachEventListener(BH);delete BJ._cekEvtListener;}BL=this.newSelectorWidget(BJ);if(BL){BK=this.getCekEvtListener(BJ,BL);}BI=BK.cekContextId||BI;BK=BK.cekEvtListener||BK;if(BK){BJ._cekEvtListener=BF.attachEventListener("cekChange",BI,BK);}BJ.addChildren(BL);return BL;},updateWidget:function At(BG){var BF=BG.children,BH=BF&&BF[0];if(!BH){BH=this.newAndInitWidget(BG);}else{BH.set("enabled",this.enabled);}return BH;}};function Ap(BF){return BF.some(function(BG){return this.style===BG;},this);}function g(){var BF=this;return BF.model.getDatasetUnits(["mx"],function(BG){return BG.did===BF.defn.srcid;})[0]||{};}function AI(BF,BJ,BK,BM,BP,BI,BG){if(!BF){return[];}var BO=0,BL,BN=BF.length-(BI?1:0)-(BJ?1:0),BH=[];if(BG){if(BK&&BJ){BO++;}else{if(BM){BO=(BF.length-1);if(BI){BO--;}}}for(BL=0;BL<BP;BL++){if(BK){if(BO<=BN&&BF[BO]){BH.push(BF[BO++]);}}else{if(BM){if(BO>=(BJ?1:0)){BH.push(BF[BO--]);}}}}}else{if(BK){BO=BP;if(BI){BO--;}}else{if(BM){BO=0;if(BJ){BO++;}}}for(BL=BP+1;BL<=BN;BL++){if(BO<=BN){BH.push(BF[BO++]);}}}return BH;}mstrmojo.DocSelector=mstrmojo.declare(mstrmojo.Container,[mstrmojo._Formattable,mstrmojo._IsSelectorTarget,n,mstrmojo.vi._MonitorsAppState],{scriptClass:"mstrmojo.DocSelector",markupString:'<div id="{@id}" k="{@k}" class="mstrmojo-DocSelector {@cssClass} {@extCls}" nm="{@en@n}" title="{@tooltip}" style="{@domNodeCssText}"><div class="filter" style="{@filterNodeCssText}"></div><div class="wait" style="display:none;z-index:100;position:absolute;top:0;left:0;width:100%;height:100%"></div><div class="content" style="{@contentNodeCssText}"></div></div>',markupSlots:{filterNode:function(){return this.domNode.firstChild;},contentNode:function(){return this.domNode.lastChild;},dimNode:function(){return this.domNode.lastChild;},containerNode:function(){return this.domNode.lastChild;},scrollboxNode:function(){return this.domNode.lastChild;},wIconNode:function(){return this.domNode.childNodes[1];}},markupMethods:{onvisibleChange:mstrmojo.Widget.visibleMarkupMethod,onheightChange:mstrmojo.Widget.heightMarkupMethod,onwidthChange:mstrmojo.Widget.widthMarkupMethod,onenableChange:mstrmojo.Widget.enabledMarkupMethod,onincludeChange:function(){A7.toggleClass(this.domNode,"strikeout",!this.include);},onwaitChange:function(){A7.toggleClass(this.domNode,"wait",!!this.wait);this.wIconNode.style.display=((this.wait)?"block":"none");}},_ieformatHandlers:{domNode:["F","text-align","vertical-align","line-height","z-index","top","left"],contentNode:["width","B","P"],filterNode:["height","width","B","P","fx","background-color"],item:["color","font","text-decoration","text-align","line-height"]},formatHandlers:{domNode:["F","text-align","vertical-align","line-height","z-index","top","left"],contentNode:["height","width","B","P","fx","background-color"],item:["color","font","text-decoration","text-align","line-height"]},ckey:null,ck:null,tks:null,style:0,selIdx:null,extCls:"",min:-1,max:-1,bGetElems:false,n:"",_inSyncPhase:false,toggleDisplayAll:function A6(BF){var BJ=this.node,BK=BJ.data,BI=BJ.defn,BH=V.filterOne(BK.elms,function(BL){return BL.t===14;});if(BF&&!BH){BH=AB;BK.elms=V.insert(BK.elms,0,[BH]);}if(!BF&&BH){BK.elms=V.filter(BK.elms,function(BL){return BL.t!==14;});}if(this.children&&this.children[0]){var BG=V.find(BK.elms,"v",mstrmojo.elementHelper.ELEM_ALL_ID);this.children[0].items=BK.elms;this.children[0].allIdx=BG;this.children[0].noneIdx=BI.include?-1:BG;}BK[C.ELMSREADY]=true;this.model.setDataReady(this.k,this.id,C.ELMSREADY,true,"elms",BK.elms);},init:function AS(BH){this._super(BH);if(mstrmojo.dom.isIE){this.formatHandlers=this._ieformatHandlers;}var BG=BH.node.defn,BF=BG.style;this.n=BG.n;if(mstrApp.showSelectAllMenuOptionForSelector===1&&BG.multi){switch(BF){case Aw:case AG:case AM:case Ag:this.spm=true;break;}}},_fetchOnInit4UCOnDS:function Af(BH){var BF=!this.bGetElems&&parseInt(this.node.defn.subTp,10)===BE,BG=this.node.data;if(BF||Ak.call(this)){Ah.call(this,BF);BH=BG.elms;}return BH;},initControlInfo:function K(){var BU=this.node,BZ=BU.data,BH=BU.defn,BS=BZ.elms,BY=BZ.ces;var BM=["include","ckey","ck","tks","style","multi","iase","showall"];BS=this._fetchOnInit4UCOnDS(BS,BZ);this.type=BH.ct;var BR=BH.fmts;if(BR){var BP=BR.width;if(!BP||parseInt(BP,10)<=0){BR.width="95px";}}a.copyProps(BM,BH,this);var BL=this.selIdx={},BJ=false,BT=BH.multi;if((BH.style===Am)||BT){if(!this.oces&&(BY!==undefined)){this.oces=a.cloneArray(BY);BJ=true;}var BG=BH.showall,BX=(V.find(BY,"v",mstrmojo.elementHelper.ELEM_ALL_ID)>-1),BW=(parseInt(BH.dfm,10)===1),BI=(BZ.unset===true),BV=(!BW&&BI&&(BY&&BY.length===0)),BF=(BG&&BX)||(BX&&!BW&&BI)||(BG&&BW&&BI);if(BF){BY=BS;}else{if(BV){if(!BJ&&(BH.sus!==1)){var BQ=BH.htot,BN=(BH.sus===2),BO=(BH.sus===4),Ba=BH.suc||1;BY=AI(BS,BG,BN,BO,Ba,BQ,this.include);}else{if(this.oces){BY=this.oces;}}}}}if(BY){var BK={};V.forEach(BY,function(Bb){BK[Q(Bb.v)]=true;});V.forEach(BS,function(Bc,Bb){if(BK[Q(Bc.v)]){BL[Bb]=true;}});}if(BH.min>=0){this.min=BH.min;}if(BH.max>=0){this.max=BH.max;}if(this.isRecursiveAttributeSelector()){this.levelForms=BZ.lvfs||[];}},resetFormatHandlers:function P(){this.formatHandlers={contentNode:["RW"]};},_getSelectionCount:function u(BF){return a.keyarray(BF.selectedIndices).length;},canApply:function M(BJ){var BI=this.defn,BK=BI.multi,BH=this.min,BF=BK?this.max:1,BG=this._getSelectionCount(BJ||this.content);return(BH>=0&&BF>=0&&BH>BF)||((BH<0||BH<=BG)&&(BF<0||BF>=BG));},_buildEvent:mstrmojo.emptyFn,selectorControlChange:function W(BH){var BG=AR.call(this),BN=this.isInFilterPanel()&&this.getFilterPanel(),BK=(BN&&BN.isAutoApply());this._buildEvent(BG,BH);if(!this.canApply(BH)){var BF=this.getPanelContainer();if(this.isInSearchBoxPanel(BF)){BF.set("canApplySbp",false);}if(BK){this.set("err",true);mstrmojo.alert(mstrmojo.desc(12297,"One or more selectors are incorrectly set. Please review the selector(s) and try again."));}if(BN){BN.set("applyEnabled",false);}return ;}if(BK){this.set("err",false);}if(mstrApp.isExpress&&this.node.defn.style===As){this.handleExpressPulldown();}if(BG.requireToggle){this.deferredEvt=BG;this.set("include",BG.include);this.deferredEvt=undefined;}else{this.slice(BG);}if(this.node.data.unset===true){this.node.data.unset=null;}var BI=this.model,BJ=BI&&BI.controller,BM=BJ&&BJ.view,BL=this.k,BO=this.defn&&this.defn._lkz;V.forEach(BM&&BM.children,function(BT){var BS=BT.defn,BQ=BS&&BS.loaded,BP=BS&&BS.units;if(BQ&&BT.k!==BO){for(var BR in BP){if(BR===BL){if(BP[BR].tsk!==""){BS.loaded=false;}break;}}}});},showInfoWin:function r(BK){var BN=this.node&&this.node.defn,BH=BN&&BN.ifw,BG=this.model,BI=[].concat(BG.getTargetInfoWin(BH)).concat(BG.getTargetInfoWin(this.tks));if(BI&&BI.length){var BP=this.defn.horiz,BF=BK||this.contentNode,BM=AK.position(BF),BO=AK.position(this.contentNode),BL=(BP||parseInt(this.defn.style,10)===Am)?null:{x:BO.x,y:BM.y,w:BO.w,h:BM.h},BJ;for(BJ=0;BJ<BI.length;BJ++){BG.showInfoWin(BI[BJ],BF,BP?"v":"h",false,a.copy(BL));}}},unrender:function AE(BF){delete this.formatHandlers;this._super(BF);},postBuildRendering:function BD(){var BH=this.node.defn.style,BJ=this.filterNode.style,BF=this.contentNode,BG=this.node.defn;if(this.isInFilterPanel()&&!this.isHorizFP()){this.domNode.style.width=this.contentNode.style.width="100%";if(this.formatHandlers.filterNode){this.filterNode.style.width=this.contentNode.style.width="100%";}this.set("visible",parseInt(BG.ds,10)===Au);}this.handleActionInSyncPhase(this._super,this);if(mstrApp.isExpress&&BH===As){this.handleExpressPulldown();}if(this.isInFilterPanel()&&this.parent.adjustFP){this.parent.adjustFP();}if(this.formatHandlers.filterNode){var BI=this.getFormats();if(!BI.width){BJ.width=BF.clientWidth+"px";}if(!BI.height){BJ.height=BF.clientHeight+"px";}}else{BJ.display="none";}this.model.attachEventListener("CGBMapChange",this.id,"onCGBMapChange");if(AK.isAndroid&&BH===Am){BF.style.overflow="visible";}A7.toggleClass(this.parent.domNode,"invalid",this.isInvalid);return true;},updateHeight:function A0(){this.contentNode.style.height=this.filterNode.style.height=this.content.getClientHeight()+"px";var BF=this.parent;if(BF&&(BF.defn.ttl!==undefined)&&BF.updateContentHeight){BF.updateContentHeight();}},handleExpressPulldown:function I(){var BH=this.model.getZoomFactor();if(BH!==1){var BI=this.contentNode.firstChild.firstChild,BJ=parseInt(window.getComputedStyle(BI).height),BF=BJ*BH+"px";BI.style.height=BF;BI.style.lineHeight=BF;}var BG=document.createElement("DIV");BG.setAttribute("class","mstrmojo-ui-Pulldown-arrow");BG.setAttribute("src","#");this.content.selectedNode.appendChild(BG);},handleActionInSyncPhase:function Av(BH,BG){var BF=this._inSyncPhase;this._inSyncPhase=true;try{if(BG){BH.call(BG);}else{BH();}}catch(BI){throw ("There was an error handling the selector action in sync phase.");}this._inSyncPhase=BF;},onCGBMapChange:function Az(BG){var BF=BG.cgbMap;if(!BF){return ;}var BH=this.tks;a.forEach(this.defn.cgb,function(BJ){var BI=BF[BJ];if(BI&&BH.indexOf(BI)<0){BH+="\u001E"+BI;}});this.tks=BH;},onAppStateChange:function AV(BO){var BM=mstrmojo.vi.VisualInsightApp.APP_STATES,BQ=BM.PAUSE,BN=mstrApp.isAppStatePause&&mstrApp.isAppStatePause(),BL=this.model,BH=this.node,BK=BH&&BH.data,BP=BL.updateCSKeysforPause,BJ=this.k,BF=this.id;var BG=BO.valueWas&BQ;if(BK){if(BN&&!BG){if(this.hasAttrData()){var BS=(V.indexOf(BP,this.ckey)===-1)&&BK.elms&&(BK.elms.length>0),BR=this.style===Ai,BI=BS&&!BR;BK[C.ELMSREADY]=BI;BK[C.CESREADY]=BS;BK[C.DISABLED]=!BS&&!BR;BL.setDataReady(BJ,BF,C.ELMSREADY,BI);BL.setDataReady(BJ,BF,C.CESREADY,BS);BL.setDataReady(BJ,BF,C.DISABLED,!BS&&!BR);if(!BI&&this.shouldDisableGdde()){this.isInvalid=true;}}else{if(this.hasQualData()){BK[C.METRICVALUES]=!mstrConfig.resolveOnly;BL.setDataReady(BJ,BF,C.METRICVALUES,!mstrConfig.resolveOnly);BK[C.CSREADY]=true;if(this.isAttrQualSelector()&&this.children&&this.children.length){BL.setDataReady(BJ,BF,C.CSREADY,true,"cs",this.children[0].cs);}else{BL.setDataReady(BJ,BF,C.CSREADY,true);}}}}if(!BN&&BG){if(this.hasAttrData()){BK[C.ELMSREADY]=BK[C.CESREADY]=BK[C.ELMSREQUEST]=BK[C.DISABLED]=false;BL.setDataReady(BJ,BF,C.DISABLED,false);BL.setDataReady(BJ,BF,C.ELMSREADY,false);BL.setDataReady(BJ,BF,C.CESREADY,false);BL.setDataReady(BJ,BF,C.ELMSREQUEST,false);}else{if(this.hasQualData()){BK[C.METRICVALUES]=BK[C.CSREADY]=false;BL.setDataReady(BJ,BF,C.METRICVALUES,false);BL.setDataReady(BJ,BF,C.CSREADY,false);}}}}},update:function p(BT){this._super(BT);var BN=mstrApp.isAppStatePause&&mstrApp.isAppStatePause()||mstrConfig.resolveOnly,BF=this.node&&this.node.data,BJ=this.model;if(BN&&BF){if(!BT.data){BT.data={};}var BU=BT.data;if(BF[C.CESREADY]){BU.ces=BF.ces;BU[C.CESREADY]=BF[C.CESREADY];}else{if(!this.hasQualData()){BU.ces=BT.defn&&BT.defn.ces;BU[C.CESREADY]=true;BJ.setDataReady(this.k,this.id,C.CESREADY,true,"ces",BU.ces);}}if(BF[C.ELMSREADY]){BU[C.ELMSREADY]=BF[C.ELMSREADY];BU.elms=BF.elms;}if(BF[C.DISABLED]){BU[C.DISABLED]=BF[C.DISABLED];}if(BF[C.METRICVALUES]){BU[C.METRICVALUES]=BF[C.METRICVALUES];AX.restoreMetricSelectorProps(BU,BF);}if(BF[C.CSREADY]){BU[C.CSREADY]=BF[C.CSREADY];AX.restoreMetricSelectorSelections(BU,BF);}}this.node=BT;var BI=this.node.defn,Ba=this.node.data,BW=BI.style,BQ=Ba.elms,BO=this.parent,BR=(BW===Am),BH=(BW===Ai),BS=this.isDynamicAttributeSelector(),BY,BX;if(BN){if(Ba&&BI){if(this.hasAttrData()){BJ.setDataReady(this.k,this.id,C.CESREADY,true);if(BH){Ba.elms=Ba.ces;Ba[C.ELMSREADY]=false;Ba[C.DISABLED]=false;BJ.setDataReady(this.k,this.id,C.ELMSREADY,false);BJ.setDataReady(this.k,this.id,C.DISABLED,false);}else{BJ.setDataReady(this.k,this.id,C.DISABLED,!BF[C.ELMSREADY]);}if(!Ba[C.ELMSREADY]&&this.shouldDisableGdde()){this.isInvalid=true;}}else{if(this.hasQualData()){BJ.setDataReady(this.k,this.id,C.CSREADY,true);}}}}if(BI.srct===Ac&&BI.srcid&&this.model.getBrowseFormTypes&&this.model.getBrowseFormTypes(BI.srcid).indexOf(H)>-1){BY=window.document.createElement("span");V.forEach(BQ,function(Bb){BY.innerHTML=Bb.n;BX=BY.firstChild;Bb.n=BX&&(BX.text||BX.alt)||Bb.n||"";});BX=null;BY=null;}if(BR&&BI.multi){var BP=V.find(BQ,"v",mstrmojo.elementHelper.ELEM_ALL_ID);if(BP>-1){Ba.del={idx:BP,elem:BQ[BP]};V.removeIndices(BQ,BP,1);}}if(BI.sec){var BV=[].concat(BT.data.ces||[]);if(BO&&(BO.count!==null&&BO.count!==undefined)){if(BR||BS){BO.set("count","");}else{if((BV&&BQ&&BQ.length)||BI.sos){if(!BI.include){var BZ=V.find(BV,"v",mstrmojo.elementHelper.ELEM_ALL_ID);if(BZ>=0){V.removeIndices(BV,BZ,1);}}var BL={};V.forEach(BQ,function(Bb){BL[Bb.v]=true;});BV=V.filter(BV,function(Bb){return BL[Bb.v];});var BG=BV,BM;if(!BH){if(!BI.multi){BG=BQ;}BM=BQ;}if(BT.data.unset){BO.set("count",A8.buildElemsCountStr(BM,BM));}else{BO.set("count",A8.buildElemsCountStr(BG,BM,this.isSelectionExcluded()));}}}}}if(this.content){this.content.allIdx=V.find(this.node.data.elms,"v",x);}this.initControlInfo();var BK=this.content=this.updateWidget(this);if(!BK){this.set("visible",false);}this.clearCache();},refresh:function Al(){var BG=this.parent,BF=this.node&&this.node.defn;if(BG&&BG.generateToolbar){BG.set((this.isInFilterPanel()?"baseTitle":"title"),BF.ttl);BG.generateToolbar();}this._super();if(BG.fc&&BG.updateContentHeight){BG.updateContentHeight();}},onselectAllChange:function Aa(BO){var BG=this.children&&this.children[0],BM=BG.items,BF=BG.allIdx,BI=BG.selectedIndices,BN,BL=[];if(BO.value){if(BI[BF]){BG.removeSelect(BF,true);var BK=BG.itemRenderer,BJ=BK&&BK.unselect;if(BJ){var BH=BG._getItemNode(BF);if(BH){BJ(BH,BM[BF],BF,BG);}}}for(BN=0;BN<BM.length;BN++){if(BN!==BF&&!BI[BN]){BL.push(BN);}}BG.addSelect(BL);}else{for(BN in BI){BL.push(parseInt(BN,10));}BG.removeSelect(BL);}},onincludeChange:function v(BT){var BR=this.node.defn,BH=BT.value,BQ=this.model,BL=this.isInFilterPanel()&&this.getFilterPanel(),BP=BQ.getDataService().newUpdate(BL);BR.include=this.include=BH;if(BL&&BL._bufferedSlices){BL.applyBufferedSlices(true,BP);}if(this.style!==AA&&this.style!==B){var BJ=AR.call(this);BJ.ckey=this.ckey;BJ.changeInclude=true;if(BR.srct===Ac||BR.srct===A5){var BS=this,BM=this.model,BN=this.node.k,BK=BM.getDataService(),BG=BM.getSliceCallback(BJ),BI=this.isDynamicAttributeSelector(),BO=[BK.getSelectorShowAllAction({ck:BR.ck,ckey:BR.ckey,type:BR.type,showAll:BH}),BK.getSelectorIncludeAction({ck:BR.ck,ckey:BR.ckey,type:BR.type,include:BH})],BU=BA(BG,{success:function(BV){BS.set("wait",false);if(mstrApp.isAppStatePause&&mstrApp.isAppStatePause()){BS.toggleDisplayAll(BH);}if(!BI){BM.partialUpdate(BV.data,BM.getTargetDefn(BN));}if(!BS.isInFilterPanel()&&BS.parent){BS.parent.selectVIUnit(BS,true);}}});this.showall=this.defn.showall=BT.value;var BF=this.deferredEvt;if(!!BF){BM.sliceDeferred(BP,BF);}BO=!!BF?BO.concat(BP.actions):(BP.actions||[]).concat(BO);this.set("wait",true);BM.controller.cmdMgr.execute({execute:function(){this.submit(BO,BU);},urInfo:{extraPuKeys:BR.ck.split("\u001E").slice(1),treesToRender:3}});}else{this.slice(BJ);}}},getSelectorStyleList:function AL(){var BI=[],BL=this.defn.srct;if(this.useAttrStyle()){var BM=!this.isInFilterPanel();if(this.isRecursiveAttributeSelector()){return[{n:mstrmojo.desc(4733,"Check Boxes"),v:AG},{n:mstrmojo.desc(8967,"Search Box"),v:Ai},{n:mstrmojo.desc(4729,"Drop-down"),v:As}];}BI=[{n:mstrmojo.desc(4733,"Check Boxes"),v:AG},{n:mstrmojo.desc(4730,"Slider"),v:Am}];if(BL===Ac){BI.push({n:mstrmojo.desc(8967,"Search Box"),v:Ai});}if(BM){BI=BI.concat([{n:mstrmojo.desc(4735,"Link Bar"),v:Ag},{n:mstrmojo.desc(4734,"Button Bar"),v:AM}]);}BI=BI.concat([{n:mstrmojo.desc(4732,"Radio Buttons"),v:Ad},{n:mstrmojo.desc(4729,"Drop-down"),v:As}]);if(BM){BI=BI.concat([{n:mstrmojo.desc(6738,"List Box"),v:Aw}]);}var BK=Ae.getUnitFromDataset(this.model.datasets,this.defn.srcid,12),BF=BK&&V.some(BK.fs,function(BN){return(BN.bftp===AW.DATE||BN.bftp===AW.DATETIME)&&(BN.istf||BN.idf);});if(BF&&(BK&&!BK.de)){BI.push({n:mstrmojo.desc(5443,"Calendar"),v:B});}}else{if(BL===Y){var BH=this.node,BG=BH&&BH.defn,BJ=BH&&BH.data;if((mstrApp.isAppStatePause&&mstrApp.isAppStatePause()||mstrConfig.resolveOnly)&&BG&&BG.style!==AA&&!(BJ&&BJ.max&&BJ.min)){BI=[{n:mstrmojo.desc(5225,"Qualification"),v:Ab}];}else{BI=[{n:mstrmojo.desc(4730,"Slider"),v:AA},{n:mstrmojo.desc(5225,"Qualification"),v:Ab}];}}}return BI;},supportsInclude:function AQ(){var BF=this.defn;if(this.isRecursiveAttributeSelector()){return !this.isDynamicAttributeSelector();}return((BF.srct===Ac&&!this.hasDE)||(BF.srct===Y&&BF.style===AA))&&!this.isSolrSelector()&&!mstrApp.isInVFConfigMode;},isSelectionExcluded:function e(){return this.isDynamicAttributeSelector()&&!this.defn.include;},isSolrSelector:function F(){return this.model.isFromSolrCube(this.defn.srcid);},isMetricSelector:function A3(){return this.defn.srct===Y;},isRankMetricSelector:function AU(){var BF=g.call(this).f;return BF&&typeof BF==="string"&&BF.search(/rank/i)===0;},isNumericMetricSelector:function Aq(){var BF=g.call(this).dt;return this.model.isNumericDataType(BF);},isAttributeSelector:function AY(){return this.defn.srct===Ac;},supportsShowAllToggle:function A9(){return this.defn.srct===Ac||this.defn.srct===A5||(this.defn.srct===AT&&this.defn.srcst===G);},useAttrStyle:function A(){var BF=this.defn.srct;return BF===AT||BF===Ac||BF===A5;},hasAttrData:function A2(){return this.useAttrStyle()&&!this.isAttrQualSelector();},hasQualData:function t(){return this.isAttrQualSelector()||this.isMetricSelector();},isDerivedAttributeSelector:function An(){return this.defn.srct===Ac&&this.defn.srcst===z;},isNewDerivedElementSelector:function l(){return this.defn.srct===A5&&this.defn.srcst===Ay;},isNewDerivedRecursiveElementSelector:function E(){return this.isNewDerivedElementSelector()&&this.defn.ndetype===J.DssRecursiveDerivedElement;},isAttrQualSelector:function AC(){return this.defn.srct===Ac&&this.defn.style===B;},isRecursiveAttributeSelector:function w(){var BF=this.defn;return BF.srct===Ac&&BF.srcst===Aj||this.isNewDerivedRecursiveElementSelector();},isDynamicAttributeSelector:function AP(){return this.isRecursiveAttributeSelector()&&this.isInFilterPanel()&&this.defn.style===AG;},allowsOrientationChange:function AZ(){return !this.isAttrQualSelector()&&!Ap.call(this,[Ai,Aw,As,Am,AA,Ab]);},isSearchBox:function O(){return Ap.call(this,[Ai]);},isAttrElemListSelector:function A4(){return this.defn.srct===Ac&&this.defn.style!==B;},isCGSelector:function N(){return this.defn.srcst===G;},isGeoSelector:function b(){var BF=Ae.getUnitFromDataset(this.model.datasets,this.defn.srcid,12);return !!BF&&Ae.isGeoAttr(BF);},shouldDisableGdde:function R(){return this.isCGSelector()||this.isGeoSelector();},getInvalidTooltip:function o(){var BG=mstrmojo.desc(15787,"Unable to retrieve the list of elements for this filter")+mstrmojo.desc(1006,"."),BF=" "+mstrmojo.desc(15931,"Please resume data retrieval to use this filter.");if(this.isCGSelector()){BG=mstrmojo.desc(15924,"This Filter is based on a Custom Group, which is not supported when data retrieval is paused.")+BF;}else{if(this.isGeoSelector()){BG=mstrmojo.desc(15932,"This filter is based on a Geo Attribute, which is not supported when data retrieval is paused.")+BF;}}return BG;},slice:function f(BI){var BF=this.model;if(BI&&BI.eid){BI.eid=Q(BI.eid);}if(BF.closeSelWarnFlag){BF.closeSelWarnFlag(this.k);}if(this.isInFilterPanel()){var BG=this.getFilterPanel();if(BG&&!BG.isAutoApply()){BG.bufferSlice(BI);return ;}}var BJ=this.getPanelContainer();if(this.isInSearchBoxPanel(BJ)){BJ.parent.bufferSlice(BI);BJ.set("canApplySbp",BJ.canApplySearchBoxPanel());return ;}var BH=BJ&&BJ.parent;if(BH&&BH.bufferSlice&&BH.hasDisabledSelectionApply&&BH.hasDisabledSelectionApply()&&BI&&!BI.forceApply){BH.bufferSlice(BI);return ;}BF.slice(BI);},isInFilterPanel:function AD(){var BF=this.parent;return(BF&&BF.isInFilterPanel&&BF.isInFilterPanel())||false;},isHorizFP:function BB(){var BF=this.parent;return(BF&&BF.isHorizFP&&BF.isHorizFP())||false;},getFilterPanel:function BC(){var BF=this.parent;return(BF&&BF.getFilterPanel&&BF.getFilterPanel())||null;},isInSearchBoxPanel:function(BF){var BG=BF||this.getPanelContainer();return BG&&(BG.isSbp||(BG._isSearchBoxPanel&&BG._isSearchBoxPanel()));},getPanelContainer:function(){var BF=mstrmojo.EnumRWUnitType,BG;for(BG=this.parent;BG&&BG.defn;BG=BG.parent){if(parseInt(BG.defn.t,10)===BF.PANEL){return BG;}}return null;},clearSelector:function Z(BF){var BR=AR.call(this),BN=[x],BQ=this.node.data.elms||[],Ba="\u001E",BV=this.style,BG=this.defn.include,BI=this.isFilterNothing&&this.isFilterNothing(),BK=this.node.defn,BX=BK.srcst===257||(BK.srct===47&&BK.srcst!==12033),Bb=mstrApp&&mstrApp.getSelectAllForUnsetForVI&&mstrApp.getSelectAllForUnsetForVI(),BU=[AB],BJ=C.CESREADY,BL="ces",BS=[],BP=mstrApp.isAppStatePause&&mstrApp.isAppStatePause();if(BV===Ai){if(Bb){BR.eid=BN.join(Ba);BS=BU;}else{BR.ckey=this.ckey;BR.unset=true;}this.defn.set("cek",[]);}else{if(BV===AA||BV===Ab){BR.cs="";BR.ckey=this.ckey;BR.unset=true;BK.set("cek",{cs:null,qua:this.qua,include:BG,f:null,ft:null});BJ=C.CSREADY;BL=["f","ft","cs"];BS=[null,null,""];}else{if(BV===B){BR.unset=true;BR.ckey=this.ckey;var BO=[{v:""},{v:""}];BK.set("cek",{cs:BO});BJ=C.CSREADY;BL="cs";BS=BO;}else{if(Bb){BR.eid=BN.join(Ba);BS=BU;}else{BR.ckey=this.ckey;BR.unset=true;}var BZ;if((BG||BV===Am)&&this.multi){V.forEach(BQ,function(Bd){var Bc=Bd.v;if(BN[0]!==Bc){BN.push(Bc);if(!BZ){BZ=[Bd];}}});}var BM=BG||BV===Am;if(!BX){BK.set("cek",BM?BN:[]);BS=BM?BU:[];}else{if(BP){BK.set("cek",(BM&&BN.length>1)?[BN[1]]:[]);}BS=BZ||[];}BL="ces";}}}if(this.defn.sec&&BV!==Am){this.parent.set("count",BV===Ai?"":A8.buildElemsCountStr(BN,BQ,this.isSelectionExcluded()));}BR[BF?"forceApply":"forceBuffer"]=true;if(BI&&!BX){BR.ignoreTargetData=true;}BR.retrieveCtrlKey=BX;if(BP){var BW=this.model,BY=BW.getCurrentLayoutDef(),BT=BY&&BY.units,BH=this.k;if(BT&&BT[BH]){BT[BH].cesChange=false;}BW.setDataReady(BH,this.id,BJ,true,BL,BS);}this.slice(BR);},allowsTogglingMultiSelect:function AF(){return Ap.call(this,[As,AM,Ag,Ai,Am,Aw]);},allowsTogglingAutoSearch:function X(){return !this.isRecursiveAttributeSelector()&&Ap.call(this,[Ai]);},allowsSameSizeItems:function S(){return Ap.call(this,[AG,Ad,AM,Ag])&&!this.isRecursiveAttributeSelector();},supportsSetTarget:function AN(){var BF=this.defn;return this.isAttrElemListSelector()||(BF.srct===A5||BF.srcst===G);},supportSelectionColor:function q(){return Ap.call(this,[Aw,Ag]);}});mstrmojo.DocSelector.UC_ON_DS=BE;mstrmojo.DocSelector.STYLES={PULLDOWN:As,SCROLLER:Am,LIST:Aw,RADIO:Ad,CHECKBOX:AG,BUTTON:AM,LINK:Ag,METRIC_SLIDER:AA,METRIC_QUAL:Ab,SEARCH_BOX:Ai,TEXT_BOX:h,ATTR_QUAL:B,VISUALIZATION:k};mstrmojo.DocSelector.DATAPARAMS={CESREADY:"cesReady",ELMSREADY:"elmsReady",ELMSREQUEST:"elemsRequest",METRICVALUES:"metricValues",CSREADY:"csReady",DISABLED:"disabled"};var C=mstrmojo.DocSelector.DATAPARAMS;}());(function(){mstrmojo.requiresCls("mstrmojo._IsWebApp","mstrmojo.vi.factories.ModelFactory","mstrmojo.hash","mstrmojo.css","mstrmojo.array","mstrmojo.color","mstrmojo.dom","mstrmojo.func","mstrmojo.form","mstrmojo.vi.enums.EnumFeatures","mstrmojo.VisUtility","mstrmojo.gm.GMUtility");mstrmojo.requiresDescs(6828,13159,13160,13162,13163,13353,15490,13376,13407,13345,13346,13347,13348,15486,15487,13351,15488,13472,13473,13339,13340,13341,13342,13343,13344,13538,13539,13988);var k=1,W=2,f=4,d=8,K=16,L=mstrmojo.dom,l=mstrmojo.func,F=mstrmojo.vi.enums.EnumFeatures,Y=mstrmojo.gm.GMUtility;var D=0,n=1,X=2;window.mstrConfig=mstrConfig;var j=[];function e(){if(j.length===0){return ;}var p=j.shift(),q=this;this._super.call(this,p.params,l.wrapMethods(p.callback,{success:function r(){e.call(q);}}),p.config);}mstrmojo.vi.VisualInsightAppBase=mstrmojo.declare(mstrmojo.Obj,[mstrmojo._IsWebApp],{scriptClass:"mstrmojo.vi.VisualInsightApp",isVI:true,isSingleTier:false,appState:k,layoutMode:D,pageName:"",styleName:"RWIVEMojoStyle",rootCtrl:null,menubarModelData:null,tbModelData:null,enableWaitBox:true,customization:{},hiddenSecState:null,hiddenSec:null,start:function S(p){},getRootController:function U(){},getPreferredColors:function(){return mstrmojo.array.map(this.rootCtrl.docCtrl.model.getCurrentPaletteColors(),function(p){return mstrmojo.color.decodeColor(p);});},serverRequest:function H(t,z,r){try{var AA=this.docModelData.bs,p=mstrApp.enableLoggingRequest,v=p?Y.startTimer({functionName:t.taskId}):undefined,x=!!(mstrConfig&&mstrConfig.resolveOnly||this.isAppStatePause&&this.isAppStatePause());if(t.rapidExec&&!mstrApp.isDossier){r.silent=true;t.resolveOnly=true;t.excludeData=true;if(z){if(z.submission){z.submission();}var u=this.getRootController().docCtrl.model.getDataService().stid+1;if(z.success){z.success({stid:u});}if(p){mstrmojo.VisUtility.visPrint("%c[Response received at: "+new Date().toLocaleString()+"] on taskId: "+t.taskId+", time consumed: "+Y.endTimer(v)+" ms","color: green");}if(z.complete){z.complete({stid:u});}}z=undefined;}else{z=l.override({success:function(AC,AD){if(AC.isPrompted){mstrmojo.form.send({evt:5005,src:mstrApp.name+"."+mstrApp.pageName+".5005",resolveOnly:x,preventCancelPrompt:!(r&&r.canCancelPrompt),rwb:AA});}else{if(AC.prompted&&AC.promptState===2){var AB=this._super,AE=function AE(AF){var AG={success:function AI(AJ){if(AJ.PromptEditor){AE(AJ);}else{mstrApp.getRootController().updatePromptStatus(AJ.prompted||AJ.hasPrompted==="1");AB(AJ,AD);}}},AH=mstrmojo.emptyFn;mstrApp.getRootController().openPrompt({required:false,mid:AF.mid,noCancel:true,editor:AF.PromptEditor,model:AF.ReportInstanceModel,settings:AF.Settings,onApply:AG,onCancel:AH});};AE(AC);}else{return this._super(AC,AD);}}},complete:function q(AB){if(p){mstrmojo.VisUtility.visPrint("%c[Response received at: "+new Date().toLocaleString()+"] on taskId: "+t.taskId+", time consumed: "+Y.endTimer(v)+" ms","color: green");}if(this._super){this._super(AB);}}},z);}j.push({params:t,callback:z,config:r});e.call(this);}catch(w){mstrmojo.err(w);}},serverResponse:function g(v,q,r,p,u){var t=mstrmojo.all[v];if(t){t[q](r,!!p,u);}},onerror:function Z(p,u){if(!p||p.handledError){return ;}var t=[],r={title:"",message:mstrmojo.desc(6828,"Error:")+" ",sourceURL:"Source URL: ",fileName:"File: ",lineNumber:"Line: ",line:"Line: "};mstrmojo.hash.forEach(r,function(w,x){if(p[x]!==undefined){t.push(w+p[x]);if(x==="title"){t.push("");}}});if(p.getResponseHeader){t.push("XHR: "+p.getResponseHeader("X-MSTR-TaskFailureMsg"));}var q=t.join("\n");if(q.length){mstrmojo.error({longDesc:q},u);p.handledError=true;mstrmojo.dbg(p.stack||q);}},showWait:function o(p){var r=this._super(p),q=this.rootCtrl.view.themeClassName;if(q){r.set("themeClassName",q);}},getWaitBoxPosition:function V(){var p=this.rootCtrl.view;return{top:L.position(p.pathbarNode).h+L.position(p.menuToolbarNode).h+2};},getShowVIWelcome:function B(){return false;},executeCommand:function G(p,q){if(typeof this[p]==="function"){this[p](q);}else{this.rootCtrl.executeCommand(p,q);}},setDefaultAppState:function M(){this.set("appState",k);},isAppStateDefault:function I(){return !!(this.appState&k);},isAppStateDefault:function I(){return this.appState===k;},isAppStatePresentation:function b(){return !!(this.appState&W);},isAppStatePrintPreview:function J(){return !!(this.appState&d);},isAppStateSelection:function c(){return !!(this.appState&f);},isAppStatePause:function N(){return !!(this.appState&K);},isLayoutModePreview:function E(){return this.isLayoutPreview(this.layoutMode);},isLayoutPreview:function m(p){return p===n||(this.supportFeature(F.SUPPORT_RESPONSIVE_RESIZING)&&p===X);},allowWebDashboardDesign:function Q(){var p=this.features;return !(p&&p["disable-dashboard-design"]);},setTheme:function R(p){this.rootCtrl.setTheme(p);},getThemeClassName:function a(){return this.rootCtrl.view.themeClassName;},setPalette:function h(p){this.rootCtrl.setPalette(p);},resetCmdMgr:function A(){this.rootCtrl.resetCmdMgr();},supportFeature:function O(p){var q=mstrApp.features||{};switch(p){case F.SUPPORT_RESPONSIVE:return !this.isAppStatePresentation()||mstrApp.isDossier;case F.SUPPORT_RESPONSIVE_RESIZING:return mstrApp.isDossier;case F.SUPPORT_GHOST_IMG:return true;case F.SUPPORT_CONDITION_METRIC:return true;case F.USE_WORKSTATION_NAMING_STYLE:return true;case F.SUPPORT_TOC_UPDATEPOISITION:return !mstrApp.isDossier&&mstrApp.isWSStyling;case F.SUPPORT_LIVEMODE:return mstrApp.isWorkstation&&!mstrApp.isDossier;case F.DATA_ENGINE_VERSION:return mstrApp.isWorkstation&&!mstrApp.getWSLiveMode();}return !!q[p];},updateFeatureFlag:function P(p,q){mstrApp.features=mstrApp.features||{};if(p&&p.feature_flag){switch(p.feature_flag.NGMTypeFlag){case 1989:case 6574:mstrApp.features.ngm=true;mstrApp.features.ngmPartial=false;break;case 0:mstrApp.features.ngm=false;mstrApp.features.ngmPartial=false;break;case 1:default:mstrApp.features.ngm=true;mstrApp.features.ngmPartial=true;}}if(q){q();}},setPalette:function h(p){this.rootCtrl.setPalette(p);},setTheme:function R(p){this.rootCtrl.setTheme(p);},getThemeClassName:function a(){return this.rootCtrl.view.themeClassName;},resetCmdMgr:function A(){this.rootCtrl.resetCmdMgr();},getDefaultAppState:function C(){return k;}});mstrmojo.vi.VisualInsightAppBase.APP_STATES={DEFAULT:k,PRESENTATION:W,PRINT_PREVIEW:d,SELECTOR_TARGETING:f,PAUSE:K};mstrmojo.vi.VisualInsightAppBase.LAYOUT_MODES={DEFAULT:D,PREVIEW_TOGGLED:n,PREVIEW_RESIZE:X};}());(function(){mstrmojo.requiresCls("mstrmojo.hash","mstrmojo.expr","mstrmojo.vi.models.editors.BaseEditorModel","mstrmojo.ui.editors.controls.LineConfigGroup","mstrmojo.ui.editors.controls.FillConfigGroup","mstrmojo.models.FormatModel","mstrmojo.VisEnum","mstrmojo.chart.enums.EnumFontStyle","mstrmojo.gm.GMUtility","mstrmojo.VisUtility","mstrmojo.models.FormatModel","mstrmojo._CanValidate","mstrmojo.num");mstrmojo.requiresClsP("mstrmojo.ui.editors.controls","CharacterGroup","ContainerGroup","TwoColumnContainer","ColorPickerButton","LineStyleButton");var I=mstrmojo.hash,e=mstrmojo.array,k=mstrmojo.gm.GMUtility,x=mstrmojo.VisUtility,C=mstrmojo.num,V=mstrmojo.models.FormatModel.ENUM_PROPERTY_NAMES,X=mstrmojo.VisEnum.SERVER_JSON_ERROR_TYPE;var F=mstrmojo.VisEnum.GMLegendFormatingPropertyTag,S=mstrmojo.models.FormatModel,M=S.ENUM_PROPERTY_NAMES,B=mstrmojo.chart.enums.EnumFontStyle,O=F.LEGEND_BG_COLOR,l=F.LEGEND_BG_FILL_TRANSPARENCY,w=F.LEGEND_FONT_SIZE,c=F.LEGEND_FONT_FAMILY,AB=F.LEGEND_FONT_COLOR,E=F.LEGEND_FONT_STYLE,m=mstrmojo.VisEnum.NETWORK_MAX_NODE_SIZE_TYPE,d=mstrmojo.VisEnum.NETWORK_MIN_NODE_SIZE_TYPE,u=mstrmojo.expr.DTP;var AC={};AC[M.FONT_SIZE]=w;AC[M.FONT_FAMILY]=c;AC[M.COLOR]=AB;var N="de",o="lgd";var U="30%",Q="70%";function K(AE){var AD=AE,AF=this.getHost().defaultsLegendPop||{},AG=this.getPropertyValue(AD);return AG!==undefined?AG:AF[AE];}function AA(AD){this._doNotSave=true;AD.call(this);this._doNotSave=false;}function G(){function AI(AO,AV,AP,AL){var AT=this,AM="observableModel."+AO;function AK(Aa){var AZ=AT.getHost();var AY=x.getPropertyByPath(AZ,AM);if(AY){AY.setValue(Aa);}}function AW(){var Ab=AQ.getSelectedItem().v,Aa={type:Ab};var AZ=AT.getPropertyInfo();AZ.unmarshal(AO,Aa);Aa=AZ[AO];AU.set("enabled",AL.textboxEnabled(Ab));AU.updateText(C.toLocaleString(Aa.ratio));AK(Aa);var AY=AL.onSizeChanged;if(AY instanceof Function){AY(Aa);}}var AX=this.getHost();var AN=x.getPropertyByPath(AX,AM,{});var AS=AN.type.getValue();var AR=AN.ratio.getValue();var AQ=this.getPulldown(AP,AW,!isNaN(AS)?(AS-1):0);var AU=new mstrmojo.ui.editors.controls.ValidationTextBox({required:true,dtp:u.FLOAT,constraints:I.copy(AL.valueRange,{min:0.01,max:1,trigger:mstrmojo.validation.TRIGGER.ALL}),validationDelay:1500,value:C.toLocaleString(AR),enabled:AL.textboxEnabled(AS),onValid:function(){var AZ={type:AQ.getSelectedItem().v,ratio:C.parseNumeric(this.value)};AK(AZ);var AY=AL.onSizeChanged;if(AY instanceof Function){AY(AZ);}},updateText:function(AY){this.inputNode.value=AY;this.value=AY;}});return[new mstrmojo.Label({text:AV}),r([AQ,AU],{col1Width:"70%",col2Width:"30%"})];}var AJ=(function(){var AK=["not used",mstrmojo.desc(13743,"The smallest element's size is proportional to its data element"),mstrmojo.desc(13744,"The smallest element's size is fixed, independent of its data value"),mstrmojo.desc(13740,"The smallest element's size is ## of the largest element's size")];return function(){var AN=this.getHost();if(AN.hasSizeByMetric()){var AL=AN.propInfo;var AM=AL.minNodeSize;var AO=AK[AM.type];if(AM.type===d.ADJUSTED_RANGE){AO=AO.replace("##",(AM.ratio*100).toFixed(0)+"%");}return AO;}}.bind(this);}.call(this));var AH=AI.call(this,"maxNodeSize",mstrmojo.desc(14116,"Item Max Size (0.01 - 1)"),[{n:mstrmojo.desc(6019,"Automatic"),v:m.AUTOMATIC},{n:mstrmojo.desc(8262,"Manual"),v:m.MANUAL}],{textboxEnabled:function(AK){return AK===m.MANUAL;}});var AF=AI.call(this,"minNodeSize",mstrmojo.desc(14117,"Item Min Size (0.00 - 1)"),[{n:mstrmojo.desc(11990,"Proportional"),v:d.PROPORTIONAL},{n:mstrmojo.desc(13741,"Full Range"),v:d.FULL_RANGE},{n:mstrmojo.desc(14118,"Adjusted Range"),v:d.ADJUSTED_RANGE}],{valueRange:{min:0,max:1},textboxEnabled:function(AK){return AK===d.ADJUSTED_RANGE;},onSizeChanged:function(){AD.set("text",AJ());}});var AD;var AE=[].concat(AH,AF);var AG=this.getHost();if(!AG.hasSizeByMetric()){AF.forEach(function(AK){AK.set("enabled",false);});}else{AD=new mstrmojo.Label({text:AJ(),cssText:"line-height: 115%;"});AE.push(AD);}return this.getEditorGroup(AE);}function J(AE){var AD=function(AK,AJ,AI){return this.getCheckboxAndLabel(this.getPropertyValue(AI),AK,a.call(this,AJ));}.bind(this);var AG="nodeSizeAggregation",AF=this.getHost().model.data,AH=mstrmojo.VisEnum.NETWORK_AGGREGATION_METHOD[this.getPropertyValue("nodeSizeAggregation")];this.replaceChildControls(AE,[this.getEditorGroup([AD(mstrmojo.desc(12080,"Show Edge Direction"),"showEdgeDirection","showEdgeDirection"),AD(mstrmojo.desc(12081,"Animate Layout Transition"),"showTransition","showTransition"),new mstrmojo.Label({text:mstrmojo.desc(12082,"Item Size Aggregation:")}),this.getPulldown([{n:mstrmojo.desc(2123,"Count"),v:"Count of"},{n:mstrmojo.desc(2131,"Sum"),v:"Sum of"},{n:mstrmojo.desc(2122,"Average"),v:"Average of"},{n:mstrmojo.desc(2127,"Minimum"),v:"Min of"},{n:mstrmojo.desc(2125,"Maximum"),v:"Max of"}],a.call(this,AG),AH===undefined?1:AH)]),G.call(this),this.getEditorGroup([this.getGroupTitle(mstrmojo.desc(13861,"Item Formatting"))].concat(f.call(this))),Y.call(this),this.getEditorGroup([this.getEditorGroup([this.getMoreOptionsEditorLink((AF&&AF.gsi&&AF.gsi.prop)||{})])],{isNested:true,showDivider:true,isContainer:true})]);}function R(AF){var AJ=P.call(this,{controlName:"LegendTextFontGroup"}),AH=new mstrmojo.Label({text:mstrmojo.desc(13601,"Fill:")}),AD=g.call(this,null,{controlName:"LegendBackgroundFillGroup"}),AG=[AJ,AD],AL=this.getHost(),AE=x.getPropertyByPath(AL,"observableModel.showLegend"),AK=!!(AE&&AE.getValue()),AI=this.getEditorGroup([L.call(this,AE,AG),AJ,AH,AD]);AI.attachEventListener("renderComplete",AI.id,function(){x.toggleControlEnabled(AG,AK);});this.replaceChildControls(AF,[AI]);}function A(){var AD=[{n:mstrmojo.desc(12100,"Circle"),v:"Circle"},{n:mstrmojo.desc(12101,"Square"),v:"Square"},{n:mstrmojo.desc(14433,"Diamond"),v:"Diamond"},{n:mstrmojo.desc(14434,"Hexagon"),v:"Hexagon"},{n:mstrmojo.desc(14435,"Triangle"),v:"Triangle"},{n:mstrmojo.desc(12103,"Ring"),v:"Ring"}];return AD;}var v=function(AG,AF){var AD="",AE=false;e.forEach(AG,function(AH){var AI=AF==="color"?AH.color.opacity.getValue():AH.shape.getValue();if(!AE){AD=AI;AE=true;}else{if(AD!==AI){AD="";}}});return AD;};var h=function(){var AD=[0,0.1,0.2,0.3,0.4,0.5,0.6,0.7,0.8,0.9,1];return AD;};var D=function(AD){mstrmojo.css.toggleClass(AD.previewNode,"conflict",true);AD.selectedValue="";if(!!AD.list){AD.setEmptyOption();}AD.previewNode.style.backgroundColor="white";};function p(AD,AF){var AE;e.forEach(AD,function(AH,AG){if(AH===AF||AH.v===AF){AE=AG;return false;}});return AE;}function b(AG,AH){var AD=A(),AE=p(A(),AG),AF=this.getPulldown(AD,AH,AE);AF.setEmptyOption=function(){AF.selectedNode.innerHTML="";AF.selectedIndex="";AF.list.selectedIndices="";AF.list.render();};return this.addDisposable(AF);}function z(AD,AG){var AE=[0,0.1,0.2,0.3,0.4,0.5,0.6,0.7,0.8,0.9,1];var AF=this.getPulldown(AE.map(function(AH){return{v:AH,n:(AH*100)+"%"};}),AG,AE.indexOf(AD),{getIndexOfValue:function(AI){var AH=true;return this.items.reduce(function(AK,AM,AJ){if(!AH){return AK;}var AL=AI-AM.v,AN=AI-AK.v;if(AL*AN<=0){AH=false;return Math.abs(AL)<Math.abs(AN)?AJ:AJ-1;}return AM;});}});AF.setEmptyOption=function(){AF.selectedNode.innerHTML="";AF.selectedIndex="";AF.list.selectedIndices="";AF.list.render();};return this.addDisposable(AF);}function n(AD){return function(AE){var AG=AE.value,AF=AE.valueWas;if(!I.equals(AG,AF)){AD(AG,AF);}};}function W(AF,AG,AE){var AD=this.addDisposable(new mstrmojo.ui.editors.controls.ColorPickerButton(I.copy(AE,{selectedValue:AF})));AD.postselectedValueChange=n(AG);AD.setEmptyOption=function(){AD.selectedValue="";AD.list.selectedIndices="";AD.list.render();};return AD;}function j(AD,AF){var AE=this.addDisposable(new mstrmojo.ui.editors.controls.LineStyleButton());AA.call(this,function(){AE.set("selectedValue",AD);});AE.postselectedValueChange=n(AF);AE.setEmptyOption=function(){AE.selectedValue="";AE.list.selectedIndices="";AE.list.render();};return AE;}function Y(){var AI=this,AM=this.getHost(),AH=AM&&AM.stage,AL="stage.observableModel.circleLabelStyle",AD="stage.observableModel.circleStyle.showNodeLabel",AK=x.getCharGroupValueChangeCb(function(){var AO=AI.getHost();return x.getPropertyByPath(AO,AL);}),AF=this.getCharacterGroup(AK,(AH&&AH.getDataLabelFormats())||{}),AN=x.getPropertyByPath(AM,AD),AE=!!(AN&&AN.getValue()),AJ=this.getCheckboxAndLabel(AE,mstrmojo.desc(13596,"Show Data Labels"),function(AP){var AQ=AI.getHost(),AO=x.getPropertyByPath(AQ,AD);if(AO!==undefined){AO.setValue(AP);}AF.set("enabled",AP===true);}),AG=x.getPropertyByPath(AM,AL);AF.set("enabled",AE);if(AN!==undefined){AN.attachEventListener("valueChanged",this.id,function(){AJ.getCtrl().set("checked",AN.getValue());});}if(AG!==undefined){AG.attachEventListener("valueChanged",this.id,function(){var AO=this.getHost(),AP=AO&&AO.stage;AF.setFormatSource(AP.getDataLabelFormats());});}return this.getEditorGroup([this.getGroupTitle(mstrmojo.desc(11993,"Data Labels")),AJ,AF]);}function r(AD,AE){AD.forEach(function(AG,AF){AG.slot="col"+(AF+1)+"Node";});AE=I.copy(AE,{col1Width:"50%",col2Width:"50%",children:AD});return new mstrmojo.ui.editors.controls.TwoColumnContainer(AE);}function f(){var AS=this.getHost(),AZ=AS&&AS.stage,Ab=AZ&&AZ.observableModel,AG=Ab&&Ab.circleStyle,AE=AS.textSelectedIndex||0;if(!AG){return[];}var AT=function(Ad){var Ac=x.getPropertyByPath(AS,"stage.observableModel."+Ad);if(Ac===undefined){throw new Error("invalid observable model");}return Ac;},AI=function(Ae,Af,Ad){var Ac=AT(Af);return Ae.call(this,Ac.getValue(),function(Ak){var Aj,Ag=function(Al,Am,An){Af=Af.replace(new RegExp(Al?"fromNode":"toNode","g"),Al?"toNode":"fromNode");Aj=AT(Af);Aj.setValue(Am,An);};if(AS.textSelectedIndex===2){Ag(true,Ak,false);}else{if(AS.textSelectedIndex===1){Ag(false,Ak,false);}else{Aj=AT(Af);var Ai=Aj.getValue(),Ah=Af.split(".").indexOf("fromNode")===-1;if(Ai!==Ak){Ag(!Ah,Ak,true);}else{Ag(Ah,Ak,true);Ah=!Ah;}Ag(Ah,Ak,false);}}},Ad);}.bind(this);var AM=AI(z,"circleStyle.fromNode.color.opacity"),AR=AI(z,"circleStyle.toNode.color.opacity"),AF=AI(W,"circleStyle.fromNode.color.value",{showNoFill:false}),AV=AI(W,"circleStyle.toNode.color.value",{showNoFill:false}),AH=AI(W,"circleStyle.fromNode.border.color.value",{showNoFill:false,showGradient:false}),AN=AI(W,"circleStyle.toNode.border.color.value",{showNoFill:false,showGradient:false}),AK=AI(j,"circleStyle.fromNode.border.style"),AQ=AI(j,"circleStyle.toNode.border.style"),AL=AI(b,"circleStyle.fromNode.shape"),Aa=AI(b,"circleStyle.toNode.shape"),AY=AE===1?[AT("circleStyle.fromNode")]:[AT("circleStyle.toNode")],AD,AJ,AP,AU,AX,AO=A();AG.attachEventListener("valueChanged",this.id,function(){var Ac="selectedValue";if(AS.textSelectedIndex===1){AL.set("selectedIndex",p(AO,AG.fromNode.shape.getValue()));AM.set("selectedIndex",AM.getIndexOfValue(AG.fromNode.color.opacity.getValue()));AF.set(Ac,AG.fromNode.color.value.getValue());AH.set(Ac,AG.fromNode.border.color.value.getValue());AK.set(Ac,AG.fromNode.border.style.getValue());}else{if(AS.textSelectedIndex===2){Aa.set("selectedIndex",p(AO,AG.toNode.shape.getValue()));AR.set("selectedIndex",AR.getIndexOfValue(AG.toNode.color.opacity.getValue()));AV.set(Ac,AG.toNode.color.value.getValue());AN.set(Ac,AG.toNode.border.color.value.getValue());AQ.set(Ac,AG.toNode.border.style.getValue());}else{if(AG.fromNode.shape.getValue()===AG.toNode.shape.getValue()){AL.set("selectedIndex",p(AO,AG.fromNode.shape.getValue()));Aa.set("selectedIndex",p(AO,AG.toNode.shape.getValue()));}if(AG.fromNode.color.opacity.getValue()===AG.toNode.color.opacity.getValue()){AM.set("selectedIndex",AM.getIndexOfValue(AG.fromNode.color.opacity.getValue()));AR.set("selectedIndex",AR.getIndexOfValue(AG.toNode.color.opacity.getValue()));}if(AG.fromNode.color.value.getValue()===AG.toNode.color.value.getValue()){AF.set(Ac,AG.fromNode.color.value.getValue());AV.set(Ac,AG.toNode.color.value.getValue());}if(AG.fromNode.border.color.value.getValue()===AG.toNode.border.color.value.getValue()){AH.set(Ac,AG.fromNode.border.color.value.getValue());AN.set(Ac,AG.toNode.border.color.value.getValue());}if(AG.fromNode.border.style.getValue()===AG.toNode.border.style.getValue()){AK.set(Ac,AG.fromNode.border.style.getValue());AQ.set(Ac,AG.toNode.border.style.getValue());}}}});if(AE===0||AS.textSelectedIndex===0){AD=AL;AD.selectedIndex=AL.selectedIndex===Aa.selectedIndex?AL.selectedIndex:-1;AJ=AF;AJ.selectedValue=AF.selectedValue===AV.selectedValue?AF.selectedValue:"conflict";AP=AM;AP.selectedIndex=AM.selectedIndex===AR.selectedIndex?AM.selectedIndex:"conflict";AU=AH;AU.selectedValue=AH.selectedValue===AN.selectedValue?AH.selectedValue:"conflict";AX=AK;AX.selectedValue=AK.selectedValue===AQ.selectedValue?AK.selectedValue:"conflict";}else{var AW=AE===1||AS.textSelectedIndex===1;AD=AW?AL:Aa;AJ=AW?AF:AV;AP=AW?AM:AR;AU=AW?AH:AN;AX=AW?AK:AQ;}return[this.getPulldown([{n:mstrmojo.desc(14430,"From and To Items"),v:"AllItems"},{n:mstrmojo.desc(14431,"From Items"),v:"FromItems"},{n:mstrmojo.desc(14432,"To Items"),v:"ToItems"}],function(Ae){if(Ae==="FromItems"){AS.textSelectedIndex=1;}else{if(Ae==="ToItems"){AS.textSelectedIndex=2;}else{AS.textSelectedIndex=0;}}if(AS.textSelectedIndex===0){AY=[AG.fromNode,AG.toNode];if(AG.fromNode.color.opacity.getValue()!==AG.toNode.color.opacity.getValue()){AP.setEmptyOption();}if(AG.fromNode.color.value.getValue()!==AG.toNode.color.value.getValue()){D(AJ);}if(AG.fromNode.border.color.value.getValue()!==AG.toNode.border.color.value.getValue()){D(AU);}if(AG.fromNode.border.style.getValue()!==AG.toNode.border.style.getValue()){D(AX);}if(AG.fromNode.shape.getValue()!==AG.toNode.shape.getValue()){AD.setEmptyOption();}}else{if(AS.textSelectedIndex===1){AY=[AG.fromNode];}else{AY=[AG.toNode];}}var Ac=p(A(),v(AY,"shape")),Ad=p(h(),v(AY,"color"));if(Ac!==undefined&&AS.textSelectedIndex!==0){var Af;if(AS.textSelectedIndex===2){Af=AG.toNode;}else{Af=AG.fromNode;}AD.set("selectedIndex",Ac);AJ.set("selectedValue",Af.color.value.getValue());AP.set("selectedIndex",Ad);AU.set("selectedValue",Af.border.color.value.getValue());AX.set("selectedValue",Af.border.style.getValue());}},AE),this.getLabelAndControl(mstrmojo.desc(9734,"Shape:"),AD,U,Q),this.getLabelAndControl(mstrmojo.desc(13601,"Fill:"),r([AJ,AP]),U,Q),this.getLabelAndControl(mstrmojo.desc(13598,"Border:"),r([AU,AX]),U,Q)];}function L(AE,AD){var AF=!!(AE&&AE.getValue()),AH=this.getCheckboxAndLabel(AF,mstrmojo.desc(13600,"Show legend"),function(AI){x.toggleControlEnabled(AD,AI);if(AE){AE.setValue(AI);}}),AG=AH.getCtrl();if(AE){AE.attachEventListener("valueChanged",this.id,function(AI){var AJ=AI.newValue;if(AG.checked!==AJ){AG.set("checked",AJ);}});}return AH;}function H(AH){var AG=function(){var AJ=K.call(this,c),AM=K.call(this,w),AL=k.decodeColor(K.call(this,AB)),AK=parseInt(K.call(this,E),10);var AI={"text-decoration":""};AI[M.FONT_FAMILY]=AJ;AI[M.FONT_SIZE]=parseInt(AM,10);AI[M.COLOR]=AL;if((AK&B.FS_BOLD)>0){AI[M.FONT_WEIGHT]="bold";}if((AK&B.FS_ITALIC)>0){AI[M.FONT_STYLE]="italic";}if((AK&B.FS_UNDERLINE)>0){AI[M.UNDERLINE]="underline";}if((AK&B.FS_STRIKETHROUGH)>0){AI[M.LINE_THROUGH]="line-through";}AA.call(this,function(){AH.setFormatSource(AI);});}.bind(this);var AE=this.getHost(),AD={bold:B.FS_BOLD,italic:B.FS_ITALIC,underline:B.FS_UNDERLINE,strikeout:B.FS_STRIKETHROUGH};AH.fontColor.showNoFill=false;var AF=AH.fontStyle;if(AF){AF.postselectionChange=function(AI){var AL=AI.added,AM=this.items[(AL&&AL[0]!==undefined)?AL[0]:AI.removed[0]],AK=!!AL,AJ=AE.readGlobalProperty(E),AN=(AJ===undefined?0:AJ);if(AK){AN=AN|AD[AM.css];}else{AN=AN&(~AD[AM.css]);}if(this.parent){this.parent.raiseFormatValueChange(E,AN,AJ);}};}AG();x.addLegendFontChangeListeners(this,function(){if(AH.eventFromEdtModel){return ;}AG();});}function a(AE,AD){var AF=this.id;return function(AK){var AI=mstrmojo.all[AF],AJ=AI.getHost(),AG=AJ&&AJ.observableModel,AH=AE;if(AG&&AG[AH]){AG[AH].setValue(AK,AI._doNotSave);}else{if(!AI._doNotSave){AJ.setProperty(AE,AK,{suppressData:AD});}}};}function P(AD){var AF=this;var AE=new mstrmojo.ui.editors.controls.CharacterGroup(I.copy({onGroupValueChange:function(AH,AI,AG){if(AH!==E){AH=AC[AH];}if(AH===AB){AI=k.encodeColor(AI);AG=k.encodeColor(AG);}AE.eventFromEdtModel=true;(a.call(AF,AH))(AI,AG);AE.eventFromEdtModel=false;},onFmtPropsChangedDefault:function(){AA.call(this,mstrmojo.emptyFn);}},AD));AA.call(this,function(){H.call(AF,AE);});return AE;}function g(AK,AJ){var AD=this.id,AI,AH=function(){AA.call(this,function(){AG.setChildrenValue([[O,k.decodeColor(K.call(this,O))],[l,K.call(this,l)]]);});}.bind(this),AG=new mstrmojo.ui.editors.controls.FillConfigGroup(I.copy({onGroupValueChange:function(AN,AO,AM){if(AN===O){AO=k.encodeColor(AO);AM=k.encodeColor(AM);}AI=true;(a.call(mstrmojo.all[AD],AN))(AO,AM);AI=false;},getChildComp:function AL(AM){if(AM===O){return this.fillColorAndTrans.fillColor;}if(AM===l){return this.fillColorAndTrans.fillAlpha.fillAlphaText;}return undefined;},setChildValue:function AF(AN,AO){var AM=this.getChildComp(AN);if(AM===undefined){return false;}switch(AM.alias){case"fillColor":if(AO!==AM.selectedValue){AM.set("selectedValue",AO);}break;case"fillAlphaText":if(AO!==AM.value){AM.set("value",AO);}break;}},setChildrenValue:function AE(AM){var AN=this;AM.forEach(function(AO){AN.setChildValue(AO[0],AO[1]);});},onFmtPropsChangedDefault:function(AM,AN){this.syncControl(function(){this.setChildValue(AM,AN);});}},AJ));AG.fillColorAndTrans.fillColor.propName=O;AG.fillColorAndTrans.fillAlpha.fillAlphaText.propName=l;AH();x.addLegendBackgroundChangeListeners(this,function(){if(AI){return ;}AH();});return !!AK?this.getLabelAndControl(AK,AG,U,Q):AG;}mstrmojo.vi.models.editors.NetworkEditorModel=mstrmojo.declare(mstrmojo.vi.models.editors.BaseEditorModel,null,{scriptClass:"mstrmojo.vi.models.NetworkEditorModel",help:"format_panel_network.htm",init:function(AD){this._super(AD);},getPropertyInfo:function(){var AD=this.getHost();return(AD&&AD.propInfo)||{};},getPropertyValue:function(AD){var AE=this.getPropertyInfo();return AE&&AE[AD];},getInitialTarget:function t(){return N;},getTargetPulldownItems:function q(AD){var AF=this.getHost(),AE=this._super(AD),AG=function(AH){return AH.bind(this,AD);}.bind(this);if(this.isNormalOrExcludeAllDataButNotInPauseMode(AF)){AE.unshift({n:mstrmojo.desc(11974,"Data Exploration"),v:N,h:AG(J)});if(AF.hasSizebyOrColorby()){AE.push({n:mstrmojo.desc(2403,"Legend"),v:o,h:AG(R)});}}return AE;},onBEMFormatChange:function Z(AD){if(!AD.isTitle&&AD.propertyName===V.BACKGROUND_COLOR){var AG=this.getHost()||{},AF=AG.stage||{},AE=AF.observableModel;if(AE){AE.background.value.setValue(AD.value);}}}});}());(function(){mstrmojo.requiresCls("mstrmojo.hash","mstrmojo.VisUtility","mstrmojo.gm.GMUtility");var E=mstrmojo.hash,D=mstrmojo.VisUtility,C=mstrmojo.gm.GMUtility;mstrmojo.gmaps.MapColorUtils=mstrmojo.provide("mstrmojo.gmaps.MapColorUtils",{_mixinName:"mstrmojo.gmaps.MapColorUtils",cbSelectionToIndices:function B(G,F){return(G||[]).map(function(H){H=E.clone(H);return D.findInArray(F,function(I){return C.isEqualComb(H,E.clone(I.comb));});}).filter(function(H){return H!==-1;});},getColorInfoForItemAll:function A(F){var H,N,O,J,M,G,P,L,K=true,Q=true,I;if(F){O=F.length;if(O>=1){K=false;Q=false;J=F[0];M=J.color;G=J.opacity;P=M;L=G;for(I=1;I<O;I=I+1){J=F[I];M=J.color;G=J.opacity;if(P!==M){K=true;}if(L!==G){Q=true;}if(K&&Q){break;}}}}H=K?"#ffffff":P;N=Q?"":L;return{color:H,opacity:N};}});}());(function(){mstrmojo.requiresCls("mstrmojo.vi.models.editors.BaseEditorModel","mstrmojo.ui.editors.controls.CharacterGroup","mstrmojo.RadioList","mstrmojo.VisEnum","mstrmojo.array","mstrmojo.ui.editors.controls.ColorPickerButton","mstrmojo.ui.Pulldown","mstrmojo._FormatDefinition","mstrmojo.hash","mstrmojo.models.FormatModel","mstrmojo.gm.GMUtility","mstrmojo.chart.enums.EnumFontStyle","mstrmojo.func","mstrmojo.css","mstrmojo.string","mstrmojo.models.FormatModel","mstrmojo.VisUtility","mstrmojo.heatmap.vi.VisHeatmapUtility","mstrmojo.ui.editors.controls.AdvancedColorPicker","mstrmojo.vi.viz.EnumDSSDropZones");var j=mstrmojo.array,O=mstrmojo.hash,c=mstrmojo.gm.GMUtility,w=mstrmojo.func,D=mstrmojo.css,AA=mstrmojo.VisUtility,M=mstrmojo.heatmap.vi.VisHeatmapUtility,d=mstrmojo.ui.editors.controls.AdvancedColorPicker,z=mstrmojo.string,a=mstrmojo.models.FormatModel,S=a.ENUM_PROPERTY_NAMES,K=mstrmojo.VisEnum.GMLegendFormatingPropertyTag,H=mstrmojo.chart.enums.EnumFontStyle,b=mstrmojo.models.FormatModel.ENUM_PROPERTY_NAMES,f=mstrmojo.VisEnum.HEATMAP_LABEL_SIZE,G=mstrmojo.ui.editors.controls.FillConfigGroup.CTRL_FLAGS,u=mstrmojo.vi.viz.EnumDSSDropZones,e=mstrmojo.VisEnum.SERVER_JSON_ERROR_TYPE;var AB={};AB[S.FONT_SIZE]=K.LEGEND_FONT_SIZE;AB[S.FONT_FAMILY]=K.LEGEND_FONT_FAMILY;AB[S.COLOR]=K.LEGEND_FONT_COLOR;var I="de",l="lgd";var R="widgetSelectionChangeHandlers",n="colorByColorChangeHandlers",m="fontScaleChangeHandlers";function k(AD){var AE=this;return function(AH){var AG=AE.getHost(),AF=AA.getPropertyByPath(AG,"observableModel."+AD);if(AF){AF.setValue(AH);}};}function E(){var AD=this.getHost();if(AD){return AD.getPropsInfo();}return null;}function AC(AJ,AH,AG){AJ=AJ&&AJ!=="false";var AF=new mstrmojo.ui.Checkbox({checked:AJ,oncheckedChange:function(){var AK=this.checked;AG(AK,!AK);}});var AI=this.getLabelAndControl(AH,AF,"20px","100%",true);D.addWidgetCssClass(AI,"checkLabel");var AE=AI.getLabel();AE.onclick=function AD(){AF.onclick();};AE.cssDisplay="inline-block";return AI;}function N(AE,AD,AI,AH,AG){var AF=new mstrmojo.ui.Pulldown(O.copy(AG,{items:AE}));AF.set("selectedIndex",AD);AF.postselectedIndexChange=function(AJ){var AM=AJ.value,AL=AJ.valueWas;if(AM!==AL){var AK=this.items;AH(AK[AM]&&AK[AM].id,AK[AL]&&AK[AL].id);}};if(AI){return this.getLabelAndControl(AI,AF);}else{AF.getCtrl=function(){return AF;};return AF;}}function Y(AD){return new mstrmojo.Label({text:AD});}function o(AD,AF){var AE,AG;if(typeof AF==="number"){j.forEach(AD,function(AI,AH){if(!AG){AE=AH;}else{if((AF-AI.id)*(AF-AG.id)<=0){AE=Math.abs(AF-AI.value)<Math.abs(AF-AG.value)?AH:AH-1;return false;}}AG=AI;});}else{if(typeof AF==="string"){j.forEach(AD,function(AI,AH){if(AI.id===AF){AE=AH;return false;}});}}return AE;}function A(AF,AE,AG){var AD=[];if(AF!==undefined){AD.push(Y.call(this,AF));}var AH={onGroupValueChange:function(AM,AN,AL){if(AM.indexOf("FillTrans")>=0){if(!O.equals(AN,AL)){AE.opacity.setValue(AN/100);}}}};AH.propNames=[AG+"Clr",AG+"FillTrans"];var AK=new mstrmojo.ui.editors.controls.FillConfigGroup(AH);if(AK){AK.iniChildrenComp(AH.propNames);}var AI=AK.getChildComp(AH.propNames[0]);if(AI){AI.set("selectedValue",AE.value.getValue());AI.postselectedValueChange=function(AL){var AN=AL.value,AM=AL.valueWas;if(!O.equals(AN,AM)){AE.value.setValue(AN);}};}var AJ=AK.getChildComp(AH.propNames[1]);if(AJ){AJ.set("value",AE.opacity.getValue()*100);}AD.push(AK);AE.attachEventListener("valueChanged",this.id,function(){AI.set("selectedValue",AE.value.getValue());AJ.set("value",AE.opacity.getValue()*100);});return AD;}function Q(AD){var AM=this.getHost(),AH=AM.textSelectedIndex?AM.textSelectedIndex:0;AM.attachEventListener("formatclick",this.id,function(AV){if(AV.formatValue==="headerOnTop.header"){AM.textSelectedIndex=1;}else{if(AV.formatValue==="headerOnTop.cell"){AM.textSelectedIndex=2;}}});function AQ(){var AV=E.call(this).labelSize;if(AV===f.Proportional){if(AR&&AI.getSelectedItem().id!==1||!AR){AL.set("enabled",false);}}}var AF=function(AX){var AV="",AW=false;j.forEach(AX,function(AY){var AZ=AY.family.getValue();if(!AW){AV=AZ;AW=true;}else{if(AV!==AZ){AV="";}}});return AV;};var AR=!!AD.cell,AO=AR?(AH===0?[AD.header,AD.cell]:(AH===1?[AD.header]:[AD.cell])):[AD],AN=AA.getFontFamilyItems(),AL=M.getStepper(function(AY){var AV=AO.length,AX;for(AX=0;AX<AV;AX++){var AZ=AX!==AV-1,AW=AO[AX];if(AY>0){AW.scale.setValue(AW.scale.getValue()+0.1,AZ);}else{AW.scale.setValue(Math.max(0.1,AW.scale.getValue()-0.1),AZ);}}}),AE=N.call(this,AN,o(AN,AF(AO)),null,function(AX){var AV=AO.length,AW;for(AW=0;AW<AV;AW++){AO[AW].family.setValue(AX,AW!==AV-1);}},{isHostedWithin:false,scrollNodeMaxHeight:350,getPopupListConfig:function AP(){var AV=mstrmojo.ui.Pulldown.prototype.getPopupListConfig.call(this);AV.getItemProps=function AW(AZ,AX){var AY=mstrmojo._IsList.getItemProps.call(this,AZ,AX);AY.style=AZ.preview?"font-family:'"+z.encodeHtmlString(AZ.n,true)+"';":"";return AY;};return AV;}}),AT=new mstrmojo.ui.ButtonBar({hasSpacing:true,multiSelect:true,items:M.getFontStyleItems(),postselectionChange:function(AW){if(AS.flag){AS.flag=false;return ;}var Aa=AW.added,Ab=this.items[(Aa&&Aa[0]!==undefined)?Aa[0]:AW.removed[0]],AY=(Aa&&Aa.length>0);var AV=AO.length,AZ,AX,Ac;for(AZ=0;AZ<AV;AZ++){AX=AO[AZ].style.getValue();Ac=(AX===undefined?H.NORMAL:AX);if(AY){Ac=Ac|M.fontStyleValueMap[Ab.css];}else{Ac=Ac&(~M.fontStyleValueMap[Ab.css]);}AO[AZ].style.setValue(Ac.toString());}}}),AK=function(AW){var AV=j.map(AW,function(AY){var AX={};var AZ=parseInt(AY.style.getValue());M.convertFontStyle(AZ,AX);return AX;});return AV.reduce(function(AX,AZ){var AY=O.copy(AX,O.copy(AZ,{}));j.forEach(O.keyarray(AY),function(Aa){if(AX[Aa]!==AZ[Aa]){delete AX[Aa];}});return AX;});},AJ=function(AW){AS.flag=true;var AV=AK.call(AS,AW);M.updateFontStyle(AT,AV);AS.flag=false;};this._fontStepper=AL;AD.attachEventListener("valueChanged",this.id,function(AV){var AX=AV.target,AY=false,AW=false;j.forEach(AO,function(AZ){if(AX===AZ.family){AY=true;return false;}if(AX===AZ.style){AW=true;return false;}});if(AY){AE.set("selectedIndex",o(AN,AF(AO)));}if(AW){AJ(AO);}});var AU=this.getTwoColumnContainer([AE,AL],{col1Width:"50%",col2Width:"50%",dividerWidth:"8px",});var AI;var AS=this;var AM=this.getHost();var AG=[AU,AT];if(AR){AI=N.call(this,[{n:mstrmojo.desc(2461,"All"),id:0,limitNames:["header","cell"]},{n:mstrmojo.desc(2967,"Headers"),id:1,limitNames:["header"]},{n:mstrmojo.desc(12007,"Labels"),id:2,limitNames:["cell"]}],AH,null,function(AW){if(AW===0){AO=[AD.header,AD.cell];}else{if(AW===1){AO=[AD.header];}else{AO=[AD.cell];}}var AV=o(AN,AF(AO));if(AV!==undefined){AE.set("selectedIndex",AV);}else{if(AV===undefined){AE.selectedNode.innerHTML="";}}AJ(AO);AM.triggerFontScaleChangeEvent();},{isHostedWithin:false});AG.unshift(AI);}V.call(this,m,"stepper",function(AV){var AW;if(AR){AW=(AI.getSelectedItem().limitNames||[]).map(function(AX){return"headerOnTop."+AX;});}else{AW=["headerOnMiddle"];}M.setStepperEnabled(AL,AW,AV.limits);AQ.call(AS);});AM.triggerFontScaleChangeEvent();AS.flag=false;AJ(AO);return AG;}function L(AI){var AD=function(){var AO=this.getHost(),AL=AO.readGlobalAttriLegndProperty(K.LEGEND_FONT_FAMILY),AP=AO.readGlobalAttriLegndProperty(K.LEGEND_FONT_SIZE),AN=c.decodeColor(AO.readGlobalAttriLegndProperty(K.LEGEND_FONT_COLOR)),AM=parseInt(AO.readGlobalAttriLegndProperty(K.LEGEND_FONT_STYLE),10);var AK={};AK["text-decoration"]="";AK[S.FONT_FAMILY]=AL;AK[S.FONT_SIZE]=parseInt(AP,10);AK[S.COLOR]=AN;M.convertFontStyle(AM,AK);AI.setFormatSource(AK);}.bind(this);var AH=this.getHost();var AG=["fontFamily","fontStyle","fontSize","fontColor"];function AF(AL,AK){var AM=null;if(AG.indexOf(AK)>-1){AM=AL[AK];}return AM;}var AJ=AF(AI,AG[3]);AJ.showNoFill=false;var AE=AF(AI,AG[1]);if(AE){AE.postselectionChange=function(AK){var AN=AK.added,AO=this.items[(AN&&AN[0]!==undefined)?AN[0]:AK.removed[0]],AM=!!AN,AL=AH.readGlobalAttriLegndProperty(K.LEGEND_FONT_STYLE),AP=(AL===undefined?H.NORMAL:AL);if(AM){AP=AP|M.fontStyleValueMap[AO.css];}else{AP=AP&(~M.fontStyleValueMap[AO.css]);}if(this.parent){this.parent.raiseFormatValueChange(K.LEGEND_FONT_STYLE,AP,AL);}};}AD();AA.addLegendFontChangeListeners(this,function(){if(AI.eventFromEdtModel){return ;}AD();});return AI;}function U(AD){var AE=this;return L.call(this,new mstrmojo.ui.editors.controls.CharacterGroup(O.copy({onGroupValueChange:function(AH,AJ,AG){if(O.equals(AJ,AG)){return ;}if(AH!==K.LEGEND_FONT_STYLE){AH=AB[AH];}if(AH===K.LEGEND_FONT_COLOR){AJ=c.encodeColor(AJ);}var AI=AE.getHost(),AF=AI.observableModel[AH];if(AF){this.eventFromEdtModel=true;AF.setValue(AJ);this.eventFromEdtModel=false;}},onFmtPropsChangedDefault:mstrmojo.emptyFn},AD)));}function x(){var AH="layout",AG=E.call(this)[AH],AD={isHostedWithin:false},AE=[{n:mstrmojo.desc(13758,"Keep readability"),displayName:mstrmojo.desc(12124,"Keep readability, not element order"),id:0},{n:mstrmojo.desc(13759,"Balance"),displayName:mstrmojo.desc(13760,"Balance readability and element order"),id:1},{n:mstrmojo.desc(13761,"Keep element order"),displayName:mstrmojo.desc(12126,"Keep element order, not readability"),id:2}],AF=N.call(this,AE,AG,null,k.call(this,AH),AD);AF.list.getItemDisplayName=function(AI){return AI.displayName;};return AF;}function v(){var AK="isHeaderOnTop",AG=E.call(this)[AK],AH=k.call(this,AK),AJ=this.getHost(),AD=AJ&&AJ.model.docModel,AI=this;var AE=[{n:mstrmojo.desc(13605,"On top"),id:true},{n:mstrmojo.desc(13604,"In center"),id:false}];var AF=mstrmojo.desc(13602,"Headers");return N.call(this,AE,AG?0:1,AF,function(AM,AL){var AN=M.isSpatial();if(AN){AI.manualChangeLabelSize=false;var AO=E.call(AI)["labelSize"];if(!AM&&AI.memoLabelSize===undefined&&AO===0){AI._labelSizeController.getCtrl().set("selectedIndex",1);}else{if(AM&&AI.memoLabelSize===undefined&&AO===1){AI._labelSizeController.getCtrl().set("selectedIndex",0);}else{AI._labelSizeController.getCtrl().set("selectedIndex",AO);AI.memoLabelSize=AO;}}}AH(AM,AL);if(AD){AD.selectVIUnit(AJ.parent.id,true);}});}function X(){var AG="labelSize",AE=E.call(this)[AG],AF=this;var AD=0;if(AE===f.Off){AD=1;}else{if(AE===f.Proportional){AD=2;}}this._labelSizeController=N.call(this,[{n:mstrmojo.desc(6030,"On"),id:"On"},{n:mstrmojo.desc(6031,"Off"),id:"Off"},{n:mstrmojo.desc(11990,"Proportional"),id:"Proportional"}],AD,mstrmojo.desc(13603,"Labels"),w.composite([k.call(this,AG),function(AJ){var AI=M.isSpatial();if(AI){if(AF.manualChangeLabelSize){AF.memoLabelSize=AJ;}else{AF.manualChangeLabelSize=true;}}AF._showMetricValuesController.set("enabled",AJ!=="Off");var AH=AF.getHost();if(AH){AH.triggerFontScaleChangeEvent();}}]));return this._labelSizeController;}function C(){var AE=E.call(this);var AD=mstrmojo.desc(12122,"Show metric values");var AG="showMetricValues";var AF=AC.call(this,AE[AG],AD,k.call(this,AG));AF.enabled=AE.labelSize!==f.Off;this._showMetricValuesController=AF;return AF;}function Z(){function AP(AU,AT){function AV(){if(AT===undefined){AT=0;}else{AJ=AT;}if(AQ){AS=AQ.getColorByElements();}var AX=AS[AT];this.setChildValue(AN,AX.color);this.setChildValue(AG,AX.opacity);var AW=AH().some(function(AY){return AA.isColorManuallySet(AQ,AS[AY].comb);});AA.setColorPickerShowAutomatic(this,AW);}AI.fillColorAndTrans.fillColor.set("enabled",AT!==0);if(AU){this.syncControls(AV);}else{AV.call(this);}}function AO(AT){return(AT||[]).map(function(AU){AU=O.clone(AU);return AA.findInArray(AS,function(AV){return c.isEqualComb(AU,O.clone(AV.comb));});}).filter(function(AU){return AU!==-1;});}function AH(){return[].concat(AJ===0?AL:AJ);}var AQ=this.getHost(),AS=AQ.getColorByElements(),AR=AO(AQ&&(AQ.contextMenuCbSelection||AQ.edtModelCbInitSelection)),AJ,AN="ShapeClr",AG="ShapeFillTrans",AM=d.VAL_AUTOMATIC,AD=AS.map(function(AU,AT){return{n:AU.text,v:AT};}),AL=AA.range(1,AD.length),AF=false,AK=mstrmojo.desc(12092,"Multiple Elements"),AE,AI;if(AR.length===0){AJ=0;}else{if(AR.length===1){AJ=AR[0];}else{AJ=AR;AF=true;}}AI=new mstrmojo.ui.editors.controls.FillConfigGroup({onGroupValueChange:function(AZ,AY){var AX=[],AV=[],AT=AZ===AN,AU=AZ===AG,AW=AH();AW.forEach(function(Aa){var Ad=AS[Aa],Ac=Ad.comb,Ab;AV.push(Ac);if(AT){if(AY===AM){AX.push("default");Ab=AQ.listenToUpdateColorMap(function(){var Af=AV.length,Ae;AW.forEach(function(Ag){var Ah=AS[Ag];Ae=c.decodeColor(AA.getCombColor(AQ,Ah.comb));Ah.color=Ae;});if(Af>1){Ae=AS[0].color;}AI.syncControls(function(){this.setChildValue(AN,Ae);AA.setColorPickerShowAutomatic(AI,false);});AQ.detachUpdateColorMapListener(Ab);});}else{AX.push(c.encodeColor(AY));Ad.color=AY;}}else{if(AU){AX.push(AY);Ad.opacity=AY;}}});if(AT){AQ.updateColorMap(AV,AX);AA.setColorPickerShowAutomatic(this,true);}if(AU){AQ.updateColorByOpacity(AV,AX);}}});if(AI){AI.iniChildrenComp([AN,AG]);AP.call(AI,true,AF?undefined:AJ);AI.fillColorAndTrans.fillColor.set("enabled",AJ!==0);}AE=this.getPulldown(AD,AP.bind(AI,true),AF?undefined:AJ,{setDisplayText:function(AT){var AU=this.selectedNode;if(AU){AU.innerHTML=AT;AU.title=AT;}},allowHTML:false,isHostedWithin:false});if(AF){AE.attachEventListener("renderComplete",AE.id,function(){AE.setDisplayText(AK);});}V.call(this,R,"shapeColor",function(AT){var AV=AO(AT.colorbyElements),AU=AV.length;if(AU<1){return ;}if(AV.length===1){AE.set("selectedIndex",AV[0]);}else{AE.setDisplayText(AK);AJ=AV;AP.call(AI,true);}});V.call(this,n,"fill",function(AT){AI.syncControls(function(){AI.setChildValue(AN,AT.fill);AA.setColorPickerShowAutomatic(AI,AT.showAutomatic);});});V.call(this,n,"opacity",function(AT){AI.syncControls(function(){AI.setChildValue(AG,AT.opacity);});});V.call(this,n,"invalidateCache",function(){AS.forEach(function(AU,AT){if(AT===0){return ;}AU.color=c.decodeColor(AA.getCombColor(AQ,AU.comb));});});return this.getEditorGroup([this.getGroupTitle(mstrmojo.desc(13753,"Shape Color")),AE,AI]);}function q(){var AF=this.getHost(),AD=AA.getMetricsInDropZone(AF.zonesModel,mstrmojo.vi.viz.EnumDSSDropZones.ColorBy),AG=AD[0],AE=AF.modelData.gsi,AI=AE.mx,AH=AE.thresholds[AG.id];return new mstrmojo.vi.ui.ColorRangeSelector({thresholds:AH,metric:AI[j.find(AI,"did",AG.id)],onclick:function(){AF.model.openThresholdEditor(AA.getMetricsInDropZone(AF.zonesModel,u.ColorBy)[0],true,false);}});}function h(){function AI(){AF.syncControls(function(){var AM=AA.getPropertyByPath(AH,"observableModel.colorByOpacity"),AN=AM!==undefined?AM.getValue():1,AL=AN*100;this.setChildValue(AK,AL.toString());});}var AH=this.getHost();var AK="ShapeFillTrans";var AE;var AJ=q.call(this);var AF=new mstrmojo.ui.editors.controls.FillConfigGroup({visibleControls:G.FILL_TRANSPARENCY,onGroupValueChange:function(AN,AM){if(AN===AK){var AL=AA.getPropertyByPath(AH,"observableModel.colorByOpacity");if(AL){AL.setValue(AM/100);}}}});if(AF){AF.iniChildrenComp([AK]);AI();AE=AA.getPropertyByPath(AH,"observableModel.colorByOpacity");if(AE){AE.attachEventListener("valueChanged",AH.id,AI);}}var AG=this.getTwoColumnContainer([AJ,AF],{col1Width:"60%",col2Width:"40%",});var AD=this.getEditorGroup([new mstrmojo.Label({text:mstrmojo.desc(2885,"Fill")}),AG],{showDivider:false,isNested:true,isContainer:true});return this.getEditorGroup([this.getGroupTitle(mstrmojo.desc(13753,"Shape Color")),AD]);}function J(){var AF=this.getHost(),AE=E.call(this),AD=AF.levelAttributes;if(AF&&AE.isHeaderOnTop&&AD&&AD.length>1){var AG=A.call(this,undefined,AF.observableModel.headerColors,"headerColor");AG.unshift(this.getGroupTitle(mstrmojo.desc(14115,"Header Fill:")));return this.getEditorGroup(AG);}}function P(AH){var AL=this.getHost(),AG=AL.observableModel,AK=AL.getPropsInfo().colorByType,AD,AJ;if(!AG){return ;}var AI=AG&&AG.fonts,AE=AI&&(AL.props&&AL.props.isHeaderOnTop?AI.headerOnTop:AI.headerOnMiddle),AF=[this.getGroupTitle(mstrmojo.desc(3544,"Text"))];if(AE){AF=AF.concat(Q.call(this,AE));}AD=[this.getEditorGroup([Y.call(this,mstrmojo.desc(7195,"Layout")),x.call(this),v.call(this),X.call(this),C.call(this)]),this.getEditorGroup(AF),J.call(this),this.getEditorGroup([this.getMoreOptionsEditorLink((AL.modelData&&AL.modelData.gsi&&AL.modelData.gsi.prop)||{})])];if(AK==="attribute"){AJ=Z.call(this);}else{if(AK==="metric"&&AA.getMetricsInDropZone(AL.zonesModel,u.ColorBy)[0]!==undefined){AJ=h.call(this);}}if(AJ){AD.splice(1,0,AJ);}this.replaceChildControls(AH,AD);}function B(AF,AE){var AD=!!(AF&&AF.getValue()),AH=AC.call(this,AD,mstrmojo.desc(13600,"Show legend"),function(AI){AA.toggleControlEnabled(AE,AI);if(AF){AF.setValue(AI);}}),AG=AH.getCtrl();if(AF){AF.attachEventListener("valueChanged",this.id,function(AI){var AJ=AI.newValue;if(AG.checked!==AJ){AG.set("checked",AJ);}});}return AH;}function W(AI){var AH=this.getHost().observableModel,AF=AH&&AH.showLegend,AE=!!(AF&&AF.getValue()),AD=[U.call(this,{controlName:"LegendTextFontGroup"})],AG;AD=AD.concat(A.call(this,mstrmojo.desc(13601,"Fill:"),AH.legendBackground,"legendBackground"));AG=AD.slice();AD.unshift(B.call(this,AF,AG));this.replaceChildControls(AI,[this.getEditorGroup(AD)]);AA.toggleControlEnabled(AG,AE);}function V(AD,AH,AG,AF){var AE=this[AD];if(AE===undefined){this[AD]={};AE=this[AD];}AE[AH]={fn:AG,context:AF};}function F(AD){var AE=this;return function(AF){var AG=AE[AD]||{},AI=AF.type==="*"?Object.keys(AG):[].concat(AF.type),AH;AI.forEach(function(AJ){if(AG.hasOwnProperty(AJ)){AH=AG[AJ];AH.fn.call(AE,AF,AH.context);}});};}mstrmojo.vi.models.editors.HeatMapEditorModel=mstrmojo.declare(mstrmojo.vi.models.editors.BaseEditorModel,null,{scriptClass:"mstrmojo.vi.models.HeatMapEditorModel",help:"format_panel_heat_map.htm",memoLabelSize:undefined,manualChangeLabelSize:true,init:function(AE){if(this._super){this._super(AE);}var AF=this.getHost();if(!AF){return ;}var AD=F.bind(this);AF.attachEventListener("selectionChange",this.id,AD(R));AF.attachEventListener("colorByColorChange",this.id,AD(n));AF.attachEventListener("fontScaleChange",this.id,AD(m));},getInitialTarget:function t(){return I;},getTargetPulldownItems:function p(AD){var AF=this.getHost(),AE=this._super(AD),AG=function(AH){return AH.bind(this,AD);}.bind(this);if(this.isNormalOrExcludeAllDataButNotInPauseMode(AF)){AE.push({n:mstrmojo.desc(11974,"Data Exploration"),v:I,h:AG(P)});AE.push(AE.shift());if(AF.hasSizebyOrColorby()){AE.push({n:mstrmojo.desc(2403,"Legend"),v:l,h:AG(W)});}}return AE;},getTwoColumnContainer:function r(AD,AE){AD.forEach(function(AG,AF){AG.slot="col"+(AF+1)+"Node";});AE=O.copy(AE,{col1Width:"50%",col2Width:"50%",children:AD});return new mstrmojo.ui.editors.controls.TwoColumnContainer(AE);},onBEMFormatChange:function g(AD){if(!AD.isTitle&&AD.propertyName===b.BACKGROUND_COLOR){var AF=this.getHost()||{},AE=AF.observableModel;if(AE){AE.background.value.setValue(AD.value);}}}});}());(function(){mstrmojo.requiresCls("mstrmojo.dom","mstrmojo.css","mstrmojo.array","mstrmojo.string","mstrmojo.gm.GMEnums","mstrmojo.gm.GMUtility","mstrmojo.chart.enums.EnumFontStyle","mstrmojo.vi.enums.EnumThemeProperties","mstrmojo.vi.viz.EnumVisualizationTemplates");var AH=mstrmojo.gm,u=mstrmojo.array,W=mstrmojo.hash,D=mstrmojo.css,J=AH.GMUtility,G=mstrmojo.chart.enums.EnumFontStyle,q=AH.WidgetPropertyTag,V=AH.FormatingPropertyTag,c=AH.ShapeFillType,AD=mstrmojo.vi.viz.EnumVisualizationTemplates,e=AH.EnumFitTo,K=AH.EnumAxisScale,O=AH.EnumShape,AE=AH.EnumSubtype,N=AH.EnumDataLabels,AN=AH.EnumDataLabelPlacements,X=AH.EnumLegend,B=AH.EnumLegendMode,g=AH.EnumTextAlignH,v=AH.EnumTextAlignV,l=AH.EnumMaxSizeType,h=AH.EnumMinSizeType,AF=AH.EnumAxes,AM=AH.EnumMatrixLines,z=AH.EnumGridLines,F=AH.EnumLegendSlot,p=AH.EnumGraphType,H=mstrmojo.vi.enums.EnumThemeProperties.ENUM_LAYOUT_THEME;var n={Content:1,Window:2,Compact:3,Manual:4},AQ={Global:0,PerRC:1,Local:2,Custom:3,Different:4},t={Area:0,Bar:1,Line:2,Circle:4,Square:6,Tick:7,Pie:10,Ring:11},AP={Automatic:1,Absolute:2,Stacked:3,Clustered:4,Percent:5},AC={Hide:1,"Show only values":2,"Show only text":3},Q={Automatic:1,Generic:2,Reserved:3},AA={Automatic:1,Manual:2,"Auto fit":3},x={Automatic:1,Manual:2,Proportional:3},o={"Show Both":1,"Show None":2,"Show Only X":3,"Show Only Y":4},U={"Show All":1,"Show None":2,"Show Only Horizontal":3,"Show Only Vertical":4},L={Automatic:1,Show:2,Hide:3};var AG=[null,"Content","Window","Compact"],m=["Global","PerRC","Local","Custom","Different"],b=["Area","Bar","Line","StepLine","Circle","Rectangle","Square","Tick","PieSlice","Polygon","Pie","Ring"],S=[null,"Automatic","Absolute","Stacked","Clustered","Percent"],Y=[null,"Hide","Show only values","Show only text"],AK=[null,"Automatic","Generic","Reserved"],AJ=[null,"Automatic","Manual","Auto fit"],AB=[null,"Automatic","Manual","Proportional"],A=[null,"Show Both","Show None","Show Only X","Show Only Y"],AO=[null,"Show All","Show None","Show Only Horizontal","Show Only Vertical"],k=[null,"Automatic","Show","Hide"];var R={allAxLnShw:"xAxLnShw:yAxLnShw",allAxLnClr:"xAxLnClr:yAxLnClr",allAxLnStyle:"xAxLnStyle:yAxLnStyle",allAxLnCmbStyle:"xAxLnCmbStyle:yAxLnCmbStyle",allAxLnThk:"xAxLnThk:yAxLnThk",allAxTtShw:"xAxTtShw:yAxTtShw",allAxTtCtt:"xAxTtCtt:yAxTtCtt",allAxTtFntClr:"xAxTtFntClr:yAxTtFntClr",allAxTtFntFml:"xAxTtFntFml:yAxTtFntFml",allAxTtFntStyle:"xAxTtFntStyle:yAxTtFntStyle",allAxTtFntSz:"xAxTtFntSz:yAxTtFntSz",allAxLbFntClr:"xAxLbFntClr:yAxLbFntClr",allAxLbFntSz:"xAxLbFntSz:yAxLbFntSz",allAxLbFntFml:"xAxLbFntFml:yAxLbFntFml",allAxLbFntStyle:"xAxLbFntStyle:yAxLbFntStyle",allAxLbRtt:"xAxLbRtt:yAxLbRtt",allAxLbShw:"xAxLbShw:yAxLbShw",allMatrixLnShw:"vMatrixLnShw:hMatrixLnShw",allMatrixLnClr:"vMatrixLnClr:hMatrixLnClr",allMatrixLnThk:"vMatrixLnThk:hMatrixLnThk",allMatrixLnStyle:"vMatrixLnStyle:hMatrixLnStyle",allMatrixLnCmbStyle:"vMatrixLnCmbStyle:hMatrixLnCmbStyle",allNGMGridLnShw:"xGridLnShw:yGridLnShw",allGridLnShw:"majorGridLnShw:minerGridLnShw",allGridLnClr:"majorGridLnClr:minerGridLnClr",allGridLnThk:"majorGridLnThk:minerGridLnThk",allGridLnStyle:"majorGridLnStyle:minerGridLnStyle",allGridLnCmbStyle:"majorGridLnCmbStyle:minerGridLnCmbStyle",allRwColShw:"rwHdrShw:colHdrShw:rwVlShw:colVlShw",allLnShw:"xAxLnShw:yAxLnShw:xAxOriLnShw:yAxOriLnShw",allLnClr:"xAxLnClr:yAxLnClr:xAxOriLnClr:yAxOriLnClr",allLnStyle:"xAxLnStyle:yAxLnStyle:xAxOriLnStyle:yAxOriLnStyle",allLnCmbStyle:"xAxLnCmbStyle:yAxLnCmbStyle:xAxOriLnCmbStyle:yAxOriLnCmbStyle",allLnThk:"xAxLnThk:yAxLnThk:xAxOriLnThk:yAxOriLnThk",allTxtFntClr:"rwHdrTxtFntClr:colHdrTxtFntClr:rwVlTxtFntClr:colVlTxtFntClr:lgdFntClr:dlFntClr:rfLnFntClr:xAxTtFntClr:xAxLbFntClr:yAxTtFntClr:yAxLbFntClr",allTxtFntSz:"rwHdrTxtFntSz:colHdrTxtFntSz:rwVlTxtFntSz:colVlTxtFntSz:lgdFntSz:dlFntSz:rfLnFntSz:xAxTtFntSz:xAxLbFntSz:yAxTtFntSz:yAxLbFntSz",allTxtFntFml:"rwHdrTxtFntFml:colHdrTxtFntFml:rwVlTxtFntFml:colVlTxtFntFml:lgdFntFml:dlFntFml:rfLnFntFml:xAxTtFntFml:xAxLbFntFml:yAxTtFntFml:yAxLbFntFml",allTxtFntStyle:"rwHdrTxtFntStyle:colHdrTxtFntStyle:rwVlTxtFntStyle:colVlTxtFntStyle:lgdFntStyle:dlFntStyle:rfLnFntStyle:xAxTtFntStyle:xAxLbFntStyle:yAxTtFntStyle:yAxLbFntStyle",allRwColTxtFntClr:"rwHdrTxtFntClr:colHdrTxtFntClr:rwVlTxtFntClr:colVlTxtFntClr",allRwColTxtFntSz:"rwHdrTxtFntSz:colHdrTxtFntSz:rwVlTxtFntSz:colVlTxtFntSz",allRwColTxtFntFml:"rwHdrTxtFntFml:colHdrTxtFntFml:rwVlTxtFntFml:colVlTxtFntFml",allRwColTxtFntStyle:"rwHdrTxtFntStyle:colHdrTxtFntStyle:rwVlTxtFntStyle:colVlTxtFntStyle",allRwColTxtAlignH:"rwHdrTxtAlignH:colHdrTxtAlignH:rwVlTxtAlignH:colVlTxtAlignH",allRwColTxtAlignV:"rwHdrTxtAlignV:colHdrTxtAlignV:rwVlTxtAlignV:colVlTxtAlignV",outBdrShw:"OutSideBorder",allFillClr:"bgFillClr:rwHdrFillClr:colHdrFillClr",allFillTrans:"bgFillTrans:rwHdrFillTrans:colHdrFillTrans",colTxtShw:"colHdrShw:colVlShw",rwTxtShw:"rwHdrShw:rwVlShw",rwTxtTxtFntClr:"rwHdrTxtFntClr:rwVlTxtFntClr",rwTxtTxtFntSz:"rwHdrTxtFntSz:rwVlTxtFntSz",rwTxtTxtFntFml:"rwHdrTxtFntFml:rwVlTxtFntFml",rwTxtTxtFntStyle:"rwHdrTxtFntStyle:rwVlTxtFntStyle",rwTxtTxtAlignH:"rwHdrTxtAlignH:rwVlTxtAlignH",rwTxtTxtAlignV:"rwHdrTxtAlignV:rwVlTxtAlignV",colTxtTxtFntClr:"colHdrTxtFntClr:colVlTxtFntClr",colTxtTxtFntSz:"colHdrTxtFntSz:colVlTxtFntSz",colTxtTxtFntFml:"colHdrTxtFntFml:colVlTxtFntFml",colTxtTxtFntStyle:"colHdrTxtFntStyle:colVlTxtFntStyle",colTxtTxtAlignH:"colHdrTxtAlignH:colVlTxtAlignH",colTxtTxtAlignV:"colHdrTxtAlignV:colVlTxtAlignV",axOriLnShw:"xAxOriLnShw:yAxOriLnShw",axOriLnClr:"xAxOriLnClr:yAxOriLnClr",axOriLnStyle:"xAxOriLnStyle:yAxOriLnStyle",axOriLnCmbStyle:"xAxOriLnCmbStyle:yAxOriLnCmbStyle",axOriLnThk:"xAxOriLnThk:yAxOriLnThk",autoGridLnClr:"majorGridLnClr",autoGridLnCmbStyle:"majorGridLnCmbStyle",autoGridLnThk:"majorGridLnThk",autoGridLnStyle:"majorGridLnStyle"};var C={metricShapes:1,mtcLvlDataLabel:1,axisOrigin:1,AxisScale:1,fmtOnComb:1,yr:1,xr:1,y2r:1,x2r:1,rvr:1,chr:1,groupInfo:1};var AL=/[{}\[\],"'_:;\s]/i;var w="@pLd";var I=/@pLd/g;function j(AR){var AS=new window.DOMParser();return AS.parseFromString(AR,"text/xml");}function AI(){var AR=this.xmlData,AS=this.xmlDoc;if(!AS&&AR){this.xmlDoc=AS=j(AR);}return AS;}function a(AS,AR){if(!C[AS]){return AR;}return AR.replace(I,"");}function f(AW,AR,AY){if(!C[AW]){return AR;}var AX="",AV=0,AU,AT,AS;if(!AR||AR.length===0){return AR;}AU=AR.search(AL);while(AU!==-1){if(AU!==AV){AT=AR.substring(AV,AU);if(AT.length===32){AS=AY[AT];if(AS!==undefined){AX+=w+AT;}}else{AX+=AT;}}AX+=AR[AU];AR=AR.substring(AU+1);AU=AR.search(AL);}AX+=AR;return AX;}function P(AS){var AR=new XMLSerializer();return AR.serializeToString(AS);}function E(AS,AU){var AR,AT="",AV=AU.length;for(AR=0;AR<AV;AR++){if(AR!==0){AT+=",";}AT+=AS[AR]+":"+AU[AR];}return AT;}function M(AV){AV=AV||"";var AT,AS,AR=AV.split(","),AW=AR.length,AU={};for(AT=0;AT<AW;AT++){AS=AR[AT].split(":");if(AS.length===2){AU[AS[0]]=parseFloat(AS[1]);}}return AU;}function Z(AT){AT=AT||"";var AR=AT.split(":"),AS={};if(AR.length===2){AS[AR[0]]=parseFloat(AR[1])||1;}return AS;}function r(AS){AS=AS||"";var AR=AS.split(",");return{first:parseInt(AR[0],10),second:parseInt(AR[1],10)};}mstrmojo.gm.GMProperty=mstrmojo.declare(mstrmojo.Obj,null,{scriptClass:"mstrmojo.gm.GMProperty",scales:null,generalProps:null,xmlDoc:null,xmlData:null,xmlDirty:false,jsonData:null,controller:null,rhIds:null,chIds:null,yIds:null,xIds:null,y2Ids:null,x2Ids:null,templateObjectMapping:null,isItemCached:null,readItemCache:null,init:function(AR){if(this._super){this._super(AR);}this.resetScales();this.resetGeneralProps();this.rhIds=[];this.chIds=[];if(!mstrmojo.gm.GMProperty.propertyMap){this.generatePropertyMap();}this.isItemCached={};this.readItemCache={};this.gm="OGM";},generatePropertyMap:function(){var AS,AU=mstrmojo.gm.GMProperty.propertyMap={};function AR(AV,AW){if(!AU[AV]){AU[AV]=[AW];}else{if(AU[AV].indexOf(AW)<0){AU[AV].push(AW);}}}function AT(AV){return function(AW){AR(AW,AV);};}for(AS in R){if(R.hasOwnProperty(AS)){AU[AS]=R[AS].split(":");u.forEach(AU[AS],AT(AS));}}},updateDefaults:function(AV,AS){var AR=AS[V.MODIFIED_DEF_FILL_COLOR],AT;if(AR){if(AR==="transparent"){AT=AR;}else{if(AR==="default"){AT=undefined;}else{if(!isNaN(AR)){AT=parseInt(AS[V.MODIFIED_DEF_FILL_COLOR],10);}else{try{AT=JSON.parse(AR.replace(/'/g,'"'));}catch(AU){AT=undefined;}}}}}if(AT!==undefined){AV[V.SHAPE_FILL_COLOR]=AT;AV[V.SHAPE_FILL_COLOR_DEFAULT]=false;}else{AV[V.SHAPE_FILL_COLOR_DEFAULT]=true;}this.defaultsObj=AV;},resetScales:function(){this.scales={rh:[],ch:[],y:1,y2:1,x:1,x2:1,lgd:1,ctw:1,cth:1};},updateChartProps:function(AU){var AV=this,AT=this.jsonData,AS;AS=mstrApp.getThemeProps(this.gm);AS=W.mergeHashes(AS.GENERAL_PROPS.ALL,AS.GENERAL_PROPS[AU]);W.keyarray(AS).forEach(function(AW){AV.generalProps[AW]=AS[AW];});var AR={legendShow:q.LEGEND_VISIBLE,FitTo:q.FIT_TO,dataLabels:q.DATA_LABEL};W.keyarray(AR).forEach(function(AW){if(AT[AR[AW]]){AV.initItem(AR[AW]);}});},resetGeneralProps:function(){var AR={};AR.fitTo=e.NONE;AR.axisScale=K.GLOBAL;AR.shape=O.LINE;AR.subtype=AE.AUTO;AR.dataLabels=N.HIDE;AR.dataLabelPlacements=AN.AUTOMATIC;AR.banding=true;AR.legend=X.SHOW;AR.legendMode=B.RESTORED;AR.legendShow=true;AR.colAlign=g.CENTER;AR.rowAlignH=g.CENTER;AR.rowAlignV=v.CENTER;AR.maxSizeType=l.AUTO;AR.minSizeType=h.AUTO;AR.maxSizeValue=0.9;AR.minSizeValue=0.2;AR.outBorder=true;AR.axes=AF.SHOW_BOTH;AR.matrixLine=AM.SHOW_ALL;AR.gridLine=z.AUTO;AR.legendSlot=F.RIGHT_MIDDLE;this.generalProps=AR;},getXMLString:function(){return this.xmlData;},isXMLDirty:function(){return this.xmlDirty;},resetXMLDirtyFlag:function(){this.xmlDirty=false;},initFromXML:function(AU){if(AU){if(this.xmlData&&this.xmlData!==AU){this.xmlDoc=null;}this.xmlData=AU;}var AS,AV,AR=[q.FIT_TO,q.AXIS_SCALE,q.SHAPE,q.SUB_TYPE,q.DATA_LABEL,q.DATA_LABELS_PLACEMENT,q.BANDING,q.LEGEND_VISIBLE,q.COL_ALIGNMENT,q.ROW_ALIGNMENT,q.MAX_SIZE_TYPE,q.MAX_SIZE_VALUE,q.MIN_SIZE_TYPE,q.MIN_SIZE_VALUE,q.SELECTION_TYPE,q.SELECTIONS,q.OUTSIDE_BORDER,q.AXES,q.MATRIX_LINES,q.GRID_LINES,q.LEGEND_MODE,q.LEGEND_POSITION,q.SCALE_LEGEND_WIDTH,q.SCALE_CHART_WIDTH,q.SCALE_CHART_HEIGHT,q.METRIC_SHAPES,q.AXIS_ORIGIN,q.LOG_SCALE,q.TREND_LINE_DEF,q.TREND_BUBBLE_FORE_DEF,q.REF_LINE_DEF,V.FORMATS_ON_COMBINATION,V.ALL_SHAPE_FORMAT,V.V_MATRIX_LINES_SHOW,V.V_MATRIX_LINES_COLOR,V.V_MATRIX_LINES_THICKNESS,V.V_MATRIX_LINES_STYLE,V.H_MATRIX_LINES_SHOW,V.H_MATRIX_LINES_COLOR,V.H_MATRIX_LINES_THICKNESS,V.H_MATRIX_LINES_STYLE];for(AS=0,AV=AR.length;AS<AV;AS++){this.initItem(AR[AS]);}var AT=this.generalProps;if(AT.legendShow){AT.legend=(AT.legendMode===B.MINIMIZED)?X.MINIMIZED:X.SHOW;}else{AT.legend=X.HIDE;}},reInitItem:function(AU,AS){var AR=this.generalProps;var AT=this.hGetPropValue(AU);switch(AU){case q.FIT_TO:AR.fitTo=n[AT]||AS;break;case V.CONTAINER_FIT_MODE:AR[V.CONTAINER_FIT_MODE]=AT===undefined?AS:AT;break;default:break;}},initItem:function(Aa){var Ai,Ae,AY,AX,Ah,Ag,AZ,AT,Ak,AW,Al,AR,Ad,AU,Aj=this.rhIds,Ab=this.chIds,Ac=this.controller,AV=this.scales,AS=this.generalProps,Af;Af=this.hGetPropValue(Aa);switch(Aa){case q.FIT_TO:AS.fitTo=n[Af]||W.walk("GENERAL_PROPS.ALL.fitTo",mstrApp.getThemeProps(this.gm));break;case q.AXIS_SCALE:AS.axisScale=AQ[Af]||K.GLOBAL;break;case q.SHAPE:AY=t[Af];AS.shape=isNaN(AY)?O.LINE:AY;break;case q.METRIC_SHAPES:case q.METRIC_LEVEL_DATA_LABEL:case q.AXIS_ORIGIN:case q.LOG_SCALE:case q.TREND_LINE_DEF:case q.TREND_BUBBLE_FORE_DEF:case q.REF_LINE_DEF:case q.FORMATS_ON_COMBINATION:case V.ALL_SHAPE_FORMAT:AS[Aa]=J.stringToJSON(Af);break;case q.SUB_TYPE:AS.subtype=AP[Af]||AE.AUTO;break;case q.DATA_LABEL:AS.dataLabels=AC[Af];break;case q.DATA_LABELS_PLACEMENT:AS.dataLabelPlacements=Q[Af];break;case q.BANDING:AS.banding=Af==="true";break;case q.LEGEND_VISIBLE:AS.legendShow=Af!=="Hide";break;case q.COL_ALIGNMENT:if(Af!==undefined){AY=parseInt(Af,10);if(!isNaN(AY)&&AY>=0&&AY<=2){this.updateItem(V.COLUMN_HEADER_TEXT_ALIGNMENT_HORIZONTAL,AY);this.updateItem(V.COLUMN_VAVLUE_TEXT_ALIGNMENT_HORIZONTAL,AY);}}break;case q.ROW_ALIGNMENT:if(Af!==undefined){AY=r(Af).first;if(!isNaN(AY)&&AY>=0&&AY<=2){this.updateItem(V.ROW_HEADER_TEXT_ALIGNMENT_HORIZONTAL,AY);this.updateItem(V.ROW_VAVLUE_TEXT_ALIGNMENT_HORIZONTAL,AY);}AY=r(Af).second;if(!isNaN(AY)&&AY>=0&&AY<=2){this.updateItem(V.ROW_HEADER_TEXT_ALIGNMENT_VERTICAL,AY);this.updateItem(V.ROW_VAVLUE_TEXT_ALIGNMENT_VERTICAL,AY);}}break;case q.MAX_SIZE_TYPE:AS.maxSizeType=AA[Af]||l.AUTO;break;case q.MAX_SIZE_VALUE:AY=parseFloat(Af);AS.maxSizeValue=isNaN(AY)?0.9:AY;break;case q.MIN_SIZE_TYPE:AS.minSizeType=x[Af]||(mstrApp.getThemeProps("THEME_STYLE")===H.DEFAULT?h.AUTO:h.PROPORTIONAL);break;case q.MIN_SIZE_VALUE:AY=parseFloat(Af);AS.minSizeValue=isNaN(AY)?0.2:AY;break;case q.OUTSIDE_BORDER:AS.outBorder=Af!=="Hide";break;case q.AXES:if(Af!==undefined){AS.axes=o[Af]||AF.SHOW_BOTH;if(AS.axes===AF.SHOW_BOTH){Ah=Ag=true;}else{if(AS.axes===AF.SHOW_X){Ah=true;Ag=false;}else{if(AS.axes===AF.SHOW_Y){Ah=false;Ag=true;}else{Ah=Ag=false;}}}this.updateItem(V.X_AXIS_LINE_SHOW,Ah);this.updateItem(V.Y_AXIS_LINE_SHOW,Ag);}break;case q.MATRIX_LINES:if(Af!==undefined){AS.matrixLine=U[Af]||AM.SHOW_ALL;if(AS.matrixLine===AM.SHOW_ALL){Ah=Ag=true;}else{if(AS.matrixLine===AM.SHOW_HORIZONTAL){Ah=false;Ag=true;}else{if(AS.matrixLine===AM.SHOW_VERTICAL){Ah=true;Ag=false;}else{Ah=Ag=false;}}}this.updateItem(V.V_MATRIX_LINES_SHOW,Ah);this.updateItem(V.H_MATRIX_LINES_SHOW,Ag);}break;case q.GRID_LINES:AS.gridLine=L[Af]||z.AUTO;break;case q.LEGEND_MODE:AS.legendMode=parseInt(Af,10);break;case q.LEGEND_POSITION:AU=parseInt(Af,10);if(AU===F.LEFT){AU=F.LEFT_MIDDLE;}else{if(AU===F.RIGHT){AU=F.RIGHT_MIDDLE;}}AS.legendSlot=AU||F.RIGHT_MIDDLE;break;case q.SCALE_LEGEND_WIDTH:AV.lgd=parseFloat(Af)||undefined;break;case q.SCALE_CHART_WIDTH:AV.ctw=parseFloat(Af)||1;break;case q.SCALE_CHART_HEIGHT:AV.cth=parseFloat(Af)||1;break;case q.SCALE_ROW_HEADERS:Aj.length=0;Ak=M(Af);AT=Ac.getRowTitleInfo(true);Ae=AT.items.length;for(Ai=0;Ai<Ae;Ai++){AZ=AT.items[Ai].id;if(Ak.hasOwnProperty(AZ)){AV.rh[Ai]=Ak[AZ]||1;}else{AV.rh[Ai]=1;}Aj.push(AZ);}break;case q.SCALE_COL_HEADERS:Ab.length=0;Al=M(Af);AW=Ac.getColTitleInfo(true);Ae=AW.items.length;for(Ai=0;Ai<Ae;Ai++){AZ=AW.items[Ai].id;if(Al.hasOwnProperty(AZ)){AV.ch[Ai]=Al[AZ]||1;}else{AV.ch[Ai]=1;}Ab.push(AZ);}break;case q.SCALE_Y:case q.SCALE_X:case q.SCALE_Y2:case q.SCALE_X2:if(Aa===q.SCALE_Y){AR=Ac.getYAxisInfo(undefined,undefined,true,false);AX="y";}else{if(Aa===q.SCALE_X){AR=Ac.getXAxisInfo(undefined,undefined,true,false);AX="x";}else{if(Aa===q.SCALE_Y2){AR=Ac.getYAxisInfo(undefined,undefined,false,false);AX="y2";}else{if(Aa===q.SCALE_X2){AR=Ac.getXAxisInfo(undefined,undefined,false,false);AX="x2";}}}}Ad=Z(Af);Ae=AR.ids.length;AZ="";for(Ai=0;Ai<Ae;Ai++){if(Ai!==0){AZ+=",";}AZ+=AR.ids[Ai];}this[AX+"Ids"]=AZ;AV[AX]=Ad[AZ]||1;break;}},readItem:function(AV,AR){var AS=this.generalProps,AY=this.scales,AU,AX;switch(AV){case q.FIT_TO:if(AY.ctw!==1||AY.cth!==1){AX=e.MANUAL;}else{AX=AS.fitTo;}break;case V.CONTAINER_FIT_MODE:AX=AS[V.CONTAINER_FIT_MODE];break;case q.AXIS_SCALE:AX=AS.axisScale;break;case q.SHAPE:AX=AS.shape;break;case q.SUB_TYPE:AX=AS.subtype;break;case q.DATA_LABEL:AX=AS.dataLabels;break;case q.DATA_LABELS_PLACEMENT:AX=AS.dataLabelPlacements;break;case q.BANDING:AX=AS.banding;break;case q.LEGEND_VISIBLE:AX=AS.legendShow;break;case q.COL_ALIGNMENT:AX=AS.colAlign;break;case q.ROW_ALIGNMENT:AX={};AX.h=AS.rowAlignH;AX.v=AS.rowAlignV;break;case q.MAX_SIZE_TYPE:AX=AS.maxSizeType;break;case q.MAX_SIZE_VALUE:AX=AS.maxSizeValue;break;case q.MIN_SIZE_TYPE:AX=AS.minSizeType;break;case q.MIN_SIZE_VALUE:AX=AS.minSizeValue;break;case q.OUTSIDE_BORDER:AX=AS.outBorder;break;case q.AXES:AX=AS.axes;break;case q.MATRIX_LINES:AX=AS.matrixLine;break;case q.GRID_LINES:AX=AS.gridLine;break;case q.LEGEND_MODE:AX=AS.legendMode;break;case q.LEGEND_POSITION:AX=AS.legendSlot;break;case q.SCALE_LEGEND_WIDTH:AX=AY.lgd;break;case q.SCALE_CHART_WIDTH:AX=AY.ctw;break;case q.SCALE_CHART_HEIGHT:AX=AY.cth;break;case q.SCALE_ROW_HEADERS:AX=AY.rh;break;case q.SCALE_COL_HEADERS:AX=AY.ch;break;case q.SCALE_Y:AX=AY.y;break;case q.SCALE_X:AX=AY.x;break;case q.SCALE_Y2:AX=AY.y2;break;case q.SCALE_X2:AX=AY.x2;break;case q.SCALE_ALL:AX=AY;break;default:AX=this.hGetPropValue(AV);break;}AU=AX;switch(AV){case V.LINE_MARKER_SHOW:case V.LEGEND_BORDER_SHOW:case V.X_AXIS_ORIGIN_LINE_SHOW:case V.Y_AXIS_ORIGIN_LINE_SHOW:case V.X_AXIS_LINE_SHOW:case V.X_AXIS_TITLE_SHOW:case V.X_AXIS_LABELS_SHOW:case V.Y_AXIS_LINE_SHOW:case V.Y_AXIS_TITLE_SHOW:case V.Y_AXIS_LABELS_SHOW:case V.V_MATRIX_LINES_SHOW:case V.H_MATRIX_LINES_SHOW:case V.ALL_ROW_COLUMN_SHOW:case V.COLUMN_HEADER_SHOW:case V.ROW_HEADER_SHOW:case V.COLUMN_VALUES_SHOW:case V.ROW_VALUES_SHOW:case V.GRID_LINE_AUTO:case q.SORT_ORDER:case V.TOTAL_SHOW:case V.INT_SUM_SHOW:case V.INT_SUM_FULL:case V.SHOW_MODEBAR:if(AU){AX=(AU==="true"||AU===true);}break;case V.MAJOR_GRID_LINES_SHOW:if(AU===undefined){AU=AS.gridLine;}AX=parseInt(AU,10);break;case V.MINOR_GRID_LINES_SHOW:if(AU===undefined){AU=AS.gridLine;if(AU===2){AU=z.HIDE;}}AX=parseInt(AU,10);break;case V.X_AXIS_LABELS_ROTATION:if(AU){AX=parseInt(AU,10);}break;case q.SORT_INDEX:if(AU){AX={};AX.row=r(AU).first;AX.col=r(AU).second;}break;case q.AXIS_SCALE_DATA:if(AU){AX=J.parseAxisScaleData(AU);}break;case q.METRIC_SHAPES:case q.METRIC_LEVEL_DATA_LABEL:case q.AXIS_ORIGIN:case q.LOG_SCALE:case q.TREND_LINE_DEF:case q.TREND_BUBBLE_FORE_DEF:case q.REF_LINE_DEF:case q.SELECTIONS:case q.FORMATS_ON_COMBINATION:case V.ALL_SHAPE_FORMAT:var AW=this.isItemCached;var AT=this.readItemCache;if(!AW[AV]){AT[AV]=J.stringToJSON(AX);AW[AV]=true;}AX=AT[AV];break;case q.SCALE_V_EXTRA_LINE:AX=parseFloat(AX)||1;break;case q.MAX_SIZE_VALUE:case q.MIN_SIZE_VALUE:if(AU){AX=parseFloat(AU);}break;case V.REF_LABELS_FONT_FAMILY:case V.REF_LABELS_FONT_SIZE:case V.REF_LABELS_FONT_STYLE:case V.REF_LABELS_FONT_COLOR:if(AU&&typeof AU==="string"&&AU.indexOf("{")>=0){AX=J.stringToJSON(AU);}break;case V.POINT_SIZE:case V.POINT_POS:case V.JITTER:case V.JTR_TYPE:case V.PTSZ_TYPE:case V.PTPOS_TYPE:if(AU){AX=parseFloat(AU);}break;case V.XBINS_START:case V.XBINS_END:case V.XBINS_SIZE:if(AU){AX=parseFloat(AU);}case V.POSITIVE_COLOR:case V.NEGATIVE_COLOR:case V.TOTAL_COLOR:case V.INT_SUM_COLOR:if(AX==="default"){AX=undefined;}default:break;}if(AX===undefined){if(!AR){AX=this.defaultsObj&&this.defaultsObj[AV];}}else{if(AV.slice(-3)==="Clr"&&typeof AX==="string"){if(AX!=="transparent"){if(isNaN(AX)){AX=J.stringToJSON(AX);}else{AX=parseInt(AX,10);}}}}if(typeof AX==="string"&&!isNaN(AX)){AX=parseInt(AX,10);}return AX;},clearReadItemCache:function(){this.isItemCached={};},updateItem:function(AT,AS){var AV=this.scales,AR=this.generalProps,AU=J.everythingToString(AS);this.clearReadItemCache();switch(AT){case q.FIT_TO:AS=AS===n.Manual?AR.fitTo:AS;AR.fitTo=AS;AU=AG[AS===n.Manual?AR.fitTo:AS];break;case q.AXIS_SCALE:AR.axisScale=AS;AU=m[AS];break;case q.SHAPE:AR.shape=AS;AU=b[AS];break;case q.SUB_TYPE:AR.subtype=AS;AU=S[AS];break;case q.DATA_LABEL:AR.dataLabels=AS;AU=Y[AS];break;case q.DATA_LABELS_PLACEMENT:AR.dataLabelPlacements=AS===true?1:2;AU=AK[AR.dataLabelPlacements];break;case q.BANDING:AR.banding=AS;break;case q.LEGEND_VISIBLE:AR.legendShow=AS;AU=AS?"Show":"Hide";break;case q.ROW_ALIGNMENT:AR.rowAlignH=AS.h;AR.rowAlignV=AS.v;AU=AS.h+","+AS.v;break;case q.COL_ALIGNMENT:AR.colAlign=AS;break;case q.MAX_SIZE_TYPE:AR.maxSizeType=AS;AU=AJ[AS];break;case q.MAX_SIZE_VALUE:AR.maxSizeValue=AS;break;case q.MIN_SIZE_TYPE:AR.minSizeType=AS;AU=AB[AS];break;case q.MIN_SIZE_VALUE:AR.minSizeValue=AS;break;case q.OUTSIDE_BORDER:AR.outBorder=AS;AU=AS?"Show":"Hide";break;case q.AXES:AR.axes=AS;AU=A[AS];break;case q.MATRIX_LINES:AR.matrixLine=AS;AU=AO[AS];break;case q.GRID_LINES:AR.gridLine=AS;AU=k[AS];break;case q.LEGEND_MODE:AR.legendMode=AS;break;case q.LEGEND_POSITION:AR.legendSlot=AS;break;case q.SCALE_LEGEND_WIDTH:AV.lgd=AS;break;case q.SCALE_CHART_WIDTH:AV.ctw=parseFloat(AS)||1;break;case q.SCALE_CHART_HEIGHT:AV.cth=parseFloat(AS)||1;break;case q.SCALE_ROW_HEADERS:AV.rh=AS;AU=E(this.rhIds,AV.rh);break;case q.SCALE_COL_HEADERS:AV.ch=AS;AU=E(this.chIds,AV.ch);break;case q.SCALE_Y:AV.y=AS;AU=this.yIds+":"+AV.y;break;case q.SCALE_X:AV.x=AS;AU=this.xIds+":"+AV.x;break;case q.SCALE_Y2:AV.y2=AS;AU=this.y2Ids+":"+AV.y2;break;case q.SCALE_X2:AV.x2=AS;AU=this.x2Ids+":"+AV.x2;break;case q.SORT_INDEX:AU=AS.row+","+AS.col;break;default:break;}this.hSetPropValue(AT,AU);},removeItem:function(AR){this.hRemoveProp(AR);},updateItems:function(AU,AR){var AS,AT=AU.length;for(AS=0;AS<AT;AS++){this.updateItem(AU[AS],AR[AS]);}},setController:function(AR){this.controller=AR;this.initItem(q.SCALE_ROW_HEADERS);this.initItem(q.SCALE_COL_HEADERS);this.initItem(q.SCALE_Y);this.initItem(q.SCALE_X);this.initItem(q.SCALE_Y2);this.initItem(q.SCALE_X2);},initHTML5Props:function(AT){var AY=this.readItem,Ag=AT.LEGEND={},Am=AT.BK={},Aj=AT.RH_BK={},Ad=AT.CH_BK={},Ab=AT.RH_TITLE={},AZ=AT.RH={},Ac=AT.CH_TITLE={},AV=AT.CH={},Af=AT.AXIS_LABEL_X={},Ae=AT.AXIS_LABEL_Y={},Al=AT.AXIS_TITLE_X={},Ak=AT.AXIS_TITLE_Y={},AW=AT.AXIS_LINE_X={},AU=AT.AXIS_LINE_Y={},Ai=AT.MATRIX_LINE_H={},AX=AT.MATRIX_LINE_V={},AS=AT.GRID_LINE_MAJOR={},Aa=AT.GRID_LINE_MINOR={},AR=AT.OUTSIDE_BORDER={},Ao=function(As,Ap,Aq){if(Ap===c.Gradient){Aq=J.decodeColor(Aq);var Ar=D.buildGradient(Aq.or,Aq.c1,Aq.c2);if(Ar){As[Ar.n]=Ar.v;}}else{As.backgroundColor=J.decodeColor(Aq);}},An=function(Aq,Ap){Aq.fontWeight=(Ap&G.FS_BOLD?"bold":"normal");Aq.fontStyle=(Ap&G.FS_ITALIC?"italic":"normal");if((Ap&G.FS_STRIKETHROUGH)&&(Ap&G.FS_UNDERLINE)){Aq.textDecoration="line-through underline";}else{if(Ap&G.FS_STRIKETHROUGH){Aq.textDecoration="line-through";}else{if(Ap&G.FS_UNDERLINE){Aq.textDecoration="underline";}else{Aq.textDecoration="none";}}}},Ah=function(Ap){var Aq=["solid","dashed","dotted"];return Aq[Ap]||"none";};Ag.fontFamily=AY.call(this,V.LEGEND_FONT_FAMILY);Ag.fontSize=AY.call(this,V.LEGEND_FONT_SIZE);An(Ag,AY.call(this,V.LEGEND_FONT_STYLE));Ag.color=J.decodeColor(AY.call(this,V.LEGEND_FONT_COLOR));Ao(Ag,AY.call(this,V.LEGEND_BG_FILL_STYLE),AY.call(this,V.LEGEND_BG_COLOR));Ag.opacity=AY.call(this,V.LEGEND_BG_FILL_TRANSPARENCY)/100;if(AY.call(this,V.LEGEND_BORDER_SHOW)){Ag.borderWidth=parseInt(AY.call(this,V.LEGEND_BORDER_THICKNESS),10)+"px";Ag.borderStyle=Ah(AY.call(this,V.LEGEND_BORDER_LINE_STYLE));Ag.borderColor=J.decodeColor(AY.call(this,V.LEGEND_BORDER_COLOR));}Ao(Am,AY.call(this,V.BG_FILL_STYLE),AY.call(this,V.BG_COLOR));Am.opacity=AY.call(this,V.BG_FILL_TRANSPARENCY)/100;Ao(Aj,AY.call(this,V.ROW_HEADER_FILL_STYLE),AY.call(this,V.ROW_HEADER_FILL_COLOR));Aj.opacity=AY.call(this,V.ROW_HEADER_FILL_TRANSPARENCY)/100;Ao(Ad,AY.call(this,V.COLUMN_HEADER_FILL_STYLE),AY.call(this,V.COLUMN_HEADER_FILL_COLOR));Ad.opacity=AY.call(this,V.COLUMN_HEADER_FILL_TRANSPARENCY)/100;Ab.fontFamily=AY.call(this,V.ROW_HEADER_TEXT_FONT_FAMILY);Ab.fontSize=AY.call(this,V.ROW_HEADER_TEXT_FONT_SIZE);An(Ab,AY.call(this,V.ROW_HEADER_TEXT_FONT_STYLE));Ab.color=J.decodeColor(AY.call(this,V.ROW_HEADER_TEXT_FONT_COLOR));Ac.fontFamily=AY.call(this,V.COLUMN_HEADER_TEXT_FONT_FAMILY);Ac.fontSize=AY.call(this,V.COLUMN_HEADER_TEXT_FONT_SIZE);An(Ac,AY.call(this,V.COLUMN_HEADER_TEXT_FONT_STYLE));Ac.color=J.decodeColor(AY.call(this,V.COLUMN_HEADER_TEXT_FONT_COLOR));AZ.fontFamily=AY.call(this,V.ROW_VAVLUE_TEXT_FONT_FAMILY);AZ.fontSize=AY.call(this,V.ROW_VAVLUE_TEXT_FONT_SIZE);An(AZ,AY.call(this,V.ROW_VAVLUE_TEXT_FONT_STYLE));AZ.color=J.decodeColor(AY.call(this,V.ROW_VAVLUE_TEXT_FONT_COLOR));AV.fontFamily=AY.call(this,V.COLUMN_VAVLUE_TEXT_FONT_FAMILY);AV.fontSize=AY.call(this,V.COLUMN_VAVLUE_TEXT_FONT_SIZE);An(AV,AY.call(this,V.COLUMN_VAVLUE_TEXT_FONT_STYLE));AV.color=J.decodeColor(AY.call(this,V.COLUMN_VAVLUE_TEXT_FONT_COLOR));Ae.fontFamily=AY.call(this,V.Y_AXIS_LABELS_FONT_FAMILY);Ae.fontSize=AY.call(this,V.Y_AXIS_LABELS_FONT_SIZE);An(Ae,AY.call(this,V.Y_AXIS_LABELS_FONT_STYLE));Ae.color=J.decodeColor(AY.call(this,V.Y_AXIS_LABELS_FONT_COLOR));Af.fontFamily=AY.call(this,V.X_AXIS_LABELS_FONT_FAMILY);Af.fontSize=AY.call(this,V.X_AXIS_LABELS_FONT_SIZE);An(Af,AY.call(this,V.X_AXIS_LABELS_FONT_STYLE));Af.color=J.decodeColor(AY.call(this,V.X_AXIS_LABELS_FONT_COLOR));Ak.fontFamily=AY.call(this,V.Y_AXIS_TITLE_FONT_FAMILY);Ak.fontSize=AY.call(this,V.Y_AXIS_TITLE_FONT_SIZE);An(Ak,AY.call(this,V.Y_AXIS_TITLE_FONT_STYLE));Ak.color=J.decodeColor(AY.call(this,V.Y_AXIS_TITLE_FONT_COLOR));Al.fontFamily=AY.call(this,V.X_AXIS_TITLE_FONT_FAMILY);Al.fontSize=AY.call(this,V.X_AXIS_TITLE_FONT_SIZE);An(Al,AY.call(this,V.X_AXIS_TITLE_FONT_STYLE));Al.color=J.decodeColor(AY.call(this,V.X_AXIS_TITLE_FONT_COLOR));AW.borderWidth=parseInt(AY.call(this,V.X_AXIS_LINE_THICKNESS),10)+"px";AW.borderColor=J.decodeColor(AY.call(this,V.X_AXIS_LINE_COLOR));AW.borderTopStyle=Ah(AY.call(this,V.X_AXIS_LINE_STYLE));AU.borderWidth=parseInt(AY.call(this,V.Y_AXIS_LINE_THICKNESS),10)+"px";AU.borderColor=J.decodeColor(AY.call(this,V.Y_AXIS_LINE_COLOR));AU.borderLeftStyle=Ah(AY.call(this,V.Y_AXIS_LINE_STYLE));Ai.borderWidth=parseInt(AY.call(this,V.H_MATRIX_LINES_THICKNESS),10)+"px";Ai.borderColor=J.decodeColor(AY.call(this,V.H_MATRIX_LINES_COLOR));Ai.borderTopStyle=Ah(AY.call(this,V.H_MATRIX_LINES_STYLE));AX.borderWidth=parseInt(AY.call(this,V.V_MATRIX_LINES_THICKNESS),10)+"px";AX.borderColor=J.decodeColor(AY.call(this,V.V_MATRIX_LINES_COLOR));AX.borderLeftStyle=Ah(AY.call(this,V.V_MATRIX_LINES_STYLE));AS.borderWidth=parseInt(AY.call(this,V.MAJOR_GRID_LINES_THICKNESS),10)+"px";AS.borderColor=J.decodeColor(AY.call(this,V.MAJOR_GRID_LINES_COLOR));AS.borderTopStyle=Ah(AY.call(this,V.MAJOR_GRID_LINES_STYLE));AS.borderLeftStyle=AS.borderTopStyle;Aa.borderWidth=parseInt(AY.call(this,V.MINER_GRID_LINES_THICKNESS),10)+"px";Aa.borderColor=J.decodeColor(AY.call(this,V.MINER_GRID_LINES_COLOR));Aa.borderTopStyle=Ah(AY.call(this,V.MINER_GRID_LINES_STYLE));Aa.borderLeftStyle=Aa.borderTopStyle;AR.borderWidth=parseInt(AY.call(this,V.OUTSIDE_BORDER_THICKNESS),10)+"px";AR.borderColor=J.decodeColor(AY.call(this,V.OUTSIDE_BORDER_COLOR));AR.borderLeftStyle=Ah(AY.call(this,V.OUTSIDE_BORDER_STYLE));AR.borderTopStyle=Ah(AY.call(this,V.OUTSIDE_BORDER_STYLE));},readItemDefault:function(AW,AU){var AV,AS={CIRCLE:0.7,Bar:0.7,AREA:0.7,PIE:0.8,RING:0.8},AT={CIRCLE:2,Bar:1,AREA:2,PIE:1,RING:1},AR={1:AP.Stacked,2:AP.Automatic,0:AP.Automatic};switch(AW){case V.X_AXIS_TITLE_SHOW:case V.Y_AXIS_TITLE_SHOW:AV=AU.isMetric?true:false;break;case V.SHAPE_FILL_TRANSPARENCY:AV=AS[AU.shapeType];break;case V.SHAPE_BORDER_THICKNESS:AV=AT[AU.shapeType];break;case q.SUB_TYPE:AV=AR[AU.shapeType];break;}return AV;},consumeJsonFmt:function(AS){var AU,AT=[],AR=[];for(AU in AS){if(AS.hasOwnProperty(AU)){AT.push(AU);AS[AU]=a(AU,AS[AU],this.templateObjectMapping);AR.push(AS[AU]);}}this.xmlData=this.makeDefaultPropXML(AT,AR);this.jsonData=AS;},hSyncWithJson:function(AT,AS,AU){var AR=this.jsonData;if(AR){if(AU){delete AR[AT];}else{AR[AT]=AS;}}},hGetPropValue:function(AV){var AU,AS=this.jsonData,AT;if(AS){return AS[AV];}else{AU=AI.call(this);if(AU){var AR=AU.getElementsByTagName("fmt")[0],AW=AR.getElementsByTagName(AV)[0];if(AW){AT=AW.getAttribute("value");return a(AV,AT,this.templateObjectMapping);}}}return undefined;},hRemoveProp:function(AT){this.hSyncWithJson(AT,"",true);var AS=AI.call(this),AR=AS.getElementsByTagName("fmt")[0],AU=AR.getElementsByTagName(AT)[0];if(AU){AU.parentNode.removeChild(AU);this.xmlData=P(AS);this.xmlDirty=true;}return this.xmlData;},hSetPropValue:function(AU,AT){if(typeof AT==="undefined"){return this.hRemoveProp(AU);}if((typeof AT)!=="string"){AT=AT.toString();}this.hSyncWithJson(AU,AT);var AS=AI.call(this),AR=AS.getElementsByTagName("fmt")[0],AV=AR.getElementsByTagName(AU)[0];if(!AV){AV=AS.createElement(AU);AR.appendChild(AV);}AV.setAttribute("value",f(AU,AT,this.templateObjectMapping));this.xmlData=P(AS);this.xmlDirty=true;return this.xmlData;},hSetPropValues:function(AY,AX){var AV,AU,AR,AW,AS=AY.length,AZ=AI.call(this),AT=AZ.getElementsByTagName("fmt")[0];for(AV=0;AV<AS;AV++){AR=AY[AV];AW=AX[AV];this.hSyncWithJson(AR,AW);AU=AT.getElementsByTagName(AR)[0];if(!AU){AU=AZ.createElement(AR);AT.appendChild(AU);}AU.setAttribute("value",f(AR,AW,this.templateObjectMapping));}this.xmlData=P(AZ);this.xmlDirty=true;return this.xmlData;},clearCachedXMLDoc:function(){if(this.xmlDoc){delete this.xmlDoc;}},setTemplateObjectMapping:function(AR){this.templateObjectMapping=AR;},makeDefaultPropXML:function d(AX,AY){var AU,AT,AR=AX.length,AW=new window.DOMParser(),AV="<props><widgetProps><fmt></fmt></widgetProps></props>",AZ=AW.parseFromString(AV,"text/xml"),AS=AZ.getElementsByTagName("fmt")[0];for(AU=0;AU<AR;AU++){AT=AZ.createElement(AX[AU]);AT.setAttribute("value",f(AX[AU],AY[AU],this.templateObjectMapping));AS.appendChild(AT);}return P(AZ);}});mstrmojo.gm.GMProperty.getUnderlyingPropertyNameWithAll=function(AR){return(R[AR]||AR).split(":");};}());(function(){mstrmojo.requiresCls("mstrmojo.vi.models.editors.BaseEditorModel","mstrmojo.ui.editors.controls.CharacterGroup","mstrmojo.ui.editors.controls.ContainerGroup","mstrmojo.ui.editors.controls.XtabResizeGroup","mstrmojo.ui.editors.CharacterToolbarPopup","mstrmojo.vi.enums.EnumThemeProperties","mstrmojo.Label","mstrmojo.hash","mstrmojo.array","mstrmojo.VisUtility","mstrmojo.color","mstrmojo.models.FormatModel","mstrmojo.models.template.DataInterface");mstrmojo.requiresDescs(15191,15192,15193,15230,15231,15232,15792);var A=2,H=3,J=4,u=5,D=5000;var AF=mstrmojo.ui.editors.controls.ContainerGroup.CTRL_FLAGS,j=mstrmojo.models.FormatModel.ENUM_PROPERTY_NAMES,r=mstrmojo.models.FormatModel.getFormatUpdate,P=mstrmojo.hash,Z=mstrmojo.array,AA=mstrmojo.VisUtility;var c={};c[A]="ch";c[H]="rh";c[J]="va";var B="st";var d={};d[H]="SUBTOTAL_FORMAT_USE_ROWHEADERS";d[A]="SUBTOTAL_FORMAT_USE_COLUMNHEADERS";d[J]="SUBTOTAL_FORMAT_USE_VALUES";var I={left:2,center:3,right:4,justify:6};function a(AG){return Object.keys(AG).length===0;}function b(){var AG=this.getHost().gridData,AH=AG&&AG.gsi;return(AH&&AH.fmts)||{};}function S(){var AI=this.getHost(),AG=AI.gridInfo&&AI.gridInfo.prop&&AI.gridInfo.prop.sb,AH=function(AJ){AI.showBanding(AJ);};return this.getCheckboxAndLabel(!!AG,mstrmojo.desc(15758,"Enable Banding"),AH);}var AB=function AB(){var AG=this.getHost();AG.showOutlineModeOption(true);};function z(){var AL=this.getHost(),AI=AL.gridData,AK=this,AG=AI.olm&&!(AI.rw&&AI.rw.row.bc>0),AJ=function AJ(AM){var AN=parseInt(AL.rhsCP&&AL.rhsCP.rc||0,10);if(AM&&AN&&AN>mstrmojo.vi.models.editors.XtabEditorModel.ENUM_MAX_ROWS_OUTLINE){var AP=function AP(AQ){AQ.checked=false;};var AO=this;mstrmojo.confirm(mstrmojo.desc(15792,"The dossier will attempt to display more than 5000 rows in outline mode. This may affect performance and stability. Do you want to continue?"),null,{id:"OutlineModeWarningDialog",title:mstrmojo.desc(15759,"Enable Outline"),allowHTML:false,buttons:[mstrmojo.Button.newWebButton(mstrmojo.desc(212,"Continue"),AB.bind(AK)),mstrmojo.Button.newWebButton(mstrmojo.desc(3416,"Cancel"),AP(AO))],onPreClose:function(){AP();return true;}});}else{AL.showOutlineModeOption(AM);}},AH=this.getCheckboxAndLabel(!!AG,mstrmojo.desc(15759,"Enable Outline"),AJ);if(mstrApp.isAppStatePause&&mstrApp.isAppStatePause()||AL.model.hasRecursiveAttribute(AI)){AH.set("enabled",false);}return AH;}function AE(AG,AH){return this.getButtonBar([{n:mstrmojo.desc(7575,"Top"),v:1,css:"top"},{n:mstrmojo.desc(8631,"Middle"),v:2,css:"middle"},{n:mstrmojo.desc(7576,"Bottom"),v:3,css:"bottom"}],AG[j.VERTICAL_ALIGN]-1,function(AI,AJ){AH(AI.v,AJ&&AJ.v);},{cssClass:"cellAlign"});}function q(AG,AH){return this.getTextAlign(P.keyarray(I).filter(function(AI){return AG[j.TEXT_ALIGN]===I[AI];})[0],AH,I);}function W(AJ,AG){var AH=b.call(this),AK=c[AJ];if(!AG){return AH[AK];}var AI=AH[B]||{};return AI[AK]||AH[AK];}function k(AI,AG){var AJ=this.getHost(),AH=AJ.getSubtotalFormatUseGridFormat(AI);return function(AK,AL){if(!AG||(AG&&!AH)){AJ.formatGridZone(c[AI],r(AK,AL),{isSubtotalFormat:AG,isSubtotalUseGridFormatting:AH});}else{AJ.UpdatePropAndformatGridZone(AI,r(AK,AL),{isSubtotalFormat:AG,isSubtotalUseGridFormatting:AH});}};}function U(AJ,AH){var AG=W.call(this,AJ,AH),AK=k.call(this,AJ,AH),AI=function(AL){return function(AM){AK(AL,AM);};};return[this.getCharacterGroup(AK,AG),q.call(this,AG,AI(j.TEXT_ALIGN)),AE.call(this,AG,AI(j.VERTICAL_ALIGN)),this.getContainerGroup(AG,AK,AF.FILL_COLOR,{showBackgroundNoFill:AJ===J}),this.getContainerGroup(AG,AK,AF.BORDER,{borderTitle:mstrmojo.desc(12130,"Horizontal lines"),targetBorder:"bottom"}),this.getContainerGroup(AG,AK,AF.BORDER,{borderTitle:mstrmojo.desc(12131,"Vertical lines"),targetBorder:"right"}),this.getWrapText(!!AG[j.TEXT_WRAP],AI(j.TEXT_WRAP))];}function E(AH){var AL={};AL[A]=mstrmojo.desc(15232,"Same as Column Headers");AL[H]=mstrmojo.desc(15231,"Same as Row Headers");AL[J]=mstrmojo.desc(15230,"Same as Values");var AM=this.getHost(),AJ=AM.getSubtotalFormatUseGridFormat(AH),AK=AM.hasSubtotal(AH),AI=function(AN){AM.applyGridCellFormatForSubtotalChange(AN,AH);},AG=[];AG.push(this.getCheckboxAndLabel(AJ,AL[AH],AI));if(!AJ&&AK){return AG.concat(U.call(this,AH,true));}return AG;}function L(AI){var AL={};AL[A]=mstrmojo.desc(15191,"Subtotal Column Headers");AL[H]=mstrmojo.desc(15192,"Subtotal Row Headers");AL[J]=mstrmojo.desc(15193,"Subtotal Values");var AG=[this.getGroupTitle(AL[AI])].concat(E.call(this,AI)),AH=AG.slice(),AK=this.getHost(),AJ=AK.hasSubtotal(AI);if(!AJ){AA.toggleControlEnabled(AH,false);}return AG;}function Q(AG,AH){this.replaceChildControls(AG,[this.getEditorGroup(U.call(this,AH)),this.getEditorGroup(L.call(this,AH))]);}var G="#fff";function AC(AH){var AK=AH?AH.c1||AH:"",AJ=mstrmojo.color.getLuminance(AK),AG=255,AL=121.71921,AI=Math.max(AG/AJ,AJ/AG),AN=Math.max(AL/AJ,AJ/AL),AM="#35383a";if(AI>=AN){return G;}return AM;}var x={FMT_GROUP_GRID_COLOR:{type:[c[A],"st.ch"],props:[j.BACKGROUND_COLOR,j.BORDER_BOTTOM_COLOR,j.BORDER_BOTTOM_COLOR]},FMT_GROUP_GRID_STYLE:{type:[c[A],c[H],c[J],"st.ch","st.rh","st.va"],props:[j.BORDER_BOTTOM_STYLE,j.BORDER_RIGHT_STYLE]}};var O={GRAY:mstrmojo.desc(null,"Gray"),BLUE:mstrmojo.desc(null,"Blue"),NAVY:mstrmojo.desc(null,"Navy Blue"),EMERALD:mstrmojo.desc(null,"Emerald"),ORANGE:mstrmojo.desc(null,"Orange")},g={GRAY:"gray",BLUE:"blue",NAVY:"navy",EMERALD:"emerald",ORANGE:"orange"},X={FLAT:mstrmojo.desc(7805,"Flat"),CLASSIC:mstrmojo.desc(125,"Classic"),CUSTOM:"Custom"},C={FLAT:"flat",CLASSIC:"classic",CUSTOM:"custom"};var AD={},n=AC(G);AD[C.FLAT]=[{n:O.GRAY,css:g.GRAY,iconBc:"#d1d1d1",fc:n,bc:G,bbc:"#ababab",brc:"#ebebeb",stbc:"#f8f8f8"},{n:O.BLUE,css:g.BLUE,iconBc:"#1c8dd4",fc:n,bc:G,bbc:"#1c8dd4",brc:"#ebebeb",stbc:"#f1f9f2"},{n:O.NAVY,css:g.NAVY,iconBc:"#193b67",fc:n,bc:G,bbc:"#193b67",brc:"#ebebeb",stbc:"#f2f4f6"},{n:O.EMERALD,css:g.EMERALD,iconBc:"#38ae6f",fc:n,bc:G,bbc:"#38ae6f",brc:"#ebebeb",stbc:"#f4fbf6"},{n:O.ORANGE,css:g.ORANGE,iconBc:"#e69912",fc:n,bc:G,bbc:"#e69912",brc:"#ebebeb",stbc:"#fef8f1"}];AD[C.CLASSIC]=[{n:O.GRAY,css:g.GRAY,iconBc:"#d1d1d1",bc:"#f5f5f5",bbc:"#ebebeb",brc:"#ebebeb",fc:AC("#f5f5f5"),stbc:"#f8f8f8"},{n:O.BLUE,css:g.BLUE,iconBc:"#1c8dd4",bc:"#1c8dd4",bbc:"#187ab8",brc:"#187ab8",fc:AC("#1c8dd4"),stbc:"#f1f9fe"},{n:O.NAVY,css:g.NAVY,iconBc:"#193b67",bc:"#193b67",bbc:"#50698b",brc:"#50698b",fc:AC("#193b67"),stbc:"#f2f4f6"},{n:O.EMERALD,css:g.EMERALD,iconBc:"#38ae6f",bc:"#38ae6f",fc:AC("#38ae6f"),bbc:"#29965d",brc:"#29965d",stbc:"#f4fbf6"},{n:O.ORANGE,css:g.ORANGE,iconBc:"#e69912",bc:"#e69912",fc:AC("#e69912"),bbc:"#ca850a",brc:"#ca850a",stbc:"#fef8f1"}];var w={rh:{bc:"#fff",bbc:"#ebebeb",brc:"#ebebeb"},va:{bc:"#fff",bbc:"#ebebeb",brc:"#ebebeb"},st:{rh:{bc:"#f8f8f8",bbc:"#ebebeb",brc:"#ebebeb"},va:{bc:"#f8f8f8",bbc:"#ebebeb",brc:"#ebebeb"}}};var p={};function N(AG){if(!p[AG]){p[AG]=mstrmojo.color.encodeColor(AG);}return p[AG];}function R(AH,AG){return(AH.substring&&AH.substring(0,1)==="#")?N(AH)===N(AG):AH===AG;}function o(AH,AI){var AG=true;P.forEach(AH,function(AK,AJ){if(AI[AJ]===undefined){AG=false;}else{if(typeof AI[AJ]==="object"){if(a(AI[AJ])){AG=true;}else{AG=o(AK,AI[AJ]);}}else{AG=R(AI[AJ],AK);}}if(!AG){return false;}});return AG;}function f(AI,AH){var AL=-1,AG=AL,AK=x.FMT_GROUP_GRID_COLOR.type,AJ=x.FMT_GROUP_GRID_COLOR.props;if(!o(w,AI)){return AG;}Z.forEach(AH,function(AN,AM){AG=AM;Z.forEach(AK,function(AP){var AO=P.walk(AP,AI);Z.forEach(AJ,function(AQ){if(!R(AO[AQ],AN[AQ])){AG=AL;return false;}});if(AG===AL){return false;}});if(AG!==AL){return false;}});return AG;}var M=[],F={};F[C.FLAT]=0;F[C.CLASSIC]=1;F[C.CUSTOM]=-1;var V="1pt solid",h="none";M[F[C.FLAT]]={id:C.FLAT,n:X.FLAT,css:C.FLAT,brs:h,bbs:V};M[F[C.CLASSIC]]={id:C.CLASSIC,n:X.CLASSIC,css:C.CLASSIC,brs:V,bbs:V};function K(AG){var AH=x.FMT_GROUP_GRID_STYLE,AK=AH.props,AI=AH.type,AJ=null,AL=function(AM){if(AM===V){return 1;}else{if(AM===h){return 0;}}return -1;};Z.forEach(M,function(AM){AJ=AM.id;Z.forEach(AI,function(AO){var AN=P.walk(AO,AG);if(a(AN)){return true;}Z.forEach(AK,function(AP){if(AN[AP]!==AL(AM[AP])){AJ=null;return false;}});if(!AJ){return false;}});if(AJ){return false;}});return AJ||C.CUSTOM;}function e(AG,AH){var AI=[c[A],"st.ch"],AK=j.BACKGROUND_COLOR,AJ;return AI.every(function(AL){AJ=P.walk(AL,AG)[AK];return AJ&&R(AJ,AH);});}function Y(){var AO=this,AV=this.getHost(),AQ=AV.gridData,AR=AQ&&AQ.gsi&&AQ.gsi.fmts,AJ=e(AR,G),AN=K(AR),AK=AN===C.CUSTOM?(AJ?C.FLAT:C.CLASSIC):AN,AU=AD[AK],AM=f(AR,AU),AG=AM<0?AU[0].css:AU[AM].css,AT=AO.getLabelAndControl(mstrmojo.desc(6242,"Color"),new mstrmojo.ui.CheckList({items:AU,selectedIndex:AM,hideCheckMark:true,cssClass:"color",orientation:"h",multiSelect:false,itemMarkup:null,postselectionChange:function AL(AX){var AY=AX.added[0],AW=this.items[AY];AV.formatGridColor(w,AW);},getItemMarkup:function AS(AW){if(!this.itemMarkup){this.itemMarkup=mstrmojo.ui.List.prototype.getItemMarkup.apply(this,AW).replace('title="{@title}">{@en@n}<','title="{@en@n}"><div class="color" style="background-color: {@en@iconBc}"></div><');}return this.itemMarkup;},getItemProps:function AP(AY,AW){var AX=mstrmojo.ui.CheckList.prototype.getItemProps.call(this,AY,AW);AX.iconBc=AY.iconBc;return AX;}}),"30%","70%",false,{cssClass:"gt-color",showIcon:true,alias:"gtColor"}),AH=AO.getLabelAndControl(mstrmojo.desc(1400,"Style"),new mstrmojo.ui.CheckList({items:M,selectedIndex:F[AN],cssClass:"style",orientation:"v",multiSelect:false,postselectionChange:function AL(AX){var AZ=AX.added[0],AW=this.items[AZ],AY=(AM)>-1?AD[AW.id][AM]:null;AV.formatGridStyle(AW,AY,w);}}),"30%","70%",false,{cssClass:"gt-style",showIcon:true,alias:"gtStyle"}),AI=new mstrmojo.Box({alias:"gt",cssClass:"gt "+AG,children:[AT,AH]});return AI;}function m(AQ){var AW=this.getHost(),AS=AW.gridData,AK=new mstrmojo.models.template.DataInterface(AS);var AG=new mstrmojo.ui.editors.controls.XtabResizeGroup({});AG.setFormatSource(AW);AW.attachEventListener("xtabColsMeasured",AG.id,function(){AG.setFormatSource(AW);});var AO=AK.getAggregatePadding(),AM=mstrApp.getThemeProps(mstrmojo.vi.enums.EnumThemeProperties.SUBTYPE.GRID),AL=AM.paddingSize,AT=0,AI=[AL,AL],AR=AL,AP=false;if(AO){AI=[AO.h,AO.v].sort(function(AZ,AY){return AZ-AY;});AR=AI[1];AT=Math.max(Math.min(Math.round((AR-AL)/AL),2),0);AP=true;}var AU=this.getLabelAndControl(mstrmojo.desc(13579,"Padding"),this.getButtonBar([{n:mstrmojo.desc(12141,"S"),v:AL,css:"small"},{n:mstrmojo.desc(12142,"M"),v:AL*AM.mRatio,css:"medium"},{n:mstrmojo.desc(12140,"L"),v:AL*AM.lRatio,css:"large"}],AT,function(AY){AW.formatPadding(AY.v,AY.v*(AI[0]/AR),{isSubtotalUseGridFormatting:true});},{cssClass:"cellPadding",showIcon:false}));AU.set("enabled",AP);var AV=this,AH=function(AY,AZ){AW.batchFormatGridZones([A,H,J].map(function(Aa){return c[Aa];}),Z.isArray(AZ)?AZ.map(function(Aa){return r(AY,Aa);}):[A,H,J].map(function(){return r(AY,AZ);}),{isSubtotalUseGridFormatting:true});},AJ=function(){var Aa=null,AY=b.call(AV),AZ=AY[B];[A,H,J].forEach(function(Ab){[AY,AZ].forEach(function(Aj){var Ai=Aj&&Aj[c[Ab]]||{},Ak=j.FONT_SIZE,Ac=j.FONT_FAMILY,Ag=j.COLOR,Ad=j.FONT_WEIGHT,Af=j.UNDERLINE,Ae=j.FONT_STYLE,Ah=j.LINE_THROUGH;if(a(Ai)){return ;}if(!Aa){Aa=P.copy(Ai);Aa[Ak]=Z.ensureArray(Aa[Ak]);}else{Aa[Ak].push(Ai[Ak]);if(Aa[Ac]!==Ai[Ac]){Aa[Ac]=-1;}if(Aa[Ag]!==Ai[Ag]){delete Aa[Ag];}[Ad,Af,Ae,Ah].forEach(function(Al){Aa[Al]=Aa[Al]||Ai[Al];});}});});return Aa;},AX=[],AN=[this.getEditorGroup([]),this.getEditorGroup([S.call(this),z.call(this)]),AM.gridTemplateVisible?this.getEditorGroup([this.getGroupTitle(mstrmojo.desc(16044,"Grid Template")),Y.call(this)]):null,this.getEditorGroup([this.getGroupTitle(mstrmojo.desc(14006,"All Grid Fonts")),this.getCharacterGroup(AH,AJ(),23),this.getGroupTitle(mstrmojo.desc(12129,"Grid Size")),AU,AG]),this.getEditorGroup([this.getMoreOptionsEditorLink(AS&&AS.gsi&&AS.gsi.prop,true,AS&&AS.lhv)])];AX=AX.concat(AN);this.replaceChildControls(AQ,AX);}mstrmojo.vi.models.editors.XtabEditorModel=mstrmojo.declare(mstrmojo.vi.models.editors.BaseEditorModel,null,{scriptClass:"mstrmojo.vi.models.editors.XtabEditorModel",help:"format_panel_grid.htm",getInitialTarget:function t(){return u;},getTargetPulldownItems:function l(AI){var AM=this.getHost(),AK=AM.gridInfo,AL=this._super(AI);if(AK&&(AK.rows.length||AK.cols.length)){var AG=AM.getFormats(),AH=Q.bind(this,AI);AL.unshift({n:mstrmojo.desc(6560,"General Settings"),v:u,h:m.bind(this,AI)});if(AG){var AJ=b.call(this);if(AJ){if(AJ.ch){AL.push({n:mstrmojo.desc(12132,"Column Headers"),v:A,h:AH});}if(AJ.rh){AL.push({n:mstrmojo.desc(12133,"Row Headers"),v:H,h:AH});}if(AJ.va){AL.push({n:mstrmojo.desc(12134,"Values"),v:J,h:AH});}}}}return AL;},getFormattingToolbar:function v(AG,AJ,AK){var AP=this.getHost(),AH=AP.model,AO=AP.getCellForNode(AJ),AN=(AG===J&&AH.isSubtotalValue(AO)),AI=(AO&&AO.stt===1)||AN,AL=W.call(this,AG,AI);if(AL){var AM=new mstrmojo.ui.editors.CharacterToolbarPopup(P.copy({onGroupValueChange:k.call(this,AG,AI),textAlignValueMap:I,anchorElement:AJ},AK));AM.setFormatSource(AL);return AM;}return this._super(AG,AJ,AK);}});mstrmojo.vi.models.editors.XtabEditorModel.ENUM_EDITOR_TARGETS={GENERAL:u,COLUMNS:A,ROWS:H,VALUES:J};mstrmojo.vi.models.editors.XtabEditorModel.ENUM_TARGET_FORMAT=c;mstrmojo.vi.models.editors.XtabEditorModel.ENUM_TARGET_SUBTOTAL_FORMAT_PROPNAME=d;mstrmojo.vi.models.editors.XtabEditorModel.ENUM_MAX_ROWS_OUTLINE=D;}());(function(){mstrmojo.requiresCls("mstrmojo.Label","mstrmojo.array","mstrmojo.hash","mstrmojo.color","mstrmojo.expr","mstrmojo.Button","mstrmojo.ui.Checkbox","mstrmojo.ui.Pulldown","mstrmojo.util.ui.ColorPicker","mstrmojo.ui.editors.controls.ColorPickerButton","mstrmojo.ui.editors.controls.ValidationTextBox","mstrmojo.kpicard.editors.KPICardThresholdHeaderControl","mstrmojo.models.FormatModel","mstrmojo.vi.models.editors.BaseEditorModel","mstrmojo.VisUtility","mstrmojo.kpicard.KPICardEnum","mstrmojo.string","mstrmojo._CanValidate","mstrmojo._FormatDefinition","mstrmojo.NumStepperContentProvider","mstrmojo.ui.editors.controls.Stepper","mstrmojo.VisEnum");var P=mstrmojo.hash,d=mstrmojo.array,g=mstrmojo.expr.DTP,l=mstrmojo.models.FormatModel,L=mstrmojo.ui.Pulldown,Q=mstrmojo.util.ui.ColorPicker,x=mstrmojo.string,a=mstrmojo.kpicard.DISPLAY_MODE,Y=mstrmojo.kpicard.BADGE_MODE,X=mstrmojo.kpicard.KPI_STYLES,S=mstrmojo.kpicard.KPI_PROPERTIES,K=mstrmojo.kpicard.DEFAULT_PROPS,j=mstrmojo.kpicard.TEXT_SIZE_TYPE,Z=mstrmojo.models.FormatModel.ENUM_PROPERTY_NAMES,f=mstrmojo.validation.STATUSCODE;var k=1,r="automatic",I=K.ibc,z=K.dbc;var E=[{n:mstrmojo.desc(959,"Default"),id:a.DEFAULT},{n:mstrmojo.desc(359,"Stacked"),id:a.STACKED},{n:mstrmojo.desc(12286,"Horizontal"),id:a.HORIZONTAL},{n:mstrmojo.desc(12285,"Vertical"),id:a.VERTICAL},{n:mstrmojo.desc(114,"Grid"),id:a.GRID}],u=[{n:mstrmojo.desc(2057,"None"),id:Y.NONE},{n:mstrmojo.desc(2053,"Percentage"),id:Y.PERCENTAGE},{n:mstrmojo.desc(527,"Value"),id:Y.VALUE}];function AA(AC){var AD=this.id;return function(AI){var AH=mstrmojo.all[AD];if(!AH){return ;}if(AC===S.DISPLAY_MODE){if(AH.warning){AH.warning=false;return ;}if(AI.id===a.STACKED){var AF=this,AG=AH.getHost(),AE=AG.getFormatPropertyValue(AC),AK=function(){mstrmojo.all[AD].onPropertiesChanged(AC,AI.id);},AJ=function(){AH.warning=true;AF.set("selectedIndex",parseInt(AE)-1);};AG.zonesModel.checkBreakByLimit(AK,AJ);return ;}}mstrmojo.all[AD].onPropertiesChanged(AC,AI.id);};}function b(){var AD=this.getHost(),AC=AD.getDefaultPrimaryValueColor();AD.addColorThreshold(AC);}function v(AD){var AC=this.getHost();AC.plusMinus=AD;this.setFontPropertyValue(this.selectedFontPart,S.UNIFY_STEPS,AD);}function F(AE,AD){var AC={};AC.scriptClass="mstrmojo.Button";AC.cssClass="mstrmojo-WebButton kpi-icon "+AD;AC.onclick=v.bind(AE,AD==="reset"?0:(AD==="plus"?1:-1));return AC;}mstrmojo.vi.models.editors.KPICardEditorModel=mstrmojo.declare(mstrmojo.vi.models.editors.BaseEditorModel,null,{scriptClass:"mstrmojo.vi.models.KPICardEditorModel",help:"format_panel_kpi.htm",warning:false,updateColorSub:null,init:function t(AC){if(this._super){this._super(AC);}var AD=this.getHost();if(AD&&AD.id&&AD.onBEMFormatChange){this.updateColorSub=this.attachEventListener("BEMFormatChange",AD.id,AD.onBEMFormatChange);}},destroy:function o(AC){if(this._super){this._super(AC);}var AD=this.updateColorSub;if(AD){this.detachEventListener(AD);this.updateColorSub=null;}},getInitialTarget:function p(){return k;},getTargetPulldownItems:function m(AD){var AG=this._super(AD),AF=this.getHost(),AE=this,AC=function(){var AH=AE.getKPISettingControls;AE.replaceChildControls(AD,AH.call(AE));};if(this.isNormalOrExcludeAllDataButNotInPauseMode(AF)){AG.unshift({n:mstrmojo.desc(6560,"General Settings"),v:k,h:AC});}return AG;},fnGetPulldown:function G(AK,AF,AE,AI,AM){var AH,AL;if(AK&&AK.length){AL=L.newPulldown(AK,AA.call(this,AI),AF,{isHostedWithin:false,getPopupListConfig:function AG(){var AN=mstrmojo.ui.Pulldown.prototype.getPopupListConfig.call(this);AN.getItemProps=function AO(AR,AP){var AQ=mstrmojo._IsList.getItemProps.call(this,AR,AP);AQ.style=AR.preview?"font-family:'"+x.encodeHtmlString(AR.n,true)+"';":"";return AQ;};return AN;}});if(AE!==undefined){var AC=AM||{};var AJ=AC.labelWidth||"50%";var AD=AC.pulldownWidth||"50%";AH=this.getLabelAndControl(AE,AL,AJ,AD);}else{AH=AL;}}return AH;},onPropertiesChanged:function e(AD,AE){var AC=this.getHost();AC.writeProperties(AD,AE);},getKPISettingControls:function O(){var AC=[],AE=this.getHost();if(AE.getUnitsByDropZoneID("BreakBy").length>0){AC.push(this.getDisplayModeCtrolGroup());}AC.push(this.getStyleControls());if(AE.getUnitsByDropZoneID("trend").length>0){AC.push(this.getBadgeControlGroup());}AC.push(this.getThresholdControlGroup());var AD=[this.getEditorGroup([this.getEditorGroup(AC)],{showDivider:true,isNested:true,isContainer:true}),this.getEditorGroup([this.getMoreOptionsEditorLink((AE.modelData&&AE.modelData.gsi&&AE.modelData.gsi.prop)||{})])];return AD;},getShowMetricNameCheckbox:function N(){var AF=this,AE=this.getHost(),AH=AE.getFormatPropertyValue(S.SHOW_METRIC_NAME),AD=new mstrmojo.ui.Checkbox({checked:AH==="true",oncheckedChange:function AI(AJ){AF.onPropertiesChanged(S.SHOW_METRIC_NAME,AJ.value.toString());}}),AG=this.getLabelAndControl(mstrmojo.desc(15915,"Show metric name"),AD,"14px","100%",true),AC=AG.getLabel();AC.onclick=function(){AD.onclick();};return AG;},getDisplayModeCtrolGroup:function B(){var AD=[],AE=this.getHost(),AC=AE.getFormatPropertyValue(S.DISPLAY_MODE);AD.push(this.getShowMetricNameCheckbox());AD.push(new mstrmojo.Label({text:mstrmojo.desc(4963,"Display Mode")}));AD.push(this.fnGetPulldown(E,this.getDisplayModeSelectedIndex(),undefined,S.DISPLAY_MODE));if(AC===a.STACKED){AD.push(this.getAutoPlayCheckbox());}else{if(AC===a.GRID){var AF=AE.getFormatPropertyValue(S.FIX_CARD_HEIGHT);AD.push(this.getGridColumnCountInputCtrl());AD.push(this.getFixCardHeightCheckbox());if(AF){AD.push(this.getFixedCardHeightInputCtrl());}}}return this.getEditorGroup(AD,{showDivider:true,isNested:true,isContainer:true});},getDisplayModeSelectedIndex:function C(){var AE=this.getHost(),AD=AE.getFormatPropertyValue(S.DISPLAY_MODE),AC=0;switch(AD){case a.DEFAULT:AC=0;break;case a.STACKED:AC=1;break;case a.HORIZONTAL:AC=2;break;case a.VERTICAL:AC=3;break;case a.GRID:AC=4;break;default:break;}return AC;},getFixCardHeightCheckbox:function J(){var AE=this.getHost(),AG=AE.getFormatPropertyValue(S.FIX_CARD_HEIGHT),AD=new mstrmojo.ui.Checkbox({checked:AG,oncheckedChange:function AH(AJ){var AK=AJ.value;var AM=[];if(AK){var AO=AE.getFormatPropertyValue(S.GRID_COLUMN_COUNT),AL=AE.singleKPIModels.length,AN=Math.ceil(AL/AO),AI=Math.floor(parseFloat(AE.height)/AN);AM.push({propertyName:S.CARD_HEIGHT,value:AI,oldValue:AE.getFormatPropertyValue(S.CARD_HEIGHT)});}AE.writeProperties(S.FIX_CARD_HEIGHT,AJ.value.toString(),AM);}}),AF=this.getLabelAndControl(mstrmojo.desc(16027,"Fix card height"),AD,"14px","100%",true),AC=AF.getLabel();AC.onclick=function(){AD.onclick();};return AF;},getNumericInputCommonProperty:function R(AC){return{cssClass:"kpi-cth-TextBox",errRevert:false,dtp:g.INTEGER,validationDelay:1500,updateText:function(AD){this.inputNode.value=AD;this.value=AD;},tooltipOpenDelay:0,useRichTooltip:true,updateTooltipConfig:function(){if(this.isValid()){this.richTooltip=null;return ;}this.richTooltip={posType:mstrmojo.tooltip.POS_TOPLEFT,cssClass:"vi-warning vi-tooltip-C triangle-warning",left:this.domNode.offsetWidth+10,top:-4,refNode:this.domNode,keepArrowYPos:true,content:this.getInvalidMsg(this.validationStatus)};if(this.tooltipTimeout){window.clearTimeout(this.tooltipTimeout);}this.tooltipTimeout=window.setTimeout(this.hideTooltip,1500);},onValid:AC};},getFixedCardHeightInputCtrl:function w(){var AF=this.getHost(),AH=1,AD=/[0-9]+/,AG=AF.getFormatPropertyValue(S.FIX_CARD_HEIGHT);var AE=this.getNumericInputCommonProperty(function(){AF.writeProperties(S.CARD_HEIGHT,this.value);});var AC=new mstrmojo.ui.editors.controls.ValidationTextBox(P.copy(AE,{constraints:{trigger:mstrmojo.validation.TRIGGER.ALL,min:AH,regExp:AD,invalidCssClass:"mstrmojo-TextBox-ErrValidation"},value:AF.getFormatPropertyValue(S.CARD_HEIGHT),getInvalidMsg:function(AI){if(AI.code===f.INVALID_OUTOFRANGE){return mstrmojo.desc(15876,"Value should be greater than ##").replace("##",this.constraints.min-1);}return mstrmojo.desc(11935,"Invalid characters");}}));return this.getLabelAndControl("px",AC,"90%","10%",true,{enabled:AG});},getGridColumnCountInputCtrl:function c(){var AF=this.getHost(),AG=1,AC=/[0-9]+/;var AE=this.getNumericInputCommonProperty(function(){AF.writeProperties(S.GRID_COLUMN_COUNT,this.value);});var AD=new mstrmojo.ui.editors.controls.ValidationTextBox(P.copy(AE,{constraints:{trigger:mstrmojo.validation.TRIGGER.ALL,min:AG,regExp:AC,invalidCssClass:"mstrmojo-TextBox-ErrValidation"},value:AF.getFormatPropertyValue(S.GRID_COLUMN_COUNT),getInvalidMsg:function(AH){if(AH.code===f.INVALID_OUTOFRANGE){return mstrmojo.desc(15876,"Value should be greater than ##").replace("##",this.constraints.min-1);}return mstrmojo.desc(11935,"Invalid characters");}}));return this.getLabelAndControl(mstrmojo.desc(6052,"Column"),AD,"50%","50%",undefined,{enabled:true});},getAutoPlayCheckbox:function H(){var AG=this,AF=this.getHost(),AE=AF.getFormatPropertyValue(S.AUTO_PLAY),AD=new mstrmojo.ui.Checkbox({checked:AE,oncheckedChange:function AI(AJ){AG.onPropertiesChanged(S.AUTO_PLAY,AJ.value);}}),AH=this.getLabelAndControl(mstrmojo.desc(15869,"Auto Play"),AD,"14px","100%",true),AC=AH.getLabel();AC.onclick=function(){AD.onclick();};return AH;},getStyleSelectedIndex:function W(){var AE=this.getHost(),AD=AE.getFormatPropertyValue(S.KPI_STYLE),AC=0;switch(AD){case X.LIGHT:AC=0;break;case X.NIGHT:AC=1;break;case X.DESERT:AC=2;break;case X.OCEAN:AC=3;break;default:break;}return AC;},getTextSizeController:function M(AD){var AF=this,AG,AC=F(AF,"reset"),AH=F(AF,"minus"),AE=F(AF,"plus");if(!AD){AC.cssClass+=" inactive";}AC.slot="col1Node";AH.slot="col2Node";AE.slot="col3Node";AG=new mstrmojo.ui.editors.controls.ThreeColumnContainer({col1Width:"33%",col2Width:"33%",col3Width:"33%",divider1Width:"18px",divider2Width:"18px",children:[AC,AH,AE],cssText:"padding-bottom: 6px"});return AG;},getFontControlGroup:function(){var AH=this;var AL=this.getHost();var AM=mstrmojo.kpicard.CAN_SET_FONT_PARTS;var AD="__all__";var AC=-1;var AG=function(AO){var AQ=function(AR,AU){var AT=AR[0][AU];var AS=AR.every(function(AV){return AV[AU]===AT;});return{equal:AS,value:AT};};var AN=function(AT){var AS=P.valarray(AT);var AU=P.keyarray(AS[0]);var AR={};return AU.reduce(function(AW,AY){var AV=AQ(AS,AY);if(AV.equal){AW[AY]=AV.value;return AW;}var AX;switch(AY){case l.ENUM_PROPERTY_NAMES.FONT_FAMILY:AX=AC;break;case l.ENUM_PROPERTY_NAMES.FONT_SIZE:AX=AC;break;case l.ENUM_PROPERTY_NAMES.COLOR:AX="";break;default:AX=false;}AW[AY]=AX;return AW;},AR);};var AP=AL.getFormatPropertyValue(S.NEW_FONT);if(AO===AD){return AN(AP);}return AP[AO];};var AJ=function(AP,AQ,AR){var AN=function(AV,AT,AS){var AU=AS;if(AT===S.UNIFY_STEPS){var AW=AL.getFormatPropertyValue(S.NEW_FONT);AU=AS===0?"0":(Number(AW[AV][AT])+AS).toString();}return{part:AV,propName:AT,propValue:AU};};var AO;if(AP===AD){AO=P.valarray(AM).map(function(AS){return AN(AS,AQ,AR);});}else{AO=[AN(AP,AQ,AR)];}return AH.onPropertiesChanged(S.NEW_FONT,AO);};var AI=function(){var AP=[{n:mstrmojo.desc(16296,"Unified"),id:j.UNIFIED},{n:mstrmojo.desc(12058,"Fit to container"),id:j.FIT_TO_CONTAINER},{n:mstrmojo.desc(4961,"Fixed"),id:j.FIXED},];if(AL.getFormatPropertyValue(S.DISPLAY_MODE)===a.STACKED){AP=d.filter(AP,function(AQ){return AQ.id!==j.UNIFIED;});}var AO=AL.getFormatPropertyValue(S.TEXT_SIZE_TYPE);var AN=d.find(AP,"id",AO);return AH.fnGetPulldown(AP,AN,mstrmojo.desc(16258,"Text Size"),S.TEXT_SIZE_TYPE,{labelWidth:"30%",pulldownWidth:"70%"});};var AF=function(){var AO=[{n:mstrmojo.desc(2461,"All"),id:AD},{n:mstrmojo.desc(8263,"Label"),id:AM.LABEL},{n:mstrmojo.desc(16260,"Primary Value"),id:AM.PRIMARY_VALUE},{n:mstrmojo.desc(16261,"Previous Value"),id:AM.PREVIOUS_VALUE},{n:mstrmojo.desc(16262,"Trend Identity"),id:AM.TREND_IDENTITY},];var AP=function(AQ,AS){var AR=0;d.forEach(AQ,function(AU,AT){if(AU.id===AS){AR=AT;return false;}});return AR;};var AN=function(AQ){AH.selectedFontPart=AQ.id;AH.getHost().zonesModel.getUpdateCallback().success();};return L.newPulldown(AO,AN,AP(AO,AH.selectedFontPart),{isHostedWithin:false});};var AE=function(){var AN=function(AW,AX){AJ(AH.selectedFontPart,AW,AX);};var AV=function(AX,AW){var AY=AW[Z.FONT_SIZE];if(AY&&AY!==AC){AW[Z.FONT_SIZE]=Math.round(parseInt(AY)/4*3)+"pt";}return AH.getCharacterGroup(function(AZ,Aa){if(AZ===Z.FONT_SIZE){Aa=parseInt(Aa)/3*4+"px";}AX(AZ,Aa);},AW);};var AT=AG(AH.selectedFontPart);var AU=AV(AN,AT);var AQ=AL.getFormatPropertyValue(S.TEXT_SIZE_TYPE);var AO=AT[S.UNIFY_STEPS];var AR=AO===false||AO!=="0";var AS=AH.getTextSizeController(AR);var AP=AQ===j.FIXED;AU.fontSize.set("enabled",AP);AS.set("visible",!AP);return[AU,AS];};this.selectedFontPart=this.selectedFontPart||AD;this.setFontPropertyValue=AJ;var AK=[AH.getGroupTitle(mstrmojo.desc(16259,"Font")),AI(),AF(),].concat(AE());return this.getEditorGroup(AK,{showDivider:true,isNested:true,isContainer:true,});},getKPIStyleControls:function V(){var AE="custom";var AD=[];var AF=this.getHost();var AH=AF.getFormatPropertyValue(S.KPI_STYLE);var AC=[{n:mstrmojo.desc(8959,"Light"),id:X.LIGHT},{n:mstrmojo.desc(15866,"Night"),id:X.NIGHT},{n:mstrmojo.desc(9237,"Desert"),id:X.DESERT},{n:mstrmojo.desc(15867,"Ocean"),id:X.OCEAN},{n:mstrmojo.desc(14417,"Customize"),id:AE},];AD.push(this.fnGetPulldown(AC,d.find(AC,"id",AH)||0,mstrmojo.desc(1400,"Style"),S.KPI_STYLE));if(AH===AE){var AG=function(AK,AL){var AJ=function(AN){var AM=mstrmojo.ui.editors.controls.FillConfigGroup.FillCompName;if(AN===AM.FILL_COLOR){return AK;}if(AN===AM.FILL_TRANSPARENT){return AL;}return AK;};return function(AM,AN){AF.writeProperties(S.CUSTOM_KPI_STYLE,AF.generateUpdatedCustomStyleConfigs(AE,AJ(AM),AN));};};var AI=AF.getSpecificKPIStyle(AH)||{};AD.push(this.getColorFormatsControl(mstrmojo.desc(16291,"Area Fill Color"),AI.bgColor,AI.bgOpacity,AG("bgColor","bgOpacity")));AD.push(this.getColorFormatsControl(mstrmojo.desc(16290,"Trend Fill Color"),AI.chartColor,AI.chartOpacity,AG("chartColor","chartOpacity")));}return this.getEditorGroup(AD,{showDivider:false,isNested:true,isContainer:true});},getColorFormatsControl:function A(AH,AE,AF,AG){var AK=false;var AC=mstrmojo.ui.editors.controls.FillConfigGroup.FillCompName.FILL_COLOR;var AJ=mstrmojo.ui.editors.controls.FillConfigGroup.FillCompName.FILL_TRANSPARENT;var AI=new mstrmojo.Label({text:AH});var AD=new mstrmojo.ui.editors.controls.FillConfigGroup({showNoFill:false,onGroupValueChange:function(AL,AM){if(!AK){return ;}if(AL===AJ){AM=AM/100;}AG(AL,AM);},});AD.iniChildrenComp([AC,AJ]);AD.setChildrenValue([[AC,AE],[AJ,AF*100],]);AK=true;return this.getEditorGroup([AI,AD],{showDivider:false,isNested:true,isContainer:true});},getStyleControls:function U(){var AE=this.getHost(),AD=[],AF=AE.getFormatPropertyValue(S.PREVIOUS_METRIC_NAME),AC;AD.push(this.getKPIStyleControls());AD.push(this.getFontControlGroup());if(AE.getUnitsByDropZoneID("trend").length>0){AD.push(new mstrmojo.Label({text:mstrmojo.desc(15872,"Previous Value Label")}));AC=new mstrmojo.ui.editors.controls.ValidationTextBox({required:false,dtp:g.VARCHAR,validationDelay:1500,value:AF,autoComplete:false,onValid:function(){AE.writeProperties(S.PREVIOUS_METRIC_NAME,this.value);},onRender:function(){var AG=document.createElement("input");AG.type="text";AG.style.cssText="display: none !important;";if(this.domNode.parentNode){this.domNode.parentNode.appendChild(AG);}}});AD.push(AC);}return this.getEditorGroup(AD,{showDivider:false,isNested:true,isContainer:true});},getBadgeModeSelectedIndex:function n(){var AE=this.getHost(),AD=AE.getFormatPropertyValue(S.BADGE_MODE),AC=1;switch(AD){case Y.NONE:AC=0;break;case Y.PERCENTAGE:AC=1;break;case Y.VALUE:AC=2;break;default:break;}return AC;},getBadgeControlGroup:function q(){var AH=[],AG=this,AI=this.getHost(),AE=AI.getFormatPropertyValue(S.BADGE_MODE),AC=AI.getFormatPropertyValue(S.INCREASE_BG_COLOR),AJ=AI.getFormatPropertyValue(S.DECREASE_BG_COLOR),AK=AE!==Y.NONE,AF,AD;AH.push(this.getGroupTitle(mstrmojo.desc(15870,"Trend Indicator")));AH.push(this.fnGetPulldown(u,this.getBadgeModeSelectedIndex(),undefined,S.BADGE_MODE));Q.addCustomColor(I);Q.addCustomColor(z);AF=new mstrmojo.ui.editors.controls.ColorPickerButton({showGradient:false,showNoFill:false,showAutomatic:true,autoPreviewColor:I,selectedValue:AC===I?r:AC,postselectedValueChange:function(AL){var AM=AL.value;AG.onPropertiesChanged(S.INCREASE_BG_COLOR,AM===r?I:AM);}});AD=new mstrmojo.ui.editors.controls.ColorPickerButton({showGradient:false,showNoFill:false,showAutomatic:true,autoPreviewColor:z,selectedValue:AJ===z?r:AJ,postselectedValueChange:function(AL){var AM=AL.value;AG.onPropertiesChanged(S.DECREASE_BG_COLOR,AM===r?z:AM);}});AH.push(this.getLabelAndControl(mstrmojo.desc(8314,"Increase"),AF,"50%","50%",undefined,{enabled:AK}));AH.push(this.getLabelAndControl(mstrmojo.desc(8315,"Decrease"),AD,"50%","50%",undefined,{enabled:AK}));return this.getEditorGroup(AH,{showDivider:true,isNested:true,isContainer:true});},getThresholdControlGroup:function D(){var AC=[],AE=this,AD;AC.push(this.getGroupTitle(mstrmojo.desc(3647,"Thresholds")));this.initThresholdControls(AC);AD=new mstrmojo.Button.newWebButton(mstrmojo.desc(531,"Add"),b.bind(AE),false,{});AC.push(AD);return this.getEditorGroup(AC,{showDivider:true,isNested:true,isContainer:true});},initThresholdControls:function h(AE){var AI=this.getHost(),AD=AI.readColorThresholdsProp(),AG=AD&&AD.thresholds,AJ,AC,AH,AF;if(!AG||!d.isArray(AG)){return ;}AJ=AG.length;for(AF=0;AF<AJ;AF+=1){AC=AG[AF];AH=this.initSingleThresholdControlItem(AF,AC.enabled,AC.min,AC.max,AC.color);AE.push(AH);}},initSingleThresholdControlItem:function AB(AQ,AL,AI,AO,AG){var AR=[],AP,AK,AC,AJ,AM,AE,AS,AN=this,AF,AD=/^$|(^(-|\d*)\d+(\.\d+)?)$/;AK=new mstrmojo.ui.Checkbox({checked:AL,colorThresholdIdx:AQ,oncheckedChange:function AH(AT){var AU=AT.value,AV=AN.getHost();AV.setColorThresholdProperty(this.colorThresholdIdx,"enabled",AU);}});AP=this.getGroupTitle(mstrmojo.desc(15873,"Threshold ##").replace("##",(AQ+1)));AC=mstrmojo.Button.newIconButton(undefined,"kpi-cth-delete-button",function(){var AT=AN.getHost();this.hideTooltip();AT.removeColorThreshold(this.colorThresholdIdx);},undefined,{colorThresholdIdx:AQ,useRichTooltip:true,updateTooltipConfig:function(){this.richTooltip={cssClass:"vi-regular vi-tooltip-C",content:mstrmojo.desc(15874,"Delete the threshold"),refNode:this.domNode,posType:mstrmojo.tooltip.POS_TOPLEFT,left:25,top:-7};}});AK.slot="col1Node";AP.slot="col2Node";AC.slot="col3Node";AJ=new mstrmojo.kpicard.editors.KPICardThresholdHeaderControl({col1Width:"15px",col2Width:"auto",col3Width:"18px",children:[AK,AP,AC]});AF={cssClass:"kpi-cth-TextBox",errRevert:false,dtp:g.FLOAT,validationDelay:1500,colorThresholdIdx:AQ,updateText:function(AT){this.inputNode.value=AT;this.value=AT;},tooltipOpenDelay:0,useRichTooltip:true,updateTooltipConfig:function(){if(this.isValid()){this.richTooltip=null;return ;}this.richTooltip={posType:mstrmojo.tooltip.POS_TOPLEFT,cssClass:"vi-warning vi-tooltip-C triangle-warning",left:this.domNode.offsetWidth+10,top:-4,refNode:this.domNode,keepArrowYPos:true,content:this.getInvalidMsg(this.validationStatus)};if(this.tooltipTimeout){window.clearTimeout(this.tooltipTimeout);}this.tooltipTimeout=window.setTimeout(this.hideTooltip,1500);},onValid:function(){var AT=this.value,AV=AT&&parseFloat(AT),AU=AN.getHost();if(isNaN(AV)||(!AV&&AV!==0)||AV===""){AV=undefined;}AU.setColorThresholdProperty(this.colorThresholdIdx,this.cthPropName,AV);},onfocus:function(){this.orignText=this.value;var AT=this.inputNode;if(AT){this.inputNode.setAttribute("placeholder","");}},onblur:function(){if(this.value!==this.orignText){this.validate();}var AT=this.inputNode;if(AT){this.inputNode.setAttribute("placeholder",this.hint);}}};AM=new mstrmojo.ui.editors.controls.ValidationTextBox(P.copy(AF,{constraints:{trigger:mstrmojo.validation.TRIGGER.ALL,max:!isNaN(AO)?parseFloat(AO):undefined,regExp:AD,invalidCssClass:"mstrmojo-TextBox-ErrValidation"},hint:"\ue80d",value:AI?AI.toString():AI,cthPropName:"min",getInvalidMsg:function(AT){if(AT.code===f.INVALID_OUTOFRANGE){return mstrmojo.desc(15875,"Value should be less than ##").replace("##",this.constraints.max);}return mstrmojo.desc(11935,"Invalid characters");}}));AE=new mstrmojo.ui.editors.controls.ValidationTextBox(P.copy(AF,{constraints:{trigger:mstrmojo.validation.TRIGGER.ALL,min:!isNaN(AI)?parseFloat(AI):undefined,regExp:AD,invalidCssClass:"mstrmojo-TextBox-ErrValidation"},hint:"\ue80e",value:AO?AO.toString():AO,cthPropName:"max",getInvalidMsg:function(AT){if(AT.code===f.INVALID_OUTOFRANGE){return mstrmojo.desc(15876,"Value should be greater than ##").replace("##",this.constraints.min);}return mstrmojo.desc(11935,"Invalid characters");}}));AS=new mstrmojo.ui.editors.controls.ColorPickerButton({showGradient:false,showNoFill:false,selectedValue:AG,colorThresholdIdx:AQ,postselectedValueChange:function(AT){var AV=AT.value,AU=AN.getHost();AU.setColorThresholdProperty(this.colorThresholdIdx,"color",AV);}});AR.push(AJ);AR.push(this.getLabelAndControl(mstrmojo.desc(9305,"From"),AM,"33%","67%",undefined,{enabled:AL}));AR.push(this.getLabelAndControl(mstrmojo.desc(15877,"To"),AE,"33%","67%",undefined,{enabled:AL}));AR.push(this.getLabelAndControl(mstrmojo.desc(6242,"Color"),AS,"50%","50%",undefined,{enabled:AL}));return this.getEditorGroup(AR,{showDivider:false,isNested:true,isContainer:true});}});}());(function(){mstrmojo.requiresCls("mstrmojo.vi.models.editors.BaseEditorModel","mstrmojo.chart.enums.EnumFontStyle");mstrmojo.requiresClsP("mstrmojo.ui.editors.controls","CharacterGroup","ContainerGroup","TwoColumnContainer","ColorPickerButton","LineStyleButton","ValidationTextBox");var R=mstrmojo.hash,Y=mstrmojo.emptyFn,O=mstrmojo.array,H=mstrmojo.ui.editors.controls.CharacterGroup.CTRL_FLAGS,A=mstrmojo.chart.enums.EnumFontStyle,Q=mstrmojo.models.FormatModel.ENUM_PROPERTY_NAMES,N=mstrmojo.gm,W=mstrmojo.expr.DTP;var P="allTxt",E="lg",Z=0,b=1;var I=false;function B(c){if(I&&window.console){window.console.log(c);}}function a(c,e){return{broker:c,smartNames:e,controlName:e[0],reInitDefault:function(){(this.listenFormatProps).forEach(function(f){this.onFmtPropsChanged(f,this.broker.getFormatPropertyValue(f));},this);},reInit:function(){this.reInitDefault();},preBuildRendering:function(){this.reInit();},syncControl:function(f){var g=this._sync;this._sync=true;var h=f.call(this);this._sync=g;return h;},onFmtPropsChangedDefault:Y,onFmtPropsChanged:function(f,h,g){this.onFmtPropsChangedDefault(f,h,g);},onSelectorsValueChangedDefault:function(){this.reInit();},onSelectorsValueChanged:function(f,g){this.onSelectorsValueChangedDefault(f,g);},destroy:function d(f){this.broker.removeRegisterFormatControl(this);return this.constructor.prototype.destroy.call(this,f);}};}function L(h,f,d,c){if(!h){return ;}function g(p){return Object.keys(O.hash(O.ensureArray(p)));}var k=h.listenFormatProps||[],m=h.listenSelector||[];(h.smartNames||[]).forEach(function(p){O.insert(k,null,p);O.insert(m,null,h.broker.getDependingSelectorNames(p));});h.listenFormatProps=g(k);h.listenSelector=g(m);h.broker.registerFormatControl(h);var o=h;if(typeof f==="string"){var e=(d===b),j=e?"20px":"30%",l=e?"100%":"70%";if(c){j=c[0];l=c[1];}o=this.getLabelAndControl(f,h,j,l,e);h.label=o.getLabel();if(e){o.cssClass="checkLabel multiLine";h.label.onclick=function n(){h.onclick();};h.label.cssDisplay="inline-block";}else{if(d===Z){o.cssClass="characterGroup";}}}h.getCtrlContainer=function(){return o;};return o;}function U(e,d){var f=e.getFormatPropertyValue(d);function c(h){var j=h.value;return(j===undefined||j==="")&&f===undefined;}return{onInvalid:function g(){if(c(this)){if(this.hasRendered){this.clearValidation();}return ;}else{if(this.hasRendered){mstrmojo.ui.editors.controls.ValidationTextBox.prototype.onInvalid.call(this);}}},onRender:function(){if(c(this)){this.clearValidation();}}};}function G(f,d){var c={},j=f.getFormatPropertyValue(d.fontStyle),g=f.getFormatPropertyValue(d.fontColor),e=f.getFormatPropertyValue(d.fontFamily),h=f.getFormatPropertyValue(d.fontSize);if(j!==undefined){c[Q.FONT_WEIGHT]=(!isNaN(j)&&((j&A.FS_BOLD)>0));c[Q.FONT_STYLE]=(!isNaN(j)&&((j&A.FS_ITALIC)>0));c[Q.UNDERLINE]=(!isNaN(j)&&((j&A.FS_UNDERLINE)>0));c[Q.LINE_THROUGH]=(!isNaN(j)&&((j&A.FS_STRIKETHROUGH)>0));}c[Q.COLOR]=g!==undefined?g:-1;c[Q.FONT_SIZE]=h!==undefined?h:-1;c[Q.FONT_FAMILY]=e!==undefined?e:-1;return c;}mstrmojo.imagelayout.ImageLayoutEditorHelper=mstrmojo.provide("mstrmojo.imagelayout.ImageLayoutEditorHelper",{getFillConfigComp:function V(g,d,e,k){var c=g.propertyManager,j=R.valarray(e),f=a(c,j);R.copy({smartNamesMap:e,onGroupValueChange:function(l,m){if(!this._sync){c.setFormatPropertyValue(l,m);}},onFmtPropsChangedDefault:function(l,m){this.syncControl(function(){var n=this;if(O.filterOne(this.propNames,function(o){return(o===l);})){n.setChildValue(l,m);}else{this.propNames.forEach(function(o){n.setChildValue(o,c.getFormatPropertyValue(o));});}});}},f);R.copy(k,f);var h=g.addDisposable(new mstrmojo.ui.editors.controls.FillConfigGroup(f));h.iniChildrenComp(j);return L.call(this,h,d);},getLineConfigComp:function X(g,d,e,k){var c=g.propertyManager,j=R.valarray(e),f=a(c,j);R.copy({smartNamesMap:e,onGroupValueChange:function(l,m){if(!this._sync){c.setFormatPropertyValue(l,m);}},onFmtPropsChangedDefault:function(l,m){this.syncControl(function(){this.setChildValue(l,m);});}},f);R.copy(k,f);var h=g.addDisposable(new mstrmojo.ui.editors.controls.LineConfigGroup(f));h.iniChildrenComp(j);return L.call(this,h,d);},getCharacterConfigComp:function D(h,l,g,m){var c=h.propertyManager,n=R.valarray(g),k=a(c,n),j={},f={};f[Q.FONT_SIZE]=g.fontSize;f[Q.COLOR]=g.fontColor;f[Q.FONT_FAMILY]=g.fontFamily;f[Q.FONT_WEIGHT]=f[Q.FONT_STYLE]=f[Q.UNDERLINE]=f[Q.LINE_THROUGH]=g.fontStyle;j[Q.FONT_WEIGHT]=A.FS_BOLD;j[Q.FONT_STYLE]=A.FS_ITALIC;j[Q.UNDERLINE]=A.FS_UNDERLINE;j[Q.LINE_THROUGH]=A.FS_STRIKETHROUGH;R.copy({smartNamesMap:g,syncWithAllText:false,onGroupValueChange:function(r,q){var u=f[r];if(u===g.fontStyle){var p=c.getFormatPropertyValue(u),t=j[r],o=q;q=o?(p|t):(p&(~t));}else{if(u===g.fontSize){if(this.visibleControls&H.FONT_SIZE_USE_STEPPER){q=q[0];}q=parseInt(q,10)+"pt";}}this.broker.setFormatPropertyValue(u,q);},onFmtPropsChangedDefault:function(o){this.syncControl(function(){var p=this.smartNamesMap,q=O.filterOne(R.keyarray(p),function(r){return p[r]===o;});if(q||this.syncWithAllText){if(!q&&o.indexOf(P)===-1){B("[CharacterGroup] Unnecessary refresh which might be due to incorrect listenFormatProps.");}this.refreshValues();}});},refreshValues:function(){this.syncControl(function(){var o=G(this.broker,this.smartNamesMap);if(this.visibleControls&H.FONT_SIZE_USE_STEPPER){o[Q.FONT_SIZE]=[parseInt(o[Q.FONT_SIZE],10)];}this.setFormatSource(o);});}},k);R.copy(m,k);if(k.syncWithAllText){var e=R.valarray(c.getSmartNamesMapForFontGroup(P));k.listenFormatProps=(k.listenFormatProps||[]).concat(e);}var d=h.addDisposable(new mstrmojo.ui.editors.controls.CharacterGroup(k));return L.call(this,d,l);},getPropertyCheckBox:function J(g,e,d,k){var c=g.propertyManager,j=[d],f=a(c,j);R.copy({oncheckedChange:function(){if(this._sync){return ;}c.setFormatPropertyValue(this.smartNames[0],this.checked);},onFmtPropsChangedDefault:function(l,m){this.syncControl(function(){this.set("checked",!!m);});}},f);R.copy(k,f);var h=g.addDisposable(new mstrmojo.ui.Checkbox(f));return L.call(this,h,e,b);},getPropertyPulldown:function S(g,k,h,c,l){l=l||{};var e=g.propertyManager,m=[c],j=a(e,m),d=l.fnChange||function(n){if(this._sync){return ;}e.setFormatPropertyValue(this.smartNames[0],n);};R.copy({onFmtPropsChangedDefault:function(n,o){this.syncControl(function(){if(typeof o==="undefined"){this.set("selectedIndex",-1);}else{this.selectItemByField("v",o);}});}},j);R.copy(l,j);var f=g.addDisposable(this.getPulldown(h,d,0,j));return L.call(this,f,k,null,["40%","60%"]);},getPropertyButtonBar:function M(f,j,g,c,k){var d=f.propertyManager,l=[c],h=a(d,l);R.copy({showIcon:false,items:g,onFmtPropsChangedDefault:function(m,n){this.syncControl(function(){if(this.multiSelect){this.select((this.items||[]).map(function(p,o){return(n&p.v)>0?o:null;}).filter(function(o){return o!==null;}));}else{if(typeof n==="undefined"){this.clearSelect();}else{this.singleSelectByField(n,"v");}}});},postselectionChange:function(m){if(this._sync){return ;}var n=m.added&&this.items[m.added[0]].v;if(this.multiSelect){if(!g||!g.length){return B("[ImageLayoutEditorModel getBitwiseValFromMultiSelection] no items in caller");}n=g.reduce(function(q,p,o){return this.selectedIndices[o]?q|=p.v:q;}.bind(this),0);}d.setFormatPropertyValue(this.smartNames[0],n);}},h);R.copy(k,h);var e=f.addDisposable(new mstrmojo.ui.ButtonBar(h));return L.call(this,e,j);},getPropertyValidationTextBox:function C(g,e,d,k){var c=g.propertyManager,j=[d],f=a(c,j);R.copy({dtp:W.FLOAT,required:true,onValid:function(){if(this._sync){return ;}c.setFormatPropertyValue(this.smartNames[0],this.value);},onFmtPropsChangedDefault:function(l,m){this.syncControl(function(){this.set("value",m);this.validate();});}},f);R.copy(k,R.copy(U(c,d),f));var h=g.addDisposable(new mstrmojo.ui.editors.controls.ValidationTextBox(f));return L.call(this,h,e);},getPulldown:function F(d,g,c,f,e){R.copy({_set_selectedIndex:function h(l,j){if(j===-1){this.selectedIndex=j;this.getPopupList().clearSelect();var k=this.selectedNode;if(k){k.innerHTML="";}return false;}return this.constructor.prototype._set_selectedIndex.call(this,l,j);}},f);return mstrmojo.ui.Pulldown.newPulldown(d,function(j,k){g.call(this,j.v,k&&k.v);},c,f,e);},getLabelAndControl:function K(e,f,h,k,g,j){var l=new mstrmojo.Label({text:e,setDimensions:function(o,m){var n=this.domNode;if(n){n.style.width=m;}}}),d=l,c=f;if(g){d=f;c=l;}d.slot="col1Node";c.slot="col2Node";return new mstrmojo.ui.editors.controls.TwoColumnContainer(R.copy(j,{col1Width:h||"40%",col2Width:k||"60%",children:[d,c],getLabel:function(){return l;},getCtrl:function(){return this.children.filter(function(m){return m!==l;})[0];}}));}});}());(function(){mstrmojo.requiresCls("mstrmojo.array","mstrmojo.css","mstrmojo._HasPopup","mstrmojo.Popup","mstrmojo.hash","mstrmojo.expr","mstrmojo.Container","mstrmojo.ConditionModel","mstrmojo.Widget","mstrmojo.Button","mstrmojo.ui.ColumnWalk","mstrmojo.rw.ConditionWalk","mstrmojo.mstr.EnumNodeDimty","mstrmojo.vi.ui.ConditionWalkProvider","mstrmojo.vi.ui.AllObjectsBrowser");var U=mstrmojo.Widget,M=mstrmojo.array,G=mstrmojo.dom,Q=mstrmojo.hash,b=mstrmojo.css,V=mstrmojo.Button.newWebButton,L=mstrmojo.expr,C=L.ET,A=mstrmojo.mstr.EnumNodeDimty,N=M.hash([A.NodeDimtyOutputLevel]);var O=mstrmojo.rw.ConditionWalk.getAttForms,E=mstrmojo.rw.ConditionWalk.isMdxDM;function F(){var d=this.model;if(d){if(!d.attachEventListener){Q.make(d,mstrmojo.ConditionModel,{defaultETAttr:d.defaultETAttr,data:d.data});}d.attachEventListener("edit",this.id,"onmodeledit");}}function P(e,d){if(d&&d.detachEventListener){d.detachEventListener("edit",e.id,"onmodeledit");}}mstrmojo.vi.ui.ConditionWalk=mstrmojo.declare(mstrmojo.Container,[mstrmojo._HasPopup],{scriptClass:"mstrmojo.vi.ui.ConditionWalk",markupString:'<div id="{@id}" class="mstrmojo-vi-ui-ConditionWalk" mstrAttach:click><div class="walk"></div></div>',markupSlots:{walkNode:function(){return this.domNode.firstChild;}},markupMethods:{onvisibleChange:U.visibleMarkupMethod,onheightChange:U.heightMarkupMethod,onwidthChange:U.widthMarkupMethod},layoutConfig:{h:{walkNode:"100%"},xt:true},editor:undefined,columnWalk:undefined,walkProvider:null,objectBrowsingEnabled:false,children:[{scriptClass:"mstrmojo.ui.ColumnWalk",alias:"columnWalk",slot:"walkNode",height:"370px",width:"600px"}],postCreate:function B(){if(this._super){this._super();}if(!this.walkProvider){this.walkProvider=this.addDisposable(mstrmojo.insert(mstrmojo.vi.ui.ConditionWalkProvider));}},initWalk:function W(){var d=this.columnWalk,e=this.walkProvider;d.removeTrailingContainer(-1);d.addNextColumn(e.getTargetNodeProps());d.target.updateColumnContainer();this.updateOkBtn();},ob:{scriptClass:"mstrmojo.Popup",cssClass:"mstrmojo-vi-ui-ConditionWalk ObjectBrowserPopup mojo-theme-light",children:[{scriptClass:"mstrmojo.vi.ui.AllObjectsBrowser",alias:"browser",title:mstrmojo.desc(5298,"Select an Object"),layoutConfig:null,onSelectedItemsChange:function K(){var d=this.getSelectedItems(),e=d&&d[0],f=e&&e.t;this.parent.buttons.selectBtn.set("enabled",f&&f!==L.TP.FOLDER);},browse:function R(d){Q.copy(d,this);},getObjectSubTypes:function(){var d=this.browsableTypes;if(d){return d.split(",");}return this.constructor.prototype.browsableTypes();},dblClickOnNodes:function a(d){var g=this.onSelectCB,f=d.getTarget(),e=G.findWidget(f).data;g[0][g[1]](e);}},{scriptClass:"mstrmojo.Box",alias:"buttons",cssClass:"buttons",children:[V(mstrmojo.desc(221,"Cancel"),function(){this.parent.parent.opener.closePopup();}),V(mstrmojo.desc(547,"Select"),function(){var f=this.parent.parent,g=f.browser,h=g.onSelectCB,e=g.getSelectedItems(),d=this.parent.parent.opener;if(e&&e.length>0){h[0][h[1]](e[0]);}else{d.closePopup();}},true,{alias:"selectBtn",enabled:false})]}],onOpen:function H(){var h=this.shadowNode,d=document.body,e=document.documentElement,g=h.style,f=this.domNode;this.browser.obSearchBox.clearSearch(true);g.width=Math.max(d.clientWidth,e.scrollWidth)+"px";g.height=Math.max(d.clientHeight,e.scrollHeight)+"px";window.setTimeout(function(){b.addClass(f,"open");},1);},onClose:function D(){b.removeClass(this.domNode,"open");var d=this.browser;d.opened=false;d.reset();}},_set_model:function Z(g,d){var e=this.model,f=(d!==e);if(f){P.call(this,e);d.dimtyTypes=this.dimtyTypes||N;this.model=d;F.call(this,d);this.initWalk();}return f;},onmodeledit:function J(e){var d=this.columnWalk[e.prop==="c1"?"c0":e.prop];if(e.prop==="fm"){d=this.columnWalk.target;}if(d){d.updateColumnContainer();}this.updateOkBtn();this.postmodeledit(e);},postmodeledit:mstrmojo.emptyFn,updateOkBtn:function c(){var g=true,d=this.model,e,f=d&&L.fnCstCount(d.fn,d.fnt);if(!d){return ;}switch(d.et){case C.AQ:case C.AL:case C.MQ:for(e=0;e<f;e++){g=g&&!this["invalid"+e];}break;}g=g&&!!d.completed;this.delegateUpdateOkBtn(g);},delegateUpdateOkBtn:mstrmojo.emptyFn,browse:function I(f){var h=this.parent.editorNode,g=function(k,m){var j=G.position(k,true),l=G.position(m,true);return{x:j.x+j.w,y:l.y};},d=this.columnWalk,e=this.walkProvider;switch(f&&f.alias){case"target":case"dmy":e.browseObjs(this,f);break;case"c0":case"c1":e.browseObjs(this,f);break;case"es":e.browseEs(this,f,g(d.es.domNode,h));break;}},onOBSelect:function(j){var l=j.t;if(l===L.TP.FOLDER||l===0||l===undefined){return ;}var g=this.ob.browser,m=g.target;this.closePopup();if(m.alias==="c0"){m=m.attMxPd;}var e=this.targets,k=m.itemIdField,h=e||[],d=M.find(e,k,j[k]);if(d===-1){h.push(j);this.targets=h;this.targetsLastMod=new Date();this.raiseEvent({name:"updateTargets",targets:this.targets});}m.list.set("selectedIndex",M.find(m.items,"did",j.did));if(m.onObjBrowsed){m.onObjBrowsed(j);}},getDatasets:mstrmojo.emptyFn,getAttributeForms:function X(f){var e=this.editor;if(e&&e.getAttributeForms){return e.getAttributeForms(f);}var d=this.getDatasets();return O(f,d);},getAttributeInfo:function Y(d){var e,g=this.editor;if(g&&g.model&&g.model.targets){M.forEach(g.model.targets,function(h){if(h.did===d){e=Q.clone(h);return false;}});}else{var f=this.getDatasets();Q.forEach(f,function(h){e=Q.clone(h.att.filter(function(j){return j.did===d;})[0]);if(e){return false;}});}if(e){e.fs=this.getAttributeForms(d);}return e?e:{};},isMDXDM:function S(d){return E(d,this.getDatasets());},getIfDataSource:mstrmojo.emptyFn,onUpdateBrowseElementsParams:mstrmojo.emptyFn});}());(function(){mstrmojo.requiresCls("mstrmojo.vi.ui.InteractiveUnitList","mstrmojo.array","mstrmojo.hash","mstrmojo.string","mstrmojo.vi.models.EnumDragSources");mstrmojo.requiresDescs();var F=mstrmojo.array,G=mstrmojo.css,E=mstrmojo.dom,B=mstrmojo.hash,L=mstrmojo.string,O=18,M=3,A=10,K=13,D="\u001E";function C(){this._dsetId=this.dataset&&this.dataset.id||"";this.set("items",this.filterItems(this.getAllItems()).map(function(Q){return B.copy(Q);}));}mstrmojo.vi.ui.DatasetUnitList=mstrmojo.declare(mstrmojo.vi.ui.InteractiveUnitList,null,{scriptClass:"mstrmojo.vi.ui.DatasetUnitList",dataset:null,filterScope:"",filterExpr:"",filterFunc:null,level:null,dropZone:false,init:function P(Q){this._super(Q);if(!!mstrApp.isWSStyling){A=7;}C.call(this);},getItemMarkup:function J(Q){return this._super(Q).replace('<span class="txt" unselectable="on">{@en@n}</span>','<div class="icon" style="{@iconLeft}"></div><span class="txt {@midTruncateCssClass}" unselectable="on"">{@en@n}</span>').replace("{@en@n}","{@matchHTML}").replace("{@midTruncateCssClass}",this.midTruncateCssClass);},getItemProps:function H(Y,X){var U=this._super(Y,X);if(Y.mnu){U.addCls(mstrmojo.vi.ui.InteractiveUnitList.CLS_HAS_MENU);}U.dsc=Y.dsc;var R=this.filterExpr,W,Z=U.n,S=mstrmojo.string.encodeHtmlString;if(R){W=new RegExp(L.regEscape(R),"ig");if(W.test(Z)){Z=Z.replace(W,function(a){return D+a+D;});}var Q=F.map((Z||"").split(D),function(b,a){return(a%2===0)?S(b):("<em>"+S(b)+"</em>");});U.matchHTML=Q.join("");}else{U.matchHTML=S(Z);}if(this.level!==null){var V=A+this.level*K;U.addStyle("padding-left: "+(V+O+M)+"px;");U.iconLeft=L.encodeHtmlString("left:"+V+"px;");}return U;},prefilterScopeChange:C,prefilterExprChange:C,ondatasetChange:C,getAllItems:null,reloadItems:C,filterItems:function(Q){Q=Q.filter(function(U){return U&&!U.hide;});switch(this.filterScope){case"att":Q=Q.filter(function(U){return U.t!==4;});break;case"mx":Q=Q.filter(function(U){return U.t===4;});break;}var S=this.filterExpr;if(S){var R=[];F.forEach(Q,function(V){var U=B.copy(V),X=U.n,W=new RegExp(L.regEscape(S),"ig");if(W.test(X)){R.push(U);}});Q=R;}if(this.filterFunc){Q=this.filterFunc(Q);}return Q;},addMenuProp:false,getDragData:function N(Q){this.selectDragNode(Q);var R=this._super(Q);R.item=R.items&&R.items[0];R.dsid=this.dataset.id;R.src=mstrmojo.vi.models.EnumDragSources.DATASETS;return R;},selectDragNode:function I(R){this._super(R);var S=R.src.data;if(S){var Q=S.items=mstrmojo.all[S.srcId].getSelectedItems();S.item=Q&&Q[0];}}});}());(function(){mstrmojo.requiresCls("mstrmojo.DocDataService","mstrmojo.array","mstrmojo.dom","mstrmojo.hash","mstrmojo.Button");mstrmojo.requiresClsP("mstrmojo.mstr","EnumFunction","EnumDSSXMLBaseFormType","EnumDSSXMLObjectTypes","EnumDSSXMLObjectSubTypes","EnumDSSConsolidationType","EnumDataType","EnumWebAPIErrorCodes");mstrmojo.requiresClsP("mstrmojo.ME","AttributeEditBox","MetricToken");mstrmojo.requiresClsP("mstrmojo.vi.ui","DatasetUnitList","DatasetUnitMenuUtils");mstrmojo.requiresClsP("mstrmojo.ui.menus","MenuConfig","Menu","EditorConfig");mstrmojo.requiresDescs(190,1388,2213,2453,2789,3323,3329,5188,9748,11490,11491,11492,11493,11614,11615,14717);var h=mstrmojo.array,M=mstrmojo.dom,z=mstrmojo.func,O=mstrmojo.hash,x=mstrmojo.mstr,l=x.EnumDataType,E=x.EnumDSSXMLBaseFormType,AB=x.EnumDSSXMLObjectTypes,W=x.EnumDSSXMLObjectSubTypes,B=x.EnumDSSConsolidationType,e=x.EnumFunction,H=x.EnumWebAPIErrorCodes,Y=mstrmojo.vi.enums.EnumFeatures,q=mstrmojo.vi.ui.DatasetUnitMenuUtils,f=1,A="\u001E",AD=mstrmojo.DocDataService.PARTIAL_UPDATE_FLAGS,Q=mstrmojo._HasTooltip.TOOLTIP_OPEN_DELAY,g,t={style:{params:{treesToRender:1}}};function V(AJ,AK,AI){var AH=this.docModel,AG=AH.controller;AK=z.wrapMethods({failure:function(AL,AM){this.canceled(AM.id);}},AK);O.copy({skipUICmdMgrOnFailure:[H.E_INVALID_EXPRESSION]},AI);AG.cmdMgr.execute({execute:function(){this.submit(AJ,AK,AI);},urInfo:{callback:AK}});}function D(AH,AI,AJ){var AG=AH.docModel;return q.getAggregateByMenu(AI,function(AL,AK){AG.addShortcutMetric({dsid:AJ,funcType:AK,items:[{did:AL.did,t:AL.t}]},AG.getDatasetsUpdateCallback());});}function C(AH,AI,AK){var AJ=AH.dataset.set.mx,AG=h.filter(AJ,function(AL){return !AL.hide;});return q.getCalculationMetricEditor(AG,AI,function(AN,AM,AQ,AO){var AL=AH.docModel,AP={act:"addShortcutMetric",dsid:AK,funcType:AQ,funcType2:AO,units:[AN,AM]};V.call(AH,AP,AL.getDatasetsUpdateCallback(),t);});}function Z(AH){if(!AH){return ;}if(!AH.links){AH.links={};var AG=AH.links;h.forEach(AH,function(AI){O.forEach(AI,function(AJ,AK){if(!AG[AK]){AG[AK]=[];}AG[AK].push(AJ);if(!AG[AJ]){AG[AJ]=[];}AG[AJ].push(AK);});});}}function R(AN,AI,AL){if(AL.t!==AB.Attribute){return ;}var AM=AI._dsetId,AH=AI.docModel,AG=AH.controller,AK=function(AO){var AP=AO.code||AO.getResponseHeader("X-MSTR-TaskErrorCode");if(AP==="-2147156975"){mstrmojo.confirm(mstrmojo.desc(14148,"For this dataset, this action can only be performed in the Dataset Editor. Click OK to open the editor now."),{confirmBtn:{t:mstrmojo.desc(1442,"OK"),fn:function(){a(AI);}},cancelBtn:{t:mstrmojo.desc(221,"Cancel")}});}},AJ=function(AO){var AP=z.wrapMethods(AG.getRefreshCallback(),{success:function(){AG.cmdMgr.reset();},failure:AK});AH.getDataService().submitUpdates(AO,AP,{config:{showProgress:true,hideProgress:true,progressStateText:[mstrmojo.desc(8445,"Loading")],silent:true}});};Z(AH.als);q.getAttributeLinkMenu(AN,AL,AM,AH,AJ);}function a(AJ){var AG=mstrmojo.all[AJ.panelId],AI=AJ.dataset.set,AK=AJ._dsetId,AH=AJ.docModel;AG.showDataImport({isEdit:true,isNewAnalysis:false,isManagedCube:AI.mngd,AnalysisId:AH.mid,ReportId:AK,CubeName:AI.name,CubeDesc:AI.dsc,StatusCode:1});}function AC(AI,AH,AG){return AI.links[AH+" "+AG];}function N(AI,AG,AH){if(!c(AH,AG.docModel.als).isLinked){return ;}AI.addMenuItem(mstrmojo.desc(9748,"Unlink"),"",function(){var AK=AG.docModel,AN=AH.did,AL=[],AJ=[],AO=[],AM;h.forEach(AH.fs,function(AQ){var AP=AC(AK.als,AN,AQ.fid);h.forEach(AP,function(AR){AL.push(AQ.fid);var AS=AR.split(" ");AJ.push(AS[0]);AO.push(AS[1]);});});AM={act:"applyAttributeLinking",srcAttrId:AN,srcFormId:AL.join(A),tgtAttrId:AJ.join(A),tgtFormId:AO.join(A),unlink:true};V.call(AG,AM,AK.controller.getRefreshCallback(),{style:{params:{treesToRender:3}}});});}function P(AI){if(!this.docModel){return false;}var AH=0,AG=2;O.forEach(this.docModel.datasets,function(AJ){if(AH>=AG){return false;}h.forEach(AJ.att,function(AK){if(AK.did===AI){AH++;return false;}});});return AH>=AG;}function c(AI,AJ){var AG={isLinked:false,isId:false},AH=P.call(this,AI.did);if(AI.t===AB.Attribute){if(AH){return{isLinked:true,isId:true};}if(AJ){Z(AJ);h.forEach(AI.fs,function(AK){if(AC(AJ,AI.did,AK.fid)){AG={isLinked:true,isId:!!AK.idf};return false;}});}}return AG;}function u(AI,AG){var AH=0;h.forEach(AG,function(AJ){if(h.find(AJ.att,"did",AI.did)>=0){AH++;}});return AH>=2;}function U(AN,AJ,AL){var AI=mstrmojo.all[AJ.panelId].data,AG=AJ.docModel,AK=[{3072:true,3077:true}],AM=function(AQ,AP){var AO=false;if(AQ.st===AP.st){AO=true;}else{AK.some(function(AR){if(AR[AQ.st]&&AR[AP.st]){AO=true;return true;}});}return AO;},AH=[];O.forEach(AI,function(AO){h.forEach(AO.mx.concat(AO.att),function(AP){if(AP.did!==AL.did&&AP.t===AL.t&&AM(AP,AL)&&!AP.hide&&h.find(AH,"did",AP.did)===-1){AH.push(AP);}});});if(AH.length===0){return ;}AH=q.getSortedDatasetUnits(AH);AN.addEditorMenuItem(mstrmojo.desc(11490,"Replace Reference With"),"",function(){return new mstrmojo.ui.menus.EditorConfig({data:{},cssClass:"replaceReference",okVisible:false,cancelVisible:false,contents:[{scriptClass:"mstrmojo.ui.ScrollableContainer",children:[{scriptClass:"mstrmojo.vi.ui.InteractiveUnitList",draggable:false,CLS_HAS_MENU:"",items:AH,listHooks:{select:function AO(AP,AQ){var AR={act:"applyReconciliation",is_rr:true,members:[{srcid:AL.did,srct:AL.t,tgtid:AQ.did,tgtt:AQ.t}]};AG.submitDataDefnUpdate(AG.addUpdateObjects(AR,{id:AQ.did,type:AQ.t,flag:AD.DATA_CHANGE}),z.wrapMethods(AG.getDatasetsUpdateCallback(),AG.controller.getPartialUpdateCallback()),mstrmojo.DocDataService.REQUEST_DEFN_DATA);}}}]}]});});}function v(){return mstrApp.rootCtrl.docCtrl;}function o(AL,AN,AH,AK){if(AN.t===AB.Metric){var AJ=v(),AM=AJ.model.getDataService(),AG,AI={dsid:AL._dsetId,alias:AN.alias||AN.n},AO=null;if(AH==="edit"){AG={metricId:AN.did,metric:AN,editorId:AK,action:{cmd:"edit",n:AN.n}};AI.did=AN.did;AO=AM.getEditDerivedMetricSubmitFunc(AI);}else{AG={metricId:"",editorId:AK,action:{cmd:AH,refOi:{did:AN.did,n:AN.n}}};AO=AM.getAddNewDerivedMetricToDatasetSubmitFunc(AI);}if(AJ.model.isFromSolrCube(AN.did)||AJ.model.isFromMDXCube(AN.did)){AG.disableAFB=true;}AJ.openDME(AL,AG,AO);}}function AF(AK,AH){var AN=this.ctxt,AM=AH.parentNode,AL=new mstrmojo.WaitIcon({placeholder:AM.appendChild(document.createElement("span")),markupString:'<span id="{@id}" class="mstrmojo-WaitIcon {@cssClass}" style="{@cssText}"></span>',cssText:"z-index:1; position:absolute; top:0;; right:3px;"});AL.render();if(AN.t===AB.Attribute&&AN.da){var AJ=v(),AI={dsid:AK._dsetId,did:AN.did,n:AN.n,forms:AN.fs};var AO=function(AP){AL.set("visible",AP);};var AG=AI.forms||[];if(J(AN)){AJ.openDynamicLinkEditor(AK,AI,AO);}else{AJ.openDAE(AK,AI,AO);}}}function r(AK,AI){var AH=AK.docModel,AG=AH.controller,AM=AK._dsetId,AL=[];var AJ=[];AI.forEach(function(AP){var AN=AP.did,AO=AP.t;if(AO===4&&AP.um){AL.push({act:"removeDerivedMetricFromDataset",dsid:AM,metricId:AN});}else{if(AO===12&&AP.da){AL.push({act:"removeDAFromDS",dsid:AM,attrId:AN});}else{if(AP.st===12033){AL.push({act:"removeNDEFromDS",dsid:AM,oid:AN});}else{AL.push({act:"removeBaseUnitFromDataset",dsid:AM,unitId:AN,unitType:AO});}}}AJ.push({id:AN,type:AO,flag:AD.DATA_CHANGE});});return function(){AG.cmdMgr.execute({execute:function(){this.submit(AL,AG.getRefreshCallback(),mstrmojo.DocDataService.REQUEST_DEFN_DATA);},urInfo:{treesToRender:3,undo:function(){this.urInfo.puObjs=AJ;this.urInfo.callback=z.wrapMethods(AH.getDatasetsUpdateCallback(),{success:function(AN){if(AN.pukeys){AH.getRebuildCallback().success(AN);}}});},redo:function(){this.urInfo.puObjs=null;this.urInfo.callback=AG.getRefreshCallback();}}});};}function F(AG){if(mstrApp.isInVFConfigMode){return false;}return AG.every(function(AH){return(AH.t===AB.Metric&&AH.um)||(AH.t===AB.Attribute&&AH.da)||AH.st===12033;});}function n(){var AG=this.docModel,AH=AG.getSelectedViUnit().getZonesModel();return z.wrapMethods(AG.getDatasetsUpdateCallback(),{success:function(AK){if(AK.pukeys){var AI=AK.pukeys&&AK.pukeys.split("\u001E"),AL=AG.getUnitDefinitions(AI),AM=AG.partialUpdate(AK.data,AL,AK.defn,AI),AJ=Object.keys(AL).filter(function(AN){return Object.keys(AM.def).indexOf(AN)===-1;});AJ.forEach(function(AQ){var AO=AG.getWidgetId({k:AQ,wid:1}),AP=AO&&mstrmojo.all[AO],AN;while(AP){AN=AP.defn;if(AN&&AN.t===mstrmojo.EnumRWUnitType.PANEL&&AP.setDirty){AP.setDirty(true);break;}AP=AP.parent;}});}}},AG.getUpdateHiddenLayoutsCallback(),AH&&AH.getUpdateCallback());}function AE(AG,AI,AH){return{success:function(){var AN=mstrmojo.all[AG],AQ=AN.getDatasetPanel(AH),AM=AQ.ulist,AK=AQ.tableView,AL=AQ.mdxView;var AP=function AP(AR){return !!h.filterOne(AR.items,function(AS){return AS.did===AI;});};if(AK){h.filterOne(AK.tbl.children,function(AR){AM=AR.tulist;return AP(AM);});}else{if(AL){h.forEach(AL.dimensions.children,function(AS){var AR=AS.recursiveAttributes;if(AP(AR)){AM=AR;return false;}h.forEach(AS.multiLevelHierarchies.children,function(AT){var AU=AT.levels;if(AP(AU)){AM=AU;}return !AM;});return !AM;});if(!AM&&AP(AL.derivedObjects)){AM=AL.derivedObjects;}if(!AM&&AP(AL.metricFolder.metrics)){AM=AL.metricFolder.metrics;}if(!AM){h.filterOne(AL.metricFolder.folders.children,function(AR){AM=AR.metrics;return AP(AM);});}}}var AO=h.filterOne(AM.items,function(AR){return AR.did===AI;});if(AO){var AJ=AO._renderIdx;AM.singleSelect(AJ);AM._getItemNode(AJ).scrollIntoView();}}};}function w(AI,AJ,AH,AL){var AG=AI.docModel,AK;if(AJ.t===AB.Metric&&AJ.um){AK={act:"updateDerivedMetricOnDataset",dsid:AL,did:AJ.did,name:AH};}else{if(AJ.t===AB.Attribute&&AJ.da){AK={act:"updateDA",dsid:AL,attrId:AJ.did,name:AH};}else{if(AJ.t===AB.Consolidation&&AJ.st===12033){AK={act:"applyDEChanges",deId:AJ.did,attId:AJ.attId,actions:[{act:"updateDeObject",name:AH}]};}else{AK={act:"editDocUnitProp",dsid:AJ.t===AB.Metric?AL:null,unitId:AJ.did,unitType:AJ.t,prop:f,value:AH};}}}V.call(AI,AG.addUpdateObjects(AK,{id:AJ.did,type:AJ.t,flag:AD.FORMAT_CHANGE}),z.wrapMethods(n.call(AI),AE(AI.panelId,AJ.did,AL)),mstrmojo.DocDataService.REQUEST_DEFN_DATA);}function k(AJ,AP,AM,AL,AG){var AQ=AP.t===AB.Metric,AK=AQ?O.copyProps([AL],AJ.docModel.datasets,{}):AJ.docModel.datasets,AH=AQ?"mx":"att",AN=[],AI=[],AO=function(){w(AJ,AP,AM,AL);};O.forEach(AK,function(AT){var AS=false,AR=false;h.forEach(AT[AH],function(AU){if(AU.did===AP.did){AS=true;}else{if(AU.t===AP.t&&AU.n===AM){AR=true;}}});if(AR){if(AS){AN.push(AT.name);}else{AI.push(AT.name);}}});if(AN.length){mstrmojo.alert(mstrmojo.desc(11650,'Cannot rename: "##" already exists in dataset ###.').replace("###",AN.join(", ")).replace("##",AM),AG,mstrmojo.desc(1388,"Rename"));return ;}if(AI.length){mstrmojo.warn(mstrmojo.desc(11654,'"##" already exists in dataset ###. Do you want to proceed?').replace("###",AI.join(", ")).replace("##",AM),{confirmBtn:{fn:AO},cancelBtn:{fn:AG}},{title:mstrmojo.desc(1388,"Rename")});return ;}if((AP.t===AB.Metric&&AP.um)||(AP.t===AB.Attribute&&AP.da)||(AP.t===AB.Consolidation)){q.validateName(AM,AO,AG);}else{AO();}}function p(AI,AG){var AH=h.filter(AI.items,function(AJ){return h.find(AG,"did",AJ.did)<0;});AI.clearSelect();AI.set("items",AH);}function AA(AJ,AI){var AL=[],AH=AJ.docModel,AK=AJ._dsetId,AG=function(AM){return AH.getToggleHiddenObjectAction(AK,AM,true);};h.forEach(AI,function(AM){AL.push(AG(AM));});return function(){p(AJ,AI);V.call(AJ,AL,AH.getDatasetsUpdateCallback(),t);};}function L(AG){return{act:"addShortcutMetric",funcType:AG.formType===2?e.FunctionSum:e.FunctionCount,units:[{id:AG.did,type:AG.t}],prs:[{n:"UseLookupForAttributes",v:"0"}]};}function b(AJ,AI){var AG=true,AK,AH;h.forEach(O.keyarray(AI),function(AL){AK=AI[AL];AH=AK.att.concat(AK.mx);if(h.find(AH,"did",AJ)!==-1&&q.hasCGorCon(AK)){AG=false;return false;}});return AG;}function J(AH){var AG=AH.fs||[];return AH.t===AB.Attribute&&AH.da&&AG.length===2&&AG[1].bftp===E.DssXmlBaseFormHTMLTag&&AG[1].fnm==="DYNAMICLINK";}mstrmojo.vi.ui.DocDatasetUnitList=mstrmojo.declare(mstrmojo.vi.ui.DatasetUnitList,null,{scriptClass:"mstrmojo.vi.ui.DocDatasetUnitList",docModel:null,addMenuProp:true,multiSelect:true,useListModKeys:true,getItemTooltip:function(AH,AI){var AG=M.position(AI);return O.copy({cssClass:"vi-regular vi-tooltip-C",posType:mstrmojo.tooltip.POS_TOPLEFT,top:AG.y-2,left:AG.x+AG.w+6},this._super(AH,AI));},hasTooltipContent:function(AG,AH){return true;},tooltipOpenDelay:Q,showMultiSelectionMenu:function X(AI,AK,AG){var AM=new mstrmojo.ui.menus.MenuConfig({supportsScroll:true,isHostedWithin:false,alignWithAnchor:true,maxHeight:M.getMaxScrollHeight()}),AN=this.id,AH=this.docModel,AJ=q.getMultiSelectionShortcutMetricFunctions(AI),AL=AI.filter(function(AO){return AO.t===AB.Attribute||AO.t===AB.Metric||AO.t===AB.Filter||AO.t===AB.Consolidation;});if(!mstrApp.isInVFConfigMode&&AJ&&AJ.length&&mstrmojo.resolveFeature(Y.INSERT_NEW_METRIC)){AM.addSubMenuItem(mstrmojo.desc(5188,"Calculation"),"",AN,function(){return q.getMultipleMetricsCalculationMenus(AI,mstrmojo.all[AN]._dsetId,function(AO){AH.addShortcutMetric(AO,AH.getDatasetsUpdateCallback());});});AM.addSeparator();}if(AL.length>0&&!mstrApp.isInVFConfigMode){q.insertAddUnitToFilterMenu(AM,this.docModel,AL);}AM.addMenuItem(mstrmojo.desc(1995,"Hide"),"",AA(this,AI));if(F(AI)&&((this.dataset.set.att||[]).length+(this.dataset.set.mx||[]).length)>AI.length){AM.addMenuItem(mstrmojo.desc(629,"Delete"),"",r(this,AI));}this.configurePopup(AM,AK);AM.position=AG;if(AM.hasMenuItems()){this.openPopup(AM.newInstance());}},ondragstart:function m(AG){this.isIgnoreTooltipCloseDelay=true;this.hideTooltip();if(this._super){this._super(AG);}},showItemMenu:function I(Ab,AH,Ah){var AM=this._dsetId,Af=this,Aa=Af.docModel,AV=Aa.controller,AX=new mstrmojo.ui.menus.MenuConfig({position:Ah,isHostedWithin:false,supportsScroll:true,alignWithAnchor:true,maxHeight:M.getMaxScrollHeight()}),AW=Af.id,AK=mstrmojo.vi.ui.DatasetUnitMenuUtils.getHighlightElementHandler,AR=function(){return q.getCreateTimeDAEditorCfg(Ab,function(Aj){for(var Ai in Aj){Aj[Ai].act="addDAToDataset";Aj[Ai].dsid=AM;}V.call(mstrmojo.all[AW],Aj,Aa.getDatasetsUpdateCallback(),t);});},Ag=this.dataset.set,AT=Ag.st===779,AL=Ab.t===AB.Attribute&&Ab.st===3076,Ae=J(Ab),AZ=Aa.isMDXDataset(Ag),AN=Aa.isDDADataset(Ag),AP=Aa.isSparkDataset(Ag),AU=Aa.isDatasetFromPushApi(Ag);if(Ab.t===AB.Attribute){if(!mstrApp.isInVFConfigMode){if(Ab.da&&!(AN&&AZ)){AX.addMenuItem(mstrmojo.desc(3224,"Edit..."),"",function(){AF.call(this,Af,AH);},Ab);AX.addSeparator();}if(!Ab.da&&mstrmojo.resolveFeature(Y.INSERT_NEW_METRIC)){AX.addMenuItem(mstrmojo.desc(13236,"Duplicate as Metric"),"",function(){V.call(mstrmojo.all[AW],[O.copy(L(Ab),{dsid:AM})],Aa.getDatasetsUpdateCallback(),t);},Ab);}}if(!q.isCGorCon(Ab,Ag)&&!AL&&!Ae&&mstrmojo.resolveFeature(Y.INSERT_NEW_METRIC)){AX.addEditorMenuItem(mstrmojo.desc(9918,"Data Type"),AW,function(){return q.getConfDataTypeMenuCfg(Aa,Ab,AM,function(Ak,Ai){var Aj;if(Ak){Aj={act:"addDAToDataset",isTokenStream:true,dsid:AM,forms:Ai,name:Ab.n};}else{Aj={act:"updateDA",isTokenStream:true,dsid:AM,attrId:Ab.did,update:Ai};}V.call(Af,Aa.addUpdateObjects(Aj,{id:Ab.did,type:Ab.t,flag:AD.DATA_CHANGE}),z.wrapMethods(Aa.getDatasetsUpdateCallback(),AV.getPartialUpdateCallback()),mstrmojo.DocDataService.REQUEST_DEFN_DATA);});},Ab);if(!mstrApp.isInVFConfigMode&&!(AN&&AZ)&&!Ae&&mstrmojo.resolveFeature(Y.INSERT_NEW_METRIC)){AX.addMenuItem(mstrmojo.desc(13625,"Create Attribute..."),"",function(){v().openDAE(Af,{dsid:AM},mstrmojo.emptyFn,Ab);},Ab);AX.addMenuItem(mstrmojo.desc(14717,"Create Links..."),"",function(){v().openDynamicLinkEditor(Af,{dsid:AM},mstrmojo.emptyFn,Ab);},Ab);}}AX.addSeparator();}else{if(Ab.t===AB.Metric&&!mstrApp.isInVFConfigMode){if(Ab.um){AX.addMenuItem(mstrmojo.desc(3224,"Edit..."),"",function(){o.call(this,Af,this.ctxt,"edit");},Ab);AX.addSeparator();}if(!Ab.um&&!Ab.rdm&&b(Ab.did,Aa.datasets)&&!Aa.isMDXDataset(this.dataset.set)&&mstrmojo.resolveFeature(Y.INSERT_NEW_METRIC)){AX.addMenuItem(mstrmojo.desc(13235,"Duplicate as Attribute"),"",function(){var Aj=Ab.dt,Ai=(Aj===l.DataTypeDouble||Aj===l.DataTypeFloat||Aj===l.DataTypeReal),Al=function(An){var Ao=[],Am={v:mstrmojo.ME.MetricToken.brackets(Ab.n),tp:266,lv:1,oi:{did:Ab.did,t:Ab.t,n:Ab.n}};Ao.push({v:"!",tp:33,lv:4});if(An){Ao.push({v:"Round2(",tp:"2",lv:1});Ao.push(Am);Ao.push({v:mstrConfig.listSep+"2)",tp:"2",lv:1});}else{Ao.push(Am);}Ao.push({v:"",tp:-1,lv:4});return mstrmojo.ME.AttributeEditBox.getTokenStreamXML({items:Ao});},Ak={act:"addDAToDataset",dsid:AM,isTokenStream:true,forms:[{bft:E.convertDataType2BaseFormType(Aj),formula:Al(Ai)}],name:Ab.n};V.call(Af,Ak,Aa.getDatasetsUpdateCallback(),t);},Ab);}if(Aa.findDatasetIdFromUnit(Ab.did)&&!Aa.isFromSolrCube(Ab.did)&&!Aa.isFromMDXCube(Ab.did)&&mstrmojo.resolveFeature(Y.INSERT_NEW_METRIC)){AX.addSubMenuItem(mstrmojo.desc(11806,"Aggregate By"),"",AW,function(){var Ai=D(Af,Ab,AM);return Ai;});}AX.addSeparator();if(mstrmojo.resolveFeature(Y.INSERT_NEW_METRIC)){AX.addEditorMenuItem(mstrmojo.desc(5188,"Calculation"),AW,function(){return C(Af,Ab,AM);},Ab);AX.addMenuItem(mstrmojo.desc(13624,"Create Metric..."),"",function(){o.call(this,Af,this.ctxt,"editNew");},Ab);AX.addSeparator();}}else{if(!mstrApp.isInVFConfigMode&&Ab.t===AB.Consolidation&&Ab.st===12033){AX.addMenuItem(mstrmojo.desc(13296,"Edit Groups..."),"",function(){AV.openDEEditor(Af,{dsId:AM,attId:null,attName:null,deObj:Ab,elemId:null,dispName:Ab.n,fromDatasetPanel:true});},Ab);AX.addSeparator();}}}var AS=[1,2,8,9,11];if(Ab.t===AB.Metric||(Ab.t===AB.Attribute&&!Ae&&(Ab.fs||[]).some(function(Ai){return AS.indexOf(Ai.bftp)!==-1;}))){AX.addEditorMenuItem(mstrmojo.desc(13237,"Number Format"),AW,function(){var Ak=function(Al){V.call(Af,Aa.addUpdateObjects(Al,{id:Ab.did,type:Ab.t,flag:AD.FORMAT_CHANGE}),n.call(Af),mstrmojo.DocDataService.REQUEST_DEFN_DATA);};if(Ab.um){var Ai=function Aj(Am){var Ao=["Format","Category","DecimalPlaces","ThousandSeparator","CurrencySymbol","CurrencyPosition","NegativeNumbers"],An=null,Al={};O.forEach(Am,function(Aq,Ap){An=Ao.filter(function(Ar){return Ar.toLowerCase()===Ap.toLowerCase();})[0];if(An){Al[An]=Aq;}});return Al;};return q.getNumberFormatEditor(Ab,Ab.nf||{},function(Al){var Am={act:"formatDerivedMetric",dsid:AM,mid:Ab.did,format:{FormattingNumber:Ai(Al)}};Ak(Am);});}else{return q.getNumberFormatEditor(Ab,Ab.nf||{},function(Am){var Al=Aa.getNumberFormatAction(Ab.did,Ab.t,Am);if(Ab.t===AB.Metric){Al.datasetId=AM;Al.datasetType=Af.dataset.set.type;}Ak(Al);});}});AX.addSeparator();}if(Ab.t===AB.Attribute){if(!Ab.da&&Aa.allowManageDocumentDataset()&&(!AT||(AT&&Aa.hasPrivilegesForAllTables(this.dataset.set.tables)))&&!AN){var AO=h.filter(this.dataset.set.tables,function(Ai){return h.find(Ai.attRefs,"did",Ab.did)!==-1;}),AG=this.dataset.set.mngd,Ad;if(AO&&AO.length>0){Ad=function(){return q.getMarkGeoRoleEditorCfg(Aa,Ab,AM,AG,AO,function(Aj,Ai){if(Ai){Aa.getDataService().submitUpdates(Aj,AV.getRefreshCallback());}else{Aa.getDataService().submitUpdates(Aa.addUpdateObjects(Aj,{id:Ab.did,type:Ab.t,flag:AD.DATA_CHANGE}),z.wrapMethods(Aa.getDatasetsUpdateCallback(),AV.getPartialUpdateCallback()),mstrmojo.DocDataService.REQUEST_DEFN_DATA);}});};if(Ad()&&!Aa.isFromSolrCube(Ab.did)&&!(mstrApp.isSingleTier&&Ag.hcs)){var AJ=-2147483648,AQ=true,AY=h.filter(Ab.fs,function(Ai){return(Ai.bftp===2||Ai.bftp===3)&&(Number(Ai.der&2147483648)!==AJ);});for(i=0;i<AY.length;i++){if(AY[i].fnm==="Latitude"||AY[i].fnm==="Longitude"){AQ=false;break;}}AQ=AQ&&!AP&&!AU;if(AQ){AX.addEditorMenuItem(mstrmojo.desc(13526,"Define Geography"),AW,Ad,Ab);}else{AX.addDisabledMenuItem(mstrmojo.desc(13526,"Define Geography"),"");}}}}if(!mstrApp.isInVFConfigMode&&!(AN&&AZ)&&!q.isCGorCon(Ab,Ag)&&AR()&&mstrmojo.resolveFeature(Y.INSERT_NEW_METRIC)){AX.addEditorMenuItem(mstrmojo.desc(12701,"Create Time Attributes"),AW,AR,Ab);}AX.addSeparator();}if(Aa.allowManageDocumentDataset()&&!Ae){R(AX,Af,Ab);N(AX,Af,Ab);if(Ab.t===AB.Attribute&&u(Ab,this.dataset.set.tables)){var Ac=mstrmojo.all[this.panelId],Ag=this.dataset.set;if(this.dataset.set.hcs!==true&&!AP){AX.addMenuItem(mstrmojo.desc(13173,"Unmap Attributes..."),"",function(){a(Af);});}}AX.addSeparator();}U(AX,Af,Ab);if((!mstrApp.isInVFConfigMode)&&(Ab.t===AB.Attribute||Ab.t===AB.Metric||Ab.t===AB.Filter||Ab.t===AB.Consolidation)){q.insertAddUnitToFilterMenu(AX,Aa,Ab);}if(Ab.t===AB.Attribute||(Ab.t===AB.Metric)||Ab.t===AB.Filter||Ab.t===AB.Consolidation||Ab.t===AB.Dimension){var AI=this.getLabelNode(this.getItemNodeFromTarget(AH));AX.addMenuItem(mstrmojo.desc(1388,"Rename"),"",function(){q.renameItem(AI,Ab,function(Ai){var Aj=Ab.n,Ak=function(){Ai.set("text",Aj);},Al=!Ai.allowTrimming?Ai.text:Ai.text.trim();k(Af,Ab,Al,AM,Ak);},{allowEmptyText:true,allowTrimming:false,cssClass:AI.className});},Ab);AX.addMenuItem(mstrmojo.desc(1995,"Hide"),"",AA(Af,[Ab]));if(F([Ab])&&((this.dataset.set.att||[]).length+(this.dataset.set.mx||[]).length)>1){AX.addMenuItem(mstrmojo.desc(629,"Delete"),"",r(Af,[Ab]));}}this.configurePopup(AX,AH);AX.addPopupHandlers("highlight",AK(true,AH),AK(false,AH));AX.position=Ah;this.openPopup(AX.newInstance());},doItemSelect:function(AR,AQ){var AJ=AQ.hWin,AM=AQ.e,AI=mstrmojo.all[this.panelId],AH=M.isMetaKey(AJ,AM),AN=M.shiftKey(AJ,AM),AP=AI.getPanelSelectedItems(),AG=AP[0]&&AP[0].ulist.dataset.set.did,AL=this.dataset.set.did,AK=AG&&AG!==AL,AO=AP.some(function(AS){return AS.ulist!==this;},this);if(AO){if(AN){if(!this.getSelectedItems().length){return ;}}else{if(AH){if(AK){return ;}}else{AI.getDatasetPanel(AG).clearSelect();}}}this._super(AR,AQ);},getItemMarkup:function K(AG){if(!g){g=this._super(AG).replace("</{@tag}>",'<div class="mark"></div></{@tag}>');}return g;},getItemProps:function j(AJ,AG){AJ.useAvailGeoFmsOnly=true;var AI=this._super(AJ,AG),AH=c.call(this,AJ,this.docModel.als);if(AJ.t===AB.Attribute&&AH.isLinked){if(!AH.isId){AI.addCls("noId");}AI.addCls("isAttrLink");}AI.addCls(AJ.ne?"hilight":"");AJ.ne=false;if(AJ.t===AB.Consolidation&&AJ.st===W.ConsolidationManaged&&AJ.ndetype===B.DssRecursiveDerivedElement){AI.addCls("nde4ra");}return AI;},deleteItem:function G(AG){var AH=this.dataset;window.alert('Delete item "'+(AG.n||AG.did)+'" from dataset "'+((AH&&AH.id)||"unknown")+'".');},doubleClickItem:function d(AG){v().model.getSelectedViUnit().getZonesModel().addUnitsFromDataSource([AG],this._dsetId);},twoClicksItem:function S(AJ,AG){if(AJ.t===AB.Attribute||(AJ.t===AB.Metric)||AJ.t===AB.Filter||AJ.t===AB.Consolidation||AJ.t===AB.Dimension){var AI=this,AK=this._dsetId;var AH=this.getLabelNode(this.getItemNodeFromTarget(AG.getTarget()));q.renameItem(AH,AJ,function(AL){var AM=AJ.n,AN=function(){AL.set("text",AM);},AO=!AL.allowTrimming?AL.text:AL.text.trim();k(AI,AJ,AO,AK,AN);},{allowEmptyText:true,allowTrimming:false,cssClass:AH.className});}}});}());(function(){mstrmojo.requiresCls("mstrmojo.array","mstrmojo.hash","mstrmojo.Editor","mstrmojo.Label","mstrmojo.Button","mstrmojo.mstr.EnumNodeDimty","mstrmojo.vi.ui.ConditionWalk","mstrmojo.fe.FilterUtils","mstrmojo.expr");mstrmojo.requiresDescs(15540);var I=mstrmojo.array,M=mstrmojo.hash,R=mstrmojo.Button.newWebButton,G=mstrmojo.mstr.EnumNodeDimty,P=I.hash([G.NodeDimtyUnspecified,G.NodeDimtyNone]),B=mstrmojo.fe.FilterUtils,J=mstrmojo.expr,Q=J.ET;mstrmojo.vi.ui.ConditionEditor=mstrmojo.declare(mstrmojo.Editor,null,{scriptClass:"mstrmojo.vi.ui.ConditionEditor",cssClass:"mstrmojo-vi-ui-ConditionEditor",help:"Creating_a_Metric_Qualification.htm",title:mstrmojo.desc(15540,"Edit Qualification"),objectBrowsingEnabled:false,targets:null,targetsLastMod:null,ets:null,condition:null,model:null,hasPrompt:false,disableElementsBrowsing:null,inRelation:null,editor:null,children:[{scriptClass:"mstrmojo.Box",markupString:'<div id="{@id}" class="mstrmojo-Box {@cssClass}" style="{@cssText}"></div>',cssDisplay:"inline-block",cssClass:"conditionBar",model:null,alias:"conditionBar",bindings:{model:"this.parent.model"},update:function(){var E=this.model,U=B.getExprNodeHtmlAndText(E.data?E.data:E,{emptyText:mstrmojo.desc(15413,"Qualification Details"),elemsEmpty:" "});if(this.containerNode){this.containerNode.innerHTML=U.html;this.containerNode.title=U.text;}}},{scriptClass:"mstrmojo.vi.ui.ConditionWalk",alias:"walk",dimtyTypes:P,delegateUpdateOkBtn:function D(V){var E=this.parent,W=E&&E.btnHbox,U=W&&W.okBtn;if(U){U.set("enabled",!!V);}},onOK:function O(){var U=this.condition,E=this.editor;E.onConditionEdit(U,this.model.get());},close:function L(){var E=this.condition;if(E&&E.isEmpty()){E.del();}},postmodeledit:function H(E){this.parent.updateConditionBar();},getIfDataSource:function S(){return this.parent.getIfDataSource();},onUpdateBrowseElementsParams:function N(E){this.parent.onUpdateBrowseElementsParams(E);},getDatasets:function F(){return this.parent.getDatasets();}}],buttons:[R(mstrmojo.desc(1442,"OK"),function(){var E=this.parent.parent;E.walk.onOK();E.close();},true,{enabled:true,alias:"okBtn"}),R(mstrmojo.desc(221,"Cancel"),function(){var E=this.parent.parent;E.close();})],updateConditionBar:function A(){this.conditionBar.update();},open:function K(V,E){this._super(V,E);var U={objectBrowsingEnabled:this.objectBrowsingEnabled,targets:this.targets,targetsLastMod:this.targetsLastMod,ets:this.ets,condition:this.condition,hasPrompt:this.hasPrompt,disableElementsBrowsing:this.disableElementsBrowsing,disableHierarchyLevel:this.disableHierarchyLevel,inRelation:this.inRelation,editor:this.editor};M.copy(U,this.walk);if(!(this.disableElementsBrowsing&&this.disableElementsBrowsing())){this.model.defaultETAttr=Q.AE;}this.walk.set("model",this.model);this.updateConditionBar();},onClose:function C(){this.walk.close();},getDatasets:mstrmojo.emptyFn,getIfDataSource:mstrmojo.emptyFn,onUpdateBrowseElementsParams:mstrmojo.emptyFn});}());(function(){mstrmojo.requiresCls("mstrmojo.vi.models.editors.BaseEditorModel","mstrmojo.imagelayout.ImageLayoutEditorHelper","mstrmojo.locales");mstrmojo.requiresClsP("mstrmojo.ui.editors.controls","CharacterGroup","ContainerGroup","TwoColumnContainer","ColorPickerButton","LineStyleButton","FillConfigGroup");var K=mstrmojo.hash,X=mstrmojo.array,m=mstrmojo.func,p=mstrmojo.locales,F=mstrmojo.VisEnum.IMAGELAYOUT_PROPERTIES,k=mstrmojo.gm,Z=k.EnumIdentityType,a=mstrmojo.imagelayout.ImageLayoutEditorHelper,J=mstrmojo.ui.editors.controls.FillConfigGroup.CTRL_FLAGS;var C="de",b="lgd",I="rcl",V="dl";var h="allTxt",A="dl",Q="lg",P=Q+"Bg",d="shape",M="shapeBorder",S="@",E="selBdrMtxLn4";function W(r,q,u,t){r.slot="col1Node";q.slot="col2Node";return this.addDisposable(new mstrmojo.ui.editors.controls.TwoColumnContainer({col1Width:u||"40%",col2Width:t||"60%",children:[r,q]}));}function n(q,t,r,v){var u=this.addDisposable(a.getPulldown(t,v.fnChange||function(w){r.onTargetSelectionChanged(q,w);if(this._sync){return ;}},0,v));r.registerSelector(q,u);return u;}function e(){var r=this.broker.vis,q=r.zonesModel.getZoneModelByZoneId(mstrmojo.vi.viz.EnumDSSDropZones.ColorBy).items;return this.getLabelAndControl(mstrmojo.desc(6242,"Color"),this.addDisposable(new mstrmojo.Label({text:mstrmojo.desc(13174,"Select color ranges..."),cssText:"text-decoration: underline;cursor: pointer;",onclick:function(){r.model.openThresholdEditor(q[0],true,false);}})),"30%","70%");}function j(){var z=this.getHost(),t=this.broker,w=this.getGroupTitle(mstrmojo.desc(13751,"Shape Formatting")),v,u,x,AA=[w],q=t.getSmartNamesMapForColorFormat(d),r=t.getSmartNamesMapForLineGroup(M);if(z.getColorByIndex()>=0){v=e.call(this);u=this.addDisposable(this.getLabelAndControl(mstrmojo.desc(13658,"Fill Opacity"),a.getFillConfigComp(z,null,q,{visibleControls:J.FILL_TRANSPARENCY}),"60%","40%"));x=this.addDisposable(this.getLabelAndControl(mstrmojo.desc(3538,"Border Style"),a.getLineConfigComp(z,null,r,{hideColorControl:true,showNoFillInColor:false,showAutomaticInColor:true}),"60%","40%"));AA=AA.concat([v,u,x]);}else{u=a.getFillConfigComp(z,mstrmojo.desc(13601,"Fill:"),q,{controlName:"shapeFormattingFillGroup",showGradient:false});x=a.getLineConfigComp(z,null,r,{lineTitle:mstrmojo.desc(9736,"Border")});AA=AA.concat([u,x]);}return AA;}function H(){var v=this.getHost(),q=v.propertyManager,x=q.CONSTANTS.DISPLAY_MODE,u=F.DISPLAY_MODE,t=this.getGroupTitle(mstrmojo.desc(4963,"Display Mode")),r=a.getPropertyPulldown(v,null,[{n:mstrmojo.desc(6019,"Automatic"),v:x.AUTOMATIC},{n:mstrmojo.desc(9738,"Area"),v:x.AREA},{n:mstrmojo.desc(348,"Bubble"),v:x.BUBBLE}],u,{listenFormatProps:["enableDisplayMode"],onFmtPropsChanged:function(z,AA){if(z==="enableDisplayMode"){this.set("enabled",!!AA);}else{this.onFmtPropsChangedDefault(z,AA);}}}),w=[t,r];return w;}function l(){var v=this.getHost(),t=v.propertyManager,u=F.MAP_FILE_PATH,r=this.getGroupTitle(mstrmojo.desc(14446,"Shape File")),q=a.getPropertyPulldown(v,null,X.map(v._shapeFileList,function(z){var x=z.descWeb,AA=x?mstrmojo.desc(parseInt(x.slice(x.indexOf(".")+1),10),z.name):z.name;return{n:AA,v:z.shapeFile};}),u,{listenFormatProps:["isMultipleIL"],onFmtPropsChanged:function(x,z){if(x==="isMultipleIL"){this.set("enabled",!z);}else{this.onFmtPropsChangedDefault(x,z);}}}),w=[r,q];return w;}function G(w){var AA=this.getHost(),u=AA.propertyManager,z=u.CONSTANTS.DATA_LABEL,t=[{n:mstrmojo.desc(1013,"Text"),v:z.SHOW_TEXT},{n:mstrmojo.desc(2175,"Values"),v:z.SHOW_VALUE},{n:mstrmojo.desc(2057,"None"),v:z.NONE}],r=F.DATA_LABEL_SWITCH,v=this.broker,q=this.getGroupTitle(mstrmojo.desc(11993,"Data Labels")),x=a.getPropertyButtonBar(AA,null,t,r,{multiSelect:true,cssClass:"dataLabel "+("itemsCnt"+t.length),onFmtPropsChangedDefault:function(AD,AE){this.syncControl(function(){if(AE===z.NONE){this.singleSelectByField(AE,"v");}else{this.select((this.items||[]).map(function(AG,AF){return(AE&AG.v)>0?AF:null;}).filter(function(AF){return AF!==null;}));}});},postselectionChange:function(AD){if(this._sync){return ;}var AG=AD.added&&this.items[AD.added[0]].v,AE=(AG===z.NONE),AF=AD.removed&&(this.items[AD.removed[0]].v===z.NONE),AH=!this.selectedIndices||(this.selectedIndices&&!this.selectedIndices[0]&&!this.selectedIndices[1]);if(AF){if(AH){if(!this.selectedIndices[2]){this.addSelect(2);}}return ;}if(AE){X.forEach([0,1],function(AI){if(this.selectedIndices[AI]){this.removeSelect(AI);}}.bind(this));}else{if(AH){if(!this.selectedIndices[2]){this.addSelect(2);}}else{if(this.selectedIndices[2]){this.removeSelect(2);}}AG=t.reduce(function(AK,AJ,AI){return this.selectedIndices[AI]?AK|=AJ.v:AK;}.bind(this),0);}this.broker.setFormatPropertyValue(this.smartNames[0],AG);}}),AC=a.getCharacterConfigComp(AA,null,v.getSmartNamesMapForFontGroup(A),{controlName:"DataLabelFontGroup",listenFormatProps:[r],onFmtPropsChanged:function(AD,AE){if(AD===r){this.set("enabled",AE!==z.NONE);}else{this.onFmtPropsChangedDefault(AD,AE);}}}),AB=[q,x,AC];return AB;}function Y(){var AI=this.getHost(),x=AI.propertyManager,AD=x.CONSTANTS.EnumMaxSizeType,AB=x.CONSTANTS.EnumMinSizeType,q=(AI.calculateSizeByIndex()>-1),z=p.number.DECIMALSEPARATOR,r={trigger:mstrmojo.validation.TRIGGER.ONBLUR,min:0.01,max:1,regExp:new RegExp("^\\d+("+z+"\\d{1,2})?$")},v=this.addDisposable(new mstrmojo.Label({text:mstrmojo.desc(13918,"Max size (0.01 - 1.0):")})),w=this.addDisposable(new mstrmojo.Label({text:mstrmojo.desc(13917,"Min size (0.01 - 1.0):")})),AH=this.addDisposable(new mstrmojo.Label()),u=mstrmojo.desc(13740,"The smallest element's size is ## of the largest element's size");var AF=x.CONSTANTS.DISPLAY_MODE,AA=x.getFormatPropertyValue(F.DISPLAY_MODE)===AF.BUBBLE;var AE=F.MAX_SIZE_TYPE,AC=F.MIN_SIZE_TYPE,t=W.call(this,a.getPropertyPulldown(AI,null,[{n:mstrmojo.desc(6019,"Automatic"),v:AD.AUTO},{n:mstrmojo.desc(8262,"Manual"),v:AD.MANUAL}],AE,{listenFormatProps:["calcDisplayMode"],onFmtPropsChanged:function(AJ,AK){if(AJ==="calcDisplayMode"){this.parent&&this.parent.set("enabled",AK!==AF.AREA&&q);}else{this.onFmtPropsChangedDefault(AJ,AK);}}}),a.getPropertyValidationTextBox(AI,null,F.MAX_SIZE_VALUE,{constraints:r,listenFormatProps:[AE],onFmtPropsChanged:function(AJ,AK){if(AJ===AE){this.set("enabled",AK===AD.MANUAL);}else{this.onFmtPropsChangedDefault(AJ,AK);}}}),"75%","25%"),AG=W.call(this,a.getPropertyPulldown(AI,null,[{n:mstrmojo.desc(11990,"Proportional"),v:AB.PROPORTIONAL},{n:mstrmojo.desc(13741,"Full Range"),v:AB.AUTO},{n:mstrmojo.desc(14118,"Adjusted Range"),v:AB.MANUAL}],AC,{listenFormatProps:["calcDisplayMode"],onFmtPropsChanged:function(AJ,AK){if(AJ==="calcDisplayMode"){this.parent&&this.parent.set("enabled",AK!==AF.AREA&&q);}else{this.onFmtPropsChangedDefault(AJ,AK);if(AK===AB.PROPORTIONAL){AH.set("text",mstrmojo.desc(13743,"The smallest element's size is proportional to its data element"));}else{if(AK===AB.AUTO){AH.set("text",mstrmojo.desc(13744,"The smallest element's size is fixed, independent of its data value"));}}}}}),a.getPropertyValidationTextBox(AI,null,F.MIN_SIZE_VALUE,{constraints:r,listenFormatProps:[AC],onFmtPropsChanged:function(AJ,AL){if(!q){this.set("enabled",false);return ;}if(AJ===AC){var AK=AL===AB.MANUAL;this.set("enabled",AK);if(AK){AH.set("text",u.replace("##",this.value*100+"%"));}}else{this.onFmtPropsChangedDefault(AJ,AL);if(this.enabled){AH.set("text",u.replace("##",AL*100+"%"));}}}}),"75%","25%");this.addDisposable([t,AG]);return[v,t,w,AG,AH];}function o(){var v=this.getHost(),t=v.propertyManager,r=this.broker,u=E,q=u+S;var w=this.getGroupTitle(mstrmojo.desc(12050,"Matrix Lines"));return[w,n.call(this,u,[{n:mstrmojo.desc(11998,"All Matrix Lines"),prefix:"allMatrixLn",identity:(Z.H_MATRIX_LINE|Z.V_MATRIX_LINE),v:0},{n:mstrmojo.desc(11999,"Horizontal Matrix Lines"),prefix:"hMatrixLn",identity:Z.H_MATRIX_LINE,v:1},{n:mstrmojo.desc(12000,"Vertical Matrix Lines"),prefix:"vMatrixLn",identity:Z.V_MATRIX_LINE,v:2}],t,{highlightObjects:[(Z.H_MATRIX_LINE|Z.V_MATRIX_LINE),Z.H_MATRIX_LINE,Z.V_MATRIX_LINE],groupTitle:w}),a.getLineConfigComp(v,null,r.getSmartNamesMapForLineGroup(u+S),{listenSelector:[u],listenFormatProps:["allMatrixLnClr","allMatrixLnCmbStyle"],lineTitle:mstrmojo.desc(13927,"Line:"),controlName:"MatrixLineGroup",groupTitle:w,showNoFillInColor:false,showGradient:false})];}function L(r){var q=[this.getEditorGroup(H.call(this)),this.getEditorGroup(l.call(this)),this.getEditorGroup(Y.call(this))];this.replaceChildControls(r,q);}function B(r){var q=[this.getEditorGroup(o.call(this))];this.replaceChildControls(r,q);}function U(r){var q=[this.getEditorGroup(j.call(this)),this.getEditorGroup(G.call(this))];this.replaceChildControls(r,q);}function D(r,t){m.override({showPickerForCurrentMode:function q(){this._super();if(this.pickerMode===2&&typeof this.color!=="object"){var u=this.gradientOrientation;u.set("selectedIndex",X.find(u.items,"id",0));}}},r.colorPicker);}function R(w){var AA=this.getHost(),t=F.LEGEND_SHOW,v=this.broker,x=function(AC,AE){if(AC===t){var AD=this.parent,AB=this;if(AD&&AD.scriptClass==="mstrmojo.ui.editors.controls.TwoColumnContainer"){AB=AD;}AB.set("enabled",!!AE);}else{this.onFmtPropsChangedDefault(AC,AE);}},u=a.getPropertyCheckBox(AA,mstrmojo.desc(13600,"Show legend"),t),q=a.getCharacterConfigComp(AA,null,v.getSmartNamesMapForFontGroup(Q),{controlName:"LegendFontGroup",listenFormatProps:[t],onFmtPropsChanged:x}),z=this.addDisposable(new mstrmojo.Label({text:mstrmojo.desc(13601,"Fill:")})),r=a.getFillConfigComp(AA,null,v.getSmartNamesMapForColorFormat(P),{controlName:"LegendBackgroundFillGroup",listenFormatProps:[t],onFmtPropsChanged:x});mstrmojo.css.addWidgetCssClass(u,"title");this.replaceChildControls(w,[this.getEditorGroup([u,q,z,r])]);}mstrmojo.vi.models.editors.ImageLayoutEditorModel=mstrmojo.declare(mstrmojo.vi.models.editors.BaseEditorModel,null,{scriptClass:"mstrmojo.vi.models.ImageLayoutEditorModel",help:"format_panel_image.htm",broker:null,init:function(q){this._super(q);this.broker=this.getHost().propertyManager;var r=this.getHost();r.switchToPanelListener=r.attachEventListener("switchToPanel",this.id,function(t){var u=t.panelID;if(u!==undefined){this.switchPanelByValue(u);}});r.switchTargetSelectorListener=r.attachEventListener("switchTargetSelector",this.id,function(t){var u=t.selName,v=t.value;this.switchTargetSelector(u,v);});},getInitialTarget:function g(){return C;},getTargetPulldownItems:function c(q){var t=this._super(q),r=this.getHost(),u=function(w){this.broker.clearRegisterFormatControl();return w.bind(this,q);}.bind(this),v=function(w){this.broker.clearRegisterFormatControl();return function(){var x=this.getHost();x.getShapeFileListWithXHR(w.bind(this,q));}.bind(this);}.bind(this);if(r.excludeData){return t;}t.unshift({n:mstrmojo.desc(11974,"Data Exploration"),v:C,h:v(L)});t.push({n:mstrmojo.desc(11978,"Rows and Columns"),v:I,h:u(B)});t.push({n:mstrmojo.desc(13757,"Shapes and Data Labels"),v:V,h:u(U)});if(r.hasSizeByOrColorByThs()){t.push({n:mstrmojo.desc(2403,"Legend"),v:b,h:u(R)});}return t;},getEditorGroup:function O(q,r){if(!this._super){return new mstrmojo.vi.ui.editors.EditorGroup(K.copy(r,{children:q}));}return this.addDisposable(this._super(q,r));},switchPanelByValue:function(q){if(this.initializing){return ;}this.selectTargetByValue(q);},switchTargetSelector:function(r,t){if(this.initializing){return ;}var q=this.broker,u=q.getTargetSelector(r);if(u.selectItemByField){u.selectItemByField("v",t);}},detachListeners:function N(){var q=this.getHost();if(q.switchToPanelListener){q.detachEventListener(q.switchToPanelListener);delete q.switchToPanelListener;}if(q.switchTargetSelectorListener){q.detachEventListener(q.switchTargetSelectorListener);delete q.switchTargetSelectorListener;}},destroy:function f(q){this.detachListeners();if(this._super){this._super(q);}delete this.broker;}});}());(function(){mstrmojo.requiresCls("mstrmojo.hash","mstrmojo.array","mstrmojo.dom","mstrmojo.vi.ui.rw._HasVisSelections","mstrmojo.css","mstrmojo.chart.model.enums.EnumDSSObjectType","mstrmojo.vi.models.editors.XtabEditorModel","mstrmojo.elementHelper");var Y=mstrmojo.css,R=mstrmojo.hash,I=mstrmojo.dom,N=mstrmojo.array,A=mstrmojo.chart.model.enums.EnumDSSObjectType,X=mstrmojo.elementHelper,Z=mstrmojo.vi.models.editors.XtabEditorModel.ENUM_EDITOR_TARGETS,b={cssClass:"grpHlt",top:"grpT",bottom:"grpB",left:"grpL",right:"grpR",midHoriz:"grpMidH",midVert:"grpMidV"},H=function(h,g){var e=this.zone;g=g||(e&&e.tableNode);if(g){var f=[],j=g.tBodies,k=function(n,m){var p=n.length,l=-1,o;while(p-l>1){if(n[o=p+l>>1].getAttribute("ei")<m){l=o;}else{p=o;}}return(n[p]&&parseInt(n[p].getAttribute("ei"),10)===m)?n[p]:null;};N.forEach(h,function(m){var p=m._ei,n;for(n=0;n<j.length;n++){var l=j[n],o=k(l.getElementsByClassName(m.css),p);if(o){f.push(o);}}});return f;}return[];},E=function(e){var g=this.model.getCellDataUnion(e),f={};N.forEach(g,function(h){f[h.tid]=[{id:h.eid,n:h.v}];});return f;},d=function(k){var j=k[R.keyarray(k)[0]],e=R.keyarray(j),g,h=this,f=this.model,l={};return H.call(this,N.filter(this.interactiveCellsArray,function(n){if(n.hasOwnProperty("mix")){var o=E.call(h,n);g=N.filter(e,function(p){var q=f.getLinkedAttributes(p),r=false;if(!!o[p]){l[p]=p;r=true;}else{N.forEach(q,function(t){if(!!o[t]){l[p]=t;r=true;return false;}});}return r;});var m=false;R.forEach(k,function(p){N.forEach(g,function(q){if(!f.compareElementsId(o[l[q]][0].id,p[q][0].id)){m=false;return false;}m=true;});if(m){return false;}});return m;}return false;}));},C=function(k,o){var p=(function(){var j=[];R.forEach(k,function(r){R.forEach(r,function(t,u){N.forEach(t,function(v){j.push([u,v.id]);});});});return j;}()),n,l=this,e=N.filter(this.interactiveCellsArray,function(r){n=false;var t=!r.hasOwnProperty("mix")&&r._e&&r.fi===undefined,j=!t&&E.call(l,r);if(t){N.forEach(p,function(u){if((!o||l.model.getCellTitleInfo(r).title.id===u[0])){n=l.model.compareElementsId(r._e.id,u[1]);}if(n){return false;}});}else{if(!o&&j){R.forEach(j,function(u){N.forEach(p,function(v){N.forEach((u||[]),function(w){if(w.id){n=l.model.compareElementsId(w.id,v[1]);}});if(n){return false;}});if(n){return false;}});}}return n;}),m=H.call(this,e),q=[],h,g,f;if(o){q=m;}else{N.forEach(m,function(j){h=e[N.find(e,"_ei",j.getAttribute("ei"))];if(h.axis===1){var u=0,t=j.rowSpan||1,r=j.parentNode;do{f=r.childNodes;for(g=0;g<f.length;g++){q.push(f[g]);}}while((++u<t)&&(r=r.nextSibling));}else{q.push(j);}});}return q;},M=function(j,f){if(!this.getFormatTargetFromCell){return[];}var h=this.getSubtotalFormatUseGridFormat(j),g=this.model;var k=this.id,e;return H.call(this,N.filter(this.interactiveCellsArray,function(l){e=mstrmojo.all[k].getFormatTargetFromCell(l)===j;if(f){return(e&&(l.stt===1||g.isSubtotalValue(l)));}if(!h){return(e&&!(l.stt===1||g.isSubtotalValue(l)));}return e;}));},L=function(g){var j=[],k;var h=this.getSubtotalFormatUseGridFormat(Z.COLUMNS);if(this.getFormatTargetFromCell){N.forEach(this.interactiveCellsArray,function(l){if(this.getFormatTargetFromCell(l)!==Z.COLUMNS){return false;}if((g&&l.stt===1)||(!g&&(h||(!h&&l.stt!==1)))){j.push(l);}return true;},this);}var f=this.xtabClonedNodes;if(f){var e=N.filterOne(f,function(l){return l.lockType===2;});if(e){k=e.domNode.getElementsByTagName("table")[0];}}return H.call(this,j,k);},J=function(e,f,h){var g=["xtabSel"].concat(I.isIE||I.isIEW3C?"ie":[],"sc_"+this.k);if(!f||h){g.push("range");}if(!f){g=g.concat(R.valarray(b));}Y.toggleClass(e,g,f);},S=function(e,f){var g=["XtabContextMenuSel"].concat(I.isIE||I.isIEW3C?"ie":[],"sc_"+this.k);Y.toggleClass(e,g,f);},P=function(f){var e=this;return H.call(this,N.filter(this.interactiveCellsArray,function(g){var h=e.model.getCellInfo(g);if(h.isHeader||h.isTitle){return false;}if(g.hasOwnProperty("mix")){if(f.target.id===g._tp._e.oid){var k=true;var j=e.model.getCellDataUnion(g);return !N.some(j,function(l){return f.parentElementIds.indexOf(l.eid)<0;});}}return false;}));},K=function(f){var e=this;return H.call(e,N.filter(e.interactiveCellsArray,function(g){var j=!g.hasOwnProperty("mix")&&g._e&&g.fi===undefined;if(j){if(f.target.id===g._e.id){var h=g;while(h.hasOwnProperty("_p")){if(f.parentElementIds.indexOf(h._p._e.id)<0){return false;}else{h=h._p;}}return true;}}return false;}));};mstrmojo.vi.ui.rw._XtabHighlights=mstrmojo.provide("mstrmojo.vi.ui.rw._XtabHighlights",{_mixinName:"mstrmojo.vi.ui.rw._XtabHighlights",highlights:null,contextMenuHighLights:null,highlight:function G(g,j,e){if(this._super){this._super.apply(this,arguments);}var h=mstrmojo.vi.ui.rw.SelectionType,f=[];this.clearHighlights();switch(g){case h.METRICS:f=d.call(this,j);break;case h.ATTS:f=C.call(this,j,e);break;}this.highlightCells(f,e);},highlightAttrOrMetricCell:function a(h){var g=this,e=[],f=mstrmojo.vi.ui.rw.SelectionType;this.clearHighlights();N.forEach(h,function(j){if(j.target.selectionType===f.ATTS){e=e.concat(K.call(g,j));}else{e=e.concat(P.call(g,j));}});this.highlightCells(e,false);},highlightRange:function c(g,k,e){var h=mstrmojo.vi.ui.rw.SelectionType,j=k?this.highlights.slice():null,f=[];this.clearHighlights();switch(g){case h.COL_HEADERS:f=L.call(this,e);break;case h.ROW_HEADERS:f=M.call(this,Z.ROWS,e);break;case h.METRIC_VALUES:f=M.call(this,Z.VALUES,e);break;}N.forEach(f,function(n){var m=true;if(j){var l=N.indexOf(j,n);m=l===-1;if(!m){j.splice(l,1);}}J.call(this,n,true,m);},this);this.highlights=f;},clearSelections:function D(){if(this._super){this._super();}this.clearHighlights();},clearCxtMnuSelection:function F(){if(this._super){this._super();}this.clearContextMenuHighlights();},clearHighlights:function B(){N.forEach(this.highlights,function(e){J.call(this,e,false);},this);this.highlights=[];try{var g=this.getCellForNode(this.lastSelectedCell),k=g&&this.gridData.gts[g.axis===1?"row":"col"],f=k&&k[g.tui||g.ui],h=f&&f.id;if(h){this.zone.clearHilites(h);}}catch(j){}},clearContextMenuHighlights:function W(){N.forEach(this.contextMenuHighLights,function(e){S.call(this,e,false);},this);this.contextMenuHighLights=[];},highlightCellsById:function Q(k,j,h){var g=this.model,e=function(l,m,n){return l[m]&&l[m]._e&&l[m]._e[n]===k;},f=H.call(this,N.filter(this.interactiveCellsArray,function(m){var l=false;if(j===A.DssTypeMetric){l=e(m,"_tp","oid")||e(m,"_lp","oid");}else{if(j===A.DssTypeAttribute){if(h){l=e(m,"_tp","id")||e(m,"_lp","id");}else{if(g&&g.getNormalizedFormElementId&&m._e&&m._e.id){l=X.getAttributeId(g.getNormalizedFormElementId(m._e.id))===k;}}}}return l;}));this.clearHighlights();this.highlightCells(f);},highlightCells:function(f,e){if(this._super){this._super(f,e);}N.forEach(f,function(g){J.call(this,g,true);},this);this.highlights=f;},highlightCellsWithContextMenuSelection:function(e){N.forEach(e,function(f){S.call(this,f,true);},this);this.contextMenuHighLights=e;},configureActions:function O(){if(this._super){this._super();}if(!!this.selectorControl&&!this.isCustomSort){this.highlight(this.getSelectionType(),this.getSelectionHash(),true);}},highlightGroupCells:function V(f,e){var g=this.highlights;N.forEach(f,function(j){var n=j[0]&&j[0].axis||1,o=(n===1),k=this[o?"clonedRowHeader":"clonedColHeader"],m=(k?k.getTableNode():this.zone.tableNode),l=H.call(this,j,m),h=l.length;g=g.concat(l);N.forEach(l,function(t,p){var r=b,q=[r.cssClass];if(h>1){if(o){q.push(p>0?(p<h-1?r.midVert:r.bottom):r.top);}else{q.push(p>0?(p<h-1?r.midHoriz:r.right):r.left);}}Y.addClass(t,q);},this);},this);this.highlights=g;},clearGroupHighlights:function U(){var e=R.valarray(b);N.forEach(this.highlights,function(f){Y.toggleClass(f,e,false);},this);}});mstrmojo.vi.ui.rw._XtabHighlights.GROUP_BORDER_CSS=b;}());(function(){mstrmojo.ngm.NewGMProperty=mstrmojo.declare(mstrmojo.gm.GMProperty,null,{scriptClass:"mstrmojo.ngm.NewGMProperty",init:function A(B){this._super(B);this.gm="NGM";}});mstrmojo.ngm.NGMCharacterGroup=mstrmojo.declare(mstrmojo.ui.editors.controls.ControlGroup,[mstrmojo.ui.editors.controls._HasCharacterGroup],{scriptClass:"mstrmojo.ngm.NGMCharacterGroup",init:function A(E){this._super(E);mstrmojo.css.addWidgetCssClass(this,"mstrmojo-ui-EditCharacter");var H=this,C=this.getHCGControls(function(J,K,I){if(!H._sync){H.raiseFormatValueChange(J,K,I);}}),D=[];Object.keys(C).forEach(function(I){this[I]=C[I];}.bind(this));var B=this.fontFamily,G=this.fontSize,F=this.fontColor;if(B){D.push(B);}if(G){G.slot="col1Node";F.slot="col2Node";D.push({scriptClass:"mstrmojo.ui.editors.controls.TwoColumnContainer",children:[G,F]});}if(D.length){this.addChildren(D);}}});}());(function(){mstrmojo.requiresCls("mstrmojo.array","mstrmojo.color","mstrmojo.expr","mstrmojo.Label","mstrmojo.vi.models.editors.BaseEditorModel","mstrmojo.vi.viz.EnumDSSDropZones","mstrmojo.vi.viz.MapHelper","mstrmojo.vi.util.ThresholdUtils","mstrmojo.ui.CheckList","mstrmojo.ui.editors.controls.ContainerGroup","mstrmojo.models.FormatModel","mstrmojo.chart.enums.EnumFontStyle","mstrmojo.gmaps.MapUtils","mstrmojo.gmaps.MapEnums","mstrmojo.gmaps.MapUtils","mstrmojo.gmaps._AreaMapHelper","mstrmojo.ui.editors.controls.FillConfigGroup","mstrmojo.ui.editors.controls.LineConfigGroup","mstrmojo.gm.GMEnums","mstrmojo.hash","mstrmojo.VisUtility","mstrmojo.gm.GMUtility","mstrmojo.gmaps.MapColorUtils","mstrmojo.num");mstrmojo.requiresDescs(8068,6030,6031,13254,13256,13255,11849,11850,11851,11852,11853,11854,11855);mstrmojo.requiresDescs(7736,8068,8102,8069,9237,2797,8958,8764,8765,13254,13256,11845,11846,11847);mstrmojo.requiresDescs(7674,15745,15746,15747,15748,15749,15750);var k=mstrmojo.vi.viz.EnumDSSDropZones,R=mstrmojo.array,Z=mstrmojo.hash,Ae=mstrmojo.color,Ai=mstrmojo.expr.DTP,q=mstrmojo.emptyFn,BK=mstrmojo.vi.viz.MapHelper,Aq=mstrmojo.vi.util.ThresholdUtils,Av=mstrmojo.gmaps,Q=mstrmojo.VisUtility,AL=Av.MapUtils,AX=Av.EnumBaseMapType,O=Av.EnumGraphicType,A9=Av.EnumMarkerType,Ac=Av.EnumClusterMode,AT=Av.EnumPropertyType,Az=Av.EnumMaxSizeType,AC=Av.EnumMinSizeType,AD=Av.EnumGeographicRole,AK=Av.EnumZoomBehavior,H=Av.EnumDataLabel,BB=Av.EnumShapeFormatting,A1=Av.EnumDefaultShapeFormatStyle,AG=mstrmojo.models.FormatModel.ENUM_PROPERTY_NAMES,BG=mstrmojo.chart.enums.EnumFontStyle,Ay=Av.EnumDataLabelShowOption,BJ=mstrmojo.gmaps.EnumLayerZoneSource,BH=Av._AreaMapHelper,A5=Av.TARGET_MAPOPTIONS,W=mstrmojo.ui.editors.controls.FillConfigGroup.CTRL_FLAGS,AV=mstrmojo.ui.editors.controls.AdvancedColorPicker,N=0,x=1,AZ=Av.ENABLE_MAX_MIN_SIZE_CONTROL,Al=mstrmojo.gm.GMUtility,Y=Av.MapColorUtils,m=mstrmojo.num;var e="Clr";var M=["not used",mstrmojo.desc(13743,"The smallest element's size is proportional to its data element"),mstrmojo.desc(13744,"The smallest element's size is fixed, independent of its data value"),mstrmojo.desc(13740,"The smallest element's size is ## of the largest element's size")];var V=1,p=2,Ak=4;var AA=[AX.Google,AX.Esri];var Aj="colorByColorChangeHandlers";var AF=[BB.SHAPE_FORMAT_FILL_COLOR,BB.SHAPE_FORMAT_BORDER_COLOR];function c(BM,BQ,BP,BO){var BN=this[BM];if(BN===undefined){this[BM]={};BN=this[BM];}BN[BQ]={fn:BP,context:BO};}function L(){var BM=this.getEditingGridData()||{},BN=Q.getPropertyByPath(BM,"gts.row",[]),BP=Q.getPropertyByPath(BM,"gts.col",[]),BO=BN.concat(BP);return BO;}function u(BO,BN){function BM(BQ){var BR=BQ.value;return(BR===undefined||BR==="")&&BO.getEditingPropertyVal(BN)===undefined;}return{onInvalid:function BP(){if(BM(this)){if(this.hasRendered){this.clearValidation();}return ;}if(this.hasRendered){mstrmojo.ui.editors.controls.ValidationTextBox.prototype.onInvalid.call(this);}},onRender:function(){if(BM(this)){this.clearValidation();}}};}function Ax(BR,BP,BN,BM){if(!BR){return ;}var BT=this;function BQ(BZ){return Object.keys(R.hash(R.ensureArray(BZ)));}var BU=BR.listenFormatProps||[],BW=BR.listenSelector||[];(BR.smartNames||[]).forEach(function(BZ){R.insert(BU,null,BZ);});BR.listenFormatProps=BQ(BU);BR.listenSelector=BQ(BW);var BY=BR;if(typeof BP==="string"){var BO=(BN===x),BS=BO?"14px":"30%",BV=BO?"100%":"70%";if(BM){BS=BM[0];BV=BM[1];}BY=this.getLabelAndControl(BP,BR,BS,BV,BO);BR.label=BY.getLabel();if(BO){BY.cssClass="checkLabel multiLine";BR.label.onclick=function BX(){BR.onclick();};BR.label.cssDisplay="inline-block";}else{if(BN===N){BY.cssClass="characterGroup";}}}BR.getCtrlContainer=function(){return BY;};return BY;}E:function E(BM){var BN=this;return function(BQ){var BP=BN.getHost(),BO=BP.getEditingGridKey();BP.writeProperties(BM,BQ,BO);};}function t(BM){var BN=this;return function(BO){var BP=BN[BM]||{},BR=BO.type==="*"?Object.keys(BP):[].concat(BO.type),BQ;BR.forEach(function(BS){if(BP.hasOwnProperty(BS)){BQ=BP[BS];BQ.fn.call(BN,BO,BQ.context);}});};}mstrmojo.vi.models.editors.MapEditorModel=mstrmojo.declare(mstrmojo.vi.models.editors.BaseEditorModel,null,{scriptClass:"mstrmojo.vi.models.MapEditorModel",vizUnit:null,propertyEditor:null,help:"format_panel_map.htm",editingProperty:null,defaultShapeId:null,colorBySub:null,baseMapOptionsControls:null,mapStyleControl:null,graphicLayersControl:null,graphicLayerOptionsControls:null,onPropertiesChanged:function Ab(BN,BT){var BS=this.getHost(),BR,BP,BM,BO,BQ=this;if(BN===AT.graphicType){BR=L.call(BS);BP=BS.getEditingGridData()||{};BM=BP.vp;BO=BM&&BM.gtp;if(BO!==BT){BS.zonesModel.addAttributeNameAndTargetVisForAddUnits(BP,BR,undefined,BT,undefined);BS.zonesModel.checkAndWarnLargeItemsForAddUnits(BR,function(){BQ.editingProperty=BN;BS&&BS.writeProperties(BN,BT);});}}else{if(BT===AV.VAL_AUTOMATIC&&AF.indexOf(BN)>=0){BT=undefined;}if(BS){BS.writeProperties(BN,BT);}}},getActionsWithUpdateProperty:function Ah(BN){var Bc=this.getHost(),BR=Bc&&Bc.getEditingHost(),BP=[],Bb=Bc&&Bc.zonesModel.getZonesCfg(),BX=this,BS,Ba,BY,BQ,BW,BV;if((this.editingProperty!==AT.graphicType)||!BR||!Bb){return BP;}BY=BR.zonesModel;BQ=BR.model&&BR.model.data;if(!BQ||!BY){return BP;}BW=BQ.vp;R.forEach(Bb,function(Bd){if(!Bd.show(BW)){BP=BP.concat(BX.getRemoveUnitAction(Bd.id,BY));}});if(BN===O.Area){BV=Bc.getEditingDropZoneItems(k.GeoAttribute);if(BV&&BV[1]){BP=BP.concat(BY.getRemoveDropZoneUnitActions({id:k.GeoAttribute},BV[1]));}}Ba=BW&&BW[AT.graphicType];BS=BQ.datasetId;BP=BP.concat(this.getAddFormUnitAction(k.Latitude,BS,BA,A2,Ba,BY));BP=BP.concat(this.getAddFormUnitAction(k.Longitude,BS,BA,K,Ba,BY));if(AR.call(this,Ba)){var BU=BY.getZoneModelByZoneId(k.ColorBy),BO=!!BU?BU.items[0]:{},BZ=BQ.gsi&&BQ.gsi.thresholds,BM=BZ&&BO&&BZ[BO.did],BT=false;if(BM&&(BM.length>0&&BM[0].rtp===4)){BT=true;}if(BT){Aq.addThresholds(BR.model,BR,BR.node,BO,BP,null,null,true);}}return BP.length>0?R.ensureArray(BY.getUpdateTemplateAction(BP)):[];},getRemoveUnitAction:function As(BM,BP){if(!BP){return[];}var BO=this.getHost(),BN=BO&&BO.getEditingDropZoneItems(BM),BR=[];if(BN&&BN.length>0){var BQ={did:BN[0].id,t:BN[0].t};BR=BR.concat(BP.getRemoveDropZoneUnitActions({id:BM},BQ));}return BR;},getAddFormUnitAction:function l(BO,BQ,BX,BM,BV,BU){var BP=[],BW=this.getHost(),BS=BW&&BW.zonesModel,BT,BR,BN;if(!(BX.call(this,BV,BO))||!BU||!BS){return BP;}BS.getDropZones();BT=BS.getZoneModelByZoneId(k.GeoAttribute);BR=!!BT?BT.items[0]:{};BN=BM.call(this,BR);if(BU&&BN){BP.push({act:"addForm",unitId:BR.did,attFormId:BN.fid,unitPos:1});BP=BP.concat(BU.getAddDropZoneUnitsActions({id:BO},[{did:BN.fid,t:21}],0,{datasetId:BQ}));}return BP;},getMapViewer:function Ao(){var BM=this.getHost();return BM&&BM.mapViewer;},getEditingPropertyVal:function h(BN){var BM=this.getHost();return BM&&BM.getPropertyValue(BN);},getDensityTheme:function AO(){var BM=this.getEditingPropertyVal(AT.themeType);BM=parseInt(BM,10);return isNaN(BM)?1:BM;},getAreaShape:function C(){return this.getEditingPropertyVal(AT.shapeFile);},getBaseMapTypes:function Ar(){var BN=this.getHost(),BM=[];if(!BN){return ;}if(BN.hasGooglePlugin()){BM.push({n:mstrmojo.desc(14744,"Google"),id:AX.Google});}else{R.removeItem(AA,AX.Google);}if(BN.isESRIKeyValid()){BM.push({n:mstrmojo.desc(14745,"Esri"),id:AX.Esri});}else{R.removeItem(AA,AX.Esri);}if(AA.indexOf(AX.Mapbox)!==-1){BM.splice(0,0,{n:mstrmojo.desc(15301,"Mapbox"),id:AX.Mapbox});}if(AA.indexOf(AX.Image)!==-1){BM.push({n:mstrmojo.desc(2922,"Image"),id:AX.Image});}return BM;},getMapStyles:function J(){var BN=this.getMapViewer(),BM=BN&&BN.baseLayer;return BM&&BM.getMapStyles();},getMapRedrawTypes:function AU(){return[{id:AK.Keep,n:mstrmojo.desc(7982,"Static")},{id:AK.Automatic,n:mstrmojo.desc(15251,"Dynamic")}];},shouldRemoveAreaOption:function(){return AL.isSingleTier()&&!AL.isWSLiveMode()&&this._getBaseMapType()===AX.Google;},getGraphicTypes:function AP(){var BM=[{n:mstrmojo.desc(13254,"Marker"),id:O.Marker},{n:mstrmojo.desc(348,"Bubble"),id:O.Bubble},{n:mstrmojo.desc(13255,"Area"),id:O.Area},{n:mstrmojo.desc(13256,"Density"),id:O.Density}];if(this.shouldRemoveAreaOption()){BM.splice(2,1);}return BM;},getMarkerTypes:function BF(){return[{n:mstrmojo.desc(11837,"Pins"),id:A9.Pin},{n:mstrmojo.desc(154,"Squares"),id:A9.Square},{n:mstrmojo.desc(14746,"Diamonds"),id:A9.Diamond},{n:mstrmojo.desc(14747,"Images"),id:A9.Image}];},getMarkerClusteringTypes:function AQ(){return[{n:mstrmojo.desc(6030,"On"),id:Ac.ON},{n:mstrmojo.desc(344,"Pie"),id:Ac.PIE},{n:mstrmojo.desc(6031,"Off"),id:Ac.OFF}];},getBubbleClusteringTypes:function AH(){return[{n:mstrmojo.desc(6030,"On"),id:Ac.ON},{n:mstrmojo.desc(6031,"Off"),id:Ac.OFF}];},getDensityThemes:function A6(){return[{id:1,cls:"rainbow",title:mstrmojo.desc(9234,"Rainbow")},{id:2,cls:"fire",title:mstrmojo.desc(9235,"Fire")},{id:3,cls:"sunrise",title:mstrmojo.desc(9236,"Sunrise")},{id:4,cls:"desert",title:mstrmojo.desc(9237,"Desert")},{id:5,cls:"brick",title:mstrmojo.desc(9238,"Brick")}];},getAreaShapes:function AN(){var BW=this.getHost(),BO=[],BM,BR,BS,BQ,BT,BU,BP,BX,BN,BV;if(!BW){return BO;}BM=BW.getEditingGridData();BR=BW.getEditingGridProps();BS=BW.getEditingDropZoneItems(k.GeoAttribute);R.forEach(BS,function(BY){BV=BY.id;return false;});if(!BV||BV.length===1){BR.lid="";this.defaultShapeId=null;return null;}BT=BH.getShapeAttributeGeoRole(BM,BV)||AD.EnumGeographicRoleNone;BQ=BW.getBaseMapType();BU=BW.getMapConfig();BP=BU&&BU.common;BX=BU&&BU.esri;if(BQ===AX.Esri&&BX&&parseInt(BX.useESRICloud,10)!=1){return null;}if(BP){BN=BH.getAvailableShapes(BP.shapes,BP.layers,BT,BQ);BO=this.getShapeOptions(BN,BQ);}this.loadDefaultShape(BN,BT);return BO;},_getBaseMapType:function b(){var BM=this.getHost();return BM&&BM.getBaseMapType();},getShapeOptions:function A0(BM,BQ){var BU=[{id:"-----",n:mstrmojo.desc(11290,"Please select")}],BP,BN,BT,BS,BR;if(!!BM){for(BN=0,BT=BM.length;BN<BT;BN++){BP=BM[BN];if(BP){BS=BP.desc;if(BQ===AX.Mapbox&&BP.descWeb){try{BR=parseInt(BP.descWeb.substring(8));if(!isNaN(BR)){BS=mstrmojo.desc(BR,BS);}}catch(BO){}}BU.push({id:BP.id,n:BS});}}}return BU;},loadDefaultShape:function d(BM,BN){this.defaultShapeId=null;var BO=BH.getMatchingShape(BM,null,BN);if(!!BO){this.defaultShapeId=BO.id;}},getBaseMapTypeSelectedIndex:function X(){var BN=this.getEditingPropertyVal(AT.baseMapType),BM=AA.indexOf(BN);if(BM!==-1){return BM;}},getMapStyleSelectedIndex:function Au(BU){var BP=this.getEditingPropertyVal(AT.mapStyle),BM=BU||this.getMapStyles(),BR=-1,BO=this.getMapViewer(),BS=BO&&BO.baseLayer,BN,BQ,BT;if(!BS){return ;}if(BP!=undefined&&!!BM&&BM.length>0){for(BQ=0,BT=BM.length;BQ<BT;BQ++){BN=BM[BQ];if(BN.id==BP){BR=BQ;break;}}}return(BR!==-1)?BR:BS.getDefaultStyleIdx();},getMapRedrawSelectedIndex:function w(){var BN=this.getEditingPropertyVal(AT.zoomSetting),BM=0;switch(BN){case AK.Keep:BM=0;break;case AK.Automatic:BM=1;break;default:break;}return BM;},getGraphicTypeSelectedIndex:function P(BN){var BM=0;switch(BN){case O.Marker:BM=0;break;case O.Bubble:BM=1;break;case O.Area:BM=2;break;case O.Density:BM=3;break;default:break;}if(this.shouldRemoveAreaOption()){if(BM===2){BM=-1;}else{if(BM>2){BM-=1;}}}return BM;},getMarkerTypeSelectedIndex:function AM(){var BN=this.getEditingPropertyVal(AT.markerType),BM=0;switch(BN){case A9.Pin:BM=0;break;case A9.Square:BM=1;break;case A9.Diamond:BM=2;break;case A9.Image:BM=3;break;default:break;}return BM;},getMarkerClusteringTypeSelectedIndex:function B(){var BN=this.getEditingPropertyVal(AT.clusterMode),BM=0;switch(BN){case Ac.ON:BM=0;break;case Ac.PIE:BM=1;break;case Ac.OFF:default:BM=2;break;}return BM;},getBubbleClusteringTypeSelectedIndex:function z(){var BN=this.getEditingPropertyVal(AT.clusterMode),BM=0;switch(BN){case Ac.ON:BM=0;break;case Ac.OFF:default:BM=1;break;}return BM;},getDensityThemeSelectedIndex:function f(){return this.getDensityTheme()-1;},getAreaShapeSelectedIndex:function g(){var BN=this.getAreaShapes(),BR=this.getAreaShape(),BQ=BN?BN.length:0,BP,BO,BM=0;for(BP=1;BP<BQ;BP++){BO=BN[BP];if(BO.id==BR){BM=BP;break;}}return BM;},getEditorContents:function D(BM){var BN=this.getHost();if(BN.editorContentReady===true){return this._super(BM);}else{return null;}},getDelayedEditorContents:function I(BM,BO){var BN=this.getHost();this.propertyEditor=BM;this.vizUnit=BO;BN.propEditorListener={listener:this,callback:this.updateEditorContent};},updateEditorContent:function BD(){if(this.vizUnit){var BM=this.propertyEditor;if(BM){BM.onVIUnitSelected(this.vizUnit);}}this.propertyEditor=null;this.vizUnit=null;},getContainerCtrlFlags:function AW(){return mstrmojo.ui.editors.controls.ContainerGroup.CTRL_FLAGS.BORDER;},getInitialTarget:function BL(){return A5;},getTargetPulldownItems:function Af(BN){var BQ=this._super(BN),BP=this.getHost(),BO=this,BM=function(){var BR=BO.getMapOptionControls;BO.replaceChildControls(BN,BR.call(BO));};if(BP.isBaseMapValid()&&!(BP.excludeData||BP.isEmpty())){BQ.unshift({n:mstrmojo.desc(13271,"Map Options"),v:A5,h:BM});}return BQ;},getTwoColumnContainer:function Aa(BM,BN){BM.forEach(function(BP,BO){BP.slot="col"+(BO+1)+"Node";});BN=Z.copy(BN,{col1Width:"50%",col2Width:"50%",children:BM});return new mstrmojo.ui.editors.controls.TwoColumnContainer(BN);},getBaseMapControls:function a(){var BN=[],BM=this.getBaseMapTypeControl();if(BM){BN.push(BM);}this.baseMapOptionsControls=this.getEditorGroup(this.getBaseMapOptionsControls(),{isNested:true,showDivider:false,isContainer:true});BN.push(this.baseMapOptionsControls);if(AL.enableZoomLevelAndPosSaving()){BN.push(this.getKeepZoomLevelandPosCtrl());}return this.getEditorGroup(BN,{isNested:true,showDivider:false,isContainer:true});},getBaseMapTypeControl:function Ad(){return this.fnGetPulldown(this.getBaseMapTypes(),this.getBaseMapTypeSelectedIndex(),mstrmojo.desc(14748,"Base map")+":",AT.baseMapType);},getKeepZoomLevelandPosCtrl:function An(){var BT=this,BV=this.getHost(),BS=BV&&BV.getProperties(),BR=BS[AT.zoomSetting]!==AK.Automatic,BP=AT.keepZoomAndPos,BM=BS[BP]===true||BS[BP]==="true",BQ=new mstrmojo.ui.Checkbox({checked:BM,oncheckedChange:function BN(BW){BT.onPropertiesChanged(BP,BW.value);}}),BO=this.getLabelAndControl(mstrmojo.desc(15743,"Remember zoom level"),BQ,"14px","100%",true,{enabled:BR}),BU=BO.getLabel();BU.onclick=function(){BQ.onclick();};return BO;},getGraphicLayersControls:function Ap(){var BM=[];if(!mstrApp.isInVFConfigMode){var BO=new mstrmojo.Label({text:"Layers",setDimensions:function(BR,BP){var BQ=this.domNode;if(BQ){BQ.style.width=BP;}}}),BN=this.getGraphicLayerListControl();BM=[BO,BN];}this.graphicLayerOptionsControls=this.getGraphicLayerOptionsControls();return this.getEditorGroup(BM.concat([this.graphicLayerOptionsControls]),{isNested:true,showDivider:true,isContainer:true});},getZoomControls:function A8(){return this.fnGetPulldown(this.getMapRedrawTypes(),this.getMapRedrawSelectedIndex(),mstrmojo.desc(15744,"Zoom behavior"),AT.zoomSetting,{isNested:true,showDivider:false,isContainer:true});},getBaseMapOptionsControls:function o(){var BM=this.getZoomControls();this.mapStyleControl=this.getMapStyleControls();return !this.mapStyleControl?[BM]:[this.mapStyleControl,BM];},getMapStyleControls:function A(){var BM=this.getMapStyles(),BN=this;if(this._getBaseMapType()===AX.Image){return new mstrmojo.ui.editors.controls.ValidationTextBox({required:true,validationDelay:120000,value:BM[0],hint:"image URL...",onValid:function(){var BO=BN.getHost();if(BO){BO.writeProperties(AT.mapStyle,this.value);}},updateText:function(BO){this.inputNode.value=BO;this.value=BO;}});}if(!!BM&&BM.length>0){return this.fnGetPulldown(BM,this.getMapStyleSelectedIndex(BM),mstrmojo.desc(13583,"Map style"),AT.mapStyle);}},getGraphicLayerListControl:function n(){var BM=this.getHost();if(BM&&BM.getLayerZoneControl instanceof Function){return BM.getLayerZoneControl(BJ.PROPERTY_PANEL);}},getClusteringControlForMarker:function A4(){return this.fnGetPulldown(this.getMarkerClusteringTypes(),this.getMarkerClusteringTypeSelectedIndex(),mstrmojo.desc(11841,"Clustering"),AT.clusterMode);},getClusteringControlForBubble:function v(){return this.fnGetPulldown(this.getBubbleClusteringTypes(),this.getBubbleClusteringTypeSelectedIndex(),mstrmojo.desc(11841,"Clustering"),AT.clusterMode);},getGraphicLayerOptionsControls:function BE(){var BN=[],BO=this.getEditingPropertyVal(AT.graphicType),BM=this.getEditingPropertyVal(AT.markerType);BN.push(this.fnGetPulldown(this.getGraphicTypes(),this.getGraphicTypeSelectedIndex(BO),mstrmojo.desc(2043,"Type"),AT.graphicType));switch(BO){case O.Marker:BN.push(this.fnGetPulldown(this.getMarkerTypes(),this.getMarkerTypeSelectedIndex(),mstrmojo.desc(2923,"Shape"),AT.markerType));BN.push(this.getClusteringControlForMarker());break;case O.Bubble:BN.push(this.getClusteringControlForBubble());break;case O.Area:BN.push(this.fnGetPulldown(this.getAreaShapes(),this.getAreaShapeSelectedIndex(),mstrmojo.desc(11842,"Boundaries"),AT.shapeFile));break;case O.Density:this.addDensityControls(BN);break;default:break;}if(BO&&(BO!==O.Density&&!(BO===O.Marker&&BM===A9.Image))){var BP=this.getShapeFormatControls(BO);if(BP){BN.push(BP);}}if(AZ&&BO===O.Bubble){BN.push(this.getMaxMinSizeControls());}if(BO&&BO!==O.Density){BN.push(this.getDataLabelControls());}this.addShowLegendControl(BN);return this.getEditorGroup(BN,{isNested:true,showDivider:false,isContainer:true});},getMoreOptionsControl:function Am(){var BN=this.getHost(),BM=BN&&BN.getEditingGridData();return this.getEditorGroup([this.getMoreOptionsEditorLink((BM&&BM.gsi&&BM.gsi.prop)||{})],{isNested:true,showDivider:true,isContainer:true});},addShowLegendControl:function j(BN){var BP=this.getHost(),BO=BP.getEditingGridKey(),BS=BP.getGraphicLayer(BO),BM=this.getEditingPropertyVal(AT.legendSwitch),BQ=this.getGroupTitle(mstrmojo.desc(2403,"Legend")),BR;if(BP.hasColorByOrSizeBy(BO)&&BS&&BS.isVisible()){BR=this.getCheckboxAndLabel(BM===true||BM==="true",mstrmojo.desc(12001,"Show Legend"),E.call(this,AT.legendSwitch));BN.push(this.getEditorGroup([BQ,BR],{isNested:true,showDivider:true,isContainer:true}));}},openMoreOptionsEditor:function BC(BP,BM,BQ){var BO=this.getHost();BO=BO&&BO.getEditingHost();var BN=this._super(BP,BM,BQ);if(BN&&BO){BN.set("host",BO);}},getMaxMinSizeControls:function A7(){var BT,BS,BN,BV,BX=this.getHost(),BU=BX.getEditingGridKey(),BR=BX.getProperties(BU),BO=BX.getGraphicLayer(),BM={trigger:mstrmojo.validation.TRIGGER.ALL,min:0.01,max:1,regExp:mstrmojo.locales.number.DECIMALSEPARATOR==="."?/^\d+(\.\d{1,2})?$/:/^\d+(\,\d{1,2})?$/},BW;if(!BO){return ;}BW=BO.enableMinSizeOption();function BQ(BY,BZ,Bg,Bb,Ba){function Bh(Bj){var Bk=BO.getMaxMinSizeValue(BZ,Bj);Be.set("enabled",Ba.textboxEnabled(Bj));Be.updateText(m.toLocaleString(Bk));var Bi=Ba.onSizeChanged;if(Bi instanceof Function){Bi(Bj,Bk);}BX.writeProperties(BY,Bj);}var Bd=BO.getMaxMinSizeType(BY),Bf=BO.getMaxMinSizeValue(BZ,Bd),Bc=this.getPulldown(Bb,Bh,!isNaN(Bd)?(Bd-1):0),Be=new mstrmojo.ui.editors.controls.ValidationTextBox({required:true,dtp:Ai.FLOAT,constraints:BM,validationDelay:1500,value:m.toLocaleString(Bf),enabled:Ba.textboxEnabled(Bd),onValid:function(){var Bk=Bc.getSelectedItem().v,Bj=m.parseNumeric(this.value);var Bi=Ba.onSizeChanged;if(Bi instanceof Function){Bi(Bk,Bj);}BX.writeProperties(BZ,Bj);},updateText:function(Bi){this.inputNode.value=Bi;this.value=Bi;}});return[new mstrmojo.Label({text:Bg}),this.getTwoColumnContainer([Bc,Be],{col1Width:"70%",col2Width:"30%"})];}function BP(BZ,BY){var Ba;BZ=parseInt(BZ);Ba=M[BZ];if(BZ===AC.ADJUSTED_RANGE){if(BY===undefined){BY=0.2;}Ba=Ba.replace("##",(BY*100).toFixed(0)+"%");}return Ba;}BT=BQ.call(this,AT.MAX_SIZE_TYPE,AT.MAX_SIZE_VALUE,mstrmojo.desc(13918,"Max size (0.01 - 1.0):"),[{n:mstrmojo.desc(6019,"Automatic"),v:Az.AUTOMATIC},{n:mstrmojo.desc(8262,"Manual"),v:Az.MANUAL}],{textboxEnabled:function(BY){return BY===Az.MANUAL;}});BS=BQ.call(this,AT.MIN_SIZE_TYPE,AT.MIN_SIZE_VALUE,mstrmojo.desc(13917,"Min size (0.01 - 1.0):"),[{n:mstrmojo.desc(11990,"Proportional"),v:AC.PROPORTIONAL},{n:mstrmojo.desc(13741,"Full Range"),v:AC.FULL_RANGE},{n:mstrmojo.desc(14118,"Adjusted Range"),v:AC.ADJUSTED_RANGE}],{textboxEnabled:function(BY){return BY===AC.ADJUSTED_RANGE;},onSizeChanged:function(BZ,BY){BN.set("text",BP(BZ,BY));}});BV=[].concat(BT,BS);if(!BW){BS.forEach(function(BY){BY.set("enabled",false);});}else{BN=new mstrmojo.Label({text:BP(BR[AT.MIN_SIZE_TYPE],BR[AT.MIN_SIZE_VALUE]),cssText:"line-height: 115%;"});BV.push(BN);}return this.getEditorGroup(BV,{isNested:true,showDivider:true,isContainer:true});},getColorByAttrControls:function AJ(Ba){var Bc=this,BT=this.getHost(),Be=BT&&BT.getGraphicLayer(),BN=this.colorBySub;if(!Be){return ;}var BO=0,BV=Be.getFormatColorByElements(),Bb="ShapeClr",BZ="ShapeFillTrans",BR=AV.VAL_AUTOMATIC,BS=BV.map(function(Bh,Bg){return{n:Bh.text,title:Bh.text,v:Bg};}),BM=Q.range(1,BS.length,1),BY,BX,Bd=t.bind(this),BP,BQ=false,BU=mstrmojo.desc(12092,"Multiple Elements");if(BN){BT.detachEventListener(BN);}this.colorBySub=BT.attachEventListener("colorByColorChange",this.id,Bd(Aj));BP=Y.cbSelectionToIndices(Be.getContextMenuColorBySelections(),BV);if(BP.length===0){BO=0;}else{if(BP.length===1){BO=BP[0];}else{BO=BP;BQ=true;}}function BW(){return[].concat(BO===0?BM:BO);}function Bf(Bh,Bg){function Bi(){var Bj,Bn,Bl,Bm;if(Bg===undefined){Bj=BW();Bn=[];R.forEach(Bj,function(Bo){Bn.push(BV[Bo]);});Bl=Y.getColorInfoForItemAll(Bn);this.setChildValue(Bb,Bl.color);this.setChildValue(BZ,Bl.opacity);}else{BO=Bg;Bm=BV[Bg];this.setChildValue(Bb,Bm.color);this.setChildValue(BZ,Bm.opacity);}var Bk=BW().some(function(Bo){return Q.isColorManuallySet(BT,BV[Bo].comb);});Q.setColorPickerShowAutomatic(this,Bk);}if(Bh){this.syncControls(Bi);}else{Bi.call(this);}}BY=new mstrmojo.ui.editors.controls.FillConfigGroup({showGradient:false,onGroupValueChange:function(Bh,Bi){var Bq=Bc.getHost(),Bn,Br=[],Bk=[],Bm=Bh===Bb,Bj=Bh===BZ,Bo=BW(),Bp=false,Bg,Bl;Bo.forEach(function(Bs){var Bu=BV[Bs],Bt=Bu.comb;Bk.push(Bt);if(Bm){if(Bi===BR){Br.push("default");Bp=true;}else{Br.push(Al.encodeColor(Bi));Bu.color=Bi;}}else{if(Bj){Br.push(Bi);Bu.opacity=Bi;}}});if(Bp){Bg=Bq.listenToUpdateColorMap(function(){var Bt=Bk.length,Bs;Bo.forEach(function(Bu){var Bv=BV[Bu];Bs=Al.decodeColor(Q.getCombColor(Bq,Bv.comb));Bv.color=Bs;});Bl=Y.getColorInfoForItemAll(BV.slice(1));BV[0].color=Bl.color;if(Bt>1){Bs=BV[0].color;}BY.syncControls(function(){this.setChildValue(Bb,Bs);Q.setColorPickerShowAutomatic(BY,false);});Bq.detachUpdateColorMapListener(Bg);});}if(Bm){Bq.updateColorMap(Bk,Br);Bl=Y.getColorInfoForItemAll(BV.slice(1));BV[0].color=Bl.color;Q.setColorPickerShowAutomatic(this,true);}if(Bj){Bn=Bq&&Bq.getGraphicLayer();if(!Bn){return ;}Bn.updateLayerColorByOpacity(Bk,Br);BV=Bn.getFormatColorByElements();}}});if(BY){BY.iniChildrenComp([Bb,BZ]);Bf.call(BY,true,BQ?undefined:BO);}c.call(this,Aj,"fill",function(Bg){BY.syncControls(function(){BY.setChildValue(Bb,Bg.fill);Q.setColorPickerShowAutomatic(BY,Bg.showAutomatic);});});c.call(this,Aj,"opacity",function(Bg){var Bi=Bc.getHost(),Bh=Bi&&Bi.getGraphicLayer();if(!Bh){return ;}BV=Bh.getFormatColorByElements();BY.syncControls(function(){BY.setChildValue(BZ,Bg.opacity);});});c.call(this,Aj,"invalidateCache",function(){BV.forEach(function(Bi,Bh){if(Bh===0){return ;}Bi.color=Al.decodeColor(Q.getCombColor(BT,Bi.comb));});var Bg=Y.getColorInfoForItemAll(BV.slice(1));BV[0].color=Bg.color;});c.call(this,Aj,"opacityFullUpdate",function(){var Bg,Bi=Bc.getHost(),Bh=Bi&&Bi.getGraphicLayer();if(!Bh){return ;}BV=Bh.getFormatColorByElements();if(BO>=0){Bg=BV[BO].opacity;BY.syncControls(function(){BY.setChildValue(BZ,Bg);});}});c.call(this,Aj,"colorFullUpdate",function(){var Bg,Bi,Bj=Bc.getHost(),Bh=Bj&&Bj.getGraphicLayer();if(!Bh){return ;}BV=Bh.getFormatColorByElements();if(BO>=0){Bg=BV[BO].color;Bi=BW().some(function(Bk){return Q.isColorManuallySet(Bj,BV[Bk].comb);});BY.syncControls(function(){BY.setChildValue(Bb,Bg);Q.setColorPickerShowAutomatic(BY,Bi);});}});BX=this.getPulldown(BS,Bf.bind(BY,true),BQ?undefined:BO,{setDisplayText:function(Bg){var Bh=this.selectedNode;if(Bh){Bh.innerHTML=Bg;Bh.title=Bg;}}});if(BQ){BX.attachEventListener("renderComplete",BX.id,function(){BX.setDisplayText(BU);});}Ba.push(BX);Ba.push(BY);},getShapeFormatControls:function U(BX){var BU=this.getHost(),Bf=this,Bg=BU.isEditingDropZoneColorByAttr(),Bd=BU.getEditingDropZoneItems(k.ColorBy),BO=Bg===false&&Bd&&Bd.length>0,BT=Bg===true&&Bd&&Bd.length>0,Be=BU.getGraphicLayer(),BS=Be&&Be.dataValidate(),Bc=this.getGroupTitle(mstrmojo.desc(13751,"Shape Formatting")),BV,BN,BR=[],BQ={isNested:true,showDivider:true,isContainer:true},BY;function Ba(Bk,Bh,Bn,Bo){var Bi=function(Bp){switch(Bp){case BB.SHAPE_FORMAT_FILL_OPACITY:return A1.FILL_OPACITY;case BB.SHAPE_FORMAT_FILL_COLOR:return A1.FILL_COLOR;case BB.SHAPE_FORMAT_BORDER_STYLE:return A1.BORDER_STYLE;case BB.SHAPE_FORMAT_BORDER_COLOR:return A1.BORDER_COLOR;}};var Bm={groupTitle:Bc,preBuildRendering:q,onRender:function(){this.reInit();},broker:Bf,reInitDefault:function(){(this.listenFormatProps).forEach(function(Bp){this.onFmtPropsChanged(Bp,this.broker.getEditingPropertyVal(Bp));},this);},reInit:function(){this.reInitDefault();},preBuildRendering:function(){this.reInit();},onFmtPropsChanged:function(Bp,Br,Bq){if(!Br){Br=Bi(Bp);}this.onFmtPropsChangedDefault(Bp,Br,Bq);},syncControl:function(Bp){var Bq=this._sync;this._sync=true;var Br=Bp.call(this);this._sync=Bq;return Br;},onFmtPropsChangedDefault:q,onSelectorsValueChangedDefault:function(){this.reInit();},onSelectorsValueChanged:function(Bp,Bq){this.onSelectorsValueChangedDefault(Bp,Bq);}},Bj=Bf.getEditingPropertyVal(Bh);if(!Bk){Z.copy({reInit:function(){if(Bn){this.getCtrlContainer().set("enabled",true);}else{this.setChildEnable(e,true);}this.reInitDefault();},onGroupValueChange:q,onFmtPropsChanged:function Bl(Bp,Br){var Bs=Bi(Bp);if(!Br){Br=Bs;}if(Bh&&Bp===Bh){var Bq=!Bj;this.syncControl(function(){this.getChildComp(Bp).set("autoPreviewColor",Bs);this.setChildValue(Bp,Bq?AV.VAL_AUTOMATIC:Br);});}else{this.onFmtPropsChangedDefault(Bp,Br);if(Bo&&Bp===Bo){this.setChildEnable(e,Br!==mstrmojo.gmaps.EnumCombinedLineStyle.NONE);}}}},Bm);}return Bm;}var Bb=function Bb(Bk,Bh){if(Bh){Z.copy({col1Node:"58%",col2Node:"42%"},Bk.layoutConfig.w);var Bi=3;Z.copy({cssText:"margin-left: "+Bi+"px;",getLayoutOffsets:function Bj(){return{h:0,w:Bi};}},Bk.getCtrl());}return Bk;};var BW=function(Bo){var Bm=this,Bj={fillColor:BB.SHAPE_FORMAT_FILL_COLOR,fillAlpha:BB.SHAPE_FORMAT_FILL_OPACITY},Bq=Z.valarray(Bj),Bn=Z.copy({controlName:"shapeFillGroup",showGradient:false,smartNamesMap:Bj,showAutomaticInColor:true,listenFormatProps:Bq},Ba(Bo,Bj.fillColor,Bo));if(Bo){delete Bj.fillColor;Bn.visibleControls=W.FILL_TRANSPARENCY;}Bn.onGroupValueChange=function(Br,Bs){Bm.onPropertiesChanged(Br,Bs);};Bn.onFmtPropsChangedDefault=function(Br,Bs){this.syncControl(function(){if(R.filterOne(this.propNames,function(Bt){return(Bt===Br);})){this.setChildValue(Br,Bs);}else{this.propNames.forEach(function(Bt){this.setChildValue(Bt,Bf.getEditingPropertyVal(Bt));});}});};var Bi=this.addDisposable(new mstrmojo.ui.editors.controls.FillConfigGroup(Bn));Bi.iniChildrenComp(Bq);var Bh=null,Bk=Bj.fillAlpha,Bl=Bk&&Bi.getChildComp(Bk);if(Bl){Z.copy(u(Bf,Bk),Bl);}if(Bo){var Bp=BP.call(this);Bh=this.getTwoColumnContainer([Bp,Bi],{col1Width:"60%",col2Width:"40%"});}else{Bh=Bi;}return this.getEditorGroup([new mstrmojo.Label({text:mstrmojo.desc(2885,"Fill")}),Bh],{showDivider:false,isNested:true,isContainer:true});}.bind(this);var BM=function(Bn,Bk){var Bo=null,Bl=this,Bj={lineColor:BB.SHAPE_FORMAT_BORDER_COLOR,lineStyle:BB.SHAPE_FORMAT_BORDER_STYLE},Bp=Z.valarray(Bj),Bh=Bn,Bm=Z.copy({lineTitle:mstrmojo.desc(9736,"Border"),controlName:"shapeBorderGroup",hideColorControl:Bn,showNoFillInColor:false,showAutomaticInColor:true,listenFormatProps:Bp},Ba(Bn,Bj.lineColor,Bn,Bj.lineStyle));if(Bn){delete Bj.lineColor;Bo=mstrmojo.desc(3538,"Border Style");Bm.lineTitle=null;}Bm.onGroupValueChange=function(Bq,Br){Bl.onPropertiesChanged(Bq,Br);};Bm.onFmtPropsChangedDefault=function(Bq,Br){this.syncControl(function(){this.setChildValue(Bq,Br);});};Bm.hideDashOptions=!!Bk;var Bi=this.addDisposable(new mstrmojo.ui.editors.controls.LineConfigGroup(Bm));Bi.iniChildrenComp(Bp);return Bb(Ax.call(this,Bi,Bo),Bh);}.bind(this);function BP(){var Bk=this.id,Br=this.getHost(),Bp=Br.zonesModel.getDropZones(true),Bl=Q.getMetricsInDropZone({dropZones:Bp.zones},k.ColorBy),Bn=Bl[0]||{},Bi=Br.getEditingHost(),Bo=Bi.model.data,Bq=Bo.gsi,Bm=Bq.mx,Bh=Bm[R.find(Bm,"did",Bn.id)],Bj=Bq.thresholds[Bn.id];return new mstrmojo.vi.ui.ColorRangeSelector({thresholds:Bj,metric:Bh,onclick:function(){var Bu=mstrmojo.all[Bk],Bs=Bu&&Bu.getHost(),Bt=Bs&&Bs.getEditingHost(),Bv,Bw;if(Bt&&Bt.model){Bv=Bs.zonesModel;Bw=Bv&&Bv.canSupportImageThreshold();Bt.model.openThresholdEditor(Bn,true,Bw);}}});}switch(BX){case O.Bubble:BY=true;case O.Area:BN=BM(BO,BY);if(!(BT&&BS)){BV=BW(BO);BR.push(BV,BN);}else{BR.push(BN);}break;case O.Marker:if(!(BT&&BS)){BV=BW(BO);BR.push(BV);}break;case O.Density:default:return null;}var BZ=[Bc];if(BT&&BS){this.getColorByAttrControls(BZ);}return this.getEditorGroup(BZ.concat(BR),BQ);},getDataLabelControls:function AE(){var BO=this.getGroupTitle(mstrmojo.desc(11993,"Data Labels")),BM=this.getDataLabelShowOptionControl(),BN=BM.disableCtrls;return this.getEditorGroup([BO,BM.control,this.getDataLabelShowAllCheckBoxControl(BN),this.getDataLabelCharacterControl(BN)],{isNested:true,showDivider:true,isContainer:true});},getMapOptionControls:function AS(){var BM=[];if(mstrApp&&mstrApp.enableImageMap&&AA.indexOf(AX.Image)===-1){AA.push(AX.Image);}BM.push(this.getBaseMapControls());this.graphicLayersControl=this.getGraphicLayersControls();BM.push(this.graphicLayersControl);BM.push(this.getMoreOptionsControl());return[this.getEditorGroup([this.getEditorGroup(BM)],{showDivider:true,isNested:true,isContainer:true})];},addDensityControls:function F(BO){var BM=this.getDensityThemes(),BN,BP;if(BM&&BM.length>0){BN=Aw.call(this,AT.themeType);BP=new mstrmojo.ui.CheckList({cssClass:"mem-density-list",orientation:"h",items:BM,multiSelect:false});BP.set("selectedIndex",this.getDensityThemeSelectedIndex());BP.postselectionChange=function(BQ){BN(BM[BQ.added[0]]);};BO.push(r.call(this,mstrmojo.desc(11839,"Density map color gradient:")));BO.push(BP);}},getDataLabelExtraControlProps:mstrmojo.emptyFn,getDataLabelControlConfig:function At(){return V+p+Ak;},getDataLabelCharacterControl:function AY(BP){var BT,BS=this,BR=this.getHost(),BN=BR.getEditingGridKey(),BM=BR.getProperties(BN),BO={enabled:!BP,visibleControls:this.getDataLabelControlConfig()},BQ={};BQ[AG.FONT_WEIGHT]=BG.FS_BOLD;BQ[AG.FONT_STYLE]=BG.FS_ITALIC;BQ[AG.UNDERLINE]=BG.FS_UNDERLINE;BQ[AG.LINE_THROUGH]=BG.FS_STRIKETHROUGH;BO.onGroupValueChange=function(BV,BW){var BX,BU=BW;switch(BV){case AG.COLOR:BX=H.DATA_LABEL_FONT_COLOR;BU=BW==="transparent"?BW:Ae.encodeColor(BW);break;case AG.FONT_SIZE:BX=H.DATA_LABEL_FONT_SIZE;break;case AG.FONT_FAMILY:BX=H.DATA_LABEL_FONT_FAMILY;break;case AG.FONT_WEIGHT:case AG.FONT_STYLE:case AG.UNDERLINE:case AG.LINE_THROUGH:BX=H.DATA_LABEL_FONT_STYLE;BU=BW?(BM[BX]|BQ[BV]):(BM[BX]&(~BQ[BV]));break;}BS.onPropertiesChanged(BX,BU);};BT=new mstrmojo.ui.editors.controls.CharacterGroup(Z.copy(this.getDataLabelExtraControlProps(),BO));BT.setFormatSource(BI(BM));return BT;},getFontFormats:BI,getDataLabelShowOptionControl:function Ag(){var BQ,BR,BO=false,BM=false,BU=this,BX=this.getHost(),BS=BX.getGraphicLayer(),BV={multiSelect:true,showIcon:false},BT=BX.getEditingGridProps(),BN=[{n:mstrmojo.desc(2057,"None"),v:Ay.NONE}],BP={txt:{n:mstrmojo.desc(1013,"Text"),v:Ay.SHOW_TEXT},val:{n:mstrmojo.desc(2175,"Values"),v:Ay.SHOW_VALUE}};if(BS){if(BS.showDataLabelValues()){BN.unshift(BP.val);}if(BS.showDataLabelText()){BN.unshift(BP.txt);}}BR=BN.length;if(BR===1){BN.splice(0,0,BP.txt,BP.val);BM=true;}BV.items=BN;if(BM){BV.enabled=false;}BV.postselectionChange=function(BY){if(this._sync){return ;}this._sync=true;var Ba,Bb,BZ;if(BY.added){if(this.items[BY.added[0]].v===Ay.NONE){for(Ba=0;Ba<BR-1;Ba++){if(this.selectedIndices[Ba]){this.removeSelect(Ba);}}}else{if(this.selectedIndices[BR-1]){this.removeSelect(BR-1);}}}else{if(BY.removed){BZ=true;for(Ba=0;Ba<BR;Ba++){if(this.selectedIndices[Ba]){BZ=false;break;}}if(BZ){this.addSelect(BR-1);}}else{mstr_profile.log("Should never happen");}}Bb=BN.reduce(function(Be,Bd,Bc){return this.selectedIndices[Bc]?(Be|Bd.v):Be;}.bind(this),0);BU.onPropertiesChanged(H.DATA_LABEL_SHOW,Bb);this._sync=false;};BQ=new mstrmojo.ui.ButtonBar(BV);var BW=function(BZ){var BY;this._sync=true;if(BZ===Ay.NONE){this.singleSelectByField(BZ,"v");BO=true;}else{BY=(this.items||[]).map(function(Bb,Ba){return(BZ&Bb.v)>0?Ba:null;}).filter(function(Ba){return Ba!==null;});if(BY.length<=0){this.singleSelectByField(Ay.NONE,"v");BO=true;}else{this.select(BY);}}this._sync=false;}.bind(BQ);BW(BT[H.DATA_LABEL_SHOW]);return{control:BQ,disableCtrls:BM||BO};},getDataLabelShowAllCheckBoxControl:function S(BN){var BS=this,BU=this.getHost(),BR=BU&&BU.getEditingGridProps(),BP=H.DATA_LABEL_SHOW_ALL,BQ=new mstrmojo.ui.Checkbox({checked:!BR[BP],oncheckedChange:function BM(BV){BS.onPropertiesChanged(BP,!BV.value);}}),BO=this.getLabelAndControl(mstrmojo.desc(14606,"Hide overlapping labels"),BQ,"14px","100%",true,{enabled:!BN}),BT=BO.getLabel();BT.onclick=function(){BQ.onclick();};return BO;},fnGetPulldown:function AI(BN,BM,BS,BQ,BO){var BR,BP;if(BN&&BN.length){BP=mstrmojo.ui.Pulldown.newPulldown(BN,Aw.call(this,BQ),BM,{isHostedWithin:false});if(BO){BR=this.getEditorGroup([r.call(this,BS),BP],{showDivider:BO.showDivider,isNested:BO.isNested,isContainer:BO.isContainer});}else{if(BS!=undefined){BR=this.getLabelAndControl(BS,BP);}else{BR=BP;}}}return BR;},onBaseMapTypeChange:function A3(){this.replaceChildControls(this.baseMapOptionsControls,this.getBaseMapOptionsControls());},destroy:function G(){delete this.baseMapOptionsControls;delete this.mapStyleControl;delete this.graphicLayersControl;delete this.graphicLayerOptionsControls;this._super();}});function r(BM){return new mstrmojo.Label({text:BM,cssClass:"prop-title"});}function BA(BO,BM){var BP=this.getHost(),BQ,BN;if(BO===O.Marker||BO===O.Bubble||BO===O.Density){BQ=BP.getEditingDropZoneItems(k.GeoAttribute);if(BQ&&BQ.length>0){BN=BP.getEditingDropZoneItems(BM);if(!BN||BN.length<=0){return true;}}}return false;}function AR(BM){return(BM===O.Bubble||BM===O.Area);}function AB(BN,BM){return R.filterOne(BN.fs,function(BO){return BM(BO.fnm,BO.fgr)&&BO.obf;});}function A2(BM){return AB(BM,BK.isLatitude);}function K(BM){return AB(BM,BK.isLongitude);}function Aw(BM){var BN=this.id;return function(BO){mstrmojo.all[BN].onPropertiesChanged(BM,BO.id);};}function BI(BO){var BN,BM={},BP=BO[H.DATA_LABEL_FONT_STYLE];BM[AG.FONT_WEIGHT]=(BP&BG.FS_BOLD)>0;BM[AG.FONT_STYLE]=(BP&BG.FS_ITALIC)>0;BM[AG.UNDERLINE]=(BP&BG.FS_UNDERLINE)>0;BM[AG.LINE_THROUGH]=(BP&BG.FS_STRIKETHROUGH)>0;BN=BO[H.DATA_LABEL_FONT_COLOR];BM[AG.COLOR]=BN==="transparent"?BN:Ae.decodeColor(BN);BM[AG.FONT_SIZE]=BO[H.DATA_LABEL_FONT_SIZE];BM[AG.FONT_FAMILY]=BO[H.DATA_LABEL_FONT_FAMILY];return BM;}}());(function(){mstrmojo.requiresCls("mstrmojo.DocSelector","mstrmojo.vi.ui.rw.selectors.SearchableCheckList","mstrmojo.vi.ui.rw.selectors.LevelCheckList","mstrmojo.vi.ui.rw.selectors.LevelPopupList","mstrmojo.vi.ui.rw.selectors.HierarchyCheckList","mstrmojo.vi.ui.rw.selectors.PageBySlider","mstrmojo.vi.ui.rw.selectors.PageByButtonBar","mstrmojo.vi.ui.rw.selectors.MetricQualification","mstrmojo.vi.ui.rw.selectors.MetricSlider","mstrmojo.vi.ui.rw.selectors.Slider","mstrmojo.vi.ui.rw.selectors.LinkList","mstrmojo.vi.ui.rw.selectors.ListBoxSelector","mstrmojo.vi.ui.rw.selectors.VisSelectorBox","mstrmojo.array","mstrmojo.css","mstrmojo.hash");var J=mstrmojo.hash,G=mstrmojo.array,I="vi.ui.rw.selectors.",A=mstrmojo.DocSelector.STYLES;var D=12,E=47,P=12033,S=3076;var L={};L[A.CHECKBOX]=L[A.RADIO]=I+"SearchableCheckList";L[A.LIST]=["ListBoxHoriz",I+"ListBoxSelector"];L[A.SCROLLER]=I+"Slider";L[A.METRIC_SLIDER]=I+"MetricSlider";L[A.METRIC_QUAL]=I+"MetricQualification";L[A.LINK]=L[A.BUTTON]=I+"LinkList";L[A.VISUALIZATION]=I+"VisSelectorBox";function C(Y){var X=Object.keys(Y),W=X.length,Z=W-1,V=G.applyLargeArray(X,Math.min,Number.POSITIVE_INFINITY),U=G.applyLargeArray(X,Math.max,Number.NEGATIVE_INFINITY);return W===0||U-V===Z;}mstrmojo.vi.ui.rw.selectors._IsDocSelector=mstrmojo.provide("mstrmojo.vi.ui.rw.selectors._IsDocSelector",{_mixinName:"mstrmojo.vi.ui.rw.selectors._IsDocSelector",model:null,multi:false,k:"",init:function N(U){this._super(U);mstrmojo.css.addWidgetCssClass(this,"vi-DocSelector");},layoutConfig:{h:{containerNode:"100%"},w:{containerNode:"100%"},xt:true},getLayoutOffsets:function Q(){if(this.isInFilterPanel()){return null;}return{h:18,w:18};},update:function F(W){var U=W.defn&&W.defn.fmts||{},X=this.isViPageBy,V=W.defn;if(X||this.isInFilterPanel()){V.fmts=J.copyProps(["height","z-index"],U);}else{V.fmts=J.copy(U);}if(X){V.multi=false;}this._super(W);},preBuildRendering:function B(){if(!this.isViPageBy&&!this.isInFilterPanel()){this.formatHandlers={domNode:["F","text-align","vertical-align","line-height"],contentNode:["fx"],item:["F","text-align","line-height"]};}var W=this.style,V=W===A.RADIO,U=W===A.CHECKBOX;if(U||V||W===A.LINK||W===A.BUTTON){var X=this.children[0];X.orientation=this.node.defn.horiz?"h":"v";if(U||V){X.multiSelect=!V;}}this.content.hostedCSSClass="selector";this._super();},postBuildRendering:function O(U){if(this.bindWarningHandler){this.bindWarningHandler(this,this.content);this.validate();}return this._super(U);},getWidgetClass:function R(X,W,V){if(X.isViPageBy){if(W===A.SCROLLER){return I+"PageBySlider";}if(W===A.BUTTON){return I+"PageByButtonBar";}}if(this.isRecursiveAttributeSelector()&&W===A.CHECKBOX){if(this.isInFilterPanel()){return I+"HierarchyCheckList";}else{return I+(V?"LevelPopupList":"LevelCheckList");}}var U=L[W];if(U){if(U.constructor===Array){U=U[V?0:1];}return U;}return this._super(X,W,V);},updateWidget:function K(V){var U=this._super(V);if(V.style===mstrmojo.DocSelector.STYLES.SCROLLER&&!C(V.selIdx)){U.selectedIndices={};}return U;},validate:function H(){if(this.isValidSelection&&!this.isValidSelection()){this.set("validation",{refNode:this.parent.domNode,position:1,invalid:true,errorCode:"unableDisplaySelectionVIWarning"});}},getSelectorReplaceUnitList:function M(){var V=[],U=[];if(!this.isRecursiveAttributeSelector()){return[];}if(this.isInFilterPanel()){U=this.getFilterPanel().getFilterDefinitions();}J.forEach(this.model.datasets,function(W){G.forEach(W.att,function(Y){var X=this.defn&&this.defn.srcid,b=this.model.getDEObject(X),a=Y.did,Z=this.model.getDEObject(a);if(!Y.hide&&X!==a&&G.find(U,"srcid",a)<0&&(b?b.attId:X)===(Z?Z.attId:a)){V.push(Y);}},this);},this);return V;}});}());(function(){mstrmojo.requiresCls("mstrmojo.Container","mstrmojo._Formattable","mstrmojo.DocSelector","mstrmojo._IsSelectorTarget","mstrmojo.Serializer","mstrmojo._IsPanelStack","mstrmojo._HasBuilder","mstrmojo.array","mstrmojo.css","mstrmojo.hash");var H=mstrmojo.array;function E(O,N){var M=H.find(O.node.data.panels,"k",O.selectedKey);M+=(N||0);O.set("selectedIdx",M);}function I(M){M.set("hasNextPanel",(M.selectedIdx<(M.node.data.panels.length-1)));M.set("hasPreviousPanel",(M.selectedIdx>0));}mstrmojo.DocPanelStack=mstrmojo.declare(mstrmojo.Container,[mstrmojo._Formattable,mstrmojo._IsSelectorTarget,mstrmojo._HasBuilder,mstrmojo._IsPanelStack],{scriptClass:"mstrmojo.DocPanelStack",markupString:'<div id="{@id}" k="{@k}" title="{@tooltip}" nm="{@n}" class="mstrmojo-DocPanelStack {@cssClass}" style="{@domNodeCssText}"><div></div></div>',markupSlots:{containerNode:function(){return this.domNode.firstChild;}},formatHandlers:{domNode:["RW","B","overflow"]},model:null,hasNextPanel:false,hasPreviousPanel:false,applyEnabled:false,clearEnabled:true,renderMode:"onshow",n:"",node:null,selectedIdx:undefined,selectedKey:"",init:function L(M){this._super(M);E(this);this.node.sw=(this.node.data.panels.length>1&&this.defn.sw);this.n=M.node.defn.n;},onselectedKeyChange:function J(N){var O=this._super(N),M=O.on;if(M._delayRefresh){if(!M.defn.dirtyKeys){M.refresh();}delete M._delayRefresh;}E(this);},updateSelectedIdx:function B(M){E(this,M);},onselectedIdxChange:function G(){I(this);},_bufferedSlices:null,canApply:function A(){var O,N,M,P;for(O in this.children){M=this.children[O];if(!M.children){continue;}for(N in M.children){P=M.children[N];if(P.defn&&P.defn.ttl!==undefined){P=P.children[1];}if(P&&P.canApply&&!P.canApply()){return false;}}}return true;},bufferSlice:function F(N){var M=this._bufferedSlices=this._bufferedSlices||[];M.push(N);this.set("applyEnabled",this.canApply());},applyBufferedSlices:function D(){var N=this._bufferedSlices;if(!N){return ;}var M=function(S){var R=[],Q,P=String.fromCharCode(30);mstrmojo.hash.forEach(S,function(V){Q=V.tks;if(Q){var U=H.isArray(Q)?Q:Q.split(P);R=R.concat(U);}});return R;};var O=function(R){var P=false;for(var Q=0;Q<R.length;Q++){if(R[Q].isUConDS){P=true;break;}}return P;};this.model.slice({bufferedSlices:true,tks:M(N),events:N,isUConDS:O(N)});this.clearBuffSlices();},clearBuffSlices:function(){this._bufferedSlices=null;this.set("applyEnabled",false);},_isFPS:function K(){return !!this.defn.ifp;},clearAllFilter:function C(){var R=mstrmojo.DocSelector.STYLES,M=this;if(!M._isFPS()){return ;}if(!(M.children&&M.children.length)){return ;}var Q,O,W,Y,V,N,S;for(Q in M.children){W=M.children[Q];if(!W.children){continue;}for(O in W.children){Y=W.children[O];if(Y.defn.ttl!=="undefined"){Y=Y.children[1];}if(Y.model){V={tks:Y.tks,ck:Y.ck,ckey:Y.ckey,unset:true};M.bufferSlice(V);var U=Y.node.defn,P=Y.node.data;var X=H.filterOne(P.elms,function(Z){return Z.t===14;});if(U.showall&&X){P.ces=[X];U.cek=[X.v];}else{P.ces=[];U.cek=null;}P.unset=true;P.cs=[];N=Y.content;if(parseInt(U.style,10)===R.SCROLLER){N.min=0;S=N.items&&N.items.length;N.max=S?S-1:0;}Y.update(Y.node);Y.refresh();}}}},update:function(O){if(this._super){this._super(O);}var M=O.data&&O.data.selKey;if(M&&M!==this.selectedKey){this.defn.newSelKey=M;}var N=function(P){return P.data&&P.data.panels&&P.data.panels.length;};if(this.children&&(this.children.length!==N(O))){this.rebuildPanels();}},rebuildPanels:function(){this.destroyChildren(false);this.buildChildren(false);},postBuildRendering:function(){this._super();if(this.defn.itb){mstrmojo.css.addClass(this.domNode,"tableControl");}}});}());(function(){mstrmojo.requiresCls("mstrmojo.hash","mstrmojo.array","mstrmojo.dom","mstrmojo.elementHelper","mstrmojo.DocSelector","mstrmojo.ui.MultiSelectPulldown","mstrmojo.ui.MultiSelectSearchablePulldown","mstrmojo.ui.Pulldown","mstrmojo.ui.SearchablePulldown");var N=mstrmojo.hash,J=mstrmojo.array,D=mstrmojo.dom,Q=mstrmojo.elementHelper,P=mstrmojo.DocSelector.DATAPARAMS,S=mstrmojo.DocSelector.STYLES;var M=0,B=1,C=2,G=4,H=1000;function L(c){var b=null,X=null,a=0,Z,Y;for(Z in c){Y=Number(Z);a++;b=(b===null||b>Y)?Y:b;X=(X===null||X<Y)?Y:X;}return a===0||X-b===a-1;}mstrmojo.ListDocSelector=mstrmojo.declare(mstrmojo.DocSelector,null,{scriptClass:"mstrmojo.ListDocSelector",formatHandlers:{domNode:["F","text-align","vertical-align","line-height","z-index","top","left"],contentNode:["height","width","B","P","fx","background-color"],item:["color","font","text-decoration","text-align","line-height"]},_ieformatHandlers:{domNode:["F","text-align","vertical-align","line-height","z-index","top","left"],contentNode:["width","B","P","height"],filterNode:["height","width","B","P","fx","background-color"],item:["color","font","text-decoration","text-align","line-height"]},_buildEvent:function I(x,b){var o=this.node,a=this.defn,l=o.data.elms,c=[],r=[],AA=b.multiSelect,d=b.selectedIndices,h=b.allIdx,f=!!d[h],t,n,v=[],g=this.include,j=function(){var AB=this.isInFilterPanel()&&this.getFilterPanel();return AB&&AB.isAutoApply();}.bind(this);if(!AA){var X=l[b.selectedIndex],k=X.v;c=[k];v=[k+";"+X.n];r=[X];}else{if(f){n=l[h].v;c=[n];v=[n];r=[l[h]];}else{if(d[h]){d[h]=false;}var u=N.keyarray(d,true).sort(J.numSorter),m={};for(t in u){m[u[t]]=d[u[t]];}d=m;N.forEach(d,function(AC,AB){if(AC&&!l[AB].hid){c.push(l[AB].v);v.push(l[AB].v+";"+l[AB].n);r.push(l[AB]);}});}}this.defn.set("cek",c);if(c.length>0||!a.nsb||a.nsb===M){if(mstrApp&&mstrApp.isVI&&parseInt(this.style,10)===G&&l&&l.length>H&&c.length>l.length/2&&(j()||!this.isInFilterPanel())){x.include=!g;x.forceBuffer=true;x.requireToggle=true;b.include=!g;var q=[],Z=[];J.forEach(l,function(AC,AB){if(AB!==h&&!d[AB]){q.push(AC.v);Z.push(AC.v+";"+AC.n);}});this.defn.set("cek",q);x.eid=((parseInt(x.type,10)===1)?Z:q).join(Q.ELEM_SEPARATOR);}else{x.eid=((parseInt(x.type,10)===1)?v:c).join(Q.ELEM_SEPARATOR);}}else{if(a.nsb===B||!a.showall){x.unset=true;}else{if(a.nsb===C){x.eid=Q.ELEM_ALL_ID;r=[l[h]];}}}if(mstrApp.isAppStatePause&&mstrApp.isAppStatePause()){var w=this.model,z=w.getCurrentLayoutDef(),p=z&&z.units,Y=this.k;if(p&&p[Y]){p[Y].cesChange=true;}o.data.ces=r;o.data[P.CESREADY]=true;this.model.setDataReady(this.k,this.id,P.CESREADY,true,"ces",r);}var e=D.position(b.domNode,true);if(e){x.left=e.x;x.top=e.y;}if(f&&this.multi&&g){J.forEach(l,function(AC){var AB=AC.v;if(c[0]!==AB){c.push(AB);}});}if(a.sec){if(a.style!==mstrmojo.DocSelector.STYLES.SCROLLER){this.parent.set("count",Q.buildElemsCountStr(a.multi?c:l,l,this.isSelectionExcluded()));}}},getCekEvtListener:function W(Z,Y){var X=Z.defn.style;if(X===S.PULLDOWN||X===S.SCROLLER){return function(a){var e=Y.items,f={};if(!Y.multiSelect){var b=Y.selectedIndex=J.find(e,"v",a.value[0]);if(b>-1){f[b]=true;}}else{var d=Y.allIdx,c;if(d>-1&&J.indexOf(a.value,e[d].v)>-1){for(c=0;c<e.length;c++){f[c]=true;}}else{J.forEach(a.value,function(h){var g=J.find(e,"v",h);if(g>-1){f[g]=true;}});}}Z.selIdx=Y.selectedIndices=f;Z.handleActionInSyncPhase(function(){Y.refresh();});};}return this._super(Z,Y);},preBuildRendering:function A(){var Z=this.node.defn.style,Y=N.clone(this.formatHandlers),X=Y.contentNode;if(X){if((Z===S.RADIO||Z===S.CHECKBOX)&&Y.filterNode){X.push("fx");X.push("background-color");delete Y.filterNode;}if(Z===S.LIST){delete X.height;}}this.formatHandlers=Y;return this._super();},getWidgetClass:function U(Z,Y,X){if(Y===S.PULLDOWN){if(mstrApp.isVI&&!D.isMobile){return Z.multi?"ui.MultiSelectSearchablePulldown":"ui.SearchablePulldown";}return Z.multi?"ui.MultiSelectPulldown":"ui.Pulldown";}return this._super(Z,Y,X);},getWidgetConfig:function F(c,a,Z,b){var Y=c.getFormats(),X=this._super(c,a,Z,b);if(a===S.SCROLLER){c.extCls="extSlider";if(mstrApp&&mstrApp.isVI){X.isHoriz=true;}N.copyProps(["height","width"],Y,X);}if(a===S.PULLDOWN&&!Z.multi){X.isHostedWithin=false;X.onitemSelected=X.onchange;X.allowHTML=false;X.focusOnPopup=mstrmojo.App&&mstrmojo.App.isOIVM();}if(this.isRecursiveAttributeSelector()){X.getlevelNames=function(){var d={};J.forEach(c.levelForms,function(e){d[e.lv]=e.lvfn;});return d;};}return X;},updateWidget:function O(a){var b=this._super(a),X=a.selIdx;var Y=b.items=a.node.data.elms;b.selectedIndices=X;b.include=a.defn.include;if(!b.multiSelect&&Y&&Y.length){var Z=N.keyarray(X);if(Z.length===1){b.selectedIndex=Number(Z[0]);}else{b.selectedIndices={};b.selectedIndex=-1;}}return b;},isSelectAll:function E(){var a=this.node.data.elms,Z=this.children&&this.children[0],b=Z.selectedIndices,Y=Z.allIdx,X=!!b[Y],c=(a[Y]&&a[Y].v)||Q.ELEM_ALL_ID;if(this.include){return X||J.filter(a,function(d){return d.v!==c;}).length===N.keyarray(b).length;}else{return N.isEmpty(b);}},isFilterNothing:function K(){var Z=this.children&&this.children[0],a=Z.selectedIndices,Y=Z.allIdx,X=!!a[Y];return X;},destroy:function V(){var X=this.node.data;this._super();if(X.del){J.insert(X.elms,X.del.idx,X.del.elem);delete X.del;}},isValidSelection:function R(){var Z=this.node,a=Z.data,Y=Z.defn,b=a.ces,X=this.model;if(!Y.multi&&b&&b.length>1&&!this.allowsTogglingMultiSelect()){return false;}if(Y.style===mstrmojo.DocSelector.STYLES.SCROLLER&&!L(this.selIdx)){return false;}if(X.isSelWarnFlagOn(this.k)&&b&&b.length===0&&a.elms.length>0){return this.children[0].noneIdx&&this.children[0].noneIdx>-1;}return true;}});}());(function(){mstrmojo.requiresCls("mstrmojo.DocSelector","mstrmojo.MetricSelectorUtility","mstrmojo.hash","mstrmojo.array","mstrmojo.expr");var G=mstrmojo.hash,L=mstrmojo.array,D=mstrmojo.DocSelector.DATAPARAMS;mstrmojo.MetricQualDocSelector=mstrmojo.declare(mstrmojo.DocSelector,null,{scriptClass:"mstrmojo.MetricQualDocSelector",_ieformatHandlers:{domNode:["F","text-align","vertical-align","line-height","z-index","top","left"],contentNode:["width","B","P","height"],filterNode:["height","width","B","P","fx","background-color"],item:["color","font","text-decoration","text-align","line-height"]},formatHandlers:{domNode:["F","text-align","vertical-align","line-height","z-index","top","left"],contentNode:["height","width","B","P","fx","background-color"],item:["color","font","text-decoration","text-align","line-height"]},init:function P(Q){this._super(Q);this.spm=true;},initControlInfo:function O(){this._super();var R=mstrmojo.MetricSelectorUtility,U=this.node,V=U.data,S=U.defn;G.copyProps(["srcid","srct"],S,this);this.qua=V.qt;this.dt=V.dt;var Q=R.getOpIdxByfunc(V.f,V.ft);if(Q!==-1){this.include=R.getIncludeByOp(Q);}},canApply:function E(Q){return true;},onquaChange:function J(Q){this.node.data.qt=Q.value;},_buildEvent:function H(S,U){var V=[];var R=false;L.forEach(U.cs,function(a){V.push(a.v);if(S.dtp===undefined){S.dtp=a.dtp;}if(a.dtp===mstrmojo.expr.DTP.BIGDECIMAL){R=true;}});if(R){S.dtp=mstrmojo.expr.DTP.BIGDECIMAL;}if(V.length){S.cs=V.join(mstrmojo.elementHelper.ELEM_SEPARATOR);}var Y=mstrmojo.MetricSelectorUtility.getFuncInfo(U.opId,U.qua);S.f=U.f=Y.f;S.ft=U.ft=Y.ft;S.include=this.defn.include=this.include=U.include;S.ckey=this.ckey;S.srcid=this.srcid;S.srct=this.srct;if(U.forceUnset){S.retrieveCtrlKey=true;}S.unset=U.unSet||U.forceUnset;S.onlyInclude=U.onlyInclude;if(U.changeInclude){S.changeInclude=U.changeInclude;S.forceApply=true;U.changeInclude=false;}if(U.changeQual){S.changeQual=U.changeQual;U.changeQual=false;}S.qt=U.qua;if(mstrApp.isAppStatePause&&mstrApp.isAppStatePause()){var Z=this.model,W=Z.getCurrentLayoutDef(),X=W&&W.units,Q=this.k;if(X[Q]){X[Q].cesChange=true;}Z.setDataReady(this.k,this.id,D.CSREADY,true,["f","ft","cs"],[U.f,U.ft,U.cs]);}this.node.defn.set("cek",{id:this.id,f:U.f,ft:U.ft,cs:U.cs,qua:U.qua,include:U.include});},preBuildRendering:function M(){var Q=this._super();if(this.isInFilterPanel()&&!this.isHorizFP()){this.children[0].width=this.parent.parent.contentWidth;}return Q;},postBuildRendering:function B(){this._super();if(this.formatHandlers.filterNode){var Q=this.getFormats();if(!Q.height){this.updateHeight();}}},getCekEvtListener:function C(R,Q){return function(S){R.handleActionInSyncPhase(function(){R.set("qua",S.value.qua);if(R.id!==S.value.id){Q.updateExpr(S.value);if(R.style===mstrmojo.DocSelector.STYLES.METRIC_SLIDER){R.set("include",S.value.include);}}});};},updateWidget:function N(V){var W=this._super(V),R=V.node,Q=V.selIdx,U=R.data,S=U.elms;if(W.updateData){W.numFmts=V.defn.numFmts;V.handleActionInSyncPhase(function(){W.updateData({low:U.min,high:U.max,cnt:U.cnt,nov:U.nov},{cs:U.cs,f:U.f,ft:U.ft,qua:U.qt});});}W.items=S;W.selectedIndices=Q;return W;},newAndInitWidget:function K(Q){var R=this._super(Q);Q.attachEventListener("quaChange",R.id,function(S){this.set("qua",S.value);});return R;},getWidgetConfig:function I(W,U,S,V){var R=W.getFormats(),Q=this._super(W,U,S,V);G.copyProps(["height","width","font"],R,Q);G.copyProps(["cs","ft"],S,Q);Q.fmts=S.f;Q.dt=W.dt;Q.qua=W.qua;Q.numFmts=S.numFmts;return Q;},isSelectAll:function A(){var S=mstrmojo.MetricSelectorUtility.OP,R=this.children&&this.children[0],Q=R&&(S._IS_NULL===R.opId||S._IS_NOT_NULL===R.opId);return R===undefined?true:(!R.cs||R.cs.length===0)&&!Q;},isFilterNothing:function F(){return false;}});}());(function(){mstrmojo.requiresCls("mstrmojo.vi.ui.PanelPortlet","mstrmojo.vi.ui.rw.selectors._HasFilterContextMenu","mstrmojo.vi._MonitorsAppState","mstrmojo.vi._MonitorsLayoutMode","mstrmojo.util.ui._HostsSplitter","mstrmojo.ui.menus.EditorConfig","mstrmojo.ui.CheckList","mstrmojo.ui.ScrollableContainer","mstrmojo.Label","mstrmojo.ToolSeparator","mstrmojo.vi.ui.InteractiveUnitList","mstrmojo.array","mstrmojo.hash","mstrmojo.dom","mstrmojo.boxmodel","mstrmojo.css","mstrmojo.expr","mstrmojo.vi.models.VIComponentMap","mstrmojo.ME._MetricEditorHelper","mstrmojo.DocDataService","mstrmojo.DocSelector","mstrmojo.vi.ui.rw.VisFilterDisplayPanel","mstrmojo._HasPopup");var V=mstrmojo.array,a=mstrmojo.hash,AX=mstrmojo.css,x=mstrmojo.dom,AO=mstrmojo.expr,AJ=AO.BFTP,AY=mstrmojo.DocSelector.STYLES,C=mstrmojo.DocSelector.DATAPARAMS,g=mstrmojo.elementHelper,N=mstrmojo.vi.ui.rw,b=mstrmojo.vi.models.VIComponentMap.TYPES,AQ=N.VisFilterDisplayPanel,AH="\u001E",Z=4,AM=12,AW=47,I=257,AB=776,AF=779,Ab=1,A=250,J=1,c=10,Q=74,v=85,k=mstrmojo.getJsRoot()+"mojo/css/images/VisualizationFilter_icon.svg",AT="VisFilter",j="expanded",AU="default",m="ns-resize",q;function P(Ad){var Ag=Ad.tgt.pos,Aj=Ag.x,Ai=Ag.y,Ah=Ad.src.data.parentDim,Al=Ah.x,Ak=Al+Ah.w,Af=Ah.y,Ae=Af+Ah.h;return Aj>=Al&&Aj<=Ak&&Ai>=Af&&Ai<=Ae;}function d(){var Ak=function(As,Ar){var Aq=[];Object.keys(As).forEach(function(Au){var At=As[Au];Aq=Aq.concat((At[Ar]||[]).filter(function(Av){var Aw=V.find(Aq,"did",Av.did);if(Aw>-1){if(Aq[Aw].hide&&!Av.hide){Aq[Aw].hide=false;}return false;}return true;}).map(function(Av){var Aw=mstrmojo.hash.clone(Av);Aw.dsc="("+At.name+")";return Aw;}));});return Aq;},Ae=this.selector,Ap=Ae.model,Ad=Ae.defn.srcid,Af=Ap.datasets,An=Ak(Af,["att"]),Ai=Ak(Af,["mx"]),Al=function(As){var Ar=[],Aq={};Object.keys(As).forEach(function(At){var Aw=As[At],Au=Aw.att||[],Ax=Aw.mx||[];if(V.find(Au,"did",Ad)>=0){var Av=Au.filter(function(Ay){return Ay.formType===AJ.NUMBER&&Ay.did!==Ad&&!Ay.hide&&!Aq[Ay.did];}).map(function(Ay){Ay.dsc=Aw.name;return Ay;}).concat(Ax.filter(function(Ay){return !Ay.hide&&!Aq[Ay.did];}).map(function(Ay){Ay.dsc=Aw.name;return Ay;}));Ar=Ar.concat(Av);Av.forEach(function(Ay){Aq[Ay.did]=true;});}});return Ar;},Ah=V.filterOne(An,function(Aq){return Aq.did===Ad;}),Aj=Al(Af||{}),Ao=function(Ar){var Aq={},As={};(Ar||[]).forEach(function(At){if(At.n&&Aq[At.n]){As[At.n]=true;}Aq[At.n]=true;});return As;},Ag=Ao(Aj);return new mstrmojo.ui.menus.EditorConfig({cssClass:"topRank",okVisible:false,cancelVisible:false,contents:[{scriptClass:"mstrmojo.Label",text:mstrmojo.desc(11503,"Ranked By:")},{scriptClass:"mstrmojo.ui.ScrollableContainer",children:[{scriptClass:"mstrmojo.vi.ui.InteractiveUnitList",draggable:false,CLS_HAS_MENU:"",items:Aj,hasTooltipContent:function(Aq){return mstrmojo.vi.ui.InteractiveUnitList.prototype.hasTooltipContent.apply(this,arguments)||Ag[Aq.n];},getItemTooltip:function(As,At){var Ar=mstrmojo.vi.ui.InteractiveUnitList.prototype.getItemTooltip.apply(this,arguments);if(Ar){var Aq=x.position(At);a.copy({cssClass:"vi-regular vi-tooltip-C",content:As.n+" ("+As.dsc+")",posType:mstrmojo.tooltip.POS_TOPLEFT,top:Aq.y,left:Aq.x+Aq.w+6},Ar);}return Ar;},listHooks:{select:function Am(At,Au){var Ar=Ap.findDatasetIdFromUnit(Ah.did),As=function(A1,A3){var A0=A3+" by "+A1,Ay=A0,A2=V.hash(Ai.map(function(A4){return A4.n;})),Az=1;while(A2[Ay]){Ay=A0+" ("+(Az++)+")";}return Ay;},Aq=As(Ah.n,Au.n),Ax=Ap.getDataService(),Av=function(A0,Ay){var A2=[],A3={oi:{did:"8107C31BDD9911D3B98100C04F2233EA",t:11,st:2826,n:"Sum"},v:"Sum"},A1=function(A4){return{tp:2,lv:1,v:A4};},Az=function(A5){var A4={v:mstrmojo.ME.MetricToken.brackets(A5.n),lv:1,oi:{did:A5.did,t:A5.t,n:A5.n}};if(A5.st){A4.oi.st=A5.st;}return A4;};A2=[A3,A1("("),Az(A0),A1(")"),A1("{"),Az(Ay),A1("}")];return mstrmojo.ME._MetricEditorHelper.getTokenStreamXML({tks:{items:A2}});},Aw=[Ax.getAddDerivedMetricToDatasetAction({dsid:Ar,formula:Av(Au,Ah),isTokenStream:true,name:Aq,Ids:["$GUID_1"],afb:true,sfb:true}),Ax.getEditDocUnitPropAction({dsid:Ar,unitId:"$GUID_1",unitType:Z,prop:2,value:"1"})];Ap.datasetsSettings.unitOpr(Aq,"isDeleteWithFilter",true);Ap.datasetsSettings.unitOpr(Aq,"completeHide",true);Aw=Aw.concat(Ap.datasetsSettings.getSaveActions());Ax.submitUpdates(Aw,mstrmojo.func.wrapMethods(Ap.getDatasetsUpdateCallback(),{success:function(Az){var Ay=Ak(Az.datasets,["mx"]).filter(function(A0){return V.find(Ai,"did",A0.did)===-1;}).map(function(A0){A0.isTopRank=true;A0.qt=J;A0.cs=c;return A0;});Ap.addFilterStackSelectors(Ay,Ae.fmts["z-index"]+1,null,true);}}));this.hideTooltip();this.parent.parent.closeAllMenus();return true;}}}]}]});}var AV=function(Ae){var Ad=[];(Object.keys(Ae)||[]).forEach(function(Ag){var Af=Ae[Ag];if(Af&&Af.st!==AB&&Af.st!==AF){Ad=Ad.concat({n:Af.name,did:Ag});}});return Ad;};function t(){var Ae=this.selector,Ag=Ae.model,Ad=(Ae.defn.dsTks||"").split(AH),Ai=Ag.datasets,Af=AV(Ai)||[],Ah={};Ad.forEach(function(Al){var Ak=V.find(Af,"did",Al);if(Ak>=0){Ah[Ak]=true;}});var Aj=new mstrmojo.ui.CheckList({cssClass:"selectors",items:Af,selectedIndices:Ah});return new mstrmojo.ui.menus.EditorConfig({data:{},cssClass:"filterDataset",contents:[Aj],fnOk:function(){var Ao=[],Al=Ae.model,An=Al.getDataService(),Ak=Aj.getSelectedItems()||[],Am=Ae.defn.ck;if(!Ak.length){mstrmojo.alert(mstrmojo.desc(13765,"Please choose at least one dataset as target."));return false;}Ao.push(An.getClearCtrlTargetAction(Am));Ao.push(An.getClearCtrlTargetDatasetAction(Am));if(Ak.length>0){Ak.forEach(function(Ap){Ao.push(An.getAddCtrlTargetDatasetAction(Am,Ap.did));});Ao.push(An.getChangeControlElementSource(Am,Ab));Al.submitDataDefnUpdate(Ao,mstrmojo.func.wrapMethods(Ag.controller.getRefreshCallback(),Ag.controller.resumeVIPanelSelection()));}}});}function l(){var Ae=this.baseTitle,Ad=this.count;if(Ad&&Ad.length){Ae+=" ("+Ad+")";}return Ae;}function o(){var Ag=this.selector,Ak=Ag&&Ag.defn,Ai=Ag.children&&Ag.children[0],Ad=Ai.items,Ae=Ag.style,Af=Ag.include;if(Ae!==AY.VISUALIZATION&&(!Ak||Ak.srct!==AM)){return"";}if(Ae===AY.ATTR_QUAL||Ae===AY.VISUALIZATION||(Ae===AY.CHECKBOX&&Ag.isRecursiveAttributeSelector())){return Ai.getSummaryText();}var Ah=Ae===AY.SEARCH_BOX?Object.keys(Ad):Object.keys(Ag.selIdx),Am=Ah.length;if(!!Ag.unset||Ah.indexOf(String(V.find(Ad,"v",g.ELEM_ALL_ID)))>-1){return"";}if(!Am){return mstrmojo.desc(2057,"None");}if(Ae===AY.SCROLLER&&(Ah[Ah.length-1]-Ah[0])===(Am-1)){var Aj=Af?"":mstrmojo.desc(1099,"Not")+" ";return Aj+(Am===1?Ad[Ah[0]].n:(Ad[Ah[0]].n+" - "+Ad[Ah[Am-1]].n));}var Al=Ah.map(function(An){return Ad[An].n;}).join(", ");if(!Ak.include){Al=mstrmojo.desc(1099,"Not")+" "+Al;}return Al;}function AG(Ae){var Ad=this;Ae=Ae||"";return[{scriptClass:"mstrmojo.Label",alias:"summaryBar",cssClass:"subtitle",title:Ae,text:Ae,slot:"summaryNode",onclick:function(){Ad.clickToCollapse();}}];}function W(Ad){var Af=Ad.parent;if(Af.isCollapsed){var Ae=o.call(Af),Ag=Af.summaryBar;Ag.set("text",Ae);Ag.set("title",Ae);}}function AP(Ad){var Af=[],Ah=Ad.defn.srcid,Ag=Ad.defn.srct===4?"mx":"att";mstrmojo.hash.forEach(Ad.model.datasets,function(Aj){var Ai=Aj[Ag];Af=Af.concat(Ai);});var Ae=V.filterOne(Af,function(Ai){return Ai.did===Ah;});return !!V.filterOne(Af,function(Ai){return Ae&&Ai.n===Ae.n&&Ai.did!==Ae.did&&Ai.t===Ae.t;});}function AR(Ad){var Af=Ad.defn.srct===4?"mx":"att",Ag=Ad.defn.srcid,Ae=[];mstrmojo.hash.forEach(Ad.model.datasets,function(Aj){var Ai=Aj[Af];var Ah=V.find(Ai,"did",Ag);if(Ah!==-1){Ae.push(Aj.name);}});return Ae;}function f(Ae,Ad){var Af;x.attachEvent(Ae,"mousedown",function(){Af=window.setTimeout(function(){AX.addClass(Ad,"showFPBorder");},300);});x.attachEvent(Ae,"mouseup",function(){window.clearTimeout(Af);AX.removeClass(Ad,"showFPBorder");});}var AN=mstrmojo.mixin({scriptClass:"__DraggableFP",avatarCssClass:"mstrmojo-filterportlet-avatar",selfAvatarCssClass:"mstrmojo-filterportlet-selfAvatar",getDragData:function Aa(Ad){var Ag=this.id,Ae=this;return{item:this.selector,idx:this.selector.defn.fmts["z-index"],src:mstrmojo.vi.models.EnumDragSources.FILTERS,dim:x.position(this.domNode),parentDim:x.position(this.parent.domNode),setAvatarClass:function Af(Ah){var Ak=mstrmojo.all[Ag],Ai=P(Ad)?Ad._selfAvatar:Ad._avatarNode;if(Ai){var Aj=[(Ai===Ad._selfAvatar?Ak.selfAvatarCssClass:Ak.avatarCssClass),"hasOwnAvatar",Ah];Ai.className=Aj.join(" ");}},onRemove:function(Aj){delete Ae.domNode;var Ai=Aj.model;if(Ae.isVisFilter()){Ai.deleteVisFilterStackSelectors(Aj);}else{var Ah=!!(Aj.isFilterNothing&&Aj.isFilterNothing());Ai.deleteFilterStackSelectors([Aj.defn],Ah);}}};},isDragValid:function r(Ad){return x.contains(this.titlebarNode,Ad.src.node);},ondragstart:function L(Ad){this._super(Ad);this.domNode.style.display="none";},ondragmove:function D(Ae){if(P(Ae)){var Af=Ae.src.data,Ag=Af&&Af.dim,Ad=Af&&Af.parentDim;this.avatar=Ae._selfAvatar;this.positionAvatar({x:(Ag.x-Ad.x),y:(Ae.tgt.pos.y-Ad.y)});Ae._avatarNode.style.display="none";Ae._selfAvatar.style.display="block";return true;}this.avatar=Ae._avatarNode;Ae._avatarNode.style.display="block";Ae._selfAvatar.style.display="none";return this._super(Ae);},wasDropped:function(){delete this.selector.node.defn.iifp;this.parent.removeChildren(this);this.destroy();},ondragend:function Y(Ad){var Af=this.domNode;if(Af){AX.removeClass(Af,"showFPBorder");Af.style.display="block";}this.avatar=Ad._avatarNode;this._super(Ad);if(Ad._selfAvatar){var Ae=this.parent;if(Ae){Ae.domNode.firstChild.removeChild(Ad._selfAvatar);}delete Ad._selfAvatar;}},createAvatar:function S(Ag,Ae){var Ad;if(!Ae._avatarNode){Ad=Ae._avatarNode=document.createElement("div");Ad.appendChild(this.titlebarNode.cloneNode(true));Ad.style.margin="20px 0 0 20px";Ad.style.display="none";Ad.className=this.avatarCssClass;}if(!Ae._selfAvatar){if(this.domNode.className.indexOf("showFPBorder")===-1){AX.addClass(this.domNode,"showFPBorder");}Ad=Ae._selfAvatar=document.createElement("div");Ad.className=this.selfAvatarCssClass;Ad.appendChild(this.domNode.cloneNode(true));var Af=document.createElement("div");Af.className="icon";Ad.appendChild(Af);Ad.style.position="absolute";Ad.style.opacity=0.75;this.parent.domNode.firstChild.appendChild(Ad);}return Ae._avatarNode;}},mstrmojo.mixin(mstrmojo._HasOwnAvatar,{}));function z(){if(!this.isVisFilter()){return ;}var Ae,Af=this.domNode,Ag=Af.querySelectorAll(".mstrmojo-EditableLabel, .mstrmojo-Label"),Ad=Af.querySelector(".right-toolbar");Af.style.cursor="pointer";for(Ae=0;Ae<Ag.length;Ae++){Ag[Ae].style.cursor="pointer";}if(Ad){Ad.style.cursor=AU;}}mstrmojo.vi.ui.rw.FilterPortlet=mstrmojo.declare(mstrmojo.vi.ui.PanelPortlet,[AN,mstrmojo.vi.ui.rw.selectors._HasFilterContextMenu,mstrmojo.vi._MonitorsAppState,mstrmojo.vi._MonitorsLayoutMode,mstrmojo.util.ui._HostsSplitter,mstrmojo._HasPopup],{scriptClass:"mstrmojo.vi.ui.rw.FilterPortlet",markupString:'<div id="{@id}" class="mstrmojo-VIPanel {@cssClass}" style="{@cssText}" mstrAttach:mouseover,mouseout,click><div class="mstrmojo-VIPanel-titlebar"></div><div class="mstrmojo-VIPanel-content"></div><div class="mstrmojo-summary-Label"></div><div class="mstrmojo-VIDND-mask"></div><div class="mstrmojo-VIPanel-handle splitter v"></div></div>',markupSlots:{titlebarNode:function(){return this.domNode.firstChild;},containerNode:function(){return this.domNode.childNodes[1];},summaryNode:function(){return this.domNode.childNodes[2];},maskNode:function(){return this.domNode.childNodes[3];},handleNode:function(){return this.domNode.lastChild;}},layoutConfig:{h:{titlebarNode:"20px",containerNode:"100%",handleNode:"4px"},w:{titlebarNode:"all",containerNode:"all"},xt:true},canCollapse:true,showTitleBarContextMenu:true,srcId:"",selector:null,summaryBar:null,init:function AE(Ad){this._super(Ad);if(!!mstrApp.isWSStyling){this.layoutConfig={h:{titlebarNode:"26px",containerNode:"100%",handleNode:"1px"},w:{titlebarNode:"all",containerNode:"all",handleNode:"all"},xt:true};}if(this.isVisFilter()||a.walk("selector.node.data.disabled",this)){this.isCollapsed=true;this.set("isCollapsed",true);this.titleBar.set("isCollapsed",true);}},getLayoutOffsets:function(){return(!!mstrApp.isWSStyling)?{h:0,w:mstrApp.isWorkstation&&x.isMac()?16:18}:this._super();},postBuildRendering:function Ac(){var Ah=this.handleNode;AX.addClass(Ah,"showSplitter "+mstrApp.getThemeClassName());AX.removeClass(Ah,"v");AX.addClass(Ah,"h");Ah.style.cursor=this.isCollapsed?AU:m;if(this.isCollapsed){this.unRegisterSplitter(this.handleNode);}else{this.registerSplitter(this.handleNode);}var Ag=this.titleBar,Af=Ag.lblTitle,Ad=Af.onclick;Af.onclick=function(Ai){var Ak=this._timeoutClick,Aj=this;if(!Ak){this._timeoutClick=window.setTimeout(function(){Ad.call(Af,Ai);Ag.btnCollapse.onclick(Ai);delete Aj._timeoutClick;},A);}};if(this.isVisFilter()){Ag.btnCollapse.src=k;AX.addClass(this.titlebarNode,AT);this.domNode.style["padding-right"]="13px";Af.onTextEditComplete=function(Ao,Aj){var An=this.text,Am=this.parent.parent,Ai=Am.selector,Al=Ai.k,Ak=Ai.model;if(Ao){Ak.renameRWUnitTitle(An,Aj,Al,{success:function(Ap){Am.set("baseTitle",Ap);},failure:function(Ap){mstrmojo.err(Ap);Am.set("baseTitle",Aj);}});}};}f(this.titlebarNode,this.domNode);if(this.isCollapsed&&!this.summaryBar&&!this.selector.isInvalid){this.addChildren(AG.call(this,o.call(this)));}this.height=Math.max(parseInt(this.height,0),Q)+"px";if((mstrApp.isAppStatePresentation&&mstrApp.isAppStatePresentation())||(mstrApp.isLayoutModePreview&&mstrApp.isLayoutModePreview())){this.draggable=false;}var Ae=this._super();z.call(this);return Ae;},onAppStateChange:function AI(Af){var Ak=mstrmojo.vi.VisualInsightApp.APP_STATES,Ae=Ak.PRESENTATION,Ah=Af.value&Ae,Aj=mstrApp.isAppStatePause(),Ai=!!(Af.valueWas&Ak.PAUSE);if(Ah||(Af.valueWas&Ae)){this.draggable=!(Ah||mstrApp.isLayoutModePreview());this.generateToolbar();}if(Aj&&!Ai){var Ad=this.selector,Ag=Ad&&Ad.node&&Ad.node.data;if(Ag&&Ag[C.DISABLED]){this.isCollapsed=true;this.set("isCollapsed",true);this.titleBar.set("isCollapsed",true);}}},onLayoutModeChange:function F(Ad){var Ae=mstrApp.isLayoutPreview(Ad.value);if(Ae||mstrApp.isLayoutPreview(Ad.valueWas)){this.draggable=!(mstrApp.isAppStatePresentation()||Ae);this.generateToolbar();}},getFormats:function AD(){var Ad=this.selector.getFormats();delete Ad.left;delete Ad.top;return Ad;},getTitleBarCfg:function w(){var Ae=this._super(),Ad=this.selector,Ah=this;Ae.isCollapsed=this.isCollapsed;this.baseTitle=Ae.title;this.title=Ae.title=l.call(this);Ae.useRichTooltip=true;Ae.updateTooltipConfig=function Ai(Ak){if(Ad&&Ad.isInvalid){var Al=Ah.domNode;this.richTooltip={posType:mstrmojo.tooltip.POS_TOPLEFT,content:this.getTooltipContent(Ak),refNode:Al,top:3,left:Al&&(Al.getBoundingClientRect().width+5),cssClass:"vi-regular vi-tooltip-C"};}else{return this.constructor.prototype.updateTooltipConfig.call(this,Ak);}};Ae.shouldShowTooltip=function Ag(Ak,Al){this._showTooltipForSameNameObj=AP(Ad);return this.constructor.prototype.shouldShowTooltip.call(this,Ak,Al)||this._showTooltipForSameNameObj||Ad.isInvalid;};Ae.getTooltipContent=function Af(Ak){if(Ad&&Ad.isInvalid){return Ad.getInvalidTooltip();}return this.constructor.prototype.getTooltipContent.call(this,Ak)+(this._showTooltipForSameNameObj?"("+mstrmojo.string.encodeHtmlString(AR(Ad).join(","))+")":"");};Ae.getTitleChildrenLayoutOffsets=function Aj(){return{h:2,w:3};};Ae.layoutConfig={w:{leftToolNode:"18px",textNode:"100%",rightToolNode:"22px"},h:{leftToolNode:"100%",textNode:"100%",rightToolNode:"100%"},xt:true};if(Ad.isInvalid){Ae.canCollapse=false;}return Ae;},onisCollapsedChange:function O(){if(this.isVisFilter()){this.isCollapsed=true;this.clickToCollapse();return ;}var Ak=this,Aj=Ak.k,Af=this.selector,Ai=Af.model,Ah=this.isCollapsed,Ad=Ah?1:0;Af.defn.set("ds",Ad);Af.set("visible",!Ah);this.handleNode.style.cursor=this.isCollapsed?AU:m;if(this.isCollapsed){this.unRegisterSplitter(this.handleNode);}else{this.registerSplitter(this.handleNode);}if(!this._onCollapseAll){var Am=Ai.getVIComponent(b.FILTER_PANEL),Ag=function(){Am.raiseEvent({name:"filterPanelUpdated"});};Ai.execute({execute:function(){this.submit(Ai.getUnitFormatAction(Af,1,{FormattingView:{WindowState:Ad}}),{success:function(){if(!Ah&&!Ak.isVisFilter()){Af.expandOrEditToFetchElements();}Ag();}},a.copy(mstrmojo.DocDataService.REQUEST_ONLY_DEFINITION,{resolveOnly:true}));},urInfo:{callback:{success:function(An){Ai.updateDefnCache(An.defn,[Aj]);Am.rebuildChild(Am.children.filter(function(Ao){return Ao.k===Aj;})[0]);Ag();}},treesToRender:1}});}var Ae=this.summaryBar;if(Ah&&!Af.isInvalid){var Al=o.call(this);if(!Ae){this.addChildren(AG.call(this,Al));}else{Ae.set("text",Al);Ae.set("title",Al);Ae.render();}}else{if(Ae){Ae.unrender();this.removeChildren(Ae);}}},oncountChange:function R(){this.set("title",l.call(this));},onbaseTitleChange:function U(){this.set("title",l.call(this));},clearFilters:function AL(){var Ad=this.selector;if(Ad){Ad.clearSelector();W(Ad);}},updateSummaryBar:function h(Af){var Ad=this.selector,Ae=Ad&&Ad.content;if(Ae&&Ad.style===AY.VISUALIZATION){Ae.updateSummaryText(Af);W(Ad);}},refreshFilterSummaryBar:function AK(){var Ad=this.selector;if(Ad){W(Ad);}},getSplitterInfo:function M(){return{min:v};},splitterMoved:function AA(Aj){var Al=parseInt(this.height,10)+Aj+"px",An,Af=this.selector,Ai=Af.model,Ad=this.handleNode,Ak=this,Ao=Ak.parent,Ae=function(Ap){var Aq=Ak;if(!Aq.parent){(Ao.children||[]).forEach(function(Ar){if(Ar.k===Aq.k){Aq=Ar;}});}An=Aq.height;Aq.set("height",Ap);Ad.style.top="";Aq.doLayout();Af.getFilterPanel().updateScrollbars();};Ae(Al);var Ah=Ai.getUnitFormatAction(Af,1,{FormattingSize:{Height:mstrmojo.boxmodel.px2Inches(Ai.getZoomProps(),Al)}}),Am={success:function(Ap){Ai.updateDefnCache(Ap.defn,[Af.k]);}},Ag={style:{params:{treesToRender:1}}};Ai.execute({execute:function(){this.submit(Ah,Am,Ag);},urInfo:{undo:function(){Ae(An);},redo:function(){Ae(An);},callback:Am,extras:Ag}});},setSlotDimensions:function K(Af,Ae,Ad){if(Af!=="containerNode"){this._super(Af,Ae,Ad);}},doLayout:function u(){this._super();var Ad=this.domNode;if(Ad){Ad.style.height="auto";}},addMenuItems:function X(Af){var At=this,An=At.selector,Ar=An&&An.isInvalid,Al=function Al(){var Aw=An.model;if(At.isVisFilter()){At.closeVisSelectorPanel();Aw.deleteVisFilterStackSelectors(An);}else{var Av=!!(An.isFilterNothing&&An.isFilterNothing());Aw.deleteFilterStackSelectors([An.defn],Av);}};Af.isHostedWithin=false;Af.hostId=this.id;Af.supportsScroll=true;Af.maxHeight=x.getMaxScrollHeight();if(Ar){Af.addMenuItem(mstrmojo.desc(629,"Delete"),"Delete",Al);return ;}this.addModeMenuItems(Af,An,function(){W(An);});Af.addSeparator();this.addShowAllMenuItem(Af,An);Af.addSeparator();var Ad=An.ckey,Am=An.getFilterPanel(),Ao=this.id,As=mstrApp.isAppStatePresentation(),Aj=An.defn.srcid,Ae=An.model,Ai=Ae.isFromMDXCube(Aj),Ag=Ae.isFromSolrCube(Aj);this.addClearFilterMenuItem(Af,An,function(){Am.clearSingleBuffSlice(Ad);W(An);});Af.addSeparator();this.addQualMenuItems(Af,An);if(!As){if(An.isAttributeSelector()&&!Ai&&!Ag){Af.addEditorMenuItem(mstrmojo.desc(13628,"Filter by Rank"),Ao,d);}Af.addSeparator();this.addSetDisplayFormsMenuItem(Af,An);Af.addSeparator();if(!Ag){this.addFilterStyleMenuItem(Af,An);}this.addMultiSelectMenuItem(Af,An);this.addAutoSearchMenuItem(Af,An);Af.addSeparator();}if(An.supportsSetTarget()&&!Ag){this.addMenuItemIfSelectTargetsValid(Af,An,mstrmojo.desc(11572,"Select other filters within the Filter panel."));Af.addSeparator();}if(!As&&An.style===mstrmojo.DocSelector.STYLES.VISUALIZATION){this.addConfigVisSelectorMenu(Af,An);Af.addSeparator();}if(!As){this.addReplaceWithMenuItem(Af,An);Af.addSeparator();if(At.isVisFilter()){Af.addMenuItem(mstrmojo.desc(1388,"Rename"),"rnm",function(){At.titleBar.lblTitle.set("isEditing",true);});}Af.addMenuItem(mstrmojo.desc(629,"Delete"),"Delete",Al);}var Ak=Af.menus,Aq=Ak.length,Ap,Au=-1,Ah=Aq;if(Ak&&Aq>1){for(Ap=0;Ap<Aq;Ap++){if(Ak[Ap].cls!=="seperator"){break;}Au=Ap;}for(Ap=Aq-1;Ap>=0;Ap--){if(Ak[Ap].cls!=="separator"){break;}Ah=Ap;}Af.menus=Ak.slice(Au+1,Ah);}},getTargetInfo:function n(){var Ad=this.selector,Af=Ad.model;var Ae=Ad.getFilterPanel().getFilterDefinitions().filter(function(Ag){return(Ag.ckey!==Ad.ckey)&&((Ag.srct===AM&&Ag.style!==AY.ATTR_QUAL)||Ag.srct===AW||Ag.srct===I);}).map(function(Ag){return{n:Ag.ttl,id:Ag.ckey,st:Ag.style,src:Af.getObjectInfo(Ag.srcid)};});return{keys:(Ad.defn.tks||"").split(AH).filter(function(Ag){return Ae.some(function(Ah){return Ah.id===Ag;});}),items:Ae};},isVisFilter:function p(){return this.selector.style===AY.VISUALIZATION;},clickToCollapse:function G(){if(!this.isVisFilter()){return ;}var Ae=this.parent&&this.parent.parent,Ah=Ae&&Ae.model,Ag=this.k,Ai=this,Ad=this.selector;if(mstrApp.isAppStatePause&&mstrApp.isAppStatePause()){if(mstrApp.isInVFConfigMode){return ;}var Af=Ah.addVisFilterContainer(),Ak=Ah.getSelectedViUnit(),Aj;Ah.oldSelectedVizBoxId=Ak.id;mstrApp.isInVFConfigMode=true;mstrApp.restoreVFKey=Ag;Aj=Ah.insertVizBox(Ag,Af,{});Ah.controller.rootCtrl.initPanelStautsInConfigMode();Ah.selectVIUnit(Aj.id,true,{isAddAction:true});mstrApp.getRootController().enterVizFilterConfigMode(Ad.parent.baseTitle,true);return ;}if(Ah){Ai.openVizSelectorPanel(Ag,Ah);}},openVizSelectorPanel:function E(Af,Ae){if(!Af||!Ae||q){return ;}var Ad=this.selector;mstrApp.isInVFInteractMode=true;q=new AQ({nodeKey:Af,model:Ae,filterPortlet:this,include:Ad.include});AX.addClass(this.domNode,j);this.openPopup(q);Ae.cachePrevSelectedUnitId();},updateVizSelectorPanel:function e(){var Ad=this.selector&&this.selector.node;if(q&&Ad){q.updateVis(Ad);}},updateVisFilterTitle:function AZ(){if(q){q.updateTitleBar();}},closeVisSelectorPanel:function B(){if(q){q.cancelSelections();}},resetVisFilterState:function AS(){AX.removeClass(this.domNode,j);q=null;mstrApp.isInVFInteractMode=false;delete this._lastOpened;},updateForScroll:function AC(){if(mstrApp.isInVFInteractMode&&q){q.updateFormats();}},destroy:function H(){if(q){q.cancelSelections();}if(this._super){this._super();}}});}());(function(){mstrmojo.requiresCls("mstrmojo.Container","mstrmojo._HasLayout","mstrmojo.vi.ui.toolbars._HasToolbar","mstrmojo.vi.ui._IsDropTarget","mstrmojo.vi.ui._IsViPanel","mstrmojo.vi.ui._IsBoxLayoutChild","mstrmojo.vi.ui._HasMask","mstrmojo.vi._MonitorsAppState","mstrmojo.vi._MonitorsLayoutMode","mstrmojo.DocSelector","mstrmojo.vi.ui.toolbars.TitleToolbar");var C=mstrmojo.DocSelector.STYLES;function I(){var P=this.unit;if(P){var O=mstrmojo.all[P.id];this.removeChildren(O);O.destroy();this.set("unit",null);}}mstrmojo.vi.ui.PageByPanel=mstrmojo.declare(mstrmojo.Container,[mstrmojo._HasLayout,mstrmojo.vi.ui.toolbars._HasToolbar,mstrmojo.vi.ui._IsViPanel,mstrmojo.vi.ui._IsBoxLayoutChild,mstrmojo.vi.ui._HasMask,mstrmojo.vi._MonitorsAppState,mstrmojo.vi._MonitorsLayoutMode],{scriptClass:"mstrmojo.vi.ui.PageByPanel",markupString:'<div id="{@id}" class="mstrmojo-VIPageByStack" style="{@cssText}"><div class="mstrmojo-VIPageByStack-Values horizontal"></div><div class="mstrmojo-VIPageByStack-Toolbar"></div><div class="mstrmojo-VIDND-mask"></div></div>',markupSlots:{containerNode:function(){return this.domNode.firstChild;},toolbarNode:function(){return this.domNode.childNodes[1];},maskNode:function(){return this.domNode.lastChild;}},markupMethods:{onvisibleChange:mstrmojo.Widget.visibleMarkupMethod,onunitChange:function(){if(this.hasRendered){this.generateToolbar();this.doLayout();this.pageByStack.doLayout();}}},layoutConfig:{h:{toolbarNode:"100%",containerNode:"100%",maskNode:"100%"},w:{toolbarNode:"auto",containerNode:"all",maskNode:"all"},xt:true},unit:null,parent:null,pageByStack:null,useRichTooltip:true,isDynamicTooltip:true,getLayoutOffsets:function H(){return{h:2,w:2};},children:[{scriptClass:"mstrmojo.vi.ui.toolbars.TitleToolbar",alias:"toolbar",slot:"toolbarNode"}],onAppStateChange:function D(O){this._super(O);var P=mstrmojo.vi.VisualInsightApp.APP_STATES,R=O.value,Q=this.toolbarNode;this.set("isMasked",mstrApp.isAppStateSelection());if(Q){Q.style.display=mstrApp.isAppStatePresentation()?"none":"";}},onLayoutModeChange:function B(O){if(this.hasRendered){this.adjustInPreviewMode();}},preBuildRendering:function J(){var O=this.parent;this.model=O.model;this.builder=O.builder;return this._super();},adjustInPreviewMode:function E(){var Q=parseInt(this.parent.width,10)||0,P=mstrmojo.vi.ui.rw.DocRelativePanel.getLayoutBreakPoint(),O=this.domNode;if(mstrApp.isLayoutModePreview()){var R=Math.min(Q,P);this.set("width",R+"px");if(O){O.style.left=Math.max(Q-P,0)/2+"px";}}else{this.set("width",Q+"px");if(O){O.style.left="0px";}}},moveTooltip:function F(O,Q){this.richTooltip=null;var P=this.unit;if(P){this.richTooltip={posType:mstrmojo.tooltip.POS_TOPLEFT,cssClass:"vi-regular vi-tooltip-A",content:P.n,top:O.clientY+15,left:O.clientX-15};}this._super(O,Q);},updateToolbar:function N(P){var Q=P.ENUM_CORNERS;P.setAlignment(Q.BOTTOM_RIGHT,Q.TOP_RIGHT);P.isHostedWithin=false;var U=this.unit,R=this.parent.model;if(U){var O=U.style,S=function(X,W){var V=W===O?"on":"";P.addMenuItem(X,V,function(Z){var Y=Z.ctxt.style;if(Y===O){return false;}R.changePageByStyle(mstrmojo.all[U.id],Y);return true;},{style:W});P.hasToggleItem=true;};S(mstrmojo.desc(4734,"Button Bar"),C.BUTTON);S(mstrmojo.desc(4730,"Slider"),C.SCROLLER);S(mstrmojo.desc(4729,"Drop-down"),C.PULLDOWN);P.addSeparator();P.addMenuItem(mstrmojo.desc(629,"Delete"),"cls",function(){mstrmojo.warn(mstrmojo.desc(13245,"This action will permanently delete the page-by panel. A new one can be created by inserting a new filter. Do you want to proceed?"),{confirmBtn:{t:mstrmojo.desc(1442,"OK"),fn:function(){I.call(this);this.model.removePageByUnit(this,U);}.bind(this),isHot:true},cancelBtn:{t:mstrmojo.desc(221,"Cancel")}});}.bind(this));}return this._super(P);},widgetResized:function G(){if(this.hasRendered&&mstrApp.isLayoutModePreview()){this.adjustInPreviewMode();}},close:function L(){this.setOpenStatus(false);},setOpenStatus:function M(P,O){var R=this._super,Q=this.id;if(P&&!this.pageByStack){this.model.loadHiddenPageByStack(this.builder,function(){R.call(mstrmojo.all[Q],P,true);});}else{R.call(this,P,O);}},getPanelSaver:function(){return mstrmojo.vi.models.PanelFormatSaver.getPanelSaver(this.model,{visible:{set:"FormattingAppearance",name:"Visible"}},this.pageByStack);},setPageByStack:function A(P){var O=this.pageByStack;if(O){this.removeChildren(O);O.destroy();}if(P){P.slot="containerNode";P.alias="pageByStack";this.addChildren([P]);}},resetLayout:function K(){this.parent.buildBoxLayout(true);this.parent.doLayout();}});mstrmojo.vi.ui.PageByPanel.boxConfiguration={f:{h:32,v:45},o:"v",r:true};}());(function(){mstrmojo.requiresCls("mstrmojo.func","mstrmojo.boxmodel","mstrmojo.Model","mstrmojo.VisUtility","mstrmojo.elementHelper","mstrmojo._CanProxyCallback","mstrmojo.EnumRWUnitType","mstrmojo.models.template.DataInterface","mstrmojo.StringBuffer","mstrmojo.EnumReadystate","mstrmojo.vi.viz.EnumVizStyles","mstrmojo.vi.viz.EnumWidgetTypes","mstrmojo.DocSelector","mstrmojo.MetricSelectorUtility","mstrmojo.UUID","mstrmojo.ExpressVisList","mstrmojo.vi.enums.EnumThemeProperties","mstrmojo.vi.models.VIComponentMap");var BB=mstrmojo.EnumRWUnitType,P=mstrmojo.EnumReadystate,a=mstrmojo.hash,BU=a.forEach,BS=mstrmojo.func.wrapMethods,BN=mstrmojo.Obj.free,R=mstrmojo.array,Ad=mstrmojo.boxmodel,D=mstrmojo.mixin,Ay=mstrmojo.VisUtility,k=mstrmojo.elementHelper,BP=mstrmojo.MetricSelectorUtility,AX=mstrmojo.UUID,At=mstrmojo.vi.viz.EnumVizStyles,Bc=mstrmojo.vi.viz.EnumWidgetTypes,C=mstrmojo.DocSelector.DATAPARAMS,m="\u001E";var H={},c={},BY="76CB9F3E366345DF89811386CBAA82CB",Aq=mstrmojo.vi.enums.EnumThemeProperties.ENUM_LAYOUT_STYLE.DEFAULT,S=[11826975,1381846,1810715,950271,12407690,2276796,13614615,8355711,15255470,9869567,9101208,7912447,14004421,9296859,15063710,13092807],K=mstrmojo.vi.models.VIComponentMap.TYPES.FILTER_STACK,Ae={ESRIMapVisualizationStyle:"com.microstrategy.web.vf.viewer.EsriMapApplicationViewer",GoogleMapVisualizationStyle:"com.microstrategy.web.vf.viewer.GoogleMapApplicationViewer",MapboxVisualizationStyle:"com.microstrategy.web.vf.viewer.MapboxApplicationViewer",KPICardVisualizationStyle:"com.microstrategy.web.vf.viewer.KPICardApplicationViewer"},q="com.microstrategy.web.vf.viewer.CustomVisApplicationViewer";mstrmojo.MultiRWUnitFormatEventsType=null;var Af={isObservable:function(Bg){var Bf=Bg&&Bg.t;if((!Bf&&Bf!==BB.LAYOUT)||!this.hasOwnProperty(Bf)||Bg.scriptClass){return false;}return(Bf!==BB.SUBSECTION||!Bg.dt);},makeObservable:function(Bf){var Bg=Bf.audibles=this[Bf.t]||{};if(Bg.hasOwnProperty("readyState")){Bf.readyState=P.IDLE;}return new mstrmojo.Model(Bf);}};Af[BB.PANELSTACK]={"*":false,selKey:true,readyState:true};Af[BB.GRID]={"*":false,readyState:true,ds:true};Af[BB.GRAPH]={"*":false,readyState:true,ds:true};Af[BB.GRIDGRAPH]={"*":false,qsm:true,ds:true};Af[BB.SUBSECTION]={"*":false,resize:true,adjustSize:true};Af[BB.VISUALIZATION]={"*":false,ds:true};Af[BB.SELECTOR]={"*":false,cek:true,ds:true,readyState:true};Af[BB.MOJOVISUALIZATION]={"*":false,ds:true};Af[BB.LAYOUT]={"*":false,readyState:true};var A6={};function BE(Bf){return A6[Bf]||A6["*"];}A6["*"]={update:function AA(Bg,Bh,Bf,Bi){a.copy(Bf,Bh);if(Bf&&!Bf.ck){delete Bh.ck;}if(Bf&&!Bf.fs){delete Bh.fs;}}};A6[BB.PANEL]=D({update:function AA(Bg,Bh,Bf,Bi){delete Bh.layoutXML;if(Bh.isNavigation){delete Bh.exp;}this._super(Bg,Bh,Bf);}},A6["*"]);function u(Bk,Bl){var Bg=Bk&&Bk.layoutMap&&Bk.layoutMap[Bl];if(Bg){if(!Bg.t){Bg.t=BB.LAYOUT;}if(Af.isObservable(Bg)){Bg=Bk.layoutMap[Bl]=this.addDisposable(Af.makeObservable(Bg));}return Bg;}var Bf=Bk&&Bk.layouts,Bj=(Bf&&Bf.length)||0,Bi;for(Bi=0;Bi<Bj;Bi++){if(Bf[Bi].k===Bl){var Bh=Bf[Bi];if(!Bh.t){Bh.t=BB.LAYOUT;}if(Af.isObservable(Bh)){Bf[Bi]=this.addDisposable(Af.makeObservable(Bh));}return Bf[Bi];}}return null;}function AO(Bi,Bk,Bh,Bg){var Bf=u.call(this,Bi,Bk);if(Bh===Bk){Bf._lkz=Bk;return Bf;}if(Bf){var Bj=Bf.units[Bh];if(Bj){if(parseInt(Bj.t,10)===BB.GRIDGRAPH){if(!Bf.units[Bh+"_0"]){Bf.units[Bh+"_0"]={ck:Bj.ck,fmts:Bj.fmts.gd,txi:Bj.txi,t:BB.GRID};Bf.units[Bh+"_1"]={ck:Bj.ck,fmts:Bj.fmts.gp,t:BB.GRAPH};}}if(!Bg&&Af.isObservable(Bj)){Bj=Bf.units[Bh]=Af.makeObservable(Bj);this.disposables.push(Bj);}Bj._lkz=Bk;}}return Bf&&Bf.units[Bh];}function Al(Bj,Bi,Bh,Bf){var Bg=this.getChildren(Bj,Bi,0);return(mstrApp.isMobile?(R.filter(Bg,function(Bm){var Bk=Bh&&Bh.indexOf(Bm.defn.t),Bl=Bm.defn.dk;return Bf?(Bk>-1&&Bl===-1):(Bk<0||Bl!==-1);})):(Bf?[]:Bg));}var M=function(Bf,Bg){var Bh=new mstrmojo.StringBuffer();if(Bg){Bh.append("*l"+Bg);}Bh.append("*k"+Bf.k);if(Bf.hasOwnProperty("wid")){Bh.append("*x"+Bf.wid);}Bh.append("*t"+this.buildTime);return Bh.toString();};function AZ(Bh){var Bg,Bf,Bk=this.delta,Bi=this.pendingUpdate=this.pendingUpdate||{},Bj=[];if(!a.isEmpty(Bk)){Bj.push("<updates>");for(Bg in Bk){if(Bk.hasOwnProperty(Bg)){Bf=Bk[Bg];Bj.push(Bf.getUpdates());}}Bi[Bh]=Bk;this.delta={};Bj.push("</updates>");}return Bj.join("");}function Ba(Bk,Bg){var Bj;if(Bk){var Bf=R.isArray(Bk)?Bk:Bk.split(Bg||m),Bi=Bf.length,Bh;for(Bh=0;Bh<Bi;Bh++){Bj=Bj||{};Bj[Bf[Bh]]=AO.call(this,this.defn,this.currlaykey,Bf[Bh]);}}return Bj;}function AD(Bf,Bg){return mstrmojo.all[M.call(this,{k:Bf,wid:Bg},this.currlaykey)];}function A7(Bg,Bf){var Bh=this.getLayoutUnitDefn(Bg,Bf);return(Bh&&Bh.t===BB.PANELSTACK&&Bh.ifw);}function A9(Bg,Bf){return !Bf||(Bg.wid===Bf);}function t(Bj,Br){var Bm=this,Bs=Bm.getSliceCallback(Br),Bh=Bs.shared,Bt=Br.tks,Bg=Br.eid,Bp=Bm.getDataService();if(!Bt){return ;}var Bo=AO.call(Bm,Bm.defn,Bm.currlaykey,Bg);if(!Bo){return ;}var Bl=Bg,Bn=Bh.tgtDefs[Bt],Bf=function(){Bn.set("selKey",Bg);},Bi;Bn.newSelKey=Bg;if(Bo.l){var Bk=Bo.dirtyKeys;if(!!Bk){Bl=a.keyarray(Bk).join(",");Bh.orignalTargetDefs=Bh.tgtDefs=Ba.call(Bm,Bl,",");Bi=function(){Bf();BU(Bh.dataCacheUpdate.upd,function(Bu,Bv){var Bw=mstrmojo.all[Bv];if(Bw&&Bw.setDirty){Bw.setDirty(false);}});};}else{if(Br.skipServerCall){Bf();return ;}Bp.requestPanelChangeDeferred(Bj,Bg,null,false,false,Bm.newCallback({method:"slice",success:Bf}));return ;}}else{Bi=function(){Bf();Bo.l=true;};}var Bq=Bs.success;Bs.success=function(Bv){if(!Bm.checkStatus(Bv)){return ;}Bm.updateDefnCache(Bv.defn,[Bg]);Bq(Bv);Bi();var Bu=AD.call(Bm,Br.tks,0);if(Bu){Bu.clearDirtyChild(Bg);}};Bp.requestPanelChangeDeferred(Bj,Bg,Bl,true,!Br.hasLoader,Bs);}function Z(Bf,Bg){if(Bg[C.ELMSREADY]){Bf[C.ELMSREADY]=Bg[C.ELMSREADY];Bf.elms=Bg.elms;}if(Bg[C.CESREADY]){Bf[C.CESREADY]=Bg[C.CESREADY];Bf.ces=Bg.ces;}if(Bg[C.ELMSREQUEST]){Bf[C.ELMSREQUEST]=Bg[C.ELMSREQUEST];}if(Bg[C.METRICVALUES]){BP.restoreMetricSelectorProps(Bf,Bg);Bf[C.METRICVALUES]=Bg[C.METRICVALUES];}if(Bg[C.CSREADY]){Bf[C.CSREADY]=Bg[C.CSREADY];BP.restoreMetricSelectorSelections(Bf,Bg);}if(Bg[C.DISABLED]){Bf[C.DISABLED]=Bg[C.DISABLED];}}function f(Bg,Bf){if(Bg.defn&&Bg.defn.t>=BB.GRID){mstrmojo.models.template.DataInterface.inflateGridData(Bg.data);}var Bi=Bg.id,Bh=Bf[Bi]&&Bf[Bi].data;if(mstrApp.isAppStatePause&&mstrApp.isAppStatePause()&&Bh&&Bg.defn.t===BB.SELECTOR){if(!Bg.data){Bg.data={};}Z(Bg.data,Bh);}Bf[Bg.id]=Bg;return Bg;}function Ai(B0,Bp,Bf,Bl){var Bt=this.currlaykey,Bi;if(B0){Bi=B0.defn;Bt=(Bi&&Bi._lkz)||B0.k;}var CB=this.getLayoutDataCache(Bt),B1=(!Bf&&!a.isEmpty(CB)),B7;if(!B0){B7=this.data;}else{var Bo=B0.data||B0;if(B1){B7=CB[M.call(this,Bo,Bt)];B7=(B7&&B7.data)||B7||Bo;}else{B7=Bo;}}if(!!B7.sections){this._buildingLayoutKey=B7.k;}var Bg=B7?this.extractChildren(B7):[],Bv=[];var B4=(Bg&&Bg.length)||0;if(B4){Bi=this.defn;var Bx=!B0,Br=B0?Bt:null,Bk=(B0&&((B0.defn)?B0.defn.t:AO.call(this,Bi,Br,B0.k).t));var Bh=(Bk===BB.GRIDGRAPH),B5=(Bk===BB.DETAILS),B3,B2;Bg=Bp(Bg);for(B3=0,B2=Bg.length;B3<B2;B3++){var B9=Bg[B3];if(Bh){B9.k=B0.k;B9.wid=B0.data.wid;}var CD=B9.k,Bs=B9.wid,Bz=M.call(this,B9,Br),CA=!Bx&&A7.call(this,CD,Br),B8;if(!Bx&&CA&&(!Bf||!this.getInfoWinByKey(CD))){var B6=this.getLayoutUnitDefn(CD),Bw=f({data:B9,defn:B6,id:Bz,k:CD,p:B7},CB);if(!this.getInfoWinByKey(CD,Bs)){var Bj=this.infoWindows=this.infoWindows||{};Bj[B6.n]=Bw;this.addInfoWinByKey(CD,Bw);}continue;}else{if(!Bx&&CA&&Bf){var Bm=this.getInfoWinByKey(CD,Bs);if(Bm){this.mergeInfoWin(B9,Bm.data,this.getCurrentLayoutKey());}}}if(Bh){Bz+="_"+B3;B8=AO.call(this,Bi,Br,B9.k+"_"+B3);}else{B8=AO.call(this,Bi,Br||B9.k,B9.k);}if(B5){B8.dt=true;}if(CB===null&&(B8.t===BB.LAYOUT)){CB=this.getLayoutDataCache(B9.k);}var CC;if(B8.t===BB.PANEL&&CB[Bz]&&B1){var Bn=this.extractChildren(B9)||[],Bu=this.extractChildren(CB[Bz].data)||[],Bq=false;if(Bn.length!=Bu.length){R.forEach(Bu,function(CF){var CE=R.find(Bn,"k",CF.k);if(CE>-1){Bn[CE]=CF;Bq=true;}});if(Bq){Bu.splice(0,Bu.length);R.forEach(Bn,function(CE){Bu.push(CE);});}}CC=B9;}else{CC=B1?(CB[Bz]&&CB[Bz].data)||B9:B9;}var By={k:B9.k,id:Bz,defn:B8,data:CC,p:B7};if(!CB[Bz]){f(By,CB);}Bv.push(By);}}return Bl?{nodes:Bv,total:B4}:Bv;}function Bb(Bl,Bg,Bk){var Bf=Ad.px2Inches,Bh=this.getZoomProps(),Bj=1,Bi=2;if((Bk&Bj)>0){Bl.FormattingPosition={Left:Bf(Bh,Bg.x||0),Top:Bf(Bh,Bg.y||0)};}if((Bk&Bi)>0){Bl.FormattingSize={Height:Bf(Bh,Bg.h||0),Width:Bf(Bh,Bg.w||0)};}}function AH(Bg){function Bf(Bi,Bh){return Bi<Bh?-1:(Bi>Bh?1:0);}Bg.sort(function(Bi,Bh){var Bj=Bf(Bi.levelID,Bh.levelID);return Bj!==0?Bj:Bf(Bi.elemID,Bh.elemID);});return Bg;}function BX(Bf,Bg){return Bf.map(function(Bh){return Bh[Bg];}).join(m);}function O(Bf){return BX(Bf,"levelID");}function BZ(Bf){return BX(Bf,"elemID");}function Aa(Bg){if(Bg){c={};}H={};var Bf=this.defn&&this.defn.epm;if(Bf){Bf.forEach(function(Bh){Bh.epmv.forEach(function(Bi){var Bk=AH(Bi.k.chn.map(function(Bn){var Bm=Bn.emt!==2;return{levelID:Bm?Bn.at.did:"-1",elemID:Bm?Bn.ei:Bn.mt.did};})),Bl=O(Bk),Bj=BZ(Bk);if(!H[Bl]){H[Bl]={};}H[Bl][Bj]=JSON.parse(Bi.v.vv);});});}}function l(Bf){if(Bf){Bf=mstrmojo.rw.model.RetrievalKeysConfig.parseResponseFilters(Bf);}return Bf;}function AS(){var Bg=this.data&&this.data.layouts,Bf=Bg[R.find(Bg,"k",this.getCurrentLayoutKey())],Bi=Bf&&Bf.gbys&&Bf.gbys.groupbys,Bh=false;R.forEach(Bi,function(Bj){if(Bj.unit&&Bj.unit.elms&&Bj.unit.elms[Bj.unit.idx].v==="u;"){Bh=true;return false;}});return Bh;}function BI(Bf,Bh,Bg){Bf=Bf.replace(Bh,function(Bi,Bj){if(Bj==="&"){return(Bg+"&");}return Bg;});if(mstrmojo.dom.isIE){Bf+="&cb"+mstrmojo.now()+"=1";}return Bf;}mstrmojo.DocModel=mstrmojo.declare(mstrmojo.Model,[mstrmojo._CanProxyCallback],{scriptClass:"mstrmojo.DocModel",audibles:{"*":false,data:true,tsp:true},features:null,dataCache:null,searchElemsCache:null,controller:null,sdp:null,dpi:96,keySeed:0,currlaykey:"",init:function An(Bf){this._super(Bf);if(!this.features){this.features=new mstrmojo.Model();this.disposables.push(this.features);}this.ondefnChange();Aa.call(this);this.buildTime=mstrmojo.now();},hasFeatures:function Ak(Bj){var Bh=this.features;if(!Bh){return false;}var Bg=Bj.split(","),Bf=Bg.length,Bi;for(Bi=0;Bi<Bf;Bi++){var Bk=Bg[Bi],Bl=Bk.match(/^!/);if(Bl){Bk=Bk.replace("!","");}if(!!Bl===!!Bh[Bk]){return false;}}return true;},makeObservable:function Am(Bf){return Af.makeObservable(Bf);},checkStatus:function BO(Bf){if(parseInt(Bf.status,10)===4){Bf.message=mstrmojo.desc(5781,"Request timed out.");mstrmojo.err(Bf);return false;}return true;},getDataService:function A4(){var Bg=this.dataService;if(!Bg){var Bf={rwb:this.bs,msgId:this.mid,stid:this.stid,cbKey:this.cbKey,model:this};if(mstrApp.modelFactory){Bg=mstrApp.modelFactory.newDataService("Document",Bf);}else{Bg=mstrApp.viewFactory.newDocDataService(Bf);}this.dataService=Bg;this.disposables.push(Bg);}return Bg;},getNextKey:function BC(){return"W"+(mstrmojo.resolveFeature("guid-as-node-identifier")?AX.create():this.keySeed++);},resetKeySeed:function E(Bf){this.keySeed=Bf;},getWidgetId:function L(Bf,Bg){return M.call(this,Bf,Bg||this.getCurrentLayoutKey());},getUIState:function b(){return{};},ondefnChange:function AJ(){var Bk=this.defn,Bh=Bk&&Bk.layouts,Bg={};if(Bk){Bk.layoutMap=Bg;var Bj=(Bh&&Bh.length)||0,Bi;for(Bi=0;Bi<Bj;Bi++){var Bf=Bh[Bi];Bg[Bf.k]=Bf;}}},extractChildren:function AK(Bf){return Bf&&(Bf.sections||Bf.subsections||Bf.objects||Bf.panels||Bf.layouts||Bf.children);},getChildren:function V(Bh,Bg,Bk,Bf,Bj){Bk=Bk||0;var Bi=function(Bl){return Bl.slice(Bk,Bk+(Bf||Bl.length));};return Ai.call(this,Bh,Bi,Bg,Bj);},getChildrenByKey:function Ah(Bh,Bg,Bf,Bj){var Bi=function(Bl){var Bk=[],Bm;R.forEach(Bf,function(Bn){Bm=R.find(Bl,"k",Bn);if(Bm!==-1){Bk.push(Bl[Bm]);}});return Bk;};return Ai.call(this,Bh,Bi,Bg,Bj);},getTargetDefn:function Ag(Bf){return Ba.call(this,Bf);},getUnitDefinitions:function(Bg,Bf){return Ba.call(this,Bg,Bf);},getUnitInstance:function AF(Bf,Bg){return mstrmojo.all[M.call(this,{k:Bf,wid:Bg},this.currlaykey)];},getFirstUnitInstanceByName:function AL(Bi){var Bf=u.call(this,this.defn,this.currlaykey);if(Bf){var Bg=Bf.units,Bh;for(Bh in Bg){var Bj=Bg[Bh];if(Bj.n===Bi){return this.getUnitInstance(Bh,1);}}}return null;},getLayoutUnitDefn:function B(Bg,Bf){return AO.call(this,this.defn,Bf||this.currlaykey,Bg);},mergeInfoWin:function N(Bj,Bi,Bf){if(Bj.k&&Bi.k&&Bj.k===Bi.k){var Bh=this;var Bg=this.getLayoutUnitDefn(Bj.k,Bf);if(Bg&&Bg.t===BB.PANELSTACK){R.forEach(Bi.panels,function(Bl){var Bk=R.filterOne(Bj.panels,function(Bm){return Bm.k&&Bm.k===Bl.k;});if(!Bk){Bj.panels.push(Bl);}else{N.call(Bh,Bk,Bl,Bf);}});}else{R.forEach(Bi.objects,function(Bl){var Bk=R.filterOne(Bj.objects,function(Bm){return Bm.k&&Bm.k===Bl.k;});if(!Bk){if(Bj.objects){Bj.objects.push(Bl);}}else{N.call(Bh,Bk,Bl,Bf);}});}}},getRawLayoutUnitDefn:function d(Bg,Bh,Bf){return AO.call(this,Bh||this.defn,Bf||this.currlaykey,Bg,true);},getSelectedKey:function BJ(Bf){return(!Bf&&this.currlaykey)||null;},getCurrentLayoutKey:function AE(){return this.currlaykey;},getLayoutKeyByUnitKey:function I(Bj){var Bh=this.defn,Bi=Bh&&Bh.layouts,Bf,Bg=null;R.forEach(Bi,function(Bk){Bf=Bk.units;if(Bf[Bj]&&(!Bf[Bj]._isDeleted)){Bg=Bk.k;return !Bf[Bj];}});return Bg;},getLayoutDefn:function As(Bf){var Bg=this.defn,Bh=Bg&&Bg.layouts;return Bh&&Bh[R.find(Bh,"k",Bf)];},getCurrentLayoutDef:function Ax(){return this.getLayoutDefn(this.getCurrentLayoutKey());},replaceLayout:function BR(Bn,Bg,Bo){var Bk=this.defn,Bj=this.data,Bh=Bg&&Bg.defn,Bf=Bg&&Bg.data,Bp=this.dataCache;if(Bp&&Bp[Bn]){Bp[Bn]={};}var Bm=(Bj&&Bj.layouts)||(Bk&&Bk.layouts),Bi,Bl=false;for(Bi=(Bm&&Bm.length-1)||0;Bi>=0;Bi--){if(Bm[Bi].k===Bn){break;}}if(Bo&&Bi<0){Bi=R.find(Bf.layouts||Bh.layouts,"k",Bn);Bl=true;}this.bs=Bg.bs;if(Bf){if(Bl){R.insert(Bj.layouts,Bi,[Bf.layouts[Bi]]);}else{Bj.layouts[Bi]=Bf.layouts[Bi];}Bj.elems=Bf.elems;}if(Bh){if(Bl){R.insert(Bk.layouts,Bi,[Bh.layouts[Bi]]);}else{Bk.layouts[Bi]=Bh.layouts[Bi];}this.ondefnChange();}},loadLayout:function j(Bf,Bh,Bg){this.replaceLayout(Bf.currlaykey,Bf);this.raiseEvent({name:"rebuildLayout",unloadCache:!!Bh,restoreIW:!!Bg});},getLayoutDataNode:function Be(Bg){var Bf=this.data&&this.data.layouts;return R.filterOne(Bf,function(Bh){return Bh.k===Bg;});},getLayoutDataCache:function AB(Bg){if(!Bg){return null;}var Bf=this.dataCache;if(!Bf){Bf=this.dataCache={};}if(!Bf[Bg]){Bf[Bg]={};}return Bf[Bg];},saveRW:function BF(Bg,Bi){var Bh=mstrmojo.desc,Bf=this.getDataService();Bf.saveRW({objName:Bg||this.n,folderID:this.pfid,saveAsFlags:1},Bi||{success:function(Bj){mstrmojo.alert(Bh(3819,"Document Saved")+": "+Bj.n);}});},saveAsRW:function Bd(Bj,Bi){var Bh=this,Bg=!!(mstrApp.isAppStatePause&&mstrApp.isAppStatePause()||mstrConfig&&mstrConfig.resolveOnly),Bf=Bh.prompt_option;switch(Bf){case 0:Bf=3;break;case 4:Bf=1;break;default:Bf=2;}var Bk=mstrmojo.hash.copy(Bj,{evt:3102,applyChanges:false,executionMode:2,parentFolderID:mstrApp.saveFolderId||Bh.sfid||Bh.pfid,saveFromDesignMode:false,saveAsReportSaveAsFlags:Bf,resolveOnly:Bg,rwb:Bh.bs});if(Bi){Bk.target=Bi;Bk.saveAsOrigin=13;}mstrmojo.form.send(Bk,null,"post");},getDocPropsActions:function AW(Bf){var Bg={act:"setDocumentProperties",props:Bf};a.forEach(Bf.RWDocumentProperties,function(Bi,Bh,Bj){Bj[Bh]=String(Bi);});return Bg;},saveDocProps:function AV(Bf,Bh,Bi,Bm){var Bl=this.getDataService(),Bk=Bi?null:mstrmojo.DocDataService.RAPID_EXEC,Bg=mstrmojo.DocDataService.REQUEST_DEFN_DATA,Bj=[this.getDocPropsActions(Bf)];if(Bh){this.controller.cmdMgr.execute({execute:function(){this.submit(Bj,Bm||{},a.copy(Bg,a.copy(Bk,{})));},urInfo:Bh});}else{Bl.submitUpdates(Bj,Bm||{},a.copy(Bg,a.copy(Bk,{preserveUndo:true})));}},partialUpdate:function AQ(Bk,Bf,Bi,Bh,Bg){if(Bi){this.updateDefnCache(Bi,Bh,Bg);}if(Bk){if(mstrApp){mstrApp.isPartialUpdate=true;}var Bj=this.updateDataCache(Bk,Bf,undefined,Bg);this.raiseEvent({name:"partialUpdate",tree:Bk,ids:Bj});if(mstrApp){mstrApp.isPartialUpdate=false;}return Bj;}},refreshDefinition:function h(Bi,Bh,Bg,Bj){var Bf=this.getLayoutUnitDefn(Bi,Bg||this.getCurrentLayoutKey());if(!Bf){return ;}BE(Bf.t).update(this,Bf,Bh,Bj);},loadPartialData:function AN(Bk,Bg){var Bi={};Bi[Bg]=AO.call(this,this.defn,this.currlaykey,Bg);var Bh=this.updateDataCache(Bk,Bi),Bf=this.getLayoutDataCache(this.getCurrentLayoutKey()),Bj=this;R.forEach(Bk.layouts,function(Bl){var Bm=Bl&&Bl.xtabStyles;if(Bm){Bj.raiseEvent({name:"updateStyles",key:Bl.k,updatedStyles:Bm});}});BU(Bh,function(Bm,Bl){if(Bl==="upd"){BU(Bm,function(Bo,Bp){var Bn=mstrmojo.all[Bp];if(Bn&&Bn.update){Bn.update(Bf[Bp]);}});}});},updateDefnCache:function A(Bg,Bm,Bj){var Bp=this.currlaykey,Bi=u.call(this,Bg,Bp),Br=u.call(this,this.defn,Bp),Bn=function(Bs,Bt){var Bu;for(Bu in Bt){if(Bs[Bu]===undefined){Bs[Bu]=Bt[Bu];}}},Bq=Bi&&Bi.units,Bo=Br&&Br.units,Bh=Bi&&Bi.cgbMap,Bf=Br&&Br.cgbMap,Bk=Bj&&l(Bj).defn,Bl=this;R.forEach(Bm,function(Bs){Bl.refreshDefinition(Bs,Bq&&Bq[Bs],null,Bk&&Bk[Bs]);});if(Bq){Bn(Bo,Bq);}if(Bh){Bn(Bf,Bh);this.raiseEvent({name:"CGBMapChange",cgbMap:Bf});}},deleteDataCache:function U(Bg){var Bf=this.getLayoutDataCache(this.getCurrentLayoutKey());if(Bf[Bg]){delete Bf[Bg];}},setDataReady:function Ac(Bo,Bl,Bg,Bm,Bf,Bp){var Bj=this.extractChildren(this.data),Bh=this.getLayoutDataCache(this.getCurrentLayoutKey()),Bk=this,Bn=false;if(!Bj){return ;}function Bi(Bq){if(!Bq){return ;}R.forEach(Bq,function(Br){if(Br.k===Bo){if(Bg){Br[Bg]=Bm;}if(R.isArray(Bf)&&Bp){R.forEach(Bf,function(Bt,Bs){Br[Bt]=Bp[Bs];});}else{if(Bf){Br[Bf]=Bp;}}Bn=true;return false;}else{if(!Bn){Bi(Bk.extractChildren(Br));}}});}Bi(Bj);if(!Bh[Bl]){Bh[Bl]={};}Bh[Bl][Bg]=Bm;},updateDataCache:function Ao(Bq,Bp,Bf,Bj){var Bh=this.getLayoutDataCache(this.getCurrentLayoutKey()),Bg=Bj&&l(Bj).data,Br={ifws:{},upd:{},tgts:{},def:{},secs:{}},Bl=this,Bo=function(Bu,Bs){var Bv=Bl.extractChildren(Bu.data);if(Bv){return ;}var Bx=Bl.extractChildren(Bs);for(var Bt in (Bx||[])){if(!!Bx[Bt]){var Bw=Bx[Bt];if(Bw.k===Bu.k){if(mstrApp.isAppStatePause&&mstrApp.isAppStatePause()&&Bx[Bt]&&Bu.defn&&Bu.defn.t===BB.SELECTOR){if(!Bu.data){Bu.data={};}Z(Bu.data,Bx[Bt]);}Bx[Bt]=Bu.data;}}}},Bk=function(By,Bt,Bs){var Bx=Bh[By];if(Bg){var Bw=mstrmojo.all[By];if(Bw){var Bu=Bx.k,Bv=Bg[Bu];if(Bv){if(!a.isEmpty(Bv.exclude)){a.copy(Bt.data,Bx.data);}else{Bt.data=a.copyProps(Bv.serialized.split(";"),Bt.data,Bx.data);}}}}f(Bt,Bh);Bo(Bt,Bs);};function Bn(B8,CD,Bt,Bw){var By=false,B5=this.getChildren(B8,true),B3;if(!B5.length){return ;}if(Bt){B3=mstrmojo.all[B8.id];By=!B8.id||!!B3;}var Bx=B8.defn,Bu=B8.data,CA;if(Bx&&Bx.t===BB.PANELSTACK&&Bx.od){CA=Bu.selKey;}var B9,B2,CF=function(CG){return(CG.k===B2);};for(B9 in B5){var B6=B5[B9],B7=B6.id,Bv=null,CB;B2=B6.k;if(CD){var Bz=this.extractChildren(CD);if(Bz){CB=R.filterOne(Bz,CF);if(!CB){Bz.push(a.clone(B6.data));}}else{a.copy(a.clone(B8.data),CD);}}if(mstrmojo.all[B7]){By=true;}if(Bp.hasOwnProperty(B2)){if(A7.call(this,B2)&&A9(B6.data,Bf)){Bk(B7,B6,CD);var CE=this.getInfoWinByKey(B2);if(!Bw&&CE){Br.ifws[B2]=CE.id;}}Bv=B2;if(By){if(CA&&CA!==B2){continue;}if(!Bw){Br.tgts[B7]=true;}var Bs=B3&&B3.defn,CC=Bs&&Bs.t,B1=Bs&&Bs.ck;if(CC===BB.SUBSECTION&&(B1&&B1.hasOwnProperty(B2))){Br.secs[B3.id]=true;}}}if((Bw||Bv)&&(!CA||CA===B2)){Bk(B7,B6,CD);Br.def[B2]=true;if(By){Br.upd[B7]=true;}}var B0=mstrmojo.all[B7],Bx=B0?Ay.getPropertyByPath(B0,"node.defn"):null;if(mstrApp.isInVFConfigMode&&Bx&&Bx.iifp){var B4=this.adjustNodeId(B6.id);if(mstrmojo.all[B4]){B6.id=B4;Bk(B4,B6,CD);B6.id=this.restoreNodeId(B4);Br.upd[B4]=true;Br.tgts[B4]=true;}else{if((Bx.t===BB.GRID||Bx.t===BB.GRAPH)&&Bw&&Bp[mstrmojo.all[B6.id].k]){Br.upd[B6.id]=true;Br.tgts[B6.id]=true;}}}Bn.call(this,B6,CB,By,Bw||Bv);}}if(Bq&&Bq.layouts&&Bp){var Bi=R.filterOne(Bq.layouts,function(Bs){return(Bs.loaded);}),Bm=this.data.layouts;if(Bi){Bn.call(this,Bi,Bm[R.find(Bm,"k",Bi.k)],true);}}return Br;},getDimensionAndPositionAction:function W(Bg,Bf,Bi){var Bh=this.getUnitFormatAction(Bg,null,null,Bi);Bb.call(this,Bh.format,Bf,3);return Bh;},getDimensionAction:function W(Bg,Bf,Bi){var Bh=this.getUnitFormatAction(Bg,null,null,Bi);Bb.call(this,Bh.format,Bf,2);return Bh;},getUnitFormatAction:function p(Bn,Bg,Bm,Bi){var Bk=Bn.defn,Bo=(Bk&&Bk.t)||1,Bl=Bn.k,Bj=[Bl];var Bf={act:"format",unitKey:Bl,unitType:Bo===115?521:Bo,formatType:Bg||1,format:Bm||{}};if(!Bi){Bf.partialRetrieval={nodes:Bj};}if(Bo===BB.SELECTOR){var Bp=Bk.ck;Bf.keyContext=Bp;Bj[0]=this.getDataService().getNodeKeyFromKeyContext(Bp);}if(Bo===BB.TEXTFIELD||Bo===BB.IMAGE||Bo===BB.HTMLCONTAINER){var Bh=Bn.nk||Bk.fgk;Bf.fieldKey=Bl;Bf.nodeKey=Bh;Bf.keyContext=Bo+m+Bh+m+Bl;Bj[0]=Bh;}return Bf;},updateUnitFormat:function BA(Bg,Bi,Bj,Bk,Bf){var Bh=this.getUnitFormatAction(Bg,Bi,Bj);this.getDataService().submitUpdates(Bh,Bk,Bf);},selectPanelDeferred:function(Bk,Bj,Bi,Bh,Bg,Bf){t.call(this,Bk,{type:3,tks:Bj,eid:Bi,sid:Bh||1,ck:Bj,hasLoader:Bg,skipServerCall:Bf});},getSearchElemsCache:function BM(){var Bf=this.searchElemsCache;if(!Bf){Bf=this.searchElemsCache={};}return Bf;},getCGBMap:function A1(){var Bf=u.call(this,this.defn,this.currlaykey);return Bf&&Bf.cgbMap;},getSliceCallback:function AU(Bf){var Bi=this,Bj={};Bj.dataCacheUpdate=null;Bj.tgtDefs=Bf.tks?Ba.call(this,Bf.tks):null;Bj.orignalTargetDefs=Bj.tgtDefs;var Bh=Bj.tgtDefs,Bg=function(Bm){var Bn=Bh;if(Bf.disablePU){Bn=Ba.call(Bi,Bi.currlaykey);}BU(Bn,function(Bo){if(Bo&&Bo.set){Bo.set("readyState",Bm);}});},Bl=this.newCallback({method:"slice",shared:Bj,submission:function(){Bg(P.WAITING);},success:function(Bn){if(!Bi.checkStatus(Bn)){return ;}if(Bf.disablePU){Bi.loadLayout(Bn,Bf.isUConDS,Bf.restoreIW);return ;}if(Bn.pukeys){Bj.tgtDefs=Ba.call(Bi,Bn.pukeys);}Bj.dataCacheUpdate=Bi.updateDataCache(Bn.data,Bj.tgtDefs,Bf&&Bf.sid,Bn.puFilters);if(typeof Bn==="object"){a.copyProps(["bs","exopt","dty"],Bn,Bi);}var Bm={name:"partialUpdate",tree:Bn.data,ids:Bj.dataCacheUpdate,unloadCache:Bf.isUConDS};if(!mstrmojo.hash.isEmpty(Bm.ids.ifws)){if(Bf&&!Bf.suppressIW&&(Bf.type===BB.GRID||Bf.type===BB.GRAPH)){Bm.anchor=Bf.anchor;}else{Bm.ids.ifws={};}}if(mstrApp){mstrApp.isPartialUpdate=true;}Bi.raiseEvent(Bm);if(mstrApp){mstrApp.isPartialUpdate=false;}},complete:function(){Bg(P.IDLE);}}),Bk={success:function(){BU(Bj.orignalTargetDefs,function(By,Bw){var Bx=AD.call(Bi,Bw,1);if(!Bx){if(!!Bi.sdp&&!!Bi.sdp[Bw]){var Bv=Bi.getLayoutDataCache(Bi.getCurrentLayoutKey());var Bz=M.call(Bi,{k:Bw,wid:1},Bi.getLayoutKeyByUnitKey(Bw));Bi.raiseEvent({name:"secondaryDataSliced",key:Bw,data:Bv[Bz].data});}return ;}if(Bj.dataCacheUpdate&&!Bj.dataCacheUpdate.def.hasOwnProperty(Bw)){if(Bx.setDirty){Bx.setDirty(true);}}else{if(parseInt(By.t,10)===BB.PANELSTACK){Bx.setDirtyChildren();}}});var Bu=Bf.events||{K0:Bf},Bq;for(Bq in Bu){var Bm=AD.call(Bi,Bu[Bq].ctlKey,1);if(Bm&&Bj.dataCacheUpdate&&!Bj.dataCacheUpdate.upd.hasOwnProperty(Bm.id)){var Bt=(Bm.children&&Bm.children[0].selectedIndices)||{},Bp=Bm.node.data,Bn=mstrmojo.DocSelector.STYLES,Bo=[];if(Bm.isDynamicAttributeSelector()){Bp.exp=Bm.expr;if(!Bm.expr&&R.find(Bp.elms,"v",k.ELEM_ALL_ID)>=0){Bo.push(k.ELEM_ALL);}}else{if(Bm.style===Bn.SEARCH_BOX){var Bs=(Bm.children&&Bm.children[0].items)||[];R.forEach(Bs,function(Bv){Bo.push(a.clone(Bv));});}else{a.forEach(Bt,function(Bw,Bv){if(Bw){Bo.push(Bp.elms[Bv]);}});}}var Br=R.find(Bo,"v",k.ELEM_ALL_ID);if(Br>-1){Bo=[Bo[Br]];}Bp.ces=Bo;Bm.selIdx=Bt;}}}};if(Bf.isUConDS||(parseInt(Bf.type,10)===BB.GRAPH&&Bf.tty===1)){Bl.success=function(Bm){Bi.controller.setData(Bm,true);};return Bl;}if((parseInt(Bf.type,10)===3)){return Bl;}return BS(Bl,Bk);},slice:function g(Bf){var Bg=this.getDataService(),Bh=Bg.newUpdateWithoutCmd();this.sliceDeferred(Bh,Bf);if(Bh.actions&&Bh.actions.length>0){Bg.addSuppressData(Bh.extras);Bh.submit();}},sliceDeferred:function(Bn,Bq){var Bl={};try{if(!Bq||(!mstrmojo.dom.isAndroid&&!Bq.tks&&!Bq.multiSelect&&(Bq.type===3||(Bq.type===BB.GRAPH&&parseInt(Bq.tty,10)!==1)))){return Bl;}var Bi=this.getSliceCallback(Bq),Bw=this,Br=this.getDataService(),Bp=Bw.controller.view;var Bx=parseInt(Bq.type,10);if(Bx===3){t.call(Bw,Bn,Bq);return ;}if(Bq.multiSelect){if(Bq.selectorObjects.length>0){Br.setMultiDocSelectorElements(Bq.selectorObjects,Bq.multiSelect,Bi);}return ;}if(Bx===BB.GRAPH){Bn.add(Br.getGraphSelectionAction(Bq.src,Bq.cks,Bq.sid,Bq.x,Bq.y,(Bq.tty===1)),Bi);if(!!Bq.showLoadingIcon){Bn.addExtras({config:mstrmojo.DocDataService.PROGRESS_CONFIG});}return ;}var Bf=Bq.events||{K0:Bq},Bo=[],Bv,Bj={config:mstrmojo.DocDataService.PROGRESS_CONFIG},Bu=Bj.params={},Bs,Bg={},Bh=function(Bz,By){if(Bz){Bg[By]=Bz.visName;}};for(Bs in Bf){Bq=Bf[Bs];if(!Bq){break;}if(Bq.hasOwnProperty("eid")){if(Bq.isUConDS){Bq.disablePU=true;}if(AS.call(this)){Bq.disablePU=true;Bq.restoreIW=true;}Bv=Br.getSelectorElementsAction(Bq);if(Bw.sdp){Bg={};BU(Bw.sdp,Bh);Bu.sdpKeys=JSON.stringify(Bg);}if(Bq.disablePU){Bu.disablePU=true;}}else{if(Bq.fromGM){Bv=Br.getSelectorFromGMAction(Bq);}else{if(parseInt(Bq.srct,10)===4||Bq.fid){if(Bq.fid&&AS.call(this)){Bq.disablePU=true;}Bv=Br.getSelectorExpressionAction(Bq);}else{if(Bq.unset){Bv=Br.getUnsetSelectorAction(Bq);}else{if(Bq.expr){Bv=Br.getAttributeSelectorExpressionAction(Bq);}else{if(parseInt(Bq.ct,10)===6){Bv=Br.getMultiUnitSelectorAction(Bq);Bw.hasUnitSelector=Bq.selections&&Bq.selections.hasElements;}else{Bv=Br.getSelectorIncludeAction(Bq);}}}}}}Bo.push(Bv);}Bn.add(Bo,Bi,Bj);var Bm=function(By){By.extras.style={params:{treesToRender:3}};By.callback=BS({success:function Bz(B0){Bw.partialUpdate(B0.data,Bw.getUnitDefinitions(Bq.cgb),B0.defn,Bq.cgb,B0.puFilters);}},By.callback);return By;};if(Bq.isNavigation){var Bk=(Bp._layouts||[]).filter(function(By){return By.k===Bq.layoutKey;})[0];if(Bk){if(!Bp.showLayout(Bk,null,Bn,Bq.panelKey)){Bn=Bm(Bn);Bp.showPanel(Bq.panelKey,Bq.layoutKey,Bn);}}else{Bp.loadDocLayout({layoutKey:Bq.layoutKey,panelKey:Bq.panelKey},null,Bn);}}else{Bn=Bm(Bn);}}catch(Bt){mstrmojo.err(Bt);}},getInfoWindow:function AG(Bg){var Bf=this.infoWindows;return Bf&&Bf[Bg];},getTargetInfoWin:function(Bg){var Bf=[],Bh=Ba.call(this,Bg);if(Bh){var Bi;for(Bi in Bh){if(Bh[Bi]&&Bh[Bi].ifw){Bf.push(Bi);}}}return Bf;},addInfoWinByKey:function AP(Bg,Bf){if(!this.infoWinByKey){this.infoWinByKey={};}if(!this.infoWinByKey[Bg]){this.infoWinByKey[Bg]=[Bf];return ;}if(R.find(this.infoWinByKey[Bg],"id",Bf.id)===-1){this.infoWinByKey[Bg].push(Bf);}},getInfoWinByKey:function BW(Bh,Bf){var Bi=null,Bg=this.getCurrentLayoutKey();if(this.infoWinByKey&&this.infoWinByKey[Bh]){R.forEach(this.infoWinByKey[Bh],function(Bj){var Bk=Bj&&Bj.id;if(Bk&&Bk.indexOf(Bh)>-1&&Bk.indexOf(Bg)>-1){if(!Bf||Bk.indexOf("*x"+Bf)>-1){Bi=Bj;return false;}}});}return Bi;},showInfoWin:function AC(Bj,Bi,Bg,Bk,Bl,Bf){var Bh=this.getInfoWinByKey(Bj,Bf);if(Bh===null){return ;}this.raiseEvent({name:"showInfoWin",psId:Bh.id,psKey:Bh.k,anchor:Bi,anchorOrientation:Bg,anchorPosition:Bl,invalidate:Bk});},getSelectedXtabStyles:function z(Bh){var Bg=Bh||this.currlaykey;var Bj={};var Bf=this.data&&this.data.layouts,Bi;for(Bi in Bf){if(Bf[Bi].k===Bg){Bj=Bf[Bi].xtabStyles;break;}}return Bj;},downloadGridData:function G(Bk,Bl){var Bi=this,Bh=Bk.xtabId,Bg=Bk.memo,Bj=mstrmojo.all[Bh],Bf=this.newCallback({success:function(Bt){function Bm(Bx,Bz){var B0=Bi.getChildren(Bx,true),By=B0.length,Bw;for(Bw=0;Bw<By;Bw++){var B1=B0[Bw];if(Bz===B1.id){return B1;}var Bv=Bm(B1,Bz);if(Bv){return Bv;}}return null;}var Bq=u.call(Bi,Bt.data,Bi.currlaykey);if(Bq){if(Bi.restoreNodeId){Bh=Bi.restoreNodeId(Bh);}var Bp=Bm(Bq,Bh);if(Bp){mstrmojo.models.template.DataInterface.inflateGridData(Bp.data);if(Bj){Bj.dataDownloaded(Bp,Bg);}}var Bs=Bq.xtabStyles;if(Bs){Bi.raiseEvent({name:"updateStyles",key:Bq.k,updatedStyles:Bs});}}var Br=AO.call(Bi,Bi.defn,Bi.currlaykey,Bk.nodeKey);if(Br&&Br.t===BB.GRIDGRAPH&&Bg.recalculating){var Bo=Bj.parent,Bu=Bo&&Bo.getGraphWidget();if(Bu&&Bo.updateGraph){Bo.updateGraph(Bm(Bq,Bu.id));}}if(Bt.pukeys){var Bn=Ba.call(Bi,Bt.pukeys);delete Bn[Bk.nodeKey];if(!a.isEmpty(Bn)){Bi.partialUpdate(Bt.data,Bn);}}},failure:Bj.dataDownloadErr||mstrmojo.emptyFn});this.getDataService().downloadGridData(Bk,BS(Bf,Bl));},clearDisposables:function A0(){var Bf=[];R.forEach(this.disposables,function(Bg){if(Bg._lkz){BN(Bg);}else{Bf.push(Bg);}});this.disposables=Bf;},getFixedHeaders:function(Bg,Bf){return Al.call(this,Bg,Bf,[BB.PAGEHEADER],true);},getFixedFooters:function(Bg,Bf){return Al.call(this,Bg,Bf,[BB.PAGEFOOTER],true);},getNonFixedSections:function(Bg,Bf){return Al.call(this,Bg,Bf,[BB.PAGEHEADER,BB.PAGEFOOTER],false);},addAutoWidthID:function v(Bh){var Bg=this.aws||{},Bf=Bg[this.currlaykey]||[];Bf.push(Bh);Bg[this.currlaykey]=Bf;this.aws=Bg;},getAutoWidthIDs:function Q(){var Bh=this.aws,Bf=this.currlaykey;var Bg=Bh&&Bh[Bf];if(Bg){delete Bh[Bf];}return Bg;},getTransactionUpdates:function x(Bf){return this.txDiscardTargets?"":AZ.call(this,Bf);},clearTransactionUpdates:function Ab(Bf){this.clearTxDeltaUpdate(Bf);},resetTransactionUpdates:function A5(Bf){var Bg=this.pendingUpdate,Bh=this.delta;if(Bg&&Bg[Bf]){BU(Bg[Bf],function(Bi,Bj){if(Bh&&!Bh[Bj]){Bh[Bj]=Bi;}});delete Bg[Bf];}},transactionUpdate:function BL(Bh,Bg){if(!Bh.data){return null;}var Bj;if(Bg&&Bg.tks){Bj=Ba.call(this,Bg.tks);}if(Bh.pukeys){Bj=Ba.call(this,Bh.pukeys);var Bk;for(Bk in Bj){if(Bj[Bk]&&Bj[Bk].cek){Bj[Bk].cek=null;}}}if(Bh.txrcd){this.txrcd=Bh.txrcd;}else{delete this.txrcd;}var Bi=this.updateDataCache(Bh.data,Bj,Bg&&Bg.sid),Bf={name:"partialUpdate",tree:Bh.data,ids:Bi};if(!a.isEmpty(Bi.ifws)){if(Bg&&Bg.type===BB.GRID){Bf.anchor=Bg.anchor;}else{Bi.ifws={};}}this.raiseEvent(Bf);return Bi;},deltaUpdate:function A3(Bf){var Bg=this.delta;if(!Bg){Bg=this.delta={};}Bg[Bf.id]=Bf;},clearTxDeltaUpdate:function e(Bg){var Bj=this.txDiscardTargets,Bf=!Bj,Bi=this.pendingUpdate,Bh=this;if(!Bf){BU(Bj,function(Bk,Bl){if(Bh.delta&&Bh.delta[Bl]){Bh.delta[Bl].clear();delete Bh.delta[Bl];}});}if(Bi&&Bi[Bg]){BU(Bi[Bg],function(Bk){Bk.clear();});delete this.pendingUpdate[Bg];}},sendTransactionActions:function J(Bg,Bf,Bi){var Bh=this;if(!Bi){Bi={success:function(Bj){Bh.transactionUpdate(Bj);}};}Bh.getDataService().sendTransactionActions({keyContext:Bg,actions:Bf,txrcd:this.txrcd},Bi);},sendTransactionUpdates:function Aw(Bf){var Bh=this.getSliceCallback(Bf),Bg=this.getDataService();Bg.submitUpdates([Bg.getUpdateTransactionAction(Bf)],Bh);},addSDP:function BG(Bg,Bf){if(!Bg||!Bf){return ;}if(!this.sdp){this.sdp={};}this.sdp[Bg]={k:Bf.k,visName:Bf.visName};},removeSDP:function A8(Bf){if(!Bf||!this.sdp||!this.sdp[Bf]){return ;}delete this.sdp[Bf];},getUpdateColorMapCallback:function o(){var Bf=this;return{success:function(Bg){Bf.defn.epm=Bg.defn&&Bg.defn.epm;Aa.call(Bf);Bf.raiseEvent({name:"colorMapChanged"});}};},getUpdateThemePaletteCallback:function A2(Bh){var Bi=this,Bf,Bg;if(mstrApp.isInVFConfigMode){mstrApp.requireRestoreVFConfigMode=true;Bf=Bi.getVIMap().getComponent(K);Bg=mstrApp.getRootController();mstrApp.isInVFConfigPage=false;Bg.view.closeInlineDialog();Bi.destroyVisualiztionselector();Bg.restorePanelStatus(Bf);Bg.maskMenuToolbar(false);}return{success:function(Bj){Bi.thm=Bj.thm;Bi.plt=Bj.plt;Bi.defmts=Bj.defmts;Aa.call(Bi,!Bh);Bi.layoutstyle=Bj.layoutstyle;}};},getCurrentPaletteColors:function Aj(){return(this.plt&&this.plt.colors)||S;},getCurrentPaletteId:function F(){return this.plt&&this.plt.did;},getCurrentDefaultPaletteId:function BH(){return(this.thm&&this.thm.dplt)||BY;},getCurrentLayoutStyle:function BT(){return this.layoutstyle||Aq;},getColorBy:function(Bl,Bf){var Bj=Bf.map(function(Bn,Bm){return{levelID:Bl[Bm].toString(),elemID:Bn};});if(Bj&&Bj.length>1){AH(Bj);}var Bk=O(Bj),Bi=BZ(Bj),Bh=c[Bk];if(!Bh){Bh=c[Bk]={_currentColorIdx:0};}if(!Bh[Bi]){var Bg=this.getCurrentPaletteColors();Bh[Bi]=Bg[Bh._currentColorIdx];Bh._currentColorIdx=(Bh._currentColorIdx+1)%Bg.length;}if(H[Bk]&&H[Bk][Bi]){return{color:H[Bk][Bi].color,isManual:true};}return{color:Bh[Bi],isManual:false};},getZoomFactor:function AR(){return this.getCurrentLayoutDef().zf||1;},getZoomProps:function Av(){return{dpi:this.dpi,zf:this.getZoomFactor()};},executeLink:function w(Bf,Bh,Bj){if(Bf.indexOf("prevMsgID")>0){Bf=BI(Bf,/prevMsgID=0($|&)/g,"prevMsgID="+this.mid);}if(Bf.indexOf("originMessageID")>0){Bf=BI(Bf,/originMessageID=[a-zA-Z0-9]*($|&)/g,"originMessageID="+this.mid);}Bf=mstrmojo.addCSRFTokenToURL(Bf);if(Bf.indexOf(mstrApp.name+"=")===-1&&!mstrmojo.isUrlExternal(Bf)){var Bi=mstrApp.servletState||mstrConfig.servletState||"";var Bg=mstrApp.name+"="+window.encodeURIComponent(Bi);if(Bf.indexOf("?")>-1){Bf+="&";}else{Bf+="?";}Bf+=Bg;}this.controller.onLink(this,{url:Bf,target:Bh,src:Bj||null,submitAsPost:!mstrmojo.isUrlExternal(Bf)});},getDatasetUnits:function BK(Bg,Bf,Bi,Bk){var Bj=this.datasets,Bh=[];a.keyarray(Bj).forEach(function(Bm){if(!Bi||Bm===Bi){var Bn=Bj[Bm],Bl=Bn,Bo=[];Bg.forEach(function(Bp){if(Bk!==undefined){Bl=Bn.tables[Bk];}(Bl[Bp]||[]).forEach(function(Bq){if(!Bf||Bf(Bq)){Bo.push(Bq);}});});Bh=Bh.concat(Bo.map(function(Bp){return mstrmojo.hash.copyProps(["did","attId","n","t","st","ndetype","formType","dt","f","hide","usedInDropZones","card","lock","fs","lvfs"],Bp,{ds:Bn.name,dsId:Bm,dm:!!Bp.um,da:!!Bp.da,de:!!Bp.de});}));}});return Bh;},getMapLayerKeys:function Az(Bf){if(Bf&&Bf.getSdpKeyArr){return Bf.getSdpKeyArr();}return[];},getDeleteMapLayersActions:function BQ(Bh){var Bf,Bi=[],Bg=this;(Bh||[]).forEach(function(Bj){Bf=Bg.getLayoutUnitDefn(Bj);Bi.push({act:"removeUnit",unitKey:Bj,unitType:(Bf&&Bf.t)||522});});return Bi;},syncLayerDefn:function r(Bj,Bh,Bg){var Bi=this.getCurrentLayoutDef(),Bf=(Bi&&Bi.units)||{};(Bh||[]).forEach(function(Bk){if(Bf[Bk]){if(Bg){Bf[Bk]._isDeleted=true;}else{delete Bf[Bk]._isDeleted;}}});if(Bg){mstrApp.primaryScdpMap[Bj]=[];}else{mstrApp.primaryScdpMap[Bj]=Bh;}},getFormatSDPAction:function Ap(Bh,Bg){var Bf={FormattingWidget:{SecondaryDataProviders:Bg.join(",")}};return this.getUnitFormatAction(Bh,1,Bf,true);},addMapLayerActions:function BD(Bs,Bk,Bn,Bm){var Bo=this.getNextKey(),Bi=this.getPanel().k,Br=Bs.scriptClass==="mstrmojo.mapbox.VisMapbox",Bg=Br?At.MAPBOX:At.GOOGLE_MAP,Bf=Br?Bc.MAPBOX:Bc.GOOGLEMAP,Bq=this.getWidgetClassNameByStyle(Bg,Bf),Bp=this.getMapLayerKeys(Bs),Bh=Bs.defn.tt,Bl={k:Bo,defn:{t:521}},Bj={FormattingAppearance:{Visible:0,Name:Bm}};Bk.push(this.getCopyEmptyTemplateAction(Bo,Bi));Bk.push({act:"updateTemplate",keyContext:Bo,actions:[{act:"createDefaultDropZones",nodeKey:Bo,treeType:Bh,datasetType:3,widgetType:Bf}]});Bk.push(this.getUnitChangeVizAction(Bg,Bq,Bl,Bn,Bj));Bk.push({act:"changeGridDisplayMode",nodeKey:Bo,displayMode:1});Bk.push(this.getFormatSDPAction(Bs,Bp.concat(Bo)));return Bo;},removeMapLayerActions:function AI(Bh,Bg,Bi){var Bf=this.getLayoutUnitDefn(Bg);Bi.push({act:"removeUnit",unitKey:Bg,unitType:(Bf&&Bf.t)||522});Bi.push(this.getFormatSDPAction(Bh,this.getMapLayerKeys(Bh)));},getExtraActionsForChangeMapViz:function AM(Bh,Bg,Bk){var Bi=Bh.parent,Bj,Bf=this;if(Bg&&Bg.length>0){R.forEach(Bg,function(Bl){if(!Bh.isPrimaryKey(Bl)){Bj=Bf.clearVisAsFilterActionForMapLayer(Bi,Bh.fnGetWidget(Bl),true);if(Bj&&Bj.actions){Bk=Bk.concat(Bj.actions);}}});Bk=Bk.concat(this.getDeleteMapLayersActions(Bg));Bk.push(this.getFormatSDPAction(Bh,[]));this.syncLayerDefn(Bh.k,Bg,true);}return Bk;},isMapLayerNode:function n(Bg){var Bf=false;a.forEach(mstrApp.primaryScdpMap,function(Bh){if(Bh.indexOf(Bg)>=0){Bf=true;return false;}});return Bf;},getMapLayersDataByHostKey:function X(Bl){var Bh={},Bk,Bj=this,Bi=mstrApp.primaryScdpMap[Bl],Bg=this.getCurrentLayoutKey(),Bf=this.getLayoutDataCache(Bg);R.forEach(Bi,function(Bm){Bk=Bf[M.call(Bj,{k:Bm,wid:1},Bg)];Bh[Bm]=Bk&&Bk.data;});return Bh;},getNodeDataByKey:function AY(Bg){var Bh=this.getLayoutKeyByUnitKey(Bg),Bf=this.getLayoutDataCache(this.getCurrentLayoutKey()),Bi=Bf[M.call(this,{k:Bg,wid:1},Bh)];return Bi;},getMapLayerDataByLayerKey:function AY(Bf){var Bg=this.getNodeDataByKey(Bf);return Bg&&Bg.data;},updatePrimaryScdpMap:function Ar(Bj,Bh,Bg){var Bf,Bi=mstrApp.primaryScdpMap[Bj];if(!Bi){Bi=mstrApp.primaryScdpMap[Bj]=[];}Bf=Bi.indexOf(Bh);if(Bg&&Bf<0){Bi.push(Bh);}else{if(!Bg&&Bf>=0){Bi.splice(Bf,1);}}},updateWidgetsProps:function BV(){this.raiseEvent({name:"updWgtsProps"});},restoreVFConfigMode:function AT(){var Bf=this;return{success:function(){if(mstrApp.requireRestoreVFConfigMode){mstrApp.requireRestoreVFConfigMode=false;var Bj=Bf,Bg=mstrApp.isVFEditingMode,Bi=mstrApp.restoreVFKey,Bh=mstrApp.restoreVFTitle;Bj.checkLargeItemsForVisFilter(Bi,function(){var Bk=Bj.addVisFilterContainer(),Bn=Bj.getSelectedViUnit(),Bm;Bj.oldSelectedVizBoxId=Bn.id;mstrApp.isInVFConfigMode=true;Bm=Bj.insertVizBox(Bi,Bk,{});Bj.controller.rootCtrl.initPanelStautsInConfigMode();Bj.selectVIUnit(Bm.id,true,{isAddAction:true});mstrApp.getRootController().enterVizFilterConfigMode(Bh,Bg);if(Bg===false){mstrApp.restoreVFCreate=true;var Bl=mstrmojo.all.visualizationFilterToolbar;Bl.toggleSaveBtn(mstrApp.isEnableSaveBtn);}});}}};},getWidgetClassNameByStyle:function Au(Bh,Bg){var Bf=mstrmojo.ExpressVisList.findWidgetName(Bh)||Ae[Bh];if(!Bf&&parseInt(Bg)===Bc.CUSTOM){Bf=q;}return Bf||"";},clearColorByMap:function Y(){c={};}});mstrmojo.DocModel.fnBuildId=M;}());(function(){mstrmojo.requiresCls("mstrmojo.DocSelector","mstrmojo.array","mstrmojo.elementHelper");var I=mstrmojo.array,F=mstrmojo.DocSelector.ELEM_ALL_ID,H=mstrmojo.elementHelper;var C=0,K=1,J=2;var B=1,M=3;function A(O){I.forEach(O,function(P){P.n=P.v;});return O;}mstrmojo.TextBoxDocSelector=mstrmojo.declare(mstrmojo.DocSelector,null,{scriptClass:"mstrmojo.TextBoxDocSelector",_ieformatHandlers:{domNode:["font","text-align","vertical-align","line-height","z-index","top","left"],contentNode:["width","B","P"],filterNode:["height","width","B","P","fx","background-color"],item:["color","font","text-decoration","text-align","line-height"]},formatHandlers:{domNode:["font","text-align","vertical-align","line-height","z-index","top","left"],contentNode:["height","width","B","P","fx","background-color"],item:["color","font","text-decoration","text-align","line-height"]},_fetchOnInit4UCOnDS:function G(){},_getSelectionCount:function L(P){var O=P.items;return O?O.length:0;},_buildEvent:function D(R,Q){var O=[],P=this.defn;I.forEach(Q.items,function(S){O.push(S.v);});if(O.length>0||P.nsb===C){R.eid=O.join(mstrmojo.elementHelper.ELEM_SEPARATOR);}else{R.eid="";}if(P.sec){this.parent.set("count",H.buildElemsCountStrByNum(O.length,0));}},updateWidget:function N(Q){var R=this._super(Q),O=Q.node,P=O.data;R.items=P.vs?A(P.vs.concat()):[];return R;},getWidgetConfig:function E(V,R,Q,U){var P=V.getFormats(),S=V.node.data,O=this._super(V,R,Q,U);O={scriptClass:O.scriptClass,cssText:P.height?"height: "+P.height:"",emptyText:mstrmojo.desc(4325,"Search")+" "+(Q.ttl||""),items:S.vs?A(S.vs.concat()):[],srcid:Q.srcid||"",dsrc:Q.dsrc||"",onitemsChange:function(){if(!V._inSyncPhase){V.selectorControlChange(this);}}};if(!Q.multi){O.maxObjectCount=1;}return O;}});}());(function(){mstrmojo.requiresCls("mstrmojo.DocSelector","mstrmojo.Button","mstrmojo.form");var V=8,P=16,W=4,S=1,K=2,D=4,R=8,B=16,N=268435456,J=536870912,A=1073741824,I=window.mstrConfig&&!window.mstrConfig.simpleDialog,M=2147755235,L=2147755236;var C="mstrmojo-oivmSprite ";function E(a,Z,Y){if(I){mstrmojo.confirm(a,{confirmBtn:{fn:Z},cancelBtn:{fn:Y}});}else{if(mstrmojo.confirm(a)){if(Z){Z();}}else{if(Y){Y();}}}}function X(Z,Y){if(I){mstrmojo.alert(Z,Y,null,null,null,{allowHTML:true});}else{mstrmojo.alert(Z);Y();}}function O(Y){var Z=mstrmojo.findAncestor(this,"scriptClass","mstrmojo.DocInfoWindow");if(!!Z){Z[Y?"registerLock":"releaseLock"](this);}}mstrmojo._DocActionSelector=mstrmojo.provide("mstrmojo._DocActionSelector",{_mixinName:"mstrmojo._DocActionSelector",extCls:"mstrmojo-ActionSelector",type:V,targets:null,initControlInfo:function G(){var Y=this.node.defn;this.aa=parseInt(Y.aa,10);this.dpTxt=Y.dpTxt||{8:mstrmojo.desc(5369),4:mstrmojo.desc(8233),16:mstrmojo.desc(8232)}[this.aa]||"";this.dpCfm=Y.dpCfm;this.sac=parseInt(Y.sac,10);this.msg=Y.msg;this.rsid=Y.rsid;this.rst=Y.rst;this.node.data.elms=[{n:this.dpTxt,v:this.dpTxt}];if(this._super){this._super();}},selectorControlChange:function(Y){if(Y.selectedIndex!==0){return ;}this.executeAction();Y.select([]);},executeAction:function(){var Z=this.aa,Y=this,a=function(){O.call(Y,false);};O.call(Y,true);if(Z===V){if(this.dpCfm){E(mstrmojo.desc(8313),function(){Y.onCommit();},a);}else{Y.onCommit();}}else{if(Z===W){if(this.dpCfm){E(mstrmojo.desc(8322),function(){Y.onDiscard();},a);}else{Y.onDiscard();}}else{this.onRecalculate();}}},postBuildRendering:function(){this._super();this.domNode.ontouchstart=function(Y){mstrmojo.css.addClass(Y.target,"glow");};this.domNode.ontouchend=function(Y){mstrmojo.css.removeClass(Y.target,"glow");};},onCommit:function(){var b=this,c=this.model,Z=b.controller,Y=mstrApp.useBinaryFormat;O.call(this,false);if(!this.checkValidationStatus()){X(mstrmojo.desc(9205));return ;}if(!Y&&!this.validateRequiredObjects()){X(mstrmojo.desc(9200));return ;}var a=function(d){if((b.sac&J)>0){Z.invalidClientCache();}if((b.sac&B)>0){var e={did:b.rsid,objType:b.rst,forceExec:(b.sac&N)>0};if((b.sac&A)>0){e.linkAnswers='<hl mid="'+c.mid+'" srct="2" aopam="1"><prms></prms></hl>';}Z.onExecuteNewObject(b,e);}else{if((b.sac&R)>0){Z.onReExecute(b);}else{if(mstrApp.isMobile){Z.generateActionToolbar();}c.transactionUpdate(d);}}};mstrmojo.mask.show("Running");c.sendTransactionActions(this.ck,V,c.newCallback({success:function(d){mstrmojo.mask.hide();if(c.txrcd||d.offln){Z.offlineTransactionsSubmitted(b.ck);}if(d.offln){if(Y&&!b.networkToastShowed){b.networkToastShowed=true;mstrmojo.toast(mstrmojo.desc(9258,"No Network Connectivity")+". "+mstrmojo.desc(9259,"Transaction will be submitted when connectivity is resumed."));}c.transactionUpdate(d);}else{if((b.sac&S)>0&&b.msg){if(Y){mstrmojo.toast(b.msg);window.setTimeout(function(){a(d);},100);}else{X(b.msg,function(){a(d);});}}else{a(d);}}},failure:function(f){var d=mstrmojo.all.mojoAlertx9;if(d){d.destroy();}mstrmojo.mask.hide();if(c.txrcd){Z.offlineTransactionsSubmitted(b.ck);}var e=4294967296+parseInt(f.code,10);if(e===M){if(Y){b.validateRequiredObjects();}X(mstrmojo.desc(9200,"You have some required inputs that are not modified."));}else{if(e===L){var g=mstrmojo.desc(9201,"You haven't made any changes to submit.");if(Y){mstrmojo.toast(g);}else{X(g);}}else{X(mstrmojo.base64.decodeHttpHeader(f.message),function(){if(!Y){b.controller.onReExecute(b,true);}});}}}}));},onDiscard:function F(){var Z=this,a=this.model,Y=Z.controller;O.call(this,false);a.txDiscardTargets=this.getTxTargets();a.sendTransactionActions(this.ck,W,{success:function(b){a.transactionUpdate(b);Y.transactionDiscarded(Z.ck);},complete:function(){delete a.txDiscardTargets;if(mstrApp.isMobile){Y.generateActionToolbar();}}});},onRecalculate:function(){O.call(this,false);this.model.sendTransactionActions(this.ck,P);},getTxTargets:function U(){var e=this.tks.split("\u001E"),d,Y,c,f,Z,a,b={};for(d=0,Y=e.length;d<Y;d++){c=e[d];f=1;do{Z=this.model.getUnitInstance(c,f++);if(Z&&Z.checkRequiredObjects){if(Z.isPanelStack){for(a in Z.txWidgets){b[Z.txWidgets[a].id]=1;}}else{b[Z.id]=1;}}else{break;}}while(true);}return b;},validateRequiredObjects:function Q(){var Y=true,Z;for(Z in this.getTxTargets()){Y=mstrmojo.all[Z].checkRequiredObjects()&&Y;}return Y;},checkValidationStatus:function H(){var Y;for(Y in this.getTxTargets()){if(mstrmojo.all[Y].checkValidationStatus&&!mstrmojo.all[Y].checkValidationStatus()){return false;}}return true;}});}());(function(){mstrmojo.requiresCls("mstrmojo.models.FormatModel","mstrmojo.vi.models.editors.BaseEditorModel","mstrmojo.ui.editors.controls.CharacterGroup","mstrmojo.DocSelector");var C=3;var B=mstrmojo.ui.editors.controls.CharacterGroup.CTRL_FLAGS,E=mstrmojo.models.FormatModel,M=E.getFormatUpdate,H=E.ENUM_PROPERTY_NAMES,G="#DBDBDC";function D(Q,O,P,N){return this.getLabelAndControl(Q,this.getPulldown(O,P,N||0));}function J(O){var P=O.k,N=O.parent;return{success:function(){var Q=N.getUnitByKey(P);N.selectVIUnit(N.rebuildChild(Q),true);}};}function I(V){var W=this,S=this.getHost(),Q=S.parent,U=S.model,X=S.defn,a=[],Z=S.getSelectorStyleList(),Y=X.ssc,P;if(!S.isRecursiveAttributeSelector()){a.push(D.call(this,mstrmojo.desc(3059,"Style:"),Z,function(b){U.changeFilterStyle(S,b);},Z.map(function(b){return b.v;}).indexOf(X.style)));}a.push(this.getCharacterGroup(this.getChangeGroupPropertyFn(1),this.getHost().getFormats()||{},B.FONT_FAMILY+B.FONT_SIZE_AND_COLOR+B.FONT_STYLE_NO_STRIKEOUT));if(S.supportSelectionColor()){if(S.content&&S.content.getPropertyDefaultValue){P=S.content.getPropertyDefaultValue(H.SELECTOR_SELECTION_COLOR);}if(!P){P=G;}a.push(this.getLabelAndControl(mstrmojo.desc(14057,"Selection:"),new mstrmojo.ui.editors.controls.ColorPickerButton({showGradient:false,showNoFill:true,selectedValue:Y!==undefined?E.decodeValue(H.SELECTOR_SELECTION_COLOR,Y):P,postselectedValueChange:function(b){U.changeUnitFormatProperty(Q,[{formatType:1,propertyName:H.SELECTOR_SELECTION_COLOR,newValue:b.value,oldValue:b.valueWas}]);}})));}if(S.allowsOrientationChange()){a.push(this.getButtonBar([{n:mstrmojo.desc(4604,"Auto"),v:-1},{n:mstrmojo.desc(12286,"Horizontal"),v:1},{n:mstrmojo.desc(12285,"Vertical"),v:0}],X.ob?(X.horiz?1:2):0,function(d){var f=d.v,e=Q.domNode,c=f===-1,g=(c?(e.offsetWidth>e.offsetHeight):f)?1:0;Q.set("orientation",g?"h":"v");X.ob=c?0:1;var b=M(H.CONTROL_ORIENTATION_BEHAVIOR,c?0:1);M(H.CONTROL_ORIENTATION,g?1:0,b);U.submitUndoRedoFormatChange(Q,{1:b},null,null,mstrmojo.DocDataService.REQUEST_ONLY_DEFINITION);},{showIcon:false}));}if(S.supportsInclude()){a.push(D.call(this,mstrmojo.desc(2707,"Mode:"),[{n:mstrmojo.desc(3945,"Include"),v:true},{n:mstrmojo.desc(3946,"Exclude"),v:false}],function(b){S.set("include",b);},S.include?0:1));}if(S.allowsTogglingMultiSelect()){a.push(this.getCheckboxAndLabel(S.multi,mstrmojo.desc(4742,"Allow multiple selections"),function(c,b){U.submitUndoRedoFormatChange(Q,{1:M(H.CONTROL_MULTISELECT,c)},null,{success:function(){var e=U.getUnitDefinitions(S.k)[S.k];e.multi=c;var d=mstrmojo.all[Q.id];Q.parent.selectVIUnit(Q.parent.rebuildChild(d),true);}},mstrmojo.DocDataService.SUPPRESS_DATA);}));}if(S.allowsTogglingAutoSearch()){a.push(this.getCheckboxAndLabel(S.iase,mstrmojo.desc(15913,"Allow Instant Search"),function(c,b){U.submitUndoRedoFormatChange(Q,{1:M(H.CONTROL_AUTOSEARCH,c)},null,{success:function(){var e=U.getUnitDefinitions(S.k)[S.k];e.iase=c;var d=mstrmojo.all[Q.id];Q.parent.selectVIUnit(Q.parent.rebuildChild(d),true);}},mstrmojo.DocDataService.SUPPRESS_DATA);}));}if(S.allowsSameSizeItems()){var O=this.getCheckboxAndLabel(X.iwm===0,mstrmojo.desc(4782,"Make all items the same width"),function(b){U.submitUndoRedoFormatChange(Q,{1:M(H.CONTROL_ITEM_WIDTH_MODE,b?0:1)},null,{success:function(){var d=U.getUnitDefinitions(S.k)[S.k];d.iwm=b?0:1;U.itemsFitContent=d.iwm;var c=mstrmojo.all[Q.id];Q.parent.selectVIUnit(Q.parent.rebuildChild(c),true);}},mstrmojo.DocDataService.SUPPRESS_DATA);});U.itemsFitContent=!O.children[0].checked;a.push(O);}if(S.supportsShowAllToggle()&&!S.isAttrQualSelector()&&!S.isRecursiveAttributeSelector()&&!S.isSearchBox()&&S.include){var R=X.showall;a.push(this.getCheckboxAndLabel(R,mstrmojo.desc(4741,"Show option for all"),function(b){U.submitSelectorPropsChange(Q,{showAll:!!b},J(Q));}));if(R){var N=this.getLabelAndControl(mstrmojo.desc(4851,"Alias:"),new mstrmojo.TextBox({value:X.allStr||"",valueChangeDelay:500,onvalueChange:function(){X.allStr=this.value;U.submitSelectorPropsChange(Q,{allAlias:this.value},J(Q));}}),"53px","100%");N.getLabel().cssText="text-align:right;";a.push(N);}}this.replaceChildControls(V,[this.getEditorGroup(a,{showDivider:false})]);}mstrmojo.vi.models.editors.FilterEditorModel=mstrmojo.declare(mstrmojo.vi.models.editors.BaseEditorModel,null,{scriptClass:"mstrmojo.vi.models.editors.FilterEditorModel",help:"format_panel_filter.htm",getInitialTarget:function A(N){return[mstrmojo.vi.models.editors.BaseEditorModel.TITLE_CONTAINER_VALUE,C].indexOf(N)>-1?N:mstrmojo.vi.models.editors.BaseEditorModel.TITLE_CONTAINER_VALUE;},getTargetPulldownItems:function K(N){var P=this._super(N),O=this.getHost();if(!(O&&O.isInvalid)){P.push({n:mstrmojo.desc(6189,"Filter"),v:C,h:I.bind(this,N)});P.reverse();}return P;},getTitleFormatCode:function L(){return 5;},getEditorContents:function F(N){return mstrApp.allowWebDashboardDesign()?this._super(N):[];}});mstrmojo.vi.models.editors.FilterEditorModel.SELECTOR_VALUE=C;}());(function(){mstrmojo.requiresCls("mstrmojo.DocSelector","mstrmojo.Button","mstrmojo.form");var G=mstrmojo.css,C=mstrmojo.dom,E=mstrmojo.array,H="show";mstrmojo._CanWSItemDragandDrop=mstrmojo.provide("mstrmojo._CanWSItemDragandDrop",{_mixinName:"mstrmojo._CanWSItemDragandDrop",wsItemdndNode:null,model:null,init:function I(J){this._super(J);if(this.wsItemdndNode===null||!this.model){return ;}this.installedEventListeners=[this.model.attachEventListener(EVENTS.WSITEM_DRAG_ENTER,this.id,this.handleWSItemDragEnter),this.model.attachEventListener(EVENTS.WSITEM_DROP,this.id,this.handleWSItemDrop),this.model.attachEventListener(EVENTS.WSITEM_DRAG_EXIT,this.id,this.handleWSItemDragExit)];},unrender:function F(J){E.forEach(this.installedEventListeners,function(K){this.model&&this.model.detachEventListener(K);});this.installedEventListeners=[];this._super(J);},handleWSItemDragEnter:function D(){G.addClass(this.wsItemdndNode,H);},handleWSItemDragExit:function B(){G.removeClass(this.wsItemdndNode,H);},handleWSItemDrop:function A(){G.removeClass(this.wsItemdndNode,H);}});}());(function(){mstrmojo.requiresCls("mstrmojo.DocSelector","mstrmojo.vi.ui.rw.selectors.AttrQualInputBox","mstrmojo.array","mstrmojo.expr","mstrmojo.date","mstrmojo.VisChartUtils","mstrmojo.locales","mstrmojo.elementHelper","mstrmojo.vi.ui.DatasetUnitMenuUtils");var J=mstrmojo.expr,K=J.BFTP,E=mstrmojo.date,P=mstrmojo.VisChartUtils,F=mstrmojo.array,A=mstrmojo.vi.ui.DatasetUnitMenuUtils,R=mstrmojo.locales,L=mstrmojo.DocSelector.DATAPARAMS;function H(U,V){if(!U){return ;}var W=E.getDateJson(new Date(P.convertRawValueToMilliseconds(U))),S=E.formatDateInfo(W,R.datetime.DATEOUTPUTFORMAT);if(V===J.DTP.TIMESTAMP){S+=" "+E.formatTimeInfo(W,R.datetime.TIMEOUTPUTFORMAT);}return S;}mstrmojo.AttrQualDocSelector=mstrmojo.declare(mstrmojo.DocSelector,null,{scriptClass:"mstrmojo.AttrQualDocSelector",getWidgetClass:function N(V,U,S){return"vi.ui.rw.selectors.AttrQualInputBox";},newAndInitWidget:function M(S){var U=this._super(S);S.attachEventListener("includeChange",U.id,function(V){this.set("include",V.value);});return U;},_buildEvent:function D(a,Z){a.f=Z.f;a.ft=Z.ft;a.fid=Z.fid;a.ckey=this.ckey;a.srcid=Z.srcid;a.srct=Z.srct;var Y=Z.dt,X=[];F.forEach(Z.cs,function(b){if(!mstrmojo.string.isEmpty(b.v)){X.push(b.v);}});if(X.length){a.cs=X.join(mstrmojo.elementHelper.ELEM_SEPARATOR);}a.dtp=Y;a.unset=Z.unset;if(a.unset||mstrmojo.string.isEmpty(a.cs)){delete a.fid;}if(mstrApp.isAppStatePause&&mstrApp.isAppStatePause()){var U=this.model,W=U.getCurrentLayoutDef(),V=W&&W.units,S=this.k;if(V[S]){V[S].cesChange=true;}U.setDataReady(this.k,this.id,L.CSREADY,true,["f","ft","cs"],[Z.f,Z.ft,Z.cs]);}},getCekEvtListener:function Q(U,S){return function(V){U.handleActionInSyncPhase(function(){S.update(V.value);});};},updateWidget:function I(W){var X=this._super(W),U=W.node,V=U.data;if(X.update){var S={cs:V.cs,f:V.f,ft:V.ft,fid:V.fid,min:H(V.min,V.dt),max:H(V.max,V.dt)};X.update(S);}return X;},getWidgetConfig:function B(g,Z,d,S){var a=g.model,e=g.getFormats(),Y=g.node.data,c=this._super(g,Z,d,S);c={scriptClass:c.scriptClass,cssText:e.height?"height: "+e.height:"",srcid:d.srcid||"",srct:d.srct||"",cs:Y.cs,min:H(Y.min,Y.dt),max:H(Y.max,Y.dt),showAdvanced:true,canSelectDisabledDate:true,f:Y.f,ft:Y.ft||1,fid:Y.fid,dt:Y.dt,onchange:function(){if(!g._inSyncPhase){g.selectorControlChange(this);}}};if(!c.fid||!c.dt){var X=A.getUnitFromDataset(a.datasets,d.srcid,12),b=(X&&X.fs)||[],f=b[0],W,V=function(h){if(!c.fid){c.fid=h.fid;}if(!c.dt){switch(h.bftp){case K.TEXT:c.dt=J.DTP.CHAR;break;case K.DATE:c.dt=J.DTP.DATE;break;case K.DATETIME:c.dt=J.DTP.TIMESTAMP;break;default:c.dt=J.DTP.CHAR;}}};for(W=0;W<b.length;W++){if(b[W].iidx){f=b[W];break;}if(b[W].idf){f=b[W];}}if(f){V(f);}}var U=c.dt;if(c.f===undefined){if(U===J.DTP.CHAR){c.f=J.FN.SEARCH;}else{if(U===J.DTP.DATE||U===J.DTP.TIMESTAMP){c.f=d.include?J.FN.BETWEEN:J.FN.NOT_BETWEEN;}}}if(!(mstrApp.isOIVM&&mstrApp.isOIVM()||d.iifp)){c.supportScrollbar=true;}return c;},isValidSelection:function O(){var U=this.node.data,S=this.model;return !S.isSelWarnFlagOn(this.k)||(U.cs&&U.cs.length);},isSelectAll:function C(){var Z=this.children&&this.children[0];if(Z===undefined){return true;}var U=R.datetime.DATEOUTPUTFORMAT,W=R.datetime.TIMEOUTPUTFORMAT,X=E.parseDateAndOrTime;var S=X.call(E,Z.min,U,W),a=X.call(E,Z.fromBox.fromPicker.value),b=E.compareDate(a&&a.date,S&&S.date);if(b>0){return false;}if(b===0){if(E.compareTime(a&&a.time,S&&S.time)>0){return false;}}var c=X.call(E,Z.max,U,W),Y=X.call(E,Z.toBox.toPicker.value),V=E.compareDate(Y&&Y.date,c&&c.date);if(V<0){return false;}if(V===0){if(E.compareTime(Y&&Y.time,c&&c.time)<0){return false;}}return true;},isFilterNothing:function G(){return this.isSelectAll();}});}());(function(){mstrmojo.requiresCls("mstrmojo.vi.ui.rw.UnitContainer","mstrmojo.vi.ui.rw.selectors._HasFilterContextMenu","mstrmojo.vi.ui.TargetSelector","mstrmojo.vi.ui.FilterBoxInlineDialog","mstrmojo.Label","mstrmojo.dom","mstrmojo.css","mstrmojo.func","mstrmojo.hash","mstrmojo.tooltip","mstrmojo.DocSelector","mstrmojo.vi.ui._HasMask","mstrmojo.vi.ui._CanDropFromSchema","mstrmojo.vi.models.EnumDragSources","mstrmojo.models.FormatModel","mstrmojo.EnumRWUnitType");var I=mstrmojo.css,W=mstrmojo.dom,AD=mstrmojo.func,AF=mstrmojo.string,Y=mstrmojo.hash,D="\u001E",w=mstrmojo.EnumRWUnitType,v=mstrmojo.models.FormatModel,x=v.getFormatUpdate,q=v.ENUM_PROPERTY_NAMES,U=mstrmojo.DocSelector.STYLES,Z=mstrmojo._HasTooltip.TOOLTIP_OPEN_DELAY;function M(AK){return AK&&AK.did!=="-1"&&AK.t!==14;}function S(AK){var AL=AK.getCtxtDragData();return(AL.items||[]).filter(M)[0];}function E(AL){var AM=AL.getCtxtDragData(),AK=AM.items||[];return AM.src&&AK.some(M);}function AH(){return !!this.boxContent.defn.srcid;}function L(){var AL=this.boxContent.defn.srcid,AK=this.model.getDatasetUnits(["att","mx"],function(AM){return AM.did===AL;});return(AK.length&&AK[0])||null;}function P(){var AK=this;this.showControlOverlay([mstrmojo.Button.newWebButton(mstrmojo.desc(1088,"Edit"),function(){var AL=AK.boxContent;if(AL&&AL.expandOrEditToFetchElements){AL.expandOrEditToFetchElements();}AK.hideControlOverlay();},false,{alias:"ctrlEditBtn",enabled:true,cssClass:"filterBoxEdit"})]);I.toggleClass(this.ctrlOverlay&&this.ctrlOverlay.domNode,"editOverLay",true);}function J(){var AK=this,AL=mstrmojo.Button.newWebButton(mstrmojo.desc(4799,"Select Target"),function(AM){var AN=mstrmojo.all[AK.id];mstrApp.rootCtrl.view.openInlineDialog(AG(AN));AM.cancel();},true,{alias:"btnSelect"});AL.cssClass+=" btn-select-targets";this.showControlOverlay([AL]);this.setSelectTargetsState(true);}function R(){var AK=this.boxContent;if(AK.isInvalid){this.showInvalidMessage();return ;}if(!AH.call(this)||(mstrApp&&(mstrApp.isAppStatePresentation()||mstrApp.isAppStatePrintPreview()))){return ;}if(this.getTargetKeys().length>0){if(Y.walk("boxContent.node.data.disabled",this)){P.call(this);}else{this.hideControlOverlay();}return ;}J.call(this);}function g(){return !this.defn.ob;}function AJ(AK){this.set("useRichTooltip",AK);}function V(){I.toggleClass(this.domNode,"horizontal",!!this.defn.horiz);}function AG(AK){return{scriptClass:"mstrmojo.vi.ui.FilterBoxInlineDialog",vis:AK};}mstrmojo.vi.ui.rw.FilterBox=mstrmojo.declare(mstrmojo.vi.ui.rw.UnitContainer,[mstrmojo.vi.ui.rw.selectors._HasFilterContextMenu,mstrmojo.vi.ui._CanDropFromSchema,mstrmojo.vi.ui._HasMask],{scriptClass:"mstrmojo.vi.ui.rw.FilterBox",targetSelector:null,useRichTooltip:true,isDynamicTooltip:true,tooltipOpenDelay:Z,maskTooltip:mstrmojo.desc(15274,"Selector cannot be selected as target"),allowFilters:true,markupMethods:Y.mergeHashes(mstrmojo.vi.ui.rw.UnitContainer.prototype.markupMethods,{onenabledChange:function(){I.toggleClass(this.domNode,"inactive",!this.enabled);this.targetMask.set("useRichTooltip",!this.enabled);}}),init:function AE(AK){this._super(AK);I.addWidgetCssClass(this,"mstrmojo-FilterBox");},onclick:function p(AK){var AO=W.isPrimaryMouseBtn(AK.e),AL=AH.call(this),AN=W.contains(this.containerNode,AK.getTarget(),true,this.domNode),AM;if(AO&&AL){if(AN){AM=true;AK.e.ptvSelected=true;}else{if(!W.contains(this.titlebarNode,AK.getTarget(),true,this.domNode)){AK.e.ptvSelected=true;}}}this._super(AK);if(AM){this.getEditorModel().selectTargetByValue(mstrmojo.vi.models.editors.FilterEditorModel.SELECTOR_VALUE);}},moveTooltip:function c(AK,AM){var AL=W.findWidget(AK.target);if(AL.id!==this.boxContent.id){return ;}this.richTooltip={posType:mstrmojo.tooltip.POS_TOPLEFT,cssClass:"vi-regular vi-tooltip-A",content:this.getTooltipContent(),top:AK.clientY+15,left:AK.clientX-15};this._super(AK,AM);},getTooltipContent:function AI(){var AN=L.call(this),AM=AN&&AN.n,AK=this.getDisplayName(),AL=(AK!==AM);return('<div class="name">'+AK+"</div>"+(AL?('<div class="dsc">'+AF.encodeHtmlString(mstrmojo.desc(15112,"Name in Dataset:")+" "+AM,true)+"</div>"):""));},setSelectTargetsState:function h(AK){var AL=(this.ctrlOverlay||{}).btnSelect;if(AL){AL.set("enabled",AK);AL.set("visible",AK);}},postBuildRendering:function d(){V.call(this);this._super();this.generateToolbar();var AK=this.boxContent;if(!AH.call(this)){this.setSelectTargetsState(false);AK.set("visible",false);this.showControlOverlay([{scriptClass:"mstrmojo.Label",cssClass:"dropMsg",text:mstrmojo.desc(13258,"Drag object here.")}]);}else{if(AK&&AK.isInvalid){this.showInvalidMessage();}else{if(!this.getTargetKeys().length&&!mstrApp.isAppStatePresentation()){J.call(this);}else{if(Y.walk("node.data.disabled",AK)){P.call(this);}}}}var AL=L.call(this);this.set("title",(AL&&AL.n)||"");if(this.model){I.toggleClass(this.domNode,"items-fit-content",this.model.itemsFitContent);}},showInvalidMessage:function O(){this.showControlOverlay([{scriptClass:"mstrmojo.Label",cssClass:"invalidMsg",text:this.boxContent.getInvalidTooltip()}]);},onRender:function G(){if(this._super){this._super();}AJ.call(this,!this.showTitleBar);if(mstrApp.isAppStatePause&&mstrApp.isAppStatePause()&&this.model&&this.model.hasRADataset()){this.set("isMasked",true);}},orientationHasChanged:function m(){if(g.call(this)){var AK=this.orientation,AN=AK==="h",AM=this.boxContent,AL=AM.content;this.defn.horiz=AN;if(AM.isRecursiveAttributeSelector()&&AL.isHoriz!==AN){this.rebuildBoxContent(AM.node);this.doLayout();}else{AL.isHoriz=AN;AL.set("orientation",AK);}V.call(this);}},addFormatProps:function z(AM,AL){AM=this._super(AM,AL);var AK=this.orientation;if(this.boxContent.content.orientation!==AK&&g.call(this)){AM=AM||this.model.getUnitFormatAction(this,NaN,null,AL);mstrmojo.models.FormatModel.getFormatUpdate(mstrmojo.models.FormatModel.ENUM_PROPERTY_NAMES.CONTROL_ORIENTATION,AK==="v"?0:1,AM.format);this.defn.horiz=AK==="h";if(!AL){window.setTimeout(function(){this.parent.rebuildChild(this);}.bind(this),0);}}return AM;},createDeleteUpdate:function o(){var AK=this.model,AL=AK.getRemoveControlUpdate(this.k,this.parent.k,this.defn.tks||"");if(this.defn.tks&&this.boxContent.isFilterNothing&&!this.boxContent.isFilterNothing()){AL.setTreesToRender(3);}AL.addUpdate(AK.associatedNodesUpdate(this.parent.children));return AL;},updateToolbar:function t(AK){R.call(this);var AL=this.boxContent;if(this.canShowDesignMenuItems()&&AL&&AH.call(this)){this.addModeMenuItems(AK,AL);AK.addSeparator();this.addClearFilterMenuItem(AK,AL);AK.addSeparator();this.addQualMenuItems(AK,AL);this.addSetDisplayFormsMenuItem(AK,AL);AK.addSeparator();this.addFilterStyleMenuItem(AK,AL);this.addMultiSelectMenuItem(AK,AL);this.addAutoSearchMenuItem(AK,AL);AK.addSeparator();this.addMenuItemIfSelectTargetsValid(AK,AL,mstrmojo.desc(12288,"Target the following visualizations or filters:"));AK.addSeparator();this.addToggleTitleMenuItem(AK);AK.addSeparator();this.addReplaceWithMenuItem(AK,AL);}return this._super(AK);},showControlOverlay:function n(AL,AK){this._super(AL,AK);I.addClass(this.domNode,"overlay");},hideControlOverlay:function C(){this._super();I.removeClass(this.domNode,"overlay");},onAppStateChange:function r(AK){var AN=mstrmojo.vi.VisualInsightApp.APP_STATES,AL=mstrApp.isAppStatePause(),AM=!!(AK.valueWas&AN.PAUSE);if(AL!==AM){if(this.model.hasRADataset()){this.set("isMasked",AL);}}if(this._super){this._super(AK);}},addContextMenuItems:function AB(AM,AL){this._super(AM,AL);var AK=this.boxContent;if(AH.call(this)&&!(AK&&AK.isInvalid)){this.addMenuItemIfSelectTargetsValid(AM,AK,mstrmojo.desc(12288,"Target the following visualizations or filters:"),false);}if(AK&&AK.isInvalid){this.addDeleteMenuItem(AM);}return AM;},getFormatMenuItemTarget:function H(AK){if(!AK||!W.contains(this.titlebarNode,AK.getTarget(),true,this.domNode)){return mstrmojo.vi.models.editors.FilterEditorModel.SELECTOR_VALUE;}return this._super(AK);},getTargetInfo:function b(){var AO=this.parent,AM=this.model,AK=this.boxContent,AN=[w.GRID,w.GRAPH,w.MOJOVISUALIZATION].concat(AM.isFromSolrCube(AK.defn.srcid)?[]:[w.SELECTOR]),AL=AO&&AO.getTargetKeysByType(AN).map(function(AP){var AR=AO.getUnitByKey(AP),AQ=AR.defn;return{n:AR.getDisplayName(),id:AP,st:AQ.style,src:AM.getObjectInfo(AQ.srcid)};}).filter(function(AP){return AP.id!==this.k&&AP.st!==U.ATTR_QUAL;},this)||[];return{keys:this.getTargetKeys(),items:AL};},toggleTitleBar:function f(AK){this._super(AK);AJ.call(this,!AK);},getDisplayName:function F(){return this._super()||mstrmojo.desc(6189,"Filter");},updateDisplayName:function K(AK,AL){this._super(AK,AL,true);},getAvatarCls:function u(){return this._super().concat(["filterAvatar"]);},allowDropFromDataset:function e(AK){return !AH.call(this)&&E.call(this,AK)&&mstrApp.allowWebDashboardDesign();},dropFromDataSource:function AC(AM){var Aa=S.call(this,AM),AW=this.id,Ac,AV,AU;if(Aa){var AN=this.getDocModel(),AY=AN.getDataService(),AO=this.defn,AL=this.getTargetKeys(),AZ=[this.k].concat(AL),AK=this.boxContent,AT=Y.valarray(AO.cgb).map(function(Ad){return[Ad,true];}),AS=(AM.actions||[]).concat([AY.getSetCtrlSourceAction(AO.ck,Aa.did,Aa.t,AT)]),AP=AD.wrapMethods(AM.callback,{success:function(Ad){var Ae=mstrmojo.all[AW];AN.partialUpdate(Ad.data,AN.getTargetDefn(AZ.join(D)),Ad.defn,[AK.defn.ckey]);if(!(mstrApp.isAppStatePause&&mstrApp.isAppStatePause())){Ae=Ae.parent.rebuildChild(Ae);}Ae.boxContent.set("visible",true);Ae.generateToolbar();}});Ac=AN.getCtrlStyleFromDatasetUnit(Aa);AS=AS.concat(AN.getCtrlActionsByStyle(Aa,AK.ck,Ac,this.orientation==="v"?0:1,parseInt(this.height,10),parseInt(this.width,10)));AU=this.height;AV=0;if(Aa.t===4){AS.push(AN.getUnitFormatAction(this,5,x(q.SHOW_TITLE_BAR,true)));if(AU==="40px"){AV=20;}}if(this.orientation==="h"){var AX=this.parent,Ab=AX.boxLayoutConfig,AR=Ab.box,AQ=AR&&AR.children&&AR.children[Ab.getBoxPath(this)];AV=AV+AN.getICSCtrlMoveHeightByStyle(Ac);if(AQ&&AQ.f){AQ.l=AQ.l+AV;AS=AS.concat(AX.getChildPositionActions(true));AS=AS.concat(AX.getBoxLayoutActions(true));}}AN.submitDataDefnUpdate(AS,AP);}},dropFromDataset:function X(AK){this.dropFromDataSource(AK);},dropFromAllObjects:function AA(AK){this.augmentDropContextForSchema(AK,this.getDocModel());this.dropFromDataSource(AK);},validateTarget:function B(AK){return true;},setTargets:function j(AK){this.getDocModel().changeFilterTargets(this,this.getTargetKeys(),AK,true,true);},getTargetKeys:function A(){var AK=this.defn.tks;return(AK&&AK.split(D))||[];},isSelectionDirty:function Q(AK){return AK.length;},getTitleBarCfg:function N(){var AK=this._super(),AL=this;AK.titleEdited=function AM(AO,AS,AN){var AR=this.parent,AU={success:function AT(AV){AR.defn.ttl=AV;AR.set("title",AV);},failure:function AQ(AV){mstrApp.onerror(AV);AR.titleBar.set("title",AN);}};if(AS){var AP=AR.getDocModel();AP.updateTitle(AO,this.title,AR.k,AP.currlaykey,"ttl",AU);}AR.editingTitleCallback(false);};AK.getTooltipContent=function(){return AL.getTooltipContent();};AK.shouldShowTooltip=function(){return true;};AK.tooltipOpenDelay=Z;return AK;},applyCSSFormatToNode:function l(AL,AK){var AN=this.boxContent;if(AN&&AN.content&&AN.content.hasRendered){var AM=AN._inSyncPhase;AN._inSyncPhase=true;AN.content.refresh();AN._inSyncPhase=AM;}this._super(AL,AK);},getBoxConfiguration:function a(){var AK=this._super();if(this.showTitleBar){AK=mstrmojo.hash.clone(AK);AK.f.v+=20;}return AK;},cancel:function k(){this.refresh();},});mstrmojo.vi.ui.rw.FilterBox.boxConfiguration={f:{h:150,v:42},o:"v"};}());(function(){mstrmojo.requiresCls("mstrmojo.DocSelector","mstrmojo.fe.FilterUtils","mstrmojo.func","mstrmojo.array","mstrmojo.hash","mstrmojo.expr","mstrmojo.DocDataService");var V=mstrmojo.fe.FilterUtils,M=mstrmojo.array,O=mstrmojo.hash,R=mstrmojo.func,Q=mstrmojo.expr;var K="LEVEL_NUMBER",G=mstrmojo.DocDataService.SUPPRESS_DATA;var H=16,L=1;function C(X){return X.t===47&&X.st===12033;}function B(){return{type:parseInt(this.type,10),src:this.k,ck:this.ck,ctlKey:this.ckey,ckey:this.ckey,tks:this.tks};}mstrmojo.DynamicListDocSelector=mstrmojo.declare(mstrmojo.DocSelector,null,{scriptClass:"mstrmojo.DynamicListDocSelector",_ieformatHandlers:{domNode:["F","text-align","vertical-align","line-height","z-index","top","left"],contentNode:["width","B","P","height"],filterNode:["height","width","B","P","fx","background-color"],item:["color","font","text-decoration","text-align","line-height"]},formatHandlers:{domNode:["F","text-align","vertical-align","line-height","z-index","top","left"],contentNode:["height","width","B","P","fx","background-color"],item:["color","font","text-decoration","text-align","line-height"]},_buildEvent:function J(a,Z){var Y=this.node,b=this.getAttrInfo(),X;X=Z.buildSelectionExprJSON(b);Y.defn.set("cek",{expr:X,disablePU:true});a.expr=V.getExprXml(X);if(this.incFetch){a.prKey=this.k;}},initControlInfo:function F(){var X=this.node.data;this._super();O.copy({incFetch:X.inc!==false,levelForms:X.lvfs||[]},this);},getCekEvtListener:function W(Y,X){return function(Z){var a=Z.value;if(a.hasOwnProperty("expr")){Y.expr=a.expr;if(!a.disablePU){Y.handleActionInSyncPhase(function(){X.setSelectionByExprJSON(a.expr);X.refresh();});}}};},updateWidget:function P(b){var c=this._super(b),X=b.getAttrInfo(),Z=b.node,a=Z.data,Y=Z.defn;c.updateItems(a.elms,a.p_relation);if(b.lockSelection){c.setSelectionByExprJSON(b.expr);}else{if(a.unset){c.setSelectionByExprJSON();}else{if(a.exp){c.setSelectionByExprJSON(a.exp);}else{if(a.ces){c.setSelectionByList(a.ces,Y.include);}}}b.expr=c.buildSelectionExprJSON(this.getAttrInfo());}c.browseFlags=H+(C(X)?0:L);return c;},clearSelector:function S(Y){var X=B.call(this);this.node.defn.set("cek",{expr:null});X.unset=true;X[Y?"forceApply":"forceBuffer"]=true;this.slice(X);},getWidgetConfig:function E(c,Z,Y,a){var b=c.levelForms,X=this._super(c,Z,Y,a);if(b.length>0){X.getMaxLevel=function(){return c.getMaxLevel();};X.getLevels=function(){return c.getLevels();};}X.getLevelExpression=function(e){var d=c.getAttrInfo();return c.getLevelExpression(d,e);};X.delegateExpandCollapse=function(d,e){return c.onExpandCollapse(d,e,!c.incFetch);};return X;},onExpandCollapse:function U(c,j,X){var h=this,Z=this.isInFilterPanel()&&this.getFilterPanel(),a=this.node,g=a.defn,e=this.model,Y=e.getDataService(),d=[Y.getRASelectorExpandAction({ck:g.ck,ckey:g.ckey,elementId:c.elementId,isExpand:c.isExpand?1:0})],f=X?j:R.wrapMethods({success:function(l){var k;if(Z){k=Z.getBufferedSlice(g.ckey);}h.lockSelection=true;e.partialUpdate(l.data,e.getTargetDefn(a.k));h.lockSelection=false;if(Z&&k){Z.bufferSlice(k);}}},j),b=X?G:{};e.controller.cmdMgr.execute({execute:function(){this.submit(d,f,b);},urInfo:{extraPuKeys:g.ck.split("\u001E").slice(1),treesToRender:3}});return !X;},getMaxLevel:function A(){var X=0;M.forEach(this.levelForms,function(Y){if(Y.lv>0){X=Math.max(X,Y.lv);}});return X;},getLevels:function D(){return M.map(this.levelForms,function(X){return{v:X.lv,n:X.lvfn};});},getLevelExpression:function I(Y,Z){var X=(Y.fs||[]).filter(function(a){return(a.n||a.fnm)===K;})[0];if(X&&parseInt(Z,10)>=0){return{et:Q.ET.AQ,fn:Q.FN.EQUAL,a:O.copyProps(["did","n","t","st"],Y),fm:{did:X.did||X.fid,n:K,dtp:Q.DTP.INTEGER},cs:[{v:Z,dtp:Q.DTP.INTEGER}]};}return null;},getAttrInfo:function N(X){var a=this.node.defn,Z=this.model.datasets,Y;X=X||a.srcid;O.forEach(Z,function(c){Y=c.att.filter(function(d){return d.did===X;})[0];if(Y){return false;}});if(Y&&C(Y)){var b=this.getAttrInfo(Y.attId);Y.fs=b.fs;Y.lvfs=b.lvfs;}return Y?Y:{};}});}());(function(){mstrmojo.requiresCls("mstrmojo.DocSelector","mstrmojo.vi.ui.rw._HasVisSelections","mstrmojo.vi.ui.rw.selectors._IsMultiUnitControl","mstrmojo.vi.ui.rw.selectors._BrushesAndHighlights","mstrmojo.hash","mstrmojo.array","mstrmojo.func","mstrmojo.VisUtility","mstrmojo.PerformanceLogOutput");var S=mstrmojo,J=S.hash,V=S.vi.ui.rw,H=S.VisUtility,R=V._HasVisSelections,O=V.selectors._IsMultiUnitControl,E=V.selectors._BrushesAndHighlights,U=mstrmojo.func.wrapMethods,G=S.PerformanceLogOutput;function M(Z){var X,d,b=Z.sc.exp,Y=b&&b.nds,W=Z&&Z.gts,c=Z&&Z.k,a=mstrmojo.DocXtabModel.prototype,e=J.copy(R,{k:c,model:a});if(!Z||!W||!b||!Y||Y.length<=0){return{};}X=(W.row||[]).concat(W.col||[]);H.modifyScExp(b,X,a,{});d=O.getSelectorDataFromExpression(b);e.addSelectionsFromExpression(d);return e.getSelectionHash();}mstrmojo.VisDocSelector=mstrmojo.declare(mstrmojo.DocSelector,null,{scriptClass:"mstrmojo.VisDocSelector",postBuildRendering:function Q(){this._super();var Y=this,W=Y.model,X=Y.parent;if(X&&X.refreshFilterSummaryBar){X.refreshFilterSummaryBar();}if(W){this.clearSelectorListener=W.attachEventListener("clearSelector",this.id,function(Z){if(Z.k===Y.k){var a=this.content;if(a){a.updateSummaryText({});}}});}},onAppStateChange:function L(W){var b=mstrmojo.vi.VisualInsightApp.APP_STATES,X=b.PAUSE,Y=mstrApp.isAppStatePause&&mstrApp.isAppStatePause(),a=!!(W.valueWas&X);if(Y!==a){var Z=this.parent;if(Z){Z.updateSummaryBar();}}},getWidgetConfig:function D(c,Y,X,a){var Z=c.node&&c.node.data,b=Z&&Z.sc,W=this._super(c,Y,X,a);if(b){W.exp=b&&b.exp;W.include=b.include;}return W;},getSelectionInfo:function C(){var X,W=this.node&&this.node.data,Z=W&&W.sc,Y=Z&&Z.exp;if(Y&&Y.nds){return M(W);}X=R.getSelectionCache.call(this);return X&&X._viSelections;},updateWidget:function K(W){var X=this._super(W);if(X){X.include=this.include;if(X.updateSummaryText){X.updateSummaryText(this.getSelectionInfo());}}return X;},clearSelector:function P(e){G.startTimer({functionName:"VisFilter.unsetFilter",purpose:"from Unset filter to End"},"timerid_VisFilter_unsetFilter");var d,Z=this.parent,W=this.content,a=this.node&&this.node.data,c=a&&a.sc,X=(a&&(a.sid!==undefined))?a.sid:1,Y=this.getSelectionInfo(),b=!Y||Object.keys(Y).length===0;if(Z&&Z.closeVisSelectorPanel){Z.closeVisSelectorPanel();}if(!c||b){return ;}d={ck:c.ck,ct:c.ct,ctlKey:c.ckey,selections:[],sid:X,tks:c.tks,type:521,isNavigation:false,ignoreTargetData:true};d[e?"forceApply":"forceBuffer"]=true;c.exp=null;R.setSelectionCache.call(this,{});E.clearSelections.call(this);this.slice(d);if(W){W.updateSummaryText({});}},update:function I(X){if(mstrApp.isInVFInteractMode){var W=this.parent;if(W){W.updateVizSelectorPanel();}}this._super(X);},supportsInclude:function N(){return true;},applySelections:function A(W){W.include=this.include;this.slice(W);},initControlInfo:function F(){this._super();var W=this.node,X=W&&W.data,Y=X&&X.sc;if(Y){J.copyProps(["allselected","ckey","ck","tks","style","showall","ct","include"],Y,this);}},onincludeChange:function B(g){var Y=g.value,e=this.model,Z=this.isInFilterPanel()&&this.getFilterPanel(),d=e.getDataService().newUpdate(Z);this.include=Y;if(Z&&Z._bufferedSlices){Z.applyBufferedSlices(true,d);}var f=this,b=this.node.k,a=e.getDataService(),X=e.getSliceCallback({type:parseInt(this.type,10),src:this.k,ck:this.ck,ctlKey:this.ckey,tks:this.tks,include:this.include,changeInclude:true}),c=[a.getSelectorIncludeAction({ck:this.ck,ckey:this.ckey,type:this.type,include:Y})],h=U(X,{success:function(j){f.set("wait",false);e.partialUpdate(j.data,e.getTargetDefn(b));}});var W=this.deferredEvt;if(!!W){e.sliceDeferred(d,W);}c[0].partialRetrieval=a.newRetrievalKeysConfig().addNode(b);c=!!W?c.concat(d.actions):(d.actions||[]).concat(c);this.set("wait",true);e.controller.cmdMgr.execute({execute:function(){this.submit(c,h);},urInfo:{extraPuKeys:f.ck.split("\u001E").slice(1),treesToRender:3}});},generateSummaryText:function(W){if(this.include){return W>1?mstrmojo.desc(15291,"## data points included").replace("##",W):mstrmojo.desc(15292,"1 data point included");}else{return W>1?mstrmojo.desc(15293,"## data points excluded").replace("##",W):mstrmojo.desc(15294,"1 data point excluded");}}});}());(function(){mstrmojo.requiresCls("mstrmojo.Obj","mstrmojo.form","mstrmojo._IsDocController","mstrmojo.AdvancedSortEditor","mstrmojo._DocToolbarActions","mstrmojo.func","mstrmojo.vi.controllers.UICmdMgr","mstrmojo.fe._HasFilterEditor");var H=3,j="mstrmojo-advancedSort";var W=mstrmojo.func,c=mstrmojo.array;mstrmojo.rw.DocController=mstrmojo.declare(mstrmojo.Obj,[mstrmojo._IsDocController,mstrmojo._DocToolbarActions,mstrmojo.fe._HasFilterEditor],{scriptClass:"mstrmojo.rw.DocController",start:function E(){var k=this.model;k.lastSavedStid=k.stid||0;this.cmdMgr=new mstrmojo.vi.controllers.UICmdMgr({controller:this,model:k});this.cmdMgr.dataService=k.getDataService();},onCmdMgrChanged:function f(){},getSorts:function A(n){var l=[],k=n.axis-1,m=[],o=[];l[k]=m;m.push({key:n.sortKey,isAsc:n.isAsc});o[k]=n.subTotalsPos;return{sorts:l,subTotalsPos:o};},onSort:function Q(k,m){var l=this.getSorts(m);this.onAdvancedSort(k,l.sorts,l.subTotalsPos,m.stt);},onAdvancedSort:function h(l,m,k,n){l.model.sort({sorts:m,stp:k,stt:n},this._getXtabCallback(l));},onGetAdvSortData:function D(l,o,n,q){var p=this,k=function k(t,r){var x=mstrmojo.all[j]||mstrmojo.insert({scriptClass:"mstrmojo.AdvancedSortEditor",id:j,postCreate:function AA(){if(mstrmojo.dom.isIE8){mstrmojo.css.addWidgetCssClass(this,"ie8");}}});var AB=t;if(r&&r.ndeForms){var w,z,u=[];var v=l.gridInfo;if(c.find(v.rows||[],"did",r.did)>=0){w="rows";}else{w="cols";u=AB&&AB[w].length>0?AB[w][0].v.split("!"):[];}AB=AB||{rows:[],cols:[],appliedRows:[],appliedCols:[],hierarchicalSort:{}};z=AB[w];u[0]=r.t;u[1]=r.did;c.forEach(r.ndeForms||[],function(AD){if(AD.obf){u[2]=AD.fid;u[3]=AD.t;var AE=u.join("!");var AF=r.n+" ("+AD.fnm+")";var AC=c.find(z,"v",AE);if(AC<0){z.push({n:AF,v:AE});}else{z[AC].n=AF;}}});}x.set("sortData",AB);x.set("controller",p);x.set("xtab",l);x.set("sourceAxis",o||1);x.set("sourceType",n||-1);x.open();};l.model.getAdvSortData({partialDisplayKeys:l.k,gridStyle:"AdvSortDataStyle"},this.model.newCallback({success:function(r){k(r&&r.grids&&r.grids[0],q);},failure:function m(r){mstrmojo.alert(r.code+": "+r.message);}}));},onPivot:function g(k,l){k.model.pivot(this._addNodeKeyToAction(k,l),this._getXtabCallback(k));},onSubmitTemplateUpdates:function J(k,l,m){k.model.submitTemplateActions(k.k,l,W.wrapMethods(this._getXtabCallback(k),m));},onShowTotals:function Z(k,l){k.model.showTotals(this._addNodeKeyToAction(k,l),this._getXtabCallback(k));},onDrill:function X(k,o,q){var m=this.model,l=this.model.prefs,p=l.rtprnt,n=l.rtthld;if(o.isWithin){if(!this.isInRequest()){o.retainParent=isNaN(p)?"":p;this.submitDrillWithin(k,o,q);}}else{if(!l.drillnw){mstrApp.showWait();}mstrmojo.form.send({evt:3125,displayMode:-1,drillPathKey:o.drillPathKey,elementList:o.drillElements,rwMesageID:m.mid,retainParent:isNaN(p)?"":p,retainThresh:isNaN(n)?"":n,rwGroupByElements:this.getGroupByElements(k).join(","),sliceId:k.sid||0},null,null,((l.drillnw)?"_blank":null));}},onDrillGraph:function d(k,o,q){var m=this.model,l=this.model.prefs,p=l.rtprnt,n=l.rtthld;if(o.isWithin){if(!this.isInRequest()){o.retainParent=l.rtprnt;this.submitDrillWithin(k,o,q);}}else{if(!l.drillnw){mstrApp.showWait();}mstrmojo.form.send({evt:3126,drillPathKey:o.drillPathKey,retainParent:isNaN(p)?"":p,retainThresh:isNaN(n)?"":n,rwMesageID:m.mid,"3126.x":o.x,"3126.y":o.y,graphHeight:o.graphHeight,graphWidth:o.graphWidth,rwGroupByElements:this.getGroupByElements(k).join(","),sliceId:k.sid||0,displayMode:o.displayType||2},null,null,((l.drillnw)?"_blank":null));}},submitDrillWithin:function b(k,l,m){k.model.drillGrid(this._addNodeKeyToAction(k,l),mstrmojo.func.wrapMethods(this._getXtabCallback(k),m));},onExecuteNewObject:function O(l,n){if(n){var k={};if(n.objType===H){k.evt=4001;k.reportID=n.did;k.reportViewMode=1;if(n.forceExec){k.execFlags=1;k.doNotUpdateCaches=true;}}else{k.evt=2048001;k.objectID=n.did;if(n.forceExec){k.freshExec=true;k.doNotUpdateCaches=true;}}if(n.linkAnswers){k.linkAnswers=n.linkAnswers;}mstrmojo.form.send(k,null,"POST",null);}},onReExecute:function(k,n){var l=k.model,m={evt:2048030,src:l.bp+".2048030",rwb:l.bs};if(n){m.ignoreStatus=true;mstrmojo.form.send(m,null,"POST",null);}else{mstrmojo.form.send(m,null,"POST",null);}},isAutoRefreshEnabled:function R(){return this.model&&this.model.rf;},isAutoRefreshStarted:function G(){return !!this.autoRefreshHandler;},startAutoRefresh:function M(){var k=this.model,l=k.rf,m=this;if(this.autoRefreshHandler){this.stopAutoRefresh();}this.autoRefreshHandler=setTimeout(function(){k.getDataService().refresh({sessionState:mstrApp?mstrApp.sessionState:""},{success:function n(o){if(k.clearDisposables){k.clearDisposables();}k.loadLayout(o);if(m.autoRefreshHandler){m.startAutoRefresh();}}});},l*1000);},stopAutoRefresh:function P(){clearTimeout(this.autoRefreshHandler);this.autoRefreshHandler=null;},offlineTransactionsSubmitted:function C(k){},transactionDiscarded:function I(k){},openOfflineTransactions:function N(){},invalidClientCache:function a(){},confirmMsgBeforeSubmit:function S(){},onLink:function B(r,m){if(m.link){var n,u,q=m.link,l=(q.prms?q.prms.length:0);for(n=0;n<l;n++){u=q.prms[n];if(u.pa&&u.pa.v){u.pa.v=mstrmojo.string.decodeHtmlString(u.pa.v,false);}}var t=m.link.toXml();if(t){m.linkAnswers=t;}delete m.link;}if(m.linkInfo&&m.linkInfo.so>0){m.originMessageID=this.model.mid;if(!m.linkAnswers){m.promptAnswerMode="0";}m.selectorMode=m.linkInfo.so;}var p=m.target||m.linkTarget||"_self",o=!mstrmojo.isUrlExternal(m.url||"");if(p==="_self"&&(o||(m.linkInfo&&m.linkInfo.target))){mstrApp.showWait({showCancel:true,onCancel:mstrApp.hideWait});}if(m.url){if(m.url.toLowerCase().indexOf("javascript:")>=0&&!mstrConfig.isLinkJSEnabled){return ;}if(mstrApp.isSingleTier){window.FormWrapper.openPage(m.url);}else{if(m.submitAsPost||m.url.length>2083){var k=mstrmojo.form.createDynamicForm(m.url);k.target=p;k.submit();}else{window.open(m.url,p);}}}else{mstrmojo.form.send(m,null,"POST",p);}},onTransactionUpdates:function e(m,o,n,k){var l={name:"TransactionUpdates",ctlKey:k};if(n){m.autoRefresh(l);}},onDownloadGridData:function K(k,l,m){this.model.downloadGridData(this._addNodeKeyToAction(k,l),m);},onGroupBy:function L(k,o){var m=k.model,l=o.groupbyKey,n=false;o.flags=m.agb===2?2:0;n=!!o.flags;m.getDataService().changeDocGroupBy(o,{success:function(p){if(n){k.parent.parent.unloadGbLayuts(l);}m.loadLayout(p);}});},_getAdvSortCallback:function(m,k){var p=this,o=p.model,l=function l(r){var t=mstrmojo.all[j];if(!t){t=mstrmojo.insert({scriptClass:"mstrmojo.AdvancedSortEditor",gridData:r,controller:p,model:o,xtab:m,subTotalsPos:k});}else{t.set("gridData",r);}t.open();};return o.newCallback({submission:mstrmojo.emptyFn,success:function q(r){l(r.grids[0]);},failure:function n(r){mstrmojo.alert(r.code+": "+r.message);},complete:mstrmojo.emptyFn});},onXtabColumnsResized:function U(k,l){k.model.resizeXtabColumn(this._addNodeKeyToAction(k,l));},addScrollPosition:function V(k,m,l){if(window.sessionStorage){window.sessionStorage.setItem("sp."+k,JSON.stringify({x:m,y:l}));}},getScrollPosition:function Y(k){var l=(window.sessionStorage&&window.sessionStorage.getItem("sp."+k));if(l){l=JSON.parse(l);}return l;},onRemoveUnit:function F(k,l){k.model.removeUnit(this._addNodeKeyToAction(k,l),this._getXtabCallback(k));}});}());(function(){mstrmojo.requiresCls("mstrmojo.rw.DocController","mstrmojo.func");var C=mstrmojo.func;var B="44px";mstrmojo.OIVMDocController=mstrmojo.declare(mstrmojo.rw.DocController,null,{scriptClass:"mstrmojo.OIVMDocController",openPage:function A(G){var F=this.model;G=parseInt(G,10);if(G>-1&&F.drillStateStack){var H=F.drillStateStack,E=H.splice(H.indexOf(G)),J=E[0];mstrApp.removeBackButtonItems(E.length);F.getDataService().refresh({stateID:J-1},{success:function I(K){F.loadLayout(K);}});}else{this._super(G);}},submitDrillWithin:function D(I,F,K){var G=this.model;var E=F.attrObj||{n:""};var H=this._addNodeKeyToAction(I,F),M=E.sc&&E.sc.tks,L=M&&M.split("\u001E")||[];H.updateNodeKey=[H.nodeKey].concat(L);delete F.attrObj;I.model.drillGrid(H,C.wrapMethods({success:function J(N){var O=G.drillStateStack=G.drillStateStack||[],P=N.stid;if(P!==undefined){O.push(P);mstrApp.addBackButtonItem({n:mstrmojo.desc(13778,"Back to: ##").replace("##",E.n),dssid:P});}}},C.wrapMethods(this._getXtabCallback(I),K)));},togglePathbar:function(I){if(!mstrApp.pathInfo){return ;}var H=I.src,G=this.view.parent.parent,F=G.pathbar,K=F.visible;H.set("iconClass",H.iconClass.replace(/ on/,"")+(!K?" on":""));H.domNode.setAttribute("title",K?mstrmojo.desc(13997,"Hide Navigation Bar"):mstrmojo.desc(13996,"Show Navigation Bar"));var J=!K,E=G.pathbarNode;F.set("visible",J);G.layoutConfig.h.pathbarNode=J?B:"0px";G.doLayout();if(!J){E.style.height="0px";}}});}());(function(){mstrmojo.requiresCls("mstrmojo.Container","mstrmojo._HasLayout","mstrmojo.SearchWidget","mstrmojo.SearchWidget2","mstrmojo.Label","mstrmojo.Box","mstrmojo.func","mstrmojo.css","mstrmojo.hash","mstrmojo.array","mstrmojo.vi._MonitorsAppState","mstrmojo._CanWSItemDragandDrop");mstrmojo.requiresClsP("mstrmojo.ui","_HasScroller","ScrollableList","Pulldown");mstrmojo.requiresClsP("mstrmojo.ui.menus","_HasMenuPopup","MenuConfig");mstrmojo.requiresClsP("mstrmojo.vi.ui","_IsDropTarget","_IsViPanel","_HasMask","PanelContents","PanelPortlet","DatasetPortlet","DatasetTableView","DatasetMDXView","DatasetUnitList","CollapsibleTitleBar");mstrmojo.requiresDescs(221,1158,1388,2461,3303,3581,5903,8708,11241,11307,11308,11241);var M=mstrmojo.hash,Y=mstrmojo.array,D=mstrmojo.css,f=mstrmojo.vi.models.EnumDragSources;var h="dsGroup_",P=mstrmojo.desc(2461,"All"),O=776,c=779,g=256;function Q(){var u=this,t=this.search,p=this.getDatasetCount(),r=this.data,q=this.gridSource,o=[{n:P,dsId:"",fScope:"",cls:"all"}],n=0;if(u.filterNodeConfig.att){o.push({n:mstrmojo.desc(3581,"Attributes"),dsId:"",fScope:"att",cls:"att"});}if(u.filterNodeConfig.mx){o.push({n:mstrmojo.desc(1158,"Metrics"),dsId:"",fScope:"mx",cls:"mx"});}if(p>1){o.push({isSeparator:true,cls:"separator"});M.forEach(r,function(v,w){o.push({n:v.name,dsId:w,fScope:"ds",cls:" ds "+(q===w?"grid-source":"")});});}o.some(function(w,v){if(!w.isSeparator&&u._filterSelection===(w.dsId||w.fScope)){n=v;return true;}return false;});t.set("filterItems",o);t.set("filterSelectedIndex",n);}function H(){var r=this.data,q=[],p=this.id,o=this;M.forEach(r,function(u,v){q.push(this.getDatasetPortlet(u,v,o,p));},this);var n=this.contents;var t=[].concat(n.children||[]);n.removeChildren();t.forEach(function(u){u.destroy();});n.addChildren(q);this.doLayout();}function G(){var n=this;window.setTimeout(function(){n.updateScrollbars();},0);}mstrmojo.vi.ui.DatasetObjects=mstrmojo.declare(mstrmojo.Container,[mstrmojo._HasLayout,mstrmojo.ui.menus._HasMenuPopup,mstrmojo.vi.ui._IsDropTarget,mstrmojo.vi.ui._IsViPanel,mstrmojo.ui._HasScroller,mstrmojo.vi.ui._HasMask,mstrmojo.vi._MonitorsAppState,mstrmojo._CanWSItemDragandDrop],{scriptClass:"mstrmojo.vi.ui.DatasetObjects",importDataBox:null,markupString:'<div id="{@id}" class="mstrmojo-VIPanel mstrmojo-VIDatasetObjects {@cssClass}" style="{@cssText}"><div class="mstrmojo-VIPanel-titlebar top"></div><div class="mstrmojo-VIPanel-search"><div><div><div class = "search-box"></div></div></div></div><div class="mstrmojo-VIPanel-content-wrapper" style="overflow:hidden;"><div class="mstrmojo-VIPanel-content"></div></div><div class="mstrmojo-NavigationBox-WSDND-overlay"></div><div class="mstrmojo-VIDND-mask"></div><div class="mstrmojo-object-browser-content"></div><div class="mstrmojo-VIPanel-handle splitter v"></div></div>',markupSlots:{titlebarNode:function m(){return this.domNode.firstChild;},searchNode:function k(){return this.domNode.childNodes[1];},searchBox:function S(){return this.domNode.childNodes[1].firstChild.firstChild.firstChild;},containerNode:function U(){return this.domNode.childNodes[2].firstChild;},wsItemdndNode:function B(){return this.domNode.childNodes[3];},maskNode:function L(){return this.domNode.childNodes[4];},browserNode:function b(){return this.domNode.childNodes[5];},handleNode:function N(){return this.domNode.lastChild;}},layoutConfig:{h:{titlebarNode:"19px",searchNode:"39px",containerNode:"100%",browserNode:"0"},w:{titlebarNode:"100%",searchNode:"100%",containerNode:"100%",browserNode:"0"},xt:true},filterNodeConfig:{att:true,mx:true},getLinksForEmptyData:function A(){return[];},markupMethods:{onvisibleChange:function R(){this.domNode.style.display=(this.visible)?this.cssDisplay:"none";if(this.visible){this.raiseEvent({name:"showPanel"});}},ondataChange:function e(){var p=this.data,q=this.importDataBox;if(!p||!Object.keys(p).length){if(!q){var o=this.getLinksForEmptyData();if(o.length){this.addChildren([{scriptClass:"mstrmojo.Box",markupString:'<div id="{@id}" class="mstrmojo-Box {@cssClass}" style="{@cssText}"><div class="alignBox"></div></div>',markupSlots:{containerNode:function(){return this.domNode.childNodes[0];}},alias:"importDataBox",cssClass:"importDataBox",ignoreLayout:true,children:o,postBuildRendering:function n(){var r=this.constructor.prototype.postBuildRendering.call(this);this.domNode.style.marginTop=((this.parent.domNode.offsetHeight-320)*0.33)+"px";return r;}}]);}}}else{if(q){this.removeChildren(q);q.destroy();}}H.call(this);Q.call(this);}},onAppStateChange:function a(n){this._super(n);if(mstrConfig.resolveOnly){var q=this.data,o=this.model,v=2,t,p,u=Y.filter(M.keyarray(q),function(w){t=q[w];p=t.st;return t.dsm!==v&&(t.state&g)&&(p===O||p===c);}),r={success:function(w){o.setUserDICubeInfo(w);if(o.hasUnpublishedCube()){o.updateCubePublishStatus(o.unpublishedCubes);mstrApp.rootCtrl.generateToolbar();}}};if(u.length>0&&(!mstrApp.isSingleTier||mstrApp.getWSLiveMode())){this.model.getDataService().getUserDICubeInfo(u,r);}}this.set("isMasked",mstrApp.isAppStateSelection());},doubleClickItemHandler:mstrmojo.emptyFn,twoClicksItemHandler:mstrmojo.emptyFn,datasetUnitListScriptClass:"mstrmojo.vi.ui.DatasetUnitList",onuseTableViewChange:function(){if(this.hasRendered){H.call(this);}},getDatasetTableView:function J(o,p){var n=this;return{alias:"tableView",scriptClass:"mstrmojo.vi.ui.DatasetTableView",panelId:this.id,docModel:this.model,unitListScriptClass:this.datasetUnitListScriptClass,dataset:{id:p,set:o},bindings:{filterScope:"this.parent.parent.filterScope",filterExpr:"this.parent.parent.filterExpr",level:"this.parent.level"},onTableCollapsedChange:function(){G.call(n);}};},getDatasetMDXView:function(o){var n=this;return{alias:"mdxView",scriptClass:"mstrmojo.vi.ui.DatasetMDXView",docModel:this.model,datasetsPanelId:this.id,unitListScriptClass:this.datasetUnitListScriptClass,data:o,bindings:{filterScope:"this.parent.parent.filterScope",filterExpr:"this.parent.parent.filterExpr",filterFunc:"this.parent.parent.parent.filterFunc",level:"this.parent.level"},onNodeCollapsedChange:function(){G.call(n);}};},getDatasetPortlet:function j(r,n,o,q){var x=this,u=function(){return[].concat(r.att).concat(r.mx);},t=function(AA){return M.copy(AA,{scriptClass:x.datasetUnitListScriptClass,panelId:q,docModel:o.model,bindings:{filterScope:"this.parent.parent.filterScope",filterExpr:"this.parent.parent.filterExpr",filterFunc:"this.parent.parent.parent.filterFunc",level:"this.parent.level + 1"},dataset:{id:n,set:r},postCreate:function AB(){this.doubleClickItem=mstrmojo.func.composite([this.doubleClickItem,x.doubleClickItemHandler]);this.twoClicksItem=mstrmojo.func.composite([this.twoClicksItem,x.twoClicksItemHandler]);}});};var w={scriptClass:"mstrmojo.vi.ui.DatasetPortlet",dataset:r,title:r.name,alias:h+n,did:n,level:0,panelId:q,useTableView:x.useTableView&&r.tables&&r.tables.length>1,layoutConfig:{h:{titlebarNode:(!!mstrApp.isWSStyling)?"46px":"35px",containerNode:"100%"},w:{titlebarNode:"100%",containerNode:"100%"},xt:true},getLayoutOffsets:function(){return{h:0,w:(!!mstrApp.isWSStyling)?0:4};},onisCollapsedChange:function v(){G.call(x);},getTitleBarCfg:function z(){return x.getDatasetTitleBarCfg(this);}};if(this.model.isMDXDataset(r)){M.copy({children:[this.getDatasetMDXView(r,n)],getSelectedItems:function(){return this.mdxView.getSelectedItems();},clearSelect:function(){this.mdxView.clearSelect();}},w);}else{if(w.useTableView){M.copy({children:[this.getDatasetTableView(r,n)],getSelectedItems:function(){return this.tableView.getSelectedItems();},clearSelect:function(){this.tableView.clearSelect();}},w);}else{M.copy({children:[t({alias:"ulist",getAllItems:function p(){return u();}}),{scriptClass:"mstrmojo.Label",cssClass:"emptyIndicator",bindings:{visible:"!this.parent.ulist.items.length",text:function(){if(!this.visible){return"";}return this.parent.ulist.filterExpr?mstrmojo.desc(11904,"No matched object"):mstrmojo.desc(11905,"No object");}}}],getSelectedItems:function(){var AA=this.ulist;return AA.getSelectedItems();},clearSelect:function(){this.ulist.clearSelect();}},w);}}return w;},getDatasetTitleBarCfg:function(n){return n.constructor.prototype.getTitleBarCfg.call(n);},title:mstrmojo.desc(11241,"Datasets"),titleBar:null,titlebarNode:null,containerNode:null,maskNode:null,contents:null,data:null,model:null,dropZone:true,isSearching:false,init:function(n){if(!!mstrApp.isWSStyling){this.layoutConfig={h:{titlebarNode:"26px",searchNode:"32px",containerNode:"100%",browserNode:"0"},w:{titlebarNode:"100%",searchNode:"100%",containerNode:"100%",browserNode:"0"},xt:true};}this.children=[{scriptClass:"mstrmojo.vi.ui.CollapsibleTitleBar",slot:"titlebarNode",alias:"titleBar",editTitleOnDoubleClick:false,close:function p(){this.parent.setOpenStatus(false);},onclick:function(){this.parent.clickOnCollapsibleTitleBar();},bindings:{title:"this.parent.title"}},{scriptClass:"mstrmojo.vi.ui.PanelContents",alias:"contents",slot:"containerNode"},{scriptClass:"mstrmojo.SearchWidget2",slot:"searchBox",alias:"search",quickSearch:true,hasFilter:true,filterSelectedIndex:0,filterItems:[{n:"All",dsId:"",fScope:"",cls:"all"},{n:mstrmojo.desc(3581,"Attributes"),dsId:"",fScope:"att",cls:"att"}],onsearch:function r(t){this.parent.contents.set("filterExpr",t);this.parent.toggleAllNodesCollapsed(false,false);this.parent.isSearching=true;},onclear:function o(){this.parent.contents.set("filterExpr","");this.parent.recoverAllNodesCollapsed();this.parent.isSearching=false;},onfilterItemSelected:function q(v,x){var w=v.dsId,z=v.fScope,AA=x,t=this.parent,u=t.contents;if(AA){AA.className="mstrmojo-ui-Pulldown-text "+z;}M.forEach(t.data,function(AD,AB){var AC=u[h+AB];if(AC){AC.set("visible",!w||AB===w);if(AB===w){AC.togglePortlet(false);}}});u.set("filterScope",z);t._filterSelection=w||z;t.onDatasetFilterChange(w);}}];this._super(n);},allowDrop:function F(o){var p=o.src.data,n=!!(p&&p.src===f.VIZ_EDITOR)||!!(p&&p.src===f.FILTERS)||!!(p&&p.src===f.VIZ)||!!(p&&p.src===f.VIZ_LAYER);if(p!==undefined&&p.allowDropOnTarget!==undefined){n&=p.allowDropOnTarget(f.DATASETS);}return n;},ondrop:function X(o){var p=o.src.data,n=p.items;if(p){p.onRemove(n&&n.length>1?n:p.item);}},getDropAvatarIcon:function E(o){var p=o.src.data,n="unselectable";if(p.src===f.VIZ_EDITOR||p.src===f.FILTERS||p.src===f.VIZ||p.src===f.VIZ_LAYER){n="remove";}return n;},ongridSourceChange:function(){Q.call(this);},clickOnCollapsibleTitleBar:mstrmojo.emptyFn,getPanelSelectedItems:function I(){var n=this.contents;return M.keyarray(this.data).reduce(function(o,q){var p=n[h+q];return o.concat(p.getSelectedItems(q));},[]);},doLayout:function K(){if(!this.visible){return ;}this._super();},onCubePublishChange:function l(q,o){if(q){if(this.data[q]){this.data[q].unpublished=o;}var p=this.contents,n=p&&p.children;Y.forEach(n,function(r){if(r.did===q){r.dataset.unpublished=o;r.unpublished=o;D.toggleClass(r&&r.domNode,"unpublished",o);r.generateToolbar();return false;}});}},updateDatasets:function V(n){var o=this.contents,p=this.data;M.forEach(n,function(u,q){var t=o[h+q].ulist,r=n[q];if(t&&r){t.set("dataset",{id:q,set:u});p[q]=u;}});},getDatasetPanel:function(n){return this.contents[h+n];},addPopupHandlers:function W(n,p,o){n.addPopupHandlers(this.id,p,o);},setupScrollNodes:function d(){this.scrollNode=this.containerNode;},getDatasetCount:function C(){return M.keyarray(this.data).length;},onDatasetFilterChange:function(){this.updateScrollbars();},toggleAllNodesCollapsed:function(o,p){var n=mstrmojo.all[this.id],q=n.settings,r=(n.contents.children||[]).length===1;(n.contents.children||[]).forEach(function(v){var u=q&&q.dataset(v.did),t=v.tableView||v.mdxView;if(p){u.isCollapsed=r?false:o;}v.togglePortlet(r?false:o);if(t){t.toggleAllNodesCollapsed(o,p);}});this.updateScrollbars();if(p){n.saveSettings();}},recoverAllNodesCollapsed:function(){var n=mstrmojo.all[this.id],o=n.settings;(n.contents.children||[]).forEach(function(r){var q=o&&o.dataset(r.did),p=r.tableView||r.mdxView;r.togglePortlet(q?q.getCollapsed():r.defaultCollapsed?r.defaultCollapsed:false);if(p){p.toggleAllNodesCollapsed(null,null,true);}});this.updateScrollbars();},destroy:function Z(o){var n=this.model;Y.forEach(this.subs,function(p){if(p){n.detachEventListener(p);}});this._super(o);}});}());(function(){mstrmojo.requiresCls("mstrmojo.DocSelector","mstrmojo.TextBoxDocSelector","mstrmojo.array","mstrmojo.string","mstrmojo.elementHelper","mstrmojo.mstr.EnumDSSXMLObjectTypes");var H=mstrmojo.array,G=mstrmojo.string,J=mstrmojo.elementHelper,N=mstrmojo.DocSelector.DATAPARAMS,U=mstrmojo.mstr.EnumDSSXMLObjectTypes,M=J.ELEM_ALL_ID;var K=0,B=1,C=2;var Q=1,R=3;var O=J.ELEM_ALL;mstrmojo.SearchBoxDocSelector=mstrmojo.declare(mstrmojo.TextBoxDocSelector,null,{scriptClass:"mstrmojo.SearchBoxDocSelector",filterElemALL:false,_buildEvent:function F(W,a){var d=[],X,Z=[],c=this.defn;H.forEach(a.items,function(g){g.n=mstrmojo.string.multiReplace(g.n,{";":"\\;"});d.push(g.v+";"+G.decodeHtmlString(g.n));Z.push(g);});X=d.length;if(!X){d.push(M);}if(d.length>0||!c.nsb||c.nsb===K){W.eid=d.join(mstrmojo.elementHelper.ELEM_SEPARATOR);}else{if(c.nsb===B||!c.showall){W.unset=true;}else{if(c.nsb===C){W.eid=M;Z=[O];}}}if(mstrApp.isAppStatePause&&mstrApp.isAppStatePause()){var f=this.model,Y=this.node,e=f.getCurrentLayoutDef(),b=e&&e.units,V=this.k;if(b[V]){b[V].cesChange=true;}Y.data.elms=Y.data.ces=Z;Y.data[N.CESREADY]=true;f.setDataReady(this.k,this.id,N.CESREADY,true,"ces",Z);f.setDataReady(this.k,this.id,"elms",Z);}if(c.sec){if(c.multi){this.parent.set("count",J.buildElemsCountStrByNum(X,0));}else{this.parent.set("count",J.buildElemsCountStrByNum(0,0));}}},updateWidget:function L(d){var W=this._super(d),X=d.node,c=X.defn,a=X.data,V=a.elms;if(V&&!c.sos){W.candidates=this.setupCandidates(c,V);}if(c.srcid){var Y=[],b,Z=H.filter(a.ces,function(f){return f.v!=="u;";});if(Z&&Z.constructor===Array){if(c.dfm===Q){for(b=0;b<Z.length;b++){if(Z[b].t!==R){Y.push(Z[b]);}}}else{Y=Z.concat();}}if(!c.sos){var e=[];H.forEach(Y,function(f){if(H.find(W.candidates.items,"v",f.v)>-1){e.push(f);}});Y=e;}W.items=Y;}return W;},getCekEvtListener:function S(W,V){return function(X){W.handleActionInSyncPhase(function(){V.set("items",X.value);});};},getWidgetConfig:function D(f,Z,c,V){var e=f.getFormats(),Y=f.node.data,b=this._super(f,Z,c,V),W=100,a=mstrApp.isVI,X=a&&(f.isRecursiveAttributeSelector()||f.node.defn.iase===false),d=this,g=X?{posType:mstrmojo.tooltip.POS_TOPLEFT,cssClass:"vi-regular pulldown",contentNodeCssClass:"srch htEnter",content:mstrmojo.desc(15764,"Hit Enter to search")}:{posType:mstrmojo.tooltip.POS_TOPLEFT,cssClass:"vi-regular pulldown",contentNodeCssClass:"srch",onclick:function(){var j=d.content,l=j.getSearchPattern(),k=d.id;d.model.changeFilterStyle(d,d.style,d.multi,false);this.set("allowOtherTooltips",false);j.hideTooltip();if(mstrApp.isWaiting()){var h=mstrApp.getWaitBox();var m=h.attachEventListener("visibleChange",h.id,function(n){if(n.value===false){mstrmojo.all[k].content.showInfoTooltip(l);m.clear();}});}},content:'<div class="auto">'+mstrmojo.desc(15910,"Searching...")+'</div><div class="separator"><div class="wait">'+mstrmojo.desc(15911,"Tired of waiting?")+'</div><div class="actn">'+mstrmojo.desc(15912,"Disable Instant Search")+"</div></div>"};b={scriptClass:b.scriptClass,cssText:e.height?"height: "+e.height:"",emptyText:mstrmojo.desc(4325,"Search")+" "+(c.ttl||""),richTooltip:a?g:null,items:c.srcid?(Y.ces?Y.ces.concat():[]):[],REQUEST_THRESHOLD:(mstrApp&&mstrApp.SEARCH_REQUEST_THRESHOLD)||55,suggestCount:(mstrApp&&mstrApp.SEARCH_SUGGESTION_LENGTH)||W,hitEnterToTest:X,stifleIntermediateSearch:true,srcid:c.srcid||"",srct:c.srct||U.Attribute,dsrc:c.dsrc||"",useClientForm:c.srct===U.Consolidation,onitemsChange:function(){if(!f._inSyncPhase){f.showInfoWin();f.selectorControlChange(this);}}};if(V&&!c.sos){b.candidates=this.setupCandidates(c,V);}else{b.useKeyDelay=true;b.noCache=true;}if(!c.multi){b.maxObjectCount=1;}return b;},isSelectAll:function E(){var V=this.children&&this.children[0];return V===undefined?true:(!V.items||V.items.length===0);},isFilterNothing:function I(){return this.isSelectAll();},setupCandidates:function A(W,X){var V=W.srcid?X:[];if(this.filterElemALL){V=H.filter(V,function(Y){return Y.v!=="u;";});}return{isComplete:true,items:V};},isValidSelection:function P(){var W=this.node.data,V=this.model;if(V.isSelWarnFlagOn(this.k)&&W.ces&&W.ces.length===0){return W.elms.length!==0;}return true;}});}());(function(){mstrmojo.requiresCls("mstrmojo.Container","mstrmojo._HasBuilder","mstrmojo._HasLayout","mstrmojo.vi.controllers.EnumLayoutSelectorPosition","mstrmojo.vi.ui._HasBoxLayout","mstrmojo.vi.ui._IsBoxLayoutChild","mstrmojo.ui._HasUITheme","mstrmojo.vi._MonitorsAppState","mstrmojo.vi._MonitorsLayoutMode","mstrmojo.vi.ui.PageByPanel","mstrmojo.vi.controllers.EnumEvents","mstrmojo.vi.ui.rw._SavesChildPositions","mstrmojo.vi.models.VIComponentMap","mstrmojo.vi.ui.tabs.LayoutTabStrip");var W=mstrmojo.vi.models.VIComponentMap.TYPES,D=mstrmojo.vi.controllers.EnumLayoutSelectorPosition,C=mstrmojo.vi.controllers.EnumEvents,G="45px",M="pageByPanel",B="selector",U="pageByNode";function K(Y){var a=this.model,Z=mstrApp.rootCtrl,X=a.tsp;if(X!==D.LEFT&&this.k===this.model.getCurrentLayoutKey()){this.toggleSelectorVisibility(!Y.visible);}Z.generateToolbar();}function N(){var X=this.pageByPanel,Y;if(X){Y=X.pageByStack;X.set("visible",Y&&Y.visible);}}function V(){var X=this.selector,Z=this.model,g=mstrApp.rootCtrl,c=g.view,f=Z.tsp,b=X.hasRendered,a=c.isCPVisible,e=this.parent,Y=!e||e.showTOC!==false,d;if(!Y&&f===D.LEFT){f=D.BOTTOM;}Y=f===D.LEFT;d=Y?"":(f!==D.TOP?"bottom":"top");if(b||d){this.removeChildren(X);}X.slot=d+"CtrlNode";X.set("alignPosition",f);if(b||d){this.addChildren([X]);}if(mstrApp.supportFeature(mstrmojo.vi.enums.EnumFeatures.SUPPORT_TOC_UPDATEPOISITION)){Z.controller.rootCtrl.setPanelDisplay("tocPanel",Y&&a);}if(this.k===this.model.getCurrentLayoutKey()){this.toggleSelectorVisibility(Y||!a);}}mstrmojo.vi.ui.rw.DocLayout=mstrmojo.declare(mstrmojo.Container,[mstrmojo._HasBuilder,mstrmojo._HasLayout,mstrmojo.vi.ui._HasBoxLayout,mstrmojo.vi.ui._IsBoxLayoutChild,mstrmojo.vi._MonitorsAppState,mstrmojo.vi._MonitorsLayoutMode,mstrmojo.vi.ui.rw._SavesChildPositions],{scriptClass:"mstrmojo.vi.ui.rw.DocLayout",markupString:'<div id="{@id}" class="mstrmojo-VIDocLayout"><div class="mstrmojo-VIDocument-top-selector"></div><div class="mstrmojo-VIDocLayout-pageby"></div><div class="mstrmojo-VIDocLayout-content {@cssClass}" style="{@cssText}"></div><div class="mstrmojo-VIDocument-selector"></div><div class="mstrmojo-VIDND-mask"></div></div>',markupSlots:{topCtrlNode:function(){return this.domNode.firstChild;},pageByNode:function(){return this.domNode.childNodes[1];},containerNode:function(){return this.domNode.childNodes[2];},bottomCtrlNode:function(){return this.domNode.childNodes[3];},maskNode:function(){return this.domNode.lastChild;}},layoutConfig:{h:{topCtrlNode:"auto",pageByNode:"auto",containerNode:"100%",bottomCtrlNode:"auto",maskNode:"auto"},w:{topCtrlNode:"100%",pageByNode:"100%",containerNode:"100%",bottomCtrlNode:"100%",maskNode:"100%"},xt:true},init:function R(Y){this._super(Y);var Z=this.id;this.builder.getLayoutVIMap(this.k).attachEventListener("viCompBuilt",Z,function(a){if(a.type===W.PAGEBY_STACK){this.pageByPanel.setPageByStack(a.widget);}});var X=mstrmojo.ui._HasUITheme.EnumThemeNames.DARK_THEME;if(!!mstrApp.isWSStyling&&(mstrApp.getThemeClassName()===X||mstrApp.rootCtrl.isDarkThemeSelected())){mstrmojo.css.addWidgetCssClass(this,X);}else{mstrmojo.css.removeWidgetCssClass(this,X);}this.model.attachEventListener("tspChange",this.id,V);if(mstrApp.supportFeature(mstrmojo.vi.enums.EnumFeatures.SUPPORT_TOC_UPDATEPOISITION)){mstrApp.rootCtrl.view.attachEventListener(C.CONTENTS_PANEL_VISIBILITY_CHANGE,this.id,K);}},onRender:function F(){this._super();N.call(this);V.call(this);if(!this.selector.children){this.selector.setTabs(this.parent.parent._layouts,this.model.getCurrentLayoutKey());}},onAppStateChange:function O(Y){var X=mstrmojo.vi.VisualInsightApp.APP_STATES.PRESENTATION;if(mstrApp.isAppStatePresentation()||Y.valueWas&X){V.call(this);}},postCalculateBoxLayout:function H(Y,X){var a=parseInt(this.docSection.width,10)||0,Z=mstrmojo.vi.ui.rw.DocRelativePanel.getLayoutBreakPoint();if(mstrApp.isWSStyling&&!mstrApp.isAppStatePresentation()){if(a===Z&&mstrApp.isLayoutModePreview()){X.left=Math.max(X.width-Z,0)/2;}}return Y;},applyBoxSize:function L(X,Z,b,a){this._super(X,Z,b,a);if(!this.boxLayoutConfig){var c=this.boxLayoutConfig=new mstrmojo.vi.ui.BoxLayoutConfig({hostId:this.id,identifier:"id"});var Y=c.box=c.getNewRootBox(true);c.addNewChild(Y,100,this.id);}this.buildBoxLayout();},alias:"docLayout",selector:null,pageByPanel:null,docSection:null,dropZone:true,resizeOrReposition:mstrmojo.emptyFn,getIdentifier:function I(){return"layout";},getSplitterHost:function E(){return this.containerNode;},children:[{scriptClass:"mstrmojo.vi.ui.PageByPanel",alias:M,slot:U,height:G,zIndex:2},{scriptClass:"mstrmojo.vi.ui.tabs.LayoutTabStrip",alias:B}],_set_children:function Q(b,Z,Y){if(Z!==this.children){var X=this[M];if(X){Z.push(X);}var a=this[B];if(a){Z.push(a);}}return this._super(b,Z,Y);},getTargetDropZone:function J(X){var Y=X.boxCache[this.id];return X.tgt.pos.x-Y.x<Y.w/2?"Left":"Right";},getViPanel:function P(X){return(X==="pageByPanel")?this[M]:((X==="selector")?this[B]:null);},toggleSelectorVisibility:function S(b){var Z=this.selector.domNode;if(Z){var Y=mstrApp.rootCtrl.tocPanel,a=Y&&Y.chapterCount===1,X=Y&&Y.pageCount>1;Z.style.setProperty("display",b||mstrApp.isVisBuilder||(mstrApp.isAppStatePresentation()&&a&&X)?"none":"block");this.doLayout();}},viPanelChangedVisibility:function A(X){var Y=this.boxLayoutConfig;if(X.visible){Y.addDropBox(this.docSection,"Top",{box:{boxId:String(X.id),cfg:X.getBoxConfiguration()}});}else{Y.deleteBox(X);}}});}());(function(){mstrmojo.requiresCls("mstrmojo.MetricQualDocSelector");mstrmojo.MetricSliderDocSelector=mstrmojo.declare(mstrmojo.MetricQualDocSelector,null,{scriptClass:"mstrmojo.MetricSliderDocSelector",_ieformatHandlers:{domNode:["F","text-align","vertical-align","line-height","z-index","top","left"],contentNode:["height","width","B","P"],filterNode:["height","width","B","P","fx","background-color"],item:["color","font","text-decoration","text-align","line-height"]},formatHandlers:{domNode:["F","text-align","vertical-align","line-height","z-index","top","left"],contentNode:["height","width","B","P","fx","background-color"],item:["color","font","text-decoration","text-align","line-height"]},newAndInitWidget:function B(E){var F=this._super(E);E.attachEventListener("includeChange",F.id,function(G){this.set("include",G.value);});return F;},getWidgetConfig:function D(I,G,F,H){var E=this._super(I,G,F,H);I.extCls="extSlider";E.isHoriz=true;E.include=F.include;return E;},isSelectAll:function C(){var E=this.children&&this.children[0];return E===undefined?true:E.unSet;},isFilterNothing:function A(){return false;}});}());(function(){mstrmojo.requiresCls("mstrmojo.DocLayout","mstrmojo.DocLayoutHoriz","mstrmojo.DocSectionHoriz","mstrmojo.DocSection","mstrmojo.DocSubsection","mstrmojo.DocPanelStack","mstrmojo.DocPanel","mstrmojo.DocTextfield","mstrmojo._CanSupportTransaction","mstrmojo._IsEditableTextfield","mstrmojo._HasDocLink","mstrmojo.DocImage","mstrmojo.DocLine","mstrmojo.DocRectangle","mstrmojo.DocRoundRectangle","mstrmojo.EnumRWUnitType","mstrmojo.DynamicClassFactory","mstrmojo.Button","mstrmojo.ToolBar","mstrmojo.DocSelector","mstrmojo.FilterPanelMenu","mstrmojo.DocPortlet","mstrmojo.DocResizablePortlet","mstrmojo.DocXtabGraph","mstrmojo.DocGridGraph","mstrmojo.DocVisualization","mstrmojo.DocXtabModel","mstrmojo.hash","mstrmojo.dom");var H=mstrmojo.hash,E=mstrmojo.dom,A=mstrmojo.EnumRWUnitType,N=mstrmojo.DynamicClassFactory.newComponent,R=mstrmojo.elementHelper,S=mstrmojo.Button.newIconButton,L={};function K(X){return function(){return this.parent.parent["on"+X]();};}var M=K("maximize"),U=K("restore"),G=K("minimize");function W(Y,b,Z,X,a){return S(Y,b,Z,null,{ds:X,visible:(a!==X)});}function I(X,b,a){var Z=this.classMap[b].n+(a?"Hover":""),Y=L[Z];if(!Y){Y=L[Z]=N(X,[mstrmojo._HasDocLink].concat(this.getLinkDrillMixins(a)));}return Y;}function Q(e,a,Z){var b=H.walk(Z.scriptClass,window),c=a&&a.defn,Y=a&&a.data,h=(c&&c.t),g=(h===A.TEXTFIELD&&((c&&c.dpst)));if(h===A.TEXTFIELD||h===A.IMAGE){var f=Y.dl,d=c.dl,X=(f&&f.items&&f.items.length)||(d&&d.items&&d.items.length>0);if(X||Y.url||c.url||c.ifw){b=I.call(this,b,h+(g?"B":""),X);}else{if((h===A.TEXTFIELD)&&c.txi){b=N(b,[mstrmojo._CanSupportTransaction,mstrmojo._IsEditableTextfield]);}else{if(h===A.TEXTFIELD&&a.defn.iifs){b=mstrmojo.DocSummaryTextfield;}}}}return this.newRWUnitInstance(e,a,b);}mstrmojo.rw._IsReportServicesDocBuilder=mstrmojo.provide("mstrmojo.rw._IsReportServicesDocBuilder",{_mixinName:"mstrmojo.rw._IsReportServicesDocBuilder",createClassMap:function B(){var X=this._super();X[A.LAYOUT]={n:"Layout"};X[A.SUBSECTION]={scriptClass:"mstrmojo.DocSubsection"};X[A.PANELSTACK]={n:"PanelStack",scriptClass:"mstrmojo.DocPanelStack"};X[A.PANEL]={n:"Panel",scriptClass:"mstrmojo.DocPanel"};X[A.TEXTFIELD]={n:"Textfield",scriptClass:"mstrmojo.DocTextfield"};X[A.IMAGE]={n:"Image",scriptClass:"mstrmojo.DocImage"};X[A.LINE]={n:"Line",scriptClass:"mstrmojo.DocLine"};X[A.RECTANGLE]={n:"Rectangle",scriptClass:"mstrmojo.DocRectangle"};X[A.ROUNDEDRECTANGLE]={n:"RoundedRectangle"};X[A.GRAPH]={n:"XtabGraph",scriptClass:"mstrmojo.DocXtabGraph"};X[A.GRIDGRAPH]={n:"GridGraph",scriptClass:"mstrmojo.DocGridGraph"};X[A.VISUALIZATION]={n:"Visualization",scriptClass:"mstrmojo.DocVisualization"};return X;},getLayoutViewerClass:function D(X){this.throwAbstractMethodError("getLayoutViewerClass");},newLayout:function V(c,a){var Z=[],Y=a.data,b=a.defn,X=this.getLayoutViewerClass(a),f=new X({n:b.title,model:c,node:a,controller:this.parent.controller,tbc:b.tbc,slot:"containerNode",visible:false,ifs:Y.ifs,gb:Y.gbys});var d=f.defn=H.copy(b);d.fmts=H.copy(b.fmts);function g(m,n){var j=m.length;if(j){for(var k=0;k<j;k++){var l=this.build([m[k]],c)[0];l.slot=n;Z.push(l);}}}g.call(this,c.getFixedHeaders(a),"fixedHeaderNode");var e=b.horiz?mstrmojo.DocLayoutHoriz:mstrmojo.DocLayout;Z.push(new e({slot:"layout",id:a.id,k:a.k,minHeight:Y.mh,formatResolver:c.formatResolver,rules:b.rules,builder:this,node:a,defn:b,model:c}));g.call(this,c.getFixedFooters(a),"fixedFooterNode");f.addChildren(Z);return f;},newSection:function O(X,Y){return this.newRWUnitInstance(X,Y,(Y.defn.horiz&&Y.data.subsections.length>1)?mstrmojo.DocSectionHoriz:mstrmojo.DocSection);},newPanelStack:function F(Y,Z,X){return this.newRWUnitInstance(Y,Z,X.cls||H.walk(X.scriptClass,window));},newTextfield:Q,newImage:Q,newButton:Q,newRoundedRectangle:function J(X,Y){return this.newRWUnitInstance(X,Y,E.supports(E.cssFeatures.ROUND_CORNERS)?mstrmojo.DocRectangle:mstrmojo.DocRoundRectangle);},getPortletExportGridToolbar:mstrmojo.emptyFn,createPortlet:function C(AG,p,AD){var AL=p.defn,b=AL.ds,AC=(AL.iifp||!(AG===A.PANELSTACK||(AL.ttl===undefined&&AL.qsm)||AG===A.SELECTOR)),e=(AG===A.GRAPH||AG===A.GRIDGRAPH),l=[],AH="",r="",n="",Y=(AG===A.GRID||e||AG===A.VISUALIZATION||AG===A.MOJOVISUALIZATION)&&parseInt(AL.eo,10)!==2,X=[],AE="mstrmojo-oivmSprite ",v=false,a;if(AL.qsm){AH="qks";var c=function(AO,t,w){return S(AO,AE+t,function(){return this.parent.parent.content.quickSwitch();},{visible:"this.parent.parent.defn.qsm !== this.qsm"},{qsm:w});};l.push({scriptClass:"mstrmojo.ToolBar",slot:"leftToolbarNode",alias:"leftToolbar",cssClass:(!AC)?"grouped":"",children:[c(mstrmojo.desc(3547,"View: Grid"),"tbGrid",1),c(mstrmojo.desc(3548,"View: Graph"),"tbGraph",2)]});}if(Y){a=this.getPortletExportGridToolbar(AD);if(a){r=a.css;X=a.node;l.push(X);}}if(AC){if(AL.iifp){AH="wrap";l.push({scriptClass:"mstrmojo.ToolBar",slot:"leftToolbarNode",alias:"leftToolbar",children:[W(mstrmojo.desc(8973,"Collapse"),"co",null,1,b),W(mstrmojo.desc(8972,"Expand"),"ex",null,0,b)]});}else{var z=[W(mstrmojo.desc(4539,"Minimize"),"mn",G,1,b),W(mstrmojo.desc(4540,"Restore"),"rs",U,0,b),W(mstrmojo.desc(4541,"Maximize"),"mx",M,2,b)];if(Y&&a){X.children=(X.children||[]).concat(z);}else{r="resize";l.push({scriptClass:"mstrmojo.ToolBar",slot:"toolbarNode",alias:"rightToolbar",children:z});}}}AD.slot="contentNode";AD.alias="content";AD.title=AL.ttl||"";if(AL.sec){var AI=p.data.elms,k=p.data.ces,u=p.data.unset,AK=(k&&k.length)||0,AM=(AI&&AI.length)||0,AJ;if(AL.sos){AD.contentClass="fpsb";for(AJ=AK-1;AJ>=0;AJ--){if(k[AJ]._did_){AK--;}}AD.count=R.buildElemsCountStrByNum(AK,AM);}if(k&&AI&&AI.length&&AL.style!==mstrmojo.DocSelector.STYLES.SCROLLER){if(AL.multi){if(u){AD.count=R.buildElemsCountStr(AI,AI);}else{AD.count=R.buildElemsCountStr(k,AI,!AL.include);}}else{AD.count=R.buildElemsCountStr(AI,AI);}}}l.push(AD);if(AG===A.PANELSTACK){var g=function(AP,w,AO,t){return S(AP,AE+w,function(){return this.parent.parent.content.switchToPanel(t);},{enabled:"this.parent.parent."+AO});},j=[],Z=[],o=!!p.sw,h=!!AL.ifw,d=!!AL.ifp;if(o){Z.push(g(mstrmojo.desc(1058,"Previous"),"tbPrev","prevEnabled",-1));j.push(g(mstrmojo.desc(2917,"Next"),"tbNext","nextEnabled",1));}if(h){j.push(S(mstrmojo.desc(2102,"Close"),AE+"mstrmojo-DocInfoWindow-close",function(){this.parent.parent.parent.close();}));}if(d){n="ifp";var AA=mstrmojo.desc(2164,"Apply");l.push({scriptClass:"mstrmojo.HBox",slot:"buttonbarNode",alias:"buttonbar",cssClass:"buttonBox",children:[{scriptClass:"mstrmojo.Button",alias:"resetBtn",title:mstrmojo.desc(8329,"Unset"),text:mstrmojo.desc(8329,"Unset"),cssClass:"mstrmojo-FilterPanel-Btn apply",bindings:{visible:function(){return !AL.cas;},enabled:function(){return this.parent.parent.clearEnabled;}},onclick:function AB(){if(AD&&AD.clearBuffSlices){AD.clearBuffSlices();AD.clearAllFilter();AD.applyBufferedSlices();}}},{scriptClass:"mstrmojo.Button",alias:"applyNow",title:AA,text:AA,cssClass:"mstrmojo-FilterPanel-Btn apply",bindings:{visible:function(){return !AL.cas;},enabled:function(){return this.parent.parent.applyEnabled;}},onclick:function AB(){if(AD&&AD.applyBufferedSlices){AD.applyBufferedSlices();}}}]});j.push({scriptClass:"mstrmojo.Button",cssClass:"mstrmojo-oivmSprite tbDown",alias:"btnMenu",onclick:function AB(){this.openPopupMenu();},openPopupMenu:function(){var t=mstrmojo.findAncestor(this,"openPopupMenu");if(t){t.openPopupMenu("mstrmojo.FilterPanelMenu",{openerButton:this,fps:AD,cmPos:this.cmPos,lockIW:AD});}}});v=true;}if(h||d){var AN=[];if(o){AN[0]="pst-l";}if(d){AN.push("ifp");}Z.push({scriptClass:"mstrmojo.Box",cssClass:AN.join(" ")});}if(h||o||d){var q=h?"ifw ":"",AF=d?"ifp ":"",f=!AL.cas?"cas ":"";r=(o?"pst-r ":"")+q+AF+f;AH=(o?"pst-l ":"")+q+AF+f;l.push({scriptClass:"mstrmojo.ToolBar",slot:"leftToolbarNode",alias:"leftToolbar",children:Z});l.push({scriptClass:"mstrmojo.ToolBar",slot:"toolbarNode",alias:"rightToolbar",children:j});}}if(AG===A.SELECTOR&&AD.spm){r="spm";l.push({scriptClass:"mstrmojo.ToolBar",slot:"toolbarNode",alias:"rightToolbar",children:[{scriptClass:"mstrmojo.Button",cssClass:"mstrmojo-oivmSprite tbDown",alias:"btnMenu",onclick:function AB(t){t.cancel();this.openPopupMenu();},openPopupMenu:function(){var t=mstrmojo.findAncestor(this,"openPopupMenu");if(t){t.openPopupMenu("mstrmojo.SelectorMenu",{openerButton:this,selector:AD,cmPos:this.cmPos});}}}]});v=true;}var x=AC?mstrmojo.DocResizablePortlet:mstrmojo.DocPortlet,m={k:AD.k,defn:AD.defn,model:AD.model,children:l,title:AD.title,count:AD.count,floatingTitle:(AL.ttl===undefined&&AL.qsm),leftToolbarNodeClass:AH,loadDataOnResize:e,toolbarNodeClass:r,buttonbarNodeClass:n,attachContextMenuEvent:v};if(AG===A.PANELSTACK){m.bindings={title:"this.children[0].title"};if(p.sw){m.bindings.prevEnabled=function(){return this.children[0].hasPreviousPanel;};m.bindings.nextEnabled=function(){return this.children[0].hasNextPanel;};}if(AL.ifp){m.bindings.applyEnabled=function(){return this.children[0].applyEnabled;};m.bindings.clearEnabled=function(){return this.children[0].clearEnabled;};}}if(AL.iifp){m.onclicktitle=function(){if(AD.defn.ds===1){AD.parent.onexpand();}else{AD.parent.oncollapse();}};}return new x(m);},newXtabModel:function P(X){return new mstrmojo.DocXtabModel(X);}});}());(function(){mstrmojo.requiresCls("mstrmojo.gmaps.MapEnums","mstrmojo.mapbox.MapboxEnums","mstrmojo.gmaps.MapUtils","mstrmojo.vi.models.editors.MapEditorModel","mstrmojo.Label","mstrmojo.expr","mstrmojo.array","mstrmojo.models.FormatModel","mstrmojo.chart.enums.EnumFontStyle","mstrmojo.mapbox.ui.selectors.ClusterMaxZoomControl","mstrmojo.mapbox.ui.selectors.ZoomThroughLayersControl");var b=mstrmojo,q=b.mapbox.EXCLUDED_FONT_FAMILIES,I=b.gmaps,c=mstrmojo.array,B=I.MapUtils,L=I.EnumMarkerType,E=I.EnumPropertyType,X=I.EnumClusterMode,h=I.EnumGraphicType,R=I.EnumLanguageType,f=I.EnumDistUnitType,A=I.TARGET_FORMATTING_LAYERS,d=mstrmojo.expr.DTP,M=[{id:f.KM,n:mstrmojo.desc(15733,"km")},{id:f.Miles,n:mstrmojo.desc(11140,"miles").toLowerCase()}];var l=1,N=4;mstrmojo.vi.models.editors.MapboxEditorModel=mstrmojo.declare(mstrmojo.vi.models.editors.MapEditorModel,null,{scriptClass:"mstrmojo.vi.models.MapboxEditorModel",help:"Format_Panel_Geospatial_Service.htm",getInitialTarget:function n(){return A;},getTargetPulldownItems:function k(r){var v=this._super(r),u=this.getHost(),t=this,w=function(){var x=t.getFormattingLayerControls;t.replaceChildControls(r,x.call(t));};if(u.isBaseMapValid()&&!(u.excludeData||u.isEmpty())){v.unshift({n:mstrmojo.desc(15734,"Formatting on layer"),v:A,h:w});}return v;},getMapLabelsControls:function o(){var r=[],t=this.getHost();r.push(this.getGroupTitle(mstrmojo.desc(15925,"Map Labels")));r.push(this.getMapboxCheckboxControl(E.showMapLable,mstrmojo.desc(15735,"Show map labels")));r.push(this.getMapboxCheckboxControl(E.mapLabelOnTop,mstrmojo.desc(15736,"Bring map labels to front")));var u=this.fnGetPulldown(this.getLanguageTypes(),this.getSelectedLanguageIndex(),mstrmojo.desc(13111,"Language"),E.languageType);u.set("enabled",t.getPropertyValue(E.showMapLable));r.push(u);return r;},getZoomingFunctionControls:function K(){var r=[],t=this.getHost();r.push(this.getGroupTitle(mstrmojo.desc(15926,"Zooming Function")));r.push(this.getZoomControls());r.push(this.getKeepZoomLevelandPosCtrl());if(t.isZoomThroughLayerCtrlShown&&t.isZoomThroughLayerCtrlShown()){r.push(this.getZoomThroughLayersControls());}return r;},getGeoUnitControls:function F(){var r=[];r.push(this.fnGetPulldown(M,this.getSelectedDistUnitIndex(),mstrmojo.desc(15737,"Geo unit"),E.distUnit,{isNested:true,showDivider:true,isContainer:true}));return r;},getMapOptionControls:function P(){var r=[];r.push(this.getMapStyleControls());r.push(this.getEditorGroup(this.getMapLabelsControls(),{isNested:true,showDivider:true,isContainer:true}));r.push(this.getEditorGroup(this.getZoomingFunctionControls(),{isNested:true,showDivider:true,isContainer:true}));r.push(this.getEditorGroup(this.getGeoUnitControls(),{isNested:true,showDivider:true,isContainer:true}));r.push(this.getMoreOptionsControl());return[this.getEditorGroup([this.getEditorGroup(r)],{showDivider:true,isNested:true,isContainer:true})];},getFormattingLayerControls:function S(){var r=[];if(!mstrApp.isInVFConfigMode){this.mapLayersPullDown=this.getMapLayersPullDown();r.push(this.mapLayersPullDown);}r.push(this.getGraphicLayerOptionsControls());return[this.getEditorGroup([this.getEditorGroup(r)],{showDivider:true,isNested:true,isContainer:true})];},getMapboxCheckboxControl:function G(v,AB){var z=this,AC=this.getHost(),x=AC&&AC.getProperties(),r=!!(x&&(x[v]===true||x[v]==="true")),w=new mstrmojo.ui.Checkbox({checked:r,oncheckedChange:function t(AD){z.onPropertiesChanged(v,AD.value);}}),u=this.getLabelAndControl(AB,w,"10px","100%",true,{enabled:this.isBmpLabelCtrlEnabled(v)}),AA=u.getLabel();AA.onclick=function(){w.onclick();};return u;},isBmpLabelCtrlEnabled:function O(x){var w=this.getHost(),t=!!(w&&w.isLbGrpEstInBaseLayer()),v=E.showMapLable,u,r;if(x===v){return t;}else{u=w&&w.getProperties();r=!!(u&&(u[v]===true||u[v]==="true"));return t&&r;}},getSelectedDistUnitIndex:function H(){var u=this.getHost(),t=u&&u.getProperties(),v=t&&t[E.distUnit],r=0;if(v===undefined){v=u.getDefaultDistanceUnit();}switch(v){case f.KM:default:r=0;break;case f.Miles:r=1;break;}return r;},getMapLayersPullDown:function J(){var t=this.getHost(),r=t.getGraphicLayerNameArr();c.forEach(r,function(v,u){v.id=u;});return this.fnGetPulldown(r,t.getEditingLayerIdx(),undefined,E.editingLayerIdx);},selectLayerForRMCFmt:function W(r){if(this.mapLayersPullDown&&r){this.mapLayersPullDown.selectItemByField("k",r);}},getLanguageTypes:function e(){return[{id:R.Local,n:mstrmojo.desc(14937,"Local")},{id:R.English,n:mstrmojo.desc(1376,"English")},{id:R.Both,n:mstrmojo.desc(1376,"English")+" + "+mstrmojo.desc(14937,"Local")}];},getSelectedLanguageIndex:function V(){var t=this.getEditingPropertyVal(E.languageType),r=1;switch(t){case R.Local:r=0;break;case R.English:r=1;break;case R.Both:r=2;break;default:break;}return r;},getGraphicTypes:function p(){return[{n:mstrmojo.desc(13254,"Marker"),id:h.Marker},{n:mstrmojo.desc(348,"Bubble"),id:h.Bubble},{n:mstrmojo.desc(13255,"Area"),id:h.Area}];},getGraphicTypeSelectedIndex:function Z(t){var r=0;switch(t){case h.Marker:r=0;break;case h.Bubble:r=1;break;case h.Area:r=2;break;default:break;}return r;},getMarkerTypes:function g(){return[{n:mstrmojo.desc(12100,"Circle"),id:L.Circle},{n:mstrmojo.desc(11837,"Pins"),id:L.Pin},{n:mstrmojo.desc(154,"Squares"),id:L.Square},{n:mstrmojo.desc(14746,"Diamonds"),id:L.Diamond},{n:mstrmojo.desc(14747,"Images"),id:L.Image}];},getMarkerTypeSelectedIndex:function U(){var t=this.getEditingPropertyVal(E.markerType),r=0;switch(t){case L.Circle:r=0;break;case L.Pin:r=1;break;case L.Square:r=2;break;case L.Diamond:r=3;break;case L.Image:r=4;break;default:break;}return r;},getValidationTextBoxWithUnitControl:function Y(u,t,r){r=r||{col1Width:"100%",col2Width:"12px"};return this.getTwoColumnContainer([new mstrmojo.ui.editors.controls.ValidationTextBox(u),new mstrmojo.Label(t)],r);},getClusteringControlForMarker:function a(){return this.getClusteringControls();},getClusteringControlForBubble:function j(){return this.getClusteringControls();},getClusteringControls:function D(AC){var w=this,AD=this.getHost(),x=AD&&AD.getEditingGridProps(),u=E.clusterMode,t=this.getGroupTitle(mstrmojo.desc(11841,"Clustering")),v=function(){return x[u]===X.ON;},AB=this.getCheckboxAndLabel(v(),mstrmojo.desc(15705,"Enable Clustering"),function(AE){var AF=AE?X.ON:X.OFF;w.onPropertiesChanged(u,AF);}),z=this.getTwoColumnContainer([new mstrmojo.Label({text:mstrmojo.desc(15738,"Cluster radius"),enabled:v()}),this.getValidationTextBoxWithUnitControl({alias:"clusterRadius",required:true,errRevert:false,dtp:d.INTEGER,constraints:{min:1,max:300,invalidCssClass:"mstrmojo-TextBox-ErrValidation"},getInvalidMsg:function(){return mstrmojo.desc(15739,"Cluster radius should be integer between 1 and 300");},useRichTooltip:true,updateTooltipConfig:function(){if(this.isValid()){this.richTooltip={posType:mstrmojo.tooltip.POS_TOPLEFT,cssClass:"vi-regular vi-tooltip-C mapbox_cluster_radius",left:this.domNode.offsetWidth+6+20,top:-4,refNode:this.domNode,keepArrowYPos:true,content:'<div class="name">'+mstrmojo.desc(15740,"All points within the radius of R pixels will be clustered.")+'</div><div class="cluster_radius_img"></div>'};return ;}this.richTooltip={posType:mstrmojo.tooltip.POS_TOPLEFT,cssClass:"vi-warning vi-tooltip-C vi-calculation-warning",left:this.domNode.offsetWidth+6+20,top:-4,refNode:this.domNode,keepArrowYPos:true,content:this.getInvalidMsg(this.validationStatus)};},validationDelay:1500,value:parseInt(x[E.clusterRadius],10)||50,enabled:v(),onValid:function(){w.onPropertiesChanged(E.clusterRadius,this.value);}},{text:"px",enabled:v()})]),r=new mstrmojo.Label({text:mstrmojo.desc(15741,"Set zoom level for clustering"),enabled:v()}),AA=new mstrmojo.mapbox.ui.selectors.ClusterMaxZoomControl({host:AD,enabled:v()});return this.getEditorGroup([t,AB,r,AA,z],{isNested:true,showDivider:true,isContainer:true});},getZoomThroughLayersControls:function Q(){var w=this,v=this.getHost(),x=E.enableZoomThroughLayer,r=function(){return B.parseBoolean(v.getPropertyValue(x));},t=this.getCheckboxAndLabel(r(),mstrmojo.desc(15742,"Zoom through layers"),function(z){w.onPropertiesChanged(x,z);}),u=new mstrmojo.mapbox.ui.selectors.ZoomThroughLayersControl({host:v,enabled:r()});t.cssClass="";return this.getEditorGroup([t,u],{isNested:true,showDivider:false,isContainer:true});},getDataLabelControlConfig:function C(){return l+N;},getDataLabelExtraControlProps:function m(){return{getFontFamilyItems:B.getFontFamilyItems.bind(this,q),getFontStyleItems:function(){return[{n:mstrmojo.desc(2718,"Bold"),id:"b",css:"bold"},{n:mstrmojo.desc(2719,"Italic"),id:"i",css:"italic"}];}};}});}());(function(){mstrmojo.requiresCls("mstrmojo.func","mstrmojo.num","mstrmojo.vi.models.editors.BaseEditorModel","mstrmojo.ui.Pulldown","mstrmojo.tooltip","mstrmojo.gm.GMUtility","mstrmojo.VisUtility","mstrmojo.NumStepperContentProvider","mstrmojo.ui.CheckList","mstrmojo.vi.ui.rw.selectors.CheckList","mstrmojo.ui.menus._HasMenuPopup","mstrmojo.ui.menus.MenuConfig","mstrmojo.ui.menus.Menu","mstrmojo.gm.GMEnums","mstrmojo.ui.editors.controls.AdvancedColorPicker","mstrmojo.ui.editors.controls.CharacterGroup","mstrmojo.ui.editors.controls.LineConfigGroup","mstrmojo.ui.editors.controls.FillConfigGroup","mstrmojo.ui.editors.controls.ColorPickerButton","mstrmojo.ui.editors.controls.Stepper","mstrmojo.ui.editors.controls.CustomRange","mstrmojo.ui.editors.controls.GMReferenceLineList","mstrmojo.Button","mstrmojo.vi.ui.rw.selectors.Slider","mstrmojo.vi.ui.ColorRangeSelector");var Bo="[undefinedIdentity]",f=0;var Cm=mstrmojo.emptyFn,CK=mstrmojo.Widget,Cc=mstrmojo.array,A0=mstrmojo.hash,CC=mstrmojo.css,AU=mstrmojo.func,C=mstrmojo.num,B6=mstrmojo.gm,Ar=mstrmojo.VisUtility,t=mstrmojo.expr.DTP,Ca=B6.GMUtility,CG=B6.EnumSelectionOptionLevel,Ad=B6.WidgetPropertyTag,Cw=B6.FormatingPropertyTag,BA=mstrmojo.models.FormatModel.ENUM_PROPERTY_NAMES,AF=mstrmojo.chart.enums.EnumFontStyle,BP=B6.EnumIdentityType,CI=B6.EnumShape,Ap=B6.EnumFitTo,Cu=B6.EnumSubtype,E=B6.EnumSelectionOptionLevel,c=mstrmojo.ui.editors.controls.CharacterGroup.CTRL_FLAGS,W=mstrmojo.ui.editors.controls.AdvancedColorPicker,B=B6.EnumContainerFitModes,CB=mstrmojo.ui.editors.controls.FillConfigGroup.CTRL_FLAGS,B1={isNested:false,showDivider:false},BE={isNested:false,showDivider:true},CY={propagateChildProps:function(Cy){if(Cy!=="enabled"){this._super();}}};var B8=Ad.AXIS_SCALE_DATA,u=Ad.AXIS_ORIGIN;var CP=1,AO=2,Bh=4,An=8,Aj=16,BC=32,Bc=64,AA=128,Cd=256,v=512,AE=1024,b=2048,L=4096,Bp=8192,Bg=16384,CV=32768,B4=65536,AN=131072,Aa=262144,AH=524288;var Y="de",CR="tln",Bt="rln",BB=mstrmojo.vi.models.editors.BaseEditorModel.TITLE_CONTAINER_VALUE,CS="sp",Bu="ax",O="lgd",AX="rcl",BH="bp",BV="hst",Ck="wf";var z="panel",Ab="selector";var AZ="default";var B9="selAxSc4",Bs="selBdrMtxLn4",BU="selBgFill4",BX="rwColBgFill4",BR="selAxLbl4",AK="selAxLn4",Av="selAxTil4",CU="selGL4",G="selRwCl4",Au="selTln4",p="selRfMtcln4",BG="selRfTyln4";var Ax="@",Cp=":",H="#",Ak="_default",BW="rwTxt",AD="colTxt",BF="rwHdr",Br="colHdr",Bz="allTxt",o="lgd",Bk="lgdBg",By="shp",n="shpBdr",CL="dl",BT="allAxLb",Bm="xAxLb",N="yAxLb",A9="FntFml",V="FntStyle",CD="FntSz",Cq="FntClr",BJ="Rtt",Bi="Shw",Bn="Clr",At="CmbStyle",A8="FillClr",r="FillTrans",Cn="TxtAlignH",Bf="TxtAlignV",As=1,BL=0,Cl=1;var A4=[{n:mstrmojo.desc(11980,"Per cell"),v:B6.EnumTrendRefLevel.DssModelLevelPerCell},{n:mstrmojo.desc(11981,"Per row"),v:B6.EnumTrendRefLevel.DssModelLevelPerRow},{n:mstrmojo.desc(11982,"Per column"),v:B6.EnumTrendRefLevel.DssModelLevelPerColumn},{n:mstrmojo.desc(11983,"Entire table"),v:B6.EnumTrendRefLevel.DssModelLevelPerPanel}];var A3="propEditor-Menu";var A2=false;function Aw(Cy){if(A2&&window.console){window.console.log(Cy);}}function Al(Cy){Aw(Cy);return undefined;}var R={IN_FORMATTING_MODE:"inFmtMode",SELECTED_CATEGORY:"selCat"},D={};function B2(Cy){(Cy||[]).forEach(function(Cz){Cz.onHighlightObjChange(f);});}function AJ(C0,Cz){var Cy=Cz?CC.addClass:CC.removeClass;Cy(C0.domNode,"hilight");}function A6(C2,C1,Cz){var C0=C1,Cy;for(;C0>0;C0--){Cy=Array(C0+1).join("#");C2=C2.replace(Cy,Cz[C0-1]);}return C2;}function w(Cy){return function(){var C0=(Cy&&Cy._hilightObjListens);if(C0){B2(C0);}if(!Cy.host.formattingMode){return ;}if(this.groupTitle){AJ(this.groupTitle,true);}var Cz=((this.groupTitle&&this.groupTitle.scopeSelectors&&this.groupTitle.scopeSelectors[0])||(this.scopeSelectors&&this.scopeSelectors[0]));if(Cz){Cy.sendNonShapeTargetSelectionIdentity(Cz);}};}function A1(Cz,Cy){return Cz.some(function(C0){return Ca.longIntAnd(C0,Cy)===C0;});}function M(Cy){while(Cy&&Cy.parentIdentity){Cy=Cy.parentIdentity;}return Cy;}function Bb(Cz,Cy){var C0=[];(Cz||[]).forEach(function(C1){if(C0.length===0&&Cy){C0.push({n:C1.opt,identity:Cy,v:C1});}else{C0.push({n:C1.opt,v:C1});}});return C0;}function CQ(Cy){return(Cy||[]).map(function(Cz){return A0.copy(Cz,{v:Cz});});}function U(){return Bb(this.getHost().getNumericAxisOptions(true));}function A5(){return Bb(this.getHost().getReferenceAxisOption());}function Cx(){return Bb(this.getHost().getDependentMetricOptions());}function BQ(){return Bb(this.getHost().getIndependentMetricOptions());}function x(C2,C1){var Cz=this.broker,Cy=Cz.editorManager,C0=this.getGroupTitle(C2);A0.copy({onHighlightObjChange:function(C4){var C3=this.highlightObjects;if(!C3){return Al("[GroupTitle] "+C2+": not listen on any Highlight Objects but was registered as listener.");}AJ(this,A1(C3,C4));},highlightObjects:[]},C0);A0.copy(C1,C0);Cy.registerGroupTitle(C0);return C0;}function Az(C0,Cy){var Cz=C0._sync;C0._sync=true;Cy.call(C0);C0._sync=Cz;}function F(C3,Cy,C0,C6,C4){var C1=A0.copy(C4,{postclick:w(C6),updateSelection:function(C8,DA){var C9=this._sync;this._sync=true;var C7=-1,DB=f;this.items.forEach(function(DD,DC){var DE=DD.identity;if(A1([DE],C8)&&A1([DB],DE)){C7=DC;DB=DE;}});this.set("selectedIndex",C7);this._sync=C9;},isHostedWithin:false});var Cz=this.addDisposable(this.getPulldown(C0,C1.fnChange||function(C7){C6.onTargetSelectionChanged(Cy,C7);if(this._sync){return ;}C6.sendNonShapeTargetSelectionIdentity(Cy);},0,C1));C6.registerSelector(Cy,Cz,C1.highlightObjects);if(typeof C3==="string"){var C5=!!this.usingSpecialFormat,C2=this.getLabelAndControl(C3,Cz,C5?"40%":"30%",C5?"60%":"70%");Cz.label=C2.getLabel();return C2;}return Cz;}function AB(Cy,Cz){return{broker:Cy,manager:Cy.editorManager,smartNames:Cz,controlName:Cz[0],reInitDefault:function(){(this.listenFormatProps).forEach(function(C0){this.onFmtPropsChanged(C0,this.broker.getFormatPropertyValue(C0));},this);},reInit:function(){this.reInitDefault();},preBuildRendering:function(){this.reInit();},syncControl:function(C0){var C1=this._sync;this._sync=true;var C2=C0.call(this);this._sync=C1;return C2;},onFmtPropsChangedDefault:Cm,onFmtPropsChanged:function(C0,C2,C1){this.onFmtPropsChangedDefault(C0,C2,C1);},onSelectorsValueChangedDefault:function(){this.reInit();},onSelectorsValueChanged:function(C0,C1){this.onSelectorsValueChangedDefault(C0,C1);},postclick:w(Cy.editorManager),onHighlightObjChange:function(C1){var C0=this.highlightObjects;if(!C0||!C0.length||!this.label){return Al("[Control] "+this.controlName+": was registered as listener but does not listen on any Highlight Objects or has no label attached.");}AJ(this.label,A1(C0,C1));}};}function CT(C3,C1,Cz,Cy){if(!C3){return ;}function C2(DA){return Object.keys(Cc.hash(Cc.ensureArray(DA)));}var C5=C3.listenFormatProps||[],C7=C3.listenSelector||[];(C3.smartNames||[]).forEach(function(DA){Cc.insert(C5,null,DA);Cc.insert(C7,null,C3.broker.getDependingSelectorNames(DA));});C3.listenFormatProps=C2(C5);C3.listenSelector=C2(C7);C3.manager.registerFormatControl(C3);var C9=C3;if(typeof C1==="string"){var C0=(Cz===Cl),C4=C0?"20px":"30%",C6=C0?"100%":"70%";if(Cy){C4=Cy[0];C6=Cy[1];}C9=this.getLabelAndControl(C1,C3,C4,C6,C0);C3.label=C9.getLabel();if(C0){C9.cssClass="checkLabel multiLine";C3.label.onclick=function C8(){if(C3.enabled){C3.onclick();}};C3.label.cssDisplay="inline-block";}else{if(Cz===BL){C9.cssClass="characterGroup";}}}C3.getCtrlContainer=function(){return C9;};return C9;}function AG(Cz,C4){var C0=this.broker,C6=C0.editorManager,C3=Cz.allItem,C2=Cz.metricItems,C5=Cz.colorByItems,Cy=true;if(C2.length<2&&C5.length<1&&(!C0.getLocalState(R.IN_FORMATTING_MODE)||!C0.getVisProfile(Bg))){Cy=false;}var C1=this.addDisposable(new mstrmojo.ui.editors.controls.MenuPulldown(A0.copy(C4,{selectorName:"shapeObjectSelector",visible:Cy,syncControl:function(C7){var C8=this._sync;this._sync=true;var C9=C7.call(this);this._sync=C8;return C9;},value:C5.length?C5[0]:C3,valueWas:null,onvalueChange:function(C7){var C8=C7.value;if(!C8){return ;}this.updateTooltip(this.selectedNode,C8.opt);if(!this._sync&&C8&&!(C8.optLvl===CG.COLOR_BY&&C8.key==="multiple")){C6.sendShapeOption(true);}C6.shapeFormatControls.forEach(function(C9){C9=C9.getCtrl?C9.getCtrl():C9;C9.reInit();});},updateSelection:function(C7){this.syncControl(function(){var C8=this.value;if(!C6.isShapeOptionEqual(this.value,C7)||(C8&&(C8.key==="multiple"||C8.optLvl===E.ITSELF))){this.set("value",A0.copy(C7));if(C0.getLocalState(R.IN_FORMATTING_MODE)){this.set("valueWas",A0.copy(C7));}}});},updateTooltip:function(C9,DB){if(!C9){return ;}var C8={};C8.fontFamily=CC.getStyleValue(C9,"font-family");C8.fontSize=CC.getStyleValue(C9,"font-size");C8.fontStyle=CC.getStyleValue(C9,"font-style");C8.fontWeight=CC.getStyleValue(C9,"font-weight");var DA=Ar.measureTextWidth(DB,C8),C7=parseInt(CC.getStyleValue(C9,"width"));C9.title=DA>C7?DB:"";},onwidthChange:function(){if(this.selectedNode){this.updateTooltip(this.selectedNode,this.selectedNode.innerHTML);}},postBuildRendering:function(){if(this.selectedNode){this.updateTooltip(this.selectedNode,this.selectedNode.innerHTML);}},getDisplayText:function(C7){return(C7&&C7.opt)||"";},setShapeObjectOptions:function(C7){this.shapeObjectOptions=C7;},getMenuConfig:function(){var DA=this,DD=this.shapeObjectOptions||Cz,C9=DD.allItem,C8=DD.metricItems,DC=DD.colorByItems;function C7(DE){var DF=new mstrmojo.ui.menus.MenuConfig({menuCssClass:A3,newInstance:function(DG){return new mstrmojo.ui.menus.Menu(mstrmojo.hash.copy({popupConfig:this,themeClassName:mstrApp.getThemeClassName()},DG));}});(DE||[]).forEach(function(DG){DF.addMenuItem(DA.getDisplayText(DG),"",function(){DA.set("value",DG);});});return DF;}var DB=new mstrmojo.ui.menus.MenuConfig({menuCssClass:A3,hostId:DA.id,hostElement:DA.containerNode,isHostedWithin:false});Ar.absorbMenuItems(DB,C7([C9]));if(C8.length>1){if(DC.length>0){DB.addPopupMenuItem(mstrmojo.desc(962,"Metrics"),"",function(){return C7(C8);});DB.addSeparator();}else{Ar.absorbMenuItems(DB,C7(C8));}}if(DC.length>0){Ar.absorbMenuItems(DB,C7(DC));}return DB;}})));C6.shapeObjSel=C1;C6.sendShapeOption(true);return C1;}function B7(C5,Cy,Cz,C7,C6){var C1=this.broker,C8=C1.editorManager,C3=AB(C1,C7);function C4(DA,C9){return C1.generateSmartName(null,Ad.REF_LINE_DEF,DA,C9);}A0.copy({controlName:Cz,items:[],metricOpt:Cy,_toggleRefLineEnabled:function(DA,C9){var DB=C4(Ad.REF_ENABLED,DA.v);C1.setFormatPropertyValue(DB,C9);},reInitDefault:function(){this.syncControl(function(){this.set("items",this.broker.getOptionItems(this.controlName,this.metricOpt));if(this.items.length>0){this.selectItemByField("key",this.items[0].key);}});},generateNewRefLineItem:function C0(C9,DC){var DA=C1.vis.getRealReferenceOptionFromAxisOption(this.metricOpt,C9),DB=A0.copy(DA,{v:DA});if(DB.refType===B6.EnumRefLineModelType.CONST){DB.c=C.parseNumeric(DC);}return DB;},onselectRefLine:function(C9){this.manager.onTargetSelectionChanged(Cz,C9);},onremoveRefLine:function(C9){if(this._sync){return ;}this._toggleRefLineEnabled(C9,false);},onrenameRefLine:function(DA){if(this._sync){return ;}var C9=DA.key;if(DA.refType===B6.EnumRefLineModelType.CONST){var DB=C4(Ad.REF_LINE_NAME,DA.v);C1.setFormatPropertyValue(DB,DA[Ad.REF_LINE_NAME]);}this.selectItemByField("key",C9);},onaddRefLine:function(DA){if(this._sync){return ;}var C9=DA.key;if(DA.refType===B6.EnumRefLineModelType.CONST){var DB=C4(Ad.REF_CONST_VALUE,DA.v);C1.setFormatPropertyValue(DB,DA.c);}else{this._toggleRefLineEnabled(DA,true);}this.selectItemByField("key",C9);},onFmtPropsChangedDefault:function(){this.syncControl(function(){var DA=this.getSelectedItem(),C9=DA&&DA.key;this.reInit();this.selectItemByField("key",C9);});},onSelectorsValueChangedDefault:function(C9,DA){if(DA!==this.metricOpt){this.metricOpt=DA;this.reInit();}}},C3);A0.copy(C6,C3);var C2=this.addDisposable(new mstrmojo.ui.editors.controls.GMReferenceLineList(C3));C8.registerSelector(Cz,C2,C3.highlightObjects);return CT.call(this,C2,C5);}function Ay(C1,C0,Cz,C5){var Cy=this.broker,C4=[Cz],C2=AB(Cy,C4);A0.copy({showIcon:false,items:C0,onFmtPropsChangedDefault:function(C6,C7){this.syncControl(function(){if(this.multiSelect){this.select((this.items||[]).map(function(C9,C8){return(C7&C9.v)>0?C8:null;}).filter(function(C8){return C8!==null;}));}else{if(typeof C7==="undefined"){this.clearSelect();}else{this.singleSelectByField(C7,"v");}}});},postselectionChange:function(C6){if(this._sync){return ;}var C7=C6.added&&this.items[C6.added[0]].v;if(this.multiSelect){if(!C0||!C0.length){return Al("[GMEditorModel getBitwiseValFromMultiSelection] no items in caller");}C7=C0.reduce(function(DA,C9,C8){return this.selectedIndices[C8]?DA|=C9.v:DA;}.bind(this),0);}this.broker.setFormatPropertyValue(this.smartNames[0],C7);}},C2);A0.copy(C5,C2);var C3=this.addDisposable(new mstrmojo.ui.ButtonBar(C2));return CT.call(this,C3,C1);}function Cj(C2,C0){var C1="00000000000000000000000000000000",Cz=C2.dropZones,Cy=Cc.find(Cz,"id",C0);return Cy===-1?[]:Cc.filter(Cz[Cy].items,function(C3){return C3.t===4&&C3.id!==C1;});}function BZ(C6,C4,Cy,C7,C3){C7=C7||{};var C1=this.broker,C8=[Cy],C5=AB(C1,C8),C0=C7.associatedPropValueTuples,Cz=C7.fnChange||function(C9){if(this._sync){return ;}this.broker.setFormatPropertyValue(this.smartNames[0],C9,undefined,undefined,C0);};A0.copy({onFmtPropsChangedDefault:function(C9,DA){if(this.preFmtPropsChangedHook){DA=this.preFmtPropsChangedHook(C9,DA);}this.syncControl(function(){if(DA==="undefined"){this.set("selectedIndex",-1);}else{this.selectItemByField("v",DA);}});}},C5);A0.copy(C7,C5);var C2=this.addDisposable(this.getPulldown(C4,Cz,0,C5));return CT.call(this,C2,C6,null,C3||["40%","60%"]);}function Af(C5,Cy,C6,C0,Cz,C7){var C1=this.broker,C8=[Cz],C4=AB(C1,C8);var C3=function(){var C9;for(C9=Cy;C9<=C6;C9+=C0){if((C9+C0)>=C6){C9=C6;}this.items.push({n:C9.toFixed(2),v:C9});}};A0.copy({items:[],postCreate:C3,onselectionChange:C5,onFmtPropsChangedDefault:function(C9,DA){this.syncControl(function(){this.set("selectedIndex",DA);});}},C4);A0.copy(C7,C4);var C2=this.addDisposable(new mstrmojo.vi.ui.rw.selectors.Slider(C4));CC.addWidgetCssClass(C2,"rank");CC.addWidgetCssClass(C2,"jitter");C2.set("multiSelect",false);return CT.call(this,C2);}function AW(C5,C3,Cy,Cz,C4){var C0=this.broker,C6=[Cy],C2=AB(C0,C6);A0.copy({onClick:C3,onFmtPropsChangedDefault:function(C7,C8){this.syncControl(function(){this.set("value",C8);});}},C2);A0.copy(C4,C2);var C1=this.addDisposable(new mstrmojo.Button(mstrmojo.Button.newWebButton(C5,C3,Cz,C2)));return CT.call(this,C1);}function e(C0,Cz,C4){var Cy=this.broker,C3=[Cz],C1=AB(Cy,C3);A0.copy({dtp:t.FLOAT,required:true,onValid:function(){if(this._sync){return ;}this.broker.setFormatPropertyValue(this.smartNames[0],C.parseNumeric(this.value));},onFmtPropsChangedDefault:function(C5,C6){this.syncControl(function(){this.set("value",C6);this.validate();});}},C1);A0.copy(C4,A0.copy(X(Cy,Cz),C1));var C2=this.addDisposable(new mstrmojo.ui.editors.controls.ValidationTextBox(C1));return CT.call(this,C2,C0);}function AS(C1,C0,C5,Cy){var Cz=this.broker,C4=[C0],C2=AB(Cz,C4);A0.copy({provider:new mstrmojo.NumStepperContentProvider(A0.copy(Cy,{item:{interval:1},curVal:0,min:0,getInvalidMsg:function(){return mstrmojo.desc(14312,"This field accepts only integers greater than or equal to zero");},onTraverse:function(){var C6=this.parent,C7=this;if(C6._sync){return ;}if(this._lastTimeoutId){window.clearTimeout(this._lastTimeoutId);}this._lastTimeoutId=window.setTimeout(function(){delete C7._lastTimeoutId;C6.broker.setFormatPropertyValue(C6.smartNames[0],C7.curVal);},1000);},oncurValChange:function(){var C6=this.parent;if(C6.textNode){C6.updateDisplayText();}}})),preBuildRendering:function(){this.reInit();mstrmojo.ui.editors.controls.Stepper.prototype.preBuildRendering.call(this);},onFmtPropsChangedDefault:function(C6,C7){this.syncControl(function(){if(typeof C7==="undefined"){C7="";}this.provider.set("curVal",C7);});}},C2);A0.copy(C5,C2);var C3=this.addDisposable(new mstrmojo.ui.editors.controls.Stepper(C2));C3.provider.parent=C3;return CT.call(this,C3,C1,null,["40%","60%"]);}function Bw(Cz,Cy,C3){var C4=Cz.getFormatPropertyKey(Cy),C1=function(){var C6=Cz._resolveLevelOptionWithRuntime(C4),C5=[];if(C6.key==="AllMetrics"){C5.push(C6.mos[0].mId);}else{C6.mos.forEach(function(C7){C5.push(C7.mId);});}return C5;};var C0,C2=C1();C0=Cz.vis.formatAsAxisLabel(C2,C3);if(C0!==undefined){return C0;}return this.constructor.prototype.getConvertValue(C3);}function Bx(C4,C3,C0){var Cz=String(C4),Cy=String(C3),C9=mstrmojo.locales.number.DECIMALSEPARATOR,C8=Cz.split(C9)[1],C6=Cy.split(C9)[1],C2=C8?C8.length:0,C1=C6?C6.length:0,C7=Number(Cz.replace(C9,"")),C5=Number(Cy.replace(C9,""));if(C0){return C7*C5/Math.pow(10,C2+C1);}else{return Bx(C7/C5,Math.pow(10,C1-C2),true);}}function BY(C5,C3,Cz,Cy,C6){var C2=[mstrmojo.desc(11976,"Global"),mstrmojo.desc(11985,"Per row/column"),mstrmojo.desc(11980,"Per cell"),mstrmojo.desc(13871,"Custom..."),mstrmojo.desc(13661,"Different")];var C0=this.broker,C7=[C3],C4=AB(C0,C7);A0.copy({getMenuConfig:function(){var C8=this,C9=A0.valarray(B6.EnumAxisScale).slice(0,3),DA=new mstrmojo.ui.menus.MenuConfig({menuCssClass:A3,hostId:C8.id,hostElement:C8.containerNode,isHostedWithin:false});C9.forEach(function(DB){DA.addMenuItem(C8.getDisplayText(DB),"",function(){C8.set("value",DB);});});DA.addPopupMenuItem(C8.getDisplayText(B6.EnumAxisScale.CUSTOM),"",function(){var DB=Cz,DE=Cy,DC={},DH={},DD=C0.getVisProfile(Cd),DF=DD?100:1;A0.keyarray(DB).forEach(function(DI){DC[DI]=Bx(C0.getFormatPropertyValue(DB[DI]),DF,true);});A0.keyarray(DE).forEach(function(DI){DH[DI]=C0.getFormatPropertyValue(DE[DI]);});var DG=DD?{min:-100,max:100}:{min:DC.min,max:DC.max};return new mstrmojo.ui.menus.EditorConfig({cssClass:A3+" "+mstrApp.getThemeClassName(),data:{newRangeValid:true,rangeKeysChanged:[],autoKeysChanged:[],scaleTypeWillChange:C8.value!==B6.EnumAxisScale.CUSTOM},contents:[{scriptClass:"mstrmojo.ui.editors.controls.CustomRange",alias:"rangeCtrl",range:DC,auto:DH,labelOfCustomRange:mstrmojo.desc(13662,"Axis Range"),rangeConstraints:{min:{min:null,max:DC.max},max:{min:DC.min,max:null}},oninputValidChange:function(DI){this.parent.data.set("newRangeValid",DI.value);},autoChanged:function(){var DJ=this.getAuto(),DI=Cc.filter(A0.keyarray(DH),function(DK){return String(DH[DK])!==String(DJ[DK]);});if(this.parent){this.parent.data.set("autoKeysChanged",DI);}},rangeChanged:function(){var DI=this.getRange(),DJ=Cc.filter(A0.keyarray(DC),function(DK){return String(DC[DK])!==String(DI[DK]);});this.parent.data.set("rangeKeysChanged",DJ);},getConvertValue:function(DI){return Bw.call(this,C0,DB.min,Bx(DI,DF,false));}}],bindings:{okEnabled:function(){return(this.data.newRangeValid&&(this.data.rangeKeysChanged.length>0||this.data.scaleTypeWillChange))||this.data.autoKeysChanged.length>0;}},onOpen:function(){this.rangeCtrl.updateDisplay();},fnOk:function(DM,DK){var DJ=DK.rangeCtrl.getRange(),DL=this.data.rangeKeysChanged,DN=DK.rangeCtrl.getAuto(),DI=this.data.autoKeysChanged;DL.forEach(function(DQ,DP,DO){C0.setFormatPropertyValue(DB[DQ],Bx(DJ[DQ],DF,false),null,DM.scaleTypeWillChange||DP!==DO.length-1);});DI.forEach(function(DQ,DP,DO){C0.setFormatPropertyValue(DE[DQ],DN[DQ],null,DM.scaleTypeWillChange||DP!==DO.length-1);});C8.set("value",B6.EnumAxisScale.CUSTOM);}});});return DA;},getDisplayText:function(C8){return(!isNaN(C8)&&C2[C8])||"";},onvalueChange:function(C8){if(this._sync){return ;}this.broker.setFormatPropertyValue(this.smartNames[0],C8.value);},onFmtPropsChangedDefault:function(C8,C9){this.syncControl(function(){this.set("value",C9);});}},C4);A0.copy(C6,C4);var C1=this.addDisposable(new mstrmojo.ui.editors.controls.MenuPulldown(C4));return CT.call(this,C1,C5,null,["40%","60%"]);}function B3(Cz,C5){var C2=this,Cy=this.broker,C4=[Cz],C1=AB(Cy,C4),C0=BQ.call(this);A0.copy({value:C0[0],getDisplayText:function(C6){return(C6&&C6.n)||"";},getMenuConfig:function(){var C6=this,C7=new mstrmojo.ui.menus.MenuConfig({menuCssClass:A3,hostId:C6.id,hostElement:C6.containerNode,isHostedWithin:false});C0.forEach(function(C8){C7.addPopupMenuItem(C6.getDisplayText(C8),"",function(){var DE=C8.v;function DG(DH){return Cy.generateSmartName(null,Ad.TREND_BUBBLE_FORE_DEF,DH,DE);}var C9=DG(Ad.TREND_BUBBLE_FORE_ENABLED),DC=Cy.getFormatPropertyValue(C9),DB={min:DG(Ad.TREND_BUBBLE_MIN),max:DG(Ad.TREND_BUBBLE_MAX),customMin:DG(Ad.TREND_BUBBLE_FORE_BWD),customMax:DG(Ad.TREND_BUBBLE_FORE_FWD)},DD={};A0.keyarray(DB).forEach(function(DH){DD[DH]=Cy.getFormatPropertyValue(DB[DH]);});var DA=C2.addDisposable(new mstrmojo.ui.editors.controls.CustomRange({alias:"rangeCtrl",range:DD,enabled:DC,labelOfCustomRange:mstrmojo.desc(13734,"Forecast"),rangeConstraints:{min:{min:null,max:DD.min},max:{min:DD.max,max:null}},oninputValidChange:function(DH){this.parent.data.set("newRangeValid",DH.value);},rangeChanged:function(){var DH=this.getRange(),DI=Cc.filter(A0.keyarray(DD),function(DJ){return String(DD[DJ])!==String(DH[DJ]);});this.parent.data.set("rangeKeysChanged",DI);},getConvertValue:function(DH){return Bw.call(this,Cy,DB.min,DH);},getTextBoxCfg:function(DH,DI){DI=[];A0.copy({getInvalidMsg:function(DJ){if(DJ.code===mstrmojo.validation.STATUSCODE.INVALID_OUTOFRANGE){if(!this.constraints.min){return mstrmojo.desc(14325,"Forecasting requires the horizontal axis to be extrapolated to smaller than its current min value of #").replace("#",this.parent.getConvertValue(DD.min));}if(!this.constraints.max){return mstrmojo.desc(14326,"Forecasting requires the horizontal axis to be extrapolated to greater than its current max value of #").replace("#",this.parent.getConvertValue(DD.max));}}return this.constructor.prototype.getInvalidMsg(DJ);}},DI);return this.constructor.prototype.getTextBoxCfg(DH,DI);}})),DF=C2.getCheckboxAndLabel(DC,mstrmojo.desc(12026,"Enable Forecasting"),function(){this.parent.parent.data.set("rangeEnabled",this.checked);DA.set("enabled",this.checked);});return new mstrmojo.ui.menus.EditorConfig({cssClass:A3+" "+mstrApp.getThemeClassName(),data:{newRangeValid:true,rangeKeysChanged:[],rangeEnabled:DC},contents:[DF,{scriptClass:"mstrmojo.Label",text:mstrmojo.desc(12027,"Extrapolate values by adjusting the horizontal axis"),cssClass:"textLabel"},DA],bindings:{okEnabled:function(){var DH=this.data.rangeEnabled!==DC;return(this.data.rangeEnabled&&this.data.newRangeValid&&(this.data.rangeKeysChanged.length>0||DH))||(!this.data.rangeEnabled&&DH);}},fnOk:function(DL){var DI=DL.rangeEnabled,DJ=DI!==DC;if(DI){var DH=DA.getRange(),DK=this.data.rangeKeysChanged;DK.forEach(function(DO,DN,DM){Cy.setFormatPropertyValue(DB[DO],DH[DO],null,DJ||DN!==DM.length-1);});}if(DJ){Cy.setFormatPropertyValue(C9,DI);}C6.set("value",C8);}});});});return C7;}},C1);A0.copy(C5,C1);var C3=this.addDisposable(new mstrmojo.ui.editors.controls.MenuPulldown(C1));return CT.call(this,C3);}function CF(C0,Cz,C3){var Cy=this.broker,C2=[Cz],C1=AB(Cy,C2);A0.copy({oncheckedChange:function(){if(this._sync||!this.enabled){return ;}this.broker.setFormatPropertyValue(this.smartNames[0],this.checked);},onFmtPropsChangedDefault:function(C4,C5){this.syncControl(function(){if(C5==="false"){C5=false;}this.set("checked",!!C5);});}},C1);A0.copy(C3,C1);return CT.call(this,this.addDisposable(new mstrmojo.ui.Checkbox(C1)),C0,Cl);}function AY(C0,Cz,C5){var Cy=this.broker,C4=[Cz],C2=Cc.find(C0,"isAll",true),C1=AB(Cy,C4);A0.copy({items:C0,allIdx:C2,reInitDefault:function(){var C6=this.smartNames[0],C7={};(this.listenFormatProps).forEach(function(C8){if(C8===C6){return ;}this.onFmtPropsChanged(C8,this.broker.getFormatPropertyValue(C8));},this);(this.items||[]).forEach(function(C9,C8){if(this.broker.getFormatPropertyValue(Cz,C9.opt)){C7[C8]=true;}},this);this.syncControl(function(){this.set("selectedIndices",C7,true);});},postselectionChange:function(C7){if(this._sync){return ;}var C9=!!C7.added,C6=C9?C7.added[0]:C7.removed[0],C8=this.items[C6].opt;this.broker.setFormatPropertyValue(this.smartNames[0],C9,C8);},onFmtPropsChangedDefault:function(C6,C8,C7){this.syncControl(function(){var DB=Cc.filterOne(this.items,function(DC){return DC.opt.key===C7.key;}),C9=DB&&this.items.indexOf(DB);if(!!C8){if(this.allIdx>-1&&C9>-1){var DA=A0.copy(this.selectedIndices);DA[C9]=true;if(A0.keyarray(DA).length===this.items.length-1){C9=this.allIdx;}}this.addSelect(C9);}else{this.removeSelect(C9);}});}},C1);A0.copy(C5,C1);var C3=this.addDisposable(new mstrmojo.ui.CheckListIcon(C1));return CT.call(this,C3,null);}mstrmojo.ui.CheckListIcon=mstrmojo.declare(mstrmojo.ui.CheckList,null,{scriptClass:"mstrmojo.ui.CheckListIcon",init:function Cs(Cy){this._super(Cy);mstrmojo.css.addWidgetCssClass(this,"gm-CheckList");},getItemMarkup:function Ag(C0,Cy){var Cz='<table><tr><td><span class="icon"></span></td><td><span>{@en@n}</span></td></tr></table>';return this._super(C0).replace('<span class="text">{@en@n}</span>',Cz);}});function Cb(Cz,C0){AU.override({showPickerForCurrentMode:function Cy(){this._super();if(this.pickerMode===2&&typeof this.color!=="object"){var C1=this.gradientOrientation,C2=C0.getChartInfo().dirc===B6.EnumABLDirection.VERTICAL;C1.set("selectedIndex",Cc.find(C1.items,"id",C2?0:1));}}},Cz.colorPicker);}function X(C0,Cz){function Cy(C2){var C3=C2.value;return(C3===undefined||C3==="")&&C0.getFormatPropertyValue(Cz)===undefined;}return{onInvalid:function C1(){if(Cy(this)){if(this.hasRendered){this.clearValidation();}return ;}if(this.hasRendered){mstrmojo.ui.editors.controls.ValidationTextBox.prototype.onInvalid.call(this);}},onRender:function(){if(Cy(this)){this.clearValidation();}}};}function g(C0,Cz,C4){var Cy=this.broker,C3=[Cz],C1=AB(Cy,C3);A0.copy({showGradient:false,postselectedValueChange:function(C5){if(this._sync){return ;}var C6=C5.value;if(C6===W.VAL_AUTOMATIC){C6=AZ;}this.broker.setFormatPropertyValue(this.smartNames[0],C6);},onFmtPropsChangedDefault:function(C5,C6){this.syncControl(function(){if(typeof C6==="undefined"){C6="conflict";}if(this.colorDefaultSN&&this.broker.getFormatPropertyValue(this.colorDefaultSN)){this.set("autoPreviewColor",C6);C6=W.VAL_AUTOMATIC;}this.set("selectedValue",C6);});}},C1);A0.copy(C4,C1);var C2=this.addDisposable(new mstrmojo.ui.editors.controls.ColorPickerButton(C1));return CT.call(this,C2,C0);}function Bv(C1,Cz){var Cy={},C4=C1.getFormatPropertyValue(Cz.fontStyle),C2=C1.getFormatPropertyValue(Cz.fontColor),C0=C1.getFormatPropertyValue(Cz.fontFamily),C3=C1.getFormatPropertyValue(Cz.fontSize);if(C4!==undefined){Cy[BA.FONT_WEIGHT]=(!isNaN(C4)&&((C4&AF.FS_BOLD)>0));Cy[BA.FONT_STYLE]=(!isNaN(C4)&&((C4&AF.FS_ITALIC)>0));Cy[BA.UNDERLINE]=(!isNaN(C4)&&((C4&AF.FS_UNDERLINE)>0));Cy[BA.LINE_THROUGH]=(!isNaN(C4)&&((C4&AF.FS_STRIKETHROUGH)>0));}Cy[BA.COLOR]=C2!==undefined?C2:-1;Cy[BA.FONT_SIZE]=C3!==undefined?C3:-1;Cy[BA.FONT_FAMILY]=C0!==undefined?C0:-1;return Cy;}function BI(C6,C1,C7){var Cy=this.broker,C8=A0.valarray(C1),C4=AB(Cy,C8),C3={},C2={};C2[BA.FONT_SIZE]=C1.fontSize;C2[BA.COLOR]=C1.fontColor;C2[BA.FONT_FAMILY]=C1.fontFamily;C2[BA.FONT_WEIGHT]=C2[BA.FONT_STYLE]=C2[BA.UNDERLINE]=C2[BA.LINE_THROUGH]=C1.fontStyle;C3[BA.FONT_WEIGHT]=AF.FS_BOLD;C3[BA.FONT_STYLE]=AF.FS_ITALIC;C3[BA.UNDERLINE]=AF.FS_UNDERLINE;C3[BA.LINE_THROUGH]=AF.FS_STRIKETHROUGH;A0.copy({smartNamesMap:C1,syncWithAllText:false,onGroupValueChange:function(DC,DB){var DE=C2[DC];if(DE===C1.fontStyle){var DA=Cy.getFormatPropertyValue(DE),DD=C3[DC],C9=DB;DB=C9?(DA|DD):(DA&(~DD));}else{if(DE===C1.fontSize){if(this.visibleControls&c.FONT_SIZE_USE_STEPPER){DB=DB[0];}DB=parseInt(DB,10)+"pt";}}this.broker.setFormatPropertyValue(DE,DB);},onFmtPropsChangedDefault:function(C9){this.syncControl(function(){var DA=this.smartNamesMap,DB=Cc.filterOne(A0.keyarray(DA),function(DC){return DA[DC]===C9;});if(DB||this.syncWithAllText){if(!DB&&C9.indexOf(Bz)===-1){Aw("[CharacterGroup] Unnecessary refresh which might be due to incorrect listenFormatProps.");}this.refreshValues();}});},refreshValues:function(){this.syncControl(function(){var C9=Bv(this.broker,this.smartNamesMap);if(this.visibleControls&c.FONT_SIZE_USE_STEPPER){C9[BA.FONT_SIZE]=[parseInt(C9[BA.FONT_SIZE],10)];}this.setFormatSource(C9);});}},C4);A0.copy(C7,C4);if(C4.syncWithAllText){var C0=A0.valarray(Cy.getSmartNamesMapForFontGroup(Bz));C4.listenFormatProps=(C4.listenFormatProps||[]).concat(C0);}var C5=this.getHost()&&this.getHost().node&&this.getHost().node.data&&this.getHost().node.data.visName;var Cz=mstrApp.supportFeature("ngm")&&C5===mstrmojo.vi.viz.EnumVizStyles.NEW_GRAPH_MATRIX?this.addDisposable(new mstrmojo.ngm.NGMCharacterGroup(C4)):this.addDisposable(new mstrmojo.ui.editors.controls.CharacterGroup(C4));return CT.call(this,Cz,C6,BL);}function CO(Cz,C0,C5){var Cy=this.broker,C4=A0.valarray(C0),C1=AB(Cy,C4);A0.copy({smartNamesMap:C0,onGroupValueChange:function(C6,C7){if(this._sync){return ;}this.broker.setFormatPropertyValue(C6,C7);},onFmtPropsChangedDefault:function(C6,C7){this.syncControl(function(){this.setChildValue(C6,C7);});}},C1);A0.copy(C5,C1);var C3=this.addDisposable(new mstrmojo.ui.editors.controls.LineConfigGroup(C1));C3.iniChildrenComp(C4);var C2=C3.getChildComp(Bn);if(C2){Cb(C2,this.getHost());}return CT.call(this,C3,Cz);}function Cv(Cz,C0,C5){var Cy=this.broker,C4=A0.valarray(C0),C1=AB(Cy,C4);A0.copy({smartNamesMap:C0,onGroupValueChange:function(C6,C7){if(!this._sync){Cy.setFormatPropertyValue(C6,C7);}},onFmtPropsChangedDefault:function(C6,C7){this.syncControl(function(){var C8=this;if(Cc.filterOne(this.propNames,function(C9){return(C9===C6);})){C8.setChildValue(C6,C7);}else{this.propNames.forEach(function(C9){C8.setChildValue(C9,C8.broker.getFormatPropertyValue(C9));});}});}},C1);A0.copy(C5,C1);var C3=this.addDisposable(new mstrmojo.ui.editors.controls.FillConfigGroup(C1));C3.iniChildrenComp(C4);var C2=C3.getChildComp(Bn);if(C2){Cb(C2,this.getHost());}return CT.call(this,C3,Cz);}mstrmojo.vi.models.editors.GMEditorManager=mstrmojo.declare(mstrmojo.Obj,null,{scriptClass:"mstrmojo.vi.models.editors.GMEditorManager",host:null,initializing:false,targetSelectors:null,shapeObjSel:null,shapeFormatControls:null,_fmtPropBindings:null,_fmtSelBindings:null,_hilightObjListens:null,_IdentityTypeMapping:null,_nonShapeSelectionToIdentityMapping:null,init:function Cs(Cy){this._super(A0.copy(Cy,{targetSelectors:{},_fmtPropBindings:{},_fmtSelBindings:{},_hilightObjListens:[],_IdentityTypeMapping:{},_nonShapeSelectionToIdentityMapping:{},shapeFormatControls:[]}));},clearControlsReference:function(){this.targetSelectors={};this._fmtPropBindings={};this._fmtSelBindings={};this._hilightObjListens=[this.model];this.shapeFormatControls.length=0;var Cy=this._IdentityTypeMapping;Cc.forEach(Object.keys(Cy),function(Cz){Cy[Cz][Ab].length=0;});},_addListener:function(C1,Cy,C0){var Cz=C1[Cy]||[];Cz.push(C0);C1[Cy]=Cz;},initIdentityPanelMapping:function(){var C0=z,Cy=this._IdentityTypeMapping;A0.forEach(BP,function(C1){var C2=Cy[C1]={};C2[z]=[];C2[Ab]=[];});var Cz=this._nonShapeSelectionToIdentityMapping;Cz[BP.X_NUMERIC]=BP.X_CATEGORY;Cz[BP.Y_NUMERIC]=BP.Y_CATEGORY;Cy[BP.AXIS_SCALE][C0]=Cy[BP.LOG_SCALE][C0]=Cy[BP.AXIS_ORIGIN_DEFINE][C0]=Y;Cy[BP.TREND_LINE][C0]=CR;Cy[BP.REF_LINE][C0]=Bt;Cy[BP.VIZ_BOX_TITLE][C0]=Cy[BP.VIZ_BOX_CONTAINER][C0]=BB;Cy[BP.LEGEND][C0]=Cy[BP.LEGEND_TEXT][C0]=Cy[BP.COLOR_SQUARE][C0]=O;Cy[BP.X_AXIS][C0]=Cy[BP.Y_AXIS][C0]=Cy[BP.X2_AXIS][C0]=Cy[BP.Y2_AXIS][C0]=Cy[BP.X_NUMERIC][C0]=Cy[BP.X_CATEGORY][C0]=Cy[BP.Y_NUMERIC][C0]=Cy[BP.Y_CATEGORY][C0]=Cy[BP.GRID_LINE][C0]=Cy[BP.MINOR_GRID_LINE][C0]=Cy[BP.X_METRIC_AXIS_TITLE][C0]=Cy[BP.Y_METRIC_AXIS_TITLE][C0]=Cy[BP.AXIS_ORIGIN][C0]=Bu;Cy[BP.ROW_TITLE][C0]=Cy[BP.COL_TITLE][C0]=Cy[BP.ROW_HEADER][C0]=Cy[BP.COL_HEADER][C0]=Cy[BP.ROWS_BACKGROUND][C0]=Cy[BP.COLS_BACKGROUND][C0]=Cy[BP.H_MATRIX_LINE][C0]=Cy[BP.V_MATRIX_LINE][C0]=AX;Cy[BP.GRAPH_SHAPE][C0]=Cy[BP.SHAPE_COLLECTION][C0]=Cy[BP.DATA_LABEL][C0]=CS;},switchPanelByValue:function(Cy){if(this.initializing){return ;}this.model.selectTargetByValue(Cy);},notifyPropChangeToListeners:function(Cy,C0,Cz){if(this.initializing){return ;}(this._fmtPropBindings[Cy]||[]).forEach(function(C1){if(C1.onFmtPropsChanged){C1.onFmtPropsChanged(Cy,C0,Cz);}});},notifyNonShapeSelectionChangeToListeners:function(C5){if(this.initializing){return ;}var C1=C5.identities.length===0,Cy=f,C4=f,C0=[],C3=this;if(!C1){C5.identities.forEach(function(C8){var C9=M(C8);if(!(C9&&C9.objType!==undefined)){return ;}var C7=(C3._nonShapeSelectionToIdentityMapping[C9.objType]||C9.objType);Cy=Ca.longIntOr(Cy,C7);C0.push(C7);});C4=M(C5.identities[0]).objType;C4=(C3._nonShapeSelectionToIdentityMapping[C4]||C4);if(!C3._IdentityTypeMapping[C4]){return ;}var C6=C3._IdentityTypeMapping,Cz=C6[C4][z];this.switchPanelByValue(Cz);var C2=[];C0.forEach(function(C7){C2=C2.concat(Cc.difference(C6[C7][Ab]||[],C2));});C2.forEach(function(C7){if(C7.updateSelection){C7.updateSelection(Cy,C5.identities);}});}this._hilightObjListens.forEach(function(C7){C7.onHighlightObjChange(Cy);});},_notifyShapeSelectionChangeToListeners:function(Cy){if(this.initializing){return ;}var C2=this.host,C5=Am.call(this.model),C1=Cy.arrayOfComb||Cy.arrayOfColorByComb,C4={opt:"Multiple Elements",key:"multiple",optLvl:CG.COLOR_BY,comb:[]};var C3=Cy.selectionlevel,C0=C3===CG.COLOR_BY,Cz;if(C1&&C1.length>1&&C0){Cz=C4;}else{if(C1&&(C0||C3===CG.METRIC)){Cz=A0.copy(Cc.filterOne(C0?C5.colorByItems:C5.metricItems,function(C6){return Ca.isEqualComb(C6.comb,C1[0]);}));}else{Cz=A0.copy(Cc.filterOne(C5.originCollection,function(C6){return C3===C6.optLvl;}));}}if(!this.host.noSwitch){this.switchPanelByValue(CS);delete this.host.noSwitch;}if(this.shapeObjSel){this.shapeObjSel.updateSelection(Cz);}},_notifyFormatModeChangeToListeners:function(Cy){if(this.initializing){return ;}if(this.shapeObjSel){this.shapeObjSel.onFormattingModeChange(Cy);}},_notifyOnContextMenuSelectionListeners:function(Cy){this.switchPanelByValue(this._IdentityTypeMapping[Cy.identityType][z]);var Cz=this._IdentityTypeMapping[Cy.identityType][Ab]||[];Cz.forEach(function(C0){if(C0.updateSelection){C0.updateSelection(Cy.identityType,[{key:Cy.metricId,tlOpt:{key:Cy.metricId}}]);}});this._hilightObjListens.forEach(function(C0){C0.onHighlightObjChange(Cy.identityType);});},refreshShapeFormattingTargets:function(){if(this.shapeObjSel){var Cy=Am.call(this.model);this.shapeObjSel.setShapeObjectOptions(Cy);this.shapeObjSel.set("value",Cy.allItem);}},getTargetSelector:function(Cy){if(!this.targetSelectors[Cy]){Aw("Selector with name "+Cy+" does not found.");}return this.targetSelectors[Cy];},getSelectedValue:function(Cz,C1,Cy){var C0=this.getTargetSelector(Cz);C1=C1||"v";return C0&&C0.getSelectedItem(Cy)&&C0.getSelectedItem(Cy)[C1];},onTargetSelectionChanged:function(Cy,C0){var Cz=Cy&&this._fmtSelBindings[Cy];(Cz||[]).forEach(function(C1){if(!C1.onSelectorsValueChanged){return Al("[Manager] onSelectorsValueChanged not defined for control: "+C1.controlName);}C1.onSelectorsValueChanged(Cy,C0);},this);},sendNonShapeTargetSelectionIdentity:function(Cz){var Cy=this.targetSelectors[Cz];if(!this.host.formattingMode||!Cy||Cy.selectedIndex===undefined||Cy.selectedIndex===null){return ;}var C0=Cy.items[Cy.selectedIndex].identity,C1=[];if(!C0||C0===Bo){return ;}A0.forEach(BP,function(C3){if((C0&C3)>0){C1.push(C3);}});var C2={name:"highLightObjectChange",identities:C1};this.host.raiseEvent(C2);return C2;},isShapeOptionEqual:function(Cz,Cy){if(!Cz&&!Cy){return true;}if(!Cz||!Cy){return false;}if(Cz.optLvl!==Cy.optLvl){return false;}if(Cz.opt!==Cy.opt){return false;}return(Cz.comb===Cy.comb)||(Cz.comb&&Cy.comb&&Ca.isEqualComb(Cz.comb,Cy.comb));},sendShapeOption:function(Cz){var Cy=this.shapeObjSel,C0=Cy.value;if((!Cz&&!this.host.formattingMode)||this.isShapeOptionEqual(C0,Cy.valueWas)){return ;}Cy.set("valueWas",A0.copy(C0));this.host.onFormatableTargetChanged(C0);},registerFormatControl:function(Cz){var Cy=Cz.listenFormatProps;(Cy||[]).forEach(function(C0){this._addListener(this._fmtPropBindings,C0,Cz);},this);Cy=Cz.listenSelector;(Cy||[]).forEach(function(C0){this._addListener(this._fmtSelBindings,C0,Cz);},this);if(Cz.highlightObjects&&Cz.highlightObjects.length){this._hilightObjListens.push(Cz);}},registerSelector:function(Cy,C2,C1){var C0=Ab,Cz=this._IdentityTypeMapping;this.targetSelectors[Cy]=C2;(C1||[]).forEach(function(C3){if(!Cz[C3]){var C4=Cz[C3]={};C4[z]=[];C4[Ab]=[];}Cz[C3][C0].push(C2);});C2.set("selectedIndex",0);},registerGroupTitle:function(Cy){if(Cy.highlightObjects){this._hilightObjListens.push(Cy);}}});mstrmojo.vi.models.editors.GMBroker=mstrmojo.declare(mstrmojo.Obj,null,{scriptClass:"mstrmojo.vi.models.editors.GMBroker",vis:null,editorManager:null,_smartNameToPropertyKeyLookup:null,_dynamicPrefixToSmartNamesLookup:null,_subscriptions:null,_titleSubs:null,init:function Cs(Cy){this._super(A0.copy(Cy,{_smartNameToPropertyKeyLookup:{},_dynamicPrefixToSmartNamesLookup:[],_subscriptions:[]}));},getLocalState:function AC(C0){var Cz=D[this.vis.node.k],Cy=Cz&&Cz[C0];if(Cy===undefined){switch(C0){case R.IN_FORMATTING_MODE:Cy=this.vis.formattingMode;break;case R.SELECTED_CATEGORY:Cy=Y;break;}}return Cy;},updateLocalState:function Ci(C0,Cz){var Cy=D[this.vis.node.k]||{};Cy[C0]=Cz;D[this.vis.node.k]=Cy;},attachEditorRuntime:function Bj(Cy){if(!Cy){return Al("[Broker] Could not attach undefined editor manager! Broker not connected to panel runtime.");}var Cz=this.vis;this.editorManager=Cy;this._subscriptions=[Cz.attachEventListener("formattingObjectChanged",this.id,function(C0){if(C0.selectionlevel!==CG.COLOR_BY||(C0.arrayOfComb&&C0.arrayOfComb.length>0)){Cy._notifyShapeSelectionChangeToListeners(C0);}else{B2(Cy._hilightObjListens);}}),Cz.attachEventListener("nonShapeFormatableChanged",this.id,function(C0){if(true||this.getLocalState(R.IN_FORMATTING_MODE)){Cy.notifyNonShapeSelectionChangeToListeners(C0);}}),Cz.attachEventListener("propertyChanged",this.id,function(C0){var C1=this.translateFormatPropertyChangeFromGM(C0.n,C0.v,C0.opt);(C1||[]).forEach(function(C2){Cy.notifyPropChangeToListeners(C2.sn,C2.val,C0.opt);});}),Cz.attachEventListener("formattingModeChanged",this.id,function(C0){this.updateLocalState(R.IN_FORMATTING_MODE,C0.isFmtMode);Cy._notifyFormatModeChangeToListeners(C0.isFmtMode);B2(Cy._hilightObjListens);}),Cz.attachEventListener("onContextMenuSelection",this.id,function(C0){if(C0.identityType){Cy._notifyOnContextMenuSelectionListeners(C0);}}),Cz.attachEventListener("shapeFormattingTargetsChanged",this.id,function(){Cy.refreshShapeFormattingTargets();})];this._titleSubs=[Cz.parent.titleBar&&Cz.parent.titleBar.attachEventListener("titleBarRMC",this.id,function(C0){if(this.getLocalState(R.IN_FORMATTING_MODE)){C0.identities=[{objType:BP.VIZ_BOX_TITLE}];Cy.notifyNonShapeSelectionChangeToListeners(C0);}})];},detachEditorRuntime:function AR(){(this._subscriptions).forEach(function(Cz){this.vis.detachEventListener(Cz);},this);(this._titleSubs).forEach(function(Cz){if(this.vis.parent.titleBar){this.vis.parent.titleBar.detachEventListener(Cz);}},this);var Cy=this.editorManager;this.editorManager=null;return Cy;},translateFormatPropertyChangeFromGM:function m(C3,C0,C1){function C8(DA,C9,DB){return Cc.filter(DA,function(DC){return(DC.indexOf(C9+(DB||""))===0);});}function C2(DB,DA,DE){var DD=A0.keyarray(C4._smartNameToPropertyKeyLookup),C9=C8(DD,DB),DC="";if(DA){DC+=Cp+DA;C9=C8(C9,DB,DC);}if(C9.length===1){return C9[0];}if(C9.length>1){if(C9.indexOf(DB+(DC||""))!==-1){return DB+(DC||"");}DC+=DE&&(DE.opt||DE.key);C9=C8(C9,DB,DC);}if(C9.length===1){return C9[0];}return undefined;}var C4=this,Cy=[undefined],Cz,C6,C7=[C0],C5=[];if(C0&&C0.modifiedPropertyKeys){Cy=C0.modifiedPropertyKeys;if(!Cy){return Al("[Broker] modifiedPropertyKeys is empty for actual prop name: "+C3);}C7=Cy.map(function(C9){return C0.jsonObj[C9];});}Cy.forEach(function(DB,DA){var C9=[],DD=A0.keyarray(C4._dynamicPrefixToSmartNamesLookup),DC;Cz=C2(C3,DB,C1);if(Cz){C9.push(Cz);}(DD||[]).forEach(function(DE){DC=C4.editorManager.getSelectedValue(DE.slice(0,-1),"prefix");if(C3.indexOf(DC)===0){Cz=C2(C3.replace(DC,DE),DB,C1);if(Cz){C9.push(Cz);}}});C6=C7[DA];if(C6!==undefined&&C9.length!==0&&C4.isColorProperty(C4.getFormatPropertyKey(C9[0]))){C6=Ca.decodeColor(C6);}C9.forEach(function(DH){var DG=C4.getFormatPropertyKey(DH),DF=DG&&DG.levelSelector,DE;if(!DG){return Al("[Broker] Got a smart name in event but failed to locate the matched property key: "+DH);}if(DF&&typeof DF==="string"){DE=C4.editorManager.getSelectedValue(DF);if(!DE){return Al("[Broker] Failed to get selection option by selector name: "+DF);}if(DE.key!==C1.key){return undefined;}}C5.push({sn:DH,val:C6});});});return C5;},getSmartNamesMapForFontGroup:function Be(C3,C5,Cz,Cy,C2,C0){var C1=this;function C4(C8){var C7=C5,C6=Cz;if(Cy==="fld"){C6=(C6||"")+C8;}else{C7=(C7||"")+C8;}return C1.generateSmartName(C3,C7,C6,C2,C0);}return{fontFamily:C4(A9),fontStyle:C4(V),fontSize:C4(CD),fontColor:C4(Cq)};},getSmartNamesMapForLineGroup:function Co(C3,C5,Cz,Cy,C2,C0){var C1=this;function C4(C8){var C7=C5,C6=Cz;if(Cy==="fld"){C6=(C6||"")+C8;}else{C7=(C7||"")+C8;}return C1.generateSmartName(C3,C7,C6,C2,C0);}return{lineColor:C4(Bn),lineStyle:C4(At)};},getSmartNamesMapForFillGroup:function CW(C3,C5,Cz,Cy,C2,C0){var C1=this;function C4(C8){var C7=C5,C6=Cz;if(Cy==="fld"){C6=(C6||"")+C8;}else{C7=(C7||"")+C8;}return C1.generateSmartName(C3,C7,C6,C2,C0);}return{fillColor:C4(A8),fillAlpha:C4(r)};},getVisProfile:function Bl(Cy){var C0=this.vis,Cz=C0.GMController.enableCombiChart?C0.GMController.metricShapeArr:[C0.getChartInfo().shape];switch(Cy){case CP:return C0.getChartInfo().isBubbleOrScatter;case AE:return C0.getChartInfo().isABL;case b:return C0.GMController.pureAreaChart;case AO:return C0.isSeasonalityEnabled();case Bh:return C0.getNumericAxisOptions().length>0;case An:return C0.GMController.hasSizeBy();case Aj:return C0.GMController.hasColorBy();case Bg:return C0.GMController.hasAttributesInDropzone("BreakBy");case AH:return C0.GMController.isMetricNamesInZone("BreakBy");case BC:return C0.GMController.textTypeDataLabelEnabled();case Bc:return Cz.every(function(C1){return C1===CI.LINE||C1===CI.TICK;});case AA:return C0.GMController.valueTypeDataLabelEnabled();case Cd:return C0.GMController.chartSubType===Cu.PERCENT;case v:return C0.GMController.getSizeByMetrics()&&C0.GMController.getSizeByMetrics().length>0;case L:return C0.getChartInfo().shape===CI.LINE;case Bp:return C0.getChartInfo().shape===CI.TICK;case CV:return Cz.every(function(C1){return[CI.BAR,CI.AREA,CI.CIRCLE,CI.SQUARE,CI.RING,CI.PIE].indexOf(C1)!==-1;});case B4:return Cz.indexOf(CI.LINE)>-1||Cz.indexOf(CI.AREA)>-1;case AN:return C0.GMController.isAxisAttributeInColorBy();case Aa:return C0.GMController.isEmptyVis();}return Al("[Broker getVisProfile] Unrecognized profile name: "+Cy);},getOptionItems:function BN(Cz,Cy){var C0=this.vis;switch(Cz){case BG:return CQ(C0.getEnabledReferenceLineOptions(Cy));}return Al("[Broker getOptionItems] Unrecognized optionName: "+Cz);},getDataLabelItems:function Bd(){var Cy=this.vis.getShowDataLabelOptions(),Cz=[];(Cy||[]).forEach(function(C0){Cz.push({n:C0.opt,opt:C0,isAll:C0.key&&C0.key==="AllMetrics"});});return Cz;},generateSmartName:function BK(C1,C6,C4,C2,C0){function C3(C7){var C8=C7.levelSelector,DA=C8&&(C8.opt||C8.key),C9=(C7.namePrefix||"")+(C7.nameSuffix||"");if(C7.filedAlias){C9+=Cp+C7.filedAlias;}if(DA){C9+=H+DA;}return C9;}var C5={namePrefix:C1,nameSuffix:C6,filedAlias:C4,levelSelector:C2,target:C0},Cz=C3(C5),Cy=this._smartNameToPropertyKeyLookup[Cz];if(Cy&&!A0.equals(Cy,C5)){Aw("[Broker] smart name conflict for : "+Cz);}this._smartNameToPropertyKeyLookup[Cz]=C5;if(C1&&C1.slice(-1)===Ax){this._dynamicPrefixToSmartNamesLookup[C1]=this._dynamicPrefixToSmartNamesLookup[C1]||[];this._dynamicPrefixToSmartNamesLookup[C1].push(Cz);}return Cz;},getFormatPropertyKey:function Ah(Cy){var Cz=this._smartNameToPropertyKeyLookup[Cy];if(!Cz){Aw("[Broker] Format property key not found for smart name: "+Cy);}return Cz;},getDependingSelectorNames:function CH(Cz){var C0=this.getFormatPropertyKey(Cz),C2=[];if(!C0){return C2;}var Cy=C0.namePrefix,C1=C0.levelSelector;if(this._dynamicPrefixToSmartNamesLookup[Cy]){C2.push(Cy.slice(0,-1));}if(C1&&typeof C1==="string"){C2.push(C1);}return C2;},_resolveFormatPropNameWithRuntime:function Ai(Cz){var Cy=Cz.namePrefix,C0;if(this._dynamicPrefixToSmartNamesLookup[Cy]){C0=this.editorManager.getSelectedValue(Cy.slice(0,-1),"prefix",Cz.nameSuffix);}else{C0=Cy;}return(C0||"")+Cz.nameSuffix;},_resolveLevelOptionWithRuntime:function A(Cz){var C0=Cz.levelSelector,Cy;if(!C0){return undefined;}if(typeof C0==="string"){Cy=this.editorManager.getSelectedValue(C0);if(!Cy){return Al("[Broker] Failed to get selection option by selector name: "+C0);}}else{Cy=C0;}return Cy;},isColorProperty:function(Cz){var Cy=Cz.filedAlias||Cz.nameSuffix;if(Cy&&Cy.slice(-3)===Bn){return true;}return false;},getFormatPropertyValue:function Ba(Cz,C1){var C0=this.getFormatPropertyKey(Cz);if(!C0){return Al("[Broker] Failed to locate a property key by smart name: "+Cz);}if(!this.editorManager){return Al("[Broker] Editor runtime offline while trying to get property value for : "+Cz);}var C3=this.vis,C2,Cy,C4;if(C0.target===As){Cy=C3.getPropertiesOfFormatable();}else{C1=C1||this._resolveLevelOptionWithRuntime(C0);C2=this._resolveFormatPropNameWithRuntime(C0);Cy=C3.readGlobalProperty(C2,C1);}if(C0.filedAlias){if(!Cy||!Cy.jsonObj){return Al("[Broker] Result value collection is not in expected structure for smart name: "+Cz);}C4=Cy.jsonObj[C0.filedAlias];}else{if(typeof Cy==="object"){return Al("[Broker] Expect a string value while got a structure for smart name: "+Cz);}C4=Cy;}if(C4===undefined){C4=C3.getDefaultProperties()[C2];Aw("[Broker] get format value failed for smart name: "+Cz+". Fall back to default value and got: "+C4);}if(C4!==undefined&&this.isColorProperty(C0)){C4=Ca.decodeColor(C4);}return C4;},setFormatPropertyValue:function S(Cz,C5,C4,C8,C2){var C6=this.getFormatPropertyKey(Cz);if(!C6){return Al("[Broker] Failed to locate a property key by smart name: "+Cz);}if(!this.editorManager){return Al("[Broker] Editor runtime offline while trying to set property value for : "+Cz);}if(C5!==undefined&&this.isColorProperty(C6)&&C5!==AZ){C5=Ca.encodeColor(C5);}var C7=this.vis,C3,C1=C6.filedAlias,C0,Cy;if(C6.target===As){C0=C7.getPropertiesOfFormatable();}else{C4=C4||this._resolveLevelOptionWithRuntime(C6);C3=this._resolveFormatPropNameWithRuntime(C6);C0=C7.readGlobalProperty(C3,C4);if(C3==="refDef"){C0.opt=C4;}}if(C1){if(!C0||!C0.jsonObj){return Al("[Broker] Result value collection is not in expected structure for smart name: "+Cz);}Cy=C0.jsonObj[C1];if(C5!==Cy){C0.setProperty(C1,C5);if(C6.target===As){Aw("[Broker] writeFormatableProperties("+C1+", "+C5+")");C7.writeFormatableProperties(C0);}else{Aw("[Broker] writeGlobalProperty("+C3+":"+C1+", "+C5+", "+C4+")");C7.writeGlobalProperty(C3,C0,C4,C8,C2);}}}else{if(typeof C0==="object"){return Al("[Broker] Expect a string value while got a structure for smart name: "+Cz);}Cy=C0;if(C5!==Cy){Aw("[Broker] writeGlobalProperty("+C3+", "+C5+", "+C4+")");C7.writeGlobalProperty(C3,C5,C4,C8,C2);}}}});mstrmojo.ui.editors.controls.MenuPulldown=mstrmojo.declare(mstrmojo.Container,[mstrmojo._HasPopup],{scriptClass:"mstrmojo.ui.editors.controls.MenuPulldown",markupString:'<div id="{@id}" class="mstrmojo-ui-Pulldown {@cssClass}" mstrAttach:mousedown,click><div class="mstrmojo-ui-Pulldown-text">{@value}</div><div class="container"></div></div>',markupSlots:{selectedNode:function Z(){return this.domNode.firstChild;},containerNode:function CZ(){return this.domNode.lastChild;}},markupMethods:{onvisibleChange:CK.visibleMarkupMethod,onheightChange:CK.heightMarkupMethod,onwidthChange:CK.widthMarkupMethod,onvalueChange:function Bq(){this.selectedNode.innerHTML=Ca.replaceSpecialChars(this.getDisplayText(this.value));},onenabledChange:mstrmojo.Widget.enabledMarkupMethod},value:undefined,anchorSlot:"selectedNode",getDisplayText:function h(Cy){return Cy||"";},onclick:function BS(){var Cy=this.getMenuConfig();if(!Cy){return ;}if(!this.isClosedByAnchor){this.openPopup(new mstrmojo.ui.menus.Menu({popupConfig:Cy,themeClassName:mstrApp.getThemeClassName()}));}else{this.closePopup();this.isClosedByAnchor=false;}},onPopupAutoClosed:function CJ(Cz,Cy){if(mstrmojo.dom.eventTarget(Cy,Cz)===this[this.anchorSlot]){this.isClosedByAnchor=true;}},getMenuConfig:Cm});function k(Cz,Cy,C1,C0){Cz.slot="col1Node";Cy.slot="col2Node";return new mstrmojo.ui.editors.controls.TwoColumnContainer({col1Width:C1||"40%",col2Width:C0||"60%",children:[Cz,Cy]});}function Ch(){var Cy=x.call(this,mstrmojo.desc(14313,"All Graph Fonts"));return[Cy,BI.call(this,null,this.broker.getSmartNamesMapForFontGroup(Bz),{controlName:"AllTextFontGroup",groupTitle:Cy,visibleControls:c.FONT_FAMILY|c.FONT_SIZE_AND_COLOR|c.FONT_STYLE|c.FONT_SIZE_USE_STEPPER})];}function B5(){var DG=this.broker,C6=DG.editorManager,C1=B9,DC=U.call(this),C8=DG.getVisProfile(Cd),DF=C8?100:1;if(!DC.length){return[];}function C5(DI,DH){return DG.generateSmartName(null,DI,DH,C1);}function C7(){var DH=DB.items[DB.selectedIndex];return DH._renderIdx===0||!(DH.v.sizeBy||DH.v.key==="SizeBy");}var DE=x.call(this,mstrmojo.desc(13872,"Axis Configuration"),{highlightObjects:[BP.AXIS_SCALE,BP.LOG_SCALE,BP.AXIS_ORIGIN_DEFINE],scopeSelectors:[C1]}),DB=F.call(this,null,C1,DC,C6),C2=C5(B8,Ad.SINGLE_AXIS_SCALE_TYPE),Cy=BY.call(this,mstrmojo.desc(13873,"Axis scale"),C2,{min:C5(B8,Ad.AXIS_SCALE_REAL_MIN),max:C5(B8,Ad.AXIS_SCALE_REAL_MAX),customMin:C5(B8,Ad.AXIS_SCALE_MANUAL_MIN),customMax:C5(B8,Ad.AXIS_SCALE_MANUAL_MAX)},{autoMin:C5(B8,Ad.AXIS_SCALE_AUTO_MIN),autoMax:C5(B8,Ad.AXIS_SCALE_AUTO_MAX)},{groupTitle:DE}),C4=BZ.call(this,mstrmojo.desc(13874,"Log scale"),[{n:mstrmojo.desc(10035,"Yes"),v:true},{n:mstrmojo.desc(2180,"No"),v:false}],C5(B8,Ad.LOG_SCALE),{groupTitle:DE,reInit:function(){this.reInitDefault();this.parent.set("enabled",!C8&&C7());}}),C0=C5(u,Ad.AXIS_ORIGIN_AUTO),DD=CF.call(this,null,C0),C9=C5(u,Ad.AXIS_ORIGIN_VALUE),C3=e.call(this,null,C9,{listenFormatProps:[C0],errRevert:false,useRichTooltip:true,constraints:C8?{min:-100,max:100}:{min:null,max:null},updateTooltipConfig:function(){if(this.isValid()){this.richTooltip=null;return ;}var DH=this.validationStatus;this.richTooltip={posType:mstrmojo.tooltip.POS_BOTTOMLEFT,cssClass:"vi-warning vi-tooltip-C vi-calculation-warning",left:this.domNode.offsetWidth+12,top:this.domNode.offsetHeight+5,refNode:this.domNode,content:this.getInvalidMsg(DH)};},onValid:function(){var DH=Bx(this.value,DF,false);if(this._sync){return ;}this.broker.setFormatPropertyValue(this.smartNames[0],DH);},onFmtPropsChanged:function(DI,DK){if(DI===C0){this.set("enabled",!DK);var DH=DK?mstrmojo.desc(12143,"Automatic"):"";this.syncControl(function(){this.set("emptyText",DH);if(DK){this.set("value",null);}if(DK&&this.hasRendered){this.clearValidation();}});}else{if(this.enabled){if(DI===C9){DK=Bx(DK,DF,true);}this.onFmtPropsChangedDefault(DI,mstrmojo.num.toLocaleString(DK));}}var DJ=C7();if(this.parent&&this.parent.parent){this.parent.parent.set("enabled",DJ);}this.set("enabled",DJ&&!DD.checked);}}),Cz=this.getLabelAndControl(mstrmojo.desc(13875,"Axis origin"),this.addDisposable(k(DD,C3,"20px","100%")),"40%","60%"),DA=[DE,Cy,C4,Cz];if(DB.items.length>1){Cc.insert(DA,1,[DB]);}if(DA.length){DA=[this.getEditorGroup(DA)];}return DA;}function Cf(){var C3=this.broker,Cy=C3.getVisProfile(An),Cz={trigger:mstrmojo.validation.TRIGGER.ONBLUR,min:0.01,max:1},C5=C3.getVisProfile(b),C2=this.addDisposable(new mstrmojo.Label({text:mstrmojo.desc(13917,"Min size (0.01 - 1.0)")})),DA=this.addDisposable(new mstrmojo.Label()),C1=mstrmojo.desc(13740,"The smallest element's size is ## of the largest element's size");function C6(DB){return C3.generateSmartName(null,DB);}function C8(){if(this._sync){return ;}this.broker.setFormatPropertyValue(this.smartNames[0],C.parseNumeric(this.value).toFixed(2));}var C7=C6(Ad.MAX_SIZE_TYPE),C4=C6(Ad.MIN_SIZE_TYPE),C0=k(BZ.call(this,null,[{n:mstrmojo.desc(6019,"Automatic"),v:B6.EnumMaxSizeType.AUTO},{n:mstrmojo.desc(8262,"Manual"),v:B6.EnumMaxSizeType.MANUAL}],C7,{reInit:function(){this.parent.set("enabled",!C5);if(!C5){this.reInitDefault();}}}),e.call(this,null,C6(Ad.MAX_SIZE_VALUE),{constraints:Cz,listenFormatProps:[C7],onValid:C8,onFmtPropsChanged:function(DB,DC){if(DB===C7){this.set("enabled",DC===B6.EnumMaxSizeType.MANUAL);}else{this.onFmtPropsChangedDefault(DB,C.toLocaleString(DC));}}}),"75%","25%"),C9=k(BZ.call(this,null,[{n:mstrmojo.desc(11990,"Proportional"),v:B6.EnumMinSizeType.PROPORTIONAL},{n:mstrmojo.desc(13741,"Full Range"),v:B6.EnumMinSizeType.AUTO},{n:mstrmojo.desc(14118,"Adjusted Range"),v:B6.EnumMinSizeType.MANUAL}],C4,{reInit:function(){var DB=!C5&&Cy;this.parent.set("enabled",DB);C2.set("enabled",DB);if(DB){this.reInitDefault();}},onFmtPropsChanged:function(DB,DC){this.onFmtPropsChangedDefault(DB,DC);}}),e.call(this,null,C6(Ad.MIN_SIZE_VALUE),{constraints:Cz,listenFormatProps:[C4],onValid:C8,onFmtPropsChanged:function(DB,DD){if(!Cy){this.set("enabled",false);return ;}if(DB===C4){var DC=DD===B6.EnumMinSizeType.MANUAL;this.set("enabled",DC);if(DC){DA.set("text",C1.replace("##",(this.value*100).toFixed(0)+"%"));}}else{this.onFmtPropsChangedDefault(DB,C.toLocaleString(DD));if(this.enabled){DA.set("text",C1.replace("##",(DD*100).toFixed(0)+"%"));}}}}),"75%","25%");this.addDisposable([C0,C9]);return[this.addDisposable(new mstrmojo.Label({text:mstrmojo.desc(13918,"Max size (0.01 - 1.0)")})),C0,C2,C9,DA];}function J(){var Cy=this.broker;function Cz(C0){return Cy.generateSmartName(null,C0);}return[BZ.call(this,mstrmojo.desc(14795,"Container fit:"),[{n:mstrmojo.desc(2057,"None"),v:B6.EnumFitTo.NONE},{n:mstrmojo.desc(4531,"Automatic"),v:B6.EnumFitTo.AUTOMATIC},{n:mstrmojo.desc(14796,"Compact"),v:B6.EnumFitTo.COMPACT},{n:mstrmojo.desc(8262,"Manual"),v:B6.EnumFitTo.MANUAL}],Cz(Ad.FIT_TO),{associatedPropValueTuples:[{name:Ad.SCALE_CHART_WIDTH,value:undefined,valueWas:Cy.vis.getWidgetPropertyValue(Ad.SCALE_CHART_WIDTH)},{name:Ad.SCALE_CHART_HEIGHT,value:undefined,valueWas:Cy.vis.getWidgetPropertyValue(Ad.SCALE_CHART_HEIGHT)}],preFmtPropsChangedHook:function(C3,C2){var C0=Cy.vis.getWidgetPropertyValue(Ad.SCALE_CHART_WIDTH),C1=Cy.vis.getWidgetPropertyValue(Ad.SCALE_CHART_HEIGHT);if((C0&&C0!==1)||(C1&&C1!==1)){C2=Ap.MANUAL;}return C2;}},["55%","45%"]),this.getLabelAndControl(mstrmojo.desc(13745,"Banding on rows"),CF.call(this,null,Cz(Ad.BANDING)),"20px","100%",true)];}function Ac(Cz){var Cy=B5.call(this);this.replaceChildControls(Cz,Cy.concat([this.getEditorGroup(Cf.call(this),BE),this.getEditorGroup(J.call(this),BE),this.getEditorGroup(Ch.call(this),BE),this.getEditorGroup([this.getMoreOptionsEditorLink(this.getHost().model.data.gsi.prop)],BE)]));}function CM(Cz){var Cy=[];Cy.push(this.getEditorGroup(CE.call(this),BE));this.replaceChildControls(Cz,Cy);}function BD(DF){var DR=this.broker,DI=DR.editorManager,C6=Au,DG=Ad.TREND_LINE_DEF,DB=Cx.call(this),DE=Ca.isTrendLineAvailableForAnyMetric(DR.vis);function DA(DU,DV){return DR.generateSmartName(null,DG,DU,DV);}function Cy(DU){return{listenFormatProps:[DU],onFmtPropsChanged:function(DV,DW){if(DV===DU){this.getCtrlContainer().set("enabled",DW&&DE);}else{this.onFmtPropsChangedDefault(DV,DW);}}};}function C5(){return(DB||[]).some(function(DU){return DR.getFormatPropertyValue(DD,DU.v);});}var DD=DA(Ad.TREND_ENABLED,C6),DJ=F.call(this,null,C6,DB,DI,{highlightObjects:[BP.TREND_LINE],enabled:DE,updateSelection:function DH(DV,DX){var DW=DX[0].tlOpt.key,DU=-1;Cc.forEach(this.items,function(DZ,DY){if(DZ.v.key===DW){DU=DY;return false;}});Az(this,function(){this.set("selectedIndex",DU);});}}),C2=CF.call(this,mstrmojo.desc(13746,"Enable Trend Line"),DD),DP=CO.call(this,null,DR.getSmartNamesMapForLineGroup(null,DG,"trdRefLn","fld",C6),A0.copy({lineTitle:mstrmojo.desc(13927,"Line"),controlName:"TrendLineLineGoup",showNoneOption:false,showNoFillInColor:false,showGradient:false},Cy(DD))),C4=DA(Ad.TREND_TYPE,C6),C1=BZ.call(this,mstrmojo.desc(13876,"Model"),[{n:mstrmojo.desc(13877,"Best fit"),v:B6.EnumTrendLineModelType.BEST_FIT},{n:mstrmojo.desc(4888,"Linear"),v:B6.EnumTrendLineModelType.LINEAR},{n:mstrmojo.desc(12021,"Logarithmic"),v:B6.EnumTrendLineModelType.LOG},{n:mstrmojo.desc(12022,"Exponential"),v:B6.EnumTrendLineModelType.EXP},{n:mstrmojo.desc(12023,"Power"),v:B6.EnumTrendLineModelType.POW},{n:mstrmojo.desc(12024,"Polynomial"),v:B6.EnumTrendLineModelType.POLY}],C4,A0.copy(Cy(DD))),Cz=BZ.call(this,mstrmojo.desc(13919,"Degree:"),[{n:"2",v:2},{n:"3",v:3},{n:"4",v:4},{n:"5",v:5},{n:"6",v:6}],DA(Ad.TREND_POLY_DEGREE,C6),{listenFormatProps:[DD,C4],onFmtPropsChanged:function(DU,DV){if(DU===DD){this.set("enabled",DV&&DE);}else{if(DU===C4){this.parent.set("visible",DV===B6.EnumTrendLineModelType.POLY);}else{this.onFmtPropsChangedDefault(DU,DV);}}}},{curVal:2,min:2,max:6}),DT=BZ.call(this,mstrmojo.desc(1452,"Level"),A4,DA(Ad.TREND_LEVEL,C6),{listenFormatProps:[DD],onFmtPropsChanged:function DM(DV,DX){if(DV===DD){var DW=DR.vis.GMController,DU=DW.hasAttributesInDropzone("Rows")||DW.hasAttributesInDropzone("Columns");this.parent.set("enabled",DE&&DU&&DX);}else{this.onFmtPropsChangedDefault(DV,DX);}}}),C9=[C2,DP,C1,Cz,DT],DC;C2.set("enabled",DE);if(DJ.items.length>1){Cc.insert(C9,0,[DJ]);}mstrmojo.css.addWidgetCssClass(C2,"title");if(DR.getVisProfile(AE)){var C8=CF.call(this,mstrmojo.desc(13878,"Include Break-by Attribute"),DA(Ad.TREND_INCLUDE_BREAK_BY,C6),{listenFormatProps:[DD],onFmtPropsChanged:function(DU,DV){if(!DR.getVisProfile(Bg)){this.parent.set("enabled",false);}else{if(DU===DD){this.parent.set("enabled",DV&&DE);}else{this.onFmtPropsChangedDefault(DU,DV);}}}});Cc.insert(C9,C9.length,[C8]);var C3=DA(Ad.TREND_FORECAST_ENABLED),DO=CF.call(this,mstrmojo.desc(12026,"Enable Forecasting"),C3,{listenFormatProps:[DD],onFmtPropsChanged:function(DU,DV){if(DU===DD){this.parent.set("enabled",DE&&C5());}else{this.onFmtPropsChangedDefault(DU,DV);}}});var DN=function(){return{listenFormatProps:[DD,C3],onFmtPropsChanged:function(DU,DV){if(DU===DD||DU===C3){this.parent.set("enabled",DE&&DR.getFormatPropertyValue(C3)&&C5());}else{this.onFmtPropsChangedDefault(DU,DV);}}};};var C7=AS.call(this,mstrmojo.desc(13879,"Forward"),DA(Ad.TREND_FWD_FORECAST),DN()),C0=AS.call(this,mstrmojo.desc(13880,"Backward"),DA(Ad.TREND_BWD_FORECAST),DN()),DL=BZ.call(this,mstrmojo.desc(13881,"Seasons"),[{n:mstrmojo.desc(5949,"None"),v:B6.EnumTimeRole.None},{n:mstrmojo.desc(10048,"Week"),v:B6.EnumTimeRole.DayOfWeek},{n:mstrmojo.desc(871,"Month"),v:B6.EnumTimeRole.DayOfMonth},{n:mstrmojo.desc(10050,"Quarter"),v:B6.EnumTimeRole.MonthOfQuarter},{n:mstrmojo.desc(873,"Year"),v:B6.EnumTimeRole.MonthOfYear},{n:mstrmojo.desc(13748,"Decade"),v:B6.EnumTimeRole.YearOfDecade}],DA(Ad.TREND_SEASONALITY),{listenFormatProps:[DD,C4],onFmtPropsChanged:function(DU,DV){if(DU===C4||DU===DD){this.parent.set("enabled",DE&&DR.getVisProfile(AO)&&C5());}else{this.onFmtPropsChangedDefault(DU,DV);}}});A0.copy({useRichTooltip:true,updateTooltipConfig:function DK(){this.richTooltip=this.enabled?null:{content:mstrmojo.desc(14314,"This option is available only when a time based attribute is placed on the axis"),refNode:this.domNode,cssClass:"vi-regular",posType:mstrmojo.tooltip.POS_BOTTOMLEFT,top:18,left:70};}},DL);mstrmojo.css.addWidgetCssClass(DO,"title");DC=[this.getEditorGroup(C9,B1),this.getEditorGroup([DO,C7,C0],B1),this.getEditorGroup([DL],B1)];}else{var DQ=x.call(this,mstrmojo.desc(13932,"Forecasting")),DS=B3.call(this,DD,{groupTitle:DQ,onFmtPropsChanged:function(){var DU=DE&&C5();this.set("enabled",DU);DQ.set("enabled",DU);}});DC=[this.getEditorGroup(C9,B1)].concat(this.getEditorGroup([DQ,DS],B1));}this.replaceChildControls(DF,DC);}function K(DC){var DH=this.broker,DG=DH.editorManager,DD=Ad.REF_LINE_DEF,DF=p,Cy=BG,C9=DH.generateSmartName(null,DD,Ad.REF_ENABLED),C5=DH.generateSmartName(null,DD,Ad.REF_LINE_NAME),DJ=!DH.getVisProfile(Cd),C7={reInit:function(){var DK=this.manager.getSelectedValue(Cy,"v");this.getCtrlContainer().set("enabled",!!DK&&DJ);if(this.controlName==="ReferenceLineLabelCharacterGroup"){var DL=parseInt(this.fontSize.selectedValue,10).toString();this.fontSize.set("selectedValue",DL);}if(DK){this.reInitDefault();}else{Az(this,function(){this.resetValue();});}}};function C8(DK){return DH.generateSmartName(null,DD,DK,Cy);}var DB=A5.call(this),C0=F.call(this,null,DF,DB,DG,{enabled:DJ}),DA=B7.call(this,null,DB[0].v,Cy,[C9,C5],{restrictedTypes:DH.getVisProfile(CP)?[B6.EnumRefLineModelType.FIRST,B6.EnumRefLineModelType.LAST]:[],listenSelector:[DF],highlightObjects:[BP.REF_LINE],enabled:DJ,updateSelection:function DE(DK,DL){var DO=DL[0],DN=DO.key,DM=DL[0].tlOpt.key;Az(C0,function(){var DP=-1;Cc.forEach(C0.items,function(DR,DQ){if(DR.v.key===DN){DP=DQ;return false;}});C0.set("selectedIndex",DP);});Az(this,function(){this.selectItemByField("key",DM);});}}),C3=CO.call(this,null,DH.getSmartNamesMapForLineGroup(null,DD,"trdRefLn","fld",Cy),A0.copy(C7,{lineTitle:mstrmojo.desc(13927,"Line"),controlName:"ReferenceLineLineGroup",showNoneOption:false,showNoFillInColor:false,showGradient:false,resetValue:function C1(){this.lineColorAndStyle.lineColor.set("color","#000000");this.lineColorAndStyle.lineStyle.set("selectedValue","none");}})),C2=BZ.call(this,mstrmojo.desc(1452,"Level"),A4,C8(Ad.REF_LEVEL),{reInit:function(){var DM=this.manager.getSelectedValue(Cy,"v"),DL=DH.vis.GMController,DK=DJ&&(DL.hasAttributesInDropzone("Rows")||DL.hasAttributesInDropzone("Columns"))&&(DM&&DM.refType!==B6.EnumRefLineModelType.CONST);if(this.parent){this.parent.set("enabled",DK);}if(DK){this.reInitDefault();}if(!DM){Az(this,function(){this.resetValue();});}},resetValue:function C1(){this.set("selectedIndex",0);}}),Cz=C8(Ad.REF_SHOW_LABEL),C6=CF.call(this,mstrmojo.desc(13749,"Show label"),Cz,A0.copy(C7,{resetValue:function C1(){this.set("checked",false);}})),DI=Ay.call(this,null,[{n:mstrmojo.desc(8733,"Type"),v:B6.EnumTrendRefModelLabels.DssModelLabelsType},{n:mstrmojo.desc(4779,"Metric"),v:B6.EnumTrendRefModelLabels.DssModelLabelsMetric},{n:mstrmojo.desc(527,"Value"),v:B6.EnumTrendRefModelLabels.DssModelLabelsValue}],C8(Ad.REF_LABEL_TYPE),A0.copy(C7,{listenFormatProps:[Cz],onFmtPropsChanged:function(DK,DL){if(DK===Cz){var DM=this.manager.getSelectedValue(Cy,"v");this.set("enabled",!!DM&&DL&&DJ);}else{this.onFmtPropsChangedDefault(DK,DL);}},multiSelect:true,resetValue:function C1(){this.clearSelect();}})),C4=BI.call(this,null,DH.getSmartNamesMapForFontGroup(null,DD,"rfLn","fld",Cy),A0.copy(C7,{controlName:"ReferenceLineLabelCharacterGroup",syncWithAllText:true,listenFormatProps:[Cz],onFmtPropsChanged:function(DK,DM){if(DK===Cz){var DN=this.manager.getSelectedValue(Cy,"v"),DL=!!DN&&DM&&DJ;this.set("enabled",DL);if(DL){this.refreshValues();}}else{if(this.enabled){this.onFmtPropsChangedDefault(DK,DM);}}},resetValue:function C1(){this.fontColor.set("selectedValue","#000000");this.fontStyle.clearSelect();this.fontSize.set("selectedValue","10");this.fontFamily.set("selectedIndex",0);}}));mstrmojo.css.addWidgetCssClass(C6,"title");this.replaceChildControls(DC,[this.getEditorGroup([C0,DA,C3,C2],B1),this.getEditorGroup([C6,DI,C4],B1)]);}function AT(C8){var C5=this.broker;function C9(DF){return C5.generateSmartName(null,DF);}var DC=C9(Ad.LEGEND_VISIBLE),DA=function(DG,DI){if(DG===DC){var DH=this.parent,DF=this;if(DH&&DH.scriptClass==="mstrmojo.ui.editors.controls.TwoColumnContainer"){DF=DH;}DF.set("enabled",!!DI);}else{this.onFmtPropsChangedDefault(DG,DI);}},C0=CF.call(this,mstrmojo.desc(13600,"Show legend"),DC),DE=BI.call(this,null,C5.getSmartNamesMapForFontGroup(o),{controlName:"LegendTextFongGroup",syncWithAllText:true,listenFormatProps:[DC],onFmtPropsChanged:DA}),DD=this.addDisposable(new mstrmojo.Label({text:mstrmojo.desc(13601,"Fill")})),Cz=Cv.call(this,null,C5.getSmartNamesMapForFillGroup(Bk),{controlName:"LegendBackgroundFillGroup",listenFormatProps:[DC],onFmtPropsChanged:DA}),DB=C9(Ad.LEGEND_POSITION),C4=mstrmojo.gm.EnumLegendSlot,C6=[{n:mstrmojo.desc(2166,"Right"),v:C4.RIGHT},{n:mstrmojo.desc(2256,"Top"),v:C4.LEFT_TOP},{n:mstrmojo.desc(2257,"Bottom"),v:C4.LEFT_BOTTOM},],C7=Cc.find(C6,"v",C5.getFormatPropertyValue(DB)),C2=C7===-1?0:C7,C1=this.getPulldown(C6,function(DF){C5.setFormatPropertyValue(DB,DF);},C2),Cy=x.call(this,mstrmojo.desc(2971,"Position")),C3=[C0,DE,DD,Cz];if(this.getHost().scriptClass==="mstrmojo.ngm.VisNewGraphMatrix"){C3=[C0,Cy,C1];}else{C3=[C0,DE,DD,Cz];}mstrmojo.css.addWidgetCssClass(C0,"title");this.replaceChildControls(C8,[this.getEditorGroup(C3,B1)]);}function Ao(){var DH=this.broker,C2=BR,C1=C2+Ax;function C8(DI){return DH.generateSmartName(C1,DI);}function DB(DI){return(DI.TemplateMetric!==undefined)||(DI.TemplateUnit!==undefined)||(DI.MetricNames!==undefined);}var C7=DH.vis.model.data.dz,DG=this.broker.vis,C3=DG.GMController.isWaterfall&&DG.getWaterfallOptions().totalShw,C5=DB(C7.XAxis)||(C3&&C7.YAxis.TemplateMetric!==undefined),C4=DB(C7.YAxis)||(C3&&C7.XAxis.TemplateMetric!==undefined),C6=C5&&C4,DD=[],C0=[];if(C6){C0.push((BP.X_CATEGORY|BP.Y_CATEGORY));DD.push({n:mstrmojo.desc(13920,"X and Y axes"),identity:(BP.X_CATEGORY|BP.Y_CATEGORY),prefix:BT,v:0});}if(C5){C0.push(BP.X_CATEGORY);DD.push({n:mstrmojo.desc(13921,"X axis"),identity:BP.X_CATEGORY,prefix:Bm,v:1});}if(C4){C0.push(BP.Y_CATEGORY);DD.push({n:mstrmojo.desc(13922,"Y axis"),identity:BP.Y_CATEGORY,prefix:N,v:2});}var DC=DD.length===0,C9=C8(Bi),DF=x.call(this,mstrmojo.desc(12003,"Axis Labels"),{highlightObjects:C0,scopeSelectors:[C2]}),DE=!DC?F.call(this,null,C2,DD,DH.editorManager,{highlightObjects:C0,groupTitle:DF}):undefined,Cz=CF.call(this,mstrmojo.desc(13923,"Show labels"),C9,{groupTitle:DF}),Cy=C8(BJ);var DA=[DF,DE,Cz,BI.call(this,null,DH.getSmartNamesMapForFontGroup(C1),{controlName:"AxisLabelsFontGroup",syncWithAllText:true,groupTitle:DF,listenFormatProps:[C9],showNoFillInColor:false,onFmtPropsChanged:function(DI,DJ){if(DI===C9){this.set("enabled",DJ);}else{this.onFmtPropsChangedDefault(DI,DJ);}}})];if(this.getHost().scriptClass!=="mstrmojo.ngm.VisNewGraphMatrix"){DA.push(BZ.call(this,mstrmojo.desc(13924,"Rotation:"),[{n:mstrmojo.desc(12284,"Automatic"),v:B6.EnumLabelRotation.AUTOMATIC},{n:mstrmojo.desc(12285,"Vertical"),v:B6.EnumLabelRotation.VERTICAL},{n:mstrmojo.desc(12286,"Horizontal"),v:B6.EnumLabelRotation.HORIZONTAL}],Cy,{groupTitle:DF,listenFormatProps:[C9],onFmtPropsChanged:function(DJ,DK){var DL=DE&&DE.selectedIndex===1,DI=Cz.getCtrl().checked;if(DJ===C9||DJ===Cy){this.parent.set("enabled",DI&&DL);}if(DJ===Cy&&DK!==undefined){this.onFmtPropsChangedDefault(DJ,DK);}}}));}return DA;}function Ce(){var C3=this.broker,C8=C3.editorManager,C1=AK,C4=C1+Ax,Cy=x.call(this,mstrmojo.desc(12008,"Axis Lines"),{highlightObjects:[(BP.X_AXIS|BP.Y_AXIS|BP.AXIS_ORIGIN),(BP.X_AXIS|BP.Y_AXIS),BP.X_AXIS,BP.Y_AXIS,BP.AXIS_ORIGIN],scopeSelectors:[C1]}),C6=[{n:mstrmojo.desc(13925,"All lines"),identity:(BP.X_AXIS|BP.Y_AXIS|BP.AXIS_ORIGIN),prefix:"allLn",v:0},{n:mstrmojo.desc(13920,"X and Y axes"),identity:(BP.X_AXIS|BP.Y_AXIS),prefix:"allAxLn",v:1},{n:mstrmojo.desc(13921,"X axis"),identity:BP.X_AXIS,prefix:"xAxLn",v:2},{n:mstrmojo.desc(13922,"Y axis"),identity:BP.Y_AXIS,prefix:"yAxLn",v:3}],C5={n:mstrmojo.desc(13926,"Axis origin"),identity:BP.AXIS_ORIGIN,prefix:"axOriLn",v:4},C2=U.call(this);if(C2&&C2.length>0){var C7=C3.generateSmartName(null,u,Ad.AXIS_ORIGIN_AUTO,B9),C9=C3.getFormatPropertyValue(C7,C2[0].v);if(!C9){C6.push(C5);}}var C0=F.call(this,null,AK,C6,C8,{highlightObjects:[(BP.X_AXIS|BP.Y_AXIS|BP.AXIS_ORIGIN),(BP.X_AXIS|BP.Y_AXIS),BP.X_AXIS,BP.Y_AXIS,BP.AXIS_ORIGIN],groupTitle:Cy}),Cz=CO.call(this,null,C3.getSmartNamesMapForLineGroup(C4),{lineTitle:mstrmojo.desc(13927,"Line"),controlName:"AxisLineGroup",groupTitle:Cy,showNoFillInColor:false,showNoneOption:false,showGradient:false,onSelectorsValueChanged:function(DA,DB){if(DA===AK){this.set("showNoneOption",DB!==4&&DB!==0);}this.onSelectorsValueChangedDefault(DA,DB);}});return[Cy,C0,Cz];}function AI(){var C5=this.broker,DC=C5.editorManager,C3=Av,C6=C3+Ax,Cy=x.call(this,mstrmojo.desc(12010,"Axis Titles"),{highlightObjects:[Ca.longIntOr(BP.X_METRIC_AXIS_TITLE,BP.Y_METRIC_AXIS_TITLE),BP.X_METRIC_AXIS_TITLE,BP.Y_METRIC_AXIS_TITLE],scopeSelectors:[C3]});var Cz=[],DA={XAxisTitle:{n:mstrmojo.desc(13921,"X axis"),identity:BP.X_METRIC_AXIS_TITLE,prefix:"xAxTt",v:1},YAxisTitle:{n:mstrmojo.desc(13922,"Y axis"),identity:BP.Y_METRIC_AXIS_TITLE,prefix:"yAxTt",v:2},XAndYAxesTitle:{n:mstrmojo.desc(13920,"X and Y axes"),identity:Ca.longIntOr(BP.X_METRIC_AXIS_TITLE,BP.Y_METRIC_AXIS_TITLE),prefix:"allAxTt",v:0}},DB=C5.vis.GMController,C8=DB.haveMetricAxisTitle("y"),C4=DB.haveMetricAxisTitle("x");C8=C8||DB.haveAttributeAxisTitle("y");C4=C4||DB.haveAttributeAxisTitle("x");if(C8){Cz.unshift(DA.YAxisTitle);}if(C4){Cz.unshift(DA.XAxisTitle);}if(C8&&C4){Cz.unshift(DA.XAndYAxesTitle);}var C9=Cz.length===0,C2=!C9?F.call(this,null,C3,Cz,DC,{highlightObjects:[Ca.longIntOr(BP.X_METRIC_AXIS_TITLE,BP.Y_METRIC_AXIS_TITLE),BP.X_METRIC_AXIS_TITLE,BP.Y_METRIC_AXIS_TITLE],groupTitle:Cy,enabled:!C9}):undefined,C7=C5.generateSmartName(C6,Bi),C1=CF.call(this,mstrmojo.desc(13928,"Show axis titles"),C7,{groupTitle:Cy}),C0=BI.call(this,null,C5.getSmartNamesMapForFontGroup(C6),C9?null:{controlName:"AxisTitlesFontGroup",groupTitle:Cy,syncWithAllText:true,listenFormatProps:[C7],onFmtPropsChanged:function(DD,DE){if(DD===C7){this.set("enabled",DE);}else{this.onFmtPropsChangedDefault(DD,DE);}}});Cy.set("enabled",!C9);C1.set("enabled",!C9);C0.set("enabled",!C9);return[Cy,C2,C1,C0];}function Aq(){var C2=this.broker,C6=C2.editorManager,C0=CU,C3;var Cy=x.call(this,mstrmojo.desc(11991,"Grid Lines"),{highlightObjects:[(BP.GRID_LINE|BP.MINOR_GRID_LINE),BP.GRID_LINE,BP.MINOR_GRID_LINE],scopeSelectors:[C0]}),C1;if(this.getHost().scriptClass==="mstrmojo.ngm.VisNewGraphMatrix"){C3=C2.generateSmartName(null,Cw.ALL_NGM_GRID_LINES_SHOW);C1=BZ.call(this,null,[{n:mstrmojo.desc(6019,"Automatic"),v:B6.EnumNGMGridLines.AUTO},{n:mstrmojo.desc(15672,"Show horizontal"),v:B6.EnumNGMGridLines.SHOW_Y},{n:mstrmojo.desc(15673,"Show vertical"),v:B6.EnumNGMGridLines.SHOW_X},{n:mstrmojo.desc(15674,"Show both"),v:B6.EnumNGMGridLines.SHOW},{n:mstrmojo.desc(15675,"Show none"),v:B6.EnumNGMGridLines.HIDE}],C3,{groupTitle:Cy,listenFormatProps:[C3]});C6.registerSelector(C0,C1);return[Cy,C1];}else{C3=C2.generateSmartName(null,Cw.ALL_GRID_LINES_SHOW);C1=BZ.call(this,null,[{n:mstrmojo.desc(6019,"Automatic"),v:B6.EnumGridLines.AUTO},{n:mstrmojo.desc(13929,"Show major and minor"),v:B6.EnumGridLines.SHOW},{n:mstrmojo.desc(13930,"Show major only"),v:B6.EnumGridLines.SHOW_MAJOR_ONLY},{n:mstrmojo.desc(2772,"Hide"),v:B6.EnumGridLines.HIDE}],C3,{groupTitle:Cy,fnChange:function(C8){C6.onTargetSelectionChanged(C0,C8);C6.sendNonShapeTargetSelectionIdentity(C0);if(this._sync){return ;}C2.setFormatPropertyValue(C3,C8);}});C6.registerSelector(C0,C1);var Cz=C2.generateSmartName(BR+Ax,Bi),C4=C2.generateSmartName(Bm,Bi),C7=C2.generateSmartName(N,Bi);var C5=CO.call(this,null,C2.getSmartNamesMapForLineGroup(null,"allGridLn"),{lineTitle:mstrmojo.desc(13927,"Line"),controlName:"GridLineGroup",showNoneOption:false,groupTitle:Cy,showNoFillInColor:false,listenFormatProps:[Cz,C3],showGradient:false,onFmtPropsChanged:function(C9,DE){if(C9===Cz||C9===C3){var C8=true,DA=C2.getFormatPropertyValue(C4),DF=C2.getFormatPropertyValue(C7);if(C2.getVisProfile(CP)&&!DA&&!DF){C8=false;}else{if(C2.getVisProfile(AE)){var DC=C2.vis.getChartInfo();if(DC.dirc===B6.EnumABLDirection.HORIZONTAL&&!DA){C8=false;}else{if(DC.dirc===B6.EnumABLDirection.VERTICAL&&!DF){C8=false;}}}}this.getCtrlContainer().parent.set("enabled",C8);var DB=C2.getFormatPropertyValue(C3),DD=(DB===B6.EnumGridLines.AUTO&&!C2.vis.isMajorGridLineShow())||DB===B6.EnumGridLines.HIDE;this.getCtrlContainer().set("enabled",C8&&!DD);}else{this.onFmtPropsChangedDefault(C9,DE);}}});return[Cy,C1,C5];}}function CN(Cy){var Cz=this.getHost().scriptClass==="mstrmojo.ngm.VisNewGraphMatrix";if(Cz){this.replaceChildControls(Cy,[this.getEditorGroup(Ao.call(this),BE),this.getEditorGroup(AI.call(this),A0.copy(BE,CY)),this.getEditorGroup(Aq.call(this),BE)]);}else{this.replaceChildControls(Cy,[this.getEditorGroup(Ao.call(this),BE),this.getEditorGroup(Ce.call(this),BE),this.getEditorGroup(AI.call(this),A0.copy(BE,CY)),this.getEditorGroup(Aq.call(this),BE)]);}}function AQ(Cz){var Cy=[];Cy.push(this.getEditorGroup(CA.call(this),B1));Cy.push(this.getEditorGroup(Ct.call(this),B1));Cy.push(this.getEditorGroup(Q.call(this),BE));Cy.push(this.getEditorGroup(Ae.call(this),BE));Cy.push(this.getEditorGroup([this.getMoreOptionsEditorLink(this.getHost().model.data.gsi.prop)],BE));this.replaceChildControls(Cz,Cy);}function CA(){var C0=this.broker,Cy=C0.generateSmartName(null,Cw.TOTAL_SHOW),C4=C0.generateSmartName(null,Cw.TOTAL_LABEL),Cz=x.call(this,mstrmojo.desc(2121,"Total")),C1=CF.call(this,mstrmojo.desc(15772,"Show total"),Cy,{groupTitle:Cz,listenFormatProps:[Cy],onFmtPropsChanged:function(C5,C6){if(C5===Cy){this.onFmtPropsChangedDefault(C5,C6);}}}),C3=new mstrmojo.Label({text:mstrmojo.desc(8263,"Label")}),C2=k(C3,e.call(this,null,C4,{dtp:t.VARCHAR,onValid:function(){if(this._sync){return ;}C0.setFormatPropertyValue(this.smartNames[0],this.value);},groupTitle:Cz,listenFormatProps:[Cy],onFmtPropsChanged:function(C5,C6){if(C5===Cy){this.set("enabled",C6);C3.parent.set("enabled",C6);}else{this.onFmtPropsChangedDefault(C5,C6);}}}),"50%","50%");this.addDisposable([Cz,C1,C2]);return[Cz,C1,C2];}function Ct(){var C1=this.broker,C4=C1.generateSmartName(null,Cw.INT_SUM_SHOW),C3=C1.generateSmartName(null,Cw.INT_SUM_FULL),C0=x.call(this,mstrmojo.desc(9713,"Subtotal")),C2=C1.getVisProfile(Bg)||C1.getVisProfile(AH),Cz=CF.call(this,mstrmojo.desc(3720,"Show subtotals"),C4,{groupTitle:C0,listenFormatProps:[C4],onFmtPropsChanged:function(C5,C6){if(!C2){this.parent.set("enabled",false);}if(C5===C4){this.onFmtPropsChangedDefault(C5,C6&&C2);}}}),Cy=CF.call(this,mstrmojo.desc(15773,"Cumulative subtotals"),C3,{groupTitle:C0,listenFormatProps:[C4],onFmtPropsChanged:function(C5,C6){if(C5===C4){this.parent.set("enabled",C6&&C2);}else{this.onFmtPropsChangedDefault(C5,C6&&C2);}}});this.addDisposable([C0,Cz,Cy]);return[C0,Cz,Cy];}function Q(){var C4=this.broker,C2=this.broker.vis,C3=C4.generateSmartName(null,Cw.TOTAL_SHOW),Cy=C4.generateSmartName(null,Cw.INT_SUM_SHOW),C7=Ca.decodeColor(C2.getWidgetPropertyValue(Cw.POSITIVE_COLOR)),C1=Ca.decodeColor(C2.getWidgetPropertyValue(Cw.NEGATIVE_COLOR)),C9=Ca.decodeColor(C2.getWidgetPropertyValue(Cw.TOTAL_COLOR)),DC=Ca.decodeColor(C2.getWidgetPropertyValue(Cw.INT_SUM_COLOR)),C8=C4.getVisProfile(Bg)||C4.getVisProfile(AH),Cz=x.call(this,mstrmojo.desc(6242,"Color")),DB=k(new mstrmojo.Label({text:mstrmojo.desc(8314,"Increase")}),g.call(this,null,C4.generateSmartName(null,Cw.POSITIVE_COLOR),{groupTitle:Cz,showGradient:false,showAutomatic:true,selectedValue:C7,onFmtPropsChanged:function DA(DD,DG){var DF=Ca.decodeColor(C2.property.defaultsObj[DD]),DE=DG==="default"||DG===DF;this.syncControl(function(){this.set("autoPreviewColor",DE?DF:null);});}}),"60%","40%"),C5=k(new mstrmojo.Label({text:mstrmojo.desc(8315,"Decrease")}),g.call(this,null,C4.generateSmartName(null,Cw.NEGATIVE_COLOR),{groupTitle:Cz,showGradient:false,showAutomatic:true,selectedValue:C1,onFmtPropsChanged:function DA(DD,DG){var DE=DG==="default",DF=Ca.decodeColor(C2.property.defaultsObj[DD]);this.syncControl(function(){this.set("autoPreviewColor",DE?DF:null);});}}),"60%","40%"),C6=k(new mstrmojo.Label({text:mstrmojo.desc(2121,"Total")}),g.call(this,null,C4.generateSmartName(null,Cw.TOTAL_COLOR),{groupTitle:Cz,showGradient:false,listenFormatProps:[C3],showAutomatic:true,selectedValue:C9,onFmtPropsChanged:function DA(DD,DG){var DE=DG==="default",DF=Ca.decodeColor(C2.property.defaultsObj[DD]);this.syncControl(function(){this.set("autoPreviewColor",DE?DF:null);});if(DD===C3){this.parent.set("enabled",DG);}}}),"60%","40%"),C0=k(new mstrmojo.Label({text:mstrmojo.desc(1912,"Subtotals")}),g.call(this,null,C4.generateSmartName(null,Cw.INT_SUM_COLOR),{groupTitle:Cz,listenFormatProps:[Cy],showGradient:false,showAutomatic:true,selectedValue:DC,onFmtPropsChanged:function DA(DD,DG){var DE=DG==="default",DF=Ca.decodeColor(C2.property.defaultsObj[DD]);this.syncControl(function(){this.set("autoPreviewColor",DE?DF:null);});if(DD===Cy){this.parent.set("enabled",DG&&C8);}}}),"60%","40%");this.addDisposable([Cz,DB,C5,C6,C0]);return[Cz,DB,C5,C6,C0];}function CE(){var Cy=this.broker,C2=Cy.vis,C4=C2.GMController,C0=Cy.generateSmartName(null,Cw.CONTAINER_FIT_MODE),C3,Cz,C1=[{n:mstrmojo.desc(4531,"Automatic"),v:B.AUTOMATIC},{n:mstrmojo.desc(12058,"Fit To Container"),v:B.FIT_TO_CONTAINER},{n:mstrmojo.desc(16039,"Fit To Content"),v:B.FIT_TO_CONTENT}];if(C4.isHistogram){C1.pop();}Cz=new mstrmojo.Label({text:mstrmojo.desc(14795,"Container fit:")});C3=BZ.call(this,null,C1,C0,{onFmtPropsChanged:function(C5,C6){this.onFmtPropsChangedDefault(C5,C6);}});this.addDisposable([Cz,C3]);return[Cz,C3];}function Cg(Cz){var Cy=[];Cy.push(this.getEditorGroup(B0.call(this),BE));Cy.push(this.getEditorGroup(Ae.call(this),BE));Cy.push(this.getEditorGroup([this.getMoreOptionsEditorLink(this.getHost().model.data.gsi.prop)],BE));this.replaceChildControls(Cz,Cy);}function B0(){var C2=this.broker,Cz,C8=C2.generateSmartName(null,Cw.MANUAL_BINS_MODE),C7=C2.generateSmartName(null,Cw.CUSTOM_BINS_MODE),Cy=x.call(this,mstrmojo.desc(15767,"Bin Configuration"));var C9,DB,C3,DD,Cz,DA,C1,C6,C5,DC,DB;Cz=BZ.call(this,new mstrmojo.Label({text:mstrmojo.desc(8262,"Manual")}),[{n:mstrmojo.desc(15687,"By Number of Bins"),v:B6.EnumHistogram.BY_BIN_NUMBER},{n:mstrmojo.desc(15688,"By Bin Size"),v:B6.EnumHistogram.BY_BIN_SIZE}],C8,{enabled:this.broker.getFormatPropertyValue(C7)===B6.EnumHistogram.MANUAL,visible:true,listenFormatProps:[C7],onFmtPropsChanged:function(DE,DF){if(DE===C7){this.set("enabled",DF===B6.EnumHistogram.MANUAL);}else{this.onFmtPropsChangedDefault(DE,C.toLocaleString(DF));}}});DA=CF.call(this,mstrmojo.desc(12143,"Automatic"),null,{listenFormatProps:[C7],onFmtPropsChanged:function(DF,DE){if(DF===C7){this.checked=DE===B6.EnumHistogram.AUTOMATIC;}},oncheckedChange:function(){if(this.sync){return ;}var DE=this.checked?B6.EnumHistogram.AUTOMATIC:B6.EnumHistogram.MANUAL;this.broker.vis.setWidgetPropertyValue(Cw.HAS_UNCHECKED_AUTO,true);this.broker.setFormatPropertyValue(C7,DE);}});C3=new mstrmojo.Label({text:mstrmojo.desc(15692,"Bin Qty")});C1=e.call(this,null,C2.generateSmartName(null,Cw.NUM_BINS),{constraints:{trigger:mstrmojo.validation.TRIGGER.ONBLUR,min:1,max:500},visible:this.broker.getFormatPropertyValue(C7)===B6.EnumHistogram.MANUAL&&this.broker.getFormatPropertyValue(C8)===B6.EnumHistogram.BY_BIN_NUMBER,listenFormatProps:[C8,C7],onFmtPropsChanged:function(DE,DF){if(DE===C8){C3.set("visible",DF===B6.EnumHistogram.BY_BIN_NUMBER&&(C2.getFormatPropertyValue(C7)===B6.EnumHistogram.MANUAL));if(this.parent){CC.toggleClass(this.parent.domNode,"hiddenPP",!(DF===B6.EnumHistogram.BY_BIN_NUMBER&&(C2.getFormatPropertyValue(C7)===B6.EnumHistogram.MANUAL)));}if(!(C2.vis.getWidgetPropertyValue(Cw.HAS_UNCHECKED_AUTO))&&DF===B6.EnumHistogram.BY_BIN_NUMBER&&(C2.getFormatPropertyValue(C7)===B6.EnumHistogram.MANUAL)){this.set("value",C2.getFormatPropertyValue("numBins"));}this.set("visible",DF===B6.EnumHistogram.BY_BIN_NUMBER&&(C2.getFormatPropertyValue(C7)===B6.EnumHistogram.MANUAL));}else{if(DE===C7){this.set("visible",DF===B6.EnumHistogram.MANUAL&&C2.getFormatPropertyValue(C8)===B6.EnumHistogram.BY_BIN_NUMBER);C3.set("visible",DF===B6.EnumHistogram.MANUAL&&C2.getFormatPropertyValue(C8)===B6.EnumHistogram.BY_BIN_NUMBER);if(this.parent){CC.toggleClass(this.parent.domNode,"hiddenPP",!(this.visible));}}else{this.onFmtPropsChangedDefault(DE,C.toLocaleString(DF));}}}});DD=k(C3,C1,"40%","60%");var C4={min:this.broker.vis.GMController.getExtremes(0,1).YMinValue,max:this.broker.vis.GMController.getExtremes(0,1).YMaxValue};C2.generateSmartName(null,Cw.XBINS_START);C2.generateSmartName(null,Cw.XBINS_END);var C0=C2.generateSmartName(null,Cw.RANGE_TYPE);C6=new mstrmojo.Label({text:mstrmojo.desc(16179,"Bin Range")});C5=CF.call(this,mstrmojo.desc(12552,"Custom range"),C0,{listenFormatProps:[C8],onFmtPropsChanged:function(DE,DF){if(DE===C8&&DF===B6.EnumHistogram.BY_BIN_SIZE&&!this.broker.vis.getWidgetPropertyValue(Cw.HAS_UNCHECKED_DATASET_RANGE)){}else{if(DE===C7){this.set("visible",DF===B6.EnumHistogram.MANUAL&&this.broker.getFormatPropertyValue(C8)===B6.EnumHistogram.BY_BIN_NUMBER);}}},oncheckedChange:function(){if(this.sync){return ;}if(this.checked){C2.setFormatPropertyValue(Cw.HAS_UNCHECKED_DATASET_RANGE,true);DC.min.set("enabled",true);DC.max.set("enabled",true);DC.max.setValue(this.broker.vis.getWidgetPropertyValue(Cw.XBINS_END));DC.max.hint=DC.max.value;DC.min.setValue(this.broker.vis.getWidgetPropertyValue(Cw.XBINS_START));DC.min.hint=DC.min.value;DB.children[1].onFmtPropsChanged(Cw.XBINS_SIZE,this.broker.vis.getWidgetPropertyValue(Cw.XBINS_SIZE));if(C2.vis.getWidgetPropertyValue(Cw.RANGE_TYPE)!==B6.EnumHistogram.CUST_INPUT){C2.setFormatPropertyValue(Cw.RANGE_TYPE,B6.EnumHistogram.CUST_INPUT);C2.vis.clientRerenderGraphMatrix();}}else{DC.max.set("enabled",false);DC.min.set("enabled",false);DC.max.setValue(C4.max);DC.max.hint=C4.max;DC.min.setValue(C4.min);DC.min.hint=C4.min;if(C2.vis.getWidgetPropertyValue(Cw.RANGE_TYPE)!==B6.EnumHistogram.DATASET){C2.setFormatPropertyValue(Cw.RANGE_TYPE,B6.EnumHistogram.DATASET);C2.vis.clientRerenderGraphMatrix();}}}});DC=new mstrmojo.ui.editors.controls.CustomRange({alias:"rangeCtrl",range:C4,data:{newRangeValid:true,rangeKeysChanged:[],autoKeysChanged:[]},scriptClass:"mstrmojo.ui.editors.controls.CustomRange",rangeConstraints:{min:{min:null,max:null},max:{min:null,max:null}},rangeChanged:function(){var DF=this.getRange(),DG=DF.customMin,DE=DF.customMax;C2.setFormatPropertyValue(Cw.XBINS_START,DG);C2.setFormatPropertyValue(Cw.XBINS_END,DE);C2.vis.clientRerenderGraphMatrix();}});C9=new mstrmojo.Label({text:mstrmojo.desc(16187,"Bin Size")});DB=k(C9,e.call(this,null,C2.generateSmartName(null,Cw.XBINS_SIZE),{visible:this.broker.getFormatPropertyValue(C7)===B6.EnumHistogram.MANUAL&&this.broker.getFormatPropertyValue(C8)===B6.EnumHistogram.BY_BIN_SIZE,listenFormatProps:[C8,C7],onFmtPropsChanged:function(DE,DG){if(DE===C8){var DH=this.broker.getFormatPropertyValue(C7),DF=DH===B6.EnumHistogram.MANUAL;this.set("visible",DG===B6.EnumHistogram.BY_BIN_SIZE&&DF);if(this.parent){CC.toggleClass(this.parent.domNode,"hiddenPP",!(DG===B6.EnumHistogram.BY_BIN_SIZE&&DF));}C6.set("visible",DG===B6.EnumHistogram.BY_BIN_SIZE&&DF);C5.set("visible",DG===B6.EnumHistogram.BY_BIN_SIZE&&DF);C9.set("visible",DG===B6.EnumHistogram.BY_BIN_SIZE&&DF);DC.set("visible",DG===B6.EnumHistogram.BY_BIN_SIZE&&DF);if(C2.vis.getWidgetPropertyValue(Cw.RANGE_TYPE)===B6.EnumHistogram.DATASET){DC.max.set("enabled",false);DC.min.set("enabled",false);}if(!(C2.vis.getWidgetPropertyValue(Cw.HAS_UNCHECKED_AUTO))&&DG===B6.EnumHistogram.BY_BIN_SIZE&&DF){this.set("value",C2.getFormatPropertyValue("xBinsSize"));}}else{if(DE===C7){if(DG===B6.EnumHistogram.AUTOMATIC){this.set("visible",false);if(this.parent){CC.toggleClass(this.parent.domNode,"hiddenPP",true);}C9.set("visible",false);C6.set("visible",false);C5.set("visible",false);DC.set("visible",false);}else{if(DG===B6.EnumHistogram.MANUAL&&C2.getFormatPropertyValue(C8)===B6.EnumHistogram.BY_BIN_SIZE){this.set("visible",true);if(this.parent){CC.toggleClass(this.parent.domNode,"hiddenPP",false);}C9.set("visible",true);C6.set("visible",true);C5.set("visible",true);DC.set("visible",true);if(C2.vis.getWidgetPropertyValue(Cw.RANGE_TYPE)===B6.EnumHistogram.DATASET){DC.max.set("enabled",false);DC.min.set("enabled",false);}}}}else{this.onFmtPropsChangedDefault(DE,C.toLocaleString(DG));}}}}),"50%","50%");if(this.broker.getFormatPropertyValue(C7)===B6.EnumHistogram.MANUAL&&this.broker.getFormatPropertyValue(C8)===B6.EnumHistogram.BY_BIN_SIZE&&this.broker.vis.getWidgetPropertyValue(Cw.RANGE_TYPE)!==B6.EnumHistogram.DATASET){C9.set("visible",true);DC.set("visible",true);DC.max.setValue(this.broker.vis.getWidgetPropertyValue(Cw.XBINS_END));DC.max.hint=this.broker.vis.getWidgetPropertyValue(Cw.XBINS_END);DC.min.setValue(this.broker.vis.getWidgetPropertyValue(Cw.XBINS_START));DC.min.hint=this.broker.vis.getWidgetPropertyValue(Cw.XBINS_START);DC.range={min:this.broker.vis.getWidgetPropertyValue(Cw.XBINS_START),max:this.broker.vis.getWidgetPropertyValue(Cw.XBINS_END)};}if(this.broker.getFormatPropertyValue(C0)===B6.EnumHistogram.CUST_INPUT){C5.getCtrl().set("checked",true);}this.addDisposable([Cy,DA,Cz,DD,C6,C5,DC,DB]);return[Cy,DA,Cz,DD,C6,C5,DC,DB];}function AL(Cz){var Cy=[];Cy.push(this.getEditorGroup(a.call(this),BE));Cy.push(this.getEditorGroup(P.call(this),BE));Cy.push(this.getEditorGroup(Ae.call(this),BE));Cy.push(this.getEditorGroup([this.getMoreOptionsEditorLink(this.getHost().model.data.gsi.prop)],BE));this.replaceChildControls(Cz,Cy);}function P(){var Cz=this.broker,C1=Cz.generateSmartName(null,Cw.MEAN_SD),C0=new mstrmojo.Label({text:mstrmojo.desc(13952,"Other Parameters:")}),Cy=BZ.call(this,null,[{n:mstrmojo.desc(15317,"No Mean"),v:B6.EnumBoxPlotMean.NO_MEAN},{n:mstrmojo.desc(15318,"Only Mean"),v:B6.EnumBoxPlotMean.ONLY_MEAN},{n:mstrmojo.desc(15319,"Mean and Standard Deviation"),v:B6.EnumBoxPlotMean.MEAN_STDEV}],C1);this.addDisposable([C0,Cy]);return[C0,Cy];}function a(){var Cy=this.broker,C3=Cy.generateSmartName(null,Cw.SHOW_OUTLIERS),C2=Cy.generateSmartName(null,Cw.JITTER);var C4=function(){var C6=this.typeHelper;C6.updateSelection();if(this.enabled){var C7=this.selectedIndex;this.broker.setFormatPropertyValue(C2,C.parseNumeric(this.items[C7].v));this.broker.vis.clientRerenderGraphMatrix();}};var C5=Af.call(this,C4,0,1,0.01,null,{isHoriz:true,min:0,max:1,enabled:true,listenFormatProps:[C3],onFmtPropsChanged:function(C6){if(C6===C3){this.set("enabled",C0.getCtrl().checked);if(!this.enabled){CC.addWidgetCssClass(this,"disabled");Cz.domNode&&Cz.domNode.classList.add("disabled");this.selectedIndex=0;this.selectedIndices={};this.selectedIndices[0]=true;this.selectedItem=this.items[0];this.refresh();}else{this.domNode&&this.domNode.classList.remove("disabled");Cz.domNode&&Cz.domNode.classList.remove("disabled");}}},reInit:function C1(){this.getCtrlContainer().set("enabled",C0.getCtrl().checked);if(this.enabled){var C6=Math.min(Math.floor(C.parseNumeric(this.broker.vis.getWidgetPropertyValue("jitter"))*100),99);this.selectedIndex=C6;this.selectedIndices={};this.selectedIndices[C6]=true;this.selectedItem=this.items[C6];}this.reInitDefault();}});var C0=CF.call(this,mstrmojo.desc(15309,"Show all points"),C3,{oncheckedChange:function(){if(this._sync){return ;}var C6=this.checked?B6.EnumBoxPlotOutliers.ALL_POINTS:B6.EnumBoxPlotOutliers.OUTLIERS;this.broker.setFormatPropertyValue(C3,C6);if(!this.checked){this.broker.setFormatPropertyValue(C2,0);C5.reInit();}},onFmtPropsChanged:function(C7){if(C7===C3){var C6=this.broker.vis.getWidgetPropertyValue(C3)===B6.EnumBoxPlotOutliers.ALL_POINTS;this.set("checked",C6);}}});var Cz=new mstrmojo.Label({text:mstrmojo.desc(null,"Jitter (0.00 - 1.0):")});this.addDisposable([C0,Cz,C5]);return[C0,Cz,C5];}function j(){var C6=this.broker,DB=C6.editorManager,C4=G,C7=C4+Ax,Cz=C8(Bi);function C5(){return{highlightObjects:[(BP.ROW_HEADER|BP.COL_HEADER|BP.ROW_TITLE|BP.COL_TITLE),(BP.ROW_HEADER|BP.ROW_TITLE),(BP.COL_HEADER|BP.COL_TITLE),BP.ROW_TITLE,BP.COL_TITLE,BP.ROW_HEADER,BP.COL_HEADER]};}function C8(DC){return C6.generateSmartName(C7,DC);}function C3(){return{listenFormatProps:[Cz],onFmtPropsChanged:function(DC,DD){if(DC===Cz){this.getCtrlContainer().set("enabled",DD);}else{this.onFmtPropsChangedDefault(DC,DD);}}};}var Cy=x.call(this,mstrmojo.desc(1013,"Text"),A0.copy(C5(),{scopeSelectors:[C4]})),C2=F.call(this,null,C4,[{n:mstrmojo.desc(3524,"All"),identity:(BP.ROW_HEADER|BP.COL_HEADER|BP.ROW_TITLE|BP.COL_TITLE),prefix:"allRwCol",v:0},{n:mstrmojo.desc(13665,"Row Text"),identity:(BP.ROW_HEADER|BP.ROW_TITLE),prefix:BW,v:1},{n:mstrmojo.desc(13666,"Column Text"),identity:(BP.COL_HEADER|BP.COL_TITLE),prefix:AD,v:2},{n:mstrmojo.desc(12014,"Row Headers"),identity:BP.ROW_TITLE,prefix:BF,v:3},{n:mstrmojo.desc(12015,"Column Headers"),identity:BP.COL_TITLE,prefix:Br,v:4},{n:mstrmojo.desc(12016,"Row Values"),identity:BP.ROW_HEADER,prefix:"rwVl",v:5},{n:mstrmojo.desc(12017,"Column Values"),identity:BP.COL_HEADER,prefix:"colVl",v:6}],DB,A0.copy(C5(),{groupTitle:Cy})),C1=CF.call(this,mstrmojo.desc(14315,"Show text"),Cz,{groupTitle:Cy}),C0=BI.call(this,null,C6.getSmartNamesMapForFontGroup(C7,"Txt"),A0.copy(C3(),{controlName:"RowsAndColsFontGroup",groupTitle:Cy,syncWithAllText:true})),DA=Ay.call(this,null,[{n:mstrmojo.desc(3049,"Left"),v:B6.EnumTextAlignH.LEFT,css:"left"},{n:mstrmojo.desc(2193,"Center"),v:B6.EnumTextAlignH.MIDDLE,css:"center"},{n:mstrmojo.desc(2166,"Right"),v:B6.EnumTextAlignH.RIGHT,css:"right"}],C8(Cn),A0.copy(C3(),{cssClass:"txtAlign",showIcon:true,groupTitle:Cy})),C9=Ay.call(this,null,[{n:mstrmojo.desc(2256,"Top"),v:B6.EnumTextAlignV.TOP,css:"top"},{n:mstrmojo.desc(8631,"Middle"),v:B6.EnumTextAlignV.MIDDLE,css:"middle"},{n:mstrmojo.desc(2257,"Bottom"),v:B6.EnumTextAlignV.BOTTOM,css:"bottom"}],C8(Bf),A0.copy(C3(),{cssClass:"verticalAlign",showIcon:true,groupTitle:Cy}));return[Cy,C2,C1,C0,DA,C9];}function AM(){var C1=this.broker,C4=C1.editorManager,C2=BX,Cy=C2+Ax,C3=BU+Ax;var C0=x.call(this,mstrmojo.desc(3905,"Background"),{highlightObjects:[BP.ROWS_BACKGROUND,BP.COLS_BACKGROUND],scopeSelectors:[C2]}),Cz=C1.getSmartNamesMapForFillGroup(Cy);return[C0,F.call(this,null,C2,[{n:mstrmojo.desc(2968,"Rows"),prefix:BF,identity:BP.ROWS_BACKGROUND,v:0},{n:mstrmojo.desc(122,"Columns"),prefix:Br,identity:BP.COLS_BACKGROUND,v:1}],C4,{highlightObjects:[BP.ROWS_BACKGROUND,BP.COLS_BACKGROUND],groupTitle:C0}),Cv.call(this,mstrmojo.desc(2885,"Fill"),Cz,{listenFormatProps:A0.valarray(this.broker.getSmartNamesMapForFillGroup(C3)),controlName:"BackgroundFillGroup",groupTitle:C0,showGradient:false})];}function AV(){var Cz=this.broker,C2=Cz.editorManager,C0=Bs,Cy=C0+Ax;var C1=x.call(this,mstrmojo.desc(12050,"Matrix Lines"),{highlightObjects:[(BP.H_MATRIX_LINE|BP.V_MATRIX_LINE),BP.H_MATRIX_LINE,BP.V_MATRIX_LINE],scopeSelectors:[C0]});return[C1,F.call(this,null,C0,[{n:mstrmojo.desc(11998,"All Matrix Lines"),prefix:"allMatrixLn",identity:(BP.H_MATRIX_LINE|BP.V_MATRIX_LINE),v:0},{n:mstrmojo.desc(11999,"Horizontal Matrix Lines"),prefix:"hMatrixLn",identity:BP.H_MATRIX_LINE,v:1},{n:mstrmojo.desc(12000,"Vertical Matrix Lines"),prefix:"vMatrixLn",identity:BP.V_MATRIX_LINE,v:2}],C2,{highlightObjects:[(BP.H_MATRIX_LINE|BP.V_MATRIX_LINE),BP.H_MATRIX_LINE,BP.V_MATRIX_LINE],groupTitle:C1}),CO.call(this,null,Cz.getSmartNamesMapForLineGroup(Cy),{lineTitle:mstrmojo.desc(13927,"Line"),controlName:"MatrixLineGroup",groupTitle:C1,showNoFillInColor:false,showGradient:false})];}function Cr(Cy){this.replaceChildControls(Cy,[this.getEditorGroup(j.call(this),B1),this.getEditorGroup(AM.call(this),BE),this.getEditorGroup(AV.call(this),BE)]);}function I(Cy){var C1=this.broker.vis,C0=Cj(C1.zonesModel,mstrmojo.vi.viz.EnumDSSDropZones.ColorBy),C2=C0[0],Cz=C1.model.xtab.gridInfo,C4=Cz.mx,C3=Cz.thresholds[C2.id];return this.getLabelAndControl(mstrmojo.desc(6242,"Color"),this.addDisposable(new mstrmojo.vi.ui.ColorRangeSelector({thresholds:C3,metric:C4[Cc.find(C4,"did",C2.id)],postclick:Cy,onclick:function(){C1.model.openThresholdEditor(C0[0],true,false);}})),"30%","70%");}function Am(){var C0,Cz=[],C1=[],Cy=this.getHost().getStyleEffectsOptions(),C2=false;Cy.forEach(function(C4){var C3=C4.optLvl;if(C3===CG.ALL_SHAPE){C0=C4;}else{if(C3===CG.METRIC){Cz.push(C4);}else{if(C3===CG.COLOR_BY){if(C4.isMetricNames){C2=true;}C1=C4.subOptions||[];}}}});if(C2){Cz=[];}return{allItem:C0,metricItems:Cz,colorByItems:C1,originCollection:Cy};}function BM(){var C0=this.getHost(),DA=this.broker,DO=DA.editorManager,DK=Cj(DA.vis.zonesModel,mstrmojo.vi.viz.EnumDSSDropZones.ColorBy).length>0,DG=C0.isShapeCombonation(),DH=DG.isComb,C8=Am.call(this),DU=C8.allItem,DC=C8.metricItems,C4=C8.colorByItems;var DW="ShapeFormatting";function DJ(DY){return DA.generateSmartName(null,DW,DY,null,As);}function C6(DY){return DJ(DA.getFormatPropertyKey(DY).filedAlias+Ak);}function DM(){return function(){w(DO).call(this);DO.sendShapeOption();};}var C2=x.call(this,mstrmojo.desc(13751,"Shape Formatting")),C3=AG.call(this,{allItem:DU,metricItems:DC,colorByItems:C4},{groupTitle:C2,postclick:DM(DO)}),C7=[];function DS(){var DY=[CI.AREA,CI.LINE];if(DA.getVisProfile(AE)){DY=[];}else{if(DA.getVisProfile(CP)){DY.push(CI.BAR);}}return Cc.filter([{n:mstrmojo.desc(12097,"Bar"),v:CI.BAR},{n:mstrmojo.desc(12098,"Line"),v:CI.LINE},{n:mstrmojo.desc(12099,"Area"),v:CI.AREA},{n:mstrmojo.desc(12100,"Circle"),v:CI.CIRCLE},{n:mstrmojo.desc(12101,"Square"),v:CI.SQUARE},{n:mstrmojo.desc(12102,"Tick"),v:CI.TICK},{n:mstrmojo.desc(12103,"Ring"),v:CI.RING},{n:mstrmojo.desc(12104,"Pie"),v:CI.PIE}],function(DZ){return DY.indexOf(DZ.v)===-1;});}var DN=[CI.BAR,CI.AREA,CI.CIRCLE,CI.SQUARE],Cz=[CI.LINE,CI.TICK],DD=function DD(){var DY=C3.value&&C3.value.optLvl;return(C4.length>0&&DY!==CG.ALL_SHAPE&&DY!==CG.METRIC)||(C4.length===0&&DY===CG.ALL_SHAPE);},DX=function DX(Db,DY){if(DY){A0.copy({col1Node:"58%",col2Node:"42%"},Db.layoutConfig.w);var DZ=3;A0.copy({cssText:"margin-left: "+DZ+"px;",getLayoutOffsets:function Da(){return{h:0,w:DZ};}},Db.getCtrl());}return Db;};function DE(Da,DY,Dd,De){var Dc={postclick:DM(DO),groupTitle:C2,preBuildRendering:Cm,onRender:function(){this.reInit();}},DZ=C6(DY);if(!Da){A0.copy({reInit:function(){var Df=DD();if(Dd){this.getCtrlContainer().set("enabled",Df);}else{this.setChildEnable(Bn,Df);}this.reInitDefault();},onGroupValueChange:function(Df,Dg){if(DY&&Df===DY&&Dg===W.VAL_AUTOMATIC){Dg=AZ;}this.broker.setFormatPropertyValue(Df,Dg);},onFmtPropsChanged:function Db(Df,Dh){if(DY&&Df===DY){var Dg=this.broker.getFormatPropertyValue(DZ);this.syncControl(function(){this.getChildComp(Df).set("autoPreviewColor",Dg?Dh:null);this.setChildValue(Df,Dg?W.VAL_AUTOMATIC:Dh);});}else{this.onFmtPropsChangedDefault(Df,Dh);if(De&&Df===De){this.setChildEnable(Bn,DD()&&Dh!==mstrmojo.gm.EnumCombinedLineStyle.NONE);}}}},Dc);}return Dc;}var DQ=function(Db,Dc){var DZ=Db?mstrmojo.desc(13752,"Line Style"):null,DY={lineColor:DJ(Cw.SHAPE_FILL_COLOR),lineStyle:DJ(Cw.SHAPE_LINE_COMBINED_STYLE)},Dd=Db,Da=AU.override(Dc,A0.copy({controlName:"shapeLineGroup",hideColorControl:Db,showNoFillInColor:false,showAutomaticInColor:true,showNoneOption:false},DE(Db,DY.lineColor,Dd,DY.lineStyle)));if(Db){delete DY.lineColor;}return DX(CO.call(this,DZ,DY,AU.override({reInit:function(){var Df=C0.GMController,De=Cc.difference(Df.getShapeForOption(C3.value),Cz).length===0,Dg=Df.getSizeByMetrics().length>0;this.setChildEnable(DY.lineStyle,!(De&&Dg));this._super();}},Da)),Db);}.bind(this);var DT=function(Dg,Dd,Da){var Dh=mstrmojo.desc(2885,"Fill"),Db=DA.getSmartNamesMapForFillGroup(null,DW,By,"fld",null,As),DY=Dg||Dd,Df=A0.copy({controlName:"shapeFillGroup",showAutomaticInColor:true},DE(Dg,Db.fillColor,DY));if(Dg){Dh=mstrmojo.desc(13658,"Fill Opacity");delete Db.fillColor;Df.visibleControls=CB.FILL_TRANSPARENCY;}else{if(Dd){Dh=mstrmojo.desc(13753,"Shape Color");delete Db.fillAlpha;Df.visibleControls=CB.FILL_COLOR;}}var DZ=DX(Cv.call(this,Dh,Db,AU.override(Da,Df)),DY),Dc=Db.fillAlpha,De=Dc&&DZ.getCtrl().getChildComp(Dc);if(De){A0.copy(X(DA,Dc),De);}return DZ;}.bind(this);var C1=function(Db,Dc){var DZ=null,DY=DA.getSmartNamesMapForLineGroup(null,DW,n,"fld",null,As),Dd=Db,Da=A0.copy({lineTitle:mstrmojo.desc(9736,"Border"),controlName:"shapeBorderGroup",hideColorControl:Db,showNoFillInColor:false,showAutomaticInColor:true},DE(Db,DY.lineColor,Dd,DY.lineStyle));if(Db){delete DY.lineColor;DZ=mstrmojo.desc(3538,"Border Style");Da.lineTitle=null;}return DX(CO.call(this,DZ,DY,AU.override(Dc,Da)),Dd);}.bind(this);var DP=DS(),C5,C9;if(DH){C5=-1;}else{if(DG.shapeType===undefined){C9=C0.getChartInfo().shape;}else{C9=DG.shapeType;}C5=Cc.map(DP,function(DY){return DY.v;}).indexOf(C9);}var DV=this.getPulldown(DP,function(DY){C0.setWidgetPropertyValue(Ad.METRIC_SHAPES,{});C0.processChangeShape(DY);},C5,{onRender:function(){var DY=this.selectedNode;if(DY&&DH){DY.innerHTML=mstrmojo.desc(5576,"Combination");}}}),DB=this.getLabelAndControl(mstrmojo.desc(13754,"Shape Type"),DV,"40%","60%");if(DA.getVisProfile(Bc)){C7.push(DQ(DK));}else{if(DA.getVisProfile(CV)){C7.push(DT(DK),C1(DK));}else{if(DH){if(!DK){C7.push(DT(false,true));}var DR=function DR(DY){return{reInit:function(){this._super();if(DY){var DZ=C0.GMController.getShapeForOption(C3.value);this.getCtrlContainer().set("enabled",Cc.intersection(DZ,DY).length>0);}}};},DI=DQ(true,DR(Cz)),DL=DT(true,false,DR(DN)),DF=C1(false,DR(DN));C7.push(DI,DL,DF);}}}DO.shapeFormatControls=C7;var Cy=[DB,C2,C3];if(DK){Cy.splice(DC.length===1?3:2,0,I.call(this,DM(DO)));}return Cy.concat(C7);}function AP(){var Cz=this.broker;function C2(C4,C3){return Cz.generateSmartName(null,C4,C3);}var C1=C2(Cw.LINE_MARKER_SHOW),Cy=function(C3){return Cz.getVisProfile(B4)&&!Cz.getVisProfile(v)&&(Cz.vis.skipPaintedCheck||Cz.vis.interactor.isLineOrAreaPaint());};return[CF.call(this,mstrmojo.desc(13755,"Show Marker"),C1,{reInit:function C0(){this.getCtrlContainer().set("enabled",Cy(this));this.reInitDefault();}}),g.call(this,mstrmojo.desc(13756,"Marker Color"),C2(Cw.LINE_MARKER_COLOR,Cw.LINE_MARKER_COLOR),{listenFormatProps:[C1],colorDefaultSN:C2(Cw.LINE_MARKER_COLOR,Cw.LINE_MARKER_COLOR+Cw.IS_DEFAULT_VALUE),showAutomatic:true,onFmtPropsChanged:function(C3,C4){if(C3===C1){this.parent.set("enabled",C4&&Cy(this));}else{this.onFmtPropsChangedDefault(C3,C4);}}})];}function Ae(){var C3=this.broker,C2=[{n:mstrmojo.desc(2057,"None"),v:B6.EnumDataLabels.HIDE}],C5={val:{n:mstrmojo.desc(2175,"Values"),v:B6.EnumDataLabels.SHOW_VALUE_ONLY},txt:{n:mstrmojo.desc(1013,"Text"),v:B6.EnumDataLabels.SHOW_TEXT_ONLY}},Cy=false;if(C3.getVisProfile(AA)){C2.unshift(C5.val);}if(C3.getVisProfile(BC)){C2.unshift(C5.txt);}if(C2.length===1){Cc.insert(C2,0,A0.valarray(C5));Cy=true;}var C0=C3.generateSmartName(null,Ad.DATA_LABEL),C7=C3.generateSmartName(null,Ad.DATA_LABELS_PLACEMENT),C4=C3.getDataLabelItems(),Cz=C4&&C4.length>1,C6=[x.call(this,mstrmojo.desc(11993,"Data Labels"),{highlightObjects:[BP.DATA_LABEL]}),Ay.call(this,null,C2,C0,A0.copy(Cy?{enabled:false}:undefined,{cssClass:"dataLabel "+("itemsCnt"+C2.length)}))];if(this.getHost().scriptClass!=="mstrmojo.ngm.VisNewGraphMatrix"){C6.push(CF.call(this,mstrmojo.desc(14606,"Hide overlapping labels"),C7,{listenFormatProps:[C7],reInitDefault:function(){(this.listenFormatProps).forEach(function(C9){this.onFmtPropsChanged(C9,this.broker.getFormatPropertyValue(C9)!==mstrmojo.gm.EnumDataLabelPlacements.GENERIC);},this);}}));}if(Cz&&this.getHost().scriptClass!=="mstrmojo.ngm.VisNewGraphMatrix"){C6.push(AY.call(this,C4,C3.generateSmartName(null,Ad.METRIC_LEVEL_DATA_LABEL),{controlName:"DataLabelList",listenFormatProps:[C0],onFmtPropsChanged:function(C9,DB,DA){if(C9===C0){this.set("enabled",DB!==B6.EnumDataLabels.HIDE);}else{this.onFmtPropsChangedDefault(C9,DB,DA);}}}));}C6.push(BI.call(this,null,C3.getSmartNamesMapForFontGroup(CL),{controlName:"DataLabelFontGroup",syncWithAllText:true,memory:{snDataLabelType:undefined},listenFormatProps:[C0],onFmtPropsChanged:function(C9,DA){if(C9===C0){this.memory.snDataLabelType=DA;this.set("enabled",this.memory.snDataLabelType!==B6.EnumDataLabels.HIDE);}else{this.onFmtPropsChangedDefault(C9,DA);}}}));if(this.getHost().scriptClass==="mstrmojo.ngm.VisNewGraphMatrix"){var C1=new mstrmojo.Label({text:mstrmojo.desc(15647,"Rotation")});var C8=k(C1,BZ.call(this,null,[{n:mstrmojo.desc(12286,"Horizontal"),v:0},{n:mstrmojo.desc(12285,"Vertical"),v:270}],C3.generateSmartName(null,Ad.DATA_LABEL_TEXT_ANGLE),{listenFormatProps:[C0],onFmtPropsChanged:function(C9,DB,DA){if(C9===C0){this.parent.set("enabled",(DB!==B6.EnumDataLabels.HIDE));}else{this.onFmtPropsChangedDefault(C9,DB,DA);}}}),"40%","60%");C6.push(C8);}return C6;}function l(Cz){var Cy=[];if(this.getHost().scriptClass!=="mstrmojo.ngm.VisNewGraphMatrix"){Cy.push(this.getEditorGroup(BM.call(this),B1));if(this.broker.getVisProfile(B4)){Cy.push(this.getEditorGroup(AP.call(this),BE));}}Cy.push(this.getEditorGroup(Ae.call(this),BE));this.replaceChildControls(Cz,Cy);}mstrmojo.vi.models.editors.GMEditorModel=mstrmojo.declare(mstrmojo.vi.models.editors.BaseEditorModel,null,{scriptClass:"mstrmojo.vi.models.editors.GMEditorModel",help:"format_panel_graph.htm",broker:null,init:function Cs(Cy){this._super(Cy);this.broker=this.addDisposable(new mstrmojo.vi.models.editors.GMBroker({vis:this.getHost()}));},getInitialTarget:function A7(){return Y;},getEditorContents:function BO(C7){var C2=this._targetPulldown,C4=C2?[C2.id]:[];Ca.handleDestroy(this,["mstrmojo.vi.models.editors.GMBroker"],C4);var C6=this.addDisposable(new mstrmojo.vi.models.editors.GMEditorManager({host:this.getHost(),model:this}));C6.initializing=true;var C1=this.broker;if(C1.editorManager){C1.detachEditorRuntime().destroy();}this.broker.attachEditorRuntime(C6);C6.initIdentityPanelMapping();var C0=this._super(C7),Cy=this.id,C5=C0[0],C3=function(){var C8=mstrmojo.all[Cy];if(!C5.hasRendered){CC.addWidgetCssClass(C5,[(C8._hilightGMTitle?"hilightGMTitle":""),(C8._hilightGMContainer?"hilightGMContainer":"")]);}else{CC.toggleClass(C5.domNode,"hilightGMTitle",C8._hilightGMTitle);CC.toggleClass(C5.domNode,"hilightGMContainer",C8._hilightGMContainer);}};C3();this.onHighlightObjChange=function Cz(C8){var C9=mstrmojo.all[Cy];C9._hilightGMTitle=A1([BP.VIZ_BOX_TITLE],C8);C9._hilightGMContainer=A1([BP.VIZ_BOX_CONTAINER],C8);C3();};C1.editorManager._hilightObjListens.push(this);C6.initializing=false;return C0;},getTargetPulldownItems:function q(Cz){var C2=this._super(Cz),C1=C2.length>0,Cy=this.broker,C5=this.getHost(),C4=C5.GMController,C0=C5.scriptClass==="mstrmojo.ngm.VisNewGraphMatrix",C3=function(C6){return function(C8){var C9=this._targetPulldown,C7=C9?[C9.id]:[];Cy.editorManager.clearControlsReference();Ca.handleDestroy(this,["mstrmojo.vi.models.editors.GMBroker","mstrmojo.vi.models.editors.GMEditorManager"],C7);C6.bind(this,Cz)(C8);}.bind(this);}.bind(this);if(Cy.getVisProfile(Aa)||C5.excludeData||C5.noData){return C2;}if(C4.isBoxPlot){this.help="Format_Panel_Box_Plot.htm";C2.push({n:mstrmojo.desc(11974,"Data Exploration"),v:Y,h:C3(CM)});C2.push({n:mstrmojo.desc(15307,"Box Plot Options"),v:BH,h:C3(AL)});C2.push({n:mstrmojo.desc(13931,"Axis Lines and Labels"),v:Bu,h:C3(CN)});if(Cy.getVisProfile(Aj)){C2.push({n:mstrmojo.desc(2403,"Legend"),v:O,h:C3(AT)});}return C2;}else{if(C4.isHistogram){this.help="Format_Panel_Histogram.htm";if(C4.view.gridInfo.mx.length){C2.push({n:mstrmojo.desc(11974,"Data Exploration"),v:Y,h:C3(CM)});C2.push({n:mstrmojo.desc(15322,"Histogram Options"),v:BV,h:C3(Cg)});C2.push({n:mstrmojo.desc(13931,"Axis Lines and Labels"),v:Bu,h:C3(CN)});return C2;}}else{if(C4.isWaterfall){this.help="Format_Panel_Waterfall.htm";C2.push({n:mstrmojo.desc(11974,"Data Exploration"),v:Y,h:C3(CM)});C2.push({n:mstrmojo.desc(15383,"Waterfall Options"),v:Ck,h:C3(AQ)});C2.push({n:mstrmojo.desc(13931,"Axis Lines and Labels"),v:Bu,h:C3(CN)});return C2;}}}if(!C0){C2.push({n:mstrmojo.desc(11974,"Data Exploration"),v:Y,h:C3(Ac)});if(Cy.getVisProfile(Bh)){C2.push({n:mstrmojo.desc(12018,"Trend Lines"),v:CR,h:C3(BD)});C2.push({n:mstrmojo.desc(12030,"Reference Lines"),v:Bt,h:C3(K)});}C2.push({cls:"separator"});}else{C2.push({n:mstrmojo.desc(11974,"Data Exploration"),v:Y,h:C3(CM)});}if(C1){C2.push(C2.shift());}if(Cy.getVisProfile(An)||Cy.getVisProfile(Aj)){C2.push({n:mstrmojo.desc(2403,"Legend"),v:O,h:C3(AT)});}C2.push({n:mstrmojo.desc(13931,"Axis Lines and Labels"),v:Bu,h:C3(CN)});if(!C0){C2.push({n:mstrmojo.desc(11978,"Rows and Columns"),v:AX,h:C3(Cr)});}C2.push({n:mstrmojo.desc(13757,"Shapes and Data Labels"),v:CS,h:C3(l)});return C2;},getFormatToTargetFn:function d(){var Cy=this.id;return function(C0){var C1=mstrmojo.all[Cy],Cz=C1&&C1.broker&&C1.broker.editorManager;if(C0===mstrmojo.vi.models.editors.BaseEditorModel.TITLE_CONTAINER_VALUE&&Cz&&Cz.notifyNonShapeSelectionChangeToListeners){Cz.notifyNonShapeSelectionChangeToListeners({identities:[{objType:BP.VIZ_BOX_TITLE}]});}};},getPulldown:function CX(Cz,C2,Cy,C1,C0){C1=A0.copy({_set_selectedIndex:function C3(C6,C4){if(C4===-1){this.selectedIndex=C4;this.getPopupList().clearSelect();var C5=this.selectedNode;if(C5){C5.innerHTML="";}return false;}return this.constructor.prototype._set_selectedIndex.call(this,C6,C4);}},C1);return this._super.apply(this,arguments);}});mstrmojo.vi.models.editors.GMEditorModel.PropertyKeyType=null;}());(function(){mstrmojo.requiresCls("mstrmojo.func","mstrmojo.hash","mstrmojo.dom","mstrmojo.color","mstrmojo.string","mstrmojo.boxmodel","mstrmojo.array","mstrmojo.Label","mstrmojo.DocDataService","mstrmojo.Xtab","mstrmojo._HasOwnAvatar","mstrmojo._HasPopup","mstrmojo.vi.ui._IsDropTarget","mstrmojo.rw.xtab._XtabColResize","mstrmojo.vi.ui._XtabCellHoverMgr","mstrmojo.ui._HasScroller","mstrmojo.vi.ui.VIDragUnit","mstrmojo.vi.ui.rw.selectors._IsMultiUnitControl","mstrmojo.vi.ui.rw.selectors._BrushesAndHighlights","mstrmojo.ui.editors.RenameEditor","mstrmojo.models.FormatModel","mstrmojo.models.template.DataInterface","mstrmojo.vi.models.editors.XtabEditorModel","mstrmojo.vi.models.EnumDragSources","mstrmojo.vi.ui.rw.xtab._SupportXtabCopyPaste","mstrmojo.vi.ui.rw.GhostImageContainer","mstrmojo.vi._MonitorsAppState","mstrmojo.vi.enums.EnumFeatures","mstrmojo.vi.ui.rw.FreezingImageContainer");mstrmojo.requiresClsP("mstrmojo.vi.ui.rw","_IsMultiselectXtab","_HasVisSelections","_XtabHighlights","_XtabDE","_XtabRA","_SupportViewFilterInVizBox","VizDropCue");mstrmojo.requiresClsP("mstrmojo.vi.viz","EnumVisualizationTemplates");mstrmojo.requiresDescs(11664,11668,13766,13767,14668);var p=mstrmojo,A4=p.array,u=p.func,a=p.hash,AT=p.dom,g=p.string,AW=p.models,AK=p.vi.models,A2=p.vi.viz,Ak=AW.template.DataInterface,AB=AW.FormatModel,z=AB.ENUM_PROPERTY_NAMES,Af=AB.getFormatUpdate,K=mstrmojo.DocDataService.SUPPRESS_DATA,I=A4.fnReduceNumber,AP="px",Av=A2.EnumVisualizationTemplates,Ao=mstrmojo.vi.models.EnumDragSources,Ac=mstrmojo.vi.enums.EnumFeatures,k=mstrmojo.vi.models.editors.XtabEditorModel.ENUM_TARGET_FORMAT,A8=mstrmojo.vi.models.editors.XtabEditorModel.ENUM_TARGET_SUBTOTAL_FORMAT_PROPNAME,A1=mstrmojo.vi.ui.rw.GhostImageContainer;var r=Ak.ENUM_GRID_RESIZE,Ab=r.FIXED,S=r.FIT_TO_WINDOW,Ae=r.FIT_TO_CONTENTS,AA=AK.EnumDragSources,Al=AK.editors.XtabEditorModel.ENUM_EDITOR_TARGETS,As=Al.COLUMNS,Ad=Al.ROWS,A6=Al.VALUES,AC=4,E="00000000000000000000000000000000";var A9={isSubtotalFormat:false,isSubtotalUseGridFormatting:true};function AY(BB){this.submitUndoRedoActionsWithCallback(this.controller.dataService().getUpdateTemplateAction(this.k,BB));}function t(){var BD=this.id,BB=this.model.docModel;return{success:function BC(BF){var BH=mstrmojo.all[BD],BG=BH.parent,BE=BH.getScrollPos();BG=BB.partialUpdateAndRebuildChild(BG,BF)||BG;window.setTimeout(function(){BB.selectVIUnit(BG.id,true);BG.boxContent.scrollTo(BE,true);},0);}};}function A7(){var BD={scriptClass:"mstrmojo.Label",cssClass:"dropMsg",text:mstrmojo.desc(11668,"Drag objects here.")},BC=this.gridData,BF=BC&&BC.eg;if(this.excludeData){var BE=mstrmojo.VisUtility.getAttMetricCount.call(this);BD={scriptClass:"mstrmojo.vi.ui.rw.FreezingImageContainer",cssClass:"xtab",visName:mstrmojo.desc(114,"Grid"),visDropzoneMsg:mstrmojo.vi.ui.rw.FreezingImageContainer.getVisDropzoneMsg(BE.attCount,BE.metricCount)};}else{if(BF){BD={scriptClass:"mstrmojo.Container",cssClass:"error-msg",markupString:'<div class="{@cssClass}"><div class="error-content" style="visibility: visible"><div class="text" style="padding-top:0">'+BF+"</div></div></div>",markupSlots:{containerNode:function(){return this.domNode;}}};}else{if(mstrApp&&mstrApp.supportFeature(Ac.SUPPORT_GHOST_IMG)){var BB=A1.getVisDesc("grid");BD={scriptClass:"mstrmojo.vi.ui.rw.GhostImageContainer",cssClass:"xtab",visName:mstrmojo.desc(114,"Grid"),visDesc:BB};}}}this.raiseEvent({name:"toggleCtrlOverlay",visible:(!BC||BF!==undefined)||this.excludeData,controls:[BD]});}function AL(){var BB=document.createElement("textarea");BB.className="xTabHiddenTextArea";BB.setAttribute("tabindex","-1");this.domNode.appendChild(BB);this.xTabHiddenTextArea=BB;}function AF(BC,BB,BD){BC.push({x:BB,y:BD});}function o(BF,BD,BG,BC,BL,BE,BJ,BB){var BM=BJ.o,BI=0,BH={or:BM,size:BJ.cueSize+AP},BK=function(){return Math.max(BI+BE-6,BJ.cueMinPos)+AP;};if(BM==="v"){BI=BF;BH.top=BD+AP;BH.left=BK();}else{BI=BD;BH.top=BK();BH.left=BF+AP;}BB.push({id:BG+"|"+BC,points:BL,cue:BH});}function c(BG,BF,BC,BH){var BE=[],BB=BC/2,BD=BH.end;AF(BE,BG,BF);if(BH.o==="v"){AF(BE,BG,BD);AF(BE,BG+BB,BD);AF(BE,BG+BB,BF);}else{AF(BE,BG,BF+BB);AF(BE,BD,BF+BB);AF(BE,BD,BF);}return BE;}function H(BH,BG,BC,BI,BE){var BB=BC/2,BD=BI.end,BF=[];if(BI.o==="v"){AF(BF,BH+BB,BG);AF(BF,BH+BB,BD);if(BE){AF(BF,BI.side,BD);AF(BF,BH+BC,BI.header);}else{AF(BF,BH+BC,BD);}AF(BF,BH+BC,BG);}else{AF(BF,BH,BG+BB);AF(BF,BH,BG+BC);if(BE){AF(BF,BD,BI.side);AF(BF,BD,BG+BC);}else{AF(BF,BD,BG+BC);}AF(BF,BD,BG+BB);}return BF;}function AS(BJ,BF,BH,BE,BG,BI,BB){var BD=BJ.x,BC=BJ.y;o(BD,BC,BE,BG,c(BD,BC,BF,BI),0,BI,BB);o(BD,BC,BE,BG+1,H(BD,BC,BF,BI,BH),BF,BI,BB);}function Q(BF,BH,BG,BI,BD,BK,BC){var BJ=0,BE=BF[0],BB=function(){var BL=BH.splice(0,BJ).map(BD).reduce(I,0);AS(BK(BG),BL,false,-1,BE+1,BI,BC);return BL;};BF.forEach(function(BL){if(BL===BE){BJ++;}else{BG+=BB();BE=BL;BJ=1;}});BB();}function h(BD,BB,BE,BG,BH,BC){var BF=BD.length-1;BD.forEach(function(BJ,BI){AS(BH(BB,BE),BJ,BI===BF,BE,BI+1,BG,BC);BB+=BJ;});}function AM(BE,BD,BC){var BB={order:[]};BE.forEach(function(BH){var BF=BH.id||"metrics",BG=BB[BF];if(!BG){BB.order.push(BF);}BB[BF]=(BG&&BG+1)||(BH.fs&&BH.fs.length)||1;});return BB.order.map(function(BF){return BD.splice(0,BB[BF]).map(BC).reduce(I,0);});}function At(BB){var BW=new mstrmojo.models.template.DataInterface(this.gridData),BO=AT.position(this.zone.tableNode),BN=this.gridInfo,BP=this.gridData,BT=BP.twm.bottom.map(function(BX){return parseInt(BX.w,10);}),BU=AM(BW.getRowTitles().titles,BT,function(BX){return BX;}),BH=Array.prototype.slice.call(this.zone.domNode.getElementsByTagName("tr"),0),BJ=BU.reduce(I,0),BL=AM(BW.getColTitles().titles,BH,function(BX){return BX.offsetHeight;}),BQ=BO.y,BG=BQ+BL.reduce(I,0),BI=BO.x+BO.w,BK=BO.y+BO.h,BV=BO.x,BR=AT.position(this.domNode.parentNode),BM={cueSize:Math.min(BR.h,BO.h),cueMinPos:BR.x,header:BG,side:BI,end:BK,o:"v"},BC={cueSize:Math.min(BR.w,BO.w),cueMinPos:BR.y,header:BG,side:BK,end:BI,o:"h"},BF=function(BX){return{x:BX,y:BQ};},BS=function(BX,BY){var BZ={x:BV,y:BX};if(BY===2){BZ.x+=BJ;}return BZ;},BE=[];if(BB.getCtxtDragData().item.t===AC&&BN.mx&&BN.mx.length){var BD=BP.gvs.items;if(BN.tma===2){Q(BD[0].items.map(function(BX){return BX.mix;}),BT,BV+BJ,BM,function(BX){return BX;},BF,BE);}else{Q(BD.map(function(BX){return BX.items[0].mix;}),BH,BG,BC,function(BX){return BX.offsetHeight;},BS,BE);}}else{BC.cueSize-=BJ;h(BU,BV,1,BM,BF,BE);h(BL,BQ,2,BC,BS,BE);}return BE;}function A(){var BB=this.model;return !!(BB.getSelectorControlMapInfo?BB.getSelectorControlMapInfo():[]).length;}function Ap(BD){if(!BD){return Al.GENERAL;}var BB=BD.info;if(!BB){return undefined;}if(BB.isSrcTitle){return As;}var BC=BB.title;if(BC.otp===-1&&!BD.isMetricHeader){return A6;}return BC.axis===1?Ad:As;}function U(){var BC=this.msgNode,BB=this.getFormats()["background-color"];if(BC&&BB){BC.style.color=mstrmojo.color.getContrastingColor(BB,"#cdcdcd","#444649");}}mstrmojo.vi.ui.rw.Xtab=mstrmojo.declare(mstrmojo.Xtab,[mstrmojo._HasOwnAvatar,mstrmojo.rw.xtab._XtabColResize,mstrmojo.ui._HasScroller,mstrmojo.vi.ui.rw._IsMultiselectXtab,mstrmojo.vi.ui.rw._HasVisSelections,mstrmojo.vi.ui.rw.selectors._IsMultiUnitControl,mstrmojo.vi.ui.rw.selectors._BrushesAndHighlights,mstrmojo.vi.ui.rw._XtabHighlights,mstrmojo.vi.ui.rw._XtabDE,mstrmojo._HasPopup,mstrmojo.vi.ui._IsDropTarget,mstrmojo.vi.ui.rw.xtab._SupportXtabCopyPaste,mstrmojo.vi.ui.rw._XtabRA,mstrmojo.vi.ui.rw._SupportViewFilterInVizBox,mstrmojo.vi._MonitorsAppState],{scriptClass:"mstrmojo.vi.ui.rw.Xtab",controller:null,formatHandlers:{msgNode:["height"],viewport:["D"]},dropZone:true,isMultiSelect:true,cellHoverMgr:"mstrmojo.vi.ui._XtabCellHoverMgr",CELL_HIGHLIGHT:"xtabSel",isVIXtab:true,excludeData:false,supportsEditorClickSwitching:true,init:function Aa(BB){this.excludeData=!!(mstrConfig.resolveOnly||mstrApp.isAppStatePause&&mstrApp.isAppStatePause());if(this._super){this._super(BB);}},renderEmptyGrid:function V(){return true;},_set_edtModel:function d(BC,BD){var BB=this._edtModelListener;if(BB){BB.clear();}this.edtModel=this.addDisposable(BD);this._edtModelListener=BD.attachEventListener("BEMFormatChange",this.id,function(BE){if(BE.propertyName===z.BACKGROUND_COLOR){U.call(this);}});return true;},handlesMultiSelection:function w(){return true;},getVisType:function C(){return{s:"VisGrid",vt:Av.GRID};},_set_gridData:function f(BC,BB){this.gridData=BB;this.raiseEvent({name:"regenerateToolbar"});return true;},submitUndoRedoActionsWithCallback:function AD(BB,BC){this.controller.submitUndoRedoTemplateWithCallback(this,BB,BC);},updateForPU:function(BB){this.node=BB;this.update(BB);},onAppStateChange:function(BB){var BC=mstrApp.isAppStatePause(),BD=BB.valueWas&mstrmojo.vi.VisualInsightApp.APP_STATES.PAUSE;this.excludeData=!!(mstrConfig.resolveOnly||BC);if(this._super){this._super(BB);}if((BC&&!BD)||(!BC&&BD&&!mstrApp.enableUpdate)){A7.call(this);}},refresh:function An(BB){if(this.excludeData){A7.call(this);return ;}this._super(BB);},update:function v(BE){var BD=this.gridData,BG=BD&&BD.gsi&&BD.gsi.fmts;if(BG){var BC=BE.data,BF=BC[0]||BC,BB=BF&&BF.gsi&&BF.gsi.fmts;if(BB){a.keyarray(BB).forEach(function(BH){if(BB[BH].empty){BB[BH]=BG[BH];}});}}this._super(BE);A7.call(this);},postBuildRendering:function BA(){this._super();this.shouldClipLockableXtab=false;U.call(this);A7.call(this);AL.call(this);},setupScrollNodes:function O(){this.scrollNode=this.scrollboxNode;this.scrollbarHostNode=this.domNode;},drill:function Ah(BB,BF){var BE,BC=this.model,BD=this;if(!BB._e){BE=BC.getDrillAction(this.getActionCells(BB),BF);}else{BE=BC.getDrillAction(A4.map(this.cmSelCells,function(BG){return BD.getCellForNode(BG);}),BF);}this.controller.onDrill(this,BE);},pivot:function m(BC,BE){var BF=this,BD=this.model,BB=function(){AY.call(BF,BD.getPivotAction(BC,BE));};if(BE==="2"){BD.xtab.zonesModel.checkAndWarnLargeItemsForAddUnits([BC],BB,null,true);return ;}BB();},pivotForm:function P(BB,BC,BD){if(BC==="l"||BC==="r"){AY.call(this,this.model.getPivotFormAction(BB,BC,BD));}},showTotal:function e(BB,BD,BC){AY.call(this,this.model.getTotalsAction(BB,BD,BC));},renameUnit:function Ag(BI){var BG=BI&&BI.mix!==undefined&&!!BI._e,BC=(BG?BI._e.oid:BI.id),BH=BG?4:BI.otp,BE=this.model,BF=this.gridInfo,BB=BF.rows.concat(BF.cols).concat(BF.mx).filter(function(BK){return BK.did===BC;})[0],BD=BE.getUnitNameInDataSet(BC),BJ=(BB&&BB.n)||BI.n||BI.v;(new mstrmojo.ui.editors.RenameEditor({renameText:BJ,helpText:BD&&BJ!==BD?mstrmojo.desc(14668,"Original Name: ##").replace("##",BD):null,onRename:function(BK){var BL=function(){AY.call(this,BE.getRenameTemplateUnitAction(BC,BH,BK,false));}.bind(this);if(BE.doesNameExistOnTemplate(this,BC,BH,BK)){mstrmojo.confirm(mstrmojo.desc(11664,'"##" already exists in the visualization. Do you want to proceed?').replace("##",BK),{confirmBtn:{fn:BL}});}else{BL();}}.bind(this)})).open();},hasSubtotal:function AN(BF){var BD=this.model,BC=BD&&BD.data,BB=BC&&BC.gts,BK=BB&&BB.row||[],BG=BB&&BB.col||[],BE={},BI=false,BJ=BC&&BC.gsi,BH=BJ&&BJ.hidesb;if(BH){return false;}BE[Al.ROWS]=BK;BE[Al.COLUMNS]=BG;BE[Al.VALUES]=BK.concat(BG);A4.forEach(BE[BF||Al.VALUES],function(BL){if(BL.ast&&BL.ast.length>0){BI=true;return false;}});return BI;},getSubtotalFormatUseGridFormat:function Au(BD){var BB=this.model,BC=BB&&BB.data,BE=BC&&BC.gsi,BF=BE&&BE.prop||{};return BF[z[A8[BD]]];},removeUnit:function Z(BB){var BH=BB&&BB.mix!==undefined&&!!BB._e,BD=this.model,BF=BH?BB._e.oid:BB.id,BG=BD.getCurrentUnitAxisAndPosition(BF),BC=BG&&BG.axis,BE=BG&&BG.depth;AY.call(this,BD.getRemoveTemplateUnitAction({did:BF,t:BH?4:BB.otp,axis:BC,unitPos:BE}));},removeTotal:function Y(BC){var BE=BC.hst;if(BE!==undefined){var BD=this.model,BF=BD.getCellTitleInfo(BC).title;var BB=![].concat(BF.ast||[]).some(function(BG){return BG.t===BE;});if(BB){AY.call(this,BD.getRemoveAxisTotalsAction(BE,BC.axis));}else{this.showTotal(BF,[],[BE]);}}},formatGridZone:function AU(BD,BC,BB){AY.call(this,this.model.getZoneFormatAction(BD,BC,this.k,BB));},getFormatDefaultColorActions:function Ar(BB){if(!BB){return[];}var BC=this,BD=function BD(BE,BF){var BG=[];a.forEach(BE,function(BI,BH){if(BH==="st"){BG=BG.concat(BD(BI,true));}else{a.forEach(BI,function(BJ,BK){BG.push(BC.model.getZoneFormatAction(BH,Af(BK,BJ),BC.k,{isSubtotalFormat:!!BF,isSubtotalUseGridFormatting:false}));});}});return BG;};return BD(BB);},getFormatSelectedColorActions:function Az(BC){var BB=k[Al.COLUMNS],BD={bc:A9,fc:A9,bbc:A9,brc:A9},BF=[],BE=this;if(BC){a.forEach(BD,function(BG,BH){if(BC[BH]){BF.push(BE.model.getZoneFormatAction(BB,Af(BH,BC[BH]),BE.k,BG));}});}return BF;},getFormatGridColorAction:function Ay(BB,BC){return this.getFormatDefaultColorActions(BB).concat(this.getFormatSelectedColorActions(BC));},formatGridColor:function Ay(BB,BC){AY.call(this,this.getFormatGridColorAction(BB,BC));},formatGridStyle:function W(BB,BC,BD){AY.call(this,(BC?this.getFormatGridColorAction(BD,BC):[]).concat(this.getFormatSelectedStyleActions(BB)));},getFormatSelectedStyleActions:function F(BC){var BB=k,BD={bbs:A9,brs:A9},BF=[],BE=this;a.forEach(BB,function(BG){a.forEach(BD,function(BH,BI){if(BC[BI]!=undefined){BF.push(BE.model.getZoneFormatAction(BG,Af(BI,BC[BI]),BE.k,BH));}});});return BF;},UpdatePropAndformatGridZone:function n(BF,BD,BC){var BB=this.model.getAdvancedPropertiesAction(Af(z[A8[BF]],0)),BE=this.model.getZoneFormatAction(k[BF],BD,this.k,BC);AY.call(this,[BB,BE]);},batchFormatGridZones:function N(BD,BC,BB){var BE=this;AY.call(this,BD.map(function(BG,BF){return !!BC[BF]?BE.model.getZoneFormatAction(BG,BC[BF],BE.k,BB):null;}).filter(function(BF){return !!BF;}));},formatPadding:function A0(BD,BE,BC){var BB=Af(z.GRID_HORIZONTAL_PADDING,BD,Af(z.GRID_VERTICAL_PADDING,BE));AY.call(this,["ch","rh","va"].map(function(BF){return this.model.getZoneFormatAction(BF,BB,this.k,BC);},this));},keepOnlyOrExclude:function G(BB,BD){var BC=this.controller,BE=this.getContextMenuSelections(),BF=u.wrapMethods(BC._getXtabCallback(this));BC.applyKeepOnly(this,BF,{keepOnly:BD,data:BE.length>0?BE:[this.model.getCellDataUnion(BB)]});if(!BD){this.clearSelections();this.endSelections();}},setAllXtabWidths:function b(BE){var BD=this.gridData.twm||{},BB=BD.top,BC=BD.bottom,BF=BE?(BE+AP):BE;(BC||[]).forEach(function(BG,BH){BB[BH]=BB[BH]||{};BB[BH].w=BG.w=BF;});},changeResizeScenario:function Aj(BO,BB,BH,BS){var BC=new mstrmojo.models.template.DataInterface(this.gridData),BG=BC.getRowResizeInfo(),BM=this.gridData.twm||{},BP=BM.bottom,BK=BC.getColumnHeaderData(true),BW=this,BF=this.model,BN=this.id,BX=this.k,BJ=[],BE=[],BR=[],BD=1,BQ=BB?BC.getColResizeScenario():BG.v,BU=[];if(BQ===BO){return ;}if(BB){BJ.push({act:"changeXtabColWidthScenario",value:BO});if(BO===Ab||BQ===Ab){BK.forEach(function(BZ,BY){var Bd=BZ.oid||BZ.id,Bc=function(Be){return Be.unitId===Bd&&Be.depth===BD;},Bb=BK[BY-1];if(!(BZ.fs&&BZ.fs.length>0)||(Bb&&Bd!==(Bb.oid||Bb.id))){BD=1;}var Ba=Bd===(BH&&BH.did)&&BD===BH.depth;if(!BU.some(Bc)){BU.push({unitId:Bd,depth:BD});BE.push({colIndex:BY,value:Ba?BH.width+AP:BP[BY].w});BR.push({colIndex:BY,value:BP[BY].w});if(BO===Ab){BJ.push(BF.getColumnResizeAction(Bd,BZ.otp,Ba?BH.width:parseInt((BP[BY].w)||0,10),BD,Ba?BH.isExtra:false));}}BD++;});}var BT=function BT(BY,Ba){var BZ=mstrmojo.all[BN];if(BY===Ab){BW.updateRelatedColWidths(Ba);}BW.updateScenario(BY);};if(!BS){if(this.isCustomSort){this.updateRelatedColWidths(BE);this.delegateToActionMgr(BJ);}else{this.controller.cmdMgr.execute({execute:function BI(){BT(BO,BE);this.submit(BF.getDataService().getUpdateTemplateAction(BX,BJ),t.call(mstrmojo.all[BN]),K);},urInfo:{undo:function BV(){BT(BQ,BR);},redo:function BL(){BT(BO,BE);},callback:t.call(this)}});}}else{BT(BO,BE);}}else{BJ.push({act:"changeXtabRowHeightScenario",value:BO,height:BG.height});if(!BS){AY.call(this,BJ);}}return BS?BJ:undefined;},submitColumnWidthChange:function j(BE,BI,BG,BF){var BJ=this;if(!BI){var BD=BJ.k,BB=BJ.model.getDataService(),BC=t.call(BJ);if(this.isCustomSort){this.delegateToActionMgr(BE);}else{this.controller.cmdMgr.execute({execute:function BK(){this.submit(BB.getUpdateTemplateAction(BD,BE),BC,K);},urInfo:{undo:function BL(){BJ.updateRelatedColWidths(BG);},redo:function BH(){BJ.updateRelatedColWidths(BF);},callback:t.call(this),extras:K}});}}},changeColumnWidth:function A3(BP,BN,BM,BC,BK,BQ){var BB=new mstrmojo.models.template.DataInterface(this.gridData),BJ=this.gridData.twm||{},BL=BJ.bottom,BI=BB.getColumnHeaderData(true),BS=this,BG=this.model,BH=[],BE=[],BO=[],BD=1,BF=-1,BR=[];if(BB.getColResizeScenario()!==Ab){BH=this.changeResizeScenario(Ab,true,{did:BP,t:BN,width:BM,depth:BC,isExtra:BK},BQ);return BQ?BH:undefined;}if(BP==="all"){BI.forEach(function(BU,BT){var BX=BU.oid||BU.id,BW=function(BY){return BY.unitId===BX&&BY.depth===BD;},BV=BI[BT-1];if(!(BU.fs&&BU.fs.length>0)||(BV&&BX!==(BV.oid||BV.id))){BD=1;}if(!BR.some(BW)){BR.push({unitId:BX,depth:BD});BE.push({colIndex:BT,value:BM+AP});BO.push({colIndex:BT,value:BL[BT].w});BH.push(BG.getColumnResizeAction(BX,BU.otp,BM,BD,false));}BD++;});}else{BI.every(function(BU,BT){var BV=(BU.oid===BP||BU.id===BP);if(BV){BF=BT+BC-1;}return !BV;});if(BF>=0){BE.push({colIndex:BF,value:BM+AP});BO.push({colIndex:BF,value:BL[BF].w});BH.push(BG.getColumnResizeAction(BP,BN,BM,BC,BK));}}BS.updateRelatedColWidths(BE);BS.submitColumnWidthChange(BH,BQ,BO,BE);return BQ?BH:undefined;},changeRowHeight:function Aw(BB){AY.call(this,{act:"changeXtabRowHeightScenario",value:Ab,height:BB});},showBanding:function AG(BB){if(mstrApp.isInVFConfigMode){mstrApp.showBandingInVFConfigMode=true;}this.controller.submitUndoRedoUpdates(this.model.getDataService().getUpdateTemplateAction(this.k,{act:"showBanding",show:!!BB}),{},t.call(this));},showOutlineModeOption:function AE(BJ){var BE=BJ?1:0,BF=BJ?0:-1,BK=BJ?-1:0,BB={act:"advancedProperties",props:{"Template Formatting":{Indented:BE}}};if(BJ){BB.props["Template Formatting"]["MergeCells"]=BK;}var BG=this.k,BC={act:"format",unitKey:BG,unitType:521,formatType:1,format:{FormattingIncrementalFetch:{EnableIFOnGrid:BF}}};if(mstrApp.isInVFConfigMode){mstrApp.showOutlineInVFConfigMode=true;}if(!this.hasSubtotal()&&BJ){var BH=this.zonesModel.getShowQuickTotalAction();var BI=this.model.getDataService().getUpdateTemplateAction(this.k,BB);for(var BD=0;BD<BH.length;BD++){BI.actions.push(BH[BD]);}this.controller.submitUndoRedoUpdates([BI,BC],{},t.call(this));}else{this.controller.submitUndoRedoUpdates([this.model.getDataService().getUpdateTemplateAction(this.k,BB),BC],{},t.call(this));}},applyGridCellFormatForSubtotalChange:function q(BB,BC){var BD=[this.model.getAdvancedPropertiesAction(Af(z[A8[BC]],BB?1:0))];if(BB){BD.push(this.model.getApplyGridCellFormatToSubtotalAction(k[BC]));}AY.call(this,BD);},getDragData:function A5(BB){var BE=BB.src.node,BG=this;if(!this.isColResizeNode(BE)&&!this.isDraggingScrollBar(BB)){var BF=this.model,BK=this.getCellForNode(BE),BD=BF.getCellInfo(BK),BH=BD.isTitle,BJ=(BD.isMetric&&BD.isHeader);if(BH||BJ){var BI=BH?BF.getCellTitleInfo(BK).title.id:BK._e.oid,BL=BF.getObjectInfo(BI);BL.cell=BK;var BC=(BB.dragUnitHelper=new mstrmojo.vi.ui.VIDragUnit()).getUnitDragData(BB,[BL]);BC.src=Ao.VIZ;BC.onRemove=function(BM){BG.removeUnit(BM.cell);};BC.allowDropOnTarget=function(BM){if(BM===Ao.DATASETS){return true;}return false;};return BC;}}return this._super(BB);},isDragValid:function AI(BC){var BE=BC.src.node,BB={},BD;if(!this.isColResizeNode(BE)&&!this.isDraggingScrollBar(BC)){BB=this.model.getCellInfo(this.getCellForNode(BE));}BD=BB.isTitle||(BB.isMetric&&BB.isHeader);if(mstrApp.isDossier&&BD){return false;}return mstrApp.isInVFInteractMode&&BD?false:(BD||this._super(BC));},createAvatar:function R(BC,BB){if(BB.dragUnitHelper&&!this.isColResizeNode(BC)){return BB.dragUnitHelper.getUnitAvatar(BB,true);}return this._super(BC,BB);},positionAvatar:function l(BC,BB){if(BB.dragUnitHelper){BB.dragOffsets=BB.dragUnitHelper.getDragUnitOffsets();}this._super(BC,BB);},allowBoxDropFromDataset:function AO(BC){var BB=this.gridData;return !BB||BB.egt!==undefined;},allowDrop:function D(BC){var BD=BC.getCtxtDragData(),BB=BD&&BD.items;return(BC.dragUnitHelper&&BC.src.widget===this)||((BB&&BB.length===1)&&BD.src===AA.DATASETS);},getDropData:function AH(BC){var BE=BC.getCtxtDragData().item,BD=BE&&(new mstrmojo.models.template.DataInterface(this.gridData)).getUnitById(BE.did),BB=!this.model.hasSameRecursiveAttributeGroup(BE),BF=!!BD?mstrmojo.desc(13766,"Move ##"):mstrmojo.desc(13767,"Add ##");return{cue:new mstrmojo.vi.ui.rw.VizDropCue(),unit:BD,tip:BB?BF.replace("##",g.encodeHtmlString(BE.n)):"",avatar:BB?(!!BD?"move":"add"):"no-op",allowDrop:BB};},ondragenter:function L(BC){var BB=BC.xtabMaps=BC.xtabMaps||{};if(!BB[this.id]){BB[this.id]=At.call(this,BC);}this.closePopup();this.openPopup(BC.getCtxtDropData().cue);this.ignoreHover=true;},ondragover:function AQ(BB){var BC=BB.xtabMaps[this.id],BH=BB.getCtxtDropData(),BF;BC.every(function(BK){if(mstrmojo.boxmodel.isPtInPolygon(BB.tgt.pos,BK.points)){BF=BK;return false;}return true;});var BE=(BF&&BF.id)||"";if(BH.areaId!==BE){var BD=BB.getCtxtDragData(),BI=null,BJ="",BG=BF&&BF.cue;if(BG){BI={tip:BH.tip,or:BG.or,size:BG.size,top:BG.top,left:BG.left};BJ=BH.avatar;}else{if(BD.src===AA.DATASETS){BJ=(BH.unit||!BH.allowDrop)?"no-op":"add";}}BH.cue.set("cueConfig",BI);BH.areaId=BE;BD.setAvatarClass(BJ);}},ondrop:function B(BD){var BI=BD.getCtxtDropData().areaId,BF=BD.getCtxtDragData();if(BI){var BQ=BI.split("|"),BN=parseInt(BQ[0],10),BK=parseInt(BQ[1],10),BH=BF.items[0],BE=this.model,BR=BH.did,BT=BE.getCurrentUnitAxisAndPosition(BR),BP;if(BD.src===this||BT){var BL=BT.axis,BO=BT.depth;if(BN!==BL||(BK!==BO&&BK!==BO+1)){if(BN===BL&&BO<BK){BK--;}BP=BE.getPivotUnitAction(BN,BK-1,BR,BH.t,BL,BO-1);}}else{if(!BE.hasSameRecursiveAttributeGroup(BH)){BE.addEditNodeForDatasetAction(BD,this.k);BP=BE.getAddTemplateUnitAction(BH,BF.dsid,BN,BK-1);}}if(BP){var BU=this,BJ=this.controller,BB=function(){var BZ=BD.actions||[],BX;BX=BJ.dataService().getUpdateTemplateAction(BU.k,[BP]);if(BX&&BX.actions){var BY=false,BW=[],BV;A4.forEach(BD.getCtxtDragData().items,function(Ba){BV=(Ba.t===AC&&Ba.id!==E);BY=BV||BY;if(BV){BW.push(Ba);}});if(BY){BX.actions.push(BU.model.getValuesDefaultFormatGridZoneAction(BW,true));}}BZ.push(BX);BU.submitUndoRedoActionsWithCallback(BZ,BD.callback);},BC=function(){var BV=BD.actions||[];BU.submitUndoRedoActionsWithCallback(BV,BD.callback);};var BS=BE.xtab.zonesModel;if(BN===2){BS.checkAndWarnLargeItemsForAddUnits([BH],BB,BC,true);return this._super(BD);}else{BS.checkAndWarnForOutlineAddUnits([BH],BN,BB);return this._super(BD);}if(BF.src===AA.ALL_OBJECT_LIST){var BG=BD.src.widget,BM=BG&&BG.dataProvider;if(BM){BM.loadObjects([BH],{success:BB});}}else{BB();}}}else{if(BF.dsid){this.zonesModel.addUnitsFromDataSource(BF.items,BF.dsid,BD.actions,BD.callback);}}this._super(BD);},cleanUpAfterTarget:function Am(BC){this._super(BC);var BB=BC.getCtxtDropData().cue;if(BB){this.closePopup();BB.destroy();}this.ignoreHover=false;},getFormatMenuItemTarget:Ap,getFormatTargetFromCell:function M(BB){return Ap({info:this.model.getCellTitleInfo(BB),isMetricHeader:BB&&BB.mix!==undefined&&!!BB._e});},highlightFormatTarget:function AX(BF,BB){var BE=mstrmojo.vi.ui.rw.SelectionType,BD=BE.METRIC_VALUES,BC=!!(this.hasAssociatedNodes()&&this.getSelections()),BG=(this.highlights||[]).slice();if(BF===As){BD=BE.COL_HEADERS;}else{if(BF===Ad){BD=BE.ROW_HEADERS;}}this.highlightRange(BD,BC,BB);return BC?BG:null;},highlightNumberFormatTarget:function Ax(BB){var BC=(this.highlights||[]).slice();if(BB&&BB.did){this.highlightCellsById(BB.did,BB.t);}else{if(BB&&BB._e){this.highlightCellsById(BB._e.id,12,true);}}return BC;},restoreHighlights:function AJ(BB){if(BB){this.clearHighlights();this.highlightCells(BB);}else{this.highlight(this.getSelectionType(),this.getSelectionHash(),true);}},onclick:function AR(BC){this._super(BC);var BD=this.selCells,BB=this.parent;if(AT.isPrimaryMouseBtn(BC.e)&&!BC.ctrlKey&&!BC.shiftKey&&!BC.metaKey&&(this.model.docModel.getLatestSelectedViUnitKey()===this.k)){var BE=this.getCellForNode(BC.getTarget());if(BE){var BF=this.getFormatTargetFromCell(BE);if(BF){BC.e.ptvSelected=true;if(this.edtModel){this.edtModel.selectTargetByValue(BF);}}}}if(BD&&BD.length&&BB&&BB.displayVisFilterIndicator){BB.displayVisFilterIndicator();}},editDerivedAttribute:function J(BE){var BB=this.model.docModel,BD=this.getDerivedAttribute(BE.id),BC;if(BD){BC={dsid:BD.dsid,did:BE.id,n:BE.n,alias:BE.n,forms:BD.fs,datasets:BB.datasets};this.controller.openDAE(this,BC,mstrmojo.emptyFn,null);}},newDerivedAttribute:function x(BF){var BB=this.model.docModel,BE=this,BC={forceRefresh:true,alias:"New Attribute",datasets:BB.datasets,precreate:function BD(BG){BG=a.copy({act:"addDAToTemplate",nodeKey:BE.k,treeType:BE.defn.tt,axis:BF.axis},BG);if(BF.ui!==undefined){BG.pos=BF.ui+2;}return BG;}};this.controller.openDAE(this,BC,mstrmojo.emptyFn,null);},newDynamicLinkAttr:function AV(BH){var BC=this.model.docModel,BG=this,BE={forceRefresh:true,alias:"New Link",datasets:BC.datasets,precreate:function BF(BI){BI=a.copy({act:"addDAToTemplate",nodeKey:BG.k,treeType:BG.defn.tt,axis:BH.axis},BI);if(BH.ui!==undefined){BI.pos=BH.ui+2;}return BI;}};var BD=function BD(BI){return BI.did===BH.id;};var BB=BC.getDatasetUnits(["att"],BD)[0]||null;this.controller.openDynamicLinkEditor(this,BE,mstrmojo.emptyFn,BB);},getDerivedAttribute:function AZ(BE){var BC=this.model.docModel,BB=BC.datasets,BD=null;a.forEach(BB,function(BH,BG){var BF=A4.find(BH.att,"did",BE);if(BF>=0&&BH.att[BF].da){BD=BH.att[BF];BD.dsid=BG;return false;}});return BD;},isStatusBarPositioned:true,doSelection:function X(BD,BB,BE){var BC=mstrmojo._HasMarkup.newDomEvent("click",BB,BD);BC.getTarget=function(){return BE;};this.onclick(BC);},selectSiblings:function Ai(BB){return !(!(this.selectorControl||A.call(this))||this.isSelectAllCell(BB));},onNDECreated:function(){this.clearSelections();this.clearSelectionsCache();},getOnSubtotalsChangeFn:function(BB,BC,BD){return function(){var BH=BB.contents.getSubtotalTypes(),BG=this.model,BI=BH[0],BF=BH[1],BJ=[];if(BG.data.gsi.hidesb){if(BC.ast){BF=BC.ast.map(function(BK){return BK.t;});BF=A4.filter(BF,function(BK){return A4.indexOf(BI,BK)===-1;});}BJ.push(BG.getShowDefinedSubtotalsAction());}BJ.push(BG.getShowTotalsUnitAction(BC.id,BC.otp,BI,BF));if(!BC.ast&&BI.length>0){var BE=BG.getMoveSubTotalAction(BC,undefined,this.key);if(BE){BJ.push(BE);}}this.controller.submitUndoRedoTemplateUpdates(this,BJ,BD);}.bind(this);},onPageRendered:function Aq(BD,BB,BC,BE,BF){if(this._super){this._super(BD,BB,BC,BE);}if(!BF){this.updateScrollbars();}}});}());(function(){mstrmojo.requiresCls("mstrmojo.array","mstrmojo.css","mstrmojo.dom","mstrmojo.hash","mstrmojo.expr","mstrmojo.Box","mstrmojo.Button","mstrmojo.Editor","mstrmojo.Dial","mstrmojo.Label","mstrmojo.fe.CreateSetEditor","mstrmojo.fe.FilterEditor","mstrmojo.vi.ui.editors.fe.RWViewLimitExprTree","mstrmojo.mstr.EnumDSSXMLObjectTypes","mstrmojo.vi.ui.ConditionWalk","mstrmojo.vi.ui.ConditionEditor","mstrmojo.vi.ui.editors.fe.ConditionWalk","mstrmojo.vi.ui.editors.fe.RWViewFilterExprTree","mstrmojo.warehouse.EnumObjectTypes");mstrmojo.requiresDescs(118,2397,5758,14915,15540,15005,15014,15091);var b=mstrmojo.hash,W=mstrmojo.array,f=mstrmojo.css,L=mstrmojo.dom,Z=mstrmojo.expr,h=mstrmojo.mstr.EnumDSSXMLObjectTypes,S={TEMPLATE:0,DATASET:1},O=Z.ET,Y=Z.BRANCH_FNS,B=mstrmojo.warehouse.EnumObjectTypes,K=mstrmojo.mstr.EnumNodeProperties,I="VFEmpty";var G=10,U=46,H=116,P=286,R=369,F=42;DL_LABEL_HEIGHT=26;function g(k){var j={et:k.defaultExpressionType};if(k.disableElementsBrowsing&&k.disableElementsBrowsing()){j={et:O.AQ};}k.mainExpr.newCondition(j,true);}function N(j){var k=G;if(j<G){k=G;}else{if(j<=U){k=U;}else{k=H;}}return k;}function A(o,AA){var v=o&&o.domNode,t=AA&&AA.domNode,k=v&&v.style,u=t&&t.style;var m=o.parent.domNode.offsetHeight;if(!AA){k.height=m+"px";if(o.updateScrollbars){o.updateScrollbars();}return ;}if(v&&t){var r=R-P;if(!o.editor.showLimits){r-=F+DL_LABEL_HEIGHT;}var j=m-r;var l=L.position(o.itemsContainerNode),p=L.position(AA.itemsContainerNode),x=l.h,z=p.h;var n=N(z),w=j-n;var q=Math.min(G+x,w);k.height=q+"px";u.height=j-q+"px";if(o.updateScrollbars){o.updateScrollbars();}if(AA.updateScrollbars){AA.updateScrollbars();}}}function D(k){var l=b.clone(k);if(k&&k.et===O.ANDOR&&(k.node&K.CONDITION)){var m=b.valarray(Z.findTargets(k,"did"))[0],j={et:O.ANDOR,data:l};switch(m&&m.t){case h.Attribute:j.a=m;break;case h.Metric:j.m=m;break;}return j;}return l;}mstrmojo.vi.ui.editors.FilterEditor=mstrmojo.declare(mstrmojo.fe.FilterEditor,null,{scriptClass:"mstrmojo.vi.ui.editors.FilterEditor",titleMarkupString:'<div class="mstrmojo-Editor-title-container"><div class="mstrmojo-Editor-title"></div><div class="edt-title-btn mstrmojo-Editor-help" tooltip="'+mstrmojo.desc(1143,"help")+'"></div><div class="edt-title-btn mstrmojo-Editor-close" tooltip="'+mstrmojo.desc(2102,"Close")+'"></div></div><div class="mstrmojo-Editor-subtitle-container"></div><div class="mstrmojo-Editor-titleSpacer"></div>',markupSlots:b.copy({subTitleNode:function X(){return this.showTitle?this.domNode.firstChild.children[1]:null;},containerNode:function d(){return this.domNode.firstChild.childNodes[3];},buttonNode:function J(){return this.domNode.firstChild.childNodes[4];},curtainNode:function E(){return this.domNode.lastChild;}},b.copy(mstrmojo.fe.FilterEditor.prototype.markupSlots)),help:"view_filter_editor_for_dossiers.htm",cssClass:"mstrmojo-charcoalboxe mstrmojo-FE mstrmojo-vi-ui-FE",postCreate:function C(){this.children=mstrmojo.hash.clone(this.children).concat([{scriptClass:"mstrmojo.Box",slot:"subTitleNode",children:[{scriptClass:"mstrmojo.Label",text:mstrmojo.desc(14915,"New Qualification"),cssDisplay:"inline-block",cssClass:"mstrmojo-relation-relateby-text",bindings:{text:function(){return this.editor.isNewCond?mstrmojo.desc(14915,"New Qualification"):mstrmojo.desc(15540,"Edit Qualification");},editor:"this.parent.parent",visible:function(){return !!this.editor.showCondWalk;}}},{scriptClass:"mstrmojo.Button",cssClass:"mstrmojo-WebButton",alias:"newQualificationBtn",cssText:"float: left",cssDisplay:"inline-block",text:mstrmojo.desc(15005,"Add New Qualification"),onclick:function(){g(this.editor);},bindings:{enabled:function(){return !this.editor.readOnly;},visible:function(){return !this.editor.showCondWalk;},editor:"this.parent.parent"}}]}]);if(this._super){this._super();}},editorTitle:mstrmojo.desc(5758,"Filter Editor"),defaultExpressionType:O.AE,onvizTitleChange:function(){this.set("title",this.editorTitle+" - "+this.vizTitle);},getExpressionContainerCfg:function(){var j=this._super();j.cssDisplay="flex";return j;},onOpen:function M(){var j=this.mainExpr,k=this.limitExpr;if(j){A(j,k);}if(!this.model.expr){g(this);}},getExpressionContentsConfig:function(){return[{scriptClass:"mstrmojo.Label",text:mstrmojo.desc(15091,"Metric values are not aggregated."),cssClass:"mstrmojo-FE-expr-header dl",bindings:{visible:"this.parent.parent.parent.showLimits"}},{alias:"ve",scriptClass:"mstrmojo.vi.ui.editors.fe.RWViewFilterExprTree",level:S.DATASET,bindings:{items:"this.editor.model.exprForest || []"},onBlankClick:function(o){this.parent.clearSelect(o);},supportRelation:true,postApplyProperties:function(){this.editor=this.parent.parent.parent;this.editor.set("mainExpr",this);},onNew:function(p){p.data.isNew=true;if(!p.data.ph){this.editor.openWalk(p.data,p.widget.ctxtBuilder.itemWidgets[p.index],"condition");}var o=this.parent.vle;A(this,o);},onadd:function j(){f.toggleClass(this.parent.domNode,I,this.items.length===0);var o=this.parent.vle;A(this,o);},onremove:function l(){f.toggleClass(this.parent.domNode,I,this.items.length===0);var o=this.parent.vle;A(this,o);},onnodeadd:function k(){var o=this.tree.parent.vle;A(this.tree,o);},onnoderemove:function n(){var o=this.tree.parent.vle;A(this.tree,o);},onitemsChange:function m(o){var q=this.items.length===0,p=this.parent;if(this.hasRendered){f.toggleClass(p.domNode,I,q);}else{if(q){f.addWidgetCssClass(p,I);}else{f.removeWidgetCssClass(p,I);}}}},{scriptClass:"mstrmojo.Label",text:mstrmojo.desc(15014,"Metric values are aggregated based on the attributes in the visualization."),cssClass:"mstrmojo-FE-expr-header tl",bindings:{visible:"this.parent.parent.parent.showLimits"}},{alias:"vle",scriptClass:"mstrmojo.vi.ui.editors.fe.RWViewLimitExprTree",level:S.TEMPLATE,validExprTypes:W.hash([O.MQ,O.MC]),bindings:{visible:"this.editor.showLimits",items:"this.editor.model.limitExprForest || []"},onBlankClick:function(o){this.parent.clearSelect(o);},postApplyProperties:function(){this.editor=this.parent.parent.parent;this.editor.set("limitExpr",this);},onnodeadd:function k(){var o=this.tree.parent.ve;A(o,this.tree);},onnoderemove:function n(){var o=this.tree.parent.ve;A(o,this.tree);},onadd:function j(){var o=this.parent.ve;A(o,this);},onremove:function l(){var o=this.parent.ve;A(o,this);}}];},getConditionWalkConfig:function c(){return undefined;},toggleOkButtonStatus:function V(j){var k=this.buttonBar.children[0].btnSave;k.set("enabled",!!j);},andOrPopupRef:{scriptClass:"mstrmojo.Editor",cssClass:"mstrmojo-FE-andOrPopup mstrmojo-ConditionWalk",contentNodeCssClass:"mstrmojo-balloon",slot:"containerNode",modal:false,autoClose:true,showTitle:false,draggable:false,openEffect:null,closeEffect:null,onOpen:function(){var j=this.condition,m=j&&j.data&&j.data.not,n=j&&j.parent,k=n&&n.data,l=(k&&k.fn)+(m?21:0);this.list.opening=true;this.list.set("selectedItem",isNaN(l)?null:{did:l});this.list.opening=false;},children:[{scriptClass:"mstrmojo.Dial",cssClass:"mstrmojo-CGE-andOrDial",alias:"list",animate:false,itemMarkup:'<div class="dial-item {@css}">{@n}</div>',itemIdField:"did",renderOnScroll:false,items:[{did:19,n:Y[19]},{did:20,n:Y[20]},{did:19+21,n:Y["19_21"]},{did:20+21,n:Y["20_21"]}],onchange:function(){if(this.opening){return ;}var k=this.parent,j=k.condition,p=this.selectedItem,o=p&&p.did,n=o>21?true:null,m=o-(n?21:0);k.close();var l=j&&j.parent;if(l&&l.data&&l.data.et===O.ANDOR){l.edit(j,m,n);}else{var q=j&&j.data;if(q&&(q.not!==n)){q.not=n;j.paint();}}}}]},createSetPopupRef:{scriptClass:"mstrmojo.fe.CreateSetEditor",contentNodeCssClass:"",cssClass:"VI-CreateSet-Editor",slot:"containerNode",autoClose:true,showTitle:false,isHostedWithin:false},conditionEditorPopupRef:{scriptClass:"mstrmojo.vi.ui.ConditionEditor",isHostedWithin:false,getIfDataSource:function e(){return this.editor.getIfDataSource();},getDatasets:function Q(){return this.editor.getDatasets();},onUpdateBrowseElementsParams:function a(j){this.editor.onUpdateBrowseElementsParams(j);}},docModel:null,targetMetrics:null,_set_model:function(m,k){var l=this._super(m,k);if(l){var j=this.model.targets;this.targetMetrics=W.filter(j,function(n){n.title=n.n||"";return n.t===h.Metric;});}return l;},openWalk:function(o,p,u,v){var r=this,k=L.delta(p.domNode,r.containerNode);k.y+=(u==="andor"?16:parseInt(p.domNode.offsetHeight,10));var t={condition:p,zIndex:r.zIndex+10,left:k.x+"px",top:k.y+"px"},j;switch(u){case"andor":if(r.skipAndOrPopup){return ;}j="andOrPopupRef";break;case"createSet":case"createSetOpt":if(mstrApp&&mstrApp.isWSStyling&&v&&v.e&&v.e.target){var l=v&&v.e&&v.e.target,m=L.delta(l,r.containerNode);t.left=m.x+"px";t.top=m.y+parseInt(l.offsetHeight,10)+"px";}var q=r.model.targets;j="createSetPopupRef";t.type=u;t.model={attrs:W.filter(q,function(n){return n.t===B.ATTRIBUTE;}),metrics:W.filter(q,function(n){return n.t===B.METRIC;})};if(u==="createSetOpt"){t.condition=p.parent;t.model.childIdx=p.childIndex();}break;case"condition":var w=L.position(this.titleNode);t=b.copy({editor:r,objectBrowsingEnabled:r.objectBrowsingEnabled,showLimits:r.showLimits,targets:r.model.targets,targetsLastMod:r.modelLastSet,ets:p.tree.validExprTypes||r.validExprTypes,condition:p,hasPrompt:r.model.hasPrompt,disableElementsBrowsing:r.disableElementsBrowsing,inRelation:p.inRelation,model:D(o),left:w.x+50+"px",top:w.y+20+"px",draggable:!r.conditionEditorNotDraggable},t);if(!!o.isNew){t.title=mstrmojo.desc(14915,"New Qualification");}else{t.title=mstrmojo.desc(15540,"Edit Qualification");}j="conditionEditorPopupRef";}r.openPopup(j,t);},getIfDataSource:function e(){if(this.docModel){return this.docModel.getDataService();}return null;},onUpdateBrowseElementsParams:mstrmojo.emptyFn,getDatasets:function Q(){if(this.docModel){return this.docModel.datasets;}return null;},conditionEditorNotDraggable:false});}());(function(){mstrmojo.requiresCls("mstrmojo.Editor","mstrmojo.Button","mstrmojo.Widget","mstrmojo.Label","mstrmojo.Box","mstrmojo.desc","mstrmojo.css","mstrmojo.hash","mstrmojo.dom","mstrmojo.array","mstrmojo.expr","mstrmojo.models.FormatModel","mstrmojo.ui._HasScroller","mstrmojo._HasPopup","mstrmojo.vi.ui.ConditionEditor","mstrmojo.threshold.ThresholdRow","mstrmojo.threshold.ConditionWalk","mstrmojo.threshold.PropertyPanel","mstrmojo.threshold.PropertyModel","mstrmojo.threshold.ThresholdRowPanel","mstrmojo.mstr.EnumNodeProperties","mstrmojo.mstr.EnumDSSXMLObjectTypes","mstrmojo.mstr.EnumDSSXMLObjectSubTypes");var B=mstrmojo.css,P=mstrmojo.hash,O=mstrmojo.dom,E=mstrmojo.mstr.EnumNodeProperties,Z=mstrmojo.mstr.EnumDSSXMLObjectTypes,t=mstrmojo.mstr.EnumDSSXMLObjectSubTypes,N=mstrmojo.expr,a=N.ET,h=N.BRANCH_FNS,d=mstrmojo.Button.newWebButton,n=mstrmojo.models.FormatModel.getFormatUpdate,j=600,L="";var Y=mstrmojo.models.FormatModel.ENUM_NUMBER_FORMAT_KEYS_OBJ,p=[Y.CATEGORY,Y.CURRENCY_POSITION,Y.CURRENCY_SYMBOL,Y.DECIMAL_PLACES,Y.FORMAT,Y.NEGATIVE_NUMBERS,Y.THOUSAND_SEPARATOR],W=mstrmojo.models.FormatModel.ENUM_PROPERTY_NAMES,x=[W.BORDER_TOP_STYLE,W.BORDER_RIGHT_STYLE,W.BORDER_BOTTOM_STYLE,W.BORDER_LEFT_STYLE],o={0:"none",1:"1pt solid",3:"1pt dashed",4:"1pt dotted",5:"1.5pt solid"};function l(z,AB){var AA=[];if(AB){AB.forEach(function(AD){var AE=AD.fmt,AC={FormattingAppearance:{Visible:-1}};if(!!AE){AE.nth=AE.nth?-1:0;if(!!AE.bc&&!!AE.bc.c1){delete AE.gdc;delete AE.gda;}}P.forEach(AE,function(AF,AG){var AH=false;if(p.indexOf(AG)>-1){n(AG,AF,AC);}else{if(x.indexOf(AG)===-1){n(AG,AF,AC);}else{if(!AE.borderStyle&&!AH){n(W.BORDER_STYLE,o[AF],AC);}}}});z.setAttIdToNDE(AD.expr);AA.push({n:AD.n,scope:AD.scope,rtp:AD.rtp,rtxt:AD.rtxt,expr:mstrmojo.fe.FilterUtils.getExprXml(AD.expr),fmt:AC});});}return AA;}function r(AD){var AA=this.controller,AB=this.model,AC=AB.thresholds,AE=this.metricId,AG=AC&&AC[AE],AF=AB.orgThresholds,z=AF&&AF[AE];AA.onSubmitActions(l(AB,AG),z,AE,undefined,-1,AD,this.objectType);}function G(z){(z||[]).forEach(function(AA){delete AA.dmy;var AB=AA.nds;if(AB){G(AB);}});}function c(){var AC=this.content,z=this.model,AG=z.thresholds,AB=this,AD=[],AF=AC.rowPanel,AE=AG&&AG[z.metricId],AA=0;if(AE){AE.forEach(function(AH){G(AH.expr.nds);AD.push({scriptClass:"mstrmojo.threshold.ThresholdRow",threshold:AH,editor:AB,model:z,idx:AA++});});}AF.destroyChildren(false);AF.addChildren(AD);this.updateScrollbars();}function m(){var AE=this.content.rowPanel,AC=AE.children,AA=(AC&&AC.length)||0,AB=this.model,AF=AB.thresholds,AD=AF&&AF[AB.metricId],z={expr:{et:14,fn:19}},AG={et:a.AE};if(!AF){AF=AB.thresholds={};}if(!AD){AD=AF[AB.metricId]=[];}AD.push(z);AE.addChildren([{scriptClass:"mstrmojo.threshold.ThresholdRow",threshold:z,editor:this,model:AB,idx:AA}]);if(this.disableElementsBrowsing&&this.disableElementsBrowsing()){AG.et=a.AQ;}AE.children[AA].exprTree.newCondition(AG);this.updateScrollbars();}function v(AA){var z=this.model,AC=z.thresholds,AB=AC&&AC[z.metricId];if(AB){AB.forEach(function(AD){z.toggleThresholdSelected(AD,AA);});}}function J(AD,AE){var z=this.controller,AA=this.model,AB=this.metricId,AC=AA.selectedThresholds;if(AC.length>0){z.onSaveThresholds(l(AA,AC),AB,-1,AD,AE);}}function M(AA){var AC="mstrIVE_THRESHOLD_SAVER",z=AA.controller.dataService.model,AB=mstrmojo.all[AC];if(!AB){AB=new mstrmojo.SaveAsEditor({id:AC,zIndex:AA.zIndex+1,folderLinksContextId:32,rootFolderID:z.isnew?null:z.pfid,showCompletePath:false,saveParams:{},typeDesc:mstrmojo.desc(3647,"Thresholds"),saveAs:function(AF){var AD=this.contPanel;this.name=AD.name.value;this.desc=AD.desc.value;if(!this.name){mstrmojo.alert(mstrmojo.desc(3380,"Please enter valid name"));return ;}var AG=this.saveParams||{};AG.folderId=this.ob.currentFolder.did;AG.name=this.name||"New Thresholds";AG.saveAsOverwrite=!!AF;var AE=this.saveAsCallback();AE.failure=function(AI){var AH=AI.code,AJ=this.parent;if(AH==="-2147217373"||AH==="-2147216857"){mstrmojo.warn(mstrmojo.desc(7986,"The ## '###' already exists. Do you want to replace the existing one?").replace("##",AJ.typeDesc||"Object").replace("###",AJ.name),{confirmBtn:{fn:function(){AJ.saveAs(true);}}},{title:mstrmojo.desc(3179,"Confirm Overwrite"),zIndex:AJ&&AJ.zIndex+10});}else{mstrmojo.alert(mstrmojo.desc(7985,"Error while saving: ")+AI.message);}};AE.parent=this;J.call(AA,AG,AE);}});AB.render();}AB.open();}function g(AB){var AG="mstrIVE_THRESHOLD_LOADER",AE=mstrmojo.all[AG],AA=AB.controller.dataService.model,AF=[72];if(!AE){AE=new mstrmojo.vi.ui.editors.ObjectPicker({id:AG,supportedTypes:mstrmojo.array.hash(AF),zIndex:AB.zIndex+1,rootFolderID:AA.isnew?null:AA.pfid,onOpen:function z(){this.browse();},postBuildRendering:function AD(){mstrmojo.Editor.prototype.postBuildRendering.apply(this);},OKFn:function(AH){if(AH){AB.controller.onLoadThresholds(AB.metricId,AH.did);}}});var AC=AE.ob;AC.set("folderLinksContextId",32);AC.set("multiSelect",false);AC.set("searchVisible",true);AC.set("upButtonVisible",true);AC.set("browsableTypes","8,"+AF.join(","));AE.render();}AE.open();}function S(AA){if(!AA){return ;}if(AA.t===Z.Consolidation&&AA.st===t.ConsolidationManaged){var z=mstrApp&&mstrApp.rootCtrl&&mstrApp.rootCtrl.docCtrl&&mstrApp.rootCtrl.docCtrl.model;if(z&&z.findUnitInDataSet){AA=z.findUnitInDataSet(AA.did);if(AA&&AA.attId){AA=z.findUnitInDataSet(AA.attId);}}}return AA.t===Z.Attribute&&AA.st===t.AttributeRecursive;}function F(AA){var AB=P.clone(AA);if(!(AB.node&E.CONDITION)&&S(AB.a)){AB={et:a.ANDOR,fn:mstrmojo.expr.FN.AND,node:E.CONDITION,nds:[AB]};}if(AB&&AB.et===a.ANDOR&&(AB.node&E.CONDITION)){var AC=P.valarray(N.findTargets(AB,"did"))[0],z={et:a.ANDOR,data:AB};switch(AC&&AC.t){case Z.Attribute:case Z.Consolidation:z.a=AC;break;case Z.Metric:z.m=AC;break;}return z;}return AB;}mstrmojo.threshold.AdvancedThresholdEditor=mstrmojo.declare(mstrmojo.Editor,[mstrmojo.ui._HasScroller,mstrmojo._HasPopup],{scriptClass:"mstrmojo.threshold.AdvancedThresholdEditor",cssClass:"adv-threshold",title:"Advanced Threshold Editor",help:"Advanced_Thresholds_Editor.htm",model:undefined,targets:undefined,content:undefined,buttonBar:undefined,init:function q(z){this._super(z);L=this.id;},postBuildRendering:function R(){this._super();var z=this.content;c.call(this);z.conditionWalk.set("editor",this);z.property.set("editor",this);},onOpen:function U(){c.call(this);this.setRowPanelVisibility(true);var z=this.content;z.conditionWalk.set("visible",false);z.property.set("visible",false);z.set("editorNode",this.editorNode);var AA=this.buttonBar&&this.buttonBar.quickLink;if(!!AA){AA.set("visible",this.objectType!==12);}},setupScrollNodes:function k(){this.scrollNode=this.content.containerNode;},onClose:function b(){this.model.cleanUp();},onmodelChange:function A(){var z=this.model;if(z){z.attachEventListener("modelEdit",this.id,"onmodelEdit");z.attachEventListener("selectedThresholdsChange",this.id,"onselectedThresholdsChange");c.call(this);}},onselectedThresholdsChange:function I(){},openConditionWalk:function D(AF,AE){var AC=this,AD=AC.content,AA=AE.tree.parent,z=P.clone(AA.threshold),AB=O.position(AC.titleNode);z.expr=AF;var AG=new mstrmojo.threshold.ThresholdRow({alias:"thresholdRow",slot:"conditionNode",idx:AA.idx,model:this.model,threshold:z,onclick:mstrmojo.emptyFn});AG.render();B.toggleClass(AC.content.domNode,"no-overflow",true);AC.openPopup("conditionEditorPopupRef",{editor:AC,objectBrowsingEnabled:AC.objectBrowsingEnabled,showLimits:true,targets:AC.targets,targetsLastMod:new Date(),ets:AE.tree.validExprTypes,condition:AE,hasPrompt:false,model:F(AF),left:parseInt(AB.x+(AB.w-j)/2,10)+"px",top:parseInt(AB.y+AB.h,10)+"px",zIndex:AC.zIndex+1,title:AE.isEmpty()?mstrmojo.desc(5893,"New Condition"):mstrmojo.desc(14916,"Edit Condition"),disableHierarchyLevel:true});},onmodelEdit:function V(){c.call(this);},openPropertyPanel:function H(z){this.setRowPanelVisibility(false);var AB=this.content.property,AA=AB.model=new mstrmojo.threshold.PropertyModel({thresholdRow:z,threshold:P.clone(z.threshold),gridValueFormat:P.clone(this.model.getGridValueFormat())});this.disposables.push(AA);AA.attachEventListener("propertyModelChange",z.id,"onpropertyModelChange");AB.set("visible",true);this.toggleButtonStatus(false);this.updateScrollbars();},getDatasets:function f(){if(this.model){return this.model.controller.datasets;}return null;},getIfDataSource:function X(){if(this.model){return this.model.controller.dataService;}return null;},onUpdateBrowseElementsParams:mstrmojo.emptyFn,onConditionEdit:function K(AB,AA){var z=this;z.model.setConditionData(AB,AA);z.setRowPanelVisibility(true);z.toggleButtonStatus(true);z.updateScrollbars();},conditionEditorPopupRef:{scriptClass:"mstrmojo.vi.ui.ConditionEditor",isHostedWithin:false,getIfDataSource:function X(){return this.editor.getIfDataSource();},getDatasets:function f(){return this.editor.getDatasets();},onUpdateBrowseElementsParams:function w(z){this.editor.onUpdateBrowseElementsParams(z);}},openAndORPopup:function u(AC,z){var AA=new mstrmojo.ui.menus.MenuConfig();AA.hostId=this.id;AA.hostElement=z;AA.isHostedWithin=false;AA.menuCssClass="andor-PopupList";var AB=function AB(AI){var AD=AC,AH=AI.ctxt.did,AG=AH>21?true:null,AF=AH-(AG?21:0);var AE=AD&&AD.parent;if(AE&&AE.data&&AE.data.et===a.ANDOR){AE.edit(AD,AF,AG);}else{var AJ=AD&&AD.data;if(AJ&&(AJ.not!==AG)){AJ.not=AG;AD.paint();}}};AA.addMenuItem(h[19],"",AB,{did:19});AA.addMenuItem(h[20],"",AB,{did:20});AA.addMenuItem(h["19_21"],"",AB,{did:19+21});AA.addMenuItem(h["20_21"],"",AB,{did:20+21});this.openPopup(AA.newInstance());},toggleButtonStatus:function C(z){this.buttonBar.children.forEach(function(AA){AA.set("enabled",z);});},setRowPanelVisibility:function Q(AA){var z=this.content;z.rowPanel.set("visible",AA);z.newCondition.set("visible",AA);this.updateScrollbars();},children:[{scriptClass:"mstrmojo.Widget",alias:"rulesTitles",markupString:"<div class='rulesTitles'><div class='container'></div><div class='order'>"+mstrmojo.desc(3095,"Order")+"</div><div class='condition'>"+mstrmojo.desc(11890,"Threshold Conditions")+"</div><div class='format'>"+mstrmojo.desc(11891,"Format Preview")+"</div></div>"},{scriptClass:"mstrmojo.Box",cssClass:"content",alias:"content",editorNode:undefined,markupString:'<div id="{@id}" class="mstrmojo-Box {@cssClass}" style="{@cssText}"><div class="scroll-container"></div></div>',markupSlots:{containerNode:function(){return this.domNode.firstChild;}},rowPanel:undefined,newCondition:undefined,conditionWalk:undefined,property:undefined,children:[{scriptClass:"mstrmojo.threshold.ThresholdRowPanel",alias:"rowPanel",children:[]},{scriptClass:"mstrmojo.Label",alias:"newCondition",cssClass:"link",text:mstrmojo.desc(4585,"New Threshold"),onclick:function e(){m.call(mstrmojo.all[L]);}},{scriptClass:"mstrmojo.threshold.ConditionWalk",alias:"conditionWalk",height:"300px",width:"750px",visible:false},{scriptClass:"mstrmojo.threshold.PropertyPanel",alias:"property",visible:false}]},{alias:"buttonBar",scriptClass:"mstrmojo.Box",slot:"buttonNode",children:[d(mstrmojo.desc(221,"Cancel"),function(){mstrmojo.all[L].close();},false,{enabled:true,alias:"cancelBtn"}),d(mstrmojo.desc(1442,"OK"),function(){r.call(mstrmojo.all[L],false);mstrmojo.all[L].close();},true),d(mstrmojo.desc(2031,"Apply"),function(){r.call(mstrmojo.all[L],true);},true),{scriptClass:"mstrmojo.Label",cssClass:"link",alias:"quickLink",text:mstrmojo.desc(14004,"Quick Thresholds Editor..."),onclick:function e(){var AB=mstrmojo.all[L],AA=AB.model,z=AB.controller,AD=AA.isAdvanced(AA.metricId),AE=function(){AB.close();AA.editorMode=mstrmojo.threshold.ThresholdModel.EDITOR_TYPES.SIMPLE_EDITOR;},AC=[d(AD?mstrmojo.desc(1442,"OK"):mstrmojo.desc(2827,"Clear"),function(){AE();z.openEditor();},AD,AD?undefined:{cssClass:"nosave"})];if(!AD){AC.push(d(mstrmojo.desc(2031,"Apply"),function(){AE();r.call(AB,true);},true));}AC.push(d(mstrmojo.desc(2223,"Cancel")));mstrmojo.warn(AD?mstrmojo.desc(13998,"This action will clear the thresholds definition. Do you want to proceed?"):mstrmojo.desc(13999,"Do you want to apply your thresholds before using the Quick Thresholds Editor?"),undefined,{cssClass:AD?undefined:"save-threshold-warning",buttons:AC});}}]}]});}());(function(){mstrmojo.requiresCls("mstrmojo.Obj","mstrmojo.hash","mstrmojo.threshold.ThresholdModel","mstrmojo.threshold.SimpleThresholdEditor","mstrmojo.threshold.AdvancedThresholdEditor");var $HASH=mstrmojo.hash,SIMPLE_THRESHOLD_ID="mstrmojo-simple-threshold-editor",ADVANCED_THRESHOLD_ID="mstrmojo-advanced-threshold-editor",EDITOR_TYPES=mstrmojo.threshold.ThresholdModel.EDITOR_TYPES;mstrmojo.threshold.ThresholdController=mstrmojo.declare(mstrmojo.Obj,null,{scriptClass:"mstrmojo.threshold.ThresholdController",metricId:undefined,data:undefined,model:undefined,targets:undefined,editor:undefined,messageId:undefined,datasets:undefined,dataService:undefined,onSubmitActions:mstrmojo.emptyFn(),onSaveThresholds:mstrmojo.emptyFn(),onLoadThresholds:mstrmojo.emptyFn(),supportsFeature:function supportsFeature(featureId){return true;},init:function init(props){this._super(props);if(!window.numeral){var numeral=mstrmojo.loadFileSync(mstrmojo.getJsRoot()+"libraries/numeral.js.2.0.6/numeral.min.js");function evalInContext(){eval(numeral);}try{evalInContext.call(window);}catch(e){}}this.model=new mstrmojo.threshold.ThresholdModel({controller:this});},openEditor:function openEditor(){var data=this.data;if(!data){throw new Error("Visualization data not provided.");}var metricId=this.metricId,objectType=this.objectType,model=this.model,messageId=this.messageId,editor;model.set("data",$HASH.clone(data));model.metricId=metricId;model.objectType=objectType;var isAdvanced=model.isAdvanced(metricId),forceOpenEditorType=model.editorMode,forceOpenSimpleEditor=forceOpenEditorType===EDITOR_TYPES.SIMPLE_EDITOR;if(forceOpenEditorType===EDITOR_TYPES.ADVANCED_EDITOR||(!forceOpenSimpleEditor&&isAdvanced)){editor=mstrmojo.all[ADVANCED_THRESHOLD_ID]||new mstrmojo.threshold.AdvancedThresholdEditor({id:ADVANCED_THRESHOLD_ID,onUpdateBrowseElementsParams:function onUpdateBrowseElementsParams(params){var datasetId,datasets=this.controller.datasets,findAttrFn=function(attribute){return attribute.did===params.attributeID;};for(datasetId in datasets){if(datasets[datasetId].att.filter(findAttrFn).length>0){params.datasetID=datasetId;break;}}params.messageID=messageId;params.templateNodeKey=data.k;}});}else{if(isAdvanced){model.clearData();}editor=mstrmojo.all[SIMPLE_THRESHOLD_ID]||new mstrmojo.threshold.SimpleThresholdEditor({id:SIMPLE_THRESHOLD_ID});}this.editor=editor;editor.set("model",model);editor.set("controller",this);editor.set("metricId",metricId);editor.set("objectType",objectType);editor.set("title",this.title);editor.set("targets",this.targets);editor.set("allowHTMLTitle",true);editor.open();this.addDisposable([model,editor]);}});}());(function(){mstrmojo.requiresCls("mstrmojo.vi.ui.editors.FilterEditor","mstrmojo.fe.FilterEditor");mstrmojo.vi.ui.editors.ReportFilterEditor=mstrmojo.declare(mstrmojo.vi.ui.editors.FilterEditor,[mstrmojo.fe._isReportFilterEditor],{scriptClass:"mstrmojo.vi.ui.editors.ReportFilterEditor"});}());(function(){mstrmojo.requiresCls("mstrmojo.css","mstrmojo.dom","mstrmojo.func","mstrmojo.hash","mstrmojo.array","mstrmojo.ToolSeparator","mstrmojo.CheckBox","mstrmojo.Label","mstrmojo.Dialog","mstrmojo.Button","mstrmojo.fe._HasFilterEditor","mstrmojo.fe.FilterUtils","mstrmojo.vi.ui.editors.SQLCSIViewer","mstrmojo.ui.menus.MenuConfig","mstrmojo.vi.models.VIComponentMap","mstrmojo.vi.ui.VizBoxTitleBar","mstrmojo.vi.ui.ViewDataDialog","mstrmojo.vi.ui.VisAsFilterInlineDialog","mstrmojo.vi.ui.rw.UnitContainer","mstrmojo.vi.ui.editors.VisAsFilterDialog","mstrmojo.vi.ui.editors.FilterEditor","mstrmojo.vi.ui.VizGalleryList","mstrmojo.EnumRWUnitType","mstrmojo.vi.viz.KnownVisualizations","mstrmojo.vi.viz.EnumWidgetTypes","mstrmojo.vi.models.EnumDragSources","mstrmojo.vi.enums.EnumFilterClearActionType");mstrmojo.requiresDescs(2827,5282,6985,9126,11671,11672,13402,13528,14389,14810,15076,15123,15621);var AU=mstrmojo.css,AB=mstrmojo.dom,c=mstrmojo.func,O=mstrmojo.hash,K=mstrmojo.array,AG=mstrmojo.EnumRWUnitType,AR=mstrmojo.vi.viz.KnownVisualizations,AS=mstrmojo.fe.FilterUtils.isExprEmpty,S=mstrmojo.fe.FilterUtils.getExprText,AQ=mstrmojo.vi.models.EnumDragSources,v="px",AN=0,AT=2,M=mstrmojo.vi.models.VIComponentMap.TYPES,F=mstrmojo.vi.enums.EnumFilterClearActionType;var a=mstrmojo;var r="invalid",l="hasViewFilter",Ac="hasSelector",w="visible",V="mouse-left";var AW=3,AA=4;var u="web-export-to-pdf-privilege",AK="web-export-to-excel-privilege",Q="web-export-to-csv-privilege";var k=4;function N(Ad){mstrApp.onerror(Ad);}function f(Af){var Ae=this.model,Ai=this,Aj=mstrApp.isWSStyling,Ad=[{n:mstrmojo.desc(11670,"Copy to"),toLayoutTitle:mstrmojo.desc(13933,"Copy to #"),toNewLayoutTitle:mstrmojo.desc(13934,"Copy to a New Sheet"),crossLayoutMessage:mstrmojo.desc(12137,"Copying will clear all filters from the new visualization. Do you want to continue?"),cls:"",fn:function Ah(Ak,Am,An,Al){Ae.copyVisualization(Ak,Am,An,Al);}},{n:mstrmojo.desc(10461,"Move to"),toLayoutTitle:mstrmojo.desc(13935,"Move to #"),toNewLayoutTitle:mstrmojo.desc(13936,"Move to a New Sheet"),crossLayoutMessage:mstrmojo.desc(13937,"Moving will clear all filters from the new visualization. Do you want to continue?"),cls:"",fn:function Ah(Ak,An,Ao,Am){var Al=Ae.getVizContentPanel();Al.restoreAnyMaxedVizBox();Ae.moveVisualization(Ak,An,Ao,Am);}}],Ag=function Ag(Am,Al,Ak){return function(){mstrmojo.warn(Al,{confirmBtn:{fn:Ak}},{title:Am});};};Ad.forEach(function(Ak){Af.addPopupMenuItem(Ak.n,null,function(){var Aq=Ak.fn,Am=new mstrmojo.ui.menus.MenuConfig(),An=Ai.boxContent.builder.getLayoutVIMap(Ae.getCurrentLayoutKey()).getComponent(M.VIZ_CONTENT),Al=Ae.getCurrentLayoutKey(),Ao=An.panels.filter(function(Ar){return Ar.k!==An.selectedKey;}),Ap=Ae.defn.layouts.filter(function(Ar){return Ar.k!==Al;});Ao.forEach(function(Ar){var As=Ar.k;Am.addMenuItem(Ar.titleText,"",function(){Aq(Ai,An,As,Al);});});Am.addMenuItem(Aj?mstrmojo.desc(6985,"New Page"):mstrmojo.desc(11671,"New Panel"),"",function(){Aq(Ai,An,null,Al);});Am.addSeparator();Ap.forEach(function(Ar){Am.addMenuItem(Ar.title,"",Ag(Ak.toLayoutTitle.replace("#",Ar.title),Ak.crossLayoutMessage,function(){Aq(Ai,An,null,Ar.k);}));});Am.addMenuItem(Aj?mstrmojo.desc(14810,"New Chapter"):mstrmojo.desc(11672,"New Sheet"),"",Ag(Ak.toNewLayoutTitle,Ak.crossLayoutMessage,function(){Aq(Ai,An,null,null);}));return Am;},Ak.cls);});}function H(){AU.toggleClass(this.domNode,Ac,!!(this.selectorMenuCfg));AU.toggleClass(this.domNode,l,!!(this.filterMenuCfg));AU.toggleClass(this.filterBtnNode,r,!(this.filterMenuCfg));AU.toggleClass(this.selectorBtnNode,r,!(this.selectorMenuCfg));var Ae=this.parent,Ad=!!(Ae&&Ae.hasMultipleChildren&&Ae.hasMultipleChildren()&&!mstrApp.isAppStateSelection());AU.toggleClass(this.maxRestoreBtnNode,r,!Ad);AU.toggleClass(this.maxRestoreBtnNode,"restore",this.isMaxed);}function j(Ad){AU.toggleClass(this.filterBtnNode,w,Ad);AU.toggleClass(this.filterBtnNode,V,!Ad);AU.toggleClass(this.selectorBtnNode,w,Ad);AU.toggleClass(this.selectorBtnNode,V,!Ad);AU.toggleClass(this.maxRestoreBtnNode,w,Ad);AU.toggleClass(this.maxRestoreBtnNode,V,!Ad);}function d(Ad){return{scriptClass:"mstrmojo.vi.ui.VisAsFilterInlineDialog",vis:Ad,tocPanel:mstrApp.rootCtrl.view.tocPanel,shouldNavigate:true};}function P(){this.selectorMenuCfg=null;if(mstrApp.isAppStateSelection()){return ;}var Al=this,Ah=Al.model,Am=this.boxContent,Af=Am.model,Ai,Ad=function(An,Ao){return Am[An]&&Am[An](Ao);},Ak=Am.selectorControl||Ad("findSelectorControl"),Ae=Ad("isLinkedFilter"),Ag=function(){mstrApp.rootCtrl.view.openInlineDialog(d(Al));},Aj=function(){var Ar={},Aq=Ad("getAssociatedNodes")||[],As=Am.getFilterType(),Ap=Am.isVisMap,Ao=Ad("getAllLayerKeys",true),An=Af.getSelectorControlMapInfo&&Af.getSelectorControlMapInfo();K.forEach(Aq,function(At){if(Ap){K.forEach(Ao,function(Au){Ar[Au]={c:true,v:false,ft:As,cgbs:An,k:Au};});}else{Ar[At.k]={c:true,v:false,ft:As,cgbs:An,k:At.k};}});Ah.setVisAsFilter(Al,{sc:Ak,targetKeys:Ar});};if(Ae&&!mstrApp.isAppStatePresentation()){Ai=this.addDisposable(new mstrmojo.ui.menus.MenuConfig({menuCssClass:"mstrmojo-viz-fe-menu",isHostedWithin:false,useTooltip:true}));Ai.addMenuItem(mstrmojo.desc(15069,"Edit Targets..."),"",Ag);Ai.addMenuItem(mstrmojo.desc(11473,"Clear All Targets"),"",Aj);}this.selectorMenuCfg=Ai;}function A(){this.filterMenuCfg=null;if(mstrApp.isInVFInteractMode||mstrApp.isAppStateSelection()){return ;}var A5=mstrmojo.desc(2827,"Clear"),Ar=this.boxContent,A3=Ar.model,Av=this.k,At=this,BD=Ar.controller,A0=Ar.node,BG=A0.data||null,Aw=function(BI,BL,BK){var BJ=At.boxContent;return BJ&&BJ[BI]&&BJ[BI](BL,BK);},A7=mstrmojo.desc(5283,"OR"),Aq=mstrmojo.desc(5282,"AND"),BH=Aw("makeBold",A7),Ax=Aw("makeBold",Aq);if(!BG){this.filterMenuCfg=null;return ;}var BA=BG.vfexpr,Ai,Ak=BG.vlexpr,Ap=Aw("getSelectorObjectsFromTemplateLimit"),Au,An=Aw("hasKeepOnly",Ap),Ae=this.model,Am,Ad;Ai=Ae.getVfNdFromExpr(BA);Am=!AS(Ai);Ad=Ai!==BA;var Ah=this.model,Ao=Ah.getCurrentLayoutKey(),Az=(Ah.defn.layouts).filter(function(BI){return BI.k===Ao;})[0],BE=Az.cgbMap||{},A6=O.keyarray(BE).filter(function(BI){return BE[BI]===At.k;}),A9,Af,BB,BC,A1=[],Ay,Al;function Aj(BK){var BM=" "+(BK?BH:A7)+" ",BL=" "+(BK?Ax:Aq)+" ",BJ=Af.fn===20?BM:Af.fn===19?BL:"",BI=[A5+' "'];BC=A3.getSelectorDataFromViewFilter(Af);K.forEach(BC,function(BN){Al=Aw("getLinkingSelectorExpr",BN,BK);if(BI.length>1){Al=BJ+Al;}BI.push(Al);});BI.push('"');return BI.join("");}if(A6.length){K.forEach(A6,function(BI){A9=Ah.getLayoutUnitDefn(BI);Af=A9&&A9.t&&A9.t===AG.UNITCONTAINER&&A9.exp;if(Af){BB=A9.latestctlkey;if((K.filterOne(Az.units[BI].scs,function(BJ){return BJ.ckey===BB;})||{}).isNavigation){A1.push({menuString:Aj(),menuTtpString:Aj(true),ucKey:BI,ckey:BB});}}});}Ay=A1.length;if(An||Ak||Am||Ay||Ad){var A4=function A4(BI){var BK=c.wrapMethods(BD._getXtabCallback(Ar),{success:function BJ(){var BL=At.boxContent;if(BL){BL.raiseEvent({name:"regenerateToolbar"});}}});if(Ay){BK=c.wrapMethods({success:function BJ(BM){var BN=At.boxContent,BL=A6;if(BN.getSdpKeyArr){BL=A6.concat(BN.getSdpKeyArr());}Ah.partialUpdate(BM.data,Ah.getUnitDefinitions(BL),BM.defn,A6,BM.puFilters);}},BK);}if(Ar.filterMenuHandler){Ar.filterMenuHandler(BI.ctxt,BK);}};Au=this.addDisposable(new mstrmojo.ui.menus.MenuConfig({menuCssClass:"mstrmojo-viz-fe-menu",isHostedWithin:false,useTooltip:true}));if(!mstrApp.isDossier&&(An||Ay||Ad)){Au.addMenuItem(mstrmojo.desc(1763,"Clear All"),"",A4,{type:F.CLEAR_ALL});}if(An){if(Au.hasMenuItems()){Au.addSeparator();}var As=Aw("getFilterMenuPairs",Ap)||[];K.forEach(As,function(BI){Au.addMenuItem({n:BI.menuString,ttp:BI.menuTtpString},"",A4,{type:F.CLEAR_KEEP_ONLY,idx:BI.ctxt});});}if(Ad){if(Au.hasMenuItems()){Au.addSeparator();}Au.addMenuItem({n:mstrmojo.desc(15076,"Clear drill conditions"),ttp:S(Ae.getVfexprWithUpdatedVf(Av,null),true)},"",A4,{type:F.CLEAR_DRILLING});}if(Am||Ak){if(Au.hasMenuItems()){Au.addSeparator();}var A8;var A2=[];var BF=S(Ai,true),Ag=S(Ak,true);if(BF){A2.push(BF);}if(Ag){A2.push(Ag);}A2=A2.join(" "+Ax+" ");if(mstrApp.isWSStyling&&mstrApp.isAppStateDefault()){A8={n:mstrmojo.desc(14016,"Advanced Qualification")};Au.addMenuItem(A8,"",function(){At.onShowFilterEditor(At);});}else{if(!(mstrApp.isDossier||(mstrApp.isAppStatePresentation&&mstrApp.isAppStatePresentation()))){A8={n:mstrApp.isWSStyling?mstrmojo.desc(15123,"Clear advanced qualification"):mstrmojo.desc(13528,"Clear existing filter"),ttp:A2||BG.vftext};Au.addMenuItem(A8,"",A4,{type:F.CLEAR_ADV_QUALIFICATION});}}}if(Ay){Au.addSeparator();K.forEach(A1,function(BI){Au.addMenuItem({n:BI.menuString,ttp:BI.menuTtpString},"",A4,{type:F.CLEAR_LINKING,nodeKey:BI.ucKey,ckey:BI.ckey});});}}this.filterMenuCfg=Au&&(Au.hasMenuItems()?Au:null);}function AY(Ad){var Ae=mstrApp.isWorkstation&&mstrApp.supportFeature(mstrmojo.vi.enums.EnumFeatures.SUPPORT_LIVEMODE)&&mstrApp.getWSLiveMode();return(Ad===AR.GRID&&!Ae&&(!!mstrApp.features[AK]||!!mstrApp.isSingleTier));}function W(Ad){return([AR.UNKNOWN].indexOf(Ad)===-1&&(!!mstrApp.features[u]||!!mstrApp.isSingleTier));}function L(){return !!mstrApp.features[Q]||!!mstrApp.isSingleTier;}function AJ(){var Ad=AR.getDefinition(this.boxContent.model.data.visName||"Grid").id;return !(mstrApp&&mstrApp.isVisBuilder)&&(AY(Ad)||W(Ad)||L());}function AZ(Ad){var Ag=this.model.controller.id,Af=this.boxContent,Ae=Af.k;var Ah=!O.walk("gridInfo.cols.length",Af)&&!O.walk("gridInfo.rows.length",Af),Ai=mstrmojo.desc(246,"Export");if(Ah){Ad.addNonInteractiveMenuItem(Ai,null,true);}else{Ad.addPopupMenuItem(Ai,this.id,function(){var Ak=new mstrmojo.ui.menus.MenuConfig(),Aj=AR.getDefinition(this.boxContent.model.data.visName||"Grid").id;if(AY(Aj)){Ak.addMenuItem(mstrmojo.desc(3958,"Excel"),"exportToExcel",function(){mstrmojo.all[Ag].exportVisualization(Af,AA);});}if(W(Aj)){Ak.addMenuItem(mstrmojo.desc(1877,"PDF"),"exportToPDF",function(){if(Af.isClientExport&&Af.exportVisualization){Af.exportVisualization(AW);}else{mstrmojo.all[Ag].exportVisualization(Af,AW);}});}if(L()){Ak.addMenuItem(mstrmojo.desc(11807,"Data"),"exportToCSV",function(){mstrmojo.all[Ag].exportCSV(Ae);});}return Ak;},"export");}}function h(Ae){var Af=this.boxContent,Ad=(Af.getDocModel&&Af.getDocModel())||Af.model.docModel;Ae.addPopupMenuItem(mstrmojo.desc(13165,"Change Visualization"),this.id,function(){var Ai=new a.ui.menus.MenuConfig({supportsScroll:true,maxHeight:AB.windowDim().h-50}),Aj=Ad.getVizOfSelectedViUnit(),Ag=Af.controller.galleryPanel,Ak=Ag.vizList,Al=Ak.items.length>0,Am=Ag.customVizList;function Ah(An,Ao){if(An.id!=="VisGrid"&&a.ExpressVisList.getVis(An.s)===null){return ;}Ai.addMenuItem(An.n,An.id===(Aj&&Aj.id)?"on":"",function(){var Ap=K.find(Ao.items,"id",An.id);Ao.select([Ap]);});}Ai.hasToggleItem=true;if(Al){Ai.addMenuTitle(mstrmojo.desc(14119,"Built-in"));Ak.items.forEach(function(An){Ah(An,Ak);});}if(Am.items.length>0){if(Al){Ai.addSeparator();}Ai.addMenuTitle(mstrmojo.desc(2056,"Custom"));Am.items.forEach(function(An){Ah(An,Am);});}return Ai;},"");}function AL(Ad,Af){var Ae=Ad.getCtxtDragData();this.getZonesModel().addUnitsFromDataSource(Ae.items,Ae.dsid,Ad.actions,Af?Ad.callback:null);}function AX(){var Af=this.parent,Ad=this.boxContent,Ae=false;if(Ad.handlesMultiSelection){if(mstrApp.isWSStyling){if(this.getDocModel().getVisibleUnitKeysByType([AG.GRID,AG.GRAPH,AG.MOJOVISUALIZATION]).length>1){Ae=true;}}else{if(Af&&Af.getTargetKeysByType([AG.GRID,AG.GRAPH,AG.MOJOVISUALIZATION]).length>1){Ae=true;}}}return Ae;}function AM(Ae,Ad,Ag){var Ah=this.id;Ae=document.createElement("div");Ae.className=Ad;var Af=function(){var Al=mstrmojo.all[Ah],Aj=Al[Ag];Aj.hostId=Ah;Aj.hostElement=Ae;if(Aj.hasMenuItems()){var Am=new mstrmojo.ui.menus.Menu({popupConfig:Aj,getTooltipText:function Ai(An){return(An&&An.ttp)||"";}});Am.tooltipCss={enableHover:true,leftCssClass:"menuTooltip mstrmojo-VIBox",rightCssClass:"menuTooltip mstrmojo-VIBox",updatePosition:function Ak(){mstrmojo.Tooltip.prototype.updatePosition.call(this);var Av=this.domNode,As=this.arrowNode,At=Av.getBoundingClientRect(),An=At.top,Ap=Math.max(document.documentElement.clientHeight,window.innerHeight||0),Au=Am._getItemNode(Am._lastHoverIx),Ar=(Au&&Au.getBoundingClientRect())||{},Ao=At.top+this.containerNode.offsetHeight,Aq=Ao+10-Ap;if(Aq>0){Av.style.top=(An=At.top-Aq)+"px";}if(Ar&&Ar.top){As.style.top=Ar.top-An+6+"px";}}};Al.openPopup(Am);}};AB.attachEvent(Ae,"click",Af);this.domNode.appendChild(Ae);this.installedEvtListeners.push({e:Ae,evt:"click",fn:Af});return Ae;}function n(Ad){var Af=this.id;Ad=document.createElement("div");Ad.className="hover-max-restore-btn";var Ae=function(){var Ag=mstrmojo.all[Af],Ah=Ag.isMaxed;Ag.parent.setPortalState(Ag,Ah?AN:AT);if(Ah){delete Ag.isMaxed;}else{Ag.isMaxed=true;}AU.toggleClass(Ad,"restore",Ag.isMaxed);};AB.attachEvent(Ad,"click",Ae);this.domNode.appendChild(Ad);this.installedEvtListeners.push({e:Ad,evt:"click",fn:Ae});return Ad;}mstrmojo.vi.ui.rw.VizBox=mstrmojo.declare(mstrmojo.vi.ui.rw.UnitContainer,[mstrmojo.vi.ui._CanDropFromSchema,mstrmojo.fe._HasFilterEditor],{scriptClass:"mstrmojo.vi.ui.rw.VizBox",filterEditorScriptClass:"mstrmojo.vi.ui.editors.FilterEditor",showTitleBar:true,titleBar:null,selectorMenuCfg:null,selectorBtnNode:null,filterMenuCfg:null,filterBtnNode:null,maxRestoreBtnNode:null,generateToolbarSub:null,init:function AD(Ad){this._super(Ad);AU.addWidgetCssClass(this,"mstrmojo-VIBox");this.isMaxed=(this.defn.ds===AT);this.installedEvtListeners=[];},unrender:function(Ad){K.forEach(this.installedEvtListeners,function(Ae){AB.detachEvent(Ae.e,Ae.evt,Ae.fn);});this.installedEvtListeners=[];delete this.filterBtnNode;delete this.selectorBtnNode;delete this.maxRestoreBtnNode;this._super(Ad);},getPanelForAddAction:function AP(){return"editPanel";},getExcludedPanels:function AV(){return[];},getDocModel:function E(){var Ad=this.model;return Ad.docModel||Ad;},editingTitleCallback:function C(Ad){this._super(Ad);AU.toggleClass(this.filterBtnNode,"editing-title",Ad);AU.toggleClass(this.selectorBtnNode,"editing-title",Ad);AU.toggleClass(this.maxRestoreBtnNode,"editing-title",Ad);},getTitleBarCfg:function x(){var Ad=this._super();Ad.scriptClass="mstrmojo.vi.ui.VizBoxTitleBar";Ad.close=function Ag(){var Ai=this.parent,Ah=Ai.parent;Ah.deleteBoxAndSubmit(Ai);Ah.removeChildren(Ai);Ai.destroy();};Ad.beganEditingTitlebar=function Af(){var Ah=this.parent;Ah.draggable=false;Ah.editingTitleCallback(true);};Ad.titleEdited=function Ae(Ai,Am,Ah){var Al=this.parent;Al.draggable=true;if(Am){var Ak=Al.getDocModel();Ak.renameRWUnitTitle(Ai,this.title,Al.k,{success:function An(Ao){Al.defn.ttl=Ao;Al.set("title",Ao);},failure:function Aj(Ao){N(Ao);Al.titleBar.set("title",Ah);}});}Al.editingTitleCallback(false);};return Ad;},getTitleVisibilityFmts:function R(Ae){var Ad=this._super(Ae);Ad.FormattingView.ShowWidgetTitleBar=Ae;return Ad;},onclick:function z(){this.model.setVizBoxActive(this.id);this.titleBar.onclick();},switchPropertyOnClick:function AE(Ad){var Ae=this.boxContent;if(!Ae||!Ae.supportsEditorClickSwitching||Ad.e.justSwitched){return false;}return this._super();},postBuildRendering:function Aa(){try{this._super();this.selectorBtnNode=AM.call(this,this.selectorBtnNode,"hover-selector-btn","selectorMenuCfg");this.filterBtnNode=AM.call(this,this.filterBtnNode,"hover-filter-btn","filterMenuCfg");if(this.defn.ds===AT){this.parent.setPortalState(this,AT,true);}this.maxRestoreBtnNode=n.call(this,this.maxRestoreBtnNode);H.call(this);if(this.menuBtnInfo&&this.menuBtnInfo.btn){AB.attachEvent(this.menuBtnInfo.btn,"mousedown",function(){this.generateToolbar();}.bind(this));}var Ae=this;this.getDocModel().attachEventListener("vizBoxActive",Ae.id,function(Ah){j.call(Ae,Ae.id===Ah.id);var Ai=Ae.menuBtnInfo;if(Ai&&Ai.menuCfg){AU.toggleClass(Ai.btn,w,Ae.id===Ah.id);AU.toggleClass(Ai.btn,V,Ae.id!==Ah.id);}if(Ae.id===Ah.id){Ae.selectVIUnit();}});this.getDocModel().attachEventListener("visActive",Ae.id,function(Ah){if(Ae.boxContent&&Ae.boxContent.id===Ah.id){this.model.setVizBoxActive(Ae.id);}});}catch(Af){var Ag=this.domNode.appendChild(document.createElement("div"));Ag.className="errorNode";Ag.innerText=mstrmojo.desc(11461,"There was an error rendering your visualization");this.getZonesModel=function Ad(){return null;};}},doLayout:function t(){var Ad=this.boxContent;if(Ad){Ad.skipReRender=true;}this._super();if(Ad){delete Ad.skipReRender;}},applyBoxSize:function U(Ad,Af,Aj,Ai){this._super(Ad,Af,Aj,Ai);var Ah=this.boxContent,Ae=Ah&&Ah.getFormats();if(Ae){var Ag=this.titleBar.visible?AB.position(this.titlebarNode).h:0;Ae.height=(parseInt(Ad,10)-Ag)+v;Ae.width=Af;}},updateDisplayName:function p(Ad,Ae){this._super(Ad,Ae,true);},createDeleteUpdate:function g(){var Ah=this.model,Ak=Ah.getDataService().newUpdate(),Aj=this.boxContent.node.k,Ai=this.parent._tgtSelections,Ag=Ah.getSourceFilterKeys(Aj,true),Ae=Ag.concat(Ah.getTargetFilterKeys(this)),Af=[],Ad;this.parent.children.forEach(function(Am){var Al=Am.defn,An=Al.tks;if(An){if((An||"").split("\u001E").indexOf(Aj)>-1){Ak.addActions(Ah.getDataService().getRemoveCtrlTargetAction(Al.ck,Aj,undefined,true));if(Am.defn&&Am.defn.srct&&Am.defn.srct===k){Ak.setTreesToRender(3);}}}});if(Ai){Ai.remove(Aj);}if(Ae){Ak.setTreesToRender(3);}Ak.addUpdate(Ah.getRemoveUnitUpdate({unit:this,partialRetrievalKeys:Ae,clearTargets:true}));K.forEach(Ag,function(Al){Ad=Ah.getVisualizationByKey(Al);if(Ad){Af.push(Ad);}});Ak.addUpdate(Ah.associatedNodesUpdate(Af.concat(this.parent.children)));return Ak;},generateToolbar:function B(){var Ai=this.parent,Ae=Ai&&Ai.parent;if(Ae){var Ad=this.model.controller,Ag=this.model.getLayoutKeyByUnitKey(Ae.k),Af=Ad.view.getLayoutByKey(Ag),Ah=Ad.view.layoutViewer;if(Af){if(Af.k===Ah.k){if(this.generateToolbarSub){Af.detachEventListener(this.generateToolbarSub);delete this.generateToolbarSub;}}else{if(!this.generateToolbarSub){this.generateToolbarSub=Af.attachEventListener("generateVizBoxToolbar",this.id,"generateToolbar");}return ;}}}P.call(this);A.call(this);if(this.hasRendered){H.call(this);}this._super();},updateToolbar:function Y(Aj){var Al=this,Ao=this.boxContent,Ag=this.canShowDesignMenuItems(),Am=Ao&&Ao.excludeData,Ai=function(){if(!mstrApp.isDossier&&!mstrApp.isInVFConfigMode&&!Am){Aj.addMenuItem(mstrmojo.desc(11476,"Show Data"),"shwd",function(){mstrmojo.vi.ui.ViewDataDialog.open(mstrmojo.all[Al.id]);});}},Af=mstrApp.isAppStatePresentation(),Ak=mstrApp.isLayoutModePreview(),An=mstrApp.isWSStyling,Ah=An?mstrmojo.desc(15087,"Select Targets..."):mstrmojo.desc(11958,"Use as Filter...");Aj.supportsScroll=true;Aj.isHostedWithin=false;Aj.maxHeight=AB.getMaxScrollHeight();if(!Af&&mstrApp.allowWebDashboardDesign()){var Ae=this.model.hasMDXRADataset();h.call(this,Aj);if(Ao.getContainerMenuItems){Ao.getContainerMenuItems(Aj);}Aj.addSeparator();var Ad=Ao.zonesModel;if(Ad&&Ad.canSwapAxis()){Aj.addMenuItem(mstrmojo.desc(11658,"Swap"),"",function(){Ad.swapAxis();});Aj.addSeparator();}if(Ad&&Ad.canDefineSubtotals()){Aj.addToggleMenuItem(mstrmojo.desc(6193,"Show Totals"),"",function(){Ad.showQuickSubtotals();},function(){Ad.hideDefinedSubtotals();},null,Ad.hasVisibleSubtotals());Aj.addSeparator();}if(mstrApp.supportAdvFilter&&!mstrApp.isInVFInteractMode&&!Ae){Aj.addMenuItem(mstrmojo.desc(13402,"Edit Filter..."),"",function(){Al.onShowFilterEditor(Al);});}if(!mstrApp.isInVFConfigMode&&!mstrApp.isInVFInteractMode){if(AX.call(this)){Aj.addMenuItem(Ah,"uaf",function(){var Aq=mstrmojo.all[Al.id],Ap=Al.model&&Al.model.getVizContentPanel();if(Ap){Ap.restoreAnyMaxedVizBox();}mstrApp.rootCtrl.view.openInlineDialog(d(Aq));});Aj.addSeparator();}}if(!Am){Aj.addMenuItem(mstrmojo.desc(15621,"Query Details..."),"",function(){var Aq=mstrmojo.all.sqlViewer,Ar=Al.boxContent&&Al.boxContent.model&&Al.boxContent.model.data,Ap=Ar&&Ar.csi;if(!Aq){Aq=mstrmojo.insert({id:"sqlViewer",title:mstrmojo.desc(15619,"Query Details"),scriptClass:"mstrmojo.vi.ui.editors.SQLCSIViewer"});}Aq.set("csiText",Ap||"");Aq.open();});}Ai();if(!mstrApp.isInVFConfigMode&&!mstrApp.isInVFInteractMode){Aj.addMenuItem(mstrmojo.desc(14389,"Remove Data"),"",function(){Al.vizRemoveDataHandler(Ao);});}Aj.addPopupMenuItem(mstrmojo.desc(12949,"Data Source"),this.id,function(){var At=new mstrmojo.ui.menus.MenuConfig(),Ar=Al.model,As=Ar.datasets,Aq=Al.boxContent.model.data.datasetId||"",Ap=[];O.forEach(As,function(Au,Av){Ap.push({name:Au.name,id:Av});});if(!Ae){Ap.push({name:mstrmojo.desc(5949,"None"),id:""});}Ap.forEach(function(Au){var Av=Au.id;At.addMenuItem(Au.name,Aq===Av?"on":"",function(){var Aw=Al.k,Ax=Av;if(Aq===Av){return ;}Ao.zonesModel.submitActionForDatasetUpdate({act:"editNode",nodeKey:Aw,treeType:Al.defn.tt,datasetId:Ax||"00000000000000000000000000000000",partialRetrieval:{nodes:[Aw]}});});});At.hasToggleItem=true;return At;});Aj.addSeparator();if(AJ.call(this)&&!mstrApp.isInVFConfigMode&&!mstrApp.isInVFInteractMode&&!Am){AZ.call(this,Aj);}if(!Ak&&Ag&&!mstrApp.isInVFConfigMode&&!mstrApp.isInVFInteractMode&&!mstrApp.isVisBuilder){Aj.addMenuItem(mstrmojo.desc(3397,"Duplicate"),"dup",function(){var Ap=Al.model&&Al.model.getVizContentPanel();if(Ap){Ap.restoreAnyMaxedVizBox();}Al.model.duplicateVisualization(Al);});f.call(this,Aj);}Aj.addSeparator();if(!mstrApp.isInVFConfigMode){this.addToggleTitleMenuItem(Aj);if(Ao.addToggleToolbarMenuItem){Ao.addToggleToolbarMenuItem(Aj);}}}else{Ai();if(AJ.call(this)&&!mstrApp.isInVFConfigMode&&!mstrApp.isInVFInteractMode){AZ.call(this,Aj);}}this._super(Aj);if(!Af&&mstrApp.allowWebDashboardDesign()&&!mstrApp.isInVFConfigMode&&!mstrApp.isInVFInteractMode){Aj.addSeparator();Aj.addMenuItem(mstrmojo.desc(9126,"More Options...")+"...","",function(){var Ap=Al.getEditorModel(),Aq=Ap.getHost().model,As=Aq&&Aq.data,Ar=(As&&As.gsi&&As.gsi.prop)||{};if(Ao instanceof mstrmojo.vi.ui.rw.Xtab){Ap.openMoreOptionsEditor(Ar,true,As.lhv);}else{Ap.openMoreOptionsEditor(Ar);}});}return Aj;},vizRemoveDataHandler:function X(Ad){if(Ad.scriptClass==="mstrmojo.VisMapBase"){Ad.reset();}else{var Ae=Ad&&Ad.zonesModel;if(Ae&&Ae.docModel){Ae.clearAllDropZones(Ae.docModel.clearVisAsFilterAction(this));}}},addFormatMenuItem:function G(Ah,Ag,Ad){var Af=this.getEditorModel(),Ae=Af.getFormatToTargetFn&&Af.getFormatToTargetFn();if(Ae){Ad=Ad?c.composite([Ad,Ae]):Ae;}return this._super(Ah,Ag,Ad);},getFormatMenuItemTarget:function e(Af){var Ad=this.boxContent;if(Ad.getFormatMenuItemTarget){var Ae=Ad.getFormatMenuItemTarget(Af);if(Ae!==undefined){return Ae;}}return this._super(Af);},getZonesModel:function AO(){return this.boxContent.zonesModel;},allowDropFromDataset:function AI(Ad){var Ae=this.boxContent;if(Ae&&Ae.allowBoxDropFromDataset){return Ae.allowBoxDropFromDataset(Ad);}return true;},dropFromDataset:function o(Ad){AL.call(this,Ad,false);},dropFromAllObjects:function Z(Ad){this.augmentDropContextForSchema(Ad,this.getZonesModel().docModel);AL.call(this,Ad,true);},isDragValid:function q(Ad){var Ae=this.boxContent;if(Ae.canOnlyDragOnTitleBar){if(!AB.contains(this.titleBar.getLabelNode(),Ad.src.node,true,this.domNode)){return false;}}return this._super(Ad)&&!this.isMaxed;},menuDisplayCallback:function I(Ad){this._super(Ad);j.call(this,Ad);},getAvatarCls:function AH(){return this._super().concat(["viz-avi"]);},ondragenter:function D(Ae){var Af=this.boxContent,Ad=Ae.getCtxtDragData().src;if(Af.handleDndForParentNode&&Af.ondragenter){if(Ad===AQ.DATASETS||Ad===AQ.VIZ_EDITOR||Ad===AQ.VIZ||Ad===AQ.ALL_OBJECT_LIST){Af.ondragenter(Ae);return ;}}this._super(Ae);},ondragleave:function m(Ae){var Af=this.boxContent,Ad=Ae.getCtxtDragData().src;if(Af.handleDndForParentNode&&Af.ondragleave){if(Ad===AQ.DATASETS||Ad===AQ.VIZ_EDITOR||Ad===AQ.VIZ||Ad===AQ.ALL_OBJECT_LIST){Af.ondragleave(Ae);return ;}}this._super(Ae);},setTitleBarVisibility:function b(Ad){this._super(Ad);this.titleBar.onclick();},onmouseenter:function AF(Ad){this._super(Ad);j.call(this,true);},onmouseleave:function Ab(Ad){this._super(Ad);j.call(this,false);},validateTarget:function AC(){return true;},getNodeKeys:function J(){var Ae=this.boxContent,Ad=Ae&&Ae.isVisMap;return(Ad&&Ae.getNodeKeys)?Ae.getNodeKeys():[this.k];}});mstrmojo.vi.ui.rw.VizBox.ENUM_PORTAL_STATE={RESTORE:AN,MAXIMIZE:AT};}());(function(){mstrmojo.requiresCls("mstrmojo.vi.ui.rw.Xtab","mstrmojo.vi.ui._CustomSortXtabCellHoverMgr","mstrmojo.vi.ui.rw.CustomSortAvatar");mstrmojo.requiresClsP("mstrmojo","array","dom","css");var K=mstrmojo.array,G=mstrmojo.dom,L=mstrmojo.hash,W=mstrmojo.css;function I(b,a,c,Z){var Y=this.getCellForNode(b),d=a&&this.getCellForNode(a);return{e:Y._e.id,rele:d&&d._e&&d._e.id,before:c,flag:Z?1:0};}mstrmojo.vi.ui.rw.CustomSortXtab=mstrmojo.declare(mstrmojo.vi.ui.rw.Xtab,null,{scriptClass:"mstrmojo.vi.ui.rw.CustomSortXtab",cssClass:"mstrmojo-CustomSortXtab",cellHoverMgr:"mstrmojo.vi.ui._CustomSortXtabCellHoverMgr",isCustomSort:true,selCells:null,appliedSortActions:null,cachedSortActions:null,init:function R(Y){this.appliedSortActions=[];this.cachedSortActions=[];this._super(Y);},getAppliedSortActions:function U(){return L.clone(this.appliedSortActions);},getAllSortActions:function V(){var Y=L.clone(this.appliedSortActions),Z=L.clone(this.cachedSortActions);return Y.concat(Z);},scrolled:function C(){var Y=this.scrollboxNode,Z=this.zone&&this.zone.domNode;if(Y&&Z){return G.position(Y).y!==G.position(Z).y;}},validCustomSortTgtRow:function J(Z){var a=G.findAncestorByName(this.selCells&&this.selCells[0],"tr",true,this.zone.tableNode),Y=Z&&Z.rowIndex,b=a&&a.rowIndex;if(Y===undefined||b===undefined){return false;}return !(Y===0&&this.scrolled()||b===Y||b===Y+1);},getRelElementInfo:function E(f){var d,e;if(G.checkTagName(f,"td")){var c=G.findAncestorByName(f,"tr"),a=G.findAncestorByName(c,"table"),Z=c.rowIndex===0,b=c.rowIndex===a.rows.length-1,Y=this.getCellForNode(f);if(Z){d=false;}else{if(b){d=true;}else{d=Y.hcd&&!Y.epd;}}if(Z||b){e=null;}else{e=d?a.getElementsByTagName("tr")[c.rowIndex+1].cells[f.cellIndex]:f;}}return{before:d,relEle:e};},getActionMgr:function H(){var Z=this.getCSDisplayPanel(),Y=Z&&Z.actionMgr;return Y;},getCSDisplayPanel:function Q(){return this.parent.parent.parent;},delegateToActionMgr:function A(Z,d,b,a){var c=this.getActionMgr(),Y=c.wrapUnsilentAction(K.ensureArray(Z),d,b,a);c.execute(Y);},onclick:function X(h){var c=h.getTarget&&h.getTarget(),d=h.e,b=d.button===2||G.isMac()&&G.ctrlKey(h.hWin,d)&&d.button===0;if(!c||b){return ;}var g=this.isSorting(),Z=G.checkTagName(c,"td")?c:G.findAncestorByName(c,"td");if(c.hasAttribute("rabtn")&&!g){this._super(h);}else{if(Z&&Z.classList.contains("xtab-td")){var j=this.selCells||[],a=G.findAncestorByName(Z,"tr"),f=this;if(g){if(this.validCustomSortTgtRow(a)){K.forEach(j,function(k){f.handleSelection({},null,k);f.clearHighlights();var l=f.getRelElementInfo(Z),n=f.getActionMgr(),m=I.call(f,k,l.relEle,l.before,0),e=n.wrapCustomSortAction(m,k,l.relEle);n.execute(e);});this.cellHoverMgr.toggleCueDisplay(false);this.toggleSortingStatus(false);}}else{if(a.rowIndex>0){this.resetRAcellsHighlight();this.handleSelection(h.e,h.hWin,Z);var Y=[];K.forEach(a&&a.children,function(e){if(G.checkTagName(e,"td")){Y.push(e);}});this.highlightCells(Y);this.toggleSortingStatus(true,Z);}}}}},isSorting:function N(){return(this.selCells||[]).length>0;},cancelSortingSelection:function S(){var Y=this.selCells||[],Z=this;K.forEach(Y,function(a){Z.handleSelection({},null,a);Z.clearHighlights();});this.cellHoverMgr.toggleCueDisplay(false);this.toggleSortingStatus(false);},handleSelection:function O(d,Y,c){var f=G.findAncestorByName(c,"td",true,this.viewport);if(f){var b="xtabSel",Z=K.filter(this.selCells,function(e){return e!==f;}),a=Z.length<(this.selCells||[]).length;W.toggleClass(f,b,!a);if(a){this.selCells=Z;}else{this.selCells=this.selCells||[];this.selCells.push(f);}}},toggleSortingStatus:function D(Z,Y){this.toggleSortingClass(Z);this.toggleAvatar(Z,Y);},toggleSortingClass:function F(Y){W.toggleClass(this.domNode,"sorting",Y);},toggleAvatar:function B(b,Z){var a=this.csAvatar,c=this;if(b){if(!a){a=this.csAvatar=new mstrmojo.vi.ui.rw.CustomSortAvatar({zIndex:30,onclick:function(j){var k=j.getTarget&&j.getTarget(),l=k&&k.classList;if(l.contains("icon")&&l.contains("close")){c.cancelSortingSelection();this.close();}}});this.addDisposable(a);}var f=this.getCellForNode(Z),h=G.position(this.parent.domNode),d=G.position(this.zone.tableNode),e=h.y+14,Y=d.x+d.w+14,g=168;if(Y+g>h.x+h.w){Y=h.x+h.w-g;}a.open(null,{text:f.v||(f._e&&f._e.n),top:e+"px",left:Y+"px"});}else{if(a){a.close();}}},getCallbackForRACollapseExpand:function M(Z){var Y=this.getCSDisplayPanel();return{success:function(){Y.getVizBox().boxContent.highlightRAcells(Z,true);}};},highlightGroupCells:function P(b,Z){if(this.getActionMgr().getContSlientActionsBefore().length>0){var a=this.zone.tableNode,c=[],Y=[];K.forEach(b,function(d){c=c.concat(K.map(d,function(e){return e._ei;}));});if(c.length>0){K.forEach(a.getElementsByTagName("td"),function(e){var d=parseInt(e.getAttribute("ei"),10);if(c.indexOf(d)>-1){Y.push(e);if(Y.length===c.length){return false;}}});}this.highlights=this.highlights.concat(Y);K.forEach(Y,function(e,m){var d=mstrmojo.vi.ui.rw._XtabHighlights.GROUP_BORDER_CSS,h=[d.cssClass],j=a.getElementsByTagName("tr"),l=e.parentElement.rowIndex,k=e.cellIndex,f=Y[m-1]&&Y[m-1]===(j[l-1]&&j[l-1].cells[k]),g=Y[m+1]&&Y[m+1]===(j[l+1]&&j[l+1].cells[k]);if(f){if(g){h.push(d.midVert);}else{h.push(d.bottom);}}else{if(g){h.push(d.top);}}W.addClass(e,h);});}else{return this._super(b,Z);}}});}());(function(){mstrmojo.requiresCls("mstrmojo.Obj","mstrmojo.DynamicClassFactory","mstrmojo.ListDocSelector","mstrmojo.TextBoxDocSelector","mstrmojo.SearchBoxDocSelector","mstrmojo.MetricQualDocSelector","mstrmojo.MetricSliderDocSelector","mstrmojo.AttrQualDocSelector","mstrmojo.VisDocSelector","mstrmojo.DynamicListDocSelector","mstrmojo._DocActionSelector","mstrmojo._IsThresholdConditionTarget");var B=4,G=12,E=47,I=12033,C=3076;var D={"default":"ListDocSelector",dynamic:"DynamicListDocSelector",7:"MetricSliderDocSelector",8:"MetricQualDocSelector",9:"SearchBoxDocSelector",10:"TextBoxDocSelector",11:"AttrQualDocSelector",12:"VisDocSelector"};function H(J){return J.srct===G&&J.srcst===C||J.srct===E&&J.srcst===I&&J.ndetype===2;}mstrmojo.DocSelectorViewFactory=mstrmojo.declare(mstrmojo.Obj,null,{scriptClass:"mstrmojo.DocSelectorViewFactory",getDocSelectorClass:function F(L,O,K,P){var N=O.defn,M=N.style,J=D[M]||D["default"];if(H(N)&&M===B&&N.iifp){J=D.dynamic;}if(O.defn.ct==="4"){return(mstrmojo.DynamicClassFactory.newComponent(mstrmojo[J],[mstrmojo._DocActionSelector,mstrmojo._IsThresholdConditionTarget],{scriptClass:"mstrmojo.DocActionXSelector"}));}return mstrmojo[J];},newDocSelector:function A(K,M,J,O){var N=this.getDocSelectorClass(K,M,J,O),L={id:M.id,node:M,model:K};return new N(L);}});mstrmojo.DocSelectorViewFactory.CLASS_MAP=D;}());(function(){mstrmojo.requiresCls("mstrmojo.DocSelectorViewFactory","mstrmojo.RadioList","mstrmojo.CheckList","mstrmojo.ListBoxHoriz","mstrmojo.ListBoxSelector","mstrmojo.LinkList","mstrmojo.ButtonList","mstrmojo.DropDownList","mstrmojo.Slider","mstrmojo.AttributeSlider","mstrmojo.TextBoxSelector");var E=mstrmojo.DocSelector.STYLES;var F={};F[E.RADIO]=["RadioListHoriz","RadioList"];F[E.CHECKBOX]=["CheckListHoriz","CheckList"];F[E.LIST]=["ListBoxHoriz","ListBoxSelector"];F[E.LINK]=["LinkListHoriz","LinkList"];F[E.BUTTON]=["ButtonListHoriz","ButtonList"];F[E.SCROLLER]="AttributeSlider";F[E.METRIC_SLIDER]="MetricSlider";F[E.METRIC_QUAL]="MetricQualification";F[E.SEARCH_BOX]="SearchBoxSelector";F[E.TEXT_BOX]="TextBoxSelector";var D={_mixinName:"_oivmDocSelector",preBuildRendering:function C(){var Q=this._super(),O=this.style,I=this.children[0],J=this.node,P=J.defn,V=P.horiz,S=this.getFormats(),K,W,U,Y,X=O===E.PULLDOWN;if(P.hm===0&&O!==E.SCROLLER&&O!==E.METRIC_SLIDER){this.contentNodeCssText+="overflow-"+(V?"x":"y")+":hidden;";}if(S){I.color=K=S.color;W=S.height;U=S["background-color"];Y=S["text-decoration"];if(Y){mstrmojo.css.addWidgetCssClass(this,Y);}}if(X){if(S){if(K){this.itemCssText+="color:"+K+";";}}I.cssText=this.itemCssText;}else{I.cellCssClass="";I.tableCssText="table-layout:"+((P.iwm===0)?"fixed":"auto")+";";if(W!==undefined){if(O===E.LIST){if(W.indexOf("px")==W.length-2){var N=parseInt(W.substr(0,W.length-2));if(N>4){N=N-4;}W=N+"px";}}I.cssText="height:"+W+";";}if(O===E.LIST&&U){I.cssText+="background-color:"+U+";";}switch(O){case E.RADIO:case E.CHECKBOX:I.labelCssText=this.itemCssText;break;case E.BUTTON:case E.LINK:case E.LIST:if(O===E.BUTTON){if(K){this.itemCssText+="color:"+K+";";}}if(V){this.itemCssText+="height:"+W+";";}I.itemCssText=this.itemCssText;this["background-color"]=U;break;}}var R=this,M=R.model.getTargetInfoWin(P.tks),L=(X&&I.list)?I.list:I;if(P.ifw||(M&&M.length)){L.makeSelection=function(Z){R.showInfoWin(Z&&Z.selItem);};if(L.selectionPolicy!==undefined){if(!P.multi){L.selectionPolicy="reselect";}if(!L.makeSelHandler&&P.ct!=="4"){L.makeSelHandler=L.attachEventListener("selectionChange",L.id,function(a){if(a){var c=a.added||[],b=a.removed||[],Z=c.length?c[0]:b[0];if(Z!==undefined&&Z!==null&&I.hasRendered){if(X){this.makeSelection({selItem:I.domNode});}else{this.makeSelection({selItem:this._getItemNode(Z)});}}}});}}}return Q;},newPulldown:function H(I){return new mstrmojo.DropDownList({k:I.ck,cssDisplay:"block",cssClass:"mstrmojo-DocSelector-DropDownList",selectCssClass:"mstrmojo-DocSelector-DropDownList-select",onselectedChange:function(){if(!I._inSyncPhase){I.showInfoWin();I.selectorControlChange(this);}}});},getWidgetClass:function B(L,K,J){var I=F[K];if(I){if(I.constructor===Array){I=I[J?0:1];}return I;}else{return this._super(L,K,J);}}};mstrmojo.OIVMDocSelectorViewFactory=mstrmojo.declare(mstrmojo.DocSelectorViewFactory,null,{scriptClass:"mstrmojo.OIVMDocSelectorViewFactory",getDocSelectorClass:function A(J,K){var I=this._super(J,K);return mstrmojo.DynamicClassFactory.newComponent(I,[D],null);},getOIVMDocSelectorMixin:function G(){return D;}});}());(function(){mstrmojo.requiresCls("mstrmojo.DocPanel","mstrmojo.vi._MonitorsAppState","mstrmojo.vi._MonitorsLayoutMode","mstrmojo.vi.ui._HasBoxLayout","mstrmojo.ui._HasScroller","mstrmojo.vi.ui.BoxLayoutConfig","mstrmojo.vi.ui.rw.VizBox","mstrmojo.vi.ui.rw.FilterBox","mstrmojo.func","mstrmojo.array","mstrmojo.hash","mstrmojo.string","mstrmojo.boxmodel","mstrmojo.models.FormatModel","mstrmojo.vi.models.EnumDragSources","mstrmojo.vi.enums.EnumFeatures","mstrmojo.vi.controllers.EnumEvents","mstrmojo.vi.enums.EnumThemeProperties","mstrmojo.css","mstrmojo.vi.ui._HasGroup","mstrmojo.DocDataService");var AC=mstrmojo.func,k=mstrmojo.array,U=mstrmojo.hash,D=mstrmojo.css,AG=mstrmojo.string,AF=mstrmojo.vi.models.EnumDragSources,X=mstrmojo.vi.ui.rw.VizBox.ENUM_PORTAL_STATE,r=mstrmojo.models.FormatModel,z=r.getFormatUpdate,n=r.ENUM_PROPERTY_NAMES,N=mstrmojo.vi.enums.EnumFeatures,AE=mstrmojo.vi.controllers.EnumEvents,f=mstrmojo.vi.enums.EnumThemeProperties.SUBTYPE.LAYOUT,o=768,L=11,Z=0,w=1;var x=2;function u(AM,AL){AM=AM||[];(this.children||[]).forEach(function(AO){var AN=AO.addFormatProps(undefined,AL);if(AN){AM.push(AN);}});return AM;}function c(AM,AL){AM.push(this.model.getUnitFormatAction(this,1,z(n.LAYOUT_XML,this.boxLayoutConfig.getBoxState()),AL));return AM;}function AH(){(this.children||[]).forEach(function(AL){AL.generateToolbar();});}function M(){if(this.visible){this.raiseEvent({name:"panelDisplaying"});var AN=this.node,AM=AN.defn,AO=AN.k,AL=AM._lkz;this.model.raiseEvent({name:"panelDisplaying",panelKey:AO,layoutKey:AL});}}function V(AL){D.toggleClass(this.domNode,"undraggable-uc",AL);}function B(){var AL=!mstrApp.isAppStatePresentation()&&!mstrApp.isAppStateSelection(),AM=this.domNode;D.toggleClass(this.domNode,"pulse",AL);setTimeout(function(){D.toggleClass(AM,"pulse",false);},500);}function m(AR,AU,AT){var AS=this,AV=[],AM={},AN={},AL=this.getGroupInfo();U.forEach(AL,function(AX,AW){AX.forEach(function(AY){AN[AY]=AW;});});var AO=function(AX){if(AX.t==="c"){AX.f=true;AX.l=AX.h;var AZ=AX.k,AW=AN[AZ],AY;if(AW&&AW!==""){AY=AM[AW];if(!AY){AY=AM[AW]=[];}AY.push(AX);if(AV.indexOf(AY)===-1){AV.push(AY);}}else{AX.w=AU;AV.push(AX);}}else{k.forEach(AX.children,function(Aa){AO(Aa);});}};AO(AR);var AP=[],AQ=0;AV.forEach(function(AX){if(Array.isArray(AX)){var AY=AX.length,Ad,Ab,Ai,Ag,Ak,Aj,Af,AW=[],Ac,Ah,Aa,AZ;var Ae=function(Al){Al.forEach(function(Am){Am.f=false;Am.l=parseInt(Am.w/Ac,10);});};for(Aa=0;Aa<AY;Aa++){Ad=AX[Aa];if(!Ad){continue;}Ah=Ad.h;Ai=AS.getUnitByKey(Ad.k);Ak=Ai.originalDim||Ai.domNode.style;Ai.originalDim=undefined;Af=[Ad];Ac=Ad.w;for(AZ=Aa+1;AZ<AY;AZ++){Ab=AX[AZ];if(!Ab){continue;}Ag=AS.getUnitByKey(Ab.k);Aj=Ag.originalDim||Ag.domNode.style;AW.push(Ag);if(Ak.top===Aj.top&&Ak.height===Aj.height){Af.push(Ab);AX[AZ]=undefined;Ac+=Ab.w;}}if(Af.length>1){Ae(Af);AP.push({children:Af,o:"h",t:"b",f:true,l:Ad.h,h:Ad.h,w:AU});}else{Ad.w=AU;AP.push(Ad);}AQ+=Ah;}k.forEach(AW,function(Al){Al.originalDim=undefined;});}else{AP.push(AX);AQ+=AX.h;}});return{children:AP,o:"v",t:"b",h:AQ+(AP.length-1)*AT,w:AU};}mstrmojo.vi.ui.rw.DocRelativePanel=mstrmojo.declare(mstrmojo.DocPanel,[mstrmojo.vi.ui._HasBoxLayout,mstrmojo.ui._HasScroller,mstrmojo.vi._MonitorsAppState,mstrmojo.vi._MonitorsLayoutMode,mstrmojo.vi.ui._HasGroup],{scriptClass:"mstrmojo.vi.ui.rw.DocRelativePanel",formatHandlers:null,childPadding:4,allowPanelEdgeTargeting:true,children:null,model:null,titleText:null,previousLayout:null,subPanelCssText:"position:absolute;",markupString:'<div id="{@id}" class="mstrmojo-DocPanel {@cssClass}" style="{@cssText}{@domNodeCssText}"><div class="mstrmojo-DocSubPanel-content" style="{@containerNodeCssText}{@subPanelCssText}"><div></div></div></div>',markupSlots:{panelNode:function(){return this.domNode;},subPanelNode:function(){return this.domNode.firstChild;},containerNode:function(){return this.domNode.firstChild.firstChild;}},init:function AD(AL){this._super(AL);this.childPadding=mstrApp.getThemeProps(f).drpChildPadding;D.addWidgetCssClass(this,"mstrmojo-VIDocRelativePanel");var AM=this.id;this.controller.view.getLayout(this.node.defn._lkz).attachEventListener("layoutRedisplay",AM,function(){if(this.selected){M.call(this);}});this.markupMethods=AC.override({onvisibleChange:function(){this._super();if(this.visible){AH.call(this);}M.call(this);}},U.copy(this.markupMethods));this.boxLayoutConfig=new mstrmojo.vi.ui.BoxLayoutConfig({hostId:AM,padding:this.childPadding,needsValidation:true,getBoxChildClass:function(AN){return mstrmojo.all[AM].getBoxLayoutChild(AN).scriptClass;}});this.model.attachEventListener("viIconTabClicked",AM,function(AO){var AN=this.model.hgl;if(AO.id==="vi_flt"&&!AN){B.call(this);}});this.model.attachEventListener(AE.UPDATE_TOC,AM,function(){if(this.isPanelDisplaying()){AH.call(this);}}.bind(this));this.model.attachEventListener("visOutsideScrolled",AM,function(AN){if(this.scrollbarHostNode){this.scrollbarHostNode.scrollTop+=-AN.deltaY;this.scrollbarHostNode.scrollLeft+=-AN.deltaX;}}.bind(this));this.isInteractive=mstrApp.allowWebDashboardDesign();},onAppStateChange:function(){if(this._tgtSelections&&!mstrApp.isAppStateSelection()){this._tgtSelections.clear();}},onLayoutModeChange:function(){this.isInteractive=mstrApp.allowWebDashboardDesign()&&!mstrApp.isLayoutModePreview();if(!mstrApp.supportFeature(N.SUPPORT_RESPONSIVE_RESIZING)){var AM=this.controller.view.layoutViewer.docLayout,AL=parseInt(AM.width,10)||0;if(AL<=o){this.buildBoxLayout();}}},onremoveChild:function P(){V.call(this,!this.hasMultipleChildren());},onaddChild:function O(){V.call(this,!this.hasMultipleChildren());},setupScrollNodes:function v(){if(mstrApp.supportFeature(N.SUPPORT_RESPONSIVE)){this.scrollNode=this.subPanelNode;this.scrollbarHostNode=this.panelNode;}else{this.scrollNode=null;this.scrollbarHostNode=null;}},isPanelDisplaying:function(){return this.selected&&this.node.defn._lkz===this.model.getCurrentLayoutKey();},getLayoutOffsets:function F(){var AL=mstrApp.getThemeProps(f);return{h:8-2*x+AL.drpLOHW_Compensation,w:8-2*x+AL.drpLOHW_Compensation};},getBoxLayoutChild:function W(AL){var AM=this._super(AL);if(!AM){return this.getUnitByKey(AL.k);}return AM;},addChildren:function h(AO,AL,AM){this._super(AO,AL,AM);var AN=this.model,AR=AN.findKeyMap(this.node);if(AR){var AQ=this.boxLayoutConfig.replaceLayoutXmlKeys(AR);if(AQ){var AP=AN.replaceKeyBoxes=AN.replaceKeyBoxes||[];AP.push(this);}}this.buildBoxLayout();},refresh:function AK(){this.boxLayoutConfig.dirty=true;this._super();this.buildBoxLayout();},update:function l(AO){var AN=AO.defn,AL=AN&&AN.layoutXML,AM=this.boxLayoutConfig;if(AL){AM.box=AL;}else{this.defn.layoutXML=AM.useDefaultBox(AO.data.objects||[]);}this.titleText=AN&&AN.ttl;this.title=AG.encodeHtmlString(this.titleText);},hasMultipleChildren:function g(){return(this.children.length>1);},getSplitterHost:function A(){return this.containerNode;},getTargetKeysByType:function p(AL){return(this.children||[]).filter(function(AM){return(AL||[]).indexOf(parseInt(AM.defn.t,10))>-1;}).map(function(AM){return AM.k;});},getTargetKeysExcludingTypes:function Q(AL){return(this.children||[]).filter(function(AM){return(AL||[]).indexOf(parseInt(AM.defn.t,10))<0;}).map(function(AM){return AM.k;});},insertNewBoxAndSaveDeferred:function(AR,AN,AO,AQ,AL,AM){var AP=this.id;this.addChildren([AN]);this._super(AR,AN,AO,AC.wrapMethods({failure:function(){mstrmojo.all[AP].removeChildren(AN);AN.destroy();}},AQ),AL,AM);},addUnit:function I(AO,AM,AN,AQ,AP){this.addChildren([AO]);var AL=this.insertNewBox(AO,AM,AN,AQ);if(AQ){this.addSaveBoxLayoutActions(AQ,AP);}return AL;},restoreAnyMaxedVizBox:function AA(){var AL=this.maximizedBox;if(!AL||!AL.isMaxed){return ;}this.setPortalState(AL,X.RESTORE,false);delete AL.isMaxed;D.toggleClass(AL.maxRestoreBtnNode,"restore",AL.isMaxed);},setPortalState:function a(AO,AL,AR){var AM=this.id,AP=this.model,AV=AO.defn,AN=AV.ds,AT=function(AZ){var AY=mstrmojo.all[AM];if(!mstrmojo.all[AO.id]){var AX=AO.k;mstrmojo.array.forEach(AY.children,function(Ab){if(Ab.k===AX){AO=Ab;return false;}});}if(!mstrmojo.all[AO.id]){return ;}var Aa=AO.isMaxed=AZ===X.MAXIMIZE,AW=Aa?2:1;if(Aa){AY.maximizedBox=AO;}else{if(AZ===X.RESTORE){delete AY.maximizedBox;}}V.call(this,AO.isMaxed);AO.set("zIndex",AW);AV.ds=AZ;AY.buildBoxLayout();AO.generateToolbar();};if(!AR){AP.controller.cmdMgr.execute({execute:function AS(){var AY=mstrmojo.all[AM],AZ=AL===X.MAXIMIZE,AW=AZ?2:1,Aa=[AP.getUnitFormatAction(AO,1,{FormattingOrder:{ZIndex:AW},FormattingView:{WindowState:AL}})];u.call(AY,Aa);this.submit(Aa,{failure:function AX(){AT(AN);}},mstrmojo.DocDataService.RAPID_EXEC);AT(AL);},urInfo:{silent:true,undo:function AU(){AT(AN);},redo:function AQ(){AT(AL);}}});}else{AT(AL);}},buildBoxLayout:function K(AM,AL){if(!this.visible){return ;}if(!this.children){return ;}var AO=this.boxLayoutConfig,AQ=mstrApp.isWSStyling;if(AO.needsValidation){var AN=this.children;if(!AO.validateBoxLayout(AN)){this.defn.layoutXML=AO.useDefaultBox(AN);}AO.needsValidation=false;}if(AQ&&this.height&&this.width){this.height=(parseInt(this.height,10)-2*x)+"px";this.width=(parseInt(this.width,10)-2*x)+"px";}this._super(AM,AL);var AR=this.maximizedBox;if(AR){if(AR.domNode){var AP=AR.domNode.style;AR.originalDim={top:AP.top,height:AP.height};}if(this.height!==undefined&&this.width!==undefined){AR.updateLayout({left:"0px",top:"0px",height:this.height,width:this.width});}}if(AQ&&this.height&&this.width){this.height=(parseInt(this.height,10)+2*x)+"px";this.width=(parseInt(this.width,10)+2*x)+"px";}if(mstrApp.isAppStateSelection()){this.model.raiseEvent({name:"buildBoxLayoutComplete"});}},endBoxMove:function Y(AM,AL){this._super(AM,AL);this.getSplitterHost().appendChild(AL.domNode);},getChildPositionActions:function E(AL){return u.call(this,[],AL);},getBoxLayoutActions:function AI(AL){return c.call(this,[],AL);},getBoxLayoutSaveCallback:function q(){var AL=this.id;return{success:function(){AH.call(mstrmojo.all[AL]);}};},addSaveBoxLayoutActions:function J(AO,AL){var AN=this.id,AM=AO.actions;u.call(this,AM,AL);c.call(this,AM,AL);AO.addCallbacks({success:function(){AH.call(mstrmojo.all[AN]);}});},saveBoxLayout:function e(AN,AL,AP,AO,AM){this._super(AN,AL,AP,AO,AM);this.defn.layoutXML=this.boxLayoutConfig.box;if(AO){AO.addCallbacks(this.getBoxLayoutSaveCallback());}},postBuildBoxLayout:function AB(){var AL=this.model.getLatestSelectedViUnitKey(),AM=AL&&this.getUnitByKey(AL);if(AM){this.model.selectVIUnit(AM.id);}else{this.selectFirstBox();}},postCalculateBoxLayout:function t(AM,AV,AR){var AY=mstrmojo.vi.VisualInsightApp.LAYOUT_MODES,AS=AY.PREVIEW_TOGGLED,AZ=mstrApp.supportFeature(N.SUPPORT_RESPONSIVE_RESIZING),AU=mstrApp.layoutMode,AX=this.controller.view.layoutViewer.docLayout.docSection,AQ=parseInt(AX.width,10)||0;if(mstrApp.supportFeature(N.SUPPORT_RESPONSIVE)){if(AQ<=o&&(AZ||AU===AS)){if(!this.previousLayout){this.previousLayout=U.clone(AM);}AV.width=Math.min(AV.width,parseInt(this.width,10));var AL=AM.children,AO=AL[0];if(!(AO.h||AO.w)){AV.width-=L;AR.call(this,AM,AV,0);AV.width+=L;}if(this.maximizedBox){if(this.previousLayout){AM=U.clone(this.previousLayout);}AV.width=parseInt(this.width,10);AV.height=parseInt(this.height,10);}else{if(AL.length>1){var AP=this.containerNode,Aa=AP&&AP.clientHeight,AT=AM.h,AW=AV.height;if((AT&&AT<AW)||(Aa&&Aa<AW)){AL.forEach(function(Ab){Ab.f=false;});AR.call(this,AM,AV,0);}AM=m.call(this,U.clone(AM),AV.width,this.boxLayoutConfig.padding);AV.width=AM.w;AV.height=AM.h;}}if(AV.height>parseInt(this.height,10)){AV.width-=L;}if(!mstrApp.isLayoutModePreview()&&AZ){mstrApp.set("layoutMode",AY.PREVIEW_RESIZE);}}else{if(AU!==AS){if(this.previousLayout){AM=U.clone(this.previousLayout);this.previousLayout=null;AV.width=parseInt(this.width,10);AV.height=parseInt(this.height,10);var AN=this.domNode;if(AN){AN.scrollTop=0;}mstrApp.set("layoutMode",AY.DEFAULT);}}else{AM=null;AX.domNode.style.left=(AQ-o)/2+"px";window.setTimeout(function(){AX.set("width",o+"px");}.bind(this),0);}}}return AM;},selectFirstBox:function d(){var AM=this.firstVizBoxId||this.firstBoxId,AL=mstrApp.isAppStateSelection();if(this.visible&&AM&&!AL){this.model.selectVIUnit(AM);}},selectVIUnit:function j(AM,AL){var AO=this._tgtSelections,AN=true;if(AO){if(AM.id===AO.id){AN=false;}else{AN=AO.toggleSelection(AM.k);AO.notify();}}else{this.model.selectVIUnit(AM.id,AL);}return AN;},getUnitByKey:function S(AL){return(this.children||[]).filter(function(AM){return AM.k===AL;})[0];},enterTargetSelectionMode:function R(AQ,AP,AO,AU,AN){if(!this._tgtSelections&&this.children&&this.children[0].hasRendered){this.children.forEach(function(AV){AU(AV);});var AS=this.model,AT=AS.getSelectedViUnit(),AR=AT&&AT.id,AM={},AL=function(){return U.keyarray(AM).filter(function(AV){return AM[AV];});};this._tgtSelections={id:AP,notify:function(AW,AV){AQ(AL(),!!AW,AV);},toggleSelection:function(AV){AM[AV]=!AM[AV];return AM[AV];},getSelections:function(){return AL();},remove:function(AV){if(AM[AV]!==undefined){delete AM[AV];}},restore:function(){AS.selectVIUnit(AR,true);},clear:function(){AN();}};AS.selectVIUnit("");(AO||[]).forEach(function(AV){AS.getUnitInstance(AV,1).parent.selectVIUnit();},this);}},exitTargetSelectionMode:function H(AL,AM){var AN=this._tgtSelections;if(AN){delete this._tgtSelections;this.children.forEach(function(AO){AM(AO);});AN.restore();if(AL){AN.notify(AL);}}},unload:function C(){this.destroyChildren();this.defn.l=false;this.builtChildren=false;},getPanelTargetEdge:function AJ(AL){if(AL.src.widget.parent!==this&&AL.getCtxtDragData().src!==AF.FILTERS){return"";}return this._super(AL);},setLastSelectionClass:function G(AO,AN){if(AO!==AN){var AM,AL="lastSelected";if(AN){AM=this.getUnitByKey(AN);D.removeClass(AM.domNode,AL);}if(AO){AM=this.getUnitByKey(AO);D.addClass(AM.domNode,AL);}}},dropBox:function b(AO,AM,AP,AS){AS=false;this._super(AO,AM,AP,AS);var AL=this,AN=AL.model,AR=mstrmojo.DocDataService;var AQ=AN.getUIState();AQ[U.keyarray(AQ)[0]].boxState=U.clone(AO.box.initState);AN.execute({execute:function(){AL.saveBoxLayout(this);},urInfo:{callback:AR.EMPTY_CALLBACK,extras:AR.SUPPRESS_DATA},undoUIState:AQ});}});mstrmojo._HasMarkup.addMarkupMethods(mstrmojo.vi.ui.rw.DocRelativePanel,{onheightChange:mstrmojo.Widget.heightMarkupMethod,onwidthChange:mstrmojo.Widget.widthMarkupMethod});mstrmojo.vi.ui.rw.DocRelativePanel.getLayoutBreakPoint=function(){return o;};mstrmojo.vi.ui.rw.DocRelativePanel.EnumPreviewModes={DefaultDesktop:Z,DefaultPreview:w,TabletPreview:w};}());(function(){mstrmojo.requiresCls("mstrmojo.array","mstrmojo.Box","mstrmojo.Button","mstrmojo.Container","mstrmojo.ui.Pulldown","mstrmojo.dom","mstrmojo.css","mstrmojo.Editor","mstrmojo.hash","mstrmojo.Label","mstrmojo.DynamicClassFactory","mstrmojo.vi.ui._IsDropTarget","mstrmojo.vi.models.EnumDragSources","mstrmojo.vi.ui.AllObjectsBrowser","mstrmojo.vi.ui.DatasetUnitList","mstrmojo.vi.ui.editors.ReportFilterEditor","mstrmojo.ui.CheckList","mstrmojo.ui.menus.EditorConfig","mstrmojo.ui._HasScroller","mstrmojo.DI.DIConstants");var P=mstrmojo.hash,O=mstrmojo.dom,B=mstrmojo.css,W=mstrmojo.array,h=mstrmojo.vi.models.EnumDragSources,I=mstrmojo.DI.DIConstants,c={IN_MEMORY:1,LIVE:2},g={id:"",att:[],mx:[]},a="Selecting_how_a_dataset_accesses_its_data__Direct_.htm";var X=mstrmojo.desc(13402,"Edit Filter..."),m=mstrmojo.desc(15347,"Add Filter..."),F=mstrmojo.desc(13231,"Clear All Selections");function n(p,u,r){var q=r?p.add:p.del,t=r?p.del:p.add;var v=W.find(t,"did",u.did);if(v===-1){q.push(u);}else{W.removeIndices(t,v,1);}if(!r){p.fs.add=W.filter(p.fs.add,function(w){return u.did!==w.unitId;});p.fs.del=W.filter(p.fs.del,function(w){return u.did!==w.unitId;});}}function K(q,v,t){var r=t?q.fs.add:q.fs.del,u=t?q.fs.del:q.fs.add,w=-1,p;for(p=0;p<u.length;p++){if(u[p].unitId===v.unitId&&u[p].attFormId===v.attFormId){w=p;}}if(w===-1){r.push(v);return true;}W.removeIndices(u,w,1);return false;}function N(p,q){p.set("highlightItems",q.mx.concat(q.att).map(function(r){return r.did;}));}function A(p,r){var q=p.btnHbox.warningBtn;if(r.att.length>1&&(r.mx.length-p.derivedMetricCount)===0){q.set("visible",true);window.setTimeout(function(){q.showTooltip();q._autoHideTimeout=window.setTimeout(function(){q.hideTooltip();},3000);},0);}else{q.hideTooltip();q.set("visible",false);}}function R(w){var u=w.dataset,r=w.editorContainer.unitListContainer,t=r.clearBtn,p=W.filter(u.att.concat(u.mx),function(AA){return !AA.um&&!AA.da&&AA.st!==12033;}).length,x=w.btnHbox.okBtn,z=!!W.filterOne(u.att,function(AA){return(w.invalidItems||{})[AA.did];}),v=w.modifiedItems,q=!!v.add.length||!!v.del.length||!!v.fs.add.length||!!v.fs.del.length||((v.filter||null)!==(u.filter||null))||!!v.convert;t.set("itemCount",p);t.set("visible",p!==0);x.set("enabled",!!p&&q&&!z);}function U(q,r,p){W.forEach(q,function(t){n(p,t,true);t.isNew=true;W.insert(t.t===4?r.mx:r.att,null,[t]);});this.updateScrollbars();N(this.editorContainer.objectBrowser,r);A(this,r);R(this);}function L(q){var p,r=this,t=r.dataset;W.forEach(q,function(u){p=u.t===4?t.mx:t.att;n(r.modifiedItems,u,false);W.removeIndices(p,W.find(p,"did",u.did),1);});r.set("dataset",P.copy(t));r.updateScrollbars();N(r.editorContainer.objectBrowser,t);A(r,t);R(r);}function M(q,r,p){if(mstrApp.serverRequest){mstrApp.serverRequest(q,r,p);}else{window.$MAPF=function(){return false;};this.getServerProxy().request(r,q,false,p);}}function E(q,t,p){var r=[];W.forEach(q,function(u){if((u.t===4&&W.find(t,"did",u.did)===-1)||(u.t!==4&&W.find(p,"did",u.did)===-1)){r.push(u);}});return r;}function e(q,p){return function(){var v=[],w=null,u=new mstrmojo.ui.menus.EditorConfig({data:{item:p},contents:[{alias:"fs",scriptClass:"mstrmojo.ui.CheckList",selectedIndices:v,postBuildRendering:function(){var z=this.itemsContainerNode.childNodes;W.forEach(this.items,function(AB,AA){if(AB.idf){mstrmojo.css.addClass(z[AA],"disableOption");return false;}});},preselectionChange:function t(AA){var z=AA.removed&&AA.removed[0];if(AA.removed&&this.items[z].idf){this.selectedIndices[z]=true;return false;}return true;}}],okBtnText:mstrmojo.desc(1442,"Ok"),setAllItems:function(z){this.contents[0].items=z;this.set("contents",this.contents);},fnOk:function x(AD,AC){var AA=q.parent.parent.parent,AE=AC.fs,AB=AE.selectedIndices,z=AE.items,AF=1;P.forEach(w,function(AG,AH){if(AG){K(AA.modifiedItems,{act:"removeAttrFormFromDataset",unitId:p.did,attFormId:z[AH].id},false);p.fs[AH].obf=false;}});P.forEach(AB,function(AG,AI){if(AG){var AH=K(q.parent.parent.parent.modifiedItems,{act:"addAttrFormToDataset",unitId:p.did,attFormId:z[AI].id,unitPos:AF},true);if(AH){AF++;}p.fs[AI].obf=true;}});R(AA);}});var r=[];W.forEach(p.fs,function(z){r.push({id:z.fid,n:z.fnm,idf:z.idf});if(z.obf||z.idf){v[r.length-1]=true;}});if(!w){w=P.cloneArray(v);}u.setAllItems(r);return u;};}function S(u){return{scriptClass:"mstrmojo.vi.ui.DatasetUnitList",alias:u+"List",cssClass:u+"Unitlist",cssDisplay:"inline-block",multiSelect:true,draggable:false,useListModKeys:true,tooltipOpenDelay:0,postCreate:function(){this.avatarCssClass+=" noIcon";},doItemSelect:function(AB,w){var AA=this,x=O.isMetaKey(w.hWin,w.e);if(!x){W.forEach(this.parent.allList,function(AD){if(AD!==AA.alias){AA.parent[AD].clearSelect();}});}if(typeof w.getTarget==="function"){var AC=w.getTarget();if(AC.className.indexOf("clsx")!==-1){var z=this.parent.parent.parent;L.call(z,[AB]);return ;}}this.constructor.prototype.doItemSelect.call(this,AB,w);},onItemContextMenu:function q(AG,AF){var AC=AF.e,x=this.getItemNodeFromTarget(AF.getTarget()),AA=AF.hWin,z=this.getSelectedItems().some(function(AH){return AH.itemNode===x;});if(AG&&!z){this.doItemSelect(AG,AF);}var AD=AF.getTarget(),AE=this.parent.getSelectedItems();if(AE.length){this.closePopup();var AB=AE&&AE.length>1,w=AB?"showMultiSelectionMenu":"showItemMenu";this[w](AB?AE:AG,this.getItemNodeFromTarget(AD),mstrmojo.dom.getMousePosition(AC,AA));return true;}},hasTooltipContent:function(w,x){return(!!w&&!!w.n)||(this.parent.parent.parent.invalidItems||{})[w.did];},getItemTooltip:function(x,AA,z){var w=this.constructor.prototype.getItemTooltip.call(this,x,AA,z);if(w){if(AA.classList.contains("invalid")){w.content=mstrmojo.desc(15392,"This is an invalid object. Please remove it before adding this dataset to the Dossier.");w.cssClass+=" vi-warning triangle-warning";w.left=w.left+102;return w;}w.refNode=AA;w.top=-5;if(x.t===mstrmojo.warehouse.EnumObjectTypes.METRIC){w.left=AA.getBoundingClientRect().width+12;w.posType=mstrmojo.tooltip.POS_TOPLEFT;w.cssClass="vi-regular vi-tooltip-C";}else{w.left=-4;w.posType=mstrmojo.tooltip.POS_TOPRIGHT;w.cssClass="vi-regular vi-tooltip-D";}return w;}return null;},getItemProps:function r(AC,w){var AA=this.constructor.prototype.getItemProps.call(this,AC,w),z=this.parent.parent.parent,AD=z.dataset,AB=AC.did,x=W.find(AD[u],"did",AB);AD[u][x].isNew=false;AA.addCls((z.invalidItems||{})[AB]?"invalid":"");return AA;},getAttributeForms:function t(w,x){M.call(this,{taskId:"getAttributeForms",styleName:"VIMojoAttributeStyle",attributeID:w,displayedForms:0},x,{showProgress:false});},showItemMenu:function v(AC,AA,w){var AE=new mstrmojo.ui.menus.MenuConfig({position:w,isHostedWithin:false}),z=this.parent.parent.parent;AE.addMenuItem(mstrmojo.desc(629,"Delete"),"",function(){L.call(z,[AC]);});if(AC.t===12){var x=AC.fs,AB=function(){if(x.length>1){AE.addPopupMenuItem(mstrmojo.desc(14327,"Available Attribute Forms"),"",e(this,AC));}}.bind(this);if(!x){var AD=function AD(){this.getAttributeForms(AC.did,{success:function(AG){var AF=z.dataset.att;x=AC.fs=AF[W.find(AF,"did",AC.did)].fs=(AG.fms||[]).map(function(AH){return{fid:AH.did,fnm:AH.n,obf:!!AH.obf,idf:!!AH.idf};});AB();this.openPopup(AE.newInstance());}.bind(this),failure:function(AF){mstrmojo.alert(AF.message);}});}.bind(this);if(mstrApp.isSingleTier){z.editorContainer.objectBrowser.dataProvider.loadObjects([AC],{success:function(){AD();}});}else{AD();}return ;}AB();}this.openPopup(AE.newInstance());},showMultiSelectionMenu:function p(x,AA,w){var AB=new mstrmojo.ui.menus.MenuConfig({position:w,isHostedWithin:false}),z=this.parent.parent.parent;AB.addMenuItem(mstrmojo.desc(629,"Delete"),"",function(){L.call(z,x);});this.openPopup(AB.newInstance());},getAllItems:function(){return this.dataset&&W.filter(this.dataset[u],function(w){return !w.um&&!w.da&&w.st!==12033;});},filterItems:function(w){return w;},bindings:{dataset:"this.parent.parent.parent.dataset"}};}mstrmojo.vi.ui.DatasetEditorContent=mstrmojo.DynamicClassFactory.newComponent(mstrmojo.Box,[mstrmojo.vi.ui._IsDropTarget,mstrmojo.vi.ui._HasUnitListAvatar],{allowDrop:function(r){var u=r.src.data,q=u.items,t=this.dataset,v=t.mx,p=t.att;return E(q,v,p).length&&u.src===h.ALL_OBJECT_LIST;},isDragValid:function Q(p){return !isNaN(parseInt(p.src.node.getAttribute("idx"),10))||this._super(p)||false;},ondragstart:function b(q){var t=null,r=this,p=function(u){return O.contains(u.domNode,q.src.node,true,u.domNode);};W.forEach(this.allList,function(u){if(p(r[u])){t=r[u];return false;}});if(t){t.selectDragNode(q);}this._super(q);}});var j=mstrmojo.Button.newWebButton(mstrmojo.desc(118,"Save"),function(){var AD=this.parent.parent,v=AD.dataset,r=AD.docModel.datasets,u=[],AB=AD.modifiedItems.fs.add.concat(AD.modifiedItems.fs.del),z={act:"addUnitToDataset"},AA={act:"removeBaseUnitFromDataset"},w={act:"setDatasetFilter",useJson:false},t="$GUID_141",AC=0;if(AD.modifiedItems.convert){u.push(AD.modifiedItems.convert);AC=W.indexOf(P.keyarray(r),v.did)+1;z.dsidx=AA.dsidx=w.dsidx=AC;W.forEach(AB,function(AE){AE.dsidx=AC;});}else{if(!v.did&&AD.modifiedItems.add.length){var q=v.dsm===c.LIVE;if(AD.modifiedItems.create){AD.modifiedItems.create.idd=q;}u.push(AD.modifiedItems.create||{act:"createDataset",prm:true,mgo:true,idd:q,newObjectIds:[t]});var p=AD.docModel.getSelectedViUnit().getZonesModel();if(p){u.push({act:"editNode",nodeKey:p.getHost().k,datasetId:t});}u=u.concat(AD.docModel.getOpenDatasetPanelAction());z.dsid=w.dsid=t;W.forEach(AB,function(AE){AE.dsid=t;});}else{if(v){var x=v.did;z.dsid=AA.dsid=w.dsid=x;W.forEach(AB,function(AE){AE.dsid=x;});}}}W.forEach(AD.modifiedItems.add,function(AE){u.push(P.copy(z,{unitId:AE.did,unitType:AE.t}));});W.forEach(AD.modifiedItems.del,function(AE){u.push(P.copy(AA,{unitId:AE.did,unitType:AE.t}));});u=u.concat(AB);if((AD.modifiedItems.filter||null)!==(v.filter||null)){u.push(P.copy(w,{expr:mstrmojo.fe.FilterUtils.getExprXml(AD.modifiedItems.filter)}));}if(u.length){if(!v.mngd&&!!v.did&&!AD.modifiedItems.convert){u.push({act:"datasetSaveAs",managed:false,nonDelta:true,dsID:v.did,rptName:v.name,rptDesc:"",folderID:v.pfid,saveAsOverwrite:true});}}if(AD.modifiedItems.add.length){AD.editorContainer.objectBrowser.dataProvider.loadObjects(AD.modifiedItems.add,{success:function(){AD.onOk(u);}});}else{AD.onOk(u);}if(AD.closeOnSubmit){AD.close();}},true,{alias:"okBtn"}),J=mstrmojo.Button.newWebButton(mstrmojo.desc(221,"Cancel"),function(){var p=this.parent.parent;if(p.onCancel){p.onCancel();}p.close();}),l=mstrmojo.Button.newWebButton("",null,false,{cssClass:"warningBtn",alias:"warningBtn",useRichTooltip:true,tooltipOpenDelay:0,updateTooltipConfig:function k(){var p=O.position(this.domNode);this.richTooltip={content:'<div class="name">'+mstrmojo.desc(15393,"Adding at least one metric is recommended")+'</div><div class="dsc">'+mstrmojo.desc(15394,"It may prevent attributes from different hierarchies to be cross joined.")+"</div>",cssClass:"vi-warning vi-tooltip-D A-center",left:p.x-308,top:p.y-7};},showTooltip:function o(){window.clearTimeout(this._autoHideTimeout);this._autoHideTimeout=undefined;if(this.hasOpenTooltip){this.hideTooltip();}this.constructor.prototype.showTooltip.call(this);}});function D(q){var w="dfe",v,r={},u=q.datasetFilter;function t(x){if(!x.et){return false;}if(x.et===mstrmojo.expr.ET.RLS){return false;}if(x.p){return false;}if(x.cs&&x.cs.some(function(z){return !!z.p;})){return false;}return !x.nds||x.nds.every(t);}function p(){W.forEach(q.att,function(AA){if(AA.t!==12||AA.da){return ;}var z=AA.did;r[z]={did:z,n:AA.n,t:AA.t,isInvalid:q.invalidItems[z],fs:AA.fs};});W.forEach(q.mx,function(z){if(z.um){return ;}r[z.did]={did:z.did,n:z.n,t:z.t};});if(u){mstrmojo.expr.findTargets(u,"did",r);}var x={expr:P.clone(u),targets:P.valarray(r)};v=w&&window.mstrmojo&&mstrmojo.all[w];if(!v){v=mstrmojo.insert({id:w,scriptClass:"mstrmojo.vi.ui.editors.ReportFilterEditor",showLimits:false,objectBrowsingEnabled:true});}if(q.zIndex){v.set("zIndex",q.zIndex);}v.set("title",mstrmojo.desc(5758,"Filter Editor"));v.set("onSave",q.fnOk);v.onCancel=q.onCancel;v.set("model",x);v.set("docModel",q.docModel);v.onUpdateBrowseElementsParams=q.browseParam;v.open();}if(u&&!t(u)){mstrmojo.warn(mstrmojo.desc(15700,"The filter contains an advanced condition or a prompt that cannot be edited. Would you like to clear the existing filter?"),{confirmBtn:{t:mstrmojo.desc(13528,"Clear existing filter"),fn:function(){u=null;p();}},cancelBtn:{t:mstrmojo.desc(221,"Cancel")}},{title:mstrmojo.desc(11812,"Notification")});}else{p();}}mstrmojo.vi.ui.DatasetEditor=mstrmojo.declare(mstrmojo.Editor,[mstrmojo.ui._HasScroller],{scriptClass:"mstrmojo.vi.ui.DatasetEditor",cssClass:"mstrmojo-VIDatasetEditor",dataset:g,docModel:null,dataProvider:null,help:"Add_Existing_Objects.htm",modifiedItems:{add:[],del:[],fs:{add:[],del:[]},filter:undefined},useRichTooltip:false,closeOnSubmit:true,init:function(p){this.buttons=[l,j,J];this._super(p);if(!this.docModel.allowModifyReportList()){this.dataModeContainer.children=[];}j.text=this.okBtnText||mstrmojo.desc(118,"Save");},onOpen:function(){var q=this.dataset,p=this.modifiedItems;if(!q.did){q=this.dataset=P.clone(g);}else{this.updateScrollbars();}p.add=[];p.del=[];p.fs.add=[];p.fs.del=[];p.filter=q.filter;A(this,q);R(this,q.att.length+q.mx.length);this.editorContainer.filterBtn.refresh();},onPreClose:function H(){if(this.onCancel){this.onCancel();}return this._super();},setupScrollNodes:function f(){this.scrollNode=this.editorContainer.containNode;},children:[{scriptClass:"mstrmojo.Container",alias:"editorContainer",markupString:'<div class="mstrmojo-VIDatasetEditorContents"><div class="objbrowserContainer"></div><div class="datasetEditorContainer"><div class="datasetEditorTopContainer"><div class="filterLink"></div></div><div class="datasetEditorContent"><div mstrAttach:mouseout,mouseover></div></div></div></div>',markupSlots:{browserNode:function(){return this.domNode.firstChild;},filterNode:function(){return this.domNode.childNodes[1].firstChild.firstChild;},containNode:function(){return this.domNode.childNodes[1].childNodes[1].firstChild;}},onmouseout:function(){mstrmojo.css.removeClass(this.containNode.parentNode,"entered");},onmouseover:function(){mstrmojo.css.addClass(this.containNode.parentNode,"entered");},children:[{scriptClass:"mstrmojo.vi.ui.AllObjectsBrowser",alias:"objectBrowser",cssClass:"datasetEditorobjbrowser",slot:"browserNode",bindings:{model:"this.parent.parent.docModel"},dblClickOnNodes:function(p){var u=p.getTarget(),r=O.findWidget(u).data,q=this.parent.parent,t=q.dataset;if(r&&W.indexOf([4,12,1,47],r.t)!==-1){if((r.t===4&&W.find(t.mx,"did",r.did)===-1)||(r.t!==4&&W.find(t.att,"did",r.did)===-1)){U.call(q,[r],t,q.modifiedItems);}q.set("dataset",P.copy(t));}},postBuildRendering:function(){var p=this.parent.parent;this.set("dataProvider",p.dataProvider);this.set("opened",true);this.constructor.prototype.postBuildRendering.call(this);N(this,p.dataset);},allowDrop:function(p){var q=p.src.data;return q&&q.src!==h.ALL_OBJECT_LIST;},getDropAvatarIcon:function C(){return"hasIcon remove";},ondrop:function V(p){if(p.src.data.onRemove){p.src.data.onRemove(p.src.data.items);}}},{scriptClass:"mstrmojo.Button",alias:"filterBtn",slot:"filterNode",cssClass:"filterButton",disabled:false,text:m,richTooltip:{cssClass:"vi-regular V-center vi-tooltip-V disabled-filter-button",posType:mstrmojo.tooltip.POS_BOTTOMCENTER},useRichTooltip:false,updateTooltipConfig:function k(){var q=this.richTooltip,p=O.position(this.domNode);q.left=p.x+p.w-36;q.top=p.y-5;},buildRendering:function d(){var t=this.parent.parent,r=t.modifiedItems.filter,u=r&&r.nds,v=P.walk("dataset.xdaType",t),p=this.richTooltip;if(v===I.xdaType.customFreeFormSQL){this.enabled=false;this.useRichTooltip=true;p.content="<div class='info-icon long-text'></div>"+mstrmojo.desc(16297,"Adding filters at the dataset level is not supported for Free Form SQL Reports. To filter your data, add filters to the dossier via the Filter Panel or in the canvas.");}else{this.text=(r&&(!u||u.length>0))?X:m;p.content="<div class='info-icon'></div>"+mstrmojo.desc(15814,"Adding a filter at the dataset level is only supported for In-Memory data access mode.");}var q=this.constructor.prototype.buildRendering.call(this);B.toggleClass(this.domNode,"hasFilter",r);return q;},onenabledChange:function(){if(this.enabled){this.useRichTooltip=false;}else{this.useRichTooltip=true;}},onclick:function(){var t=this,r=this.parent.parent,v=r.dataset,q=r.modifiedItems.filter,p=function(AA,z){var x=z.invalidItems||{};AA.targets.forEach(function(AB){if(AB.isInvalid){x[AB.did]=true;}});z.invalidItems=x;z.editorContainer.unitListContainer.attList.refresh();R(z);},u=function(z){r.modifiedItems.filter=z.expr;var x=z.expr,AA=x&&x.nds;p(z,r);this.text=(x&&(!AA||AA.length>0))?X:m;B.toggleClass(this.domNode,"hasFilter",x);t.refresh();},w=function(x){p(x,r);};if(v){D({datasetName:"- "+(v.name||mstrmojo.desc(11636,"New Dataset")),datasetFilter:q,att:r.editorContainer.unitListContainer.attList.items,mx:r.editorContainer.unitListContainer.mxList.items,invalidItems:r.invalidItems||{},docModel:r.docModel,fnOk:u,onCancel:w,browseParam:mstrmojo.emptyFn,zIndex:r.zIndex+1});}}},{scriptClass:"mstrmojo.vi.ui.DatasetEditorContent",alias:"unitListContainer",slot:"containNode",bindings:{dataset:"this.parent.parent.dataset",cssClass:function(){return"datasetEditorUnitlistContainer"+(this.dataset.idd?" noFilter":"");}},ondrop:function V(p){var t=this,r=t.parent.parent,u=r.dataset,q=E(p.src.data.items,r.dataset.mx,r.dataset.att);U.call(r,q,u,t.parent.parent.modifiedItems);r.set("dataset",P.copy(u));r.updateScrollbars();},allList:["attList","mxList"],getDragData:function Y(p){var t=this.constructor.prototype.getDragData.call(this,p),r=this,q=r.parent.parent;t.onRemove=function(u){L.call(q,u);};return t;},getSelectedItems:function(){var q=this,p=[];this.allList.forEach(function(r){p=p.concat(q[r].getSelectedItems());});return p;},children:[{scriptClass:"mstrmojo.Button",alias:"clearBtn",cssClass:"clearButton",text:F,itemCount:0,onitemCountChange:function G(){this.set("text",F+" ("+this.itemCount+")");},onclick:function Z(){var p=this.parent.parent.parent,q=p.dataset;L.call(p,q.att.concat(q.mx));}},S.call(this,"att"),S.call(this,"mx"),{scriptClass:"mstrmojo.Label",cssClass:"dragObjectMsg",bindings:{visible:"!this.parent.attList.items.length && !this.parent.mxList.items.length"},text:mstrmojo.desc(11668,"Drag objects here.")}]}]},{scriptClass:"mstrmojo.Container",slot:"buttonNode",alias:"dataModeContainer",useRichTooltip:false,richTooltip:{cssClass:"vi-regular V-center vi-tooltip-V pulldown-tooltip",posType:mstrmojo.tooltip.POS_BOTTOMCENTER,enableHover:true,},updateTooltipConfig:function k(){var r=this.richTooltip,p=O.position(this.dataModeInfoIcon.domNode),q=this.parent;r.left=p.x+p.w-9;r.top=p.y-8;if(q.dataset.dsm){r.content=mstrmojo.desc(15813,"Switching data access mode is not supported.");}else{r.content=mstrmojo.desc(15812,"We only support one Live dataset per dossier using existing application objects. If you would like to add new objects, please edit the existing Live dataset.");}r.content+="<br /><div class='help-link-label' onclick='mstrApp.showHelpTopic(\"##HELPTOPIC##\")'>"+mstrmojo.desc(15811,"Learn more about Data Access Mode")+"</div>";r.content=r.content.replace("##HELPTOPIC##",a);},markupString:'<div class="dataModeContainer"><div class="live-mode-pulldown-label"></div><div class="live-mode-pulldown"></div><div></div></div>',markupSlots:{dataModeLabelNode:function(){return this.domNode.firstChild;},dataModePulldownNode:function(){return this.domNode.childNodes[1];},dataModeInfoNode:function(){return this.domNode.childNodes[2];}},children:[{scriptClass:"mstrmojo.Label",slot:"dataModeLabelNode",alias:"dataModeLabel",text:mstrmojo.desc(11922,"Data Access Mode"),postCreate:function(){var p=this.parent,q=p.parent;if(q.dataset.dsm||q.hasLTSDataset){p.set("useRichTooltip",true);}},postBuildRendering:function(){var p=this.parent,q=p.parent;if(q.dataset.dsm||q.hasLTSDataset){this.set("enabled",false);}this.constructor.prototype.postBuildRendering.call(this);}},{scriptClass:"mstrmojo.ui.Pulldown",slot:"dataModePulldownNode",alias:"dataModePulldown",items:[{n:mstrmojo.desc(11921,"In-Memory"),v:c.IN_MEMORY,d:mstrmojo.desc(15826,"Retrieves dataset results from a data source and stores them in memory.")},{n:mstrmojo.desc(12726,"Connect Live"),v:c.LIVE,d:mstrmojo.desc(15827,"Retrieves dataset results directly from the source.")}],getPopupListConfig:function(){var p=mstrmojo.ui.Pulldown.prototype.getPopupListConfig.call(this);p.showTooltip=function q(w,v){if(!this.hasOpenTooltip){var u=O.eventTarget(v,w),t=this.getItemFromTarget(u);if(t){var r=this.getItemNodeFromTarget(u);this.richTooltip={content:t.d,refNode:r,cssClass:"vi-regular vi-tooltip-C pulldown-tooltip",left:149,top:0};mstrmojo._HasTooltip.showTooltip.call(this,w,v);}}};p.tooltipOpenDelay=700;return p;},postBuildRendering:function(){var p=this.parent.parent,r=p.dataset.dsm,q=p.editorContainer.filterBtn;if(r||p.hasLTSDataset){this.set("enabled",false);if(r===c.LIVE){q.set("enabled",false);}}this.selectedIndex=r?r-1:0;this.constructor.prototype.postBuildRendering.call(this);},onSelectedItemChange:function(){var p=this.parent.parent,r=p.editorContainer.filterBtn,t=function(w,v){mstrmojo.confirm("<b>"+mstrmojo.desc(15819,"Switching to Connect Live will remove the filters defined in this dataset. Would you like to continue?")+"</b><br /><br />"+mstrmojo.desc(15816,"Filter at the dataset level is only supported for In-Memory data access mode."),{confirmBtn:{t:mstrmojo.desc(7660,"Switch"),fn:w},cancelBtn:{t:mstrmojo.desc(2140,"Cancel"),fn:v}},{title:mstrmojo.desc(15817,"Switch to Connect Live Mode"),allowHTML:true});},q=function(){p.dataset.dsm=this.selectedIndex+1;p.modifiedItems.filter=undefined;r.set("enabled",false);r.refresh();},u=function(){this.set("selectedIndex",c.IN_MEMORY-1);};if(this.selectedIndex===c.LIVE-1){if(p.modifiedItems.filter){t(q.bind(this),u.bind(this));}else{q.bind(this)();}}else{p.dataset.dsm=this.selectedIndex+1;r.set("enabled",true);r.refresh();}}},{scriptClass:"mstrmojo.Label",slot:"dataModeInfoNode",alias:"dataModeInfoIcon",cssClass:"info-icon",richTooltip:{cssClass:"vi-regular V-center vi-tooltip-V pulldown-tooltip",posType:mstrmojo.tooltip.POS_BOTTOMCENTER,enableHover:true,},useRichTooltip:false,updateTooltipConfig:function k(){var q=this.richTooltip,p=O.position(this.domNode);q.left=p.x+p.w-9;q.top=p.y-9;q.content=mstrmojo.desc(15818,"You can determine how a dossier accesses data in this dataset. The dataset access mode determines whether the data is loaded in-memory or retrieved directly from the source.");q.content+="<br /><div class='help-link-label' onclick='mstrApp.showHelpTopic(\"##HELPTOPIC##\")'>"+mstrmojo.desc(15811,"Learn more about Data Access Mode")+"</div>";q.content=q.content.replace("##HELPTOPIC##",a);},postCreate:function(){var p=this.parent.parent;if(p.dataset.id===""&&!p.hasLTSDataset){this.useRichTooltip=true;}}}]}]});}());(function(){mstrmojo.requiresCls("mstrmojo.array","mstrmojo.hash","mstrmojo.vi.ui.DatasetUnitMenuUtils","mstrmojo.models.template.DataInterface","mstrmojo.chart.model.enums.EnumDSSObjectType","mstrmojo.ui.menus.MenuConfig","mstrmojo.ui.menus.EditorConfig","mstrmojo.Button","mstrmojo.Label","mstrmojo.ui.CheckList","mstrmojo.ui.Pulldown","mstrmojo.models.datasets.DataInterface","mstrmojo.vi.viz.EnumDSSDropZones","mstrmojo.vi.models.VIComponentMap","mstrmojo.threshold.ThresholdController","mstrmojo.threshold.ThresholdModel","mstrmojo.chart.model.enums.EnumDSSAxisName","mstrmojo.chart.model.enums.EnumDSSDynamicShortcut","mstrmojo.chart.model.enums.EnumDSSXMLAxesBitMap","mstrmojo.mstr.EnumDSSXMLBaseFormType","mstrmojo.mstr.EnumDSSXMLObjectTypes","mstrmojo.ME.MetricDataService","mstrmojo.mstr.EnumDSSXMLObjectSubTypes","mstrmojo.mstr.EnumDSSConsolidationType");var c=mstrmojo,N=c.array,S=c.hash,AQ=mstrmojo.chart.model.enums.EnumDSSObjectType,f=c.vi.ui.DatasetUnitMenuUtils,X=mstrmojo.models.datasets.DataInterface,AL=c.vi.models.VIComponentMap,g=mstrmojo.vi.viz.EnumDSSDropZones,I=mstrmojo.ME.MetricDataService,H=1,AJ=2,F=3,AS=4,P=5,AE=6,k=7,O=8,w=9,AV=10,A=11,AB=12,D="00000000000000000000000000000000",AH=-1,d=mstrmojo.chart.model.enums.EnumDSSXMLAxesBitMap,AD=mstrmojo.chart.model.enums.EnumDSSAxisName,Ac=mstrmojo.chart.model.enums.EnumDSSDynamicShortcut,R=mstrmojo.mstr.EnumDSSXMLBaseFormType,V=mstrmojo.mstr.EnumDSSXMLObjectTypes,Ab=mstrmojo.mstr.EnumDSSXMLObjectSubTypes,G=mstrmojo.mstr.EnumDSSConsolidationType;function W(Ah){var Ai=this.getHost(),Aj=Ai.model.data.gsi;return Aj.cols.concat(Aj.rows).filter(function(Ak){return Ak.t===Ah;});}function AA(Ah,Aj,Ai){return{act:"updateTemplate",keyContext:Ah.k,partialRetrieval:{nodes:Ai?null:[Ah.k]},actions:Aj};}function AR(Ak,Ai,Al){var Ap=this,Am=[],An=[],Aq={};if(Ai.useDropzone){Ak.useDropzone=true;Aq.dropzoneId=Ai.zone.id;if(Ai.item.ax!==undefined){Aq.ax=Ai.item.ax;}}Aq.position=Ai.idx+1+(Al.offset||0);if(Al.replaceSourceId){Ak.replaceSourceId=Al.replaceSourceId;}if(Al.addToTooltip){An.push({dropzoneId:w,position:Ap.gmZones.getTooltipDropzoneIdx(Ai.item),});}Ak.partialRetrieval={nodes:[Ak.nodeKey]};An.push(Aq);Ak.dropzones=An;Am.push(Ak);var Ao="$GUID_115",Ah=[],Aj=this.checkAndAddThresholdAction(Ai.zone.id,{did:Ao,t:4},Ah);if(Aj){Ak.newObjectIds=[Ao];Am.push(this.getUpdateTemplateAction(Ah));}return Am;}function Ag(Ak){var Ah=this.getHost().model.data.datasetId,Aj=N.ensureArray(Ak),Ai=N.hash(Aj);if(!Ah){S.forEach(this.docModel.datasets,function(An,Ao){var Al=(An.att||[]).concat(An.mx||[]),Am=Al.some(function(Ap){return Ai[Ap.did];});if(Am){Ah=Ao;return false;}});}return Ah;}function AW(Ah,Al,Ai){var Ao=this,At=this.docModel,An=Ah.item,Ar=f.getUnitFromDataset(Ao.docModel.datasets,An.did,An.t)||An,Au=this.getHost(),Aq=Ao.docModel.getDataService(),Am=Al==="edit",Ap=Au.getChartStyle&&Au.getChartStyle()==="NewGraphMatrixVisualizationStyle",Aj,Ak={dsid:Am?At.findDatasetIdFromUnit(Ar.did):Ag.call(Ao,Ar.did),alias:Ar.alias||Ar.n},As=null;if(Ar.t===V.Metric){if(Am){Aj={metricId:Ar.did,metric:Ar,action:{cmd:Al,n:Ar.n,alias:An.n}};Ak.did=Ar.did;Ak.nodeKey=Au.k;As=Aq.getEditDerivedMetricSubmitFunc(Ak);}else{Aj={metricId:"",action:{cmd:Al,refOi:{did:Ar.did,n:Ar.n}}};Ak.nodeKey=Au.k;Ak.idx=Ah.idx;Ak.host=Au;Ak.zoneid=Ah.zone.id;if(Ap){Ak.extraZone={id:w,idx:Ao.gmZones.getTooltipDropzoneIdx(Ah.item),};}if(Ai){Ak.replace={did:Ar.did,t:Ar.t};}if(Ah.useDropzone){As=Aq.getAddNewDerivedMetricToDropzoneSubmitFunc(Ak);}else{As=Aq.getAddNewDerivedMetricToXtabSubmitFunc(Ak);}}if(Ao.docModel.isFromSolrCube(Ar.did)||Ao.docModel.isFromMDXCube(Ar.did)){Aj.disableAFB=true;}Ao.docModel.controller.openDME(Au,Aj,As);}}mstrmojo.vi.models._DropZoneCommon=mstrmojo.provide("mstrmojo.vi.models._DropZoneCommon",{_mixinName:"mstrmojo.vi.models._DropZoneCommon",isMetric:function j(Ah){return Ah&&Ah.t===V.Metric&&Ah.id!==D;},isAttribute:function AF(Ah){return Ah&&Ah.t===V.Attribute;},isRecursiveAttribute:function b(Ah){return Ah&&Ah.t===V.Attribute&&Ah.st===Ab.AttributeRecursive;},isNewDerivedElement:function AM(Ah){return Ah.t===V.Consolidation&&Ah.st===Ab.ConsolidationManaged;},isNewDerivedRecursiveElement:function AM(Ah){return Ah.t===V.Consolidation&&Ah.st===Ab.ConsolidationManaged&&Ah.ndetype===G.DssRecursiveDerivedElement;},isConsolidation:function Aa(Ah){return Ah.t===V.Consolidation&&Ah.st===Ab.Consolidation;},isCustomGroup:function C(Ah){return Ah.t===V.Filter;},isAttrCategory:function Y(Ah){return Ah&&(Ah.t===V.Attribute||Ah.t===V.Filter||Ah.t===V.Consolidation||Ah.t===V.Dimension);},isMetricName:function AU(Ah){return Ah&&(Ah.id===D||Ah.did===D);},differInType:function U(Ai,Ah){return(this.isMetric(Ai)&&this.isAttrCategory(Ah))||(this.isAttrCategory(Ai)&&this.isMetric(Ah));},isDynamicLink:function J(Ai){if(this.isAttribute(Ai)){var Ah=Ai.fs||X.getFormsByAttrId(Ai.did,this.docModel.datasets);return Ah.length===2&&Ah[1].bftp===R.DssXmlBaseFormHTMLTag&&Ah[1].fnm==="DYNAMICLINK";}return false;},hasOldDEOverDatasets:function(Ak){var Aj=this.docModel.datasets,Ai=false,Ah;S.forEach(Aj,function(Al){Ah=N.find((Al.att||[]),"did",Ak);if(Ah!==-1&&Al.att[Ah].de){Ai=true;return false;}});return Ai;},getZoneModelByZoneId:function(Ah){var Ai=this.dropZones,Aj;N.forEach(Ai,function(Ak){if(Ak.id===Ah){Aj=Ak;return false;}});return Aj;},hGetItemOccurrence:function(Al,An){An=An||[];if(An.length===0){An=[H,AJ,F,AS,k,P,O,w,AE,AV];}var Aj,Ah,Ai,Am=An.length,Ak=[];for(Aj=0;Aj<Am;Aj++){Ai=this.getZoneModelByZoneId(An[Aj]);if(!Ai){continue;}Ah=this.getUnitIndexInZone(Ai,Al);if(Ah!==-1){Ak.push({zoneId:An[Aj],itemIndex:Ah});}}return Ak;},removeColorByItemFromBreakByIfExists:function AC(Ak,Am){var Al,Aj,Ah,Ai;Al=this.hGetItemOccurrence(Ak,[H,AJ,F,AS,P,O,AE]);if((Al.length===1)&&(Al[0].zoneId===P||Al[0].zoneId===AE)){Aj=Al[0];Ah=this.getZoneModelByZoneId(Aj.zoneId);Ai=Ah.items[Aj.itemIndex];if(Ai.hidden){Array.prototype.push.apply(Am,this.getRemoveDropZoneUnitActions(Ah,Ai));}}},updateBreakByAndSliceUnits:function m(){var Ah=this,Aj=[H,AJ,F,AS,k,O,A,AB],Ai=this.getZoneModelByZoneId(AE)||this.getZoneModelByZoneId(P),Ak;Ai.items.forEach(function(Al){if(Ah.isAttrCategory(Al)||Ah.isMetricName(Al)){Ak=Ah.hGetItemOccurrence(Al,Aj);if((Ak.length===1)&&(Ak[0].zoneId===k)){Al.hidden=true;}}});},getAxisSummary:function AN(){var Ah={};Ah[F]=this.getItemCountInZone(F);Ah[AS]=this.getItemCountInZone(AS);Ah[AV]=this.getItemCountInZone(AV);return Ah;},getItemCountInZone:function(Ah){var Ai=this.getZoneModelByZoneId(Ah);if(Ai){return Ai.items.length;}return 0;},isOnlyMetricZone:function h(Ah){var Aj,Al,Ak,Ai=this.getZoneModelByZoneId(Ah);if(!Ai){return false;}Ak=Ai.items;Al=Ak.length;if(Al===0){return false;}for(Aj=0;Aj<Al;Aj++){if(!this.isMetric(Ak[Aj])){return false;}}return true;},isMetricZone:function z(Ah){var Aj,Al,Ak,Ai=this.getZoneModelByZoneId(Ah);if(!Ai){return false;}Ak=Ai.items;Al=Ak.length;if(Al===0){return false;}for(Aj=0;Aj<Al;Aj++){if(!this.isMetric(Ak[Aj])){if(this.isMetricName(Ak[Aj])){continue;}else{return false;}}}return true;},getMetricCntInZone:function(Ah){var Aj=this,Ai=this.getZoneModelByZoneId(Ah),Al=Ai.items,Ak=0;N.forEach(Al,function(Am){if(Aj.isMetric(Am)){Ak++;}});return Ak;},isAttrCategoryZone:function(Ah){var Aj,Al,Ak,Ai=this.getZoneModelByZoneId(Ah);if(!Ai){return false;}Ak=Ai.items;Al=Ak.length;if(Al===0){return false;}for(Aj=0;Aj<Al;Aj++){if(!this.isAttrCategory(Ak[Aj])&&!this.isMetricName(Ak[Aj])){return false;}}return true;},getZoneSummary:function AK(Ah){var Ak=this,Ai=this.getZoneModelByZoneId(Ah),Am=Ai?Ai.items:[],Al=0,An=0,Aj=false;N.forEach(Am,function(Ao){if(Ak.isMetric(Ao)){Al++;}else{if(Ak.isAttrCategory(Ao)){An++;}else{if(Ak.isMetricName(Ao)){Aj=true;}}}});return{metricCount:Al,attributeCount:An,hasMetricName:Aj};},isTemplateContainAttCategoryItem:function AP(){var Ak=this,Aj=Ak.getHost(),Al=Aj.model.data.gsi,Ai=(Al.rows||[]).concat(Al.cols||[]),Ah=false;if(Ai&&Ai.length){N.forEach(Ai,function(Am){if(Ak.isAttrCategory(Am)){Ah=true;return false;}});}return Ah;},showNumberFormat:function(Ah){return mstrmojo.all[this.hostId].model.showNumberFormat(Ah);},renameItem:function(Ai,Ah){var Aj=this.id;f.renameItem(Ai,Ah,function(An){var Ap=mstrmojo.all[Aj],As=Ap.getHost(),Am=Ap.getHostModel().gsi,Ao=An.allowTrimming?An.text.trim():An.text,At=Ah.t===V.Metric,Al=At?Am.mx:Am.rows.concat(Am.cols),Ar=function(){Ap.submitDropZoneUpdates(AA(As,[{act:"renameUnit",id:Ah.did,type:Ah.t,name:Ao,isDynamicAlias:false}]));},Ak=function(){An.set("text",Ah.n);},Aq=Al.some(function(Au){return Au.did!==Ah.did&&(At||Au.t===Ah.t)&&Au.n===Ao;});if(Aq){mstrmojo.warn(mstrmojo.desc(11664,'"##" already exists in the visualization. Do you want to proceed?').replace("##",Ao),{confirmBtn:{fn:Ar},cancelBtn:{fn:Ak}});}else{Ar();}},{allowEmptyText:true,cssClass:Ai.className});},getPageByUnit:function Ad(){var Ai=this.getHost(),Ah=Ai.builder.getLayoutVIMap(Ai.defn._lkz).getComponent(AL.TYPES.PAGEBY_PANEL);return Ah&&Ah.unit;},shouldShowDisplayFormsMenu:function E(Ak){if(!mstrmojo.resolveFeature("set-attributeform-display")||!this.isAttribute(Ak)&&!this.isNewDerivedRecursiveElement(Ak)||this.isDynamicLink(Ak)){return false;}var Ah=X.getFormsByAttrId(Ak.attId||Ak.did,this.docModel.datasets),Al=this.getHost().model.data,Ai=Al&&Al.gts,Aj=!!Ai&&Ah.length>1;if(Ai&&Ah.length===1){var Am=false;N.forEach((Ai.row||[]).concat(Ai.col||[]),function(An){if(An.id===Ak.did&&N.find(An.fs||[],"id",Ah[0].fid)>-1){Am=true;return false;}});if(!Am){Aj=true;}}return Aj;},getDisplayFormsMenu:function(Ai){var Ah=this;return f.getDisplayFormsMenu(Ai,Ah.getHost(),Ah.docModel.datasets,function(Aj){Ah.submitDropZoneUpdates(Aj);});},editDerivedMetric:function(Ah){AW.call(this,Ah,"edit");},newDerivedMetric:function(Ai){var Ah=mstrmojo.all[this.hostId].zonesModel.allowInsertNewMetric(Ai.zone);if(Ai.zone.id===k){Ah=false;}AW.call(this,Ai,"editNew",!Ah);},newDerivedAttribute:function e(An,Aj){var Ao=An.item,Am=f.getUnitFromDataset(this.docModel.datasets,Ao.did,Ao.t)||Ao,Al=this.getHost(),Ai=Al.getChartStyle&&Al.getChartStyle()==="NewGraphMatrixVisualizationStyle",Ak=this,Ah={forceRefresh:true,alias:"New Attribute",precreate:function(Aq){if(Ak.getAddItemActions){var Ap=Ak.getAddItemActions(An.zone,[{did:"$GUID_1",t:12}]);Aq.newObjectIds=["$GUID_1"];if(Aj){Ap=Ak.getRemoveDropZoneUnitActions(An.zone,Am).concat(Ap);}Aq=[Aq,{act:"updateTemplate",keyContext:Al.k,actions:Ap}];}else{Aq=S.copy({act:"addDAToTemplate",nodeKey:Al.k,treeType:Al.defn.tt},Aq);if(An.useDropzone){Aq.useDropzone=true;Aq.dropzones=[{dropzoneId:An.zone.id,position:0}];if(An.item.ax!==undefined){Aq.dropzones[0].ax=An.item.ax;}if(Aj){Aq.dropzones[0].replaceSourceId=Am.did;}}else{Aq.axis=An.axis;}if(Ai){Aq.dropzones.push({dropzoneId:w,position:0});}}return Aq;}};this.docModel.controller.openDAE(this,Ah,mstrmojo.emptyFn,Am);},newDynamicLinkAttr:function x(Am,Ai){var An=Am.item,Al=f.getUnitFromDataset(this.docModel.datasets,An.did,An.t)||An,Ak=this.getHost(),Aj=this,Ah={forceRefresh:true,alias:"New Link",precreate:function(Ap){if(Aj.getAddItemActions){var Ao=Aj.getAddItemActions(Am.zone,[{did:"$GUID_1",t:12}]);Ap.newObjectIds=["$GUID_1"];if(Ai){Ao=Aj.getRemoveDropZoneUnitActions(Am.zone,Al).concat(Ao);}Ap=[Ap,{act:"updateTemplate",keyContext:Ak.k,actions:Ao}];}else{Ap=S.copy({act:"addDAToTemplate",nodeKey:Ak.k,treeType:Ak.defn.tt},Ap);if(Am.useDropzone){Ap.useDropzone=true;Ap.dropzoneId=Am.zone.id;if(Am.item.ax!==undefined){Ap.ax=Am.item.ax;}if(Ai){Ap.replaceSourceId=Al.did;}}else{Ap.axis=Am.axis;Ap.pos=Am.idx+2;}}return Ap;}};this.docModel.controller.openDynamicLinkEditor(this,Ah,mstrmojo.emptyFn,Al);},editDerivedAttribute:function(Ak){var Aj=this.getHost(),Am=Ak.item,Ai=f.getUnitFromDataset(this.docModel.datasets,Am.did,Am.t)||Am,Al=this.docModel.findDatasetIdFromUnit(Ai.did),Ah={dsid:Al,did:Ai.did,n:Ai.n,alias:Am.n,forms:Ai.fs,preupdate:function(Ao){var An=Ao.name;Ao.name=Ai.n;Ao=[Ao,AA(Aj,[{act:"renameUnit",id:Ai.did,type:12,name:An}],true)];return Ao;}};if(this.isDynamicLink(Am)){this.docModel.controller.openDynamicLinkEditor(this,Ah,mstrmojo.emptyFn);}else{this.docModel.controller.openDAE(this,Ah,mstrmojo.emptyFn);}},getTemplateAttributes:function l(){return W.call(this,12);},getTemplateHierarchies:function Z(){return W.call(this,14);},getTemplateDEs:function AY(){var Ah=this.getHost(),Ai=Ah.model.data.gsi;return Ai.cols.concat(Ai.rows).filter(function(Aj){return Aj.st===Ab.ConsolidationManaged;});},getUnitInfoInTemplate:function o(Ai){var Aj={},Ah=this.getHost().model.data.gts;[{axis:H,name:"row"},{axis:AJ,name:"col"}].forEach(function(Ak){N.forEach(Ah[Ak.name],function(Am,Al){if(Am.id===Ai){Aj.axis=Ak.axis;Aj.axisName=Ak.name;Aj.tplIdx=Al;Aj.unit=Am;return false;}});});return Aj;},sortGrid:function t(An,Al){var Ao=this.getHost(),Ak=An.t,Am=An.did,Ah=null,Aj=null;if(Ak===AQ.DssTypeMetric){Aj=["","","",1];}else{Ah=this.getUnitInfoInTemplate(An.did);Aj=[Ah.unit.fid||(Ah.unit.fs&&Ah.unit.fs[0].id),"21","",Ah.axis];}var Ap=Ah?Ah.axis:H,Ai=Ao.model.data.gts[(Ap===H?"row":"col")+"SubPos"];Ao.controller.onSort(Ao,Ao.model.getSortGridAction(Ai,[Ak,Am].concat(Aj).join("!"),Ap,Al));},addSortMenu:function a(Ai,Am,Aq){var Ap=this,Ar=this.getHost(),As=Ai.item,Aj=Ai.axis,Ak=Ar.model.data,Ah=Ak.gts,Ao=Ak.gsi.tma,An=S.copy(As);if(As.t===AQ.DssTypeFilter){return ;}if(As.t===AQ.DssTypeDimension){N.forEach((Ah.row||[]).concat(Ah.col||[]),function(Au){if(Au.hid===An.did){An.did=Au.id;An.t=Au.otp;return false;}});}if(Aj!==AH||Ao!==H){if(Ai.zone.id!==AH||Ah.col.length<=1){Am.addMenuItem(mstrmojo.desc(7974,"Sort Ascending"),"xt",function(){Ap.sortGrid(An,true);});Am.addMenuItem(mstrmojo.desc(7975,"Sort Descending"),"xt",function(){Ap.sortGrid(An,false);});}if(Ar.isVIXtab&&Ar.model.isRecursiveAttribute(As.did)&&mstrApp&&mstrApp.isAppStateDefault()&&!mstrApp.isDossier){Am.addMenuItem(mstrmojo.desc(15676,"Custom Sort..."),"xt",function(){if(Ar.customSort){Ar.customSort(N.filterOne(Ah.col.concat(Ah.row),function(Au){return Au.id===As.did;}),Aj);}});}}if(Aq){if(!Ar.excludeData){Am.addMenuItem(mstrmojo.desc(11099,"Advanced Sort..."),"xt",function(){if(Aj===AH){Aj=Ao;}Ar.controller.onGetAdvSortData(Ar,Aj,An.t);});}}else{var Al=Ak.gsi.sorts.some(function(Au){return !!Au.length;}),At=mstrmojo.desc(11699,"Clear Sort");if(Al){Am.addMenuItem(At,"",function(){Ap.submitDropZoneTemplateUpdates([{act:"clearSort"}]);});}}},convertToMetric:function p(An){var Am=this.getHost(),Ah=Am.model&&Am.model.data&&Am.model.data.datasetId,Aj=Am.k,Al=Am.defn.tt,Ak=An.item;if(!Ah){mstrmojo.hash.forEach(this.docModel.datasets,function(Ap,Aq){if(mstrmojo.array.find((Ap.att||[]),"did",Ak.did)!==-1){Ah=Aq;return false;}});}var Ai=mstrmojo.mstr.EnumFunction,Ao=AR.call(this,{act:"addShortcutMetric",nodeKey:Aj,treeType:Al,funcType:Ak.formType===2?Ai.FunctionSum:Ai.FunctionCount,units:[{id:Ak.did,type:Ak.t}],prs:[{n:"UseLookupForAttributes",v:"0"}],dsid:Ah,replaceSourceId:Ak.did},An);this.submitActionForDatasetUpdate(Ao);},getAddMetricNameAction:function(Aq,Am){if(!this.gmZones){return null;}var Ao=this,Ai=0,An=false,Al,Ah=Ao.gmZones.getZoneModelByZoneId((Am===H)?AS:F),Ap={n:"Metric Names",did:D,t:0},Ak=S.clone(Ap),Aj=Ao.gmZones.hGetItemOccurrence(Ak,[H,AJ,F,AS,k]);N.forEach(Ah.items,function(Ar){if(Ao.isMetric(Ar)){Ai++;}});if(Aj.length===0&&Ai<=1){An=true;}if(An){Al={act:"updateTemplate",keyContext:Aq.k,actions:Ao.gmZones.getUpdateMetricNameUnitActions(An,Am)};}return Al;},getAggregateByMetricSubMenu:function(Ai){var Am=this,Al=Ai.item,Ap=f.getUnitFromDataset(this.docModel.datasets,Al.did,Al.t)||Al,Ah=this.id,Aq=this.getHost(),Ak=Aq.k,Aj=Aq.defn.tt,An=this.submitActionForDatasetUpdate,Ao=Aq.getChartStyle&&Aq.getChartStyle()==="NewGraphMatrixVisualizationStyle";return f.getAggregateByMenu(Ap,function(Av,At){var As=Am.allowInsertNewMetric(Ai.zone),Ax=[];if(Ai.zone.id===k){As=false;}if(As&&Ai.useDropzone&&Am.gmZones){var Aw=Am.gmZones.getZoneModelByZoneId((Ai.zone.id===AS)?H:AJ);var Au=Am.getAddMetricNameAction(Aq,Aw.id);if(Au){Ax.push(Au);}Au=Am.gmZones.getUpdateGroupInfoActionForNewMetric(Ai.zone.id,Ai.idx+1,Al.ax===0);if(Au){Ax.push(Au);}}var Ar=[];if(I.isFuncHasUseLookupForAttributeProp(At)){Ar=[{n:"UseLookupForAttributes",v:"0"}];}An.call(mstrmojo.all[Ah],Ax.concat(AR.call(Am,{act:"addShortcutMetric",dsid:Ag.call(Am,Ap.did),nodeKey:Ak,treeType:Aj,funcType:At,units:[{id:Av.did,type:Av.t}],prs:Ar},Ai,{offset:As?1:0,replaceSourceId:As?null:Ap.did,addToTooltip:Ao})));});},getCalculationEditorCfg:function AT(Ah){var Am=this,Ap=this.getHost(),Al=this.submitActionForDatasetUpdate.bind(this),Ak=Ap.k,Ao=Ap.model.data.gsi,Ai=Ap.defn.tt,Aq=Am.allowInsertNewMetric(Ah.zone),Aj=[],An=Ap.getChartStyle&&Ap.getChartStyle()==="NewGraphMatrixVisualizationStyle";if(Ah.zone.id===k){Aq=false;}return f.getCalculationMetricEditor(Ao.mx,Ah.item,function(As,Ar,Aw,At){if(Aq&&Ah.useDropzone&&Am.gmZones){var Av=Am.gmZones.getZoneModelByZoneId((Ah.zone.id===AS)?H:AJ);var Au=Am.getAddMetricNameAction(Ap,Av.id);if(Au){Aj.push(Au);}Au=Am.gmZones.getUpdateGroupInfoActionForNewMetric(Ah.zone.id,Ah.idx+1,Ah.item.ax===0);if(Au){Aj.push(Au);}}Al(Aj.concat(AR.call(Am,{act:"addShortcutMetric",dsid:Ag.call(Am,Ah.item.did),nodeKey:Ak,treeType:Ai,funcType:Aw,funcType2:At,units:[As,Ar]},Ah,{offset:Aq?1:0,replaceSourceId:Aq?null:Ah.item.did,addToTooltip:An})));});},submitAddShortcutMetric:function(An,Az){var A1=this,Au=A1.id,Ar=this.getHost(),Ai=Ar.k,Ak=Ar.defn.tt,A2=A1.submitActionForDatasetUpdate,Ax=A1.allowInsertNewMetric(An.zone),Ap=[],As=Ar.getChartStyle&&Ar.getChartStyle()==="NewGraphMatrixVisualizationStyle";if(An.zone.id===k){Ax=false;}if(Ax&&An.useDropzone&&A1.gmZones){var Am=A1.gmZones.getZoneModelByZoneId((An.zone.id===AS)?H:AJ);var Aw=A1.getAddMetricNameAction(Ar,Am.id);if(Aw){Ap.push(Aw);}Aw=A1.gmZones.getUpdateGroupInfoActionForNewMetric(An.zone.id,An.idx+1,An.item.ax===0);if(Aw){Ap.push(Aw);}}var Ay=Az.item,Aq=Az.extraItem,A0=Az.funcType,Aj=Az.funcType2,Ao=Az.breakBys,Ah=Az.sortBys,Al=Az.prs,Av=[{id:Ay.did,type:Ay.t}],At;if(Aq){Av.push(Aq);}At={act:"addShortcutMetric",dsid:Ag.call(A1,Ay.did),nodeKey:Ai,treeType:Ak,funcType:A0,units:Av,breakBys:Ao,sortBys:Ah};if(Aj){At.funcType2=Aj;}if(Al){At.prs=Al;}if(I.isFuncHasUseLookupForAttributeProp(A0)){At.prs=At.prs||[];At.prs.push({n:"UseLookupForAttributes",v:"0"});}Ap=Ap.concat(AR.call(A1,At,An,{offset:Ax?1:0,replaceSourceId:Ax?null:Ay.did,addToTooltip:As}));A2.call(mstrmojo.all[Au],Ap);},getDynamicBreakByAxisOptions:function(Aj){var Al=this,Ak=Al.getHost(),Am=Ak.model.data.gsi,Ah=[],Ai=function Ai(An){return An.some(function(Ao){return Al.isAttribute(Ao)||Al.isNewDerivedElement(Ao)||Al.isCustomGroup(Ao)||Al.isConsolidation(Ao);});};if(Ai(Am.rows)){Ah.push({n:Aj?mstrmojo.desc(3326,"By Columns"):mstrmojo.desc(122,"Columns"),axes_bitmap:d.DssXmlAxisRowsBit,dmy:"@cols"});}if(Ai(Am.cols)){Ah.push({n:Aj?mstrmojo.desc(3327,"By Rows"):mstrmojo.desc(2968,"Rows"),axes_bitmap:d.DssXmlAxisColumnsBit,dmy:"@rows"});}return Ah;},getBreakByAxisOptions:function(Ai){var Ah=[{n:mstrmojo.desc(4531,"Automatic"),axes_bitmap:AD.DssAxisDynamicShortcutRoot+Ac.DssDynamicShortcutAuto,dmy:"@auto"},{n:Ai?mstrmojo.desc(13408,"By None"):mstrmojo.desc(2057,"None"),axes_bitmap:d.DssXmlAxisPagesBit,dmy:"@p"}];if(Ai){Ah.splice(1,0,{isSeparator:true});}return Ah.concat(this.getDynamicBreakByAxisOptions(Ai));},getBreakByAttributeOptions:function(){var Ah=this,Ai=[],Ak=Ah.getTemplateAttributes().concat(Ah.getTemplateDEs()),Aj=Ah.getPageByUnit();Ai=Ai.concat(Ak);if(Aj&&Aj.srcid){if(N.find(Ai,"did",Aj.srcid)===-1){Ai.push({n:Aj.n,did:Aj.srcid,t:Aj.srct});}}return Ai;},getDynamicBreakByOptions:function(Ah){var Ai=this,Aj=Ai.getBreakByAttributeOptions();if(Ah&&Aj.length){Aj.unshift({isSeparator:true});}return Ai.getBreakByAxisOptions(Ah).concat(Aj);},getDynamicLevelOptions:function(){var Ah=this,Aj=Ah.getBreakByAxisOptions(true),Ai=Ah.getBreakByAttributeOptions();Aj.some(function(Ak){if(Ak.axes_bitmap===d.DssXmlAxisPagesBit){Ak.n=mstrmojo.desc(3329,"Grand Total");return true;}});if(Ai.length){Ai.unshift({isSeparator:true});}return Aj.concat(Ai);},getShortcutMetricSubMenu:function(Al){var Ak=this,Ah=new mstrmojo.ui.menus.MenuConfig(),Am=Al.item,Aj=f.getUnitFromDataset(this.docModel.datasets,Am.did,Am.t)||Am,Ai=Ak.allowInsertNewMetric(Al.zone);if(Aj.t===V.Metric){Ak.addRankShortcutMenu(Al,Ah);Ak.addPercentileShortcutMenu(Al,Ah);Ak.addPercentToTotalShortcutMenu(Al,Ah);Ah.addSeparator();Ak.addPercentOfShortcutMenu(Al,Ah);Ak.addPercentChangeShortcutMenu(Al,Ah);Ak.addDifferenceShortcutMenu(Al,Ah);Ah.addSeparator();Ak.addMovingTotalShortcutMenu(Al,Ah);Ak.addRunningTotalShortcutMenu(Al,Ah);Ak.addPercentRunningTotalShortcutMenu(Al,Ah);}Ah.addSeparator();Ah.addMenuItem(mstrmojo.desc(11491,"More Functions..."),"",function(){AW.call(Ak,Al,"add",!Ai);},Aj);return Ah;},hasReplaceCandidates:function(Ah){var Ai=this.getReplaceCandidates(Ah.zone,Ah.item);return Ai&&Ai.length>0;},getReplaceSubMenu:function(Ai,Ak){var Ao,Ap=Ai.item,Al=Ai.zone,Aj=this.getReplaceCandidates(Al,Ap),Am=this;Ao=Ak?[Ak]:[];Ao.push({scriptClass:"mstrmojo.ui.ScrollableContainer",alias:"scrollableContainer",children:[{scriptClass:"mstrmojo.vi.ui.InteractiveUnitList",draggable:false,CLS_HAS_MENU:"",items:Aj,listHooks:{select:function An(Aq,Ar){Am.unitsDropped(Al,{src:{data:{item:Ar,items:[Ar],dsid:Ar.dsId}},getCtxtDragData:function(){var As=this.src;return(As&&As.data)||{};}},{allowedItems:[Ar],idx:N.find(Al.items,"did",Ap.did)===-1?Ap._renderIdx:N.find(Al.items,"did",Ap.did),edge:mstrmojo.vi.models.DropZonesModel.ENUM_TARGET_POSITION.ON,removeReplaced:true});if(this.parent&&this.parent.parent&&this.parent.parent.closeAllMenus){this.parent.parent.closeAllMenus();}}}}]});return new mstrmojo.ui.menus.EditorConfig({data:{},cssClass:"replaceReference",okVisible:false,cancelVisible:false,contents:Ao,onOpen:function Ah(){this.scrollableContainer.updateScrollbars();}});},addRankShortcutMenu:function r(Ak,Ai){var Aj=this,Am=this.id;function Ah(Ap,Ao,An){Aj.submitAddShortcutMetric(Ak,{item:Ap,funcType:mstrmojo.mstr.EnumFunction.FunctionRank,prs:[{n:"ASC",v:Ao}],breakBys:An});}function Al(An){return f.getRankMetricEditor(An.item,Aj.getDynamicBreakByOptions(),Ah);}Ai.addActionPopupMenuItem(mstrmojo.desc(2789,"Rank"),Am,function(){Ah(Ak.item,"0",[{dmy:"@auto"}]);},Al,"",Ak);},addPercentileShortcutMenu:function q(Aj,Ah){var Ai=this,Am=this.id;function Ak(An){var Ao;if(An.dmy){Ao={dmy:An.dmy};}else{Ao={id:An.did,type:An.t};}Ai.submitAddShortcutMetric(Aj,{item:Aj.item,funcType:mstrmojo.mstr.EnumFunction.FunctionPercentRank,breakBys:[Ao],prs:[{n:"inclusive",v:"False"}]});}function Al(){var Ao=new mstrmojo.ui.menus.MenuConfig(),An=Ai.getDynamicBreakByOptions(true);An.forEach(function(Ap){if(Ap.isSeparator){Ao.addSeparator();return ;}Ao.addMenuItem(Ap.n,"",function(){Ak(Ap);});});return Ao;}Ah.addActionPopupMenuItem(mstrmojo.desc(13409,"Percentile Rank"),Am,function(){Ak({dmy:"@auto"});},Al,"",Aj);},addPercentToTotalShortcutMenu:function AG(Ai,Ao){var Aq=this,Ah=this.id,At=Ai.item,Au=Aq.getHost(),Ap=Aq.submitActionForDatasetUpdate.bind(Aq),An=Aq.getDynamicLevelOptions(),Am=Au.k,Aj=Au.defn.tt,As=Aq.allowInsertNewMetric(Ai.zone),Al=[];if(Ai.zone.id===k){As=false;}function Ar(Av){if(As&&Ai.useDropzone&&Aq.gmZones){var Ax=Aq.gmZones.getZoneModelByZoneId((Ai.zone.id===AS)?H:AJ);var Aw=Aq.getAddMetricNameAction(Au,Ax.id);if(Aw){Al.push(Aw);}Aw=Aq.gmZones.getUpdateGroupInfoActionForNewMetric(Ai.zone.id,Ai.idx+1,Ai.item.ax===0);if(Aw){Al.push(Aw);}}Ap(Al.concat(AR.call(Aq,{act:"addPercentToTotalMetric",nodeKey:Am,treeType:Aj,metric_id:At.did,axes_bitmap:Av.axes_bitmap||0,units:Av.did&&[{id:Av.did,type:Av.t}]},Ai,{offset:As?1:0,replaceSourceId:As?null:Ai.item.did})));}function Ak(){var Av=new mstrmojo.ui.menus.MenuConfig();An.forEach(function(Aw){if(Aw.isSeparator){Av.addSeparator();return ;}Av.addMenuItem(Aw.n,"",function(){Ar(Aw);});});return Av;}Ao.addActionPopupMenuItem(mstrmojo.desc(3323,"Percent to Total"),Ah,function(){Ar({axes_bitmap:AD.DssAxisDynamicShortcutRoot+Ac.DssDynamicShortcutAuto});},Ak,"",Ai);},addPercentOfShortcutMenu:function M(Al,Ah){var Ak=this,Am=this.id;function Aj(Ao,Ap,An){Ak.submitAddShortcutMetric(Al,{item:Ao,funcType:Ap,funcType2:mstrmojo.mstr.EnumFunction.FunctionDivide,breakBys:An,sortBys:[{dmy:"@auto"}]});}function Ai(An){return f.getRelativeReferenceMenu(An.item,mstrmojo.desc(13394,"Percent of:"),Ak.getDynamicBreakByOptions(),Aj);}Ah.addActionPopupMenuItem(mstrmojo.desc(13390,"Percent Of"),Am,function(){Aj(Al.item,mstrmojo.mstr.EnumFunction.FunctionLag,[{dmy:"@auto"}]);},Ai,"",Al);},addPercentChangeShortcutMenu:function n(Ak,Ai){var Aj=this,Am=this.id;function Al(Ao,Ap,An){Aj.submitAddShortcutMetric(Ak,{item:Ao,funcType:Ap,funcType2:mstrmojo.mstr.EnumFunction.FunctionVar,breakBys:An,sortBys:[{dmy:"@auto"}]});}function Ah(An){return f.getRelativeReferenceMenu(An.item,mstrmojo.desc(146,"From:"),Aj.getDynamicBreakByOptions(),Al);}Ai.addActionPopupMenuItem(mstrmojo.desc(13391,"Percent Change"),Am,function(){Al(Ak.item,mstrmojo.mstr.EnumFunction.FunctionLag,[{dmy:"@auto"}]);},Ah,"",Ak);},addDifferenceShortcutMenu:function K(Ak,Ah){var Aj=this,Am=this.id;function Ai(Ao,Ap,An){Aj.submitAddShortcutMetric(Ak,{item:Ao,funcType:Ap,funcType2:mstrmojo.mstr.EnumFunction.FunctionMinus,breakBys:An,sortBys:[{dmy:"@auto"}]});}function Al(An){return f.getRelativeReferenceMenu(An.item,mstrmojo.desc(146,"From:"),Aj.getDynamicBreakByOptions(),Ai);}Ah.addActionPopupMenuItem(mstrmojo.desc(11495,"Difference"),Am,function(){Ai(Ak.item,mstrmojo.mstr.EnumFunction.FunctionLag,[{dmy:"@auto"}]);},Al,"",Ak);},addMovingTotalShortcutMenu:function AI(Aj,Ah){var Ai=this,Am=this.id;function Al(Aq,Ap,Ao,An){Ai.submitAddShortcutMetric(Aj,{item:Aq,funcType:Ap,breakBys:An,sortBys:[{dmy:"@auto"}],prs:[{n:"OLAPWinStType",v:"3"},{n:"OLAPWinStOffset",v:Ao.toString()},{n:"OLAPWinEndType",v:"2"}]});}function Ak(An){return f.getMovingTotalMenu(An.item,Ai.getDynamicBreakByOptions(),Al);}Ah.addActionPopupMenuItem(mstrmojo.desc(13392,"Moving Average"),Am,function(){Al(Aj.item,mstrmojo.mstr.EnumFunction.FunctionOLAPAvg,1,[{dmy:"@auto"}]);},Ak,"",Aj);},addRunningTotalShortcutMenu:function AZ(Al,Ah){var Ak=this,Am=this.id;function Aj(Ap,Ao,An){Ak.submitAddShortcutMetric(Al,{item:Ap,funcType:Ao,breakBys:An,sortBys:[{dmy:"@auto"}],prs:[{n:"OLAPWinStType",v:"0"},{n:"OLAPWinEndType",v:"2"}]});}function Ai(An){return f.getRunningTotalMenu(An.item,Ak.getDynamicBreakByOptions(),Aj);}Ah.addActionPopupMenuItem(mstrmojo.desc(11906,"Running Total"),Am,function(){Aj(Al.item,mstrmojo.mstr.EnumFunction.FunctionOLAPSum,[{dmy:"@auto"}]);},Ai,"",Al);},addPercentRunningTotalShortcutMenu:function B(Ak,Ai){var Aj=this,Am=this.id;function Ah(Ap,An){var Ao=[];An.forEach(function(Aq){if(Aq.dmy){Ao.push({dmy:Aq.dmy});}else{Ao.push({id:Aq.did,type:Aq.t});}});Aj.submitAddShortcutMetric(Ak,{item:Ap,funcType:mstrmojo.mstr.EnumFunction.FunctionOLAPSum,funcType2:mstrmojo.mstr.EnumFunction.FunctionDivide,breakBys:Ao,sortBys:[{dmy:"@auto"}],prs:[{n:"OLAPWinStType",v:"0"},{n:"OLAPWinEndType",v:"2"}]});}function Al(Ap){var Ao=new mstrmojo.ui.menus.MenuConfig(),An=Aj.getDynamicLevelOptions();An.forEach(function(Aq){if(Aq.isSeparator){Ao.addSeparator();return ;}Ao.addMenuItem(Aq.n,"",function(){Ah(Ap.item,[Aq]);});});return Ao;}Ai.addActionPopupMenuItem(mstrmojo.desc(13393,"Percent Running Total"),Am,function(){Ah(Ak.item,[{dmy:"@auto"}]);},Al,"",Ak);},getMultipleMetricsCalcMenus:function v(Ao,An,Aq){var Ap=this,Ar=this.getHost(),Am=this.submitActionForDatasetUpdate.bind(this),Ak=Ar.k,Ai=Ar.defn.tt,Aj=An.map(function(As){return As.did;}),Ah=Ao.items.map(function(As){return As.did;}),Al=-1;Aj.forEach(function(As){var At=N.indexOf(Ah,As);if(At>Al){Al=At;}});return f.getMultipleMetricsCalculationMenus(An,Ar.model.data.datasetId,function(Au){var At={act:"addShortcutMetric",dsid:Ag.call(Ap,Aj),nodeKey:Ak,treeType:Ai,funcType:Au.funcType,funcType2:Au.funcType2,units:Au.items.map(function(Aw){return{id:Aw.did,type:Aw.t};}),position:Al+2,partialRetrieval:{nodes:[Ak]}},Av=[],As;if(Aq){At.useDropzone=Aq;At.dropzoneId=Ao.id;}Av.push(At);if(Ap.gmZones){As=Ap.gmZones.getUpdateGroupInfoActionForNewMetric(Ao.id,Al+1,true);}if(As){Av.push(As);}Am(Av);});},getCreateOrEditElementGroupFunc:function Af(Ai){var Ah=this;return function(){var Am=Ah.getHost(),An=Am.model,Al=Ai.item,Ak=Al.did,Aj=Ah.getUnitInfoInTemplate(Ak),Ap="$GUID_1",Ao=Aj.unit.ost===Ab.ConsolidationManaged&&An.docModel.getDEObject(Ak);Am.controller.openDEEditor(Am,Ao?{deObj:Ao}:{dsId:An.data.datasetId,attId:Ak,attName:Al.n,deId:Ap,getExtraSaveActions:function(){var Aq=Ai.zone,Ar=Ah.getRemoveDropZoneUnitActions(Aq,Al);Ar.push(Ah.getAddDropZoneUnitAction(Aq,{did:Ap,t:AQ.DssTypeConsolidation},Ai.idx));return Ah.getUpdateTemplateAction(Ar);}});};},buildThresholdMenuOptions:function u(Ai,Aj,Ah){mstrmojo.all[this.hostId].model.buildThresholdMenuOptions(Ai,Aj,Ah,this.canSupportImageThreshold());},canSupportImageThreshold:function L(){return false;},getNumberFormatEditorCfg:function Q(Ah){return mstrmojo.all[this.hostId].model.getNumberFormatEditorCfg(Ah);},submitUpdatesAndPersistWidgetXMLIfNecessary:function Ae(Ak,Aj,Ai){var Ah=Ak.model.docModel,Al=Ah.getDataService(),An,Am;if(!Ak.isXMLDirty()){Ak.controller.onSubmitTemplateUpdates(Ak,Aj,Ai);}else{Am={act:"updateTemplate",keyContext:Ak.k,actions:Aj};An=Ak.getPersistAction();Al.submitUpdates([Am,An],mstrmojo.func.wrapMethods(Ak.controller._getXtabCallback(Ak),Ai));Ak.resetXMLDirtyFlag();}},submitActionForDatasetUpdate:function AO(Ai){var Ah=this.docModel;this.submitDropZoneUpdates(Ai,mstrmojo.func.wrapMethods(Ah.getDatasetsUpdateCallback(),Ah.controller._getXtabCallback(this.getHost())));},getVFNotifierBlackList:function AX(Aj,Ah){var Ai=11,Ak=12;switch(Aj){case"XtabGrid":return[g.Rows,g.Columns];case"GraphMatrixVisualizationStyle":case"NewGraphMatrixVisualizationStyle":if(Ah){return[g.Rows,g.Columns,g.XAxis,g.YAxis,g.BreakBy,g.SliceBy,g.Angle,Ai,Ak];}else{return[g.Rows,g.Columns,g.XAxis,g.YAxis,g.BreakBy,g.SliceBy,g.Angle];}case"VIHeatMapVisualizationStyle":return[g.Rows,g.Columns,g.XAxis,g.YAxis,g.Grouping];case"NetworkVisualizationStyle":return[g.Rows,g.Columns,g.XAxis,g.YAxis,g.FromItem,g.ToItem];case"ImageLayoutVisualizationStyle":return[g.GeoAttribute,g.Layout];case"GoogleMapVisualizationStyle":case"ESRIMapVisualizationStyle":case"MapboxVisualizationStyle":return[g.Rows,g.Columns,g.XAxis,g.YAxis,g.SliceBy,g.Angle,g.GeoAttribute,g.Latitude,g.Longitude];case"KPICardVisualizationStyle":return[g.Rows,g.Columns,g.XAxis,g.YAxis,g.Metric,g.BreakBy];default:return[];}}});}());(function(){mstrmojo.requiresCls("mstrmojo.DocXtabModel","mstrmojo.vi.ui._CanDropFromSchema","mstrmojo.models.template.DataInterface","mstrmojo.vi.models.EnumDragSources","mstrmojo.array","mstrmojo.expr","mstrmojo.func","mstrmojo.hash","mstrmojo.DocDataService","mstrmojo.vi.ui.DatasetUnitMenuUtils","mstrmojo.fe.FilterUtils","mstrmojo.vi.enums.EnumVisFilterType","mstrmojo.EnumRWUnitType","mstrmojo.models.FormatModel","mstrmojo.models.template.DataInterface","mstrmojo.warehouse.EnumObjectTypes","mstrmojo.mstr.EnumDSSXMLObjectSubTypes");var M=mstrmojo.expr,Q=M.FN,U=M.ET,Y=mstrmojo.hash,u=mstrmojo.array,AA=mstrmojo.vi.models.EnumDragSources,AM=mstrmojo.fe.FilterUtils.getExprXml,C=mstrmojo.fe.FilterUtils.isExprEmpty,AF=mstrmojo.vi.ui.DatasetUnitMenuUtils,o=mstrmojo.array,a=mstrmojo.string,AN=mstrmojo.models.FormatModel,O=AN.ENUM_PROPERTY_NAMES,AB=mstrmojo.vi.enums.EnumVisFilterType,X=mstrmojo.EnumRWUnitType,AL=mstrmojo.models.template.DataInterface,AS=AL.ENUM_GRID_RESIZE.FIT_TO_CONTENTS,I=mstrmojo.warehouse.EnumObjectTypes,z=mstrmojo.mstr.EnumDSSXMLObjectSubTypes,k=mstrmojo.vi.enums.EnumFeatures,m=mstrmojo.elementHelper;var L=4,j=12,AC="-1";var B=3;var d=[O.GRID_VERTICAL_PADDING,O.GRID_HORIZONTAL_PADDING],r={},g="tp",R="lp";r[O.GRID_VERTICAL_PADDING]=g;r[O.GRID_HORIZONTAL_PADDING]=R;function K(AT){return AT.docModel.controller.cmdMgr;}function w(AW,AY){var AZ=AW.xtab.k,AV=AW.docModel,AU=AV.getSelectedViUnit(),AT=AU&&AU.boxContent,AX=!(AT&&AT.isInFilterPanel&&AT.isInFilterPanel());return[AZ].concat(AX?AV.getSourceFilterKeys(AZ,true):[]);}function f(AW,AU,AV,AX,AT){AU.reverse().forEach(function(AY){AX.push(AW.model.getClearThresholdAction(AV,AT,AY.tid));});}mstrmojo.vi.models.DocXtabModel=mstrmojo.declare(mstrmojo.DocXtabModel,[mstrmojo.vi.ui._CanDropFromSchema],{scriptClass:"mstrmojo.vi.models.DocXtabModel",getUnHiddenDrillPathsForCell:function AH(AT,AX){var AV=this.getAllDrillPathsForCell(AT,AX),AW=this.docModel.datasets,AU=function(AY,Ab){var AZ=o.find(AY,"did",Ab.id),Aa=AY[AZ];if(Aa&&!Aa.hide){Ab.n=Aa.n;return true;}return false;};return o.filter(AV,function(Aa){var AY;for(AY in AW){var AZ=AW[AY];if(AU(AZ.att,Aa)){return true;}}return false;});},getAllDrillWithinPathsForCell:function p(AT,AW,AV){var AU=AV?this.getUnHiddenDrillPathsForCell(AT,AW):this.getAllDrillPathsForCell(AT,AW);return AU.filter(function(AX){return !!AX.within;});},sort:function AO(AV,AW){var AT=this;K(this).execute({execute:function AU(){var AX=AT.xtab.k;this.submit(AT.docModel.getDataService().getUpdateTemplateAction(AX,{act:"sort",sorts:AV.sorts,nodeKey:AX,subTotalsPos:AV.stp||AT.getSubTotalsPos(),stt:AV.stt||-1}),AW);}});},customSort:function AP(AW,AX,AT){var AU=this,AW=Y.clone(AW);K(this).execute({execute:function AV(){var AY=AU.xtab.k;this.submit(AU.docModel.getDataService().getUpdateTemplateAction(AY,AW),AX,AT);}});},drillGrid:function t(AV,AW){var AT=this;K(this).execute({execute:function AU(){this.submit(AT.docModel.getDataService().getDrillGridAction(AV),AW);}});},getClearThresholdAction:function F(AV,AT,AU){return{act:"clearThreshold",unitId:AV,unitType:AT,tid:AU};},getCreateSimpleThresholdAction:function W(AY,AW,AT,AX,AV,AU){return{act:"threshold",nodeKey:AW,thresholds:AY,thresholdType:AX,basedOnId:AV||AT,did:AT,objType:AU};},getZoneFormatAction:function N(Ae,Ag,Ab,AX){var AZ=AX&&AX.skipSubtotals,AV=AX&&AX.isSubtotalFormat,Ad=AX&&AX.isSubtotalUseGridFormatting,Ac=[],AW=[],Aa="h",AT="g",Af="sh",AY="sg",AU=function(Ah,Ai){AW.push({axis:Ah,regions:Ai});};if(AV){if(Ae==="ch"){AU(2,[Af]);}else{if(Ae==="rh"){AU(1,[Af]);}else{if(Ae==="va"){AU(1,[AY]);AU(2,[AY]);}}}}else{if(Ae==="ch"){AU(1,[Aa]);AU(2,!AZ&&Ad?[Aa,AT,Af]:[Aa,AT]);}else{if(Ae==="rh"){AU(1,!AZ&&Ad?[AT,Af]:[AT]);}else{if(Ae==="va"){this.data.gsi.mx.forEach(function(Ah){Ac.push({unitId:Ah.did,unitType:4,regions:[AT]});});if(!AZ&&Ad){AU(1,[AY]);AU(2,[AY]);}}}}}return{act:"formatGridZone",nodeKey:Ab,props:Ag,units:Ac,axis:AW};},getApplyGridCellFormatToSubtotalAction:function S(AV){var AU={},AW,AZ=this.xtab,AY=AZ.gridInfo.fmts,AX=AY[AV];var AT;Y.forEach(AX,function(Ab,Aa){AT=AN.getFormatPropertyInfo(Aa);if(AT&&AT.ps!==AN.ENUM_PROPERTY_SETS.FORMATTING_NUMBER){AU=Y.mergeHashes(AU,AN.getFormatUpdate(Aa,(AT.pt==B)?Ab:AN.decodeValue(Aa,Ab)));}});AW=AZ.model.getZoneFormatAction.call(AZ.model,AV,AU,AZ.k,{isSubtotalFormat:true});return AW;},getSelectorDataFromTemplateLimit:function P(AT){return this.getSelectorDataFromViewFilter(AT);},getSelectorDataFromViewFilter:function AE(AW){var AT=[],AX="The expression is not supported by the View Filter Exception Parser.",AU=function AU(Aa){if(m.isNullElem(Aa.id)&&a.isEmpty(Aa.v)){throw AX;}},AZ=function AZ(Ac){var Aa=null;if([U.AE,U.ANDOR].indexOf(Ac.et)>-1||(Ac.et===U.AQ&&Ac.fn===Q.IS_NULL)){if(!Ac){return true;}var Ab=Ac.nds;Aa=!(Ac.not||Ac.fn===Q.NOT||Ac.fn===Q.NOT_IN_LIST);if(Ab){Ab.every(function(Ad){Aa=Aa&&AZ(Ad);});}}else{throw AX;}return Aa;},AV=function AV(Ac,Ae,Ag){var Ai=Ac&&Ac.nds,Ab=Ac.fn===Q.OR;Ag=Ag||Ae;if(Ai&&Ai.length){var Ad=Ae;Ai.forEach(function(Aj){if(Ab){Ad=[];}AV(Aj,Ad,Ag);if(Ab&&Ad.length>0){Ae.push(Ad);}});}else{if(Ac.fn===Q.IS_NULL){var Ah=Ac.a=Ac.a||{n:"Null Attribute",did:""};Ae.push({tn:Ah.n,tid:Ah.did,eid:null,v:""});}else{if(Ac.et===U.AE){var Aa=Ac.es||[];var Af=Aa.length;if(Af===1){AU(Aa[0]);Ae.push({tn:Ac.a.n,tid:Ac.a.did,eid:Aa[0].v,v:Aa[0].n});}else{if(Ag){Aa.forEach(function(Aj){AU(Aj);Ag.push([{tn:Ac.a.n,tid:Ac.a.did,eid:Aj.v,v:Aj.n}]);});}}}}}return Ae;};try{if(AW){(AW.nds||[]).forEach(function(Aa){var Ab=AV(Aa,[]);if(Ab.length>0){AT.push({keepOnly:AZ(Aa),data:Ab});}});}}catch(AY){if(AY!==AX){console.error("vi.models.DocXtabModel: Encountered a problem parsing the view filter expression ("+AY+")");}else{return[];}}return AT;},getRemoveMetricLimitsAction:function AK(AT){var AV=[],AW=[],AU=function AU(AY,AZ){if(!AY){return ;}var AX=AY.nds;if(AX){AX.forEach(function(Ab){var Aa=Ab.m;if(Aa!==undefined){AZ.push(Aa.did);}else{AU(Ab,AZ);}});}};if(AT){AU(AT,AV);AV.forEach(function(AX){AW.push({act:"removeMetricLimits",unitId:AX});});}return AW;},getAddTemplateUnitAction:function E(AX,AY,AV,AT){var AW=this._super(AX,AY,AV,AT),AU=w(this,AW);if(AU.length>0){AW.partialRetrieval={nodes:AU};}return AW;},getRemoveTemplateUnitAction:function AJ(AV){var AU=this._super(AV),AT=w(this,AU);if(AV.axis!==undefined&&AV.unitPos!==undefined){AU.axis=AV.axis;AU.unitPos=AV.unitPos;}if(AT.length>0){AU.partialRetrieval={nodes:AT};}return AU;},getAdvancedPropertiesAction:function W(AT){return{act:"advancedProperties",props:AT};},canShowCellMenu:function AD(AT){return true;},isSubtotalValue:function D(AT){var AU=this.getCellDataUnion(AT);return !AT.stt&&AU.some(function(AV){return !!AV.isSubtotal;});},getKeepOnlyActionsForAssociatedNodes:function AG(AU,Aa,AW){var AT=this.docModel,AZ=[AT.getKeepOnlyOrExcludeAction(this.xtab.k,AU)],AV=!!AW?AW:this.xtab,AY=!mstrApp.isInVFConfigMode?(AV.getAssociatedNodes&&AV.getAssociatedNodes()||[]):[];Aa=mstrmojo.func.wrapMethods(Aa,{success:function AX(){o.forEach(AY,function(Ac){var Ab=AT.getPanel().getUnitByKey(Ac.k);if(Ab&&Ab.boxContent){Ab.boxContent.raiseEvent({name:"regenerateToolbar"});}});}});o.forEach(AY,function(Ab){AZ.push(AT.getKeepOnlyOrExcludeAction(Ab.k,AU));});return{actions:AZ,callback:Aa};},getSaveViewFilterAction:function V(AU,AT){return{act:"saveViewFilter",nodeKey:(AU&&AU.k)||this.xtab.k,expr:C(AT)?'<exp><nd et="14" fn="19"></nd></exp>':AM(AT)};},getClearLinkingAction:function x(AT){var AW=[],AZ=this.docModel,Ab=AT.k,AX=AZ.getCurrentLayoutKey(),Aa=(AZ.defn.layouts).filter(function(Ad){return Ad.k===AX;})[0],AY=Aa.cgbMap||{},AV=Aa.units||{},Ac,AU=Y.keyarray(AY).filter(function(Ad){if(AY[Ad]===Ab){Ac=AV[Ad];return Ac&&Ac.isNavigation;}return false;});o.forEach(AU,function(Ad){AW.push({act:"clearUCNodeCondition",nodeKey:Ad});});return AW;},getClearFiltersForVisActions:function n(Af,Ae,AW,Ad){var Ag=this.docModel,Ac=Ag.getDataService(),AU=Af.model,AX=Af.gridData||Af.model.data||Af.node.data,AT=AX.vfexpr,AZ=AX.vlexpr,AY=(Ae&&Ae.k)||this.xtab.k,Ab={actions:[],callback:Ad};AW=[].concat(AW);if(AW.indexOf(AB.KEEP_ONLY)>-1){Ab=AU.getKeepOnlyActionsForAssociatedNodes([],Ab.callback,Ae);}if(AW.indexOf(AB.ADV_QUALIFICATION)>-1){if(AZ){Ab.actions.push(Ac.getUpdateTemplateAction(Af.k,AU.getRemoveMetricLimitsAction(AZ)));}if(AT){var AV=AW.indexOf(AB.DRILLING);if(AV>-1){Ab.actions.push(AU.getSaveViewFilterAction(Ae));AW.splice(AV,1);}else{Ab.actions.push(AU.getSaveViewFilterAction(Ae,Ag.getVfexprWithUpdatedVf(AY)));}}}if(AW.indexOf(AB.DRILLING)>-1){var Aa=Ag.getVfNdFromExpr(AT)||{et:14,nds:[]};Ab.actions.push(AU.getSaveViewFilterAction(Ae,Aa));}if(AW.indexOf(AB.LINKING)>-1){Ab.actions=Ab.actions.concat(AU.getClearLinkingAction(Af));Ab.extras={style:{params:{treesToRender:3}}};}return Ab;},getObjectInfo:function H(AT){var AV=this.xtab.zonesModel,AU=null;if(AV){(AV.getDropZones().zones||[]).some(function(AW){return !!AW.items.some(function(AX){if(AX.did===AT){AU=AX;return true;}});});}else{AU=this._super(AT);}return AU;},getObjectInfoFromDataset:function H(AT){var AU;Y.forEach(this.docModel.datasets,function(AV){if(!AU){AU=(AV.mx.concat(AV.att)).filter(function(AW){return AW.did===AT;})[0];}});return AU;},hasDerivedElements:function A(AT){var AU=this.getObjectInfo(AT);return !!(AU&&AU.de);},isRecursiveAttribute:function v(AT){var AV=this.docModel.getDEObject(AT),AU=this.getObjectInfoFromDataset(AV?AV.attId:AT);return AU&&AU.t===12&&AU.st===3076;},getNDEFormsFromDataset:function G(AU){var AT=this.getObjectInfoFromDataset(AU);return AT&&AT.fs;},hasRecursiveAttribute:function AI(AT){var AU=this,AV=(AT||this.data).gsi||{};return(AV.rows||[]).concat(AV.cols||[]).some(function(AW){return AU.isRecursiveAttribute(AW.did);});},hasSameRecursiveAttributeGroup:function q(AX,AV,AU){var AT=this.docModel,AZ=AX.did,AW=AT.getDEObject(AZ),AY=(AV||this.data).gsi||{};if(this.isRecursiveAttribute(AZ)){return o.filterOne((AY.rows||[]).concat(AY.cols||[]),function(Ac){var Aa=Ac.did,Ab=AT.getDEObject(Aa);return o.find(o.ensureArray(AU),"did",Aa)<0&&(Aa!==AZ)&&(AW?AW.attId:AZ)===(Ab?Ab.attId:Aa);});}return false;},supportsViewFilterActions:function b(AT){var AU=this.getObjectInfo(AT);return AU&&!AU.de&&(AU.t!==1)&&(AU.t!==47||AU.st===12033);},addEditNodeForDatasetAction:function c(AU,AT){this.augmentDropContextForSchema(AU,this.docModel);var AX=AU.getCtxtDragData(),AW=AX.src;if(AW===AA.DATASETS||AW===AA.ALL_OBJECT_LIST){var AV=AU.getCtxtDragData().dsid,AY=AU.actions||[];if(AV){AY.push({act:"editNode",nodeKey:AT,datasetId:AV});}AU.actions=AY;}},getCurrentUnitAxisAndPosition:function AQ(AT){return new mstrmojo.models.template.DataInterface(this.data).getUnitById(AT)||null;},getNumberFormatEditorCfg:function l(AU){var AY=this,AT=AY.xtab,AW=AY.data,AV=(AW.gnf||[]).concat(AW.gnfu),Ac=AU.item,Ab=o.find(AV,"id",Ac.did),AZ=Ab===-1?{}:AV[Ab],AX=AT&&(!AT.defn.vis||!AT.defn.vis.ve);var Aa=AF.getNumberFormatEditor(AU.item,AZ,function(Ah){var Af=AY.docModel.getNumberFormatAction(Ac.did,Ac.t,Ah),Ae=!!Af.partialRetrieval,Ag,Ad;if(Ae){Ag=mstrmojo.DocDataService.REQUEST_DEFN_DATA;Ad={treesToRender:3};}AT.controller.submitUndoRedoTemplateUpdates(AT,Af,AY.docModel.controller._getXtabCallback(AT,undefined,Ae),Ag,Ad);});return Aa;},showNumberFormat:function(Ab){var Ac=[1,2,8,9,11],AZ;if(Ab.t===12){var AU=this.xtab.node.data,AT=AU&&AU.gts,AV=new mstrmojo.models.template.DataInterface(AU),AY=AT&&(AV.getRowTitles().titles||[]).concat(AV.getColTitles().titles||[]),Aa=o.filterOne(AY,function(Ad){return Ab.did===Ad.id;}),AX=((Aa&&Aa.fs)||[]).map(function(Ad){return Ad.id;});AZ=(Ab.fs||[]).some(function(Ad){return Ac.indexOf(Ad.bftp)!==-1&&AX.indexOf(Ad.fid||Ad.id)!==-1;});}var AW=mstrApp&&mstrApp.supportFeature&&mstrApp.supportFeature(k.NUMBER_FORMATTING);return(Ab.t===4&&Ab.did!==AC&&AW)||AZ;},openThresholdEditor:function(Ah,AX,Ad){var AW=this,AU=AW.xtab,Af=AW.docModel,Ac=AW.data,Ae=Ac.gsi,Ab=Ah.did,AT=mstrmojo.desc(3647,"Thresholds");if(Ah.t===L||Ah.t===j){var Aa=Y.clone(Ae.mx),AZ;Aa.forEach(function(Ai){Ai.t=4;});AZ=Ae.rows.concat(Ae.cols,Aa).filter(function(Ak){var Ai=Ak.t,Al=Ak.st,Aj=Ak.did;return !((Ai===1&&Al===257)||(Ai===47&&Al===12032)||(AW.hasDerivedElements(Aj))||(Aj==="-1")||(Ai===14));});AZ.forEach(function(Ak){if(Ak.t===12){var Aj=this.getObjectInfo(Ak.did);Ak.da=Aj?Aj.da:undefined;}else{if(Ak.t===47&&Ak.st===12033){var Aj=this.getObjectInfo(Ak.did);Ak.ndetype=Aj.ndetype;}else{if(Ak.t===4){var Ai=this.getObjectInfoFromDataset(Ak.did);Ak.dt=Ai&&Ai.dt;}}}},this);if(Ab!==AC){AT+=" - "+Ah.n;}var AY=mstrmojo.threshold.ThresholdModel.FEATURES,Ag=new mstrmojo.threshold.ThresholdController({metricId:Ab,objectType:Ah.t,title:AT,data:Ac,targets:AZ,messageId:Af.mid,datasets:Af.datasets,dataService:Af.getDataService(),supportsFeature:function AV(Ak){switch(Ak){case AY.SHOW_ADVANCED_EDITOR:return !AX;case AY.SHOW_BASED_ON:return !AX;case AY.SHOW_IMAGE:return Ad;case AY.SHOW_VALUE_ITEM:var Aj=AW.getObjectInfoFromDataset(this.model.basedOnId),Al=Aj&&Aj.dt,Ai=[8,9,10,14,15,16,30];return !Al||Ai.indexOf(Al)===-1;}},onSubmitActions:function(Aq,Ak,Aj,Al,Ao,Ap,Ai){var An=this,Am=[];if(Ak){f(AU,Ak,Aj,Am,Ai);}Am.push(AW.getCreateSimpleThresholdAction(Aq,AU.k,Aj,Ao,Al,Ai));AU.controller.submitUndoRedoTemplateUpdates(AU,Am,{success:function(){if(Ap){An.set("data",AW.data);An.openEditor();Ap=false;}}});},onSaveThresholds:function(Ak,Ai,Aj,Am,Al){this.dataService.saveThresholds(Y.copy(Am,{thresholds:JSON.stringify(Ak),basedOnId:Ai,thresholdType:Aj}),Al,{hideFailureErr:true});},onLoadThresholds:function(Aj,Ak){var Ai=this.model;this.dataService.getThresholds({thresholdsID:Ak},{success:function(Aq){var Ap=Aq.thresholds,Am=[],Al,Ar,Ao={};o.forEach(Ap||[],function(As){Al=M.findTargets(As.expr,"did");Ar=true;Y.forEach(Al,function(At,Au){if(!AW.getObjectInfo(Au)){Ao[Au]=At.n;Ar=false;}});if(Ar){Am.push(As);}});if(!Y.isEmpty(Ao)){var An=Y.valarray(Ao);mstrmojo.alert(mstrmojo.desc(15431,"The following objects: # are not on the visualization, so some thresholds will not be loaded...").replace("#",An.join(",")));}Ai.addThresholds(Am);}});}});if(Ah.t===j){Ag.model.editorMode=mstrmojo.threshold.ThresholdModel.EDITOR_TYPES.ADVANCED_EDITOR;}Ag.openEditor();}},buildThresholdMenuOptions:function e(AY,AU,AX,Ae){var AW=this,AT=AW.xtab,Ad=AW.data,Af=Ad.gsi,AV=Af.thresholds,Ag=AU.item,Ac=Ag.did,Ab=AV&&AV[Ac],AZ=mstrmojo.desc(13261,"Clear Thresholds"),Aa=AT.excludeData;if((!Aa&&Ag.t===L)||Ag.t===j&&!AW.docModel.isOldDEObject(Ac)){AY.addMenuItem(mstrmojo.desc(6050,"Thresholds..."),"",function(){AW.openThresholdEditor(Ag,AX,Ae);},this);if(Ac!==AC){if(Ab){AY.addMenuItem(AZ,"",function(){var Ah=[];f(AT,Ab,Ac,Ah,Ag.t);AT.controller.submitUndoRedoTemplateUpdates(AT,Ah);},this);}}}},moveSubTotals:function Z(AT,AU){var AV=this;K(this).execute({execute:function AW(){var AY=AV.xtab,AX=AY.k;this.submit(AV.docModel.getDataService().getUpdateTemplateAction(AX,AV.getMoveSubTotalAction(AT.data,AU,AX)),AY.controller._getXtabCallback(AY));}});},getAttributeFormsInTemplate:function(AV){var AT=this.data.gts,AU=[];(AT.row||[]).concat(AT.col||[]).forEach(function(AW){if(AW.id===AV&&AW.fs){AU=AU.concat(AW.fs);}});return AU;},getPivotFormAction:function(Ad,AU,AZ){var AV=this.getCellTitleInfo(Ad),Aa=AV.title,AW=Aa.fs,AX=Aa.id,AY=this.getAttributeFormsInTemplate(AX),Ac=(Aa.fix&&Aa.fix-1)||(Ad.fi||0),AT=AY[Ac],Ab;if(AU==="l"){Ab=Ac-1;}else{if(AU==="r"){Ab=Ac+1;}}return{act:"pivot",unitPos:Ab+1,attFormId:AT.id,unitId:AX,unitType:AZ||"",originUnitPos:Ac+1};},getValuesDefaultFormatGridZoneAction:function(Aa,AX){var AV={},Ah,Af=this.xtab,AY=Af&&Af.gridInfo,AU=AY&&AY.fmts,AZ=[],Ae,AW={};Y.forEach(Aa,function(Ai){AZ.push({unitId:Ai.did,unitType:L,regions:["g"]});});if(AU){var Ab=AU.va,Ad=AU.rh,AT=AU.ch;Y.forEach(AU.va,function(Aj,Ai){Ae=AN.getFormatPropertyInfo(Ai);if(Ae&&Ae.ps!==AN.ENUM_PROPERTY_SETS.FORMATTING_NUMBER){AV=Y.mergeHashes(AV,AN.getFormatUpdate(Ai,(Ae.pt==B)?Aj:AN.decodeValue(Ai,Aj)));}});var Ag=Ab[g]?Ab:(Ad[g]?Ad:AT),Ac;u.forEach(d,function(Ai){Ae=AN.getFormatPropertyInfo(Ai);if(Ae){Ac=Ag[r[Ai]];AV=Y.mergeHashes(AV,AN.getFormatUpdate(Ai,AN.decodeValue(Ai,Ac)));}});}AW.skipSubtotals=AX;Ah=Af.model.getZoneFormatAction.call(Af.model,"va",AV,Af.k,AW);Ah.units=[].concat(AZ);return Ah;},getRAExpandAction:function J(AU,AZ,AW){var AY=this.getCellTitleInfo(AU).title.id,AX=this.docModel.getDEObject(AY),AT={act:"raExpandCollapse",sliceId:AZ,depth:AU.dpt,ordinal:(AU.o!==undefined)?AU.o:AU._ei,id:AU._e&&AU._e.id,isExpand:AW?1:(AU.epd?0:1)},AV=w(this);if(AW){AT.expand_dsts=1;}AT[AX?"deId":"attId"]=AY;if(AV.length>0){AT.partialRetrieval={nodes:AV};}return AT;},getRAExpandAllAction:function AR(AX,AW){var AV=this.docModel.getDEObject(AX),AT={act:"raExpandCollapseAll",isExpandAll:AW?1:0},AU=w(this);AT[AV?"deId":"attId"]=AX;if(AU.length>0){AT.partialRetrieval={nodes:AU};}return AT;},getCreateCSVizActions:function h(AU,AV,Al,AT){var Ab=[],Aa=[],Ai=this.docModel,Af=Ai.getDataService(),Ac=Ai.getVizContentPanel(),AZ=Ac.k,Ap=this.xtab,AY=Ap.k,AX=Ap.parent;Ab.push({act:"macroCopyUnit",newKey:Al,unitType:X.GRID,unitKey:AY,toKey:AZ,partialRetrieval:{nodes:[Al]}});var Aj=Ai.clearVisAsFilterAction(AX),Ag=Aj&&Aj.actions;u.forEach(Ag,function(Aq){if(!Aq.controlKey){Aq.nodeKey=Al;Ab.push(Aq);}});var Ae=AX.parent.children,Ad,AW=Ap.getFilterType()===1;u.forEach(Ae,function(As){if(u.find(As.defn&&As.defn.an,"k",AY)!==-1){Ab.push({act:"associateNodes",nodeKey:As.k,targetKeys:[Al]});var Ar=As.boxContent.selectorControl;if(Ar){var Aq=At===undefined||AW,At=Aq?Ai.getNextKey():At;Ab.push({act:"addVisToFilter",parentKey:AY,targetKey:Al,ctrlKey:Ar.ckey,newCGB:Aq,cgbKey:At});}}});u.forEach(Ae,function(Ar){var Aq=Ar.defn,As=(Aq&&Aq.tks||"").split("\u001E");u.forEach(As,function(At){if(At===AY){var Aw=Aq.ck,Av=Aq.srct,Au=Aq.srcst,Ax=(Av===I.Consolidation&&Au!==z.ConsolidationManaged)||Av===I.Filter;Ab.push(Af.getAddCtrlTargetAction(Aw,Al,Al,Ax));}});});var Ak=this.data,Am=Ak.gsi,An=this,Ah=function(Aq,Ar){u.forEach(Aq,function(At,As){if(At.did==="-1"){u.forEach(Am.mx,function(Ax,Av){var Aw=Y.copy(Ax);Aw.axis=-1;Aw.unitPos=Av+1;Aa.push(An.getRemoveTemplateUnitAction(Aw));});}else{if(At.did!==AU.id){var Au=Y.copy(At);Au.axis=Ar;Au.unitPos=As+1;Aa.push(An.getRemoveTemplateUnitAction(Au));}}});};Ah(Am.rows,1);Ah(Am.cols,2);if(AV===2){Aa.push(this.getPivotUnitAction(1,0,AU.id,12,2,0));}Aa.push({act:"advancedProperties",props:{"Template Formatting":{ShowColumnHeaders:"-1",LockColumnHeaders:"-1"}}});var Ao=new AL(Ak);if(Ao.getColResizeScenario()!==AS){Aa.push({act:"changeXtabColWidthScenario",value:AS});}if(AT){Aa=Aa.concat(AT);}u.forEach(Aa,function(Aq){delete Aq.partialRetrieval;});Ab.push(Af.getUpdateTemplateAction(Al,Aa));return Ab;},getUnitNameInDataSet:function(AT){return this.docModel.findUnitNameInDataSetFromUnit(AT);}});}());(function(){mstrmojo.requiresCls("mstrmojo.array","mstrmojo.hash","mstrmojo.func","mstrmojo.vi.models.DocXtabModel","mstrmojo.EnumRWUnitType");var C=mstrmojo.array,B=mstrmojo.hash;var F="Metrics",D=2,H="\u001E",E="\u001F";mstrmojo.vi.models.DocVisModel=mstrmojo.declare(mstrmojo.vi.models.DocXtabModel,null,{scriptClass:"mstrmojo.vi.models.DocVisModel",getHMSelecAttrElemIdsInfo:function(R){var Q=R[0],L=Q.tid,N=Q.tids,M=Q.selections,K={},S=[],P=this.scm,O=(L&&P&&P[L]);C.forEach(M,function(V){var U=(V&&V.length)||0,W=U>0?V[U-1]:{},X=W.tid;if(P[X]){if(!K[X]){K[X]=[];}K[X].push(W.eid);}});B.forEach(K,function(U){S.push(U.join(H));});if(O&&O.showall&&S.length===0){C.forEach(N,function(U){S.push("OA:(All)");K[U]=[];});}return{eids:S.join(E),tids:Object.keys(K)};},getSelectedAttributeElementIdStr:function(S){var R=S[0],K=R.tid,L,M=R.selections,N=[],P=[];C.forEach(M||[],function(U){N=N.concat(C.filter(U,function(V){return V.tid===K;}));});N=C.distinct(N,"eid");(N||[]).forEach(function(U){P.push(U.eid);});L=P.join(H);var Q=this.scm,O=(K&&Q[K]);if(O&&O.showall&&P.length===0){L="OA:(All)";}return L;},getHMAction:function A(Z){var Y=Z[0],N=Y&&Y.at,R=Y.anchor,M=Y.selections,W=this.scm,K=[],O=[],Q=[],a=[],S,U,X,L,V,P;V=this.getHMSelecAttrElemIdsInfo(Z);L=V.eids;if(M.length!==0&&L===""){return null;}if(N&&((N&D)>0)&&W){C.forEach(V.tids,function(c){var b=W[c];if(b){K.push(b);O.push(b.ck);Q.push(b.ckey);a.push(b.tks);}});S=O.join(E);U=Q.join(E);X=a.join(H);if(K.length&&L!==""){P={h:"onGridSelector",a:{type:mstrmojo.EnumRWUnitType.GRID,anchor:R,ck:S,tks:X,eid:L,ctlKey:U,sliceId:this.xtab.sid,isUConDS:K[0].isUConDS,isDocVis:true}};}}return P;},getDrillWithinActionsForAssociatedNodes:function G(K,L,Q,R){var O=this,U=this.docModel,M=[U.getDataService().getDrillGridAction(this.getDrillAction(this.xtab.k,L,K))],S=!!R?R:this.xtab,N=!mstrApp.isInVFConfigMode?(S.getAssociatedNodes&&S.getAssociatedNodes()||[]):[];Q=mstrmojo.func.wrapMethods(Q,{success:function P(){C.forEach(N,function(W){var V=U.getPanel().getUnitByKey(W.k);if(V&&V.boxContent){V.boxContent.raiseEvent({name:"regenerateToolbar"});}});}});C.forEach(N,function(V){M.push(U.getDataService().getDrillGridAction(O.getDrillAction(V.k,L,K)));});return{actions:M,callback:Q};},getDrillAction:function I(L,N,K){function M(S){var R=[];for(var Q=0,O=S.length;Q<O;Q++){var V=S[Q];for(var P=0,W=V.length;P<W;P++){var U=V[P];if(mstrApp.useBinaryFormat){R.push(U.axis+"A"+(U.ui+1)+"A"+U.o);}else{R.push(U.axis+"A"+(U.ui+1)+"A"+U.o);}}}return(mstrApp.useBinaryFormat)?R:R.join(",");}return{srcMsgId:this.data.mid,sliceId:this.xtab.sid,nodeKey:L,retainParent:K.retainParent||"",isWithin:K.drillPath.within,drillPathKey:K.drillPath.k,drillPathIndex:K.drillPath.dpi,drillElements:M(N)};},getAction:function J(U){var S=U[0],N=S&&S.at,P=S.anchor,K=S.tid,L,O,M=S.selections;L=this.getSelectedAttributeElementIdStr(U);if(M.length!==0&&L===""){return null;}if(N&&((N&D)>0)){var R=this.scm;var Q=(K&&R[K])||R[F];if(Q&&L!==""){O={h:"onGridSelector",a:{type:mstrmojo.EnumRWUnitType.GRID,anchor:P,ck:Q.ck,tks:Q.tks,eid:L,ctlKey:Q.ckey,sliceId:this.xtab.sid,isUConDS:Q.isUConDS,isDocVis:true}};}}return O;}});}());(function(){mstrmojo.requiresCls("mstrmojo.array","mstrmojo.hash","mstrmojo.func","mstrmojo.VisUtility","mstrmojo.vi.viz.EnumDSSDropZones","mstrmojo.chart.model.enums.EnumDSSObjectType","mstrmojo.vi.models.DropZonesModel","mstrmojo.vi.models._DropZoneCommon","mstrmojo.vi.models.EnumDragSources","mstrmojo.vi.ui.DatasetUnitMenuUtils","mstrmojo.vi.util.ThresholdUtils");var N=mstrmojo.array,R=mstrmojo.hash,X=mstrmojo.func,C=mstrmojo.chart.model.enums.EnumDSSObjectType,F=mstrmojo.vi.models.DropZonesModel.ENUM_TARGET_POSITION,A=mstrmojo.vi.util.ThresholdUtils,W=mstrmojo.vi.ui.DatasetUnitMenuUtils,D=mstrmojo.vi.viz.EnumDSSDropZones,c=mstrmojo.vi.models.EnumDragSources,G=mstrmojo.vi.ui.DatasetUnitMenuUtils,Y=mstrmojo.VisUtility,O=D.Grouping,H=D.SizeBy,Q=D.ColorBy,b=D.AdditionalMetrics,E=mstrmojo.vi.enums.EnumFeatures,B=["#ec7b75","#f6db7f","#84c87b"];HEATMAP_THRESHOLD_BANDS=[0.35,0.65];mstrmojo.vi.models.HeatMapDropZones=mstrmojo.declare(mstrmojo.vi.models.DropZonesModel,[mstrmojo.vi.models._DropZoneCommon],{scriptClass:"mstrmojo.vi.models.HeatMapDropZones",help:"editor_panel_heat_map.htm",getHostModel:function K(){return this.getHost().model.data;},getDropZones:function S(){var e=this.getDZFlatStruct(),d=[this.getZone(mstrmojo.desc(2941,"Grouping"),O,e.Grp,false,{title:mstrmojo.desc(13828)}),this.getZone(mstrmojo.desc(11663,"Size By"),H,e.SizeBy,false,{allowSingle:true,title:mstrmojo.desc(13829)}),this.getZone(mstrmojo.desc(11662,"Color By"),Q,e.ColorBy,false,{title:mstrmojo.desc(11668)}),this.getZone(mstrmojo.desc(2962,"Tooltip"),b,e.AdditionalMetrics,false,{title:mstrmojo.desc(13827)})];this.dropZones=d;return{n:this.getHost().defn.ttl,zones:d};},getUnitMenuItems:function a(g,q,p,d){var u=this,w=this.id,e=this.isMetric(p),n=this.isAttribute(p),l=q.items,o=l.length,h={zone:q,idx:N.find(l,"id",p.id),cnt:o,item:p,useDropzone:true},j=(p.t===47&&p.st===12033),k=G.getDatasetFromAttributeId(this.docModel.datasets,p.did);if(j&&!mstrApp.isInVFConfigMode){g.addMenuItem(mstrmojo.desc(13296,"Edit Groups..."),"eg",this.getCreateOrEditElementGroupFunc(h));g.addSeparator();}this.addSortMenu(h,g,false);g.addSeparator();var f=mstrmojo.resolveFeature(E.INSERT_NEW_METRIC),m=this.docModel,v=mstrApp.isInVFConfigMode;if(e&&!v){var r=p.did;if(p.um){g.addMenuItem(mstrmojo.desc(3224,"Edit..."),"",function(){u.editDerivedMetric(h,"edit");},h);g.addSeparator();}if(f){if(m.findDatasetIdFromUnit(r)&&!m.isFromSolrCube(r)&&!m.isFromMDXCube(r)){g.addSubMenuItem(mstrmojo.desc(11806,"Aggregate By"),"",w,u.getAggregateByMetricSubMenu,h);g.addSeparator();}g.addEditorMenuItem(mstrmojo.desc(5188,"Calculation"),w,u.getCalculationEditorCfg,h);g.addMenuItem(mstrmojo.desc(13624,"Create Metric..."),"",function(){u.newDerivedMetric(h);},h);}}else{if(n&&!v){var t=this.isDynamicLink(p);if(!k||!this.docModel.isMDXDataset(k)){if(p.da){g.addMenuItem(mstrmojo.desc(3224,"Edit..."),"",function(){u.editDerivedAttribute(h);},h);g.addSeparator();}if(n&&(p.de!==true)&&this.allowInsertNewAttribute(q)&&!Y.isCGorCon(this.getHost(),p)&&!t&&f){g.addMenuItem(mstrmojo.desc(13625,"Create Attribute..."),"",function(){u.newDerivedAttribute(h);},h);}}if(!G.hasOldDEOverDatasets(p.did,this.docModel.datasets)&&!this.isRecursiveAttribute(p)&&!t){g.addMenuItem(mstrmojo.desc(13295,"Create Groups..."),"eg",this.getCreateOrEditElementGroupFunc(h));}}}g.addSeparator();if(this.showNumberFormat(p)){g.addEditorMenuItem(mstrmojo.desc(13237,"Number Format"),w,this.getNumberFormatEditorCfg,h);}if(e){if(q.id===Q){this.buildThresholdMenuOptions(g,h,true);}}if(this.shouldShowDisplayFormsMenu(p)){g.addEditorMenuItem(mstrmojo.desc(11908,"Display Attribute Forms"),this.id,function(){return u.getDisplayFormsMenu(p);});}g.addSeparator();if(u.hasReplaceCandidates(h)&&(!(mstrApp.isAppStatePresentation&&mstrApp.isAppStatePresentation())||!!mstrmojo.resolveFeature(E.WEB_DRILL_AND_LINK))){g.addSubMenuItem(mstrmojo.desc(14003,"Replace With"),"",w,u.getReplaceSubMenu,h);}g.addMenuItem(mstrmojo.desc(1388,"Rename"),"",function(){u.renameItem(d,p);});g.addMenuItem(mstrmojo.desc(190,"Remove"),"xt",function(){u.deleteItem(q,u.getUnitIndexInZone(q,p));});},getAvatarIconClass:function I(){return"viHeatMap";},getAllowDropInfo:function M(o,h,t,g,d){var f=this._super(o,h,t,g,d),m=f.allowedItems,q=this,u=g===F.ON,l,p=false,k=false,n=function(v,w){return N.filter(m,function(z){var x=q.isMetric(z);return v?x:!x;},w?{max:1}:null);};switch(o.id){case O:l=false;break;case Q:var e=!!n(false,true).length,j=!!n(true,true).length,r=this.isMetricZone(o.id);if(r){l=j;}else{l=!e;}p=l;k=r||l;break;case H:l=true;p=true;k=true;break;case b:l=true;m=m.filter(function(w){var v=[H,Q],x=d.src.data;if(x.src===c.VIZ_EDITOR){N.removeItem(v,x.srcZoneId);}return v.every(function(z){return q.getUnitIndexInZone(q.getZoneModelByZoneId(z),w)===-1;});});break;}return R.copy({allowedItems:(k&&!(o.items.length===0||u))?[]:n(l,p),removeReplaced:u&&(k||N.find(h,"did",o.items[t].did)===-1)},f);},unitsDropped:function Z(n,e,p,q,d){var k=e.src.data,h=e.actions||[],r=p.idx,f=p.edge,m=this.docModel,j=p.allowedItems,g=(f===F.ON&&p.removeReplaced)?n.items[r]:null,o=this,l=function(){var t=o.getAddItemActions(n,j,o.getDropTargetIndex(n,p),true,g,k.dsid),v=h.concat(o.getUpdateTemplateAction(t)),u=function(w){return function(){var x=w?m.wrapUnsetVisualizationFilterAction(v):v;o.submitDropZoneUpdates(x,X.wrapMethods(e.callback,o.getHost().model.docModel.controller._getXtabCallback(o.getHost())));};};m.checkAndNotifyVFChangeOnDZUnitsUpdate({actions:v,zm:o},u(true),u(false));};if(n.id===O||(!o.isMetric(j[0])&&n.id===Q)){o.checkAndWarnLargeItemsForAddUnits(j,l);return ;}l();},getAddItemActions:function V(n,m,r,k,f,j){var l=n.id,t=this.isMetric(m[0]),o=this,g={datasetId:j},h=[],q=false,e=function(v){var x=o.getZoneModelByZoneId(v),u=x.items.length,w=m.filter(function(z){return t?(k&&u===0):(o.getUnitIndexInZone(x,z)===-1);});if(w.length){N.insert(h,null,o.getAddDropZoneUnitsActions(x,w,t?0:u,g));return true;}},p=function(u){var v=o.getZoneModelByZoneId(u);m.forEach(function(w){if(o.getUnitIndexInZone(v,w)!==-1){h=h.concat(o.getRemoveDropZoneUnitActions(v,w,1));}});};switch(l){case O:var d=this.getZoneModelByZoneId(Q);if(d.items.length===0){N.insert(h,null,this.getAddDropZoneUnitsActions(d,m,0,g));}break;case H:p(b);break;case Q:if(t||this.isMetricZone(l)){n.items.forEach(function(u){h=h.concat(o.getRemoveDropZoneUnitActions(n,u));});r=0;f=null;}if(t){p(b);q=true;}else{e(O);}break;case b:p(H);p(Q);break;}if(f){h=h.concat(this.getRemoveDropZoneUnitActions(n,f));}N.insert(h,null,this.getAddDropZoneUnitsActions(n,m,r,g));if(q){this.checkAndAddThresholdAction(Q,m[0],h);}return h;},checkAndAddThresholdAction:function U(g,e,f){var d=this.getHost();if(g===Q&&this.isMetric(e)){A.addThresholds(d.model,d,d.node,e,f,B,HEATMAP_THRESHOLD_BANDS,false);return true;}return false;},deleteItem:function P(e,d){var g=this,f=g.docModel,h=this.getRemoveDropZoneUnitActions(e,e.items[d]);f&&f.checkAndNotifyVFChangeOnDZUnitsUpdate({ca:[e.id],zm:g},function(){g.submitDropZoneTemplateUpdates(h,{actions:f.wrapUnsetVisualizationFilterAction()});},function(){g.submitDropZoneTemplateUpdates(h);});},deleteItems:function P(d,e){var g=this,f=g.docModel,h=[];N.forEach(e,function(j){h=h.concat(g.getRemoveDropZoneUnitActions(d,j));});f&&f.checkAndNotifyVFChangeOnDZUnitsUpdate({ca:[d.id],zm:g},function(){g.submitDropZoneTemplateUpdates(h,{actions:f.wrapUnsetVisualizationFilterAction()});},function(){g.submitDropZoneTemplateUpdates(h);});},getHighlightTargets:function L(f,e){if(f.id===Q&&f.items.length&&e.item.t!==f.items[e.idx].t){var d=[];f.items.forEach(function(h,g){d.push({idx:g,edge:e.edge});},this);return d;}return this._super(f,e);},getReplaceCandidates:function J(e,f){var g=this._super(e,f);if(e.id===Q){var d=this._super(e,{t:f.t===4?12:4});g=g.concat(d);}return W.getSortedDatasetUnits(g);}});}());(function(){mstrmojo.requiresCls("mstrmojo.array","mstrmojo.hash","mstrmojo.func","mstrmojo.VisUtility","mstrmojo.kpicard.KPICardEnum","mstrmojo.mstr.EnumDSSXMLObjectTypes","mstrmojo.vi.viz.EnumDSSDropZones","mstrmojo.vi.models.DropZonesModel","mstrmojo.vi.models._DropZoneCommon","mstrmojo.vi.ui.DatasetUnitMenuUtils","mstrmojo.vi.util.ThresholdUtils","mstrmojo.models.datasets.DataInterface");var b=mstrmojo,c=b.array,O=b.hash,m=mstrmojo.func,P=mstrmojo.kpicard.KPI_PROPERTIES,d=mstrmojo.kpicard.DISPLAY_MODE,e=b.vi.viz.EnumDSSDropZones,k=mstrmojo.vi.ui.DatasetUnitMenuUtils,U=mstrmojo.VisUtility,Q=b.mstr.EnumDSSXMLObjectTypes,G=b.vi.models.DropZonesModel.ENUM_TARGET_POSITION,V=mstrmojo.vi.enums.EnumFeatures,B=e.BreakBy,E=e.Trend,Y=e.Metric,q=mstrmojo.kpicard.CARDLIMIT,X=mstrmojo.models.datasets.DataInterface,I=1,K=-1;mstrmojo.vi.models.KPICardDropZones=mstrmojo.declare(mstrmojo.vi.models.DropZonesModel,[mstrmojo.vi.models._DropZoneCommon],{scriptClass:"mstrmojo.vi.models.KPICardDropZones",help:"editor_panel_kpi.htm",propertyChanged:false,getHostModel:function A(){return this.getHost().model.data;},getDropZones:function g(){var v=this.getDZFlatStruct(),u=function(w){return{allowSingle:true,title:w};},t=[this.getZone(mstrmojo.desc(517,"Metric"),Y,v.metric,false,u(mstrmojo.desc(13829,"Drag a metric here"))),this.getZone(mstrmojo.desc(12173,"Break By"),B,v.BreakBy,false,u(mstrmojo.desc(13833,"Drag an attribute here"))),this.getZone(mstrmojo.desc(15863,"Trend"),E,v.trend,false,u(mstrmojo.desc(13833,"Drag an attribute here")))];this.dropZones=t;return{n:this.getHost().defn.ttl,zones:t};},getAllowDropInfo:function C(z,x,AB,v,t){var AA=this,u=this._super(z,x,AB,v,t),AC=z.items.length!==0&&v!==G.ON,w=AC?null:c.filterOne(u.allowedItems,function(AE){var AD=AA.isMetric(AE);return Y===z.id?AD:(!AD&&AE.t!==Q.Dimension);});return O.copy({allowedItems:w?[w]:[]},u);},unitsDropped:function n(AE,t,AG){var x=t.actions||[],v=[],AB,AA=t.src.data,AI=AG.idx,u=AG.edge,z=AG.allowedItems,AH,AF=this,w,AC=AF.getHost().getFormatPropertyValue(P.DISPLAY_MODE),AD=AE.id===B;if(u===G.ON&&AG.removeReplaced){v=v.concat(this.getRemoveDropZoneUnitActions(AE,AE.items[AI]));}v=v.concat(this.getAddDropZoneUnitsActions(AE,z,this.getDropTargetIndex(AE,AG),{datasetId:AA.dsid}));AB=x.concat(AF.getUpdateTemplateAction(v));AH=function(AJ){return function(){var AK=AJ?AF.docModel.wrapUnsetVisualizationFilterAction(AB):AB;AF.submitDropZoneUpdates(AK,m.wrapMethods(t.callback,AF.getHost().model.docModel.controller._getXtabCallback(AF.getHost())),undefined,AD);};};if(AE.id===B&&AC===d.STACKED){w=q;}else{w=undefined;}this.checkAndWarnLargeItemsForAddUnits(z,function(){AF.docModel.checkAndNotifyVFChangeOnDZUnitsUpdate({actions:AB,zm:AF},AH(true),AH(false));},undefined,undefined,undefined,undefined,w);},checkBreakByLimit:function(v,u){var t=this;this.checkAndWarnLargeItemsForAddUnits(t.dropZones[1].items,v,undefined,undefined,undefined,true,q,u);},getAddItemActions:function o(AB,AA,AD,z,u,x){var w=[],AC=this,v={datasetId:x},t=function(AE,AG,AF){c.insert(w,null,AC.getAddDropZoneUnitsActions(AE,[AG],0,AF));};t(AB,AA[0],v);return w;},clearGridModeSettings:function p(u){if(u.id===E){return ;}var v=this.getHost(),t=v.getFormatPropertyValue(P.DISPLAY_MODE);if(v&&t&&t===d.GRID){v.updateProperties(P.GRID_COLUMN_COUNT);v.updateProperties(P.FIX_CARD_HEIGHT);v.updateProperties(P.CARD_HEIGHT);this.propertyChanged=true;}},getAddDropZoneUnitsActions:function r(u,v,t,w){this.clearGridModeSettings(u);return this._super(u,v,t,w);},getRemoveDropZoneUnitActions:function D(t,v){var w=this._super(t,v),u=this.getHost();if(t.id===E){u.updateProperties(P.PREVIOUS_METRIC_NAME);this.propertyChanged=true;}this.clearGridModeSettings(t);return w;},deleteItem:function F(v,t){var x=this,w=x.docModel,z=this.getRemoveDropZoneUnitActions(v,v.items[t]),u=z.length?[this.getUpdateTemplateAction(z)]:[];w&&w.checkAndNotifyVFChangeOnDZUnitsUpdate({ca:[v.id],zm:x},function(){x.submitDropZoneUpdates(u.concat(w.wrapUnsetVisualizationFilterAction()));},function(){x.submitDropZoneUpdates(u);});},submitDropZoneUpdates:function h(u,AA,t,x){var AC=this.getHost(),AB=this.docModel,v=AC.model,w=v.xtab.k,z=AC.getSortRows();if(this.propertyChanged){u=u.concat(AC.getSetPropertiesAction());this.propertyChanged=false;}if(z&&z.length>0&&x){u=u.concat(AB.getDataService().getUpdateTemplateAction(w,{act:"clearSort"}));}this._super(u,AA,t);},generateSortKeyByItem:function J(v,z){var AA=this.handleSortItem(v),x=AA.t,w=AA.did,t=this.getUnitInfoInTemplate(w),u=z||(t.unit.fid||(t.unit.fs&&t.unit.fs[0].id));return this.generateSortKey(x,w,u);},generateSortKey:function S(v,u,t){return[v,u,t,"21"].join("!");},handleSortItem:function W(v){var u=this.getHost(),w=u.model.data,t=w.gts,x=O.copy(v);if(v.t===Q.DssTypeDimension){c.forEach((t.row||[]).concat(t.col||[]),function(z){if(z.hid===x.did){x.did=z.id;x.t=z.otp;return false;}});}return x;},getAppliedSortInfo:function R(v,t){var x=this.resolveDropZoneItem(v),u=null,w=this,AB,AA,z;if(!x){return u;}AB=this.handleSortItem(x);AA=AB.t;z=AB.did;c.forEach(t,function(AE){var AC=AE&&AE.key,AD;if(AC){AD=AC.split("!");if(AD[0]===AA.toString()&&AD[1]===z){u={key:w.generateSortKey(AA,z,AD[2]),isAsc:AE.isAsc};}}});return u;},generateSortInfo:function M(u,v,t){return{key:this.generateSortKeyByItem(u,v),isAsc:t};},resolveDropZoneItem:function N(u){var v=this.getZoneModelByZoneId(u),t=v&&v.items;return t&&t[0];},handleKPISort:function H(w,x){var AB=this.getHost(),z=AB.getSortRows(),AC,v,t,AA=[],u=[];if(w.sortIdx===0){AA.push(this.generateSortInfo(w,null,x));t=this.getAppliedSortInfo(E,z);if(t){AA.push(t);}}else{if(w.sortIdx===1){AC=this.getAppliedSortInfo(B,z);if(AC){AA.push(AC);}else{v=this.resolveDropZoneItem(B);if(v){AA.push(this.generateSortInfo(v,null,true));}}AA.push(this.generateSortInfo(w,w.sortForm,x));}}u.push(AA);u.push(null);this.docModel.controller.onAdvancedSort(AB,u,null,null);},getTrendSortSubMenu:function j(v,AA){var z=this,AD=v.item,x=this.handleSortItem(AD),w,t=[],AC=[];w=X.getFormsByAttrId(AD.attId||AD.did,this.docModel.datasets);c.forEach(w||[],function(AE){var AF=AE.fid;if(c.find(t,"id",AF)<0){t.push({id:AF,n:AE.fnm,sortItem:x,isAsc:AA});}});AC.push({scriptClass:"mstrmojo.ui.ScrollableContainer",alias:"scrollableContainer",children:[{scriptClass:"mstrmojo.vi.ui.InteractiveUnitList",draggable:false,CLS_HAS_MENU:"",items:t,listHooks:{select:function AB(AE,AF){var AG=AF.sortItem;if(AG){AG.sortIdx=1;AG.sortForm=AF.id;z.handleKPISort(AG,AF.isAsc);}if(this.parent&&this.parent.parent&&this.parent.parent.closeAllMenus){this.parent.parent.closeAllMenus();}}}}]});return new mstrmojo.ui.menus.EditorConfig({data:{},cssClass:"replaceReference",okVisible:false,cancelVisible:false,contents:AC,onOpen:function u(){this.scrollableContainer.updateScrollbars();}});},getTrendSortAscendingSubMenu:function L(t){return this.getTrendSortSubMenu(t,true);},getTrendSortDescendingSubMenu:function Z(t){return this.getTrendSortSubMenu(t,false);},addTrendSortMenu:function l(t,w){var AB=this.getHost(),AA=AB.getSortRows(),AC=t.item,u=t.axis,v=AB.model.data,z=v.gsi.tma,x=this;if(AC.t===Q.DssTypeFilter){return ;}if(u!==K||z!==I){w.addPopupMenuItem(mstrmojo.desc(7974,"Sort Ascending"),this.id,this.getTrendSortAscendingSubMenu,"",t);w.addPopupMenuItem(mstrmojo.desc(7975,"Sort Descending"),this.id,this.getTrendSortDescendingSubMenu,"",t);if(AA&&AA.length>0){w.addMenuItem(mstrmojo.desc(11699,"Clear Sort"),"",function(){x.submitDropZoneTemplateUpdates([{act:"clearSort"}]);});}}},addBreakBySortMenu:function a(t,w){var AC=this.getHost(),AB=AC.getSortRows(),AD=t.item,u=t.axis,v=AC.model.data,AA=v.gsi.tma,z,x=this;if(AD.t===Q.DssTypeFilter){return ;}if(u!==K||AA!==I){z=this.handleSortItem(AD);z.sortIdx=0;w.addMenuItem(mstrmojo.desc(7974,"Sort Ascending"),"xt",function(){x.handleKPISort(z,true);});w.addMenuItem(mstrmojo.desc(7975,"Sort Descending"),"xt",function(){x.handleKPISort(z,false);});if(AB&&AB.length>0){w.addMenuItem(mstrmojo.desc(11699,"Clear Sort"),"",function(){x.submitDropZoneTemplateUpdates([{act:"clearSort"}]);});}}},getUnitMenuItems:function f(w,AG,AF,t){var AJ=this,AL=this.id,u=this.isMetric(AF),AD=this.isAttribute(AF),AB=AG.items,AE=AB.length,x={zone:AG,idx:c.find(AB,"id",AF.id),cnt:AE,item:AF,useDropzone:true},z=(AF.t===47&&AF.st===12033),AC=this.docModel,AH=AF.did,AA=k.getDatasetFromAttributeId(AC.datasets,AH),AK=mstrApp.isInVFConfigMode,v=mstrmojo.resolveFeature(V.INSERT_NEW_METRIC);if(z&&!AK){w.addMenuItem(mstrmojo.desc(13296,"Edit Groups..."),"eg",this.getCreateOrEditElementGroupFunc(x));w.addSeparator();}if(AG.id===B){this.addBreakBySortMenu(x,w);w.addSeparator();}if(AG.id===E){this.addTrendSortMenu(x,w);w.addSeparator();}if(u&&!AK){if(AF.um){w.addMenuItem(mstrmojo.desc(3224,"Edit..."),"",function(){AJ.editDerivedMetric(x,"edit");},x);w.addSeparator();}if(v){if(AC.findDatasetIdFromUnit(AH)&&!AC.isFromSolrCube(AH)&&!AC.isFromMDXCube(AH)){w.addSubMenuItem(mstrmojo.desc(11806,"Aggregate By"),"",AL,AJ.getAggregateByMetricSubMenu,x);w.addSeparator();}w.addEditorMenuItem(mstrmojo.desc(5188,"Calculation"),AL,AJ.getCalculationEditorCfg,x);w.addMenuItem(mstrmojo.desc(13624,"Create Metric..."),"",function(){AJ.newDerivedMetric(x);},x);}}else{if(AD&&!AK){var AI=this.isDynamicLink(AF);if(!AA||!AC.isMDXDataset(AA)){if(AF.da){w.addMenuItem(mstrmojo.desc(3224,"Edit..."),"",function(){AJ.editDerivedAttribute(x);},x);w.addSeparator();}if(AD&&(AF.de!==true)&&!U.isCGorCon(this.getHost(),AF)&&!this.isDynamicLink(AF)&&v){w.addMenuItem(mstrmojo.desc(13625,"Create Attribute..."),"",function(){AJ.newDerivedAttribute(x,!AJ.allowInsertNewAttribute(AG));},x);}}if(!k.hasOldDEOverDatasets(AH,AC.datasets)&&!this.isRecursiveAttribute(AF)&&!AI){w.addMenuItem(mstrmojo.desc(13295,"Create Groups..."),"eg",this.getCreateOrEditElementGroupFunc(x));}}}w.addSeparator();if(this.showNumberFormat(AF)){w.addEditorMenuItem(mstrmojo.desc(13237,"Number Format"),AL,this.getNumberFormatEditorCfg,x);}if(this.shouldShowDisplayFormsMenu(AF)){w.addEditorMenuItem(mstrmojo.desc(11908,"Display Attribute Forms"),this.id,function(){return AJ.getDisplayFormsMenu(AF);});}w.addSeparator();if(AJ.hasReplaceCandidates(x)&&(!(mstrApp.isAppStatePresentation&&mstrApp.isAppStatePresentation())||!!mstrmojo.resolveFeature(V.WEB_DRILL_AND_LINK))){w.addSubMenuItem(mstrmojo.desc(14003,"Replace With"),"",AL,AJ.getReplaceSubMenu,x);}w.addMenuItem(mstrmojo.desc(1388,"Rename"),"",function(){AJ.renameItem(t,AF);});w.addMenuItem(mstrmojo.desc(190,"Remove"),"xt",function(){AJ.deleteItem(AG,AJ.getUnitIndexInZone(AG,AF));});}});}());(function(){mstrmojo.requiresCls("mstrmojo.array","mstrmojo.hash","mstrmojo.func","mstrmojo.gm.GMEnums","mstrmojo.gm.GMUtility","mstrmojo.vi.viz.EnumDSSDropZones","mstrmojo.vi.util.ThresholdUtils","mstrmojo.vi.viz.EnumVisualizationTemplates");mstrmojo.requiresClsP("mstrmojo.vi.ui","SubtotalsWidget","DatasetUnitMenuUtils");mstrmojo.requiresClsP("mstrmojo.vi.models","DropZonesModel","EnumDragSources","_DropZoneCommon");mstrmojo.requiresDescs(101,122,144,190,1018,2453,2968,3582,7974,7975,7976,7978,7979,11099,11699,12143,12144,12145,12146,12147);var q=mstrmojo,r=q.array,R=q.hash,AN=q.func,AK=mstrmojo.gm,H=AK.GMUtility,AT=AK.EnumABLDirection,Z=mstrmojo.vi.models.DropZonesModel.ENUM_TARGET_POSITION,W=mstrmojo.vi.models.EnumDragSources,Y=mstrmojo.vi.viz.EnumDSSDropZones,M=mstrmojo.vi.util.ThresholdUtils,AE=mstrmojo.vi.ui.DatasetUnitMenuUtils,AQ=3,n=AK.WidgetPropertyTag,j=mstrmojo.vi.enums.EnumFeatures,D=q.vi.viz,L=D.EnumVizStyles,k=L.NEW_GRAPH_MATRIX,z=AK.EnumShape,O=Y.Rows,AI=Y.Columns,AA=Y.XAxis,a=Y.YAxis,I=Y.BreakBy,e=Y.SliceBy,m=Y.ColorBy,U=Y.SizeBy,K=Y.AdditionalMetrics,w=Y.Angle,c=1,P=AK.DualAxisSubAxisBit,X="00000000000000000000000000000000",d=0,AJ={n:"Metric Names",did:X,t:d},h=3,g=-20;function f(AU){return(AU===O||AU===AI||AU===a||AU===AA||AU===I||AU===e);}function C(AU){return AU===a||AU===AA;}function Q(AV,AW){var AX=[];function AU(AY){return !!(AY[0]===g&&AY[1]===g);}r.forEach(AV,function(AY){if(AY[0]===AW){AY[0]=g;}if(AY[1]===AW){AY[1]=g;}if(!AU(AY)){AX.push(AY);}});return AX;}function AM(AV,AZ,AY){var AW=false,AX=[g,g],AU=AY?0:1;r.forEach(AV,function(Aa){if(!AW&&Aa[AU]===g){AW=true;Aa[AU]=AZ;}});if(AW){return AV;}AX[AU]=AZ;AV.push(AX);return AV;}function F(AY,AX,Ah,Ag){var Ac=AY.tgtData,Aa=Ac.edge,AV=Ac&&Ac.tgtInfo,Aj=AV&&(parseInt(AV.axisIndex,10)+(Aa===Z.BELOW?1:0)),Ab=Ag?0:1,AW=Aa===Z.ABOVE||Aa===Z.BELOW,Ai,AU,AZ,Ae,Af,Ad;for(Af=0;Af<AX.length;Af++){Ae=AX[Af];for(Ad=0;Ad<Ae.length;Ad++){if(Ae[Ad]===Ah){if(Ae[1-Ad]===g&&(Aj!==Af||AW)){AX.splice(Af,1);if(Af<Aj){Aj--;}}else{Ae[Ad]=g;}}}}if(Aj>AX.length){Aj=AX.length;}if(Aa===AQ&&Aj<AX.length&&AX[Aj][Ab]===g){AX[Aj][Ab]=Ah;}else{if(Aa===Z.ON){AX[Aj][Ab]=Ah;}else{Ai=AX.slice(0,Aj);AU=AX.slice(Aj);AZ=[g,g];AZ[Ab]=Ah;AX=Ai.concat([AZ],AU);}}return AX;}mstrmojo.vi.models.XtabDropZonesMenuContextType=null;function l(){return mstrmojo.all[this.hostId];}function AH(){var AU=l.call(this);return AU.getHostStructure();}function b(AU){return AN.wrapMethods(AU.controller._getXtabCallback(AU),{success:function(){AU.resetXMLDirtyFlag();}});}function AG(){var Ah=l.call(this),Ad=this.getZoneModelByZoneId(O),AZ=this.getZoneModelByZoneId(AI),AW=this.getZoneModelByZoneId(a),AY=this.getZoneModelByZoneId(AA),AX=[],AU=Ah.GMController.getChartInfo(),AV=[],Ag=[],Ae=Ah.getChartStyle()==="NewGraphMatrixVisualizationStyle";if(AU.isBubbleOrScatter){AV=Ah.copyTrendLineInfoForSwap(AW,AY);}if(AU.isABL){Ag=Ah.copyRefLineInfoForSwap();}AX=AX.concat(this.getSwapDZUnitActions(Ad,AZ,Ae));AX=AX.concat(this.getSwapDZUnitActions(AW,AY,Ae));var Af=this.docModel.getDataService(),Ab=Ah.k,Ac=b(Ah),Aa=[Af.getUpdateTemplateAction(Ab,AX)].concat(AV).concat(Ag);if(Ah.isXMLDirty()){Aa.push(Ah.getPersistAction());}Ah.controller.submitUndoRedoUpdates(Aa,null,Ac);}function AF(AU,AZ){var AW,AX=this,AY=[],AV=[];AW=this.getZoneModelByZoneId(AU);r.forEach(AW.items,function(Aa){if(Aa.t===12){AV.push(Aa);Array.prototype.push.apply(AY,AX.getRemoveDropZoneUnitActions(AW,Aa,AZ));}});return{actions:AY,removedItems:AV};}function AB(AU,AX){var AW=[],AZ=this,AV=this.getZoneModelByZoneId(AU),AY=this.getItemCountInZone(AU);r.forEach(AX,function(Aa){AW.push(AZ.getAddDropZoneUnitAction(AV,Aa,AY++));});return{actions:AW};}function AD(AU,AZ){var AX=[],AY=this,AV=this.getZoneModelByZoneId(AU),AW=AV.items;r.forEach(AZ,function(Ab){var Aa=r.find(AW,"did",Ab.did);if(Aa!==-1&&f(Ab.zone)){AX.push(AY.getAddDropZoneUnitAction(AV,Ab,Aa));}});return{actions:AX};}function AP(AU,AV){var AW=AU.id;if((AW===AA||AW===a)&&this.isMetric(AV)){return true;}return false;}function AO(AU,AX,AW){var AZ="0",AV=AX.item,AY=AX.idx;if(AW){AZ="1";}return function(){var Ae=this.getAddDropZoneUnitAction(AU,AV,AY,{isPrimary:AV.ax===0});Ae.condense=AZ;var Ad=l.call(this),Ah=Ad.id,Ag=Ad.getDocModel().getDataService(),Aa=Ad.k,Ab=Ag.getUpdateTemplateAction(Aa,Ae);var Ac=function(Am){var Ak=q.all[Ah],Al=Ak.model.data,Ai=Al.dz,Aj=[Ai.AngleBy,Ai.Rows,Ai.YAxis,Ai.Columns,Ai.XAxis,Ai.ColorBy,Ai.SizeBy,Ai.AdditionalMetrics],An=Ak.parent.getZonesModel&&Ak.parent.getZonesModel().getUpdateCallback();r.forEach(Aj,function(Ao){if(Ao&&Ao.TemplateMetric){r.forEach(Ao.TemplateMetric,function(Ap){if(Ap.id===AV.id){Ap.cds=Am;return false;}});}});Ak.clientRerenderGraphMatrix();if(An&&An.success){An.success();}};var Af={undo:function(){Ac(!AW);},redo:function(){Ac(AW);}};Ac(AW);Ad.submitUpdatesAndPersistXML([Ab],undefined,Af,true);};}mstrmojo.vi.models.GMDropZones=mstrmojo.declare(mstrmojo.vi.models.DropZonesModel,[mstrmojo.vi.models._DropZoneCommon],{scriptClass:"mstrmojo.vi.models.GMDropZones",dropZones:[],getHostStructure:function AH(){var AU=l.call(this);return AU.getHostStructure();},isZonesEmptyAfterDelItem:function V(AV){var AW={},AX=this.getHostStructure(),AU=AV.zone;AW[O]=AX.Rows.length;AW[AI]=AX.Columns.length;AW[AA]=AX.XAxis.length;AW[a]=AX.YAxis.length;AW[U]=AX.SizeBy.length;AW[I]=AX.BreakBy.length;AW[w]=AX.AngleBy.length;AW[K]=this.getItemCountInZone(K);AW[AU]--;if(AW[O]>0||AW[AI]>0||AW[AA]>0||AW[a]>0||AW[U]>0||AW[w]>0||AW[K]>0){return false;}return true;},getAutoSubtypeControl:function(AW){var Ad,AZ,Ac,AY,Ab;var Aa=mstrmojo.gm.EnumSubtype,AV=mstrmojo.gm.WidgetPropertyTag.SUB_TYPE,AU=l.call(this),AX=AU.GMController.chartSubType,Ae=AU.readGlobalProperty(AV);AZ={scriptClass:"mstrmojo.ui.Checkbox",enabled:!AW,alias:"AutoSubType",checked:Ae===Aa.AUTO,oncheckedChange:function(Af){if(Af.value){AU.writeGlobalProperty(AV,Aa.AUTO);}else{AU.writeGlobalProperty(AV,AX);}}};Ac={scriptClass:"mstrmojo.Label",text:mstrmojo.desc(12135,"Automatic subtype"),setDimensions:function(Ah,Af){var Ag=this.domNode;if(Ag){Ag.style.width=Af;}}};AZ.slot="col1Node";Ac.slot="col2Node";Ad={scriptClass:"mstrmojo.ui.editors.controls.TwoColumnContainer",col1Width:AY||"20%",col2Width:Ab||"80%",children:[AZ,Ac]};return Ad;},getSubtypeButtonBar:function B(AY,AV,Ac){var AX=[null,{id:12143,desc:"Automatic",css:"automatic"},{id:12144,desc:"Absolute",css:"clustered"},{id:12145,desc:"Stacked",css:"stacked"},{id:12146,desc:"Clustered",css:"clustered"},{id:12147,desc:"Percent",css:"percent"}],Af=mstrmojo.gm.EnumSubtype,Ab=mstrmojo.gm.WidgetPropertyTag.SUB_TYPE,Aa=l.call(this),Ah=Aa.GMController.chartSubType,AW=Aa.getChartInfo();function Ag(Ak){var Ai=[],Aj;if(Ak.shape===z.BAR){Aj=[Af.CLUSTERED,Af.STACKED,Af.PERCENT];}else{Aj=[Af.ABSOLUTE,Af.STACKED,Af.PERCENT];}if(!Ak.isCombo){Aj.forEach(function(Al){var Am=AX[Al];Ai.push({n:Am?mstrmojo.desc(Am.id,Am.desc):null,id:Al,css:Am?Am.css:null});});}else{Aj.forEach(function(Al){var Am=AX[Al],An=AX[Af.ABSOLUTE];Ai.push({n:(Al===Af.CLUSTERED)?mstrmojo.desc(An.id,An.desc):(Am?mstrmojo.desc(Am.id,Am.desc):null),id:Al,css:Am?Am.css:null});});}return Ai;}function AU(Ak){var Aj=-1,Ai=0;Ak.forEach(function(Al){if(Al.id===Ah){Aj=Ai;}Ai++;});return Aj;}function AZ(Aj,Ai){if(Ai!==Aj&&(Ai===Af.PERCENT||Aj===Af.PERCENT)){Aa.abandonCustomAxisScale();Aa.resetAxisOrigin();}Aa.writeGlobalProperty(Ab,Aj);}var Ae={scriptClass:"mstrmojo.ui.ButtonBar",cssClass:"mstrmojo-chart-brkby-subtype",n:"Subtype",selectedIndex:-1,enabled:!Ac,showIcon:true,alias:"SubtypeBB",useRichTooltip:true,updateTooltipConfig:function Ad(Ak){var An=mstrmojo.dom,Am=Ak.target||An.eventTarget(Ak.hWin,Ak.e),Al=this.getItemFromTarget(Am),Ao=this.getItemNodeFromTarget(Am),Ai=An.position(Ao),Aj=8;if(Al){this.richTooltip={posType:mstrmojo.tooltip.POS_TOPCENTER,content:Al.n,top:Ai.y+Ai.h+Aj,left:Ai.x+Ai.w/2,cssClass:"vi-regular vi-tooltip-A A-center"};}},postselectionChange:function(Ai){AZ(Ai.src.items[Ai.added[0]].id,Ai.src.items[Ai.removed[0]].id);}};Ae.items=Ag(AW);Ae.selectedIndex=AU(Ae.items,Ah);return Ae;},getDropZones:function(){var AU=AH.call(this),AY=l.call(this),Ab=AY.GMController,Aa=Ab.isPie,Ac=Ab.isHistogram,AV=Ab.isBoxPlot,AX=Ab.isWaterfall,AZ=[this.getZone(mstrmojo.desc(14294,"Angle"),w,AU.AngleBy),this.getZone(mstrmojo.desc(6188,"Slice"),e,AU.SliceBy),this.getZone(mstrmojo.desc(2968,"Rows"),O,AU.Rows),this.getZone(mstrmojo.desc(122,"Columns"),AI,AU.Columns),this.getZone(mstrmojo.desc(12086,"XAxis"),AA,AU.XAxis),this.getZone(mstrmojo.desc(12088,"YAxis"),a,AU.YAxis),this.getZone(mstrmojo.desc(11662,"Color By"),m,AU.ColorBy)];var AW=this.getZone(mstrmojo.desc(12173,"Break By"),I,AU.BreakBy);if(AY.getChartInfo().isABL&&AW.items.length>0&&!(AY.getChartStyle()===k)){AW.siblings=[this.getSubtypeButtonBar("Subtype",[],false)];}AZ.push(AW);AZ.push(this.getZone(mstrmojo.desc(12090,"Size By"),U,AU.SizeBy));AZ.push(this.getZone(mstrmojo.desc(2962,"Tooltip"),K,AU.AdditionalMetrics));if(!Aa){AZ=AZ.slice(2);}else{AZ.splice(1,0,AZ.splice(6,1)[0]);}if(Ac){AZ=[this.getZone(mstrmojo.desc(517,"Metric"),a,AU.YAxis),this.getZone(mstrmojo.desc(11806,"Aggregate By"),AA,AU.XAxis),this.getZone(mstrmojo.desc(2962,"Tooltip"),K,AU.AdditionalMetrics)];}else{if(AV){AZ=[this.getZone(mstrmojo.desc(2968,"Rows"),O,AU.Rows),this.getZone(mstrmojo.desc(122,"Columns"),AI,AU.Columns),this.getZone(mstrmojo.desc(12086,"XAxis"),AA,AU.XAxis),this.getZone(mstrmojo.desc(12088,"YAxis"),a,AU.YAxis),AW,this.getZone(mstrmojo.desc(11662,"Color By"),m,AU.ColorBy),this.getZone(mstrmojo.desc(2962,"Tooltip"),K,AU.AdditionalMetrics)];}else{if(AX){AZ=[this.getZone(mstrmojo.desc(2968,"Rows"),O,AU.Rows),this.getZone(mstrmojo.desc(122,"Columns"),AI,AU.Columns),this.getZone(mstrmojo.desc(12086,"XAxis"),AA,AU.XAxis),this.getZone(mstrmojo.desc(12088,"YAxis"),a,AU.YAxis),AW,this.getZone(mstrmojo.desc(2962,"Tooltip"),K,AU.AdditionalMetrics)];}}}this.dropZones=AZ;return{n:l.call(this).defn.ttl,zones:AZ};},updateMetricNameUnit:function(){var AW,AY,AZ,Ab=l.call(this),AU=R.clone(AJ),Aa=this.shouldShowMetricNames(),Ac=this.hGetItemOccurrence(AU),AX=Ac.length,AV=[];if(Aa&&AX===0){AZ=this.getZoneModelByZoneId(O);AU.zone=O;AV.push(this.getAddDropZoneUnitAction(AZ,AU,AZ.items.length));AZ.items.push(AU);}if(!Aa&&AX>0){for(AW=0;AW<AX;AW++){AZ=this.getZoneModelByZoneId(Ac[AW].zoneId);AY=Ac[AW].itemIndex;AV=AV.concat(this.getRemoveDropZoneUnitActions(AZ,AZ.items[AY]));AZ.items.splice(AY,1);}}if(AV.length>0){this.submitUpdatesAndPersistWidgetXMLIfNecessary(Ab,AV,mstrmojo.emptyFn);}},shouldShowMetricNames:function(){var AV=this;if(AV.getMetricCntInZone(AA)>c){return true;}if(AV.getMetricCntInZone(a)>c){return true;}var AU=AV.getZoneModelByZoneId(w)!==undefined;if(AU&&AV.getMetricCntInZone(w)>c){return true;}return false;},hHasMetricInZone:function(AU){var AX,AV=false,AW=this.getZoneModelByZoneId(AU).items,AY=AW.length;for(AX=0;AX<AY;AX++){if(AW[AX].t===4){AV=true;break;}}return AV;},hHasAttributeInZone:function(AU){var AX,AV=false,AW=this.getZoneModelByZoneId(AU).items,AY=AW.length;for(AX=0;AX<AY;AX++){if(AW[AX].t===12){AV=true;break;}}return AV;},getAttributesZone:function(){var AU=AA;if(this.hHasMetricInZone(AA)){AU=a;}return AU;},canSwapAxis:function AC(){return true;},swapAxis:function A(){var AU=l.call(this);AU.clearChartScale();AU.clearContainerFit();AG.call(this);},shouldShowCondensedMenu:function(AU,AV){return AP.call(this,AU,AV);},getCondenseLableHandler:function(AU,AW,AV){return AO(AU,AW,AV);},getUnitMenuItems:function t(Ab,Ar,Aq,AV){if(!Aq){throw new Error(this.scriptClass+"::getUnitMenuItems: Item must be provided.");}var Au=this,Al=mstrmojo.all[this.hostId].zonesModel.id,AU=l.call(this),Ak=AU,As=AU.GMController,Ag=As.getChartInfo(),Aj=Ar.items,An=Aj.length,AW=Ar.id,Ac={zone:Ar,axis:AW,idx:r.find(Aj,"id",Aq.id),cnt:An,item:Aq,metricsAxis:AH.call(this).tma,useDropzone:true},AY;function Am(Aw,Ax){if(Ax.axis===O||Ax.axis===AI){}}if(this.isMetricName(Aq)){if(Ar.id===m){Ab.addMenuItem(mstrmojo.desc(190,"Remove"),"xt",function(){mstrmojo.all[Al].deleteItem(Ar,Ac.idx);});return ;}return ;}var AX=As.attributeSelectionInfo;if(this.isNewDerivedElement(Aq)){if(!mstrApp.isInVFConfigMode){Ab.addMenuItem(mstrmojo.desc(13296,"Edit Groups..."),"eg",this.getCreateOrEditElementGroupFunc(Ac));}if((AW===O||AW===AI||AW===AA||AW===a)&&Ak.getChartStyle()!=="NewGraphMatrixVisualizationStyle"){Ab.addSeparator();AY=AX&&AX[Aq.id];Ab.addMenuItem(mstrmojo.desc(7974,"Sort Ascending"),"xt",AU.getMenuHandler("sortAttributeTitle"),{isAsc:true,selInfo:AY});Ab.addMenuItem(mstrmojo.desc(7975,"Sort Descending"),"xt",AU.getMenuHandler("sortAttributeTitle"),{isAsc:false,selInfo:AY});if(As.firstRes.gsi.sorts[0].length!==0||As.firstRes.gsi.sorts[1].length!==0){Ab.addMenuItem(mstrmojo.desc(11699,"Clear Sort"),"xt",AU.getMenuHandler("clearSort"));}Ab.addSeparator();}}else{if(this.isConsolidation(Aq)){if(AW===O||AW===AI||AW===AA||AW===a){Ab.addSeparator();AY=AX&&AX[Aq.id];Ab.addMenuItem(mstrmojo.desc(7974,"Sort Ascending"),"xt",AU.getMenuHandler("sortAttributeTitle"),{isAsc:true,selInfo:AY});Ab.addMenuItem(mstrmojo.desc(7975,"Sort Descending"),"xt",AU.getMenuHandler("sortAttributeTitle"),{isAsc:false,selInfo:AY});if(As.firstRes.gsi.sorts[0].length!==0||As.firstRes.gsi.sorts[1].length!==0){Ab.addMenuItem(mstrmojo.desc(11699,"Clear Sort"),"xt",AU.getMenuHandler("clearSort"));}Ab.addSeparator();}}else{if(this.isMetric(Aq)){if(Aq.um&&!mstrApp.isInVFConfigMode){Ab.addMenuItem(mstrmojo.desc(3224,"Edit..."),"",function(){Au.editDerivedMetric(Ac,"edit");},Ac);Ab.addSeparator();}if(As.supportSort()&&Ag.isABL&&(AW===a||AW===AA)&&Ak.getChartStyle()!=="NewGraphMatrixVisualizationStyle"&&!Ak.excludeData){var Ao=As.metricSelectionInfo;AY=Ao&&Ao[Aq.id];Ab.addMenuItem(mstrmojo.desc(7974,"Sort Ascending"),"xt",AU.getMenuHandler("sortMetricTitle"),{isAsc:true,selInfo:AY});Ab.addMenuItem(mstrmojo.desc(7975,"Sort Descending"),"xt",AU.getMenuHandler("sortMetricTitle"),{isAsc:false,selInfo:AY});Am(Ab,Ac);if(As.firstRes.gsi.sorts[1].length!==0||As.firstRes.gsi.sorts[0].length!==0){Ab.addMenuItem(mstrmojo.desc(11699,"Clear Sort"),"xt",AU.getMenuHandler("clearSort"));}}Ab.addSeparator();if(!mstrApp.isInVFConfigMode&&mstrmojo.resolveFeature(j.INSERT_NEW_METRIC)){if(this.docModel.findDatasetIdFromUnit(Aq.did)&&!this.docModel.isFromSolrCube(Aq.did)&&!this.docModel.isFromMDXCube(Aq.did)){Ab.addSubMenuItem(mstrmojo.desc(11806,"Aggregate By"),"",Al,Au.getAggregateByMetricSubMenu,Ac);Ab.addSeparator();}Ab.addEditorMenuItem(mstrmojo.desc(5188,"Calculation"),Al,Au.getCalculationEditorCfg,Ac);if(As.getChartInfo().isABL){Ab.addSubMenuItem(mstrmojo.desc(12287,"Shortcut Metric"),"",Al,Au.getShortcutMetricSubMenu,Ac);}Ab.addMenuItem(mstrmojo.desc(13624,"Create Metric..."),"",function(){Au.newDerivedMetric(Ac);},Ac);Ab.addSeparator();}if(AP.call(this,Ar,Aq)&&Ak.getChartStyle()!=="NewGraphMatrixVisualizationStyle"){var Ap=Aq.cds;var Ai=AO.call(this,Ar,Ac,true),Ah=AO.call(this,Ar,Ac,false);Ab.addToggleMenuItem(mstrmojo.desc(14324,"Condense Axis Labels"),"",Ai,Ah,this.id,Ap);}if(mstrApp&&mstrApp.supportFeature&&mstrApp.supportFeature(j.NUMBER_FORMATTING)){Ab.addEditorMenuItem(mstrmojo.desc(13237,"Number Format"),Al,this.getNumberFormatEditorCfg,Ac);}if(Ar.id===m){this.buildThresholdMenuOptions(Ab,Ac,true);}Ab.addSeparator();if(Ag.isABL&&(Ar.id===AA||Ar.id===a)&&!Ag.isPie&&Ak.getChartStyle()!=="NewGraphMatrixVisualizationStyle"){H.getSubMenu(Ak,Ab,Aq.id,Aq.idx);}Ab.addSeparator();if((AW===AA||AW===a)&&Ak.getChartStyle()!=="NewGraphMatrixVisualizationStyle"){if((Ag.isBubbleOrScatter&&AW===a)||Ag.isABL){if(H.isTrendLineAvailableForMetric(AU,Aq.idx)){Ab.addToggleMenuItem(mstrmojo.desc(12155,"Enable trendline for ##").replace("##",Aq.n),"xt",H.getTrendLineToggleHandler(AU,Aq.id,true),H.getTrendLineToggleHandler(AU,Aq.id,false),Al,H.getTrendLineToggleState(AU,Aq.id));if(H.getTrendLineToggleState(AU,Aq.id)){Ab.addMenuItem(mstrmojo.desc(12163,"Edit trendline..."),"xt",H.getEditTrendLineHandler(AU,Aq.id));}}}}var At=As.getMetricsOnXAxis().concat(As.getMetricsOnYAxis()),Aa=As.model&&As.model.getMetricIDsFromIndex(At),Av=false;if(Aq.id){if(Aa&&Aa.indexOf(Aq.id)>=0){Av=true;}}var AZ=false;if(As.isStacked&&!As.splitPlottingMetrics){AZ=true;}else{if(!Av){AZ=true;}}AZ=AZ||H.isIgnoredMetric(Ak,Aq.idx);if(!AZ){H.getReferenceLineSubMenu(Ak,Ab,Ag.isABL,Aq.id);}Ab.addSeparator();}else{if(this.isAttrCategory(Aq)){var Af=Aq.did||"",Ae=Af?AE.getDatasetFromAttributeId(this.docModel.datasets,Af):null,Ad=!Ae||!this.docModel.isMDXDataset(Ae);if(Aq.da&&Ad&&!mstrApp.isInVFConfigMode){Ab.addMenuItem(mstrmojo.desc(3224,"Edit..."),"",function(){Au.editDerivedAttribute(Ac);},Ac);Ab.addSeparator();}if((AW===O||AW===AI||AW===AA||AW===a)&&Ak.getChartStyle()!=="NewGraphMatrixVisualizationStyle"){AY=AX&&AX[Aq.id];Ab.addMenuItem(mstrmojo.desc(7974,"Sort Ascending"),"xt",AU.getMenuHandler("sortAttributeTitle"),{isAsc:true,selInfo:AY});Ab.addMenuItem(mstrmojo.desc(7975,"Sort Descending"),"xt",AU.getMenuHandler("sortAttributeTitle"),{isAsc:false,selInfo:AY});Am(Ab,Ac);if(As.firstRes.gsi.sorts[0].length!==0||As.firstRes.gsi.sorts[1].length!==0){Ab.addMenuItem(mstrmojo.desc(11699,"Clear Sort"),"xt",AU.getMenuHandler("clearSort"));}Ab.addSeparator();}if(!mstrApp.isInVFConfigMode&&!this.isDynamicLink(Aq)){if(this.allowInsertNewAttribute(Ar)&&((!Ae)||!AE.isCGorCon(Aq,Ae))&&Ad&&mstrmojo.resolveFeature(j.INSERT_NEW_METRIC)){Ab.addMenuItem(mstrmojo.desc(13625,"Create Attribute..."),"",function(){Au.newDerivedAttribute(Ac);},Ac);}if(!AE.hasOldDEOverDatasets(Aq.did,this.docModel.datasets)&&!this.isRecursiveAttribute(Aq)&&!this.isCustomGroup(Aq)){Ab.addMenuItem(mstrmojo.desc(13295,"Create Groups..."),"eg",this.getCreateOrEditElementGroupFunc(Ac));}Ab.addSeparator();}if(this.showNumberFormat(Aq)&&!(As.isHistogram||As.isBoxPlot||As.isWaterfall)){Ab.addEditorMenuItem(mstrmojo.desc(13237,"Number Format"),Al,this.getNumberFormatEditorCfg,Ac);}if(this.shouldShowDisplayFormsMenu(Aq)&&!As.isHistogram){Ab.addEditorMenuItem(mstrmojo.desc(11908,"Display Attribute Forms"),Al,function(){return Au.getDisplayFormsMenu(Aq);});}}}}}Ab.addSeparator();if(Au.hasReplaceCandidates(Ac)&&(!(mstrApp.isAppStatePresentation&&mstrApp.isAppStatePresentation())||!!mstrmojo.resolveFeature(j.WEB_DRILL_AND_LINK))){Ab.addSubMenuItem(mstrmojo.desc(14003,"Replace with"),"",Al,Au.getReplaceSubMenu,Ac);}Ab.addMenuItem(mstrmojo.desc(1388,"Rename"),"xt",function(){Au.renameItem(AV,Aq);});Ab.addMenuItem(mstrmojo.desc(190,"Remove"),"xt",function(){Au.deleteItem(Ar,Ac.idx);});},isGraphDroppingAllowed:function S(AY,AU,Ac){var AV=AY.id,AZ=true,Ab=l.call(this).GMController,AX=Ab.isBubbleOrScatter();var Aa=this.isMetric(Ac),AW=this.isMetricName(Ac);switch(AV){case O:case AI:if(Aa){AZ=false;}break;case AA:case a:if(!AX&&AW&&this.hHasMetricInZone(AV)){AZ=false;}break;default:break;}return AZ;},allowDropOnTarget:function G(AV,AW){var AU=true;if(AV===W.DATASETS&&this.isMetricName(AW.item)){AU&=(AW.srcZoneId===m);}return AU;},allowMoveMetricName:function J(AU,AV){if(this.isDualAxis(a)&&AU===AI&&AV===AA){return false;}else{if(this.isDualAxis(AA)&&AU===O&&AV===a){return false;}}return true;},isItemDropAllowed:function p(Aq,Af,Ak,AY,AZ){var Ac;if(AY&&AY.src){Ac=AY.src.data.src;}var Ae,Ah=Aq.id,Ad=this.getItemCountInZone(Ah),Al=l.call(this).scriptClass==="mstrmojo.ngm.VisNewGraphMatrix",AV=l.call(this).GMController,An=AV.getChartInfo().isABL,Am=AV.isHistogram,Ab=AV.isBoxPlot,AU=AV.isWaterfall,Ao=AV.isBubbleOrScatter(),AW=AV.isGrid()&&!AV.isEmptyVis(),AX=this.isMetric(Af),Ai=this.isAttrCategory(Af),Aj=this.isMetricName(Af);if(AZ===Z.BELOW||AZ===AQ){AZ=Z.ABOVE;Ak++;}if(AZ===Z.ON){Ae=Aq.items[Ak];if(this.isMetricName(Ae)&&Aq.id!==m){return false;}}if(Af===Aq.items[Ak]){return false;}switch(Ah){case O:case AI:if(AX){return false;}if(Aj&&(Ak<Ad||!this.allowMoveMetricName(Aq.id,Af.zone))){return false;}break;case AA:case a:if(Am){if((this.isAttrCategory(Af)&&Ah===AA)||(Ah===a&&this.isMetric(Af)&&(Ad===0||AZ===Z.ON))){return true;}return false;}else{if(AU||Ab){var Ag=Ah===AA?a:AA;if(this.isMetric(Af)&&this.hHasMetricInZone(Ag)&&(this.getUnitIndexInZone(this.getZoneModelByZoneId(Ag),Af)===-1||this.getZoneModelByZoneId(Ag).items.length>1)){return false;}if(this.isAttribute(Af)&&this.hHasAttributeInZone(Ag)&&(this.getUnitIndexInZone(this.getZoneModelByZoneId(Ag),Af)===-1||this.getZoneModelByZoneId(Ag).items.length>1)){return false;}}else{if(!Aj&&An&&AZ!==Z.ON){return true;}}}if(Aj){if(Ao||An){return false;}else{if(this.hHasMetricInZone(Ah)||AZ===Z.ON){return false;}}}break;case U:if(Ai||Aj){return false;}if(AX){if(Ad>0&&!Ao&&AZ!==Z.ON){if(this.getUnitIndexInZone(Aq,Af)===-1){return false;}}}break;case I:if(AW||AX){return false;}break;case m:if(Ab){if(this.isMetric(Af)){return false;}var Ap=this.hGetItemOccurrence(Af,[I]);if(Ap.length){return false;}}if(AX){if(Ad>0&&AZ!==Z.ON){return false;}}else{if(Ai){if(Ad>0&&this.isMetric(Aq.items[0])&&AZ!==Z.ON){return false;}}}break;case e:if(AX){return false;}break;case w:if(AX){return true;}else{return false;}break;case K:var Ar=this.getMetricCntInZone(Ah),Aa=Ad-Ar;if(Aj){return false;}if(Ai){if(!Al){return false;}Ap=this.hGetItemOccurrence(Af);if(Ap.length<=0){return false;}if(Ar>0){if(Aa===0){if(Ak!==0||AZ!==0){return false;}}else{if(Ak===Aa&&AZ!==0||Ak>Aa-1&&Ak!==Aa){return false;}}}}if(AX){if(Aa>0&&Ak<Aa){return false;}}break;default:break;}return true;},changeToDualAxis:function x(AU){var AV=0,AW=0;r.forEach(AU.items,function(AX){if(AX.ax===0){AV++;}else{if(AX.ax===1){AW++;}}});return AV>0&&AW>0;},getActionsOnUnitDropped:function(A0,Aj,BO,BJ,Ah,AW,Ag,BP){var Am=this,BE,BB,Ao,Af=false,Ar=Am.getZoneModelByZoneId(I),Aq=Am.getZoneModelByZoneId(K),Ac=l.call(Am),A6=Ac.GMController,At=Ac.getChartStyle()==="NewGraphMatrixVisualizationStyle",BL=A6.getChartInfo(),BD=Am.getUnitIndexInZone(Aj,A0),Aa=Am.getUnitIndexInZone(Aq,A0),Ae=Aj.id,Ai=Aj.items,A4=[],An={},Ad={},Ap,AV=Am.isAttrCategory(A0),AZ=Am.isMetricName(A0),Az,A9,BG,BC,BK=BO.src.data.src,BI=Am.isDualAxis(Aj.id),BF=Am.isMetricZone(Ae),Al=function(){if(Ae===m){Ao=Am.hGetItemOccurrence(A0,[O,AI,AA,a,I,e]);if(Ao.length===0&&!Am.isMetric(A0)){var BV=function(BW){var BY=Am.getZoneModelByZoneId(m),BZ,BX;if(BW.id===e||BW.id===I){for(BX=BJ-1;BX>=0;BX--){BZ=r.find(BW.items,"did",BY.items[BX].did);if(BZ!==-1){return BZ+1;}}}return 0;};var BQ,BS,BU;if(A6.isBoxPlot){BQ=Am.getAttributesZone();BS=Am.getZoneModelByZoneId(BQ);BU=BS.items.length;var BR=BQ;BR=Am.getZoneModelByZoneId(BR);r.forEach(BS.items,function(BX,BW){A4.push(Am.getAddDropZoneUnitAction(BR,BX,BU-BW));});}else{BQ=BL.isPie?e:(A6.isGrid()?AA:I);BS=Am.getZoneModelByZoneId(BQ);BU=BV(BS);}A4.push(Am.getAddDropZoneUnitAction(BS,A0,BU));}}else{if((A0.zone===m)&&f(Ae)){A4=A4.concat(Am.getRemoveDropZoneUnitActions(Am.getZoneModelByZoneId(m),A0,1));}else{if(Ae===I&&BL.tp===2&&A6.view.chartInfo&&A6.view.chartInfo.subtype===1){var BT=Am.getZoneModelByZoneId(m),BS;if(!(BT.items.length&&BT.items[0].t===4)){BS=Am.getZoneModelByZoneId(m);A4.push(Am.getAddDropZoneUnitAction(BS,A0));}}}}};AW=(AW===undefined?true:AW);An[AA]=Am.isMetricZone(AA);An[a]=Am.isMetricZone(a);Ad[AA]=Am.getMetricCntInZone(AA);Ad[a]=Am.getMetricCntInZone(a);Ap=Am.getZoneModelByZoneId(w)!==undefined;if(Ap){An[w]=Am.isMetricZone(w);Ad[w]=Am.getMetricCntInZone(w);}else{An[w]=false;Ad[w]=0;}if(Ai.length){if(Ae===m&&Ah!==Z.ON&&(Am.isMetric(A0)||((Am.isAttrCategory(A0)||Am.isMetricName(A0))&&Am.isOnlyMetricZone(Ae)))){Ah=Z.ON;}if(C(Ae)&&this.differInType(A0,Ai[0])){if(AV){An[Ae]=false;}if(this.isMetric(A0)){An[Ae]=true;}Ad[Ae]=1;A4=A4.concat(this.getClearDZUnitActions(Aj));if(At){for(var BE=0;BE<Ai.length;BE++){A4=A4.concat(Am.removeFromTooltipDropZone(Ai[BE],Ae));}}BJ=0;}else{if(Ah===Z.ON){A9=Aj.items.filter(function(BQ){return BQ.dzidx!==undefined?BQ.dzidx===BJ:BQ.idx!==undefined?BQ.idx===BJ:true;})[0];BG=(A0.did===A9.did);BC=(Ae===m);if(Am.getUnitIndexInZone(Aj,A0)!==-1&&A9.did!==A0.did){Ad[Ae]--;}if(Am.isMetric(A0)&&Am.isMetric(A9)){AW=A9.ax===0;}if(BC&&((Am.isAttrCategoryZone(m)&&Am.isMetric(A0))||(Am.isMetricZone(m)&&AV))){if(At){for(var BE=0;BE<Ai.length;BE++){A4=A4.concat(Am.removeFromTooltipDropZone(Ai[BE],Ae));}}A4=A4.concat(Am.getClearDZUnitActions(Aj,false));BJ=0;}else{if(!BG){A4=A4.concat(Am.getRemoveDropZoneUnitActions(Aj,A9));if(At){A4=A4.concat(Am.removeFromTooltipDropZone(A9,Ae));}if(BD<BJ&&BD>=0){BJ--;}}}if(BC&&Am.isAttrCategory(A9)&&!BG){this.removeColorByItemFromBreakByIfExists(A9,A4);}else{Al();}}else{if(Ah===Z.ABOVE&&Am.getUnitIndexInZone(Aj,A0)===-1){Ad[Ae]+=1;if(Ad[Ae]===1&&A0.t===4){An[Ae]=true;}}else{if((Ah===Z.BELOW||Ah===AQ)&&Am.getUnitIndexInZone(Aj,A0)===-1){Ad[Ae]+=1;if(Ad[Ae]===1&&A0.t===4){An[Ae]=true;}if((BJ<Ai.length)&&(BD===-1)){BJ++;}}}}}}else{Ad[Ae]+=1;if(Ad[Ae]===1&&Am.isMetric(A0)){An[Ae]=true;}BJ=0;}if(C(Ae)&&A0.zone===Ae&&BL.isBubbleOrScatter&&Ai.length>1){var A3=(A0.ax===0);if(A3!==AW){r.forEach(Ai,function(BQ){if(BQ.did!==A0.did){A4.push(Am.getAddDropZoneUnitAction(Aj,BQ,BJ,{isPrimary:AW}));}});}}if(Ae===I&&A6.isBoxPlot){Ao=Am.hGetItemOccurrence(A0);for(BE=0,BB=Ao.length;BE<BB;BE++){if(Ao[BE].zoneId===m){Az=Am.getZoneModelByZoneId(Ao[BE].zoneId);A4=A4.concat(Am.getRemoveDropZoneUnitActions(Az,Az.items[Ao[BE].itemIndex],1));if(Ad[Az.id]){Ad[Az.id]--;}}}}if(!At){if(Ae!==K&&Aa!==-1){A4=A4.concat(Am.getRemoveDropZoneUnitActions(Aq,Aq.items[Aa],1));}if(Ae===K){Ao=Am.hGetItemOccurrence(A0);for(BE=0,BB=Ao.length;BE<BB;BE++){if(Ao[BE].zoneId!==K){Az=Am.getZoneModelByZoneId(Ao[BE].zoneId);A4=A4.concat(Am.getRemoveDropZoneUnitActions(Az,Az.items[Ao[BE].itemIndex],1));if(Ad[Az.id]){Ad[Az.id]--;}}}}}else{if(!AZ&&Ae!==K){var AY=Am.getTooltipDropzoneIdx(A0);A4.push(Am.getAddDropZoneUnitAction(Aq,A0,AY,{isPrimary:AW}));}}if(!An[AA]&&!An[a]&&Aj.id!==I&&Ar!==undefined){if(At){var A7=Ar.items;for(var BE=0;BE<A7.length;BE++){A4=A4.concat(Am.removeFromTooltipDropZone(A7[BE],I));}}A4=A4.concat(Am.getClearDZUnitActions(Ar));var Ak=Am.hGetItemOccurrence(AJ,[I]);if(Ak){A4=A4.concat(Am.getClearDZUnitActions(Ar,false));}}if(AV||AZ){if(BD!==-1){if(Ae===I||Ae===e){if(Ai[BD].hidden){A4=A4.concat(Am.getRemoveDropZoneUnitActions(Am.getZoneModelByZoneId(m),A0));}}else{if(Ae===m){Al();}}}else{Al();}}else{if(this.isMetric(A0)){var Av=this.hGetItemOccurrence(A0,[AA,a,w]),A8=([AA,a,w,m,U,K]).filter(function(BQ){return BQ!==A0.zone;}),AX=Am.hGetItemOccurrence(A0,A8),Ab=AX.length>0?1:0;if((BK===W.VIZ_EDITOR||BK===W.VIZ)&&A0.zone&&(A0.zone!==Ae&&(!At||Ae!==K))){A4=A4.concat(Am.getRemoveDropZoneUnitActions(Am.getZoneModelByZoneId(A0.zone),A0,1));if(Av.length&&Ad[Av[0].zoneId]&&Av[0].zoneId!==Ae){Ad[Av[0].zoneId]--;}}else{if(BK===W.DATASETS&&Av.length!==0&&Ae!==m&&Ae!==U&&Ae!==w&&Av[0].zoneId!==Ae&&Av[0].zoneId!==w){if(!At){A4=A4.concat(Am.getRemoveDropZoneUnitActions(Am.getZoneModelByZoneId(Av[0].zoneId),A0,Ab));Ad[Av[0].zoneId]--;}}}}}A4.push(Am.getAddDropZoneUnitAction(Aj,A0,BJ,{isPrimary:AW}));if(!BO.metricNamesHandled){if(!this.isMetricName(A0)){var Ax=R.clone(AJ,[O,AI,AA,a]),BN=Am.hGetItemOccurrence(Ax),Ay=BN.length>0,As=Am.hGetItemOccurrence(AJ,[O]),AU=Am.hGetItemOccurrence(AJ,[AI]),A5=Am.hGetItemOccurrence(AJ,[AA]),Au=Am.hGetItemOccurrence(AJ,[a]),A2=Am.hGetItemOccurrence(AJ,[O,AI,AA,a,I]);if((An[AA]&&Ad[AA]>c)||(An[a]&&Ad[a]>c)||(An[w]&&Ad[w]>c)){Af=true;}var Aw=A2.length?A2[0].zoneId:O,BH=Am.changeToDualAxis(Aj);if(!Ay&&Ae===AA){Aw=AI;}if(!Ay&&BO.dndGM&&Am.isMetric(A0)&&Ah!==Z.ON){if(Ag){if(Ae===AA){Aw=AI;}else{Aw=O;}}else{if(Ae===AA){Aw=a;}else{Aw=AA;}}}var BA=false;if(Am.isAttrCategory(A0)&&Ae!==O&&Ae!==AI&&Ae!==m&&Ae!==I&&Ae!==e){r.forEach(BN,function(BQ){if(BQ.zoneId===Ae){BA=true;}});if(!BF&&(Ae===AA||Ae===a)){BA=true;}if(Af&&Ay&&!BA){if(A5.length){Aw=AI;}else{if(Au.length){Aw=O;}}Aj=Am.getZoneModelByZoneId(Aw);Ax.zone=Aw;A4.push(Am.getAddDropZoneUnitAction(Aj,Ax,Aj.items.length));}}if(!BI&&BH&&(A0.zone===AA||Ae===AA)&&As.length>0){Aw=a;}else{if(!BI&&BH&&(A0.zone===a||Ae===a)&&AU.length>0){Aw=AA;}}if(Af!==Ay||BK===W.VIZ||(Ay&&Ag!==[AI,O].indexOf(BN[0].zoneId)>=0)){A4=A4.concat(Am.getUpdateMetricNameUnitActions(Af,Aw));}}}if(A0.t===4){var A1;if(A6.shallWeUseGroupInfo){if(Am.isMetricName(A0)&&(Ae===AA||Ae===a)){A6.shallWeUseGroupInfo=false;A6.removeGroupInfo();}else{A1=A6.getGroupInfo();if((BL.dirc===AT.VERTICAL&&Ae===a)||(BL.dirc===AT.HORIZONTAL&&Ae===AA)){if(Ah===Z.ON&&A9!==undefined&&Am.isMetric(A9)){A1=Am.replaceItemInGroupInfo(A1,A0.did,AW,A9.did);}else{A1=Am.fillGroupInfo(BO,A1,A0.did,AW);}}A6.setGroupInfo(A1);}}else{if((AW===false&&A6.getSplitPlottingMetrics())){A6.shallWeUseGroupInfo=true;if(BL.isBubbleOrScatter&&Ad[a]===0){A6.horizontalMode=true;}A1=A6.getDummyGroupInfo();A1=Am.fillGroupInfo(BO,A1,A0.did,AW);}else{if(Am.isMetricName(A0)&&(Ae===O||Ae===AI)&&A6.getSecondaryMetrics().length>0){A6.shallWeUseGroupInfo=true;A1=A6.getDummyGroupInfo();}else{if(BP){A6.shallWeUseGroupInfo=true;A1=A6.getDummyGroupInfo(A0.did,AW,Ah===Z.ABOVE);}}}}if(A6.shallWeUseGroupInfo){Ac.setWidgetPropertyValue(n.GROUP_INFO,JSON.stringify(A1));}}Am.checkAndAddThresholdAction(Ae,A0,A4);var BM=function(BS){if(!AV){return BS;}var BR=Am.getZoneModelByZoneId(m),BW=Am.getZoneModelByZoneId(e),BV=Am.getZoneModelByZoneId(I),BY,BT,BU=[],BZ=function(){for(BE=r.find(BR.items,"did",A0.did)-1;BE>=0;BE--){BY=r.find(Aj.items,"did",BR.items[BE].did);if(BY!==-1){return BY+1;}}return 0;},BX=function(Bb,Ba,Bc){Bb.items=Bb.items.filter(function(Bd){return Bd.did!==Bc.did;});Bb.items.splice(Ba,0,Bc);},BQ=function(Ba,Bb){return BS.some(function(Bc){return(Bc.zoneId===Ba.id&&Bc.unitId===Bb.did);});};BS.forEach(function(Ba){if(Ba.act==="addDropZoneUnit"){Aj=Am.getZoneModelByZoneId(Ba.zoneId);A0={t:Ba.unitType,did:Ba.unitId};BJ=Ba.unitPos-1;BJ=BJ>=0?BJ:0;if(Aj.id===I||Aj.id===e){if(r.find(BR.items,"did",A0.did)!==-1){BJ=BZ();Ba.unitPos=BJ+1;}BX(Aj,BJ,A0);}else{if(Aj.id===m){BX(Aj,BJ,A0);if(BW&&r.find(BW.items,"did",A0.did)!==-1){BY=BZ();BX(BW,BY,A0);if(!BQ(BW,A0)){BT=R.clone(Ba);BT.zoneId=BW.id;BT.unitPos=BY+1;BU.push(BT);}}if(BV&&r.find(BV.items,"did",A0.did)!==-1){BY=BZ();BX(BV,BY,A0);if(!BQ(BV,A0)){BT=R.clone(Ba);BT.zoneId=BV.id;BT.unitPos=BY+1;BU.push(BT);}}}}}});return BS.concat(BU);};return A4;},checkAndAddThresholdAction:function AL(AZ,AW,AX){var AV=this.getHost(),AU=AV.getVisType().vt,AY=M.getDefaultGMThreshold(AU);if(this.isMetric(AW)&&AZ===m){M.addThresholds(AV.model,AV,AV.node,AW,AX,AY.colors,AY.ranges,false);return true;}return false;},isDualAxis:function N(AU){var AZ=this,AY=AZ.getZoneModelByZoneId(AU),AW=0,AX=0;var AV=function(Aa){if(Aa===true||Aa===1){AW++;}else{if(Aa===false||Aa===0){AX++;}}};r.forEach(AY.items,function(Aa){if(AZ.isMetric(Aa)){AV(Aa.ax);}});return AW>0&&AX>0;},getUnitDroppedActions:function(Aj,Ac,AV,Ah,AW,Ad,AU,Ag){var AZ=[],Ae=(Ag===O||Ag===AI);AZ=AZ.concat(this.getActionsOnUnitDropped(Aj,Ac,AV,Ah,AW,Ad,AU,Ae));if(Ag){var AY=R.clone(AJ,[O,AI,AA,a]),Ai=this.hGetItemOccurrence(AY),Aa=this.getZoneModelByZoneId(Ag),AX=Aa.items.length,Af;if(Ai.length>0){var Ab=this.getZoneModelByZoneId(Ai[0].zoneId);Af=Ab.items[Ai[0].itemIndex];}else{Af=AY;Af.zone=Ag;}AZ=AZ.concat(this.getActionsOnUnitDropped(Af,Aa,AV,AX,Z.BELOW,true));}return AZ;},getUpdateMetricNameUnitActions:function(Ac,Ad){var AX,AZ,Ab,AV=R.clone(AJ),Ae=this.hGetItemOccurrence(AV),AY=Ae.length,AW=[];if(Ac&&AY===0){Ab=this.getZoneModelByZoneId(Ad);AV.zone=Ad;AW.push(this.getAddDropZoneUnitAction(Ab,AV,Ab.items.length));}if(!Ac&&AY>0){for(AX=0;AX<AY;AX++){Ab=this.getZoneModelByZoneId(Ae[AX].zoneId);AZ=Ae[AX].itemIndex;AW=AW.concat(this.getRemoveDropZoneUnitActions(Ab,Ab.items[AZ]));}}if(AW.length===0&&Ad!==O){if(AY>0){var Aa=false;var AU;for(AX=0;AX<AY;AX++){AU=Ae[AX].zoneId;if(AU===Ad){Aa=true;break;}}if(Aa===false){Ab=this.getZoneModelByZoneId(Ad);AV.zone=Ad;AW.push(this.getAddDropZoneUnitAction(Ab,AV,Ab.items.length));}}}return AW;},getClearDZUnitActions:function(AV,AU){var AW,AX,AY=AV.items,Aa=AY.length,AZ=[];if(AU===undefined){AU=true;}for(AW=Aa-1;AW>=0;AW--){AX=AY[AW];if(this.isMetricName(AX)&&AU){continue;}AZ=AZ.concat(this.getRemoveDropZoneUnitActions(AV,AX));}return AZ;},getClearDZMetricActions:function(AY,Ab,Aa){var AX,Ac,Ae=AY.items,AU=Ae.length,Ad=this.getZoneModelByZoneId(K),AZ=Ad.items.length,AV=Ad.items.map(function(Af){return Af.did;}),AW=[];for(AX=AU-1;AX>=0;AX--){Ac=Ae[AX];if(!this.isMetric(Ac)){continue;}if(AV.indexOf(Ac.did)===-1){Aa.push(Ac.did);}AW.push(this.getAddDropZoneUnitAction(Ad,Ac,AZ++,{isPrimary:Ac.ax===0}));AW=AW.concat(this.getRemoveDropZoneUnitActions(AY,Ac,Ab));}return AW;},removeMetricFromTooltips:function(AU){var AV,AW,Aa=this.getZoneModelByZoneId(K),AX=Aa.items,AZ=AX.length,AY=[];for(AV=AZ-1;AV>=0;AV--){AW=AX[AV];if(this.isMetric(AW)&&AU.indexOf(AW.did)>=0){AY=AY.concat(this.getRemoveDropZoneUnitActions(Aa,AW,1));}}return AY;},getSwapDZUnitActions:function(AY,AW,Ae){var AZ,Ai,Aa=AY.items.slice(0),Ag=AW.items.slice(0),Ah=Aa.length,Af=Ag.length,AX=[],Ac=[],Ab=[],Ad=[],AV,AU=this.isAttrCategoryZone(AY.id);AX=AX.concat(this.getClearDZMetricActions(AY,1,Ad));AX=AX.concat(this.getClearDZMetricActions(AW,1,Ad));for(AZ=0;AZ<Ah;AZ++){Ai=Aa[AZ];if(this.isMetric(Ai)){AV={isPrimary:Ai.ax===0};}else{AV={};}Ac.push(this.getAddDropZoneUnitAction(AW,Ai,AZ,AV));}for(AZ=0;AZ<Af;AZ++){Ai=Ag[AZ];if(this.isMetric(Ai)){AV={isPrimary:Ai.ax===0};}else{AV={};}Ab.push(this.getAddDropZoneUnitAction(AY,Ai,AZ,AV));}if(AU){AX=AX.concat(Ac);AX=AX.concat(Ab);}else{AX=AX.concat(Ab);AX=AX.concat(Ac);}AX=AX.concat(this.removeMetricFromTooltips(Ad));return AX;},getAddDropZoneUnitAction:function v(AZ,Ac,Aa,AW){var Ab=l.call(this),AX=Ab.model,Ad=AX.data,AY=Ab.itemId2DsIdMap[Ac.did]||Ad.datasetId,AU,AV;AW=AW||{};AW.datasetId=AY;AW.datasetType=AY===X?d:h;if(this.isMetricName(Ac)){Aa=AZ.items.length;}AV=this._super(AZ,Ac,Aa,AW);if(AW.isPrimary===undefined||AW.isPrimary===true){AU=P.PRIMARY;}else{AU=P.SECONDARY;}if(AZ.id===AA||AZ.id===a){Ac.ax=AU;AV.ax=AU;if(Ac.zone===AA||Ac.zone===a){Ac.zone=AZ.id;}}if(AZ.items===undefined){return AV;}if(Aa<=AZ.items.length){if(AZ.id===I){r.forEach(AZ.items,function(Ae){if(Ae.did===Ac.did&&Ae.hidden){Ac.hidden=true;}});}AZ.items=AZ.items.filter(function(Ae){return Ae.did!==Ac.did;});AZ.items.splice(Aa,0,Ac);}return AV;},getRemoveDropZoneUnitActions:function E(AU,AV,AW){var AX=this._super(AU,AV,AW);if(AU.items===undefined){return AX;}AU.items=AU.items.filter(function(AY){return AY.did!==AV.did;});return AX;},moveAttributesToZone:function(AZ,AV){var AW,AY,AU;var Aa=l.call(this),AX=Aa.getChartStyle()==="NewGraphMatrixVisualizationStyle";AW=AF.call(this,AZ,1);AY=AB.call(this,AV,AW.removedItems);appendTooltip=AX?AB.call(this,9,AW.removedItems):{actions:[]};if(this.getZoneModelByZoneId(m)){AU=AD.call(this,m,AW.removedItems);return AW.actions.concat(AY.actions).concat(AU.actions).concat(appendTooltip.actions);}return AW.actions.concat(AY.actions).concat(appendTooltip.actions);},deleteItem:function(AV,AU,AX,AW){this.deleteItems([AV.items[AU]],AX,AW);},deleteItems:function(Al,Av,Ao){var A0=l.call(this),Af,Au=A0.GMController,Ag=Au.getChartInfo(),Ad=[],Ab,Aq=R.clone(AJ),AU={},Ar={},At,As,Aj,AZ,Ae,AY,Ak=A0.getChartStyle()==="NewGraphMatrixVisualizationStyle",Ax=this;var Ah=function(BC,A7){Af=BC.zone;if(f(Af)&&Ax.isMetricName(BC)){var A8=Au.dz.XAxis.TemplateMetric||[],BD=Au.dz.YAxis.TemplateMetric||[];if(BC.cs&&(A8.length>1||BD.length>1)){Ad=Ad.concat(Ax.getUpdateMetricNameUnitActions(true,I));}return ;}var A9=Ax.getZoneModelByZoneId(Af),A1=Ax.getZoneModelByZoneId(m),A3=Ax.getZoneModelByZoneId(I),A4=Ax.getZoneModelByZoneId(K),A5=Ax.hGetItemOccurrence(BC,[m]),A6=Ax.hGetItemOccurrence(BC,[AA,a,m,I]);if(BC.cs&&BC.zone===e&&A5.length){Ad=Ad.concat(Ax.getRemoveDropZoneUnitActions(A9,BC));if(A7){Ad=Ad.concat(Ax.getAddDropZoneUnitAction(A1,BC,A1.items.length));Ad=Ad.concat(Ax.getAddDropZoneUnitAction(A3,BC,A3.items.length));}return ;}if(BC.cs&&BC.zone===U&&!A6.length){Ad=Ad.concat(Ax.getRemoveDropZoneUnitActions(A9,BC));Ad=Ad.concat(Ax.getAddDropZoneUnitAction(A4,BC,A4.items.length));return ;}Av=Av||c;Aj=Ax.getZoneModelByZoneId(w)!==undefined;AU[AA]=Ax.isMetricZone(AA);AU[a]=Ax.isMetricZone(a);Ar[AA]=Ax.getMetricCntInZone(AA);Ar[a]=Ax.getMetricCntInZone(a);if(Aj){AU[w]=Ax.isMetricZone(w);Ar[w]=Ax.getMetricCntInZone(w);}else{AU[w]=false;Ar[w]=0;}if(BC.t===4&&(Af===AA||Af===a||Af===w)){Ar[Af]-=1;if(Ar[Af]===0){AU[Af]=false;}}if(!((AU[AA]&&Ar[AA]>Av)||(AU[a]&&Ar[a]>Av)||(AU[w]&&Ar[w]>Av))){At=Ax.hGetItemOccurrence(Aq);AY=At.length;for(As=0;As<AY;As++){Ae=Ax.getZoneModelByZoneId(At[As].zoneId);AZ=At[As].itemIndex;Ad=Ad.concat(Ax.getRemoveDropZoneUnitActions(Ae,Ae.items[AZ]));}}if(!(AU[AA]&&Ar[AA])&&!(AU[a]&&Ar[a])){if(!Ax.isZonesEmptyAfterDelItem(BC)){var A2=Ax.getZoneModelByZoneId(I);if(A2!==undefined){r.forEach(A2.items,function(BE){if(Ax.isMetricName(BE)){var BF=Ax.getZoneModelByZoneId(O);Ad.push(Ax.getAddDropZoneUnitAction(BF,Aq,BF.items.length));}Ad=Ad.concat(Ax.getRemoveDropZoneUnitActions(A2,BE));});}}}if(Ax.isMetricName(BC)&&BC.zone===m){var BA=Ax.hGetItemOccurrence(AJ,[O,AI,AA,a,I,e]);if(BA.length===0){if(Ag.isPie){Ad=Ad.concat(Ax.getUpdateMetricNameUnitActions(true,e));}else{Ad=Ad.concat(Ax.getUpdateMetricNameUnitActions(true,I));}}}if(Ak&&Af!==K){Ad=Ad.concat(Ax.removeFromTooltipDropZone(BC,Af));}Ad=Ad.concat(Ax.getRemoveDropZoneUnitActions(A9,BC));if(Ax.isAttrCategory(BC)&&Af===m){Ax.removeColorByItemFromBreakByIfExists(BC,Ad);}if(Ag.isABL&&BC.t===4){A0.updateMetricShape(BC);var BB=Au.hasGroupInfoStored();if(BB.existing){Ab=BB.gi;if((Ag.dirc===AT.VERTICAL&&Af===a)||(Ag.dirc===AT.HORIZONTAL&&Af===AA)){Ab=Q(Ab,BC.did);}Au.setGroupInfo(Ab);}}};var An=Ax.getZoneModelByZoneId(I);An=An&&An.items.length||0;r.forEach(Al,function(A1){Ah(A1,Ao);});if(Ax.getZoneModelByZoneId(I)!==undefined){var Aw=Ax.getZoneModelByZoneId(I).items.length;if(Aw===0&&An>0){A0.updateSubtype();}}if(Ad.length===0&&!A0.isXMLDirty()){return ;}var AX=this.docModel,Ap=AX.getDataService(),AW=A0.k,Az=b(A0),Ai=Ap.getUpdateTemplateAction(AW,Ad),Am=Ai.partialRetrieval.nodes,AV=[Ai],Ay=AX.getSelectedViUnit(),Ac=Ay&&Ay.boxContent,Aa=!(Ac&&Ac.isInFilterPanel());Ai.partialRetrieval.nodes=Am.concat(Aa?this.docModel.getSourceFilterKeys(AW):[]);if(A0.isXMLDirty()){AV.push(A0.getPersistAction());}return AX&&AX.checkAndNotifyVFChangeOnDZUnitsUpdate({actions:AV,zm:Ax,cmb:true},function(){AV=AX.wrapUnsetVisualizationFilterAction(AV);A0.controller.submitUndoRedoUpdates(AV,null,Az);},function(){A0.controller.submitUndoRedoUpdates(AV,null,Az);});},getHostModel:function(){return this.getHost().model.data;},replaceItemInGroupInfo:function(AU,Ac,Aa,Ab){var AZ=AU.length,AW,AX,AY,AV;AX=Aa?0:1;for(AY=0;AY<AZ;AY++){AW=AU[AY];AV=false;if(AW[AX]===Ac){AW[AX]=g;if(AW[1-AX]===g){AV=true;}}else{if(AW[1-AX]===Ac){AW[1-AX]=g;if(AW[AX]===g){AV=true;}}}if(AV){AU.splice(AY,1);AZ=AU.length;AY-=1;}}for(AY=0;AY<AZ;AY++){AW=AU[AY];if(AW[AX]===Ab){AW[AX]=Ac;break;}}return AU;},fillGroupInfo:function o(AV,AU,Ad,Ab){var AY,AW,Aa,AX=-1,Ac=-1,AZ=AU.length;if(!AV.dndGM){for(AY=0;AY<AZ;AY++){AW=AU[AY];if(AW[0]===Ad){AX=AY;}if(AW[1]===Ad){Ac=AY;}}if((Ab&&AX!==-1)||(!Ab&&Ac!==-1)){return AU;}if(Ab&&Ac!==-1){Aa=Ac;AW=AU[Aa];AW[1]=g;if(AW[0]===g){AW[0]=Ad;return AU;}}if(!Ab&&AX!==-1){Aa=AX;AW=AU[Aa];AW[0]=g;if(AW[1]===g){AW[1]=Ad;return AU;}}AU=AM(AU,Ad,Ab);}else{AU=F(AV,AU,Ad,Ab);}return AU;},removeFromTooltipDropZone:function u(AY,AU){var AX=this,Aa=AX.hGetItemOccurrence(AY),AZ=[],Ab=AX.getZoneModelByZoneId(K);if(f(AU)){for(var AV=0;AV<Aa.length;AV++){var AW=AX.getZoneModelByZoneId(Aa[AV].zoneId);AZ=AZ.concat(AX.getRemoveDropZoneUnitActions(AW,AY));}}else{if(Aa.length===2){for(var AV=0;AV<Aa.length;AV++){if(Aa[AV].zoneId===K){AZ=AZ.concat(AX.getRemoveDropZoneUnitActions(Ab,AY));}}}}return AZ;},getTooltipDropzoneIdx:function AS(AX){var AW=this,AU=AW.getZoneModelByZoneId(K),AY=this.isAttribute(AX),AZ=AW.hGetItemOccurrence(AX);for(var AV=0;AV<AZ.length;AV++){if(AZ[AV].zoneId===K){return AZ[AV].itemIndex;}}if(AY){return AU.items.filter(function(Aa){return AW.isAttribute(Aa);}).length;}else{return AU.items.length;}return index;},getHighlightTargets:function AR(AZ,AW,AY){if(!AZ.items.length){return null;}var AV=true;AY.allowedItems.forEach(function(Aa){if(Aa.t===AZ.items[AY.idx].t){AV=false;}});if(AV){var AX=[],AU;AZ.items.forEach(function(Ab,Aa){AU=Aa+(AW||0);AX.push({idx:AU,edge:AY.edge});},this);return AX;}return null;},getUpdateGroupInfoActionForNewMetric:function(AU,AV,Aa){if(AV<=0){return null;}var AZ=l.call(this),AY=AZ.GMController,Ab,AW,AX;if(AY.shallWeUseGroupInfo){AW=AY.getGroupInfo();Ab=AY.getChartInfo();if(Ab.isABL&&((Ab.dirc===AT.VERTICAL&&AU===a)||(Ab.dirc===AT.HORIZONTAL&&AU===AA))){AX="idx:"+AV;AW=this.fillGroupInfo({dndGM:false},AW,AX,Aa);AY.setGroupInfo(AW);if(AZ.isXMLDirty()){return AZ.getPersistAction();}}}return null;}});}());(function(){mstrmojo.requiresCls("mstrmojo.vi.models.DropZonesModel","mstrmojo.array","mstrmojo.hash","mstrmojo.vi.models._DropZoneCommon","mstrmojo.vi.ui.DatasetUnitMenuUtils","mstrmojo.mstr.EnumDSSXMLObjectTypes","mstrmojo.mstr.EnumDSSXMLBaseFormType");mstrmojo.requiresDescs(190,1388,3224,5188,11806,12287,13295,13296,13624,13625,14003,14655,14656,14717);var H=mstrmojo.array,C=mstrmojo.hash,E=mstrmojo.vi.ui.DatasetUnitMenuUtils,I="-1",D=mstrmojo.mstr.EnumDSSXMLBaseFormType,J=mstrmojo.vi.enums.EnumFeatures,F=mstrmojo.mstr.EnumDSSXMLObjectTypes;mstrmojo.vi.models.TemplateBasedDropZones=mstrmojo.declare(mstrmojo.vi.models.DropZonesModel,[mstrmojo.vi.models._DropZoneCommon],{getClearAllUnitsActions:function G(){var L=[],K=this.getHost().model;this.getDropZones().zones.forEach(function(M){var N=M.id;M.items.forEach(function(P,O){if(P.did!==I){L.push(K.getRemoveTemplateUnitAction(C.copy(P,{axis:N,unitPos:O+1})));}});});return L;},getMultiUnitsMenuItems:function B(L,K,M){var N=this.id;if(!mstrApp.isInVFConfigMode&&E.getMultiSelectionShortcutMetricFunctions(M).length&&mstrmojo.resolveFeature(J.INSERT_NEW_METRIC)){L.addSubMenuItem(mstrmojo.desc(5188,"Calculation"),"",this.id,function(){return mstrmojo.all[N].getMultipleMetricsCalcMenus(K,M,false);});L.addSeparator();}L.addMenuItem(mstrmojo.desc(190,"Remove"),"xt",function(){mstrmojo.all[N].deleteItems(K,M);});},getExtraUnitMenuItems:function A(L,K,N,M){},getUnitMenuItems:function A(O,a,Y,Z){if(!Y){throw new Error(this.scriptClass+"::getUnitMenuItems: Item must be provided.");}var U=a.items,K=this.getHost(),X=U.length,M=a.id,P={zone:a,axis:M,idx:H.indexOf(U,Y),cnt:X,item:Y,metricsAxis:(this.getHost().gridInfo||{}).tma,useDropzone:false},d=this,V=this.id,L=Y.did===I,Q=(Y.t===F.Consolidation&&Y.st===12033),e=mstrApp.isInVFConfigMode,N=mstrmojo.resolveFeature(J.INSERT_NEW_METRIC),W=this.docModel,b=Y.did;if(Q&&!e){O.addMenuItem(mstrmojo.desc(13296,"Edit Groups..."),"eg",function(){var f={otp:Y.t,id:b,n:Y.n,axis:a.id,ui:P.idx};K.derivedElementsEdit(f);});O.addSeparator();}if(!L){if(K.model.isRecursiveAttribute(Y.did)){O.addMenuItem(mstrmojo.desc(14655,"Expand All Levels"),"",function(){var f={id:Y.did};K.raExpandAll(f,true);});O.addMenuItem(mstrmojo.desc(14656,"Collapse All Levels"),"",function(){var f={id:Y.did};K.raExpandAll(f,false);});O.addSeparator();}this.addSortMenu(P,O,true);O.addSeparator();if(Y.t===F.Metric&&!e){if(Y.um){O.addMenuItem(mstrmojo.desc(3224,"Edit..."),"",function(){d.editDerivedMetric(P);},P);O.addSeparator();}if(N){if(W.findDatasetIdFromUnit(b)&&!W.isFromSolrCube(b)&&!W.isFromMDXCube(b)){O.addSubMenuItem(mstrmojo.desc(11806,"Aggregate By"),"",V,d.getAggregateByMetricSubMenu,P);O.addSeparator();}O.addEditorMenuItem(mstrmojo.desc(5188,"Calculation"),V,d.getCalculationEditorCfg,P);O.addSubMenuItem(mstrmojo.desc(12287,"Shortcut Metric"),"",V,d.getShortcutMetricSubMenu,P);O.addMenuItem(mstrmojo.desc(13624,"Create Metric..."),"",function(){d.newDerivedMetric(P);},P);}}if(Y.t===F.Attribute){var S=Y.did||"",R=S?E.getDatasetFromAttributeId(this.docModel.datasets,S):null,c=this.isDynamicLink(Y);if((!R||!this.docModel.isMDXDataset(R))&&!e){if(Y.da){O.addMenuItem(mstrmojo.desc(3224,"Edit..."),"",function(){d.editDerivedAttribute(P);},P);O.addSeparator();}if(((!R)||!E.isCGorCon(Y,R))&&!c&&N){O.addMenuItem(mstrmojo.desc(13625,"New Attribute..."),"",function(){d.newDerivedAttribute(P);},P);O.addMenuItem(mstrmojo.desc(14717,"Create Links..."),"",function(){d.newDynamicLinkAttr(P);},P);}}if(!e&&!E.hasOldDEOverDatasets(Y.did,this.docModel.datasets)&&!c&&Y.st!==3076){O.addMenuItem(mstrmojo.desc(13295,"Create Groups..."),"eg",function(){var f={otp:Y.t,id:Y.did,n:Y.n,axis:a.id,ui:P.idx};K.derivedElementsEdit(f);});}}this.getExtraUnitMenuItems(O,a,Y,P);O.addSeparator();if(d.hasReplaceCandidates(P)&&(!(mstrApp.isAppStatePresentation&&mstrApp.isAppStatePresentation())||!!mstrmojo.resolveFeature(J.WEB_DRILL_AND_LINK))){O.addSubMenuItem(mstrmojo.desc(14003,"Replace With"),"",V,d.getReplaceSubMenu,P);}O.addMenuItem(mstrmojo.desc(1388,"Rename"),V,function(){mstrmojo.all[V].renameItem(Z,Y);});O.addMenuItem(mstrmojo.desc(190,"Remove"),"xt",function(){mstrmojo.all[V].deleteItem(a,P.idx);});}}});}());(function(){mstrmojo.requiresCls("mstrmojo.array","mstrmojo.hash","mstrmojo.func","mstrmojo.VisUtility","mstrmojo.chart.model.enums.EnumDSSObjectType","mstrmojo.vi.viz.EnumDSSDropZones","mstrmojo.vi.models.DropZonesModel","mstrmojo.vi.models._DropZoneCommon","mstrmojo.vi.ui.DatasetUnitMenuUtils","mstrmojo.vi.util.ThresholdUtils");var O=mstrmojo.hash,M=mstrmojo.array,S=mstrmojo.func,U=mstrmojo.VisUtility,C=mstrmojo.chart.model.enums.EnumDSSObjectType,R=mstrmojo.vi.viz.EnumDSSDropZones,B=mstrmojo.vi.util.ThresholdUtils,F=mstrmojo.vi.models.DropZonesModel.ENUM_TARGET_POSITION,G=mstrmojo.vi.ui.DatasetUnitMenuUtils,D=mstrmojo.vi.enums.EnumFeatures,A=R.FromItem,Y=R.ToItem,H=R.ColorBy,X=R.SizeBy,J=R.ItemSize,E=["#d2e0e8","#a4cbe6","#80add9","#558dcc","#2e78bb"];NETWORK_THRESHOLD_BANDS=[0.2,0.4,0.6,0.8];mstrmojo.vi.models.NetworkDropZones=mstrmojo.declare(mstrmojo.vi.models.DropZonesModel,[mstrmojo.vi.models._DropZoneCommon],{scriptClass:"mstrmojo.vi.models.NetworkDropZones",help:"editor_panel_network.htm",getHostModel:function K(){return this.getHost().model.data;},getDropZones:function P(){var b=this.getDZFlatStruct(),a=function(c){return{allowSingle:true,title:c};},Z=[this.getZone(mstrmojo.desc(11910,"From Item"),A,b.from,false,a(mstrmojo.desc(13833))),this.getZone(mstrmojo.desc(11911,"To Item"),Y,b.to,false,a(mstrmojo.desc(13833))),this.getZone(mstrmojo.desc(11912,"Edge Color"),H,b.ColorBy,false,a(mstrmojo.desc(13829))),this.getZone(mstrmojo.desc(11913,"Edge Size"),X,b.SizeBy,false,a(mstrmojo.desc(13829))),this.getZone(mstrmojo.desc(4781,"Item Size"),J,b.itemsz,false,a(mstrmojo.desc(13829)))];this.dropZones=Z;return{n:this.getHost().defn.ttl,zones:Z};},getUnitMenuItems:function W(g,k,p,b){var m=this,f=this.id,q=this.isMetric(p),c=this.isAttribute(p),j=k.items,d=j.length,a={zone:k,idx:M.find(j,"id",p.id),cnt:d,item:p,useDropzone:true},h=mstrApp.isInVFConfigMode,o=this.docModel,n=p.did,l=mstrmojo.resolveFeature(D.INSERT_NEW_METRIC),Z=(p.t===47&&p.st===12033),e=G.getDatasetFromAttributeId(o.datasets,n);if(Z&&!h){g.addMenuItem(mstrmojo.desc(13296,"Edit Groups..."),"eg",this.getCreateOrEditElementGroupFunc(a));}if(q&&!h){if(p.um){g.addMenuItem(mstrmojo.desc(3224,"Edit..."),"",function(){m.editDerivedMetric(a,"edit");},a);g.addSeparator();}if(l){if(o.findDatasetIdFromUnit(n)&&!o.isFromSolrCube(n)&&!o.isFromMDXCube(n)){g.addSubMenuItem(mstrmojo.desc(11806,"Aggregate By"),"",f,m.getAggregateByMetricSubMenu,a);g.addSeparator();}g.addEditorMenuItem(mstrmojo.desc(5188,"Calculation"),f,m.getCalculationEditorCfg,a);g.addMenuItem(mstrmojo.desc(13624,"Create Metric..."),"",function(){m.newDerivedMetric(a);},a);}}else{if(c&&!h){if(!e||!o.isMDXDataset(e)){if(p.da){g.addMenuItem(mstrmojo.desc(3224,"Edit..."),"",function(){m.editDerivedAttribute(a);},a);g.addSeparator();}if(!U.isCGorCon(this.getHost(),p)&&!this.isDynamicLink(p)&&l){g.addMenuItem(mstrmojo.desc(13625,"Create Attribute..."),"",function(){m.newDerivedAttribute(a,!m.allowInsertNewAttribute(k));},a);}}if(!G.hasOldDEOverDatasets(n,this.docModel.datasets)&&!this.isRecursiveAttribute(p)){g.addMenuItem(mstrmojo.desc(13295,"Create Groups..."),"eg",this.getCreateOrEditElementGroupFunc(a));}}}g.addSeparator();if(this.showNumberFormat(p)){g.addEditorMenuItem(mstrmojo.desc(13237,"Number Format"),f,this.getNumberFormatEditorCfg,a);}if(q){if(k.id===H){this.buildThresholdMenuOptions(g,a,true);}}if(this.shouldShowDisplayFormsMenu(p)){g.addEditorMenuItem(mstrmojo.desc(11908,"Display Attribute Forms"),this.id,function(){return m.getDisplayFormsMenu(p);});}g.addSeparator();if(m.hasReplaceCandidates(a)&&(!(mstrApp.isAppStatePresentation&&mstrApp.isAppStatePresentation())||!!mstrmojo.resolveFeature(D.WEB_DRILL_AND_LINK))){g.addSubMenuItem(mstrmojo.desc(14003,"Replace With"),"",f,m.getReplaceSubMenu,a);}g.addMenuItem(mstrmojo.desc(1388,"Rename"),"",function(){m.renameItem(b,p);});g.addMenuItem(mstrmojo.desc(190,"Remove"),"xt",function(){m.deleteItem(k,m.getUnitIndexInZone(k,p));});},getAvatarIconClass:function I(){return"viNetwork";},getAllowDropInfo:function L(f,d,h,b,Z){var g=this,a=this._super(f,d,h,b,Z),j=f.items.length!==0&&b!==F.ON,e=[H,X,J].indexOf(f.id)!==-1,c=j?null:M.filterOne(a.allowedItems,function(l){var k=g.isMetric(l);return e?k:(!k&&l.t!==C.DssTypeDimension);});return O.copy({allowedItems:c?[c]:[]},a);},getAddItemActions:function(b,c,Z,d){var a=this.getAddDropZoneUnitsActions(b,c,Z,{datasetId:d});this.checkAndAddThresholdAction(b.id,c[0],a);return a;},checkAndAddThresholdAction:function Q(c,a,b){var Z=this.getHost();if(this.isMetric(a)&&c===H){B.addThresholds(Z.model,Z,Z.node,a,b,E,NETWORK_THRESHOLD_BANDS,false);return true;}return false;},unitsDropped:function V(h,a,k,l,Z){var d=a.actions||[],c=[],g,f=a.src.data,n=k.idx,b=k.edge,e=k.allowedItems,m,j=this;if(b===F.ON&&k.removeReplaced){c=c.concat(this.getRemoveDropZoneUnitActions(h,h.items[n]));}c=c.concat(this.getAddItemActions(h,e,this.getDropTargetIndex(h,k),f.dsid));g=d.concat(j.getUpdateTemplateAction(c));m=function(o){return function(){var p=o?j.docModel.wrapUnsetVisualizationFilterAction(g):g;j.submitDropZoneUpdates(p,S.wrapMethods(a.callback,j.getHost().model.docModel.controller._getXtabCallback(j.getHost())));};};this.checkAndWarnLargeItemsForAddUnits(e,function(){j.docModel.checkAndNotifyVFChangeOnDZUnitsUpdate({actions:g,zm:j},m(true),m(false));});},deleteItem:function N(a,Z){var c=this,b=c.docModel,d=this.getRemoveDropZoneUnitActions(a,a.items[Z]);b&&b.checkAndNotifyVFChangeOnDZUnitsUpdate({ca:[a.id],zm:c},function(){c.submitDropZoneTemplateUpdates(d,{actions:b.wrapUnsetVisualizationFilterAction()});},function(){c.submitDropZoneTemplateUpdates(d);});}});}());(function(){mstrmojo.requiresCls("mstrmojo.array","mstrmojo.hash","mstrmojo.chart.model.enums.EnumDSSObjectType","mstrmojo.models.datasets.DataInterface","mstrmojo.vi.models.DropZonesModel","mstrmojo.vi.viz.MapHelper","mstrmojo.vi.viz.EnumDSSDropZones","mstrmojo.gmaps.EnumActions","mstrmojo.gmaps.MapUtils","mstrmojo.gmaps.MapEnums");mstrmojo.requiresClsP("mstrmojo.vi.models","_DropZoneCommon");mstrmojo.requiresClsP("mstrmojo.vi.util","TemplateUtils","ThresholdUtils");var m=mstrmojo,n=m.array,U=m.hash,p=m.vi.viz.EnumDSSDropZones,AF=m.vi.viz.MapHelper,H=m.chart.model.enums.EnumDSSObjectType,w=m.vi.ui.DatasetUnitMenuUtils,V=m.vi.util,M=V.ThresholdUtils,b=V.TemplateUtils,Z=m.vi.models.DropZonesModel.ENUM_TARGET_POSITION,O=m.gmaps,C=O.MapUtils,J=O.EnumPropertyType,z=O.EnumGraphicType,Y=O.EnumActions,j=mstrmojo.vi.enums.EnumFeatures,F=O.EnumBaseMapType,AG=mstrmojo.gmaps.EnumLayerZoneSource;var AE=true;function S(AK,AJ){return(!!AJ)&&AK.did===AJ.did;}mstrmojo.vi.models.MapDropZones=mstrmojo.declare(mstrmojo.vi.models.DropZonesModel,[mstrmojo.vi.models._DropZoneCommon],{help:"editor_panel_map.htm",dirtyVP:false,getHost:function l(AK){var AJ=this._super();if(!!AJ){return(AK!==true)?AJ.getEditingHost():AJ;}},getRequiredItemsInfo:function t(AK){if(!AK){return 0;}var AJ=[];this.getDropZones(true).zones.forEach(function(AL){if(AL){AJ=AJ.concat(AL.items);}});return Number(AJ.reduce(function(AL,AM){if(parseInt(AM.did,10)!==-1&&AM.t===AK){return AL+1;}return AL;},0));},getDropZones:function u(AJ,AQ){var AR=[],AP=this,AM=function(AT){switch(AT){case p.GeoAttribute:return mstrmojo.desc(13830);case p.Latitude:return mstrmojo.desc(13831);case p.Longitude:return mstrmojo.desc(13832);case p.SliceBy:return mstrmojo.desc(13833);case p.Angle:case p.SizeBy:return mstrmojo.desc(13829);case p.ColorBy:if(AP.isMapBox()){return mstrmojo.desc(11668);}return mstrmojo.desc(13829);case p.AdditionalMetrics:return mstrmojo.desc(11668);}return"";},AS=this.getHost(true),AN,AL,AK,AO;if(!AQ&&AS){AQ=AS.getEditingGridKey();}if(!C.checkDefined(AQ)){return{zones:AR};}AL=AS.getProperties(AQ);if(!AJ&&!mstrApp.isInVFConfigMode){AK=AS.getLayerZoneControl(AG.DROP_ZONE);if(AK){AK.n="Layers";AR.push(AK);}}AN=AS.getBaseMapType()===F.Image;AO=this.isMapBoxArea();U.forEach(this.getZonesCfg(),function(AU){if(AU.show(AL)){var AT=AU.n;if(AN){if(AU.id===p.Latitude){AT="Y";}else{if(AU.id===p.Longitude){AT="X";}}}AR.push(AP.getZone(AT,AU.id,AS.getDropZoneItems(AU.id,AQ),false,{allowSingle:AU.id===p.GeoAttribute&&AO?false:AU.allowSingle,title:AM(AU.id)}));}});if(!AJ){this.dropZones=AR;}return{n:AS.node.defn.ttl,zones:AR};},getZonesCfg:function AD(){return mstrmojo.vi.viz.MapHelper.zonesCfg;},getAllZones:function(AJ){return this.getDropZones(true,AJ).zones||[];},getClearAllUnitsActions:function P(AJ){var AK=[];(this.getAllZones(AJ)).forEach(function(AL){((AL&&AL.items)||[]).forEach(function(AM){Array.prototype.push.apply(AK,this.getRemoveDropZoneUnitActions(AL,AM));},this);},this);return AK;},getZone:function x(AQ,AP,AO,AL,AM){if((AP===p.Latitude||AP===p.Longitude)&&AO[0]&&(AO[0].t===21)){var AK=this.getHost(true).getEditingDropZoneItems(p.GeoAttribute),AJ=AK.length>0?AK[0].id:null,AN=b.findUnitsById(this.getHostModel().gsi,AJ)[0];if(AN){return this._super(AQ,AP,[{did:AO[0].id,t:21,n:AN.n+"@"+((AP===p.Latitude)?mstrmojo.desc(7696,"Latitude"):mstrmojo.desc(7697,"Longitude"))}],AL,AM);}}return this._super(AQ,AP,AO,AL,AM);},getUnitMenuItems:function r(AM,AV,AT,AU){if(!AT||!AV){return ;}var AP=AV.items,AS=AP.length,AJ=AV.id,AN={zone:AV,idx:n.indexOf(AP,AT),cnt:AS,item:AT,useDropzone:true},AY=this,AQ=this.id,AZ=mstrApp.isInVFConfigMode,AK=mstrmojo.resolveFeature(j.INSERT_NEW_METRIC),AR=this.docModel,AX=AT.did,AO=w.getDatasetFromAttributeId(AR.datasets,AX),AW=false;if(AT.t===H.DssTypeAttributeForm){return ;}if(AT.t===H.DssTypeMetric&&!AZ){if(AT.um){AM.addMenuItem(mstrmojo.desc(3224,"Edit..."),"",function(){AY.editDerivedMetric(AN,"edit");},AN);AM.addSeparator();}if(AK){if(AR.findDatasetIdFromUnit(AX)&&!AR.isFromSolrCube(AX)&&!AR.isFromMDXCube(AX)){AM.addSubMenuItem(mstrmojo.desc(11806,"Aggregate By"),"",AQ,AY.getAggregateByMetricSubMenu,AN);AM.addSeparator();}AM.addEditorMenuItem(mstrmojo.desc(5188,"Calculation"),AQ,AY.getCalculationEditorCfg,AN);AM.addMenuItem(mstrmojo.desc(13624,"Create Metric..."),"",function(){AY.newDerivedMetric(AN);},AN);}}else{if((!AO||!AR.isMDXDataset(AO))&&!AZ){if(AT.da){AM.addMenuItem(mstrmojo.desc(3224,"Edit..."),"",function(){AY.editDerivedAttribute(AN);},AN);AM.addSeparator();}if(AT.t===12){if(this.allowInsertNewAttribute(AV)&&!this.isDynamicLink(AT)&&AK){AM.addMenuItem(mstrmojo.desc(13625,"Create Attribute..."),"",function(){AY.newDerivedAttribute(AN);},AN);}}}if((AV.id===p.GeoAttribute||AV.id===p.SliceBy||AV.id===p.AdditionalMetrics)&&this.shouldShowDisplayFormsMenu(AT)){var Ab=this.getZoneModelByZoneId(p.GeoAttribute)||{},AL=this.getZoneModelByZoneId(p.Latitude)||{},Aa=this.getZoneModelByZoneId(p.Longitude)||{};if(this.isPolygonMap()||(n.find((Ab.items||[]).concat(AL.items||[]).concat(Aa.items),"did",AT.did)<0)){AM.addEditorMenuItem(mstrmojo.desc(11908,"Display Attribute Forms"),AQ,function(){return AY.getDisplayFormsMenu(AT);});}}}AM.addSeparator();if(this.showNumberFormat(AT)&&AJ!==p.GeoAttribute&&AJ!==p.Latitude&&AJ!==p.Longitude){AM.addEditorMenuItem(mstrmojo.desc(13237,"Number Format"),AQ,this.getNumberFormatEditorCfg,AN);AW=true;}if(AT.t===H.DssTypeMetric&&AJ===p.ColorBy){this.buildThresholdMenuOptions(AM,AN,true);AW=true;}if(AW){AM.addSeparator();}if(AY.hasReplaceCandidates(AN)&&(!(mstrApp.isAppStatePresentation&&mstrApp.isAppStatePresentation())||!!mstrmojo.resolveFeature(j.WEB_DRILL_AND_LINK))){AM.addSubMenuItem(mstrmojo.desc(14003,"Replace With"),"",AQ,AY.getReplaceSubMenu,AN);}AM.addMenuItem(mstrmojo.desc(1388,"Rename"),AQ,function(){mstrmojo.all[AQ].renameItem(AU,AT);});AM.addMenuItem(mstrmojo.desc(190,"Remove"),"xt",function(){mstrmojo.all[AQ].deleteItem(AV,AN.idx);});},isPolygonMap:function o(){var AJ=this.getEditingVp();return !!AJ&&(AJ[J.graphicType]===z.Area);},buildThresholdMenuOptions:function e(AK,AL,AJ){var AM=this.getHost();AM.model.buildThresholdMenuOptions(AK,AL,AJ,this.canSupportImageThreshold());},showNumberFormat:function N(AJ){var AK=this.getHost();return AK.model.showNumberFormat(AJ);},getNumberFormatEditorCfg:function k(AJ){var AK=this.getHost();return AK.model.getNumberFormatEditorCfg(AJ);},getAllowDropInfo:function B(AU,AO,AX,AM,AK){var AL=this._super(AU,AO,AX,AM,AK),AR=AL.allowedItems,AY=AM===Z.ON,AJ={max:1},AN=this.isMapBoxArea(),AQ,AP,AS,AV=this,AT=function(AZ,Aa){return n.filter(AR,function(Ab){return Aa?(Ab.t!==AZ):(Ab.t===AZ);},AJ);},AW=function(Ad){var Ac,Ab,AZ,Aa;switch(Ad){case p.AdditionalMetrics:Ac=AV.getZoneModelByZoneId(p.SliceBy);Ab=Ac&&Ac.items;Aa=AR&&AR[0];if(Aa&&AV.isAttribute(Aa)&&Ab&&Ab.length){AZ=n.some(Ab,function(Ae){return AR.length&&S(Aa,Ae);});if(!AZ||Ab.length>1){AR=AT(H.DssTypeAttribute,true);}}break;default:break;}};if(!AU){return AL;}switch(AU.id){case p.GeoAttribute:if(AN){AJ={max:2};}AR=AT(H.DssTypeAttribute);break;case p.Latitude:case p.Longitude:AR=AT(H.DssTypeAttribute);break;case p.SliceBy:AJ=null;AR=AT(H.DssTypeAttribute);break;case p.Angle:case p.SizeBy:AR=AT(H.DssTypeMetric);break;case p.ColorBy:if(this.isMapBox()){AR=AT(H.DssTypeAttributeForm,true);}else{AR=AT(H.DssTypeMetric);}break;case p.AdditionalMetrics:AJ=null;AR=AT(H.DssTypeAttributeForm,true);break;}if(AE){AW(AU.id);}AP=AY&&AU.items&&AU.items[AX]&&n.find(AR,"did",AU.items[AX].did)===-1;if(AN&&AU.id===p.GeoAttribute){if(!AR||AR.length<=0){AQ=[];}else{AS=(AU.items&&AU.items.length)||0;if(AS>=2){if(AP){AQ=[AR[0]];}else{AQ=[];}}else{if(AS===1){if(AY){AQ=AR;}else{AQ=n.filter(AR,function(AZ){return AZ.did!==AU.items[0].did;},{max:1});}}else{AQ=AR;}}}}else{AQ=(AJ&&AU.items&&!(AU.items.length<AJ.max||AY))?[]:AR;}return U.copy({allowedItems:AQ,removeReplaced:AP},AL);},getDropActions:function f(AW,AP,AL){if(!AW||!AP){return[];}var AT=AP.allowedItems,AS=AP.idx,AX=AT[0],AJ=AW.id,AQ=[],AY=function(Ae){var Af=null;n.forEach(Ae.fs||[],function(Ag){if(AF.isLatitude(Ag.fnm,Ag.fgr)&&Ag.obf){Af=Ag;return false;}});return Af;},AK=function(Ae){var Af=null;n.forEach(Ae.fs||[],function(Ag){if(AF.isLongitude(Ag.fnm,Ag.fgr)&&Ag.obf){Af=Ag;return false;}});return Af;};if(!AJ){return AQ;}AQ=AQ.concat(this.getCreateDropZonesAction(AJ));if(this.hasLatLngZone()&&AJ===p.GeoAttribute){var AN=AY(AX),Ac=AK(AX);if(!AN||!Ac){if(AN&&AF.isLatitude(AX.n)){AJ=p.Latitude;AW=this.getZoneModelByZoneId(AJ);}else{if(Ac&&AF.isLongitude(AX.n)){AJ=p.Longitude;AW=this.getZoneModelByZoneId(AJ);}}}}if(!AW){return AQ;}if(AP.edge===Z.ON&&AP.removeReplaced){var AO=this.getRemoveDropZoneUnitActions(AW,AW.items[AS]);if(AO){AQ=AQ.concat(AO);if((AJ===p.Latitude||AJ===p.Longitude)&&AW.items[0].t===21){var AM=this.getZoneModelByZoneId(p.GeoAttribute),Ad=AM&&AM.items;if(Ad&&Ad[0]){AQ=AQ.concat(this.getRemoveDropZoneUnitActions(AM,Ad[0]));}AM=this.getZoneModelByZoneId(AW.id===p.Latitude?p.Longitude:p.Latitude);Ad=AM&&AM.items;if(Ad&&Ad[0]&&Ad[0].t===21){AQ=AQ.concat(this.getRemoveDropZoneUnitActions(AM,Ad[0]));}}}}var Aa=this.getDropTargetIndex(AW,AP);n.insert(AQ,null,this.getAddDropZoneUnitsActions(AW,AT,Aa,{datasetId:AL}));this.checkExistingUnitsToRemove(AJ,AT,AQ);this.checkAndAddThresholdAction(AJ,AX,AQ);if(this.isMapBox()){AQ=this.checkAndAddToTooltipZone(AJ,AT,AQ,{datasetId:AL});}var Ab=function(Ae){AQ.push({act:"addForm",unitId:AX.did,attFormId:Ae.fid,unitPos:1});};if(AJ===p.GeoAttribute){this.addClearZoneAction(AQ,p.Latitude);this.addClearZoneAction(AQ,p.Longitude);var AV=AY(AX),AR=this.getZoneModelByZoneId(p.Latitude),AZ=AK(AX),AU=this.getZoneModelByZoneId(p.Longitude);if(AV){Ab(AV);if(AR){AQ=AQ.concat(this.getAddDropZoneUnitsActions({id:p.Latitude},[{did:AV.fid,t:21}],0,{datasetId:AL}));}}if(AZ){Ab(AZ);if(AU){AQ=AQ.concat(this.getAddDropZoneUnitsActions({id:p.Longitude},[{did:AZ.fid,t:21}],0,{datasetId:AL}));}}}else{if(AJ===p.Latitude||AJ===p.Longitude){this.addClearZoneAction(AQ,p.GeoAttribute);}}return AQ.length?this.getUpdateTemplateAction(AQ):[];},addClearZoneAction:function W(AL,AJ){var AK=this.getZoneModelByZoneId(AJ);if(AK&&AK.items&&AK.items.length){Array.prototype.push.apply(AL,this.getRemoveDropZoneUnitActions(AK,AK.items[0]));}},unitsDropped:function AC(AO,AJ,AQ){var AM=AJ.src.data,AK=AJ.actions||[],AL=AQ.allowedItems,AP=this,AS=AP.docModel,AT=AP.getHost(),AN,AR=AT&&AT.getData();this.addAttributeNameAndTargetVisForAddUnits(AR,AL);this.checkAndWarnLargeItemsForAddUnits(AL,function(){AN=AK.concat(AP.getDropActions(AO,AQ,AM.dsid));AS.checkAndNotifyVFChangeOnDZUnitsUpdate({actions:AN,zm:AP},function(){var AU=AS.wrapUnsetVisualizationFilterAction(AN);AP.submitDropZoneUpdates(AU,AJ.callback);},function(){AP.submitDropZoneUpdates(AN,AJ.callback);});});},checkAndAddThresholdAction:function AB(AO,AM,AN){var AL=this.getHost(),AK=["#abcffa","#7ca8de","#4570af","#224b8f","#0e3270"],AJ=[0.2,0.4,0.6,0.8];if(this.isMetric(AM)&&AO===p.ColorBy){M.addThresholds(AL.model,AL,AL.model,AM,AN,AK,AJ);return true;}return false;},checkExistingUnitsToRemove:function Q(AL,AX,AS){var AQ=this.getZoneModelByZoneId(p.GeoAttribute),AY=this.getZoneModelByZoneId(p.Latitude),AP=this.getZoneModelByZoneId(p.Longitude),AJ=this.getZoneModelByZoneId(p.Angle),AV=this.getZoneModelByZoneId(p.ColorBy),AO=this.getZoneModelByZoneId(p.SizeBy),AZ=this.getZoneModelByZoneId(p.SliceBy),Ai=this.getZoneModelByZoneId(p.AdditionalMetrics),AW=AQ&&AQ.items.length&&AQ.items,Al=AY&&AY.items.length&&AY.items[0],Ad=AP&&AP.items.length&&AP.items[0],AU=AJ&&AJ.items.length&&AJ.items[0],Ah=AV&&AV.items.length&&AV.items[0],Ab=AO&&AO.items.length&&AO.items[0],Af=AZ&&AZ.items.length&&AZ.items,AT=this.isMapBox()?[]:(Ai&&Ai.items.length&&Ai.items),Aj=this,AK=function(An,Am){Array.prototype.push.apply(AS,Aj.getRemoveDropZoneUnitActions(An,Am));},Ag,AM,AN,Ak,Ac,AR,Aa,Ae;switch(AL){case p.AdditionalMetrics:if(!this.isMapBox()){for(Ac=0,AR=AX.length;Ac<AR;Ac++){Ag=AX[Ac];if(this.isMetric(Ag)){if(Ah&&S(Ag,Ah)){AK(AV,Ah);}if(Ab&&S(Ag,Ab)){AK(AO,Ab);}if(AU&&S(Ag,AU)){AK(AJ,AU);}}else{if(Af){for(Aa=0,Ae=Af.length;Aa<Ae;Aa++){AN=Af[Aa];if(AN&&S(Ag,AN)){AK(AZ,AN);}}}if(AW){for(Aa=0,Ae=AW.length;Aa<Ae;Aa++){Ak=AW[Aa];if(Ak&&S(Ag,Ak)){AK(AQ,Ak);this.addClearZoneAction(AS,p.Latitude);this.addClearZoneAction(AS,p.Longitude);}}}if(Al&&S(Ag,Al)){AK(AY,Al);}if(Ad&&S(Ag,Ad)){AK(AP,Ad);}}}}break;case p.ColorBy:case p.SizeBy:case p.Angle:Ag=AX[0];if(this.isMetric(Ag)&&AT){for(Ac=0;Ac<AT.length;Ac++){AM=AT[Ac];if(S(Ag,AM)){AK(Ai,AM);}}}break;case p.SliceBy:for(Ac=0,AR=AX.length;Ac<AR;Ac++){Ag=AX[Ac];if(this.isMetric(Ag)){continue;}if(AT){for(Aa=0,Ae=AT.length;Aa<Ae;Aa++){AM=AT[Aa];if(!this.isMetric(AM)&&(AE||S(Ag,AM))){AK(Ai,AM);}}}if(AW){for(Aa=0,Ae=AW.length;Aa<Ae;Aa++){Ak=AW[Aa];if(Ak&&S(Ag,Ak)){AK(AQ,Ak);this.addClearZoneAction(AS,p.Latitude);this.addClearZoneAction(AS,p.Longitude);}}}if(Al&&S(Ag,Al)){AK(AY,Al);}if(Ad&&S(Ag,Ad)){AK(AP,Ad);}}break;case p.GeoAttribute:for(Ac=0,AR=AX.length;Ac<AR;Ac++){Ag=AX[Ac];if(!this.isMetric(Ag)){if(AT){for(Ac=0;Ac<AT.length;Ac++){AM=AT[Ac];if(S(Ag,AM)){AK(Ai,AM);}}}if(Af){for(Aa=0,Ae=Af.length;Aa<Ae;Aa++){AN=Af[Aa];if(AN&&S(Ag,AN)){AK(AZ,AN);}}}if(Al&&S(Ag,Al)){AK(AY,Al);}if(Ad&&S(Ag,Ad)){AK(AP,Ad);}}}break;case p.Latitude:Ag=AX[0];if(!this.isMetric(Ag)){if(AT){for(Ac=0;Ac<AT.length;Ac++){AM=AT[Ac];if(S(Ag,AM)){AK(Ai,AM);}}}if(Af){for(Aa=0,Ae=Af.length;Aa<Ae;Aa++){AN=Af[Aa];if(AN&&S(Ag,AN)){AK(AZ,AN);}}}if(Ad&&S(Ag,Ad)){AK(AP,Ad);}}break;case p.Longitude:Ag=AX[0];if(!this.isMetric(Ag)){if(AT){for(Ac=0;Ac<AT.length;Ac++){AM=AT[Ac];if(S(Ag,AM)){AK(Ai,AM);}}}if(Af){for(Aa=0,Ae=Af.length;Aa<Ae;Aa++){AN=Af[Aa];if(AN&&S(Ag,AN)){AK(AZ,AN);}}}if(Al&&S(Ag,Al)){AK(AY,Al);}}break;default:break;}},checkAndAddToTooltipZone:function A(AN,AL,AO,AJ){var AK=this.getZoneModelByZoneId(p.AdditionalMetrics),AM=n.map(n.ensureArray(AK&&AK.items),function(AP){return AP&&AP.did;});AL=n.filter(AL,function(AP){return AF.shouldSyncItemToTooltipZone(AP.did,AN,AM);});if(AL.length>0){AO=AO.concat(this.getAddDropZoneUnitsActions({id:p.AdditionalMetrics},AL,this.getItemCountInZone(p.AdditionalMetrics),AJ));}return AO;},getAvatarIconClass:function d(){return"viMap";},getActionsForDeleteItem:function q(AM,AK){var AP=this.getRemoveDropZoneUnitActions(AM,AM.items[AK]);if(AM.id===p.GeoAttribute){var AL=this.getZoneModelByZoneId(p.Latitude),AO=AL&&AL.items&&AL.items[0],AJ=this.getZoneModelByZoneId(p.Longitude),AN=AJ&&AJ.items&&AJ.items[0];if(AO){AP=AP.concat(this.getRemoveDropZoneUnitActions({id:p.Latitude},AO));}if(AN){AP=AP.concat(this.getRemoveDropZoneUnitActions({id:p.Longitude},AN));}}return AP;},deleteItem:function I(AK,AJ){var AM=this,AL=AM.docModel;AL&&AL.checkAndNotifyVFChangeOnDZUnitsUpdate({ca:[AK.id],zm:AM},function(){var AN=AM.getActionsForDeleteItem(AK,AJ);AM.submitDropZoneUpdates(AL.wrapUnsetVisualizationFilterAction((AN&&AN.length>0)?AM.getUpdateTemplateAction(AN):[]));},function(){AM.submitDropZoneTemplateUpdates(AM.getActionsForDeleteItem(AK,AJ));});},deleteItems:function I(AJ,AK){var AN=[],AO=this.id,AM=this,AL=AM.docModel;AK.forEach(function(AQ){var AP=mstrmojo.all[AO];if(AP){AN=AN.concat(AP.getRemoveDropZoneUnitActions(AJ,AQ));}});AL&&AL.checkAndNotifyVFChangeOnDZUnitsUpdate({ca:[AJ.id],zm:AM},function(){AM.submitDropZoneTemplateUpdates(AL.wrapUnsetVisualizationFilterAction(AN||[]));},function(){AM.submitDropZoneTemplateUpdates(AN||[]);});},getEditingVp:function R(){var AJ=this.getHostModel();if(AJ){return AJ.vp;}},hasLatLngZone:function c(){var AJ=this.getEditingVp(),AK=AJ&&AJ[J.graphicType];return !!AK&&AK!==z.Area;},isMapBox:function h(){var AJ=this.getHost(true);return AJ.scriptClass==="mstrmojo.mapbox.VisMapbox";},isMapBoxArea:function AI(){var AK=this.getHost(true),AJ=this.getEditingVp();return AK.getBaseMapType()===F.Mapbox&&AJ&&AJ[J.graphicType]===z.Area;},getWidgetPropsAction:function L(){var AJ=this.getHost(true),AK;AJ.modelData=this.getHostModel();AK=AJ.getSetPropertiesAction();delete AJ.modelData;return AK&&AK[0];},getHostModel:function(){var AJ=this.getHost(true);if(AJ&&(AJ.getEditingGridData instanceof Function)){return AJ.getEditingGridData();}},getAddDropZoneUnitsActions:function AH(AK,AL,AJ,AM){var AO=[],AN=this;AL.reverse().forEach(function(AP){g.call(AN,AN.getHostModel().vp,{item:AP,idx:AJ,zone:AK},"onAdd");AO.push(AN.getAddDropZoneUnitAction(AK,AP,AJ,AM));});return AO;},getAddItemActions:function(AL,AM,AJ,AN){var AK=this.getAddDropZoneUnitsActions(AL,AM,AJ,{datasetId:AN});this.checkAndAddThresholdAction(AL.id,AM[0],AK);return AK;},getRemoveDropZoneUnitActions:function E(AK,AL){var AM=this._super(AK,AL),AJ=n.find(AK.items,"did",AL.did);g.call(this,this.getHostModel().vp,{item:AL,idx:AJ,zone:AK},"onDel");return AM;},submitDropZoneUpdates:function v(AO,AP,AK){var AN=this.getHost(true),AL=this.getHost(),AJ={};if(!AL||!AN){return ;}AO=[].concat(AO||[]);if(this.dirtyVP){AO.push(this.getWidgetPropsAction());this.dirtyVP=false;}AN.syncLayerProperties(AL.model.data.vp,AJ);var AM=AP||AL.model.docModel.controller._getXtabCallback(AL);this._super(AO,AM,AK);},isShowAllRows:function G(AK){var AJ=U.walk("model.data.gsi.prop.sar",AK);return AJ===undefined||AJ==="-1";},checkAttributeChanges:function K(AL){var AS=false,AR=this.getHost(),AP=n.ensureArray(AL),AJ=function(AT){return AT&&(((AT.act===Y.add||AT.act===Y.remove)&&(AT.unitType===H.DssTypeAttribute||AT.unitType===H.DssTypeAttributeForm))||(AT.act===Y.addForm||AT.act===Y.removeForm));},AO,AN,AQ,AK,AM;if(!this.isShowAllRows(AR)){AR.useRefresh=false;return ;}for(AN=0,AQ=AP.length;AN<AQ;AN++){if(AP[AN]&&AP[AN].act==="updateTemplate"){AO=AP[AN].actions;if(!n.isArray(AO)){continue;}for(AK=0,AM=AO.length;AK<AM;AK++){if(AJ(AO[AK])){AS=true;break;}}if(AS===true){break;}}}AR.useRefresh=!AS;},canSupportImageThreshold:function X(){var AK=this.getHost(),AL=AK&&AK.model&&AK.model.data,AJ=AL&&AL.vp;return AF.supportImageThreshold(AJ);},getCreateDropZonesAction:function a(AK){var AL=this.getHost(true),AJ=AL&&AL.getEditingDz(),AM=[];if(!C.checkDefined(AK)||!C.checkDefined(AJ)){return AM;}if(AK===p.SliceBy&&(AJ.SliceBy===undefined)){AM.push(this.getCreateDropZoneAction(p.SliceBy,3,34,-1));}if(AK===p.Angle&&(AJ.AngleBy===undefined)){AM.push(this.getCreateDropZoneAction(p.Angle,4,4,1));}return AM;},getCreateDropZoneAction:function D(AK,AJ,AL,AP){var AO=this.getHost(true),AM,AN;if(!AO){return{};}AM=AO.getEditingGridKey();AN=AO.defn&&AO.defn.tt;if(!AM||!AN){return{};}return{act:"createDefaultDropZone",treeType:AN,nodeKey:AM,zoneId:AK,dropzone_index:AJ,dropzone_types:AL,dropzone_sizelimit:AP};},hasReplaceCandidates:function(AJ){return(!AJ||!AJ.zone)?null:this._super(AJ);},destroy:function AA(AL){var AJ=this.dropZones,AK=AJ&&AJ[0];if(AK&&AK.destroy){AK.destroy(AL);AJ.splice(0,1);}this._super(AL);}});function g(AK,AL,AM){var AJ=AL.zone.id;if(AJ===p.GeoAttribute&&AL.idx>0){return ;}n.forEach(this.getZonesCfg(),function(AN){if(AN.id===AJ){AN[AM](AK,AL);return false;}});this.dirtyVP=true;}}());(function(){mstrmojo.requiresCls("mstrmojo.vi.models.DropZonesModel","mstrmojo.vi.models.EnumDragSources","mstrmojo.vi.viz.EnumDSSDropZones","mstrmojo.func","mstrmojo.vi.ui.DatasetUnitMenuUtils","mstrmojo.vi.models._DropZoneCommon");var O=mstrmojo.array,Y=mstrmojo.func,I=mstrmojo.vi.models.DropZonesModel.ENUM_TARGET_POSITION,d=mstrmojo.vi.models.EnumDragSources,J=mstrmojo.vi.ui.DatasetUnitMenuUtils,D=mstrmojo.vi.viz.EnumDSSDropZones,B=D.GeoAttribute,L=D.SizeBy,U=D.ColorBy,K=D.Layout,b=D.AdditionalMetrics,A=mstrmojo.vi.util.ThresholdUtils,H=mstrmojo.vi.enums.EnumFeatures,E=["#65D22B","#FFC561","#FF9547","#FF5824","#CC1D1D"],R=[0.2,0.4,0.6,0.8],C=mstrmojo.VisEnum.IMAGELAYOUT_PROPERTIES;var P="0",c="1",G="2";mstrmojo.vi.models.ImageLayoutDropZones=mstrmojo.declare(mstrmojo.vi.models.DropZonesModel,[mstrmojo.vi.models._DropZoneCommon],{getHostModel:function M(){return this.getHost().model.data;},getDisplayMode:function Q(){var e=this.getHost().propertyManager;return e.getFormatPropertyValue(C.DISPLAY_MODE);},isZoneAvalaible:function X(e){if(e===L){return this.getDisplayMode()!==c;}return true;},getDropZones:function V(){var g=this.getDZFlatStruct(),f={allowSingle:true},e=[this.getZone(mstrmojo.desc(11661,"Geo Attribute"),B,g.GeoAttribute||g.Geo,false,f),this.getZone(mstrmojo.desc(11662,"Color By"),U,g.ColorBy,false,f),this.getZone(mstrmojo.desc(11663,"Size By"),L,g.SizeBy,this.getDisplayMode()===c,f),this.getZone(mstrmojo.desc(2962,"Tooltip"),b,g.AdditionalMetrics),this.getZone(mstrmojo.desc(14473,"Path To Map"),K,g.Layout||g.layout,false,f)];this.dropZones=e;return{n:this.getHost().defn.ttl,zones:e};},getUnitMenuItems:function a(j,m,t,p){var o=this,h=this.id,u=this.isMetric(t),l=m.items,f=l.length,e={zone:m,idx:O.find(l,"id",t.id),cnt:f,item:t,useDropzone:true},k=mstrApp.isInVFConfigMode,q=t.did,r=this.docModel,g=J.getDatasetFromAttributeId(r.datasets,q),n=mstrmojo.resolveFeature(H.INSERT_NEW_METRIC);if(u&&!k){if(t.um){j.addMenuItem(mstrmojo.desc(3224,"Edit..."),"",function(){o.editDerivedMetric(e,"edit");},e);j.addSeparator();}if(n){if(r.findDatasetIdFromUnit(q)&&!r.isFromSolrCube(q)&&!r.isFromMDXCube(q)){j.addSubMenuItem(mstrmojo.desc(11806,"Aggregate By"),"",h,o.getAggregateByMetricSubMenu,e);j.addSeparator();}j.addEditorMenuItem(mstrmojo.desc(5188,"Calculation"),h,o.getCalculationEditorCfg,e);j.addMenuItem(mstrmojo.desc(13624,"Create Metric..."),"",function(){o.newDerivedMetric(e);},e);}}else{if((!g||!r.isMDXDataset(g))&&!k){if(t.da){j.addMenuItem(mstrmojo.desc(3224,"Edit..."),"",function(){o.editDerivedAttribute(e);},e);j.addSeparator();}if(!this.isDynamicLink(t)&&n){j.addMenuItem(mstrmojo.desc(13625,"Create Attribute..."),"",function(){o.newDerivedAttribute(e,!o.allowInsertNewAttribute(m));},e);}}}j.addSeparator();if(this.shouldShowDisplayFormsMenu(t)){j.addEditorMenuItem(mstrmojo.desc(11908,"Display Attribute Forms"),this.id,function(){return o.getDisplayFormsMenu(t);});}if(this.showNumberFormat(t)){j.addEditorMenuItem(mstrmojo.desc(13237,"Number Format"),h,this.getNumberFormatEditorCfg,e);}if(u){if(m.id===U){this.buildThresholdMenuOptions(j,e,true);}}j.addSeparator();j.addMenuItem(mstrmojo.desc(1388,"Rename"),"",function(){o.renameItem(p,t);});j.addMenuItem(mstrmojo.desc(190,"Remove"),"xt",function(){o.deleteItem(m,o.getUnitIndexInZone(m,t));});},getAllowDropInfo:function N(o,k,t,h,f){var q=this,g=this._super(o,k,t,h,f),n=g.allowedItems,l=f.src.data,e=l.src===d.VIZ_EDITOR?l.srcZoneId:null,u=h===I.ON,m=true,p=true,j=this.getZoneModelByZoneId(U).items,r=this.getZoneModelByZoneId(L).items;switch(o.id){case B:case K:m=false;break;case b:p=false;break;}return mstrmojo.hash.copy({allowedItems:(p&&!(o.items.length===0||u))?[]:O.filter(n,function(w){var v=q.isMetric(w);return m?v:!v;},p?{max:1}:null),removeReplaced:u&&(p||O.find(k,"did",o.items[t].did)===-1)},g);},getAddDropZoneUnitsActions:function F(f,g,e,h){var k=f.id,j;j=this._super(f,g,e,h);if(k===U){this.checkAndAddThresholdAction(U,g[0],j);}return j;},unitsDropped:function Z(o,e,q){var l=e.src.data,h=e.actions||[],j=[],t=q.idx,f=q.edge,k=q.allowedItems,n=o.id,p=this,m,g,r=function(v){var w=p.getZoneModelByZoneId(v),u=O.intersection(w.items,k,"did");u.forEach(function(x){j=j.concat(p.getRemoveDropZoneUnitActions(w,x,1));});};switch(n){case L:r(b);break;case U:r(b);break;case b:r(L);r(U);break;}if(f===I.ON&&q.removeReplaced){j=j.concat(this.getRemoveDropZoneUnitActions(o,o.items[t]));}O.insert(j,null,this.getAddDropZoneUnitsActions(o,k,this.getDropTargetIndex(o,q),{datasetId:l.dsid}));m=h.concat(this.getUpdateTemplateAction(j));g=function(u){return function(){var v=u?p.docModel.wrapUnsetVisualizationFilterAction(m):m;p.submitDropZoneUpdates(v,Y.wrapMethods(e.callback,p.getHost().model.docModel.controller._getXtabCallback(p.getHost())));};};p.docModel.checkAndNotifyVFChangeOnDZUnitsUpdate({actions:m,zm:p},g(true),g(false));},checkAndAddThresholdAction:function W(h,f,g){var e=this.getHost();if(h===U&&this.isMetric(f)){A.addThresholds(e.model,e,e.node,f,g,E,R,false);return true;}return false;},deleteItem:function S(f,e){var h=this,g=h.docModel;g&&g.checkAndNotifyVFChangeOnDZUnitsUpdate({ca:[f.id],zm:h},function(){var j=h.getRemoveDropZoneUnitActions(f,f.items[e]);j=g.wrapUnsetVisualizationFilterAction((j&&j.length>0)?h.getUpdateTemplateAction(j):[]);h.submitDropZoneUpdates(j);},function(){h.submitDropZoneTemplateUpdates(h.getRemoveDropZoneUnitActions(f,f.items[e]));});}});}());(function(){mstrmojo.requiresCls("mstrmojo.Container","mstrmojo.Label","mstrmojo.mstr.EnumWebAPIErrorCodes","mstrmojo.vi.enums.EnumFeatures","mstrmojo.vi.ui.DatasetObjects","mstrmojo.vi.ui.DocDatasetUnitList","mstrmojo.vi.ui.toolbars._HasToolbar","mstrmojo.util.ui._HostsSplitter","mstrmojo.ui.menus._HasMenuPopup","mstrmojo.vi.ui.toolbars._HasToolbar","mstrmojo.ui.menus.MenuConfig","mstrmojo.ui.menus.ToolbarConfig","mstrmojo.IVEDatasetPicker","mstrmojo.vi.ui.PanelContents","mstrmojo.vi.ui.PanelPortlet","mstrmojo.vi.ui.DatasetUnitMenuUtils","mstrmojo.vi.ui.SelectDatasetWizardEditor","mstrmojo.vi.ui.ReplaceObjectEditor","mstrmojo.ui.ScrollableContainer","mstrmojo.fe.FilterEditor","mstrmojo.fe.FilterUtils","mstrmojo.array","mstrmojo.hash","mstrmojo.form","mstrmojo.func","mstrmojo.dom","mstrmojo.Button","mstrmojo.mstr.EnumFunction","mstrmojo.DocDataService","mstrmojo.SaveAsEditor","mstrmojo.vi.ui.ViewDataDialog","mstrmojo.vi.ui.DatasetEditor","mstrmojo.onetier.vi.prefs.DesktopConnectivityProxy","mstrmojo.onetier.vi.prefs.HostedDesktopConnectivityProxy","mstrmojo.DI.DIConstants","mstrmojo.DI.DIHelpers","mstrmojo.vi.enums.EnumDSSAccessRightFlags","mstrmojo.vi.enums.EnumFeatures","mstrmojo._HasPopup","mstrmojo.Popup","mstrmojo.CheckBox","mstrmojo.ui.PopupConfig","mstrmojo.storage.DOMLocalStorage");mstrmojo.requiresDescs(16029,16030);var a=mstrmojo.hash,m=mstrmojo.array,AN=mstrmojo.func,Y=mstrmojo.dom,P=mstrmojo.vi.ui.DatasetUnitMenuUtils,AA=mstrmojo.DI.DIConstants,o=mstrmojo.Button.newWebButton,q=mstrmojo.DI.DIHelpers,AQ=mstrmojo.chart.model.enums.EnumDSSObjectType,R={IN_MEMORY:1,DIRECT_ACCESS:2},g={SupportDDAOrInMemory:1,SupportInMemoryOnly:2,SupportDDAOnly:3},AF={style:{params:{treesToRender:1}}},l={att:AQ.DssTypeAttribute,mx:AQ.DssTypeMetric},AB=mstrmojo.warn,n=mstrmojo.vi.enums.EnumDSSAccessRightFlags,V=mstrmojo.mstr.EnumWebAPIErrorCodes,k=mstrmojo.vi.enums.EnumFeatures,j=mstrmojo.DocDataService.REQUEST_DEFN_DATA;var L="dontShowAddDataHint";function AP(AX,AZ,AY,AW){AY.getDataService().checkMissingCredentials({dsid:AZ},{success:function(Aa){var Ab=AW&&AW.callback;if(Aa.success){if(Ab&&Ab.success){Ab.success();}}else{if(Ab&&Ab.failure){Ab.failure(Aa);}else{mstrmojo.confirm(mstrmojo.desc(14396,"Some credentials are missing for the selected dataset. You will have to enter these credentials in order to proceed. Do you want to continue?"),{confirmBtn:{fn:function(){window.setTimeout(function(){if(AX&&AX.showDataImport){AX.showDataImport({documentModel:Aa,StatusCode:4,callback:function(){AP(AX,AZ,AY,AW);}});}},0);return true;}},cancelBtn:{t:mstrmojo.desc(2140,"Cancel"),fn:mstrmojo.emptyFn}},{title:mstrmojo.desc(1695,"Warning")});}}},failure:function(Aa){mstrmojo.alert(Aa);}});}function F(){return mstrApp.isSingleTier?new mstrmojo.onetier.vi.prefs.DesktopConnectivityProxy():new mstrmojo.onetier.vi.prefs.HostedDesktopConnectivityProxy();}function f(AW){this.model.cmdMgr().execute({execute:function(){AW(this);}});}function G(AW){return mstrmojo.resolveFeature(AW);}function p(){return !G("single-workingset");}function c(Aa){var AZ=Aa.st===779,AW=Aa.mngd,AY=this.model,AX=AY.isFromFile(Aa);return(AW&&AZ&&AX)||((!Aa.hcs||Aa.idd)&&!(Aa.tables&&Aa.tables[0]&&Aa.tables[0].xdaType===400));}function AO(AW){var AZ=AW.id||"mstrIVE_DS",AX=mstrmojo.all[AZ];if(!AX){AX=new mstrmojo.IVEDatasetPicker({id:AZ,onOk:mstrmojo.emptyFn,onCancel:mstrmojo.emptyFn,onPreClose:function(){this.onCancel();return true;},onRender:function AY(){var Ab=false;this.btnImport.set("visible",Ab);this.newLabel.set("visible",Ab);this.useExistingLabel.set("visible",Ab);this.ob.set("scrollableIncFetch",true);this.btnHBox.destroyChildren();var Aa=o(mstrmojo.desc(547,"Select"),function(){if(this.enabled){AX.onOk();AX.close();}},true);Aa.bindings={enabled:function(){return this.parent.parent.multiSelect?!!this.parent.parent.selectedItems.length:!!this.parent.parent.item;}};this.btnHBox.addChildren([Aa,o(mstrmojo.desc(221,"Cancel"),function(){AX.onCancel();AX.close();},false)]);}});if(AW.title){AX.set("title",AW.title);}}a.forEach(AW,function(Ab,Aa){AX.set(Aa,Ab);});return AX;}function AV(AY,AX){var AW=this;return function(){mstrApp.rootCtrl.docCtrl.openDME(AW,{metricId:"",editorId:"mstrME",action:{cmd:"editNew"},disableAFB:AX.isMDXDataset(AY)},AX.getDataService().getAddNewDerivedMetricToDatasetSubmitFunc({dsid:AY.did}));};}function AE(AY,AX){var AW=this;return function(){mstrApp.rootCtrl.docCtrl.openDAE(AW,{dsid:AY,datasets:AX},mstrmojo.emptyFn);};}function z(AX,AZ){var AY=new mstrmojo.ui.menus.MenuConfig(),AW=[{n:mstrmojo.desc(14476,"Primary (outer join)"),v:1},{n:mstrmojo.desc(14477,"Secondary (inner join)"),v:0}];AW.forEach(function(Aa){AY.addMenuItem(Aa.n,Aa.v===AZ.ipm?"on":"",function(){var Ab=AX.controller,Ac=Ab.getRefreshCallback();Ab.cmdMgr.execute({execute:function(){this.submit([{act:"setJoinBehavior",dsid:AZ.did,dst:AZ.type,prm:Aa.v}],Ac,{style:{params:{treesToRender:3}}});},urInfo:{callback:Ac}});});});AY.hasToggleItem=true;return AY;}function M(AW,AX,Ab,Aa){var AZ={taskId:"mojoGetDocumentManifest"},AY=function(Ad){var Ae=[],Ac=1;a.forEach(AW.data,function(Af){Ad.forEach(function(Ag){if(Ac===parseInt(Ag,10)){Ae.push(Af);}});Ac++;});return Ae;};if(Aa){AZ.dsid=Aa;}AX.getDataService().submitUpdates({},{success:function(Ae){var Ac=[],Af={},Ad={};a.forEach(AW.data,function(Ag){Ag.att.concat(Ag.mx).forEach(function(Ah){Af[Ah.did]=Ah;});});Ae.manifest_objects.forEach(function(Ag){if(Af[Ag.did]){Ag.cubes=AY(Ag.cube_ids||[]);Ac.push(a.copy(Af[Ag.did],Ag));Ad[Ag.did]=Ag;}});Ae.manifest_objects.forEach(function(Ag){if(Ag.dependents){Ag.dependentObjects=[];Ag.dependents.forEach(function(Ah){Ag.dependentObjects.push(Ad[Ah]);});}});Ac=P.getSortedDatasetUnits(Ac);Ab(Ac);},failure:function(){AX.cmdMgr().onFailure();}},{params:AZ,preserveUndo:true});}function b(AW,AY,AZ){var AX=AW.datasets[AY];if(AX){AZ(AX);}else{AW.getDataService().submitUpdates({},{success:function(Aa){AZ(Aa);},failure:function(){AW.cmdMgr().onFailure();}},{params:{taskId:"mojoGetReportWorkingSet",reportId:AY,chkViewReport:1},preserveUndo:true});}}function r(AX){var AW=a.clone(AX.att.concat(AX.mx));AW.forEach(function(AY){if(AY.hc){AY.cont_did=AX.did;AY.cont_tp=AX.type;}});return m.filter(AW,function(AY){return !AY.um;});}function X(AY,AZ,AX,Aa,AW,Ab){return function Ac(Af,Ag){var Aj=[{act:"applyReconciliation",clr_af:Ag,clr_fs:false,members:Af,disablePU:true}].concat(AW);if(!!Aa.isOneTierCubeImport){Aj[0].sourceId=(AX?"all":Aa.source.did);}if(AX){a.forEach(AY.data,function(Al,Ak){Af.unshift({srcid:Ak,srct:3,tgtid:Aa.target.did,tgtt:3});});}else{Af.unshift({srcid:Aa.source.did,srct:3,tgtid:Aa.target.did,tgtt:3});}var Ai=AZ.cmdMgr(),Ah=Ai.getInterimCmd(),Ae=AZ.controller.getRefreshCallback(),Ad=AN.wrapMethods(Ae,(Ab||mstrmojo.emptyFn));if(Ah){Ah.urInfo.callback=Ae;Ah.submit(Aj,Ad,j,Ai.CMD_PHASE.LAST);}else{Ai.execute({execute:function(){this.submit(Aj,Ad,j);},urInfo:{callback:Ae}});}};}function AS(AZ,Ad){var Ag=AZ.model,Ah="mstrReconReplaceEditor",Ac=null,Ae=function Ae(){var Aj=Ag.cmdMgr().getInterimCmd();if(Aj){var Ai=Aj.urInfo;Ai.callback={success:mstrmojo.emptyFn};Ai.treesToRender=0;Aj.cancel();}},AW=function(Ai){if(!Ac){Ac=mstrmojo.all[Ah]||mstrmojo.insert({scriptClass:"mstrmojo.vi.ui.ReplaceObjectEditor",id:Ah});}Ac.set("showUnitTooltip",Ad);Ac.setUnits({source:Ai.source,target:Ai.target});D(a.keyarray(Ag.datasets).filter(function(Aj){return Aj===Ai.target.did;}).map(function(Aj){return{dsid:Aj,collapsed:false};}),AZ);Ac.onOk=X(AZ,Ag,Ad,Ai,AZ.settings.getSaveActions(),{failure:function(){Ac.open();}});Ac.onCancel=Ae;Ac.set("onBack",Ai.onBack||mstrmojo.emptyFn);Ac.open();},AY=function(Ai){window.setTimeout(function(){AZ.showDataImport({isEdit:false,AnalysisId:Ag.mid,callback:function Aj(Ak){if(Ak){var Al=Ak[0];if(Al.mngd){if(!mstrApp.isSingleTier){Ag.cmdMgr().getInterimCmd().resetCmdMgrOnComplete();}Ai(Al);}else{b(Ag,Al.did,Ai);}}else{Ae();}}});},0);},Ab=function(Ai){Ag.controller.createDataset({isParam:true,modifiedItems:{create:{act:"createDataset",mgo:true,prm:true,noRowCount:1,newObjectIds:["$GUID_141"]},add:[],del:[],fs:{add:[],del:[]},filter:null},onOk:function(Ao){var Al=this,An=Ag.cmdMgr(),Am=An.getInterimCmd(),Aj={success:function(Ap){a.forEach(Ap.datasets,function(Aq,Ar){if(!Ag.datasets[Ar]){Ap.datasets[Ar].did=Ar;Ai(Ap.datasets[Ar]);}});Al.close();},failure:function(Ap,Aq){this.canceled(Aq.id);}},Ak={skipUICmdMgrOnFailure:v()};if(Am){Am.submitInterim(Ao,Aj,Ak);}else{An.execute({execute:function(){this.submit(Ao,Aj,Ak);}});}},closeOnSubmit:false,onCancel:Ae});},Aa=function(Ai){Ag.controller.addDataset({isParam:true,id:"mstrReconDatasetPicker",title:mstrmojo.desc(11940,"Select Existing Dataset"),multiSelect:false,onOk:function(Aj){b(Ag,Aj||this.item.did,Ai);},onCancel:Ae});},AX=function(Ai){Ag.controller.openCubeBrowser({success:function(Aj){b(Ag,Aj.did,Ai);},failure:function(){Ae();}});},Af=function(Ak){var Ai=Ak.sourceDatasetId,Al=!!Ak.isOneTierCubeImport,Aj=Ak.openDialog;M(AZ,Ag,function(Am){function An(){f.call(AZ,function(){Aj(function(Ap){var Ao=r(Ap);AW({isOneTierCubeImport:Al,source:{did:Ai,all:!!Ad,units:Am},target:{did:Ap.did,units:Ao},onBack:AN.composite([Ae||mstrmojo.emptyFn,An])});});});}An();},Ad?null:Ai);};return function(){var Ai=new mstrmojo.ui.menus.MenuConfig({supportsScroll:true,menuCssClass:"reconsoliationMenu"}),Am=this.did,Al=Ad?null:Am,Aj=Object.keys(AZ.data).length;if(p()){var Ak=mstrApp.isSingleTier;if(Ag.allowImportData()){Ai.addMenuItem(mstrmojo.desc(14303,"New Data..."),"",function(){Af({sourceDatasetId:Am,openDialog:AY});});Ai.addSeparator();}if(!(mstrApp.isWorkstation&&mstrApp.isVisBuilder)){Ai.addMenuItem(mstrmojo.desc(13573,"Existing Dataset..."),"",function(){Af({sourceDatasetId:Am,isOneTierCubeImport:Ak,openDialog:Aa});});}if(!AZ.hasUnsubmitDataset&&Ag.allowNewOrEditRolapDS()&&(Ag.isSchemaDefined()||mstrApp.isWorkstation)){Ai.addMenuItem(mstrmojo.desc(15397,"Existing Objects..."),"",function(){Af({sourceDatasetId:Am,openDialog:Ab});});}}if(Aj>1){Ai.addSeparator();a.forEach(AZ.data,function(Ao,An){if(An===Am){return true;}Ai.addMenuItem(Ao.name,"",function(){f.call(AZ,function(){M(AZ,Ag,function(Ap){b(Ag,An,function(Aq){AW({source:{did:Am,all:!!Ad,units:Ap},target:{did:An,units:r(Aq)}});});},Al);});});});}return Ai;};}function AH(){var AX=this,AW=AX.model,AY=[];a.forEach(AW.datasets,function(AZ){if(AZ.st===779&&AW.hasPrivilegesForAllTables(AZ.tables)){AY.push(AZ);}});return function(){AX.showDataImport({isEdit:false,datasets:AY,AnalysisId:AX.model.mid,needDefn:true});};}function Z(){var AX=this,AW=AX.model,AY=[];a.forEach(AW.datasets,function(AZ){if(AZ.st===779&&AW.hasPrivilegesForAllTables(AZ.tables)){AY.push({cube_id:AZ.did,cname:AZ.name,ddam:AZ.dsm,mdt:"2014-12-10 20:57:25",sz:421,st:AZ.st});}else{if(AZ.st===776){AY.push({cube_id:AZ.did,cname:AZ.name,ddam:AZ.dsm,mdt:"2014-12-10 20:57:25",sz:421,st:AZ.st});}}});return function(){AX.showDataImport({isEdit:false,datasets:{cubes:{cube:AY}},AnalysisId:AX.model.mid,StatusCode:2,refreshMultipleCubes:true,rwb:AW.getDataService().rwb});};}function AM(AW){return function(){var AX=new mstrmojo.ui.menus.MenuConfig(),AY=this;if(p()&&AY.model.allowImportData()){AX.addMenuItem(mstrmojo.desc(14303,"New Data..."),"",AH.call(AY));AX.addSeparator();}if(!(mstrApp.isWorkstation&&mstrApp.isVisBuilder)){AX.addMenuItem(mstrmojo.desc(13573,"Existing Dataset..."),"",function(){AY.model.controller.addDataset();});}if(!AW.hasUnsubmitDataset&&AY.model.allowNewOrEditRolapDS()&&(AY.model.isSchemaDefined()||mstrApp.isWorkstation)){AX.addMenuItem(mstrmojo.desc(15397,"Existing Objects..."),"",function(){AY.model.controller.createDataset();});}return AX;};}function AU(AW){var AY=AW&&AW.datasets,AX=(AW.datasetsSettings&&AW.datasetsSettings.units)||{},Aa=function(Ac){return Ac.hide&&!(AX[Ac.n]&&AX[Ac.n].completeHide);},Ab,AZ;for(AZ in AY){Ab=AY[AZ];if(m.filterOne(Ab&&Ab.att,Aa)||m.filterOne(Ab&&Ab.mx,Aa)){return true;}}return false;}function H(AX){var AZ=AX&&AX.datasets,Aa=[];function AW(Ag,Ad){var Ac=(AX.datasetsSettings&&AX.datasetsSettings.units)||{},Ab=[],Ai=0,Ae={};a.forEach(AZ,function(Ak,Al){if(Ak.did){++Ai;}var Aj=m.filter(Ak[Ad],function(Am){Am.dsid=Al;Am.ds=Ak.name;Am.tt=Am.n+" ("+Am.ds+")";Am.css=P.getUnitCssClass(Am);return Am.hide&&!(Ac[Am.n]&&Ac[Am.n].completeHide);});Ab=Ab.concat(Aj);});if(!Ab.length){return ;}Ab=P.getSortedDatasetUnits(Ab);var Af=new mstrmojo.ui.CheckList({cssClass:"units",items:Ab,selectedIndices:Ae,useRichTooltip:true,showTooltip:function Ah(Aj,Am){var Al=Aj.target||Y.eventTarget(Aj.hWin,Aj.e),Ak=this.getItemFromTarget(Al),Ao=Al.firstChild,An;Al.setAttribute("title","");if(Al.offsetWidth<Ao.offsetWidth||Ai>0){An=Y.position(this.getItemNodeFromTarget(Al));this.richTooltip={posType:mstrmojo.tooltip.POS_TOPLEFT,cssClass:"vi-regular vi-tooltip-C",content:Ak.tt,top:An.y,left:An.x+An.w+18};mstrmojo.ui.CheckList.prototype.showTooltip.apply(this,Aj,Am);}}});Aa.push({scriptClass:"mstrmojo.vi.ui.PanelPortlet",title:Ag,children:[Af],t:l[Ad],getSelectedItems:function(){return Af.getSelectedItems()||[];},updateListScrollbars:function(){Af.updateScrollbars();}});}AW(mstrmojo.desc(3581,"Attributes"),"att");AW(mstrmojo.desc(3582,"Metrics"),"mx");return new mstrmojo.ui.menus.EditorConfig({data:{},cssClass:"mstrmojo-ShowHiddenEditor",contents:Aa,onOpen:function AY(){Aa.forEach(function(Ab){Ab.updateListScrollbars();});},fnOk:function(){var Ab=[];Aa.forEach(function(Ad){var Ae=Ad.getSelectedItems();Ae.forEach(function(Af){Ab.push(AX.getToggleHiddenObjectAction(Af.dsid,Af,false));});});var Ac=AX.getDatasetsUpdateCallback();AX.controller.cmdMgr.execute({execute:function(){this.submit(Ab,Ac,AF);},urInfo:{callback:Ac}});}});}function D(AX,AW){m.forEach(AX,function(AZ){var Aa=AZ.dsid,AY=AW.settings.dataset(Aa);AY.isCollapsed=!!AZ.isCollapsed;});}function K(AX,AW){D(AX,AW);AW.saveSettings();}function AT(AX,AW){return function(){var AZ=AX.model,AY=AZ&&AZ.controller,Aa=[{act:"removeDataset",did:AW,disablePU:true,skipCleanup:true}],Ab=AY.getRefreshCallback();if(AX.getDatasetCount()===2){D(a.keyarray(AZ.datasets).filter(function(Ac){return Ac!==AW;}).map(function(Ac){return{dsid:Ac,collapsed:false};}),AX);Aa=Aa.concat(AX.settings.getSaveActions());}AY.cmdMgr.execute({execute:function(){this.submit(Aa,Ab,{style:{params:{treesToRender:3}}});},urInfo:{callback:Ab}});};}function AG(AX,Ag,AY,AW,Ad){var Ae=F(),Ac=mstrmojo.onetier.vi.prefs.handleErrorMessage,AZ=AY.dsm===Ad,Ah,Aa=function Af(Aj,Al){Ae.getPollingStatus({id:Aj.id},{success:function Ak(Am){switch(Am.status){case 1:case 2:mstrApp.getRootController().showOrHideProgressBar(mstrmojo.desc(13568,"Download from server"),false);if(Am.status===2){if(Al.failure){Al.failure(Am.data);}}else{Ae.refreshNativeDialogMenu();Al.success(Am.data);}break;case 4:mstrApp.getRootController().showOrHideProgressBar(mstrmojo.desc(13568,"Download from server"),false);return ;default:mstrApp.getRootController().updateProgressBar({pct:Am.pct,msg:Am.msg,requestID:Aj.id,canCancel:Am.status===0});Aa(Am,Al);}},failure:function Ai(){mstrApp.getRootController().showOrHideProgressBar("Download from server",false);}});},Ab=function(){Ae.loadCube({objectID:AW,addDatasetToDocument:false,dda:Ad===R.DIRECT_ACCESS},{success:function(Ai){mstrApp.getRootController().showOrHideProgressBar("Download from server",true);Aa({id:Ai.id},{success:function(){M(AX,Ag,function(Aj){b(Ag,AY.did,function(An){var Al=r(An),Ak=[],Am;Al.forEach(function(Ao){if(mstrmojo.array.find(Aj,"did",Ao.did)!==-1){Am={tgtid:Ao.did,tgtt:Ao.t,srcid:Ao.did,srct:Ao.t};if(Ao.cont_did&&Ao.cont_tp){Am.cont_did=Ao.cont_did;Am.cont_tp=Ao.cont_tp;}Ak.push(Am);}});X(AX,Ag,false,{isOneTierCubeImport:true,source:{did:AW,units:Aj},target:{did:An.did,units:Al},onBack:mstrmojo.emptyFn})(Ak,false);});},AW);}});}});};Ae.getCubeInfo({cubeIds:AW},{success:function(Ak){if(Ad===R.IN_MEMORY){if(Ak.hsf){mstrmojo.alert(mstrmojo.desc(14171,"You can not download the data because a security filter has been defined for you in this project."));}else{if(Ak.acld){mstrmojo.alert(mstrmojo.desc(14172,"You can not download the data because you do not have access to all the objects in the selected Intelligent cube."));}else{if(Ak.dda){Ah=AZ?mstrmojo.desc(14079,"Data Access Mode for the corresponding Intelligent Cube on the MicroStrategy Server has changed from In-Memory to Connect Live. Due to this change, you will not be able to continue in In-Memory mode. Do you want to switch to Live Connection?"):mstrmojo.desc(14080,"Data Access Mode for the corresponding Intelligent Cube on the MicroStrategy Server has changed from In-Memory to Connect Live. Due to this change, you will not be able to switch to In-Memory mode.");mstrmojo.confirm(Ah,{confirmBtn:{fn:function(){Ad=R.DIRECT_ACCESS;Ab();}}});}else{var Aj=function(An){return"{"+(An>=1048576?(An/1048576).toFixed(2)+"GB":(Math.round((An||0)*100/1024)/100).toFixed(2)+"MB")+"}";},Am=Ak.maxcs*1024,Ai=Ak.cs,Al=Ai>Am;if(Al){mstrmojo.alert(mstrmojo.desc(14081,"The size of the Intelligent Cube #  is more than the download limit ## set by the administrator. Therefore, you can only Connect Live to the selected Intelligent Cube.").replace("##",Aj(Am)).replace("#",Aj(Ai)));}else{Ab();}}}}}else{Ab();}},failure:function(Ai){Ac(Ai);}});}function d(AY,Aa,AW,AZ,Ab){if(mstrApp.isSingleTier&&AY.hcs){var AX=AY.dsm===R.DIRECT_ACCESS?"You are using Live connection to an Intelligent Cube residing on a MicroStrategy Server. In order to continue, you need to first convert the cube to a local cube. Do you want to continue?":"You are using an Intelligent Cube from a MicroStrategy Server. In order to continue, you need to first convert the cube to a local cube. Do you want to continue?";mstrmojo.confirm(AX,{confirmBtn:{fn:function(){AW.getDataService().submitUpdates({act:"disconnectDataset",dsid:Aa,dsm:R.IN_MEMORY,ignoreExecution:AZ},AN.wrapMethods(Ab,{failure:mstrApp.onerror}),{style:{params:{treesToRender:0}}});}}});}}function t(AW,AZ,Ab,AX){function AY(Ae){var Ac=AW.model,Ad=function(){if(Ae===AZ.dsm){return ;}if(AZ.hcs){AG(AW,Ac,AZ,Ab,Ae);}else{function Af(){AX.controller.cmdMgr.execute({execute:function(){this.submit({act:"toggleDatasetServeMode",dsid:Ab,dsm:Ae},AX.controller.getRefreshCallback(),{style:{params:{treesToRender:3}}});},urInfo:{callback:AX.controller.getRefreshCallback()}});}if(mstrApp.isSingleTier&&!(mstrApp.supportFeature(mstrmojo.vi.enums.EnumFeatures.SUPPORT_LIVEMODE)&&mstrApp.getWSLiveMode())){AP(AW,Ab,Ac,{callback:{success:Af}});}else{Af();}}};return function(){AX.warnForEditStandaloneDS(AZ,Ad);};}return function Aa(){var Ac=new mstrmojo.ui.menus.MenuConfig();Ac.addMenuItem(mstrmojo.desc(11921,"In-Memory"),AZ.dsm===R.IN_MEMORY?"on":"",AY(R.IN_MEMORY));Ac.addMenuItem(mstrmojo.desc(12726,"Connect Live"),AZ.dsm===R.DIRECT_ACCESS?"on":"",AY(R.DIRECT_ACCESS));Ac.hasToggleItem=true;return Ac;};}function AR(AY,AZ,AX){var AW={act:"datasetSaveAs",managed:AY.managed,nonDelta:true,dsID:AY.dsID,rptName:AY.rptName,rptDesc:AY.rptDesc,saveAsOverwrite:AY.saveAsOverwrite};if(!AY.managed){AW.folderID=AY.folderID;}AX.model.controller.submitUndoRedoUpdates([AW],{},AN.wrapMethods(AX.model.getDatasetsUpdateCallback(),AZ),{config:{showProgress:true,hideProgress:true,progressStateText:[mstrmojo.desc(8445,"Loading")],silent:true}},{disablePU:true,treesToRender:mstrmojo.DocDataService.EnumTreesToRender.DEFN,callback:AX.model.getDatasetsUpdateCallback(),extras:mstrmojo.DocDataService.REQUEST_ONLY_DEFINITION});}function I(AX,AY){var AZ="mstrIVE_DS_SAVER";return function AW(){var Aa=mstrmojo.all[AZ];if(!AY){return ;}if(!Aa){Aa=new mstrmojo.SaveAsEditor({id:AZ,folderLinksContextId:32,showCompletePath:false,saveParams:{},saveAs:function(Ad){var Ab=this.contPanel;this.name=Ab.name.value;this.desc=Ab.desc.value;if(!this.name){mstrmojo.alert(mstrmojo.desc(3380,"Please enter valid name"));return ;}var Ae=this.saveParams||{};Ae.managed=false;Ae.folderID=this.ob.currentFolder.did;Ae.rptName=this.name||"";Ae.rptDesc=this.desc||"";Ae.saveAsOverwrite=!!Ad;var Ac=this.saveAsCallback();Ac.failure=function(Ag){var Af=Ag.code,Ah=this.parent;if(Af==="-2147217373"||Af==="-2147216857"){AB(mstrmojo.desc(7986,"The ## '###' already exists. Do you want to replace the existing one?").replace("##",Ah.typeDesc||"Object").replace("###",Ah.name),{confirmBtn:{fn:function(){Ah.saveAs(true);}}},{title:mstrmojo.desc(3179,"Confirm Overwrite")});}else{if(Af==="-2147202302"){mstrmojo.alert(mstrmojo.desc(11642,"Cannot save report ## to overwrite report ###, because report #### is also used by the document.").replace("##",AX.data[AY].name).replace("###",Ah.name).replace("####",Ah.name),null,mstrmojo.desc(11643,"Dataset Overwrite Error"));}else{mstrmojo.alert(mstrmojo.desc(7985,"Error while saving: ")+Ag.message);}}};Ac.complete=AN.wrapMethods(Ac.complete,function(){mstrApp.hideWait();});Ac.parent=this;AR(Ae,Ac,AX);mstrApp.showWait({message:mstrmojo.desc(10492,"Saving...")});Aa.close();}});Aa.render();}Aa.saveParams.dsID=AY;Aa.open();};}function U(AY,AW,Aa){var AX=Aa.tables.map(function(Ac){var Ad=Ac.mxRefs[m.find(Ac.mxRefs,"rm",true)],Ab=Ad&&Aa.mx[m.find(Aa.mx,"did",Ad.did)];return a.copy(Ac,{rowCountMetric:Ab});}).filter(function(Ab){return Ab.rowCountMetric&&Ab.rowCountMetric.hide;});if(!AX.length){return ;}var AZ=new mstrmojo.ui.menus.MenuConfig();AX.forEach(function(Ab){AZ.addMenuItem(Ab.n,"",function(){var Ac=[AW.getToggleHiddenObjectAction(Aa.did,Ab.rowCountMetric,false)];var Ad=AW.getDatasetsUpdateCallback();AW.controller.cmdMgr.execute({execute:function(){this.submit(Ac,Ad,AF);},urInfo:{callback:Ad}});});});AY.addSubMenuItem(mstrmojo.desc(13228,"Show Row Count"),"",null,function(){return AZ;});}function N(){var AW=[];m.forEach(this.contents.children,function(AX){if(AX.visible){AW.push(AX);}});return AW;}function x(AX,AW){return function(){var AY=AX.model;AY.getDataService().submitUpdates([{act:"refreshReport",dsID:AW}],AY.controller.getRefreshCallback());};}function Q(AX,AY,AW){return function(){var Aa=AX.model;function Ab(Af){AX.showDataImport({AnalysisId:Aa.mid,ReportId:AY,CubeName:AW.name,CubeDesc:AW.dsc,isManagedCube:AW.mngd,StatusCode:2,missingCredentialsData:Af,needDefn:true});}function Ae(){Aa.getDataService().checkMissingCredentials({dsid:AY},{success:function(Af){window.setTimeout(function(){if(Af.success){Ab();}else{Ab(Af);}},0);},failure:function(Af){mstrmojo.alert(Af);}});}function AZ(Af){if(Af&&Af.tables){return Af.tables.some(function(Ag){return Ag.dbRole;});}return false;}if(mstrApp.isSingleTier&&!(mstrApp.supportFeature(mstrmojo.vi.enums.EnumFeatures.SUPPORT_LIVEMODE)&&mstrApp.getWSLiveMode())){Ae();}else{if(!mstrApp.isSingleTier&&AZ(AW)){var Ad=a.clone(AW),Ac=q.standardizeDBRolesFormat({dsid:Ad});Ab({datasets:Ac});}else{Ab();}}};}function C(){var AW=this.settings;this.set("useTableView",!!(AW&&AW.useTableView));}function J(AW){var AZ=this.settings,Aa=(this.contents.children||[]).length===1;if(AW){if(Aa){var AY=this.contents.children[0],AX=AY.tableView||AY.mdxView;return AX&&AX.setting.hasCollapsedChildNodes(false,false);}else{return(this.contents.children||[]).some(function(Ac){var Ab=AZ.dataset(Ac.did);return Ab.getCollapsed()===false;});}}else{return(this.contents.children||[]).some(function(Ad){var Ac=AZ.dataset(Ad.did),Ab=Ad.tableView||Ad.mdxView;if(Ac.getCollapsed()===true){return true;}else{return Ab&&Ab.setting&&Ab.setting.hasCollapsedChildNodes(true,true);}});}}function v(){return[mstrApp.isWorkstation?V.UICMD_DEFAULT_ERROR:V.DOCDATA_PREPARE_TASK_REPORT_INCOMP];}function B(AW,Aa){if(!mstrApp.isOpenExisting&&!mstrApp.isVisBuilder&&this.model.isnew&&!AW&&Aa){var AZ=Y.position(Aa.domNode);this.openPopup({scriptClass:"mstrmojo.Popup",autoCloses:true,locksHover:true,cssClass:"mstrmojo-VIDocDatasetObjects mstrmojo-Tooltip vi-regular vi-tooltip-C A-center",titleNodeCssClass:"mstrmojo-Tooltip-arrow",contentNodeCssClass:"mstrmojo-Tooltip-contentWrapper",children:[{scriptClass:"mstrmojo.Label",text:mstrmojo.desc(15623,"To get started, click here to add your data.")},{scriptClass:"mstrmojo.CheckBox",label:mstrmojo.desc(14851,"Don’t show me again"),postcheckedChange:function AY(){if(mstrApp.isWorkstation){var Ad=new mstrmojo.onetier.vi.prefs.DesktopConnectivityProxy(),Ab={feature_flag:{}};Ab.feature_flag[L]=true;Ad.savePreferences(Ab);}else{var Ac=mstrmojo.global.localStore;Ac.setItem(L,this.checked,-1);}}}],updatePopupConfig:function AX(Ac){var Ab=this.popupConfig;if(!Ab){Ab=this.popupConfig=this.addDisposable(new mstrmojo.ui.PopupConfig({isHostedWithin:false}));}Ab.position=Ac.position;}},{position:{x:AZ.x+AZ.w+15,y:AZ.y-4}});}}mstrmojo.vi.ui.DocDatasetObjects=mstrmojo.declare(mstrmojo.vi.ui.DatasetObjects,[mstrmojo.util.ui._HostsSplitter,mstrmojo.vi.ui.toolbars._HasToolbar,mstrmojo._HasPopup],{scriptClass:"mstrmojo.vi.ui.DocDatasetObjects",cssClass:"mstrmojo-VIDocDatasetObjects",datasetUnitListScriptClass:"mstrmojo.vi.ui.DocDatasetUnitList",settings:null,onLogout:function(AX){var AW=mstrApp.rootCtrl,AY=AW.dataProvider,AZ=AY&&AY.sessionState;if(!AX||(AZ&&AZ===AX)){AW.set("dataProvider",null);}},init:function AL(AW){this._super(AW);this.model.attachEventListener("updateUseTableView",this.id,function(){C.call(this);});C.call(this);},onsettingsChange:function(){C.call(this);},onAppStateChange:function u(AW){this._super(AW);if(this.visible&&mstrmojo.vi.VisualInsightApp.APP_STATES.PRESENTATION&AW.valueWas&&!mstrApp.isAppStatePresentation()){this.refresh();}},getLinksForEmptyData:function A(){var AX=this.model,Ab=function Ab(Ae){return{useRichTooltip:true,updateTooltipConfig:function Ad(){var Ag=this.parent.parent._lastOpened,Af=Ag&&Ag.visible,Ah=Y.position(this.domNode);this.richTooltip=(Af&&this.alias==="newDataLink")?null:{content:Ae,cssClass:"vi-regular vi-tooltip-C A-center",left:Ah.x+Ah.w+10,top:Ah.y-4};}};},Ac=o(mstrmojo.desc(15398,"Existing Objects"),function(){this.model.controller.createDataset();}.bind(this),false,Ab(mstrmojo.desc(15399,"Create a new dataset using attributes and metrics available on any one of your connected environments."))),AW=o(mstrmojo.desc(15343,"Existing Dataset"),function(){this.model.controller.addDataset();}.bind(this),false,Ab(mstrmojo.desc(15400,"Select a dataset from any one of your connected environments. Includes existing reports and cubes."))),AZ=o(mstrmojo.desc(15396,"New Data"),function(){this.model.controller.importFile();}.bind(this),false,a.copy({alias:"newDataLink"},Ab(mstrmojo.desc(15401,"Import data from your local machine, such as excel or csv files, or connect to a database.")))),AY=[];if(AX.allowImportData()){AY.push(AZ);AY.push({scriptClass:"mstrmojo.Box",cssClass:"button-splitter"});}if(AX.allowManageDocumentDataset()&&!(mstrApp&&mstrApp.isWorkstation&&mstrApp.isVisBuilder)){AY.push(AW);}if(AX.allowNewOrEditRolapDS()&&(AX.isSchemaDefined()||mstrApp.isWorkstation)){AY.push(Ac);}var Aa={text:""};AY.forEach(function(Ad){var Ae=Ad.text;if(Ae&&(Ae.length>Aa.text.length)){Aa=Ad;}});Aa.cssClass+=" longest";if(AY.length>0){AY.unshift({scriptClass:"mstrmojo.Label",text:mstrmojo.desc(11780,"Add Data")});}return AY;},getDatasetTableView:function O(AY,AZ){var AX=this,AW=this.settings;return mstrmojo.mixin({setting:AW.dataset(AZ),onTableCollapsedChange:function(Ab,Aa){this._super();if(!AX.isSearching){this.setting.table(Ab).isCollapsed=Aa;AX.saveSettings();}}},this._super(AY,AZ));},getDatasetMDXView:function AD(AY,AZ){var AX=this,AW=AY.tables&&AY.tables[0]&&AY.tables[0].did;return mstrmojo.mixin({setting:this.settings.dataset(AZ).table&&this.settings.dataset(AZ).table(AW),onNodeCollapsedChange:function(Aa){this._super();if(!AX.isSearching){Aa.setting.isCollapsed=Aa.isCollapsed;AX.saveSettings();}}},this._super(AY,AZ));},getDatasetPortlet:function AK(Ab,AX,AY,Aa){var Ag=this,Ac=Ag.model,Aj=this._super(Ab,AX,AY,Aa),Ah=Ab.st===768,Ad=Ab.st===776,Ai=Ab.st===779,AZ=Ab.acg,Af=AZ&&(AZ&n.DssAccessRightUseFlag)&&(AZ&n.DssAccessRightExecuteFlag),Ak=this.settings&&this.settings.dataset(AX);a.copy({isCollapsed:Ak?!!(Ak.getCollapsed()):false,onCollapsedChange:function Ae(){K([{dsid:AX,isCollapsed:this.isCollapsed}],AY);},onclick:function(Am){var An=Am.getTarget(),Al=this;if(mstrmojo.dom.contains(Al.titleBar.leftToolNode,An,true,Al.domNode)){Ag.updateScrollbars();if(!Ag.isSearching){K([{dsid:Al.did,isCollapsed:Al.isCollapsed}],AY);}}},addMenuItems:function AW(Ao){var Al=false;Ao.hostId=this.id;Ao.isHostedWithin=false;Ao.supportsScroll=true;Ao.maxHeight=Y.getMaxScrollHeight();var At=(mstrApp.getWSLiveMode&&!mstrApp.getWSLiveMode())&&Ac.hasHadoopSource(Ab)&&!Ac.isLiveDataset(Ab);function Ar(){var Av=Ac.controller,Az=function(A1){mstrmojo.confirm(mstrmojo.desc(16016,"Updating this dataset may take some time. Do you want to update it anyway?"),{confirmBtn:{t:mstrmojo.desc(505,"Update"),fn:A1},cancelBtn:{t:mstrmojo.desc(2140,"Cancel"),fn:mstrmojo.emptyFn}},{title:mstrmojo.desc(13850,"Update Dataset")});},Au={dataset:a.clone(Ab),docModel:Ac,title:mstrmojo.desc(3034,"Edit Dataset")+" - "+Ab.name,okBtnText:mstrmojo.desc(13850,"Update Dataset"),onOk:function(A3){var A1=this,A4=AN.wrapMethods(Av.getRefreshCallback(),{failure:function(A5,A6){this.canceled(A6.id);}});if(A3.length){var A2=function(){Av.cmdMgr.execute({execute:function(){this.submit(A3,AN.wrapMethods(A4,{success:function(){A1.close();}}),a.copy({skipUICmdMgrOnFailure:v()},j));},urInfo:{callback:A4}});};if(A1.dataset.dsm===R.DIRECT_ACCESS&&A1.modifiedItems.del.length===0){A2();}else{Az(A2);}}}},Ay={isEdit:true,isNewAnalysis:false,isManagedCube:Ab.mngd,AnalysisId:Ac.mid,ReportId:AX,CubeName:Ab.name,CubeDesc:Ab.dsc,StatusCode:1,needDefn:true};if(!Ab.mngd){var Ax=o(mstrmojo.desc(13364,"Keep Changes Local"),function(){var A2=Ac.datasets,A1={act:"convertDatasetToManaged",dsID:AX};if(Ai){f.call(Ag,function(){var A3=Av.cmdMgr.getInterimCmd();A3.urInfo.callback=Av.model.getDatasetsUpdateCallback();A3.submitInterim(A1,{success:function(A6){var A5=null,A4=null;a.forEach(A6.datasets,function(A7,A8){if(!A2[A8]){A5=A7;A5.did=A4=A8;return false;}});Ag.showDataImport({isEdit:true,isNewAnalysis:false,isManagedCube:A5.mngd,AnalysisId:Ac.mid,ReportId:A4,CubeName:A5.name,CubeDesc:A5.dsc,StatusCode:1,callback:function(A9){var BB=Ag.model.cmdMgr(),BA=BB.getInterimCmd();if(A9){var A8=Ag.model.controller.getRefreshCallback();BA.urInfo.callback=A8;BA.resetCmdMgrOnComplete();BA.submit([],A8,j,BB.CMD_PHASE.LAST);}else{var A7=BA.urInfo;A7.callback={success:mstrmojo.emptyFn};A7.treesToRender=0;BA.cancel();}}});}});});}else{AY.openDatasetEditor(a.copy(Au,{modifiedItems:{convert:A1,add:[],del:[],fs:{add:[],del:[]},filter:null}}));}},true);var A0=Ab.acg&n.DssAccessRightWriteFlag;var Aw=Ab.acg&n.DssAccessRightExecuteFlag;if(!(A0&&Aw)){AB(mstrmojo.desc(16029,"You do not have execute or write access to this stand-alone dataset. You can only make changes local to this dossier by duplicating and embedding the dataset in this dossier."),{},{cssClass:"mstrmojo-warning-ConfirmEditDataset",buttons:[o(mstrmojo.desc(3034,"Edit Dataset"),mstrmojo.emptyFn,true,{enabled:false}),o(mstrmojo.desc(2140,"Cancel"),mstrmojo.emptyFn),Ax]});}else{AB(mstrmojo.desc(16030,"Editing this dataset will immediately affect other documents and dossiers that share the dataset. Do you want to edit the stand-alone dataset or keep your changes local by duplicating and embedding the dataset in this dossier?"),{},{cssClass:"mstrmojo-warning-ConfirmEditDataset",buttons:[o(mstrmojo.desc(3034,"Edit Dataset"),function(){if(Ai){Ag.showDataImport(Ay);}else{var A1=a.copy(Au);A1.onOk=function(A3){if(A3.length){var A2=this;Az(function(){var A4=AN.wrapMethods(Av.getRefreshCallback(),{failure:function(A5,A6){this.canceled(A6.id);}});Av.cmdMgr.execute({execute:function(){this.submit(A3,AN.wrapMethods(A4,{success:function(){A2.close();}}),{skipUICmdMgrOnFailure:v(),style:{params:{treesToRender:3}}});},urInfo:{callback:A4}});});}};AY.openDatasetEditor(A1);}}),o(mstrmojo.desc(2140,"Cancel"),mstrmojo.emptyFn),Ax]});}}else{if(Ai){Ag.showDataImport(Ay);}else{AY.openDatasetEditor(Au);}}}var Am=Ab.copyable==="true"||Ab.copyable===undefined;if(!(Ac.isRADataset(Ab)&&(!Ai||mstrApp.isSingleTier))&&!Ad&&Ab.rt!==8&&c.call(Ag,Ab)&&!(Ah&&!Ac.allowModifyReportList())&&!Al&&((Ai&&Ac.hasPrivilegesForAllTables(Ab.tables))||(!Ai&&((!Ab.idd&&!Ab.mngd&&Ac.allowManageDocumentDataset())||(!Ab.idd&&Ab.mngd&&Ac.allowNewOrEditRolapDS())||(Ab.idd&&Ac.allowNewOrEditDummyDS()))))&&!mstrApp.isInVFConfigMode&&!Ac.isSparkDataset(Ab)&&!At){var Ap,Aq;if(Am){Ap="addMenuItem";Aq="";}else{Ap="addDisabledMenuItem";Aq=mstrmojo.desc(16119,"Editing the dataset is not available for this dossier as the data has been limited for your specific user.");}Ao[Ap]({n:mstrmojo.desc(11923,"Edit Dataset..."),ttp:Aq},"",function(){var Au=false;if(mstrApp.isSingleTier&&!(mstrApp.supportFeature(mstrmojo.vi.enums.EnumFeatures.SUPPORT_LIVEMODE)&&mstrApp.getWSLiveMode())){m.forEach(Ab.tables,function(Av){if(Av.xdaType===AA.xdaType.salesforce){Au=true;return false;}});if(Au){Ar();}else{AP(AY,AX,Ac,{callback:{success:Ar}});}}else{Ar();}});}if(Ab.dsm===R.IN_MEMORY&&!Ac.isMDXDataset(Ab)&&!(mstrApp.isAppStatePause&&mstrApp.isAppStatePause())){if(!Ab.tables||Ab.tables.length===1){Ao.addMenuItem(mstrmojo.desc(13537,"Show Data..."),"shwd",function(){mstrmojo.vi.ui.ViewDataDialog.openDS(Ac,Ab,AX);});}else{Ao.addPopupMenuItem(mstrmojo.desc(11476,"Show Data"),"",function(){var Av=new mstrmojo.ui.menus.MenuConfig(),Au=Ab.tables;Au.forEach(function(Ax,Aw){Av.addMenuItem(Ax.n,"",function(){mstrmojo.vi.ui.ViewDataDialog.openDSTable(Ac,Ab,AX,Aw);});});return Av;});}}if(!mstrApp.isInVFConfigMode){if(Ac.allowManageDocumentDataset()){Ao.addSubMenuItem(mstrmojo.desc(4571,"Join Behavior"),"",this.id,function(){return z(Ac,Ab);});Ao.addSeparator();}if(!Ac.isDataImportRemoteDataSource(Ab)||mstrApp.isSingleTier){if(Ab.hcs){if(Ab.idd!==true){Ao.addMenuItem(mstrmojo.desc(773,"Refresh"),"",function(){AG(AY,AY.model,Ab,AX,Ab.dsm);});}}else{if((Ab.rt===1&&Ac.allowReExecuteRegularReport())||(Ab.rt===8&&Ac.allowReExecuteViewReport())){Ao.addMenuItem(mstrmojo.desc(15209,"Refresh Dataset"),"",function(){mstrmojo.confirm(mstrmojo.desc(16015,"Refreshing this dataset may take some time. Do you want to update it anyway?"),{confirmBtn:{t:mstrmojo.desc(505,"Update"),fn:x(AY,Ab.did)},cancelBtn:{t:mstrmojo.desc(2140,"Cancel"),fn:mstrmojo.emptyFn}},{title:mstrmojo.desc(15209,"Refresh Dataset")});});}else{if(Ad&&Ac.allowManageDocumentDataset()&&Ac.allowReExecuteCubeReport()&&!Ab.localbin&&Af){Ao.addMenuItem(mstrmojo.desc(13610,"Republish Cube..."),"",function(){mstrmojo.confirm(mstrmojo.desc(13956,"Publishing time depends on your dataset. Are you sure you want to republish?"),{confirmBtn:{t:mstrmojo.desc(13953,"Republish"),fn:x(AY,Ab.did)},cancelBtn:{t:mstrmojo.desc(2140,"Cancel"),fn:mstrmojo.emptyFn}},{title:mstrmojo.desc(2914,"Warning")});});}else{if(Ai&&Ab.sda!==g.SupportDDAOnly&&Ab.dsm!==R.DIRECT_ACCESS&&Ac.allowManageDocumentDataset()&&Ac.allowReExecuteCubeReport()&&Ac.hasPrivilegesForAllTables(Ab.tables)&&!Ac.isSparkDataset(Ab)&&Af){Ao.addMenuItem(mstrmojo.desc(13610,"Republish Cube..."),"",Q(AY,AX,Ab));}}}}}}if(Ab.sda===g.SupportDDAOrInMemory&&Ab.rt===7&&Ac.allowManageDocumentDataset()&&Ab.acg&n.DssAccessRightWriteFlag&&!Ac.isSparkDataset(Ab)&&mstrmojo.resolveFeature(k.WEB_IMPORT_DATABASE)){Ao.addSubMenuItem(mstrmojo.desc(11922,"Data Access Mode"),"",this.id,t(AY,Ab,AX,Ac));}if((p()||Ag.getDatasetCount()>1)&&Ac.allowManageDocumentDataset()&&!(this.mdxView&&this.mdxView.docModel.isRADataset(this.dataset))){if(mstrApp.isInVFConfigMode){Ao.addNonInteractiveMenuItem(mstrmojo.desc(11484,"Replace Dataset with"),"",true);}else{Ao.addSubMenuItem(mstrmojo.desc(11484,"Replace Dataset with"),"",this.id,AS(AY));}}Ao.addSeparator();if(Ai&&this.useTableView){U(Ao,Ac,Ab);}if(!mstrApp.isInVFConfigMode&&mstrmojo.resolveFeature(k.INSERT_NEW_METRIC)){Ao.addMenuItem(mstrmojo.desc(13624,"Create Metric..."),"",AV.call(this,Ab,Ac));if(!mstrApp.isInVFConfigMode&&!(Ac.isMDXDataset(Ab)&&Ac.isDDADataset(Ab))){Ao.addMenuItem(mstrmojo.desc(13625,"Create Attribute..."),"",AE.call(this,this.did,Ag.data));}}Ao.addSeparator();if(!mstrApp.isSingleTier&&!Ab.idd&&Ac.allowSaveDataset()&&Ac.allowWebExecuteCubeReport()){if(((Ab.att||[]).length+(Ab.mx||[]).length)>0){var Ap,Aq;if(Am){Ap="addMenuItem";Aq="";}else{Ap="addDisabledMenuItem";Aq=mstrmojo.desc(16120,"Saving the dataset is not available for this dossier as the data has been limited for your specific user.");}Ao[Ap]({n:mstrmojo.desc(13239,"Save Dataset..."),ttp:Aq},"",I(AY,this.did));}}if(Ab.mngd&&Ac.allowManageDocumentDataset()){if(((Ab.att||[]).length+(Ab.mx||[]).length)>0){if(!(mstrApp.isSingleTier&&Ab.hcs&&!Ab.idd)){Ao.addMenuItem(mstrmojo.desc(1388,"Rename"),"rnm",function(){this.ctxt.titleBar.editTitle();},this);}}}if(Ac.allowManageDocumentDataset()){if(mstrApp.isInVFConfigMode){Ao.addNonInteractiveMenuItem(mstrmojo.desc(629,"Delete"),"",true);}else{Ao.addMenuItem(mstrmojo.desc(629,"Delete"),"",AT(this.parent.parent,this.did));}}if(AY.gridSource===this.did){Ao.addToolbarBtn(mstrmojo.desc(11647,"This is the primary dataset."),"default-set",mstrmojo.emptyFn);}if(Ab.unpublished){Ao.addToolbarBtn(mstrmojo.desc(15803,"This cube is not published"),"unpublished",mstrmojo.emptyFn);}var An=P.getHighlightElementHandler;Ao.addPopupHandlers(this.id,An(true,this.titlebarNode),An(false,this.titlebarNode));if(Ai&&Ac.allowManageDocumentDataset()&&Ac.hasPrivilegesForAllTables(Ab.tables)&&!Ac.isSparkDataset(Ab)){var As=Ab.tables;if(As&&As.length>1&&!(mstrApp.isSingleTier&&Ab.dsm===R.DIRECT_ACCESS)){Ao.addSubMenuItem(mstrmojo.desc(11924,"Delete Table"),"","",function(){var Au=new mstrmojo.ui.menus.MenuConfig();As.forEach(function(Av){Au.addMenuItem(Av.n,"",function(){var Aw=function(){Ac.warnForEditStandaloneDS(Ab,function(){Ac.getDataService().submitUpdates({act:"deleteEMMATable",dsid:AX,tbid:Av.did},AN.override({success:function(Ax){this._super.call(Ac,Ax);Ac.controller.cmdMgr.reset();}},Ac.controller.getRefreshCallback()));});};if(mstrApp.isSingleTier&&Ab.hcs){d(Ab,AX,Ac,true,{success:function(){Aw();}});}else{Aw();}});});return Au;});}}return Ao;}},Aj);return Aj;},getDatasetTitleBarCfg:function(Ac){var AW=this._super(Ac),AY=this,Ab=Ac.dataset;a.copy({editTitleOnDoubleClick:AY.model.allowManageDocumentDataset()&&!!Ab.mngd&&((Ab.att||[]).length+(Ab.mx||[]).length)>0,useRichTooltip:true,titleEdited:function Aa(Ae,Ah,Ad){if(Ah){var Af=function(){Ac.titleBar.set("title",Ad);},Ai=function(){AY.model.renameDataset(Ac.did,Ae.trim(),AN.wrapMethods(AY.model.getDatasetsUpdateCallback()),{failure:function(Aj){mstrApp.onerror(Aj);Ac.titleBar.set("title",Ad);}});};var Ag=false;a.forEach(AY.model.datasets,function(Aj){if(Aj.name===Ae.trim()){Ag=true;return false;}});if(Ag){AB(mstrmojo.desc(13365,"Another dataset with same name exists. Do you want to keep this name?"),{},{buttons:[o(mstrmojo.desc(1442,"OK"),function(){P.validateName(Ae,Ai,Af);},true),o(mstrmojo.desc(2140,"Cancel"),function(){Af();})]});}else{P.validateName(Ae,Ai,Af);}}},updateTooltipConfig:function AZ(Ae){var Ad=Y.position(this.domNode);this.richTooltip={content:this.getTooltipContent(),posType:mstrmojo.tooltip.POS_TOPLEFT,cssClass:"vi-regular vi-tooltip-C",top:Ad.y-2,left:Ad.x+Ad.w+6};},shouldShowTooltip:function(Ad,Ae){return true;},getTooltipContent:function AX(){Ab=this.parent.dataset;var Ag=Ab.name,Ai,Ad='<span class="dsc">#####</span>',Ae='<div class="name">@@@@@</div>',Af={1:mstrmojo.desc(16230,"Standard Report"),7:{"true":mstrmojo.desc(16232,"OLAP Cube"),"false":mstrmojo.desc(16233,"Super Cube")},8:mstrmojo.desc(16231,"Cube Report")},Ah=Af[Ab.rt];Ai=(Ah||{})[!!Ab.xdaType];Ai=Ai||Ah;if(mstrApp.isSingleTier){if(!Ab.hcs&&!Ab.connInfo){if(Ab.dsm==2){Ae=Ae.replace("@@@@@","@@@@@ "+Ad.replace("#####",mstrmojo.desc(13575,"(Live)")));}}else{if(!!Ab.hcs&&!!Ab.connInfo){if(Ab.dsm==2&&(Ab.sdsm==1||Ab.sdsm==2)){Ae=Ae.replace("@@@@@","@@@@@ "+Ad.replace("#####",mstrmojo.desc(16235,"(Live to Server)")));}}}}else{if(Ab.dsm===2){Ae=Ae.replace("@@@@@","@@@@@ "+Ad.replace("#####",mstrmojo.desc(13575,"(Live)")));}}if(Ai){if(mstrApp.isAppStatePause()&&Ab.unpublished){Ae+='<div class="dsc unpublished">'+mstrmojo.desc(16234,"This ##### is unpublished.")+"</div>";}else{Ae+='<div class="dsc">'+mstrmojo.desc(16229,"Dataset type")+": #####</div>";}Ae=Ae.replace("#####",Ai);}Ae=Ae.replace("@@@@@",mstrmojo.string.encodeHtmlString(Ag));return Ae;},},AW);return AW;},saveSettings:function(){if(this.settings){this.settings.save();this.generateToolbar();}},ongridSourceChange:function(){this._super();var AX=this,AW=function(){a.forEach(AX.data,function(AZ,AY){var Aa=AX.getDatasetPanel(AY);if(Aa){Aa.generateToolbar();}});};if(this.visible){AW();}else{if(!this.updateToolbarHandle){this.updateToolbarHandle=this.attachEventListener("showPanel",this.id,function(){AX.updateToolbarHandle.clear();delete AX.updateToolbarHandle;AW();});}}},handleNode:null,unit:null,gridSource:null,postBuildRendering:function e(){var AY=this.handleNode;AY.style.display="block";this.registerSplitter(AY);var AX=this._super();var Ac=this.importDataBox,Ab=Ac&&Ac.newDataLink;if(mstrApp.isWorkstation&&!(mstrApp.getWSLiveMode&&mstrApp.getWSLiveMode())){var AZ=new mstrmojo.onetier.vi.prefs.DesktopConnectivityProxy(),Aa=this;AZ.getSavedPreferences({success:function(Ad){var Af=Ad.feature_flag||{},Ae=Af[L];B.call(Aa,Ae,Ab);}});}else{var AW=mstrmojo.global.localStore;B.call(this,AW.getItem(L),Ab);}return AX;},unrender:function E(AW){this.closePopup();this._super(AW);},setDimensions:function AC(AZ,AX){this._super(AZ,AX);var AY=this.handleNode,AW=AY&&AY.style;if(AW){AW.top=0;AW.left=AX;AW.height=AZ;AW.width="6px";}},getSplitterInfo:function AI(){return{min:120,max:Math.max(parseInt(this.parent&&this.parent.width,10)/2,330)};},postCreate:function h(){var AW=this.getSplitterInfo().min,AX=Y.windowDim().w/2;if(parseInt(this.width,10)<AW){this.set("width",AW);}if((AX>=AW&&parseInt(this.width,10)>AX)||parseInt(this.width,10)>2000){this.set("width","174px");}},splitterMoved:function W(AW){var AY="width",AX=parseInt(this[AY],10)+AW;this.set(AY,AX+"px");this.parent.doLayout();this.getPanelSaver().saveProperty("size",AX);},passToolbarCfg:function S(AW){var AX=this.titleBar.toolbarCfg;if(AX){AX.destroy();}this.titleBar.set("toolbarCfg",AW);},updateToolbar:function w(Ad){var Ac=mstrApp.isSingleTier;var AY=this.id,Ae=this,Ab=this.contents.children,Aa=N.call(this),Af=Ac?mstrmojo.desc(14305,"Add New Data"):mstrmojo.desc(11780,"Add Data");Ad.hostId=this.id;Ad.isHostedWithin=false;Ad.supportsScroll=true;Ad.maxHeight=Y.getMaxScrollHeight();if(!Ae.model.hasMDXRADataset(Ae.model.datasets)){if((mstrApp.isWorkstation&&Ae.model.allowImportData())||Ae.model.allowManageDocumentDataset()){if(mstrApp.isInVFConfigMode){Ad.addNonInteractiveMenuItem(Af,"",true);}else{Ad.addPopupMenuItem(Af,AY,AM(Ae),"");}}}if((p()||Ae.getDatasetCount()>1)&&Ae.model.allowManageDocumentDataset()&&!Ae.model.hasMDXRADataset()){Ad[(!mstrApp.isInVFConfigMode&&Ae.getDatasetCount()>0)?"addSubMenuItem":"addDisabledMenuItem"](mstrmojo.desc(11485,"Replace All Datasets"),"",this.id,AS(Ae,true));}Ad.addSeparator();if(AU(Ae.model)){Ad.addEditorMenuItem(mstrmojo.desc(11612,"Show Hidden Objects"),this.id,function(){return H(Ae.model);});}Ad.addSeparator();var Ag=a.valarray(Ae.data).some(function(Ah){return Ah.tables&&Ah.tables.length>1;});var AX=a.valarray(Ae.data).some(function(Ai){if(Ae.model.isMDXDataset(Ai)){var Ah=Ai.tables[0];return(Ah.dimensions&&Ah.dimensions.length>0)||(Ah.metricFolder&&Ah.metricFolder.folders&&Ah.metricFolder.folders.length>0);}return false;});if(Ag){Ad.addSeparator();Ad.addRadioMenuGroup(!!Ae.settings.useTableView,function(Ah){var Ai=Ae.settings;Ai.useTableView=Ah;Ae.model.raiseEvent({name:"updateUseTableView",useTableView:Ah});Ae.saveSettings();},[{value:false,text:mstrmojo.desc(11925,"Flat View")},{value:true,text:mstrmojo.desc(11926,"Table View")}],"",null,true);}if(Ab&&(Ab.length>1||(Ag&&Ae.settings.useTableView)||AX)){Ad.addSeparator();var AZ=true,AW=true;if(Aa.length<Ab.length){AZ=false;AW=false;}else{AZ=J.call(Ae,false);AW=J.call(Ae,true);}if(!AZ){Ad.addDisabledMenuItem(mstrmojo.desc(11816,"Expand All"),"expand-all");}else{Ad.addMenuItem(mstrmojo.desc(11816,"Expand All"),"expand-all",function(){Ae.toggleAllNodesCollapsed(false,true);});}if(!AW){Ad.addDisabledMenuItem(mstrmojo.desc(11817,"Collapse All"),"collapse-all");}else{Ad.addMenuItem(mstrmojo.desc(11817,"Collapse All"),"collapse-all",function(){Ae.toggleAllNodesCollapsed(true,true);});}}Ad.addSeparator();Ad.addMenuItem(mstrmojo.desc(1143,"Help"),"help",function(){mstrApp.showHelpTopic("datasets_panel.htm");});return Ad;},getShowDatasetPicker:function(AW){var AX=this;return function(){var AY=AO(a.copy(AW,{id:"mstrIVE_DS",multiSelect:true,onOk:function(){f.call(AX,function(){AX.model.addDataset(AY.selectedItems);});}}));AY.open();};},openDatasetEditor:function(Aa){var AX=Aa.docModel,AW=AX.controller,Ab=this,AZ=AX.datasets,AY=a.copy(Aa,{onOk:function(Ad){var Ac=this,Ae=AN.wrapMethods(AW.getRefreshCallback(),{failure:function(Af,Ag){this.canceled(Ag.id);}});if(Ad.length){AW.cmdMgr.execute({execute:function(){this.submit(Ad,AN.wrapMethods(Ae,{success:function(){Ac.close();}}),{skipUICmdMgrOnFailure:v(),style:{params:{treesToRender:3}}});},urInfo:{callback:Ae}});}},closeOnSubmit:false,hasLTSDataset:AX.hasLTSDataset(AZ),derivedMetricCount:AX.getDerivedMetricCount(Aa.dataset)});this.model.controller.rootCtrl.loadDataProvider(function(Ac){AY.dataProvider=Ac;var Ad=new mstrmojo.vi.ui.DatasetEditor(AY);Ab.datasetEditorId=Ad.id;Ad.open();});},onDatasetFilterChange:function(AW){if(AW&&this.settings.dataset(AW).isCollapsed){K([{dsid:AW,isCollapsed:false}],this);}this.generateToolbar();this.updateScrollbars();},showDataImport:function AJ(AX){AX.hasNonRADataset=this.model.hasNonRADataset();var AZ;if(this.dataImportId){AZ=mstrmojo.all[this.dataImportId];}if(!AZ){AZ=mstrmojo.insert(mstrmojo.DI.DIContainer);}this.dataImportId=AZ.id;var AY=this,AW=function(){a.copy(AX,AZ.dataImportParams);AZ.open();};var Aa=function(){var Ab=AX&&AX.missingCredentialsData,Ad={},Ae=function(Ai,Aj){if(!Ai||Aj[Ai.id]){return ;}if(Ai.id&&Ai.destroy){Aj[Ai.id]=true;}if(Ai.constructor===Array){for(var Ag=0;Ag<Ai.length;Ag++){Ae(Ai[Ag],Aj);}}else{if(typeof Ai==="object"){var Ah;for(Ah in Ai){if(Ai.hasOwnProperty(Ah)){Ae(Ai[Ah],Aj);}}}}};Ae(Ab,Ad);var Af;for(Af in Ad){if(Ad.hasOwnProperty(Af)){var Ac=mstrmojo.all[Af];if(Ac&&Ac.destroy){Ac.destroy();}}}};if(AX.callback){AZ.dataImportCallback=function(Ab){AX.callback(Ab);Aa();};AW();}else{AZ.dataImportCallback=function(Af){var Ad=[],Ah=AY.model.cmdMgr(),Ag=Ah.getInterimCmd();if(Af){Ad=(Af||[]).filter(function(Ai){return !AY.model.datasets[Ai.did]&&!Ai.mngd;});if(Ad.length){AY.model.addDataset(Ad,{success:function(){Ag.completeSubmit();}});}else{var Ac=AY.model.controller.getRefreshCallback(),Ae=AX.needDefn?j:null;Ag.urInfo.callback=Ac;Ag.resetCmdMgrOnComplete();Ag.submit(AY.model.getOpenDatasetPanelAction(),Ac,Ae,Ah.CMD_PHASE.LAST);}}else{var Ab=Ag.urInfo;Ab.callback={success:mstrmojo.emptyFn};Ab.treesToRender=0;Ag.cancel();}Aa();};f.call(AY,AW);}}});}());(function(){mstrmojo.requiresCls("mstrmojo.OIVMDocSelectorViewFactory","mstrmojo.DocSelector","mstrmojo.vi.models.VIComponentMap","mstrmojo.vi.models.editors.FilterEditorModel","mstrmojo.vi.ui.rw.selectors._IsDocSelector","mstrmojo.vi.ui.rw.selectors._IsPageBySelector","mstrmojo.vi.ui.rw.selectors._IsFilterSelector","mstrmojo.vi.ui.rw.selectors._HasWarningMessage","mstrmojo._HasLayout");var C=mstrmojo.vi.models.VIComponentMap.TYPES;function D(G,E,F){return this.docBuilder.getLayoutVIMap(G.defn._lkz).isComponent(F,E);}mstrmojo.vi.ui.rw.selectors.DocSelectorViewFactory=mstrmojo.declare(mstrmojo.OIVMDocSelectorViewFactory,null,{scriptClass:"mstrmojo.vi.ui.rw.selectors.DocSelectorViewFactory",docBuilder:null,getDocSelectorClass:function A(I,J,H,L){var E=[mstrmojo._HasLayout,mstrmojo.vi.ui.rw.selectors._IsDocSelector,mstrmojo.vi.ui.rw.selectors._HasWarningMessage],G=L.pk,F=J.defn,K=this._super(I,J);if(D.call(this,J,G,C.PAGEBY_PANEL)){E.push(mstrmojo.vi.ui.rw.selectors._IsPageBySelector);}if(D.call(this,J,G,C.FILTER_PANEL)){E.push(mstrmojo.vi.ui.rw.selectors._IsFilterSelector);}return mstrmojo.DynamicClassFactory.newComponent(K,E,null);},newDocSelector:function B(G,H,F,J){var I=this.getDocSelectorClass(G,H,F,J),E=J.pk,K=new I({id:H.id,node:H,controller:G.controller,model:G,slot:this.docBuilder.defaultSlot});if(!D.call(this,H,E,C.PAGEBY_PANEL)&&!D.call(this,H,E,C.FILTER_PANEL)){K.edtModel=new mstrmojo.vi.models.editors.FilterEditorModel({hostId:K.id,docModel:G});K.addDisposable(K.edtModel);}if(H.defn&&H.defn.style===9){K.filterElemALL=true;}return K;}});}());(function(){mstrmojo.requiresCls("mstrmojo.DocModel","mstrmojo.func","mstrmojo.array","mstrmojo.expr","mstrmojo.hash","mstrmojo.num","mstrmojo.string","mstrmojo.elementHelper","mstrmojo.EnumRWUnitType","mstrmojo.boxmodel","mstrmojo.models.FormatModel","mstrmojo.DocDataService","mstrmojo.mstr.EnumDataType","mstrmojo.DI.DIConstants","mstrmojo.vi.models._LayoutActions","mstrmojo.vi.models._PanelActions","mstrmojo.vi.models._FilterStackActions","mstrmojo.vi.models._VisActions","mstrmojo.vi.models._FieldActions","mstrmojo.vi.models._DataGridActions","mstrmojo.vi.models._IsNLPModel","mstrmojo.vi.models._NotificationVisFilter","mstrmojo.vi.controllers.EnumEvents","mstrmojo.Button","mstrmojo.mstr.EnumWebAPIErrorCodes","mstrmojo.mstr.EnumDSSXMLBaseFormType","mstrmojo.DocSelector","mstrmojo.vi.enums.EnumFeatures","mstrmojo.ME.MetricDataService","mstrmojo.vi.viz.EnumVizStyles");mstrmojo.requiresClsP("mstrmojo.vi.models","PanelFormatSaver","EnumPanelTypes","VIComponentMap");mstrmojo.requiresClsP("mstrmojo.vi.ui","DatasetObjects","DocDatasetObjects","DatasetUnitMenuUtils");var a=mstrmojo,AE=a.func,CY=a.array,BN=a.boxmodel,Aw=a.hash,C=a.num,BB=a.string,Ci=a.elementHelper,CK=a.mstr.EnumWebAPIErrorCodes,CX=a.vi.ui.DatasetUnitMenuUtils,AW=a.expr,AR=AW.ET,AP=AW.FN,z=mstrmojo.models.FormatModel,CJ=z.getFormatUpdate,A0=z.ENUM_PROPERTY_NAMES,CI=a.EnumRWUnitType,Ae=mstrmojo.DocSelector.STYLES,Cy=mstrmojo.mstr.EnumDSSXMLBaseFormType,Cu=a.mstr.EnumDataType,R="\u001E",AG=a.vi.models,Cn=AG.EnumPanelTypes,BD=mstrmojo.vi.models.VIComponentMap.TYPES,K=BD.MAIN_CONTENT,CA=BD.VIZ_CONTENT,Co=BD.PAGEBY_PANEL,H=[CA],Cv=mstrmojo.DI.DIConstants,BU=Cv.xdaType,Y=Cv.backendSourceSubtype,F=Cv.datasetServeMode,AN=Cv.dbType,CG=mstrmojo.vi.controllers.EnumEvents,CR=mstrmojo.DocSelector.STYLES,As=mstrmojo.vi.enums.EnumFeatures,CW=mstrmojo.mstr.EnumNodeProperties,S=mstrmojo.ME.MetricDataService,AS=mstrmojo.vi.viz.EnumVizStyles;var c=12,N=4,O="$";var CQ=3076;var BE=2;var CH=8;var Bw=mstrmojo.DocModel.fnBuildId;mstrmojo.vi.models.DatasetInfoType=null;mstrmojo.vi.models.DEObjectType=null;function n(C2){return mstrmojo.resolveFeature(C2);}function Bb(C2,C3){return(C2===47&&C3!==12033)||C2===1;}function AF(C3){var C5=this.controller.view.getLayouts(),C2=C5.length,C4;for(C4=0;C4<C2;C4++){this.data.layouts[C4].loaded=false;if(C3){C5[C4].defn.loaded=false;}}}function BL(C3,C4){if(!C4){return false;}var C2=false;C3=C3||this.datasets;Aw.forEach(C3,function(C5){if(C4(C5)){C2=true;return false;}},this);return C2;}function Ai(C2){this.raiseEvent({name:"updateHasUnpublishedCube",hasUnpublishedCube:C2});}function Ay(){this.raiseEvent({name:"updateDatasets",datasets:this.datasets,datasetsSettings:this.datasetsSettings});}function BY(){var C2=this.unpublishedCubes;Aw.forEach(this.datasets,function(C3,C4){CY.forEach(C2,function(C5){if(C5.did===C4){C3.unpublished=!C5.published;return false;}});});}function CD(){var C5=Object.keys(this.datasets),C3=CY.filter(this.unpublishedCubes,function(C7){return CY.indexOf(C5,C7.did)>-1;}),C2=CY.map(C3,function(C7){if(!C7.published){return C7.did;}}),C4=this,C6={success:function(C7){C4.setUserDICubeInfo(C7);},complete:function(){BY.call(C4);Ay.call(C4);}};if(C2.length>0){this.getDataService().getUserDICubeInfo(C2,C6);return true;}return false;}function Bd(C2,C4,C3,C5){CJ(A0.HEIGHT,mstrmojo.boxmodel.px2Inches(this.getZoomProps(),this.getCtrlHeightByStyle(C4,C3&&(C5?C3+1:C3)||((C4===CR.RADIO||C4===CR.CHECKBOX)?CH:0)+(C5?1:0))),C2);}function Cw(C4,C2,DA,C9,C7,C6,DE){C9=C9||this.currlaykey;var C8=this;var DB=this.defn.layouts.filter(function(DF){return DF.k===C9;})[0],C5=DA===C9?DB:DB.units[DA],C3=function C3(DF){return z.getFormatUpdate(C6,DF);},DC={k:DA,defn:C5},DD;if(C7){DE=AE.wrapMethods({success:function(DH){var DG=C8.getLayoutDefn(C9),DF=DA===C9?DG:C8.getLayoutUnitDefn(DA,C9);DF[C7]=DH;}},DE);}if(DA===C9||(C5&&C5.t)===CI.PANEL){DE=AE.wrapMethods(DE,{success:function(){C8.raiseEvent({name:CG.UPDATE_TOC});},failure:function(){C8.raiseEvent({name:CG.UPDATE_TOC});}});}DD=DE.success;DE.success=function(DF){DD(z.getValueFromUpdate(C6,DF)||C4);};this.updateUnitFormatWithUndo(DC,1,C3(C4),C3(C2),DE);}var Cx=mstrmojo.DocDataService.REQUEST_DEFN_DATA;var Cq=mstrmojo.DocDataService.REQUEST_ONLY_DATASETS;function P(C4,C2,C3,C6,C5){C6=C6||this.getNextKey();C5=C5||this.getCurrentLayoutKey();var C8={k:C6,wid:1},C7={k:C6,id:this.getWidgetId(C8,C5),defn:{fmts:{top:"0px",left:"0px",height:"100px",width:"100px"},_lkz:C5},data:C8};if(C4){C7.data=C4(C8,C7);}if(C2){C7.defn=C2(C7.defn,C7);}if(C3){C7=C3(C7);}return C7;}function B1(C2){var C3=this.controller.view.getLayouts();C3.forEach(function(C4){if(C4.k===C2){C4.defn.loaded=false;}});this.data.layouts.forEach(function(C4){if(C4.k===C2){C4.loaded=false;}});}function u(C5,C7,C4){var C2=this.controller,C3=C2.view.builder;C4=C4||this.getLayoutKeyByUnitKey(C7);var C6=this.getPanel(C7,C4);C7=C6.k;return C3.build([C5],this,{pk:C7})[0];}function BH(C4){var C2=this.getVIPanelKeyFromUnits(C4),C3=this.getTargetDefn(C2)[C2];return this.getUnitFormatAction({defn:C3,k:C2},1,{FormattingAppearance:{Visible:1}});}function w(C2,DA,C5,C8){var C6=this.getVIPanelKeyFromUnits(C2),C9=this.getTargetDefn(C6),C3=C5.data;var C7=this.getCurrentLayoutKey(),C4=Aw.walk(DA,C3.layouts.filter(function(DB){return DB.k===C7;})[0]);this.updateDataCache(C3,C9);C8.build(this.getChildren({data:C4,defn:C9[C6],id:this.getWidgetId(C4),k:C6}).filter(function(DB){return DB.k===C6;}),this);}function BR(C6,C3,C2,C5){var C4=this.id;this.getDataService().submitUpdates(BH.call(this,C6),{success:function(C7){w.call(mstrmojo.all[C4],C6,C3,C7,C2);C5();}},{preserveUndo:true});}function AX(C2,C3){return"1"+R+C2+R+C3;}function Cf(C2){var C3=C2.split(R);return{nodeKey:C3[1],ctrlKey:C3[2]};}function Bq(C4,C7,C2,C6){C6=C6||{};var C3=this,C8=(C4&&this.extractChildren(C4))||[],C5;C8.forEach(function(C9){C5=C9.k;C2=C2||C7.hasOwnProperty(C5);if(C2){C6[C5]=true;}Bq.call(C3,C9,C7,C2,C6);});return C6;}function l(C2){Aw.forEach(C2,function(C3){C3.att=CX.getSortedDatasetUnits(C3.att);C3.mx=CX.getSortedDatasetUnits(C3.mx);if(C3.tables&&!this.isMDXDataset(C3)){C3.tables.forEach(function(C4){C4.att=CX.getSortedDatasetUnits(C4.att);C4.mx=CX.getSortedDatasetUnits(C4.mx);});}},this);}function Cz(C3){var C2=this;if(typeof C3==="string"){if(C3.indexOf("{")===0){C3=JSON.parse(C3);}}C3=Aw.copy({dataset:function(C8){var C7=function(DA,C9){DA.getCollapsed=function(){return this.isCollapsed===undefined?C9.isCollapsed:this.isCollapsed;};};var C6=function(DC,DB,C9){this[DC]=this[DC]||{};var DA=this[DC][DB]=this[DC][DB]||{};C7(DA,C9);return DA;};var C5=function(){return C2.datasets[C8];};if(!C5()){return null;}var C4=C6.call(this,"datasets",C8,{isCollapsed:false});C4.hasCollapsedChildNodes=function(DB,DA){var C9=false,DC=this;Aw.forEach(C5().tableMap,function(DE,DD){var DF=DC.table(DD);if(DF.getCollapsed()===DB||(DA&&DF.hasCollapsedChildNodes(DB,DA))){C9=true;return false;}});return C9;};if(!C4.table){C4.table=function(DD){var DB=function(){return C5().tableMap[DD];};if(!DB()){return null;}var DC=C6.call(this,"tables",DD,{isCollapsed:false});DC.hasCollapsedChildNodes=function(){return false;};if(C2.isMDXTable(DB())){DC.hasCollapsedChildNodes=function(DH,DG){var DF=false,DI=this;Aw.forEach(DB().dimensionMap,function(DM,DK){var DL=DI.dimension(DK);if(DL.getCollapsed()===DH||(DG&&DL.hasCollapsedChildNodes(DH,DG))){DF=true;return false;}});if(DF){return DF;}var DJ=DI.rootMetricFolder;if(DJ.getCollapsed()===DH||(DG&&DJ.hasCollapsedChildNodes(DH,DG))){DF=true;}return DF;};if(!DC.dimension){DC.dimension=function(DF){var DH=function(){return DB().dimensionMap[DF];};if(!DH()){return null;}var DG=C6.call(this,"dimensions",DF,{isCollapsed:true});DG.hasCollapsedChildNodes=function(DJ){var DI=false,DK=this;Aw.forEach(DH().hierarchyMap,function(DL,DM){var DN=DK.hierarchy(DM);if(DN.getCollapsed()===DJ){DI=true;return false;}});return DI;};if(!DG.hierarchy){DG.hierarchy=function(DJ){var DI=function(){var DK=DH().hierarchyMap;return DK&&DK[DJ];};if(!DI()){return null;}return C6.call(this,"hierarchies",DJ,{isCollapsed:true});};}return DG;};}var DA=function(DG,DF){if(!DG.hasCollapsedChildNodes){DG.hasCollapsedChildNodes=function(DJ,DI){var DK=this,DH=false;Aw.forEach(DF().folderMap,function(DN,DM){var DL=DK.folder(DM);if(DL.getCollapsed()===DJ||(DI&&DL.hasCollapsedChildNodes(DJ,DI))){DH=true;return false;}});return DH;};}if(!DG.folder){DG.folder=function(DI){var DH=function(){return DF().folderMap[DI];};if(!DH()){return null;}var DJ=C6.call(this,"folders",DI,{isCollapsed:true});DA(DJ,DH);return DJ;};}};var C9=function(){return DB().metricFolder;},DE=DC.rootMetricFolder=DC.rootMetricFolder||{};C7(DE,{isCollapsed:false});DA(DE,C9);}return DC;};}return C4;},getSaveActions:function(){var C4=this;Aw.forEach(this.datasets,function(C6,C7){var C8=C2.datasets[C7];if(!C8){delete C4.datasets[C7];return ;}if(!C8.tables){delete C6.tables;return ;}Aw.forEach(C6.tables,function(DB,DA){var DC=C8.tableMap[DA];if(!DC){delete C6.tables[C7];return ;}if(C2.isMDXTable(DC)){var C9=function(DD,DE){Aw.forEach(DD.folders,function(DF,DG){if(!DE.folderMap[DG]){delete DD.folders[DG];return ;}C9(DF,DE.folderMap[DG]);});if(Aw.isEmpty(DD.folders)){delete DD.folders;}};Aw.forEach(DB.dimensions,function(DF,DE){var DD=DC.dimensionMap[DE];if(!DD){delete DB.dimensions[DE];return ;}Aw.forEach(DF.hierarchies,function(DI,DG){var DH=DD.hierarchyMap[DG];if(!DH){delete DF.hierarchies[DG];}});if(Aw.isEmpty(DF.hierarchies)){delete DF.hierarchies;}});if(Aw.isEmpty(DB.dimensions)){delete DB.dimensions;}C9(DB.rootMetricFolder,DC.metricFolder);delete DB.metricFolders;}});});var C5=JSON.stringify(this);return[C2.getUnitFormatAction(C2.getRootNode(),1,{FormattingAnalysis:{DatasetsSettings:C5}})];},save:function(){C2.execute({execute:function(){this.submit(C3.getSaveActions(),{},mstrmojo.DocDataService.RAPID_EXEC);},urInfo:{callback:C2.getDatasetsUpdateCallback()}});},unitOpr:function(C7,C8,C4){var C6,C5;this.units=this.units||{};this.units[C7]=this.units[C7]||{};C6=this.units[C7];if(C4!==undefined){if(C4){C5=C6[C8]=C4;}else{delete C6[C8];if(Aw.isEmpty(C6)){delete this.units[C7];}}}else{C5=C6[C8];}return C5;}},C3);return C3;}function Bh(C2,C3){this.datasetsSettings=Cz.call(this,C3);Aw.forEach(C2,function(C6,C8){C6.did=C8;if(C6.tables){var C5=function(C9){return function(DA){return C9.filter(function(DB){return DB.did===DA.did;})[0]||null;};},C4=C5(C6.att),C7=C5(C6.mx);C6.tableMap={};C6.tables.forEach(function(DA){C6.tableMap[DA.did]=DA;if(this.isMDXTable(DA)){var C9=function(DB){DB.folderMap={};DB.mxRefs=DB.mxRefs||[];DB.folders=DB.folders||[];DB.mx=(DB.mxRefs||[]).map(C7);DB.folders.forEach(function(DC){DB.folderMap[DC.n]=DC;C9(DC);});};DA.dimensionMap={};if(this.isRADataset(C6)){DA.dimensions.forEach(function(DB){DA.dimensionMap[DB.did]=DB;DB.recursiveAtt=[];(DB.hierarchies||[]).forEach(function(DD){var DC=C4(DD);if(DC){DB.recursiveAtt.push(DC);}});});}else{DA.dimensions.forEach(function(DB){DA.dimensionMap[DB.did]=DB;DB.hierarchyMap={};(DB.hierarchies||[]).forEach(function(DC){DB.hierarchyMap[DC.did]=DC;DC.att=(DC.attRefs||[]).map(C4);});});}DA.metricFolder=DA.metricFolder||{};C9(DA.metricFolder);}else{DA.attRefs=DA.attRefs||[];DA.att=(DA.attRefs||[]).map(C4);DA.mxRefs=DA.mxRefs||[];DA.mx=(DA.mxRefs||[]).map(C7);}},this);}},this);delete this.deMap;l.call(this,C2);this.set("datasets",C2);}function M(C2,C3){Aw.forEach(C3,function(C7,C6){var C4=C2[C6],C5=C4&&C4.att.concat(C4.mx),C8=C7.att.concat(C7.mx);if(C5){CY.forEach(C8,function(DA){var C9=CY.find(C5,"did",DA.did);if(C9<0){DA.ne=true;}if(DA.t===47&&DA.st===12033){var DB=C9<0?null:C5[C9];CY.forEach(DA.des,function(DC){if(!DB||CY.find(DB.des,"id",DC.id)<0){DC.ne=true;}});}});}});}function BG(C3,C5){var C2=this.getVIComponent(Co),C4=C2.id,C6=[C2.k];if(C3){C6.push(this.getVIComponentKey(K));}return function(C8){this.partialUpdate(C8.data,this.getTargetDefn(C6.join(R)),C8.defn,C5);var C7=mstrmojo.all[C4];C7.parent.rebuildChild(C7);}.bind(this);}function Ca(C2){var C4,C3=this.getCurrentLayoutKey();this.obCntrs=this.obCntrs||{};this.obCntrs[C3]=this.obCntrs[C3]||{};C4=this.obCntrs[C3][C2];if(isNaN(C4)){C4=0;Aw.forEach(this.getCurrentLayoutDef().units,function(C5){if(C5.t===C2){C4++;}});this.obCntrs[C3][C2]=C4;}return C4;}function k(C7){if(!C7||(C7.node&CW.DRILL)){return ;}if((C7.nds||[]).length===0){return C7;}var C4=C7.nds||[];var C6=C4.length;if(C6!==2){var C3=true,C8=false;CY.forEach(C4,function(C9){C3=C3&&(C9.node&CW.DRILL);C8=C8||(C9.node&CW.DRILL);});if(C8&&!C3){throw {message:"something is wrong"};}if(!(C3||C8)){return C7;}}else{var C5=C4[0],C2=C4[1];if((C5.node&CW.DRILL)&&!(C2.node&CW.DRILL)){C5=C4[1];C2=C4[0];}if(!(C2.node&CW.DRILL)){return C7;}if(C5.node&CW.DRILL){return ;}return k(C5);}}mstrmojo.vi.models.DocModel=mstrmojo.declare(mstrmojo.DocModel,[mstrmojo.vi.models._LayoutActions,mstrmojo.vi.models._PanelActions,mstrmojo.vi.models._FilterStackActions,mstrmojo.vi.models._VisActions,mstrmojo.vi.models._FieldActions,mstrmojo.vi.models._DataGridActions,mstrmojo.vi.models._NotificationVisFilter,mstrmojo.vi.models._IsNLPModel],{scriptClass:"mstrmojo.vi.models.DocModel",datasets:null,deObjectMap:null,controller:null,lastSavedStid:0,lastModifiedTime:null,toolbarModelStates:{presModeFiltersAvailable:false,presModeTOCVisible:false},_selectedUnitId:null,_latestSelectedViUnitKey:null,init:function Ct(C2){if(!mstrApp.isSingleTier&&C2&&C2.prefs){C2.prefs.rtprnt=mstrApp.drillRtnPrntVal;}this._super(C2);Bh.call(this,this.datasets,this.datasetsSettings);if(mstrApp.isSingleTier&&this.hasUnpublishedCube()&&mstrApp.isAppStatePause()){CD.call(this);}},getVIMap:function CZ(C2){return this.getDocBuilder().getLayoutVIMap(C2||this.getCurrentLayoutKey());},getVIComponent:function A7(C3,C2){return this.getVIMap(C2).getComponent(C3);},getVIComponentKey:function AM(C3,C2){return this.getVIMap(C2).getComponentKey(C3);},buildKeyContext:AX,loadHiddenVIStack:BR,buildLoadedVIStack:w,getShowVIStackAction:BH,getVIPanelKeyFromUnits:function CM(C4,C2){var C3=this.getLayoutDefn(C2||this.getCurrentLayoutKey()).units;return Object.keys(C3).filter(function(C5){return C3[C5].psType===C4;})[0];},updateTitle:function Aa(C5,C4,C3,C2,C7,C6){Cw.call(this,C5,C4,C3,C2,C7,A0.TITLE,C6);},createNewUnitNode:P,getPanel:function Bk(C5,C4){var C3=this,C2=C5?mstrmojo.all[this.getWidgetId({k:C5,wid:1},C4)]:this.getVizContentPanel(C4);if(!C2&&C5&&!C4){CY.forEach(this.defn.layouts,function(C6){C2=mstrmojo.all[C3.getWidgetId({k:C5,wid:1},C6.k)];return !C2;});}return C2;},createUnit:u,deferredInsertUnit:function AK(C7,C3,C6,C2,C4){var C5=C3.k;C7.setTreesToRender(3);C7.addCallbacks({success:function(C9){var DD=C3.defn._lkz,DB=C9.defn.layouts.filter(function(DI){return DI.k===DD&&DI.loaded;})[0],DC=!Aw.isEmpty(DB);if(!DC){B1.call(this,DD);return ;}var DG=this.getPanel(C6),C8=C3.nk,DA,DH,DE=this.currlaykey;this.controller.view.updateXtabStyles(DD,C9.data.layouts[CY.find(C9.data.layouts,"k",DD)].xtabStyles);this.updateDefnCache(C9.defn,[C5,DG.k]);this.updateDataCache(C9.data,this.getTargetDefn(C5));if(this.getLayoutDataCache(DE)[DG.id]){DH=CY.filterOne(this.data.layouts,function(DI){return(DI.k===DE);});this.updateDataCache({layouts:[DH]},this.getTargetDefn(DG.k));}DG.update(DG.node);var DF=DC&&(!!this.getChildrenByKey(DG.node,false,[C5])[0]);if(DF){DA=DG.rebuildChild(DG.getUnitByKey(C5));this.selectVIUnit(DA.id,true,{isAddAction:true});}if(C8){DA.nk=C8;}}.bind(this)});this.getPanel(C6).addUnit(C3,C2,C4,C7,true);},markDirtyLayout:B1,getVizContentPanel:function AV(C2){return this.getVIComponent(CA,C2).getSelectedPanel();},getSelectedViUnit:function x(){return mstrmojo.all[this._selectedUnitId];},getVizOfSelectedViUnit:function B5(){var C7=this.getSelectedViUnit();if(!C7){return ;}var C4=C7.boxContent,C5=C4.model.data.visName||"VisGrid",C8=(typeof C4.getVisType==="function"?C4.getVisType():{}).vt,C6=this.controller.galleryPanel,C3=C5===AS.GRAPH_MATRIX||C5===AS.NEW_GRAPH_MATRIX;function C2(C9){var DA=typeof C9.vt==="object"?[C9.vt.v,C9.vt.h]:[C9.vt];return C3?C9.s===C5&&(DA[0]!==undefined&&C8===DA[0]||DA[1]!==undefined&&C8===DA[1]):C5===(C9.s||"VisGrid");}return CY.filterOne(C6.vizList.items.concat(C6.customVizList.items),C2);},resetSelectedViUnitId:function Am(){this._selectedUnitId=null;},getRootNode:function Cj(){var C2=this.defn.root;return{k:C2.k,defn:C2};},getHighLightNDECallback:function Bu(){var C2=this;return this.newCallback({method:"hightLightNDE",success:function(C4){var C5=C4.datasets,C3=[];Aw.forEach(C5,function(C6){CY.forEach(C6.att,function(C7){if(C7.t===47&&C7.st===12033){CY.forEach(C7.des,function(C8){if(C8.ne&&C8.t!==4){C3.push({id:C8.id,n:C8.n,es:C8.es,attId:C7.attId,unitId:C7.did});}});}});});if(C3.length>0){C2.callOnNDECreated(C3);}}});},callOnNDECreated:function(C3){var C2=this.getPanel();CY.forEach(C2.children,function(C4){if(C4.boxContent&&C4.boxContent.onNDECreated){C4.boxContent.onNDECreated(C3);}});},getRebuildCallback:function L(){var C2=this;return this.newCallback({method:"rebuild",success:function(DF){if(!C2.checkStatus(DF)){return ;}var DB=DF.data,DE=DF.defn,DC=DF.pukeys,DD=DC&&DC.split(R),DG={},C8;if(DD&&DD.length){if(DE){var DH=C2.getLayoutDefn(C2.getCurrentLayoutKey()),C4=DH&&DH.units,DI=(DH&&DH.cgbMap)||{},C5=DE.layouts,DA=C5&&C5[CY.find(C5,"k",C2.getCurrentLayoutKey())],C7=DA&&DA.units,C3=(DA&&DA.cgbMap)||{},C9=function(DJ){var DK=[];DJ.forEach(function(DM){if(!C4[DM]&&C7&&C7[DM]){var DL=C7[DM].pnk;if(DL){DK.push(DL);}}});return DK;},C6=C9(DD);while(C6.length){DD=DD.concat(C6);C6=C9(C6);}C8=CY.hash(DD);DG=Bq.call(C2,DB,C8,false);Aw.forEach(C8,function(DJ,DK){if(C3[DK]||DI[DK]){DG[DK]=true;}});}else{C8=CY.hash(DD);}C2.partialUpdate(DB,C8,DE,Aw.keyarray(DG));}else{if(C2.updateLayouts(DF)){C2.controller.view.updateLayouts(DF);}}}});},buildSliceUrInfo:function Cm(C7){var C9=C7.events||{K0:C7},C4=[],C3=2,C2,C8,C5=[],DA,C6=this;Object.keys(C9).forEach(function(DB){C2=C9[DB];C8=C2.ck;DA=C2.isNavigation;if(C8){var DC=Cf(C8);C4.push(DC.nodeKey,DC.ctrlKey);}if(DA&&C2.layoutKey){C5.push(function(){var DD=C6.controller.view.getLayoutByKey(C2.layoutKey);if(DD){DD.defn.loaded=false;}});}if(C2.changeInclude||C2.changeQual||DA){C3=3;}});return{extraPuKeys:C4,treesToRender:C3,undo:AE.composite(C5)};},getUIState:function Bn(){var C2={};H.forEach(function(C3){C2[C3]=this.getVIComponent(C3).getUIState();},this);return C2;},restoreUIState:function A5(C2){H.forEach(function(C3){this.getVIComponent(C3).restoreUIState(C2[C3]);},this);},cmdMgr:function Ba(){return this.controller.cmdMgr;},execute:function Ah(C2){return this.controller.cmdMgr.execute(C2);},slice:function AB(C2){var C3=this;this.execute({execute:function(){var C4=C3.getDataService().newUpdate(this);C3.sliceDeferred(C4,C2);if(C4.actions&&C4.actions.length>0){this.submitUpdate(C4);}},urInfo:C3.buildSliceUrInfo(C2)});},insertNewFilter:function A3(){var C7=this.id,C3=mstrmojo.all[C7],C5=C3.getDataService(),C6=C3.getVizContentPanel().k,C2=C3.getNextKey(),C4=C3.createNewUnitNode(null,function(C8,C9){C8.t=CI.SELECTOR;C8.ck=AX(C2,C9.k);C8.ckey=C9.k;return new mstrmojo.Model(C8);});this.execute({execute:function(){var DA=C5.newUpdate(this,{extras:Cx}),C8=C3.createUnit(C4,C6),C9=C8.k;DA.addActions([C5.getAddCtrlAction(C6,C2,C9,[C9]),C3.getUnitFormatAction(C4,5,CJ(A0.SHOW_TITLE_BAR,false)),C3.getUnitFormatAction(C4,1,CJ(A0.CONTROL_ITEM_WIDTH_MODE,0)),C3.getUnitFormatAction(C4,1,CJ(A0.CONTROL_EXPORT_AS_SHOWN_ON_WEB,1))]);C3.deferredInsertUnit(DA,C8,C6,null,null);this.submitUpdate(DA);},urInfo:{undo:function(){this.urInfo.callback={};var C9=C3.getPanel(C6),C8=C9.getUnitByKey(C4.k);if(C8){C9.deleteBoxAndSubmitDeferred(C3.getDataService().newUpdate(),C8,null,true);C8.destroy();}},redo:function(){if(C4){var C9=C5.newUpdate(this,{extras:Cx}),C8=C3.createUnit(C4,C6);C3.deferredInsertUnit(C9,C8,C6,null,null);if(this.urInfo){this.urInfo.callback=C9.callback;}}},extraPuKeys:[C6],treesToRender:3}});},insertExistingFilter:function Aj(C7,C8,C2){var C5=this,C3=this.getPanel().k,DA=this.getDataService(),DC=C7.defn,C6=C7.defn.tks.split(R),DD=this.getVizContentPanel().getTargetKeysByType([CI.GRID,CI.GRAPH,CI.MOJOVISUALIZATION]),DB=C5.getVIComponent(BD.FILTER_PANEL),C9=DB.id,C4=function(DE){DE.raiseEvent({name:"filterPanelUpdated"});};C5.execute({execute:function(){var DI=DA.newUpdate(this),DG=DB.children,DO=[],DF=[];DG.forEach(function(DQ){var DR=DQ.selector,DP=DR.tks;if(DP&&DP.indexOf(C7.k)!==-1){DF.push(DQ.k);DO.push(DQ);}});var DN=C5.createUnit(C7,C3),DK=DC.ck,DL=DC.srct,DJ=DC.srcst,DH=[],DE=false;C6.forEach(function(DP){var DQ=mstrmojo.array.ensureArray(DP);if(!DE){DQ.push(DC.pnk);DE=true;}DH.push(DA.getRemoveCtrlTargetAction(DK,DP,DQ));});DO.forEach(function(DP){DH.push(DA.getRemoveCtrlTargetAction(DP.selector.ck,C7.k,DP.k));});DD.forEach(function(DP){DH.push(DA.getAddCtrlTargetAction(DK,DP,DP,Bb(DL,DJ)));});DH.push(DA.getMoveControlAction(DK,C3));if(C2==="Top"||C2==="Bottom"){DH.push(C5.getUnitFormatAction(C7,1,CJ(A0.CONTROL_ORIENTATION,1)));}DH.push(C5.getUnitFormatAction(C7,1,CJ(A0.FILL_STYLE,0)));DH.push(C5.getUnitFormatAction(C7,5,CJ(A0.FILL_STYLE,0)));DH.push(C5.getUnitFormatAction(C7,1,CJ(A0.BORDER_COLOR,"#fefefe")));DI.addActions(DH);C5.deferredInsertUnit(DI,DN,C3,C8,C2);C6.push(DB.defn.pnk);var DM=C6.join(R);DI.callback={success:function(DP){var DR=C5.getPanel(C3),DQ=DR.getUnitByKey(C7.k);if(DQ&&DQ.clearFormats){DQ.clearFormats();}DB.refreshFP();C5.partialUpdate(DP.data,C5.getTargetDefn(DM),DP.defn,[C7.k,C3,DC.pnk].concat(DF));DO.forEach(function(DS){DB.rebuildChild(DS);});C4(DB);}};this.submitUpdate(DI);},urInfo:{undo:function(){this.urInfo.callback=C5.getRebuildCallback();var DF=C5.getPanel(C3),DE=DF.getUnitByKey(C7.k);if(DE){DF.removeChildren(DE);DE.destroy();mstrApp.rootCtrl.docCtrl.selectViPanel("filterPanel");}C4(DB);},redo:function(){DB=mstrmojo.all[C9];var DF=(DB.children||[]).filter(function(DI){return DI.k===C7.k;})[0];if(DF){DB.removeChildren(DF);DF.destroy();}delete C7.defn.iifp;var DH=DA.newUpdate(this),DG=C5.createUnit(C7,C3);if(!C8.parent){C5.getPanel(C3).children.forEach(function(DI){if(DI.k===C8.k){C8=DI;}});}C5.deferredInsertUnit(DH,DG,C3,C8,C2);var DE=C6.join(R);DH.callback={success:function(DI){var DJ=C5.getPanel(C3);DF=DJ.getUnitByKey(C7.k);if(DF&&DF.clearFormats){DF.clearFormats();}C5.partialUpdate(DI.data,C5.getTargetDefn(DE),DI.defn,[C7.k,C3,DC.pnk]);C4(DB);}};if(this.urInfo){this.urInfo.callback=DH.callback;}},extraPuKeys:[C5.getVIComponent(BD.FILTER_PANEL).k,C3]}});},adjustNodeId:function B6(C2){return C2+O;},restoreNodeId:function AC(C4){if(!C4){return ;}var C3=C4.length-1,C2=C4[C3];if(C2===O){return C4.substring(0,C3);}return C4;},selectVIUnit:function A4(C4,C2,C3){if(C2||C4!==this._selectedUnitId){this._selectedUnitId=C4;this._latestSelectedViUnitKey=C4&&mstrmojo.all[C4].k;this.raiseEvent(Aw.copy({name:"viUnitSelected",id:C4},C3));}},setVisActive:function Bm(C3,C2){this.raiseEvent(Aw.copy({name:"visActive",id:C3},C2));},setVizBoxActive:function Bs(C3,C2){this.raiseEvent(Aw.copy({name:"vizBoxActive",id:C3},C2));},getLatestSelectedViUnitKey:function D(){return this._latestSelectedViUnitKey;},getDocDatasetsPanel:function A(){var C3=this.getRootNode(),C4=C3.defn,C5=this.id,C2=new mstrmojo.vi.ui.DocDatasetObjects({data:this.datasets,visible:!!C4.dsv,width:C4.dsw,model:this,unit:C3,settings:this.datasetsSettings,getPanelSaver:function(){var C6=mstrmojo.all[C5];return AG.PanelFormatSaver.getPanelSaver(C6,{size:{set:"FormattingAnalysis",name:"DatasetObjectsWidth",convert:true},visible:{set:"FormattingAnalysis",name:"DatasetObjectsVisible"}});}});C2.subs=[];C2.subs[0]=this.attachEventListener("updateDatasets",C2.id,function(C6){C2.set("data",C6.datasets);C2.set("settings",C6.datasetsSettings);});C2.subs[1]=this.attachEventListener("viUnitSelected",C2.id,function(C7){var C6=mstrmojo.all[C7.id];C2.set("gridSource",C6&&C6.boxContent.model.data.datasetId);});C2.subs[2]=this.attachEventListener("cubePublishChange",C2.id,function(C6){this.onCubePublishChange(C6.cubeID,C6.unpublished);});return C2;},getVisPanelStackKey:function An(C4){var C2=this.getLayoutDefn(C4).units||[],C3=null;Aw.forEach(C2,function(C6,C5){if(C6.t===CI.PANELSTACK&&C6.psType===Cn.VISUALIZATION){C3=C5;return false;}});return C3;},getVisPanelKeys:function h(C5,C6){var C4=[],C2=this.getLayoutDefn(C5).units||[],C3=this.getVisPanelStackKey(C5);if(C3){Aw.forEach(C2,function(C8,C7){if(C8.t===CI.PANEL&&C8.pnk===C3&&!(C6&&C8._isDeleted)){C4.push(C7);}});}return C4;},getFilterPanelStackKey:function AH(C4){var C3=this.getLayoutDefn(C4).units||[],C2=null;Aw.forEach(C3,function(C6,C5){if(C6.t===CI.PANELSTACK&&C6.psType===Cn.FILTERS){C2=C5;return false;}});return C2;},getFilterPanelKey:function Bz(C3){var C2=this.getLayoutDefn(C3).units||[],C4=null;Aw.forEach(C2,function(C6,C5){if(C6.t===CI.PANEL&&C6.isFilterPanel){C4=C5;return false;}});return C4;},getCurrentLayoutSelectorDefn:function Bg(C6){var C4=this.getCurrentLayoutKey(),C8=this.getFilterPanelKey(C4),C3=this.getLayoutDefn(C4).units||[],C7={},C2={},C5;Aw.forEach(C3,function(DA,C9){if(DA.t===CI.SELECTOR&&!(C6&&DA._isDeleted)){C5=DA.pnk;if(C5===C8){C7[C9]=DA;}else{if(C3[C5]&&C3[C5].t!==CI.SUBSECTION){C2[C9]=DA;}}}});return{filterPanelSelectors:C7,canvasSelectors:C2};},hasCanvasSelOrTargetedSel:function B0(){var C4=this.getCurrentLayoutSelectorDefn(),C3=C4.canvasSelectors,C2=C4.filterPanelSelectors;if(!!Object.keys(C3).length){return true;}var C6=Object.keys(C2),C5=false;CY.forEach(C6,function(C7){var C9=C2[C7],C8=C9&&C9.tks&&C9.tks.split("\x1E");CY.forEach(C8,function(DA){if(C2[DA]){C5=true;return false;}});if(C5){return false;}});return C5;},getCurrentLayoutAndUnitDefn:function X(){var C3={},C2=this.getCurrentLayoutKey(),C4=this.getVizContentPanel(C2).k;C3.layoutDefn=this.getLayoutDefn(C2);C3.layoutUnitDefn=this.getLayoutUnitDefn(C4,C2);return C3;},getTocData:function BK(){var C2=[],C3=this;CY.forEach(this.defn&&this.defn.layouts,function(C9){var C7=[],C8=C9.k,C6=C3.getVisPanelStackKey(C8),C5=C3.getVisPanelKeys(C8,true),C4=C9.units;CY.forEach(C5,function(DA){var DB=C4[DA];C7[DB.chdidx-1]={pnk:DB.pnk,k:DA,chdidx:DB.chdidx,n:BB.decodeHtmlString(DB.ttl),l:DB.l,layoutKey:C8};});C7=CY.filter(C7,function(DA){return !!DA;});C2=C2.concat({k:C8,title:BB.decodeHtmlString(C9.title),loaded:C9.loaded,panels:C7,panelStackKey:C6});});return C2;},getDatasetsPanel:function BS(C5,C3,C4,C6){var C2=new mstrmojo.vi.ui.DatasetObjects({data:(!C4?this.datasets:C4(this.datasets)),width:C5||((!!mstrApp.isWSStyling)?"174px":"200px"),model:this,useTableView:this.datasetsSettings.useTableView,title:mstrmojo.desc(2870,"Objects"),filterFunc:C3,filterNodeConfig:C6||{att:true,mx:true}});C2.subs=[];C2.subs[0]=this.attachEventListener("updateDatasets",C2.id,function(C7){C2.set("useTableView",C7.datasetsSettings.useTableView);C2.set("data",!C4?C7.datasets:C4(C7.datasets));});C2.subs[1]=this.attachEventListener("updateUseTableView",C2.id,function(C7){this.set("useTableView",C7.useTableView);});C2.subs[2]=this.attachEventListener("cubePublishChange",C2.id,function(C7){this.onCubePublishChange(C7.cubeID,C7.unpublished);});return C2;},setUserDICubeInfo:function CV(C2){this.unpublishedCubes=CY.map(CY.filter(Object.keys(C2),function(C3){return !C2[C3].published;}),function(C3){return C2[C3];});Ai.call(this,this.hasUnpublishedCube());},updateCubePublishStatus:function Z(C3){var C5=this.datasets,C6,C4,C2=this;CY.forEach(CY.ensureArray(C3),function(C7){C6=C7.did;C4=!C7.published;if(C4!==!!C5[C6].unpublished){C5[C6].unpublished=C4;C2.raiseEvent({name:"cubePublishChange",cubeID:C6,unpublished:C4});}});},removeUnpublishedCubes:function BV(C2){var C3=CY.ensureArray(C2);this.unpublishedCubes=CY.filter(this.unpublishedCubes,function(C4){return CY.indexOf(C3,C4.did)===-1;});Ai.call(this,this.hasUnpublishedCube());},hasUnpublishedCube:function CO(){var C2=Aw.keyarray(this.datasets);return !!(this.unpublishedCubes&&CY.filter(this.unpublishedCubes,function(C3){return CY.indexOf(C2,C3.did)>-1;}).length);},updateDatasets:function Bc(C2,C3){if(!C2){return ;}M(this.datasets,C2);Bh.call(this,C2,C3);if(mstrmojo.resolveFeature(As.SUPPORT_NLP)&&this.buildWordBase){this.buildWordBase(true);}if(!this.hasUnpublishedCube()||!CD.call(this)){Ay.call(this);}},getDatasetsUpdateCallback:function Al(){var C2=this;return{success:function(C3){C2.als=C3.als;C2.updateDatasets(C3.datasets,C3.datasetsSettings);if(C3&&C3.defn&&C3.defn.efs){C2.defn.efs=C3.defn.efs;}}};},renameDataset:function BA(C3,C2,C5){var C4={act:"renameDataset",datasetID:C3,name:C2};this.controller.submitUndoRedoUpdates(C4,null,C5,Cq);},renameEmmaSrcTable:function Cg(C3,C4,C2,C5){this.getDataService().submitUpdates([{act:"renameEmmaSrcTable",dsid:C4,did:C3,n:C2}],C5,Cx);},addDataset:function J(C4,C5){if(!C4||!C4.length){return ;}var C6=this,C3=C6.controller;function C7(C9){var DB=[],C8=[];function DA(){var DF=C3.cmdMgr,DE=DF.getInterimCmd();if(DB.length>0){var DD={success:function(DG){C3.getRefreshCallback().success(DG);C3.datasetsPanel.set("allObjectBrowserOpened",false);},failure:function(){window.setTimeout(function(){var DG=DE.urInfo;DG.callback={success:mstrmojo.emptyFn};DE.cancel(true);},0);}},DC=DF.CMD_PHASE;DE.urInfo.callback=DD;DE.submit(DB,AE.wrapMethods(DD,C5),{skipUICmdMgrOnFailure:[CK.DOCDATA_PREPARE_TASK_REPORT_INCOMP],style:{params:{treesToRender:3}}},C5?DC.MIDDLE:DC.LAST);}else{DE.cancel();}}C4.forEach(function(DD){var DC=C9[DD.did];DB.push({act:"addDataset",did:DD.did,t:DD.t,g:Aw.keyarray(C3.datasetsPanel.data).length===1?1:0,disablePU:true});if(DC&&!DC.published){if(!(DC.dda===1&&DC.ddam===F.dda)&&DC.dda!==3){DB.pop();C8.push(DD);}}});if(DB.length){DB=DB.concat(C6.getOpenDatasetPanelAction());}if(C8.length>0){mstrmojo.alert(mstrmojo.desc(13762,"The following datasets will not be added. You need to publish them first.")+" "+C8.map(function(DC){return"<br/>- "+mstrmojo.string.encodeHtmlString(DC.n);}).join(""),DA,null,null,null,{allowHTML:true});}else{DA();}}var C2=C4.map(function(C8){return C8.did;});if(mstrApp.isSingleTier){C7({});}else{this.getDataService().getUserDICubeInfo(C2,{success:function(C8){C7(C8);}});}},getReloadLayoutModelCallback:function Au(C3){var C2=this;return AE.wrapMethods({success:function(C4){AF.call(C2,true);C2.loadLayout(C4);}},C3);},getRemoveUnitUpdate:function Cr(C5){var C3=C5.unit,C2=C5.partialRetrievalKeys,C4=[{act:"removeUnit",unitKey:C3.k,unitType:C3.defn.t,clearTargets:C5.clearTargets}];if(C2){C4[0].partialRetrieval={nodes:C2};}return this.getDataService().newUpdate(null,{actions:C4});},getCopyEmptyTemplateAction:function CT(C6,C2,C4){var C5=this.getLayoutDefn(C4||this.getCurrentLayoutKey());var C3=C5.units;var C7=C5.btn;if(!C7){Aw.forEach(C5.units,function(DA,C8){var C9=C3[DA.pnk];if(DA.n==="SourceGrid"&&DA.chdidx===1&&DA.t===521&&C9&&C9.n==="Body Footer"){C7=C8;return true;}});}return{act:"copyUnit",unitKey:C7,unitType:521,newKey:C6,toKey:C2,partialRetrieval:{nodes:[C6]}};},getToggleHiddenObjectAction:function BC(C4,C3,C2){return{act:"editDocUnitProp",dsid:C4,unitId:C3.did,unitType:C3.t,prop:BE,value:C2?"1":"0"};},updateUnitFormatWithUndo:function A2(C5,C6,C7,C3,C9){var C8=this.getDataService(),C4=this,C2=function(){var DA=this,DB=C8.newUpdate(DA,{actions:[C4.getUnitFormatAction(C5,C6,DA.getStateValue(C7,C3))],callback:Aw.copy({success:function(){C9.success(C7);}},Aw.copy(C9)),extras:mstrmojo.DocDataService.SUPPRESS_DATA});DB.submit();};this.execute({execute:C2,urInfo:{silent:true,undo:function(){C9.success(C3);},redo:function(){C9.success(C7);}}});},renameRWUnit:function AZ(C2,C3,C4,C5){Cw.call(this,C2,C3,C4,this.currlaykey,"n",A0.NAME,C5);},getRemoveControlUpdate:function e(C2,DA,C3){var C9=this.getDataService(),C5=C9.newUpdate(),C8=[DA].concat(C3.split(R)),C4=C9.getRemoveCtrlAction(C2,C8),C7=this,C6={success:function(DB,DD){var DF=JSON.parse(DD.params.params),DC=DF.partialRetrieval,DE=(DC&&DC.nodes)?DC.nodes.join(R):"";C7.partialUpdate(DB.data,C7.getTargetDefn(DE),DB.defn);}};C5.addActions(C4);C5.addCallbacks(C6);return C5;},findKeyMap:function Cs(C6){var DC=this.mapLayKeys;if(!DC){return null;}var C8=DC.oldKey,DG=DC.newKey,C9=C8?this.getLayoutDefn(C8):null,DB=DG?this.getLayoutDefn(DG):null,DA=C6.k,C3={},DI,DF,DH,C7;var DE=function(DK){var DJ={};Object.keys(DK.units).forEach(function(DL){var DN=DK.units[DL],DM=DN.pnk;if(DM){var DO=DJ[DM]=DJ[DM]||[];DO[DN.chdidx]=DL;}});return DJ;};var C2=function(DL,DN,DK,DM){if(DL===DN||!DN){return[];}var DO=DM[DN].pnk,DJ=DM[DN].chdidx;DI=C2(DL,DO,DK,DM).concat(DJ);return DI;};var C5=function(DJ,DN,DL){var DM=DJ[DL];if(DN.length>0&&DM){var DK=DN.shift();return C5(DJ,DN,DM[DK]);}return DM;};var C4=DE(DB);if(C9){if(!C9.loaded){return null;}var DD=DE(C9);DI=C2(DG,DA,C4,DB.units);DF=C5(DD,DI,C8);DH=C4[DA];for(C7=0;DF&&C7<DF.length;C7++){if(DF[C7]){C3[DF[C7]]=DH[C7];}}}else{C3["default"]=CY.filterOne(C4[DA],function(DJ){return !!DJ;});}return C3;},loadHiddenPageByStack:function At(C2,C3){BR.call(this,Cn.PAGEBY,"sections.0.subsections.0.objects.0.panels.0",C2,C3);},getCtrlStyleFromDatasetUnit:function V(DD,C7){if(DD.um&&DD.isTopRank){return Ae.METRIC_QUAL;}var DB=DD.t,C9=DD.card||0,DF,DC;if(C9===-1){DF=Ae.SEARCH_BOX;DC=Ae.SEARCH_BOX;}else{DF=C9<=15?(C7?Ae.CHECKBOX:Ae.LINK):C9<=100?Ae.CHECKBOX:Ae.SEARCH_BOX;DC=C9<=50?Ae.SCROLLER:C9<=1000?Ae.CHECKBOX:Ae.SEARCH_BOX;}var DE={12:{3:DF,2:DC,8:Ae.ATTR_QUAL,1:Ae.ATTR_QUAL,9:DC,11:DC,"default":DF},4:{1:Ae.METRIC_SLIDER,6:Ae.METRIC_SLIDER,9:Ae.METRIC_QUAL,16:Ae.METRIC_QUAL,30:Ae.METRIC_SLIDER,31:Ae.METRIC_SLIDER,"default":Ae.METRIC_SLIDER},1:Ae.CHECKBOX,47:Ae.CHECKBOX}[DB];if(DB===c){if(DD.lock){return Ae.ATTR_QUAL;}if(DD.st===CQ){return Ae.CHECKBOX;}if(DD.de&&DE[DD.formType]===Ae.ATTR_QUAL){return DE["default"];}if(!C9){var C5=this.datasets,C3,C6,DA,C2,C4=false,C8=function(DG){DA=DG.formType;C2=DG.did===DD.did&&!DG.card;C4=C4||C2;return C2;};for(C3 in C5){C6=C5[C3];if(C6.att.some(C8)&&(C6.dsm===2||C6.idd)){if(DA===Cy.DssXmlBaseFormDate||DA===Cy.DssXmlBaseFormDateTime){return DE[DA]||DE["default"];}return Ae.SEARCH_BOX;}}if(!C4){DA=DD.formType;if(DA&&(DA===Cy.DssXmlBaseFormDate||DA===Cy.DssXmlBaseFormDateTime)){return DE[DA]||DE["default"];}return Ae.SEARCH_BOX;}}return DE[DD.formType]||DE["default"];}if(DB===N){if(mstrApp.isAppStatePause&&mstrApp.isAppStatePause()){return Ae.METRIC_QUAL;}return DE[DD.dt||"default"]||DE["default"];}return DE;},getCtrlHeightByStyle:function Ak(C3,C2){var C4={"default":140,4:C2>15?243:235,9:140,1:100,3:C2>15?243:235,0:80,7:100,8:86,11:100,12:50};if((C3===3||C3===4)&&C2<=8){return 26*Math.max(C2,2)+27;}return C4[C3]||C4["default"];},getICSCtrlMoveHeightByStyle:function Az(C2){var C3={"default":20,4:20,9:40,1:60,3:20,0:60,7:60,8:60,11:60};return C3[C2]||C3["default"];},getCtrlActionsByStyleForVisFilter:function BW(C3,C5){var C2={},C4=[];if(C5!==undefined){CJ(A0.Z_INDEX,C5,C2);}C4.push({act:"format",unitKey:C3,unitType:CI.GRAPH,formatType:1,format:C2});return C4;},getSelectorPropsChangeAction:function W(C2,C3){var C4=C2.defn.ck;return[Aw.copy(C3,{act:"editSelectorProps",keyContext:C4,ctrlKey:C2.k,partialRetrieval:{nodes:[this.getDataService().getNodeKeyFromKeyContext(C4)]}})];},submitToggleShowAllActions:function AI(C4,C7,C8){var C3=this,C2=C4.isInFilterPanel(),C6=C4.k;this.controller.submitUndoRedoUpdates(C7,{},AE.wrapMethods({success:function C5(C9){C3.partialUpdate(C9.data,C3.getTargetDefn(C6),C9.defn,[C6]);if(mstrApp.isAppStatePause&&mstrApp.isAppStatePause()){var DB=C3.getTargetDefn(C6);if(DB&&DB[C6]){C4.toggleDisplayAll(DB[C6].showall);}}if(C2){var DA=C3.getVIComponent(BD.FILTER_PANEL);DA.rebuildChild(DA.children.filter(function(DC){return DC.k===C6;})[0]);}}},C8),Cx);},getCtrlActionsByStyleForToggleShowAll:function Ag(C6,C5){var C3={},C7=[],C8=C6.isInFilterPanel(),C2=C6.style,C9=C6.k,DB=this.getDatasetUnits(["att","mx"],function(DC){return DC.did===C6.defn.srcid;})[0],C4=DB.card,DA=C6.defn.ck;if(C8){Bd.call(this,C3,C2,C4,C5);C7.push({act:"format",unitKey:C9,unitType:CI.SELECTOR,formatType:1,format:C3,keyContext:DA});}return C7;},isNumericDataType:function Q(C2){return !C2||C2===Cu.DataTypeBigDecimal||C2===Cu.DataTypeCellFormatData||C2===Cu.DataTypeDecimal||C2===Cu.DataTypeDouble||C2===Cu.DataTypeFloat||C2===Cu.DataTypeInt64||C2===Cu.DataTypeInteger||C2===Cu.DataTypeLong||C2===Cu.DataTypeNumeric||C2===Cu.DataTypeReal||C2===Cu.DataTypeShort||C2===Cu.DataTypeUnsigned;},getCtrlActionsByStyle:function B(DD,DB,DE,C5,DG,C4,DC,C9){var C6={FormattingSize:{HeightMode:"0"}},DI=C6.FormattingSize,DH=Cf(DB),C8=DH.nodeKey,C3=DH.ctrlKey,C7=[],DF=this.getZoomProps(),C2=DD.n,DA=DD.card||0;CJ(A0.CONTROL_STYLE,DE,C6);if(C2){CJ(A0.NAME,C2,C6);}if(DD.t===N&&!this.isNumericDataType(DD.dt)){CJ(A0.CONTROL_METRIC_CONDITION_TYPE,1,C6);}if(C5){CJ(A0.CONTROL_ORIENTATION,C5,C6);}if(DG){DI.Height=C.toLocaleString(BN.px2Inches(DF,DG));}if(C4){DI.Width=C.toLocaleString(BN.px2Inches(DF,C4));}if(DC!==undefined){CJ(A0.Z_INDEX,DC,C6);}if(DA===0||DA>50){CJ(A0.CONTROL_ITEM_WIDTH_MODE,1,C6);}if(C9!==undefined){CJ(A0.CONTROL_SHOW_ELEMENT_COUNT,C9,C6);}CJ(A0.CONTROL_EXPORT_AS_SHOWN_ON_WEB,1,C6);C7.push({act:"format",unitType:CI.SELECTOR,keyContext:DB,formatType:1,format:C6});if(DD.isTopRank){C7.push(this.getDataService().getSelectorExpressionAction({ck:DB,ckey:C3,srcid:DD.did,srct:DD.t,f:1,ft:2,cs:DD.cs,dtp:Cu.DataTypeReal,type:1,include:true,changeQual:true,qt:DD.qt,unset:false}));}if(DE!==3){C7.push({act:"setControlShowAll",nodeKey:C8,controlKey:C3,showAll:true});}return C7;},clearMapLayout:function AJ(){delete this.mapLayKeys;delete this.replaceKeyBoxes;},isInDataset:function t(C4,C6,C2){C2=C2||["att","mx"];var C5=this.datasets[C4]||{},C3=false;CY.forEach(C2,function(C7){Aw.forEach(C5[C7]||{},function(C8){C3=C8.did===C6;return !C3;});return !C3;});return C3;},findDatasetIdFromUnit:function(C3){var C2=null;Aw.forEach(this.datasets,function(C4,C5){Aw.forEach((C4.att||[]).concat(C4.mx),function(C6){if(C6.did===C3){C2=C5;return false;}});if(!!C2){return false;}});return C2;},findUnitNameInDataSetFromUnit:function(C3){var C2=this.findUnitInDataSet(C3);return(C2&&C2.n)||null;},findUnitInDataSet:function(C3){var C2=null;Aw.forEach(this.datasets,function(C4){Aw.forEach((C4.att||[]).concat(C4.mx),function(C5){if(C5.did===C3){C2=C5;return false;}});if(!!C2){return false;}});return C2;},addShortcutMetric:function(C4,C5){var C2=C4.items,C3=this;C3.execute({execute:function(){var C6=[];if(S.isFuncHasUseLookupForAttributeProp(C4.funcType)){C6=[{n:"UseLookupForAttributes",v:"0"}];}this.submit(Aw.copyProps(["dsid","nodeKey","treeType","funcType","funcType2","prs","breakBys"],C4,{act:"addShortcutMetric",units:C2&&C2.length?C2.map(function(C7){return{id:C7.did,type:C7.t};}):[],prs:C6}),C5,{style:{params:{treesToRender:1}}});},urInfo:{callback:C5}});},submitDataDefnUpdate:function v(C2,C3){this.getDataService().submitUpdates(C2,C3,Cx);},rebuildUnitFromDataCache:function Ao(C4,C3,C2){return C2.build([this.getLayoutDataCache(this.getCurrentLayoutKey())[C4]],this,{pk:C3})[0];},getDocBuilder:function j(){return this.controller.view.builder;},submitUndoRedoFormatChange:function A9(DA,C3,C5,DD,C4){var C8=this,C9=DA.k,C6=DA.id,C2=DA.parent,C7=function(DE){var DF=[];Aw.keyarray(DE).forEach(function(DG){DF.push(C8.getUnitFormatAction(DA,DG,DE[DG]));});return DF;},DB=!!(DD&&DD.success);this.controller.submitUndoRedoUpdates(C7(C3),{},AE.wrapMethods({success:function DC(DF){C8.partialUpdate(DF.data,C8.getTargetDefn(C9),DF.defn,[C9]);if(!DB){var DE=mstrmojo.all[C6];C2.selectVIUnit(C2.rebuildChild(DE),true);}}},DD),C4||Cx);},removePageByUnit:function CU(C2,C4){var C7=this.getDataService(),C3=this,C5=false,C8={success:function C6(C9){BG.call(C3,true)(C9);C2.setOpenStatus(C5,true);C5=!C5;}};this.cmdMgr().execute({execute:function(){var C9=C3.getVIComponent(Co),DA=C7.newUpdate(this,{actions:[C7.getRemoveCtrlAction(C4.ckey,[C9.k,C3.getVIComponentKey(CA)]),C3.getUnitFormatAction(C9,1,CJ(A0.VISIBLE,false))],callback:C8});this.submitUpdate(DA);},urInfo:{callback:C8}});},changePageByStyle:function AT(C2,C3){var C5=C2.ckey,C4=this.getUnitFormatAction(C2.node,1,CJ(A0.CONTROL_ORIENTATION,1,CJ(A0.CONTROL_STYLE,C3)));this.controller.submitUndoRedoUpdates(C4,null,{success:BG.call(this,false,[C5])},Cx);},updateFilterTargetsForSdp:function AO(C4){var C3=mstrApp.primaryScdpMap,C2=[];CY.forEach(C4,function(C5){if(C3[C5]&&C3[C5].length>0){C2=C2.concat(C3[C5]);}});return C4.concat(C2);},changeFilterTargets:function Ab(C6,DE,C8,C3,C2){C8=this.updateFilterTargetsForSdp(C8);var DC=this.getDataService(),DH=C6.defn,C9=DH.ck,DA=DH.srct,C7=DH.srcst,DB=C6.k,DG=C8.filter(function(DI){return DE.indexOf(DI)<0;}),DF=DE.filter(function(DI){return C8.indexOf(DI)<0;}),C4=[DB].concat(DG).concat(DF),DD=function(DJ){var DK=this.getTargetDefn(DJ)[DJ],DI=DK&&DK.ck;if(DI){DJ=Cf(DI).nodeKey;}return DJ;}.bind(this),C5=DF.map(function(DI){DI=DD(DI);return DC.getRemoveCtrlTargetAction(C9,DI,DI,C3);}).concat(DG.map(function(DJ){var DK=this.getTargetDefn(DJ)[DJ],DM=DK&&DK.tks&&DK.tks.split(R)||[],DL=Bb(DA,C7),DI=DI;C4=C4.concat(DM);DJ=DD(DJ);DI=(DJ&&DL)?false:DI;return DC.getAddCtrlTargetAction(C9,DJ,[DJ].concat(DM),DL,DI,C2);}.bind(this)));if(C5.length===0){return ;}this.controller.submitUndoRedoUpdates(C5,null,{success:function(DJ){var DK=this.getVizContentPanel().getUnitByKey(DB),DI=C4.join(R);this.partialUpdate(DJ.data,this.getTargetDefn(DI),DJ.defn,[DB]);if(DK){DK.parent.rebuildChild(DK);}}.bind(this)},Cx);},changeFilterStyle:function Ce(C2,DG,DK,DL){var C4=C2.defn,DN=C2.node.data,DE=C2.isInFilterPanel(),DI=C2.style,DJ=C2.k,C8=C4.srct,DH=DN.ces||[],DA=C2.isRecursiveAttributeSelector(),DD=CJ(A0.CONTROL_STYLE,DG),DC=DK?1:(DK===false?-1:0),C6=DL?1:(DL===false?-1:0),DF=this.getDatasetUnits(["att","mx"],function(DO){return DO.did===C4.srcid;})[0],C7,DM={style:{params:{treesToRender:1}}};if(!DC){switch(DG){case CR.RADIO:DC=-1;break;case CR.PULLDOWN:case CR.BUTTON:case CR.LINK:case CR.LIST:DC=DH.length<=1?-1:1;break;case CR.CHECKBOX:case CR.SCROLLER:case CR.SEARCH_BOX:DC=1;break;}}if(DC){CJ(A0.CONTROL_MULTISELECT,DC>0,DD);}if(C6){CJ(A0.CONTROL_AUTOSEARCH,C6>0,DD);}if(DE){var DB=function(DO){return(DO===CR.SCROLLER||DO===CR.METRIC_QUAL||DO===CR.METRIC_SLIDER)?1:0;};C7=DB(DG);if(DB(DI)!==C7){CJ(A0.CONTROL_ORIENTATION,C7,DD);}var C3=DF.card,C5=C2.showall;Bd.call(this,DD,DG,C3,C5);}else{C7=C4.horiz?1:0;CJ(A0.CONTROL_ORIENTATION,C7,DD);}if((C8===N)||((DI===CR.SEARCH_BOX||DG===CR.SEARCH_BOX)&&C4.sos)||(DI===CR.ATTR_QUAL)||(DG===CR.ATTR_QUAL)||((DI===CR.CHECKBOX||DG===CR.CHECKBOX)&&DA&&DE)){DM=Cx;}var C9=function(){var DQ=this,DP=DQ.controller,DO=DP.cmdMgr;this.controller.submitUndoRedoUpdates(this.getUnitFormatAction(C2,1,DD),null,{failure:function(DR){var DS=null;if(DR.code===CK.DFC_QRYENG_RES_TRUNC){DS=function(){DO.cmds.pop();DO.pos--;C2.skipUR=true;DQ.changeFilterStyle(C2,CR.SEARCH_BOX);};}mstrmojo.error({longDesc:DR.message},DS,{onClose:DS,title:"Error"});},success:function(DS){this.updateDefnCache(DS.defn,[DJ]);this.updateDataCache(DS.data,this.getTargetDefn(DJ));if(C2.skipUR){C2.skipUR=false;DO.cmds.pop();DO.pos--;}if(DE){var DT=this.getVIComponent(BD.FILTER_PANEL);DT.rebuildChild(DT.children.filter(function(DU){return DU.k===DJ;})[0]);}else{var DR=this.getVizContentPanel().getUnitByKey(DJ);DR.parent.rebuildChild(DR);}}.bind(this)},DM);}.bind(this);if(DM===Cx&&DG!==CR.SEARCH_BOX&&DF&&DF.card>2000){mstrmojo.warn(mstrmojo.desc(13140,"This attribute has ## distinct values. Changing the display style may take a long time or potentially cause instability. Are you sure you want to continue?").replace("##",DF.card),{confirmBtn:{fn:C9}},{cssClass:"filterPanel-confirm"});}else{C9();}},setFilterDisplayForms:function C0(C5,C2){var C3=this,C4=C5.k,C6={act:"setControlAttributeForms",keyContext:C5.ck,ctrlKey:C5.ckey,treeType:"1",fs:CY.map(C2,function(C7){return C7.id;}),partialRetrieval:{nodes:[C4]}};this.controller.submitUndoRedoUpdates([C6],undefined,{success:function(C7){C5.lockSelection=true;C3.partialUpdate(C7.data,C3.getTargetDefn(C4),C7.defn,[C4]);C5.lockSelection=false;}},Cx);},replaceFilter:function BF(C4,C6){var C5=C4.defn,C3=C4.k,C8=C5.tks?C5.tks.split(R):[],C2=[C3].concat(C8),C7=this.getDataService().getReplaceCtrlAction(C5.ck,C5.ckey,C5.ct,C6.did,C6.t,C2);this.controller.submitUndoRedoUpdates(C7,null,{success:function(DA){var DB=this.getVizContentPanel().getUnitByKey(C3),C9=C2.join(R);this.partialUpdate(DA.data,this.getTargetDefn(C9),DA.defn,[C3]);if(DB){DB.parent.rebuildChild(DB);}}.bind(this)},Cx);},changeUnitFormatProperty:function U(C5,C2){var C3=C5.parent,C6=C5.k,C4=this;this.saveUnitFormatProperty(C5,C2,{success:function(C7){C4.partialUpdate(C7.data,C4.getTargetDefn(C6),C7.defn,[C6]);C3.selectVIUnit(C3.rebuildChild(C3.getUnitByKey(C6)),true);}},mstrmojo.DocDataService.REQUEST_ONLY_DEFINITION);},saveUnitFormatProperty:function AY(C9,C7,DA,C3,C5){var C8=this.getDataService(),C2=C9.parent,C6=C9.k,C4=this;C5=C5||{callback:DA};this.execute({execute:function(){var DB=C8.newUpdate(this,{extras:C3});[].concat(C7).forEach(function(DC){DB.addActions(C4.getUnitFormatAction(C2.getUnitByKey(C6),DC.formatType,CJ(DC.propertyName,this.getStateValue(DC.newValue,DC.oldValue))));},this);DB.addCallbacks(DA);DB.submit();},urInfo:C5});},saveGroupInfo:function Ad(C9,C2,C3){var C6=this,C4=C3.id,C8=[],C7=this.getDataService(),C5=function(DA){var DB=DA?C2:C9;return function(){var DC=mstrmojo.all[C4];Aw.forEach(DB,function(DE,DD){DC.getUnitByKey(DD).defn.gi=DE;});};};Aw.forEach(C9,function(DB,DA){var DC=C3.getUnitByKey(DA);C8.push(C6.getUnitFormatAction(DC,1,CJ(A0.GROUP_INFO,DB),true));});this.execute({execute:function(){var DA=C7.newUpdate(this,{extras:mstrmojo.DocDataService.SUPPRESS_DATA});C8.forEach(function(DB){DA.addActions(DB);},this);DA.addCallbacks({success:C5(false)});DA.submit();},urInfo:{undo:C5(true),redo:C5(false),slient:true}});},getKeepOnlyOrExcludeAction:function CL(C4,C5){var C7=this,C6={},C9,C3=C7.getSelectedViUnit(),C2=C3&&C3.boxContent,C8=!(C2&&C2.isInFilterPanel&&C2.isInFilterPanel());CY.forEach(C5,function(DA){CY.forEach(DA.data,function(DB){CY.forEach(DB,function(DC){if(Ci.isNonGroupNull(DC)){DC.eid="h"+Ci.TERSE_NULL+";"+DC.tid;}else{C9=DC.tid;if(C6[C9]===undefined){C6[C9]=!!C7.getDEObject(C9);}DC.isDe=C6[C9];}});});});return{act:"keepOnly",keyContext:C4,selectorObjects:[].concat(C5),partialRetrieval:{nodes:C8?[C4].concat(this.getSourceFilterKeys(C4)):[C4]}};},partialUpdateAndRebuildChild:function B2(C5,C2,C3){if(!C2.data&&!C2.defn){return ;}var C4=[C2.data,this.getTargetDefn(C5.k)];if(C3){C4=C4.concat([C2.defn,C3]);}this.partialUpdate.apply(this,C4);if(C5.clearCache){C5.clearCache();}return C5.parent.rebuildChild(C5);},getUpdateHiddenPanelsCallback:function A8(){var C2=this;return{success:function(C4){if(C4.pukeys){var C5=C2.getUnitDefinitions(C4.pukeys),C6=C2.partialUpdate(C4.data,C5),C3=Object.keys(C5).filter(function(C7){return Object.keys(C6.def).indexOf(C7)===-1;});C3.forEach(function(DA){var C8=C2.getWidgetId({k:DA,wid:1}),C9=C8&&mstrmojo.all[C8],C7;while(C9){C7=C9.defn;if(C7&&C7.t===mstrmojo.EnumRWUnitType.PANEL&&C9.setDirty){C9.setDirty(true);break;}C9=C9.parent;}});}}};},getUpdateHiddenLayoutsCallback:function AL(){var C2=this;return{success:function(C6){var C5=C6.pukeys&&C6.pukeys.split("\u001E");if(C5&&C5.length>0){var C3=C2.getUnitDefinitions(C5);var C4=function(C9){var C8=C9.defn;if(C8.units[C7]!==undefined){C8.loaded=false;}};for(var C7 in C3){if(C3[C7]===undefined){(C2.controller.view.getLayouts()||[]).forEach(C4);}}}}};},submitSelectorPropsChange:function A1(C2,C4,C8){var C3=this,C5=C2.defn.ck,C7=C2.k;this.controller.submitUndoRedoUpdates(Aw.copy(C4,{act:"editSelectorProps",keyContext:C5,ctrlKey:C2.k,partialRetrieval:{nodes:[this.getDataService().getNodeKeyFromKeyContext(C5)]}}),{},AE.wrapMethods({success:function C6(C9){C3.partialUpdate(C9.data,C3.getTargetDefn(C7),C9.defn,[C7]);}},C8),Cx);},getObjectInfo:function CP(C2){var C3;Aw.forEach(this.datasets,function(C4){if(!C3){C3=(C4.mx.concat(C4.att)).filter(function(C5){return C5.did===C2;})[0];}});return C3;},getDEObject:function Br(C5){var C4=this.deMap=this.deMap||{},C3=C4[C5],C2;if(!C3){Aw.forEach(this.datasets,function(C8,C6){C2=CY.find(C8.att,"did",C5);var C7=C8.att[C2];if(C2>=0&&C7.t===47&&C7.st===12033){C3=C7;C3.dsId=C6;C4[C5]=C3;return false;}});}return C3;},getBrowseFormTypes:function AQ(C4){var C3=[],C2;Aw.forEach(this.datasets,function(C5){C2=CY.find(C5.att,"did",C4);if(C2>=0){CY.forEach(C5.att[C2].fs,function(C6){if(C6.isbf){C3.push(C6.bftp);}});return false;}});return C3;},isOldDEObject:function CS(C4){var C3=false,C2;Aw.forEach(this.datasets,function(C5){C2=CY.find(C5.att,"did",C4);if(C2>=0&&C5.att[C2].de){C3=true;return false;}});return C3;},changeCurrLytTabTtl:function CB(C3,C2){this.controller.view.changeCurrLytTabTtl(C3,C2);},updateRootDefn:function CN(C2){Aw.copy(C2&&C2.root,this.getRootNode().defn);this.raiseEvent({name:"updateRootDefn"});},addUpdateObjects:function Af(C3,C2){if(C3){C3.partialUpdate=C3.partialUpdate||{};C3.partialUpdate.objects=mstrmojo.array.ensureArray(C2);}return C3;},updateTypeCounter:function G(C3){var C2=Ca.call(this,C3)+1;this.obCntrs[this.getCurrentLayoutKey()][C3]=C2;return C2;},getNumberFormatAction:function BJ(C7,C3,C6){var C5=this.getVIComponent(BD.FILTER_STACK),C2=C5&&C5.getFilterBySrcId(C7),C4=Aw.copy({act:"numberFormat",unitId:C7,unitType:C3},this.createNumberFormatParams(C6));if(C3===4&&C2){C4.partialRetrieval={nodes:[C2.k]};}return C4;},getWSItemDragDropAction:function Bp(){var C3=mstrmojo.vi.models.ENUM_WS_ITEM_INSERT,C2=mstrmojo.vi.models.ENUM_WS_ITEM_TYPE,C4={},C5=[];C4[C2.DOSSIER]=C3.CHAPTER;C4[C2.GRID]=C3.DATASET;C4[C2.CHART]=C3.DATASET;C4[C2.DATASET]=C3.DATASET;C4[C2.REPORT]=C3.DATASET;if(this.WSItemDroppable){CY.forEach(this.WSDragItems,function(C6){if(C4[C6.type]){C6.action=C4[C6.type];C5.push(C6);}});}return C5;},getVfNdFromExpr:function BT(C3){var C2=k(C3);this.handleInvalidAQNd(C2);return C2;},handleInvalidAQNd:function BQ(C5){if(C5&&C5.et===AR.AQ&&C5.fn===AP.IS_NOT_NULL&&(!C5.fm)&&C5.a){var C2=this.getDatasetUnits(["att"],function(C7){return C7.did===C5.a.did;});if(C2.length===1){C2=C2[0];var C4=(C2.fs&&C2.fs[0])||{};C5.fm={did:C4.fid,n:C4.fnm,dtp:AW.DTP.CHAR};}}else{var C6=C5&&C5.nds||[];var C3=this;CY.forEach(C6,function(C7){C3.handleInvalidAQNd(C7);});}},getDataNode:function Bl(C4){var C3=this.getCurrentLayoutKey(),C2=this.getLayoutDataCache(this.getCurrentLayoutKey()),C6=Bw.call(this,{k:C4,wid:1},C3),C5=(mstrmojo.all[C6]&&mstrmojo.all[C6].node)||(C2&&C2[C6]);return C5&&C5.data;},getVfexprWithUpdatedVf:function Ap(C3,C7){var C6=this.getDataNode(C3),C8=Aw.clone(C6&&C6.vfexpr);if(!C8){return C7;}C7=C7||{et:AR.ANDOR,fn:AP.AND,nds:[]};var C2=this.getVfNdFromExpr(C8);if(C2){for(var C4 in C2){if(C2.hasOwnProperty(C4)){delete C2[C4];}}for(var C5 in C7){if(C7.hasOwnProperty(C5)){C2[C5]=C7[C5];}}}else{C8.node=1;C8={et:AR.ANDOR,fn:AP.AND,node:0,nds:[C7,C8]};}return C8;},getViewFilter:function r(C2,DA){var C3=this.getDataNode(C2.nodeKey),C8=Aw.clone(C3&&C3.vfexpr||{et:14,nds:[]}),C7=Aw.clone(C3&&C3.vlexpr||{et:14,nds:[]}),C5=this.datasets,C4={};C8=this.getVfNdFromExpr(C8)||{et:14,nds:[]};C4.dsid=C3&&C3.datasetId||Aw.keyarray(C5)[0];C4.messageID=C2.msgID;C4.expr=C8;C4.limitExpr=C7;C4.targets=[];var C6=[],C9=[];Aw.forEach(C5,function(DC,DB){var DE=DB,DD=DC.name||"";CY.forEach(DC.att,function(DF){C6=C6.concat(Aw.copyProps(["da","did","n","t","st","fs","lvfs","ndetype"],DF,{dsid:DE,dsName:DD,ttp:DF.n+(DD?" - "+DD:"")}));});CY.forEach(DC.mx,function(DF){if(DF.hide){return ;}C9=C9.concat({did:DF.did,st:DF.st||"1024",n:DF.n,t:DF.t,um:DF.um,dsid:DE,dsName:DD,ttp:DF.n+(DD?" - "+DD:"")});});});C4.targets=[].concat(C6).concat(C9);DA.success(C4);},isFromSolrCube:function m(C4){var C3=this.datasets[this.findDatasetIdFromUnit(C4)],C2=C3&&C3.tables&&C3.tables.length===1&&C3.tables[0];return C2&&C2.dict===131078;},isFromLiveMDXCube:function q(C3){var C2=this.datasets[this.findDatasetIdFromUnit(C3)];return C2&&this.isMDXDataset(C2)&&this.isLiveDataset(C2);},isFromMDXCube:function C1(C2){return this.isMDXDataset(this.datasets[this.findDatasetIdFromUnit(C2)]);},isMDXDataset:function BZ(C2){return C2&&C2.tables&&C2.tables[0]&&C2.tables[0].xdaType===2;},isEssbaseDataset:function B3(C2){return C2&&C2.tables&&C2.tables[0]&&C2.tables[0].dbt===AN.ESSBASE;},isMSASDataset:function By(C2){return C2&&C2.tables&&C2.tables[0]&&C2.tables[0].dbt===AN.MSFT_AS;},isEssbaseRADataset:function BP(C4){var C3=this.isRADataset(C4),C2=this.isEssbaseDataset(C4);return C3&&C2;},isMSASRADataset:function Ar(C4){var C3=this.isRADataset(C4),C2=this.isMSASDataset(C4);return C3&&C2;},isSparkDataset:function Av(C2){if(C2&&C2.tables&&C2.tables.length>0){return C2.tables[0].xdaType===BU.sparkDataset;}else{return false;}},isDatasetFromPushApi:function b(C2){if(C2&&C2.tables&&C2.tables.length>0){var C3=C2.tables[0].dict;return C3===Y.dataFromPushApi||C3===Y.dataFromPushApiV2;}return false;},isFromFile:function Cl(C4){var C3=true,C2=[BU.text,BU.excel,BU.refine,BU.dataImportOAuthGDrive,BU.dataImportOAuthDropbox];CY.forEach(C4.tables,function(C5){if(C2.indexOf(C5.xdaType)===-1){C3=false;return false;}});return C3;},isRADataset:function BO(C2){return CY.some(C2&&C2.att,function(C3){return C3.t===c&&C3.st===CQ;});},hasRADataset:function AA(C2){var C3=this;return BL.call(this,C2,function(C4){return C3.isRADataset(C4);});},hasLTSDataset:function Bo(C3){var C2=false,C4=this;if(C3){CY.forEach(Aw.valarray(C3),function(C5){if(C4.isLiveDataset(C5)&&C5.idd){C2=true;return false;}});}return C2;},isLiveDataset:function Ax(C2){return C2.dsm===F.dda;},hasHadoopSource:function Cb(C3){var C2=false;CY.forEach(C3&&C3.tables,function(C4){var C5=(C4.dbt===AN.BIG_DATA_ENGINE)||(parseInt(C4.dict,10)===Cv.backendSourceSubtype.hadoopFileBrowser);if(C5){C2=true;return false;}});return C2;},getDerivedMetricCount:function Aq(C3){var C2=0;if(!C3){return C2;}CY.forEach(C3.mx,function(C4){if(C4.um){C2+=1;}});return C2;},hasMDXRADataset:function AD(C2){var C3=this;return BL.call(this,C2,function(C4){return C3.isMDXDataset(C4)&&C3.isRADataset(C4);});},hasNonRADataset:function o(C2){var C3=this;return BL.call(this,C2,function(C4){return !(C3.isMDXDataset(C4)&&C3.isRADataset(C4));});},isMDXTable:function Bj(C2){return C2.xdaType===2;},isDDADataset:function CF(C2){return C2.st===779&&C2.dsm===F.dda;},isDataImportRemoteDataSource:function B7(C2){return C2.tables&&C2.tables[0]&&C2.tables[0].xdaType===400;},createNumberFormatParams:function Cd(C4){var C2=C4.category,C3={c:C2,f:C4.format};var C6=C4.decimalPlaces,C5=C4.negativeNumbers;switch(C2){case 0:C3.ndp=C6;C3.nth=C4.thousandSeparator;C3.nnn=C5;break;case 1:C3.ndp=C6;C3.ncs=C4.currencySymbol;C3.ncp=C4.currencyPosition;C3.nnn=C5;break;case 4:C3.ndp=C6;C3.nnn=C5;break;case 6:C3.ndp=C6;break;}return C3;},_selsWarningFlags:null,openSelWarnFlag:function Ch(C3){var C2=this._selsWarningFlags=this._selsWarningFlags||{};C2[C3]=true;},closeSelWarnFlag:function A6(C3){var C2=this._selsWarningFlags=this._selsWarningFlags||{};C2[C3]=false;},isSelWarnFlagOn:function E(C3){var C2=this._selsWarningFlags;if(C2){return !!C2[C3];}return false;},allowManageDocumentDataset:function Cp(){return !n("web-disable-manage-document-dataset");},allowNewOrEditRolapDS:function g(){return !n("vi-unsupport-create-edit-rolap-report");},allowNewOrEditDummyDS:function CC(){return !n("vi-unsupport-create-edit-dummy-dataset");},allowSaveDataset:function Cc(){return !n("disable-save-dataset");},allowAccessDataFromFile:function Ac(){return !n("disable-access-data-from-file");},allowAccessDataFromDatabase:function AU(){return !n("disable-access-data-from-database");},allowAccessDataFromCloudApp:function Be(){return !n("disable-access-data-from-cloud-app");},allowImportData:function BI(){return this.allowAccessDataFromFile()||this.allowAccessDataFromDatabase()||this.allowAccessDataFromCloudApp();},allowReExecuteRegularReport:function Bf(){return !n("disable-reexecute-regular-report");},allowReExecuteViewReport:function Bi(){return !n("disable-reexecute-view-report");},allowReExecuteCubeReport:function d(){return !n("disable-reexecute-cube-report");},allowModifyReportList:function B9(){return n("modify-report-list");},allowWebExecuteCubeReport:function BM(){return n("web-execute-cube-report");},isSchemaDefined:function f(){return !!n("web-is-schema-defined");},isProjectLevelMCEJoinMin:function I(){return n("project-MCE-join");},hasPrivilegesForAllTables:function B4(C3){var C2=true;C3.forEach(function(C4){switch(C4.xdaType){case BU.text:case BU.excel:case BU.refine:case BU.dataImportOAuthGDrive:case BU.dataImportOAuthDropbox:if(!this.allowAccessDataFromFile()){C2=false;return ;}break;case BU.dataImportOAuthGBigQuery:case BU.dataImportOAuthGBigQueryFFSQL:case BU.dataImportOAuthGBigQuerySingleTable:case BU.qbSingleTable:case BU.ffsql:case BU.querybuilder:case BU.mdx:if(!this.allowAccessDataFromDatabase()){C2=false;return ;}break;case BU.salesforce:case BU.dataImportOAuthGAnalytics:case BU.twitter:case BU.facebook:if(!this.allowAccessDataFromCloudApp()){C2=false;return ;}break;}},this);return C2;},getOpenDatasetPanelAction:function Ck(){var C2=this.controller.rootCtrl.datasetsPanel;if(C2.getOpenStatus()!==true){C2.setOpenStatus(true,true);return[this.getUnitFormatAction(this.getRootNode(),1,{FormattingAnalysis:{DatasetObjectsVisible:true}},true)];}return[];},populateAttributeIdLinkInfo:function BX(){var C3=this.als;if(!C3){return ;}if(!C3.idLinks){C3.idLinks={};var C2=C3.idLinks;CY.forEach(C3,function(C4){Aw.forEach(C4,function(DD,DE){var DC=DE.split(" "),DB=DD.split(" "),C8=DC[0],C7=DB[0],DA,C9;C2[C8]=C2[C8]||[];DA=C2[C8];CY.forEach(DA,function(DF){C2[DF]=C2[DF]||[];C2[DF].push(C7);});C2[C8].push(C7);if(!!C2[C7]){var C6=C2[C7];CY.forEach(C6,function(DF){if(DF!==C8&&C2[C8].indexOf(DF)===-1){C2[C8].push(DF);}});}C2[C7]=C2[C7]||[];C9=C2[C7];CY.forEach(C9,function(DF){C2[DF]=C2[DF]||[];C2[DF].push(C8);});C2[C7].push(C8);if(!!C2[C8]){var C5=C2[C8];CY.forEach(C5,function(DF){if(DF!==C7&&C2[C7].indexOf(DF)===-1){C2[C7].push(DF);}});}});});}},warnForEditStandaloneDS:function(C4,C2,C3){if(!C4.mngd){mstrmojo.confirm(mstrmojo.desc(15493,"Modifications to this dataset will affect other reports, documents, and dossiers that share the dataset. Do you want to continue?"),{confirmBtn:{fn:function(){C2();}},cancelBtn:{t:mstrmojo.desc(221,"Cancel"),fn:C3}});}else{C2();}},hasFilters:function B8(C4){var C3,C2=false;CY.forEach(this.defn&&this.defn.layouts,function(C5){if(C5.k===C4||!C4){C3=C5.units;Aw.forEach(C3,function(C6){if(C6.t===CI.PANEL&&C6.isFilterPanel&&C6.ck){C2=true;return false;}});if(C2){return false;}}});return C2;},hasFiltersEx:function CE(){var C5=this.defn&&this.defn.layouts,C4=[],C3,C2=false;CY.forEach(C5,function(C6){C3=C6.units;Aw.forEach(C3,function(C8,C7){if(C8.t===CI.PANEL&&C8.isFilterPanel){C4.push(C7);}});});if(C4.length>0){CY.forEach(C5,function(C6){C3=C6.units;Aw.forEach(C3,function(C7){if(C7.ck&&!C7.destroyed&&CY.indexOf(C4,C7.pnk)>-1){C2=true;return false;}});if(C2){return false;}});}return C2;},getVisibleUnitKeysByType:function Bx(C4){var C6=this.getTocData(),C7,C3,C2=[],C5=function(C8,DB,DA){var C9=DA;while(CY.find(C8,"k",C9.pnk)===-1){C9=DB[C9.pnk];if(!C9||!C9.pnk||!C9.t||!(C9.t===mstrmojo.EnumRWUnitType.UNITCONTAINER||C9.t===mstrmojo.EnumRWUnitType.PANEL)){return false;}}return true;};C4=C4||[];CY.forEach(this.defn.layouts,function(C8){C3=CY.find(C6,"k",C8.k);if(C3>-1){C7=C6[C3];Aw.forEach(C8.units,function(C9){if(!(C9._isDeleted||C9.destroyed)&&C4.indexOf(parseInt(C9.t,10))>-1&&C5(C7.panels,C8.units,C9)){C2.push(C9);}});}});return C2;},getEmbeddedFilter:function Bv(C4){var C3=this.defn.efs||[];var C2=CY.find(C3,"did",C4);return C2!==-1?C3[C2]:null;},createVizBoxForCustomSort:function Bt(C5,C6){var C2=this.getNodeDataByKey(C5),C7=this.getCurrentLayoutKey(),C8=function(){return C2.data;},C9=function(){return C2.defn;},C4=function(){return C2;},C3=this.createNewUnitNode(C8,C9,C4,C5,C7),DA;C3.defn.iics=true;DA=this.createUnit(C3,"",C7);DA.showTitleBar=false;DA.updateLayout(C6);return DA;},applyBufferedSelections:function p(DA){var C5=this.getVIComponent(BD.FILTER_STACK),DE=this.getVIComponent(BD.VIZ_CONTENT),C8=this.getCurrentLayoutSelectorDefn(),DB=C8.filterPanelSelectors,C7=C8.canvasSelectors,C4=Object.keys(DB).concat(Object.keys(C7)),C2=this.getCurrentLayoutDef(),DF=C2&&C2.units,C3=false,DC,C9,C6,DD=this;CY.forEach(C4,function(DG){DC=DF[DG];if(DC&&DC.cesChange&&DC.srcid){C9=DD.getNodeDataByKey(DG);if(C9&&C9.id){C6=mstrmojo.all[C9.id];if(C6&&C6.selectorControlChange&&C6.content){C6.selectorControlChange(C6.content);C3=true;}}}});if(C3){C5.applyBufferedSlices(true,DA);DE.applyBufferedSlices(true,DA);}}});mstrmojo.vi.models.DocModel.DatasetUnitType=null;mstrmojo.vi.models.DocModel.UnitFormatInfo=null;mstrmojo.vi.models.ENUM_WS_ITEM_INSERT={CHAPTER:"insertAsChapter",DATASET:"insertAsDataSet"};mstrmojo.vi.models.ENUM_WS_ITEM_TYPE={DOSSIER:"Dossier",GRID:"Grid",CHART:"Chart",DATASET:"Dataset",REPORT:"Report"};}());(function(){mstrmojo.requiresCls("mstrmojo.array","mstrmojo.vi.viz.EnumDSSDropZones","mstrmojo.vi.models.MapDropZones");var A=mstrmojo,D=A.array,B=A.vi.viz.EnumDSSDropZones;mstrmojo.vi.models.MapboxDropZones=mstrmojo.declare(mstrmojo.vi.models.MapDropZones,null,{help:"Editor_Panel_Geospatial_Service.htm",getZonesCfg:function C(){return D.filter(this._super(),function(E){return E.id!==B.SliceBy&&E.id!==B.Angle;});}});}());(function(){mstrmojo.requiresCls("mstrmojo.vi.models.TemplateBasedDropZones","mstrmojo.vi.models.EnumDragSources","mstrmojo.mstr.EnumDSSXMLObjectTypes","mstrmojo.array","mstrmojo.hash","mstrmojo.func");var I=mstrmojo.array,C=mstrmojo.hash,M="-1",P=mstrmojo.vi.models.DropZonesModel.ENUM_TARGET_POSITION;function O(){var Q=this.getHostModel();return Q?Q.gsi:null;}function L(Z,W,U,Y,Q){var a=this.getHost(),V=a.controller,S,X;S=Z.did;X=Z.t;if(Q){var R=this.getUnitIndexInZone(W,Z);if(R!==-1){if(R<Y){Y--;}}}V.submitUndoRedoUpdates(this.getUpdateTemplateAction([a.model.getPivotUnitAction(U,Y,S,X)]),null,mstrmojo.func.wrapMethods(V._getXtabCallback(a),this.getUpdateCallback()));}function J(U){var d=U.item,Y=U.zone,Q=U.dsid,b=U.index,R=U.edge,a=U.isPivot;var e=this.getHost(),X=e.controller,c=Y.items,W=e.model,S=Y.id,V=[];if(c.length){if(R===P.ON){var Z=c[b];V.push(W.getRemoveTemplateUnitAction(Z));}else{if(R===P.BELOW){b++;}}}else{b=0;}if(a&&R!==P.ON){L.call(this,d,Y,S,b,true);return ;}V.push(W.getAddTemplateUnitAction(d,Q,S,b));X.submitUndoRedoUpdates((U.actions||[]).concat(this.getUpdateTemplateAction(V)),null,mstrmojo.func.wrapMethods(X._getXtabCallback(e),this.getUpdateCallback()));}function K(Q){return Q.src.data.src===mstrmojo.vi.models.EnumDragSources.VIZ_EDITOR;}mstrmojo.vi.models.BaseVisDropZones=mstrmojo.declare(mstrmojo.vi.models.TemplateBasedDropZones,null,{scriptClass:"mstrmojo.vi.models.BaseVisDropZones",addZoneItem:function A(S,U,R){var V=R.mx,Q;if(S.did===M){I.forEach(V,function(W){Q={did:W.did,n:W.n,t:4};U.push(Q);});}else{this._super(S,U);}},getDropZones:function N(){var Q=O.call(this),R=this.getHost();return Q?{n:R.defn.ttl,zones:[this.getZone(mstrmojo.desc(3581,"Attributes"),1,Q.rows,false,{mx:Q.mx,title:mstrmojo.desc(13828)}),this.getZone(mstrmojo.desc(3582,"Metrics"),-1,Q.mx,false,{mx:Q.mx,title:mstrmojo.desc(13827)})]}:{n:R.defn.ttl,zones:[]};},getAvatarIconClass:function G(){return"viXtab";},getAllowDropInfo:function F(R,S,Q,V,U){var X=this._super(R,S,Q,V,U),W=R.id===-1;return C.copy({allowedItems:X.allowedItems.filter(function(Z){var Y=Z.t===4;return W?Y:!Y;})},X);},unitsDropped:function E(Q,S,U,W,V){var R=U.allowedItems[0];J.call(this,{item:R,zone:Q,dsid:S.src.data.dsid,index:U.idx,edge:U.edge,isPivot:K(S),actions:S.actions});},deleteItem:function B(R,Q){this.deleteItems(R,[R.items[Q]]);},deleteItems:function D(R,S){var U=this.getHost(),Q=U.controller,V=[];(S||[]).forEach(function(W){V.push(U.model.getRemoveTemplateUnitAction(W));});if(V.length){Q.submitUndoRedoUpdates(this.getUpdateTemplateAction(V),null,mstrmojo.func.wrapMethods(Q._getXtabCallback(U),this.getUpdateCallback()));}},getExtraUnitMenuItems:function H(R,Q,U,S){this._super(R,Q,U,S);if(U.t===mstrmojo.mstr.EnumDSSXMLObjectTypes.Metric&&this.getHost().showThreshold){R.addSeparator();this.buildThresholdMenuOptions(R,{item:U},true);}},getHostModel:function(){return this.getHost().model.data;}});}());(function(){mstrmojo.requiresCls("mstrmojo.vi.models.TemplateBasedDropZones","mstrmojo.vi.models.EnumDragSources","mstrmojo.express.ui.SubtotalsWidget","mstrmojo.array","mstrmojo.func","mstrmojo.hash","mstrmojo.vi.ui.DatasetUnitMenuUtils","mstrmojo.VisEnum");mstrmojo.requiresDescs(101,122,144,190,1018,2453,2968,3224,3573,3582,3647,5188,7974,7975,7976,7978,7979,8138,11099,11609,11610,11667,11806,11908,12193,12194);var d=mstrmojo.array,k=mstrmojo.vi.ui.DatasetUnitMenuUtils,V=mstrmojo.hash,P=mstrmojo.func.wrapMethods,O=-1,M=1,n=2,j="-1",a=[null,"rows","cols"],R=mstrmojo.vi.models.DropZonesModel.ENUM_TARGET_POSITION;mstrmojo.vi.models.XtabDropZonesMenuContextType=null;mstrmojo.vi.models.DropZonePivotItemType=null;function Z(){return mstrmojo.all[this.hostId];}function o(){return Z.call(this).gridInfo||{};}function h(v){var u=Z.call(this).model.docModel.getVIComponentKey(mstrmojo.vi.models.VIComponentMap.TYPES.PAGEBY_PANEL);if(u){v.forEach(function(z){var x=z.partialRetrieval=z.partialRetrieval||{},w=x.nodes=x.nodes||[];w.push(u);});}}function H(AF,AB,AD,z,v,AA){var AE=Z.call(this),x,AC,u;if(AF.did!==j){x=AF.did;AC=AF.t;}if(v){var w=this.getUnitIndexInZone(AB,AF);if(w!==-1){AA=z;u=w;if(w<AD){AD--;}}else{u=AF._renderIdx;}}return AE.model.getPivotUnitAction(z,AD,x,AC,AA,u);}function D(w,u,x,v){var AE=Z.call(this),AB=[],AD=[],z=0,AC=this;if(x){AB=V.copy(x,AB);AD=V.copy(x,AD);}d.forEach(w.items,function(AG){AB.push(H.call(AC,AG,w.zone,w.idx+(z++),w.axis,u,w.originAxis));});if(w.axis===n){w.items.forEach(function(AH){var AG=AH.cardg>0?AH.cardg:AH.card;if(!AG||AG<=AC.CARDLIMIT){AD.push(H.call(AC,AH,w.zone,w.idx+(z++),w.axis,u,w.originAxis));}});}var AA=function(){AE.controller.submitUndoRedoTemplateUpdates(AE,AB,AC.getUpdateCallback());},AF=function(){AE.controller.submitUndoRedoTemplateUpdates(AE,AD,AC.getUpdateCallback());};if(w.axis===n){this.checkAndWarnLargeItemsForAddUnits(w.items,AA,AF,true,w.zone);}else{AC.checkAndWarnForOutlineAddUnits(w.items,w.axis,AA,mstrmojo.emptyFn,v);}}function m(x){var AA=Z.call(this),v=AA?AA.gridData.gts:undefined,z=v[x.axis===n?"col":"row"][x.idx],u=AA.getBasicSubtotalEditorConfig(z.ast),w=this;u.fnOk=AA.getOnSubtotalsChangeFn(u,z,w.getUpdateCallback());return u;}function N(w){var u=this.getDropZones().zones,v={};u.forEach(function(x){(x.items||[]).forEach(function(AA,z){if(AA.did===w.did){v.index=z;v.axis=x.id;}if(AA.did===-1){v.metricAxis=x.id;}});});return v;}function F(w,z){var AB=[],v=[],AA=o.call(this).mx,x=AA.length-1,u;for(x;x>=0;x--){u=N.call(this,AA[x]);AB.push(w.getRemoveTemplateUnitAction(V.copy(AA[x],{axis:u.axis,unitPos:u.index+1})));if(v){v.push(w.getAddTemplateUnitAction(V.copy(AA[x],{t:4}),z||this.docModel.findDatasetIdFromUnit(AA[x]),u.metricAxis,u.index));}}v.reverse();return{actions:AB,undoActions:v};}function f(u){return u.src.data.src===mstrmojo.vi.models.EnumDragSources.VIZ_EDITOR;}function K(u){var v=o.call(this);[M,n].forEach(function(w){v[a[w]].forEach(function(z,x){u.call(this,w,z,x);},this);},this);}function X(){var w=Z.call(this),u=w.model,x=[],v;K.call(this,function(AA,AB,z){if(AB.did===j){v=F.call(this,u);x=x.concat(v.actions);}else{AB.axis=AA;AB.unitPos=z+1;x.push(u.getRemoveTemplateUnitAction(AB));}});w.controller.submitUndoRedoTemplateUpdates(w,x,this.getUpdateCallback());}function Y(w,v){var u=w.model,x=[];if(v.did===j){x=x.concat(F.call(this,u).actions);}else{x=[u.getRemoveTemplateUnitAction(v)];}return x;}function r(z,w,v,x,u){return[z.model.getAddTemplateUnitAction(w,x,v,u)];}mstrmojo.vi.models.XtabDropZones=mstrmojo.declare(mstrmojo.vi.models.TemplateBasedDropZones,null,{CARDLIMIT:mstrmojo.VisEnum.VIS_CARDLIMIT.GRID,getDropZones:function e(){var u=o.call(this);return{n:Z.call(this).defn.ttl,zones:[this.getZone(mstrmojo.desc(2968,"Rows"),M,u.rows,false,{title:mstrmojo.desc(11668)}),this.getZone(mstrmojo.desc(122,"Columns"),n,u.cols,false,{title:mstrmojo.desc(11668)}),this.getZone(mstrmojo.desc(3582,"Metrics"),O,u.mx,false,{title:mstrmojo.desc(13827)})]};},getAvatarIconClass:function U(){return"viXtab";},canSwapAxis:function l(){return true;},swapAxis:function A(){var AD=Z.call(this),x=[],AB=[],w={},z={};this.getDropZones().zones.every(function(AE){z=(AE.id===M)?AE:null;return !z;});K.call(this,function(AE,AF){w[AE]=true;});K.call(this,function(AH,AI,AE){var AG=null,AL=AI.did===j,AK=AH===M?n:M,AJ=AD.model.getPivotUnitAction(AK,AE,AL?"":AI.did,AL?"":AI.t,AH,AE);x.push(AJ);if(AK===n){z.items.every(function(AM){AG=(AM.did===AI.did)?AM:null;return !AG;});var AF=AG.cardg>0?AG.cardg:AG.card;if(!AF||AF<=this.CARDLIMIT){AB.push(AJ);}}else{AB.push(AJ);}});var AA=this,v=function(){AD.controller.submitUndoRedoTemplateUpdates(AD,x,AA.getUpdateCallback());},u=function(){AD.controller.submitUndoRedoTemplateUpdates(AD,AB,AA.getUpdateCallback());};var AC=AD.model.getMoveSubTotalAction(undefined,undefined,AD.k,true);if(x.length){if(AC){x.push(AC);if(AB.length){AB.push(AC);}}this.checkAndWarnLargeItemsForAddUnits(z.items,v,u,true,z);return ;}v();},canDefineSubtotals:function E(){var v=this.getHostModel().gsi,u=v&&v.mx;return u&&u.length>0;},hasVisibleSubtotals:function c(){var u=this.getHostModel().gsi;return u&&u.hassb&&!u.hidesb;},showQuickSubtotals:function G(){var v=Z.call(this),w=this.getHostModel().gsi,u=v.model;if(w.hassb){if(w.hidesb){v.controller.submitUndoRedoTemplateUpdates(v,u.getShowDefinedSubtotalsAction());}return ;}v.controller.submitUndoRedoTemplateUpdates(v,this.getShowQuickTotalAction());},getShowQuickTotalAction:function t(){var x=Z.call(this),AA=this.getHostModel().gsi,w=x.model;var z=[],v=AA.tma===M?n:M;AA[a[v]].forEach(function(AB){z.push(w.getShowTotalsUnitAction(AB.did,AB.t,[-10],[]));});var u=w.getMoveSubTotalAction(undefined,undefined,x.k);if(u){z.push(u);}return z;},hideDefinedSubtotals:function p(){var u=Z.call(this);u.controller.submitUndoRedoTemplateUpdates(u,{act:"hideDefinedSubtotals"});},clearAllSubtotals:function(){var u=Z.call(this);u.controller.submitUndoRedoTemplateUpdates(u,{act:"clearAllSubtotals"});},getExtraUnitMenuItems:function W(v,u,z,x){var w=this,AA=this.id;v.addSeparator();if(this.showNumberFormat(z)){v.addEditorMenuItem(mstrmojo.desc(13237,"Number Format"),AA,this.getNumberFormatEditorCfg,x);}this.buildThresholdMenuOptions(v,x,false);if(z.t===12||z.t===14||(z.t===47&&z.st===12033)){v.addEditorMenuItem(mstrmojo.desc(6193,"Show Totals"),AA,m,x);}else{if(z.t===4){v.addToggleMenuItem(mstrmojo.desc(6193,"Show Totals"),"",function(){this.showQuickSubtotals();},function(){this.hideDefinedSubtotals();},AA,this.hasVisibleSubtotals());}}if(this.shouldShowDisplayFormsMenu(z)){v.addEditorMenuItem(mstrmojo.desc(11908,"Display Attribute Forms"),this.id,function(){return w.getDisplayFormsMenu(z);});}},getMultiUnitsMenuItems:function b(v,u,w){var AA=this.id,x=u.id;if(x!==O){var z=(x===M)?mstrmojo.desc(13262,"Move to Column Header"):mstrmojo.desc(13263,"Move to Row Header");v.addMenuItem(z,"xt",function(){D.call(mstrmojo.all[AA],{items:w,zone:u,axis:x===M?n:M,idx:0},false);});v.addSeparator();}this._super(v,u,w);},getAllowDropInfo:function C(AA,x,AD,w,u){var v=this._super(AA,x,AD,w,u),z=AA.id===O,AB=this,AC=o.call(AB);return V.copy({allowedItems:v.allowedItems.filter(function(AG){var AE=AB.docModel,AF=AB.getHost().model;if(AG.t===4){if(AG.did===j){if(z){return false;}}else{if(!z&&AC.mx&&AC.mx.length){return false;}}}else{if(z){return false;}else{if(AF.hasSameRecursiveAttributeGroup(AG)){return false;}}}return true;})},v);},getHostModel:function B(){return this.getHost().gridData;},unitsDropped:function q(AP,x,AE){var AR=this.getHost(),AA=AR.model,AM=AE.allowedItems,AC=x.getCtxtDragData&&x.getCtxtDragData().dsid,AI=AE.idx,AB=AE.edge,AG=[],AJ=[],w=AP.id,AF=[],AH=AP.items;if(AH.length){if(AB===R.ON&&AE.removeReplaced){var AO=AH[AI];AF=[AO];if(AO.did===j){AG=AG.concat(F.call(this,AA,AC).actions);}else{AO.axis=w;AO.unitPos=AI+1;AG.push(AA.getRemoveTemplateUnitAction(AO));}}else{if(AB===R.BELOW){AI++;}}}else{AI=0;}if(f(x)){D.call(this,{items:AM,zone:AP,axis:w,idx:AI,originAxis:x.src.data.srcZoneId},true,AG,AF);return ;}var z=false,AD=[];AM.reverse().forEach(function(AV){var AT=this.isMetric(AV),AW=AT&&AP.id!==O&&z,AS=AW?O:AP.id,AY=AW?0:AI,AU=AW?O:(AP.id===1?n:M),AX=-1;AJ=AG.concat(r.call(this,AR,AV,AU,AC,AX));AG=AG.concat(r.call(this,AR,AV,AS,AC,AY));if(AT){AD.push(AV);}z=z||AT;},this);if(z){AG.push(AR.model.getValuesDefaultFormatGridZoneAction(AD,true));}var AN=AA.docModel,AL=AN.controller,AQ=this,u=function(){AL.submitUndoRedoUpdates(AG,null,P(x.callback,AL._getXtabCallback(AR),{success:function(AS){AN.partialUpdate(AS.data,AN.getUnitDefinitions(AR.k));}},AQ.getUpdateCallback()));},v=function(){AL.submitUndoRedoUpdates(AJ,null,P(x.callback,AL._getXtabCallback(AR),{success:function(AS){AN.partialUpdate(AS.data,AN.getUnitDefinitions(AR.k));}},AQ.getUpdateCallback()));};AG=(x.actions||[]).concat(this.getUpdateTemplateAction(AG));AJ=(x.actions||[]).concat(this.getUpdateTemplateAction(AJ));h.call(this,AG);h.call(this,AJ);var AK=function(AS){return function(){if(AS){AG=AQ.docModel.wrapUnsetVisualizationFilterAction(AG);AJ=AQ.docModel.wrapUnsetVisualizationFilterAction(AJ);}if(w===n){AQ.checkAndWarnLargeItemsForAddUnits(AM,u,v,true,AP);}else{AQ.checkAndWarnForOutlineAddUnits(AM,w,u,mstrmojo.emptyFn,AF);}};};this.docModel.checkAndNotifyVFChangeOnDZUnitsUpdate({actions:AG,zm:AQ},AK(true),AK(false));},deleteItem:function J(v,u){this.changeZoneUnits(v,[v.items[u]]);},deleteItems:function I(u,v){this.changeZoneUnits(u,v);},changeZoneUnits:function g(v,u,z){var w=this,x=Z.call(this),AA=[];u=u||[];z=z||[];z.forEach(function(AB){AA=AA.concat(r.call(this,x,AB,v.id,AB.dsId,v.items.length-u.length));},this);u.forEach(function(AB){AB.axis=v.id;AB.unitPos=this.getUnitIndexInZone(v,AB)+1;AA=AA.concat(Y.call(this,x,AB));},this);h.call(this,AA);this.docModel.checkAndNotifyVFChangeOnDZUnitsUpdate({actions:AA,zm:w},function(){var AC=x,AB=AC.controller,AD=AB&&AB.dataService();AA=w.docModel.wrapUnsetVisualizationFilterAction(AD.getUpdateTemplateAction(AC.k,AA));AC.controller.submitUndoRedoTemplateWithCallback(AC,AA,w.getUpdateCallback());},function(){x.controller.submitUndoRedoTemplateUpdates(x,AA,w.getUpdateCallback());});},getZoneAddCandidates:function S(u){return this.docModel.getDatasetUnits(u.id===-1?["mx"]:["att"]);},clearAllUnits:function L(){X.call(this);},canSupportImageThreshold:function Q(){return true;}});}());(function(){mstrmojo.requiresCls("mstrmojo.array","mstrmojo.func","mstrmojo.hash","mstrmojo.chart.model.enums.EnumDSSObjectType","mstrmojo.gm.EnumGraphType","mstrmojo.vi.viz.EnumDSSDropZones","mstrmojo.gm.EnumShape","mstrmojo.chart.model.enums.EnumDSSAxisName","mstrmojo.chart.model.enums.EnumDSSDynamicShortcut","mstrmojo.chart.model.enums.EnumDSSXMLAxesBitMap");mstrmojo.requiresClsP("mstrmojo.vi.models","DropZonesModel","GMDropZones","EnumDragSources");mstrmojo.requiresDescs(11710,11711,11712,11713,11714,11715);var w=mstrmojo,x=w.array,U=w.hash,AN=w.func,AV=w.vi,Q=w.chart.model.enums.EnumDSSObjectType,c=AV.models.DropZonesModel.ENUM_TARGET_POSITION,a=mstrmojo.vi.models.EnumDragSources,AQ=c.ABOVE,AA=c.ON,S=c.BELOW,h=1,b="00000000000000000000000000000000",j=0,AI={n:"Metric Names",did:b,t:j},q=false,AC=mstrmojo.gm.EnumShape,N=mstrmojo.gm.DualAxisSubAxisBit,V=N.PRIMARY,e=N.SECONDARY,AL=w.gm,AK=AL.WidgetPropertyTag,m=mstrmojo.vi.enums.EnumFeatures,M=1,AH=2,AD=3,g=4,F=5,l=6,p=7,W=8,H=9,AB=10,R=11,f=12,o={1:4,4:1,2:3,3:2},Y=mstrmojo.chart.model.enums.EnumDSSXMLAxesBitMap,Z=mstrmojo.chart.model.enums.EnumDSSAxisName,E=mstrmojo.chart.model.enums.EnumDSSDynamicShortcut;function C(AW){return AW===g||AW===AD;}function AG(AY,Ab){var AX=Ab.getZoneModelByZoneId(p),Ae=Ab.getZoneModelByZoneId(l),Ad=Ab.getZoneModelByZoneId(F),Ah,Ag,Ac,AW,AZ=[],Af=function(){return[Ae&&Ae.items,Ad&&Ad.items].every(function(Ai){for(Ac=0,AW=0;Ai&&Ac<Ai.length;Ac++){Ah=Ai[Ac];Ag=x.find(AX.items,"did",Ah.did);if(Ag!==-1&&Ag<AW){return false;}AW=Ag>AW?Ag:AW;}return true;});},Aa=function(){[Ae,Ad].forEach(function(Ai){for(Ac=0;Ai&&Ai.items&&Ac<AX.items.length;Ac++){Ah=AX.items[Ac];Ag=x.find(Ai.items,"did",Ah.did);if(Ag!==-1){AZ.push(Ab.getAddDropZoneUnitAction(Ai,Ah,Ai.items.length-1));}}});};if((AY===l||AY===F||AY===p)&&!Af()){Aa();}return AZ;}function AT(Ac,Ah,AY,Af,AX){AY=(AY===undefined)?AA:AY;var Ab=this.gmZones,Aa,AW,Ad,AZ,Ag,Ae=AY;switch(Ac.id){case R:case f:AW=Ab.getZoneModelByZoneId((Ac.id===f)?g:AD);Aa=Ab.getZoneModelByZoneId((Ac.id===f)?M:AH);if(AW.items.length===0&&Aa.items.length===0){if(AX){AZ=Aa;Ag=0;Ae=S;}else{AZ=AW;Ag=0;Ae=AQ;}}else{Ad=Aa.items.length;if(Ah===Ad-1&&AY===S&&Af){AZ=AW;Ag=0;Ae=AQ;}else{if(Ah<Ad){AZ=Aa;Ag=Ah;}else{if(Ah===Ad&&AY===AQ&&!Af){AZ=Aa;Ag=(Ad>0)?(Ad-1):0;Ae=S;}else{AZ=AW;Ag=Ah-Ad;}}}}break;default:AZ=Ab.getZoneModelByZoneId(Ac.id);Ag=Ah;break;}return{zone:AZ,idx:Ag,edge:Ae};}function v(AY,AZ,AX,Ab,Ac){var Aa=AT.call(this,AY,AX,Ac,this.isMetric(AZ),this.isMetricName(AZ));var AW=this.gmZones.isItemDropAllowed(Aa.zone,AZ,Aa.idx,Ab,Aa.edge);if(q){window.console.log("isItemDrop: zone="+AY.id+",idx="+AX+",edge="+Ac+",xzone="+Aa.zone.id+",xidx="+Aa.idx+",xedge="+Aa.edge+",res="+AW);}return AW;}function K(){var AX=this,AW=[AD,g];return AW.some(function(AY){return AX.gmZones.isDualAxis(AY);});}function P(Ab,Aa,Ac){var AZ,Ad,AW=[],AY=this;x.forEach(Aa,function(Ae){if(AY.isMetric(Ae)){AW.push(Ae);}});AZ=Ab.readGlobalProperty(AK.METRIC_SHAPES);Ad=AZ.jsonObj[Ac.did];if(Ad!==undefined){Ab.updateMetricShape(Ac);for(var AX=0;AX<AW.length;AX++){AZ=Ab.readGlobalProperty(AK.METRIC_SHAPES);AZ.setProperty(AW[AX].did,Ad);Ab.setWidgetPropertyValue(AK.METRIC_SHAPES,AZ.jsonObj);}}}mstrmojo.vi.models.CombineDropZonesModel=mstrmojo.declare(mstrmojo.vi.models.DropZonesModel,[mstrmojo.vi.models._DropZoneCommon],{scriptClass:"mstrmojo.vi.models.CombineDropZonesModel",help:"editor_panel_graph.htm",dropZones:[],gmZones:null,init:function AM(AW){this._super(AW);},getMetricCntInAxis:function d(AW){var AY=0,AX=this;x.forEach(AW.items,function(AZ){if(AX.isMetric(AZ)){AY++;}});return AY;},shouldMetricNameShowIcon:function AS(Aa,AX){var AZ=this,AY=this.gmZones,Ac=AY.getHost(),Ab=Ac.GMController,AW=K.call(AZ);if(AZ.isMetricName(Aa)){if(!Ab.isPie){return false;}}return true;},addZoneItem:function t(AX,AY,AW){if(!AX.did){AX.did=AX.id;}this._super(AX,AY,AW);},getDropZones:function(){var Ah=this.gmZones,AX=Ah.getHostStructure(),Ae=Ah.getHost(),Ak=Ae.GMController,Aa=Ae.getChartInfo(),Ai=Ae.getChartStyle(),Ag=Ak.isPie,Al=Ak.isHistogram,AY=Ak.isBoxPlot,Ac=Ak.isWaterfall,Af=(Ak.chartType===mstrmojo.gm.EnumGraphType.GRID&&!Ak.isEmptyVis()&&!Ak.isEmptyBreakby()),Aj=Ak.pureAreaChart||(Aa.tp===3&&Ai==="NewGraphMatrixVisualizationStyle"),Ab=this.getZone(mstrmojo.desc(12173,"Break By"),F,AX.BreakBy,Af,{title:mstrmojo.desc(13828)}),AZ=this.getZone(mstrmojo.desc(12090,"Size By"),W,AX.SizeBy,Aj,{allowSingle:!Ak.isBubbleOrScatter(),title:mstrmojo.desc(13829)}),Am=this.getZone(mstrmojo.desc(2962,"Tooltip"),H,AX.AdditionalMetrics,false,{title:mstrmojo.desc(13827)}),Ad=[this.getZone(mstrmojo.desc(14294,"Angle"),AB,AX.AngleBy,false,{title:mstrmojo.desc(13827)}),this.getZone(mstrmojo.desc(6188,"Slice"),l,AX.SliceBy,false,{title:mstrmojo.desc(13828)}),this.getZone(mstrmojo.desc(2069,"Vertical"),f,AX.Rows.concat(AX.YAxis),false,{title:mstrmojo.desc(11668)}),this.getZone(mstrmojo.desc(3691,"Horizontal"),R,AX.Columns.concat(AX.XAxis),false,{title:mstrmojo.desc(11668)}),this.getZone(mstrmojo.desc(11662,"Color By"),p,AX.ColorBy,false,{title:mstrmojo.desc(11668)}),Ab,AZ,Am];if(!Ag){Ad=Ad.slice(2);}else{Ad.splice(1,0,Ad.splice(4,1)[0]);}if(Al){this.help="creating_histogram.htm";Ad=[this.getZone(mstrmojo.desc(517,"Metric"),g,AX.YAxis,false,{allowSingle:true,title:mstrmojo.desc(11668)}),this.getZone(mstrmojo.desc(11806,"Aggregate By"),AD,AX.XAxis,false,{title:mstrmojo.desc(11668)})];}else{if(AY){this.help="create_box_plot.htm";Ad=[this.getZone(mstrmojo.desc(2069,"Vertical"),f,AX.Rows.concat(AX.YAxis),false,{title:mstrmojo.desc(11668)}),this.getZone(mstrmojo.desc(3691,"Horizontal"),R,AX.Columns.concat(AX.XAxis),false,{title:mstrmojo.desc(11668)}),Ab,this.getZone(mstrmojo.desc(11662,"Color By"),p,AX.ColorBy,false,{title:mstrmojo.desc(11668)})];}else{if(Ac){this.help="create_waterfall.htm";Ad=[this.getZone(mstrmojo.desc(2069,"Vertical"),f,AX.Rows.concat(AX.YAxis),false,{title:mstrmojo.desc(11668)}),this.getZone(mstrmojo.desc(3691,"Horizontal"),R,AX.Columns.concat(AX.XAxis),false,{title:mstrmojo.desc(11668)}),Ab,Am];}}}this.dropZones=Ad;if(Aj){AZ.items.forEach(function(An){An.hidden=true;});}if(Af){Ab.items.forEach(function(An){An.hidden=true;});}var AW=Ah.getDropZones();AW.zones.forEach(function(An){if(An.id===F){Ab.siblings=An.siblings;}});return{n:Ah.getHost().defn.ttl,zones:Ad};},getZone:function AF(Ad,Ac,Ab,AX,AZ){var AW=this._super(Ad,Ac,Ab,AX,AZ),AY=this.getHost(),Aa=AY.GMController;if(Ac===R||Ac===f){AW.cssClass=AW.cssClass+" mergedZone";}if(Aa.isHistogram){if(Ac===AD||Ac===g){AW.cssClass+=" hideIcz";}}return AW;},canSwapAxis:function AE(){var AW=this.getHost(),AX=AW.GMController;if(!AX.isHistogram){return this.gmZones.canSwapAxis();}else{return false;}},swapAxis:function A(){this.gmZones.swapAxis();},getClearAllUnitsActions:function O(){var AX=[],AW=this;x.forEach(AW.gmZones.getDropZones().zones,function(AY){x.forEach((AY&&AY.items)||[],function(AZ){Array.prototype.push.apply(AX,AW.getRemoveDropZoneUnitActions(AY,AZ));});});return AX;},getClearAllUnitsUnTemplateActions:function r(){var AZ=[],AX=this,AW=this.getHost(),AY=AW.GMController;AY.removeGroupInfo();if(AW.isXMLDirty()){AZ.push(AW.getPersistAction());}return AZ;},getUnitMenuItems:function z(AZ,Am,Al,AY){if(!Al){throw new Error(this.scriptClass+"::getUnitMenuItems: Item must be provided.");}var Ar=this,AX=Ar.gmZones,Ag=(Al.t===Q.DssTypeMetric&&!this.isMetricName(Al)),Ao=(Al.ax||V),AW=(Ao===V),Ab=AX.getZoneModelByZoneId((Am.id===f)?M:AH),Ad=AX.getZoneModelByZoneId((Am.id===f)?g:AD),Ap,An=Ar.isMetricName(Al),Ai=K.call(Ar),Af=Ar.getHost(),Ah=Af.GMController.isBubbleOrScatter(),Aj=Af.GMController.isPie,Aq=Ar.getMetricCntInAxis(Am);if(An){Ap=AX.getZoneModelByZoneId(Al.zone);}else{var Ac=AT.call(this,Am,Al._renderIdx);Ap=Ac.zone;}var Ak=Ag?Ao:(Ap.id===Ad.id?V:e),Ae=function(As,At,Av){var Au=As!==At,Aw=C(Av.newZone.id);if(Au){Ar.unitsDropped(Av.newZone,{src:{data:{src:a.VIZ_EDITOR}}},{idx:Aw?0:Av.newZone.items.length,edge:Aw?AQ:S,allowedItems:[Al]},Av.isPrimary);}return Au;};if(Am.id===R){if(!(Ag&&Af.getChartStyle()==="NewGraphMatrixVisualizationStyle")&&(!An||(An&&Aj&&!Ai&&(Ah||(!Ah&&Aq<=0))))){AZ.addRadioMenuGroup(Ak,Ae,[{value:e,text:Ag?mstrmojo.desc(11710,"Top Axis"):mstrmojo.desc(11711,"Top Column"),newZone:Ag?Ad:Ab,isPrimary:Ag?!AW:true},{value:V,text:mstrmojo.desc(11712,"Bottom Axis"),newZone:Ad,isPrimary:true}],"checkMark");}}else{if(Am.id===f){var Aa=[];if(!(Ag&&Af.getChartStyle()==="NewGraphMatrixVisualizationStyle")&&(!An||(An&&Aj&&!Ai&&(Ah||(!Ah&&Aq<=0))))){if(!Ag){Aa.push({value:e,text:mstrmojo.desc(11714,"Left Row"),newZone:Ab,isPrimary:true});}Aa.push({value:V,text:mstrmojo.desc(11715,"Left Axis"),newZone:Ad,isPrimary:true});}if(Ag&&Af.getChartStyle()!=="NewGraphMatrixVisualizationStyle"){Aa.push({value:e,text:mstrmojo.desc(11713,"Right Axis"),newZone:Ad,isPrimary:!AW});}AZ.addRadioMenuGroup(Ak,Ae,Aa,"checkMark");}}if(!this.isMetricName(Al)&&(Am.id===R||Am.id===f)){AZ.addSeparator();}if(Af.getChartStyle()==="NewGraphMatrixVisualizationStyle"){return Af.interactor.getMenuConfig(Af,{type:"title"},AZ,{attributeAxis:!Ag,identity:Al,el:AY});}return this.gmZones.getUnitMenuItems(AZ,Ap,Al,AY);},getDynamicBreakByAxisOptions:function(AX){var AY=this.getHost(),AZ=AY.GMController,AW=[];if(AZ.getAttributesOnDropZone("Rows").length){AW.push({n:AX?mstrmojo.desc(3326,"By Columns"):mstrmojo.desc(122,"Columns"),axes_bitmap:Y.DssXmlAxisRowsBit,dmy:"@cols"});}if(AZ.getAttributesOnDropZone("Columns").length){AW.push({n:AX?mstrmojo.desc(3327,"By Rows"):mstrmojo.desc(2968,"Rows"),axes_bitmap:Y.DssXmlAxisColumnsBit,dmy:"@rows"});}if(AZ.getAttributesOnDropZone("Rows").length||AZ.getAttributesOnDropZone("Columns").length){AW.push({n:AX?mstrmojo.desc(13283,"By Cell"):mstrmojo.desc(13399,"Cell"),axes_bitmap:Z.DssAxisDynamicShortcutRoot+E.DssDynamicShortcutCell,dmy:"@cell"});}if(AZ.getAttributesOnDropZone("BreakBy").length){AW.push({n:AX?mstrmojo.desc(13284,"By Shape"):mstrmojo.desc(2923,"Shape"),axes_bitmap:Z.DssAxisDynamicShortcutRoot+E.DssDynamicShortcutShape,dmy:"@shape"});}return AW;},filterAllowItems:function X(Ab,AX,AZ,Aa){var AY,AW;if(AZ>0&&Aa>0){for(AY=Ab.length-1;AY>=0;AY--){AW=this.isMetric(Ab[AY]);if((AW&&AX)||(!AW&&!AX)){Ab.splice(AY,1);}}}if(Ab.length>1&&this.isMetric(Ab[0])){Ab.splice(1,Ab.length-1);}return Ab;},allowDropOnTarget:function AJ(AW,AY){var AX=AT.call(this,this.getZoneModelByZoneId(AY.srcZoneId),AY.itemIdx),AZ=U.copy(AY);AZ.srcZoneId=AX.zone.id;AZ.itemIdx=AX.idx;return this.gmZones.allowDropOnTarget(AW,AZ);},getAllowDropInfo:function B(Am,AX,Ad,AY,AW){var Al=this._super(Am,AX,Ad,AY,AW),Ac=Al.allowedItems,An=this,Ak,Ah=0,Ao=0,Ae=0,Aj={},Ai=AW.src.data.src,Af=this.gmZones.getZoneModelByZoneId(AB)!==undefined;Aj[AD]=An.gmZones.getMetricCntInZone(AD);Aj[g]=An.gmZones.getMetricCntInZone(g);if(Af){Aj[AB]=this.gmZones.getItemCountInZone(AB);}x.forEach(Ac,function(Ap){if(An.isMetric(Ap)){Ao++;}else{if(An.isMetricName(Ap)){Ae++;}else{Ah++;}}});if(Ao>0&&Ae>0&&Am.id!==Ai){var AZ=Am;if(Am.id===f||Am.id===R){AZ=this.gmZones.getZoneModelByZoneId((Am.id===f)?g:AD);if(Ai===AH||Ai===M){Ai=this.gmZones.getZoneModelByZoneId((Am.id===f)?AD:g);}}Aj[AZ.id]+=Ao;Aj[Ai.id]-=Ao;x.forEach(Ac,function(Aq,Ap){if(An.isMetricName(Aq)&&!(Aj[AD]>1||Aj[g]>1||Aj[AB]>1)){Ac.splice(Ap,1);}});}if(Ao>0&&Ah>0&&(Am.id===R||Am.id===f)){if(AY===c.ON){var Ab=Am.items[Ad];if(this.isMetricName(Ab)){Al.allowedItems=[];}}return Al;}else{if(Ac.length>1&&(Ao>=1||Ah>=1)&&Am.id===p){if(this.getItemCountInZone(p)===0){var Aa=(Ah+Ae>=Ao);Ac=this.filterAllowItems(Ac,Aa,Ao,Ah+Ae);return Al;}var Ag=this.isAttrCategory(Am.items[0])||this.isMetricName(Am.items[0]);Ac=this.filterAllowItems(Ac,Ag,Ao,Ah+Ae);return Al;}}for(Ak=Ac.length-1;Ak>=0;Ak--){if(!v.call(An,Am,Ac[Ak],Ad,AW,AY)){Ac.splice(Ak,1);}}return Al;},getAvatarIconClass:function k(){var AW=this.gmZones,AY=AW.getHost(),AZ=AY.getChartInfo();if(AZ.isCombo){return"viGMCombo";}if(AZ.isPie){return"viGMPie";}if(AZ.isBubbleOrScatter){return"viGMBubble";}if(AZ.isABL){var AX=AZ.shape;if(AX===AC.BAR){return"viGMBar";}if(AX===AC.LINE){return"viGMLine";}if(AX===AC.AREA){return"viGMArea";}return"viGMLine";}return"viGMCombo";},shouldAddMetricCount:function L(Ab,AX,Aa,AW){var AY=1,AZ=this.gmZones.hGetItemOccurrence(AI,[F]);Ab.forEach(function(Ac){if(Ac.did===AX.did){AY=0;}});if(Aa===AA&&AZ.length&&Ab[AW].did===AX.did){AY=-1;}return AY;},processDualAxis:function J(Ac,Ah){var Ad=0,Ae=this,AX=Ae.gmZones.getZoneModelByZoneId(AD),AW=Ae.gmZones.getZoneModelByZoneId(g),AZ=[],Aa,Ag=Ac===AD?AX:AW,Af=Ag===AX?AW:AX,AY=Ac===AD?g:AD,Ab=Ae.gmZones.getMetricCntInZone(AY);if(Ab){x.forEach(Ag.items,function(Ai){if(Ae.isMetric(Ai)&&Ai.id!==Ah.id&&Ai.ax!==Ah.ax){Ad=1;AZ.push(Ae.gmZones.getAddDropZoneUnitAction(Ag,Ai,Ai.idx,{isPrimary:Ah.ax===0?true:false}));}});}if(Ad!==1){Aa=Ae.gmZones.isDualAxis(AY);if(Aa){x.forEach(Af.items,function(Ai){if(Ai.id!==Ah.id&&Ai.ax===1){AZ.push(Ae.gmZones.getAddDropZoneUnitAction(Af,Ai,Ai.idx,{isPrimary:true}));}});}}return AZ;},getUnitDroppedActions:function I(Au,AY,As,Ag,Ac,Ak,Aq,AZ){var Ax=this,AW=this.gmZones,Av=AT.call(this,Au,Ag,Ac,this.isMetric(As),this.isMetricName(As)),At=AY.src.data.src,Af=[],AX=Ax.isMetric(As);if(AY&&(At===a.DATASETS||At===a.VIZ_EDITOR)&&!v.call(Ax,Au,As,Ag,AY,Ac)){return Af;}if(q){window.console.log("unitDropped: zone="+Au.id+", idx="+Ag+", edge="+Ac+", xzone="+Av.zone.id+", xidx="+Av.idx+", xedge="+Av.edge);}if(!As.did){As.did=As.id;}if(Au.id===f||Au.id===R){var Ae=AW.getZoneModelByZoneId((Au.id===f)?g:AD),Ad=AW.getZoneModelByZoneId((Au.id===f)?M:AH),Aj=AW.isMetricZone(Ae.id),Ao=false,An;if((Av.zone.id===Ae.id)&&Ae.id!==As.zone&&!Aj&&Ac!==AA&&!this.isMetricName(As)){x.forEach(Ae.items,function(Ay){if(!Ax.isMetricName(Ay)&&Ay.did!==As.did){An=Ay;return false;}});if(An){Af.push(AW.getAddDropZoneUnitAction(Ad,An,Ad.items.length));Ae.items.splice(x.indexOf(Ae.items,An),1);if(Av.idx){Av.idx--;}else{if(Av.idx===0&&Av.edge===S){Av.edge=AQ;}}Af.callback=AN.wrapMethods(AW.getUpdateCallback(),{failure:function(){Ad.items.pop();Ae.items=[An].concat(Ae.items);}});}AY.metricNamesHandled=true;}if(AX){var Ap=AW.getZoneModelByZoneId(AB),Ah=false,Aa=0,Ab=Ad.id;if(Ap!==undefined){Ah=this.isMetricZone(AB);Aa=Ap.items.length;}var Aw=0;x.forEach(Ae.items,function(Ay){if(Ax.isMetric(Ay)){Aw++;}});var Am=Ax.shouldAddMetricCount(Ae.items,As,Av.edge,Av.idx);if(Aw+(Am&&Ac!==AA?1:0)>h){Ao=true;}if(AY.dndGM&&!Aq&&Ac!==c.ON){if(Ae.id===AD){Ab=g;}else{Ab=AD;}}var Al=U.clone(AI),Ar=this.gmZones.hGetItemOccurrence(Al,[M,AH,AD,g,p,F,l]);if(Ar.length===0){Af=Af.concat(AW.getUpdateMetricNameUnitActions(Ao,Ab));AY.metricNamesHandled=true;}else{AY.metricNamesHandled=false;}}}Af=Af.concat(AW.getUnitDroppedActions(As,Av.zone,AY,Av.idx,Av.edge,Ak,Aq,AZ));if(AX&&(Au.id===f||Au.id===R)){var Ai=AW.getZoneModelByZoneId((Au.id===f)?g:AD);if(Ai.id===AD){Af=Af.concat(Ax.processDualAxis(AD,As));}else{if(Ai.id===g){Af=Af.concat(Ax.processDualAxis(g,As));}}}if(AX&&AY.src.data.src===mstrmojo.vi.models.EnumDragSources.VIZ){if(Au.id===AD){Af=Af.concat(Ax.processDualAxis(AD,As));}else{if(Au.id===g){Af=Af.concat(Ax.processDualAxis(g,As));}}}return Af;},unitsDropped:function AP(Af,BA,Ar,AZ,Ad,As){var Au=this.gmZones,Ax=BA.actions||[],A0=[],AX,A9=Ar.idx,Ae=Ar.edge,Aq=Ar.allowedItems,Aj=this,A7,Aa=w.all[this.hostId],A1=false,A8,A3=K.call(this);if(Af.id===f||Af.id===R){if(this.isMetric(Af.items[A9])&&AZ===undefined){if(Ae===AA){AZ=(Af.items[A9].ax===0);}else{if(Aq.length>0&&this.isMetric(Aq[0])&&Aq[0].ax!==undefined){AZ=(Aq[0].ax===0);}}}}if(Ae===AA&&this.isMetric(Af.items[A9])){P.call(this,Aa,Aq,Af.items[A9]);}if(Aq.length>1&&(Af.id===R||Af.id===f)){var Ak=[],A5=[];x.forEach(Aq,function(BB){if(Aj.isMetric(BB)){Ak.push(BB);}else{A5.push(BB);}});if(Ak.length>0&&A5.length>0){var At=AT.call(this,Af,A9,Ae,false),Ab=At.zone,An=Au.getZoneModelByZoneId(o[Ab.id]),Al=(Ab.id===AD||Ab.id===g)?Ak:A5,A4=(An.id===AD||An.id===g)?Ak:A5,Ah=function(BC,BB){return Aj.isAttrCategory(BC)&&Aj.isMetricName(BB.items[BB.items.length-1]);};A9=At.idx;Ae=At.edge;if(Ah(Al[0],Ab)&&(A9>=Ab.items.length-1)){A9-=1;}Al.forEach(function(BC,BB){A8=(BB!==0?S:Ae);AX=Aj.getUnitDroppedActions(Ab,BA,BC,A9,A8,true,Ad);A9+=(AX.length>0&&A8===S?1:0);A0=A0.concat(AX);});A9=An.items.length-1;if(Ah(A4[0],An,A9)){A9-=1;}A4.forEach(function(BB){AX=Aj.getUnitDroppedActions(An,BA,BB,A9++,S,true,Ad);A0=A0.concat(AX);});A1=true;}}if(!A1){for(A7=0;A7<Aq.length;A7++){A8=(A7!==0?S:Ae);AX=Aj.getUnitDroppedActions(Af,BA,Aq[A7],A9,A8,AZ,Ad,As);A9+=(AX.length>0&&A8===S?1:0);A0=A0.concat(AX);}}var AW=K.call(this);var Ai=Au.getZoneModelByZoneId(p);if(!A3&&AW&&Ai!==undefined&&Ai.items.length===0){A0=A0.concat(Au.getUpdateMetricNameUnitActions(true,p));}var Ap=Au.getZoneModelByZoneId(F);if(Ap!==undefined){var Am=Ap.items.length;if(Af.id!==p&&Am>0){Ap.items.forEach(function(BB){if(x.find(Aq,"did",BB.did)>=0){Am--;}});if((!Aq||Aq&&(Aq.length===0||Af.id!==F))&&Am===0){Aa.updateSubtype();}}}var AY=this.docModel,A6=AY.getDataService(),Az=Aa.k,Ac=AN.wrapMethods({success:function(){Aa.resetXMLDirtyFlag();}},Aa.controller._getXtabCallback(Aa)),Ay=A6.getUpdateTemplateAction(Az,A0),Av=Ay.partialRetrieval.nodes,Aw=AY.getSelectedViUnit(),A2=Aw&&Aw.boxContent,Ag=!(A2&&A2.isInFilterPanel());Ac=AN.wrapMethods(BA.callback,Ac);Ay.partialRetrieval.nodes=Av.concat(Ag?AY.getSourceFilterKeys(Az):[]);Ax.push(Ay);if(Aa.isXMLDirty()){Ax.push(Aa.getPersistAction());}var Ao=function(BB){return function(){var BC=BB?AY.wrapUnsetVisualizationFilterAction(Ax):Ax;Aj.checkAndWarnLargeItemsForAddUnits(Aq,function(){Aa.controller.submitUndoRedoUpdates(BC,null,Ac);});};};AY.checkAndNotifyVFChangeOnDZUnitsUpdate({actions:Ax,zm:Aj},Ao(true),Ao(false));},getRemoveDZUnitAction:function AO(AX,AW){var AY=AT.call(this,AX,AW);return this.gmZones.getRemoveDZUnitAction(AY.zone,AY.idx);},getClearDZUnitActions:function AU(AX,AW){var AY=this.gmZones,AZ=[];switch(AX.id){case R:AZ.concat(AY.getClearDZUnitActions(AY.getZoneModelByZoneId(AH),AW));AZ.concat(AY.getClearDZUnitActions(AY.getZoneModelByZoneId(AD),AW));break;case f:AZ.concat(AY.getClearDZUnitActions(AY.getZoneModelByZoneId(M),AW));AZ.concat(AY.getClearDZUnitActions(AY.getZoneModelByZoneId(g),AW));break;default:AZ=AY.getClearDZUnitActions(AX,AW);break;}return AZ;},getAddDZUnitAction:function(AX,AZ,AW,Aa){var AY=this.gmZones;return AY.getAddDropZoneUnitAction(AX,AZ,AW,{isPrimary:Aa});},moveAttributesToZone:function n(AX,AW){return this.gmZones.moveAttributesToZone(AX,AW);},deleteItem:function G(AX,AW){var AY=AT.call(this,AX,AW);this.gmZones.deleteItem(AY.zone,AY.idx,h-1);},deleteItems:function(AW,AX){this.gmZones.deleteItems(AX,h-1);},getHostModel:function(){return this.gmZones.getHostModel();},getMultiUnitsMenuItems:function u(AX,AW,AY){var Aa=this.id;if(!mstrApp.isInVFConfigMode&&mstrmojo.vi.ui.DatasetUnitMenuUtils.getMultiSelectionShortcutMetricFunctions(AY).length&&mstrmojo.resolveFeature(m.INSERT_NEW_METRIC)){var AZ=AW;if(AW.id===f||AW.id===R){AZ=this.gmZones.getZoneModelByZoneId((AW.id===f)?g:AD);}AX.addSubMenuItem(mstrmojo.desc(5188,"Calculation"),"",this.id,function(){return mstrmojo.all[Aa].getMultipleMetricsCalcMenus(AZ,AY,true);});}AX.addMenuItem(mstrmojo.desc(190,"Remove"),"xt",function(){mstrmojo.all[Aa].deleteItems(AW,AY);});},addUnitsFromDataSource:function D(AX,AY,AZ,AW){this.gmZones.addUnitsFromDataSource(AX,AY,AZ,AW);},getHighlightTargets:function AR(Aa,Ae){var AW=AT.call(this,Aa,Ae.dzidx||Ae.idx,Ae.edge),Ac=AW.zone,AZ=this.gmZones,AY=AZ.getHost(),Ag=AY.GMController,Ab,AX,Ad;if(!Ag.isHistogram&&(Ac.id===AD||Ac.id===g)){AX=this.gmZones.getZoneModelByZoneId((Aa.id===f)?M:AH);Ad=AX.items.length;Ab=this.gmZones.getHighlightTargets(Ac,Ad,{allowedItems:Ae.allowedItems,idx:AW.idx,edge:AW.edge});}var Af=(this.isAttrCategory(Ae.item)&&this.isMetric(Aa.items[Ae.idx]))||(this.isMetric(Ae.item)&&(this.isAttrCategory(Aa.items[Ae.idx])||this.isMetricName(Aa.items[Ae.idx])));if(Aa.id===p&&Aa.items.length&&Af){Ab=[];Aa.items.forEach(function(Ai,Ah){Ab.push({idx:Ah,edge:Ae.edge});},this);return Ab;}if(!Ab){return this._super(Aa,Ae);}return Ab;},clearAllDropZones:function(AX){var AW=w.all[this.hostId];AW.updateSubtype();this._super(AX);}});mstrmojo.vi.models.CombineDropZonesModel.EnumDropZones={HORIZONTAL:R,VERTICAL:f};}());(function(){mstrmojo.requiresCls("mstrmojo.DocBuilder","mstrmojo.rw._IsReportServicesDocBuilder","mstrmojo.DocLayoutViewer","mstrmojo.maps.MapInfoWindowLayoutViewer","mstrmojo.DocGroupBy","mstrmojo.DocTextfield","mstrmojo.DocHTMLContainer","mstrmojo.Xtab","mstrmojo._Formattable","mstrmojo._IsDocXtab","mstrmojo.IncFetch","mstrmojo.express.ui.DocButton","mstrmojo.ExpressDocPanel","mstrmojo._IsEditableXtab","mstrmojo._CanSupportTransaction","mstrmojo.ExpressVisList","mstrmojo.OIVMDICConfig","mstrmojo.OIVMDocSelectorViewFactory","mstrmojo.OIVMDocXtabGraph","mstrmojo.vi.models.DocVisModel","mstrmojo.vi.models.DocXtabModel","mstrmojo.MenuButton","mstrmojo._HasHoverButton","mstrmojo.ToolBar","mstrmojo.vi.ui.rw.selectors._IsMultiUnitControl","mstrmojo.vi.ui.rw._IsMultiselectXtab","mstrmojo.vi.ui.rw._HasVisSelections","mstrmojo.vi.ui.rw._XtabHighlights","mstrmojo.rw.xtab._XtabColResize");var B=mstrmojo.EnumRWUnitType,O=mstrmojo.DynamicClassFactory.newComponent;mstrmojo.DocXtab=O(mstrmojo.Xtab,[mstrmojo._Formattable,mstrmojo._IsDocXtab,mstrmojo._HasOwnAvatar,mstrmojo.rw.xtab._XtabColResize,mstrmojo.vi.ui.rw._IsMultiselectXtab,mstrmojo.vi.ui.rw._HasVisSelections,mstrmojo.vi.ui.rw.selectors._IsMultiUnitControl,mstrmojo.vi.ui.rw._XtabHighlights],{scriptClass:"mstrmojo.DocXtab"});var D=3,M=4;var A=function(R,Q){var P=R;while(P){if(P.controller&&P.controller[Q]){return P.controller;}P=P.parent;}return null;};mstrmojo.ExpressDocBuilder=mstrmojo.declare(mstrmojo.DocBuilder,[mstrmojo.rw._IsReportServicesDocBuilder],{scriptClass:"mstrmojo.ExpressDocBuilder",visList:mstrmojo.ExpressVisList,createSelectorFactory:function K(){return new mstrmojo.OIVMDocSelectorViewFactory();},createClassMap:function H(){var P=this._super();P[B.PANEL]={n:"Panel",scriptClass:"mstrmojo.ExpressDocPanel"};P[B.HTMLCONTAINER]={n:"HTMLContainer"};P[B.GRAPH]={n:"OIVMDocXtabGraph",scriptClass:"mstrmojo.OIVMDocXtabGraph"};P[B.TEXTFIELD+"B"]={n:"Button",scriptClass:"mstrmojo.express.ui.DocButton"};return P;},getDefaultMojoVisModel:function F(){return mstrmojo.vi.models.DocVisModel;},getLayoutViewerClass:function J(P){return mstrmojo.DocLayoutViewer;},newLayout:function I(P,R){var Q=this._super(P,R);var S=R.data.gbys;if(S&&S.showGroupby){Q.addChildren(new mstrmojo.DocGroupBy({id:S.k,slot:"groupBy",title:S.title,model:P,node:R,data:S.groupbys,controller:this.parent.controller}));}if(R.data.ifs){var U=new mstrmojo.IncFetch(mstrmojo.hash.copy(R.data.ifs,{slot:"incFetchNode",model:P}));U.attachEventListener("fetch",Q.id,function(V){P.getDataService().fetchDocPage((V.v-1)*U.ps+1,{success:function(W){P.loadLayout(W);}});});Q.addChildren(U);}return Q;},newOIVMDocXtabGraph:function(P,Q){var R=new mstrmojo.OIVMDocXtabGraph({id:Q.id,node:Q,controller:this.parent.controller,model:P,gridInfo:Q.data.gsi});R.model=new mstrmojo.vi.models.DocXtabModel({xtab:R,docModel:P});return R;},getEditableXtab:function G(){if(!mstrmojo.EditableXtab){mstrmojo.EditableXtab=O(mstrmojo.Xtab,[mstrmojo._CanSupportTransaction,mstrmojo._IsEditableXtab],{scriptClass:"mstrmojo.EditableXtab"});}return mstrmojo.EditableXtab;},getDefaultXtab:function N(){return mstrmojo.DocXtab;},getPortletExportGridToolbar:function C(U){var Q=U.k,S=U.node.data,R=S.wid,P=[];if(S.disablePDF&&S.disableEXCEL){return ;}if(!S.disablePDF){P.push({n:mstrmojo.desc(5212,"Export to PDF"),did:D});}if(!S.disableEXCEL){P.push({n:mstrmojo.desc(5213,"Export to Excel"),did:M});}return{css:"grid-menu",node:{scriptClass:"mstrmojo.ToolBar",slot:"toolbarNode",alias:"rightToolbar",children:[{scriptClass:"mstrmojo.MenuButton",iconClass:"mstrmojo-oivmSprite tbDown",itemIdField:"did",itemField:"n",itemChildrenField:"subItms",executeCommand:function(W){var V=A(this,"exportCmd");if(V){V.exportCmd(W.did,Q,R);}},cm:P}]}};},newHTMLContainer:function(P,Q){return this.newRWUnitInstance(P,Q,(Q.defn.ht===0)?mstrmojo.DocHTMLContainer:mstrmojo.DocTextfield);},newInfoWindow:function E(P){return new mstrmojo.DocInfoWindow(P);},getLinkDrillMixins:function L(P){return P?[mstrmojo._HasHoverButton]:[];}});}());(function(){mstrmojo.requiresCls("mstrmojo.Doc","mstrmojo.dom","mstrmojo.array","mstrmojo.ExpressDocBuilder","mstrmojo.ToolBar","mstrmojo.OIVMPage","mstrmojo.ToolBarBuilder","mstrmojo.TabContainer","mstrmojo.ScrollingTabStrip","mstrmojo.ToolBarModel","mstrmojo.OIVMDocController","mstrmojo._IsWebApp","mstrmojo.DocModel","mstrmojo.vi.enums.EnumHiddenSections");var G=mstrmojo.array,F=mstrmojo.vi.enums.EnumHiddenSections;var M=mstrmojo.dom;function J(){M.attachEvent(window,"keydown",function(O){var N=O.keyCode===8;O=O||window.event;if(N&&mstrApp.ignoreBackSpace){M.preventDefault(window,O);}});}function K(){var Q=mstrmojo.all[this.tbId],R=Q&&Q.children;var N=G.find(R,"iconClass","tbBackPicker"),O=[];if(N>0){var P=R[N];O=P.items;P.selectedIndex=0;}return O;}function I(N){return(N==="F1FED8AC42B57AC1B0E9518FED0F89D6")?"mojo-theme-dark":"mojo-theme-light";}mstrmojo.OIVMApp=mstrmojo.declare(mstrmojo.Obj,[mstrmojo._IsWebApp],{scriptClass:"mstrmojo.OIVMApp",enableWaitBox:true,hiddenSecState:null,hiddenSec:null,start:function B(){var S=new mstrmojo.Doc({slot:"stack"});this.hiddenSecState=this.setHiddenSections(this.hiddenSec);S.builder=new mstrmojo.ExpressDocBuilder({parent:S});this.docId=S.id;mstrApp.pathInfo.tbModelData=this.tbModelData;var R=new mstrmojo.ui.pathbar.PathBar({slot:"pathbarNode",alias:"pathbar",pathInfo:mstrApp.pathInfo});var P=new mstrmojo.OIVMPage({placeholder:this.placeholder,themeClassName:I(this.docModelData&&this.docModelData.thm&&this.docModelData.thm.id),error:this.error,children:(R.visible?[R]:[]).concat([new mstrmojo.TabContainer({slot:"layout",layoutConfig:{h:{top:"auto",stack:"100%"},w:{top:"100%",stack:"100%"}},children:[new mstrmojo.ScrollingTabStrip({slot:"top",cssClass:"mstrmojo-layout-tabs",visible:false,bindings:{width:"this.parent.width"}}),S]})])});if(this.isSectionHidden(F.DOCKTOP)){P.layoutConfig.h.toolbar="0px";}if(!R.visible||this.isSectionHidden(F.PATH)){P.layoutConfig.h.pathbarNode="0px";}P.render();var U=this.docModelData;if(U&&U.mstrerr){mstrmojo.err(U.mstrerr);}else{if(!this.error){var O=S.model=new mstrmojo.DocModel(U),N=S.controller=O.controller=new mstrmojo.OIVMDocController({view:S});N.set("model",O);N.start();if(R.visible){R.dc=N;}mstrApp.docModel=O;mstrmojo.locales.load(function(){S.buildChildren();if(O.zt===1||O.zt===2){P.browserResized(P.getBrowserDimensions(),true);}if(mstrApp!==undefined&&window.mstrLocalStorage!==undefined){mstrLocalStorage.addScreenshot(mstrApp.getLastMsgRecoveryInfo(),P.layout);}});if(mstrApp.pendingMojoEditor&&mstrApp.pendingMojoEditor!==""){S["show"+mstrApp.pendingMojoEditor]();delete mstrApp.pendingMojoEditor;}var Q=S.model.rf;if(Q>0){S.model.controller.startAutoRefresh();}this.startSessionManager();if(O.isHTML5VI){mstrmojo.css.addClass(document.body,["html5vi"]);}if(O.isPVPartialExecution){if(mstrApp.isDossier){mstrmojo.alert(mstrmojo.desc(15534,"Your personal view displays only a subset of your changes as the source dossier definition has been modified. Please contact your administrator for more information."));}else{mstrmojo.alert(mstrmojo.desc(15765,"Your personal view displays only a subset of your changes as the source document definition has been modified. Please contact your administrator for more information."));}}}}J.call(this);this.hidePageLoadingWaitBox();},hidePageLoadingWaitBox:function L(){var N=document.getElementById("pageLoadingWaitBox");if(N){N.style.display="none";}},setHiddenSections:function H(P){var O={docktop:F.DOCKTOP,path:F.PATH};var N=0;if(P){P=P.toLowerCase();mstrmojo.hash.forEach(O,function(R,Q){if(P.indexOf(Q)>-1){N+=R;}});}return N;},isSectionHidden:function C(N){return this.hiddenSecState&&(this.hiddenSecState&N)===N;},getVersion:function D(){return(this.buildVersion?"v="+this.buildVersion:"")+(this.appVersion?"&apv="+this.appVersion:"");},addBackButtonItem:function A(N){K.call(this).unshift(N);},removeBackButtonItems:function E(N){K.call(this).splice(0,N);}});}());(function(){mstrmojo.requiresCls("mstrmojo.vi.ui.InteractiveUnitList","mstrmojo.vi.ui._IsDropTarget","mstrmojo.ui.menus.MenuConfig","mstrmojo.ui.menus.EditorConfig","mstrmojo.vi.models.CombineDropZonesModel","mstrmojo.vi.models.DropZonesModel","mstrmojo.vi.models.EnumDragSources","mstrmojo.vi.viz.EnumDSSDropZones","mstrmojo.dom","mstrmojo.hash","mstrmojo.css","mstrmojo.array","mstrmojo.gm.GMEnums","mstrmojo.boxmodel","mstrmojo.tooltip","mstrmojo.vi.viz.DropZoneHelper");var N=mstrmojo.dom,C=mstrmojo.css,P=mstrmojo.hash,p=mstrmojo.array,W=mstrmojo.boxmodel,r=mstrmojo.vi.viz.EnumDSSDropZones,AM=mstrmojo.tooltip,U=mstrmojo.vi.models.DropZonesModel.ENUM_TARGET_POSITION,AH=U.ABOVE,AG=U.ON,O=U.BELOW,AI=mstrmojo.vi.models.EnumDragSources,AL="is-mh",c="icon",A="zone",H="form",S=mstrmojo.vi.viz.EnumDSSDropZones,k=mstrmojo.vi.models.CombineDropZonesModel.EnumDropZones,M=k.HORIZONTAL,Y=k.VERTICAL,z=S.XAxis,Z=S.YAxis,j=S.ColorBy,AB="mstrmojo-VIVizEditor-Menu",K=mstrmojo.gm.DualAxisSubAxisBit,X=K.SECONDARY,g=mstrmojo.vi.viz.DropZoneHelper.isMetricNames,Q=mstrmojo._HasTooltip.TOOLTIP_OPEN_DELAY;var R={};R[AH]="Top";R[AG]="";R[O]="Bottom";var o='<{@tag} class="item {@cls}" idx="{@idx}" style="{@style}"><div class="outer-wrap"><div unselectable="on" class="inner-wrap"><span unselectable="on" class="txt">{@en@n}</span><div class="'+c+'"></div><div class="'+A+'"></div></div></div></{@tag}>';var l=[];function v(AP){var AO=Array.prototype.slice.apply(this.itemsContainerNode.childNodes),AN=function(AR){var AQ=AR.idx===undefined?AR:AO[AR.idx];P.keyarray(R).forEach(function(AS){C.removeClass(AQ,"dragIn"+R[AS]);});};p.forEach(AO,AN);l=[];AN(AP);}function u(AQ,AT,AO){var AS=AQ.y-2,AN=AQ.h*this.zonesModel.getTargetEdgePortion(AO),AP=N.getMousePosition(AT).y,AR=AG;if((AP>=AS)&&(AP<AS+AN)){AR=AH;}else{if(AP>=AS+AQ.h-AN){AR=O;}}return AR;}function h(AP,AN){if(!g(AP)){var AO={zone:this.zonesSource,item:AP};if(this.zonesModel.hasReplaceCandidates(AO)){var AQ=this.zonesModel.getReplaceSubMenu(AO,{scriptClass:"mstrmojo.Label",text:mstrmojo.desc(11703,"Replace with:"),cssClass:"mstrmojo-menu-replaceLabel"});AQ.position=AN;AQ.isHostedWithin=false;AQ.hostId=this.id;this.openPopup(AQ.newInstance());}}}function AF(AQ,AN){var AP=this.zonesSource.id;if(AP===r.Latitude||AP===r.Longitude){var AO={zone:this.zonesSource,item:AQ};if(this.zonesModel.getSelectGeoFormMenu){var AR=this.zonesModel.getSelectGeoFormMenu(AO);if(AR){AR.position=AN;AR.isHostedWithin=false;AR.hostId=this.id;this.openPopup(AR.newInstance());}}}}function AJ(){if(this.panelId==undefined){return ;}var AN=mstrmojo.all[this.panelId];if(!!AN){AN.set&&AN.set("activeZoneId",this.id);}}function G(){var AN=mstrmojo.all[this.panelId]&&mstrmojo.all[this.panelId].activeZoneId;return !AN||(AN===this.id);}function AD(AP,AN,AO){var AR=new mstrmojo.ui.menus.MenuConfig({menuCssClass:AB,supportsScroll:true,alignWithAnchor:true,isHostedWithin:false,maxHeight:N.getMaxScrollHeight()}),AQ=this.getLabelNode(AP);AO.call(this,AR,AQ);if(AR.hasMenuItems()){AR.position=AN;AR.isHostedWithin=false;AR.hostId=this.id;this.openPopup(AR.newInstance());}}function V(Ab,AY,AV,AS){if(!this.visible&&!AS){return ;}var AU=this.content,AR=this.contentNode,Ah=this.domNode,Ai=Ah.style;if(AR&&AU){Ai.left=0+"px";AR.innerHTML=AU;}mstrmojo.Tooltip.prototype.updatePosition.call(this,AS);var Ac=Ah.className,AX=(Ac&&Ac.split(" "))||[],Aa=p.indexOf(AX,"offset")!==-1;if(Aa){var AQ=this.refNode,AP=AQ?W.offset(AQ,document.body):{left:N.getHorizontalScroll()},Ad=this.containerNode,Ag=Ad.offsetWidth,AN=this.posType,AW=AN===AM.POS_BOTTOMRIGHT||AN===AM.POS_TOPRIGHT,AT=AN===AM.POS_BOTTOMLEFT||AN===AM.POS_BOTTOMRIGHT||AN===AM.POS_BOTTOMCENTER,AO=parseInt(this.left,10)+AP.left-(AW?Ag:((AN.indexOf("C")>-1)?Math.floor(Ag/2):0)),AZ,Af=N.windowDim(),Ae=N.getHorizontalScroll()+Af.w;if(AO!==null&&!AW&&!AT&&AO>Ae-Ag){AZ=parseInt(Ab.x-6,10)+AP.left-Ag;if(AZ>0){this.posType=AT?AM.POS_BOTTOMRIGHT:AM.POS_TOPRIGHT;this.left=Ab.x-6;this.cssClass=AV+" vi-tooltip-D";}else{this.posType=AM.POS_BOTTOMLEFT;this.left=AY.x;this.top=AY.y-6;this.cssClass=AV+" vi-tooltip-V";}}}}mstrmojo.vi.ui.VisualizationEditorUnitList=mstrmojo.declare(mstrmojo.vi.ui.InteractiveUnitList,[mstrmojo.vi.ui._IsDropTarget],{scriptClass:"mstrmojo.vi.ui.VisualizationEditorUnitList",zonesModel:null,zonesSource:null,multiSelect:true,useListModKeys:true,useRichTooltip:true,tooltipOpenDelay:Q,hasTooltipContent:function(AN,AO){return true;},getItemTooltip:function(AR,AU,AT){var AN=N.position(AT),AO=N.position(AU),AS=N.position(this.getLabelNode(AU));if(AT===this.getIconNode(AU)&&!g(AR)){return{areaId:AR._renderIdx+"icon",cssClass:"vi-regular vi-tooltip-V",contentNodeCssClass:"regular-unitlist-tooltips",posType:AM.POS_BOTTOMLEFT,content:mstrmojo.desc(11687,"Click to replace"),top:AN.y-8,left:AN.x-4};}else{if(AT===this.getZoneNode(AU)){if(AR.geoWarning){return{areaId:AR._renderIdx+"zone",cssClass:"vi-regular vi-tooltip-A",contentNodeCssClass:"regular-unitlist-tooltips",posType:AM.POS_TOPLEFT,content:mstrmojo.desc(14113,"Select an attribute form as geographic role"),top:AN.y+28,left:AN.x-4};}else{if(AU.className.indexOf("icz12")>0){var AQ=this.zonesModel.getHost(true),AP=AQ&&AQ.getTtpContent4GeoItem&&AQ.getTtpContent4GeoItem(AR._renderIdx);return{areaId:AR._renderIdx+"zone",cssClass:"vi-warning vi-tooltip-C",contentNodeCssClass:"regular-unitlist-tooltips",posType:AM.POS_TOPLEFT,content:AP||"",enableHover:true,top:AN.y-6,left:AN.x+AN.w+6,updatePosition:function(AV){return V.call(this,AO,AS,"vi-warning",AV);}};}}}}return P.copy({cssClass:"vi-regular vi-tooltip-C",posType:AM.POS_TOPLEFT,top:AO.y-2,left:AO.x+AO.w+6,keepArrowXPos:true,updatePosition:function(AV){return V.call(this,AO,AS,"vi-regular",AV);}},this._super(AR,AU,AT));},doItemSelect:function(AP,AO){var AN=AO.hWin,AQ=AO.e;if(G.call(this)||(!N.shiftKey(AN,AQ)&&!N.isMetaKey(AN,AQ))){AJ.call(this);this._super(AP,AO);}},isDragValid:function d(AN){var AO=AN.src.e;return !(!G.call(this)&&(AO.ctrlKey||AO.shiftKey||AO.metaKey))||this._super(AN)||false;},ondragstart:function AA(AN){this.isIgnoreTooltipCloseDelay=true;this.hideTooltip();this.selectDragNode(AN);this._super(AN);},onItemContextMenu:function b(AW,AV){var AS=AV.e,AO=this.getItemNodeFromTarget(AV.getTarget()),AQ=AV.hWin,AP=this.getSelectedItems().some(function(AX){return AX.itemNode===AO;});if(AW&&!AP){this.doItemSelect(AW,AV);}var AT=AV.getTarget(),AU=this.getSelectedItems();if(AU.length){this.closePopup();var AR=AU&&AU.length>1,AN=AR?"showMultiSelectionMenu":"showItemMenu";this[AN](AR?AU:AW,this.getItemNodeFromTarget(AT),N.getMousePosition(AS,AQ));return true;}},showItemMenu:function I(AP,AO,AN){AD.call(this,AO,AN,function(AQ,AR){this.zonesModel.getUnitMenuItems(AQ,this.zonesSource,AP,AR);});},showMultiSelectionMenu:function e(AO,AP,AN){AD.call(this,AP,AN,function(AQ){this.zonesModel.getMultiUnitsMenuItems(AQ,this.zonesSource,AO,null);});},deleteItem:function F(AN){this.zonesModel.deleteItem(this.zonesSource,AN._renderIdx);},deleteItems:function E(AN){this.zonesModel.deleteItems(this.zonesSource,AN);},getItemProps:function q(AP,AN){var AO=this._super(AP,AN);AO.n=AO.n||"&nbsp; ";if(AP.t===4&&g(AP)){AO.addCls(AL);AO.n=mstrmojo.desc(11808,"Metric Names");}var AQ=AP.zone;if((!this.zonesModel||this.zonesModel.destroyed)||this.zonesModel.shouldMetricNameShowIcon(AP,AP.zone)){if(AQ!==undefined){AQ="icz"+AQ;if(AP.ax===X){AQ+="s";}AO.addCls(AQ);}}if(AP.hidden){AO.addCls("hidden");}if(AP.attn&&AP.fnm){AO.attn=AP.attn;AO.fnm=AP.fnm;}if(AP.geoWarning){AO.addCls(AP.geoWarning);}return AO;},getItemMarkup:function J(AO){var AN=o.replace("{@midTruncateCssClass}",this.midTruncateCssClass);if(AO&&AO.attn&&AO.fnm){AN.replace("{@en@n}",'{@en@attn}@<span unselectable="on" class="'+H+'">{@en@fnm}</span>');}return AN;},getDragData:function t(AN){this.selectDragNode(AN);var AP=this._super(AN),AO=this;AP.itemIdx=AN.src.node.getAttribute("idx");AP.item=this.items[AP.itemIdx];if(AP.items===undefined){AP.items=[];}if(!!AP.item&&p.find(AP.items,"did",AP.item.did)===-1){AP.items.push(AP.item);}AP.src=AI.VIZ_EDITOR;AP.srcZoneId=this.zonesSource&&this.zonesSource.id;AP.onRemove=function(AQ){if(AQ.length>1){AO.deleteItems(AQ);}else{AO.deleteItem(AQ);}};AP.allowDropOnTarget=function(AS,AR){var AQ=true;if(this.allowDropOnTarget){AQ&=this.allowDropOnTarget(AR,AS);}return AQ;}.bind(AO.zonesModel,AP);return AP;},createAvatar:function f(AP,AO){var AN=this._super(AP,AO);Array.prototype.slice.call((AN&&AN.childNodes)||[]).forEach(function(AQ){C.removeClass(AQ,mstrmojo.vi.ui.InteractiveUnitList.CLS_HAS_X);C.addClass(AQ,mstrApp.rootCtrl.view.themeClassName);},this);return AN;},getIconNode:function AK(AO){var AN=AO.firstElementChild.firstElementChild.childNodes;return AN&&AN[1];},getZoneNode:function L(AO){var AN=AO.firstElementChild.firstElementChild.childNodes;return AN&&AN[2];},ondragover:function n(Az){var Ac=this,AN=Az.tgt,AX=Ac.getItemNodeFromTarget(AN.node)||AN.node,Aw=parseInt(AX.getAttribute("idx"),10),Ag=Az.tgtData,Ab=Ag&&Ag.node,Ap=(AN.widget||{}).items,AO=Ap&&Ap[0];if(!Ag||Ab!==AX){Ag=Az.tgtData={item:Ac.zonesSource.items[Aw],node:AX,pos:N.position(AX,true)};if(Ab){v.call(Ac,Ab);}}v.call(Ac,AX);var Ay=this.getTargetEdgeAndIndex(Ag.pos,AN.e,Az,AX),AS=Ay&&Ay.edge,Ak=AS===AH,Ai=AS===AG,AR=AS===O,Ar=this.getContextDragData(Az),Al=this.zonesModel,AZ=this.zonesSource,AW=AZ.id,Au=Al.getZoneSummary(AW),AT=AW===j,AQ=AW===M,Ax=AW===Y,Ah=Ay&&P.copy(Ay,Al.getAllowDropInfo(AZ,Ar.items,Ay.idx,Ay.edge,Az)),Ad=false,Ae=Ai&&Ah.removeReplaced,Am=Au.attributeCount+(Au.hasMetricName?1:0),At=false,Aa=Al.isAttrCategory(AO),AY=Al.isMetric(AO),Ao=Al.isMetricName(AO);if(Ah&&Ah.allowedItems.length){var AV=this.itemsContainerNode,Aq=Array.prototype.slice.apply(AV.childNodes);if((AQ||Ax)&&AY&&!Ag.item&&Al.isAttrCategory(Ah.item)&&Ap.length===1&&Az.last.y<=Ag.pos.y){At=true;}if(!!mstrApp.isWSStyling){this.parent.addBorder();}if(!Aq.length||Aq.every(function(A1){return(A1.className||"").indexOf("hidden")>-1;})){C.addClass(AV,"dragIn");this.raiseHLToggle(true);}else{var An=Al.getHighlightTargets(AZ,Ah);p.forEach(An,function(A8){var A1=Aq[A8.idx],A3=AZ.items[A8.idx],BD=Ar.item,BC=Al.differInType(BD,A3),A2=Al.isMetricName(A3),BE=Al.isMetric(A3),A4=Al.isAttrCategory(A3),BB=BC&&BE,A6=BE&&A8.idx>Am,A5=Aw===A8.idx;l.push(A3);if(AT&&(BC||BE||A2)){var A7=Al.isAttrCategory(BD);if(A2&&A7&&(Ak||AR)){C.addClass(A1,"dragInTop");return false;}else{C.addClass(A1,"dragIn");}}else{if((Ax||AQ)&&(BB||A2)){if(At){C.addClass(A1,"dragInTop");}else{if(Al.isMetric(BD)){if(A2){C.addClass(A1,"dragInBottom");}}else{if(A2&&AR){C.addClass(A1,"dragInTop");return false;}else{if(!A6){Ad=(!(Ak&&A5)||Ae)&&!A2;if(!Ad){var A9=null,BA=false;p.forEach(AZ.items,function(BF){if(Al.isAttrCategory(BF)){A9=BF;}else{if(!!A9){C.addClass(Aq[A9.idx],"dragInBottom");BA=true;return false;}else{if(Al.isMetricName(BF)){C.addClass(Aq[BF._renderIdx],"dragInTop");BA=true;return false;}else{return false;}}}});if(!A9&&!BA){C.addClass(A1,"dragIn"+R[A8.edge]);}return false;}else{C.addClass(A1,"dragIn");}}else{if(Ad){C.addClass(A1,"dragIn");}}}}}}else{if(Ax||AQ){if(A4&&BC){C.addClass(A1,Ai?"dragIn":"dragIn"+R[O]);}else{C.addClass(A1,"dragIn"+R[A8.edge]);}}else{C.addClass(A1,"dragIn"+R[A8.edge]);}}}});this.raiseHLToggle(true);}if(Ar.setAvatarClass){var Af=Ar.src,AP="";if(Af===AI.DATASETS||Af===AI.ALL_OBJECT_LIST){AP=Ai?"replace":"add";p.forEach(Ap,function(A1){if(A1.zone===j){var A2=0,A3=0;p.forEach(Ar.items,function(A4){if(Al.isMetric(A4)){A2++;}else{if(Al.isAttrCategory(A4)){A3++;}}});if(!(A2&&A3)&&(Al.differInType(A1,Ar.item)||Al.isMetric(Ar.item))){AP="replace";}}if((A1.zone===z||A1.zone===Z)&&Al.differInType(A1,Ar.item)){if(!Ai&&Al.isMetric(Ar.item)){AP="add";}else{AP="replace";}}});if(AQ||Ax){if(At){AP="add";}else{if(AO){var As,Aj,AU=Al.isAttrCategory(Ar.item);if(Aa&&AU){var A0=true;AP=Ai?"replace":"add";for(As=0;As<l.length;As++){Aj=l[As];if(!Aj&&!Aj.hasOwnProperty("idx")){var Av=parseInt(Aj.getAttribute("idx"));Aj=AZ.items[Av];}if(Al.isMetric(Aj)){if(A0){AP=Ak?"add":"replace";}else{AP="replace";}A0=false;}}}else{if((AY||Ao)&&AU){AP=Ad?"replace":"add";}}}}}}else{if(Af===AI.VIZ_EDITOR||Af===AI.VIZ){AP=(Ak||AR||AN.node===AV)?"move":(Ai?"replace":"");}}Ar.setAvatarClass(AP);}}else{if(Ar.setInvalidAvatarClass){Ar.setInvalidAvatarClass();}}},getDropAvatarIcon:function B(AP){var AQ=AP.getCtxtDragData(),AN=AQ.src,AO=this.zonesSource.getDropIconCls(AQ);if(AN===AI.DATASETS||AN===AI.ALL_OBJECT_LIST){AO="add";}return AO;},ondrop:function m(AO){this.ondragover(AO);var AV=AO.tgt,AS=AO.src&&AO.src.data,AP=AS&&AS.src,AN=this.getTargetEdgeAndIndex(AO.tgtData.pos,AV.e,AO,this.getItemNodeFromTarget(AV.node)||AV.node),AU=this.zonesModel,AW=this.zonesSource,AX=AN&&P.copy(AN,AU.getAllowDropInfo(AW,AO.getCtxtDragData().items,AN.idx,AN.edge,AO));if(AX&&AX.allowedItems.length&&AP!==AI.VIZ_LAYER){AU.getHost().model.addEditNodeForDatasetAction(AO,AU.getHost().k);var AQ=function(){AU.unitsDropped(AW,AO,AX);};if(AP===AI.ALL_OBJECT_LIST){var AT=AO.src.widget,AR=AT&&AT.dataProvider;if(AR){AR.loadObjects(AX.allowedItems,{success:AQ},true);}}else{AQ();}}this._super(AO);},allowDrop:function D(AO){var AP=AO.getCtxtDragData(),AN=AP.src;if(AN===AI.DATASETS||AN===AI.VIZ_EDITOR||AN===AI.ALL_OBJECT_LIST||AN===AI.VIZ){return this.zonesModel.isZoneDropAllowed(this.zonesSource,AP);}return false;},onclick:function w(AN){var AP=AN.target||N.eventTarget(AN.hWin,AN.e),AO=this.getItemFromTarget(AP);if(AO!==undefined){switch(AP.className){case c:N.preventDefault(window,AN.e);AP=AN.getTarget();AO=this.getItemFromTarget(AP);if(AO){AN.cancel();this.closePopup();h.call(this,AO,N.getMousePosition(AN.e,AN.hWin));}break;case A:case H:N.preventDefault(window,AN.e);AP=AN.getTarget();AO=this.getItemFromTarget(AP);if(AO&&(AO.geoWarning||(AO.attn&&AO.fnm))){AN.cancel();this.closePopup();AF.call(this,AO,N.getMousePosition(AN.e,AN.hWin));break;}default:this._super(AN);}}},cleanUpAfterTarget:function x(AN){var AO=AN.tgtData;if(AO){v.call(this,AO.node);if(!!mstrApp.isWSStyling&&this.parent.clearBorder){this.parent.clearBorder();}this.raiseHLToggle(false);}this._super(AN);},clearBorderClasses:v,raiseHLToggle:function AC(AO){var AN;try{this.parent.parent.parent.model.raiseEvent(P.copy({name:"viVizEditorDrag",isIn:AO,id:this.parent.parent.parent.viPanelType},AN));}catch(AP){}},getTargetEdgeAndIndex:function AE(AO,AR,AN,AS){if(N.contains(this.itemsContainerNode,AS,true,this.domNode)){var AU=AN.tgtData.item,AV=(this.items||[]).length-1,AP=u.call(this,AO,AR,AN);if(AU){AV=AU._renderIdx;}else{var AQ=N.getMousePosition(AR).y,AT=AQ>AO.y;if(AT){AP=O;}else{AV=0;AP=AH;}}return{item:AN.getCtxtDragData().item,edge:AP,idx:Math.max(AV,0)};}return null;},twoClicksItem:function a(AP,AN){var AQ=this.getLabelNode(this.getItemNodeFromTarget(AN.getTarget())),AR=new mstrmojo.ui.menus.MenuConfig({menuCssClass:AB});this.zonesModel.getUnitMenuItems(AR,this.zonesSource,AP,AQ);var AO=AR.menus;if(p.some(AO,function(AS){return AS.n===mstrmojo.desc(1388,"Rename");})){this.zonesModel.renameItem(AQ,AP);}}});}());(function(){mstrmojo.requiresCls("mstrmojo.vi.models.XtabDropZones","mstrmojo.vi.models.EnumDragSources","mstrmojo.array");mstrmojo.requiresDescs(3631,3632,3582);var H=mstrmojo.array,B=-1,C=1,G=2;function F(){return mstrmojo.all[this.hostId];}function D(){return F.call(this).gridInfo;}mstrmojo.vi.models.GraphDropZones=mstrmojo.declare(mstrmojo.vi.models.XtabDropZones,null,{getDropZones:function E(){var I=D.call(this);return{n:F.call(this).defn.ttl,zones:[this.getZone(mstrmojo.desc(3631,"Categories"),C,I.rows),this.getZone(mstrmojo.desc(3632,"Series"),G,I.cols),this.getZone(mstrmojo.desc(3582,"Metrics"),B,I.mx)]};},getUnitMenuItems:function A(M,O,Q,P){if(!Q){throw new Error(this.scriptClass+"::getUnitMenuItems: Item must be provided.");}var N=O.items,K=N.length,L=O.id,J={zone:O,axis:L,idx:H.indexOf(N,Q),cnt:K,item:Q,metricsAxis:D.call(this).tma},I=this.id;M.addMenuItem(mstrmojo.desc(190,"Remove"),"xt",function(){mstrmojo.all[I].deleteItem(O,J.idx);});}});})();(function(){mstrmojo.requiresCls("mstrmojo.Obj","mstrmojo.dom","mstrmojo.array","mstrmojo.hash","mstrmojo.vi._MonitorsLayoutMode","mstrmojo.vi.models._CheckDataCards","mstrmojo.vi.models.EnumPanelTypes","mstrmojo.EnumRWUnitType");var F=mstrmojo,A=F.hash,D=F.dom,E=F.array;var K={RESERVED:0,CARD:1,BASIC:2};var H="F1FED8AC42B57AC1B0E9518FED0F89D6";function I(R){var W=R.currlaykey,U=E.filter(R.data.layouts,function(Y){return W===Y.k;}),V=U[0],Q=new mstrmojo.vi.models.DocModel(R),O=Q.getVIPanelKeyFromUnits(mstrmojo.vi.models.EnumPanelTypes.VISUALIZATION);var P=function(g,d,e){var j,Y,c=[],b=[];var f=function(k){if(k.k===d){j=k;return ;}E.forEach(e.extractChildren(k||{})||[],function(l){f(l);if(j){return ;}});};var Z=function(k){if(k&&k.gts){c.push(k);return ;}E.forEach(e.extractChildren(k)||[],function(l){Z(l);});};var h=function(k,l){if(k.k===l){Y=k;return ;}E.forEach(e.extractChildren(k)||[],function(m){h(m,l);if(Y){return ;}});};f(g);var a=j.selKey;h(j,a);Z(Y);E.forEach(c,function(l){if(!l){return ;}var k=((l.gts&&l.gts.row)||[]).concat((l.gts&&l.gts.col)||[]);mstrmojo.vi.models._CheckDataCards.addAttributeNameAndTargetVisForAddUnits(l,k);b=b.concat(k);});return b;};var M=P.call(this,V,O,Q);var S=function(b){var Y={},Z;for(Z in b.units){var c=b.units[Z],a=c.pnk;if(a){var d=Y[a]=Y[a]||[];d[c.chdidx]={key:Z,type:c.t,id:c.srcid||""};}}return Y;},L=function(Z,e,c,f){if(e!==undefined){for(var b=0;b<e.length;b++){var a=e[b];if(a&&a.type&&a.type===c&&!!a.id){f[a.id]=true;}}}for(var Y=0;Y<e.length;Y++){var d=e[Y];if(d!==undefined&&Z[d.key]){L(Z,Z[d.key],c,f);}}return f;},X=S.call(this,Q.getCurrentLayoutDef()),N={};L.call(this,X,X[Q.currlaykey],mstrmojo.EnumRWUnitType.SELECTOR,N);if(!A.isEmpty(N)){M=[];}Q.destroy();return M;}mstrmojo.vi.controllers.RootControllerBase=mstrmojo.declare(mstrmojo.Obj,[mstrmojo.vi._MonitorsLayoutMode],{scriptClass:"mstrmojo.vi.controllers.RootControllerBase",view:null,docCtrl:null,document:null,installedEventListeners:null,init:function J(L){this._super(L);this.installedEventListeners=[];},destroy:function G(L){this.installedEventListeners.forEach(function(M){D.detachEvent(window.document,M.evt,M.fn);});this._super(L);mstrmojo.css.removeClass(window.document.body,"workstation");delete this.document;delete this.view;delete this.docCtrl;},isDarkThemeSelected:function C(){var L=this.docCtrl.model,M=L.thm?L.thm.did:"";return M===H;},isDarkThemeEnabled:function B(){if(this.darkThemeEnabled===undefined){this.darkThemeEnabled=this.isDarkThemeSelected();}return this.darkThemeEnabled;},getAllowItems:I});mstrmojo.vi.controllers.RootControllerBase.ENUM_LAYOUT_STYLE=K;}());(function(){mstrmojo.requiresCls("mstrmojo.vi.ui.BoxPanel","mstrmojo.vi.ui.toolbars._HasToolbar","mstrmojo.vi.ui._IsUnitDependentPanel","mstrmojo.vi.ui.PanelPortlet","mstrmojo.vi.ui.VisualizationEditorPanelPortlet","mstrmojo.vi.ui.VisualizationEditorUnitList","mstrmojo.array","mstrmojo.hash","mstrmojo.css","mstrmojo.vi.ui.DatasetUnitMenuUtils","mstrmojo.ui.CheckList");mstrmojo.requiresDescs(14389,15643);var F=mstrmojo.array,C=mstrmojo.hash,G=mstrmojo.css,E=mstrmojo.dom;mstrmojo.vi.ui.VisualizationEditor=mstrmojo.declare(mstrmojo.vi.ui.BoxPanel,[mstrmojo.vi.ui._IsUnitDependentPanel,mstrmojo.vi.ui.toolbars._HasToolbar],{scriptClass:"mstrmojo.vi.ui.VisualizationEditor",markupString:'<div id="{@id}" class="mstrmojo-VIBoxPanel {@cssClass}" style="{@cssText}"><div class="mstrmojo-VIBoxPanel-control"></div><div class="mstrmojo-VIBoxPanel-content"></div><div class="mstrmojo-VIBoxPanel-mask"></div><div class="mstrmojo-VIBoxPanel-Editor-disabled"><div class="mstrmojo-VIBoxPanel-Editor-disabled-icon"></div><div class="mstrmojo-VIBoxPanel-Editor-disabled-text">'+mstrmojo.desc(15643,"Editor panel is not applicable for current container. It is for visualizations.")+"</div></div></div>",markupSlots:{controlNode:function(){return this.domNode.firstChild;},containerNode:function(){return this.domNode.childNodes[1];},maskNode:function(){return this.domNode.lastChild;},editorNode:function(){return this.domNode.childNodes[3];}},activeZoneId:"",layoutConfig:{h:{controlNode:"25px",containerNode:"100%"},w:{controlNode:"100%",containerNode:"100%"},xt:true},onvisibleChange:function H(K){if(this.viPanelType===mstrmojo.vi.ui.BoxPanel.PANEL_TYPES.DROP_ZONES&&K.value){this.refresh();}},init:function I(K){this._super(K);mstrmojo.css.addWidgetCssClass(this,"mstrmojo-VIVizEditor");},onactiveZoneIdChange:function D(K){var L=K.valueWas;if(L){mstrmojo.all[L].clearSelect();}},onVIUnitSelected:function B(L){var Y=L&&L.getZonesModel(),Q=Y&&Y.getDropZones(),Z=this.contents,X=this.id;G.toggleClass(this.domNode,"empty",!Q);var a=this.parent.tabList,W=a.items,P=mstrmojo.array.find(W,"id",mstrmojo.vi.ui.BoxPanel.PANEL_TYPES.DROP_ZONES);var U=this.editorNode;if(U){if(Y==null){if(P!==-1){a.disableItem(P);}U.style.visibility="visible";}else{if(P!==-1){a.enableItem(P);}U.style.visibility="hidden";}}if(Q){var V=(!!mstrApp.isWSStyling)?"mstrmojo.vi.ui.VisualizationEditorPanelPortlet":"mstrmojo.vi.ui.PanelPortlet";var S=function(d){return{scriptClass:d.scriptClass==="mstrmojo.gmaps.MapLayerZone"?"mstrmojo.vi.ui.PanelPortlet":V,title:d.n,panelId:X,canCollapse:false,enabled:d.enabled,portletSrc:d,children:[d]};},c=function(e){var d={scriptClass:V,title:e.n,getTitleBarCfg:function(){return C.copy({useRichTooltip:true,shouldShowTooltip:function(){return true;},getTooltipContent:function(){return e.title;}},this.constructor.prototype.getTitleBarCfg.call(this));},panelId:X,canCollapse:false,enabled:e.enabled,portletSrc:e,children:[{scriptClass:"mstrmojo.vi.ui.VisualizationEditorUnitList",items:e.items,alias:"unitList",cssClass:e.cssClass,panelId:X,zonesModel:Y,zonesSource:e}]};if(e.siblings){d.children=d.children.concat(e.siblings);}return d;},W=[],R=Y.docModel.datasets,b=function(d){(d||[]).forEach(function(e){if(e.usedInDropZones){e.usedInDropZones=false;}});},M=function(d,f){var e=F.find(d,"did",f.did);if(e>-1){d[e].usedInDropZones=true;return true;}return false;},O=new mstrmojo.ui.menus.ToolbarConfig({supportsScroll:true,alignWithAnchor:true,isHostedWithin:false,maxHeight:E.getMaxScrollHeight()});(Q.zones||[]).forEach(function(d){W=W.concat(d.items);});if(Y.canSwapAxis()){O.addToolbarBtn(mstrmojo.desc(11658,"Swap"),"swap",function(){Y.swapAxis();});}else{O.addDisabledToolbarBtn(mstrmojo.desc(11658,"Swap"),"swap");}if(Y.canDefineSubtotals()){O.addToggleToolbarButton(mstrmojo.desc(6193,"Show Totals"),"totals",function(){Y.showQuickSubtotals();},function(){Y.hideDefinedSubtotals();},null,Y.hasVisibleSubtotals());}else{O.addDisabledToolbarBtn(mstrmojo.desc(6193,"Show Totals"),"totals");}var K=function(j,h){var g=j&&j.boxContent,e=g&&g.isVisMap,f,d=h.docModel;if(!mstrApp.isInVFConfigMode&&g.isInFilterPanel&&g.isInFilterPanel()){if(e){f=d.clearVisAsFilterActionForMapLayer(j,g.getEditingHost(),false);}else{f=d.clearVisAsFilterAction(j,false);}}h.clearAllDropZones(f);};O.addToolbarBtn(mstrmojo.desc(14389,"Remove Data"),"clearall",function(){K(L,Y);});Z.addChildren([{scriptClass:"mstrmojo.vi.ui.toolbars.Toolbar",alias:"toolbar",visible:true,useRichTooltip:true,cssClass:"VizEditorToolbar",getItemMarkup:function N(d){return this.constructor.prototype.getItemMarkup.call(this,d).replace("{@en@n}",'<div class="icn"></div>');},getLayoutOffsets:function(){return{w:6};}}]);Z.toolbar.set("toolbarCfg",O);C.keyarray(R).forEach(function(d){b(R[d].att);b(R[d].mx);(W||[]).forEach(function(e){if(!M(R[d].att,e)){M(R[d].mx,e);}});});(Q.zones||[]).forEach(function(d){if(d.scriptClass){Z.addChildren([S(d)]);}else{Z.addChildren([c(d)]);}});this.activeZoneId="";this.generateToolbar();}this.doLayout();this.updateGeoItemsIcon(L);},updateGeoItemsIcon:function A(M){var L=M&&M.boxContent,K=L&&L.isVisMap;if(K){L.showInfoIcon4GeoItem();}},updateToolbar:function J(K){var M=this.targetUnit,N=M&&M.getZonesModel(),L="editor_panel.htm";if(mstrApp.allowWebDashboardDesign()){this.addRenameTargetMenuItem(K);}if(N&&N.help){L=N.help;}this.addHelpTopicMenuItem(K,mstrmojo.desc(1143,"Help"),L);return this._super(K);}});}());(function(){mstrmojo.requiresCls("mstrmojo.EnumRWUnitType","mstrmojo.Container","mstrmojo.vi._MonitorsAppState","mstrmojo.vi._MonitorsLayoutMode","mstrmojo.models.FormatModel","mstrmojo.vi.ui.rw._SavesChildPositions","mstrmojo.vi.ui._HasBoxLayout","mstrmojo.vi.ui.BoxPanelContainer","mstrmojo.vi.ui.BoxPanel","mstrmojo.vi.ui.VisualizationEditor","mstrmojo.vi.ui.VIBoxPropertyEditor","mstrmojo.vi.ui.BoxLayoutConfig","mstrmojo.vi.ui.rw.DocRootBoxLayoutConfig","mstrmojo.vi.enums.EnumThemeProperties","mstrmojo.DocDataService","mstrmojo.boxmodel","mstrmojo.dom","mstrmojo.array","mstrmojo.func","mstrmojo.hash");mstrmojo.requiresClsP("mstrmojo.vi.models","VIComponentMap","EnumPanelTypes");mstrmojo.requiresClsP("mstrmojo.vi.ui","_HasBoxLayout","BoxPanelContainer","BoxPanel","VisualizationEditor","VIBoxPropertyEditor");var h=mstrmojo,W=h.vi.models,j=h.array,z=h.func,Z=h.boxmodel,Q=h.dom,R=h.hash,q=h.models.FormatModel,v=q.getFormatUpdate,m=q.ENUM_PROPERTY_NAMES,J="layout",U="c",f=W.VIComponentMap.TYPES,M=h.vi.ui.BoxPanel.PANEL_TYPES,AD=M.DROP_ZONES,w=M.PROPS,P=M.FILTERS,K=h.DocDataService.RAPID_EXEC,b=h.EnumRWUnitType,p=W.EnumPanelTypes,I,l=mstrmojo.vi.enums.EnumThemeProperties.SUBTYPE.LAYOUT;var t={};t[AD]={n:mstrmojo.desc(11312,"Editor"),cls:"edt",id:AD};t[w]={n:mstrmojo.desc(1918,"Format"),cls:"prp",id:w};t[P]={n:mstrmojo.desc(6189,"Filter"),cls:"flt",id:P};function AB(AI){if(AI==="filterPanel"){return P;}return AI==="editPanel"?AD:w;}function n(AI){return AI.src.data.tabInfo;}function V(AI){if(AI.t===U){AI.k=mstrmojo.all[AI.id].getIdentifier();}else{j.forEach(AI.children,function(AJ){V(AJ);});}return AI;}function AE(AJ,AI,AK){return AI.getLayoutVIMap(AJ.getCurrentLayoutKey()).getComponent(AK);}function N(AJ,AI){return AE(AJ,AI,f.FILTER_STACK);}function a(AM,AK,AI){var AN=AM.id,AL={model:AK,viPanelType:AN,layoutKey:AK.currlaykey};switch(AN){case AD:return new mstrmojo.vi.ui.VisualizationEditor(AL);case w:if(!mstrApp.allowWebDashboardDesign()){return null;}return new mstrmojo.vi.ui.VIBoxPropertyEditor(AL);default:var AJ=N(AK,AI);if(AJ){AJ.viPanelType=AN;return AJ;}return null;}}function AC(AJ,AK,AL,AM){if(AJ.t===U){var AR=AJ.k;if(!AR){return[];}if(AR===J){AJ.id=AM.id;}else{var AN=[];AR.split("|").forEach(function(AX,AS){var AV=AX.length-1,AU=AX.charAt(AV)==="*";if(AU){AX=AX.substr(0,AV);}var AT=t[AX],AW=a(AT,AK,AL);if(AW){AW.setOpenStatus(true,true,null);AN.push({panelItem:AT,panelEditor:AW,idx:AS,isSelected:AU});}});if(AN.length>0){var AI=new mstrmojo.vi.ui.BoxPanelContainer({model:AK});AJ.id=AI.id;AN.forEach(function(AS){AI.addPanel(AS.panelItem,AS.panelEditor,AS.idx,AS.isSelected);});return[AI];}return[];}}else{var AQ=AJ.children,AO=[],AP=[];j.forEach(AQ,function(AT){var AS=AC(AT,AK,AL,AM);if(AT.k===J||AS.length>0){AP.push(AT);}AO=AO.concat(AS);});if(AQ.length!==AP.length){AJ.children=AP;}return AO;}return[];}function E(){return j.filter(this.children,function(AI){return AI instanceof mstrmojo.vi.ui.BoxPanelContainer;});}function k(AI,AM){var AK=this.boxLayoutConfig;var AJ=(!!mstrApp.isWSStyling)?["174",100]:["185",100];AK.useDefaultBox([{},this.docLayout],AJ);var AL=AK.box.children;AK.setVizGalleryOpen(!!AM);AL[0].k=AI.map(function(AO,AN){return AO+(!AN?"*":"");}).join("|");AL[1].k=J;if(!AL[0].k){AL.shift();}if(mstrApp.isAppStatePresentation()){g(AL);}}function L(AM){var AL=this.model,AK=this.builder,AN=JSON.stringify(AM);if(AM&&AN.match('"k":"(1|2|3)')){AM=null;}AM=AM&&JSON.parse(AN.replace(/vi_edt/g,AD));if(mstrApp.isAppStatePresentation()){g(AM&&AM.children);}var AO=this.boxLayoutConfig=new mstrmojo.vi.ui.rw.DocRootBoxLayoutConfig({hostId:this.id,identifier:"id",box:AM,padding:mstrApp.getThemeProps(l).dlvPadding});if(!AM){var AI=[],AP=AL.getVIPanelKeyFromUnits(mstrmojo.vi.models.EnumPanelTypes.VISUALIZATION),AJ=AL.getUnitDefinitions(AP);AJ=AJ&&AJ[AP];if(!(AJ&&!AJ.dzv)){AI.push(AD);}if(N(AL,AK)){AI.push(P);}if(AI.length>0){AI.push(w);}k.call(this,AI,true);}E.call(this).forEach(function(AQ){this.removeChildren(AQ);AQ.unrender();},this);this.addChildren(AC(AO.box,AL,AK,this.docLayout));}function g(AJ){var AI=-1;if(!AJ){return ;}j.forEach(AJ,function(AL,AK){if(AL.k.indexOf(M.FILTERS)>-1){AI=AK;}});if(AI>-1&&AI!==AJ.length-1){AJ.push(AJ.splice(AI,1)[0]);}}mstrmojo.vi.ui.rw.DocLayoutViewer=mstrmojo.declare(mstrmojo.Container,[mstrmojo.vi.ui._HasBoxLayout,mstrmojo.vi._MonitorsAppState,mstrmojo.vi._MonitorsLayoutMode,mstrmojo.vi.ui.rw._SavesChildPositions],{scriptClass:"mstrmojo.vi.ui.rw.DocLayoutViewer",markupString:'<div id="{@id}" class="mstrmojo-VIDocLayoutViewer {@cssClass}" style="{@cssText}"></div>',markupSlots:{containerNode:function(){return this.domNode;}},markupMethods:{onheightChange:mstrmojo.Widget.heightMarkupMethod,onwidthChange:mstrmojo.Widget.widthMarkupMethod},docLayout:null,editorPanel:null,model:null,builder:null,margin:8,init:function AA(AI){this._super(AI);if(!!mstrApp.isWSStyling){this.margin=mstrApp.getThemeProps(l).dlvMargin;}if(mstrApp.isAppStatePresentation()||mstrApp.isLayoutModePreview()){this.isBoxLayoutDirty=true;}this.model.attachEventListener("updateRootDefn",this.id,function(){if(!this.parent){this.isBoxLayoutDirty=true;}});},updateRootBoxLayout:function O(){L.call(this,this.model.getRootNode().defn.layoutXML);},onAppStateChange:function o(AI){if(this.model.getCurrentLayoutKey()===this.k){I=!!this.getViPanel("filterPanel");this.changePanelsVisibility();}this._super(AI);},shouldSaveSplitterMoves:function F(){return false;},getSplitterHost:function C(){return this.containerNode;},preBuildRendering:function B(){var AL=this.parent;if(AL){var AK=AL[this.slot].style,AJ=this.height,AI=this.width;this.height=parseInt((AJ&&AJ!=="auto")?AJ:AK.height,10)+(mstrApp.getThemeProps(l).dlvLOH_Compensation)-this.margin+"px";this.width=parseInt((AI&&AI!=="auto")?AI:AK.width,10)-this.margin+"px";}this.bs=this.model.bs;return this._super();},onRender:function D(){this._super();this.updateRootBoxLayout();if(!!mstrApp.isWSStyling){this.boxLayoutConfig.padding=mstrApp.getThemeProps(l).dlvPadding;}this.buildBoxLayout();delete this.isBoxLayoutDirty;},destroy:function u(){this._super();this.controller.view.raiseEvent({name:"destroyLayout",key:this.k});},getLayoutOffsets:function H(){return{h:this.margin-mstrApp.getThemeProps(l).dlvLOH_Compensation,w:this.margin};},beginBoxMove:function Y(AK,AI,AL){var AJ=n(AK);this._super(AK,AI,!!(AJ&&!AJ.isSingleTab)||AL);},endBoxMove:function d(AJ,AI){this._super(AJ,AI);if(!n(AJ)){this.getSplitterHost().appendChild(AI.domNode);}},getBoxLayoutSaveAction:function S(AK){var AJ=this.model,AI={};v(m.USE_PAGE_WIDTH_AS_LAYOUT_WIDTH,true,AI);v(m.MARGIN_LEFT,0,AI);v(m.MARGIN_RIGHT,0,AI);var AL=[AJ.getUnitFormatAction(AJ.getRootNode(),1,v(m.LAYOUT_XML,V(AK)))];AJ.defn.layouts.forEach(function(AM){AL.push(AJ.getUnitFormatAction({k:AM.k,defn:AM},1,JSON.parse(JSON.stringify(AI))));});return AL;},getChildPositionActions:function G(){var AT=this._super(),AW=this.builder,AM=this.model,AU=N(AM,AW),AL=AE(AM,AW,f.MAIN_CONTENT),AQ=AE(AM,AW,f.PAGEBY_STACK),AO=AE(AM,AW,f.VIZ_CONTENT),AV=Q.position(AU&&AU.domNode),AN=Q.position(AL.domNode),AY=Q.position(AQ&&AQ.domNode),AK=Q.position(AO.domNode),Ac=5,AX=Math.abs(AV.x-AN.x)>Ac,Aa=AX?"x":"y",AJ=AV[Aa]<AN[Aa],AR=(AU&&AU.getFilters().length>0),Ab=Q.position(mstrApp.rootCtrl.view.domNode).w,AI=2,AP=19;AV.x=AV.y=0;AN.x=AN.y=0;AY.x=AY.y=0;AK.x=AK.y=0;if(AU){AV.w=AV.w||parseInt(AU.width,10);AV.h=AV.h||parseInt(AU.height,10);}if(AJ&&AR){AN[Aa]=AV[Aa==="x"?"w":"h"];}else{if(!AJ){AV[Aa]=AN[Aa==="x"?"w":"h"];}}if(AQ&&AQ.visible){AK.y+=AY.h;var Ad=AQ.unit;if(Ad){var AZ=Ad.ckey;AT.push(AM.getDimensionAndPositionAction({k:AZ,defn:AM.getCurrentLayoutDef().units[AZ]},AY));}}if(AR){if(AX){AN.w=AK.w=Ab-AV.w;}}else{AN.w=AK.w=Ab;}AK.w-=AI;AK.h-=AI;var AS=[undefined,AV,AN,AY,AK];AM.defn.layouts.forEach(function(Ae){AT.push(AM.getUnitFormatAction({k:Ae.k,defn:Ae},1,v(m.PAGE_WIDTH,Z.px2Inches(AM.getZoomProps(),Ab))));Object.keys(p).forEach(function(Ag){var Af=AM.getVIPanelKeyFromUnits(p[Ag],Ae.k);AT.push(AM.getDimensionAndPositionAction({k:Af,defn:Ae.units[Af]},AS[p[Ag]]));});});AM.defn.layouts.forEach(function(Ae){Object.keys(Ae.units).forEach(function(Ak){var Aj=Ae.units,Am=Aj[Ak],Ao=(Am&&Am.t)||b.LAYOUT,Al=Am.layoutXML;if(Am&&(Am._isDeleted||Am.destroyed)){return ;}if(Ao===b.SUBSECTION){var Ai=R.copy(AN);Ai.h+=2;AT.push(AM.getDimensionAction({k:Ak,defn:Am},Ai));}else{if(Ao===b.GRID||Ao===b.GRAPH||Ao===b.GRIDGRAPH){var Af=Am&&Am.vis;if(Af){if(Af.we&&Af.wcn){var An=this.builder.visList.findVisName(Af.wcn);if(An){AT.push(AM.getUnitChangeVizAction(An,Af.wcn,{k:Ak,defn:Am}));}}}}}if(Al!==undefined){var Ag=new mstrmojo.vi.ui.BoxLayoutConfig({box:Al,padding:0,getBoxChildClass:function(Aq){var Ap=mstrmojo.vi.ui.BoxLayoutConfig.prototype.getBoxChildClass(Aq);if(Ap){return Ap;}return AW.getPortletClass(Aj[Aq.k]);}}),Ah=this.calculateBoxLayout(Ag,{height:AK.h-AI-AP,width:AK.w-AI,top:AK.y,left:AK.x}).box;Object.keys(Ah).forEach(function(Aq){var Ap=Ah[Aq].dim;AT.push(AM.getDimensionAndPositionAction({k:Aq,defn:Aj[Aq]},{h:(parseInt(Ap.height,10)-AI)+"px",w:(parseInt(Ap.width,10)-AI)+"px",x:Ap.left,y:Ap.top}));});}},this);},this);return AT;},getViPanel:function AG(AK){var AI=this.docLayout.getViPanel(AK);if(!AI){var AJ=AB(AK);E.call(this).every(function(AL){AI=AL.getPanelByType(AJ);return !AI;});}return AI;},getPanelTypeFromKey:function X(AI){if(AI===P){return"filterPanel";}return AI===AD?"editPanel":"propertiesPanel";},getPanelItems:function AF(){return t;},getSelector:function A(){return this.docLayout.selector;},openViPanel:function x(AQ,AR,AN,AI){var AK=AB(AQ),AM=E.call(this)[0],AO=this.model,AP=this.builder,AJ=this.id,AL=function(){var AV=mstrmojo.all[AJ],AW=AO.getDataService().newUpdateWithoutCmd();if(AM){var AT=t[AK],AS=a(AT,AO,AP);AM.addPanel(AT,AS,NaN,true);if(AS){AS.setOpenStatus(true,false,AW);}}else{k.call(AV,[AK],AV.boxLayoutConfig.isVizGalleryOpen());var AU=AC(AV.boxLayoutConfig.box,AO,AP,AV.docLayout);AV.addChildren(AU);AU.forEach(function(AY){var AX=AY&&AY[AK];if(AX){AX.setOpenStatus(true,false,AW);}});if(!AI){AV.buildBoxLayout();}}if(!AN){AV.saveBoxLayout(undefined,undefined,AR,AW);AW.addExtras(K);AW.submit();}mstrApp.rootCtrl.generateToolbar();};if(AK!==P||N(AO,AP)){AL();}else{AO.loadHiddenFilterStack(AP,function(){AL();});}},changePanelsVisibility:function c(){var AM=this.controller,AI=AM._oldBoxLayout,AL=["propertiesPanel","editPanel"],AK,AN,AJ=function(AO){AO.forEach(function(AQ){var AP=this.getViPanel(AQ);if(AP){AP.setOpenStatus(false,true,undefined,true);}},this);};if(mstrApp.isAppStatePresentation()){AM._oldBoxLayout=R.clone(this.getBoxLayoutConfig().box);AJ.call(this,AL);if(I){AM._oldBoxLayoutWithFilter=R.clone(this.getBoxLayoutConfig().box);}AK=this.getViPanel("filterPanel");AN=AK&&AK.contents;if(AN&&AN.empty){AK.setOpenStatus(false,true,undefined,true);}g(this.getBoxLayoutConfig().box.children);this.model.updateRootDefn({root:{layoutXML:this.getBoxLayoutConfig().box}});}else{if(mstrApp.isAppStatePrintPreview()){AM._oldBoxLayout=R.clone(this.getBoxLayoutConfig().box);AJ.call(this,["propertiesPanel","editPanel","filterPanel"]);this.model.updateRootDefn({root:{layoutXML:this.getBoxLayoutConfig().box}});}else{if(AI){this.model.updateRootDefn({root:{layoutXML:AI}});this.updateRootBoxLayout();delete AM._oldBoxLayout;delete AM._oldBoxLayoutWithFilter;}}}},syncFilterPanelStack:function r(){var AK=this.model,AJ=this.controller,AN=AK.getVIComponent(mstrmojo.vi.models.VIComponentMap.TYPES.FILTER_STACK),AL=this.getViPanel("filterPanel"),AI=AN&&AN.isEmpty(),AM=!!mstrApp.isWSStyling;if(I){if(AI&&!AL){L.call(this,AJ._oldBoxLayoutWithFilter);this.buildBoxLayout();}if(!AI&&AL&&!AM){AL.setOpenStatus(false,true,undefined);}}},getBoxLayoutConfig:function AH(){var AI=this.boxLayoutConfig;if(AI){V(AI.box);}return AI;},saveBoxLayout:function e(AM,AK,AO,AN,AI){var AJ=this.model,AL=this.getBoxLayoutConfig();if(AL){AO=AO||{};z.wrapMethods({success:function(){AJ.updateRootDefn({root:{layoutXML:AL.box}});}},AO);}this._super(AM,AK,AO,AN,undefined,AI);}});mstrmojo.vi.ui.rw.DocLayoutViewer.getViPanelType=function(AI){return AB(AI);};}());(function(){mstrmojo.requiresCls("mstrmojo.DocBuilder","mstrmojo.vi.ui.rw.selectors.DocSelectorViewFactory","mstrmojo.ui.BuilderBox","mstrmojo.ExpressVisList","mstrmojo.hash","mstrmojo.array","mstrmojo.string","mstrmojo.DynamicClassFactory","mstrmojo.EnumRWUnitType","mstrmojo.vi.ui.ScrollableDocTextfield","mstrmojo.DocHTMLContainer","mstrmojo.vi.viz.EnumVizStyles","mstrmojo.vi.ui.rw.DocQuillTextField");mstrmojo.requiresClsP("mstrmojo.vi.models","DocXtabModel","DocVisModel","EnumPanelTypes","XtabDropZones","GMDropZones","MapDropZones","MapboxDropZones","ImageLayoutDropZones","CombineDropZonesModel","PanelFormatSaver","VIComponentMap","GraphDropZones","BaseVisDropZones","HeatMapDropZones","NetworkDropZones","KPICardDropZones");mstrmojo.requiresClsP("mstrmojo.vi.models.editors","TextEditorModel","ImageEditorModel","HtmlContainerEditorModel","HeatMapEditorModel","ImageLayoutEditorModel","NetworkEditorModel","BaseEditorModel","XtabEditorModel","MapEditorModel","MapboxEditorModel","GMEditorModel","KPICardEditorModel");mstrmojo.requiresClsP("mstrmojo.vi.ui.rw","DocLayoutViewer","DocLayout","DocSection","DocSubsection","Xtab","CustomSortXtab","ImageBox","FilterPanelStack","FilterPanel","FilterPortlet","DocVIPanelStack","DocVIMainPanel","DocVIVisualizationsPanelStack","DocRelativePanel","VizBox","DocTextfield","DocQuillTextField","DocImage","TextBox","FilterBox","ImageBox","HtmlBox","_IsViewDataGrid");var R=mstrmojo.hash,h=mstrmojo.array,Y=mstrmojo.DynamicClassFactory.newComponent,m=mstrmojo.vi.models.editors,H=mstrmojo.vi.models.VIComponentMap.TYPES,k=mstrmojo.vi.models.EnumPanelTypes,c=k.FILTERS,l=k.PAGEBY,J={},C=mstrmojo.vi.viz.EnumVizStyles,d=mstrmojo.elementHelper,V=mstrmojo.EnumRWUnitType,Q=mstrmojo.DocSelector.STYLES,Z=mstrmojo.string.escapeIllegalXML;J[V.IMAGE]="mstrmojo.vi.ui.rw.ImageBox";J[V.TEXTFIELD]="mstrmojo.vi.ui.rw.TextBox";J[V.HTMLCONTAINER]="mstrmojo.vi.ui.rw.HtmlBox";J[V.SELECTOR]="mstrmojo.vi.ui.rw.FilterBox";var D="containerNode";var X=function B(){this.parent.set("unit",this.unit);};function j(v){var u=v.defn.psType;if(!u){return 0;}return parseInt(u,10);}function n(v,AD){var AA=v.defn,AE=v.data.elms,z=v.data.ces||[],AF=v.data.unset,x=AD.isSelectionExcluded&&AD.isSelectionExcluded(),u=AD.isDynamicAttributeSelector&&AD.isDynamicAttributeSelector(),AB="";if(!AA.sec||u){return"";}if(AA.style===Q.SEARCH_BOX){if(!AA.sos&&(h.find(z,"v",d.ELEM_ALL_ID)>-1||z.length===0||AF)){return"";}AB=d.buildElemsCountStr(z,[]);}else{if(AA.style!==Q.SCROLLER){if(AA.multi){if(AF&&(!z||z.length===0)){AB=d.buildElemsCountStr(AE,AE);}else{var AG={};h.forEach(AE,function(w){AG[Z(w.v)]=true;});var AC=h.filter(z,function(w){return AG[Z(w.v)];});AB=d.buildElemsCountStr(AC,AE,x);}}else{AB=d.buildElemsCountStr(AE,AE);}}}return AB;}function I(w,x,v,u){var AA=R.walk(v.scriptClass,window),AB=new u({docModel:w}),z=new AA({id:x.id,node:x,controller:this.parent.controller,model:w,edtModel:AB});z.addDisposable(AB);z.edtModel.hostId=z.id;return z;}mstrmojo.vi.ui.DocBuilder=mstrmojo.declare(mstrmojo.DocBuilder,null,{scriptClass:"mstrmojo.vi.ui.DocBuilder",viMap:null,defaultSlot:D,visList:mstrmojo.ExpressVisList,init:function q(u){if(this._super){this._super(u);}this.viMap={};},createSelectorFactory:function g(){return new mstrmojo.vi.ui.rw.selectors.DocSelectorViewFactory({docBuilder:this});},createClassMap:function e(){var u=this._super();u[V.LAYOUT]={n:"Layout"};u[V.SUBSECTION]={n:"DocSubsection"};u[V.PANELSTACK]={n:"PanelStack"};u[V.PANEL]={n:"Panel"};u[V.IMAGE]={n:"Image",scriptClass:"mstrmojo.vi.ui.rw.DocImage"};u[V.TEXTFIELD]={n:"Textfield",scriptClass:"mstrmojo.vi.ui.rw.DocQuillTextField"};return u;},isPortlet:function t(v){var u=v.t;return !!((v.httl||this._super(v))||u===V.TEXTFIELD||u===V.IMAGE||u===V.SELECTOR||u===V.HTMLCONTAINER);},extractWidget:function M(v,u){return this._super(v,u)||j(u)===l;},getPortletClass:function N(u){return(u&&J[u.t])||"mstrmojo.vi.ui.rw.VizBox";},createPortlet:function f(AG,v,AE,AF){var x=j(v);if(x){if(x===c){return null;}return AE;}var AA=v.defn,z=this.getLayoutVIMap(AA._lkz);if(AA.iifp){AE.alias="selector";return new mstrmojo.vi.ui.rw.FilterPortlet({title:AA.ttl||"",children:[AE],panelId:z.getComponent(H.FILTER_STACK).id,k:AE.k,isCollapsed:parseInt(AA.ds,10)===1,count:n(v,AE),srcId:AE.defn.srcid,height:AA.fmts.height});}var AD=AF&&AF.pk;if(AD){if(z.getComponentKey(H.PAGEBY_PANEL)===AD){return AE;}if(z.isRelativePanel(AD)){var AC=AA.fmts,u=AC.left,AB=AC.top,AH=R.walk(this.getPortletClass(AA),window);AC.left=0;AC.top=0;AE.slot="containerNode";AE.alias="boxContent";return new AH({title:AA.ttl||"",children:[AE],k:AE.k,defn:AA,model:this.model,height:AC.height,width:AC.width,top:AB,left:u,nk:AA.fgk||AF.fgk});}}},newLayout:function G(w,AB){var v=AB.data,u=AB.defn,z,x,AC={alias:"layoutViewer",n:u.title||mstrmojo.desc(3437,"Layout")+" 1",numDupl:u.numDupl||0,model:w,node:AB,controller:this.parent.controller,tbc:u.tbc,slot:D,ifs:v.ifs,gb:v.gbys};z=new mstrmojo.vi.ui.rw.DocLayoutViewer(AC);x=z.defn=R.copy(u);x.fmts=R.copy(u.fmts);this.viMap[AB.k]=this.addDisposable(new mstrmojo.vi.models.VIComponentMap());var AA=new mstrmojo.vi.ui.rw.DocLayout({cssClass:"mstrmojo-VILayout",slot:"containerNode",id:AB.id,k:AB.k,rules:u.rules,builder:this,node:AB,defn:u,model:w});z.addChildren([AA]);return z;},removeVIMapRef:function L(u){var v=this.viMap[u];h.removeItem(this.disposables,v);v.destroy();delete this.viMap[u];},newSection:function b(u,v){return this.newRWUnitInstance(u,v,mstrmojo.vi.ui.rw.DocSection,{slot:D});},newDocSubsection:function E(u,v){return this.newRWUnitInstance(u,v,mstrmojo.vi.ui.rw.DocSubsection,{slot:D});},newTextfield:function r(x,z,w){var v=z&&z.data,AA=v&&v.v,AB=!!(AA&&AA.indexOf("\u00df")>=0),AC=!!(mstrApp.isQuillFlag),u=AC?(AB||!AA):AB;w.scriptClass=u&&AC?"mstrmojo.vi.ui.rw.DocQuillTextField":"mstrmojo.vi.ui.rw.DocTextfield";return I.call(this,x,z,w,m.TextEditorModel);},newImage:function F(v,w,u){return I.call(this,v,w,u,m.ImageEditorModel);},newHTMLContainer:function W(w,x,v){var u=this.newRWUnitInstance(w,x,(x.defn.ht===1)?mstrmojo.vi.ui.ScrollableDocTextfield:mstrmojo.DocHTMLContainer,{formatHandlers:{domNode:["D"]}});u.edtModel=new m.HtmlContainerEditorModel({hostId:u.id,docModel:w});return u;},newPanelStack:function O(u,x){var w=x.defn,AA=0,v={id:x.id,node:x,k:x.k,controller:this.parent.controller,model:u,builder:this},z;switch(j(x)){case c:AA=H.FILTER_STACK;z=mstrmojo.vi.ui.rw.FilterPanelStack;v.cssClass="mstrmojo-VIFilterStack";v.title=u.getCurrentLayoutDef().title;break;case k.VIS_CONTENT:AA=H.MAIN_CONTENT;z=mstrmojo.vi.ui.rw.DocVIPanelStack;v.cssClass="mstrmojo-VIMainVizPanel";v.slot=D;break;case l:if(w.empty===true){return ;}AA=H.PAGEBY_STACK;z=mstrmojo.ui.BuilderBox;v.height="45px";v.slot=D;v.onunitChange=X;break;case k.VISUALIZATION:AA=H.VIZ_CONTENT;z=mstrmojo.vi.ui.rw.DocVIVisualizationsPanelStack;v.slot=D;v.title=w.n;break;}if(z){return this.getLayoutVIMap(w._lkz).createComponent(AA,z,v);}},newPanel:function S(z,x,w,AE){var AD=x.k,AF=mstrmojo.DocPanel,AA=this.getLayoutVIMap(x.defn._lkz),AC=AE.pk,AB={id:x.id,node:x,numDupl:0,model:z,builder:this,controller:z.controller},v=0;if(AA.isComponent(H.FILTER_STACK,AC)){AF=mstrmojo.vi.ui.rw.FilterPanel;AB.alias="contents";AB.cssClass="mstrmojo-VIFilterPanel";AB.slot=D;v=H.FILTER_PANEL;}else{if(AA.isComponent(H.VIZ_CONTENT,AC)){AF=mstrmojo.vi.ui.rw.DocRelativePanel;AB.slot=D;AA.addRelativePanel(AD);}else{if(AA.isComponent(H.MAIN_CONTENT,AC)){AF=mstrmojo.vi.ui.rw.DocVIMainPanel;AB.slot=D;}else{if(AA.isComponent(H.PAGEBY_STACK,AC)){AF=mstrmojo.ui.BuilderBox;AB.slot=D;AB.onunitChange=X;AB.preBuildRendering=function(){this.set("unit",null);return mstrmojo.ui.BuilderBox.prototype.preBuildRendering.call(this);};v=H.PAGEBY_PANEL;}}}}var u;if(v){u=AA.createComponent(v,AF,AB);}else{u=new AF(AB);}return u;},getDefaultXtab:function U(u){if(u&&!!u.isViewDataGrid){if(!mstrmojo.VDXtab){mstrmojo.VDXtab=Y(mstrmojo.vi.ui.rw.Xtab,[mstrmojo.vi.ui.rw._IsViewDataGrid],{scriptClass:"mstrmojo.VDXtab"});}return mstrmojo.VDXtab;}return mstrmojo.vi.ui.rw.Xtab;},getCustomSortXtab:function A(){return mstrmojo.vi.ui.rw.CustomSortXtab;},newXtab:function p(v,w,u,z){var x=this._super(v,w,u,z);x.zonesModel=x.addDisposable(new mstrmojo.vi.models.XtabDropZones({hostId:x.id,docModel:v}));x.set("edtModel",new mstrmojo.vi.models.editors.XtabEditorModel({hostId:x.id,docModel:v}));return x;},getDefaultMojoVisModel:function a(){return mstrmojo.vi.models.DocVisModel;},newXtabModel:function P(u){return new mstrmojo.vi.models.DocXtabModel(u);},newMojoVisualization:function K(z,v){var AG=this._super(z,v),AD=v.data.visName,u,AB,x;if(!!AG){u={hostId:AG.id,docModel:z};}if(AG instanceof mstrmojo.Xtab){return AG;}if(AD===C.GRAPH_MATRIX||AD===C.NEW_GRAPH_MATRIX){AG.zonesModel=AG.addDisposable(new mstrmojo.vi.models.CombineDropZonesModel({hostId:AG.id,docModel:z,gmZones:AG.addDisposable(new mstrmojo.vi.models.GMDropZones(u))}));AG.edtModel=AG.addDisposable(new mstrmojo.vi.models.editors.GMEditorModel({hostId:AG.id,docModel:z}));}else{if(AD===C.GOOGLE_MAP||AD===C.ESRI_MAP){AB="MapDropZones";x="MapEditorModel";}else{if(AD===C.MAPBOX){AB="MapboxDropZones";x="MapboxEditorModel";}else{if(AD===C.IMAGE_LAYOUT){AB="ImageLayoutDropZones";x="ImageLayoutEditorModel";}else{if(AD===C.HEAT_MAP){AB="HeatMapDropZones";x="HeatMapEditorModel";}else{if(AD===C.NETWORK){AB="NetworkDropZones";x="NetworkEditorModel";}else{if(AD===C.KPICARD){AB="KPICardDropZones";x="KPICardEditorModel";}else{if(mstrConfig.pluginsVisList[AD]){var AF=mstrConfig.pluginsVisList[AD],w=AF.dz,AC=AF.em;if(w){mstrmojo.requiresCls("mstrmojo."+w);var AE=R.walk(w,mstrmojo);AG.zonesModel=AG.addDisposable(new AE({hostId:AG.id,docModel:z,visModel:AG.model}));}else{AG.zonesModel=AG.addDisposable(new mstrmojo.vi.models.BaseVisDropZones({hostId:AG.id,docModel:z,visModel:AG.model}));}if(AC){mstrmojo.requiresCls("mstrmojo."+AC);var AA=R.walk(AC,mstrmojo);AG.edtModel=AG.addDisposable(new AA(u));}else{x="BaseEditorModel";}}}}}}}}}if(AB){AG.zonesModel=AG.addDisposable(new mstrmojo.vi.models[AB](u));}if(x){AG.edtModel=AG.addDisposable(new m[x](u));}if(AG){AG.updateFormatsOnUpdate=false;}return AG;},getLayoutVIMap:function o(u){return this.viMap[u];}});}());(function(){mstrmojo.requiresCls("mstrmojo.Container","mstrmojo._HasLayout","mstrmojo._HasBuilder","mstrmojo._IsRwDocument","mstrmojo.express.ui._IsDocumentView","mstrmojo.vi._MonitorsAppState","mstrmojo.vi.models.VIComponentMap.TYPES","mstrmojo.vi.controllers.EnumLayoutSelectorPosition","mstrmojo.vi.ui.DocBuilder","mstrmojo.vi.ui.VisualizationEditor","mstrmojo.array","mstrmojo.func","mstrmojo.hash","mstrmojo.css","mstrmojo.vi.ui.rw.xtab.XtabMenuConfig","mstrmojo.vi.ui.tabs.LayoutTabHelper","mstrmojo.vi.controllers.EnumEvents");var W=mstrmojo.array,h=mstrmojo.func,M=mstrmojo.hash,C=mstrmojo.DocDataService,D=mstrmojo.vi.controllers.EnumEvents,I=mstrmojo.vi.controllers.EnumLayoutSelectorPosition,g=mstrmojo.vi.ui.tabs.LayoutTabHelper;function U(x,u){var t=mstrmojo.desc(11450,"## copy ###"),q=W.find(x,"k",u),w=x[q],r=w.numDupl===0?t.replace("###","").replace("##",w.n):t.replace("###",w.numDupl).replace("##",w.n),v={};(x||[]).forEach(function(z){v[z.n]=true;});while(v[r]){w.numDupl++;r=t.replace("###",w.numDupl).replace("##",w.n);}return r;}function P(q){return{success:function(){var r=q.replaceKeyBoxes,t=q.cmdMgr().getInterimCmd(),u=q.getDataService().newUpdate(t,{extras:mstrmojo.DocDataService.SUPPRESS_DATA});if(r&&r.length>0){W.forEach(r,function(v){v.addSaveBoxLayoutActions(u,true);});}q.clearMapLayout();q.raiseEvent({name:D.UPDATE_TOC});t.submitUpdate(u,q.cmdMgr().CMD_PHASE.LAST);}};}mstrmojo.vi.ui.DocumentView=mstrmojo.declare(mstrmojo.Container,[mstrmojo._HasLayout,mstrmojo._HasBuilder,mstrmojo._IsRwDocument,mstrmojo.express.ui._IsDocumentView,mstrmojo.vi._MonitorsAppState],{scriptClass:"mstrmojo.vi.ui.DocumentView",markupString:'<div id="{@id}" class="mstrmojo-VIDocument {@cssClass}" style="{@cssText}" ><div class="mstrmojo-VIDocument-doc"></div></div>',markupSlots:{containerNode:function(){return this.domNode.firstChild;}},layoutConfig:{h:{containerNode:"100%"},w:{containerNode:"100%"},xt:true},hasDataSource:false,selector:null,layoutViewer:null,model:null,builder:null,renderedLayoutsQueue:[],LAYOUTS_CACHE_SIZE:10,init:function j(r){this._super(r);var q=this.model;this.addDisposable(this.builder=new mstrmojo.vi.ui.DocBuilder({parent:this,model:q}));},buildChildren:function R(){var r=this.editor,q=r?[r]:[];this._layouts=this._super(true);this.addChildren(q);},onRender:function B(){var q=this.getSelectedLayoutWidget();this.addChildren([q]);},pushToRenderedQueue:function J(u,v){var q=this.renderedLayoutsQueue||[];if(q.indexOf(u.k)===-1){q.push(u.k);if(q.length>this.LAYOUTS_CACHE_SIZE){var t=q.shift(),w=this._layouts,r=w[W.find(w,"k",t)]||{};if(r.hasRendered&&t!==v.k){r.unrender();}}}},setDimensions:function b(r,q){this._super(r,q);this.forceLayout=false;},showPanel:function n(v,r,u){var t=this.builder.getLayoutVIMap(r),q=t&&t.getComponent(mstrmojo.vi.models.VIComponentMap.TYPES.VIZ_CONTENT);if(q){q.selectPanel(v,null,null,u);}},showLayout:function K(u,z,x,w){var v=u.k,r=this.getSelectedLayoutWidget(),t=typeof z==="function",q={success:function(AB){AB.getSelector().setTabs(this._layouts,AB.k);this.reDisplayLayout(r,AB,t?z:mstrmojo.emptyFn);var AA=mstrApp.isLayoutModePreview();if(AA||AB.isPreview){this.controller.rootCtrl.adjustLayoutSectionWidth(AA,false);}AB.raiseEvent({name:"generateVizBoxToolbar"});}.bind(this)};if(!t){q=h.wrapMethods(q,z);}if(v!==r.k){this.getNewLayout({layoutKey:v,panelKey:w},this._layouts,true,q,x);return true;}return false;},reDisplayLayout:function F(w,AA,AE){var t=AA.getSelector(),v=this.model,r=v.getSelectedViUnit(),u=r&&r.k,x=AA.k,AD=this._layouts,AG=mstrApp.rootCtrl,AB=AG.view;t.setStatic(true);g.saveTabBarPosition(w.getSelector());var z=(this.children||[]).filter(function(AH){return AH.k===x;})[0];if(z){AA=this.rebuildChild(z);}else{this.removeChildren(w);this.pushToRenderedQueue(w,AA);v.resetSelectedViUnitId();this.addChildren([AA]);if(AA.isBoxLayoutDirty){AA.updateRootBoxLayout();AA.buildBoxLayout();delete AA.isBoxLayoutDirty;}}var AC=W.find(AD,"k",x);AD[AC]=AA;(z||AA).raiseEvent({name:"layoutRedisplay"});this.updateXtabStyles(x);var AF=v.getVizContentPanel(),q=u&&AF.getUnitByKey(u);if(q){AF.selectVIUnit(q,true);}else{AF.selectFirstBox();}AA.docLayout.toggleSelectorVisibility(v.tsp===I.LEFT||!AB.isCPVisible);g.applyTabBarPosition(t);t.setSelectedTab(x);t.setStatic(false,true);AG=this.controller.rootCtrl;AG.generateToolbar();if(AE){AE();}if(mstrApp.isAppStatePresentation()){this.layoutViewer.syncFilterPanelStack();}this.doLayout();},replaceLayout:function E(u,r,t){var v=this._layouts||[],q=W.find(v,"k",u&&u.k);if(q>=0){u.unrender();u.destroy();this.model.getDocBuilder().removeVIMapRef(u.k);}var w=this.builder.build([r],this.model)[0];if(q>=0){v[q]=w;}else{W.insert(v,t,[w]);}this._layouts=v;return w;},destroy:function d(q){(this._layouts||[]).forEach(function(r){r.destroy(q);});this.builder.destroy();this._super(q);},getLayoutByKey:function e(q){return W.filterOne(this.getLayouts(),function(r){return r.k===q;});},getLayouts:function(){return this._layouts;},updateLayouts:function(r){var z=this.getLayouts(),t=[],q=this.model.getChildren(r,false),v=this.getSelectedLayoutWidget(),u,AB,AA;for(u=0;u<q.length;u++){AB=q[u].k;AA=W.find(z,"k",AB);if(AA<0){this.replaceLayout(null,q[u]);}else{if(q[u].data.loaded&&this.model.currlaykey!==r.currlaykey){this.replaceLayout(z[AA],q[u]);}}}for(u=0;u<z.length;u++){AA=W.find(q,"k",z[u].k);if(AA<0){var w=z.splice(u,1)[0];w.unrender();w.destroy();u--;}}for(u=0;u<q.length;u++){AB=q[u].k;AA=W.find(z,"k",AB);if(AA>=0){t.push(z[AA]);}}this._layouts=t;this.model.currlaykey=r.currlaykey;var x=this.getLayoutByKey(r.currlaykey);x.getSelector().setTabs(this._layouts,r.currlaykey);this.reDisplayLayout(v,x);},moveLayout:function S(q,AC){var z=this,w=this.model,AB=this._layouts,t=this.layoutViewer.getSelector(),AD=this.getSelectedLayoutWidget(),r=AD.k,AE=AB[q],v=AE.k,x=t.selectMovedTab&&r!==v,u=function(AF,AG){w.moveLayout(AF,AG);AB.splice(AG,0,AB.splice(AF,1)[0]);w.raiseEvent({name:D.UPDATE_TOC});};w.execute({execute:function AA(){var AH=this.urInfo,AG=function(){AH.extras=M.copy({style:{params:{treesToRender:C.EnumTreesToRender.BOTH}}},AH.extras);}.bind(this);AH=M.copy({silent:t.selectMovedTab?false:true,undo:function(){AG();u(AC,q);z.layoutViewer.getSelector().moveTab(AC,q,AC,true);return !x;},redo:function(){AG();u(q,AC);z.layoutViewer.getSelector().moveTab(q,AC,q,true);return !x;}},AH);var AF=w.getMoveLayoutAction(q,AC);if(!x){u(q,AC);this.submitSilent(AF);}else{var AJ=w.getDataService().newUpdate(),AI=z.needLoadLayout(AE);AJ.addExtras(AI?C.REQUEST_DEFN_DATA:C.REQUEST_ONLY_DEFINITION);u(q,AC);AJ.actions.push(AF);z.showLayout(AE,null,AJ);if(AI){this.submitUpdate(AJ);}}}});},deleteLayout:function f(AA,u){var z=this._layouts,q=W.find(z,"k",AA),AB=q+1,t,r=this.id,x=true,v=function(AE){var AH=mstrmojo.all[r],AG=z.splice(q,1)[0],AD=x?AH.model.getChildren(AE,false):z,AC=AE.currlaykey,AF=W.find(AD,"k",AC),AI;AH.model.currlaykey=AC;if(x){AH.model.replaceLayout(AC,AE,false);AI=AH.replaceLayout(z[AF],AD[AF],AF);}else{AI=AD[AF];}AH.layoutViewer.getSelector().deleteTab(q);AI.getSelector().setTabs(AH.getLayouts(),AC);AH.reDisplayLayout(AG,AI);AG.unrender();AG.destroy();AH.model.getDocBuilder().removeVIMapRef(AA);AH.model.raiseEvent({name:D.UPDATE_TOC});},w=function(AC){return !M.isEmpty(AC.defn&&AC.defn.cgbMap);};this.model.removeLayout(AA,{success:v},u);t=z[AB];if(!t){AB=q-1;t=z[AB];}this.model.getDataService().setCurrentDocLayout(t.k,null,u);x=this.needLoadLayout(t)||w(z[q])||w(t);u.setTreesToRender(x?3:1);},duplicateLayout:function N(v,q){var t=this.getLayouts(),r=W.find(t,"k",q)+1,u=this.model.getNextKey();this.model.duplicateLayout(v,{srcKey:q,destKey:u,name:U(t,q),index:r+1},h.wrapMethods(this.getRedisplayLayoutCallback(r,u,this.getSelectedLayoutWidget(),v),P(this.model)));},addNewLayout:function H(v,r,u){var t=(u&&u.nodeKey)||this.model.getNextKey(),q=this.getLayouts().length;r=(0<=r&&r<q)?r:q;this.model.addNewLayout(v,M.copy(u,{nodeKey:t,index:r+1}),h.wrapMethods(this.getRedisplayLayoutCallback(r,t,this.getSelectedLayoutWidget()),P(this.model)));},importDashboard:function Z(v,q,u){var t=this.model,r=this.controller.rootCtrl;q=this.getLayouts().length;this.model.addExistingLayouts(v,M.copy(u,{index:q+1}),{success:function(){r.displayLightTheme();t.raiseEvent({name:D.UPDATE_TOC});}});},getSelectedLayoutWidget:function L(){return(this._layouts||[]).filter(function(q){return(q.k===this.model.getCurrentLayoutKey());},this)[0];},showSelectedLayout:function Y(){var q=this.getSelectedLayoutWidget();if(this.containerNode.children.length>0){return ;}if(this.model.clearDisposables){this.model.clearDisposables();}(this.children||[]).filter(function(r){return r.k===q.k;}).forEach(function(r){this.removeChildren(r);r.destroy();},this);this.addChildren([q]);},getViPanel:function p(q){return this.getSelectedLayoutWidget().getViPanel(q);},selectViPanel:function m(r){var q=this.getViPanel(r);if(q){q.parent.selectPanel(q);}else{this.openViPanel(r);}},getPanelItems:function o(){return this.getSelectedLayoutWidget().getPanelItems();},getPanelTypeFromKey:function Q(q){return this.getSelectedLayoutWidget().getPanelTypeFromKey(q);},openViPanel:function k(r,t,q){this.getSelectedLayoutWidget().openViPanel(r,t,q);},onAppStateChange:function a(t){var u=mstrApp.rootCtrl,r=u.view.isCPVisible;this.layoutViewer.getSelector().set("visible",(!mstrApp.isAppStatePrintPreview())&&(!mstrApp.isAppStatePresentation()||this._layouts.length>1)&&r);this.forceLayout=false;var q=mstrmojo.vi.VisualInsightApp.APP_STATES.PRESENTATION;if(t.value&q||t.valueWas&q){this.forceLayout=true;}},onLayoutSelected:function c(u){var q=this.model,t=q.controller.cmdMgr,r=t.getInterimCmd();if(r){r.submitUpdate(u,t.CMD_PHASE.LAST);}else{q.execute({execute:function(){this.submitUpdate(u,t.CMD_PHASE.LAST);},urInfo:{treesToRender:3}});}},loadDocLayout:function X(q,u,t){var r=!t;t=t||this.model.getDataService().newUpdate();this._super(q,u,t);if(r){this.onLayoutSelected(t);}},setCurrentDocLayout:function V(q,t,r){r=r||this.model.getDataService().newUpdate(this);this._super(q,t,r);r.setTreesToRender(1);this.onLayoutSelected(r);},changeCurrLytTabTtl:function O(t,q){var r=this.layoutViewer.getSelector().getSelectedTab();if(r){r.set("title",t);r.titleEdited(t,q);}},getXtabCellMenuConfig:function(q){return new mstrmojo.vi.ui.rw.xtab.XtabMenuConfig(q);},layoutSelected:function G(q){this.layoutViewer.getSelector().layoutSelected(q);},selectPage:function l(r){var t=this.getLayout(),v=t&&t.docLayout,u=v&&v.docSection,w=u&&u.docSubSection,q=w&&w.children[0]&&w.children[0].children[1]&&w.children[0].children[1].children[0]&&w.children[0].children[1].children[0].selector;q.selectPage(r);},getRedisplayLayoutCallback:function A(r,t,u){var q=this.model;return{success:function(v){var w=this.replaceLayout(null,q.getChildren(v,false,r,1)[0],r);q.currlaykey=v.currlaykey;w.isPreview=mstrApp.isLayoutModePreview();this.reDisplayLayout(u,w);}.bind(this),failure:function(v){mstrApp.onerror(v);}};}});mstrmojo._HasMarkup.addMarkupMethods(mstrmojo.vi.ui.DocumentView,{onhasDataSourceChange:function(){mstrmojo.css.toggleClass(this.domNode,"noDataSource",!this.hasDataSource);}});}());(function(){mstrmojo.requiresCls("mstrmojo.rw.DocController","mstrmojo.vi.ui.DocumentView","mstrmojo.vi.models.DocModel","mstrmojo.vi.controllers.EnumEvents","mstrmojo.hash","mstrmojo.func","mstrmojo.UUID","mstrmojo.vi.controllers.UICmdMgr","mstrmojo.Label","mstrmojo.TextBox","mstrmojo.Button","mstrmojo.expr","mstrmojo.dom","mstrmojo.DocDataService","mstrmojo.vi.enums.EnumFeatures","mstrmojo.string");mstrmojo.requiresClsP("mstrmojo.vi.factories","VisualizationTransitionFactory");mstrmojo.requiresDescs(221,1388,5414,5415,5421,5422,11812,13157,14719);var z=mstrmojo.vi,w=mstrmojo.func,R=mstrmojo.hash,g=mstrmojo.array,k=mstrmojo.UUID,O=mstrmojo.desc,j=mstrmojo.Button.newWebButton,M=mstrmojo.expr,q=mstrmojo.DocDataService,Q=mstrmojo.dom,F=mstrmojo.vi.controllers.EnumEvents,U=z.models,K=mstrmojo.vi.enums.EnumFeatures;var b=3,l=4,X=1000;var r=12,d=3076;var I=1,n=2;var x={config:{waitBoxCfg:{message:mstrmojo.desc(10492,"Saving..."),cssClass:"saving-in-progress"}}};function C(E){return !!Object.keys(E.datasets||{}).length;}mstrmojo.vi.controllers.DocumentControllerBase=mstrmojo.declare(mstrmojo.rw.DocController,[],{scriptClass:"mstrmojo.vi.controllers.DocumentControllerBase",model:null,rootCtrl:null,view:null,visTransitionFactory:null,cmdMgr:null,start:function c(AB){var AD=new mstrmojo.vi.models.DocModel(AB),AC=this.rootCtrl;AD.lastSavedStid=AD.stid||0;AD.controller=this;AD.copyable=(AB.defn||{})["copyable"]!=="false";var AE=this.cmdMgr=new mstrmojo.vi.controllers.UICmdMgr({controller:this,model:AD});AE.dataService=AD.getDataService();var E=this.visTransitionFactory=new z.factories.VisualizationTransitionFactory();var AF=parseInt(mstrApp.viLayoutsCacheSize);var AA=this.view=new z.ui.DocumentView({controller:this,model:AD,hasDataSource:C(AD),LAYOUTS_CACHE_SIZE:AF>=0?AF:10});this.set("model",AD);AD.attachEventListener("layoutSelected",AA.id,"layoutSelected");AD.attachEventListener("selectPage",AA.id,"selectPage");this.addDisposable([AE,E,AD,AA]);},build:function o(){this.view.buildChildren();},submitTemplateUpdates:function H(E,AD,AE,AC,AA,AB){if(AB){this.submitUndoRedoTemplateUpdates(E,AD,AE,AC,AA);}else{this.model.getDataService().submitTemplateUpdates(E.k,AD,w.wrapMethods(this._getXtabCallback(E),AE),AC);}},submitUndoRedoTemplateUpdates:function e(E,AC,AD,AB,AA){this.submitUndoRedoTemplateWithCallback(E,this.dataService().getUpdateTemplateAction(E.k,AC),AD,AB,AA);},submitUndoRedoTemplateWithCallback:function B(E,AC,AD,AB,AA){this.submitUndoRedoUpdates(AC,{},w.wrapMethods(this._getXtabCallback(E),AD),AB,AA);},submitUndoRedoUpdates:function u(AC,AA,AD,AB,E){this.cmdMgr.execute({execute:function(){this.submit(AC,AD,AB);},urInfo:R.copy(E,{callback:AD})});},exportVisualization:function D(E,AD){var AB=10000000;var AC=E.node.data.rw,AA=function(){switch(AD){case b:this.printPDF(E.k);break;case l:this.exportExcel(E.k);break;}}.bind(this);if(AC&&(AC.col.tc*AC.row.tc>AB)){mstrmojo.warn(mstrmojo.desc(15506,"Exporting the dossier may take a few minutes. Do you want to export anyway?"),undefined,{buttons:[j(mstrmojo.desc(246,"Export"),AA),j(mstrmojo.desc(221,"Cancel"),undefined,true)]});}else{AA();}},getReloadLayoutViewCallback:function f(AA){var E=this.view;return w.wrapMethods({success:function(){E.showSelectedLayout();}},AA);},getRefreshCallback:function Y(){var E=this.model;return w.wrapMethods(E.getDatasetsUpdateCallback(),E.getReloadLayoutModelCallback(),this.getReloadLayoutViewCallback(),this.getUpdateTOCPanlelCallback());},getUpdateLayoutViewCallback:function h(AA){var E=this.view;return w.wrapMethods({success:function(AB){E.updateLayouts(AB);}},AA);},getUpdateTOCPanlelCallback:function J(AA){var E=this.model;return w.wrapMethods({success:function(){E.raiseEvent({name:F.UPDATE_TOC});}},AA);},getUpdateLayoutsCallback:function S(){var E=this.model;return w.wrapMethods(E.getDatasetsUpdateCallback(),this.getUpdateLayoutViewCallback());},getPartialUpdateCallback:function G(AD){var E={},AB=this,AA=AB.model,AC=AA.getSelectedViUnit().getZonesModel();return w.wrapMethods({success:function(AF){var AE=AF.pukeys&&AF.pukeys.split("\u001E");if(AE&&AE.length>0){E=AA.getUnitDefinitions(AE);}AA.partialUpdate(AF.data,E,AF.defn,AE);}},AA.getUpdateHiddenLayoutsCallback(),AD||(AC&&AC.getUpdateCallback()));},_getXtabCallback:function W(AA,AB,E){return w.wrapMethods(this._super(AA,E),AB||(AA.parent.getZonesModel&&AA.parent.getZonesModel().getUpdateCallback()));},undo:function a(){this.cmdMgr.undo();},redo:function P(){this.cmdMgr.redo();},onCmdMgrChanged:function p(){mstrApp.rootCtrl.generateToolbar();},isDocChanged:function V(){var E=this.model,AA=E.getDataService().stid||0,AB=E.lastSavedStid||0;return AA>AB||!!E.dty;},dataService:function v(){return this.model.getDataService();},onKeepOnlyOrExcludeNodeAdded:function Z(AA,E,AB){AB();},applyKeepOnly:function A(AH,AG,AF,AC,AA){var E=AH.model,AB=AH.gridData||AH.model.data||AH.node.data,AE=this,AD=function(AL){var AM=E.getKeepOnlyActionsForAssociatedNodes(AL||[],AG),AJ=AE.model,AK=function(AN){var AO=AN?AJ.wrapUnsetVisualizationFilterAction(AM.actions):AM.actions;AE.submitUndoRedoUpdates(AO,null,AM.callback);};if(AA===false){AK(false);return ;}AJ.checkAndNotifyVFChangeOnKeepOnlyExclude({},function(){AK(true);},function(){AK(false);});}.bind(this),AI=AH.getSelectorDataForKeepOnly(AF,AC);if(AF){this.onKeepOnlyOrExcludeNodeAdded(E,AB,function(){AD(AI);});}else{AD(AI);}},clearFiltersForVis:function N(AC,E,AD){var AA=AC.model,AB=AA.getClearFiltersForVisActions(AC,undefined,E,AD);this.submitUndoRedoUpdates(AB.actions,null,AB.callback,AB.extras);},clearLinkingFilter:function t(E,AA){this.submitUndoRedoUpdates([{act:"clearUCNodeCondition",nodeKey:E.nodeKey}],null,AA,{style:{params:{treesToRender:3}}});},clearLinkingMultiFilter:function t(AH,AI,AJ){var AB=[],AD=this.model,AC=AD.getCurrentLayoutKey(),AE=(AD.defn.layouts).filter(function(AM){return AM.k===AC;})[0],AG=AE.units,AL=AE.cgbMap,AF=R.keyarray(AL),AA=AH.ckey,E,AK;g.forEach(AI,function(AM){AK=AM.vis.k;E=g.filter(AF,function(AN){if(AL[AN]===AK){return AG[AN]&&g.find(AG[AN].scs,"ckey",AA)>-1;}return false;});if(E.length){g.forEach(E,function(AN){AB.push({act:"clearUCNodeCondition",nodeKey:AN});});}});this.submitUndoRedoUpdates(AB,null,AJ,{style:{params:{treesToRender:3}}});},applyKeepOnlyForMutilTemplate:function m(AJ,AL,AG){var AM,AH,AF,AA,AD,AE,AK=this.model,AB,E,AN,AP=this,AC={actions:[],callback:AL},AO=function(AS,AU,AQ,AR){var AT=AS.getKeepOnlyActionsForAssociatedNodes(AR,AC.callback,AU);AC.callback=AT.callback;AC.actions=AC.actions.concat(AT.actions);};g.forEach(AJ,function(AQ){AM=AQ.vis;AH=AQ.selectorData;AF=AQ.nodeIdxToRemove;AE=AQ.graphicLayer;AA=AM.model;AB=AM.model.data||AM.node.data;AD=AB.k;E=AB.tpl;if(AF===-1){AN=[];}else{AN=[].concat(AA.getSelectorDataFromTemplateLimit(E));}if(AF===-2){AN=mstrmojo.array.filter(AN,function(AR){return !AR.keepOnly;});}else{if(AF>=0){AN.splice(AF,1);}}if(AH){AN=AN.concat(AH);AP.onKeepOnlyOrExcludeNodeAdded(AA,AB,function(){AO(AA,AE,AD,AN);});}else{AO(AA,AE,AD,AN);}});if(AC.actions&&AC.actions.length>0){var AI=function(AQ){var AR=AQ?AK.wrapUnsetVisualizationFilterAction(AC.actions):AC.actions;AP.submitUndoRedoUpdates(AR,null,AC.callback);};if(!AG){AI(false);return ;}AK.checkAndNotifyVFChangeOnKeepOnlyExclude({},function(){AI(true);},function(){AI(false);});}},clearFiltersForVisMultipleTemplate:function L(AD,E,AF){var AC,AB,AE,AA={actions:[],callback:AF};g.forEach(AD,function(AH){AC=AH.vis;AE=AH.graphicLayer;AB=AC.model;var AG=AB.getClearFiltersForVisActions(AC,AE,E,AA.callback);AA.actions=AA.actions.concat(AG.actions);AA.callback=AG.callback;AA.extras=AG.extras;});this.submitUndoRedoUpdates(AA.actions,null,AA.callback,AA.extras);}});}());(function(){mstrmojo.requiresCls("mstrmojo.vi.controllers.DocumentControllerBase");mstrmojo.vi.controllers.DocumentController4Library=mstrmojo.declare(mstrmojo.vi.controllers.DocumentControllerBase,[],{scriptClass:"mstrmojo.vi.controllers.DocumentController4Library",});mstrmojo.vi.controllers.DocumentController=mstrmojo.vi.controllers.DocumentController4Library;}());(function(){mstrmojo.requiresCls("mstrmojo.vi.controllers.DocumentController4Library");mstrmojo.vi.controllers.RootController4Library=mstrmojo.declare(mstrmojo.vi.controllers.RootControllerBase,[],{scriptClass:"mstrmojo.vi.controllers.RootController4Library",start:function A(B){}});mstrmojo.vi.controllers.RootController4Library.ENUM_LAYOUT_STYLE=mstrmojo.vi.controllers.RootControllerBase.ENUM_LAYOUT_STYLE;mstrmojo.vi.controllers.RootController=mstrmojo.vi.controllers.RootController4Library;}());(function(){mstrmojo.requiresCls("mstrmojo.vi.VisualInsightAppBase","mstrmojo.vi.controllers.RootController4Library");mstrmojo.requiresDescs();mstrmojo.vi.VisualInsightApp4Library=mstrmojo.declare(mstrmojo.vi.VisualInsightAppBase,[],{scriptClass:"mstrmojo.vi.VisualInsightApp4Library",isDossier:true,appState:mstrmojo.vi.VisualInsightAppBase.APP_STATES.STATE_PRESENTATION,getRootController:function C(){return(this.rootCtrl=this.rootCtrl||new mstrmojo.vi.controllers.RootController4Library());},getDefaultAppState:function B(){return mstrmojo.vi.VisualInsightAppBase.APP_STATES.PRESENTATION;},destroy:function A(D){this.docModel.clearColorByMap();this._super(D);}});mstrmojo.vi.VisualInsightApp4Library.APP_STATES=mstrmojo.vi.VisualInsightAppBase.APP_STATES;mstrmojo.vi.VisualInsightApp4Library.LAYOUT_MODES=mstrmojo.vi.VisualInsightAppBase.LAYOUT_MODES;mstrmojo.vi.VisualInsightApp=mstrmojo.vi.VisualInsightApp4Library;}());