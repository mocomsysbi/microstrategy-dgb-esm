mstrmojo.warehouse.EnumNamespaceMode={ALL:"0",CURRENT:"1"};mstrmojo.mstr.EnumDSSXMLObjectSubTypes={Unknown:-1,Reserved:0,Filter:256,CustomGroup:257,Template:512,ReportGrid:768,ReportGraph:769,ReportEngine:770,ReportText:771,ReportDatamart:772,ReportBase:773,ReportGridAndGraph:774,ReportNonInteractive:775,ReportCube:776,ReportIncrementalRefresh:777,ReportTransaction:778,ReportEmmaCube:779,ReportEmmaIncrementalRefresh:780,Metric:1024,SubtotalDefinition:1025,SystemSubtotal:1026,MetricDMX:1027,DssSubTypeMetricTraining:1028,Style:1536,AggMetric:1792,Folder:2048,Device:2304,Prompt:2560,PromptBoolean:2561,PromptLong:2562,PromptString:2563,PromptDouble:2564,PromptDate:2565,PromptObjects:2566,PromptElements:2567,PromptExpression:2568,PromptExpressionDraft:2569,PromptDimty:2570,PromptBigDecimal:2571,Function:2816,Attribute:3072,AttributeRole:3073,AttributeTransformation:3074,AttributeAbstract:3075,AttributeRecursive:3076,Fact:3328,DimensionSystem:3584,DimensionUser:3585,DimensionOrdered:3586,DimensionUserHierarchy:3587,Table:3840,TablePartitionMD:3841,TablePartitionWH:3842,DatamartReport:4096,FactGroup:4352,Resolution:4864,AttributeForm:5376,FormSystem:5377,FormNormal:5378,Schema:5632,Format:5888,Catalog:6144,CatalogDefn:6400,Column:6656,PropertyGroup:6912,PropertySet:7168,DBRole:7424,DBRoleDataImport:7425,DBRoleOAuth:7427,DBRoleGenericDataConnector:7430,DBLogin:7680,DBConnection:7936,Project:8192,ServerDef:8448,User:8704,UserGroup:8705,Transmitter:8705,Configuration:9216,Request:9472,Search:9984,SearchFolder:10240,Datamart:10496,FunctionPackageDefinition:10752,Role:11008,RoleTransformation:11009,SecurityRole:11264,InBox:11520,InBoxMsg:11776,Consolidation:12032,ConsolidationManaged:12033,ConsolidationElement:12288,ScheduleEvent:12544,ScheduleObject:12800,ScheduleTrigger:13056,Link:13312,DBTable:13568,DBTablePMT:13569,TableSource:13824,DocumentDefinition:14080,ReportWritingDocument:14081,DocumentTheme:14082,DrillMap:14336,DBMS:14592,MDSecurityFilter:14848,MonitorPerformance:15104,MonitorJobs:15105,MonitorUserConnections:15106,MonitorDBConnections:15107,PromptAnswer:15232,PromptAnswers:15360,PromptAnswerBoolean:15233,PromptAnswerLong:15234,PromptAnswerString:15235,PromptAnswerDouble:15236,PromptAnswerDate:15237,PromptAnswerObjects:15238,PromptAnswerElements:15239,PromptAnswerExpression:15240,PromptAnswerExpressionDraft:15241,PromptAnswerDimty:15242,PromptAnswerBigDecimal:15243,PromptAnswerInt64:15244,GraphStyle:15616,ChangeJournalSearch:15872,BlobUnknown:16128,BlobOther:16129,BlobImage:16130,BlobProjectPackage:16131,BlobExcel:16132,BlobHTMLTemplate:16133,DashboardTemplate:16384,Flag:16640,ChangeJournal:16896,ExternalShortcutUnknown:17152,ExternalShortcutURL:17153,ExternalShortcutSnapshot:17154,ExternalShortcutTarget:17408,Reconciliation:17664,DerivedAttribute:3077,PaletteSystem:17920,PaletteCustom:17921,Thresholds:18432,SubscriptionAddress:65281,SubscriptionContact:65282,SubscriptionInstance:65283};mstrmojo.qb.EnumQBAppType={EmmaSingleTable:368,QueryBuilder:352,FFSQL:304,BigQuery:341,BigQueryFFSQL:342,BigQuerySingleTable:345,BISource:400,MDX:2,NewConnector:500};mstrmojo.chart.model.enums.EnumDSSObjectType={DssTypeUnknown:-1,DssTypeReserved:0,DssTypeGeneric:5,DssTypeFormatBAD:46,DssTypeFilter:1,DssTypeTemplate:2,DssTypeReportDefinition:3,DssTypeMetric:4,DssTypeStyle:6,DssTypeAggMetric:7,DssTypeFolder:8,DssTypeDevice:9,DssTypePrompt:10,DssTypeFunction:11,DssTypeAttribute:12,DssTypeFact:13,DssTypeDimension:14,DssTypeTable:15,DssTypeDatamartReport:16,DssTypeFactGroup:17,DssTypeShortcut:18,DssTypeResolution:19,DssTypeMonitor:20,DssTypeAttributeForm:21,DssTypeSchema:22,DssTypeFormat:23,DssTypeCatalog:24,DssTypeCatalogDefn:25,DssTypeColumn:26,DssTypePropertyGroup:27,DssTypePropertySet:28,DssTypeDBRole:29,DssTypeDBLogin:30,DssTypeDBConnection:31,DssTypeProject:32,DssTypeServerDef:33,DssTypeUser:34,DssTypeTransmitter:35,DssTypeConfiguration:36,DssTypeRequest:37,DssTypeScript:38,DssTypeSearch:39,DssTypeSearchFolder:40,DssTypeDatamart:41,DssTypeFunctionPackageDefinition:42,DssTypeRole:43,DssTypeSecurityRole:44,DssTypeLocale:45,DssTypeConsolidation:47,DssTypeConsolidationElement:48,DssTypeScheduleEvent:49,DssTypeScheduleObject:50,DssTypeScheduleTrigger:51,DssTypeLink:52,DssTypeDbTable:53,DssTypeTableSource:54,DssTypeDocumentDefinition:55,DssTypeDrillMap:56,DssTypeDBMS:57,DssTypeMDSecurityFilter:58,DssTypePromptAnswer:59,DssTypePromptAnswers:60,DssTypeGraphStyle:61,DssTypeChangeJournalSearch:62,DssTypeNCSObjects:255,DssTypeReservedLastOne:63};(function(){var A=400,B=1500;mstrmojo._CanHandleTwoClicks=mstrmojo.provide("mstrmojo._CanHandleTwoClicks",{firstClickTimeStamp:undefined,firstClickTarget:undefined,onclick:function(C){var D=new Date();timeStamp=D.getTime();if(D-this.firstClickTimeStamp<B&&D-this.firstClickTimeStamp>A){C.secondTarget=C.getTarget();C.firstTarget=this.firstClickTarget;this.onTwoClicks(C);C.cancel();}else{this.firstClickTarget=C.getTarget();this.firstClickTimeStamp=timeStamp;}if(this._super){this._super(C);}},onTwoClicks:mstrmojo.emptyFn});}());mstrmojo.mstr.EnumDSSXMLBaseFormType={DssXmlBaseFormReserved:0,DssXmlBaseFormHidden:-1,DssXmlBaseFormDateTime:1,DssXmlBaseFormNumber:2,DssXmlBaseFormText:3,DssXmlBaseFormPicture:4,DssXmlBaseFormUrl:5,DssXmlBaseFormEmail:6,DssXmlBaseFormHTMLTag:7,DssXmlBaseFormDate:8,DssXmlBaseFormTime:9,DssXmlBaseFormSymbol:10,DssXmlBaseFormBigDecimal:11,DssXmlBaseFormPhoneNumber:12};mstrmojo.mstr.EnumDSSXMLBaseFormType.convertDataType2BaseFormType=function(B){var A={0:2,1:2,2:2,3:2,4:2,5:2,6:2,7:2,8:3,9:3,10:3,11:2,12:2,13:2,14:8,15:9,16:1,17:3,18:3,21:2,22:2,23:3,30:11,31:2,33:3,34:2};return A[B]||0;};mstrmojo.EnumRWUnitType={LAYOUT:0,HEADER:2,FOOTER:3,SUBSECTION:4,DETAILS:5,PAGEHEADER:6,PAGEFOOTER:7,PANELSTACK:8,PANEL:9,UNITCONTAINER:11,GRID:521,GRAPH:522,GRIDGRAPH:527,RECTANGLE:101,IMAGE:102,LINE:105,TEXTFIELD:106,HTMLCONTAINER:107,SELECTOR:111,ROUNDEDRECTANGLE:112,VISUALIZATION:114,MOJOVISUALIZATION:115};mstrmojo.EnumSelectionType={ALL:0,ELEMENT:1,BRANCH:2,LEVEL:3,BRANCH_LEVEL:4};mstrmojo.architect.menu.EnumMenuActions={NONE:0,DELETE:1,RENAME:2,AUTOMAP:3,UPSTRUCT:4,ADD_ATTRIBUTE:5,ADD_FACT:6,CREATE_ALIAS:7,SET_AS_PRIMARY:8,IS_PRIMARY:9,SAMPLE_DATA:10,CONVERT_ATTR_TO_FACT:11,CONVERT_ATTR_TO_FORM:12,CONVERT_FACT_TO_ATTR:13,REMOVE_FROM_TABLE:14,SET_AS_LOOKUP:15,SET_AS_FORM:16,NEW_FACT:17,NEW_ATTR:18,UPDATE_FORMAT:19,EDIT:20,MAPPING:21,AGGREGATION:22,DATA_TYPE:23,UPDATE_AGGR:24,DATA_SOURCES:25,REMOVE_TABLE:26,REMOVE_ATTR_FROM_RELATIONSHIP:27,ONE_TO_ONE:28,ONE_TO_MANY:29,MANY_TO_MANY:30,DELETE_RELATIONSHIP:31,RELATIONSHIP_TABLE:32,RELATIONSHIP_TABLE_ENTRY:33,SHOW_UNUSED_COLUMNS:34,ADD_TO_LAYER:35,REMOVE_FROM_LAYER:36,COLUMN_DEF:37,LINKS:38,CONVERT_COLUMN_TO_FORM:39,ADD_TO_PROJECT:40,LOGICAL_TABLE_SIZE:41,SET_AS_MULTILINGUAL:42,FORM_CATEGORY:43,UPDATE_CATEGORY:44,UNGROUP_FORMS:45,GROUP_FORM:46,UNGROUP_FORM:47,UPDATE_GROUP:48,DUPLICATE:49,TX_ONE_TO_ONE:50,TX_MANY_TO_MANY:51,TX_APPLY_TO_ALL:52,TX_APPLY_TO_HIGHEST:53,SET_ENTRY_POINT:54,REMOVE_ENTRY_POINT:55,REL_ATTR_ELEMENT_DISPLAY:56,ATTRIBUTE_FILTERS:57,BROWSE_ATTRIBUTES:58,REL_ATTR_ELEMENT_LIMIT:59,REL_ATTR_ELEMENT_LOCK:60,REL_ATTR_ELEMENT_UNLOCK:61,ADD_JOIN_CHILDREN:62,USE_AS_DRILL:63,USE_AS_BROWSE:64,CATALOG_SQL:65,SHARE:66};(function(){var K="FULLCONNECTION",L="MSTR_CUSTOM";function M(Q,O){var S=mstrmojo.string;Q=S.trim(Q);var R=/\(\d+\)$/,P=R.exec(Q);if(P){O.v=parseInt(Q.substring(P.index+1,Q.length-1),10);return S.trim(Q.substring(0,P.index));}return Q;}function J(Q){if(Object.keys){return Object.keys(Q).length;}var O,P=[];for(O in Q){if(Q.hasOwnProperty(O)){P.push(O);}}return P.length;}function B(R){var O="KrbRealm",Q="KrbHostFQDN",P="KrbServiceName";return R.indexOf(O)>=0&&R.indexOf(Q)>=0&&R.indexOf(P)>=0;}mstrmojo.warehouse.dbroles.DBRoleHelper=mstrmojo.provide("mstrmojo.warehouse.dbroles.DBRoleHelper",{isNumeric:function A(O){return !isNaN(parseFloat(O))&&isFinite(O);},getUniqueName:function F(V){V=M(V,{});var Y=mstrApp.rootController.getDBRoles(),Q=mstrApp.rootController.isCloud(),S=mstrApp.rootController.getAllDBRoleNames(),X,U=0,W={},R=0,O=V,P=function(Z){O=V;if(Q){X=M(Z.des,W);}else{X=M(Z.n,W);}R=Math.max(R,W.v)||0;if(X.toString().toUpperCase()===O.toString().toUpperCase()){U=R+1;}};do{if(!Q){mstrmojo.hash.forEach(S,P);if(U===0){mstrmojo.array.forEach(Y,P);}}else{mstrmojo.array.forEach(Y,P);}if(U>0){O=V+" ("+U+")";}}while(mstrApp.rootController.findinArray(Y,"n",O)>=0);return O;},cleanDSNConnection:function E(O){O=mstrmojo.string.trim(O).replace(/\\/g,"\\\\");O=this.cleanDSNConnectionPlaceHolders(O);O=O.replace(/\\/g,"^^^789^^^");O=O.replace(/:/g,"!!!789!!!");O=O.replace(/,/g,"%%%789%%%");O=O.replace("\\","###789###");O=O.replace(/{/g,"+++789+++");O=O.replace(/}/g,"@@@789@@@");O=O.replace("FULLCONNECTION=","");return O;},cleanDSNConnectionPlaceHolders:function E(O){O=O.replace(/!#AT#!/g,"@");O=O.replace(/!#QUESTION#!/g,"?");O=O.replace(/!#AND#!/g,"&");O=O.replace("!#DRIVERSUFFIX#!","");return O;},cleanLoadedDSNConnection:function C(P,O){var Q;P=mstrmojo.string.trim(P);if(O===19||O===0){Q=P.split(";");mstrmojo.array.forEach(Q,function(S,R){if(S.search(/^\s*DBQ=/)===-1){Q[R]=S.replace(/\\\\/g,"\\");}});P=Q.join(";");}else{P=P.replace(/\\\\/g,"\\");}P=P.replace(/\?/g,"!#QUESTION#!");P=P.replace(/&/g,"!#AND#!");return P;},driverAvailable:function I(O){if((O.str.indexOf(K)===0)&&(O.driver===""||O.driver==="XQUERY")){return true;}return(mstrmojo.array.find(this.drivers,"nU",O.driver.toUpperCase())>=0);},driverExists:function G(Q){var U=this,R=false,S="",P=0,O=mstrmojo.warehouse.dbroles.DBRoleHelper;mstrmojo.array.forEach(Q,function(W,V){if(O.driverAvailable.call(U,W)){R=true;S=W.driver;P=V;}return !R;});return{exists:R,driver:S,idx:P};},cleanDriver:function H(P){var R="DRIVER=",O=P.toUpperCase().indexOf(R),Q="";if(O>=0){O+=R.length;Q=P.substring(O,O+P.substring(O).indexOf(";"));Q=Q.replace(/([\{\}])+/g,"");}return Q;},isCustomConnection:function N(O){return(O.indexOf(L)>=0);},showHelp:function D(O){if(mstrApp.showHelpTopic){mstrApp.showHelpTopic(O);}else{window.open(mstrmojo.helpPath()+(O||""),"_blank");return false;}},extractParams:function(S,m){var o=mstrmojo.array,e=mstrmojo.string,b=this,d="XQUERY",V="@",P,j,k="",Z="",g=[],u="",R={},l=/[,:]/g,Y=0,n=/[\x28\x29\x3B\x7D]|(!#)/g,t,f="",a=/[\x29\x3B\x7D\/!]/g,c=b.cleanDriver(m),p,O={},r=0,q=0,Q=[],X=[],U=/@[^\x29\x3B\x7D\/!]+:@[^\x29\x3B\x7D\/!]+[\x29\x3B\x7D\/!]/g,W=S.length,h=0;o.forEach(S,function(x){P=x.str;g=[];R={};p=b.cleanDriver(P);Y++;P=P.replace(U,function(AA){return AA.replace(/:@/,":");});if(P.indexOf(K)===0){if(x.driver===d){Z=P.replace(K+"="+d+";"+V,"");var z=m.indexOf(";;");if(z>=0){m=m.substring(0,z+1);}R[Z]=m.replace(d+";","");O=R;q=J(R);return false;}P=P.replace(K+"=",";");}if(!e.startsWith(c.toUpperCase(),p.toUpperCase())&&!e.startsWith(p.toUpperCase(),c.toUpperCase())){h++;if(h===W){O.noDriverMatched=true;}return true;}do{j=P.indexOf(V);k=P.substring(0,j);n.lastIndex=0;while(n.test(k)){j=n.lastIndex;}Z=e.trim(k.substring(j));P=P.replace(k,"").replace(V,"");a.test(P);t=a.lastIndex-1;f=P[t];a.lastIndex=1;u=P.substring(0,t).replace("@","");g.push({key:u,token:Z,endoftokenChar:f});}while(P.indexOf(V,t)>0);X[Y]=g.length;Q[Y]=0;var w;o.forEach(g,function(AE,AA){w=AE.token;AA=m.toUpperCase().indexOf(w.toUpperCase());if(AA>-1){AA+=w.length;n.lastIndex=0;var AD=m.substring(AA);var AC=n.exec(AD);if(w==="DBQ="&&m.indexOf("Microsoft Access Driver")>-1){AC=/[\x3B\x7D]|(!#)/g.exec(AD);}if(AC){var AG=AD.substring(0,AC.index);if(AD[AC.index]!==AE.endoftokenChar&&AG.length){if(AG[AG.length-1]===AE.endoftokenChar){AG=AG.substring(0,AG.length-1);}}l.test(AG);var AB=AG.substring(l.lastIndex-1,l.lastIndex)||",",AH=AE.key.split(AB),AF=AG.split(AB);if(AH.length===AF.length){o.forEach(AH,function(AI,AJ){R[AI]=AF[AJ];Q[Y]++;});}else{R[AE.key]=AG;}}}});if(J(R)>q||((J(R)===q)&&(X[Y]===Q[Y]))){O=R;q=J(R);r=Y;}return true;});if(B(m)){r=1;}O["RB"+r]=true;O.matchIndex=r-1;return O;},getSelectedDBPSection:function(Q,S){if(!Q||!Q.length){return null;}if(!S){return Q[0];}var O=0,P=0,R=Number.MAX_VALUE;mstrmojo.array.forEach(Q,function(W,U){var V=0;mstrmojo.array.forEach(W.DBP,function(X){if(X.field in S){V++;}});if(V>P||(V===P&&W.DBP.length<R)){P=V;O=U;R=W.DBP.length;}});return Q[O];},getFallbackDB:function(W,X){var P=mstrmojo.hash,R="JDBC",U=new RegExp(R+"$"),S,O,Q,V;W=Number(W);P.forEach(X,function(Z,Y){if(Z===W){S=Y;return false;}});if(!S){return false;}if(U.test(S)){V=true;O=S.replace(U,"");}else{V=false;O=S+R;}Q=X[O];return Q===undefined?false:{jdbc:!V,dbID:Q};}});}());mstrmojo.vi.viz.EnumVizStyles={GRAPH_MATRIX:"GraphMatrixVisualizationStyle",NETWORK:"NetworkVisualizationStyle",HEAT_MAP:"VIHeatMapVisualizationStyle",GOOGLE_MAP:"GoogleMapVisualizationStyle",ESRI_MAP:"ESRIMapVisualizationStyle",IMAGE_LAYOUT:"ImageLayoutVisualizationStyle",NEW_GRAPH_MATRIX:"NewGraphMatrixVisualizationStyle",MAPBOX:"MapboxVisualizationStyle",KPICARD:"KPICardVisualizationStyle"};var STR_BYTE_LEN=mstrmojo.desc(9660,"Byte length:"),STR_BIT_LEN=mstrmojo.desc(11456,"Bit length:"),STR_PREC=mstrmojo.desc(9659,"Precision:"),STR_SCL=mstrmojo.desc(9662,"Scale:"),STR_TM_SCL=mstrmojo.desc(9661,"Time scale:");var byteLength={txt:STR_BYTE_LEN,field:"ps"},bitLength={txt:STR_BIT_LEN,field:"ps"},precision={txt:STR_PREC,field:"ps"},scale={txt:STR_SCL,field:"sc"},timeScale={txt:STR_TM_SCL,field:"ps"};mstrmojo.architect.EnumColumnDataTypes={"-1":{id:-1,n:mstrmojo.desc(4444,"unknown"),options:[]},0:{id:0,n:"Reserved",options:[]},1:{id:1,n:"Integer",options:[byteLength]},2:{id:2,n:"Unsigned",options:[byteLength]},3:{id:3,n:"Numeric",options:[precision,scale]},4:{id:4,n:"Decimal",options:[precision,scale]},5:{id:5,n:"Real",options:[]},6:{id:6,n:"Double",options:[]},7:{id:7,n:"Float",options:[bitLength]},8:{id:8,n:"Char",options:[byteLength]},9:{id:9,n:"VarChar",options:[byteLength]},10:{id:10,n:"LongVarChar",options:[byteLength]},11:{id:11,n:"Binary",options:[byteLength]},12:{id:12,n:"VarBin",options:[byteLength]},13:{id:13,n:"LongVarBin",options:[byteLength]},14:{id:14,n:"Date",options:[]},15:{id:15,n:"Time",options:[timeScale]},16:{id:16,n:"TimeStamp",options:[timeScale]},17:{id:17,n:"NChar",options:[byteLength]},18:{id:18,n:"NVarChar",options:[byteLength]},30:{id:30,n:"Big Decimal",options:[precision,scale]},34:{id:34,n:"Big Integer",options:[byteLength]}};(function(){mstrmojo.warehouse._CanToggleAvatarClass=mstrmojo.provide("mstrmojo.warehouse._CanToggleAvatarClass",{_mixinName:"mstrmojo.warehouse._CanToggleAvatarClass",getAvatarIconClass:function C(D){return"enabled";},ondragenter:function A(D){var E=D.src.widget;if(E&&E.toggleAvatarClass&&this.allowDrop(D)){E.toggleAvatarClass(this.getAvatarIconClass(D),true);}if(this._super){this._super(D);}},ondragleave:function B(D){var E=D.src.widget;if(E&&E.toggleAvatarClass&&this.allowDrop(D)){E.toggleAvatarClass(this.getAvatarIconClass(D),false);}if(this._super){this._super(D);}}});}());(function(){function D(I){var G,J={};for(G=0;G<I.attributes.length;G++){var H=I.attributes[G];J[H.nodeName]=H.value;}for(G=0;G<I.childNodes.length;G++){var K=I.childNodes[G],F;if(K.nodeType===1){F=K.localName;J[F]=J[F]||[];J[F].push(D(K));}}return J;}function A(F){var G=new window.DOMParser();return G.parseFromString(F,"text/xml");}mstrmojo.XMLParser=mstrmojo.declare(null,null,{xml2DOM:function E(F){return A(F);},xml2Object:function C(G){var F=A(G);if(F){return D(F.documentElement);}return null;},file2Object:function B(F){var G=mstrmojo.loadFileSync(F);if(G){return this.xml2Object(G);}return null;}});}());(function(){mstrmojo.requiresDescs(9380,9381,9382,9383,9384,9385,9379,15106,15107,10639,10159,9705,9704);mstrmojo.DI.DIConstants=mstrmojo.provide("mstrmojo.DI.DIConstants",{invalidObjectNameChars:'\\"[]',invalidObjectNameCharsRegex:/[\\"\[\]]/,sourceItemLinkType:{dbList:0,oauthPara:1},setDefaultOAuthParamCMD:"MSTR_DEFAULT_OAUTH_PARAMS",actions:{none:0,importSource:1,editImport:2,transform:3,changeSheet:4,publish:5,changeMappings:6,refine:7,quickPreview:8,savePublish:9,getFlatPreview:10,refreshData:11,mergeCube:12},localStorageKey:{HGOSFileTypeTooltipPop:"HGOSFileTypeTooltipPop"},requestFlag:{mapping:1,preview:2,sourceInfo:4,refineSourceInfo:8,sheets:16,crb:32,transformations:64,transformedPreview:128,relationship:256,stateInfo:512,anyState:268435456,fullData:1024,refineInnerData:2048},formMappingFlag:{formMappingFlagReserved:0,formMappingFlagRemoveGeoRole:1,formMappingFlagRemoveTimeRole:2,formMappingFlagRemoveDeriveFlags:4},browseFlag:{reportBindingTable:1,dataPreview:4,publish:16,cubeConfig:68,reportLevelProperty:256},importBehaviorFlag:{reserved:0,newColumnsSilent:1,dataTypeSilent:2},saveAsFlags:{saveAsOverWrite:32,saveAsManaged:524288,saveAsDDA:33554432,saveAsInMemory:67108864,saveAsWithPrompts:4096,saveAsWithAnswers:4},connectLiveSupport:{connectLiveSupportUnknown:0,connectLiveSupportDDAOrInMemory:1,connectLiveSupportInMemoryOnly:2,connectLiveSupportDDAOnly:3},xdaType:{excel:272,text:288,refine:384,salesforce:337,querybuilder:352,ffsql:304,mdx:2,customFreeFormSQL:3,googleAnalytics:390,googleBigQuery:341,googleBigQueryFFSQL:342,googleBigQuerySingleTable:345,qbSingleTable:368,twitter:343,facebook:344,dataImport:256,projectsImport:400,sparkDataset:416,dataImportFileExcel:16|256,dataImportFileText:32|256,dataImportCustomSQL:48|256,dataImportTable:64|256,dataImportOAuth:80|256,dataImportBISource:144|256,dataImportOAuthSalesforce:1|336,dataImportOAuthGDocs:2|336,dataImportOAuthGDrive:2|336,dataImportOAuthDropbox:3|336,dataImportOAuthGAnalytics:4|336,dataImportOAuthGBigQuery:5|336,dataImportOAuthGBigQueryFFSQL:6|336,dataImportOAuthGBigQuerySingleTable:9|336,spark:160|256},fileTypes:[{n:"CSV/TXT",v:"CSV"},{n:"PARQUET",v:"PARQUET"},{n:"AVRO",v:"AVRO"},{n:"ORC",v:"ORC"},{n:"JSON",v:"JSON"},{n:"PARQ",v:"PARQUET",visible:false}],sourceInfoDesc:{json:"DB_FILE_TYPE_JSON"},sourceType:{file:1,salesforce:2,dropbox:3,googleDrive:4,googleAnalytics:5,googleBigQuery:6,querybuilder:7,mstrFile:8,mdx:9,hadoop:10,twitter:11,facebook:12,bisource:13,remoteProject:14,importfromcube:15,dataFromPushApi:16,newConnector:17,cloudElement:18},sourceSubtype:{localFile:1,url:2,salesforce:3,dropbox:4,googleDrive:5,googleAnalytics:6,googleBigQuery:7,querybuilder:8,samplefile:9,clipboard:10,googleBigQueryFFSQL:11,searchOnSource:12,mdx:13,hadoop:14,twitter:15,facebook:16,bisource:17,remoteProject:18,googleBigQuerySingleTable:19,hanaSingleTable:20,publicData:21,importfromcube:22,dataFromPushApi:23,cloudElement:24,},backendSourceSubtype:{localFile:65537,url:65539,samplefile:65540,clipboard:65538,newConnector:65544,cloudElement:65552,hadoopFileBrowser:65541,customSQL:131073,customSQLWizard:131074,singleTable:131075,bISources:131076,searchAsASource:131078,salesforce:196609,dropbox:196610,facebook:196611,twitter:196612,googleDrive:196613,googleAnalytics:196614,googleBigQuery:196615,googleBigQueryFFSQLModel:196616,googleBigQuerySingleTable:196617,OLAPSources:327681,publicData:65542,dataFromPushApi:65543,dataFromPushApiV2:65545,cloudElement:65552,},sourceItemType:{file:0,url:1,database:2,hadoop:3,olap:4,publicData:5,salesforce:6,googleAnalytics:7,googleBigQuery:8,googleDrive:9,dropbox:10,searchAsASource:11,clipboard:12,bISources:13,facebook:14,twitter:15,samplefile:16,importFromCube:17,addNewConnector:18,newConnector:19,cloudElement:20,unknow:-1},columnState:{reserved:0,unchanged:1,newColumn:2,missing:4,changed:8},operationMode:{create:0,edit:1,refresh:2,subscribe:3,enterCredentials:4,oauth:5,pickTable:6,hadoopPickTable:7,ffsql:8,hadoopFFsql:9},statusCode:{obtainSource:-2147071874,xformsError:-2147071872,mappingError:-2147071871,edit:1,republish:2,schedule:3,enterCredentials:4,pickTable:5,hadoopPickTable:6,ffsql:7,hadoopFFsql:8},pageType:{intro:0,file:1,database:2,emmaPreview:3,redirect:4,analytics:5,dataSelection:6,suggestNewSource:7,sourceIntro:8,sourceObjects:10,sampleFiles:11,dataset:12,externalPage:13,preview:14,clipboard:15,refine:16,parse:17,mstrFile:18,allProjectSource:19,hadoop:20,twitter:21,facebook:22,sourceObjectsDnD:23,schedule:24,publicData:25,republish:26,sourceAdmin:27,importFromCube:28,addNewConnector:29,newConnector:30,addConnectorList:31,cloudElement:32},backendError:{overwriteObject:-2147212339,noPermission:-2147214579,invalidObjectName:-2147213715,unexpectedDataType:-2147212539,noExternalSession:-2147071844,noPrivilege:-2147212082,salesforceUnsavedReport:-2147212081,salesforceObsoleteReport:-2147212080,maxSizeExceeded:-2147212076,maxSizeExceededURL:-2147212121,salesforceUnresolvedFilter:-2147212074,incrementalRefresh:-2147212287,invalidUrl:-2147212062,fileVersionError:-2147212064,emptySheet:-2147212144,refreshTokenUnavailable:-2147202875,cubeQuotaExceeded:-2147071825,notEnoughSpace:-2147071811,importedURLInvalid:-2147212122,unsupportedFileFormat:-2147212063,objectNameTooLong:-2147217407,noExternalSourceInfo:-2147215346,memoryConsumptionExceeded:-2147215346,cubeQuotaReached:-2147071870,switchingFileType:-2147212140,memoryGovernSizeExceeded:-2147181051,stringTooLong:-2147213718,missingColumn:-2147071871,dataDiscoveryError:-2147211998,refineApplyError:-2147202299,serverOutOfMemory:-2147212055,columnCountMatchError:-2147467259,incompatibleDataTypeError:-2147211983,reportTimeout:-2147212335,requestTimeout:-2147206497,databaseCredentialsNotAvailable:-2147212037,ddasupportIncompatible:-2147215326,mergeInvalidXdatype:-2147215325,notFullyControl:-2147214579,shouldBeIgnored:-2147212123,CECredentialNotAvailable:-2147215317,AuthenticationError:-2147215346,queryEngineGeneralError:-2147212544},transformation:{xtab:1,delimiter:2},application:{platform:"Platform",cloudPersonal:"Personal",cloudProfessional:"Professional"},refreshOptions:{replace:1,append:2,update:4},cubeRefreshType:{dummy:-1,reserved:0,add:1,remove:2,update:3,upsert:4,addNewTable:5,deleteTable:6,replaceTable:7,preserve:8},tableStatsExecutionAction:{reserved:0,forceExecution:1,ignore:4,requireFreshData:268435456},sourcesInfoFlags:{none:0,getReports:1,getUserName:2,getTokensInfo:4,revokeSession:8,getGAnalyticsAccount:64},queryBuilderType:{individualTable:1,multipleTables:2,queryScript:3},relationshipEditType:{create:1,changeERType:2,remove:3,flip:8001},ERType:{reserved:0,ERType11:1,ERType1M:2,ERTypeM1:3,ERTypeMM:4,ERTypeParallel:5,ERTypePerpendicular:6},RSType:{reserved:0,auto:1,geo:2,defined:3},tableStates:{newly:1,old:2},behaviorChangeFlag:{multiSheet:4,remapping:8,refreshData:16},menuItems:{SEPARATOR:-1,NONE:0,TABLE_RENAME:1,DO_NOT_IMPORT:2,FLIP_ORDER:3,DELETE:4,RELATIONSHIP_TYPE:5,ONE_TO_ONE:6,ONE_TO_MANY:7,MANY_TO_ONE:8,MANY_TO_MANY:9,REMOVE:10,REFRESH_DATA:11,REFINE:12,CANCEL_REFINE:13,UNLINK:14,CHANGE_DATA_TYPE:15,MARK_GEO_ROLES:16,CREATE_TIME_ATTRIBUTES:17,TO_METRIC:18,TO_ATTRIBUTE:19,MAP_TO_PROJECT_ATTRIBUTE:20,UNMAP:21,MODIFY_ATTRIBUTE_GROUP:22,CREATE_ATTRIBUTE_GROUP:23,HIDE_ALL_ATTRIBUTE_FORMS:24,DEFINE_RELATIONSHIPS:25,LINK:26,ITEM_RENAME:27,CREATE_MULTIFORM_ATTRIBUTE:28,EDIT_MULTIFORM_ATTRIBUTE:29,ADDTO_MULTIFORM_ATTRIBUTE:30,SHOW_ALL_ATTRIBUTE_FORMS:31,SHOW_ALL_COLUMNS:32,PARTITION:33,REFINE_RENAME:34,REFINE_DELETE:35,REFINE_DELETE_ALL:36,REFINE_RESET:37,REFINE_RESET_ALL:38,PARSE:39,IMPORT:40,UNLINK_ALL:41,CREATE_HIERARCHY_ATTRIBUTE:42,EDIT_HIERARCHY_ATTRIBUTE:43,RESET_HIERARCHY_ATTRIBUTE:44},dataTypeMenuItems:{DATE_TIME:"1",NUMBER:"2",TEXT:"3",URL:"5",EMAIL:"6",HTML_TAG:"7",DATE:"8",TIME:"9",SYMBOL:"10",BIG_DECIMAL:"11",PHONE_NUMBER:"12"},columnDataTypes:{reserved:0,integer:1,unsigned:2,numeric:3,decimal:4,real:5,dtdouble:6,dtfloat:7,dtchar:8,varChar:9,longVarChar:10,binary:11,varBin:12,longVarBin:13,date:14,dttime:15,timeStamp:16,nChar:17,nVarChar:18,nlong:22,bigDecimal:30,cellFormatData:31,utf8Char:33,int64:34},formsOptions:{CREATE_MULTIFORM_ATTRIBUTE:1,EDIT_MULTIFORM_ATTRIBUTE:2,ADDTO_MULTIFORM_ATTRIBUTE:3},hierarchyOptions:{CREATE_HIERARCHY_ATTRIBUTE:1,EDIT_HIERARCHY_ATTRIBUTE:2,RESET_HIERARCHY_ATTRIBUTE:3},rdcsFlag:{ID:1,JOIN_ID:2,FILTER_ID:3,DISTANCE:4},timeRoles:{NONE:0,DATE:1,DATE_TIME:2,TIME:3,SECOND:4,MINUTE:5,HOUR:6,DAY:7,WEEK:8,MONTH:9,QUARTER:10,YEAR:11},contextMenuType:{ITEM_MENU:0,TABLE_MENU:1,PREVIEW_ITEM_MENU:2,LINK_MENU:3},dialogType:{fixRefreshErrorDialog:1,allObjectsViewDialog:2,missingColumnsDialog:3,diPageDialog:4,refreshHistoryDialog:5,alternateSourceValidateDialog:6,ddaConfirmDialog:7,publishStatusDialog:8,saveAsDialog:9,cubesList:10,refinePage:11,multiFormEditor:12,sheetsSelectionDialog:13,partitionGroupDialog:14,parseDataDialog:15,errorDialog:16,warningDialog:17,relationDefineDialog:18,qbImportOptionDialog:19,previewRenameDialog:20,mapProjectsAttributeDialog:21,setOAuthParaDialog:22,objectPicker:23,refineClusteringPage:24,refineExtractDialog:25,refineImportDialog:26,twitterAdvOptDialog:27,credentialsDialog:28,mapProjectsAttributeDialog2:29,setWhiteListDialog:30,binaryUploadDialog:31,authenticationDialog:32,sharingDialog:33,hadoopGatewayManagerDialog:34,hadoopGatewayDialog:35,addConnectorDialog:36,hierarchyAttributeDialog:37,hierarchyAttributeResetDialog:38},dataEvents:{DATA_PREVIEW_EVENT:"dataReturned",NO_DATA_RETURNED_EVENT:"noDataReturned"},cubeSchedStatus:{unexecuted:1,successful:2,unscheduled:3,failed:4},privilegeType:{accessDatabase:1,accessFile:2,accessCloud:3},dbType:{MS_ACCESS:100,ORACLE:200,SQL_SERVER:300,INFORMIX:400,SYBASE:500,REDBRICK:600,DB2:700,TANDEM:800,TERADATA:900,UNKNOWN:1000,GENERIC:1100,SAP:1200,NETEZZA:1300,EXCEL:1400,MSFT_AS:1500,ESSBASE:1600,MYSQL:1700,POSTGRESQL:1800,HPNEOVIEW:1900,METAMATRIX:2000,DATALLEGRO:2100,COMPOSITE:2200,ASTER:2300,VERTICA:2400,OPENACCESS:2500,SYBASE_SQL_ANY:2600,SYBASE_IQ:2700,PARACCEL:2800,TM1:2900,XQUERY:3000,HIVE:3100,SAND:3200,SALESFORCE:3300,HIVETHRIFT:3400,VECTORWISE:3500,ENTERPRISEDB:3600,KOGNITIOWX2:3700,EXASOLUTION:3800,INFORMATICA:3900,SAPHANA:4000,IMPALA:4100,AMAZON_REDSHIFT:4200,DENODO:4300,GOOGLE_DRIVE:4400,DROPBOX:4500,GOOGLE_ANALYTICS:4600,GOOGLE_BIGQUERY:4700,CONNECTION_CLOUD:4800,GOOGLE_BIG_QUERY_FFSQL_MODEL:4900,PARSTREAM:5100,MONGODB:5200,MARKLOGIC:5300,BIG_DATA_ENGINE:5400,SEARCH_ENGINE_SOLR:5500,SPLUNK:5600,TWITTER:5700,FACEBOOK:5800,PIG:6400,URL:7700,newConnector:7900,LOACLFILE:8200},getCubeQuotaAndInfosOptions:{GetCubeQuotaAndInfosReserved:0,GetCubeQuotaAndInfosDefault:1,GetCubeQuotaAndInfosQuotaOnly:2,GetCubeQuotaAndInfosAll:3,GetCubeQuotaAndInfosVI:4},homepageViewMode:{GRID_VIEW:0,LIST_VIEW:1},datasetServeMode:{inMemory:1,dda:2,unknow:3},cubePollStatus:{msgID:0,result:1,prompt:2,error:3,xmlResult:21},ibmDb2Versions:[17,18,21,22,23,24,25,37,45,46,47,48,63,66,74,89,92,101,103,105,123,134,157,172,202,232],hadoopDbTypes:[3100,1100,700,4100,7300,6800,6400,8100],formCategory:{longitude:"2345134F4F5E261C3BB902A874467080",latitude:"B191051C48221A6AE44CA2B65B1B65E3"},urlAuthDBRoles:{anonymous:"CB1CB472A07E41D5AE038232839F2064",windows:"95A5ACC02FE94CBABCB65E4F2D2415B2",kerberos:"317D6F016D784836A724AD4D739E1E9C",integrated:"E966E1A0A4C949108287B2E5086B68EB"},urlAuthDBMSId:"497F2406FA154B86810C71EA3D401D6D",newConnectorDBMSId:"565D5DC3A1124726B85FE53EF992472A",hadoopGateWay:{HGoS_CONFIG_HAS_EXIT:1510,CONNOT_AUTHENTICATE:1511,SPACE_OVER:1512,FAIL_COPY_TO_HOST:1513,INSUFFICIENT:1514,DIRECTORY_NO_EXIST:1515,HGOS_DEPLOYED:1518,HGOS_DEPLOYING:1519,CONNOT_AUTHENTICATE2:1520,HGOS_RUNNING:1521,HGOS_STOPPED:1522,HGOS_NOT_DEPLOYING:1523,HGOST_TAR_NOT_EXIST:1524,HGOS_CONF_NOT_EXIST:1530},workstation:{filerBreakLine:new RegExp("[\r\n]","g"),utils:{shouldShowTitleBar:function(){var A=mstrApp.getRootController().rootView.inPageDialog;return !!mstrApp.isWorkstation&&(!!mstrApp.isPopup||!!A);},setNativeWindow:function(C,F){var B=1110,E=590,D=parseInt(C,10),A=parseInt(F,10);if(!window.FormWrapper||!window.FormWrapper.setWindowFrame){return ;}if(C.match(/%$/)&&F.match(/%$/)){window.FormWrapper.setWindowContentSize(1200,680);}else{D=D<B?B:D;A=A<E?E:A;window.FormWrapper.setWindowContentSize(D,A);}},lockResize:function(){if(!window.FormWrapper||!window.FormWrapper.lockResize){return ;}window.FormWrapper.lockResize();},unlockResize:function(){if(!window.FormWrapper||!window.FormWrapper.unlockResize){return ;}window.FormWrapper.unlockResize();}}},authMode:{ANONYMOUS:0,USERNAME:1,OAUTH:2},authModePrefix:{ANONYMOUS:"AuthMode=Anonymous;URL=",USERNAME:"AuthMode=Basic;URL=",OAUTH:"AuthMode=OAuth;URL="},sdkUrl:{MARKPLACE_URL:"https://community.microstrategy.com/s/gallery?tabset-89baf=202df",QUICK_START_URL:"https://lw.microstrategy.com/msdz/MSDL/GARelease_Current/docs/projects/DataConnectorSDK/Content/topics/Quick_Start_Guide.htm"},originalConnector:{elastic:"DE4A8E15405A36D80BF1E1A2BA6F9B66",tapClicks:"1E8ADD3975DA4609B8D00E6211ACAB6A"},googleAnalyticsUrl:{queryExplorer:"https://ga-dev-tools.appspot.com/query-explorer/"},weekDay:[{n:mstrmojo.desc(9380,"Monday"),v:0},{n:mstrmojo.desc(9381,"Tuesday"),v:1},{n:mstrmojo.desc(9382,"Wednesday"),v:2},{n:mstrmojo.desc(9383,"Thursday"),v:3},{n:mstrmojo.desc(9384,"Friday"),v:4},{n:mstrmojo.desc(9385,"Saturday"),v:5},{n:mstrmojo.desc(9379,"Sunday"),v:6}],dateMon:[{n:mstrmojo.desc(15106,"1st day"),v:"1"},{n:mstrmojo.desc(15107,"15th day"),v:"15"}],timeOfDay:[{n:"12:00AM",v:"12:00AM"},{n:"1:00AM",v:"1:00AM"},{n:"2:00AM",v:"2:00AM"},{n:"3:00AM",v:"3:00AM"},{n:"4:00AM",v:"4:00AM"},{n:"5:00AM",v:"5:00AM"},{n:"6:00AM",v:"6:00AM"},{n:"7:00AM",v:"7:00AM"},{n:"8:00AM",v:"8:00AM"},{n:"9:00AM",v:"9:00AM"},{n:"10:00AM",v:"10:00AM"},{n:"11:00AM",v:"11:00AM"},{n:"12:00PM",v:"12:00PM"},{n:"1:00PM",v:"1:00PM"},{n:"2:00PM",v:"2:00PM"},{n:"3:00PM",v:"3:00PM"},{n:"4:00PM",v:"4:00PM"},{n:"5:00PM",v:"5:00PM"},{n:"6:00PM",v:"6:00PM"},{n:"7:00PM",v:"7:00PM"},{n:"8:00PM",v:"8:00PM"},{n:"9:00PM",v:"9:00PM"},{n:"10:00PM",v:"10:00PM"},{n:"11:00PM",v:"11:00PM"}],schedule:{DAILY:"Daily",WEEKDAY:"Weekday",WEEKLY:"Weekly",MONTHLY:"Monthly"},mainPage:{GRID_MODE:0,LIST_MODE:1},sourceIconClsName:{0:"ds-Generic",1:"ds-DB2",2:"ds-DB2",3:"ds-DB2",4:"ds-InformixWire",5:"ds-InformixXPS",6:"ds-PostgreSQL",7:"ds-SAP",8:"ds-SAP",9:"ds-Oracle",10:"ds-MicroSoft",11:"ds-Teradata",12:"ds-MySQL",13:"ds-GreenPlum",14:"ds-Netezza",15:"ds-WebServices",17:"ds-Infobright",18:"ds-Salesforce",19:"ds-MicroSoft",20:"ds-Actian-n",21:"ds-Amazon-Redshift",22:"ds-Impala",23:"ds-Aster",25:"ds-Actian-n",26:"ds-EnterpriseDB",27:"ds-Vertica",28:"ds-Denodo",29:"ds-CiscoDataVirtualization",31:"ds-MicroSoft",32:"ds-GoogleBigQuery",33:"ds-SAP",35:"ds-IBMBigInsights",39:"ds-TM1",41:"ds-WebServices",43:"ds-Amazon-EMR",44:"ds-Apache-Hive",45:"ds-ClouderaHive",46:"ds-HortonworksHive",47:"ds-MapRHive",48:"ds-apache",49:"ds-SharkSpark",50:"ds-MongoDB",52:"ds-MariaDB",51:"ds-MarkLogic",54:"ds-Splunk",55:"ds-DataDirectCloud",56:"ds-ParStream",58:"ds-Phoenix",59:"ds-MicroSoft",60:"ds-DB2",61:"ds-Oracle",62:"ds-Teradata",63:"ds-SAP",65:"ds-PostgreSQL",66:"ds-MySQL",67:"ds-MariaDB",68:"ds-Amazon-EMR",69:"ds-Apache-Hive",70:"ds-ClouderaHive",71:"ds-HortonworksHive",72:"ds-MapRHive",73:"ds-SharkSpark",75:"ds-Amazon-Redshift",76:"ds-PIVOTALHAWQ",77:"ds-MemSQL",78:"ds-Arcadia-Platform",79:"ds-Altibase",80:"ds-MongoDB",81:"ds-Presto",82:"ds-DB2",83:"ds-DB2",84:"ds-InformixWire",85:"ds-SAP",86:"ds-MicroSoft",87:"ds-MicroSoft",88:"ds-MemSQL",90:"ds-GreenPlum",91:"ds-PIVOTALHAWQ",92:"ds-Netezza",93:"ds-Infobright",94:"ds-Actian-n",95:"ds-Impala",96:"ds-IBMBigInsights",97:"ds-Aster",99:"ds-Actian-n",100:"ds-EnterpriseDB",101:"ds-Vertica",102:"ds-Denodo",103:"ds-CiscoDataVirtualization",105:"ds-DataDirectCloud",106:"ds-ParStream",107:"ds-Arcadia-Platform",109:"ds-Presto",110:"ds-Phoenix",111:"ds-Kognitio",112:"ds-Kognitio",113:"ds-Informatica",114:"ds-Informatica",115:"ds-Apache-Cassandra-JDBC",116:"ds-SAP",117:"ds-Actian",118:"ds-Actian",119:"ds-InformixXPS",120:"ds-Apache-Cassandra-JDBC",121:"ds-MapRDrill",122:"ds-Cirro",123:"ds-EXASolution",124:"ds-EXASolution",125:"ds-Oracle",126:"ds-Oracle",127:"ds-Snowflake",128:"ds-Snowflake",129:"ds-Amazon-Aurora",130:"ds-Amazon-Aurora",131:"ds-Amazon-Athena",132:"ds-Amazon-Athena",133:"ds-MapRDrill",134:"ds-Druid",135:"ds-Druid",139:"ds-MongoBI",157:"ds-GoogleBigQuery",161:"ds-MapD",168:"ds-HortonworksSpark",169:"ds-HortonworksSpark",170:"ds-Yellowbrick",},dispTag:{1:"Database",2:"OLAP",4:"BigData",8:"Database",16:"BigData",32:"BigData"},searchTags:{100:["Database","ODBC"],200:["Database","ODBC"],300:["Database","ODBC"],400:["Database","ODBC"],500:["Database","ODBC"],600:["Database","ODBC"],700:["Database","ODBC"],900:["Database","ODBC"],1100:["Database","ODBC"],1200:["OLAP","Cube"],1300:["Database","ODBC"],1400:["Database"],1500:["OLAP","Cube"],1600:["OLAP","Cube"],1700:["Database","ODBC"],1800:["Database","ODBC"],2200:["Database","ODBC"],2300:["Database","ODBC"],2400:["Database","ODBC"],2800:["Database","ODBC"],2900:["OLAP","Cube"],3000:["Database"],3100:["Database","BigData","Hadoop"],3300:["Cloud"],3500:["Database","ODBC"],3600:["Database","ODBC","BigData"],3800:["Database"],3900:["Database"],4000:["Database","ODBC"],4100:["Database","BigData","Hadoop"],4200:["Database","ODBC"],4300:["Database","ODBC"],4700:["Database","Cloud","BigData"],4800:["Cloud"],5200:["Database","NoSQL"],5300:["Database","NoSQL"],5400:["Hadoop"],6400:["Database","BigData","Hadoop"],6600:["Database"],6700:["Database"],6800:["BigData"],6900:["BigData"],7100:["NoSQL"],7200:["Database"],7300:["BigData","Hadoop"],7500:["Database"],7600:["Database"],8000:["Database"],8100:["BigData"],},srcItemTypes:{ALL_SOURCES:"ALL_SOURCES",STATIC_SOURCE:"STATIC_SOURCE",DBTYPE_SOURCE:"DBTYPE_SOURCE",CUSTOM_CONNECTOR:"CUSTOM_CONNECTOR",CLOUDELEMENT_CONNECTOR:"CLOUDELEMENT_CONNECTOR"},combination:{BigData:["BigData","NoSQL","Search","Hadoop"],Apps:["Apps","oAuth","Cloud","Social","BI","PublicData","CE"]},GenericDBStr:"Generic",dataSourceType:{MONGODB:"mongodb",FILE_URL:"fileUrl",FILE_LOCAL:"fileLocal",ES:"elasticsearch",DROPBOX:"dropbox",GOOGLE_DRIVE:"googleDrive",GOOGLE_ANALYTICS:"googleAnalytics",GOOGLE_BIGQUERY:"googleBigQuery",SALESFORCE:"salesforce",FILE:"file",GENERIC_JDBC:"genericJdbc"},ERDF:{ENUM_LOAD_REPORT_BROWSE_TYPE_BINDINGTABLE:1,ENUM_LOAD_REPORT_BROWSE_TYPE_DATAPREVIEW:4,ENUM_LOAD_REPORT_BINDING_FLAG_ALL:15,ENUM_LOAD_REPORT_PREVIEW_FLAG_MappingInfo:1,ENUM_LOAD_REPORT_PREVIEW_FLAG_DataInfo:2,ENUM_LOAD_REPORT_PREVIEW_FLAG_SourceInfo:4,ENUM_LOAD_REPORT_PREVIEW_FLAG_InnerDataInfo:2048,},DSSSubType:{DSSSUBTYPEATTRIBUTE:3072,DSSSUBTYPEATTRIBUTEROLE:3073,DSSSUBTYPEATTRIBUTETRANSFORMATION:3074,DSSSUBTYPEATTRIBUTEABSTRACT:3075,DSSSUBTYPEATTRIBUTERECURSIVE:3076},DSSExType:{DSSEXDISPARK:416},URLMode:{NormalUrl:0,NewConnector:1,NewConnectorEdit:2,CloudElement:3},disableFeatures:{DISABLE_CUSTOM_CONNECTOR:"disableCustomerConnector",DISABLE_DDA:"disableDDA",DISABLE_QUOTA:"disableQuota",DISABLE_HADOOP:"disableHadoop",DISABLE_BI_TOOLS:"disableBITools",DISABLE_CLIP_BOARD:"disableClipboard",DISABLE_FACE_BOOK:"disableFacebook",DISABLE_TWITTER:"disableTwitter",DISABLE_SAMPLE_FILES:"disableSampleFiles",DISABLE_PUBLIC_DATA:"disablePublicData",DISABLE_MERGE_CUBE:"disableMergeCube",DISABLE_CE_SOURCE:"disableCESource",DISABLE_FLATTERN_DB_SOURCE:"disabledSources"},DssXmlPrivileges:{DssXmlPrivilegesUseDatabaseInstanceManager:57},Enum_SourceCategoryType:{File:1,BigData:2,Database:3,OLAP:4,Customized:5,Apps:6,}});}());(function(){mstrmojo.StringBuffer=mstrmojo.declare(null,null,{scriptClass:"mstrmojo.StringBuffer",append:function A(C){if(!this.buf){this.reset();}this.buf[++this.len]=C;return this;},reset:function B(){this.buf=[];this.len=-1;}});mstrmojo.StringBuffer.prototype.toString=function(D){var C=this.buf;return(C&&C.join(D||""))||"";};}());(function(){mstrmojo._Fetchable=mstrmojo.provide("mstrmojo._Fetchable",{_mixinName:"mstrmojo._Fetchable",blockBegin:1,blockCount:-1,concat:false,items:null,size:function A(){var B=this.items;return(B&&B.length)||0;},next:function(B){if(this.hasNext()){this.getItems(this.blockBegin+this.blockCount,B);}},previous:function(B){if(this.hasPrevious()){var C=this.blockBegin-this.blockCount;C=C<0?0:C;this.getItems(C,B);}},getItems:function(H,F,B){F=F||{};var E=this,D=mstrmojo.emptyFn,C=F.success||D,G=F.failure||D,I=F.complete||D;this._retrieveItems(H,{success:function(J){E.blockBegin=H;E.blockCount=J.bc||30;E.set("items",(E.concat?(E.items||[]).concat(J.items||[]):(J.items||[])));if(J.totalSize){E.totalSize=J.totalSize;}C(J);},failure:function(J){G(J);},complete:function(J){I(J);}},B);},_retrieveItems:function(D,C,B){alert("Object which mixes in this mixin has not implemented this method - _retrieveItems().");},hasNext:function(){return(((this.concat?1:this.blockBegin)+((this.items&&this.items.length)||0))<((mstrApp.isAppStatePause&&mstrApp.isAppStatePause())?this.totalSize:(this.totalSize+1)));},hasPrevious:function(){return this.blockBegin>1;}});}());(function(){mstrmojo._CanRenderChildrenOnShow=mstrmojo.provide("mstrmojo._CanRenderChildrenOnShow",{_subs_renderOnShow:null,childRenderCheck:function B(D){if(this.renderMode!=="onshow"){return this._super(D);}if(D.visible){return this._super(D);}var C=this._subs_renderOnShow;if(!C){C={};this._subs_renderOnShow=C;}if(!C[D.id]){C[D.id]=D.attachEventListener("visibleChange",this.id,"_on_child_visibleChange");}return false;},_on_child_visibleChange:function A(C){if(this.hasRendered){var E=C&&C.src;if(E&&this.childRenderCheck(E)){var D=this._subs_renderOnShow;if(D){E.detachEventListener(D[E.id]);delete D[E.id];}E.render();}}}});}());(function(){function Q(V,R,S){if(V.nodeType===3&&R){return V;}else{var U=(R&&V.nodeType===1&&V.lastChild)?V.lastChild:F(V,S);return U?D(U,S):null;}}function F(S,R){return(S===R)?null:(S.previousSibling||F(S.parentNode,R));}function D(S,R){if(S===R){return null;}if(S.nodeType===3&&I(S)){return S;}else{if(S.nodeType===1&&S.lastChild){return D(S.lastChild);}else{return D(F(S,R));}}}function I(R){return R.textContent||R.nodeValue||R.innerText;}function M(V,R,S){if(V.nodeType===3&&R){return V;}else{var U=(R&&V.nodeType===1&&V.firstChild)?V.firstChild:B(V,S);return U?E(U,S):null;}}function B(S,R){return(S===R)?null:(S.nextSibling||B(S.parentNode,R));}function E(S,R){if(S===R){return null;}if(S.nodeType===3&&I(S)){return S;}else{if(S.nodeType===1&&S.firstChild){return E(S.firstChild);}else{return E(B(S,R));}}}mstrmojo.range=mstrmojo.provide("mstrmojo.range",{EDGE:{EDGE_BEGIN:1,EDGE_END:2,EDGE_MIDDLE:-1},getEdgeInfo:function P(U,V){var R=0,S;if(U.nodeType===1){if(window.getSelection){S=document.createRange();S.selectNode(U);R=S.toString().length;}else{S=document.body.createTextRange();S.moveToElementText(U);R=S.text.length;}}else{R=I(U).length;}return V===R?this.EDGE.EDGE_END:(V===0?this.EDGE.EDGE_BEGIN:this.EDGE.EDGE_MIDDLE);},collapseOnNode:function K(V,S){if(!V.offsetParent){return ;}var U=this.getSelection(),R=this.getRange();if(window.getSelection){R.selectNodeContents(V);R.collapse(S);U.removeAllRanges();U.addRange(R);}else{R.moveToElementText(V);R.collapse(S);R.select();}},collapseOnTextNode:function L(V,W){var U=this.getSelection(),S=this.getRange();if(window.getSelection){var R=M(V,true);S.setStart(R,W);S.collapse(true);U.removeAllRanges();U.addRange(S);}else{S.moveToElementText(V);S.collapse(true);S.move("character",W);S.select();}},collapseOnTextNodeIE:function C(S,U){var V=M(S,true),R;while(V!==null){R=I(V).length;if(R>=U){this.collapseOnTextNode(V,U);break;}else{U-=R;V=M(V,false);}}},getRangeInfo:function J(Y,f){var a=null,l,d=this.getRange(),c;if(Y&&Y===d.startContainer){var h=d.startContainer.firstChild,V=h&&h.firstChild,e=V&&V.firstChild;if(e){d.setStart(e,d.startOffset);d.setEnd(e,d.endOffset);}}if(window.getSelection){var X=function(n,p,o){var m=n.cloneRange();m.collapse(o);m.setStartBefore(p);return m.toString().length;},S=d.startContainer,g=d.startOffset;if(S.nodeType===1){g=X(d,S,true);}a={collapsed:d.collapsed,startContainer:S,startOffset:f?f.startOffset:g};if(!d.collapsed){var W=d.endContainer,R=d.endOffset;if(W.nodeType===1){R=X(d,W,false);}a.endContainer=W;a.endOffset=R;}a.range=d;}else{var k,b,Z=function(p,q){var o=p.duplicate(),m=document.body.createTextRange(),n;o.collapse(q);n=o.parentElement();m.moveToElementText(n);m.setEndPoint("EndToStart",o);return{container:n,offset:m.text.length};},j=Z(d,true),U;a={collapsed:(d.compareEndPoints("StartToEnd",d)===0),startContainer:j.container,startOffset:j.offset};if(!a.collapsed){U=Z(d,false);a.endContainer=U.container;a.endOffset=U.offset;}}return a;},collapse:function O(S){if(window.getSelection){var U=this.getSelection();if(S){U.collapseToStart();}else{U.collapseToEnd();}}else{var R=this.getRange();R.collapse(S);R.select();}},selectSingleNode:function H(U){var S=this.getSelection(),R=this.getRange();if(window.getSelection){R.selectNodeContents(U);S.removeAllRanges();S.addRange(R);}else{R.moveToElementText(U);R.select();}},selectMultipleNodes:function N(X,S,Y,V){var W=this.getSelection(),U=this.getRange();if(window.getSelection){U.setStart(X,S);U.setEnd(Y,V);W.removeAllRanges();W.addRange(U);}else{X=(X.nodeType===3)?X.parentNode:X;U.moveToElementText(X);U.move("character",S);Y=(Y.nodeType===3)?Y.parentNode:Y;var R=document.body.createTextRange();R.moveToElementText(Y);R.move("character",V);U.setEndPoint("EndToStart",R);U.select();}},getSelection:function G(){if(window.getSelection){return window.getSelection();}else{return document.selection;}},getRange:function A(){if(window.getSelection){selection=window.getSelection();if(selection.rangeCount>0){return selection.getRangeAt(0);}else{return document.createRange();}}else{return document.selection.createRange();}}});}());mstrmojo.VisEnum={ControlType:{BUTTON:"button",LASSO_SELECTOR:"lasso-selector",LASSO_RESIZER:"lasso-resizer",SPLITTER:"splitter",GM_ROW_HEADER:"rh",GM_ROW_HEADER_TEXT:"rhtext",GM_ROW_HEADER_EXTRA:"rhext",GM_COL_HEADER:"ch",GM_COL_HEADER_TEXT:"chtext",GM_COL_HEADER_EXTRA:"chext",GM_YAXIS:"y",GM_XAXIS:"x",GM_YLABEL:"y-label",GM_XLABEL:"x-label",GM_ROW_HEADER_TITLE:"rht",GM_ROW_HEADER_TITLE_TEXT:"rhttext",GM_COL_HEADER_TITLE:"cht",GM_COL_HEADER_TITLE_TEXT:"chttext",GM_MINI_CHART:"chart",GM_TEXT_BODY:"text-body",GM_SHAPE:"shape",GM_MARKER:"marker",GM_SET_SHAPE:"set-shape",GM_YAXIS2:"y2",GM_XAXIS2:"x2",GM_TREND_LINE:"trendLine",GM_TREND_LINE_HOVER:"trendLineHover",GM_TREND_LINE_SELECT:"trendLineSelect",GM_REF_LINE:"referenceLine",GM_REF_LINE_HOVER:"referenceLineHover",GM_REL_LINE_SELECT:"referenceLineSelect",GM_HIGHLIGHT_BOX:"highlight-box",GM_AXIS_TEXT:"axis-text",GM_AXIS_WORD:"axis-word",GM_SVG_X_NUMERIC:"svg-x-numeric",GM_SVG_X_CATEGORY:"svg-x-category",GM_SVG_Y_NUMERIC:"svg-y-numeric",GM_SVG_Y_CATEGORY:"svg-y-category",GM_X_NUMERIC:"x-numeric",GM_X_CATEGORY:"x-category",GM_Y_NUMERIC:"y-numeric",GM_Y_CATEGORY:"y-category",GM_SVG_CHART:"svg-chart",GM_DATA_LABEL:"data-label",GM_YAXIS_LINE:"y-line",GM_XAXIS_LINE:"x-line",GM_YAXIS2_LINE:"y2-line",GM_XAXIS2_LINE:"x2-line",LGD_TITLE:"lgd-title",LGD_TEXT:"lgd-text",LGD_COLORBOX:"lgd-colorbox",LGD_COLORBOX_CTN:"lgd-colorbox-ctn",LGD_CANVAS:"lgd-canvas",LINE_CONTAINER:"line-ctn",GM_V_MATRIX_LINE:"v-line",GM_H_MATRIX_LINE:"h-line",GM_V_CHART_LINE:"v-ctline",GM_H_CHART_LINE:"h-ctline",GM_CHART_ROW:"ct-row",GM_CHART_COL:"ct-col",GM_H_GRID_LINE:"h-gline",GM_V_GRID_LINE:"v-gline",GM_H_MINOR_GRID_LINE:"h-gline-minor",GM_V_MINOR_GRID_LINE:"v-gline-minor",GM_ORIGIN_LINE:"originLine",GM_ORIGIN_LABEL:"origin-label",GM_ORIGIN_LINE_H:"origin-line-h",GM_ORIGIN_LINE_V:"origin-line-v",GM_ORIGIN_LABEL_H:"origin-label-h",GM_ORIGIN_LABEL_V:"origin-label-v",GM_DUMMY_A:"dummy-a",GM_V_EXTRA_LINE:"v-extra-line",GM_REF_LABEL:"ref-label",GM_RIGHT_BORDER:"border-r",GM_BOTTOM_BORDER:"border-b",KPI_V_SCROLLBAR:"kpi-vertical-scrollbar",KPI_H_SCROLLBAR:"kpi-horizontal-scrollbar"},GMDropZoneID:{ROWS:1,COLUMNS:2,XAXIS:3,YAXIS:4,BREAKBY:5,SLICEBY:6,COLORBY:7,SIZEBY:8,TOOLTIP:9,ANGLEBY:10},NETWORK_LOCAL_PROPS:{ZOOM_FACTOR:"zf",NODE_POSITION:"np"},NETWORK_PROPERTIES:{showLegend:"showLegend",showEdgeDirection:"showedgearrow",showTransition:"animatelayout",nodeSizeAggregation:"nodesizeaggfunc",minNodeSize:"minns",maxNodeSize:"maxns",themeType:"th",circleLabelFont:"BubFnt",modifiedNodes:"mn",layoutMode:"layout",legendPosition:"legendposition",dragMode:"mode",bubbleStyle:"bbs",propsCategory:"pc",lgdBgFillClr:"lgdBgFillClr",lgdBgFillTrans:"lgdBgFillTrans",lgdFntClr:"lgdFntClr",lgdFntSz:"lgdFntSz",lgdFntFml:"lgdFntFml",lgdFntStyle:"lgdFntStyle"},NETWORK_LAYOUT:{CIRCULAR:"circular",LINEAR:"linear",FORCE_DIRECTED:"forceDirected"},NETWORK_DRAG_MODE:{pan:0,select:1},NETWORK_AGGREGATION_METHOD:{"Count of":0,"Sum of":1,"Average of":2,"Min of":3,"Max of":4},NETWORK_MIN_NODE_SIZE_TYPE:{PROPORTIONAL:1,FULL_RANGE:2,ADJUSTED_RANGE:3},NETWORK_MAX_NODE_SIZE_TYPE:{AUTOMATIC:1,MANUAL:2},NETWORK_FORCE_DIRECTED_LAYOUT_EDGE_CURVATURE:[0,0.2],HEATMAP_PROPERTIES:{showLegend:"showLegend",deleteButton:"ed",showMetricValues:"mv",labelSize:"lb",layout:"la",themeType:"th",headerType:"he",deletedList:"dl",refreshType:"rt",metricList:"ml",colorByType:"cbt",absoluteFixed:"abs",blendColor:"blc",background:"bg",legendBackground:"lbg",headerColors:"hcl",fonts:"fts",propsCategory:"pc",attrColorByOpacity:"acbo",metricColorByOpacity:"mcbo"},HEATMAP_LABEL_SIZE:{On:0,Off:1,Proportional:2},MAPS_PROPERTIES:{SHOW_LEGEND:"showLegend"},VIS_CARDLIMIT:{GRID:250,NON_GRID:8000,AREA_MAP:1000},GMLegendDataType:{COLOR_BY:1,SIZE_BY:2},GMLegendFormatingPropertyTag:{LEGEND_BG_COLOR:"lgdBgFillClr",LEGEND_BG_FILL_STYLE:"lgdBgFillStyle",LEGEND_BG_FILL_EFFECT:"lgdBgFillEff",LEGEND_BG_FILL_TRANSPARENCY:"lgdBgFillTrans",LEGEND_FONT_SIZE:"lgdFntSz",LEGEND_FONT_FAMILY:"lgdFntFml",LEGEND_FONT_STYLE:"lgdFntStyle",LEGEND_FONT_COLOR:"lgdFntClr",LEGEND_BORDER_SHOW:"lgdBdrShw",LEGEND_BORDER_COLOR:"lgdBdrClr",LEGEND_BORDER_THICKNESS:"lgdBdrThk",LEGEND_BORDER_LINE_STYLE:"lgdBdrStyle",LEGEND_BORDER_LINE_COMBINED_STYLE:"lgdBdrCmbStyle",COLOR_SQUARE_COLOR:"clrSqrClr"},LegendPropertyTag:{LEGEND_MODE:"lm",LEGEND_POSITION:"LegendPosition",SCALE_LEGEND_WIDTH:"lwr"},EnumLegendMode:{RESTORED:1,MINIMIZED:2},EnumSingleLegendMode:{RESTORE:1,COLLAPSE:2},EnumColorRankMode:{INVALID:-1,VALUE:0,TOP:1,BOTTOM:2,TOP_PERCENT:3,BOTTOM_PERCENT:4},FormNameDisplayType:{OFF:0,ON:1,FORM_NAME_ONLY:2,SHOW_ATT_NAME_ONCE:3,AUTO:4},SERVER_JSON_ERROR_TYPE:{EMPTY_DATA:0,NO_DATASET:1,AE_ERROR:2,NO_TEMPLATE_UNIT:3},NETWORK_CIRCLE_BORDER_WIDTH:8,IMAGELAYOUT_PROPERTIES:{DISPLAY_MODE:"mt",MAX_SIZE_TYPE:"ty",MAX_SIZE_VALUE:"val",MIN_SIZE_TYPE:"mst",MIN_SIZE_VALUE:"msv",MAP_FILE_PATH:"mf",SHAPE_FILL_OPC_PER:"shapeFillTrans",SHAPE_FILL_COLOR:"shapeClr",SHAPE_BORDER_STYLE:"shapeBorderCmbStyle",SHAPE_BORDER_COLOR:"shapeBorderClr",DATA_LABEL_SWITCH:"dls",DATA_LABEL_FONT_SIZE:"dlFntSz",DATA_LABEL_FONT_FAMILY:"dlFntFml",DATA_LABEL_FONT_COLOR:"dlFntClr",DATA_LABEL_FONT_STYLE:"dlFntStyle",BLANK_MAP_BORDER_STYLE:"blankMapBorderStyle",BLANK_MAP_BORDER_COLOR:"blankMapBorderClr",BLANK_MAP_COLOR:"blankMapClr",DEFAULT_MAP_COLOR:"dftMapClr",DEFAULT_BUBBLE_COLOR:"dftBubbleClr",DEFAULT_MAP_BORDER_COLOR:"dftMapBorderClr",DEFAULT_BUBBLE_BORDER_COLOR:"dftBubbleBorderClr",LEGEND_FONT_SIZE:"lgFntSz",LEGEND_FONT_FAMILY:"lgFntFml",LEGEND_FONT_COLOR:"lgFntClr",LEGEND_FONT_STYLE:"lgFntStyle",LEGEND_BACKGROUND_COLOR:"lgBgClr",LEGEND_OPC_PER:"lgBgFillTrans",LEGEND_POSITION:"lgPos",LEGEND_SHOW:"lgShow",LEGEND_MODE:"lgMode",LEGEND_SCALE:"lgScale",H_MATRIX_LINE_COLOR:"hMatrixLnClr",V_MATRIX_LINE_COLOR:"vMatrixLnClr",ALL_MATRIX_LINE_COLOR:"allMatrixLnClr",H_MATRIX_LINE_STYLE:"hMatrixLnCmbStyle",V_MATRIX_LINE_STYLE:"vMatrixLnCmbStyle",ALL_MATRIX_LINE_STYLE:"allMatrixLnCmbStyle"}};(function(){mstrmojo.vi._MonitorsAppState=mstrmojo.provide("mstrmojo.vi._MonitorsAppState",{onAppStateChange:function(B){if(this._super){this._super(B);}},init:function A(B){this._super(B);if(mstrApp.attachEventListener){mstrApp.attachEventListener("appStateChange",this.id,"onAppStateChange");}}});}());mstrmojo.architect.EnumDragActions={ADD_TABLE:"addTable",ADD_COLUMN:"addColumn",TABLE_VIEW_ATTR:"tableViewItemAttr",TABLE_VIEW_METRIC:"tableViewItemMetric",PROJECT_TABLE:"projectTable",PROJECT_TABLE_COLUMN:"projectTableColumn",LINKER_ATTR:"linkerAttr",COMPOUND_FORM:"compoundForm"};mstrmojo.gm.GMEnums={};mstrmojo.gm.DualAxisSubAxisBit={PRIMARY:0,SECONDARY:1};mstrmojo.gm.StackExetrmeId={PRIMARY_Y_AXIS:-2,SECONDARY_Y_AXIS:-18,PRIMARY_X_AXIS:-1,SECONDARY_X_AXIS:-17};mstrmojo.gm.FormNameType={OFF:0,ON:1,FORM_NAME_ONLY:2,SHOW_ATT_NAME_ONCE:3,AUTO:4};mstrmojo.gm.EnumSelectionOptionLevel={GLOBAL:1,ITSELF:2,ATTS_METRIC_COMBINATION:3,METRIC_AXIS:4,METRIC:5,AXIS:6,COLOR_BY:7,ALL_SHAPE:8,ITSELF_RESOLVED:9};mstrmojo.gm.EnumLabelRotation={VERTICAL:2,HORIZONTAL:0,AUTOMATIC:-1};mstrmojo.gm.EnumIdentityType={LEGEND:Math.pow(2,0),GRAPH_SHAPE:Math.pow(2,1),X_AXIS:Math.pow(2,2),Y_AXIS:Math.pow(2,3),X2_AXIS:Math.pow(2,4),Y2_AXIS:Math.pow(2,5),GRID_LINE:Math.pow(2,6),TREND_LINE:Math.pow(2,7),REF_LINE:Math.pow(2,8),DATA_LABEL:Math.pow(2,9),COLOR_SQUARE:Math.pow(2,10),ROW_TITLE:Math.pow(2,11),COL_TITLE:Math.pow(2,12),ROW_HEADER:Math.pow(2,13),COL_HEADER:Math.pow(2,14),LOG_SCALE:Math.pow(2,15),H_MATRIX_LINE:Math.pow(2,16),V_MATRIX_LINE:Math.pow(2,17),LEGEND_TEXT:Math.pow(2,18),SHAPE_COLLECTION:Math.pow(2,19),MINOR_GRID_LINE:Math.pow(2,20),AXIS_SCALE:Math.pow(2,22),AXIS_ORIGIN:Math.pow(2,23),ROWS_BACKGROUND:Math.pow(2,24),COLS_BACKGROUND:Math.pow(2,25),X_NUMERIC:Math.pow(2,26),X_CATEGORY:Math.pow(2,27),Y_NUMERIC:Math.pow(2,28),Y_CATEGORY:Math.pow(2,29),X_METRIC_AXIS_TITLE:Math.pow(2,30),Y_METRIC_AXIS_TITLE:Math.pow(2,31),VIZ_BOX_TITLE:Math.pow(2,32),REF_LINE_LABEL:Math.pow(2,33),LINE_MARKER:Math.pow(2,34),X_AXIS_ORIGIN_LABEL:Math.pow(2,35),Y_AXIS_ORIGIN_LABEL:Math.pow(2,36),X_AXIS_ORIGIN_LINE:Math.pow(2,37),Y_AXIS_ORIGIN_LINE:Math.pow(2,38),Y_ATTRIBUTE_AXIS_TITLE:Math.pow(2,39),ROW_HEADER_TEXT:Math.pow(2,40),ROW_TITLE_TEXT:Math.pow(2,41),COL_HEADER_TEXT:Math.pow(2,42),COL_TITLE_TEXT:Math.pow(2,43),VIZ_BOX_CONTAINER:Math.pow(2,44),X_ATTRIBUTE_AXIS_TITLE:Math.pow(2,45),AXIS_ORIGIN_DEFINE:Math.pow(2,46)};mstrmojo.gm.EnumGMZoneIds={ROWS:1,COLUMNS:2,XAXIS:3,YAXIS:4,BREAKBY:5,SLICEBY:6,COLORBY:7,SIZEBY:8,TOOLTIP:9,ANGLEBY:10};mstrmojo.gm.EnumClickType={NONE:-1,LEFT_CLICK:1,RIGHT_CLICK:2,DOUBLE_CLICK:3};mstrmojo.gm.EnumLegendSlot={RIGHT_TOP:1,RIGHT_MIDDLE:2,RIGHT_BOTTOM:3,LEFT_TOP:4,LEFT_MIDDLE:5,LEFT_BOTTOM:6,LEFT:7,RIGHT:8};mstrmojo.gm.EnumAxisType={ATTRIBUTE:0,METRIC:1};mstrmojo.gm.EnumGraphType={UNDEFINED:-1,AREA:1,BAR:2,LINE:3,SCATTER:4,BUBBLE:5,PIE:6,GRID:7,HISTOGRAM:8,BOXPLOT:9,WATERFALL:10};mstrmojo.gm.EnumContextMenu={SEPARATOR:0,KEEP_ONLY:1,EXCLUDE:2,SORT_ASCENDING:3,SORT_DESCENDING:4,CLEAR_SORT:5,SHOW_DATA:6,SWITCH_THEME:7,KEEP_ONLY_AND_SHOW:8,CLOSE_LEGEND:9,OPEN_LEGEND:10,AXIS_SCALE:11,DRILL_TO:100,CHART_TYPE:200,AREA_ABS:201,AREA_STACKED:202,AREA_PERCENT:203,BAR_SBS:204,BAR_ABS:205,BAR_STACKED:206,BAR_PERCENT:207,LINE_ABS:208,LINE_STACKED:209,LINE_PERCENT:210,BUBBLE:211,SCATTER:212,H_AREA_ABS:213,H_AREA_STACKED:214,H_AREA_PERCENT:215,H_BAR_SBS:216,H_BAR_ABS:217,H_BAR_STACKED:218,H_BAR_PERCENT:219,H_LINE_ABS:220,H_LINE_STACKED:221,H_LINE_PERCENT:222,GRID:223,CIRCLE:224,SQUARE:225,PIE:226,TICKER:227,RING:228,CANVAS:229,SVG:230,LARGE_ABL:231,OUTPUT_EXTREMES:232,COMBINATION:233,ENABLE_PARTIAL_RENDERING:234,DISABLE_PARTIAL_RENDERING:235,OUTPUT_DATA_COUNT:236,ENABLE_TIMER:239,DISABLE_TIMER:240,ENABLE_CE_TIMER:241,DISABLE_CE_TIMER:242};mstrmojo.gm.EnumColorRankMode={RANK_MODE_VALUE:0,RANK_MODE_TOP:1,RANK_MODE_BOTTOM:2,RANK_MODE_TOP_PERCENT:3,RANK_MODE_BOTTOM_PERCENT:4};mstrmojo.gm.EnumColorByType={NULL:0,ATT:1,METRICS_ITEM:2,METRICS:3,ATT_METRICS:4};mstrmojo.gm.EnumDockPosition={TOP:1,RIGHT:2,BOTTOM:3,LEFT:4};mstrmojo.gm.EnumXAxisLabelStatus={NORMAL:1,STAGGER:2,ROTATE:3,HORI_DROP:4};mstrmojo.gm.EnumABLDirection={UNDEFINED:-1,NONE:0,HORIZONTAL:1,VERTICAL:2};mstrmojo.gm.EnumMetricsPosition={MetricsByRow:0,MetricsByColumn:1,MetricsByAxis:2,MetricsByBreakBy:3,MetricsBySlice:4,MetricsByXAxis:5,MetricsByYAxis:6};mstrmojo.gm.EnumDrawingAPI={GET_CHART_WIDTH:0,GET_CHART_HEIGHT:1,GET_ROW_HEADER:2,GET_COLUMN_HEADER:3,CREATE_UNIT_Y_AXIS:4,CREATE_UNIT_X_AXIS:5,GET_FULL_FLEDGED_CHART:6,GET_ROW_SPAN:7,GET_COLUMN_SPAN:8,GET_METRICS_ON_X:9,GET_METRICS_ON_Y:10,GET_METRICS_ON_SIZE_BY:11,UPDATE_MINI_CHART:12,UPDATE_X_AXIS:13,UPDATE_Y_AXIS:14,MAX_RADIUS_CALC:15,GET_EXTRA_COLUMN_HEADER:16,UPDATE_COLUMN_HEADER:17,UPDATE_ROW_HEADER:18,LAYOUT_ALL_X_AXIS_LABELS:19,LAYOUT_ONE_X_AXIS_LABELS:20};mstrmojo.gm.WidgetPropertyTag={FIT_TO:"FitTo",AXIS_SCALE:"MinMax",SHAPE:"Shape",SUB_TYPE:"Subtype",VIS_TYPE:"visType",DATA_LABEL:"DataLabel",DATA_LABELS_PLACEMENT:"DataLabelPalcement",METRIC_LEVEL_DATA_LABEL:"mtcLvlDataLabel",DATA_LABEL_FONT_SIZE_CONSTRAINT:"DataLabelFontSizeConstraint",DATA_LABEL_TEXT_ANGLE:"DataLabelTextAngle",BANDING:"Banding",LEGEND_VISIBLE:"LegendVisibleness",COL_ALIGNMENT:"Columnalignment",ROW_ALIGNMENT:"Rowalignment",MAX_SIZE_TYPE:"SizeType",MAX_SIZE_VALUE:"SizeValue",MIN_SIZE_TYPE:"minSizeType",MIN_SIZE_VALUE:"minSizeValue",OUTSIDE_BORDER:"OutSideBorder",AXES:"AxisLine",MATRIX_LINES:"MatrixLine",GRID_LINES:"GridLine",SELECTION_TYPE:"SelectionType",SELECTIONS:"Selections",LEGEND_MODE:"lm",LEGEND_POSITION:"LegendPosition",SCALE_LEGEND_WIDTH:"lwr",SCALE_CHART_HEIGHT:"rr",SCALE_CHART_WIDTH:"cr",SCALE_ROW_HEADERS:"rvr",SCALE_COL_HEADERS:"chr",SCALE_Y:"yr",SCALE_X:"xr",SCALE_Y2:"y2r",SCALE_X2:"x2r",SCALE_ALL:"scales",SCALE_V_EXTRA_LINE:"vExtraLine",SORT_ORDER:"so",SORT_INDEX:"si",AXIS_SCALE_DATA:"AxisScale",AXIS_SCALE_REAL_MIN:"rMin",AXIS_SCALE_REAL_MAX:"rMax",AXIS_SCALE_MANUAL_MIN:"mMin",AXIS_SCALE_MANUAL_MAX:"mMax",AXIS_SCALE_AUTO_MIN:"autoMin",AXIS_SCALE_AUTO_MAX:"autoMax",SINGLE_AXIS_SCALE_TYPE:"scaleType",LOG_SCALE:"logScale",GROUP_INFO:"groupInfo",METRIC_SHAPES:"metricShapes",AXIS_ORIGIN:"axisOrigin",AXIS_ORIGIN_AUTO:"axOriAuto",AXIS_ORIGIN_VALUE:"axOriValue",TREND_LINE_DEF:"trdDef",REF_LINE_DEF:"refDef",TREND_TYPE:"trdTp",TREND_LEVEL:"trdLvl",TREND_ENABLED:"trdEnabled",TREND_INCLUDE_BREAK_BY:"trdIncBB",TREND_POLY_DEGREE:"trdDgr",TREND_FORECAST_ENABLED:"trdFstEnabled",TREND_BWD_FORECAST:"trdBwdFst",TREND_FWD_FORECAST:"trdFwdFst",TREND_SEASONALITY:"trdSeason",TREND_BUBBLE_FORE_DEF:"trdBbForeDef",TREND_BUBBLE_FORE_FWD:"trdBbForeFwd",TREND_BUBBLE_FORE_BWD:"trdBbForeBwd",TREND_BUBBLE_FORE_ENABLED:"trdBbForeEnabled",TREND_BUBBLE_MAX:"trdBbMax",TREND_BUBBLE_MIN:"trdBbMin",REF_TYPE:"refTp",REF_LEVEL:"refLvl",REF_ENABLED:"refEnabled",REF_SHOW_LABEL:"refLbShw",REF_LABEL_TYPE:"refLbTp",REF_CONST_VALUE:"refCstVl",REF_LINE_NAME:"refLnName",TREND_REF_LINE_THICKNESS:"trdRefLnThk",TREND_REF_LINE_COLOR:"trdRefLnClr",TREND_REF_LINE_STYLE:"trdRefLnStyle",TREND_REF_LINE_COMBINED_STYLE:"trdRefLnCmbStyle",FORMATS_ON_COMBINATION:"fmtOnComb",PARTIAL_RENDER:"prtRdn",SHOW_BOTH_TOTALS:"totalShw:intSumShw"};mstrmojo.gm.FormatingPropertyTag={IS_DEFAULT_VALUE:"_default",MODIFIED_DEF_FILL_COLOR:"modDefFillClr",ALL_SHAPE_FORMAT:"allShpFmt",SHAPE_LINE_THICKNESS:"shpLnThk",SHAPE_LINE_COLOR:"shpLnClr",SHAPE_LINE_STYLE:"shpLnStyle",SHAPE_LINE_COMBINED_STYLE:"shpLnCmbStyle",SHAPE_FILL_COLOR:"shpFillClr",SHAPE_FILL_COLOR_DEFAULT:"shpFillClr_default",SHAPE_FILL_STYLE:"shpFillStyle",SHAPE_FILL_TRANSPARENCY:"shpFillTrans",SHAPE_FILL_EFFECT:"shpFillEff",SHAPE_BORDER_COLOR:"shpBdrClr",SHAPE_BORDER_STYLE:"shpBdrStyle",SHAPE_BORDER_COMBINED_STYLE:"shpBdrCmbStyle",SHAPE_BORDER_THICKNESS:"shpBdrThk",LINE_MARKER_SHOW:"lnMkShw",LINE_MARKER_SHAPE:"lnMkShp",LINE_MARKER_SIZE:"lnMkSz",LINE_MARKER_COLOR:"lnMkClr",LINE_MARKER_COLOR_EQUAL:"lnMkClrEq",LINE_MARKER_BORDER_COLOR:"lnMkBdrClr",PIE_EXPLODE:"pieExpl",DATA_LABELS_SHOW:"dlShw",DATA_LABELS_FONT_FAMILY:"dlFntFml",DATA_LABELS_FONT_SIZE:"dlFntSz",DATA_LABELS_FONT_STYLE:"dlFntStyle",DATA_LABELS_FONT_COLOR:"dlFntClr",REF_LABELS_FONT_FAMILY:"rfLnFntFml",REF_LABELS_FONT_SIZE:"rfLnFntSz",REF_LABELS_FONT_STYLE:"rfLnFntStyle",REF_LABELS_FONT_COLOR:"rfLnFntClr",LEGEND_BG_COLOR:"lgdBgFillClr",LEGEND_BG_FILL_STYLE:"lgdBgFillStyle",LEGEND_BG_FILL_EFFECT:"lgdBgFillEff",LEGEND_BG_FILL_TRANSPARENCY:"lgdBgFillTrans",LEGEND_FONT_SIZE:"lgdFntSz",LEGEND_FONT_FAMILY:"lgdFntFml",LEGEND_FONT_STYLE:"lgdFntStyle",LEGEND_FONT_COLOR:"lgdFntClr",LEGEND_BORDER_SHOW:"lgdBdrShw",LEGEND_BORDER_COLOR:"lgdBdrClr",LEGEND_BORDER_THICKNESS:"lgdBdrThk",LEGEND_BORDER_LINE_STYLE:"lgdBdrStyle",LEGEND_BORDER_LINE_COMBINED_STYLE:"lgdBdrCmbStyle",ALL_LINE_SHOW:"allLnShw",ALL_LINE_COLOR:"allLnClr",ALL_LINE_STYLE:"allLnStyle",ALL_LINE_COMBINED_STYLE:"allLnCmbStyle",ALL_LINE_THICKNESS:"allLnThk",ALL_AXIS_ORIGIN_LINE_SHOW:"axOriLnShw",ALL_AXIS_ORIGIN_LINE_COLOR:"axOriLnClr",ALL_AXIS_ORIGIN_LINE_COMBINED_STYLE:"axOriLnCmbStyle",X_AXIS_ORIGIN_LINE_SHOW:"xAxOriLnShw",X_AXIS_ORIGIN_LINE_COLOR:"xAxOriLnClr",X_AXIS_ORIGIN_LINE_STYLE:"xAxOriLnStyle",X_AXIS_ORIGIN_LINE_COMBINED_STYLE:"xAxOriLnCmbStyle",X_AXIS_ORIGIN_LINE_THICKNESS:"xAxOriLnThk",Y_AXIS_ORIGIN_LINE_SHOW:"yAxOriLnShw",Y_AXIS_ORIGIN_LINE_COLOR:"yAxOriLnClr",Y_AXIS_ORIGIN_LINE_STYLE:"yAxOriLnStyle",Y_AXIS_ORIGIN_LINE_COMBINED_STYLE:"yAxOriLnCmbStyle",Y_AXIS_ORIGIN_LINE_THICKNESS:"yAxOriLnThk",ALL_AXIS_LINE_SHOW:"allAxLnShw",ALL_AXIS_LINE_COLOR:"allAxLnClr",ALL_AXIS_LINE_STYLE:"allAxLnStyle",ALL_AXIS_LINE_COMBINED_STYLE:"allAxLnCmbStyle",ALL_AXIS_LINE_THICKNESS:"allAxLnThk",ALL_AXIS_TITLE_SHOW:"allAxTtShw",ALL_AXIS_TITLE_CONTENT:"allAxTtCtt",ALL_AXIS_TITLE_FONT_COLOR:"allAxTtFntClr",ALL_AXIS_TITLE_FONT_FAMILY:"allAxTtFntFml",ALL_AXIS_TITLE_FONT_STYLE:"allAxTtFntStyle",ALL_AXIS_TITLE_FONT_SIZE:"allAxTtFntSz",ALL_AXIS_LABELS_FONT_SIZE:"allAxLbFntSz",ALL_AXIS_LABELS_FONT_FAMILY:"allAxLbFntFml",ALL_AXIS_LABELS_FONT_STYLE:"allAxLbFntStyle",ALL_AXIS_LABELS_FONT_COLOR:"allAxLbFntClr",ALL_AXIS_LABELS_ROTATION:"allAxLbRtt",ALL_AXIS_LABELS_SHOW:"allAxLbShw",X_AXIS_LINE_SHOW:"xAxLnShw",X_AXIS_LINE_COLOR:"xAxLnClr",X_AXIS_LINE_STYLE:"xAxLnStyle",X_AXIS_LINE_COMBINED_STYLE:"xAxLnCmbStyle",X_AXIS_LINE_THICKNESS:"xAxLnThk",X_AXIS_TITLE_SHOW:"xAxTtShw",X_AXIS_TITLE_CONTENT:"xAxTtCtt",X_AXIS_TITLE_FONT_COLOR:"xAxTtFntClr",X_AXIS_TITLE_FONT_FAMILY:"xAxTtFntFml",X_AXIS_TITLE_FONT_STYLE:"xAxTtFntStyle",X_AXIS_TITLE_FONT_SIZE:"xAxTtFntSz",X_AXIS_LABELS_FONT_SIZE:"xAxLbFntSz",X_AXIS_LABELS_FONT_FAMILY:"xAxLbFntFml",X_AXIS_LABELS_FONT_STYLE:"xAxLbFntStyle",X_AXIS_LABELS_FONT_COLOR:"xAxLbFntClr",X_AXIS_LABELS_ROTATION:"xAxLbRtt",X_AXIS_LABELS_SHOW:"xAxLbShw",Y_AXIS_LINE_SHOW:"yAxLnShw",Y_AXIS_LINE_COLOR:"yAxLnClr",Y_AXIS_LINE_STYLE:"yAxLnStyle",Y_AXIS_LINE_COMBINED_STYLE:"yAxLnCmbStyle",Y_AXIS_LINE_THICKNESS:"yAxLnThk",Y_AXIS_TITLE_SHOW:"yAxTtShw",Y_AXIS_TITLE_CONTENT:"yAxTtCtt",Y_AXIS_TITLE_FONT_COLOR:"yAxTtFntClr",Y_AXIS_TITLE_FONT_FAMILY:"yAxTtFntFml",Y_AXIS_TITLE_FONT_STYLE:"yAxTtFntStyle",Y_AXIS_TITLE_FONT_SIZE:"yAxTtFntSz",Y_AXIS_LABELS_FONT_SIZE:"yAxLbFntSz",Y_AXIS_LABELS_FONT_FAMILY:"yAxLbFntFml",Y_AXIS_LABELS_FONT_STYLE:"yAxLbFntStyle",Y_AXIS_LABELS_FONT_COLOR:"yAxLbFntClr",Y_AXIS_LABELS_ROTATION:"yAxLbRtt",Y_AXIS_LABELS_SHOW:"yAxLbShw",ALL_FILL_COLOR:"allFillClr",ALL_FILL_TRANSPARENCY:"allFillTrans",BG_COLOR:"bgFillClr",BG_FILL_EFFECT:"bgFillEff",BG_FILL_STYLE:"bgFillStyle",BG_FILL_TRANSPARENCY:"bgFillTrans",ROW_HEADER_FILL_COLOR:"rwHdrFillClr",ROW_HEADER_FILL_EFFECT:"rwHdrFillEff",ROW_HEADER_FILL_STYLE:"rwHdrFillStyle",ROW_HEADER_FILL_TRANSPARENCY:"rwHdrFillTrans",COLUMN_HEADER_FILL_COLOR:"colHdrFillClr",COLUMN_HEADER_FILL_EFFECT:"colHdrFillEff",COLUMN_HEADER_FILL_STYLE:"colHdrFillStyle",COLUMN_HEADER_FILL_TRANSPARENCY:"colHdrFillTrans",ALL_MATRIX_LINES_SHOW:"allMatrixLnShw",ALL_MATRIX_LINES_COLOR:"allMatrixLnClr",ALL_MATRIX_LINES_THICKNESS:"allMatrixLnThk",ALL_MATRIX_LINES_STYLE:"allMatrixLnStyle",ALL_MATRIX_LINES_COMBINED_STYLE:"allMatrixLnCmbStyle",V_MATRIX_LINES_SHOW:"vMatrixLnShw",V_MATRIX_LINES_COLOR:"vMatrixLnClr",V_MATRIX_LINES_THICKNESS:"vMatrixLnThk",V_MATRIX_LINES_STYLE:"vMatrixLnStyle",V_MATRIX_LINES_COMBINED_STYLE:"vMatrixLnCmbStyle",H_MATRIX_LINES_SHOW:"hMatrixLnShw",H_MATRIX_LINES_COLOR:"hMatrixLnClr",H_MATRIX_LINES_THICKNESS:"hMatrixLnThk",H_MATRIX_LINES_STYLE:"hMatrixLnStyle",H_MATRIX_LINES_COMBINED_STYLE:"hMatrixLnCmbStyle",OUTSIDE_BORDER_SHOW:"outBdrShw",OUTSIDE_BORDER_COLOR:"outBdrClr",OUTSIDE_BORDER_STYLE:"outBdrStyle",OUTSIDE_BORDER_THICKNESS:"outBdrThk",OUTSIDE_BORDER_COMBINED_STYLE:"outBdrCmbStyle",GRID_LINE_AUTO:"gridLineAuto",ALL_GRID_LINES_SHOW:"allGridLnShw",ALL_GRID_LINES_COLOR:"allGridLnClr",ALL_GRID_LINES_THICKNESS:"allGridLnThk",ALL_GRID_LINES_STYLE:"allGridLnStyle",ALL_GRID_LINES_COMBINED_STYLE:"allGridLnCmbStyle",AUTO_GRID_LINES_COLOR:"autoGridLnClr",AUTO_GRID_LINES_COMBINED_STYLE:"autoGridLnCmbStyle",MAJOR_GRID_LINES_SHOW:"majorGridLnShw",MAJOR_GRID_LINES_COLOR:"majorGridLnClr",MAJOR_GRID_LINES_THICKNESS:"majorGridLnThk",MAJOR_GRID_LINES_STYLE:"majorGridLnStyle",MAJOR_GRID_LINES_COMBINED_STYLE:"majorGridLnCmbStyle",MINOR_GRID_LINES_SHOW:"minerGridLnShw",MINER_GRID_LINES_COLOR:"minerGridLnClr",MINER_GRID_LINES_THICKNESS:"minerGridLnThk",MINER_GRID_LINES_STYLE:"minerGridLnStyle",MINER_GRID_LINES_COMBINED_STYLE:"minerGridLnCmbStyle",ALL_NGM_GRID_LINES_SHOW:"allNGMGridLnShw",X_GRID_LINES_SHOW:"xGridLnShw",Y_GRID_LINES_SHOW:"yGridLnShw",ALL_ROW_COLUMN_SHOW:"allRwColShw",COLUMN_TEXT_SHOW:"colTxtShw",ROW_TEXT_SHOW:"rwTxtShw",COLUMN_HEADER_SHOW:"colHdrShw",ROW_HEADER_SHOW:"rwHdrShw",COLUMN_VALUES_SHOW:"colVlShw",ROW_VALUES_SHOW:"rwVlShw",ALL_TEXT_FONT_COLOR:"allTxtFntClr",ALL_TEXT_FONT_SIZE:"allTxtFntSz",ALL_TEXT_FONT_FAMILY:"allTxtFntFml",ALL_TEXT_FONT_STYLE:"allTxtFntStyle",ALL_ROW_COLUMN_TEXT_FONT_COLOR:"allRwColTxtFntClr",ALL_ROW_COLUMN_TEXT_FONT_SIZE:"allRwColTxtFntSz",ALL_ROW_COLUMN_TEXT_FONT_FAMILY:"allRwColTxtFntFml",ALL_ROW_COLUMN_TEXT_FONT_STYLE:"allRwColTxtFntStyle",ALL_ROW_COLUMN_TEXT_ALIGNMENT_HORIZONTAL:"allRwColTxtAlignH",ALL_ROW_COLUMN_TEXT_ALIGNMENT_VERTICAL:"allRwColTxtAlignV",ROW_TEXT_TEXT_FONT_COLOR:"rwTxtTxtFntClr",ROW_TEXT_TEXT_FONT_SIZE:"rwTxtTxtFntSz",ROW_TEXT_TEXT_FONT_FAMILY:"rwTxtTxtFntFml",ROW_TEXT_TEXT_FONT_STYLE:"rwTxtTxtFntStyle",ROW_TEXT_TEXT_ALIGNMENT_HORIZONTAL:"rwTxtTxtAlignH",ROW_TEXT_TEXT_ALIGNMENT_VERTICAL:"rwTxtTxtAlignV",COLUMN_TEXT_TEXT_FONT_COLOR:"colTxtTxtFntClr",COLUMN_TEXT_TEXT_FONT_SIZE:"colTxtTxtFntSz",COLUMN_TEXT_TEXT_FONT_FAMILY:"colTxtTxtFntFml",COLUMN_TEXT_TEXT_FONT_STYLE:"colTxtTxtFntStyle",COLUMN_TEXT_TEXT_ALIGNMENT_HORIZONTAL:"colTxtTxtAlignH",COLUMN_TEXT_TEXT_ALIGNMENT_VERTICAL:"colTxtTxtAlignV",ROW_HEADER_TEXT_FONT_COLOR:"rwHdrTxtFntClr",ROW_HEADER_TEXT_FONT_SIZE:"rwHdrTxtFntSz",ROW_HEADER_TEXT_FONT_FAMILY:"rwHdrTxtFntFml",ROW_HEADER_TEXT_FONT_STYLE:"rwHdrTxtFntStyle",ROW_HEADER_TEXT_ALIGNMENT_HORIZONTAL:"rwHdrTxtAlignH",ROW_HEADER_TEXT_ALIGNMENT_VERTICAL:"rwHdrTxtAlignV",COLUMN_HEADER_TEXT_FONT_COLOR:"colHdrTxtFntClr",COLUMN_HEADER_TEXT_FONT_SIZE:"colHdrTxtFntSz",COLUMN_HEADER_TEXT_FONT_FAMILY:"colHdrTxtFntFml",COLUMN_HEADER_TEXT_FONT_STYLE:"colHdrTxtFntStyle",COLUMN_HEADER_TEXT_ALIGNMENT_HORIZONTAL:"colHdrTxtAlignH",COLUMN_HEADER_TEXT_ALIGNMENT_VERTICAL:"colHdrTxtAlignV",ROW_VAVLUE_TEXT_FONT_COLOR:"rwVlTxtFntClr",ROW_VAVLUE_TEXT_FONT_SIZE:"rwVlTxtFntSz",ROW_VAVLUE_TEXT_FONT_FAMILY:"rwVlTxtFntFml",ROW_VAVLUE_TEXT_FONT_STYLE:"rwVlTxtFntStyle",ROW_VAVLUE_TEXT_ALIGNMENT_HORIZONTAL:"rwVlTxtAlignH",ROW_VAVLUE_TEXT_ALIGNMENT_VERTICAL:"rwVlTxtAlignV",COLUMN_VAVLUE_TEXT_FONT_COLOR:"colVlTxtFntClr",COLUMN_VAVLUE_TEXT_FONT_SIZE:"colVlTxtFntSz",COLUMN_VAVLUE_TEXT_FONT_FAMILY:"colVlTxtFntFml",COLUMN_VAVLUE_TEXT_FONT_STYLE:"colVlTxtFntStyle",COLUMN_VAVLUE_TEXT_ALIGNMENT_HORIZONTAL:"colVlTxtAlignH",COLUMN_VAVLUE_TEXT_ALIGNMENT_VERTICAL:"colVlTxtAlignV",TITLE_FONT_COLOR:"ttlFntClr",TITLE_FONT_SIZE:"ttlFntSz",TITLE_FONT_FAMILY:"ttlFntFml",TITLE_FONT_STYLE:"ttlFntStyle",COLOR_SQUARE_COLOR:"clrSqrClr",SELECTION_LIMIT:"slctnLmt",CONTAINER_FIT_MODE:"cntrFitMode",SHOW_MODEBAR:"showModeBar",MEAN_SD:"meanSD",POINT_SIZE:"ptSize",PTSZ_TYPE:"ptSzType",JITTER:"jitter",JTR_TYPE:"jtrType",POINT_POS:"ptPos",PTPOS_TYPE:"ptPosType",SHOW_OUTLIERS:"shwOutliers",CUSTOM_BINS_MODE:"custMode",MANUAL_BINS_MODE:"manualBinsMode",RANGE_TYPE:"rangeType",NUM_BINS:"numBins",XBINS_START:"xBinsStart",XBINS_END:"xBinsEnd",XBINS_SIZE:"xBinsSize",HAS_UNCHECKED_AUTO:"hasUncheckedAuto",HAS_UNCHECKED_DATASET_RANGE:"hasUncheckedDstRng",TOTAL_SHOW:"totalShw",TOTAL_LABEL:"totalLabel",INT_SUM_SHOW:"intSumShw",POSITIVE_COLOR:"posClr",NEGATIVE_COLOR:"negClr",TOTAL_COLOR:"totalClr",INT_SUM_COLOR:"intSumClr",INT_SUM_FULL:"intSumFull"};mstrmojo.gm.EnumAxis={DssAxisReserved:0,DssAxisRows:1,DssAxisColumns:2,DssAxisPages:3,DssAxisChapters:4,DssAxisAll:5};mstrmojo.gm.EnumCombinedLineStyle={NONE:99,THIN:1,THICK:2,DASHED:3,DOTTED:4};mstrmojo.gm.EnumSizeByType={SQUARE:1,CIRCLE:4};mstrmojo.gm.EnumTheme={DARK:0,LIGHT:1};mstrmojo.gm.EnumFitTo={NONE:1,AUTOMATIC:2,COMPACT:3,MANUAL:4};mstrmojo.gm.EnumAxisScale={GLOBAL:0,PERROWCOL:1,PERCELL:2,CUSTOM:3,DIFFERENT:4};mstrmojo.gm.EnumShape={GENERIC:-1,AREA:0,BAR:1,LINE:2,STEPLINE:3,CIRCLE:4,RECTANGLE:5,SQUARE:6,TICK:7,PIESLICE:8,POLYGON:9,PIE:10,RING:11,DEFAULT:12,BULLET:13};mstrmojo.gm.EnumSubtype={AUTO:1,ABSOLUTE:2,STACKED:3,CLUSTERED:4,PERCENT:5};mstrmojo.gm.EnumDataLabels={HIDE:1,SHOW_VALUE_ONLY:2,SHOW_TEXT_ONLY:3};mstrmojo.gm.EnumDataLabelPlacements={AUTOMATIC:1,GENERIC:2,RESERVED:3};mstrmojo.gm.EnumLegend={SHOW:0,HIDE:1,MINIMIZED:2};mstrmojo.gm.EnumLegendMode={RESTORED:1,MINIMIZED:2};mstrmojo.gm.EnumTextAlignH={LEFT:0,MIDDLE:1,RIGHT:2};mstrmojo.gm.EnumTextAlignV={TOP:0,MIDDLE:1,BOTTOM:2};mstrmojo.gm.EnumMaxSizeType={AUTO:1,MANUAL:2,AUTO_FIT:3};mstrmojo.gm.EnumMinSizeType={AUTO:1,MANUAL:2,PROPORTIONAL:3};mstrmojo.gm.EnumAxes={SHOW_BOTH:1,SHOW_NONE:2,SHOW_X:3,SHOW_Y:4};mstrmojo.gm.EnumMatrixLines={SHOW_ALL:1,SHOW_NONE:2,SHOW_HORIZONTAL:3,SHOW_VERTICAL:4};mstrmojo.gm.EnumGridLines={AUTO:1,SHOW:2,HIDE:3,SHOW_MAJOR_ONLY:4};mstrmojo.gm.EnumNGMGridLines={SHOW_Y:1,SHOW_X:2,SHOW:3,HIDE:4,AUTO:5};mstrmojo.gm.LineMarkerShape={Circle:4,Square:1};mstrmojo.gm.ShapeFillType={Solid:0,Gradient:14,Pattern:3};mstrmojo.gm.ShapeFillEffect={None:1,Bevel:2};mstrmojo.gm.Enum3DGMapping={SizeType:"9999_1002",SizeValue:"9999_1003",lgdBgFillClr:"6_564",lgdBgFillStyle:"6_10002",lgdBgFillEff:"6_608",lgdFntSz:"9_603",lgdFntFml:"9_576",lgdFntStyle:"9_584",lgdFntClr:"9_574",LegendVisibleness:"9999_116",xAxShw:"9999_124",xAxTtCtt:"293_9999",xAxTtFntClr:"293_574",xAxTtFntFml:"293_576",xAxTtFntStyle:"293_584",xAxLbFntSz:"272_603",xAxLbFntFml:"272_576",xAxLbFntStyle:"272_584",yAxShw:"9999_125",yAxTtCtt:"299_9999",yAxTtFntClr:"299_574",yAxTtFntFml:"299_576",yAxTtFntStyle:"299_584",yAxLbFntSz:"296_603",yAxLbFntFml:"296_576",yAxLbFntStyle:"296_584",bgFillClr:"1_564",bgFillEff:"1_879",bgFillTrans:"1_608",outBdrClr:"1_588"};mstrmojo.gm.EnumRefLineModelType={MAX:1,MIN:2,AVG:3,MED:4,FIRST:5,LAST:6,CONST:7};mstrmojo.gm.EnumTrendLineModelType={BEST_FIT:256,LINEAR:257,LOG:258,EXP:259,POW:260,POLY:261};mstrmojo.gm.EnumTrendRefLevel={DssModelLevelReserved:0,DssModelLevelPerCell:1,DssModelLevelPerRow:2,DssModelLevelPerColumn:3,DssModelLevelPerPanel:4,DssModelLevelLastOne:5};mstrmojo.gm.EnumTimeRole={None:0,YearOfDecade:3083,QuarterOfYear:2826,MonthOfYear:2825,MonthOfQuarter:2569,WeekOfYear:2824,WeekOfQuarter:2568,WeekOfMonth:2312,DayOfYear:2823,DayOfQuarter:2567,DayOfMonth:2311,DayOfWeek:2055,HourOfDay:1798,MinuteOfDay:1797,MinuteOfHour:1541,SecondOfDay:1796,SecondOfHour:1540,SecondOfMinute:1284};mstrmojo.gm.EnumTrendRefModelLabels={DssModelLabelsReserved:-1,DssModelLabelsNone:0,DssModelLabelsType:1,DssModelLabelsMetric:2,DssModelLabelsValue:4};mstrmojo.gm.EnumTRFManipulations={AddTRLine:"141",RemoveTRLine:"142",UpdateTRLine:"143",UpdateForecastInfo:"144"};mstrmojo.gm.EnumShapeFormatStatus={NORMAL:0,PER_COLORBY:1,PER_SHAPE:2};mstrmojo.gm.EnumNGMSubtype={CLUSTERED:0,STACKED:1,PERCENT:2};mstrmojo.gm.EnumBoxPlotMean={NO_MEAN:0,ONLY_MEAN:1,MEAN_STDEV:2};mstrmojo.gm.EnumBoxPlotOutliers={OUTLIERS:0,ALL_POINTS:1,JITTER:0,JTR_MAN:0.5,POINT_POS:0,POS_MAN:-1.8,POINT_SIZE:6,SIZE_MAN:10,MANUAL:1};mstrmojo.gm.EnumHistogram={AUTOMATIC:1,MANUAL:0,CUST_INPUT:2,DATASET:3,BY_BIN_SIZE:4,BY_BIN_NUMBER:5};mstrmojo.gm.EnumContainerFitModes={AUTOMATIC:0,FIT_TO_CONTAINER:1,FIT_TO_CONTENT:2};(function(){function A(C){return C.replace(/&apos;/g,"'").replace(/&quot;/g,'"').replace(/&gt;/g,">").replace(/&lt;/g,"<").replace(/&amp;/g,"&");}mstrmojo._ImageHelper=mstrmojo.provide("mstrmojo._ImageHelper",{getImage:function B(D){var E=mstrApp,C=E.getConfiguration();if(D){if(D.indexOf("\\")>=0){D=D.replace(/\\/g,"/");}D=A(D);if(D===decodeURI(D)){D=encodeURI(D);}}if(C&&D&&D.indexOf("://")===-1){D=C.getHostUrlByProject(E.getCurrentProjectId())+D;}return(mstrApp.useBinaryFormat)?String(mstrMobileApp.getImage(D)):D;}});}());(function(){mstrmojo._HasPopup=mstrmojo.provide("mstrmojo._HasPopup",{_mixinName:"mstrmojo._HasPopup",_lastOpened:null,openPopup:function A(G,E){var C=!!G&&(typeof G==="string")&&!G.match(/\./)&&!!this[G],D=mstrmojo.registry.ref(C?this[G]:G);if(D&&D.open){if(C){this[G]=D;}if(D.disposable!==false){this.addDisposable(D);}var J=D.slot&&this[D.slot];if(J){if(D.parent!==this){if(this.addChildren){this.addChildren([D]);}else{var I=false,F=D.domNode||D.placeholder;if(F&&typeof F==="string"){F=document.getElementById(F);}if(!F){I=true;F=document.createElement("span");D.placeholder=F;}if(I||(F.parentNode!==J)){J.appendChild(F);}}}}try{D.open(this,E);}catch(H){console.log("Error opening popup: "+H);}this._lastOpened=D;}},closePopup:function B(){var C=this._lastOpened;if(C&&C.visible&&C.close){C.close();delete this._lastOpened;}}});}());(function(){mstrmojo._IsGraphDataService=mstrmojo.provide("mstrmojo._IsGraphDataService",{handleUserSingleTap:function A(D,E,B,G,C,F){if(mstrApp.onMobileDevice()){mstrApp.serverRequest({taskId:"handleUserSingleTap",sliceID:D,nodekey:E,x:B,y:G,selectable:C},F);}}});}());(function(){mstrmojo.boxmodel=mstrmojo.provide("mstrmojo.boxmodel",{rangeIntersect:function E(J,H,I,G){if(J<I){return I<=H;}if(J>I){return J<=G;}return true;},px2Inches:function C(H,G){G=parseInt(G,10);return mstrmojo.NumberFormat.getInstance(mstrConfig.decimalSep,mstrConfig.thousandsSep).format(parseFloat((G/H.zf/H.dpi).toFixed(4)));},offset:function F(I,H){var L=I,G=0,K=0;while(I){G+=I.offsetLeft;K+=I.offsetTop;I=I.offsetParent;if(I===H){break;}}var J;for(J=L&&L.parentNode;J&&J!==H;J=J.parentNode){if(J.scrollTop){K-=J.scrollTop;}if(J.scrollLeft){G-=J.scrollLeft;}}return{left:G,top:K};},convert2px:function D(K,I){if(!/px$/.test(I)){var H=document.createElement("img"),G=H.style,J;G.zIndex=-1;G.left=I;K.appendChild(H);J=G.pixelLeft;K.removeChild(H);return J+"px";}return I;},getEdgeQuadrantByPoint:function B(I,H){var G=H.x-I.x,M=H.y-I.y,J=I.w,L=I.h,K=[["Left","Bottom"],["Top","Right"]];if(M>L/J*G){K=K[0];}else{K=K[1];}return(M<-L/J*G+L)?K[0]:K[1];},isPtInPolygon:function A(I,K){var G=I.x,J=I.y,H=false;K.forEach(function(N,L){var M=K[L-1]||K[K.length-1];if((N.y>=J)!==(M.y>=J)){if((G<(M.x-N.x)*(J-N.y)/(M.y-N.y)+N.x)){H=!H;}}});return H;}});}());(function(){mstrmojo.vi.ui.theme=mstrmojo.provide("mstrmojo.vi.ui.theme",{getThemeClass:function A(){var D=this.parent||this.opener,C="",B;while(D){var E=D.themeClassName;if(E){C=E;break;}B=D.parent||D.opener;if(B===D){break;}D=B;}return C;}});}());(function(){mstrmojo.vi._MonitorsLayoutMode=mstrmojo.provide("mstrmojo.vi._MonitorsLayoutMode",{onLayoutModeChange:function(B){if(this._super){this._super(B);}},init:function A(B){this._super(B);if(mstrApp.attachEventListener){mstrApp.attachEventListener("layoutModeChange",this.id,"onLayoutModeChange");}}});}());mstrmojo.vi.viz.EnumVisualizationTemplates={UNKNOWN_GRAPHMATRIX_TYPE:-1,GRID:0,HEATMAP:1,GOOGLEMAP:2,PIE:3,RING:4,GRAPHMATRIXVERTICALBARSTACKED:6,GRAPHMATRIXVERTICALBARCLUSTERED:7,GRAPHMATRIXVERTICALBARPERCENT:8,GRAPHMATRIXHORIZONTALBARSTACKED:9,GRAPHMATRIXHORIZONTALBARCLUSTERED:10,GRAPHMATRIXHORIZONTALBARPERCENT:11,GRAPHMATRIXVERTICALLINESTACKED:12,GRAPHMATRIXVERTICALLINECLUSTERED:13,GRAPHMATRIXVERTICALLINEPERCENT:14,GRAPHMATRIXHORIZONTALLINESTACKED:15,GRAPHMATRIXHORIZONTALLINECLUSTERED:16,GRAPHMATRIXHORIZONTALLINEPERCENT:17,GRAPHMATRIXSCATTERCIRCLEMM:18,GRAPHMATRIXSCATTERGRIDCIRCLEAA:19,GRAPHMATRIXBUBBLECIRCLEMM:21,GRAPHMATRIXBUBBLEGRIDCIRCLEAA:22,GRAPHMATRIXSCATTERSQUAREAM:23,GRAPHMATRIXSCATTERSQUAREMM:24,GRAPHMATRIXSCATTERGRIDSQUAREAA:25,GRAPHMATRIXBUBBLESQUAREAM:26,GRAPHMATRIXBUBBLESQUAREMM:27,GRAPHMATRIXBUBBLEGRIDSQUAREAA:28,GRAPHHORIZONTALBARCLUSTERED:29,GRAPHMATRIXVERTICALAREASTACKED:30,GRAPHMATRIXVERTICALAREAPERCENT:31,GRAPHMATRIXVERTICALAREACLUSTERED:32,GRAPHMATRIXHORIZONTALAREASTACKED:40,GRAPHMATRIXHORIZONTALAREAPERCENT:41,GRAPHMATRIXHORIZONTALAREACLUSTERED:42,GRAPHHORIZONTALBARDUALAXISCLUSTERED:33,GRAPHHORIZONTALBARDUALAXISABSOLUTE:34,GRAPHHORIZONTALLINEABSOLUTE:35,GRAPHHORIZONTALLINEDUALAXISABSOLUTE:36,GRAPHHORIZONTALAREAABSOLUTE:37,GRAPHHORIZONTALAREADUALAXISABSOLUTE:38,GRAPHVERTICALBARCLUSTERED:39,GRAPHVERTICALBARDUALAXISCLUSTERED:43,GRAPHVERTICALBARDUALAXISABSOLUTE:44,GRAPHVERTICALBARDUALAXISSTACKED:45,GRAPHVERTICALLINEABSOLUTE:46,GRAPHVERTICALLINESTACKED:47,GRAPHVERTICALLINEPERCENT:48,GRAPHVERTICALLINEDUALAXISABSOLUTE:49,GRAPHVERTICALLINEDUALAXISSTACKED:50,GRAPHVERTICALAREAABSOLUTE:51,GRAPHVERTICALAREAPERCENT:52,GRAPHVERTICALAREASTACKED:53,GRAPHVERTICALAREADUALAXISABSOLUTE:54,GRAPHVERTICALAREADUALAXISSTACKED:55,GRAPHCOMBINATIONBARAREA:56,GRAPHCOMBINATIONBARAREADUALAXIS:57,NETWORK:58,IMAGELAYOUT:59,GOOGLEMAPDENSITY:60,GRAPHMATRIXPIE:61,GRAPHMATRIXRING:62,GRAPHHORIZONTALBARABSOLUTE:63,GRAPHHORIZONTALBARPERCENT:64,GRAPHHORIZONTALBARSTACKED:65,GRAPHVERTICALBARABSOLUTE:66,GRAPHVERTICALBARPERCENT:67,GRAPHVERTICALBARSTACKED:68,ESRIMAP:69,GRAPHMATRIXVERTICALBARAUTOMATIC:70,GRAPHMATRIXHORIZONTALBARAUTOMATIC:71,GRAPHMATRIXVERTICALLINEAUTOMATIC:72,GRAPHMATRIXHORIZONTALLINEAUTOMATIC:73,GRAPHMATRIXVERTICALAREAAUTOMATIC:74,GRAPHMATRIXHORIZONTALAREAAUTOMATIC:75,GRAPHMATRIXVERTICALHISTOGRAM:76,GRAPHMATRIXGRIDCHART:78,GRAPHMATRIXVERTICALBOXPLOT:79,GRAPHMATRIXHORIZONTALBOXPLOT:80,GRAPHMATRIXVERTICALWATERFALL:81,GRAPHMATRIXHORIZONTALWATERFALL:82,KPICARD:83};var T=mstrmojo.vi.viz.EnumVisualizationTemplates;mstrmojo.vi.viz.EnumAggregatedVisTemplates={COMBOCHART:[T.GRAPHHORIZONTALBARDUALAXISCLUSTERED,T.GRAPHHORIZONTALBARDUALAXISABSOLUTE,T.GRAPHHORIZONTALLINEDUALAXISABSOLUTE,T.GRAPHHORIZONTALAREADUALAXISABSOLUTE,T.GRAPHVERTICALBARDUALAXISCLUSTERED,T.GRAPHVERTICALBARDUALAXISABSOLUTE,T.GRAPHVERTICALBARDUALAXISSTACKED,T.GRAPHVERTICALLINEDUALAXISABSOLUTE,T.GRAPHVERTICALLINEDUALAXISSTACKED,T.GRAPHVERTICALAREADUALAXISABSOLUTE,T.GRAPHVERTICALAREADUALAXISSTACKED,T.GRAPHCOMBINATIONBARAREADUALAXIS,T.GRAPHCOMBINATIONBARAREA],BUBBLECHART:[T.GRAPHMATRIXSCATTERCIRCLEMM,T.GRAPHMATRIXSCATTERGRIDCIRCLEAA,T.GRAPHMATRIXBUBBLECIRCLEMM,T.GRAPHMATRIXBUBBLEGRIDCIRCLEAA,T.GRAPHMATRIXSCATTERSQUAREAM,T.GRAPHMATRIXSCATTERSQUAREMM,T.GRAPHMATRIXSCATTERGRIDSQUAREAA,T.GRAPHMATRIXBUBBLESQUAREAM,T.GRAPHMATRIXBUBBLESQUAREMM,T.GRAPHMATRIXBUBBLEGRIDSQUAREAA],BARCHART:[T.GRAPHMATRIXVERTICALBARSTACKED,T.GRAPHMATRIXVERTICALBARCLUSTERED,T.GRAPHMATRIXVERTICALBARPERCENT,T.GRAPHMATRIXHORIZONTALBARSTACKED,T.GRAPHMATRIXHORIZONTALBARCLUSTERED,T.GRAPHMATRIXHORIZONTALBARPERCENT,T.GRAPHHORIZONTALBARCLUSTERED,T.GRAPHVERTICALBARCLUSTERED,T.GRAPHHORIZONTALBARABSOLUTE,T.GRAPHHORIZONTALBARPERCENT,T.GRAPHHORIZONTALBARSTACKED,T.GRAPHVERTICALBARABSOLUTE,T.GRAPHVERTICALBARPERCENT,T.GRAPHVERTICALBARSTACKED,T.GRAPHMATRIXVERTICALBARAUTOMATIC,T.GRAPHMATRIXHORIZONTALBARAUTOMATIC],LINECHART:[T.GRAPHMATRIXVERTICALLINESTACKED,T.GRAPHMATRIXVERTICALLINECLUSTERED,T.GRAPHMATRIXVERTICALLINEPERCENT,T.GRAPHMATRIXHORIZONTALLINESTACKED,T.GRAPHMATRIXHORIZONTALLINECLUSTERED,T.GRAPHMATRIXHORIZONTALLINEPERCENT,T.GRAPHHORIZONTALLINEABSOLUTE,T.GRAPHVERTICALLINEABSOLUTE,T.GRAPHVERTICALLINESTACKED,T.GRAPHVERTICALLINEPERCENT,T.GRAPHMATRIXVERTICALLINEAUTOMATIC,T.GRAPHMATRIXHORIZONTALLINEAUTOMATIC],PIECHART:[T.PIE,T.RING,T.GRAPHMATRIXPIE,T.GRAPHMATRIXRING],AREACHART:[T.GRAPHMATRIXVERTICALAREASTACKED,T.GRAPHMATRIXVERTICALAREAPERCENT,T.GRAPHMATRIXVERTICALAREACLUSTERED,T.GRAPHMATRIXHORIZONTALAREASTACKED,T.GRAPHMATRIXHORIZONTALAREAPERCENT,T.GRAPHMATRIXHORIZONTALAREACLUSTERED,T.GRAPHHORIZONTALAREAABSOLUTE,T.GRAPHVERTICALAREAABSOLUTE,T.GRAPHVERTICALAREAPERCENT,T.GRAPHVERTICALAREASTACKED,T.GRAPHMATRIXVERTICALAREAAUTOMATIC,T.GRAPHMATRIXHORIZONTALAREAAUTOMATIC],HISTOGRAM:[T.GRAPHMATRIXVERTICALHISTOGRAM,],BOXPLOT:[T.GRAPHMATRIXVERTICALBOXPLOT,T.GRAPHMATRIXHORIZONTALBOXPLOT],WATERFALL:[T.GRAPHMATRIXVERTICALWATERFALL,T.GRAPHMATRIXHORIZONTALWATERFALL]};mstrmojo.mstr.EnumFunction={FunctionCustom:-1,FunctionReserved:0,FunctionPlus:1,FunctionMinus:2,FunctionTimes:3,FunctionDivide:4,FunctionUnaryMinus:5,FunctionEquals:6,FunctionNotEqual:7,FunctionGreater:8,FunctionLess:9,FunctionGreaterEqual:10,FunctionLessEqual:11,FunctionSum:12,FunctionCount:13,FunctionAvg:14,FunctionMin:15,FunctionMax:16,FunctionBetween:17,FunctionLike:18,FunctionAnd:19,FunctionOr:20,FunctionNot:21,FunctionIn:22,FunctionRank:23,FunctionAbs:24,FunctionRunningSum:25,FunctionRunningAvg:26,FunctionMovingSum:28,FunctionMovingAvg:27,FunctionProduct:29,FunctionMedian:30,FunctionMode:31,FunctionStdev:32,FunctionVar:33,FunctionGeomean:34,FunctionEqualEnhanced:35,FunctionNotEqualEnhanced:36,FunctionGreaterEqualEnhanced:37,FunctionLessEqualEnhanced:38,FunctionBetweenEnhanced:39,FunctionBanding:40,FunctionBandingC:41,FunctionBandingP:42,FunctionNotLike:43,FunctionNotBetween:44,FunctionIntersect:45,FunctionIntersectIn:46,FunctionNullToZero:47,FunctionZeroToNull:48,FunctionApplySimple:49,FunctionApplyAggregation:50,FunctionApplyLogic:51,FunctionApplyComparison:52,FunctionApplyRelative:53,FunctionIsNull:54,FunctionIsNotNull:55,FunctionUcase:56,FunctionNotIn:57,FunctionNTile:58,FunctionPercentile:59,FunctionMovingMax:60,FunctionMovingMin:61,FunctionMovingDifference:62,FunctionMovingStdev:63,FunctionExpWghMovingAvg:64,FunctionMovingCount:65,FunctionRunningMax:66,FunctionRunningMin:67,FunctionRunningStdev:68,FunctionRunningCount:69,FunctionExpWghRunningAvg:70,FunctionNotBetweenEnhanced:71,FunctionConcat:72,FunctionFirstInRange:73,FunctionLastInRange:74,FunctionValueSegment:75,FunctionContains:76,FunctionBeginsWith:77,FunctionEndsWith:78,FunctionNotContains:79,FunctionNotBeginsWith:80,FunctionNotEndsWith:81,FunctionCase:82,FunctionCaseV:83,FunctionStdevP:84,FunctionRunningStdevP:85,FunctionMovingStdevP:86,FunctionNTileS:87,FunctionNTileVS:88,FunctionVarP:89,FunctionCurrentDate:90,FunctionDayOfMonth:91,FunctionDayOfWeek:92,FunctionDayOfYear:93,FunctionWeek:94,FunctionMonth:95,FunctionQuarter:96,FunctionYear:97,FunctionCurrentDateTime:98,FunctionCurrentTime:99,FunctionHour:100,FunctionMinute:101,FunctionSecond:102,FunctionMilliSecond:103,FunctionConcatNoBlank:104,FunctionLength:105,FunctionLower:106,FunctionLTrim:107,FunctionPosition:108,FunctionRTrim:109,FunctionSubStr:110,FunctionInitCap:111,FunctionTrim:112,FunctionRightStr:113,FunctionLeftStr:114,FunctionGreatest:115,FunctionLeast:116,FunctionFirst:117,FunctionLast:118,FunctionAdd:134,FunctionAverage:135,FunctionMultiply:136,FunctionBandingM:137,FunctionOLAPSum:138,FunctionOLAPAvg:139,FunctionOLAPCount:140,FunctionOLAPMax:141,FunctionOLAPMin:142,FunctionLag:143,FunctionLead:144,FunctionPercentRank:166,FunctionConcatAgg:177,FunctionTuple:1000};mstrmojo.warehouse.EnumObjectTypes={FILTER:1,METRIC:4,ATTRIBUTE:12,FACT:13,DIMENSION:14,TABLE:15,TABLE_LOGICAL_VIEW:151,TABLE_PARTITION:152,FORM:21,COLUMN:26,DBROLE:29,PROJECT:32,TRANSFORMATION:43,DBTABLE:53,LAYER:70,RELATIONSHIP:99,COMPOUND_FORM:1001,RELATIONSHIP_ATTRIBUTE:1002};mstrmojo.vi.viz.EnumWidgetTypes={GRID:0,GRAPH_MATRIX:1,HEATMAP:2,NETWORK:3,IMAGELAYOUT:4,ESRIMAP:5,GOOGLEMAP:6,CUSTOM:7,MAPBOX:8,KPICARD:9};(function(){mstrmojo.qb.OneTierServerTransport={serverRequest:function A(E,D,C){window.FormWrapper.serverRequest(D,JSON.stringify(C.params),E,"response");},cancelRequest:function B(C){return false;}};}());mstrmojo.EnumAuthenticationModes={DEFAULT:0,STANDARD:1,NTCREDENTIAL:2,PASSTHRU:4,ANONYMOUS:8,LDAP:16,DATABASE:32,PLUGIN:64,INTEGRATED:128,USHER:256};mstrmojo.vi.enums.EnumFilterClearActionType={CLEAR_ALL:0,CLEAR_KEEP_ONLY:1,CLEAR_ADV_QUALIFICATION:2,CLEAR_LINKING:3,CLEAR_KEEP_ONLY_AND_LINKING:4,CLEAR_DRILLING:5};mstrmojo.warehouse.EnumDataChangeEvents={DBROLES_REQUESTED:"dbRolesRequested",DBROLES_LOADED:"dbRolesLoaded",DBROLES_ADD:"dbRoleAdd",DBROLES_RENAME:"dbRoleRename",DBROLES_DELETE:"dbRoleDelete",DBROLE_SELECTION:"dbroleSelection",NAMESPACES_CHANGED:"namespacesChanged",NAMESPACES_REQUESTED:"namespacesRequested",NAMESPACES_CANCELED:"namespacesCanceled",TABLES_CANCELED:"tablesCanceled",DBTABLES_CHANGED:"dbTablesChange",DBTABLES_REQUESTED:"dbTablesRequested",DBTABLE_UPDATED:"dbTableUpdated",DBROLE_CHANGED:"dbRoleChanged",DBTABLES_USED:"dbTablesUsed",DBTABLES_ENABLED:"dbTablesEnabled"};(function(){var I=mstrmojo.warehouse.EnumDataChangeEvents;mstrmojo.qb.bigquery._BigQueryController=mstrmojo.provide("mstrmojo.qb.bigquery._BigQueryController",{loadDBRoles:function G(J){this.model.loadDBRoles(J);},getNameSpaces:function C(J){this.model.selectedDataset=undefined;this.model.getDatasets(J);},setSelectedDBRoleID:function F(J){this.model.set("selectedProject",J.id);},setNameSpaceID:function D(J){this.model.set("selectedDataset",J);},handleLogout:function E(){mstrApp.container.unloadQB();mstrApp.getRootController().afterBigQueryProcess(false);},handleDBTableRefresh:function A(){var J=this.model,K=J.selectedProject;if(!K||!J.selectedDataset){return ;}J.catalogRefresh=true;J.getDatasetTables({blockBegin:0,blockCount:1000,filterText:""});},availableTableSearch:function B(J){this.model.getDatasetTables({blockBegin:0,blockCount:1000,filterText:J});},getProjectPrimaryDBRoleID:function H(){return this.model.selectedProject;},});}());mstrmojo.mstr.EnumDataType={DataTypeUnknown:-1,DataTypeReserved:0,DataTypeInteger:1,DataTypeUnsigned:2,DataTypeNumeric:3,DataTypeDecimal:4,DataTypeReal:5,DataTypeDouble:6,DataTypeFloat:7,DataTypeChar:8,DataTypeVarChar:9,DataTypeLongVarChar:10,DataTypeBinary:11,DataTypeVarBin:12,DataTypeLongVarBin:13,DataTypeDate:14,DataTypeTime:15,DataTypeTimeStamp:16,DataTypeShort:21,DataTypeLong:22,DataTypeMBChar:23,DataTypeBool:24,DataTypePattern:25,DataTypeBigDecimal:30,DataTypeCellFormatData:31,DataTypeInt64:34};mstrmojo.mstr.EnumNodeDimty={NodeDimtyReserved:0,NodeDimtyNone:1,NodeDimtyContinuation:2,NodeDimtyExclusiveContinuation:3,NodeDimtyOutputLevel:4,NodeDimtyBreakBy:5,NodeDimtyEmbedded:6,NodeDimtyUnspecified:7};mstrmojo.chart.model.enums.EnumDSSBaseFormType={DssBaseFormReserved:0,DssBaseFormDateTime:1,DssBaseFormNumber:2,DssBaseFormText:3,DssBaseFormPicture:4,DssBaseFormUrl:5,DssBaseFormEmail:6,DssBaseFormHTMLTag:7,DssBaseFormDate:8,DssBaseFormTime:9,DssBaseFormSymbol:10,DssBaseFormBigDecimal:11};mstrmojo.vi.enums.EnumVisFilterType={KEEP_ONLY:0,ADV_QUALIFICATION:1,LINKING:2,DRILLING:3};mstrmojo.chart.enums.EnumFontStyle={FS_NORMAL:0,FS_BOLD:1,FS_ITALIC:2,FS_BOTH:3,FS_UNDERLINE:4,FS_STRIKETHROUGH:8};(function(){var A=/^mstrmojo./;mstrmojo.DynamicClassFactory={newComponent:function(C,B,F){var H=C.prototype.scriptClass.replace(A,"");for(var E=0,D=B&&B.length||0;E<D;E++){if(!B[E]._mixinName){throw new Error('Mixins must have a "_mixinName" property to be used with DynamicClassFactory');}H+="_"+B[E]._mixinName.replace(A,"");}var G=mstrmojo[H];if(!G){G=mstrmojo.declare(C,B,F);mstrmojo[H]=G;}return G;}};}());mstrmojo.vi.enums.EnumFeatures={SUPPORT_RESPONSIVE:"support-responsive",SUPPORT_RESPONSIVE_RESIZING:"support-responsive-resizing",SUPPORT_GHOST_IMG:"support-ghost-img",SUPPORT_NLP:"use-natural-language",SUPPORT_CONDITION_METRIC:"support_condition_metric",USE_WORKSTATION_NAMING_STYLE:"use-workstation-naming-style",SUPPORT_TOC_UPDATEPOISITION:"support-toc-updatePosition",SUPPORT_LIVEMODE:"support-livemode",NUMBER_FORMATTING:"number-formatting",SAVE_ANALYSIS:"save-analysis",INSERT_NEW_METRIC:"insert-new-metric",DATA_ENGINE_VERSION:"data-engine-version",WEB_DRILL_AND_LINK:"web-drill-and-link",WEB_IMPORT_DATABASE:"web-import-database"};mstrmojo.mstr.EnumDSSXMLObjectTypes={Generic:-2,Unknown:-1,Reserved:0,Filter:1,Template:2,ReportDefinition:3,Metric:4,Style:6,AggMetric:7,Folder:8,SubscriptionDevice:9,Prompt:10,Function:11,Attribute:12,Fact:13,Dimension:14,Table:15,DatamartReport:16,FactGroup:17,Shortcut:18,Resolution:19,Monitor:20,AttributeForm:21,Schema:22,Format:23,Catalog:24,CatalogDefn:25,Column:26,PropertySet:28,DBRole:29,DBLogin:30,DBConnection:31,Project:32,ServerDef:33,User:34,Configuration:36,Request:37,Script:38,Search:39,SearchFolder:40,Datamart:41,FunctionPackageDefinition:42,Role:43,SecurityRole:44,Locale:45,Consolidation:47,ConsolidationElement:48,ScheduleEvent:49,ScheduleObject:50,ScheduleTrigger:51,Link:52,DbTable:53,TableSource:54,DocumentDefinition:55,DrillMap:56,DBMS:57,MDSecurityFilter:58,PromptAnswer:59,PromptAnswers:60,ObjectTag:65,ReservedLastOne:66};(function(){mstrmojo.cookies={};var C="%26",E="%3D",B=mstrmojo.cookies,D=function(){var F=document.cookie;if(!F||!(typeof F==="string")||F.indexOf("bSet")<0){return false;}return true;},A=function(){var F=document.cookie;F=F.split(";");for(s in F){if(F[s].indexOf("bSet")>=0){return F[s];}}return null;};mstrmojo.cookies.updateCookieSetting=function(H,N,J){try{if(!D()&&!J){return ;}var K=document.cookie,M=H+E+N+C;if(K.indexOf(H)>=0){var F=H+E,G=F+(B.getCookieSetting(H)||0),I=F+N;if(I!=G){document.cookie=K.replace(G,I);}}else{if(K.indexOf("bSet")>=0){document.cookie=K.replace("bSet=","bSet="+M);}else{if(J){document.cookie="bSet="+M+";"+K;}}}}catch(L){mstrmojo.alert(L);return ;}};mstrmojo.cookies.getCookieSetting=function(F){try{return B.getCookieList()[F];}catch(G){mstrmojo.alert(G);return ;}};mstrmojo.cookies.getCookieList=function(){try{if(!D()){return[];}var G=A(),F={},H=null;G=G.replace("bSet=","").split(C);for(H in G){H=G[H].split(E);F[H[0]]=H[1];}return F;}catch(I){mstrmojo.alert(I);return ;}};mstrmojo.cookies.enabledCookieOnBrowser=function(){var F=document.cookie;if(!F||!(typeof F==="string")){return false;}return true;};})();mstrmojo.mstr.EnumDSSConsolidationType={DssNormal:0,DssDerivedElement:1,DssRecursiveDerivedElement:2};mstrmojo.vi.models.EnumDragSources={DATASETS:1,VIZ_EDITOR:2,FILTERS:3,ALL_OBJECT_LIST:4,VIZ:5,TOC_CHAPTER:6,TOC_PAGES_LIST:7,VIZ_LAYER:8};mstrmojo.mstr.EnumNodeProperties={NORMAL:0,DRILL:1,CONDITION:2};mstrmojo.warehouse.EnumDatabaseType={SAP:1200,MSAS:1500,EssBase:1600,TM1:2900,SAPHana:4000,BDE:5400,SearchEngineSOLR:5500,Hive:3100,Impala:4100,SearchEngineSPLUNK:5600,Pig:6400,PHOENIX:6800,IBMBigInsights:700,Drill:7300,DB_TYPE_NEWDB_1:8100,DB_TYPE_NEWDB_5:8500,AzureCosmosDB:8700};(function(){var C="xviPopopNode";function A(G){var H={};H[C]=G;return H;}mstrmojo.ui.menus._IsMenuPopup=mstrmojo.provide("mstrmojo.ui.menus._IsMenuPopup",{init:function E(G){this._super(G);var J=this.popupConfig;if(!J){throw new Error("Cannot instantiate popup without supplying the popupConfig property.");}this.addDisposable(J);var H=mstrmojo.all[J.hostId],I=J.hostElement;if(J.isHostedWithin&&H&&I){H.addSlots(A(I));this.slot=C;}},closeAllMenus:function F(){var G=this.opener;if(G&&G.closePopup){G.closePopup();}if(G&&G.closeAllMenus){G.closeAllMenus();}},open:function B(H,G){if(this._super){this._super(H,G);}},close:function D(G){if(this.slot===C){this.opener.removeSlots(A(null));}if(this._super){this._super(G);}var H=mstrmojo.all[this.popupConfig.hostId];if(H){H.closePopup();}this.destroy();}});}());mstrmojo.mstr.EnumDSSXMLTokenTypes={EndOfInput:-1,Reserved:0,Error:1,Unknown:2,Empty:3,ExclamationPoint:33,NumberSign:35,Dollar:36,Percent:37,Ampersand:38,LeftParen:40,RightParen:41,Asterisk:42,PlusSign:43,Comma:44,MinusSign:45,Dot:46,FwdSlash:47,Colon:58,Semicolon:59,LeftAngleBracket:60,EqualSign:61,RightAngleBracket:62,QuestionMark:63,AtSign:64,LeftSquareBracket:91,RightSquareBracket:93,Caret:94,Underscore:95,LeftAccolade:123,VerticalBar:124,RightAccolade:125,Tilda:126,Literal:258,Identifier:259,Reserved1:260,DoubleQString:261,Integer:262,Float:263,AttrRef:264,DimRef:265,MetricRef:266,AggMetricRef:267,FactRef:268,ReportRef:269,FilterRef:270,RoleRef:271,TableRef:272,PromptRef:273,ColumnRef:274,AttrFormRef:275,DimFormRef:276,SimpInfixFun1:277,SimpInfixFun2:278,SimpPrefixFun:279,AggFun:280,RelativeFun:281,CompareFun:282,AndFun:283,OrFun:284,NotFun:285,BoolPrefixFun:286,IntersectFun:287,Reserved2:288,InSetFun:289,BetweenFun:290,LikeFun:291,EnhCompareFun:292,EnhBetweenFun:293,ArrowUp:294,ArrowDown:295,ArrowUpDown:296,AggFirstInFact:297,AggLastInFact:298,KwdTrue:299,KwdFalse:300,KwdBreakBy:301,KwdSortBy:302,KwdFactID:303,DateTime:304,CaseFun:305,FreeVariable:306,LongNumber:307,RWMetricRef:308,CSQLRef:309,ConsolidationRef:310,DssTokenTypeKwdCSIUpdate:312,DssTokenTypeKwdCSISet:313,DssTokenTypeKwdCSIInsert:314,DssTokenTypeKwdCSIDelete:315,DssTokenTypeKwdCSIWhere:316,DssTokenTypeKwdCSIInto:317,DssTokenTypeKwdCSIValues:318,DssTokenTypeKwdCSIFrom:319,DssTokenTypeCSIFieldUnit:321,Elements:323,ConsolidationElementRef:324,EndOfTypes:340};if(!mstrmojo.LoadedExternalJSURLs){mstrmojo.LoadedExternalJSURLs={};}function LoadScriptsExternalJSCallback(){mstrmojo.LoadedExternalJSURLs[mstrmojo._LoadsScript.esScripts.splice(0,1)[0].url]=true;mstrmojo._LoadsScript.requiresExternalScripts(mstrmojo._LoadsScript.esScripts,mstrmojo._LoadsScript.callback,mstrmojo._LoadsScript.esScritsContext);mstrmojo._LoadsScript.ExternalJSCallbackIsBusy=false;}if(!mstrmojo._LoadsScript){mstrmojo._LoadsScript=mstrmojo.provide("mstrmojo._LoadsScript",{_meta_usesSuper:false,requiresMethod:function requiresMethod(B){if(!B){return false;}if(typeof this[B]==="function"){return true;}var A=this[B]||(this.methods&&(this.methods[B]||this.methods["*"]));if(typeof A==="string"){this.requiresCls(A);return typeof this[B]==="function";}return false;},requiresCls:function req(mixins,callback){if(mixins){if(typeof mixins==="string"){mixins=[mixins];}mstrmojo.requiresCls.apply(mstrmojo,mixins);var p=this.constructor.prototype,pm=p.mixins;if(!pm){p.mixins={};pm=p.mixins;}var mx=mstrmojo.mixin,i,len;for(i=0,len=mixins.length;i<len;i++){var fqcn=mixins[i];if(!pm[fqcn]){var m=eval(mixins[i]);mx(m,p);pm[fqcn]=true;if(m.__onmixin__){m.__onmixin__.apply(this,[]);}}}if(callback){callback.apply(this,[]);}}},requiresContrib:function reqCb(C,B){var A=this[C];if(A){var E,D=false;if(typeof A==="string"){E=mstrmojo.registry.ref(A);this[C]=E;D=true;}else{E=A;}if(E&&(D||B)){E.parent=this;if(E.startup){E.startup();}}return E;}return null;},requiresExternalScripts:function requiresExternalScripts(G,H,C){if(G&&G instanceof Array){if(G.length===0){if(H){H.call(C);}return false;}if(G[0]&&G[0].forceReload===false&&mstrmojo.LoadedExternalJSURLs[G[0].url]){G.splice(0,1);return this.requiresExternalScripts(G,H,C);}var A=document.createElement("script"),D=!!document.all,B=G[0].url,F=G[0].onError;if(B.substr(0,7)==="file://"){B=B.substr(7);}else{if(mstrApp.isSingleTier&&B.substr(0,4)!=="http"){B="http:"+B;}}A.type="text/javascript";A.src=B;if(F){A.onerror=function(){if(F&&F.callback&&C){F.callback.call(C,F.params);}};}if(!G[0].callbackParamName){if(D){A.onreadystatechange=function(){if(A.readyState==="loaded"||A.readyState==="complete"){A.onreadystatechange=null;A.onerror=null;if(G.length>1){mstrmojo.LoadedExternalJSURLs[G.splice(0,1)[0].url]=true;mstrmojo._LoadsScript.requiresExternalScripts(G,H,C);}else{if(G.length===1){mstrmojo.LoadedExternalJSURLs[G[0].url]=true;if(H){H.call(C);}}}}};}else{A.onload=function(){A.error=null;A.onload=null;if(G.length>1){mstrmojo.LoadedExternalJSURLs[G.splice(0,1)[0].url]=true;mstrmojo._LoadsScript.requiresExternalScripts(G,H,C);}else{if(G.length===1){mstrmojo.LoadedExternalJSURLs[G[0].url]=true;if(H){H.call(C);}}}};}}else{if(G[0].callbackParamName.length!==0){if(mstrmojo._LoadsScript.ExternalJSCallbackIsBusy&&mstrmojo._LoadsScript.ExternalJSCallbackIsBusy===true){var E=this;window.setTimeout(function(){E.requiresExternalScripts(G,H,C);},500);return ;}mstrmojo._LoadsScript.ExternalJSCallbackIsBusy=true;A.src+="&"+G[0].callbackParamName+"=LoadScriptsExternalJSCallback";mstrmojo._LoadsScript.esScripts=G;mstrmojo._LoadsScript.callback=H;mstrmojo._LoadsScript.esScritsContext=C;}}document.getElementsByTagName("head")[0].appendChild(A);}}});}(function(){mstrmojo.requiresCls("mstrmojo.vi.models.EnumDragSources");function D(H){this.cleanUpAfterTarget(H);var G=H.tgtData;if(G){delete H.tgtData;}var I=this.getContextDragData(H);if(I&&I.setAvatarClass){I.setAvatarClass("");}}mstrmojo.vi.ui._IsDropTarget=mstrmojo.provide("mstrmojo.vi.ui._IsDropTarget",{_mixinName:"mstrmojo.vi.ui._IsDropTarget",dropZone:true,getDropAvatarIcon:function B(G){return"add";},getContextDragData:function F(G){return G.getCtxtDragData();},cleanUpAfterTarget:mstrmojo.emptyFn,ondragenter:function A(G){var H=this.getContextDragData(G);if(H&&H.setAvatarClass){H.setAvatarClass(this.getDropAvatarIcon(G));}if(this._super){this._super(G);}},ondragleave:function E(G){D.call(this,G);if(this._super){this._super(G);}},ondrop:function C(G){D.call(this,G);if(this._super){this._super(G);}}});}());(function(){mstrmojo.requiresCls("mstrmojo.EnumAuthenticationModes");var A=mstrmojo.EnumAuthenticationModes;function C(G){var H,F,E={success:function(I){H=I.identityToken;},complete:function(){if(H){G=G+"?idToken="+H;}F.location.href=G;}};if(mstrConfig.seamlessLoginEnabled){if(mstrConfig.authMode===A.INTEGRATED.toString()){G+="?loginMode="+A.INTEGRATED;window.open(G,"_blank");}else{F=window.open();mstrmojo.xhr.request("GET",mstrConfig.taskURL,E,{taskId:"createIdentityToken"});}}else{window.open(G,"_blank");}}function D(){return mstrConfig&&mstrConfig.features&&mstrConfig.features["show-dossier-library-link"]&&!!mstrConfig.libraryWebBaseURL;}function B(F){var E=mstrConfig.libraryWebBaseURL+"app";if(F){E+="/"+mstrConfig.projectId+"/"+F;}return E;}mstrmojo.util.LibraryHelper=mstrmojo.provide("mstrmojo.util.LibraryHelper",{createTokenAndOpenLink:C,isLibraryConfigured:D,constructLibraryUrl:B});})();mstrmojo.requiresCls("mstrmojo.gm.GMEnums");var $GM=mstrmojo.gm,CHART_TYPE=$GM.EnumGraphType,PRP_DATA_LABELS=$GM.EnumDataLabels,PRP_LEGEND=$GM.EnumLegend,PRP_MIN_SIZE_TYPE=$GM.EnumMinSizeType,PRP_FIT_TO=$GM.EnumFitTo,ENUM_FIT_MODES=$GM.EnumContainerFitModes,NGM_GRID_LINE=$GM.EnumNGMGridLines;var ARIAL="Arial",OPEN_SANCE="Open Sans",ALL="ALL";var ENUM_LAYOUT_THEME={DEFAULT:"spatial",CLASSIC:"classic"};var classicProps={THEME_STYLE:ENUM_LAYOUT_THEME.CLASSIC,LAYOUT:{allFF:ARIAL,titleFF:ARIAL,dlvPadding:2,dlvMargin:4,dlvLOH_Compensation:1,ucTBLOHeight:1,drpChildPadding:4,drpLOHW_Compensation:0,cueBottomOffset:1},GRID:{paddingSize:5,mRatio:2,lRatio:3,gridTemplateVisible:false},HEATMAP:{smallGap:2,middleGap:4,largeGap:6,largerGap:8},NGM:{GENERAL_PROPS:(function(){var A={};A[ALL]={dataLabels:PRP_DATA_LABELS.HIDE};return A;}()),DEFAULT_PROPS:(function(){var A={};A[ALL]={cntrFitMode:ENUM_FIT_MODES.AUTOMATIC};return A;}())},OGM:{GENERAL_PROPS:(function(){var A={};A[ALL]={dataLabels:PRP_DATA_LABELS.HIDE,minRowHeight:20,fitTo:PRP_FIT_TO.AUTOMATIC};return A;}()),DEFAULT_PROPS:(function(){var A={};A[ALL]={};A[CHART_TYPE.BAR]={shpBdrThk:1,shpBdrStyle:0};A[CHART_TYPE.PIE]={shpBdrThk:1,shpBdrStyle:0};A[CHART_TYPE.GRID]={shpFillTrans:70};return A;}())},KPI:{fontFamily:ARIAL,defaultFontClr:{1:"#444649",2:"#FFFFFF",3:"#FFFFFF",4:"#FFFFFF"}}},defaultProps={THEME_STYLE:ENUM_LAYOUT_THEME.DEFAULT,LAYOUT:{allFF:OPEN_SANCE,titleFF:OPEN_SANCE,dlvPadding:0,dlvMargin:0,dlvLOH_Compensation:0,ucTBLOHeight:0,drpChildPadding:12,drpLOHW_Compensation:12,cueBottomOffset:-2},GRID:{paddingSize:4.52,mRatio:1050/452,lRatio:1205/452,gridTemplateVisible:true},HEATMAP:{smallGap:1,middleGap:3,largeGap:5,largerGap:5,cellTextSize:11,fontFamily:"Open Sans SemiBold",leftPadding:10,topPadding:8,lineHeightTime:1.3,marginTop:"3px"},NGM:{GENERAL_PROPS:(function(){var A={};A[ALL]={dataLabels:PRP_DATA_LABELS.HIDE};A[CHART_TYPE.WATERFALL]={dataLabels:PRP_DATA_LABELS.HIDE};return A;}()),DEFAULT_PROPS:(function(){var A={};A[ALL]={cntrFitMode:ENUM_FIT_MODES.FIT_TO_CONTENT,dlFntFml:OPEN_SANCE,rfLnFntFml:OPEN_SANCE,lgdFntFml:OPEN_SANCE,xAxTtFntFml:OPEN_SANCE,xAxLbFntFml:OPEN_SANCE,yAxTtFntFml:OPEN_SANCE,yAxLbFntFml:OPEN_SANCE,allTxtFntFml:OPEN_SANCE,rwHdrTxtFntFml:OPEN_SANCE,colHdrTxtFntFml:OPEN_SANCE,rwVlTxtFntFml:OPEN_SANCE,colVlTxtFntFml:OPEN_SANCE,ttlFntFml:OPEN_SANCE,dlFntSz:"9pt",rfLnFntSz:"9pt",lgdFntSz:"9pt",xAxTtFntSz:"9pt",xAxLbFntSz:"9pt",yAxTtFntSz:"9pt",yAxLbFntSz:"9pt",allTxtFntSz:"9pt",rwHdrTxtFntSz:"9pt",colHdrTxtFntSz:"9pt",rwVlTxtFntSz:"9pt",colVlTxtFntSz:"9pt",ttlFntSz:"9pt"};A[CHART_TYPE.WATERFALL]={yGridLnShw:NGM_GRID_LINE.AUTO,xGridLnShw:NGM_GRID_LINE.AUTO};return A;}())},OGM:{GENERAL_PROPS:(function(){var A={};A[ALL]={dataLabels:PRP_DATA_LABELS.HIDE,minRowHeight:20,fitTo:PRP_FIT_TO.NONE};A[CHART_TYPE.PIE]={legend:PRP_LEGEND.HIDE,legendShow:false,dataLabels:PRP_DATA_LABELS.SHOW_TEXT_ONLY};A[CHART_TYPE.SCATTER]={minSizeType:PRP_MIN_SIZE_TYPE.AUTO};return A;}()),DEFAULT_PROPS:(function(){var A={};A[ALL]={rwHdrShw:false,colHdrShw:false,dlFntFml:OPEN_SANCE,rfLnFntFml:OPEN_SANCE,lgdFntFml:OPEN_SANCE,xAxTtFntFml:OPEN_SANCE,xAxLbFntFml:OPEN_SANCE,yAxTtFntFml:OPEN_SANCE,yAxLbFntFml:OPEN_SANCE,allTxtFntFml:OPEN_SANCE,rwHdrTxtFntFml:OPEN_SANCE,colHdrTxtFntFml:OPEN_SANCE,rwVlTxtFntFml:OPEN_SANCE,colVlTxtFntFml:OPEN_SANCE,ttlFntFml:OPEN_SANCE,dlFntClr:3815477,rfLnFntClr:3815477,lgdFntClr:3815477,xAxTtFntClr:3815477,xAxLbFntClr:3815477,yAxTtFntClr:3815477,yAxLbFntClr:3815477,allTxtFntClr:3815477,rwHdrTxtFntClr:3815477,colHdrTxtFntClr:3815477,rwVlTxtFntClr:3815477,colVlTxtFntClr:3815477,ttlFntClr:3815477,yAxTtFntStyle:1,xAxTtFntStyle:1,rwHdrTxtFntStyle:1,colHdrTxtFntStyle:1,dlFntSz:"9pt",rfLnFntSz:"9pt",lgdFntSz:"9pt",xAxTtFntSz:"9pt",xAxLbFntSz:"9pt",yAxTtFntSz:"9pt",yAxLbFntSz:"9pt",allTxtFntSz:"9pt",rwHdrTxtFntSz:"9pt",colHdrTxtFntSz:"9pt",rwVlTxtFntSz:"9pt",colVlTxtFntSz:"9pt",ttlFntSz:"9pt"};A[CHART_TYPE.AREA]={shpBdrThk:1,shpFillTrans:100,shpBdrClr:15461355};A[CHART_TYPE.BAR]={shpBdrClr:15461355,shpBdrStyle:0,shpBdrThk:1,shpFillTrans:100};A[CHART_TYPE.LINE]={shpFillTrans:100};A[CHART_TYPE.PIE]={shpBdrThk:1,shpBdrStyle:0,shpFillTrans:100,shpBdrClr:15461355};A[CHART_TYPE.SCATTER]={shpBdrStyle:99,shpFillTrans:40};A[CHART_TYPE.BUBBLE]={shpBdrStyle:99,shpFillTrans:40};A[CHART_TYPE.GRID]={shpBdrThk:1,shpFillTrans:100};return A;}())},KPI:{fontFamily:OPEN_SANCE,defaultFontClr:{1:"#35383A",2:"#FFFFFF",3:"#FFFFFF",4:"#FFFFFF"}}};mstrmojo.vi.enums.EnumThemeProperties={CLASSIC_THEME_PROPS:classicProps,DEFAULT_THEME_PROPS:defaultProps};mstrmojo.vi.enums.EnumThemeProperties.SUBTYPE={GRID:"GRID",LAYOUT:"LAYOUT",HEATMAP:"HEATMAP"};mstrmojo.vi.enums.EnumThemeProperties.ENUM_LAYOUT_THEME=ENUM_LAYOUT_THEME;mstrmojo.vi.enums.EnumThemeProperties.ENUM_LAYOUT_STYLE={DEFAULT:0,CARD:1,FLAT:2};(function(){mstrmojo.requiresCls("mstrmojo.hash");var A=mstrmojo.hash;mstrmojo.requiresDescs(2213,3326,3327,3329,4531,13283,13284,13285,13286);mstrmojo.ME.Enum={METRIC_ACTIONS:{ADD:"add",EDIT:"edit",EDIT_NEW:"editNew"},EDITOR_IDS:{ADVANCED:"mstrME",FORMULA:"mstrME",WIZARD:"mstrFE",SIMPLE:"mstrSME",SELECOTR:"mstrFSE"},EDITOR_TYPES:{ADVANCED:"ADVANCED",FUNCTION:"FUNCTION",SIMPLE:"SIMPLE",SELECTOR:"SELECTOR"},METRIC_EDIT_TYPES:{ADVANCED:65536,SIMPLE:131072,FUNCTION:196608},METRIC_TYPES:{65536:"ADVANCED",131072:"SIMPLE",196608:"FUNCTION"},NEW_METRIC_DEFINITION:{did:"",n:mstrmojo.desc(2213,"New Metric"),tks:{items:[],vs:0,vm:""},mhfts:{},mvfts:{}},getNewDefinition:function(){return{did:"",n:mstrmojo.desc(2213,"New Metric"),tks:{items:[],vs:0,vm:""},mhfts:{},mvfts:{}};},FBFlag:{Automatic:0,Manual:3},AFB:{Automatic:-1,False:0,True:1},SFB:{Automatic:-1,False:1,True:2},UI_OBJECT_TYPE:{Dimty:-1,Sub_Expression:-2,Level:-4,Condition:-5,Transformation:-6,Row_Count:-7},UI_DATA_TYPE:{Sortby:-1,Breakby:-2,Level:-4,Condition:-5,Transformation:-6},SHORTCUT_FUNCTIONS:{Level:-4,Condition:-5,Transformation:-6,Row_Count:-7},DYNAMIC_DIMTY:{CODES:{auto:{n:mstrmojo.desc(4531,"Automatic"),did:"@auto",t:-1},page:{n:mstrmojo.desc(3329,"Grand Total"),did:"@p",t:-1},byCol:{n:mstrmojo.desc(3326,"By Columns"),did:"@cols",t:-1},byRow:{n:mstrmojo.desc(3327,"By Rows"),did:"@rows",t:-1},byCell:{n:mstrmojo.desc(13283,"By Cell"),did:"@cell",t:-1},byShape:{n:mstrmojo.desc(13284,"By Shape"),did:"@shape",t:-1},downCross:{n:mstrmojo.desc(13285,"Down, Then Across"),did:"@cr",t:-1},crossDown:{n:mstrmojo.desc(13286,"Across, Then Down"),did:"@rc",t:-1}},getItems:function D(G){var F=this.CODES,E=[];switch(G){case"breakby":E=[F.auto,A.copy({n:mstrmojo.desc(2057,"None")},A.copy(F.page)),A.copy({n:mstrmojo.desc(122,"Columns")},A.copy(F.byCol)),A.copy({n:mstrmojo.desc(2968,"Rows")},A.copy(F.byRow)),A.copy({n:mstrmojo.desc(13399,"Cell")},A.copy(F.byCell)),A.copy({n:mstrmojo.desc(2923,"Shape")},A.copy(F.byShape))];break;case"level":E=[F.auto,F.page,F.byCol,F.byRow,F.byCell,F.byShape];break;case"sortby":E=[F.auto,F.downCross,F.crossDown];}return E;},getAutomaticDimtyObject:function C(){return A.copy(this.CODES.auto);},getDimtyObject:function B(E,H){var F=null;var G=false;if(H){A.forEach(mstrmojo.ME.Enum.DYNAMIC_DIMTY.CODES,function(I){if(I.did===E){F=A.copy(I);G=true;return false;}});}if(!G){F={n:E,t:-1,dimty:true};}return F;}},NonExposableParams:["IsNewOLAP","OLAPPattern","OLAPHasWindow"]};mstrmojo.ME.Enum.DEFAULT_MPS={mps:{afb:mstrmojo.ME.Enum.AFB.False,sfb:mstrmojo.ME.Enum.SFB.False,fbf:mstrmojo.ME.Enum.FBFlag.Automatic}};}());(function(){mstrmojo.requiresCls("mstrmojo.hash");var O=/this\.([\w\.\[\]\'\"\-]+)/m,D=/this\./m,M=/mstrmojo\.all\[[\'\"]([\w]+)[\'\"]\]\.([\w\.\[\]\'\"\-]+)/m,R=/mstrmojo\.all\[/m,L=/mstrmojo\.all\.([\w]+)\.([\w\.\[\]\'\"\-]+)/m,B=/mstrmojo\.all\./m,C=/\[(\d+)\]/g,E=/\[\'([\w\-]+)\'\]/g,P=/\[\"([\w\-]+)\"\]/g,H=/([\[\]].*)/;mstrmojo.Binding=mstrmojo.declare(null,null,{scriptClass:"mstrmojo.Binding",parent:null,source:null,destination:null,enabled:false,setter:"set",executing:0,init:function N(S){mstrmojo.hash.copy(S,this);mstrmojo.registry.add(this);},destroy:function F(){mstrmojo.publisher.clearSubscriptions(this.id);mstrmojo.registry.remove(this);},exec:function K(){this.executing++;var X=this._sourceFn;if(!X){var W=this.source;if(W!=null){if(typeof (W)=="string"){if(!(W.match("return "))&&!(W.match(/\;\s*\S/))){W="return "+W;}X=new Function(W);}else{if(typeof (W)=="function"){X=W;}}this._sourceFn=X;}}var S,Y=this.parent;if(X){try{S=X.apply(Y,[]);}catch(V){}}var U=this.setter,Z=this.destination;if(U==null){Y[Z]=S;}else{if(typeof (U)=="string"){Y[U](Z,S);}else{if(typeof (U)=="function"){U.apply(Y,[Z,S]);}}}this.executing--;},enable:function A(){if(!this.enabled){this.exec();var U=this._chains;if(!U){this._parseChains();U=this._chains;}for(var S in U){this._attachChain(U[S]);}this.enabled=true;}},disable:function J(){if(this.enabled){var U=this._chains;if(U){for(var S in U){this._detachChain(U[S]);}}this.enabled=false;}},_chains:null,_parseChains:function(){this._chains={};var V=this._chains;var U=this.source;if(U&&(typeof (U)=="function")){U=U.toString&&U.toString();}if(!U){return ;}function S(c,f,W,Y){var X=c,a;while(a=X.match(f)){var d=a[0],b=d.length,e=true;d=d.replace(C,".$1").replace(E,".$1").replace(P,".$1").replace(H,"");for(var Z in V){if(Z.substr(0,b)===d){e=false;break;}else{if(d.indexOf(Z)===0){delete V[Z];}}}if(e){V[d]={host:(W==null)?null:a[W],parts:a[Y].replace(C,".$1").replace(E,".$1").replace(P,".$1").replace(H,"").split(".")};}X=X.substr(a.index+b);}}if(D.test(U)){S(U,O,null,1);}if(R.test(U)){S(U,M,1,2);}if(B.test(U)){S(U,L,1,2);}},_attachChain:function Q(S,V){if(!S.evt2idx){S.evt2idx={};}if(!S.idx2evt){S.idx2evt=[];}var e=S.evt2idx,h=S.idx2evt,a=S.parts;var f=(V>=0)?V:0,c=this.id,X=mstrmojo.all,d=(V>0)?X[h[f-1].context][a[f-1]]:(S.host?X[S.host]:this.parent),U=a[f];var W=mstrmojo.array;while(d&&U){if(d.attachEventListener){var g=d[U+"_bindEvents"]||(U+"Change");if(typeof (g)=="string"){g=[g];}var Z=[];for(var b=0,Y=g.length;b<Y;b++){Z[b]=d.attachEventListener(g[b],c,"_callback");}for(var b=0;b<g.length;b++){e[d.id+"_"+g[b]]=f;}h[f]={context:d.id,evts:g,subs:Z};}d=d[U];U=S.parts[++f];}},_detachChain:function G(S,U){var V=mstrmojo.all,k=S.idx2evt,e=S.evt2idx,b=this.id;var Z=(U>-1)?U:0,c=k.length;if(Z<c){for(;Z<c;Z++){var a=k[Z];if(!a){break;}var X=a.context,d=V[X],h=a.evts;if(d&&d.detachEventListener){var l=a.subs;for(var g=0,W=l.length;g<W;g++){d.detachEventListener(l[g]);}}k[Z]=null;for(var Y=0,f=h.length;Y<f;Y++){delete e[X+"_"+h[Y]];}}}},_callback:function I(U){this.exec();if(!U||!U.name||!U.src){return ;}var V=U.src.id+"_"+U.name,X=this._chains;for(var Y in X){var W=X[Y],S=W.evt2idx[V];if(S!=null){this._detachChain(W,S+1);this._attachChain(W,S+1);}}}});})();(function(){mstrmojo.requiresCls("mstrmojo.array","mstrmojo.hash");var I=mstrmojo.array,M=mstrmojo.hash;function J(V){if(V!==null){return(V.constructor!==Array)?[V]:V;}return null;}function F(f,d,Z){if(!d){return null;}var g=[],W=f.selectedIndices,V=f.allIdx,b=f.noneIdx;if(f.multiSelect&&(b>-1)&&(I.indexOf(d,b)>-1)){return g;}var Y,a,e=f.items,c=f.itemIdField,X=f.selectedItems,j;if(f.multiSelect&&(V>-1)&&(I.indexOf(d,f.allIdx)>-1)){for(Y=0,a=e.length;Y<a;Y++){if(!W[Y]){g.push(Y);W[Y]=true;f.selectedIndex=Y;f.selectedItem=e[Y];}}}else{for(Y=0,a=d.length;Y<a;Y++){var h=d[Y];if(!W[h]){W[h]=true;if(Z){g.push({idx:h,positions:Z});}else{g.push(h);}f.selectedIndex=h;j=f.selectedItem=e[h];if(X){X[j[c]]=j;}}}}return g;}function D(Y,V){var X=[],Z=Y.selectedIndices,a=Y.selectedItems,W;for(W in Z){delete Z[W];if(V){X.push({idx:parseInt(W,10),positions:V});}else{X.push(parseInt(W,10));}}Y.selectedIndex=-1;Y.selectedItem=null;if(a){Y.selectedItems={};}return X;}function U(f,e,Z){if(!e){return null;}var b=[],W=f.selectedIndices,h=I.indexOf,V=f.allIdx,c=f.noneIdx,d=f.itemIdField,X=f.selectedItems;if(f.multiSelect&&(((V>-1)&&(h(e,V)>-1))||((c>-1)&&(h(e,c)>-1)))){return D(f);}if(e.length>0&&W[V]){if(h(e,V)<0){e.push(V);}}var a=e.length,Y;for(Y=0;Y<a;Y++){var g=e[Y];if(W[g]){delete W[g];if(Z){b.push({idx:g,positions:Z});}else{b.push(g);}if(X){delete X[f.items[g][d]];}if(f.selectedIndex===g){f.selectedIndex=-1;f.selectedItem=null;}}}return b;}function C(Y,Z,W,V){if(V){return ;}if(this.raiseEvent){if((Y&&Y.length)||(Z&&Z.length)){try{this.raiseEvent({name:"selectionChange",added:Y,removed:Z});}catch(X){U(this,Y);F(this,Z);throw X;}}}}function B(W){var X=this.itemIdField,V=this.items;if(typeof W==="object"&&X){return I.find(V,X,W[X]);}return I.indexOf(V,W);}mstrmojo._ListSelections={multiSelect:false,allIdx:-1,noneIdx:-1,itemIdField:"",items:null,selectedIndices:null,selectedIndex:-1,selectedIndices_bindEvents:"selectionChange",selectedIndex_bindEvents:"selectionChange",selectedItem:null,selectedItem_bindEvts:"selectionChange",allowUnlistedValues:true,selectedItems:null,supportsIncFetch:false,init:function(V){this._super(V);if(this.supportsIncFetch&&this.itemIdField){this.selectedItems={};}if(!this.items){this.items=[];}if(!this.selectedIndices){this.selectedIndices={};if(this.selectedIndex>-1){this._set_selectedIndex("selectedIndex",this.selectedIndex,true);}else{if(this.selectedItem){this._set_selectedItem("selectedItem",this.selectedItem,true);}}}},addItems:function K(e){e=J(e);if(!e){return ;}var b=this.items,V=this.items.length,X=this.selectedItems,Z=[],W;b=this.items=b.concat(e);W=b.length;if(X){var a=this.itemIdField,Y,d;for(Y=V;Y<b.length;Y++){d=b[Y];if(X[d[a]]){Z.push(Y);}}}if(Z&&Z.length){F(this,Z);}if(W>V){var c=this.itemsContainerNode;if(c){c.innerHTML+=this._buildItemsMarkup(V,W-1).join("");}}},addSelectedItems:function S(V){this.selectItems(V,false);},setSelectedItems:function L(V){this.selectItems(V,true);},selectItems:function R(d,f){d=J(d);if(!d){return ;}if(f&&this.selectedItems){this.selectedItems={};}var X=this.selectedItems,b=this.itemIdField,V=[],Z=this.items.length,a=[],W=this.allowUnlistedValues,e,c,Y;for(Y=0;Y<d.length;Y++){e=d[Y];c=B.call(this,e);if(c<0){if(X===null){if(W){V.push(e);c=Z++;a.push(c);}}else{X[e[b]]=e;}}else{a.push(c);}}if(V.length>0){this.addItems(V);}if(a.length>0){if(f){this.select(a);}else{this.addSelect(a);}}},unselectItems:function A(W){W=J(W);if(!W){return ;}var b=this.selectedItems,X=[],a=this.itemIdField,Z,V,Y;if(b===null){return ;}for(Y=0;Y<W.length;Y++){Z=W[Y];if(b){delete b[Z[a]];}V=B.call(this,Z);if(V<0){X.push(V);}}if(X.length>0){this.removeSelect(X);}},getSelectedItems:function G(){if(this.selectedItems){return M.valarray(this.selectedItems);}return I.get(this.items,M.keyarray(this.selectedIndices,true));},singleSelect:function(W,X,V){if(W!==-1){this.select([W],X,V);}},singleSelectByField:function O(W,X,V){this.singleSelect(I.find(this.items,X,W),V);},toggleSelect:function Q(V){var X,W;if(this.selectedIndices[V]){W=U(this,[V]);}else{X=F(this,[V]);}C.call(this,X,W,[V]);},select:function(X,W,V){X=J(X);if(!X){return ;}var Z=D(this,V),b=F(this,X,V),Y;if(this.selectionPolicy!=="reselect"){for(Y=Z.length-1;Y>=0;Y--){var a=I.indexOf(b,Z[Y]);if(a>-1){Z.splice(Y,1);b.splice(a,1);}}}C.call(this,b,Z,X,W);},rangeSelect:function H(W,V){var b=this.selectedIndex,Z=b,a=this.allIdx,X=[],Y;if(W===a||this.selectedIndices[a]){X.push(a);}else{if(Z===-1&&this.selectedIndices){for(Y in this.selectedIndices){Z=parseInt(Y,10);break;}}Z=Z===-1?0:Z;if(Z>W){Z=W;W=b;}for(Y=Z;Y<=W;Y++){X.push(Y);}}this.select(X,V);this.selectedIndex=b;},clearSelect:function(V){C.call(this,null,D(this),[],V);if(!V){this.raiseEvent({name:"clearSelection"});if(this.parent){this.parent.raiseEvent({name:"clearSelection"});}}},addSelect:function(Y,V,W){Y=J(Y);if(!Y){return ;}var X=F(this,Y,W),a=null,Z=this.noneIdx;if(this.multiSelect&&(Z>-1&&I.indexOf(Y,Z)>-1)){a=U(this,Y);}C.call(this,X,a,Y,V);},removeSelect:function(X,V,W){X=J(X);if(!X){return ;}C.call(this,null,U(this,X,W),X,V);},_set_selectedIndices:function P(X,d,V){if(this.selectedItems){this.selectedItems={};}var W=this.selectedIndices;if(W===d){return false;}if(!W){W={};this.selectedIndices=W;}if(!d){d={};}var b=this.selectedIndex,a=[],c;for(c in W){if(!d[c]){c=parseInt(c,10);delete W[c];a.push(c);if(b===c){this.selectedIndex=-1;this.selectedItem=null;}}}var g=[],e=this.items,Z=this.itemIdField,f;for(c in d){if(!W[c]){c=parseInt(c,10);W[c]=true;g.push(c);this.selectedIndex=c;f=this.selectedItem=e[c];if(this.selectedItems){this.selectedItems[f[Z]]=f;}}}if(V!==true){var Y=[];for(c in d){if(W[c]){c=parseInt(c,10);Y.push(c);}}C.call(this,g,a,Y);}return(g.length||a.length);},_set_selectedIndex:function N(Y,W,V){var X={};if(W>-1){X[W]=true;}return this._set_selectedIndices("selectedIndices",X,V);},_set_selectedItem:function E(Y,X,W){var V=B.call(this,X);if((V<0)&&(X!==null&&X!==undefined)&&this.allowUnlistedValues&&this.items){this.set("items",this.items.concat(X));V=this.items.length-1;}return this._set_selectedIndex("selectedIndex",V,W);},_addSelections:function(V){return F(this,V);},_removeAll:function(){return D(this);}};}());(function(){mstrmojo.requiresCls("mstrmojo.hash");var B=mstrmojo.hash;mstrmojo.Base=mstrmojo.declare(null,null,{scriptClass:"mstrmojo.Base",init:function A(C){B.copy(C,this);if(this.postApplyProperties){this.postApplyProperties();}}});}());(function(){mstrmojo.requiresCls("mstrmojo.dom","mstrmojo.hash");var D=mstrmojo.dom,L=mstrmojo.hash;var O=100;var F=D.supportsTouches?0.5:1;var G=1;var R=100;var P={onvscrollVisibleChange:function(){var V=this.vscrollNode,W=V&&V.style;if(!W){return ;}if(this.vscrollVisible){var U=this.maxPos,X=this.clientSize;W.height=Math.round(X.y*X.y/U.y)+"px";W.left=(X.x-5)+"px";W.display="block";W.opacity=0.5;}else{W.opacity=0;}},onhscrollVisibleChange:function(){var W=this.hscrollNode,V=W&&W.style;if(!V){return ;}if(this.hscrollVisible){var U=this.maxPos,X=this.clientSize;V.width=Math.round(X.x*X.x/U.x)+"px";V.top=(X.y-5)+"px";V.display="block";V.opacity=0.5;}else{V.opacity=0;}}};var M=L.copy({onposChange:function(){var W=this.clientSize,V=this.maxPos,U=0,X=0;if(this.scrollsVert){X=this.pos.y;if(this.vscrollVisible){this.vscrollNode.style[D.CSS3_TRANSFORM]="translateY("+Math.round((W.y-(W.y*W.y/V.y))*this.pos.y/V.y)+"px)";}}if(this.scrollsHoriz){U=this.pos.x;if(this.hscrollVisible){this.hscrollNode.style[D.CSS3_TRANSFORM]="translateX("+Math.round((W.x-(W.y*W.x/V.x))*this.pos.x/V.x)+"px)";}}this.scrollChild.style[D.CSS3_TRANSFORM]="translate3d(-"+parseInt(U,10)+"px, -"+parseInt(X,10)+"px, 0px)";},ondeceleratingChange:function(){this.scrollChild.style[D.CSS3_TRANSITION]=this.decelerating?(D.CSS3_PREFIX+"transform 0.2s linear"):"";}},L.copy(P));var H=L.copy({onposChange:function(){var W=this.clientSize,V=this.maxPos,U=0,Y=0,X=this.scrollboxNode;if(this.scrollsVert){Y=this.pos.y;if(this.vscrollVisible){this.vscrollNode.style.top=Math.round((W.y-(W.y*W.y/V.y))*this.pos.y/V.y)+"px";}X.scrollTop=parseInt(Y,10);}if(this.scrollsHoriz){U=this.pos.x;if(this.hscrollVisible){this.hscrollNode.style.left=Math.round((W.x-(W.y*W.x/V.x))*this.pos.x/V.x)+"px";}X.scrollLeft=parseInt(U,10);}}},L.copy(P));mstrmojo._TouchScrolling=mstrmojo.provide("mstrmojo._TouchScrolling",{FRICTION:0.65,BOUNCEFRICTION:0.5,usesTouches:false,bounces:true,scrollsHoriz:true,scrollsVert:true,pos:null,preBuildRendering:function N(){this.usesTouches=(mstrmojo.dom.supportsTouches&&this.usesTouches&&(this.scrollsHoriz||this.scrollsVert));if(this.usesTouches){this.pos={x:0,y:0};}if(this._super){this._super();}},postBuildRendering:function C(){if(this._super){this._super();}if(this.usesTouches){var X=this.scrollboxNode,W=this.itemsContainerNode||X.firstChild;if(X&&X!==W){this.scrollChild=W;var U=X.style;U.position="relative";U.overflow="hidden";var V=W.style;V.position="absolute";V.left=0;V.top=0;this.markupMethods=L.copy(D.isSafari?M:H,L.copy(this.markupMethods));this.attachTouchEvents();}}},unrender:function(U){if(this.usesTouches){this.detachTouchEvents();}this._super(U);},attachTouchEvents:function(){var V=this.touchNode||this.scrollboxNode;if(V){if(!this._tsCallback){var U=this;this._tsCallback=function(W){U.touchesBegin(self,W);};this._tmCallback=function(W){U.touchesMoved(self,W);};this._teCallback=function(W){U.touchesEnd(self,W);};}D.attachEvent(V,D.TOUCHSTART,this._tsCallback);this._tsNode=V;}},detachTouchEvents:function(){var U=this._tsNode;if(U){D.detachEvent(U,D.TOUCHSTART,this._tsCallback);delete this._tsNode;}},touchesBegin:function J(U,W){var V=W.target&&W.target.tagName;if(V&&(V==="SELECT"||V==="INPUT")){return ;}D.preventDefault(U,W);this.stopDeceleration();this.startTime=new Date();this.startTimePos={x:this.pos.x,y:this.pos.y};this.startTouchPos=D.getMousePosition(D.firstTouch(U,W),U);this.dragging=false;D.attachEvent(window,D.TOUCHMOVE,this._tmCallback);D.attachEvent(window,D.TOUCHEND,this._teCallback);},touchesMoved:function E(c,f){var a=D.getMousePosition(D.firstTouch(c,f),c);D.preventDefault(c,f);if(!this.dragging){var U=5,j=Math.abs;if((this.scrollsHoriz&&j(a.x-this.pos.x)>U)||(this.scrollsVert&&j(a.y-this.pos.y)>U)){this.dragging=true;this.dragStartTime=new Date();this.startTouchPos=a;var W=this.scrollboxNode,Z={x:W.clientWidth,y:W.clientHeight},g={x:W.scrollWidth,y:W.scrollHeight};this.clientSize=Z;this.scrollSize=g;this.maxPos={x:Math.max(g.x-Z.x,0),y:Math.max(g.y-Z.y,0)};this.showScroll();}}if(this.dragging){D.stopPropogation(c,f);var d=this.startTimePos,Y=this.startTouchPos,b=this.maxPos;var X={x:this.scrollsHoriz?Math.max(Math.min(d.x-(a.x-Y.x),b.x),0):0,y:this.scrollsVert?Math.max(Math.min(d.y-(a.y-Y.y),b.y),0):0};this.set("pos",X);this.nextLastDragPos=this.lastDragPos;this.lastDragPos=a;var V=new Date(),h=this.lastDragTime;this.nextLastDragTime=h;this.lastDragTime=V;if((V-h)>R){this.startTime=this.lastDragTime;this.dragStartTime=this.startTime;this.startTimePos={x:X.x,y:X.y};this.startTouchPos=a;}}},touchesEnd:function I(U,V){D.preventDefault(U,V);D.detachEvent(window,D.TOUCHMOVE,this._tmCallback);D.detachEvent(window,D.TOUCHEND,this._teCallback);if(this.dragging){this.dragging=false;D.stopPropogation(U,V);if((new Date())-this.lastDragTime<=R){this.startDeceleration(U,V);}else{this.hideScroll();}}},startDeceleration:function B(Z,a){var X=D.getMousePosition(D.firstChangedTouch(Z,a),Z),d=((mstrmojo.dom.supportsTouches===null)?this.lastDragPos:this.nextLastDragPos)||X,c={x:X.x-d.x,y:X.y-d.y},U=((mstrmojo.dom.supportsTouches===null)?this.lastDragTime:this.nextLastDragTime),f=U?(new Date())-U:0,W={x:f?Number(c.x*O*F/f).toFixed(2):0,y:f?Number(c.y*O*F/f).toFixed(2):0};var b=this,V=function(e){return(b.scrollsHoriz&&Math.abs(e.x)>=G)||(b.scrollsVert&&Math.abs(e.y)>=G);};if(V(W)){this.velocity=W;this.friction={x:this.FRICTION,y:this.FRICTION};this.set("decelerating",true);var Y=function(){b.decelerate();if(!V(b.velocity)){b.stopDeceleration();b=null;}};Y();if(this.decelerating){this.decelerationTimer=window.setInterval(Y,O);}}else{this.hideScroll();}},stopDeceleration:function A(){this.set("decelerating",false);delete this.velocity;if(this.decelerationTimer){window.clearTimeout(this.decelerationTimer);delete this.decelerationTimer;}this.hideScroll();},decelerate:function S(){var X=this.pos,W=this.velocity,V=this.friction,a=this.maxPos,Y={x:X.x-W.x,y:X.y-W.y},c=this.bounces,U=this.BOUNCEFRICTION;var b=Y.x;if(b<0||b>a.x){Y.x=(b<0)?0:a.x;W.x*=c?-U:0;V.x=U;}var Z=Y.y;if(Z<0||Z>a.y){Y.y=(Z<0)?0:a.y;W.y*=c?-U:0;V.y=U;}this.set("pos",Y);this.velocity={x:V.x*W.x,y:V.y*W.y};},hideScroll:function K(){this.set("vscrollVisible",false);this.set("hscrollVisible",false);},showScroll:function Q(){var U=this.maxPos;if(this.scrollsVert&&U.y&&this.vscrollNode){this.set("vscrollVisible",true);}if(this.scrollsHoriz&&U.x&&this.hscrollNode){this.set("hscrollVisible",true);}}});}());(function(){mstrmojo.requiresCls("mstrmojo.dom","mstrmojo.hash");var E=mstrmojo.dom,M=mstrmojo.hash,B,I=mstrmojo.global.document,K="mousedown",O="mousemove",Q="mouseup";function G(Y){if(E.isPrimaryMouseBtn(Y)){B.startDragCheck(self,Y);}}var V,P,A="mstrmojo-dnd-avatar",U;function F(Z,Y){if(Y!==undefined&&Y!==null){P.innerHTML=Y;}U.left=Z.x+"px";U.top=Z.y+"px";}function L(Z,Y){if(!V){V=I.createElement("div");U=V.style;V.className=A;V.innerHTML='<div class="'+A+'-inner"></div>';P=V.firstChild;I.body.appendChild(V);}F(Z,Y);U.display="block";}function R(){if(U){U.display="none";}}function H(Y){var Z=++B.ctxt.moveCount;if(Z>=B.minMoves){B.stopDragCheck();if((Y.buttons===1||Y.buttons===undefined||E.isIE9)&&(Y.which===1||Y.button===0||E.isIE8)){B.startDrag(self,Y);}}}function N(Y){if(E.isPrimaryMouseBtn(Y)){B.stopDragCheck();delete B.ctxt;}}function D(Y){B.onDragMove(self,Y);}function C(Y){if(E.isPrimaryMouseBtn(Y)){B.stopDrag(window,Y);}}function J(Z){var Y=E.findWidget(Z);while(Y){if(Y.draggable){return Y;}Y=Y.parent;}return null;}function S(Y){var a=Y.src,Z=J(a.node);if(!Z){return null;}if(Z.getDragAction){Y.action=Z.getDragAction(Y);}a.widget=Z;a.data=Z.getDragData&&Z.getDragData(Y);if(Z.isDragValid){if(!Z.isDragValid(Y)){if(!mstrApp.isInVFInteractMode&&(!Z.shouldDragBubble||Z.shouldDragBubble(Y)===true)){Y.src.node=Z.domNode.parentNode;return S(Y);}return null;}}if(Z.ondragstart){Z.ondragstart(Y);}return Z;}function X(a,Z){var Y=E.findWidget(a),b=Z.tgt&&Z.tgt.widget;while(Y){if(Y.dropZone){if(Y===b){return Y;}if(Y.allowDrop&&Y.allowDrop(Z)){return Y;}}Y=Y.parent;}return null;}function W(){if(this.set){this.set("allowingDrop",false);}}mstrmojo.dnd=mstrmojo.dnd||mstrmojo.provide("mstrmojo.dnd",{minMoves:3,enable:function(){if(!mstrmojo.dndEnabled){E.attachEvent(I,K,G);mstrmojo.dndEnabled=true;}},disable:function(){mstrmojo.dndEnabled=false;E.detachEvent(I,K,G);},startDragCheck:function(Y,Z){delete this.ctxt;var a=E.captureEventInfo({hWin:Y,e:Z});this.ctxt={src:a,moveCount:0,last:M.copy(a.pos),getDirection:function(b){return !!this.dir[b];},getCtxtDragData:function(){var b=this.src;return(b&&b.data)||{};},getCtxtDropData:function(){var b=this.tgt;return(b&&b.data)||{};}};if(this.minMoves){E.attachEvent(I,O,H);E.attachEvent(I,Q,N);}else{this.startDrag(Y,Z);}},stopDragCheck:function(){E.detachEvent(I,O,H);E.detachEvent(I,Q,N);},startDrag:function(Y,b){var Z=this.ctxt;Z.id=mstrmojo.now();var a=S(Z);if(!a){return ;}E.clearBrowserHighlights(Y);E.preventDefault(self,b);E.attachEvent(I,O,D);E.attachEvent(I,Q,C);var d=window.mstrApp;if(d&&d.setInteractive){this._changeAppStatus=d.setInteractive(false);}if(!a.ownAvatar){var c=Z.src;L(c.pos,c.data&&c.data.html);}},stopDrag:function(Y,f){E.detachEvent(I,O,D);E.detachEvent(I,Q,C);var b=this.ctxt,a=b.tgt||{},Z=E.captureEventInfo({hWin:Y,e:f,data:a.data}),d=X(Z.node,b);Z.widget=d;b.tgt=Z;if(d){if(d.ondrop){d.ondrop(b);}else{W.call(d);}}var c=b.src.widget;if(c&&c.ondragend){c.ondragend(b);}if(c&&!c.ownAvatar){R();}if(this._changeAppStatus){window.mstrApp.setInteractive(true);delete this._changeAppStatus;}},onDragMove:function(c,f){if(E.isSafari){E.clearBrowserHighlights();}var Y=this.ctxt,b=Y.tgt||{},Z=b.widget,d=E.captureEventInfo({hWin:c,e:f,data:b.data}),j=d.widget=X(d.node,Y),h=Y.last,a=d.pos;Y.dir={x:a.x>h.x,y:a.y>h.y};Y.last=M.copy(d.pos);Y.tgt=d;if(Z!==j){if(Z){if(Z.ondragleave){Z.ondragleave(Y);}else{W.call(Z);}}if(j){Y.tgt.data=(j.getDropData&&j.getDropData(Y))||{};if(j.ondragenter){j.ondragenter(Y);}else{if(j.set){j.set("allowingDrop",true);}}}}if(j){if(j.ondragover){j.ondragover(Y);}}var g=Y.src.widget;if(g&&g.ondragmove){g.ondragmove(Y);}if(g&&!g.ownAvatar){F(d.pos);}}});B=mstrmojo.dnd;B.enable();}());(function(){mstrmojo.requiresCls("mstrmojo.array","mstrmojo.hash");var C=mstrmojo.array,B=mstrmojo.hash;mstrmojo.models.datasets.DataInterface=mstrmojo.provide("mstrmojo.models.datasets.DataInterface",{getFormsByAttrId:function A(F,E){var D=[];E=E||[];B.forEach(E,function(G){C.forEach(G.att||[],function(H){if(H.did===F){D=D.concat(H.fs||[]);return false;}});});D=C.filter(D,function(G){return !!G.obf;});return C.distinct(D,"fid");}});}());mstrmojo.DPIManager={classes:[],registerClass:function registerClass(B,C,D,A){this.classes.push({c:B,d:C,s:D,v:A});},setDPI:function(){var A=mstrMobileApp.getDeviceDPI();mstrmojo.array.forEach(this.classes,function(B){B.c.prototype.layoutConfig[B.d][B.s]=B.v[A]+"px";});this.classes=[];}};(function(){document.msCSSOMElementFloatMetrics=true;mstrmojo.requiresCls("mstrmojo.hash");var S=mstrmojo.hash,H="containerNode",G="auto",Q="px";var I={v:G,c:undefined,sv:G};function E(d,g,f){var h=this._layoutWidgets[g],l=d.slot||H,j=h.f,k=h.p,e=(j&&j[l]!==undefined),c=(k&&k[l]!==undefined);if(l&&((!f&&e)||c)){return e?j[l]:(h.x*parseInt(k[l],10)/100)+Q;}return d[(g==="h")?"height":"width"];}function K(j,e,c){if(j.ignoreLayout){return ;}var d=(e===G)||e==="NaNpx",g=(c===G)||c==="NaNpx";var f=j.getLayoutOffsets&&j.getLayoutOffsets();if(f){if(!d){e=(parseInt(e,10)-f.h)+Q;}if(!g){c=(parseInt(c,10)-f.w)+Q;}}if(j.setDimensions){j.setDimensions(e,c);}else{if(j.set){if(!d){j.set("height",e);}if(!g){j.set("width",c);}}}}function a(f){var d=this.children,j,l;for(j=0,l=(d&&d.length)||0;j<l;j++){var e=d[j],m=e.slot||H;if(m){var k=E.call(this,e,"h",f),n=E.call(this,e,"w",f);this.setSlotDimensions(m,k,n);K(e,k,n);var c=E.call(this,e,"h",f),g=E.call(this,e,"w",f);if(c!==k||g!==n){K(e,c,g);}this.setSlotDimensions(m,c,g);}}this.afterLayout();}function B(){var d=this.children,c=this._layoutWidgets;S.forEach(this.slotNames,function(j,k){if(!j||this.skipsSlotLayout(k)){return ;}var g=(c.h&&c.h.getSlotSizeInfo(k,d))||I,e=(c.w&&c.w.getSlotSizeInfo(k,d))||I,f=g.c||e.c;mstrmojo.array.forEach(f,function(h){K(h,g.v,e.v);});this.setSlotDimensions(k,g.sv,e.sv);},this);this.afterLayout();}function D(d){var c=this.layoutConfig.xt?B:a;c.call(this,d);}function U(k,f,h){var j=k.slot||H,g=f&&f.a;if(!g||g[j]===undefined){return ;}var c=this[j]["offset"+h],e=g[j];if(c===e){return ;}f.x-=(c-e);g[j]=c;}function J(c){this.beforeLayout();var d=this._layoutWidgets,e=c.src;U.call(this,e,d.h,"Height");U.call(this,e,d.w,"Width");D.call(this,true);}function O(e,j){if(!e){return null;}var c=this.children,t=j.toLowerCase(),k=parseInt(this[t],10),m=k,o={},q={},h={},d={},p={},l,n,f,u,r;for(r in e){if(!e.hasOwnProperty(r)){continue;}u=e[r];if(u.match(/px$/)){k-=parseInt(u,10);o[r]=u;}else{if(u.match(/%$/)){q[r]=u;}else{if(u.match(/all/)){p[r]=m;}else{h[r]=u;}}}}if(!S.isEmpty(h)&&!S.isEmpty(q)){for(l=0,n=(c&&c.length)||0;l<n;l++){f=c[l];r=f.slot||H;if(r&&h[r]&&!f.ignoreLayout){if(f.hasRendered){var g=this[r];d[r]=g.getBoundingClientRect?Math.round(g.getBoundingClientRect()[j.toLowerCase()]):g["offset"+j];k-=d[r];}else{d[r]=0;f.attachEventListener((f instanceof mstrmojo.Container)?"childrenRendered":"renderComplete",this.id,J);}}}}return{f:S.isEmpty(o)?undefined:o,p:S.isEmpty(q)?undefined:q,a:S.isEmpty(d)?undefined:d,n:S.isEmpty(p)?undefined:p,x:k,getSlotSizeInfo:function(AE,z){if(!e[AE]){return I;}var x=mstrmojo.array.filter(z,function(AG){var AF=AG.slot;return AF===AE||(AE===H&&!AF);}),AC,AD;var w=o[AE];if(w){AD=w;}var AB=q[AE];if(AB){AD=(this.x*parseInt(AB,10)/100)+Q;}if(h[AE]){AD=d[AE];if(AD){AD+=Q;}else{AD=G;}AC=G;}var AA=p[AE];if(AA){AD=AC=AA+Q;}AD=AD||"0px";return{v:AD,c:x,sv:AC||AD};}};}function R(d){var c=this.domNode;if(!c||!this.layoutConfig){return ;}c.style[d]=this[d];this.doLayout();}mstrmojo._HasLayout=mstrmojo.provide("mstrmojo._HasLayout",{_mixinName:"mstrmojo._HasLayout",height:"auto",width:"auto",ignoreLayout:false,beforeLayout:mstrmojo.emptyFn,afterLayout:mstrmojo.emptyFn,forceLayout:false,layoutConfig:null,init:function W(c){this._super(c);this.layoutConfig=S.clone(this.layoutConfig);},preBuildRendering:function C(){var e=this.cssText||"";var c=this.height;if(c&&c!==G){e+="height:"+this.height+";";}var d=this.width;if(d&&d!==G){e+="width:"+this.width+";";}this.cssText=e;return(this._super)?this._super():true;},postBuildRendering:function X(){this.doLayout();return this._super();},modifyLayoutConfig:function Z(e,d){var c=this.layoutConfig=this.layoutConfig||{};c.h=S.copy(e,c.h);c.w=S.copy(d,c.w);this.doLayout();},getLayoutOffsets:mstrmojo.emptyFn,set:function P(e,c){var d=this._super(e,c);if(e==="visible"&&this._pendingLayoutOnVisible){delete this._pendingLayoutOnVisible;this.doLayout();}return d;},doLayout:function A(){var c=this.layoutConfig;if(!c||(this.height===G&&this.width===G)){return ;}if(c.xt){if(!this.visible){this._pendingLayoutOnVisible=true;return ;}}this.beforeLayout();this._layoutWidgets={h:O.call(this,c.h,"Height"),w:O.call(this,c.w,"Width")};D.call(this,false);this.widgetResized();},browserResized:function F(c){this.setDimensions(c.h,c.w);return true;},onwidthChange:function N(){R.call(this,"width");},onheightChange:function M(){R.call(this,"height");},skipsSlotLayout:function(c){return false;},adjustParentDimensions:function L(){var d=this.parent,c=d&&d._layoutWidgets;if(c){U.call(d,this,c.h,"Height");U.call(d,this,c.w,"Width");}},setDimensions:function V(f,d){var e=(f===G)||f==="NaNpx",g=(d===G)||d==="NaNpx";if((!e&&parseInt(this.height,10)!==parseInt(f,10))||(!g&&parseInt(this.width,10)!==parseInt(d,10))||this.forceLayout){if(!e){this.height=f;}if(!g){this.width=d;}var c=this.domNode,j=c&&c.style;if(j){if(!e){j.height=f;}if(!g){j.width=d;}this.doLayout();}return true;}return false;},setSlotDimensions:function Y(f,e,d){var c=this[f]&&this[f].style;if(!c){return ;}if(e!==G&&e!==undefined&&e!=="NaNpx"&&c.height!==e&&parseInt(e)>=0){c.height=e;}if(d!==G&&d!==undefined&&d!=="NaNpx"&&c.width!==d&&parseInt(d)>=0){c.width=d;}}});mstrmojo._HasLayout.getSlotSize=function b(f,g){var d=f&&f.prototype.layoutConfig;if(d){var e=d.h,c=d.w;return{h:(e&&e[g])||undefined,w:(c&&c[g])||undefined};}return null;};}());(function(){mstrmojo.requiresCls("mstrmojo.array","mstrmojo.hash");var C=mstrmojo.array;function A(E){var D=(E&&E.gts&&E.gts.col)||[],G=(E&&E.gts&&E.gts.row)||[];var F=C.filter(D.concat(G),function(H){return H.otp===-1;})[0];return{tpltProp:E.prop,mxProp:C.map((F&&F.es)||[],function(H){var I={};I[H.oid]=mstrmojo.hash.copy(H.prop,{n:H.n,t:H.otp});return I;})};}mstrmojo._IsDocumentTemplate=mstrmojo.provide("mstrmojo._IsDocumentTemplate",{_mixinName:"mstrmojo._IsDocumentTemplate",gridInfo:null,tmsProps:null,update:function B(D){if(D&&D.data){this.gridInfo=D.data.gsi;this.tmsProps=A(D.data);}if(this._super){return this._super(D);}return true;}});}());(function(){mstrmojo.requiresCls("mstrmojo.array","mstrmojo.chart.model.enums.EnumDSSObjectType","mstrmojo.hash");var I=mstrmojo.array,B=mstrmojo.hash,D="u;",C="-1";ELEM_HIDDEN_PROP="hid";mstrmojo.elementHelper=mstrmojo.provide("mstrmojo.elementHelper",{buildElemsTerseID:function F(R,Q,V){var P,O;for(O in R){P=R[O];if(P.v){var S=P.v.replace(/\\\\/g,"\u001e").replace(/\\\;/g,"\u001f");var U=S.split(";");if(U&&U.length>1){U[1]=Q;if(V&&U.length>2){U.pop();}P.v=U.join(";").replace(/\u001e/g,"\\\\").replace(/\u001f/g,"\\;");}}}return R;},buildElemsCountStr:function K(U,Q,P){U=(!U||!U.length)?[]:U;Q=(!Q||!Q.length)?[]:Q;function S(V){return V.filter(function(W){return !W[ELEM_HIDDEN_PROP];});}var R=S(U).length,O=S(Q).length;if(I.find(Q,"v",D)>-1){O-=1;}if(I.find(Q,"v",C)>-1){O-=1;}if(P){R=(R<O)?O-R:0;}if(I.find(U,"v",D)>-1||I.indexOf(U,D)>-1){R=O;}return this.buildElemsCountStrByNum(R,O);},buildElemsCountStrByNum:function K(P,O){if(P===O){if(O===0){return"";}return O.toString();}else{if(O===0){return P+" "+mstrmojo.desc(514);}else{if(P>O){return"("+O+")";}}}return mstrmojo.desc(4891,"").replace("##",String(P)).replace("###",String(O));},browseElements:function G(Q,R,P){var O={doNotHold:!(P&&mstrApp.serverProxy),silent:true};mstrApp.serverRequest(mstrmojo.hash.copy(P,R),Q,O);},getIdPresentation:function J(R){if(!!R){var Q=R.charAt(0),O,P,S;if((Q>="g"&&Q<="w")||(Q>="V"&&Q<="Z")){P=false;for(S=1;S<R.length;++S){if(P){P=false;}else{switch(R.charAt(S)){case";":return"terseLong";case"\\":P=true;break;}}}return"terse";}if(Q>="B"&&Q<="Q"){if(R.length>2){O=R.charAt(1);if(O>="A"&&O<="Q"){if(R.charAt(2)===":"){return"oldLong";}}}}if(R.length>=33&&R.charAt(32)===":"){return"old";}}return null;},terseLong2OldShort:function N(P){if(this.getIdPresentation(P)!=="terseLong"){return P;}var O=P.replace(/\\\\/g,"\u001e").replace(/\\\;/g,"\u001f"),Q=O.substring(1,O.length).split(";");return(Q[1]+":"+Q[0]).replace(/\u001e/g,"\\\\").replace(/\u001f/g,"\\;");},oldShort2terseLong:function L(P,S){if(this.getIdPresentation(P)!=="old"){return P;}var O=P.replace(/\\\\/g,"\u001e").replace(/\\\:/g,"\u001f"),R=O.split(":"),Q=R.shift();return(S||"h")+(R.join(":")+";"+Q).replace(/\u001e/g,"\\\\").replace(/\u001f/g,"\\:");},isNullElem:function H(O){if(!O){return true;}var R=this.getIdPresentation(O),P=false,Q;switch(R){case"terse":case"terseLong":Q=O.substring(1,O.length).split(";");P=Q[0].indexOf(this.TERSE_NULL)>-1;break;case"old":case"oldLong":P=O.indexOf(this.OLD_NULL)>-1;break;}return P;},isNonGroupNull:function(Q){var O=Q.eid||(Q._e&&Q._e.id),P=O&&O.split(":")[0];return P&&P===this.NON_GROUP_NULL;},getAttributeId:function M(Q){var P,O;if(Q){O=Q.split(";");P=O[1];}return P;},getElementValue:function A(P){var Q,O;if(P){O=P.split(";");if(O.length>2){Q=O[0]+" "+O[2];}else{Q=O[0];}}return Q;},isAttributeIdsLinked:function E(P,O,Q){var S=false,R=B.keyarray(Q);I.forEach(R,function(U){if(U===P){I.forEach(Q[U],function(V){if(V===O){S=true;return false;}});}if(S){return false;}});return S;},ELEM_ALL_ID:"u;",ELEM_DUMMY_ID:"-1",ELEM_SEPARATOR:"\u001E",OLD_NULL:"~!@@~~!@@~",TERSE_NULL:"\\N",NON_GROUP_NULL:"n00000000000000000000000000000000",ELEM_ALL:{t:mstrmojo.chart.model.enums.EnumDSSObjectType.DssTypeDimension,v:"u;",n:"(All)"}});}());(function(){mstrmojo.requiresCls("mstrmojo.hash","mstrmojo.array");var C=mstrmojo.hash,E=mstrmojo.array;function D(F){return function(G){F[G]=true;};}mstrmojo.rw.model.UpdateKeysConfig=mstrmojo.declare(null,null,{scriptClass:"mstrmojo.rw.model.UpdateKeysConfig",init:function B(){this.nodes=[];this.selectors={};this.objects={};}});mstrmojo.rw.model.UpdateKeysConfig.getConsolidatedConfig=function A(J){var F={},K={},G={},I={};E.forEach(J,function H(M){var L=M.partialUpdate;if(L){E.forEach(L.nodes,D(K));E.forEach(L.selectors,D(G));E.forEach(L.objects,function(N){if(!I[N.id]||N.flag>I[N.id].flag){I[N.id]=N;}});delete M.partialUpdate;}E.forEach(M.actions,H);});if(!C.isEmpty(K)){F.nodes=C.keyarray(K);}if(!C.isEmpty(G)){F.selectors=C.keyarray(G);}if(!C.isEmpty(I)){F.objects=C.valarray(I);}return F;};}());(function(){mstrmojo.requiresCls("mstrmojo.hash","mstrmojo.array");var H=mstrmojo.array,B=mstrmojo.hash,J=B.isEmpty;var G=1;function D(Q){return(typeof Q==="object")?Q:{};}function E(R,Q){B.forEach(Q,function(S,W){var U=R[W];if(U===undefined){delete Q[W];return true;}S=Q[W]=D(S);U=R[W]=D(U);if(J(S)&&J(U)){throw (G);}else{if(J(U)){delete R[W];if(J(R[W])){E(R,Q);}}else{if(J(S)){delete R[W];if(J(R[W])){E(R,Q);}}else{try{E(R[W],Q[W]);}catch(V){switch(V){case G:R[W]=Q[W]={};break;}}}}}});}function I(Q){B.forEach(Q,function(R){B.forEach(R,function(V,S){var U=V.include,X=V.exclude;if(J(U)||J(X)){return true;}if(!J(U)&&!J(X)){try{E(X,U);}catch(W){switch(W){case G:R[S]={};break;}}}});});return Q;}function F(S,R,Q){B.forEach(S,function(V,U){if(V===true||J(V)){Q.push(R+U);}else{F(V,R+U+".",Q);}});return Q;}function P(Q){B.forEach(Q,function(R){B.forEach(R,function(V,S){var U=[];F(V.include,"",U);F(V.exclude,"!",U);R[S]=U.join(";");});});return Q;}function K(Q,R){B.forEach(Q,function(S,V){var U=R[V];if(U!==undefined){if(S!==true&&U!==true){K(S,U);}else{if(S===true&&U!==true){R[V]=true;}else{if(S!==true&&U===true){Q[V]=true;}}}}});}function L(R,S){var Q=true;B.forEach(R,function(Z,U){var X=S[U];if(X){var V=Z.include,a=Z.exclude,Y=X.include,W=X.exclude;if(!J(W)&&!J(a)){Q=false;return Q;}if(!J(Y)&&!J(V)){K(Y,V);}}return Q;});return Q;}function C(S,Q){Q=Q||{};if(S){var R=Q;H.forEach(S.split("."),function(X,V,U,W){R[X]=W?true:{};R=R[X];});}return Q;}mstrmojo.rw.model.RetrievalKeysConfig=mstrmojo.declare(null,null,{scriptClass:"mstrmojo.rw.model.RetrievalKeysConfig",init:function M(){this.nodes=[];this.filters={};},addNode:function A(R,U){var S=this.filters,Q=S[R];if(!Q){this.nodes.push(R);Q=S[R]={data:{},defn:{}};}if(U){if(L(Q,U)){S[R]=B.mergeHashes(Q,U);}else{throw ("The new filters for node key ## cannot be merged with the filters currently defined".replace("##",R));}}return this;}});mstrmojo.rw.model.RetrievalKeysConfig.getConsolidatedConfig=function O(U){var Q={},V={},S={};H.forEach(U,function R(X){var W=X.partialRetrieval;if(W){H.forEach(W.nodes,function(Y){V[Y]=true;});S=B.mergeHashes(S,W.filters);delete X.partialRetrieval;}H.forEach(X.actions,R);});if(!J(V)){Q.nodes=B.keyarray(V);}if(!J(S)){Q.filters=P(I(S));}return Q;};mstrmojo.rw.model.RetrievalKeysConfig.parseResponseFilters=function N(R){var Q=function(U){var S={};B.forEach(U,function(X,W){var V=S[W]={serialized:X,include:{},exclude:{}};H.forEach(X.split(";"),function(Z){var Y=Z.indexOf("!")===0;Z=Y?Z.slice(1):Z;C(Z,Y?V.exclude:V.include);});});return S;};return{data:Q(R.data),defn:Q(R.defn)};};}());(function(){mstrmojo.requiresCls("mstrmojo.array","mstrmojo.hash");var K=mstrmojo.array,D=mstrmojo.hash;function E(W,U){var X=[],Q=W.selectedIndices,P=W.allIdx;var R,S,V=W.items;if(W.multiSelect&&(P>-1)&&(K.indexOf(U,W.allIdx)>-1)){for(R=0,S=V.length;R<S;R++){if(!Q[R]){X.push(R);Q[R]=true;W.selectedIndex=R;W.selectedItem=V[R];}}}else{for(R=0,S=U.length;R<S;R++){var Y=U[R];if(!Q[Y]){Q[Y]=true;X.push(Y);W.selectedIndex=Y;W.selectedItem=V[Y];}}}return X;}function J(R){var Q=[],S=R.selectedIndices,P;for(P in S){delete S[P];Q.push(parseInt(P,10));}R.selectedIndex=-1;R.selectedItem=null;return Q;}function H(W,V){var S=[],Q=W.selectedIndices,Y=K.indexOf,P=W.allIdx;if(W.multiSelect&&(P>-1)&&(Y(V,P)>-1)){return J(W);}if(V.length>0&&Q[P]){if(Y(V,P)<0){V.push(P);}}var U=V.length,R;for(R=0;R<U;R++){var X=V[R];if(Q[X]){delete Q[X];S.push(X);if(W.selectedIndex===X){W.selectedIndex=-1;W.selectedItem=null;}}}return S;}function A(S,R){var P=S.selectedIndices;if(!P){P={};S.selectedIndices=P;}if(!R){R={};}var V=S.selectedIndex,U=[],W,Q;for(Q in P){if(!R[Q]){W=parseInt(Q,10);delete P[Q];U.push(W);if(V===W){S.selectedIndex=-1;S.selectedItem=null;}}}var Y=[],X=S.items;for(Q in R){if(!P[Q]){W=parseInt(Q,10);P[Q]=true;Y.push(W);S.selectedIndex=W;S.selectedItem=X&&X[W];}}return{add:Y,rmv:U};}function G(Q,P,R){if(Q.raiseEvent&&((P&&P.length)||(R&&R.length))){Q.raiseEvent({name:"change",added:P,removed:R});}}mstrmojo._ListBase2Selections=mstrmojo.provide("mstrmojo._ListBase2Selections",{multiSelect:false,selectedIndices:null,selectedIndex:-1,selectedItem:null,selectedIndices_bindEvents:"change",selectedIndex_bindEvents:"change",selectedItem_bindEvents:"change",allowUnlistedValues:true,insertUnlistedValuesAt:-1,allIdx:-1,singleSelect:function F(P,Q){if(!this.selectedIndices[P]||(this.selectionPolicy==="reselect")||(P!==this.allIdx&&this.selectedIndices[this.allIdx])){var R=J(this),S=E(this,[P]);if(Q!==true){G(this,S,R);}}},toggleSelect:function O(P,Q){var S,R;if(this.selectedIndices[P]){R=H(this,[P]);}else{S=E(this,[P]);}if(Q!==true){G(this,S,R);}},rangeSelect:function N(P,Q){this.singleSelect(P,Q);},clearSelect:function I(P){var Q=J(this);if(P!==true){G(this,null,Q);}},select:function L(R,P){var Q=A(this,K.hash(R));if((P!==true)&&(Q.add.length||Q.rmv.length)){G(this,Q.add,Q.rmv);}},addSelect:function B(R,P){if(R===null||R===undefined){return null;}if(R.constructor!==Array){R=[R];}var Q=E(this,R);if(P!==true){G(this,Q,null);}return Q;},removeSelect:function M(R,P){if(R===null||R===undefined){return null;}if(R.constructor!==Array){R=[R];}var Q=H(this,R);if(P!==true){G(this,null,Q);}return Q;},_set_selectedIndices:function(S,Q,P){if(this.selectedIndices===Q){return false;}var R=A(this,Q);if(R.add.length||R.rmv.length){if(P!==true){G(this,R.add,R.rmv);}}return false;},_set_selectedIndex:function(S,Q,P){var R={};if(Q>-1){R[Q]=true;}return this._set_selectedIndices(null,R,P);},_set_selectedItem:function(X,U,S){var R=U&&(typeof U==="object"),W=this.itemIdField,Q=-1,V=this.items;if(R&&W!=null){Q=K.find(V,W,U[W]);}else{if(U!=null){Q=K.indexOf(V,U);}}if((Q===-1)&&(U!=null)&&this.allowUnlistedValues){var P=this.insertUnlistedValuesAt;if(P==null||P<0){P=(V&&V.length)||0;}Q=P;this.add([U],Q);}return this._set_selectedIndex(null,Q,S);},initSelections:function C(U,Q,P,S,R){if(!this.selectedIndices){this.selectedIndices={};this.selectedIndex=-1;}if(U){this._set_selectedIndices(null,U,R);}else{if(Q){this.select(Q,R);}else{if(S){this._set_selectedItem(null,S,R);}else{if(P!==null&&P!==undefined){this._set_selectedIndex(null,P,R);}}}}},sortSelectedIndices:function(){return D.keyarray(this.selectedIndices,true).sort(K.numSorter);},removeSelectedItems:function(){var R=this.sortSelectedIndices(),P=R.length,S=R[P-1],Q=this.remove(R);S=Math.min(S+1-P,this.items.length-1);if(S>=0){this.singleSelect(S);}return Q;},getSelectedItems:function(){return K.get(this.items,this.sortSelectedIndices())||[];},setSelectedItems:function(Q,e){if(!Q||!Q.length){return ;}var S=this.items||[],u=this.itemIdField!=null?K.findMulti(S,this.itemIdField,Q):K.indexOfMulti(S,Q),W=Q.length,U=W-u.count,r=this.allowUnlistedValues,d=this.insertUnlistedValuesAt,Y=(r&&(d>-1))?U:0;if(d<0){d=S.length;}var R=[],V=[],g=u.map;if(U&&r){var q=0,f;for(f=0;f<W;f++){if(g[f]==null){R.push(Q[f]);V.push(d+q++);}}this.add(R,d);}var X=[],l;for(l in g){var p=g[l];if(p>=d){p+=Y;}X.push(p);}var t=X.concat(V),Z=this.addSelect(t,!e);if(!e){var a=K.hash(Z),h=this.selectedIndices,b=[],o;for(o in h){if(!a[o]){b.push(parseInt(o,10));}}var P=this.removeSelect(b,true);G(this,Z,P);}}});}());(function(){mstrmojo.requiresCls("mstrmojo.func");mstrmojo.ACL.UserDataService=mstrmojo.provide("mstrmojo.ACL.UserDataService",{topgroups:null,userCandidates:null,getMembers:function(G,E){var F={taskId:"getUserEntityInfo",blockBegin:G.blockBegin,blockCount:G.blockCount,userEntityID:G.data.did,userEntityName:G.data.n||"",incremental:true,outputElements:G.outputElements||3};mstrmojo.xhr.request("POST",mstrConfig.taskURL,E,F);},getTopLevelGroups:function D(G,F){var E=this;if(this.topgroups){F.success({items:this.topgroups});return ;}F.success=mstrmojo.func.composite([F.success,function(H){E.topgroups=H.items;}]);this.getUsers({topGroupsOnly:true},F);},searchUserCandidates:function C(F,I,G,E){var H={blockBegin:1,blockCount:G,searchPattern:F,nameWildcards:I?4:2};this.getUsers(H,E);},getUserCandidates:function B(H,G){if(this.userCandidates){G.success(this.userCandidates);return ;}var E=G.success,F=this;G.success=function(J){F.userCandidates={items:J.items,isComplete:(parseInt(J.bc,10)===-1||(J.bb+J.bc>J.sz))};E(F.userCandidates);};var I={blockBegin:1,blockCount:H,nameWildcards:1};this.getUsers(I,G);},getUsers:function A(G,E){var F={taskId:"getUserServices"};mstrmojo.hash.copy(G,F);mstrmojo.xhr.request("POST",mstrConfig.taskURL,E,F);}});}());(function(){mstrmojo.requiresCls("mstrmojo.array");var B=mstrmojo.array;function A(C){if(C.parent){if(C.parent.shouldEllipsizeChildren===undefined){mstrmojo.mixin(mstrmojo._HasEllipsis,C.parent);}C.parent.set("shouldEllipsizeChildren",true);}}mstrmojo._HasEllipsis=mstrmojo.provide("mstrmojo._HasEllipsis",{shouldEllipsize:false,shouldEllipsizeChildren:false,doEllipsize:function(){if(this.shouldEllipsizeChildren){B.forEach(this.children,function(D,C){if(D.hasRendered&&D.doEllipsize){D.doEllipsize();}});}},onshouldEllipsizeChange:function(){this._onEllipsizeFlagChange(this.shouldEllipsize,this.shouldEllipsizeChildren);},onshouldEllipsizeChildrenChange:function(){this._onEllipsizeFlagChange(this.shouldEllipsizeChildren,this.shouldEllipsize);},_onEllipsizeFlagChange:function(D,C){if(D&&!C){A(this);this.markupMethods=mstrmojo.mixin({onvisibleChange:function(){if(this._super){this._super();}if(this.visible&&this.hasRendered){this.doEllipsize();}}},mstrmojo.hash.copy(this.markupMethods));}}});}());(function(){mstrmojo.requiresCls("mstrmojo.array");var G=mstrmojo.array;function B(){var H=this.buildConfig=this.buildConfig||{};H.pk=this.k;H.fgk=this.defn&&this.defn.fgk;return H;}mstrmojo._HasBuilder={builder:null,postBuildRendering:function D(){if(!this.builtChildren){this.buildChildren();}return this._super();},getChildren:function F(){return this.model.getChildren(this.node,false);},buildChildren:function E(H){if(!this.builder||!this.model){return false;}var J=this.children;if(J&&J.length){this.set("children",[]);}var I=this.builder.build(this.getChildren(),this.model,B.call(this));if(!H){this.addChildren(I);}this.builtChildren=true;return H?I:true;},rebuildChildren:function C(J){var P=this.children.slice(0),L=this.model,K=[],I,H=this,M=mstrApp.restoreVFKey,N,O;J=J||P.slice(0);J.forEach(function(S){var Q=G.indexOf(P,S),R=S.k;if(Q===-1){throw new Error("Invalid child requested rebuild in mstrmojo._HasBuilder::rebuildChild.");}this.removeChildren(S);S.destroy();K.push(R);},this);if(mstrApp.isInVFConfigMode&&(mstrApp.showBandingInVFConfigMode||mstrApp.showOutlineInVFConfigMode)&&!!J&&J.length===1&&!!J[0]&&J[0].k===M){delete mstrApp.showBandingInVFConfigMode;delete mstrApp.showOutlineInVFConfigMode;N=L.insertVizBox(M,H,{});L.selectVIUnit(N.id,true,{});I=[N];}else{O=L.getChildrenByKey(this.node,false,K);I=this.builder.build(O,L,B.call(this));this.addChildren(I);}return I;},rebuildChild:function A(H){return this.rebuildChildren([H])[0];}};}());(function(){mstrmojo.requiresCls("mstrmojo.array");var H=mstrmojo.array,D={},G={},A="72px",F="abcdefghijklmnopqrstuvwxyz0123456789";function C(I){return I.name+":"+(I.isItalic?"i":"n")+(I.isBold?"7":"4");}mstrmojo.util.FontLoader=mstrmojo.provide("mstrmojo.util.FontLoader",{load:function E(N,O){var L=this,J=[],K;H.forEach(N,function(P){if(!L.isFontInstalled(P)){K=C(P);if(!D[K]&&!G[K]){J.push(K);}}});if(!window.WebFont||J.length===0){return true;}window.WebFont.load({custom:{families:J},fontactive:function(Q,P){D[Q+":"+P]=true;},fontinactive:function(Q,P){G[Q+":"+P]=true;},active:function M(){O.success();},inactive:function I(){O.failure();}});return false;},isFontInstalled:function B(J){var K=document.createElement("canvas"),L=K.getContext("2d"),P=J.isItalic?"italic":"normal",I=J.isBold?"bold":"normal",N=P+" "+I+" "+A,O,M;L.font=N+" monospace";O=L.measureText(F).width;L.font=N+" '"+J.name+"', monospace";M=L.measureText(F).width;K=null;return O!==M;}});})();(function(){mstrmojo.requiresCls("mstrmojo.array");var I=mstrmojo.array,Q=mstrmojo.desc(2412,"Default"),P=mstrmojo.desc(3433,"Font"),K=mstrmojo.desc(3434,"Number"),D=mstrmojo.desc(3435,"Alignment"),N=mstrmojo.desc(2886,"Borders"),E=mstrmojo.desc(3905,"Background"),R="-1,234.12",C="1,234.12",M="(1,234.12)",H="-$1,234.12",B="$1,234.12",J="($1,234.12)";var O=[{n:Q,v:"pru"}];I.forEach(["Arial","Arial Black","Arial Narrow","Arial Unicode MS","Batang","Book Antiqua","Bookman Old Style","Bookshelf Symbol 1","Bookshelf Symbol 2","Bookshelf Symbol 3","Comic Sans MS","Courier New","Garamond","Haettenschweiler","Helvetica","Impact","Lucida Console","Lucida Sans Unicode","Map Symbols","Marlett","Monotype Corsiva","Monotype Sorts","MS Gothic","MS Outlook","Microsoft Sans Serif","MT Extra","Open Sans SemiBold","Open Sans","Symbol","Tahoma","Times New Roman","Trebuchet MS","Verdana","Webdings","Wingdings","Wingdings 2","Wingdings 3"],function(S){O.push({n:S,v:S,symbolic:true});});function G(U,S,V){return(S&&S>=U)?G(U,S-V,V).concat(S):[];}var A=G(2,12,1);A=A.concat(G(14,24,2));A=A.concat(G(36,48,12));A=A.concat(G(72,72,1));var F=[{n:Q,v:"pru"}];I.forEach(A,function(S){F.push({n:String(S),v:String(S)});});mstrmojo._FormatDefinition={Formats:[{n:P},{n:K},{n:D},{n:mstrmojo.desc(3436,"Color and Lines")}],FormatTarget:[{n:mstrmojo.desc(7942,"Element Header"),v:1,p:"header_format"},{n:mstrmojo.desc(7943,"Element Value"),v:2,p:"grid_format"},{n:mstrmojo.desc(7944,"Individual Items Header"),v:3,p:"child_header_format"},{n:mstrmojo.desc(7945,"Individual Items Value"),v:4,p:"child_grid_format"}],MetricFormatTarget:[{n:mstrmojo.desc(9710,"Metric Headers"),v:1,p:"header_format"},{n:mstrmojo.desc(9711,"Metric Values"),v:2,p:"grid_format"}],MetricValueFormats:[{n:K},{n:D},{n:P},{n:N},{n:E}],MetricHeaderFormats:[{n:K},{n:D},{n:P},{n:N},{n:E},{n:mstrmojo.desc(12139,"Chart")}],NumberFormatCategory:{Automatic:-3,Default:-2,General:9,Fixed:0,Currency:1,Date:2,Time:3,Percentage:4,Fraction:5,Scientific:6,Custom:7},DefaultFormat:{FormattingAlignment:{Horizontal:"1",Vertical:"1",TextWrap:"0",TextDirection:"0"},FormattingBorder:{HInsideStyle:"1",VInsideStyle:"1",TopStyle:"1",LeftStyle:"1",BottomStyle:"1",RightStyle:"1",HInsideColor:"0",VInsideColor:"0",TopColor:"0",LeftColor:"0",BottomColor:"0",RightColor:"0",Border3DStyle:"0",Border3DWeight:"0",Border3DBottomColor:"0",Border3DLeftColor:"0",Border3DRightColor:"0",Border3DTopColor:"0"},FormattingFont:{Name:"Arial",Bold:"0",Italic:"0",Size:"10",Strikeout:"0",Underline:"0",Color:"0",Script:"0"},FormattingNumber:{Category:"9",DecimalPlaces:"0",ThousandSeparator:"-1",CurrencySymbol:"$",CurrencyPosition:"0",Format:"General",NegativeNumbers:"3"},FormattingPadding:{LeftPadding:"1",RightPadding:"1",TopPadding:"1",BottomPadding:"1",LineSpacing:"0"},FormattingPatterns:{FillColor:"16777215",PatternColor:"8650752",PatternStyle:"1",FillStyle:"0",ApplyToGraphThreshold:"0",GradientColor:"16777215",GradientAngle:"0",GradientXOffset:"0",GradientYOffset:"0",SelectorSelectionColor:"16167264",SelectorSelectionFillStyle:"0",SeriesFillColor:"pru",SeriesPatternColor:"8650752",SeriesPatternStyle:"1",SeriesFillStyle:"0",SeriesApplyToGraphThreshold:"0",SeriesGradientColor:"16777215",SeriesGradientAngle:"0",SeriesGradientXOffset:"0",SeriesGradientYOffset:"0",SeriesSelectorSelectionColor:"16167264",SeriesSelectorSelectionFillStyle:"0"}},Families:O,Sizes:F,SizesInVI:F.slice(7,19),Styles:[{n:Q,v:"pru"},{n:mstrmojo.desc(3440,"Regular"),v:"0,0"},{n:mstrmojo.desc(2718,"Bold"),v:"-1,0",v2:"-1,"},{n:mstrmojo.desc(2719,"Italic"),v:"0,-1",v2:",-1"},{n:mstrmojo.desc(3441,"Bold Italic"),v:"-1,-1"}],Effects:[{n:"Underline",v:0},{n:"Strike",v:1}],Category:[{n:Q,v:-2},{n:mstrmojo.desc(2378,"General"),v:9},{n:mstrmojo.desc(2050,"Fixed"),v:0},{n:mstrmojo.desc(2051,"Currency"),v:1},{n:mstrmojo.desc(2052,"Date"),v:2},{n:mstrmojo.desc(2170,"Time"),v:3},{n:mstrmojo.desc(2053,"Percentage"),v:4},{n:mstrmojo.desc(2054,"Fraction"),v:5},{n:mstrmojo.desc(2055,"Scientific"),v:6},{n:mstrmojo.desc(2056,"Custom"),v:7}],MaxNegativeDidigts:30,FixedNegative:[{n:R,v:1,f:"#,##0.00"},{n:R,r:true,v:5,f:"#,##0.00;[RED]-#,##0.00"},{n:C,r:true,v:2,f:"#,##0.00;[RED]#,##0.00"},{n:M,v:3,f:"#,##0.00;(#,##0.00)"},{n:M,r:true,v:4,f:"#,##0.00;[RED](#,##0.00)"}],CurrencyNegative:[{n:H,v:1,f:'"$"#,##0.00'},{n:H,r:true,v:5,f:'"$"#,##0.00;[RED]-"$"#,##0.00'},{n:B,r:true,v:2,f:'"$"#,##0.00;[RED]"$"#,##0.00'},{n:J,v:3,f:'"$"#,##0.00;("$"#,##0.00)'},{n:J,r:true,v:4,f:'"$"#,##0.00;[RED]("$"#,##0.00)'}],CurrencyPosition:[{n:mstrmojo.desc(2194,"Left"),v:0},{n:mstrmojo.desc(2195,"Right"),v:1},{n:mstrmojo.desc(2183,"Left with space"),v:2},{n:mstrmojo.desc(2182,"Right with space"),v:3}],Date:[{n:mstrmojo.desc(2231,"4/7"),v:"m/d"},{n:mstrmojo.desc(2232,"04/07"),v:"mm/dd"},{n:mstrmojo.desc(2233,"4/7/98"),v:"m/d/yy"},{n:mstrmojo.desc(2234,"04/07/98"),v:"mm/dd/yy"},{n:mstrmojo.desc(2235,"04/07/1998"),v:"mm/dd/yyyy"},{n:mstrmojo.desc(2236,"7-Apr"),v:"d-mmm"},{n:mstrmojo.desc(2237,"7-Apr-98"),v:"d-mmm-yy"},{n:mstrmojo.desc(2238,"Apr-98"),v:"mmm-yy"},{n:mstrmojo.desc(2239,"Apr '98"),v:"mmm 'yy"},{n:mstrmojo.desc(2240,"April 1998"),v:"mmmm yyyy"},{n:mstrmojo.desc(2241,"4/7/98 15:41"),v:"m/d/yy h:mm"},{n:mstrmojo.desc(2242,"4/7/98 3:41 PM"),v:"m/d/yy h:mm AM/PM"},{n:mstrmojo.desc(2243,"April 7, 1998"),v:"mmmm d, yyyy"}],Time:[{n:mstrmojo.desc(2244,"15:41"),v:"h:mm"},{n:mstrmojo.desc(2245,"3:41 PM"),v:"h:mm AM/PM"},{n:mstrmojo.desc(2246,"15:41:46"),v:"h:mm:ss"},{n:mstrmojo.desc(2247,"3:41:46 PM"),v:"h:mm:ss AM/PM"},{n:mstrmojo.desc(2241,"4/7/98 15:41"),v:"m/d/yy h:mm"},{n:mstrmojo.desc(2242,"4/7/98 3:41 PM"),v:"m/d/yy h:mm AM/PM"},{n:mstrmojo.desc(2250,"04/07/98 15:41"),v:"mm/dd/yy h:mm"},{n:mstrmojo.desc(2248,"04/07/98 3:41 PM"),v:"mm/dd/yy h:mm AM/PM"}],PercentNegative:[{n:"-12.12%",v:1,f:"0.00%"},{n:"-12.12%",r:true,v:5,f:"0.00%;[RED]-0.00%"},{n:"12.12%",r:true,v:2,f:"0.00%;[RED]0.00%"},{n:"(12.12%)",v:3,f:"0.00%;(0.00%)"},{n:"(12.12%)",r:true,v:4,f:"0.00%;[RED](0.00%)"}],Fraction:[{n:"12 1/3",v:"# ?/?"},{n:"37/3",v:"?/?"},{n:"12 26/81",v:"# ??/??"},{n:"998/81",v:"??/??"}],TextDirection:[{n:Q,v:"pru"},{n:mstrmojo.desc(4601,"Horizontal"),v:0},{n:mstrmojo.desc(5156,"-90 Degree"),v:-90}],Horizontal:[{n:mstrmojo.desc(2296,"Use Default"),v:"pru"},{n:mstrmojo.desc(2378,"General"),v:1},{n:mstrmojo.desc(2194,"Left"),v:2},{n:mstrmojo.desc(2193,"Center"),v:3},{n:mstrmojo.desc(2195,"Right"),v:4},{n:mstrmojo.desc(2068,"Justify"),v:6}],Vertical:[{n:mstrmojo.desc(2296,"Use Default"),v:"pru"},{n:mstrmojo.desc(2256,"Top"),v:1},{n:mstrmojo.desc(2067,"Center"),v:2},{n:mstrmojo.desc(2257,"Bottom"),v:3}],TextWrap:[{v:0},{v:-1}],BorderStyles:[{n:Q,v:"pru"},{n:mstrmojo.desc(2258,"None"),v:0},{n:mstrmojo.desc(2259,"Dashed"),v:3},{n:mstrmojo.desc(2260,"Dotted"),v:4},{n:mstrmojo.desc(2261,"Hair"),v:7},{n:mstrmojo.desc(2262,"Thin"),v:1},{n:mstrmojo.desc(2264,"Thick"),v:5},{n:mstrmojo.desc(15361,"Double"),v:6}],extractModel:function(V,X,U){var Z=U||this.DefaultFormat,Y;for(Y in V){var S=V[Y];if(!S.attachEventListener){if(!mstrmojo.hash.isEmpty(S)){X[Y]=S;}}else{var W;for(W in S){if(Z[Y]&&Z[Y][W]){if(!X[Y]){X[Y]={};}X[Y][W]=S[W];}}}}},getAvailableFonts:function L(){var S={success:function(V){if(V.name==="fontPicker"){var U=[{n:Q,v:"pru"}];I.forEach(V.shortcuts,function(X){var Y=X.attributes,Z=I.filterOne(Y,function(a){return a.value;}),W=I.filterOne(Y,function(a){return a.symbolic;});U.push({n:Z&&Z.value,v:Z&&Z.value,symbolic:(W&&W.symbolic||"false").toUpperCase()==="TRUE"});});mstrmojo._FormatDefinition.Families=U;}}};mstrmojo.xhr.request("POST",mstrConfig.taskURL,S,{taskId:"getSystemPickerJson",name:"fontPicker"},false,null,true);},getStandardFormat:function(U,S){var W=mstrmojo.hash.clone(S||this.DefaultFormat),V;U=U||{};for(V in W){U[V]=U[V]||{};}for(V in U){if(!U[V].attachEventListener){U[V]=mstrmojo.hash.make(U[V],mstrmojo.Obj);}}return U;},saveFormatModel:function(X,d,U,e){var c=e||this.DefaultFormat,Z,S;for(Z=0;Z<U.length;Z++){var Y=U[Z],W=d[Y]||null,b=X[Y];if(b===undefined){delete d[Y];continue;}for(S in c){var a=c[S],V;if((!W&&!b)||(W&&!W[S]&&!b[S])){continue;}for(V in a){if(b[S]===undefined||b[S]===""||b[S][V]==="pru"||b[S][V]===undefined){if(W&&W[S]&&(W[S][V]!==undefined&&W[S][V]!==null&&W[S][V]!=="pru")){W[S][V]="pru";}}else{W=W||{};W[S]=W[S]||{};W[S][V]=b[S][V];}}}if(W){d[Y]=W;}}}};}());(function(){mstrmojo.requiresCls("mstrmojo.array");var E="*",A=".",C="-",J="_",H="<";var M=new RegExp("[\\"+E+"\\"+A+"\\"+C+"\\"+J+"\\"+H+"]","g"),G=E+"$&";mstrmojo.Serializer={scriptClass:"mstrmojo.Serializer",serializeValueGroup:function F(B){mstrmojo.array.forEach(B,function(D,K){B[K]=mstrmojo.Serializer.serializeValues(D);});return C+this.serializeValues(B)+J;},serializeValues:function I(D){var B=[];mstrmojo.array.forEach(D,function(K){if(typeof K==="Boolean"){K=K?"1":"0";}B.push(String(K).replace(M,G));});return B.join(A);}};}());(function(){mstrmojo.requiresCls("mstrmojo.array");var I="#000000",E=Math.round;function O(Z){return("0"+parseInt(Z,10).toString(16)).slice(-2);}mstrmojo.color=mstrmojo.provide("mstrmojo.color",{rgbStr2rgb:function X(Z){if(Z==="transparent"){return["0","0","0"];}else{return Z.match(/^rgba?[\s+]?\([\s+]?(\d+)[\s+]?,[\s+]?(\d+)[\s+]?,[\s+]?(\d+)[\s+]?/i).slice(1);}},rgbStr2hex:function G(Z){if(Z.indexOf("rgb")>=0){var a=this.rgbStr2rgb(Z);return"#"+this.rgb2hex(a[0],a[1],a[2]);}return Z;},rgb2hex:function B(c,a,Z){return O(c)+O(a)+O(Z);},rgb2hsv:function W(Z,j,l){var e=Math.min(Z,j,l),m=Math.max(Z,j,l),f=0,p,o;o=m/255;p=(m!==0)?(parseFloat(m)-parseFloat(e))/parseFloat(m):0;if(p===0){f=0;}else{var k=m-e,a=(m-Z)/k,c=(m-j)/k,n=(m-l)/k;if(Z===m){f=n-c;}else{if(j===m){f=2+a-n;}else{f=4+c-a;}}f=f/6;if(f<0){f=f+1;}}return[E(f*360),E(p*100),E(o*100)];},rgb2hsl:function D(Z,e,f){Z/=255;e/=255;f/=255;var j=Math.max(Z,e,f),c=Math.min(Z,e,f),a=(j+c)/2,d,m;if(j===c){d=m=0;}else{var k=j-c;m=a>0.5?k/(2-j-c):k/(j+c);switch(j){case Z:d=(e-f)/k+(e<f?6:0);break;case e:d=(f-Z)/k+2;break;case f:d=(Z-e)/k+4;break;}d/=6;}return[d,m,a];},hsl2rgb:function C(f,m,e){var d=function d(h,g,b){if(b<0){b+=1;}if(b>1){b-=1;}if(b<1/6){return h+(g-h)*6*b;}if(b<1/2){return g;}if(b<2/3){return h+(g-h)*(2/3-b)*6;}return h;},Z,j,k;if(m===0){Z=j=k=e;}else{var a=e<0.5?e*(1+m):e+m-e*m,c=2*e-a;Z=d(c,a,f+1/3);j=d(c,a,f);k=d(c,a,f-1/3);}return[E(Z*255),E(j*255),E(k*255)];},hsl2hex:function J(b,a,Z){return"#"+mstrmojo.array.map(this.hsl2rgb(b,a,Z),function(c){return O(c);}).join("");},hex2rgb:function Q(c){var Z=this.fixFullHexValue("#"+c.replace("#","")),a=[],b;Z=Z.replace("#","");for(b=0;b<3;b++){a.push(parseInt(Z.substr(b*2,2),16));}return a;},hex2bgr:function L(Z){return this.hex2rgb(Z).reverse();},hex2hsv:function U(a){var Z=this.hex2rgb(a);return this.rgb2hsv(Z[0],Z[1],Z[2]);},hex2hsl:function Y(Z){return this.rgb2hsl.apply(this,this.hex2rgb(Z));},hsv2rgb:function H(k,w,o){k=k/360;w=w/100;o=o/100;var Z,l,n;if(w===0){Z=o*255;l=o*255;n=o*255;}else{var d=k*6;if(d===6){d=0;}var j=Math.floor(d);var c=o*(1-w);var a=o*(1-w*(d-j));var u=o*(1-w*(1-(d-j)));var m,e,f;switch(j){case 0:m=o;e=u;f=c;break;case 1:m=a;e=o;f=c;break;case 2:m=c;e=o;f=u;break;case 3:m=c;e=a;f=o;break;case 4:m=u;e=c;f=o;break;default:m=o;e=c;f=a;break;}Z=m*255;l=e*255;n=f*255;}return[E(Z),E(l),E(n)];},hsv2hex:function M(c,b,Z){var a=this.hsv2rgb(c,b,Z);return this.rgb2hex(a[0],a[1],a[2]);},getContrastingColor:function N(c,a,Z){var b=this.hex2rgb(c);return(((b[0]*299)+(b[1]*587)+(b[2]*114))/1000<125)?a:Z;},getLuminance:function F(a){var Z=this.hex2rgb(a);return 0.2126*Z[0]+0.7152*Z[1]+0.0722*Z[2];},getHighlightColor:function S(j,f){var Z,h,k,l,m=this.hex2rgb(!f?"#FFCE7F":"#EFE6D8"),e=parseInt(j[0],10),c=parseInt(j[1],10),o=parseInt(j[2],10),d=parseInt(m[0],10),a=parseInt(m[1],10),n=parseInt(m[2],10);Z=(e*d)/255;h=(c*a)/255;k=(o*n)/255;l=e*0.3+c*0.59+o*0.11;if(l<85){Z=Z+(63*(85-l)/85);Z=Z>255?255:Z;h=h+(63*(85-l)/85);h=h>255?255:h;k=k+(63*(85-l)/85);k=k>255?255:k;}return"#"+this.rgb2hex(E(Z),E(h),E(k));},get3DBorderColor:function R(c,f){var a=parseInt(c[0],10)*0.3+parseInt(c[1],10)*0.59+parseInt(c[2],10)*0.11;var e=parseInt(c[0],10);var d=parseInt(c[1],10);var Z=parseInt(c[2],10);switch(f){case"light":if(a>150){e=e*0.9;d=d*0.9;Z=Z*0.9;}else{e=e*0.6+102;d=d*0.6+102;Z=Z*0.6+102;}break;case"dark":if(a>10){e=e*0.4;d=d*0.4;Z=Z*0.4;}else{e=e*0.8+30;d=d*0.8+30;Z=Z*0.8+30;}break;}return"#"+this.rgb2hex(E(e),E(d),E(Z));},encodeColor:function K(Z,a){if(a!==undefined&&(Z===null||Z.length===0||Z==="undefined")){Z=a;}if(Z==="transparent"){return -1;}if(parseInt(Z,10)===-2){return -2;}if(Z.substring(0,1)==="#"){Z=Z.substring(1);}return parseInt(Z.substring(4)+Z.substring(2,4)+Z.substring(0,2),16);},decodeColor:function A(Z){Z=parseInt(Z,10);if(Z===0){return I;}var a=16777216+(Z&255)*65536+(Z&65280)+(Z&16711680)/65536;return"#"+a.toString(16).substring(1).toUpperCase();},fixFullHexValue:function V(Z){if(Z&&Z.length===4){return Z.replace(/([0-9a-f])/ig,"$1$1");}return Z;},findMidColorHex:function P(c,b){var d=this.hex2rgb(c),Z=this.hex2rgb(b),a=[];d.forEach(function(e,f){a.push(parseInt((e+Z[f])/2,10));});return("#"+this.rgb2hex(a[0],a[1],a[2]));}});}());(function(){mstrmojo.requiresCls("mstrmojo.array");var A=mstrmojo.array;mstrmojo.fe._IsRelationTreeNode=mstrmojo.provide("mstrmojo.fe._IsRelationTreeNode",{createSetHtml:'<span class="mstrmojo-textset mstrmojo-create-set-text" mstrAttach:click >'+mstrmojo.desc(12034,"Create a Set")+"</span>",syncRootOperator:function(){var F=this.parent,H=function(){var J=this.parent,I=[];if(J){I=J.ctxtBuilder.itemWidgets;}return I;},E,D,B,C,G;if(F){E=H.call(this);B=E.length;D=A.find(E,"noRelationOperator",true)!==-1;for(C=0;C<B;C++){G=E[C];G&&G.set("noRelationOperator",D);}this.set("noRelationOperator",D);}}});}());(function(){mstrmojo.requiresCls("mstrmojo.dom");mstrmojo.fx={enabled:true};var E=mstrmojo.dom;mstrmojo.fx._Effect=mstrmojo.declare(null,null,{scriptClass:"mstrmojo.fx._Effect",duration:500,interval:50,delay:null,target:null,getTarget:null,widget:null,slot:null,preStart:null,postStart:null,onCancel:null,onEnd:null,revertOnCancel:true,isPlaying:false,started:false,init:function R(X){mstrmojo.hash.copy(X,this);},play:function C(){this.isPlaying=true;this.started=false;if(this.delay){var X=this;this.delayTimer=window.setTimeout(function(){X._start();X=null;},this.delay);}else{this._start();}},pause:function H(){if(this.delayTimer){window.clearTimeout(this.delayTimer);delete this.delayTimer;}if(this.timer){window.clearInterval(this.timer);delete this.timer;}this.isPlaying=false;},cancel:function V(){this.pause();if(this.started){if(this.revertOnCancel){this.counter=0;this.exec();}if(this.onCancel){this.onCancel();}this.started=false;}},_start:function F(){this.started=true;this._doTarget();this.steps=Math.max(Math.ceil(this.duration/this.interval),1);var X=this.ease;if(typeof X==="string"){this.ease=mstrmojo.registry.ref(X);}if(this._doPreStart()===false){this.started=false;this.isPlaying=false;return ;}this.counter=0;this.exec();this.counter++;this._doPostStart();if(this.counter>=this.steps){this._end();}else{var Y=this;if(this.timer){window.clearInterval(this.timer);}this.timer=window.setInterval(function Z(){if(Y){Y.exec();Y.counter++;if(Y.counter>=Y.steps){Y._end();Y=null;}}},this.interval);}},exec:null,_end:function D(){this.pause();this.started=false;if(this.onEnd){this.onEnd();}},_doTarget:function U(){if(this.getTarget){this.target=this.getTarget();}else{if(this.widget){this.target=this.widget[this.slot||"domNode"];}else{if(this.target){var Y=this.target;if(Y&&this.slot&&Y.scriptClass){var Z=Y[this.slot];if(Z){this.widget=Y;this.target=Z;}}}}}if(!this.target){var X=this;while(X=X.parent){if(!X||X.domNode){break;}}if(X){this.widget=X;this.target=X[this.slot||"domNode"];}}},_doPreStart:function N(){if(this.preStart){return this.preStart();}},_doPostStart:function S(){if(this.postStart){this.postStart();}}});function M(a,b){var Y=a.children,X=(Y&&Y.length)||0,Z;for(Z=0;Z<X;Z++){Y[Z][b]();}}mstrmojo.fx.Parallel=mstrmojo.declare(mstrmojo.fx._Effect,null,{scriptClass:"mstrmojo.fx.Parallel",init:function R(a){this._super(a);var Z=this.children;mstrmojo.registry.refArray(Z);var X=(Z&&Z.length)||0,Y;for(Y=0;Y<X;Y++){Z[Y].parent=this;}},_start:function F(){this.started=true;if(this.preStart){this.preStart();}M(this,"play");if(this.postStart){this.postStart();}},pause:function H(){M(this,"pause");},cancel:function V(){M(this,"cancel");}});mstrmojo.fx.AnimateProp=mstrmojo.declare(mstrmojo.fx._Effect,null,{scriptClass:"mstrmojo.fx.AnimateProp",props:null,_start:function O(){var Z=this.props,a;for(a in Z){var Y=Z[a],X=Y.ease;if(typeof X==="string"){Y.ease=mstrmojo.registry.ref(X,{dontInst:true});}}this._super();},exec:function P(){var a=this.props,b;for(b in a){var Y=a[b],X=(Y.ease||mstrmojo.ease.sin)(this.counter,Y.start,Y.stop-Y.start,this.steps-1);if(Y.fn){X=Y.fn(X);}if(Y.suffix){X+=Y.suffix;}var Z=Y.isStyle===false?this.target:this.target.style;Z[b]=X;}}});mstrmojo.fx.Typewriter=mstrmojo.declare(mstrmojo.fx._Effect,null,{scriptClass:"mstrmojo.fx.Typewriter",charGroupSize:1,srcProp:"text",_doPreStart:function(){this._super();this._dynStop=false;if(this.stop==null){var b=this.srcProp,Z;if(b){var X=this.widget||this.parent;Z=X&&X[b];if((Z!=null)&&(typeof (Z)!=="string")){Z=String(Z);}}this.stop=Z;this._dynStop=true;}if(this.stop==null){this.stop="";}var a=this.target,c=null,Y=1;if(a){a.innerHTML="";c=document.createTextNode("");a.appendChild(c);Y=Math.max(Math.floor(this.stop.length/this.steps),1);}this.targetTextNode=c;this.charGroupSize=Y;},exec:function(){var Y=this.targetTextNode;if(!Y){return ;}var X;if(this.counter>=this.steps-1){X=this.stop;}else{if(this.counter===0){X="";}else{X=this.stop.substring(0,this.charGroupSize*this.counter)+"_";}}Y.nodeValue=X;},_end:function D(){this._super();if(this._dynStop){this.stop=null;delete this._dynStop;}},cancel:function V(){if(this._dynStop){this.stop=null;delete this._dynStop;}}});mstrmojo.requiresCls("mstrmojo.dom");mstrmojo.fx.Fade=mstrmojo.declare(mstrmojo.fx._Effect,null,{scriptClass:"mstrmojo.fx.Fade",start:null,stop:null,ease:null,suffix:null,exec:function P(X){if(X==null){X=(this.ease||mstrmojo.ease.sin)(this.counter,this.start,this.stop-this.start,this.steps-1);}if(E.isIE&&!E.isWinPhone){this.target.style.filter="alpha(opacity="+parseInt(X*100,10)+")";}else{this.target.style.opacity=X;}}});mstrmojo.fx.FadeOut=mstrmojo.declare(mstrmojo.fx.Fade,null,{scriptClass:"mstrmojo.fx.FadeOut",start:1,stop:0,revertOnCancel:true,cssDisplay:"block",_end:function D(){if(this.cssDisplay){this.target.style.display="none";this.exec(this.start);}this._super();},cancel:function V(){if(this.started&&this.cssDisplay){this.target.style.display=this.cssDisplay;}this._super();}});mstrmojo.fx.FadeIn=mstrmojo.declare(mstrmojo.fx.Fade,null,{scriptClass:"mstrmojo.fx.FadeIn",start:0,stop:1,revertOnCancel:true,cssDisplay:"block",_doPostStart:function W(){if(this.cssDisplay){this.target.style.display=this.cssDisplay;}this._super();},cancel:function(){if(this.started&&this.revertOnCancel&&this.cssDisplay){this.target.style.display="none";}this._super();}});function I(Z,Y,a){var X=Math.pow(10,a||2);if(Y){return parseInt(X*Z/Y,10)/X;}return parseInt(X*Z,10)/X;}mstrmojo.ease={linear:function L(Y,X,a,Z){if(Y===Z){return X+a;}if(Y===0){return X;}return X+a*I(Y,Z);},sin:function A(Y,X,a,Z){return X+a*Math.sin((Math.PI/2)*Y/Z);},cos:function B(Y,X,a,Z){return X+a*Math.cos((Math.PI/2)*(1-Y/Z));},sincos:function K(Y,X,a,Z){if(Y>Z/2){return X+a*Math.cos((Math.PI/2)*(1-Y/Z));}return X+a*Math.sin((Math.PI/2)*Y/Z);},cossin:function Q(Y,X,a,Z){if(Y>Z/2){return X+a*Math.sin((Math.PI/2)*Y/Z);}return X+a*Math.cos((Math.PI/2)*(1-Y/Z));},bounce:function G(Y,X,a,Z){if((Y/=Z)<(1/2.75)){return a*(7.5625*Y*Y)+X;}if(Y<(2/2.75)){return a*(7.5625*(Y-=(1.5/2.75))*Y+0.75)+X;}if(Y<(2.5/2.75)){return a*(7.5625*(Y-=(2.25/2.75))*Y+0.9375)+X;}return a*(7.5625*(Y-=(2.625/2.75))*Y+0.984375)+X;},shake:function J(Y,X,a,Z){if(Y<Z/2){return X+a*I(Math.sin(2*Math.PI*Y/8),null,2)*2*Y/Z;}return X+a*I(Math.sin(2*Math.PI*Y/8),null,2)*2*(1-Y/Z);}};}());(function(){mstrmojo.requiresCls("mstrmojo.dom");function G(J){return(J&&J.id);}mstrmojo._HasScrollbox=mstrmojo.provide("mstrmojo._HasScrollbox",{_mixinName:"mstrmojo._HasScrollbox",scrollListeners:null,scrollListenerCount:0,scrollInterval:50,scrollboxNode:undefined,scrollTo:function F(L,K){var J=this.scrollboxNode;J.scrollLeft=L.x;J.scrollTop=L.y;if(K){this.notifyScrollListeners(L);}},connectScrollbox:function E(K){if(!G(K)){return ;}var L=this.scrollListeners,J=K.id;if(!L){L={};this.scrollListeners=L;}if(!L[J]){L[J]=K;this.scrollListenerCount++;if(this.scrollListenerCount===1){this._attachScrollDom();}}},disconnectScrollbox:function D(K){if(!G(K)){return ;}var L=this.scrollListeners,J=K.id;if(L&&L.hasOwnProperty(J)){delete this.scrollListeners[J];this.scrollListenerCount--;if(!this.scrollListenerCount){this._detachScrollDom();}}},notifyScrollListeners:function C(K){var N=K||this.getScrollPos(),M=N.y,L=N.x;this.scrollboxTop=M;this.scrollboxLeft=L;this.scrollboxRight=L+this.scrollboxWidth;this.scrollboxBottom=M+this.scrollboxHeight;var J=this.scrollListeners,O;for(O in J){J[O].onscroll(this);}},getScrollPos:function H(){var J=this.scrollboxNode;return{x:J.scrollLeft,y:J.scrollTop};},_attachScrollDom:function A(){var M=this.scrollboxNode;if(M){var L=this.usesTouches;if(!L){if(!this.scrollCallback){var K=this.id;this.scrollCallback=function(){mstrmojo.all[K].notifyScrollListeners();};}mstrmojo.dom.attachBufferedEvent(M,"scroll",this.scrollCallback,this.scrollInterval);}if(this.scrollboxTop===null){this.scrollboxTop=L?0:M.scrollTop;}if(this.scrollboxLeft===null){this.scrollboxLeft=L?0:M.scrollLeft;}var J=function(P){var O=P.toLowerCase();var N=M.style[O];return(!isNaN(N)&&N.charAt(N.length-1)!=="%")?parseInt(N,10):M["client"+P];};if(this.scrollboxHeight===null){this.scrollboxHeight=J("Height");}if(this.scrollboxWidth===null){this.scrollboxWidth=J("Width");}this.scrollboxBottom=this.scrollboxTop+this.scrollboxHeight;this.scrollboxRight=this.scrollboxLeft+this.scrollboxWidth;this._attachedScrollbox=M;}},_detachScrollDom:function I(){var J=this._attachedScrollbox;if(J&&this.scrollCallback){mstrmojo.dom.detachBufferedEvent(J,"scroll",this.scrollCallback,this.scrollInterval);}delete this._attachedScrollbox;},scrollboxTop:null,scrollboxLeft:null,scrollboxHeight:null,scrollboxBottom:null,buildRendering:function B(){this._detachScrollDom();this._super();if(this.scrollListenerCount){this._attachScrollDom();}}});}());(function(){mstrmojo.requiresCls("mstrmojo.dom");var F=mstrmojo.dom;var W="touchstart",J="mousedown",P=F.isIOSTouch,S=P?W:J;function X(Z){var Y=Z[Z.hotSlot||"domNode"];if(Y){if(!Z._closeCallback){var b=Z.id,a=function(c){return function(f){var d=mstrmojo.all[b];if(d&&!d.ignoreHover){d["auto"+c](f,self);}};};Z._uncloseCallback=a("Unclose");Z._closeCallback=a("Close");}F.attachEvent(Y,"mouseover",Z._uncloseCallback);F.attachEvent(Y,"mouseout",Z._closeCallback);}}function C(Z){if(Z._closeCallback){var Y=Z[Z.hotSlot||"domNode"];if(Y){F.detachEvent(Y,"mouseover",Z._uncloseCallback);F.detachEvent(Y,"mouseout",Z._closeCallback);}}}function G(b,Z){var Y=b,a;while(Y){if(Y.open||Y.openPopup){a=Y.ignoreHoverCount||0;a=Z?(a+1):(a>0?a-1:a);Y.ignoreHoverCount=a;if(Y.set){Y.set("ignoreHover",(a>0));}else{Y.ignoreHover=(a>0);}}Y=Y.opener||Y.parent;if(Y&&Y.shouldPropagateLockHover&&!Y.shouldPropagateLockHover()){break;}}}function E(){var a=this._lockHoverCallback,Z=this.curtainNode,c=this._onClickChange;if(a){F.detachEvent(document.body,S,a,true);delete this._lockHoverCallback;}if(!Z||!c){return ;}var Y=mstrApp&&mstrApp.isTouchApp&&mstrApp.isTouchApp()||P,b=Y?W:J;F.detachEvent(Z,b,c);delete this._onClickChange;}mstrmojo._CanAutoClose=mstrmojo.provide("mstrmojo._CanAutoClose",{autoCloses:false,autoCloseDelay:100,locksHover:false,hotSlot:null,closeOnClick:false,curtainNode:null,postBuildRendering:function U(){this._super();if(this.autoCloses){X(this);}this.oncloseOnClickChange();},onautoClosesChange:function N(){var Y=(this.autoCloses)?X:C;Y(this);},oncloseOnClickChange:function I(){if(!this.curtainNode){return ;}var a=this,Y=mstrApp&&mstrApp.isTouchApp&&mstrApp.isTouchApp()||P,Z=Y?W:J;this._onClickChange=function(){a.close();if(Y){mstrmojo.touchManager.notify([]);}};F.attachEvent(a.curtainNode,Z,this._onClickChange);},autoUnclose:function H(){var Y=this._autoCloseTimer;if(Y){self.clearTimeout(Y);delete this._autoCloseTimer;}},autoClose:function L(){if(this.ignoreHover){return ;}if(this._autoCloseTimer){self.clearTimeout(this._autoCloseTimer);}if(this.opener){if(this.autoCloseDelay){var Y=this.opener.id;this._autoCloseTimer=self.setTimeout(function(){mstrmojo.all[Y].closePopup();},this.autoCloseDelay);}else{this.opener.closePopup();}}},destroy:function V(Y){E.call(this);this._super(Y);},lockHover:function R(){G(this,true);if(!this._lockHoverCallback){var Z=this.id,Y=this._lockHoverCallback=function(a){mstrmojo.all[Z]._unlockHoverCheck(a,self);};if((F.isIE7||F.isIE8)&&window.event&&(window.event.type===S)&&this.opener){this.opener._ignoreMousedown=true;}F.attachEvent(document.body,S,Y,true);}},unlockHover:function O(){G(this,false);E.call(this);},hoverLock:function(Y){G(this,Y);},suppressClose:function B(Y){return F.contains(this.domNode,Y,true,document.body);},_unlockHoverCheck:function D(b,Y){var Z=this.opener;if(Z&&Z._ignoreMousedown){delete Z._ignoreMousedown;return ;}var a=F.eventTarget(Y,b);if(!this.suppressClose(a)){if(this.isWithinParentWidget(a)){return ;}if(Z&&Z.onPopupAutoClosed){Z.onPopupAutoClosed(b,Y);}this.close(a);}},isWithinParentWidget:function Q(Z){var Y=F.findWidget(Z);while(Y){if(Y===this){return true;}Y=Y.parent||Y.opener;}return false;},open:function K(Z,Y){if(this.autoCloses){this.autoUnclose();}this._super(Z,Y);if(this.locksHover){this.lockHover();}},close:function M(Y){if(this.locksHover){this.unlockHover();}this._super(Y);},shouldPropagateLockHover:function A(){return true;}});}());(function(){mstrmojo.requiresCls("mstrmojo.dom");var E=mstrmojo.dom;mstrmojo.ui._IsIncFetchList=mstrmojo.provide("mstrmojo.ui._IsIncFetchList",{_mixinName:"mstrmojo.ui._IsIncFetchList",ifDataHelper:null,supportsIncFetch:false,isFetching:false,initScroll:function A(){var I=this.ifDataHelper,H=this,G=this.scrollNode||this.domNode;this.supportsIncFetch=I&&I.hasNext();if(I&&this.supportsIncFetch){this._scroll=function F(){var J=this.scrollNode||this.domNode||G;if(Math.ceil(J.offsetHeight+J.scrollTop)>=J.scrollHeight){H.raiseEvent({name:"incFetch",id:H.id});}};E.attachEvent(G,"scroll",this._scroll);this.attachEventListener("incFetch",this.id,function(J){if(!this.supportsIncFetch||this.isFetching){return ;}if(this.preNext){this.preNext();}this.set("isFetching",true);I.next({complete:function(K){if(H.postNext){H.postNext();}H.set("isFetching",false);},success:function(K){H.addItems(K.items||null);},failure:function(K){H.supportsIncFetch=false;mstrmojo.alert("Error in fetching next: "+K);}});});}},unrender:function D(F){var G=this.scrollNode||this.domNode;E.detachEvent(G,"scroll",this._scroll);this._super(F);},render:function C(){this._super();if(this.supportsIncFetch){var F=this.scrollNode||this.domNode;E.attachEvent(F,"scroll",this._scroll);}},addItems:function B(F){if(this._super){this._super(F);}if(!this.ifDataHelper.hasNext()){this.supportsIncFetch=false;var G=this.scrollNode||this.domNode;E.detachEvent(G,"scroll",this._scroll);}}});}());(function(){mstrmojo.requiresCls("mstrmojo.dom");var D=mstrmojo.dom;mstrmojo._FillsBrowser=mstrmojo.provide("mstrmojo._FillsBrowser",{_mixinName:"mstrmojo._FillsBrowser",getBrowserDimensions:function F(H){if(H){return{w:H.innerWidth,h:H.innerHeight};}var G=D.windowDim(),I=(D.isFF||D.isWK)?0:2;return{w:Math.max(G.w,0)+"px",h:Math.max(G.h-I,0)+"px"};},preBuildRendering:function B(){var I=this._super(),H=this.getBrowserDimensions();if(!this.browserResized||this.browserResized(H)!==true){this.height=H.h;this.width=H.w;}if(!this._listenerProc){var K=this.id,J=null,G=this._listenerProc=function(M){if(mstrApp&&mstrApp.isExporting){var L=M||window.event;mstrmojo.all[K].monitorWindow(L);}else{window.clearTimeout(J);J=window.setTimeout(function(){var N=M||window.event;mstrmojo.all[K].monitorWindow(N);},150);}};D.attachEvent(window,"resize",G);}return I;},destroy:function C(G){if(this._listenerProc){D.detachEvent(window,"resize",this._listenerProc);}this._super(G);},getResizeDimensions:function A(G){var J=G.currentTarget,I=this.getBrowserDimensions(),H={w:(J?J.innerWidth+"px":I.w),h:(J?J.innerHeight+"px":I.h)};return H;},monitorWindow:function E(G){var H=this.getResizeDimensions(G);if((H.h===this.height&&H.w===this.width)||parseInt(H.h,10)<=20||parseInt(H.w,10)<=20){return ;}if(!this.browserResized||this.browserResized(H,true)!==true){if(H.h!==this.height){this.set("height",H.h);}if(H.w!==this.width){this.set("width",H.w);}}}});}());(function(){mstrmojo.requiresCls("mstrmojo.dom");var C=mstrmojo.dom;function D(J,I){var G=[];if(J){var F;for(F in J){var H=Number(F);if(H>=I){G.push(H);}}}G.sort(mstrmojo.array.numSorter);return G;}mstrmojo.ListSelector=mstrmojo.provide("mstrmojo.ListSelector",{premousedown:function E(L,F,N){if(C.isPrimaryMouseBtn(N.e)){var I=N.hWin,J=N.e,G=C.eventTarget(I,J),M=L.listMapper.findIndex(L,F,G);if(M>-1){var H=L.multiSelect,K=C.ctrlKey(I,J),O=C.shiftKey(I,J);if(K||O){C.clearBrowserHighlights(I);}if(H&&(K||(L.selectionPolicy==="toggle"))){L.toggleSelect(M);}else{if(H&&O){L.rangeSelect(M);}else{L.singleSelect(M);}}}}},premouseup:function B(H,K,G){var F=G.hWin,J=G.e,L=C.ctrlKey(F,J),I=C.shiftKey(F,J);if(L||I){C.clearBrowserHighlights(F);}},onadd:function A(I,H){var M=H&&H.value&&H.value.length;if(M){var G=H.index,K=I.selectedIndices,L=D(K,G),J;for(J=L.length-1;J>-1;J--){var F=L[J];K[F+M]=true;delete K[F];}if(I.selectedIndex>=G){I.selectedIndex+=M;}}},onremove:function A(Q,S){var O=S&&S.value&&S.value.length;if(O){var R=S.index,I=R+O-1,M=Q.selectedIndices,L=Q.selectedIndex,G=[],U=[],P=false;if(M){var H;for(H in M){var K=Number(H);if(K>I){G.push(K);}else{if(K>=R){U.push(K);P=true;}}}}G.sort(mstrmojo.array.numSorter);var J,N;for(J=0,N=G.length;J<N;J++){var F=G[J];M[F-O]=true;delete M[F];}if(L>I){Q.selectedIndex-=O;}if(P){Q.removeSelect(U);}}}});}());(function(){mstrmojo.requiresCls("mstrmojo.dom","mstrmojo.ListSelector");var A=mstrmojo.dom;mstrmojo.TreeBrowserSelector=mstrmojo.provide("mstrmojo.TreeBrowserSelector",mstrmojo.hash.copy({premousedown:function B(F,I,E){if(A.isPrimaryMouseBtn(E.e)){var D=E.hWin,H=E.e,G=A.eventTarget(D,H),C=F.listMapper.findIndex(F,I,G);if(C>-1){F.toggleSelect(C);}}}},mstrmojo.hash.copy(mstrmojo.ListSelector)));})();(function(){mstrmojo.requiresCls("mstrmojo.hash","mstrmojo.dom","mstrmojo.ListSelector");var C=mstrmojo.dom,B=C.isIE;mstrmojo.TreeNodeSelector=mstrmojo.provide("mstrmojo.TreeNodeSelector",mstrmojo.mixin({premousedown:function A(E,I,D){var G=(E&&E.tree)||E,H=D&&D.e;if(!H){return false;}var F=G.lastMouseDown;if(F){if((F.e===H)||(B&&((new Date())-F.dt<50))){return false;}}this._super(E,I,D);if(G){if(G.onnodemousedown){G.onnodemousedown(D);}G.lastMouseDown={e:H,dt:new Date()};}return true;}},mstrmojo.hash.copy(mstrmojo.ListSelector)));}());(function(){mstrmojo.requiresCls("mstrmojo.dom","mstrmojo.array","mstrmojo.string");var X=mstrmojo.dom,L=mstrmojo.string,b=mstrmojo.array;mstrmojo.css=mstrmojo.provide("mstrmojo.css",{DISPLAY_TABLE:X.isNSIE?"block":"table",DISPLAY_CELL:X.isNSIE?"block":"table-cell",MINHEIGHT:X.isIE6?"height":"minHeight",addClass:function M(j,h){if(j){if(h.constructor!==Array){h=[h];}var e=j.className||"",l=" "+e+" ",f=false,d=h.length,g;for(g=0;g<d;g++){var k=h[g];if(!l.match(new RegExp("\\s"+k+"\\s"))){e+=" "+k;f=true;}}if(f){j.className=L.trim(e);}}return j;},removeClass:function O(g,f){if(!g){return ;}if(f.constructor!==Array){f=[f];}var d=" "+(g.className||"")+" ",c=f.length,e;for(e=0;e<c;e++){d=d.replace(new RegExp("\\s"+f[e]+"\\s","g")," ");}g.className=L.trim(d);},addWidgetCssClass:function N(h,f){var d=h.cssClass,g=(d&&d.split(" "))||[],e;f=[].concat(f);for(e=0;e<f.length;e++){var c=f[e];if(b.indexOf(g,c)===-1){g.push(c);}}h.cssClass=g.join(" ");},removeWidgetCssClass:function G(j,g){var d=j.cssClass,h=(d&&d.split(" "))||[],f;g=[].concat(g);for(f=0;f<g.length;f++){var c=g[f];var e=b.indexOf(h,c);if(e!==-1){h.splice(e,1);}}j.cssClass=h.join(" ");},toggleClass:function W(e,d,c){if(c){this.addClass(e,d);}else{this.removeClass(e,d);}},hasClass:function A(e,f){if(e){var d=" "+(e.className||"")+" ";return !!d.match(new RegExp("\\s"+f+"\\s"));}return false;},applyShadow:function H(g,h,f,e,c){var d=g.style;if(X.isDXIE){d.filter+="progid:DXImageTransform.Microsoft.dropshadow(OffX="+h+"px, OffY="+f+"px, Color='"+c+"')";}else{if(X.isFF||X.isWK||X.isIE10){d[X.CSS3_BOXSHADOW]=h+"px "+f+"px "+e+"px "+c;}}},removeShadow:function C(d){var c=d.style;if(X.isFF||X.isWK||X.isIE10){c[X.CSS3_BOXSHADOW]="";}},setOpacity:function Y(d,f){if(X.isDXIE&&!X.isIE9){var g=d.currentStyle.filter;var c=null;if(g.length>0){c=d.filters["DXImageTransform.Microsoft.Alpha"];}if(c){c.opacity=f;c.enabled=(f!==100);}else{if(f<100){var e="progid:DXImageTransform.Microsoft.Alpha(Opacity="+f+")";d.style.filter=(g||"")+" "+e;}}}else{d.style.opacity=f/100-(X.isIE9?0.00001:0);}},buildGradient:function P(d,f,c){if(X.supports(X.cssFeatures.GRADIENTS)){var e={};if(X.isDXIE){e.n="filter";e.v="progid:DXImageTransform.Microsoft.Gradient(GradientType="+d+",StartColorStr='"+f+"',EndColorStr='"+c+"')";}else{if(X.isFF){e.n="background-image";e.v="-moz-linear-gradient("+((d===0)?"top":"left")+","+f+","+c+")";}else{if(X.isWK){e.n="background";e.v="-webkit-gradient(linear,"+((d===0)?"left top, left bottom":"left top, right top")+",from("+f+"),to("+c+"))";}else{if(X.isIE10||X.isIEW3C){e.n="background";e.v="linear-gradient("+((d===0)?"to bottom":"to right")+","+f+","+c+")";}}}}return e;}return null;},buildRoundCorners:function R(h,g){if(X.supports(X.cssFeatures.ROUND_CORNERS)){var d=h+"px";var k=d+(g?" "+d+" 0 0":"")+";";if(X.isFF||X.isWinPhone||X.isIE10){return"border-radius:"+k;}if(X.isWK){if(!g){return"-webkit-border-radius:"+d+";";}var j=["left","right"],f=[],c=-1,e;for(e=0;e<2;e++){f[++c]="-webkit-border-top-"+j[e]+"-radius:"+d;f[++c]="-webkit-border-bottom-"+j[e]+"-radius:0";}return f.join(";");}}return"";},getBorderWidthsOrPaddings:function E(d,g){var h={t:0,r:0,b:0,l:0,h:0,w:0};if(!d){return h;}var e=d.split(" "),c=e.length,f;for(f=0;f<c;f++){e[f]=Math.round(g*parseFloat(e[f])/72);}if(c<4){if(c===1){e[1]=e[2]=e[3]=e[0];}else{e[3]=e[1];if(c===2){e[2]=e[0];}}}h.t=e[0];h.r=e[1];h.b=e[2];h.l=e[3];h.h=h.t+h.b;h.w=h.l+h.r;return h;},getBorderWidths:function I(d,c){return this.getBorderWidthsOrPaddings(d,c);},getPaddings:function D(d,c){return this.getBorderWidthsOrPaddings(d,c);},parkAfterFade:function B(c){var d=c.target.style;if(d.opacity===0){d.left="-10000px";window.setTimeout(function(){d.opacity=0.99;},0);return true;}return false;},getStyleValue:function J(c,g){var e=(g==="float"),f;if(c.currentStyle){g=e?"styleFloat":g;f=c.currentStyle[g];}else{if(document.defaultView&&document.defaultView.getComputedStyle){g=e?"cssFloat":g;var d=document.defaultView.getComputedStyle(c,null);f=d?d[g]:null;}}return f;},getComputedStyle:function V(c,e){var d=(window.getComputedStyle)?function(f,g){return window.getComputedStyle(f,g||null);}:function(f){return f.currentStyle||{};};mstrmojo.css.getComputedStyle=d;return d(c,e);},getCssTextFromObj:function F(e){var d="",c;for(c in e){d+=c+":"+e[c]+";";}return d;},onTransitionEnd:function a(e,c){var d="transition",f=window.Modernizr;if(f.testProp(d)){X.attachOneTimeEvent(e,X.transEndEvtNames[f.prefixed(d)],c);}else{window.setTimeout(c,0);}},onAnimationEnd:function U(e,c){var d="animation",f=window.Modernizr;if(f.testProp(d)){X.attachEvent(e,X.animationEndEvtNames[f.prefixed(d)],c);}else{window.setTimeout(c,0);}},flashClass:function Q(d,c,f){this.toggleClass(d,c,true);var e=this;window.setTimeout(function(){e.toggleClass(d,c,false);},f);},convertCssToCamelCase:function K(c){return c.replace(/\-([a-z])/gi,function(d,e){return e.toUpperCase();});},printCSSInfo:function Z(g){var m=document.styleSheets,p=m.length,h,k;for(k=0;k<p;k++){var l=m[k],n=l.cssRules,e=n?n.length:0,o=0;for(h=0;h<e;h++){var c=n[h].selectorText;if(c){try{o+=c.split(",").length;}catch(f){}}}var d=l.href;if(!g||(d&&d.indexOf(g)>-1)){console.log("Stylesheet: "+d||"Inline CSS Block");console.log("Total rules: "+e);console.log("Total selectors: "+o);}}},cssEscape:function S(j){if(arguments.length===0){throw new TypeError("`CSS.escape` requires an argument.");}var f=String(j),h=f.length,e=-1,g,c="",d=f.charCodeAt(0);while(++e<h){g=f.charCodeAt(e);if(g==0){c+="\uFFFD";continue;}if((g>=1&&g<=31)||g==127||(e==0&&g>=48&&g<=57)||(e==1&&g>=48&&g<=57&&d==45)){c+="\\"+g.toString(16)+" ";continue;}if(e==0&&h==1&&g==45){c+="\\"+f.charAt(e);continue;}if(g>=128||g==45||g==95||g>=48&&g<=57||g>=65&&g<=90||g>=97&&g<=122){c+=f.charAt(e);continue;}c+="\\"+f.charAt(e);}return c;}});}());(function(){mstrmojo.requiresCls("mstrmojo.locales","mstrmojo.string","mstrmojo.array");var M=mstrmojo.locales,I=mstrmojo.string,P=window.mstrConfig,F=mstrmojo.array,C=P.units,R={CM:1,IN:2,MM:3,PT:4,PC:5,PX:6},A={1:"cm",2:"in",3:"mm",4:"pt",5:"pc",6:"px"},E={DEFAULT:-2,FIXED:0,CURR:1,PERCENT:4,FRACTION:5,SCIENTIFIC:6,GENERAL:9};var G=96;String.prototype.reverse=function(){var V="",U;for(U=this.length;U>0;--U){V+=this.charAt(U-1);}return V;};function K(U,W){U=U||"";W=W||U.match(/\".+?\"/g)||[];for(var V=0;V<W.length;V++){U=U.replace(W[V],W[V].substring(1,W[V].length-1).replace(/\$/g,"$$$$"));}return U;}function S(Z){var U=86400000,Y=new Date(1900,0,1,0,0,0,0),V=Math.floor(Z)-1,X=Z-V-1;if(Z>=59){V--;}var W=new Date(Y.getTime()+(V*U));W.setTime(W.getTime()+X*U+500);return W;}function H(Y,f,h){var Z={"d+":Y.getDate(),"h+|H":Y.getHours(),"s+":Y.getSeconds()},U=M.datetime,a;if(/(y+)/.test(f)){var X=Y.getFullYear().toString(),e=RegExp.$1,W=e.length===2,V=X.length;f=f.replace(e,X.substr(W?V-2:0,W?2:V));}if(/(^\[h\])/.test(f)&&h){f=f.replace(RegExp.$1,""+(Math.floor(h*24)));}if(/(\"?:\"?mm)/.test(f)){var b=Y.getMinutes();f=f.replace(RegExp.$1,":"+(RegExp.$1.length===1?b:("00"+b).substr(b.toString().length)));}if(/(AM\/PM)/.test(f)){var g=Z["h+"],c=g>11;Z["h+"]=g-(c?12:0);f=f.replace(RegExp.$1,c?"PM":"AM");}for(a in Z){if(new RegExp("("+a+")").test(f)){f=f.replace(RegExp.$1,RegExp.$1.length===1?Z[a]:("00"+Z[a]).substr((Z[a].toString()).length));}}if(/(mmmm)/.test(f)){f=f.replace(RegExp.$1,U.MONTHNAME_FULL[Y.getMonth()]);}else{if(/(mmm)/.test(f)){f=f.replace(RegExp.$1,U.MONTHNAME_SHORT[Y.getMonth()].substr(0,3));}else{if(/((m|M)+)/.test(f)){var d=(Y.getMonth()+1).toString();f=f.replace(RegExp.$1,RegExp.$1.length===1?d:("00"+d).substr(d.length));}}}return K(f);}function N(V,Y){var W=0,U=Y.length,X=0;for(;W<U;W++){if(Y[W]==="0"){X++;}else{if(Y[W]==="#"){if(X<V){X++;}}else{continue;}}}return X;}mstrmojo.num=mstrmojo.provide("mstrmojo.num",{isInt:function D(U){var X=this.getThousand(),W=new RegExp("^(-)?[0-9]{1,3}(\\"+X+"[0-9]{3})*$"),V=new RegExp("^(-)?[0-9]+$");return(String(U).indexOf(X)&&W.test(U))||V.test(U);},isNumeric:function O(Y){var X=this.getDecimal(),Z=this.getThousand(),W=new RegExp("^(-)?[0-9]{1,3}(\\"+Z+"[0-9]{3})*(\\"+X+"[0-9]+)?$"),V=new RegExp("^(-)?[0-9]*(\\"+X+")?[0-9]+$"),U=new RegExp("^(-)?[0-9]{1}(\\"+X+")[1-9]+[eE]{1}[-]{0,1}[0-9]+$");return(String(Y).indexOf(Z)&&W.test(Y))||V.test(Y)||U.test(Y);},isBigDecimal:function(V){if(!V){return false;}var U=String(V).match(/^#([^#]+)#$/);if(!U||U.length<=1){return false;}var W=U[1];return this.isNumeric(W);},parseInteger:function L(U,V){if(!this.isInt(U)){return Number.NaN;}return parseInt(this.toString(U,true),V);},parseNumeric:function B(U){if(!this.isNumeric(U)){return Number.NaN;}return parseFloat(this.toString(U,true));},parseBigDecimal:function(U){return String(U).match(/^#(.+)#$/)[1];},inNumericRange:function Q(V,W,U){V=this.parseNumeric(V);U=(U!=null)?this.parseNumeric(this.toLocaleString(U)):Number.NaN;W=(W!=null)?this.parseNumeric(this.toLocaleString(W)):Number.NaN;if(U!=Number.NaN&&(V>U||isNaN(V))){return 1;}if(W!=Number.NaN&&(V<W||isNaN(V))){return -1;}return 0;},convertToUSUnits:function(X,W,V){var U=X;W=W||C;switch(parseInt(W,10)){case R.CM:U=parseFloat(this.toString(X))/2.54+"";break;case R.MM:U=parseFloat(this.toString(X))/25.4+"";break;case R.PT:U=parseFloat(this.toString(X))/72+"";break;case R.PC:U=parseFloat(this.toString(X))/6+"";break;case R.PX:U=parseFloat(this.toString(X))/G+"";break;}return V?U:this.toLocaleString(U);},convertToLocalUnits:function(X,W,V){var U;W=W||C;switch(parseInt(W,10)){case R.CM:U=(parseFloat(this.toString(X))*2.54).toFixed(4)+"";break;case R.MM:U=(parseFloat(this.toString(X))*25.4).toFixed(4)+"";break;case R.PT:U=(parseFloat(this.toString(X))*72).toFixed(4)+"";break;case R.PC:U=(parseFloat(this.toString(X))*6).toFixed(4)+"";break;case R.PX:U=(parseFloat(this.toString(X))*G)+"";break;default:U=parseFloat(this.toString(X)).toFixed(4)+"";}return V?U:this.toLocaleString(U);},convertUnits:function(V,W,U){return this.convertToLocalUnits(this.convertToUSUnits(U,V,true),W,true);},toLocaleString:function(U){return(U+"").replace(".",this.getDecimal());},toString:function(W,U){if(U===true){var V=this.getThousandSepRegex();if(V){W=String(W).replace(V,"");}}return String(W).replace(this.getDecimal(),".");},getThousandSepRegex:function(){if(this.thousandSeparatorRegex==null){this.thousandSeparatorRegex=new RegExp(this.getThousand().replace(/(\W){1}/g,"\\$1"),"g");}return this.thousandSeparatorRegex;},addSeparators:function(W,V){var U=V;if(V=="."||V=="*"||V=="\\"){U="\\"+V;}return W.reverse().replace(/(\d{3})/g,"$1"+V).reverse().replace(new RegExp("^(-)?"+U),"$1");},addSeparators2:function(X,W){var U=X,V=/(\d+)(\d{3})/;while(V.test(U)){U=U.replace(V,"$1"+W+"$2");}return U;},format:function(Y,X,b,U){var a="",Z=(X>0)?".":"",V=[];b=(b)?b:"";for(var W=0;W<X;W++){V.push("0");}V=V.join("");switch(Y){case E.GENERAL:a="0.00";break;case E.PERCENT:a="0"+Z+V+"%";break;case E.SCIENTIFIC:a="0"+Z+V+"E+00";break;default:a='"'+b+'"#,##0'+Z+V;}return this.formatByMask(a,U);},getDecimalLength:function J(W){var U=W.indexOf("."),X=0;if(U!==-1){var V=W.substr(U+1,W.length).match(/\d+/);if(V&&V.length>0){X=V[0].length;}}return X;},formatByMask:function(AH,AZ){var AB,n="",t,Ac=false;if(isNaN(AZ)){AB=new Date(AZ);if(isNaN(AB)){return AZ;}t=true;}if(AH==="General"){var AM=String(parseFloat(AZ).toFixed(2));n=AM.split(".");if(n.length===2){return n.join(this.getDecimal());}return AM;}var r=String(AH).split(";"),X=r[0],h="\u00A4",AS=/"[^"]*"/g,l=(AH&&AH.replace(AS,h).replace(/\[.*\]/g,h))||"",AY=["m","y","d","h","s"],AN=false;F.forEach(AY,function(j){AN=AN||l.indexOf(j,0)!==-1;});if(AN){if(window.SSF&&!Ac){n=this.formatBySSF(AH,AZ);Ac=true;}if(n!==""){return n;}else{return H(t?AB:S(AZ),AH,AZ);}}var AL=X.indexOf("E+"),d=X.indexOf("%"),x=X.match(/\".+?\"/g),AE=X.match(/\[([=<>]*)(-?\d+\.?\d*)\]/),z=X.indexOf("?/?")>-1,AF=(AL!=-1)?E.SCIENTIFIC:((d!=-1)?E.PERCENT:((x&&!AE)?E.CURR:z?E.FRACTION:E.FIXED)),q="",AU="",o=false,V=new String(AZ),c=parseFloat(AZ)||this.parseNumeric(AZ);if(x){if(X.match(/\[\$.+?\]/g)){for(var e=0;e<x.length;e++){X=X.replace(x[e],x[e].substring(1,x[e].length-1));if(x[e].match(/\[\$.+?\]/g)){x[e]=x[e].replace(/\[\$.+?\]/g,x[e][x[e].indexOf("[$")+2]);}}X=X.replace(/\[\$.+?\]/g,'"#"'.replace("#",X[X.indexOf("[$")+2]));}q=K(X,x);q=q.replace(X.replace(/\".+?\"/g,""),h);}if(c<0){V=V.substring(1,V.length);c=-c;o=true;if(r.length>1){var a=r[1].replace(/\[.*\]/,"");AU=K(a.replace(r[0],h));}}var k=this,b=function(Ad,j){var m=j&&j.replace(h,Ad);if(j&&(m===j)&&window.SSF){if(Ac){return Ad;}else{Ac=true;return k.formatBySSF(j,Ad);}}return(j)?m:"-"+Ad;};if(AF===E.FRACTION){var AQ,AP,AX,p=10,AA,w=0,AJ,AT,Y,W=false,AG;if(AH.indexOf("# ")>-1){W=true;}for(AQ=5;AQ>0;AQ--){AG="/";for(AP=0;AP<AQ;AP++){AG+="?";}if(AH.indexOf(AG)>-1){for(AP=1;AP<AQ;AP++){p*=10;}break;}}if(W){w=Math.floor(Number(c));c-=w;}AT=p/2;AX=-1;AJ=c*p;for(AQ=p-1;AQ>=2;AQ--){Y=(AJ*AQ)/p;Y=Y-Math.floor(Y);Y=Y*p;if(Math.abs(Y-p)<Y){Y=Math.abs(Y-p);}Y=Y/AQ;if(Y<AT){AT=Y;AX=AQ;}else{if((Y==AT)&&(Y==0)){AT=Y;AX=AQ;}}}AA=Math.round(AX*AJ/p);for(AQ=AX;AQ>=2;AQ--){if((AA%AQ==0)&&(AX%AQ==0)){AA=AA/AQ;AX=AX/AQ;break;}}if(AX==p){AX=1;AA=0;}if(AA==0){AX=1;}if(AA==AX){if(W){n=""+(w+1);}else{n="1";}}else{if(W&&w>0){if(AA==0){n=w;}else{n=w+" "+AA+"/"+AX;}}else{if(AA==0){n="0";}else{n=AA+"/"+AX;}}}if(o){n=b(n,AU);}}else{if(AF==E.SCIENTIFIC){if(c!=0){var Aa=Math.floor(Math.log(c)/Math.LN10),AO=c/Math.pow(10,Aa),Ab=X.substring(0,AL),g=Ab.indexOf("."),AI=X.length-X.indexOf("E+")-(""+Math.abs(Aa)).length-2,AQ,U=Aa<0;Aa=Math.abs(Aa);for(AQ=0;AQ<AI;AQ++){Aa="0"+Aa;}n+=Number(AO).toFixed((g!=-1)?Ab.length-g-1:0);n=((o)?b(n,AU):n)+"E"+(U?"-":"+")+Aa;}else{n="0";}}else{if(AF==E.PERCENT){X=X.substring(0,X.length-1);V=String(c*100);}var g=X.indexOf("."),Z=0,AW,u=g>=0?X.substring(0,g):X,AC=g>=0?X.substring(g+1,X.length):"",f=false;if(u.match(/[#0\?],$/)){c/=1000;V=String(c);}else{if(AC.match(/^[#0]*,/)){var AD=0;f=true;while(AD<AC.length){if(AC[AD]==="0"||AC[AD]==="#"){AD++;}else{if(AC[AD]===","){c/=1000;V=String(c);AD++;}else{break;}}}}}AW=this.getDecimalLength(V);if(g!=-1){Z=N(AW,X.substr(g+1,X.length));}n=String((+(Math.round(+(V.indexOf("e")>0?String(parseFloat(V).toFixed(Math.min(Z+2,20))):V+"e"+Math.min(Z,20)))+"e"+-Math.min(Z,20))).toFixed(Math.min(Z,20)));if(AF===E.FIXED){if(/[\[\]><=A-Za-z]|,{2}/.test(X)&&window.SSF){var AR=this.formatBySSF(AH,AZ);n=AR!==""?AR:n;Ac=true;}}var AV=n.split(".");var AK=X.replace(/"[^"]*"/g,"").match(/[#\d]+[^\.\d#]+[#\d]+/);if(AK!==null){if(AF===E.CURR){AV[0]=(this.formatBySSF((f?AK[0]&&AK[0].trim():AK.input&&AK.input.trim()),parseFloat(AV[0]))||"").split(".")[0];Ac=true;}if(AV[0].indexOf(",")>=0){AV[0]=AV[0].replace(/,/g,this.getThousand());}else{if(!(this.getThousand()===","&&AV[0].search(this.getThousand())>0)){AV[0]=this.addSeparators2(AV[0],this.getThousand());}}}n=AV.join(this.getDecimal());if(AF==E.CURR){n=q.replace(h,n);if(n===q&&window.SSF){n=this.formatBySSF(AH,AZ,n);Ac=true;}}if(AF==E.PERCENT){n+="%";}if(o){n=b(n,AU);}}}return n;},formatBySSF:function(W,V,X){var U=(X!==undefined&&X!==null)?X:"";if(typeof V==="string"){V=parseFloat(V);}try{U=window.SSF.format(W,V);}catch(Y){if(window.mstr_profile){window.mstr_profile.log(Y);}U=(X||V).toString();}return U;},validateFormat:function(U){var V=true,W=String(U).split(";");if(W[1]&&W[1].indexOf(W[0])<0){V=false;}return V;},generateUniqueID:function(U){var W="0123456789ABCDEF".split(""),X=[];for(var V=0;V<U;V++){X[V]=W[0|Math.random()*16];}return X.join("");},countOfDecimals:function(V,W){var U=String(V);return U.length-(U.indexOf(W!==undefined?W:this.getDecimal())+1);},getThousand:function(){return mstrmojo.locales.number.THOUSANDSEPARATOR;},getDecimal:function(){return mstrmojo.locales.number.DECIMALSEPARATOR;}});mstrmojo.num.UNIT=R;mstrmojo.num.UNIT_SYMBOL=A;})();(function(){mstrmojo.requiresCls("mstrmojo.string");var D=mstrmojo.string,F=1;mstrmojo.ListBuilder=mstrmojo.provide("mstrmojo.ListBuilder",{newContext:function E(G){var I=G.itemMarkupFunction;if(!I){var H=G.itemMarkup||(G.itemField&&'<div class="mstrmojo-text">{@'+G.itemField+"}</div>");I=H?function(K,J,L){return D.apply(H,K);}:null;}return{itemStatus:[],itemFunc:I};},build:function A(I,H,J,G){H.itemStatus[G]=F;return H.itemFunc(J,G,I);},onadd:function B(I,G,H){if(G){mstrmojo.array.insert(G.itemStatus,H.index,new Array(H.value.length));}},onremove:function C(I,G,H){if(G){G.itemStatus.splice(H.index,H.value.length);}}});}());(function(){mstrmojo.requiresCls("mstrmojo.string","mstrmojo.dom","mstrmojo.hash");var M=mstrmojo.string,L=mstrmojo.hash,E=mstrmojo.dom;var R=mstrmojo.usesFrames?null:document.createElement("span");var J=/mstrAttach:([\w,]+)/g;var Q;function V(b,c){if(Q===undefined){Q=(mstrApp!==undefined&&mstrApp.isTouchApp&&mstrApp.isTouchApp())||false;}return b.replace(J,function a(j,l){var f=l.split(","),g=[],d=f.length,h;for(h=0;h<d;h++){var k=f[h];if(k){if(Q){if(k.indexOf("mouse")>-1){continue;}else{if(k==="click"){k="touchend";}}}g.push("on"+k+"=\"mstrmojo.dom.captureDomEvent('{@id}','"+k+"', self, event)\"");}}return g.join(" ");});}var N="preBuildRendering",C="buildRendering",B="postBuildRendering";function Y(c){var b=c.markupString;if(b.match(/mstrAttach:/)){b=V(b,c);if(c.markupString===c.constructor.prototype.markupString){c.constructor.prototype.markupString=b;}}var a=M.apply(b,c);if(a){if(a.indexOf("oncontextmenu")>-1){c.hasContextMenuEvent=true;}if(mstrmojo.usesFrames){var e=(c.domNode&&c.domNode.ownerDocument)||window.document;if(!R||R.ownerDocument!==e){R=e.createElement("span");}}R.innerHTML=a;var f=R.removeChild(R.firstChild);f.mstrmojoId=c.id;return f;}return null;}function A(c){var b=c.markupSlots,a,d;if(b){a={};for(d in b){a[d]=b[d].call(c);}}return a;}mstrmojo._HasMarkup=mstrmojo.provide("mstrmojo._HasMarkup",{markupString:null,markupMethods:null,markupSlots:null,onRender:mstrmojo.emptyFn,onUnRender:mstrmojo.emptyFn,render:function Z(){if((this[N]&&this[N]()===false)||(this[C]()===false)||(this[B]&&this[B]()===false)){return false;}this.hasRendered=!!this.domNode;this.onRender();var a="renderComplete";if(mstrmojo.publisher.hasSubs(this.id,a)){this.raiseEvent({name:a});}return true;},buildDom:function U(){return Y(this);},postBuildDom:null,preBuildRendering:mstrmojo.emptyFn,buildRendering:function F(){var a=this.domNode,b=this.buildDom();this.domNode=b;if(this.postBuildDom){this.postBuildDom();}if(this.slotNames){this.removeSlots(this.slotNames);}this.addSlots(A(this));this.paint();if(b){var e=a;if(!e){e=this.placeholder;if(e){if(typeof e==="string"){e=document.getElementById(e);}delete this.placeholder;}}if(e){E.replace(e,b);}}var c="onchildRenderingChange",d=this.parent;if(d&&d[c]){d[c](this);}return true;},postBuildRendering:mstrmojo.emptyFn,unrender:function S(c){if(this.hasRendered){if(!c){try{var a=this.domNode;if(a.parentNode){a.parentNode.removeChild(a);}if(mstrmojo.dom.isIE&&a.outerHTML!=="undefined"){a.outerHTML="";}}catch(b){}}this.domNode=null;this.removeSlots(this.slotNames);this.hasRendered=false;this.onUnRender();}},paint:function K(){var b=this.markupMethods;if(!b){return ;}var e=this,f=function(k){var j=b[k];if(j){try{j.apply(e,[true]);}catch(h){throw new Error(["Error in markup method.","Script class: "+e.scriptClass,"Widget id: "+e.id,"Method name: "+k,"Err: "+h.message].join("\n\n"));}}};var d=b.sequence,a,c,g;if(d){a=d.length||0;for(c=0;c<a;c++){f(d[c]);}}else{for(g in b){f(g);}}},redraw:function P(){return false;},refresh:function D(a){if(this.hasRendered){if(this.redraw()!==true){var b=this.domNode;this.unrender(true);this.placeholder=b;if(a){a();}this.render();}}},set:function I(d,a){this._super(d,a);if(this.domNode){var b=this.markupMethods,c=b&&b["on"+d+"Change"];if(c){c.apply(this);}}return this;},slotNames:null,addSlots:function G(b){var a=this.slotNames,c;if(!a){a={};this.slotNames=a;}for(c in b){this[c]=b[c];a[c]=true;}},removeSlots:function H(a){if(a){var b=this.slotNames,c;for(c in a){delete this[c];if(b){delete b[c];}}}},captureDomEvent:function X(c,a,d,b){if(this.enabled!==false){this.raiseEvent(mstrmojo._HasMarkup.newDomEvent(c,a,d||a.event,b));}},playEffect:function W(b){var a=this[b];if(a&&a.constructor===Object){a=mstrmojo.insert(mstrmojo.hash.clone(a));a.widget=this;this[b]=a;}if(a){a.play();}}});mstrmojo._HasMarkup.addMarkupMethods=function O(b,a){b.prototype.markupMethods=L.copy(a,L.copy(b.prototype.markupMethods));};mstrmojo._HasMarkup.MSTRDomEventType=null;mstrmojo._HasMarkup.newDomEvent=function(d,a,c,b){return{name:d,hWin:a,e:c,config:b,ctrlKey:E.ctrlKey(a,c),shiftKey:E.shiftKey(a,c),metaKey:E.isMetaKey(a,c),cancel:function(){E.stopPropogation(a,c);},preventDefault:function(){E.preventDefault(a,c);},getTarget:function(){return E.eventTarget(a,c);}};};}());(function(){mstrmojo.requiresCls("mstrmojo.array","mstrmojo.string","mstrmojo.vi.enums.EnumFilterClearActionType","mstrmojo.vi.enums.EnumVisFilterType");var D=mstrmojo.array,M=mstrmojo.string,H=mstrmojo.vi.enums.EnumFilterClearActionType,J=mstrmojo.vi.enums.EnumVisFilterType;mstrmojo.vi.ui.rw._SupportViewFilterInVizBox=mstrmojo.provide("mstrmojo.vi.ui.rw._SupportViewFilterInVizBox",{_mixinName:"mstrmojo.vi.ui.rw._SupportViewFilterInVizBox",getSelectorObjectsFromTemplateLimit:function N(){return this.getSelObjsFromTemlateLimitHandler();},getSelectorObjectsFromViewFilter:function B(){return this.getSelObjsFromVFHandler();},getSelObjsFromVFHandler:function F(){var R=this,P=R.model,Q=R.node.data,S=Q&&Q.vfexpr;return P&&P.getSelectorDataFromViewFilter(S);},getSelObjsFromTemlateLimitHandler:function K(){var R=this,P=R.model,Q=R.node.data,S=Q&&Q.tpl;return P&&P.getSelectorDataFromTemplateLimit(S);},makeBold:function C(P){return"<span style='font-weight:bold;'>"+P+"</span>";},getSelectorExpr:function I(U,S){var V=[],W="",R=true,Q=U.keepOnly?"##":mstrmojo.desc(13232,"Not ##"),P,X=mstrmojo.desc(5283,"OR");if(S){X=this.makeBold(X);}U.data.every(function(Y){[].concat(Y).every(function(Z){if(W===""){W=Z.tn;}return(R=(W===Z.tn));});return R;});U.data.forEach(function(a,Y){if(Y>0){V.push(X);}var Z=[];[].concat(a).forEach(function(d){var c=S?M.encodeHtmlString(d.v):d.v,b=S?M.encodeHtmlString(d.tn):d.tn;Z.push((R?"":(d.tn+" = "))+(c||mstrmojo.desc(14323,"NULL")));});V.push(Z.join(" "));});if(V.length>0){P=Q.replace("##",(R?W+" = ":"")+V.join(" "));}return P;},getLinkingSelectorExpr:function O(S,R){var U=[],V="",Q=true,W=mstrmojo.desc(5283,"OR"),P=S.keepOnly?"##":mstrmojo.desc(13232,"Not ##");if(R){W=this.makeBold(W);}S.data.every(function(X){[].concat(X).every(function(Y){if(V===""){V=Y.tn;}return(Q=(V===Y.tn));});return Q;});S.data.forEach(function(Z,X){var Y=[];if(Q){if(X>0){Y.push(W);}else{Y.push(P.replace("##",V+" = "));}}[].concat(Z).forEach(function(c){var b=R?M.encodeHtmlString(c.v):c.v,a=R?M.encodeHtmlString(c.tn):c.tn;Y.push((Q?"":(a+" = "))+(b||mstrmojo.desc(14323,"NULL")));});U.push(Y.join(" "));});return U.join(" ");},getFilterMenuPairs:function G(P){var R=this,S=[],Q=mstrmojo.desc(2827,"Clear");if(P instanceof Array){P.forEach(function(X,W){var V=R.getSelectorExpr(X),U=R.getSelectorExpr(X,true);S.push({menuString:Q+' "'+V+'"',menuTtpString:Q+' "'+U+'"',ctxt:W});});}return S;},filterMenuHandler:function L(P,S){var R=this,Q=R.controller;switch(P.type){case H.CLEAR_KEEP_ONLY:P=P.idx;Q.applyKeepOnly(R,S,undefined,P,false);break;case H.CLEAR_ALL:Q.clearFiltersForVis(R,[J.KEEP_ONLY,J.LINKING,J.DRILLING],S);break;case H.CLEAR_ADV_QUALIFICATION:Q.clearFiltersForVis(R,[J.ADV_QUALIFICATION],S);break;case H.CLEAR_KEEP_ONLY_AND_LINKING:Q.clearFiltersForVis(R,[J.KEEP_ONLY,J.LINKING],S);break;case H.CLEAR_LINKING:Q.clearLinkingFilter(P,S);break;case H.CLEAR_DRILLING:Q.clearFiltersForVis(R,[J.DRILLING],S);break;default:break;}},hasKeepOnly:function E(P){return P===null||P.length>0;},getSelectorDataForKeepOnly:function A(Q,V){var S=this,R=S.model,U=S.model.data||S.node.data,P=U.tpl,W;if(V===-1){W=[];}else{W=[].concat(R.getSelectorDataFromTemplateLimit(P));if(V===-2){W=D.filter(W,function(X){return !X.keepOnly;});}else{if(V>=0){W.splice(V,1);}}}if(Q){W=W.concat(Q);}return W;}});}());(function(){mstrmojo.requiresCls("mstrmojo.publisher");var C=mstrmojo.publisher;mstrmojo._Provider=mstrmojo.provide("mstrmojo._Provider",{_meta_usesSuper:false,audibles:{"*":true},set:function F(N,H){var G=false,K=this["_set_"+N],I=this[N];if(K){G=K.apply(this,arguments);}else{this[N]=H;G=(I!==H);}if(G){var L=N+"Change",M=this.audibles||{},J=(M[N]===true)||((M[N]!==false)&&(M["*"]!==false));if(J&&(this["pre"+L]||this["on"+L]||this["post"+L]||C.hasSubs(this.id,L))){this.raiseEvent({name:L,prop:N,value:H,valueWas:I});}}return this;},raiseEvent:function B(H){var M=H&&H.name;if(!M){return null;}H.src=this;this.preHandleEvent(H);var K=["pre","on","post"],L=false,I,G;for(I=0,G=K.length;I<G;I++){var J=K[I]+M;if(this[J]){if(this[J](H)===false){L=true;break;}}}if(!L){this.postHandleEvent(H);C.publish(this.id,M,H);}return H;},preHandleEvent:mstrmojo.emptyFn,postHandleEvent:mstrmojo.emptyFn,attachEventListener:function A(G,H,I){return C.subscribe(this.id,G,I,H);},detachEventListener:function E(G){C.unsubscribe(G);},destroy:function D(){C.clearSubscriptions(this.id);if(this._super){this._super();}}});}());(function(){mstrmojo.requiresCls("mstrmojo.registry","mstrmojo.array","mstrmojo.publisher");var D=mstrmojo.registry,K=mstrmojo.array,I=mstrmojo.publisher;function G(Q,R){if(R){R.parent=Q;var P=D.ref(R);if(R!==P){delete R.parent;}return P;}return null;}function L(Q,R){var P=R.alias;if(P!==null&&P!==""){Q[P]=R;}}function N(Q,R){var P=R.alias;if(R.parent===Q){delete R.parent;}if((P!==null&&P!=="")&&(Q[P]===R)){delete Q[P];}}function A(U,Q){var P=Q&&Q.length,S,R;if(P){S=[];for(R=0;R<P;R++){var V=G(U,Q[R]);if(!V){continue;}S.push(V);L(U,V);}}return S;}mstrmojo._HasChildren=mstrmojo.provide("mstrmojo._HasChildren",{_meta_usesSuper:false,children:null,postCreateChildren:mstrmojo.emptyFn,onaddChild:null,onremoveChild:null,initChildren:function F(){var P="children",Q=this[P];if(!Q){return ;}this[P]=null;this._set_children(P,Q,true);this.postCreateChildren();},_set_children:function E(S,Q,P){var R=this.children;if(Q!==R){if(R){this.removeChildren(null,P);}this.addChildren(Q,0,P);}return false;},destroyChildren:function C(S){var R=this.children,P=(R&&R.length)||0,Q;if(P){for(Q=P-1;Q>-1;Q--){var U=R[Q];if(U&&U.destroy){U.destroy(S);if(!S){N(this,U);}}}if(!S){R.length=0;}}},invalidateChildren:function B(){mstrmojo.array.forEach(this.children,function(P){P.invalidate();});},invalidate:function H(){this.invalidateChildren();},addChildren:function O(V,Q,R){if(!V){return V;}var U=V.constructor===Array,P=A(this,U?V:[V]);if(P&&P.length){var S=this.children||[];if(Q===null||Q===undefined){Q=S.length;}this.children=K.insert(S,Q,P);if(!R&&(this.onaddChild||I.hasSubs(this.id,"addChild"))){this.raiseEvent({name:"addChild",value:P,index:Q});}}return U?P:(P&&P[0]);},removeChildren:function J(W,R){var U=this.children,V=W?[W]:(this.children||[]).concat(),Q=V.length,P=-1,S;if(Q){for(S=Q-1;S>-1;S--){N(this,V[S]);}if(W){P=K.removeItem(U,W);}else{if(U){U.length=0;P=0;}}if(!R&&(this.onremoveChild||I.hasSubs(this.id,"removeChild"))){this.raiseEvent({name:"removeChild",value:V,index:P});}}return P;},removeAndDestroyChild:function M(R,P,Q){if(R){if(R.parent!==this){throw"Unable to remove an object that is not in the children collection.";}this.removeChildren(R,P);R.destroy(Q);}}});}());(function(){mstrmojo.requiresCls("mstrmojo.registry","mstrmojo.hash");var A=false,D="mstrmojo.Binding",I="bindings",H=mstrmojo.registry;function B(K){var L;for(L in K){var J=K[L];if(J&&J.disable){J.destroy();}}}function C(K,M){if(!A){mstrmojo.requiresCls(D);A=true;}var N;for(N in K){var J=K[N];if(J===null||J===undefined){continue;}var L=typeof J;if(L==="string"||L==="function"){J={destination:N,source:J,scriptClass:D};}J.parent=M;J=H.ref(J,{skipLoadChecks:true});K[N]=J;J.enable();}}mstrmojo._HasBindings=mstrmojo.provide("mstrmojo._HasBindings",{_meta_usesSuper:false,initBindings:function E(){this.hasInitBindings=true;var K=mstrmojo.hash.copy(this[I]);if(K){delete this[I];this._set_bindings(I,K);if(this.postCreateBindings){this.postCreateBindings();}}var M=this.children,J=(M&&M.length)||0;if(J){var L;for(L=0;L<J;L++){var N=M[L];if(N&&N.initBindings){N.initBindings();}}}},destroyBindings:function G(){var J=this.bindings;if(J){B(J);delete this.bindings;}},_set_bindings:function F(L,J){var K=this[I];if(J!==K){if(K){B(K);}this[I]=J;if(J){C(J,this);}return true;}return false;}});}());(function(){mstrmojo.requiresCls("mstrmojo.registry");mstrmojo._PagingList=mstrmojo.provide("mstrmojo._PagingList",{usePaging:false,page:0,totalPages:1,_set_page:function(B,A){if(this.page!==A&&this.usePaging){if(A>=0&&A<this.totalPages){this.page=A;}return true;}return false;},_inScroll:false,_inPaging:false,onscroll:function(){if(this.usePaging&&!this._inPaging){this._inScroll=true;this.set("page",this.listMapper.whichPage(this));this._inScroll=false;}if(this._super){this._super();}}});}());(function(){mstrmojo.requiresCls("mstrmojo.dom","mstrmojo.dnd");var E=mstrmojo.dom;function B(I){return E.contains(this.getMovingHandle(),I.src.node,true,document.body);}mstrmojo._IsMovable=mstrmojo.provide("mstrmojo._IsMovable",{draggable:true,ownAvatar:true,getMovingHandle:function G(){return this.domNode;},getMovingTarget:function H(){return this.domNode;},isDragValid:function A(I){return B.call(this,I)||(this._super&&this._super(I))||false;},ondragstart:function C(J){if(B.call(this,J)){var K=this.getMovingHandle(),I=this.getMovingTarget().style;this._leftPos=parseInt(I.left,10);this._topPos=parseInt(I.top,10);this._hWidth=K.clientWidth;this._hHeight=K.clientHeight;}if(this._super){this._super();}},ondragmove:function F(L){if(B.call(this,L)){var M=L.tgt.pos,J=L.src.pos,K=this.getMovingTarget().style,I=E.windowDim();K.left=this.left=Math.min(Math.max(this._leftPos+M.x-J.x,-this._hWidth+40),I.w-40)+"px";K.top=this.top=Math.min(Math.max(this._topPos+M.y-J.y,-this._hHeight+20),I.h-20)+"px";}if(this._super){this._super();}},ondragend:function D(I){if(B.call(this,I)){delete this._leftPos;delete this._topPos;delete this._hWidth;delete this._hHeight;}if(this._super){this._super();}}});}());(function(){mstrmojo.requiresCls("mstrmojo.Base","mstrmojo.array");var H=mstrmojo,F=H.array,A="00000000000000000000000000000000",E=-1;function J(K){return K&&K.t===4&&K.id!==A;}function G(L){var K,M=(L&&L.length)||0;if(M===0){return false;}for(K=0;K<M;K++){if(!J(L[K])){return false;}}return true;}mstrmojo.VisProps=null;mstrmojo.vi.viz.DropZoneHelper=mstrmojo.declare(mstrmojo.Base,null,{scriptClass:"mstrmojo.vi.viz.DropZoneHelper",getXml:function B(){return"";},setData:function I(K){},isMetric:function(K){return J(K);},isMetricZone:function(K){return G(K);},getMetricCountInZone:function D(L){var K=0;F.forEach(L,function(M){if(J(M)){K++;}});return K;}});mstrmojo.vi.viz.DropZoneHelper.METRIC_NAMES_ID=A;mstrmojo.vi.viz.DropZoneHelper.isMetricNames=function C(K){return(parseInt(K.did,10)===E)||(K.id===A)||(K.did===A);};}());(function(){mstrmojo.requiresCls("mstrmojo.locales");var Y=function(){return mstrmojo.locales.datetime;},L=mstrmojo.string;mstrmojo.date=mstrmojo.provide("mstrmojo.date",{monthNumbers:{Jan:1,Feb:2,Mar:3,Apr:4,May:5,Jun:6,Jul:7,Aug:8,Sep:9,Oct:10,Nov:11,Dec:12},REGEXPS:{DATES:{},TIMES:{}},CACHE:{PARSEDATE:{CONTAINS:{},EQUALS:{}},PARSETIME:{CONTAINS:{},EQUALS:{}}},now:Date.now||function D(){return new Date().getTime();},isDate:function Z(c,g,b){var e=this.parseDate(c,b);var f=!!(e&&this.doesDateExist(e.month,e.day,e.year));if(g){if(f){var d=this.formatDateInfo(e,Y().DATEOUTPUTFORMAT);if(b){return{match:e.match,formatted:d};}return d;}return null;}return !!f;},formatDateInfo:function R(e,g){if(!g){return"";}var b=e.day,f=e.month,d=e.year;var c=g.replace(/dd/g,this.formatInteger(b,2)).replace(/d/g,Number(b)).replace(/yyyy/g,Number(d)).replace(/yy/g,this.formatInteger(Number(d)%100,2)).replace(/MMM/g,"~~~~").replace(/MM/g,"@@").replace(/M/g,"^").replace(/MMMM/g,Y().MONTHNAME_FULL[Number(f)-1]).replace(/\~\~\~\~/g,Y().MONTHNAME_SHORT[Number(f)-1]).replace(/\@\@/g,this.formatInteger(f,2)).replace(/\^/g,Number(e.month));return c;},parseDate:function a(m,g,k){if(m==null){return false;}if(typeof m!=="string"){m=String(m);}m=L.trim(m);var b=this.CACHE.PARSEDATE[g?"CONTAINS":"EQUALS"],d=b[m];if(d||(d===null)){return d;}var c=null;var j;if(k){j=[k];}else{j=[].concat(Y().DATEINPUTFORMATS);j.unshift(Y().DATEOUTPUTFORMAT);}var e,f;for(e=0,f=j.length;e<f;e++){var h=this._buildRegExp4DateFormat(j[e]),l=h&&m.match(g?h.reContains:h.reEquals);if(l){c={match:l[0],year:h.yearIndex&&this.fourDigitYear(l[h.yearIndex]),day:h.dayIndex&&parseInt(Number(l[h.dayIndex]),10),month:h.monthIndex&&this.numericMonth(l[h.monthIndex])};break;}}b[m]=c;return c;},isTime:function I(c,f,b){var g=this.parseTime(c,b);var e=!!(g&&this.doesTimeExist(g.hour,g.min,g.sec));if(f){if(e){var d=this.formatTimeInfo(g,Y().TIMEOUTPUTFORMAT);if(b){return{match:g.match,formatted:d};}return d;}return null;}return !!e;},parseTime:function J(n,g,l){if(n==null){return false;}if(typeof n!=="string"){n=String(n);}n=L.trim(n);var b=this.CACHE.PARSETIME[g?"CONTAINS":"EQUALS"],d=b[n];if(d||(d===null)){return d;}var c=null;var k;if(l){k=[l];}else{k=[].concat(Y().TIMEINPUTFORMATS);k.unshift(Y().TIMEOUTPUTFORMAT);}var e,f;for(e=0,f=k.length;e<f;e++){var j=this._buildRegExp4TimeFormat(k[e]),m=j&&n.match(g?j.reContains:j.reEquals);if(m){var h=j.ampmIndex&&m[j.ampmIndex];c={match:m[0],hour:j.hourIndex&&this.capitalHour(m[j.hourIndex],h),min:j.minIndex&&parseInt(Number(m[j.minIndex]),10),sec:j.secIndex&&parseInt(Number(m[j.secIndex]),10)};break;}}b[n]=c;return c;},formatTimeInfo:function S(e,c){if(!c){return"";}var d=!(Number(e.hour)%12)?12:(Number(e.hour)%12),b=c.replace(/HH/g,this.formatInteger(e.hour,2)).replace(/H/g,Number(e.hour)).replace(/hh/g,this.formatInteger(d,2)).replace(/h/g,d).replace(/mm/g,this.formatInteger(Number(e.min)||0,2)).replace(/m/g,Number(e.min)||0).replace(/ss/g,this.formatInteger(Number(e.sec)||0,2)).replace(/s/g,Number(e.sec)||0).replace(/a/g,(Number(e.hour)<12)?Y().AM_NAME:Y().PM_NAME).replace(/tt/g,(Number(e.hour)<12)?Y().AM_NAME:Y().PM_NAME).replace(/AM\/PM/g,(Number(e.hour)<12)?Y().AM_NAME:Y().PM_NAME);return b;},doesTimeExist:function G(g,c,f){var e=parseInt(g,10);if(e>=0&&e<=23){var b=parseInt(c,10);if(b>=0&&b<=59){if(!f){return true;}var d=parseInt(f,10);if(d>=0&&d<=59){return true;}}}return false;},capitalHour:function C(b,c){b=parseInt(Number(b),10);if(c&&(c.match(Y().AM_NAME)||c.match(/AM/i))){return b%12;}if(c&&(c.match(Y().PM_NAME)||c.match(/PM/i))){return 12+(b%12);}return b;},getTimeStamp:function O(){var c=new Date();var b=[c.getMonth()+1,c.getDate(),c.getFullYear()];var f=[c.getHours(),c.getMinutes(),c.getSeconds()];var e=(f[0]<12)?"AM":"PM";f[0]=(f[0]<12)?f[0]:f[0]-12;f[0]=f[0]||12;for(var d=1;d<3;d++){if(f[d]<10){f[d]="0"+f[d];}}return b.join("-")+" "+f.join("")+" "+e;},isDateAndOrTime:function W(b,c){return this.isDateTime(b,c)||this.isDate(b,c)||this.isTime(b,c);},isDateTime:function B(l,b){var f=this.parseDateAndOrTime(l),j=f&&f.date,e=f&&f.time,h=!!j&&!!e&&this.doesDateExist(j.month,j.day,j.year)&&this.doesTimeExist(e.hour,e.min,e.sec);if(b){if(h){var c=this.formatDateInfo(j,Y().DATEOUTPUTFORMAT),d=this.formatTimeInfo(e,Y().TIMEOUTPUTFORMAT),k=l.indexOf(j.match),g=l.indexOf(e.match);return(g<k)?d+" "+c:c+" "+d;}return null;}return !!h;},parseDateAndOrTime:function Q(c,b,g){var d=this.parseDate(c,true,b);var e=L.trim((d&&d.match)?c.replace(d.match,""):c),f=this.parseTime(e,false,g);if(!d&&!f){return null;}return{date:d,time:f};},inDateTimeRange:function P(d,f,j){var c=this.parseDateAndOrTime(d),g=c&&c.date,k=c&&c.time;if(!g&&!k){return 0;}if(f!=null){var e=this.parseDateAndOrTime(f);if(g&&e&&e.date){var l=this.compareDate(g,e.date);if(l<0){return -1;}if(l==0){if(k&&e.time&&(this.compareTime(k,e.time)<0)){return -1;}}}}if(j!=null){var b=this.parseDateAndOrTime(j);if(g&&b&&b.date){var h=this.compareDate(g,b.date);if(h>0){return 1;}if(h==0){if(k&&b.time&&(this.compareTime(k,b.time)>0)){return 1;}}}}return 0;},compareDate:function A(d,b){if(d===b){return 0;}var e=typeof d==="string"?this.parseDate(d):d,c=typeof b==="string"?this.parseDate(b):b;if(!e){return -1;}if(!c){return 1;}return(e.year-c.year)||(e.month-c.month)||(e.day-c.day)||0;},compareTime:function K(c,b){if(c===b){return 0;}var e=typeof c==="string"?this.parseTime(c):c,d=typeof b==="string"?this.parseTime(b):b;if(!e){return -1;}if(!d){return 1;}return(e.hour-d.hour)||(e.min-d.min)||(e.sec-d.sec)||0;},compareDateTime:function V(c,b){return this.compareDate(c,b)||this.compareTime(c,b);},compareDateAndOrTime:function E(j,g){if(j===g){return 0;}var c=typeof j==="string"?this.parseDateAndOrTime(j):j,b=typeof g==="string"?this.parseDateAndOrTime(g):g;if(!c){return -1;}if(!b){return 1;}var h=c.date,f=b.date,e=c.time,d=b.time;return this.compareDate(h,f)||this.compareTime(e,d);},_buildRegExp4DateFormat:function N(d){if(!d){return null;}var f=this.REGEXPS.DATES[d];if(!f){if(!this.REGEXPS.MONTHNAME_FULL){this.REGEXPS.MONTHNAME_FULL=Y().MONTHNAME_FULL.join("|");this.REGEXPS.MONTHNAME_SHORT=Y().MONTHNAME_SHORT.join("|");}f=this.REGEXPS.DATES[d]={};f.formatStr=d;var c=f.reStr=d.replace(/([^M|d|y|\s])/g,"\\$1").replace(/dd/g,"~~~~").replace(/d/g,"(\\d{1,2})").replace(/\~\~\~\~/g,"(\\d\\d)").replace(/yyyy/g,"(\\d\\d\\d\\d)").replace(/yy/g,"(\\d\\d)").replace(/MMMM/g,"@@@@").replace(/MMM/g,"@@@").replace(/MM/g,"(\\d\\d)").replace(/M/g,"(\\d{1,2})").replace("@@@@","("+this.REGEXPS.MONTHNAME_FULL+")").replace("@@@","("+this.REGEXPS.MONTHNAME_SHORT+")");f.reEquals=new RegExp("^"+c+"$");f.reContains=new RegExp("^"+c+"\\b");var g=[{key:"monthIndex",index:d.indexOf("M")},{key:"dayIndex",index:d.indexOf("d")},{key:"yearIndex",index:d.indexOf("y")}];g.sort(function(j,h){return j.index-h.index;});var b=1,e;for(e=0;e<3;e++){f[g[e].key]=g[e].index>-1?b++:null;}}return f;},_buildRegExp4TimeFormat:function F(e){if(!e){return null;}var g=this.REGEXPS.TIMES[e];if(!g){if(!this.REGEXPSTR_AMPM){this.REGEXPSTR_AMPM=[Y().AM_NAME,Y().PM_NAME,String(Y().AM_NAME).toLowerCase(),String(Y().PM_NAME).toLowerCase()].join("|");}g=this.REGEXPS.TIMES[e]={};g.formatStr=e;var d=e.replace(/\'\'/g,'"');var h=d.match(/\'(.+?)\'/g);d.replace(/\'(.+?)\'/g,"*");d=d.replace(/([^H|h|m|s|z|Z|a|t|\s|A|P|M|\/])/g,"\\$1").replace(/HH|hh/g,"(\\d\\d)").replace(/H|h/g,"(\\d{1,2})").replace(/mm/g,"(\\d\\d)").replace(/m/g,"(\\d{1,2})").replace(/ss/g,"(\\d\\d)").replace(/s/g,"(\\d{1,2})").replace(/a/g,"("+this.REGEXPSTR_AMPM+")").replace(/AM\/PM/,"("+this.REGEXPSTR_AMPM+")").replace(/tt/g,"("+this.REGEXPSTR_AMPM+")").replace(/z|Z/g,"(.+?)");var f,b;for(f=1,b=(h&&h.length)||0;f<b;f++){d=d.replace(/\*/,h[f]);}d=d.replace(/\"/g,"'");g.reEquals=new RegExp("^"+d+"$");g.reContains=new RegExp(d);var j=[{key:"hourIndex",index:e.search(/h|H/)},{key:"minIndex",index:e.indexOf("m")},{key:"secIndex",index:e.indexOf("s")},{key:"ampmIndex",index:e.search(/tt|a|AM\/PM/)},{key:"zoneIndex",index:e.search(/z|Z/)}];j.sort(function(l,k){return l.index-k.index;});var c=1;for(f=0;f<5;f++){g[j[f].key]=j[f].index>-1?c++:null;}}return g;},doesDateExist:function M(e,b,c){var d=new Date(c,e-1,b);return c==d.getFullYear()&&e==d.getMonth()+1&&b==d.getDate();},fourDigitYear:function U(c){c=parseInt(Number(c),10);if(!isNaN(c)){var b=(Y().TWODIGITYEARSTART%100)||0;if(c>=0&&c<=b){c=2000+c;}else{if(c>b&&c<100){c=1900+c;}}}return c;},numericMonth:function X(f){var e=parseInt(Number(f),10),d=mstrmojo.array;if(!isNaN(e)){return e;}var b=(f&&f.length)||0,c=-1;if(b){if(b<=3){c=d.indexOf(Y().MONTHNAME_SHORT,f);}if(c===-1){c=d.indexOf(Y().MONTHNAME_FULL,f);}}return c+1;},formatInteger:function H(d,c){var g=String(d),f=Math.max(c-g.length,0);if(f>0){var b=[g],e;for(e=1;e<=f;e++){b.push("0");}g=b.reverse().join("");}return g;},getFirstDateOfMonth:function(c,b){return new Date(c,b-1,1);},getDateObject:function(h,b,g,e,f,c){h=h||0;b=b||1;g=g||1;e=e||0;f=f||0;c=c||0;return new Date(h,b-1,g,e,f,c);},getDateFromDateInfo:function(b){return this.getDateObject(b.date&&b.date.year,b.date&&b.date.month,b.date&&b.date.day,b.time&&b.time.hour,b.time&&b.time.min,b.time&&b.time.sec);},getDateJson:function(b){return{year:b.getFullYear(),month:b.getMonth()+1,day:b.getDate(),hour:b.getHours(),min:b.getMinutes(),sec:b.getSeconds()};},isLeapYear:function(b){return !(b%400)||(!(b%4)&&!!(b%100));},getDaysOfMonth:function(d,b){var c=[31,28,31,30,31,30,31,31,30,31,30,31];if(b==2&&this.isLeapYear(d)){return 29;}return c[b-1];},getPreMonth:function(c,b){if(b===1){return{y:c-1,m:12};}return{y:c,m:b-1};},getNextMonth:function(c,b){if(b===12){return{y:c+1,m:1};}return{y:c,m:b+1};}});}());(function(){mstrmojo.requiresCls("mstrmojo.array","mstrmojo.hash","mstrmojo.locales");var d=mstrmojo.array,P=mstrmojo.meta.TP,G=mstrmojo.meta.STP,O=mstrmojo.hash,F={ANDOR:14,MQ:10,MC:12,AQ:2,AL:6,AC:9,AE:5,F:13,R:21,B:20,XML:1,RLS:15},B={};var X;for(X in F){B[F[X]]=true;}var b={};b[F.AQ]="a";b[F.AL]="a";b[F.AC]="a";b[F.AE]="a";b[F.MQ]="m";b[F.MC]="m";b[F.F]="f";b[F.R]="r";b[F.XML]="p";b[F.ANDOR]="nds";var K={};K[F.MQ]=["not","m","fn","fnt","cs","dmy","idcsi"];K[F.MC]=["not","m","fn","fnt","m2","m3","p","dmy","idcsi"];K[F.AE]=["not","a","fn","es","a2","fm2","p"];K[F.AQ]=["not","a","fm","fn","cs"];K[F.AL]=["not","a","fm","fn","cs"];K[F.AC]=["not","a","fm","a2","fm2","a3","fm3","fn","cs"];K[F.R]=["not","r"];K[F.F]=["not","f"];K[F.XML]=["not","n","p"];K[F.ANDOR]=["not","node","nds","fn"];var M={};M[F.MQ]="METRIC_FNS";M[F.MC]="METRIC_FNS";M[F.AQ]="FORM_FNS";M[F.AL]="FORM_FNS";M[F.AC]="FORM_FNS";M[F.AE]="ELEM_FNS";var N={FILTER:1,REPORT:3,METRIC:4,FOLDER:8,PROMPT:10,FUNCTION:11,ATTR:12,FACT:13,DIM:14,FORM:21,ROLE:43,CONS:47},c={FILTER:256,CUSTOMGROUP:257,PROMPT:2560,PROMPT_BOOLEAN:2561,PROMPT_LONG:2562,PROMPT_STRING:2563,PROMPT_DOUBLE:2564,PROMPT_DATE:2565,PROMPT_OBJECTS:2566,PROMPT_ELEMENTS:2567,PROMPT_EXPRESSION:2568,PROMPT_EXPRESSION_DRAFT:2569,PROMPT_DIMTY:2570,PROMPT_BIGDECIMAL:2571,REPORT_GRID:768,REPORT_GRAPH:769,REPORT_ENGINE:770,REPORT_TEXT:771,REPORT_DATAMART:772,REPORT_BASE:773,REPORT_GRIDGRAPH:774,REPORT_NONINTERACTIVE:775,REPORT_CUBE:776,REPORT_EMMACUBE:779,CONS:12032,NDE:12033},U={a:N.ATTR,a2:N.ATTR,m:N.METRIC,m2:N.METRIC,r:N.REPORT,f:N.FILTER,p:N.PROMPT},V={f:c.FILTER};var W={};W[F.MQ]=N.METRIC;W[F.MC]=N.METRIC;W[F.AQ]=N.ATTR;W[F.AL]=N.ATTR;W[F.AC]=N.ATTR;W[F.AE]=N.ATTR;W[F.F]=N.FILTER;W[F.R]=N.REPORT;var J=function(e){var H=e.length,h={},g;for(g=0;g<H;g++){var j=e[g];h[j.did]=j.n;}return h;},E=function(f){var H=f.length,g;for(g=0;g<H;g++){var e=f[g];if("tp" in e){e.t=e.tp;}}return f;},Y=function(f,h){var H=f.length,g;for(g=0;g<H;g++){var e=f[g];if("tp" in e){if(h){e.t=h;}else{delete e.t;}}}return f;},a=function(e,g){if(!g){g=[];}g.length=0;var f,H;for(f=0,H=e.length;f<H;f++){g[f]=e[f];}return g;},L={0:[{did:"1,76"},{did:"1,79"},{did:"1,77"},{did:"1,80"},{did:"1,78"},{did:"1,81"},{did:"1,18"},{did:"1,43"}],1:[{did:"2,1"},{did:"2,2"},{did:"3,1"},{did:"3,2"}]};var R={0:[{did:"1,22"},{did:"1,57"}]};mstrmojo.expr=mstrmojo.provide("mstrmojo.expr",{ET:F,ETs:B,ET2TGT:b,ET2COND:K,ET2TP:W,FN:{EQUAL:6,NOT_EQUAL:7,GREATER:8,LESS:9,GREATER_EQUAL:10,LESS_EQUAL:11,IN_LIST:22,NOT_IN_LIST:57,BETWEEN:17,NOT_BETWEEN:44,IS_NULL:54,IS_NOT_NULL:55,AND:19,OR:20,NOT:21,SEARCH:158,DESCENDANT:187},FN_MRP:{BETWEEN:3,EXCLUDE_TOP:4,EXCLUDE_BOTTOM:5,BETWEEN_DESCENDING:13},FNT:{DEF:1,RANK:2,PER:3},FN_SEP:",",TP:N,STP:c,DMY_TP:{ATTR:-1,DIM:-2},DTP:{UNKNOWN:-1,INTEGER:1,UNSIGNED:2,NUMERIC:3,DECIMAL:4,REAL:5,DOUBLE:6,FLOAT:7,CHAR:8,VARCHAR:9,LONGVARCHAR:10,BINARY:11,VARBIN:12,LONGVARBIN:13,DATE:14,TIME:15,TIMESTAMP:16,SHORT:21,LONG:22,MBCHAR:23,BOOLEAN:24,PATTERN:25,BIGDECIMAL:30},BFTP:{RESERVED:0,HIDDEN:-1,DATETIME:1,NUMBER:2,TEXT:3,PICTURE:4,URL:5,EMAIL:6,TAG:7,DATE:8,TIME:9,SYMBOL:10,BIGDECIMAL:11,PHONENUMBER:12},METRIC_DTP:3,FN_DTP:{NUM:0,CHAR:1,DATE:2},DTP2PROMPT_STP:{"-1":c.PROMPT,1:c.PROMPT_LONG,2:c.PROMPT_LONG,3:c.PROMPT_LONG,4:c.PROMPT_DOUBLE,5:c.PROMPT_DOUBLE,6:c.PROMPT_DOUBLE,7:c.PROMPT_DOUBLE,8:c.PROMPT_STRING,9:c.PROMPT_STRING,10:c.PROMPT_STRING,14:c.PROMPT_DATE,15:c.PROMPT_DATE,16:c.PROMPT_DATE,21:c.PROMPT_LONG,22:c.PROMPT_LONG,23:c.PROMPT_STRING,24:c.PROMPT_BOOLEAN,30:c.PROMPT_BIGDECIMAL},DTP2FN_DTP:{"-1":0,1:0,2:0,3:0,4:0,5:0,6:0,7:0,8:1,9:1,10:1,11:0,12:0,13:0,14:0,15:0,16:0,21:0,22:0,23:1,24:0,25:1,30:0,34:0},fnCstCount:function A(g,e){var h=this.FN,j=this.FN_MRP,H=this.FNT;if(e===H.DEF||e===undefined){switch(g){case h.BETWEEN:case h.NOT_BETWEEN:return 2;case h.IS_NULL:case h.IS_NOT_NULL:return 0;}}else{if(e===H.PER||e===H.RANK){switch(g){case j.BETWEEN:case j.BETWEEN_DESCENDING:return 2;}}}return 1;},fn_List:function S(e,H){var g=this.FN;return e==g.IN_LIST||e==g.NOT_IN_LIST;},fn_AC_MC:function Z(e,H){var g=this.FN;return(e==g.EQUAL)||(e==g.NOT_EQUAL)||(e==g.GREATER)||(e==g.LESS)||(e==g.GREATER_EQUAL)||(e==g.LESS_EQUAL);},fnName:function Q(j,h,e,g){var H=this[M[j]];if(H&&H.constructor===Object){H=H[this.DTP2FN_DTP[g]]||H["*"];}if(j===F.MQ){H=H.concat(mstrmojo.locales.expression.MetricRP);}var f=d.find(H,"did",(e||1)+this.FN_SEP+h);if(f>-1){return H[f].n;}return"";},findTargets:function I(o,g,q){if(!q){q={};}if(o){var n;for(n in U){var AB=o[n];if(AB){if(!AB[P]){AB[P]=U[n];}if(!AB[G]&&V[n]){AB[G]=V[n];}q[AB[g]]=AB;}}if(o.dmy){var l=this.TP.ATTR,r=this.DMY_TP.ATTR,f=o.dmy.uts,AA,e;for(AA=0,e=(f&&f.length)||0;AA<e;AA++){var m=f[AA];if(m&&m.utp===r){var j=m.utgt;if(!j.t){j.t=l;}q[j[g]]=j;}}}var H=o.nds,p,x;for(p=0,x=(H&&H.length)||0;p<x;p++){this.findTargets(H[p],g,q);}var w=o.cs,z=w&&w.length;if(z){for(p=0;p<z;p++){this.findTargets(w[p],g,q);}}}return q;},onLocaleUpdated:function(){var e=mstrmojo.locales.expression,H=mstrmojo.expr;H.BRANCH_FNS=O.copy(J(e.BranchQual),H.BRANCH_FNS);H.ELEM_FNS=a(Y(e.Element,"fn"),H.ELEM_FNS);H.METRIC_FNS={"*":Y(d.filter(e.Metric.concat(e.MetricRP),function(f){return f.did&&(d.find(R["0"],"did",f.did)<0);}))};H.FORM_FNS={0:Y(d.filter(e.Attribute,function(f){return f.did&&(d.find(L["0"],"did",f.did)<0);})),1:Y(d.filter(e.Attribute,function(f){return f.did&&(d.find(L["1"],"did",f.did)<0);})),2:Y(d.filter(e.Attribute,function(f){return f.did&&(d.find(L["0"],"did",f.did)<0)&&(d.find(L["1"],"did",f.did)<0);}))};H.DIMTYLEVELS=a(Y(e.DimtyLevels),H.DIMTYLEVELS);},getSortedObjectsByTypeGroup:function D(h){var f=-1,H=0,e=1,g=2;function j(k){switch(k.t){case N.METRIC:return e;case N.ATTR:case N.DIM:case N.CONS:return H;case N.FILTER:return k.st===c.CUSTOMGROUP?H:g;case -1:return f;default:return g;}}h=d.map(h||[],function(k){return O.copy(k,{});});return h.sort(function(o,n){var p=j(o)-j(n);if(p){return p;}var m=o.n.toUpperCase(),l=n.n.toUpperCase(),k=m.localeCompare(l);if(k){return k;}return o.n.localeCompare(n.n);});},mapBaseFormTypeToDataType:function C(f){f=parseInt(f);if(f===NaN){return -1;}var e=this.BFTP,H=this.DTP;switch(f){case e.DATETIME:return H.TIMESTAMP;case e.DATE:return H.DATE;case e.TIME:return H.TIME;case e.NUMBER:return H.REAL;case e.TEXT:return H.CHAR;case e.BIGDECIMAL:return H.BIGDECIMAL;default:return H.CHAR;}}});mstrmojo.expr.onLocaleUpdated();}());(function(){mstrmojo.requiresCls("mstrmojo.vi.enums.EnumThemeProperties");var A=mstrmojo.vi.enums.EnumThemeProperties,B=A.ENUM_LAYOUT_THEME;mstrmojo.util.ThemeHelper=mstrmojo.provide("mstrmojo.util.ThemeHelper",{getThemePropConfig:function C(E){var F=E&&E.layoutTheme,D=E&&E.layoutstyle;if(!F){F=!!D?B.DEFAULT:B.CLASSIC;}return F===B.DEFAULT?A.DEFAULT_THEME_PROPS:A.CLASSIC_THEME_PROPS;}});})();(function(){mstrmojo.requiresCls("mstrmojo.hash","mstrmojo.array","mstrmojo.expr","mstrmojo.elementHelper","mstrmojo.mstr.EnumNodeProperties","mstrmojo.EnumSelectionType");var k=mstrmojo.array,U=mstrmojo.hash,Q=mstrmojo.expr,f=mstrmojo.elementHelper,Z=Q.ET,E=Q.FN,m=Q.DTP,C=mstrmojo.mstr.EnumNodeProperties,c=mstrmojo.EnumSelectionType;var AF=0,F=1,M=2,K=3,d=4,u=5;var n=0,AG="u;",Y="LEVEL_NUMBER",X=false,J=7;function AE(AI){return AI.t===47&&AI.st===12033;}function S(AI,AJ){if(AI&&AJ&&AJ.t===J){return AI.parent===AJ&&AI.lv===AJ.lv;}return false;}function l(AI){if(AI&&AI.t===J){return k.filter(AI.children,function(AJ){return AJ.lv===AI.lv;});}return[];}function AD(AI){return !!AI.not||AI.fn===E.NOT_IN_LIST||AI.fn===E.NOT_EQUAL;}function AA(AI){return U.copyProps(["did","n","t","st"],AI);}function P(AL,AI){var AK=AE(AI),AM=AK?AL.v:f.terseLong2OldShort(AL.v),AJ={v:AM.replace(/\\:/g,"*:"),n:AL.n};if(AK){AJ.t=AL.t;AJ.conid=AI.did;}return AJ;}function R(AL,AJ){if(parseInt(AL,10)>=0){var AK=AJ.lvfs||[],AI=AK[AL]&&AK[AL].lvfn||"";return{v:AI?AL+";"+AI:AL,dtp:AI?m.CHAR:m.INTEGER};}return null;}function z(AL,AN,AK){var AI=f.getIdPresentation(AL),AJ=AE(AK);AL=AL.replace(/\*:/g,"\\:");switch(AN){case"old":case"oldLong":switch(AI){case"old":case"oldLong":return AL;case"terse":case"terseLong":switch(AL[0]){case"V":return AL.substring(1).split(";")[0];case"n":return"HF:"+ +f.terseLong2OldShort(AL)+":47";default:return f.terseLong2OldShort(AL);}}break;case"terse":case"terseLong":switch(AI){case"old":return AJ?("V"+AL+";"+AK.did):f.oldShort2terseLong(AL,"h");case"oldLong":switch(AL.substring(0,2)){case"HF":var AM=AL.substr(3).split(":");if(AM.length>3){AM.pop();}return f.oldShort2terseLong(AM.join(":"),"n");default:return AL;}case"terse":case"terseLong":return AL;}break;default:return AL;}}function t(AI){if(isNaN(AI)&&typeof AI==="string"){return parseInt(AI.split(";")[0],10);}return parseInt(AI,10);}function o(AI){return !AI||AI.lv>0&&!AI.parent;}function a(AI,AQ,AP){var AN=AP.item,AK=AP.ancestorMap,AO=AP.descendantMap,AJ=this.getItemByValue(AI.itemValue),AM=this.getItemByValue(AQ.itemValue),AL=function(AR,AS){if(AN&&AN===AR&&AO){return AO[AS.v];}if(AN&&AN===AS&&AK){return AK[AR.v];}while(AS){if(AR===AS){return true;}AS=AS.parent;}return false;};switch(AI.func){case c.ALL:return AQ.func===c.ALL?AF:K;case c.ELEMENT:switch(AQ.func){case c.ALL:return M;case c.ELEMENT:return AJ===AM?AF:S(AJ,AM)?M:S(AM,AJ)?K:u;case c.BRANCH:return AL(AM,AJ)?M:S(AM,AJ)?d:o(AJ)?F:u;case c.LEVEL:return AJ.lv===AQ.level?M:u;case c.BRANCH_LEVEL:return AJ.lv!==AQ.level?u:o(AJ)?F:AL(AM,AJ)?M:u;}break;case c.BRANCH:switch(AQ.func){case c.ALL:return M;case c.ELEMENT:return AL(AJ,AM)?K:S(AJ,AM)?d:o(AM)?F:u;case c.BRANCH:return AJ===AM?AF:(o(AJ)||o(AM))?F:AL(AM,AJ)?M:AL(AJ,AM)?K:u;case c.LEVEL:return AJ.lv<=AQ.level?d:u;case c.BRANCH_LEVEL:return AJ===AM?K:(o(AJ)||o(AM))?F:AL(AJ,AM)?K:(AL(AM,AJ)&&AQ.level>=AJ.lv)?d:u;}break;case c.LEVEL:switch(AQ.func){case c.ALL:return M;case c.ELEMENT:return AM.lv===AI.level?K:u;case c.BRANCH:return AM.lv<=AI.level?d:u;case c.LEVEL:return AI.level===AQ.level?AF:u;case c.BRANCH_LEVEL:return AI.level===AQ.level?K:u;}break;case c.BRANCH_LEVEL:switch(AQ.func){case c.ALL:return M;case c.ELEMENT:return AM.lv!==AI.level?u:o(AM)?F:AL(AJ,AM)?K:u;case c.BRANCH:return AJ===AM?M:(o(AJ)||o(AM))?F:AL(AM,AJ)?M:(AL(AJ,AM)&&AI.level>=AM.lv)?d:u;case c.LEVEL:return AI.level===AQ.level?M:u;case c.BRANCH_LEVEL:return AI.level!==AQ.level?u:AJ===AM?AF:(o(AJ)||o(AM))?F:AL(AM,AJ)?M:AL(AJ,AM)?K:u;}break;}return F;}function D(AJ,AN,AK,AO,AI){var AM=(AJ.fs||[]).filter(function(AP){return(AP.n||AP.fnm)===Y;})[0],AL=k.ensureArray(AK).map(function(AP){return P(AP,AJ);});switch(AN){case c.ELEMENT:if(AL.length>0){return{et:Z.AE,fn:AI?E.NOT_IN_LIST:E.IN_LIST,a:AA(AJ),es:AL};}break;case c.BRANCH:if(AL.length>0){return{et:Z.AE,fn:E.DESCENDANT,not:AI,a:AA(AJ),es:AL};}break;case c.LEVEL:if(AM&&parseInt(AO,10)>=0){return{et:Z.AQ,fn:E.EQUAL,not:AI,a:AA(AJ),fm:{did:AM.did||AM.fid,n:Y,dtp:Q.mapBaseFormTypeToDataType(AM.bftp)},cs:[R(AO,AJ)]};}break;case c.BRANCH_LEVEL:if(AL.length>0&&parseInt(AO,10)>=0){return{et:Z.AE,fn:E.DESCENDANT,not:AI,a:AA(AJ),es:AL,cs:[R(AO,AJ),{v:18,dtp:m.INTEGER}]};}break;}return null;}function B(){var AI={};this.selectionList.forEach(function(AK,AJ){if(AK.func===c.ELEMENT){AI[AK.itemValue]=AJ;var AL=this.getItemByValue(AK.itemValue);k.forEach(l(AL),function(AM){AI[AM.v]=AJ;});}},this);return AI;}function w(){var AI={};this.selectionList.forEach(function(AK,AJ){if(AK.func===c.BRANCH){AI[AK.itemValue]=AJ;}});return AI;}function A(){var AI={};this.selectionList.forEach(function(AK,AJ){if(AK.func===c.LEVEL){AI[AK.level]=AJ;}});return AI;}function j(){var AI={};this.selectionList.forEach(function(AL,AJ){if(AL.func===c.BRANCH_LEVEL){var AM=AL.itemValue,AN=AL.level,AK=AI[AM];if(!AK){AK=AI[AM]={};}AK[AN]=AJ;}});return AI;}function W(AK){var AJ=w.call(this),AI=n;while(AK&&AK.v){AI=Math.max(AI,AJ[AK.v]||n);AK=AK.parent;}return AI;}function q(AK,AM){var AI=j.call(this),AL=A.call(this),AJ=AM?n:W.call(this,AK),AO=AK&&AK.lv||0,AN={};if(!AM){U.forEach(AL,function(AQ,AP){if(AP>=AO&&AQ>AJ){AN[AP]=AQ;}});}while(AK&&AK.v){U.forEach(AI[AK.v],function(AQ,AP){if(AP>=AO&&AQ>AJ){AN[AP]=Math.max(AQ,AN[AP]||AJ);}});AK=AK.parent;}return AN;}mstrmojo.ui._HierarchyListSelection=mstrmojo.provide("mstrmojo.ui._HierarchyListSelection",{_mixinName:"mstrmojo.ui._HierarchyListSelection",init:function x(AI){this._super(AI);this.clearSelections();},getAllSelection:function I(){return !this.selectionList[n].isNot;},setAllSelection:function g(AI){this.selectionList[n].isNot=!AI;},clearSelections:function h(){this.selectionList=[{func:c.ALL,isNot:!X}];return this.selectionList;},addSelection:function V(AI){var AM=this.selectionList,AK=this.getItemByValue(AI.itemValue),AJ={item:AK,ancestorMap:AK&&this.getItemAncestorMap(AK),descendantMap:AK&&this.getItemDescendantMap(AK)},AL=true;if(!AK&&(AI.func===c.ELEMENT||AI.func===c.BRANCH||AI.func===c.BRANCH_LEVEL)){return ;}AM=this.selectionList=AM.filter(function(AN){var AP=a.call(this,AN,AI,AJ),AO=AN.isNot===AI.isNot;if(AP===K||AP===d&&!AO){AL=!AO;}return !(AP===AF||AP===M);},this);if(AL){AM.push(AI);}},updateSiblingItemSelection:function p(AJ){var AL=this.selectionList,AI=B.call(this),AK=w.call(this);k.forEach(AJ,function(AQ){var AN=AQ.parent,AM=AN?W.call(this,AN):n,AO=AN?q.call(this,AN):A.call(this),AP=Math.max(AK[AQ.v]||n,AM),AR=Math.max(AI[AQ.v]||n,AP,AO[AQ.lv]||n);AQ.isSelected=!AL[AR].isNot;AQ.isBranchSelected=!AL[AP].isNot;},this);},updateItemSelection:function N(AJ){var AR=this.selectionList,AK=B.call(this),AS=w.call(this),AN=A.call(this),AO=j.call(this),AL=AJ?[AJ]:this.getRootItems(),AM=AJ?[]:this.getItems().filter(function(AT){return AT&&o(AT);}),AI=AJ?W.call(this,AJ):n,AQ=AJ?q.call(this,AJ,true):{};(AL.concat(AM)).forEach(function AP(AX){var AV=AI,AU=U.copy(AQ);AI=Math.max(AI,AS[AX.v]||n);U.forEach(AO[AX.v],function(Aa,AZ){AQ[AZ]=Math.max(Aa,AQ[AZ]||n);});var AY=Math.max(AK[AX.v]||n,AN[AX.lv]||n,AI,AQ[AX.lv]||n);AX.isSelected=!AR[AY].isNot;AX.isBranchSelected=!AR[AI].isNot;k.forEach(AX.children,function(AZ){AP.call(this,AZ);},this);var AW=l(AX);if(AW.length>0){var AT=k.find(AW,"isSelected",true)>=0;if(AX.isSelected!==AT){this.addSelection({func:c.ELEMENT,itemValue:AX.v,isNot:!AT});AX.isSelected=AT;}}AI=AV;AQ=AU;},this);},updateDescendantsStatus:function AH(){var AN=this.selectionList,AI=this.getMaxLevel(),AL=w.call(this),AJ=j.call(this),AK=n,AO=A.call(this);this.getRootItems().forEach(function AM(AY){var AQ=AY.children||[],AU=AY.displayChildren||[],AW=AK,AX=U.copy(AO),AR=false;AK=Math.max(AK,AL[AY.v]||n);U.forEach(AJ[AY.v],function(Aa,AZ){AO[AZ]=Math.max(Aa,AO[AZ]||n);});AQ.forEach(function(AZ){if(AM(AZ)||!AZ.hid&&AZ.isSelected){AR=true;}});if(AY.hcd&&AU.length===0){var AS=!AN[AK].isNot,AV,AP;for(var AT=AY.lv+1;AT<=AI;AT++){AV=AO[AT]||n;AP=AV>AK&&!AN[AV].isNot;if(AP||AS&&AV<=AK){AR=true;break;}}}AY.hasDsctSelected=AR;AK=AW;AO=AX;return AR;});},getMaxLevel:function b(){var AI=0;this.getItems().forEach(function(AJ){var AK=AJ.lv;if(AK>AI&&!AJ.hid){AI=AK;}});this.selectionList.forEach(function(AJ){if(AJ.func===c.LEVEL||AJ.func===c.BRANCH_LEVEL){AI=Math.max(AI,AJ.level);}});return AI;},getLevelSelection:function G(AI){var AM=this.selectionList,AK=AI?q.call(this,AI):A.call(this),AJ=AI?AI.isBranchSelected:this.getAllSelection(),AL={};U.forEach(AK,function(AP,AO){var AN=!AM[AP].isNot;if(AN!==AJ){AL[AO]=AN;}});return U.copy({allLevel:AJ,isLevelSelected:function(AN){return this[AN]||this.allLevel&&this[AN]!==false;}},AL);},buildSelectionExprJSON:function e(AK){var AM=this.getAllSelection(),AJ=[],AN=null,AL={selected:[],unselected:[]},AI=function(AO,AP){if(!U.isEmpty(AP)&&(AO.length>0||AM===AD(AP))){AO.push(AP);}};this.selectionList.forEach(function(AP){var AR=AP.func,AO=AP.isNot,AT=AP.level,AS=AP.itemValue,AQ=AS?this.getItemByValue(AS):null;if((AQ||{}).fetcher){return ;}if(AP.func===c.ELEMENT&&!o(AQ)){AL[AO?"unselected":"selected"].push(AQ);}else{if(AP.func!==c.ALL){AI(AJ,D(AK,AR,AQ,AT,AO));}}},this);AI(AJ,D(AK,c.ELEMENT,AL.selected));AI(AJ,D(AK,c.ELEMENT,AL.unselected,null,true));if(AJ.length>0){AN=AJ[0];AJ.forEach(function(AR,AO,AQ){var AP=AD(AR);if(AO>0){if(AP===AD(AQ[AO-1])&&AN.nds){AN.nds.push(AR);}else{AN={et:Z.ANDOR,fn:AP?E.AND:E.OR,nds:[AN,AR]};}}});}if(AN){if(AN.et===Z.ANDOR){AN.node=C.CONDITION;}else{AN={et:Z.ANDOR,fn:E.AND,nds:[AN],node:C.CONDITION};}}return AN;},setSelectionByExprJSON:function r(AK){var AL=this.clearSelections(),AJ=false,AI=this.getItems(),AN=f.getIdPresentation(AI[0]&&AI[0].v),AM=function(AP,AQ){if(U.isEmpty(AP)){return ;}if(AP.et===Z.ANDOR){(AP.nds||[]).forEach(function(AR){AM.call(this,AR,AQ);},this);}else{var AO=AD(AP);if(!AJ){AJ=true;this.setAllSelection(AO);}if(AP.et===Z.AQ&&AP.fm&&AP.fm.n===Y){(AP.cs||[]).forEach(function(AS){var AR=t(AS.v);if(AR>=0){AQ.push({func:c.LEVEL,level:AR,isNot:AO});}});}if(AP.et===Z.AE){(AP.es||[]).forEach(function(AR){var AS=z(AR.v,AN,AP.a),AT=t(AP.cs&&AP.cs[0].v);if(!this.getItemByValue(AS)){this.addItems([U.copy({v:AS,dhid:true},U.clone(AR))],true);}if(AP.fn===E.DESCENDANT){if(AT>=0){AQ.push({func:c.BRANCH_LEVEL,itemValue:AS,level:AT,isNot:AO});}else{AQ.push({func:c.BRANCH,itemValue:AS,isNot:AO});}}else{AQ.push({func:c.ELEMENT,itemValue:AS,isNot:AO});}},this);}}};AM.call(this,AK,AL);this.updateItemSelection();},setSelectionByList:function L(AJ,AI){var AK=[],AL=false;k.forEach(AJ,function(AM){var AN=AM.v;if(AN===AG){AL=true;return false;}if(!this.getItemByValue(AN)){this.addItems([AM],true);}AK.push({func:c.ELEMENT,itemValue:AN,isNot:!AI});},this);this.clearSelections();if(!AL){this.setAllSelection(!AI);this.selectionList=this.selectionList.concat(AK);}this.updateItemSelection();},onSelectionChange:function O(AJ,AI,AK,AL){if(AJ===c.ALL){this.clearSelections();this.setAllSelection(AI);}else{this.addSelection({func:AJ,itemValue:AK&&AK.v,level:AL,isNot:!AI});}if(this.postSelectionChange){this.postSelectionChange();}},postAddItems:function H(AI){this.updateItemSelection();},postAddSiblingItems:function AC(AJ,AI){this.updateSiblingItemSelection(AJ);},postAddBranchItems:function AB(AJ,AI){this.updateItemSelection(AI);}});}());(function(){mstrmojo.requiresCls("mstrmojo.locales","mstrmojo.expr","mstrmojo.date","mstrmojo.num","mstrmojo.string");mstrmojo.validation={STATUSCODE:{UNKNOWN:-1,VALID:0,INVALID:1,INVALID_EMPTY:2,INVALID_CHAR:3,INVALID_OUTOFRANGE:4,INVALID_REGEX:5,INVALID_VALIDATOR:6,INVALID_BAD_NUMERICFORMAT:7,INVALID_BAD_DATESTRING:8},TRIGGER:{NONE:0,ONBLUR:1,ONKEYUP:2,VALUESET:4,ALL:7},REGEXP:{US_ZIP:/^\d{5}([\- ]?\d{4})?$/,EMAIL_ADDRESS:/^([a-zA-Z0-9_\.\-])+@(([a-zA-Z0-9\-])+[\.])+([a-zA-Z0-9]{2,4})+$/,SOCIAL_SECURITY_NUMBER:/^((?!000)(?!666)\d{3})(\s|\-)?((?!00)\d{2})\2((?!0000)\d{4})$/,PHONE_NUMBER:/^(?!-)[ \d\-\(\)\.\+]+$/,FILE_NAME:new RegExp('^[^:*?"<>|/\\\\()]+$'),FOLDER_PATH_WIN:new RegExp('^([a-zA-Z]:|\\\\\\\\[^:*?"<>|/\\\\]+|[^:*?"<>|/\\\\]*)(\\\\[^:*?"<>|/\\\\]+)*(\\\\){0,1}$'),FOLDER_PATH_UNIX:new RegExp('^(/){0,1}([^:*?"<>|/\\\\]+/)*([^:*?"<>|/\\\\]+){0,1}$'),PRINTER_PATH_SINGLE:new RegExp('^[^$%:*?"<>|/\\\\]*$'),PRINTER_PATH_MULTIPLE:new RegExp('^((/|\\\\\\\\)[^$%:*?"<>|/\\\\]+)((/|\\\\)[^$%:*?"<>|/\\\\]+)*(/|\\\\){0,1}$')}};var H=mstrmojo.validation,B=H.TRIGGER,c=H.STATUSCODE,A={"-1":-1,1:1,2:1,3:2,4:2,5:2,6:2,7:2,8:3,9:3,10:3,11:4,12:4,13:4,14:6,15:6,16:6,17:3,18:3,21:2,22:2,23:3,24:4,25:3,30:5,34:5};H.VALIDATOR={DEMO:function N(f){var e=parseInt(f,10),g=mstrmojo.validation.STATUSCODE;if(e===0||e===1||e>10){return{code:g.VALID};}return{code:g.INVALID,msg:"This field must be either 0, 1 or greater than 10"};},VALIDATE_PHONENO:function I(e){var f=String(e).replace(/[^\d]/g,"");if(f.length<10){return{code:c.INVALID,msg:mstrmojo.desc(9203,"A telephone number must contain at least 10 digits.")};}if(!H.REGEXP.PHONE_NUMBER.test(e)){return{code:c.INVALID,msg:mstrmojo.desc(9204,"The telephone number contains invalid characters.")};}return{code:c.VALID};},VALIDATE_ZIPCODE:function G(e){var g="",f=this.dtp;if(!H.REGEXP.US_ZIP.test(e)){if(H.isNumeric(f)||H.isInt(f)){g=mstrmojo.desc(9208,"A zip code must be 5 digits or 5+4 digits.");}else{if(H.isString(f)){g=mstrmojo.desc(9206,"The zip code is invalid");}}return{code:c.INVALID,msg:g};}return{code:c.VALID};},VALIDATE_EMAIL:function U(e){var f=e.indexOf("@");if(f===-1){return{code:c.INVALID,msg:mstrmojo.desc(9197,"The email address is missing an at sign (@).")};}if(e.substring(f).indexOf(".")===-1){return{code:c.INVALID,msg:mstrmojo.desc(9198,"The email address is missing a period on the domain.")};}return H.REGEXP.EMAIL_ADDRESS.test(e)?{code:c.VALID}:{code:c.INVALID,msg:mstrmojo.desc(9207,"The email address is invalid.")};},VALIDATE_SSN:function Q(e){var g=this.dtp,f;if(H.isNumeric(g)||H.isInt(g)){f=String(e).replace(/[^\d]/g,"");if(f.length!==9){return{code:c.INVALID,msg:mstrmojo.desc(9209,"A Social Security Number must be 9 digits.")};}}if(!H.REGEXP.SOCIAL_SECURITY_NUMBER.test(e)){return{code:c.INVALID,msg:mstrmojo.desc(9210,"The Social Security Number is invalid.")};}return{code:c.VALID};}};H.isInt=function D(e){return A[e]===1;};H.isNumeric=function Z(e){return A[e]===2||A[e]===5;};H.isString=function J(e){return A[e]===3;};var C=window.mstrConfig,L=C.listSep,S=mstrmojo.expr,M=S.DTP,a=mstrmojo.num,V=mstrmojo.string,F=mstrmojo.date;function P(m,n){var j=m.dtp,l=m.constraints,p=l.allowedFormatChars||"",h=(A[j]===1),e=H.isNumeric(j),f=(A[j]===6),o=mstrmojo.locales.number.THOUSANDSEPARATOR,g=mstrmojo.locales.number.DECIMALSEPARATOR,k;if(h){if(!m._intRegExp){p+="0-9-"+(m.isList?L:"")+o;m._intRegExp=new RegExp("[^"+p+"]");}k=m._intRegExp;}if(e){if(!m._numericRegExp){p+="0-9-#"+(m.isList?L:"")+g+o;m._numericRegExp=new RegExp("[^"+p+"]");}k=m._numericRegExp;}return !!k&&k.test(n);}function d(m,o){var j=m.dtp,l=m.constraints,h=(A[j]===1),e=H.isNumeric(j),f=(A[j]===6),g=l.min,n=l.max,k;if(g===undefined&&n===undefined){return false;}if(h||e){if(a.isBigDecimal(o)){return a.inNumericRange(a.parseBigDecimal(o),g,n)!==0;}return a.inNumericRange(o,g,n)!==0;}if(f){return F.inDateTimeRange(o,g,n)!==0;}return false;}function K(f,e){return !a.isNumeric(e)&&!a.isBigDecimal(e);}function R(h,f){var g=(h.dtp===M.DATE),e=(h.dtp===M.TIME);return(g?!F.isDate(f):(e?!F.isTime(f):!F.isDateAndOrTime(f)));}mstrmojo._CanValidate=mstrmojo.provide("mstrmojo._CanValidate",{constraints:null,required:false,dtp:M.INTEGER,isList:false,autoFormat:false,validationStatus:null,init:function X(e){this._super(e);if(!this.constraints){this.constraints={};}var f=this.constraints;if(!f.hasOwnProperty("trigger")){f.trigger=B.NONE;}},_set_value:function(k,g){var h=this.value,f=(h!==g);if(f){this.value=g;var j=this.constraints.trigger,e=(j&B.VALUESET)>0;if(e){this.validate(g);}}return f;},validate:function O(){var g=(this.value!==null&&this.value!==undefined)?this.value:"",k=this.isList?g.split(L):[g],j,f,l,e=k.length,h;for(h=0;h<e;h++){j=this.doValidation(k[h]);f=(j.code>c.VALID);if(f){if(e>1){j.msg=mstrmojo.locales.validation.invalidValueInListError.replace("#",k[h]||" ");}break;}}l=f?"onInvalid":"onValid";if(!f&&this.autoFormat){this.format();}this.set("validationStatus",j);if(this[l]){this[l](j);}},format:function Y(){var k=this.dtp,g=(A[k]===6);if(!g){return ;}var m=mstrConfig.listSep,p=this.value||"",f=this.isList?p.split(m):[p],o=k===14,n=[],e,h=mstrmojo.locales.datetime,l=f.length,j;for(j=0;j<l;j++){p=f[j];e=F.parseDateAndOrTime(p);if(e){if(o&&e.date){n.push(F.formatDateInfo(e.date,h.DATEOUTPUTFORMAT));}else{n.push((e.date?F.formatDateInfo(e.date,h.DATEOUTPUTFORMAT):"")+" "+(e.time?F.formatTimeInfo(e.time,h.TIMEOUTPUTFORMAT):""));}}}this.set("value",n.join(m));},isValid:function W(){var e=this.validationStatus;if(!e){this.validate();}return this.validationStatus.code===c.VALID;},clearValidation:function b(){this.set("validationStatus",{code:c.VALID});if(this.onClearValidation){this.onClearValidation();}},doValidation:function E(t){var o=this.constraints,p=o.regExp,g=o.validator,e={id:this.id,code:c.VALID,msg:""},n=this.dtp,m=(A[n]===1),f=H.isNumeric(n),h=(A[n]===3),j=(A[n]===6),l=V.isEmpty(t),q=String(t).length,k="",w=mstrmojo.locales.validation;if(this.required&&l){e.code=c.INVALID_EMPTY;e.msg=w.requiredFieldError;return e;}t=V.trim(t);if(!l&&P(this,t)){if(m){k=w.integerDataType;}if(f){k=w.numericDataType;}if(j){k=w.dateDataType;}e.code=c.INVALID_CHAR;e.msg=w.invalidCharError.replace("#",k);return e;}if(!l&&j&&R(this,t)){e.code=c.INVALID_BAD_DATESTRING;e.msg=w.invalidDateStringError;return e;}if(!l&&(f||m)&&K(this,t)){e.code=c.INVALID_BAD_NUMERICFORMAT;e.msg=w.invalidNumericFormatError;return e;}if(!l&&(m||f||j)&&d(this,t)){e.code=c.INVALID_OUTOFRANGE;if(o.min!==null&&o.max!==null){k=w.outofRangeError.replace("# ","").replace("##",a.toLocaleString(o.min)).replace("###",a.toLocaleString(o.max));}else{if(o.min!==null){k=w.noLessMinError.replace("##",a.toLocaleString(o.min)).replace("# ","");}else{if(o.max!==null){k=w.noGreaterMaxError.replace("###",a.toLocaleString(o.max)).replace("# ","");}}}e.msg=k;return e;}if(h&&o.minLen!==null&&o.maxLen!==null){if(q<o.minLen||q>o.maxLen){e.code=c.INVALID;e.msg=mstrmojo.desc(9211).replace(/#/,o.minLen).replace(/##/,o.maxLen);return e;}}if(p&&!p.test(t)){e.code=c.INVALID_REGEX;e.msg=mstrmojo.desc(9205);return e;}var u=g&&g.apply(this,[t]);if(u){e.code=u.code;e.msg=u.msg;return e;}return e;}});}());(function(){mstrmojo.requiresCls("mstrmojo.string","mstrmojo.expr","mstrmojo.array","mstrmojo.hash");mstrmojo.requiresDescs(308,5923,7930,5282,5283,2793,2787,2788,12298);var D=mstrmojo.string,S=mstrmojo.expr,M=S.ET,L=mstrmojo.array,R=mstrmojo.hash;var V=S.FN,K=S.BRANCH_FNS[V.NOT],Z=mstrmojo.mstr.EnumDSSXMLObjectTypes,H=mstrmojo.mstr.EnumDSSXMLObjectSubTypes,N=mstrmojo.mstr.EnumDSSConsolidationType;function C(a){return D.htmlAngles(a)||"";}var A={betweenText:mstrmojo.desc(308,"and"),atText:mstrmojo.desc(5923,"at"),emptyText:mstrmojo.desc(7930,"Empty condition"),andText:mstrmojo.desc(5282,"AND"),orText:mstrmojo.desc(5283,"OR"),boldandText:"<span style='font-weight:bold;'>"+mstrmojo.desc(5282,"AND")+"</span>",boldorText:"<span style='font-weight:bold;'>"+mstrmojo.desc(5283,"OR")+"</span>",whereText:mstrmojo.desc(2793,"Where (##)"),notText:mstrmojo.desc(12298,"NOT")};var Y={"*":function(b,a){return{html:b?('<span class="mstrmojo-unknown">'+(C(b.n||b.xml)||"...")+"</span>"):null,text:b?(C(b.n||b.xml)||"..."):null};}};function W(a){return !!a.not||a.fn===V.NOT_EQUAL||a.fn===V.NOT_IN_LIST||a.fn===V.NOT_BETWEEN||a.fn===V.NOT;}function I(a){if(a&&a.not){return{html:'<span class="mstrmojo-text mstrmojo-not">'+K+"</span>",text:K+" "};}return{html:"",text:""};}function U(c,b){var a=c&&((b?'<span class="mstrmojo-ListIcon t'+b+'"></span>':"")+'<span class="mstrmojo-text mstrmojo-embedobj">'+C(c)+"</span>");return{html:a,text:c&&((b?b+" ":"")+C(c))};}function Q(a,c){var b=c&&c.trim().split(" ")||[];if(a.t===Z.Attribute&&a.st===H.AttributeRecursive){b.push("recursive");}else{if(a.t===Z.Consolidation&&a.st===H.ConsolidationManaged){b.push("derived");if(a.ndetype===N.DssRecursiveDerivedElement){b.push("recursive");}}}return b.join(" ");}function G(b,a){var c=C(b.n);return{html:'<span class="mstrmojo-text mstrmojo-attr '+Q(b,a)+'">'+c+"</span>",text:c};}Y[M.R]=function(b,a){return U(b.r&&b.r.n,b.r&&b.r.t);};Y[M.F]=function(b,a){return U(b.f&&b.f.n,b.f&&b.f.t);};Y[M.XML]=function(b,a){return U(b.n||b.p&&b.p.n||b.xml,b.p&&b.p.t);};Y[M.AE]=function(q,f){var n=[],m=[],c=(f&&f.elemsEmpty)||"("+mstrmojo.desc(2210,"Empty")+")";if(q&&q.a&&q.a.n){var b=G(q.a);n.push(b.html);m.push("{"+b.text+"}");var a=C(S.fnName(q.et,q.fn,q.fnt));n.push('<span class="mstrmojo-text mstrmojo-fn">'+a+"</span>");m.push(" "+a+" ");var r=q.es,g=r&&r.length||0;if(g){n.push('<span class="mstrmojo-elems">');m.push("[");var j=n.length,p="";for(var o=0;o<g;o++){n[j++]='<span class="mstrmojo-text mstrmojo-elem">';p=C(r[o].n);n[j++]=p;m.push(p);if(o<g-1){n[j++]=", ";m.push(", ");}n[j++]="</span>";}n[j++]="</span>";m.push("]");}else{n.push('<span class="mstrmojo-text mstrmojo-emptyelems">'+c+"</span>");m.push(c);}}return{html:n.join(""),text:m.join("")};};Y[M.AQ]=function(x,AA){var u=[],j=[];if(x&&x.a&&x.a.n){var e=G(x.a);u.push(e.html);j.push("{"+e.text+"}");if(x.fm&&x.fm.n){var AB=C(x.fm.n);u.push('<span class="mstrmojo-text mstrmojo-form">'+AB+"</span>");j.push("("+AB+")");if(x.fn!=null){var k=C(S.fnName(x.et,x.fn,x.fnt,x.fm.dtp));u.push('<span class="mstrmojo-text mstrmojo-fn">'+k+"</span>");j.push(" "+k+" ");var l=S.fnCstCount(x.fn,x.fnt);if(x.et===M.AC){if(l>=1){if(x.a2&&x.a2.n){var p=C(x.a2.n);u.push('<span class="mstrmojo-text mstrmojo-attr2">'+p+"</span>");j.push("{"+p+"}");if(x.fm2&&x.fm2.n){var w=C(x.fm2.n);u.push('<span class="mstrmojo-text mstrmojo-form2">'+w+"</span>");j.push("("+w+")");}}if(l>1){u.push('<span class="mstrmojo-text mstrmojo-btwn">'+A.betweenText+"</span>");j.push(" "+A.betweenText+" ");if(x.a3&&x.a3.n){var b=C(x.a3.n);u.push('<span class="mstrmojo-text mstrmojo-attr3">'+b+"</span>");j.push("{"+b+"}");if(x.fm3&&x.fm3.n){var c=C(x.fm3.n);u.push('<span class="mstrmojo-text mstrmojo-form3">'+c+"</span>");j.push("("+c+")");}}}}}else{if(x.et===M.AL){var a=x.cs||[],f=[];for(var q=0,r=a.length;q<r;q++){f.push(a[q].v);}var n=f.join(mstrConfig.listSep);u.push('<span class="mstrmojo-text mstrmojo-c1">'+n+"</span>");j.push("["+n+"]");}else{if(l>=1){var a=x.cs,o=a&&a[0];var z=C(o&&o.p&&o.p.n||o&&o.v);u.push('<span class="mstrmojo-text mstrmojo-c1">'+z+"</span>");j.push(z);if(l>1){var m=a&&a[1];u.push('<span class="mstrmojo-text mstrmojo-btwn">'+A.betweenText+"</span>");j.push(" "+A.betweenText+" ");var g=C(m&&m.p&&m.p.n||m&&m.v);u.push('<span class="mstrmojo-text mstrmojo-c1">'+g+"</span>");j.push(g);}}}}}}}return{html:u.join(""),text:j.join("")};};Y[M.AC]=Y[M.AQ];Y[M.AL]=Y[M.AQ];Y[M.MQ]=function(AA,AB){var z=[],n=[],r=AA&&AA.m,AD=r&&r.n;if(AD){var b=AA.fnt,g=S.FNT.PER,x=S.FNT.RANK;AD=b===g?mstrmojo.desc(2787,"Percentage of ##").replace("##",AD):b===x?mstrmojo.desc(2788,"Rank of ##").replace("##",AD):AD;z.push('<span class="mstrmojo-text mstrmojo-metric">'+C(AD)+"</span>");n.push(C(AD));if(AA.fn!=null){var o=C(S.fnName(AA.et,AA.fn,b,S.DTP.REAL));z.push('<span class="mstrmojo-text mstrmojo-fn">'+o+"</span>");n.push(" "+o+" ");var p=S.fnCstCount(AA.fn,b);if(AA.et==S.ET.MC){if(p>=1){var AC=(AA.m2&&AA.m2.n)||(AA.c2&&AA.c2.v)||"?";z.push('<span class="mstrmojo-text mstrmojo-m2">'+C(AC)+"</span>");n.push(C(AC));if(p>1){z.push('<span class="mstrmojo-text mstrmojo-btwn">'+A.betweenText+"</span>");n.push(" "+A.betweenText+" ");var e=(AA.m3&&AA.m3.n)||(AA.c3&&AA.c3.v)||"?";z.push('<span class="mstrmojo-text mstrmojo-m3">'+C(e)+"</span>");n.push(C(e));}}}else{if(p>=1){var c=AA.cs,t=c&&c[0];var a=function(h){var d=h.v;if(AA.fnt==g){if(d.replace){h.v=d.replace(/%$/,"");}d=h.v+"%";}return d;};var l=C(t&&t.p&&t.p.n||t&&t.v&&a(t));z.push('<span class="mstrmojo-text mstrmojo-c1">'+l+"</span>");n.push(l);if(p>1){var q=c&&c[1],m=C(q&&q.p&&q.p.n||q&&q.v&&a(q));z.push('<span class="mstrmojo-text mstrmojo-btwn">'+A.betweenText+"</span>");n.push(" "+A.betweenText+" ");z.push('<span class="mstrmojo-text mstrmojo-c2">'+m+"</span>");n.push(m);}}}var w=AA.dmy&&AA.dmy.uts,k=w&&w.length;if(k){z.push('<span class="mstrmojo-text mstrmojo-at">'+A.atText+"</span>");n.push(" "+A.atText+" ");z.push('<span class="mstrmojo-dmy">');for(var j=0;j<k;j++){var f=w[j];z.push('<span class="mstrmojo-text mstrmojo-dmyunit">');z.push(C(f.utgt?f.utgt.n:f.n));n.push(C(f.utgt?f.utgt.n:f.n));if(j<k-1){z.push(",");n.push(",");}z.push("</span>");}z.push("</span>");}}}return{html:z.join(""),text:n.join("")};};Y[M.MC]=Y[M.MQ];Y[M.ANDOR]=function(l,c){var j=[],g=[],b=(c&&c.elemsEmpty)||"("+mstrmojo.desc(2210,"Empty")+")",e=R.valarray(S.findTargets(l,"did"))[0],f=true;function m(d){if(!f){j.push('<span class="spliter"></span>');g.push(", ");}f=false;if(d){g.push(mstrmojo.desc(12298,"NOT")+" ");}}if(!e){return{html:'<span class="mstrmojo-text mstrmojo-emptyelems">'+b+"</span>",text:b};}var a=G(e,"andor");j.push(a.html);g.push("{"+a.text+"}");j.push("<span>:</span>");g.push(" : ");j.push('<span class="mstrmojo-elems">');g.push("[");L.forEach(l.nds,function k(n){if(!n){return ;}var d=W(n),u=n.fm,q=n.cs,o,r,h,p;switch(n.et){case M.ANDOR:L.forEach(n.nds,k);break;case M.AE:switch(n.fn){case V.IN_LIST:case V.NOT_IN_LIST:L.forEach(n.es,function(w){m(d);o=d?" not":"";r=C(w.n);j.push('<span class="mstrmojo-text mstrmojo-elem single'+o+'">'+r+"</span>");g.push(r);});break;case V.DESCENDANT:var t=(n.es||[]).slice();if(t.length===0){t.push({n:b});}L.forEach(t,function(x){m(d);o=d?" not":"";r=C(x.n);if(q&&q[0]){var w;p=q[0].v;if(isNaN(p)){h=p.substr(p.indexOf(";")+1);}else{h=mstrmojo.desc(493,"Level")+" "+(parseInt(p,10)+1);}w=h+" "+mstrmojo.desc(12853,"of")+" "+r;j.push('<span class="mstrmojo-text mstrmojo-elem level'+o+'">');j.push(w);g.push(w);}else{j.push('<span class="mstrmojo-text mstrmojo-elem descendant'+o+'">');j.push(C(x.n));g.push(r);}j.push("</span>");});break;}break;case M.AQ:L.forEach(n.cs,function(w){m(d);o=d?" not":"";p=w.v;h=(u&&u.n)?C(u.n+" "+p):"";if(u&&u.n==="LEVEL_NUMBER"){o+=" level";if(isNaN(p)){h=p.substr(p.indexOf(";")+1);}else{h=mstrmojo.desc(493,"Level")+" "+(parseInt(p,10)+1);}}j.push('<span class="mstrmojo-text mstrmojo-elem constant'+o+'">'+h+"</span>");g.push(h);});break;}});j.push("</span>");g.push("]");return{html:j.join(""),text:g.join("")};};function O(f,e){var c=Y[f&&f.et]||Y["*"],b=I(f),d=c&&c(f,e),a=e&&e.emptyText||A.emptyText;return{html:b&&b.html+((d&&d.html)||('<span class="mstrmojo-text empty-cond">'+a+"</span>")),text:b&&b.text+((d&&d.text)||a)};}function F(a){return O(a).text;}function J(e,d,b){if(!e){return null;}var o=e.et,l=e.fn,a=e.nds;if(o===M.ANDOR){var p=b?"bold":"";splitter=l===V.AND?A[p+"andText"]:(l===V.OR?A[p+"orText"]:"");a=[].concat(a);if(a.length<1){return null;}var k=[],q;L.forEach(a,function(r){q=J(r,false,b);if(q){k.push(q);}});var n,m=k.length;if(m<1){return null;}else{if(m===1){n=k[0];}else{n=k.join(" "+splitter+" ");}}n=d||e.not?n:"("+n+")";return e.not?A.notText+" "+n:n;}else{if(o===M.RLS){var j=e.dmy&&e.dmy.uts||[],g=[],f;L.forEach(j,function(r){g.push("{"+r.n+"}");});f=g.join(", ");var c=e.nds&&e.nds[0],h=J(c,false,b);if(h){return"("+f+" "+A.whereText.replace(/\(##\)/g,"").replace(/'##'/g,"")+h+")";}return null;}else{return F(e);}}}function B(a){if(mstrmojo.fe.FilterUtils.isExprEmpty(a)){return{et:14,fn:19};}else{((a&&a.nds)||[]).forEach(function(c,b){a.nds[b]=B(c);});return a;}}mstrmojo.fe.FilterUtils=mstrmojo.provide("mstrmojo.fe.FilterUtils",{getExprXml:function(g){var b="<exp>",a="</exp>",e={a:true,a2:true,a3:true,agg:true,cc:true,ce:true,cgp:true,cs:true,conid:true,desc:true,did:true,attId:true,dmt:true,dmy:true,dtp:true,es:true,et:true,expr:true,f:true,flat:true,flt:true,fm:true,fm2:true,fm3:true,fn:true,fnt:true,fres:true,gb:true,isp:true,items:true,m:true,m2:true,m3:true,n:true,nds:true,not:true,pf:true,p:true,r:true,rps:true,st:true,t:true,utgt:true,utp:true,uts:true,v:true,xml:true,relation:true,applySubExpr:true,useSchema:true,guide:true,rsTp:true,joTp:true,paTp:true,erTp:true,exp:true,joAttrs:true,ph:true,idx:true,idc:true,idcsi:true,ucfg:true,node:true},d={getArrItemName:function(h){return h.substr(0,h.length-1);},isSerializable:function(t,q,p){if(t==="xml"){var k=q[p].xml;return{att:'hasXML = "-1"',child:k};}else{if(mstrmojo.array.indexOf(["header_format","grid_format","child_header_format","child_grid_format"],t)>-1){var u=q[p][t];if(!u){return{};}var m="<"+t+">";for(var r in u){m+="<prs n='"+r+"'>";var l=u[r];for(var h in l){var o=l[h];m+="<pr n='"+h+"' v='"+(o==="pru"?"":o)+"'";m+=o==="pru"?' pru="1"':"";m+="/>";}m+="</prs>";}m+="</"+t+">";return{child:m};}else{if(t==="cs"){var j=q[p],n=q[p][t];if(j&&j.fnt&&j.fnt==S.FNT.PER&&n){if(n[0]){n[0].v+="%";}if(n[1]){n[1].v+="%";}}return true;}else{if(t==="c2"||t==="c3"){var j=q[p];if(j&&j.et==S.ET.MC&&(j.fn==S.FN.BETWEEN||j.fn==S.FN.NOT_BETWEEN)){return true;}else{return false;}}}}}return(e[t])?true:false;},skipNull:true},c=B(g);if(!c||c.et!=M.ANDOR||c.fn===V.NOT||c.not){c={et:M.ANDOR,fn:S.FN.AND,nds:c?[c]:[]};}var f=D.json2xml("nd",[{},c],d);return b+f+a;},isExprEmpty:function(a){return(!a||(a.et===M.ANDOR&&(a.nds||[]).length<1));},getExprConditionNodeHtml:function E(a){return O(a).html;},getExprConditionNodeText:function F(a){return O(a).text;},getExprNodeHtmlAndText:function P(b,a){return O(b,a);},getExprText:function X(b,a){return J(b,true,a);}});}());(function(){mstrmojo.requiresCls("mstrmojo.array","mstrmojo.expr","mstrmojo.css");var G=mstrmojo.array,F=mstrmojo.expr,H=mstrmojo.css;mstrmojo._IsExprNode=mstrmojo.provide("mstrmojo._IsExprNode",{ind:function B(){var L=this.parent;if(L&&L.indent){var K=this.childIndex();K=(K>-1&&(K>0))?[K,K-1]:null;if(K){L.indent(K);}}},out:function D(){var L=this.parent;if(L&&L.outdent){var K=this.childIndex();K=(K>-1&&(K>0))?[K,K-1]:null;if(K){L.outdent(K);}}},andOrTxt:function A(){var M=this.parent,K=M&&M.data,L="",N=this.data;if(K&&(K.et===F.ET.ANDOR)&&K.fn){L=K.fn+(N&&N.not?"_"+F.FN.NOT:"");L=F.BRANCH_FNS[L];}return'<span class="mstrmojo-text mstrmojo-andor">'+L+"</span>";},getPrefixAndOrToolsMarkup:function(){return('<span class="mstrmojo-indent" onclick="mstrmojo.all[\'{@id}\'].ind()" mstrAttach:mouseover,mouseout>'+mstrmojo.desc(5895,"Group conditions")+'</span><span class="mstrmojo-outdent" onclick="mstrmojo.all[\'{@id}\'].out()" mstrAttach:mouseover,mouseout>'+mstrmojo.desc(5896,"Ungroup Conditions")+"</span>");},premousedown:function J(K){var L=mstrmojo.dom.eventTarget(K.hWin,K.e);if(this.prefixHoverNode&&mstrmojo.dom.contains(this.prefixHoverNode,L,false)){mstrmojo.dom.stopPropogation(K.hWin,K.e);return ;}if(this._super){this._super(K);}},isSelectableArea:function E(K){return true;},childIndex:function I(){var M=this.parent,K=M&&M.data,L=K&&K.nds,N=this.data;if(L&&N){return G.indexOf(L,N);}return -1;},toggleGroupBorder:function C(K){H.toggleClass(this.parent.itemsContainerNode.childNodes[this.childIndex()-1].firstChild,"upgroup",K);H.toggleClass(this.domNode,"downgroup",K);}});}());(function(){mstrmojo.requiresCls("mstrmojo.Base","mstrmojo.registry","mstrmojo._Provider","mstrmojo.array");var B=mstrmojo.registry,F=mstrmojo.array;mstrmojo.Obj=mstrmojo.declare(mstrmojo.Base,[mstrmojo._Provider],{scriptClass:"mstrmojo.Obj",id:"",init:function I(J){this.disposables=[];this._super(J);B.add(this);if(this.postCreate){this.postCreate();}},addDisposable:function G(M){var K=this.disposables,L,J;if(M.constructor===Array){for(L=0,J=M.length;L<J;L++){K.push(M[L]);}}else{K.push(M);}return M;},destroyDisposables:function D(J){F.forEach(this.disposables,function(K){if(K.destroy){K.destroy(J);}else{if(K.clear){K.clear();}}});this.disposables=[];},throwAbstractMethodError:function A(J){throw new Error(this.scriptClass+" must implement "+J+".");},destroy:function H(J){if(this.destroyed){return ;}this._super(J);this.destroyDisposables(J);B.remove(this);delete this.parent;this.destroyed=true;}});var C=mstrmojo.Obj;C.free=function E(J){if(J instanceof C){J.destroy();}};}());(function(){mstrmojo.requiresCls("mstrmojo.hash","mstrmojo.array","mstrmojo.registry","mstrmojo.publisher","mstrmojo._Provider");var G=mstrmojo.hash,A=mstrmojo.array,B=mstrmojo.registry,D=mstrmojo.publisher;mstrmojo.Arr=mstrmojo.declare(null,[mstrmojo._Provider],{scriptClass:"mstrmojo.Arr",postApplyProperties:null,postCreate:null,length_bindEvents:["add","remove"],init:function H(K){var J;if(K&&K.data){J=K.data;delete K.data;}else{if(K){J=K;K=null;}}if(!J||J.constructor!==Array){J=[];}G.copy(mstrmojo.Arr.prototype,J);if(K){G.copy(K,J);}if(J.postApplyProperties){J.postApplyProperties();}B.add(J);if(J.postCreate){J.postCreate();}return J;},destroy:function E(){D.clearSubscriptions(this.id);B.remove(this);},add:function I(L,J,K){var M=L&&L.length;if(M){if(J==null){J=this.length;}A.insert(this,J,L);if(!K&&(this.onadd||D.hasSubs(this.id,"add"))){this.raiseEvent({name:"add",value:L,index:J});}}},remove:function F(J,L,K){if(L==null){L=1;}if((J!=null)&&L){var M=this.splice(J,L);if(!K&&(this.onremove||D.hasSubs(this.id,"remove"))){this.raiseEvent({name:"remove",value:M,index:J});}}}});mstrmojo.Arr.makeObservable=function C(J,K){if(!J){return ;}if(!K){K={};}K.data=J;return this.prototype.init(K);};})();(function(){var D={};var B="XHRServerTransport";mstrmojo.XHRServerTransport={serverRequest:function A(I,G,F){var E=mstrmojo.all[I],H=D[G]=new mstrmojo.SimpleXHR();$MAPF(true,B,"transportRequest");if(F.params&&!F.params.sessionState&&mstrConfig&&mstrConfig.isAddSessionState&&mstrApp&&mstrApp.sessionState){F.params.sessionState=mstrApp.sessionState;}H.request(F.config.method||"POST",F.taskURL||mstrConfig.taskURL,{success:function(J){if(typeof J==="string"&&J[0]==="{"){try{J=JSON.parse(J);}catch(K){}}if(J.mstrerr){J.code=J.mstrerr.code;J.message=J.mstrerr.message;}E&&E.response(G,true,J);},failure:function(L){var M=L.status,K=L.getResponseHeader("X-MSTR-TaskErrorCode"),J;if(M===0){M=K||M;J=mstrmojo.desc(15666,"The connection to the MicroStrategy Web Server failed. Please wait a few minutes and then attempt to reload the page. If the condition persists, please contact your administrator.");}else{M=K||M||"-999";J=L.getResponseHeader("X-MSTR-TaskFailureMsg")||L.responseText||"Unexpected error, please contact your administrator";}E&&E.response(G,false,{code:M,message:J});},complete:function(){delete D[G];},textResponse:F.callback.textResponse},F.params);},cancelRequest:function C(F){var G=D[F],E=false;if(G){E=G.cancel();delete D[F];}$MAPF(false,B,"transportRequest");return E;}};}());(function(){mstrmojo.requiresCls("mstrmojo.hash","mstrmojo.QueuedXHR");var F=mstrmojo.hash;function J(K,L){return function(){if(K[L]){K[L]();}};}var B=[];function H(L){var K;switch(L.cacheLevel){case mstrmojo.AjaxCall.CACHELEVEL_LOCAL:if(L._cache==null){L._cache=[];}K=L._cache;break;default:if(B==null){B=[];}K=B;break;}return K;}function E(N){var M=H(N);var P={cache:M,idx:-1},O=N.params;if("xts" in O){delete O.xts;}for(var L=0,K=M.length;L<K;L++){var Q=M[L];if(Q&&F.equals(Q.url,N.url)&&F.equals(Q.params,O)){P.idx=L;break;}}return P;}function C(L){var K=H(L),M=F.copy(L.params);delete M.xts;K.push({url:L.url,params:M,res:F.copy(L.response)});}function D(K){var L=E(K);if(L&&L.idx>=0){K.response=L.cache[L.idx].res;return true;}return false;}mstrmojo.AjaxCall=mstrmojo.declare(mstrmojo.QueuedXHR,null,{scriptClass:"mstrmojo.AjaxCall",method:"POST",url:"",params:null,onsuccess:null,onerr:null,oncomplete:null,oncancel:null,readCache:false,writeCache:false,cacheLevel:"",_cache:null,useQueue:false,init:function I(K){this._super(K);F.copy(K,this);},send:function A(){var K=this;if(this.readCache&&D(this)){this.onsuccess();return ;}this.request(this.method,this.url,{success:function(L){K.response=L;if(K.writeCache){C(K);}if(K&&K.onsuccess){K.onsuccess();}},failure:J(K,"onerr"),complete:J(K,"oncomplete")},this.params,!this.useQueue);},cancel:function G(){this._super();if(this.oncancel){this.oncancel();}}});mstrmojo.AjaxCall.CACHELEVEL_GLOBAL="global";mstrmojo.AjaxCall.CACHELEVEL_LOCAL="local";})();(function(){mstrmojo.requiresCls("mstrmojo.dom","mstrmojo.hash","mstrmojo._HasMarkup");var J=mstrmojo.dom,D=mstrmojo._HasMarkup,P,Q=mstrmojo.global.document,K,A="touchstart",C="touchmove",I="touchend",N="contextmenu";function O(S){var R=J.findWidget(S);while(R){if(R.hasContextMenuEvent){return R;}R=R.parent;}return null;}function M(R){var U=R.src,S=O(U&&U.node);if(!S){return null;}return S;}H:function H(R){if(R&&R.touches.length===1){P.startTapHoldCheck(self,R);}}B:function B(){var R=++P.ctxt.moveCount;if(R>P.minMoves){P.stopTapHoldCheck();if(K){window.clearTimeout(K);}}}L:function L(){P.stopTapHoldCheck();if(K){window.clearTimeout(K);}}mstrmojo.taphold=mstrmojo.taphold||mstrmojo.provide("mstrmojo.taphold",{timeThreshold:750,minMoves:3,startTapHoldCheck:function G(R,S){delete this.ctxt;var U=J.captureEventInfo({hWin:R,e:S});this.ctxt={src:U,moveCount:0};J.attachEvent(Q,C,B);J.attachEvent(Q,I,L);S.name=N;K=window.setTimeout(function(){P.stopTapHoldCheck();var V=D.newDomEvent(N,window,S),W;for(W in S){if(!V[W]){V[W]=S[W];}}V.type=N;P.triggerContextMenu(V);},this.timeThreshold);},triggerContextMenu:function F(R){var S=this.ctxt,U=M(S);if(!U){return ;}if(U.raiseEvent){U.raiseEvent(R);}},stopTapHoldCheck:function E(){J.detachEvent(Q,C,B);J.detachEvent(Q,I,L);},enable:function(){if(J.isIOSTouch){J.attachEvent(Q,A,H);}},disable:function(){J.detachEvent(Q,A,H);}});P=mstrmojo.taphold;P.enable();}());(function(){mstrmojo.requiresCls("mstrmojo.hash","mstrmojo.registry","mstrmojo.ListBuilder");var H=mstrmojo.hash,E=mstrmojo.registry,G=1;mstrmojo.WidgetListBuilder=mstrmojo.provide("mstrmojo.WidgetListBuilder",mstrmojo.mixin({newContext:function F(J){var K=J.itemFunction;if(!K){var I=J.itemConfig;K=I?function(M,L,N){var O=H.clone(I);O.data=M;O.parent=N;return E.ref(O);}:null;}return{itemStatus:[],itemWidgets:[],itemFunc:K};},build:function A(K,J,N,I){var L=J.itemFunc(N,I,K);if(L){J.itemStatus[I]=G;J.itemWidgets[I]=L;if(L.set){var M=K.selectedIndices;if(M&&M[I]){L.set("selected",true);}}}return L;},onadd:function C(K,I,J){if(I){mstrmojo.array.insert(I.itemWidgets,J.index,new Array(J.value.length));}this._super(K,I,J);},onremove:function D(L,J,K){if(J){var O=J.itemWidgets.splice(K.index,K.value.length),N,I;for(N=0,I=O.length;N<I;N++){var M=O[N];if(M&&M.destroy){delete M.parent;M.destroy();}}}this._super(L,J,K);},onchange:function B(S,J,P,U){if(U){var N=P.itemWidgets,L,O,I,R;for(O=0,I=U.removed,R=I&&I.length;O<R;O++){L=N[I[O]];if(L&&L.set){L.set("selected",false);}}var M,Q,K;for(M=0,Q=U.added,K=Q&&Q.length;M<K;M++){L=N[Q[M]];if(L&&L.set){L.set("selected",true);}}}}},H.copy(mstrmojo.ListBuilder)));}());(function(){mstrmojo.requiresCls("mstrmojo.css","mstrmojo.num","mstrmojo.color","mstrmojo.hash","mstrmojo.array");var AM=mstrmojo.color,a=mstrmojo.hash,BY=mstrmojo.array,BT=mstrmojo.css,m=mstrmojo.num;var BW=1,Ay=2,A0=3,BF=4,Ag=5,Ah=6;var Bg="FormattingFont",L="FormattingAppearance",c="FormattingAlignment",An="FormattingSize",V="FormattingPatterns",I="FormattingBorder",BE="FormattingOrder",H="FormattingView",S="FormattingSelector",A2="Template Formatting",P="FormattingPadding",Aw="AnalyticalEngineProperties",A6="RWDocumentProperties",BO="FormattingPage",R="Mobile",Y="VLDB Select",AG="FormattingNumber",Ab="RWDExecution";var Av=1;var p="n",Q="h",BZ="w",AK="wm",BL="pw",b="ml",BM="mr",AC="upwalw",z="ff",Aq="fsz",BR="fw",AL="fit",BS="fun",w="fst",AB="fc",Z="alh",AA="alv",Ak="atw",AS="atd",h="textOverflow",Au="bc",E="bgs",K="btc",At="brc",Ad="bbc",x="blc",r="bts",Bb="brs",BG="bbs",Aj="bls",AY="borderColor",BC="borderStyle",k="zIndex",Aa="showTitleBar",q="title",BA="ctrlStyle",AE="ctrlOrientation",A9="ctrlOrientationBehavior",o="ctrlMultiselect",l="ctrlAutoSearchEnabled",C="ciwm",BN="cmcy",BB="sec",u="easow",AR="layoutXml",M="lockAspectRatio",As="ism",n="shw",BD="mg",Ba="lhv",e="gridVPadding",Ap="gridHPadding",Ao="ln",AQ="sar",B="hnv",Am="iw",Ai="ih",AU="tsp",Ae="visible",W="rf",Bf="jad",Ax="jdc",AN="ode",BH="fs",BK="ssc",j="sstyle",AJ="hgl",Az="nct",A8="ncp",f="ncs",BP="ndp",G="nfs",D="nnn",BV="nth",Be="gi",A4="stfurh",d="stfuch",Bc="stfuva",N="olm",BQ="gdc",Bd="gda",AZ="layoutstyle";function U(Bh){return Bh;}function AW(Bh){return parseInt(Bh,10);}var AI={name:"encode",_def:U};AI[A0]=function(Bh){return Bh?1:0;};AI[Ay]=function(Bh){if(Bh==="transparent"){return -1;}if(Bh.length===4){Bh=Bh.replace(/([0-9a-f])/ig,"$1$1");}Bh=AM.rgbStr2hex(Bh);return parseInt(Bh.substring(5)+Bh.substring(3,5)+Bh.substring(1,3),16);};AI[BF]=AW;AI[BW]=function(Bh){if(typeof Bh==="number"){return m.toLocaleString(Bh);}return U(Bh);};AI[Ah]=function(Bj){if(Bj==="none"){return 0;}var Bi=Bj.match(/([0-9]+[,\.]?[0-9]*pt)/)[0],Bh=Bj.match(/pt ([\w\W]*)/)[1];if(Bi==="2pt"){return 5;}switch(Bh){case"solid":return 1;case"dashed":return 3;case"dotted":return 4;default:throw new Error("Invalid border style value in FormatModel::encodeValue.");}};var BX={name:"decode",_def:U};BX[A0]=function(Bh){return parseInt(Bh,10)===1;};BX[Ay]=function(Bh){if(Bh===-1){return"transparent";}if(typeof Bh==="number"){return AM.decodeColor(Bh);}if(Bh.length===4){return Bh.replace(/([0-9a-f])/ig,"$1$1");}return AM.rgbStr2hex(Bh);};BX[BF]=AW;BX[Ah]=function(Bj){if(Bj===undefined||Bj===0){return"none";}var Bi="1pt",Bh="solid";if(Bj===5){Bi="2pt";}if(Bj===3){Bh="dashed";}else{if(Bj===4){Bh="dotted";}}return Bi+" "+Bh;};function BI(){return this.pn.toLowerCase();}function AT(Bh,Bj,Bk){var Bi=document.createElement("div");Bi.style[Bk||Bj]=Bh[Bj];return Bi;}function J(Bh){return function(){return AM.rgbStr2hex(Bh.apply(this,arguments));};}function Ar(){var Bh=BI.call(this);return Bh==="underline"?Bh:"line-through";}var A5={name:"extract"},X=A5._def=function(Bh,Bj,Bk){var Bi=AT(Bh,Bj||this.getFormatBlockName(),Bk);return Bi.style[this.getCssName()];};A5[Ay]=J(X);function AD(Bh){return X.call(this,Bh,this.getFormatBlockName())===BI.call(this);}function A(Bh){var Bi=X.call(this,Bh,this.getFormatBlockName(),this.getCssName());return Bi.indexOf(Ar.call(this))>-1;}function A3(Bh){var Bi=this.getFormatBlockName();return AM.rgbStr2hex(X.call(this,Bh,Bi,Bi+this.pn));}var BU={name:"resolve"},g=BU._def=function(Bh,Bk,Bj,Bl){Bj=Bj||this.getFormatBlockName();var Bi=AT(Bh,Bj);Bi.style[Bl||this.getCssName()]=Bk;return Bi.style[BT.convertCssToCamelCase(Bj)];};BU[Ay]=function(Bh,Bj,Bi,Bk){if(Bj.or!==undefined){return Bj;}return AM.rgbStr2hex(g.call(this,Bh,Bj,Bi,Bk));};function Ac(Bh,Bi){return g.call(this,Bh,Bi?BI.call(this):"normal");}function AX(Bi,Bk){var Bj=(Bi[this.getFormatBlockName()]||"").split(" "),Bh=Ar.call(this);if(Bk){if(Bj.indexOf(Bh)===-1){Bj.push(Bh);}}else{Bj=Bj.filter(function(Bl){return Bl!==Bh;});}return g.call(this,Bi,Bj.join(" "));}var Al={name:"update"},BJ=Al._def=function(Bh,Bi){Bh[this.getFormatBlockName()]=this.resolve(Bh,Bi);return Bh;};var AV={};AV[p]={ps:L,pn:"Name",pt:BW};AV[Q]={ps:An,pn:"Height",pt:BW};AV[BZ]={ps:An,pn:"Width",pt:BW};AV[AK]={ps:An,pn:"WidthMode",pt:BF};AV[BL]={ps:BO,pn:"PageWidth",pt:BW};AV[b]={ps:BO,pn:"MarginLeft",pt:BW,fn:"margin-left"};AV[BM]={ps:BO,pn:"MarginRight",pt:BW,fn:"margin-right"};AV[AC]={ps:BO,pn:"UsePageWidthAsLayoutWidth",pt:A0};AV[z]={ps:Bg,pn:"Name",pt:BW,fn:"font",cn:"fontFamily",extract:function(){return X.apply(this,arguments).replace(/['"]/g,"");},resolve:function(Bh,Bj){var Bi=AT(Bh,"font");Bi.style.fontFamily="'"+Bj+"'";return Bi.style.font;}};AV[Aq]={ps:Bg,pn:"Size",pt:BF,fn:"font",cn:"fontSize"};AV[BR]={ps:Bg,pn:"Bold",pt:A0,fn:"font",cn:"fontWeight",extract:AD,resolve:Ac};AV[AL]={ps:Bg,pn:"Italic",pt:A0,fn:"font",cn:"fontStyle",extract:AD,resolve:Ac};AV[BS]={ps:Bg,pn:"Underline",pt:A0,fn:"text-decoration",extract:A,resolve:AX};AV[w]={ps:Bg,pn:"Strikeout",pt:A0,fn:"text-decoration",extract:A,resolve:AX};AV[AB]={ps:Bg,pn:"Color",pt:Ay};AV[Z]={ps:c,pn:"Horizontal",pt:BF,fn:"text-align"};AV[Ak]={ps:c,pn:"TextWrap",pt:A0,fn:"white-space"};AV[AS]={ps:c,pn:"TextDirection",pt:BF};AV[AA]={ps:c,pn:"Vertical",pt:BF};AV[h]={ps:An,pn:"TextOverflow",pt:A0};AV[Au]={ps:V,pn:"FillColor",pt:Ay,x:Av,fn:"background-color",update:function(Bh,Bj){var Bi=Bh.fx;if(Bj.or!==undefined){if(!Bi){Bi=Bh.fx={};}var Bk=Bi.gd=Bi.gd||{};Bk.ec=Bj.c2;Bk.sc=Bj.c1;Bk.t=Bj.or;delete Bh[this.getFormatBlockName()];Bh.fx=Bi;}else{if(Bi){delete Bi.gd;}BJ.call(this,Bh,Bj);}return Bh;}};AV[E]={ps:V,pn:"FillStyle",pt:BF};AV[BK]={ps:V,pn:"SelectorSelectionColor",pt:Ay};AV[j]={ps:V,pn:"SelectorSelectionFillStyle",pt:BF};AV[K]={ps:I,pn:"TopColor",pt:Ay,fn:"border",extract:A3};AV[At]={ps:I,pn:"RightColor",pt:Ay,fn:"border",extract:A3};AV[Ad]={ps:I,pn:"BottomColor",pt:Ay,fn:"border",extract:A3};AV[x]={ps:I,pn:"LeftColor",pt:Ay,fn:"border",extract:A3};AV[AY]={ps:I,pn:["TopColor","RightColor","BottomColor","LeftColor"],pt:Ay,fn:"border",extract:A3,resolve:J(function(Bh,Bj){var Bk=this.getFormatBlockName(),Bi=g.call(this,Bh,Bj,Bk,Bk+"Color"),Bl=Bi.indexOf("rgb");if(Bl>-1){Bi=Bi.slice(0,Bl)+AM.rgbStr2hex(Bi.slice(Bl));}return Bi;})};AV[BC]={ps:I,pn:["TopStyle","RightStyle","BottomStyle","LeftStyle"],pt:Ah,fn:"border",extract:A3,resolve:function(Bh,Bk){var Bi=Bk.split(" "),Bl=this.getFormatBlockName();if(!Bh[Bl]){Bh[Bl]="transparent";}Bh[Bl]=g.call(this,Bh,Bi[0],Bl,Bl+"Width");var Bj=g.call(this,Bh,Bi[1]||"none",Bl,Bl+"Style"),Bm=Bj.indexOf("rgb");if(Bm>-1){Bj=Bj.slice(0,Bm)+AM.rgbStr2hex(Bj.slice(Bm));}return Bj;}};AV[r]={ps:I,pn:"TopStyle",pt:Ah,fn:"border",extract:A3};AV[Bb]={ps:I,pn:"RightStyle",pt:Ah,fn:"border"};AV[BG]={ps:I,pn:"BottomStyle",pt:Ah,fn:"border",extract:A3};AV[Aj]={ps:I,pn:"LeftStyle",pt:Ah,fn:"border",extract:A3};AV[k]={ps:BE,pn:"ZIndex",pt:BF,fn:"z-index"};AV[Aa]={ps:H,pn:"ShowTitleBar",pt:A0};AV[q]={ps:H,pn:"Title",pt:BW};AV[BA]={ps:S,pn:"Style",pt:BF};AV[AE]={ps:S,pn:"Orientation",pt:BF};AV[A9]={ps:S,pn:"OrientationBehavior",pt:BF};AV[o]={ps:S,pn:"Multiselect",pt:A0};AV[l]={ps:S,pn:"AutoSearchEnabled",pt:A0};AV[C]={ps:S,pn:"ItemWidthMode",pt:BF};AV[BN]={ps:S,pn:"MetricConditionType",pt:BF};AV[BB]={ps:S,pn:"ShowElementCount",pt:BF};AV[u]={ps:S,pn:"ExportAsShownOnWeb",pt:BF};AV[AR]={ps:An,pn:"LayoutXML",pt:Ag};AV[M]={ps:An,pn:"LockAspectRatio",pt:A0};AV[As]={ps:An,pn:"ImageSizeMode",pt:BF};AV[Ai]={ps:An,pn:"ImageHeight",pt:BW};AV[Am]={ps:An,pn:"ImageWidth",pt:BW};AV[AU]={ps:A6,pn:"layoutBarPosition",pt:BW};AV[BH]={ps:A6,pn:"ExecutionFullScreenMode",pt:A0};AV[AZ]={ps:A6,pn:"LayoutStyle",pt:BF};AV[Ae]={ps:L,pn:"Visible",pt:A0};AV[Ao]={ps:A2,pn:"LongNames",pt:BW};AV[N]={ps:A2,pn:"Indented",pt:BF};AV[AQ]={ps:Aw,pn:"ShowAllRows",pt:BW};AV[B]={ps:Aw,pn:"HideNullZeroValues",pt:BW};AV[Ap]={ps:P,pn:["LeftPadding","RightPadding"],pt:BW};AV[e]={ps:P,pn:["TopPadding","BottomPadding"],pt:BW};AV.rowsshw={ps:A2,pn:"ShowRowHeaders",pt:BW};AV.rowsmg={ps:A2,pn:"MergeCells",pt:BW};AV.rowslhv={ps:A2,pn:"LockRowHeaders",pt:BW};AV.colsshw={ps:A2,pn:"ShowColumnHeaders",pt:BW};AV.colsmg={ps:A2,pn:"MergeColumnCells",pt:BW};AV.colslhv={ps:A2,pn:"LockColumnHeaders",pt:BW};AV[A4]={ps:A2,pn:"SubtotalFormatUseRowHeaders",pt:BW};AV[d]={ps:A2,pn:"SubtotalFormatUseColumnHeaders",pt:BW};AV[Bc]={ps:A2,pn:"SubtotalFormatUseValues",pt:BW};AV[W]={ps:R,pn:"RefreshFrequency",pt:BF};AV[Bf]={ps:Y,pn:"Join Across Datasets",pt:BF};AV[Ax]={ps:Y,pn:"MCE Join To Get Data Combination",pt:BF};AV[AN]={ps:Ab,pn:"OnDemandEvaluation",pt:BF};AV[AJ]={ps:L,pn:"Highlight",pt:BF};AV[Az]={ps:AG,pn:"Category",pt:BF};AV[G]={ps:AG,pn:"Format",pt:BW};AV[f]={ps:AG,pn:"CurrencySymbol",pt:BW};AV[BP]={ps:AG,pn:"DecimalPlaces",pt:BF};AV[A8]={ps:AG,pn:"CurrencyPosition",pt:BF};AV[D]={ps:AG,pn:"NegativeNumbers",pt:BF};AV[BV]={ps:AG,pn:"ThousandSeparator",pt:BF};AV[Be]={ps:L,pn:"GroupInfo",pt:BW};AV[BQ]={ps:V,pn:"GradientColor",pt:Ay};AV[Bd]={ps:V,pn:"GradientAngle",pt:BF};BY.forEach(a.keyarray(AV),function(Bh){var Bi=AV[Bh];Bi.getFormatBlockName=function(){var Bk=this.fn;if(!Bk){var Bj=this.pn;Bk=Bj.charAt(0).toLowerCase()+Bj.substr(1);}return Bk;};Bi.getCssName=function(){var Bj=this.getFormatBlockName.call(this),Bk=this.cn;if(!Bk){Bk=BT.convertCssToCamelCase(Bj);}return Bk;};BY.forEach([AI,BX,A5,BU,Al],function(Bj){var Bk=Bj.name;Bi[Bk]=Bi[Bk]||Bj[Bi.pt]||Bj._def;});});function A7(Bk,Bj,Bh){var Bi=Bh[Bk.ps]=Bh[Bk.ps]||{};Bj=Bk.encode(Bj);BY.forEach([].concat(Bk.pn),function(Bl){Bi[Bl]=Bj;});return Bh;}function AP(Bn,Bm,Bh){var Bl=Bn.x;if(Bl){if((Bl&Av)>0){var Bk=!!Bm.c1,Bj=0;if(Bk){A7(Bn,Bm.c1,Bh);var Bi=Bh[V];Bi.GradientColor=Bn.encode(Bm.c2);Bi.GradientAngle=Bm.or?0:90;Bi.GradientXOffset=0;Bi.GradientYOffset=0;Bj=2;}else{if(Bn.encode(Bm)===-1){Bj=1;}else{A7(Bn,Bm,Bh);}}return A7(AV[E],Bj,Bh);}}return null;}mstrmojo.models.FormatModel={getFormatUpdate:function Af(Bi,Bl,Bh){var Bk=AV[Bi];if(!Bk){throw new Error("Invalid property "+Bi+" in FormatModel::getFormatUpdate.");}Bh=Bh||{};var Bj=AP.call(this,Bk,Bl,Bh);if(Bj){return Bj;}return A7(Bk,Bl,Bh);},getFormatPropertyInfo:function t(Bh){return AV[Bh];},getValueFromUpdate:function O(Bi,Bj){var Bl=AV[Bi],Bh=null;try{Bh=Bj[Bl.ps][Bl.pn];}catch(Bk){}return Bh;},getGradientValues:function AO(Bi){var Bh=Bi.fx&&Bi.fx.gd;if(Bh){var Bk={c1:Bh.sc,c2:Bh.ec,or:Bh.t};return Bk;}if(Bi[E]===2){if(!!Bi.bc.c1){return Bi.bc;}var Bj={c1:Bi.bc,c2:Bi.gdc,or:Bi.gda===90?0:1};return Bj;}return null;},decodeGradientValue:function F(Bh){if(Bh&&Bh.c1){Bh.c1=this.decodeValue(BQ,Bh.c1);Bh.c2=this.decodeValue(BQ,Bh.c2);return Bh;}return null;},decodeValue:function AH(Bh,Bi){return AV[Bh].decode(Bi);},updateFormatBlock:function A1(Bh,Bi,Bj){return AV[Bi].update(Bh,Bj);},getFormatBlockValue:function AF(Bh,Bi){return AV[Bi].extract(Bh);},GradientType:null,FormatObjectType:null,PROPERTY_INFO_TYPE:null,ENUM_PROPERTY_NAMES:{NAME:p,HEIGHT:Q,WIDTH:BZ,WIDTH_MODE:AK,PAGE_WIDTH:BL,MARGIN_LEFT:b,MARGIN_RIGHT:BM,USE_PAGE_WIDTH_AS_LAYOUT_WIDTH:AC,FONT_FAMILY:z,FONT_SIZE:Aq,FONT_WEIGHT:BR,FONT_STYLE:AL,UNDERLINE:BS,LINE_THROUGH:w,COLOR:AB,TEXT_ALIGN:Z,VERTICAL_ALIGN:AA,TEXT_WRAP:Ak,TEXT_DIRECTION:AS,TEXT_OVERFLOW:h,BACKGROUND_COLOR:Au,FILL_STYLE:E,GRADIENT_COLOR:BQ,GRADIENT_ANGLE:Bd,BORDER_TOP_COLOR:K,BORDER_RIGHT_COLOR:At,BORDER_BOTTOM_COLOR:Ad,BORDER_LEFT_COLOR:x,BORDER_TOP_STYLE:r,BORDER_RIGHT_STYLE:Bb,BORDER_BOTTOM_STYLE:BG,BORDER_LEFT_STYLE:Aj,BORDER_COLOR:AY,BORDER_STYLE:BC,Z_INDEX:k,SHOW_TITLE_BAR:Aa,TITLE:q,CONTROL_STYLE:BA,CONTROL_ORIENTATION:AE,CONTROL_ORIENTATION_BEHAVIOR:A9,CONTROL_MULTISELECT:o,CONTROL_AUTOSEARCH:l,CONTROL_ITEM_WIDTH_MODE:C,CONTROL_METRIC_CONDITION_TYPE:BN,CONTROL_SHOW_ELEMENT_COUNT:BB,CONTROL_EXPORT_AS_SHOWN_ON_WEB:u,LAYOUT_XML:AR,LOCK_ASPECT_RATIO:M,IMAGE_SIZE_MODE:As,SHOW_HEADER:n,MERGE_HEADER:BD,LOCK_HEADER:Ba,LONG_NAME:Ao,SHOW_ALL_ROWS:AQ,HIDE_NULL:B,IMAGE_WIDTH:Am,IMAGE_HEIGHT:Ai,VISIBLE:Ae,LAYOUT_TAB_POSITION:AU,GRID_VERTICAL_PADDING:e,GRID_HORIZONTAL_PADDING:Ap,REFRESH:W,JOIN_ACROSS_DATASET:Bf,MCE_JOIN_TO_GET_DATA_COMBINATION:Ax,ON_DEMAND_EVALUATION:AN,FULL_SCREEN_MODE:BH,SELECTOR_SELECTION_COLOR:BK,SELECTOR_SELECTION_FILL_STYLE:j,VIZ_HIGHLIGHTING:AJ,GROUP_INFO:Be,SUBTOTAL_FORMAT_USE_ROWHEADERS:A4,SUBTOTAL_FORMAT_USE_COLUMNHEADERS:d,SUBTOTAL_FORMAT_USE_VALUES:Bc,OUTLINE:N,LAYOUT_STYLE:AZ},ENUM_PROPERTY_SETS:{FORMATTING_NUMBER:AG},ENUM_NUMBER_FORMAT_KEYS_OBJ:{CATEGORY:Az,CURRENCY_POSITION:A8,CURRENCY_SYMBOL:f,DECIMAL_PLACES:BP,FORMAT:G,NEGATIVE_NUMBERS:D,THOUSAND_SEPARATOR:BV}};}());(function(){mstrmojo.requiresCls("mstrmojo.array","mstrmojo.num","mstrmojo.locales");var D=mstrmojo.array,A=mstrmojo.num,B=mstrmojo.locales;mstrmojo.vi.util.NumberFormatUtility=mstrmojo.provide("mstrmojo.vi.util.NumberFormatUtility",{applyFormatToNumber:function C(P,Q,G){var H="\u00A4",L=/"[^"]*"/g,F=P.match(L),K=P.replace(L,H),O=["m","y","d","h","s"],N=G||false,E=new Date(),M=E.getFullYear(),J=E.getMonth(),I=E.getDay(),S=B.datetime,R;D.forEach(O,function(U){N=N||K.indexOf(U,0)!==-1;});if(N){K=K.replace(/y{3,}/g,M).replace(/y{1,2}/g,M.toString().slice(2,4));K=K.replace(/m{4,}/g,S.MONTHNAME_FULL[J-1]).replace(/m{3}/g,S.MONTHNAME_SHORT[J-1]).replace(/mm/g,"07").replace(/m/g,"7").replace(/7ber/g,"mber");K=K.replace(/d{4,}/g,S.dayNames[I-1]).replace(/d{3}/g,"Mon").replace(/dd/g,"10").replace(/d/g,"1").replace(/1ay/g,"day");K=K.replace(/hh/g,"08").replace(/h/g,"8");K=K.replace(/ss/g,"04").replace(/s/g,"4");K=K.split(H);R=K[0];D.forEach(F,function(V,U){R+=V+K[U+1];});return R;}if(A.isNumeric(Q)){return A.formatByMask(P,A.parseNumeric(Q));}return Q;}});}());(function(){mstrmojo.requiresCls("mstrmojo._HasPopup","mstrmojo.hash","mstrmojo.css");var F=mstrmojo.hash,C=mstrmojo.css;var D="open";function E(G){return G?G.popupConfig.hostElement:null;}mstrmojo.ui.menus._HasMenuPopup=mstrmojo.provide("mstrmojo.ui.menus._HasMenuPopup",F.copy(mstrmojo._HasPopup));mstrmojo.ui.menus._HasMenuPopup.openPopup=function A(I,G){var H=this._lastOpened;if(H){this.closePopup();}mstrmojo._HasPopup.openPopup.call(this,I,G);C.addClass(E(I),D);};mstrmojo.ui.menus._HasMenuPopup.closePopup=function B(){C.removeClass(E(this._lastOpened),D);mstrmojo._HasPopup.closePopup.call(this);};}());(function(){mstrmojo.requiresCls("mstrmojo.css","mstrmojo.fx.AnimateProp");var S=mstrmojo.css;var Q=10;function C(X,a,Z){X.pauseScrollRendering(true);var Y=X.scrollboxNode,W=X.animate?X.scrollEffect:null;if(W&&W.play){if(W.isPlaying){W.cancel();}W.props={scrollTop:{start:Y.scrollTop,stop:a,isStyle:false}};W.onEnd=function(){X.pauseScrollRendering(false,null,Z);};W.play();}else{Y.scrollTop=a;X.pauseScrollRendering(false,null,Z);}}function K(d,f,W){var X=4;if(!W){W=0;}var g=Math.round(d.renderBlockSize/2);d.fillAt(Math.max(0,f-g),f+g);var c=d.itemsContainerNode,b=c.childNodes[f],a=d.listMapper.itemOffsetTop(d,c,null,b),e=parseInt(d.scrollboxNode.clientHeight/2,10)-b.offsetHeight/2,Y=Math.max(0,d.spacerMargin+a-e);if(Math.abs(d.scrollboxNode.scrollTop-Y)>2){C(d,Y,d.renderOnScroll?function(){if(W<=X){K(d,f,W++);}}:null);}else{var Z=d.animate?d.scrollEffect:null;if(Z&&Z.isPlaying&&Z.cancel){Z.cancel();d.pauseScrollRendering(false);}}}function J(Y){var Z=Y.itemsContainerNode,W=Z.lastChild,X=W?W.offsetTop+W.offsetHeight-Z.firstChild.offsetTop:0;return X;}function V(X){var W=J(X),Y=Math.max(0,parseInt((X.scrollboxNode.clientHeight-W)/2,10));C(X,Math.max(0,X.spacerMargin-Y));}function H(Y){var W=Y.selectedIndex,X=W>-1;Y.set("hasSelection",X);if(!Y.domNode){return ;}if(X){K(Y,W);}else{V(Y);}}function E(X){var Z=X.scrollboxNode,W=J(X),Y=W>Z.clientHeight/2;S.toggleClass(X.upArrowNode,["enabled"],Y);S.toggleClass(X.downArrowNode,["enabled"],Y);}function N(W,X){var Y=W.scrollboxNode;Y.scrollTop=Math.min(Math.max(Y.scrollTop+X,0),Y.scrollHeight-Y.offsetHeight);}function B(X,W){if(!X._scrollInter){var Y=Q*(W?-1:1);X._scrollInter=window.setInterval(function(){N(X,Y);},50);}}function R(W){if(W._scrollInter){window.clearInterval(W._scrollInter);W._scrollInter=null;}}mstrmojo._IsDial=mstrmojo.provide("mstrmojo._IsDial",{markupString:'<div id="{@id}" class="mstrmojo-Dial {@cssClass}" style="position:relative;"><div class="mstrmojo-Dial-uparrow"  onmouseover="mstrmojo.all.{@id}.onmouseoverarrow(self, arguments[0], true)" onmouseout="mstrmojo.all.{@id}.onmouseoutarrow(self, arguments[0], true)" onclick="mstrmojo.all.{@id}.onclickarrow(self, arguments[0], true)" onmousedown="mstrmojo.all.{@id}.onmousedownarrow(self, arguments[0], true)" onmouseup="mstrmojo.all.{@id}.onmouseuparrow(self, arguments[0], true)"></div><div class="mstrmojo-Dial-scrollbox {@cssClass}" style="position:relative;{@cssText}" mstrAttach:mousedown,mouseup><div class="mstrmojo-Dial-spacer" style="{@spacerCssText}"><div class="mstrmojo-Dial-itemsContainer" style="position:relative;{@itemsContainerCssText}">{@itemsHtml}</div></div></div><div class="mstrmojo-Dial-dnarrow" onmouseover="mstrmojo.all.{@id}.onmouseoverarrow(self, arguments[0], false)" onmouseout="mstrmojo.all.{@id}.onmouseoutarrow(self, arguments[0], false)" onclick="mstrmojo.all.{@id}.onclickarrow(self, arguments[0], false)" onmousedown="mstrmojo.all.{@id}.onmousedownarrow(self, arguments[0], false)" onmouseup="mstrmojo.all.{@id}.onmouseuparrow(self, arguments[0], false)"></div></div>',markupSlots:{scrollboxNode:function(){return this.domNode.childNodes[1];},spacerNode:function(){return this.domNode.childNodes[1].firstChild;},itemsContainerNode:function(){return this.domNode.childNodes[1].firstChild.firstChild;},upArrowNode:function(){return this.domNode.childNodes[0];},downArrowNode:function(){return this.domNode.childNodes[2];}},markupMethods:{onvisibleChange:function(){this.domNode.style.display=this.visible?"block":"none";},onhasSelectionChange:function(){S.toggleClass(this.domNode,["hasSelection"],!!this.hasSelection);}},animate:true,itemsEffect:{scriptClass:"mstrmojo.fx.AnimateProp",duration:500,interval:25,slot:"itemsContainerNode",preStart:function(){var X=this.widget[this.slot],W=(X&&X.offsetWidth)||0;this.props=W?{left:{start:-W,stop:0,suffix:"px",isStyle:true}}:{};},revertOnCancel:false},scrollEffect:{scriptClass:"mstrmojo.fx.AnimateProp",duration:250,interval:25,slot:"scrollboxNode",revertOnCancel:false},multiSelect:false,holdJumpOnly:true,audibles:{"*":true,hasSelection:false},initSpacer:function I(){var W=(this.cssText||"").match(/height:\s*(\d*)px/);if(W){this.spacerMargin=parseInt(Number(W[1])/2,10);var X=this.spacerMargin+"px";this.spacerCssText="padding-top: "+X+"; padding-bottom: "+X+";";}else{this.spacerMargin=0;delete this.spacerCssText;}},center:function U(){H(this);},preBuildRendering:function(){this.initSpacer();return this._super();},postBuildRendering:function D(){this._super();this.center();E(this);},refreshScroll:function G(){this.center();E(this);},prechange:function O(W){this._super(W);if(this.hasRendered){if(!this.multiSelect||(W&&W.added&&W.added.length)){this.center();}}},onclickarrow:function A(Y,X,W){N(this,Q*(W?-1:1));},onmouseoverarrow:function L(Y,X,W){if(!this.holdJumpOnly){B(this,W);}},onmouseoutarrow:function M(Y,X,W){R(this);},onmousedownarrow:function F(Y,X,W){if(this.holdJumpOnly){B(this,W);}},onmouseuparrow:function P(Y,X,W){R(this);}});}());(function(){mstrmojo.requiresCls("mstrmojo.string","mstrmojo.dom","mstrmojo.css","mstrmojo.array");var E=mstrmojo.dom,Q=mstrmojo.css,B=mstrmojo.string,I="selected",L="hidden";function P(W,X,Y,V,a){var Z=a.listHooks[W];if(Z&&Z.call(a,X,Y,V)){return ;}Q.toggleClass(X,I,W==="select");}function G(Y,X,W){var Z=this[Y],V=Z?Z.split(X):[];this[Y]=mstrmojo.array.distinct(V.concat(W.split(X))).join(X);}mstrmojo._IsList=mstrmojo.provide("mstrmojo._IsList",{_mixinName:"mstrmojo._IsList",listHooks:{},useListModKeys:false,init:function N(V){this._super(V);this._shiftStartIndex=-1;},getItemMarkup:function D(W,V){return'<{@tag} class="item {@cls}" idx="{@idx}" style="{@style}" title="{@title}">{@en@n}</{@tag}>';},getItemDisplayName:function M(V){return V.n||"";},getItemProps:function R(Z,V){var W=!!this.selectedIndices[V],a={tag:"div",sel:W,cls:"",n:this.getItemDisplayName(Z),style:"",idx:V,addCls:function X(c){G.call(this,"cls"," ",c);},addStyle:function Y(c){G.call(this,"style",";",c);},title:Z.title||""};if(a.n&&B.isEmpty(a.n)){a.n=B.decodeHtmlString("<br/>");}if(W){a.addCls(I);}var b=Z.cls;if(b){a.addCls(b);}if(Z.hid){a.addCls(L);}return a;},itemRenderer:{render:function S(W,V,X){W._renderIdx=V;return mstrmojo.string.apply(X.getItemMarkup(W,V),X.getItemProps(W,V));},select:function K(W,X,V,Y){P("select",W,X,V,Y);},unselect:function H(W,X,V,Y){P("unselect",W,X,V,Y);}},onclick:function U(V){try{var X=this.getItemFromTarget(V.getTarget());if(X){V.cancel();this.doItemSelect(X,V||{});}}catch(W){mstrApp.onerror(W);}},doItemSelect:function C(l,k){var c=k.hWin,d=k.e,h=l._renderIdx,f=l._positionIdx,W=E.isMetaKey(c,d),b=E.shiftKey(c,d),X=this.multiSelect,a=this.useListModKeys,j=this._shiftStartIndex,Y=this.selectedIndices;if(X&&a&&b&&j>-1){var V=[],Z=[];this.processContinuousSelection(V,Z,h);this.addSelect(V);this.removeSelect(Z);}else{if(X&&(!a||W)){var g=(Y[h])?"remove":"add";this[g+"Select"](h,false,f);}else{this.singleSelect(h,false,f);}this._shiftStartIndex=h;}},processContinuousSelection:function J(X,W,V){var c=this._shiftStartIndex,b=this.selectedIndices,a=Math.min(c,V),Z=Math.max(c,V),Y;for(Y=0;Y<this.items.length;Y++){if(a<=Y&&Y<=Z){if(!b[Y]){X.push(Y);}}else{if(b[Y]){W.push(Y);}}}},onclearSelection:function A(){this._shiftStartIndex=-1;},getItemNodeFromTarget:function F(W){var V=E.findAncestorByAttr(W,"idx",true,this.domNode);return(V&&V.node)||null;},getItemFromTarget:function O(X){var W=this.getItemNodeFromTarget(X),V=W&&parseInt(W.getAttribute("idx"),10);if(V!==null&&!isNaN(V)&&this.items){return this.items[V];}return undefined;}});mstrmojo._IsList.SELECTED_CLS=I;mstrmojo._IsList.HIDDEN_CLS=L;}());(function(){mstrmojo.requiresCls("mstrmojo.css");var F=mstrmojo.css,E="px",J="hasOwnAvatar",I={x:0,y:0};function B(L){var K=this.createAvatar(L.src.node,L);if(K){F.addClass(K,[this.avatarCssClass,J]);this.avatar=L.avatar=document.body.appendChild(K);}}function C(){var K=this.avatar;if(K){K.parentNode.removeChild(K);delete this.avatar;F.removeClass(K,[this.avatarCssClass,J]);}}mstrmojo._HasOwnAvatar=mstrmojo.provide("mstrmojo._HasOwnAvatar",{_mixinName:"mstrmojo._HasOwnAvatar",draggable:true,ownAvatar:true,avatarCssClass:"",restrictedToAxis:undefined,isDragValid:function H(K){if(this._super){return this._super(K);}return false;},ondragstart:function D(K){B.call(this,K);this.positionAvatar(K.src.pos,K);if(this._super){this._super(K);}},ondragmove:function A(K){this.positionAvatar(K.tgt.pos,K);if(this._super){this._super(K);}},ondragend:function A(K){C.call(this);if(this._super){this._super(K);}},createAvatar:mstrmojo.emptyFn,positionAvatar:function G(O,L){if(this.avatar){var N=this.avatar.style,M=this.restrictedToAxis,K=(L&&L.dragOffsets)||I;if(M!=="y"){N.left=O.x+K.x+E;}if(M!=="x"){N.top=O.y+K.y+E;}}}});}());(function(){mstrmojo.requiresCls("mstrmojo.dom","mstrmojo.css");var C=mstrmojo.dom,G=100,L=700;var B="mojo-safari-hide-nativeTooltip",H=mstrmojo.css;function M(O,N){return function(Q){var P=mstrmojo.all[O];if(P.customTooltipHandler){P.customTooltipHandler(Q);}P[(N?"move":"show")+"Tooltip"](Q,self);};}function A(){var O=this.tooltipNode||this.domNode,Q=this.id,N,P="_ontooltip"+(this.isDynamicTooltip?"move":"over");if(!this._ontooltipout){this._ontooltipout=function(R){mstrmojo.all[Q].hideTooltip(R,self);};}if(!this[P]){this[P]=M(Q,this.isDynamicTooltip);}O=[].concat(O);for(N=0;N<O.length;N++){O[N].removeAttribute("title");C.attachEvent(O[N],(this.isDynamicTooltip?"mousemove":"mouseover"),this[P]);C.attachEvent(O[N],"mouseout",this._ontooltipout);}}function I(){var Q=this.tooltipNode||this.domNode,P;if(Q&&Q.constructor!==Array){Q=[Q];}if(Q){var R=this._ontooltipover,O=this._ontooltipout,N=this._ontooltipmove;for(P=0;P<Q.length;P++){if(R){C.detachEvent(Q[P],"mouseover",R);}if(O){C.detachEvent(Q[P],"mouseout",O);}if(N){C.detachEvent(Q[P],"mousemove",N);}}}}mstrmojo._HasTooltip=mstrmojo.provide("mstrmojo._HasTooltip",{tooltip:"",richTooltip:null,useRichTooltip:false,isDynamicTooltip:false,tooltipNode:null,tooltipOpenDelay:700,isIgnoreTooltipCloseDelay:false,hasWidgetContent:false,tooltipCloseDelay:G,hasOpenTooltip:false,postBuildRendering:function(){var N=this._super();if(this.useRichTooltip){A.call(this);}return N;},onuseRichTooltipChange:function K(){if(this.hasRendered){if(this.useRichTooltip){A.call(this);}else{I.call(this);this.hideTooltip();}}},showTooltip:function J(Q,P){var O=this;if(!O.hasOpenTooltip&&(!mstrApp.isInteractive||mstrApp.isInteractive&&mstrApp.isInteractive())){mstrmojo.requiresCls("mstrmojo.tooltip");if(this.updateTooltipConfig){this.updateTooltipConfig(Q);}window.clearTimeout(this._tooltipTimeOut);if(mstrmojo.dom.isIE){var S={};for(var N in Q){S[N]=Q[N];}Q=S;}var U=this.richTooltip?this.richTooltip.areaId:undefined;if(C.isSafari&&Q){var R=Q.srcElement;if(window.getComputedStyle(R)["text-overflow"]==="ellipsis"){this.baseElement=R;H.toggleClass(R,B,true);}}this._tooltipTimeOut=window.setTimeout(function(){var V=O.richTooltip;if(O._closeTooltipTimeout){window.clearTimeout(O._closeTooltipTimeout);delete O._closeTooltipTimeout;}mstrmojo.tooltip.open(O,Q,P);O.tooltip.onmouseover=function(){if(O.richTooltip&&O.richTooltip.enableHover){window.clearTimeout(O._closeTooltipTimeout);window.clearTimeout(O._deactivationTimeout);if(O.tooltip){O.tooltip.onmouseout=function(W){var X=W.e;if((!X.toElement&&!X.relatedTarget)||!C.contains(this.domNode,W.e.toElement||W.e.relatedTarget)){O.hideTooltip();}};}}};O.tooltip.allowOtherTooltips=O.allowOtherTooltips;if(V&&V.onClose){O.tooltip.onClose=V.onClose;}O.hasOpenTooltip=true;O._hasActiveArea=true;O._tooltipAreaId=U;window.clearTimeout(O._deactivationTimeout);delete O._deactivationTimeout;},(this._hasActiveArea&&U&&U===this._tooltipAreaId)?0:this.tooltipOpenDelay);}},moveTooltip:function D(N,P){if(this._tooltipTimeOut){window.clearTimeout(this._tooltipTimeOut);this._tooltipTimeOut=null;mstrmojo.tooltip.close();}var R=this,O=N,Q=P;this._tooltipTimeOut=setTimeout(function(){mstrmojo.tooltip.open(R,O,Q);},this.tooltipOpenDelay);},hideTooltip:function F(){var N=this;window.clearTimeout(this._tooltipTimeOut);if(C.isSafari&&this.baseElement){H.toggleClass(this.baseElement,B,false);}if(this._closeTooltipTimeout){window.clearTimeout(this._closeTooltipTimeout);}if(this._hasActiveArea&&!this._deactivationTimeout){this._deactivationTimeout=window.setTimeout(function(){delete N._deactivationTimeout;delete N._hasActiveArea;delete N._tooltipAreaId;},100);}mstrmojo.requiresCls("mstrmojo.tooltip");if((!this.isIgnoreTooltipCloseDelay)&&N.richTooltip&&N.richTooltip.enableHover){this._closeTooltipTimeout=window.setTimeout(function(){mstrmojo.tooltip.close();delete N._closeTooltipTimeout;},N.richTooltip.tooltipCloseDelay||this.tooltipCloseDelay);}else{if(N.tooltip){this.isIgnoreTooltipCloseDelay=false;mstrmojo.tooltip.close();}}this.hasOpenTooltip=false;},unrender:function E(N){I.call(this);this._super(N);}});mstrmojo._HasTooltip.TOOLTIP_OPEN_DELAY=L;mstrmojo._HasTooltip.TOOLTIP_CLOSE_DELAY=G;}());(function(){mstrmojo.requiresCls("mstrmojo.css");var A=mstrmojo.css;mstrmojo.ui._HasUITheme=mstrmojo.provide("mstrmojo.ui._HasUITheme",{_mixinName:"mstrmojo.ui._HasUITheme",themeClassName:"",postBuildRendering:function B(){var D=this.themeClassName;if(D){this.onthemeClassNameChange({value:D});}return this._super();},onthemeClassNameChange:function C(D){var F=this.domNode;if(F){var G=D.value,E=D.valueWas;if(G){A.addClass(F,D.value);}if(E){A.removeClass(F,D.valueWas);}}}});mstrmojo.ui._HasUITheme.EnumThemeNames={LIGHT_THEME:"mojo-theme-light",DARK_THEME:"mojo-theme-dark"};}());(function(){mstrmojo.requiresClsP("mstrmojo","hash","css","array","desc");var R=mstrmojo.hash,m=mstrmojo.func,B=mstrmojo.css,f=mstrmojo.array;var E={lv:-1,hcd:false,epd:false,hid:false,dhid:false,children:[],displayChildren:[],parent:null,displayParent:null},k={rootItems:{},items:[],itemMap:{}};var l="hidden",C="expanded",q="collapsed",J="hierarchy",c="hasChildren",p="u;",X=10,M=7,o=32;mstrmojo.ui._IsHierarchyList=mstrmojo.provide("mstrmojo.ui._IsHierarchyList",{_mixinName:"mstrmojo.ui._IsHierarchyList",itemValueField:"v",init:function n(r){this._super(r);this.clearItems();},getItemProps:function g(u,r){var t=this._super(u,r),w=0;if(u.hcd){t.addCls(c);}if(u.v===p){t.addCls(l);}if(this.isHiearachyDisplay()){t.addCls(J);if(u.hid){t.addCls(l);}w=u.lv>=0?u.lv*X:0;}t.indent=w;return t;},_getItemNode:function S(r){var t=this.itemsContainerNode;return f.filterOne(t&&t.childNodes,function(u){return parseInt(u.getAttribute("idx"),10)===r;});},_buildItemsMarkup:function j(AA,t,u,w,x,z){var r;if(this.isHiearachyDisplay()){r=this._buildDescendantsMarkup();}else{r=this._super(AA,t,u,w,x,z);}return r;},_buildDescendantsMarkup:function a(AA,x){var AD=[],z=this.itemRenderer&&this.itemRenderer.render,AB=AA?(x?[AA]:AA.displayChildren):(this.raad?this.getDisplayRoots():this.getRootItems()),t=this.blockCount,w=function(AE){if(!AE.hid&&!AE.dhid){AD.push(z(AE,AE.idx,this));}if(AE.epd||AE.hid){f.forEach(AE.displayChildren,function(AG,AF){return AC.call(this,AG,AF);},this);}},AC=function(AF,AE){if(this.raad&&AE>=t){var AG=this.createRenderer(AF.lv,AF.displayParent,AF.parent,this.items.length,AE);this.items.push(AG);if(AG.displayParent){AG.displayParent.displayChildren.push(AG);}if(AG.parent){AG.parent.children.push(AG);}w.call(this,AG);return false;}else{w.call(this,AF);}};if(z&&typeof z==="function"){if(this.raad&&!AA){if(AB.length>t){var r=AB.slice(0,t),u=this.createRenderer(AB[t-1].lv,null,null,this.items.length,t);this.items.push(u);AB.push(u);r.push(u);AD=this._buildSiblingsMarkup(r);}else{AD=this._buildSiblingsMarkup(AB);}}else{f.forEach(AB,function(AF,AE){return AC.call(this,AF,AE);},this);}}return AD;},getItems:function U(){return this.items;},getItemByValue:function D(r){return this.itemMap[r];},isRootItem:function(r){return r.lv>=0&&r.v!==p&&!r.pid&&!r.parent;},getRootItems:function d(){return R.valarray(this.rootItems);},getDisplayRoots:function Y(){if(!this.displayRoots){var u=this.displayRoots=[],r=this.getRootItems(),t=function(w){f.forEach(w,function(x){if(!x.hid){u.push(x);}if(x.epd||x.hid){t(x.displayChildren);}});};t(r);}if(!this.initialDisplayRoots){this.initialDisplayRoots=u.slice();}return this.displayRoots;},getInitialDisplayRoots:function A(){if(!this.initialDisplayRoots){this.initialDisplayRoots=(this.getDisplayRoots()||[]).slice();}return this.initialDisplayRoots;},createRenderer:function I(x,t,w,r,u){return{n:mstrmojo.desc(1005,"More..."),lv:x,displayParent:t,parent:w,idx:r,fetcher:true,fake:true,config:{nextSiblingIdx:u}};},getItemAncestorMap:function F(t){var r=this.itemValueField,u={};while(t&&t[r]){u[t[r]]=true;t=t.parent;}return u;},getItemDescendantMap:function Z(u){var r=this.itemValueField,w={},t=function(x){w[x[r]]=true;f.forEach(x.children,function(z){t(z);});};t(u);return w;},clearItems:function h(){var r=this.itemsContainerNode;R.copy(R.clone(k),this);if(r){r.innerText="";this.updateScrollbars();}},addItems:function e(z,u){var t=this.items,x=this.itemMap,r=this.rootItems,w=this.itemValueField,AB=[];f.forEach(z,function(AC){var AF=AC[w],AD=this.getItemByValue(AF),AE=R.copy(AC,(AD?AD:R.clone(E)));if(!AD){AE.idx=t.length;t.push(AE);if(AF){x[AF]=AE;}}if(this.isRootItem(AE)){r[AF]=AE;}AB.push(AE);},this);f.forEach(AB,function(AE){var AC=this.getItemByValue(AE.pid),AD=this.getItemByValue(AE.dpid)||AC;if(AC){if(!AE.parent){AE.parent=AC;AC.children.push(AE);}if(!AE.hid&&!AE.dhid&&!AE.displayParent){AD.hcd=true;AE.displayParent=AD;AD.displayChildren.push(AE);}}delete AE.pid;delete AE.dpid;},this);if(!u){if(this.postAddItems){this.postAddItems(AB);}var AA=this.itemsContainerNode;if(AA){if(this.isHiearachyDisplay()){this.refresh();}else{AA.innerHTML+=this._buildSiblingsMarkup(this.getFlatDisplayItems(AB)).join("");this.updateScrollbars();}}}return AB;},addSiblingItems:function G(AB,x){var w=this.getItemByValue(x),t;if(w){f.forEach(AB,function(AD){if(AD.v!==x){AD.pid=AD.pid||x;}});}t=this.addItems(AB,true);if(this.postAddSiblingItems){this.postAddSiblingItems(t,w);}var z=this.itemsContainerNode;if(z&&this.isHiearachyDisplay()){var AA=this._buildSiblingsMarkup(t).join("");if(!x){z.innerHTML+=AA;}else{if(w){var AC={},u=this._getItemNode(w.idx),r;if(u){AC[w.v]=true;while(u.nextSibling){r=this.getItemFromTarget(u.nextSibling);if(r&&r.displayParent&&AC[r.displayParent.v]){AC[r.v]=true;u=u.nextSibling;}else{break;}}u.outerHTML+=AA;}}}this.updateScrollbars();}return t;},addBranchItems:function L(t,x){var r=this.getItemByValue(x),w;if(r){f.forEach(t,function(AA){AA.pid=AA.pid||x;});}w=this.addItems(t,true);if(this.postAddBranchItems){this.postAddBranchItems(w,r);}var u=this.itemsContainerNode;if(u&&this.isHiearachyDisplay()){if(!x){f.forEach(w,function(AA){if(this.isRootItem(AA)){u.innerHTML+=this._buildDescendantsMarkup(AA,true).join("");}},this);}else{if(r){var z=this._getItemNode(r.idx);if(z){z.outerHTML+=this._buildDescendantsMarkup(r).join("");}}}this.updateScrollbars();}return w;},updateItems:function H(r,t){if(t){f.forEach(r,function(AA,w,x){var z=t[w],u=x[z.p_index];if(u){AA.pid=u.v;}});}this.handleOriginalParent(r,t);this.setDisplayParent(r,t);this.clearItems();this.addItems(r,true);},handleOriginalParent:function P(r,t){if(t){f.forEach(r,function(AB,w,x){var AA=t[w],u=x[AA.p_index],z=x[AA.original_p_index];if(u&&u.t===M&&AB.lv!==u.lv&&z&&z.pid===u.v){AB.pid=z.v;}});}},setDisplayParent:function K(r,x,w){if(w){this.idMap=this.idMap||{};f.forEach(r,function(AA){this.idMap[AA.v]=AA;},this);}var u=this,t=function(AC,AB){var AA;if(!w&&x){var AD=x[AB].p_index;AA=r[AD];}else{if(w){AA=u.idMap[AC.pid];}}return AA;};f.forEach(r,function z(AD,AB,AC){var AA=t(AD,AB);if(!AA||u.isRootItem(AD)){return AD.v;}if(!AD.dpid){AD.dpid=AA.hid?z(AA,x&&x[AB]&&x[AB].p_index,AC):AA.v;}return AD.dpid;});},fetchItems:function V(w,AA){if(this.raad&&this.isHiearachyDisplay()&&(this.items||[]).length>0){return ;}w=w||{};var t=this,r=w.branch,z=w.browseFlags&o,x=parseInt(w.level,10),u=x>=0;this.fetchItemsThroughTaskCall(w,m.wrapMethods(AA,{success:function(AB){if(t.raad===undefined&&AB&&t.isHiearachyDisplay()){t.raad=AB.raad;}if(AB&&AB.es){var AC=AB.es;if(x===(r&&r.lv+1||0)||(z&&!t.raad)){t.addSiblingItems(AC,r&&r.v);}else{if(r&&!u){t.addBranchItems(AC,r.v);}else{t.addItems(AC);}}}}}));},updateItemNodesStatus:function W(){var r=this.itemsContainerNode&&this.itemsContainerNode.childNodes;f.forEach(r,function(u){var t=this.getItemFromTarget(u);if(t){B.toggleClass(u,CSS_SELECTED,t.isSelected);}},this);},_buildSiblingsMarkup:function O(u){var r=[],t=this.itemRenderer&&this.itemRenderer.render;if(t&&typeof t==="function"){f.forEach(u,function(w){r.push(t(w,w.idx,this));},this);}return r;},toggleCollapseExpandCss:function Q(t,r){B.toggleClass(t,q,!r);B.toggleClass(t,C,r);},doExpandCollapse:function b(r,AC){var AD=!AC.epd;AC.epd=AD;this.toggleCollapseExpandCss(r,AD);if(!this.isHiearachyDisplay()){return ;}var AA=this.getItemDescendantMap(AC),u,AB;if(AD){var t=AC.displayChildren&&AC.displayChildren[0];if(t){var x=this.getItemFromTarget(r.nextSibling);if(x&&x.displayParent===AC){var z={},w;u=r.nextSibling;while(u){AB=this.getItemFromTarget(u);w=AB&&AB.displayParent;if(!w||!AA[AB.v]){break;}if(z[w.v]){B.addClass(u,l);z[AB.v]=true;}else{B.removeClass(u,l);if(!AB.epd){z[AB.v]=true;}}u=u.nextSibling;}}else{r.outerHTML+=this._buildDescendantsMarkup(AC).join("");}}else{this.fetchItems({branch:AC,level:AC.lv+1});}}else{u=r.nextSibling;while(u){AB=this.getItemFromTarget(u);if(!AB||!AA[AB.v]){break;}B.addClass(u,l);u=u.nextSibling;}}this.updateScrollbars();},isHiearachyDisplay:function N(){return true;},fetchItemsThroughTaskCall:mstrmojo.emptyFn,getFlatDisplayItems:mstrmojo.emptyFn});}());(function(){mstrmojo.requiresCls("mstrmojo.array","mstrmojo.dom","mstrmojo.css");var A=1,K="mstrmojo-itemwrap",J="&nbsp;",I=mstrmojo.array;function B(W){if(!W.pageSize||W.pageSize<=0){var X=W.scrollboxNode;W.pageSize=X&&X.clientHeight||0;}return W.pageSize;}function U(W,X){if(W.usePaging){W.totalPages=1;var Z=W.itemsContainerNode,Y=B(W);if(W.usePaging&&Z&&Y){W.totalPages=Math.ceil((Z.clientHeight-parseInt(Z.style&&Z.style.paddingBottom||0,10))/Y);}if(Z){W.itemsContainerNode.style.paddingBottom=Y+"px";}}}mstrmojo.ListMapper=mstrmojo.provide("mstrmojo.ListMapper",{markupPrefix:"",markupSuffix:"",itemWrapperPrefix:function(W){return'<div class="'+this.getWrapperCss(W)+'">';},itemWrapperSuffix:"</div>",itemWrapperPrefill:"&nbsp",wrapperNodes:function C(W){return W.childNodes;},wrapperParentNode:function D(W){return W;},createWrapperNode:function G(W){var X=W.ownerDocument,Y=X.createElement("div");return Y;},findScrollRange:function N(l,a,k,o,X,d,q,n){if(!a){return{start:0,end:0};}var f=this.wrapperNodes(l),j=parseInt(a/2,10),Z=parseInt(Math.log(a)/Math.log(2),10),Y=0,W=a-1,g=k+o,e=f[0].offsetTop,c;for(var m=1;m<=Z;m++){c=f[j].offsetTop-e+n;if(c<k){Y=j;}else{if(c>g){W=j;}}var b=Math.round(a/Math.pow(2,m+1));j+=(c>k)?-b:b;j=Math.min(Math.max(0,j),a-1);}return{start:Y,end:W};},findWrapper:function L(Y,W){var X=this.wrapperNodes(Y);return X&&X[W];},findIndex:function F(W,Z,Y){var X=this._nd2iw(W,Z,Y);return X?this._iw2idx(W,Z,X):-1;},itemOffsetTop:function V(X,b,W,Z){if(!Z){var Y=this.wrapperNodes(b);Z=Y&&Y[W];if(!Z){return 0;}}var a=b.firstChild;if(!a||(a===Z)){return 0;}else{return Z.offsetTop-a.offsetTop;}},whereDrop:function S(d,W,Y,c,X){var Z=this._nd2iw(d,W,Y),e,b,f;if(Z){b=this._iw2idx(d,W,Z);e=b;f=this.itemOffsetTop(d,W,null,Z);var a=Z.offsetHeight;if(c.y>X.top+f+a/2){e++;f+=a;}}else{return d.dropCuePos;}return{left:0,top:f,idx:e,idxActual:b};},getWrapperCss:function(W){return K;},postBuildRendering:function(a,Z,Y,X,W){U(X,this);},buildItemWrappers:function P(f,c,l,e,b,m){var n=this.itemWrapperPrefix(l),h=this.itemWrapperSuffix,a=n+this.itemWrapperPrefill+h,Z=[this.markupPrefix],X=1,W=l.selectedIndices||{},p=function o(k,j){for(var q=k;q<j;q++){Z[X++]=n;var r=c.build(l,e,f[q],q);if(W[q]){r=r.replace(/class\=\"([^\"]*)\"/,'class="$1 selected"');}Z[X++]=r;Z[X++]=h;}};var d=(f&&f.length)||0;b=b&&c?Math.min(b,d):0;if(b){p(0,b);}m=m&&c?Math.min(m,d-b):0;var g=d-m;for(var Y=b;Y<g;Y++){Z[X++]=a;}if(m){p(g,d);}Z.push(this.markupSuffix);return Z;},fillItemWrappers:function H(Y,h,e,n,g,X,c,m){var f=(h&&h.length)||0,l=this.wrapperNodes(Y),o=g.itemStatus,W=mstrmojo.css,a=n.selectedIndices||{};for(var d=X,j=Math.min(c+1,f),b=0;d<j;d++){if(o[d]!==A){l[d].innerHTML=e.build(n,g,h[d],d);if(a[d]){var Z=l[d].firstChild;if(Z){W.addClass(Z,["selected"]);}}b++;if(b===m){break;}}}return b;},onadd:function O(f,W,a,g){if(W&&g){var b=g.value.length,d=this.wrapperNodes(W),e=d[g.index],Z=this.getWrapperCss(f);for(var Y=0;Y<b;Y++){var X=this.createWrapperNode(W);X.className=Z;X.innerHTML=J;if(e){this.wrapperParentNode(W).insertBefore(X,e);}else{this.wrapperParentNode(W).appendChild(X);}}U(f,this);}},onremove:function Q(Z,d,W,Y){if(d&&Y){var b=this.wrapperNodes(d);if(b){var e=Y.value.length;for(var a=Y.index+e-1,X=Y.index;a>=X;a--){this.wrapperParentNode(d).removeChild(b[a]);}}U(Z,this);}},onchange:function R(h,Y,d,l){if(Y&&l){var e=this.wrapperNodes(Y);if(e){var X=mstrmojo.css,m=d.itemStatus,k;for(var c=0,W=l.removed,g=W&&W.length;c<g;c++){k=W[c];if(m[k]){X.removeClass(e[k].firstChild,["selected"]);}}for(var b=0,f=l.added,Z=f&&f.length;b<Z;b++){k=f[b];if(m[k]){X.addClass(e[k].firstChild,["selected"]);}}}}},_nd2iw:function E(X,a,Z){a=this.wrapperParentNode(a);if(a&&Z&&a!==Z){var W=X.domNode,Y=Z.parentNode;while(Y){if(Y===a){return Z;}if(Y===W){break;}Z=Y;Y=Z.parentNode;}}return null;},_iw2idx:function M(Y,c,b){var X=Y.items&&Y.items.length,Z=this.wrapperNodes(c),W=I.findBin(Z,b,"offsetTop",X);for(var a=W;a<X;a++){if(Z[a].offsetHeight){return a;}}return -1;},toPage:function(W,Y){var X=W.scrollboxNode;if(W.usePaging&&X){X.scrollTop=Y*B(W);}else{mstrmojo.alert("paging is not setup, can not perform paging.");}},whichPage:function(W){var X=W.scrollboxNode,Y=B(W);return Math.round((X&&Y&&X.scrollTop/Y)||0);},toItem:function(a,b){var Y=a&&a.itemsContainerNode,f=a.scrollboxNode,W=this.itemOffsetTop(a,Y,b),d=this.wrapperNodes(Y)[b].clientHeight,X=f.clientHeight,e=f.scrollTop,Z=e;if(W<e){Z=W;}else{if(e+X-d<W){Z=Math.min(W,W-X+d);}}f.scrollTop=Z;}});})();(function(){mstrmojo.requiresCls("mstrmojo.dom","mstrmojo.string","mstrmojo.css");var K=mstrmojo.css,N=mstrmojo.string,H=mstrmojo.dom,L=13,C=27;function I(U){if(this._editComplete){return ;}var Y,R=false,X=this.text,V=false;if(U===C){Y=X;V=true;R=true;}if((!U&&U!==0)||(!this.allowNewLine&&U===L)){var S=this[this.editableSlot],W=S.innerText||S.textContent||"";if(!this.allowNewLine){Y=W.replace(/\n/g,"");}else{Y=W;}R=true;if(!this.allowEmptyText&&Y.length===0){Y=X;V=true;}}if(R){this._editComplete=true;Y=Y.replace(/\u00A0/g,"\u0020");this.text=Y;this.set("isEditing",false);this.onTextEditComplete(Y!==X,X);delete this._editComplete;}if(V){this.refresh();}}function E(R){var S={dblclick:"editOnDoubleClick",click:"editOnClick"};if(this[S[R.name]]||(R.name==="click"&&this.editOnTwoClicks)&&R.getTarget()===this[this.editableSlot]){this.set("isEditing",true);}}function F(U,S,R){if(typeof S["on"+R]!=="function"){H.attachMarkupEvent(U,S,R);}}mstrmojo._HasEditableText=mstrmojo.provide("mstrmojo._HasEditableText",{_mixinName:"mstrmojo._HasEditableText",editableSlot:"domNode",editButtonSlot:null,isEditing:false,editOnClick:true,editOnTwoClicks:false,firstClickTime:undefined,allowEmptyText:false,allowTrimming:true,allowNewLine:false,editOnDoubleClick:false,onTextEditBegin:mstrmojo.emptyFn,onTextEditComplete:mstrmojo.emptyFn,postBuildRendering:function A(){this._super();var U=this.editableSlot,R=this[U],V=this[this.editButtonSlot||U];K.addClass(R,"hasEditableText");this.text=this.text||R.innerText||R.textContent||"";R.innerHTML=this.getEditableTextInnerHTML();var S=this.id;if(this.editOnClick||this.editOnTwoClicks){F(S,V,"click");}F(S,V,"dblclick");F(S,R,"blur");F(S,R,"keyup");F(S,R,"keydown");},getEditableTextInnerHTML:function Q(){return N.encodeHtmlString(this.text,true).replace(/ (?= )/g,"&nbsp;");},onclick:function P(R){if(this.editOnClick){E.call(this,R);}if(this._super){this._super(R);}},onTwoClicks:function(R){if(this.editOnTwoClicks){E.call(this,R);}if(this._super){this._super(R);}},ondblclick:function G(R){E.call(this,R);},onblur:function M(){I.call(this);},onkeyup:function B(S){var R=window.event||S.e;I.call(this,R.keyCode);},onkeydown:function J(S){var R=window.event||S.e;if(R.keyCode===L){I.call(this,R.keyCode);S.cancel();}},_set_text:function D(U,R){var S=this.text;this.text=R;if(this.hasRendered){this[this.editableSlot].innerHTML=N.encodeHtmlString(R||"",true);}return(S!==R);},onisEditingChange:function O(){if(this.hasRendered){var R=this[this.editableSlot],S=!!this.isEditing;R.contentEditable=S;R.spellcheck=false;K.toggleClass(R,"editable",S);if(S){R.focus();H.setElementSelection(R);this.onTextEditBegin();}else{R.blur();R.scrollLeft=0;}}}});}());(function(){mstrmojo.requiresCls("mstrmojo.dom","mstrmojo.css");var J={T:["top","left"],D:["height","width"],B:["border","border-color","border-style","border-width"],F:["font","color","text-decoration"],P:["padding"],BG:["background-color","fx"],RW:[]};J.RW=["z-index"].concat(J.T.concat(J.D));var D=mstrmojo.dom,O=mstrmojo.css;function N(U,W,S){var V=U[W]||[];V.push(S);U[W]=V;}function L(X,W){var V=((X&&X.fmts)||null);if(W){var Z=X.thresholds,U=Z&&Z[W];if(U){var Y={},a;for(a in V){Y[a]=U[a]||V[a];}for(a in U){var S=U[a];Y[a]=(typeof S==="string")?(S+" !important"):S;}V=Y;}}return V;}mstrmojo._Formattable=mstrmojo.provide("mstrmojo._Formattable",{_mixinName:"mstrmojo._Formattable",formatHandlers:null,thresholdId:null,getCacheKey:function E(){return"css_cache"+(this.thresholdId||"");},update:function G(U){var S=true;this.invisible=!!(U&&U.data&&U.data.invisible);if(this._super){S=this._super(U);}return S;},buildCSSFormatString:function H(V,e){var j=this.formatHandlers[V],l=j.src?e[j.src]:e;if(!l){return null;}var c=j.props||j;if(!c){return null;}var Y=[],h=-1;var W=c.length-1;for(W;W>=0;W--){var k=c[W];var d=J[k]||[k];var b=d.length-1;for(b;b>=0;b--){k=d[b];var U=l[k];if(U!==undefined){if(k==="fx"){var Z=U,S={};var g=Z.gd;if(g){this.formatGradient(g,S);}var X=parseInt(Z.rt,10);if(X){if(X===1||X===3){this.formatTextRotation(Z.rt,S);}}if(Z.ds){this.formatDropShadow(Z,S);}var a;for(a in S){Y[++h]=a+":"+S[a].join(" ");}}else{Y[++h]=k+":"+U;}}}}if(this.invisible){Y.push("visibility:hidden");}return Y.join(";")+";";},applyCSSFormatToNode:function I(V,S){var W=this[V],U=W&&W.style;if(U){this.buildCSSFormatString(V,S).split(";").forEach(function(X){var Y=X.split(":");U[O.convertCssToCamelCase(Y[0])]=Y[1];});}},clearSlotBackgroundCSS:function F(U){var V=this[U],S=V&&V.style;if(S){S.background="transparent none 0 0 no-repeat";S.filter="none";}},preBuildRendering:function B(){this._super();var W=this.formatHandlers,S=this.getFormats();if(W&&S){var X=this.defn=this.defn||{},Y=this.getCacheKey(),V=X[Y];if(!V){V=X[Y]={};for(var U in W){var a=U+"CssText";this[a]=V[a]=this.buildCSSFormatString(U,S)||"";}}else{var Z;for(Z in V){this[Z]=V[Z];}}}return true;},formatGradient:function P(S,V){var U=O.buildGradient(S.t,S.sc,S.ec);if(U){N(V,U.n,U.v);}},formatDropShadow:function K(X,V){if(D.supports(D.cssFeatures.DROP_SHADOW)){var W=X.ds;if(D.isDXIE){N(V,"filter","progid:DXImageTransform.Microsoft.DropShadow(Color='#66000000',Positive='true',OffX="+W+",OffY="+W+")");}else{var S=[W,W],U=parseInt(X.rt,10);if(U===1||U===3){S[((U===1)?1:0)]=-W;}N(V,(D.isWK?"-webkit-":"")+"box-shadow",S.join("px ")+"px 3px 0px #888");}}},formatTextRotation:function C(U,S){if(D.supports(D.cssFeatures.TEXT_ROTATION)){if(D.isDXIE){N(S,"filter","progid:DXImageTransform.Microsoft.BasicImage(rotation="+U+")");}else{var V=(U===1)?90:-90;N(S,D.CSS3_PREFIX+"transform-origin","top left");N(S,D.CSS3_PREFIX+"transform","rotate("+V+"deg)");}}},getFormats:function R(){if(!this.fmts){this.fmts=L.call(this,this.defn,this.thresholdId);}return this.fmts;},clearFormats:function A(){this.fmts=undefined;},createEmptyFormats:function(){return(this.fmts=this.fmts||{});},clearCache:function Q(){delete this.defn[this.getCacheKey()];},unrender:function M(S){if(this.thresholdId){this.fmts=null;}this._super(S);}});mstrmojo._Formattable.getBorderWidths=function(X){var W=X.getFormats(),S=(W.border)?W.border.match(/(\d*|\d*\.\d*)pt/)[0]:W["border-width"],V=X.model,U=V.docModel;return O.getBorderWidths(S,(U&&U.dpi)||V.dpi);};}());(function(){mstrmojo.requiresCls("mstrmojo.css","mstrmojo.dom","mstrmojo.fx");var e=mstrmojo.css,J=mstrmojo.dom,R=mstrmojo.array,N={v:{styleDim:"height",styleDir:"top",dimension:"h",position:"y",scroll:"scrollTop",scrollDimension:"scrollHeight",cls:"vertical",hostCls:"hasVertical",scrollNodeCls:"hasVertical"},h:{styleDim:"width",styleDir:"left",dimension:"w",position:"x",scroll:"scrollLeft",scrollDimension:"scrollWidth",cls:"horizontal",hostCls:"hasHorizontal",scrollNodeCls:"hasHorizontal"}},c="scrollingMode",V="scrolling",h=3;var O=J.getOSInfo().name.toLowerCase().indexOf("mac")>=0;function M(){return(this.scrollbarHostNode||(this.scrollNode&&this.scrollNode.parentNode));}function W(n,k){var m=this.scrollNode,j=M.call(this),l={v:n,h:k};R.forEach(["v","h"],function(p){var o=N[p];e.toggleClass(j,o.hostCls,l[p]);e.toggleClass(m,o.scrollNodeCls,l[p]);});}function S(k,j){var p=J.eventTarget(j,k),n=this.scrollNode,m=J.position(n),o=this.scrollTrackNodes,l=this.scrollBarNodes,q=function q(AB){var z=p===o[AB];if(z){var AC=N[AB],r=l[AB],AD=J.position(r),u=J.getMousePosition(k,j)[AC.position],w=u-AD[AC.position],t=w>0?1:-1,AA=n[AC.scrollDimension],AE=Math.abs(w-(AD.h/2))*(AA/m[AC.dimension]),x={};x[AC.scroll]={isStyle:false,start:n[AC.scroll],stop:n[AC.scroll]+(t*Math.min(AA/3,500,AE)),ease:mstrmojo.ease.linear};(new mstrmojo.fx.AnimateProp({props:x,duration:200,interval:10,target:n})).play();}};q.call(this,"h");q.call(this,"v");}function C(k,j){var n=this.scrollNode,m=k.type==="mousewheel",l=m?-1:1;mstrmojo.array.forEach(["h","v"],function(w){var t=N[w],p=m?"wheelDelta":"delta",r=k[p+{h:"X",v:"Y"}[w]]*l,q=Math.abs(r),o=r/q,u=q===3&&J.isFF&&!O;n[t.scroll]+=u?o*40:r;});J.stopPropogation(j,k);J.preventDefault(j,k);}function g(o){var n=N[o],m=this.scrollNode,l=J.position(m),k=l[n.dimension],p=m[n.scrollDimension],j=Math.ceil(k)/p;return A(j,k,p);}function A(k,j,l){return(!isNaN(k)&&k<1)&&(Math.abs(j-l)>h);}function D(AK){var AD="px",u=N[AK],n=this.scrollNode,w=M.call(this),AM=J.position(n),x=AM[u.dimension],AF=n[u.scrollDimension],m=Math.ceil(x)/AF,AJ=this.scrollBarNodes,r=AJ[AK],AB=this.scrollTrackNodes,AC=AB[AK],AH=A(m,x,AF),o=u.cls;if(!r){AC=AB[AK]=document.createElement("div");var p=this,AA=function(AO){S.call(p,AO);},t=function(AO){C.call(p,AO);},AG=function(AQ,AO,AP){J.attachEvent(AQ,AO,AP);p.installedEventListeners.push({e:AQ,evt:AO,fn:AP});};AG(AC,"click",AA);AC.className="mstrmojo-scrolltrack "+o;r=AJ[AK]=document.createElement("div");r.className="mstrmojo-scrollbar "+o;AC.appendChild(r);w.appendChild(AC);var AI=mstrApp.isSingleTier?"mousewheel":"wheel";AG(AC,AI,t);AG(r,AI,t);}var AN=r.style,q=(n[u.scroll]/n[u.scrollDimension]),k=J.delta(n,M.call(this))[u.position],AE=AC.style;if(AH){AE[u.styleDir]=k+AD;var l=m*x,z=35,AL=x*q,j=x-35;AN[u.styleDim]=(l<z?z:l)+AD;AN[u.styleDir]=(AL>j?j:AL)+AD;}return AH;}function I(){return !(mstrApp.isSingleTier&&O);}mstrmojo.ui._HasScroller=mstrmojo.provide("mstrmojo.ui._HasScroller",{_mixinName:"mstrmojo.ui._HasScroller",hasCustomScrollbar:null,draggable:true,ownAvatar:true,scrollNode:undefined,scrollbarHostNode:undefined,scrollBarNodes:undefined,setupScrollNodes:mstrmojo.emptyFn,installedEventListeners:null,init:function Y(j){this._super(j);if(this.hasCustomScrollbar===null){this.hasCustomScrollbar=I();}this.installedEventListeners=[];},onRender:function L(){if(this._super){this._super();}this.updateScrollbars();this.addScrollNodeProperties();},addScrollNodeProperties:function G(){var k=this.scrollNode,l=J.isFF&&!O;if(k){var j=J.attachMarkupEvent(this.id,k,"scroll");this.installedEventListeners.push({e:k,evt:"scroll",fn:j});}if(l){e.addClass(k,"firefox-on-windows");}else{if(J.isEdge){e.addClass(k,"ms-edge");}}if(!this.hasCustomScrollbar){e.addClass(M.call(this),"mstrmojo-sb-host-show-default");e.addClass(k,"mstrmojo-sb-show-default");return ;}if(k){e.addClass(M.call(this),"mstrmojo-scrollbar-host");e.addClass(k,"mstrmojo-scrollNode");}},updateScrollbars:function f(){if(!this.hasRendered){return ;}this.setupScrollNodes();var j,l=false;if(!this.hasCustomScrollbar){if(this.scrollNode){j=this.scrollNode.style;j.overflowY=g.call(this,"v")?"scroll":"hidden";j.overflowX=g.call(this,"h")?"scroll":"hidden";}return ;}if(this.scrollNode){this.scrollBarNodes=this.scrollBarNodes||{};this.scrollTrackNodes=this.scrollTrackNodes||{};W.call(this,l,l);j=this.scrollNode.style;var m=D.call(this,"v"),k=D.call(this,"h");j.overflowY=m?"scroll":"hidden";j.overflowX=k?"scroll":"hidden";W.call(this,m,k);}},onscroll:function b(){var q=this.scrollNode;if(q&&this.hasCustomScrollbar){var n=function n(r){var t=parseInt(r);return t===null||isNaN(t)?0:t;},o=J.position(q),p=o.h-n(e.getStyleValue(q,"padding-bottom")),k=o.w-n(e.getStyleValue(q,"padding-right")),m=this.scrollBarNodes,l=m.v,j=m.h;if(q.scrollHeight-p>0){l.style.top=((p-J.position(l).h)*(q.scrollTop/(q.scrollHeight-p)))+"px";}if(q.scrollWidth-k>0){j.style.left=((k-J.position(j).w)*(q.scrollLeft/(q.scrollWidth-k)))+"px";}}if(this._super){this._super();}if(this.onScrollEnd){this.onScrollEnd();}},getDragData:function F(k){var n=this.scrollNode,m=J.position(n),l=k.src.node,j=this.scrollBarNodes;if(this.isDraggingScrollBar(k)){return{isScrollBar:true,direction:l===j.v?"v":"h",scrollTop:n.scrollTop,scrollLeft:n.scrollLeft,conversionRatio:{y:n.scrollHeight/m.h,x:n.scrollWidth/m.w}};}return(this._super&&this._super(k));},isDragValid:function E(j){return this.isDraggingScrollBar(j)||(this._super&&this._super(j))||false;},isDraggingScrollBar:function X(k){var l=k.src.node,j=this.scrollBarNodes;return !!j&&(l===j.v||l===j.h);},ondragstart:function d(j){if(this.isDraggingScrollBar(j)){e.addClass(j.src.node,V);e.addClass(M.call(this),c);}if(this._super){this._super(j);}},shouldDragBubble:function U(j){var k=j.src.node,l=this.scrollTrackNodes;return !(!!l&&(k===l.v||k===l.h));},ondragmove:function Q(k){if(this.isDraggingScrollBar(k)){var t=k.tgt,j=k.src,u=t.pos,l=j.pos,p=j.node,o=this.scrollNode,r=this.scrollBarNodes,q=j.data,n={y:(u.y-l.y),x:(u.x-l.x)},m=q.conversionRatio;if(p===r.v){o.scrollTop=q.scrollTop+(n.y*m.y);}else{o.scrollLeft=q.scrollLeft+(n.x*m.x);}}if(this._super){this._super(k);}},ondragend:function K(j){if(this.isDraggingScrollBar&&this.isDraggingScrollBar(j)){e.toggleClass(j.src.node,V,false);e.toggleClass(M.call(this),c,false);}if(this._super){this._super(j);}},widgetResized:function P(){if(this._super){this._super();}this.updateScrollbars();},unrender:function Z(j){R.forEach(this.installedEventListeners,function(k){J.detachEvent(k.e,k.evt,k.fn);});this.installedEventListeners=[];delete this.scrollNode;delete this.scrollbarHostNode;delete this.scrollBarNodes;delete this.scrollTrackNodes;this._super(j);},getDefaultScrollBarProps:function a(j){return N[j];},disableScroll:function B(j,m){var l=this.scrollNode,k=M.call(this);R.forEach(["v","h"],function(o){var n=N[o];e.toggleClass(k,n.hostCls,false);e.toggleClass(l,n.scrollNodeCls,false);});if(l){if(m||m===undefined){l.style.overflowY="hidden";}else{if(l.style.overflowY==="hidden"){l.style.overflowY="auto";}}if(j||j===undefined){l.style.overflowX="hidden";}}},enableScroll:function H(){this.updateScrollbars();if(!this.hasCustomScrollbar&&this.scrollNode){this.scrollNode.style.overflowY=g.call(this,"v")?"scroll":"hidden";}},scrollIntoViewIfNeeded:function(m){var r=this.scrollNode,o=m.clientHeight,n=r.clientHeight,k=J.position(m).y,p=J.position(r).y,l=k-p,j=l<0,q=l+o>n;if(j||q){r.scrollTop+=l+o/2-n/2;}}});}());(function(){mstrmojo.requiresCls("mstrmojo.css");function B(){var D=this.maskNode,E=this.isMasked;D.style.display=E?"block":"none";mstrmojo.css.toggleClass(D,"masked",E);}mstrmojo.vi.ui._HasMask=mstrmojo.provide("mstrmojo.vi.ui._HasMask",{_mixinName:"mstrmojo.vi.ui._HasMask",isMasked:false,postBuildRendering:function C(){if(this._super){this._super();}B.call(this);},onisMaskedChange:function A(){if(!this.hasRendered){return ;}B.call(this);}});}());(function(){mstrmojo.requiresCls("mstrmojo.ListMapper");var D=1,B="mstrmojo-itemwrap";mstrmojo.ListMapperHoriz=mstrmojo.provide("mstrmojo.ListMapperHoriz",mstrmojo.hash.copy({markupPrefix:'<table class="mstrmojo-itemwrap-table" cellspacing="0" cellpadding="0"><tbody><tr>',markupSuffix:"</tr></tbody></table>",itemWrapperPrefix:function(H){return'<td class="'+this.getWrapperCss(H)+'">';},getWrapperCss:function(H){return"mstrmojo-itemwrap-td";},itemWrapperPrefill:"&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;",itemWrapperSuffix:"</td>",wrapperNodes:function G(H){return this.wrapperParentNode(H).cells;},wrapperParentNode:function F(H){return H.firstChild.rows[0];},createWrapperNode:function E(H){var I=H.ownerDocument,J=I.createElement("td");return J;},findScrollRange:function C(V,L,S,Y,I,P,Z,X){var Q=this.wrapperNodes(V),R=parseInt(L/2,10),K=parseInt(Math.log(L)/Math.log(2),10),J=0,H=L-1,U=I+P,M=Q[0].offsetLeft,O;for(var W=1;W<=K;W++){O=Q[R].offsetLeft-M+Z;if(O<=I){J=R;}else{if(O>=U){H=R;}}var N=Math.round(L/Math.pow(2,W+1));R+=(O>I)?-N:N;R=Math.min(Math.max(0,R),L-1);}return{start:J,end:H};},findIndex:function A(I,M,K){if(M&&K){var H=I.domNode,L=this.wrapperParentNode(M),J=K.parentNode;while(J){if(J===L){return mstrmojo.array.findBin(this.wrapperNodes(M),K,"offsetLeft",I.items&&I.items.length);}else{if(J===H){break;}}K=J;J=K.parentNode;}}return -1;}},mstrmojo.hash.copy(mstrmojo.ListMapper)));})();(function(){mstrmojo.requiresCls("mstrmojo.Obj","mstrmojo._LoadsScript","mstrmojo.Binding","mstrmojo._HasBindings","mstrmojo._HasMarkup","mstrmojo._HasTooltip","mstrmojo.css");mstrmojo.Widget=mstrmojo.declare(mstrmojo.Obj,[mstrmojo._LoadsScript,mstrmojo._HasBindings,mstrmojo._HasMarkup,mstrmojo._HasTooltip],{scriptClass:"mstrmojo.Widget",domNode:null,hasRendered:false,visible:true,enabled:true,tooltip:"",cssClass:"",cssText:"",cssDisplay:"block",slot:"",alias:"",parent:null,init:function A(C){this._super(C);var D=this.parent;if(!D||D.hasInitBindings){this.initBindings();}},destroy:function B(C){if(this.hasRendered){this.unrender(C);}if(this.bindings){this.destroyBindings();}this._super();},invalidate:mstrmojo.emptyFn,widgetResized:mstrmojo.emptyFn});mstrmojo.Widget.cssTextMarkupMethod=function(){this.domNode.style.cssText=this.cssText||"";};mstrmojo.Widget.visibleMarkupMethod=function(){this.domNode.style.display=(this.visible)?this.cssDisplay:"none";};mstrmojo.Widget.topMarkupMethod=function(){var C=this.top;if(C){this.domNode.style.top=C;}};mstrmojo.Widget.leftMarkupMethod=function(){var C=this.left;if(C){this.domNode.style.left=C;}};mstrmojo.Widget.heightMarkupMethod=function(){var C=this.height;if(C){this.domNode.style.height=C;}this.widgetResized();};mstrmojo.Widget.widthMarkupMethod=function(){var C=this.width;if(C){this.domNode.style.width=C;}this.widgetResized();};mstrmojo.Widget.enabledMarkupMethod=function(){mstrmojo.css.toggleClass(this.domNode,"disabled",!this.enabled);};}());(function(){mstrmojo.requiresCls("mstrmojo.hash","mstrmojo.WidgetListBuilder");mstrmojo.WidgetTreeBuilder=mstrmojo.provide("mstrmojo.WidgetTreeBuilder",mstrmojo.mixin({newContext:function A(B){var D=this._super(B);if(!B.itemFunction&&D.itemFunc){var C=D.itemFunc;D.itemFunc=function(G,F,H){var E=C(G,F,H);if(E){E.tree=H.tree||H;}return E;};}return D;}},mstrmojo.hash.copy(mstrmojo.WidgetListBuilder)));})();(function(){mstrmojo.requiresCls("mstrmojo.dom","mstrmojo.taphold");var A=false,Q=mstrmojo.dom,V=16;mstrmojo._HasContextMenu=mstrmojo.provide("mstrmojo._HasContextMenu",{cm:null,cmPos:null,itemField:"n",itemIdField:"did",itemChildrenField:"items",dynamicUpdate:false,queryChecked:function(W){return false;},queryEnabled:function(W){return true;},queryVisible:function(W){return true;},executeCommand:function P(W){},item2textCss:function E(W){return W.cssClass||W.cmdId||("cmd"+W[this.itemIdField]);},showContextMenu:function J(){if(!A){mstrmojo.requiresCls("mstrmojo.ContextMenu");A=true;}var c=this._subMenu,a=this.getMenuPosition();if(!c){var e=(this.menuZIndex||this.zIndex||10)+1,Y={left:a.x+"px",top:a.y+"px",zIndex:e,visible:false,dynamicUpdate:this.dynamicUpdate,itemField:this.itemField,itemIdField:this.itemIdField,itemChildrenField:this.itemChildrenField,_cmSource:this.getContextMenuSource(),items:this.getContextMenuItems(),cssClass:this.getContextMenuCssClass(),placeholder:document.body.appendChild(document.createElement("div")),parent:this};c=new mstrmojo.ContextMenu(Y);c.render();this._subMenu=c;}else{c.set("left",a.x+"px");c.set("top",a.y+"px");}if(this.dynamicUpdate){var X=c.ctxtBuilder.itemWidgets,Z=X&&X.length,W,b,d=this.getContextMenuSource();for(W=0;W<Z;W++){b=X[W];if(d.queryVisible){b.set("visible",d.queryVisible(b.data));}if(d.queryChecked){b.set("checked",d.queryChecked(b.data));}if(d.queryEnabled){b.set("enabled",d.queryEnabled(b.data));}}}c.set("visible",true);this.callOnContextMenuOpen();this.adjustMenuPosition();this.attachMousedownEvent();},hideContextMenu:function I(){var W=this._subMenu;if(W&&W.visible){this._subMenu.set("visible",false);this.callOnContextMenuClose();}},adjustMenuPosition:function O(){var W=this._subMenu,Z=this._subMenu.domNode,Y=Z.offsetHeight,X=Z.offsetWidth,c=Q.windowDim(),b=Q.position(Z,false),a=Q.position(Z,true);if((b.x+X+V)>c.w){W.set("left",(c.w-X-V+(a.x-b.x))+"px");}if((b.y+Y+V)>c.h){W.set("top",(c.h-Y-V+(a.y-b.y))+"px");}},attachMousedownEvent:function M(){var W=this;if(!this._close_handler){this._close_handler=function(X){W.closeMenuHandler(X);};}Q.attachEvent(document.body,"mousedown",this._close_handler);},closeMenuHandler:function R(W){if(!this.isOnMySubmenu(Q.eventTarget(self,W))){this.closeMenuTree();}},isOnMySubmenu:function N(a){var X=this._subMenu;if(!X){return false;}if(Q.contains(X.domNode,a,true,document.body)){return true;}var b=X.ctxtBuilder.itemWidgets,W=b&&b.length,Z,Y;for(Z=0;Z<W;Z++){Y=b[Z];if(Y.isOnMySubmenu(a)){return true;}}return false;},oncmChange:function K(){delete this._subMenu;},callOnContextMenuOpen:function D(){if(this.onContextMenuOpen){this.onContextMenuOpen();}},callOnContextMenuClose:function C(){if(this.onContextMenuClose){this.onContextMenuClose();}},getContextMenuItems:function U(){return this.cm;},getContextMenuCssClass:function B(){return this.cmCssClass||"";},getContextMenuSource:function H(){return this;},getMenuPosition:function F(){if(this.cmPos){return this.cmPos;}var W=Q.position(this.domNode,true);return{x:Math.round(W.x),y:Math.round(W.y+W.h)};},isSeparatorItem:function G(W){return W[this.itemIdField]===-1||W[this.itemField]==="-";},hasSubmenu:function L(W){return !!W[this.itemChildrenField];},closeMenuTree:function S(Y){var X=this.activeMenuItem,W=this._cmSource||this;if(!X){if(Y){this.activeMenuItem=Y;}else{W.hideContextMenu();}return ;}if(X===Y){return ;}if(Y){this.activeMenuItem=Y;if(Y.parent.parent===X){return ;}if(Y.parent===X.parent){X.hideContextMenu();return ;}}else{Y=W;this.activeMenuItem=null;}X.hideContextMenu();while(X!==W){X=X.parent.parent;if(X!==Y||W===Y){X.hideContextMenu();if(W===Y){Q.detachEvent(document.body,"mousedown",this._close_handler);}}if(X.parent===Y.parent){break;}}}});}());(function(){mstrmojo.requiresCls("mstrmojo.Obj","mstrmojo._LoadsScript","mstrmojo._HasChildren","mstrmojo.Binding","mstrmojo._HasBindings");mstrmojo.Model=mstrmojo.declare(mstrmojo.Obj,[mstrmojo._LoadsScript,mstrmojo._HasChildren,mstrmojo._HasBindings],{scriptClass:"mstrmojo.Model",init:function A(C){this._super(C);if(this.children){this.initChildren();}if(!this.parent){this.initBindings();}},destroy:function B(C){if(this.children){this.destroyChildren(true);}if(this.bindings){this.destroyBindings();}this._super(C);}});})();(function(){mstrmojo.requiresCls("mstrmojo.Obj");function B(J,I){this.raiseEvent({name:"viCompBuilt",type:J,widget:I});}mstrmojo.vi.models.VIComponentMap=mstrmojo.declare(mstrmojo.Obj,null,{scriptClass:"mstrmojo.vi.models.VIComponentMap",init:function G(I){this._super(I);this.relativePanels={};this.comps={};},addRelativePanel:function H(I){this.relativePanels[I]=true;},isRelativePanel:function F(I){return !!this.relativePanels[I];},isComponent:function C(J,I){return this.getComponentKey(J)===I;},getComponent:function A(I){return this.comps[I];},getComponentKey:function D(J){var I=this.getComponent(J);return(I&&I.k)||"";},createComponent:function E(L,K,J){B.call(this,L);var I=new K(J);this.comps[L]=I;B.call(this,L,I);return I;}});mstrmojo.vi.models.VIComponentMap.TYPES={FILTER_STACK:1,FILTER_PANEL:2,PAGEBY_STACK:3,PAGEBY_PANEL:4,VIZ_CONTENT:5,MAIN_CONTENT:6};}());(function(){mstrmojo.requiresCls("mstrmojo.Obj","mstrmojo.architect.EnumColumnDataTypes","mstrmojo.warehouse.EnumObjectTypes");var F=mstrmojo.string,C=mstrmojo.warehouse.EnumObjectTypes.COLUMN,A=mstrmojo.desc(11428,"[unknown]");function E(H){var G=mstrmojo.architect.EnumColumnDataTypes;return("["+G[H].n+"]"||A);}mstrmojo.architect.obj.Column=mstrmojo.declare(mstrmojo.Obj,null,{scriptClass:"mstrmojo.architect.obj.Column",init:function D(G){this._super(G);var I,H;if(G){if(G.dbInfo){I=G.dbInfo;this.cln=F.decodeHtmlString(I.cln).replace(/&apos;/g,"'");this.cmid=I.cmid;this.sta=parseInt(I.sta,10);this.dt={tp:I.dt.tp,ps:I.dt.prec,sc:I.dt.scl};this.n=this.cln+": "+this.getDataTypeName();}else{if(G.tableInfo){I=G.tableInfo;H=I.def;this.cln=F.decodeHtmlString(H.cln).replace(/&apos;/g,"'");this.cmid=I.did;this.dt={tp:H.dt.tp,ps:H.dt.ps,sc:H.dt.sc};this.n=this.cln;}else{if(G.colDef){H=G.colDef;this.cln=F.decodeHtmlString(H.cln).replace(/&apos;/g,"'");this.cmid="";this.dt={tp:H.dt.tp,ps:H.dt.ps,sc:H.dt.sc};this.n=this.cln;}}}}},cln:undefined,n:undefined,tp:C,t:C,cmid:undefined,def:undefined,dt:undefined,getDataTypeName:function B(){return E(this.dt.tp);}});}());(function(){mstrmojo.requiresCls("mstrmojo.Obj");var M=mstrmojo.DI.DIConstants,H=mstrmojo.array,D=M.dbType,F=M.xdaType,I=M.sourceType,K=M.backendSourceSubtype;mstrmojo.DI.DIDatabaseHelper=mstrmojo.declare(mstrmojo.Obj,null,null);mstrmojo.DI.DIDatabaseHelper.getImportOptionByDBType=function A(N){switch(N){case D.SAP:case D.MSFT_AS:case D.ESSBASE:case D.TM1:case D.PIG:return false;default:return true;}};mstrmojo.DI.DIDatabaseHelper.getSourceTypeByDBType=function E(N){switch(N){case D.SAP:case D.MSFT_AS:case D.ESSBASE:case D.TM1:return F.mdx;case D.PIG:return F.ffsql;default:return -1;}};mstrmojo.DI.DIDatabaseHelper.getDescriptionIdByDBType=function(N){switch(N){case D.MS_ACCESS:return 9149;case D.ORACLE:return 8545;case D.SQL_SERVER:return 8552;case D.INFORMIX:return 12995;case D.SYBASE:return 12998;case D.REDBRICK:return 10059;case D.DB2:return 8516;case D.TERADATA:return 8553;case D.SAP:return 13107;case D.NETEZZA:return 8558;case D.EXCEL:return 3958;case D.MSFT_AS:return 13225;case D.ESSBASE:return 13224;case D.MYSQL:return 8556;case D.POSTGRESQL:return 8541;case D.COMPOSITE:return 12991;case D.ASTER:return 10058;case D.VERTICA:return 10062;case D.PARACCEL:return 10056;case D.TM1:return 13223;case D.XQUERY:return 8560;case D.HIVE:return 8561;case D.SALESFORCE:return 9213;case D.SAPHANA:return 12997;case D.GOOGLE_BIGQUERY:return 12450;default:return 4444;}};mstrmojo.DI.DIDatabaseHelper.getOASTFromBEST=function L(N){switch(N){case K.googleBigQuery:case K.googleBigQueryFFSQLModel:case K.googleBigQuerySingleTable:return I.googleBigQuery;case K.dropbox:return I.dropbox;case K.googleAnalytics:return I.googleAnalytics;case K.googleDrive:return I.googleDrive;case K.facebook:return I.facebook;case K.twitter:return I.twitter;case K.salesforce:return I.salesforce;default:return -1;}};mstrmojo.DI.DIDatabaseHelper.isOAuthSourceType=function C(N){var O=[I.googleBigQuery,I.dropbox,I.googleAnalytics,I.googleDrive,I.facebook,I.twitter,I.salesforce];return H.indexOf(O,N)!==-1;};mstrmojo.DI.DIDatabaseHelper.filterDBById=function B(P,N,O){return H.filter(P,function(S){var R=H.indexOf(N,S.id),Q;if(R>-1){Q=O;}else{Q=!O;}return Q;});};mstrmojo.DI.DIDatabaseHelper.filterDBByDispOption=function B(P,N,O){return H.filter(P,function(R){var Q=false;if((R.disp&N)===N){H.forEach(O,function(S){if(R.id===S){Q=true;return false;}});return !Q;}});};mstrmojo.DI.DIDatabaseHelper.getDBIds=function J(O){var N=[];H.forEach(O,function(P){N=N.concat(P.id);});return N;};mstrmojo.DI.DIDatabaseHelper.getUniqueDBTypes=function G(P){var O=[],N;H.forEach(P,function(Q){N=H.indexOf(O,Q.dbType);if(N<0){O.push(Q.dbType);}});return O;};mstrmojo.DI.DIDatabaseHelper.filterDBByAdminConfig=function(O,N){return H.filter(O,function(R){var P=H.indexOf(N,R.id),Q=true;if(P>=0){Q=false;}return Q;});};}());(function(){mstrmojo.requiresCls("mstrmojo.Obj","mstrmojo.hash","mstrmojo._Fetchable");var A=mstrmojo.hash;mstrmojo.mstr.DocElementDataHelper=mstrmojo.declare(mstrmojo.Obj,[mstrmojo._Fetchable],{scriptClass:"mstrmojo.mstr.DocElementDataHelper",source:null,items:null,browseConfig:null,concat:true,init:function(B){var C=B&&B.browseConfig;this.blockBegin=(C&&C.blockBegin)||1;this.blockCount=(C&&C.blockCount)||mstrApp.elementsBlockCount||30;if(this._super){this._super(B);}},getBrowseConfig:function(){if(!this.browseConfig){this.browseConfig={blockBegin:this.blockBegin,blockCount:this.blockCount};}return this.browseConfig;},_retrieveItems:function(E,C,B){var D=this.getBrowseConfig();D.blockBegin=E;mstrmojo.func.override({success:function(F){if(this._super){this._super(mstrmojo.hash.copy(F,{items:F.es,totalSize:F.sz}));}}},C);this.source.browseElements(D,C,B);}});}());(function(){mstrmojo.requiresCls("mstrmojo.hash","mstrmojo.func","mstrmojo.Obj");var K=mstrmojo.hash;var P=0;var F=[];var J={};var L=false;function I(U){var V=U.callback;if(V.submission){V.submission(U.id,this.userInteractionRequired(U),U);}this.submitRequest(U);}function G(){if(F.length&&!L){I.call(this,F.shift());}}mstrmojo.ServerProxy=mstrmojo.declare(mstrmojo.Obj,null,{scriptClass:"mstrmojo.ServerProxy",transport:null,cnt:0,request:function E(e,b,V,W){if(V){this.cancelRequests();}var Y=this.id,Z=this.transport,U=mstrmojo.now()+b.taskId+P++,X=e.canceled||mstrmojo.emptyFn;e.canceled=function(f){X();e.complete(true);return Z.cancelRequest(f);};e=mstrmojo.func.wrapMethods(e,{complete:function(f){mstrmojo.all[Y]&&mstrmojo.all[Y].deleteRequest(f);}});var a=!K.isEmpty(this._requests),c=this.createRequest(U,e,b,W),d=(L||a)&&!W.doNotHold;if(d){F.push(c);}else{I.call(this,c);}return U;},hasRequests:function O(){return !K.isEmpty(this._requests)||L;},createRequest:function Q(W,Y,X,U){var V=this._requests;if(!V){V=this._requests={};}V[W]={id:W,callback:Y,params:X,config:U};return V[W];},submitRequest:function M(U){this.transport.serverRequest(this.id,U.id,U);},cancelRequests:function S(){var U=false;K.forEach(this._requests,function(V){if(V.gotResponse===undefined){U|=V.callback.canceled(V.id);}});this._requests={};F=[];return U;},cancelRequest:function B(Y){var V=false,X=this._requests[Y],W,U=F.length;for(W=0;W<U;W++){if(F[W]===X){break;}}if(W<U){F.splice(W,1);delete this._requests[Y];V|=X.callback.canceled(X.id);}return V;},response:function A(Y,U,W){$MAPF(false,"AndroidServerTransport","transportRequest");var X=this.getRequest(Y);if(X){X.gotResponse=true;var Z=X.callback,V=(U&&!W.mstrerr)?"success":"failure";try{if(Z[V]){Z[V](W,X);}}finally{Z.complete(Y);}}G.call(this);},deleteRequest:function N(V){var U=this._requests;delete U[V];},getRequest:function H(V){var U=this._requests;return U&&U[V];},userInteractionRequired:function C(U){return false;},addLoadingGraph:function D(U){J[U]=true;L=true;},removeLoadingGraph:function R(U){delete J[U];if(K.isEmpty(J)){L=false;G.call(this);}},_serverRequestParallel:function(V,X,Y,U){var W=U||new mstrmojo.SimpleXHR();W.request("POST",V,{success:function(Z){if(Y.success){Y.success(Z);}},failure:function(Z){if(Y.failure){Y.failure({code:Z.getResponseHeader("X-MSTR-TaskErrorCode"),message:Z.getResponseHeader("X-MSTR-TaskFailureMsg")});}},complete:function(){if(Y.complete){Y.complete();}}},X);},serverRequestParallel:function(V,W,U){this._serverRequestParallel(mstrConfig.taskURL,V,W,U);},upload:function(a,Z,Y,V,X,W,U){mstrmojo.xhr.upload("POST",mstrConfig.taskURL,a,Z,Y,V,X,W,U);}});}());(function(){mstrmojo.requiresCls("mstrmojo.Obj");mstrmojo.StepperContentProvider=mstrmojo.declare(mstrmojo.Obj,null,{scriptClass:"mstrmojo.StepperContentProvider",item:null,renderer:null,min:null,max:null,interval:1,minField:"min",maxField:"max",maxLengthField:"maxLength",valField:"value",intField:"interval",canLoop:false,next:mstrmojo.emptyFn,prev:mstrmojo.emptyFn,hasPrev:mstrmojo.emptyFn,hasNext:mstrmojo.emptyFn,renderItemAt:mstrmojo.emptyFn,setVal:mstrmojo.emptyFn,getVal:mstrmojo.emptyFn});}());(function(){mstrmojo.requiresCls("mstrmojo.array","mstrmojo.Obj","mstrmojo.string","mstrmojo.hash","mstrmojo.expr","mstrmojo.num","mstrmojo.mstr.EnumNodeDimty");var G=mstrmojo.array,S=mstrmojo.expr,L=S.ET,K=S.TP,D=S.DTP,M=mstrmojo.mstr.EnumNodeDimty,P=S.ET2TGT,O=S.ET2COND,C=mstrmojo.meta.TP,B=mstrmojo.num;function Q(W,A){var V=(A&&A.did)?A.did.split(S.FN_SEP):null,E=V&&parseInt(V[0],10),U=V&&parseInt(V[1],10),X=W.et;W.fnt=E;W.fn=U;if(X!=L.AE&&S.fn_List(U,E)){W.et=L.AL;W.a2=null;W.cs=null;}else{if(X==L.AL&&!S.fn_List(U,E)){W.et=L.AQ;W.cs=null;}else{if(X==L.MC&&!S.fn_AC_MC(U,E)){W.et=L.MQ;W.m2=null;}else{if(X==L.AC&&!S.fn_AC_MC(U,E)){W.et=L.AQ;W.a2=null;}}}}switch(U){case S.FN.IS_NULL:case S.FN.IS_NOT_NULL:W.a2=null;W.a3=null;W.fm2=null;W.fm3=null;W.m2=null;W.m3=null;W.cs=null;break;case S.FN.BETWEEN:case S.FN.NOT_BETWEEN:break;default:W.a3=null;W.fm3=null;W.m3=null;while(W.cs&&W.cs.length>1){W.cs.pop();}}}function H(Z,a,b){var E=2+a,X;if(B.isBigDecimal(b.v)){b.dtp=D.BIGDECIMAL;}switch(b.t){case K.PROMPT:X=Z.cs;var Y;if(!X){X=[];Z.cs=X;}X[a]={};Y=X[a];Y.p=b;Z["a"+E]=null;Z["m"+E]=null;switch(Z.et){case L.AC:Z.et=L.AQ;break;case L.MC:Z.et=L.MQ;break;}break;case K.METRIC:Z["a"+E]=null;Z.cs=null;Z.et=L.MC;Z["m"+E]=b;break;case K.ATTR:Z["m"+E]=null;Z.cs=null;Z.et=L.AC;Z["a"+E]=b;Z["fm"+E]=null;break;default:Z["a"+E]=null;Z["m"+E]=null;X=Z.cs;if(!X){X=[];Z.cs=X;}if("did" in b){Z["a"+E]=null;Z["fm"+E]=null;Z["m"+E]=null;if(X[a]&&X[a].p){X[a].p=null;}}else{if(b&&b.v!=null){X[a]=b;}else{if(X[a]&&Z.et!==L.AL){X=X.splice(a,1);}}}if(!b.skipET){switch(Z.et){case L.MC:if((!Z.c2||!Z.m3)&&(!Z.m2||!Z.c3)){Z.et=L.MQ;}break;case L.AC:Z.et=L.AQ;break;case L.AL:if(!("did" in b)&&b.v){var A,V=b.dtp;X=[];A=b.v.split(mstrConfig.listSep);for(var U=0,W=A.length;U<W;U++){X.push({v:mstrmojo.string.trim(A[U]),dtp:V});}Z.cs=X;}break;}}}}var J={};J[L.AQ]={target:1,fm:1,fn:1,cs:1};J[L.AL]={target:1,fm:1,fn:1,cs:1};J[L.AE]={target:1,fn:1,es:1};J[L.AC]={target:1,a2:1,a3:1,fm:1,fm2:1,fm3:1,fn:1};J[L.MQ]={target:1,fn:1,cs:1,dmy:1};J[L.MC]={target:1,fn:1,m2:1,m3:1,dmy:1};J[L.F]={target:1};J[L.R]=J[L.F];J[L.XML]={target:1};J[L.ANDOR]={target:1};var I=function(A){return A!==null&&A!==undefined;};var N=function(a){if(a.data){return true;}if(!a||!I(a.et)){return false;}var Z=true,A=J[a.et],X=a.cs,W;Z=Z&&(!A.target||a[P[a.et]]);Z=Z&&(!A.fm||a.fm);Z=Z&&(!A.fn||I(a.fn));var V=S.fnCstCount(a.fn,a.fnt);if(Z&&A.cs){for(W=0;W<V;W++){Z=Z&&X&&I(X[W]);}}if(Z){var Y=[P[a.et],"fm"];for(var E=0;E<2;E++){for(W=0;W<V;W++){var b=Y[E]+(2+W);Z=Z&&(!A[b]||a[b]);}}}Z=Z&&(!A.es||a.es&&(a.es.length>0));var U=a.dimtyTypes;Z=Z&&(!A.dmy||U[M.NodeDimtyUnspecified]||U[M.NodeDimtyNone]||(U[M.NodeDimtyOutputLevel]&&a.dmy&&a.dmy.uts&&(a.dmy.uts.length>0)));return Z;};mstrmojo.ConditionModel=mstrmojo.declare(mstrmojo.Obj,null,{scriptClass:"mstrmojo.ConditionModel",data:null,completed:false,defaultETAttr:L.AQ,init:function(A){if(this._super){this._super(A);}this._updateCompleted();},edit:function R(p,f,AC){var W=this[p];if(W===f){return ;}this.etWas=this.et;switch(p){case"not":f=!!(f&&f.did===S.FN.NOT);W=!!this.not;if(f===W){return ;}this.not=!!f||null;break;case"target":var AG=this.et;if(f){switch(f[C]){case K.ATTR:case K.CONS:W=this.a;if(AG!==L.AQ&&AG!==L.AE&&AG!==L.ANDOR){this.et=this.defaultETAttr;this.m=null;this.m2=null;this.m3=null;this.r=null;this.f=null;}if(AG!==L.AE){this.fn=null;this.fnt=null;}this.fm=null;this.fm2=null;this.fm3=null;this.cs=null;break;case K.METRIC:W=this.m;if((AG!==L.MQ)&&(AG!==L.MC)){this.et=L.MQ;this.fm=null;this.fm2=null;this.fm3=null;this.fn=null;this.fnt=null;this.a=null;this.a2=null;this.a3=null;this.r=null;this.f=null;this.cs=null;this.dmt=M.NodeDimtyUnspecified;}this.m2=null;break;case K.REPORT:W=this.r;if(AG!==L.R){this.et=L.R;this.fm=null;this.fm2=null;this.fm3=null;this.fn=null;this.fnt=null;this.a=null;this.a2=null;this.a3=null;this.m=null;this.m2=null;this.m3=null;this.f=null;}break;case K.FILTER:W=this.f;if(AG!==L.F){this.et=L.F;this.fm=null;this.fm2=null;this.fm3=null;this.fn=null;this.fnt=null;this.a=null;this.a2=null;this.a3=null;this.m=null;this.m2=null;this.m3=null;this.r=null;}break;case K.PROMPT:W=this.prms&&this.prms[0];if(AG!==L.XML){this.et=L.XML;this.fm=null;this.fm2=null;this.fm3=null;this.fn=null;this.fnt=null;this.a=null;this.a2=null;this.a3=null;this.m=null;this.m2=null;this.m3=null;this.r=null;this.f=null;}break;}}this.es=null;this.data=null;this[P[this.et]]=f;break;case"fm":if(f&&f[C]==="fn"){this.et=L.AE;this.fm=null;Q(this,f);}else{this.fm=f;if(f&&(this.et==L.AE)){this.et=L.AQ;}this.fnt=null;this.fn=null;this.cs=null;this.a2=null;this.fm2=null;}break;case"fm2":case"fm3":this[p]=f;break;case"fn":Q(this,f);break;case"es":var AJ=this.es;if(f&&f.removed&&AJ){G.removeItems(AJ,f.itemIdField,f.removed);}if(f&&f.added){if(!AJ){AJ=f.added.concat();this.es=AJ;}else{G.insert(AJ,AJ.length,f.added);}}break;case"c0":H(this,0,f);break;case"c1":H(this,1,f);break;case"dmy":var AD=this.dmy;if(!AD){AD={cc:true,fres:true,uts:[]};this.dmy=AD;}var z=AD&&AD.uts;if(!z){z=[];AD.uts=z;this.dmt=M.NodeDimtyOutputLevel;}var U={};U[S.TP.ATTR]=true;U[S.TP.DIM]=true;if(f&&f.removed){var k=[],A=false,d=[],V=false;for(var o=0,X=f.removed,E=X.length;o<E;o++){var Z=X[o],AF=Z[C] in U;if(AF){V=true;}else{A=true;}var m=AF?d:k;m.push(Z);}if(A){G.removeItems(z,"did",k);}if(V){var AI={};for(var h=0,g=z&&z.length;h<g;h++){var e=z[h];if(e&&e.utgt){AI[e.utgt.did]=h;}}var Y=[];for(var AE=0,AB=d.length;AE<AB;AE++){var l=AI[d[AE].did];if(l>-1){Y.push(l);}}Y.sort(G.numSorter);for(var x=Y.length-1;x>-1;x--){z.splice(Y[x],1);}}}if(f&&f.added){var AK=[],q=S.DMY_TP.DIM,w=S.DMY_TP.ATTR;for(var AH=0,AA=f.added,j=AA.length;AH<j;AH++){var t=AA[AH];AK.push((t[C] in U)?{utgt:t,utp:t[C]===K.DIM?q:w,agg:1,flt:2,gb:true,rps:0,n:t.n}:t);}G.insert(z,z.length,AK);}break;case"data":this.data=f;break;}this._updateCompleted();if(!AC){this.raiseEvent({name:"edit",prop:p,value:f,valueWas:W});}},get:function F(){var A=this.data?this.data:this;var E=O[A.et]||[];E.push("et");return mstrmojo.hash.copyProps(E,A);},_updateCompleted:function(){this.set("completed",N(this));}});})();(function(){mstrmojo.requiresCls("mstrmojo.Obj","mstrmojo.DI.DIConstants","mstrmojo.hash");mstrmojo.requiresDescs(96,198,5720,10399,10492,11960,12676,12677,12678,12955,12957,12958,12960,12961,12962,12963,12964,12965,12966,12967,12968,13096,13097,14193,16038);var An=mstrmojo.hash;var e=mstrmojo.DI.DIConstants.sourcesInfoFlags;var Aq=mstrmojo.desc(12676,"Fetching files...");var Ac=mstrmojo.desc(12677,"Fetching Cube Information...");var Ag=mstrmojo.desc(5720,"Waiting...");var Q=mstrmojo.desc(10492,"Saving...");var AB=mstrmojo.desc(14193,"Searching Data...");var Aj=mstrmojo.DI.DIConstants;function Aa(BA,A9,A7,A8){mstrApp.serverRequest(A9,BA,A7,undefined,undefined,undefined,undefined,A8);}mstrmojo.DI.DIDataService=mstrmojo.declare(mstrmojo.Obj,null,{messageID:"",emmaIRRMessageID:"",archSpark:function t(A9,A8,A7){Aa.call(this,A9,An.copy(A8,{taskId:"arch.spark"}),{showProgress:true,showProgressText:true,},A7);},deleteObject:function V(A8,A7){Aa.call(this,A8,An.copy(A7,{taskId:"deleteObject"}),{showProgress:true,showProgressText:true,progressText:mstrmojo.desc(10399,"Deleting")});},renameObject:function V(A8,A7){Aa.call(this,A8,An.copy(A7,{taskId:"renameObject"}),{showProgress:true,showProgressText:true,progressText:mstrmojo.desc(13973,"Renaming")});},getCubeQuota:function P(A9,A8,A7){Aa.call(this,A9,An.copy(A8,{taskId:"qBuilder.GetQuota"}),A7||{showProgress:false,showProgressText:false,progressText:mstrmojo.desc(12955,"Getting information about your cubes...")});},getUserDICubeInfo:function b(A8,A7){Aa.call(this,A8,An.copy(A7,{taskId:"getUserDICubeInfo"}),{showProgress:false,showProgressText:false});},getDBMSObjects:function Z(A8,A7){Aa.call(this,A8,An.copy(A7,{taskId:"arch.getDBObjects"}),{doNotHold:true,showProgress:false});},getExternalSourcesInfo:function Ar(A8,A7){Aa.call(this,A8,An.copy(A7,{taskId:"getDIExternalInfo"}),{showProgress:true,showProgressText:true,progressText:mstrmojo.desc(12955,"Getting information about your cubes...")});},getDIProjectSettings:function r(A8,A7){Aa.call(this,A8,An.copy(A7,{taskId:"getDIProjectSettings"}),{showProgress:true,showProgressText:true,progressText:mstrmojo.desc(12957,"Fetching Data Import Settings...")});},getOAuthSourceReports:function Ax(A9,A8){var A7=e.getReports|e.getTokensInfo|e.getUserName;Aa.call(this,A9,An.copy(A8,{taskId:"qBuilder.FetchSourceObjects",flags:A7|(A8.flags||A7)}),{showProgress:true,showProgressText:true,progressText:Aq});},getHadoopFolderSize:function AW(A9,A8){var A7=e.getReports|e.getTokensInfo|e.getUserName;Aa.call(this,A9,An.copy(A8,{taskId:"qBuilder.FetchSourceObjects",flags:A7|(A8.flags||A7)}),{showProgress:false,showProgressText:false});},browseURLPath:function AJ(BA,A9){var A8=1,A7;if(A9.flags){A7=A9.flags|A8;}else{A7=A8;}Aa.call(this,BA,An.copy(A9,{taskId:"qBuilder.FetchSourceObjects",flags:A7}),{showProgress:true,showProgressText:true,progressText:Aq});},getShapeKeys:function Az(A8,A7){Aa.call(this,A8,An.copy(A7,{taskId:"getMapShapes",showWait:false}),{doNotHold:true,showProgress:false});},getWebServiceURL:function O(A8,A7){Aa.call(this,A8,An.copy(A7,{taskId:"GetWebServiceURL"}),{showProgress:true,showProgressText:true,progressText:mstrmojo.desc(12678,"Fetching Web Service URL for authorization...")});},getWebServiceCatalog:function c(A8,A7){Aa.call(this,A8,An.copy(A7,{taskId:"GetWebServiceCatalog"}),{showProgress:true,showProgressText:true,progressText:Aq});},signOutOAuthSource:function o(A8,A7){Aa.call(this,A8,An.copy(A7,{taskId:"qBuilder.FetchSourceObjects",flags:e.revokeSession}),{showProgress:true,showProgressText:true,progressText:mstrmojo.desc(12960,"Signing out...")});},importOAuthReport:function E(A8,A7){Aa.call(this,A8,An.copy(A7,{taskId:"qBuilder.ImportSourceObject",flags:7}),{showProgress:true,showProgressText:true,progressText:mstrmojo.desc(12961,"Uploading data...")});},importURL:function AS(A8,A7){Aa.call(this,A8,An.copy(A7,{taskId:"importFile",taskContentType:"json",taskEnv:"xhr",messageid:this.messageID}),{showProgress:true,showProgressText:true,progressText:mstrmojo.desc(12962,"Fetching data from the given URL...")});},importFile:function AH(A7,A9,A8){A7.submit(An.copy(A8,{taskId:"importFile",taskContentType:"json",taskEnv:"xhr",fileType:"application/octet-stream"}),A9,{showProgress:true,showProgressText:true,showCancel:true,onCancel:function(){mstrmojo.xhr.cancel();mstrApp.serverProxy.cancelFileReader&&mstrApp.serverProxy.cancelFileReader(A8.tableID);mstrApp.hideProgress();if(A9.cancel){A9.cancel();}},progressText:mstrmojo.desc(16038,"Uploading File #...").replace("#",A8.fileName)});},oneTierImportFile:function X(A8,A7){Aa.call(this,A8,An.copy(A7,{taskId:"importFile"}),{showProgress:true,showProgressText:true,progressText:mstrmojo.desc(12963,"Uploading File...")});},launchOneTierBrowser:function Ao(A7){window.FormWrapper.openFileDialog(A7);},launchOneTierUploader:function W(A8,A7){Aa.call(this,A8,An.copy(A7,{taskId:"onetier.import"}),{showProgress:true,showProgressText:true,progressText:mstrmojo.desc(11960,"Loading Data...")});},createOneTierDoc:function Al(A8,A7){Aa.call(this,A8,An.copy(A7,{taskId:"onetier.createVI"}),{showProgress:true,showProgressText:true,progressText:Ag});},handleMissingColumns:function Am(A8,A7){Aa.call(this,A8,An.copy(A7,{taskId:"recoverDataDiscoveryErrors",msgid:this.messageID}),{showProgress:true,showProgressText:false,progressText:""});},getImportedData:function d(BA,A9,A7){var A8;if(!A9.browsetype){A9.browsetype=mstrmojo.DI.DIConstants.browseFlag.dataPreview|mstrmojo.DI.DIConstants.browseFlag.reportBindingTable|mstrmojo.DI.DIConstants.browseFlag.reportLevelProperty;}if(A9.previewflag){A9.previewflag|=mstrmojo.DI.DIConstants.requestFlag.stateInfo;}if(!A9.bindingflag){A8=2;}else{A8=A9.bindingflag;}Aa.call(this,BA,An.copy(A9,{taskId:"qBuilder.GetReportXDADefinition",msgid:this.messageID,bindingflag:A8}),{showWait:true,showProgress:true,showProgressText:true,progressText:Ag});},editImportedData:function m(A8,A7){Aa.call(this,A8,An.copy(A7,{taskId:"editCube",msgID:this.messageID}),{showProgress:true,showProgressText:true,progressText:(A7.trans?mstrmojo.desc(12964,"Transforming data..."):Ac)});},loadProject:function A6(A8,A7){Aa.call(this,A8,An.copy(A7,{taskId:"getProjects"}),A8,{showProgress:true,showProgressText:true,progressText:(mstrmojo.desc(12965,"Fetching Projects Information..."))});},loginProject:function A6(A8,A7){Aa.call(this,A8,An.copy(A7,{taskId:"login"}),A8,{showProgress:true,showProgressText:true,progressText:(mstrmojo.desc(12966,"Login Projects..."))});},changeMappings:function A0(A8,A7){Aa.call(this,A8,An.copy(A7,{taskId:"qBuilder.RemapObject",msgid:this.messageID}),{showProgress:true,showProgressText:true,progressText:Q});},saveAndPublish:function n(A8,A7){Aa.call(this,A8,An.copy(A7,{taskId:"saveAndPublishCube",msgID:this.messageID}),{showProgress:true,showProgressText:true,progressText:Ag});},saveAndPublishEMMA:function k(BD,BC,BA,A9){var BB=An.copy(BC,{taskId:"saveAndPublishCube",msgID:this.messageID});var A8=this;var A7={success:function(BE){if(BE.msgId){A8.messageID=BE.msgId;}mstrApp.getRootController().model.getHistoryList().set("canSendToHistoryList",true);}};if(BA){BA.saveParams=BB;BA.saveAsCallback=function(){return mstrmojo.func.wrapMethods(A7,BD,{});};if(!BA.visible){BA.open();}}else{Aa.call(this,mstrmojo.func.wrapMethods(A7,BD,{}),BB,A9||{showProgress:false});}},pollStatus:function As(A8,A7){Aa.call(this,A8,An.copy(A7,{taskId:"pollStatus",resultSetType:3,pollingFrequency:500,maxWait:60000,taskEnv:"xhr",taskContentType:"json",msgID:this.messageID}),{showProgress:true,showProgressText:true,progressText:Ag});},pollEmmaStatus:function H(A8,A7){Aa.call(this,A8,An.copy(A7,{taskId:"pollEmmaStatus",resultSetType:3,pollingFrequency:500,maxWait:60000,taskEnv:"xhr",taskContentType:"json",msgID:this.messageID}),{showProgress:false});},fetchFolderContents:function Ab(A8,A7){Aa.call(this,A8,An.copy(A7,{taskId:"searchMetadata",styleName:"MojoFolderStyle",includeAncestorInfo:false,includeObjectDesc:false,fields:"name"}),{showProgress:true,showProgressText:true,progressText:mstrmojo.desc(12967,"Fetching folder contents...")});},searchFolderContents:function AX(A8,A7){Aa.call(this,A8,An.copy(A7,{taskId:"searchMetadata",styleName:"MojoFolderStyle",includeAncestorInfo:false,includeObjectDesc:false,fields:"name",recursive:0}),{showProgress:true,showProgressText:true,progressText:Ag});},fetchRemoteFolderContents:function p(A8,A7){Aa.call(this,A8,An.copy(A7,{taskId:"getFolderContentFromRemote",msgid:this.messageID,type:8,flags:268453447}),{showProgress:true,showProgressText:true,progressText:mstrmojo.desc(12967,"Fetching folder contents...")});},fetchRemoteFolderID:function a(A8,A7){Aa.call(this,A8,An.copy(A7,{taskId:"getFolderIDFromRemote",folderName:7,msgid:this.messageID}),{showProgress:true,showProgressText:true,progressText:mstrmojo.desc(13096,"Fetching remote folder id...")});},getProjectsFromRemote:function AV(A8,A7){Aa.call(this,A8,An.copy(A7,{taskId:"getProjectsFromRemote",msgid:this.messageID,sessionState:mstrApp.sessionState}),{showProgress:true,showProgressText:true,progressText:mstrmojo.desc(13097,"Fetching remote projects...")});},createEMMAReportInstance:function F(BA,A9){var A8=this;var A7={success:function(BB){if(BB&&BB.msgid){A8.set("messageID",BB.msgid);}}};Aa.call(this,mstrmojo.func.wrapMethods(A7,BA,{}),An.copy(A9,{taskId:"DICreateEMMAReportInstance"}),{showProgress:true,showProgressText:true,progressText:Ag});},createEMMASourceTable:function Au(BA,A9){var A8=this;var A7={success:function(BB){if(BB&&BB.msgid){A8.set("messageID",BB.msgid);}}};Aa.call(this,mstrmojo.func.wrapMethods(A7,BA,{}),An.copy(A9,{taskId:"DICreateEMMASourceTable",msgid:this.messageID}),{showProgress:true,showProgressText:true,progressText:Ag});},editEMMASourceTable:function Ah(BA,A9){var A8=this;var A7={success:function(BB){if(BB&&BB.msgid){A8.set("messageID",BB.msgid);}}};Aa.call(this,mstrmojo.func.wrapMethods(A7,BA,{}),An.copy(A9,{taskId:"DIEditEMMASourceTable",msgid:this.messageID}),{showProgress:true,showProgressText:false});},removeEMMASourceTable:function j(BA,A9){var A8=this;var A7={success:function(BB){if(BB&&BB.msgid){A8.set("messageID",BB.msgid);}}};Aa.call(this,mstrmojo.func.wrapMethods(A7,BA,{}),An.copy(A9,{taskId:"DIRemoveEMMASourceTable",msgid:this.messageID}),{showProgress:true,showProgressText:false});},persistCubeConfigInfo:function Af(BA,A9){var A8=this;var A7={success:function(BB){if(BB&&BB.msgid){A8.set("messageID",BB.msgid);}}};Aa.call(this,mstrmojo.func.wrapMethods(A7,BA,{}),An.copy(A9,{taskId:"DIPersistCubeConfigInfo",msgid:this.messageID}),{showProgress:true,showProgressText:false});},startRefineStage:function AR(BA,A9){var A8=this;var A7={success:function(BB){if(BB&&BB.msgid){A8.set("messageID",BB.msgid);}}};Aa.call(this,mstrmojo.func.wrapMethods(A7,BA,{}),An.copy(A9,{taskId:"DIStartRefineStage",msgid:this.messageID}),{showProgress:true,showProgressText:false});},cancelRefineStage:function AC(A8,A7){Aa.call(this,A8,An.copy(A7,{taskId:"DICancelRefineStage",msgid:this.messageID}),{showProgress:true,showProgressText:false});},cancelAggFilter:function J(A8,A7){Aa.call(this,A8,An.copy(A7,{taskId:"DIStartOrCancelAggFilterChange",msgid:this.messageID,cancel:1}),{showProgress:true,showProgressText:false});},autoMappingSourceTable:function AD(BA,A9){var A8=this;var A7={success:function(BB){if(BB&&BB.msgid){A8.set("messageID",BB.msgid);}}};Aa.call(this,mstrmojo.func.wrapMethods(A7,BA,{}),An.copy(A9,{taskId:"DIAutoMappingEMMASourceTable",msgid:this.messageID}),{showProgress:true});},autoMap:function h(BA,A9){var A8=this;var A7={success:function(BB){if(BB&&BB.msgid){A8.set("messageID",BB.msgid);}}};Aa.call(this,mstrmojo.func.wrapMethods(A7,BA,{}),An.copy(A9,{taskId:"qBuilder.AutoMapTables",msgid:this.messageID,showWait:true}),{showProgress:true,showProgressText:true,progressText:Ag});},prepareData:function A1(BB,BA,A8){var A9=this;var A7={success:function(BD){if(BD&&BD.msgid){A9.set("messageID",BD.msgid);}var BE=1;var BC=mstrmojo.desc(13196,"Prepare data ## of ### tables...").replace("###",BE).replace("##",BE);A9.taskByPollStatus(BB,BD,BC,{showWait:true},{hideCancel:A8});}};Aa.call(this,A7,An.copy(BA,{taskId:"DIDataPreparation",msgid:this.messageID,showWait:true}),{showProgress:true,showProgressText:true,progressText:Ag});},taskByPollStatus:function AI(BD,A7,BB,BC,A8){var BA=this,A9="pollStatus";if(mstrApp.isSingleTier){A9="DIPollStatus";}Aa.call(BA,mstrmojo.DI.DIDataService.taskByPollStatusCb.call(BA,BD,A7,BB,BC,A8),{taskId:A9,resultSetType:3,threadId:A7.tid,maxWait:60000,taskEnv:"xhr",taskContentType:"json",isAsync:true,msgid:BA.messageID},{},BC);},sendToHistoryList:function AK(A8,A7){Aa.call(this,A8,An.copy(A7,{taskId:"DISendToInbox",msgid:this.messageID}),{showProgress:true});},setDataImportInfo:function A5(BA,A9){var A8=this;var A7={success:function(BB){if(BB&&BB.msgid){A8.set("messageID",BB.msgid);}}};Aa.call(this,mstrmojo.func.wrapMethods(A7,BA,{}),An.copy(A9,{taskId:"DISetDataImportInfo",msgid:this.messageID}),{showProgress:true});},changeMappingSourceTable:function R(BA,A9){var A8=this;var A7={success:function(BB){if(BB&&BB.msgid){A8.set("messageID",BB.msgid);}}};Aa.call(this,mstrmojo.func.wrapMethods(A7,BA,{}),An.copy(A9,{taskId:"DIChangeMappingEMMASourceTable",msgid:this.messageID}),{showProgress:true,showProgressText:true,progressText:Ag});},updateMappingSourceTable:function w(A8,A7){Aa.call(this,A8,An.copy(A7,{taskId:"setCubeAttributeFormMapping",msgid:this.messageID}),{showProgress:true,showProgressText:true,progressText:Ag});},detectRelationshipSourceTable:function Ae(BA,A9){var A8=this;var A7={success:function(BB){if(BB&&BB.msgid){A8.set("messageID",BB.msgid);}}};Aa.call(this,mstrmojo.func.wrapMethods(A7,BA,{}),An.copy(A9,{taskId:"DIDetectRelationshipEMMASourceTable",msgID:this.messageID}),{showProgress:true,showProgressText:true,progressText:Ag});},editRelationshipSourceTable:function l(BA,A9){var A8=this;var A7={success:function(BB){if(BB&&BB.msgid){A8.set("messageID",BB.msgid);}}};Aa.call(this,mstrmojo.func.wrapMethods(A7,BA,{}),An.copy(A9,{taskId:"DIEditRelationshipEMMASourceTable",msgid:this.messageID}),{showProgress:true,showProgressText:true,progressText:Ag});},saveEMMASchedule:function AM(A8,A7){Aa.call(this,A8,An.copy(A7,{taskId:"DISaveEMMASchedule",msgid:this.emmaIRRMessageID||""}),{showProgress:true,showProgressText:true,progressText:Ag});},getObjectSubscriptions:function A4(A8,A7){if(!A7){A7={};}if(A7.deliveryType===undefined){A7.deliveryType=16;}Aa.call(this,A8,An.copy(A7,{taskId:"GetObjectSubscriptions",msgid:this.messageID}),{showProgress:true,showProgressText:true,progressText:Ag});},getAvailableTriggers:function G(A8,A7){Aa.call(this,A8,An.copy(A7,{taskId:"getSchedules",msgid:this.messageID}),{showProgress:true,showProgressText:true,progressText:Ag});},getSubscriptionInfo:function At(A8,A7){Aa.call(this,A8,An.copy(A7,{taskId:"DIGetSubscriptionInfo",msgid:this.messageID}),{showProgress:true,showProgressText:true,progressText:Ag});},removeSubscription:function U(A8,A7){Aa.call(this,A8,An.copy(A7,{taskId:"cancelSubscriptionsTask",msgid:this.messageID}),{showProgress:true,showProgressText:true,progressText:Ag});},getScheduleStatus:function Aw(A8,A7){Aa.call(this,A8,An.copy(A7,{taskId:"DIGetScheduleStatus"}),{showProgress:true,showProgressText:true,progressText:Ag});},searchMetadata:function Ai(A8,A7){Aa.call(this,A8,An.copy(A7,{taskId:"searchMetadata"}),{showProgress:false});},objectSearch:function u(A8,A7){Aa.call(this,A8,An.copy(A7,{taskId:"objectSearch"}),{showProgress:false});},getAttributeForms:function AN(A8,A7){Aa.call(this,A8,An.copy(A7,{taskId:"getAttributeForms"}),{showProgress:false});},getAttributeGroupInfo:function Ap(A8,A7){Aa.call(this,A8,An.copy(A7,{taskId:"getCubeAttributeGroupInfo",msgid:this.messageID}),{showProgress:true,showProgressText:true,progressText:Ac});},duplicateReportInstance:function S(BB,BA,A8){var A9=mstrApp.isFromVI?mstrApp.launchingApp:mstrApp,A7=!!(mstrConfig.resolveOnly||A9.isAppStatePause&&A9.isAppStatePause());Aa.call(this,BB,An.copy(BA,{taskId:"duplicateReportInstance",skipRebuild:A7}),A8||{showProgress:true,showProgressText:true,progressText:Ac});},changePartition:function AE(A8,A7){Aa.call(this,A8,An.copy(A7,{taskId:"DIChangePartition",msgid:this.messageID,showWait:true}),{showProgress:false});},createEmmaIRRReportInstance:function N(A8,A7){Aa.call(this,A8,An.copy(A7,{taskId:"DICreateEmmaIRRReportInstance"}),{showProgress:true});},publishNonEmmaCube:function Ak(A8,A7){Aa.call(this,A8,An.copy(A7,{taskId:"reportExecute",styleName:" "}),{showProgress:true,showProgressText:true,progressText:Ag});},createEmmaIRRSourceTables:function AF(A8,A7){Aa.call(this,A8,An.copy(A7,{taskId:"DICreateEmmaIRRSourceTables",msgid:this.emmaIRRMessageID}),{showProgress:true});},editEmmaIRRSourceTable:function AU(A8,A7){Aa.call(this,A8,An.copy(A7,{taskId:"DIEditEmmaIRRSourceTable",msgid:this.emmaIRRMessageID}),{showProgress:true});},deleteEmmaIRRSourceTable:function AT(A8,A7){Aa.call(this,A8,An.copy(A7,{taskId:"DIDeleteEmmaIRRSourceTable",msgid:this.emmaIRRMessageID}),{showProgress:false});},getEmmaIRRAttributes:function q(A8,A7){Aa.call(this,A8,An.copy(A7,{taskId:"DIGetEmmaIRRAttributes",msgid:this.messageID}),{showProgress:true});},setEmmaIRRFilter:function D(A8,A7){Aa.call(this,A8,An.copy(A7,{taskId:"DISetEmmaIRRFilter",msgid:this.emmaIRRMessageID}),{showProgress:true});},validateEmmaIRRAlternateSource:function L(A8,A7){Aa.call(this,A8,An.copy(A7,{taskId:"DIValidateEmmaIRRAlternateSource",msgid:this.emmaIRRMessageID}),{showProgress:true});},getSecurityFilter:function AZ(A8,A7){Aa.call(this,A8,An.copy(A7,{taskId:"DIGetCubeSecurityFilter"}),{showProgress:true,showProgressText:true,progressText:Ac});},loadDBRoles:function AY(A8,A7){Aa.call(this,A8,An.copy(A7,{isDataImport:false,reverseOrder:true,verbose:true,taskId:"getDBInstances"}),{showProgress:true,showProgressText:true,progressText:Ag});},archSearch:function(A8,A7){Aa.call(this,A8,An.copy(A7,{taskId:"arch.search",objecttypes:29,skipSchemaIDCheck:true,flags:1+2+256+512+8192+16384,domain:4,specialparse:"getDBRoles",xmlflags:1,sessionState:""}),{showProgress:true,showProgressText:true,progressText:Ag});},saveDBRole:function M(A8,A7){Aa.call(this,A8,An.copy(A7,{skipSchemaIDCheck:true,taskId:"arch.saveDBRole",showWait:true}),{showProgress:true,showProgressText:true,progressText:Ag});},setDBRole:function K(A8,A7){Aa.call(this,A8,An.copy(A7,{msgid:this.messageID,taskId:"qBuilder.SetDBRole"}),{showProgress:true,showProgressText:true,progressText:Ag});},populateDBRoles:function AG(A8,A7){Aa.call(this,A8,An.copy(A7,{isDataImport:false,reverseOrder:true,verbose:true,taskId:"getDBInstances",skipSchemaIDCheck:true}),{showProgress:true,showProgressText:true,progressText:Ag});},getObjectFolder:function A3(A8,A7){Aa.call(this,A8,An.copy(A7,{taskId:"DIGetObjectFolder"}),{showProgress:true,showProgressText:true,progressText:Ag});},deleteDBRole:function AG(A8,A7){Aa.call(this,A8,An.copy(A7,{skipSchemaIDCheck:true,taskId:"arch.deleteObject",objecttype:29}),{showProgress:true,showProgressText:true,progressText:Ag});},openMailClient:function AA(A7){if(mstrApp.isSingleTier){window.FormWrapper.mailService(A7);}else{mstrApp.openPage(A7);}},validateSource:function Ay(A8,A7){Aa.call(this,A8,An.copy(A7,{taskId:"DIValidateEmmaSourceTask",msgid:this.messageID}),{showProgress:true});},scrapeWiki:function AO(A8,A7){Aa.call(this,A8,An.copy(A7,{taskId:"wikiScrapper"}),{showProgress:!(A7.shouldSuggest),showProgressText:true,progressText:AB});},toggleDatasetServeMode:function x(BA,A9){var A8=this;var A7={success:function(BB){if(BB&&BB.msgid){A8.set("messageID",BB.msgid);}}};Aa.call(this,mstrmojo.func.wrapMethods(A7,BA,{}),An.copy(A9,{taskId:"DIToggleDatasetServeMode",msgid:this.messageID}),{showProgress:true,showProgressText:true,progressText:Ag});},setPreference:function I(A8,A7){Aa.call(this,A8,An.copy(A7,{skipSchemaIDCheck:true,taskId:"setPreference"}),{showProgress:true,showProgressText:true,progressText:Ag});},updatePreferences:function z(BA,A7,A8){var A9={taskId:"updatePreference"};if(A7){A9[A7]=A8;}Aa.call(this,BA,A9,{showProgress:true,showProgressText:true,progressText:Ag});},getPreferences:function AQ(A8,A7){Aa.call(this,A8,An.copy(A7,{taskId:"getPreferences"}),{showProgress:true,showProgressText:true,progressText:Ag});},getProjectAttributeInfo:function A2(A8,A7){Aa.call(this,A8,An.copy(A7,{skipSchemaIDCheck:true,taskId:"GetProjectAttributeInfo"}),{showProgress:true,showProgressText:true,progressText:Ag});},clearRelationship:function g(BA,A9){var A8=this;var A7={success:function(BB){if(BB&&BB.msgid){A8.set("messageID",BB.msgid);}}};Aa.call(this,mstrmojo.func.wrapMethods(A7,BA,{}),An.copy(A9,{taskId:"DIClearRelationshipEMMASourceTable",msgid:this.messageID}),{showProgress:true,showProgressText:true,progressText:Ag});},DISetURLWhiteListTask:function Y(A8,A7){Aa.call(this,A8,An.copy(A7,{taskId:"DISetURLWhiteListTask"}),{showProgress:true,showProgressText:true,progressText:Ag});},getImportFromCube:function Av(BA,A9){var A8=this;var A7={success:function(BB){if(BB&&BB.msgid){A8.set("messageID",BB.msgid);}}};Aa.call(this,mstrmojo.func.wrapMethods(A7,BA,{}),An.copy(A9,{msgid:this.messageID,taskId:"DIImportFromCube"}),{showProgress:true,showProgressText:true,progressText:Ag});},DIManageHadoopGateway:function f(A9,A8,A7){Aa.call(this,A9,An.copy(A8,{taskId:"DIManageHadoopGateway"}),A7!==undefined?A7:{showProgress:true,showProgressText:true,progressText:Ag});},getObjectInfo:function AP(A8,A7){Aa.call(this,A8,An.copy(A7,{taskId:"getObjectInfo"}),{showProgress:true,showProgressText:true,progressText:Ag});},getCustomConnector:function C(A8,A7){Aa.call(this,A8,An.copy(A7,{taskId:"arch.getCustomConnector",objecttypes:29,skipSchemaIDCheck:true,flags:1+2+256+512+8192+16384,domain:4,specialparse:"getDBRoles",xmlflags:1,sessionState:"",typeFilter:Aj.dbType.newConnector,uses:Aj.newConnectorDBMSId+",57"}),{showProgress:true,showProgressText:true,progressText:Ag});},deleteCustomDBMS:function B(A8,A7){Aa.call(this,A8,An.copy(A7,{skipSchemaIDCheck:true,taskId:"arch.deleteObject",objecttype:57}),{showProgress:true,showProgressText:true,progressText:Ag});},searchObjectName:function Ad(A8,A7){Aa.call(this,A8,An.copy(A7,{taskId:"objectSearch",styleName:"MojoFolderStyle",includeAncestorInfo:false,includeObjectDesc:false,fields:"name",objectType:"776,779,8"}),{showProgress:true,showProgressText:true,progressText:Ag});},getPreConfigOauth:function(A8,A7){Aa.call(this,A8,An.copy(A7,{taskId:"ResetOAuthPara",}),{showProgress:true,showProgressText:true,progressText:Ag});},getCubeQuotaByRestAPI:function(A8,A7){Aa.call(this,A8,An.copy(A7,{taskId:"getCubeQuotaOfUser",}),{showProgress:false,showProgressText:false});},getCloudElementToken:function(A8,A7){Aa.call(this,A8,An.copy(A7,{taskId:"DIGetCloudElementToken"}),{showProgress:true,showProgressText:true,progressText:mstrmojo.desc(5720,"Waiting...")});},getSingleDBRole:function(A8,A7){Aa.call(this,A8,An.copy(A7,{taskId:"qBuilder.GetSingleDBRole"}),{showProgress:false,showProgressText:false});},removeOrDuplicateRI:function A(A8,A7){Aa.call(this,A8,An.copy(A7,{taskId:"qBuilder.RemoveOrDuplicateRI"}),{showProgress:false,showProgressText:false});}});mstrmojo.DI.DIDataService.taskByPollStatusCb=function AL(BF,BH,BG,BD,BB,A9,A8){var BC=this;return{success:function BE(BK){if(BK.status==="1"||BK.status===1){mstrApp.hideWait(true);if(BF.success){if(A9==="arch.PollStatusCatalogAction"){BF.success(BK.response);}else{BF.success(BH);}}}else{if(BK.status==="2"||BK.status===2){BF.failure();mstrmojo.error({longDesc:JSON.parse(BK.response).message},null,{title:mstrmojo.desc(96,"Error")});}else{var BM=!!BG?true:BC.isPolling;BG&&mstrApp.showWait({showCancel:(BB&&BB.hideCancel)?false:true,message:BG,onCancel:function(){BM=false;mstrApp.hideWait(true);if(BF.canceled){BF.canceled(null,BH);}}});var BJ=BB&&BB.waitTime;var BI=BB&&BB.preTime;if(BJ){var BL=BJ;BJ=BJ+BI;BJ=BJ>=5000?5000:BJ;BI=BL;}else{BJ=1000;BI=1000;}window.setTimeout(function(){if(BM){BC.taskByPollStatus(BF,BH,BG,BD,{waitTime:BJ,preTime:BI},A9);}},BJ);}}},failure:function A7(BI){BG&&mstrApp.hideWait(true);if(BF.failure){BF.failure(BI);}},canceled:function BA(BI){BG&&mstrApp.hideWait(true);}};};}());(function(){mstrmojo.requiresCls("mstrmojo.func","mstrmojo.string","mstrmojo.Obj","mstrmojo.hash","mstrmojo.array","mstrmojo.warehouse.EnumDataChangeEvents","mstrmojo.architect.EnumColumnDataTypes");var S=mstrmojo.func.wrapMethods,J=mstrmojo.hash,O=mstrmojo.array,G=mstrmojo.string,U=26,L=15,Q=mstrmojo.desc(11428,"[unknown]"),B=mstrmojo.architect.EnumColumnDataTypes,I=mstrmojo.warehouse.EnumDataChangeEvents,H=I.DBTABLES_CHANGED;function E(X){var W,Y=X.tp;W=(Y===undefined?X:B[Y].n);return("["+(W||Q)+"]");}function F(W){return G.decodeHtmlString(W).replace(/&apos;/g,"'");}mstrmojo.qb.bigquery._hasBigQueryModel=mstrmojo.provide("mstrmojo.qb.bigquery._hasBigQueryModel",{projects:[],datasets:[],warehouseTables:{},selectedProject:undefined,selectedDataset:undefined,isBigQuery:true,getColDataType:function M(X){var W=X.dt.tp;return W===undefined?X.dt:W;},loadDBRoles:function A(X){var W=this;mstrApp.getRootController().getDataService().submitRequest(S({success:function(a){var Z=a.mi.gbqht.gbqp,b=[],Y;if(!Z){Z=[];}if(!(Z instanceof Array)){Z=[Z];}O.forEach(Z,function(d){Y=d.n||d.id;b.push(J.copy({did:String(d.id),n:Y,des:Y,tp:29,isPrimary:function c(){return this.data.isPrimary;},data:{isPrimary:false}},d));});W.set("projects",b);W.raiseEvent({name:I.DBROLES_LOADED,items:b});}},X),{taskId:"qBuilder.FetchSourceObjects",dbRoleID:mstrApp.dbrid,sourceAccountID:mstrApp.said,flags:64,showWait:true});},_set_selectedProject:function R(Y,W){var X=this;this.selectedProject=W;this.selectedDataset=undefined;this.SelDBRoleID=undefined;this.set("SelDBRoleID",mstrApp.dbroleID);O.forEach(X.projects,function(Z){if(Z.data.isPrimary){Z.data.isPrimary=false;X.raiseEvent({name:I.DBROLE_CHANGED,item:Z});}if(Z.did==W){Z.data.isPrimary=true;X.raiseEvent({name:I.DBROLE_CHANGED,item:Z});}});this.getDatasets();},getAccountInfo:function V(X,W,Y){mstrApp.getRootController().getDataService().submitRequest({success:function(Z){Y&&Y(Z);}},{taskId:"qBuilder.FetchSourceObjects",sourceAccountID:X,dbRoleID:W,flags:2,showWait:true});},getProject:function N(X){var W=null;O.forEach(this.projects,function(Y){if(X===Y.id){W=Y;return false;}});return W;},getDatasets:function C(){var X=this,W=X.selectedProject;X.raiseEvent({name:H,items:[],selectedItems:[]});X.raiseEvent({name:I.NAMESPACES_REQUESTED});mstrApp.getRootController().getDataService().submitRequest({success:function(Z){var a=Z.mi.gbqht.gbqp.gbqd,Y=[];if(!a){a=[];}if(!(a instanceof Array)){Y.push({n:a.id||mstrmojo.desc(16211,"There is no namespace"),cls:(a.id?"":"disabled")});}else{O.forEach(a,function(b){Y.push({n:b.id});});}X.datasets=Y;X.raiseEvent({name:I.NAMESPACES_CHANGED,namespaces:Y,usecCache:Y.length,dbRoleID:W});}},{taskId:"qBuilder.FetchSourceObjects",dbRoleID:mstrApp.dbrid,sourceAccountID:mstrApp.said,gbqpid:W,flags:64,showWait:true});},onselectedDatasetChange:function K(W){this.selectedDataset=W.value;this.getDatasetTables({blockBegin:0,blockCount:1000,filterText:""});},getDatasetTables:function D(a,d){var b=this,g=b.selectedProject,e=b.selectedDataset,Z=a.filterText,f,X=false,c=[],W=[],Y;Y=b.warehouseTables[g]=b.warehouseTables[g]||{};if(!b.catalogRefresh&&e&&(Y[e]!==undefined)){J.forEach(Y[e],function(k,j){X=true;f={id:k.id,n:j,did:j,dbtn:j,st:8405,tag:k,ns:k.ns,tp:L,isVisible:function h(){},items:[]};if(Z!==""&&j.toUpperCase().indexOf(Z.toUpperCase())>-1){c.push(f);}W.push(f);});if(X){b.raiseEvent({name:H,items:(Z!=="")?c:W,selectedItems:[],keyword:Z});return ;}}b.raiseEvent({name:I.DBTABLES_REQUESTED,sourceInfo:a.sourceInfo||""});mstrApp.getRootController().getDataService().submitRequest({success:function(l){var n=l.mi.gbqht.gbqp.gbqd,k=n&&n.gbqt,j=[],h,m;b.catalogRefresh=false;b.selectedDataset=e=n.id;m=Y[e]={};if(!k){k=[];}if(!(k instanceof Array)){k=[k];}O.forEach(k,function(o){h=o.id;f={n:h,id:h,ns:g+"."+e,did:h,dbtn:h,st:8405,tag:o,tp:L,isVisible:function(q,p){return b.handleVisibleAction(q,p);},isChecked:function(q,p){return b.handleCheckAction(q,p);},isEnabled:function(q,p){return b.handleEnabledAction(q,p);},items:[]};m[h]=f;j.push(f);});b.raiseEvent({name:H,items:j,selectedItems:[]});}},{taskId:"qBuilder.FetchSourceObjects",dbRoleID:mstrApp.dbrid,sourceAccountID:mstrApp.said,gbqpid:g,dsid:e,flags:64,showWait:true});},getColumnsForDBTable:function P(X,b){var a=this,g=a.selectedProject,Y=X.getFresh,Z=X.data,f=Z.datasetID||a.selectedDataset,c=Z.did,d=Z.n,W;if(!Y){W=a.warehouseTables[g]&&a.warehouseTables[g][f][c].columns;if(W){b.success({src:X,items:W,selDBRole:f});a.raiseEvent({name:"dbTablesPopulated",items:{id:c,n:d,items:W}});if(b&&b.complete){b.complete();}return ;}}mstrApp.getRootController().getDataService().submitRequest(S({success:function e(k){var j=k.mi.gbqcs.gbqc,h=[],l;O.forEach(j,function(n){l=F(n.id);h.push({n:l+": "+E(n.dt),cln:n.id,dt:n.dt,id:n.id,did:l,st:26,tp:U,isVisible:function m(){}});});if((h.length>0)&&!Y){a.warehouseTables[g][f][c].columns=h;}k.items=h;}},b),{taskId:"qBuilder.FetchSourceObjects",dbRoleID:mstrApp.dbrid,sourceAccountID:mstrApp.said,gbqpid:g,dsid:f,tbid:c,flags:1,showWait:true});}});}());(function(){mstrmojo.requiresCls("mstrmojo.Obj","mstrmojo.hash");mstrmojo.requiresDescs(889);var D=mstrmojo.hash;var I=mstrmojo.desc(889,"Please wait...");function F(S,R){var P=R.showWait,Q=R.suppressError,O=R.waitMsg;delete R.showWait;delete R.suppressError;delete R.waitMsg;mstrApp.serverRequest(R,S,P,Q,O);}mstrmojo.qb.mdx.DataService=mstrmojo.provide("mstrmojo.qb.mdx.DataService",{submitRequest:function C(P,O){F.call(this,P,O);},pollingStatus:function N(U,O,R){var Q=this;if(mstrApp.isSingleTier){if(U.success){U.success(O);}return ;}F.call(Q,{success:function S(V){if(V.status==="1"){if(U.success){U.success(O);}}else{Q.pollingStatus(U,O,R);}},failure:function P(V){if(U.failure){U.failure(V);}}},{taskId:"pollStatus",resultSetType:3,pollingFrequency:500,maxWait:60000,taskEnv:"xhr",taskContentType:"json",showWait:true,waitMsg:R});},addCubes:function E(R,Q){var O=this;F.call(this,{success:function P(S){mstrApp.msgid=S.msgid;O.pollingStatus(R,S,I);}},D.copy(Q,{taskId:"qBuilder.AddMDXCubes",showWait:true,waitMsg:I}));},updateCubes:function L(R,Q){var O=this;F.call(this,{success:function P(S){mstrApp.msgid=S.msgid;O.pollingStatus(R,S,I);}},D.copy(Q,{taskId:"qBuilder.UpdateMDXCubes",showWait:true,waitMsg:I}));},setDBRole:function G(R,Q){var O=this;F.call(this,{success:function P(S){mstrApp.msgid=S.msgid;O.pollingStatus(R,S,I);}},D.copy(Q,{taskId:"qBuilder.SetDBRole",showWait:true,waitMsg:I}));},search:function M(P,O){F.call(this,P,D.copy(O,{taskId:"arch.search",showWait:true}));},searchFolderContents:function K(P,O){F.call(this,P,D.copy(O,{taskId:"searchMetadata",styleName:"MojoFolderStyle",includeAncestorInfo:false,includeObjectDesc:false,fields:"name",recursive:0}),{showProgress:true,showProgressText:true,progressText:I});},createEmmaTable:function B(R,Q){var O=this;F.call(O,{success:function P(S){mstrApp.msgid=S.msgid;O.pollingStatus(R,S,I);}},D.copy(Q,{taskId:"DICreateEMMASourceTable",showWait:true,waitMsg:I}));},createEmmaInstance:function H(R,Q){var O=this;F.call(O,{success:function P(S){mstrApp.msgid=S.msgid;O.pollingStatus(R,S,I);}},D.copy(Q,{taskId:"DICreateEMMAReportInstance",showWait:true,waitMsg:I}));},getObjectFolder:function J(P,O){F.call(this,P,D.copy(O,{taskId:"DIGetObjectFolder",showWait:true,waitMsg:I}));},getObjectInfo:function A(P,O){F.call(this,P,D.copy(O,{taskId:"getObjectInfo"}),{showProgress:true,showProgressText:true,progressText:I});}});}());(function(){mstrmojo.requiresCls("mstrmojo.StringBuffer","mstrmojo.hash","mstrmojo.array","mstrmojo.dom","mstrmojo._IsGraphDataService","mstrmojo.func","mstrmojo._ImageHelper","mstrmojo.fe.FilterUtils","mstrmojo.rw.model.RetrievalKeysConfig","mstrmojo.rw.model.UpdateKeysConfig");var e=mstrmojo.hash,B=e.copy,V=mstrmojo.array,AZ=mstrmojo.dom,AA=mstrmojo.func,AP=[mstrmojo.desc(8445,"Loading")],AG=mstrmojo.fe.FilterUtils.getExprXml,As=mstrmojo.array.ensureArray,P=0;function X(BW){BW=BW||{};BW.preserveUndo=true;return BW;}function Ap(Ba,Bb,BW){if(this.blockRequests){throw ("The data service is currently ignoring all requests to the server.");}var BX=P++,BZ=this.getTxUpdates(BX);BW=BW||{};BW.src=Ap.caller.name;if(!mstrmojo.string.isEmpty(BZ)){Ba.updateChanges=BZ;}Ba.zoomFactor=this.model.getZoomFactor();var BY=this.cmdMgr;if(!BW.preserveUndo&&BY){BY.onSubmitUpdates();}mstrApp.serverRequest(Ba,this.wrapCallback(Bb,BX,BW.preserveStid),BW);}function N(BY,BX,BW){e.copy({unitType:BX.defn&&BX.defn.t,unitKey:BX.k},BY);if(BW.layoutKey){e.copy({toKey:BW.layoutKey,analysisSectionType:BW.analysisSectionType},BY);}else{e.copy({toKey:BW.parentKey},BY);}return BY;}function Av(BX){BX=BX||{};if(mstrApp.optimizeFitToPage){var BW=window.mstrMobileApp?this.model.controller.getContentDimensions():mstrApp.getContentDimensions();if(BW){BX.styleName="RWDocumentMobileStyle";BX.availableWidth=BW.w;BX.availableHeight=BW.h;}else{BX.innerWidth=mstrmojo.dom.windowDim().w;BX.innerHeight=mstrmojo.dom.windowDim().h;}}return BX;}function BR(BX){var BW=BX&&BX.style,BY=BW&&BW.params;return BY&&BY.treesToRender;}function C(BW,BX){return{act:"moveUnit",toKey:BW,unitType:BX};}function Au(BW){return BW.split("\u001E")[2];}function M(BX,Bb){if(BX!==mstrmojo.DocDataService.UNDO_KEY){return BX;}if(!this.undoSectionKey){var Ba=this.undoSectionKey=this.model.getNextKey(),BY=this.undoFGKey=this.model.getNextKey();Bb.addActions({act:"addUndoSection",cbKey:this.cbKey,nodeKey:Ba,fgKey:BY});var BZ=this;Bb.addCallbacks({failure:function BW(){delete BZ.undoSectionKey;}});}return this.undoSectionKey;}function Ao(BY,BX){var BW={dsid:BY.dsid,formula:BY.tokenStreamXML,isTokenStream:!mstrmojo.string.isEmpty(BY.tokenStreamXML),name:BY.alias,afb:BY.afb,sfb:BY.sfb};if(BX){BW.Ids=["$GUID_135"];}return this.getAddDerivedMetricToDatasetAction(BW);}function L(BX){var BW="USE_DEFAULT_INDICATOR";BX=BX||{};BX.mptso=BX.mptso||{pru:true};BX.mptsim=BX.mptsim||{pru:true};BX.mptfms=BX.mptfms||"";return{MDXPassThrough:{SolveOrder:BX.mptso.pru?BW:BX.mptso.v,ScopeIsolationMode:BX.mptsim.pru?BW:BX.mptsim.v,FormatString:BX.mptfms}};}function AL(BW,BX){return{act:"formatDerivedMetric",dsid:BW.dsid||"",mid:(BX||!BW.did)?"$GUID_135":BW.did,format:L(BW.mptf),};}function AO(BZ,Bc,BX,Bd,BW,BY){var Ba=[this.getNodeKeyFromKeyContext(Bc)];if(!BY){Ba=As(Bd).concat(Ba);}var Bb={act:BZ,keyContext:Bc,tgtKey:BX,partialRetrieval:{nodes:Ba}};if(!BW){Bb.partialUpdate={selectors:[Au(Bc)]};}return Bb;}function n(BY){var Ba=false;if(BY===1||BY===2){var BX=this.model,BW=BX.controller,Bb=BW.getRequiredZoomFactor&&BW.getRequiredZoomFactor(BY),BZ=BX.getZoomFactor();if(isNaN(Bb)||parseInt(Math.abs((Bb-BZ)*100),10)<=2){Ba=false;}else{Ba=true;}}return Ba;}mstrmojo.DocDataService=mstrmojo.declare(mstrmojo.Obj,[mstrmojo._IsGraphDataService,mstrmojo._ImageHelper],{scriptClass:"mstrmojo.DocDataService",defaultStyle:{params:{treesToRender:2}},cmdMgr:null,stid:-1,blockRequests:false,clientAuto:false,init:function Am(BW){this._super(BW);this.cmdMgr=this.model.controller&&this.model.controller.cmdMgr;},wrapCallback:function Af(Bb,BY,BX){var BZ=this;return AA.wrapMethods({success:function Ba(Bc){if(Bc){BZ.model.bs=BZ.rwb=Bc.bs||BZ.rwb;BZ.msgId=Bc.mid||BZ.msgId;BZ.cbKey=Bc.cbKey||BZ.cbKey;if(Bc.stid!==undefined&&!BX){BZ.stid=Bc.stid;}if(Bc.clientAuto!==undefined){BZ.clientAuto=Bc.clientAuto;}if(mstrApp.parseSecondaryDataProviders){mstrApp.parseSecondaryDataProviders(Bc);}}BZ.clearTxUpdates(BY);},failure:function BW(){BZ.resetTxUpdates(BY);}},Bb);},getNodeKeyFromKeyContext:function Z(BW){return BW.split("\u001E")[1];},refresh:function A2(BY,BZ){var BX=!!BY.useRefreshProgress,BW=BX?[mstrmojo.desc(10078,"Refreshing data. Please wait.")]:AP;delete BY.useRefreshProgress;BY=Av.call(this,BY);Ap.call(this,B(BY,{taskId:"docRefresh",rwb:this.rwb,rePrompt:false,fresh:false,regenerate:false,displayNoResErr:true,compress:1}),BZ,{showProgress:true,hideProgress:true,progressStateText:BW,useRefreshProgress:BX});},saveRW:function A6(BW,BX){Ap.call(this,B(BW,{taskId:"saveRW",msgID:this.msgId}),BX);},saveThresholds:function j(BX,BY,BW){Ap.call(this,B(BX,{taskId:"saveThresholds"}),BY,BW);},getThresholds:function BK(BX,BY,BW){Ap.call(this,B(BX,{taskId:"getThresholds"}),BY,BW);},browseElements:function AK(BX,BY,BW){Ap.call(this,B(BX,{taskId:"browseElements",styleName:"MojoAttributeStyle",blockBegin:1,blockCount:mstrApp.elementsBlockCount||30}),BY,BW);},removeUnit:function Y(BX,BY){var BW=B(BX,{act:"removeUnit"});this.submitTemplateUpdates(BW.nodeKey,BW,BY);},removeLayout:function AT(BX,BW,BY){this.submitUpdates({act:"removeLayout",unitKey:BX,isCurrent:BW},BY);},moveLayout:function x(BY,BW,BX){this.submitUpdates(this.getMoveNodeAction(BY,BW,BX),mstrmojo.DocDataService.EMPTY_CALLBACK,mstrmojo.DocDataService.SUPPRESS_DATA);},getMacroCopyNodeAction:function Aq(BX,BW,BZ){var BY={act:"macroCopyUnit",newKey:BZ,partialRetrieval:this.newRetrievalKeysConfig().addNode(BZ)};N(BY,BX,BW);return BY;},getMacroMoveNodeAction:function AF(BX,BW){var BY={act:"macroMoveUnit",partialRetrieval:this.newRetrievalKeysConfig().addNode(BX.k)};N(BY,BX,BW);return BY;},getMoveNodeAction:function r(Ba,BW,BX){var BZ=Ba.defn,BY=BZ?BZ.t:mstrmojo.EnumRWUnitType.LAYOUT;return this.getMoveNodeActionUsingKey(Ba.k,BY,BW,BX);},getMoveNodeActionUsingKey:function A9(Ba,BY,BW,BX){var BZ=C(BW,BY);BZ.unitKey=Ba;if(BX!==undefined){BZ.index=BX;}return BZ;},getMoveControlAction:function d(BZ,BX,BW){var BY=C(BX,mstrmojo.EnumRWUnitType.SELECTOR);BY.keyContext=BZ;if(BW){BY.partialRetrieval={nodes:As(BW)};}return BY;},addMoveControlAction:function I(BZ,BY,BX,BW){BZ.addActions(this.getMoveControlAction(BY,M.call(this,BX,BZ),BW));},getSetCtrlSourceAction:function AM(BX,BZ,BW,BY){return{act:"setControlSource",keyContext:BX,unitId:BZ,unitType:BW,removeCGB:BY||[],partialRetrieval:this.newRetrievalKeysConfig().addNode(this.getNodeKeyFromKeyContext(BX)),partialUpdate:{selectors:[Au(BX)]}};},getRemoveCtrlTargetAction:function G(BY,BX,BZ,BW){return AO.call(this,"removeControlTarget",BY,BX,BZ,BW);},getClearCtrlTargetAction:function BG(BW){return{act:"clearControlTarget",keyContext:BW};},getAddCtrlTargetAction:function A0(Ba,BX,Bb,Bc,BW,BY){var BZ=AO.call(this,"addControlTarget",Ba,BX,Bb,BW,BY);BZ.isUC=!Bc;return BZ;},getAddCtrlTargetDatasetAction:function BD(BX,BW){return{act:"addControlTargetDataset",keyContext:BX,tgtDid:BW};},getRemoveCtrlTargetDatasetAction:function h(BX,BW){return{act:"removeControlTargetDataset",keyContext:BX,tgtDid:BW};},getClearCtrlTargetDatasetAction:function AS(BW){return{act:"clearControlTargetDataset",keyContext:BW};},getChangeControlElementSource:function BQ(BX,BW){return{act:"changeControlElementSource",keyContext:BX,ctlElementSrc:BW};},getSetAttributesJoinTypeAction:function Aj(BW,BX){return{act:"setAttributesJoinType",nodeKey:BW,value:BX,partialRetrieval:this.newRetrievalKeysConfig().addNode(BW)};},getSetMetricJoinTypeAction:function Ab(BY,Ba,BW,BX,BZ){return{act:"setMetricJoinType",nodeKey:BY,unitId:Ba,dataType:BW,unitType:BX,value:BZ,partialRetrieval:this.newRetrievalKeysConfig().addNode(BY)};},getTxUpdates:function AY(BX){var BW=this.model;return BW&&BW.getTransactionUpdates&&BW.getTransactionUpdates(BX);},clearTxUpdates:function An(BX){var BW=this.model;if(BW&&BW.clearTransactionUpdates){BW.clearTransactionUpdates(BX);}},resetTxUpdates:function D(BX){var BW=this.model;if(BW&&BW.resetTransactionUpdates){BW.resetTransactionUpdates(BX);}},loadDocLayout:function K(Ba,Bc,Bb){var BZ={act:"setCurrentLayout",unitKey:Ba.layoutKey,disablePU:true,panelUnitKey:Ba.panelKey},BY={style:{params:{treesToRender:3}},params:Av.call(this,Ba)},BW=this.model,BX=!!Bb;if(!Bb){Bb=BW.getDataService().newUpdateWithoutCmd();}if(mstrApp.isAppStatePause&&mstrApp.isAppStatePause()){BW.applyBufferedSelections(Bb);}Bb.add(BZ,Bc,BY);if(!BX){this.submitUpdates(BZ,Bc,BY);}},checkMissingCredentials:function AB(BW,BX){Ap.call(this,B(BW,{taskId:"checkMissingCredentials"}),BX);},setCurrentDocLayout:function Ax(BY,Bc,Bb){var Ba={act:"setCurrentLayout",unitKey:BY},BZ={config:{silent:(Bc===null)&&(!!Bb&&Object.keys(Bb.callback||{}).length===0)}},BW=this.model,BX=!!Bb;Bc=Bc||null;if(!Bb){Bb=BW.getDataService().newUpdateWithoutCmd();}if(mstrApp.isAppStatePause&&mstrApp.isAppStatePause()){BW.applyBufferedSelections(Bb);}Bb.add(Ba,Bc,BZ);if(!BX){Bb.submit();}if(window.mstrMobileApp!==undefined){mstrMobileApp.clearWebViewCache(false);}},fetchDocPage:function BH(BW,BX){Ap.call(this,{taskId:"fetchDocPage",rwb:this.rwb,pos:BW},BX);},requestPanelChangeDeferred:function BP(Bc,Bb,BW,BX,BZ,Ba){var BY={act:"setCurrentPanel",unitKey:Bb};if(BW){BY.partialRetrieval={nodes:BW.split(",")};}Bc.add(BY,Ba,{config:{showProgress:BZ,hideProgress:BZ,progressStateText:AP},style:{params:{treesToRender:BX?3:0}}});},getGraphSelectionAction:function E(Ba,BW,BY,Bd,Bc,BX){var Bb=this.model.getCurrentLayoutDef(),Be=(Bb&&Bb.dzf)||1,BZ={act:"graphSelector",nodeKey:Ba,sliceID:BY,x:Math.round(Bd/Be),y:Math.round(Bc/Be)};if(BX){BZ.usePartialUpdate="0";}else{BZ.partialUpdate={selectors:BW.split("\u001E")};}return BZ;},getSelectorElementsAction:function t(BY){var BX={act:"setSelectorElements",keyContext:BY.ck,ctlKey:BY.ctlKey,elemList:mstrmojo.string.decodeHtmlString(BY.eid),isVisualization:!!BY.isDocVis},BW=BY.include;if(BW!==undefined){BX.include=!!BW;}if(BY.tks){BX.tks=BY.tks;}if(BY.disablePU){BX.usePartialUpdate="0";}else{if(BY.ignoreTargetData){BX.partialRetrieval=this.newRetrievalKeysConfig().addNode(this.getNodeKeyFromKeyContext(BY.ck));}else{BX.partialUpdate={selectors:BY.ctlKey.split("\u001F")};}}return BX;},getUpdateTransactionAction:function BU(BX){var BW={act:"updateTransaction"};if(BX){if(BX.ctlKey){BW.partialUpdate={selectors:[BX.ctlKey]};}}return BW;},getSelectorFromGMAction:function o(BX){var BW={act:"setSelectorFromGM",keyContext:BX.ck,ctlKey:BX.ctlKey,keepOnly:!!BX.keepOnly,selectorObjects:BX.selectorObjects,isVisualization:!!BX.isDocVis,include:!!BX.include};if(BX.tks){BW.tks=BX.tks;}if(BX.disablePU){BW.usePartialUpdate="0";}else{BW.partialUpdate={selectors:[BX.ctlKey]};}return BW;},getGMViewFilterAction:function AJ(BX){var BW={act:"keepOnlyGM",selectorObjects:BX.selectorObjects,isVisualization:!!BX.isDocVis,keepOnly:!!BX.keepOnly};if(BX.tks){BW.tks=BX.tks;}if(BX.disablePU){BW.usePartialUpdate="0";}else{BW.partialUpdate={selectors:[BX.ctlKey]};}return BW;},browseControlElements:function BL(Ba,Bj,BX){var BZ=Ba.searchPattern,Bg=Ba.attributeId,Bc=this.model;if(!BZ||BZ===""){return ;}var Bd={taskId:"browseElements",styleName:"MojoAttributeStyle",attributeID:Bg,expressionXML:Ba.expressionXML||"",dataSourcesXML:Ba.dataSourcesXML||"",blockBegin:Ba.blockBegin,blockCount:Ba.blockCount,searchPattern:BZ,rawInput:BZ,browseFlags:Ba.browseFlags||0,otp:Ba.objectType};if(Ba.datasetId){B({datasetID:Ba.datasetId,messageID:Bc.mid,ctlKey:Ba.controlKey},Bd);}var Bi=Ba.searchForms;if(Bi){var BY="",Bb="";V.forEach(Bi,function(Bk){BY+=Bb+Bk.did;Bb=";";});Bd.searchForms=BY;if(Bc.isnew||Ba.useClientForm){var BW="",Bf="",Be=V.filterOne(Bc.getDatasetUnits(["att"]),function(Bk){return Bk.did===Bg;}),Bh=Be.fs||[];V.forEach(Bi,function(Bk){var Bl=V.filterOne(Bh,function(Bm){return Bm.fid===Bk.did;});BW+=Bf+Bk.did+":"+(Bl&&Bl.bftp||0);Bf=";";});Bd.clientFormPatterns=BW;}}Ap.call(this,Bd,Bj,BX);},setMultiDocSelectorElements:function AH(BW,BX,BZ){var BY={taskId:"setMultiDocSelectorElements",rwb:this.rwb,multiSelect:BX,selectorObjects:BW};Ap.call(this,BY,BZ,{showWait:true,hideWait:true,delay:true});},setDocSelectorTexts:function U(Bb,Bd,Bf,Bc,Be,BX,BW,BY,Ba){var BZ={taskId:"setDocSelectorTexts",rwb:this.rwb,unitKeyContext:Bb,ctlTexts:Bd,ctlKey:Bf,zoomFactor:BX};if(AZ.isAndroid||BW){BZ.taskId="androidSetDocSelectorElements";}if(Bc!==null&&Bc!==undefined){BZ.include=Bc;}if(BY!==null&&BY!==undefined){BZ.usePartDisplay=BY;}if(Ba!==null&&Ba!==undefined){BZ.treesToRender=Ba;}Ap.call(this,BZ,Be);},getSelectorExpressionAction:function u(BY){var BX={act:"setSelectorExpression",keyContext:BY.ck,ctlType:BY.type,objId:BY.srcid,objType:BY.srct,expFunction:BY.f,expFunctionType:BY.ft,include:!!BY.include,qt:BY.qt,unset:!!BY.unset};if(BY.disablePU){BX.usePartialUpdate="0";}else{BX.partialUpdate={selectors:[BY.ckey]};if(BY.retrieveCtrlKey){BX.partialRetrieval=this.newRetrievalKeysConfig().addNode(BY.ctlKey);}}if(BY.changeQual){BX.changeQual=BY.changeQual;}var BW=BY.cs;if(BW!==null&&BW!==undefined){BX.expConstants=BW;BX.dataType=BY.dtp;}if(BY.fid){BX.fid=BY.fid;}return BX;},getAttributeSelectorExpressionAction:function Az(BX){var BW={act:"setAttributeSelectorExpression",keyContext:BX.ck,ctlKey:BX.ctlKey,ctlType:BX.type,expr:BX.expr,partialUpdate:{selectors:[BX.ctlKey]}};if(BX.tks){BW.tks=BX.tks;}return BW;},getMultiUnitSelectorAction:function BN(BW){return{act:"multiUnitSelection",keyContext:BW.ck,include:BW.include!==false,sels:BW.selections,partialUpdate:{selectors:[BW.ctlKey]}};},getRemoveCtrlAction:function Ar(BX,BW){return{act:"removeControl",key:BX,partialUpdate:{selectors:[BX]},partialRetrieval:{nodes:As(BW)}};},getAddCtrlAction:function Ai(Bd,Bb,BX,Bc,BY,Be,BW,BZ,Bf){if(isNaN(Bf)){Bf=1;}var Ba={act:"addControl",parentKey:Bd,nodeKey:Bb,ctlKey:BX,isUC:!!BY,unitType:Be||-1,unitId:BW||"",targetKeys:As(BZ),ctlType:Bf,gpType:Bf,partialRetrieval:{nodes:As(Bc)}};if(!Ba.isUC){Ba.partialUpdate={selectors:[BX]};}return Ba;},getReplaceCtrlAction:function S(BY,Bb,BW,Ba,BX,BZ){return{act:"replaceControl",nodeKey:this.getNodeKeyFromKeyContext(BY),ctlKey:Bb,ctlType:BW,unitId:Ba,unitType:BX,partialUpdate:{selectors:[Bb]},partialRetrieval:{nodes:As(BZ)}};},getSaveGraphPropertiesAction:function m(BW,BX){return{act:"saveGraphProperties",nodeKey:BW,properties:BX};},getSelectorIncludeAction:function A8(BX){var BW=BX.ckey;return{act:"setSelectorInclude",keyContext:BX.ck,ctlKey:BW,ctlType:BX.type,include:BX.include,partialUpdate:{selectors:[BW]}};},getSelectorShowAllAction:function Q(BW){return{act:"setSelectorShowAll",keyContext:BW.ck,ctlKey:BW.ckey,ctlType:BW.type,showAll:BW.showAll,partialRetrieval:this.newRetrievalKeysConfig().addNode(this.getNodeKeyFromKeyContext(BW.ck))};},getUnsetSelectorAction:function g(BZ){var BY=BZ.ckey,BW=BZ.ck,BX={act:"unsetSelector",keyContext:BW,ctlKey:BY,ctlType:BZ.type};if(BZ.ignoreTargetData){BX.partialRetrieval=this.newRetrievalKeysConfig().addNode(this.getNodeKeyFromKeyContext(BW));}else{BX.partialUpdate={selectors:[BY]};}if(BZ.retrieveCtrlKey){BX.partialRetrieval=this.newRetrievalKeysConfig().addNode(this.getNodeKeyFromKeyContext(BW));BX.partialRetrieval=BX.partialRetrieval.addNode(BY);}return BX;},getRASelectorExpandAction:function q(BX){var BW=BX.ckey;return{act:"raSelectorExpandCollapse",keyContext:BX.ck,ctlKey:BW,ctlType:BX.type,elementId:BX.elementId,isExpand:BX.isExpand,partialRetrieval:this.newRetrievalKeysConfig().addNode(this.getNodeKeyFromKeyContext(BX.ck))};},getChangeFilteringAction:function A4(BW,BZ,BY,BX){return{act:"changeFiltering",nodeKey:BW,filterMode:BZ,isUC:BY,partialRetrieval:{nodes:(BX?As(BX):[])}};},getAddDerivedMetricToDatasetAction:function BC(BW){return{act:"addDerivedMetricToDataset",dsid:BW.dsid,formula:BW.formula,isTokenStream:BW.isTokenStream,name:BW.name,newObjectIds:BW.Ids,afb:BW.afb,sfb:BW.sfb};},getSetMDXPassThroughOptionsForCMAction:function A(BW){var BX={act:"formatDerivedElement",format:L(BW.mptf)};if(BW.cid){BX.cid=BW.cid;}if(BW.ceid){BX.ceid=BW.ceid;}return BX;},getEditDocUnitPropAction:function AE(BW){return{act:"editDocUnitProp",dsid:BW.dsid,formId:BW.formId,unitId:BW.unitId,unitType:BW.unitType,prop:BW.prop,value:BW.value};},getRWGraphImage:function BT(Ba,Be){if(mstrApp.isExpress&&!mstrApp.optimizeFitToPage&&n.call(this,this.model.zt)){return ;}var BZ=mstrApp,BW=this.id,BX={taskId:"getRWGraphImage",taskEnv:"xhr",imgType:4,messageID:this.msgId,nodeKey:Ba.k,sliceID:parseInt(Ba.sid,10),width:parseInt(Ba.w,10),height:parseInt(Ba.h,10)};if(Ba.needCoordinate){BX.needCoordinate=1;}if(BZ.onMobileDevice()&&BZ.useBinaryFormat){window.setTimeout(function(){Ap.call(mstrmojo.all[BW],BX,Be,X());},0);}else{if(Ba.encodeImage){BX.taskContentEncoding="base64";delete BX.taskEnv;Ap.call(this,BX,{success:function Bf(Bg){Be.success(Bg);},failure:function BY(Bg){(Be.failure||BZ.onerror)(Bg);}},X());}else{var Bc=BZ.getConfiguration(),Bb=BZ.getCurrentProjectId(),Bd=new mstrmojo.StringBuffer();BX.__ts__=new Date().getTime();BX.sessionState=BZ.getSessionState(Bb);e.forEach(BX,function(Bg,Bh){Bd.append(Bh+"="+encodeURIComponent(Bg));});Be.success(Bc.getTaskUrlByProject(Bb)+"?"+Bd.toString("&"));}}},getImage:function BS(BX){var BY=mstrApp,BW=BY.getConfiguration();if(BW&&BX&&BX.indexOf("://")===-1){BX=BW.getHostUrlByProject(BY.getCurrentProjectId())+BX;}return(mstrApp.useBinaryFormat)?String(mstrMobileApp.getImage(BX)):BX;},setGridDisplayMode:function w(BY,BX,BZ,BW){e.copy(mstrmojo.DocDataService.RAPID_EXEC,BW);this.submitUpdates({act:"setGridDisplayMode",unitKey:BY,displayMode:BX},BZ,BW);},setDocZoom:function H(BW,BX){this.submitUpdates(B(BW,{act:"setDocZoom",disablePU:true}),BX,{style:{params:{treesToRender:3}}});},sortGrid:function AQ(BW,BX){this.submitTemplateUpdates(BW.nodeKey,B({act:"sort"},BW),BX);},getAdvSortData:function Al(BW,BX){this.rwExecute(B(BW,{styleName:"RWGridStyle"}),BX);},getFilterExpression:function AV(BY,BX){var BZ=BY&&BY.expr,BW=this.model;if(BZ&&BW&&BW.getVfexprWithUpdatedVf){BZ=BW.getVfexprWithUpdatedVf(BX,BZ);}return AG(BZ);},saveViewFilter:function Ay(Bb,Bc){var Ba=this.msgId,BW=Bb&&Bb.nodeKeys,BZ=this,BY=V.map(BW,function(Bd){return{act:"saveViewFilter",messageID:Ba,nodeKey:Bd,expr:BZ.getFilterExpression(Bb.filterModel,Bd),partialUpdate:{nodes:[Bd]}};}),BX=V.map(BW,function(Bd){return{act:"saveViewFilterLimit",messageID:Ba,nodeKey:Bd,limitExp:Bb.limitExp,limitToRemove:Bb.limitMdxToRemove||[]};});this.submitUpdates(BY.concat(BX),Bc);},getViewFilter:function AR(BX,BY){var BW=this.model;if(BW.getViewFilter){BW.getViewFilter(BX,BY);}else{Ap.call(this,{taskId:BX.taskId,rwb:BX.rwb,msgID:BX.msgID,nodeKey:BX.nodeKey},BY);}},createEmbeddedFilter:function At(BY,Bb){var BW=BY.filterId,BZ=BY.expJson,Ba={act:"createEmbeddedFilter",messageID:this.msgId,expr:BY.expr,filterId:BW,filterName:BY.filterName};var BX=this.model;AA.wrapMethods({success:function(){var Bc=BX.defn.efs||[];Bc.push({did:BW,exp:BZ});BX.defn.efs=Bc;}},Bb);this.submitUpdates([Ba],Bb,{style:{params:{treesToRender:mstrmojo.DocDataService.EnumTreesToRender.NONE}},params:{suppressData:true}});},rwExecute:function BJ(BW,BX){Ap.call(this,B(BW,{taskId:"RWExecute",rwb:this.rwb,messageID:this.msgId}),BX);},pivot:function p(BW,BX){this.submitTemplateUpdates(BW.nodeKey,{act:"pivot",unitId:BW.unitId,unitType:BW.unitType,attFormId:BW.attFormId,axis:BW.axis,unitPos:BW.unitPos},BX);},resizeXtabColumn:function BF(BW,BX){this.submitUpdates([this.getUpdateTemplateAction(BW.nodeKey,BW),{act:"format",unitType:52,unitKey:BW.nodeKey,formatType:1,format:{FormattingSize:{WidthMode:2}}}],BX);},showTotals:function W(BW,BX){this.submitTemplateUpdates(BW.nodeKey,{act:"showTotals",unitId:BW.unitId,unitType:BW.unitType,subtotalType:BW.subtotalType,clearSubtotalType:BW.clearSubtotalType},BX);},drillGrid:function AN(BW,BX){this.submitUpdates(this.getDrillGridAction(BW),BX,{config:{showProgress:true,hideProgress:true,progressStateText:AP,delay:true}});},getDrillGridAction:function BM(BX){var BW={act:"gridDrillWithin",messageID:this.msgId,nodeKey:BX.nodeKey,sliceId:BX.sliceId,drillPathIndex:BX.drillPathIndex,drillPathKey:BX.drillPathKey,elementList:BX.drillElements,retainParent:BX.retainParent,partialUpdate:{nodes:As(BX.updateNodeKey||BX.nodeKey)}};if(BX.x){BW.x=BX.x;BW.y=BX.y;}return BW;},changeDocGroupBy:function O(BY,BZ,BW){var BX={act:"changeDocGroupBy",disablePU:true};if(BY.flags){BX.flags=BY.flags;}if(BY.groupbyKey){BX.gbKey=BY.groupbyKey;BX.elemId=BY.elementId;}else{BX.gbUnits=BY.gbUnits;}this.submitUpdates(BX,BZ,{config:BW,style:{params:{treesToRender:3}},params:Av.call(this,BY)});},setOutlineExpanding:function A5(BY,BZ,BW){var BX={act:"updateTemplate",keyContext:BY.unitKey,actions:[{act:"setOutlineExpanding",prs:"Template Formatting",pr:"OutlineLevelExpanding",v:BY.outlineLevel}]};this.submitUpdates(BX,BZ,e.copy(mstrmojo.DocDataService.RAPID_EXEC,{config:{silent:true},style:{params:{treesToRender:mstrmojo.DocDataService.EnumTreesToRender.BOTH}}}));},retrieveServerJson:function f(BY,Bi,BZ){if(mstrApp.isExpress&&!mstrApp.optimizeFitToPage&&n.call(this,this.model.zt)){return ;}var Bb=this.model,Bc=Bb.controller,Bg={},BW,BX,Be;var Bf=BY.nodes;if(Bf){Bg.partialRetrieval=Bf;}var Bh=BY.slices;if(Bh){Bg.slices=Bh;}if(BZ){BW=BZ.style;BX=BZ.config;Be=BZ.params;}if(!BX){BX={showProgress:true,hideProgress:true,progressStateText:AP};}var Bj=BY.style=e.clone(this.defaultStyle),Bd=mstrApp.isAppStatePause&&mstrApp.isAppStatePause();B(BW.params,Bj.params);var Ba={taskId:"getServerJSONResults",styleName:"ServerJsonRWDStyle",compress:1,rwb:this.rwb,messageID:this.msgId,stateID:-1,excludeData:!!(Bd||mstrConfig.resolveOnly),params:JSON.stringify(Bg),treesToRender:Bj.params.treesToRender};B(Be,Ba);BX.preserveUndo=(BZ&&BZ.preserveUndo)||false;Ap.call(this,Ba,Bi,BX);},downloadGridData:function J(BZ,Ba){var BY={act:"gridIncrementalFetch",nodeKey:BZ.nodeKey,rowPosition:BZ.rowPosition,maxRows:BZ.maxRows,colPosition:BZ.colPosition,sliceId:BZ.sliceId,maxColumns:BZ.maxColumns,rowMode:BZ.rowMode||1,partialRetrieval:this.newRetrievalKeysConfig().addNode(BZ.nodeKey)};if(BZ.partialUpdate){BY.partialUpdate=BZ.partialUpdate;}var BX=mstrmojo.all[BZ.xtabId],BW=BX&&BX.isCustomSort;this.submitUpdates(BY,Ba,e.copy(X(),{noUpdate:true,preserveStid:BW,config:{silent:true}}));},txMarkRows:function AX(BW,BX){if(mstrApp&&mstrApp.isNativeAndroid){mstrMobileTransport.applyTransactionMarkRow(BW.nodeKey,BW.sliceId,BW.rowOrdinal,BW.actionType);}else{Ap.call(this,{taskId:"markRow",rwb:this.rwb,nodeKey:BW.nodeKey,sliceId:BW.sliceId,rowOrdinal:BW.rowOrdinal,actionType:BW.actionType},BX);}},txChangeData:function z(BW,BX){if(mstrApp&&mstrApp.isNativeAndroid){mstrMobileTransport.applyTransactionDataChange(BW.nodeKey,BW.sliceId,JSON.stringify(BW.cells),BW.autoRefresh);}else{Ap.call(this,{taskId:"changeData",rwb:this.rwb,nodeKey:BW.nodeKey,sliceId:BW.sliceId,cells:BW.cells,autoRefresh:BW.autoRefresh},BX);}},sendTransactionActions:function c(BX,BY){var BW={taskId:"DocTransaction",rwb:this.rwb,keyContext:BX.keyContext,actions:BX.actions,messageID:this.msgId};if(BX.txrcd){BW.isPending=BX.txrcd.pending;BW.timestamp=BX.txrcd.timestamp;}Ap.call(this,BW,BY,{silent:!!BY});},newUpdate:function BB(BY,BX){var BW=new mstrmojo.DocDataService.Update(BX);BW.ds=this;BW.cmd=BY;return BW;},newUpdateWithoutCmd:function l(BX){var BW=new mstrmojo.DocDataService.Update(BX);BW.ds=this;return BW;},newRetrievalKeysConfig:function Ah(){return new mstrmojo.rw.model.RetrievalKeysConfig();},newUpdateKeysConfig:function R(){return new mstrmojo.rw.model.UpdateKeysConfig();},submitCmd:function BI(BX,BW){this.newUpdate(BX,BW).submit();},submitUpdates:function Ak(Bf,Bl,Bc){Bf=As(Bf);var Bb={actions:Bf},BW,BZ,Bi,BY=false;V.forEach(Bf,function Be(Bn){if(Bn.disablePU){BY=true;delete Bn.disablePU;}V.forEach(Bn.actions,Be);return !BY;});if(!BY){var BX=mstrmojo.rw.model.RetrievalKeysConfig.getConsolidatedConfig(Bf),Bk=mstrmojo.rw.model.UpdateKeysConfig.getConsolidatedConfig(Bf);if(!e.isEmpty(BX)){Bb.partialRetrieval=BX;}if(!e.isEmpty(Bk)){Bb.partialUpdate=Bk;}}if(Bc){BW=Bc.style;BZ=Bc.config;Bi=Bc.params;}if(!BZ){BZ={showProgress:true,hideProgress:true,progressStateText:AP};}if(!BW){Bb.style=this.defaultStyle;}else{var Bm=Bb.style=e.clone(this.defaultStyle);B(BW.params,Bm.params);}Bb.style.name=(BW&&BW.name)||mstrApp.styleName;var Bd={taskId:"mojoRWManipulation",rwb:this.rwb,messageID:this.msgId,stateID:-1,params:JSON.stringify(Bb)};B(Bi,Bd);BZ.preserveUndo=(Bc&&Bc.noUpdate)||false;BZ.preserveStid=(Bc&&Bc.preserveStid)||false;var Bh=this,Bj=true,Ba=AA.override({success:function(Bn,Bo){if(Bn.status===2){Bj=false;Bh.submitUpdates([],Bl,Bc);}else{Bj=true;return this._super(Bn,Bo);}},complete:function(){if(this._super&&Bj){this._super();}}},B(Bl));if(!(Bc&&Bc.hideCancel)){BZ.waitBoxCfg=e.copy({showCancel:true},BZ.waitBoxCfg);}if(Bc&&Bc.message){BZ.waitBoxCfg=e.copy({message:Bc.message},BZ.waitBoxCfg);}var Bg=mstrApp.isAppStatePause&&mstrApp.isAppStatePause();if(Bc&&Bc.resolveOnly!==undefined){Bd.resolveOnly=Bc.resolveOnly;}else{if(Bg){Bd.resolveOnly=true;}}if(Bc&&Bc.excludeData!==undefined){Bd.excludeData=Bc.excludeData;}else{if(Bg){Bd.excludeData=true;}}if(Bc&&Bc.noDeltaXML!==undefined){Bd.noDeltaXML=Bc.noDeltaXML;}if(Bd.resolveOnly&&Bd.excludeData){mstrApp.enableUpdate=true;}Ap.call(this,Bd,Ba,BZ);},submitTemplateUpdates:function AC(BW,BY,BZ,BX){this.submitUpdates(this.getUpdateTemplateAction(BW,BY),BZ,BX);},getUpdateTemplateAction:function Ae(BW,BY,BX){return{act:"updateTemplate",keyContext:BW,partialRetrieval:this.newRetrievalKeysConfig().addNode(BW,BX),partialUpdate:{selectors:BY.selectors},actions:As(BY)};},addUpdateTemplateAction:function BO(BY,BW,BX){BY.addActions(this.getUpdateTemplateAction(BW,BX));},applySegment:function AU(BX,BW,BY){Ap.call(this,{taskId:"applySegment",rwb:this.rwb,segmentID:BX,nodeKey:BW},BY);},getPageByTree:function AW(BW){mstrApp.serverRequest({taskId:"getPageByTree",msgID:this.msgId},BW);},getUserDICubeInfo:function a(BW,BX){Ap.call(this,{taskId:"getUserDICubeInfo",cubeIds:BW.join(",")},BX);},applySorts:function BA(BX,BY,BW,BZ){Ap.call(this,{taskId:"applySorts",key:BX,sortType:BY,sortList:BW},BZ,mstrmojo.DocDataService.PROGRESS_CONFIG);},getAddNewDerivedMetricToDatasetSubmitFunc:function A7(BX){var BW=this;return function(Ba){var Bb=BW.model,BZ=Bb.controller,BY=e.copy(Ba,BX),Bc=[Ao.call(BW,BY,true)],Bd=Bb.getDatasetsUpdateCallback();if((BY.mptf||{}).dirty||this.enablePTO){Bc.push(AL(BY));}BZ.submitUndoRedoUpdates(Bc,null,Bd,{style:{params:{treesToRender:1}}});};},getAddNewDerivedMetricToXtabSubmitFunc:function Aw(BX){var BW=this;return function(Bb){var Bc=BW.model,Ba=Bc.controller,BZ=e.copy(Bb,BX),BY=BZ.idx,Be=[],Bf=AA.wrapMethods(Bc.getDatasetsUpdateCallback(),Ba._getXtabCallback(BZ.host));Be.push(Ao.call(BW,BZ,true));if((BZ.mptf||{}).dirty||this.enablePTO){Be.push(AL(BZ,true));}if(BZ.replace){Be.push(BW.getUpdateTemplateAction(BZ.nodeKey,[BZ.host.model.getRemoveTemplateUnitAction({did:BZ.replace.did,t:BZ.replace.t})]));}else{BY++;}var Bd=BW.getUpdateTemplateAction(BZ.nodeKey,[BZ.host.model.getAddTemplateUnitAction({did:"$GUID_135",t:4},BZ.dsid,BZ.zoneid,BY),{act:"renameUnit",id:"$GUID_135",type:4,name:BZ.alias,isDynamicAlias:false}]);Be.push(Bd);Ba.submitUndoRedoUpdates(Be,null,Bf);};},getAddNewDerivedMetricToDropzoneSubmitFunc:function AI(BX){var BW=this;return function(Bd){var Be=BW.model,Bf=Be.controller,Bh=e.copy(Bd,BX),Bj=Bh.host.zonesModel,Bk=Bh.idx,Bc=[],BY=[],Bi={id:Bh.zoneid},Bg={did:"$GUID_135",t:4},Bl=AA.wrapMethods(Be.getDatasetsUpdateCallback(),Bf._getXtabCallback(Bh.host));Bc.push(Ao.call(BW,Bh,true));if((Bh.mptf||{}).dirty||this.enablePTO){Bc.push(AL(Bh));}if(Bh.replace){var Ba={did:Bh.replace.did,t:Bh.replace.t};Array.prototype.push.apply(BY,Bj.getRemoveDropZoneUnitActions(Bi,Ba));}else{Bk++;}BY.push(Bj.getAddDropZoneUnitAction(Bi,Bg,Bk,{datasetId:Bh.dsid}));if(Bh.extraZone){BY.push(Bj.getAddDropZoneUnitAction({id:Bh.extraZone.id},Bg,Bh.extraZone.idx,{datasetId:Bh.dsid}));}if(!Bh.replace){var BZ=(BX.zoneid===4)?1:2,Bb=Bj.getAddMetricNameAction(BX.host,BZ);if(Bb){Bc.push(Bb);}}if(!Bh.replace&&Bj.gmZones){Bb=Bj.gmZones.getUpdateGroupInfoActionForNewMetric(BX.zoneid,Bk,true);if(Bb){Bc.push(Bb);}}Bj.checkAndAddThresholdAction(Bh.zoneid,Bg,BY);Bc.push(BW.getUpdateTemplateAction(Bh.nodeKey,BY));Bf.submitUndoRedoUpdates(Bc,null,Bl);};},getEditDerivedMetricSubmitFunc:function k(BX){var BW=this;return function(Ba){var Bc=BW.model,BZ=Bc.controller,BY=e.copy(Ba,BX),Bb=BX.nodeKey,Bd={act:"editDM",formula:BY.tokenStreamXML,isTokenStream:!mstrmojo.string.isEmpty(BY.tokenStreamXML),afb:BX.afb,sfb:BX.sfb,dsid:BY.dsid||"",did:BY.did},Be=[Bc.addUpdateObjects(Bd,{id:BY.did,type:4,flag:mstrmojo.DocDataService.PARTIAL_UPDATE_FLAGS.DATA_CHANGE})],Bf=AA.wrapMethods(Bc.getDatasetsUpdateCallback(),BZ.getPartialUpdateCallback());if(mstrApp.isSingleTier&&BX.originTokenStream){Bd.originFormula=BX.originTokenStream;Bd.originAfb=BX.originAfb;Bd.originSfb=BX.originSfb;}if((BY.mptf||{}).dirty){Be.push(AL(BY));}if(Bb){Be.push(BW.getUpdateTemplateAction(Bb,[{act:"renameUnit",id:BY.did,type:4,name:BY.alias,isDynamicAlias:false}]));}else{Bd.name=BY.alias;}BZ.submitUndoRedoUpdates(Be,null,Bf,{style:{params:{treesToRender:mstrmojo.DocDataService.EnumTreesToRender.BOTH}}});};},resetSelections:function BE(BX,BW,BY){Ap.call(this,{taskId:"resetSelections",rwb:this.rwb,unitKeyContext:BX||"",usePartDisplay:BW?"0":"1",treesToRender:BW?3:2},BY);},setPreference:function F(BW,BX){Ap.call(this,{taskId:"setPreference",prefs:BW},BX);},getObjectInfo:function Ac(BW,BX){Ap.call(this,B(BW,{taskId:"getObjectInfo"}),BX,X());},addSuppressData:function A1(BW){if(BR(BW)===mstrmojo.DocDataService.EnumTreesToRender.NONE){e.copy({params:{suppressData:true}},BW);}},uploadImageToServer:function(BY,BZ){var BX={taskId:"importImage",imageFieldName:"imageData",isEdit:1,fieldKey:BY.fieldKey,fieldName:BY.fieldName,imageName:encodeURIComponent(BY.imageName),imageSize:BY.imageSize,nodeKey:BY.nodeKey,sectionKey:BY.sectionKey,msgID:this.msgId||""};if(mstrApp.isSingleTier){var BW=";base64,";BX.rwNodeKey=BY.fieldGroupKey;BX.imageData=BY.base64Str.split(BW)[1]||BY.base64Str;mstrApp.serverRequest(BX,BZ);}else{BX.imageData=BY.imageData;mstrmojo.xhr.upload("POST",mstrConfig.taskURL,BZ,BX);}}});mstrmojo.DocDataService.Update=mstrmojo.declare(null,null,{scriptClass:"mstrmojo.DocDataService.Update",actions:null,callback:null,extras:null,init:function Am(BW){B(BW,this);this.actions=this.actions||[];this.callback=this.callback||{};this.extras=this.extras||{};},addActions:function Ag(BW){this.actions=this.actions.concat(As(BW));},addCallbacks:function A3(BW){this.callback=AA.wrapMethods(this.callback,BW);},addExtras:function Aa(BX){var BW=BR(BX),BY=BR(this.extras);this.extras=B(BX,this.extras);if(BW!==undefined&&BY!==undefined){this.extras.style.params.treesToRender|=BY;}},addUpdate:function Ad(BW){this.add(BW.actions,BW.callback,BW.extras);},setTreesToRender:function BV(BW){if(BW){this.addExtras({style:{params:{treesToRender:BW}}});}return this.extras.style.params.treesToRender;},add:function b(BX,BY,BW){if(BX){this.addActions(BX);}if(BY){this.addCallbacks(BY);}if(BW){this.addExtras(BW);}},submit:function AD(){var BX=this.actions,BY=this.callback,BW=this.extras;if(this.cmd){this.cmd.submit(BX,BY,BW);}else{this.ds.submitUpdates(BX,BY,BW);}}});mstrmojo.DocDataService.PUInfoType=null;mstrmojo.DocDataService.ExtrasType=null;mstrmojo.DocDataService.PROGRESS_CONFIG={showProgress:true,hideProgress:true,progressStateText:AP,delay:true};mstrmojo.DocDataService.UNDO_KEY="undo";mstrmojo.DocDataService.REQUEST_DEFN_DATA={style:{params:{treesToRender:3}}};mstrmojo.DocDataService.REQUEST_ONLY_DEFINITION={style:{params:{treesToRender:1}}};mstrmojo.DocDataService.REQUEST_ONLY_DATASETS={style:{params:{treesToRender:0}}};mstrmojo.DocDataService.SUPPRESS_DATA={params:{suppressData:true}};mstrmojo.DocDataService.RAPID_EXEC={params:{suppressData:true,rapidExec:true}};mstrmojo.DocDataService.EMPTY_CALLBACK={success:mstrmojo.emptyFn};mstrmojo.DocDataService.CopyMoveDestinationType=null;mstrmojo.DocDataService.PARTIAL_UPDATE_FLAGS={FORMAT_CHANGE:1,DATA_CHANGE:2};mstrmojo.DocDataService.EnumTreesToRender={NONE:0,DEFN:1,DATA:2,BOTH:3};}());(function(){mstrmojo.requiresCls("mstrmojo.Obj","mstrmojo.array");var C=mstrmojo.array;mstrmojo.ObjectBrowserDataProvider=mstrmojo.declare(mstrmojo.Obj,null,{scriptClass:"mstrmojo.ObjectBrowserDataProvider",path:mstrConfig.taskURL,serverRequest:function(D,E){if(mstrApp&&mstrApp.serverRequest){mstrApp.serverRequest(D,E,{silent:true});}else{mstrmojo.xhr.request("POST",this.path,E,D,undefined,this.XServer,this.baseParams);}},fetchFolderContents:function(D,E,H){var F=D.blockCount,G={taskId:"searchMetadata",styleName:"MojoFolderStyle",blockCount:F,includeAncestorInfo:"true",includeObjectDesc:D.includeObjectDesc,encodeObjectInfo:false};if(D.folderLinksContextId){G.folderLinksContextId=D.folderLinksContextId;}if(D.sId){G.sessionState=D.sId;}if(E.fid){G.rootFolderID=E.fid;}else{if(E.fty){G.rootFolderType=E.fty;}}if(D.browsableTypes){G.objectType=D.browsableTypes;}if(E.blockBegin){G.blockBegin=E.blockBegin;}if(E.searchPattern){if(D.enableQuickSearch){G.quickSearch=D.enableQuickSearch;}G.searchPattern=E.searchPattern;if(E.recursive){G.recursive=E.recursive;}}this.serverRequest(G,H);},newFolder:function(G,H,F,D){var E={taskId:"createFolder",taskContentType:"json",folderID:G,name:H,description:F};this.serverRequest(E,D);},loadObjects:function B(H,I,D,G){var E=[],F=[];C.forEach(H,function(J){E.push(J.did);F.push(J.t);});if(H.length>0&&G){this.serverRequest({taskId:"getObjectInfo",objectIDs:E.join(","),objectTypes:F.join(","),includeDetails:true},I,D);}else{I.success();}},loadRecentSaveAsFolders:function A(E){var D={taskId:"getRecentSaveAsFolders"};this.serverRequest(D,E);}});}());(function(){mstrmojo.requiresCls("mstrmojo.Obj","mstrmojo.warehouse.EnumObjectTypes");var B=mstrmojo,C=B.hash,F=B.array,G=mstrmojo.warehouse.EnumObjectTypes;function D(K,L){var M=[];F.forEach(K,function(N){if(N.tp===L){M.push(N);}});return M.sort(function(O,N){return(O.n<N.n)?-1:(O.n>N.n)?1:0;});}mstrmojo.warehouse.obj.TableData=mstrmojo.declare(mstrmojo.Obj,null,{scriptClass:"mstrmojo.architect.obj.TableData",init:function I(N){var M=N.model,L=function(Q,P){return M.handleVisibleAction(Q,P);},K=function(Q,P){return M.handleCheckAction(Q,P);},O=function(Q,P){return M.handleEnabledAction(Q,P);};this.did=N.id;this.n=N.n;this.items=[];this.isVisible=L;this.isChecked=K;this.isEnabled=O;this.tp=N.tp;this.model=M;this.multi=N.multi;this.isLeaf=N.isLeaf;this.bold=N.bold;this.dbrole=N.dbrole;this.ns=N.ns||"";this.isError=N.isError;this.ttp=N.ttp||"";this.sta=N.sta||0;this.isLocked=N.isLocked;this.size=N.size;this.dbtn=N.dbtn||N.n;this.isView=N.isView;this.icntp=N.icntp;},model:undefined,multi:false,did:undefined,n:undefined,items:undefined,isVisible:undefined,isEnabled:undefined,isChecked:undefined,isLocked:false,size:0,isLeaf:false,bold:false,dbrole:undefined,tp:undefined,x:undefined,y:undefined,w:undefined,h:undefined,isError:false,ttp:"",sta:0,dbtn:undefined,ns:"",italics:false,addItem:function H(L,K,Q,R,U,N,P,O){var M=this,S={pdid:M.did,did:L,n:K,tp:Q,bfIdx:R,isVisible:M.isVisible,isChecked:M.isChecked,items:[],ttp:U,isLeaf:N,bold:P,unused:O};M.items.push(S);return S;},addSubItem:function J(Q,L,K,P,R,S,V,N,O){var M=this,U={pdid:M.did,did:L,sid:Q,n:K,tp:P,bfIdx:R,fcatId:S,isVisible:M.isVisible,isChecked:M.isChecked,ttp:V,isLeaf:N,bold:O};C.forEach(M.items,function(W){if(W.did===Q){W.items.push(U);return false;}return true;});return U;},addSubItemItem:function A(P,R,L,K,Q,S,U,W,N,O){var M=this,V={pdid:M.did,did:L,sid:P,n:K,tp:Q,bfIdx:S,fcatId:U,isVisible:M.isVisible,isChecked:M.isChecked,ttp:W,isLeaf:N,bold:O};C.forEach(M.items,function(X){if(X.did===P){C.forEach(X.items,function(Y){if(Y.did===R){Y.items=Y.items||[];Y.items.push(V);return false;}return true;});return false;}return true;});return V;},sortElements:function E(){var M=this,K=M.items,L=[];M.items=L.concat(D(K,G.ATTRIBUTE),D(K,G.FACT),D(K,G.COLUMN));}});}());(function(){mstrmojo.requiresCls("mstrmojo.Obj");var D={TOP_LEFT:1,TOP_RIGHT:2,BOTTOM_RIGHT:3,BOTTOM_LEFT:4};var C={LEFT_TO_RIGHT:0,RIGHT_TO_LEFT:1};mstrmojo.ui.PopupConfig=mstrmojo.declare(mstrmojo.Obj,null,{scriptClass:"mstrmojo.ui.PopupConfig",ENUM_CORNERS:D,isHostedWithin:true,position:null,hostProxyCssClass:"",hostId:"",hostElement:null,anchorElement:null,popupHandlers:null,alignment:null,alignWithAnchor:false,useTooltip:false,useDarkTheme:false,init:function H(I){this.clear();this._super(I);},setAlignment:function E(I,J){this.alignment={host:I,popup:J};},addPopupHandlers:function F(I,K,J){this.popupHandlers[I]={open:K,close:J};},clear:function B(){this.popupHandlers={};var I=this.ENUM_CORNERS;this.alignment={host:I.BOTTOM_LEFT,popup:I.TOP_LEFT};},destroy:function(I){this.anchorElement=null;this.hostElement=null;if(this._super){this._super(I);}}});mstrmojo.ui.PopupConfig.ENUM_CORNERS=D;mstrmojo.ui.PopupConfig.directionCfg={menuDirection:C.LEFT_TO_RIGHT,isRightToLeft:function G(){return this.menuDirection===C.RIGHT_TO_LEFT;},setDirection:function A(I){this.menuDirection=I?C.RIGHT_TO_LEFT:C.LEFT_TO_RIGHT;}};}());(function(){mstrmojo.requiresCls("mstrmojo.hash","mstrmojo.array","mstrmojo.expr","mstrmojo.func","mstrmojo.css","mstrmojo.UUID","mstrmojo.fe.FilterUtils","mstrmojo.desc");var Q=mstrmojo.func,L=mstrmojo.hash,J=mstrmojo.array,N=mstrmojo.expr,U=mstrmojo.css,R=N.DTP,F=mstrmojo.UUID,V=mstrmojo.fe.FilterUtils,U=mstrmojo.css;var H=16,E=32;function O(a,Z,c){var X=L.copyProps(["did","t","st","n"],a),Y=(a.fs||[]).filter(function(d){return d.fnm==="LEVEL_NUMBER"||d.n==="LEVEL_NUMBER";})[0],b;if(Z){b={et:N.ET.AE,fn:N.FN.DESCENDANT,a:X,es:[{v:Z.v,n:Z.n}]};if(parseInt(c,10)>=Z.lv){b.cs=[{v:c-Z.lv,dtp:R.INTEGER},{v:2,dtp:R.INTEGER}];}}else{if(parseInt(c,10)>=0&&Y){b={et:N.ET.AQ,fn:N.FN.EQUAL,a:X,fm:{did:Y.did||Y.fid,n:Y.n||Y.fnm,dtp:R.INTEGER},cs:[{v:c,dtp:R.INTEGER}]};}}return b?V.getExprXml(b):"";}mstrmojo.ui._IsIncFetchHierarchyList=mstrmojo.provide("mstrmojo.ui._IsIncFetchHierarchyList",{_mixinName:"mstrmojo.ui._IsIncFetchHierarchyList",blockCount:500,getDataHelper:mstrmojo.emptyFn,getAttribute:mstrmojo.emptyFn,isHiearachyDisplay:mstrmojo.emptyFn,getItemMarkup:function C(Z,X){var Y;if(Z.fetcher){Y='<{@tag} class="item fetcher {@cls}" idx="{@idx}" style="{@style}"><span class="indent" style="padding-left: {@indent}px;"></span><span class="text">{@en@n}</span></{@tag}>';}else{Y=this._super(Z,X);}return Y;},isFetcher:function K(X){if(X instanceof HTMLElement){X=this.getItemFromTarget(X);}return X&&X.fetcher;},fetchItems:function I(X,Y){this._super(X,Q.wrapMethods(this.getFetchItemsCallback(X),Y));},fetchItemsThroughTaskCall:function P(b,g){var a=this.getDataHelper(),Z=this.getAttribute();if(a&&Z&&!this.isFetching){this.set("isFetching",true);var d=this,e=b.branch,X=parseInt(b.level,10),c=b.blockBegin||1,f=b.blockCount||this.blockCount,Y=b.browseFlags||0;a.set("browseConfig",L.copy({blockBegin:c,blockCount:f,browseFlags:Y,expressionXML:(e||X>=0)?O(Z,e,X):"",otp:Z.t,compress:1},L.copy(a.browseConfig)));a.getItems(c,Q.wrapMethods({success:function(h){if(h){L.copy({bb:c,bc:f},h);J.forEach(h.es,function(j){if(!j.pid&&j.pi>-1){j.pid=h.es[j.pi].v;delete j.pi;}L.copy({lv:j.lv||0,hcd:!!j.hcd,hid:!!j.hid,dhid:!!j.hid,pid:j.pid||""},j);});}}},g,{complete:function(h){d.set("isFetching",false);}}),{hideFailureErr:g.failure});}},getFlatDisplayItems:function B(X){return X.filter(function(Y){var Z=Y.fhid;delete Y.fhid;return !Z;});},getFetchItemsCallback:function M(a){var Z=this,Y=a.branch,b=parseInt(a.level,10),X=this.isHiearachyDisplay();return{success:function(c){if(c&&c.es){var e=c.es,d=c.bb+c.bc-1;if(c.sz>d&&!c.raad){e.push({v:"fetcher"+F.create(),n:mstrmojo.desc(1005,"More..."),fetcher:true,lv:X?(b>=0?b:(Y?Y.lv+1:0)):-1,config:L.copy({blockBegin:d+1},L.copy(a))});}if(!X){e.forEach(function(g){var h=g.hid,f=Z.getItemByValue(g.v);delete g.epd;delete g.hid;if(f){delete g.hcd;}L.copy({fhid:h,dhid:!f||f.dhid},g);});}if(Z.setDisplayParent){Z.setDisplayParent(e,null,true);}}}};},getMaxLevel:function A(){var X=this.getAttribute(),Y=(X&&X.lvfs||[]).length;if(Y>0){return Y-1;}return this._super?this._super():0;},getLevels:function D(){var X=this.getAttribute(),Y=X&&X.lvfs||[];return Y.map(function(a,Z){return{v:Z,n:a.lvfn};});},initElements:function S(c){if(this.isHiearachyDisplay()){delete this.displayRoots;var Z=this.getItems(),Y=Z.length,b,X;if(Y>0){if(this.raad){for(var a=Y-1;a>-1;a--){b=Z[a];if(b.fetcher&&b.fake){b.hid=true;X=J.find(b.parent&&b.parent.children,"idx",b.idx);if(X>-1){b.parent.children.splice(X,1);}X=J.find(b.displayParent&&b.displayParent.displayChildren,"idx",b.idx);if(X>-1){b.displayParent.displayChildren.splice(X,1);}}}}this.refresh();}else{this.fetchItems({browseFlags:E},c);}}else{this.clearItemsNode();this.fetchItems({blockCount:500,browseFlags:H},c);}},clearItemsNode:function G(){var X=this.itemsContainerNode;if(X){X.innerText="";this.updateScrollbars();}},onclick:function W(h){var e=h.getTarget(),Y=this.getItemNodeFromTarget(e),j=this.getItemFromTarget(e);if(j&&j.fetcher){if(U.hasClass(e,"text")){if(j.fake){var d=function(k){if(k.displayParent){if(!k.displayParent.hid){return k.displayParent;}else{return d(k.displayParent);}}},b=d(j),a=b?b.displayChildren:this.getDisplayRoots(),f=this.items,X=j.config.nextSiblingIdx,c=this.blockCount,Z=X+c,g;if(a.length-1>Z){g=a.slice(X,Z);j.config.nextSiblingIdx+=c;j.lv=g[g.length-1].lv;g.push(j);}else{a.pop();if(j.parent){j.parent.children.pop();}f.splice(J.find(f,"idx",j.idx),1);g=a.slice(X,a.length);}Y.outerHTML=this._buildSiblingsMarkup(g).join("");this.updateScrollbars();}else{this.fetchItems(j.config,{success:function(k){j.hid=true;Y.outerHTML="";}});}}h.cancel();}else{this._super(h);}},});}());(function(){mstrmojo.requiresCls("mstrmojo.ui.PopupConfig","mstrmojo.array","mstrmojo.hash","mstrmojo.css","mstrmojo.ui._HasUITheme","mstrmojo.vi.ui.theme","mstrmojo.dom");function g(h,k){if(!mstrmojo.DocInfoWindow){return ;}var j=h;while(j){if(j instanceof mstrmojo.DocInfoWindow){j[k?"registerScrollLock":"releaseScrollLock"](this);break;}j=j.parent;}}var N=mstrmojo.array,D=mstrmojo.dom,S=mstrmojo.hash,e=mstrmojo.css,G="px",K=mstrmojo.ui._HasUITheme.EnumThemeNames;var C=false;function M(h,k){if(!mstrmojo.DocInfoWindow){return ;}var j=h;while(j){if(j instanceof mstrmojo.DocInfoWindow){j[k?"registerLock":"releaseLock"](this);this.lockIW=k?j:null;break;}j=j.parent;}}var W=mstrmojo.ui.PopupConfig,O=W.directionCfg,B=W.ENUM_CORNERS,Z=B.TOP_LEFT,V=B.TOP_RIGHT,I=B.BOTTOM_RIGHT,H=B.BOTTOM_LEFT;function J(h){return(h===H||h===Z);}function d(h){return(h===V||h===I);}function Q(h){return(h===I||h===H);}function U(h){return(h===V||h===Z);}function a(q,k,AB,AH){var AK=AB.x,AJ=AB.y,AG=AB.w||0,u=AB.h||0,j=AH.w,AC=AH.h,AF=q.alignment,o=AF.popup,m=AF.host,AI=d(m),AL=Q(m),AE=false,z=false,l=false,AA=false,n=false,w=false,AD=D.isMobile,r=mstrmojo.ui.PopupConfig.directionCfg;if(J(o)){var p=AK+j+(AI?AG:0);AE=k.w<p;n=AD&&(AE||r.isRightToLeft());}if(U(o)){var x=AJ+AC+(AL?u:0);z=k.h<x;w=AD&&z;}if(d(o)||n){var t=AK-j+((AI&&!n)?AG:0);l=t<0;}if(Q(o)||w){var h=AJ-AC+((AL&&!w)?u:0);AA=h<0;}return{top:AA,bottom:z,left:l,right:AE};}function F(j){var h=this.popupConfig;if(h){S.forEach(h.popupHandlers,function(l,m){var k=l[j?"open":"close"];if(k){k.call(mstrmojo.all[m]||k,!!j);}});}}function L(j){var h=this.popupConfig;if(h&&!h.isHostedWithin){var k=this.hostProxy;if(k){k.style.display=j?"":"none";}}}function f(h){return h!==undefined&&h!==null&&!isNaN(h);}mstrmojo._IsPopup={visible:false,lockIWForScroll:false,disposable:true,opener:null,onOpen:mstrmojo.emptyFn,onClose:mstrmojo.emptyFn,popupConfig:null,hostProxy:undefined,open:function P(k,h){F.call(this,true);if(this.updatePopupConfig){this.updatePopupConfig(h,k);}else{S.forEach(h,function(n,m){this.set(m,n);},this);}var j="popup-mid-render";this.set("opener",k);if(!this.hasRendered){var l=this.visible;this.visible=false;this.render();e.addClass(this.domNode,j);this.set("visible",l);}if(this.nudge){this.domNode.style.top="-10000px";}L.call(this,true);this.set("visible",true);if(this.lockIWForScroll){g.call(this,this.opener,true);}if(h&&h.lockIW){M.call(this,h.lockIW,true);}if(this.nudge){this.nudge();}if(this.adjustSize){this.adjustSize();}this.adjustCornersForPopupOverflow();this.onOpen();e.removeClass(this.domNode,j);},adjustCornersForPopupOverflow:function b(){var t=this.popupConfig;if(!t){return false;}var AZ=(t.includeScroll!==undefined)?t.includeScroll:true;var n=t.anchorElement||t.hostElement,l=t.position||D.position(n,AZ),AF=n&&n.style&&n.style.zIndex;if(!t.isHostedWithin){var Ah=this.hostProxy,AY=this.hostProxy=document.createElement("div");document.body.appendChild(AY);AY.appendChild(this.domNode);if(Ah){Ah.parentNode.removeChild(Ah);}var AP=AY.style,AQ={x:"left",y:"top",w:"width"};AY.className=t.hostProxyCssClass;AP.position="absolute";AP.background="none";e.addClass(AY,"mstrmojo-popup-widget-hosted");AP.height="0";N.forEach(["x","y","w"],function(Aq){var Ap=l[Aq];if(f(Ap)){AP[AQ[Aq]]=Ap+G;}});}var AE=t.ENUM_CORNERS,An=AE.BOTTOM_LEFT,AR=AE.BOTTOM_RIGHT,j=AE.TOP_RIGHT,AK=AE.TOP_LEFT;var q=D.position(document.body),AT=D.position(this.domNode),Ac=a(t,q,l,AT),p=Ac.right,AD=Ac.bottom,Ao=Ac.left,AX=Ac.top,AG=t.alignment,AO=AG.popup,k=AG.host,x=AO,AC=k,AS=D.isMobile,AB=n&&n.classList&&n.classList.contains("mstrmojo-ui-Menu-item"),AU=this.id,z=n&&n.parentNode,AV=z&&z.parentElement,AN=n||this.domNode,AL,Ai=this.domNode.style;if(AV&&AV.classList.contains("mstrmojo-ui-Menu")){AN=AV;}AL=D.position(AN);if(AB&&((Ao&&p)||(AX&&AD))){if(AV){Ai.top=AL.y+"px";Ai.left=AL.x+"px";var Ag=document.getElementsByClassName("mstrmojo-ui-Menu");N.forEach(Ag,function(Ap){if(AU!==Ap.id){Ap.style.visibility="hidden";}});}t.anchorElement=AN;t.position={h:0,w:0,x:(AL.x+AT.w)>q.w?Math.min(AL.x,5):AL.x,y:(AL.y+AT.h)>q.h?Math.min(AL.y,90):AL.y};this.adjustCornersForPopupOverflow();return ;}if(O.isRightToLeft()&&(!AS||AT.w>0)){if(!AS||!Ao){p=true;}else{if(!AS||!p){O.setDirection(false);this.resetDirection=true;if(AS){AC=(AC===j)?AK:An;}}}}else{if(p){O.setDirection(true);this.resetDirection=true;}}if(p||Ao){if(J(AC)){AC=U(AC)?j:AR;}else{if(d(AC)){AC=U(AC)?AK:An;}}if(p&&J(x)){x=U(x)?j:AR;}else{if(Ao&&d(x)){x=U(x)?AK:An;}}}if(AD||AX){if(J(AC)){AC=U(AC)?An:AK;}else{if(d(AC)){AC=U(AC)?AR:j;}}if(AD&&U(x)){x=J(x)?An:AR;}else{if(AX&&Q(x)){x=J(x)?AK:j;}}}if(AX||p||AD||Ao){if(C){console.log("Overflow directions: "+JSON.stringify(Ac));}this._orgalgn={host:k,popup:AO};t.setAlignment(AC,x);}if(!t.isHostedWithin){if(f(l.y)&&f(l.h)){this.hostProxy.style.top=(l.y+(Q(x)?(t.alignWithAnchor===true?l.h:0):(t.alignWithAnchor===true?0:l.h)))+G;this.hostProxy.style.zIndex=(f(AF)&&(AF>100))?AF+1:101;}}var AW,Ak={};if(t.isHostedWithin&&!!this.opener){AW=e.getComputedStyle(this.opener.domNode);}N.forEach(["left","right","top","bottom"],function(Ap){Ak[Ap]=AW?parseInt(AW["border-"+Ap+"-width"]||0,10):0;});var Ae=Q(AC),Af=d(AC),w=Q(x),o=d(x),Aa=function(Aq,Ap){return"calc(100% + "+(Ap?Ak[Aq]:0)+"px)";},AA=function(Aq,Ap){return(Ap?-Ak[Aq]:0)+"px";};var r,Ab,h,m;r=Ab=h=m="auto";if(w){h=Ae?AA("top"):Aa("top");}else{r=Ae?Aa("bottom"):AA("bottom");}if(o){Ab=Af?AA("left"):Aa("left");}else{m=Af?Aa("right"):AA("right");}Ai.top=r;Ai.right=Ab;Ai.bottom=h;Ai.left=m;var u=D.position(this.domNode),AM=5;if(AD||AX){var Al=u.y,AH=D.getMaxScrollHeight()+"px",Aj=this.scrollNode,AI=Aj&&Aj.style.maxHeight;if(Al<0||(Al+u.h>q.h)){if(Aj&&AH!==AI){Aj.style.maxHeight=AH;this.updateScrollbars();}var Ad=(-l.y+AM)+G;if(!t.isHostedWithin){if(this.hostProxy){this.hostProxy.style.top=0;}Ad=AM+G;}Ai.top=Ad;Ai.bottom="auto";}}if(Ao||p){var Am=u.x;if(Am<0||(Am+u.w>q.w)){var AJ=(-l.x+AM)+G;if(!t.isHostedWithin){if(this.hostProxy){this.hostProxy.style.left=0;}AJ=AM+G;}Ai.left=AJ;Ai.right="auto";}}return true;},close:function R(j){if(this.keepOpen){return ;}if(this.onClose){this.onClose(j);}L.call(this,false);if(this.lockIWForScroll){g.call(this,this.opener,false);}this.set("visible",false);this.set("opener",null);if(this.lockIW){M.call(this,this.lockIW,false);}F.call(this,false);var h=this._orgalgn;if(h){this.popupConfig.setAlignment(h.host,h.popup);}if(this.resetDirection){this.resetDirection=false;O.setDirection(false);}},preBuildRendering:function A(j){this._super(j);var m=this.popupConfig;if(m&&!m.isHostedWithin){var h=m.hostProxyCssClass.split(" "),l=false;N.forEach(S.keyarray(K),function(n){if(h.indexOf(K[n])>=0){l=true;return false;}});if(!(l||m.noInheritTheme)){var k=mstrmojo.vi.ui.theme.getThemeClass.call(this);if(k){h.push(k);}}m.hostProxyCssClass=h.join(" ");}},buildRendering:function E(){var h=this._super();if(h){if(!this.parent&&!this.domNode.parentElement){document.body.appendChild(this.domNode);}}return h;},postBuildRendering:function Y(){var h=this,j=this.popupConfig;if(j&&!this._ListenerProc){this._ListenerProc=function(){h.monitorWindow();};D.attachEvent(window,"resize",this._ListenerProc);}this._super();},monitorWindow:function(){var j=D.getMaxScrollHeight();if(this.updateScrollbars&&this.scrollNode){this.scrollNode.style.maxHeight=(this.scrollNodeMaxHeight||j)+"px";this.updateScrollbars();}if(this.visible){var h=this,k=null;window.clearTimeout(k);k=window.setTimeout(function(){h.scrollNode.style.maxHeight=(h.scrollNodeMaxHeight||j)+G;h.adjustCornersForPopupOverflow();},175);}},destroy:function c(h){if(this._ListenerProc){D.detachEvent(window,"resize",this._ListenerProc);delete this._ListenerProc;}this._super(h);},unrender:function X(h){if(this.popupConfig&&!this.popupConfig.isHostedWithin&&this.hostProxy){document.body.removeChild(this.hostProxy);delete this.hostProxy;}this._super(h);}};}());(function(){mstrmojo.requiresCls("mstrmojo.Obj","mstrmojo.warehouse.dbroles.DBRoleHelper","mstrmojo.warehouse.obj.TableData");mstrmojo.requiresDescs(4572,11138,3651);var H=mstrmojo.array,G=mstrmojo.warehouse.dbroles.DBRoleHelper,C="PWDHIDDEN123!@#",A=mstrmojo.desc(4572,"Primary"),D=mstrmojo.warehouse.EnumObjectTypes.DBROLE;mstrmojo.warehouse.obj.DBRole=mstrmojo.declare(mstrmojo.Obj,null,{scriptClass:"mstrmojo.warehouse.obj.DBRole",init:function K(O){var M=this,L=(O&&O.mdDBRole);if(L){M.mdDBRole=L;M.n=L.n.toString();M.did=L.did;M.des=(!(L.des&&mstrApp.rootController.isCloud())?L.n:L.des||"").toString();M.data=new mstrmojo.warehouse.obj.TableData({id:L.did,n:L.n,tp:L.stp,model:O.mdl});}else{M.mdDBRole={n:G.getUniqueName(mstrmojo.desc(11138,"new data source #").replace("#","")),did:"",tp:29,stp:7424,writable:"1",vldbProperties:{}};M.n=M.mdDBRole.n;M.did=M.mdDBRole.did;M.data=new mstrmojo.warehouse.obj.TableData({id:M.mdDBRole.did,n:M.mdDBRole.n,tp:M.mdDBRole.stp,model:O.mdl});var N=mstrApp.rootController.getDBObjects().preferences;if(N&&N.vldbProperties){H.forEach(N.vldbProperties,function(P){M.mdDBRole.vldbProperties[P.propset]={};});}M.populated=true;}M.isManagedDBR=O&&O.isManagedDBR;M.data.isPrimary=M.isPrimary();},dbmsCatalogCacheMode:undefined,mdDBRole:{},n:"",did:"",tp:D,supportsNameSpaces:false,avoidColumnCaching:false,displayName:function J(){return this.n+(this.isPrimary()?" ("+A+")":"");},isPrimary:function I(){return(this.did===mstrApp.getRootController().getProjectPrimaryDBRoleID());},data:undefined,populated:false,isManagedDBR:false,populate:function F(M){var L=this;if(this.populated){M(L);}else{mstrApp.getRootController().populateDBRole(this.mdDBRole.did,{success:function(O){L.populated=true;L.mdDBRole=O.dbrs[0];if(typeof L.mdDBRole.vldbProperties==="string"){L.mdDBRole.vldbProperties=JSON.parse(L.mdDBRole.vldbProperties);}L.n=L.mdDBRole.n.toString();L.did=L.mdDBRole.did;var N=parseInt(L.mdDBRole.dbmsCatalogCacheMode,10);L.supportsNameSpaces=((N&1)===1);L.avoidColumnCaching=((N&2)===2||(N&4)===4);M(L);}});}},rename:function B(L){var M=mstrApp.rootController;this.mdDBRole.n=L;if(M.isCloud()){this.des=L;this.n=this.des+"___"+new Date().getTime();}else{this.n=L;}if(this.did!==""){this.mdDBRole.connstr=G.cleanDSNConnection(this.mdDBRole.connstr);M.saveDBRole(this,false,{success:function(){}});}},duplicate:function E(){var M=mstrApp.rootController,O=new mstrmojo.warehouse.obj.DBRole({mdDBRole:this.mdDBRole,mdl:this.data.model}),N=mstrApp.isSingleTier?"copy of ##":mstrmojo.desc(3651,"copy of ##"),L=G.getUniqueName(N.replace("##",M.isCloud()?this.des:this.n));O.did="";O.mdDBRole.did="";O.rename(L);O.mdDBRole.connstr=G.cleanDSNConnection(O.mdDBRole.connstr);O.mdDBRole.originalID=this.did;if(O.mdDBRole.password===C){delete O.mdDBRole.password;}M.saveDBRole(O,true,{success:function(){}});}});}());(function(){mstrmojo.requiresCls("mstrmojo.boxmodel","mstrmojo.DocDataService");mstrmojo.vi.models.PanelFormatSaver=mstrmojo.provide("mstrmojo.vi.models.PanelFormatSaver",{getPanelSaver:function A(C,B,D){return{saveProperty:function E(G,H){var J=B[G];if(J){if(J.convert){H=mstrmojo.boxmodel.px2Inches(C.getZoomProps(),H);}var I={},F=I[J.set]={};F[J.name]=H;C.updateUnitFormat(D||C.getRootNode(),1,I,undefined,mstrmojo.DocDataService.RAPID_EXEC);}}};}});}());(function(){mstrmojo.requiresCls("mstrmojo.Obj","mstrmojo.hash","mstrmojo.DI.DIDataService");mstrmojo.requiresDescs(889,7405,11163,12369);var X=mstrmojo.hash,M=mstrmojo.desc;var AC=M(889,"Please wait...");function K(AM,AL,AK){var AI=AL.showWait,AJ=AL.suppressError,AH=AL.waitMsg;delete AL.showWait;delete AL.suppressError;delete AL.waitMsg;mstrApp.serverRequest(AL,AM,AI,AJ,AH,undefined,undefined,AK);}mstrmojo.qb.DataService=mstrmojo.provide("mstrmojo.qb.DataService",{submitRequest:function AA(AI,AH){K.call(this,AI,AH);},archSpark:function AB(AJ,AI,AH){K.call(this,AJ,X.copy(AI,{taskId:"arch.spark",showWait:true}),AH);},pollingStatus:function c(AO,AI,AL,AM){var AK=this;if(mstrApp.isSingleTier){if(AO.success){AO.success(AI);}return ;}K.call(AK,{success:function AN(AP){if(AP.status==="1"){if(AO.success){AO.success(AI);}}else{AK.pollingStatus(AO,AI,AL);}},failure:function AJ(AP){if(AO.failure){AO.failure(AP);}},canceled:function AH(AP){if(AO.canceled){AO.canceled(AP,AI);}}},{taskId:"pollStatus",resultSetType:3,pollingFrequency:500,maxWait:60000,taskEnv:"xhr",taskContentType:"json",showWait:true,waitMsg:AL},AM);},taskByPollStatus:function r(AO,AH,AL,AM,AI,AN){var AK=this,AJ="pollStatus";if(mstrApp.isSingleTier){AJ=AN||"DIPollStatus";}K.call(AK,mstrmojo.DI.DIDataService.taskByPollStatusCb.call(AK,AO,AH,AL,AM,AI,AN),{taskId:AJ,resultSetType:3,threadId:AH.tid,maxWait:60000,taskEnv:"xhr",taskContentType:"json",isAsync:true,},AM);},search:function AE(AI,AH){K.call(this,AI,X.copy(AH,{taskId:"arch.search",showWait:true}));},searchFolderContents:function A(AI,AH){K.call(this,AI,X.copy(AH,{taskId:"searchMetadata",styleName:"MojoFolderStyle",includeAncestorInfo:false,includeObjectDesc:false,fields:"name",recursive:0}),{showProgress:true,showProgressText:true,progressText:AC});},createReportInstance:function Y(AI,AH){K.call(this,AI,X.copy(AH,{taskId:"qBuilder.CreateQBReportInstance",showWait:true,suppressError:true}));},createEmmaInstance:function B(AK,AJ){var AH=this;K.call(AH,{success:function AI(AL){mstrApp.msgid=AL.msgid;AH.pollingStatus(AK,AL,AC);}},X.copy(AJ,{taskId:"DICreateEMMAReportInstance",showWait:true,waitMsg:AC}));},createEmmaTable:function w(AK,AJ){var AH=this;K.call(AH,{success:function AI(AL){mstrApp.msgid=AL.msgid;AH.pollingStatus(AK,AL,AC);}},X.copy(AJ,{taskId:"DICreateEMMASourceTable",showWait:true,waitMsg:AC}));},changeMapping:function x(AK,AJ){var AH=this;K.call(AH,{success:function AI(AL){mstrApp.msgid=AL.msgid;AH.pollingStatus(AK,AL,AC);}},X.copy(AJ,{taskId:"qBuilder.RemapObject",showWait:true,waitMsg:AC}));},buildRelations:function a(AK,AJ){var AH=this;K.call(AH,{success:function AI(AL){mstrApp.msgid=AL.msgid;AH.pollingStatus(AK,AL,AC);}},X.copy(AJ,{taskId:"DIDetectRelationshipEMMASourceTable",showWait:true,waitMsg:AC}));},setDBRole:function o(AI,AH){K.call(this,AI,X.copy(AH,{taskId:"qBuilder.SetDBRole",showWait:false}));},getShapeKeys:function AG(AI,AH){K.call(this,AI,X.copy(AH,{taskId:"getMapShapes",showWait:false}));},addTable:function h(AK,AJ){var AH=this;K.call(AH,{success:function AI(AL){mstrApp.msgid=AL.msgid;AH.pollingStatus(AK,AL,AC);}},X.copy(AJ,{taskId:"qBuilder.AddTable",showWait:true,waitMsg:AC}));},removeTable:function V(AK,AJ){var AH=this;K.call(AH,{success:function AI(AL){mstrApp.msgid=AL.msgid;AH.pollingStatus(AK,AL,AC);}},X.copy(AJ,{taskId:"qBuilder.RemoveTable",showWait:true,waitMsg:AC}));},editTable:function H(AK,AJ){var AH=this;K.call(AH,{success:function AI(AL){mstrApp.msgid=AL.msgid;AH.pollingStatus(AK,AL,AC);}},X.copy(AJ,{taskId:"qBuilder.EditTable",showWait:true}));},addColumn:function j(AK,AJ){var AH=this;K.call(AH,{success:function AI(AL){mstrApp.msgid=AL.msgid;AH.pollingStatus(AK,AL,AC);}},X.copy(AJ,{taskId:"qBuilder.AddSelectedColumn",showWait:true}));},addSelectedColumns:function P(AK,AJ){var AH=this;K.call(AH,{success:function AI(AL){mstrApp.msgid=AL.msgid;AH.pollingStatus(AK,AL,AC);}},X.copy(AJ,{taskId:"qBuilder.AddMultiSelectedColumns",showWait:true}));},editColumn:function Q(AK,AJ){var AH=this;K.call(AH,{success:function AI(AL){mstrApp.msgid=AL.msgid;AH.pollingStatus(AK,AL,AC);}},X.copy(AJ,{taskId:"qBuilder.EditSelectedColumn",showWait:true}));},removeColumn:function I(AK,AJ){var AH=this;K.call(AH,{success:function AI(AL){mstrApp.msgid=AL.msgid;AH.pollingStatus(AK,AL,AC);}},X.copy(AJ,{taskId:"qBuilder.RemoveSelectedColumn",showWait:true}));},addJoin:function d(AK,AJ){var AH=this;K.call(AH,{success:function AI(AL){mstrApp.msgid=AL.msgid;AH.pollingStatus(AK,AL,AC);}},X.copy(AJ,{taskId:"qBuilder.AddJoin",showWait:true}));},removeJoin:function z(AK,AJ){var AH=this;K.call(AH,{success:function AI(AL){mstrApp.msgid=AL.msgid;AH.pollingStatus(AK,AL,AC);}},X.copy(AJ,{taskId:"qBuilder.RemoveSelectedJoin",showWait:true}));},editJoin:function m(AK,AJ){var AH=this;K.call(AH,{success:function AI(AL){mstrApp.msgid=AL.msgid;AH.pollingStatus(AK,AL,AC);}},X.copy(AJ,{taskId:"qBuilder.EditJoin",showWait:true}));},autoJoin:function W(AK,AJ){var AH=this;K.call(AH,{success:function AI(AL){mstrApp.msgid=AL.msgid;AH.pollingStatus(AK,AL,AC);}},X.copy(AJ,{taskId:"qBuilder.GenerateJoins",showWait:true}));},editCondition:function D(AK,AJ){var AH=this;K.call(AH,{success:function AI(AL){mstrApp.msgid=AL.msgid;AH.pollingStatus(AK,AL,AC);}},X.copy(AJ,{taskId:"qBuilder.EditCondition",showWait:true}));},remapObject:function O(AI,AH){K.call(this,AI,X.copy(AH,{taskId:"qBuilder.RemapObject",showWait:true}));},updateTableStructure:function G(AI,AH){K.call(this,AI,X.copy(AH,{taskId:"qBuilder.UpdateWHTable",showWait:true}));},parse:function R(AI,AH){K.call(this,AI,X.copy(AH,{taskId:"qBuilder.Parse",showWait:true}));},getReportDefinition:function q(AI,AH){K.call(this,AI,X.copy(AH,{taskId:"qBuilder.GetReportXDADefinition",showWait:true}));},saveReport:function C(AI,AH){K.call(this,AI,X.copy(AH,{taskId:"qBuilder.SaveReportXDADefinition",showWait:true,suppressError:true,waitMsg:mstrmojo.desc(7405,"Saving changes...")}));},getSystemFunctions:function u(AI,AH){K.call(this,AI,X.copy(AH,{taskId:"getSystemFunctions",showWait:false,suppressError:true}));},convertToQB:function J(AI,AH){K.call(this,AI,X.copy(AH,{taskId:"qBuilder.ConvertToQueryBuilder",showWait:true}));},convertToFFSQL:function k(AI,AH){K.call(this,AI,X.copy(AH,{taskId:"qBuilder.ConvertToFreeFormSQL",showWait:true}));},editFFSQL:function n(AI,AH){K.call(this,AI,X.copy(AH,{taskId:"qBuilder.EditFreeFormSQL",showWait:true}));},catalogAction:function AF(AI,AH){K.call(this,AI,X.copy(AH,{taskId:"arch.catalogAction",showWait:true}));},getDocumentAttributes:function l(AI,AH){K.call(this,AI,X.copy(AH,{taskId:"getDocumentAttributes",showWait:true}));},autoClosePrompt:function L(AI,AH){K.call(this,AI,X.copy(AH,{taskId:"qBuilder.AutoClosePrompt",showWait:true}));},publishCube:function U(AI,AH){K.call(this,AI,X.copy(AH,{taskId:"qBuilder.PublishCube",showWait:true,suppressError:true,waitMsg:mstrmojo.desc(11163,"Publishing...")}));},getAttributeForms:function p(AI,AH){K.call(this,AI,X.copy(AH,{taskId:"getAttributeForms"}));},searchMetadata:function F(AI,AH){K.call(this,AI,X.copy(AH,{taskId:"searchMetadata"}));},getFunctionDetails:function AD(AI,AH){K.call(this,AI,X.copy(AH,{taskId:"getSystemFunctions"}));},signOutOAuthSource:function f(AI,AH){K.call(this,AI,X.copy(AH,{taskId:"qBuilder.FetchSourceObjects",flags:8,showWait:true,waitMsg:M(12369,"Signing out...")}));},removeEmmaTable:function Z(AK,AJ){var AH=this;K.call(AH,{success:function AI(AL){mstrApp.msgid=AL.msgid;AH.pollingStatus(AK,AL,AC);}},X.copy(AJ,{taskId:"DIRemoveEMMASourceTable",showWait:true,waitMsg:AC}));},removeOrDuplicateRI:function e(AI,AH){K.call(this,AI,X.copy(AH,{taskId:"qBuilder.RemoveOrDuplicateRI",showWait:true}));},clearDataCache:function N(AI,AH){K.call(this,AI,X.copy(AH,{taskId:"DIClearDataCache",}));},catalogActionForLocalDossier:function b(AM,AL,AI){var AJ=this;K.call(AJ,{success:function AK(AN){AJ.cancelEvt&&mstrApp.getRootController().model.detachEventListener(AJ.cancelEvt);AJ.cancelEvt=mstrApp.getRootController().model.attachEventListener(AI,this.id,function(){AJ.isPolling=false;AM.canceled(AN);});AJ.isPolling=true;AJ.taskByPollStatus(AM,AN,null,{silent:true},null,"arch.PollStatusCatalogAction");},failure:function AH(AN){mstrmojo.alert("arch.catalogAction : Get thread Id failed.");},canceled:function(AN){if(AM.canceled){AM.canceled(AN);}}},X.copy(AL,{taskId:"arch.catalogAction",showWait:false,}));},prepareData:function g(AP,AJ,AK,AM,AI){var AH=AI||M(13196,"Prepare data ## of ### tables...").replace("##",AK).replace("###",AM);var AL=this,AN={showCancel:true};K.call(AL,{success:function AO(AQ){mstrApp.showWait(AN);AL.taskByPollStatus(AP,AQ,AH,{silent:true});},canceled:function(AQ){if(AP.canceled){AP.canceled(AQ);}}},X.copy(AJ,{taskId:"DIDataPreparation",showWait:true,waitMsg:AH}),AN);},killJob:function S(AJ,AI,AH){K.call(this,AJ,X.copy(AI,{taskId:AH||"DIKillJob",showWait:true,suppressError:true,waitMsg:AC}));},getObjectInfo:function E(AI,AH){K.call(this,AI,X.copy(AH,{taskId:"getObjectInfo"}),{showProgress:true,showProgressText:true,progressText:AC});},getSingleDBRole:function t(AI,AH){K.call(this,AI,X.copy(AH,{taskId:"qBuilder.GetSingleDBRole"}),{showProgress:true,showProgressText:true,progressText:AC});}});}());(function(){mstrmojo.requiresCls("mstrmojo.Obj","mstrmojo.hash","mstrmojo.DI.DIDataService");mstrmojo.requiresDescs(889,13196);var U=mstrmojo.hash,G=mstrmojo.desc;var H=G(889,"Please wait...");function A(j,h,g){var c=h.showWait,d=h.suppressError,b=h.waitMsg,e=h.msgid,f=h.alertCfg;delete h.showWait;delete h.suppressError;delete h.waitMsg;delete h.msgid;delete h.alertCfg;mstrApp.serverRequest(h,j,c,d,b,e,f,g);}mstrmojo.qb.es.DataService=mstrmojo.provide("mstrmojo.qb.es.DataService",{emmaIRRMessageID:null,submitRequest:function S(c,b){A.call(this,c,b);},setDBRole:function X(c,b){A.call(this,c,U.copy(b,{taskId:"qBuilder.SetDBRole",showWait:true}));},signOutOAuthSource:function Y(c,b){A.call(this,c,U.copy(b,{taskId:"qBuilder.FetchSourceObjects",flags:8,showWait:true,waitMsg:G(12369,"Signing out...")}));},pollingStatus:function E(j,c,f,g){var e=this;if(mstrApp.isSingleTier){if(j.success){j.success(c);}return ;}A.call(e,{success:function h(k){if(k.status==="1"){if(j.success){j.success(c);}}else{e.pollingStatus(j,c,f);}},failure:function d(k){if(j.failure){j.failure(k);}},canceled:function b(k){if(j.canceled){j.canceled(k,c);}}},{taskId:"pollStatus",resultSetType:3,pollingFrequency:500,maxWait:60000,taskEnv:"xhr",taskContentType:"json",showWait:true,waitMsg:f},g);},taskByPollStatus:function D(j,b,f,g,c,h){var e=this,d="pollStatus";if(mstrApp.isSingleTier){d=h||"DIPollStatus";}A.call(e,mstrmojo.DI.DIDataService.taskByPollStatusCb.call(e,j,b,f,g,c,h),{taskId:d,resultSetType:3,threadId:b.tid,maxWait:60000,taskEnv:"xhr",taskContentType:"json",isAsync:true,},g);},createEmmaTables:function V(e,d){var b=this;A.call(b,{success:function c(f){mstrApp.msgid=f.msgid;b.pollingStatus(e,f,H);}},U.copy(d,{taskId:"qBuilder.CreateEmmaTables",showWait:true,waitMsg:H}));},createEmmaInstance:function a(e,d){var b=this;A.call(b,{success:function c(f){mstrApp.msgid=f.msgid;b.pollingStatus(e,f,H);}},U.copy(d,{taskId:"DICreateEMMAReportInstance",showWait:true,waitMsg:H}));},removeEMMATable:function B(e,d){var b=this;A.call(b,{success:function c(f){mstrApp.msgid=f.msgid;b.pollingStatus(e,f,H);}},U.copy(d,{taskId:"DIRemoveEMMASourceTable",showWait:true,waitMsg:H}));},changePartition:function Q(e,d){var b=this;A.call(b,{success:function c(f){mstrApp.msgid=f.msgid;b.pollingStatus(e,f,H);}},U.copy(d,{taskId:"DIChangePartition",showWait:true,waitMsg:H}));},editEmmaIRRSourceTable:function K(f,e){var c=this,b;b={success:function d(g){c.emmaIRRMessageID=g.msgid;}};A.call(c,mstrmojo.func.wrapMethods(b,f),U.copy(e,{taskId:"DIEditEmmaIRRSourceTable",msgid:c.emmaIRRMessageID,showWait:true}));},search:function L(c,b){A.call(this,c,U.copy(b,{taskId:"arch.search",showWait:true}));},searchFolderContents:function Z(c,b){A.call(this,c,U.copy(b,{taskId:"searchMetadata",styleName:"MojoFolderStyle",includeAncestorInfo:false,includeObjectDesc:false,fields:"name",recursive:0}),{showProgress:true,showProgressText:true,progressText:H});},validateEmmaIRRAlternateSource:function C(c,b){A.call(this,c,U.copy(b,{taskId:"DIValidateEmmaIRRAlternateSource",msgid:this.emmaIRRMessageID,showWait:true}));},clearDataCache:function J(c,b){A.call(this,c,U.copy(b,{taskId:"DIClearDataCache",}));},catalogActionForLocalDossier:function W(g,f,c){var d=this;A.call(d,{success:function e(h){d.cancelEvt&&mstrApp.getRootController().model.detachEventListener(d.cancelEvt);d.cancelEvt=mstrApp.getRootController().model.attachEventListener(c,this.id,function(){d.isPolling=false;g.canceled(h);});d.isPolling=true;d.taskByPollStatus(g,h,null,{silent:true},null,"arch.PollStatusCatalogAction");},failure:function b(h){mstrmojo.alert("arch.catalogAction : Get thread Id failed.");},canceled:function(h){if(g.canceled){g.canceled(h);}}},U.copy(f,{taskId:"arch.catalogAction",showWait:false,}));},prepareData:function I(k,d,e,g,c,l){var b=c||G(13196,"Prepare data ## of ### tables...").replace("##",e).replace("###",g);var f=this,h={showCancel:l?false:true};A.call(f,{success:function j(m){mstrApp.showWait(h);f.taskByPollStatus(k,m,b,{silent:true},{hideCancel:l});},canceled:function(m){if(k.canceled){k.canceled(m);}}},U.copy(d,{taskId:"DIDataPreparation",showWait:true,waitMsg:b}),h);},catalogAction:function P(c,b){A.call(this,c,U.copy(b,{taskId:"arch.catalogAction",showWait:true}));},autoMap:function N(e,d){var b=this;A.call(b,{success:function c(f){mstrApp.msgid=f.msgid;b.pollingStatus(e,f,H);}},U.copy(d,{taskId:"qBuilder.AutoMapTables",showWait:true,waitMsg:H}));},killJob:function F(c,b){A.call(this,c,U.copy(b,{taskId:"DIKillJob",showWait:true,suppressError:true,waitMsg:H}));},getObjectInfo:function M(c,b){A.call(this,c,U.copy(b,{taskId:"getObjectInfo"}),{showProgress:true,showProgressText:true,progressText:H});},removeOrDuplicateRI:function O(c,b){A.call(this,c,U.copy(b,{taskId:"qBuilder.RemoveOrDuplicateRI",showWait:true}));},getSingleDBRole:function R(c,b){A.call(this,c,U.copy(b,{taskId:"qBuilder.GetSingleDBRole"}),{showProgress:true,showProgressText:true,progressText:H});}});}());(function(){mstrmojo.requiresCls("mstrmojo.StepperContentProvider","mstrmojo.num");var A=mstrmojo.num;function B(G,F){var H=F?G.max:G.min,D=F?G.min:G.max,E=G.getVal(F?1:-1);return(H===null||(F?(E<=H):(E>=H))||(D!==null&&G.canLoop));}function C(H,G){var F=H.min,D=H.max,E=H.getVal(G?1:-1);if((G&&D!==null&&E>D)||(!G&&F!==null&&(E<F))){if(H.canLoop){E=((E-F)%(D-F+1))+F;E=(E>=F)?E:E+(D-F+1);}else{return ;}}H.item[H.valField]=H.curVal=E;H.onTraverse();}mstrmojo.NumStepperContentProvider=mstrmojo.declare(mstrmojo.StepperContentProvider,null,{scriptClass:"mstrmojo.NumStepperContentProvider",curVal:null,init:function(E){this._super(E);var F=this.item,D=function(I){var H=I&&F[I];return(H===null||H===undefined);},G=function(I,K,H){var J=H&&D.call(this,K)?null:F[K];if(J!==null&&J!==undefined){this[I]=J;}};G.call(this,"min",this.minField,true);G.call(this,"max",this.maxField,true);G.call(this,"maxLength",this.maxLengthField,true);G.call(this,"interval",this.intField);this._initCurrent();},_initCurrent:function(){var E=this.item,F=this.curVal=E[this.valField];if(F===null||F===undefined){var D=this.min;this.curVal=D!==null?D:0;}},next:function(){C(this,true);},prev:function(){C(this,false);},hasPrev:function(){return B(this,false);},hasNext:function(){return B(this,true);},renderItemAt:function(F){var E=this.getVal(F),D=this.renderer;return D?D.render(E,this):E;},getVal:function(D){return this.curVal+(this.interval*(D||0));},setVal:function(F){var G=this.min,D=this.max,E=this.getVal();if(typeof F!=="number"||isNaN(F)||F===E||A.inNumericRange(F,G,D)!==0){return ;}this.item[this.valField]=this.curVal=F;this.onTraverse();},onTraverse:mstrmojo.emptyFn});}());(function(){mstrmojo.requiresCls("mstrmojo.ServerProxy");mstrmojo.QueueNative=mstrmojo.declare(mstrmojo.ServerProxy,null,{scriptClass:"mstrmojo.QueueNative",queue:[],requestCount:0,transport:null,createRequest:function(C,E,D,B){return this._super(C,E,D,B);},advance:function(){var B=this.queue.shift();if(B){this.request(B.callback,B.params,false,{});}},queueHandle:function(B,C){if(this.requestCount>0){this.queue.push({callback:C,params:B});this.requestCount++;}else{this.requestCount++;this.request(C,B,false,{});}},response:function A(F,B,D){var E=this.getRequest(F);if(E){E.gotResponse=true;var G=E.callback,C=(B&&!D.mstrerr)?"success":"failure";try{if(G[C]){G[C](D,E);}}finally{G.complete(F);}this.requestCount--;this.advance();}},});}());(function(){mstrmojo.requiresCls("mstrmojo.func","mstrmojo.hash","mstrmojo.array","mstrmojo.ServerProxy","mstrmojo.XHRServerTransport","mstrmojo.mstr.EnumFunction");var m=mstrmojo.array,g=mstrmojo.mstr.EnumFunction;var N={"8107C31BDD9911D3B98100C04F2233EA":"Sum","548C68A0F60811D3ACC300C04F0423DE":"StdevP","8107C31FDD9911D3B98100C04F2233EA":"Max","8107C331DD9911D3B98100C04F2233EA":"GeoMean",B2C0FA4220C711D6AD1400C04F0423DE:"First","8107C32CDD9911D3B98100C04F2233EA":"Product",B2C0FA4020C711D6AD1400C04F0423DE:"Greatest","8107C330DD9911D3B98100C04F2233EA":"Var","8107C32FDD9911D3B98100C04F2233EA":"Stdev","8107C32DDD9911D3B98100C04F2233EA":"Median",B2C0FA4320C711D6AD1400C04F0423DE:"Last","8107C31CDD9911D3B98100C04F2233EA":"Count","8107C31DDD9911D3B98100C04F2233EA":"Avg","8107C31EDD9911D3B98100C04F2233EA":"Min","8107C32EDD9911D3B98100C04F2233EA":"Mode",D64F1B10F6C011D3ACC300C04F0423DE:"VarP",B2C0FA4120C711D6AD1400C04F0423DE:"Least"},Q={"8107C326DD9911D3B98100C04F2233EA":"Rank"},z={D221F90EB35540E3A1204ED6CC9A8267:"Avg",D221F90FB35540E3A1204ED6CC9A8267:"Count",D221F910B35540E3A1204ED6CC9A8267:"Max",D221F911B35540E3A1204ED6CC9A8267:"Min",D221F90DB35540E3A1204ED6CC9A8267:"Sum"},AA={"8107C32ADD9911D3B98100C04F2233EA":"Avg","8107C350DD9911D3B98100C04F2233EA":"Count","8107C34BDD9911D3B98100C04F2233EA":"Max","8107C34CDD9911D3B98100C04F2233EA":"Min","8107C32BDD9911D3B98100C04F2233EA":"Sum"},q={"8107C329DD9911D3B98100C04F2233EA":"Avg","8107C354DD9911D3B98100C04F2233EA":"Count","8107C351DD9911D3B98100C04F2233EA":"Max","8107C352DD9911D3B98100C04F2233EA":"Min","8107C328DD9911D3B98100C04F2233EA":"Sum"},X={"8107C337DD9911D3B98100C04F2233EA":"Banding","8107C338DD9911D3B98100C04F2233EA":"BandingC","8107C339DD9911D3B98100C04F2233EA":"BandingP"},H={"8107C31DDD9911D3B98100C04F2233EA":"Avg","8107C31CDD9911D3B98100C04F2233EA":"Count",B2C0FA4220C711D6AD1400C04F0423DE:"First","8107C331DD9911D3B98100C04F2233EA":"GeoMean",B2C0FA4320C711D6AD1400C04F0423DE:"Last","8107C31FDD9911D3B98100C04F2233EA":"Max","8107C32DDD9911D3B98100C04F2233EA":"Median","8107C31EDD9911D3B98100C04F2233EA":"Min","8107C32EDD9911D3B98100C04F2233EA":"Mode","8107C32CDD9911D3B98100C04F2233EA":"Product","8107C32FDD9911D3B98100C04F2233EA":"Stdev","548C68A0F60811D3ACC300C04F0423DE":"StdevP","8107C31BDD9911D3B98100C04F2233EA":"Sum","8107C330DD9911D3B98100C04F2233EA":"Var",D64F1B10F6C011D3ACC300C04F0423DE:"VarP",A202C23DDD9D11D3B98100C04F2233EA:"Fvschedule",A202C23CDD9D11D3B98100C04F2233EA:"IRR",A202C240DD9D11D3B98100C04F2233EA:"MIRR",A202C23EDD9D11D3B98100C04F2233EA:"NPV","8107C34ADD9911D3B98100C04F2233EA":"Percentile","9C374203DD9F11D3B98100C04F2233EA":"AvgDev","9C374228DD9F11D3B98100C04F2233EA":"ChiSquareTest","9C374225DD9F11D3B98100C04F2233EA":"Correlation","9C374224DD9F11D3B98100C04F2233EA":"Covariance","9C374237DD9F11D3B98100C04F2233EA":"ForecastV","9C37422FDD9F11D3B98100C04F2233EA":"FTest","9C374234DD9F11D3B98100C04F2233EA":"GrowthV","9C37422EDD9F11D3B98100C04F2233EA":"HeteroscedasticTTest","9C37422DDD9F11D3B98100C04F2233EA":"HomoscedasticTTest","9C37422ADD9F11D3B98100C04F2233EA":"Intercept","9C374204DD9F11D3B98100C04F2233EA":"Kurtosis","9C374222DD9F11D3B98100C04F2233EA":"MeanTTest","9C37422CDD9F11D3B98100C04F2233EA":"PairedTTest","9C374226DD9F11D3B98100C04F2233EA":"Pearson","9C374227DD9F11D3B98100C04F2233EA":"RSquare","9C374205DD9F11D3B98100C04F2233EA":"Skew","9C374229DD9F11D3B98100C04F2233EA":"Slope","9C37422BDD9F11D3B98100C04F2233EA":"SteYX","9C374231DD9F11D3B98100C04F2233EA":"TrendV","9C374223DD9F11D3B98100C04F2233EA":"VarTest","4A99DC7BC5254A319F6B8098E7D652C1":"ConcatAgg"},Z={AND283:"And",OR284:"Or",NOT285:"Not",IF305:"If"},o={BEGINSWITH279:"Begins with",ENDSWITH279:"Ends with",IN289:"In",BETWEEN290:"Between",CONTAINS291:"Contains",LIKE291:"Like"};function P(AF){var AD=function(AH,AG){return mstrmojo.array.stringSorter(AH.n,AG.n);},AE,AC;AF=AF.sort(AD);for(AE=0,AC=AF.length;AE<AC;AE++){AF[AE].fns=AF[AE].fns.sort(AD);}return AF;}function Y(AF,AG){var AC=AF.length,AE;for(AE=0;AE<AC;AE++){var AD=AF[AE].fns;if(mstrmojo.array.find(AD,"did",AG)>-1){return AE;}}return -1;}function M(AD){var AC=mstrApp&&mstrApp.useQuickSearch&&mstrApp.useQuickSearch();AD=mstrmojo.hash.copy(AD,{taskId:"searchMetadata",recursive:true,styleName:"MojoFolderStyle",includeObjectDesc:true,includeAncestorInfo:false});if(AC){AD.quickSearch=AC;AD.nameWildcards=16;AD.sortKey=-1;}return AD;}function I(AD,AC){if(mstrApp.serverRequest){mstrApp.serverRequest(AC,AD);}else{window.$MAPF=function(){return false;};this.getServerProxy().request(AD,AC,false,{});}}mstrmojo.ME.MetricDataService=mstrmojo.provide("mstrmojo.ME.MetricDataService",{rootFolderTypes:{ALL:39,FILTERS:4,METRICS:5,FACTS:29,SCHEMA:24,ATTRIBUTES:26,TRANSFORMATIONS:38},blockCount:10,suggestCount:10,suggestDelay:200,noCache:true,functions:null,metricComponents:null,functionsDetails:null,getServerProxy:function F(){if(!this.serverProxy){this.serverProxy=new mstrmojo.ServerProxy({transport:mstrmojo.XHRServerTransport});}return this.serverProxy;},getMetricDefintion:function S(AE,AC){var AD={taskId:"getMetricDefinition",metricId:AE.id,outputFlags:65599};if(AE.msgID){AD.msgID=AE.msgID;}I.call(this,AC,AD);},validateMetric:function e(AE,AC){var AD={taskId:"validateMetric",metricId:AE.metricId,tokenStreamXML:AE.tokenStreamXML,metricXML:AE.metricXML,outputFlags:327695};if(mstrmojo.string.isEmpty(AE.metricId)){AD.isNew=true;}if(AE.msgID){AD.msgID=AE.msgID;}if(AE.formID){AD.frmid=AE.formID;}if(AE.isIDForm){AD.isIDForm=AE.isIDForm;}if(AE.objectType){AD.objectType=AE.objectType;}I.call(this,AC,AD);},getMetricComponents:function B(AG,AD){var AC=this,AE=this.metricComponents;if(!this.noCache&&AE&&AE.items.length==AE.sz){AD.success(AE);return ;}AD.success=mstrmojo.func.composite([AD.success,function(AH){if(AC.metricComponents&&AC.metricComponents.items){AC.metricComponents.items.push(AH.items);}else{AC.metricComponents=AH;}}]);var AF=M({blockBegin:AG.blockBegin,blockCount:AG.blockCount,searchPattern:AG.pattern,rootFolderType:AG.rootFolderType||24,objectType:AG.objectType||"12,13,43"});I.call(this,AD,AF);},getAttributes:function R(AE,AC){var AD=M({blockBegin:AE.blockBegin,blockCount:AE.blockCount,searchPattern:AE.pattern,rootFolderType:AE.rootFolderType||26,objectType:12});I.call(this,AC,AD);},getFacts:function L(AE,AC){var AD=M({blockBegin:AE.blockBegin,blockCount:AE.blockCount,searchPattern:AE.pattern,rootFolderType:AE.rootFolderType||29,objectType:13});I.call(this,AC,AD);},getMetrics:function G(AE,AC){var AD=M({blockBegin:AE.blockBegin,blockCount:AE.blockCount,searchPattern:AE.pattern,rootFolderType:AE.rootFolderType||5,objectType:4});if(AE.isVerify){AD.nameWildcards=2;}I.call(this,AC,AD);},getFunctions:function U(AH){var AJ=this,AK=window.sessionStorage,AG=this.functions||(AK&&AK.getItem("functions")),AI=AK&&AK.getItem("mstrLocaleId"),AE=mstrApp&&mstrApp.localeId;if(AG&&AI==AE){AG=P(JSON.parse(AG).fncs);AH.success(AG);}else{var AD={failure:AH.failure,textResponse:true},AF={taskId:"getSystemFunctions",includeFunctionDetails:true,functionFlags:2|2147483648,includeFunctionHelpTopic:true};var AC=function(AL){m.forEach(AL,function(AN){var AM=AN&&AN.fns;m.forEach(AM,function(AP){var AO=AP.pros;var AQ=m.filterOne(AO,function(AR){return AR.n==="UseLookupForAttributes";});if(AQ){AQ.dfv="0";}});});};AD.success=function(AL){if(typeof AL==="string"||!mstrApp.isSingleTier){AL=AL.replace(/\\'/g,"'");var AN=JSON.parse(AL),AM=AN.fncs;AC(AM);AL=JSON.stringify(AN);if(AK){AK.setItem("functions",AL);AK.setItem("mstrLocaleId",AE);}AJ.functions=AL;AG=P(JSON.parse(AL).fncs);}else{AC(AL.fncs);AG=P(AL.fncs);AJ.functions=JSON.stringify(AL);}AH.success(AG);};I.call(this,AD,AF);}},getAggFunctions:function C(){if(this._aggFunctions){return this._aggFunctions;}var AC=this.parseFuncStr();AC=mstrmojo.array.filter(AC[this.getBasicCategoryIndex(AC)].fns,function(AE){var AD=AE.did,AF;if(AD!=="B2C0FA4020C711D6AD1400C04F0423DE"&&AD!=="B2C0FA4120C711D6AD1400C04F0423DE"){AF=N[AD];}return AF;});return AC;},getOLAPAggFunctions:function E(AC){var AD=this.parseFuncStr();AD=mstrmojo.array.filter(AD[this.getOLAPCategoryIndex(AD)].fns,function(AE){switch(AC){case"moving":return AA[AE.did];case"running":return q[AE.did];case"olap":default:return z[AE.did];}return false;});return AD;},getFunctionCatList:function t(){if(this._functionCatList){return this._functionCatList;}var AC=this.parseFuncStr();AC=mstrmojo.hash.make(AC,mstrmojo.Arr);this._functionCatList=AC;return AC;},getCategoryIndex:function r(AD,AC){return Y(AC||this.getFunctionCatList(),AD);},getBasicCategoryIndex:function J(AD){var AC="B2C0FA4020C711D6AD1400C04F0423DE";return Y(AD||this.getFunctionCatList(),AC);},getDataMiningCatIndex:function k(AC){var AD="F17CD4F3FF134D91B80DDAB9CA73C919";return Y(AC||this.getFunctionCatList(),AD);},getDateTimeCategoryIndex:function x(AD){var AC="C50F2A4F75AE49D6B20E00224967B500";return Y(AD||this.getFunctionCatList(),AC);},getStringCategoryIndex:function h(AD){var AC="6F7DF5FF449111D5BEA300B0D01A55EF";return Y(AD||this.getFunctionCatList(),AC);},getOLAPCategoryIndex:function J(AD){var AC="D221F90EB35540E3A1204ED6CC9A8267";return Y(AD||this.getFunctionCatList(),AC);},getInternalCategoryIndex:function V(AD){var AC="8107C337DD9911D3B98100C04F2233EA";return Y(AD||this.getFunctionCatList(),AC);},getFunctionDetails:function u(AE,AC){var AD={taskId:"getSystemFunctions",functionId:AE.did,includeFunctionDetails:true,includeFunctionHelpTopic:true};I.call(this,AC,AD);},getTransformations:function O(AE,AC){var AD=M({blockBegin:AE.blockBegin,blockCount:AE.blockCount,searchPattern:AE.pattern,rootFolderType:AE.rootFolderType||38,objectType:43});I.call(this,AC,AD);},getFilters:function l(AE,AC){var AD=M({blockBegin:AE.blockBegin,blockCount:AE.blockCount,searchPattern:AE.pattern,rootFolderType:AE.rootFolderType||4,objectType:1});I.call(this,AC,AD);},getAttributeForms:function f(AE,AC){var AD={taskId:"getAttributeForms",attributeID:AE.attributeID,displayedForms:AE.displayedForms,styleName:"WidgetElementListStyle"};I.call(this,AC,AD);},getSubtotalFunctions:function W(AE,AC){var AD=M({objectType:"1025,1026",searchPattern:""});I.call(this,AC,AD);},isBasicAggMap:function n(AC){var AD=!!N[AC];if(AC==="B2C0FA4020C711D6AD1400C04F0423DE"||AC==="B2C0FA4120C711D6AD1400C04F0423DE"){AD=false;}return AD;},isOLAPAgg:function AB(AC){return !!z[AC];},isMovingAgg:function a(AC){return !!AA[AC];},isRunningAgg:function d(AC){return !!q[AC];},isBanding:function j(AC){return !!X[AC];},isOLAP:function K(AD){var AE=this.getFunctionCatList(),AC=AE[this.getOLAPCategoryIndex(AE)].fns;return mstrmojo.array.find(AC,"did",AD)>-1;},isRank:function D(AC){return !!Q[AC];},isScalar:function c(AC){return(AC||{}).sqt===3;},hasLookupForAttributesProps:function(AC){return !!H[AC];},getFunctionHelpTopic:function p(AC){var AD="<div class='func-details' onclick='mstrmojo.ME.MetricDataService.showFunctionHelpTopic(\"##HELPTOPIC##\")'>"+mstrmojo.desc(5811,"Details...")+"</div>";AD=AD.replace("##HELPTOPIC##",AC);return AD;},showFunctionHelpTopic:function w(AD){var AE=mstrApp.isSingleTier,AC=((mstrApp.helpUrl||"../help/")+"FunctionsRef/");if(AE){AC=AC+"index.htm#cshid="+(AD||"");window.FormWrapper.openPage(AC);}else{if(AD){AC=AC+"Content/"+AD+".htm";}else{AC=AC+"index.htm";}window.open(AC);}return false;},sortFunctions:function A(AD){var AE={},AC=function(AG,AF){return mstrmojo.array.stringSorter(AG.n,AF.n);};mstrmojo.array.forEach(AD,function(AF){mstrmojo.array.forEach(AF&&AF.fns,function(AG){if(AG&&AG.did){AE[AG.did]=AG;}});});return mstrmojo.hash.valarray(AE).sort(AC);},parseFuncStr:function b(){var AC=window.sessionStorage,AD=this.functions||AC&&AC.getItem("functions");if(AD){return P(JSON.parse(AD).fncs);}},isValEqual:function(AF,AE){if(AF===AE){return true;}var AC=[-1,"-1","True",true],AD=[0,"0","False",false];if(AC.indexOf(AF)>-1&&AC.indexOf(AE)>-1){return true;}else{if(AD.indexOf(AF)>-1&&AD.indexOf(AE)>-1){return true;}}return false;},isFuncHasUseLookupForAttributeProp:function(AD){var AC=[g.FunctionSum,g.FunctionCount,g.FunctionAvg,g.FunctionMin,g.FunctionMax,g.FunctionProduct,g.FunctionMedian,g.FunctionMode,g.FunctionStdev,g.FunctionVar,g.FunctionGeomean,g.FunctionPercentile,g.FunctionStdevP,g.FunctionVarP,g.FunctionFirst,g.FunctionLast,g.ConcatAgg];return AC.indexOf(AD)>-1;},isLogicOrCompFunc:function(AD){var AC=AD.v.toUpperCase()+AD.tp;return !!Z[AC]||!!o[AC];}});}());(function(){mstrmojo.requiresCls("mstrmojo.Obj","mstrmojo.locales","mstrmojo.date","mstrmojo.DI.DIConstants","mstrmojo.DI.DIDatabaseHelper");mstrmojo.requiresDescs(2052,2170,2265,3434,3544,4530,4699,8002,8984,9614,9919,9920,9921,9922,12491,12492,12493,12494,12495,12509,12771,13031,13131,13132,13980,13981,8536);var U=mstrmojo.DI.DIConstants,O=U.dataTypeMenuItems,L=U.rdcsFlag,D=mstrmojo.dom,J=mstrmojo.array;mstrmojo.DI.DIHelpers=mstrmojo.declare(mstrmojo.Obj,null,null);mstrmojo.DI.DIHelpers.isIE7=function N(){return mstrmojo.dom.isIE7;};mstrmojo.DI.DIHelpers.isIE=function(){return D.isIE||!!D.userAgent.match(/Trident\/7\.0/);};mstrmojo.DI.DIHelpers.isIEOrEdge=function(){return mstrmojo.dom.isEdge||this.isIE();};mstrmojo.DI.DIHelpers.getURLCaption=function(){var V="";if(mstrApp.diParams&&mstrApp.diParams.EnableURLImport){if(mstrApp.diParams.EnableFileImport){if(mstrApp.isSingleTier){if(window.FormWrapper!==window.client){V+="File://";}}else{V+="File://";}}if(mstrApp.diParams.EnableHttpImport){if(V!==""){V+=", ";}V+="Http://, Https://";}if(mstrApp.diParams.EnableFTPImport){if(V!==""){V+=", ";}V+="Ftp://";}}return V;};mstrmojo.DI.DIHelpers.getUrlTooltip=function C(){var V="";if(!mstrApp.diParams){return V;}if(!mstrApp.diParams.EnableURLImport){V=mstrmojo.desc(12491,"URL file uploads are currently disabled. Please contact your administrator.");}else{V=mstrmojo.desc(12492,"Use one of the following URL formats to upload your file:")+" ";V+=mstrmojo.DI.DIHelpers.getURLCaption();if(mstrApp.enableFileImport){V+="\r\r";V+=mstrmojo.desc(12493,"'File://' format allows you to upload files in your local machine. For example: File://ComputerName/path/FileName.");}if(mstrApp.enableHttpImport||mstrApp.enableHttpsImport){V+="\r\r";if(mstrApp.enableFileImport){V+=mstrmojo.desc(12494,"Some other examples are:");}else{V+=mstrmojo.desc(12495,"Some examples are:");}}if(mstrApp.enableHttpImport){V+="\r";V+="http://host/path/FileName";V+="\r";V+="https://user:password@host/path/FileName";}if(mstrApp.enableFtpImport){V+="\r";V+="ftp://user:password@host/path/FileName";V+="\r";V+="ftp://user:password@host:port/path/FileName";}}return V;};mstrmojo.DI.DIHelpers.createMSTRObjects=function(X,Z){var V,Y,W;if(X.constructor===Array){V=X;for(W=0;W<V.length;W++){V[W]=mstrmojo.DI.DIHelpers.createMSTRObjects(X[W],Z);}}else{if(typeof X==="object"){V=new mstrmojo.Obj(X);for(Y in X){if(!Z||Z.indexOf(Y)===-1){if(X.hasOwnProperty(Y)){V.set(Y,mstrmojo.DI.DIHelpers.createMSTRObjects(X[Y],Z));}}}}else{V=X;}}return V;};mstrmojo.DI.DIHelpers.getURLParameters=function(V){var W;var Z;var Y=[];if(V){if(V.indexOf("?")>0){V=V.substr(V.indexOf("?")+1);}Z=V.split("&");for(W=0;W<Z.length;W++){var X=Z[W].split("=");if(X.length===2){Y[X[0]]=X[1];}}}return Y;};mstrmojo.DI.DIHelpers.getBackendSourceType=function(V){var W=U.backendSourceSubtype.localFile;switch(V){case U.sourceSubtype.dropbox:W=U.backendSourceSubtype.dropbox;break;case U.sourceSubtype.bisource:W=U.backendSourceSubtype.bISources;break;case U.sourceSubtype.clipboard:W=U.backendSourceSubtype.clipboard;break;case U.sourceSubtype.facebook:W=U.backendSourceSubtype.facebook;break;case U.sourceSubtype.googleAnalytics:W=U.backendSourceSubtype.googleAnalytics;break;case U.sourceSubtype.googleBigQuery:W=U.backendSourceSubtype.googleBigQuery;break;case U.sourceSubtype.googleBigQueryFFSQL:W=U.backendSourceSubtype.googleBigQueryFFSQLModel;break;case U.sourceSubtype.googleBigQuerySingleTable:W=U.backendSourceSubtype.googleBigQuerySingleTable;break;case U.sourceSubtype.googleDrive:W=U.backendSourceSubtype.googleDrive;break;case U.sourceSubtype.hadoop:W=U.backendSourceSubtype.hadoopFileBrowser;break;case U.sourceSubtype.localFile:W=U.backendSourceSubtype.localFile;break;case U.sourceSubtype.mdx:W=U.backendSourceSubtype.OLAPSources;break;case U.sourceSubtype.salesforce:W=U.backendSourceSubtype.salesforce;break;case U.sourceSubtype.samplefile:W=U.backendSourceSubtype.samplefile;break;case U.sourceSubtype.searchOnSource:W=U.backendSourceSubtype.searchAsASource;break;case U.sourceSubtype.twitter:W=U.backendSourceSubtype.twitter;break;case U.sourceSubtype.url:W=U.backendSourceSubtype.url;break;case U.sourceSubtype.publicData:W=U.backendSourceSubtype.publicData;break;case U.sourceSubtype.cloudElement:W=U.backendSourceSubtype.cloudElement;break;}return W;};mstrmojo.DI.DIHelpers.getStateParameters=function(W){var V;var Z;var X=[];if(W.indexOf(":")>=0){Z=W.split(":");}else{Z=W.split("%3A");}for(V=0;V<Z.length;V++){var Y=Z[V];if(Y.substr(2,1)==="_"){X[Y.substr(0,2)]=Y.substr(3);}}return X;};mstrmojo.DI.DIHelpers.getExtensionType=function(X){var W=X.toLowerCase(),V;if(W===".xls"||W===".xlsx"||W===".xlsm"){V=U.xdaType.excel;}else{if(W===".txt"||W===".csv"||W===".tsv"||W===".prn"){V=U.xdaType.text;}else{V=0;}}return V;};mstrmojo.DI.DIHelpers.setTablesrc=function(V,X,W){if(X){if(!V.tablesSrc[X]){V.tablesSrc[X]=[];}V.tablesSrc[X].push(W);}};function S(V){var X={0:2,1:2,2:2,3:2,4:2,5:2,6:2,7:2,8:3,9:3,10:3,11:2,12:2,13:2,14:8,15:9,16:1,17:3,18:3,21:2,22:2,23:3,30:11,31:2,33:3,34:2},a={1:U.columnDataTypes.integer,2:U.columnDataTypes.integer,6:U.columnDataTypes.dtdouble,7:U.columnDataTypes.dtfloat,21:U.columnDataTypes.integer,22:U.columnDataTypes.nlong,30:U.columnDataTypes.bigDecimal,34:U.columnDataTypes.int64},W=X[V],Z=a[V],Y="";switch(W.toString()){case U.dataTypeMenuItems.NUMBER:switch(Z){case U.columnDataTypes.integer:Y=mstrmojo.desc(9614,"Integer");break;case U.columnDataTypes.nlong:Y=mstrmojo.desc(13131,"Long");break;case U.columnDataTypes.int64:Y=mstrmojo.desc(13132,"Big Integer");break;case U.columnDataTypes.dtfloat:Y=mstrmojo.desc(8002,"Float");break;case U.columnDataTypes.dtdouble:Y=mstrmojo.desc(2265,"Double");break;case U.columnDataTypes.bigDecimal:Y=mstrmojo.desc(9920,"Big Decimal");break;default:Y=mstrmojo.desc(3434,"Number");break;}break;case U.dataTypeMenuItems.DATE:Y=mstrmojo.desc(2052,"Date");break;case U.dataTypeMenuItems.DATE_TIME:Y=mstrmojo.desc(9919,"DateTime");break;case U.dataTypeMenuItems.TIME:Y=mstrmojo.desc(2170,"Time");break;case U.dataTypeMenuItems.TEXT:Y=mstrmojo.desc(3544,"Text");break;case U.dataTypeMenuItems.HTML_TAG:Y=mstrmojo.desc(9921,"HTML Tag");break;case U.dataTypeMenuItems.PHONE_NUMBER:Y=mstrmojo.desc(8984,"Phone Number");break;case U.dataTypeMenuItems.SYMBOL:Y=mstrmojo.desc(4530,"Symbol");break;case U.dataTypeMenuItems.URL:Y=mstrmojo.desc(9922,"URL");break;case U.dataTypeMenuItems.EMAIL:Y=mstrmojo.desc(4699,"Email");break;}return Y;}mstrmojo.DI.DIHelpers.getDataTypeString=S;mstrmojo.DI.DIHelpers.parseAlternateSourceValidationResults=function M(d){var b=[],Z,a,c,e,V,X,Y,W;J.forEach(d,function(f){Z=a=c=e="";X=(f.vt===3)?1:0;switch(f.vt){case 0:case 1:case 2:case 3:Z=f.n;a=S(f.ddt);V=f.src;c=V.n;e=S(V.ddt);break;case 4:Z=f.n;a=S(f.ddt);break;case 8:V=f.src;c=V.n;e=S(V.ddt);break;}Y=a?Z+"("+a+")":Z;W=e?c+"("+e+")":c;b.push([Y,X,W]);});return b;};mstrmojo.DI.DIHelpers.getURLFileName=function(W){var V=W.lastIndexOf("/");return V>=0&&V+1!==W.length?W.substr(V+1):W;};mstrmojo.DI.DIHelpers.isOperationMode=function(V){return V!==undefined&&V!==null;};mstrmojo.DI.DIHelpers.isCtrlKey=function(V,X){var W=X||(V||window).event;return W.ctrlKey||W.metaKey;};mstrmojo.DI.DIHelpers.isRefreshable=function(W){var V,X=0;for(V in W.importSources){var Y=W.importSources[V];if(Y.type===U.sourceType.file&&(Y.subtype===U.sourceSubtype.url||Y.subtype===U.sourceSubtype.publicData)){if(!Y.sourceInfo||Y.sourceInfo.url.indexOf("http://mirror.microstrategy.com/datahub/samples")!==0){X++;}}}if(W.getAllTableID().length===X&&!mstrApp.diParams.EnableHttpImport&&!mstrApp.diParams.EnableFTPImport&&!mstrApp.diParams.EnableFileImport&&!mstrApp.diParams.EnableURLImport){return false;}return true;};mstrmojo.DI.DIHelpers.strStartsWith=function(W,V){return W.indexOf(V)===0;};mstrmojo.DI.DIHelpers.adjustDataIdx=function(Y,X){var V=[],W;if(!Y||Y.length===0){return ;}J.forEach(Y,function(Z){W=Z.subColumns;if(W&&W.length>1){V=V.concat(W);}else{V.push(Z);}});V.sort(function(c,Z){return c[X]-Z[X];});};mstrmojo.DI.DIHelpers.setDataIdx=function(X,W,V){if(!W||W.length===0){return ;}if(W[0].hasOwnProperty("clix")){J.forEach(X,function(Z){var Y=Z.ix;Z[V]=J.find(W,"clix",Y);if(Z.isMultiForm){J.forEach(Z.subColumns,function(a){a[V]=J.find(W,"clix",a.ix);});}});}if(W[0].hasOwnProperty("did")){J.forEach(X,function(a){var Z=a.did;var Y=J.find(W,"did",Z);if(Y!==-1){a[V]=Y;}if(a.isMultiForm){J.forEach(a.subColumns,function(b){Y=J.find(W,"did",b.did);if(Y!==-1){b[V]=Y;}});}});}};mstrmojo.DI.DIHelpers.encodeData=function(V){var W="";if(V!==undefined){if(typeof V==="number"){W=V;}else{W=mstrmojo.string.encodeHtmlString(V,false,true);}}return W;};var E={0:"Bytes",1:"KB",2:"MB",3:"GB",4:"TB",5:"PB"};function P(V){return E[V]||"unknown";}mstrmojo.DI.DIHelpers.getRoundSize=function I(W){var V;for(V=0;(W/1024)>1;V++){W=W/1024;}W=W.toPrecision(3);return W+P(V);};mstrmojo.DI.DIHelpers.findNewElements=function(X,Y){var W=[],V;if(X&&X.length){J.forEach(Y,function(Z){V=J.indexOf(X,Z);if(V===-1){W.push(Z);}});}else{if(Y&&Y.length){W=[].concat(Y);}}return W;};mstrmojo.DI.DIHelpers.generateCubeName=function(W){var V,X,Y=50;V=W.join(" ");if(V.length>Y){V=V.slice(0,Y)+"...";}X=W.length;if(X>1){V+=" ("+X+" tables)";}return V;};mstrmojo.DI.DIHelpers.parseValidateSourceResults=function(W){var V={isValidate:true,hasError:false,tbids:[],tableValidate:[],missingColumnTbids:[],mismatchedDatatypeTbids:[],missingTableTbids:[],errorTableTbids:[],missingColumns:{},mismatchedDatatypeColumns:{},missingTablesColumns:{},errorTableErrCode:{},errorTableErrMsg:{}},X=W&&W.vts;J.forEach(X,function(f){var Y=f.tbid,g=f.vt,a=f.emsg,d=f.cols||[],Z=true,e=false,c,h=[],b=[];if(g===1){Z=true;}else{switch(g){case U.backendError.switchingFileType:case U.backendError.noExternalSession:case U.backendError.databaseCredentialsNotAvailable:case U.backendError.CECredentialNotAvailable:case U.backendError.AuthenticationError:case U.backendError.shouldBeIgnored:e=true;break;}J.forEach(d,function(j){var k=j.vt;switch(k){case 1:b.push(j);break;case 4:h.push(j);break;}});}if(e){V.errorTableTbids.push(Y);V.errorTableErrCode[Y]=g;V.errorTableErrMsg[Y]=a;V.isValidate=false;V.hasError=true;}c=h.length>0&&h.length===d.length;if(h.length>0||b.length>0){Z=false;}else{Z=true;}if(Z===false){V.isValidate=false;}V.tbids.push(Y);V.tableValidate.push(Z);if(h.length>0){if(c){V.missingTableTbids.push(Y);V.missingTablesColumns[Y]=h;}else{V.missingColumnTbids.push(Y);V.missingColumns[Y]=h;}}if(b.length>0){V.mismatchedDatatypeTbids.push(Y);V.mismatchedDatatypeColumns[Y]=b;}});return V;};mstrmojo.DI.DIHelpers.truncate=function(X,Z,V){if(X&&X.length>Z){var b=3,W=Z-b,a=Math.ceil(W/2),Y=Math.floor(W/2);if(V){return X.substr(0,W)+"...";}else{return X.substr(0,a)+"..."+X.substr(X.length-Y);}}else{return X;}};mstrmojo.DI.DIHelpers.getAbsoluteFileName=function(V){var W,X=V.lastIndexOf("\\");if(X===-1){X=V.lastIndexOf("/");}W=V.substring(X+1,V.length);return W;};mstrmojo.DI.DIHelpers.reevaluatePopupPosition=function(V){if(V){var W=V.style,Z=W.display,Y=W.left,X=W.top;W.display="block";if(parseInt(Y.substring(0,Y.length-2))<0){W.left="0px";}if(parseInt(X.substring(0,X.length-2))<0){W.top="0px";}W.display=Z;}};mstrmojo.DI.DIHelpers.expandNode=function(W){var V=W.visible;W.set("visible",!V);return !V;};mstrmojo.DI.DIHelpers.normalizeTimestamp=function(X){var W=X.replace(/-/g,"/");var V=W.indexOf(".");if(V>0){W=W.substring(0,V);}return W;};mstrmojo.DI.DIHelpers.getBackendErrorStr=function(W,V){var X="";switch(W){case U.backendError.switchingFileType:X=mstrmojo.desc(12509,"Switching the file type is not allowed during republishing or editing the cube.");break;case U.backendError.noExternalSession:case U.backendError.databaseCredentialsNotAvailable:case U.backendError.CECredentialNotAvailable:case U.backendError.AuthenticationError:X=mstrmojo.desc(14392,"We do not have the credentials needed to get the data for this table. Please provide the credentials to proceed publishing this table.");break;}return X;};mstrmojo.DI.DIHelpers.getCommonElements=function(Y,a,Z){var W=[],X,V;for(X=0;Y&&X<Y.length;X++){for(V=0;a&&V<a.length;V++){if(Z(Y[X],a[V])){W.push(Y[X]);break;}}}return W;};mstrmojo.DI.DIHelpers.formatDateAndTime=function(d,Y){var c=mstrmojo.date;var W=mstrmojo.locales;var X,e,b,a,V,Z;X=c.parseDateAndOrTime(d);e=X.date;b=X.time;if(Y){Z=new Date(Date.UTC(e.year,e.month-1,e.day,b.hour,b.min,b.sec));X=c.getDateJson(Z);e=X;b=X;}a=c.formatDateInfo(e,W.datetime.DATEDISPLAYFORMAT);V=c.formatTimeInfo(b,W.datetime.TIMEDISPLAYFORMAT);return a+" "+V;};mstrmojo.DI.DIHelpers.isServerBasedWS=function(){return !!mstrApp.isWorkstation&&!mstrApp.isSingleTier;};mstrmojo.DI.DIHelpers.isLocalWS=function(){return !!mstrApp.isWorkstation&&!!mstrApp.isSingleTier;};mstrmojo.DI.DIHelpers.isDIinVI=function(){return !!mstrApp.isWorkstation&&!!mstrApp.isSingleTier&&!!mstrApp.isPopup;};mstrmojo.DI.DIHelpers.extractFileNameFromHadoopURL=function(W){if(!W){return"";}var V,X;V=W.lastIndexOf("/")+1;X=W.substring(V);return X;};mstrmojo.DI.DIHelpers.extractFileExtensionFromHadoopURL=function(W){if(!W){return"";}var V,X;V=W.lastIndexOf("/")+1;X=W.substring(V);return X.substring(X.lastIndexOf(".")+1);};mstrmojo.DI.DIHelpers.isWS=function(){return !!mstrApp.isWorkstation;};mstrmojo.DI.DIHelpers.getEnvObj=function(){var Y=(navigator.platform.indexOf("Win")!==-1?"Win":"Mac"),V=!!mstrApp.isWorkstation?"WS":"Web",W=[];W.push(V,Y);return{ENV:W.join("-"),isWSClient:function(){if(!window.FormWrapper||!window.FormWrapper.isDesktop){return false;}return !window.FormWrapper.isDesktop();},isDesktopClient:function(){if(!window.FormWrapper||!window.FormWrapper.isDesktop){return false;}return window.FormWrapper.isDesktop();},isWeb:function(){return V==="Web";},isWS:function(){return V==="WS";},isWin:function(){return Y==="Win";},isMac:function(){return Y==="Mac";},isDataSet:function(){return mstrApp.placeholder==="DIApp"||mstrApp.placeholder==="mainDIApp"||mstrApp.placeholder==="QBApp";},isDIinVI:function(){return !!mstrApp.isFromVI;},isInDI:function(){return mstrApp.placeholder==="DIApp"||mstrApp.placeholder==="mainDIApp";},isInQB:function(){return mstrApp.placeholder==="QBApp";},isAppSchema:function(){return !!window.mstrAppSchema;},isWebWin:function(){return this.isWeb()&&this.isWin();},isWebMac:function(){return this.isWeb()&&this.isMac();},isWebDataSet:function(){return this.isWeb()&&this.isDataSet();},isWebDossier:function(){return this.isWeb()&&this.isDIinVI();},isWSWin:function(){return this.isWS()&&this.isWin();},isWSMac:function(){return this.isWS()&&this.isMac();},isWSDataSet:function(){return this.isWS()&&this.isDataSet();},isServerBasedWS:mstrmojo.DI.DIHelpers.isServerBasedWS,isWSDossier:function(){return this.isWS()&&this.isDIinVI();},isWSLiveMode:function X(){return this.isWS()&&parseInt(window.FormWrapper.isWSLiveMode(),10)===1;},isWSDossierLocalMode:function(){return this.isWSDossier()&&!this.isWSLiveMode();},isWebWinDataSet:function(){return this.isWeb()&&this.isWin()&&this.isDataSet();},isWebMacDataSet:function(){return this.isWeb()&&this.isMac()&&this.isDataSet();},isWebWinDossier:function(){return this.isWeb()&&this.isWin()&&this.isDIinVI();},isWebMacDossier:function(){return this.isWeb()&&this.isMac()&&this.isDIinVI();},isWSWinDataSet:function(){return this.isWS()&&this.isWin()&&this.isDataSet();},isWSMacDataSet:function(){return this.isWS()&&this.isMac()&&this.isDataSet();},isWSWinDossier:function(){return this.isWS()&&this.isWin()&&this.isDIinVI();},isWSMacDossier:function(){return this.isWS()&&this.isMac()&&this.isDIinVI();},isStandaloneDataSet:function(){return !this.isDIinVI()&&this.isDataSet();}};};mstrmojo.DI.DIHelpers.isOnetier=function(){return !!mstrApp.isSingleTier;};mstrmojo.DI.DIHelpers.getHierarchyMappingXML=function(a,b){var X="";var W=0,Y=1,Z=12;if(b&&b[L.ID]){X+="<mpcs>";X+="<mpc ";X+='did="'+b[L.ID].did+'" drvflg="'+W+(b[L.ID].n?('" n="'+b[L.ID].n+'" ot="'):"")+Z+'" recurisve="'+Y+'" ';if(!!a&&a!==""){X+='oid="'+a+'" ';}X+=">";if(b[L.JOIN_ID]){X+="<rdcs>";}for(var V=L.JOIN_ID;V<=L.DISTANCE;V++){if(b[V]!==undefined){X+='<rdc did="'+b[V].did+'" fg="'+V+'"/>';}}if(b[L.JOIN_ID]){X+="</rdcs>";}X+="</mpc>";X+="</mpcs>";}return X;};mstrmojo.DI.DIHelpers.getOperationMode=function(){return mstrApp.getRootController().getModel().operationMode;};mstrmojo.DI.DIHelpers.standardizeDBRolesFormat=function Q(d){var X=["att","dbRole","tableMap"],e,g,a,V,Y,W,b,Z,f,h,c=(function(){var j="list",l="number",k="text";function m(n,t,r,q,p,o){if(n&&r){if(o){n.push({field:t,fieldV:r,IDS:q,options:o,tp:p});}else{n.push({field:t,fieldV:r,IDS:q,tp:p});}}}return{authenticationmethod:function(n,o){m(n,"auth",o,7776,j,[{IDS:13980,n:mstrmojo.desc(13980),v:"1"},{IDS:13981,n:mstrmojo.desc(13981),v:"4"}]);},databasename:function(n,o){m(n,"db",o,8519,k);},hostname:function(n,o){m(n,"host",o,8533,k);},port:function(n,o){m(n,"port",o,8534,l);},server:function(n,o){m(n,"svr",o,8536,k);}};}());d=Object.keys(d).map(function(j){return mstrmojo.DI.DIHelpers.createMSTRObjects(d[j],X);});J.forEach(d,function(j){J.forEach(j.tables,function(k){k.dbRole=(k.dbRole&&k.dbRole.oi)||k.dbRole;k.dbmsObj=k.dbmsObj&&k.dbmsObj.oi;g=k.dbRole;if(g){g.dbmsObj=k.dbmsObj;a=g.dbmsObj;if(!g.dbms){g.dbms=g.def&&g.def.dbms&&g.def.dbms.did;}}if(!a||a.DBInfo){return ;}a.DBInfo={};e=a.DBInfo;V=g.efd;if(!V){return ;}V.forEach(function(l){Y=l.oi&&l.oi.def;if(!Y){return ;}h=Y.dbtp;if(h){g.db_type=h;e.dbTypes={dbt:{v:h,n:mstrmojo.desc(mstrmojo.DI.DIDatabaseHelper.getDescriptionIdByDBType(h))}};}W=Y.cnsr;if(!W){return ;}f=[];Z=null;g.connstr=W;W.split(";").forEach(function(m){b=m.split("=");b[0]=b[0].toLowerCase().trim();if(b[0]==="driver"){e.driverInstalled=true;}else{if(b[0]==="authenticationmethod"){Z=b;}else{if(c[b[0]]){c[b[0]](f,b[1]);}}}});if(Z){c[Z[0]](f,Z[1]);}});});});return d;};mstrmojo.DI.DIHelpers.filterDisableSources=function A(V){return J.indexOf(mstrApp.diParams.disabledSources,V)<0;};mstrmojo.DI.DIHelpers.getPopupWindowOptions=function R(){var Z={};var X=window.screenX||window.screenLeft||0,W=window.screenY||window.screenTop||0,Y=800,V=600,a;if(document.body&&document.body.offsetWidth){Y=document.body.offsetWidth;V=document.body.offsetHeight;}if(document.compatMode==="CSS1Compat"&&document.documentElement&&document.documentElement.offsetWidth){Y=document.documentElement.offsetWidth;V=document.documentElement.offsetHeight;}if(window.innerWidth&&window.innerHeight){Y=window.innerWidth;V=window.innerHeight;}if(window.outerWidth){Y=window.outerWidth;}if(window.outerHeight){V=window.outerHeight;}Z.height=V*0.5;Z.width=Y*0.8;if(Z.height<600||isNaN(Z.height)){Z.height=600;}if(Z.width<800||isNaN(Z.width)){Z.width=800;}Z.left=X+(Y-Z.width)/2;Z.top=W+(V-Z.height)/8;if(this.getEnvObj().isWSWin()&&this.getEnvObj().isDIinVI()){Z.left=(window.screen.width-Z.width)/2;Z.top=(window.screen.height-Z.height)/2;}a="width="+Z.width+",height="+Z.height;a+=",toolbar=0,scrollbars=1,status=1,resizable=1,location=1,menuBar=0";a+=",left="+Z.left+",top="+Z.top;return a;};mstrmojo.DI.DIHelpers.createPopupWindow=function G(W,V){var X,Y;Y=this.getPopupWindowOptions();if(!W){W="";}X=window.open(W,V,Y);return{wnd:X};};mstrmojo.DI.DIHelpers.openPopupWindow=function H(Y,W,V){var X;if(Y&&!Y.closed){Y.location=V;Y.focus();}else{X=this.createPopupWindow(V);Y=X.wnd;if(Y){Y.focus();}}return Y;};mstrmojo.DI.DIHelpers.sendResponse2Window=function B(W,V,Z){var Y;if(Z){Y=Z;}else{Y=window.opener;}if(Y){if(V===undefined){V=window.location.origin;if(!V){V=window.location.protocol+"//"+window.location.hostname+(window.location.port?":"+window.location.port:"");}}try{if(this.isIE()&&Y.postMessagePassthrough){Y.postMessagePassthrough(W,V);try{window.open("","_self","");window.close();}catch(a){window.close();}}else{Y.postMessage(W,V);}}catch(X){console.log("postMessage error: "+X);}}};mstrmojo.DI.DIHelpers.convertDataSourceType2SourceType=function F(V){switch(V){case U.dataSourceType.DROPBOX:return U.sourceType.dropbox;case U.dataSourceType.GOOGLE_DRIVE:return U.sourceType.googleDrive;case U.dataSourceType.GOOGLE_ANALYTICS:return U.sourceType.googleAnalytics;case U.dataSourceType.SALESFORCE:return U.sourceType.salesforce;case U.dataSourceType.GOOGLE_BIGQUERY:return U.sourceType.googleBigQuery;default:return -1;}};mstrmojo.DI.DIHelpers.highlightKeyWords=function K(d,e,V){var X="\\*.?+$^[](){}|/",f=d,b,Y;if(d===""){return e;}for(Y in X){if(X.hasOwnProperty(Y)){b=X[Y];f=f.replace(new RegExp("\\"+b,"g"),"\\"+b);}}var c=new RegExp("("+f+")","ig");var W="\u001E",a=mstrmojo.string.encodeHtmlString,Z;if(c.test(e)){e=e.replace(c,function(g){return W+g+W;});Z=J.map((e||"").split(W),function(h,g){return(g%2===0)?a(h):('<span class="'+V+'">'+a(h)+"</span>");});return Z.join("");}};mstrmojo.DI.DIHelpers.detectCustomImg=function(Y,X){if(!Y||!(X.nodeType&&X.nodeType===window.Node.ELEMENT_NODE)){return ;}var V=Y.replace?Y.replace(/\s+/g,""):"";var Z=document.getElementsByTagName("head")[0];var W=document.createElement("img");W.src="../javascript/mojo/css/images/DI/connectors/"+V+".png";W.onload=function(){X.style.background="url(../javascript/mojo/css/images/DI/connectors/"+V+".png) no-repeat";Z.removeChild(W);};W.onerror=function(){X.style.background="url(../javascript/mojo/css/images/DI/connectors/default.png) no-repeat";Z.removeChild(W);};Z.appendChild(W);};mstrmojo.DI.DIHelpers.spliceUrlBySeparator=function(W){var V=W.split("#");return V.slice(V.length/2+1).join("#");};mstrmojo.DI.DIHelpers.isOriginalConnector=function(W){var V=U.originalConnector;if(V.elastic===W||V.tapClicks===W){return true;}return false;};mstrmojo.DI.DIHelpers.acceptEventFromAncestor=function(V){if(!V){return true;}if(!this.domNode||typeof V.contains!=="function"||!this.hasRendered){return false;}return V.contains(this.domNode);};mstrmojo.DI.DIHelpers.isdbRoleWritable=function(V){if(mstrmojo.DI.DIHelpers.isOnetier()){return true;}else{return V.writable==="1"&&mstrApp.rootController.hasPrivilege(U.DssXmlPrivileges.DssXmlPrivilegesUseDatabaseInstanceManager);}};mstrmojo.DI.DIHelpers.isdbRoleUsable=function(V){return mstrmojo.DI.DIHelpers.isOnetier()?true:V.usable==="1";};mstrmojo.DI.DIHelpers.applyDriverSuffix=function(X){if(!X||!X.Preferences){return ;}var V=JSON.stringify(X),W=X.Preferences.driverNameSuffix,Z=this.getEnvObj();var Y="Platform";if(Z.isDesktopClient()){Y=Z.isMac()?"DesktopMac":"DesktopWin";}else{if(Z.isWSClient()){Y=Z.isMac()?"WorkstationMac":"WorkstationWin";}}var a=W[J.find(W,"n",Y)];return JSON.parse(V.replace(/!#DRIVERSUFFIX#!/g,a?a.value:""));};mstrmojo.DI.DIHelpers.isGeo=function(V){return V.georole&&V.georole>0;};mstrmojo.DI.DIHelpers.isTime=function(V){return V.dtp===parseInt(O.DATE,10)||V.dtp===parseInt(O.DATE_TIME,10)||V.dtp===parseInt(O.TIME,10);};}());(function(){mstrmojo.requiresCls("mstrmojo.dom","mstrmojo.css","mstrmojo.registry","mstrmojo._HasContextMenu","mstrmojo.Widget");var F=mstrmojo.dom,K=mstrmojo.css,N=16;mstrmojo.ContextMenuItem=mstrmojo.declare(mstrmojo.Widget,[mstrmojo._HasContextMenu],{scriptClass:"mstrmojo.ContextMenuItem",SUBMENU_SHIFT:3,visible:true,checked:false,enabled:true,buildDom:function(){var V=document.createElement("tr"),W=this.data,Z=this._cmSource,R,S;V.id=this.id;V.className="mstrmojo-ContextMenuItem "+(Z.isSeparatorItem(W)?"separator":Z.item2textCss(W));var X=this,Y=function(){X.handleMouseOver();},U=function(){X.handleMouseOut();},Q=function(){X.handleClick();};F.attachEvent(V,"mouseover",Y);F.attachEvent(V,"mouseout",U);F.attachEvent(V,"click",Q);R=document.createElement("td");V.appendChild(R);R.className="mstrmojo-CMI-left";S=document.createElement("img");S.src="../images/1ptrans.gif";R.appendChild(S);R=document.createElement("td");V.appendChild(R);R.className="mstrmojo-CMI-text";if(Z.isSeparatorItem(W)){S=document.createElement("img");S.src="../images/1ptrans.gif";}else{S=document.createElement("div");S.className="mstrmojo-CMI-content";R.innerHTML=W.itemWidget?"&nbsp":W[this.itemField];}R.appendChild(S);R=document.createElement("td");V.appendChild(R);R.className="mstrmojo-CMI-right "+(this.hasSubmenu?"sm":"");S=document.createElement("img");S.src="../images/1ptrans.gif";R.appendChild(S);return V;},buildRendering:function L(){this._super();var Q=this.data.itemWidget;if(Q){Q.placeholder=this.domNode.cells[1].children[0];Q.data=this.data;Q=mstrmojo.insert(Q);Q.render();Q.parent=this;this.itemWidget=Q;}},markupMethods:{onvisibleChange:function(){this.domNode.style.display=this.visible?"":"none";},oncheckedChange:function(){K.toggleClass(this.domNode,["checked"],this.checked);},onenabledChange:function(){K.toggleClass(this.domNode,["disabled"],!this.enabled);}},getMenuPosition:function I(){var Q=F.position(this.domNode,true);return{x:Math.round(Q.x+Q.w-this.SUBMENU_SHIFT),y:Math.round(Q.y)};},getContextMenuItems:function B(){return this.data[this.itemChildrenField];},getContextMenuCssClass:function D(){return this.data.cmCssClass||"";},callOnContextMenuOpen:function M(){var Q=this.data;if(Q.onContextMenuOpen){Q.onContextMenuOpen.apply(this,[]);}},callOnContextMenuClose:function A(){var Q=this.data;if(Q.onContextMenuClose){Q.onContextMenuClose.apply(this,[]);}},attachMousedownEvent:function J(){},getContextMenuSource:function P(){return this._cmSource;},adjustMenuPosition:function G(){var Q=this._subMenu,U=this._subMenu.domNode,S=U.offsetHeight,R=U.offsetWidth,X=F.windowDim(),W=F.position(U,false),V=F.position(U,true);if((W.x+R+N)>X.w){Q.set("left",(F.position(this.domNode,true).x-R)+"px");}else{Q.set("left",(F.position(this.domNode,true).x+this.domNode.offsetWidth)+"px");}if((W.y+S+N)>X.h){Q.set("top",(X.h-S-N+(V.y-W.y))+"px");}},handleMouseOver:function O(){var Q=this,R=function(){if(Q.hasSubmenu){Q.showContextMenu();}Q._cmSource.closeMenuTree(Q);Q._mouseOverTimer=null;};if(this._cmSource.activeMenuItem!==this){this._mouseOverTimer=window.setTimeout(R,80);}},handleMouseOut:function H(){if(this._mouseOverTimer){window.clearTimeout(this._mouseOverTimer);this._mouseOverTimer=null;}},closeMenuTree:function C(){this._cmSource.closeMenuTree();},handleClick:function E(){if(this.hasSubmenu){return ;}var Q=this._cmSource,R=this.data;if(!this.itemWidget){if(!Q.isSeparatorItem(R)&&Q.queryEnabled(R)){if(Q.executeCommand){Q.executeCommand(this.data);}Q.closeMenuTree();}}}});}());(function(){mstrmojo.requiresCls("mstrmojo.publisher","mstrmojo.Widget","mstrmojo.array","mstrmojo._HasChildren");var G=mstrmojo.array;function E(P){if(!this.shouldPropagateEnabled){return ;}var O=this._disabledChildren;G.forEach(P,function(Q){if(Q.enabled){O.push(Q.id);Q.set("enabled",false);}});}function J(){G.forEach(this._disabledChildren,function(O){var P=mstrmojo.all[O];if(P&&P.parent===this){P.set("enabled",true);}},this);this._disabledChildren=[];}mstrmojo.Container=mstrmojo.declare(mstrmojo.Widget,[mstrmojo._HasChildren],{scriptClass:"mstrmojo.Container",defaultChildSlot:"containerNode",containerNode:null,preserveChildDomOrder:true,shouldPropagateEnabled:false,init:function M(P){this._super(P);this._disabledChildren=[];this.attachEventListener("addChild",this.id,function(Q){if(this.shouldPropagateEnabled&&!this.enabled){E.call(this,Q.value);}});if(this.children){this.initChildren();}var O=this.parent;if(!O||O.hasInitBindings){this.initBindings();}},destroy:function H(O){if(this.children){this.destroyChildren(true);}if(this.bindings){this.destroyBindings();}this._super(O);},unrender:function I(Q){var R=this.children,O=(R&&R.length)||0,P;for(P=O-1;P>-1;P--){R[P].unrender(true);}this._super(Q);},postBuildRendering:function A(){if(this._super()!==false){this.renderChildren();return true;}return false;},renderChildren:function L(){var Q=this.children,O=(Q&&Q.length)||0,P;for(P=0;P<O;P++){var R=Q[P];if(this.childRenderCheck(R)){R.render();}}},childRenderCheck:function D(P){if(P&&!P.hasRendered){var O=P.slot||this.defaultChildSlot;return !!this[O];}return false;},addChildren:function N(R,P,Q){var O=this._super(R,P,Q);if(O){this.childRenderOnAddCheck(O);}return O;},removeChildren:function F(W,R){var V=W?[W]:(this.children||[]),O=V.length,S;for(S=O-1;S>-1;S--){var Q=V[S],P=Q&&Q.domNode;if(P){var U=this[(Q.slot||this.defaultChildSlot)];if(P.parentNode===U){U.removeChild(P);}}}return this._super(W,R);},childRenderOnAddCheck:function B(Q){if(this.hasRendered&&Q){var O=Q.length,P;for(P=0;P<O;P++){var R=Q[P];if(this.childRenderCheck(R)){R.render();}else{if(R&&R.hasRendered){this.onchildRenderingChange(R);}}}}},onchildRenderingChange:function K(O){var X=O&&O.domNode;if(!X){return ;}var P=this.defaultChildSlot,W=O.slot||P,Z=this[W],Q=this.children;if(!Z){if(X.parentNode){X.parentNode.removeChild(X);}}else{if(X.parentNode===Z){return ;}if(!this.preserveChildDomOrder){Z.appendChild(X);}else{var R,V;for(V=Q.length-1;V>=0;V--){var Y=Q[V];if(Y===O){break;}if(W===(Y.slot||P)){var a=Y.domNode;if(a&&a.parentNode===Z){R=a;}}}if(R){Z.insertBefore(X,R);}else{Z.appendChild(X);}}}if(mstrmojo.publisher.hasSubs(this.id,"childrenRendered")){var S=Q.length,U;for(U=0;U<S;U++){if(!Q[U].domNode){return ;}}this.raiseEvent({name:"childrenRendered"});}},propagateChildProps:function C(S){var R=this[S],Q=this.children||[],O=Q.length,P;for(P=0;P<O;P++){Q[P].set(S,R);}}});mstrmojo.Container.enabledMarkupMethod=function(){mstrmojo.Widget.enabledMarkupMethod.apply(this,arguments);if(this.shouldPropagateEnabled){if(this.enabled){J.call(this);}else{E.call(this,this.children);}}};}());(function(){mstrmojo.requiresCls("mstrmojo.Widget","mstrmojo.dom","mstrmojo.hash","mstrmojo.css");var C=mstrmojo.dom,B=mstrmojo.hash,E=mstrmojo.css;mstrmojo.Button=mstrmojo.declare(mstrmojo.Widget,null,{scriptClass:"mstrmojo.Button",iconClass:"",innerIconClass:"",title:"",text:"&nbsp;",enabled:true,selected:false,markupString:'<div id="{@id}" class="mstrmojo-Button {@cssClass} {@iconClass}" title="{@title}" style="{@cssText}" mstrAttach:touchstart,click,mousedown,mouseup><div class="mstrmojo-Button-text {@innerIconClass}"></div></div>',markupSlots:{textNode:function(){return this.domNode.firstChild;}},markupMethods:{onvisibleChange:mstrmojo.Widget.visibleMarkupMethod,onenabledChange:function(){E.toggleClass(this.domNode,"disabled",!this.enabled);},onselectedChange:function(){E.toggleClass(this.domNode,"selected",this.selected);},ontextChange:function(){this.textNode.innerHTML=this.text;},ontitleChange:function(){this.domNode.title=this.title;},onwidthChange:mstrmojo.Widget.widthMarkupMethod},oniconClassChange:function D(J){var K=this.domNode;if(this.hasRendered&&K){K.className=K.className.replace(J.valueWas,"")+" "+J.value;}},onclick:mstrmojo.emptyFn,ontouchend:function I(J){this.onclick(J);}});mstrmojo.Button.newIconButton=function H(L,O,M,J,N){var K={scriptClass:"mstrmojo.Button",title:L,cssClass:O,text:"",onclick:M};if(J){K.bindings=J;}B.copy(N,K);return K;};function F(M,N,J,P){var L=[];if(J){L.push(J);}var O=P&&P.cssClass;if(O){L.push(O);delete P.cssClass;}var K={scriptClass:"mstrmojo.Button",cssClass:L.join(" "),text:M};if(N){K.onclick=N;}return B.copy(P,K);}mstrmojo.Button.newInteractiveButton=function G(M,N,P,O){var L={glowClass:"glow"};if(P&&(C.isFF||C.isWK)){B.copy({onmousedown:function J(){E.applyShadow(this.domNode,0,0,10,P);},onmouseup:function K(){E.removeShadow(this.domNode);}},L);}return F(M,N,"mstrmojo-InteractiveButton",B.copy(O,L));};mstrmojo.Button.newWebButton=function A(K,J,M,L){return F(K,J,"mstrmojo-WebButton"+(M?" hot":""),L);};mstrmojo.Button.newActionButton=function(K,L,M){var J=mstrmojo.Button.newWebButton(K,L,false,M);J.cssClass=J.cssClass+" action-button";return J;};}());(function(){mstrmojo.requiresCls("mstrmojo.expr","mstrmojo.css","mstrmojo._IsExprNode","mstrmojo._HasPopup","mstrmojo.Widget","mstrmojo.fe.FilterUtils");var I=mstrmojo.dom,A=mstrmojo.css,E=mstrmojo.fe.FilterUtils,D=E.getExprConditionNodeHtml,B=E.getExprNodeHtmlAndText;function C(J){var K=J.data;return D(K);}mstrmojo.ConditionNode=mstrmojo.declare(mstrmojo.Widget,[mstrmojo._IsExprNode,mstrmojo._HasPopup],{scriptClass:"mstrmojo.ConditionNode",data:null,editable:false,prefixedAndOrEditable:false,markupString:'<div id="{@id}" class="mstrmojo-cond mstrmojo-ConditionNode {@cssClass}" mstrAttach:mousedown><div class="mstrmojo-onhoverparent mstrmojo-cond-prefix {@cssClass}"><span class="mstrmojo-textset mstrmojo-cond-prefix-text" mstrAttach:click></span><span class="mstrmojo-onhover-in mstrmojo-andor-tools {@cssClass}">{@_prefixAndOrToolsMarkup}</span></div><div class="mstrmojo-onhoverparent mstrmojo-cond-contents {@cssClass}"><span class="mstrmojo-textset mstrmojo-cond-text {@cssClass}" mstrAttach:click></span><span class="mstrmojo-cond-text-postfix {@cssClass}"></span><span class="mstrmojo-rel mstrmojo-cond-popupNode {@cssClass}"></span><span class="mstrmojo-onhover-bl mstrmojo-abs mstrmojo-topright mstrmojo-cond-tools {@cssClass}"><img class="mstrmojo-del" src="../images/1ptrans.gif" tooltip="'+mstrmojo.desc(7931,"Delete condition")+'" onclick="mstrmojo.all[\'{@id}\'].del()" /></span></div></div>',markupSlots:{prefixHoverNode:function(){return this.domNode.firstChild;},prefixNode:function(){return this.domNode.firstChild.firstChild;},prefixAndOrToolsNode:function(){return this.domNode.firstChild.childNodes[1];},condNode:function(){return this.domNode.childNodes[1];},textNode:function(){return this.domNode.childNodes[1].firstChild;},textPostfixNode:function(){return this.domNode.childNodes[1].childNodes[1];},popupNode:function(){return this.domNode.childNodes[1].childNodes[2];}},markupMethods:{onprefixedAndOrEditableChange:function(){A.toggleClass(this.prefixNode,["editable"],this.prefixedAndOrEditable);},oneditableChange:function(){A.toggleClass(this.textNode,["editable"],this.editable);},onselectedChange:function(){A.toggleClass(this.condNode,["selected"],this.selected);},ondataChange:function(){this.prefixNode.innerHTML=this.andOrTxt();var J=B(this.data);this.textNode.innerHTML=J.html;this.textNode.title=J.text;this.textPostfixNode.innerHTML=this.getConditionTextPostfix();}},betweenText:mstrmojo.desc(308,"and"),atText:mstrmojo.desc(5923,"at"),emptyText:mstrmojo.desc(7930,"Empty condition"),init:function H(J){this._super(J);this.markupString=this.markupString.replace("{@_prefixAndOrToolsMarkup}",this.getPrefixAndOrToolsMarkup());},getConditionTextPostfix:function(){return"";},del:function G(){var J=this.parent;if(J&&J.remove&&this.data){J.remove(this.data);}},isEmpty:function(){var K=this.data,J=K&&K.et,L=J&&mstrmojo.expr.ET2TGT[J];return !(L&&K[L]);},isSelectableArea:function(J){return I.contains(this.condNode,J,true);},preclick:function F(J){var L=null,K=I.eventTarget(J.hWin,J.e);if(I.contains(this.prefixNode,K,true)){L="andor";}else{if(I.contains(this.textNode,K,true)){L="condition";}else{if(I.contains(this.textPostfixNode,K,true)){I.stopPropogation(J.hWin,J.e);return false;}}}J.part=L;}});mstrmojo.ConditionNode.getFunctionNode=C;})();(function(){mstrmojo.requiresCls("mstrmojo.Widget");var E=mstrmojo.Widget;mstrmojo.ui._IsPulldown=mstrmojo.provide("mstrmojo.ui._IsPulldown",{scriptClass:"mstrmojo.ui._IsPulldown",markupString:'<div id="{@id}" style="{@cssText}" class="mstrmojo-ui-Pulldown {@cssClass}" mstrAttach:mousedown,click><div class="mstrmojo-ui-Pulldown-text {@cssTextClass}" title="{@title}" style="{@labelCssText}">{@value}</div><div class="container"></div></div>',markupSlots:{selectedNode:function D(){return this.domNode.firstChild;},containerNode:function A(){return this.domNode.lastChild;}},markupMethods:{onvisibleChange:E.visibleMarkupMethod,onheightChange:E.heightMarkupMethod,onwidthChange:E.widthMarkupMethod,onvalueChange:function F(){this.selectedNode.innerHTML=this.value||"";},onenabledChange:mstrmojo.Widget.enabledMarkupMethod},getPopupList:mstrmojo.emptyFn,anchorSlot:"selectedNode",postBuildRendering:function B(){this._super();this.getPopupList().set("items",this.items);var G=this.selectedIndex,H=this.selectedIndices;if(G!==undefined){this.set("selectedIndex",G);}if(H!==undefined){this.set("selectedIndices",mstrmojo.hash.copy(H||{}));}},onitemsChange:function C(){var G=this.getPopupList();if(G){G.set("items",this.items);}},onPopupWidgetOpened:function(){var G=this.getPopupList();if(G&&(!G.items||G.items.length===0)){G.close();}}});}());(function(){mstrmojo.requiresCls("mstrmojo.Widget");var C=mstrmojo.css,G=mstrmojo.array;function F(H,J){var I={searchMetadata:{taskId:"searchMetadata",styleName:this.searchStyleName,rootFolderID:this.rootID,searchPattern:this.searchPattern+"*",nameWildcards:(this.qse?16:1),quickSearch:this.qse,sortKey:(this.qse?-1:6),blockBegin:this.blockBegin||1,blockCount:this.blockCount,recursive:1,folderBrowserStyle:0,includeAncestorInfo:"true",includeObjectDesc:this.includeObjectDesc,searchXML:this.searchXML||"",dataSourcesXML:this.dataSources||"",objectType:this.objectTypes},browseFolder:{taskId:"searchMetadata",rootFolderID:this.rootID,blockBegin:this.blockBegin,blockCount:this.blockCount,recursive:this.hierarchical?0:(this.searchXML?"":1),folderBrowserStyle:this.hierarchical?1:0,includeAncestorInfo:String(!!this.hierarchical),searchXML:this.searchXML||"",dataSourcesXML:this.dataSources||"",objectType:this.objectTypes},browseElements:{taskId:"browseElements",styleName:"MojoAttributeStyle",attributeID:this.rootID,blockBegin:this.blockBegin,blockCount:this.blockCount,filterXML:this.filterXML||"",searchPattern:this.searchPattern||"",matchCase:!!this.matchCase,dataSourcesXML:this.dataSourcesXML||"",includeFormNames:!!this.collectForms,includeFormValues:!!this.bIncludeFormValues,displayedForms:this.displayedForms||1,dimensionID:this.dimensionId||""}}[H]||{};if(typeof J==="object"){mstrmojo.hash.copy(J,I);}return I;}var B="##searchPattern";mstrmojo.SearchBox2=mstrmojo.declare(mstrmojo.Widget,null,{scriptClass:"mstrmojo.SearchBox2",taskId:"searchMetadata",rootID:null,searchStyleName:"MojoFolderStyle",objectTypes:"3,14,256,257,1024,1027,2048,3072,10",token:{searchMetadata:/\//,browseElements:/(^-)|(,)|( OR )|( AND)|([<>]=?)|(&)|( )|(["\[\]\/])/},blockCount:50,blockBegin:1,minSearchLength:2,matchCase:false,enableMatchCase:true,supportIncFetch:true,quickSearch:false,searchAfterSearchPatternRestored:false,includeObjectDesc:true,forceResetCache:false,onUpdateSearchParams:mstrmojo.emptyFn,markupString:'<table id={@id} cellspacing=0 cellpadding=0 class="mstrmojo-SearchBox-Wrapper {@cssClass}" style="{@cssText};"><tr><td><div class="mstrmojo-SearchBox" mstrAttach:click ><input class="mstrmojo-SearchBox-input" type="text" mstrAttach:keyup,blur /></div></td><td><div class="mstrmojo-SearchBox-bg"><div class="mstrmojo-SearchBox-search" id="{@id}sbSearch" mstrAttach:click ></div></div></td><td><div class="mstrmojo-SearchBox-options" style="{@cssTextShowMC}"><input id="{@id}sbMatchCase" type="checkbox" mstrAttach:click /><label for="{@id}sbMatchCase">'+mstrmojo.desc(4326,"Case Sensitive")+"</label></div></td></tr></table>",markupSlots:{inputNode:function(){return this.domNode.rows[0].cells[0].firstChild.firstChild;},searchNode:function(){return this.domNode.rows[0].cells[1].firstChild.firstChild;},optionNode:function(){return this.domNode.rows[0].cells[2].firstChild.firstChild;}},preBuildRendering:function(){this.cssTextShowMC=this.enableMatchCase?"":"display: none";},postBuildRendering:function(){if(this._super){this._super();}this.matchCase=this.optionNode.checked;},onkeyup:function E(H){var J=this;var I=J.searchTimer;if(I){window.clearTimeout(I);}J.searchTimer=window.setTimeout(function(){J.onkeyupDelayed(H);delete J._searchTimer;},parseInt(H.e.keyCode||H.e.charCode,10)===13?0:J.searchDelay);},onkeyupDelayed:function A(I){var H=I.hWin,K=I.e||H.event;var J=mstrmojo.string.trim(this.inputNode.value);if(this.searchNode){C.toggleClass(this.searchNode,["clear"],J.length>0);}this.showTaskError=false;this.click2Search=false;if(J.length==0||this.autoSubmit||this.onEnter&&K.keyCode===13){this._onsearch();}},onEnter:function(){this._onsearch();},onclick:function(I){var H=I.hWin,K=I.e||H.event,M=K.target||K.srcElement,L=M&&M.id;switch(L.replace(this.id,"")){case"sbDown":if(this.enableMatchCase){var J=this.optionNode.parentNode.style;J.display=J.display=="block"?"none":"block";}break;case"sbSearch":if(this.inputNode.value.length>0){this.clearSearch();}break;case"sbMatchCase":this.set("matchCase",this.optionNode.checked);break;case"sbSpinner":break;}},clearSearch:function(){this.inputNode.value="";C.removeClass(this.searchNode,["clear"]);var I=this.searchCache,H=this.rootID;if(I&&I[H]){I[H][B]="";}this._onsearch(true);},onmatchCaseChange:function(){this.matchCaseChanged=true;this._onsearch();},onrootIDChange:function(){this.rootChanged=true;this._setupCache(this.forceResetCache);var I=this.searchCache[this.rootID];if(I){var H=I[B]||"";this.inputNode.value=H;if(H.length>0){if(H.length>=this.minSearchLength&&this.searchAfterSearchPatternRestored){this._onsearch();}}}},getRootID:function(){},contentWidget:null,_notifyContentWidget:function(I){var H=this.contentWidget||this;H.set("items",I[0]);if(this.supportIncFetch){var J=I[1],L=I[2],K=this.blockCount;H.set("ifs",{np:Math.floor(J/K)+((J%K>0)?1:0),cp:Math.floor(L/K)+((L%K>0)?1:0)});}},_onsearch:function(H){this.getRootID();this._setupCache();var K=mstrmojo.string.trim(this.inputNode.value);if(K.length===0){H=true;}var L=this.token[this.taskId];if(L.test(K)){}if(this.searchPattern==K&&!this.rootChanged&&!this.matchCaseChanged&&!this.click2Search){return ;}var M=this.rootID,J=this.searchCache[M];if((K.length<this.minSearchLength&&!this.click2Search)&&!H){if(this.searchPattern&&this.searchPattern.length>=this.minSearchLength){this._notifyContentWidget(J[M]);this.searchPattern=K;}}else{this.searchPattern=K;J[B]=this.searchPattern;var I=this.filterCache(K,J,H);if((this.click2Search||I===null)&&!H){this.blockBegin=1;this.fetch();return ;}else{this._notifyContentWidget(I);}}J[B]=K;},_setupCache:function(J){var K=this.searchCache,I=this.rootID;if(K&&(J||!K[I])){K[I]=K[I]||{};var H=this.contentWidget&&this.contentWidget.items||this.rootCacheItems||[];K[I][I]=[H,this.totalSize||0,this.blockBegin||1].concat();}},taskCallId:0,path:mstrConfig.taskURL,method:"POST",serverRequest:function D(H,I){if(mstrApp&&mstrApp.serverRequest){mstrApp.serverRequest(H,I);}else{mstrmojo.xhr.request("POST",this.path,I,H,undefined,this.XServer,this.baseParams);}},fetch:function(){this.rootChanged=false;this.matchCaseChanged=false;if(this.spinnerNode){this.spinnerNode.style.display="block";}if(this.preFetch){this.preFetch();}var H=this,I=F.apply(this,[this.taskId]);I.searchPattern=this.searchPattern;this.onUpdateSearchParams(I);var J={success:function(K){var L=K.items||K.es||[];L=[L,K.totalSize||K.sz||0,K.blockBegin||K.bb];mstrmojo.all[H.id].searchCache[H.rootID][(I.searchPattern.length==0?H.rootID:H.buildIndex(I.searchPattern))]=L;H._notifyContentWidget(L);},failure:function(K){if(H.showTaskError){mstrmojo.alert(mstrmojo.desc(8117,"Data request failed:")+" \n"+K.getResponseHeader("X-MSTR-TaskFailureMsg"));}},complete:function(){if(H.spinnerNode){H.spinnerNode.style.display="none";}if(H.postFetch){H.postFetch();}}};this.serverRequest(I,J);},fetchPage:function(H){this.blockBegin=H*this.blockCount+1;this.fetch();},filterCache:function(J,M,I){var H=M&&M[I?this.rootID:this.buildIndex(J)];if(H){return H;}var K=this.token[this.taskId];if(K.test(J)||this.totalSize>this.blockCount){return null;}var O=J.replace(/.$/,"");H=M&&M[this.buildIndex(O)];while(H===undefined&&(O=O.replace(/.$/,"")).length>0){H=M&&M[this.buildIndex(O)];}if(H!==undefined){if(H[1]>this.blockCount){return null;}var L=H[0],N=[];G.forEach(L,function(P){if(P.n.search(new RegExp(J,this.matchCase?"":"i"))>-1){N.push(P);}});this.totalSize=N.length;return(M[this.buildIndex(J)]=[N,N.length,this.blockBegin].concat());}return null;},buildIndex:function(H){if(H.replace(/^\s|\s$/g,"").length===0){return"";}return !this.matchCase?H.toUpperCase():H+"::0";},init:function(H){if(this._super){this._super(H);}this.qse=mstrApp.useQuickSearch&&mstrApp.useQuickSearch()||0;this.autoSubmit=this.quickSearch&&(mstrApp.searchAutoComplete&&mstrApp.searchAutoComplete()||false);this.searchDelay=mstrApp.searchAutoCompleteDelay&&mstrApp.searchAutoCompleteDelay()||0;this.xhr=new mstrmojo.SimpleXHR();this.searchCache=this.searchCache||{};},clear:function(){this.inputNode.value="";C.removeClass(this.searchNode,["clear"]);}});})();(function(){mstrmojo.requiresCls("mstrmojo.Widget","mstrmojo.css");var C=mstrmojo.Widget;mstrmojo.ui.Checkbox=mstrmojo.declare(mstrmojo.Widget,null,{scriptClass:"mstrmojo.ui.Checkbox",markupString:'<div id="{@id}" class="mstrmojo-ui-Checkbox {@cssClass}" mstrAttach:click></div>',markupMethods:{onvisibleChange:C.visibleMarkupMethod,oncheckedChange:function B(){mstrmojo.css.toggleClass(this.domNode,"checked",this.checked);},onenabledChange:C.enabledMarkupMethod},checked:false,onclick:function A(){this.set("checked",!this.checked);}});}());(function(){mstrmojo.requiresCls("mstrmojo.Widget");mstrmojo.WaitIcon=mstrmojo.declare(mstrmojo.Widget,null,{scriptClass:"mstrmojo.WaitIcon",cssFloat:"left",visible:false,markupString:'<div id="{@id}" class="mstrmojo-WaitIcon {@cssClass}" style="float:{@cssFloat};{@cssText};"></div>',markupMethods:{onvisibleChange:function(){this.domNode.style.display=this.visible?"block":"none";}},markupSlots:{}});}());(function(){mstrmojo.requiresCls("mstrmojo.Widget","mstrmojo.hash","mstrmojo.css","mstrmojo.string");function A(C,B){return mstrmojo.hash.copy(B,{label:"",tabIndex:"",cssDisplay:"inline",name:null,markupString:'<span id="{@id}" class="'+C+' {@cssClass}" style="{@cssText}" title="{@tooltip}"><input id="{@id}_input"  type="{@type}" name="{@name}" value="{@value}" tabIndex="{@tabIndex}" mstrAttach:click tstid="{@tstid}"/><label for="{@id}_input">{@label}</label></span>',markupSlots:{inputNode:function(){return this.domNode.firstChild;},labelNode:function(){return this.domNode.childNodes[1];}},markupMethods:{onvisibleChange:function(){this.domNode.style.display=(this.visible)?this.cssDisplay:"none";},onenabledChange:function(){this.inputNode.disabled=!this.enabled;mstrmojo.css[this.enabled?"removeClass":"addClass"](this.domNode,"disabled");},onlabelChange:function(){this.labelNode.innerHTML=mstrmojo.string.encodeHtmlString(this.label);},oncheckedChange:function(){this.inputNode.checked=this.checked;}},checked:false,preclick:function(){this.set("checked",this.inputNode.checked);},isChecked:function(){return this.inputNode.checked;}});}mstrmojo.CheckBox=mstrmojo.declare(mstrmojo.Widget,null,A("mstrmojo-CheckBox",{scriptClass:"mstrmojo.CheckBox",type:"checkbox"}));mstrmojo.ImageCheckBox=mstrmojo.declare(mstrmojo.Widget,null,A("mstrmojo-CheckBox mstrmojo-ImageCheckBox",{scriptClass:"mstrmojo.CheckBox",type:"image",cssDisplay:"block",preclick:function(){this.set("checked",!this.checked);},postCreate:function(){this.markupMethods=mstrmojo.hash.copy(this.markupMethods);this.markupMethods.oncheckedChange=function(){mstrmojo.css.toggleClass(this.inputNode,["checked"],this.checked);};},postBuildRendering:function(){this.inputNode.src=this.src||"../images/1ptrans.gif";if(this._super){return this._super();}return true;}}));mstrmojo.RadioButton=mstrmojo.declare(mstrmojo.Widget,null,A("mstrmojo-RadioButton",{scriptClass:"mstrmojo.RadioButton",type:"radio",postBuildRendering:function(){if(mstrmojo.dom.isIE){this.inputNode.checked=this.checked;}}}));}());(function(){mstrmojo.requiresCls("mstrmojo.boxmodel","mstrmojo.array","mstrmojo.hash","mstrmojo.dom","mstrmojo.css","mstrmojo.Widget","mstrmojo.Arr","mstrmojo._HasLayout","mstrmojo._ListBase2Selections","mstrmojo.ListSelector","mstrmojo._TouchScrolling","mstrmojo._PagingList");var b=mstrmojo.hash,g=mstrmojo.array,f=mstrmojo.boxmodel,d=mstrmojo.dom;function A(k,m,j){var l=k.listSelector;if(l){l[m](k,k.itemsContainerNode,j);}}function L(k,j){var l=k.lastPagePos;if(!l||l.dragId!==j){l=f.offset(k.itemsContainerNode);l.dragId=j;k.lastPagePos=l;var m=k.scrollboxNode;k.lastScrollPos={left:m.scrollLeft,top:m.scrollTop,width:m.clientWidth,height:m.clientHeight};}}function O(m,p,k){var l=p&&p.node;if(l===m.dropCueNode||l===m.dropCueNode.firstChild){return m.dropCuePos;}var n=m.listMapper;var j=n&&n.whereDrop(m,m.itemsContainerNode,l,p.pos,{left:m.lastPagePos.left-m.lastScrollPos.left,top:m.lastPagePos.top-m.lastScrollPos.top,width:m.lastScrollPos.width,height:m.lastScrollPos.height});var o=m.dropCuePos;return((k!==false)&&o&&j&&(o.idx===j.idx)&&(o.left===j.left)&&(o.top===j.top))?o:j;}var h="attachEventListener";function D(k,j){if(k.makeObservable){j=j||[];if(!j[h]){mstrmojo.hash.make(j,k.itemsScriptClass||mstrmojo.Arr);}}return j;}function H(k,j){if(j&&j[h]){k._sub_its=j;k._sub_add=j[h]("add",k.id,"preadd");k._sub_rmv=j[h]("remove",k.id,"preremove");}}function G(j){if(j._sub_its){var k=mstrmojo.publisher;k.unsubscribe(j._sub_add);k.unsubscribe(j._sub_rmv);delete j._sub_add;delete j._sub_rmv;delete j._sub_its;}}mstrmojo.ListBase2=mstrmojo.declare(mstrmojo.Widget,[mstrmojo._ListBase2Selections,mstrmojo._TouchScrolling,mstrmojo._PagingList,mstrmojo._HasLayout],{scriptClass:"mstrmojo.ListBase2",items:null,markupString:'<div id="{@id}" class="mstrmojo-ListBase2 {@cssClass}" style="position:relative;{@cssText}" mstrAttach:keyup,keypress,mousedown,mouseup,dblclick><div class="mstrmojo-ListBase2-itemsContainer" style="position:relative;{@itemsContainerCssText}">{@itemsHtml}</div><div class="mstrmojo-ListBase2-dropCue {@cssClass}"><div class="mstrmojo-ListBase2-dropCue-inner"></div></div></div>',markupSlots:{scrollboxNode:function(){return this.domNode;},itemsContainerNode:function(){return this.domNode.firstChild;},dropCueNode:function(){return this.domNode.lastChild;}},markupMethods:{onvisibleChange:function(){this.domNode.style.display=this.visible?this.cssDisplay:"none";},ondropCuePosChange:function(){var k=this.dropCueNode,j=k&&k.style;if(!j){return ;}var m=this.dropCuePos,l=!!m;if(l){j.left=m.left+"px";j.top=m.top+"px";}j.display=l?"block":"none";},onpageChange:function(){if(this.usePaging&&!this._inScroll){this._inPaging=true;this.listMapper.toPage(this,this.page);this._inPaging=false;}},onwidthChange:function(){if(!isNaN(parseInt(this.width))){this.domNode.style.width=this.width;}},onheightChange:function(){if(!isNaN(parseInt(this.height))){this.domNode.style.height=this.height;}}},autoHide:false,renderOnScroll:false,firstRenderBlockSize:50,renderBlockSize:50,listMapper:null,listBuilder:null,listSelector:mstrmojo.ListSelector,animate:false,itemsEffect:null,containerResizable:true,init:function a(m){this._super(m);this.items=this.initItems(this.items);var l=this.selectedIndices,j=this.selectedIndicesList,k=this.selectedIndex,n=this.selectedItem;this.selectedIndices={};this.selectedIndex=-1;delete this.selectedIndicesList;delete this.selectedItem;if(l||j||(k>-1)||n){this.initSelections(l,j,k,n);}if(this.postInitItems){this.postInitItems();}},initItems:function I(j){return D(this,j);},preBuildRendering:function X(){var n=this.listBuilder,q=n.newContext(this);this.ctxtBuilder=q;var k=this.markupSlots,m=!!(this.renderOnScroll&&this.renderBlockSize&&k&&k.scrollboxNode),l=this.items,j=(l&&l.length)||0,o=m?this.firstRenderBlockSize:j,p=m?this.firstRenderBlockSize:0;this._eros=m;this.paused=false;this.itemsHtml=this.listMapper.buildItemWrappers(l,n,this,q,o,p).join("");this.itemsContainerCssText="visibility: hidden";if(this._super){this._super();}},postBuildRendering:function E(){delete this.itemsHtml;var o=this.listMapper;if(o&&o.postBuildRendering){o.postBuildRendering(this.itemsContainerNode,this.items,this.listBuilder,this,this.ctxtBuilder);}H(this,this.items);if(this._eros||this.usePaging){if(!this._cb_scroll){var q=this.id;this._cb_scroll=function(){var n=mstrmojo.all[q];n.onscroll();};}mstrmojo.dom.attachEvent(this.scrollboxNode,"scroll",this._cb_scroll);this.onscroll();}if(this.animate){for(var l=0,k=["itemsEffect","scrollEffect"],j=k.length;l<j;l++){var p=k[l],m=this[p];if(m&&m.constructor===Object){m=mstrmojo.insert(mstrmojo.hash.clone(m));m.widget=this;this[p]=m;}}if(this.itemsEffect){this.itemsEffect.play();}}this.itemsContainerNode.style.visibility="inherit";if(this.containerResizable&&this.itemsContainerNode.scrollWidth<this.domNode.scrollWidth){this.itemsContainerNode.style.width=this.domNode.scrollWidth+"px";}if(this._super){this._super();}},unrender:function Y(m){G(this);if(this._eros){mstrmojo.dom.detachEvent(this.scrollboxNode,"scroll",this._cb_scroll);delete this._cb_scroll;}for(var k=0,l=["itemsEffect","scrollEffect"],j=l.length;k<j;k++){var n=this[l[k]];if(n&&n.isPlaying){n.cancel();}}this._super(m);},pauseScrollRendering:function P(l,j,k){if(l!==false){l=true;}if(this.paused===!!l){return ;}this.paused=!!l;if(l){if(this._fillTmr){window.clearTimeout(this._fillTmr);delete this._fillTmr;}}else{this.fill(j,k);}},onscroll:function K(){if(this.paused){return ;}if(this._eros){if(!this._fillTmr){var j=this;this._fillTmr=self.setTimeout(function(){j.fill();j=null;},50);}}if(this._super){this._super();}},fill:function c(j,n){if(this._fillTmr){window.clearTimeout(this._fillTmr);delete this._fillTmr;}var o=(this.items&&this.items.length)||0;if(!o){if(n){n();}}else{var l=this.scrollboxNode,p=this.itemsContainerNode,m=mstrmojo.boxmodel.offset(p,l),r=this.listMapper,q=r.findScrollRange(p,o,(this.usesTouches&&this.pos&&parseInt(this.pos.y,10))||l.scrollTop,l.clientHeight,(this.usesTouches&&this.pos&&parseInt(this.pos.x,10))||l.scrollLeft,l.clientWidth,m.left,m.top);if(this.fillAt(q.start,q.end)){if(j){j();}var k=this.id;this._fillTmr=window.setTimeout(function(){mstrmojo.all[k].fill(j,n);},100);}else{if(n){n();}}}},fillAt:function M(l,k){var j=this.listMapper;if(j){return j.fillItemWrappers(this.itemsContainerNode,this.items,this.listBuilder,this,this.ctxtBuilder,l,k,this.renderBlockSize);}else{return false;}},add:function R(k,j){if(!k||!k.length){return -1;}var l=this.items;if(j==null){j=b.min(this.selectedIndices,false,true);if(j!==null&&j!==undefined){j++;}}if(j==null||j===-1){j=(l&&l.length)||0;}if(l&&l.add){l.add(k,j);}else{this.set("items",l?g.insert(l.concat(),j,k):k);}return j;},preadd:function B(l){if(this.hasRendered){var o=this.listMapper;if(o){o.onadd(this,this.itemsContainerNode,this.ctxtBuilder,l);}var n=this.listBuilder;if(n){n.onadd(this,this.ctxtBuilder,l);}var k=this.listSelector;if(k){k.onadd(this,l);}if(this._eros){this.onscroll();}else{var m=l.index,j=l.value.length;this.fillAt(m,m+j-1);}}if(this.onadd){this.onadd(l);}if(this._super){this._super(l);}},remove:function V(j){if(j==null){return -1;}if(j.constructor!==Array){return this._remove(j);}var l=this.items;if(l){var k;if(l.remove){for(k=j.length-1;k>-1;k--){l.remove(j[k],1);}}else{l=l.concat();for(k=j.length-1;k>-1;k--){l.splice(j[k],1);}this.set("items",l);}return j[0];}return -1;},_remove:function V(l){var k=this.items;if(!k||(l==null)){return -1;}var j;if(!isNaN(l)){j=l;}else{j=this.itemIndex(l);}if(j>-1){if(k.remove){k.remove(j,1);}else{k=k.concat();k.splice(j,1);this.set("items",k);}}return j;},duplicate:function Z(o,k,l){var m=this.items,j=-1;if(!m||(o==null)){return -1;}if(!isNaN(o)){if(k===null||k===undefined){k=o+1;}o=m[o];}else{if(k===null||k===undefined){k=this.itemIndex(o)+1;}}if(o){var n;n=b.copy(l,b.clone(o));j=this.add([n],k);}return j;},preremove:function N(k){if(this.hasRendered){var m=this.listMapper;if(m){m.onremove(this,this.itemsContainerNode,this.ctxtBuilder,k);}var l=this.listBuilder;if(l){l.onremove(this,this.ctxtBuilder,k);}var j=this.listSelector;if(j){j.onremove(this,k);}if(this._eros){this.onscroll();}}if(this.onremove){this.onremove(k);}if(this._super){this._super(k);}},move:function S(m,r){function p(u,t){return r>=u&&r<=u+t;}var q=(this.items&&this.items.length)||0;if(r===-1||r==null||isNaN(r)){r=q;}else{r=Math.min(r,q);}var l,j,o,n;if(m.constructor===Array){j=m;o=m;n=(j&&j.length)||0;if(p(m[0],m.length)){return false;}l=g.get(this.items,m);}else{if(typeof (m)==="object"){l=[m];n=1;j=this.itemIndex(l[0]);o=[j];if(p(j,1)){return false;}}else{j=m;o=[m];n=1;if(p(j,1)){return false;}l=[this.items[j]];}}for(var k=0;k<n;k++){if(o[k]<=r){r--;}}if(l[0]!=null){this.remove(j);this.add(l,r);}return true;},itemIndex:function F(j){if(j==null){return -1;}var k=this.itemIdField;return k?g.find(this.items,k,j[k]):g.indexOf(this.items,j);},prechange:function U(l){if(this.hasRendered){var k=[this.listBuilder,this.listMapper];for(var m=0,j=k.length;m<j;m++){var n=k[m];if(n&&n.onchange){n.onchange(this,this.itemsContainerNode,this.ctxtBuilder,l);}}}},makeObservable:false,_set_items:function J(p,j){var o=this.items;j=this.initItems(j);this.items=j;if(o!==j){var m=this,l=function(){if(m.autoHide){m.set("visible",!!(j&&j.length));}m=null;},k=this.hasRendered;if(k){this.refresh(l);}else{l();}}return o!==j;},premousedown:function e(j){A(this,"premousedown",j);},premouseup:function Q(j){A(this,"premouseup",j);},scrollTo:function W(k){var j,l=this.listMapper;if(l&&l.toItem){if(!isNaN(k)){j=k;}else{j=this.itemIndex(k);}if(j>=0){l.toItem(this,j);}}},draggable:false,getDragData:function(n){L(this,n.id);var l=O(this,n.src),k=l&&l.idxActual;if((k>-1)&&this.selectedIndices[k]){var m=this.sortSelectedIndices(),j=g.get(this.items,m)||[];switch(j.length){case 1:return b.copy({html:j[0][this.itemDisplayField],index:m[0]},b.copy(j[0]));case 0:return null;default:return b.copy({html:j.length+" selections",indices:m},j);}}},dropZone:false,ondragenter:function(j){L(this,j.id);this.set("dropCuePos",O(this,j.tgt));},ondragover:function(j){this.set("dropCuePos",O(this,j.tgt));},ondragleave:function(j){this.set("dropCuePos",null);},isDragValid:function C(j){return j&&j.src&&j.src.data;},ondragstart:function(j){if(!(j&&j.src&&j.src.data)){return false;}},allowCopy:false,ondragend:function(m){var k=m&&m.tgt,j=k&&k.widget;if(j===this){}else{if(this.tree&&j&&j.tree===this.tree){if(!this.allowCopy||!d.ctrlKey(k.hWin,k.e)){var l=m.src&&m.src.data;if(l&&(l.indices||(l.index!==null))){this.remove(l.indices||l.index);}}}}},ondrop:function(r){var w=r&&r.src,q=w&&w.data;if(q){var l=O(this,r.tgt,false),t=l&&l.idx,m=(q&&q.constructor===Array),k=this.sortSelectedIndices();var o=this.items;t=Math.min(t,o&&o.length)||0;var u=true;if(w.widget===this){u=this.move(k,t);g.forEach(k,function(x){if(x<=t){t--;}});}else{this.add(m?q:[q],t);}if(u){var p=m?q.length:1,j={};for(var n=0;n<p;n++){j[t+n]=true;}this.set("selectedIndices",j);}}this.set("dropCuePos",null);}});})();(function(){mstrmojo.requiresCls("mstrmojo.Widget","mstrmojo._IsExprNode","mstrmojo.fe._IsRelationTreeNode","mstrmojo._HasEditableText","mstrmojo.css","mstrmojo.string","mstrmojo.dom");var C=mstrmojo.css,A=mstrmojo.dom,F=mstrmojo.string,E=function(H){this._super&&this._super(H);A.stopPropogation(H.hWin,H.e);},G=mstrmojo.fe._IsRelationTreeNode.createSetHtml;mstrmojo.fe.DynamicNode=mstrmojo.declare(mstrmojo.Widget,[mstrmojo._IsExprNode,mstrmojo.fe._IsRelationTreeNode,mstrmojo._HasEditableText],{scriptClass:"mstrmojo.fe.DynamicNode",markupString:'<div id="{@id}" class="mstrmojo-dynamic {@cssClass}"  style="position:relative;{@cssText}" mstrAttach:mousedown><div class="mstrmojo-onhoverparent mstrmojo-dynamic-prefix {@cssClass}"><span class="mstrmojo-textset mstrmojo-dynamic-prefix-text"  mstrAttach:click></span><span class="mstrmojo-onhover-in mstrmojo-andor-tools {@cssClass}">'+G+'<span class="mstrmojo-indent" onclick="mstrmojo.all[\'{@id}\'].ind()">'+mstrmojo.desc(5895,"Group conditions")+'</span><span class="mstrmojo-outdent" onclick="mstrmojo.all[\'{@id}\'].out()">'+mstrmojo.desc(5896,"Ungroup Conditions")+'</span></span></div><div class="mstrmojo-onhoverparent mstrmojo-dynamicNode" title="'+mstrmojo.desc(13229,"Add this condition to the target list of a selector.")+'"><span class="mstrmojo-dynamicNode-info"><span class="mstrmojo-textset"></span></span><span class="mstrmojo-onhover-bl mstrmojo-abs mstrmojo-topright mstrmojo-cond-tools {@cssClass}"><img class="mstrmojo-del" src="../images/1ptrans.gif" title="'+mstrmojo.desc(7931,"Delete condition")+'" onclick="mstrmojo.all[\'{@id}\'].del()" ></img></span><span class="mstrmojo-textset mstrmojo-rename-text" mstrAttach:click >'+mstrmojo.desc(1388,"Rename")+"</span>"+G+"</div></div>",markupSlots:{prefixHoverNode:function(){return this.domNode.firstChild;},prefixNode:function(){return this.domNode.firstChild.firstChild;},dynamicNode:function(){return this.domNode.lastChild;},textNode:function(){return this.domNode.lastChild.firstChild.lastChild;},createSetOptNode:function(){return this.domNode.firstChild.childNodes[1].firstChild;},createSetNode:function(){return this.domNode.lastChild.lastChild;},renameNode:function(){return this.domNode.lastChild.childNodes[2];}},markupMethods:{onprefixedAndOrEditableChange:function(){C.toggleClass(this.prefixNode,["editable"],this.prefixedAndOrEditable);},onselectedChange:function(){C.toggleClass(this.dynamicNode,["selected"],this.selected);},onisEditingChange:function(){C.toggleClass(this.domNode,["renaming"],this.isEditing);},ondataChange:function(){this.prefixNode.innerHTML=this.andOrTxt();this.textNode.innerHTML=this.data.ph.n;},onglowChange:function(){var H=this;C.toggleClass(H.dynamicNode,["glow"],this.glow);if(this.glow){setTimeout(function(){C.toggleClass(H.dynamicNode,["glow"],false);H.glow=false;},1000);}},onnoRelationOperatorChange:function(){C.toggleClass(this.prefixHoverNode,["noRelation"],this.noRelationOperator);},onnoRelationChange:function(){C.toggleClass(this.dynamicNode,["noRelation"],this.noRelation);}},editableSlot:"textNode",editButtonSlot:"renameNode",init:function(H){var J=H.data;if(J){var I=H.tree.nameFactory;if(J.ph.n){I.setName(J.ph.n,this);}else{J.ph.n=I.getNewName(this,mstrmojo.desc(12033,"Dynamic Condition")+" ");}}this._super(H);},_set_data:function(K,H){var I=this.data,J=(I!==H);if(J){this.data=H;this.text=H.ph.n;}return J;},preclick:function D(H){var J=null,I=A.eventTarget(H.hWin,H.e);if(A.contains(this.prefixNode,I,true)){J="andor";}else{if(A.contains(this.createSetOptNode,I,true)&&!this.noRelationOperator&&!this.noRelation){J="createSetOpt";}else{if(A.contains(this.createSetNode,I,true)&&!this.noRelation){J="createSet";}else{if(A.contains(this.renameNode,I,true)){this.set("isEditing",true);}}}}H.part=J;},isEmpty:function(){var I=this.data,H=I&&I.ph;return !(H&&H.n);},del:function B(){var I=this.parent,H=this.tree.nameFactory;if(I&&I.remove&&this.data){I.remove(this.data);H.removeName(this.data.ph.n);}},onkeyup:E,onkeydown:E,onTextEditComplete:function(){var J=this.tree,K=J.nameFactory,H=F.trim(this.text||""),I=this.data.ph.n;if(H&&H!==I){if(K.isNameExist(H)){K.names[H].set("glow",true);this.set("isEditing",true);}else{K.changeName(I,H,this);this.data.ph.n=H;}}},isSelectableArea:function(H){return mstrmojo.dom.contains(this.dynamicNode,H,true);},avatarCssCls:"mstrmojo-FE mstrmojo-dynamicNode",getAvatarNode:function(){return this.dynamicNode.cloneNode(true);}});})();(function(){mstrmojo.requiresCls("mstrmojo._HasScrollbox","mstrmojo.array","mstrmojo.css","mstrmojo.dom","mstrmojo.string","mstrmojo.Widget");var R=mstrmojo,S=R.array,A=R.css,I=R.dom,P=R.hash,k=R.string,W="selected",H="open",X="leaf",d="loading",g=":",c="li",o="ul",m="idx",n="level";function F(AB,r,z,w){var x=this.renderIndex*this.renderBlockSize,q=z.split(":"),AA=parseInt(q[0],10)+x,t=!!this.selectedIndices[AA],p=!!this.expandedIndices[AA],u=(AB.isLeaf||(!this.dataHelper&&!(AB.items&&AB.items.length)));q[0]=AA;return k.apply('<{@tag} class="{@cls}" level="{@level}" idx="{@idx}">{@itemMkp}{@childMkp}</{@tag}>',{tag:c,cls:(t?W:"")+(p?" "+H:"")+(u?" "+X:""),level:r,idx:q.join(":"),itemMkp:this.itemRenderer.render(AB,r,z,this),childMkp:w||""});}function b(AA,q,u){var AD=[],t=0,AB=this.itemRenderer,z=AB&&AB.render,p=AA&&AA.length,x,w,AC,r;AD[t++]="<"+o+">";if(z&&typeof z==="function"&&p){for(r=0;r<AA.length;r++){AC=AA[r];x=u.concat([r]);w=x.join(g);AD[t++]=F.call(this,AC,q,w,b.call(this,AC.items,q+1,x));}}AD[t]="</"+o+">";return AD.join("");}function L(q,r){var p=r[0];if(r&&r.length===1){return q[p];}return L(q[p].items,r.slice(1));}function K(q,r,t,x,p,w){var u=w.treeHooks[q];if(u&&u.call(w,r,t,x,p)){return ;}A.toggleClass(r,W,q==="select");}function U(q,u,AE,p,AC,z){var AB=z.treeHooks[q],w=AE.items,AA=(!w||w.length===0),t=q==="expand",x=z.dataHelper;if(AB&&AB.call(z,u,AE,p,AC)){return ;}if(t&&!x&&AA){A.addClass(u,X);return ;}if(t&&x){if(AA){if(AE.tp==="search"){A.toggleClass(u,H,t);return ;}A.toggleClass(u,d,true);x.fetch(AE,{success:function AD(AG){var AF=AE.items=AG.items;if(AF&&AF.length>0){u.innerHTML+=b.call(z,AF,(parseInt(p,10)+1),AE._renderIdx.split(g));}else{A.addClass(u,X);}},complete:function r(){A.toggleClass(u,d,false);}});}}A.toggleClass(u,H,t);}mstrmojo.ui.SimpleTree=mstrmojo.declare(mstrmojo.Widget,[mstrmojo._HasScrollbox],{scriptClass:"mstrmojo.ui.SimpleTree",markupString:'<div id="{@id}" class="mstrmojo-SimpleTree {@cssClass}" mstrAttach:click>{@itemsHTML}</div>',markupMethods:{onvisibleChange:mstrmojo.Widget.visibleMarkupMethod,onheightChange:mstrmojo.Widget.heightMarkupMethod,onwidthChange:mstrmojo.Widget.widthMarkupMethod},markupSlots:{scrollboxNode:function M(){return this.domNode;}},items:undefined,dataHelper:undefined,treeHooks:{},init:function j(p){this._super(p);this.expandedIndices={};this.selectedIndices={};},buildRendering:function a(){var p=this.items,q;if(this.renderOnScroll&&this.items){this.renderIndex=0;p=this.items.slice(this.renderIndex,this.renderBlockSize);}q=p&&p.length;this.itemsHTML=q?b.call(this,p,0,[]):"";this._super();delete this.itemsHTML;},renderOnScroll:false,_cb_scroll:undefined,renderBlockSize:50,renderIndex:0,onscroll:function e(){if(this.renderOnScroll){var r=1,u=this.domNode,t=u.clientHeight,p=(this.renderIndex+1)*this.renderBlockSize;if(p>=this.items.length){return ;}if(Math.ceil(t+u.scrollTop)+r>=u.scrollHeight){this.renderIndex++;var q=this.items.slice(p,p+this.renderBlockSize);this.domNode.innerHTML+=b.call(this,q,0,[]);}}},postBuildRendering:function N(){if(!this._cb_scroll){var q=this.id;this._cb_scroll=function p(){var r=mstrmojo.all[q];r.onscroll();};}mstrmojo.dom.attachEvent(this.scrollboxNode,"scroll",this._cb_scroll);if(this._super){this._super();}},getItemMarkup:function(){return'<{@tag} class="{@cls}" style="{@style}">{@n}</{@tag}>';},getItemProps:function V(q,r,p){return{tag:"div",cls:"item ",n:q.n||"",style:"",idx:p};},itemRenderer:{render:function(q,t,p,r){q._renderIdx=p;q._renderLvl=t;return k.apply(r.getItemMarkup(q,t,p),r.getItemProps(q,t,p));},select:function f(q,r,u,p,t){K("select",q,r,u,p,t);},unselect:function G(q,r,u,p,t){K("unselect",q,r,u,p,t);},expand:function B(q,r,u,p,t){U("expand",q,r,u,p,t);},collapse:function O(q,r,u,p,t){U("collapse",q,r,u,p,t);}},_set_items:function Q(q,t){var r=this.items;this.items=t;if(r!==t){var p=this.hasRendered;if(p){this.unrender(false);}if(p){this.render();}return true;}return false;},getTreeItem:function C(p){if(p!==null){return L(this.items,p.split(g));}},getLeafNode:function D(q){var p=this.domNode.children[0].children;if((q>=0)&&(q<p.length)){return p[q];}},addChild:function J(t,q){var w=this,p=w.getTreeItem(t).items,r=t.split(g);r.push(p.length);if(this.hasRendered){var u=this.domNode.getElementsByTagName(c);S.forEach(u,function(z){if(z.getAttribute(m)===t){var x=q[0];var AA=document.createElement("div");AA.innerHTML=F.call(w,x,parseInt(z.getAttribute(n),10)+1,r.join(g),b.call(w,x.items,parseInt(z.getAttribute(n),10)+2,r));z.lastChild.appendChild(AA.firstChild);p.push(x);return false;}return true;});}},updateChild:function h(q,p){var t=this;P.copy(p,t.getTreeItem(q));if(this.hasRendered){var r=this.domNode.getElementsByTagName(c);S.forEach(r,function(u){if(u.getAttribute(m)===q){var w=parseInt(u.getAttribute(n),10);u.innerHTML=t.itemRenderer.render(p,w,q,t)+b.call(t,p.items,w+1,q.split(g));return false;}return true;});}},toggleChildSelection:function l(q,p){var r=this.domNode.getElementsByTagName(c);S.forEach(r,function(t){if(t.getAttribute(m)===q){A.toggleClass(t,W,p);this.selectedIndices[q]=p;return false;}return true;},this);},removeChild:function E(r){var q=r.split(g),u=q.length,t=q[u-1],p=this;if(u>1){q=q.splice(0,u-1);p=this.getTreeItem(q.join(g));p.items.splice(t,1);this.updateChild(p._renderIdx,p);}else{this.items.splice(t,1);this.refresh();}},getItemWithPropName:function Z(r,w,z){var q=S.find(r,w,z);var t,u=[];if(q!==-1){u.push(r[q]);}for(t=0;t<r.length;t++){var p=r[t].items;if(p&&p.length){var x=this.getItemWithPropName(p,w,z);if(x&&x.length){u=u.concat(x);}}}return u;},onclick:function Y(x){try{var t=x.target||I.eventTarget(x.hWin,x.e),q=t.tagName.toLowerCase(),AB=I.findAncestorByAttr(t,m,true,this.domNode),p=AB&&AB.node.getAttribute(n),w=AB&&AB.value;if(q===o){return ;}if(w!==null&&!isNaN(parseInt(p,10))){var r={sel:{indicesName:"selected",enabledFn:"select",disabledFn:"unselect"},ex:{indicesName:"expanded",enabledFn:"expand",disabledFn:"collapse"}}[(q!==c)?"sel":"ex"];var z=this[r.indicesName+"Indices"],AA=z[w];if(AA){delete z[w];}else{z[w]=true;}this.itemRenderer[AA?r.disabledFn:r.enabledFn](AB.node,this.getTreeItem(w),p,w,this);}}catch(u){mstrApp.onerror(u);}}});}());(function(){mstrmojo.requiresCls("mstrmojo.dom","mstrmojo.css","mstrmojo.string","mstrmojo.Widget");var J=["(",")","{","}","-","+","*","/","<",">","=","|","~",","," ","\t","\n",";",'"'],F=null;function D(O){if(!F){F={};var N,M;for(N=0,M=J.length;N<M;N++){F[J[N]]=true;}}return F[O];}mstrmojo.qb.FFsqlToken=mstrmojo.declare(mstrmojo.Widget,null,{scriptClass:"mstrmojo.qb.FFsqlToken",data:null,markupString:'<span id={@id} class="mstrmojo-token {@cssClass}"></span>',active:false,dropZone:true,allowDrop:function H(M){return this.dropZone;},ondrop:function(M){mstrmojo.all.FFsql.ondrop(M);},markupMethods:{ondataChange:function(){var M=this.data;if(M.v===","){this.domNode.innerHTML=mstrmojo.string.encodeHtmlString(String(M.v));}else{if(M.v=="\n"){this.domNode.innerHTML="<br>";}else{this.domNode.innerHTML=mstrmojo.string.encodeHtmlString(String(M.v));}}mstrmojo.css.toggleClass(this.domNode,["mstr"],this.isMstrO());mstrmojo.css.toggleClass(this.domNode,["sql"],this.isSql());mstrmojo.css.toggleClass(this.domNode,["invalid"],M.sta===-1);},onactiveChange:function(){mstrmojo.css.toggleClass(this.domNode,["active"],this.active);if(!this.active){var N=mstrmojo.all.FFsql;if(!this.isMstrO()&&!this.isDelimiter()){var M=N.candidates.items,P=this.data,O=P.v.toLowerCase();mstrmojo.array.forEach(M,function(R){if(O===R.n.toLowerCase()){P.oi=R;return false;}});}mstrmojo.css.toggleClass(this.domNode,["mstr"],this.isMstrO());var Q=this.isOutOfBracket(N.items,this.data.did);mstrmojo.css.toggleClass(this.domNode,["sql"],this.isSql()&&Q);}}},isOutOfBracket:function(Q,V){var M=Q.map(function(X){return X.v;}),R=Q.map(function(X){return X.did;}),O=R.indexOf(V),P=M.slice(0,O+1),W=P.join(""),S=W.split("[").length-1,N=W.split("]").length-1,U=S<=N;return U;},isMstrO:function I(){var M=this.data;return(!!M.oi&&M.oi.sta!==2)||!!M.rfd;},isSql:function L(){return this.data.oi&&this.data.oi.sta===100;},length:function B(){return this.data.v.length;},isDelimiter:function A(){return this.data.isDelimiter||(this.length()===1&&D(this.data.v));},split2Tokens:function E(Q,N){var P=this.data,O=P&&P.v,R=O.substring(0,Q),M=O.substring(Q);return[{v:R,isNew:true,did:P.did},{v:M,isNew:true,did:N}];},mergeTo:function C(N){var P=this.data,O=P&&P.v,M=N.data.v;return{v:O+M,isNew:true};},setItemInfo:function G(M){var N=this.data;N.v=M.n;N.oi=M;N.sta=1;N.isNew=true;this.set("data",N);this.paint();},spliceContent:function K(S,Q,N){var R=this.data,P=R&&R.v,U=P.substring(0,S);if(N&&N!=="'"&&N.charAt(0)==="'"){N=N.substr(1);}Q=(Q===null||Q===undefined)?(P.length-S):Q;var M=P.substring(S+Q),O=U+(N||"")+M;R.v=O;R.isNew=true;R.sta=1;delete R.oi;this.set("data",R);this.paint();}});mstrmojo.qb.FFsqlToken.isDelimiter=D;})();(function(){mstrmojo.requiresCls("mstrmojo.Widget","mstrmojo.dom");var B="mstrmojo-Image";mstrmojo.Image=mstrmojo.declare(mstrmojo.Widget,null,{scriptClass:"mstrmojo.Image",markupString:'<div id="{@id}" class="'+B+' {@cssClass}" style="{@cssText}" mstrAttach:click><image class="{@imgCssClass}" src="{@src}" mstrAttach:load /></div>',markupSlots:{imgNode:function(){return this.domNode.firstChild;}},markupMethods:{onsrcChange:function(){var C=this.imgNode;if(C){C.src=this.src||"../javascript/mojo/css/images/1ptrans.gif";}},oncssClassChange:function(){var C=this.domNode;if(C){C.className=this.cssClass||B;}},onvisibleChange:mstrmojo.Widget.visibleMarkupMethod},src:"",getImageSize:function A(){var C=this.imgNode;return{w:C.clientWidth,h:C.clientHeight};}});mstrmojo.Image.baseCssClass=B;}());(function(){mstrmojo.requiresCls("mstrmojo.array","mstrmojo.dom","mstrmojo.Widget","mstrmojo._ListSelections");var E=mstrmojo.dom;mstrmojo.ListBase=mstrmojo.declare(mstrmojo.Widget,[mstrmojo._ListSelections],{scriptClass:"mstrmojo.ListBase",selectionPolicy:null,itemRenderer:null,icnCssText:"",icnCss:"",markupString:'<div id="{@id}" tstid="{@tstid}" class="mstrmojo-ListBase {@cssClass}" style="{@cssText}" mstrAttach:click,dblclick,mousedown,mouseover,mouseout,contextmenu><div class="{@icnCss}" style="{@icnCssText}">{@itemsHtml}</div></div>',markupSlots:{itemsContainerNode:function G(){return this.domNode.firstChild;},scrollboxNode:function A(){return this.domNode;}},markupMethods:{onvisibleChange:mstrmojo.Widget.visibleMarkupMethod,onheightChange:mstrmojo.Widget.heightMarkupMethod,onwidthChange:mstrmojo.Widget.widthMarkupMethod},autoHide:false,itemsContainerNode:null,_markupPrefix:null,_markupSuffix:null,_itemPrefix:null,_itemSuffix:null,init:function J(K){this._super(K);if(this.autoHide){this.visible=!!(this.items&&this.items.length);}},buildRendering:function D(){this.itemsHtml="";var K=(this.renderOnScroll?this.items&&((this.renderIndex+1)*this.renderBlockSize):this.items&&this.items.length);if(K){this.itemsHtml=this._buildItemsMarkup(0,K-1,this._markupPrefix&&this._markupPrefix(),this._markupSuffix&&this._markupSuffix(),this._itemPrefix&&this._itemPrefix(),this._itemSuffix&&this._itemSuffix()).join("");}this._super();delete this.itemsHtml;this.addSlots({itemsNode:this.itemsContainerNode.firstChild});},_buildItemsMarkup:function B(K,N,V,L,W,M){var X=[],Q=0;X[Q++]=V||"";var P=this.itemRenderer,U=P&&P.render;if(U&&typeof U==="function"){var R=this.items,S=Math.min(N+1,((R&&R.length)||0)),O;for(O=K;O<S;O++){X[Q++]=W||"";X[Q++]=U(R[O],O,this);X[Q++]=M||"";}}X[Q+1]=L||"";return X;},onselectionChange:function H(X){if(!X){return ;}var S=this.itemRenderer;if(!S){return ;}var V=this.items;if(X.added&&X.added.length>0&&V.length>0&&!mstrmojo.array.some(X.added,function(a){return !V[a]||!V[a].dsbld;})){return ;}var O=S.unselect,R=this.items||[],Y=X.removed,N,M,L,P,Z;if(O&&Y){for(P=0,Z=Y.length;P<Z;P++){N=Y[P];if(typeof (N)==="object"){M=(N.idx==0)?0:N.positions;N=N.idx;}else{M=N;}L=this._getItemNode(M);if(L){O(L,R[N],M,this);}}}var K=S.select,W=X.added,Q,U;if(K&&W){for(Q=0,U=W.length;Q<U;Q++){N=W[Q];if(typeof (N)==="object"){M=(N.idx==0)?0:N.positions;N=N.idx;}else{M=N;}L=this._getItemNode(M);if(L){K(L,R[N],M,this);}}}if(this.onchange){this.onchange({added:X.added,removed:X.removed});}},_set_items:function C(N,K){this.renderIndex=0;if(this.autoHide){this.set("visible",!!(K&&K.length));}var M=this.items;this.items=K;if(M!==K){var L=this.hasRendered;if(L){this.unrender(false);}this.clearSelect();if(L){this.render();}return true;}return false;},onItemContextMenu:mstrmojo.emptyFn,oncontextmenu:function F(K){E.preventDefault(window,K.e);var M=K.getTarget(),L=this.getItemFromTarget&&this.getItemFromTarget(M);if(L){if(this.onItemContextMenu(L,K)){K.cancel();}}},_getItemNode:function I(K){var L=this.itemsContainerNode;return(L&&L.childNodes[K])||null;},renderOnScroll:false});}());(function(){mstrmojo.requiresCls("mstrmojo.Widget","mstrmojo.string");var B=mstrmojo.string;mstrmojo.Label=mstrmojo.declare(mstrmojo.Widget,null,{scriptClass:"mstrmojo.Label",allowHTML:false,text:"",title:"",markupString:'<div id="{@id}" class="mstrmojo-Label {@cssClass}" style="{@cssText}" title="{@title} "mstrAttach:click></div>',markupMethods:{ontitleChange:function(){this.domNode.title=this.title;},ontextChange:function(){var C=this.text;C=B.isEmpty(C)?"":C.toString();this.domNode.innerHTML=this.allowHTML?C:B.encodeHtmlString(B.decodeHtmlString(C),true);},oncssTextChange:mstrmojo.Widget.cssTextMarkupMethod,onvisibleChange:mstrmojo.Widget.visibleMarkupMethod,onenabledChange:mstrmojo.Widget.enabledMarkupMethod},autoHide:false,_set_text:function A(E,C){if(this.autoHide){this.set("visible",(C!==null)&&(C!=="")&&(C!==undefined));}var D=this.text;this.text=C;return(D!==C);}});}());(function(){mstrmojo.requiresCls("mstrmojo.dom","mstrmojo.css","mstrmojo.Widget");var B=mstrmojo.dom;mstrmojo.InlineEditBox=mstrmojo.declare(mstrmojo.Widget,null,{scriptClass:"mstrmojo.InlineEditBox",text:null,editMode:false,allowEdit:true,okSave:false,allowHighlight:false,emptyHint:"Enter your text here.",markupString:'<div id="{@id}" class="mstrmojo-InlineEditBox {@cssClass}" style="{@cssText}" mstrAttach:click><div class="mstrmojo-InlineEditBox-text"></div><div class="mstrmojo-InlineEditBox-edit"><input type="text" class="mstrmojo-InlineEditBox-input" mstrAttach:keyup/><img class="mstrmojo-InlineEditBox-ok" src="../images/1ptrans.gif" title="Save"/><img class="mstrmojo-InlineEditBox-cancel" src="../images/1ptrans.gif" title="Cancel"/></div></div>',markupSlots:{textNode:function(){return this.domNode.firstChild;},editNode:function(){return this.domNode.lastChild;},inputNode:function(){return this.domNode.lastChild.firstChild;},okNode:function(){return this.domNode.lastChild.childNodes[1];},cancelNode:function(){return this.domNode.lastChild.lastChild;}},markupMethods:{ontextChange:function(){var C=this.text||this.emptyHint||"";this.textNode.innerHTML=this.allowHighlight?C:mstrmojo.string.encodeHtmlString(C);},oneditModeChange:function(){var H=this.editMode,E=this.domNode,D=this.textNode,G=this.editNode;mstrmojo.css.toggleClass(E,["edit"],H);if(H){D.style.display="none";G.style.display="block";D=this.inputNode;var F=D.style;D.value=this.text||"";F.width=(E.clientWidth-(this.okSave?(this.okNode.offsetWidth+this.cancelNode.offsetWidth):0))+"px";F.height=E.clientHeight+"px";D.focus();if(D.createTextRange){var I=D.createTextRange(),C=D.value.length;I.move("character",C);I.select();}}else{D.style.display="block";G.style.display="none";}},onokSaveChange:function(){var C=this.okSave?"inline":"none";this.okNode.style.display=C;this.cancelNode.style.display=C;},onallowEditChange:function(){mstrmojo.css.toggleClass(this.domNode,["disable"],!this.allowEdit);}},onvisibleChange:function A(){if(this.domNode){this.domNode.style.display=(this.visible?"block":"none");}},preclick:function(C){var E=C.e,D=B.eventTarget(C.hWin,E);if(D===this.okNode){this.save();}else{if(D===this.cancelNode){this.cancel();}else{if(this.editMode!==this.allowEdit){this.set("editMode",this.allowEdit);}}}},prekeyup:function(C){var E=C.e,D=E.keyCode||E.charCode;if(D===mstrmojo.Enum_Keys.ENTER){this.save();}else{if(D===mstrmojo.Enum_Keys.ESCAPE){this.cancel();}}},_attachEvents:function(){var C=this;if(this.editMode){if(!this._save_handler){this._save_handler=function(){var D=B.eventTarget(self,arguments[0]);if(!B.contains(C.domNode,D,true,document.body)){C.save();}};}B.attachEvent(document.body,"mousedown",this._save_handler);}else{if(this._save_handler){B.detachEvent(document.body,"mousedown",this._save_handler);}}},postBuildRendering:function(){if(this._super){this._super();}this._em_sub=this.attachEventListener("editModeChange",this.id,"_attachEvents");},destroy:function(){this.detachEventListener(this._em_sub);if(this._super){this._super();}},save:function(){this.set("text",this.inputNode.value);this.set("editMode",false);if(this.onSave){this.onSave();}},cancel:function(){this.set("editMode",false);if(this.onCancel){this.onCancel();}}});}());(function(){mstrmojo.requiresCls("mstrmojo.Widget","mstrmojo.css","mstrmojo.string");function C(H,D,E){var K=[];var G=H.optionRenderer,I=G&&G.render;if(I&&typeof I==="function"){var L=H.options,J=Math.min(E,((L&&L.length)||0)),F;for(F=D;F<J;F++){K.push(I(L[F],F,H));}}return K.join("");}mstrmojo.DropDownList=mstrmojo.declare(mstrmojo.Widget,null,{scriptClass:"mstrmojo.DropDownList",title:"",selectCssClass:"",tooltip:"",cssDisplay:"inline",value:"",unset:false,options:null,optionValueField:"v",optionNameField:"n",idx:-1,renderedOptions:"",markupString:'<span id="{@id}"  class="mstrmojo-DropDownList {@cssClass}">{@en@title}<select id="{@id}_select" class="mstrmojo-DropDownList-select {@selectCssClass}"  style="{@cssText}" title="{@tooltip}"onchange="mstrmojo.all[\'{@id}\'].set(\'selected\', this.options[this.selectedIndex].value);">{@renderedOptions}</select><div class = "strikeoutContainer"></div></span>',markupSlots:{selectNode:function(){return this.domNode.getElementsByTagName("select")[0];}},markupMethods:{onvisibleChange:mstrmojo.Widget.visibleMarkupMethod,onidxChange:function(){var D=this.domNode.getElementsByTagName("select");if(D&&D.length){D[0].selectedIndex=this.idx;}},onvalueChange:function(){var I=this.selectNode,G=I.options,F=this.value,E,H;for(H=0;H<G.length;H++){var D=G[H].value.toString()===F;if(D){E=H;if(F!==""){mstrmojo.css.toggleClass(G[H],"selected",D);}break;}}if(I.length>0&&E>0&&this.unset){if(this.options[0].v==="-1"){I.remove(0);E--;}this.unset=false;}this.set("idx",E);},onwidthChange:function(){var D=this.width;if(D>=0){this.selectNode.style.width=D+"px";}}},_set_selected:function(G,D){var E=this.selectNode,F=this[G]!==D;this[G]=D;if(E){this.set("value",D);}return F;},preBuildRendering:function A(){var F=this;if(F.unset){F.idx=0;}var E=F.options,D=(E&&E.length)||0;if(D){F.renderedOptions=C(F,0,D);}return this._super();},optionRenderer:{render:function(E,D,F){return mstrmojo.string.apply(F.getOptionMarkup(E),F.getOptionProps(E,D));}},getOptionMarkup:function(D){return'<option value="{@en@v}" class="{@cls}" style="{@style}" {@sel}>{@en@n}</option>';},getOptionProps:function B(F,D){var G=this,H=F[G.optionValueField],E=D===parseInt(G.idx,10);G.selected=G.value=E?H.toString():G.value;return{cls:E?"selected":"",v:H===undefined?"":H,n:F[G.optionNameField]||"",style:"",sel:E?"selected":""};}});}());(function(){mstrmojo.requiresCls("mstrmojo.Widget","mstrmojo.hash");function A(H,E,G,F){var D=mstrmojo.hash.copy(F,{props:{left:{isStyle:true,start:H,stop:E,suffix:"px",ease:mstrmojo.ease.linear}},duration:G});(new mstrmojo.fx.AnimateProp(D)).play();}function B(K,N,G,L){var I=K.domNode,M=I.offsetWidth,D=K.scrollableIncFetch;var E=K.hasAnimation&&(!(/Firefox[\/\s](\d+\.\d+)/.test(navigator.userAgent))||Number(RegExp.$1)>3.5),J=L?1:-1,F=parseInt(M,10)*J,H=E?500:0;A(0,-F,H,{target:G,duration:H,preStart:function(){this.target.style.overflowY="hidden";},onEnd:function(){this.target.style.display="none";}});A(F,0,H,{target:N,preStart:function(){this.target.style.display="block";this.target.style.overflowY=(D?"visible":"auto");}});if(K.waiting){A(0,-F,H,{widget:K,slot:"loaderNode",onEnd:function(){this.widget.waiting=false;}});}}var C=function(D){var E=D.currentPage;if(E===D.p1Node){E=D.p2Node;}else{E=D.p1Node;}D.currentPage=E;};mstrmojo.Booklet=mstrmojo.declare(mstrmojo.Widget,null,{scriptClass:"mstrmojo.Booklet",pageClass:"mstrmojo-BookletPage",markupString:'<div id="{@id}" class="mstrmojo-Booklet {@cssClass}" style="{@cssText}"><div id="{@id}_p1" class="mstrmojo-BookletPage" ></div><div id="{@id}_p2" class="mstrmojo-BookletPage" style="left:-100%;"></div><div id="{@id}_ldr" class="mstrmojo-BookletLoader" ></div></div>',markupSlots:{containerNode:function(){return this.domNode;},p1Node:function(){return this.domNode.firstChild;},p2Node:function(){return this.domNode.childNodes[1];},loaderNode:function(){return this.domNode.childNodes[2];}},markupMethods:{onnextChange:function(){var G=this.next;if(!G){return ;}var D=this.currentPage,F=this.p1Node,E=this.currentPage=(D==F)?this.p2Node:F;if(!(G instanceof mstrmojo.Obj)){G=this.next=mstrmojo.insert(G);}if(!G.hasRendered){G.placeholder=E.appendChild(document.createElement("span"));G.render();}else{if(E.firstChild){E.replaceChild(G.domNode,E.firstChild);}else{E.appendChild(G.domNode);}}this.set("waiting",false);if(E&&D){B(this,E,D,this.turnDirFwd);}else{if(this.scrollableIncFetch){E.style.overflowY="visible";}}},onwaitingChange:function(D){this.loaderNode.style.left=(this.waiting)?0:"-100%";},onheightChange:function(D){if(this.height){this.domNode.style.height=this.height;}},onwidthChange:function(D){if(this.width){this.domNode.style.width=this.width;}}},enabled:true,waiting:false,next:null,currentPage:null,turnDirFwd:true,hasAnimation:true,scrollableIncFetch:false,FORWARD:true,REVERSE:false,turnFwd:function(D){this.turn(D,this.FORWARD);},turnBack:function(D){this.turn(D,this.REVERSE);},turn:function(D,E){this.set("turnDirFwd",E);this.set("next",D);}});})();(function(){mstrmojo.requiresCls("mstrmojo.ListMapper");var C=1;mstrmojo._hasWidgetListMapper={buildItemWrappers:function A(H,G,F,E,J,I){E.first=J;E.last=I;return this._super(H,G,F,E,0,0);},postBuildRendering:function B(K,I,H,G,F){var J=F.first;if(J){this.fillItemWrappers(K,I,H,G,F,0,J);}if(F.last){var E=I&&I.length||0,L=Math.max(Math.max(0,E-F.last),J);this.fillItemWrappers(K,I,H,G,F,L,E);}if(this._super){this._super(K,I,H,G,F);}},fillItemWrappers:function D(F,N,K,R,M,E,I,Q){var L=(N&&N.length)||0,P=this.wrapperNodes(F),S=M.itemStatus;for(var J=E,O=Math.min(I+1,L),H=0;J<O;J++){if(S[J]!==C){var G=K.build(R,M,N[J],J);if(G){G.placeholder=P[J].firstChild;G.render();}H++;if(H===Q){break;}}}return H;},onchange:null};mstrmojo.WidgetListMapper=mstrmojo.provide("mstrmojo.WidgetListMapper",mstrmojo.mixin(mstrmojo._hasWidgetListMapper,mstrmojo.hash.copy(mstrmojo.ListMapper)));mstrmojo.WidgetListMapper.RENDERED=C;mstrmojo.requiresCls("mstrmojo.ListMapperHoriz");mstrmojo.WidgetListMapperHoriz=mstrmojo.provide("mstrmojo.WidgetListMapperHoriz",mstrmojo.mixin(mstrmojo._hasWidgetListMapper,mstrmojo.hash.copy(mstrmojo.ListMapperHoriz)));})();(function(){mstrmojo.requiresCls("mstrmojo.ListMapper");mstrmojo.ListMapperTable=mstrmojo.provide("mstrmojo.ListMapperTable",mstrmojo.hash.copy({markupPrefix:'<table class="mstrmojo-itemwrap-table">',markupSuffix:"</table>",itemWrapperPrefix:function(E){return'<tbody class="'+this.getWrapperCss(E)+'">';},itemWrapperPrefill:"<tr><td>&nbsp;</td></tr>",itemWrapperSuffix:"</tbody>",wrapperNodes:function D(E){return this.wrapperParentNode(E).tBodies;},wrapperParentNode:function C(E){return E.getElementsByTagName("table")[0];},createWrapperNode:function B(E){var F=E.ownerDocument,G=F.createElement("tbody");return G;},findIndex:function A(G,J,I){if(J&&I){var F=G.domNode,E=this.wrapperParentNode(J),H=I.parentNode;while(H){if(H===E){return mstrmojo.array.findBin(this.wrapperNodes(J),I,"offsetTop",G.items&&G.items.length);}else{if(H===F){break;}}I=H;H=I.parentNode;}}return -1;}},mstrmojo.hash.copy(mstrmojo.ListMapper)));mstrmojo.requiresCls("mstrmojo.WidgetListMapper");mstrmojo.WidgetListMapperTable=mstrmojo.provide("mstrmojo.WidgetListMapperTable",mstrmojo.mixin(mstrmojo._hasWidgetListMapper,mstrmojo.hash.copy(mstrmojo.ListMapperTable)));})();(function(){mstrmojo.requiresCls("mstrmojo.Container","mstrmojo.InlineEditBox","mstrmojo.Button");var B=": ";mstrmojo.qb.thirdParty.InlineEditBox=mstrmojo.declare(mstrmojo.InlineEditBox,null,{postCreate:function A(){if(this._super){this._super();}this.markupMethods=mstrmojo.hash.copy(this.markupMethods);this.markupMethods.oneditModeChange=function(){var I=this.editMode,F=this.domNode,E=this.textNode,H=this.editNode;mstrmojo.css.toggleClass(F,["edit"],I);if(I){E.style.display="none";H.style.display="block";E=this.inputNode;var G=E.style;E.value=this.parent.url||"";G.width=(F.clientWidth-(this.okSave?(this.okNode.offsetWidth+this.cancelNode.offsetWidth):0))+"px";G.height=F.clientHeight+"px";E.focus();if(E.createTextRange){var J=E.createTextRange(),D=E.value.length;J.move("character",D);J.select();}}else{E.style.display="block";H.style.display="none";}};},save:function(){this.set("text",this.parent.dbRoleName+B+this.inputNode.value);this.set("editMode",false);if(this.onSave){this.onSave();}},rename:function(){if(this.editMode!==this.allowEdit){this.set("editMode",this.allowEdit);}},onSave:function(){this.parent.set("url",this.inputNode.value);},bindings:{text:function(){return this.parent.dbRoleName+B+this.parent.url;}}});mstrmojo.qb.thirdParty.UrlSourceItem=mstrmojo.declare(mstrmojo.Container,null,{scriptClass:"mstrmojo.qb.thirdParty.UrlSourceItem",markupString:"<div class='qb-bi-source-url-list' mstrAttach:click ><div></div><div></div><div></div></div>",markupSlots:{containerNode:function(){return this.domNode;},iconNode:function(){return this.domNode.children[0];},contentNode:function(){return this.domNode.children[1];},deleteNode:function(){return this.domNode.children[2];}},allowEdit:true,url:"",dbRoleID:"",dbRoleName:"",children:[{slot:"iconNode",alias:"icon",cssClass:"mstrmojo-di-url-icon",scriptClass:"mstrmojo.Label"},{slot:"contentNode",alias:"text",cssClass:"urlItem-text-div",scriptClass:"mstrmojo.qb.thirdParty.InlineEditBox"},{scriptClass:"mstrmojo.Button",slot:"deleteNode",cssClass:"mstrmojo-url-delete-button",innerIconClass:"close-button",onclick:function(){this.parent.deleteURL();}}],deleteURL:function C(){this.parent.deleteURL(this);}});}());(function(){mstrmojo.requiresCls("mstrmojo.Label","mstrmojo._HasEditableText","mstrmojo.css","mstrmojo._CanHandleTwoClicks","mstrmojo.Label","mstrmojo.Widget");var C=mstrmojo.css,A=mstrmojo.Label.prototype.markupMethods;mstrmojo.EditableLabel=mstrmojo.declare(mstrmojo.Label,[mstrmojo._CanHandleTwoClicks,mstrmojo._HasEditableText],{scriptClass:"mstrmojo.EditableLabel",autoApplyDelay:-1,markupString:'<div id="{@id}" class="mstrmojo-EditableLabel {@cssClass}" title="{@title}" contenteditable="{@isEditing}" style="{@cssText}" mstrAttach:click,mousedown,blur,keydown,keyup></div>',markupMethods:mstrmojo.hash.copy({onwidthChange:function(){mstrmojo.Widget.widthMarkupMethod.call(this);},ontextChange:function(){if(A.ontextChange){A.ontextChange.call(this);}this.widgetResized();},onvisibleChange:function(){if(A.onvisibleChange){A.onvisibleChange.call(this);}if(this.visible){this.widgetResized();}}},mstrmojo.hash.copy(A)),onkeyup:function E(F){this._super(F);if(this._autoApplyTimer){window.clearTimeout(this._autoApplyTimer);}if(this.autoApplyDelay!==-1){var G=this;this._autoApplyTimer=window.setTimeout(function(){G.set("isEditing",false);},this.autoApplyDelay);}},postBuildRendering:function D(){if(this._super){this._super();}this.widgetResized();},selectable:true});mstrmojo._HasMarkup.addMarkupMethods(mstrmojo.EditableLabel,{onselectableChange:function B(){var G=this[this.editableSlot],F=!!this.selectable;G.selectable=F;G.setAttribute("unselectable",!F?"on":"off");C.toggleClass(G,"unselectable",!F);}});}());(function(){mstrmojo.requiresCls("mstrmojo.Label","mstrmojo.css","mstrmojo.hash");mstrmojo.TristateCheckBox=mstrmojo.declare(mstrmojo.Label,null,{scriptClass:"mstrmojo.TristateCheckBox",grayed:true,checked:true,cssClass:"tristate",onclick:function(){if(this.grayed){this.set("grayed",!this.grayed);}else{this.set("checked",!this.checked);}},markupMethods:mstrmojo.hash.copy({oncheckedChange:function(){mstrmojo.css.toggleClass(this.domNode,"checked",this.checked);},ongrayedChange:function(){mstrmojo.css.toggleClass(this.domNode,"grayed",this.grayed);},onenabledChange:function(){mstrmojo.css.toggleClass(this.domNode,"disabled",!this.enabled);}},mstrmojo.hash.copy(mstrmojo.Label.prototype.markupMethods))});})();(function(){mstrmojo.requiresCls("mstrmojo.ListBase","mstrmojo._IsList");mstrmojo.ui.List=mstrmojo.declare(mstrmojo.ListBase,[mstrmojo._IsList],{scriptClass:"mstrmojo.ui.List",postselectionChange:function C(D){var G=D.added||[],F=G.length,I=D.removed||[],E=I.length;if(E){this.selectionRemoved({added:G,removed:I,isReselect:false});}if(F){var H=function(J){return[].concat(J).sort().join(",");};this.selectionAdded({added:G,removed:I,isReselect:H(G)===H(I)});}},selectionAdded:function A(D){},selectionRemoved:function B(D){}});mstrmojo.ui.List.SelectionChangeEvtType=null;}());(function(){mstrmojo.requiresCls("mstrmojo.string");mstrmojo.DivItemRenderer={render:function(E,C,F){var D=mstrmojo.string.encodeHtmlString((F.getItemName?F.getItemName(E,C):(F.itemDisplayField&&E[F.itemDisplayField])));return'<div mstridx="'+C+'" class="'+F.itemCssClass+(F.selectedIndices[C]?" "+F.itemSelectedCssClass:"")+(E.cssClass?" "+E.cssClass:"")+'" style="'+F.itemCssText+'">'+D+"</div>";},select:function(C){if(C&&C.className){C.className+=" selected";}},unselect:function(C){if(C&&C.className){C.className=C.className.replace(/selected/g,"");}},rowHeight:21};mstrmojo._RendersItemDivs={tableCssClass:"mstrmojo-ListBox-table",tableCssText:"",rowCssClass:"",rowCssText:"",cellCssClass:"mstrmojo-ListBox-cell",cellCssText:"",itemCssClass:"mstrmojo-ListBox-item",itemSelectedCssClass:"selected",itemDisplayField:"n",itemRenderer:mstrmojo.DivItemRenderer,rangeSelected:false,_findMatch:function(C,D){return mstrmojo.dom.findAncestorByAttr(mstrmojo.dom.eventTarget(C,D),"mstridx",true,this.itemsNode);},premousedown:function A(C){if(mstrmojo.dom.shiftKey(C.hWin,C.e)){mstrmojo.dom.preventDefault(C.hWin,C.e);}},preclick:function B(K){var G=K.hWin,H=K.e,F=this._findMatch(G,H);if(F){var J=parseInt(F.value,10),I=mstrmojo.dom,C=I.ctrlKey(G,H),D=I.shiftKey(G,H);if(C||D){I.clearBrowserHighlights(G);}if(this.multiSelect&&(this.selectionPolicy==="toggle"||C)){var E=this.rangeSelected||this.selectedIndex===-1;this.toggleSelect(J);if(E&&J<this.items.length&&this.selectedIndices[J+1]){J++;}this.selectedIndex=J;this.rangeSelected=false;}else{if(this.multiSelect&&D){this.rangeSelected=true;this.rangeSelect(J);}else{this.singleSelect(J);this.rangeSelected=false;}}}}};mstrmojo.requiresCls("mstrmojo.ListBase","mstrmojo._RendersItemDivs");mstrmojo.ListBoxBase=mstrmojo.declare(mstrmojo.ListBase,[mstrmojo._RendersItemDivs],{scriptClass:"mstrmojo.ListBoxBase",cssClass:"mstrmojo-ListBox",itemCssClass:"mstrmojo-ListBox-item",_markupPrefix:function(){var C=this.itemRenderer;return(C&&C.markupPrefix)||('<table class="'+this.tableCssClass+'" style="'+this.tableCssText+'" cellspacing="0" cellpadding="0"><tbody>');},_markupSuffix:function(){var C=this.itemRenderer;return(C&&C.markupSuffix)||"</tbody></table>";},_itemPrefix:function(){var C=this.itemRenderer;return(C&&C.itemPrefix)||('<tr class="'+this.rowCssClass+'" style="'+this.rowCssText+'"><td class="'+this.cellCssClass+'" style="'+this.cellCssText+'">');},_itemSuffix:function(){var C=this.itemRenderer;return(C&&C.itemSuffix)||"</td></tr>";},_getItemNode:function(C){var H=this.itemsNode,G=this.renderAllItems,F=H&&H.tBodies,E=G?0:Math.floor(C/100),D=G?C:C%100,I=F&&F[E]&&F[E].rows&&F[E].rows[D];return I&&I.cells[0].firstChild;}});}());(function(){mstrmojo.requiresCls("mstrmojo.dom","mstrmojo._IsList","mstrmojo.ListBase");mstrmojo.requiresDescs(505,629);var C=mstrmojo.dom;mstrmojo.qb.mdx.CubeList=mstrmojo.declare(mstrmojo.ListBase,[mstrmojo._IsList],{scriptClass:"mstrmojo.qb.mdx.CubeList",cssClass:"mstrmojo-qb-emma-tablelist",init:function D(G){this._super(G);var I=this,H={},F=H[this.id]={};F.refreshTables=function E(J){I.set("items",J.items);};mstrApp.getRootController().attachDataChangeListeners(H);},getItemMarkup:function(F,E){return'<div class="item {@cls}" idx="{@idx}" style="{@style}"><div class="item-ic"></div><div class="item-n" title="{@n}"> {@n} </div><div class="item-refresh {@isNew}" title="'+mstrmojo.desc(505,"Update")+'"></div><div class="item-del {@isNew}" title="'+mstrmojo.desc(629,"Delete")+'"></div></div>';},getItemProps:function B(F,E){return{cls:"tp"+F.tp,n:F.caption?F.caption:F.n,isNew:F.isNew?"new":"exist",idx:E};},onclick:function A(F){try{var I=F.target||C.eventTarget(F.hWin,F.e),H=C.findAncestorByAttr(I,"idx",true,this.domNode),E=H&&parseInt(H.value,10);if(E!==null&&!isNaN(E)){if(I.className.indexOf("item-del")>-1){mstrApp.getRootController().removeCube(E);}else{if(I.className.indexOf("item-refresh")>-1){mstrApp.getRootController().updateCube(E);}}}}catch(G){mstrApp.onerror(G);}}});}());(function(){mstrmojo.requiresClsP("mstrmojo","ListBase","_IsList");mstrmojo.VisMenuList=mstrmojo.declare(mstrmojo.ListBase,[mstrmojo._IsList],{scriptClass:"mstrmojo.VisMenuList",prevSelection:{},itemField:"v",selectionPolicy:"toggle",multiSelect:false,init:function C(D){this._super(D);},getItemProps:function A(F,D){var E=this._super(F,D);E.tag="a";E.addCls("mstrmojo-ui-Menu-item");return E;},onselectionChange:function B(D){this._super(D);this.parent.data.set("valid",true);}});}());(function(){mstrmojo.requiresCls("mstrmojo.dom","mstrmojo._IsList","mstrmojo.ListBase");var D=mstrmojo.dom,G=mstrmojo.array,C=mstrmojo.warehouse.EnumDataChangeEvents;mstrmojo.qb.es.TableList=mstrmojo.declare(mstrmojo.ListBase,[mstrmojo._IsList],{scriptClass:"mstrmojo.qb.es.TableList",cssClass:"mstrmojo-qb-emma-tablelist",itemMaxWidth:"",onitemMaxWidthChange:function F(I){var H=this.itemsContainerNode,J=H&&H.children,K=I.value;G.forEach(J,function(L){L.children[1].style.maxWidth=K;});},init:function E(K){this._super(K);var M=this,L={},J=L[this.id]={};J.refreshTables=function I(N){M.set("items",N.items);};J[C.DBROLES_DELETE]=function H(N){mstrApp.getRootController().removeDBRoleTables(N.item.did);};mstrApp.getRootController().attachDataChangeListeners(L);},getItemMarkup:function(I,H){return'<div class="item cf {@cls}" idx="{@idx}" style="{@style}"><div class="item-ic"></div><div class="item-n" title="{@en@title}" style="max-width: {@maxWidth}">{@en@n}</div><div class="item-del"></div></div>';},getItemProps:function B(I,H){return{cls:"tp"+I.tp,n:I.n,idx:H,title:[I.n," [",I.dbrn,"]"].join(""),maxWidth:this.itemMaxWidth};},onclick:function A(I){try{var L=I.target||D.eventTarget(I.hWin,I.e),K=D.findAncestorByAttr(L,"idx",true,this.domNode),H=K&&parseInt(K.value,10);if(H!==null&&!isNaN(H)){if(L.className==="item-del"){mstrApp.getRootController().removeTable(H);}}}catch(J){mstrApp.onerror(J);}}});}());(function(){mstrmojo.requiresCls("mstrmojo.ListBase","mstrmojo._IsList");var D=mstrmojo.dom,E=mstrmojo.hash;var A;mstrmojo.SuggestionList=mstrmojo.declare(mstrmojo.ListBase,[mstrmojo._IsList],{scriptClass:"mstrmojo.SuggestionList",itemField:"n",getItemMarkup:function(G,F){if(!A){var H=this.itemField;A=this._super(G).replace('@title}">{@en@n}<',"@en@"+H+'}">{@en@'+H+"}<");}return A;},getItemProps:function C(H,F){var G=this._super(H,F),I=this.itemField;if(!mstrmojo.string.isEmpty(H[I])){G[I]=H[I];}return G;},onclick:function B(F){if(this.disableClick){return false;}var K=this,H=this.parent,J=H.opener,G=D.isMetaKey(F.hWin,F.e);if(G&&!this.multiSelect){this.multiSelect=J.parent.defn.multi;if(this.multiSelect){D.attachOneTimeEvent(document.documentElement,"keyup",function(){var M=K.selectedIndices;if(J){J.suggestionShown=false;if(M&&!E.isEmpty(M)){var L=[];E.forEach(K.selectedIndices,function(O,N){L.push(K.items[N]);});J.handleSuggestionItemSelect(L);}H.close();}K.multiSelect=false;});}}this._super(F);if(!this.multiSelect){J.suggestionShown=false;var I=this.selectedItem;if(I){J.handleSuggestionItemSelect(I);}H.close();}},bindings:{itemField:"this.parent.opener.itemField",items:"this.parent.opener.suggestionItems",disableClick:"this.parent.opener.disableClick"}});}());(function(){mstrmojo.requiresCls("mstrmojo.ListBase2");function B(E){var I=E.ctxtBuilder;if(I){var H=I.itemWidgets,G;for(G=H.length-1;G>-1;G--){var F=H[G];if(F){F.destroy(true);}}}}mstrmojo.WidgetListBase=mstrmojo.declare(mstrmojo.ListBase2,null,{scriptClass:"mstrmojo.WidgetListBase",unrender:function C(G){var I=this.ctxtBuilder;if(I){var H=I.itemWidgets,F;for(F=H.length-1;F>-1;F--){var E=H[F];if(E&&E.hasRendered){E.unrender(true);}}}this._super(G);},refresh:function A(E){B(this);if(this._super){this._super(E);}},destroy:function D(E){B(this);this._super(E);}});})();(function(){mstrmojo.requiresCls("mstrmojo.ListBase2","mstrmojo.ListMapperHoriz","mstrmojo.ListBuilder");mstrmojo.ListHoriz=mstrmojo.declare(mstrmojo.ListBase2,null,{scriptClass:"mstrmojo.ListHoriz",renderOnScroll:true,listMapper:mstrmojo.ListMapperHoriz,listBuilder:mstrmojo.ListBuilder,itemField:"n",itemMarkup:null,itemMarkupFunction:null});})();(function(){mstrmojo.requiresCls("mstrmojo.ListBase2","mstrmojo.ListMapper","mstrmojo.ListBuilder","mstrmojo.ListSelector");mstrmojo.List=mstrmojo.declare(mstrmojo.ListBase2,null,{scriptClass:"mstrmojo.List",renderOnScroll:true,listMapper:mstrmojo.ListMapper,listBuilder:mstrmojo.ListBuilder,listSelector:mstrmojo.ListSelector,itemIdField:"dssid",itemField:"n",itemMarkup:null,itemMarkupFunction:null});})();(function(){mstrmojo.requiresCls("mstrmojo.RadioButton");var C=mstrmojo.array;mstrmojo.warehouse.dbroles.DBRoleSettingRadioButton=mstrmojo.declare(mstrmojo.RadioButton,null,{scriptClass:"mstrmojo.warehouse.dbroles.DBRoleSettingRadioButton",cssClass:"mstrmojo-wh-DBRoleRadioButton",enableChildren:function A(){var G=this.parent,F=this;C.forEach(G.children,function(H){if(H.parentRBAlias&&(H.parentRBAlias===F.alias)){H.set("enabled",F.checked);}});},enabled:true,getValue:function B(){return this.checked;},setValue:function E(F){this.checked=F;this.onclick();},isValid:function D(){return{val:true,msg:""};}});}());(function(){mstrmojo.requiresCls("mstrmojo.ui.Checkbox");var A={ROUND:"round",RECT:""};mstrmojo.ui.ToggleButton=mstrmojo.declare(mstrmojo.ui.Checkbox,null,{scriptClass:"mstrmojo.ui.ToggleButton",markupString:'<div id="{@id}" class="mstrmojo-ui-ToggleButton {@cssClass}" mstrAttach:click><div class="container"><div class="slider {@sliderStyle}"></div></div></div>',sliderStyle:A.ROUND});mstrmojo.ui.ToggleButton.EnumStyle=A;}());(function(){mstrmojo.requiresCls("mstrmojo.ConditionNode","mstrmojo.fe._IsRelationTreeNode","mstrmojo.dom","mstrmojo.css","mstrmojo.expr");mstrmojo.requiresDescs(1994,5893,7931,15671);var A=mstrmojo.dom,B=mstrmojo.css,D=mstrmojo.expr.ET,E=mstrmojo.fe._IsRelationTreeNode.createSetHtml;mstrmojo.fe.ConditionNode=mstrmojo.declare(mstrmojo.ConditionNode,[mstrmojo.fe._IsRelationTreeNode],{scriptClass:"mstrmojo.fe.ConditionNode",emptyText:mstrmojo.desc(5893,"New Condition"),markupString:'<div id="{@id}" class="mstrmojo-cond mstrmojo-ConditionNode {@cssClass}" mstrAttach:mousedown><div class="mstrmojo-onhoverparent mstrmojo-cond-prefix {@cssClass}"><span class="mstrmojo-textset mstrmojo-cond-prefix-text" mstrAttach:click></span><span class="mstrmojo-onhover-in mstrmojo-andor-tools {@cssClass}">{@_prefixAndOrToolsMarkup}</span></div><div class="mstrmojo-onhoverparent mstrmojo-cond-contents {@cssClass}"><span class="mstrmojo-textset mstrmojo-cond-text {@cssClass}" mstrAttach:click></span><span class="mstrmojo-cond-text-postfix {@cssClass}"></span><span class="mstrmojo-rel mstrmojo-cond-popupNode {@cssClass}"></span><span class="mstrmojo-onhover-bl mstrmojo-abs mstrmojo-topright mstrmojo-cond-tools {@cssClass}"><img class="mstrmojo-del" src="../images/1ptrans.gif" tooltip="'+mstrmojo.desc(7931,"Delete condition")+'" onclick="mstrmojo.all[\'{@id}\'].del()" /><img class="mstrmojo-lock" src="../images/lock_view.svg"/></span><span class="mstrmojo-add-cond" mstrAttach:click>'+mstrmojo.desc(1994,"Add Condition")+"</span>"+E+"</div></div>",getPrefixAndOrToolsMarkup:function(){return(E+this._super());},markupSlots:{prefixHoverNode:function(){return this.domNode.firstChild;},prefixNode:function(){return this.domNode.firstChild.firstChild;},prefixAndOrToolsNode:function(){return this.domNode.firstChild.childNodes[1];},condNode:function(){return this.domNode.childNodes[1];},textNode:function(){return this.domNode.childNodes[1].firstChild;},textPostfixNode:function(){return this.domNode.childNodes[1].childNodes[1];},popupNode:function(){return this.domNode.childNodes[1].childNodes[2];},createSetNode:function(){return this.domNode.childNodes[1].lastChild;},createSetOptNode:function(){return this.domNode.firstChild.childNodes[1].firstChild;},addConditionNode:function(){return this.domNode.childNodes[1].childNodes[4];}},markupMethods:mstrmojo.hash.copy({onnoRelationOperatorChange:function(){B.toggleClass(this.prefixHoverNode,["noRelation"],this.noRelationOperator);},onnoRelationChange:function(){B.toggleClass(this.condNode,["noRelation"],this.noRelation);},onnoCreateSetChange:function(){B.toggleClass(this.condNode,["noRelation"],this.noCreateSet);},onlockedChange:function(){B.toggleClass(this.condNode,["locked"],this.locked);}},mstrmojo.hash.copy(mstrmojo.ConditionNode.prototype.markupMethods)),init:function(I){if(this._super){this._super(I);}var K=this.data&&this.data.et;if(K){this.set("noCreateSet",mstrApp.supportAdvFilter?false:(K===D.MQ||K===D.MC));}var G=this.tree.editor;if(G){var F=G.scriptClass==="mstrmojo.fe.FilterEditor";var H=typeof (G.disableElementsBrowsing)==="function"&&G.disableElementsBrowsing();if(F&&H&&K===D.AE){this.set("locked",true);this.set("editable",false);this.set("useRichTooltip",true);var J=this;this.set("updateTooltipConfig",function(){var L=mstrmojo.dom.position(J.domNode);this.richTooltip={content:mstrmojo.desc(15671,"Edit or remove is only available in workstation"),refNode:J.domNode,enableHover:true,cssClass:"vi-regular vi-tooltip-V V-center",posType:mstrmojo.tooltip.POS_BOTTOMCENTER,left:L.w/2,top:-10};});}}},preclick:function C(F){var I=null,H=A.eventTarget(F.hWin,F.e),G=this._super(F);if(A.contains(this.createSetOptNode,H,true)&&!this.noRelationOperator&&!this.noRelation){I="createSetOpt";}else{if(A.contains(this.createSetNode,H,true)&&!this.noRelation){I="createSet";}else{if(A.contains(this.addConditionNode,H,true)){I="addCondition";}}}F.part=I||F.part;return G;},onmouseover:function(){this.toggleGroupBorder(true);},onmouseout:function(){this.toggleGroupBorder(false);}});})();(function(){mstrmojo.requiresCls("mstrmojo.Button");mstrmojo.HTMLButton=mstrmojo.declare(mstrmojo.Button,null,{scriptClass:"mstrmojo.HTMLButton",markupString:'<input id="{@id}" type="button" class="mstrmojo-text mstrmojo-HTMLButton mstrButton {@cssClass} {@iconClass}" title="{@title}" style="{@cssText}" mstrAttach:click />',markupSlots:{inputNode:function(){return this.domNode;}},markupMethods:{onvisibleChange:function(){this.domNode.style.display=this.visible?"inline":"none";},onenabledChange:function(){mstrmojo.css[this.enabled?"removeClass":"addClass"](this.domNode,["disabled"]);},onselectedChange:function(){mstrmojo.css[this.selected?"addClass":"removeClass"](this.domNode,["selected"]);},ontextChange:function(){this.inputNode.value=this.text!=null?this.text:"";},oniconClassChange:function(){this.domNode.className="mstrmojo-text mstrmojo-HTMLButton mstrButton "+this.cssClass+" "+this.iconClass+(this.enabled?"":" disabled");}}});})();(function(){mstrmojo.requiresCls("mstrmojo.Container","mstrmojo.css");var F="",B="row-",E=mstrmojo.css.DISPLAY_TABLE;mstrmojo.Table=mstrmojo.declare(mstrmojo.Container,null,{scriptClass:"mstrmojo.Table",cellCssClass:"",rows:-1,cols:-1,_trows:-1,cellPadding:0,cellSpacing:0,layout:null,markupString:'<table id="{@id}" class="mstrmojo-Table {@cssClass}" style="{@cssText}" cellpadding="{@cellPadding}" cellspacing="{@cellSpacing}">{@tableHtml}</table>',markupSlots:{containerNode:function(){return this.domNode;}},markupMethods:{onvisibleChange:function(){this.domNode.style.display=this.visible?E:"none";}},preBuildRendering:function G(){var I=[],P=this.cellCssClass;if(this.layout){var Q=this._trows=this.layout.length;for(var K=0;K<Q;K++){var H=this.layout[K],R=H.cells,O=R.length,L=[];for(var J=0;J<O;J++){var N=R[J],M="";M+=((N.cssClass||P)?' class="'+(N.cssClass||P)+'"':"");M+=(N.cssText?' style="'+N.cssText+'"':"");M+=(N.rowSpan?' rowspan="'+N.rowSpan+'"':"");M+=(N.colSpan?' colspan="'+N.colSpan+'"':"");L[J]="<td"+M+"></td>";}var S="";S+=(H.cssClass?' class="'+H.cssClass+'"':"");S+=(H.cssText?' style="'+H.cssText+'"':"");I[K]="<tr"+S+">"+L.join("")+"</tr>";}}else{this._trows=this.rows;var M=(P?' class="'+P+'"':""),L=[];for(var K=0;K<this.rows;K++){for(var J=0;J<this.cols;J++){L[J]="<td"+M+"></td>";}I[K]="<tr>"+L.join("")+"</tr>";}}this.tableHtml=I.join("");if(this._super){this._super();}},postBuildRendering:function C(){if(this._trows){var M={},I=this.containerNode.rows,N=I.length;for(var L=0;L<N;L++){var K=I[L].cells,H=K.length;M[B+L]=I[L];for(var J=0;J<H;J++){M[F+L+","+J]=K[J];}}this.addSlots(M);}this._super();},childRenderCheck:function D(I){if(I&&!I.hasRendered){var H=I.slot||this.defaultChildSlot;return !!this[H]||H.match(/^([\d]+),([\d]+)$/);}return false;},on_child_change_rendering:function A(L){var H=(L&&L.src)||L,O=H&&H.domNode;if(O){var V=H.slot;if(!this[V]){var M=V&&V.match(/^([\d]+),([\d]+)$/);if(M){var R=parseInt(M[1],10),W=parseInt(M[2],10),Q=this.containerNode,U=this[(B+R)],N=[];if(!U){var J=Q.rows,S=J&&J.length||0;for(var K=S;K<=R;K++){N[B+K]=Q.insertRow();}U=N[B+R];}var P=U.cells&&U.cells.length||0;for(var K=P;K<=W;K++){var I=U.insertCell(K);N[F+R+","+K]=I;if(this.cellCssClass){I.className=this.cellCssClass;}}this.addSlots(N);}}}this._super(L);}});})();(function(){mstrmojo.requiresCls("mstrmojo.Container","mstrmojo._HasLayout","mstrmojo._HasOwnAvatar","mstrmojo.array","mstrmojo.dom","mstrmojo.hash");var W=mstrmojo.hash,Y=mstrmojo.dom,F="h",S="w",G="100%",L="none",V={HORIZONTAL:0,VERTICAL:1},D=V.HORIZONTAL,B="horizontal",H="vertical",J={firstSplitNode:"300px",resizeHandleNode:"5px",secondSplitNode:G};function Q(){var c=this.config,a=this.orientation,e=(a===D)?S:F,Z=(a===D)?F:S,b="Node",f=this.layoutConfig||{};f.xt=true;f[e]=f[e]||W.copy(J);f[Z]=f[Z]||{firstSplitNode:G,resizeHandleNode:G,secondSplitNode:G};var d=f[e];W.forEach(c,function(h,g){d[g+b]=h.v;});return f;}function I(k){var c=this._wPos,a=(this.orientation===D)?"x":"y",n=k[a]-c[a],e=this.config,m=e.firstSplit,p=e.secondSplit,l=parseInt(m.min,10),b=parseInt(p.min,10),g=(m.v.indexOf("px")>-1),d=parseInt((this.orientation===D)?this.width:this.height,10);if(!g){if(n===d){n=d*(parseInt(m.v,10)/100);}}var h=d-b,Z=Math.floor(Math.min(Math.max(n,l),h));if(this.applyPercentage){var o=Math.round((Z/d)*100),j=(d-parseInt(e.resizeHandle.v,10)-Z),f=Math.round((j/d)*100);if((o+f)<100){f+=(100-(o+f));}m.v=o+"%";p.v=f+"%";}else{m.v=Z+"px";p.v="100%";}this.layoutConfig=Q.call(this,e);this.doLayout();}mstrmojo.ui.Splitter=mstrmojo.declare(mstrmojo.Container,[mstrmojo._HasLayout,mstrmojo._HasOwnAvatar],{scriptClass:"mstrmojo.ui.Splitter",markupString:'<div id="{@id}" class="mstrmojo-Splitter {@orientationCss} {@cssClass}"><div class="mstrmojo-SplitterPanel"></div><div class="mstrmojo-SplitterHandle"></div><div class="mstrmojo-SplitterPanel"></div><div class="mstrmojo-clearingDiv"></div></div>',markupSlots:{firstSplitNode:function C(){return this.domNode.firstChild;},resizeHandleNode:function A(){return this.domNode.children[1];},secondSplitNode:function K(){return this.domNode.children[2];}},orientation:D,orientationCss:"",applyPercentage:false,onRender:function O(){if(this.applyPercentage){var a=(this.orientation===D)?"x":"y",Z={};this._wPos={};Z[a]=parseInt((this.orientation===D)?this.width:this.height,10);this._wPos[a]=0;I.call(this,Z);}},config:{firstSplit:{v:"50%",min:"100px",max:undefined},secondSplit:{v:"50%",min:"100px",max:undefined},resizeHandle:{v:"5px"}},init:function X(Z){this._super(Z);var a=(this.orientation===D);this.orientationCss=a?B:H;this.restrictedToAxis=a?"x":"y";this.config=W.clone(this.config);this.layoutConfig=Q.call(this);},toggleFirstItemVisibility:function N(Z){if(Z){this.layoutConfig=Q.call(this);}else{this.layoutConfig[(this.orientation===D)?S:F]={firstSplitNode:"0px",resizeHandleNode:"0px",secondSplitNode:G};}this.doLayout();},toggleSecondItemVisibility:function P(Z){if(Z){this.layoutConfig=Q.call(this);}else{this.layoutConfig[(this.orientation===D)?S:F]={firstSplitNode:G,resizeHandleNode:"0px",secondSplitNode:"0px"};}this.doLayout();},draggable:true,dropZone:false,avatarCssClass:"mstrmojo-Splitter-av",delayResizing:false,createAvatar:function U(){var d=document.createElement("div"),c=(this.orientation===D),a=this._wPos=Y.position(this.domNode),b="2px",Z=d.style;Z.top=(c?a.y:0)+"px";Z.left=(c?0:a.x)+"px";Z.height=c?this.height:b;Z.width=c?b:this.width;Z.display=this.delayResizing?"block":L;return d;},isDragValid:function E(Z){return Z.src.node===this.resizeHandleNode||this._super(Z);},ondragmove:function R(Z){if(!this.delayResizing){I.call(this,Z.tgt.pos);}if(this._super){this._super(Z);}},ondragend:function M(Z){if(this.delayResizing){I.call(this,Z.tgt.pos);}delete this._wPos;if(this._super){this._super(Z);}}});mstrmojo.ui.Splitter.ENUM_OR=V;}());(function(){mstrmojo.requiresCls("mstrmojo.Container","mstrmojo.hash");var K=mstrmojo.hash,Q=mstrmojo.css,S="hidden",P=mstrmojo.Widget,R="mstrmojo-wh-pn-",A="titleIconsNode";mstrmojo.warehouse.ui.BasePanel=mstrmojo.declare(mstrmojo.Container,null,{scriptClass:"mstrmojo.warehouse.ui.BasePanel",markupString:'<div id="{@id}" class="mstrmojo-wh-Panel {@cssClass}" mstrAttach:click><div class="'+R+'header"><div class="'+R+'title tp{@icntp}"><span>{@title}</span></div><div class="'+R+'ttl-icons"></div></div><div><div class="'+R+'instructions-text">{@instructionsText}</div></div></div>',markupSlots:{headerNode:function F(){return this.domNode.firstChild;},titleNode:function J(){return this.domNode.firstChild.firstChild;},titleTextNode:function L(){return this.domNode.firstChild.firstChild.firstChild;},titleIconsNode:function C(){return this.domNode.firstChild.children[1];},instructionsNode:function E(){return this.domNode.lastChild.children[0];},containerNode:function M(){return this.domNode;}},markupMethods:{onvisibleChange:P.visibleMarkupMethod,onheightChange:P.heightMarkupMethod,onwidthChange:P.widthMarkupMethod},onRender:function G(){this._super();if(this.instructionsHeight){this.oninstructionsHeightChange({value:this.instructionsHeight});}this.oninstructionsVisibleChange({value:this.instructionsVisible});},title:"",titleTooltip:"",icntp:"",postBuildRendering:function N(){this._super();if(this.editableSlot){this.setEditableTitle("");}},ontitleChange:function O(){this.titleTextNode.innerHTML=this.title;},addNewTitleButton:function B(U){this.addChildren(K.copy(U,{scriptClass:"mstrmojo.Widget",markupString:'<span id="{@id}" class="{@cssClass}" mstrAttach:click>{@text}</span>',onvisibleChange:function V(){this.domNode.style.display=this.visible?"":"none";},useRichTooltip:true,showTooltip:function W(X,Y){this.richTooltip={cssClass:"vi-regular vi-tooltip-A",posType:mstrmojo.tooltip.POS_TOPLEFT,refNode:this.domNode,top:32,content:this.title||""};this.constructor.prototype.showTooltip.call(this,X,Y);},slot:A}));},setEditableTitle:function I(U){Q.toggleClass(this.titleNode,S,(U===""));Q.toggleClass(this.titleIconsNode,S,(U===""));this.set("text",U);this.set("title",U);},instructionsText:"",instructionsHeight:undefined,oninstructionsHeightChange:function H(U){var W=this.instructionsNode,V=U.value;if(W){W.style.height=V;W.style.lineHeight=V;}else{this.instructionsHeight=undefined;}},instructionsVisible:false,oninstructionsVisibleChange:function D(U){if(U.value){this.instructionsNode.style.display="block";}else{this.instructionsNode.style.display="none";}}});}());(function(){mstrmojo.requiresCls("mstrmojo.func","mstrmojo.Container","mstrmojo._HasPopup");var E=function(){var G=this.opener;if(G.direction.toLowerCase()==="up"){this.domNode.style.top=-G.domNode.offsetHeight+"px";}};mstrmojo.DropDownButton=mstrmojo.declare(mstrmojo.Container,[mstrmojo._HasPopup],{scriptClass:"mstrmojo.DropDownButton",height:"",text:"",direction:"down",enabled:true,title:"",allowHTML:true,markupString:'<div id="{@id}" class="mstrmojo-DropDownButton {@cssClass} {@direction}" style="{@cssText}"><div class="mstrmojo-DropDownButton-boxNode {@cssClass}-boxNode" title="{@title}" mstrAttach:mousedown><div class="mstrmojo-DropDownButton-iconNode {@cssClass}-iconNode">{@text}</div></div><div class="mstrmojo-DropDownButton-popupNode {@cssClass}-popupNode"></div></div>',markupSlots:{boxNode:function(){return this.domNode.firstChild;},iconNode:function(){return this.domNode.firstChild.firstChild;},popupNode:function(){return this.domNode.lastChild;}},markupMethods:{onheightChange:function(){this.boxNode.style.height=this.height||"";},ontextChange:function(){this.iconNode.innerHTML=this.getTextInnerHTML();},ontitleChange:function(){this.boxNode.title=this.title;},onenabledChange:function(){mstrmojo.css[this.enabled?"removeClass":"addClass"](this.domNode,["disabled"]);},onvisibleChange:function(){this.domNode.style.display=this.visible?"block":"none";}},preBuildRendering:function C(){if(this._super){this._super();}var G=this.popupRef;if(G){if(G.nudge){G.nudge=mstrmojo.func.composite([G.nudge,E]);}else{if(this.direction.toLowerCase()!=="down"){G.nudge=E;}}}},popupRef:null,popupOpenConfig:null,destroy:function D(G){var H=this.popupRef;if(H&&H.hasRendered){H.destroy(false);}if(this._super){this._super(G);}},togglePopup:function F(){var G=this._lastOpened;if(G&&G.visible){this.closePopup();}else{this.openPopup("popupRef",this.popupOpenConfig);}},premousedown:function A(G){this.togglePopup();},getTextInnerHTML:function B(){return this.allowHTML?this.text:mstrmojo.string.encodeHtmlString(this.text);}});}());(function(){mstrmojo.requiresCls("mstrmojo.Container");mstrmojo.requiresDescs(11668,15187,15188,15189,15190);function B(L,K,I){var J=K,H;for(;J>0;J--){H=Array(J+1).join("#");L=L.replace(H,I[J-1]);}return L;}var C='<div class="ghost-vis-txt-metric">',A='<div class="ghost-vis-txt-attr">',E='<div class="ghost-vis-txt-attr-time">',G="</div>";var D={grid:B(mstrmojo.desc(15187,"Add # or more ##attributes### and/or #### or more #####metrics######"),6,[1,A,G,1,C,G]),heatmap:B(mstrmojo.desc(15187,"Add # or more ##attributes### and/or #### or more #####metrics######"),6,[1,A,G,1,C,G]),barchart:B(mstrmojo.desc(15188,"Add # or more ##attributes### and #### or more #####metrics######"),6,[1,A,G,1,C,G]),linechart:B(mstrmojo.desc(15188,"Add # or more ##attributes### and #### or more #####metrics######"),6,[1,A,G,1,C,G]),areachart:B(mstrmojo.desc(15188,"Add # or more ##attributes### and #### or more #####metrics######"),6,[1,A,G,1,C,G]),bubblechart:B(mstrmojo.desc(15190,"Add # or more ##metrics### and #### or more #####attributes######"),6,[2,C,G,1,A,G]),piechart:B(mstrmojo.desc(15188,"Add # or more ##attributes### and #### or more #####metrics######"),6,[1,A,G,1,C,G]),combochart:B(mstrmojo.desc(15188,"Add # or more ##attributes### and #### or more #####metrics######"),6,[1,A,G,2,C,G]),network:B(mstrmojo.desc(15188,"Add # or more ##attributes### and #### or more #####metrics######"),6,[2,A,G,1,C,G]),histogram:B(mstrmojo.desc(15667,"Add # or more ##attributes### and ####  #####metric######"),6,[1,A,G,1,C,G]),boxplot:B(mstrmojo.desc(15188,"Add # or more ##attributes### and #### or more #####metrics######"),6,[1,A,G,1,C,G]),waterfall:B(mstrmojo.desc(15188,"Add # or more ##attributes### and #### or more #####metrics######"),6,[1,A,G,1,C,G]),kpicard:B(mstrmojo.desc(15878,"Add # or more ##attributes### and #### #####metric######"),6,[1,A,G,1,C,G])};function F(H){return D[H]?D[H]:mstrmojo.desc(11668,"Drag objects here.");}mstrmojo.vi.ui.rw.GhostImageContainer=mstrmojo.declare(mstrmojo.Container,[],{scriptClass:"mstrmojo.vi.ui.rw.GhostImageContainer",markupString:'<div id="{@id}" class="mstrmojo-vi-ui-rw-GhostImageContainer {@cssClass}"><div class="mstmojo-ghostImgTableCell"><div class="mstrmojo-ghostImgDiv"><div class="ghost-vis-img"></div><div class="ghost-vis-name">{@visName}</div><div class="ghost-vis-desc">{@visDesc}</div></div></div></div>',markupSlots:{containerNode:function(){return this.domNode;}},visName:"",visDesc:""});mstrmojo.vi.ui.rw.GhostImageContainer.getVisDesc=F;}());(function(){mstrmojo.requiresCls("mstrmojo.css","mstrmojo.Container");var D="slot";mstrmojo.HBox=mstrmojo.declare(mstrmojo.Container,null,{scriptClass:"mstrmojo.HBox",cellCssClass:"",cellSpacing:0,cellPadding:0,markupString:'<table id="{@id}" class="mstrmojo-HBox {@cssClass}" style="{@cssText}" cellspacing="{@cellSpacing}" cellpadding="{@cellPadding}">{@colHTML}<tr>{@tableHtml}</tr></table>',colHTML:"",markupSlots:{containerNode:function(){return this.domNode.rows[0];}},markupMethods:{onvisibleChange:function(){this.domNode.style.display=this.visible?mstrmojo.css.DISPLAY_TABLE:"none";}},buildRendering:function B(){this.tableHtml="";var N=[],F=this.children,K=(F&&F.length)||0,I;if(K){var G=0,J=this.cellCssClass?' class="mstrmojo-HBox-cell '+this.cellCssClass+'" ':"",M="<td "+J+"></td>";for(I=0;I<K;I++){N[G++]=M;F[I].slot=D+I;}this.tableHtml=N.join("");}this._super();if(K){var L={},H=this.containerNode.cells;for(I=0;I<K;I++){L["slot"+I]=H[I];}this.addSlots(L);}},addChildren:function E(K,F,G){if(!K){return K;}if(F===undefined||isNaN(F)||F<0){var J=this.children;F=(J&&J.length)||0;}var I=0,H;if(K.constructor===Array){for(I=0,H=K.length;I<H;I++){K[I].slot=D+(F+I);}}else{K.slot=D+F;}return this._super(K,F,G);},childRenderCheck:function C(G){if(G&&!G.hasRendered){var F=G.slot||this.defaultChildSlot;return !!this[F]||F.match(/^slot[\d]+$/);}return false;},onchildRenderingChange:function A(I){var F=(I&&I.src)||I,L=F&&F.domNode;if(L){var Q=F.slot;if(!this[Q]){var J=Q&&Q.match(/^slot([\d]+)$/);if(J){var O=parseInt(J[1],10),N=this.containerNode,P=N.cells,M=(P&&P.length)||0,K={};for(var H=M;H<=O;H++){var G=N.insertCell(H);K["slot"+H]=G;if(this.cellCssClass){G.className=this.cellCssClass;}}this.addSlots(K);}}}this._super(I);}});})();(function(){mstrmojo.requiresCls("mstrmojo.Container","mstrmojo.Widget","mstrmojo.css","mstrmojo.dom");var Z=mstrmojo.css,F=mstrmojo.dom;var a={9:"Tab",13:"Enter",27:"Esc",38:"ArrowUp",40:"ArrowDown"};function A(){var d=this.value,c=this.inputNode,e=c.value,b=(d!==null&&d!==undefined)?String(d):"";if(b!==e&&(!this.keepEmpty||e!==this.emptyText)){c.value=b;}if(c.mstrmojoEmpty){Z.removeClass(c,[this.emptyClass]);c.mstrmojoEmpty=null;}}function Y(){var b=this.inputNode;b.value=this.emptyText||"";Z.addClass(b,[this.emptyClass]);b.mstrmojoEmpty=true;}function N(){var b=this.inputNode;if(b){this.readingDom=true;this.set("value",b.value);this.readingDom=false;}}function V(b){var c=this;if(b===-1){N.call(this);}else{if(this._lastTimeoutId){window.clearTimeout(this._lastTimeoutId);}this._lastTimeoutId=window.setTimeout(function(){delete c._lastTimeoutId;N.call(c);},b||100);}}mstrmojo.TextBox=mstrmojo.declare(mstrmojo.Container,null,{scriptClass:"mstrmojo.TextBox",value:"",type:"text",hint:"",readOnly:false,size:"",maxLength:"",cssDisplay:"inline",tabIndex:"",emptyText:"",keepEmpty:false,emptyClass:"mstrmojo-empty",valueChangeDelay:-1,textValid:true,autoComplete:true,autoCorrect:true,autoCapitalize:true,spellCheck:true,markupString:'<input id="{@id}" class="mstrmojo-TextBox {@cssClass}"  style="{@cssText}" title="{@tooltip}" type="{@type}" value="" size="{@size}" maxlength="{@maxLength}" index="{@tabIndex}"min="{@min}" max="{@max}" placeholder="{@hint}" mstrAttach:focus,keyup,blur,paste,cut,input,click,keydown,mousedown  tstid="{@tstid}"/>',markupSlots:{inputNode:function D(){return this.domNode;}},markupMethods:{onvisibleChange:mstrmojo.Widget.visibleMarkupMethod,onwidthChange:mstrmojo.Widget.widthMarkupMethod,onheightChange:mstrmojo.Widget.heightMarkupMethod,oncssClassChange:function S(){this.inputNode.className="mstrmojo-TextBox "+(this.cssClass||"");},onhintChange:function O(){this.inputNode.setAttribute("placeholder",this.hint);},onenabledChange:function E(){var b=this.inputNode;b.disabled=!this.enabled;Z.toggleClass(b,"disabled",!this.enabled);},onvalueChange:function P(){var b=this.value,c=(b===undefined)||(b===null)||(b==="");if(c){if(!this.hasFocus){Y.call(this);}else{this.inputNode.value="";}}else{A.call(this);}if(F.isIE9){this.inputNode.type=c?"text":this.type;}},ontooltipChange:function R(){this.domNode.title=this.tooltip;},onreadOnlyChange:function H(){this.inputNode.readOnly=this.readOnly;},ontextValidChange:function B(){Z.toggleClass(this.inputNode,["err"],!this.textValid);}},postBuildRendering:function W(){this._super();var b=this.inputNode;b.setAttribute("autocomplete",this.autoComplete?"on":"off");b.setAttribute("autocorrect",this.autoCorrect?"on":"off");b.setAttribute("autocapitalize",this.autoCapitalize?"on":"off");b.setAttribute("spellcheck",this.spellCheck?"true":"false");},focus:function Q(){if(this.inputNode&&this.inputNode.offsetParent){try{this.inputNode.focus();}catch(b){}}},prefocus:function M(){this.hasFocus=true;A.call(this);},blur:function U(){this.inputNode.blur();},preblur:function X(){window.setTimeout(function(){},200);this.hasFocus=false;N.call(this);var b=this.value;if(((b===null||b==="")&&this.emptyText)||(this.keepEmpty&&b===this.emptyText)){Y.call(this);}},prekeyup:function I(c){var b=c.hWin,d=c.e||b.event;V.call(this,this.valueChangeDelay);var f=a[d.keyCode];if(this["on"+f]){this["on"+f](c);}},preinput:function J(){V.call(this,this.valueChangeDelay);},prepaste:function K(){V.call(this);},precut:function G(){V.call(this);},setInvalidState:function C(b){this.set("textValid",false);if(b){this.domNode.setAttribute("title",b);}},cleanUp:function L(){this.inputNode.value="";this.set("textValid",true);this.domNode.setAttribute("title",this.tooltip);}});}());(function(){mstrmojo.requiresCls("mstrmojo.Container","mstrmojo.dom","mstrmojo.css");var I=mstrmojo.css,G={9:"Tab",13:"Enter",27:"Esc",38:"ArrowUp",40:"ArrowDown"},E="sbClear",N="sbSearch";mstrmojo.SearchWidget=mstrmojo.declare(mstrmojo.Container,null,{scriptClass:"mstrmojo.SearchWidget",quickSearch:false,quickSearchForClear:false,showClearNode:true,placeholderText:"",markupString:'<table id={@id} cellspacing="0" cellpadding="0" class="mstrmojo-SearchWidget mstrmojo-SearchBox-Wrapper {@cssClass}" style="{@cssText};"><tr><td><div class="mstrmojo-SearchBox" mstrAttach:click ><input class="mstrmojo-SearchBox-input" type="text" style="width:{@width};" placeholder="{@placeholderText}" mstrAttach:keyup,focus,blur/></div></td><td><div class="mstrmojo-SearchBox-clear" id="{@id}'+E+'" mstrAttach:click></div></td><td><div class="mstrmojo-SearchBox-bg"><div class="mstrmojo-SearchBox-search" id="{@id}'+N+'" mstrAttach:click ></div></div></td></tr></table>',markupSlots:{inputNode:function(){return this.domNode.rows[0].cells[0].firstChild.firstChild;},clearNode:function(){return this.domNode.rows[0].cells[1].firstChild;},searchNode:function(){return this.domNode.rows[0].cells[2].firstChild.firstChild;}},markupMethods:{onquickSearchChange:function(){I.toggleClass(this.domNode,"quick-search",this.quickSearch);},onwidthChange:function(){if(this.inputNode&&this.inputNode.style&&this.inputNode.style.width){this.inputNode.style.width=this.width;}},ondisabledChange:function O(){var Q=this.disabled;I.toggleClass(this.domNode,"disabled",Q);if(this.inputNode){this.inputNode.disabled=Q;}}},clearNode:null,searchNode:null,isFocus:false,disabled:false,onsearch:mstrmojo.emptyFn,onclear:mstrmojo.emptyFn,prekeyup:function M(R){var Q=R.hWin,S=R.e||Q.event;this.updateSearch();var U=G[S.keyCode];if(this["on"+U]){this["on"+U](R);}},setClearIcon:function C(){var R=this.parent;if(!R){return ;}var Q=R.search&&R.search.searchNode,S=this.getSearchPattern(),U=(S.length===0);if(Q){I.toggleClass(this.searchNode,"clear",!U&&this.quickSearch);}},onEnter:function D(Q){this.onsearch(this.getSearchPattern());},onEsc:function A(Q){this.clearSearch();},getSearchPattern:function K(){return mstrmojo.string.trim(this.inputNode.value);},setSearchPattern:function K(Q){if(this.inputNode){this.inputNode.value=Q||"";this.updateSearch();}},preclick:function H(Q){var S=Q.getTarget(),R=S&&S.id;switch(R.replace(this.id,"")){case N:if(this.quickSearch){this.clearSearch();}else{this.onsearch(this.getSearchPattern());}break;case E:this.clearSearch();break;}},updateSearch:function B(){var R=this.getSearchPattern(),Q=(R.length===0),S=this.quickSearch;I.toggleClass(this.clearNode,"show",this.showClearNode&&!Q&&!S);I.toggleClass(this.searchNode,"clear",!Q&&S);I.toggleClass(this.domNode,"hasPattern",!Q);if(S||this.quickSearchForClear&&Q){this[Q?"clearSearch":"onsearch"](R);}},clearSearch:function L(){var Q=this.getSearchPattern();this.reset();this.onclear(Q);},onfocus:function P(){this.isFocus=true;I.addClass(this.domNode,"focus");},onblur:function J(){this.isFocus=false;I.removeClass(this.domNode,"focus");},reset:function F(){this.inputNode.value="";I.removeClass(this.clearNode,"show");I.removeClass(this.domNode,"hasPattern");I.removeClass(this.searchNode,"clear");}});}());(function(){mstrmojo.requiresCls("mstrmojo.Container");var A=mstrmojo.Widget;mstrmojo.Box=mstrmojo.declare(mstrmojo.Container,null,{scriptClass:"mstrmojo.Box",markupString:'<div id="{@id}" class="mstrmojo-Box {@cssClass}" style="{@cssText}"></div>',markupSlots:{containerNode:function(){return this.domNode;}},markupMethods:{onvisibleChange:A.visibleMarkupMethod,onheightChange:A.heightMarkupMethod,onwidthChange:A.widthMarkupMethod}});}());(function(){mstrmojo.requiresCls("mstrmojo.css","mstrmojo.Container");mstrmojo.VBox=mstrmojo.declare(mstrmojo.Container,null,{scriptClass:"mstrmojo.VBox",markupString:'<table id="{@id}" class="mstrmojo-VBox {@cssClass}" style="{@cssText}" cellspacing="0" cellpadding="0"><tr><td></td></tr></table>',markupSlots:{containerNode:function(){return this.domNode.rows[0].cells[0];}},markupMethods:{onvisibleChange:function(){this.domNode.style.display=this.visible?mstrmojo.css.DISPLAY_TABLE:"none";}}});})();(function(){mstrmojo.requiresCls("mstrmojo.Container","mstrmojo.dom","mstrmojo._IsPopup","mstrmojo._CanAutoClose");var C=mstrmojo.dom;mstrmojo.ui.PopupWidget=mstrmojo.declare(mstrmojo.Container,[mstrmojo._IsPopup,mstrmojo._CanAutoClose],{scriptClass:"mstrmojo.ui.PopupWidget",markupString:'<div id="{@id}" class="mstrmojo-ui-PopupWidget {@cssClass}" style="{@cssText}" mstrAttach:mouseover,mouseout,click><div class="pw-content"></div></div>',markupSlots:{containerNode:function A(){return this.domNode.firstChild;}},markupMethods:{onvisibleChange:mstrmojo.Widget.visibleMarkupMethod},autoCloses:true,locksHover:true,closeOnClick:true,visible:true,onclick:function B(D){C.stopPropogation(null,D.e);}});}());(function(){mstrmojo.requiresCls("mstrmojo.dom","mstrmojo.css","mstrmojo.Container","mstrmojo._IsPopup","mstrmojo.boxmodel","mstrmojo.dom","mstrmojo.ui._HasScroller");var L=mstrmojo.boxmodel,I=mstrmojo.dom,M=mstrmojo.css,O="mstrmojo-Tooltip",A="mstrmojo-scrollNode",E=20;function C(S,U,R){var V="connectScrollbox";if(R){V="dis"+V;}var Q=S&&S.parent;while(Q){if(Q[V]){Q[V](U);}Q=Q.parent;}}function G(){if(!this._paintHandle){var R=this.id,Q=function(W){var a=mstrmojo.all[R];if(!a){return ;}delete a._paintHandle;var U=[O],b=a.cssClass;if(b){U.push(b);}var S=mstrApp.getThemeClassName&&mstrApp.getThemeClassName(),Y=a.opener;if(Y&&Y.getTooltipThemeClass){S=Y.getTooltipThemeClass();}U.push(S);a.domNode.className=U.join(" ");var Z=a.content,V=a.contentNode,X=a.arrowNode;V.className=(O+"-content "+A+" "+a.contentNodeCssClass);V.style.cssText=a.contentNodeCssText;if(!a.hasWidgetContent){V.innerHTML=Z;}X.style.cssText="";a.domNode.style.visibility=!!Z?"visible":"hidden";a.updatePosition();if(!W&&a.optimizePos){a.optimizePos();}a.updateScrollbars();};if(!this._hasPaint){Q(true);this._hasPaint=true;}else{this._paintHandle=window.setTimeout(Q,0);}}}function B(V,d,k,W){var Z=d&&(d.richTooltip||d.tooltip),n=k?I.getMousePosition(k,W||self):null,c=Z&&(typeof Z==="string");var l="",b="",Y="",h=Z,a=null,Q=mstrmojo.tooltip.POS_TOPLEFT,S=null,f=null,R=null,m=false,U=null,X=mstrmojo._HasTooltip.TOOLTIP_CLOSE_DELAY;var g=false,j=false;if(Z&&!c){b=Z.cssClass||b;l=Z.contentNodeCssClass||l;Y=Z.contentNodeCssText||Y;h=Z.content||"";a=Z.refNode||a;Q=Z.posType||Q;S=Z.left||0;f=Z.top||0;g=Z.keepArrowXPos||g;j=Z.keepArrowYPos||j;R=Z.updatePosition||null;m=Z.hasWidgetContent;U=Z.children;X=Z.tooltipCloseDelay||mstrmojo._HasTooltip.TOOLTIP_CLOSE_DELAY;}V.set("contentNodeCssClass",l);V.set("cssClass",b);V.set("contentNodeCssText",Y);V.set("content",h);V.set("refNode",a);V.set("posType",Q);V.set("left",c?((n&&n.x)||V.left):S);V.set("top",(c||!Z)?((n&&(n.y+E))||V.top):f);V.set("keepArrowXPos",g);V.set("keepArrowYPos",j);if(R){V.set("updatePosition",R);}else{V.set("updatePosition",mstrmojo.Tooltip.prototype.updatePosition);}V.set("hasWidgetContent",m);V.set("children",U);V.set("tooltipCloseDelay",X);}mstrmojo.Tooltip=mstrmojo.declare(mstrmojo.Container,[mstrmojo._IsPopup,mstrmojo.ui._HasScroller],{scriptClass:"mstrmojo.Tooltip",content:null,top:null,left:null,refNode:null,keepArrowXPos:false,keepArrowYPos:false,posType:"TL",allowOtherTooltips:false,markupString:'<div id="{@id}" class="'+O+' {@cssClass}" style="{@cssText}" mstrAttach:mouseover,mouseout><div class="'+O+'-shadow {@shadowNodeCssClass}"></div><div class="'+O+'-contentWrapper"><div class="'+O+"-content "+A+' {@contentNodeCssClass}" style="{@contentNodeCssText}"></div></div><div class="'+O+'-arrow"></div></div>',markupSlots:{containerNode:function(){return this.domNode.children[1];},contentNode:function(){return this.domNode.children[1].firstChild;},shadowNode:function(){return this.domNode.firstChild;},arrowNode:function(){return this.domNode.children[2];}},setupScrollNodes:function D(){this.scrollNode=this.contentNode;this.scrollbarHostNode=this.containerNode;},_previousVisible:false,markupMethods:{onvisibleChange:function(){var R=this.domNode.style,Q=!!this.visible;if(this._previousVisible!==Q){R.visibility="hidden";}R.display=Q?"block":"none";this._previousVisible=Q;if(Q){this.updatePosition();if(this.content){G.call(this);}}},onleftChange:G,ontopChange:G,onrefNodeChange:G,onposTypeChange:G,oncontentNodeCssClassChange:G,oncontentNodeCssTextChange:G,oncontentChange:G,oncssClassChange:G},preBuildRendering:function N(){if(!this.slot&&!this.placeholder){this.placeholder=document.body.appendChild(document.createElement("div"));}return this._super();},updatePosition:function H(W){if(!this.visible&&!W){return ;}var V=this.refNode,U=V?L.offset(V,document.body):{left:I.getHorizontalScroll(),top:I.getVerticalScroll()},n=this.domNode.style,g=this.containerNode,j=g.offsetWidth,a=g.offsetHeight,R=this.posType,d=R.indexOf("R")>-1,X=R.indexOf("B")>-1,c=this.top!==null?parseInt(this.top,10)+U.top-(X?a:0):null,S=this.left!==null?parseInt(this.left,10)+U.left-(d?j:((R.indexOf("C")>-1)?Math.floor(j/2):0)):null,l=false,b=false,e,Y,k=I.windowDim(),h=I.getHorizontalScroll()+k.w,Q=I.getVerticalScroll()+k.h,f=this.arrowNode,m=null;if(S!==null){e=Math.min(Math.max(S,0),h-j);n.left=e+"px";l=S!==e;}if(c!==null){Y=Math.min(Math.max(c,0),Q-a);n.top=Y+"px";b=c!==Y;}if(l||b){var Z,p=this.keepArrowXPos&&l,o=this.keepArrowYPos&&b;if(p||o){m=M.getComputedStyle(f);Z=m.left;}if(Z&&Z.endsWith("%")){Z=parseFloat(Z)/100*j;}if(p){f.style.left=(parseInt(Z,10)+S-e)+"px";}if(o){f.style.top=(parseInt(m.top,10)+c-Y)+"px";}}M.toggleClass(this.domNode,"offset",l||b);},_on_tooltip_change:function(Q){B(this,Q&&Q.src);},_set_opener:function(U,S){var R=this.opener,Q=S!==R;if(Q){if(S){C(S,this);}if(R){C(S,this,true);}if(R&&R.detachEventListener){R.detachEventListener(this._richSubs);R.detachEventListener(this._ttpSubs);}if(S&&S.attachEventListener){this._richSubs=S.attachEventListener("richTooltipChange",this.id,"_on_tooltip_change");this._ttpSubs=S.attachEventListener("tooltipChange",this.id,"_on_tooltip_change");}this.opener=S;}return Q;},updatePopupConfig:function(Q,R){B(this,R,Q&&Q.e,Q&&Q.win);},onscroll:function K(){if(this.visible&&this.nudge){this.nudge();}this._super();},onmouseover:mstrmojo.emptyFn,onmouseout:mstrmojo.emptyFn});var J=null;mstrmojo.tooltip={POS_TOPLEFT:"TL",POS_BOTTOMLEFT:"BL",POS_TOPRIGHT:"TR",POS_BOTTOMRIGHT:"BR",POS_BOTTOMCENTER:"BC",POS_TOPCENTER:"TC",open:function F(R,U,S,Q){if(R&&R.hasWidgetContent&&J){J.destroy();}if(!J||!mstrmojo.all[J.id]){J=new mstrmojo.Tooltip();}Q=Q||{};Q.e=U;Q.win=S;J.open(R,Q);R.tooltip=J;},close:function P(){if(J&&!J.allowOtherTooltips){var Q=J.opener;if(Q){Q.tooltip=null;}J.close();if(Q&&Q.hasWidgetContent){J.destroy();}}}};}());(function(){mstrmojo.requiresCls("mstrmojo.func","mstrmojo.Container","mstrmojo._HasPopup");var B=mstrmojo.func,D=mstrmojo.dom,C=mstrmojo.ui._HasUITheme.EnumThemeNames,G="mstrmojo-popup-widget-hosted";mstrmojo.ui.PopupButton=mstrmojo.declare(mstrmojo.Container,[mstrmojo._HasPopup],{scriptClass:"mstrmojo.ui.PopupButton",onPopupWidgetClosed:mstrmojo.emptyFn,onPopupWidgetOpened:mstrmojo.emptyFn,anchorSlot:"domNode",isHostedWithin:true,hostedCSSClass:"",destroy:function J(N){if(this._listenerProc){D.detachEvent(window,"resize",this._listenerProc);}this._super(N);},getPopupWidget:mstrmojo.emptyFn,postCreateChildren:function E(){var N=this.getPopupWidget();if(!N||N._pbCfg){return ;}var O=function O(Q,P){return function(){Q.apply(P,arguments);};};N.onOpen=B.composite([O(this.onPopupWidgetOpened,this),N.onOpen||mstrmojo.emptyFn]);N.onClose=B.composite([O(this.onPopupWidgetClosed,this),N.onClose||mstrmojo.emptyFn]);N._pbCfg=true;},onclick:function L(N){if(this.isClickingAnchorSlot(N)){var O=this.getPopupWidget();if(!O.visible){this.openPopup(O);}else{this.closePopup();}}},isClickingAnchorSlot:function M(N){var O=N.getTarget();return O===this[this.anchorSlot]||O.parentNode===this[this.anchorSlot];},onPopupAutoClosed:function I(O,N){if(D.contains(this[this.anchorSlot],D.eventTarget(N,O),true)){return false;}},getPopupHostNode:function K(){return this.containerNode;},getPopupConfig:function H(){var O=[G],N=this.hostedCSSClass;if(N){O.push(N);}var P=new mstrmojo.ui.PopupConfig({hostId:this.id,hostElement:this.getPopupHostNode(),anchorElement:this[this.anchorSlot],isHostedWithin:this.isHostedWithin,hostProxyCssClass:O.join(" ")});return this.disposables?this.addDisposable(P):P;},unrender:function F(N){if(this._listenerProc){D.detachEvent(window,"resize",this._listenerProc);delete this._listenerProc;}this._super(N);},postBuildRendering:function A(){var R=this.getPopupWidget();if(R){var U=this.getPopupConfig();if(!U.isHostedWithin){var P=this.parent||this.opener,O=U.hostProxyCssClass.split(" ");O.push(this.domNode.className);while(P){var S=P.themeClassName;if(S){O.push(S);break;}P=P.parent||P.opener;}if(U.useDarkTheme){O.splice(O.indexOf(C.LIGHT_THEME),1);O.push(C.DARK_THEME);}U.hostProxyCssClass=O.join(" ");}mstrmojo.Obj.free(R.popupConfig);R.popupConfig=R.addDisposable(U);}if(!(this.editableSlot&&D.isMobile)){var N=R.id,Q=this._listenerProc=function(){var V=mstrmojo.all[N];if(V&&V.visible&&V.adjustCornersForPopupOverflow){V.adjustCornersForPopupOverflow();}};if(this.isHostedWithin===false){D.attachEvent(window,"resize",Q);}}return this._super();}});}());(function(){mstrmojo.requiresCls("mstrmojo.array","mstrmojo.Container","mstrmojo._CanRenderChildrenOnShow");var A=mstrmojo.array;mstrmojo.StackContainer=mstrmojo.declare(mstrmojo.Container,[mstrmojo._CanRenderChildrenOnShow],{scriptClass:"mstrmojo.StackContainer",isStack:true,markupString:'<div id="{@id}" class="mstrmojo-StackContainer {@cssClass}" style="{@cssText}"></div>',markupMethods:{onwidthChange:function(){if(!isNaN(parseInt(this.width))){this.domNode.style.width=this.width;}},onheightChange:function(){if(!isNaN(parseInt(this.height))){this.domNode.style.height=this.height;}},onborderChange:function(){this.domNode.style.border=this.border||"";},onbackgroundChange:function(){this.domNode.style.background=this.background||"";}},markupSlots:{containerNode:function(){return this.domNode;}},_set_selected:function D(H,F){var G=this.selected;if(G===F){return false;}if(G){G.set("visible",false);}this.selected=F;if(F){F.set("visible",true);}return true;},addChildren:function B(J,G,H){var K=this.selected,L;for(var I=0,F=(J&&J.length)||0;I<F;I++){L=J[I];if(L&&L.set){L.set("visible",L===K);}}return this._super(J,G,H);},removeChildren:function C(H,F){var G=this._super(H,F);if(!H||(H===this.selected)){this.set("selected",null);}return G;},destroy:function E(F){this._super(F);this.selected=null;},renderMode:"onshow"});})();(function(){mstrmojo.requiresCls("mstrmojo.Container");function B(K,J,H){var I=J,G;for(;I>0;I--){G=Array(I+1).join("#");K=K.replace(G,H[I-1]);}return K;}var C='<div class="freezing-vis-txt-metric">',A='<div class="freezing-vis-txt-attr">',E="</div>",F="("+mstrmojo.desc(16294,"data retrieval paused")+")";var D=function(J,I){if(J<1&&I<1){return null;}var H=[],G="# ## ### ####";if(J>0){H.push(B(G,4,[A,J,J>1?mstrmojo.desc(3581,"Attributes"):mstrmojo.desc(518,"Attribute"),E]));}if(I>0){H.push(B(G,4,[C,I,I>1?mstrmojo.desc(3582,"Metrics"):mstrmojo.desc(517,"Metric"),E]));}return H.join(",");};mstrmojo.vi.ui.rw.FreezingImageContainer=mstrmojo.declare(mstrmojo.Container,[],{scriptClass:"mstrmojo.vi.ui.rw.FreezingImageContainer",markupString:'<div id="{@id}" class="mstrmojo-vi-ui-rw-freezingImageContainer mstrmojo-vi-ui-rw-GhostImageContainer {@cssClass}"><div class="mstmojo-freezingImgTableCell"><div class="mstrmojo-freezingImgDiv"><div class="freezing-vis-img ghost-vis-img"></div><div class="freezing-vis-desc"><label class="visName">{@visName}</label><div class="freezing-details">{@freezingDetails}</div></div><div class="vis-dropzone">{@visDropzoneMsg} </div></div></div></div>',markupSlots:{containerNode:function(){return this.domNode;}},visName:"",freezingDetails:F,visDropzoneMsg:""});mstrmojo.vi.ui.rw.FreezingImageContainer.getVisDropzoneMsg=D;}());(function(){mstrmojo.requiresCls("mstrmojo.Container","mstrmojo._IsPopup","mstrmojo._CanAutoClose");function A(B){return function(){this.domNode.style[B]=this[B]||"";};}mstrmojo.Popup=mstrmojo.declare(mstrmojo.Container,[mstrmojo._IsPopup,mstrmojo._CanAutoClose],{scriptClass:"mstrmojo.Popup",shadowNodeCssClass:"mstrmojo-popup-shadow",titleNodeCssClass:"mstrmojo-popup-title",contentNodeCssClass:"mstrmojo-popup-content",cssDisplay:"block",keepOpen:false,markupString:'<div id="{@id}" class="mstrmojo-Popup {@cssClass}" style="{@cssText}"><div class="mstrmojo-Popup-shadow {@shadowNodeCssClass}"></div><div class="mstrmojo-Popup-title {@titleNodeCssClass}">{@title}</div><div class="mstrmojo-Popup-content {@contentNodeCssClass}"></div></div>',markupSlots:{containerNode:function(){return this.domNode.lastChild;},shadowNode:function(){return this.domNode.firstChild;}},markupMethods:{onvisibleChange:mstrmojo.Widget.visibleMarkupMethod,onleftChange:A("left"),ontopChange:A("top"),onzIndexChange:A("zIndex")}});}());(function(){mstrmojo.requiresCls("mstrmojo.Widget","mstrmojo.dom");var M=mstrmojo.Widget,G=mstrmojo.dom,N=mstrmojo.global.document,C=50,B=500;mstrmojo.Stepper=mstrmojo.declare(mstrmojo.Container,null,{scriptClass:"mstrmojo.Stepper",orientation:"vertical",provider:null,title:"",markupString:'<div id="{@id}" class="mstrmojo-Stepper {@orientation} {@cssClass}" mstrAttach:click,mousedown,selectstart><div class="title">{@title}</div><div class="next">+</div><div class="text">{@itemHtml}</div><div class="prev">-</div></div>',markupSlots:{titleNode:function(){return this.domNode.firstChild;},nextNode:function(){return this.domNode.children[1];},textNode:function(){return this.domNode.children[2];},prevNode:function(){return this.domNode.lastChild;}},markupMethods:{onvisibleChange:M.visibleMarkupMethod,onheightChange:M.heightMarkupMethod,onwidthChange:M.widthMarkupMethod,onenabledChange:function I(){mstrmojo.css.toggleClass(this.domNode,"disabled",!this.enabled);}},preBuildRendering:function J(){this.itemHtml=this.provider.renderItemAt();this._super();},processEvent:function A(O){if(G.contains(this.textNode,O)||O===this.titleNode){return ;}var Q=this.provider,P=((O===this.nextNode)?"Next":"Prev");if(Q["has"+P]()){Q[P.toLowerCase()]();this.updateDisplayText();}},updateDisplayText:function E(){this.textNode.innerHTML=this.provider.renderItemAt();},startStepperInterval:function F(O,P){var Q=this;this._holdTimer=setInterval(function(){Q[P](O);},C);},stopStepperInterval:function H(){if(this._holdTimer){clearInterval(this._holdTimer);delete this._holdTimer;}},onclick:function L(O){this.processEvent(O.e.target);},onmousedown:function D(O){if(!this._holdTimer&&!this._startHoldTimer){var P=this;this._startHoldTimer=setTimeout(function(){delete P._startHoldTimer;P.startStepperInterval(O,"onclick");},B);G.attachOneTimeEvent(N,"mouseup",function(){if(P._startHoldTimer){clearTimeout(P._startHoldTimer);delete P._startHoldTimer;}P.stopStepperInterval();},true);}},onselectstart:function K(){return false;}});}());(function(){mstrmojo.requiresCls("mstrmojo.Container","mstrmojo.dom","mstrmojo.css");var A=mstrmojo.css;var I=mstrmojo.dom;function B(K){var M=document.createElement("div"),L=M.style,J=K.domNode;M.className="mstrmojo-qb-SplitPanel-avatar";L.height=J.clientHeight+"px";J.appendChild(M);K.avatar=M;return M;}mstrmojo.qb.SplitPanel=mstrmojo.declare(mstrmojo.Container,[mstrmojo._HasLayout],{scriptClass:"mstrmojo.qb.SplitPanel",draggable:true,dropZone:false,marginSpan:10,minSpan:200,leftItemVisible:true,rightItemVisible:true,lp:25,markupString:'<div id="{@id}" class="mstrmojo-SplitPanel {@cssClass}" style="{@cssText}" ><table cellpadding=0 cellspacing=0><tr><td><div></div></td><td style="padding-left:{@marginSpan}px;"><div class="mstrmojo-qb-SplitPanel-resizeHandle" style="height:{@height};width:{@marginSpan}px;margin-left:-{@marginSpan}px;" ></div><div></div></td></tr></table></div>',markupSlots:{leftItem:function(){return this.domNode.firstChild.firstChild.firstChild.firstChild.firstChild;},rightItem:function(){return this.domNode.firstChild.firstChild.firstChild.children[1].children[1];}},getDragData:function H(J){var K=J.src,M=K.node;if(M.className&&M.className.indexOf("mstrmojo-qb-SplitPanel-resizeHandle")>=0){var L=I.position(this.domNode);return{node:M,x:L.x,y:L.y,w:L.w,h:L.h};}else{if(this._super){return this.dropZone&&this._super(J);}}return null;},allowDrop:function E(J){var K=J.src,L=K&&K.data;if(L&&L.node){return true;}else{return this.dropZone;}},ondragmove:function F(J){var L=J.src,N=L&&L.data;if(N&&N.node){var K=J.tgt,M=this.avatar;if(M){M.style.left=Math.min(Math.max(N.x+this.minSpan,K.pos.x),N.x+N.w-this.minSpan)+"px";}}},isDragValid:function G(J){var K=J.src,L=K&&K.data;return !!(L&&L.node);},ondragstart:function C(J){var K=J.src,M=K&&K.data;var L=this.avatar||B(this);this.ownAvatar=true;L.style.left=K.pos.x+"px";L.style.top=M.y+"px";L.style.display="block";L.style.zIndex="9999";L.style.height=M.h+"px";},ondragend:function D(J){var L=J.src,O=L&&L.data;if(O&&O.node){var N=this.avatar;if(N){N.style.display="none";var K=parseInt(N.style.left)-O.x-this.marginSpan/2,M=this.domNode.clientWidth;this.lp=K*100/M;this.layoutConfig.w={leftItem:this.lp+"%",rightItem:100-this.lp+"%"};this.doLayout();}this.ownAvatar=false;}},children:[{scripClass:"mstrmojo.Box",slot:"leftItem"},{scripClass:"mstrmojo.Box",slot:"rightItem"}],layoutConfig:{w:{leftItem:"20%",rightItem:"80%"},h:{leftItem:"100%",rightItem:"100%"}},afterLayout:function(){if(this.domNode){var J=this.domNode.firstChild.firstChild.firstChild.children[1].children[0].style;if(this.leftItemVisible&&this.rightItemVisible){J.display="block";this.children[0].set("visible",true);this.children[1].set("visible",true);J.height=this.height;var L=parseInt(this.children[0].width);this.children[0].set("width",L+"px");this.rightItem.style.width=parseInt(this.width)-L-this.marginSpan+"px";this.children[1].set("width",this.rightItem.style.width);}else{J.display="none";if(this.leftItemVisible){this.children[0].set("width",this.width);this.children[1].set("visible",false);}else{this.children[1].set("width",this.width);this.children[0].set("visible",false);var K=this.rightItem.parentNode;K.style["padding-left"]="0px";}}}},_set_leftItemVisible:function(L,J){if(this.leftItemVisible!=J){this.leftItemVisible=J;if(J){this.layoutConfig.w={leftItem:this.lp+"%",rightItem:100-this.lp+"%"};if(this.rightItem){var K=this.rightItem.parentNode;K.style["padding-left"]=this.marginSpan+"px";}}else{this.layoutConfig.w={leftItem:"0%",rightItem:"100%"};if(this.rightItem){var K=this.rightItem.parentNode;K.style["padding-left"]="0px";}}this.doLayout();}},_set_rightItemVisible:function(K,J){if(this.rightItemVisible!=J){this.rightItemVisible=J;if(J){this.layoutConfig.w={leftItem:this.lp+"%",rightItem:100-this.lp+"%"};}else{this.layoutConfig.w={leftItem:"100%",rightItem:"0%"};}this.doLayout();}},postBuildRendering:function(){if(this._super){this._super();}this.height=this.domNode.clientHeight+"px";}});})();(function(){mstrmojo.requiresCls("mstrmojo.Widget","mstrmojo.ui._HasScroller","mstrmojo.css","mstrmojo.DI.DIHelpers");var F=mstrmojo.css,H=mstrmojo.string,A=mstrmojo.desc(14058,"Show Details"),E=mstrmojo.desc(14059,"Hide Details"),B=mstrmojo.DI.DIHelpers,D=mstrmojo.desc(14060,"We are sorry for the inconvenience. Please {contact} your administrator for help.").replace("{",'<span class="dyn-link">').replace("}","</span>");mstrmojo.ui.editors.ErrorDialogContent=mstrmojo.declare(mstrmojo.Widget,[mstrmojo.ui._HasScroller],{scriptClass:"mstrmojo.ui.editors.ErrorDialogContent",markupString:'<div class="mstrmojo-error-content {@cssClass}" mstrAttach:click><div class="scroll-container"><div>{@shortDesc}</div><div class="contact">'+D+'</div><div class="toggle-details-link" >'+A+'</div><div class="error-details">{@longDesc}</div></div></div>',markupSlots:{scrollNode:function(){return this.domNode.firstChild;},contactNode:function(){return this.domNode.firstChild.children[1].getElementsByClassName("dyn-link")[0];},toggleDetailsNode:function(){return this.domNode.firstChild.children[2];},errorDetailsNode:function(){return this.domNode.firstChild.children[3];}},markupMethods:{onshowDetailsChange:function(){var K=this.showDetails;this.toggleDetailsNode.innerHTML=K?E:A;F.toggleClass(this.domNode,"show-details",K);this.updateScrollbars();}},cssClass:undefined,shortDesc:undefined,longDesc:undefined,showDetails:false,showToggle:true,enableContactStr:true,allowHTML:false,init:function I(K){this._super(K);this.shortDesc=this.shortDesc||mstrmojo.desc(14061,"An error has occurred");},onclick:function J(K){var M=K.getTarget(),L,N=this.longDesc;if(M===this.contactNode){L="mailto:?subject="+encodeURI("Issue: "+this.shortDesc)+(N?("&body="+encodeURI("Detail:\r\n"+N)):"");mstrApp.openPage(L,"_self");}else{if(M===this.toggleDetailsNode){this.set("showDetails",!this.showDetails);this.parent.raiseEvent({name:"EditorResized"});this.parent.positionDialog();}}},setupScrollNodes:function C(){this.scrollNode=this.scrollNode;},preBuildRendering:function G(){this._super&&this._super();if(!this.allowHTML){this.longDesc=H.encodeHtmlString(H.decodeHtmlString(this.longDesc,true),true);}},postBuildRendering:function(){var K=this.domNode.firstChild.children[1];this._super&&this._super();!this.showToggle&&F.addClass(this.toggleDetailsNode,"hide");!this.enableContactStr&&F.addClass(K,"invisible");}});})();(function(){mstrmojo.requiresCls("mstrmojo.Obj","mstrmojo.DI.DIConstants","mstrmojo.DI.DIHelpers");var J=mstrmojo.array,E=mstrmojo.hash,O=mstrmojo.func.wrapMethods,G=mstrmojo.DI.DIHelpers;function N(V){var S=[],P=mstrApp.getRootController().model.dbObjectsDisplayOptions,Q=mstrApp.getRootController().model.dbObjectsConnectionType,U=this,R=this.dbmsTypeFilter;J.forEach(V,function(W){if((W.disp&P)===P&&(R.length===0||J.indexOf(R,W.dbType)>-1)){if((W.connType&4)===4){S.push(W);}else{if((W.connType&Q)===Q||W.n===mstrmojo.DI.DIConstants.GenericDBStr){S.push(W);}}}});if(!U.dbVersion2dbId){U.dbVersion2dbId={};J.forEach(S,function(W){J.forEach(W.dbVersions,function(X){U.dbVersion2dbId[X.v]=W.id;});});}this.dsnMapDBs=V;this.supportedDBs=S;}function C(){var P=this;E.forEach(P.dbTypes,function(Q){if(Q.catSQL===1){P.catalogDbTypes.push(Q);}});}function B(P){P=P.sort(function(R,Q){return R.n.toLowerCase().localeCompare(Q.n.toLowerCase());});P.unshift({n:mstrmojo.desc(8526,"select a dsn"),nU:mstrmojo.desc(8526,"select a dsn").toUpperCase(),des:0});return P;}function F(P){P=P.sort(function(R,Q){return R.n.toLowerCase().localeCompare(Q.n.toLowerCase());});return P;}function A(U){if(!(U.DBInfo&&U.DBInfo.Preferences)){return U;}var Q,S=JSON.stringify(U),V,P=U.DBInfo.Preferences.driverNameSuffix;var R="Platform";if(mstrApp.isSingleTier){if(G.isWS()&&(navigator.platform.indexOf("Win")>-1)){R="WorkstationWin";}else{R=navigator.platform.indexOf("Win")===-1?"DesktopMac":"DesktopWin";}}Q=J.find(P,"n",R);V=P[Q];return JSON.parse(S.replace(/!#DRIVERSUFFIX#!/g,V.value));}function M(Q){var P=this;if(P.loaded){Q.success();}else{if(this.dbmsTypeFilter.length>0){this.dbmsTypeFilter.push(1100);}mstrApp.getRootController().model.submitRequest(O({success:function(S){S=A(S);var R=(S.DBMS.dbmss.dbms?[].concat(S.DBMS.dbmss.dbms):[]);P.dbms=R;P.dbms.sort(function(V,U){var X=V.db_ver;var W=U.db_ver;if(X<W){return 1;}if(X>W){return -1;}return 0;});P.dsndbms=R.sort(function(V,U){return V.n.toLowerCase().localeCompare(U.n.toLowerCase());});N.call(P,S.DBInfo.DBS);P.dbVersions=S.DBInfo.dbVersions;P.dbTypes=S.DBInfo.dbTypes;C.call(P);P.dbIDs=S.DBInfo.dbIDs;P.drivers=F(S.Drivers.Drivers);P.preferences=S.DBInfo.Preferences;P.dsns=B(S.DSNs.Dsns);P.loaded=true;}},Q),{taskId:"arch.getDBObjects",skipSchemaIDCheck:true,showWait:true,typeFilter:(mstrApp.isWorkstation&&!mstrApp.isSingleTier)?(this.dbmsVersionFilter.length?this.dbmsTypeFilter.toString():""):this.dbmsVersionFilter,versionFilter:(mstrApp.isWorkstation&&!mstrApp.isSingleTier)?(this.dbmsVersionFilter.length?this.dbmsVersionFilter.toString():""):this.dbmsVersionFilter,typeExcludeFilter:P.dbmsTypeExcludeFilter.join(","),versionExcludeFilter:P.dbmsVersionExcludeFilter.join(","),flags:15});}}function D(P,U){var R=this;var S={taskId:"arch.getDBObjects",skipSchemaIDCheck:true,showWait:true,flags:P};var Q=O({success:function(V){V=A(V);if(V.DBInfo){N.call(R,V.DBInfo.DBS);R.dbVersions=V.DBInfo.dbVersions;R.dbTypes=V.DBInfo.dbTypes;C.call(R);R.dbIDs=V.DBInfo.dbIDs;R.preferences=V.DBInfo.Preferences;}if(V.Drivers){R.drivers=F(V.Drivers.Drivers);}if(V.DSNs){R.dsns=B(V.DSNs.Dsns);}mstrApp.hideWait();}},U);mstrApp.showProgress();mstrApp.serverRequestQueue(S,U,mstrApp.taskQueue);}mstrmojo.warehouse.obj.DBObjects=mstrmojo.declare(mstrmojo.Obj,null,{scriptClass:"mstrmojo.warehouse.obj.DBObjects",dbms:[],dsndbms:[],supportedDBs:[],dsnMapDBs:[],drivers:[],dsns:[],dbVersions:undefined,dbTypes:undefined,catalogDbTypes:[],dbIDs:undefined,preferences:undefined,dbmsTypeFilter:[],dbmsVersionFilter:[],dbmsTypeExcludeFilter:[],dbmsVersionExcludeFilter:[],DBInfo:undefined,DBS:undefined,DSNs:undefined,Dsns:undefined,Preferences:undefined,Drivers:undefined,DBMS:undefined,dbmss:undefined,disp:undefined,dbVersion2dbId:undefined,load:function L(Q,P,R){this.dbmsTypeFilter=Q;this.dbmsVersionFilter=P;M.call(this,R);},populateDBProperties:function K(P){if(this.supportedDBs.length>0){P.success();}else{D.call(this,8,P);}},reloadDrivers:function H(P){D.call(this,2,P);},reloadDSNs:function I(P){D.call(this,4,P);},loaded:false});}());(function(){mstrmojo.requiresCls("mstrmojo.vi.models.PanelFormatSaver");mstrmojo.vi.ui._IsViPanel=mstrmojo.provide("mstrmojo.vi.ui._IsViPanel",{_mixinName:"mstrmojo.vi.ui._IsViPanel",getPanelSaver:function A(){return null;},setOpenStatus:function D(F,E,I,H){if(this.visible!==F){this.set("visible",F);if(!H){this.resetLayout(H);}if(!E){var G=this.getPanelSaver();if(G){G.saveProperty("visible",F);}}mstrApp.rootCtrl.generateToolbar();}},getOpenStatus:function C(){return !!this.visible;},resetLayout:function B(){this.height=this.width="1px";this.parent.doLayout();}});}());(function(){mstrmojo.requiresCls("mstrmojo.func","mstrmojo.string","mstrmojo.Obj","mstrmojo.date","mstrmojo.hash","mstrmojo.array","mstrmojo.DI.DIHelpers","mstrmojo.architect.obj.Column","mstrmojo.architect.menu.EnumMenuActions","mstrmojo.warehouse.EnumDatabaseType","mstrmojo.warehouse.EnumDataChangeEvents","mstrmojo.warehouse.EnumNamespaceMode","mstrmojo.warehouse.EnumObjectTypes","mstrmojo.warehouse.obj.DBObjects","mstrmojo.warehouse.obj.DBRole","mstrmojo.DI.DIConstants");mstrmojo.requiresDescs(12934,5160,11426,11427,11429,11430,11436,11437,11432,11434,12935,12936,11442,12942,10068,12943,12944,12945,12946);var V=mstrmojo,O=V.func.wrapMethods,z=V.date,Y=V.hash,j=V.array,R=V.string,l=mstrmojo.DI.DIHelpers,F=V.architect.menu.EnumMenuActions,U=mstrmojo.warehouse.EnumDataChangeEvents,Z=U.DBTABLES_CHANGED,X=U.DBTABLES_REQUESTED,AB=3000,AN=mstrmojo.warehouse.EnumDatabaseType.SAPHana,e=mstrmojo.warehouse.EnumNamespaceMode.ALL,k=mstrmojo.warehouse.EnumNamespaceMode.CURRENT,K=232,AF=V.warehouse.EnumObjectTypes,AS=AF.ATTRIBUTE,G=AF.FACT,AG=AF.TABLE,AO=AF.COLUMN,r=AF.FORM,m=AF.LAYER,J=AF.DIMENSION,AA=AF.PROJECT,w=AF.TRANSFORMATION,o=AF.DBROLE,x=mstrmojo.DI.DIConstants;var AP={DssCatalogDefault:0,DssCatalogGetTables:1,DssCatalogGetColumns:2,DssCatalogGetTablePrimaryKeys:4,DssCatalogGetTableForeignKeys:8,DssCatalogGetTableKeys:12,DssCatalogGetTableSize:16,DssCatalogGetTableContent:32,DssCatalogGetColumnCardinality:64,DssCatalogGetColumnContent:128,DssCatalogGetFullCatalog:255,DssCatalogSelectedOnly:256,DssCatalogApplyConnectionMapping:512,DssCatalogAllNamespaces:1024,DssCatalogGetFresh:4096,DssCatalogIgnoreNamespace:8192,DssCatalogIgnoreCase:16384,DssCatalogIgnoreInvalidNames:32768,DssCatalogReuseMatching:65536,DssCatalogReuseCompatible:131072,DssCatalogReuseAny:262144,DssCatalogAugmentExisting:524288,DssCatalogSortDescending:1048576,DssCatalogSortTableNameFirst:2097152,DssCatalogGetNamespaces:16777216,DssCatalogCompareWithMetadata:134217728,DssCatalogTestConnectionOnly:536870912};var p={DssCatalogStateDefault:0,DssCatalogStateSelected:1,DssCatalogStateFresh:2,DssCatalogStateMissing:4,DssCatalogStateUnexpected:8,DssCatalogStateCompatibleSmaller:16,DssCatalogStateCompatibleLarger:32,DssCatalogStateCompatible:64,DssCatalogStateIncompatible:128,DssCatalogStateCompatibilityMask:240,DssCatalogStateFreshTables:256,DssCatalogStateMissingTables:512,DssCatalogStateFreshColumns:1024,DssCatalogStateMissingColumns:2048,DssCatalogStatePartitionMappingTable:65536,DssCatalogStateDummyPartitionMappingTable:131072,DssCatalogStateDummyPartitionSliceTable:262144};function h(AT){return R.decodeHtmlString(AT).replace(/&apos;/g,"'");}function L(){var AT=new Date();return" - "+[("00"+AT.getHours()).slice(-2),("00"+AT.getMinutes()).slice(-2),("00"+AT.getSeconds()).slice(-2)].join(":");}function N(AT){var AU=" ",AY="-",AZ=":",AX=AT.split(AU),AV=AX[0].split(AY),AW=AX[1].split(AZ);return new Date(Date.UTC(AV[0],parseInt(AV[1],10)-1,AV[2],AW[0],AW[1],AW[2]));}function u(AV,AU,AT){mstrApp.getRootController().getDataService()[AT||"submitRequest"](AV,AU);}function AD(AV,AU,AT){AU.showWait=AT;mstrApp.getRootController().getDataService().submitRequest(AV,AU);}function t(){mstrApp.serverProxy.cancelRequests();}function S(AT){var AV={},AU=[];j.forEach(AT,function(AW){AV[AW.propset]=AW.propset;AU.push(AW.propset+","+AW.prop);});return Y.valarray(AV).join(",,")+";"+AU.join(",,");}function q(AU){var AT=AU.ab;if(AT===0){AT=this.dbObjects.dbVersion2dbId[AU.db_ver];}return AT;}function B(AV,AU,AT){var AW=true;j.forEach(AT,function(AX){if(AX===AV){AW=false;return false;}});if(!AW){return false;}if(!AU||!AU.length){return true;}AW=false;j.forEach(AU,function(AX){if(AX===AV){AW=true;return false;}});return AW;}function AI(AV,AU,AT){if(l.getEnvObj().isWSDossierLocalMode()){AU.isAsynced=true;mstrApp.getRootController().dataService.catalogActionForLocalDossier(AV,AU,AT);}else{AU.taskId="arch.catalogAction";AD(AV,AU,false);}}function AQ(AU){var AT={success:function(AV){console.log(AV);console.log("success cancel");},failure:function(AV){console.log(AV);console.log("fail cancel");}};if(AU&&(AU.tid||AU.jid)){console.log("send cancel request to contoller");mstrApp.getRootController().dataService.killJob(AT,{threadId:AU.tid,jobid:AU.jid},"arch.KillJobCatalogAction");}}mstrmojo.warehouse.WHModel=mstrmojo.declare(mstrmojo.Obj,null,{scriptClass:"mstrmojo.warehouse.WHModel",schemaInstanceID:"",dbtbls:{},dbtables:[],cachedStamp:{},dbrs:[],dbObjects:undefined,namespaces:[],catalogStamp:"",SelDBRoleID:null,SelNameSpaceID:null,catalogRefresh:false,sourceInfo:undefined,privileges:{},dbRolesTypeFilter:[],dbRolesVersionFilter:[],dbmsTypeFilter:[],dbmsVersionFilter:[],dbRolesTypeExcludeFilter:[],dbRolesVersionExcludeFilter:[],dbmsTypeExcludeFilter:[],dbmsVersionExcludeFilter:[],dbObjectsDisplayOptions:1,dbObjectsConnectionType:1,showAddDriver:false,usingCookieNamespace:false,currentDBRole:undefined,allDBRoleNames:undefined,isSearching:false,searchedTableName:"",cas:undefined,tis:undefined,xrc:undefined,vldbProperties:undefined,propset:undefined,ns:undefined,did:undefined,clis:undefined,cln:undefined,dbRoleEditorCfg:{},databaseType:undefined,isDataImport:undefined,postCreate:function b(){this.dbObjects=new mstrmojo.warehouse.obj.DBObjects();if(mstrApp.isSingleTier){if(navigator.platform.indexOf("Win")===-1){this.dbObjectsConnectionType=2;this.showAddDriver=true;}return ;}this.loadPrivileges();},loadPrivileges:function H(AU){var AT=this;AD({success:function(AV){AT.privileges=AV.privileges;if(AU){AU();}}},{taskId:"arch.checkPrivileges",skipSchemaIDCheck:true},true);},loadDBTypeFilters:function C(AV){var AT=this;AT.dbObjects.populateDBProperties(O({success:function AU(){var AX=[],AW=AT.dbObjectsDisplayOptions;Y.forEach(AT.dbObjects.dbTypes,function(AY){if((AY.disp&AW)===AW){AX.push(AY.v);}});AT.dbmsTypeFilter=AX;AT.dbRolesTypeFilter=AX.slice(0);}},AV));},loadDBRoles:function D(Aa,AU){var AV=this,AZ;AV.raiseEvent({name:U.DBROLES_REQUESTED});if(l.getEnvObj().isAppSchema()){AV.dbRolesTypeFilter=j.filter(AV.dbRolesTypeFilter,function(Ab){return l.filterDisableSources(Ab);});}var AY={taskId:"arch.search",objecttypes:o,skipSchemaIDCheck:true,flags:1+2+256+512+8192+16384,domain:4,specialparse:"getDBRoles",xmlflags:1+2048,typeFilter:AV.dbRolesTypeFilter.join(","),versionFilter:AV.dbRolesVersionFilter.join(","),typeExcludeFilter:AV.dbRolesTypeExcludeFilter.join(","),versionExcludeFilter:AV.dbRolesVersionExcludeFilter.join(",")};var AT=O({success:function AX(Af,Ag){var Ab=[],Ae=AV.currentDBRole,Ad=0,Ai=(AV.dbIds&&AV.dbIds.length===1),Ac;j.forEach(Af.dbRoles,function(Aj,Ak){if(Ag){if(!B(Aj.db_type,AV.dbRolesTypeFilter,AV.dbRolesTypeExcludeFilter)||!B(Aj.db_ver,AV.dbRolesVersionFilter,AV.dbRolesVersionExcludeFilter)){return ;}}if(Ai){Ac=q.call(AV,Aj);if(Aj.ab===0&&(Ac===9||Ac===125)&&(AV.dbIds[0]===9||AV.dbIds[0]===125)){Ab.push(new mstrmojo.warehouse.obj.DBRole({mdDBRole:Aj,mdl:AV}));}else{if(AV.dbIds[0]===Ac||Aj.db_ver===-1){Ab.push(new mstrmojo.warehouse.obj.DBRole({mdDBRole:Aj,mdl:AV}));}else{if(AV.dbObjectsDisplayOptions===1&&Aj.ab===0&&Ac===undefined){Ab.push(new mstrmojo.warehouse.obj.DBRole({mdDBRole:Aj,mdl:AV}));}else{if(AV.dbObjectsDisplayOptions===16&&Aj.ab===0){Ab.push(new mstrmojo.warehouse.obj.DBRole({mdDBRole:Aj,mdl:AV}));}else{if(Aj.ab===0&&Aj.db_type===x.dbType.GOOGLE_BIGQUERY){Ab.push(new mstrmojo.warehouse.obj.DBRole({mdDBRole:Aj,mdl:AV}));}}}}}}else{Ab.push(new mstrmojo.warehouse.obj.DBRole({mdDBRole:Aj,mdl:AV}));}if(Ae&&Aj.did===Ae.did){Ad=Ak;}});AV.currentDBRole=undefined;AV.set("dbrs",Ab);AV.raiseEvent({name:U.DBROLES_LOADED,items:Ab,offset:Ad});AV.allDBRoleNames={};j.forEach(Af.allNames||[],function(Aj){AV.allDBRoleNames[Aj.did]=Aj;});var Ah=AV.findManagedDBR();if(AV.isNew===false&&(Ah||AV.dbridForDDA)){AV.fetchAndAppendSingleDBR(Ah||AV.dbridForDDA);}if(AV.defaultDbrId){mstrApp.getRootController().selectDBRole(AV.defaultDbrId);}}},Aa);if(AV.isDataImport!==undefined){AY.isDataImport=AV.isDataImport;}if(!mstrApp.isSingleTier&&!l.isServerBasedWS()&&mstrApp.placeholder==="QBApp"&&!AU&&AV.isDataImport){AZ=mstrApp.type;var AW=mstrmojo.qb.EnumQBAppType;if((AZ===AW.QueryBuilder||AZ===AW.FFSQL||AZ===AW.EmmaSingleTable)&&AV.dbObjectsDisplayOptions!==16&&AV.dbObjectsDisplayOptions!==4){if(mstrApp.dbRoles){AT.success(mstrApp.dbRoles,true);}else{mstrApp.serverRequestParallel(AY,AT,true);}return ;}}if(!mstrApp.isSingleTier&&!l.isServerBasedWS()&&AU&&mstrApp.dbRoles){mstrApp.dbRoles=undefined;if(mstrApp.container&&mstrApp.container.launchingApp){mstrApp.container.launchingApp.dbRoles=undefined;}}mstrApp.serverRequestQueue(AY,AT,mstrApp.taskQueue);},loadDBObjects:function W(AV){var AU=this.dbmsTypeFilter.slice(),AT=this.dbmsVersionFilter.slice();this.dbObjects.load(AU,AT,AV);},_set_SelDBRoleID:function g(AW,AV){var AU=this,AT=this.getDBRole(AV);AU.SelDBRoleID=AV;AU.SelNameSpaceID=undefined;if(AT&&AT.mdDBRole){AU.getNameSpaces({sourceInfo:AU.sourceInfo?AU.sourceInfo:"tablesPanel",getFresh:AU.catalogRefresh});AU.sourceInfo=undefined;AU.catalogRefresh=false;}else{if(!AV){AU.raiseEvent({name:Z,items:[],selectedItems:[],sourceInfo:""});AU.raiseEvent({name:U.NAMESPACES_CHANGED,namespaces:[],namespaceMode:k,dbRoleID:AV,error:true});}}AU.raiseEvent({name:U.DBROLE_SELECTION,value:AU.SelDBRoleID});},onSelNameSpaceIDChange:function A(AT){this.SelNameSpaceID=AT.value;this.getSelectedDBRoleTables({blockBegin:0,blockCount:1000,filterText:""},{failure:function AU(AW){if(AW){AW.getResponseHeader&&V.alert(AW.getResponseHeader("X-MSTR-TaskFailureMsg"));}}});var AV=window.localStorage;if(AV){AV.setItem(this.SelDBRoleID,this.SelNameSpaceID);}},getDBRole:function n(AU){var AV="00000000000000000000000000000000";var AT=j.find(this.dbrs,"did",(AU===AV)?this.projPrimaryDBRoleID:AU);if(AT>=0){return this.dbrs[AT];}return null;},cancelNameSpaces:function P(){t();this.raiseEvent({name:U.NAMESPACES_CANCELED,});},cancelLoadTables:function AH(){t();this.isSearching=false;this.raiseEvent({name:U.TABLES_CANCELED});},getNameSpaces:function AK(AY){var Aa=this,AT=AY.dbRoleID||Aa.SelDBRoleID,AX=AP.DssCatalogGetNamespaces|AP.DssCatalogApplyConnectionMapping,Ab=this.getDBRole(AT),AW=false,AU=false,AV=Ab&&Ab.mdDBRole&&Ab.mdDBRole.db_type,Ac;if(Ab&&Ab.mdDBRole&&!l.isdbRoleUsable(Ab.mdDBRole)){return ;}switch(AV){case 4000:AW=true;break;case 3000:AU=true;break;default:break;}if(AY.getFresh){AX=(AX|AP.DssCatalogGetFresh);}Aa.raiseEvent({name:Z,items:[],selectedItems:[],sourceInfo:AY.sourceInfo||""});Ac={success:function(Ad){Aa.namespaces=Ad.ns;Aa.raiseEvent({name:U.NAMESPACES_CHANGED,namespaces:AW?[]:Aa.namespaces,namespaceMode:e,dbRoleID:AT,namespace:Aa.SelNameSpaceID,sourceInfo:AY.sourceInfo||""});},failure:function(Ad){Aa.raiseEvent({name:U.NAMESPACES_CHANGED,namespaces:[],namespaceMode:k,dbRoleID:AT,sourceInfo:AY.sourceInfo||"",error:true});if(Ad){Ad.getResponseHeader&&V.alert(Ad.getResponseHeader("X-MSTR-TaskFailureMsg"));}},canceled:AQ};if(AU){Ac.success({ns:[]});return ;}if(!AW){Aa.raiseEvent({name:U.NAMESPACES_REQUESTED,sourceInfo:AY.sourceInfo||""});}var AZ={dbrid:AT,flags:AX};AI(Ac,AZ,U.NAMESPACES_CANCELED);},getSelectedDBRoleTables:function AC(Ak,AW){var AV=this,AU=Ak.getFresh||false,An=Ak.dbRoleID||AV.SelDBRoleID||AV.projPrimaryDBRoleID,Ab=AV.cachedStamp,AT=AV.dbtbls,Af=Ak.filterText.toString(),Am=AV.getDBRole(An),AX=arguments.callee;if(Am&&Am.mdDBRole&&!l.isdbRoleUsable(Am.mdDBRole)){return ;}if(!!AV.isSearching){AV.searchedTableName=Af;return ;}if(AU){AV.catalogRefresh=true;}if(!Am||Am.mdDBRole.db_type===AB){AV.raiseEvent({name:Z,items:[],selectedItems:[],sourceInfo:Ak.sourceInfo||""});return ;}var Ac=(AT[An]=AT[An]||{}),Ag=(Ab[An]=Ab[An]||{}),Ad=R.decodeHtmlString(Ak.nameSpace||AV.SelNameSpaceID||""),AZ=false,Ae=[],Ah=[],Aj,Aa=Ac[Ad],Ai=(Am.mdDBRole.db_type===AN);if(!AV.catalogRefresh&&Ac&&(Aa!==undefined)){Y.forEach(Aa,function(Aq,Ap){var Ao=(Af!==""&&Ap.toUpperCase().indexOf(Af.toUpperCase()));AZ=true;Aj=new mstrmojo.warehouse.obj.TableData({id:Ap,n:Ap,tp:AG,model:AV,ns:Aq.ns,did:Ap,sta:parseInt(Aq.sta,10),items:[],dbtn:Aq.tbn});if(Ai){Aj.extt=Aq.extt;Aj.hanai=Aq.hanai;}if(Ao!==false&&Ao>-1){Ae.push(Aj);}Ah.push(Aj);});if(AZ){AV.set("catalogStamp",Ag[Ad]);AV.raiseEvent({name:Z,items:(Af!=="")?Ae:Ah,selectedItems:AV.getDBRoleTablesInUse(An)||[],sourceInfo:Ak.sourceInfo||"",keyword:Af});if(AW&&AW.success){AW.success({items:(Af!=="")?Ae:Ah});}return ;}}Aa=(Ac[Ad]={});Ag[Ad]=null;var AY=AP.DssCatalogGetTables|AP.DssCatalogApplyConnectionMapping;AY=AV.catalogRefresh?(AY|AP.DssCatalogGetFresh):AY;AV.raiseEvent({name:X,sourceInfo:Ak.sourceInfo||""});AV.isSearching=true;var Al=O({success:function(Ar){var Ao=Ar.xrc.cas[0],Au=Ao.timestamp,Ap=Ao.tis,Aq,As;if(Au){var At=z.getDateJson(N(Au.replace(/&apos;/,"")));Au=[z.formatDateInfo(At,"yyyy-MM-dd")," ",z.formatTimeInfo(At,"hh:mm a")].join("");}Ag[Ad]=Au;AV.set("catalogStamp",Au);AV.catalogRefresh=false;j.forEach(Ap,function(Av){Aq=Av.tbn=h(Av.tbn);As=Av.ns=h(Av.ns);if(!Aa[Aq]){Aa[Aq]=Av;Ac[As]=Ac[As]||{};Ac[As][Aq]=Av;}});Y.forEach(Aa,function(Aw,Av){Aj=new mstrmojo.warehouse.obj.TableData({id:Av,n:Av,tp:AG,model:AV,ns:Aw.ns,did:Av,sta:parseInt(Aw.sta,10),items:[],dbtn:Aw.tbn});if(Ai){Aj.extt=Aw.extt;Aj.hanai=Aw.hanai;}Ah.push(Aj);});AV.raiseEvent({name:Z,items:Ah,selectedItems:AV.getDBRoleTablesInUse(An)||[],sourceInfo:Ak.sourceInfo||""});AV.isSearching=false;Ah.length>0&&AV.searchedTableName&&AX.call(AV,{filterText:AV.searchedTableName});AV.searchedTableName="";},failure:function(){AV.raiseEvent({name:Z,items:Ah,selectedItems:AV.getDBRoleTablesInUse(An)||[],sourceInfo:Ak.sourceInfo||""});AV.isSearching=false;AV.searchedTableName="";},canceled:AQ},AW);var Ak={dbrid:An,flags:AY,ns:Ad};AI(Al,Ak,U.TABLES_CANCELED);},getDBRoleTablesAndColumns:function AR(AU,AV){var AT=this;if(!AU.dbRoleID){return ;}AD(O({success:function(AZ){var AW=AZ.xrc.cas[0],AX=AW.tis,Ac=[],Ab={},AY,Aa;j.forEach(AX,function(Ad){Aa=h(Ad.ns);AY=h(Ad.tbn);Ac.push({n:(Aa?Aa+"."+AY:AY),tp:AG});j.forEach(Ad.clis,function(Ae){Ab[Ae.cln]={n:Ae.cln,tp:AO};});});AZ.tables=Ac;AZ.columns=Y.valarray(Ab);}},AV),{taskId:"arch.catalogAction",dbrid:AU.dbRoleID,flags:AP.DssCatalogGetTables+AP.DssCatalogGetColumns,ns:R.decodeHtmlString(AT.SelNameSpaceID||"")},true);},getDBRoleTablesInUse:mstrmojo.emptyFn,getColumnsForDBTable:function f(AY,Ac){var Ab=this,AT=AY.data.dbrole||Ab.SelDBRoleID,Aa=AY.data,AU=typeof AY.showCancel==="boolean"?AY.showCancel:true,AZ=AY.getFresh||false,Ag=R.decodeHtmlString(Aa.n.replace(/<strong>|<\/strong>/gi,"")),AX=Aa.ns,Ad=Aa.tableId,AW,AV=AP.DssCatalogGetColumns+AP.DssCatalogApplyConnectionMapping+AP.DssCatalogIgnoreCase+(AY.compareWithMD?AP.DssCatalogCompareWithMetadata:0),Af;Aa.n=Ag;if(AT){if(!AZ){if(AX){Af=Ab.dbtbls[AT][AX][Ag];AW=Af.columns;}else{Af=Ab.dbtbls[AT][Ag];if(Af){AW=Af.columns;}}if(AW){Ac.success({src:AY,items:AW,selDBRole:AT,hanaInfo:Af.hanaInfo});if(Ac&&Ac.complete){Ac.complete();}return ;}}AV=AZ?(AV|AP.DssCatalogGetFresh):AV;AD(O({success:function Ae(Ai){var Aj=Ai.xrc.cas[0].tis[0],Ah=[],Ak=Aj.hanai;AW=Aj.clis;j.forEach(AW,function(Al){Ah.push(new mstrmojo.architect.obj.Column({dbInfo:Al}));});Af=Ab.dbtbls[AT][AX][Ag];if(Ah.length>0){Af.columns=Ah;}Af.hanaInfo=mstrmojo.hash.clone(Ak);Ai.items=Ah;Ai.hanaInfo=Af.hanaInfo;}},Ac),{taskId:"arch.catalogAction",dbrid:AT,schemaid:Ab.schemaInstanceID,ns:AX,dbts:JSON.stringify([{tbn:Aa.dbtn,ns:AX,tbid:Ad}]),flags:AV},AU);}},saveDBRole:function I(AU,AT,AX){var AV=this;AD(O({success:function AW(AZ){if(!AT){var AY=AV.getDBRole(AZ.dbr.did);AY.populated=false;AY.populate(function Aa(){AV.raiseEvent({name:AT?U.DBROLES_ADD:U.DBROLES_RENAME,item:AY});});}else{AV.currentDBRole=AZ.dbr;AV.loadDBRoles(undefined,true);}}},AX),{skipSchemaIDCheck:true,taskId:"arch.saveDBRole",dbroleinfo:JSON.stringify(AU),showWait:true},true);},deleteDBRole:function M(AU,AW){var AT=this;AD(O(AW,{success:function AV(){var AX=j.find(AT.dbrs,"did",AU);if(AX>-1){AT.dbrs.splice(AX,1);}delete AT.allDBRoleNames[AU];if(AT.SelDBRoleID===AU){AT.set("SelDBRoleID",AT.projPrimaryDBRoleID);}AT.raiseEvent({name:U.DBROLES_DELETE,item:{did:AU}});}}),{taskId:"arch.deleteObject",schemaid:AT.schemaInstanceID,objectid:AU,objecttype:29,showWait:true},true);},populateDBRole:function d(AT,AU){AD(AU,{isDataImport:false,reverseOrder:true,verbose:true,taskId:"getDBInstances",vldbProperties:S(this.dbObjects.preferences.vldbProperties),objectID:AT,skipSchemaIDCheck:true,showWait:false},false);},handleEnabledAction:function E(AU,AT){if(!AT){return true;}return true;},handleVisibleAction:function AE(AV,AU){if(!AU){return true;}switch(AU.action){case F.SET_AS_PRIMARY:return mstrApp.isArchitect&&!AV.isPrimary;case F.IS_PRIMARY:return mstrApp.isArchitect&&AV.isPrimary;case F.UPSTRUCT:return true;case F.CATALOG_SQL:var AT=this.getDBRole(AV.did);return(mstrApp.getRootController().canDisplayCatalogSQL(this.dbObjects.dbTypes,AT.mdDBRole.db_type));case F.SHARE:return !AU.isManaged&&!mstrApp.isSingleTier&&mstrApp.getRootController().hasPrivilege(K);case F.DUPLICATE:return !AU.isManaged;}return true;},handleCheckAction:function AM(AU,AT){switch(AT.action){case F.IS_PRIMARY:return AU.isPrimary;}return false;},findNameInHash:function a(AW,AT){var AV=false,AU="";Y.forEach(AW,function(AX){AU=AX.name||AX.n;if(AU.toString().toUpperCase()===AT){AV=true;return false;}return true;});return AV;},validateName:function c(Ab,Aa,AT,AX){var AV=this,Ad=10000,AW={},Ae,AU,AZ=V.desc(12934,"Object names need to be less than 250 characters"),AY=V.desc(5160,'An object name cannot contain the following characters " \\ [ ]');switch(Ab){case AS:case r:AW=AV.getAttributes();Ae=V.desc(11426,"The attribute name cannot be empty.");AU=V.desc(11427,"The name is currently in use by another attribute.");break;case G:AW=AV.getFacts();Ae=V.desc(11429,"The fact name cannot be empty.");AU=V.desc(11430,"The name is currently in use by another fact.");break;case AG:AW=AV.tables;Ae=V.desc(11436,"The table name cannot be empty.");AU=V.desc(11437,"The name is currently in use by another table.");break;case m:AW=AV.layers;Ae=V.desc(11432,"The layer name cannot be empty.");AU=V.desc(11434,"The name is currently in use by another layer.");break;case J:AW=AV.userHierarchies;Ae=V.desc(12935,"The hierarchy name cannot be empty.");AU=V.desc(12936,"The name is currently in use by another hierarchy.");break;case AA:AW=AX;Ae=V.desc(11442,"The project name cannot be empty.");AU=V.desc(12942,"The project name already exists.");break;case o:AW=AV.allDBRoleNames;j.forEach(AV.dbrs,function(Af){AW[Af.did]=Af;});Ae=V.desc(10068,"The Database Connection name can't be empty");AU=V.desc(12943,"The database connection name already exists.");break;case w:AW=AV.transformations;Ae=V.desc(12944,"The transformation name cannot be empty.");AU=V.desc(12945,"The transformation name already exists.");break;default:V.alert(V.desc(12946,"object type cannot be validated, it's not defined yet"),undefined,undefined,Ad);return false;}if(Aa===""){V.alert(Ae,undefined,undefined,Ad);return false;}if(AT){if(AT.toString().toUpperCase()===Aa.toString().toUpperCase()){return true;}}if(Aa.length>250){V.alert(AZ,undefined,undefined,Ad);return false;}var Ac=/[\[\]\\"]/;if(Ac.test(Aa)){V.alert(AY,undefined,undefined,Ad);return false;}if(this.findNameInHash(AW,Aa.toUpperCase())){V.alert(AU,undefined,undefined,Ad);return false;}return true;},findinArray:function AL(AU,AZ,AV){var AX=AV.toUpperCase(),AT=(AU&&AU.length)||0,AW,AY;for(AW=0;AW<AT;AW++){AY=AU[AW];if(AY&&AY[AZ].toUpperCase()===AX){return AW;}}return -1;},findNextName:function AJ(AU,AW,AY){AU+=(L());var AV=1,AT=AU,AX=AT.toUpperCase();do{if(this.findinArray(AW,AY,AX)>=0){AT=AU+" "+AV++;AX=AT.toUpperCase();}else{return AT;}}while(AV<100);return"Temp Object";},findManagedDBR:function(){var AV,AT,AW;var AU=mstrApp.getRootController().model;AV=j.filter(AU.bindingT?AU.bindingT:[],function(AX){return AX.oi.did===AU.tableID;});if(AV.length&&AV[0].oi.def&&AV[0].oi.def.dbt&&AV[0].oi.def.dbt.did){AT=j.filter(AU.bindingT?AU.bindingT:[],function(AX){return AX.oi.did===AV[0].oi.def.dbt.did;});}if(AT&&AT.length){AW=AT[0].oi.def&&AT[0].oi.def.dbr&&AT[0].oi.def.dbr.did;}return AW;},fetchAndAppendSingleDBR:function(AU){var AT=this;if(AU&&j.find(AT.dbrs,"did",AU)===-1){mstrApp.getRootController().getDataService().getSingleDBRole({success:function(AW){var AV=typeof (AW.dbr)==="object"?AW.dbr:JSON.parse(AW.dbr);var AX=AV.dbRoles[0];AT.dbrs.push(new mstrmojo.warehouse.obj.DBRole({mdDBRole:AX,mdl:AT,isManagedDBR:true}));AT.set("currentDBRole",AX);AT.raiseEvent({name:U.DBROLES_REQUESTED});AT.raiseEvent({name:U.DBROLES_LOADED,items:AT.dbrs,offset:AT.dbrs.length-1,isManagedDBR:true});AT.allDBRoleNames[AX.did]=AX;}},{dbrId:AU});}}});var Q=mstrmojo.warehouse.WHModel;Q.DssCatalogFlags=AP;Q.DSSCatalogStateFlags=p;}());(function(){mstrmojo.requiresCls("mstrmojo.array","mstrmojo.hash","mstrmojo.css","mstrmojo.string","mstrmojo.dom","mstrmojo.Popup","mstrmojo.List","mstrmojo.DropDownButton");var B=mstrmojo.dom;mstrmojo.Pulldown=mstrmojo.declare(mstrmojo.DropDownButton,null,{scriptClass:"mstrmojo.Pulldown",cssClass:"mstrmojo-Pulldown",items:null,itemIdField:"dssid",itemField:"n",itemCSS:"css",itemTitleField:null,defaultSelection:0,defaultText:null,title:"",value:null,popupToBody:false,popupCssClass:"",popupZIndex:null,fixWidth:false,fixHeight:false,allowHTML:false,_set_items:function(H,F){var G=this.items;this.items=F||[];return G!==this.items;},markupMethods:mstrmojo.hash.copy({onvalueChange:function(){var G=this.value,F=this.selectedIndex,I=this.items||[],J,H;if(F===undefined||(G!==null&&(F===-1||(F!==-1&&I[F]&&I[F][this.itemIdField]!==G)))){F=mstrmojo.array.find(I,this.itemIdField,G);F=(F>-1)?F:this.defaultSelection;this.selectedIndex=F;}else{if(G===null){this.selectedIndex=this.defaultSelection;}}this.selectedItem=J=I[this.selectedIndex];if(J){H=J[this.itemField];}else{H=this.defaultText||"";}this.set("text",H);}},mstrmojo.hash.copy(mstrmojo.DropDownButton.prototype.markupMethods)),prevalueChange:function D(){var G=this.value,F=-1;if(G!==null){F=mstrmojo.array.find(this.items,this.itemIdField,G);}if(F>-1){this.selectedItem=this.items[F];this.selectedIndex=F;}},togglePopup:function E(){if(this.popupToBody){var I=B.position(this.popupNode,true),H=this.popupRef,F={left:Math.round(I.x)+"px",top:Math.round(I.y)+"px"};if(!H.hasRendered){delete H.slot;F.placeholder=document.body.appendChild(document.createElement("div"));}this.popupOpenConfig=this.popupOpenConfig||{};mstrmojo.hash.copy(F,this.popupOpenConfig);}else{this.popupRef.slot="popupNode";}if(this._super){this._super();}var G=this.popupRef.domNode;if(G){if(this.fixWidth){G.style.width=(this.domNode.offsetWidth-2)+"px";}else{G.style.minWidth=(this.domNode.offsetWidth-2)+"px";}}},premousedown:function A(F){if(B.getButton(F.hWin,F.e)===B.MOUSE_BUTTON.LEFT){this.togglePopup();}},unrender:function C(F){var G=this.popupRef;if(this.popupToBody&&G.hasRendered){G.unrender(false);}if(this._super){this._super(F);}},itemName:function(H,F,G){return this.allowHTML?H[G.itemField]:mstrmojo.string.encodeHtmlString(H[G.itemField]);},popupRef:{scriptClass:"mstrmojo.Popup",slot:"popupNode",cssClass:"mstrmojo-Pulldown-Popup",autoCloses:false,modal:false,autoClose:true,locksHover:true,adjustSize:function(){var G=this.opener,F=this.domNode;if(G&&G.fixWidth){mstrmojo.css.addClass(F,["fix-width"]);}if(G&&G.fixHeight){mstrmojo.css.addClass(F,["fix-height"]);}},onOpen:function(){var H=this.opener,G=H&&H.popupZIndex,I=(H&&H.popupCssClass)||"",F=this.domNode;if(G){F.style.zIndex=G;}if(I){mstrmojo.css.addClass(F,[I]);}this.adjustSize();},children:[{scriptClass:"mstrmojo.List",alias:"list",itemMarkupFunction:function(I,F,G){var H=I[G.itemCSS]||G.parent.opener.item2textCss&&G.parent.opener.item2textCss(I)||"",J=G.parent.opener.itemName;return'<div class="mstrmojo-Pulldown-listItem"><div class="mstrmojo-text '+H+'" title="'+I[G.itemTitleField||G.itemField]+'">'+(J(I,F,G)||"&nbsp;")+"</div></div>";},renderOnScroll:false,bindings:{itemIdField:"this.parent.opener.itemIdField",itemField:"this.parent.opener.itemField",itemCSS:"this.parent.opener.itemCSS",itemTitleField:"this.parent.opener.itemTitleField",items:"this.parent.opener.items",selectionPolicy:"this.parent.opener.selectionPolicy",selectedIndex:"this.parent.opener.selectedIndex"},onmousedown:function(){this.parent.close();},onchange:function(){var H=this.parent,I=H.visible,F=H.opener,G=this.selectedItem;if(!F||!G||!I){return ;}F.set("value",G[this.itemIdField]);}}]}});}());(function(){mstrmojo.requiresCls("mstrmojo.Box","mstrmojo.StackContainer");mstrmojo.MouseOverContainer=mstrmojo.declare(mstrmojo.StackContainer,null,{scriptClass:"mstrmojo.MouseOverContainer",markupString:'<div id="{@id}" class="mstrmojo-Box {@cssClass}" style="{@cssText}" mstrAttach:mouseover,mouseout></div>',doSwitch:true,mouseoverItem:null,mouseoutItem:null,init:function(A){this._super(A);if(this.setupSelectedItem){this.setupSelectedItem();}},markupSlots:{containerNode:function(){return this.domNode;}},markupMethods:{onvisibleChange:function(){this.domNode.style.display=this.visible?"block":"none";}},onmouseover:function(){if(this.doSwitch&&this.enabled){this.set("selected",this.mouseoverItem);}},onmouseout:function(){if(this.doSwitch){this.set("selected",this.mouseoutItem);}},preBuildRendering:function(){this.set("selected",this.mouseoutItem);}});}());(function(){mstrmojo.requiresCls("mstrmojo.ui.PopupButton","mstrmojo._HasLayout");mstrmojo.ui.editors.controls.PreviewButton=mstrmojo.declare(mstrmojo.ui.PopupButton,[mstrmojo._HasLayout],{scriptClass:"mstrmojo.ui.editors.controls.PreviewButton",markupString:'<div id="{@id}" class="mstrmojo-ui-PreviewButton {@cssClass}" style="{@cssText}"><div class="cf" mstrAttach:click><div class="preview"></div><div class="btn">&nbsp;</div></div><div class="host"></div></div>',markupSlots:{previewNode:function(){return this.domNode.firstChild.firstChild;},btnNode:function(){return this.domNode.firstChild.lastChild;},widgetHostNode:function(){return this.domNode.lastChild;},clickableNode:function(){return this.domNode.firstChild;}},markupMethods:{onvisibleChange:mstrmojo.Widget.visibleMarkupMethod},layoutConfig:{h:{previewNode:"100%",btnNode:"100%",widgetHostNode:"0px"},w:{previewNode:"100%",btnNode:"20px",widgetHostNode:"all"},xt:true},isHostedWithin:false,getLayoutOffsets:function B(){return{h:2,w:2};},anchorSlot:"clickableNode",updatePreview:function C(){throw new Error(this.scriptClass+" must implement updatePreview.");},getPopupHostNode:function A(){return this.widgetHostNode;}});}());(function(){mstrmojo.requiresCls("mstrmojo.locales","mstrmojo.tooltip","mstrmojo.dom","mstrmojo.css","mstrmojo.array","mstrmojo.hash","mstrmojo.string");mstrmojo.requiresDescs(11038,11935,11936,11937,11856,11938,13138,13230,13260,14633,14636);var C=mstrmojo.hash.copy,P=mstrmojo.css,J=mstrmojo.dom,N=mstrmojo.array,E=mstrmojo.string,Q=function Q(W,U){if(!W){return ;}var S=U&&U.length||0,V;for(V=S;V>0;V--){W=W.replace(new Array(V+2).join("#"),U[V-1]);}return W;},L=function L(U){if(!U){return ;}var a=this,W=J.position(U.refNode||a.refNode),Z=J.position(a.domNode),Y=U.position||R.RIGHT,V=0,b=0,S=9+(U.margin!==undefined?U.margin:0),X=" ";switch(Y){case R.TOP:b=-Z.h-S;X+="t";break;case R.BOTTOM:b=W.h+S;X+="b";break;case R.LEFT:V=-Z.w-S;X+="l";break;case R.RIGHT:V=W.w+S;X+="r";break;}mstrmojo.hash.forEach(C(U,{left:V,top:b,contentNodeCssClass:X,visible:false}),function(c,d){this[d]=c;},this);this.set("visible",U.invalid);},A=function A(S){var X=this,V,W=S.errorCode,Y=S.errorMsg,U=S.args,Z=mstrmojo.vi.ui.rw.selectors.EnumWarningMessages;if(S.invalid){V={content:W!==null?(X.generateContentHTML(Q(Z[W],U))||Z["*"]):Y};}return V;};mstrmojo.vi.ui.rw.selectors.EnumWarningMessages=C(mstrmojo.locales.validation,{"*":mstrmojo.desc(11038,"Invalid"),invalidValueVIWarning:mstrmojo.desc(11935,"Invalid characters"),emptyValueVIWarning:mstrmojo.desc(11936,"Please enter a number"),notIntegerVIWarning:mstrmojo.desc(11937,"Please enter an integer"),outOfRangeVIWarning:mstrmojo.desc(11856,"Please enter value between ## and ###."),noMultiSelectionVIWaring:mstrmojo.desc(11938,"This selector does not support multiple selections."),continuousSelectionVIWaring:mstrmojo.desc(13138,"This selector does not support non-continuous selections."),bigDecimalMetricSliderVIWaring:mstrmojo.desc(13230,"Cannot qualify on big decimal value. Please change qualification type to Rank"),unableDisplaySelectionVIWarning:mstrmojo.desc(13260,"Filter cannot display actual selections."),imageSizeExceedLimitVIWarning:mstrmojo.desc(14633,"Cannot embed an image larger than ##MB. Your image is still ###MB after compression. Enter a URL to the image instead."),imageFileTypeNotSupportedVIWarning:mstrmojo.desc(14636,"Invalid image format. Please use .png, .jpg, .jpeg, .gif or .bmp."),imageOverSizeNoCompessionVIWarning:mstrmojo.desc(14665,"Cannot embed an image larger than ##MB. Enter a URL to the image instead.")});mstrmojo.vi.ui.rw.selectors.EnumWarningPosition={TOP:1,BOTTOM:2,LEFT:3,RIGHT:4};var R=mstrmojo.vi.ui.rw.selectors.EnumWarningPosition;mstrmojo.vi.ui.rw.selectors._HasWarningMessage=mstrmojo.provide("mstrmojo.vi.ui.rw.selectors._HasWarningMessage",{_mixinName:"mstrmojo.vi.ui.rw.selectors._HasWarningMessage",warningSlotName:"warning",showWarning:function G(V){var Z=this,b=Z.warningSlotName,d=Z[b],S=V&&V.lasting||6000,Y=V.refNode||this.domNode,U=V.highlight!==false,c=V.closeOnClick===false?false:true,a;if(!d){d=new mstrmojo.Tooltip({refNode:Y,highlight:U,closeOnClick:c,updatePopupConfig:null,cssClass:"vi-warning vi-tooltip-V"});Z.addDisposable(d);Z[b]=d;a=Z.closeOnClick=Z.getCloseOnClickListener();J.attachEvent(document.body,"click",a);}var X=V.position||R.TOP,W="vi-warning vi-tooltip-";switch(X){case R.TOP:d.cssClass=W+"V";break;case R.BOTTOM:d.cssClass=W+"A";break;case R.LEFT:d.cssClass=W+"D";break;case R.RIGHT:d.cssClass=W+"C";break;}d.open(Z,A.call(Z,V));this.adjustPosition(V);if(U){P.toggleClass(d.refNode,"mstrmojo-Warning",true);}window.clearTimeout(Z._warningTimeOut);Z._warningTimeOut=window.setTimeout(function(){Z.hideWarning();},S);},hideWarning:function H(){var U=this,S=U[U.warningSlotName];if(S&&S.visible&&S.close){if(S.highlight){P.toggleClass(S.refNode,"mstrmojo-Warning",false);}S.close();window.clearTimeout(U._warningTimeOut);delete U._warningTimeOut;}},getCloseOnClickListener:function I(){var S=this;return function(){var U=S[S.warningSlotName];if(U.closeOnClick){S.hideWarning();}};},adjustPosition:function M(S){var U=this;L.call(U[U.warningSlotName],S);},generateContentHTML:function D(S){return E.encodeHtmlString(S,true);},bindWarningHandler:function F(){N.forEach(arguments,function S(V){if(!V||!V.attachEventListener){return ;}var W=V._validationEventListener,U;if(W){V.detachEventListener(W);delete V._validationEventListener;}U=this.getValidationEvtListener();if(U){V._validationEventListener=V.attachEventListener("validationChange",this.id,U);}},this);},getValidationEvtListener:function B(){var U=this;return function S(V){var W=V.value;U[(W&&W.invalid?"show":"hide")+"Warning"](W);};},unrender:function K(S){var U=this[this.warningSlotName];if(U){U.unrender();}this._super(S);},destroy:function O(S){J.detachEvent(document.body,"click",this.closeOnClick);return this._super(S);}});}());(function(){mstrmojo.requiresCls("mstrmojo.string","mstrmojo.dom","mstrmojo.css","mstrmojo.array","mstrmojo.tooltip");var E=mstrmojo.dom,D=mstrmojo.string,F=mstrmojo.hash,H=mstrmojo.array,C=mstrmojo.tooltip;mstrmojo.ui._HasListTooltip=mstrmojo.provide("mstrmojo.ui._HasListTooltip",{_mixinName:"mstrmojo.ui._HasListTooltip",tooltipOrientation:"horizontal",tooltipOffset:8,tooltipMarkup:'<div class="content" style="{@style}">{@c}</div>',tooltipCss:{},tooltipContrast:false,getTooltipText:function A(I){return I&&(D.encodeHtmlString(I.ttp,true)||D.encodeHtmlString(I.n,true));},showTooltip:function G(a,N){var Q=this;if(!Q.hasOpenTooltip&&!(Q._lastOpened&&Q._lastOpened.visible)){var g=E.eventTarget(N,a),b=Q.getItemFromTarget(g),V=Q.getItemNodeFromTarget(g),j=Q.getTooltipText(b),P=Q.tooltipCss;if(!j||b.ttpDisabled){return ;}if(Q.showTooltipForLargeText){if(V.offsetWidth>=V.scrollWidth){return ;}}var h=E.position(V),Z,R,L,X="",Y=Q.tooltipOffset,O=(b&&b.ctxt)||{};if(this.tooltipOrientation==="vertical"){Z=h.x+h.w/2;L=O.posType||C.POS_TOPCENTER;R=h.y+h.h+Y;var M="mojo-theme-light vi-regular vi-tooltip-A";if(!O.posType){M+=" A-center";}Q.tooltipCss=F.copy({cssClass:M},P);}else{var K=E.windowDim(),W=40,c=h.x+h.w+Y,J=h.x-Y,f=J-W,I=K.w-(c+W),d="vi-regular vi-tooltip-",U;R=h.y;if(I>=f){Z=c;U=I;L=O.posType||C.POS_TOPLEFT;P.cssClass=d+"C "+P.rightCssClass;}else{Z=J;U=f;L=O.posType||C.POS_TOPRIGHT;P.cssClass=d+"D "+P.leftCssClass;}X="max-width: "+U+"px;";}if(Q.tooltipContrast){P.cssClass=P.cssClass+" contrast";}if(P&&P.getItemCssClass){P.cssClass=H.filter([P.cssClass,P.getItemCssClass(b)],function(e){return !!e;}).join(" ");}var S=Q.richTooltip=F.copy(Q.tooltipCss,{content:D.apply(Q.tooltipMarkup,{c:j,style:X}),top:R,left:Z,posType:L});if(Q.itemDisabled){S.cssClass+=" vi-warning";}if(O.hoverable){S.enableHover=true;}if(O.posType==="TL"){S.left=h.x;}S.keepArrowXPos=!!Q.keepArrowXPos;S.keepArrowYPos=!!Q.keepArrowYPos;this._super(a,N);}},onclick:function B(I){var J=this;window.setTimeout(function(){if(J.hasOpenTooltip){J.hideTooltip();}window.clearTimeout(J._tooltipTimeOut);},0);this._super(I);}});}());(function(){mstrmojo.requiresCls("mstrmojo.ui.PopupWidget","mstrmojo.ui.menus._IsMenuPopup","mstrmojo.css");mstrmojo.ui.menus.MenuPopup=mstrmojo.declare(mstrmojo.ui.PopupWidget,[mstrmojo.ui.menus._IsMenuPopup],{scriptClass:"mstrmojo.ui.menus.MenuPopup",popupConfig:null,init:function B(E){this._super(E);var C=this.popupConfig;if(!C.contents){throw new Error("Cannot open popup without contents.");}var D=["mstrmojo-ui-MenuPopup"],F=C.cssClass;if(F){D.push(F);}if(C.hasToggleItem){D.push("hasToggleItem");}mstrmojo.css.addWidgetCssClass(this,D);this.addChildren(C.contents);},shouldPropagateLockHover:function A(){return false;}});}());(function(){mstrmojo.requiresCls("mstrmojo.Container","mstrmojo.func","mstrmojo.array","mstrmojo.Button","mstrmojo.HBox","mstrmojo.dom","mstrmojo.Box");var D=mstrmojo.dom;mstrmojo.Dialog=mstrmojo.declare(mstrmojo.Container,null,{scriptClass:"mstrmojo.Dialog",title:"",buttons:null,alignment:"center",btnAlignment:"right",zIndex:10,modal:true,markupString:'<div id="{@id}" class="mstrmojo-Dialog {@cssClass}" style="z-index: 1100;" tabindex="0" mstrAttach:click><div class="win mstrmojo-Editor" style="{@cssText}"><div class="mstrmojo-Editor-titlebar"><div class="mstrmojo-Editor-title">{@title}</div></div><div class="mstrmojo-Editor-content"></div><div class="mstrmojo-Editor-buttons"></div></div><div class="mstrmojo-Editor-curtain"></div><div class="mstrmojo-Editor-tip"></div></div>',markupSlots:{editorNode:function(){return this.domNode.firstChild;},curtainNode:function(){return this.domNode.childNodes[1];},titleNode:function(){return this.domNode.firstChild.firstChild;},containerNode:function(){return this.domNode.firstChild.childNodes[1];},buttonNode:function(){return this.domNode.firstChild.lastChild;},tipNode:function(){return this.domNode.lastChild;}},editorNode:null,btnHbox:null,markupMethods:{onzIndexChange:function(){this.editorNode.style.zIndex=this.zIndex;this.curtainNode.style.zIndex=this.zIndex-1;},onwidthChange:function(){this.editorNode.style.width=this.width||"auto";},onvisibleChange:function(L){if(L){return ;}var J=this.visible,K=J?"block":"none";this.editorNode.style.display=K;if(this.modal){this.curtainNode.style.display=K;}},onleftChange:function(){this.editorNode.style.left=this.left||"";},ontopChange:function(){this.editorNode.style.top=this.top||"";},ontitleChange:function(){this.titleNode.firstChild.innerHTML=this.title||"";}},preBuildRendering:function F(){var J;var K=this.buttons;if(K&&!this.btnHbox){for(J in K){K[J].cssClass=(K[J].cssClass||"")+(this.noButtonCls?"":" mstrmojo-Editor-button");}this.addChildren([{scriptClass:"mstrmojo.HBox",cssText:"float:"+this.btnAlignment,slot:"buttonNode",alias:"btnHbox",children:K},{scriptClass:"mstrmojo.Label",cssClass:"mstrmojo-clearMe",slot:"buttonNode"}]);}if(this.modal){this.cssClass+=" modal";}return this._super();},buildRendering:function B(){var J=this.placeholder;if(this._super()){if(!this.parent&&!J){document.body.appendChild(this.domNode);}return true;}return false;},getResizeHandler:function E(){var J=this.id;return function(){var K=mstrmojo.all[J];K.resizeDialog();K.positionDialog();};},postBuildRendering:function A(){this._super();if(this.modal&&this.visible){this.curtainNode.style.display="block";}if(!this._resizeHandler){var K=this._resizeHandler=this.getResizeHandler();D.attachEvent(window,"resize",K);}this.resizeDialog();this.positionDialog();try{this.domNode.focus();}catch(J){}return true;},resizeDialog:function G(){if(this.modal){this.resizeCurtain();}},resizeCurtain:function C(){var K=this,O=K.curtainNode,J=document.body,M=document.documentElement,N=O.style,L=K.curtainPosition;N.width=Math.max(J.clientWidth,M.scrollWidth)+"px";if(L&&L.h){N.height=L.h+"px";}else{N.height=Math.max(J.clientHeight,M.scrollHeight)+"px";}if(L&&L.y){N.top=L.y+"px";}K.raiseEvent({name:"resizeCurtain"});},positionDialog:function H(){var K=this.editorNode,M=this.left,L=this.top;if(!M||!L){D.center(K);var J=K.style;if(this.alignment==="top"){J.top="10px";}if(M){J.left=M;}if(L){J.top=L;}}},destroy:function(K){var J=this._resizeHandler;if(J){D.detachEvent(window,"resize",J);}this._super(K);}});mstrmojo.toast=function I(O,M,Q,J){var P="mojoToast9",N,L=M||3000;if(J&&J.id){P=J.id+"-"+P;}try{mstrmojo.all[P].destroy();}catch(K){}mstrmojo.insert({id:P,scriptClass:"mstrmojo.Label",cssClass:(J&&J.cssClass)?J.cssClass:"toastCss",text:O}).render();N=mstrmojo.all[P].domNode;if(J&&J.dom){J.dom.appendChild(N);}else{document.body.appendChild(N);D.bottomCenter(N);}window.setTimeout(function(){if(Q){Q();}try{mstrmojo.all[P].destroy();}catch(R){}},L);};mstrmojo.mask={show:function(){var J=mstrmojo.mask.win=mstrmojo.insert({scriptClass:"mstrmojo.Box",cssClass:"fullscreen-mask"});J.render();document.body.appendChild(J.domNode);},hide:function(){mstrmojo.mask.win.destroy();}};}());(function(){mstrmojo.requiresCls("mstrmojo.Box","mstrmojo.dom","mstrmojo.css");var A=mstrmojo.css;var I=mstrmojo.dom;function B(K){var M=document.createElement("div"),L=M.style,J=K.domNode;M.className="mstrmojo-qb-VSplitPanel-avatar";L.width=J.clientWidth+"px";J.appendChild(M);K.avatar=M;return M;}mstrmojo.qb.VSplitPanel=mstrmojo.declare(mstrmojo.Box,[mstrmojo._HasLayout],{scriptClass:"mstrmojo.qb.VSplitPanel",draggable:true,dropZone:false,width:0,topP:40,topItemVisible:true,bottomItemVisible:true,borderoffset:0,marginSpan:20,minSpan:80,markupString:'<div id="{@id}" class="mstrmojo-VSplitPanel {@cssClass}" style="{@cssText}" mstrAttach:mouseup,mousemove ><div></div><div style="padding-top:{@marginSpan}px;"><div class="mstrmojo-qb-VSplitPanel-resizeHandle" style="width:{@width};height:{@marginSpan}px;margin-top:-{@marginSpan}px"></div></div></div>',markupSlots:{topItem:function(){return this.domNode.children[0];},bottomItem:function(){return this.domNode.children[1];}},children:[{scripClass:"mstrmojo.Box",slot:"topItem"},{scripClass:"mstrmojo.Box",slot:"bottomItem"}],getDragData:function H(J){var K=J.src,M=K.node;if(M.className&&M.className.indexOf("mstrmojo-qb-VSplitPanel-resizeHandle")>=0){var L=I.position(this.domNode);return{node:M,x:L.x,y:L.y,h:L.h,w:L.w};}else{if(this._super){return this.dropZone&&this._super(J);}}return null;},allowDrop:function E(J){var K=J.src,L=K&&K.data;if(L&&L.node){return true;}else{return this.dropZone;}},ondragmove:function F(J){var L=J.src,N=L&&L.data;if(N&&N.node){var K=J.tgt,M=this.avatar;if(M){M.style.top=Math.min(Math.max(N.y+this.minSpan,K.pos.y),N.y+N.h-this.minSpan)+"px";}}},isDragValid:function G(J){var K=J.src,L=K&&K.data;return !!(L&&L.node);},ondragstart:function C(J){var K=J.src,M=K&&K.data;var L=this.avatar||B(this);this.ownAvatar=true;L.style.top=Math.max(M.y,K.pos.y)+"px";L.style.left=M.x+"px";L.style.display="block";L.style.zIndex="9999";L.style.width=M.w+"px";},ondragend:function D(J){var M=J.src,O=M&&M.data;if(O&&O.node){var N=this.avatar;if(N){N.style.display="none";var K=parseInt(N.style.top)-O.y,L=this.domNode.clientHeight;this.topP=K*100/L;this.layoutConfig.h={topItem:this.topP+"%",bottomItem:100-this.topP+"%"};this.doLayout();}this.ownAvatar=false;}else{if(this._super){this._super(J);}}},layoutConfig:{w:{topItem:"100%",bottomItem:"100%"},h:{topItem:"40%",bottomItem:"60%"}},afterLayout:function(){if(this.domNode){var K=this.domNode.children[1].children[0].style;if(this.topItemVisible&&this.bottomItemVisible){K.display="block";this.children[0].set("visible",true);this.children[1].set("visible",true);K.width=this.width;var J=parseInt(this.children[0].height);this.children[0].set("height",J+"px");this.bottomItem.style.height=parseInt(this.height)-J-this.marginSpan+"px";this.children[1].set("height",this.bottomItem.style.height);}else{K.display="none";if(this.topItemVisible){this.children[0].set("width",this.width);this.children[1].set("visible",false);}else{this.children[1].set("width",this.width);this.children[0].set("visible",false);}}}},_set_topItemVisible:function(L,J){if(this.topItemVisible!=J){this.topItemVisible=J;if(J){this.layoutConfig.h={topItem:this.topP+"%",bottomItem:100-this.topP+"%"};if(this.bottomItem){var K=this.bottomItem;K.style["padding-top"]=this.marginSpan+"px";}}else{this.layoutConfig.h={topItem:"0%",bottomItem:"100%"};if(this.bottomItem){var K=this.bottomItem.parentNode;K.style["padding-top"]="0px";}}this.doLayout();}},_set_bottomItemVisible:function(K,J){if(this.bottomItemVisible!=J){this.bottomItemVisible=J;if(J){this.layoutConfig.h={topItem:this.topP+"%",bottomItem:100-this.topP+"%"};}else{this.layoutConfig.h={topItem:"100%",bottomItem:"0%"};}this.doLayout();}},postBuildRendering:function(){if(this._super){this._super();}this.width=this.domNode.clientWidth+"px";}});})();(function(){mstrmojo.requiresCls("mstrmojo.Box","mstrmojo.dom","mstrmojo.Label","mstrmojo.TextBox","mstrmojo.warehouse.dbroles.DBRoleHelper");mstrmojo.requiresDescs(12937,12938);var I=mstrmojo.warehouse.dbroles.DBRoleHelper,H=mstrmojo.dom,M=mstrmojo.string;var O=0,F=1;mstrmojo.warehouse.dbroles.DBRoleSetting=mstrmojo.declare(mstrmojo.Box,null,{scriptClass:"mstrmojo.warehouse.dbroles.DBRoleSetting",cssClass:"mstrmojo-wh-DBRoleSetting",postBuildRendering:function A(){if(this._super){this._super();}this.infobox.captionlbl.set("text",this.caption);if(this.mode===F){this.infobox.dropDown.set("selectedIndex",0);}var Q=H.position(this.infobox.captionlbl.domNode).w,R=H.position(this.infobox.txt.domNode).w,S=H.position(this.infobox.domNode).w;if((Q+R)>S){this.infobox.txt.domNode.style.width=(S-Q-10)+"px";}},caption:"",text:"",infobox:undefined,captionlbl:undefined,ontextChange:function B(){if(this.mode===O){this.infobox.txt.set("value",this.text);}else{if(this.mode===F){this.infobox.dropDown.set("selectedIndex",parseInt(this.text));}}},isNumeric:false,isPassword:false,hiddenPwd:"",isRequired:false,enabled:true,field:undefined,parentRBAlias:"",mode:O,focus:function P(){this.infobox.txt.focus();},getValue:function E(){return this.text;},setValue:function D(Q){this.set("text",Q);this.set("value",Q);},onenabledChange:function J(){this.infobox.captionlbl.set("enabled",this.enabled);this.infobox.txt.set("enabled",this.enabled);this.infobox.dropDown.set("enabled",this.enabled);},disableTextbox:function C(){this.infobox.txt.set("enabled",false);},isValid:function N(){var Q=M.trim(this.getValue()),R={val:true,msg:""};if(!this.enabled){return R;}if(!this.isRequired&&Q===""){return R;}if(this.isRequired&&Q===""){R.val=false;R.msg=mstrmojo.desc(12937,"Value for '##' cannot be empty").replace("##",this.caption);return R;}if(this.isNumeric&&!I.isNumeric(Q)){R.val=false;R.msg=mstrmojo.desc(12938,"Only numeric values are allowed for '##'").replace("##",this.caption);return R;}return R;},children:[{scriptClass:"mstrmojo.Box",alias:"infobox",children:[{scriptClass:"mstrmojo.Label",cssClass:"mstrmojo-wh-DBRoleSetting-Label",alias:"captionlbl",text:"this.parent.caption",useRichTooltip:true,updateTooltipConfig:function(){var S=H.position(this.domNode),Q=-40,R=10;this.set("richTooltip",{cssClass:"vi-regular V-center vi-tooltip-V",top:Math.max(S.y+Q,0),left:Math.max(S.x+R,0),posType:mstrmojo.tooltip.POS_TOPCENTER,content:this.text});}},{scriptClass:"mstrmojo.TextBox",spellCheck:false,autoCapitalize:false,cssClass:"mstrmojo-wh-DBRoleSetting-Info",alias:"txt",bindings:{visible:function(){return this.parent.parent.mode===O;}},preBuildRendering:function L(){var Q=this.parent.parent;if(Q.isPassword){this.set("type","password");this.set("autoComplete",(mstrApp.autocomplete==="1"));}},onEnter:function G(){var Q=this.parent.parent;if(Q.onEnter){Q.onEnter(Q.parent.parent);}},onvalueChange:function K(Q){this.parent.parent.setValue(Q.value);}},{scriptClass:"mstrmojo.ui.Pulldown",cssClass:"mstrmojo-wh-DBRoleSetting-Info",alias:"dropDown",bindings:{visible:function(){return this.parent.parent.mode===F;},items:function(){return this.parent.parent.items;}},onitemSelected:function K(Q){this.parent.parent.setValue(Q.v);}}]}]});}());(function(){mstrmojo.requiresCls("mstrmojo.Box","mstrmojo.ui._HasScroller","mstrmojo.css");var B=mstrmojo.css;mstrmojo.ui.ColumnContainer=mstrmojo.declare(mstrmojo.Box,[mstrmojo.ui._HasScroller],{scriptClass:"mstrmojo.ui.ColumnContainer",markupString:'<div id="{@id}" class="mstrmojo-ui-ColumnContainer {@cssClass}"><div></div></div>',markupSlots:{containerNode:function(){return this.domNode.firstChild;},scrollNode:function(){return this.domNode.firstChild;}},markupMethods:{onnextChange:function A(){B.toggleClass(this.domNode,"hasNext",!!this.next);}},active:false,next:null,idx:undefined,updateColumnContainer:function D(){var E=this.next;if(E){E.updateColumnContainer();}},onactiveChange:function C(){B.toggleClass(this.domNode,"active",this.active);var E=this.next;if(E){E.updateColumnContainer();}}});}());(function(){mstrmojo.requiresCls("mstrmojo.Container","mstrmojo.dom","mstrmojo.hash","mstrmojo.array","mstrmojo.qb.es.TableList","mstrmojo.Label");mstrmojo.requiresDescs(12930,2121,14909);var K="addTable",H=mstrmojo.array,L=mstrmojo.string,C=mstrmojo.hash;mstrmojo.qb.es.TableDropbox=mstrmojo.declare(mstrmojo.Box,null,{scriptClass:"mstrmojo.qb.es.TableDropbox",markupString:'<div id="{@id}" class="mstrmojo-qb-EmmaTableDropbox {@cssClass}" style="{@cssText}"><div class="mstrmojo-qb-emma-container" style="margin-left: 12px"><div class="mstrmojo-qb-emma-EmptyHint"><div class="mstrmojo-qb-emma-EmptyHint-text">{@emptyHint}</div></div><div class="mstrmojo-qb-emma-TableCount"></div><div class="mstrmojo-qb-emma-content"></div></div></div>',markupSlots:{hintNode:function G(){return this.domNode.firstChild.firstChild;},countNode:function F(){return this.domNode.firstChild.children[1];},containerNode:function B(){return this.domNode.firstChild.lastChild;},panelNode:function Q(){return this.domNode.firstChild;}},emptyHint:mstrmojo.desc(14909,"Drag and Drop to Add Tables"),children:[{scriptClass:"mstrmojo.Label",alias:"tableCount",slot:"countNode",visible:false,postCreate:function M(){if(this._super){this._super();}var U={},S=U[this.id]={},R=mstrmojo.desc(2121,"Total");S.refreshTables=function(V){var W=V.items.length;this.set("visible",W>1);if(W>1){this.set("text",R+": "+W);}};mstrApp.getRootController().attachDataChangeListeners(U);}},{scriptClass:"mstrmojo.qb.es.TableList",alias:"tableList"}],init:function P(S){this._super(S);var U={},R=U[this.id]={};R.refreshTables=this.onTableRefresh;mstrApp.getRootController().attachDataChangeListeners(U);},onTableRefresh:function O(R){var S=R.items.length>0;mstrmojo.css.toggleClass(this.hintNode,["off"],S);mstrmojo.css.toggleClass(this.panelNode,["active"],S);this.panelNode.scrollTop=this.panelNode.scrollHeight;},dropZone:true,allowDrop:function E(R){return K===R.action;},ondrop:function J(R){var S=R.action,V=R.src;if(V&&V.data){var U=V.data;H.forEach(U,function(X,W){if(X.n){X.n=L.decodeHtmlString(X.n.replace(/<strong>|<\/strong>/gi,""));X.decoded=true;}});if(S===K){mstrApp.getRootController().addTable(U);}}mstrmojo.css.removeClass(this.panelNode,"dragging");},getAvatarIconClass:function D(){return"enabled";},ondragenter:function I(R){var S=R.src.widget;if(S&&S.toggleAvatarClass&&this.allowDrop(R)){S.toggleAvatarClass(this.getAvatarIconClass(R),true);}mstrmojo.css.addClass(this.panelNode,"dragging");},ondragleave:function N(R){var S=R.src.widget;if(S&&S.toggleAvatarClass&&this.allowDrop(R)){S.toggleAvatarClass(this.getAvatarIconClass(R),false);}mstrmojo.css.removeClass(this.panelNode,"dragging");},onwidthChange:function A(R){var S=parseInt(R.value,10);if(isNaN(S)){return ;}S=S-140;S=(S<=0)?"20px":S+"px";this.tableList.set("itemMaxWidth",S);}});}());(function(){mstrmojo.requiresCls("mstrmojo._HasLayout","mstrmojo.Box","mstrmojo.css","mstrmojo.HBox","mstrmojo.string","mstrmojo.TextBox","mstrmojo.Label");var H=mstrmojo.css,E=mstrmojo.dom,C=mstrmojo.desc(505,"Update"),D="clear";mstrmojo.warehouse.ui.SearchBox=mstrmojo.declare(mstrmojo.Box,null,{scriptClass:"mstrmojo.warehouse.ui.SearchBox",cssClass:"mstrmojo-wh-SearchBox",tableBox:undefined,inputBox:undefined,clearBtn:undefined,refreshBtn:undefined,labelTable:undefined,children:[{scriptClass:"mstrmojo.HBox",cssClass:"mstrmojo-wh-SearchBox-contents",alias:"tableBox",children:[{scriptClass:"mstrmojo.Label",alias:"labelTable",text:mstrmojo.desc(7755,"Table"),cssClass:"mstrmojo-wh-sb-labelTable"},{scriptClass:"mstrmojo.TextBox",cssClass:"mstrmojo-wh-sb-input",alias:"inputBox",oldText:"",spellCheck:false,onkeydown:function G(){this.oldText=this.value;},onkeyup:function B(){var P=this,N=this.value,M=this.parent.clearBtn,Q=this._searchTimeoutId,O=this._hasText=N.length>0;if(this.oldText!==N){H.toggleClass(M.domNode,[D],O);window.clearTimeout(Q);this._searchTimeoutId=window.setTimeout(function(){P.parent.parent.triggerSearch();},this.searchDelay);}}},{scriptClass:"mstrmojo.Label",cssClass:"mstrmojo-wh-sb-btn",alias:"clearBtn",onclick:function L(){var M=this.parent;if(M.inputBox._hasText){M.parent.clearSearch();}else{M.parent.triggerSearch();}}},{scriptClass:"mstrmojo.Label",cssClass:"mstrmojo-wh-sb-refresh",alias:"refreshBtn",visible:false,onclick:function L(){if(this.parent.parent._onRefresh){this.parent.parent._onRefresh();}},title:C,tooltipOpenDelay:0,useRichTooltip:true,updateTooltipConfig:function(){var M=E.position(this.domNode);this.set("richTooltip",{cssClass:"vi-regular vi-tooltip-A",top:Math.max(M.y+40,0),left:Math.max(M.x+2,0),posType:mstrmojo.tooltip.POS_TOPLEFT,content:this.title});}}]}],title:"",tooltipOpenDelay:0,useRichTooltip:true,_preSearch:undefined,_onRefresh:undefined,searchDelay:-1,init:function K(N){this._super(N);var M=this.searchDelay;if(M===-1||isNaN(M)){this.searchDelay=parseInt(mstrApp.getSearchAutoCompleteDelay(),10);}},postBuildRendering:function A(){var N=mstrApp.getRootController(),O=N.dataService,M=(O==mstrmojo.qb.mdx.DataService);this._super();this.tableBox.inputBox.domNode.maxLength=248;this.tableBox.inputBox.value="";M&&this.tableBox.labelTable.set("text",mstrmojo.desc(14211,"Cube"));},clearSearch:function I(M){if(!this.hasRendered){return ;}this.tableBox.inputBox.set("value","");H.removeClass(this.tableBox.clearBtn.domNode,[D]);delete this.tableBox.inputBox._hasText;if(!M){this.triggerSearch();}},triggerSearch:function F(){var M=true;if(this._preSearch){M=this._preSearch();}if(M){this.raiseEvent({name:"searchTriggered",searchValue:mstrmojo.string.trim(this.tableBox.inputBox.value)});}},showTooltip:function J(R,Q){var P=this,N=E.findAncestorByAttr(E.eventTarget(Q,R),"tooltip",true,this.domNode),O=N&&N.value;if(!P.hasOpenTooltip&&O){var M=E.position(N.node);P.richTooltip={cssClass:"vi-regular vi-tooltip-A",content:O,top:Math.max(M.y+40,0),left:Math.max(M.x+2,0),posType:mstrmojo.tooltip.POS_TOPLEFT};this._super(R,Q);}}});}());(function(){mstrmojo.requiresCls("mstrmojo.dom","mstrmojo.Box","mstrmojo.ui._HasScroller","mstrmojo.ME.Enum");mstrmojo.requiresDescs();var M=mstrmojo.dom,B=mstrmojo.string,D=mstrmojo.Widget;var H=/\r?\n?----\r?\n?/;function F(N){var O=B.decodeHtmlString((N||{}).desc||"",true).split(H);return{desc:O[0],example:O.length===2?O[1]:""};}mstrmojo.ME.FunctionInfo=mstrmojo.declare(mstrmojo.Box,[mstrmojo.ui._HasScroller],{scriptClass:"mstrmojo.ME.FunctionInfo",markupString:'<div id="{@id}" class="mstrmojo-Box {@cssClass}" style="{@cssText}"><div class="mstrmojo-FunctionInfo-container"><div class="mstrmojo-FunctionInfo-syntax"></div><div class="mstrmojo-FunctionInfo-desc"></div><div class="mstrmojo-FunctionInfo-eg"><span class="icon" t="icon"></span><span class="text"></span></div></div></div>',markupSlots:{containerNode:function(){return this.domNode.firstChild;},syntaxNode:function(){return this.domNode.firstChild.firstChild;},descNode:function(){return this.domNode.firstChild.childNodes[1];},egNode:function(){return this.domNode.firstChild.lastChild;},egTextNode:function(){return this.domNode.firstChild.lastChild.lastChild;}},markupMethods:{onvisibleChange:D.visibleMarkupMethod,onfoiChange:function(){this.syntaxNode.innerHTML=B.htmlAngles(this.syntax)||"";this.descNode.innerHTML=this.desc;this.egTextNode.innerHTML=this.example;this.egNode.style.display=this.example?"block":"none";this.updateScrollbars();}},foi:{},syntax:"",desc:"",example:"",init:function L(N){this._super(N);mstrmojo.css.addWidgetCssClass(this,"mstrmojo-FunctionInfo");},setupScrollNodes:function C(){if(!mstrmojo.dom.ISIE8){this.scrollNode=this.containerNode;}},onfoiChange:function A(){this.set("syntax",this.getFunctionSyntax());this.set("desc",this.getDesc()+" "+this.getHelpTopic());this.set("example",this.getExample());},getFunctionSyntax:function K(R){var U=R||this.foi;if(!U){return"";}if(U.did<0){return U.n;}var Q=U.pars,S=U.pros,O=[],P,N;O.push(U.n);S=mstrmojo.hash.clone(S)||[];if(U.ios){S.push({n:"SortBy"});}if(U.sqt===5){S.push({n:"BreakBy"});}if(this.showFullSyntax){if(S.length>0){O.push("<");for(P=0,N=S.length;P<N;P++){if(mstrmojo.array.indexOf(mstrmojo.ME.Enum.NonExposableParams,S[P].n)===-1){O.push(S[P].n);O.push(", ");}}O.pop();O.push(">");}}O.push("(");for(P=0,N=Q.length;P<N;P++){O.push(Q[P].n);if(P!==(N-1)){O.push(", ");}}O.push(")");return O.join("");},getDesc:function E(){return F(this.foi).desc;},getExample:function J(){return F(this.foi).example;},getHelpTopic:function G(N){var O=N||this.foi;if(!O||O.did===mstrmojo.ME.Enum.SHORTCUT_FUNCTIONS.Row_Count){return"";}return mstrmojo.ME.MetricDataService.getFunctionHelpTopic(O.h);},useRichTooltip:true,showTooltip:function I(N,Q){var P=M.eventTarget(Q,N),O=this.foi;if(P&&P.getAttribute("t")==="icon"){this.richTooltip=this.getTooltip(O,P);if(this.richTooltip){this._super(N,Q);}}},getTooltip:function(Q,R){var O=M.position(R),P=R.egTip||"";var N={areaId:Q._renderIdx+"text",cssClass:"vi-regular vi-tooltip-V",contentNodeCssClass:"regular-unitlist-tooltips",posType:"",content:P,top:O.y-75,left:O.x+O.w-30,enableHover:false};return N;}});mstrmojo.ME.FunctionInfo.getDescAndExample=F;}());(function(){mstrmojo.requiresCls("mstrmojo.Box","mstrmojo.dom","mstrmojo.Label","mstrmojo.TextBox");mstrmojo.requiresDescs(7564);var F,I=mstrmojo.string,J=mstrmojo.desc(7564,"Select...");mstrmojo.warehouse.dbroles.DBRoleSettingFileSelector=mstrmojo.declare(mstrmojo.Box,null,{scriptClass:"mstrmojo.warehouse.dbroles.DBRoleSettingFileSelector",cssClass:"mstrmojo-wh-DBRoleSettingFileSelector",postBuildRendering:function A(){if(this._super){this._super();}this.infobox.captionlbl.set("text",this.caption);},caption:"",text:"",infobox:undefined,captionlbl:undefined,ontextChange:function B(){this.infobox.txt.set("value",this.text);},isRequired:false,enabled:true,field:undefined,selectorOption:0,parentRBAlias:"",focus:function M(){this.infobox.txt.focus();},getValue:function D(){return this.text;},setValue:function C(N){this.set("text",N);this.set("value",N);},onenabledChange:function G(){this.infobox.captionlbl.set("enabled",this.enabled);this.infobox.txt.set("enabled",this.enabled);},isValid:function L(){var N=I.trim(this.getValue()),O={val:true,msg:""};if(!this.enabled){return O;}if(!this.isRequired&&N===""){return O;}if(this.isRequired&&N===""){O.val=false;O.msg=mstrmojo.desc(12937,"Value for '##' cannot be empty").replace("##",this.caption);return O;}return O;},children:[{scriptClass:"mstrmojo.HBox",cssClass:"mstrmojo-wh-DBRoleSettingFileSelector-InfoBox",alias:"infobox",children:[{scriptClass:"mstrmojo.Label",cssClass:"mstrmojo-wh-DBRoleSettingFileSelector-Label",alias:"captionlbl"},{scriptClass:"mstrmojo.TextBox",cssClass:"mstrmojo-wh-DBRoleSettingFileSelector-Info",alias:"txt",onEnter:function E(){var N=this.parent.parent;if(N.onEnter){N.onEnter(N.parent.parent);}},onvalueChange:function H(N){this.parent.parent.setValue(N.value);}},{scriptClass:"mstrmojo.Label",cssClass:"mstrmojo-wh-DBRoleSettingFileSelector-Select",alias:"fileSelector",text:J,bindings:{visible:function(){var O=this.parent.parent.selectorOption,N=!!(mstrApp.isSingleTier),P=(navigator.platform.indexOf("Win")!==-1),Q=!P;if(((O&1)===1)&&!N){return true;}if(((O&2)===2)&&N&&P){return true;}if(((O&4)===4)&&N&&Q){return true;}return false;}},onclick:function K(){F=this.parent;mstrApp.rootController.launchOneTierAccessFileBrowser("mstrmojo.warehouse.dbroles.DBRoleSettingFileSelector.oneTierFileSelector");}}]}]});mstrmojo.warehouse.dbroles.DBRoleSettingFileSelector.oneTierFileSelector=function(N){F.txt.set("value",N);};}());(function(){mstrmojo.requiresCls("mstrmojo.Box","mstrmojo.hash","mstrmojo.css","mstrmojo.Button");mstrmojo.requiresDescs(1143,8338,9111,9113);var M=mstrmojo.css,G=mstrmojo.dom,I=mstrmojo.array,F="mstrmojo-qb-toolbarIcon",N="on",J="connectionview",C="viewtable",B="conditionview",L="refreshOption",O="help",E=" ";function K(R){return mstrmojo.hash.copy(R,{scriptClass:"mstrmojo.Button",onactiveChange:function Q(){M.toggleClass(this.domNode,N,this.active);},onclick:function P(){this.set("active",!this.active);if(this.cmd){mstrApp.getRootController()[this.cmd](this.active);}if(!this.persistSelection){var S=this;window.setTimeout(function(){S.set("active",false);},100);}}});}function A(R){var Q="mstr-qb-oAuthSourcelogout",P=document.getElementById(Q);if(!P){P=document.createElement("IFRAME");P.id=Q;document.body.appendChild(P);P.style.display="none";G.attachEvent(P,"load",function(S){var V={};var W={success:function U(X){mstrApp.getRootController().handleLogout();}};V.dbRoleID=mstrApp.dbrid;if(mstrApp.said){V.sourceAccountID=mstrApp.said;}mstrApp.getRootController().getDataService().signOutOAuthSource(W,V);});}P.src=R;}function D(){var R={scriptClass:"mstrmojo.HBox",cssClass:"mstrmojo-qb-toolbar-bigquery",bindings:{visible:function(){return mstrApp.said&&mstrApp.dbrid;}},children:[{scriptClass:"mstrmojo.Label",postCreate:function Q(){if(this._super){this._super();}var S=mstrApp.userName;if(mstrApp.userEmail){S+=" ("+mstrApp.userEmail+")";}this.set("text",S);this.set("title",S);},cssClass:"mstrmojo-qb-toolbar-bigquery-username"},{scriptClass:"mstrmojo.Label",text:"|",cssClass:"splitText"},{scriptClass:"mstrmojo.Label",text:mstrmojo.desc(8338,"sign out"),cssClass:"mstrmojo-qb-toolbar-bigquery-signout",onclick:function P(){A("https://www.google.com/accounts/logout");}}]};return R;}function H(){var Q=[{cmd:"toggleDatabaseView",active:true,iconClass:[F,J,N].join(E),title:mstrmojo.desc(9111,"Database View"),persistSelection:true},{cmd:"toggleDataPreview",active:false,iconClass:[F,C].join(E),title:mstrmojo.desc(9113,"Data Preview"),persistSelection:true,postBuildRendering:function P(){var R=mstrApp.getRootController(),S=this.id;R.attachEventListener("dataPreview",S,function(){this.set("active",true);});R.attachEventListener("reportModeChange",S,function(U){this.set("active",U.showPreview);});}},{cmd:"openHelp",iconClass:[F,O].join(E),title:mstrmojo.desc(1143,"help")}];I.forEach(Q,function(S,R,U){U[R]=K(S);});Q.push(D());return Q;}mstrmojo.qb.Toolbar=mstrmojo.declare(mstrmojo.Box,null,{children:H()});}());(function(){mstrmojo.requiresCls("mstrmojo.Box","mstrmojo.array","mstrmojo.dom","mstrmojo.string","mstrmojo.Label","mstrmojo.Button");mstrmojo.requiresDescs(5,49,2918,15446,14825,9948,14825,13305,13306,13307,15474);var D=mstrmojo.array,E=mstrmojo.dom,F=mstrmojo.string;function C(){var G=[],H=mstrApp.diParams,J=(E.isIE8||E.isIE7)&&!(H.flashVI||H.smartVI),I=mstrmojo.DI.DIExitOptions.pageRedirect;if(H.CreateAnalysis===1){G.push({hot:true,icon:"newvi",n:mstrmojo.desc(14825,"Create Dossier"),desc:mstrmojo.desc(9948,"Explore data visually and discover trends, patterns, relationships and outliers"),redirect:J?I.unsupportedBrowser:I.analysis});}if(H.CreateReportServices===1){G.push({icon:"newdoc",n:mstrmojo.desc(2918,"Create Document"),desc:mstrmojo.desc(15503,"Create an enterprise report, scorecard, or dossier"),redirect:I.doc});}if(H.CreateViewReport===1&&mstrApp.getRootController().model.isDirectDataAccess===false){G.push({icon:"newreport",n:mstrmojo.desc(5,"Create Report"),desc:mstrmojo.desc(13859,"Create a grid or graph report"),redirect:I.report});}return G;}mstrmojo.DI.DIExitOptions=mstrmojo.declare(mstrmojo.Box,null,{scriptClass:"mstrmojo.DI.DIExitOptions",cssClass:"mstrmojo-di-DIExitOptions",redirectToPage:function B(G){var H=mstrmojo.DI.DIExitOptions;if(G===H.pageRedirect.unsupportedBrowser){mstrmojo.alert(mstrmojo.desc(15474,"Please upgrade your browser or turn off Internet Explorer Compatibility View to work with HTML5 dossiers."));}else{mstrApp.redirectToPage(H.getRedirectParams(G,this.model.cubeID,this.model.isDirectDataAccess));}},onCancelButtonClick:function(){mstrApp.getRootController().exitApplication();return true;},preBuildRendering:function(){var I=[],H,J,G=["mstrmojo-di-button","mstrmojo-WebButton"];if(this._super){this._super();}H=C();G.push("cnt"+H.length);D.forEach(H,function(L,K){J=new mstrmojo.Button({cssClass:K===0?G.concat(["hot",L.icon]).join(" "):G.concat(L.icon).join(" "),text:L.n,useRichTooltip:true,updateTooltipConfig:function(){var N=this,M=E.position(N.domNode);N.richTooltip={cssClass:"vi-regular A-center vi-tooltip-A",content:L.desc,top:Math.max(M.y+40,0),left:Math.max(M.x+M.w/2,0),posType:mstrmojo.tooltip.POS_TOPCENTER};},redirect:L.redirect,onclick:function(){this.parent.redirectToPage(this.redirect);}});I.push(J);});this.addChildren(I);},children:[{scriptClass:"mstrmojo.Label",cssClass:"title-icon",text:" "},{scriptClass:"mstrmojo.Label",cssClass:"title-one",useRichTooltip:true,allowHTML:true,updateTooltipConfig:function(){var G;if(this.isOverflow&&this.title){G=E.position(this.domNode);this.set("richTooltip",{cssClass:"vi-regular V-center vi-tooltip-V",top:Math.max(G.y,0),left:Math.max(G.x+G.w/2,0),posType:mstrmojo.tooltip.POS_BOTTOMCENTER,content:this.title});}},ontextChange:function(){var H=this;var G=function(){var P=H.parent.model.isDirectDataAccess?mstrmojo.desc(13306,"Success! Your live connection dataset has been saved as ###."):mstrmojo.desc(13305,"Success! Your data was imported as ###."),L=H.domNode,R=H.parent.model.path,K=H.parent.model.cubeName,Q,N,O,M,J;if(!L){return ;}Q=L.scrollWidth>L.clientWidth;N=R;M=J=R.indexOf(K);while(Q&&(M>=0||J<=R.length)){if(M>0){M--;}else{J++;}O=M>0?[R.substr(0,M)]:[];O.push("...");if(J<R.length){O.push(R.substr(J));}N=P.replace("###","<b>"+F.encodeHtmlString(O.join(""),true,true)+"</b>");L.innerHTML=N;Q=L.scrollWidth>L.clientWidth;}};var I=function(){var P=H.parent.model.isDirectDataAccess?mstrmojo.desc(13306,"Success! Your live connection dataset has been saved as ###."):mstrmojo.desc(13305,"Success! Your data was imported as ###."),L=H.domNode,R=H.parent.model.path,K=H.parent.model.cubeName,Q,N,O,M,J;if(!L){return ;}Q=L.scrollHeight>L.clientHeight;N=R;tail=R.length;H.set("isOverflow",Q);while(Q&&(tail>0)){tail--;O=tail>0?[R.substr(0,tail)]:[];O.push("..");N=P.replace("###","<b>"+F.encodeHtmlString(O.join(""),true,true)+"</b>");L.innerHTML=N;Q=L.scrollHeight>L.clientHeight;}};if(H.domNode){I();}else{window.setTimeout(I,0);}},preBuildRendering:function(){var H=mstrmojo.desc(13305,"Success! Your data was imported as ###."),G;if(this.parent.model.isDirectDataAccess){H=mstrmojo.desc(13306,"Success! Your live connection dataset has been saved as ###.");}G=H.replace("###","<b>"+F.encodeHtmlString(this.parent.model.path,true,true)+"</b>");this.set("text",G);this.set("title",G);}},{scriptClass:"mstrmojo.Label",cssClass:"title-two",text:mstrmojo.desc(13307,"What would you like to do now?")}]});mstrmojo.DI.DIExitOptions.pageRedirect={exit:0,report:1,doc:2,analysis:3,flashVI:4,historyList:5,existingAnalysis:6,unsupportedBrowser:7};mstrmojo.DI.DIExitOptions.getRedirectParams=function A(M,J,I,H){var L={},K=mstrmojo.DI.DIExitOptions.pageRedirect,G=mstrApp.name||microstrategy.servletName;switch(M){case K.analysis:if(mstrApp.diParams.flashVI){L={evt:"3104",src:G+".3104",executionMode:"1",rwDesignMode:"0",objectType:"3",objectID:J,rwCreateFlags:"16",rwViewMode:"2048"};}else{L={evt:"3185",src:mstrApp.name+".3185",executionMode:"1",rwDesignMode:"0",objectType:"3",objectID:J,rwCreateFlags:64};if(I){L.rwCreateFlags|=128;}if(mstrApp.cubeSaveFolderId){L.saveFolderId=mstrApp.cubeSaveFolderId;}}break;case K.doc:L={evt:"3104",src:mstrApp.name+".3104",executionMode:"2",rwDesignMode:"1",objectType:"3",objectID:J,rwCreateFlags:0};if(I){L.rwCreateFlags|=128;}if(mstrApp.cubeSaveFolderId){L.saveFolderId=mstrApp.cubeSaveFolderId;}break;case K.flashVI:L={evt:"3104",src:G+".3104",executionMode:"1",rwDesignMode:"0",objectType:"3",objectID:J,rwCreateFlags:16,rwViewMode:"2048"};if(I){L.rwCreateFlags|=128;}break;case K.report:L={iframe:"true",evt:["5005","17004"],src:[mstrApp.name+".create.5005",mstrApp.name+".create.ObjectExplorer.17004"],selectedObjectID:J,defaultevtlist:"17004"};break;case K.exit:L={evt:"3010"};break;case K.historyList:L={evt:"3018",src:G+".3018"};break;case K.existingAnalysis:L={evt:"3140",src:G+".3140",documentID:H};break;}return L;};}());(function(){mstrmojo.requiresCls("mstrmojo.Container","mstrmojo.dom","mstrmojo.hash","mstrmojo.array","mstrmojo.qb.mdx.CubeList");mstrmojo.requiresDescs(12931,14545);var B="addCube";mstrmojo.qb.mdx.CubeDropbox=mstrmojo.declare(mstrmojo.Box,null,{scriptClass:"mstrmojo.qb.mdx.CubeDropbox",markupString:'<div id="{@id}" class="mstrmojo-qb-MDXCubeDropbox {@cssClass}" style="{@cssText}"><div class="mstrmojo-qb-emma-container" style="margin-left: 12px"><div class="mstrmojo-qb-emma-EmptyHint">{@emptyHint}</div><div class="mstrmojo-qb-emma-content"></div></div></div>',markupSlots:{hintNode:function G(){return this.domNode.firstChild.firstChild;},containerNode:function C(){return this.domNode.firstChild.lastChild;},panelNode:function N(){return this.domNode.firstChild;},outerContainerNode:function A(){return this.domNode;}},emptyHint:mstrmojo.desc(13246,"Drag and Drop table(s) from any database connections"),children:[{scriptClass:"mstrmojo.qb.mdx.CubeList"},{scriptClass:"mstrmojo.CheckBox",slot:"outerContainerNode",label:mstrmojo.desc(14545,"Import as Recursive Attribute"),alias:"recursive",oncheckedChange:function D(){mstrApp.getRootController().setRecursive(this.checked?1:0);},postCreate:function J(){if(this._super){this._super();}var Q=this,P={},O=P[this.id]={};O.recursiveChange=function(R){Q.set("checked",R.value?true:false);};mstrApp.getRootController().attachDataChangeListeners(P);this.enabled=!mstrApp.tableID;}}],init:function M(P){this._super(P);var Q={},O=Q[this.id]={};O.refreshTables=this.onTableRefresh;mstrApp.getRootController().attachDataChangeListeners(Q);},onTableRefresh:function L(O){var P=O.items.length>0;mstrmojo.css.toggleClass(this.hintNode,["off"],P);mstrmojo.css.toggleClass(this.panelNode,["active"],P);},dropZone:true,allowDrop:function F(O){return B===O.action;},ondrop:function I(O){var P=O.action,R=O.src,Q;if(R&&R.data){Q=R.data;if(P===B){mstrApp.getRootController().addCubes([Q]);}}mstrmojo.css.removeClass(this.panelNode,"dragging");},getAvatarIconClass:function E(){return"enabled";},ondragenter:function H(O){var P=O.src.widget;if(P&&P.toggleAvatarClass&&this.allowDrop(O)){P.toggleAvatarClass(this.getAvatarIconClass(O),true);}mstrmojo.css.addClass(this.panelNode,"dragging");},ondragleave:function K(O){var P=O.src.widget;if(P&&P.toggleAvatarClass&&this.allowDrop(O)){P.toggleAvatarClass(this.getAvatarIconClass(O),false);}mstrmojo.css.removeClass(this.panelNode,"dragging");}});}());(function(){mstrmojo.requiresCls("mstrmojo.Box");var B=mstrmojo.array;mstrmojo.warehouse.dbroles.DBRoleSettingGroupBox=mstrmojo.declare(mstrmojo.Box,null,{scriptClass:"mstrmojo.warehouse.dbroles.DBRoleSettingGroupBox",cssClass:"mstrmojo-wh-DBRoleSettingGroupBox",groupbox:undefined,isRequired:false,isGroupSetting:true,enabled:true,onenabledChange:function E(){var F=this.enabled;B.forEach(this.children,function(G){G.set("enabled",F);});},getValue:function A(){return"";},setValue:function D(F){},isValid:function C(){return{val:true,msg:""};},children:[{scriptClass:"mstrmojo.Box",alias:"groupbox",children:[]}]});}());(function(){mstrmojo.requiresCls("mstrmojo.css","mstrmojo.dom","mstrmojo.TextBox");var A=mstrmojo.css,C=mstrmojo.dom;mstrmojo.TextArea=mstrmojo.declare(mstrmojo.TextBox,null,{scriptClass:"mstrmojo.TextArea",markupString:'<textarea id="{@id}" class="mstrmojo-TextArea {@cssClass}"  style="{@cssText}" title="{@tooltip}" placeholder="{@placeholderText}" rows="{@rows}" cols="{@cols}" maxlength="{@maxLength}" index="{@tabIndex}" mstrAttach:focus,keydown,keyup,blur></textarea>',maxLength:256,onkeydown:function B(K){var I=this.inputNode,J=this.value,E=this.maxLength,F=(J&&J.length)||0,M=K.e,L=M.keyCode;this.isDeleteKeys=L===8||L===46;this.isArrowKeys=L===37||L===38||L===39||L===40;if(E!==undefined&&E<=F){var G=I.selectionEnd,H=(G!==undefined)?(G-I.selectionStart)>0:document.selection.createRange().text.length>0;if(!this.isDeleteKeys&&!this.isArrowKeys&&!H){if(C.isIE7||C.isIE8||C.isIE9){I.blur();window.setTimeout(function(){I.focus();},1);}C.preventDefault(window,M);return false;}}}});mstrmojo._HasMarkup.addMarkupMethods(mstrmojo.TextArea,{oncssClassChange:function D(){A.addClass(this.domNode,this.cssClass||"");}});})();(function(){mstrmojo.requiresCls("mstrmojo.TextBox","mstrmojo.hash");var A="mstrmojo-TextBoxWithLabel";mstrmojo.TextBoxWithLabel=mstrmojo.declare(mstrmojo.TextBox,null,{scriptClass:"mstrmojo.TextBoxWithLabel",label:"",rightLabel:"",cssDisplay:"inline",type:"text",markupString:'<div class="'+A+' {@cssClass}" style="{@cssText}"><span class="mstrmojo-TextBox-label">{@label}</span><input id="{@id}" class="mstrmojo-TextBox {@inputNodeCssClass}"  style="{@inputNodeCssText}" title="{@tooltip}" type="{@type}" size="{@size}" maxlength="{@maxLength}" index="{@tabIndex}" mstrAttach:focus,keyup,blur/><span class="mstrmojo-TextBox-label-right">{@rightLabel}</span></div>',markupSlots:{inputNode:function(){return this.domNode.firstChild.nextSibling;},lblNode:function(){return this.domNode.firstChild;}}});mstrmojo.TextBoxWithLabel.prototype.markupMethods=mstrmojo.hash.copy({oncssClassChange:function(){var B=this.cssClass;this.domNode.className=A+(B?" "+B:"");},onlabelChange:function(){this.lblNode.innerText=this.label||"";}},mstrmojo.hash.copy(mstrmojo.TextBoxWithLabel.prototype.markupMethods));}());(function(){mstrmojo.requiresCls("mstrmojo.Container","mstrmojo.Label","mstrmojo.TextBox","mstrmojo.DI.DIConstants","mstrmojo.qb.thirdParty.UrlSourceItem");mstrmojo.requiresDescs(11098,12850,13992);var H=mstrmojo.css,F=mstrmojo.array;mstrmojo.qb.thirdParty.SourceInput=mstrmojo.declare(mstrmojo.Container,null,{scriptClass:"mstrmojo.qb.thirdParty.SourceInput",markupString:'<div id="{@id}" class="mstrmojo-di-fileUpload mstrmojo-di-fu mstrmojo-qb-thirdParty-SourceInput {@cssClass}" style="{@cssText}" ><div></div><div class="url-input"></div><div class="url-container"></div><div class="url-placeholder">'+mstrmojo.desc(15306,"Please select a connection first")+"</div></div>",markupSlots:{containerNode:function(){return this.domNode;},instructionNode:function(){return this.domNode.firstChild;},urlInputNode:function(){return this.domNode.children[1];},urlContainerNode:function(){return this.domNode.children[2];},urlPlaceholderNode:function(){return this.domNode.lastChild;}},children:[{slot:"urlInputNode",scriptClass:"mstrmojo.TextBox",cssClass:"upload-url",alias:"urlInput",emptyText:mstrmojo.desc(12850,"Enter URL"),onvalueChange:function(){this.parent.updateAddBtnState();this.parent.enableFooterBtn();}},{slot:"urlInputNode",alias:"addBtn",scriptClass:"mstrmojo.Button",cssClass:"mstrmojo-di-button mstrmojo-WebButton mstrmojo-bi-tools-add",cssDisplay:"inline-block",text:mstrmojo.desc(531,"Add"),onclick:function(){this.parent.addURL();}},{scriptClass:"mstrmojo.Box",cssClass:"select-hint-box",alias:"select-hint",bindings:{visible:function(){return this.parent.urlList.getSrcCnt()===0;}},children:[{scriptClass:"mstrmojo.Label",cssClass:"select-hint-text",text:mstrmojo.desc(13992,"Please select a connection first")}]},{slot:"urlContainerNode",scriptClass:"mstrmojo.Box",cssClass:"mstrmojo-qb-thirdParty-url-holder",alias:"urlList",srcs:[],bindings:{visible:function(){return true;}},postBuildRendering:function A(){this.srcs=[];},addURL:function G(O){var N=mstrApp.getRootController();var L=mstrmojo.insert({scriptClass:"mstrmojo.qb.thirdParty.UrlSourceItem",url:O,dbRoleID:N.model.SelDBRoleID,dbRoleName:N.model.SelDBRoleName,index:this.srcs.length===0?0:this.srcs[this.srcs.length-1].index+1});this.srcs.push({url:L.url,dbRoleID:L.dbRoleID,index:this.srcs.length===0?0:this.srcs[this.srcs.length-1].index+1});var M=this.addChildren(L);M.render();this.containerNode.style.borderStyle=this.getSrcCnt()>0?"solid":"dashed";this.parent.urlPlaceholderNode.style.display=this.getSrcCnt()>0?"none":"block";},deleteURL:function I(L){var M=mstrmojo.array.find(this.srcs,"index",L.index);this.removeChildren(L);this.containerNode.style.borderStyle=this.getSrcCnt()>0?"solid":"dashed";this.parent.urlPlaceholderNode.style.display=this.getSrcCnt()>0?"none":"block";this.parent.enableFooterBtn();if(M>=0){this.srcs.splice(M,1);}},deleteAll:function(){this.removeChildren();this.srcs=[];this.containerNode.style.borderStyle=this.getSrcCnt()>0?"solid":"dashed";this.parent.urlPlaceholderNode.style.display=this.getSrcCnt()>0?"none":"block";this.parent.enableFooterBtn();},getSrcCnt:function(){return this.children?this.children.length:0;},getSrcs:function(){return this.srcs;}}],addURL:function G(){var L=mstrApp.getRootController();var N=L.model;var M=this.urlInput.value;M=M.replace(/^\s+|\s+$/g,"");if(M.length===0||!N.SelDBRoleID){return ;}if(!N.isNew){this.urlList.deleteAll();}this.urlList.addURL(M);this.urlInput.set("value","");},enableFooterBtn:function B(){var L=mstrApp.getRootController();var O=L.model;var P=this.urlList.getSrcCnt();var M=this.urlInput.value;if(P===0){var N=M&&O.SelDBRoleID;L.enableButton(N);}else{if(!O.isNew&&P===1){L.enableButton(M.length<1);}}},getSrcs:function D(){this.addURL();return this.urlList.getSrcs();},removeSrcs:function C(O){var L=this.urlList;var M=L.children,N=[];F.forEach(O,function(P){F.forEach(M,function(Q){if(Q.url===P.url){N.push(Q);return false;}});});F.forEach(N,function(P){L.removeChildren(P);});},initURL:function J(){var L=mstrApp.getRootController().model.SQLstmt;if(L&&L.length>0){this.urlList.addURL(L);this.enableFooterBtn();}},postBuildRendering:function E(){if(this._super){this._super();}var L=this;var M=mstrApp.getRootController().model;M.attachEventListener("reportDefLoaded",this.id,this.initURL);M.attachEventListener("BISourceChange",this.id,function(){L.updateAddBtnState();L.enableFooterBtn();});},updateAddBtnState:function(){var L=mstrApp.getRootController();var N=L.model;var M=N.SelDBRoleID&&this.urlInput.value;this.toggleAddBtnState(M);},toggleAddBtnState:function K(L){H[L?"addClass":"removeClass"](this.addBtn.domNode,["hot"]);}});}());(function(){mstrmojo.requiresCls("mstrmojo.css","mstrmojo._HasBuilder");mstrmojo.ToolBar=mstrmojo.declare(mstrmojo.HBox,[mstrmojo._HasBuilder],{scriptClass:"mstrmojo.ToolBar",cellCssClass:"mstrmojo-ToolBar-cell",markupString:'<table id="{@id}" class="mstrmojo-ToolBar {@cssClass}" style="{@cssText}" cellspacing="0" cellpadding="0"><tr><td class="mstrmojo-ToolBar-outercell"><table class="mstrmojo-ToolBar-innertable" cellspacing="0" cellpadding="0"><tr>{@tableHtml}</tr></table></td></tr></table>',markupSlots:{containerNode:function(){return this.domNode.rows[0].cells[0].firstChild.rows[0];}},markupMethods:{onvisibleChange:function(){this.domNode.style.display=this.visible?mstrmojo.css.DISPLAY_TABLE:"none";}},buildChildren:function A(){var B=this.buildConfig;if(!B){this.buildConfig={};B=this.buildConfig;}B.target=this.target;return this._super();}});}());(function(){mstrmojo.requiresCls("mstrmojo.Button","mstrmojo.HBox","mstrmojo.CheckBox");mstrmojo.requiresDescs(1143);var E=mstrmojo.warehouse.dbroles.DBRoleHelper;mstrmojo.warehouse.dbroles.DBRoleSettingCheckbox=mstrmojo.declare(mstrmojo.HBox,null,{scriptClass:"mstrmojo.warehouse.dbroles.DBRoleSettingCheckbox",cssClass:"mstrmojo-wh-DBRoleCheckBox",postBuildRendering:function A(){if(this._super){this._super();}this.checkbox.set("label",this.label);this.helpBtn.set("visible",!!(this.helpLink));},children:[{scriptClass:"mstrmojo.CheckBox",alias:"checkbox",oncheckedChange:function C(){if(this._super){this._super();}this.parent.checked=this.checked;this.parent.oncheckedChange();},useRichTooltip:true,updateTooltipConfig:function(){var J=-5;this.set("richTooltip",{cssClass:"vi-regular V-center vi-tooltip-V",refNode:this.domNode,posType:mstrmojo.tooltip.POS_BOTTOMLEFT,top:J,content:this.label});}},{scriptClass:"mstrmojo.Button",cssClass:"mstrmojo-wh-DBRoleCheckBox-help",alias:"helpBtn",visible:false,title:mstrmojo.desc(1143,"help"),onclick:function I(){E.showHelp(this.parent.helpLink);}}],helpBtn:undefined,onlabelChange:function G(){this.checkbox.set("label",this.label);},helpLink:undefined,enabled:true,onenabledChange:function F(){this.checkbox.set("enabled",this.enabled);},isNumeric:false,getValue:function D(){if(this.isNumeric){return(this.checkbox.checked?"1":"0");}return(this.checkbox.checked?"true":"false");},setValue:function B(J){this.checkbox.set("checked",((J==="true")||(J===true)||(J==="1")));},isValid:function H(){return{val:true,msg:""};}});}());(function(){mstrmojo.requiresCls("mstrmojo.Container","mstrmojo.Button","mstrmojo.DropDownButton","mstrmojo.Label","mstrmojo.WaitIcon");mstrmojo.IncFetch=mstrmojo.declare(mstrmojo.Container,null,{scriptClass:"mstrmojo.IncFetch",markupString:'<div id="{@id}" class="mstrmojo-IncFetch {@cssClass}" style="{@cssText}"><div class="mstrmojo-IncFetch-content"></div><div class="mstrmojo-clearMe"></div></div>',markupSlots:{containerNode:function(){return this.domNode.firstChild;}},preBuildRendering:function A(){var J=[],F=this.ds,M=this.cp,P=this.np,C=this.ps,E=this.id,G=2;var L=function(){mstrmojo.all[E].set("cp",this.text);};var H={f:1,p:Math.max(M-1,1),n:Math.min(M+1,P),l:P};for(var O in H){J.push(new mstrmojo.Button({iconClass:"arrow "+O,title:F[O],enabled:(H[O]!==M),text:H[O],onclick:L}));}var D=Math.max(Math.min(M-2,P-4),1),I=Math.min(D+4,P);for(var K=D;K<=I;K++){var N;if(K===M){if(I-D===4&&P!==5){N=new mstrmojo.DropDownButton({height:"13px",title:F.a?F.a:"",text:K,direction:"up",popupRef:{scriptClass:"mstrmojo.Popup",slot:"popupNode",contentNodeCssClass:"goto",autoCloses:false,locksHover:true,children:[{scriptClass:"mstrmojo.VBox",children:[{scriptClass:"mstrmojo.Label",cssText:"float:left;",text:F.gt},{scriptClass:"mstrmojo.TextBox",cssText:"float:left;",size:3,maxLength:String(P).length,onEnter:function(){var R=this.inputNode.value,U=this.parent.parent;if(R===""){U.close();return ;}var Q=parseInt(R,10),S=!(isNaN(Q)||Q<1||Q>P);if(S){mstrmojo.all[E].set("cp",Q);U.close();}else{this.setInvalidState(F.v.replace("###",P).replace("##",1).replace(" #",""));}}},{scriptClass:"mstrmojo.Button",cssText:"float:left",iconClass:"apply",title:F.ap?F.ap:"",onclick:function(){this.parent.children[1].onEnter();}}]}],onOpen:function(){mstrmojo.css.addClass(this.parent.domNode,["open"]);var Q=this.children[0].children[1].inputNode;window.setTimeout(function(){Q.focus();},0);},onClose:function(){mstrmojo.css.removeClass(this.parent.domNode,["open"]);this.children[0].children[1].cleanUp();}}});}else{N=new mstrmojo.Button({iconClass:"pg on",text:K});}}else{N=new mstrmojo.Button({iconClass:"pg",text:K,onclick:L});}J.splice(G++,0,N);}J.splice(G++,0,new mstrmojo.Label({text:F.pgs.replace("###",P).replace("##",""),cssText:"float:left;margin:1px 1px 1px 3px;"}));this._iWait=new mstrmojo.WaitIcon({cssText:"margin-top:-2px;"});J.push(this._iWait);this.addChildren(J);return this._super?this._super():true;},_set_cp:function B(D,C){if(parseInt(C,10)!==this.cp){this.raiseEvent({name:"fetch",v:C,iWait:this._iWait});}}});})();(function(){mstrmojo.requiresCls("mstrmojo.List","mstrmojo._IsDial");mstrmojo.Dial=mstrmojo.declare(mstrmojo.List,[mstrmojo._IsDial],{scriptClass:"mstrmojo.Dial",markupMethods:{onvisibleChange:function(){this.domNode.style.display=this.visible?"block":"none";},onhasSelectionChange:function(){mstrmojo.css.toggleClass(this.domNode,["hasSelection"],!!this.hasSelection);},hideIfEmpty:function(){this.onadd();}},hideIfEmpty:false,onadd:function(A){if(this._super){this._super(A);}if(this.hideIfEmpty){if(this.domNode){this.domNode.style.display=(!this.items||this.items.length==0)?"none":"block";}}}});})();(function(){mstrmojo.requiresCls("mstrmojo.ListSelector","mstrmojo.List","mstrmojo.string");mstrmojo.OBList=mstrmojo.declare(mstrmojo.List,null,{scriptClass:"mstrmojo.OBList",cssClass:"mstrmojo-OBList",itemClass:"mstrmojo-OBListItem",iconClass:"mstrmojo-OBListItemIcon",textClass:"mstrmojo-OBListItemText",iconCssPrefx:"mstrmojo-OBIcon_",itemMarkupFunction:function(C,A,B){return'<div class="'+B.itemClass+(C[B.itemType]?" t_"+C[B.itemType]:"")+(C[B.itemSubType]?" st_"+C[B.itemSubType]:"")+(C[this.itemISC]?" isc":"")+(C[B.itemViewMedia]?" vm_"+C[B.itemViewMedia]:"")+'"><table cellspacing="0" cellpadding="0"><tbody><tr><td>'+B.getIcon(C)+'</td><td><div class="'+B.textClass+'" title="'+B.getTooltip(C)+'">'+mstrmojo.string.htmlAngles(C.n)+"</div></td></tr></tbody></table></div>";},getIcon:function(F){var E=F[this.itemType],D=F[this.itemSubType],B=" t"+E,C=(parseInt(E,10)===1||parseInt(E,10)===3||parseInt(D,10)===14082)?" st"+D:"",G=F[this.itemISC]?'class="mstrmojo-ListIcon isc"':"",A=(F[this.itemViewMedia]===2048||F[this.itemViewMedia]===8192)?" hvi":"";return'<span class="mstrmojo-ListIcon '+B+C+A+'"><span '+G+"></span></span>";},getTooltip:function(C){var D="",F=C.anc&&C.anc.items,A=F&&F.length,B;if(A>0){for(B=0;B<A-1;B++){D+=F[B].n+" > ";}D+=F[A-1].n;}var E=C.desc,G=128;if(E){D+="\r\n\r\n"+mstrmojo.string.encodeHtmlString(E.substring(0,G))+(E.length>G?"...":"");}return D;},listSelector:mstrmojo.ListSelector,selectionPolicy:"reselect",itemType:"t",itemSubType:"st",itemISC:"isc",itemViewMedia:"dvm",useDblSelect:false});}());(function(){mstrmojo.requiresCls("mstrmojo.ListHoriz","mstrmojo.fx");mstrmojo.FishEye=mstrmojo.declare(mstrmojo.ListHoriz,null,{scriptClass:"mstrmojo.FishEye",width:16,size:10,step:16,speed:2,cssClass:"mstrmojo-FishEye",cssClassItem:"mstrmojo-dot",itemMarkupFunction:function(B,A,C){return'<div class="mstrmojo-fisheye-item '+C.cssClassItem+'" title="'+B.n+'" idx="'+A+'" did="'+B.did+'">&nbsp;</div>';},onchange:function(){this.scroll2();this.parent.set("selectedIndex",this.selectedIndex);},as:new mstrmojo.fx.AnimateProp(),onitemsChange:function(){if(this._super){this._super();}this.last=this.items.length-1;this.first=Math.max(0,this.last-this.size);if(this.items.length>this.size){this.scroll("left",this.width);}},scroll2:function(){var A=this.selectedIndex-this.last;if(this.selectedIndex==this.first&&this.first>0){this.scroll("right",this.width);}else{if(this.selectedIndex==this.last&&this.last<this.items.length-1){this.scroll("left",this.width);}else{if(this.selectedIndex>this.last){A=this.selectedIndex-this.last;this.scroll("left",this.width*A,A);this.last=Math.min(this.items.length-1,this.last+A);}else{if(this.selectedIndex<this.first){A=this.first-this.selectedIndex;this.scroll("right",this.width*A,A);this.first=Math.max(0,this.first-A);}}}}},scroll:function(C,F,E){var B=this.itemsContainerNode,I=B&&B.style;var D=this.as,H=parseInt(mstrmojo.css.getStyleValue(B,{left:"right",right:"left"}[C]),10),H=isNaN(H)?0:H,A=parseInt(I.left,10)||0,G=A+(C=="left"?-1:1)*(F||(Math.min(this.step,(-1)*H)));D.target=B;D.props={left:{start:A,stop:G,duration:100,interval:10,suffix:"px"}};D.play();E=E===undefined?1:E;this.first+=(C=="left"?1:-1)*E;this.last=this.first+this.size-1;this.parent.set("scrollable",this.last<this.items.length-1);this.parent.set("rightScrollable",this.first>0);return G;},srcId:null,postBuildRendering:function(){if(this._super){this._super();}this.hasRendered=!!this.domNode;var E=this.itemsContainerNode,A=E&&E.firstChild,B=A&&A.rows&&A.rows[0],D=B&&B.cells&&B.cells[0];this.first=0;this.last=this.size-1;var C=this.srcId;if(C&&mstrmojo.all[C]&&mstrmojo.all[C].attachEventListener){mstrmojo.all[C].attachEventListener("change",this.id,function(F){if(this.items[this.items.length-1]!=F.src.selectedItem){this.items.add([mstrmojo.hash.copy(F.src.selectedItem)]);this.set("selectedIndex",this.items.length-1);}if(this.items.length>this.size){this.set("rightScrollable",this.items.length>this.size);this.scroll("left",this.width*(this.selectedIndex-this.last),(this.selectedIndex-this.last));}});}this.itemsContainerNode.style.left=Math.min(0,(this.size-this.items.length+1))*this.width+"px";}});})();(function(){mstrmojo.requiresCls("mstrmojo.WidgetListBase","mstrmojo.WidgetListMapper","mstrmojo.WidgetListBuilder");mstrmojo.WidgetList=mstrmojo.declare(mstrmojo.WidgetListBase,null,{scriptClass:"mstrmojo.WidgetList",renderOnScroll:true,listMapper:mstrmojo.WidgetListMapper,listBuilder:mstrmojo.WidgetListBuilder,itemConfig:null,itemFunction:null,initBindings:function(){this._super();var E=this.ctxtBuilder,D=E&&E.itemWidgets;if(D){for(var C=0,A=D.length;C<A;C++){var B=D[C];if(B&&B.initBindings){B.initBindings();}}}}});})();(function(){mstrmojo.requiresCls("mstrmojo.SuggestionList","mstrmojo.mstr.EnumDSSXMLObjectTypes");var C=function(S,V,U){var R=S.parent.opener,J=R&&R.showDesc,Q=R&&R.showPath,I=V[S.itemField];var P=mstrmojo.string.escape4HTMLText,W="";if(Q){var M=V.anc&&V.anc.items,O=M&&M.length;if(O>0){for(var L=0;L<O-1;L++){W+=M[L].n+" > ";}W+=P(M[O-1].n);}else{if(V.path){W+=P(V.path);}}}if(!U){W+=(W.length===0?"":" > ")+P(I);}if(J){var N=V[S.itemDescField],K=120;if(N){W+="\r\n\r\n<br>"+P(N.substring(0,K)+(N.length>K?"...":""));}}return W;};var A=function(I,J,K){I.path=null;if(!J||!K||K.path){if(K&&K.path){I.set("path",K.path);}return ;}window.clearTimeout(this.pathTmr);this.pathTmr=window.setTimeout(function(){var L=J.path||J.getAttribute("path");if(L){I.set("path",K.path);return ;}mstrmojo.xhr.request("POST",mstrConfig.taskURL,{success:function(M){var N=H(M.toString())||"";K.path=N;I.set("path",N);}},{taskId:"getObjectDetails",objectID:K.did,objectType:K.t},undefined);},200);};var H=function(K){var N;if(window.DOMParser){N=(new DOMParser()).parseFromString(K,"text/xml");}else{N=new ActiveXObject("Microsoft.XMLDOM");N.async="false";N.loadXML(K);}var P=N.getElementsByTagName("path")[0],L=P.childNodes,O="";if(L){for(var J=0,I=L.length;J<I;J++){var M=L[J].childNodes&&L[J].childNodes[0];if(M){O+=mstrmojo.string.escape4HTMLText(M.nodeValue)+(J<I-1?"> ":"");}}}return O;};mstrmojo.LegacySuggestionList=mstrmojo.declare(mstrmojo.SuggestionList,null,{scriptClass:"mstrmojo.LegacySuggestionList",useRichTooltip:false,itemDescField:"desc",getItemMarkup:function(K,I){var J=this.parent.opener,L=this.useRichTooltip?"":this.buildTooltip(K);return'<div class="mstrmojo-suggest-text '+((J&&J.item2textCss(K))||"")+'" idx="'+I+'" title="'+L+'">'+J.getHighlightedText(J.getSearchPattern(),mstrmojo.string.escape4HTMLText(K[this.itemField]))+"</div>";},getItemProps:function E(){return{};},onmouseover:function(J){var M=this.parent.opener;if(M&&M.showPath){var K=mstrmojo.dom.eventTarget(J.hWin,J.e),I=K.getAttribute("idx"),L=I!=null?this.items[I]:null;if(L&&L.t>-1){this.targetEl=K;this.targetItem=L;this.requestPath(K,L);}}},requestPath:function D(I,K){var J=this.parent.opener;if(K.t===mstrmojo.mstr.EnumDSSXMLObjectTypes.Function&&J.showFunctionSyntaxAsPath){this.buildFunctionSyntax(K);}else{A(this,I,K);}},buildFunctionSyntax:function G(J){var K=J.path;if(!K&&J.t===mstrmojo.mstr.EnumDSSXMLObjectTypes.Function){var I=function I(P){if(P.did<0){return P.n;}var O=P.pars,M=[],N,L;M.push(P.n);if(O){M.push("(");for(N=0,L=O.length;N<L;N++){M.push(O[N].n);if(N!==(L-1)){M.push(", ");}}M.push(")");}return M.join("");};J.path=I(J);}this.set("path",{path:J.path,excludeSelf:true});},buildTooltip:function B(I,J){return C(this,I,J);},onpathChange:function F(){var I=this.targetEl;I.path=1;var J=this.buildTooltip(this.targetItem,this.path.excludeSelf);if(this.useRichTooltip){this.useRichTooltip=true;this.hasOpenTooltip=false;if(!I.ttp){I.ttp=J;this.showTooltip();}}else{I.title=J;}}});}());(function(){mstrmojo.requiresCls("mstrmojo.ListBoxBase","mstrmojo._HasScrollbox");mstrmojo.ListBox=mstrmojo.declare(mstrmojo.ListBoxBase,[mstrmojo._HasScrollbox],{scriptClass:"mstrmojo.ListBox",renderAllItems:false,renderPause:10,numPagesRendered:0,pageStatus:null,_rc:null,_totalPages:null,_rh:null,_rhMin:8,_rowsPerPage:null,_defaultRowsPerPage:100,_minRowsPerPage:100,_pageHeight:null,buildRendering:function K(){if(this.renderAllItems===true){this._super();return true;}this._initPageSettings();var L=this.items;this.items=this._rc?this.items.slice(0,Math.min(this._rowsPerPage,this._rc)):[];this._super();this.items=L;this.postRenderPage(0,true);if(this._rc>this._rowsPerPage){this.itemsContainerNode.style[mstrmojo.css.MINHEIGHT]=(this._rh*this._rc)+"px";if(!this.connectedScrollbox){this.connectScrollbox(this);this.connectedScrollbox=true;}}else{this.postRenderingCleanup();}},_initPageSettings:function E(){var L=this.items;this._rc=(L&&L.length)||0;var N=this.itemRenderer;this._rh=(N&&N.rowHeight)||this._rhMin||3;var M=this._defaultRowsPerPage;if(!isNaN(this.scrollboxHeight)){M=Math.ceil(this.scrollboxHeight/this._rh);M=Math.max(M,this._minRowsPerPage);}this._rowsPerPage=M;this._totalPages=Math.ceil(this._rc/this._rowsPerPage);this._pageHeight=this._rh*this._rowsPerPage;this._pageStatus=new Array(this._totalPages);this._numPagesRendered=0;},onscroll:function J(){if(!this._renderingRows){this._startPageRenderThread();}},_startPageRenderThread:function F(){this.renderingRows=true;var M=this,L=this._renderTimer=self.setInterval(function(){if(!M){self.clearInterval(L);return ;}var N=M.getPagesToRender();if(N.length>0){M.renderPages(N);}else{M.renderingRows=false;self.clearInterval(M._renderTimer);delete M._renderTimer;if(M.isRenderingComplete()){M.postRenderingCleanup();}M=null;}},this.renderPause);},getPagesToRender:function I(){var P=[],a=this._pageHeight,c=null,X=this._pageStatus,Z=this;function R(d){var e=X[d];if(e&&e.filled){if(!e.height){if(!c){c=Z.itemsNode.tBodies;}e.height=c[d].offsetHeight;}return e.height;}else{return a;}}var b=0,S=null,O=null,M=this.scrollboxTop;for(var W=0,Y=this._totalPages;W<Y;W++){b+=R(W);if(b>=M){S=W;break;}}if(S==null){S=O=Y-1;}else{var L=this.scrollboxBottom;for(var U=S+1;U<Y;U++){if(b>=L){O=U-1;break;}b+=R(U);}}if(O==null){O=Y-1;}for(var N=this._numPagesRendered;N<S;++N){P.push({idx:N,fill:false});}for(var Q=S;Q<=O;++Q){var V=X[Q];if(!V||!V.filled){P.push({idx:Q,fill:true});}}return P;},renderPages:function D(M){for(var N=0,L=M.length;N<L;++N){this.renderPage(M[N].idx,M[N].fill);}},renderPage:function B(R,M){var W=this._pageStatus,P=(this._numPagesRendered>=R+1);if(P){if(!M||(W[R]&&W[R].filled)){return ;}}var V=this._rowsPerPage,L=R*V,N=Math.min(L+V,this._rc)-1;var U=this.tempTableCont;if(!U){U=this.tempTableCont=this.domNode.ownerDocument.createElement("div");}var Q=M?this._buildItemsMarkup(L,N,'<table><tbody idx="'+R+'">',"</tbody></table>",this._itemPrefix&&this._itemPrefix(),this._itemSuffix&&this._itemSuffix()).join(""):'<table><tbody idx="'+R+'"><tr><td style="height:'+this._pageHeight+'px">&nbsp;</td></tr></tbody></table>';U.innerHTML=Q;var O=U.firstChild.tBodies[0],S=this.itemsNode;if(!P){S.appendChild(O);}else{S.replaceChild(O,S.tBodies[R]);}this.postRenderPage(R,M);},postRenderPage:function G(M,O){if(M+1>this._numPagesRendered){this._numPagesRendered=M+1;}var L=this._pageStatus,N=L[M];if(!N){N=L[M]={};}if(O){N.filled=true;}if(M>0&&M==this._totalPages-1){this.itemsContainerNode.style[mstrmojo.css.MINHEIGHT]="";}},isRenderingComplete:function C(){if(this._numPagesRendered==this._totalPages){for(var L=this._pageStatus,M=this._totalPages-1;M>-1;M--){if(!L[M]||!L[M].filled){return false;}}return true;}return false;},postRenderingCleanup:function A(){if(this.connectedScrollbox){this.disconnectScrollbox(this);this.connectedScrollbox=false;}},unrender:function(L){this.postRenderingCleanup();this._super(L);},refresh:function H(){if(!this.hasRendered){return ;}var N=this.domNode,L=N&&N.parentNode;if(!this.parent&&L){var M=N.ownerDocument.createElement("span");L.insertBefore(M,N);}this.unrender();if(!this.parent&&L){this.domNode=M;}this.render();if(this.defn&&this.defn.set){this.defn.set("readyState",mstrmojo.EnumReadystate.IDLE);}}});})();(function(){mstrmojo.requiresCls("mstrmojo.ListBase","mstrmojo._ListSelections");mstrmojo.ListBoxHoriz=mstrmojo.declare(mstrmojo.ListBoxBase,[mstrmojo._ListSelections],{scriptClass:"mstrmojo.ListBoxHoriz",cssClass:"mstrmojo-ListBoxHoriz",tableCssClass:"mstrmojo-ListBox-table",tableCssText:"",rowCssClass:"",rowCssText:"",cellCssClass:"",cellCssText:"",cellSpacing:0,cellPadding:0,_markupPrefix:function(){var A=this.itemRenderer;return(A&&A.markupPrefix)||('<table class="'+this.tableCssClass+'" style="'+this.tableCssText+'" cellspacing="'+this.cellSpacing+'" cellpadding="'+this.cellPadding+'"><tbody><tr class="'+this.rowCssClass+'" style="'+this.rowCssText+'">');},_markupSuffix:function(){var A=this.itemRenderer;return(A&&A.markupSuffix)||"</tr></tbody></table>";},_itemPrefix:function(){var A=this.itemRenderer;return(A&&A.itemPrefix)||('<td class="'+this.cellCssClass+'" style="'+this.cellCssText+'">');},_itemSuffix:function(){var A=this.itemRenderer;return(A&&A.itemSuffix)||"</td>";},_getItemNode:function(A){if(A<0){return null;}var B=this.itemsNode,C=B&&B.rows[0];return C&&C.cells[A].firstChild;}});}());(function(){mstrmojo.requiresCls("mstrmojo.ui.List","mstrmojo.ui._HasScroller","mstrmojo.css");var G=mstrmojo.css;var D;mstrmojo.ui.CheckList=mstrmojo.declare(mstrmojo.ui.List,[mstrmojo.ui._HasScroller],{scriptClass:"mstrmojo.ui.CheckList",markupString:'<div id="{@id}" class="mstrmojo-ui-CheckList {@cssClass}" style="{@cssText}" mstrAttach:click,contextmenu><div class="scroll-container"><div class="{@icnCss}" style="{@icnCssText}">{@itemsHtml}</div></div></div>',markupSlots:{scrollboxNode:function A(){return this.domNode.firstChild;},itemsContainerNode:function J(){return this.domNode.firstChild.firstChild;}},markupMethods:{onvisibleChange:mstrmojo.Widget.visibleMarkupMethod,onheightChange:mstrmojo.Widget.heightMarkupMethod,onwidthChange:mstrmojo.Widget.widthMarkupMethod,onorientationChange:function M(){G.toggleClass(this.domNode,"horizontal",this.orientation!=="v");},onmultiSelectChange:function K(){G.toggleClass(this.domNode,"radio",!this.multiSelect);},onenabledChange:function I(){G.toggleClass(this.domNode,"disabled",!this.enabled);},onhideCheckMarkChange:function B(){G.toggleClass(this.domNode,"hideCheckMark",this.hideCheckMark);}},multiSelect:true,hideCheckMark:false,orientation:"v",minimumSelectCnt:0,icnCss:"icn",items:null,getItemMarkup:function L(N){if(!D){D=this._super(N).replace(">{@en@n}<",'title="{@tt}"><span class="text">{@en@n}</span><');}return D;},getItemProps:function H(Q,O){var P=this._super(Q,O),N={"\r\n":" ","\n":" ","\r":" "};var R=Q.css;if(R){P.addCls(R);}P.tt=Q.tt||"";Q.n=mstrmojo.string.multiReplace(Q.n,N);P.n=Q.n||"";return P;},setupScrollNodes:function E(){this.scrollNode=this.scrollboxNode;},preselectionChange:function C(O){var P=this.minimumSelectCnt,N=this.getSelectedItems().length,Q=O.removed;if(Q&&P){if(N<P){this.select(Q,true);return false;}}G.toggleClass(this.itemsContainerNode,"disableSelected",N<=P);return true;},buildRendering:function F(){this._super();G.toggleClass(this.itemsContainerNode,"disableSelected",this.getSelectedItems().length<=this.minimumSelectCnt);}});mstrmojo.ui.CheckList.ItemType=null;}());(function(){mstrmojo.requiresCls("mstrmojo.ui.List","mstrmojo.ui._HasScroller");mstrmojo.ui.ScrollableList=mstrmojo.declare(mstrmojo.ui.List,[mstrmojo.ui._HasScroller],{scriptClass:"mstrmojo.ui.ScrollableList",markupString:'<div id="{@id}" class="mstrmojo-ListBase {@cssClass}" style="{@cssText}" mstrAttach:click,dblclick,mousedown,mouseover,mouseout,contextmenu><div class="list-content"><div class="items-container {@icnCss}" style="{@icnCssText}">{@itemsHtml}</div></div></div>',markupSlots:{itemsContainerNode:function C(){return this.domNode.firstChild.firstChild;},scrollboxNode:function D(){return this.domNode.firstChild;},scrollNode:function E(){return this.domNode.firstChild;}},postBuildRendering:function B(){if(this.renderOnScroll){if(!this.onScrollEnd){var G=this.id;this.onScrollEnd=function F(){var H=mstrmojo.all[G];H.doScroll();H.updateScrollbars();};}}if(this._super){this._super();}},renderBlockSize:150,renderIndex:0,onScrollEnd:undefined,doScroll:function A(){if(this.renderOnScroll){var G,H=this.scrollNode,F=(this.renderIndex+1)*this.renderBlockSize;if(F>=this.items.length){return ;}if(mstrmojo.dom.position(H).h===H.scrollHeight){G=this.domNode;}else{G=H;}if((mstrmojo.dom.position(G).h+G.scrollTop)>=G.scrollHeight){this.renderIndex++;var I=this._buildItemsMarkup(this.renderIndex*this.renderBlockSize,((this.renderIndex+1)*this.renderBlockSize)-1,this._markupPrefix&&this._markupPrefix(),this._markupSuffix&&this._markupSuffix(),this._itemPrefix&&this._itemPrefix(),this._itemSuffix&&this._itemSuffix()).join("");G.innerHTML+=I;this.itemsContainerNode.innerHTML+=I;}}}});}());(function(){mstrmojo.requiresCls("mstrmojo.ui.ScrollableList","mstrmojo._IsPopup","mstrmojo._CanAutoClose","mstrmojo.ui._HasListTooltip");mstrmojo.ui.PopupList=mstrmojo.declare(mstrmojo.ui.ScrollableList,[mstrmojo._IsPopup,mstrmojo._CanAutoClose,mstrmojo.ui._HasListTooltip],{scriptClass:"mstrmojo.ui.PopupList",autoCloses:true,locksHover:true,closeOnClick:true,scrollNodeMaxHeight:undefined,parentDomNode:undefined,keydownString:null,lastKeydownTime:null,keydownInterval:500,closeAfterSelection:true,markupString:'<div id="{@id}" class="mstrmojo-PopupList {@cssClass}" style="{@cssText}" tabIndex="-1" mstrAttach:click,dblclick,mouseover,mouseout,contextmenu,keydown><div class="mstrmojo-popupList-scrollBar"><div class="{@icnCss}" style="{@icnCssText}">{@itemsHtml}</div></div></div>',markupSlots:{itemsContainerNode:function I(){return this.domNode.firstChild.firstChild;},scrollboxNode:function A(){return this.domNode.firstChild;}},setupScrollNodes:function F(){this.scrollNode=this.scrollboxNode;},onOpen:function E(){this._super();this.updateScrollbars();var M=this;setTimeout(function(){M.scrollToSelectedItem();},10);},onclick:function K(M){this.closeAfterSelection=true;this._super(M);},postBuildRendering:function B(){var N=this._super();if(!this.parent){var M=this.parentDomNode=this.parentDomNode||document.body;M.appendChild(this.domNode);}return N;},closePopup:function J(){this.set("visible",false);},onkeydown:function H(O){if(!this.opener||!this.opener.focusOnPopup){return ;}var M=O.hWin,R=O.e||M.event,U=this.keydownString;this.locksHover=false;this.closeAfterSelection=false;if(R.keyCode===mstrmojo.Enum_Keys.DOWN_ARROW){if(this.selectedIndex<this.items.length-1){this.set("selectedIndex",this.selectedIndex+1);this.scrollToSelectedItem();}}else{if(R.keyCode===mstrmojo.Enum_Keys.UP_ARROW){if(this.selectedIndex>0){this.set("selectedIndex",this.selectedIndex-1);this.scrollToSelectedItem();}}else{if(R.keyCode===mstrmojo.Enum_Keys.ENTER||R.keyCode===mstrmojo.Enum_Keys.ESCAPE){this.closeAfterSelection=true;this.singleSelect(this.selectedIndex);}else{var S=new Date(),P=S.getTime(),N=String.fromCharCode(R.keyCode).toLowerCase(),Q=this;if(this.lastKeydownTime===null){this.keydownString=N;}else{if(P-this.lastKeydownTime<this.keydownInterval){this.keydownString=this.keydownString+N;}else{this.keydownString=N;}}U=this.keydownString;if(this._holdTimer){clearTimeout(this._holdTimer);}this._holdTimer=setTimeout(function(){Q.changeSelectedItem(O);Q.adjustPosition();},Q.keydownInterval);this.lastKeydownTime=P;}}}},changeSelectedItem:function D(M){var P=this.selectedIndex,O=this.items&&this.items.length;if(O>0){var N;for(N=this.selectedIndex+1;N<this.items.length;N++){if(this.items[N].n.toLowerCase().indexOf(this.keydownString)==0){P=N;break;}}if(P===this.selectedIndex){for(N=0;N<this.selectedIndex;N++){if(this.items[N].n.toLowerCase().indexOf(this.keydownString)==0){P=N;break;}}}if(P!==this.selectedIndex){this.set("selectedIndex",P);}}},focus:function L(){this.domNode.focus();},scrollToSelectedItem:function G(){var P=this.itemsContainerNode.childNodes[this.selectedIndex];if(P){var M=this.scrollNode,O=M.clientHeight,N=P.offsetTop;if(N-M.scrollTop+P.offsetHeight>O){M.scrollTop=P.offsetTop+P.offsetHeight-O;}else{if(N<M.scrollTop){M.scrollTop-=P.offsetHeight;}}}},adjustPosition:function C(){this.adjustCornersForPopupOverflow();this.scrollToSelectedItem();this.focus();}});}());(function(){mstrmojo.requiresCls("mstrmojo.ui.CheckList","mstrmojo.ui._IsHierarchyList","mstrmojo.css","mstrmojo.array","mstrmojo.EnumSelectionType");var S=mstrmojo.css,K=mstrmojo.array,A=mstrmojo.EnumSelectionType;var V="hidden",Q="selected",R="expanded",F="collapsed",I="hierarchy",M="hasChildren";var P="u;",Z=10;mstrmojo.ui.HierarchyCheckList=mstrmojo.declare(mstrmojo.ui.CheckList,[mstrmojo.ui._IsHierarchyList],{scriptClass:"mstrmojo.ui.HierarchyCheckList",markupString:'<div id="{@id}" class="mstrmojo-ui-CheckList {@cssClass}" style="{@cssText}" mstrAttach:click,contextmenu><div class="header"></div><div class="scroll-container"><div class="{@icnCss}" style="{@icnCssText}">{@itemsHtml}</div></div><div class="footer"></div></div>',markupSlots:{headerNode:function E(){return this.domNode.firstChild;},footerNode:function C(){return this.domNode.lastChild;},scrollboxNode:function H(){return this.domNode.children[1];},itemsContainerNode:function U(){return this.domNode.children[1].firstChild;}},getItemMarkup:function D(b,a){return'<{@tag} class="item {@cls}" idx="{@idx}" style="{@style}" title="{@tt}"><span class="indent" style="padding-left: {@indent}px;"></span><span class="triangle"></span><span class="checkbox"></span><span class="text">{@en@n}</span></{@tag}>';},getItemProps:function X(c,a){var b=this._super(c,a);if(c.isSelected){b.addCls(Q);}if(this.isHiearachyDisplay()){if(c.hcd){b.addCls(c.epd?R:F);}}return b;},setupScrollNodes:function J(){this.scrollNode=this.scrollboxNode;var a=this.domNode.clientHeight-this.headerNode.clientHeight-this.footerNode.clientHeight;if(a>0){this.scrollNode.style.height=a+"px";}},onclick:function Y(a){var c=a.getTarget(),d=this.getItemNodeFromTarget(c),b=this.getItemFromTarget(c);if(b){if(S.hasClass(c,"triangle")){if(b.hcd){this.doExpandCollapse(d,b);}}else{if(!S.hasClass(c,"indent")){this.doBranchSelect(d,b,!b.isSelected);}}a.cancel();}},doElementSelect:function W(c,b,a){b.isSelected=a;this.onSelectionChange(A.ELEMENT,a,b);this.updateItemNodesStatus();},doBranchSelect:function O(d,b,a){var c=function(e){e.isSelected=a;e.isBranchSelected=a;(e.children||[]).forEach(function(f){c(f);});};c(b);this.onSelectionChange(A.BRANCH,a,b);this.updateItemNodesStatus();},doLevelSelect:function G(b,a){this.getItems().forEach(function(c){if(c.lv===b){c.isSelected=a;}});this.onSelectionChange(A.LEVEL,a,null,b);this.updateItemNodesStatus();},doBranchLevelSelect:function B(e,b,d,a){var c=function(f){if(f.lv===d){f.isSelected=a;}else{if(f.lv<d){(f.children||[]).forEach(function(g){c(g);});}}};c(b);this.onSelectionChange(A.BRANCH_LEVEL,a,b,d);this.updateItemNodesStatus();},doAllSelect:function L(a){this.getItems().forEach(function(b){b.isSelected=b.isBranchSelected=a;});this.onSelectionChange(A.ALL,a);this.updateItemNodesStatus();},updateItemNodesStatus:function N(){var a=this.itemsContainerNode&&this.itemsContainerNode.childNodes;K.forEach(a,function(c){var b=this.getItemFromTarget(c);if(b){S.toggleClass(c,Q,b.isSelected);}},this);},onSelectionChange:mstrmojo.emptyFn});}());(function(){mstrmojo.requiresCls("mstrmojo.ListBox","mstrmojo.ListBoxHoriz","mstrmojo.string");var B=mstrmojo.string;var A={render:function(G,C,H){var I=(H.htmlName+C),E=H.selectedIndices[C]?"checked ":"",F=E?" selected":"",D=G.v!=="u;"?" nAll":"";return'<div class="'+H.itemCssClass+F+D+'"><input type="'+H.inputType+'" name="'+H.htmlName+'" id="'+I+'" value="'+C+'" '+E+'/><label for="'+I+'" title="'+B.encodeHtmlString(G[H.itemTitleField]||"")+'" style="'+H.labelCssText+'">'+B.encodeHtmlString(G[H.itemDisplayField||"n"])+"</label></div>";},select:function(D){var C=D&&D.firstChild;if(C){if(!C.checked){C.checked=true;}mstrmojo.css.toggleClass(D,"selected",C.checked);}},unselect:function(D){var C=D&&D.firstChild;if(C){if(C.checked){C.checked=false;}mstrmojo.css.toggleClass(D,"selected",C.checked);}},rowHeight:23};mstrmojo._RendersInputItems=mstrmojo.provide("mstrmojo._RendersInputItems",{inputType:null,htmlName:null,itemRenderer:A,init:function(C){this._super(C);if(!this.htmlName){this.htmlName=this.id;}},preclick:function(F){var E=F.hWin,H=F.e,G=mstrmojo.dom.eventTarget(E,H);if(G&&G.nodeName.match(/input/i)){var D=parseInt(G.value,10);if(this.inputType&&this.inputType.match(/radio/i)){this.singleSelect(D);}else{var C=(G.checked)?"add":"remove";this[C+"Select"](D);}}}});mstrmojo._InputList=mstrmojo.declare(mstrmojo.ListBox,[mstrmojo._RendersInputItems],{scriptClass:"mstrmojo._InputList"});mstrmojo._InputListHoriz=mstrmojo.declare(mstrmojo.ListBoxHoriz,[mstrmojo._RendersInputItems],{scriptClass:"mstrmojo._InputListHoriz"});}());(function(){mstrmojo.requiresCls("mstrmojo.ListBox","mstrmojo.ListBoxBase");mstrmojo.ButtonItemRenderer=mstrmojo.hash.copy(mstrmojo.DivItemRenderer);mstrmojo.ButtonItemRenderer.render=function(D,A,E){var B=D.v!=="u;"?" nAll":"",C=(E.enabled===false);return'<input mstridx="'+A+'" class="'+E.itemCssClass+(E.selectedIndices[A]?" "+E.itemSelectedCssClass:"")+" "+(D.css||"")+B+'" style="'+E.itemCssText+'" type="button"  value="'+D[E.itemDisplayField]+'" '+(C?"disabled ":"")+"/>";};mstrmojo._RendersItemButtons=mstrmojo.hash.copy(mstrmojo._RendersItemDivs);mstrmojo._RendersItemButtons.itemRenderer=mstrmojo.ButtonItemRenderer;mstrmojo.ButtonList=mstrmojo.declare(mstrmojo.ListBox,[mstrmojo._RendersItemButtons],{scriptClass:"mstrmojo.ButtonList",cssClass:"mstrmojo-ButtonList",itemCssClass:"mstrmojo-ButtonItem",selectionPolicy:"toggle"});mstrmojo.requiresCls("mstrmojo.ListBoxHoriz");mstrmojo.ButtonListHoriz=mstrmojo.declare(mstrmojo.ListBoxHoriz,[mstrmojo._RendersItemButtons],{scriptClass:"mstrmojo.ButtonListHoriz",cssClass:"mstrmojo-ButtonListHoriz",itemCssClass:"mstrmojo-ButtonItem",selectionPolicy:"toggle"});}());(function(){mstrmojo.requiresCls("mstrmojo.LegacySuggestionList","mstrmojo.ui._HasScroller");var E=mstrmojo.dom;mstrmojo.ui.ScrollableSuggestionList=mstrmojo.declare(mstrmojo.LegacySuggestionList,[mstrmojo.ui._HasScroller],{scriptClass:"mstrmojo.ui.ScrollableSuggestionList",markupString:'<div id="{@id}" class="mstrmojo-ListBase mstrmojo-scrollable-suggestlist {@cssClass}" style="{@cssText}" mstrAttach:click,dblclick,mouseover,mouseout,contextmenu><div class="list-content"><div class="items-container {@icnCss}" style="{@icnCssText}">{@itemsHtml}</div></div></div>',markupSlots:{itemsContainerNode:function B(){return this.domNode.firstChild.firstChild;},scrollboxNode:function D(){return this.domNode.firstChild;},scrollNode:function H(){return this.domNode.firstChild;}},onclick:function A(I){var J=this.getItemFromTarget(I.getTarget());if(J){this._super(I);}},onitemsChange:function C(){var I=this;window.setTimeout(function(){I.hideTooltip();I.updateScrollbars();},0);},updateScrollbars:function F(){this._super();var K=this,M=K.scrollNode,I=M.clientWidth,L=K.itemsContainerNode,J=L.clientWidth;L.style.width="auto";window.setTimeout(function(){if(I>J){L.style.width=J+(I-J)+"px";}},10);},useRichTooltip:true,getItemTooltip:function(L,M){var J=E.position(M),K=M.ttp;var I={areaId:L._renderIdx+"text",cssClass:"vi-regular vi-tooltip-C",contentNodeCssClass:"regular-unitlist-tooltips",posType:"",content:K,top:J.y,left:J.x+J.w+6,enableHover:false};return I;},showTooltip:function G(I,L){var K=this.targetEl,J=this.targetItem;if(K&&K.ttp){this.richTooltip=this.getItemTooltip(J,K);if(this.richTooltip){this._super(I,L);}}}});}());(function(){mstrmojo.requiresCls("mstrmojo.WidgetList","mstrmojo._IsDial");mstrmojo.WidgetDial=mstrmojo.declare(mstrmojo.WidgetList,[mstrmojo._IsDial],{scriptClass:"mstrmojo.WidgetDial"});})();(function(){mstrmojo.requiresCls("mstrmojo.WidgetList","mstrmojo.dom","mstrmojo.TreeNodeSelector");var B=mstrmojo.dom,A={0:"closed",1:"opened",2:"leaf"};mstrmojo.TreeNode=mstrmojo.declare(mstrmojo.WidgetList,null,{scriptClass:"mstrmojo.TreeNode",markupString:'<li id="{@id}" class="mstrmojo-TreeNode {@cssClass}" style="{@cssText}" mstrAttach:mousedown,mouseover><div class="mstrmojo-TreeNode-div"><img class="mstrmojo-TreeNode-state" src="../images/1ptrans.gif" /><span class="mstrmojo-TreeNode-text {@textCssClass}"></span></div><ul class="mstrmojo-TreeNode-itemsContainer">{@itemsHtml}</ul></li>',markupSlots:{stateNode:function(){return this.domNode.firstChild.firstChild;},textNode:function(){return this.domNode.firstChild.lastChild;},itemsContainerNode:function(){return this.domNode.lastChild;}},markupMethods:{ontextChange:function(){this.textNode.innerHTML=mstrmojo.string.encodeHtmlString(this.text);},onstateChange:function(){this.stateNode.className="mstrmojo-TreeNode-state "+(A[this.state]||"closed");this.itemsContainerNode.style.display=(this.state===1)?"block":"none";},onselectedChange:function(){var D=this.selected?"addClass":"removeClass";mstrmojo.css[D](this.domNode.firstChild,["selected"]);},ondropCuePosChange:mstrmojo.WidgetList.prototype.markupMethods.ondropCuePosChange},renderOnScroll:false,listSelector:mstrmojo.TreeNodeSelector,premousedown:function C(D){var E=this._super(D),F=B.eventTarget(D.hWin,D.e);if(F===this.stateNode){if(this.state!==2){this.set("state",this.state===1?0:1);}}return E;},preclick:function(D){mstrmojo.dom.stopPropogation(D.hWin,D.e);},prechange:function(D){var E=this._super(D);if(E!==false){var F=this.tree;if(F&&F.onnodechange){F.onnodechange(D);}}return E;}});}());(function(){mstrmojo.requiresCls("mstrmojo.dom","mstrmojo.ContextMenuItem","mstrmojo.WidgetList","mstrmojo.ListMapperTable");var H=false,B=20;function G(J,K){var L=J.itemsContainerNode;L.scrollTop=Math.min(Math.max(L.scrollTop+K,0),L.scrollHeight-L.offsetHeight);}function I(K,J){if(!K._scrollInter){var L=B*(J?-1:1);K._scrollInter=window.setInterval(function(){G(K,L);},50);}}function E(J){if(J._scrollInter){window.clearInterval(J._scrollInter);J._scrollInter=null;}}mstrmojo.ContextMenu=mstrmojo.declare(mstrmojo.WidgetList,null,{scriptClass:"mstrmojo.ContextMenu",zIndex:100,visible:true,makeObservable:true,markupString:'<div id={@id} class="mstrmojo-ContextMenu {@cssClass}" style="z-index: {@zIndex};{@cssText}"><div class="mstrmojo-CM-scrollup" onmousedown="mstrmojo.all.{@id}.onmousedownarrow(self, arguments[0], true)" onmouseup="mstrmojo.all.{@id}.onmouseuparrow(self, arguments[0], true)"onclick="mstrmojo.all.{@id}.onclickarrow(self, arguments[0], true)" ></div><div class="mstrmojo-CM-itemsContainer">{@itemsHtml}</div><div class="mstrmojo-CM-scrolldown" onmousedown="mstrmojo.all.{@id}.onmousedownarrow(self, arguments[0], false)" onmouseup="mstrmojo.all.{@id}.onmouseuparrow(self, arguments[0], false)"onclick="mstrmojo.all.{@id}.onclickarrow(self, arguments[0], false)" ></div></div>',markupSlots:{scrollupNode:function(){return this.domNode.firstChild;},itemsContainerNode:function(){return this.domNode.childNodes[1];},scrolldownNode:function(){return this.domNode.lastChild;}},markupMethods:{onvisibleChange:function(){var K=this.domNode,P=this.itemsContainerNode,N=this.scrollupNode,M=this.scrolldownNode;K.style.display=this.visible?"block":"none";if(this.visible){N.style.display="none";M.style.display="none";P.style.overflow="auto";P.style.height="auto";var J=mstrmojo.dom.windowDim().h,O=K.offsetHeight,L=K.offsetWidth;if(J<O){N.style.display="block";N.style.minWidth=L+"px";M.style.display="block";M.style.minWidth=L+"px";P.style.overflow="hidden";P.style.height=(J-42)+"px";}}},onleftChange:function(){this.domNode.style.left=(this.left!=null)?this.left:"";},ontopChange:function(){this.domNode.style.top=(this.top!=null)?this.top:"";}},listMapper:mstrmojo.WidgetListMapperTable,itemFunction:function C(N,J,L){if(!H){mstrmojo.requiresCls("mstrmojo.ContextMenuItem");H=true;}var K={data:N,parent:L,hasSubmenu:L._cmSource.hasSubmenu(N),dynamicUpdate:L.dynamicUpdate,_cmSource:L._cmSource,zIndex:L.zIndex,itemIdField:L.itemIdField,itemField:L.itemField,itemChildrenField:L.itemChildrenField,itemFunction:L.itemFunction},M=new mstrmojo.ContextMenuItem(K);return M;},onmousedownarrow:function A(L,K,J){I(this,J);},onclickarrow:function F(L,K,J){G(this,B*(J?-1:1));},onmouseuparrow:function D(L,K,J){E(this);}});})();(function(){mstrmojo.requiresCls("mstrmojo.dnd","mstrmojo.ui._HasScroller","mstrmojo.DI.DIConstants");var f=mstrmojo.DI.DIConstants;function a(h){var k=document.createElement("div"),j=k.style,g=h.domNode;k.className="mstrmojo-DataGrid-avatar";j.height=g.clientHeight+"px";g.appendChild(k);h.avatar=k;return k;}function Q(g){var h=mstrmojo.dom.position(g.domNode,true);return h.x;}function O(g){return'<div class="mstrmojo-DataGrid-resizeHandle" unselectable="on" onselectstart="return false" rh="'+g+'"></div>';}function c(j){var h=j.getAttribute("rh"),g=h&&parseInt(h,10);return g;}function Z(h,l,g){var k=g.src,m=k&&k.data,j=m&&m.resizingIdx;if(!(j&&j>0)){return l&&l.apply(h,[g]);}}mstrmojo.RESIZE_NEXT_COLUMN_MODE={getRange:function G(k,j){var g=k.colSizeArray;var h=[-g[j-1]+k.minColWidth,(j==g.length-1)?g[j]-k.resizeHandleWidth-k.minColWidth:g[j]-k.minColWidth];return h;},updateSize:function F(k,j,h){var g=k.colSizeArray;g[j-1]=g[j-1]+h;g[j]=g[j]-h;},updateColumnWidth:function U(k,h,l,j){var g=k.colSizeArray;h[j-1].style.width=g[j-1]+"px";l[j-1].style.width=g[j-1]+"px";h[j].style.width=g[j]+"px";l[j].style.width=g[j]+"px";}};mstrmojo.RESIZE_ALL_COLUMN_MODE={getRange:function G(m,l){var n=m.minColWidth+m.resizeHandleWidth,g=m.colSizeArray,j=0;for(var k=l;k<g.length;++k){j+=g[k]-n;}var h=[-g[l-1]+n,j];return h;},updateSize:function F(k,o,h){var n=k.minColWidth+k.resizeHandleWidth,l=k.colSizeArray;l[o-1]=l[o-1]+h;var g=[];for(var j=0;j<l.length-o;++j){g[j]=o+j;}g.sort(function(q,r){return l[q]-l[r];});for(var j=0;j<g.length;++j){var p=h/(g.length-j);var m=l[g[j]];h-=(m>=p+n)?p:m-n;l[g[j]]=(m>=p+n)?m-p:n;}},updateColumnWidth:function U(l,h,m,k){var g=l.colSizeArray;for(var j=k-1;j<g.length;++j){h[j].style.width=g[j]+"px";m[j].style.width=g[j]+"px";}}};mstrmojo.RESIZE_CURRENT_COLUMN_MODE={getRange:function G(m,l){var n=m.minColWidth+m.resizeHandleWidth,g=m.colSizeArray,j=0;for(var k=l;k<g.length;++k){j+=g[k]-n;}var h=[-g[l-1]+n,j];return h;},updateSize:function F(k,j,h){var g=k.colSizeArray;g[j-1]=g[j-1]+h;},updateColumnWidth:function U(k,h,l,j){var g=k.colSizeArray;h[j-1].style.width=g[j-1]+"px";l[j-1].style.width=g[j-1]+"px";k.widgetResized();}};mstrmojo._CanResizeColumn=mstrmojo.provide("mstrmojo._CanResizeColumn",{draggable:true,dropZone:false,avatar:null,colSizeArray:null,resizableColumns:true,resizeHandleWidth:10,minColWidth:5,resizeColumnBehavior:mstrmojo.RESIZE_NEXT_COLUMN_MODE,createColSizeArray:function d(){var h,m,k,j,l,g;m=this.headerContainerNode;k=m&&m.getElementsByTagName("table")[0];j=k.rows[0].cells;h=[];for(l=0,g=j.length;l<g;l++){h.push(j[l].offsetWidth);}return h;},postBuildRendering:function W(){if(this._super){this._super();}if(this.avatar){this.domNode.appendChild(this.avatar);}this.colSizeArray=null;},getDragData:function E(g){var j=g.src,k=j.node,h=c(k);if(h&&h>0){return{resizingIdx:h,startingX:j.pos.x,baseX:Q(this)};}if(this._super){return this.dropZone&&this._super(g);}return null;},allowDrop:function K(g){var j=g.src,k=j&&j.data,h=k&&k.resizingIdx;if(h&&h>0){return true;}return this.dropZone;},ondragenter:function R(g){Z(this,this._super,g);},ondragover:function S(g){Z(this,this._super,g);},ondragleave:function B(g){Z(this,this._super,g);},ondrop:function X(g){Z(this,this._super,g);},isDragValid:function C(g){var j=g.src,k=j&&j.data,h=k&&k.resizingIdx;if(h&&h>0){return true;}if(this._super){return this._super(g);}return false;},ondragstart:function Y(g){var k=g.src,l=k&&k.data,j=l&&l.resizingIdx;if(j&&j>0){var h=this.avatar||a(this);this.ownAvatar=true;h.style.left=(l.startingX-l.baseX)+"px";h.style.display="block";document.body.style.cursor="col-resize";if(!this.colSizeArray){this.colSizeArray=this.createColSizeArray();this._firstTimeResize=true;}l.resizingRange=this.resizeColumnBehavior.getRange(this,j);return ;}if(this._super){this._super(g);}},ondragmove:function P(h){var p=h.src,j=p&&p.data,n=j&&j.resizingIdx;if(n&&n>0){var o=h.tgt,k=this.avatar,m=j.resizingRange,l=o.pos.x-j.startingX,g=Math.min(m[1],Math.max(l,m[0]));j.deltaX=g;if(k){k.style.left=(j.startingX-j.baseX+g)+"px";}}else{if(this._super){this._super(h);}}},ondragend:function L(l){var t=l.src,m=t&&t.data,q=m&&m.resizingIdx;if(q&&q>0){var g=this.titleColGroup,r=g&&g.childNodes,o=this.dataColGroup,p=o&&o.childNodes,k=r.length,n=this.colSizeArray,h=m.deltaX;this.resizeColumnBehavior.updateSize(this,q,h);if(this._firstTimeResize){var j;for(j=0;j<k;j++){r[j].style.width=n[j]+"px";p[j].style.width=n[j]+"px";}this._firstTimeResize=false;}else{this.resizeColumnBehavior.updateColumnWidth(this,r,p,q);}this.avatar.style.display="none";document.body.style.cursor="";this.ownAvatar=false;}else{if(this._super){this._super(l);}}}});mstrmojo.requiresCls("mstrmojo._CanResizeColumn","mstrmojo.ListMapperTable","mstrmojo.WidgetList");function J(j){var m=document.createElement("colgroup"),g=j.length,h,l;for(l=0;l<g;l++){var k=document.createElement("col");h=j[l];if(h.colWidth){k.style.width=h.colWidth+"px";}k.className=h.colCss||("col"+l);m.appendChild(k);}return m;}function I(h){var j=h._headerWidgets_,g=j&&j.length;if(g>0){var k;for(k=0;k<g;k++){j[k].destroy(true);}}}function A(l,g,k,n,h){var j=[],m=l.headerWidget;k=k?(" "+k):"";n=n||this._headerWidgets;h=h?(" "+h):' w="1"';j.push("<td"+k+">");if(g>0&&this.resizableColumns){j.push(O(g));}j.push('<div class="mstrmojo-DataGrid-headerText');j.push(l.headerCss?" "+l.headerCss:"");if(m){n.push(mstrmojo.hash.copy(m));j.push('"'+h+">");}else{j.push('">');}j.push(l.headerText||"&nbsp");j.push("</div>");j.push("</td>");return j.join("");}function b(g,o){var j,m,n,h,p,l,k=[];g=g||"_headerWidgets";o=o||"1";j=this[g];m=j.length;if(m>0){n=this.headerContainerNode.getElementsByTagName("div");h=mstrmojo.array.filter(n,function(q){return q.getAttribute("w")==o;});for(l=0;l<m;l++){j[l].placeholder=h[l].firstChild;j[l].dataGrid=this;p=mstrmojo.registry.ref(j[l]);p.render();k.push(p);}}this[g+"_"]=k;}mstrmojo.DataGrid=mstrmojo.declare(mstrmojo.WidgetList,[mstrmojo._CanResizeColumn,mstrmojo.ui._HasScroller],{scriptClass:"mstrmojo.DataGrid",banding:true,resizableColumns:true,columns:null,items:null,listMapper:mstrmojo.WidgetListMapperTable,lockHeader:false,contentWidth:"",renderHook:{},shouldDisableItem:function(){return false;},markupString:'<div id="{@id}" class="mstrmojo-DataGrid {@cssClass}" style="{@cssText}" mstrAttach:mousedown,mouseup><div class="mstrmojo-DataGrid-headerContainer">{@headerHtml}</div><div class="mstrmojo-DataGrid-itemsScrollBox" style="position:relative;"><div class="mstrmojo-DataGrid-itemsContainer" style="{@itemsContainerCssText}">{@itemsHtml}</div><div class="mstrmojo-ListBase2-dropCue"><div class="mstrmojo-ListBase2-dropCue-inner"></div></div></div></div>',markupSlots:{scrollboxNode:function(){return this.domNode.lastChild;},itemsContainerNode:function(){return this.domNode.lastChild.firstChild;},dropCueNode:function(){return this.domNode.lastChild.lastChild;},headerContainerNode:function(){return this.domNode.firstChild;},headerRows:function(){return this.domNode.firstChild.firstChild.rows;},bodyRows:function(){return this.domNode.lastChild.firstChild.firstChild.rows;}},markupMethods:{oncontentWidthChange:function(){var h=this.contentWidth,j=this.headerContainerNode,g=this.itemsContainerNode;if(h&&j&&g){j.style.width=h;g.style.width=h;}},onlockHeaderChange:function(){mstrmojo.css.toggleClass(this.domNode,"lockHeader",this.lockHeader);},onvisibleChange:function(){this.domNode.style.display=this.visible?this.cssDisplay:"none";}},setupScrollNodes:function M(){this.scrollNode=this.scrollboxNode;},itemFunction:function(j,g,h){var k=new mstrmojo.DataRow({columns:h.columns,data:j,disable:h.shouldDisableItem(j),idx:g,dataGrid:h,parent:h});return k;},preBuildRendering:function D(){var m=this.renderHook;if(m&&m.pre){m.pre.apply(this,[A]);}else{var h=this.columns,g=h.length,j=['<table class="mstrmojo-DataGrid-headerTable" cellspacing="0" cellpadding="0"><tr>'],l;this._headerWidgets=[];var k;for(k=0;k<g;k++){l=A.apply(this,[h[k],k]);j.push(l);}j.push("</tr></table>");this.headerHtml=j.join("");}if(this._super){this._super();}},postBuildRendering:function W(){if(this._super){this._super();}var j=this.renderHook;if(j&&j.post){j.post.apply(this,[J,b]);}else{b.apply(this);this.titleColGroup=J(this.columns);}var g=this.titleColGroup,o=g.cloneNode(true),l=this.headerContainerNode,n=l&&l.getElementsByTagName("table")[0],p=this.itemsContainerNode,m=this.scrollboxNode,k=this.domNode,h=p&&p.getElementsByTagName("table")[0];this.dataColGroup=o;if(n&&h){n.insertBefore(g,n.firstChild);h.insertBefore(o,h.firstChild);}if(this.lockHeader){m.style.height=k.offsetHeight-l.offsetHeight+"px";mstrmojo.dom.attachEvent(m,"scroll",function(q){l.style.left=-m.scrollLeft+"px";});}},refresh:function H(g){I(this);if(this._super){this._super(g);}},destroy:function e(g){I(this);this._super(g);},unrender:function V(l){var j=this._headerWidgets_,h=j&&j.length,g;if(h>0){var k;for(k=0;k<h;k++){g=j[k];if(g&&g.hasRendered){g.unrender(true);}}}this._super(l);}});mstrmojo.requiresCls("mstrmojo.css","mstrmojo.hash","mstrmojo.Container");mstrmojo.DataRow=mstrmojo.declare(mstrmojo.Container,null,{scriptClass:"mstrmojo.DataRow",cssClass:"mstrmojo-DataRow",dataTextCSSClass:"mstrmojo-DataRow-text",columns:null,disable:false,markupMethods:{onselectedChange:function(){mstrmojo.css.toggleClass(this.domNode,"selected",this.selected);}},buildDom:function(){this.children=[];var n=document.createElement("tr"),r=this.data,x=this.idx,h=this.dataGrid,o=this.cssClass,AA=this.columns,g=this.children,k=this.disable,j,t=-1,z,u;n.setAttribute("id",this.id);if(h.banding){o+=(x%2==1)?" odd":" even";}n.className=o+(mstrmojo.string.isEmpty(r[h.itemDisplayField||"n"])?" empty-row":"")+(" "+r[h.itemCSSField||"itemCss"]||"")+(k?" disabled":"");var m,q;for(m=0,q=AA.length;m<q;m++){z=AA[m];u=(z.dataWidgetBuilder&&z.dataWidgetBuilder(r))||z.dataWidget;j=document.createElement("td");if(z.applyStyle2Cell&&z.colCss){j.setAttribute("class",z.colCss);}n.appendChild(j);if(u){j.setAttribute("w","1");t++;g.push(mstrmojo.hash.copy(u,{slot:"slot"+t,data:r,idx:x,dataGrid:h}));}else{if(z.dataFunction){j.innerHTML=z.dataFunction(r,x,h);}else{var l=mstrmojo.string.htmlAngles(r[z.dataField||"n"])||"&nbsp",p=z.tooltip?' title="'+l+'"':"";j.innerHTML='<div class="'+this.dataTextCSSClass+'" '+p+">"+l+"</div>";}}}this.initChildren();n.mstrmojoId=this.id;return n;},buildRendering:function N(){this._super();var l=this.domNode.childNodes,g=l.length,k={},j=0,m,h;for(h=0;h<g;h++){m=l[h];if(m.getAttribute("w")=="1"){k["slot"+j]=m;j++;}}this.addSlots(k);}});}());(function(){mstrmojo.requiresCls("mstrmojo.Arr","mstrmojo.Button","mstrmojo.HBox","mstrmojo.FishEye");var A=function(B){return mstrmojo.hash.copy(B,{scriptClass:"mstrmojo.Button",text:"",enabled:false,dir:"left",cssClass:"mstrmojo-icon left",onclick:function(){var D=this.parent.fishEyeList,C=D&&D.scroll(this.dir,D.step);}});};mstrmojo.FishEyeContainer=mstrmojo.declare(mstrmojo.HBox,null,{scriptClass:"mstrmojo.FishEyeContainer",cssClass:"mstrmojo-FishEyeContainer",selectedIndex:-1,setItems:function(B){this.fishEyeList.set("items",B);},setSelectedIndex:function(B){this.fishEyeList.set("selectedIndex",B);},scrollable:false,rightScrollbale:false,children:[A({bindings:{enabled:"!!this.parent.scrollable"}}),({scriptClass:"mstrmojo.FishEye",alias:"fishEyeList",items:mstrmojo.Arr.makeObservable([]),srcId:"obList"}),A({alias:"feScrollRight",cssClass:"mstrmojo-icon right",dir:"right",bindings:{enabled:"!!this.parent.rightScrollable"}})]});mstrmojo.css=mstrmojo.hash.copy({getStyleValue:function(D,E){var B=null;if(D.currentStyle){E=(E==="float"?"styleFloat":E);B=D.currentStyle[E];}if(document.defaultView&&document.defaultView.getComputedStyle){E=(E==="float"?"cssFloat":E);var C=document.defaultView.getComputedStyle(D,null);B=C?C[E]:null;}return B;},setStyleValue:function(D,F,E){var B=function(G){return !!(G&&(typeof G==="object")&&(typeof G.length==="number"));};if(B(F)&&B(E)){var C;for(C in F){D.style[F[C]]=E[C];}}else{D.style[F]=E;}}},mstrmojo.css);}());(function(){mstrmojo.requiresCls("mstrmojo.OBList","mstrmojo.ui._IsIncFetchList","mstrmojo.ui._HasScroller");var F=mstrmojo.array,A=mstrmojo.chart.model.enums.EnumDSSObjectType;function D(G){return{browseConfig:null,parent:G,next:function(J){var I=this.browseConfig;if(!I){return ;}I.blockBegin+=I.blockCount;var H={taskId:"searchMetadata",styleName:"MojoFolderStyle",blockBegin:I.blockBegin,blockCount:I.blockCount,includeAncestorInfo:true};if(I.folderLinksContextId){H.folderLinksContextId=I.folderLinksContextId;}if(I.includeObjectDesc){H.includeObjectDesc=I.includeObjectDesc;}if(I.rootFolderID){H.rootFolderID=I.rootFolderID;}else{if(I.rootFolderType){H.rootFolderType=I.rootFolderType;}}if(I.browsableTypes){H.objectType=I.browsableTypes;}if(I.searchPattern){H.searchPattern=I.searchPattern;if(I.recursive){H.recursive=I.recursive;}}this.parent.set("waiting",true);if(I.dataProvider){I.dataProvider.serverRequest(H,J);}else{mstrmojo.xhr.request("POST",mstrConfig.taskURL,J,H);}},hasNext:function(){var H=this.browseConfig;return(H.blockBegin+H.blockCount-1)<H.totalSize;}};}mstrmojo.mstr.ui.IncFetchOBList=mstrmojo.declare(mstrmojo.OBList,[mstrmojo.ui._IsIncFetchList,mstrmojo.ui._HasScroller],{scriptClass:"mstrmojo.mstr.ui.IncFetchOBList",cssClass:"mstrmojo-OBList mstrmojo-IF-OBList",makeObservable:true,renderOnScroll:false,waiting:false,markupString:'<div id="{@id}" class="mstrmojo-ListBase2 {@cssClass}" style="position:relative;{@cssText}" mstrAttach:keypress,mousedown,mouseup,dblclick><div class="scroll-box" style="{@scrollBoxCssText}"><div class="mstrmojo-ListBase2-itemsContainer" style="{@itemsContainerCssText}">{@itemsHtml}</div><div class="mstrmojo-ListBase2-dropCue {@cssClass}"><div class="mstrmojo-ListBase2-dropCue-inner"></div></div></div></div>',markupSlots:{scrollboxNode:function(){return this.domNode.firstChild;},itemsContainerNode:function(){return this.domNode.firstChild.firstChild;},dropCueNode:function(){return this.domNode.firstChild.lastChild;}},markupMethods:{onwaitingChange:function(){this.onwaitingChange();}},init:function E(G){if(this._super){this._super(G);}this.ifDataHelper=D(this);if(G.browseConfig){this.ifDataHelper.browseConfig=G.browseConfig;}},onwaitingChange:mstrmojo.emptyFn,addItems:function B(G){var H=this.browseConfig.browsableViewMedias;if(G&&H){var I={};F.forEach(H.split(","),function(J){I[parseInt(J,10)]=true;});G=F.filter(G,function(J){return(J.t!==A.DssTypeDocumentDefinition)||I[J.dvm];});}this.add(G,-1);this.set("waiting",false);if(this._super){this._super(G);}if(this.scrollNode){this.updateScrollbars();}},setupScrollNodes:function C(){this.scrollNode=this.scrollboxNode;}});}());(function(){mstrmojo.requiresCls("mstrmojo.Container","mstrmojo.ToolBar","mstrmojo.boxmodel","mstrmojo.array","mstrmojo.EnumRWUnitType","mstrmojo.dom","mstrmojo.css");var Q=["background-color","border","border-color","border-left","border-style","border-top","border-width","filter","top","left","z-index","fx","normWidth","normHeight","normZIndex","normTop","normLeft","tbborder","lrborder","ttl"],Y=["width","height"],p="p_fmts";var m="px";var k={getContentHeight:function(t,w){var u=w.ttl&&w.ttl.height;if(t&&u&&!this.floatingToolbar){return Math.max(parseInt(t,10)-parseInt(u,10),0)+m;}return"";},getPortletMinHeight:function(t){return t.ttl.height;},adjustTitleCss:function(){return ;}};var g={getContentHeight:function(t){return t;},getPortletMinHeight:function(){return 0;},adjustTitleCss:function(t){t.titlebarNodeClass+=" floating";return ;}};function A(x,u){var w=this.parent,t=x+"DirtyKey";if(w[t]){w[t](u);}}function P(){this.toolbarTitleTextNode.innerHTML=this.title+(this.count?" ("+this.count+")":"");}function j(){var u=this.parent,x=u&&u.defn;if(x&&parseInt(x.t,10)===mstrmojo.EnumRWUnitType.PANEL){var t=u.parent,w=t.defn;if(w&&w.ifp){return t;}}return null;}var R=mstrmojo.hash,G=2;mstrmojo.DocPortlet=mstrmojo.declare(mstrmojo.Container,[mstrmojo._Formattable],{scriptClass:"mstrmojo.DocPortlet",floatingTitle:false,floatingTitleHeight:30,n:"",buttonWidth:17,markupString:'<div class="mstrmojo-portlet {@borderCss}" nm="{@n}" style="{@portletNodeCssText}"><div class="mstrmojo-portlet-slot-shadow" style="{@shadowNodeCssText}"></div><div class="mstrmojo-portlet-container" style="{@portletContainerNodeCssText}"><div class="mstrmojo-portlet-titlebar {@titlebarNodeClass}" style="{@titlebarNodeCssText}"><table style="height:100%;width:100%" class="mstrmojo-portlet-titlebar-table" cellspacing="0" cellpadding="0"><tr><td class="mstrmojo-portlet-slot-toolbar-left {@leftToolbarNodeClass}" style="{@leftToolbarNodeCssText}"></td><td class="mstrmojo-portlet-title" style="{@titleNodeCssText}"><div style="overflow: hidden;"></div></td><td class="mstrmojo-portlet-slot-toolbar {@toolbarNodeClass}" style="{@rightToolbarNodeCssText}"></td></tr></table></div><div class="mstrmojo-portlet-buttonbar {@buttonbarNodeClass}" style="{@buttonbarNodeCssText}"></div><div class="mstrmojo-portlet-slot-content" style="{@contentNodeCssText}"></div></div></div>',rightToolbarNodeCssText:"",leftToolbarNodeCssText:"",titleNodeCssText:"",titlebarNodeClass:"",titlebarNodeCssText:"",contentNodeCssText:"",borderCss:"no-border",buttonbarNodeClass:"",buttonbarNodeCssText:"",markupSlots:{containerNode:function(){return this.domNode.lastChild;},portletNode:function(){return this.domNode;},portletContainerNode:function(){return this.domNode.lastChild;},dimNode:function(){return this.domNode.lastChild;},shadowNode:function(){return this.domNode.firstChild;},titleNode:function(){return this.domNode.lastChild.childNodes[0];},buttonbarNode:function(){return this.domNode.lastChild.childNodes[1];},toolbarNode:function(){return this.domNode.lastChild.firstChild.childNodes[0].rows[0].cells[2];},toolbarTitleTextNode:function(){return this.domNode.lastChild.firstChild.childNodes[0].rows[0].cells[1].firstChild;},leftToolbarNode:function(){return this.domNode.lastChild.firstChild.childNodes[0].rows[0].cells[0];},contentNode:function(){return this.domNode.lastChild.lastChild;}},markupMethods:{ontitleChange:function(){P.call(this);},oncountChange:function(){P.call(this);},onfcChange:function(){if(this.fc&&this.content){this.updateContentHeight();}}},formatHandlers:{portletContainerNode:["RW","B","fx","background-color"],shadowNode:["RW","B","fx","background-color"],buttonbarNode:{src:"ttl",props:["background-color"]},titlebarNode:{src:"ttl",props:["F","B","background-color","height","fx","text-align","vertical-align"]},titleNode:{src:"ttl",props:["vertical-align","P","text-decoration"]}},updateServer:true,fc:false,content:null,rightToolbar:null,leftToolbar:null,floatingToolbar:false,_ts:k,getCacheKey:function F(){return this._super()+"-portlet";},getFormats:function M(){var u=this.content,t=u&&u.getFormats();return t&&t[p];},updateContentHeight:function e(z){var t=this.getFormats(),u=this.content,x=u.dimNode||u.domNode,w=((t.ttl&&parseInt(t.ttl.height,10))||0);if(x){if(!z){w+=((this.fc||this.isInFilterPanel())?x.offsetHeight:(t.height?parseInt(t.height,10):0));}this.containerNode.style.height=w+m;this.shadowNode.style.height=w+m;}},init:function q(t){this._super(t);var u=this.content;this.n=(t&&t.defn&&t.defn.n)||"";if(u&&u.getFormats()&&!this.getFormats()){this._createFormats();}},preBuildRendering:function B(){var u=this._ts=(this.floatingTitle)?g:k;if(this.isInFilterPanel()){var w=R.clone(this.formatHandlers);w.portletContainerNode=["z-index","height","B","backgroud-color"];w.shadowNode=["z-index","height","B","fx","background-color"];this.formatHandlers=w;}this._super();u.adjustTitleCss(this);var t="display:none;";if(!this.leftToolbar){this.leftToolbarNodeCssText+=t;}if(!this.toolbar){this.toolbarNodeCssText+=t;}var x=mstrmojo._Formattable.getBorderWidths(this);if(x.l||x.t||x.r){this.borderCss="has-border";}},postBuildRendering:function Z(){var x=mstrmojo.dom,AF=this.titleNode,AE=this.onclicktitle;if(this.floatingTitle&&this.titleNode){document.body.appendChild(this.titleNode);var z=mstrmojo.css,AB=this.contentNode,AC=this;if(!this._onhover){this._onhovertt=function(){z.addClass(AC.titleNode,["visible"]);AC._onflt=true;return true;};this._onhoverofftt=function(){z.removeClass(AC.titleNode,["visible"]);AC._onflt=false;return true;};this._onhover=function(){var AG=AC.titleNode;z.addClass(AG,["visible"]);var AH=x.position(AC.contentNode,true);AG.style.top=(AH.y-AG.clientHeight+2)+m;AG.style.left=AH.x+m;return true;};this._onhoveroff=function(){z.removeClass(AC.titleNode,["visible"]);return true;};}x.attachEvent(AB,"mouseover",this._onhover);x.attachEvent(AB,"mouseout",this._onhoveroff);x.attachEvent(AF,"mouseover",this._onhovertt);x.attachEvent(AF,"mouseout",this._onhoverofftt);}if(AF&&AE){x.attachEvent(AF,"click",AE);}if(this._super){this._super();}var AA=this.getFormats();this.set("fc",AA&&!AA.height);if(this.isInFilterPanel()&&!this.isHorizFP()){var u=this.portletContainerNode.style,w=this.shadowNode.style,AD=this.parent;u.width=w.width="99%";u.top=w.top=AD.topStart+m;u.left=w.left=G+m;}else{if(this.isInFilterPanel()&&this.isHorizFP()){G=8;this.portletContainerNode.style.left=this.shadowNode.style.left=parseInt(AA.left,10)+G*this.orgPos+m;}else{if(this.defn.ifp){this.adjustFPHeight2Fit();}}}if(this.buttonbarNode.clientHeight>0){this.buttonbarNode.style.height=this.buttonbarNode.clientHeight*this.model.getZoomFactor()+"px";}},adjustFPHeight2Fit:function(){var w=mstrmojo.dom,t=w.position(this.titleNode),u=w.position(this.contentNode).y-t.y-t.h;this.content.domNode.style.height=parseInt(this.defn.fmts.height,10)-u+"px";},unrender:function E(w){if(this.floatingTitle&&this.titleNode){var z=this.domNode,u=this.titleNode,x=mstrmojo.dom;if(z&&this._onhover){x.detachEvent(z,"mouseover",this._onhover);}if(z&&this._onhoveroff){x.detachEvent(z,"mouseout",this._onhoveroff);}if(u&&this._onhovertt){x.detachEvent(u,"mouseover",this._onhovertt);}if(u&&this._onhoverofftt){x.detachEvent(u,"mouseout",this._onhoverofftt);}if(u){document.body.removeChild(u);}}if(this._super){this._super(w);}},updateStyle:function(u,t){var z=this.shadowNode.style,x=this.containerNode.style;z.height=x.height=u;z.width=x.width=t;},_createFormats:function W(){var AA=this.content&&this.content.getFormats(),x;x=AA.p_fmts={};var t,z;for(t in Q){z=Q[t];if(AA[z]!==undefined){x[z]=AA[z];delete AA[z];}}for(t in Y){z=Y[t];if(AA[z]!==undefined){x[z]=AA[z];}}AA.height=this._ts.getContentHeight(AA.height,x);if(mstrmojo.dom.isIE&&x.fx&&x.fx.ds&&!x["background-color"]){x["background-color"]="#ffffff";}var w=x.ttl,u=w&&w["background-color"];if(u){this.titlebarNodeClass=mstrmojo.color.getContrastingColor(u,"light","dark");}},refresh:function r(){if(!this.hasRendered){return ;}var u=this.children,t;for(t=u.length-1;t>=0;t--){u[t].refresh();}},isInFilterPanel:function L(){return(j.call(this)!==null);},isHorizFP:function(){if(this.isInFilterPanel()){var t=this.getFilterPanel();return t&&t.defn&&parseInt(t.defn.fds,10)===2;}return false;},getFilterPanel:function H(){return j.call(this);},getContainerHeight:function d(){return this.containerNode.clientHeight;},relocate:function C(t){if(this.isInFilterPanel()&&!this.isHorizFP()){this.portletContainerNode.style.top=this.shadowNode.style.top=t+m;}},setInfoWindowDimensions:function o(z){var u=this.domNode.style,t=this.shadowNode.style,w=this.portletContainerNode.style,x=mstrmojo._Formattable.getBorderWidths(this);z.h-=x.h;z.w-=x.w;t.height=w.height=u.height=z.h+m;t.width=w.width=u.width=z.w+m;z.h-=this.titleNode.offsetHeight;this.toolbarNode.style.display="none";},addDirtyKey:function K(t){A.call(this,"add",t);},removeDirtyKey:function J(t){A.call(this,"remove",t);},setDirtyChildren:function a(){var t=this.content;if(t&&t.setDirtyChildren){t.setDirtyChildren.apply(t,arguments);}}});var X=0,O=1,l=2;function N(t){var u=this.content.defn;if(u){u.set("ds",t);}}function n(t){return{FormattingOrder:{ZIndex:this.getFormats()["z-index"]},FormattingView:{WindowState:t}};}function b(AH,AF,t,AI){var AD=this.content,AG=AD.k,AC=mstrmojo.boxmodel.px2Inches,x=AD.model.docModel||AD.model,AK=x.getZoomProps(),z=this.getFormats(),u=AF!==undefined&&t!==undefined,AJ={},AA=this,AB=n.call(this,AH),AE=!(AD.defn.t===mstrmojo.EnumRWUnitType.GRIDGRAPH||AD.defn.t===mstrmojo.EnumRWUnitType.GRAPH);if(u){AB.FormattingSize={OldHeight:AC(AK,AF),OldWidth:AC(AK,t),Height:AC(AK,parseInt(z.height,10)),Width:AC(AK,parseInt(z.width,10))};}AJ.success=function(w){var AL=w&&w.data;if(AL){x.loadPartialData(AL,AG);}N.call(AA,AH);var AM=AA.parent;if(AM.adjustSectionSize&&u){AM.adjustSectionSize();}};x.updateUnitFormat(AD,1,AB,AJ,{params:{suppressData:AE,rapidExec:AE},config:u?null:{silent:true},preserveUndo:true});if(!u&&!(AI&&AI.all)){if(x.saveRWProps){x.saveRWProps(AG,undefined,1,this.loadDataOnResize,AJ,true);}}}function U(){var AB=this.content;if(!AB){return ;}var z=function(AF){mstrmojo.array.forEach(AF,function(AG){if(AG.ds!==undefined){AG.set("visible",(AG.ds!==AB.defn.ds));}});},AC;if(this.isInFilterPanel()){var w=(parseInt(this.defn.ds,10)===X);AB.set("visible",w);this.updateContentHeight(!w);AC=this.leftToolbar;z(AC&&AC.children);var x=this.parent;if(x.refreshFP){x.refreshFP();}}else{var t=AB.getFormats(),AD=this.getFormats(),u=this.portletContainerNode.style,AE=this.shadowNode.style,AA=this.contentNode.firstChild.style;AA.height=t.height;AA.width=t.width;AE.height=u.height=AD.height;AE.width=u.width=AD.width;AE.top=u.top=AD.top;AE.left=u.left=AD.left;if(AD["z-index"]!==undefined){AE.zIndex=u.zIndex=AD["z-index"];}AC=this.rightToolbar;z(AC&&AC.children);if(AB.resize){AB.resize();}}}mstrmojo.DocResizablePortlet=mstrmojo.declare(mstrmojo.DocPortlet,null,{scriptClass:"mstrmojo.DocResizablePortlet",loadDataOnResize:false,_createFormats:function W(){this._super();var u=this.getFormats();var t=parseInt(this.defn.ds,10);if(t===X){u.normHeight=u.height;u.normWidth=u.width;if(u["z-index"]!==null&&u["z-index"]!==undefined){u.normZIndex=u["z-index"];}}if(t!==l){u.normTop=u.top;u.normLeft=u.left;}},onmaximize:function f(){var x=this.parent,AB=this.content,AA=AB&&AB.getFormats(),w=this.getFormats(),u=w.height,t=w.width,z=mstrmojo._Formattable.getBorderWidths(this);this.clearCache();AB.clearCache();w.height=(parseInt(x.getHeight(),10)-z.h)+m;AA.height=this._ts.getContentHeight(w.height,w);w.width=AA.width=(x.getWidth()-z.w)+m;w.top=w.left=0;w["z-index"]=x.getMaxZIndex()+1;b.call(this,l,u,t);},onminimize:function c(){var AA=this.content,u=AA.dimNode||AA.domNode,z=AA&&AA.getFormats(),x=this.getFormats(),w=x.height||u.offsetHeight,t=x.width;this.clearCache();AA.clearCache();x.width=z.width=x.normWidth;x.top=x.normTop;x.left=x.normLeft;if(x.normZIndex!==null&&x.normZIndex!==undefined){x["z-index"]=x.normZIndex;}z.height=0;x.height=this._ts.getPortletMinHeight(x);b.call(this,O,w,t);},onrestore:function S(){var z=this.content,x=z&&z.getFormats(),w=this.getFormats(),u=w.height,t=w.width;this.clearCache();z.clearCache();w.height=w.normHeight;x.height=this._ts.getContentHeight(w.height,w);w.width=x.width=w.normWidth;w.top=w.normTop;w.left=w.normLeft;if(w.normZIndex!==null&&w.normZIndex!==undefined){w["z-index"]=w.normZIndex;}b.call(this,X,u,t);},changeWindowState:function I(x){N.call(this,x);var u=this.content,z=n.call(u,x),t=u.model.docModel||u.model;return t.getUnitFormatAction(u,1,z);},oncollapse:function V(t){b.call(this,O,undefined,undefined,t);},onexpand:function D(t){b.call(this,X,undefined,undefined,t);},adjustFP:function h(){var u=(parseInt(this.defn.ds,10)===X);this.content.set("visible",u);this.updateContentHeight(!u);var t=this.parent;if(t.refreshFP){t.refreshFP();}},postBuildRendering:function Z(){if(!this._sub_dsChange){this._sub_dsChange=this.defn.attachEventListener("dsChange",this.id,U);}this._super();if(this.isInFilterPanel()){var t=(parseInt(this.defn.ds,10)===X);this.updateContentHeight(!t);}}});mstrmojo.DocPortlet.ST_RESTORE=X;mstrmojo.DocPortlet.ST_MAX=l;mstrmojo.DocPortlet.ST_MIN=O;}());(function(){mstrmojo.requiresCls("mstrmojo.dom","mstrmojo.hash","mstrmojo.Box","mstrmojo.array","mstrmojo._HasLayout","mstrmojo.ui.ColumnContainer");var E=mstrmojo.dom,G=mstrmojo.hash,C=mstrmojo.array;mstrmojo.ui.ColumnWalk=mstrmojo.declare(mstrmojo.Box,[mstrmojo._HasLayout],{scriptClass:"mstrmojo.ui.ColumnWalk",markupString:'<div id="{@id}" class="mstrmojo-ui-ColumnWalk cf {@cssClass}" mstrAttach:click></div>',layoutConfig:{h:{containerNode:"100%"},xt:true},currentColumn:-1,addNextColumn:function B(K){var J=this.children||[],L=J.length,I=J[L-1];var M=this.addChildren([G.copy(K,{scriptClass:"mstrmojo.ui.ColumnContainer",idx:L})])[0];if(I){I.set("next",M);}},onclick:function A(I){var K=I.getTarget();if(K){var J=this.children;C.forEach(J,function(M,L){if(E.contains(M.domNode,K,true,M.domNode)){this.set("currentColumn",L);}},this);}},oncurrentColumnChange:function D(I){var K=this.children,M=K[I.valueWas],J=K[this.currentColumn],L="active";if(M){M.set(L,false);}J.set(L,true);},removeTrailingContainer:function H(K){var J=this,I=this.children;if(!I||K>=I.length-1){return ;}C.forEach(I.slice(K+1),function(L){J.removeAndDestroyChild(L);});if(K>=0){I[K].set("next",null);}},insertAndRemoveTrailing:function F(J,I){this.removeTrailingContainer(J);this.addNextColumn(I);}});}());(function(){mstrmojo.requiresCls("mstrmojo.Dialog","mstrmojo.Button");mstrmojo.requiresDescs(1442,3610,11581,11582);var E=mstrmojo.css,A="on",D=mstrmojo.desc(11581,"Click for more details"),B=mstrmojo.desc(11582,"Collapse");mstrmojo.qb.QBAlertDialog=mstrmojo.declare(mstrmojo.Dialog,null,{scriptClass:"mstrmojo.qb.QBAlertDialog",cssClass:"mstrmojo-qb-AlertDialog",title:mstrmojo.desc(3610),genericMsg:"",detailedMsg:"",width:"475px",isExpanded:false,buttons:[mstrmojo.Button.newInteractiveButton(mstrmojo.desc(1442),function(H){var I=this.parent.parent;I.destroy();if(I.callback){I.callback();}},"#666666")],children:[{scriptClass:"mstrmojo.Label",alias:"genericLabel",text:"",cssClass:"mstrmojo-qb-alertdialog-genericlabel"},{scriptClass:"mstrmojo.Label",alias:"expandButton",text:"",cssClass:"mstrmojo-qb-alertdialog-expandbutton",cssDisplay:"",onclick:function C(H){var I=this.parent;I.isExpanded=!I.isExpanded;I.expandButton.set("text",I.isExpanded?B:D);E.toggleClass(I.detailedLabel.domNode,A,I.isExpanded);}},{scriptClass:"mstrmojo.Label",alias:"detailedLabel",text:"",cssClass:"mstrmojo-qb-alertdialog-detailedlabel",cssDisplay:""}],postBuildRendering:function F(){if(this._super){this._super();}this.isExpanded=false;this.genericLabel.set("text",this.genericMsg);this.detailedLabel.set("text",this.detailedMsg||"");this.expandButton.set("text",D);E.toggleClass(this.expandButton.domNode,A,!!this.detailedMsg);}});mstrmojo.qb.old_alert=function G(I,M,O,N,J){var H="mstr-qb-alert",P,K={id:H,zIndex:1000};try{mstrmojo.all[H].destroy();}catch(L){}if(J){mstrmojo.hash.copy(J,K);}P=new mstrmojo.qb.QBAlertDialog(K);P.title=N||mstrmojo.desc(3610);P.genericMsg=I;P.detailedMsg=M;P.callback=O;P.render();};mstrmojo.qb.alert=function G(H,L,K,J,I){if(mstrApp.isBISource){mstrApp.getRootController().handleServerRequestError(H,L,K,J);}else{mstrmojo.error({shortDesc:H,longDesc:L},K,{title:J||mstrmojo.desc(96,"Error"),allowHTML:true});}};}());(function(){mstrmojo.requiresCls("mstrmojo.dom","mstrmojo.css","mstrmojo.fx","mstrmojo.Dialog","mstrmojo.Label","mstrmojo._IsPopup","mstrmojo._HasPopup","mstrmojo._IsMovable","mstrmojo.ui._HasUITheme","mstrmojo.Button","mstrmojo.dom","mstrmojo.hash","mstrmojo.array","mstrmojo.tooltip","mstrmojo.ui.editors.ErrorDialogContent");var k=mstrmojo.func.composite,M=mstrmojo.dom,a=mstrmojo.Button.newWebButton,C=mstrmojo.css,Z=mstrmojo.all,N=mstrmojo.hash,c=mstrmojo.DI.DIHelpers,X=mstrmojo.array;function W(r){if(!this.modal){return ;}var t=window.mstrApp;if(t&&t.modalEditorChange){t.modalEditorChange(this.id,r);}}mstrmojo.Editor=mstrmojo.declare(mstrmojo.Dialog,[mstrmojo._IsPopup,mstrmojo._HasPopup,mstrmojo._IsMovable,mstrmojo.ui._HasUITheme],{scriptClass:"mstrmojo.Editor",title:"",allowHTMLTitle:false,help:"",autoClose:false,showTitle:true,openEffect:null,themeClassName:"mojo-theme-light",useRichTooltip:true,closeEffect:null,onEditorResized:null,markupString:'<div id="{@id}" class="mstrmojo-Editor-wrapper"><div class="mstrmojo-Editor {@cssClass}" style="z-index:{@zIndex};{@cssText}" mstrAttach:mouseup,mousedown,click,contextmenu>{@titlebarHTML}<div class="mstrmojo-Editor-content"></div><div class="mstrmojo-Editor-buttons"></div></div><div class="mstrmojo-Editor-curtain"></div></div>',titleMarkupString:'<div class="mstrmojo-Editor-title-container"><div class="mstrmojo-Editor-title"></div><div class="edt-title-btn mstrmojo-Editor-help" tooltip="'+mstrmojo.desc(1143,"help")+'"></div><div class="edt-title-btn mstrmojo-Editor-close" tooltip="'+mstrmojo.desc(2102,"Close")+'"></div></div><div class="mstrmojo-Editor-titleSpacer"></div>',markupSlots:{editorNode:function Y(){return this.domNode.firstChild;},titleContainerNode:function l(){return this.domNode.firstChild.firstChild;},titlebarNode:function n(){return this.showTitle?this.domNode.firstChild.firstChild.firstChild:null;},titleNode:function R(){return this.showTitle?this.domNode.firstChild.firstChild.firstChild:null;},helpNode:function o(){return this.showTitle?this.domNode.firstChild.firstChild.children[1]:null;},closeNode:function E(){return this.showTitle?this.domNode.firstChild.firstChild.lastChild:null;},containerNode:function S(){return this.domNode.firstChild.childNodes[2];},buttonNode:function I(){return this.domNode.firstChild.childNodes[3];},curtainNode:function p(){return this.domNode.lastChild;}},markupMethods:{ontitleChange:function(){if(this.showTitle){this.titleNode.innerHTML=this.allowHTMLTitle?this.title:mstrmojo.string.encodeHtmlString(this.title);}},onzIndexChange:function(){var r=this.zIndex;this.editorNode.style.zIndex=r;this.curtainNode.style.zIndex=r-1;},onvisibleChange:function(w){if(w){return ;}var u=this.visible,t="closeEffect",r="none";if(u){t="openEffect";r="block";}if(this[t]){this.playEffect(t);}else{this.editorNode.style.display=r;if(this.modal){this.curtainNode.style.display=r;}}},onhelpChange:function f(){if(this.showTitle){var t=this.help,r=this.helpNode;if(!t){r.style.display="none";}else{r.style.display="block";}}},onleftChange:function F(){this.editorNode.style.left=this.left||"";},ontopChange:function H(){this.editorNode.style.top=this.top||"";}},open:function Q(t,r){this._super(t,r);W.call(this,true);},close:function h(r){this._super(r);W.call(this,false);},unrender:function B(r){this._super(r);W.call(this,false);},destroy:function j(r){this._super(r);W.call(this,false);},preBuildRendering:function A(){if(!this.slot&&!this.placeholder){this.placeholder=document.body.appendChild(document.createElement("div"));this._curtain_to_body=true;W.call(this,true);}this.titlebarHTML=(this.showTitle)?this.titleMarkupString:"<div></div><div></div>";return this._super();},getMovingHandle:function m(){return this.titlebarNode;},getMovingTarget:function V(){return this.editorNode;},onPreClose:function G(){this.hideTooltip();return true;},premousedown:function P(r){var t=r.getTarget();if(t===this.closeNode||t===this.helpNode){C.toggleClass(t,"active",true);}},premouseup:function O(r){var t=r.getTarget();if(t===this.closeNode||t===this.helpNode){C.toggleClass(t,"active",false);}if(r.getTarget()===this.closeNode&&this.onPreClose()){this.close();}},onclick:function e(r){if(r.getTarget()===this.helpNode){if(mstrApp.showHelpTopic){mstrApp.showHelpTopic(this.help);}else{window.open(mstrmojo.helpPath()+(this.help||""),"_blank");return false;}}},_set_visible:function d(z,u){var t=(this[z]!==u);if(t){this[z]=u;var x=this._close_handler;if(u){if(this._curtain_to_body){this.resizeDialog();this.positionDialog();}if(this.autoClose){var w=this;x=this._close_handler=x||function(AA){var AB=M.eventTarget(self,AA);if(AB&&AB.parentNode&&!M.contains(w.editorNode,AB,true,document.body)){w.close();}};M.attachEvent(document.body,"mousedown",x);}}else{var r=this._curtain_handler;if(r){M.detachEvent(window,"resize",r);}if(x){M.detachEvent(document.body,"mousedown",x);}}}return t;},showTooltip:function q(AA,z){var x=this,u=M.findAncestorByAttr(M.eventTarget(z,AA),"tooltip",true,this.domNode),w=u&&u.value;if(!x.hasOpenTooltip&&w){var r=M.position(u.node);x.richTooltip={cssClass:"vi-regular A-center vi-tooltip-A",content:w,top:Math.max(r.y+40,0),left:Math.max(r.x+4,0),posType:mstrmojo.tooltip.POS_TOPCENTER};this._super(AA,z);}}});mstrmojo.Editor.openEffect_fadeIn={scriptClass:"mstrmojo.fx.AnimateProp",slot:"curtainNode",props:{backgroundColor:{start:255,stop:0,fn:function(r){r=Math.round(r);return["rgb(",r,",",r,",",r,")"].join("");}}},preStart:function(){var t=this.target,r=this.widget;r.editorNode.style.display="block";if(!r.modal){return false;}t.style.display="block";C.setOpacity(t,60);return true;}};mstrmojo.Editor.closeEffect_fadeOut={scriptClass:"mstrmojo.fx.FadeOut",slot:"curtainNode",start:0.6,stop:0,preStart:function(){var r=this.widget;r.editorNode.style.display="none";return !!r.modal;}};function D(r){return function(){Z[r].destroy();};}function J(t,AC,AD,AE){var r=AC.id||"mojoAlertx9",z,AB=AC.buttons;X.forEach(AB,function(AG){var AF=AG.onclick;AG.onclick=function(AH){var AI=Z[r];if(AF&&AF.call(AG,AH)===false){return ;}AI.destroy();AI=null;};});try{!!Z[r]&&Z[r].destroy();}catch(AA){}var u=AC.cssClass,w=[];if(u){w.push(u);delete AC.cssClass;}if(AE){w.push(AE);}w.push("mstrmojo-alert");z={scriptClass:"mstrmojo.Editor",id:r,width:"475px",zIndex:1000,title:AD||mstrmojo.desc(11812,"Notification"),cssClass:w.join(" "),children:[{scriptClass:"mstrmojo.Box",cssClass:"alert-content",children:[{scriptClass:"mstrmojo.Label",text:t,allowHTML:AC.allowHTML}]}],visible:true};var x=new mstrmojo.Editor(N.copy(AC,z));x.render();return x;}if(window.mstrConfig&&!window.mstrConfig.simpleDialog){mstrmojo.notify=function L(t,AB,u){u=u||{};var AC=u.forceClose,AA=u.callback||mstrmojo.emptyFn,z=N.copy(AB||{},{buttons:AC?[mstrmojo.Button.newActionButton((u.buttonText||mstrmojo.desc(8607,"Dismiss")),AA)]:null,showTitle:false,modal:false,top:"42px"}),w=u.duration||6000;var x=J(t,z,"",AC?"ed-notify":"ed-toast"),r=x.id;if(!AC){window.setTimeout(k([AA,D(r)]),w);}else{window.setTimeout(function(){if(Z[r]){Z[r].editorNode.style.opacity=0.75;}},6000);}return x;};mstrmojo.confirm=function g(r,AA,AC){AA=AA||{};var u=AA.confirmBtn||{},z=AA.cancelBtn||{},AB=u.hot!==false,t=!!z.hot,x=AC&&AC.title,w=[a(u.t||mstrmojo.desc(219,"Yes"),u.fn,AB,u.cfg),a(z.t||mstrmojo.desc(218,"No"),z.fn,t,z.cfg)];return J(r,N.copy(AC||{},{buttons:w,onPreClose:function(){if(z&&z.fn){z.fn();}return true;}}),x,c.getEnvObj().isStandaloneDataSet()?["error-dialogue-in-dataset"]:[]);};mstrmojo.warn=function K(u,r,t){t=t||{};t.cssClass=(t.cssClass||"")+" mstrmojo-warning";return mstrmojo.confirm(u,r,t);};mstrmojo.alert=function b(z,u,x,AA,r,w){var t={title:x||mstrmojo.desc(12405,"Alert"),zIndex:AA,cssClass:r,buttons:[a(mstrmojo.desc(1442,"OK"),u,true)],onPreClose:function(){if(u){u();}return true;}};N.forEach(t,function(AC,AB){if(!AC){delete t[AB];}});return J(z,N.copy(w,t),x,c.getEnvObj().isStandaloneDataSet()?["error-dialogue-in-dataset"]:[]);};mstrmojo.error=function U(z,t,x){var u=z||{};var w=mstrmojo.desc(96,"Error");var r=!(c.getEnvObj().isInDI()||c.getEnvObj().isInQB());if(x){w=(x.title)?x.title:mstrmojo.desc(96,"Error");x.title=w;if(x.enableContactStr===false){r=false;}}J("",N.copy(x||{},{buttons:[a(mstrmojo.desc(1442,"OK"),t,true)],children:[{scriptClass:"mstrmojo.ui.editors.ErrorDialogContent",shortDesc:u.shortDesc,longDesc:u.longDesc,showToggle:!!(u.longDesc),enableContactStr:r,allowHTML:!!(x&&x.allowHTML===true)}]}),w,c.getEnvObj().isStandaloneDataSet()?["error-dialogue-in-dataset"]:[]);};}mstrmojo.Editor.ButtonConfigType=null;}());(function(){mstrmojo.requiresCls("mstrmojo.ui.menus.MenuPopup","mstrmojo.Button","mstrmojo.dom","mstrmojo.ui._HasScroller");mstrmojo.requiresDescs(1442,2140);var D=mstrmojo.dom,E=mstrmojo.array;function G(L,N){var K=2140,P="Cancel",O="this.parent.popupConfig."+(L?"ok":"cancel"),M=N&&N[(L?"ok":"cancel")+"BtnText"];if(L){K=1442;P="Ok";}return mstrmojo.Button.newWebButton(M||mstrmojo.desc(K,P),function(R){var S=this.parent,Q=S.popupConfig;S.closeAllMenus();Q["fn"+P](Q.data,S);D.stopPropogation(R.hWin,R.e);},L,{slot:"btnNode",bindings:{enabled:O+"Enabled",visible:O+"Visible"},cssDisplay:"inline-block"});}mstrmojo.ui.menus.MenuEditor=mstrmojo.declare(mstrmojo.ui.menus.MenuPopup,[mstrmojo.ui._HasScroller],{scriptClass:"mstrmojo.ui.menus.MenuEditor",markupString:'<div id="{@id}" class="mstrmojo-ui-MenuEditor {@cssClass}" style="{@cssText}" mstrAttach:mouseover,mouseout,click><div class="scroll-container" style="{@scCssText}"><div class="me-content"></div><div class="me-buttons"></div><div class="me-bottom"></div></div></div>',markupSlots:{containerNode:function C(){return this.domNode.firstChild.firstChild;},btnNode:function H(){return this.domNode.firstChild.children[1];},bottomNode:function H(){return this.domNode.firstChild.children[2];},scrollNode:function(){return this.domNode.firstChild;},scrollbarHostNode:function(){return this.domNode;}},popupConfig:null,postBuildRendering:function A(K){this._super(K);if(this.popupConfig&&this.popupConfig.supportsScroll){var L=this;window.setTimeout(function(){L.updateScrollbars();},10);}},onmouseover:function J(L){var K=this.popupConfig;if(K&&!K.isHostedWithin&&this.opener){this.opener.raiseEvent(mstrmojo._HasMarkup.newDomEvent(L.name,L.hWin,L.e,{targetHostElement:K.hostElement}));}},updateScrollbars:function(){this._super();if(this.popupConfig&&this.popupConfig.supportsScroll){var L=this.scrollNode;if(!L){return ;}var K=D.getComputedScrollbarWidth(L);L.style.marginRight=-K+"px";L.style.paddingRight=0;}},monitorWindow:function F(){var L=document.activeElement,K=null;if(L!==null&&L.id!==""){K=this.domNode.querySelector("#"+L.id)?L:null;}this._super();if(K){K.focus();}},init:function I(M){this._super(M);var L=this.popupConfig,K=L.bottomNode;if(L&&L.supportsScroll&&L.maxHeight>0){if(L.cssClass.indexOf("RoleMenu")>-1){L.maxHeight=360;}this.cssText=(this.cssText||"")+";max-height:"+L.maxHeight+"px";this.scCssText=(this.scCssText||"")+";max-height:"+L.maxHeight+"px";}if(!!mstrApp.isWSStyling){this.themeClassName="mojo-theme-light";}this.data=L.data||{};if(L.onOpen){this.onOpen=L.onOpen;}this.addChildren([G(true,L),G(false)]);if(K){K.slot="bottomNode";this.addChildren(K);}},onOpen:function B(){E.forEach(this.children,function(K){if(K.scriptClass==="mstrmojo.ui.ScrollableContainer"&&K.onOpen){K.onOpen();}});}});}());(function(){mstrmojo.requiresCls("mstrmojo.ui.PopupConfig","mstrmojo.ui.menus.MenuPopup");mstrmojo.ui.menus.PopupConfig=mstrmojo.declare(mstrmojo.ui.PopupConfig,null,{scriptClass:"mstrmojo.ui.menus.PopupConfig",cssClass:"",hasToggleItem:false,contents:null,clear:function A(){this._super();this.contents=null;},close:function C(){([].concat(this.contents)[0]).parent.closeAllMenus();},newInstance:function B(){return new mstrmojo.ui.menus.MenuPopup({popupConfig:this});}});}());(function(){mstrmojo.requiresCls("mstrmojo.ListBase","mstrmojo._IsList","mstrmojo._CanAutoClose","mstrmojo._IsPopup","mstrmojo.ui.menus._HasMenuPopup","mstrmojo.ui.menus._IsMenuPopup","mstrmojo.ui.PopupConfig","mstrmojo.ui._HasScroller","mstrmojo.ui._HasUITheme","mstrmojo.dom","mstrmojo.css","mstrmojo.ui._HasListTooltip");var E=mstrmojo.dom,H=mstrmojo.css,F=mstrmojo.ui.PopupConfig.directionCfg;var C={};var B=false;function O(W,X){if(W.pop){if(X&&W.ax){window.clearTimeout(this._popupAxTimeout);W.actionFn();this.closeAllMenus();}else{var U=W.fn.call(mstrmojo.all[W.scope],W.ctxt);var V=U.ENUM_CORNERS,S=U.maxHeight,R=E.getMaxScrollHeight();U.setAlignment(V.TOP_RIGHT,V.TOP_LEFT);U.hostId=this.id;U.hostElement=this._getItemNode(W._renderIdx);U.includeScroll=this.includeScroll;U.supportsScroll=true;U.alignWithAnchor=true;U.isHostedWithin=false;U.maxHeight=S?Math.min(R,S):R;this.openPopup(U.newInstance());}}else{if(W.dsbld!==true){if(W.fn(W,this)!==false){this.closeAllMenus();}}}}mstrmojo.ui.menus.Menu=mstrmojo.declare(mstrmojo.ListBase,[mstrmojo._IsList,mstrmojo.ui.menus._HasMenuPopup,mstrmojo._IsPopup,mstrmojo.ui.menus._IsMenuPopup,mstrmojo._CanAutoClose,mstrmojo.ui._HasListTooltip,mstrmojo.ui._HasScroller,mstrmojo.ui._HasUITheme],{scriptClass:"mstrmojo.ui.menus.Menu",selectionPolicy:"reselect",locksHover:true,closeOnClick:true,themeClassName:"mojo-theme-dark",icnCss:"mstrmojo-ui-Menu-item-container",popupConfig:null,tooltipCss:{leftCssClass:"menuTooltip",rightCssClass:"menuTooltip"},setupScrollNodes:function(){if(this.popupConfig&&this.popupConfig.supportsScroll){this.scrollNode=this.itemsContainerNode;this.scrollbarHostNode=this.domNode;}},updateScrollbars:function(){this._super();if(this.popupConfig&&this.popupConfig.supportsScroll&&this.hasCustomScrollbar){var S=this.scrollNode;if(!S){return ;}var R=E.getComputedScrollbarWidth(S);S.style.marginRight=-R+"px";S.style.paddingRight=0;}},onscroll:function(){this.closePopup();this._super();},init:function P(U){this._super(U);if(!!mstrApp.isWSStyling){this.themeClassName="mojo-theme-light";}if(U.themeClassName){this.themeClassName=U.themeClassName;}var R=this.popupConfig;this.items=R.getMenuItems();var S=["mstrmojo-ui-Menu","unselectable"],V=R.menuCssClass;if(V){S.push(V);}if(R.hasToggleItem){S.push("hasToggleItem");}H.addWidgetCssClass(this,S);if(R&&R.supportsScroll&&R.maxHeight>0){this.icnCssText=(this.icnCssText||"")+";max-height:"+R.maxHeight+"px";}this.useRichTooltip=!!R.useTooltip;this.tstid=R.tstid;},markupMethods:{onvisibleChange:function M(){var R=this.visible;if(!B||R){H.toggleClass(this.domNode,"visible",R);}}},getItemMarkup:function L(X,S){if(X.getItemMarkup){return X.getItemMarkup.apply(this,[X,S]);}var V=!!X.pop,W=V?"submenu":"item",U=C[W],R='<div class="micn"></div>';if(!U){R+=!!mstrApp.isWSStyling?'<div class="mtxt">{@en@n}</div>':"{@en@n}";if(V){R+='<div class="arw"></div>';}U=this._super(X,S).replace("{@en@n}",R);C[W]=U;}if(X.tstid){U=U.replace("{@tag}","{@tag} "+mstrmojo.tstid(X)+" ");}return U;},getItemProps:function J(U,R){var S=this._super(U,R);S.tag="a";S.addCls("mstrmojo-ui-Menu-item");S.addCls(U.cls);return S;},onmouseover:function Q(Y){var W=Y.config&&Y.config.targetHostElement?Y.config.targetHostElement:Y.getTarget(),a=this.getItemFromTarget(W),X=this,S=X._lastOpened,R=S&&this.getItemFromTarget(S.popupConfig.hostElement)._renderIdx,U=this.getItemNodeFromTarget(W),V=(R!==undefined&&E.contains(this._getItemNode(R),W,true,this.domNode));if(a){this._lastHoverIx=a._renderIdx;window.clearTimeout(this._popupTimeOut);window.clearTimeout(this._popupAxTimeout);if(this._lastHoverIx!==R&&!V){this._popupTimeOut=window.setTimeout(function(){if(X._lastOpened&&X._lastOpened.visible){X.closePopup();}if(X.visible&&a.pop){if(a.ax){X._popupAxTimeout=window.setTimeout(function(){H.removeClass(U,"hlt-ax");O.call(X,a);},0);}else{O.call(X,a);}}},400);if(a.pop&&a.ax){H.addClass(U,"hlt-ax");}}}var Z=this.popupConfig;if(Z&&!Z.isHostedWithin&&this.opener){this.opener.raiseEvent(mstrmojo._HasMarkup.newDomEvent(Y.name,Y.hWin,Y.e,{targetHostElement:Z.hostElement}));}},onclick:function N(R){this._evtTarget=R.getTarget();this._super(R);R.cancel();},postselectionChange:function D(R){var S=R.added;if(S){var U=this.items[S[0]];O.call(this,U,!(U.ax&&this._evtTarget.className==="arw"));delete this._evtTarget;}},oncontextmenu:function G(R){E.preventDefault(window,R.e);return false;},postBuildRendering:function A(R){this._super(R);if(this.popupConfig.supportsScroll){var S=this;window.setTimeout(function(){S.updateScrollbars();},10);}},showTooltip:function K(W,V){var U=E.eventTarget(V,W),S=this.getItemNodeFromTarget(U),R=this.getItemFromTarget(U);this.itemDisabled=R&&R.dsbld;if(S&&((R&&R.ttp)||(S.scrollWidth>S.clientWidth)||(U.scrollWidth>U.clientWidth))){this._super(W,V);}},onCloseMenuCallBack:null,onClose:function I(R){if(this._super){this._super(R);}this.closePopup();if(this.onCloseMenuCallBack){this.onCloseMenuCallBack();}}});}());(function(){mstrmojo.requiresCls("mstrmojo.TextBox","mstrmojo._CanValidate","mstrmojo.css","mstrmojo.validation","mstrmojo.vi.ui.rw.selectors._HasWarningMessage");var H=mstrmojo.css,E=mstrmojo.validation,G=E.TRIGGER,J=E.STATUSCODE;function F(L){if((this.constraints.trigger&L)>0){this.validate();}}mstrmojo.ValidationTextBox=mstrmojo.declare(mstrmojo.TextBox,[mstrmojo._CanValidate,mstrmojo.vi.ui.rw.selectors._HasWarningMessage],{scriptClass:"mstrmojo.ValidationTextBox",validationDelay:500,getInvalidMsg:function K(L){return(L&&L.msg?L.msg:"");},postBuildRendering:function A(){this._super();this._original_tooltip=this.inputNode.title;},prekeyup:function I(L){this._super(L);var P=(this.constraints.trigger&G.ONKEYUP)>0;if(P){var M=this.validationDelay;if(M){this.clearValDelayTimer();var O=this._validateHandler;if(!O){var N=this;this._validateHandler=O=function(){N.validate();if(N._valDelayTimer){window.clearTimeout(N._valDelayTimer);delete N._valDelayTimer;}};}this._valDelayTimer=window.setTimeout(O,M);}else{this.validate();}}},preinput:function D(L){this._super(L);F.call(this,G.ONKEYUP);},preblur:function B(L){this._super(L);F.call(this,G.ONBLUR);},clearValidation:function C(){this._super();var L=this.inputNode;H.removeClass(L,this.constraints.invalidCssClass||"mstrmojo-TextBox-ErrValidation");L.title=this._original_tooltip;},clearValDelayTimer:function(){var L=this._valDelayTimer;if(L){window.clearTimeout(L);}}});mstrmojo._HasMarkup.addMarkupMethods(mstrmojo.ValidationTextBox,{onvalidationStatusChange:function(){var P=this.validationStatus;if(!P){return ;}var N=this.inputNode,L=(P.code>J.VALID),M=this.constraints.invalidCssClass;H.toggleClass(N,M||"mstrmojo-TextBox-ErrValidation",L);var O=L?this.getInvalidMsg(P):this._original_tooltip;if(!this.useRichTooltip&&O!==undefined&&O!==null){N.setAttribute("title",O);}}});}());(function(){mstrmojo.requiresCls("mstrmojo.css","mstrmojo._HasPopup","mstrmojo.string","mstrmojo.Pulldown","mstrmojo.Container");var C=mstrmojo.css;mstrmojo.CustomGroupEl=mstrmojo.declare(mstrmojo.Container,[mstrmojo._HasPopup],{scriptClass:"mstrmojo.CustomGroupEl",markupString:'<div id="{@id}" class="mstrmojo-onhoverparent mstrmojo-CustomGroupEl {@cssClass}" style="{@cssText}" mstrAttach:mouseover><div class="mstrmojo-CustomGroupEl-title {@cssClass}" mstrAttach:click><img class="mstrmojo-CustomGroupEl-state {@cssClass}" src="../images/1ptrans.gif" align="absmiddle" onclick="var w = mstrmojo.all[\'{@id}\']; w.set(\'state\', !w.state)" /><span class="mstrmojo-text"></span></div><div class="mstrmojo-onhover mstrmojo-abs mstrmojo-topright mstrmojo-CustomGroupEl-tools {@cssClass}"><img class="mstrmojo-dup" src="../images/1ptrans.gif" title="'+mstrmojo.desc(3397,"Duplicate")+'" onclick="mstrmojo.all[\'{@id}\'].dup()" /><img class="mstrmojo-ops" src="../images/1ptrans.gif"onclick="var w = mstrmojo.all[\'{@id}\'].showOps();" title="'+mstrmojo.desc(7932,"Element display options")+'" /><img class="mstrmojo-del" src="../images/1ptrans.gif" onclick="mstrmojo.all[\'{@id}\'].del()" title="'+mstrmojo.desc(7933,"Delete element")+'"/></div><div class="mstrmojo-CustomGroupEl-details {@cssClass}"><div class="mstrmojo-CustomGroupEl-expr {@cssClass}"></div><div class="mstrmojo-CustomGroupEl-expr-tools {@cssClass}"></div></div></div>',markupSlots:{stateNode:function(){return this.domNode.firstChild.firstChild;},titleNode:function(){return this.domNode.firstChild.lastChild;},detailsNode:function(){return this.domNode.lastChild;},exprNode:function(){return this.domNode.lastChild.firstChild;},exprToolsNode:function(){return this.domNode.lastChild.lastChild;},titlebarNode:function(){return this.domNode.firstChild;}},markupMethods:{ondataChange:function(){var G=this.data,F=G&&G.n;this.titleNode.innerHTML=(F!=null)?mstrmojo.string.encodeHtmlString(F):"";},onstateChange:function(){var F=this.stateNode;F.className="mstrmojo-CustomGroupEl-state "+(this.state?"opened":"closed");this.detailsNode.style.display=this.state?"block":"none";},onselectedChange:function(){C.toggleClass(this.domNode,["selected"],this.selected);},onshowaddChange:function(){this.exprToolsNode.style.display=this.showadd?"block":"none";}},_set_data:function A(H,F){var G=this.data;this.data=F;this.set("expr",F&&F.expr);return G!==F;},optionsRef:{scriptClass:"mstrmojo.Editor",title:mstrmojo.desc(7934,"Element Options"),contentNodeCssClass:"mstrmojo-balloon",cssClass:"mstrmojo-CGEOptionsEditor",help:"element_options_dialog_box.htm",ce:false,isp:false,onOpen:function(){var F=this.opener.data,G=this.ops.dsplb.dspl;G.set("value",F.ce?2:(F.isp?1:0));},save:function(){var F=this.ops.dsplb.dspl.value,G=this.opener.data;G.ce=(F==2);G.isp=(F==1);this.close();},children:[{scriptClass:"mstrmojo.VBox",cssClass:"mstrmojo-ElementOptions",alias:"ops",children:[{scriptClass:"mstrmojo.HBox",alias:"dsplb",children:[{scriptClass:"mstrmojo.Label",text:mstrmojo.desc(168,"Display:"),cssText:"margin: 0 5px;"},{alias:"dspl",scriptClass:"mstrmojo.Pulldown",itemIdField:"v",items:[{n:mstrmojo.desc(7935,"Display element name only (Default)"),v:0},{n:mstrmojo.desc(7936,"Display individual items only"),v:1},{n:mstrmojo.desc(7937,"Display element name and individual items"),v:2}]}]},{scriptClass:"mstrmojo.HBox",alias:"btns",cssText:"float:right;width:150px;margin:5px;",children:[{scriptClass:"mstrmojo.HTMLButton",alias:"ok",text:mstrmojo.desc(118,"Save"),cssClass:"mstrmojo-Editor-button",cssText:"width:72px;",onclick:function(){this.parent.parent.parent.save();}},{scriptClass:"mstrmojo.HTMLButton",alias:"cancel",text:mstrmojo.desc(221,"Cancel"),cssClass:"mstrmojo-Editor-button",cssText:"width:72px;margin: 5px;",onclick:function(){this.parent.parent.parent.close();}}]}]}]},showOps:function(){var G=this.titlebarNode,F=mstrmojo.dom.position(G,true);this.openPopup("optionsRef",{zIndex:30,left:Math.round(F.x+F.w-300)+"px",top:Math.round(F.y+F.h)+"px"});},init:function E(F){this._super(F);var G=this.data;if(G){delete this.data;this._set_data(null,G);}},del:function B(){var F=this.parent;if(F&&F.remove){F.remove(this.data);}},dup:function D(){var F=this.parent;if(F&&F.duplicate){var K=this.data,L=F.items,N=K.did,M=1,O=new RegExp(K.n+"_(\\d+)");for(var I=0,J=L.length;I<J;I++){var H=L[I],G=H.n&&H.n.match(O);if(G){M=Math.max(M,G[1]);}N=Math.max(N,parseInt(H.did,10));}F.duplicate(this.data,null,{n:mstrmojo.desc(3651,"Copy of ##").replace("##",K.n),did:F.getNextId(),state:1});}},onmouseover:function(F){this.set("showadd",this.state?true:false);}});})();(function(){mstrmojo.requiresCls("mstrmojo.Pulldown");var C={ENTER:13,LEFT:37,UP:38,TAB:9,RIGHT:39,DOWN:40,ESC:27};function D(L,M){var G,J,F,H=[],I,N;try{I=new RegExp(L,"i");}catch(K){I=new RegExp(mstrmojo.string.regEscape(L));}for(G=0,J=M.length;G<J;G++){if(I.test(M[G][this.itemField])){H.push(M[G]);}}return H;}function B(F){return !(F<0||F===undefined||F===null);}mstrmojo.SearchablePulldown=mstrmojo.declare(mstrmojo.Pulldown,null,{scriptClass:"mstrmojo.SearchablePulldown",popupCssClass:"mstrmojo-SearchablePulldown-Popup",searchEnabled:false,allowCustomInput:false,useItemCssOnInput:false,lastSearchPattern:"",isEditing:false,allItems:null,markupString:'<div id="{@id}" class="mstrmojo-SearchablePulldown mstrmojo-DropDownButton {@cssClass} {@direction}" style="{@cssText}"><div class="mstrmojo-SearchablePulldown-boxNode mstrmojo-DropDownButton-boxNode {@cssClass}-boxNode" title="{@title}" mstrAttach:mousedown><input class="mstrmojo-SearchablePulldown-inputNode" value="{@text}" mstrAttach:keyup,blur/><div class="mstrmojo-SearchablePulldown-iconNode mstrmojo-DropDownButton-iconNode {@cssClass}-iconNode" mstrAttach:mouseover,mouseout></div></div><div class="mstrmojo-DropDownButton-popupNode {@cssClass}-popupNode"></div></div>',markupSlots:{boxNode:function(){return this.domNode.firstChild;},inputNode:function(){return this.domNode.firstChild.firstChild;},iconNode:function(){return this.domNode.firstChild.children[1];},popupNode:function(){return this.domNode.lastChild;}},markupMethods:mstrmojo.hash.copy({ontextChange:function(){if(this.inputNode.value!==this.text){this.inputNode.value=this.text;}},onheightChange:function(){this.domNode.style.height=this.height||"";this.boxNode.style.height=this.height||"";},onsearchEnabledChange:function(){this.inputNode.readOnly=this.searchEnabled?false:true;this.items=this.allItems||this.items;},onallowCustomInputChange:function(){if(this.allowCustomInput){this.set("searchEnabled",true);}},onvalueChange:function E(){if(this.useItemCssOnInput&&this.selectedItem){this.inputNode.className="mstrmojo-SearchablePulldown-inputNode "+(this.selectedItem[this.itemCSS]||"");}}},mstrmojo.hash.copy(mstrmojo.Pulldown.prototype.markupMethods)),prevalueChange:function(){this.synchronize();},synchronize:function(){var G=this.value,H=this.items||[],I=H[this.selectedIndex],F=-1;if(I&&G===I[this.itemIdField]){this.selectedItem=I;this.set("text",I[this.itemField]);return ;}F=mstrmojo.array.find(this.items,this.itemIdField,G);if(!B(F)&&this.allowCustomInput){this.selectedItem=undefined;this.selectedIndex=undefined;return ;}this.selectedIndex=B(F)?F:this.defaultSelection;this.selectedItem=I=this.items[this.selectedIndex];this.value=I?I[this.itemIdField]:undefined;this.set("text",I?I[this.itemField]:(this.defaultText||""));},preBuildRendering:function A(){if(this._super){this._super();}this.allItems=this.allItems||this.items;this.synchronize();},premousedown:function(F){if(this.searchEnabled&&F.getTarget()===this.iconNode){this.set("items",this.allItems);}this._super(F);},onkeyup:function(M){var J=mstrmojo.string.trim(this.inputNode.value),I=M.e,N=I.keyCode||I.which,L=B(this.selectedIndex)?this.selectedIndex:-1,F=this.allowCustomInput,H=this.items.length;this.isEditing=true;switch(N){case C.ENTER:if(H>0&&!F){this.set("selectedIndex",L===-1?0:L);this.synchronize();}this.closePopup();break;case C.ESC:this.closePopup();this.synchronize();break;case C.UP:if(this.popupRef.visible&&H>0){this.set("selectedIndex",(L+H-1)%H);this.synchronize();}break;case C.DOWN:if(!this.popupRef.visible&&H>0){this.togglePopup();}this.set("selectedIndex",(L+1)%H);this.synchronize();break;default:if(J===this.lastSearchPattern){return ;}var K=[];if(J&&J.length>0&&J.indexOf(this.lastSearchPattern)>-1){K=D.apply(this,[J,this.items]);}else{K=D.apply(this,[J,this.allItems]);}this.set("items",K);if(K.length===0){this.closePopup();}else{if(!this.popupRef.visible){this.togglePopup();}}this.set("selectedIndex",undefined);if(J&&J.length){var G=mstrmojo.array.find(K,this.itemField,J);if(G!==-1){this.set("selectedIndex",G);}}}if(F&&!B(this.selectedIndex)){this.set("value",this.inputNode.value);}this.lastSearchPattern=J;},onblur:function(F){this.isEditing=false;if(!this.searchEnabled){return ;}if(!this.allowCustomInput){this.items=this.allItems;this.synchronize();}}});}());(function(){var F=mstrmojo.string;function H(Q,R,K){var L,O,J,M=[],N,S;try{N=new RegExp(mstrmojo.string.regEscape(Q),"i");}catch(P){return M;}for(L=0,O=R.length;L<O;L++){J=R[L][K];N.lastIndex=0;if(N.test(J)){M.push(R[L]);}}return M;}function C(){if(this.searchEnabled){this.iconNode.style.display="none";this.inputBar.style.display="";if(this.autofocus){this.inputNode.focus();this.inputNode.select();}}else{this.hideInputNode();if(this.autofocus){if(mstrmojo.dom.isIE7||mstrmojo.dom.isIE8){var J=this;window.setTimeout(function(){try{J.iconNode.focus();}catch(K){}},100);}else{this.iconNode.focus();}}}}var G={8:"BackSpace",9:"Tab",13:"Enter",27:"Esc",38:"ArrowUp",40:"ArrowDown"};mstrmojo.SearchableDropDownList=mstrmojo.declare(mstrmojo.Pulldown,null,{scriptClass:"mstrmojo.SearchableDropDownList",markupString:'<div id="{@id}" class="mstrmojo-SearchableDropDownList mstrmojo-DropDownButton {@cssClass} {@direction}" style="{@cssText}"><div class="mstrmojo-DropDownButton-boxNode {@cssClass}-boxNode" title="{@title}"><div class="mstrmojo-DropDownButton-iconNode {@cssClass}-iconNode" tabindex="0" mstrAttach:mousedown,keyup>{@text}</div><table class="mstrmojo-InputNodeBar"><colgroup><col class="inputCol"/><col class="iconCol"/></colgroup><tr><td><input class="mstrmojo-SearchableDropDownList-inputNode" value="{@text}" placeholder="{@placeholderText}" mstrAttach:keyup,blur,click/></td><td><div class="mstrmojo-DropDownButton-iconNode {@cssClass}-iconNode" mstrAttach:mousedown></div></td></tr></table></div><div class="mstrmojo-DropDownButton-popupNode {@cssClass}-popupNode"></div></div>',markupSlots:mstrmojo.hash.copy(mstrmojo.Pulldown.prototype.markupSlots,{inputBar:function(){return this.domNode.firstChild.lastChild;},inputNode:function(){return this.domNode.firstChild.lastChild.rows[0].cells[0].firstChild;}}),markupMethods:mstrmojo.hash.copy({ontextChange:function(){this.iconNode.innerHTML=F.decodeHtmlString(this.text);this.inputNode.value=this.text;},onheightChange:function(){var J=parseInt(this.height,10);if(J>=0){this.domNode.offsetHeight=J+"px";this.inputBar.offsetHeight=J+"px";}}},mstrmojo.hash.copy(mstrmojo.Pulldown.prototype.markupMethods)),popupToBody:true,searchEnabled:false,selectedIndex:-1,placeholderText:"",allItems:null,autofocus:true,focus:function(){C.call(this);},hideInputNode:function B(){this.inputBar.style.display="none";this.iconNode.style.display="block";},postBuildRendering:function A(){if(!this.allItems){this.allItems=this.items;}this._super();C.call(this);},clickInput2pop:false,onclick:function I(J){if(this.clickInput2pop){this.togglePopup();}},prekeyup:function E(R){var K=this.getSearchPattern(),P=[],M,Q=this.inputNode,O=R.e,J,L,N=this.items.length;if(G[O.keyCode]==="Enter"){if(this.items.length>0){this.set("selectedIndex",this.selectedIndex===-1?0:this.selectedIndex);}this.onEnter&&this.onEnter();this.closePopup();return ;}else{if(G[O.keyCode]==="Esc"){this.onEsc&&this.onEsc();if(this.popupRef.visible){this.popupRef.close();}return ;}else{if(G[O.keyCode]==="ArrowDown"){if(!this.popupRef.visible){this.togglePopup();}this.set("selectedIndex",(this.selectedIndex+1)%N);}else{if(G[O.keyCode]==="ArrowUp"){if(this.popupRef.visible&&N>0){this.set("selectedIndex",(this.selectedIndex+N-1)%N);}}else{if(this.searchEnabled){if(K&&K.length>0&&K.indexOf(this.lastSearchPattern)>-1){P=H(K,this.items,this.itemField);}else{P=H(K,this.allItems,this.itemField);}this.set("selectedIndex",-1);this.set("items",P);N=P.length;if(N===0){this.closePopup();}else{if(!this.popupRef.visible){this.togglePopup();}}if(K&&K.length>0){this.set("selectedIndex",mstrmojo.array.find(P,this.itemField,Q.value));}}}}}}this.lastSearchPattern=K;},getSearchPattern:function D(){return F.trim(this.inputNode.value);}});}());(function(){mstrmojo.requiresCls("mstrmojo.hash","mstrmojo.array","mstrmojo.warehouse.EnumDatabaseType","mstrmojo.warehouse.EnumDataChangeEvents","mstrmojo.DI.DIConstants");mstrmojo.requiresDescs(12370);var M=mstrmojo.hash,S=mstrmojo.array,H=mstrmojo.string,I=mstrmojo.warehouse.EnumDatabaseType,J=mstrmojo.warehouse.EnumDataChangeEvents.DBTABLES_CHANGED,R=mstrmojo.warehouse.EnumDataChangeEvents.DBTABLES_REQUESTED,U=mstrmojo.architect.menu.EnumMenuActions,F=7425,B=7426,W=mstrmojo.DI.DIConstants;mstrmojo.qb.mdx.Model=mstrmojo.declare(mstrmojo.warehouse.WHModel,null,{scriptClass:"mstrmojo.qb.mdx.Model",cubes:[],dbRoleEditorCfg:{hideShareConnection:true,hideDSNOption:true,hideDriverCheck:true,dbIdFilter:[36,37,38,39],help:"Creating_a_data_source_connection_to_an_OLAP_source.htm"},dbObjectsDisplayOptions:2,dbRolesTypeFilter:[I.SAP,I.MSAS,I.EssBase,I.TM1],recursive:0,addCubes:function K(a){var Y=[],Z=this;if(!this.canAddCube(false)){return ;}mstrmojo.array.forEach(a,function(c){Y.push({n:c.n&&c.n.toString(),caption:c.cube_caption&&c.cube_caption.toString(),tp:c.cubetp.toString(),des:c.des&&c.des.toString(),ctn:c.ctn,tn:c.tn&&c.tn.toString(),isNew:true,dbrid:Z.SelDBRoleID});});Z.cubes=Z.cubes.concat(Y);mstrApp.getRootController().getDataService().pollingStatus({success:function b(){Z.raiseEvent({name:"refreshTables",items:Z.cubes.slice(0)});}},null,mstrmojo.desc(12370,"Please wait..."));},canAddCube:function O(Y){if(this.cubes.length>0){if(!Y){this.raiseEvent({name:"maxCubeError"});}return false;}return true;},commitChanges:function C(c){var Z=this,Y=function(d){var e=Z.recursive.toString();S.forEach(Z.cubes,function(f){f.rec=e;});mstrApp.getRootController().getDataService().addCubes(d,{cubes:JSON.stringify(Z.cubes),tbid:Z.tableID,dbrid:Z.cubes[0].dbrid,showWait:true});},a=function(d){if(Z.isManagedCube){if(d&&d.success){d.success();}}else{var e={success:function(f){if(f&&f.items&&f.items.length===1){Z.folderID=f.items[0].fid;}Z.submitRequest(d,{taskId:"saveAndPublishCube",displayMode:12,shouldRefresh:false,saveAsFlags:W.saveAsFlags.saveAsDDA|W.saveAsFlags.saveAsOverWrite,folderID:Z.folderID||"",objName:Z.cubeName||"",objDesc:Z.cubeDesc||"",showWait:true});}};if(!Z.folderID&&Z.cubeID){mstrApp.getRootController().getDataService().getObjectFolder(e,{dids:Z.cubeID,types:3});}else{e.success();}}};if(this.original){if(Z.cubes[0].isNew){Y({success:function b(){a(c);}});}else{a(c);}}else{Y({success:function b(){a(c);}});}},removeCube:function N(Y){mstrmojo.array.removeIndices(this.cubes,Y,1);this.raiseEvent({name:"refreshTables",items:this.cubes.slice(0)});},updateCube:function X(){var Y=this;mstrApp.getRootController().getDataService().updateCubes({success:function Z(){Y.raiseEvent({name:"refreshTables",items:Y.cubes.slice(0)});}},{tbid:Y.tableID,showWait:true});},initialize:function A(){var Z=this,Y=Z.isNew=!mstrApp.tableID,a=2,b=327681,d=mstrApp.getRootController().getDataService(),e=function e(){d.createEmmaTable({success:function f(g){Z.tableID=g.tbid;mstrApp.msgid=g.msgid;}},{xt:a,dict:b});};Z.tableID=mstrApp.tableID;Z.folderID=mstrApp.folderID;Z.cubeName=mstrApp.cubeName;Z.cubeDesc=mstrApp.cubeDesc;Z.cubeID=mstrApp.reportID;mstrApp.msgid=mstrApp.msgID;Z.cubes=[];Z.dbtbls={};Z.original=undefined;Z.SelDBRoleID=undefined;Z.recursive=0;if(Y){if(mstrApp.msgid){e();}else{d.createEmmaInstance({success:function c(f){mstrApp.msgid=f.msgid;e();}});}}else{Z.loadTable(Z.tableID);}},loadTable:function G(Y){var Z=this;Z.tableID=Y;Z.submitRequest({success:function a(d){var e=d.datap.srce,b=e.dbrid,f=e.tbal&&e.tbal.toString(),c=e.recurisve||0;Z.original=e;Z.cubes.push({n:f,tp:e.dbtp&&e.dbtp.toString(),des:e.des&&e.des.toString(),ctn:e.ctn,tn:f});Z.raiseEvent({name:"refreshTables",items:Z.cubes.slice(0)});Z.set("SelDBRoleID",b);Z.set("recursive",c);}},{taskId:"qBuilder.GetReportXDADefinition",showWait:true,tableID:Y,browsetype:4,previewflag:8});},_set_SelDBRoleID:function P(d,a){var Y=this,c=(Y.SelDBRoleID!==a),Z=mstrmojo.warehouse.EnumDataChangeEvents;if(this._super){this._super(d,a);}Y.SelDBRoleID=a;if(c&&a){mstrApp.getRootController().getDataService().setDBRole({success:function b(e){mstrApp.msgid=e.msgid;}},{dbrid:a,tbid:Y.tableID});}S.forEach(Y.dbrs,function(e){if(e.data.isPrimary){e.data.isPrimary=false;Y.raiseEvent({name:Z.DBROLE_CHANGED,item:e});}if(e.did===a){e.data.isPrimary=true;Y.raiseEvent({name:Z.DBROLE_CHANGED,item:e});var f=mstrApp.diFooterID,g=f?mstrmojo.all[f]:undefined;if(g){g.mdxRA.update(!Y.hasNonRADataset&&(e.mdDBRole.db_type===I.EssBase||e.mdDBRole.db_type===I.MSAS));}}});return c;},getNameSpaces:function D(){var Y=this.SelDBRoleID;this.raiseEvent({name:mstrmojo.warehouse.EnumDataChangeEvents.NAMESPACES_CHANGED,namespaces:undefined,namespaceMode:mstrmojo.warehouse.EnumNamespaceMode.ALL,dbRoleID:Y,namespace:undefined});},getSelectedDBRoleTables:function E(p){var Z=this,r=Z.SelDBRoleID,Y=Z.dbtbls,n=p.blockCount,j=p.filterText,q=Z.getDBRole(r),b=false,e,d=[],h=[],m=[],t,o,k,a,l=Y[r],c,g={};if(!q){return ;}if(!Z.catalogRefresh&&l!==undefined){j=j&&j.toUpperCase();M.forEach(l,function(u,w){b=true;c=H.decodeHtmlString(u.n&&u.n.toString());a=[];k=u.cuis;k=[].concat((k&&k.cui)||[]);e=false;t=[];if(j!==""){S.forEach(k,function(x){var z=(x.cube_caption||x.n).toString();if(z.toUpperCase().indexOf(j)>-1){t.push(x);e=true;}});}else{t=k;e=true;}if(e){o=new mstrmojo.warehouse.obj.TableData({id:w,n:c,tn:w,tp:15,model:Z,ns:""});o.items=t.slice(0);h.push(o);}});if(b){if(j!==""){S.forEach(h,function(w,u){g[u]=true;});}Z.raiseEvent({name:J,items:h,expandedIndices:g,selectedItems:Z.getDBRoleTablesInUse(r)||[]});return ;}}l=Y[r]={};Z.raiseEvent({name:R,sourceInfo:p.sourceInfo||""});this.submitRequest({success:function(w){var x=w.mi.cas,z,u;Z.catalogRefresh=false;x=[].concat((x&&x.ca)||[]);S.forEach(x,function(AB,AA){z=H.decodeHtmlString(AB.n&&AB.n.toString());u=H.decodeHtmlString(AB.tn&&AB.tn.toString())||z;if(!l[u]){l[u]=AB;a=[];k=AB.cuis;k=[].concat((k&&k.cui)||[]);S.forEach(k,function AC(AD){AD.cubetp=AD.tp;AD.tp=26;AD.ctn=z;AD.tn=u;AD.n=AD.n&&AD.n.toString();AD.des=AD.des&&AD.des.toString();a.push(AD);});o=new mstrmojo.warehouse.obj.TableData({id:u,n:z,tp:15,model:Z,ns:"",did:z,items:a});l[u].cubes=a;m.push(o);if(AA<n){d.push(o);}}});Z.raiseEvent({name:J,items:m,selectedItems:Z.getDBRoleTablesInUse(r)||[]});},failure:function f(){Z.raiseEvent({name:J,items:m,selectedItems:Z.getDBRoleTablesInUse(r)||[]});}},{taskId:"qBuilder.FetchSourceObjects",dbRoleID:r,mdx:1,showWait:false});},getColumnsForDBTable:function V(f,a){var Z=this,e=f.data.dbrole||Z.SelDBRoleID,c=f.data,b=c.n,d=c.did,Y=Z.dbtbls[e][d].cubes;a.success({src:f,items:Y,selDBRole:e});Z.raiseEvent({name:"dbTablesPopulated",items:{id:b,n:b,items:Y}});if(a&&a.complete){a.complete();}},handleVisibleAction:function Q(Z,Y){var a;if(!Y){return true;}if(Y.action===U.EDIT){a=Z.tp===F||Z.tp===B;}else{a=this._super(Z,Y);}return a;},submitRequest:function L(a,Z,Y){mstrApp.getRootController().getDataService()[Y||"submitRequest"](a,Z);}});}());(function(){mstrmojo.requiresCls("mstrmojo.func","mstrmojo.hash","mstrmojo.array","mstrmojo.qb.EnumQBAppType","mstrmojo.warehouse.EnumDatabaseType","mstrmojo.warehouse.EnumDataChangeEvents","mstrmojo.DI.DIConstants","mstrmojo.DI.DIHelpers");mstrmojo.requiresDescs(14098,12406,13534,13535,12383,14666);var D=mstrmojo.DI.DIConstants,S=mstrmojo.warehouse.EnumDatabaseType,X=mstrmojo.warehouse.EnumDataChangeEvents,F=mstrmojo.qb.EnumQBAppType,O=mstrmojo.array,N=mstrmojo.DI.DIHelpers,c={SET_SINGLE_PARTITION_EMMA:4},I=S.SAPHana,J={SPECIAL_SOURCE:1,ALTERNATE_SOURCE:2,REFRESH_DATA:3},C={1:mstrmojo.desc(12406,"Multiple tables cannot be added to the selection list as this data source has a special restriction which allows only a single table to be present in the data cube."),2:mstrmojo.desc(13534,"Multiple tables cannot be added to the selection list when setting Alternate Source."),3:mstrmojo.desc(13535,"Multiple tables cannot be added to the selection list when refreshing data for a table which is not a partition table.")},R=10,b=0,W=0;function U(k){var m={isPartition:false},n,j=[],l;if(!k){return m;}m.type=k.tp;m.isPartition=m.type!==0;n=k.ptabs||[];O.forEach(n,function(o){l={};if(o.n){l.name=o.n;}if(o.hasOwnProperty("shnb")){l.sheetIndex=o.shnb;}j.push(l);});m.tables=j;return m;}function Y(j){var k=[],l;O.forEach(j,function(m){l={n:m.dbtn||m.n,ns:m.ns,dbr:m.dbr,dbrn:m.dbrn,tid:m.tid||"",gbqpid:m.gbqpid||""};if(m.extt){l.extt=m.extt;}if(m.clis){l.clis=m.clis;}if(m.hanai){l.afis=m.hanai.afis;l.hieris=m.hanai.hieris;l.varis=m.hanai.varis;}k.push(l);});return k;}function P(r,q,n){var o=mstrApp.getRootController().getDataService(),m,l,u=r.length,t=(mstrApp.getRootController().model&&mstrApp.getRootController().model.original)!==undefined,j={success:function p(){var w={};b+=R;if(b>=u){m=JSON.stringify(Y(r));w.tables=m;if(n!==undefined){w.flag=n;}o.autoMap(q,w);}else{l=[];O.forEach(r.slice(b,b+R),function(x){l.push(x.tid);});o.prepareData(j,{tables:l.join(",")},Math.min(b+R,u),u,undefined,t);}},failure:function k(){b+=R;},canceled:function(z,x){var w={success:function(){q.canceled();},failure:function(){q.canceled();}};if(x&&(x.tid||x.jid)){o.killJob(w,{threadId:x.tid,jobid:x.jid});}else{w.success();}}};l=[];O.forEach(r.slice(b,b+R),function(w){l.push(w.tid);});o.prepareData(j,{tables:l.join(",")},Math.min(b+R,u),u,undefined,t);}function A(){this.raiseEvent({name:"refreshTables",items:this.tables.slice(0),tablesEnabled:this.getAvailableTablesEnabled()});}mstrmojo.qb.es.Model=mstrmojo.declare(mstrmojo.warehouse.WHModel,null,{scriptClass:"mstrmojo.qb.es.Model",tables:[],addTableErrorMsg:undefined,dbRolesVersionExcludeFilter:[223],isDataImport:true,init:function a(j){if(this._super){this._super(j);}if(j===undefined||j.tables===undefined){this.tables=[];}if(j===undefined){return ;}if(this.isForAlternateSource){this.maxTableCount=1;this.addTableErrorMsg=C[J.ALTERNATE_SOURCE];}else{if(this.isDDA&&(j.tableID!==undefined&&j.tableID!=="")&&(j.type===D.xdaType.qbSingleTable||j.type===D.xdaType.googleBigQuerySingleTable)){this.maxTableCount=1;this.addTableErrorMsg=C[J.SPECIAL_SOURCE];}}if(j.dbTypes!==undefined){this.specifyDBTypes=true;var k=j.dbTypes;if(j.hasNonSapHana||mstrApp.isSingleTier){O.removeItem(k,I);}this.dbRolesTypeFilter=k;this.dbmsTypeFilter=k.slice(0);}if(j.dbIds){this.dbRoleEditorCfg={hideShareConnection:true,dbIdFilter:j.dbIds};}if(j.dbVersions){this.dbRolesVersionFilter=j.dbVersions;this.dbmsVersionFilter=j.dbVersions;}this.dbRolesVersionExcludeFilter=(j.dbRolesVersionExcludeFilter!==undefined)?[223].concat(j.dbRolesVersionExcludeFilter):[223];if(mstrApp.isSingleTier){this.dbRolesVersionExcludeFilter=[203,220,228,252].concat(this.dbRolesVersionExcludeFilter);this.dbRoleEditorCfg=this.dbRoleEditorCfg||{};this.dbRoleEditorCfg.dsnDbTypeExcludeFilter=[4000];}if(j.dbObjects!==undefined){this.dbObjects=j.dbObjects;}if(j.isSapHanaSingleTable){this.isDDA=true;this.origIsDDA=true;this.dbObjectsDisplayOptions=1;this.specifyDBTypes=true;this.dbRolesTypeFilter=[S.SAPHana];this.dbmsTypeFilter=this.dbRolesTypeFilter.slice(0);}if(j.isHadoopQB){this.dbObjectsDisplayOptions=16;this.specifyDBTypes=true;this.dbRolesTypeFilter=D.hadoopDbTypes.slice(0);this.dbmsTypeFilter=this.dbRolesTypeFilter.slice(0);this.dbRolesVersionExcludeFilter=D.ibmDb2Versions.concat(this.dbRolesVersionExcludeFilter);}if(j.subtype!==undefined){switch(j.subtype){case D.sourceSubtype.searchOnSource:this.maxTableCount=1;this.addTableErrorMsg=C[J.SPECIAL_SOURCE];this.isDDA=true;this.origIsDDA=true;this.dbRoleEditorCfg={hideDSNOption:true,hideDriverCheck:true,requiresLogin:false,dbIdFilter:[40]};this.helpTopic="importing_data_using_a_search_as_a_source.htm";this.dbObjectsDisplayOptions=4;this.specifyDBTypes=true;this.dbRolesTypeFilter=[S.SearchEngineSOLR,S.SearchEngineSPLUNK];break;}}this.dbRoleEditorCfg.dbIdExcludeFilter=[41,15];this.dbRoleEditorCfg.cfgDbmsTypeExcludeFilter=[3000];},helpTopic:"Importing_data_from_a_database_by_picking_relation.htm",dbRoleEditorCfg:{dbIdExcludeFilter:[41]},canAddTableInDDA:function Z(n){var m=this.tables,k=this.SelDBRoleID,l,j;if(this.isDDA){l=this.dbridForDDA;if(l&&k!==l){j={name:"directDataAccessTableError"};}else{if(!l&&m.length>0&&k!==m[0].dbr){j={name:"directDataAccessTableError"};}}}if(j){if(!n){this.raiseEvent(j);}return false;}return true;},canAddTable:function h(k,n){var o=this.tables,r=n?n.length:0,l=this.maxTableCount,q=[],m,u={OLAP:4+262144000,JOIN:5+262144000,CALC:7+262144000};if(!this.canAddTableInDDA(k)){return false;}if(l&&o.length+r>l){if(!k){this.raiseEvent({name:"maxTableError"});}return false;}var p=this.SelDBRoleID,j=this.getDBRole(p),t=false;if(j&&j.mdDBRole&&j.mdDBRole.db_type===I){mstrmojo.array.forEach(n,function(w){m=parseInt(w.extt,10);if(m!==u.OLAP&&m!==u.JOIN&&m!==u.CALC){q.push(w);}});mstrmojo.array.removeItems(n,"did",q);if(q.length>0){this.raiseEvent({name:"SapHanaIncompatibleTypeError",data:q});}if(r!==0&&n.length===0){return false;}mstrmojo.array.forEach(o,function(w){if(p!==w.dbr){t=true;return false;}});}else{mstrmojo.array.forEach(o,function(w){if(w.hanai){t=true;return false;}});}if(t){this.raiseEvent({name:"SaPHanaError"});return false;}return true;},handleKeepSessionAlive:function Q(){if(N.isServerBasedWS()){mstrApp.serverRequest({taskId:"keepSessionAlive"},{success:function(j){if(j){mstrApp.sessionManager.warningTimeoutTimer(mstrApp.sessionManager.maxSessionIdleTime);}else{mstrApp.sessionManager.sessionTimedout=true;mstrmojo.alert("Your session is expired.");}},failure:function(){mstrmojo.alert("Problems encountered during activating session. Connection is down or session already time out.");}});}else{if(N.getEnvObj().isWS()){}else{mstrApp.sessionManager.keepSessionAlive();}}},addTable:function e(l){var k=this.tables,j=this.SelDBRoleID,n=this.getDBRole(j),p=n.n,o,m=this;if(!this.canAddTable(false,l)){return ;}if(n.mdDBRole&&n.mdDBRole.db_type===I){mstrmojo.array.forEach(l,function(q){k.push({n:q.n,ns:q.ns,dbr:j,dbrn:p,dbtn:q.dbtn,extt:q.extt,hanai:q.hanai,clis:q.clis});});A.call(m);}else{mstrmojo.array.forEach(l,function(q){k.push({n:q.n,ns:q.ns,dbr:j,dbrn:p,dbtn:q.dbtn,gbqpid:m.selectedProject});});if(!this.isDDA){o=mstrApp.getRootController().getDDAController();o.tryEnableDDACheckbox(false);}if(mstrApp.msgid&&mstrApp.sessionManager){m.handleKeepSessionAlive();}A.call(m);}},removeTable:function g(j){var o=mstrApp.getRootController().getDataService(),k=this.tables,m,l=this,n;n=k[j].tid;k.splice(j,1);if(k.length===0&&this.canAddTable(true)){this.raiseEvent({name:X.DBTABLES_ENABLED,value:true});}if(!this.isDDA){m=mstrApp.getRootController().getDDAController();m.tryEnableDDACheckbox(true);}if(n&&!l.original){o.removeEMMATable({success:function(){A.call(l);}},{did:n});}else{if(mstrApp.msgid&&mstrApp.sessionManager){l.handleKeepSessionAlive();}A.call(l);}},removeDBRoleTables:function G(m){var j=this.tables,k=[],l;if(!m){return ;}O.forEach(j,function(n){if(n.dbr!==m){k.push(n);}});if(k.length===j.length){return ;}j=this.tables=k;A.call(this);if(j.length===0&&this.canAddTable(true)){this.raiseEvent({name:X.DBTABLES_ENABLED,value:true});}if(!this.isDDA){l=mstrApp.getRootController().getDDAController();l.tryEnableDDACheckbox(true);}},getAvailableTablesEnabled:function f(){return this.canAddTableInDDA(true);},commitChangesEditPartition:function K(q){var o=this,p=mstrApp.getRootController().getDataService(),k,m=[],r=o.tables,n,l,j=true;if(r.length===0){return ;}n=r[0].dbr;l=r[0].ns;O.forEach(r,function(t){j=t.dbr&&t.dbr===n&&((!t.ns&&!l)||(t.ns===l));if(!j){return false;}m.push(t.n);return true;});if(!j){mstrmojo.alert(mstrmojo.desc(12383,"Error: All the tables should share the same database and namespace when refreshing a partition table"),null,null);return ;}k={mode:c.SET_SINGLE_PARTITION_EMMA,partitionId:o.tableID,addTables:JSON.stringify(m)};p.changePartition(q,k);},commitChanges:function B(o){var n=!!(this.tableID&&this.partition&&this.partition.isPartition),j=this.original,k=this;var l=function(){if(!n&&this.tableID&&this.tables.length>1){n=true;}k._commitChanges(o,n);};O.forEach(k.tables,function(p){if(p.extt){k.isSapHana=true;return false;}});if(j&&k.isSapHana===true){k.editSapHanaTable(o);return ;}if(j){k.originalMsgID=mstrApp.msgid;mstrApp.getRootController().getDataService().removeOrDuplicateRI({success:function m(p){k.messageID=p.msgid;mstrApp.msgid=p.msgid;l();}},{messageID:mstrApp.msgid});}else{l();}},editSapHanaTable:function H(p){var o=!!(this.tableID&&this.partition&&this.partition.isPartition),l=false,k=this,j=p,n=mstrmojo.desc(14666,"Do you want to group these tables into a single partition table?");if(!o&&this.tableID&&this.tables.length>1){o=true;l=true;}if(!o){k._commitChanges(p);return ;}p={success:function m(){k._commitChanges(j,true);}};if(l){mstrmojo.confirm(n,{confirmBtn:{fn:function(){k.commitChangesEditPartition(p);}}});}else{k.commitChangesEditPartition(p);}},_commitChanges:function d(t,q){var n=t;var r=mstrApp.getRootController().getDataService(),p=this,k=false,l,o,m=false,j=function j(AA){if(p.tables.length===0){if(AA&&AA.success){AA.success({msgid:mstrApp.msgid});}return ;}O.forEach(p.tables,function(AB){if(AB.extt){m=true;return false;}});if(m){p.isDDA=true;}var x=function x(){var AB=p.tables;if(p.original&&!m){AB[0].tid="";}else{if(p.original&&m){AB=q?[p.tables[0]]:p.tables;}}l=JSON.stringify(Y(AB));if(mstrApp.msgid){o=m?64:0;o=o|((p.original&&m)?16:0);r.createEmmaTables(AA,{tables:l,skip:k,flag:o,said:mstrApp.said||"",xt:mstrApp.type,sap:m});}else{r.createEmmaInstance({success:function AC(AD){mstrApp.msgid=AD.msgid;r.createEmmaTables(AA,{tables:l,skip:k});}});}};if(p.tables.length>0&&!m&&mstrApp.type!==F.BigQuerySingleTable){k=true;b=0;AA={success:function z(AB){var AC=p.tables;O.forEach(AC,function(AE,AD){if(AB.tables&&AB.tables.length===AC.length){AE.tid=AB.tables[AD].id;}});P(AC,mstrmojo.func.wrapMethods(n,{canceled:function(){}}),o);}};}else{if(p.tables.length>0&&!m&&mstrApp.type===F.BigQuerySingleTable){AA={success:function z(AB){O.forEach(p.tables,function(AD,AC){if(AB.tables&&AB.tables.length===p.tables.length){AD.tid=AB.tables[AC].id;}});n&&n.success(AB);}};}else{if(m){W=0;var w={success:function z(AC){var AB=[],AD=p.tables[W];O.forEach(AC.items,function(AE){AB.push(AE.dbInfo);});AD.clis=AB;AD.hanai=AC.hanaInfo;W++;if(W>=p.tables.length){x();}else{p.getColumnsForDBTable({data:p.tables[W]},mstrmojo.hash.copy(w,{}));}},failure:function u(){W++;}};p.getColumnsForDBTable({data:p.tables[W]},mstrmojo.hash.copy(w,{}));return ;}}}x();};if(p.original){p.tables[0].tid=p.tableID;}j(t);},loadTable:function M(k){var l=this,j=mstrApp.getRootController();l.tableID=k;l.submitRequest({success:function m(z){var AD=z.datap.srce,n=AD.dbrid,x,AB=l.tables,p,r=AD.ns||"",o=AD.gbqp||"",w=(AD.dbtp===I),q,u,AC=(mstrApp.type===F.BigQuerySingleTable);l.original=AD;l.usingCookieNamespace=true;if(!AC){u=l.getDBRole(n);p=(u&&u.n)||"";}else{p=AD.gbqp;}if(!l.isBigQuery&&!u){l.fetchAndAppendSingleDBR(n);}x=l.partition=U(AD.pti);if(x.isPartition){O.forEach(x.tables,function(AE){AB.push({n:AE.name,ns:r,dbr:n,dbrn:p});});}else{AB.push({n:AD.tbn,ns:r,dbr:n,dbrn:p,gbqpid:o});}A.call(l);if(AC){j.selectDBRole(o);if(l.getProject(o)===null){q=mstrmojo.desc(14098,"There is no project ## in ###").replace("##",o).replace("###",mstrApp.userEmail);mstrmojo.alert(q);}}else{j.selectDBRole(n);if(w){var t=AB[0];l.getSelectedDBRoleTables({dbRoleID:n,filterText:""},{success:function AA(AE){var AG=AE.items||AE.xrc.cas[0].tis;O.forEach(AG,function(AH){if((AH.tbn||AH.dbtn)===AD.tbn&&AH.ns===AD.ns){t.extt=AH.extt;t.hanai=AH.hanai;return false;}});l.getColumnsForDBTable({getFresh:true,data:{n:AD.tbn,dbtn:AD.tbn,ns:r}},{success:function AF(AI){var AH=[];O.forEach(AI.items,function(AJ){AH.push(AJ.dbInfo);});t.clis=AH;}});}});}}}},{taskId:"qBuilder.GetReportXDADefinition",showWait:true,tableID:k,browsetype:D.ERDF.ENUM_LOAD_REPORT_BROWSE_TYPE_DATAPREVIEW,previewflag:this.isRefined?4:8});},_set_SelDBRoleID:function(m,k){var j=this,l=(j.SelDBRoleID!==k);this._super&&this._super(m,k);j.SelDBRoleID=k;if(l&&k){j.setDBRole&&j.setDBRole(k);}mstrmojo.array.forEach(j.dbrs,function(n){if(n.data.isPrimary){n.data.isPrimary=false;j.raiseEvent({name:X.DBROLE_CHANGED,item:n});}if(n.did===k){n.data.isPrimary=true;j.raiseEvent({name:X.DBROLE_CHANGED,item:n});}});if(l){j.raiseEvent({name:X.DBTABLES_ENABLED,value:j.getAvailableTablesEnabled()});A.call(j);}return l;},submitRequest:function V(l,k,j){mstrApp.getRootController().getDataService()[j||"submitRequest"](l,k);},onisDDAChange:function E(j){var k=this;mstrApp.getRootController().getDDAController().checkDDACheckbox(j.value);k.raiseEvent({name:X.DBTABLES_ENABLED,value:k.getAvailableTablesEnabled()});A.call(k);},getHelpTopic:function L(){return this.helpTopic;},loadDBRoles:function(l,j){var k=this;return this._super(mstrmojo.func.wrapMethods(l,{success:function(){if(k.defaultDbrId){mstrApp.getRootController().selectDBRole(k.defaultDbrId);}}}),j);}});}());(function(){mstrmojo.requiresCls("mstrmojo.qb.bigquery._hasBigQueryModel","mstrmojo.qb.es.Model");mstrmojo.qb.bigquery.ESModel=mstrmojo.declare(mstrmojo.qb.es.Model,[mstrmojo.qb.bigquery._hasBigQueryModel],{scriptClass:"mstrmojo.qb.bigquery.ESModel",getDBRole:function A(){return{n:this.selectedProject};}});}());(function(){mstrmojo.requiresCls("mstrmojo.css","mstrmojo.hash","mstrmojo.Box","mstrmojo.Label","mstrmojo.expr","mstrmojo.ValidationTextBox","mstrmojo.Dialog","mstrmojo.cookies","mstrmojo.string");mstrmojo.requiresDescs(17,18,221,9772,11773,14028,16220,16227,14138,14139,14140,14149,14522,14523,14524,16224,14526,14527);var M=mstrmojo.css,W=mstrmojo.dom,I=mstrmojo.hash;var D=mstrmojo.validation,G=D.STATUSCODE,H=D.TRIGGER,V=D.VALIDATOR,K=mstrmojo.expr.DTP;var c={intervalCtr:0,qrLoaded:false,maxPollingAttempts:80,timeDelay:3000};var Q={mini_badge:"#ddd",mini_badge_icon:"../style/mstr/images/badge-placeholder-m.png",t_color:"#797979",appName:"",name:""};var F={firstName:"",badgeId:""};var J={duration:undefined,elem:undefined,callback:undefined,timerInterval:null,init:function(e,d,f){this.duration=e;this.elem=d;this.callback=f;},startTimer:function(){this.stopTimer();var j=Date.now(),f,d,g;var e=this;function h(){f=e.duration-(((Date.now()-j)/1000)|0);d=(f/60)|0;g=(f%60)|0;d=d<10?"0"+d:d;g=g<10?"0"+g:g;e.elem.set("text",d+":"+g);if(f<=0){j=Date.now()+1000;e.callback();e.stopTimer();}}h();this.timerInterval=setInterval(h,1000);},stopTimer:function(){if(this.timerInterval){clearInterval(this.timerInterval);}}};function B(d){d.sn=this.serverName||mstrConfig.serverName;d.sp=this.serverPort||mstrConfig.serverPort;d.connectionId=this.connectionId||"";return d;}function R(){this.set("expired",true);this.usherProps.qrLoaded=false;}function N(){try{var f=this.usherProps;var d=this;if(f.qrLoaded){if(f.intervalCtr>f.maxPollingAttempts){R.call(d);}else{clearTimeout(this.pullTimeout);this.pullTimeout=setTimeout(function(){f.intervalCtr+=1;if(!d.stopPolling){X.call(d);}},f.timeDelay);}}}catch(g){}}function P(f,e,d){if(mstrApp.serverRequest){mstrApp.serverRequest(f,e,d);}else{mstrmojo.xhr.request("POST",mstrConfig.taskURL,e,f);}}function X(){var e=this,f=this.usherProps,g={taskId:"usherLoginWeb",pollOnly:"true",server:this.serverName||mstrConfig.serverName,port:this.serverPort||mstrConfig.serverPort,project:this.projectName||mstrConfig.projectName,connectionId:this.connectionId},d={success:function(j){try{if(j.status=="invalid"){N.call(e);}else{if(j.status=="success"){function h(n){e.onUsherLogin(n);f.qrLoaded=false;}if(e.rememberMe===true){var k={success:function(n){h(n);},failure:function(n){e.onUsherError(n);}};var m={taskId:"usherRememberMe"};m.deviceId=mstrmojo.cookies.getCookieSetting("usher_sso_device")?mstrmojo.cookies.getCookieSetting("usher_sso_device"):"";P(m,k,{doNotHold:true});}else{h(j);}}}}catch(l){mstrmojo.alert("usherPollForScan:\n "+l.messsage);}},failure:function(h){R.call(e);e.onUsherError(h);}};P(g,d,{doNotHold:true});}function a(d){this.userDetails.set("text",d||"");}function L(d){var e=this;e.loginButton.set("visible",d);e.loginNotificationBox.set("visible",!d);}function C(){var g=this.usherProps;var f=this.notificationTimer;var e=this,d={success:function(k){try{if(k.status==1){function n(){L.call(e,true);}function j(){if(e.pullTimeout){clearTimeout(e.pullTimeout);}e.usherProps.intervalCtr=0;g.qrLoaded=true;N.call(e);}var m=60*5;f.init(m,e.loginNotificationBox.timer,n);f.startTimer();L.call(e,false);j();}else{e.onUsherError(k);}}catch(l){mstrmojo.alert("Error:\n"+l.message);}},failure:function(j){e.onUsherError(j);}},h={taskId:"usherNotifyMe"};h.deviceId=mstrmojo.cookies.getCookieSetting("usher_sso_device")?mstrmojo.cookies.getCookieSetting("usher_sso_device"):"";P(B.call(this,h),d,{doNotHold:true});}function A(){var e=this,d={success:function(g){try{e.set("notificationMode",false);e.reloadQR();}catch(h){mstrmojo.alert("Error:\n"+h.messsage);}},failure:function(g){e.onUsherError(g);}},f={taskId:"usherRememberMe",rememberMe:false};if(e.userInfo.badgeId!==""){f.badgeId=e.userInfo.badgeId;}f.deviceId=mstrmojo.cookies.getCookieSetting("usher_sso_device")?mstrmojo.cookies.getCookieSetting("usher_sso_device"):"";P(B.call(this,f),d,{doNotHold:true});}function O(h){if(this.notificationMode==true&&!h){return ;}var f=this.usherProps;this.showQRLoading(true);var e=this,d={success:function(k){try{if(k.img){e.set("notificationMode",false);e.updateQRCode(k.img);e.set("badge",k.badgeInfo&&k.badgeInfo[0]);f.intervalCtr=0;f.qrLoaded=true;this.stopPolling=false;N.call(e);}else{var l=JSON.parse(k.data);var j=l.pnEnabled||l.isPNEnabled;e.set("isPnEnabled",j);if(l.code||l.proximityBasedLogin){e.set("notificationMode",false);if(l.proximityBasedLogin&&!h){e.updateQRCodeProximity();e.set("proximityMode",true);}else{e.updateQRCode(l.code);e.set("proximityMode",false);}e.set("badge",k.badgeInfo&&k.badgeInfo[0]);f.intervalCtr=0;f.qrLoaded=true;this.stopPolling=false;mstrmojo.cookies.updateCookieSetting("usher_sso_device",k.device_id);N.call(e);}else{e.set("proximityMode",false);e.set("notificationMode",true);e.refresh.set("visible",false);if(l.photoData&&e.userInfoNode){e.userInfoNode.src="data:image/png;base64,"+l.photoData;}e.userInfo.firstName=l.firstName;e.userInfo.badgeId=l.badgeId;L.call(e,true);e.set("badge",k.badgeInfo&&k.badgeInfo[0]);}}}catch(m){mstrmojo.alert("getQRCode:\n "+m.messsage);}},failure:function(j){e.handleQRCodeError(j);R.call(e);e.onUsherError(j);},complete:function(){e.showQRLoading(false);}},g={taskId:"usherQRWeb"};g.deviceId=mstrmojo.cookies.getCookieSetting("usher_sso_device")?mstrmojo.cookies.getCookieSetting("usher_sso_device"):"";P(B.call(this,g),d,{doNotHold:true});}function E(){var f=this,j=this.registerButton,g=this.parent.badgeNode.childNodes[1];if(j.enabled){j.set("enabled",false);M.addClass(g,["anim"]);var d={},e={success:function(k){var l=k&&k.name==f.user.value;d={msg:l?mstrmojo.desc(14139,"You've successfully registered. Please check your email to continue.")+" "+mstrmojo.desc(16222,"Or perform a MicroStrategy badge recovery."):k.getResponseHeader("X-MSTR-TaskFailureMsg"),successful:l};},failure:function(k){d={msg:k.getResponseHeader("X-MSTR-TaskFailureMsg"),successful:false};},complete:function(){j.set("enabled",true);M.removeClass(g,["anim"]);f.set("regMsg",d);}},h={taskId:"usherRegUsr",server:this.serverName||mstrConfig.serverName,project:mstrConfig.projectName,port:this.serverPort||mstrConfig.serverPort,email:this.email.value,userid:this.user.value,password:this.pwd.value};P(h,e);}}function U(d){return mstrmojo.hash.copy(d,{scriptClass:"mstrmojo.ValidationTextBox",cssDisplay:"block",postCreate:function(){if(W.isIE9||W.isIE8||W.isIE7){this.emptyText=this.hint;}},onEnter:function(){E.call(this.parent);}});}mstrmojo.UsherLogin=mstrmojo.declare(mstrmojo.Container,null,{scriptClass:"mstrmojo.UsherLogin",markupString:'<div id="{@id}" class="mstrmojo-UsherLogin-Container {@cssClass}" style="{@cssText}" ><div class="mstrmojo-UsherLogin-badge"><div class="icn"><img src="../images/1ptrans.gif"/></div><div class="dots"><div class="dot1"></div><div class="dot2"></div><div class="dot3"></div></div><div class="app"><img src="../style/mstr/images/badge-app.png"/></div></div><div class="mstrmojo-UsherLogin-badgeLabel"><div class="app-name"></div><div id="badgename" class="badge-name"></div></div><div class="mstrmojo-UsherLogin"><div class="mstrmojo-UsherLogin-QR mode"><img class="QR" src="../images/1ptrans.gif" alt="" /></div><div class="mstrmojo-UsherLogin-register mode"></div></div><div class="mstrmojo-UsherLogin-userInfo mode"><img class="userInfo" src="../images/1ptrans.gif" alt="" /></div><div class="mstrmojo-UsherLogin-notification"></div><div class="mstrmojo-UsherLogin-remember-setting"><div class = "mstrmojo-UsherLogin-remember"></div><div class = "mstrmojo-UsherLogin-forget"></div></div><div class="mstrmojo-UsherLogin-link"></div></div>',markupSlots:{containerNode:function(){return this.domNode;},badgeNode:function(){return this.domNode.firstChild;},badgeIconNode:function(){return this.domNode.firstChild.firstChild.firstChild;},badgeLabelNode:function(){return this.domNode.childNodes[1];},usherNode:function(){return this.domNode.childNodes[2];},qrNode:function(){return this.domNode.childNodes[2].firstChild;},qrCodeNode:function(){return this.domNode.childNodes[2].firstChild.firstChild;},refreshNode:function(){return this.domNode.childNodes[2].firstChild.lastChild;},registerNode:function(){return this.domNode.childNodes[2].lastChild;},userNode:function(){return this.domNode.childNodes[3];},userInfoNode:function(){return this.domNode.childNodes[3].firstChild;},notificationNode:function(){return this.domNode.childNodes[4];},rememberSettingsNode:function(){return this.domNode.childNodes[5];},rememberNode:function(){return this.domNode.childNodes[5].firstChild;},forgetNode:function(){return this.domNode.childNodes[5].lastChild;},linksNode:function(){return this.domNode.lastChild;}},markupMethods:{onqrCodeChange:function(){if(this.qrCodeNode){this.qrCodeNode.src=this.qrCode;}},onbadgeChange:function(){var e=this.badge||Q,j=e.badgeFormat,d=j&&JSON.parse(j)||{isnull:true},g=this.badgeLabelNode,f=this.badgeIconNode,h=this.domNode;if(this.showBadgeBackgroundImage){h.style.backgroundColor=d.mini_badge;if(d.bg_4){h.style.backgroundImage="url("+d.bg_4+")";}}f.src=d.mini_badge_icon||Q.mini_badge_icon;if(!d.isnull&&!d.mini_badge_icon){M.addClass(f.parentNode,"default");}g.firstChild.innerHTML=mstrmojo.string.encodeHtmlString(e.appName||Q.appName);g.lastChild.innerHTML=mstrmojo.string.encodeHtmlString(e.name||Q.name);g.lastChild.title=e.name||Q.name;g.style.color=d.t_color||Q.t_color;this.linksNode.style.color=d.t_color||Q.t_color;},onexpiredChange:function(){M.toggleClass(this.usherNode,"expired",this.expired);},onloadingChange:function(){M.toggleClass(this.usherNode,"loading",this.loading);},onvisibleChange:function(){this.domNode.style.display=this.visible?"block":"none";if(this.visible&&this.canRequestQR()&&!this._lastVisible){O.call(this);}this.stopPolling=!this.visible;this._lastVisible=this.visible;},onnotificationModeChange:function(d){M.toggleClass(this.containerNode,"notificationMode",this.notificationMode);},onproximityModeChange:function(d){M.toggleClass(this.containerNode,"proximityMode",this.proximityMode);},onisPnEnabledChange:function(){this.hideRememberMe(!this.isPnEnabled);}},qrCode:"../images/1ptrans.gif",badge:Q,expired:false,onUsherLogin:mstrmojo.emptyFn,onUsherError:mstrmojo.emptyFn,showBadgeBackgroundImage:true,usherProps:null,serverName:null,serverPort:null,rememberMe:false,userInfo:null,notificationTimer:null,loadQR:false,notificationMode:false,isPnEnabled:false,init:function S(d){if(this._super){this._super(d);}M.addWidgetCssClass(this,"");this.usherProps=this.usherProps?I.copy(this.usherProps,I.clone(c)):I.clone(c);this.userInfo=this.userInfo?I.copy(this.userInfo,I.clone(F)):I.clone(F);this.notificationTimer=this.notificationTimer?I.copy(this.notificationTimer,I.clone(J)):I.clone(J);},destroy:function Y(d){this.stopPolling=true;clearTimeout(this.pullTimeout);this._super(d);},canRequestQR:function(){return this.usherProps&&(this.loadQR||(this.serverName||mstrConfig.serverName));},showUserInfo:function(d){this.refresh.set("visible",false);this.refresh.set("visible",false);},updateQRCode:function(d){this.set("qrCode","data:image/png;base64,"+d);this.set("expired",false);this.refresh.set("visible",false);},updateQRCodeProximity:function(){this.set("qrCode","../images/WaitUsherRadar.gif");this.set("expired",false);this.refresh.set("visible",false);},handleQRCodeError:function(){this.set("qrCode","../style/mstr/images/msgError.gif");this.set("expired",true);this.refresh.set("visible",true);},showQRLoading:function Z(d){this.set("loading",d);if(d){this.refresh.set("visible",false);}},postBuildRendering:function(){this._super();this.registerForm.set("tabIndex",-1);},toggleRegister:function(d){this.registerVisible=(d!==undefined)?d:!this.registerVisible;M.toggleClass(this.usherNode,"show-register",this.registerVisible);this.registerLink.set("text",this.registerLink.texts[this.registerVisible?1:0]);if(this.isPnEnabled===true){this.hideRememberMe(this.registerVisible&&this.isPnEnabled);}},hideRememberMe:function(d){M.toggleClass(this.rememberSettingsNode,"hide-rememeber",d);},reloadQR:function(){if(this.canRequestQR()){if(this.pullTimeout){clearTimeout(this.pullTimeout);}this.usherProps.intervalCtr=0;this.usherProps.qrLoaded=false;if(this.visible){O.call(this);}}},children:[{scriptClass:"mstrmojo.Label",slot:"qrNode",alias:"refresh",cssClass:"refresh",text:mstrmojo.desc(14028,"Refresh QR Code"),visible:false,onclick:function(){O.call(this.parent);}},{scriptClass:"mstrmojo.Box",slot:"registerNode",alias:"registerForm",regMsg:null,children:[U({alias:"user",cssClass:"login-username",cssDisplay:"block",hint:mstrmojo.desc(17,"User name")}),U({alias:"pwd",cssClass:"login-pwd",hint:mstrmojo.desc(18,"Password"),type:"password"}),U({alias:"email",cssClass:"login-email",dtp:K.VARCHAR,constraints:{validator:V.VALIDATE_EMAIL,trigger:mstrmojo.validation.TRIGGER.ONKEYUP},bindings:{visible:"this.parent.parent.usherRegistrationOption > 2"},hint:mstrmojo.desc(9772,"Email")}),U({alias:"confirmEmail",cssClass:"login-email",bindings:{visible:function(){return this.parent.parent.usherRegistrationOption>2;}},hint:mstrmojo.desc(14149,"Confirm Email"),onpaste:function(d){W.preventDefault(d.hWin,d.e||d.hWin.event);}}),{scriptClass:"mstrmojo.Box",alias:"regMsg",cssClass:"register-msg",bindings:{regMsg:function(){return this.parent.regMsg;},visible:function(){return this.parent.regMsg;}},onregMsgChange:function(){if(this.domNode){this.domNode.style.color=this.regMsg&&this.regMsg.successful?"#42C31E":"#f00";}},children:[{scriptClass:"mstrmojo.Label",alias:"msg",cssClass:"register-msg-txt",bindings:{text:function(){return this.parent.regMsg.msg;}}},{scriptClass:"mstrmojo.Label",alias:"icn",cssClass:"register-msg-icn",onclick:function(){this.parent.parent.parent.toggleRegister();this.parent.parent.set("regMsg",null);}}]},{scriptClass:"mstrmojo.Button",alias:"registerButton",cssClass:"register mstrmojo-WebButton hot",cssDisplay:"inline-block",text:mstrmojo.desc(11773,"Register"),bindings:{enabled:function(){var k=this.parent.user.value,g=this.parent.email.value,e=this.parent.confirmEmail.value;var f=k.length>0;if(f){if(this.parent.parent.usherRegistrationOption>1){var j=g.length>=3&&e.length>=3&&g.toUpperCase()===e.toUpperCase()&&this.parent.email.validationStatus.code===G.VALID;if(j){if(this.parent.parent.usherRegistrationOption==7){var h=this.parent.parent.usherRegistrationDomain.toUpperCase();var d=g.substr(g.indexOf("@")+1).toUpperCase();return h.indexOf(d)>=0;}}return j;}}return f;}},onclick:function(){E.call(this.parent);}},{scriptClass:"mstrmojo.Button",alias:"registerCancelButton",cssClass:"register-cancel",cssDisplay:"inline-block",text:mstrmojo.desc(221,"Cancel"),onclick:function(){var d=this.parent;d.parent.toggleRegister();d.set("regMsg",null);d.user.set("value","");d.pwd.set("value","");d.email.set("value","");d.confirmEmail.set("value","");d.user.domNode.focus();}}]},{scriptClass:"mstrmojo.CheckBox",slot:"rememberNode",alias:"remember-me",label:mstrmojo.desc(14522,"Remember me"),onclick:function b(){this.parent.set("rememberMe",this.checked);}},{scriptClass:"mstrmojo.Label",slot:"forgetNode",allowHTML:true,text:mstrmojo.desc(14527,"Forget me/Switch user"),onclick:function(){A.call(this.parent);}},{scriptClass:"mstrmojo.Label",slot:"linksNode",allowHTML:true,text:'<a id="proximityProblems" href="#">Login via Phone</a>',onclick:function(d){O.call(this.parent,true);return false;},bindings:{visible:"this.parent.proximityMode"},},{scriptClass:"mstrmojo.Label",slot:"linksNode",allowHTML:true,text:mstrmojo.desc(16220,"Use your ###MicroStrategy Badge## app to scan the QR Code.").replace("###","").replace("##",""),},{scriptClass:"mstrmojo.Label",slot:"linksNode",alias:"registerLink",cssClass:"register-label",allowHTML:true,bindings:{visible:"this.parent.usherRegistrationOption > 0"},text:"",texts:[mstrmojo.desc(16227,"Don't have MicroStrategy Badge? Click ###here## to register."),mstrmojo.desc(14140,"Display your ###QR Code##.")],postCreate:function(){this.set("text",this.texts[0]);},ontextChange:function(){this.text=this.text.replace("###",'<a href="#" onclick="mstrmojo.all.'+this.parent.id+'.toggleRegister(); return false;">').replace("##","</a>");}},{scriptClass:"mstrmojo.Label",alias:"userDetails",cssClass:"user-details",slot:"userNode"},{scriptClass:"mstrmojo.Button",alias:"loginButton",cssClass:"mstrmojo-WebButton login-button .mstrButton",cssDisplay:"inline-block",text:mstrmojo.desc(16224,"Login with MicroStrategy Badge"),slot:"notificationNode",visible:false,onclick:function(){C.call(this.parent);},onvisibleChange:function(){var d=this.parent,e=mstrmojo.desc(14523,"Hi ")+" "+d.userInfo.firstName;this.visible?e+="!":e+=mstrmojo.desc(14524,", please approve on your device.");a.call(d,e);}},{scriptClass:"mstrmojo.Box",alias:"loginNotificationBox",cssClass:"login-notification",slot:"notificationNode",visible:false,children:[{scriptClass:"mstrmojo.Label",alias:"timer",cssClass:"notification-timer"},{scriptClass:"mstrmojo.Label",alias:"notificationFailure",cssClass:"notification-failure",text:mstrmojo.desc(14526,"Did not get notification"),onclick:function(){L.call(this.parent.parent,true);}}]},]});}());(function(){mstrmojo.requiresCls("mstrmojo.ValidationTextBox","mstrmojo.hash");var A=mstrmojo.hash;mstrmojo.ui.editors.controls.ValidationTextBox=mstrmojo.declare(mstrmojo.ValidationTextBox,null,{scriptClass:"mstrmojo.ui.editors.controls.ValidationTextBox",errRevert:true,dtp:null,validationDelay:3000,orignText:null,trigger:mstrmojo.validation.TRIGGER.ONKEYUP,init:function(B){B=B||{};B.constraints=B.constraints||{};B.constraints.trigger=this.trigger;this._super(B);},prekeyup:function(B){if(B.e.keyCode===13){this.blur();return ;}this._super(B);},onfocus:function(){this.orignText=this.value;},onblur:function(){if(this.value!=this.orignText){this.validate();}},validate:function(){this._super();this.orignText=this.value;this.clearValDelayTimer();},preinput:mstrmojo.emptyFn,postinput:function(){var B=this.doValidation(this.value);if(B.code<=mstrmojo.validation.STATUSCODE.VALID){this.clearValidation();if(!this.errRevert){this.hideTooltip();}}},updateTooltipConfig:function(){this.richTooltip={posType:mstrmojo.tooltip.POS_BOTTOMLEFT,cssClass:"vi-warning vi-tooltip-C vi-calculation-warning",left:this.domNode.offsetWidth+12,top:this.domNode.offsetHeight+5,refNode:this.domNode,content:mstrmojo.desc(13819,"Invalid input")};},onInvalid:function(){if(!this.errRevert){this.hideTooltip();this.showTooltip();}else{this.clearValidation();this.set("value",this.orignText);}}});}());(function(){mstrmojo.requiresCls("mstrmojo.ui.PopupConfig","mstrmojo.ui.menus.Menu","mstrmojo.hash","mstrmojo.array");mstrmojo.ui.menus.MenuItemType=null;var B=mstrmojo.array,X="separator";mstrmojo.ui.menus.MenuConfig=mstrmojo.declare(mstrmojo.ui.PopupConfig,null,{scriptClass:"mstrmojo.ui.menus.MenuConfig",menus:null,menuCssClass:"",supportsScroll:false,maxHeight:0,hasToggleItem:false,hasMenuItems:function S(){var Y=B.filter(this.menus||[],function(Z){return Z.cls!==X;});return !!Y.length;},getMenuItems:function F(Y){var a=B.filter(this.menus.slice().reverse(),function(e,d,c){var b=c[d+1];return Y||e.cls!==X||(d&&b&&b.cls!==X);}).reverse();var Z=(a&&a.length)||0;if(!Y&&Z>0&&a[Z-1].cls===X){a.pop();}return a;},getMenuItem:function D(b){var a=this.menus,Y;if(a!==null){for(Y=0;Y<a.length;Y++){var Z=a[Y];if(Z.cls===b){return Z;}}}return null;},absorbMenuItems:function V(Y){this.menus=this.menus.concat(Y.menus);if(!this.hasToggleItem&&Y.hasToggleItem){this.hasToggleItem=true;}},addMenuItem:function K(f,b,d,Z,c){var e,a,Y;if(!f||typeof f==="string"){e=f;}else{e=f.n;a=f.ttp;}Y={n:e,ttp:a,cls:b,fn:d,ctxt:Z};if(isNaN(c)||c>=this.menus.length){this.menus.push(Y);}else{this.menus.splice(c,0,Y);}if(b.indexOf(/\bon\b/)>-1){this.hasToggleItem=true;}return Y;},addCustomMenuItem:function W(d,a,c,Z,Y){var b=this.addMenuItem(d,a,c,Y);b.getItemMarkup=Z;return b;},addDisabledMenuItem:function Q(Z,Y){this.addNonInteractiveMenuItem(Z,Y,true);},addNonInteractiveMenuItem:function O(c,Z,Y){var a=["non-int"];if(Z){a.push(Z);}if(Y){a.push("disabled");}if(c&&typeof c!=="string"&&c.ttp){this.useTooltip=true;}var b=this.addMenuItem(c,a.join(" "),mstrmojo.emptyFn);b.dsbld=true;},addSeparator:function E(){this.addMenuItem("",X,function(){return false;});},addPopupMenuItem:function U(f,a,e,b,Z,c){var d=["pop "];if(b){d.push(b);}var Y=this.addMenuItem(f,d.join(" "),e,Z,c);Y.pop=true;Y.scope=a;return Y;},addActionPopupMenuItem:function N(f,Z,d,e,a,Y,c){var b=this.addPopupMenuItem(f,Z,e,(a||"")+" ax",Y,c);b.actionFn=d;b.ax=true;},addSubMenuItem:function M(c,a,Z,b,Y){this.addPopupMenuItem(c,Z,b,a,Y);},addEditorMenuItem:function R(c,Z,b,Y,a){this.addPopupMenuItem(c,Z,b,"",Y,a);},getToggleItemStates:function G(g,j,Y,e,a,d){var b,c,Z,f;if(typeof g==="string"){b=c=g;Z=f="";}else{b=g.on||"";c=g.off||"";Z=g.ttpOn||"";f=g.ttpOff||"";}var h=[{n:b,ttp:Z,cls:j+" on",fn:e,ctxt:d},{n:c,ttp:f,cls:j,fn:Y,ctxt:d}];if(!a){h.reverse();}return h;},addToggleMenuItem:function L(f,b,d,a,Z,e,Y){var c=this.getToggleItemStates(f,b,d,a,e,Y);this.hasToggleItem=true;return this.addDualStateItem(Z,c[0],c[1]);},addDualStateItem:function I(Z,Y,a){return this.addMenuItem({n:Y.n,ttp:Y.ttp},Y.cls,this.getDualStateHandler(Z,Y,a),Y.ctxt);},getDualStateHandler:function J(Z,Y,a){return function(c,d){var b=[Y,a];if(c.cls===Y.cls){b.reverse();}b[1].fn.call(mstrmojo.all[Z],c,d);c.n=b[0].n;c.ttp=b[0].ttp;c.cls=b[0].cls;};},addRadioMenuGroup:function C(a,f,b,Z,Y,e,d){var c=[];this.hasToggleItem=true;b.forEach(function(k,g){if(k.separator){this.addSeparator();return ;}var m=k.text,l=(Z||"")+" "+(k.cls||"")+(e?"":" radio")+(k.value===a?" on":""),j=function(){if(f.call(this.ctxt,k.value,a,k)===false){return false;}a=k.value;c.forEach(function(n){n.cls=n.cls.replace(/ on$/,"")+(n.radioValue===a?" on":"");});return true;},h=d?this.addCustomMenuItem(m,l,j,d(k,g),Y):this.addMenuItem(m,l,j,Y);h.radioValue=k.value;c.push(h);},this);},clear:function P(){this._super();this.menus=[];},newInstance:function A(Y){return new mstrmojo.ui.menus.Menu(mstrmojo.hash.copy({popupConfig:this},Y));},addMenuTitle:function H(Y){this.addMenuItem(Y||"","menu-item-title",mstrmojo.emptyFn);}});}());(function(){mstrmojo.requiresCls("mstrmojo.ListBase","mstrmojo.ui.menus.Menu","mstrmojo._IsList","mstrmojo.vi.ui._HasMask","mstrmojo.dom","mstrmojo.hash","mstrmojo.string","mstrmojo.ui.menus._HasMenuPopup","mstrmojo.ui._HasListTooltip");var F=mstrmojo.dom;mstrmojo.vi.ui.toolbars.Toolbar=mstrmojo.declare(mstrmojo.ListBase,[mstrmojo._IsList,mstrmojo.ui.menus._HasMenuPopup,mstrmojo.vi.ui._HasMask,mstrmojo.ui._HasListTooltip],{scriptClass:"mstrmojo.vi.ui.toolbars.Toolbar",tooltipOrientation:"vertical",init:function G(I){this._super(I);mstrmojo.css.addWidgetCssClass(this,"mstrmojo-VIToolbar");},selectionPolicy:"reselect",toolbarCfg:null,toolbarClicked:mstrmojo.emptyFn,tooltipCss:null,_set_toolbarCfg:function(L,I){var J=this.toolbarCfg,K=(J!==I);if(K){if(J){J.destroy();}this.toolbarCfg=I;}return K;},getItemProps:function D(K,I){var J=this._super(K,I);J.addCls(K.cls);J.addStyle("display:inline-block");return J;},postBuildRendering:function C(){var I=document.createElement("div");I.className="mstrmojo-VIDND-mask";this.maskNode=this.domNode.appendChild(I);return this._super();},postselectionChange:function(I){var J=I.added;if(J){var K=this.items[J[0]];if(K.tp==="pb"&&K.isMenuClicked){K.menufn(K,this);}else{K.fn(K,this);}}},ontoolbarCfgChange:function H(I){var K=I.valueWas;if(K){K.destroy();}var J=I.value;if(!J){return ;}this.set("items",J.btns);if(this.hasRendered){this.raiseEvent({name:"renderComplete"});}},openMenu:function E(J,I){J.hostId=this.id;J.hostElement=this._getItemNode(I._renderIdx);this.openPopup(J.newInstance());},onclick:function A(I){var K=I.target||F.eventTarget(I.hWin,I.e),J=this.getItemFromTarget(K);if(J&&J.tp==="pb"){if(K&&K.className){J.isMenuClicked=K.className.indexOf("icn")===-1;}}this.toolbarClicked(I);this._super(I);},destroy:function B(J){var I=this.toolbarCfg;if(I){I.destroy();}delete this.items;this._super(J);}});}());(function(){mstrmojo.requiresCls("mstrmojo._HasOwnAvatar","mstrmojo.array","mstrmojo.css","mstrmojo.dom","mstrmojo.hash","mstrmojo.ui.menus._HasMenuPopup","mstrmojo.ui.SimpleTree","mstrmojo.warehouse._CanToggleAvatarClass","mstrmojo.warehouse.EnumObjectTypes");var Z=mstrmojo.array,b=mstrmojo.css,G=mstrmojo.dom,X=mstrmojo.hash,d="item-mn",K="item-n",A="userSel",U="mltSel",B=mstrmojo.warehouse.EnumObjectTypes,N=B.TABLE,D="li",L="ul",W="idx",H=":";function V(f){if(this.hasRendered){var g=this.domNode.getElementsByTagName(D);Z.forEach(g,f,this);}}function I(){var f=[];X.forEach(this.userSelections,function(g,h){f.push(this.getTreeItem(h));},this);return(f.length>1)?f:null;}mstrmojo.warehouse.ui.TablesTree=mstrmojo.declare(mstrmojo.ui.SimpleTree,[mstrmojo._HasOwnAvatar,mstrmojo.ui.menus._HasMenuPopup,mstrmojo.warehouse._CanToggleAvatarClass],{scriptClass:"mstrmojo.warehouse.ui.TablesTree",markupString:'<div id="{@id}" class="mstrmojo-SimpleTree {@cssClass}" mstrAttach:click,dblclick>{@itemsHTML}</div>',userSelections:undefined,draggable:true,dropZone:true,getMenuHelper:mstrmojo.emptyFn,showTablesNum:true,init:function Y(f){this._super(f);this.cssClass+=" mstrmojo-wh-TablesTree";this.userSelections=[];},getItemMarkup:function F(){return'<div class="{@cls}" title="{@ttp}"><span class='+K+' unselectable="on">{@n}</span><span class='+d+"></span></div>";},treeHooks:{select:function S(h,AA,g){var f=G.findAncestorByAttr(h,"idx",true,this.domNode),AB=f.value,AE=this.userSelections,t=this.rangeSelect,AD,z,m=Number.MAX_VALUE,l=Number.MIN_VALUE,n,x,j,p,q,w,u,r=this.shiftStartIndex,AC=parseInt(g,10),k=AE[AB]===true;if(AA.tp===N){if(k){delete AE[AB];}else{AE[AB]=true;}AD=X.keyarray(AE);z=AD.length;b.toggleClass(this.domNode,U,z>1);b.toggleClass(h,A,!k);if(t&&z&&r){p=r.split(H);j=AB.split(H);if(p&&j&&(p.length===j.length)&&p.length===(AC+1)){for(u=0;u<p.length;u++){if(p[u]!==j[u]){break;}}if(u===AC){n=parseInt(j[AC],10);x=parseInt(p[AC],10);if(!isNaN(n)&&!isNaN(x)){m=(n<x)?n:x;l=(n>x)?n:x;}for(var o=m;o<=l;o++){j[g]=o.toString();q=j.join(H);w=this.getTreeItem(q);if(w&&w.tp===N){AE[q]=true;delete this.selectedIndices[q];}}V.call(this,function(AG){var AF=AG.getAttribute(W);if(AE[AF]===true){b.toggleClass(AG,A,true);}});}}}}delete this.selectedIndices[AB];return true;},unselect:function M(g,h,j,f){this.itemRenderer.select(g,h,j,f,this);this.selectedIndices[h._renderIdx]=true;return true;}},tablesTreeHooks:{},showMenu:function Q(g){var h=this.getMenuHelper(),j=1;mstrApp.getRootController().setTableMenuContext(j);h.target=this;h.data=g.data;var f=h.getMenuConfig();f.hostId=this.id;f.hostElement=g.menuNode;f.isHostedWithin=false;f.hostProxyCssClass="item-mn-proxy";this.openPopup(new mstrmojo.ui.menus.Menu({popupConfig:f}));},onclick:function e(g){var l=g.target||G.eventTarget(g.hWin,g.e),k=G.findAncestorByAttr(l,"idx",true,this.domNode),m=k&&k.node.getAttribute("level"),j=G.shiftKey(g.hWin,g.e),h=k&&k.value,f=l.className===d&&h!==null&&!isNaN(m);if(!(G.ctrlKey(g.hWin,g.e)||G.metaKey(g.hWin,g.e)||j)){if(!f||!this.userSelections[h]){this.clearUserSelections(X.copy(this.userSelections));}else{this.userSelections[h]=false;}}if(j){this.rangeSelect=true;}else{this.shiftStartIndex=h;}this._super(g);if(f){this.showMenu({data:I.call(this)||this.getTreeItem(h),menuNode:l});}this.rangeSelect=false;},ondblclick:function J(o){var l=this,k=o.target||G.eventTarget(o.hWin,o.e),g=k.nodeName.toLowerCase(),r=G.findAncestorByAttr(k,"idx",true,this.domNode),f=r&&r.node.getAttribute("level"),n=r&&r.value,p=this.selectedIndices,m,q=p[n],h,j=l.tablesTreeHooks;l.onclick(o);if((g!==L)&&(g!==D)&&n!==null&&!isNaN(parseInt(f,10))){h=this.getTreeItem(n);if(j.isTable===undefined||j.isTable(h)){if(q){m=j.removeItem;}else{m=j.addItem;}if(m){m.call(l,r.node,h,f,n,p,this);}}}},createAvatar:function O(f){var h=document.createElement("div"),g=G.findAncestorByAttr(f,W,true,this.domNode);if(g&&g.node){h.appendChild(g.node.cloneNode(true));h.appendChild(document.createElement("div"));}h.className=this.domNode.className;return h;},toggleAvatarClass:function P(f,g){b.toggleClass(this.avatar,f,g);},getDragData:function E(g){var f=this.getNodeAttributes(g.src.node).index,j=this.getTreeItem(f),h=this.userSelections;if(j.tp===N){if(h[f]===true){return I.call(this)||[j];}this.clearUserSelections(X.copy(h));return[j];}return j;},isDragValid:function C(){return true;},ondragstart:function a(f){this._super(f);var g=f.src.data;if(this.showTablesNum&&g&&g.length>1){this.avatar.getElementsByClassName(K)[0].innerHTML=g.length;}},getNodeAttributes:function c(g){var f=G.findAncestorByAttr(g,W,true,this.domNode),h=f&&f.node.getAttribute("level");return{index:f&&f.value,level:parseInt(h,10)};},clearUserSelections:function R(f){V.call(this,function(h){var g=h.getAttribute(W);if(f[g]===true){b.toggleClass(h,A,false);delete this.userSelections[g];}});b.toggleClass(this.domNode,U,false);}});}());(function(){mstrmojo.requiresCls("mstrmojo.ui.menus.PopupConfig","mstrmojo.ui.menus.MenuEditor");mstrmojo.ui.menus.EditorConfig=mstrmojo.declare(mstrmojo.ui.menus.PopupConfig,[mstrmojo._HasBindings],{scriptClass:"mstrmojo.ui.menus.EditorConfig",data:null,fnOk:null,fnCancel:null,okEnabled:true,cancelEnabled:true,okVisible:true,cancelVisible:true,init:function D(E){this._super(E);if(this.data&&!mstrmojo.all[this.data.id]){mstrmojo.hash.make(this.data,mstrmojo.Obj);}this.initBindings();},clear:function A(){this._super();this.data=null;this.fnOk=this.fnCancel=mstrmojo.emptyFn;},newInstance:function C(){return new mstrmojo.ui.menus.MenuEditor({popupConfig:this});},destroy:function B(){if(this.data){this.data.destroy();}this.destroyBindings();this._super();}});}());(function(){mstrmojo.requiresCls("mstrmojo.Button","mstrmojo.HTMLButton","mstrmojo.Label","mstrmojo.TextBox","mstrmojo.TextArea","mstrmojo.Table","mstrmojo.HBox","mstrmojo.Editor");function C(E,F){var D=this;if(mstrApp&&mstrApp.serverRequest){mstrApp.serverRequest(E,F,{silent:true});}else{mstrmojo.xhr.request("POST",D.path,F,E,undefined,D.XServer,D.baseParams);}}function A(H,I,G,D){var E=this,F={taskId:"createFolder",taskContentType:"json",folderID:H,name:I,description:G};C.call(E,F,D);}function B(E,I,F){if(!E){mstrmojo.alert(mstrmojo.desc(3380));return false;}var G=this,H=G.fId,D={success:function(J){G.contPanel.name.set("value","");G.contPanel.desc.set("value","");if(G.okFn){G.okFn(J,F);}},failure:function(J){var K="";if(J.getResponseHeader){K=J.getResponseHeader("X-MSTR-TaskFailureMsg");}else{if(J.message){K=J.message;}}K&&mstrmojo.alert(K);}};if(mstrApp.isSingleTier&&this.dp){this.dp.newFolder(H,E,I,D);}else{A.call(G,H,E,I,D);}}mstrmojo.NewFolderEditor=mstrmojo.declare(mstrmojo.Editor,null,{scriptClass:"mstrmojo.NewFolderEditor",cssClass:"mstrmojo-NewFolderEditor",title:mstrmojo.desc(663,"Create Folder"),help:"Create_a_new_folder.htm",navigateAfter:false,okFn:mstrmojo.emptyFn,path:mstrConfig.taskURL,fId:null,children:[{scriptClass:"mstrmojo.Table",cssClass:"mstrmojo-Input-Panel",rows:2,cols:2,alias:"contPanel",children:[{scriptClass:"mstrmojo.Label",cssClass:"mstrmojo-Name-Label",slot:"0,0",text:mstrmojo.desc(2211,"Name:")},{scriptClass:"mstrmojo.TextBox",slot:"0,1",value:mstrmojo.desc(8116,"New Folder"),alias:"name",cssClass:"mstrmojo-SaveAsEditor-nameInput"},{scriptClass:"mstrmojo.Label",cssClass:"mstrmojo-Desc-Label",slot:"1,0",text:mstrmojo.desc(1154,"Description:")},{scriptClass:"mstrmojo.TextArea",cssClass:"mstrmojo-SaveAsEditor-descInput",slot:"1,1",alias:"desc",rows:5}]},{scriptClass:"mstrmojo.HBox",alias:"btns",slot:"buttonNode",cssClass:"mstrmojo-Editor-buttonBar",children:[{scriptClass:"mstrmojo.Button",cssClass:"mstrmojo-WebButton hot",alias:"ok",text:mstrmojo.desc(1442,"OK"),onclick:function(){var E=this.parent.parent,G=E&&E.opener,D=E.contPanel.name.value,F=E.contPanel.desc.value;if(!B.call(E,D,F,E.navigateAfter)){E.close();}}},{scriptClass:"mstrmojo.Button",cssClass:"mstrmojo-WebButton",alias:"cancel",text:mstrmojo.desc(221,"Cancel"),onclick:function(){this.parent.parent.close();}}]}]});}());(function(){mstrmojo.requiresCls("mstrmojo.hash","mstrmojo.HTMLButton","mstrmojo.HBox","mstrmojo.Label","mstrmojo.Editor");mstrmojo.requiresDescs(221,1442,3393,5282,9124,12407);var S=mstrmojo.hash,Y=mstrmojo.css,D=mstrmojo.dom,J=mstrmojo.desc,L=mstrmojo.array,C="on";var W={2219:[" IN "],2220:["[Not In]"]},B={525:[" LIKE "],526:["[Not Like]"],686:[" Contains "],2784:["[Not Contains]"],687:["[Begins With]"],2785:["[Not Begins With]"],688:["[Ends with]"],2786:["[Not ends with]"]},V=S.copy(W,{520:["="],612:["<>"],521:[">"],523:["<"],522:[">="],524:["<="],Between:[" between ","AND"],"Not between":["[Not Between]","AND"]});V=S.copy(B,V);var F=mstrmojo.desc(5282,"AND"),N={Between:[F],"Not between":[F]};var P={numeric:{2219:["1234,12345,123456"],2220:["1234,12345,123456"],520:["123456"],612:["123456"],521:["123456"],523:["123456"],522:["123456"],524:["123456"],Between:["1234","123456"],"Not between":["1234","123456"],525:["1%4_6"],526:["1%4_6"],686:["1%4_6"],2784:["1%4_6"],687:["1%4_6"],2785:["1%4_6"],688:["1%4_6"],2786:["1%4_6"]},vchar:{2219:["abcde,abcdef"],2220:["abcde,abcdef"],520:["abcde"],612:["abcde"],521:["aa"],523:["zz"],522:["aa"],524:["zz"],Between:["aa","zz"],"Not between":["mn","zz"],525:["a%d_f"],526:["a%d_f"],686:["a%d_f"],2784:["a%d_f"],687:["a%d_f"],2785:["a%d_f"],688:["a%d_f"],2786:["a%d_f"]},date:{2219:["2014-02-14,2014-12-25 00:00:00"],2220:["2014-02-14,2014-12-25 00:00:00"],520:["2014-12-25"],612:["2014-12-25"],521:["2014-12-25"],523:["2014-12-25"],522:["2014-12-25"],524:["2014-12-25"],Between:["2014-02-14","2014-12-25"],"Not between":["2014-02-14","2014-12-25"],525:["2014-0_-25%"],526:["2014-0_-25%"],686:["2014-0_-25%"],2784:["2014-0_-25%"],687:["2__4-"],2785:["2__4-"],688:["-25%"],2786:["-25%"]}};var R=",",I="'",X='"',G={"'":1,'"':1},M="(",O=")";function H(b){var a=b.length;b=b.substring(G[b[0]]?1:0,(G[b[a-1]]?a-1:a));return[I,b,I].join("");}function K(b){var a=b.toString();if(a.match(/#\d+#/)){return a;}return"#"+a+"#";}function Q(c){var b=c.split(R),a=[];L.forEach(b,function(d){a.push(H(d));});return a.join(R);}function A(b,a){var d,e=[],c=b;if(a){d=b.split(R);L.forEach(d,function(f){e.push(X+f+X);});c=e.join(R);}return M+c+O;}mstrmojo.qb.FilterValueEditor=mstrmojo.declare(mstrmojo.Editor,null,{scriptClass:"mstrmojo.qb.FilterValueEditor",init:function U(a){this._super(a);this.help=this.help||(mstrApp&&mstrApp.helpTopics&&mstrApp.helpTopics.filterValue)||"Enter_Value_dialog_box.htm";},zIndex:100,title:mstrmojo.desc(9124,"Enter Value"),cssClass:"mstrmojo-qb-filtervalue-editor",help:"",column:null,operatorID:null,paraNum:null,MAX_PARA_NUM:2,children:[{scriptClass:"mstrmojo.HBox",cssClass:"mstrmojo-qb-filtervalue-box",alias:"box",children:[{scriptClass:"mstrmojo.Label",alias:"label0",cssClass:"mstrmojo-qb-filtervalue-name1",cssDisplay:""},{scriptClass:"mstrmojo.TextBox",alias:"input0",cssClass:"mstrmojo-qb-filtervalue-textbox1",cssDisplay:""},{scriptClass:"mstrmojo.Label",alias:"label1",cssClass:"mstrmojo-qb-filtervalue-name2",cssDisplay:""},{scriptClass:"mstrmojo.TextBox",alias:"input1",cssClass:"mstrmojo-qb-filtervalue-textbox2",cssDisplay:""}]},{scriptClass:"mstrmojo.HBox",cssClass:"mstrmojo-qb-filterexample-box",alias:"exampleBox",children:[{scriptClass:"mstrmojo.Label",alias:"exampleLabel",cssClass:"mstrmojo-qb-example-label",text:mstrmojo.desc(3993,"Example:")},{scriptClass:"mstrmojo.Label",alias:"exampleLabel0",cssClass:"mstrmojo-qb-example-name0",cssDisplay:""},{scriptClass:"mstrmojo.Label",alias:"exampleAndLabel",cssClass:"mstrmojo-qb-example-and-label",text:F,cssDisplay:""},{scriptClass:"mstrmojo.Label",alias:"exampleLabel1",cssClass:"mstrmojo-qb-example-name1",cssDisplay:""}]},{scriptClass:"mstrmojo.Label",alias:"err",cssClass:"mstrmojo-qb-filtervalue-errmsg",text:""},{scriptClass:"mstrmojo.HBox",cssClass:"mstrmojo-Editor-buttonBox",slot:"buttonNode",alias:"buttonBox",children:[{scriptClass:"mstrmojo.Button",cssClass:"mstrmojo-Editor-button mstrmojo-WebButton",cssText:"float:right;",text:mstrmojo.desc(1442,"OK"),alias:"ok",onclick:function Z(){var l=this.parent.parent,e=l.box,a=l.operatorID,k,n=l.isDateTime,q=l.isBigDecimal,b=l.isString,h,p=l.paraNum,d=[],c,o="["+l.column+"]",j,g=B.hasOwnProperty(a),m=W.hasOwnProperty(a),f;if(p<=0||p>l.MAX_PARA_NUM){return ;}for(c=0;c<p;c++){k=e["input"+c].value;if(k===""){return ;}if(n&&!g){k=Q(k);}else{if(q){k=K(k);}}if(m){k=A(k,b);}else{if(g||b){k=X+k+X;}}d.push(k);}f=V[a];if(!f||f.length!==p){return ;}for(c=0,j=[o];c<p;c++){j.push(" ",f[c]," ",d[c]);}h=j.join("");mstrApp.getRootController().parseExpression({expr:h,qbrex:2,cIndex:1,vo:1},{success:function(t){if(t&&t.mi){var r=t.mi,u=r.reject_error_description;if(u){if(n&&r.reject_error_code===-2147214817){u=J(12407,"(Please enter a valid date/time value.)");}l.err.set("text",u);}else{l.close();mstrApp.getRootController().addNewFilter({et:"*",expr:r.items,n:h,sqltp:r.exp.sqltp});mstrApp.getRootController().refreshConditionDialog();}}}});}},{scriptClass:"mstrmojo.Button",cssClass:"mstrmojo-Editor-button mstrmojo-WebButton",text:mstrmojo.desc(221,"Cancel"),alias:"cancel",onclick:function(a){var b=this.parent.parent;if(b.onCancel){b.onCancel();}b.close();}}]}],onOpen:function E(){var e=this.box,l=this.paraNum,k=this.MAX_PARA_NUM,c,m,o,n,b=this.buttonBox,h,p=this.exampleBox,d=p.exampleAndLabel,f,j=this.isDateTime,a=this.isString;n=[this.n].concat(N[this.operatorID]||[]);var g=j?"date":(a?"vchar":"numeric");f=P[g][this.operatorID]||[];this.err.set("text","");e.input0.focus();Y.toggleClass(this.editorNode,"multi",l>1);for(c=0;c<k;c++){m=e["label"+c];m.set("text",n[c]||"");o=e["input"+c];o.set("value","");Y.toggleClass(m.domNode,C,c<l);Y.toggleClass(o.domNode,C,c<l);m=p["exampleLabel"+c];m.set("text",f[c]||"");Y.toggleClass(m.domNode,C,c<l);Y.toggleClass(d.domNode,C,c<l);}if(D.isIE7||D.isIE8){h=[b.ok,b.cancel];for(c=0;c<h.length;c++){h[c].inputNode.style.minWidth=(l===1)?"70px":"";}}}});}());(function(){mstrmojo.requiresCls("mstrmojo.hash","mstrmojo.array","mstrmojo.css","mstrmojo.string","mstrmojo._HasPopup","mstrmojo.ListBase","mstrmojo.Popup","mstrmojo.Editor","mstrmojo.SuggestionList");function D(b,Y){var a=this.list,W=a.selectedIndex,V=a.items.length,X=b?V-1:0;if(W===X){a.clearSelect();return ;}if(W===null||W<0){W=b?0:V-1;}else{W+=b?1:-1;}if(Y){var Z=a.items[W];while(Z&&Z.type==="dummy"){if(W===X){a.clearSelect();return ;}W+=b?1:-1;Z=a.items[W];}}a.singleSelect(W);}mstrmojo._HasSuggestion=mstrmojo.provide("mstrmojo._HasSuggestion",mstrmojo.hash.copy(mstrmojo._HasPopup,{blockBegin:1,blockCount:-1,suggestCount:15,autoSelect:true,itemField:"n",candidates:null,suggestionShown:false,suggestionItems:null,_last_hit:null,_request_pattern:null,browseItemVisible:false,folderLinksContextId:25,browsableTypes:"1,8",REQUEST_THRESHOLD:20,noCache:false,disableClick:false,getCandidatesThroughTaskCall:mstrmojo.emptyFn,onSuggestionItemSelect:function J(V){this.hideSuggestion();},getSearchPattern:function U(){return"";},getSuggestionPos:function N(){return{left:"100px",top:"100px"};},getSuggestionTarget:function G(){return this;},showSuggestion:function B(W){var V=this.getSuggestion(W);if(!this.noCache&&V!==-1){this.updateSuggestion(V);}},hideSuggestion:function C(){this.suggestionShown=false;if(this.suggestionPopup.visible){this.suggestionPopup.close();}},getSelected:function M(){return(this.suggestionShown)?this._lastOpened.getSelected():null;},nextHighlight:function E(V){if(this.suggestionShown){this._lastOpened.nextHighlight(V);}},preHighlight:function H(V){if(this.suggestionShown){this._lastOpened.preHighlight(V);}},getSuggestion:function S(j){var e=this.candidates,b=e&&e.items,Y=e&&e.isComplete,h=this._last_hit;if(!this.noCache&&(e||h)){var g=this.filterCandidates(b,j,this.REQUEST_THRESHOLD),d=g.length,f=this.suggestCount,V=false;if(!Y&&d<f){var W=h&&h.pattern;if(h&&W&&(j.indexOf(W)>-1)){V=true;var l=this.filterCandidates(h.items,j,this.REQUEST_THRESHOLD),Z=l&&l.length,X=mstrmojo.array,k=this.itemField,a;for(a=0;a<Z;a++){if(X.find(g,k,l[a][k])===-1){g.push(l[a]);}}d=g.length;}}if(!Y&&((j.length>2&&d<this.REQUEST_THRESHOLD)||(d<f))){this.requestCandidates(j);return -1;}return(d<f)?g:g.slice(0,f);}this.requestCandidates(j);return -1;},requestCandidates:function A(V){this._request_pattern=V;var Y=this,W=this.getSuggestionTarget(),X={success:function(f){if(!f){return ;}var e=Y.getSuggestionTarget();if(!e||(W!==e)){return ;}var k=e.getSearchPattern(),b=f.items;Y._last_hit={items:b,pattern:V};Y.sz=f.sz;if(!Y.noCache&&b){var g=(Y.candidates&&Y.candidates.items)||[],h=[].concat(b),d=b.length,a;for(a=0;a<d;a++){var Z=h[a];if(mstrmojo.array.indexOf(g,Z)>-1){mstrmojo.array.removeItem(b,Z);}}if(Y.candidates){Y.candidates.items=g.concat(b);}}if((k||k==="")&&k.indexOf(V)>-1){var j=Y.filterCandidates(b,k);Y.updateSuggestion(j);}},failure:function(Z){if(Z.getResponseHeader){mstrmojo.alert(Z.getResponseHeader("X-MSTR-TaskFailureMsg"));}}};this.getCandidatesThroughTaskCall({pattern:V,blockBegin:this.blockBegin,blockCount:this.blockCount,isSuggest:true},X);},filterCandidates:function Q(Y,X,V){V=V||this.suggestCount;X=mstrmojo.string.regEscape(X);var Z=this.itemField,W=mstrmojo.array.filter(Y,function(a){return(new RegExp("\\s"+X+"|^"+X,"i")).test(a[Z]);},{max:V});return W;},getHighlightedText:function P(X,a){if(!this.highlightPattern||mstrmojo.string.isEmpty(X)){return a;}try{if(!this.nameWildcards||mstr.$A.find([2,32],parseInt(this.nameWildcards,10))>-1){a=a.replace(new RegExp("(^|\\s)("+X+")","gi"),"$1<b>$2</b>");}else{var Z=X.split(" "),W,V;for(W=0,V=Z.length;W<V;W++){if(Z[W]!==""){a=a.replace(new RegExp("("+Z[W]+")","gi"),"<b>$1</b>");}}}}catch(Y){}return a;},updateSuggestion:function O(Y){var W=Y&&Y.length,V=this.browseItemVisible;if(W||V){if(V){Y=Y||[];Y.push({n:"Browse...",t:-99,cssClass:(W?"br":"bro")});}this.set("suggestionItems",Y);if(this.suggestionShown){var X=this._lastOpened;if(X&&X.nudge){X.nudge();}if(this.autoSelect&&X){X.list.singleSelect(0);}}else{this.openPopup("suggestionPopup",this.getSuggestionPos());this.suggestionShown=true;}}else{this.hideSuggestion();}},ob:{scriptClass:"mstrmojo.Editor",title:mstrmojo.desc(5298,"Select an Object"),help:"Select_Objects_dialog_box_.htm",onClose:function(){var V=this.opener;if(V&&V.onBrowserClose){V.onBrowserClose();}},onOpen:function(){var V=this.opener;if(V&&V.onBrowserOpen){V.onBrowserOpen();}},children:[{scriptClass:"mstrmojo.ObjectBrowser",alias:"browser",fishEyeVisible:false,closeable:false,closeOnSelect:false}]},onBrowserClose:function L(){this.browserShown=false;},handleSuggestionItemSelect:function K(V,W){if(this.browseItemVisible&&V.t===-99){this.hideSuggestion();mstrmojo.requiresCls("mstrmojo.ObjectBrowser");var X=this.zIndex;this.openPopup("ob",{zIndex:(X&&(X+10))||110});this.ob.browser.browse(mstrmojo.hash.copy(W,{folderLinksContextId:this.folderLinksContextId,onSelectCB:[this,"onSuggestionItemSelect"],browsableTypes:this.browsableTypes}));this.browserShown=true;}else{this.onSuggestionItemSelect(V);}},highlightPattern:true,suggestionPopupCssClss:"",suggestionPopup:{scriptClass:"mstrmojo.Popup",cssClass:"mstrmojo-ObjectInputBox-suggest",autoClose:true,locksHover:true,nextHighlight:function(V){D.call(this,true,V);},preHighlight:function(V){D.call(this,false,V);},getSelected:function M(){var V=this.list;return V.items[V.selectedIndex];},onOpen:function I(){var V=this.opener;if(V){mstrmojo.css.addClass(this.domNode,V.suggestionPopupCssClss||"");if(V.autoSelect){this.list.singleSelect(0);}if(V.nudge){V.nudge(this);}}},onClose:function F(){this.list.clearSelect();var V=this.opener;if(V){V.suggestionShown=false;mstrmojo.css.removeClass(this.domNode,V.suggestionPopupCssClss||"");}}},suggestionListClass:"mstrmojo.SuggestionList",postApplyProperties:function R(){this.suggestionPopup.children=[{scriptClass:this.suggestionListClass,alias:"list",cssClass:"mstrmojo-suggest-list"}];}}));}());(function(){mstrmojo.requiresCls("mstrmojo.Editor","mstrmojo.warehouse.EnumObjectTypes");var K=mstrmojo.warehouse.EnumObjectTypes,H=mstrmojo.desc(12218,"Rename Object"),C=mstrmojo.desc(11457,"Please enter name:"),G=mstrmojo.desc(11440,"(lookup)"),D=mstrmojo.desc(518,"Attribute"),I=mstrmojo.desc(1821,"db conn"),J=mstrmojo.desc(11458,"Fact"),B=mstrmojo.desc(7755,"Table");function E(){var M=mstrmojo.string.trim(this.txtbox.value);if(!this.isNew){if(M===this.originalName){if(this.onCancel){this.onCancel();}this.close();return ;}}if(mstrApp.getRootController().validateName(this.tp||this.data.tp,M,((this.isNew?undefined:this.originalName)))){this.onOK(M);this.close();}}mstrmojo.architect.ui.editors.NameEditor=mstrmojo.declare(mstrmojo.Editor,null,{scriptClass:"mstrmojo.architect.ui.editors.NameEditor",cssClass:"mstrmojo-ar-ne",isNew:false,originalName:"",tp:undefined,txtbox:undefined,error:undefined,onOpen:function F(){var O=this.data,N=O.n||O.name,M=this.txtbox,P=M.domNode;N=(N.indexOf(G,0)>0)?N.substr(0,N.indexOf(G)):N;this.originalName=N;M.set("value",N);P.focus();P.select();switch(O.tp){case K.ATTRIBUTE:this.set("title",D+" - "+O.n);break;case K.FACT:this.set("title",J+" - "+O.n);break;case K.TABLE:this.set("title",B+" - "+O.n);this.warningBox.set("visible",true);break;case K.DBROLE:this.set("title",I);break;default:this.set("title",H);break;}},children:[{scriptClass:"mstrmojo.Label",text:C},{scriptClass:"mstrmojo.TextBox",alias:"txtbox",onkeyup:function A(M){switch(M.e.keyCode){case 13:E.call(this.parent);break;case 27:this.parent.close();break;default:break;}}},{scriptClass:"mstrmojo.HBox",cssClass:"mstrmojo-Warning-Box",alias:"warningBox",visible:false,children:[{scriptClass:"mstrmojo.Box",cssClass:"icon"},{scriptClass:"mstrmojo.Label",text:"This operation requries a schema update and can take a while",cssClass:"message"}]},{scriptClass:"mstrmojo.HBox",cssClass:"mstrmojo-Editor-buttonBox",slot:"buttonNode",children:[{scriptClass:"mstrmojo.Button",cssClass:"mstrmojo-Editor-button rightfloat mstrmojo-WebButton hot",text:mstrmojo.desc(1442,"OK"),onclick:function L(){E.call(this.parent.parent);}},{scriptClass:"mstrmojo.Button",cssClass:"mstrmojo-Editor-button mstrmojo-WebButton",text:mstrmojo.desc(221,"Cancel"),onclick:function L(){var M=this.parent.parent;if(M.onCancel){M.onCancel();}M.close();}}]}]});}());(function(){mstrmojo.requiresCls("mstrmojo.List","mstrmojo.Editor","mstrmojo.Label","mstrmojo.HBox");mstrmojo.requiresDescs(218,219,3610,9161,10040,10041,13318,15481,13074,13075,15482,13077,13078,13079,15483,15484);var C=[mstrmojo.desc(15481,"The following attribute, which is currently used to personalize the dossier, is missing. ")+'<span style="color:red;"><u>'+mstrmojo.desc(13074,"If you do not include it, personalization will not be applied")+"</u></span>"+mstrmojo.desc(13075," and users could have access to more data than they are currently allowed to view."),mstrmojo.desc(15482,"The following attributes, which are currently used to personalize the dossier, are missing. ")+'<span style="color:red;"><u>'+mstrmojo.desc(13077,"If you do not include them, personalization will not be applied")+"</u></span>"+mstrmojo.desc(13075," and users could have access to more data than they are currently allowed to view.")],B=[mstrmojo.desc(13078,"If you still want to make this change please unmap the attributes by going to Share>Personalize."),mstrmojo.desc(13079,"If you still want to make this change please unmap the attribute from your Recipient List by going to Share>Deliver.")],A=[mstrmojo.desc(15483,"The following object is missing which could affect your dossier definition."),mstrmojo.desc(15484,"The following objects are missing which could affect your dossier definition.")];mstrmojo.qb.MissingColumnWarning=mstrmojo.declare(mstrmojo.Editor,null,{scriptClass:"mstrmojo.qb.MissingColumnWarning",cssClass:"",title:mstrmojo.desc(3610),hasPT:false,isCube:true,warning:mstrmojo.desc(10040,"Some of the previously uploaded columns are missing"),details:mstrmojo.desc(10041,"If you do not import previously used columns, existing reports, documents and analyses might be affected. Do you still want to continue?"),onOpen:function(){var F=this.mappings,E=this.hasPT,D=this.buttonBox,G=(F.length>1)?1:0;this.set("title",mstrApp.isCloudPro?(E?mstrmojo.desc(9161,"Oops!"):mstrmojo.desc(13318,"Just Checking")):mstrmojo.desc(3610));this.list.set("items",F);this.warningLabel.set("text",E?C[G]:(mstrApp.isCloudPro?A[G]:this.warning));this.detailLabel.set("text",E?B[this.isCube?0:1]:this.details);D.YesButton.set("visible",!E);D.NoButton.set("visible",!E);D.OKButton.set("visible",E);},cssText:"width: 400px",children:[{scriptClass:"mstrmojo.Label",cssClass:"mstrmojo-qb-MissingColumns-title",alias:"warningLabel"},{scriptClass:"mstrmojo.List",alias:"list",cssClass:"mstrmojo-qb-MissingColumns-list",itemIdField:"did",itemMarkupFunction:function(D,F,G){var E='<div class="mstrmojo-qb-MissingColumns-bullet mstrmojo-qb-MissingColumns-Icon t'+D.tp+'">'+D.n+"</div>";return E;}},{scriptClass:"mstrmojo.Label",cssClass:"mstrmojo-qb-MissingColumns-instruction",alias:"detailLabel"},{scriptClass:"mstrmojo.HBox",cssClass:"mstrmojo-qb-MissingColumns-buttonBox",slot:"buttonNode",alias:"buttonBox",cssText:"float:right;background:transparent;height:45px;",children:[{scriptClass:"mstrmojo.Button",cssClass:"mstrmojo-Editor-button mstrmojo-Editor-button-Yes",text:mstrmojo.desc(219,"Yes"),alias:"YesButton",onclick:function(D){var F=this.parent.parent;var E=true;if(F.onOK){E=F.onOK();}if(E){F.close();}}},{scriptClass:"mstrmojo.Button",cssClass:"mstrmojo-Editor-button mstrmojo-Editor-button-No",text:mstrmojo.desc(218,"No"),alias:"NoButton",onclick:function(D){var E=this.parent.parent;if(E.onCancel){E.onCancel();}E.close();}},{scriptClass:"mstrmojo.Button",cssClass:"mstrmojo-Editor-button mstrmojo-Editor-button-OK",alias:"OKButton",onclick:function(D){this.parent.parent.close();}}]}],onRender:function(){this.helpNode&&(this.helpNode.style.display="none");this.closeNode&&(this.closeNode.style.display="none");}});})();(function(){mstrmojo.requiresCls("mstrmojo.array","mstrmojo.css","mstrmojo.expr","mstrmojo.func","mstrmojo.string","mstrmojo.Box","mstrmojo.HBox","mstrmojo.TextBox","mstrmojo.Button","mstrmojo.Label","mstrmojo._HasLayout","mstrmojo.Editor","mstrmojo.ui.CheckList","mstrmojo.ui.ToggleButton","mstrmojo.mstr.EnumDSSXMLObjectTypes");mstrmojo.requiresDescs(10,1763,15120,15801);var L=mstrmojo.array,Z=mstrmojo.css,D=mstrmojo.dom,Q=mstrmojo.expr,U=mstrmojo.func,B=mstrmojo.string,R=mstrmojo.Button.newWebButton,b=mstrmojo.mstr.EnumDSSXMLObjectTypes;var W=mstrmojo.desc(1763,"Clear All");mstrmojo.vi.ui.IncCheckList=mstrmojo.declare(mstrmojo.ui.CheckList,[mstrmojo.ui._IsIncFetchList],{scriptClass:"mstrmojo.vi.ui.IncCheckList",allowUnlistedValues:false,cssClass:"elementsList",initElements:function Y(e){var d=this.ifDataHelper,c=this;if(!d){return ;}e=U.wrapMethods({success:function(f){c.clearSelect(true);c.set("items",[]);c.initScroll();c.addItems(f&&f.es);}},e);d.getItems(1,e,{hideFailureErr:true});},addItems:function N(c){this._super(c||[]);this.postAddItems();this.updateScrollbars();},postAddItems:mstrmojo.emptyFn});function F(c){return !L.filterOne(c.fs,function(d){return d.isbf&&(!!d.dtp?d.dtp:Q.mapBaseFormTypeToDataType(d.bftp))!==Q.DTP.CHAR;});}mstrmojo.vi.ui.ElementsBrowser=mstrmojo.declare(mstrmojo.Box,[mstrmojo._HasLayout],{scriptClass:"mstrmojo.vi.ui.ElementsBrowser",markupString:'<div id="{@id}" class="mstrmojo-Box mstrmojo-ui-vi-ElementsBrowser {@cssClass}" style="{@cssText}"><div></div><div></div><div></div></div>',markupSlots:{containerNode:function(){return this.domNode;},searchBoxNode:function(){return this.domNode.firstChild;},buttonPanelNode:function(){return this.domNode.childNodes[1];},elementListNode:function(){return this.domNode.childNodes[2];}},layoutConfig:{h:{searchBoxNode:"26px",buttonPanelNode:"36px",elementListNode:"100%"},w:{searchBoxNode:"100%",buttonPanelNode:"100%",elementListNode:"100%"},xt:true},onBrowseElementsFailure:mstrmojo.emptyFn,onUpdateBrowseElementsParams:mstrmojo.emptyFn,children:[{scriptClass:"mstrmojo.HBox",slot:"searchBoxNode",alias:"util",cssClass:"elemsBrowser-utils-bar",children:[{scriptClass:"mstrmojo.Box",cssClass:"eb-box-search",alias:"box",children:[{scriptClass:"mstrmojo.TextBox",alias:"searchBox",hint:mstrmojo.desc(10,"Search"),cssClass:"eb-searchBox",valueChangeDelay:300,onEnter:function I(){var d=this.value,c=this.parent.parent.parent;c.set("searchPattern",d);},onvalueChange:function P(){var d=this.value,c=this.parent.parent.parent;c.set("searchPattern",d);}},{scriptClass:"mstrmojo.Button",cssClass:"eb-searchBox-clear",text:"",onclick:function(){var c=this.parent.searchBox;c.set("value","");c.cleanUp();c.focus();},bindings:{visible:"(this.parent.searchBox.value || '').length > 0"}}]},{scriptClass:"mstrmojo.Label",text:mstrmojo.desc(15120,"View Selected"),cssClass:"eb-viewSelected",title:mstrmojo.desc(15120,"View Selected")},{scriptClass:"mstrmojo.ui.ToggleButton",alias:"toggleSelected",oncheckedChange:function J(){var c=this.parent.parent;c.onsearchPatternChange();}}]},{scriptClass:"mstrmojo.HBox",slot:"buttonPanelNode",alias:"buttonPanel",cssClass:"elemsBrowser-button-panel",children:[{scriptClass:"mstrmojo.Button",text:W,title:W,alias:"clearAllBtn",cssClass:"eb-clearAll",useRichTooltip:true,updateTooltipConfig:function V(){var c=D.position(this.domNode);this.richTooltip={content:mstrmojo.desc(16192,"This function is currently not supported for non-text elements in the searching result."),cssClass:"vi-info vi-tooltip-C",left:c.x+60,top:c.y+5};},onclick:function(){var d=this.parent.parent,f=d.elementList;f.clearSelect(false);var c=d.getLocalSearchItems(),e=d.itemIdField;d.onItemsSelectionChange({added:[],removed:c,itemIdField:e});L.removeItems(d.selectedItems,e,c);},showTooltip:function C(f,d){var c=this.parent.parent;if(!this.enabled&&!B.isEmpty(c.getSearchBox().value)&&!F(c.attribute)){mstrmojo._HasTooltip.showTooltip.call(this,f,d);}}},]},{scriptClass:"mstrmojo.vi.ui.IncCheckList",alias:"elementList",slot:"elementListNode",itemIdField:null,bindings:{ifDataHelper:"this.parent.ifDataHelper",itemIdField:"this.parent.itemIdField"},postAddItems:function(){var c=this.parent.selectedItems||[];this.setSelectedItems(c);}}],itemIdField:"v",ifDataSource:null,searchPattern:null,ifDataHelper:null,attribute:null,attributeId:null,selectedItems:[],init:function(c){this._super(c);this.set("ifDataHelper",new mstrmojo.mstr.DocElementDataHelper({source:this.ifDataSource}));if(this.ifDataSource&&this.attribute){this.onattributeChange();}this.elementList.attachEventListener("selectionChange",this.id,"onElementsListchange");},updateClearAllBtnState:function O(){this.buttonPanel&&this.buttonPanel.clearAllBtn.set("enabled",(B.isEmpty(this.getSearchBox().value)||F(this.attribute))&&(this.getLocalSearchItems().length>0));},onElementsListchange:function H(j){var h=j&&j.added||[],f=j&&j.removed||[],g=this.elementList.items,c=this.itemIdField;if(!this.selectedItems){this.selectedItems=[];}var e=this.selectedItems,d=[],k=L.get(g,f);L.removeItems(e,c,k);var l;L.forEach(h,function(m){l=g[m];if(l&&L.find(e,c,l[c])<0){e.push(l);d.push(l);}});this.updateClearAllBtnState();if(k.length>0||d.length>0){this.onItemsSelectionChange({added:d,removed:k,itemIdField:c});}},onItemsSelectionChange:mstrmojo.emptyFn,updateBrowseConfig:function K(){var e=this,j=this.attributeId,c=this.attribute,h=this.searchPattern,g=function(l,m){l.set("textValid",!m);l.domNode.title=B.encodeHtmlString(m,true);};if(!j){return ;}this.ifDataHelper.set("items",null);var d={attributeID:j};if(h&&h!==""){d.searchPattern=h;d.matchCase=false;d.otp=c.t||b.Attribute;}this.onUpdateBrowseElementsParams(d);this.ifDataHelper.set("browseConfig",d);var k=e.getSearchBox();this.elementList.initElements({success:function(l){g(k,"");},failure:function(q){var n=parseInt(q.code,10)+4294967296,p=2147762269,l=2147762227,m=2147762262,o=2147894808;if(n===l||n===m){g(k,"");}else{if(n!==p){var r=(n!==o)?e.onBrowseElementsFailure.bind(e):null;var t={shortDesc:mstrmojo.desc(15402,"This object is not available at this time."),longDesc:q.message},u={title:mstrmojo.desc(15403,"Invalid Object"),buttons:[R(mstrmojo.desc(13197,"Got it"),r,false)]};mstrmojo.error(t,undefined,u);g(k,"");}else{g(k,q.message);}}}});var f=this.util&&this.util.toggleSelected;if(f){f.checked=false;Z.toggleClass(f.domNode,"checked",false);}this.updateClearAllBtnState();},isObjSearchable:function E(c){return !(c&&c.t===b.Consolidation);},onattributeChange:function A(){var c=this.attribute;this.attributeId=c&&c.did;this.searchPattern=null;this.selectedItems=[];this.updateBrowseConfig();var e=this.getSearchBox(),d=this.isObjSearchable(c);if(e){e.set("enabled",d);e.set("hint",d?mstrmojo.desc(10,"Search"):mstrmojo.desc(15801,"Not searchable"));}},getSearchBox:function M(){var c=this.util,d=this.util&&this.util.box;return d&&d.searchBox;},onifDataSourceChange:function G(){this.ifDataHelper.set("source",this.ifDataSource);this.ifDataHelper.set("items",null);},onsearchPatternChange:function X(){var d=this.util&&this.util.toggleSelected;if(!d||!d.checked){this.updateBrowseConfig();}else{var c=this.getLocalSearchItems();this.elementList.clearSelect(true);this.elementList.set("items",[]);this.elementList.addItems(c);this.updateClearAllBtnState();}},getLocalSearchItems:function S(){var d=[],c;if(this.searchPattern&&this.searchPattern!==""){var e=this.searchPattern.toLowerCase();L.forEach(this.selectedItems,function(f){c=(f.n||"").toLowerCase();if(c.indexOf(e)>-1){d.push(f);}});}else{d=(this.selectedItems||[]).slice(0);}return d;},_set_selectedItems:function a(g,c){var f=this.selectedItems,e=this.itemIdField;c=c||[];this.selectedItems=c;this.updateClearAllBtnState();if(f.length!==c.length){return true;}var d=L.intersection(f,c,e);return d.length!==f.length;},onselectedItemsChange:function(){this.elementList.setSelectedItems(this.selectedItems);}});}());(function(){mstrmojo.requiresCls("mstrmojo.Editor","mstrmojo.Label","mstrmojo.DataGrid");mstrmojo.requiresDescs(14615,1442,8684,12381,16212,12403,12404);var C=mstrmojo.desc;mstrmojo.qb.es.AlternateSourceDialog=mstrmojo.declare(mstrmojo.Editor,null,{scriptClass:"mstrmojo.qb.es.AlternateSourceDialog",cssClass:"mstrmojo-qb-ValidateAlternateSource-dialog",title:C(8684,"Error"),items:null,onOpen:function A(){var I=this.table,E=[],D,G=[C(14615,"Match Status"),C(12403,"Original Table"),C(12404,"New Table")],K,F=this.items.length;MATCH_RESULT_COLUMN=0;function H(P,R,N){var O=[P[1],P[0],P[2]],Q=this.dataField,M=O[Q],L;if(parseInt(Q,10)===MATCH_RESULT_COLUMN){if(M<0){L="";}else{L=M?'<div class="matched-item"></div>':'<div class="unmatched-item"></div>';}}else{L=M;}return L;}for(D=0;D<G.length;D++){K={headerText:G[D],colWidth:(D===MATCH_RESULT_COLUMN)?"120":"247",dataFunction:H,dataField:D.toString()};E.push(K);}for(D=0;D<9-F;D++){var J={0:"",1:-1,2:""};J.prototype=this.items[0];this.items.push(J);}I.set("columns",E);I.set("items",this.items);I.parent&&I.parent.positionDialog&&I.parent.positionDialog();},children:[{scriptClass:"mstrmojo.Label",cssClass:"validation-note1",text:C(16212,"The selected table cannot serve as an alternate source due to the below mismatches. Please select an alternate table.")},{scriptClass:"mstrmojo.DataGrid",alias:"table",cssClass:"validation-table",resizableColumns:false,columns:[]},{scriptClass:"mstrmojo.Label",cssClass:"validation-note2",text:C(12381,"Note: The column names and the data types have to match between the currently uploaded table and the original table for relational sources.")},{scriptClass:"mstrmojo.HBox",cssClass:"mstrmojo-Editor-buttonBox",slot:"buttonNode",children:[{scriptClass:"mstrmojo.Button",alias:"ok",text:mstrmojo.desc(1442,"OK"),cssClass:"mstrmojo-Button mstrmojo-WebButton hot",onclick:function(){var D=this.parent.parent;D.close();}}]}],postBuildRendering:function B(){if(this._super){this._super();}}});}());(function(){mstrmojo.requiresCls("mstrmojo.hash","mstrmojo.Editor","mstrmojo.Box","mstrmojo.CheckBox","mstrmojo.Label","mstrmojo.Button");mstrmojo.requiresDescs(4531,8262,12437,12438,12439,15645);var D=mstrmojo.hash;var E={Automatic:0,Manual:3};var J={Automatic:-1,False:0,True:1};var H={Automatic:-1,False:1,True:2};var F={mps:{afb:J.False,sfb:H.False,fbf:E.Automatic}};var B=["mps"],L=function(Q,O){var P=this.parent.parent,M=P.cloneModel,N=M.mps||{};if(N[Q]!==O){N[Q]=O;if(Q==="fbf"&&O===E.Manual){N.afb=(N.afb===J.Automatic)?J.False:N.afb;N.sfb=(N.sfb===H.Automatic)?H.False:N.sfb;}P.set("dirty",true);}};var I=function(M){return M&&M.afb===J.False&&M.sfb===H.False&&M.fbf===E.Manual;};mstrmojo.ME.DerivedMetricOptions=mstrmojo.declare(mstrmojo.Editor,null,{scriptClass:"mstrmojo.ME.DerivedMetricOptions",cssClass:"mstrmojo-DerivedMetricOptions",dirty:false,init:function K(M){this._super(M);mstrmojo.css.addWidgetCssClass(this,"dme");},updateModel:function C(){var N=this.model,M=this.cloneModel,O=M.mps;if(O.fbf===E.Automatic){O.afb=J.Automatic;O.sfb=H.Automatic;}else{if(O.fbf===E.Manual){O.afb=O.afb===J.Automatic?J.False:O.afb;O.sfb=O.sfb===H.Automatic?H.False:O.sfb;}}O.dirty=true;N.mps=M.mps;},onOpen:function A(){var O=this.cloneModel||{};D.make(O,mstrmojo.Obj);var N=mstrmojo.hash.copy(this.model,mstrmojo.hash.copy(F)),P,M;for(P=0,M=B.length;P<M;P++){O.set(B[P],D.clone(N[B[P]]));}this.cloneModel=null;this.set("cloneModel",O);},onClose:function G(){this.set("dirty",false);delete this.cloneModel;},children:[{scriptClass:"mstrmojo.HBox",alias:"fbFlagBox",cssClass:"mstrmojo-DerivedMetricOptions-aggBox",children:[{scriptClass:"mstrmojo.Label",cssText:"white-space: nowrap; margin-right: 8px; vertical-align: top;",text:mstrmojo.desc(12437,"Aggregation And Subtotal Behavior:")},{scriptClass:"mstrmojo.Pulldown",alias:"fbFlag",cssText:"min-width: 100px;",cssClass:"mstrmojo-ME-Pulldown",popupCssClass:"mstrmojo-ME-Pulldown-Popup",itemIdField:"v",items:[{n:mstrmojo.desc(4531,"Automatic"),v:E.Automatic},{n:mstrmojo.desc(8262,"Manual"),v:E.Manual}],bindings:{value:function(){return this.parent.parent.cloneModel.mps.fbf||E.Automatic;}},onvalueChange:function(M){if(M.value!==undefined&&M.valueWas!==undefined){L.call(this,"fbf",M.value);}}}]},{scriptClass:"mstrmojo.Box",cssText:"height: 30px",cssClass:"mstrmojo-DerivedMetricOptions-afbBox",children:[{scriptClass:"mstrmojo.CheckBox",alias:"afb",cssDisplay:"inline-block",label:mstrmojo.desc(12438,"Aggregate From Base"),bindings:{visible:function(){return this.parent.parent.fbFlagBox.fbFlag.value===E.Manual;},checked:function(){return this.parent.parent.cloneModel.mps.afb===J.True;}},onclick:function(M){var N=this.parent.parent.fbFlagBox.fbFlag.value;L.call(this,"afb",N===E.Automatic?J.Automatic:(this.checked?J.True:J.False));}},{scriptClass:"mstrmojo.CheckBox",alias:"sfb",cssDisplay:"inline-block",label:mstrmojo.desc(12439,"Subtotals From Base"),oncheckedChange:function(M){var N=this.parent.afb;if(M.value){if(!N.checked){N.checked=J.True;N.onclick();}if(N.inputNode){N.inputNode.checked=true;N.inputNode.disabled=true;}}else{if(N.inputNode){N.inputNode.disabled=false;}}},bindings:{visible:function(){return this.parent.parent.fbFlagBox.fbFlag.value===E.Manual;},checked:function(){return this.parent.parent.cloneModel.mps.sfb===H.True;}},onclick:function(){var M=this.parent.parent.fbFlagBox.fbFlag.value;L.call(this,"sfb",M===E.Automatic?H.Automatic:(this.checked?H.True:H.False));}}]},{scriptClass:"mstrmojo.HBox",alias:"buttonBar",slot:"buttonNode",cssClass:"mstrmojo-Editor-buttonBar",cellCssClass:"subBox",children:[{scriptClass:"mstrmojo.Button",cssClass:"mstrmojo-Editor-button mstrmojo-WebButton hot",alias:"saveokButton",text:mstrmojo.desc(2397,"OK"),bindings:{enabled:function(){return this.parent.parent.dirty;}},onclick:function(){var P=this.parent.parent,R=P&&P.opener;var Q=function(){P.updateModel();if(P.onOK){P.onOK();}P.close();};var M=P.cloneModel,N=M&&M.mps;if(I(N)&&R&&R.hasConditionFilter&&R.hasConditionFilter()){mstrmojo.warn(mstrmojo.desc(15645,"There is a filter defined for this metric, if you proceed this filter will be removed."),{confirmBtn:{t:mstrmojo.desc(212,"Continue"),fn:function O(){Q();R.clearConditionFilter();},hot:false},cancelBtn:{t:mstrmojo.desc(221,"Cancel"),fn:mstrmojo.emptyFn,hot:true}});}else{Q();if(R&&R.onMpsChange){R.onMpsChange();}}}},{scriptClass:"mstrmojo.Button",cssClass:"mstrmojo-Editor-button mstrmojo-WebButton",text:mstrmojo.desc(2399,"Cancel"),onclick:function(){var M=this.parent.parent;M.close();}}]}]});mstrmojo.ME.DerivedMetricOptions.isNonAFB=I;}());(function(){mstrmojo.requiresCls("mstrmojo.Box","mstrmojo.Label","mstrmojo.Button","mstrmojo.Editor");mstrmojo.requiresDescs(221);var G=mstrmojo.warehouse.EnumDataChangeEvents,D=mstrmojo.css;mstrmojo.warehouse.ui.WaitBoxTip=mstrmojo.declare(mstrmojo.Editor,null,{scriptClass:"mstrmojo.warehouse.ui.WaitBoxTip",cssClass:"mstrmojo-WaitBoxTip",visible:false,draggable:false,showTitle:false,zIndex:9997,displayMsg:null,position:null,cancelCallback:null,extraCls:undefined,width:null,isHostedWithin:false,adjustCorners:null,children:[{scriptClass:"mstrmojo.Box",cssClass:"waitBoxTip-icon",alias:"icon"},{scriptClass:"mstrmojo.Label",cssClass:"waitBoxTip-msg",alias:"msgfield"},{scriptClass:"mstrmojo.Label",cssClass:"waitBoxTip-cancel",alias:"cancelBtn",text:mstrmojo.desc(221,"Cancel")}],postBuildRendering:function E(){var K=this._super();var J=mstrmojo.all.WaitBoxTip;J.closeWait();if(!J.isHostedWithin){var I=J.parentDomNode=document.body;J.domNode&&I.appendChild(J.domNode);}mstrmojo.dom.attachEvent(window,"resize",function(){if(J&&J.adjustCorners){J.adjustCorners();}});return K;},ondisplayMsgChange:function F(){var I=10,J=this.displayMsg.length>I?"":this.displayMsg;this.msgfield.set("text",J);},onwidthChange:function B(){if(this.domNode){this.domNode.firstElementChild.style.width=this.width;}},onpositionChange:function C(){this.set("left",this.position.left);this.set("top",this.position.top);},showWait:function A(I){this.cancelCallback=I.cancelCallback;this.cancelBtn.set("visible",!!(I&&I.showCancel));this.cancelBtn.onclick=function(){if(this.parent.cancelCallback){this.parent.cancelCallback();}this.parent.closeWait();};if(I&&I.position){this.set("position",I.position);}if(I&&I.extraCls){if(this.domNode){D.addClass(this.domNode.firstElementChild,I.extraCls);}else{this.cssClass+=" "+I.extraCls;}}else{if(this.domNode){D.removeClass(this.domNode.firstElementChild,"extraCls-.*?");}}this.set("displayMsg",(I&&I.message)||mstrmojo.desc(11960,"Loading Data..."));this.open();if(I&&I.width){this.set("width",I.width);this.onwidthChange();}return this;},closeWait:function H(){this.close();}});}());(function(){mstrmojo.requiresCls("mstrmojo.Editor","mstrmojo.Label","mstrmojo.Button");mstrmojo.requiresDescs(12726,13016,13588,13589,13590,13591,13611);var B=mstrmojo.array,C=mstrmojo.dom;function A(){var D=[{dda:true,n:mstrmojo.desc(12726,"Connect Live"),desc:mstrmojo.desc(13588,"Access up-to-the-minute data via live queries."),hot:true},{dda:false,n:mstrmojo.desc(13589,"Import as an In-memory Dataset"),desc:mstrmojo.desc(13590,"Upload your data and build an in-memory dataset for rapid analysis."),hot:true}];return D;}mstrmojo.DI.ui.dialogs.DIDirectAccessConfirmDialog=mstrmojo.declare(mstrmojo.Editor,null,{scriptClass:"mstrmojo.DI.ui.dialogs.DIDirectAccessConfirmDialog",callback:null,title:mstrmojo.desc(11922,"Data Access Mode"),cssClass:"mstrmojo-di-dda-confirm",selectedIndex:0,help:"",preBuildRendering:function(){var F=[],D=["mstrmojo-di-button","mstrmojo-WebButton"],E,G;if(this._super){this._super();}E=A();B.forEach(E,function(H){G=new mstrmojo.Button({cssClass:H.hot?D.concat(["hot",H.icon||""]).join(" "):D.concat(H.icon||"").join(" "),text:H.n,useRichTooltip:true,updateTooltipConfig:function(){var J=this,I=C.position(J.domNode);J.richTooltip={cssClass:"vi-regular A-center vi-tooltip-A",content:H.desc,top:Math.max(I.y+40,0),left:Math.max(I.x+I.w/2,0),posType:mstrmojo.tooltip.POS_TOPCENTER};},slot:"containerNode",onclick:function(){if(this.hasOpenTooltip){this.hideTooltip();}this.parent.handleContinue(H);}});F.push(G);});this.addChildren(F);},handleContinue:function(F){var D=mstrApp.getRootController(),H=this.callback,G=D.getDDAController(),E=this;D.model.isDirectDataAccessBeforeSave=D.model.isDirectDataAccess;G.onToggleDDA(F.dda);G.askUserAboutDDA(true);if(!H){D.getPublishController().saveAndPublishNoConfirm();}else{if(H.onOK){H.onOK();}}E.close();},children:[{scriptClass:"mstrmojo.Label",cssClass:"confirm-title",text:mstrmojo.desc(13591,"How would you like to access your data?")}],close:function(){this._super();mstrmojo.array.forEach(this.children,function(D){D.hideTooltip&&D.hideTooltip();},this);this.destroy();}});}());(function(){mstrmojo.requiresCls("mstrmojo.HTMLButton","mstrmojo._HasContextMenu","mstrmojo.ContextMenu");mstrmojo.MenuButton=mstrmojo.declare(mstrmojo.Button,[mstrmojo._HasContextMenu],{preclick:function A(B){this.showContextMenu();},openPopupMenu:function(){this.showContextMenu();}});})();(function(){mstrmojo.requiresCls("mstrmojo.TreeNode","mstrmojo._IsExprNode","mstrmojo.array","mstrmojo.dom","mstrmojo.css","mstrmojo.expr","mstrmojo._HasOwnAvatar");var F=mstrmojo.array,M=mstrmojo.expr,P=mstrmojo.dom,A=mstrmojo.css;function J(R,Q){var U=R.data,S=U&&U.nds;if(!S){return null;}if(Q){Q.sort(F.numSorter);}else{Q=R.sortSelectedIndices();}if(!Q.length){return null;}return{idxs:Q,nds:F.get(S,Q)};}function N(S){var R=S.ctxtBuilder,V=R&&R.itemWidgets,Q=V&&V[0],U=Q&&Q.data;if(U&&U.not&&(V.length>0)){delete U.not;Q.paint();}}mstrmojo.AndOrNode=mstrmojo.declare(mstrmojo.TreeNode,[mstrmojo._IsExprNode,mstrmojo._HasOwnAvatar],{scriptClass:"mstrmojo.AndOrNode",data:null,editable:false,prefixedAndOrEditable:false,markupString:'<div id="{@id}" class="mstrmojo-andor mstrmojo-AndOrNode {@cssClass}"  style="position:relative;{@cssText}" mstrAttach:mousedown><div class="mstrmojo-onhoverparent mstrmojo-andor-prefix" mstrAttach:click><span class="mstrmojo-textset mstrmojo-andor-prefix-text"></span><span class="mstrmojo-onhover-in mstrmojo-andor-tools {@cssClass}">{@_prefixAndOrToolsMarkup}</span></div><div class="mstrmojo-andor-top"></div><div class="mstrmojo-andor-contentsWrapper" style="position:relative"><div class="mstrmojo-andor-contents" style="position:relative;{@itemsContainerCssText}">{@itemsHtml}</div><div class="mstrmojo-ListBase2-dropCue mstrmojo-AndOrNode-dropCue {@cssClass}"><div class="mstrmojo-ListBase2-dropCue-inner mstrmojo-AndOrNode-dropCue-inner"></div></div></div><div class="mstrmojo-andor-bottom"></div></div>',markupSlots:{prefixHoverNode:function(){return this.domNode.firstChild;},prefixNode:function(){return this.domNode.firstChild.firstChild;},prefixAndOrToolsNode:function(){return this.domNode.firstChild.childNodes[1];},itemsContainerPrefix:function(){return this.domNode.childNodes[1];},itemsContainerNode:function(){return this.domNode.childNodes[2].firstChild;},dropCueNode:function(){return this.domNode.childNodes[2].lastChild;},itemsContainerSuffix:function(){return this.domNode.lastChild;},scrollboxNode:function(){return this.domNode;}},markupMethods:{onitemCntChange:function(){A.toggleClass(this.itemsContainerNode,["multi"],this.itemCnt>2);},onprefixedAndOrEditableChange:function(){A.toggleClass(this.prefixNode,["editable"],this.prefixedAndOrEditable);},ondataChange:function(){this.prefixNode.innerHTML=this.andOrTxt();},ondropCuePosChange:mstrmojo.TreeNode.prototype.markupMethods.ondropCuePosChange},multiSelect:true,itemIdField:null,init:function(Q){this._super(Q);this.markupString=this.markupString.replace("{@_prefixAndOrToolsMarkup}",this.getPrefixAndOrToolsMarkup());var R=this.data;if(R){delete this.data;this._set_data(null,R);}},itemCnt:0,postBuildRendering:function(){var Q;this.set("itemCnt",this.items.length);if(this._super){Q=this._super();}N(this);return Q;},preadd:function L(Q){if(this._super){this._super(Q);}this.set("itemCnt",this.items.length);N(this);},preremove:function O(Q){if(this._super){this._super(Q);}this.set("itemCnt",this.items.length);N(this);},_set_data:function(U,Q){var R=this.data,S=(R!==Q);if(S){this.data=Q;if(Q&&!Q.nds){Q.nds=[];}this.set("items",Q&&Q.nds);}return S;},isDragValid:function K(){return true;},isSelectableArea:function(Q){return false;},getDragData:function(Q){var S=this._super(Q);if(S&&!S.html){var R=S.et&&M.ET2TGT[S.et];S.html=R?S[R]&&S[R].n||"":S.n||"";}return S;},remove:function I(R,S){var Q=this._super(R);if(Q>-1){var U=S||this.suppressConsolidation;if(!U){this.consolidate(false);}}return Q;},move:function(R,Q){this.suppressConsolidation=true;var S;if(this._super){S=this._super(R,Q);}this.suppressConsolidation=false;return S;},consolidate:function E(){var V=this.parent;if(!V||!V.remove){return ;}var S=this.items,R=S&&S.length;if(R<2){var U=R?S[0]:null,Q=this.childIndex();if(U){V.add([U],Q);}V.remove(this.data);}},indent:function G(S,Q){var R=J(this,S);if(!R){return ;}this.remove(R.idxs,true);var X=R.nds,W=Q&&Q.fn||this.data&&this.data.fn,V={et:M.ET.ANDOR,nds:X,fn:W};if(X.length===2&&X[0].not){if(X[1].not){delete X[0].not;delete X[1].not;V.not=true;V.fn=(W===M.FN.AND?M.FN.OR:M.FN.AND);}else{var U=X[0];X[0]=X[1];X[1]=U;}}this.add([V],R.idxs[0]);this.consolidate(false);},outdent:function C(R){var S=this.parent,Q=S&&S.data;if(!Q||Q.et!==M.ET.ANDOR){return ;}var U=J(this,R);if(!U){return ;}this.remove(U.idxs,true);if(this.data.not){U.nds[0].not=true;}S.add(U.nds,this.childIndex());this.consolidate(false);},edit:function D(a,b,S){if(!a){return ;}var Z=this.data,Y=Z&&Z.fn,R=a.data,g=R&&R.not;if(!R){R={};a.data=R;}R.not=!!S;if(Y!==b){var Q=Z.nds;if(Q&&Q.length>2){var f=a.childIndex();if(f>0){this.indent([f-1,f],{fn:b});}}else{Z.fn=b;var W=this.ctxtBuilder,V=W&&W.itemWidgets;for(var U=0,X=(V&&V.length)||0;U<X;U++){var e=V[U];if(e){e.paint();}}}}else{a.paint();}},preclick:function H(Q){var S=null,R=P.eventTarget(Q.hWin,Q.e);if(R===this.prefixNode){}else{if(P.contains(this.prefixNode,R,true)){S="andor";}}Q.part=S;},createAvatar:function B(S){var R=document.createElement("div"),U=P.findWidget(S),Q=U.getAvatarNode&&U.getAvatarNode();if(!Q){Q=U.condNode.cloneNode(true);Q.style.boxSizing="border-box";Q.style.width=U.condNode.offsetWidth+"px";}R.appendChild(Q);A.addClass(R,U.avatarCssCls||"mstrmojo-FE mstrmojo-ConditionNode");R.style.zIndex=20;return R;},_ndsToMove:J});})();(function(){mstrmojo.requiresCls("mstrmojo.WidgetList","mstrmojo.WidgetTreeBuilder","mstrmojo.TreeNodeSelector");var E=false;mstrmojo.WidgetTree=mstrmojo.declare(mstrmojo.WidgetList,null,{scriptClass:"mstrmojo.WidgetTree",listBuilder:mstrmojo.WidgetTreeBuilder,listSelector:mstrmojo.TreeNodeSelector,renderOnScroll:true,itemIdField:"dssid",itemDisplayField:"n",itemIconField:"tp",itemChildrenField:"items",itemFunction:function D(L,I,J){if(!E){mstrmojo.requiresCls("mstrmojo.TreeNode");E=true;}var H=J.tree||J,K=new mstrmojo.TreeNode({data:L,state:0,parent:J,tree:H,multiSelect:J.multiSelect,text:L[J.itemDisplayField],textCssClass:H.item2textCss(L),items:L[J.itemChildrenField],itemIdField:J.itemIdField,itemDisplayField:J.itemDisplayField,itemIconField:J.itemIconField,itemChildrenField:J.itemChildrenField,itemFunction:J.itemFunction,listSelector:J.listSelector});return K;},item2textCss:function B(H){return H[this.itemIconField];},selectionParentNode:null,init:function F(H){this._super(H);this.selectionParentNode=this;this.tree=this;},clearTreeSelect:function A(){(this.selectionParentNode||this).clearSelect();},prechange:function G(H){var I=this._super(H);this.onnodechange(H);return I;},onnodechange:function C(I){if(!I){return ;}var J=mstrmojo.hash,M=this.selectionParentNode,L=I.src;if(L===M){if(J.isEmpty(L.selectedIndices)){L=this;this.selectionParentNode=this;}this.raiseEvent({name:"selectionChange",parentNode:L,parentNodeWas:M,added:I.added,removed:I.removed});}else{if(I.added&&I.added.length){var K=[];if(!J.isEmpty(M.selectedIndices)){K=mstrmojo.hash.keyarray(M.selectedIndices,true);M.clearSelect();}this.selectionParentNode=L;this.raiseEvent({name:"selectionChange",parentNode:L,parentNodeWas:M,added:I.added,removed:K});}else{}}}});})();(function(){mstrmojo.requiresCls("mstrmojo.dom","mstrmojo.css","mstrmojo.hash","mstrmojo.fx","mstrmojo.TreeNode");var K=mstrmojo.dom,E={0:"closed",1:"opened",2:"leaf"},I=function(R,Q){var N=R.style,M,P,L,S,O;N.display="block";N.height="auto";M=R.offsetHeight;P=Q?M:0;L=Q?0:M;S=Q?"block":"none";N.overflow="hidden";O=new mstrmojo.fx.AnimateProp({target:R,props:{height:{start:L,stop:P,suffix:"px",fn:Math.round,ease:mstrmojo.ease.linear}},onEnd:function(){N.height="auto";N.display=S;},interval:30,duration:300});O.play();};mstrmojo.TreeBrowserNode=mstrmojo.declare(mstrmojo.TreeNode,null,{scriptClass:"mstrmojo.TreeBrowserNode",markupString:'<div id="{@id}" class="mstrmojo-TreeNode {@cssClass}" style="{@cssText}" mstrAttach:mousedown,mouseup,click,dblclick><div class="mstrmojo-TreeNode-div"><img class="mstrmojo-TreeNode-state" src="../images/1ptrans.gif" /><img class="mstrmojo-TreeNode-checkBox" src="../images/1ptrans.gif" /><span class="mstrmojo-TreeNode-text {@textCssClass}"></span></div><div class="mstrmojo-TreeNode-itemsContainer">{@itemsHtml}</div></div>',markupSlots:mstrmojo.hash.copy({displayNode:function(){return this.domNode.firstChild;},checkBoxNode:function(){return this.domNode.firstChild.childNodes[1];}},mstrmojo.TreeNode.prototype.markupSlots),markupMethods:mstrmojo.hash.copy({onstateChange:function(L){this.stateNode.className="mstrmojo-TreeNode-state "+(E[this.state]||"closed");if(this.tree.anim&&this.contentRetrieved&&!L){I(this.itemsContainerNode,this.state===1);}else{this.itemsContainerNode.style.display=(this.state===1)?"block":"none";}}},mstrmojo.TreeNode.prototype.markupMethods),blockBegin:1,allowUnlistedValues:false,contentRetrieved:false,_set_items:function(N,M){var L=this._super(N,M);if(L&&this.tree.anim){I(this.itemsContainerNode,true);}return L;},onstateChange:function J(){var L=this.tree;if(!this.contentRetrieved&&(this.state==1)){this.set("items",[L.loadingItemCreaterFunc()]);L.getContent(this,this.blockBegin);}else{if((this.state==1)&&L.onNodeExpand){L.onNodeExpand(this);}if((this.state==0)&&L.onNodeCollapse){L.onNodeCollapse(this);}}},toggleState:function G(){if(this.state!==2){this.set("state",this.state===1?0:1);}},preclick:function H(L){K.clearBrowserHighlights(L.hWin);return false;},predblclick:function D(L){K.clearBrowserHighlights(L.hWin);return false;},premousedown:function B(M){var R=mstrmojo.dom,O=mstrmojo.dom.eventTarget(M.hWin,M.e),L=this.tree,N=(this.state==2),Q=R.contains(this.itemsContainerNode,R.eventTarget(M.hWin,M.e),true,this.domNode),P=(L.branchClickPolicy==mstrmojo.TreeBrowserEnum.BRANCH_POLICY_TOGGLE);if((this.isSpecialNode()||!(O==this.checkBoxNode||((O==this.textNode||O==this.displayNode)&&(N||!P))))&&!this.draggable){R.stopPropogation(M.hWin,M.e);}if((O==this.stateNode)||((O==this.textNode||O==this.displayNode)&&!N&&P)){if(!N){this.toggleState();}}else{if(O==this.checkBoxNode||Q){if(this._super){this._super(M);}}else{this.handleNodeClicked();}}},isSpecialNode:function C(){var L=this.data&&this.data.st;return(L<0);},handleNodeClicked:function F(){var L=this.tree,M=this.parent,N=this.data;switch(N&&N.st){case"-4":mstrmojo.css.addClass(this.textNode,["loading"]);L.getContent(M,M.blockBegin-L.blockCount);break;case"-3":mstrmojo.css.addClass(this.textNode,["loading"]);L.getContent(M,M.blockBegin+L.blockCount);break;case"-1":case"-2":break;default:if(L.handleNodeClicked){L.handleNodeClicked(N);}}},init:function(L){this._super(L);this.set("state",this.tree.isBranch(this.data)?0:2);},postBuildRendering:function A(){if(this._super){this._super();}var L=function(M){K.preventDefault(window,M||window.event);return false;};K.attachEvent(this.domNode,"mousedown",L);if(this.isSpecialNode()||this.tree.noCheckBox){this.checkBoxNode.style.display="none";}}});})();(function(){mstrmojo.requiresCls("mstrmojo._InputList","mstrmojo._InputListHoriz");mstrmojo.RadioList=mstrmojo.declare(mstrmojo._InputList,null,{scriptClass:"mstrmojo.RadioList",inputType:"radio",cssClass:"mstrmojo-RadioList",itemCssClass:"mstrmojo-RadioList-item",onenabledChange:function A(B){for(var C=0;C<this.items.length;C++){this._getItemNode(C).firstChild.disabled=!B.value;}}});mstrmojo.RadioListHoriz=mstrmojo.declare(mstrmojo._InputListHoriz,null,{scriptClass:"mstrmojo.RadioListHoriz",inputType:"radio",cssClass:"mstrmojo-RadioListHoriz",itemCssClass:"mstrmojo-RadioListHoriz-item"});})();(function(){mstrmojo.requiresCls("mstrmojo._InputList","mstrmojo._InputListHoriz","mstrmojo.hash");mstrmojo.CheckList=mstrmojo.declare(mstrmojo._InputList,null,{scriptClass:"mstrmojo.CheckList",inputType:"checkbox",cssClass:"mstrmojo-CheckList",itemCssClass:"mstrmojo-CheckList-item"});mstrmojo.requiresCls("mstrmojo._InputListHoriz");mstrmojo.CheckListHoriz=mstrmojo.declare(mstrmojo._InputListHoriz,null,{scriptClass:"mstrmojo.CheckListHoriz",inputType:"checkbox",cssClass:"mstrmojo-CheckListHoriz",itemCssClass:"mstrmojo-CheckListHoriz-item"});})();(function(){mstrmojo.requiresCls("mstrmojo.ui.HierarchyCheckList","mstrmojo.ui._HierarchyListSelection","mstrmojo.EnumSelectionType","mstrmojo.hash","mstrmojo.array","mstrmojo.css");var L=mstrmojo.hash,S=mstrmojo.css,H=mstrmojo.array,A=mstrmojo.EnumSelectionType;var R="dynamic",K="hasSelectedDsct";var W=7;function G(a,X,Z){var b=[],Y={};H.forEach(a,function(d){var c=d.v;if(c>=Z){b.push(d);if(X.isLevelSelected(c)){Y[b.length-1]=true;}}});return{items:b,selectedIndices:Y};}mstrmojo.vi.ui.HierarchyCheckList=mstrmojo.declare(mstrmojo.ui.HierarchyCheckList,[mstrmojo.ui._HierarchyListSelection],{scriptClass:"mstrmojo.vi.ui.HierarchyCheckList",getItemMarkup:function D(Y,X){return'<{@tag} class="item {@cls}" idx="{@idx}" style="{@style}" title="{@tt}"><div class="right"><span class="refresh" title="{@refreshTitle}"></span><span class="branch" title="{@branchTitle}"></span><span class="level" title="{@levelTitle}"></span></div><div class="content"><span class="indent" style="padding-left: {@indent}px;"></span><span class="triangle"></span><span class="checkbox"></span><span class="text">{@en@n}</span></div></{@tag}>';},getItemProps:function U(Z,X){var Y=this._super(Z,X);if(Z.isBranchSelected){Y.addCls(R);}if(Z.hasDsctSelected){Y.addCls(K);}L.copy({refreshTitle:mstrmojo.desc(15251,"Dynamic"),branchTitle:Z.isSelected?mstrmojo.desc(15921,"Single Deselect"):mstrmojo.desc(15920,"Single Select"),levelTitle:mstrmojo.desc(15919,"Level Select"),},Y);return Y;},onclick:function V(X){var Z=X.getTarget(),a=this.getItemNodeFromTarget(Z),Y=this.getItemFromTarget(Z);if(Y){if(S.hasClass(Z,"triangle")){if(Y.hcd){this.doExpandCollapse(a,Y);}}else{if(S.hasClass(Z,"branch")){this.doElementSelect(a,Y,!Y.isSelected);}else{if(S.hasClass(Z,"level")){this.openLevelPopup(a,Y,Z);}else{if(!S.hasClass(Z,"indent")&&!S.hasClass(Z,"refresh")){this.doBranchSelect(a,Y,!Y.isSelected);}}}}X.cancel();}},onSelectionChange:function I(Y,X,Z,a){if(Y===A.ALL&&X){this.clearSelections();(this.raad?this.getInitialDisplayRoots():this.getRootItems()).forEach(function(b){if(b.v){this.selectionList.push({func:A.BRANCH,itemValue:b.v,isNot:false});}},this);if(this.postSelectionChange){this.postSelectionChange();}}else{this._super(Y,X,Z,a);}},updateItemNodesStatus:function M(){var X=this.itemsContainerNode&&this.itemsContainerNode.childNodes;this._super();H.forEach(X,function(a){var Z=this.getItemFromTarget(a),Y=a.getElementsByClassName("branch")[0];if(Z){S.toggleClass(a,R,Z.isBranchSelected);S.toggleClass(a,K,Z.hasDsctSelected);if(Y){Y.title=Z.isSelected?mstrmojo.desc(15921,"Single Deselect"):mstrmojo.desc(15920,"Single Select");}}},this);},getSummaryText:function J(){return"";},getLevels:function E(){return[];},getLevelItems:function B(Y){var a=this.getLevels(),b=Y?[{v:-1,n:mstrmojo.desc(15824,"All Levels")}]:[];if(a.length>0){return b.concat(a);}var X=this.getMaxLevel();for(var Z=0;Z<=X;Z++){b.push({v:Z,n:mstrmojo.desc(493,"Level")+" "+(Z+1)});}return b;},postBuildRendering:function Q(){var Z=this.levelPopup,Y=this.domNode;if(!Z){var X=this.getLevelPopupConfig(),a=L.walk(X.scriptClass,window);delete X.scriptClass;Z=this.levelPopup=new a(X);this.addDisposable(Z);}Z.placeholder=Y.insertBefore(document.createElement("div"),Y.firstChild);Z.render();return this._super();},unrender:function P(X){var Y=this.levelPopup;if(Y){Y.unrender(X);}return this._super(X);},onScrollEnd:function C(){var Y=this.levelPopup,X=Y&&Y.getPopupWidget();if(X&&X.visible){Y.closePopup();}this.hideTooltip();},openLevelPopup:function O(b,Z,Y){var a=this.levelPopup,X=a.getPopupWidget();if(a&&Z.hcd&&this.isHiearachyDisplay()){a.openPopup(X,{branch:Z,branchNode:b});if(Y){X.domNode.style.left=Y.offsetLeft+"px";X.domNode.style.top=Y.offsetTop+Y.offsetHeight-this.scrollNode.scrollTop+"px";}}},getLevelPopupConfig:function N(Z){return L.copy(Z,{scriptClass:"mstrmojo.ui.PopupButton",markupString:'<div id="{@id}" class="level-popup-btn" title="{@title}" mstrAttach:click></div>',title:mstrmojo.desc(15919,"Level Select"),isHostedWithin:false,parent:this,widget:this,children:{scriptClass:"mstrmojo.ui.PopupWidget",alias:"levelPopup",visible:false,children:[{scriptClass:"mstrmojo.ui.CheckList",alias:"checklist",doItemSelect:function b(j,g){var f=this.parent,k=f.opener.widget,h=!this.selectedIndices[j._renderIdx];if(f.branch&&f.branchNode){k.doBranchLevelSelect(f.branchNode,f.branch,j.v,h);}else{k.doLevelSelect(j.v,h);}mstrmojo._IsList.doItemSelect.call(this,j,g);},onclick:function Y(f){if(!S.hasClass(f.getTarget(),"refresh")){mstrmojo._IsList.onclick.call(this,f);}},getItemMarkup:function d(f){return mstrmojo.ui.CheckList.prototype.getItemMarkup.call(this,f).replace('<span class="text">{@en@n}</span>','<span class="refresh"></span><span class="text">{@en@n}</span>');}}],onOpen:function X(){var h=this.opener.widget,f=this.branch,g=G(h.getLevelItems(),h.getLevelSelection(f),f&&f.lv+1||0);this.checklist.set("items",g.items);this.checklist.set("selectedIndices",g.selectedIndices);}},getPopupWidget:function c(){return this.levelPopup;},onPopupWidgetOpened:function a(){S.addClass(this.levelPopup.branchNode,"level-popup-open");},onPopupWidgetClosed:function e(){S.removeClass(this.levelPopup.branchNode,"level-popup-open");}});},getAllButtonConfig:function F(Y,X){return L.copy(X,Y?{scriptClass:"mstrmojo.Button",text:mstrmojo.desc(3474,"Select All"),alias:"selectAllBtn",cssClass:"selectAll",widget:this,onclick:function(){this.widget.doAllSelect(true);}}:{scriptClass:"mstrmojo.Button",text:mstrmojo.desc(1763,"Clear All"),alias:"clearAllBtn",cssClass:"clearAll",widget:this,onclick:function(){this.widget.doAllSelect(false);}});}});}());(function(){mstrmojo.requiresCls("mstrmojo.ui.editors.controls.PreviewButton","mstrmojo.ui.PopupList","mstrmojo.array","mstrmojo.css");var F=mstrmojo.css,E=mstrmojo.array;mstrmojo.ui.editors.controls.ListPreviewButton=mstrmojo.declare(mstrmojo.ui.editors.controls.PreviewButton,null,{scriptClass:"mstrmojo.ui.editors.controls.ListPreviewButton",init:function G(L){this._super(L);var M=this.getListCfg(),K=this.itemValueField;M.alias="list";M.locksHover=true;M.slot="widgetHostNode";M.listHooks={select:function J(N,O){this.parent.set("selectedValue",O[K]);this.close();}};M.setDimensions=mstrmojo.emptyFn;this.addChildren([M]);F.addWidgetCssClass(this.list,"ctrl-popup-list");},getPopupWidget:function D(){return this.list;},items:null,onitemsChange:function H(){var J=this.items;if(J){this.list.set("items",J);}},selectedValue:"",itemValueField:"n",onselectedValueChange:function C(){var K=this.selectedValue,J=this.itemValueField,L=this.list;L.selectItems(E.filter(L.items||[],function(M){return M[J]===K;}),true);this.updatePreview();},updatePreview:function B(){throw new Error(this.scriptClass+" must implement updatePreview.");},getListCfg:function I(){return{scriptClass:"mstrmojo.ui.PopupList",selectionPolicy:"reselect"};},postBuildRendering:function A(){this.onitemsChange();this.onselectedValueChange();return this._super();}});}());(function(){mstrmojo.requiresCls("mstrmojo.ui.PopupButton","mstrmojo._HasTooltip","mstrmojo.ui._IsPulldown","mstrmojo.ui.PopupList","mstrmojo.hash","mstrmojo.dom","mstrmojo.string","mstrmojo.css","mstrmojo.array","mstrmojo._CanAutoClose");var U=mstrmojo.css,L=mstrmojo.array,F=mstrmojo.dom,B=mstrmojo.string;function H(W){this.set("richTooltip",{cssClass:"vi-regular vi-tooltip-C",content:B.encodeHtmlString(W)});}mstrmojo.ui.Pulldown=mstrmojo.declare(mstrmojo.ui.PopupButton,[mstrmojo.ui._IsPulldown,mstrmojo._HasTooltip],{scriptClass:"mstrmojo.ui.Pulldown",onitemSelected:mstrmojo.emptyFn,onSelectedItemChange:mstrmojo.emptyFn,useRichTooltip:true,allowHTML:false,useDarkTheme:false,init:function P(W){this._super(W);U.addWidgetCssClass(this.getPopupList(),"ctrl-popup-list");},initChildren:function C(){this.children=this.getPopupListConfig();this._super();},postBuildRendering:function Q(){if(this._super){this._super();}var W=this.getSelectedItem();if(W){H.call(this,W.n);}},showTooltip:function D(a,Z){var X=this.selectedNode,Y=this.richTooltip;if(X.offsetWidth>=X.scrollWidth){return ;}if(!Y.top){var W=F.position(this.selectedNode);Y.top=W.y-3;Y.left=W.x+W.w+6;}if(this._super){this._super(a,Z);}},getSelectedItem:function M(){var W=this.items;return W&&W[this.selectedIndex];},selectItemByField:function A(X,W){this.set("selectedIndex",L.find(this.items||[],X,W));},getPopupWidget:function E(){return this.list;},getPopupList:function J(){return this.list;},_set_items:function I(Z,W){var Y=this.items;this.items=W;delete this.selectedIndex;if(Y!==W){var X=this.hasRendered;if(X){this.refresh();}return true;}return false;},onclick:function V(W){this._super(W);var Y=this,X=Y.getPopupWidget();Y.mw=Y.mw||function(Z){if(!F.contains(X.domNode,F.eventTarget(self,Z),true,document.body)){X.close();F.detachEvent(document,F.isFF?"DOMMouseScroll":"mousewheel",Y.mw);}};F.attachEvent(document,F.isFF?"DOMMouseScroll":"mousewheel",Y.mw);if(Y.focusOnPopup){X.domNode.focus();}},_set_selectedIndex:function N(d,a,Y){if((a!==0&&!a)||a<0){return false;}var X=this.selectedIndex=a,W=this.getPopupList(),Z=W&&W.items,c=Z&&Z[X],b=this.selectedNode;if(c&&c.dsbld){return false;}if(W){mstrmojo._ListSelections._set_selectedIndex.call(W,"selectedIndex",X,Y);}if(b&&Z&&Z[X]){b.innerHTML=this.getPulldownTextInnerHTML(Z[X]);b.title=Z[X].title||"";}if(Z&&Z[X]){if(this.focusOnPopup&&W&&!W.closeAfterSelection){W.itemsContainerNode.children[X].style.color="";}else{this.onitemSelected(Z[X],X);}}return true;},getPulldownTextInnerHTML:function G(W){return this.allowHTML?W.n:B.encodeHtmlString(W.n,true);},postselectedIndexChange:function O(W){var a=W.value,Y=W.valueWas;if(a!==Y){var X=this.items,Z=X[a];if(Z){H.call(this,Z.n);}this.onSelectedItemChange(Z,X[Y]);}},getPopupConfig:function K(){var W=this._super();W.useDarkTheme=this.useDarkTheme;return W;},getPopupListConfig:function S(){return{scriptClass:"mstrmojo.ui.PopupList",alias:"list",selectionPolicy:"reselect",locksHover:true,useRichTooltip:true,showTooltipForLargeText:true,scrollNodeMaxHeight:this.scrollNodeMaxHeight,listHooks:{select:function W(a,b,Z){this.parent.set("selectedIndex",Z);if(this.visible&&this.closeAfterSelection&&!this.selectedItem.dsbld){this.close();}}},getItemProps:function X(b,Z){var a=mstrmojo._IsList.getItemProps.call(this,b,Z);a.style=this.parent.itemCssText||"";return a;},suppressClose:function Y(Z){return mstrmojo._CanAutoClose.suppressClose.call(this,Z)||F.contains(this.parent.domNode,Z,true,document.body);}};},children:[]});mstrmojo.ui.Pulldown.newPulldown=function R(X,b,W,a,Z){a=a||{};a.items=X;var Y;if(Z===true){Y=mstrmojo.hash.copy({scriptClass:"mstrmojo.ui.Pulldown",selectedIndex:W||0},a);}else{Y=new mstrmojo.ui.Pulldown(a);if(W!==undefined){Y.set("selectedIndex",W);}}Y.onSelectedItemChange=b||mstrmojo.emptyFn;return Y;};}());(function(){mstrmojo.requiresClsP("mstrmojo","Editor","HBox","Button","Label","TextBox","hash","dom","css","array","desc");mstrmojo.requiresCls("mstrmojo.warehouse.EnumDatabaseType","mstrmojo.ui.Checkbox","mstrmojo.ui.Pulldown","mstrmojo.ui.CheckList");mstrmojo.requiresDescs(959,2056,15656,15657,15658,15659,15660,15661,2397,2399);var M=mstrmojo.warehouse.EnumDatabaseType,D=mstrmojo.hash,J=mstrmojo.array,I=mstrmojo.dom,L=mstrmojo.css,F=mstrmojo.desc;var Q=[{v:"",n:F(959,"Default")},{v:"General Number",},{v:"Standard"},{v:"Currency"},{v:"Percent"},{v:"Scientific"},{v:"General Date"},{v:"Long Date"},{v:"Short Date"},{n:F(2056,"Custom")}];Q.forEach(function(R){if(R.n===undefined){R.n=R.v;}});var G={};G[M.MSAS]={min:0,max:65535,maxlength:5};G[M.EssBase]={min:0,max:126,maxlength:3};function O(U,W){var S=null,V=G[W],R=/^-?\d+$/;if(R.test(U)){U=parseInt(U);if(V&&U>=V.min&&U<=V.max||!V){S=U;}}return S;}function C(R){var S=/(\"|\-\-|\/\/|\/\*|\*\/)/;return R&&R.length&&!S.test(R);}var K={mptf:{mptso:{pru:1,v:500},mptsim:{pru:1,v:0},mptfms:""},dbt:M.MSAS,so_dft:0,sim_dft:0};function P(){return D.clone(K);}function B(R){switch(R){case"so":return this.config.mptf.mptso;case"si":return this.config.mptf.mptsim;case"fs":return this.config.mptf.mptfms;case"dbt":return this.config.dbt;case"soDefault":return this.config.so_dft;case"siDefault":return this.config.sim_dft;}}function N(){return{mptso:{pru:this.soBox.soDefaultCb.checked?1:0,v:parseInt(this.soBox.soTB.value)},mptsim:{pru:this.siBox.siDefaultCbBox.siDefaultCb.checked?1:0,v:this.siBox.siClBox.siCl.selectedIndex},mptfms:this.fsBox.fsTbBox.fsTb.value};}mstrmojo.PassThroughOptions=mstrmojo.declare(mstrmojo.Editor,null,{scriptClass:"mstrmojo.PassThroughOptions",cssClass:"mstrmojo-PassThroughOptions",title:F(15656,"Pass-through Options"),updatePopupConfig:function H(R,U){if(R){this.onOK=R.onOK;delete R.onOK;}["left","top","width","height","zIndex"].forEach(function(V){if(R[V]!==undefined){this.set(V,R[V]);delete R[V];}}.bind(this));var S=P();D.forEach(R,function(W,V){if(W===undefined){delete R[V];}});this.config=D.copy(R,S);},onOpen:function E(){this.soBox.set("dirty",false);this.soBox.set("valid",true);this.siBox.set("dirty",false);this.fsBox.set("dirty",false);this.fsBox.set("valid",true);var U=B.call(this,"dbt")===M.EssBase,W=B.call(this,"so");L.toggleClass(this.editorNode,"ess",U);this.soBox.soDefaultCb.set("checked",W.pru);if(!W.pru){this.soBox.soTB.set("value",W.v);}else{this.soBox.soTB.set("value",B.call(this,"soDefault"));}if(!U){var S=B.call(this,"si"),R=B.call(this,"fs"),V;this.siBox.siDefaultCbBox.siDefaultCb.set("checked",S.pru);if(!S.pru){this.siBox.siClBox.siCl.select(S.v);}else{this.siBox.siClBox.siCl.select(B.call(this,"siDefault"));}V=J.find(Q,"v",R);if(V<0){V=J.find(Q,"v",undefined);}this.fsBox.fsPdBox.fsPd.set("selectedIndex",V);this.fsBox.fsTbBox.fsTb.set("value",R);}},children:[{scriptClass:"mstrmojo.Box",alias:"soBox",cssClass:"mstrmojo-PassThroughOptions-soBox",processDirty:function A(){var Y=this.parent,V=B.call(Y,"so"),X=V.pru,R=V.v,U=this.soDefaultCb.checked,S=this.soTB.value,W=X!=U||(!U&&R!=S);this.set("dirty",W);},children:[{scriptClass:"mstrmojo.Label",cssDisplay:"inline-block",text:F(15657,"Solve Order:")},{scriptClass:"mstrmojo.TextBox",alias:"soTB",cssClass:"mstrmojo-PassThroughOptions-soTB",cssDisplay:"inline-block",useRichTooltip:true,enabled:false,updateTooltipConfig:function(){var W=this.parent.parent,U=this.domNode,R=I.position(U),V=B.call(W,"dbt"),S=F(15658,"The value has to be between # and ##.").replace("#",G[V].min).replace("##",G[V].max);this.richTooltip={cssClass:"vi-regular vi-tooltip-V",posType:mstrmojo.tooltip.POS_BOTTOMLEFT,content:S,top:R.y,left:R.x};},onvalueChange:function(){var V=this.parent.parent,U=B.call(V,"dbt"),S=O(this.value,U),R=(S!=null);this.set("textValid",R);if(!R){this.showTooltip();}else{this.hideTooltip();}this.parent.set("valid",R);this.parent.processDirty();}},{scriptClass:"mstrmojo.Label",cssDisplay:"inline-block",cssClass:"right",text:F(959,"Default")},{scriptClass:"mstrmojo.ui.Checkbox",alias:"soDefaultCb",cssDisplay:"inline-block",cssClass:"right",checked:true,oncheckedChange:function(R){var V=this.parent.parent,S=this.parent.soTB,U=this.checked;S.set("enabled",!U);if(U){S.set("value",B.call(V,"soDefault"));}this.parent.processDirty();}}]},{scriptClass:"mstrmojo.Box",alias:"siBox",cssClass:"mstrmojo-PassThroughOptions-siBox",processDirty:function A(){var Y=this.parent,X=B.call(Y,"si"),W=X.pru,R=X.v,U=this.siDefaultCbBox.siDefaultCb.checked,S=this.siClBox.siCl.selectedIndex,V=W!=U||(!U&&R!=S);this.set("dirty",V);},children:[{scriptClass:"mstrmojo.HBox",alias:"siDefaultCbBox",cssClass:"mstrmojo-PassThroughOptions-siDefaultCbBox",children:[{scriptClass:"mstrmojo.Label",text:F(15659,"Scope Isolation:")},{scriptClass:"mstrmojo.ui.Checkbox",alias:"siDefaultCb",checked:true,oncheckedChange:function(R){var S=this.parent.parent,V=S.parent,U=S.siClBox.siCl;U.set("enabled",!this.checked);if(this.checked){U.select(B.call(V,"siDefault"));}S.processDirty();}},{scriptClass:"mstrmojo.Label",text:F(959,"Default")}]},{scriptClass:"mstrmojo.HBox",alias:"siClBox",cssClass:"mstrmojo-PassThroughOptions-siClBox",children:[{scriptClass:"mstrmojo.ui.CheckList",alias:"siCl",multiSelect:false,orientation:"h",selectedIndex:1,items:[{n:"NONE",v:0},{n:"CUBE",v:1}],onchange:function(R){this.parent.parent.processDirty();}}]}]},{scriptClass:"mstrmojo.Box",alias:"fsBox",cssClass:"mstrmojo-PassThroughOptions-fsBox",children:[{scriptClass:"mstrmojo.HBox",alias:"fsPdBox",cssClass:"mstrmojo-PassThroughOptions-fsPdBox",children:[{scriptClass:"mstrmojo.Label",text:F(15660,"Format String:")},{scriptClass:"mstrmojo.ui.Pulldown",alias:"fsPd",selectedIndex:0,items:Q,onselectedIndexChange:function(){var S=this.getSelectedItem(),R=S&&S.v===undefined,U=this.parent.parent.fsTbBox.fsTb;U.set("visible",R);if(R){U.set("value","");}else{U.set("value",S&&S.v);}}}]},{scriptClass:"mstrmojo.HBox",alias:"fsTbBox",cssClass:"mstrmojo-PassThroughOptions-fsTbBox",children:[{scriptClass:"mstrmojo.TextBox",alias:"fsTb",updateTooltipConfig:function(){var U=this.domNode,R=I.position(U),S=F(15661,'Custom Format String should not be empty or contain ", //, --, /*, */.');this.richTooltip={cssClass:"vi-regular vi-tooltip-V",posType:mstrmojo.tooltip.POS_BOTTOMLEFT,content:S,top:R.y,left:R.x};},onvalueChange:function(){var R=this.parent.parent;R.processDirty();},bindings:{textValid:function(){var R=this.parent.parent.fsPdBox.fsPd.selectedIndex,U=this.parent.parent,W=U.fsPdBox.fsPd.getSelectedItem(),S=W&&W.v===undefined,V=!S||C(this.value);U.set("valid",V);if(!V){this.showTooltip();}else{this.hideTooltip();}return V;}}}]}],processDirty:function(){var S=this.fsTbBox.fsTb.value,R=B.call(this.parent,"fs");this.set("dirty",S!==R);}},{scriptClass:"mstrmojo.HBox",alias:"buttonBar",slot:"buttonNode",cssClass:"mstrmojo-Editor-buttonBar",cellCssClass:"subBox",children:[{scriptClass:"mstrmojo.Button",cssClass:"mstrmojo-Editor-button mstrmojo-WebButton hot",alias:"saveokButton",text:F(2397,"OK"),bindings:{enabled:function(){var U=this.parent.parent.soBox.dirty,S=this.parent.parent.siBox.dirty,W=this.parent.parent.fsBox.dirty,V=this.parent.parent.soBox.valid,R=this.parent.parent.fsBox.valid;return(U||S||W)&&(V&&R);}},onclick:function(){if(this.enabled){var R=this.parent.parent;if(R.onOK){R.onOK(N.call(R));}R.close();}}},{scriptClass:"mstrmojo.Button",cssClass:"mstrmojo-Editor-button mstrmojo-WebButton",text:F(2399,"Cancel"),onclick:function(){var R=this.parent.parent;R.close();}}]}]});}());(function(){mstrmojo.requiresCls("mstrmojo.Label","mstrmojo.array","mstrmojo.Editor","mstrmojo.ListBase","mstrmojo._IsList","mstrmojo.Button","mstrmojo.Label","mstrmojo.DynamicClassFactory","mstrmojo.ui.Pulldown");var E=mstrmojo.array,D=mstrmojo.DynamicClassFactory.newComponent;mstrmojo.architect.ui.SimpleList=D(mstrmojo.ListBase,[mstrmojo._IsList],{scriptClass:"mstrmojo.architect.ui.SimpleList"});function C(){var F=this.secondaryList,G=this.primaryDBRole;this.close();this.onSubmit({did:this.dataSources.did,primaryId:G.id,primaryName:G.n,secondary:F.getSelectedItems()});}mstrmojo.architect.ui.editors.DataSourceEditor=mstrmojo.declare(mstrmojo.Editor,null,{scriptClass:"mstrmojo.architect.ui.editors.DataSourceEditor",cssClass:"mstrmojo-ar-DataSourceEditor",title:mstrmojo.desc(4381,"Data Sources"),help:null,primaryPulldown:undefined,secondaryList:undefined,onSubmit:mstrmojo.emptyFn,onOpen:function A(){var F=this.dataSources.dbRoles;this.primaryPulldown.set("items",F);this.primaryPulldown.set("selectedIndex",E.find(F,"id",this.dataSources.primaryId));},children:[{scriptClass:"mstrmojo.Label",text:mstrmojo.desc(11387,"Primary Data Source")+":"},{scriptClass:"mstrmojo.ui.Pulldown",alias:"primaryPulldown",onitemSelected:function B(L,I){var H=this.items.concat(),K=this.parent,G=K.secondaryList;H.splice(I,1);G.clearSelect(true);G.set("visible",H.length!==0);G.set("items",H);var J={};E.forEach(H,function F(N,M){J[M]=true;});G.set("selectedIndices",J);K.primaryDBRole=L;}},{scriptClass:"mstrmojo.Label",text:mstrmojo.desc(11389,"Secondary Data Source(s):")},{scriptClass:"mstrmojo.architect.ui.SimpleList",cssClass:"mstrmojo-ar-SecondaryDBRoles",multiSelect:true,selectionPolicty:"reselect",alias:"secondaryList"},{scriptClass:"mstrmojo.Button",text:mstrmojo.desc(1442,"OK"),slot:"buttonNode",onclick:function(){C.call(this.parent);}}]});}());(function(){mstrmojo.requiresCls("mstrmojo.Box","mstrmojo.ui.Pulldown");var F=mstrmojo.array;mstrmojo.warehouse.dbroles.DBRoleSettingPulldown=mstrmojo.declare(mstrmojo.Box,null,{scriptClass:"mstrmojo.warehouse.dbroles.DBRoleSettingPulldown",cssClass:"mstrmojo-wh-DBRolePulldown",postBuildRendering:function A(){if(this._super){this._super();}this.captionlbl.set("text",this.caption);this.list.set("itemIdField",this.itemIdField);this.list.set("itemField",this.itemField);this.onenabledChange();if(typeof this.allowHTML==="boolean"){this.list.set("allowHTML",this.allowHTML);}},caption:"",contains:function C(M){var L=mstrmojo.array.find(this.items,this.itemIdField,M);return(L>0);},itemIdField:"",itemField:"n",items:null,onitemsChange:function K(){this.list.set("items",this.items);},selectedID:null,onselectedIDChange:function E(){var L=Math.max(F.find(this.items,this.itemIdField,this.selectedID),0);if(this.items&&this.items[L]){this.list.set("selectedIndex",L);this.selectedItem=this.items[L];this.selectedID=this.selectedItem.id;}},selectedItem:undefined,enabled:true,onenabledChange:function G(){this.captionlbl.set("enabled",this.enabled);this.list.set("enabled",this.enabled);},getValue:function D(){var L=this.selectedItem||this.items[0];if(L){return L.v;}return"";},setValue:function B(L){this.set("selectedID",L);},isValid:function J(){return{val:true,msg:""};},onChange:mstrmojo.emptyFn,captionlbl:undefined,children:[{scriptClass:"mstrmojo.Label",cssClass:"mstrmojo-wh-DBRoleSetting-Label",alias:"captionlbl"},{scriptClass:"mstrmojo.ui.Pulldown",alias:"list",scrollNodeMaxHeight:350,isHostedWithin:false,onitemSelected:function H(O,M){var N=this.parent,L=(N.selectedItem?N.selectedItem.id:"");if(O[this.itemIdField]!==L){N.set("selectedItem",O);if(N.onChange){N.onChange(O,M);}}},onitemsChange:function I(){var L=this.parent;L.selectedID=null;}}]});}());(function(){mstrmojo.requiresCls("mstrmojo.array","mstrmojo.css","mstrmojo.dom","mstrmojo.hash","mstrmojo._HasEditableText","mstrmojo.ui.Pulldown");var K=mstrmojo.array,H=mstrmojo.dom,D=mstrmojo.hash,A=mstrmojo.Enum_Keys,C=19,M=A.ENTER,E=A.ESCAPE,N=A.DOWN_ARROW,F=A.UP_ARROW;mstrmojo.ui.SearchablePulldown=mstrmojo.declare(mstrmojo.ui.Pulldown,[mstrmojo._HasEditableText],{scriptClass:"mstrmojo.ui.SearchablePulldown",editableSlot:"selectedNode",allowCustomText:false,isSearching:false,editOnClick:false,init:function P(V){this._super(V);var Q=this.getPopupList();Q.renderOnScroll=this.renderOnScroll||Q.renderOnScroll;Q.renderBlockSize=this.renderBlockSize||Q.renderBlockSize;var U=[];if((mstrApp.isWorkstation&&H.isMac())||H.isSafari){U=["clip-safari"];}mstrmojo.css.addWidgetCssClass(this,["mstrmojo-ui-SearchablePulldown"].concat(U));var S=Q.constructor.prototype,R=Q.getItemProps||S.getItemProps,W=Q.getItemMarkup||S.getItemMarkup;Q.getItemProps=function(b,Y){var Z=this._spft||"",d=b.n,a=d?d.toUpperCase().indexOf(Z):-1,X=function(f){var e=[],g;K.forEach(f.split(";"),function(h){g=h.split(":");if(g.length===2&&g[0].toLowerCase()!=="color"){e.push(h);}});return e.join(";");};if(a===-1){Z="";}var c=R.call(this,b,Y);if(this.selectedIndices[Y]){c.style=X(c.style);}if(d){c.before=d.slice(0,a);c.input=d.substring(a,a+Z.length);c.after=d.slice(a+Z.length,d.length);}return c;};Q.getItemMarkup=function(Z,X){var Y=W.call(this,Z,X);if(Z.n&&Z.v!=="u;"){return Y.replace("{@en@n}","{@en@before}<span class='sp-highlight'>{@en@input}</span>{@en@after}");}return Y;};this._originalFocusOnPopup=this.focusOnPopup;this.focusOnPopup=false;},onclick:function O(Q){if(this._originalFocusOnPopup!==undefined){this.focusOnPopup=false;}if(this.isClickingAnchorSlot(Q)){var S=Q.e.offsetX>=(this.selectedNode.offsetWidth-C),R=this.getPopupWidget().visible;if(!R||(R&&S)){this.set("isEditing",!R);this._super(Q);}else{if(!this.isEditing){this.set("isEditing",true);}}}},setDefaultListAndIndex:function(V,W){var U=this.getPopupList(),R=this.text,Q=K.find(V,"n",R);if(Q===-1&&!this.allowCustomText){var S=U.items[0]||V[0];Q=K.find(V,"n",S.n);}U.set("items",V);if(W){this.set("selectedIndex",Q);}},onPopupWidgetClosed:function I(Q){this.set("isEditing",false);var R=this.getPopupList(),S=R._oldItems;delete R._oldItems;if(S){this.setDefaultListAndIndex(S,Q&&Q.pressingEnter);}},_set_selectedIndex:function G(S,Q){if(this.allowCustomText&&Q===-1){this.selectedIndex=-1;this.onitemSelected(null,Q);}else{this.isSearching=false;this._super(S,Q,true);if(this.hasRendered){var R=this.selectedNode;this.text=R.innerText||R.textContent;}}return true;},onkeydown:function J(S){this._super(S);var R=window.event||S.e,U=R.keyCode,Q=this.getPopupWidget();if(U===M){Q.close({pressingEnter:true});}else{if(this._originalFocusOnPopup&&(U===N||U===F)){this.focusOnPopup=true;if(Q.focus){Q.focus();}Q.raiseEvent(S);}}},onkeyup:function B(S){var Q=window.event||S.e,U=Q.keyCode,R=this.getPopupWidget();this._super(S);if(U===E||U===M){R.close();}else{if(U!==N&&U!==F){this.processSearch();}}},processSearch:function L(){this.isSearching=true;this.hideTooltip();var Q=[],S=this.getPopupList(),V=this.selectedNode.innerHTML,W=S._oldItems||S.items,R=V.toUpperCase(),U;R=R.replace(/<BR>/,"");if(R.length>0){K.forEach(W,function(X){U=X.n;if(U&&U.toUpperCase().indexOf(R)>-1){Q.push(D.clone(X));}},this);}else{Q=W;}S._spft=R;if(this.customizeSearchResult){this.customizeSearchResult(Q);}S.set("items",Q);if(S.adjustCornersForPopupOverflow){S.adjustCornersForPopupOverflow();}delete S._spft;S._oldItems=W;S.set("visible",S.items.length!==0);}});}());(function(){mstrmojo.requiresCls("mstrmojo.ui.editors.controls.ListPreviewButton","mstrmojo.ui.editors.controls.ValidationTextBox","mstrmojo.EditableLabel");var A=mstrmojo.css,E=mstrmojo.validation.STATUSCODE;mstrmojo.ui.editors.controls.ComboBox=mstrmojo.declare(mstrmojo.ui.editors.controls.ListPreviewButton,null,{scriptClass:"mstrmojo.ui.editors.controls.ComboBox",markupMethods:{onenabledChange:function D(){this.txtLabel.set("enabled",this.enabled);this.txtLabel.set("editOnClick",this.enabled);A.toggleClass(this.domNode,"disabled",!this.enabled);}},init:function B(F){this._super(F);mstrmojo.css.addWidgetCssClass(this,"mstrmojo-ui-ComboBox");},updatePreview:function C(){this.txtLabel.set("value",this.selectedValue||"");},updateSelection:function(){this.set("selectedValue",this.txtLabel.value);},validateTextInput:function(F){return true;},txtLabel:null,children:[{scriptClass:"mstrmojo.ui.editors.controls.ValidationTextBox",alias:"txtLabel",slot:"previewNode",constraints:{validator:function(){if(!this.parent.validateTextInput(this.value)){return{id:this.id,code:E.INVALID,msg:""};}}},onValid:function(){this.parent.updateSelection();}}]});}());(function(){mstrmojo.requiresCls("mstrmojo.css","mstrmojo.vi.ui.HierarchyCheckList","mstrmojo.ui._IsIncFetchHierarchyList");var A=mstrmojo.css;mstrmojo.vi.ui.IncHierarchyCheckList=mstrmojo.declare(mstrmojo.vi.ui.HierarchyCheckList,[mstrmojo.ui._IsIncFetchHierarchyList],{scriptClass:"mstrmojo.vi.ui.IncHierarchyCheckList",cssClass:"elementsList"});}());(function(){mstrmojo.requiresCls("mstrmojo.css","mstrmojo.array","mstrmojo.WidgetTree","mstrmojo.TreeBrowserNode","mstrmojo.TreeBrowserSelector");mstrmojo.TreeBrowserEnum={};var I=mstrmojo.TreeBrowserEnum;I.BRANCH_POLICY_TOGGLE="toggle";I.BRANCH_POLICY_SELECT="select";mstrmojo.TreeBrowser=mstrmojo.declare(mstrmojo.WidgetTree,null,{scriptClass:"mstrmojo.TreeBrowser",cssClass:"mstrmojo-TreeBrowser",browserNodeClass:mstrmojo.TreeBrowserNode,blockCount:30,noCheckBox:false,selectionAcrossBranch:true,branchClickPolicy:I.BRANCH_POLICY_TOGGLE,contentRetrieved:false,listSelector:mstrmojo.TreeBrowserSelector,handleNodeClicked:function(J){},getContentThroughTaskCall:function H(K,J){},isBranch:function F(J){},item2textCss:function C(J){return{"-1":"failed","-2":"loading","-3":"next","-4":"prev"}[J.st]||"";},failItemCreaterFunc:function(){return{n:"Loading Failed!",did:"-1",tp:"-1",st:"-1"};},loadingItemCreaterFunc:function(){return{n:mstrmojo.desc(5674,"Loading..."),did:"-2",tp:"-2",st:"-2"};},nextItemCreaterFunc:function(J){return{n:mstrmojo.desc(4507,"Next ##  item(s)...").replace("##",J?Math.min(J,this.blockCount):this.blockCount),did:"-3",tp:"-3",st:"-3"};},prevItemCreaterFunc:function(){return{n:mstrmojo.desc(4508,"Previous ##  item(s)...").replace("##",this.blockCount),did:"-4",tp:"-4",st:"-4"};},updateTreeContent:function(K,M){K.contentRetrieved=true;var L=M[K.itemChildrenField]||[],J=K.tree||K,O=M.bc,N=M.sz,P=M.bb;if(O!==-1){if(P+O<=N){L.push(J.nextItemCreaterFunc(N-P-O+1));}if((P-O)>-1){L.unshift(J.prevItemCreaterFunc());}}K.blockBegin=P;J.initializing=true;K.clearSelect(false);K.set("items",L);K.setSelectedItems(J.getTotalSelections(),true);J.initializing=false;if(J.onNodeExpand){J.onNodeExpand(K);}},getContent:function(K,O){var L=(K===this),J=this,P=function(Q){if(L){mstrmojo.css.removeClass(J.domNode,["loading"]);}J.updateTreeContent(K,Q);},M=function(Q){K.contentRetrieved=true;K.set("items",[J.failItemCreaterFunc()]);},N={success:P,failure:M};if(L){mstrmojo.css.addClass(J.domNode,["loading"]);}this.getContentThroughTaskCall({isRoot:L,data:K.data,blockBegin:L?0:(O||K.blockBegin),blockCount:J.blockCount},N);},postBuildRendering:function A(){this._super();if(!this.contentRetrieved){var J=this;setTimeout(function(){J.getContent(J);},0);}},itemFunction:function G(N,K,L){var J=L.tree||L,M=new J.browserNodeClass({data:N,state:0,parent:L,tree:J,multiSelect:L.multiSelect,text:N[L.itemDisplayField],textCssClass:J.item2textCss(N),items:N[L.itemChildrenField],itemIdField:L.itemIdField,itemDisplayField:L.itemDisplayField,itemIconField:L.itemIconField,itemChildrenField:L.itemChildrenField,itemFunction:L.itemFunction,listSelector:L.listSelector});return M;},clearTreeSelect:function E(){if(!this.selectionAcrossBranch){this._super();}else{var L=this._selectionParentNode,J=L&&L.length,K;for(K=0;K<J;K++){L[K].clearSelect();}this._selectionParentNode=null;this._totalSelections=null;}},onnodechange:function D(U){if(this.initializing){return ;}if(!this.selectionAcrossBranch){this._super(U);}else{this._totalSelections=this._totalSelections||[];this._selectionParentNode=this._selectionParentNode||[];var R=this._totalSelections,J=this._selectionParentNode,S=U.added,P=U.removed,Q=[],L=[],K=U.src,N,M,O,V;J.push(K);for(N=0,O=P&&P.length;N<O;N++){L.push(K.items[P[N]]);}mstrmojo.array.removeItems(R,"did",L);for(M=0,V=S&&S.length;M<V;M++){Q.push(K.items[S[M]]);}this._totalSelections=R.concat(Q);}},getTotalSelections:function B(){if(this.selectionAcrossBranch){return this._totalSelections||[];}var J=this.selectionParentNode;return J&&J.getSelectedItems();}});}());(function(){mstrmojo.requiresCls("mstrmojo.WidgetTree","mstrmojo.expr","mstrmojo.mstr.EnumNodeProperties","mstrmojo.AndOrNode","mstrmojo.ConditionNode");var H=mstrmojo.expr,B=mstrmojo.mstr.EnumNodeProperties,C=H.ET;function A(I){var K=I&&I.src,L=K&&K.data,J=L&&L.et;return(J in H.ETs);}function E(I){return I&&I.et===C.ANDOR&&!(I.node&B.CONDITION);}mstrmojo.FilterExpr=mstrmojo.declare(mstrmojo.WidgetTree,null,{scriptClass:"mstrmojo.FilterExpr",allowDrop:A,renderOnScroll:false,itemIdField:null,nodeClassMap:{14:mstrmojo.AndOrNode,"*":mstrmojo.ConditionNode},onBlankClick:function(I){this.clearTreeSelect();},onnodemousedown:function(J){var K=mstrmojo.dom.eventTarget(J.hWin,J.e),L=J.src,I=L.listMapper.findIndex(L,L.itemsContainerNode,K),M=I>=0?L.ctxtBuilder.itemWidgets[I]:null;if(!M||(M.isSelectableArea&&!M.isSelectableArea(K))){this.onBlankClick(J);}},getItemIdentityProp:function(I){return I.et;},itemFunction:function(N,K,O){var J=O.tree,L=J.getItemConfig(N,K,O),M=J.nodeClassMap,I=M[J.getItemIdentityProp(N)]||M["*"];return I&&(new I(L));},getItemConfig:function(L,I,M){var J=E(L),K=M.tree||M;return{data:L,tree:K,parent:M,bindings:{prefixedAndOrEditable:"this.parent.editable"},itemFunction:(J)?M.itemFunction:null,draggable:J?K.draggable:false,dropZone:J?K.dropZone:false,allowDrop:J&&K.dropZone?K.allowDrop:null,allowCopy:J?K.allowCopy:false,editable:K.isEditable?K.isEditable(L):K.editable,makeObservable:J&&M.makeObservable,onclick:K.onnodeclick,onadd:K.onnodeadd,onremove:K.onnoderemove};},getDragData:function(I){var K=this._super(I);if(K&&!K.html){var J=K.et&&H.ET2TGT[K.et];K.html=J?K[J]&&K[J].n||"":K.n||"";}return K;},newCondition:function G(M){M=M||{et:C.AQ};var L=this.selectionParentNode,I;L=(L&&L.hasRendered)?L:this;if(L!==this){I=L.add([M]);}else{var K=this.addCondition([M],null,true);I=K.index;L=K.widget;}var J={widget:L,index:I,data:M};if(this.onNew){this.onNew(J);}return J;},addCondition:function F(K,M){var N=this.items,J=N&&N.length,P=K&&K.length;if(!P){return null;}var L,I;if(J&&E(N[0])){L=this.ctxtBuilder.itemWidgets[0];I=L.add(K,null);}else{if(!J&&(P===1)){L=this;I=0;this.add(K,0);}else{if(J){var O=N[0];this.remove(O);K.unshift(O);}this.add([{et:C.ANDOR,fn:H.FN.AND,nds:K}],0);L=this.ctxtBuilder.itemWidgets[0];I=J?1:0;}}return{widget:L,index:I};},addSingleCondition:function D(J,I){var K=this.addCondition([J],I);return K.widget.ctxtBuilder.itemWidgets[K.index];},ondrop:function(L){if(this._super){this._super(L);}var J=this.items,I=J&&J.length,K=J.concat();if(I>1){if(J.remove){J.remove(0,J.length);}else{this.set("items",null);}this.add([{et:C.ANDOR,fn:H.FN.AND,nds:K}],0);}}});})();(function(){mstrmojo.requiresCls("mstrmojo.Button","mstrmojo.hash","mstrmojo.func","mstrmojo.css","mstrmojo.string","mstrmojo.HBox","mstrmojo.Box","mstrmojo.DropDownButton","mstrmojo.Popup","mstrmojo.WidgetTree","mstrmojo.ObjectBrowserDataProvider","mstrmojo.OBList","mstrmojo.FishEyeContainer","mstrmojo.SearchBox2","mstrmojo.Booklet","mstrmojo.IncFetch","mstrmojo.chart.model.enums.EnumDSSObjectType","mstrmojo.mstr.ui.IncFetchOBList","mstrmojo.DI.DIConstants");var Q=mstrmojo.hash,Z=mstrmojo.func,A=mstrmojo.string,M=mstrmojo.meta.TP,G="5CECE58CC1D549F890EB61C4DB2156A3",W="E0CCB9CF22104A489CBE78D974AFD19E",S=mstrmojo.chart.model.enums.EnumDSSObjectType,L=mstrmojo.array,E=mstrmojo.dom,P=mstrmojo.DI.DIConstants,b=function(k,l,e){var h=k.scrollableIncFetch,g=h?"mstrmojo.mstr.ui.IncFetchOBList":"mstrmojo.OBList",j={scriptClass:g,items:l.items,multiSelect:e};if(h){j.browseConfig={blockBegin:l.bb,blockCount:l.bc,totalSize:l.sz,folderLinksContextId:k.folderLinksContextId,rootFolderID:l.did,browsableTypes:k.browsableTypes,browsableViewMedias:k.browsableViewMedias,dataProvider:k.dataProvider};j.onwaitingChange=function(){if(k.booklet){k.booklet.set("waiting",this.waiting);}};}var f=mstrmojo.insert(j);f.render();return f;},B=function(g,j,e){var f=mstrmojo.ObjectBrowser.widgetHandler||b;return f(g,j,e);},O={success:function(g){var h=this.ob,f=g.items,j=h.pageCache[h.currentPage],e=j._w;j.items=f;e.set("items",f);this.ob=null;this.item=null;window.clearTimeout(h._btm);h.booklet.set("waiting",false);if(h.scrollableIncFetch&&e.scrollNode){e.initScroll();e.updateScrollbars();}},failure:function(e){window.alert(e.getResponseHeader("X-MSTR-TaskFailureMsg"));this.ob.booklet.set("waiting",false);}},V=function(k,j,g){var h=g?-1:1,f=k.pageCache.length,l;for(l=k.currentPage+h;l<f&&l>=0;l+=h){var e=k.pageCache[l];if(e._k===j.k){return{steps:l-k.currentPage,cache:e};}}return null;},D=function(j,h,g,k){var m=j.currentPage+1,f=j.pageCache.length,e;for(e=m;e<f;e++){j.pageCache[e]._w.destroy();delete j.pageCache[e].items;}j.pageCache=j.pageCache.slice(0,m);k._w=g;k._k=h.k;j.pageCache[m]=k;j.cacheChange();},I=function(f){var e=mstrmojo.hash.walk("anc.items.0.items",f);this.set("canGoUp",!(!f.pf||!e));},J=function(j,h,k,g,f){delete j._btm;var e;if(!g){e=B(j,k,j.multiSelect);e.attachEventListener("change",j.id,"navigate");if(j.useDblSelect||j.useBothSglDblSelect){e.attachEventListener("dblclick",j.id,"dblselect");}}else{e=k._w;}j.obList=e;j.booklet.turn(e,f>0);window.setTimeout(function(){j.onBrowsing=false;},300);if(!g){D(j,h,e,k);}j.set("currentFolder",k);j.set("currentPage",j.currentPage+f);j.updateUpButton(k);if(j.scrollableIncFetch&&e.scrollNode){e.initScroll();e.updateScrollbars();}},R=function(g,f,e){var h=V(g,f,false);h=h||V(g,f,true);if(!h){window.clearTimeout(g._btm);g._btm=window.setTimeout(function(){g.booklet.set("waiting",true);},300);e.ob=g;e.item=f;g.getDataProvider().fetchFolderContents(g,f,e);}else{J(g,f,h.cache,true,h.steps);}},C=function(f,g,h,e){R(f,{fid:f.pageCache[f.currentPage].did,blockBegin:g,searchPattern:h,recursive:e},O);},K={success:function(f){var g=this.ob;if(g){window.clearTimeout(g._btm);if(!f.items){f.items=[{did:"empty",n:"("+mstrmojo.desc(2210)+")",t:"e"}];}var e=function j(k){var n=k.length,l;for(l=0;l<n;l++){var m=k[l];if(m.did===G||m.did===W){m.n=(m.did===G)?mstrmojo.desc(8112):mstrmojo.desc(9277);}if(m.items){e(m.items);}}};if(f.did===G||f.did===W){f.n=(f.did===G)?mstrmojo.desc(8112):mstrmojo.desc(9277);if(f.anc&&f.anc.items){e(f.anc.items);}}if(f&&f.items&&g.browsableViewMedias){var h={};L.forEach(g.browsableViewMedias.split(","),function(k){h[parseInt(k,10)]=true;});f.items=L.filter(f.items,function(k){return(k.t!==S.DssTypeDocumentDefinition)||h[k.dvm];});}if(f&&f.items&&mstrApp&&mstrApp.isSingleTier){f.items=L.filter(f.items,function(k){return(k.st!==772);});}if(g.isImportFromCube){f.items=L.filter(f.items,function(k){return(k.et!==P.DSSExType.DSSEXDISPARK);});}if(f.did&&this.item.k!==f.did){this.item.k=f.did;}J(g,this.item,f,false,1);this.ob=null;this.item=null;}},failure:function(e){this.ob.booklet.set("waiting",false);if(this.ob.onError){this.ob.onError(e);}else{if(e.getResponseHeader){mstrmojo.alert(e.getResponseHeader("X-MSTR-TaskFailureMsg"));}else{mstrmojo.alert(e.message);}}},complete:function(){if(this.ob){this.ob.onBrowsing=false;}}},d=function(g){var f=g.pageCache.length,e;for(e=0;e<f;e++){g.pageCache[e]._w.destroy();}g.pageCache=[];g.currentPage=-1;g.cacheChange();},N=function(h,g,j){var e=h.onBrowseFolder;if(e){e[0][e[1]](g);}if(g&&parseInt(g.acg,10)===33){return ;}var f={};if(g){f.k=g.did;f.fid=g.did;}else{if(h.rootFolderID){f.k=h.rootFolderID;f.fid=h.rootFolderID;}else{if(h.rootFolderType){f.k=h.rootFolderType;f.fty=h.rootFolderType;}else{if(h.folderLinksContextId){f.k=h.folderLinksContextId;}}}}R(h,f,Z.wrapMethods(j,Q.copy(K)));},Y=function(k,e,g){if(!g){return e;}var h=k.showCompletePath,m=e[0],j,f;while(m){var l;for(l=g.length-1;l>=0;l--){if(m.did===g[l].did){g.splice(l,1);m._isSc=true;}}f=m;m._open=true;m=m.items;m=m&&m[0];if(!m){f.lastLeaf=true;}}if(!h){m=e[0];while(m){if(m._isSc){e[0]=m;break;}m=m.items;m=m&&m[0];}}return e.concat(g);},X=function(f,e,g){f._naviInfo=Y(f,e,g);};mstrmojo.ObjectBrowser=mstrmojo.declare(mstrmojo.Box,null,{scriptClass:"mstrmojo.ObjectBrowser",rootFolderType:null,rootFolderID:null,sId:null,closeOnSelect:true,browsableTypes:null,browsableViewMedias:null,includeObjectDesc:false,closeable:true,fishEyeVisible:false,searchVisible:true,upButtonVisible:false,currentFolder:null,pageCache:[],currentPage:-1,blockCount:50,canGoUp:true,folderLinksContextId:null,minSearchLength:2,showCompletePath:true,multiSelect:false,onCloseCB:null,onSelectCB:null,onBrowseFolder:null,scrollableIncFetch:false,useBothSglDblSelect:false,displaySaveLabel:false,useOldSearch:false,getDataProvider:function(){if(!this.dataProvider){this.dataProvider=mstrmojo.insert({scriptClass:"mstrmojo.ObjectBrowserDataProvider"});}return this.dataProvider;},markupMethods:{onvisibleChange:function(){this.domNode.style.display=this.visible?"block":"none";}},children:[{scriptClass:"mstrmojo.HBox",alias:"titleBar",cssClass:"mstrmojo-OB-titleTable",children:[{alias:"saveLabel",scriptClass:"mstrmojo.Label",cssClass:"msrmojo-save-label",text:mstrmojo.desc(3178,"Save in:"),bindings:{visible:"this.parent.parent.displaySaveLabel"}},{alias:"title",scriptClass:"mstrmojo.DropDownButton",cssClass:"mstrmojo-FormatEditor-DropDownButton",cssText:"margin:0px;",popupRef:{scriptClass:"mstrmojo.Popup",alias:"popup",contentNodeCssClass:"mstrmojo-OBNavigatorPopup",cssText:"position:relative;",slot:"popupNode",locksHover:true,onOpen:function(){var e=this.opener.parent.parent,h=this.tree,g=e._naviInfo,f=this.parent.parent.parent.extraDDItems;if(h.items!==g){h._pup=this;this.ob=e;if(f){L.forEach(f,function(j){j.isExtra=true;});g=g.concat(f);}h.set("items",g);}if(e.getRecents&&!mstrApp.isSingleTier){e.getRecents(this);}},children:[{alias:"tree",scriptClass:"mstrmojo.WidgetTree",itemIdField:"did",itemFunction:function(j,e,f){var h=mstrmojo.WidgetTree.prototype.itemFunction(j,e,f);if(j.isExtra){if(j.cssClass){h.cssClass=j.cssClass;}h.onmousedown=j.onmousedown||mstrmojo.emptyFn;return h;}if(j._open){h.state=1;}h._ll=!!j.lastLeaf;h._pup=f._pup;h.onmousedown=function(k){var l=mstrmojo.dom.eventTarget(k.hWin,k.e),m=this._pup;if(l===this.domNode||l===this.textNode){if(!this._ll){N(m.ob,this.data);}m.close();}};h.markupMethods=Q.copy(h.markupMethods);h.markupMethods.onstateChange=function(){var k=this.data.items?this.state:0;this.stateNode.className="mstrmojo-TreeNode-state "+({0:"closed",1:"opened",2:"leaf"}[k]||"closed");this.itemsContainerNode.style.display=(k===1)?"block":"none";};h.useRichTooltip=true;var g=h.postBuildRendering;h.postBuildRendering=function(){if(g){g.call(h);}if(h.textNode.parentNode.clientWidth){h.textNode.style.width=(h.textNode.parentNode.clientWidth-20)+"px";}};h.premouseover=function(m){if(this.useRichTooltip){var l=this.textNode;if(l.clientWidth<l.scrollWidth){var k=E.position(l);this.richTooltip={areaId:this.id,cssClass:"vi-regular vi-tooltip-C",contentNodeCssClass:"regular-unitlist-tooltips",posType:mstrmojo.tooltip.POS_TOPLEFT,content:A.encodeHtmlString(this.data[this.itemDisplayField]),top:k.y-2,left:k.x+k.w+6};}else{this.richTooltip=null;}mstrmojo.dom.stopPropogation(m.hWin,m.e);}return true;};return h;}}]}},{alias:"upButton",scriptClass:"mstrmojo.Button",cssClass:"mstrmojo-OBListItemIcon up",title:mstrmojo.desc(1152,"Up One Level"),onclick:function(){this.parent.parent.goUp();},bindings:{enabled:"this.parent.parent.canGoUp",visible:"this.parent.parent.upButtonVisible"}},{alias:"closebtn",scriptClass:"mstrmojo.Button",iconClass:"mstrmojo-OBCloseButton",title:mstrmojo.desc(2102,"Close"),bindings:{visible:"this.parent.parent.closeable"},onclick:function(){this.parent.parent.close();}}]},{alias:"fishEye",scriptClass:"mstrmojo.FishEyeContainer",cssText:"width:100%",bindings:{visible:"this.parent.fishEyeVisible"}},{alias:"searchUpBar",scriptClass:"mstrmojo.HBox",cssClass:"searchBox",children:[{alias:"obSearchBox",scriptClass:"mstrmojo.SearchBox2",cssClass:"mstrmojo-charcoalbox mstrmojo-dxsprite",cssText:"margin: 3px 0; ",contentWidget:mstrmojo.all.obList,taskId:"searchMetadata",searchIncFetch:true,enableMatchCase:false,forceResetCache:true,bindings:{minSearchLength:"this.parent.parent.minSearchLength",quickSearch:"this.parent.parent.quickSearch"},serverRequest:function(e,f){this.parent.parent.getDataProvider().serverRequest(e,f);},preFetch:function(){this.objectTypes=this.parent.parent.browsableTypes||this.objectTypes;this.parent.parent.booklet.set("waiting",true);},postFetch:function(){this.parent.parent.booklet.set("waiting",false);},postBuildRendering:function a(){if(this._super){this._super();}this.inputNode.setAttribute("placeholder"," "+mstrmojo.desc(12666,"Search..."));},onUpdateSearchParams:function H(g){var f=this.parent.parent,e=f.sId;if(e){g.sessionState=e;}if(f.useOldSearch){g.quickSearch=0;g.nameWildcards=1;g.sortKey=6;}}}],bindings:{visible:"this.parent.searchVisible"}},{scriptClass:"mstrmojo.Booklet",cssClass:"mstrmojo-OB-booklet",alias:"booklet",hasAnimation:false,bindings:{scrollableIncFetch:"this.parent.scrollableIncFetch"}},{alias:"obIncFetch",scriptClass:"mstrmojo.IncFetch",height:"17px",cssText:"height:0px;overflow:hidden;",visible:false,np:0,cp:0,ds:{f:mstrmojo.desc(4046,"First"),p:mstrmojo.desc(1058,"Previous"),n:mstrmojo.desc(1059,"Next"),l:mstrmojo.desc(4049,"Last"),pgs:mstrmojo.desc(5972,"## of ### pages"),gt:mstrmojo.desc(5878,"Go to:"),v:mstrmojo.desc(6079,"This field should be # between ## and ###.")},onvisibleChange:function(f){var j=parseInt(this.height,10),e=this.np>1,g={target:this.domNode,props:{height:{start:(e?0:j),stop:(e?j:0),suffix:"px"}},onEnd:function(){if(e){this.target.style.overflow="visible";}}},k=new mstrmojo.fx.AnimateProp(g);this.domNode.style.overflow="hidden";mstrmojo.css.toggleClass(this.parent.domNode,"show-inc-fetch",this.visible);k.play();},onifsChange:function(e){var f=this.np;mstrmojo.hash.copy(e.value,this);if(this.np>1){this.children=null;this.refresh();}if((f<=1&&this.np>1)||(f>1&&this.np<=1)||(f===0&&this.np>0)){this.set("visible",this.np>1);}this.cssText="";}}],destroy:function c(){d(this);if(this._super){this._super();}},postBuildRendering:function(){if(this._super){this._super();}if(this.fishEye&&this.fishEyeVisible){this.fishEye.attachEventListener("selectedIndexChange",this.id,"onFishEyeChange");}var g=this.searchUpBar;if(g&&g.obSearchBox&&this.searchVisible){this.obSearchBox=this.searchUpBar.obSearchBox;this.obSearchBox.attachEventListener("itemsChange",this.id,"onSearchItemsChange");var e=this.obSearchBox.contentWidget||this.obSearchBox;if(!this.scrollableIncFetch){e.attachEventListener("ifsChange",this.id,function(h){if(!this.scrollableIncFetch){this.obIncFetch.set("ifs",h.value);}});}}if(!this.scrollableIncFetch&&this.obIncFetch){var f=this.obIncFetch;f.attachEventListener("fetch",this.id,function(h){f.cp=h.v;f.children=null;f.refresh();C(this,(h.v-1)*this.blockCount+1,this.searchVisible?this.obSearchBox.inputNode.value:"",1);});}mstrmojo.css.addClass(this.domNode,"mstrmojo-ObjectBrowser");},onSearchItemsChange:function(f){var g=f.value,e=this.pageCache[this.currentPage]._w;if(!g||g.length===0){g=[{did:"empty",n:"("+mstrmojo.desc(2210,"")+")",t:"e"}];}else{if(this.browsableViewMedias){var h={};L.forEach(this.browsableViewMedias.split(","),function(j){h[parseInt(j,10)]=true;});g=L.filter(g,function(j){return(j.t!==S.DssTypeDocumentDefinition)||h[j.dvm];});}}e.set("items",g);},navigate:function(n){var e=n.src,o=e.selectedItem,g=this.multiSelect,k=g&&e.getSelectedItems(),l=this,f=n.added&&n.added.length,j=n.removed&&n.removed.length,h=g?k.length===1&&(!j||f):!!o;if(h&&o.did==="empty"){return ;}if(h&&parseInt(o[M],10)===8){if(!this.onBrowsing){this.onBrowsing=true;N(this,o);}}else{if((o&&(!this.useDblSelect||this.useBothSglDblSelect))||k){this.select(g?k:o);}}},browseFolder:function(e,f){N(this,{did:e,n:f});},onFishEyeChange:function(e){this.goToPage(e.value);},goToPage:function(e){if(e<this.pageCache.length&&e!==this.currentPage){var g=e>this.currentPage,f=this.pageCache[e];this.set("currentPage",e);this.booklet.turn(f._w,g);this.set("currentFolder",f);I.call(this,f);}},oncurrentPageChange:function(e){if(this.fishEye){this.fishEye.setSelectedIndex(e.value);}var f=this.pageCache[this.currentPage];this.titleBar.title.set("text",mstrmojo.string.encodeHtmlString(f.n));if(this.searchVisible&&this.obSearchBox){this.obSearchBox.set("rootCacheItems",f.items||[]);this.obSearchBox.set("totalSize",f.sz);this.obSearchBox.set("rootID",f.did);this.obSearchBox.clearSearch();}if(!this.scrollableIncFetch&&this.obIncFetch){this.obIncFetch.set("ifs",{np:Math.floor(f.sz/f.bc)+((f.sz%f.bc>0)?1:0),cp:Math.floor(f.bb/f.bc)+((f.bb%f.bc>0)?1:0)});}},cacheChange:function(){if(this.fishEye&&this.fishEyeVisible){this.fishEye.setItems(this.pageCache);}},browse:function(f,e){Q.copy(f,this);if(this.searchVisible&&this.obSearchBox){this.obSearchBox.clear();}d(this);N(this,undefined,e);},close:function(){var f=this.ctx||this,e=f.onCloseCB;if(e){e[0][e[1]]();}f.set("visible",false);},select:function(f){var e=this.onSelectCB;if(e){e[0][e[1]](f);}if(this.closeOnSelect){this.close();}},dblselect:function U(f){var g=f&&f.src.selectedItem;if(!g||(g&&g.did==="empty")||g[M]===8){return ;}if(this.useBothSglDblSelect){var e=this.onDblSelectCB;if(e){e[0][e[1]](g);}if(this.closeOnSelect){this.close();}}else{this.select(g);}},goUp:function(){if(this.canGoUp){N(this,{did:this.currentFolder.pf});}},updateUpButton:function F(e){I.call(this,e);},oncurrentFolderChange:function(e){var f=e.value;X(this,f.anc.items,f.sc);},refreshContent:function(e){C(this,e);},onError:null,onheightChange:function(){var e=["titleBar","fishEye","searchUpBar","obIncFetch"],g=0,f;for(f in e){g+=parseInt(this[e[f]].domNode.offsetHeight,10);}this.booklet.set("height",parseInt(this.height,10)-g+"px");}});}());(function(){mstrmojo.requiresCls("mstrmojo.AndOrNode","mstrmojo.fe._IsRelationTreeNode","mstrmojo.expr","mstrmojo.dom","mstrmojo.array","mstrmojo.css");var L=mstrmojo.expr,N=mstrmojo.dom,C=mstrmojo.array,A=mstrmojo.css,F=mstrmojo.fe._IsRelationTreeNode.createSetHtml;var M=function(){var U="noRelationOperator",P=this[U],R=this.ctxtBuilder&&this.ctxtBuilder.itemWidgets||[],S=mstrmojo.array.filter(R,function(V){return V&&V[U]!==P&&V.data.et!==L.ET.RLS;}),O=S.length;for(var Q=0;Q<O;Q++){S[Q].set(U,P);}};mstrmojo.fe.AndOrNode=mstrmojo.declare(mstrmojo.AndOrNode,[mstrmojo.fe._IsRelationTreeNode],{scriptClass:"mstrmojo.fe.AndOrNode",markupString:'<div id="{@id}" class="mstrmojo-andor mstrmojo-AndOrNode {@cssClass}"  style="position:relative;{@cssText}" mstrAttach:mousedown><div class="mstrmojo-onhoverparent mstrmojo-andor-prefix" mstrAttach:click><span class="mstrmojo-textset mstrmojo-andor-prefix-text"></span><span class="mstrmojo-onhover-in mstrmojo-andor-tools {@cssClass}">{@_prefixAndOrToolsMarkup}</span></div><div class="mstrmojo-andor-top"></div><div class="mstrmojo-andor-contentsWrapper" style="position:relative"><div class="mstrmojo-andor-contents" style="position:relative;{@itemsContainerCssText}">{@itemsHtml}</div><div class="mstrmojo-ListBase2-dropCue mstrmojo-AndOrNode-dropCue {@cssClass}"><div class="mstrmojo-ListBase2-dropCue-inner mstrmojo-AndOrNode-dropCue-inner"></div></div></div><div class="mstrmojo-andor-bottom"></div></div>',getPrefixAndOrToolsMarkup:function(){return(F+this._super());},markupSlots:mstrmojo.hash.copy({createSetNode:function(){return this.domNode.firstChild.childNodes[1].firstChild;}},mstrmojo.hash.copy(mstrmojo.AndOrNode.prototype.markupSlots)),markupMethods:mstrmojo.hash.copy({onnoRelationOperatorChange:function(){A.toggleClass(this.prefixHoverNode,["noRelation"],this.noRelationOperator);}},mstrmojo.hash.copy(mstrmojo.AndOrNode.prototype.markupMethods)),removeSet:function G(P){var O=P.childIndex(),Q=P.data,R=[Q];if(O>=0){this.remove(O,true);if(Q.nds&&Q.nds.length>0){R=Q.nds;if(Q.not){R[0].not=true;}}else{delete Q.dmy;delete Q.relation;delete Q.applySubExpr;delete Q.relation;delete Q.useSchema;delete Q.dmt;}this.add(R,O);this.consolidate(false);}},createSet:function E(Q,O){var P=this._ndsToMove(this,Q);if(!P){return ;}this.remove(P.idxs,true);var V=P.nds,U;if(V){if(V.length>1){var S={et:L.ET.ANDOR,nds:V};S.fn=this.data.fn;V=[S];U=S.nds[0].not;}else{var W=V[0];if(W&&W.not&&W.et===L.ET.ANDOR){U=W.not;delete W.not;}}}if(O&&O.rq){var R;if(O.isMetric){R=O.cq;mstrmojo.hash.copyProps(["applySubExpr","dmy","dmt","relation","useSchema"],O.rq,R);}else{R=O.rq;R.nds=V;if(U){R.not=U;}}this.add([R],P.idxs[0]);}this.consolidate(false);},preclick:function H(O){var R=null,Q=N.eventTarget(O.hWin,O.e),P=this._super(O);if(N.contains(this.createSetNode,Q,true)&&!this.noRelationOperator){R="createSetOpt";}O.part=R||O.part;return P;},preadd:function I(O){if(this._super){this._super(O);}this.updateRelationOperator();},preremove:function K(O){if(this._super){this._super(O);}this.updateRelationOperator();},consolidate:function B(){this._super();this.updateRelationOperator();},postBuildRendering:function J(){var O=this._super();this.updateRelationOperator();return O;},updateRelationOperator:function D(){var O=this.ctxtBuilder&&this.ctxtBuilder.itemWidgets||[],P=!!C.filterOne(O,function(R){return R&&(R.data.et===L.ET.RLS||(R.data.et===L.ET.ANDOR&&R.noRelationOperator));}),Q=this.parent;this.set("noRelationOperator",P);M.call(this);if(Q&&Q.hasRendered&&Q.updateRelationOperator){Q.updateRelationOperator();}},onmouseover:function(){this.toggleGroupBorder(true);},onmouseout:function(){this.toggleGroupBorder(false);}});})();(function(){mstrmojo.requiresCls("mstrmojo.Box","mstrmojo.hash","mstrmojo.Button","mstrmojo.MenuButton");mstrmojo.requiresDescs(212,2140);var C="mstrmojo-qb-footerIcon",F="cancel",B="publish",E="disabled",H="new",D=" ";function I(L){return mstrmojo.hash.copy(L,{scriptClass:"mstrmojo.Button",onclick:function K(){if(this.cmd){mstrApp.getRootController()[this.cmd]();}}});}mstrmojo.qb.Footer=mstrmojo.declare(mstrmojo.Box,null,{hidePublish:function G(){this.publish.set("visible",false);},children:[I({cmd:"publish",enabled:false,text:mstrmojo.desc(212,"Continue"),alias:"publish",postBuildRendering:function A(){mstrApp.getRootController().attachEventListener("allowSave",this.id,function(K){this.set("enabled",K.value);});}}),I({cmd:"cancel",iconClass:[C,F].join(D),text:mstrmojo.desc(2140,"Cancel")})],addChildren:function J(N,K,L){var M=N[0];if(M.alias==="publish"){M.iconClass=[C,B,(mstrApp.reportID?"":H),E].join(D);}this._super(N,K,L);}});}());(function(){mstrmojo.requiresCls("mstrmojo.array","mstrmojo.mstr.EnumDSSXMLObjectTypes","mstrmojo.ME.MetricDataService","mstrmojo.ME.DerivedMetricOptions");mstrmojo.requiresDescs(2140);var B=mstrmojo.array;mstrmojo.ME._DerivedMetricEditorHelper=mstrmojo.provide("mstrmojo.ME._DerivedMetricEditorHelper",{isDME:true,noCache:false,closeLabel:mstrmojo.desc(2140,"Cancel"),saveAsEnabled:false,tbBrowsable:false,init:function C(D){this._super(D);},onApplyMetricCallback:mstrmojo.emptyFn,optionPopupRef:{scriptClass:"mstrmojo.ME.DerivedMetricOptions",title:mstrmojo.desc(13035,"Metric Options"),help:"create_derived_metric.htm",width:300},replaceAttributeWithForms:function A(E){var D=[];B.forEach(E,function(F){if(F.t===mstrmojo.mstr.EnumDSSXMLObjectTypes.Attribute&&F.fs){B.forEach(F.fs,function(G){if(G.obf||F.da){D.push({n:F.n+"@"+G.fnm,did:F.did+"@"+G.fid,fmdid:G.fid,fnm:G.fnm,t:G.t,frm:G,oi:F,path:F.path});}});}else{D.push(F);}});return D;}});}());(function(){mstrmojo.requiresCls("mstrmojo.hash","mstrmojo.array","mstrmojo._HasSuggestion");var F=-1,E=0,D=1;mstrmojo._ValidateSuggestions=mstrmojo.provide("mstrmojo._ValidateSuggestions",mstrmojo.hash.copy(mstrmojo._HasSuggestion,{_mixinName:"mstrmojo._ValidateSuggestions",itemValidationField:"did",verifyObject:function C(J,H){var M=this.candidates,L;if(M){var I=M.items,G=mstrmojo.array.find(I,this.itemValidationField,H.data[this.itemValidationField]);G=G>-1?G:mstrmojo.array.find(I,this.itemField,J);if(G>-1){H.updateData(I[G]);L=E;}else{if(M.isComplete){L=D;}}}if(L!==undefined){return L;}var K=this._vqueue=this._vqueue||[];K.push({pattern:J,id:H.data[this.itemIdField]});if(!this._vInProgress){this.verifyNextCandidate();}return F;},verifyNextCandidate:function B(){var G=this._vqueue;if(!G||G.length===0){this._vInProgress=false;return ;}this.verifyCandidate(G.shift());},verifyCandidate:function A(H){var G=this;this._vInProgress=true;this.getCandidatesThroughTaskCall({pattern:H.pattern,blockBegin:1,blockCount:G.noCache?-1:this.suggestCount,isVerify:true},{success:function(N){var K=G.ctxtBuilder.itemWidgets,J=K&&K.length,O,M;for(M=0;M<J;M++){if(K[M].data[G.itemIdField]===H.id){O=K[M];break;}}if(!O){return ;}var L=N.items;if(L&&L.length===1){O.updateData(L[0]);}else{if(L&&L.length>1){var I=mstrmojo.array.find(L,"did",O.data.did);if(I>-1){O.updateData(L[I]);}else{O.set("state",D);}}else{O.set("state",D);}}},failure:function(I){mstrmojo.alert(I.getResponseHeader("X-MSTR-TaskFailureMsg"));},complete:function(){G.verifyNextCandidate();}});}}));mstrmojo._ValidateSuggestions.ENUM_STATES={UNDETERMINED:F,VALID:E,INVALID:D};}());(function(){mstrmojo.requiresCls("mstrmojo.Widget","mstrmojo._HasLayout","mstrmojo._HasSuggestion","mstrmojo.css");var G=mstrmojo.css,D="clear";function E(){this.searchTriggered(this.inputNode.value);}mstrmojo.ui.SearchBox=mstrmojo.declare(mstrmojo.Widget,[mstrmojo._HasLayout],{scriptClass:"mstrmojo.ui.SearchBox",markupString:'<div id={@id} class="mstrmojo-ui-SearchBox cf {@cssClass}" style="{@cssText}"><input class="mstrmojo-ui-sb-input" type="text" autocomplete="off" autocorrect="off" autocapitalize="off" spellcheck="false" mstrAttach:keyup,blur,focus/><div class="mstrmojo-ui-sb-btn" mstrAttach:click ></div></div>',markupSlots:{inputNode:function I(){return this.domNode.firstChild;},searchNode:function B(){return this.domNode.lastChild;}},markupMethods:{onvisibleChange:mstrmojo.Widget.visibleMarkupMethod},layoutConfig:{h:{inputNode:"20px",searchNode:"20px"},w:{inputNode:"100%",searchNode:"22px"},xt:true},getLayoutOffsets:function(){return{w:2,h:0};},searchNode:undefined,inputNode:undefined,searchDelay:-1,init:function M(P){this._super(P);var O=this.searchDelay;if(O===-1||isNaN(O)){this.searchDelay=parseInt(mstrApp.getSearchAutoCompleteDelay(),10);}},onfocus:function N(O){var P=O.getTarget();if(P===this.inputNode){this.inputNode.placeholder="";G.addClass(this.domNode,"onInputFocus");}},onblur:function H(O){var P=O.getTarget();if(P===this.inputNode){this.inputNode.placeholder="Search...";G.removeClass(this.domNode,"onInputFocus");}},onclick:function L(O){var P=O.getTarget();if(P===this.searchNode){if(this._hasText){this.clearSearch();}else{E.call(this);}}},onkeyup:function A(Q){var P=Q.hWin,U=Q.e||P.event;if(U.keyCode===27){this.clearSearch();return ;}var S=this,O=this.text,V=this.text=this.inputNode.value,R=this._hasText=V.length>0;if(O!==V){G.toggleClass(this.searchNode,[D],R);window.clearTimeout(this._searchTimeoutId);this._searchTimeoutId=window.setTimeout(function(){E.call(S);},this.searchDelay);}},unrender:function F(){this.text="";this._super();},clearSearch:function J(O){this.text=this.inputNode.value="";G.removeClass(this.searchNode,[D]);delete this._hasText;if(!O){E.call(this);}this.postClearSearch();},isClear:function C(){return !this.text||this.text.length===0;},postClearSearch:mstrmojo.emptyFn,searchTriggered:function K(O){}});}());(function(){mstrmojo.requiresCls("mstrmojo.Container");mstrmojo.requiresCls("mstrmojo.Widget");mstrmojo.requiresDescs(2131,2122,2127,2125,2123,9938,2219,2220,520,612,521,523,522,524,525,526,686,2784,687,2785,688,2786,696,746,7555,13083,13084,4561,12939,12940,7227,13387,12078,12736);function N(x,q,u,AG,z,AD,r){var AA=z?"height:"+z+"px;":"";var AC=AD?"width:"+AD+"px;":"",AF=u[1],AB="";var AE='<div class="mstrmojo-qb-DBTableRow-bullet" style="'+AA+AC+'">';if(AF==="tick"||AF==="mix"){AB='style="font-weight: bold;"';AF=(AF==="tick")?0:16;}AE+='<div class="icon t'+AF+'"></div>';AE+='<div class="text" '+AB+">"+x+"</div>";if(r&&r.length){for(var t=0;t<r.length;t++){AE+='<div class="cxtmenu '+r[t].n+'"></div>';}}AE+="</div></div>";return AE;}var K=mstrmojo.dom,H=mstrmojo.global.document,E=mstrmojo.string,f=mstrmojo.array,L=mstrmojo.desc;var D,k,A;var d;function l(t,q,r){if(r!=null){k.innerHTML=r;}A.left=t.x+"px";A.top=t.y+"px";}function R(q,r){if(!D){D=H.createElement("div");A=D.style;A.position="absolute";A["z-index"]=9999;D.className="mstrmojo-qb-TableRow-avatar";D.innerHTML="<div></div>";k=D.firstChild;H.body.appendChild(D);}l(r,true,q);A.display="block";}function h(){if(D){A.display="none";}}function F(r,t){try{var AA=[],x=r,z=0,q,u;u=new RegExp(E.regEscape(t),"gi");while(!!t&&(q=u.exec(r))){AA.push(E.encodeHtmlString(r.slice(z,q.index)));AA.push('<span class="keyword">'+E.encodeHtmlString(r.slice(q.index,u.lastIndex))+"</span>");z=u.lastIndex;}AA.push(E.encodeHtmlString(r.slice(z)));r=AA.join("");}catch(w){r=x;}return r;}function c(r,q,u){if(!r.domNode){return false;}var t=K.position(r.domNode,true);return((t.y<=u)&&(t.x<=q)&&(t.x+t.w>=q)&&(t.y+t.h>=u));}function b(u,q,AA){var z=document.elementFromPoint(q,AA);var r=K.findWidget(z);while(r){if(r.dropZone){if(r.allowDrop&&r.allowDrop(u)){return r;}}r=r.parent;}return null;}mstrmojo.qb.DBTableRow=mstrmojo.declare(mstrmojo.Container,[mstrmojo._HasPopup],{scriptClass:"mstrmojo.qb.DBTableRow",indent:0,text:"",displayText:"",keyword:"",isVisibleChanged:false,checkBox:false,draggable:true,ownAvatar:true,dropZone:true,cxtmenus:null,allowDrop:function C(q){return true;},ondrop:function e(u){var t=u.src.widget,q=u.tgt.widget,r=mstrmojo.all.QBuilderModel;if(t.domNode.className.indexOf("mstrmojo-qb-DBTableRow")<0){return ;}if(t.srcID==q.srcID){return ;}if(r.joinsInfo[t.srcID+q.srcID]){r.addLink(t,q,t.srcID+q.srcID);}else{if(r.joinsInfo[q.srcID+t.srcID]){r.addLink(q,t,q.srcID+t.srcID);}else{r.addJoin(t,q,0,null);}}},_leftPos:0,_topPos:0,movable:false,dropTarget:null,markupString:'<div id="{@id}" class="mstrmojo-qb-DBTableRow {@cssClass}" style="{@cssText}" mstrAttach:click,dblclick,contextmenu></div>',markupMethods:{ondisplayTextChange:function(){this.domNode.innerHTML=N(this.displayText,this.indent,this.images,this.selected,null,null,this.cxtmenus);},onvisibleChange:mstrmojo.Widget.visibleMarkupMethod,oncssClassChange:function X(){this.domNode.className="mstrmojo-qb-DBTableRow "+(this.cssClass||"");},onkeywordChange:function(){var t=this.keyword,r,q;if(!t){this.set("isVisibleChanged",!this.visible);this.set("visible",true);this._highlight();return ;}q=this.text.toLowerCase().indexOf(t.toLowerCase())>=0;r=!!q;this._highlight();this.set("isVisibleChanged",r!=this.visible);this.set("visible",r);}},_highlight:function(){this.set("displayText",F(this.text,this.keyword));},getDragData:function(r){var q={};if(this.domNode){q.html=N(this.displayText,this.indent,this.images,this.selected,this.domNode.offsetHeight,this.domNode.offsetWidth);q.n=this.text;}return q;},isDragValid:function V(q){return K.contains(this.domNode,q.src.node,true,document.body);},ondragstart:function(q){if(K.isWK){document.onselectstart=function(r){r.preventDefault();return false;};}this.domNode.style.cssText="opacity:0.3; filter: alpha(opacity=30);";d=K.position(this.domNode);R(N(this.displayText,this.indent,this.images,this.selected,this.domNode.offsetHeight,this.domNode.offsetWidth),d);},ondragmove:function(r){var q=r.tgt.pos;l({x:q.x+5,y:q.y+5},true,N(this.displayText,this.indent,this.images,this.selected,this.domNode.offsetHeight,this.domNode.offsetWidth));},ondragend:function(){if(K.isWK){document.onselectstart=function(){return true;};}if(this.domNode){this.domNode.style.cssText="opacity:1; filter: alpha(opacity=100);";}h();},onclick:function(r){var q=r.hWin,t=r.e||q.event,u=t.target||t.srcElement;if(u.type==="checkbox"){if(this.onCheck){this.onCheck(u.checked);}}},postBuildRendering:function(){this.set("richTooltip",{cssClass:"vi-regular vi-tooltip-D",refNode:this.domNode,posType:mstrmojo.tooltip.POS_TOPRIGHT,content:this.rIndex>=0?this.text:mstrmojo.desc(12736,"Add all columns")});if(!this._ontooltipover){var q=this.id;this._ontooltipover=function(t){var r=mstrmojo.all[q];r.showTooltip(t,self);};this._ontooltipout=function(t){var r=mstrmojo.all[q];r.hideTooltip(t,self);};}mstrmojo.dom.attachEvent(this.domNode,"mouseover",this._ontooltipover);mstrmojo.dom.attachEvent(this.domNode,"mouseout",this._ontooltipout);return this._super();}});var Z=[{n:L(2131,"Sum"),idx:1},{n:L(2122,"Average"),idx:2},{n:L(2127,"Minimum"),idx:3},{n:L(2125,"Maximum"),idx:4},{n:L(2123,"Count"),idx:5},{n:L(9938,"Count Distinct"),idx:6}];var g={SEPARATOR:-1,IN_LIST:0,NOT_IN_LIST:1,EXACTLY:2,NOT_EXACTLY:3,GREATER_THAN:4,LESS_THAN:5,GREATER_THAN_EQ:6,LESS_THAN_EQ:7,LIKE:8,NOT_LIKE:9,CONTAIN:10,NOT_CONTAIN:11,BEGIN_WITH:12,NOT_BEGIN_WITH:13,END_WITH:14,NOT_END_WITH:15,BETWEEN:16,NOT_BETWEEN:17},M={0:{did:2219,n:L(2219,"In list")},1:{did:2220,n:L(2220,"Not in list")},2:{did:520,n:L(520,"Exactly")},3:{did:612,n:L(612,"Not Exactly")},4:{did:521,n:L(521,"Greater than")},5:{did:523,n:L(523,"Less than")},6:{did:522,n:L(522,"Greater than equal")},7:{did:524,n:L(524,"Less than equal")},8:{did:525,n:L(525,"Like")},9:{did:526,n:L(526,"Not like")},10:{did:686,n:L(686,"Contains")},11:{did:2784,n:L(2784,"Does not contain")},12:{did:687,n:L(687,"Begins with")},13:{did:2785,n:L(2785,"Does not begin with")},14:{did:688,n:L(688,"Ends with")},15:{did:2786,n:L(2786,"Does not end with")},16:{did:"Between",n:L(696,"Between")},17:{did:"Not between",n:L(746,"Not between")}};var B=[g.IN_LIST,g.NOT_IN_LIST,g.SEPARATOR,g.EXACTLY,g.NOT_EXACTLY,g.SEPARATOR,g.GREATER_THAN,g.LESS_THAN,g.SEPARATOR,g.LIKE,g.NOT_LIKE],j=[g.IN_LIST,g.NOT_IN_LIST,g.SEPARATOR,g.EXACTLY,g.NOT_EXACTLY],Y=[g.GREATER_THAN,g.LESS_THAN,g.SEPARATOR,g.GREATER_THAN_EQ,g.LESS_THAN_EQ,g.SEPARATOR,g.BETWEEN,g.NOT_BETWEEN],n=[g.LIKE,g.NOT_LIKE,g.SEPARATOR,g.CONTAIN,g.NOT_CONTAIN,g.SEPARATOR,g.BEGIN_WITH,g.NOT_BEGIN_WITH,g.SEPARATOR,g.END_WITH,g.NOT_END_WITH];mstrmojo.qb.DBTableRowMenu=mstrmojo.declare(mstrmojo.Obj,null,{scriptClass:"mstrmojo.qb.DBTableRowMenu",menuCssClass:"mstrmojo-qb-DBTableRowMenu",menuCfg:null,tableRow:null,handleAddColumn:function W(u){var q=this.tableRow,w=[q],t,r=mstrApp.getRootController(),x;t=r.gettIndex(q.parent.parent.id);x={success:function(){q.updateState(1);q.count++;}};r.addSelectedColumns(w,t,null,x);return true;},handleAddExpression:function p(t){var r=this.tableRow,q=0;mstrApp.getRootController().openExpressionEditor({type:q,w:r,tkn:r.expr});return true;},handleAddAggrColumn:function G(w){var r=w.ctxt,q=this.tableRow,z=r.aggrFuncIdx,x=[q],u,t=mstrApp.getRootController(),AA;u=t.gettIndex(q.srcID);AA={success:function(){if(q.state==0||q.state==2){q.state++;q.images[1]=q.img[q.state];q.render();}q.count++;}};t.addSelectedColumns(x,u,z,AA);return true;},handleAddFuncExpr:function Q(t){var q=t.ctxt,r=this.tableRow;mstrApp.getRootController().openExpressionEditor({type:0,selFuncItem:q,w:r});},getSubMenuConfigComFuncs:function a(q){var r=new mstrmojo.ui.menus.MenuConfig(),u,t=this;u=function(w){t.handleAddAggrColumn(w);};f.forEach(Z,function(w){if(w.idx==6&&mstrApp.getRootController()&&mstrApp.getRootController().isBDE&&mstrApp.getRootController().isBDE==true){r.addDisabledMenuItem(w.n,"");}else{r.addMenuItem(w.n,"",u,{aggrFuncIdx:w.idx});}});return r;},getSubMenuConfigFuncs:function J(q){var t=new mstrmojo.ui.menus.MenuConfig(),z=this.id,u,w=this,r,x;u=function(AA){w.handleAddFuncExpr(AA);};if(!q){r=mstrApp.getRootController().getFunctionList();x=1;}else{r=q.funcList;x=q.depth;}f.forEach(r,function(AA){if(AA.n&&(AA.n.indexOf("Financial")>-1||AA.n.indexOf("Statistical")>-1)){return ;}if(AA.fns&&AA.fns.length){t.addSubMenuItem(AA.n,"depth"+x.toString(),z,this.getSubMenuConfigFuncs,{funcList:AA.fns,depth:x+1});}else{t.addMenuItem(AA.n,"",u,AA);}},this);return t;},handleAddFilter:function O(AD){var x=AD.ctxt,r=this.tableRow,q=x.opID,u=r.dt.tp,AA={14:true,15:true,16:true},AC={30:true},w={8:true,9:true,10:true,17:true,18:true,33:true},z,t,AB;mstrApp.getRootController().openConditionDialog();switch(q){case M[g.BETWEEN].did:case M[g.NOT_BETWEEN].did:AB=2;break;default:AB=1;}t="mstr-qb-fve";z=mstrmojo.all[t]||(new mstrmojo.qb.FilterValueEditor({id:t,zIndex:1000}));z.n=AD.n;z.operatorID=q;z.column=r.oriexpr;z.isDateTime=!!AA[u];z.isBigDecimal=!!AC[u];z.isString=!!w[u];z.paraNum=AB;z.open();},getSubMenuConfigClauses:function S(w,q){var r=new mstrmojo.ui.menus.MenuConfig(),t,z=this,x,u;t=function(AA){z.handleAddFilter(AA);};switch(w){case"common":u=B;break;case"basic":u=j;break;case"numeric":u=Y;break;case"string":u=n;break;}f.forEach(u,function(AA){if(AA===g.SEPARATOR){r.addSeparator();}else{x=M[AA];r.addMenuItem(x.n,"",t,{opID:x.did});}});return r;},getSubMenuConfigComClauses:function I(q){return this.getSubMenuConfigClauses("common",q);},getSubMenuConfigAllClauses:function P(q){var r=new mstrmojo.ui.menus.MenuConfig(),t=this.id;r.addSubMenuItem(L(7227,"Basic"),"",t,this.getSubMenuConfigAllClausesBasic,q);r.addSubMenuItem(L(13387,"Comparison"),"",t,this.getSubMenuConfigAllClausesNumeric,q);r.addSubMenuItem(L(12078,"Pattern"),"",t,this.getSubMenuConfigAllClausesString,q);return r;},getSubMenuConfigAllClausesBasic:function U(q){return this.getSubMenuConfigClauses("basic",q);},getSubMenuConfigAllClausesNumeric:function m(q){return this.getSubMenuConfigClauses("numeric",q);},getSubMenuConfigAllClausesString:function o(q){return this.getSubMenuConfigClauses("string",q);},getMenuConfig:function(){var r=this.menuCfg,w=this.id,q,t,u=this;if(!r){r=this.menuCfg=new mstrmojo.ui.menus.MenuConfig({menuCssClass:this.menuCssClass});}else{r.clear();}q=function(x){u.handleAddColumn(x);};t=function(x){u.handleAddExpression(x);};r.addMenuItem(L(7555,"Add Column"),"",q);if(u.tableRow.enableExpr){r.addMenuItem(L(13083,"Edit Column"),"",t);}r.addSeparator();r.addSubMenuItem(L(13084,"Basic Functions"),"",w,this.getSubMenuConfigComFuncs);r.addSubMenuItem(L(4561,"All Functions"),"",w,this.getSubMenuConfigFuncs);r.addSeparator();r.addSubMenuItem(L(12939,"Basic Filters"),"",w,this.getSubMenuConfigComClauses);r.addSubMenuItem(L(12940,"All Filters"),"",w,this.getSubMenuConfigAllClauses);return r;}});})();(function(){mstrmojo.requiresCls("mstrmojo.vi.ui.toolbars.Toolbar","mstrmojo.css");var D=mstrmojo.css;var B;mstrmojo.vi.ui.toolbars.TitleToolbar=mstrmojo.declare(mstrmojo.vi.ui.toolbars.Toolbar,null,{scriptClass:"mstrmojo.vi.ui.toolbars.TitleToolbar",init:function F(H){this._super(H);D.addWidgetCssClass(this,"mstrmojo-VITitleToolbar");},markupMethods:{onvisibleChange:function A(){var H=this.visible,I=this.domNode;D.toggleClass(I,"visible",H);if(!H){D.onTransitionEnd(I,function(){D.addClass(I,"hidden");});}else{D.removeClass(I,"hidden");}}},getItemMarkup:function E(H){if(!B){B=this._super(H).replace("{@en@n}",'<div class="icn"></div>');}return B;},ontoolbarCfgChange:function G(H){var I=H.value;if(I){if(I.showContextMenu){I.addMenuToolbarBtn("","mnu");}if(I.hasCloseButton){I.addToolbarBtn(I.closeButtonText,"cls",function(K,J){J.parent.close();});}}this._super(H);},onItemContextMenu:function C(H){this.closePopup();if(H.fn){H.fn(H,this);return true;}}});}());(function(){var H=mstrmojo.array,A={NONE:0,EDIT:1,DELETE:2};function E(L,J){var K=this.data,I=(K&&K.length)?K[0]:K;return(I&&I[L])?I[L](K,J):true;}mstrmojo.qb.menu.SimpleGridMenu=mstrmojo.declare(mstrmojo.Obj,null,{scriptClass:"mstrmojo.qb.menu.SimpleGridMenu",dynamicUpdate:true,queryEnabled:function G(I){return E.call(this,"isEnabled",I);},queryVisible:function D(I){return E.call(this,"isVisible",I);},queryChecked:function C(I){return E.call(this,"isChecked",I);},executeCommand:function B(J){var K=this.data,I=mstrApp.getRootController();switch(J.action){case A.EDIT:I.editColumn(K);break;case A.DELETE:I.deleteColumn(K);break;}},getMenuConfig:function F(I){var L=new mstrmojo.ui.menus.MenuConfig({menuCssClass:"mstrmojo-qb-simplegrid-menu"}),K=I||this.cm,J=this;H.forEach(K,function(N){if(this.queryVisible(N)){var M=["xt "+(N.icn||"")],O=function O(){J.executeCommand(N);};L.addMenuItem(N.n||"",M.join(" "),O);}},this);return L;},cm:[{action:A.EDIT,n:mstrmojo.desc(1088,"Edit"),icn:"edit"},{action:A.DELETE,n:mstrmojo.desc(629,"Delete"),icn:"del"}]});}());(function(){mstrmojo.requiresCls("mstrmojo.dom","mstrmojo.css","mstrmojo.string","mstrmojo.Widget","mstrmojo.ui.menus._HasMenuPopup","mstrmojo.mstr.EnumDSSXMLObjectTypes","mstrmojo.mstr.EnumDSSXMLObjectSubTypes","mstrmojo.ME.MetricDataService");mstrmojo.requiresDescs(3224);var Z=["(",")","{","}","-","+","*","/","<",">","|","~",","],I={" ":true,"@":true},Y=null,X=mstrmojo.dom,K=mstrmojo.css,H=mstrmojo.mstr.EnumDSSXMLObjectTypes,D=mstrmojo.mstr.EnumDSSXMLObjectSubTypes,a=mstrmojo.ME.MetricDataService;function O(f){if(!Y){Y={};var e,d;for(e=0,d=Z.length;e<d;e++){Y[Z[e]]=true;}}return Y.hasOwnProperty(f);}function b(f){if(!f){return false;}var d=f.length,e,g;for(e=0;e<d;e++){g=f.charAt(e);if(g==="["){return false;}if(O(g)||I[g]){return true;}}return false;}function A(c){return b(c)?"["+c+"]":c;}function M(g){if(!g){return null;}var c=g.length,f=g.split("["),e=f.length,j,h;if(e===1){return g.split("@");}else{if(e===3){j=f[1];j="["+j.substring(0,j.length-1);h="["+f[2];}else{if(f[0].length===0){var k=f[1],d=k.indexOf("]");j="["+k.substring(0,d+1);if(d===k.length-1){return[j];}else{h=k.substring(d+2);}}else{var k=f[0];j=k.substring(0,k.length-1);h="["+f[1];}}}return[j,h];}var R={8:true,9:true,10:true};var C=function(d,c){return R[d]&&!/^\".*\"$/.test(c)?'"'+c+'"':c;};var F=function(d,c,e){var f=typeof e==="undefined"?true:R[e];if(c.length===2&&c==='""'){return c;}return d.tp===261&&c.length>=2&&f?(/^\s+$/.test(c.substr(1,c.length-2))?c:c.substr(1,c.length-2)):c;};mstrmojo.ME.MetricToken=mstrmojo.declare(mstrmojo.Widget,[mstrmojo.ui.menus._HasMenuPopup],{data:null,markupString:'<span id={@id} class="mstrmojo-token {@cssClass}" mstrAttach:contextmenu></span>',active:false,markupMethods:{ondataChange:function(){var e=this.data,f=this.isEmbeddedFilter(),c=f?"&nbsp;":mstrmojo.string.encodeHtmlString(String(e.v));if(e.v===","){this.domNode.innerHTML=c+"&nbsp;";}else{if(e.tp===259&&e.v==="Desc"){this.domNode.innerHTML="&nbsp;"+c;}else{if(a.isLogicOrCompFunc(e)){this.domNode.innerHTML="&nbsp;"+c+"&nbsp;";}else{this.domNode.innerHTML=c;}}}K.toggleClass(this.domNode,["mstr"],this.isMstrO());K.toggleClass(this.domNode,["nfn"],!this.isFunction());K.toggleClass(this.domNode,["invalid"],e.sta===-1);K.toggleClass(this.domNode,["embeddedFilter"],f);},onactiveChange:function(){mstrmojo.css.toggleClass(this.domNode,["active"],this.active);}},oncontextmenu:function V(c){this.closePopup();if(this.isEmbeddedFilter()){var e=new mstrmojo.ui.menus.MenuConfig({position:X.getMousePosition(c.e,c.hWin),isHostedWithin:false,alignWithAnchor:true});var d=this;e.addMenuItem(mstrmojo.desc(3224,"Edit..."),"",function(){var f=d.parent;if(f&&f.editEmbeddedFilterToken){f.editEmbeddedFilterToken(d);}});this.openPopup(e.newInstance());}},isMstrO:function W(){return !!this.data.oi||!!this.data.rfd;},isFunction:function B(){return this.isMstrO()&&(this.data.oi&&this.data.oi.t===H.Function);},isEmbeddedFilter:function J(){var e=this.data.oi,d=e&&e.t,c=e&&e.st;return this.isMstrO()&&d===H.Filter&&c===D.Filter&&e.isEmbedded;},brackets:A,length:function E(){return this.isEmbeddedFilter()?1:this.data.v.toString().length;},isDelimiter:function U(){return this.data.isDelimiter||(this.length()===1&&O(this.data.v));},split2Tokens:function L(g){var f=this.data,e=f&&f.v.toString(),h=e.substring(0,g),c=e.substring(g);return[{v:h,isNew:true},{v:c,isNew:true}];},mergeTo:function N(e){var g=this.data,f=g&&g.v.toString(),c=e.data.v.toString();return{v:f+c,isNew:true};},brackets:A,setItemInfo:function S(c){var e=this.data;e.v=this.brackets(c.n);e.oi=c;e.sta=1;e.isNew=true;this.set("data",e);this.paint();},spliceContent:function P(k,h,e){var j=this.data,g=j&&j.v.toString(),l=g.substring(0,k);h=(h===null||h===undefined)?(g.length-k):h;var c=g.substring(k+h),f=l+(e||"")+c;j.v=f;j.isNew=true;j.sta=1;j.ift=(this.isAttributeToken()||j.at)&&(j.v.indexOf("@")>=0);if(j.ift){j.at=j.oi||j.at;}else{delete j.at;}delete j.oi;delete j.exv;delete j.extp;delete j.tp;this.set("data",j);this.paint();},isAttributeToken:function G(){return this.data&&this.data.oi&&this.data.oi.t===H.Attribute;},setFormInfo:function Q(e){var f=this.data,c=f.oi||f.at;f.v=this.brackets(c.n)+"@"+this.brackets(e.n);f.exv=e.did;f.extp=8;f.sta=1;f.isNew=true;f.oi=f.at;delete f.at;this.set("data",f);this.paint();}});mstrmojo.ME.MetricToken.isDelimiter=O;mstrmojo.ME.MetricToken.brackets=A;mstrmojo.ME.MetricToken.splitAttrAndAttrForm=M;mstrmojo.ME.MetricToken.quotes=C;mstrmojo.ME.MetricToken.unquotes=F;mstrmojo.ME.MetricToken.QUOTABLE_DATATYPES=R;mstrmojo.ME.MetricToken.argDelimiter={".":",",",":";"}[mstrConfig&&mstrConfig.decimalSep]||",";})();(function(){mstrmojo.requiresCls("mstrmojo.Container","mstrmojo.ui.menus._HasMenuPopup","mstrmojo.vi._MonitorsAppState","mstrmojo.vi._MonitorsLayoutMode","mstrmojo._HasOwnAvatar","mstrmojo.vi.ui._IsDropTarget","mstrmojo.EditableLabel","mstrmojo.ui.menus.MenuConfig","mstrmojo.css");var A=mstrmojo.css,N=mstrmojo.dom,M="draggedTab",J="stopDragging",m=1,L=2,q=4,G=8,l=16;function n(r){return function(){A.toggleClass(this.tabStripMenuNode,"active",r);};}function h(AE){var z=new mstrmojo.ui.menus.MenuConfig({supportsScroll:true,maxHeight:N.getMaxScrollHeight()}),r=this.getMenuActions(),AC=this.index,u=this.id,w=this.total,AA=this.parent,t=function(){var AF=AA&&AA.getTabs();return AF&&AF.length>AC?AF[AC]:mstrmojo.all[u];};if((r&l)>0){this.addNewTabMenuItem(z);}if((r&q)>0){var AB=mstrmojo.desc(3397,"Duplicate"),AD=this.parent.scriptClass;if(AD.indexOf("LayoutTabStrip")>=0){AB=mstrmojo.desc(15022,"Duplicate Chapter");}else{if(AD.indexOf("PanelTabStrip")>=0){AB=mstrmojo.desc(14923,"Duplicate Page");}}z.addMenuItem(AB,"dup",function(){t().tabDuplicated();});}if((r&L)>0){if(AC){z.addMenuItem(mstrmojo.desc(5362,"Move Left"),"lft",function(){t().tabMoved(true);});}if(AC<w-1){z.addMenuItem(mstrmojo.desc(5363,"Move Right"),"rgt",function(){t().tabMoved(false);});}}z.addSeparator();if((r&m)>0){z.addMenuItem(mstrmojo.desc(1388,"Rename"),"rnm",function(){t().lbl.set("isEditing",true);});}if((r&G)>0){if(w>1){z.addMenuItem(mstrmojo.desc(629,"Delete"),"cls",function(){t().tabDeleted();});}}var x=this.getCustomMenu();if(x&&x.hasMenuItems()){z.addSeparator();z.absorbMenuItems(x);}z.addPopupHandlers(this.id,n(true),n(false));this.showTabMenu(this.updateMenuCfg(z),AE);}mstrmojo.vi.ui.tabs.Tab=mstrmojo.declare(mstrmojo.Container,[mstrmojo.ui.menus._HasMenuPopup,mstrmojo._HasOwnAvatar,mstrmojo.vi.ui._IsDropTarget,mstrmojo.vi._MonitorsAppState,mstrmojo.vi._MonitorsLayoutMode],{scriptClass:"mstrmojo.vi.ui.tabs.Tab",markupString:'<div id="{@id}" class="mstrmojo-VITab unselectable {@cssClass}" style="{@cssText}" unselectable="on" mstrAttach:contextmenu,click><div><div class="mstrmojo-VITab-tab"></div><div class="mstrmojo-VITab-menu"></div></div></div>',markupSlots:{containerNode:function S(){return this.domNode.firstChild.firstChild;},menuBtnNode:function p(){return this.domNode.firstChild.lastChild;}},markupMethods:{ontitleChange:function I(){this.lbl.set("text",this.title);},onisSelectedChange:function j(){mstrmojo.css.toggleClass(this.domNode,"selected",this.isSelected);},onzIndexChange:function k(){this.domNode.style.zIndex=this.zIndex;}},zIndex:1,menuBtnNode:null,lbl:null,title:"",index:-1,total:-1,isSelected:false,isCutoff:false,isHidden:false,isLeftMost:false,isRightMost:false,leftEdgeHiddenWidth:0,rightEdgeHiddenWidth:0,children:[{scriptClass:"mstrmojo.EditableLabel",alias:"lbl",editOnClick:false,onTextEditComplete:function W(t,r){if(t){this.parent.titleEdited(this.text,r);}}}],postBuildRendering:function Q(){var r=this.isValidMode();if(!r||(mstrApp.isLayoutModePreview&&mstrApp.isLayoutModePreview())){this.draggable=false;}this.lbl.set("editOnDoubleClick",r);this._super();},oncontextmenu:function b(r){this.onclick(r);r.preventDefault();},onclick:function e(r){var u=this.domNode;if(A.hasClass(u,J)){A.removeClass(u,J);return ;}var t=function(){if(this.isValidMode()){this.postTabClicked(this,r);}};if(!this.isSelected){this.tabSelected({success:t.bind(this)});}else{t.call(this);}},postTabClicked:function o(w,t){w=this.findSelectedTab(this)||w;var r=w.menuBtnNode,x=t.getTarget().className===r.className,u;if(x){u=N.position(r);}if(t.name==="contextmenu"||(x&&!(u.x||u.y))){u={x:t.e.clientX,y:t.e.clientY};}if(u){h.call(w,u);}},getMenuActions:function d(){return 0;},getCustomMenu:function Y(){return null;},isDragValid:function R(){return this.parent.children.length>1&&!this.lbl.isEditing&&this.isValidMode();},createAvatar:function U(){var r=document.createElement("div");r.appendChild(this.domNode.cloneNode(true));r.style.margin="-5px 0 0 10px";return r;},addTabDnDStyle:function X(){var r=this.lbl.domNode;if(r&&!this.isSelected){A.addClass(r,M);}},clearTabDnDStyle:function F(){var r=this.lbl.domNode;if(r&&!this.isSelected){A.removeClass(r,M);}},allowDrop:function D(r){var t=r.src.widget;return t&&t.parent===this.parent;},dropTab:function K(r){var w=r.src,u=w.data,t=w.widget;t.clearTabDnDStyle();this.parent.moveTab(u.idx,this.index,u.fromIdx);},ondragenter:function H(t){this._super(t);var w=t.src.data,u=t.src.widget,r=this.index;this.parent.moveTab(w.idx,r);w.idx=r;},ondragover:function a(u){var r=u.tgt.node,t=u.tgtData,w=t&&t.node,x=u.src.widget;if(!t||w!==r){u.tgtData={node:r};}if(x&&!x.isSelected){x.addTabDnDStyle();}},ondragleave:function P(r){this._super(r);var t=r.src.widget;if(t&&!t.isSelected){t.addTabDnDStyle();}},ondragend:function C(r){this._super(r);A.addClass(this.domNode,J);this.dropTab(r);},getDragData:function c(){var u=this.id,r=this.index;return{setAvatarClass:function t(w){var AA=mstrmojo.all[u],x=AA.avatar;if(x){var z=[AA.avatarCssClass,"hasOwnAvatar",w];x.className=z.join(" ");}},fromIdx:r,idx:r};},getDropAvatarIcon:function B(){return"pivot";},isValidMode:function E(){return !((mstrApp.isAppStatePresentation&&mstrApp.isAppStatePresentation())||(mstrApp.isAppStateSelection&&mstrApp.isAppStateSelection())||(mstrApp.allowWebDashboardDesign&&!mstrApp.allowWebDashboardDesign()));},cleanUpAfterTarget:function f(r){this.clearTabDnDStyle();this._super(r);},onAppStateChange:function g(t){var w=this.lbl,u=this.isValidMode(),r=mstrApp.isLayoutPreview(t.value);w.set("isEditing",false);w.set("editOnDoubleClick",u);this.draggable=u&&!r;},onLayoutModeChange:function O(t){var u=this.isValidMode(),r=mstrApp.isLayoutPreview(t.value);this.draggable=u&&!r;},addNewTabMenuItem:function V(r){this.throwAbstractMethodError("addNewTabMenuItem");},findSelectedTab:mstrmojo.emptyFn,tabSelected:mstrmojo.emptyFn,titleEdited:mstrmojo.emptyFn,tabMoved:mstrmojo.emptyFn,tabDeleted:mstrmojo.emptyFn,tabDuplicated:mstrmojo.emptyFn,showTabMenu:mstrmojo.emptyFn,updateMenuCfg:function Z(r){return r;}});mstrmojo.vi.ui.tabs.Tab.ACTIONS={NEW_TAB:l,RENAME:m,MOVE:L,DUPLICATE:q,DELETE:G};}());(function(){mstrmojo.requiresCls("mstrmojo.Widget","mstrmojo.string","mstrmojo.dom","mstrmojo.css","mstrmojo.ui.menus._HasMenuPopup","mstrmojo.ui.menus.MenuConfig");var D=mstrmojo.string,A=mstrmojo.dom,E=mstrmojo.ui.PopupConfig.ENUM_CORNERS;function B(){var K=this,J=K.statusList,F=J&&J.length||0,G=K.statusConfig||new mstrmojo.ui.menus.MenuConfig(),L=function(M){return function(N){K.set("status",M);K.onStatusClick(M);};};if(!G.hasMenuItems()&&F){for(var H=0;H<F;H++){var I=J[H];G.addMenuItem(I.n,I.cls||"",L(I),K);}}else{}if(G.hasMenuItems()){G.alignment=K.alignment||{host:E.BOTTOM_LEFT,popup:E.TOP_LEFT};G.hostId=K.id;G.hostElement=K[K.hostElementName]||K.domNode;K.openPopup(G.newInstance());}}function C(){var F=this.statusConfig||this.statusList&&this.statusList.length>1;this.menuButtonNode.style.display=F?"":"none";}mstrmojo.ui.StatusButton=mstrmojo.declare(mstrmojo.Widget,[mstrmojo.ui.menus._HasMenuPopup],{scriptClass:"mstrmojo.ui.StatusButton",markupString:'<div id="{@id}" class="mstrmojo-StatusButton {@cssClass} {@iconClass}" title="{@title}" style="{@cssText}"><div class="mstrmojo-Button {@innerIconClass}"  mstrAttach:click><span class="mstrmojo-text"></span></div><div class="menuButton" mstrAttach:click></div></div>',markupSlots:{textNode:function(){return this.domNode.firstChild;},textSpanNode:function(){return this.domNode.firstChild.firstChild;},menuButtonNode:function(){return this.domNode.lastChild;}},markupMethods:{onvisibleChange:mstrmojo.Widget.visibleMarkupMethod,onstatusChange:function(){this.textSpanNode.innerHTML=D.encodeHtmlString(this.status&&this.status.n||"");},onstatusListChange:function(){C.call(this);},onstatusConfigChange:function(){C.call(this);}},status:null,statusList:null,statusConfig:null,onclick:function(F){var G=A.eventTarget(F.hWin,F.e);if(A.contains(this.menuButtonNode,G,true)){B.call(this);}else{if(A.contains(this.textNode,G,true)){this.onButtonClick(this.status,F);}}},onButtonClick:mstrmojo.emptyFn,onStatusClick:mstrmojo.emptyFn});}());(function(){mstrmojo.requiresCls("mstrmojo.func","mstrmojo.ui.menus.MenuConfig");var A=mstrmojo.func,J=mstrmojo.desc(2177,"Close");function G(L){return function(N,M){M.openMenu(L,N);};}mstrmojo.ui.menus.ToolbarConfig=mstrmojo.declare(mstrmojo.ui.menus.MenuConfig,null,{scriptClass:"mstrmojo.ui.menus.ToolbarConfig",btns:null,hasCloseButton:false,closeButtonText:J,showContextMenu:true,addCloseButton:function E(L){this.hasCloseButton=true;if(L){this.closeButtonText=L;}},preShowMenu:mstrmojo.emptyFn,addToolbarBtn:function I(R,M,P,L,N,Q){var O={n:R,cls:M,fn:P,ctxt:L,ttp:Q};if(isNaN(N)||N>=this.btns.length){this.btns.push(O);}else{this.btns.splice(N,0,O);}return O;},addDisabledToolbarBtn:function I(O,M,L){var N=this.addToolbarBtn(O,(M||"")+" disabled",mstrmojo.emptyFn,L);N.dsbld=true;},addToolbarPickerBtn:function B(R,M,P,Q,L,N){var O={n:R,cls:M,fn:P,ctxt:L,tp:"pb",menufn:G(Q||this)};if(isNaN(N)||N>=this.btns.length){this.btns.push(O);}else{this.btns.splice(N,0,O);}},addMenuToolbarBtn:function H(P,L,O,M,N){if(!O&&!this.hasMenuItems()){return ;}this.addToolbarBtn(P,L,A.composite([this.preShowMenu,G(O||this),(N||mstrmojo.emptyFn)]),null,M);},addToggleToolbarButton:function D(S,O,Q,N,M,R,L){var P=this.getToggleItemStates(S,O,Q,N,R,L);this.addDualStateItem(M,P[0],P[1],true);},addDualStateItem:function K(M,L,N,O){this["add"+(O?"ToolbarBtn":"MenuItem")](L.n,L.cls,this.getDualStateHandler(M,L,N),L.ctxt,undefined,L.ttp);},getDualStateHandler:function C(M,L,N){var O=this._super(M,L,N);return function(P,Q){O.call(this,P,Q);Q.refresh();};},clear:function F(){this.btns=[];this.hasCloseButton=false;this.closeButtonText=J;this._super();}});}());(function(){mstrmojo.requiresCls("mstrmojo.Stepper","mstrmojo._HasLayout","mstrmojo.ui.editors.controls.ValidationTextBox","mstrmojo.expr","mstrmojo.css");var C=mstrmojo.expr.DTP,B=mstrmojo.css,A="mstrmojo-Stepper-ErrValidation";mstrmojo.ui.editors.controls.Stepper=mstrmojo.declare(mstrmojo.Stepper,[mstrmojo._HasLayout],{scriptClass:"mstrmojo.ui.editors.controls.Stepper",markupString:'<div id="{@id}" class="mstrmojo-Stepper {@orientation} {@cssClass}" mstrAttach:click,mousedown,mouseup,mousemove,selectstart><div class="title">{@title}</div><div class="next">+</div><div class="text"></div><div class="prev">-</div></div>',layoutConfig:{w:{textNode:"100%"},xt:true},textInput:null,init:function E(F){var G=F.provider;if(!!mstrApp.isWSStyling){this.layoutConfig=null;}this.children=[{scriptClass:"mstrmojo.ui.editors.controls.ValidationTextBox",alias:"textInput",slot:"textNode",dtp:G.dtp||C.INTEGER,maxLength:G.maxLength,constraints:{validator:G.validator,max:G.max,min:G.min},onValid:function(){var H=this.parent;B.removeClass(H.domNode,A);G.setVal(parseInt(this.value,10)||0);H.updateDisplayText();}}];this._super(F);this.addDisposable(G);B.addWidgetCssClass(this,"mstrmojo-ui-ctrl-Stepper");},postBuildRendering:function(){this.updateDisplayText();this._super();},updateDisplayText:function D(){this.textInput.set("value",this.provider.getVal());}});}());(function(){mstrmojo.requiresCls("mstrmojo.Editor","mstrmojo.TextBox","mstrmojo.Button","mstrmojo.HBox","mstrmojo.EnumAuthenticationModes","mstrmojo.UsherLogin","mstrmojo.string","mstrmojo.cookies");mstrmojo.requiresDescs(17,18,221,11804,11863);var F=mstrmojo.EnumAuthenticationModes,D={};D[F.LDAP]=mstrmojo.desc(1947,"LDAP Authentication");D[F.DATABASE]=mstrmojo.desc(1948,"Database Authentication");var L={LIVE_OR_HL:0,PERSISTED:1};function B(){return(JSON.parse(decodeURIComponent(mstrmojo.cookies.getCookieSetting("lastMsgID")||"{}")))[mstrConfig.lastMsgKey];}function C(){var Q=this,R=Q.stdLoginInfo,O=R.user.value,N=R.tsvCode.value,S=R.pwd.value,U={taskId:"login",server:mstrConfig.serverName,project:mstrmojo.string.decodeHtmlString(mstrConfig.projectName),port:mstrConfig.serverPort,authMode:mstrConfig.authMode,setAsActiveSession:true};var P=B();if(P){U.msgID=P;}if((this.authMode&(F.STANDARD|F.LDAP|F.DATABASE))>0){U.userid=O;U.password=S;U.tsvCode=N;}mstrmojo.xhr.request("POST",mstrConfig.taskURL,{success:function(X){if(X&&X.sessionState){mstrApp.updateSessionState(X.sessionState);if(mstrApp.sessionManager){mstrApp.sessionManager.restart();}var a=X;var Z=a.servletState;if(Z){if(mstrApp){mstrApp.servletState=Z;}if(mstrConfig){mstrConfig.servleState=Z;}}var W=X.resCode;if(W==L.LIVE_OR_HL&&(mstrApp.isVI||mstrApp.scriptClass==="mstrmojo.OIVMApp"||mstrApp.analysisID)){mstrmojo.xhr.request("post",mstrConfig.taskURL,{success:function(){var b=Q.config.callback,c=b.success;if(c){c(a);}},failure:function(){mstrmojo.form.send({evt:3010,src:mstrApp.name+".3010"},null,"POST");}},{taskId:"docXMLResults",sessionState:X.sessionState,msgID:X.msgID,resultFlags:33554432});}else{var V=Q.config.callback,Y=V.success;if(Y){Y(a);}}}Q.destroy();},failure:function(V){if(Q.authMode===mstrmojo.EnumAuthenticationModes.NTCREDENTIAL){Q.set("visible",true);}mstrmojo.alert(V.getResponseHeader("X-MSTR-TaskFailureMsg"),null,null,Q.zIndex);}},U);}function M(){if(mstrApp.sessionManager){mstrApp.sessionManager.gotoLogoutPage();}}mstrmojo.LoginEditor=mstrmojo.declare(mstrmojo.Editor,null,{scriptClass:"mstrmojo.LoginEditor",cssClass:"mstrmojo-LoginEditor",title:mstrmojo.desc(11804,"Log in to"),btnAlignment:"right",help:null,config:{callback:{},taskParams:{}},authMode:F.STANDARD,usherEnabled:false,init:function K(N){this._super(N);this.title+=" "+mstrApp.projectName;this.set("authMode",parseInt(mstrConfig.authMode,10));if(this.isUsherLogin()){mstrmojo.css.addWidgetCssClass(this,"usher");}},isUsherLogin:function(){return this.authMode===F.USHER;},onvisibleChange:function J(){if(this.visible&&(mstrmojo.dom.isFF||mstrmojo.dom.isWK)){var N=this.stdLoginInfo.user;window.setTimeout(function(){N.focus();},50);}},onOpen:function E(){if(this.authMode===mstrmojo.EnumAuthenticationModes.NTCREDENTIAL){this.set("visible",false);}},onClose:function G(){M();},destroy:function I(){mstrmojo.dom.detachEvent(document.body,"mousedown",this.stopPropagation,true);this._super();},postBuildRendering:function A(){if(this.authMode===mstrmojo.EnumAuthenticationModes.NTCREDENTIAL){C.call(this);return ;}else{var N=this._super();this.stopPropagation=function(O){O.stopPropagation();};mstrmojo.dom.attachEvent(document.body,"mousedown",this.stopPropagation,true);return N;}},preBuildRendering:function H(){if(this.isUsherLogin()){var O=this,N=mstrmojo.insert({scriptClass:"mstrmojo.UsherLogin",alias:"usherLogin",onUsherLogin:function(){mstrConfig.authMode=F.USHER;C.call(O);}});this.addChildren([N],1);}return this._super();},children:[{scriptClass:"mstrmojo.Label",cssText:"margin-bottom: 20px; line-height: 1.5em;",text:mstrmojo.desc(11863,"Your user session has timed out due to inactivity, and you have been automatically logged out. Please log in again.")},{scriptClass:"mstrmojo.Box",alias:"stdLoginInfo",cssClass:"std-login-container",bindings:{visible:function(){return this.parent.authMode!==F.USHER;}},children:[{scriptClass:"mstrmojo.TextBox",alias:"user",cssClass:"login-username",cssDisplay:"block",hint:mstrmojo.desc(17,"User name"),postCreate:function(){if(mstrmojo.dom.isIE9||mstrmojo.dom.isIE8||mstrmojo.dom.isIE7){this.emptyText=mstrmojo.desc(17,"User name");}},onEnter:function(){C.call(this.parent.parent);}},{scriptClass:"mstrmojo.TextBox",alias:"pwd",cssClass:"login-pwd",cssDisplay:"block",hint:mstrmojo.desc(18,"Password"),type:"password",postCreate:function(){if(mstrmojo.dom.isIE9||mstrmojo.dom.isIE8||mstrmojo.dom.isIE7){this.emptyText=mstrmojo.desc(18,"Password");}},onEnter:function(){C.call(this.parent.parent);}},{scriptClass:"mstrmojo.TextBox",alias:"tsvCode",cssClass:"login-tsvCode",cssDisplay:"block",hint:mstrmojo.desc(13825,"Usher code"),bindings:{visible:function(){return mstrConfig.features["is-two-step-verification-required"];}},postCreate:function(){if(mstrmojo.dom.isIE9||mstrmojo.dom.isIE8||mstrmojo.dom.isIE7){this.emptyText=mstrmojo.desc(13825,"Usher code");}},onEnter:function(){C.call(this.parent.parent);}},{scriptClass:"mstrmojo.Label",cssClass:"mstrmojo-LoginEditor-authMode",bindings:{visible:function(){return this.parent.parent.authMode===F.LDAP||this.parent.parent.authMode===F.DATABASE;},text:function(){return D[this.parent.parent.authMode]||"";}}}]},{scriptClass:"mstrmojo.HBox",slot:"buttonNode",alias:"btns",cssClass:"mstrmojo-Editor-buttonBar",children:[{scriptClass:"mstrmojo.Button",cssClass:"mstrmojo-Button mstrmojo-WebButton hot",text:mstrmojo.desc(26,"Login"),bindings:{enabled:"this.parent.parent.stdLoginInfo.user.value.length > 0",visible:function(){return this.parent.parent.authMode!==F.USHER;}},onclick:function(){C.call(this.parent.parent);}},{scriptClass:"mstrmojo.Button",cssClass:"mstrmojo-Button mstrmojo-WebButton",text:mstrmojo.desc(221,"Cancel"),onclick:function(){M();}}]}]});}());(function(){mstrmojo.requiresCls("mstrmojo.dom","mstrmojo.Dialog","mstrmojo.Button","mstrmojo.HTMLButton","mstrmojo.Label","mstrmojo.form","mstrmojo.LoginEditor");mstrmojo.requiresDescs(2699,7773,11812,11865,13380,13381,13382);var D=mstrmojo.desc(13382,"Your user session will time out due to inactivity in # ##."),S=60,M=false,G=null,A=null,H=null;function N(){return mstrApp.sessionState||window.microstrategy&&microstrategy.sessionState;}function K(W,V){if(mstrApp.is508){for(var U in V){W.setAttribute(U,V[U]);}}}mstrmojo.SessionManager=mstrmojo.declare(mstrmojo.Editor,null,{scriptClass:"mstrmojo.SessionManager",cssClass:"mstrmojo-SessionManager",width:"370px",title:mstrmojo.desc(11812,"Notification"),msgInterval:1,checkSessionInterval:20,zIndex:10000,maxSessionIdleTime:600,timeBeforeSessionTimeoutWarning:60,remainingTime:60,sessionTimedout:false,buttons:[mstrmojo.Button.newWebButton(mstrmojo.desc(13381,"Stay logged in"),function(){var U=this.parent.parent;if(A){U.keepSessionAlive();}U.hideMessage();},true,{onRender:function(){K(this.domNode,{tabindex:0,role:"button","aria-label":mstrmojo.desc(13381,"Stay logged in")});}}),mstrmojo.Button.newWebButton(mstrmojo.desc(13380,"Log out"),function(){this.parent.parent.hideMessage();mstrmojo.form.send({evt:3019,src:mstrApp.name+".3019"});},null,{onRender:function(){K(this.domNode,{tabindex:0,role:"button","aria-label":mstrmojo.desc(13380,"Log out")});}})],children:[{scriptClass:"mstrmojo.Label",alias:"message",cssClass:"mstrmojo-SessionManager-msg",text:"",allowHTML:true,ontextChange:function(){if(mstrApp.is508){this.refresh();var U=this.domNode;K(U,{tabindex:-1,role:"alert"});window.setTimeout(function(){U.focus();},0);}}}],postBuildRendering:function(){this._super();if(mstrApp.is508){this.msgInterval=10;K(this.editorNode,{role:"alertdialog",tabindex:-1});}},updateMsg:function B(V){var U;if(V>60){U=D.replace("##",mstrmojo.desc(2699,"minutes")).replace("#","<b>"+Math.ceil(V/S)+"</b>");}else{if(V>-1){U=D.replace("##",mstrmojo.desc(7773,"seconds")).replace("#","<b>"+V+"</b>");}else{U=mstrmojo.desc(11865,"Your session is expired.");}}this.message.text="";this.message.set("text",U);this.remainingTime=V;},showMessage:function F(U){this.updateMsg(U);this.set("visible",true);M=true;},hideMessage:function I(){if(A){window.clearInterval(A);A=null;window.clearInterval(H);H=null;}this.set("visible",false);M=false;},popupTimeoutWarning:function L(Y){if(M){return ;}var W=this,X=(typeof Y==="number")?Y:W.timeBeforeSessionTimeoutWarning,U=X,V=mstrmojo.now();if(mstrApp.enableWarningSessionTimeout){if(!this.hasRendered){this.render();}this.showMessage(U);}window.clearInterval(A);A=window.setInterval(function(){if(U<1){window.clearInterval(A);A=null;window.clearInterval(H);H=null;window.setTimeout(function(){if(mstrApp.enableWarningSessionTimeout){W.gotoLogoutPage();}else{W.sessionTimedout=true;W.closeSession();}},200);}var Z=Math.round((mstrmojo.now()-V)/1000);U=X-Z;W.updateMsg(U);},this.msgInterval*1000);window.clearInterval(H);H=window.setInterval(function(){W.isSessionAlive();},this.checkSessionInterval*1000);},warningTimeoutTimer:function Q(U){var V=this;window.clearTimeout(G);G=window.setTimeout(function(){G=null;V.isSessionAlive();},(U-this.timeBeforeSessionTimeoutWarning)*1000);},isSessionAlive:function E(){var U=this,W={success:function(X){var Y=parseInt(X,10);if(Y!==-1){if(Y>U.remainingTime){U.hideMessage();}if(Y>U.timeBeforeSessionTimeoutWarning){U.warningTimeoutTimer(Y);}else{U.popupTimeoutWarning(Y);}}else{window.clearInterval(H);U.popupTimeoutWarning(0);}},failure:function(){mstrmojo.alert("Problems encountered during checking for whether session is alive. Connection is down or session already time out.");}},V={taskId:"isSessionAlive",notRestartSessionManager:true};mstrmojo.xhr.request("POST",mstrConfig.taskURL,W,V);},keepSessionAlive:function R(){var U=this,W={success:function(X){if(X){U.warningTimeoutTimer(U.maxSessionIdleTime);}else{U.sessionTimedout=true;mstrmojo.alert("Your session is expired.");}},failure:function(){mstrmojo.alert("Problems encountered during activating session. Connection is down or session already time out.");}},V={taskId:"keepSessionAlive"};mstrmojo.xhr.request("POST",mstrConfig.taskURL,W,V);},closeSession:function J(){var U=this;mstrmojo.xhr.request("POST",mstrConfig.taskURL,{success:function(){U.sessionTimedout=true;}},{taskId:"closeSessions",sessionStates:N(),notRestartSessionManager:true});},restart:function(){this.sessionTimedout=false;this.hideMessage();if(this.maxSessionIdleTime>this.timeBeforeSessionTimeoutWarning){this.warningTimeoutTimer(this.maxSessionIdleTime);}},start:function C(){var W=mstrConfig.lastMsgKey;if(this.maxSessionIdleTime>this.timeBeforeSessionTimeoutWarning){this.warningTimeoutTimer(this.maxSessionIdleTime);}var V=function(){window.localStorage.setItem("msg_recovery_notify"+W,1);};if(window.addEventListener){window.addEventListener("beforeunload",V);}else{window.attachEvent("onbeforeunload",V);}var U=window.sessionStorage;if(U){U.setItem("msg_browser_not_closed"+W,1);U.setItem("msg_user_login",0);}},openLoginEditor:function P(W){if(window.mstrmobile&&window.mstrmobile.onSessionExpired){window.mstrmobile.onSessionExpired();return ;}var V="LoginEditor",U=mstrmojo.all[V];if(!U){U=mstrmojo.insert({id:V,scriptClass:"mstrmojo.LoginEditor",config:{callback:{}},zIndex:10000});}U.config.callback=W;U.open();},gotoLogoutPage:function O(){mstrmojo.form.send({evt:3008,src:mstrApp.name+".3008",autoLoggedout:true,Server:mstrConfig.serverName,Port:mstrConfig.serverPort,Project:mstrmojo.string.decodeHtmlString(mstrConfig.projectName),loginReq:true},null,"POST");}});}());(function(){mstrmojo.requiresCls("mstrmojo.publisher","mstrmojo.Widget","mstrmojo.fx","mstrmojo.locales","mstrmojo.expr","mstrmojo.Button","mstrmojo.date","mstrmojo.ui.editors.controls.Stepper","mstrmojo.css");var AF=function(){return mstrmojo.locales.datetime;},k=mstrmojo.dom,j=mstrmojo.expr,AC=j.DTP,a=mstrmojo.date,J=mstrmojo.publisher,f=mstrmojo.hash,m=mstrmojo.array,N=m.removeIndices,l=mstrmojo.css;var AE=0,C=3,M=4,p=5,Q=6;var AG="month",d="day",W="year",Y="hour",AJ="minute",z="second";var G='<table border="0" cellpadding="0" cellspacing="0">',x="</table>";function O(AK){return'<table border="0" cellpadding="0" cellspacing="0" style="'+AK+'">';}function H(AN,AK,AL){var AM=a.getFirstDateOfMonth(AN,AK);return(AM.getDay()-AL+8)%7;}function n(AN){var AM=a.parseDateAndOrTime(AN),AO,AK,AL;if(AM){AL={};AO=AM.date;AK=AM.time;if(AO){f.copy(AO,AL);}if(AK){f.copy(AK,AL);}}return AL;}function F(AL,AO,AN,AM,AK){var AP=a.formatDateInfo({day:AL,month:AO,year:AN},AF().DATEOUTPUTFORMAT);return a.inDateTimeRange(AP,AM,AK)===0;}function U(AO,AN,AM){var AL=AO.decreaseButton,AK=AO.increaseButton,AP="mstrmojo-Calendar";AL.className=(AP+"-decrease");AK.className=(AP+"-increase");}function X(AO,AL,AQ,AN){var AM=0,AK=AO.length,AP;for(AM=0;AM<AK;AM++){AP=AO[AM];if(AP&&AP.day===AL&&AP.month===AQ&&AP.year===AN){return AM;}}return -1;}function q(AK,AM,AL){var AN=new Date();return(AN.getFullYear()===AL)&&((AN.getMonth()+1)===AM)&&(AN.getDate()===AK);}function w(AR,AS){var AW=AR.dayView.getElementsByTagName("div"),AU=AR.selectedDates,AM=AU[AS],AV=AR.browseYear,AL=AR.browseMonth,AO=a.getDaysOfMonth(AV,AL),AN=a.getPreMonth(AV,AL),AQ=a.getDaysOfMonth(AN.y,AN.m),AK=H(AV,AL,AR.firstDayOfWeek),AP=((AM.month===AL)?AM.day+AK-1:(AM.month>AL?AM.day+AK+AO-1:AK-AQ+AM.day-1)),AT=AW[AP];if(AT){c(AT,AR,false);}N(AU,AS,1);}function B(AK){var AL=AK.selectedDates;while(AL.length){w(AK,0);}}function AI(AM,AK){var AL=K(AM,AK),AN=AM.selectedDates;AN.push({day:AL.d,month:AL.m,year:AL.y});c(AK,AM,true);}function o(AM,AN){if(!AN||!AN.length){return null;}var AP=AM.selectedDates;for(var AL=0,AK=AN.length;AL<AK;AL++){var AO=AN[AL],AQ=r(AM,AO);AP.push({day:AO.d,month:AO.m,year:AO.y});if(AQ){c(AQ,AM,true);}}}function r(AS,AU){var AW=AS.dayView.getElementsByTagName("div"),AN=AW.length,AV=AS.browseYear,AL=AS.browseMonth,AO=a.getPreMonth(AV,AL),AP=a.getDaysOfMonth(AO.y,AO.m),Aa=a.getNextMonth(AV,AL),AM=a.getDaysOfMonth(AV,AL),AK=H(AV,AL,AS.firstDayOfWeek);var AQ=AK>0?{y:AO.y,m:AO.m,d:AW[0].innerHTML}:{y:AV,m:AL,d:AW[0].innerHTML},AY=(AW.length-AM-AK)>0?{y:Aa.y,m:Aa.m,d:AW[AN-1].innerHTML}:{y:AV,m:AL,d:AW[AN-1].innerHTML},AZ=S(AQ,AU),AR=S(AU,AY),AT=null;if(AZ>=0&&AR>=0){var AX=0;if(AZ<AK){AX=-1;}if(AR<(AW.length-AK-AM)){AX=1;}AT=((AX===0)?AU.d+AK-1:(AX===1?AU.d+AK+AM-1:AK-AP+AU.d-1));return AW[AT];}else{return null;}}function g(AS,AK){var AU=AS.selectedDates,AM=AU.length;if(!AM){return null;}var AL=AU[AM-1],AN=K(AS,AK),AX=S({y:AL.year,m:AL.month,d:AL.day},AN),AY=[],AP=AX>0,AV=Math.abs(AX);for(var AR=0;AR<=AV;AR++){var AQ=new Date(AN.y,AN.m-1,AN.d);AQ.setDate(AQ.getDate()+(AP?-AR:AR));var AW=AQ.getFullYear(),AO=AQ.getMonth()+1,AT=AQ.getDate();if(AS.isDateDisabled(AT,AO,AW,AS.min,AS.max)&&!AS.canSelectDisabledDate){continue;}AY.push({y:AW,m:AO,d:AT});}return AY;}function S(AN,AM){var AK=new Date(AN.y,AN.m-1,AN.d),AL=new Date(AM.y,AM.m-1,AM.d);return(AL-AK)/1000/3600/24;}function K(AM,AK){var AN=AM.browseYear,AP=AM.browseMonth,AO=parseInt(AK.innerHTML,10),AQ=parseInt(AK.getAttribute("m"),10),AL=null;AL=(AQ===0)?{y:AN,m:AP}:(AQ===1?a.getNextMonth(AN,AP):a.getPreMonth(AN,AP));AL.d=AO;return AL;}function h(AK){var AM=AK.selectedDates,AL=AM.length;return(AL===0)?null:AM[AL-1];}function c(AL,AM,AK){var AN=AM.selectedColor;l.toggleClass(AL,["selected",AM.selectedCssStyle],AK);AL.parentNode.style.backgroundColor=AK?AN:"";AL.style.backgroundColor=AK?AN:"";}function AB(AK){return AK.selectedColor?('style="background-color:'+AK.selectedColor+';"'):"";}function P(AK){return(AK.tagName.toLowerCase()==="td")?AK.firstChild:AK;}function R(AL,AM){var AN=a.getDateJson(AL),AK=a.formatDateInfo(AN,mstrmojo.locales.datetime.DATEOUTPUTFORMAT);if(AM===AC.TIMESTAMP){AK+=" "+a.formatTimeInfo(this.timeVal,mstrmojo.locales.datetime.TIMEOUTPUTFORMAT);}return AK;}function t(AP,AM){var AK=this.advancedValues,AL=null;AK.set(AP,AM);switch(AK.baseDate){case C:AL=new Date();break;case M:break;case p:break;case Q:break;default:return ;}var AN=AK.monthsToAdjust;if(AN>0){AL.setMonth(AL.getMonth()+(AK.toAddMonths?AN:-AN));}var AO=AK.daysToAdjust;if(AO>0){AL.setDate(AL.getDate()+(AK.toAddDays?AO:-AO));}this.set("value",R.call(this,AL,this.dtp));}function V(){var AK=this.advancedValues,AL=["isDyn"];if(AK.baseDate===AE){return null;}AL.push(AK.baseDate);AL.push(AK.toAddDays?AK.daysToAdjust:-AK.daysToAdjust);AL.push(AK.toAddMonths?AK.monthsToAdjust:-AK.monthsToAdjust);AL.push(0);AL.push(0);AL.push(0);AL.push(0);AL.push(this.value);AL.push(this.timeVal.hour);AL.push(this.timeVal.min);AL.push(this.timeVal.sec);return AL.join("::");}function AH(AK){if(AK.value!==undefined&&this.hasRendered){this.updateSelectedDate();}}function I(AM,AL){var AN=this,AK=function(AO){return AO[0].toUpperCase()+AO.substring(1);};return{scriptClass:"mstrmojo.HBox",cssClass:"dateAdjustBox",alias:AM+"AdjustBox",children:[{scriptClass:"mstrmojo.ui.Pulldown",selectedIndex:AL>0?0:1,onitemSelected:function(AP,AO){t.call(AN,"toAdd"+AK(AM),AO===0);},items:[{did:0,n:mstrmojo.desc(9424,"plus")},{did:1,n:mstrmojo.desc(9425,"minus")}]},{scriptClass:"mstrmojo.ui.editors.controls.Stepper",width:null,height:null,provider:new mstrmojo.NumStepperContentProvider({item:{interval:1,min:0,value:Math.abs(AL)},onTraverse:function(){t.call(AN,AM+"ToAdjust",this.curVal);}})},{scriptClass:"mstrmojo.Label",text:AM==="days"?mstrmojo.desc(707,"Days"):mstrmojo.desc(710,"Months")}]};}function Z(){this.buttonsNode.style.display=(this.wasAdvanced||this.changeValueOnOK||(this.showAdvanced&&this.isAdvanced)?"block":"none");this.advancedNode.style.display=this.showAdvanced?"block":"none";}mstrmojo.Calendar=mstrmojo.declare(mstrmojo.Container,null,{scriptClass:"mstrmojo.Calendar",cssPrefix:"",browseMonth:null,browseYear:null,yearRangStart:null,selectedDates:null,selectedColor:"",isMultiSelect:false,hilightToday:false,yearViewSize:5,cssTextDay:"",cssTextMonth:"",cssTextYear:"",cssTextWeekDay:"",cssTextHeader:"",cssTextMonthYearLabel:"",forceNonEmptySelection:false,showCurMonthDatesOnly:false,currentView:d,duration:600,timeDelimiter:":",dtp:AC.DATE,value:"",firstDayOfWeek:1,changeValueOnOK:false,wasAdvanced:false,showAdvanced:false,isAdvanced:false,dynDateValue:null,canSelectDisabledDate:false,monthNames:function(AK){return AF().MONTHNAME_SHORT[AK];},dayNames:function(AK){return AF().dayShortNames[AK];},min:null,max:null,supportedViews:{day:true,month:true,year:true,hour:true,minute:true,second:true},sDirMatrix:{day:{month:"down",year:"down",hour:"up",minute:"up",second:"up"},month:{day:"up",year:"left",hour:"up",minute:"up",second:"up"},year:{day:"up",month:"right",hour:"up",minute:"up",second:"up"},hour:{day:"down",month:"down",year:"down",minute:"left",second:"left"},minute:{day:"down",month:"down",year:"down",hour:"right",second:"left"},second:{day:"down",month:"down",year:"down",hour:"right",minute:"right"}},markupString:'<div id="{@id}" class="{@cssPrefix} mstrmojo-Calendar {@cssClass}" style="{@cssText}" mstrAttach:mousedown,mouseup,mouseover,mouseout><div class="mstrmojo-Calendar-header" style="{@cssTextHeader}"><div class="mstrmojo-Calendar-decrease"></div><div class="mstrmojo-Calendar-increase"></div><div class="mstrmojo-Calendar-title"><span class="mstrmojo-Calendar-monthLabel" style="{@cssTextMonthYearLabel}">{@browseMonth}</span><span class="mstrmojo-Calendar-yearLabel" style="{@cssTextMonthYearLabel}">{@browseYear}</span></div></div><div class="mstrmojo-Calendar-body" style="{@cssTextBody}"><div class="mstrmojo-Calendar-dayView"></div></div><div class="mstrmojo-Calendar-timePart"><span class="mstrmojo-Calendar-hourLabel">00</span><span class="mstrmojo-Calendar-timeDelimiter">{@timeDelimiter}</span><span class="mstrmojo-Calendar-minuteLabel">00</span><span class="mstrmojo-Calendar-timeDelimiter">{@timeDelimiter}</span><span class="mstrmojo-Calendar-secondLabel">00</span><span class="mstrmojo-Calendar-AMPMLabel">AM</span></div><div class="mstrmojo-Calendar-advanced"></div><div class="mstrmojo-Calendar-buttons cf"></div></div>',markupMethods:{onvisibleChange:function(){this.domNode.style.display=this.visible?"block":"none";},onbrowseMonthChange:function(){this.monthLabel.innerHTML=this.monthNames(this.browseMonth-1);},onbrowseYearChange:function(){this.yearLabel.innerHTML=this.browseYear;},ondtpChange:function(){this.timePart.style.display=(this.dtp===AC.TIMESTAMP||this.dtp===AC.TIME)?"block":"none";this.advancedNode.style.display=this.showAdvanced?"block":"none";},onvalueChange:function(){if(this.lastValue===undefined||this.value!==this.lastValue){this.updateSelectedDate();}},onchangeValueOnOKChange:Z,onisAdvancedChange:Z},markupSlots:{monthLabel:function(){return this.domNode.firstChild.lastChild.firstChild;},yearLabel:function(){return this.domNode.firstChild.lastChild.lastChild;},decreaseButton:function(){return this.domNode.firstChild.firstChild;},increaseButton:function(){return this.domNode.firstChild.childNodes[1];},bodyContainer:function(){return this.domNode.childNodes[1];},dayView:function(){return this.domNode.childNodes[1].firstChild;},monthView:function(){return this.domNode.childNodes[1].firstChild;},yearView:function(){return this.domNode.childNodes[1].firstChild;},hourView:function(){return this.domNode.childNodes[1].firstChild;},minuteView:function(){return this.domNode.childNodes[1].firstChild;},secondView:function(){return this.domNode.childNodes[1].firstChild;},timePart:function(){return this.domNode.childNodes[2];},hourLabel:function(){return this.domNode.childNodes[2].firstChild;},minuteLabel:function(){return this.domNode.childNodes[2].childNodes[2];},secondLabel:function(){return this.domNode.childNodes[2].childNodes[4];},AMPMLabel:function(){return this.domNode.childNodes[2].childNodes[5];},advancedNode:function(){return this.domNode.childNodes[3];},buttonsNode:function(){return this.domNode.childNodes[4];}},init:function AD(AK){if(this._super){this._super(AK);}if(this.duration<1){this.duration=1;}if(!this.selectedDates){this.selectedDates=[];}this.timeVal={hour:0,min:0,sec:0};},ondynDateValueChange:function u(AK){if(AK.value!==undefined&&this.hasRendered){this.updateSelectedDate();this.buildChildren();}},onminChange:AH,onmaxChange:AH,buildChildren:function b(){var AQ=this;if(this.showAdvanced){var AN=this.dynDateValue,AM=this.advancedValues||this.addDisposable(new mstrmojo.Model({})),AT=AN&&AN.split("::")||[],AP=AT[1]||AE,AL=AT[2]||0,AU=AT[3]||0,AR=function AR(){if(AQ.isAdvanced){AQ.wasAdvanced=true;AQ.changeValueOnOK=true;}AQ.set("isAdvanced",!AQ.isAdvanced);mstrmojo.css.toggleClass(AQ.markupSlots.dayView.call(AQ),["ddSelected"],AQ.isAdvanced);t.call(AQ,"baseDate",AQ.isAdvanced?3:0);if(AQ.parent&&AQ.parent.nudge&&AQ.isAdvanced){AQ.parent.nudge();}};this.advancedValues=AM;AM.baseDate=parseInt(AP);AM.toAddDays=AL>=0;AM.daysToAdjust=Math.abs(AL);AM.toAddMonths=AU>=0;AM.monthsToAdjust=Math.abs(AU);this.isAdvanced=!!this.dynDateValue;if(this.domNode){mstrmojo.css.toggleClass(this.markupSlots.dayView.call(this),["ddSelected"],this.isAdvanced);}if(this.isAdvanced&&this.value){var AK=n(this.value),AO=this.timeVal;if(AK&&AK.hour!==undefined){AO.hour=AK.hour;AO.min=AK.min;AO.sec=AK.sec;}}t.call(AQ,"baseDate",this.isAdvanced?3:0);this.destroyChildren(false);this.addChildren([{scriptClass:"mstrmojo.HBox",alias:"checkLabel",slot:"advancedNode",children:[{scriptClass:"mstrmojo.ui.Checkbox",alias:"checkbox",checked:!!AQ.isAdvanced,oncheckedChange:AR},{scriptClass:"mstrmojo.Label",text:mstrmojo.desc(13844,"Dynamic Date"),onclick:function AS(){this.parent.checkbox.onclick();}}]},{scriptClass:"mstrmojo.Box",alias:"advancedPanel",slot:"advancedNode",bindings:{visible:"this.parent.isAdvanced"},children:[{scriptClass:"mstrmojo.Label",text:mstrmojo.desc(9423,"Today"),cssClass:"tdLabel"},I.call(this,"days",AL),I.call(this,"months",AU)]},]);}else{this.destroyChildren(false);}this.addChildren([mstrmojo.Button.newWebButton(mstrmojo.desc(2140,"Cancel"),function(){AQ.parent.close();},false,{slot:"buttonsNode"}),mstrmojo.Button.newWebButton(mstrmojo.desc(1442,"OK"),function(){if(AQ.changeValueOnOK||AQ.isAdvanced||AQ.wasAdvanced){AQ.updateValue(true);}},true,{slot:"buttonsNode"})]);},preBuildRendering:function A(){this.buildChildren();return this._super();},getSelectedDatesAsString:function E(AL){var AK=[];m.forEach(this.selectedDates,function(AM){AK.push(a.formatDateInfo(AM,AL||AF().DATEOUTPUTFORMAT));});return AK;},updateSelectedDate:function L(AP){var AK=this.value,AM=this.timeVal,AO=this.selectedDates,AN,AQ=function(AS,AR){AS.set("browseYear",AR.year);AS.set("browseMonth",AR.month);AS.updateTimePart();AS.updateView(AS.currentView);if(!AS.changeValueOnOK&&AS.hasRendered&&AS.closeOnValueChange!=true){AS.updateValue();}};if(this.wasAdvanced){this.wasAdvanced=false;this.changeValueOnOK=false;}if(AK){AN=n(AK);if(AN&&AN.hour!==undefined){AM.hour=AN.hour;AM.min=AN.min;AM.sec=AN.sec;if(this.dtp===AC.TIME&&(AN.year===undefined||AN.month===undefined||AN.day===undefined)){var AL=a.getDateJson(new Date());AN.year=AL.year;AN.month=AL.month;AN.day=AL.day;}}}if((AN&&!this.isMultiSelect)||AP){B(this);}if(AO.length===0){if(!AN){if(this.parent.opener&&this.parent.opener.defaultDate){AN=n(this.parent.opener.defaultDate);}else{AN=a.getDateJson(new Date());}}if(!this.canSelectDisabledDate&&this.isDateDisabled(AN.day,AN.month,AN.year,this.min,this.max)){if(this.min&&a.compareDate(AN,this.min)<0){AN=n(this.min);}else{if(this.max&&a.compareDate(AN,this.max)>0){AN=n(this.max);}}}AO.push(AN);AQ(this,AN);}else{AN=AO[0];if(this.value!==null){AQ(this,AN);}}},updateValue:function e(AK){var AM=h(this),AL="";if(AM){AL=a.formatDateInfo(AM,AF().DATEOUTPUTFORMAT);if(this.dtp!==AC.DATE){var AN=a.formatTimeInfo(this.timeVal,AF().TIMEOUTPUTFORMAT);if(this.dtp===AC.TIME){AL=AN;}else{AL+=" "+AN;}}}this.lastValue=AL;this.set("value",AL);if(this.showAdvanced){this.set("dynDateValue",AK?V.call(this):null);}if(this.onValueUpdate){this.onValueUpdate();}},updateTimePart:function AA(){var AL=this.timeVal,AK=AL.hour||0,AM=(AK%12===0)?12:(AK%12);this.hourLabel.innerHTML=AM;this.minuteLabel.innerHTML=a.formatInteger(AL.min||0,2);this.secondLabel.innerHTML=a.formatInteger(AL.sec||0,2);this.AMPMLabel.innerHTML=AK<12?" "+AF().AM_NAME:" "+AF().PM_NAME;},premousedown:function(AK){var AM=AK.e,AL=k.eventTarget(AK.hWin,AM);if(AL===this.decreaseButton||AL===this.increaseButton){if(k.isFF){k.stopPropogation(window,AM);}return true;}else{return this.processEvent(AL,AM);}},premouseup:function(AK){var AM=AK.e;if(AM.ctrlKey||AM.shiftKey){k.clearBrowserHighlights();}var AL=k.eventTarget(AK.hWin,AM);if(AL===this.decreaseButton&&!AL.disabled){this.decrease();return true;}if(AL===this.increaseButton&&!AL.disabled){this.increase();return true;}},processEvent:function(AV,Ac){var AN=this.currentView,AO=this.selectedDates,AS,AX,Ad,AK,AU;if(AV===this.monthLabel){if(AN!==AG){this.switchViewTo(AG);}return true;}if(AV===this.yearLabel){if(AN!==W){this.adjustYearStart();this.switchViewTo(W);return true;}}if(AV===this.hourLabel){if(AN!==Y){this.switchViewTo(Y);}return true;}if(AV===this.minuteLabel){if(AN!==AJ){this.switchViewTo(AJ);}return true;}if(AV===this.secondLabel){if(AN!==z){this.switchViewTo(z);}return true;}if(AV===this.AMPMLabel){if(AN!==Y){this.switchViewTo(Y);}return true;}if(AN===Y){var AQ=AV.getAttribute("h");AU=parseInt(AV.innerHTML,10);if(!isNaN(AQ)&&!isNaN(AU)){AQ=parseInt(AQ,10);this.timeVal.hour=AU%12+AQ*12;this.updateTimePart();this.switchViewTo(d);if(!this.changeValueOnOK){this.updateValue();}}return true;}if(AN===AJ){AU=parseInt(AV.innerHTML,10);if(!isNaN(AU)){this.timeVal.min=AU;this.updateTimePart();this.switchViewTo(d);if(!this.changeValueOnOK){this.updateValue();}}return true;}if(AN===z){AU=parseInt(AV.innerHTML,10);if(!isNaN(AU)){this.timeVal.sec=AU;this.updateTimePart();this.switchViewTo(d);if(!this.changeValueOnOK){this.updateValue();}}return true;}if(AN===d){var Ab=this.browseYear,AL=this.browseMonth,AM;AV=P(AV);Ad=parseInt(AV.innerHTML,10);AK=parseInt(AV.getAttribute("m"),10);if(!isNaN(Ad)&&!isNaN(AK)){AM=(AK===0)?{y:Ab,m:AL}:(AK===1?a.getNextMonth(Ab,AL):a.getPreMonth(Ab,AL));if((!this.canSelectDisabledDate&&this.isDateDisabled(Ad,AM.m,AM.y,this.min,this.max))||Ac.button===2){return true;}if(this.isAdvanced){return true;}var AY=X(AO,Ad,AL,Ab),AW=AO.length>1,AT=this.forceNonEmptySelection,AZ=this.isMultiSelect,AR=AZ&&Ac.ctrlKey,Aa=AZ&&Ac.shiftKey,AP=null;if(Aa){AP=g(this,AV);B(this);o(this,AP);}else{if(AR){if(AY===-1){AI(this,AV);}else{if(!AT||AW){w(this,AY);}}}else{B(this);if(AW||AY===-1||AT){AI(this,AV);}}}if(this.onselect||J.hasSubs(this.id,"select")){this.raiseEvent({name:"select",value:this.selectedDates});}if(AK===1){this.increase();}else{if(AK===-1){this.decrease();}}if(!this.changeValueOnOK){this.updateValue();}else{if(this.showAdvanced){this.checkLabel.checkbox.set("checked",false);t.call(this,"baseDate",0);}}}return true;}if(AN===AG){AV=P(AV);AX=parseInt(AV.getAttribute("m"),10);if(!isNaN(AX)){this.set("browseMonth",AX+1);this.switchViewTo(d);}return true;}if(AN===W){AV=P(AV);AS=parseInt(AV.innerHTML,10);if(!isNaN(AS)){this.set("browseYear",AS);this.switchViewTo(d);}return true;}return true;},decrease:function(){var AM=this.currentView,AP=AM,AO=this.browseYear,AK=this.browseMonth,AL=this.yearRangStart,AN;switch(AM){case d:AN=a.getPreMonth(AO,AK);this.set("browseMonth",AN.m);this.set("browseYear",AN.y);break;case AG:this.set("browseYear",AO-1);break;case W:this.yearRangStart=AL-this.yearViewSize*this.yearViewSize;break;case Y:AP=z;break;case AJ:AP=Y;break;case z:AP=AJ;break;}this.switchViewTo(AP,"right");},increase:function(){var AM=this.currentView,AP=AM,AO=this.browseYear,AK=this.browseMonth,AL=this.yearRangStart,AN;switch(AM){case d:AN=a.getNextMonth(AO,AK);this.set("browseMonth",AN.m);this.set("browseYear",AN.y);break;case AG:this.set("browseYear",AO+1);break;case W:this.yearRangStart=AL+this.yearViewSize*this.yearViewSize;break;case Y:AP=AJ;break;case AJ:AP=z;break;case z:AP=Y;break;}this.switchViewTo(AP,"left");},updateView:function(AK){var AL=this[AK+"ViewHTML"]();this[AK+"View"].innerHTML=AL;},adjustYearStart:function(){this.yearRangStart=this.browseYear-10-this.browseYear%5;},switchViewTo:function(AL,AN){var AR="mstrmojo-Calendar-"+AL+"View",AQ=document.createElement("div"),AK=this[this.currentView+"View"],AO=AL+"ViewHTML",AP=this[this.currentView+"Label"],AM=this[AL+"Label"];if(!this.supportedViews[AL]){return ;}if(!AN){AN=this.sDirMatrix[this.currentView][AL];}AQ.className=AR;AQ.innerHTML=this[AO]();this.currentView=AL;this[AL+"View"]=AQ;mstrmojo.css.toggleClass(AQ,["ddSelected"],this.isAdvanced);this._slideIntoView(AK,AQ,AN);},_slideIntoView:function(AO,AS,AM){var AK=this.bodyContainer,AQ=(AM==="left"||AM==="right")?AO.offsetWidth:AO.offsetHeight,AL=(AM==="left"||AM==="right")?"left":"top",AR=(AM==="left"||AM==="up")?AQ:-AQ,AP=new mstrmojo.fx.AnimateProp({props:{},duration:this.duration,interval:this.duration/10,target:AO,onEnd:function(){AK.removeChild(AO);}}),AN=new mstrmojo.fx.AnimateProp({props:{},duration:this.duration,interval:this.duration/10,target:AS});AS.style[AL]=AR+"px";AK.appendChild(AS);AP.props[AL]={start:0,stop:-AR,suffix:"px"};AN.props[AL]={start:AR,stop:0,suffix:"px"};AP.play();AN.play();},dayViewHTML:function(){var AP=this.browseYear,AS=this.browseMonth,AX=a.getDaysOfMonth(AP,AS),Ab=a.getPreMonth(AP,AS),AM=a.getDaysOfMonth(Ab.y,Ab.m),AL=a.getNextMonth(AP,AS),AT=H(AP,AS,this.firstDayOfWeek),AQ=[],AN=AB(this),Ad=0,AK=this.selectedDates,AV=this.min,AZ=this.max,Ae,AW,Aa,AY,Ac=this.showCurMonthDatesOnly?'style="visibility:hidden;"':"";U(this,{d:AM,m:Ab.m,y:Ab.y},{d:1,m:AL.m,y:AL.y});AQ.push(O(this.cssTextDay));AQ.push(this._dayViewTHead());AQ.push("<tr>");for(Aa=0;Aa<AT;Aa++){Ae=AM-AT+Aa+1;AW=this.isDateDisabled(Ae,Ab.m,Ab.y,AV,AZ)?"disabled":"";AQ.push("<td "+Ac+'><div class="mstrmojo-Calendar-day-pre '+AW+'" m="-1">');AQ.push(Ae);AQ.push("</div></td>");Ad++;}for(Aa=0;Aa<AX;Aa++){Ae=Aa+1;AW=this.isDateDisabled(Ae,AS,AP,AV,AZ)?" disabled":"";var AO=q(Ae,AS,AP),AR=AO?" today":"",AU=X(AK,Ae,AS,AP)!==-1;AR=(this.hilightToday&&AO)?" hilightToday":AR;AQ.push("<td "+(AO?('class="'+AR+'" '):" ")+(AU?AN:"")+'><div class="mstrmojo-Calendar-day-cur'+(AU?(" selected "):"")+AW+'" m="0"'+(AU?AN:"")+">");AQ.push(Aa+1);AQ.push("</div></td>");if((++Ad)%7===0){AQ.push("</tr><tr>");}}for(AY=Ad;AY<42;AY++){Ae=Ad-AX-AT+1;AW=this.isDateDisabled(Ae,AL.m,AL.y,AV,AZ)?"disabled":"";AQ.push("<td "+Ac+'><div class="mstrmojo-Calendar-day-next '+AW+'" m="1">');AQ.push(Ae);AQ.push("</div></td>");if((++Ad)%7===0&&Ad!==42){AQ.push("</tr><tr>");}}AQ.push("</tr>");AQ.push(x);return AQ.join("");},_dayViewTHead:function(){var AN=[],AO='<thead><tr class="mstrmojo-Calendar-thead" style="'+this.cssTextWeekDay+';">',AM="</tr></thead>",AL=this.firstDayOfWeek-1,AP=this.dayNames,AK;AN.push(AO);for(AK=AL;AK<AL+7;AK++){AN.push("<td>");AN.push(AP(AK%7));AN.push("</td>");}AN.push(AM);return AN.join("");},monthViewHTML:function(){var AL=[],AN=this.browseMonth-1,AM=this.browseYear,AK;U(this,{d:31,m:12,y:AM-1},{d:1,m:1,y:AM+1});AL.push(O(this.cssTextMonth));AL.push("<tr>");for(AK=0;AK<12;AK++){AL.push("<td "+((AK===AN)?AB(this):"")+'><div class="mstrmojo-Calendar-month'+((AK===AN)?" selected":"")+'" m="');AL.push(String(AK));AL.push('">');AL.push(this.monthNames(AK));AL.push("</div></td>");if(AK%3===2){AL.push("</tr><tr>");}}AL.pop();AL.push("</tr>");AL.push(x);return AL.join("");},yearViewHTML:function(){var AP=this.yearRangStart,AL=[],AN=this.browseYear,AO,AK,AM=this.yearViewSize;U(this,{d:31,m:12,y:AP-1},{d:1,m:1,y:AP+AM*AM});AL.push(O(this.cssTextYear));AL.push("<tr>");for(AK=0;AK<AM*AM;AK++){AO=AP+AK;AL.push("<td "+((AN===AO)?AB(this):"")+'><div class="mstrmojo-Calendar-year'+((AN===AO)?" selected":"")+'">');AL.push(AO);AL.push("</div></td>");if(AK%AM===(AM-1)){AL.push("</tr><tr>");}}AL.pop();AL.push("</tr>");AL.push(x);return AL.join("");},hourViewHTML:function(){var AM=[],AL=this.timeVal.hour,AK;AM.push(G);AM.push('<tr><td colspan="6"><div class="mstrmojo-Calendar-hourTitle">');AM.push(AF().AM_NAME);AM.push("</div></td></tr>");for(AK=0;AK<12;AK++){AM.push('<td><div class="mstrmojo-Calendar-hour'+((AK===AL)?" selected":"")+'" h="0">');AM.push((AK===0)?12:AK);AM.push("</div></td>");if(AK===5){AM.push("</tr><tr>");}}AM.push('</tr><tr><td colspan="6"><div class="mstrmojo-Calendar-hourTitle">');AM.push(AF().PM_NAME);AM.push("</div></td></tr>");for(AK=0;AK<12;AK++){AM.push('<td><div class="mstrmojo-Calendar-hour'+(((12+AK)===AL)?" selected":"")+'" h="1">');AM.push((AK===0)?12:AK);AM.push("</div></td>");if(AK===5){AM.push("</tr><tr>");}}AM.push("</tr>");AM.push(x);return AM.join("");},minuteViewHTML:function(){return this._minuteSecondViewHTML(this.timeVal.min,"mstrmojo-Calendar-minute");},secondViewHTML:function(){return this._minuteSecondViewHTML(this.timeVal.sec,"mstrmojo-Calendar-second");},_minuteSecondViewHTML:function(AM,AN){var AL=[],AK;AL.push(G);AL.push("<tr>");for(AK=0;AK<60;AK++){AL.push('<td><div class="');AL.push(AN);AL.push((AK===AM)?' selected">':'">');AL.push(AK);AL.push("</div></td>");if(AK%10===9){AL.push("</tr><tr>");}}AL.pop();AL.push("</tr>");AL.push(x);return AL.join("");},isDateDisabled:function(AK,AM,AL){return !F(AK,AM,AL,this.min,this.max);},unrender:function D(AK){delete this.lastValue;this._super(AK);}});}());(function(){mstrmojo.requiresCls("mstrmojo.ui.menus.ToolbarConfig");mstrmojo.vi.ui.toolbars._HasToolbar=mstrmojo.provide("mstrmojo.vi.ui.toolbars._HasToolbar",{_mixinName:"mstrmojo.vi.ui.toolbars._HasToolbar",preBuildRendering:function A(){this.generateToolbar();return this._super();},generateToolbar:function B(){this.passToolbarCfg(this.updateToolbar(new mstrmojo.ui.menus.ToolbarConfig()));},updateToolbar:function D(E){if(this._super){E=this._super(E);}return E;},passToolbarCfg:function C(E){var F=this.toolbar.toolbarCfg;if(F){F.destroy();}this.toolbar.set("toolbarCfg",E);}});}());(function(){mstrmojo.requiresCls("mstrmojo.Container","mstrmojo._HasLayout","mstrmojo.ui.menus._HasMenuPopup","mstrmojo.vi._MonitorsAppState","mstrmojo.vi.ui.tabs.Tab","mstrmojo.dom","mstrmojo.css");var N=mstrmojo.dom,b=mstrmojo.array,B=mstrmojo.css,h="animate",j="90px",o="70px",F="52px",x=200,Q=700,A=750;function D(){var AG=window.Modernizr,AF="transition";if(AG&&AG.testProp(AF)){return N.transEndEvtNames[AG.prefixed(AF)];}return null;}function AA(AF){return function(){this.menuNode.style.display=AF?"block":"none";};}function P(AF){return Math.min(AF.offsetWidth-AF.firstChild.offsetWidth,0);}function z(AF){return AF.isAlignRight?"right":"left";}function AD(AF,AG){return parseInt(AF.style[z(AG)],10)||0;}function L(){var AJ=this.tabContainerNode,AI=false,AH=false,AK=false,AL=this.leftBtnNode,AF=this.rightBtnNode,AG=this.isValidMode();window.setTimeout(function(){if(P(AJ)<0){var AN=N.position(AJ),AM=N.position(AJ.firstChild);AI=(AM.x<AN.x);AH=(AM.x+AM.w>AN.x+AN.w+1);}AK=AI||AH;B.toggleClass(this.btnBarNode,"highlightBar",AK);AL.style.display=AF.style.display=AK?"block":"none";AL.disabled=!AI;AF.disabled=!AH;B.toggleClass(AL,"disable",!AI);B.toggleClass(AF,"disable",!AH);if(this.domNode){this.addBtnNode.style.display=this.tabStripMenuNode.style.display=AG?"block":"none";this.bufferNode.style.display=AG?"none":"block";this.floaterNode.style.display=this.hasFloater&&AI?"block":"none";}this.widgetResized();}.bind(this),x);}function U(AF,AG){AF=(AF||[]);if(!AF.filter){return b.filter(AF,AG);}return AF.filter(AG);}function X(AF,AG){AF=(AF||[]);if(!AF.map){return b.map(AF,AG);}return AF.map(AG);}function t(AV,AH,AI){var AT=this.tabContainerNode,AM=this.domNode;if(this.isStatic||!AT||!AM||AM.style.display==="none"){return ;}var AO=AT.firstChild,AU=P(AT),AL=AD(AO,this),AF=Math.max(AL,AU),AS=U(this.children,function(AW){return AW.isSelected;})[0],AQ=AI&&AI.domNode||AS&&AS.domNode;if(AV&&AQ){if(AU<0){var AN=N.position(AQ),AJ=N.position(AT),AP=Math.floor(AN.x-AJ.x),AR=Math.floor(AN.x+AN.w-(AJ.x+AJ.w));if(AI){var AG=Math.ceil(AQ.offsetWidth);AP=AP===0?Math.max(AU,-AG):AP;AR=AR===0?Math.min(-AU,AG):AR;}var AK=AP<0?AP:(AR>0?AR:0);AF=this.isAlignRight?AF+AK:AF-AK;}}if(AF!==AL){if(AH){this.setAnimation(AO);}AO.style[z(this)]=Math.max(AU,Math.min(AF,0))+"px";}L.call(this);}function C(AF){return AF.hasOwnProperty("index");}function J(){var AG=this.tabContainerNode,AH=N.position(AG),AF=this.isAlignRight;b.forEach(this.children||[],function(AJ){var AP=AJ.domNode,AQ=N.position(AP),AM=Math.floor(AQ.x-AH.x),AN=Math.floor(AQ.x+AQ.w-(AH.x+AH.w)),AI=AJ.isSelected,AO=Math.ceil(AP.offsetWidth),AK=0;AJ.isCutoff=AJ.isHidden=AJ.isLeftMost=AJ.isRightMost=false;AJ.leftEdgeHiddenWidth=AJ.rightEdgeHiddenWidth=0;if(AM<0){var AL=Math.abs(AM);AK=AO-AL;AJ.isLeftMost=AK>=0;AJ.isCutoff=AJ.isLeftMost&&AL>0&&AK>0;AJ.isHidden=AK<=0;AJ.leftEdgeHiddenWidth=AL;}else{if(AN>0){AK=AO-AN;AJ.isRightMost=AK>=0;AJ.isCutoff=AJ.isRightMost&&AN>0&&AK>0;AJ.isHidden=AK<=0;AJ.rightEdgeHiddenWidth=AN;}}});}function Z(){var AF=this.children,AG=0;(AF||[]).every(function(AI,AH){if(!C(AI)){return false;}AG++;AI.index=AH;return true;});(AF||[]).every(function(AH){if(!C(AH)){return false;}AH.total=AG;return true;});}function g(AL,AH){var AK=AL.ENUM_CORNERS,AM=[AK.TOP_LEFT,AK.BOTTOM_LEFT],AG=this.parent;if(AG.position!=="bottom"){AM.reverse();}AL.setAlignment(AM[0],AM[1]);var AF=N.position(AG.domNode),AJ=AG.menuNode;var AI=AJ.style;AI.top=(AH.y-AF.y)+"px";AI.left=(AH.x-AF.x)+"px";AL.addPopupHandlers(AG.id,AA(true),AA(false));AL.hostId=AG.id;AL.hostElement=AJ;AL.isHostedWithin=false;AG.openPopup(AL.newInstance());}function k(AF){AF.raiseEvent({name:"TabsChange"});}mstrmojo.vi.ui.tabs.TabStrip=mstrmojo.declare(mstrmojo.Container,[mstrmojo._HasLayout,mstrmojo.ui.menus._HasMenuPopup,mstrmojo.vi._MonitorsAppState],{scriptClass:"mstrmojo.vi.ui.tabs.TabStrip",markupString:'<div id="{@id}" class="mstrmojo-VITabStrip {@cssClass}" style="{@cssText}" ><div class="mstrmojo-VITabStrip-menu" mstrAttach:click><div id="tabCommonIcon" class="mstrmojo-VITabStrip-menuIcon"></div><div id="tabCommonButton" class="mstrmojo-VITabStrip-menuButton"></div><div id="tabCommonMenuHost" class="mstrmojo-VITabStrip-menuButtonHost"></div></div><div class="mstrmojo-VITabStrip-tabs"><div style="display:table"><div style="display:table-row"></div></div></div><div class="mstrmojo-VITabStrip-buffer"></div><div class="mstrmojo-VITabStrip-btnBar"><div class="mstrmojo-VITabStrip-addBtn" mstrAttach:click><div class="mstrmojo-VITabStrip-addBtn-Img"></div><div class="mstrmojo-VITabStrip-addBtn-Text"></div></div><div class="mstrmojo-VITabStrip-navBtns"><div id="tabRightButton" class="mstrmojo-VITabStrip-rightBtn" mstrAttach:click,mousedown,mouseup,mouseover,mouseout><div class="navBtnIcon"></div></div><div id="tabLeftButton" class="mstrmojo-VITabStrip-leftBtn" mstrAttach:click,mousedown,mouseup,mouseover,mouseout><div class="navBtnIcon"></div></div></div></div><div class="mstrmojo-VITabStrip-floater"></div><div class="mstrmojo-VITabStrip-menuHost"></div><div class="mstrmojo-VIDND-mask"></div></div>',markupSlots:{tabStripMenuNode:function(){return this.domNode.firstChild;},menuImgNode:function(){return this.domNode.firstChild.firstChild;},menuBtnNode:function(){return this.domNode.firstChild.childNodes[1];},menuBtnHostNode:function(){return this.domNode.firstChild.lastChild;},tabContainerNode:function(){return this.domNode.childNodes[1];},containerNode:function(){return this.domNode.childNodes[1].firstChild.firstChild;},bufferNode:function(){return this.domNode.childNodes[2];},btnBarNode:function(){return this.domNode.childNodes[3];},addBtnNode:function(){return this.domNode.childNodes[3].firstChild;},addBtnImgNode:function(){return this.domNode.childNodes[3].firstChild.firstChild;},addBtnTxtNode:function(){return this.domNode.childNodes[3].firstChild.lastChild;},navBtnsNode:function(){return this.domNode.childNodes[3].lastChild;},rightBtnNode:function(){return this.domNode.childNodes[3].lastChild.firstChild;},leftBtnNode:function(){return this.domNode.childNodes[3].lastChild.lastChild;},floaterNode:function(){return this.domNode.childNodes[4];},menuNode:function(){return this.domNode.childNodes[5];},maskNode:function(){return this.domNode.lastChild;}},isStatic:false,isAlignRight:true,tabStripMenuNode:null,menuImgNode:null,menuBtnNode:null,menuBtnHostNode:null,tabContainerNode:null,addBtnNode:null,bufferNode:null,navBtnsNode:null,leftBtnNode:null,rightBtnNode:null,menuNode:null,position:"bottom",selectMovedTab:false,hasFloater:false,tabObjects:null,layoutConfig:{w:{tabContainerNode:"100%",bufferNode:"6px",addBtnNode:j,navBtnsNode:F,tabStripMenuNode:o},xt:true},onAppStateChange:function q(AM){var AK=mstrmojo.vi.VisualInsightApp.APP_STATES,AL=AK.PRESENTATION,AF=AK.SELECTOR_TARGETING,AG=AM.value,AN=AM.valueWas,AJ=this.isValidMode();if(AG&AL||AN&AL||AG&AF||AN&AF){var AH=this.addBtnNode,AI=this.tabStripMenuNode;if(AH&&AI){AH.style.display=AI.style.display=AJ?"block":"none";this.bufferNode.style.display=AJ?"none":"block";this.doLayout();}}},setStatic:function R(AF,AG){this.isStatic=AF;if(!AF){t.call(this,true,AG);}},setTabs:function p(AH,AF){this.removeChildren();this.tabObjects=AH;var AI=this,AG=(AH&&AH.length)||0;this.addChildren(X(AH,function(AL,AJ){var AK=AL.k;return AI.getTabCfg(AH,AL,{scriptClass:"mstrmojo.vi.ui.tabs.Tab",index:AJ,total:AG,draggable:!!AG,dropZone:!!AG,k:AK,isSelected:AK===AF,showTabMenu:g,tabMoved:function(AN){var AM=this.index;AI.moveTab(AM,AM+(AN?-1:1),AM);}});}));t.call(this,true);k(this);},getTabs:function l(){return U(this.children,C);},getTabCfg:function AE(AG,AH,AF){return AF;},deleteTab:function I(AF){var AL=this.id,AK=this.children[AF],AJ=D(),AI=function(){var AM=mstrmojo.all[AL];AM.removeChildren(AK);AK.destroy();Z.call(AM);L.call(AM);k(AM);};if(AJ){var AH=AK.domNode.firstChild,AG=AH.style;AG.width=AH.offsetWidth+"px";window.setTimeout(function(){B.addClass(AH,h);N.attachOneTimeEvent(AH,AJ,AI);AG.width=0;},0);}else{AI();}},buildRendering:function c(){this._super();B.toggleClass(this.domNode,"alignLeft",!this.isAlignRight);},postBuildRendering:function V(){var AF=this._super();t.call(this,true);return AF;},doLayout:function K(){this._super();t.call(this,true);},isValidMode:function E(){return !((mstrApp.isAppStatePresentation&&mstrApp.isAppStatePresentation())||(mstrApp.isAppStateSelection&&mstrApp.isAppStateSelection())||(mstrApp.allowWebDashboardDesign&&!mstrApp.allowWebDashboardDesign()));},setSelectedTab:function S(AF){b.forEach(this.children||[],function(AG){AG.set("isSelected",AG.k===AF);});k(this);},getSelectedTab:function f(){var AH=null,AG=this.children||[],AF;for(AF=0;AF<AG.length;AF++){if(AG[AF].isSelected){AH=AG[AF];break;}}return AH;},onclick:function n(AF){if(!this.isValidMode()){return ;}if(AF.getTarget()===this.addBtnImgNode||AF.getTarget()===this.addBtnTxtNode){this.addTab();}},addTab:mstrmojo.emptyFn,clearBtnTooltips:function O(AH){var AF=(AH===this.leftBtnNode),AG=(AH===this.rightBtnNode);if(AF||AG){this.clearTooltips();return true;}return false;},showBtnTooltips:function G(AF){var AH=AF.getTarget().parentNode,AG=this.clearBtnTooltips(AH);if(AG){this.toggleTooltip(AH);}},onmouseout:function u(AF){var AG=AF.getTarget().parentNode;this.clearBtnTooltips(AG);},onmouseover:function H(AF){this.showBtnTooltips(AF);},onmouseup:function a(AF){window.setTimeout(function(){this.showBtnTooltips(AF);}.bind(this),x);},onmousedown:function e(AO){var AK=AO.getTarget().parentNode,AP=(AK===this.leftBtnNode),AI=(AK===this.rightBtnNode);if(AP||AI){var AN=this.tabContainerNode,AJ=AN.firstChild,AF=this.id,AL=this,AH;if(mstrApp.setInteractive){mstrApp.setInteractive(false);}B.addClass(AK,"active");var AM=function(){window.clearInterval(AH);B.removeClass(AK,"active");L.call(mstrmojo.all[AF]);if(mstrApp.setInteractive){mstrApp.setInteractive(true);}};N.attachOneTimeEvent(document.body,"mouseup",AM);var AG=function(){var AS=P(AN),AV=AD(AJ,AL),AW=AV-AS,AU=0-AV;J.call(AL);AL.setAnimation(AJ);var AQ=AL.getCornerTabs()||[],AT=U(AQ,function(AX){if(AP&&AX.isLeftMost||AI&&AX.isRightMost){return AX;}})[0],AR=0;if(AT){AR=AT.isCutoff?(AP?AT.leftEdgeHiddenWidth:AT.rightEdgeHiddenWidth):Math.ceil(AT.domNode.offsetWidth);AR=Math.min(AR,AP?AU:AW);AR=AL.isAlignRight?(AP?-AR:AR):(AP?AR:-AR);}AJ.style[z(AL)]=parseInt(AJ.style[z(AL)]||0)+AR+"px";};AG();AH=window.setInterval(function(){AG();},A);}},getCornerTabs:function d(){return U(this.children,function(AF){return AF.isLeftMost||AF.isRightMost;});},setAnimation:function Y(AF){var AG=D();if(AG){B.addClass(AF,h);N.attachOneTimeEvent(AF,AG,function(){B.removeClass(AF,h);});}},createTooltip:function AB(AG){var AI=document.createElement("div");AI.className="navBtnTooltip";AI.appendChild(document.createTextNode(AG.getAttribute("tooltip")||""));var AL=document.body.firstChild;AL.parentNode.insertBefore(AI,AL);var AJ=5,AM=AI.offsetWidth-25,AH=AG.getBoundingClientRect(),AK=AI.getBoundingClientRect(),AF=AH.top-(AK.height+AJ);AI.style.top=AF+"px";AI.style.left=(AH.left-AM)+"px";return AI;},clearTooltips:function m(){window.clearTimeout(this._tooltipTimeOut);var AF=document.querySelectorAll(".navBtnTooltip");b.forEach(AF||[],function(AG){AG.parentNode.removeChild(AG);});},toggleTooltip:function AC(AF){window.clearTimeout(this._tooltipTimeOut);if(AF.disabled){this._tooltipTimeOut=window.setTimeout(function(){this.createTooltip(AF);}.bind(this),Q);}},moveTab:function M(AF,AN,AL,AK){var AG=this.children,AO=AG.splice(AF,1)[0];AG.splice(AN,0,AO);Z.call(this);this.setAnimation(this.tabContainerNode.firstChild);var AH=this.containerNode,AI=AH.childNodes,AM=AH.removeChild(AI[AF]),AJ=AI[AN];if(AJ){AH.insertBefore(AM,AJ);}else{AH.appendChild(AM);}if(this.selectMovedTab||AO.isSelected){t.call(this,true,true,AO);}if(!AK&&AL!==undefined&&AL!==AN){this.commitTabMove(AL,AN);k(this);}},commitTabMove:function w(AF,AG){throw new Error(this.scriptClass+" must implement commitTabMove.");},updateTabTable:function r(){if(!this.isStatic){t.call(this,true);}},setLinkIcon:function W(AF,AI){var AH,AG;if(AF){if(AI){AG="src";b.some(this.getTabs(),function(AJ){if(AJ.k===AI){AH=AJ;}return AH;});if(!AH){return ;}}else{AG="tgt";AH=this.getSelectedTab();}B.addClass(AH.domNode,AG);}else{AG=AI?["src","tgt"]:"tgt";b.forEach(this.children,function(AJ){B.removeClass(AJ.domNode,AG);});}}});}());(function(){mstrmojo.requiresCls("mstrmojo.array","mstrmojo.hash","mstrmojo.css","mstrmojo.dom","mstrmojo.expr","mstrmojo.range","mstrmojo.Widget","mstrmojo.WidgetList","mstrmojo.WidgetListMapper","mstrmojo._HasSuggestion","mstrmojo.ME.MetricToken","mstrmojo.ME.MetricDataService","mstrmojo.ui.ScrollableSuggestionList","mstrmojo.mstr.EnumDSSXMLObjectTypes");var R=mstrmojo.dom,U=mstrmojo.css,AK=mstrmojo.Enum_Keys,H=mstrmojo.range,l=H.EDGE,AC=mstrmojo.ME.MetricToken.isDelimiter,Q=mstrmojo.expr,t=mstrmojo.array,K=mstrmojo.hash;var M=R.isIE||R.isIEW3C;function AS(E){return E.ctrlKey||R.isMetaKey(window,E)||(E.charCode||E.keyCode)===AK.CTRL;}mstrmojo.ME.SpanListMapper=mstrmojo.provide("mstrmojo.ME.SpanListMapper",mstrmojo.mixin({itemWrapperPrefix:function(E){return'<span class="'+this.getWrapperCss(E)+'">';},itemWrapperPrefill:"&nbsp;",itemWrapperSuffix:"</span>",createWrapperNode:function S(E){var AT=E.ownerDocument,AU=AT.createElement("span");return AU;},_iw2idx:function V(AT,AW,AV){var AU=this.wrapperNodes(AW),E=mstrmojo.array.indexOf(AU,AV);return E===-1?AU.length:E;},itemOffsetLeft:function j(AT,AX,E,AV){if(!AV){var AU=this.wrapperNodes(AX);AV=AU&&AU[E];if(!AV){return 0;}}var AW=AX.firstChild;if(!AW||(AW===AV)){return 0;}return AV.offsetLeft-AW.offsetLeft;},whereDrop:function AR(Ab,E,AV,Aa,AT){var AX=this._nd2iw(Ab,E,AV),Ac,AZ,AW,AY,AU;if(AX){AZ=this._iw2idx(Ab,E,AX);Ac=AZ;AW=this.itemOffsetLeft(Ab,E,null,AX);AY=AX.offsetTop;AU=AX.offsetWidth;if(Aa.x>AT.left+AW+AU/2){Ac++;AW+=AU;}}else{return Ab.dropCuePos;}return{left:AW,top:AY,idx:Ac,idxActual:AZ};}},mstrmojo.hash.copy(mstrmojo.WidgetListMapper)));mstrmojo.ME.TokenInputBox=mstrmojo.declare(mstrmojo.WidgetList,[mstrmojo._HasSuggestion],{scriptClass:"mstrmojo.ME.TokenInputBox",containerResizable:false,dropZone:true,suggestionPopupCssClss:"mstrmojo-ME-TokenInputBox-suggest",allowDrop:function G(E){var AT=E.src.data;return !!AT;},createToken:function A(E){return{v:mstrmojo.ME.MetricToken.brackets(E.n),oi:K.copyProps(["did","n","t"],E),isNew:true};},ondrop:function(AT){AT.src.data=this.createToken(AT.src.data.item);if(this.prepareDropItem){this.prepareDropItem(AT);}var E=this.insertTokens([AT.src.data]);this.set("dropCuePos",null);mstrmojo.css.removeClass(this.domNode,"unselectable");return E;},ondragenter:function I(E){this.dragdata=E.src.data;this._super(E);this.set("dropCuePos",{left:0,top:0});mstrmojo.css.addClass(this.domNode,"unselectable");},ondragleave:function W(){this.set("dropCuePos",null);mstrmojo.css.removeClass(this.domNode,"unselectable");},ondropCuePosChange:function Y(AT){var AU=AT.value,E=this.dragdata;if(E&&E.setAvatarClass){if(AU){E.setAvatarClass("add");}else{E.setInvalidAvatarClass();}}},makeObservable:true,showDesc:true,showPath:true,showFunctionSyntaxAsPath:true,blockCount:mstrmojo.ME.MetricDataService.blockCount,suggestCount:mstrmojo.ME.MetricDataService.suggestCount,markupString:'<div id={@id} class="mstrmojo-TokenInputBox {@cssClass}" style="{@cssText}"><div class="mstrmojo-TokenInputBox-edit" contenteditable="true" tabindex="1" spellcheck="false"ondragstart = "return false;" oncontextmenu = "return false;" onkeydown = "return mstrmojo.all.{@id}.handlekeydown(event);" onkeypress = "return mstrmojo.all.{@id}.handlekeypress(event);" onkeyup = "return mstrmojo.all.{@id}.handlekeyup(event);" onmouseup = "return mstrmojo.all.{@id}.handlemouseup(event);" onpaste = "return mstrmojo.all.{@id}.handlepasteDirect(event);" onblur = "return mstrmojo.all.{@id}.handleblur(event);" >{@itemsHtml}</div><textarea class = "mstrmojo-TokenInputBox-clipboard" onkeyup = "return mstrmojo.all.{@id}.handlepaste(event);"></textarea><div class="mstrmojo-ListBase2-dropCue {@cssClass}"><div class="mstrmojo-ListBase2-dropCue-inner"></div></div></div>',markupSlots:{editNode:function(){return this.domNode.firstChild;},itemsContainerNode:function(){return this.domNode.firstChild;},clipboardNode:function(){return this.domNode.childNodes[1];},scrollboxNode:function(){return this.domNode.firstChild;},dropCueNode:function(){return this.domNode.lastChild;}},suggestionListClass:"mstrmojo.ui.ScrollableSuggestionList",items:null,itemFunction:function J(AU,E,AT){return new mstrmojo.ME.MetricToken({data:AU,parent:AT});},listMapper:mstrmojo.ME.SpanListMapper,_set_items:function X(AT,E){if(this._super){this._super(AT,E);}if(this.oi){this.oi.tks.items=this.items;}if(!this.tokensCacheInitilized){this.pretokensModify();this.tokensCacheInitilized=true;}},tokensCache:[],tokensCachePointer:0,isDelimiter:AC,postBuildRendering:function e(){if(this._super){this._super();}this._eros=false;if(R.isFF){document.body.spellCheck=false;}mstrmojo.dom.attachEvent(this.editNode,"compositionstart",function(){this.saveStateForIME();this.composing=true;this.toggleIMEStatusBar(true);}.bind(this));mstrmojo.dom.attachEvent(this.editNode,"compositionupdate",function AT(AU){if(R.isIEW3C){this.lastImeChar=AU.data||(M&&this.lastImeChar);}else{this.lastImeChar=AU.data||this.lastImeChar;}}.bind(this));mstrmojo.dom.attachEvent(this.editNode,"compositionend",function E(AW){this.composing=false;if(R.isIE9||R.isIE10){var AV=H.getRangeInfo();this.imeBuffer=AV.startContainer.data.slice(this.prev_rInfo.startOffset,AV.startOffset).split("");}else{if(R.isIEW3C){var AV=H.getRangeInfo();this.imeBuffer=AV.startContainer.data.slice((this.prev_rInfo.startOffset-1)<0?0:this.prev_rInfo.startOffset,AV.startOffset).split("");}else{if(R.isEdge){var AU=AW.data||"";this.imeBuffer=(this.imeBuffer||[]).concat(AU.split(""));}else{var AU=AW.data||this.lastImeChar||"";this.imeBuffer=(this.imeBuffer||[]).concat(AU.split(""));}}}}.bind(this));},fnContextMenu:function N(E){if(E){E.cancelBubble=true;E.returnValue=false;}return false;},saveStateForIME:function h(){if(!this.doubleByte){this.doubleByte=true;this.prev_rInfo=H.getRangeInfo();this.prev_items=this.items;}},handleblur:function L(){if(this.doubleByte){this.doubleByte=false;this.widgetHandleImeInput(this.prev_rInfo);this.prev_items=this.items;}},processDeleteKeyDown:function D(AT){if(!this.doubleByte){try{this.widgetHandleDelete(AT);this.startTokenSuggestion();this.raiseChangeEvent({type:"delete"});}catch(E){}return true;}},processBackspaceKeyDown:function AQ(AT){if(!this.doubleByte){try{this.widgetHandleBackspace(AT);this.raiseChangeEvent({type:"backspace"});this.startTokenSuggestion();this.editNode.focus();}catch(E){}return true;}},handlekeydown:function b(AV){AV=AV||window.event;var E=AV.keyCode||AV.charCode,AT=false,AU=H.getRangeInfo();if((E===AK.LEFT_ARROW||E===AK.RIGHT_ARROW||E===AK.BACKSPACE)&&this.doubleByte){if(this.composing){return ;}this.doubleByte=false;if(E===AK.BACKSPACE){this.imeBuffer.pop();}this.widgetHandleImeInput(this.prev_rInfo);mstrmojo.dom.stopPropogation(window,AV);mstrmojo.dom.preventDefault(window,AV);return false;}switch(E){case AK.DELETE:AT=this.processDeleteKeyDown(AU);break;case AK.BACKSPACE:AT=this.processBackspaceKeyDown(AU);break;case AK.ENTER:if(this.breakOnEnterKeyDown&&this.breakOnEnterKeyDown()){break;}case AK.TAB:this._startDebug=true;if(this.suggestionShown){this.handleSuggestionItemSelect(this.getSelected());}else{this.startTokenSuggestion();}AT=true;break;case AK.ESCAPE:this.endTokenSuggestion();AT=true;break;case 86:if(AS(AV)){this.handlePasteTriggeredDeletion();AT=false;}break;case 89:if(AS(AV)){this.widgetHandleUndoRedo("redo");AT=true;}break;case 90:if(AS(AV)){this.widgetHandleUndoRedo("undo");AT=true;}break;case 229:this.saveStateForIME();break;default:}if(AT){R.stopPropogation(window,AV);R.preventDefault(window,AV);return false;}return true;},handlePasteTriggeredDeletion:function F(){this.set("_saveRangeInfo",H.getRangeInfo());if(!this._saveRangeInfo.collapsed){this.widgetHandleDelete(this._saveRangeInfo);this.set("_saveRangeInfo",H.getRangeInfo());}this.clipboardNode.focus();},getCharacter:function AM(AT){var E=(R.isIE&&!R.isIE9)?AT.keyCode:AT.charCode;return(E>0)?String.fromCharCode(E):null;},handleCharacter:function AD(AV){var AW=this.getCharacter(AV),AT=false;if(AW&&!((AW==="c"||AW==="a")&&AS(AV))){try{this.widgetHandleInput(H.getRangeInfo(),AW);this.raiseChangeEvent({type:"input",character:AW});if(!this.isDelimiter(AW)){if(this.useKeyDelay){var AU=this;window.clearTimeout(this.tmr);this.tmr=window.setTimeout(function(){AU.startTokenSuggestion();},mstrmojo.ME.MetricDataService.suggestDelay);}else{this.startTokenSuggestion();}}else{this.endTokenSuggestion(true);}}catch(E){}AT=true;}return AT;},handlekeypress:function B(E){E=E||window.event;if(this.doubleByte){this.toggleIMEStatusBar(false);this.doubleByte=false;this.widgetHandleImeInput(this.prev_rInfo);window.setTimeout(function(){this.handleCharacter(E);}.bind(this),10);return false;}if(this.handleCharacter(E)){R.stopPropogation(window,E);R.preventDefault(window,E);return false;}return true;},handlekeyup:function g(AU){var E=AU.keyCode||AU.charCode,AT;if(E===AK.LEFT_ARROW||E===AK.RIGHT_ARROW){AT=this.findObjectToken();if(AT&&AT===this._saveActiveToken){this.startTokenSuggestion(AT);}else{this.endTokenSuggestion();}}else{if(E===AK.UP_ARROW){this.preHighlight();}else{if(E===AK.DOWN_ARROW){this.nextHighlight();}else{if(E===AK.BACKSPACE&&this.doubleByte){if(E===AK.BACKSPACE&&!this.composing&&!R.isIE9){this.doubleByte=false;this.imeBuffer.pop();this.widgetHandleImeInput(this.prev_rInfo);this.prev_items=this.items;}}}}}this.set("_saveRangeInfo",H.getRangeInfo());},handlemouseup:function q(AV){if(this.dropCuePos){return false;}var AT=this.findObjectToken();if(AT&&AT===this._saveActiveToken){this.startTokenSuggestion(AT);}else{this.endTokenSuggestion();}var AU=H.getRangeInfo();if(this.doubleByte){this.doubleByte=false;var E=this.widgetHandleImeInput(this.prev_rInfo);this.prev_items=this.items;AT=R.findWidget(AU.startContainer);if(AT){this._delaySetTextCaretPos(AT.domNode,AU.startOffset);}else{this._delaySetTextCaretPos(E.domNode,AU.startOffset-1);}this.prev_rInfo=AU;}this.set("_saveRangeInfo",AU);},handlepasteDirect:function AH(E){this.clipboardNode.value=E.clipboardData.getData("Text");this.handlepaste(E);R.stopPropogation(window,E);R.preventDefault(window,E);this.handlePasteTriggeredDeletion();return false;},handlepaste:function o(AX){var AT=this.clipboardNode.value;this.clipboardNode.value="";var AW=[],E=AT&&AT.length,AV,AU="",AY;if(E>0){for(AV=0;AV<E;AV++){AY=AT.charAt(AV);if(this.isDelimiter(AY)){if(!mstrmojo.string.isEmpty(AU)){AW.push({v:AU,isNew:true});AU="";}AW.push({v:AY,isDelimiter:true,isNew:true});}else{AU=AU+AY;}}if(!mstrmojo.string.isEmpty(AU)){AW.push({v:AU,isNew:true});AU="";}this.insertTokens(AW);}},raiseChangeEvent:function(E){E.name="tokensModify";this.raiseEvent(E);},getTokensAsString:function AP(){var AT=[],AV=this.items,AU,E;for(AU=0,E=AV.length;AU<E;AU++){AT[AU]=AV[AU].v;}return AT.join("| ");},replaceErrorToken:function r(AV){var AU=this.items||[],AW=mstrmojo.array.find(AU,"sta",-1),AT,AX=function(Ad,Ab,Ae){var Aa=(Ad&&Ad.items)||[],AZ=t.find(Aa,"did",Ab),AY,Ac;if(AZ>-1){AY=Aa[AZ].fs;Ac=t.filterOne(AY,function(Af){return Af.fnm&&Af.fnm.toUpperCase()===Ae.toUpperCase();});}return Ac;},E=function(Ad,Ab,Ac){var AY={v:Ab.n,oi:Ab,isNew:true},Aa=Ad.v&&Ad.v.split("@"),AZ;if(Aa&&Aa.length>1){AZ=AX(Ac,Ab.did,Aa[1]);if(AZ){AY.exv=AZ.fmdid||AZ.fid;AY.extp=8;AY.v=mstrmojo.ME.MetricToken.brackets(Ab.n)+"@"+AZ.fnm;}}return AY;};if(AW>-1){AT=E(AU[AW],AV,this.candidates);this.remove(AW);this.add([AT],AW);}},widgetHandleDelete:function f(AW){if(AW.collapsed){var AV,AU,E,AX=AW.startOffset,AT=this.ctxtBuilder.itemWidgets;if(!R.contains(this.editNode,AW.startContainer,false,document.body)){H.collapseOnNode(this.editNode,false);return ;}AV=H.getEdgeInfo(AW.startContainer,AW.startOffset);AU=R.findWidget(AW.startContainer);E=this.itemIndex(AU.data);if(AV===l.EDGE_END){E++;AU=AT[E];AX=0;}if(!AU){H.collapseOnNode(this.editNode,false);return ;}if(AU.length()===1){this.remove(E);AU=AT[E];if(AU){H.collapseOnNode(AU.domNode,true);}else{H.collapseOnNode(this.editNode,false);}this.checkMergeTwoTokens(E-1,E);}else{AU.spliceContent(AX,1);H.collapseOnTextNode(AU.domNode,AX);}}else{this.widgetDeleteTokens(AW);}},widgetHandleBackspace:function AB(AW){if(AW.collapsed){var AV,AU,E,AX=AW.startOffset,AT=this.ctxtBuilder.itemWidgets;if(!R.contains(this.editNode,AW.startContainer,false,document.body)){if(AW.startOffset>0&&R.isFF){AU=AT[this.items.length-1];H.collapseOnNode(AU.domNode,false);AW=H.getRangeInfo();AV=H.getEdgeInfo(AW.startContainer,AW.startOffset);}else{H.collapseOnNode(this.editNode,true);return ;}}AV=H.getEdgeInfo(AW.startContainer,AW.startOffset);AU=R.findWidget(AW.startContainer);E=this.itemIndex(AU.data);if(AV===l.EDGE_BEGIN){E--;AU=AT[E];AX=AU.length();}if(!AU){H.collapseOnNode(this.editNode,true);return ;}if(AU.length()===1){this.remove(E);AU=AT[E-1];if(AU){H.collapseOnNode(AU.domNode,false);this.checkMergeTwoTokens(E-1,E);AU=AT[E-1];}else{H.collapseOnNode(this.editNode,true);}}else{AU.spliceContent(AX-1,1);H.collapseOnTextNode(AU.domNode,AX-1);}}else{this.widgetDeleteTokens(AW);}},widgetHandleInput:function AE(AX,AY){if(!AX.collapsed){this.widgetDeleteTokens(AX);AX=H.getRangeInfo();}var AU,AZ,Aa,Ab,E,AT,AV=this.ctxtBuilder.itemWidgets;if(!R.contains(this.editNode,AX.startContainer,false,document.body)){this.add([{v:AY,isDelimiter:this.isDelimiter(AY),isNew:true}],0);AZ=AV[0];H.collapseOnTextNode(AZ.domNode,1);return ;}AU=H.getEdgeInfo(AX.startContainer,AX.startOffset);AZ=R.findWidget(AX.startContainer);Aa=this.itemIndex(AZ.data);if(this.isDelimiter(AY)){Ab={v:AY,isDelimiter:true,isNew:true};if(AU===l.EDGE_MIDDLE){var AW=AZ.split2Tokens(AX.startOffset);this.remove(Aa);this.add([AW[0],Ab,AW[1]],Aa);Aa=Aa+1;}else{Aa=(AU===l.EDGE_BEGIN)?Aa:Aa+1;this.add([Ab],Aa);}AZ=AV[Aa];H.collapseOnTextNode(AZ.domNode,(AZ.domNode.innerText||AZ.domNode.textContent).length);}else{AT=AX.startOffset;if(AZ.isDelimiter()){E=AV[(AU===l.EDGE_BEGIN)?Aa-1:Aa+1];if(E&&!E.isDelimiter()){AZ=E;AT=(AU===l.EDGE_BEGIN)?AZ.length():0;}}if(!AZ.isDelimiter()){AZ.spliceContent(AT,0,AY);H.collapseOnTextNode(AZ.domNode,AT+1);}else{this.add([{v:AY,isNew:true}],(AU===l.EDGE_BEGIN)?Aa:Aa+1);AZ=AV[(AU===l.EDGE_BEGIN)?Aa:Aa+1];H.collapseOnNode(AZ.domNode,false);}}},widgetHandleImeInput:function AE(AW,AX){AX=AX||this.imeBuffer.join("");this.imeBuffer=[];this.lastImeChar=null;if(!AX){return ;}if(!AW.collapsed){this.widgetDeleteTokens(AW);AW=H.getRangeInfo();}var AU,AY,AZ,Aa,E,AT,AV=this.ctxtBuilder.itemWidgets;if(!R.contains(this.editNode,AW.startContainer,false,document.body)||this.items.length==0){this.clearTokens();this.add([{v:AX,isDelimiter:this.isDelimiter(AX),isNew:true}],0);AV=this.ctxtBuilder.itemWidgets;AY=AV[0];H.collapseOnTextNode(AY.domNode,1);this._delaySetCaretPos(AY.domNode,false);return ;}AU=H.getEdgeInfo(AW.startContainer,AW.startOffset);AY=R.findWidget(AW.startContainer);AZ=this.itemIndex(AY.data);AT=AW.startOffset;if(AY.isDelimiter()){this.clearTokens();this.add(this.prev_items);AV=this.ctxtBuilder.itemWidgets;E=AV[(AU===l.EDGE_BEGIN)?AZ-1:AZ+1];if(E&&!E.isDelimiter()){AY=E;AT=(AU===l.EDGE_BEGIN)?AY.length():0;}}if(!AY.isDelimiter()){AY.spliceContent(AT,0,AX);this._delaySetTextCaretPos(AY.domNode,AT+AX.length);}else{this.add([{v:AX,isNew:true}],(AU===l.EDGE_BEGIN)?AZ:AZ+1);AY=AV[(AU===l.EDGE_BEGIN)?AZ:AZ+1];this._delaySetCaretPos(AY.domNode,false);}this.startTokenSuggestion();return AY;},findObjectToken:function C(){var AW=H.getRangeInfo(),AU=R.findWidget(AW.startContainer);if(!R.contains(this.editNode,AW.startContainer,false,document.body)){return null;}if(!AU||AU===this||!AU.isDelimiter){return null;}if(AU&&!AU.isDelimiter()){return AU;}var AV=H.getEdgeInfo(AW.startContainer,AW.startOffset),AT=this.ctxtBuilder.itemWidgets,E=this.itemIndex(AU.data);AU=AT[(AV===l.EDGE_BEGIN)?E-1:E+1];if(AU&&!AU.isDelimiter()){return AU;}return null;},checkMergeTwoTokens:function z(AW,AU){var AV=this.ctxtBuilder.itemWidgets,AT=AV[AW],E=AV[AU];if((AT&&!AT.isDelimiter())&&(E&&!E.isDelimiter())){this.remove([AW,AU]);this.add([AT.mergeTo(E)],AW);H.collapseOnTextNode(AV[AW].domNode,AT.length());}},insertTokens:function AG(AX){var Aa=0,AZ=this.editNode;var AU=this._saveRangeInfo||H.getRangeInfo();if(!AU||!R.contains(AZ,AU.startContainer,false,document.body)){this.add(AX);Aa=this.items.length-1;if(Aa===0){this._delaySetTextCaretPos(AZ,(AZ.innerText||AZ.textContent).length);}else{var E=this.ctxtBuilder.itemWidgets[Aa].domNode;this._delaySetTextCaretPos(E,(E.innerText||E.textContent).length);}}else{var AT=H.getEdgeInfo(AU.startContainer,AU.startOffset),AY=R.findWidget(AU.startContainer);Aa=this.itemIndex(AY.data);if(AT===l.EDGE_MIDDLE){var AV=AY.split2Tokens(AU.startOffset);this.remove(Aa);AX.unshift(AV[0]);AX.push(AV[1]);this.add(AX,Aa);}else{Aa=(AT===l.EDGE_BEGIN?Aa:Aa+1);this.add(AX,Aa);}Aa=Aa+AX.length-1;AY=this.ctxtBuilder.itemWidgets[Aa];this._delaySetCaretPos(AY.domNode,false);}this.raiseChangeEvent({type:"insert"});var AW=this;window.setTimeout(function(){AW.set("_saveRangeInfo",H.getRangeInfo());},50);return Aa;},insertParenthesisTokens:function AJ(AT){var E=this;window.setTimeout(function(){var AU=E.insertTokens([{v:"(",isDelimiter:true,isNew:true},{v:")",isDelimiter:true,isNew:true}]);E._delaySetTextCaretPos(E.itemsContainerNode.childNodes[AU-1],1);},AT||50);},clearTokens:function x(E){this.set("items",E||[]);this.set("_saveRangeInfo",null);this._delaySetCaretPos(this.editNode,false);},focus:function AF(){var AT=this.ctxtBuilder.itemWidgets,E=AT.length;this._delaySetCaretPos(E>0?AT[E-1].domNode:this.editNode,false);},startTokenSuggestion:function AL(E){this.endTokenSuggestion();if(!E){E=this.findObjectToken();}if(E&&!E.isDelimiter()){E.set("active",true);this._saveActiveToken=E;this.showSuggestion(this.getSearchPattern());}if(!E||this.getSearchPattern().length===0){this.hideSuggestion();}},browseItemVisible:true,folderLinksContextId:25,browsableTypes:[Q.TP.FOLDER,Q.TP.FACT,Q.TP.ATTR,Q.TP.FUNCTION,Q.TP.FILTER,Q.STP.PROMPT_OBJECTS,Q.TP.ATTR,Q.TP.DIM,Q.TP.METRIC,Q.TP.ROLE].join(","),getSearchPattern:function a(){var AT=this._saveActiveToken,AV=AT&&AT.data.v,E=AV&&AV.length;if(E>2){if(AV.charAt(0)==="["){AV=AV.substring(1);}if(AV.charAt(AV.length-1)==="]"){AV=AV.substring(0,AV.length-1);}}if(AT&&AT.data.ift){var AU=AT.data.v,AW=AU&&AU.indexOf("@");if(AW>=0){AV=AU.substring(AW);}}return AV||"";},getSuggestionPos:function k(){var E=this._saveActiveToken,AT=null,AV,AU;if(E){AV=E.data&&E.data.ift;AU=mstrmojo.dom.position(E.domNode,true);AT={left:Math.round(AU.x+(AV?AU.w:0))+"px",top:Math.round(AU.y+AU.h)+"px",zIndex:100};}return AT;},item2textCss:function O(AT){var E=(this._super&&this._super(AT))||{4:"m",11:"fx",12:"a",13:"fc",43:"tr",21:"afm","-99":"br"}[AT.t]||"";E+=AT.da?" da":"";E+=(AT.dm||AT.um)?" dm":"";E+=AT.de?" de":"";E+=AT.fs&&AT.fs.length&&AT.fs.some(function(AU){return AU.fgr>0;})?" g":"";return E;},onBrowserOpen:function AA(){this.editNode.blur();},onSuggestionItemSelect:function AI(AT){var E=this._saveActiveToken;this.endTokenSuggestion();if(E){if(E.data.ift&&AT.t===21){E.setFormInfo(AT);}else{E.setItemInfo(AT);if(AT.t===mstrmojo.mstr.EnumDSSXMLObjectTypes.Function){this.insertParenthesisTokens();}}this._delaySetCaretPos(E.domNode,false);}this.closePopup();},_delaySetCaretPos:function AN(E,AU){var AT=this.editNode,AV=this,AW=function(){AT.focus();AT.focus();H.collapseOnNode(E,AU);AV.set("_saveRangeInfo",H.getRangeInfo());};window.setTimeout(AW,0);},_delaySetTextCaretPos:function AN(E,AW){var AT=this.editNode,AU=this,AV=function(){AT.focus();AT.focus();H.collapseOnTextNode(E,AW);AU.set("_saveRangeInfo",H.getRangeInfo());};window.setTimeout(AV,0);},getCandidatesThroughTaskCall:function d(AT,E){AT.objectType="11,12,13,43,4";AT.rootFolderType=39;AT.blockCount=this.blockCount;mstrmojo.ME.MetricDataService.getMetricComponents(AT,E);},filterCandidates:function w(AW,AV,E){var AT=this._saveActiveToken,AX=AT&&(AT.data.oi||AT.data.at),AU;if(AX&&AT.data.ift){E=E||this.suggestCount;AV=mstrmojo.string.regEscape(AV);AU=t.filter(AW,function(AY){return AY.t===21&&AY.attid===AX.did&&(new RegExp("^"+AV,"i")).test("@"+AY.n);},{max:E});}else{AU=t.filter(AW,function(AY){return AY.t!==21;});AU=this._super(AU,AV,E);}return AU;},endTokenSuggestion:function AO(AT){var E=this._saveActiveToken;if(E){if(AT){this.hideSuggestion();}E.set("active",false);this._saveActiveToken=null;}},widgetDeleteTokens:function p(Ab){var AT=Ab.startOffset,E=Ab.endOffset,Ae=R.findWidget(Ab.startContainer),Ac=R.findWidget(Ab.endContainer),AX=this.itemIndex(Ae.data),AV=this.itemIndex(Ac.data),AY=[],AZ=H.getEdgeInfo(Ab.startContainer,AT),Ad=H.getEdgeInfo(Ab.endContainer,E),Aa=(AZ===l.EDGE_BEGIN?AX:AX+1),AU=(Ad===l.EDGE_END?AV:AV-1),AW;if(Ae===Ac){if((AZ===l.EDGE_BEGIN)&&(Ad===l.EDGE_END)){this.remove(AX);Ac=this.ctxtBuilder.itemWidgets[AX===0?AX:AX-1];if(Ac){H.collapseOnNode(Ac.domNode,AX===0);}else{H.collapseOnNode(this.editNode,true);}}else{Ae.spliceContent(AT,E-AT);H.collapseOnTextNode(Ac.domNode,AT);}}else{for(AW=Aa;AW<=AU;AW++){AY.push(AW);}this.remove(AY);if(AZ===l.EDGE_MIDDLE){Ae.spliceContent(AT);}if(Ad===l.EDGE_MIDDLE){Ac.spliceContent(0,E);}if(AZ===l.EDGE_BEGIN){Ae=this.ctxtBuilder.itemWidgets[AX===0?AX:AX-1];}if(Ae){H.collapseOnNode(Ae.domNode,AX===0);}else{H.collapseOnNode(this.editNode,false);}AX=(AZ===l.EDGE_BEGIN)?AX-1:AX;this.checkMergeTwoTokens(AX,AX+1);}this.editNode.focus();},oncandidatesChange:function u(){var AT=this.candidates,E=(AT&&AT.items)||[];if(!this.noCache&&AT&&AT.isComplete){this.suggestCount=this.REQUEST_THRESHOLD=E.length;}else{this.suggestCount=mstrmojo.ME.MetricDataService.suggestCount;this.REQUEST_THRESHOLD=20;}},nudge:function(E){var AT=this.getSuggestionPos();if(AT){E.set("left",AT.left);E.set("top",AT.top);}},pretokensModify:function P(){this.tokensCache=this.tokensCache.slice(0,this.tokensCachePointer);var E=this.findObjectToken();this.tokensCache.push({items:K.clone(this.items),rInfo:H.getRangeInfo(),idx:E!==null?this.itemIndex(E.data):-1});this.tokensCachePointer=this.tokensCache.length;},widgetHandleUndoRedo:function n(AU){var AV,E,AT=function(AX){if(!AX){return ;}AX=AX||{};this.set("items",K.clone(AX.items));var Aa=this.ctxtBuilder.itemWidgets,AW=Aa[AX.idx],AZ=AW&&AW.domNode||this.editNode,AY=AX.rInfo;this._delaySetTextCaretPos(AZ,AY&&AY.startOffset||0);};switch(AU){case"undo":AV=--this.tokensCachePointer;if(AV>-1){E=this.tokensCache[AV-1];AT.call(this,E);}else{this.tokensCachePointer=1;}break;case"redo":AV=this.tokensCachePointer++;if(AV>-1&&AV<this.tokensCache.length){E=this.tokensCache[AV];AT.call(this,E);}else{this.tokensCachePointer=Math.min(Math.max(this.tokensCachePointer,1),this.tokensCache.length);}break;}},resetTokensCache:function Z(){this.tokensCache=[];this.tokensCachePointer=-1;this.tokensCacheInitilized=false;},toggleIMEStatusBar:function c(E){if((R.isIE9||R.isIE10||R.isIEW3C||R.isEdge)&&this.detectKoreanLocale()){if(E){if(!this.elStatus||!this.elStatus.offsetParent){var AT=this.elStatus=document.createElement("div");AT.innerText=mstrmojo.desc(15003,"Please enter space key to finish IME typing");AT.className="mstrmojo-TokenInputBox-status";this.domNode.appendChild(AT);}}else{this.domNode.removeChild(this.elStatus);delete this.elStatus;}}},detectKoreanLocale:function m(){var E=window.navigator;if(window.mstrConfig&&(window.mstrConfig.browserLang||[]).indexOf("ko")>=0){return true;}else{if(E.userLanguage=="ko"||E.userLanguage=="ko-KR"||E.browserLanguage=="ko"||E.browserLanguage=="ko-KR"){return true;}}return false;}});}());(function(){mstrmojo.requiresCls("mstrmojo.DataGrid","mstrmojo.ui.menus._HasMenuPopup","mstrmojo.DI.DIHelpers","mstrmojo.qb.menu.SimpleGridMenu","mstrmojo.hash");var L=mstrmojo.string,C=mstrmojo.DI.DIHelpers,J=mstrmojo.dom,K=mstrmojo.array,G=mstrmojo.hash;var D;function I(N){var M=[];K.forEach(N,function(O){M.push(O.v);});return M.join("");}mstrmojo.qb.QBSimplePreview=mstrmojo.declare(mstrmojo.DataGrid,[mstrmojo.ui.menus._HasMenuPopup],{scriptClass:"mstrmojo.qb.QBSimplePreview",resizeColumnBehavior:mstrmojo.RESIZE_ALL_COLUMN_MODE,dataset:null,mappings:null,selectedColumns:null,visible:false,cssClass:"lockHeader mstrmojo-qb-simplepreview",lockHeader:true,markupMethods:{onvisibleChange:function(){this.domNode.style.display=this.visible?"block":"none";}},menuButton:null,adjustSize:function(Q){var P=60,O=this.parent&&this.parent.domNode,S=P*Q;if(!O||!this.scrollboxNode){return ;}this.scrollboxNode.style.overflow="hidden";this.contentWidth="auto";var N=this.contentWidth,R=this.headerContainerNode,M=this.itemsContainerNode;if(N&&R&&M){R.style.width=N;M.style.width=N;}this.onheightChange();},onmouseover:function(){var M=mstrmojo.hash.walk("itemsContainerNode.firstChild.clientWidth",this)||0,N=this.parent&&this.parent.domNode;this.scrollboxNode.style.overflowX=(M>N.clientWidth)?"auto":"hidden";this.scrollboxNode.style.overflowY="auto";},onmouseout:function(){this.scrollboxNode.style.overflow="hidden";},onheightChange:function E(){var O=this.height,M=this.headerContainerNode,N=this.scrollboxNode;if(O&&M&&N){N.style.height=parseInt(O,10)-M.clientHeight-1+"px";}this.domNode.style.height=parseInt(this.height,10)-(C.getEnvObj().isWSDossierLocalMode()?60:0)+"px";},onwidthChange:function F(){if(this.domNode&&this.mappings){this.domNode.style.width="100%";this.adjustSize(this.mappings.length);}},postBuildRendering:function B(){if(this._super){this._super();}mstrmojo.dom.attachMarkupEvent(this.id,this.domNode,"mouseover");mstrmojo.dom.attachMarkupEvent(this.id,this.domNode,"mouseout");if(C.getEnvObj().isWS()){this.hasCustomScrollbar=true;}},populatePreview:function A(){var R=this.mappings,V=this.selectedColumns,N=0,M=this.scrollboxNode,Q,U,O,P,W=this;this.columns=[];if(M){N=M.scrollLeft||0;}this.unrender();if(this.isRefined&&!mstrApp.isFFSQLMode){K.forEach(V,function(a,d){var f=a.colo,e,Z;e=mstrApp.isFFSQLMode?a.n:I(V[d].expr);Z={tag:a,headerWidget:{scriptClass:"mstrmojo.Box",cssClass:"mstrmojo-qb-simplegrid-header",columnIndex:d,headerText:e,menuCssClass:mstrApp.isFFSQLMode?"":"mstrmojo-qb-simplegrid-itemmenu",markupString:'<div id="{@id}" class="mstrmojo-Box {@cssClass}" style="{@cssText}"><span class="mstrmojo-qb-simplegrid-headertext">{@en@headerText}</span><span class="{@menuCssClass}" mstrAttach:click></span></div>',useRichTooltip:true,postBuildRendering:function c(){if(this._super){this._super();}this.set("richTooltip",{cssClass:"vi-regular vi-tooltip-V",refNode:this.domNode,posType:mstrmojo.tooltip.POS_BOTTOMLEFT,content:e});if(!this._ontooltipover){var g=this.id;this._ontooltipover=function(j){var h=mstrmojo.all[g];h.showTooltip(j,self);};this._ontooltipout=function(j){var h=mstrmojo.all[g];h.hideTooltip(j,self);};}mstrmojo.dom.attachEvent(this.domNode,"mouseover",this._ontooltipover);mstrmojo.dom.attachEvent(this.domNode,"mouseout",this._ontooltipout);},onclick:function b(){var j=this.columnIndex,h=mstrApp.isFFSQLMode;if(h){return ;}D.showPopupMenu(W,{menuNode:this.domNode.lastChild,data:{columnIndex:j,isVisible:function g(l,k){return h?false:true;}}});}},colWidth:"60",dataFunction:function(l,h,k){var g=l[this.dataField],j="mstrmojo-di-datapreview-DataRow-text";j+=(h%2===1)?" odd":" even";return'<div class="'+j+'" title="'+g+'">'+g+"</div>";},dataField:d.toString()};W.columns.push(Z);});}else{K.forEach(R,function(a,d){var f=mstrApp.isFFSQLMode?G.walk("dicl.clix",a):a.colo,e,Z;e=mstrApp.isFFSQLMode?a.cln:I(V[f].expr);Z={tag:a,headerWidget:{scriptClass:"mstrmojo.Box",cssClass:"mstrmojo-qb-simplegrid-header",columnIndex:f,headerText:e,menuCssClass:mstrApp.isFFSQLMode?"":"mstrmojo-qb-simplegrid-itemmenu",markupString:'<div id="{@id}" class="mstrmojo-Box {@cssClass}" style="{@cssText}"><span class="mstrmojo-qb-simplegrid-headertext">{@en@headerText}</span><span class="{@menuCssClass}" mstrAttach:click></span></div>',useRichTooltip:true,postBuildRendering:function c(){if(this._super){this._super();}this.set("richTooltip",{cssClass:"vi-regular vi-tooltip-V",refNode:this.domNode,posType:mstrmojo.tooltip.POS_BOTTOMLEFT,content:e});if(!this._ontooltipover){var g=this.id;this._ontooltipover=function(j){var h=mstrmojo.all[g];h.showTooltip(j,self);};this._ontooltipout=function(j){var h=mstrmojo.all[g];h.hideTooltip(j,self);};}mstrmojo.dom.attachEvent(this.domNode,"mouseover",this._ontooltipover);mstrmojo.dom.attachEvent(this.domNode,"mouseout",this._ontooltipout);},onclick:function b(){var j=this.columnIndex,h=mstrApp.isFFSQLMode;if(h){return ;}D.showPopupMenu(W,{menuNode:this.domNode.lastChild,data:{columnIndex:j,isVisible:function g(l,k){return h?false:true;}}});}},colWidth:"178",dataFunction:function(l,h,k){var g=l[this.dataField],j="mstrmojo-di-datapreview-DataRow-text";j+=(h%2===1)?" odd":" even";return'<div class="'+j+'" title="'+g+'">'+g+"</div>";},dataField:d.toString()};W.columns.push(Z);});}O=this.dataset;if(O.length===0&&this.columns.length>0){var X=21;var S=parseInt(parseInt(this.parent.height,10)/X,10)-1;S=S>0?S:1;var Y;for(Q=0;Q<S;Q++){Y=[];for(P=0,U=this.columns.length;P<U;P++){Y.push("");}O.push(Y);}}this.items=O;this.render();this.adjustSize(R.length);this.scrollboxNode.scrollLeft=N;if(C.isIEOrEdge()||J.isFF){this.disableScroll(false);}},onvisibleChange:function(M){if(M.value){this.populatePreview();}}});D=mstrmojo.qb.QBSimplePreview;D.showPopupMenu=function H(P,N){var O=D.menuHelper=D.menuHelper||new mstrmojo.qb.menu.SimpleGridMenu();O.target=P;O.data=N.data;var M=O.getMenuConfig();M.hostId=P.id;M.hostElement=N.menuNode;M.isHostedWithin=false;M.position=mstrmojo.dom.position(N.menuNode,true);P.openPopup(M.newInstance());};}());(function(){mstrmojo.requiresCls("mstrmojo.Container","mstrmojo._HasLayout","mstrmojo.vi._MonitorsAppState","mstrmojo.EditableLabel","mstrmojo.vi.ui.toolbars.TitleToolbar");var J=mstrmojo.dom;mstrmojo.vi.ui.TitleBar=mstrmojo.declare(mstrmojo.Container,[mstrmojo._HasLayout,mstrmojo.vi._MonitorsAppState],{scriptClass:"mstrmojo.vi.ui.TitleBar",markupString:'<div id="{@id}" class="mstrmojo-VITitleBar {@cssClass}" style="{@cssText}" mstrAttach:contextmenu,click><div class="left-toolbar"></div><div class="title-text"></div><div class="right-toolbar"></div></div>',markupSlots:{leftToolNode:function(){return this.domNode.firstChild;},textNode:function(){return this.domNode.childNodes[1];},rightToolNode:function(){return this.domNode.lastChild;},containerNode:function(){return this.domNode;}},markupMethods:{onhasContextMenuButtonChange:function(){var P=this.hasContextMenuButton;this.tbToolbar.set("visible",P);this.tbToolbar.set("enabled",P);},ontitleChange:function(){this.lblTitle.set("text",this.title||" ");},ontoolbarCfgChange:function(){var P=this.toolbarCfg;if(!P){return ;}this.tbToolbar.set("toolbarCfg",P);this.doLayout();},onvisibleChange:mstrmojo.Widget.visibleMarkupMethod},layoutConfig:{w:{leftToolNode:"auto",textNode:"100%",rightToolNode:"auto"},h:{leftToolNode:"100%",textNode:"100%",rightToolNode:"100%"},xt:true},lblTitle:null,tbToolbar:null,hasContextMenuButton:true,editTitleOnClick:false,editTitleOnDoubleClick:true,editTitleOnTwoClicks:false,title:"",close:mstrmojo.emptyFn,toolbarCfg:null,beganEditingTitlebar:mstrmojo.emptyFn,titleEdited:mstrmojo.emptyFn,useRichTooltip:true,init:function O(P){this._super(P);this.addChildren([].concat(this.getLeftToolbarChildren()).concat(this.getTitleChildren()).concat(this.getRightToolbarChildren()));},shouldShowTooltip:function K(P,R){var Q=P.target||J.eventTarget(P.hWin,P.e);return Q===this.textNode.firstChild&&(Q.scrollWidth>Q.clientWidth);},getTooltipContent:function L(P){var R=P.target||J.eventTarget(P.hWin,P.e),Q=R.innerHTML;return Q;},showTooltip:function M(P,Q){if(this.shouldShowTooltip(P,Q)){this._super(P,Q);}},updateTooltipConfig:function I(Q){var R=Q.target||J.eventTarget(Q.hWin,Q.e),P=J.position(R);this.richTooltip={posType:mstrmojo.tooltip.POS_TOPLEFT,content:this.getTooltipContent(Q),top:P.y+P.h+3,left:P.x+4,cssClass:"vi-regular vi-tooltip-A"};},getLabelNode:function C(){return this.lblTitle.domNode;},getMenuConfig:function B(){var P=this.toolbarCfg;if(P){if(P.hasMenuItems()){return P;}}return null;},setToolbarVisibility:function D(P){this.tbToolbar.set("visible",P);},editTitle:function N(){this.lblTitle.set("isEditing",true);},onAppStateChange:function F(P){var Q=this.lblTitle,R=mstrApp.isAppStatePresentation(),S=!!(P.valueWas&mstrmojo.vi.VisualInsightApp.APP_STATES.PRESENTATION);if(R&&this._confgTitleEditable===undefined){this._confgTitleEditable=this.editTitleOnClick||this.editTitleOnDoubleClick||this.editTitleOnTwoClicks;}Q.set("isEditing",false);if(R||S){Q.set("editOnDoubleClick",!R&&this._confgTitleEditable);}},getLeftToolbarChildren:function A(){},getTitleChildrenLayoutOffsets:function H(){return{h:2,w:2};},getTitleChildren:function G(){return[{scriptClass:"mstrmojo.EditableLabel",slot:"textNode",alias:"lblTitle",bindings:{editOnClick:"this.parent.editTitleOnClick",editOnDoubleClick:"this.parent.editTitleOnDoubleClick",selectable:"this.isEditing",editOnTwoClicks:"this.parent.editTitleOnTwoClicks"},onTextEditBegin:function(){this.parent.beganEditingTitlebar();},onTextEditComplete:function(R,Q){this.parent.titleEdited(this.text,R,Q);},getLayoutOffsets:function P(){return this.parent.getTitleChildrenLayoutOffsets();}}];},getRightToolbarChildren:function E(){return[{scriptClass:"mstrmojo.vi.ui.toolbars.TitleToolbar",slot:"rightToolNode",alias:"tbToolbar",visible:true,useRichTooltip:true,bindings:{hasContextMenuButton:"this.parent.hasContextMenuButton",}}];}});}());(function(){mstrmojo.requiresCls("mstrmojo.Editor","mstrmojo.Label","mstrmojo.array","mstrmojo.qb.DBTableRow");mstrmojo.requiresDescs(629,12912,12913,12914,10);var N=mstrmojo.string,Z=mstrmojo.dom,b=mstrmojo.css,K=mstrmojo.array;function C(c,e,f){var d=c.editorNode.style;e=(e<0)?0:e+"px";f=(f<0)?0:f+"px";d.left=e;c.set("left",e);c.left=e;d.top=f;c.set("top",f);c.top=f;}function A(c){var d=c.children[0].children;K.forEach(d,function(f,e){if(c.selectedIndex[e]){b.addClass(f.domNode,["selected"]);}else{b.removeClass(f.domNode,["selected"]);}});}function Y(d,c){d.canvasbox.domNode.style.width=d.maxWidth+"px";d.canvasbox.width=d.maxWidth+"px";d.linker.width=d.maxWidth;c.linkerNeedRender=true;d.linker.drawLinks();}function R(e,d,c){e.canvasbox.domNode.style.height=e.maxHeight+"px";e.canvasbox.height=e.maxHeight+"px";e.linker.height=e.maxHeight;d.linkerNeedRender=true;if(!c){e.linker.drawLinks();}}function D(d,h){var g=30,c=40,f=10,e;h=h?h+2:1;e=g*h;if(d.searchBox.visible){e+=c;}e+=f;return e;}function Q(e,f){var g=e.editorNode.style,l=parseInt(g.top),d=parseInt(g.height),k=e.container,j,c=false;if(l+d>k.maxHeight){k.maxHeight=l+d+10;j=parseInt(k.domNode.clientHeight);if(k.maxHeight>j){R(k,f,true);c=true;}else{k.domNode.scrollTop=0;}}return c;}function E(c){var d=this.Rows.children;K.forEach(d,function(e){e.domNode.firstChild.childNodes[1].style.width=(c-20)+"px";});}mstrmojo.qb.DBTable=mstrmojo.declare(mstrmojo.Editor,null,{scriptClass:"mstrmojo.qb.DBTable",title:"",left:"",top:"",minWidth:80,maxWidth:250,maxHeight:300,minHeight:20,model:null,prevPos:{},container:null,selectedIndex:[],draggable:true,noCheckBox:true,topAnchor:function I(){return(this.titlebarNode)?parseInt(this.top,10)+(this.titlebarNode.clientHeight/2)+"px":"0px";},leftAnchor:function U(){return this.left;},rightAnchor:function W(){return(this.editorNode)?parseInt(this.left,10)+this.editorNode.clientWidth+"px":"0px";},modal:false,zIndex:7,markupString:'<div id="{@id}" class="mstrmojo-Editor-wrapper"><div class="mstrmojo-Editor mstrmojo-qb-DBTable {@cssClass}" style="z-index:{@zIndex};{@cssText}" mstrAttach:mousedown,mouseup,click><div class = "mstrmojo-qb-DBTable-header" style="position:absolute;"><table cellspacing="0" cellpadding="0" class="mstrmojo-qb-DBTable-titlebar"><tr><td><input id="{@id}check" type="checkbox" mstrAttach:click></td><td><div class="mstrmojo-qb-DBTable-titleIcon"></div></td><td class="mstrmojo-Editor-titleCell"><div id="{@id}title" class="mstrmojo-qb-DBTable-title"  mstrAttach:dblclick></div></td><td><div class="mstrmojo-qb-DBTable-searchIcon" title="'+mstrmojo.desc(10,"Search")+'"></div></td><td><div class="mstrmojo-qb-DBTable-close" title="'+mstrmojo.desc(629,"Delete")+'"></div></td><td><div style="display:none;"></div></td></tr></table></div><div class="mstrmojo-Editor-titleSpacer"></div>{@titlebarHTML}<div class="mstrmojo-qb-DBTable-searchBox"></div><div class="mstrmojo-Editor-content" style="padding:0px;" mstrAttach:scroll,mouseover,mouseout></div><div class="mstrmojo-qb-table-resize-handle north" id="{@id}north" ></div><div class="mstrmojo-qb-table-resize-handle east" id="{@id}east"></div><div class="mstrmojo-qb-table-resize-handle south" id="{@id}south"></div><div class="mstrmojo-qb-table-resize-handle west" id="{@id}west"></div></div></div>',titleMarkupString:"",children:[{scriptClass:"mstrmojo.Box",alias:"Rows",cssText:"width:100%; background-color:white; border-top: 1px solid #C6C6C6; height:100%;white-space: nowrap;"},{scriptClass:"mstrmojo.TextBox",slot:"searchBoxNode",alias:"searchBox",visible:false,cssClass:"mstrmojo-qb-DBTable-searchInput",onvisibleChange:function O(e){var d=this.parent,g,k=22,j=this.visible?k:-k,c,f=mstrmojo.all.QBuilderModel,h=this;g=d.editorNode.style;g.height=parseInt(g.height)+j+"px";d.maxHeight+=j;if(this.visible){this.set("width",parseInt(g.width)-48+"px");window.setTimeout(function(){h.focus();},0);}c=Q(d,f);if(mstrApp.getRootController().hasTableJoin(d.id)||c){window.setTimeout(function(){d.container.linker.drawLinks();},0);}},onvalueChange:function P(){var p=this.parent,g,m=p.Rows.children,o,d,j=this.inputNode.value.toLowerCase(),f=0,e,l=264,n=false,h,c=mstrmojo.all.QBuilderModel;for(g=1;g<m.length;g++){o=m[g];o.set("keyword",j);if(o.text.toLowerCase().indexOf(j.toLowerCase())>=0){f++;}if(!!o.isVisibleChanged){n=true;}if(o.visible){o.set("cssClass",(f-1)%2?"odd":"even");}}if(!n){return ;}m[0].set("visible",f>0);var k=p.domNode.getElementsByClassName("no-match");if(f===0){if(k.length===0){d=document.createElement("div");d.className="no-match";d.innerText=mstrmojo.desc(15573,"No matched result");d.style.display="block";p.Rows.domNode.appendChild(d);}else{k[0].style.display="block";}}else{if(k.length>0){k[0].style.display="none";}}e=D(p,f);p.maxHeight=e;p.set("height",(e>l)?l:e);h=Q(p,c);if(n||h){p.container.linker.drawLinks();}}}],markupSlots:{editorNode:function(){return this.domNode.firstChild;},titlebarNode:function(){return this.showTitle?this.domNode.firstChild.firstChild.firstChild:null;},checkBoxNode:function(){return this.showTitle?this.domNode.firstChild.firstChild.firstChild.rows[0].cells[0].firstChild:null;},titleIconNode:function(){return this.showTitle?this.domNode.firstChild.firstChild.firstChild.rows[0].cells[1].firstChild:null;},titleNode:function(){return this.showTitle?this.domNode.firstChild.firstChild.firstChild.rows[0].cells[2].firstChild:null;},helpNode:function(){return this.showTitle?this.domNode.firstChild.firstChild.firstChild.rows[0].cells[5].firstChild:null;},searchIconNode:function(){return this.showTitle?this.domNode.firstChild.firstChild.firstChild.rows[0].cells[3].firstChild:null;},closeNode:function(){return this.showTitle?this.domNode.firstChild.firstChild.firstChild.rows[0].cells[4].firstChild:null;},searchBoxNode:function(){return this.domNode.firstChild.childNodes[2];},containerNode:function(){return this.domNode.firstChild.childNodes[3];},buttonNode:function(){return this.domNode.firstChild.childNodes[4];},curtainNode:function(){return this.domNode.lastChild;},leftanchor:function(){return this.left;}},onscroll:function(){this.parent.parent.linker.drawLinks();},premousedown:function M(d){var e=mstrmojo.dom.eventTarget(d.hWin,d.e),c;if(e===this.closeNode){if(!this.readOnly){this.close();}}else{if(e===this.searchIconNode){c=this.searchBox.visible;this.searchBox.set("visible",!c);}}},onmousedown:function(c){this.editorNode.style.zIndex=8;},onmouseup:function(c){this.editorNode.style.zIndex=7;},toggleSelect:function(c){var e,d;if(this.selectedIndex[c]){this.selectedIndex[c]=false;}else{this.selectedIndex[c]=true;}A(this);},rangeSelect:function(c){},singleSelect:function(d){var e,c;for(e=0,c=this.selectedIndex.length;e<c;e++){this.selectedIndex[e]=false;}this.selectedIndex[d]=true;A(this);},clearSelect:function(){var d,c;for(d=0,c=this.selectedIndex.length;d<c;d++){this.selectedIndex[d]=false;}A(this);},onmouseover:function(d){var c=parseInt(this.editorNode.style.height);this.containerNode.style.overflowY=(c>=this.minHeight&&c<this.maxHeight)?"auto":"hidden";this.containerNode.style.overflowX="hidden";},onmouseout:function H(){this.containerNode.style.overflow="hidden";},touchBegin:function V(d){var c=this.editorNode.style;this._tl=parseInt(c.left);this._tt=parseInt(c.top);},touchSwipeMove:function S(f){var c=mstrmojo.all.QBuilderModel,d=this.container,e=c.tables[this.id];C(this,f.delta.x+this._tl,f.delta.y+this._tt);if(e&&e.njoins>0){d.linker.drawLinks();}},addRow:function L(c,j,d,e,g){var f=this.children[0];var h={scriptClass:"mstrmojo.qb.DBTableRow",images:d,indent:j,text:c,displayText:!g?N.encodeHtmlString(c):g};f.addChildren([h]);},onclick:function(n){var h=n.hWin,j=n.e||h.event,g=j.target||j.srcElement,f=document.elementFromPoint(j.clientX,j.clientY),d=g&&g.id;if(d.replace(this.id,"")=="check"){if(this.onCheck){this.onCheck(g.checked);}}var l=Z.findWidget(f);if(!l||!l.srcData){this.clearSelect();return ;}var m=l.rIndex,k=Z.ctrlKey(h,j),o=Z.shiftKey(h,j);if(k||o){Z.clearBrowserHighlights(h);}if(k){this.toggleSelect(m);}else{this.singleSelect(m);}},ondblclick:function(d){var c=d.hWin,g=d.e||c.event,l=g.target||g.srcElement,k=l&&l.id;if(k.replace(this.id,"")=="title"){var j=Z.delta(this.titleNode,this.titlebarNode);var h=this.title,f=this.titleNode.clientWidth-6;this.openPopup("inlineTextRef",{left:j.x+"px",top:(Z.isIE?0:-1)+"px",txtConfig:{cssClass:"mstrmojo-qb-tablealias-edit",width:f+"px",value:N.decodeHtmlString(h)||"",onEnter:function(){var o=N.trim(this.value);this.parent.close({enter:true});if(o){var r=this.parent.parent;if(N.encodeHtmlString(o)!==r.title){var e=r.model;if(e&&e.tbns){var q="";if(o.match(/[~#'"?;:[\]]/)){q=mstrmojo.desc(12912,"A table alias cannot contain the following characters: ~#'\"?;:/[]");mstrmojo.alert(q);return ;}if(!o.match(/^[a-zA-Z]/)){o=o.replace(/^\S/,"L");q=mstrmojo.desc(12913,"Table alias starting with non alphabetic character will be replaced by the character L.");}var p=N.encodeHtmlString(o);if(e.tbns[o]&&(p!==r.title)){q+=mstrmojo.desc(12914,"'##' has been used as the alias of another table. Please give a new name.").replace("##",p);mstrmojo.alert(q);return ;}if(q){mstrmojo.alert(q);}}var n=N.decodeHtmlString(r.title);if(e&&e.renameTable){e.renameTable(r.id,n,o);}r.set("title",N.encodeHtmlString(o));if(r.onHeaderChange){r.onHeaderChange(n,o);}}}},onCancel:function(){this.set("value",this.parent.title);}}});}},onCheck:function(c){},postBuildRendering:function X(){if(this._super){this._super();}if(this.noCheckBox){this.checkBoxNode.style.display="none";}},getDragData:function F(c){var d=c.src,f=d.node,e=f.id;if(e){switch(e.replace(this.id,"")){case"north":case"east":case"south":case"west":return{dir:e.replace(this.id,""),startX:d.pos.x,startY:d.pos.y};break;default:break;}}else{if(this._super){return this.dropZone&&this._super(c);}}return null;},isDragValid:function B(c){return true;},ondragstart:function a(c){var f=c.src,g=f&&f.data,e=g&&g.dir;if(e){this.prevPos={x:f.pos.x,y:f.pos.y};return true;}else{if(this._super){return this._super(c);}}},ondragmove:function J(l){var p=l.src,AI=p&&p.data,u=AI&&AI.dir,r,t,f,x,c,j,AC,o,m,z,AE,n,AG,AH,AA,k,AB,AD;c=this.container;j=mstrmojo.all.QBuilderModel;if(u){switch(u){case"north":case"south":AC=l.tgt;m=AC.pos.y-this.prevPos.y;m=(u==="north")?m:-m;this.prevPos=AC.pos;z=this.editorNode.style;if(parseInt(z.height)-m>=this.minHeight&&parseInt(z.height)-m<=this.maxHeight){r=parseInt(z.top);if(u==="north"){r+=m;if(r<0){r=0;}z.top=r+"px";this.top=z.top;}t=parseInt(z.height)-m;z.height=t+"px";this.containerNode.style.height=t-this.titlebarNode.clientHeight-1-(this.searchBox.visible?this.searchBoxNode.clientHeight:0)+"px";if(r+t>c.maxHeight){c.maxHeight=r+t+10;AE=parseInt(c.domNode.clientHeight);if(c.maxHeight>AE){R(c,j);}else{c.domNode.scrollTop=0;}}}break;case"east":case"west":AC=l.tgt;k=this.noCheckBox?57:77;o=AC.pos.x-this.prevPos.x;o=(u==="east")?o:-o;this.prevPos=AC.pos;z=this.editorNode.style;if(parseInt(z.width)+o>=this.minWidth&&parseInt(z.width)+o<=this.maxWidth){f=parseInt(z.left);if(u==="west"){f-=o;if(f<0){f=0;}z.left=f+"px";this.left=z.left;}x=parseInt(z.width)+o;z.width=x+"px";this.titleNode.style.width=x-k+"px";this.titlebarNode.style.width=x+"px";if(this.searchBox.visible){this.searchBox.set("width",x-48+"px");}if(f+x>c.maxWidth){c.maxWidth=f+x+10;n=parseInt(c.domNode.clientWidth);if(c.maxWidth>n){Y(c,j);}else{c.domNode.scrollLeft=0;}}E.call(this,x);}break;}c.linker.drawLinks();}else{AE=parseInt(c.domNode.clientHeight);n=parseInt(c.domNode.clientWidth);AG=l.tgt.pos;p=l.src.pos;o=AG.x-p.x;m=AG.y-p.y;z=this.getMovingTarget().style;AH=this._leftPos+o;AA=this._topPos+m;AH=(AH<0)?0:AH;AA=(AA<0)?0:AA;var q=true,AJ=true,AF=c.canvasbox.children;for(AB=0,AD=AF.length;AB<AD;AB++){if(!AF[AB].visible){continue;}if(this.id!=AF[AB].id&&AH+this.editorNode.clientWidth<parseInt(AF[AB].left)+AF[AB].editorNode.clientWidth){q=false;break;}}if(q){c.maxWidth=AH+this.editorNode.clientWidth;if(c.maxWidth>n){Y(c,j);}}for(AB=0,AD=AF.length;AB<AD;AB++){if(!AF[AB].visible){continue;}if(this.id!=AF[AB].id&&AA+this.editorNode.clientHeight<parseInt(AF[AB].top)+AF[AB].editorNode.clientHeight){AJ=false;break;}}if(AJ){c.maxHeight=AA+this.editorNode.clientHeight+10;if(c.maxHeight>AE){R(c,j);}}z.left=AH+"px";z.top=AA+"px";this.top=AA+"px";this.left=AH+"px";var g=j.tables[this.id];if(g&&g.njoins>0){c.linker.drawLinks();}if(c.maxWidth<=n){c.domNode.scrollLeft=0;}if(c.maxHeight<=AE){c.domNode.scrollTop=0;}}},inlineTextRef:{scriptClass:"mstrmojo.Popup",locksHover:true,slot:"containerNode",children:[{scriptClass:"mstrmojo.TextBox",alias:"txt",onEsc:function(){if(this.onCancel){this.onCancel();}this.parent.close({cancel:true});}}],onOpen:function(){var e=this.txt,f=this.txtConfig;if(f){for(var d in f){e.set(d,f[d]);}}e.domNode.style.width=e.width;e.focus();},onClose:function(c){if(!c||(!c.cancel&&!c.enter)){this.txt.onEnter();}}},_set_height:function(f,e){var d=this.searchBox.visible?this.searchBoxNode.clientHeight:0;if(this.editorNode&&parseInt(e)>this.titlebarNode.clientHeight+d){var c=this.editorNode.style;c.height=parseInt(e)+"px";this.containerNode.style.height=parseInt(c.height)-this.titlebarNode.clientHeight-1-d+"px";}},useRichTooltip:true,showTooltip:function G(d,g){var f=mstrmojo.dom;var e=d.target||f.eventTarget(d.hWin,d.e);if(e.className&&((e.className==="mstrmojo-qb-DBTable-title")||(e.className==="mstrmojo-qb-DBTable-titleIcon"))){e=e.parentNode.parentNode.parentNode.children[0].children[2].children[0];var c=f.position(e);this.set("richTooltip",{posType:mstrmojo.tooltip.POS_TOPLEFT,cssClass:"vi-regular vi-tooltip-A",content:e.textContent,top:c.y+c.h+5,left:c.x});mstrmojo._HasTooltip.showTooltip.call(this,d,g);}}});})();(function(){mstrmojo.requiresCls("mstrmojo.dom","mstrmojo.hash","mstrmojo._ValidateSuggestions","mstrmojo.WidgetList","mstrmojo.Editor","mstrmojo.LegacySuggestionList");mstrmojo.Enum_OIB_States=mstrmojo.hash.copy(mstrmojo._ValidateSuggestions.ENUM_STATES,{EDITING:2,ADDING:3,EMPTY:4});mstrmojo.Enum_OIB_States_CSS=(function(){var AH=mstrmojo.Enum_OIB_States,AG={},AI;for(AI in AH){if(AH.hasOwnProperty(AI)){AG[String(AH[AI])]=AI;}}return AG;}());var Q=mstrmojo.dom,S=mstrmojo.hash,b=mstrmojo.Enum_OIB_States,I=0,d="_did_",AC=mstrmojo.Enum_Keys,AE=80,V=200;function Y(){return(mstrApp&&mstrApp.searchAutoCompleteDelay&&mstrApp.searchAutoCompleteDelay())?mstrApp.searchAutoCompleteDelay():V;}function P(){return I++;}function j(AG){return(AG&&AG.state===b.ADDING);}function r(AG){var AH={n:AG||"",state:b.EMPTY};AH[d]=-2;return AH;}function O(AG){return(AG&&AG.state===b.EMPTY);}function x(AH){var AI=AH.items,AG=AI&&AI.length;if(!AG){return true;}return(AG===1&&j(AI[0]))||(AG===2&&O(AI[0])&&j(AI[1]));}function n(){var AH=this.ctxtBuilder.itemWidgets,AG=AH[AH.length-1];if(AG&&AG.isAdding){var AI=this;Q.attachEvent(AG.domNode,"click",function(){AI.editingIdx=null;});return AG;}return null;}function L(){var AG=this.editingIdx;if(AG!==null){return this.ctxtBuilder.itemWidgets[AG];}return n.call(this);}function D(){this.isActive=false;var AH=this.emptyText||"",AI=this.items;if(x(this)&&!O(AI[0])&&(AH.length>0)){this.add([r(AH)],0);var AJ=this.ctxtBuilder.itemWidgets[0];AJ.set("shouldEllipsize",true);AJ.doEllipsize();}var AG=L.call(this);if(AG){if(j(AG)&&this.showEmptyItem){AG.domNode.style.visibility="hidden";}AG.blur();}Q.detachEvent(document.body,"mousedown",this._mousedownHandler);if(this.tabNavigable){Q.detachEvent(AG.inputNode,"keydown",this._tabKeyHander);}}function N(){if(!this.enabled){return ;}this.isActive=true;if(O(this.items[0])){this.remove(0);}var AG=L.call(this);if(AG){if(j(AG)&&!this.isFull){AG.domNode.style.display="block";AG.domNode.style.visibility="visible";}this.scrollTo(AG.data);AG.focus();}Q.attachEvent(document.body,"mousedown",this._mousedownHandler);if(this.tabNavigable){Q.attachEvent(AG.inputNode,"keydown",this._tabKeyHander);}}mstrmojo.ObjectInputBox=mstrmojo.declare(mstrmojo.WidgetList,[mstrmojo._ValidateSuggestions],{scriptClass:"mstrmojo.ObjectInputBox",cssClass:"mstrmojo-ObjectInputBox",emptyText:"",showEmptyItem:true,items:null,itemField:"n",dynamicVerify:true,suggestCount:10,candidates:null,makeObservable:true,renderOnScroll:false,editingIdx:null,isActive:false,maxObjectCount:null,isFull:false,suggestionListClass:"mstrmojo.LegacySuggestionList",acptSugItemOnly:false,useKeyDelay:false,showSuggestionOnEdit:true,tabNavigable:false,getSearchPattern:function(){var AG=L.call(this);if(AG){return AG.getSearchPattern();}return"";},getSuggestionTarget:function o(){return this.suggestTarget;},onsuggestTargetChanged:function q(AG){this._request_pattern=null;},getSuggestionPos:function e(){return this._pop_cfg;},onSuggestionItemSelect:function z(AG){if(this.suggestTarget){this.suggestTarget.setItem(AG[this.itemField],AG,false);}this.hideSuggestion();this.closePopup();},hideEditButton:function(AG){return !!this.noEditButton;},_set_items:function m(AL,AI){AI=mstrmojo.hash.clone(AI)||[];var AK=this.maxObjectCount;this.set("isFull",(AK&&AI.length>=AK));if(AI.length===0){var AH=this.emptyText||"";if(AH.length>0){AI.push(r(AH));}}var AJ={n:"",state:b.ADDING};AJ[d]=-1;AI.push(AJ);var AG=AI[AI.length-1];if(AG&&j(AG)&&this.maxObjectCount&&(this.getSelectedObjects().length>=this.maxObjectCount)){this.set("isFull",true);}this.itemIdField=d;return this._super(AL,AI);},add:function E(AH,AG){var AI=n.call(this);if(!this.maxObjectCount||this.getSelectedObjects().length<this.maxObjectCount){this._super(AH,AG);}if(!x(this)&&O(this.items[0])){this.remove(0);}if(AI){AI.adjustInputWidth();if(this.maxObjectCount&&(this.getSelectedObjects().length===this.maxObjectCount)){this.set("isFull",true);AI.domNode.style.display="none";}else{AI.domNode.style.display=this.showEmptyItem?"none":"";}}},remove:function c(AG){this._super(AG);var AH=n.call(this);if(AH){if(this.maxObjectCount&&(this.getSelectedObjects().length<this.maxObjectCount)){this.set("isFull",false);}AH.adjustInputWidth();}},preBuildRendering:function(){if(this.items==null||this.items.length==0){this.set("items",[]);}if(this._super){this._super();}},postBuildRendering:function a(){this._super();var AH=this,AG=n.call(AH);if(AG&&(this.showEmptyItem||this.isFull)){AG.domNode.style.display="none";}this._clickHandler=function(){N.call(AH);};this._mousedownHandler=function(AI){if(!AH.isActive||AH.browserShown){return ;}var AJ=Q.eventTarget(self,AI);if(AJ&&AJ.parentNode&&!Q.contains(L.call(AH).domNode,AJ,false,document.body)&&!Q.contains(AH.suggestionPopup.domNode,AJ,false,document.body)){D.call(AH);}};if(this.tabNavigable){this._tabKeyHander=function(AI){var AJ=parseInt(AI.keyCode||AI.charCode,10);if(AJ===AC.TAB){if(!AH.isActive||AH.browserShown){return ;}D.call(AH);}};}Q.attachEvent(this.domNode,"click",this._clickHandler);},nextId:P,item2textCss:function M(AG){return AG.cssClass||"";},itemFunction:function G(AI,AG,AH){AI[AH.itemIdField]=P();var AJ=new mstrmojo.ObjectItem({parent:AH,itemField:AH.itemField,cssClass:AH.item2textCss(AI),data:AI,showSuggestionOnEdit:this.showSuggestionOnEdit,enabled:AH.enabled});AH.attachEventListener4ItemWidget(AJ,AH);return AJ;},attachEventListener4ItemWidget:function k(AK,AI){var AH=["ItemEditBegin","ItemEditEnd","ItemDeletePrev","ItemDelete","ItemAdd","SuggestionOn","SuggestionOff","ItemEditing"],AG=AH.length,AJ;for(AJ=0;AJ<AG;AJ++){AK.attachEventListener(AH[AJ],AI.id,"_itemChangeHandler");}return AK;},getSelectedObjects:function l(){if(x(this)){return[];}var AG=this.items,AH=AG.length-1;if((AH>-1)&&j(AG[AH])){return AG.slice(0,AH);}return AG.concat();},isValid:function C(){var AH=this.ctxtBuilder.itemWidgets,AG=AH&&AH.length,AI;for(AI=0;AI<AG;AI++){if(!AH[AI].isValid()){return false;}}return true;},isEmpty:function W(){return x(this);},_itemChangeHandler:function(AJ){var AL=AJ.name,AM=AJ.d,AH,AG=this.items.length,AI;switch(AL){case"ItemEditBegin":if(this.editingIdx!==null){AI=L.call(this);if(AI){AI.blur();}}AH=this.itemIndex(AM);this.editingIdx=AH;N.call(this);break;case"ItemEditEnd":this.editingIdx=null;if(AJ.deactivate){D.call(this);}else{N.call(this);}AI=n.call(this);if(AI){AI.adjustInputWidth();}break;case"ItemDelete":if(this.editingIdx!==null){AI=L.call(this);if(AI){AI.blur();}this.editingIdx=null;}AH=this.itemIndex(AM);this.remove(AH);if(!AJ.deactivate){this.editingIdx=null;N.call(this);}else{if(!this.isActive){D.call(this);}else{N.call(this);}}break;case"ItemDeletePrev":if(AG>1){this.remove(AG-2);}break;case"ItemAdd":var AK=S.copy(AJ.d);this.add([AK],AG-1);if(AJ.deactivate){D.call(this);}else{N.call(this);}break;case"SuggestionOn":this.set("suggestTarget",AJ.target);this._pop_cfg={target:AJ.target,left:AJ.l,top:AJ.t,zIndex:this.zIndex?this.zIndex:100};this.showSuggestion(AJ.pattern);break;case"SuggestionOff":this.set("suggestTarget",null);this.hideSuggestion();break;}if(this.onitemchange&&(AL==="ItemEditEnd"||AL==="ItemAdd"||AL==="ItemDelete"||AL==="ItemDeletePrev"||AL==="ItemEditing")){this.onitemchange();}},unrender:function B(AH){var AG=this.suggestionPopup;if(AG.hasRendered){AG.unrender(false);}if(this._super){this._super(AH);}},destroy:function w(AH){var AG=this.suggestionPopup;if(AG&&AG.hasRendered){AG.destroy(false);}if(this._super){this._super(AH);}}});mstrmojo._HasMarkup.addMarkupMethods(mstrmojo.ObjectInputBox,{onenabledChange:mstrmojo.Widget.enabledMarkupMethod});mstrmojo.requiresCls("mstrmojo.Widget","mstrmojo._HasEllipsis");var t="mstrmojo-ObjectItem-text";mstrmojo.ObjectItem=mstrmojo.declare(mstrmojo.Widget,[mstrmojo._HasEllipsis],{scriptClass:"mstrmojo.ObjectItem",markupString:'<div id={@id} class="mstrmojo-ObjectItem" style="{@cssText}"><div class="mstrmojo-ObjectItem-displayNode"><span title=" {@en@title}" class="'+t+' {@cssClass}"></span><img class="mstrmojo-ObjectItem-edit" src="../images/1ptrans.gif" title="'+mstrmojo.desc(1088,"Edit")+'" onclick="mstrmojo.all[\'{@id}\'].edit()"/><img class="mstrmojo-ObjectItem-del" src="../images/1ptrans.gif" title="'+mstrmojo.desc(629,"Delete")+'" onclick="mstrmojo.all[\'{@id}\'].del(arguments[0])"/></div><div class="mstrmojo-ObjectItem-editNode"><input type="text" class="mstrmojo-ObjectItem-input" mstrAttach:keyup,keydown/></div></div>',markupSlots:{displayNode:function(){return this.domNode.firstChild;},editNode:function(){return this.domNode.childNodes[1];},textNode:function(){return this.domNode.firstChild.firstChild;},editButtonNode:function(){return this.domNode.firstChild.childNodes[1];},delButonNode:function(){return this.domNode.firstChild.lastChild;},inputNode:function(){return this.domNode.childNodes[1].firstChild;}},markupMethods:{oncssClassChange:function(){this.textNode.className=t+" "+this.cssClass;},onstateChange:function(){var AI=this.state,AH=mstrmojo.Enum_OIB_States_CSS[AI],AG=this.domNode;if(AI===b.EMPTY){AG.innerHTML=this.enabled?'<div class="mstrmojo-ObjectItem-emptyText">'+this.text+"</div>":"";}else{if(AI===b.EDITING){this.reduceWidth();}}AG.className="mstrmojo-ObjectItem "+AH;this.updateButtonsVisibility(this.data);},ontextChange:function(){this.inputNode.value=this.text;this.textNode.innerHTML=mstrmojo.string.encodeHtmlString(this.text);}},reduceWidth:function(){var AG=Math.round(this.displayNode.clientWidth);this.editNode.style.width=AG-4+"px";this.inputNode.style.width=AG-9+"px";},updateButtonsVisibility:function AF(){if(this.parent.hideEditButton(this.data)){this.editButtonNode.style.display="none";}},state:b.VALID,onstateChange:function g(AG){this.data.state=this.state;},ontextChange:function H(AG){this.data[this.itemField]=this.text;},onfocus:function AA(){N.call(this.parent);},updateData:function F(AG){S.copy(AG,this.data);this.set("state",b.VALID);this.set("text",this.data[this.itemField]);this.set("cssClass",this.parent.item2textCss(this.data));},init:function AB(AH){this._super(AH);var AJ=this.data,AG=AJ.state,AI=this.parent;AG=this.initState();this.cssClass=AI.item2textCss(AJ);this.text=AJ[this.itemField];this.state=AG;this.isAdding=j(AJ);this.useRichTooltip=true;this.title=this.text;},initState:function K(){var AH=this.parent,AI=this.data,AG=AI.state;if(AI&&AI.did){AI.state=b.VALID;return AI.state;}if(typeof AG==="undefined"){AG=AH.dynamicVerify?AH.verifyObject(AI[this.itemField],this):b.UNDETERMINED;AI.state=AG;}return AG;},isValid:function C(){var AG=parseInt(this.state,10);return(AG!==b.INVALID&&AG!==b.UNDETERMINED);},adjustInputWidth:function A(){if(this.isAdding){var AJ=this.inputNode.style;AJ.width=AE+"px";var AI=this.domNode.parentNode,AG=AI.parentNode.offsetWidth,AH=Math.max(AG-AI.offsetLeft-20,AE);if(!isNaN(AH)){AJ.width=AH+"px";}}},blur:function U(){this.hideSuggestion();if(!this.isActive){return ;}this.isActive=false;var AI=this.inputNode,AG=AI.value,AH=this.parent;window.setTimeout(function(){try{AI.blur();}catch(AJ){}},0);if(!AG){return ;}if(AH.acptSugItemOnly&&this._tWas_){this.set("text",AG);this.set("text","");this._tWas_=null;return ;}this.setItem(AG,null,true);},focus:function u(){var AH=this.inputNode,AG=this.isActive;window.setTimeout(function(){try{AH.focus();if(AH.createTextRange&&!AG){var AJ=AH.createTextRange(),AI=AH.value.length;AJ.move("character",AI);AJ.select();}else{if(AH.setSelectionRange&&!AG){var AI=AH.value.length;AH.setSelectionRange(AI,AI);}}}catch(AK){}},0);this.isActive=true;},prekeydown:function J(AG){var AI=this.inputNode.value,AH=parseInt(AG.e.keyCode||AG.e.charCode,10),AK=this.parent;if(!AI){return ;}if(AH===AC.TAB||AH===AC.ENTER){if(AH===AC.ENTER){Q.preventDefault(AG.hWin,AG.e);}var AJ=AK.getSelected();if(AJ&&AJ.did){AK.handleSuggestionItemSelect(AJ);}else{this.hideSuggestion();if(!AK.acptSugItemOnly){this.setItem(AI,null,false);}else{this.set("text",AI);this.set("text","");}}}else{if(AH===AC.DOWN_ARROW){if(!AK.noCache&&!AK.suggestionShown){this.showSuggestion(AI);AK.preHighlight();}AK.nextHighlight();}else{if(AH===AC.UP_ARROW){AK.preHighlight();}}}},prekeyup:function AD(AG){var AI=this.inputNode.value,AH=parseInt(AG.e.keyCode||AG.e.charCode,10),AL=this.isAdding,AK=this.parent;if(!AI){if(AL){if(AH===AC.BACKSPACE&&!this._tWas_){this.raiseEvent({name:"ItemDeletePrev"});Q.preventDefault(AG.hWin,AG.e);}this._tWas_=null;}else{this.raiseEvent({name:"ItemDelete",d:this.data});}this.hideSuggestion();return ;}if(AH===AC.ESCAPE||AH===AC.TAB){this.hideSuggestion();if(AK.acptSugItemOnly){this.set("text",AI);this.set("text","");this._tWas_=null;return ;}}else{if(this._tWas_!==AI){this.textChanged=true;this.raiseEvent({name:"ItemEditing",d:this.data});if(AK.useKeyDelay){window.clearTimeout(this._timerID);var AJ=this;this._timerID=window.setTimeout(function(){var AM=AJ.inputNode.value;if(AM){AJ.showSuggestion(AM);}AJ._timerID=null;},Y());}else{this.showSuggestion(AI);}}}this._tWas_=AI;},setItem:function(AG,AI,AH){var AJ=this.isAdding;AH=AH||false;this.set("text",AG);if(AJ){this.setItem_Adding(AG,AI,AH);}else{this.setItem_Editing(AG,AI,AH);}this._tWas_=null;},setItem_Adding:function(AG,AI,AH){this.set("text","");if(!AI){AI={};AI[this.itemField]=AG;}else{AI.state=b.VALID;}this.raiseEvent({name:"ItemAdd",d:AI,deactivate:AH});},setItem_Editing:function(AG,AI,AH){var AJ=this.parent;this.set("text",AG);if(AI){this.updateData(AI);}else{if(this.textChanged){var AK={};AK[d]=this.data[d];delete this.data.did;this.data=AK;this.textChanged=false;}this.set("state",AJ.verifyObject(AG,this));this.set("cssClass",AJ.item2textCss(this.data));}this.isActive=false;this.raiseEvent({name:"ItemEditEnd",d:AI,deactivate:AH});},getSearchPattern:function X(){return(this.inputNode?this.inputNode.value:"");},showSuggestion:function p(AG){var AH=mstrmojo.dom.position(this.domNode,true);this.raiseEvent({name:"SuggestionOn",l:Math.round(AH.x)+"px",t:Math.round(AH.y+AH.h)+"px",pattern:AG,target:this});},hideSuggestion:function h(){this.raiseEvent({name:"SuggestionOff"});},del:function R(AG){AG=AG||self.event;Q.stopPropogation(self,AG);this.raiseEvent({name:"ItemDelete",d:this.data,deactivate:true});if(this.useRichTooltip&&this.hideTooltip){this.hideTooltip();}},edit:function Z(){this.set("state",b.EDITING);this.raiseEvent({name:"ItemEditBegin",d:this.data});if(this.showSuggestionOnEdit){this.showSuggestion(this.text);}},doEllipsize:function f(){if(!this.shouldEllipsize){return ;}var AH=this.maxItemWidth,AG;if(AH){this.domNode.style.maxWidth=AH;switch(parseInt(this.state,10)){case b.VALID:case b.UNDETERMINED:case b.INVALID:AG=this.textNode;break;case b.EMPTY:AG=this.domNode.firstChild;break;}if(AG){this.set("richTooltip",{content:this.text,contentNodeCssClass:"sp-tooltip",posType:mstrmojo.tooltip.POS_TOPLEFT,left:0,top:30,refNode:this.domNode});mstrmojo.css.addClass(AG,"truncated");}}}});}());(function(){mstrmojo.requiresCls("mstrmojo.Container","mstrmojo._IsExprNode","mstrmojo.fe._IsRelationTreeNode","mstrmojo._HasPopup","mstrmojo.fe.AndOrNode","mstrmojo.fe.DynamicNode","mstrmojo.ConditionNode","mstrmojo.css","mstrmojo.string","mstrmojo.dom","mstrmojo.hash","mstrmojo.expr");var E=mstrmojo,A=E.css,I=E.dom,F=E.hash,G=E.string,C=function(N){var O=N.data,M=O.dmy&&O.dmy.uts||[],K=M.length,J=[],L;for(L=0;L<K;L++){J.push(G.encodeHtmlString(M[L].n));}return'<span class="mstrmojo-text">'+J.join(", ")+"</span>";};mstrmojo.fe.RelationNode=mstrmojo.declare(mstrmojo.Container,[mstrmojo._IsExprNode,mstrmojo.fe._IsRelationTreeNode,mstrmojo._HasPopup],{scriptClass:"mstrmojo.fe.RelationNode",markupString:'<div id="{@id}" class="mstrmojo-relation {@cssClass}"  style="position:relative;{@cssText}" mstrAttach:mousedown><div class="mstrmojo-onhoverparent mstrmojo-relation-prefix {@cssClass}"><span class="mstrmojo-textset mstrmojo-relation-prefix-text" mstrAttach:click></span><span class="mstrmojo-onhover-in mstrmojo-andor-tools {@cssClass}"><span class="mstrmojo-indent" onclick="mstrmojo.all[\'{@id}\'].ind()">'+mstrmojo.desc(5895,"Group conditions")+'</span><span class="mstrmojo-outdent" onclick="mstrmojo.all[\'{@id}\'].out()">'+mstrmojo.desc(5896,"Ungroup Conditions")+'</span></span></div><div class="mstrmojo-relationNode"><span class="mstrmojo-relationNode-inf"><span class="mstrmojo-relation-prefix-text">'+mstrmojo.desc(2790,"Set of").replace(/##/g,"")+'</span><span class="mstrmojo-textset"  mstrAttach:click></span><span class="mstrmojo-relation-postfix-text">'+mstrmojo.desc(2793,"Where").replace(/##/g,"")+'</span><span class="mstrmojo-relation-convert-text"  mstrAttach:click >'+mstrmojo.desc(15412,"Convert to Condition")+'</span><img class="mstrmojo-del" src="../images/1ptrans.gif" title="'+mstrmojo.desc(7931,"Delete condition")+'"onclick="mstrmojo.all[\'{@id}\'].del()" /></span><div class="mstrmojo-relation-childTreeNode" style="position:relative;"></div></div></div>',markupSlots:{prefixHoverNode:function(){return this.domNode.firstChild;},prefixNode:function(){return this.domNode.firstChild.firstChild;},relationNode:function(){return this.domNode.lastChild;},textNode:function(){return this.domNode.childNodes[1].firstChild.childNodes[1];},convertNode:function(){return this.domNode.childNodes[1].firstChild.childNodes[3];},containerNode:function(){return this.domNode.childNodes[1].childNodes[1];}},markupMethods:{onprefixedAndOrEditableChange:function(){A.toggleClass(this.prefixNode,["editable"],this.prefixedAndOrEditable);},onselectedChange:function(){A.toggleClass(this.relationNode,["selected"],this.selected);},ondataChange:function(){this.prefixNode.innerHTML=this.andOrTxt();this.textNode.innerHTML=C(this);}},noRelationOperator:true,children:[{scriptClass:"mstrmojo.fe.RelationFilterExprTree",alias:"childTree",ignoreLayout:true,dropZone:false,draggable:false,nodeClassMap:{14:mstrmojo.fe.AndOrNode,ph:mstrmojo.fe.DynamicNode,"*":mstrmojo.fe.ConditionNode},onNew:function(J){this.parent.tree.onNew(J);},getItemConfig:function(M,J,N){var K=mstrmojo.fe.RelationFilterExprTree.prototype.getItemConfig.call(this,M,J,N),L=N.tree||N;return F.copy({tree:L,rootTree:this.parent.tree,noRelation:true,inRelation:true},K);},prenodeclick:function(J){if(!J||!J.part){return ;}var K=this.rootTree;if(K&&K.onnodeclick&&this.editable){J.editor=K.editor;K.onnodeclick.call(this,J);}}}],premousedown:function(J){if(this._super){this._super(J);}var K=I.eventTarget(J.hWin,J.e);if(!I.contains(this.childTree.domNode,K,true)){this.childTree.clearTreeSelect();}},preselectedChange:function(J){if(!J.value){this.childTree.clearTreeSelect();}},init:function(J){this._super(J);var K=this.data;if(K){delete this.data;this._set_data(null,K);}},_set_data:function(M,J){var K=this.data;if(J&&(!J.relation)){J.relation={};}var L=(K!==J);if(L){this.data=J;if(J){this.childTree.set("items",J.nds||[J]);}}return L;},isSelectableArea:function(J){return mstrmojo.dom.contains(this.relationNode,J,true);},preclick:function D(J){var L=null,K=I.eventTarget(J.hWin,J.e);if(I.contains(this.prefixNode,K,true)){L="andor";}else{if(I.contains(this.textNode,K,true)){L="createSet";}else{if(I.contains(this.convertNode,K,true)){this.parent.removeSet(this);return false;}}}J.part=L;},del:function H(){var J=this.parent;if(J&&J.remove&&this.data){J.remove(this.data);}},newCondition:function B(J){this.childTree.newCondition(J);},avatarCssCls:"mstrmojo-FE mstrmojo-relationNode",getAvatarNode:function(){return this.relationNode.cloneNode(true);}});})();(function(){mstrmojo.requiresCls("mstrmojo.Button","mstrmojo.HTMLButton","mstrmojo.Label","mstrmojo.TextBox","mstrmojo.TextArea","mstrmojo.Table","mstrmojo.HBox","mstrmojo.Editor","mstrmojo.ObjectBrowser","mstrmojo.NewFolderEditor","mstrmojo.DI.DIHelpers");var C=mstrmojo.func,F=mstrmojo.DI.DIHelpers,E=mstrmojo.array;function B(){var H={alias:"newFolder",scriptClass:"mstrmojo.Label",cssClass:"mstrmojo-createfolder",text:mstrmojo.desc(3245,"Create New Folder"),onclick:function(){var J=this.parent.parent,I={zIndex:J.zIndex+10,navigateAfter:false,fId:J.ob.currentFolder.did,okFn:function(K,L){J.ob.refreshContent();if(L){J.ob.browseFolder(K.fid,J.newFolder);}}};if(J.ob.dataProvider){I.dp=J.ob.dataProvider;}J.openPopup("newFolder",I);},postCreate:function(){this.set("visible",false);}},G=mstrmojo.hash.clone(mstrmojo.ObjectBrowser.prototype.children);G.push(H);return G;}mstrmojo.SaveAsObjectBrowser=mstrmojo.declare(mstrmojo.ObjectBrowser,null,{scriptClass:"mstrmojo.SaveAsObjectBrowser",cssClass:"mstrmojo-SaveAs-OB",children:B(),getRecents:function(G){var H=this;G.onClose=function(){if(H.recentFolders){this.removeChildren(this.recentLable);this.removeChildren(this.recentList);delete H.recentFolders;}};this.getDataProvider().loadRecentSaveAsFolders({success:function(I){if(H.recentFolders){G.removeChildren(G.recentLable);G.removeChildren(G.recentList);delete H.recentFolders;}if(I&&I!==""){H.recentFolders=H.getList(I.objects,G);G.addChildren(H.recentFolders);}},failure:function(I){mstrmojo.alert(I.message||I.getResponseHeader("X-MSTR-TaskFailureMsg"));},});},getList:function(H,G){var I=this;return[{scriptClass:"mstrmojo.Label",alias:"recentLable",cssClass:"recentLabel",text:mstrmojo.desc(14354,"Recents")},{scriptClass:"mstrmojo.ui.List",alias:"recentList",items:H,cssClass:"recentList",onclick:function(J){var K=this.getItemFromTarget(J.getTarget());I.browseFolder(K.did,"");G.close();}}];}});var A={success:function(G){var H=this.parent;if(H.onObjectSaved){H.onObjectSaved({name:H.name,did:G.did,desc:H.desc});}mstrmojo.alert(mstrmojo.desc(7987,"The ## '###' has been saved successfully.").replace("##",H.typeDesc||"Object").replace("###",H.name),null,mstrmojo.desc(7984,"Object Saved"));H.ob.refreshContent();H.close();},failure:function(H){var G=parseInt(H.getResponseHeader("X-MSTR-TaskErrorCode"),10)+4294967296,I=this.parent;if(G===2147749923){mstrmojo.confirm(mstrmojo.desc(7986,"The ## '###' already exists. Do you want to replace the existing one?").replace("##",I&&I.typeDesc||"Object").replace("'###'",I&&I.name?'"'+I.name+'"':""),{confirmBtn:{fn:function(){I.saveAs(true);}}},{title:mstrmojo.desc(3179),zIndex:I&&I.zIndex+10});}else{mstrmojo.alert(mstrmojo.desc(7985,"Error while saving: ")+H.getResponseHeader("X-MSTR-TaskFailureMsg"));}}};mstrmojo.SaveAsEditor=mstrmojo.declare(mstrmojo.Editor,null,{scriptClass:"mstrmojo.SaveAsEditor",cssClass:"mstrmojo-SaveAsEditor",title:mstrmojo.desc(3167,"Save As"),sId:null,rootFolderID:null,rootFolderType:null,folderLinksContextId:null,browsableTypes:null,showCompletePath:true,desc:"",name:"",displaySaveLabel:true,searchVisible:true,upButtonVisible:true,children:[{scriptClass:"mstrmojo.SaveAsObjectBrowser",alias:"ob",closeable:false,closeOnSelect:false,fishEyeVisible:false,bindings:{showCompletePath:"this.parent.showCompletePath",rootFolderID:"this.parent.rootFolderID",rootFolderType:"this.parent.rootFolderType",folderLinksContextId:"this.parent.folderLinksContextId",browsableTypes:"this.parent.browsableTypes",displaySaveLabel:"this.parent.displaySaveLabel",searchVisible:"this.parent.searchVisible",upButtonVisible:"this.parent.upButtonVisible",sId:"this.parent.sId"},postCreate:function(){this.onSelectCB=[this.parent,"onOBSelect"];this.onBrowseFolder=[this.parent,"onOBBrowseFolder"];}},{scriptClass:"mstrmojo.Table",cssClass:"mstrmojo-Input-Panel",rows:2,cols:2,alias:"contPanel",children:[{scriptClass:"mstrmojo.Label",cssClass:"mstrmojo-Name-Label",slot:"0,0",text:mstrmojo.desc(2211,"Name:")},{scriptClass:"mstrmojo.TextBox",slot:"0,1",value:mstrmojo.desc(8116,"New Folder"),alias:"name",cssClass:"mstrmojo-SaveAsEditor-nameInput",bindings:{value:"this.parent.parent.name"}},{scriptClass:"mstrmojo.Label",cssClass:"mstrmojo-Desc-Label",slot:"1,0",text:mstrmojo.desc(1154,"Description:")},{scriptClass:"mstrmojo.TextArea",cssClass:"mstrmojo-SaveAsEditor-descInput",slot:"1,1",alias:"desc",bindings:{value:"this.parent.parent.desc"},rows:5}]},{scriptClass:"mstrmojo.HBox",alias:"buttonBox",slot:"buttonNode",cssClass:"mstrmojo-Editor-buttonBar",children:[{alias:"newFolder",scriptClass:"mstrmojo.Button",cssClass:"mstrmojo-WebButton mstrmojo-createfolder",text:mstrmojo.desc(3245,"Create New Folder"),onclick:function(){var H=this.parent.parent,G={zIndex:H.zIndex+10,navigateAfter:false,fId:H.ob.currentFolder.did,okFn:function(I,J){H.ob.refreshContent();if(J){H.ob.browseFolder(I.fid,H.newFolder);}},cssClass:F.getEnvObj().isAppSchema()?"workstation":undefined};if(H.ob.dataProvider){G.dp=H.ob.dataProvider;}H.openPopup("newFolder",G);},postCreate:function(){this.set("visible",mstrmojo.resolveFeature("create-folder")||F.getEnvObj().isAppSchema());}},{scriptClass:"mstrmojo.Button",cssClass:"mstrmojo-WebButton hot okButton",alias:"ok",text:mstrmojo.desc(2400,"Save"),onclick:function(){this.parent.parent.saveAs();}},{scriptClass:"mstrmojo.Button",cssClass:"mstrmojo-WebButton",alias:"cancel",text:mstrmojo.desc(221,"Cancel"),onclick:function(){this.parent.parent.close();}}]}],newFolder:{scriptClass:"mstrmojo.NewFolderEditor"},onOpen:function(){this.ob.browse();},onOBBrowseFolder:mstrmojo.emptyFn,onOBSelect:function(G){this.set("name",G.n);},saveAsCallback:function D(){return A;},saveAs:function(J){var H=this.contPanel;this.name=H.name.value;this.desc=H.desc.value;if(!this.name){mstrmojo.alert(mstrmojo.desc(3380,"Please enter valid name"));return ;}var L=this.saveParams||{};L.folderID=this.ob.currentFolder.did;L.description=this.desc||"";L.name=this.name||"";L.saveAsOverwrite=!!J;var G=this.saveAsCallback(),K=this,I={success:function(){K.saveRecentFolders(K.ob.currentFolder.did);},failure:function(M){mstrmojo.alert(M.message||M.getResponseHeader("X-MSTR-TaskFailureMsg"));}};G.parent=this;if(!mstrApp.isSingleTier){G=C.wrapMethods(G,I);}mstrmojo.xhr.request("POST",mstrConfig.taskURL,G,L);},saveRecentFolders:function(K){var I,G,H,J=this;J.ob.getDataProvider().loadRecentSaveAsFolders({success:function(L){G=[];E.forEach(L.objects,function(O){G.push(O.did);});H=mstrmojo.array.indexOf(G,K);if(H!==-1){G.splice(H,1);}G.unshift(K);I=G.slice(0,3).join(",")+",";var M={taskId:"setPreference",prefs:"recentFolders\u001E"+I};var N={success:function(){mstrConfig.recentFolders=I;},failure:function(O){mstrmojo.alert(O.message||O.getResponseHeader("X-MSTR-TaskFailureMsg"));}};J.ob.getDataProvider().serverRequest(M,N);},failure:function(L){mstrmojo.alert(L.message||L.getResponseHeader("X-MSTR-TaskFailureMsg"));}});}});mstrmojo.SaveAsEditor.SAVEAS_CALLBACK=A;})();(function(){mstrmojo.requiresCls("mstrmojo.Editor","mstrmojo.ObjectBrowser");var H=mstrmojo.array;var E=[257,1024,3072,12032];mstrmojo.vi.ui.editors.ObjectPicker=mstrmojo.declare(mstrmojo.Editor,null,{scriptClass:"mstrmojo.vi.ui.editors.ObjectPicker",cssClass:"mstrmojo-vi-ObjectPicker",zIndex:9,title:mstrmojo.desc(11496,"Select Object"),help:null,rootFolderID:null,rootFolderType:null,folderLinksContextId:4,supportedTypes:H.hash(E),item:null,OKFn:null,children:[{scriptClass:"mstrmojo.ObjectBrowser",alias:"ob",closeable:false,browsableTypes:"8,"+E.join(","),closeOnSelect:false,showCompletePath:false,searchVisible:false,scrollableIncFetch:true,bindings:{rootFolderID:"this.parent.rootFolderID",rootFolderType:"this.parent.rootFolderType",folderLinksContextId:"this.parent.folderLinksContextId",isImportFromCube:"this.parent.isImportFromCube",}},{scriptClass:"mstrmojo.HBox",slot:"buttonNode",alias:"btnHBox",cssClass:"mstrmojo-Editor-buttonBar",children:[{scriptClass:"mstrmojo.Button",cssClass:"mstrmojo-WebButton hot",text:mstrmojo.desc(1442,"OK"),onclick:function C(){var J=this.parent.parent;this.parent.parent.close({item:J.item});var I=J.OKFn;if(I){I(J.item);}J.set("item",null);},bindings:{enabled:function B(){return !!this.parent.parent.item;}}},{scriptClass:"mstrmojo.Button",cssClass:"mstrmojo-WebButton",text:mstrmojo.desc(2399,"Cancle"),onclick:function C(){var I=this.parent.parent;this.parent.parent.close();I.set("item",null);}}]}],preBuildRendering:function A(){if(this._super){this._super();}this.ob.onSelectCB=[this,"onOBSelect"];},postBuildRendering:function D(){if(this._super){this._super();}this.browse();},onOBSelect:function F(I){this.set("item",((this.supportedTypes[I.t]||this.supportedTypes[I.st])?I:null));},browse:function G(){this.ob.browse();}});}());(function(){mstrmojo.requiresCls("mstrmojo.array","mstrmojo.css","mstrmojo.expr","mstrmojo.hash","mstrmojo.Box","mstrmojo.Button","mstrmojo.Editor","mstrmojo.FilterExpr","mstrmojo.Label","mstrmojo.Obj","mstrmojo.ui.Checkbox","mstrmojo.ui.CheckList","mstrmojo.warehouse.EnumObjectTypes");var H=mstrmojo.expr,I=H.ET,C=mstrmojo.array,F=mstrmojo.string,E=mstrmojo.warehouse.EnumObjectTypes,G=mstrmojo.mstr.EnumNodeDimty,D=mstrmojo.hash;mstrmojo.fe.CreateSetEditor=mstrmojo.declare(mstrmojo.Editor,null,{onOpen:function(){var Q=this.model,X=this.condition.data,R=!X.m,N=this.attrsBox.attrsList,J=this.relBox.relPd,S=C.filter(Q.metrics,function(a){return !a.um;}),Y=[{n:mstrmojo.desc(12037,"System Default"),t:-1,did:"default"}].concat(S),L=this.appQualBox.appQual,Z=D.clone(Q.attrs);C.forEach(Z,function(b){var a=false;if(b.t===E.ATTRIBUTE){C.forEach(b.fs,function(c){if(c.fgr>0){a=true;return false;}});}b.css=(b.css||"")+" "+(b.t?("t"+b.t+((b.da||b.um)?"d":"")+(a?"g":"")+(b.st?(" st"+b.st):"")):"");});N.set("items",Z);mstrmojo.array.forEach(["relBox","appQualBox"],function(a){this[a].set("visible",R);},this);if(X.dmt===4&&X.dmy.uts){var M={};C.forEach(X.dmy.uts,function(b){var a=C.find(Q.attrs,"did",b.utgt.did);if(a>=0){M[a]=true;}});N.set("selectedIndices",M);}if(R){J.set("items",Y);if(X.relation&&X.relation.guide){var O=X.relation.guide,W=C.find(Y,"did",O.did);J.set("selectedIndex",W>=0?W:0);}else{J.set("selectedIndex",0);}L.set("checked",!!X.applySubExpr);}if(mstrApp.isWSStyling){var V={left:parseInt(this.left,10),top:parseInt(this.top,10)},K=this.editorNode.getBoundingClientRect(),U={width:window.innerWidth,height:window.innerHeight},P={width:K.right-K.left,height:K.bottom-K.top};if(K.right>U.width){this.set("left",(V.left-P.width)+"px");}if(K.bottom>U.height){this.set("top",(V.top-P.height)+"px");}}},onOK:function(){var Q=this.model,U=this.condition,W=this.condition.data,N=this.attrsBox.attrsList,J=this.relBox.relPd,L=this.appQualBox.appQual;var Y=N.getSelectedItems(),K=[];C.forEach(Y,function(a){K.push({utgt:{n:a.n,did:a.did},utp:H.DMY_TP.ATTR,agg:1,flt:2,gb:true,rps:0,n:a.n});});var X;if(J.selectedIndex>0){var O=J.items[J.selectedIndex];X={n:O.n,did:O.did,t:E.METRIC,st:1024};}var M;if(W.et===15){W.dmt=G.NodeDimtyOutputLevel;W.dmy=W.dmy||{};W.dmy.uts=K;M=W.relation=W.relation||{};if(X){M.guide=X;W.useSchema=false;}else{delete M.guide;delete M.rsTp;delete M.joTp;delete M.paTp;delete M.erTp;W.useSchema=true;}W.applySubExpr=L.checked;U.set("data",W);}else{var V={et:15};V.dmt=G.NodeDimtyOutputLevel;V.dmy={};V.dmy.uts=K;M=V.relation={};if(X){M.guide=X;}else{V.useSchema=true;}V.applySubExpr=L.checked;var P=U,R={rq:V,cq:W},S=[U.childIndex()];if(W.et===I.ANDOR){if(W.nds&&W.nds.length>2){var Z=Q.childIdx;S=[Z,Z-1];}else{P=U.parent;}}else{P=U.parent;R.isMetric=!!W.m;}P.createSet(S,R);}},children:[{scriptClass:"mstrmojo.Box",alias:"attrsBox",cssClass:"Attributes-Box",children:[{scriptClass:"mstrmojo.Label",text:mstrmojo.desc(14613,"Select attributes to create the set"),cssClass:"Label",alias:"attrsBoxLabel"},{scriptClass:"mstrmojo.ui.CheckList",alias:"attrsList",cssClass:"CheckList"}]},{scriptClass:"mstrmojo.Box",alias:"relBox",cssClass:"RelatedBy-Box",children:[{scriptClass:"mstrmojo.Label",text:mstrmojo.desc(12036,"Related by"),cssClass:"Label",cssDisplay:"inline-block"},{scriptClass:"mstrmojo.ui.Pulldown",alias:"relPd",cssClass:"Pulldown",cssDisplay:"inline-block",allowHTML:false,onitemSelected:function B(J){}}]},{scriptClass:"mstrmojo.Box",alias:"appQualBox",cssClass:"AppQual-Box",children:[{scriptClass:"mstrmojo.ui.Checkbox",alias:"appQual",cssClass:"AppQual-CheckBox"},{scriptClass:"mstrmojo.Label",cssClass:"AppQual-Label",text:mstrmojo.desc(12038,"Apply this qualification independently of the relationship filter"),postBuildRendering:function(){if(this._super){this._super();}if(mstrApp.isWSStyling){this.set("text",mstrmojo.desc(15015,"Apply this qualification to define the set, and also to the results of the visualization."));}}}]},{scriptClass:"mstrmojo.HBox",slot:"buttonNode",cssText:"float: right; border-collapse: separate; display: table;",children:[{scriptClass:"mstrmojo.Button",cssClass:"mstrmojo-WebButton hot",text:mstrmojo.desc(2397,"OK"),onclick:function(){var J=this.editor;J.onOK();J.close();},bindings:{enabled:function(){var K=this.parent.parent.attrsBox.attrsList,J=this.parent.parent.attrsBox.attrsList.selectedIndices;return K.getSelectedItems().length>0;},editor:"this.parent.parent"}},{scriptClass:"mstrmojo.Button",cssClass:"mstrmojo-WebButton",text:mstrmojo.desc(221,"Cancel"),onclick:function(){this.editor.close();},bindings:{editor:"this.parent.parent"}}]}],postBuildRendering:function A(){this._super();if(mstrApp&&mstrApp.isWSStyling){this.attrsBox.attrsBoxLabel.set("text",mstrmojo.desc(15013,"Select the attributes that you look for."));}}});})();(function(){mstrmojo.requiresCls("mstrmojo.dom","mstrmojo.hash","mstrmojo.expr","mstrmojo.FilterExpr");var J=mstrmojo.expr,L=J.ET,C={},G=mstrmojo.hash,M=mstrmojo.dom;C[L.ANDOR]=mstrmojo.AndOrNode;C["*"]=mstrmojo.ConditionNode;function A(){var O=this.tree,N=O.parent,P=M.delta(this.domNode,O.domNode);if(this.data.sqltp===1){P.y+=parseInt(N.filterExpr.domNode.offsetHeight,10)+15;}N.parent.openPopup("andOrPopupRef",{condition:this,zIndex:this.zIndex?this.zIndex+100:100,left:P.x+40+"px",top:P.y+65-N.domNode.scrollTop+"px"});}function I(P){if(P.constructor!==Array){P=[P];}var U,S={b:0,c:0},V,R,O;for(var Q=0,N=P.length;Q<N;Q++){U=P[Q];if(!(U&&U.et)){continue;}V=U.nds;if(V){R=I(V);S.b+=R.b;S.c+=R.c;}else{O=(U.et===L.B);S[O?"b":"c"]++;}}return S;}function H(O){var P=O.parent.data;if(P){var N=O.items;if(O.alias==="filterExpr"){P.expr=N&&N[0];}else{P.aggexpr=N&&N[0];}}}function D(N){var P=I(N.value),O=this.tree;O.set("bandingCount",O.bandingCount+P.b);O.set("conditionCount",O.conditionCount+P.c);}function B(N){var P=I(N.value),O=this.tree;O.set("bandingCount",O.bandingCount-P.b);O.set("conditionCount",O.conditionCount-P.c);}mstrmojo.qb.FilterTree=mstrmojo.declare(mstrmojo.FilterExpr,null,{scriptClass:"mstrmojo.qb.FilterTree",draggable:true,dropZone:true,allowCopy:false,makeObservable:true,bandingCount:0,conditionCount:0,onadd:function(N){H(this);D.apply(this,[N]);},onremove:function(N){H(this);B.apply(this,[N]);},editable:true,onRender:function(){var O=I(this.items),N=this.tree;N.set("bandingCount",O.b);N.set("conditionCount",O.c);},itemFunction:function(S,O,U){var Q=(S.et===L.ANDOR),R=U.tree||U,P={data:S,tree:R,parent:U,itemFunction:Q?U.itemFunction:null,draggable:Q?R.draggable:false,dropZone:Q?R.dropZone:false,allowDrop:Q&&R.dropZone?R.allowDrop:null,allowCopy:Q?R.allowCopy:false,editable:R.isEditable?R.isEditable(S):R.editable,makeObservable:Q&&U.makeObservable,onclick:R.onnodeclick,onadd:R.onnodeadd,onremove:R.onnoderemove},N=C[S.et]||C["*"];return N&&(new N(P));},isEditable:function K(O){if(!this.editable){return false;}var N=false;switch(O&&O.et){case L.AQ:case L.ANDOR:case L.RLS:case"*":N=true;break;}return N;},onnodeclick:function F(O){if(!this.editable){return ;}if(O&&O.part==="andor"){A.call(this);}else{var N=this.tree;N.onexprclick&&N.onexprclick(this);}},onnodeadd:D,onnoderemove:B,allowDrop:function E(N){var P=N&&N.src,S=P&&P.data,R=S&&S.et,Q=(R===L.B),O=this.tree;return R&&((Q&&(O.conditionCount===0))||(!Q&&(O.bandingCount===0)));}});})();(function(){mstrmojo.requiresCls("mstrmojo.expr","mstrmojo.hash","mstrmojo.FilterExpr");var D=mstrmojo.hash,B=mstrmojo.expr.ET;mstrmojo.fe.FilterExprTree=mstrmojo.declare(mstrmojo.FilterExpr,null,{scriptClass:"mstrmojo.fe.FilterExprTree",allowCopy:false,containerResizable:false,draggable:true,dropZone:true,editable:true,makeObservable:true,onConditionEdit:mstrmojo.emptyFn,modifyConditionNode:function(G,F){var H=G.data,E=H.isNew;D.copy(D.clone(F),D.clear(H));delete H.isNew;G.paint();if(H.et===B.MQ||H.et===B.MC){G.set("noCreateSet",!mstrApp.supportAdvFilter);}if(G.tree.onConditionEdit){G.tree.onConditionEdit(G,E);}},getItemConfig:function(H,E,I){var F=this._super(H,E,I),G=I.tree;return D.copy({onclick:G.prenodeclick,containerResizable:G.containerResizable,ondragend:G.ondragend,ondrop:G.ondrop},F);},ondragenter:function A(E){this.dropCuePos={left:0,top:0,idx:0,idxActual:0};this._super(E);},ondragend:function(E){if(this===this.tree){return this._super(E);}else{return this.constructor.prototype.ondragend.call(this,E);}},ondrop:function(E){if(this===this.tree){return this._super(E);}else{return this.constructor.prototype.ondrop.call(this,E);}},isEditable:function C(F){if(!this.editable){return false;}var E=false;switch(F&&F.et){case B.R:case B.F:E=false;break;case B.ANDOR:case B.MQ:case B.AQ:case B.AL:case B.AC:case B.MC:case B.AE:E=true;break;case B.XML:E=!F.xml||!!F.ph;}return E;},prenodeclick:function(E){if(!E||!E.part){return ;}if(E.part!=="createSet"&&E.part!=="createSetOpt"&&!(E.part==="andor"?this.prefixedAndOrEditable:this.editable)){return ;}var F=this.tree;if(F.onnodeclick){F.onnodeclick.call(this,E);}},getSelectedItemWidget:function(){var E=function(K){var I=K&&K.ctxtBuilder&&K.ctxtBuilder.itemWidgets,G=K.selectedIndex,F=I&&I.length||0;if(!I){return ;}if(G===-1){for(var H=0;H<F;H++){var J=E(I[H]);if(J){return J;}}}else{return I[G];}};return E(this);}});})();(function(){mstrmojo.requiresCls("mstrmojo.TreeBrowserNode","mstrmojo.TreeBrowser","mstrmojo.ACL.UserDataService");mstrmojo.ACL.UserTreeBrowser=mstrmojo.declare(mstrmojo.TreeBrowser,null,{scriptClass:"mstrmojo.ACL.UserTreeBrowser",itemIdField:"did",branchClickPolicy:mstrmojo.TreeBrowserEnum.BRANCH_POLICY_SELECT,getACLUserDataService:function D(){return mstrmojo.ACL.UserDataService;},getContentThroughTaskCall:function C(G,E){var F=this.getACLUserDataService();E.failure=mstrmojo.func.composite([function(H){if(H.getResponseHeader){mstrmojo.alert(H.getResponseHeader("X-MSTR-TaskFailureMsg"));}},E.failure]);if(G.isRoot){F.getTopLevelGroups(G,E);}else{F.getMembers(G,E);}},isBranch:function B(E){return E.isGroup;},item2textCss:function A(E){return(this._super&&this._super(E))||"mstrmojo-ACLInputBox-user "+{8704:"u",8705:"ug"}[E.st];}});})();(function(){mstrmojo.requiresCls("mstrmojo.Box","mstrmojo.HBox","mstrmojo.TextBox","mstrmojo.Button","mstrmojo.css","mstrmojo.vi.ui.ElementsBrowser","mstrmojo.vi.ui.IncHierarchyCheckList","mstrmojo.mstr.EnumDSSXMLObjectTypes");var G=mstrmojo.css,A=mstrmojo.mstr.EnumDSSXMLObjectTypes;var E="36px";mstrmojo.vi.ui.HierarchyElementsCheckListBrowser=mstrmojo.declare(mstrmojo.vi.ui.ElementsBrowser,null,{scriptClass:"mstrmojo.vi.ui.HierarchyElementsCheckListBrowser",children:[{scriptClass:"mstrmojo.HBox",slot:"searchBoxNode",alias:"util",cssClass:"elemsBrowser-utils-bar",children:[{scriptClass:"mstrmojo.Box",cssClass:"eb-box-search",alias:"box",children:[{scriptClass:"mstrmojo.TextBox",alias:"searchBox",hint:"Search",cssClass:"eb-searchBox",onEnter:function B(){var O=this.value,M=this.parent.parent.parent,N=!M.searchPattern&&!O;if(!N){M.set("searchPattern",O);}this.blur();}},{scriptClass:"mstrmojo.Button",cssClass:"eb-searchBox-clear",text:"",onclick:function(){var M=this.parent.searchBox;M.set("value","");M.cleanUp();M.focus();M.onEnter();},bindings:{visible:"(this.parent.searchBox.value || '').length > 0"}},{scriptClass:"mstrmojo.Button",cssClass:"eb-searchBox-search",text:"",onclick:function(){var M=this.parent.searchBox;M.focus();M.onEnter();}}]}]},{scriptClass:"mstrmojo.HBox",slot:"buttonPanelNode",alias:"buttonPanel",cssClass:"elemsBrowser-button-panel"},{scriptClass:"mstrmojo.vi.ui.IncHierarchyCheckList",alias:"elementList",slot:"elementListNode",allowUnlistedValues:false,bindings:{disableLevel:"this.parent.disableLevel"},getDataHelper:function(){return this.parent.ifDataHelper;},getAttribute:function(){return this.parent.attribute;},isHiearachyDisplay:function F(){var M=this.parent;return !M.searchPattern||M.searchPattern==="";},setSelectedItems:function J(M){if(typeof M==="object"){this.setSelectionByExprJSON(M);}},postSelectionChange:function I(){var M=this.getAttribute();if(M){this.parent.onItemsSelectionChange(this.buildSelectionExprJSON(M));}}}],init:function L(M){this._super(M);G.addWidgetCssClass(this,"hierarchy");if(this.disableLevel){G.addWidgetCssClass(this,"disable-level");}},postCreateChildren:function D(){var M=this.elementList;this.util.addChildren(M.getLevelPopupConfig());this.buttonPanel.addChildren([M.getAllButtonConfig(true),M.getAllButtonConfig(false)]);},onattributeChange:function H(M){var N=this.elementList;N.clearItems();this._super(M);},onsearchPatternChange:function C(){var N=this.elementList,M=N.isHiearachyDisplay();this._super();this.buttonPanel.set("visible",M);this.layoutConfig.h.buttonPanelNode=M?E:"0px";this.doLayout();},isObjSearchable:function K(M){return true;},onElementsListchange:mstrmojo.emptyFn,updateClearAllBtnState:mstrmojo.emptyFn,_set_selectedItems:null});}());(function(){mstrmojo.requiresCls("mstrmojo.css","mstrmojo.array","mstrmojo.num","mstrmojo.dom","mstrmojo.date","mstrmojo.Container","mstrmojo.VBox","mstrmojo.Button","mstrmojo.locales","mstrmojo._FormatDefinition","mstrmojo.mstr.EnumFunction","mstrmojo.ui.editors.controls.ComboBox","mstrmojo.vi.util.NumberFormatUtility");var M=mstrmojo.hash,c=mstrmojo.array,G=mstrmojo.num,J=mstrmojo._FormatDefinition,B=mstrmojo.css,a=mstrmojo.mstr.EnumFunction,L=mstrmojo.locales,H=mstrmojo.Button.newIconButton,O=mstrmojo.date,I=mstrmojo.vi.util.NumberFormatUtility,t="1234.12",E=J.NumberFormatCategory,q=J.FixedNegative,F=J.CurrencyNegative,f=J.PercentNegative,K=J.DefaultFormat.FormattingNumber,o="nf-MiddleRow ",X="nf-MiddleRow nf-HasWidget ",Z,U,e=function e(w,u){return{cls:this.value===w.v?"selected":"",v:w.v||"",n:w.n||"",style:w.r?"color:red;":"color:#fff;",sel:parseInt(this.idx,10)===u?"selected":""};},p={RIGHT:1,LEFT_WITH_SPACE:2,RIGHT_WITH_SPACE:3};var S=[{n:mstrmojo.desc(4531,"Automatic"),v:-3}].concat(J.Category.slice(2)),d=[{n:"$"},{n:"£"},{n:"€"},{n:"¥"},{n:"fr."}];function D(x,w){var u=c.find(x,"v",w);return u===-1?"":x[u].f;}function N(u){var x=this.parent.parent.parent.myData,w=u.v;x.set("format",D(this.items,w));x.set("negativeNumbers",w);B.toggleClass(this.selectedNode,"red",u.r);}function Y(x,z,u){return{scriptClass:"mstrmojo.ui.Pulldown",isHostedWithin:false,items:x,onitemSelected:function w(AA){var AB=this.parent;while(AB&&(!AB.data||typeof AB.data[z]==="undefined")){AB=AB.parent;}if(AB){AB.data.set(z,AA.v);if(u){AB.children[0].preview.preview_label.set("text",AA.n);}}}};}function j(AG,AB,AA,AJ,AF){var AI=M.clone(AG),w=AB>0?L.number.DECIMALSEPARATOR:"",x=AB>0?".":"",z=J.DefaultFormat.FormattingNumber,AH=new RegExp("\\"+L.number.THOUSANDSEPARATOR,"g"),u=new RegExp("\\"+L.number.DECIMALSEPARATOR+"\\d{2}","g"),AD;for(AD=0;AD<AB;AD++){w+=AD%9;x+="0";}for(AD=0;AD<AI.length;AD++){var AE=AI[AD];AE.n=AE.n.replace(/,/g,"@");AE.n=AE.n.replace(/\./g,L.number.DECIMALSEPARATOR);AE.n=AE.n.replace(/@/g,L.number.THOUSANDSEPARATOR);if(AA){AE.n=AE.n.replace(AH,"");AE.f=AE.f.replace(/,/g,"");}if(AJ&&AJ!==z.CurrencyPosition){switch(AJ){case p.RIGHT:AE.n=AE.n.replace(/\$/g,"").replace(u,L.number.DECIMALSEPARATOR+"12$");AE.f=AE.f.replace(/"\$"/g,"").replace(/\.\d{2}/g,'.00"$"');break;case p.LEFT_WITH_SPACE:AE.n=AE.n.replace(/\$/g,"$ ");AE.f=AE.f.replace(/\$/g,"$ ");break;case p.RIGHT_WITH_SPACE:AE.n=AE.n.replace(/\$/g,"").replace(u,L.number.DECIMALSEPARATOR+"12 $");AE.f=AE.f.replace(/"\$"/g,"").replace(/\.\d{2}/g,'.00" $"');break;default:}}AE.n=AE.n.replace(u,w);AE.f=AE.f.replace(/\.\d{2}/g,x);if(AF&&AF!==z.CurrencySymbol){var AC=AF.replace(/\$/g,"$$$$");AE.n=AE.n.replace(/\$/g,AC);AE.f=AE.f.replace(/\$/g,AC);}AE.cls=AE.r?"red":null;}return AI;}function V(x){var u="1"+(x>0?".":"").toString(),z="0"+(x>0?".":"").toString(),w;for(w=0;w<x;w++){u+=w%10;z+="0";}return[u+"E+03",z+"E+0#"];}function R(AJ,AL){var AD="\u00A4",AH=/"[^"]*"/g,x=AJ.match(AH),AM="\u0091",AI=/\[[^\]]*\]/g,u=AJ.match(AI),AG,AK;AG=AJ.replace(AH,AD);AG=AG.replace(AI,AM);var AA=AJ.indexOf("."),AF=G.getDecimalLength(AJ),AC=Math.max(0,AF+AL),z=AJ.match(/\d(?!((\d)|(,\d)))/g),w=AA!==-1?AJ.charAt(AA-1):z&&z[0],AE=(w||"0")+(AC>0?".":"").toString();for(var AB=0;AB<AC;AB++){AE+="0";}AG=AG.replace(AF===0?/\d(?!((\d)|(,\d)))/g:/\d\.\d+/g,AE);AG=AG.split(AD);AK=AG[0];c.forEach(x,function(AO,AN){AK+=AO+AG[AN+1];});AG=AK.split(AM);AK=AG[0];c.forEach(u,function(AO,AN){AK+=AO+AG[AN+1];});return AK;}function P(AD,u,AC,AB,x,w){var AA=AD.parent.parent.parent,z=j(u,AC.decimalPlaces,AB,x,w);AC.set("format",D(z,AC.negativeNumbers.toString()));AD.set("items",z);AD.set("selectedIndex",c.find(z,"v",AC.negativeNumbers.toString()));AA.preview.preview_label.set("text",I.applyFormatToNumber(AA.myData.format,t.replace(/\./g,L.number.DECIMALSEPARATOR)));}function m(){var AE=this.parent.parent,AI=AE.myData,z=AE.formatterContainer,w=S[AE.categoryPicker.selectedIndex].v,AL=this.funcType===a.FunctionLeftStr?1:-1,AB=null,AD=null,AA=false,AK=0,AF=null,x=false,AH;switch(w){case E.Fixed:AB=z.fixed_hBox.negativeDDL;AD=q;AA=!AI.thousandSeparator;break;case E.Currency:AB=z.currency_hBox2.negativeDDL;AD=F;AK=AI.currencyPosition;AF=AI.currencySymbol;break;case E.Percentage:AB=z.percentage_hBox.negativeDDL;AD=f;break;case E.Scientific:x=true;break;case E.Custom:AH=true;break;default:return ;}if(AH){var AJ=R(AI.format,AL);AE.preview.preview_label.set("text",I.applyFormatToNumber(AJ,t.replace(".",L.number.DECIMALSEPARATOR)));AE.formatterContainer.custom_text.set("value",AJ);return ;}var AC=AI.decimalPlaces,u=AC+AL;u=Math.max(0,u);u=Math.min(J.MaxNegativeDidigts,u);AI.set("decimalPlaces",u);if(x){var AG=V(u);AI.set("format",AG[1]);AE.preview.preview_label.set("text",AG[0]);}else{P(AB,AD,AI,AA,AK,AF);}}function r(u,w){return Math.max(c.find(u,"v",w),0);}function C(x){var w=this.parent.parent.categoryPicker,u=S.map(function(z){return z.v;}).indexOf(x);w.set("selectedIndex",u);}function n(u,w,z,x){return H(undefined,u,w,undefined,M.copy(x,{useRichTooltip:true,updateTooltipConfig:function(){this.richTooltip={cssClass:"vi-regular vi-tooltip-A A-center",content:z,refNode:this.domNode,posType:mstrmojo.tooltip.POS_TOPCENTER,left:15,top:33};}}));}function b(){if(mstrApp.isSingleTier&&!mstrmojo.dom.isMac()){var AB=this.formatterContainer,AA=L.datetime,u={day:7,month:4,year:1998},x={hour:9,min:41,sec:46},z=AA&&AA.DATEINPUTFORMATS,w=AA&&AA.TIMEINPUTFORMATS;Z=[];U=[];z.forEach(function(AC){Z.push({v:AC,n:O.formatDateInfo(u,AC)});});w.forEach(function(AC){U.push({v:AC,n:O.formatTimeInfo(x,AC)});});AB.date_ddl.set("items",Z);AB.time_ddl.set("items",U);}else{Z=J.Date;U=J.Time;}}mstrmojo.vi.ui.NumberFormatter=mstrmojo.declare(mstrmojo.VBox,null,{scriptClass:"mstrmojo.vi.ui.NumberFormatter",cssClass:"NumberFormatter-content",formatValue:null,myData:null,oldData:null,categoryPicker:null,formatterContainer:null,preview:null,shortcutRow:null,adjustAfterCategoryChange:mstrmojo.emptyFn,preBuildRendering:function(){if(this._super){this._super();}b.call(this);var u=this.formatterContainer;if(this.formatValue){u.currency_hBox1.currency_symbol.selectedValue=this.formatValue.currencySymbol;u.fixed_btn.checked=!!this.formatValue.thousandSeparator;B.addWidgetCssClass(u.fraction_ddl,f[c.find(f,"v",this.formatValue.negativeNumbers)].r?" red":"");}},postBuildRendering:function Q(){if(this._super){this._super();}if(this.formatValue){this.categoryPicker.set("selectedIndex",r(this.categoryPicker.items,this.formatValue.category.toString()));}},children:[M.copy({alias:"categoryPicker",cssClass:"nf-category",onitemSelected:function l(AJ){if(!this.hasRendered){return ;}var AE=this,AH=AE.parent,z=AH.formatterContainer,u=AH.shortcutRow,AI=AH.preview.preview_label,AG=AJ.v,AB=AG===E.Automatic,x=AG===E.Scientific,w=[],AD=AH.myData;c.forEach(z.children,function(AK){AK.set("visible",false);});AH.border.set("visible",!AB);AH.preview.set("visible",!AB);AH.borderBottom.set("visible",!(!mstrApp.isWSStyling||AB||x));["border","moveLeftBtn","moveRightBtn"].forEach(function(AK){u[AK].set("visible",!AB);});AD.set("category",AG);AD.set("thousandSeparator",AG?K.ThousandSeparator:AH.formatValue.thousandSeparator);switch(AG){case E.Currency:P(z.currency_hBox2.negativeDDL,F,AD,false,AD.currencyPosition,AD.currencySymbol);z.currency_hBox1.currency_position.set("selectedIndex",r(J.CurrencyPosition,AD.currencyPosition.toString()));w=["currency_hBox1","currency_hBox2"];break;case E.Date:z.date_ddl.set("selectedIndex",r(Z,AD.format));w=["date_ddl"];break;case E.Time:z.time_ddl.set("selectedIndex",r(U,AD.format));w=["time_ddl"];break;case E.Percentage:P(z.percentage_hBox.negativeDDL,f,AD,false,0,null);w=["percentage_hBox"];break;case E.Fraction:z.fraction_ddl.set("selectedIndex",r(J.Fraction,AD.format));w=["fraction_ddl"];break;case E.Scientific:var AC=V(AD.decimalPlaces||0);AD.set("format",AC[1]);AI.set("text",AC[0]);break;case E.Custom:var AA=AD.customText||AD.format,AF=z.custom_text;AD.set("format",AA);AF.value=AA;AF.refresh();AI.set("text",I.applyFormatToNumber(AA,t.replace(".",L.number.DECIMALSEPARATOR)));w=["custom_condense","custom_text"];break;case E.Fixed:P(z.fixed_hBox.negativeDDL,q,AD,!AD.thousandSeparator,0,null);w=["fixed_hBox","fixed_btn"];break;}c.forEach(w,function(AK){z[AK].set("visible",true);});AH.adjustAfterCategoryChange();}},Y(S,"category")),{scriptClass:"mstrmojo.Box",cssClass:o+"nf-shortcut",alias:"shortcutRow",border:null,moveLeftBtn:null,moveRightBtn:null,children:[n("nf-shortcut-currency",function h(){C.call(this,E.Currency);},mstrmojo.desc(2051,"Currency"),undefined),n("nf-shortcut-percentage",function h(){C.call(this,E.Percentage);},mstrmojo.desc(2053,"Percentage"),undefined),n("nf-shortcut-fixed",function h(){C.call(this,E.Fixed);this.parent.parent.formatterContainer.fixed_btn.set("checked",true);},mstrmojo.desc(2050,"Fixed"),undefined),{scriptClass:"mstrmojo.Label",cssClass:"shortcut-border",alias:"border"},n("nf-MoveDecimalPoint left",function h(){m.call(this);},mstrmojo.desc(2189,"Increase Decimal"),{funcType:a.FunctionLeftStr,alias:"moveLeftBtn"}),n("nf-MoveDecimalPoint right",function h(){m.call(this);},mstrmojo.desc(2188,"Decrease Decimal"),{funcType:a.FunctionRightStr,alias:"moveRightBtn"})]},{scriptClass:"mstrmojo.Label",alias:"border",cssClass:"nf-border"},{scriptClass:"mstrmojo.Container",alias:"formatterContainer",cssClass:"nf-buttons",markupString:'<div id="{@id}" class="{@cssClass}" style="{@cssText}"></div>',fixed_hBox:null,fixed_btn:null,currency_hBox1:null,currency_hBox2:null,date_ddl:null,time_ddl:null,percentage_hBox:null,fraction_ddl:null,custom_condense:null,custom_text:null,markupSlots:{containerNode:function W(){return this.domNode;}},children:[{scriptClass:"mstrmojo.HBox",alias:"fixed_hBox",cssClass:X,negativeDDL:null,children:[{scriptClass:"mstrmojo.Label",cssClass:"negative-label",text:mstrmojo.desc(13891,"Negative:")},M.copy({alias:"negativeDDL",cssClass:"nf-NegativePullDown",getOptionProps:e,onitemSelected:function l(u){N.call(this,u);}},Y([],"format"))]},{scriptClass:"mstrmojo.CheckBox",alias:"fixed_btn",cssClass:o,label:"",onclick:function h(){var u=this.parent.parent;u.myData.set("thousandSeparator",this.checked?-1:0);P(this.parent.fixed_hBox.negativeDDL,q,u.myData,!this.checked,0,null);},preBuildRendering:function A(){this.set("label",mstrmojo.desc(13898,"Use 1000 Separator(#)").replace("#",L.number.THOUSANDSEPARATOR));}},{scriptClass:"mstrmojo.HBox",alias:"currency_hBox1",cssClass:X,visible:true,currency_symbol:null,currency_position:null,children:[{scriptClass:"mstrmojo.ui.editors.controls.ComboBox",alias:"currency_symbol",cssClass:"nf-CurrencySymbol",selectedValue:"$",items:d,postselectedValueChange:function k(u){var AA=this,z=AA.parent.parent.parent,x=u.value,w=z.myData;w.set("currencySymbol",x);P(this.parent.parent.currency_hBox2.negativeDDL,F,w,false,parseInt(w.currencyPosition,10),x);}},M.copy({cssClass:"nf-CurrencyPosition align-right",alias:"currency_position",onitemSelected:function l(u){var z=this,x=z.parent.parent.parent,w=u.v;x.myData.set("currencyPosition",parseInt(w,10));P(this.parent.parent.currency_hBox2.negativeDDL,F,x.myData,false,parseInt(w,10),x.myData.currencySymbol);}},Y(J.CurrencyPosition,"currencyPosition"))]},{scriptClass:"mstrmojo.HBox",alias:"currency_hBox2",cssClass:X,negativeDDL:null,children:[{scriptClass:"mstrmojo.Label",cssClass:"negative-label",text:mstrmojo.desc(13891,"Negative:")},M.copy({alias:"negativeDDL",cssClass:"nf-NegativePullDown",getOptionProps:e,onitemSelected:function l(u){N.call(this,u);}},Y([],"format"))]},M.copy({alias:"date_ddl",cssClass:X},Y(J.Date,"format",true)),M.copy({alias:"time_ddl",cssClass:X},Y(J.Time,"format",true)),{scriptClass:"mstrmojo.HBox",alias:"percentage_hBox",cssClass:X,negativeDDL:null,children:[{scriptClass:"mstrmojo.Label",cssClass:"negative-label",text:mstrmojo.desc(13891,"Negative:")},M.copy({alias:"negativeDDL",cssClass:"nf-NegativePullDown",getOptionProps:e,onitemSelected:function l(u){N.call(this,u);}},Y([],"format"))]},M.copy({alias:"fraction_ddl",cssClass:X},Y(J.Fraction,"format",true)),mstrmojo.Button.newWebButton(mstrmojo.desc(13893,"Condense (e.g.10M)"),function(){this.parent.custom_text.set("value",'[>=1000000]#,##0,,"M";[>=1000]#,##0,"K";0;[<=-1000000]#,##0,,"M";[<=-1000]#,##0,"K"');},false,{cssClass:"nf-condense",alias:"custom_condense"}),{scriptClass:"mstrmojo.TextBox",alias:"custom_text",cssClass:"nf-custom",onvalueChange:function g(){var x=this,w=x.parent.parent,u=x.value;w.myData.set("format",u);w.myData.set("customText",u);x.parent.parent.preview.preview_label.set("text",I.applyFormatToNumber(u,t.replace(".",L.number.DECIMALSEPARATOR)).replace(/\s/g,"&nbsp;"));}}]},{scriptClass:"mstrmojo.Label",alias:"borderBottom",cssClass:"nf-border"},{scriptClass:"mstrmojo.HBox",alias:"preview",cssClass:o+"nf-PreviewRow",preview_label:null,children:[{scriptClass:"mstrmojo.Label",cssClass:"preview_lable",text:mstrmojo.desc(13892,"Preview:")},{scriptClass:"mstrmojo.Label",cssClass:"align-right preview-info-label",alias:"preview_label"}]}]});}());(function(){mstrmojo.requiresCls("mstrmojo.array","mstrmojo.Box","mstrmojo.Label","mstrmojo.ui.SearchablePulldown","mstrmojo.warehouse.ui.WaitBoxTip");mstrmojo.requiresDescs(14185,2901,14187);var Z=mstrmojo.array,F=mstrmojo.dom,D=mstrmojo.DI.DIConstants,O=mstrmojo.desc(14185,"Search for a namespace"),P=mstrmojo.desc(2901,"Loading..."),L=mstrmojo.desc(14187,"Update namespaces"),S=mstrmojo.warehouse.EnumDataChangeEvents,R="WaitBoxTip",I=20,W=mstrmojo.desc(15258,"Namespace"),E="...",N=mstrmojo.DI.DIHelpers;var C=31;mstrmojo.ui.PopupListForNS=mstrmojo.declare(mstrmojo.ui.PopupList,null,{scriptClass:"mstrmojo.ui.PopupListForNS",onclick:function(b){if(b.getTarget().className.indexOf("disabled")!==-1){return false;}else{this._super(b);}}});mstrmojo.warehouse.ui.NameSpacePullDown=mstrmojo.declare(mstrmojo.Box,null,{scriptClass:"mstrmojo.architect.ui.NameSpacePullDown",cssClass:"mstrmojo-wh-NameSpacePullDown",visible:false,pulldown:undefined,btnRefreshNS:undefined,selectedIndex:undefined,waitBoxTip:undefined,labelNS:undefined,keepNamespacesVisible:false,sourceInfoLoadedByRefreshBtn:undefined,children:[{scriptClass:"mstrmojo.Label",alias:"labelNS",cssClass:"mstrmojo-wh-labelNS",text:W.length>I?W.substring(0,I-E.length)+E:W,title:W,useRichTooltip:true,updateTooltipConfig:function(){var b=F.position(this.domNode);this.set("richTooltip",{cssClass:"vi-regular A-center vi-tooltip-A",top:Math.max(b.y+b.h*1.2,0),left:Math.max(b.x+b.w*0.5,0),posType:mstrmojo.tooltip.POS_TOPCENTER,content:this.title});},visible:false},{scriptClass:"mstrmojo.ui.SearchablePulldown",alias:"pulldown",isHostedWithin:false,scrollNodeMaxHeight:350,hostedCSSClass:"mstrmojo-wh-Panel.AvailableTables",visible:false,nameSpacesLoaded:undefined,renderOnScroll:true,updateText:function V(b){this.selectedNode.textContent=b;},onPopupWidgetOpened:function X(){this.getPopupWidget().set("width",mstrmojo.dom.position(this.domNode).w+"px");},onPopupWidgetClosed:function B(){this.set("isEditing",false);var b=this.getPopupList(),c=b._oldItems;delete b._oldItems;if(c&&(!c[0].cls||c[0].cls.indexOf("disabled")===-1)){this.setDefaultListAndIndex(c);}},onitemSelected:function H(b){if(this.parent.mode===1){this.parent.selectedIndex=this.selectedIndex;if(this.parent.onItemSelectedCallback){this.parent.onItemSelectedCallback(b);}}else{this.parent.selectedIndex=undefined;}},getPopupListConfig:function(){var b=mstrmojo.ui.Pulldown.prototype.getPopupListConfig();b.scriptClass="mstrmojo.ui.PopupListForNS";return b;}},{scriptClass:"mstrmojo.Label",cssClass:"mstrmojo-wh-btnRefreshNS",alias:"btnRefreshNS",visible:false,onclick:function a(){if(this.parent.catalogRefreshNS&&typeof this.parent.catalogRefreshNS==="function"){this.parent.catalogRefreshNS();}else{var b=mstrApp.getRootController(),c=b.model;if(b instanceof mstrmojo.qb.bigquery.RootController||b instanceof mstrmojo.qb.bigquery.ESController){b.getNameSpaces();}else{c.catalogRefresh=true;if(this.parent.sourceInfoLoadedByRefreshBtn!==undefined){c.sourceInfo=this.parent.sourceInfoLoadedByRefreshBtn;}b.updateSelectedDBRoleId();}}},title:L,tooltipOpenDelay:0,useRichTooltip:true,updateTooltipConfig:function(){var b=F.position(this.domNode);this.set("richTooltip",{cssClass:"vi-regular vi-tooltip-A",top:Math.max(b.y+34,0),left:Math.max(b.x-8,0),posType:mstrmojo.tooltip.POS_TOPLEFT,content:this.title});},onvisibleChange:function M(b){if(this.parent&&this.parent.domNode){var c=this.parent.domNode.clientWidth||parseInt(this.parent.width,10);if(typeof c==="number"&&c>0){if(mstrApp.isWorkstation){this.parent.pulldown.set("width",c-(this.visible?(this.domNode.clientWidth==0?28:this.domNode.clientWidth):0)+"px");}else{this.parent.pulldown.set("width",c-(this.visible?this.domNode.clientWidth:0)+"px");}}}}}],onwidthChange:function J(b){var c=parseInt(b.value,10);if(c>0){this.pulldown.set("width",c-(this.btnRefreshNS.visible?this.btnRefreshNS.domNode.clientWidth:0)+"px");if(this.waitBoxTip){this.waitBoxTip.adjustCorners();}}},onvisibleChange:function M(b){if(this&&this.domNode){var c=this.domNode.clientWidth||parseInt(this.width,10);if(this.visible&&typeof c==="number"&&c>0){this.pulldown.set("width",c-this.btnRefreshNS.domNode.clientWidth+"px");if(this.waitBoxTip){this.waitBoxTip.adjustCorners();}}}},postBuildRendering:function Y(){var c=this;if(this._super){this._super();}if(F.isIE8||F.isIE9){mstrmojo.css.addClass(this.domNode,"ie9");}if(!mstrmojo.all[R]){mstrmojo.insert({scriptClass:"mstrmojo.warehouse.ui.WaitBoxTip",cssClass:"mstrmojo-WaitBoxTip",id:R,adjustCorners:function b(){var d=this;if(c&&c.domNode){var g=F.getComputedMargin(c.pulldown.domNode)[3],e=F.getComputedMargin(c.btnRefreshNS.domNode)[3],f=F.getComputedMargin(c.labelNS.domNode)[1];setTimeout(function(){var h=mstrmojo.dom.position(c.domNode);d.set("width",((c.domNode.clientWidth||parseInt(c.width,10))-(c.btnRefreshNS.visible?c.btnRefreshNS.domNode.clientWidth:0)-(c.labelNS.visible?c.labelNS.domNode.clientWidth:0)-g-e-f)+"px");d.set("position",{left:h.x+(c.labelNS.visible?c.labelNS.domNode.clientWidth:0)+g+f+"px",top:(h.y+c.domNode.clientHeight)+"px"});},300);}}});}this.waitBoxTip=mstrmojo.all[R];},init:function U(c){this._super(c);var f=this,d={},b=d[this.id]={};b[S.NAMESPACES_CHANGED]=function e(g){f.loadNameSpaces(g);};b[S.NAMESPACES_REQUESTED]=function e(g){f.preLoadNameSpaces(g);};b[S.NAMESPACES_CANCELED]=function e(g){f.afterCancelNameSpaces(g);};mstrApp.getRootController().attachDataChangeListeners(d);},mode:0,afterCancelNameSpaces:function A(b){var c=this.pulldown.getPopupList().visible;if(c){this.pulldown.getPopupList().close();}this.mode=0;this.pulldown.set("items",[{n:""},{n:L}]);this.pulldown.updateText(L);this.pulldown.set("visible",true);this.set("visible",true);this.btnRefreshNS.set("visible",true);this.labelNS.set("visible",true);if(D.xdaType.qbSingleTable===mstrApp.type){this.pulldown.domNode.style.maxWidth="153px";}},preLoadNameSpaces:function K(b){if(!((this.sourceInfo===b.sourceInfo)||(b.sourceInfo==="")||(b.sourceInfo===undefined))){return ;}this.set("visible",true);this.pulldown.set("visible",true);this.btnRefreshNS.set("visible",true);this.labelNS.set("visible",true);this.mode=0;var d=[];if(this.sourceInfo==="tablesPanel"){d[0]={n:""};this.pulldown.set("items",d);this.pulldown.set("selectedIndex",0);this.pulldown.updateText(O);var e=this.domNode.clientWidth||parseInt(this.width,10),g=F.getComputedMargin(this.pulldown.domNode)[3],c=F.getComputedMargin(this.btnRefreshNS.domNode)[3],f=F.getComputedMargin(this.labelNS.domNode)[1];this.waitBoxTip.showWait({message:P,showCancel:true,cancelCallback:this.cancelNamespace,extraCls:D.xdaType.qbSingleTable===mstrApp.type?"extraCls-selectTables":undefined,position:{left:F.position(this.domNode).x+(this.labelNS.visible?this.labelNS.domNode.clientWidth:0)+g+f+"px",top:(F.position(this.domNode).y+this.domNode.clientHeight)+"px"},width:(e-(this.btnRefreshNS.visible?this.btnRefreshNS.domNode.clientWidth:0)-(this.labelNS.visible?this.labelNS.domNode.clientWidth:0)-g-c-f)+"px"});}else{if(this.parent.parent.parent){d[0]={n:""};d[1]={n:P};this.pulldown.set("items",d);if(!this.keepNamespacesIndexUnselectedBeforeLoading){this.pulldown.set("selectedIndex",0);}this.labelNS.set("visible",true);this.pulldown.set("visible",true);this.set("visible",true);this.pulldown.updateText(O);}}},cancelNamespace:function G(){mstrApp.getRootController().cancelLoadNameSpaces();},loadNameSpaces:function Q(h){if(this.waitBoxTip){this.waitBoxTip.closeWait();}if(!((this.sourceInfo===h.sourceInfo)||(h.sourceInfo==="")||(h.sourceInfo===undefined))){return ;}var c=h.namespaces||[],k=true,l=h.dbRoleID,e,j,m=-1;if(c.length===0){c.push({n:""});k=false;}c=c.sort(function(p,o){return p.n.toLowerCase().localeCompare(o.n.toLowerCase());});var n=this.pulldown,g=n.selectedNode.innerHTML,f=n.getPopupList(),b=f.visible,d=this.keepNamespacesVisible||k;if(b){f.close();}this.mode=1;n.set("items",c);n.set("visible",d);this.labelNS.set("visible",d);this.set("visible",d);this.btnRefreshNS.set("visible",d);if(!k&&!h.error){n.set("selectedIndex",0);}this.dbRoleID=l;if(this.nameSpacesLoaded){this.nameSpacesLoaded();}if(k){if(this.sourceInfo==="tablesPanel"||b){n.openPopup(f);}if(mstrApp.getRootController().isUsingCookieNamespace()){e=window.localStorage;j=(e&&e.getItem(l));m=Z.find(c,"n",j);}if(m>=0){n.set("selectedIndex",m);}else{n.updateText(g);}if(g&&g!==O){n.processSearch();}}}});}());(function(){mstrmojo.requiresCls("mstrmojo.Editor","mstrmojo.array","mstrmojo.Button","mstrmojo.css","mstrmojo.hash","mstrmojo.Label","mstrmojo.Box","mstrmojo.ui.Pulldown","mstrmojo.ui.SearchablePulldown","mstrmojo.func");mstrmojo.requiresDescs(221,1442,2751,2891,11949,11950,11951,11942,13397,13398,14640,14648);var R=mstrmojo.array,V=mstrmojo.css,N=mstrmojo.hash,O=mstrmojo.func,M=mstrmojo.Button.newWebButton,P=mstrmojo.dom,U="mstrmojo-link-validation",Q="mstrmojo-link-vt",F=function F(W){if(W.old){this.removedLinks.push(W);}this.links.removeChildren(W);},S=function S(){var u=this.dsMap,q=this.docModel,Z=q.datasets,z=function z(j,x,a){var k={n:a||"",did:x||null,parent:j||null,lv:(j?j.lv+1:-1),children:[]};if(j){j.children.push(k);}return k;},f=z(),Y,X,W,h,b,r,m,w,t,p,o,n,d,c,e,l,g;N.forEach(Z,function(a){if(q.isMDXDataset(a)){b=a.tables;for(p=0,c=b.length;p<c;p++){r=b[p];Y=z(f,r.did,r.n);Y.isMDX=true;for(o=0,e=r.dimensions.length;o<e;o++){m=r.dimensions[o];X=z(Y,m.did,m.n);for(n=0,l=m.hierarchies.length;n<l;n++){w=m.hierarchies[n];W=z(X,w.did,w.n);for(d=0,g=w.att.length;d<g;d++){t=w.att[d];h=z(W,t.did,t.n);h.att=t;u[r.did+":"+t.did]=h;}}}}}else{Y=z(f,a.did,a.name);Y.isMDX=false;R.forEach(a.att,function(j){h=z(Y,j.did,j.n);h.att=j;u[a.did+":"+j.did]=h;});}});return f;},B=function B(c,d){c=R.ensureArray(c);var b=this,a=this.attribute.did,e=this.docModel,Y=this.datasetId,X="\u001F",W={success:function(g){var j=g.als,f=(e.als&&e.als.links)||{},h=b.dsTree;R.forEach(c,function(r,m){var t={},k={},l=[],n={},q=a+" "+r,o=R.filter(j[m].ats,function(u){return !e.isInDataset(Y,u.at,["att"]);}),p=function p(u,w){if(!n[u]){n[u]={};}if(!n[u][w]){n[u][w]=true;}};R.forEach(o,function(x){var u=x.at,w=x.fms;t[u]=true;if(w){R.forEach(w,function(z){p(u,z.fm);});}});N.keyarray(f).forEach(function(u){if(u===q){R.forEach(f[u],function(w){w=w.split(" ");t[w[0]]=true;p(w[0],w[1]);});}});if(N.keyarray(t).length>0){R.forEach(h.children,function(w){var u=function(x){var z;if(!x.att){return ;}x=x.att;if(t[x.did]){if(!k[x.n]){k[x.n]={};}if(!k[x.n][x.did]){k[x.n][x.did]=[];}k[x.n][x.did].push(w.n);z=N.copy(x,z);z.dsId=w.did;l.push(z);}};if(w.isMDX){R.forEach(w.children,function(x){R.forEach(x.children,function(z){R.forEach(z.children,u);});});}else{R.forEach(w.children,u);}});}b.tgtAttrs[r]=l;b.tgtForms[r]=n;b.namesHash[r]=k;});}},Z={taskId:"validateDocumentLinks",msgID:e.mid,action:1,attributeList:a,attributeFormList:c.join(X)};mstrApp.serverRequest(Z,O.wrapMethods(W,d));},E=function(Z,b,X,a){Z.richTooltip=null;if(!Z.isSearching){var Y=b&&b.scrollWidth>b.clientWidth;X=Y?mstrmojo.desc(14648,"## from ###").replace("##",X):"";if(a){if(!Y){X=mstrmojo.desc(14640,"From ###");}X=X.replace("###",a);}var W=mstrmojo.dom.position(b);Z.richTooltip={cssClass:"vi-regular vi-tooltip-V",contentNodeCssClass:"regular-unitlist-tooltips",posType:mstrmojo.tooltip.POS_BOTTOMLEFT,content:X,top:W.y-6,left:W.x};}},D=function D(d){var e=this,g=function(o){var m=o.fs,p=o.de,n=[];(m||[]).forEach(function(q){if(q.obf&&(!p||q.idf)){n.push({n:q.fnm,v:q.fid,idf:q.idf});}});return n;},h=g(this.attribute),a=function(p,n){var m=g(p);var q=(e.tgtForms[n]&&e.tgtForms[n][p.did])||{};var o=[];R.forEach(m,function(r){if(q[r.v]){o.push(r);}});return o;},c=function c(n){var m=[];R.forEach(e.tgtAttrs[n],function(o){if(a(o,n||e.idFormId).length>0){var q=e.namesHash[n],p=o.n;if(q[o.n]&&N.keyarray(q[o.n]).length>1){p=p+" ("+q[o.n][o.did].join(",")+")";}m.push({n:o.n,v:o,tt:p});}});if(m.length===0){m.push({n:mstrmojo.desc(13398,"No valid object"),v:{did:null},cls:"nvo",t:1});}return m;},j=c((d&&d.srcFormId)||this.idFormId),k=function(m,n){return R.find(m.fs,n?"fid":"idf",n||true);},l=function(n){var m=-1;j.forEach(function(p,o){if(p.v.did===n){m=o;}});return m;},X=function(n){var m=j[n];if(!m){return mstrmojo.desc(13397,"Select an attribute");}else{return m.n;}},Y=function(n){var o=n.items,m=n.selectedIndex;if(m>=0){if(o[m].idf){return ;}}o.forEach(function(q,p){if(q.idf){n.set("selectedIndex",p);}});};this.links.addChildren({scriptClass:"mstrmojo.Box",cssClass:"mstrmojo-linkRow",slot:"containerNode",old:!!d,oldMeta:d,getMeta:function(){var m=this.linkFromForm,o=this.linkToAtt,n=this.linkToForm;return{srcAttrId:e.attribute.did,srcFormId:m.items[m.selectedIndex].v,tgtAttrId:o.items[o.selectedIndex]&&o.items[o.selectedIndex].v.did,tgtFormId:n.items[n.selectedIndex]&&n.items[n.selectedIndex].v};},children:[{scriptClass:"mstrmojo.Label",cssClass:"mstrmojo-attName",text:e.attribute.n,useRichTooltip:true,updateTooltipConfig:function(q){var p=q.target,m=this.text,n=e.datasetId,o=n?e.docModel.datasets[n].name:"";E(this,p,m,o);}},{scriptClass:"mstrmojo.ui.Pulldown",cssClass:"mstrmojo-linkFormFromPD",alias:"linkFromForm",value:"ID",isHostedWithin:true,items:h,selectedIndex:k(e.attribute,d&&d.srcFormId),onitemSelected:function(n){var m=this,o=function(){var q=m.parent.linkToAtt;j=c(n.v);q.set("items",j);q.set("selectedIndex",-1);q.set("text",mstrmojo.desc(13397,"Select an attribute"));V.addClass(q.selectedNode,"nvo");},p={success:o};if(this.hasRendered){if(this.parent.old){this.parent.oldUpdated=true;}if(!n.idf){Y(this.parent.linkToForm);if(!e.tgtForms[n.v]){B.call(e,n.v,p);return ;}}o();}}},{scriptClass:"mstrmojo.Label",cssClass:"mstrmojo-linksToLabel",text:mstrmojo.desc(11949,"links to")},{scriptClass:"mstrmojo.ui.SearchablePulldown",cssClass:"mstrmojo-linkToAtt",alias:"linkToAtt",useRichTooltip:true,isHostedWithin:false,items:j,text:X(l(d&&d.tgtAttrId)),selectedIndex:l(d&&d.tgtAttrId),allowCustomText:true,allowEmptyText:true,updateTooltipConfig:function(r){var q=r.target,m=q.getAttribute("tt"),o=this.getSelectedItem(),n=o?o.v.dsId:null,p=n?e.docModel.datasets[n].name:"";if(this.selectedNode===q&&o){m=o.tt;}E(this,q,m,p);},onitemSelected:function(q){if(!q||q.v.did===null){return ;}var p=this.parent.linkToForm,o=this.parent.linkFromForm,n=a(q.v,o.items[o.selectedIndex].v),r=function r(t,w){var u=R.find(t,w?"v":"idf",w||true);if(u===-1&&t.length>0){u=0;}return u;},m;R.forEach(n,function(t){if(t.idf){m=false;return false;}});if(m){K.call(e,true);}p.set("items",n);p.set("selectedIndex",r(n,!this.hasRendered&&d&&d.tgtFormId));if(this.hasRendered&&this.parent.old){this.parent.oldUpdated=true;}J.call(e);},onPopupWidgetOpened:function b(){if(this.selectedIndex===-1){this.set("text","");}V.removeClass(this.selectedNode,"nvo");},onPopupWidgetClosed:function f(){mstrmojo.ui.SearchablePulldown.prototype.onPopupWidgetClosed.call(this);if(this.selectedIndex===-1&&this.text===""){this.set("text",mstrmojo.desc(13397,"Select an attribute"));V.addClass(this.selectedNode,"nvo");}else{V.removeClass(this.selectedNode,"nvo");}this.hideTooltip();R.forEach(e.collapseTargets,function(m){m.className="arrow-b";V.removeClass(m.parentNode.parentNode,"collapse");});R.forEach(e.collapseTreeNodes,function(m){delete m.collapse;});R.forEach(this.list.itemsContainerNode.childNodes,function(m){m.style.display="";});},postBuildRendering:function W(){mstrmojo.ui.SearchablePulldown.prototype.postBuildRendering.call(this);if(this.selectedIndex===-1){V.addClass(this.selectedNode,"nvo");}this.list.popupConfig.clear();},getPopupListConfig:function Z(){return{scriptClass:"mstrmojo.ui.PopupList",alias:"list",width:"170px",tooltipOrientation:"vertical",selectionPolicy:"reselect",useRichTooltip:true,locksHover:true,listHooks:{select:function m(t,u,r){this.parent.set("selectedIndex",r);this.close();}},onclick:function n(AC){try{var t=AC.getTarget(),AD=this.getItemFromTarget(t),z=P.findAncestorByAttr(t,"idx",true,this.domNode),x=this.items;if(x){this.parent.set("items",x);}if(AD){AC.cancel();if(t.className==="arrow-b"||t.className==="arrow-r"){var r=this.itemsContainerNode.childNodes,w=function w(AF){var AE;while(AF){AE=AF.className||"";if(AE.indexOf("lv")===0){return window.parseInt(AE.substring(2),10);}AF=AF.firstChild;}return null;},AB=function AB(AE,AH){var AG=e.dsMap,AF=AG[AE.dsId+":"+AE.did];while(AF){if(AF.lv===AH){return AF;}AF=AF.parent;}return null;},AA=function AA(){var AN=(t.className==="arrow-b"),AH=t.parentNode.parentNode,AE=w(AH),AI=AD._renderIdx,AF=AB(AD.v,AE),AL=x.length,AK,AG,AJ,AM,AP,AO;t.className=AN?"arrow-r":"arrow-b";if(!e.collapseTargets){e.collapseTargets=[];}e.collapseTargets.push(t);V.toggleClass(AH,"collapse",AN);AF.collapse=AN;if(!e.collapseTreeNodes){e.collapseTreeNodes=[];}e.collapseTreeNodes.push(AF);for(AK=AI+1;AK<AL;AK++){AG=r[AK];AJ=w(AG);if(AJ<=AE){break;}AM=AB(x[AK].v,AJ);AP=AM.parent;AO=true;while(AP){if(AP.collapse){AO=false;break;}AP=AP.parent;}AG.style.display=(AO?"":"none");}};AA();}else{if(z&&z.node.className.indexOf("item")!==-1){this.doItemSelect(AD,AC||{});}}}}catch(u){mstrApp.onerror(u);}},getItemProps:function o(u,r){var t=mstrmojo._IsList.getItemProps.call(this,u,r);var w=u.cls;if(w){t.addCls(w);}return t;},getItemMarkup:function q(AE,AD){if(AE.v.did===null){return'<{@tag} class="item {@cls}" did="'+AE.v.did+'" idx="{@idx}" style="{@style}">{@n}</{@tag}>';}var AF=[],AB=AE.v.did,u=AE.v.dsId,w=u?e.docModel.datasets[u]:null,t=w?w.name:"",AC=AD>0&&this.items[AD-1].v,z=e.dsMap,x=z[AE.v.dsId+":"+AB],r=z[(AC&&(AC.dsId+":"+AC.did))];AF.push("</div>");while(x){if(x.lv===-1){break;}if(x.att){var AA=x.att.da?"derived-attr":"attr";AF.push('<div class="lv'+x.lv+' dim item {@cls}" tt="'+AE.tt+'" did="'+AB+'" dsName="'+t+'" idx="{@idx}" style="{@style}"><div><div class="'+AA+'"></div></div>{@n}</div>');}else{if(x!==r){AF.push('<div class="lv'+x.lv+' dim" dtt="'+x.n+'" idx="{@idx}"><div><div class="arrow-b"></div></div>'+x.n+"</div>");}else{break;}}x=x.parent;r=(r&&r.parent)||null;}AF.push("<div>");return AF.reverse().join("");},updateTooltipConfig:function p(z){var x=z.target,u=x.getAttribute("tt"),t=x.getAttribute("dtt"),w=x.getAttribute("dsName"),r=u||t;if(r){E(this,x,r,w);}}};}},{scriptClass:"mstrmojo.ui.Pulldown",cssClass:"mstrmojo-linkFormToPD",alias:"linkToForm",value:"ID",isHostedWithin:true,items:[],onitemSelected:function(m){if(this.hasRendered){if(this.parent.old){this.parent.oldUpdated=true;}if(!m.idf){Y(this.parent.linkFromForm);}}}},M("",function(){F.call(e,this.parent);},false,{cssClass:"mstrmojo-removeLink"})]});this.links.renderChildren();},K=function(W){V.toggleClass(this.editorNode,"mstrmojo-advanced",W);},L=function(Z){var X=this,a=U,W;try{mstrmojo.all[a].destroy();}catch(Y){}W={scriptClass:"mstrmojo.Editor",id:a,title:mstrmojo.desc(2751,"Message"),cssClass:"mstrmojo-alert",buttons:[M(mstrmojo.desc(1442,"Ok"),function(){mstrmojo.all[a].destroy();H.call(X);},true)],children:[{scriptClass:"mstrmojo.Label",text:Z}],visible:true,zIndex:1000};mstrmojo.insert(W).render();},H=function(){var Y=this,X=this.illLinks,W=this.links.children,Z=Q;R.forEach(X,function(a){a=a.al;R.forEach(W||[],function(c){var e=c.getMeta(),f=c.linkToAtt,b,d;if(e.srcAttrId===a.alaid1&&e.tgtAttrId===a.alaid2){if(!mstrmojo.all[Z]){d=new mstrmojo.Tooltip({id:Z,cssClass:Y.themeClassName+" vi-warning vi-tooltip-V",contentNodeCssClass:"regular-unitlist-tooltips",posType:mstrmojo.tooltip.POS_BOTTOMLEFT,updatePopupConfig:null});P.attachEvent(Y.editorNode,"click",function(){d.close();V.toggleClass(f.selectedNode,"mstrmojo-Warning",false);});}else{d=mstrmojo.all[Z];}d.close();b=mstrmojo.dom.position(f.selectedNode);d.set("top",b.y-6);d.set("left",b.x);d.set("content",a.alstmsg);V.toggleClass(f.selectedNode,"mstrmojo-Warning",true);d.open();return false;}});});},A=function(){var W=mstrmojo.all[Q];if(W){W.close();}},J=function J(){this.buttons[0].enabled=true;if(this.btnHbox){this.btnHbox.children[0].set("enabled",true);}},G=function G(){var W=this,X=[{scriptClass:"mstrmojo.Box",cssClass:"mstrmojo-toolBox",alias:"tools",children:[{scriptClass:"mstrmojo.Button",cssClass:"mstrmojo-WebHoverButton mstrmojo-addLink",text:mstrmojo.desc(11950,"Add A Link"),title:mstrmojo.desc(11950,"Add A Link"),onclick:function(){D.call(W);A.call(W);}},{scriptClass:"mstrmojo.Button",cssClass:"mstrmojo-WebHoverButton mstrmojo-showForms",text:mstrmojo.desc(2891,"Show Attribute Forms"),title:mstrmojo.desc(2891,"Show Attribute Forms"),onclick:function(){K.call(W,true);A.call(W);}},{scriptClass:"mstrmojo.Button",cssClass:"mstrmojo-WebHoverButton mstrmojo-hideForms",text:mstrmojo.desc(11951,"Hide Attribute Forms"),title:mstrmojo.desc(11951,"Hide Attribute Forms"),onclick:function(){K.call(W,false);A.call(W);}}],slot:"containerNode"},{scriptClass:"mstrmojo.Box",cssClass:"mstrmojo-linksBox mstrmojo-advanced",alias:"links",slot:"containerNode"}];this.addChildren(X);};mstrmojo.vi.ui.editors.AttributeLinkEditor=mstrmojo.declare(mstrmojo.Editor,null,{scriptClass:"mstrmojo.vi.ui.editors.AttributeLinkEditor",title:mstrmojo.desc(11942,"Link Attributes"),cssClass:"mstrmojo-att-link",btnAlignment:"right",buttons:null,modal:true,visible:false,help:"link_attributes_editor.htm",attribute:null,tgtAttrs:null,tgtForms:null,docModel:null,datasetId:null,namesHash:null,removedLinks:null,preBuildRendering:function C(){var Z=this,X=this.docModel,Y=function(){var a=(X.als&&X.als.links)||{},b=[];N.keyarray(a).forEach(function(c){if(c.indexOf(Z.attribute.did+" ")===0){a[c].forEach(function(d){b.push({srcAttrId:c.split(" ")[0],srcFormId:c.split(" ")[1],tgtAttrId:d.split(" ")[0],tgtFormId:d.split(" ")[1]});});}});return b;},W;this.set("buttons",[M(mstrmojo.desc(1442,"OK"),function(){var h=[],b=Z.links.children,a=function(){var j=X.controller,k=X.controller.getRefreshCallback();if(h.length>0){j.cmdMgr.execute({execute:function(){this.submit(h,k,{style:{params:{treesToRender:3}}});},urInfo:{callback:k}});}Z.close();},g=false,d,e;Z.removedLinks.forEach(function(j){d=N.copy(j.oldMeta,{act:"applyAttributeLinking",unlink:true});h.push(d);});(b||[]).forEach(function(j){if(j.old&&j.oldUpdated){d=N.copy(j.oldMeta,{act:"applyAttributeLinking",unlink:true});h.push(d);}if(!j.old||(j.old&&j.oldUpdated)){e=j.getMeta();if(!e.tgtAttrId){return ;}d=N.copy(e,{act:"applyAttributeLinking",unlink:false});h.push(d);}});R.forEach(h,function(j){if(!j.unlink){g=true;return false;}});if(!g){a();return ;}var f={taskId:"validateDocumentLinks",msgID:X.mid,action:2,manipulationList:'{"ml":'+JSON.stringify(h)+"}"},c={success:function(j){if(j.als&&j.als.length>0){var k="";R.forEach(j.als,function(l){k+=l.al.alstmsg+"\n";});Z.illLinks=j.als;L.call(Z,k);return ;}a();}};mstrApp.serverRequest(f,c);},true,{enabled:false}),M(mstrmojo.desc(221,"Cancel"),function(){Z.close();})]);G.call(this);W=Y(this.attribute.did);if(W.length>0){W.forEach(function(a){D.call(Z,a);});J.call(this);}else{D.call(this);}this._super();},close:function I(){A.call(this);this.destroy();}});mstrmojo.vi.ui.editors.AttributeLinkEditor.open=function(c){var X=mstrmojo.insert(N.copy(c,{scriptClass:"mstrmojo.vi.ui.editors.AttributeLinkEditor",tgtAttrs:{},tgtForms:{},namesHash:{},removedLinks:[]})),a=X.attribute,d=a.did,W=X.docModel,Z=(W.als&&W.als.links)||{},Y=[],b={success:function(){X.set("visible",true);X.render();}};R.forEach(a.fs,function(e){if(e.idf){X.idFormId=e.fid;return false;}});N.keyarray(Z).forEach(function(f){var e=f.split(" ");if(e[0]===d){Y.push(e[1]);}});if(R.indexOf(Y,X.idFormId)===-1){Y.push(X.idFormId);}X.dsMap={};X.dsTree=S.call(X);B.call(X,Y,b);};}());(function(){mstrmojo.requiresCls("mstrmojo.Box","mstrmojo.dom","mstrmojo.Label","mstrmojo.TextArea","mstrmojo.warehouse.dbroles.DBRoleHelper","mstrmojo.warehouse.dbroles.DBRoleSettingCheckbox","mstrmojo.warehouse.dbroles.DBRoleSettingPulldown","mstrmojo.DI.DIHelpers");mstrmojo.requiresDescs(14036,14037,14038,14467,14928);var O=mstrmojo.array,P=mstrmojo.css,K=mstrmojo.hash,F=mstrmojo.warehouse.dbroles.DBRoleHelper,G=mstrmojo.DI.DIHelpers,Q="MSTR_CUSTOM=true;",J=mstrmojo.desc(14036,"Show connection string"),A=mstrmojo.desc(14037,"Hide connection string"),N=mstrmojo.desc(14038,"Edit connection string");mstrmojo.warehouse.dbroles.DBRoleSettingConnectionStringEditor=mstrmojo.declare(mstrmojo.Box,null,{scriptClass:"mstrmojo.warehouse.dbroles.DBRoleSettingConnectionStringEditor",cssClass:"mstrmojo-wh-DBRoleSettingConnectionStringEditor",enabled:true,getValue:function D(){if(this.visibleContents&&this.enabledContents){var U=this.contents.connectionArea.value;U=F.cleanDSNConnection(U+(U.slice(-1)===";"?"":";")+Q);return U;}return"";},setValue:function B(U){var X=this.contents;this.toggleContents();X.editString.setValue(true);var W=F.cleanDSNConnectionPlaceHolders(U);if(G.getEnvObj().isWSMac()&&G.isLocalWS()){var V=W.match(/;MSTR_JDBC_JAR_FOLDER=[^;]+;$/);if(V){W=W.substring(0,V.index);}}W=W.replace(/MSTR_CUSTOM=true;$/,"");X.connectionArea.set("value",W);},isValid:function M(){return{val:true,msg:""};},connectionArea:undefined,driverList:undefined,showLabel:undefined,editString:undefined,info:{},drivers:[],enableFn:mstrmojo.emptyFn,generateConnectionStringFn:mstrmojo.emptyFn,dbID:{},dbms:{},load:function E(){var b=this.contents,d=this.dbID,X=this.dbms,V=d.dbVersions[O.find(d.dbVersions,"v",X.db_ver)],e=V.connections.concat(V.altconnections),W=F.driverExists.call(this,e),Y={},Z=[];O.forEach(this.dbIDVersions,function(c){O.forEach(c.dbVersions,function(f){O.forEach(f.connections.concat(f.altconnections),function(g){Y[g.driver]=g;});});});var U;K.forEach(this.drivers,function(c){U=mstrmojo.hash.clone(c);if(Y[c.n]){U.n=U.n+" (Certified)";U.title=U.n;U.str=Y[c.n].str;}Z.push(U);});b.driverList.set("items",Z);if(W.exists){var a=O.find(this.drivers,"n",W.driver);if(a<0){a=0;}b.driverList.set("selectedID",Z[a].n);}this.updateString();},visibleContents:false,enabledContents:false,toggleContents:function S(){this.visibleContents=!this.visibleContents;this.contents.set("visible",this.visibleContents);this.showLabel.set("text",(this.visibleContents?A:J));if(!this.visibleContents){this.contents.editString.setValue(false);this.enableFn(true);}else{this.load();}},updateString:function H(){if(this.visibleContents){this.contents.connectionArea.set("value",F.cleanDSNConnectionPlaceHolders(this.generateConnectionStringFn()));}},children:[{scriptClass:"mstrmojo.Label",cssClass:"mstrmojo-wh-DBRoleConnection-ShowConnection",alias:"showLabel",text:J,onclick:function R(){this.parent.toggleContents();}},{scriptClass:"mstrmojo.Box",cssClass:"mstrmojo-wh-DBRoleConnection-ConnectionStringContents",alias:"contents",visible:false,children:[{scriptClass:"mstrmojo.warehouse.dbroles.DBRoleSettingCheckbox",label:N,alias:"editString",oncheckedChange:function I(){var U=this.parent;U.parent.enableFn(!this.checked);U.connectionArea.set("enabled",this.checked);P.toggleClass(this.parent.CSLabel.domNode,"disabled",!this.checked);U.driverList.set("enabled",this.checked);U.parent.enabledContents=this.checked;}},{scriptClass:"mstrmojo.warehouse.dbroles.DBRoleSettingPulldown",cssClass:"mstrmojo-wh-DBRolePulldown mstrmojo-wh-DBRoleConnection-driverList",caption:mstrmojo.desc(14467,"Driver"),alias:"driverList",itemIdField:"n",itemField:"n",enabled:false,bindings:{visible:function(){var U=this.parent.parent;return(U.dbID.connType&4)!==4;}},preBuildRendering:function C(){if(this._super){this._super();}},onChange:function L(U){var V=this.parent.parent,X=this.parent.parent.contents,W;if(V.enabledContents){W=U.str||"";}X.connectionArea.set("value",F.cleanDSNConnectionPlaceHolders(V.generateConnectionStringFn(W).replace(Q,"")));}},{scriptClass:"mstrmojo.Label",cssClass:"mstrmojo-wh-DBRoleConnection-ConnectionString-Label",alias:"CSLabel",enabled:false,text:mstrmojo.desc(14928,"Connection String"),bindings:{visible:function(){return !!mstrApp.isWorkstation;}}},{scriptClass:"mstrmojo.TextArea",cssClass:"mstrmojo-wh-DBRoleConnection-ConnectionString",value:"",alias:"connectionArea",maxLength:1024,enabled:false,preBuildRendering:function C(){if(this._super){this._super();}}}]}]});}());(function(){mstrmojo.requiresCls("mstrmojo.Obj","mstrmojo.array","mstrmojo.architect.menu.EnumMenuActions","mstrmojo.architect.ui.editors.DataSourceEditor","mstrmojo.warehouse.EnumObjectTypes");var J=mstrmojo.array,C=mstrmojo.architect.menu.EnumMenuActions,L=mstrmojo.warehouse.EnumObjectTypes,E=mstrmojo.desc(11398,"Functionality not yet implemented."),G=mstrmojo.desc(6722,"Are you sure you want to delete '##'?"),I="Are you sure you want to delete these ## objects?";var K=false;function F(P,N){var O=this.data,M=(O&&O.length)?O[0]:O;return(M&&M[P])?M[P](O,N):true;}mstrmojo.architect.menu.ArchitectMenu=mstrmojo.declare(mstrmojo.Obj,null,{scriptClass:"mstrmojo.architect.menu.ArchitectMenu",dynamicUpdate:true,queryEnabled:function H(M){return F.call(this,"isEnabled",M)||K;},queryVisible:function D(M){return F.call(this,"isVisible",M)||K;},queryChecked:function B(M){return F.call(this,"isChecked",M)||K;},executeCommand:function(W){var V=mstrmojo.architect.menu.ArchitectMenu.EnumRelationType,Q=this.data,R=mstrApp.getRootController(),P=Q.parentAttributeId,M=Q.childAttributeId,N=Q.relationTableId;switch(W.action){case C.NONE:break;case C.DELETE:var O;if(Q.length){O=I.replace("##",Q.length);}else{O=G.replace("##",Q.n);}mstrmojo.confirm(O,{confirmBtn:{fn:function(){R.deleteObject(Q);}}});break;case C.RENAME:R.renameObject(Q);break;case C.AUTOMAP:R.autoMapTable([].concat(Q));break;case C.SAMPLE_DATA:R.showSampleData(Q);break;case C.CONVERT_ATTR_TO_FACT:R.convertAttributeToFact(Q);break;case C.CONVERT_ATTR_TO_FORM:R.convertAttributeToForm(Q,W);break;case C.LOGICAL_TABLE_SIZE:R.setTableLogicalSize(Q);break;case C.CONVERT_COLUMN_TO_FORM:R.convertColumnToForm(Q,W);break;case C.SET_AS_MULTILINGUAL:R.setAsMultiLingual(Q);break;case C.CONVERT_FACT_TO_ATTR:R.convertFactToAttribute(Q);break;case C.REMOVE_FROM_TABLE:R.removeFromTable(Q);break;case C.SET_AS_LOOKUP:R.setAsLookup(Q);break;case C.NEW_FACT:W.tp=L.FACT;W.isNew=true;R.openExpressionEditor(Q,W);break;case C.NEW_ATTR:W.tp=L.ATTRIBUTE;W.isNew=true;R.openExpressionEditor(Q,W);break;case C.UPDATE_FORMAT:R.updateFormFormat(Q,W);break;case C.EDIT:W.tp=Q.tp;W.isNew=false;R.openExpressionEditor(Q,W);break;case C.MAPPING:R.updateMappingMethod(Q,W);break;case C.UPDATE_AGGR:R.updateAggregation(Q,W);break;case C.REMOVE_TABLE:R.removeFromCurrentLayer(Q);break;case C.ADD_ATTRIBUTE:R.createAttribute(Q);break;case C.ADD_FACT:R.createFact(Q);break;case C.DATA_SOURCES:var U=mstrmojo.all[this._dseid]||new mstrmojo.architect.ui.editors.DataSourceEditor({onSubmit:function S(X){R.setTableDBRoles(X);}});this._dseid=U.id;U.open(undefined,{dataSources:R.getTableDBRoles(Q)});break;case C.REMOVE_ATTR_FROM_RELATIONSHIP:R.removeAttributeFromRelation(Q);break;case C.DELETE_RELATIONSHIP:R.removeRelation(P,M);return ;case C.ONE_TO_ONE:R.updateRelation(P,M,V.ONE_TO_ONE,N);break;case C.ONE_TO_MANY:R.updateRelation(P,M,V.ONE_TO_MANY,N);break;case C.MANY_TO_MANY:R.updateRelation(P,M,V.MANY_TO_MANY,N);break;case C.RELATIONSHIP_TABLE_ENTRY:R.updateRelation(P,M,Q.relationType,W.did);break;case C.SHOW_UNUSED_COLUMNS:R.changeLayerTableColumnView([].concat(Q),W);break;case C.ADD_TO_LAYER:R.addOrRemoveTables([].concat(Q),true);break;case C.REMOVE_FROM_LAYER:R.addOrRemoveTables([].concat(Q),false);break;case C.UPSTRUCT:R.handleUpdateStructures([].concat(Q));break;case C.CREATE_ALIAS:R.createTableAlias([].concat(Q));break;case C.LINKS:R.showLinks(Q);break;case C.UPDATE_CATEGORY:R.updateFormCategory(Q,W);break;case C.UNGROUP_FORMS:R.unGroupForms(Q,W);break;case C.UPDATE_GROUP:R.groupForms([Q],W);break;case C.UNGROUP_FORM:R.unGroupForms(Q,W);break;case C.TX_ONE_TO_ONE:R.setTransformationCardinality(Q.did,true);break;case C.TX_MANY_TO_MANY:R.setTransformationCardinality(Q.did,false);break;case C.TX_APPLY_TO_ALL:R.setTransformationAllAttributes(Q.did,true);break;case C.TX_APPLY_TO_HIGHEST:R.setTransformationAllAttributes(Q.did,false);break;case C.SET_ENTRY_POINT:R.addEntryPoint(Q.attributeId);break;case C.REMOVE_ENTRY_POINT:R.removeEntryPoint(Q.attributeId);break;case C.ATTRIBUTE_FILTERS:R.editFilters(Q.attributeId,undefined,undefined);break;case C.ADD_JOIN_CHILDREN:R.addJointChildren(Q,W.did);break;case C.USE_AS_DRILL:R.updateHiearchySubtype(true);break;case C.USE_AS_BROWSE:R.updateHiearchySubtype(false);break;default:mstrmojo.alert(E);break;}},getMenuConfig:function A(N){var Q=new mstrmojo.ui.menus.MenuConfig(),R=this.id,O=false,M,P=N||this.cm;J.forEach(P,function(U){M=U.action===C.NONE;if(this.queryVisible(U)){var S=["xt "+(U.icn||"")],V=function V(){this.executeCommand(U);};if((this.queryEnabled(U)===false)||M){if((M&&!O)||!M){if(M){Q.addSeparator();}else{Q.addDisabledMenuItem(U.n,S.join(" "));}}if(M){O=true;}}else{if(U.items){Q.addSubMenuItem(U.n,"",R,U.buildSubMenuConfig||this.getMenuConfig,U.items);O=false;}else{if(U.hasEdt){Q.addEditorMenuItem(U.n,R,U.buildSubMenuConfig);O=false;}else{Q.addToggleMenuItem(U.n||"",S.join(" "),V,V,R,this.queryChecked(U));O=false;}}}}},this);return Q;}});mstrmojo.architect.menu.ArchitectMenu.EnumRelationType={ONE_TO_ONE:1,ONE_TO_MANY:2,MANY_TO_MANY:4,PARENT_CHILD:0};}());(function(){mstrmojo.requiresCls("mstrmojo.Obj","mstrmojo.architect.menu.ArchitectMenu","mstrmojo.architect.menu.EnumMenuActions","mstrmojo.DI.DIHelpers","mstrmojo.array");mstrmojo.requiresDescs(1088,629,9099,1388,3397,12259,11425,4572,15173);var O=mstrmojo.DI.DIHelpers,R=mstrmojo.array;var U=mstrmojo.architect.menu.EnumMenuActions,M=U.NONE,G=U.EDIT,L=U.DELETE,E=U.RENAME,I=U.DUPLICATE,N=U.CATALOG_SQL,H=U.SET_AS_PRIMARY,F=U.IS_PRIMARY,Q=U.SHARE,A=mstrmojo.desc(1088,"Edit"),B=mstrmojo.desc(629,"Delete"),J=mstrmojo.desc(1388,"Rename"),S=mstrmojo.desc(3397,"Duplicate"),C=mstrmojo.desc(15173,"Edit Catalog Options"),V=mstrmojo.desc(11425,"Set as Primary"),K=mstrmojo.desc(4572,"Primary");function D(Y,X){var W;switch(Y.action){case E:W=parseInt(X.writable,10);break;case Q:W=parseInt(X.controllable,10);break;case L:W=parseInt(X.deletable,10);break;default:W=true;}return !!W;}mstrmojo.warehouse.menu.DBConnectionsMenu=mstrmojo.declare(mstrmojo.architect.menu.ArchitectMenu,null,{scriptClass:"mstrmojo.architect.menu.DBConnectionsMenu",cm:[{action:G,n:A,icn:"edt"},{action:L,n:B,icn:"del"},{action:E,n:J,icn:"rnm"},{action:Q,n:mstrmojo.desc(9099,"Share")},{action:I,n:S},{action:H,n:V},{action:M},{action:F,n:K},{action:M},{action:N,n:C,icn:"catsql"}],isManaged:undefined,readable:"1",writable:"1",controllable:"1",deletable:"1",postCreate:function(){var W=this;if(!O.isOnetier()){W.cm=R.filter(W.cm,function(X){return D(X,W);});}W.cm=R.map(W.cm,function(X){if(W.isManagedDBR){if(X.action===I){return{action:I,n:S,isManaged:true};}else{if(X.action===Q){return{action:Q,n:mstrmojo.desc(9099,"Share"),isManaged:true};}}}if(X.action===N){return{action:N,n:C,readable:parseInt(W.readable,10)};}return X;});},executeCommand:function P(X){var Y=this.data,W=mstrApp.getRootController();switch(X.action){case G:W.editDBRole(Y);break;case E:W.renameDBRole(Y);break;case L:W.deleteDBRole(Y);break;case I:W.duplicateDBRole(Y);break;case H:W.setProjectPrimaryDBRole(Y);break;case N:W.model.SelDBRoleID=Y.did;W.displayCatalogSQL(Y.did);break;case Q:if(O.isServerBasedWS()){var Z={taskId:"openNativeWindow",did:Y.did,windowType:2};mstrApp.serverRequest(Z,{},false);}else{if(W.shareDBRole){W.shareDBRole(Y);}}break;}}});}());(function(){mstrmojo.requiresCls("mstrmojo.Obj","mstrmojo.architect.menu.ArchitectMenu");mstrmojo.requiresDescs(11411,11424,11417);var D=mstrmojo.architect.menu.EnumMenuActions,E=mstrmojo.desc(11411,"Sample Data"),A=mstrmojo.desc(11424,"Add to Project"),C=mstrmojo.desc(11417,"Update Structure");mstrmojo.warehouse.menu.AvailableTablesMenu=mstrmojo.declare(mstrmojo.architect.menu.ArchitectMenu,null,{scriptClass:"mstrmojo.architect.menu.AvailableTablesMenu",cm:[{action:D.ADD_TO_PROJECT,n:A},{action:D.UPSTRUCT,n:C},{action:D.NONE},{action:D.SAMPLE_DATA,n:E,icn:"smpl"}],executeCommand:function B(G){var H=this.data,F=mstrApp.getRootController();switch(G.action){case D.UPSTRUCT:F.getColumnsForDBTables({tables:[].concat(H),getFresh:true},{});break;case D.ADD_TO_PROJECT:F.addTables([].concat(H));break;case D.SAMPLE_DATA:F.showSampleData(H);break;}}});}());(function(){mstrmojo.requiresCls("mstrmojo.Box","mstrmojo.warehouse.dbroles.DBRoleHelper","mstrmojo.warehouse.dbroles.DBRoleSetting","mstrmojo.warehouse.dbroles.DBRoleSettingCheckbox","mstrmojo.warehouse.dbroles.DBRoleSettingConnectionStringEditor","mstrmojo.warehouse.dbroles.DBRoleSettingFileSelector","mstrmojo.warehouse.dbroles.DBRoleSettingGroupBox","mstrmojo.warehouse.dbroles.DBRoleSettingPulldown","mstrmojo.warehouse.dbroles.DBRoleSettingRadioButton","mstrmojo.DI.DIHelpers","mstrmojo.ui.Pulldown");mstrmojo.requiresDescs(14910,15,260,512,689,1034,2523,3332,3989,7790,7952,8517,8518,8519,8521,8522,8523,8524,8526,8528,8529,8530,8532,8533,8534,8536,8538,8539,8540,8546,8547,8548,8549,8550,8560,10055,10058,10059,10061,10064,10065,11392,11394,12308,12309,12310,12312,12313,12542,12752,12758,12997,13100,13101,13103,13104,13105,13106,13107,13108,13109,13110,13111,13112,13113,13114,13115,13116,13117,13118,13119,13121,13122,13123,13124,13125,13126,13234,13373,13531,13532,13533,13540,13541,13904,13905,13906,13907,13908,13909,13910,13944,13945,13946,13947,13948,13949,13950,13951,13952,13962,13979,13980,13981,13982,13990,14002,14005,14620,14621,14641,14685,14686,14687,14906,15618,10198,15662,15663,15664,5166,15256,15257,15337,15914,15167,15168,16149,16150,16151,16152);var j=mstrmojo.array,c=mstrmojo.hash,O=mstrmojo.string,w=mstrmojo.DI.DIHelpers,h="hideUnavailableDrivers",N="FULLCONNECTION",m,E=mstrmojo.warehouse.dbroles.DBRoleHelper,u=mstrmojo.DI.DIConstants,t=mstrmojo.desc(8538,"Database:"),V=mstrmojo.desc(2523,"Version:"),I=mstrmojo.desc(13540,"Show databases whose certified drivers were not found"),l=mstrmojo.desc(14910,"Include databases whose certified drivers were not found"),f=mstrmojo.desc(13990,"Show databases which are not certified for the DSN’s driver"),Q=mstrmojo.desc(13234,"Add driver"),k=mstrmojo.desc(11392,"Missing parameters"),o=" ("+mstrmojo.desc(13541,"Certified driver not found")+")",G=mstrmojo.desc(11394,"The ODBC driver used by this database connection is currently not installed, until that happens this connection may not work"),D=mstrmojo.desc(14002,"The JDBC driver used by this database connection is currently not installed, until that happens this connection may not work"),n=mstrmojo.desc(8526,"select a dsn"),AB=mstrmojo.desc(15951,"Only show databases with certified drivers"),J=mstrmojo.desc(16014,"No Available DSN");POSTGRESQL_ODBC_DRIVER="MicroStrategy ODBC Driver for PostgreSQL Wire Protocol";function AA(AI,AV,AY){var AW,AL="";if(this.isDSNLess){var AH={},AX,AM=this.contents.children,Ab=1;if(AY===undefined){var Aa=this.dbIDSelectList.selectedItem,AN=Aa.dbVersions[j.find(Aa.dbVersions,"v",this.dbmsList.selectedItem.db_ver)],AR=AN.connections[this.selectedSection]||AN.connections[0],AT=[AR].concat(AN.altconnections),AO=E.driverExists.call(this,AT);if(AO.exists){AX=AT[AO.idx].str;}else{if(AN.altconnections.length>0){if(Aa.n==="Impala"&&this.selectedSection===1){AX=AN.altconnections[2].str;}else{AX=AR.str;}}else{AX=AR.str;AL=G;if(AX.indexOf("JDBC;")>=0){AL=D;}}}}else{AX=AY;}j.forEach(AM,function(Ad){if(Ad.alias!="showLabel"){var Ac=Ad.getValue();if(Ad.field){if(typeof Ac==="string"){AH[Ad.field]=O.trim(Ac);}else{AH[Ad.field]=Ac;}}if((!!Ac)&&Ad.driverMode){Ab=Ad.driverMode;}}});this.driverMode=Ab;AW=AX.replace(/@([\w\d]+)/gm,function AQ(Ac,Ad){return(AH.hasOwnProperty(Ad)&&AH[Ad]!==null)?AH[Ad]:"";});if(AV){var AJ="=;",AU,AS,AP,AZ=/[\s\x28\x29\x3B]/g,AK=0;do{AU=AW.indexOf(AJ,AK);AK=AU+AJ.length;if(AU>-1){AS=AW.substring(0,AU);while(AZ.test(AS)){AU=AZ.lastIndex;}AP=AS.substring(AU);if(AP.indexOf("=")<0){AW=AW.replace(AP+AJ,"");}}}while(AW.indexOf(AJ,AK)>0);}}else{AW="DSN="+this.dsnBox.dsnList.selectedItem.n+";";}if(AI){AW=E.cleanDSNConnection(AW);}return{str:AW,err:AL};}function U(AK){var AJ={},AH=AK.split(";"),AI=[];j.forEach(AH,function(AL){AI=AL.split("=");if(AI[0]!==""){AJ[AI[0]]=AI[1];}});return AJ;}function C(AH,AM){var AL,AK,AI=[],AJ={};j.forEach(c.keyarray(AM),function(AN){AL=AM[AN];if(AN){AJ[AN]=AN+"="+AL;}else{j.forEach(c.keyarray(AJ),function(AO){AI.push(AO);});j.forEach(AI,function(AO){AK=false;j.forEach(AH.parent.children,function(AP){if(AP.propfield===AO){AK=true;return !AK;}});if(!AK){delete AJ[AO];}});AJ[AN]=AL;}});return c.valarray(AJ).join(";");}function z(AK,AN,AI){var AM,AJ;if(AK.field){AM=AN[AK.field];}else{if(AK.propset){AJ=AI[AK.propset][AK.prop];if(AK.propformat==="json"){AM=JSON.parse(AJ||"{}")[AK.propfield];}else{if((AK.propformat==="text")){if(AK.propfield){AM=(U(AJ||"")[AK.propfield]);}else{var AH=U(AJ||"");j.forEach(AK.parent.children,function(AO){if(AO.propfield){delete AH[AO.propfield];}});var AL=[];j.forEach(c.keyarray(AH),function(AO){AL.push(AO+"="+AH[AO]);});AM=AL.join(";");}}else{AM=AJ;}}}else{j.forEach(AK.children,function(AO){z(AO,AN,AI);});}}if(AM){AK.setValue(AM);}}function b(AM,AI){var AN,AL,AJ,AH={},AK={};if(AM.propset){AN=AM.getValue();if(typeof AN==="string"){AL=O.trim(AN).replace(/\\/g,"\\\\");}else{AL=AN;}AJ=AI[AM.propset][AM.prop];if(AM.propformat==="json"){AK=JSON.parse(AJ||"{}");AK[AM.propfield]=AL;AI[AM.propset][AM.prop]=JSON.stringify(AK).replace(/\\"/g,'"');}else{if((AM.propformat==="text")){AH=U(AJ||"");AH[AM.propfield]=AL;AI[AM.propset][AM.prop]=C(AM,AH);}else{AI[AM.propset][AM.prop]=AL;}}}else{j.forEach(AM.children,function(AO){b(AO,AI);});}}function S(AN){if(this.info.connstr){var AM=this.contents;var AJ=this.info.connstr.split(";")[0],AI=(AJ.split("=")[0]).toUpperCase();switch(AI){case"DSN":AM=this.dsnBox;AJ=AJ.substring(AI.length+1,AJ.length);AM.dsnList.set("selectedID",AJ.toUpperCase());break;default:AJ=E.cleanLoadedDSNConnection(this.info.connstr,AN.dbID);var AO=this.supportedDBs[j.find(this.supportedDBs,"id",AN.dbID)],AH=AO.dbVersions[j.find(AO.dbVersions,"v",AN.dbver)],AP=AH.connections.concat(AH.altconnections);var AK=E.extractParams(AP,AJ);AK.supportHttpsURL=AJ.indexOf("Protocol=HTTPS")>-1;var AL=this.info.vldbProperties;j.forEach(AM.children,function(AQ){z(AQ,AK,AL);});if(AN.dbver===-1||E.isCustomConnection(AJ)||mstrApp.rootController.getObjectCount(AK)<=AH.DBPS.length||AK.noDriverMatched){AM.stringEditor.setValue(AJ);}}}}function AE(){var AL,AQ;if(this.info.connstr){var AT=E.cleanDriver(this.info.connstr),AP=E.isCustomConnection(this.info.connstr),AH=(AT.split("=")[0]).toUpperCase(),AO=this.dbObjects.dbms,AJ=AO[j.find(AO,"did",this.info.dbms)],AR,AM=function AI(AV,AU){j.forEach(AV,function(AX,AW){if(AJ.db_ver===AX.v){AR=AX.connections.concat(AX.altconnections);if(AT!==""&&!AP){if(j.find(AR,"driver",AT)>=0){AL={dbver:AX.v,dbID:AU};}}else{AL={dbver:AX.v,dbID:AU};}}else{if((AV.length-1)===AW){AQ={dbver:AX.v,dbID:AU};}}if(AL){return false;}return true;});};switch(AH){case"DSN":AL={dbver:AJ.db_ver,dbID:this.dbIDs.Undefined};break;default:var AK=parseInt(this.info.ab,10),AN,AS;if(isNaN(AK)){AN=j.find(this.supportedDBs,"dbType",this.info.db_type);}else{if(AK>=0){AN=j.find(this.supportedDBs,"id",AK);}}if(AN>=0){AS=this.supportedDBs[AN];AM(AS.dbVersions,AS.id);}if(!AL&&!!AQ){AL=AQ;}if(!AL){j.forEach(this.supportedDBs,function(AU){AM(AU.dbVersions,AU.id);if(AL){return false;}return true;});}if(!AL){AP=true;j.forEach(this.supportedDBs,function(AU){AM(AU.dbVersions,AU.id);if(AL){return false;}return true;});}break;}}if(!AL){AL={dbID:-1};}return AL;}function R(AK,AJ,AI,AH){var AN=this,AM=[],AO,AL;AL=new mstrmojo.warehouse.dbroles.DBRoleSettingGroupBox({alias:AK.alias+"groupBox"});AN.contents.addChildren([AL]);j.forEach(AJ,function(AP){if(AP.group===AI){AO=c.clone(AP);delete AO.group;AM.push(AO);}});AH.call(AN,AM,AL.alias,AL);if(AK.oncheckedChange){AK.checked=true;AK.set("checked",false);}}function AG(AN,AJ,AI){var AL=this,AH=AL.parent.parent,AK=[];j.forEach(AN,function(AO){if(!!(AO.group)){AK.push(AO);}});var AM;j.forEach(AN,function(AV,AW){AM=false;if(mstrApp.isSingleTier){if((AV.scope&2)===2){AM=true;}}else{if((AV.scope&1)===1){AM=true;}}if(!AM){return ;}var AY,AX=mstrmojo.desc(AV.IDS,AV.n),AR="dbp_"+AV.field,AU=(AV.isgroup===1);if(AX&&AX[AX.length-1]!==":"){AX+=":";}if(AV.group){return true;}switch(AV.tp){case"hadoopdropdown":AY=new mstrmojo.warehouse.dbroles.DBRoleSetting({caption:AX,alias:AR,isRequired:AV.req,onEnter:AL.onEnterFn,mode:1,items:[{n:"None",v:"0"},{n:"AD Kerberos",v:"1"},{n:"User delegation",v:"2"}]});break;case"hadooptext":AY=new mstrmojo.warehouse.dbroles.DBRoleSetting({caption:AX,alias:AR,isRequired:AV.req,onEnter:AL.onEnterFn,onvalueChange:function AP(){if(this.parent&&this.parent.stringEditor){this.parent.stringEditor.updateString();}}});AY.disableTextbox();if(parseInt(AV.IDS,10)===7952){if(AH.AuthMode!==undefined){AY.set("text",AL.parent.parent.AuthMode==0?"Anonymous":"Shared_Kerberos");}}break;case"hadoopnumber":AY=new mstrmojo.warehouse.dbroles.DBRoleSetting({caption:AX,alias:AR,isNumeric:true,isRequired:AV.req,onEnter:AL.onEnterFn,onvalueChange:function AP(){if(this.parent&&this.parent.stringEditor){this.parent.stringEditor.updateString();}}});AY.disableTextbox();break;case"text":case"token":AY=new mstrmojo.warehouse.dbroles.DBRoleSetting({caption:AX,alias:AR,isRequired:AV.req,onEnter:AL.onEnterFn,onvalueChange:function AP(){if(this.parent&&this.parent.stringEditor){this.parent.stringEditor.updateString();}}});break;case"number":AY=new mstrmojo.warehouse.dbroles.DBRoleSetting({caption:AX,alias:AR,isNumeric:true,isRequired:AV.req,onEnter:AL.onEnterFn,onvalueChange:function AP(){if(this.parent&&this.parent.stringEditor){this.parent.stringEditor.updateString();}}});break;case"list":var AT="v",AO=AV.options;if((!AO||!AO.length)&&AH.listOptions){AO=AL.parent.parent.listOptions[parseInt(AV.IDS,10)];AO=c.clone(AO);}if(AO[0].n){AT="n";j.forEach(AO,function(AZ){AZ.n=mstrmojo.desc(AZ.IDS,AZ.n);});}else{j.forEach(AO,function(AZ){AZ.n=AZ.v;});}AY=new mstrmojo.warehouse.dbroles.DBRoleSettingPulldown({caption:AX,alias:AR,itemIdField:"v",itemField:AT,onChange:function AS(){if(this.parent&&this.parent.stringEditor){this.parent.stringEditor.updateString();}}});if(parseInt(AV.IDS,10)===7952){AY.onChange=function AS(){if(this.parent&&this.parent.parent){if((this.selectedItem&&parseInt(this.selectedItem.IDS,10)===13981)){this.parent.parent.updateLoginFn(false);}else{this.parent.parent.updateLoginFn(true);}}if(this.parent&&this.parent.stringEditor){this.parent.stringEditor.updateString();}};}if(parseInt(AV.IDS,10)===14956){AY.onChange=function(){if(this.parent){var AZ=this.selectedItem;this.parent.dbp_hnn.setValue(AZ.data.config.namenodeAddr);this.parent.dbp_supportHttpsURL.setValue(AZ.data.config.supportHttpsURL);this.parent.dbp_hp.setValue(AZ.data.config.hdfsRpcPort);this.parent.dbp_wp.setValue(AZ.data.config.hdfsHttpPort);this.parent.dbp_host.setValue(AZ.data.config.hostAddr);this.parent.dbp_bdep.setValue(AZ.data.config.tcpPort);if(!AZ.data.config.sparkConfig.props||AZ.data.config.sparkConfig.props.AuthMode=="0"){this.parent.dbp_auth.setValue("Anonymous");}else{this.parent.dbp_auth.setValue("SHARED_KERBEROS");}}};}AY.render();AY.set("items",AO);if(AL.parent.parent.oldIndex){AY.set("selectedID",AO[AL.parent.parent.oldIndex].v);}break;case"boolean":if(AH.isHadoopGateWay&&AV.n==="SupportHttpsURL"){AY=new mstrmojo.Box({alias:AR,cssClass:"mstrmojo-Box mstrmojo-wh-DBRoleSetting",getValue:function(){return this.protocol.domNode.firstChild.innerText;},setValue:function(AZ){this.protocol.domNode.firstChild.innerText=this.protocol.text=AZ?"HTTPS":"HTTP";},isValid:function(){return true;},children:[{scriptClass:"mstrmojo.Label",cssClass:"mstrmojo-wh-DBRoleSetting-Label",text:mstrmojo.desc(15109,"Protocol:")},{alias:"protocol",scriptClass:"mstrmojo.Label",cssClass:"mstrmojo-wh-DBRoleSetting-Info",cssText:"line-height: 25px;",allowHTML:true,text:'<label style="padding-left:6px">'+(this["supportHttpsURL"]?"HTTPS":"HTTP")+"</label>"}]});}else{AY=new mstrmojo.warehouse.dbroles.DBRoleSettingCheckbox({label:AX,alias:AR,isGroup:AU,isNumeric:(AV.stp&&(AV.stp==="numeric")),driverMode:1,helpLink:AV.help,driverModeChecked:AV.driverMode||1,display:AV.display,oncheckedChange:function AQ(){if(this.parent.stringEditor){this.parent.stringEditor.updateString();}this.driverMode=(this.checked?this.driverModeChecked:1);if(!this.isGroup){return ;}var AZ=(this.checked&&(this.display==="onChecked"))||(!this.checked&&(this.display==="onUnChecked"));this.parent[this.alias+"groupBox"].set("visible",AZ);}});}break;case"file":AY=new mstrmojo.warehouse.dbroles.DBRoleSettingFileSelector({caption:AX,alias:AR,isRequired:AV.req,selectorOption:AV.selectorOption,onEnter:AL.onEnterFn,onvalueChange:function AP(){if(this.parent&&this.parent.stringEditor){this.parent.stringEditor.updateString();}}});break;case"label":AY={scriptClass:"mstrmojo.Label",cssClass:"mstrmojo-wh-DBRoleConnection-ShowConnection",alias:"showLabel",text:mstrmojo.desc(14906,"Manage Hadoop Gate"),bindings:{visible:function(){return false;}}};if(AH.labelClickFn){AY.onclick=AH.labelClickFn[parseInt(AV.IDS,10)]||mstrmojo.emptyFn;}break;}AY.field=AV.field;AY.parentRBAlias=AJ;AY.propset=AV.propset;AY.prop=AV.prop;AY.propformat=AV.propformat;AY.propfield=AV.propfield;if(AV.defaultValue){AY.setValue(AV.defaultValue);}AI.addChildren([AY]);if(AU){R.call(AL,AY,AK,AV.groupid,AG);}});}function X(AJ,AI,AH){return new mstrmojo.warehouse.dbroles.DBRoleSettingRadioButton({label:mstrmojo.desc(AJ.IDS,AJ.n),index:AI,alias:"RB"+AI,count:AH,field:"RB"+(AI+1),onclick:function AK(){var AM;if(this.checked){for(AM=0;AM<this.count;AM++){this.parent["RB"+AM].set("checked",false);this.parent["RB"+AM].enableChildren();}this.set("checked",true);this.enableChildren();}},oncheckedChange:function AL(){if(this.checked){this.parent.parent.selectedSection=this.index;}}});}function x(){if(!this.isDSNLess){return ;}var AL=this.contents,AO,AJ,AM=this;if(!AL){return ;}if(AL.children){AL.removeChildren(null,true);}if(!this.dbmsList.selectedItem){return ;}AO=this.dbIDSelectList.selectedItem||this.dbIDSelectList.items[0];var AH=AO.dbVersions[j.find(AO.dbVersions,"v",this.dbmsList.selectedItem.db_ver)];if(!AH){return ;}if(!E.driverExists.call(this,AH.connections).exists&&(AH.altDBPS.length>0)){AJ=AH.altDBPS;}else{AJ=AH.DBPS;}if(AJ&&AJ.length>1){var AK=AJ.length;j.forEach(AJ,function(AR,AQ){if(AR.defaultSection){AM.selectedSection=AQ;}var AS=X(AR,AQ,AK);AL.addChildren([AS]);AG.call(AM,AR.DBP,AS.alias,AM.contents);});AL["RB"+AM.selectedSection].checked=true;AL["RB"+AM.selectedSection].onclick();}else{AG.call(AM,AJ[0].DBP,"",AM.contents);}var AP=new mstrmojo.warehouse.dbroles.DBRoleSettingConnectionStringEditor({alias:"stringEditor",drivers:AM.drivers,dbIDVersions:this.dbIDSelectList.items,info:AM.info,dbID:AM.dbIDSelectList.selectedItem,dbms:AM.dbmsList.selectedItem,enableFn:function AN(AR){var AS=this.parent.parent,AQ=AS.contents["RB"+AS.selectedSection];j.forEach(AL.children,function(AT){if(!AT.isGroupSetting&&!AT.isGroup){AT.set("enabled",AR);}});if(AR&&AQ){AQ.setValue(true);}},generateConnectionStringFn:function AI(AQ){return AA.call(AM,false,false,AQ).str.replace(N+"=","");}});AL.addChildren([AP]);}function AD(AI){var AH=this.dbObjects.dbms;return AH[j.find(AH,"db_ver",AI)];}function H(){var AQ=this,AM=false,AP=this.dbObjects.supportedDBs,AR=this.dbIdFilter||[],AS=this.dbIdExcludeFilter||[],AL=[],AK,AO=(mstrApp.isSingleTier&&(navigator.platform.indexOf("Win")===-1)),AN=(mstrApp.isSingleTier&&(navigator.platform.indexOf("Win")!==-1)),AI=(mstrApp.isSingleTier&&window.FormWrapper.isWin32&&window.FormWrapper.isWin32()),AJ=function AJ(AU){if(AO){var AV=c.clone(AU);AV.n=O.trim(AU.n.replace("(JDBC)",""));return AV;}if(AN){var AT=c.clone(AU);AT.n=O.trim(AU.n.replace("(32 bit)",""));return AT;}return AU;},AH=[6800,5300,5600,6600,7000];j.forEach(AP,function(AT){AM=false;if(mstrApp.isSingleTier&&AO&&AT.dbType===100){return true;}if(mstrApp.isSingleTier){if(j.indexOf(AH,AT.dbType)!==-1){return true;}}j.forEach(AT.dbVersions,function(AU){if(AU.dsnless){if(!AQ.showUnavailable){j.forEach(AU.connections.concat(AU.altconnections),function(AV){if(E.driverAvailable.call(AQ,AV)){AM=true;}return !AM;});}else{AM=true;}return !AM;}return !AM;});if(AM){AK=false;j.forEach(AS,function(AU){if(AU===AT.id){AK=true;return false;}});if(!AK){if(AR.length>0){j.forEach(AR,function(AU){if(AU===AT.id){AL.push(AJ(AT));}});}else{AL.push(AJ(AT));}}}});if(w.getEnvObj().isAppSchema()){AL=j.filter(AL,function(AT){return w.filterDisableSources(AT.dbType);});}this.dbIDSelectList.set("items",AL);if(AL.length===0&&!AQ.showUnavailable){AQ.showUnavailable=true;this.driverBox.hideUnavailable.setValue(false);}}function AC(AK,AJ){var AP=this.dbObjects.dbms,AR=this.dbmsList;if(AK.length===0){var AH,AL=this.dbObjects.dsndbms,AM={};if(this.cfgDbmsTypeExcludeFilter&&this.cfgDbmsTypeExcludeFilter.length>0){j.forEach(this.cfgDbmsTypeExcludeFilter,function(AT){AM[AT]=true;});AL=j.filter(this.dbObjects.dsndbms,function(AT){return !AM[AT.db_type];});}AH=c.cloneArray(AL);var AS=[];j.forEach(AJ,function(AU){if(AU.v>-1){var AT=j.find(AH,"db_ver",AU.v);if(AT>=0&&AS.indexOf(AT)<0){AH[AT].n+=" (Certified for DSN)";AS.push(AT);}}});AR.set("items",AH);}else{var AN={},AQ=this;j.forEach(AP,function(AT){AT.enabled=true;if(!(AK.length===1&&AK[0].v===-1)){if((AT.db_type===AQ.dbTypes.Generic.v)||(AT.db_ver===-1)){if(!AQ.alwaysShowGeneric){return true;}}}j.forEach(AK,function(AX){if(AT.db_ver===AX.v){if((AX.dsnless&&AQ.isDSNLess)||(!AQ.isDSNLess)){var AV=AX.connections.concat(AX.altconnections);if(!AQ.showUnavailable){j.forEach(AV,function(AY){if(E.driverAvailable.call(AQ,AY)){AN[AT.did]=AT;}return true;});}else{var AU=false;j.forEach(AV,function(AY){if(E.driverAvailable.call(AQ,AY)){AU=true;}return !AU;});if(AU){AT.title=(AT.n.length>50)?AT.n:"";AN[AT.did]=AT;}else{var AW=mstrmojo.hash.clone(AT);AW.n=AW.n+o;AT.enabled=false;AW.title=(AW.n.length>50)?AW.n:"";AN[AW.did]=AW;}}}}});});if(mstrApp.rootController.getObjectCount(AN)===0){var AI=AD.call(this,-1);if(AI){AN[AI.did]=AI;}}if(AK.length===1&&AK[0].v===-1){mstrmojo.hash.forEach(AN,function(AV,AU,AT){if(AV.db_type!==AQ.dbTypes.Generic.v){delete AT[AU];}});AR.set("items",mstrmojo.hash.valarray(AN));}else{AR.set("items",mstrmojo.hash.valarray(AN));}}var AO=AR.items;if(AO.length>0){if(this.info&&this.info.dbms){AR.set("selectedID",this.info.dbms);}else{if(AR.selectedItem&&(j.find(AO,"did",AR.selectedItem.did)>-1)){AR.set("selectedID",AR.selectedItem.did);}else{AR.set("selectedID",AO[0].did);}}AR.onChange();}else{AR.set("selectedID","");}}function a(){var AQ=this,AR={n:n,nU:n.toUpperCase(),des:0},AJ={n:J,nU:n.toUpperCase(),des:0};var AP={},AO=AQ.dbObjects.dsns,AI=[];AP[AR.nU]=AR;if(AQ.dbIdFilter.length===1){j.forEach(AQ.supportedDBs,function(AS){j.forEach(AS.dbVersions,function(AT){j.forEach(AT.connections.concat(AT.altconnections),function(AU){j.forEach(AO,function(AV){if(AU.driver===AV.des){AP[AV.nU]=AV;}return true;});});});});AI=c.cloneArray(c.valarray(AP));}else{AI=c.cloneArray(AQ.dbObjects.dsns);}var AH={};if(AQ.dsnDbTypeExcludeFilter&&AQ.dsnDbTypeExcludeFilter.length>0){j.forEach(AQ.dsnDbTypeExcludeFilter,function(AS){j.forEach(AQ.dsnMapDBs,function(AT){if(AT.dbType===AS){j.forEach(AT.dbVersions,function(AU){j.forEach(AU.connections.concat(AU.altconnections),function(AV){j.forEach(AI,function(AW){if(AV.driver===AW.des){AH[AW.nU]=AW;}return true;});});});}});});var AL,AN,AK=c.valarray(AH),AM=AK.length;for(AL=0;AL<AM;AL++){AN=j.find(AI,"nU",AK[AL].nU);if(AN>=0){AI.splice(AN,1);}}}AI.splice(0,1,AI.length>1?AR:AJ);this.dsnBox.dsnList.list.set("enabled",AI.length>1);this.dsnBox.dsnList.set("items",AI);this.onisDSNLessChange();}mstrmojo.warehouse.dbroles.DBRoleDSNConnection=mstrmojo.declare(mstrmojo.Box,null,{scriptClass:"mstrmojo.warehouse.dbroles.DBRoleDSNConnection",cssClass:"mstrmojo-wh-DBRoleDSNConnection",postCreate:function e(){var AH=mstrApp.rootController.getDBObjects();this.dbObjects=AH;this.dbTypes=AH.dbTypes;this.dbIDs=AH.dbIDs;this.dbVersions=AH.dbVersions;this.supportedDBs=AH.supportedDBs;this.dsnMapDBs=AH.dsnMapDBs;this.drivers=AH.drivers;this.preferences=AH.preferences;},onEnterFn:mstrmojo.emptyFn,info:undefined,oninfoChange:function L(){var AJ=this.info.connstr;if(AJ&&(AJ.substring(0,1)===";")){this.info.connstr=this.info.connstr.replace(";","");}H.call(this);var AH=AE.call(this);var AI=window.localStorage,AK=(AI&&AI.getItem(h));this.driverBox.hideUnavailable.setValue((AK?(AK==="1"):false));if((mstrApp.rootController.getObjectCount(this.info)>0)&&(this.info.did!=="")&&(j.find(this.dbIDSelectList.items,"id",AH.dbID)<0)){this.driverBox.hideUnavailable.setValue(false);}if(this.isDSNLess){this.dbIDSelectList.selectedItem=null;this.dbIDSelectList.set("selectedID",AH.dbID);this.dbmsList.set("selectedID",this.info.dbms);}else{if(this.info.n){a.call(this);}}S.call(this,AH);this.driverBox.hideUnavailable.set("visible",!this.hideDriverCheck);},selectedSection:0,isDSNLess:undefined,dbIdFilter:[],dbIdExcludeFilter:[],dsnDbTypeExcludeFilter:[],driverMode:1,singleType:false,onisDSNLessChange:function M(){var AN=this.dbIDSelectList,AK=this.dsnBox,AM=AK.dsnList,AH=this.info&&this.info.connstr,AJ,AL,AI;if(this.isDSNLess){AN.set("selectedItem",null);AN.set("selectedID",this.supportedDBs[0].id);this.driverBox.hideUnavailable.set("label",AB);}else{if(!(AM.items&&AM.items.length>0)){a.call(this);}if(AH){AJ=AH.split(";")[0];AL=(AJ.split("=")[0]).toUpperCase();if(AL==="DSN"){AJ=AJ.substring(AL.length+1,AJ.length);AI=AJ.toUpperCase();}}if(AI===undefined){AI=AM.items[0].nU;}AM.set("selectedID",AI);AM.onChange();this.driverBox.hideUnavailable.set("label",AB);}AN.set("visible",this.isDSNLess&&!this.singleType);this.contents.set("visible",this.isDSNLess);AK.set("visible",!this.isDSNLess);this.updateLoginFn(true);this.dbmsList.list.set("enabled",this.isDSNLess?true:this.dsnBox.dsnList.list.enabled);},dsnBox:undefined,dsnList:undefined,dbIDSelectList:undefined,dbmsList:undefined,contents:undefined,hideUnavailable:undefined,hideDriverCheck:false,onhideDriverCheckChange:function g(){this.driverBox.hideUnavailable.set("visible",!this.hideDriverCheck);},driverBox:undefined,addDriver:undefined,showAddDriver:false,showConnectionString:false,Hive:undefined,db_ver:undefined,DBP:undefined,DBPS:undefined,altDBPS:undefined,IDS:undefined,connections:undefined,altconnections:undefined,dsnless:undefined,Undefined:undefined,isgroup:undefined,groupid:undefined,showUnavailable:true,alwaysShowGeneric:false,children:[{scriptClass:"mstrmojo.Box",alias:"driverBox",children:[{scriptClass:"mstrmojo.warehouse.dbroles.DBRoleSettingCheckbox",alias:"hideUnavailable",label:l,oncheckedChange:function Z(){var AK=window.localStorage;if(AK){AK.setItem(h,this.checked?"1":"0");}var AJ=this.parent.parent,AH,AI;if(AJ.dbIDSelectList.items){AH=AJ.dbIDSelectList.selectedID;}if(AJ.dbmsList.items){AI=AJ.dbmsList.selectedID;}AJ.showUnavailable=(!this.checked);if(AJ.isDSNLess){H.call(AJ);if(AJ.dbIDSelectList.hasRendered){if(!!(AJ.dbIDSelectList.items.length)&&((!AH)||(j.find(AJ.dbIDSelectList.items,"id",AH)<0))){AH=AJ.dbIDSelectList.items[0].id;AJ.dbIDSelectList.set("selectedID",AH);}else{AJ.dbIDSelectList.set("selectedID",AH);}}}else{if(this.parent.parent.hasRendered){this.parent.parent.dsnBox.dsnList.onChange();}}if(AJ.dbmsList.hasRendered){if(((!AI)||(j.find(AJ.dbmsList.items,"did",AI)<0))&&(AJ.dbmsList.items&&AJ.dbmsList.items[0])){AI=AJ.dbmsList.items[0].id;AJ.dbmsList.set("selectedID",AI);}}}}]},{scriptClass:"mstrmojo.Table",rows:1,cols:2,alias:"dsnBox",postCreate:function e(){this.cssClass="mstrmojo-wh-DSNConnection-Box "+((mstrApp.isSingleTier&&navigator.platform.indexOf("Win")!==-1)?"one-tier-win":"");},layout:[{cells:[{cssClass:"mstrmojo-wh-DSNConnection-Box-list"},{cssClass:"mstrmojo-wh-DSNConnection-Box-btn"}]}],children:[{scriptClass:"mstrmojo.warehouse.dbroles.DBRoleSettingPulldown",slot:"0,0",caption:mstrmojo.desc(8559,"DSN")+":",alias:"dsnList",itemIdField:"nU",allowHTML:false,onChange:function Y(){var AJ=this.parent.parent,AI=AJ.dsnBox.dsnList.selectedItem,AH=[];if(AI){j.forEach(AJ.supportedDBs,function(AK){j.forEach(AK.dbVersions,function(AL){j.forEach(AL.connections.concat(AL.altconnections),function(AM){if(AM.driver===AI.des){AH.push(AL);return false;}return true;});});});}if(AJ.showUnavailable){AC.call(AJ,[],AH);}else{AC.call(AJ,AH);}}},{scriptClass:"mstrmojo.Button",slot:"0,1",onclick:function r(){var AH=this.parent.parent.parent.parent.buttonsbox.buttonCancel;if(AH){AH.onclick();}mstrApp.getRootController().getDataService().submitRequest({},{taskId:"openODBCAdmin"});}}]},{scriptClass:"mstrmojo.warehouse.dbroles.DBRoleSettingPulldown",alias:"dbIDSelectList",itemIdField:"id",caption:t,bindings:{visible:function(){return !this.parent.singleType;}},onChange:function Y(AH){var AI=this.parent,AJ;if(AH){AJ=AH.id;AC.call(AI,AI.supportedDBs[j.find(AI.supportedDBs,"id",AJ)].dbVersions);this.set("selectedID",AJ);if((AH.connType&4)!==4){AI.addDriver.set("visible",AI.showAddDriver);}if(AI.isDSNLess){x.call(AI);}AI.updateLoginFn(AH.stdLogin!==0);}}},{scriptClass:"mstrmojo.warehouse.dbroles.DBRoleSettingPulldown",alias:"dbmsList",itemIdField:"did",caption:V,bindings:{visible:function(){return !this.parent.singleType;}},onChange:function Y(){var AH=this.parent;if(AH.isDSNLess&&AH.dbIDSelectList.selectedItem){AH.updateLoginFn(AH.dbIDSelectList.selectedItem.stdLogin!==0);}this.selectedID=this.selectedItem.did;if(this.items.length===1){this.selectedID=0;}if(AH.onDBMSSelectFn){AH.onDBMSSelectFn(this.selectedItem);}}},{scriptClass:"mstrmojo.Label",cssClass:"mstrmojo-wh-DBRoleConnection-AddDriver",visible:false,alias:"addDriver",text:Q,onclick:function r(){m=this.parent;mstrApp.rootController.launchOneTierFileBrowser("mstrmojo.warehouse.dbroles.DBRoleDSNConnection.oneTierFileUploader");}},{scriptClass:"mstrmojo.Box",alias:"contents",cssClass:"mstrmojo-wh-DBRoleConnection-Box"}],dbObjects:{},dbVersions:[],dbTypes:[],preferences:{},dbIDs:{},supportedDBs:[],dsnMapDBs:[],drivers:[],getConnectionStr:function P(){if(this.isDSNLess){var AH=this.contents.stringEditor;if(AH.visibleContents&&AH.enabledContents){return{str:AH.getValue(),err:""};}}return AA.call(this,true,true,undefined);},getVLDBProperties:function B(AH){if(this.isDSNLess&&AH){j.forEach(this.contents.children,function(AI){if(!(AI.field)){b(AI,AH);}});}},isValidInput:function F(){var AH=this.contents.children,AI={val:false,msg:k};if(this.isDSNLess){j.forEach(AH,function(AJ){if(AJ.isGroupSetting&&AJ.visible){j.forEach(AJ.children,function(AK){if(AK.alias!=="groupbox"){AI=AK.isValid();return(AI.val);}return true;});}else{if(AJ.alias==="showLabel"){AI=true;}else{AI=AJ.isValid();}}return(AI.val);});return AI;}return this.dsnBox.dsnList.isValid();},getDbmsID:function K(){return this.dbmsList.selectedItem.did;},getDBId:function A(){if(this.dbIDSelectList.selectedItem&&this.isDSNLess){return this.dbIDSelectList.selectedItem.id;}return 0;},getDBType:function AF(){return this.dbmsList.selectedItem.db_type;},getCharEncodingForUnix:function d(AK){var AL=this.dbmsList.selectedItem,AJ=AL.db_ver,AH=j.find(this.dbVersions,"v",AJ);var AI=this.isDSNLess?AK:c.walk("dsnBox.dsnList.selectedItem.des",this);if(AL.db_type===u.dbType.POSTGRESQL&&AI.indexOf(POSTGRESQL_ODBC_DRIVER)>-1){return 1;}else{if(AH>=0){return this.dbVersions[AH].unixEncoding;}}return 1;},getDriverMode:function W(){return this.driverMode;},getOdbcv:function q(){if(this.getDBType()===this.dbTypes.Hive.v){return"20";}return"";},clear:function p(){this.set("info",{});}});mstrmojo.warehouse.dbroles.DBRoleDSNConnection.oneTierFileUploader=function(AH){mstrApp.rootController.oneTierFileUploader({success:function AI(){m.dbObjects.reloadDrivers({success:function AJ(){m.drivers=m.dbObjects.drivers;m.oninfoChange.call(m);}});}},{fp:AH});};}());(function(){mstrmojo.requiresCls("mstrmojo.expr","mstrmojo.mstr.EnumNodeProperties","mstrmojo.fe.FilterExprTree","mstrmojo.fe.AndOrNode","mstrmojo.fe.RelationNode","mstrmojo.fe.DynamicNode","mstrmojo.fe.ConditionNode");var M=mstrmojo.expr.ET,K=mstrmojo.mstr.EnumNodeProperties;mstrmojo.fe.RelationFilterExprTree=mstrmojo.declare(mstrmojo.fe.FilterExprTree,null,{scriptClass:"mstrmojo.fe.RelationFilterExprTree",nodeClassMap:{14:mstrmojo.fe.AndOrNode,15:mstrmojo.fe.RelationNode,ph:mstrmojo.fe.DynamicNode,"*":mstrmojo.fe.ConditionNode},getItemIdentityProp:function(N){if(N.node&K.CONDITION){return"*";}if(N.ph){return"ph";}if((N.et===10||N.et===12)&&N.dmt===4){return M.RLS;}return N.et;},isEditable:function L(O){var N=false;switch(O&&O.et){case M.RLS:N=true;break;}return N||this._super(O);},getItemConfig:function B(Q,N,R){var O=this._super(Q,N,R),P=(Q.et===M.RLS||!!Q.relation);if(P){O.itemFunction=R.itemFunction;}return O;},newCondition:function F(P){var O=this.getSelectedItemWidget(),N=0;if((typeof microstrategy!=="undefined")&&microstrategy.bones&&microstrategy.bones.rwb_viewer){N=microstrategy.bones.rwb_viewer.nextPhIndex;}else{if(mstrApp&&mstrApp.docModelData&&mstrApp.docModelData.phIndex){N=mstrApp.docModelData.phIndex;}}if(P&&P.ph&&!P.ph.idx){P.ph.idx=N++;}if(O&&O.selected&&O.newCondition){return O.newCondition(P);}else{return this._super(P);}},createSet:function E(O,N){var P=N.rq,Q=N.cq;if(P&&Q){this.remove(Q);if(N.isMetric){mstrmojo.hash.copyProps(["applySubExpr","dmy","dmt","relation","useSchema"],P,Q);P=Q;}else{P.nds=[Q];}this.add([P],O[0]);}},removeSet:function I(N){var O=N.data,P=[O];this.remove(O);if(O.nds&&O.nds.length>0){P=O.nds;}else{delete O.dmy;delete O.relation;delete O.applySubExpr;delete O.relation;delete O.useSchema;delete O.dmt;}this.add(P,0);},nameFactory:{counter:1,names:{},clear:function(){this.resetCounter();this.names={};},resetCounter:function D(){this.counter=1;},isNameExist:function J(N){return !!this.names[N];},setName:function H(N,O){this.names[N]=O;},changeName:function C(O,N,P){this.removeName(O);this.setName(N,P);},getNewName:function G(Q,P,S){var R=P||"",O=S||"",N;while(this.isNameExist(R+this.counter+O)){this.counter++;}N=R+this.counter+++O;this.names[N]=Q;return N;},removeName:function A(N){delete this.names[N];this.resetCounter();}}});})();(function(){mstrmojo.requiresCls("mstrmojo.hash","mstrmojo.array","mstrmojo.WidgetList","mstrmojo.qb.FilterTree","mstrmojo.CustomGroupEl","mstrmojo._HasPopup","mstrmojo._IsMovable","mstrmojo.ConditionNode","mstrmojo._IsPopup");mstrmojo.requiresDescs(118,1994,2550,3415,3416,5893,7953,12367,12368);var D=mstrmojo.hash,G=mstrmojo.array,M=mstrmojo.expr,H=M.BRANCH_FNS,N=mstrmojo.dom,E=mstrmojo.desc;function B(O){if(!O){return undefined;}var P=O.nds;if(!P){return O;}G.forEach(P,function(R,Q){P[Q]=B(R);});O.nds=P.slice(0);return O;}function I(O,Q,P){G.forEach(O,function(S,R){if(S.nds){I(S.nds,Q,P);}else{if(S===Q){O[R]=P;}}});}function L(Q,O){var R=Q.data,P=R?Q.parent.parent.parent.editorNode:Q.parent.editorNode;mstrApp.getRootController().openExpressionEditor({n:O?mstrmojo.desc(5893,"New Condition"):mstrmojo.desc(7953,"Condition Editor"),tkn:O?[]:R.expr,zIndex:(P&&parseInt(P.style.zIndex,10)+1),callbacks:{success:function S(V){var X={0:"filterExpr",1:"aggfilterExpr"},U=V.mi,W=U.exp.sqltp;var Y={et:"*",expr:U.items,n:V.expr,sqltp:W};if(O){Q[X[W]].newCondition(Y);}else{if(R.sqltp===W){I(Q.tree.items,Q.data,Y);Q.data=Y;Q.paint();}else{Q.del();Q.tree.parent[X[W]].newCondition(Y);}}}}});}function F(O){var P=O&&O.items;if(P){O.remove(P);}}mstrmojo.qb.ConditionEditor=mstrmojo.declare(mstrmojo.Editor,[mstrmojo._HasPopup,mstrmojo._IsMovable],{scriptClass:"mstrmojo.qb.ConditionEditor",cssClass:"mstrmojo-qb-filterEditor",title:mstrmojo.desc(2550,"Filters"),ondataChange:function C(){var O=this.CEl,Q=this.data,P=Q.having,R=D.clone(Q.where);O.filterExpr.set("items",[]);O.filterExpr.add(R?[R]:[],0);O.aggfilterExpr.set("items",[]);O.aggfilterExpr.add(P?[P]:[],0);},children:[{scriptClass:"mstrmojo.CustomGroupEl",cssClass:"mstrmojo-qb-filterTreeBox",alias:"CEl",markupString:'<div id="{@id}" class="mstrmojo-onhoverparent mstrmojo-CustomGroupEl {@cssClass}" style="{@cssText}"><div class="mstrmojo-qb-cond-details {@cssClass}"><div class="mstrmojo-qb-expr-tools {@cssClass}"></div><div class="mstrmojo-CustomGroupEl-expr {@cssClass}"></div><div class="mstrmojo-CustomGroupEl-expr {@cssClass}"></div><div class="mstrmojo-CustomGroupEl-expr {@cssClass}"><br></div><div class="mstrmojo-CustomGroupEl-expr {@cssClass}"></div></div></div>',markupMethods:{onstateChange:function(){this.detailsNode.style.display=this.state?"block":"none";}},markupSlots:{stateNode:function(){return this.domNode.firstChild.firstChild;},detailsNode:function(){return this.domNode.lastChild;},exprNode:function(){return this.domNode.lastChild.children[2];},expr2Node:function(){return this.domNode.lastChild.children[4];},exprToolsNode:function(){return this.domNode.lastChild.firstChild;}},parent:this.parent,children:[{scriptClass:"mstrmojo.qb.FilterTree",slot:"exprNode",alias:"filterExpr",onexprclick:function A(O){L(O,false);}},{scriptClass:"mstrmojo.qb.FilterTree",slot:"expr2Node",alias:"aggfilterExpr",onexprclick:function A(O){L(O,false);}},{scriptClass:"mstrmojo.Box",slot:"exprToolsNode",children:[{scriptClass:"mstrmojo.Button",cssClass:"mstrmojo-CGE-addCondition-button",onclick:function(){L(this.parent.parent,true);}},{scriptClass:"mstrmojo.Button",cssClass:"mstrmojo-CGE-addCondition",text:mstrmojo.desc(1994,"Add Condition"),onclick:function(){L(this.parent.parent,true);}},{scriptClass:"mstrmojo.Label",text:mstrmojo.desc(5186,"Delete All"),cssClass:"mstrmojo-qb-deleteAll",onclick:function(){var O=this.parent.parent;F(O.filterExpr);F(O.aggfilterExpr);}}]}],state:true}],buttons:[{scriptClass:"mstrmojo.Button",cssClass:"mstrmojo-di-button mstrmojo-WebButton hot",text:mstrmojo.desc(118,"Save"),onclick:function K(){var P=this.parent.parent,O=P.CEl;mstrApp.getRootController().updateFilters(B(O.filterExpr.items[0]),B(O.aggfilterExpr.items[0]));P.set("visible",false);}},{scriptClass:"mstrmojo.Button",cssClass:"mstrmojo-di-button mstrmojo-WebButton",text:mstrmojo.desc(3416,"Cancel"),onclick:function K(){var Q=this.parent.parent,P=Q.CEl,R=Q.data,U=1000;if(D.equals(B(P.filterExpr.items[0]),R.where)&&D.equals(B(P.aggfilterExpr.items[0]),R.having)){Q.set("visible",false);return ;}var O=mstrmojo.Button.newInteractiveButton;mstrmojo.confirm(E(12367,"All your changes on the filter will be lost. Do you want to exit?"),null,{buttons:[O(mstrmojo.desc(1442,"OK"),function S(){Q.set("visible",false);},null,{onRender:function(){if(mstrApp.isCloudPro){mstrmojo.css.addClass(this.domNode,"cloud");}else{mstrmojo.css.addClass(this.domNode,["mstrmojo-di-button","mstrmojo-WebButton","hot"]);}}}),O(mstrmojo.desc(3416,"Cancel"),mstrmojo.emptyFn,null,{onRender:function(){if(mstrApp.isCloudPro){mstrmojo.css.addClass(this.domNode,"cloud cancel");}else{mstrmojo.css.addClass(this.domNode,["mstrmojo-di-button","mstrmojo-WebButton"]);}}})],title:E(12368,"Lose Your Changes?"),zIndex:U});}}],getMovingHandle:function J(){return this.children[0].domNode;},andOrPopupRef:{scriptClass:"mstrmojo.Editor",cssClass:"mstrmojo-CGE-andOrPopup mstrmojo-ConditionWalk",cssText:"width: auto;",contentNodeCssClass:"mstrmojo-balloon",left:"250px",top:"15px",slot:"containerNode",autoClose:true,showTitle:false,draggable:false,openEffect:null,closeEffect:null,onOpen:function(){var O=this.condition,R=O&&O.data&&O.data.not,U=O&&O.parent,P=U&&U.data,Q=(P&&P.fn)+(R?21:0),S=this.list;S.opening=true;S.set("selectedItem",isNaN(Q)?null:{did:Q});S.opening=false;this.curtainNode.style.position="fixed";},children:[{scriptClass:"mstrmojo.Dial",cssClass:"mstrmojo-CGE-andOrDial",alias:"list",itemMarkup:'<div class="dial-item {@css}">{@n}</div>',itemIdField:"did",items:[{did:19,n:H[19]},{did:20,n:H[20]},{did:19+21,n:H["19_21"]},{did:20+21,n:H["20_21"]}],onchange:function(){if(this.opening){return ;}var P=this.parent,O=P.condition,V=this.selectedItem,U=V&&V.did,S=U>21?true:null,R=U-(S?21:0);P.close();var Q=O&&O.parent;if(Q&&Q.data&&Q.data.et===M.ET.ANDOR){Q.edit(O,R,S);}else{var W=O&&O.data;if(W&&(W.not!==S)){W.not=S;O.paint();}}}}]},inlineTextRef:{scriptClass:"mstrmojo.Popup",locksHover:true,children:[{scriptClass:"mstrmojo.TextBox",alias:"txt",onTab:function(P){if(this.onEnter){this.onEnter();}var O=N.shiftKey(P.hWin,P.e)?this.prevTab:this.nextTab;if(O&&O.onclick){O.onclick();}},onblur:function(){if(this.onEnter){this.onEnter();}},onEsc:function(){if(this.onCancel){this.onCancel();}this.parent.close({cancel:true});}}],onOpen:function(){var P=this.txt,O=this.txtConfig;D.forEach(O,function(Q){P.set(Q,O[Q]);});P.focus();},onClose:function(O){if(!O||(!O.cancel&&!O.enter)){this.txt.onEnter();}}}});}());(function(){mstrmojo.requiresCls("mstrmojo.SaveAsEditor","mstrmojo.DI.DIConstants");mstrmojo.requiresDescs(1442,12376,12377,12908);var F=mstrmojo.array,H=mstrmojo.DI.DIConstants,C=mstrmojo.desc;var D=0,E=-1,B=-2;mstrmojo.DI.ui.dialogs.DISaveAsDialog=mstrmojo.declare(mstrmojo.SaveAsEditor,null,{scriptClass:"mstrmojo.DI.ui.dialogs.DISaveAsDialog",cssClass:"mstrmojo-SaveAsEditor",typeDesc:"Cube",browsableTypes:"776,779,8",zIndex:1000,folderLinksContextId:28,onRender:function I(){this.ob.set("scrollableIncFetch",true);},validateInput:function(O,Q){var N=mstrApp.getRootController(),K=this.contPanel,M=this.ob.currentFolder,R=K.name.value,P=this,S=D,L;this.name=K.name.value;this.desc=K.desc.value;this.folderID=M.did;this.saveAsOverwrite=!!O;if(!this.name||H.invalidObjectNameCharsRegex.test(this.name)){S=E;Q(S);return ;}F.forEach(M.items,function(U){if(U.t===3&&U.n.toUpperCase()===R.toUpperCase()){S=B;return false;}});if(S!==D){Q(S);return ;}L={rootFolderID:M.did,searchPattern:R,objectType:P.browsableTypes,nameWildcards:0};if(this.ob.enableQuickSearch){L.quickSearch=this.ob.enableQuickSearch;}N.dataService.searchFolderContents({success:function(U){if(U&&U.items){F.forEach(U.items,function(V){if(V.t===3&&V.n.toUpperCase()===R.toUpperCase()){S=B;return false;}});}Q(S);},failure:function(U){N.displayError(mstrmojo.desc(13071,"Error in saving the cube."),false,U.message);}},L);},saveCube:function J(){var P=mstrApp.getRootController(),O=P.getModel();var M=this.saveParams||{};M.folderID=this.folderID;M.objDesc=this.desc||"";M.objName=this.name||"";M.saveAsOverwrite=this.saveAsOverwrite;var L=this.saveAsCallback();L.parent=this;var Q=O.isDirectDataAccess?true:false;mstrApp.serverRequest(M,L,{showProgress:Q});this.close();var N,R=[],S=O.importSources;for(N in S){var K=S[N].sourceInfo.name;S[N].status="0";R.push({n:K,complete:false});}O.cubeName=this.name||"";if(!O.isDirectDataAccess){O.raiseEvent({name:"PublishStatusUpdate"});P.showDialog(H.dialogType.publishStatusDialog,{model:O,zIndex:mstrApp.getRootController().dialogController.getNextZIndex()});}P.enableFinishButton(false);},saveAs:function(K){var L=this;this.validateInput(K,function(M){switch(M){case D:L.saveCube();break;case E:mstrmojo.alert(C(12376,"Please enter a valid cube name"));break;case B:var N=C(12377,"Saving cube with the same name");mstrmojo.warn(mstrmojo.desc(12908,"The name #### already exists. Do you want to replace the existing one?").replace("####",this.name),{confirmBtn:{t:mstrmojo.desc(1442,"OK"),fn:function(){L.saveCube();},hot:true},cancelBtn:{t:mstrmojo.desc(221,"Cancel")}},{title:N});break;}});},close:function(){if(this._super){this._super();}},getObjectPath:function G(){var M=this.ob.currentFolder,N=this.name,L="\\",O="",K;if(M){K=M.anc&&M.anc.items;while(K[0].n!==M.n&&K[0].n!=="Shared Reports"&&K[0].n!=="My Reports"){K=K[0].items;}while(K){O=O+K[0].n+L;K=K[0].items;}}O+=N;return O;},postBuildRendering:function A(){if(this._super){this._super();}this.buttonBox.cancel.onclick=function(){var L=mstrApp.getRootController(),K=L.getModel&&L.getModel()||L.model;if(K.isDirectDataAccessBeforeSave!==undefined&&K.isDirectDataAccess!==K.isDirectDataAccessBeforeSave){K.set("isDirectDataAccess",K.isDirectDataAccessBeforeSave);}this.parent.parent.close();};},});}());(function(){mstrmojo.requiresCls("mstrmojo.expr","mstrmojo._HasPopup","mstrmojo.Label","mstrmojo.HTMLButton","mstrmojo.ObjectBrowser","mstrmojo.ObjectInputBox","mstrmojo.DataGrid","mstrmojo.Editor");mstrmojo.requiresDescs(221,629,945,1442,1825,3095,4114,4115,4563,5298,8246,9125,12173,12916,12918,12947);var F=mstrmojo.hash,D=mstrmojo.expr,A=mstrmojo.ME.MetricToken.brackets,G=function(M){var J=null;if(M.isParam){J={scriptClass:"mstrmojo.Table",cssClass:"funcParam",layout:[{cells:[{cssText:"width: 338px"},{}]}],children:[{scriptClass:"mstrmojo.ObjectInputBox",alias:"paramInput",slot:"0,0",itemValidationField:"_did_",item2textCss:function E(N){return" mstrmojo-qb-SuggestIcon t"+N.t;},hideEditButton:function(){return false;},browseItemVisible:false,dynamicVerify:false,emptyText:mstrmojo.desc(9125,"Type here to input columns..."),postCreate:function(O){var N=this.parent.dataGrid,P=N&&N.parent;this.candidates=P.getCandidates(function(Q){return Q.t===26;});if(!O){N.candidatesListener.push(this);}this.autoSelect=false;this.openPopup("suggestionPopup");this.suggestionPopup.close();this.autoSelect=true;}}],onParamAdded:function(P){var O=this.dataGrid.parent,N=this.paramInput;O.closePopup();P.state=0;N.add([P],N.items.length-1);},getTokens:function(){var Q=this.paramInput.getSelectedObjects(),N=Q.length,P,R=[],O;if(N>0){for(P=0;P<N;P++){if(Q[P].state===mstrmojo.Enum_OIB_States.VALID){O={v:A(Q[P].n)};O.oi=Q[P];}else{O={v:Q[P].n};}R.push(O);R.push({v:",",isDelimiter:true});}R.pop();}return R;}};var K=J.children[0];if(!M.isRepeated){K.cssClass="mstrmojo-ObjectInputBox singleObject noVerify";K.maxObjectCount=1;}else{K.cssClass="mstrmojo-ObjectInputBox noVerify";}}else{switch(M&&M.dtp){case 11:J={scriptClass:"mstrmojo.Pulldown",cssClass:"mstrmojo-functionArgs-pulldown mstrmojo-Pulldown",items:[{n:mstrmojo.desc(4115,"False"),did:"0"},{n:mstrmojo.desc(4114,"True"),did:"-1"}],popupToBody:true,itemIdField:"did",postCreate:function(N){this.value=this.data.dfv||0;},getTokens:function(){var N=this.data;if(this.value!==N.dfv){return[{v:N.n},{v:"=",isDelimiter:true},{v:String(this.value)==="-1"?"True":"False"}];}return[];}};break;case -2:J={scriptClass:"mstrmojo.Table",cssClass:"breakBy",layout:[{cells:[{cssText:"width: 338px"},{}]}],children:[{scriptClass:"mstrmojo.ObjectInputBox",slot:"0,0",alias:"breakByInput",item2textCss:function E(N){return(this._super&&this._super(N))||{12:"a","-99":"br"}[N.t]||"";},emptyText:mstrmojo.desc(12916,"Type here to input breakby attributes..."),noEditButton:true,browseItemVisible:true,folderLinksContextId:16,browsableTypes:[D.TP.FOLDER,D.TP.ATTR].join(","),getCandidatesThroughTaskCall:function L(O,N){mstrmojo.ME.MetricDataService.getAttributes(O,N);},postCreate:function(O){var N=this.parent.dataGrid,P=N&&N.parent;this.candidates=P.getCandidates(function(Q){return Q.t===12;});if(!O){N.candidatesListener.push(this);}}},{scriptClass:"mstrmojo.ToolBar",slot:"0,1",cssClass:"mstrmojo-oivmSprite grouped",children:[{scriptClass:"mstrmojo.Button",title:mstrmojo.desc(1825,"Browse"),iconClass:"tbBrowse",onclick:function(){var O=this.parent.parent.dataGrid.parent;O.openPopup("ob",{zIndex:O.zIndex+10});var N=O.ob.browser;N.browse({folderLinksContextId:16,onSelectCB:[this.parent.parent,"onBreakByAdded"],browsableTypes:[D.TP.ATTR,D.TP.FOLDER].join(",")});}}]}],onBreakByAdded:function(P){var O=this.dataGrid.parent,N=this.breakByInput;O.closePopup();N.add([P],N.items.length-1);},getTokens:function(){var P=this.breakByInput.getSelectedObjects(),N=P.length,O,Q=[];if(N>0){Q.push({v:"BreakBy"});Q.push({v:"=",isDelimiter:true});Q.push({v:"{",isDelimiter:true});for(O=0;O<N;O++){Q.push({v:A(P[O].n),oi:P[O]});if(O!==(N-1)){Q.push({v:",",isDelimiter:true});}}Q.push({v:"}",isDelimiter:true});}return Q;}};break;case -1:J={scriptClass:"mstrmojo.Table",cssClass:"sortBy",layout:[{cells:[{cssText:"width: 330px"},{}]}],getTokens:function(){var Q=this.sortByGrid.items,N=Q.length,P,U=[];if(N>0){U.push({v:"SortBy"});U.push({v:"=",isDelimiter:true});U.push({v:"(",isDelimiter:true});for(P=0;P<N;P++){var R=Q[P],S=R.selFrm||(R.dssforms&&R.dssforms[0]),O={v:A(R.n),oi:R};if(S&&parseInt(R.t,10)===12){F.copy({v:A(R.n)+"@"+A(S.n),exv:S.dssid,extp:S.dtp},O);}U.push(O);if(P!==(N-1)){U.push({v:",",isDelimiter:true});}}U.push({v:")",isDelimiter:true});}return U;},children:[{scriptClass:"mstrmojo.DataGrid",slot:"0,0",cssClass:"mstrmojo-functionArgs-sort",alias:"sortByGrid",renderOnScroll:false,resizableColumns:true,makeObservable:true,itemDisplayField:"n",columns:[{headerText:mstrmojo.desc(945,"Name"),dataField:"n",colCss:"nmCol"},{headerText:mstrmojo.desc(8246,"Field"),dataField:"field",colCss:"spcCol",dataWidget:{scriptClass:"mstrmojo.Pulldown",bindings:{items:"this.data.dssforms"},popupToBody:true,popupZIndex:100,onvalueChange:function(){this.data.selFrm=this.selectedItem;}}},{headerText:mstrmojo.desc(8246,"Field"),dataField:"field",colCss:"spcCol",dataWidget:{scriptClass:"mstrmojo.Pulldown",bindings:{items:"this.data.dssforms"},popupToBody:true,popupZIndex:100,onvalueChange:function(){this.data.selFrm=this.selectedItem;}}},{headerText:mstrmojo.desc(3095,"Order"),dataField:"order",colCss:"ordCol",dataWidget:{scriptClass:"mstrmojo.Pulldown",items:[{n:"Ascending",v:0},{n:"Descending",v:1}],itemIdField:"v",popupToBody:true,popupZIndex:100,onvalueChange:function(){this.data.asc=this.value;}}},{dataWidget:{scriptClass:"mstrmojo.Button",cssClass:"mstrmojo-ACLEditor-delete",text:"&nbsp",title:mstrmojo.desc(629,"Delete"),onclick:function(N){this.dataGrid.remove(this.data);}},headerText:"&nbsp",colCss:"actionsCol"}]},{scriptClass:"mstrmojo.ToolBar",slot:"0,1",cssClass:"mstrmojo-oivmSprite grouped",children:[{scriptClass:"mstrmojo.Button",title:mstrmojo.desc(1825,"Browse"),iconClass:"tbBrowse",onclick:function(){var O=this.parent.parent.dataGrid.parent;O.openPopup("ob",{zIndex:O.zIndex+10});var N=O.ob.browser;N.browse({folderLinksContextId:16,onSelectCB:[this.parent.parent,"onSortByAdded"],browsableTypes:[D.TP.ATTR,D.TP.METRIC,D.TP.FOLDER].join(",")});}}]}],onSortByAdded:function(Q){var O=this.dataGrid.parent,P=this.sortByGrid;O.closePopup();if(Q){switch(Q.t){case 12:var R=function(S){if(S){var U=S.container;if(U&&U.dssforms){Q.dssforms=U.dssforms;P.add([Q]);}}},N=function(S){mstrmojo.alert(S.getResponseHeader("X-MSTR-TaskFailureMsg").replace(/com\.microstrategy\.(.*): \((.*)\)/,"$2"));};mstrmojo.ME.MetricDataService.getAttributeForms({attributeID:Q.did,displayedForms:0},{success:R,failure:N});break;case 4:Q.dssforms=[{n:"Value"}];default:P.add([Q]);}}}};break;default:J={scriptClass:"mstrmojo.TextBox",cssClass:"mstrmojo-functionArgs-textInput",postCreate:function(N){var O=this.data;this.value=(O.dfv||O.dfv===0)?O.dfv:"";},getTokens:function(){var N=this.data;if(this.value!==N.dfv){return[{v:N.n},{v:"=",isDelimiter:true},{v:this.value}];}return[];}};break;}}J.alias="inputWidget";return J;},I=function(K,E,J){return'<div class="mstrmojo-DataRow-text"title="'+(K.desc||"")+'">'+K.n+(K.isParam?"*":"")+":</div>";};mstrmojo.qb.FunctionWizard=mstrmojo.declare(mstrmojo.Editor,null,{scriptClass:"mstrmojo.qb.FunctionWizard",init:function H(E){this._super(E);this.help=this.help||(mstrApp&&mstrApp.helpTopics&&mstrApp.helpTopics.fnWiz);},cssClass:"mstrmojo-FunctionWidzard",title:mstrmojo.desc(4563,"Function Arguments"),help:"",fctOi:null,fctArgs:null,fctSyntax:"",bindings:{candidates:"this.opener.candidates"},getCandidates:function B(K){var J=this.candidates,E;if(J){E=mstrmojo.array.filter(J.items,K);return{items:E,isComplete:J.isComplete};}return null;},_set_candidates:function(N,J){this.candidates=J;if(this.hasRendered&&this.visible){var L=this.argsGrid,M=L.candidatesListener,E=M.length,K;for(K=0;K<E;K++){M.postCreate(true);}}return true;},onOpen:function(){var J=this,L,K=function(P){if(P){J.set("fctOi",P);var R=[],O,M,Q,N=[];N.push(P.n);N.push("(");M=(P.pars&&P.pars.length)||0;for(O=0;O<M;O++){Q=F.copy(P.pars[O]);Q.isParam=true;R.push(Q);N.push(P.pars[O].n);if(O!==(M-1)){N.push(", ");}}N.push(")");if(P.rpc>0){Q.isRepeated=true;}M=(P.pros&&P.pros.length)||0;if(P.did==="6F7DF5FF449111D5BEA300B0D01A55EF"){M=0;}for(O=0;O<M;O++){if(P.pros[O].n!=="UseLookupForAttributes"){R.push(F.copy(P.pros[O]));}}if(P.sqt===5){R.push({n:mstrmojo.desc(12173,"Break By"),dtp:-2,desc:mstrmojo.desc(12918,"Break By is a parameter representing the break by levels for this function.")});}J.set("fctArgs",R);J.set("fctSyntax",N.join(""));}mstrmojo.css.removeClass(J.argsGrid.domNode,["loading"]);},E=function(M){mstrmojo.alert(M.getResponseHeader("X-MSTR-TaskFailureMsg").replace(/com\.microstrategy\.(.*): \((.*)\)/,"$2"));mstrmojo.css.removeClass(this.argsGrid.domNode,["loading"]);};this.argsGrid.set("items",[]);mstrmojo.css.addClass(this.argsGrid.domNode,["loading"]);this.set("fctSyntax","");this.set("title",mstrmojo.desc(12947,"Function arguments for:")+this.fctOi.n);L={functionId:this.fctOi.did,includeFunctionDetails:true,includeFunctionHelpTopic:true};mstrApp.getRootController().getDataService().getFunctionDetails({success:K,failure:E},L);},getTokens:function C(){var L=this.argsGrid.ctxtBuilder.itemWidgets,O=L.length,N,S,P=[],K=[],U=[],Q,M,J,E,R=this.fctOi;for(N=0;N<O;N++){S=L[N].inputWidget;if(S.data.isParam){K.push(S.getTokens());}else{P.push(S.getTokens());}}U.push({v:R.n,oi:R});O=P.length;if(O>0){E=false;U.push({v:"<",isDelimiter:true});for(N=0;N<O;N++){Q=P[N];J=Q.length;if(J===0){continue;}E=true;for(M=0;M<J;M++){U.push(Q[M]);}U.push({v:",",isDelimiter:true});}U.pop();if(E){U.push({v:">",isDelimiter:true});}}O=K.length;U.push({v:"(",isDelimiter:true});E=false;for(N=0;N<O;N++){Q=K[N];J=Q.length;if(J===0){continue;}E=true;for(M=0;M<J;M++){U.push(Q[M]);}U.push({v:",",isDelimiter:true});}if(E){U.pop();}U.push({v:")",isDelimiter:true});return U;},ob:{scriptClass:"mstrmojo.Editor",title:mstrmojo.desc(5298,"Select an Object"),help:"Select_Objects_dialog_box_.htm",children:[{scriptClass:"mstrmojo.ObjectBrowser",alias:"browser",cssText:"width:200px",fishEyeVisible:false,closeable:false,closeOnSelect:false}]},children:[{scriptClass:"mstrmojo.DataGrid",alias:"argsGrid",cssClass:"functionArgs",banding:false,columns:[{headerText:"Property Name",dataFunction:I,colCss:"name"},{headerText:"Property Type",dataWidgetBuilder:G,colCss:"dtp"}],postCreate:function(){this.candidatesListener=[];},bindings:{items:"this.parent.fctArgs"}},{scriptClass:"mstrmojo.Label",cssClass:"mstrmojo-FW-syntaxLabel",text:"",bindings:{text:function(){return this.parent.fctSyntax;}}},{scriptClass:"mstrmojo.Label",cssClass:"mstrmojo-FW-descLabel",text:"",bindings:{text:function(){return this.parent.fctOi.desc;}}},{scriptClass:"mstrmojo.HBox",slot:"buttonNode",cssClass:"mstrmojo-FW-buttonBox mstrmojo-Function-Arguments",children:[{scriptClass:"mstrmojo.Button",cssClass:"mstrmojo-Editor-button mstrmojo-WebButton hot",text:mstrmojo.desc(1442,"OK"),onclick:function(){var E=this.parent.parent;if(E.insertOnFinish){E.insertOnFinish(E.getTokens());}E.close();}},{scriptClass:"mstrmojo.Button",cssClass:"mstrmojo-Editor-button mstrmojo-WebButton",text:mstrmojo.desc(221,"Cancel"),onclick:function(){var E=this.parent.parent;E.close();}}]}]});}());(function(){mstrmojo.requiresCls("mstrmojo.ObjectInputBox","mstrmojo.ACL.UserDataService");mstrmojo.ACL.UserInputBox=mstrmojo.declare(mstrmojo.ObjectInputBox,null,{suggestionPopupCssClss:"mstrmojo-ACLInputBox-suggest",blockCount:10,useKeyDelay:true,getACLUserDataService:function C(){return mstrmojo.ACL.UserDataService;},item2textCss:function A(D){return(this._super&&this._super(D))||"mstrmojo-ACLInputBox-user "+{8704:"u",8705:"ug"}[D.st]||"";},getCandidatesThroughTaskCall:function B(E,D){this.getACLUserDataService().searchUserCandidates(E.pattern,!E.isVerify,E.blockCount,D);}});})();(function(){mstrmojo.requiresCls("mstrmojo.vi.ui.TitleBar","mstrmojo.Image","mstrmojo.css");mstrmojo.vi.ui.CollapsibleTitleBar=mstrmojo.declare(mstrmojo.vi.ui.TitleBar,null,{scriptClass:"mstrmojo.vi.ui.CollapsibleTitleBar",btnCollapse:null,canCollapse:false,isCollapsed:false,collapse:mstrmojo.emptyFn,onToggleCollapseByUI:mstrmojo.emptyFn,setToolbarVisibility:function C(D){if(!D||!this.isCollapsed){this._super(D);}},onisCollapsedChange:function B(){if(this.canCollapse){var D=this.isCollapsed;this.parent.set("isCollapsed",D);}},getLeftToolbarChildren:function A(){var D=this;return[{scriptClass:"mstrmojo.Image",slot:"leftToolNode",alias:"btnCollapse",onclick:function(F){var G=this.parent,E=G.parent;if(G.canCollapse){G.set("isCollapsed",!G.isCollapsed);D.onToggleCollapseByUI();var H=F.e;if(H&&H.stopPropagation){H.stopPropagation();}}if(E&&E.clickToCollapse){E.clickToCollapse();}}}];}});mstrmojo._HasMarkup.addMarkupMethods(mstrmojo.vi.ui.CollapsibleTitleBar,{oncanCollapseChange:function(){this.btnCollapse.set("visible",this.canCollapse);},onisCollapsedChange:function(){mstrmojo.css.toggleClass(this.domNode,"collapsed",this.isCollapsed);}});}());(function(){mstrmojo.requiresCls("mstrmojo.Box","mstrmojo.qb.QBSimplePreview");mstrmojo.requiresDescs(13033,12419,3389);var D=mstrmojo.desc;var A;mstrmojo.qb.QBMappings=mstrmojo.declare(mstrmojo.Box,[mstrmojo._HasPopup],{scriptClass:"mstrmojo.qb.QBMappings",markupMethods:{onvisibleChange:function(){this.domNode.style.display=this.visible?"block":"none";}},cssClass:"mstrmojo-di-datapreview",cssText:"position:relative;overflow:hidden;border-bottom-right-radius:6px;border-bottom-left-radius:6px;padding:0px;",width:0,height:0,dropZone:false,active:false,children:[{scriptClass:"mstrmojo.Box",alias:"previewInfo",cssClass:"mstrmojo-qb-preview-info",markupString:'<div id="{@id}" class="mstrmojo-Box {@cssClass}" style="{@cssText}"><span class="mstrmojo-qb-preview-text"></span><span class="mstrmojo-qb-preview-menu" mstrAttach:click></span></div>',visible:false,markupSlots:{ButtonNode:function(){return this.domNode.firstChild;}},markupMethods:{onvisibleChange:function(){this.domNode.style.display=this.visible?"block":"none";this.domNode.lastChild.style.cssText+=(mstrApp.isFFSQL||mstrApp.isFFSQLMode)?";display:none !important":";display:inline-block !important";}},onclick:function H(){A.showPopupMenu(this.parent,{menuNode:this.domNode.lastChild});}},{scriptClass:"mstrmojo.qb.QBSimplePreview",alias:"content",columns:[],cssText:"width:100%"},{scriptClass:"mstrmojo.Label",alias:"notice",cssClass:"warnLabel",text:D(12419,"No preview available.")}],init:function G(K){var L,J;this._super(K);L={};J=L[this.id]={};J.dataPreview=this.handleDataPreview;mstrApp.getRootController().attachDataChangeListeners(L);},handleDataPreview:function I(K){mstrApp.getRootController().toggleDataPreview(true);var L=this.content,M=this.notice,Q=K.mappings,N=K.dataset,J=K.selectedColumns,P=K.isRefined,O=(Q&&Q.length>0);L.mappings=Q;L.dataset=N;L.selectedColumns=J;L.isRefined=P;L.set("visible",O);M.set("visible",!O);this.previewInfo.set("visible",O);mstrmojo.css.toggleClass(this.parent.domNode,"has-preview",O);O&&L.populatePreview();},onheightChange:function(L){if(this.domNode){var M=Math.max(parseInt(L.value,10),0),J=38,K;this.domNode.style.height=M+"px";K=Math.max(M-J+2,0);this.content.set("height",K+"px");}},onwidthChange:function C(K){if(this.domNode){var J=parseInt(K.value,10)+"px";if(J!=="NaNpx"){this.domNode.style.width=J;this.content.set("width",J);}}},postBuildRendering:function B(){if(this._super){this._super();}if(this.previewInfo){this.previewInfo.ButtonNode.innerHTML=(!!mstrApp.isWorkstation)?D(3389,"Preview"):D(13033,"Sample Preview");}}});function F(){mstrApp.getRootController().deleteAllColumns();}A=mstrmojo.qb.QBMappings;A.showPopupMenu=function E(M,K){var L=A.menuHelper=A.menuHelper||new mstrmojo.qb.QBPreviewMenu();L.target=M;var J=L.getMenuConfig();J.hostId=M.id;J.hostElement=K.menuNode;J.isHostedWithin=false;J.position=mstrmojo.dom.position(K.menuNode,true);M.openPopup(new mstrmojo.ui.menus.Menu({popupConfig:J}));};mstrmojo.qb.QBPreviewMenu=mstrmojo.declare(mstrmojo.Obj,null,{scriptClass:"mstrmojo.qb.DBTableRowMenu",menuCssClass:"mstrmojo-qb-DBTableRowMenu",menuCfg:null,getMenuConfig:function(){var J=this.menuCfg;if(!J){J=this.menuCfg=new mstrmojo.ui.menus.MenuConfig({menuCssClass:this.menuCssClass});}else{J.clear();}J.addMenuItem(D(5186,"Delete All"),"",F);return J;}});})();(function(){mstrmojo.requiresCls("mstrmojo.array","mstrmojo.hash","mstrmojo.Container","mstrmojo.desc","mstrmojo.ME.TokenInputBox","mstrmojo.mstr.EnumDSSXMLTokenTypes","mstrmojo.ME.Enum","mstrmojo._HasTooltip","mstrmojo.dom","mstrmojo.string");mstrmojo.requiresDescs(221,547,9106,9565,9566,9567,9568,11897,13542,13543,15665);var M=mstrmojo.array,S=mstrmojo.hash,I=mstrmojo.desc,O=mstrmojo.mstr.EnumDSSXMLTokenTypes,N=mstrmojo.ME.Enum.METRIC_EDIT_TYPES,L=mstrmojo.string.escape4HTMLText,E=mstrmojo.dom;var Q={VALID:0,UNKNOWN:1,VALIDATING:2,ERROR:3,AMBIGUITY:4},G={0:"valid",1:"unknown",2:"validating",3:"error",4:"ambiguity"},R={0:I(9565,"Valid Metric Formula."),1:I(9106,"Require Validation?"),2:I(9566,"Validation in Progress..."),3:I(9567,"Validation Failed with Syntax Error!"),4:I(9568,"Validation Failed with Object Ambiguity!")},U={ERROR:"-2147214845",AMBIGUITY:"-2147214846"},B={};B[U.ERROR]=Q.ERROR;B[U.AMBIGUITY]=Q.AMBIGUITY;function P(a){if(!a){return Q.VALID;}return B[a]||Q.ERROR;}mstrmojo.ME.MetricEditBox=mstrmojo.declare(mstrmojo.Container,[mstrmojo._HasPopup,mstrmojo._HasTooltip],{scriptClass:"mstrmojo.MetricEditBox",vStatus:Q.VALID,iStatus:"",showStatus:true,browseItemVisible:true,absorbAmbiguity:true,validateFunc:null,isObjectVisible:function(a){return true;},markupString:'<div id="{@id}" class="mstrmojo-MEBox {@cssClass}" style="{@cssText}"><div class="mstrmojo-MEBox-edit"></div><div class="mstrmojo-MEBox-status {@statusCssClass}"><div class="mstrmojo-MEBox-vStatus"></div><div class="mstrmojo-MEBox-iStatus"></div></div></div>',markupSlots:{editNode:function(){return this.domNode.firstChild;},iStatusNode:function(){return this.domNode.lastChild.lastChild;},vStatusNode:function(){return this.domNode.lastChild.firstChild;},statusNode:function(){return this.domNode.lastChild;}},markupMethods:{onvStatusChange:function(){var b=this.vStatus,a=this.vStatusNode;a.className="mstrmojo-MEBox-vStatus "+G[b];a.innerHTML=(this.getStatusDesc&&this.getStatusDesc(b))||R[b]||"";if(this.vStatus===Q.VALID){this.set("cValid",true);}},oniStatusChange:function(){this.iStatusNode.innerHTML=this.iStatus;}},children:[{scriptClass:"mstrmojo.ME.TokenInputBox",alias:"inputBox",slot:"editNode",renderOnScroll:false,renderBlockSize:0,bindings:{browseItemVisible:"this.parent.browseItemVisible",candidates:"this.parent.candidates"},editEmbeddedFilterToken:function(a){var b=this.parent;if(b.editEmbeddedFilterToken){b.editEmbeddedFilterToken(a);}}}],init:function V(a){var b=this,c=a.validateFunc||this.validateFunc;if(c){b.children=[{scriptClass:"mstrmojo.Button",alias:"validateBtn",slot:"statusNode",text:I(11897,"Validate"),cssClass:"mstrmojo-WebHoverButton right hoverLink",cssDisplay:"inline-block",onclick:c}].concat(this.children);}if(this._super){this._super(a);}this.statusCssClass=this.showStatus?"":"hidden";},getSearchPattern:function Z(){return this.inputBox.getSearchPattern();},getHighlightedText:function W(b,a){return this.inputBox.getHighlightedText(b,a);},item2textCss:function K(a){return{4:"m",7:"am",11:"fx",12:"a",13:"fc",43:"tr",47:"cs"}[a.t]||"";},handleSuggestionItemSelect:function J(a){var b=this.ambiguityDialog;if(a){b.onItemSelect(a);}b.close();},showDesc:true,showPath:true,ambiguityDialog:{scriptClass:"mstrmojo.Editor",cssClass:"mstrmojo-ME-ambiguityDialog",onOpen:function(){this.set("title",I(13542,"Object Ambiguity - ##").replace("##",this.ambiguousName));this.list.clearSelect();this.list.set("items",this.items);this.list.singleSelect(0);this.label.set("text",I(13543,"More than one object with the name '##' were found.").replace("##",this.ambiguousName));},children:[{scriptClass:"mstrmojo.Label",alias:"label",text:""},{scriptClass:"mstrmojo.ui.ScrollableSuggestionList",alias:"list",cssClass:"mstrmojo-ME-ambiguityList",bindings:{items:"this.parent.opener.suggestionItems"},onclick:function(a){mstrmojo._IsList.onclick.call(this,a);},getItemMarkup:function(d,a){var c=this.parent.opener,b=mstrmojo.string.escape4HTMLText;var f=(c&&c.item2textCss(d))||"";var e="";if(d.path){e='<div class="mstrmojo-object-additional-info" idx="'+a+'">'+mstrmojo.desc(16154,"From Dataset:")+" "+L(d.path)+"</div>";}else{d.standalone=true;}return'<div class="mstrmojo-object-item" idx="'+a+'"><div class="mstrmojo-object-name '+f+'" idx="'+a+'">'+L(d.n)+"</div>"+e+"</div>";},buildTooltip:function(a,b){if(a.standalone){return L(a.path)+"> "+L(a.n);}else{return L(a.n)+'<div class="mstrmojo-object-additional-info">'+mstrmojo.desc(16154,"From Dataset:")+" "+L(a.path)+"</div>";}}}],buttons:[{scriptClass:"mstrmojo.Button",cssClass:"mstrmojo-Button mstrmojo-WebButton hot",text:I(547,"Select"),onclick:function(){var a=this.parent.parent;a.opener.handleSuggestionItemSelect(a.list.selectedItem);}},{scriptClass:"mstrmojo.Button",cssClass:"mstrmojo-Button mstrmojo-WebButton",text:I(221,"Cancel"),onclick:function(){this.parent.parent.close();}}]},defaultOnTokensModify:function(){this.set("vStatus",Q.UNKNOWN);this.set("iStatus","");},postBuildRendering:function Y(){this._super();this.inputBox.attachEventListener("tokensModify",this.id,"defaultOnTokensModify");this.inputBox.attachEventListener("tokensModify",this.id,"ontokensModify");},updateInputBoxItems:function H(a){this.inputBox.set("items",a.items);},replaceErrorToken:function C(a){this.inputBox.replaceErrorToken(a);},clientSideValidation:function A(g){if(!g){return ;}var c=false,f=false,b=g.items;try{c=mstrApp.rootCtrl.docCtrl.model.isMDXDataset(S.any(this.parent.parent.datasets));f=g.met==N.ADVANCED&&b[0].tp==O.SimpPrefixFun&&b[0].v==="ApplySimple";}catch(h){}if(c&&f){var a=M.filterOne(b,function(e){return e.tp===O.DoubleQString;});var d=/(\'|\/\/|\-\-|\/\*|\*\/)/;if(a&&d.test(a.v)){g.vs=Q.ERROR;g.rjec=U.ERROR;g.rjed=I(15665,"MDX pass-through expression should not contain ', //, --, /*, */.");}}},handleValidation:function F(a){if(!a){this.set("vStatus",Q.ERROR);return ;}a.vs=P(a.rjec);this.set("vStatus",a.vs);this.set("iStatus",mstrmojo.string.encodeHtmlString(a.rjed)||"");this.updateInputBoxItems(a);this.inputBox.focus();if(a.vs===Q.AMBIGUITY){var l=this,h=a.items,g=M.find(h,"sta",-1),b=h[g].v,j=function(c){l.replaceErrorToken(c);l.set("iStatus","");l.set("vStatus",Q.UNKNOWN);if(l.continueValidataion){l.continueValidataion();}else{l.set("vStatus",Q.VALID);}};var d=M.filter(a.srfd.items,this.isObjectVisible);var k=this.parent.candidates,e=k&&k.items;if(e){M.forEach(d,function(f){var c=M.find(e,"did",f.did);if(c===-1){if(this.absorbAmbiguity){e.push(f);}}else{f.path=e[c].path;}});}if(d.length===1){j(d[0]);return ;}this.openPopup("ambiguityDialog",{zIndex:100,items:d,ambiguousName:b,onItemSelect:j});}else{if(this.postHandleValidation){this.postHandleValidation();}}},tooltip:"",useRichTooltip:true,updateTooltipConfig:function X(b){var c=b.target||E.eventTarget(b.hWin,b.e),a=E.position(c);this.richTooltip={posType:mstrmojo.tooltip.POS_TOPLEFT,content:this.getTooltipContent(b),top:a.y+a.h,left:a.x+10,cssClass:"vi-regular vi-tooltip-A"};},getTooltipContent:function(a){return this.iStatus;},showTooltip:function D(a,b){if(a.target===this.iStatusNode){this._super(a,b);}}});mstrmojo.ME.MetricEditBox.VALIDATION_STATUS=Q;mstrmojo.ME.MetricEditBox.VALIDATION_STATUS_CSS=G;mstrmojo.ME.MetricEditBox.VALIDATION_STATUS_DESC=R;}());(function(){mstrmojo.requiresCls("mstrmojo.css","mstrmojo.dom","mstrmojo.expr","mstrmojo.range","mstrmojo.array","mstrmojo.WidgetListMapper","mstrmojo._HasSuggestion","mstrmojo.qb.FFsqlToken","mstrmojo.warehouse.EnumDataChangeEvents");var r=mstrmojo.dom,M=mstrmojo.array,P=mstrmojo.hash,AS=mstrmojo.Enum_Keys,o=mstrmojo.range,U=mstrmojo.string,AH=o.EDGE,AU=mstrmojo.qb.FFsqlToken.isDelimiter,E=150000,AL=67,S=86,AP=88,h=90,AW="\n",q="\t",L=" ",J="c",Aa="v",X="x",t="z",AK="a",z=";",AB=".",AN="[",p="]",K="addTable",H="addColumn",AF="compositionstart",e="compositionupdate",u="compositionend",AO="DOMCharacterDataModified",j="paste",G=mstrmojo.warehouse.EnumDataChangeEvents;function AV(Ad){var Ac=(r.isIE&&!r.isIE9)?Ad.keyCode:Ad.charCode;return(Ac>0)?String.fromCharCode(Ac):null;}var V,AY=100,g={" ":true,"\t":true,"\n":true},A=["select","update","insert","delete","create","drop","alter","set","exec"],W=A.concat(["from","where","having","in","group","by","order","into","on","values","table","case","then","else","join","as"]),AM={};W=W.concat(["left","right","full","outer"]);function Z(){if(!V){V=[];M.forEach(W,function(Ac){V.push({n:Ac,sta:AY,t:AY});});}return V;}function R(){return{v:AW,isDelimiter:true,isNew:true,did:this.itemCount++};}function C(){return{v:L,isDelimiter:true,isNew:true,did:this.itemCount++};}mstrmojo.qb.FFsqlInput=mstrmojo.declare(mstrmojo.ME.TokenInputBox,null,{scriptClass:"mstrmojo.qb.FFsqlInput",renderBlockSize:50000,renderOnScroll:false,init:function w(Ad){this._super(Ad);var Af={},Ae=this,Ac=Af[this.id]={};Ac.sqlTokensAdded=this.onsqlTokensAdded;Ac[G.DBROLE_CHANGED]=function Ag(){mstrApp.getRootController().enableButton(Ae.getSQLstmt());};Ac[G.DBTABLES_ENABLED]=function(Ah){if(this.parent.visible){this.editNode.contentEditable=Ah.value?"true":"false";}};mstrApp.getRootController().attachDataChangeListeners(Af);this.autoSelect=false;this.openPopup("suggestionPopup");this.suggestionPopup.close();this.autoSelect=true;},itemFunction:function AR(Ad,Ac,Ae){return new mstrmojo.qb.FFsqlToken({data:Ad});},item2textCss:function AJ(Ac){return" mstrmojo-qb-SuggestIcon t"+Ac.t;},itemIdField:"did",itemCount:0,ostack:[],sqlTokens:Z(),browseItemVisible:false,customFunctionVisible:false,raiseChangeEvent:function(Ae){var Ad=U.trim(this.getSQLstmt()),Ac=mstrApp.getRootController();Ae.name="tokensModify";this.raiseEvent(Ae);Ac.enableButton(Ad);if(!Ad&&Ac.canAddTableSQL(true,Ad)){Ac.enableAvailableTables();}},getSQLstmt:function(){if(!this.items){return"";}var Ac=[];M.forEach(this.items,function(Ae,Ad){Ac[Ad]=Ae.v;});return Ac.join("");},onsqlTokensAdded:function x(Ac){var Af=Ac.value,Ae=this.itemCount,Ad=this.items;if(Ae>0&&Ad[Ae-1]!==AW){Ad.push({isNew:true,v:AW,isDelimiter:true,did:Ae++});}M.forEach(Af,function(Ag){Ag=P.copy({isNew:true,did:Ae++},Ag);});Ad=Ad.concat(Af);this.itemCount=Ae;this.set("items",Ad);this.parent.updatepasses();},postBuildRendering:function AZ(){var Ac=this.editNode;if(this._super){this._super();}r.detachEvent(Ac,AF,this.oncompositionstart);r.detachEvent(Ac,e,this.oncompositionupdate);r.detachEvent(Ac,u,this.oncompositionend);if(r.isIE9||r.isIE10||r.isIEW3C){r.detachEvent(Ac,AO,this.ondomcharmodifed);}r.attachEvent(Ac,AF,this.oncompositionstart);r.attachEvent(Ac,e,this.oncompositionupdate);r.attachEvent(Ac,u,this.oncompositionend);if(r.isIE9||r.isIE10||r.isIEW3C){r.attachEvent(Ac,AO,this.ondomcharmodifed);}mstrApp.getRootController().attachEventListener("failureLabel",this.id,function(Ad){this.markFailureLabel(Ad.value);});},handlekeydown:function Y(Al){var Aw=this,Ae=Al.keyCode||Al.charCode;if(this.editNode.contentEditable==="false"){return true;}if(this._inComposition){return true;}if(Aw._inHandleImeInputTimeout&&Ae===AS.ENTER){window.setTimeout(function(){Aw.handlekeydown(Al);},0);r.stopPropogation(window,Al);r.preventDefault(window,Al);return false;}Al=Al||window.event;var Ac,Ar=false,Aj=o.getRangeInfo(),Ad=Aj.range.startContainer,At=Aj.range.startOffset;switch(Ae){case AS.DELETE:if(!this.doubleByte){try{this.widgetHandleDelete(Aj);this.startTokenSuggestion();this.raiseChangeEvent({type:"delete"});this.parent.updatepasses();}catch(Aq){}Ar=true;}break;case AS.BACKSPACE:if(!this.doubleByte){try{this.widgetHandleBackspace(Aj);this.raiseChangeEvent({type:"backspace"});this.startTokenSuggestion();}catch(Ap){}Ar=true;}break;case AS.ENTER:if(this.suggestionShown){Ac=this.getSelected();if(Ac){this.handleSuggestionItemSelect(Ac);if(this.candidates.isCol){this.set("candidates",{items:mstrApp.getRootController().getFFsqlComp(),isComplete:true});}}this.hideSuggestion();}else{var Ag,Af,Am,Au=this.ctxtBuilder.itemWidgets,Ax,Av=null;Af=r.findWidget(Ad);if(Af.data!==undefined){Ag=o.getEdgeInfo(Ad,At);Am=this.itemIndex(Af.data);Ax=Au[Am].data.v===AW;}else{Ag=AH.EDGE_END;Am=-1;Ax=false;}if(r.isFF){Av=this.itemsContainerNode.scrollTop;}if(Ag===AH.EDGE_MIDDLE){if(Ax){this.add([C.call(this),R.call(this),C.call(this)],Am);Am=Am+3;}else{var Ak=Af.split2Tokens(Aj.startOffset,this.itemCount++);this.remove(Am);this.add([Ak[0],R.call(this),Ak[1]],Am);Am=Am+1;}}else{if(Ag===AH.EDGE_BEGIN){this.add([C.call(this),R.call(this)],Am);Am=Am+1;}else{Am=Am+1;this.add([C.call(this),R.call(this),C.call(this)],Am);Am=Am+1;}}if(r.isFF||r.isIE||r.isIEW3C){Am=Ax?Am:Am+1;Af=Au[Am];this._delaySetCaretPos(Af.domNode,true);}else{Af=Au[Am];this._delaySetCaretPos(Af.domNode,false);}this.delayedScrollToItem(Am,Av);this.parent.updatepasses();}Ar=true;break;case AS.TAB:if(this.suggestionShown){Ac=this.getSelected();if(Ac){this.handleSuggestionItemSelect(Ac);if(this.candidates.isCol){this.set("candidates",{items:mstrApp.getRootController().getFFsqlComp(),isComplete:true});}}}else{this.startTokenSuggestion();}Ar=true;break;case AS.ESCAPE:this.endTokenSuggestion();Ar=true;break;case AL:if(Al.ctrlKey||Al.metaKey){this.ctrx=false;Ar=false;}break;case S:if(Al.ctrlKey||Al.metaKey){this._saveRangeInfo=o.getRangeInfo();if(!this._saveRangeInfo.collapsed){this.widgetDeleteTokens(this._saveRangeInfo);this._saveRangeInfo=o.getRangeInfo();}if(this.ctrx){this.handlepaste(this.cutstr);Ar=true;}else{this.clipboardNode.focus();Ar=false;}this.parent.updatepasses();}break;case AP:if(Al.ctrlKey||Al.metaKey){try{var Ai=document.createElement("div");Ai.appendChild(Aj.range.cloneContents());Ai.innerHTML=Ai.innerHTML.replace(/<br\>/gi,"\n");this.cutstr=Ai.textContent.replace(/\u00A0/gi," ");this.widgetHandleDelete(Aj);this.startTokenSuggestion();this.ctrx=true;this.raiseChangeEvent({type:"cut"});}catch(Ao){}Ar=true;}break;case h:if(Al.ctrlKey||Al.metaKey){try{var Ah=this.ostack,As=Ah.length;if(As>1){Ah.pop();this.set("items",Ah[As-2].its);this.parent.updatepasses();this.focus();this.raiseChangeEvent({type:"undo"});}}catch(An){}Ar=true;}break;case AS.LEFT_ARROW:case AS.RIGHT_ARROW:this.endTokenSuggestion(true);break;case 229:if(!this.doubleByte){this.doubleByte=true;this.prev_rInfo=Aj;this.prev_items=this.items;}break;}if(Ar){r.stopPropogation(window,Al);r.preventDefault(window,Al);return false;}return true;},handlekeypress:function N(Ac){if(this.editNode.contentEditable==="false"){return true;}if(this._inComposition){return true;}Ac=Ac||window.event;var Ag=AV(Ac),Ad=false,Ae=this,Af;function Ah(){try{this.widgetHandleInput(o.getRangeInfo(),Ag);this.raiseChangeEvent({type:"input",characeter:Ag});var Ai=this._saveActiveToken;if(!AU(Ag)){if(!Ai){Af=this.findObjectToken();if(Af&&!Af.isDelimiter()){this._saveActiveToken=Ai=Af;}}if(Ai&&Ag===AB){var Ak=AM[Ai.data.v.toLowerCase().slice(0,-1)];if(Ak){if(Ak.columns){this.startTokenSuggestion();}else{var Al=this;mstrApp.getRootController().getColumnsForDBTable({data:Ak},{success:function Am(Ap){var Ao=Ap.items,An=[],Aq=Ai.data.v;Ak.columns=Ao;M.forEach(Ao,function(Ar){An.push({n:Aq+Ar.n,sta:2,t:26});});Al.set("candidates",{items:Al.candidates.items.concat(An),isComplete:true});Al.startTokenSuggestion();}});}}else{Ai.isCol=false;Ai.col=null;this.startTokenSuggestion();}}else{this.startTokenSuggestion();}}else{this.endTokenSuggestion(true);}}catch(Aj){}}if(Ag&&!((Ag===J||Ag===X||Ag===Aa||Ag===t||Ag===AK)&&(Ac.ctrlKey||Ac.metaKey))){if(Ae._inHandleImeInputTimeout||(r.isIE||r.isIEW3C)){if(Ae._inHandleImeInputTimeout&&(r.isIE9||r.isIE10||r.isIEW3C)&&Ag===" "){}else{window.setTimeout(function(){Ah.call(Ae);},1);}}else{Ah.call(Ae);}Ad=true;}if(Ad){r.stopPropogation(window,Ac);r.preventDefault(window,Ac);return false;}return true;},handlekeyup:function O(Ae){var Af,Ac,Ad;if(this.doubleByte&&!this._inComposition){Af=this.prev_rInfo;Ac=o.getRangeInfo();Ad=Ac.startContainer.data.slice(Af.startOffset,Ac.startOffset);if(Ad){this.widgetHandleImeInput(Af,Ad);}this.doubleByte=false;}else{if(this._super){this._super(Ae);}}},oncompositionstart:function c(Ac){var Ad=r.findWidget(this);Ad._inComposition=true;Ad.doubleByte=true;Ad._savedCompositionData=null;if(!Ad._compositionDataArr){Ad.prev_rInfo=o.getRangeInfo();Ad.prev_items=Ad.items;Ad._compositionDataArr=[];Ad._savedCompositionData=null;Ad._beforeCompositionDOMChars=null;Ad._hasBeforeCompositionDOMChars=false;Ad._compositionDOMChars=null;}},oncompositionupdate:function Ab(Ac){var Ad=r.findWidget(this);if(Ad._inComposition){Ad._savedCompositionData=Ac.data;}},ondomcharmodifed:function d(Ac){var Ag=r.findWidget(this),Af=Ac.newValue,Ae=Ac.prevValue,Ad;if(Ag._inComposition){if(Ag._savedCompositionData===null){Ag._beforeCompositionDOMChars=Ae;Ag._hasBeforeCompositionDOMChars=true;}else{Ag._compositionDOMChars=Af;}if(r.isIEW3C&&!Ag._hasBeforeCompositionDOMChars){Ad=Af.length<=Ae.length?Af:Ae;Ag._beforeCompositionDOMChars=Ad;Ag._hasBeforeCompositionDOMChars=true;}}},oncompositionend:function I(Ac){var Af=r.findWidget(this),Ad=Af.prev_rInfo,Ag=Ad.range.startOffset,Ah,Ae;Af._inComposition=false;Af.doubleByte=false;Ae=Ac.data||Af._savedCompositionData;if(Ae!==null&&Ae!==undefined){Af._compositionDataArr.push(Ae);}if(r.isIE9||r.isIE10||r.isIEW3C){if(Af._compositionDOMChars&&Af._compositionDOMChars.length){if(Af._beforeCompositionDOMChars!==null){Ah=Af._compositionDOMChars.substr(Math.min(Ag,Af._beforeCompositionDOMChars.length),Af._compositionDOMChars.length-Af._beforeCompositionDOMChars.length);}else{Ah=Af._compositionDOMChars;}if(Ah.length){Af._compositionDataArr=Ah.split("");}}}if(Af._compositionDataArr.length){Af._inHandleImeInputTimeout=true;window.setTimeout(function(){Af._inHandleImeInputTimeout=false;if(!Af._inComposition&&Af._compositionDataArr){if(r.findWidget(Ad.startContainer.parentNode?Ad.startContainer:Ad.range.startContainer)){Ae=Af._compositionDataArr.join("");Af._compositionDataArr=null;Af.widgetHandleImeInput(Ad,Ae);Af.raiseChangeEvent({type:"insert"});}}},0);}},markFailureLabel:function AQ(Ac){this.pnum=Ac;this.parent.updatepasses();},getPassLabelYCoords:function a(){var Ae=[],Ad=this.ctxtBuilder.itemWidgets,Ah=true,Ac=r.position(this.domNode).y,Ag,Af;M.forEach(Ad,function(Ai){Ag=Ai.data;Af=Ag.v;if(Ah&&!g[Af]){if(Af&&M.indexOf(A,Af.toString().toLowerCase())>-1){Ae.push(r.position(Ai.domNode).y-Ac);}Ah=false;}else{if(Af===z){Ah=true;}}});if(Ae.length===1){Ae=[];}return Ae;},widgetHandleBackspace:function AC(Ah){if(Ah.collapsed){var Ad=this._saveActiveToken,Ae,Aj;if(Ad&&Ad.data){Aj=Ad.data.v;if(Aj&&Aj[Aj.length-1]===AB&&Ad.isCol){this.set("candidates",{items:mstrApp.getRootController().getFFsqlComp(),isComplete:true});Ad.isCol=false;Ad.col=null;}}var Ac,Ag,Ak,Ai=Ah.startOffset,Af=this.ctxtBuilder.itemWidgets;if(!r.contains(this.editNode,Ah.startContainer,false,document.body)){if(Ah.startOffset>0&&r.isFF){Ag=Af[this.items.length-1];o.collapseOnNode(Ag.domNode,false);Ah=o.getRangeInfo();Ac=o.getEdgeInfo(Ah.range.startContainer,Ah.range.startOffset);}else{o.collapseOnNode(this.editNode,true);return ;}}Ac=o.getEdgeInfo(Ah.range.startContainer,Ah.range.startOffset);Ag=r.findWidget(Ah.range.startContainer);Ak=this.itemIndex(Ag.data);if(Ac===AH.EDGE_BEGIN){Ak--;Ag=Af[Ak];Ai=Ag.length();}if(!Ag){o.collapseOnNode(this.editNode,true);return ;}if(Ag.length()<=1){this.remove(Ak);if(Ag.data.v===z||Ag.data.v===AW){this.parent.updatepasses();}Ag=Af[Ak-1];if(Ag){o.collapseOnNode(Ag.domNode,false);this.checkMergeTwoTokens(Ak-1,Ak);Ag=Af[Ak-1];}else{o.collapseOnNode(this.editNode,true);}}else{Ag.spliceContent(Ai-1,1);if(Ag.isCol){this.set("candidates",{items:Ag.col,isComplete:true,isCol:true});}o.collapseOnTextNode(Ag.domNode,Ai-1);}}else{this.widgetDeleteTokens(Ah);this.parent.updatepasses();}},onpaste:function AI(Ac){var Ae=r.findWidget(this),Af,Ad;if(!Ae){return ;}if(Ac&&Ac.clipboardData&&Ac.clipboardData.getData){Af=Ac.clipboardData.getData("text/plain");}else{if(window.clipboardData&&window.clipboardData.getData){Af=window.clipboardData.getData("Text");}}if(typeof Af!=="string"){return ;}Ad=Af.replace(/\r/g,"");if(Ad===""){return ;}Ae.handlepaste(Ad);r.stopPropogation(window,Ac);r.preventDefault(window,Ac);return false;},handlepaste:function m(Ad){var Ae;if(typeof Ad!=="string"){Ae=this.clipboardNode.value;}else{Ae=Ad;}this.clipboardNode.value="";var Ai=[],Ac=Ae&&Ae.length,Af,Ag="",Ah;if(Ac>E){Ai.push({v:Ae,isNew:true,did:this.itemCount++});this.insertTokens(Ai);}else{if(Ac>0){for(Af=0;Af<Ac;Af++){Ah=Ae.charAt(Af);if(AU(Ah)){if(!U.isEmpty(Ag)){Ai.push({v:Ag,isNew:true,did:this.itemCount++});Ag="";}Ai.push({v:Ah,isDelimiter:true,isNew:true,did:this.itemCount++});}else{Ag=Ag+Ah;}}if(!U.isEmpty(Ag)){Ai.push({v:Ag,isNew:true,did:this.itemCount++});}this.insertTokens(Ai);}}},insertTokens:function l(Ai){var Ah=this._saveRangeInfo,Ae,Ag,Af,Ac;if(!Ah||!r.contains(this.editNode,Ah.startContainer,false,document.body)){this.add(Ai);Ae=this.ctxtBuilder.itemWidgets;Ac=Ae.length-1;Ag=Ae[Ac];this._delaySetCaretPos(Ag.domNode,false);this.delayedScrollToItem(Ac);this.raiseChangeEvent({type:"insert"});return ;}Af=o.getEdgeInfo(Ah.startContainer,Ah.startOffset);Ag=r.findWidget(Ah.startContainer);Ac=this.itemIndex(Ag.data);if(Af===AH.EDGE_MIDDLE){var Ad=Ag.split2Tokens(Ah.startOffset,this.itemCount++);this.remove(Ac);Ai.unshift(Ad[0]);Ai.push(Ad[1]);this.add(Ai,Ac);}else{Ac=(Af===AH.EDGE_BEGIN?Ac:Ac+1);this.add(Ai,Ac);}Ac=Ac+Ai.length-1;Ag=this.ctxtBuilder.itemWidgets[Ac];this._delaySetCaretPos(Ag.domNode,false);this.delayedScrollToItem(Ac);this.raiseChangeEvent({type:"insert"});},widgetHandleInput:function AE(Ak,Ai){if(!Ak.collapsed){this.widgetDeleteTokens(Ak);Ak=o.getRangeInfo();}var Ad,Ah,Ap,Ae,Al,Am,Ag=this.ctxtBuilder.itemWidgets,Ao=this,An=Ak.startContainer,Ac=Ak.startOffset,Af;if(!r.contains(this.editNode,An,false,document.body)||!Ag||Ag.length===0){this.add([{v:Ai,isDelimiter:AU(Ai),isNew:true,did:this.itemCount++}],0);Ah=Ag[0];o.collapseOnTextNode(Ah.domNode,1);this.delayedScrollToItem(0);return ;}Ad=o.getEdgeInfo(An,Ac);Ah=r.findWidget(An);Ap=this.itemIndex(Ah.data);if(AU(Ai)){if(this.candidates.isCol){this.set("candidates",{items:mstrApp.getRootController().getFFsqlComp(),isComplete:true});}Ae={v:Ai,isDelimiter:true,isNew:true,did:this.itemCount++};if(Ad===AH.EDGE_MIDDLE){var Aj=Ah.split2Tokens(Ac,this.itemCount++);this.remove(Ap);this.add([Aj[0],Ae,Aj[1]],Ap);Ap=Ap+1;}else{Ap=(Ad===AH.EDGE_BEGIN)?Ap:Ap+1;this.add([Ae],Ap);}Ah=Ag[Ap];o.collapseOnNode(Ah.domNode,false);this._delaySetCaretPos(Ah.domNode,false);if(Ai===z){this.parent.updatepasses();}}else{Am=Ac;if(Ah.isDelimiter()){Al=Ag[(Ad===AH.EDGE_BEGIN)?Ap-1:Ap+1];if(Al&&!Al.isDelimiter()){Ah=Al;Am=(Ad===AH.EDGE_BEGIN)?Ah.length():0;}Ap=(Ad===AH.EDGE_BEGIN)?Ap:Ap+1;this.add([{v:Ai,isNew:true,did:this.itemCount++}],Ap);Ah=Ag[Ap];o.collapseOnNode(Ah.domNode,false);this.parent.updatepasses();}else{Af=Ah.data.v;Ak=o.getRangeInfo();Ah.spliceContent(Am,0,Ai);if(r.isIE||r.isIEW3C){o.collapseOnTextNodeIE(Ah.domNode,Am+1);window.setTimeout(function(){Ao.editNode.focus();Ao.editNode.focus();o.collapseOnTextNodeIE(Ah.domNode,Am+1);},0);}else{o.collapseOnTextNode(Ah.domNode,Am+1);this._delaySetTextCaretPos(Ah.domNode,Am+1);}}}this.delayedScrollToItem(Ap);},widgetHandleImeInput:function b(Aj,Ac){if(!Aj.collapsed){this.widgetDeleteTokens(Aj);Aj=o.getRangeInfo();}var Ae,Ah,Ao,Ak,Al,Ag=this.ctxtBuilder.itemWidgets,An=this,Ai,Am=Aj.range.startContainer,Ad=Aj.range.startOffset,Af=this.itemsContainerNode.scrollTop;if(!r.contains(this.editNode,Am,false,document.body)||!Ag||Ag.length===0){this.clearTokens();this.add([{v:Ac,isDelimiter:this.isDelimiter(Ac),isNew:true,did:this.itemCount++,isIME:true}],0);Ag=this.ctxtBuilder.itemWidgets;Ah=Ag[0];o.collapseOnTextNode(Ah.domNode,Ah.data.v.length||1);this._delaySetCaretPos(Ah.domNode,false);this.delayedScrollToItem(0,Af);return ;}Ae=o.getEdgeInfo(Am,Ad);Ah=r.findWidget(Am);Ao=this.itemIndex(Ah.data);Al=Ad;if(Ah.isDelimiter()){this.clearTokens();this.set("items",this.prev_items);Ag=this.ctxtBuilder.itemWidgets;Ai=(Ae===AH.EDGE_BEGIN)?Ao-1:Ao+1;Ak=Ag[Ai];if(Ak&&!Ak.isDelimiter()){Ah=Ak;Al=(Ae===AH.EDGE_BEGIN)?Ah.length():0;Ao=Ai;}}if(!Ah.isDelimiter()){Ah.spliceContent(Al,0,Ac);if(r.isIE||r.isIEW3C){o.collapseOnTextNodeIE(Ah.domNode,Al+Ac.length);window.setTimeout(function(){An.editNode.focus();An.editNode.focus();o.collapseOnTextNodeIE(Ah.domNode,Al+Ac.length);},0);}else{o.collapseOnTextNode(Ah.domNode,Al+Ac.length);this._delaySetTextCaretPos(Ah.domNode,Al+Ac.length);}}else{Ao=(Ae===AH.EDGE_BEGIN)?Ao:Ao+1;this.add([{v:Ac,isNew:true,did:this.itemCount++}],Ao);Ah=Ag[Ao];o.collapseOnNode(Ah.domNode,false);this._delaySetCaretPos(Ah.domNode,false);}this.delayedScrollToItem(Ao,Af);this.startTokenSuggestion();return Ah;},getSearchPattern:function AD(){var Ad=this._saveActiveToken,Af,Ac;if(Ad.isCol){var Ae=Ad.data.v;Af=Ae.slice(Ae.lastIndexOf(AB)+1,Ae.length);}else{Af=Ad&&Ad.data.v;}Ac=Af&&Af.length;if(Ac>2){if(Af.charAt(0)===AN){Af=Af.substring(1);}if(Af.charAt(Af.length-1)===p){Af=Af.substring(0,Af.length-1);}}return Af;},getSuggestionPos:function AT(){var Ak=this._saveActiveToken,Ag=null,Ae,Ai=0;if(Ak&&Ak.isCol){Ai=Ak.domNode.offsetWidth;}if(Ak){Ae=r.position(Ak.domNode,true);var Al=Math.round(Ae.y+Ae.h),Ah=this.suggestionItems.length*19,Aj=mstrmojo.all.QBuilderPage,Ac=parseInt(Aj.height,10),Ad=r.position(Aj.domNode,true),Af=(Ac>Al-40-Ad.y+Ah)?Al:Ae.y-Ah;Ag={left:Math.round(Ae.x)+Ai+"px",top:Af+"px",zIndex:100};}return Ag;},onSuggestionItemSelect:function AG(Ae){var Ad=this._saveActiveToken,Af,Ah=this;this.endTokenSuggestion();if(Ae.t===-98){Af=this.items;this.clearTokens();M.forEach(Af,function(Ak){Ak.did=Ah.itemCount++;});this.customFunctionMode=true;Af=[{v:"{",isDelimiter:true,sta:1,isNew:true,did:this.itemCount++}].concat(Af).concat([{v:"}",isDelimiter:true,sta:1,isNew:true,did:this.itemCount++}]);this.set("items",Af);var Ac=this.itemIndex({did:this.itemCount-1}),Aj=this.ctxtBuilder.itemWidgets[Ac-1];this._delaySetCaretPos(Aj.domNode,false);}else{if(Ad){if(Ad.isCol){var Ag=Ad.data.v,Ai={};P.copy(Ae,Ai);Ai.n=Ag.slice(0,Ag.lastIndexOf(AB)+1)+Ae.n;Ad.setItemInfo(Ai);}else{Ad.setItemInfo(Ae);}this._delaySetCaretPos(Ad.domNode,false);}}},ontokensModify:function(Ac){this.ostack.push({its:P.cloneArray(this.items)});this.pnum=-1;this.parent.updatepasses();},dropZone:true,allowDrop:function B(Ac){return(Ac.action===K||Ac.action===H);},getAvatarIconClass:function D(Ac){return"enabled";},ondragenter:function F(Ac){var Ad=Ac.src.widget;if(Ad&&Ad.toggleAvatarClass&&this.allowDrop(Ac)){Ad.toggleAvatarClass(this.getAvatarIconClass(Ac),true);}},ondragleave:function f(Ac){var Ad=Ac.src.widget;if(Ad&&Ad.toggleAvatarClass&&this.allowDrop(Ac)){Ad.toggleAvatarClass(this.getAvatarIconClass(Ac),false);}},ondragover:function n(Ah){var Ae=Ah.tgt.widget,Am=Ah.tgt.pos.x,Al=Ah.tgt.pos.y;var Aj=Ae.ctxtBuilder.itemWidgets,Ag=Aj.length;if(Ag===0){return ;}var Af=Aj[Ag-1].domNode,Ai=r.position(Af),Ad;if(Al>Ai.y+Af.clientHeight){Ae._delaySetCaretPos(Af,false);}else{for(Ad=Ag-1;Ad>-1;Ad--){if(Aj[Ad].data.v===AW||Aj[Ad].data.v===q){continue;}var Ak=Aj[Ad].domNode,Ac=r.position(Ak).y;if(Ac<Al&&!(Ac+14<Al)){Ae._delaySetCaretPos(Ak,false);break;}}}},ondrop:function(Ad){var Ag=Ad.action,Aj=Ad.src,Ac=mstrApp.getRootController(),Af=this;if(Aj&&Aj.data){var Ai=Aj.data;if(Ag===K){var Ah=Aj.widget.dataHelper;if(!Ac.canAddTableSQL()){return ;}M.forEach(Ai,function(Al){Ah.fetch(Al,{success:function Ak(Am){Ac.addTableSQL(Al,Am.items);Ac.enableButton(Af.getSQLstmt());}});});}else{if(Ag===H){if(!Ac.canAddTableSQL()){return ;}var Ae=Aj.widget.items[parseInt(Ai._renderIdx.split(":")[0],10)];Ac.addTableSQL(Ae,[Ai]);Ac.enableButton(Af.getSQLstmt());}}}},onscroll:function(Ac){if(r.isIE8){editNode=Ac.srcElement;}if(this.parentNode){mstrmojo.all[this.parentNode.id].parent.updatepasses();}},onRender:function Q(){if(this.hasRendered){r.attachEvent(this.editNode,"scroll",this.onscroll);this.itemsContainerNode.style.height="100%";}},addCandidateTables:function AX(Ac){var Ad=[],Ae,Af=Ac.value;AM={};M.forEach(Af,function(Ag){Ae=Ag.ns?Ag.ns+AB+Ag.n:Ag.n;Ad.push({n:Ae,sta:2,t:15});AM[Ae.toLowerCase()]=Ag;});this.set("candidates",{items:this.sqlTokens.concat(Ad).concat(mstrApp.getRootController().getSuggestionItems(true)),isComplete:true});},scrollToItem:function k(Ai,Ae){var Ac=this.itemsContainerNode,Ag=Ac.childNodes[Ai],Ah,Ad,Af=Ac.clientHeight,Aj;if(typeof Ae!=="number"){Ae=Ac.scrollTop;}Ad=Ae;if(!Ag){return ;}Aj=Ag.offsetHeight;Ah=Ag.offsetTop;if(Ah<Ae){Ad=Ah;}else{if(Ae+Af<Ah+Aj){Ad=Math.min(Ah,Ah+Aj-Af);}}Ac.scrollTop=Ad;},delayedScrollToItem:function AA(Ae,Ac){var Ad=this;if(typeof Ac!=="number"){Ac=this.itemsContainerNode.scrollTop;}window.setTimeout(function(){Ad.scrollToItem(Ae,Ac);},0);}});}());(function(){mstrmojo.requiresCls("mstrmojo.ValidationTextBox","mstrmojo.Calendar","mstrmojo.Popup","mstrmojo._HasPopup","mstrmojo.locales","mstrmojo.date","mstrmojo.string");var B=mstrmojo.ValidationTextBox.prototype.markupMethods,D=mstrmojo.string,A=function(){return mstrmojo.locales.datetime;},C=mstrmojo.date;mstrmojo.DateTextBox=mstrmojo.declare(mstrmojo.ValidationTextBox,[mstrmojo._HasPopup],{scriptClass:"mstrmojo.DateTextBox",calendarToBody:false,calendarZIndex:100,changeValueOnOK:false,dynDateValue:null,showAdvanced:false,canSelectDisabledDate:false,isList:false,dtp:14,defaultDate:null,autoFormat:true,enabled:true,min:"",max:"",markupString:'<div id="{@id}" class="mstrmojo-DateTextBox {@cssClass}" style="{@cssText}"><input class="mstrmojo-DateTextBox-input" type="text" title="{@tooltip}"value="{@value}" size="{@size}" maxlength="{@maxLength}" index="{@tabIndex}" mstrAttach:focus,keyup,blur /><div class="mstrmojo-DateTextBox-icon" mstrAttach:click> </div><div class="mstrmojo-DateTextBox-popup"></div></div>',markupSlots:{inputNode:function(){return this.domNode.firstChild;},iconNode:function(){return this.domNode.childNodes[1];},popupNode:function(){return this.domNode.lastChild;}},markupMethods:{onvisibleChange:function(){this.domNode.style.display=this.visible?this.cssDisplay:"none";},onwidthChange:function(){if(this.width){this.inputNode.style.width=(this.width-20)+"px";this.iconNode.style.left=(this.width-18)+"px";this.domNode.style.width=this.width+"px";}},onvalueChange:B.onvalueChange,onenabledChange:B.onenabledChange,onvalidationStatusChange:B.onvalidationStatusChange},calConfig:null,calendar:{scriptClass:"mstrmojo.Popup",cssClass:"mstrmojo-DateTextBox-calendar",locksHover:true,slot:"popupNode",onOpen:function(){var H=this.opener,G=H&&H.calendarZIndex,I=this.cal,E=H&&H.calConfig;if(G){this.domNode.style.zIndex=G;}for(var F in E){I.set(F,E[F]);}},children:[{scriptClass:"mstrmojo.Calendar",alias:"cal",forceNonEmptySelection:true,bindings:{showAdvanced:"this.parent.opener.showAdvanced",dtp:"this.parent.opener.dtp",value:"this.parent.opener.value",dynDateValue:"this.parent.opener.dynDateValue",enabled:"this.parent.opener.enabled",min:"this.parent.opener.min",max:"this.parent.opener.max",canSelectDisabledDate:"this.parent.opener.canSelectDisabledDate",changeValueOnOK:function(){var F=this.parent.opener.dtp,E=this.parent.opener.changeValueOnOK;return F===15||F===16||E;}},closeOnValueChange:true,onValueUpdate:function(F){var I=this.parent&&this.parent.opener;if(I){var G=I.value,E=window.mstrConfig&&window.mstrConfig.listSep||";",H=I.dtp===15?C.formatTimeInfo(this.timeVal,A().TIMEOUTPUTFORMAT):this.value;if(I.isList&&!D.isEmpty(G)){I.set("value",I.value+E+H);}else{I.set("dynDateValue",this.dynDateValue);I.set("value",H);}I.closePopup();}}}]},onclick:function(E){var F=this._lastOpened,G=this._calendarConfig;if(!G){G={};if(this.calendarToBody){delete this.calendar.slot;G.placeholder=document.body.appendChild(document.createElement("div"));G.nudge=function(){var M=this.opener;if(M){var H=mstrmojo.dom.position(M.popupNode,true),L=this.domNode,P=L.offsetHeight,I=L.offsetWidth,J=mstrmojo.dom.windowDim(),K=H.x,N=H.y;if(N+P>=J.h){N=Math.max(N-P,0);}if(K+I>=J.w){K=Math.max(K-I,0);}var O=L.style;O.top=N+"px";O.left=K+"px";}};}this._calendarConfig=G;}G.lockIW=this;if(F&&F.visible){this.closePopup();}else{this.openPopup("calendar",G);this.calendar.cal.updateSelectedDate(true);}},unrender:function(){this._super();if(this.calendarToBody&&this._calendarConfig){delete this._calendarConfig;}if(this.calendar.hasRendered){this.calendar.unrender();}},_set_value:function(H,F){var G=this.value,E=(G!==F);if(E){this.value=F;this.validate(F);}if(this.showAdvanced&&this.dynDateChanged){this.dynDateChanged=false;E=true;}return E;},_set_dynDateValue:function(H,F){var G=this.dynDateValue,E=(G!==F);if(E){this.dynDateValue=F;this.dynDateChanged=true;}return E;}});})();(function(){mstrmojo.requiresCls("mstrmojo.func","mstrmojo.dom","mstrmojo.hash","mstrmojo.ServerProxy","mstrmojo.XHRServerTransport","mstrmojo.LoginEditor","mstrmojo.util.ThemeHelper","mstrmojo.SessionManager");function Q(j,g){var h=(g?"add":"remove")+"LoadingGraph";this.serverProxy[h](j);}var M=true,R=mstrmojo.hash,P="waitBox",W=".htm";function A(g){return g&&(g.sections||g.subsections||g.objects||g.panels||g.layouts||g.children);}mstrmojo._IsWebApp=mstrmojo.provide("mstrmojo._IsWebApp",{_mixinName:"mstrmojo._IsWebApp",serverProxy:null,init:function Z(g){this._super(g);if(!this.serverProxy){this.serverProxy=new mstrmojo.ServerProxy({transport:mstrmojo.XHRServerTransport});}},start:mstrmojo.emptyFn,styleName:"RWDocumentMojoStyle",modelFactory:null,enableWaitBox:false,primaryScdpMap:{},onMobileDevice:function E(){return false;},isTouchApp:function H(){return false;},getContentDimensions:function e(g){return null;},getConfiguration:mstrmojo.emptyFn,setInteractive:function L(g){if(M!==g){M=g;mstrmojo.dom.toggleSelection(window.document.body,g);return true;}return false;},isInteractive:function c(){return M;},addLoadingGraph:function G(g){Q.call(this,g,true);},removeLoadingGraph:function a(g){Q.call(this,g);},serverRequest:function V(n,o,h){try{o=o||{};h=h||{};var k=h.src||(arguments.callee&&arguments.callee.caller.name),g=!this.enableWaitBox||h.silent,m=h.hideFailureErr,l=this;if(!n.noStyle){n.styleName=n.styleName||this.styleName;}o=mstrmojo.func.wrapMethods(o,{submission:function(p){if(!g&&mstrmojo.all[P]){mstrmojo.all[P].requestId=p;}},failure:function(p){if(!g){p.method=k;if(!(mstrApp.isSingleTier&&p.code===403)&&!m){mstrmojo.err(typeof p.mstrerr==="object"?p.mstrerr:p);}}},complete:function(){if(!g){if(mstrmojo.all[P]){delete mstrmojo.all[P].requestId;}l.hideWait();}}});if(!g){this.showWait(h&&h.waitBoxCfg);}window.setTimeout(function(){l.serverProxy.request(o,n,!!h.override,h);},0);}catch(j){mstrmojo.err(j);}},serverRequestParallelNative:function I(j,k,h){var g=h||new mstrmojo.QueueNative();g.queueHandle(j,k);},hasRequests:function U(){return this.serverProxy.hasRequests();},getWaitBoxPosition:function(){return null;},isWaiting:function C(){var g=mstrmojo.all[P];return !!(g&&g.visible);},showWait:function F(k){var m=this,o=mstrmojo.all[P]||mstrmojo.insert({scriptClass:"mstrmojo.Editor",id:P,cssClass:"mstrWaitBox",draggable:false,refreshOnNextShow:false,showTitle:false,zIndex:99999,counter:0,displayMsg:null,position:null,ondisplayMsgChange:function l(){this.msgfield.set("text",this.displayMsg);},oncounterChange:function h(){var q=this.counter,u=this.visible;if(q===0&&u){this.close();}else{if(q>0&&!u){this.open();mstrmojo.dom.center(this.editorNode);var p=this.position||m.getWaitBoxPosition();if(p){var t=p.top,r=p.left;if(t!==undefined){this.set("top",t+"px");}if(r!==undefined){this.set("left",r+"px");}}}}},children:[{scriptClass:"mstrmojo.Box",cssClass:"mstrIcon-wait",alias:"icon"},{scriptClass:"mstrmojo.Label",cssClass:"mstrWaitMsg",alias:"msgfield"},{scriptClass:"mstrmojo.Button",cssClass:"mstrmojo-Button mstrmojo-WebButton mstrWaitCancel",alias:"cancelBtn",text:mstrmojo.desc(2140,"Cancel")}]});o.cancelBtn.set("visible",!!(k&&k.showCancel));o.cancelBtn.onclick=function(){m.serverProxy.cancelRequests();if(k&&k.onCancel&&k.onCancel instanceof Function){k.onCancel.call(m);}};var g=k&&k.position;if(g&&((g.top||g.left)!==undefined)){o.position=k.position;}else{o.position=null;}o.set("displayMsg",(k&&k.message)||mstrmojo.desc(11960,"Loading Data..."));if(k&&k.cssClass){o.set("cssClass","mstrWaitBox "+((k&&k.cssClass)||""));o.refresh();o.refreshOnNextShow=true;}else{if(o.refreshOnNextShow){o.refresh();o.refreshOnNextShow=false;}}if(!this._waitUserLogin){o.set("counter",o.counter+1);}else{this._waitCounter=this._waitCounter+1;}var n;function j(){mstrApp.hideWait();clearTimeout(n);}if(k&&k.timeout){n=window.setTimeout(function(){j();},k.timeout);}if(k&&k._autoClose){mstrmojo.all.waitBox.curtainNode.onclick=function(){j();};}return o;},hideWait:function N(g){var h=mstrmojo.all[P];if(this._autoCloseFn){mstrmojo.dom.detachEvent(h.curtainNode,"mousedown",this._autoCloseFn,true);delete this._autoCloseFn;}if(h){h.set("cssClass","mstrWaitBox");if(!this._waitUserLogin){h.set("counter",g?0:Math.max(0,h.counter-1));}else{this._waitCounter=g?0:Math.max(0,h.counter-1);}}},getWaitBox:function(){return mstrmojo.all[P];},showProgress:mstrmojo.emptyFn,hideProgress:mstrmojo.emptyFn,startSessionManager:function Y(h){var j=mstrApp,g=j.enableAutomaticSessionRecovery&&j.maxSessionIdleTime;j.sessionManager=j.addDisposable(new mstrmojo.SessionManager(mstrmojo.hash.copy(h,g?{timeBeforeSessionTimeoutWarning:mstrApp.timeBeforeSessionTimeoutWarning,maxSessionIdleTime:j.maxSessionIdleTime}:{})));if(g){j.sessionManager.start();}},isSessionExpiredError:function f(l){var k=2147760371,j=2147760372,h=2147758245,g=2147759877;l=(l<0)?(4294967296+parseInt(l,10)):l;switch(l){case k:case j:case h:case g:return true;}return false;},onSessionExpired:function b(j){if(!mstrConfig.features["enable-login-editor"]){var m=mstrApp.launchingApp||mstrApp;var n={evt:5005,src:m.name+"."+m.pageName+".5005"},h=(m.docModel&&m.docModel.bs)||(m.rootCtrl&&m.rootCtrl.docCtrl&&m.rootCtrl.docCtrl.model&&m.rootCtrl.docCtrl.model.bs)||(m.docModelData&&m.docModelData.bs);if(h){n.rwb=h;}mstrmojo.form.send(n);return ;}if(mstrApp.sessionManager){var l=mstrmojo.all[P],g=l&&l.counter>0,k=this;this._waitCounter=-1;if(g){this._waitCounter=l.counter-1;k.hideWait(true);}this._waitUserLogin=true;mstrApp.sessionManager.openLoginEditor({success:function(o){k._waitUserLogin=false;if(o&&o.sessionState){if(j){if(j.params.sessionState){j.params.sessionState=o.sessionState;}if(g){l.counter=k._waitCounter;k.showWait();}mstrmojo.xhr.request(j.method,j.baseUrl,j.callback,j.params);}}},cancelRequests:function(){mstrApp.serverProxy.cancelRequests();}});}},updateSessionState:function O(g){this.sessionState=g;},onNavigateOut:mstrmojo.emptyFn,showHelpTopic:function B(l,h){var k=h?h+"HelpPath":"helpPath",g=mstrmojo[k].call(),n=mstrApp.isSingleTier,m=mstrApp.isWorkstation,j=-1;if(l&&typeof l==="string"){g+=l;}if(n||m){window.FormWrapper.openPage(g);}else{mstrApp.openPage(g);}return false;},getSearchAutoCompleteDelay:function S(){return parseInt(mstrConfig&&mstrConfig.searchAutoCompleteDelay,10)||200;},getThemeClassName:function D(){return"mojo-theme-light";},openPage:function K(g,h){window.open(g,h);},modalEditorChange:function J(h,g){if(mstrApp&&mstrApp.isOIVM&&mstrApp.isOIVM()){if(!mstrApp.modalOpenEditors){mstrApp.modalOpenEditors={};}if(g){mstrApp.modalOpenEditors[h]=true;}else{delete mstrApp.modalOpenEditors[h];}}},parseSecondaryDataProviders:function X(l){var k,n,h,m=l.defn,o=m&&m.layouts,j=(o&&o.length)||0,g=mstrApp.primaryScdpMap;for(k=0;k<j;k++){n=o[k];h=n&&n.units;R.forEach(h,function(p,q){if(p&&p.scdp){g[q]=p.scdp.split(",");}});}},getPluginsRoot:function(){return((mstrApp.isSingleTier||mstrApp.isWorkstation)?"file://":"")+(this.pluginRoot||(mstrConfig&&mstrConfig.pluginRoot)||"../plugins/");},upload:function(n,m,l,h,k,j,g){this.serverProxy.upload(n,m,l,h,k,j,g);},getThemeProps:function d(g){var h;if(mstrApp&&mstrApp.isOIVM&&mstrApp.isOIVM()){if(!mstrApp.themeProps){mstrApp.themeProps=mstrmojo.util.ThemeHelper.getThemePropConfig({layoutstyle:mstrApp.docModel.getCurrentLayoutStyle()});}h=mstrApp.themeProps;}else{h=mstrApp.getRootController().view.themeProps;}return g?h[g]:h;}});window.$MAPF=function(){return false;};}());(function(){mstrmojo.requiresCls("mstrmojo.Obj","mstrmojo.array","mstrmojo.Arr","mstrmojo.AjaxCall","mstrmojo.css","mstrmojo.Calendar","mstrmojo.WidgetDial","mstrmojo.Label","mstrmojo.dom","mstrmojo.expr","mstrmojo.hash","mstrmojo.registry","mstrmojo.string","mstrmojo.ListBase","mstrmojo._IsList","mstrmojo.ValidationTextBox","mstrmojo.DateTextBox","mstrmojo.mstr.EnumDataType","mstrmojo.mstr.EnumDSSXMLObjectTypes","mstrmojo.mstr.EnumDSSXMLObjectSubTypes","mstrmojo.mstr.EnumDSSConsolidationType");var t=mstrmojo.array,AJ=t.map,J=mstrmojo.Arr,E=mstrmojo.css,V=mstrmojo.dom,W=mstrmojo.hash,AK=mstrmojo.string,A=mstrmojo.registry,U=mstrmojo.expr,O=U.ET,h=mstrmojo.mstr.EnumDataType,l=U.ET2TP,X=U.ET2TGT,AG=U.DTP,D=mstrmojo.meta.TP,P=mstrmojo.meta.STP,AQ=mstrmojo.mstr.EnumDSSXMLObjectTypes,AC=mstrmojo.mstr.EnumDSSXMLObjectSubTypes,G=mstrmojo.mstr.EnumDSSConsolidationType;var f="dummy",K={did:"idErr",v:"idErr",n:mstrmojo.desc(7929,"Error loading data."),t:f,css:"unselectable",cls:"temp"},q={did:"idWait",v:"idWait",n:mstrmojo.desc(2901,"Loading..."),t:f,css:"unselectable",cls:"temp"},C={did:"idAttribute",v:"idAttribute",n:mstrmojo.desc(518,"Attribute"),t:f,css:"unselectable"},AE={did:"idMetric",v:"idMetric",n:mstrmojo.desc(517,"Metric"),t:f,css:"unselectable"},AD={did:"idSelect",v:"idSelect",n:mstrmojo.desc(547,"Select"),t:f,css:"unselectable"},x={did:"idWait",v:"idQualification",n:mstrmojo.desc(5225,"Qualification"),t:f,css:"unselectable"},B={did:"idWait",v:"idQualification",n:mstrmojo.desc(15008,"Qualify on"),t:f,css:"unselectable"};var AP={};AP[AG.DATE]=1;AP[AG.TIME]=1;AP[AG.TIMESTAMP]=1;var z={};z[O.MQ]={key:"metricFns",def:U.METRIC_FNS};z[O.MC]={key:"metricFns",def:U.METRIC_FNS};z[O.AQ]={key:"formFns",def:U.FORM_FNS};z[O.AL]={key:"formFns",def:U.FORM_FNS};z[O.AC]={key:"formFns",def:U.FORM_FNS};z[O.AE]={key:"elemFns",def:U.ELEM_FNS};var S=[U.STP.PROMPT,U.STP.PROMPT_OBJECTS,U.STP.PROMPT_ELEMENTS,U.STP.PROMPT_EXPRESSION,U.STP.PROMPT_EXPRESSION_DRAFT];function Z(AR){if(AR&&AR.t===AQ.Consolidation&&AR.st===AC.ConsolidationManaged){return true;}return false;}function F(AT,AV,AS){var AU=AT.items,AR=t.indexOf(AU,AV);if((AR===0)&&(AU.length===1)){AS=mstrmojo.Arr.makeObservable((AS&&AS.length)?AS.concat():[]);AT.set("items",AS);}else{if(AR>-1){AU.splice(AR,1);}if(AS&&AS.length){t.insert(AU,(AR>-1)?AR:AU.length,AS);}AT.refresh();}}function b(AZ,AY){if(this.updating){return ;}var AR=this.multiSelect,AT=this.selectedItem,AW=AZ&&AZ.added,AV=AZ&&AZ.removed;AY=AY||this.alias;if(!AR&&AW&&AV&&AW[0]===AV[0]){return ;}if(AT&&AT[D]===f){this.updating=true;if(AR){this.removeSelect([this.selectedIndex]);}else{var AX=AV&&Number(AV[0]);AX=(AX==null)?-1:AX;this.set("selectedIndex",AX);}this.updating=false;}else{var AS=this.parent.parent.parent.model;if(AR){var AU=this.items;AS.edit(AY,{added:AW&&t.get(AU,AW),removed:AV&&t.get(AU,AV),itemIdField:this.itemIdField});}else{AS.edit(AY,AT);}}}function R(AR,AT,AU){if(this.updating){return ;}AU=AU||this.alias;var AS=AR.model;AS.edit(AU,AT);}function u(){var AS=this.parent,AR=((AS&&AS.cssText)||"").match(/height:\s*(\d*)px/);this.cssText=AR&&AR[0];}function N(AR){return mstrmojo.mixin(AR,{scriptClass:"mstrmojo.rw.ConditionList",cssClass:"mstrmojo-"+AR.alias,postCreate:u});}function Y(){var AS=this.parent,AR=AS.parent;AR["invalid"+AS.cstIndex]=false;}function n(AT,AR,AU){var AS=AT.cfg;if(AS){AS.data=AT;AS.parent=AU;return A.ref(AS);}AS=new mstrmojo.Label({text:AT.n||"&nbsp;",cssClass:"dial-item "+(AT.t?("t"+AT.t):"")});AS.markupMethods.onselectedChange=function(){E.toggleClass(this.domNode,["selected"],this.selected);};AS.data=AT;AS.parent=AU;return AS;}function AB(AR){switch(AR){case h.DataTypeInteger:case h.DataTypeUnsigned:case h.DataTypeDecimal:case h.DataTypeReal:case h.DataTypeDouble:case h.DataTypeFloat:case h.DataTypeCellFormatData:return h.DataTypeNumeric;default:return AR;}}function H(AT,AS){var AR=AT.model||{},AU=AR.fn;return(AU!=null)&&((AR.et===O.MQ)||(AR.et===O.MC)||(AR.et===O.AQ)||(AR.et===O.AL)||(AR.et===O.AC))&&(U.fnCstCount(AU,AR.fnt)>AS);}function p(AS){var AV=AS&&l[AS.et],AU=AS&&AS.fm&&AS.fm.dtp,AR=AU&&U.DTP2PROMPT_STP[AU],AT={};AT[AV]=true;if(AR){AT[AR]=true;}return AT;}function AM(AR,AT){var AS;if(AT){switch(X[AR.et]){case"a":AS=AT[O.AC];break;case"m":AS=AT[O.MC];break;default:AS=false;break;}}else{AS=true;}return AS&&U.fn_AC_MC(AR&&AR.fn);}function k(AR){var AU=AR.model,AY=AU&&AU[X[AU.et]]&&AU[X[AU.et]][AR.columnWalk.target.itemIdField||"did"],AT=AU&&AU.fm,Aa=AT&&AT.dtp,AS=AM(AU,AR.ets);if(this.targetsLastMod&&this.targetsLastMod===AR.targetsLastMod&&AY&&AY===this._lastTargetId&&this.lastFmDtp===Aa&&this.lastFnTp===AS){return ;}if(!AS){this.clearSelect();if(this.items.length!==this.preLen){this.set("items",this.items.slice(0,this.preLen));}}else{var AW=AU.a?[C]:AU.m?[AE]:[],AV=e(AR),AZ=AW.concat(AV),AX=this.items.slice(this.preLen);t.forEach(AX.reverse(),function(Ab){this.remove(Ab);},this);this.add(AZ,-1);}this._lastTargetId=AY;this.lastFnTp=AS;this.lastFmDtp=Aa;this.targetsLastMod=AR.targetsLastMod;}function e(AR){var AS=AR.model,AT=p(AS),AU=AS[X[AS.et]];return U.getSortedObjectsByTypeGroup(t.filter(AR.targets,function(AV){return(AV.t!==4||AV.did!==AU.did)&&(AT[AV[D]]||AT[AV[P]]);}));}function a(AS,AR){var AT=AS.model||{},AU=AT.cs,AV=AU&&AU[AR];if(AT.et==O.MC&&AT["c"+(AR+2)]){AV=AT["c"+(AR+2)];}return AV;}function I(AR,AU){var AT=AR.model||{},AS;switch(AT.et){case O.MC:case O.MQ:AS=(AU&&AU.dtp)||AB(AT.m.dt)||U.METRIC_DTP;if(AS===AG.BIGDECIMAL){AS=U.METRIC_DTP;}break;case O.AQ:case O.AC:case O.AE:case O.AL:AS=AT.fm&&AT.fm.dtp;break;}return AS||AG.CHAR;}function AO(AS,AT){if(!AS){return AS;}if(AS.dtp===AG.BIGDECIMAL&&AT===O.MQ){var AR=String(AS.v);if(AR&&AR.indexOf("#")===-1){return"#"+AR+"#";}else{return AR;}}else{return AS.v;}}function AA(AS,AR){var AU=AS.model||{},AV=AU.cs,AW,AT;if(AU.et===O.AL){AT=[];t.forEach(AV,function(AX){AT.push(AX&&AX.v);});AT=AT.join(mstrConfig.listSep);}else{AW=a(AS,AR);AT=AO(AW,AU.et);}return AT;}function L(Al,Ad){Al.updating=true;var AZ=Al.parent.parent.parent,Ak=H(AZ,Ad),Ae,Af;if(Ak){k.call(Al,AZ);var AU=AZ.model||{},Aj=a(AZ,Ad),Aa=I(AZ,Aj),Ac=AA(AZ,Ad);var AY=AU.fn,AW=U.fn_List(AY,AU.fnt),Am=AP[Aa],Ag=Am&&!AW;var AS=Al.ctxtBuilder,Ai=AS&&AS.itemWidgets,AT=Am?(Ag?Al.calIndex:Al.dtxtIndex):Al.txtIndex,AX;for(Ae=0,Af=Al.preLen;Ae<Af;Ae++){AX=Ai[Ae];if(Ae==AT){AX.set("dtp",Aa);AX.set("isList",AW);var AR=AX.value,AV=AK.isEmpty(AR),Ah=AK.isEmpty(Ac);if(!(AV&&Ah)&&AR!==Ac){AX.set("value",Ac);}AX.set("visible",true);AX.set("hint",AW?mstrmojo.desc(8191,"value1## value2## ...## valueN").replace(/##/g,mstrConfig.listSep||";"):"");try{if(Al.alias!=="c1"||Al.parent.c1Selected){AX.focus&&AX.focus();}}catch(Ab){}if(AY===1||AY===2){AX.constraints.min=0;}if(AX.clearValidation){AX.clearValidation();}}else{AX.set("visible",false);}}if(AZ.hasPrompt&&Al.selectedItem&&Al.selectedItem.st===U.STP.PROMPT_STRING){AZ.invalid0=false;}switch(AU.et){case O.AQ:case O.AL:case O.MQ:if(Aj&&Aj.p){Al.set("selectedItem",Aj.p);}else{Al.set("selectedIndex",AT);}break;case O.MC:case O.AC:Al.set("selectedItem",AU[X[AU.et]+(2+Ad)]);break;}}Al.updating=false;}function AL(){var AU=this.parent,AS=AU.parent.parent.parent,AT=(this.isValid&&this.isValid())||(!this.isValid&&!AK.isEmpty(this.value)),AR=AS.model;AS["invalid"+AU.cstIndex]=!AT;if(!this.updating&&AT){this.updating=true;if(AR){AR.edit(AU.alias,{v:this.value,dtp:this.dtp});}this.updating=false;}if(AS.updateOkBtn){AS.updateOkBtn();}}function j(AS){var AR=[{did:660,cfg:{scriptClass:"mstrmojo.ValidationTextBox",required:true,constraints:{trigger:mstrmojo.validation.TRIGGER.ONKEYUP|mstrmojo.validation.TRIGGER.VALUESET},onValid:AL,onInvalid:AL,onClearValidation:Y,size:6,visible:false}},{did:154,cfg:{scriptClass:"mstrmojo.Calendar",onvalueChange:AL,visible:false}},{did:23,cfg:{scriptClass:"mstrmojo.DateTextBox",cssText:"margin-left:9px;",cssDisplay:"inline-block",required:true,constraints:{trigger:mstrmojo.validation.TRIGGER.ALL-mstrmojo.validation.TRIGGER.ALL.ONBLUR},onValid:AL,onInvalid:AL,onClearValidation:Y,calendarToBody:true,autoFormat:false,calConfig:{onmousedown:function(AT){V.stopPropogation(AT.hWin,AT.e);}},visible:false}}];return N(W.copy(AS,{scriptClass:"mstrmojo.WidgetDial",makeObservable:true,itemFunction:n,selectionPolicy:"reselect",items:AR.concat(),txtIndex:0,calIndex:2,dtxtIndex:2,preLen:AR.length,insertUnlistedValuesAt:-1,itemIdField:"did",update:function(){L(this,this.cstIndex);this.parent.updateScrollbars();},postCreate:function(){this._super();this.parent.parent.parent.attachEventListener("updateTargets",this.id,function(){this.update();});},itemsEffect:undefined,onchange:b}));}function AN(AS,AR){var AT=AR+U.FN_SEP+AS;return(AS!=null)?{did:AT,n:AT}:null;}function Q(AT){var AV=this.selectedItem;AT=t.filter(AT,function(AW){return(!AW.icf);});if(AV){var AS=t.find(AT,this.itemIdField,AV[this.itemIdField]);if(AS>-1){AT=AT.concat();AT.splice(AS,1);}}F(this,q,AT);var AU=this.items,AR=AU.length;if(AR===1){this.singleSelect(0);}this.updateScrollbars&&this.updateScrollbars();this.parent.updateScrollbars();}function o(AT,AS,AU,AX){AT.updating=true;if(AS){if(AU!=null){AT.set("items",[]);AT.clearSelect();AT.set("items",AU);}var AW=AT.itemIdField,AV=AT.selectedItem;if((AV&&AV[AW])!=(AX&&AX[AW])){var AR=Math.max(t.indexOf(AJ((AU||[]),function(AY){return AY[AW];}),AX&&AX[AW]),0);AT.set("selectedIndex",AR);}}AT.updating=false;}function M(AT,AS,AU,AX){AT.updating=true;if(AS){if(AU!=null){AT.set("items",AU);}var AW=AT.itemIdField,AV=AT.getSelectedItem();if((AV&&AV[AW])!=(AX&&AX[AW])){var AR=Math.max(t.indexOf(AJ((AU||[]),function(AY){return AY[AW];}),AX&&AX[AW]),0);AT.set("selectedIndex",AR);}}AT.updating=false;}function g(AR){return N(W.copy(AR,{insertUnlistedValuesAt:-1,hasDummyLabel:true,postCreate:function(){u.apply(this,[]);this.ajx=mstrmojo.insert({parent:this,scriptClass:"mstrmojo.AjaxCall",isTask:true,readCache:true,writeCache:true,params:{taskId:"getAttributeForms",attributeId:null,displayedForms:"0",styleName:"MojoAttributeStyle"},onsuccess:function(){var AU=this.parent,AT=this.response;if((AT&&AT.did)!==AU.lastAttrId){return ;}Q.call(this.parent,AT.fms||[]);},onerr:function(){F(this.parent,q,[K]);}});},update:function AS(){var Ai=this.fmPost,Ab=this,AV=this.parent.parent.parent,AY=AV.model,Ag=AY&&AY["a"+Ai],Ad=!!Ag,AX,Ac,Ah,AU=AV.disableElementsBrowsing,AT=Ag&&AU&&AU(Ag),Af=Z(Ag);if(Ad){switch(AY.et){case O.AQ:case O.AL:Ac=AY.fm;break;case O.AC:Ac=AY["fm"+Ai];break;case O.AE:Ac=AN(AY.fn,1);break;}if(this.lastAttrId!==Ag.did){this.lastAttrId=Ag.did;AX=[];if(this.isFirstFm){if(!AT&&(!Ag.ilk&&(!AV.ets||AV.ets[O.AE]))){if(this.hasDummyLabel){AX.push(AD);}var Aa=z[O.AE],Ae=Aa&&Aa.key,AW=Aa.def;AX=AX.concat((Ae&&AV[Ae])||(Af?t.filter(AW,function(Aj){return Aj.did!=="1,57";}):AW)||[]);t.forEach(AX,function(Aj){Aj.cls="fn";});}if(this.hasDummyLabel){AX.push(mstrApp.isWSStyling?B:x);}}if(Ac&&(AY.et!==O.AE)){AX.push(Ac);}Ah=this.ajx;Ah.params.attributeId=Ag.did;Ah.params.otp=Ag.t||12;AX.push(q);J.makeObservable(AX);}}if(AT&&AY.et===O.AE){Ac=null;}o(this,Ad,AX,Ac);if(Ad&&Ah){var AZ;if(AV.getAttributeForms){AZ=AV.getAttributeForms(Ag.did);}else{if(Ag.fms){AZ=Ag.fms;}}if(AZ&&AZ.length>0){Q.call(this,AZ);}else{if(Ag&&Ag.t===AQ.Consolidation){Q.call(this,[]);}else{if(Ah){if(mstrApp&&mstrApp.isWorkstation){mstrApp.serverRequest(Ah.params,{success:function(Aj){if((Aj&&Aj.did)!==Ab.lastAttrId){return ;}Q.call(Ab,Aj.fms||[]);},failure:Ah.onerror});}else{if(Ah._delayId){window.clearTimeout(Ah._delayId);delete Ah._delayId;}Ah._delayId=window.setTimeout(function(){delete Ah._delayId;Ah.send();},500);}}}}}}}));}function AI(AR){if(AR&&!W.isEmpty(AR)){var AS=t.hash(S);W.forEach(AR,function(AU,AT){if(AU){AS[l[AT]]=true;}});return AS;}return null;}function m(AR,AS,AU,AT){AR.updating=true;AR.clearSelect();t.forEach(AS,function(AV){AV.title=AK.encodeHtmlString(AV.title||AV.n||"");});if(AS){AR.set("items",AS);}if(AU&&AU.length){AR.setSelectedItems(AU);}else{if(AT&&AT.length){AR.select(AT);}}AR.updating=false;}function d(AS,AR,AT,AV,AU){if(AR){m(AS,AT,AV,AU);}}mstrmojo.rw.ConditionList=mstrmojo.declare(mstrmojo.ListBase,[mstrmojo._IsList],{scriptClass:"mstrmojo.rw.ConditionList",allowUnlistedValues:true,itemIdField:"did",getItemProps:function w(AV,AR){var AU=!!this.selectedIndices[AR],AX=AV.n,AT=false,AW=AV.ndetype===G.DssRecursiveDerivedElement;if(AV.t===12){var AS=t.filter(AV.fs,function(AY){return AY.fgr>0;});if(AS.length>0){AT=true;}}return W.copy({cls:(AU?mstrmojo._IsList.SELECTED_CLS:"")+" "+(AV.css||"")+" "+(AV.t?("t"+AV.t+((AV.da||AV.um)?"d":"")+(AT?"g":"")+(AV.st?(" st"+AV.st+(AW?" nde4ra":"")):"")):""),n:AX||"&nbsp;"},this._super(AV,AR));},onselectionChange:function AF(AR){this._super(AR);b.call(this,AR);}});mstrmojo.rw.ConditionWalkProviderBase=mstrmojo.declare(mstrmojo.Obj,null,{scriptClass:"mstrmojo.rw.ConditionWalkProviderBase",browseEs:function c(AU,AT,AW){AU.openPopup("eb",{zIndex:AU.parent.zIndex+10,left:Math.round(AW.x)+"px",top:Math.round(AW.y)+"px"});var AS=AU.eb.browser,AR=AU.model,AV=AR&&AR.a&&AR.a.did;if(!AV){return ;}AS.set("attributeID",AV);AS.set("selectedItems",AR.es?W.clone(AR.es):[]);AS.initBrowser();},browseObjs:function AH(AY,AR,AS){AY.openPopup("ob",{zIndex:AY.parent.zIndex+10,left:Math.round(AS.x)+"px",top:Math.round(AS.y)+"px"});var AT=AY.ob.browser;AT.target=AR;var AU;switch(AR.alias){case"dmy":AU=[U.TP.ATTR,U.TP.DIM];break;case"c0":case"c1":var AW=AY.model,AV=AW&&AW.et,AZ=AW&&AW.fm,AX=AZ&&AZ.dtp||(AW.m?U.DTP.DECIMAL:U.DTP.UNKNOWN);AU=(AV===O.MQ||AV===O.MC)?[U.TP.METRIC,U.DTP2PROMPT_STP[AX]]:[U.TP.ATTR,U.DTP2PROMPT_STP[AX]];break;default:AU=AI(AY.ets);AU=AU?W.keyarray(AU,true):[U.TP.ATTR,U.TP.METRIC,U.STP.REPORT_GRID,U.STP.REPORT_GRAPH,U.STP.REPORT_ENGINE,U.STP.REPORT_TEXT,U.STP.REPORT_DATAMART,U.STP.REPORT_BASE,U.STP.REPORT_GRIDGRAPH,U.STP.REPORT_NONINTERACTIVE,U.STP.FILTER].concat(S);}AU[AU.length]=U.TP.FOLDER;AT.browse({rootFolderType:AW&&(AW.et===O.MQ||AW.et===O.MC)?5:26,folderLinksContextId:33,onSelectCB:[AY,"onOBSelect"],browsableTypes:AU.join(",")});},});var r=mstrmojo.rw.ConditionWalkProviderBase;r.onWalkChange=b;r.replaceItem=F;r.getChildJSON=N;r.walkChildPostCreateFn=u;r.cstJson=j;r.isComparisonAllowed=AM;r.clearInvalid=Y;r.updateCst=L;r.widgetItemFn=n;r.shouldShowCst=H;r.getConstant=a;r.getConstantDataType=I;r.getConstantValue=AA;r.isDATE=AP;r.getCstListCompareTgts=e;r.fmJson=g;r.fnItem=AN;r.updateList=o;r.allowedTargetTypes=AI;r.updatePulldown=M;r.onWalkChangeThroughPulldown=R;r.updateListMultiData=m;r.updateListMulti=d;})();(function(){mstrmojo.requiresCls("mstrmojo.Box","mstrmojo.qb.FFsqlInput");var H=mstrmojo.array,G=mstrmojo.hash;function C(J,K){var I=K?"\n":"",L;for(L=0;L<J;++L){I+=" ";}return I;}mstrmojo.qb.FFsqlEditor=mstrmojo.declare(mstrmojo.Box,null,{scriptClass:"mstrmojo.qb.FFsqlEditor",cssClass:"mstrmojo-qb-ffsqlview",children:[{scriptClass:"mstrmojo.Box",alias:"passlabel",cssClass:"mstrmojo-qb-ffsqlview-passlabel",bindings:{visible:function(){return this.children&&this.children.length;}}},{scriptClass:"mstrmojo.qb.FFsqlInput",alias:"ffsql",cssClass:"mstrmojo-qb-ffsqlview-editnode",id:"FFsql",txt:"",dropZone:true,onwidthChange:function B(){if(this.hasRendered){this.parent.updatepasses();}},onheightChange:function E(){if(this.hasRendered){this.parent.updatepasses();}},updateSQL:function D(I){if(!this.candidates){this.set("candidates",{items:this.sqlTokens.concat(mstrApp.getRootController().getSuggestionItems(true)),isComplete:true});}this.clearTokens();this.txt=I.value;this.clipboardNode.value=I.keepFormat?this.txt:this.formatSQL(this.txt);this.handlepaste();if(I.value===""){this.parent.updatepasses();}this.oriSQL=this.getSQLstmt();},formatSQL:function A(P){var N,L=false,J=C(2,false),Q=C(1,false),M="\n",O=C(9,true),K=C(10,true),I=false;N=P.replace(/,/g," ,").replace(/;/g," ;").replace(/\n/g," ").replace(/ +/g," ").split(" ");H.forEach(N,function(S,R){switch(S){case"from":case"having":N[R]="\n"+N[R]+J;break;case"group":if(N[R+1]==="by"){N[R]="\n"+N[R]+Q;}break;case"where":N[R]=M+N[R];break;case"join":case"outer":if(L){break;}case"full":case"left":case"right":N[R]=K+N[R];L=true;break;case",":if(!I){N[R]=N[R]+O;}break;case"on":N[R]=K+N[R];L=false;break;case";":N[R]=N[R]+"\n";break;case"in":I=true;break;default:if(I&&S.length>=1&&S[S.length-1]===")"){I=false;}break;}});return N.join(" ").replace(/ ,/g,",");}}],onwidthChange:function B(I){var L=this.ffsql,K=L.domNode,J;J=Math.max((parseInt(I.value,10)-((this.passlabel.children&&this.passlabel.children.length)?10:0)),0)+"px";L.set("width",J);if(K){K.style.width=J;}},updatepasses:function F(){var L,N=this.ffsql,M=[],K={scriptClass:"mstrmojo.Button"},I=this.domNode.clientHeight,J=this.passlabel;L=N.getPassLabelYCoords();H.forEach(L,function(P,O){if(P>=0&&P<=I){M.push(G.copy(K,{cssText:["top:",P,"px;"].join(""),cssClass:(N.pnum===O?"error":"")}));}});J.removeChildren(null,true);J.addChildren(M,0,true);}});}());(function(){mstrmojo.requiresCls("mstrmojo.vi.ui.tabs.TabStrip","mstrmojo.vi.ui.tabs.Tab","mstrmojo.Label","mstrmojo.Button","mstrmojo.Pulldown","mstrmojo.Box","mstrmojo.dom","mstrmojo.css","mstrmojo.tooltip","mstrmojo.ME.MetricEditBox","mstrmojo.array","mstrmojo.hash","mstrmojo.mstr.EnumDSSXMLBaseFormType");var f=mstrmojo.array,N=mstrmojo.hash,M=mstrmojo.ME.MetricToken.brackets,B=mstrmojo.css,S=mstrmojo.vi.ui.tabs.Tab.ACTIONS,n=S.DELETE+S.RENAME,o=mstrmojo.ME.MetricEditBox.VALIDATION_STATUS,p=mstrmojo.ME.MetricEditBox.VALIDATION_STATUS_CSS,O=mstrmojo.ME.MetricEditBox.VALIDATION_STATUS_DESC,W=mstrmojo.mstr.EnumDSSXMLObjectTypes,D=mstrmojo.string,r="This@ID",Y="45C11FA478E745FEA08D781CEA190FE5",V=mstrmojo.mstr.EnumDSSXMLBaseFormType,u=[{n:mstrmojo.desc(959,"Default"),v:V.DssXmlBaseFormReserved},{n:mstrmojo.desc(12276,"String"),v:V.DssXmlBaseFormText},{n:mstrmojo.desc(2052,"Date"),v:V.DssXmlBaseFormDate},{n:mstrmojo.desc(3434,"Number"),v:V.DssXmlBaseFormNumber}],Z=function(){var AA="analytical_engine_version.htm",z=mstrApp.showHelpTopic;if(z){z(AA,"upgrade");}else{window.open(mstrmojo.upgradeHelpPath()+AA,"_blank");}};function H(z){return{n:z,k:z,ftk:[],vs:1,is:"",bft:V.DssXmlBaseFormReserved,bftp:V.DssXmlBaseFormReserved};}function Q(AF,AG,z,AD){var AB=AF.forms[AG]||{},AE=AF.forms[z],AA=AF.inputBox,AC=AF.statusBox.pulldownBox.pulldown;if(AG!==z){AB.vs=AF.vStatus;AB.is=AF.iStatus;AB.bft=AF.formType||AC.getSelectedItem().v;AB.bftp=AF.formType||AC.getSelectedItem().v;AB.ftk=AA.items;AF.set("vStatus",o.UNKNOWN);}AF.set("vStatus",AE.vs);AF.set("iStatus",AE.is);AF.updateInputBoxItems({items:AE.ftk});if(AF.curFormIdx!==z){AF.curFormIdx=z;AF.tabstrip.setSelectedTab(AE.k);}AC.set("selectedIndex",f.find(AC.items,"v",AE.bft));AF.raiseEvent({name:"tabSwitch",tks:AE.ftk,vs:AE.vs,is:AE.is,bft:AE.bft,bftp:AE.bftp,oidx:AG,nidx:z,toNewTab:AD});}function P(AA){var z=AA.forms[AA.curFormIdx];if(z){z.ftk=AA.inputBox.items;z.vs=AA.vStatus;z.is=AA.iStatus;}}var m=0;function c(z){m=Math.max(z.length-1,m);}function b(){m=0;}function t(z){var AA="DESC"+(m?" "+m:"");m++;if(f.find(z,"n",AA)>=0){return t(z);}return AA;}function J(AC){var AB={v:M(AC.n),oi:AC,isNew:true},AA,z;if(AC.t===12){AA=f.filter(AC.fs,function(AD){return AD.obf||AC.da;}).length;if(AA===1){z=AC.fs[0];AB=N.copy({v:M(AC.n)+"@"+M(z.fnm),ift:true,exv:z.fid,extp:8},AB);}else{AB=N.copy({v:M(AC.n)+"@",ift:true},AB);}}return AB;}function E(AA,z){AA.set("enabled",!z);var AB="mstrmojo-InlineWaitIcon";if(AA.iconClass){AA.set("iconClass",AA.iconClass.replace(new RegExp(AB),"")+" "+(z?AB:""));}else{mstrmojo.css.toggleClass(AA.domNode,AB,z);}}function L(z){return z.tp===33||z.tp===37;}function F(z){return z.tp===-1;}var a=function(AF){var AD=AF.items,AA=AD.length,AC,AE,AB=[],z="";AB.push({v:"!",tp:33,lv:4,sta:2});for(AC=0;AC<AA;AC++){AE=AD[AC];if((AC===0&&L(AE))||F(AE)){continue;}if(AE.isNew&&!AE.oi){z+=AE.v;}else{if(!D.isEmpty(z)){AB.push({v:z,tp:2,lv:1});z="";}if(AE.v&&AE.v.indexOf(r)>=0){AE.v=AE.v.replace("["+r+"]",r);AE.exv=Y;AE.extp=8;delete AE.oi;}AB.push(AE);}}if(!D.isEmpty(z)){AB.push({v:z,tp:2,lv:1});z="";}AB.push({v:"",tp:-1,lv:4,sta:2});return{items:AB};},g=function(AB){var z=AB.items||[],AA=z[z.length-1];if(AA&&AA.tp===-1){z.pop();}if(z[0]&&L(z[0])){z.splice(0,1);}f.forEach(z,function(AC){if(AC.v&&AC.v.indexOf(r)>=0){N.copy({extp:8,exv:Y,oi:{n:"This",did:"This",t:12}},AC);}});},e=function(z){if(!z){return o.VALID;}return{"-2147214845":o.ERROR,"-2147214846":o.AMBIGUITY}[z]||o.ERROR;},U=function(AB){AB=a(AB);var AA={items:true,v:true,tp:true,lv:true,oi:true,n:true,did:true,t:true,st:true,exv:true,extp:true,asc:true,vtp:true},z={getArrItemName:function(){return"tkn";},isSerializable:function(AC){return(AA[AC])?true:false;}};return D.json2xml("tknstrm",AB,z);},G=function(AB,AE,AD,AA){var AC=U(AE),AF=function(AG){if(AG&&AG.tks){var AH=AG.tks;g(AH);AH.vs=e(AH.rjec);AH.tokenXML=AC;if(AA){AA(AH);}}},z=function(AG){mstrmojo.alert(AG.message||AG.getResponseHeader&&AG.getResponseHeader("X-MSTR-TaskFailureMsg"));};mstrmojo.ME.MetricDataService.validateMetric({tokenStreamXML:AC,localSymbolFolderXML:"",metricXML:"",metricId:AB||"",isNew:true,objectType:12,isIDForm:AD,msgID:mstrApp.getMsgID()},{success:AF,failure:z});};mstrmojo.ME.DerivedAttributeFormTab=mstrmojo.declare(mstrmojo.vi.ui.tabs.Tab,null,{scriptClass:"mstrmojo.ME.DerivedAttributeFormTab",valid:true,editable:true,postBuildRendering:function X(){if(this._super){this._super();}var z=this,AA=z.lbl;AA.editOnDoubleClick=this.editable;AA.onTextEditComplete=function(AC,AB){if(z.validate(AA.text)){z.titleEdited(AA.text,AB);}};},onclick:function l(z){var AA=mstrmojo.dom.eventTarget(z.hWin,z.e);if(AA===this.menuBtnNode){this.tabDeleted();}else{if(!this.isSelected){this.tabSelected();}}},validate:function(z){var AA=!/[\[\]\"\\]/g.test(z);if(!AA){this.lbl.set("isEditing",true);}this.set("valid",AA);return AA;},showErrTooltip:function x(AD,AB){var z=mstrmojo.dom.position(this.domNode),AA=this,AC=AA.errTooltip;if(!AC){AA.errTooltip=AC=new mstrmojo.Tooltip({contentNodeCssClass:"me-tooltip-content up me-err",updatePopupConfig:null});this.addDisposable(AC);}AC.set("top",z.y+z.h+2);AC.set("left",z.x+z.w/2-AB);AC.set("content",'<div class="content"><span>'+AD+"</span></div>");AC.open();window.setTimeout(function(){AC.close();},2500);},onvalidChange:function(){if(this.valid){this.hideTooltip();}else{this.showErrTooltip(mstrmojo.desc(11569,"Input contains invalid character"),95);}}});function k(AC,AD,AE){var AB=f.find(AD,"k",AE.k);return{scriptClass:"mstrmojo.ME.DerivedAttributeFormTab",title:AE.n,draggable:false,editable:AB!==0,cssClass:"mstrmojo-AEB-Tab "+(AB===0?"mstrmojo-AEB-IDTab":""),getMenuActions:function(){return n;},tabSelected:function(){Q(AC,AC.curFormIdx,AB);},titleEdited:function AA(AG,AF){if(AG!==AF){if(f.find(AC.forms,"n",AG)>=0){this.showErrTooltip(mstrmojo.desc(7209,"Name already exists"),69);}else{var AH=AC.forms[AB];AH.n=AG;AC.set("dirty",true);}}},tabDeleted:function z(){var AF=AC.forms.length,AI=(AC.curFormIdx===AF-1)?0:AC.curFormIdx,AG=AC.forms.slice(0),AH=AG[AB];if(AH&&AH.did){AC.delForms.push({n:AH.n,did:AH.did});}AG.splice(AB,1);AC.curFormIdx=AI;AC.set("forms",AG);Q(AC,-1,AI);AC.set("dirty",true);}};}mstrmojo.ME.AttributeEditBox=mstrmojo.declare(mstrmojo.ME.MetricEditBox,null,{scriptClass:"mstrmojo.ME.AttributeEditBox",markupString:'<div id="{@id}" class="mstrmojo-MEBox {@cssClass}" style="{@cssText}"><div class="mstrmojo-AEB-TabStrip"></div><div class="mstrmojo-MEBox-edit mstrmojo-AEB-edit"></div><div class="mstrmojo-AEBox-status {@statusCssClass}"></div></div>',markupSlots:{tabstripNode:function(){return this.domNode.firstChild;},editNode:function(){return this.domNode.childNodes[1];},statusNode:function(){return this.domNode.lastChild;}},markupMethods:{onvStatusChange:function(){var AA=this.vStatus,AE=(AA===o.VALID),AC=(AA===o.UNKNOWN||AA===o.VALIDATING),AB=this.statusBox.infoBox;this.validateBtn.set("visible",AC);AB.set("visible",!AC);if(!AC){AB.infoLabel.set("text",AE?mstrmojo.desc(11655,"Valid formula."):mstrmojo.desc(15953,"Validation failed."));var AD=p[AA],z=AB.infoIcon.domNode;if(!B.hasClass(AD)){B.removeClass(z,[p[o.VALID],p[o.ERROR],p[o.AMBIGUITY]]);B.addClass(z,AD);}}},oniStatusChange:function(){var AB=this.vStatus,z=(AB===o.ERROR||AB===o.AMBIGUITY),AA=this.statusBox.infoBox.infoIcon;AA.title=z?(this.getStatusDesc&&this.getStatusDesc(AB))||O[AB]+" "+this.iStatus:"";}},forms:null,delForms:[],curFormIdx:0,attrid:null,absorbAmbiguity:false,init:function q(AC){var AD=this,AF=function(){AD.validateCurrentForm();},AB=[{scriptClass:"mstrmojo.vi.ui.tabs.TabStrip",alias:"tabstrip",position:"top",slot:"tabstripNode",isAlignRight:false,getTabCfg:function AA(AI,AJ,AH){return N.copy(k(AD,AI,AJ),AH);},addTab:function AG(){var AJ=AD.forms,AH=AJ.length,AK=t(AJ),AI=AJ.slice(0);AI.push(H(AK));AD.set("forms",AI);Q(AD,AD.curFormIdx,AH,true);AD.set("dirty",true);},clear:function z(){f.forEach(this.children,function(AH){AH.hideTooltip();});}},{scriptClass:"mstrmojo.Button",alias:"clearBtn",slot:"tabstripNode",text:mstrmojo.desc(2827,"Clear"),cssClass:"mstrmojo-WebHoverButton mstrmojo-AEB-clearAll hoverLink",onclick:function(){AD.inputBox.clearTokens([]);AD.inputBox.raiseChangeEvent({type:"clear"});}},{scriptClass:"mstrmojo.Box",alias:"statusBox",slot:"statusNode",cssClass:"statusBox",children:[{scriptClass:"mstrmojo.Box",alias:"pulldownBox",cssClass:"pulldownBox",cssDisplay:"inline-block",children:[{scriptClass:"mstrmojo.Label",cssClass:"mstrmojo-AEBox-pulldownLabel AEBox-item",text:mstrmojo.desc(9918,"Data Type")},{scriptClass:"mstrmojo.ui.Pulldown",alias:"pulldown",cssClass:"mstrmojo-AEBox-pulldown AEBox-item",selectedIndex:0,items:u,onitemSelected:function(AK){var AH=AD.curFormIdx,AI=AD.forms,AJ=AI&&AI.length>AH&&AI[AH];if(AJ){if(AJ.bft!==AK.v){AJ.bft=AJ.bftp=AK.v;AD.set("dirty",true);}}}}]},{scriptClass:"mstrmojo.Box",cssClass:"helpIcon",cssDisplay:"inline-block",richTooltip:{cssClass:"vi-regular vi-tooltip-A A-center AE-tooltip",posType:mstrmojo.tooltip.POS_TOPCENTER,enableHover:true},useRichTooltip:true,tooltipCloseDelay:500,updateTooltipConfig:function AE(){var AI=this.richTooltip,AH=mstrmojo.dom.position(this.domNode);AI.left=AH.x+AH.w-8;AI.top=AH.y+28;AI.content=mstrmojo.desc(16313,"Data Type options for derived attribute forms are only available for data engine version 11.1 and later.");AI.content+="<br /><div class='help-link-label' onclick='mstrmojo.ME.AttributeEditBox.AEHelpFn()'>"+mstrmojo.desc(9849,"Learn More")+"</div>";}},{scriptClass:"mstrmojo.Box",alias:"infoBox",cssClass:"infoBox",cssDisplay:"inline-block",children:[{scriptClass:"mstrmojo.Button",alias:"infoIcon",cssClass:"mstrmojo-AEBox-infoIcon AEBox-item",title:"",tooltipOpenDelay:0,useRichTooltip:true,updateTooltipConfig:function(){var AH=mstrmojo.dom.position(this.domNode);this.richTooltip={cssClass:"vi-regular A-center vi-tooltip-A",top:Math.max(AH.y+26,0),left:Math.max(AH.x+10,0),posType:mstrmojo.tooltip.POS_TOPCENTER,content:this.title};}},{scriptClass:"mstrmojo.Label",alias:"infoLabel",cssClass:"mstrmojo-AEBox-infoLabel AEBox-item"}]}]}];this.validateFunc=AF;AD.children=AB.concat(this.children);this._super(AC);},item2textCss:function K(z){return this._super(z)||{21:"afm"}[z.t]||"";},onformsChange:function d(){var z=this.forms,AA=z[this.curFormIdx].k;f.forEach(z,function(AB){g({items:AB.ftk});});this.tabstrip.setTabs(z,AA);c(z);},selectFormTab:function A(z){Q(this,this.curFormIdx,z);},postBuildRendering:function X(){if(this._super){this._super();}this.clear();var z=this;this.inputBox.ondrop=function(AD){if(!AD.src.data||!AD.src.data.item){return ;}var AC=z.inputBox,AF=AC.ctxtBuilder.itemWidgets,AG=N.copyProps(["did","n","t","fs"],AD.src.data.item),AI=J(AG),AA,AH,AB;AD.src.data=AI;mstrmojo.ListBase2.prototype.ondrop.call(this,AD);var AE=function(AJ){return AJ.t===W.Function&&!(!isNaN(AJ.fdid)&&AJ.fdid<0);};if(AE(AI.oi)){this.insertParenthesisTokens();}if(z.ontokensModify){z.ontokensModify();}AA=this.selectedIndices;if(AG.t===12&&AI.ift&&!AI.exv){for(AH in AA){AB=AF[AH];if(AB){AC.startTokenSuggestion(AB);}}}AC.clearSelect(true);B.removeClass(AC.domNode,"unselectable");};},clear:function j(){this.curFormIdx=0;this.delForms=[];this.attrid=null;b();this.set("forms",[H("ID")]);this.inputBox.set("items",[]);this.inputBox.resetTokensCache();this.set("vStatus",o.UNKNOWN);this.set("iStatus","");this.tabstrip.clear();},validateCurrentForm:function C(AA){var AB=this,AC=this.validateBtn,z=function(AD){E(AC,false);AB.set("vStatus",AD.vs);AB.set("iStatus",AD.rjed||"");AB.updateInputBoxItems({items:AD.items});AB.statusNode.style.display="block";AB.handleValidation(AD);if(AA){AA(AD.items,AD.vs===o.VALID);}};AB.set("vStatus",o.VALIDATING);E(AC,true);G(this.attrid,{items:this.inputBox.items},AB.curFormIdx===0,z);},validateAllForms:function w(AB){var AC=this,AA=AC.forms,z=0,AD=function(AG){var AF=(z===0);if(AG){var AE=AA[z-1];AE.ftk=AG.items;AE.vs=AG.vs;AE.is=AG.rjed||"";AE.tokenXML=U({items:AG.items});if(AG.vs!==o.VALID){AC.selectFormTab(z-1);AC.handleValidation(AG);if(AB){AB(null,false);}return ;}}if(z===AA.length){if(AB){AB(AA,true);}return ;}G(AC.attrid,{items:AA[z++].ftk},AF,AD);};P(AC);AD();},continueValidataion:function R(){this.validateCurrentForm();},getStatusDesc:function h(z){return{0:mstrmojo.desc(11655,"Valid Formula.")}[z];},onObjectInsert:function I(AC){var AD=this.inputBox,AB=J(AC),z=AD.insertTokens([AB]),AA;if(AC.t===12&&AB.ift&&!AB.exv){AA=AD.ctxtBuilder.itemWidgets[z];if(AA){AD.startTokenSuggestion(AA);}}}});mstrmojo.ME.AttributeEditBox.preprocessTokenStream=g;mstrmojo.ME.AttributeEditBox.postprocessTokenStream=a;mstrmojo.ME.AttributeEditBox.mapErrorCode=e;mstrmojo.ME.AttributeEditBox.getTokenStreamXML=U;mstrmojo.ME.AttributeEditBox.validateSyntax=G;mstrmojo.ME.AttributeEditBox.prepareInsertToken=J;mstrmojo.ME.AttributeEditBox.AEHelpFn=Z;}());(function(){mstrmojo.requiresCls("mstrmojo.array","mstrmojo.hash","mstrmojo.expr","mstrmojo.string","mstrmojo.form","mstrmojo._FormatDefinition","mstrmojo.ME.MetricDataService","mstrmojo.ME.MetricEditBox","mstrmojo.mstr.EnumDataType","mstrmojo.ME.Enum","mstrmojo.mstr.EnumDSSXMLObjectTypes","mstrmojo.mstr.EnumDSSXMLObjectSubTypes","mstrmojo.PassThroughOptions");mstrmojo.requiresDescs(218,219,221,531,628,1442,1918,2102,2116,2154,2213,2919,5298,5424,5728,5891,7558,7984,7987,11566,13249,15656);var p=mstrmojo.array,F=mstrmojo.string,u=mstrmojo.mstr.EnumDataType,A=mstrmojo.ME.MetricDataService,t=mstrmojo.mstr.EnumDSSXMLObjectTypes,W=mstrmojo.mstr.EnumDSSXMLObjectSubTypes,H=mstrmojo.hash;function V(AC){var z=AC.items,S=z.length,AB="",AA;for(AA=0;AA<S;AA++){AB+=z[AA].v;}return AB;}var L=mstrmojo.dom,E=mstrmojo.string,R=mstrmojo._FormatDefinition,o=mstrmojo.ME.MetricEditBox.VALIDATION_STATUS,C=mstrmojo.ME.Enum.METRIC_EDIT_TYPES;var Y=function(S){if(!S){return o.VALID;}return{"-2147214845":o.ERROR,"-2147214846":o.AMBIGUITY}[S]||o.ERROR;},X=function(AF){var AC=AF.items,z=AC.length,AE=AC[AC.length-1],AB,AD,AA=[],S="";if(AC[0]&&AC[0].tp!==38){AA.push({v:"&",tp:38,lv:4,sta:2});}for(AB=0,z=AC.length;AB<z;AB++){AD=AC[AB];if(AD.isNew&&!AD.oi&&AD.tp!==283){S+=AD.v;}else{if(!E.isEmpty(S)){AA.push({v:S,tp:2,lv:1});S="";}AA.push(AD);}}if(!E.isEmpty(S)){AA.push({v:S,tp:2,lv:1});S="";}if(AE&&AE.tp!==-1){AA.push({v:"",tp:-1,lv:4,sta:2});}return{items:AA};},P=function(AA){var AB=X(AA.tks);var z={items:true,v:true,tp:true,lv:true,oi:true,n:true,did:true,t:true,st:true,exv:true,extp:true,asc:true},S={getArrItemName:function(AE,AC,AD){return"tkn";},isSerializable:function(AE,AD,AC){return(z[AE])?true:false;}};return E.json2xml("tknstrm",AB,S);},n=function(AB){var z=AB.items,S=z.length,AA=z[z.length-1];if(AA&&AA.tp===-1){z.pop();}if(z[0]&&z[0].tp===38){z.splice(0,1);}},q=function(S){return"";},l=function(S,AA){var z=[];S.oi.tks.items=z;AA.clearTokens(z);},M=function(AD,AC){var AB=[];AB.push("<mt>");if(AD.fmt&&!AC){var S={getArrItemName:function(AG,AE,AF){return AG.substr(0,AG.length-1);},isSerializable:function(AL,AJ,AI){if(mstrmojo.array.indexOf(["header_format","grid_format"],AL)>-1){var AM=AJ[AI][AL];if(!AM){return{};}var AG="<"+AL+">",AK;for(AK in AM){AG+="<prs n='"+AK+"'>";var AF=AM[AK],AE;for(AE in AF){var AH=AF[AE];AG+="<pr n='"+AE+"' v='"+(AH==="pru"?"":AH)+"'";AG+=AH==="pru"?' pru="1"':"";AG+="/>";}AG+="</prs>";}AG+="</"+AL+">";return{child:AG};}return true;},skipNull:true};AB.push(E.json2xml("fmt",AD.fmt,S));}if(AD.prss&&!AC){var AA={getArrItemName:function(AG,AE,AF){return AG.substr(0,AG.length-1);},isSerializable:function(AL,AI,AG){if(mstrmojo.array.indexOf(["AnalyticalEngineProperties","DatamartProperties","VLDBSelect","VLDBFunction","VLDBReport"],AL)>-1){var AH=AI[AG][AL];if(!AH){return{};}var AF=[],AJ=[],AK;AF.push("<prs n='"+AL+"' ");for(AK in AH){var AE=AH[AK];if(AE!=null){if(typeof AE==="object"){AJ.push(E.json2xml("pr",AE,{skipNull:true,convertBoolean:true,isSerializable:function(AO,AN,AM){return true;}}));}else{AF.push(AK+"='"+AE+"' ");}}}AF.push(">");AF.push(AJ.join(""));AF.push("</prs>");return{child:AF.join("")};}return true;},skipNull:true};AB.push(E.json2xml("prss",AD.prss,AA));}if(AD.mps){AB.push(E.json2xml("mps",AD.mps,{skipNull:true,convertBoolean:true,isSerializable:function(AG,AF,AE){return true;}}));}if(AD.datp&&!AC){AB.push(E.json2xml("datp",AD.datp,{skipNull:true,convertBoolean:true,isSerializable:function(AG,AF,AE){return true;}}));}if(AD.sbs&&!AC){var z={getArrItemName:function(AG,AE,AF){return(AG==="avs")?"sb":AG.substr(0,AG.length-1);},isSerializable:function(AG,AF,AE){return true;},skipNull:true};AB.push(E.json2xml("sbs",AD.sbs,z));}AB.push("</mt>");return AB.join("");},G=function(z,S){z.set("enabled",!S);var AA="mstrmojo-InlineWaitIcon";if(z.iconClass){z.set("iconClass",z.iconClass.replace(new RegExp(AA),"")+" "+(S?AA:""));}else{mstrmojo.css.toggleClass(z.domNode,AA,S);}},I=function(z,S){var AA={taskId:"saveMetricDefinition",tokenStreamXML:P(z),localSymbolFolderXML:q(z),metricXML:M(z),metricId:z.did||"",outputFlags:327695,description:z.desc||"",name:z.n||"",saveAs:S};if(E.isEmpty(z.metricId)){AA.isNew=true;}return AA;},O=function(AA){var z=function(AB){var AD=this.parent;var AC=mstrmojo.desc(7987,"The ## '###' has been saved successfully.").replace("##","Object").replace("'###'","");if(AD){AD.ob.refreshContent();AD.onObjectSaved({name:AD.name,did:AB.did,desc:AD.desc});AC=mstrmojo.desc(7987,"The ## '###' has been saved successfully.").replace("##",AD.typeDesc||"Object").replace("###",AD.name);}mstrmojo.alert(AC,AA.onSaved,mstrmojo.desc(7984,"Object Saved"));if(AD){AD.close();}AA.dirty=false;},S={success:z,failure:mstrmojo.SaveAsEditor.SAVEAS_CALLBACK.failure};return S;},K=function K(AF){var AB=AF.items,S;for(var AA=0;AA<AB.length;AA++){var AG=AB[AA];if(AG&&AG.oi&&A.hasLookupForAttributesProps(AG.oi.did)){var AE=AB[AA+1];if(AE.v==="<"){var AC=false;for(var AD=AA+2;AD<AB.length&&AB[AD].v!==">";AD++){var z=AB[AD];if(z&&z.v==="UseLookupForAttributes"){AC=true;break;}}if(!AC){S=AA+2;AB.splice(S,0,{v:"UseLookupForAttributes"},{v:"="},{v:"False"},{v:","});AA=AA+5;}}else{S=AA+1;AB.splice(S,0,{v:"<"},{v:"UseLookupForAttributes"},{v:"="},{v:"False"},{v:">"});AA=AA+5;}}}},N=function(AF,AC){var AA=this;G(AA,true);var AG=mstrmojo.ME._MetricEditorHelper.oi=AF.oi,AB=P(AG),AD=q(AG),AE=M(AG,true),AH=function(AK){if(AK&&AK.tks){var AL=AK.tks;n(AL);var AJ=AL.items;if(mstrApp&&mstrApp.isVI){AG.conditions=[];var AI=mstrApp&&mstrApp.getRootController().docCtrl.model;p.forEach(AJ,function(AO){var AP=AO.oi,AQ=AP&&AP.t,AM=AP&&AP.st,AN=AP&&AP.did;if(AQ===t.Filter&&AM===W.Filter){var AR=AI.getEmbeddedFilter(AN);if(AR){AP.isEmbedded=true;AG.conditions.push(AR);}}});}AG.tks=AL;if(AF.clientSideValidation){AF.clientSideValidation(AL);}AF.checkEditorFallback(AF.ide.candidates.items,AG);AL.vs=Y(AL.rjec);AF.set("vStatus",AL.vs);AF.set("iStatus",AL.rjed||"");if(AF.handleValidation){AF.handleValidation(AL);}if(AC&&(AL.vs===o.VALID)){K(AL);switch(AC){case"save":case"saveAs":if(AF.isDME){AF.handleDerivedMetricAction(AC,AG);}else{AF.handleMetricAction(AC,AG);}break;case"switch":if(AF.cbSwtichEditor){AF.cbSwtichEditor(AF);}break;}}else{if(AC&&AL.vs===o.ERROR){mstrmojo.alert(mstrmojo.desc(9826,"The metric definition has an error. Please correct before proceeding."),null,mstrmojo.desc(9571,"Syntax Error!"));}}}},z=function(AI){mstrmojo.alert(AI.message||AI.getResponseHeader("X-MSTR-TaskFailureMsg"));},S=function(AI){G(AA,false);};A.validateMetric({tokenStreamXML:AB,localSymbolFolderXML:AD,metricXML:AE,metricId:AG.did,isNew:E.isEmpty(AG.did),msgID:AF.ide.isDME?mstrApp.getMsgID():null},{success:AH,failure:z,complete:S});},D=function(z,AB){var AC=AB,S=AC.oi.fmt,AA=R.MetricFormatTarget;G(z,true);window.setTimeout(function(){if(!S){S=AC.oi.fmt={};var AD;for(AD=0;AD<AA.length;AD++){S[AA[AD].p]={};}}var AE=L.position(z.domNode,true);AC.openPopup("formatPopupRef",{zIndex:AC.zIndex+10,model:S,left:Math.max(0,(AE.x-(AC.formatPopupRef.width||565)))+"px",top:AE.y+"px"});G(z,false);},50);},j=function(AA,AB){var AC=AB,S=AC.oi,z=function(){var AD=L.position(AA.domNode,true);AC.openPopup(mstrmojo.all.mstrMEOptionsDialog||"optionPopupRef",{zIndex:AC.zIndex+10,model:S,funcs:AC.funcs,left:Math.max(0,(AD.x-(AC.optionPopupRef.width||565)))+"px",top:AD.y+"px"});};if(!AC.isDME&&!AC.funcs){G(AA,true);A.getSubtotalFunctions(null,{success:function(AD){if(AD.items){AC.funcs=AD.items;z();G(AA,false);}},failure:function(AD){mstrmojo.alert(AD.message||AD.getResponseHeader("X-MSTR-TaskFailureMsg"));G(AA,false);}});}else{z();}},w=function(z,AA){var AC=L.position(z.domNode,true),AB=H.any(AA.ide.datasets),S={zIndex:AA.zIndex+10,left:Math.max(0,(AC.x-(AA.ptoPopupRef.width||333)+AC.w/2))+"px",top:AC.y+"px",mptf:AA.mptf||_getMptfFromDataset(AA),dbt:AB.tables[0].dbt,so_dft:AB.so_dft,sim_dft:AB.sim_dft,onOK:function(AE){AA.mptf=AE;var AD=_getMptfFromDataset(AA);if(!H.equals(AD,AE)){AE.dirty=true;}}};AA.openPopup("ptoPopupRef",S);};_getMptfFromDataset=function(AA){var S=mstrApp&&mstrApp.getRootController().docCtrl.model,AC=AA.oi.did,AB=S.findUnitInDataSet(AC),z;if(AB){z=H.clone(AB.mptf);}else{z={mptso:{pru:1,v:0},mptsim:{pru:1,v:0},mptfms:""};}return z;};mstrmojo.ME._MetricEditorHelper=mstrmojo.provide("mstrmojo.ME._MetricEditorHelper",{noCache:true,useKeyDelay:true,tbBrowsable:true,functionNameRef:{scriptClass:"mstrmojo.Label",alias:"fnLabel",cssClass:"mstrmojo-ME-fct-name",bindings:{visible:function(){return !this.parent.insertMode;},text:function(){return mstrmojo.desc(5424,"Function:")+" "+this.parent.fctName;}}},nameEditBoxRef:{scriptClass:"mstrmojo.Box",alias:"nameEditBox",cssClass:"mstrmojo-ME-nameEditBox",cssDisplay:"inline-block",visible:false,bindings:{visible:function(){return !this.parent.insertMode&&this.parent.visible;}},onvisibleChange:function(S){if(S.value==false){return ;}var z=this;if(!z.tmr){z.tmr=window.setInterval(function(){if(z.domNode){window.clearInterval(z.tmr);delete z.tmr;z.nameInput.inputNode.select();}},50);}},children:[{alias:"nameInput",scriptClass:"mstrmojo.TextBoxWithLabel",inputNodeCssClass:"mstrmojo-ME-nameInput",value:mstrmojo.desc(2213,"New metric"),size:20,useRichTooltip:true,showErrTooltip:function x(){var z=L.position(this.domNode),S=E.isEmpty(this.value)?mstrmojo.desc(9122,"Name cannot be empty"):mstrmojo.desc(11569,"Input contains invalid character");this.richTooltip={contentNodeCssClass:"me-tooltip-content left me-err",content:'<div class="content"><span>'+S+"</span></div>",top:z.y-5,left:z.x+z.w+10};this.hasOpenTooltip=false;this.showTooltip();},bindings:{value:function(){var S=this.parent.visible;return this.parent.parent.oi.alias||this.parent.parent.oi.n;},label:function(){var z=this.parent.parent.ide||{},S=z.nameLabel||mstrmojo.desc(11566,"Metric Name:");return this.parent.parent.oi.alias?mstrmojo.desc(13249,"Display Name:"):S;}},onvalueChange:function(AA){var S=this.parent.parent.ide.action.alias,AE=function(AF){return !E.isEmpty(AF)&&(S?true:!/[\[\]\"\\]/g.test(AF));},AD=AE(this.value);if(AD){this.hideTooltip();}else{this.showErrTooltip();}mstrmojo.css.toggleClass(this.parent.domNode,"err",!AD);var AB=this.parent.parent;AB.set("cValid",AD);var AC=AB.oi;if(AC){var z={n:AC.n,alias:AC.alias};AC.n=this.value;AC.alias=this.value;if(AC.n!==z.n&&AC.alias!==z.alias){AB.dirty=true;}}}}]},saveasRef:{scriptClass:"mstrmojo.SaveAsEditor",typeDesc:"Metric",browsableTypes:"4,8",onObjectSaved:function(AA){var z=this.opener,S=z&&z.oi;if(z&&S){S.did=AA.did;S.n=AA.name;S.desc=AA.desc;z.set("title",mstrmojo.desc(2154,"Metric:")+" "+AA.name);}}},optionPopupRef:{id:"mstrMEOptionsDialog",scriptClass:"mstrmojo.ME.OptionDialog",title:mstrmojo.desc(9572,"Advanced Metric Options"),help:"Advanced_Metric_Options_dialog_box.htm",height:340},ptoPopupRef:{scriptClass:"mstrmojo.PassThroughOptions",help:"create_derived_metric_mdx_hierarchy_reports.htm",width:333},formatPopupRef:{scriptClass:"mstrmojo.ME.MetricFormatEditor",contentNodeCssClass:"mstrmojo-balloon",alias:"formatEditor",title:mstrmojo.desc(2116,"Format"),left:"100px",top:"100px",useAnimate:false,height:360,width:565,help:"Format_Metric_dialog_box.htm",locksHover:true},ob:{scriptClass:"mstrmojo.Editor",title:mstrmojo.desc(5298,"Select an Object"),help:"Select_Objects_dialog_box_.htm",children:[{scriptClass:"mstrmojo.ObjectBrowser",alias:"browser",cssText:"width:200px;",fishEyeVisible:false,closeable:false,closeOnSelect:false}]},switchRef:{scriptClass:"mstrmojo.Button",slot:"buttonNode",alias:"switchToMetricEdtior",cssClass:"mstrmojo-ME-switch mstrmojo-Editor-button mstrmojo-WebButton",text:mstrmojo.desc(9563,"Switch to Formula Editor"),closeAfterSwitch:true,bindings:{visible:function(){return !this.parent.insertMode;}},getEditor:function(){return this.parent;},getFormulaEditorId:function(){var S=this.getEditor();return(S.ide&&S.ide.formulaEditorId)||"mstrME";},onclick:function(){var AA=this.getEditor(),z=this.getFormulaEditorId();AA.oi.tks.items=AA.getMetricDefAsTokens();var S={vStatus:mstrmojo.ME.MetricEditBox.VALIDATION_STATUS.UNKNOWN,oi:AA.oi,did:AA.oi.did,cValid:true};if(AA.dirty){S.dirty=AA.dirty;}if(AA.mptf){S.mptf=AA.mptf;}AA.switch2Editor(z,S);if(AA.ide){AA.ide.set("showLeftPanel",true);AA.set("simple",false);}}},formatAndOptionsBarRef:{scriptClass:"mstrmojo.HBox",alias:"formatbar",cssClass:"mstrmojo-ME-formatbar",children:[{scriptClass:"mstrmojo.Button",cssClass:"mstrmojo-ME-link format",alias:"formatButton",text:mstrmojo.desc(1918,"Format"),bindings:{visible:function(){return this.parent.parent.tbFormatable&&!this.parent.parent.insertMode;}},onclick:function(){D(this,this.parent.parent);}},{scriptClass:"mstrmojo.Button",cssClass:"mstrmojo-ME-link property",alias:"optButton",text:mstrmojo.desc(13035,"Metric Options"),bindings:{visible:function(){var S=this.parent.parent;return !S.insertMode&&!S.ide.disableAFB;}},onclick:function(){j(this,this.parent.parent);}},{scriptClass:"mstrmojo.Button",cssClass:"mstrmojo-ME-link property",alias:"ptoButton",text:mstrmojo.desc(15656,"Pass-through Options"),bindings:{visible:function(){var S=this.parent.parent;return !S.insertMode&&S.ide.enablePTO&&(S.id===((S.ide&&S.ide.formulaEditorId)||"mstrME"));}},onclick:function(){w(this,this.parent.parent);}}]},saveLabel:mstrmojo.desc(5891,"Save"),saveAsLabel:mstrmojo.desc(628,"Save As"),closeLabel:mstrmojo.desc(221,"Cancel"),saveAsEnabled:true,cValid:true,buttonBarRef:{scriptClass:"mstrmojo.HBox",alias:"buttonBar",slot:"buttonNode",cssClass:"mstrmojo-ME-buttonBox",cellCssClass:"subBox",children:[{scriptClass:"mstrmojo.Button",cssClass:"mstrmojo-Editor-button mstrmojo-WebButton hot",alias:"saveokButton",text:"",bindings:{enabled:function(){return this.parent.parent.cValid;},text:function(){return this.parent.parent.insertMode?mstrmojo.desc(531,"Add"):this.parent.parent.saveLabel;}},onclick:function(){var z=this.parent.parent;if(!z.insertMode&&z.isDirty&&!z.isDirty()){z.close();z.onCancel();return ;}if(!z.cValid){return ;}if(z.insertMode){z.insertOnFinish(z.getMetricDefAsTokens());z.close();}else{if(z.getMetricDefAsTokens){z.oi.tks.items=z.getMetricDefAsTokens();}var S=this;if(z.validateAndSave){G(S,true);z.validateAndSave(z.oi,function(){G(S,false);});}else{if(z.ide&&z.ide.validateAndSave){G(S,true);z.ide.validateAndSave(z.oi,function(){G(S,false);});}else{z.tbValidate=this;N.call(this,z,"save");}}}}},{scriptClass:"mstrmojo.Button",cssClass:"mstrmojo-Editor-button mstrmojo-WebButton",alias:"btnSaveAs",text:mstrmojo.desc(628,"Save As"),bindings:{visible:function(){return !this.parent.parent.insertMode&&!this.parent.parent.isDME;},text:function(){return this.parent.parent.saveAsLabel;}},onclick:function(){var S=this.parent.parent;if(S.getMetricDefAsTokens){S.oi.tks.items=S.getMetricDefAsTokens();}S.tbValidate=this;N.call(this,this.parent.parent,"saveAs");}},{scriptClass:"mstrmojo.Button",cssClass:"mstrmojo-Editor-button mstrmojo-WebButton",bindings:{text:function(){return this.parent.parent.closeLabel;}},onclick:function(){var S=this.parent.parent;if(S.onPreClose()){S.close();if(!S.insertMode){S.onCancel();}}}}]},validateSyntax:function B(S){N.call(S,this);},validateSyntaxAndSwitch:function c(S){N.call(S,this,"switch");},preprocessTokenStram:function U(S){n(S);},isDirty:function k(){if(this.insertMode){return false;}return this.dirty||this.oi.dirty||(this.oi.fmt||{}).dirty||(this.oi.mps||{}).dirty||(this.mptf||{}).dirty;},onmetricModify:function h(){this.dirty=true;},save:function Q(){this.buttonBar.btnSaveAs.onclick();},prompt2saveRef:{scriptClass:"mstrmojo.Editor",cssText:"width:350px;",title:mstrmojo.desc(5728,"Confirm save"),children:[{scriptClass:"mstrmojo.Label",cssText:"margin:5px 5px 20px;",allowHTML:true,bindings:{text:function(){return mstrmojo.desc(9573,"Do you want to save changes made to #?").replace("#","<b>"+mstrmojo.string.encodeHtmlString(this.parent.opener.oi.n)+"</b>");}}},{scriptClass:"mstrmojo.HBox",alias:"buttonBar",slot:"buttonNode",cssClass:"mstrmojo-ME-buttonBox",cellCssClass:"subBox",children:[{scriptClass:"mstrmojo.HBox",cssClass:"left",cssText:"width:10px;"},{scriptClass:"mstrmojo.HTMLButton",cssClass:"mstrmojo-Editor-button",text:mstrmojo.desc(219,"Yes"),onclick:function(){var S=this.parent.parent;S.opener.save();S.close();}},{scriptClass:"mstrmojo.HTMLButton",cssClass:"mstrmojo-Editor-button",text:mstrmojo.desc(218,"No"),onclick:function(){var S=this.parent.parent;S.opener.close();if(S.opener.onCancel){S.opener.onCancel();}S.close();}},{scriptClass:"mstrmojo.HTMLButton",cssClass:"mstrmojo-Editor-button",text:mstrmojo.desc(221,"Cancel"),onclick:function(){var S=this.parent.parent;S.close();}}]}]},prompt2save:function(){if(this.getMetricDefAsTokens){this.oi.tks.items=this.getMetricDefAsTokens();}this.openPopup("prompt2saveRef",{zIndex:this.zIndex+1});},handleMetricAction:function f(AA,z){var S=this;var AB=I(z,false);if((AA==="save")&&z.did){mstrmojo.xhr.request("POST",mstrConfig.taskURL,O(S),AB);}else{if(((AA==="save")&&E.isEmpty(z.did))||AA==="saveAs"){AB.saveAs=true;S.openPopup("saveasRef",{zIndex:S.zIndex+10,folderLinksContextId:17,name:z.n||z.name||(S.name&&S.name.value)||mstrmojo.desc(2213,"New Metric"),saveParams:AB,saveAsCallback:function(){var AC=O(S);if(AC.success){var AD=AC.success;AC.success=function(AE){AD.call(this,AE);if(S.ide.noRefresh!==true){var AF=mstrApp;mstrmojo.form.send({evt:5005,src:AF.name+"."+AF.pageName+".5005"});}};}return AC;}});}}},handleDerivedMetricAction:function g(AC,AB){AB=AB||this.oi;if(AC==="save"){var S={tokenStreamXML:P(AB),alias:AB.n};var z=AB.mps||{};if(z.dirty){if(z.fbf===0){z.afb=z.sfb=-1;}S.afb=z.afb;S.sfb=z.sfb;}if(this.originTks){S.originTokenStream=P({tks:{items:this.originTks}});S.originAfb=this.originAfb;S.originSfb=this.originSfb;}var AD=mstrmojo.all.mstrMetricIDE,AA=AD.disableAFB;if(AA){S.afb=0;S.sfb=1;}if((this.mptf||{}).dirty){S.mptf=this.mptf;}AD.onApplyMetricCallback(S);AD.close();}},onPreClose:function(){var S=this;if(S.isDirty&&S.isDirty()&&!this.isDME){S.prompt2save();return false;}return true;},onClose:function a(){this.dirty=false;delete this.mptf;if(this.onPostClose){this.onPostClose();}},init:function r(AA){if(this._super){this._super(AA);}var AB=mstrApp,S=AB&&AB.useQuickSearch&&AB.useQuickSearch(),z=S?((AB&&AB.searchAutoCompleteDelay&&AB.searchAutoCompleteDelay())||0):0;this.suggestDelay=z||200;this.noCache=this.noCache&&S&&!this.isDME;this.ob.children[0].quickSearch=S;A.suggestDelay=this.suggestDelay;A.noCache=this.noCache;},_setupCandidatesCache:function m(S){if(this.candidates&&S){S.candidates=null;S.set("candidates",this.candidates);}},item2textCss:function J(S){return"mstrmojo-ME-icon t"+S.t+(S.st?" st"+S.st:(S.um||S.da?"d":""));},getSpecialFunctionEditorId:function e(S,AB){var AA=S&&S.did,z;if(AA){if(A.isBasicAggMap(AA)){z="mstrSME";}else{if(A.isRank(AA)){z="mstrRFE";}else{if(A.isOLAPAgg(AA)){z="mstrOFE";}else{z="mstrFE";}}}if(z){z+=AB?"_1":"";}}return z;},isDimty:function(z,S){return(/^@[a-z]{1,}(\s*[+-]\s*\d{1,})?$/i).test(F.trim(z));},validateByDataType:function d(z,S){var AA=false;switch(z){case u.DataTypeInteger:AA=/^(-)?\d+$/.test(S);break;case u.DataTypeNumeric:case u.DataTypeReal:case u.DataTypeDouble:AA=mstrmojo.num.isNumeric(S);break;case u.DataTypeChar:case u.DataTypeVarChar:AA=true;break;case u.DataTypeDate:case u.DataTypeTimeStamp:AA=true;break;default:AA=true;}return AA;},getRootFunction:function b(AA){var z,S=AA&&AA.tks&&AA.tks.met;if(S!==C.ADVANCED){var AB=AA.tks.items[0];z=AB&&AB.oi;}return z;},checkEditorFallback:function Z(S,AB){var z=this.getRootFunction(AB),AA=mstrmojo.array.find(S,"did",z&&z.did)===-1;if(AA&&AB&&AB.tks&&AB.tks.items&&AB.tks.items.length>0){AB.tks.met=C.ADVANCED;}return AA;}});mstrmojo.ME._MetricEditorHelper.getTokenStreamXML=P;}());(function(){mstrmojo.requiresCls("mstrmojo.array","mstrmojo.ME.MetricEditBox","mstrmojo.warehouse._CanToggleAvatarClass");var U=mstrmojo.array,I=mstrmojo.string,X=mstrmojo.css,V=mstrmojo.dom,Q="visible",Z=["(",")","{","}","-","+","*","/","<",">","=","|","~",","," ","\t","\n",";"],Y=null,A=mstrmojo.warehouse.EnumObjectTypes,L=A.TABLE,O=A.COLUMN;function M(b){var a;if(!Y){Y={};for(a=0;a<Z.length;a++){Y[Z[a]]=true;}}return Y[b];}mstrmojo.architect.ui.SQLInputBox=mstrmojo.declare(mstrmojo.ME.MetricEditBox,[mstrmojo.warehouse._CanToggleAvatarClass],{scriptClass:"mstrmojo.architect.ui.SQLInputBox",cssClass:"mstrmojo-ar-sqlInput-inputbox",dropZone:true,allowDrop:function B(b){var c=[].concat(b.src.data)[0],a=mstrApp.rootController.model;if(!c){return false;}if(!((c.tp===O)||(c.tp===L))){return false;}return(a.SelDBRoleID===a.projPrimaryDBRoleID);},ondrop:function S(c){var e=this,d=[].concat(c.src.data)[0],b=this.inputBox.items,g=function g(h){b=[{v:"select"}];b.push({v:String.fromCharCode(10)});U.forEach(h,function(j){b.push({v:j.cln});b.push({v:", "});});b.pop();b.push({v:String.fromCharCode(10)});b.push({v:"from"});b.push({v:String.fromCharCode(10)});b.push({v:d.n});e.inputBox.set("items",b);e.parent.execSQL.onclick({cancel:mstrmojo.emptyFn});e.inputBox.focus();};if(!d){return ;}this.inputBox.set("items",[]);switch(d.tp){case O:b.push({v:d.cln});this.inputBox.set("items",b);break;case L:var a=(c.src.widget.alias==="dbTableTree");if(a){mstrApp.rootController.getColumnsForDBTable({data:d},{success:function f(h){g(h.items);}});}else{mstrApp.rootController.model.getAttributesFactsInTable(d.did,{success:function f(){g(mstrApp.rootController.model.getTable(d.did).columns);}});}break;}},postBuildRendering:function R(){if(this._super){this._super();}this.onheightChange({value:this.height});this.onwidthChange({value:this.width});this.reset();},onheightChange:function G(b){var c=this.inputBox,a=b.value;if(c.hasRendered&&a!==undefined){c.height=a;c.domNode.style.height=a;c.editNode.style.height=a;}},onwidthChange:function J(a){var c=this.inputBox,b=a.value;if(c.hasRendered&&b!==undefined){c.width=b;c.editNode.style.width=b;}},tables:[],columns:[],sqlFunctions:[{n:"Select"},{n:"Update"},{n:"Insert"},{n:"Delete"},{n:"Create"},{n:"Drop"},{n:"Alter"},{n:"Set"},{n:"Exec"},{n:"From"},{n:"Where"},{n:"Having"},{n:"In"},{n:"Group"},{n:"By"},{n:"Order"},{n:"Into"},{n:"On"},{n:"Values"},{n:"Table"},{n:"Case"},{n:"Then"},{n:"Else"},{n:"Join"},{n:"As"}],getSQLStatement:function E(){var a=[];U.forEach(this.inputBox.items,function(b){a.push(b.v);});return I.trim(a.join("").replace(/<\s/g,"<").replace(/>\s/g,">"));},setSQLStatement:function H(g){var d=[],c,e="\n",a=", ",f=g.split(e),b;U.forEach(f,function(h){c=I.trim(h);if(c.indexOf(a)>0){b=c.split(a);U.forEach(b,function(j){d.push({v:I.trim(j)});d.push({v:a});});d.pop();}else{d.push({v:c});}d.push({v:e});});this.inputBox.set("items",d);},onvisibleChange:function N(){X.toggleClass(this.domNode,Q,this.visible);X.toggleClass(this.inputBox.domNode,Q,this.visible);},reset:function W(){var a={items:this.sqlFunctions.concat(this.tables).concat(this.columns),isComplete:true};this.inputBox.set("candidates",a);this.inputBox.set("items",[]);},children:[{scriptClass:"mstrmojo.ME.TokenInputBox",cssClass:"mstrmojo-ar-sqlInput-tokenbox",alias:"inputBox",slot:"editNode",browseItemVisible:false,renderBlockSize:1000,lastPagePos:{left:0,top:0,width:0,height:0},lastScrollPos:{left:0,top:0,width:0,height:0},breakOnEnterKeyDown:function P(){return !this.suggestionShown;},getCharacter:function C(b){var a=(V.isIE&&!V.isIE9)?b.keyCode:b.charCode;return(a>0)?((a===13)?"\n":String.fromCharCode(a)):null;},ondrop:function(a){this.parent.ondrop(a);},ondragenter:function K(a){this.parent.ondragenter(a);},allowDrop:function B(a){return this.parent.allowDrop(a);},item2textCss:function F(a){return{15:" mstrmojo-ArchitectListIconSuggest t15 ",26:" mstrmojo-ArchitectListIconSuggest t26 "}[a.tp||a.t]||"";},itemFunction:function D(b){return new mstrmojo.ME.MetricToken({data:b,brackets:function(c){return c;},isDelimiter:function a(){var c=this.data,d=c.v.length;if(c){return c.isDelimiter||(d===1&&M(c.v));}return false;}});},isDelimiter:M}]});}());(function(){mstrmojo.requiresCls("mstrmojo.ui.Splitter","mstrmojo.qb.QBMappings");mstrmojo.requiresDescs(12735);var D="firstSplitNode",C="secondSplitNode";function F(M,J,H){if(M.ignoreLayout){return ;}var I=(J==="auto")||J==="NaNpx",L=(H==="auto")||H==="NaNpx";var K=M.getLayoutOffsets&&M.getLayoutOffsets();if(K){if(!I){J=(parseInt(J,10)-K.h)+"px";}if(!L){H=(parseInt(H,10)-K.w)+"px";}}if(M.setDimensions){M.setDimensions(J,H);}else{if(M.set){if(!I){M.set("height",J);}if(!L){M.set("width",H);}}}}mstrmojo.qb.QBPageLayout=mstrmojo.declare(mstrmojo.ui.Splitter,null,{cssClass:"mstrmojo-qb-whole-panel",workPanel:null,whPanel:null,config:{firstSplit:{v:"20%",min:"300px",max:undefined},secondSplit:{v:"80%",min:"300px",max:undefined},resizeHandle:{v:"2px"}},afterLayout:function B(){var I=parseInt(this.whPanel.width,10);var H=parseInt(this.width,10);if(I<300){F(this.whPanel,this.height,"300px");F(this.workPanel,this.height,(H-300-2)+"px");this.setSlotDimensions(D,this.height,"300px");this.setSlotDimensions(C,this.height,(H-300-2)+"px");}},getLayoutOffsets:function G(){return{w:36,h:0};},toggleDatabaseView:function A(H){this.toggleFirstItemVisibility(H);},toggleDataPreview:function E(H){this.workPanel.toggleSecondItemVisibility(H);},children:[{scriptClass:"mstrmojo.warehouse.WHPanel",slot:D,alias:"whPanel",config:{firstSplit:{v:"40%",min:"100px"},secondSplit:{v:"60%",min:"100px"},resizeHandle:{v:"1px"}}},{scriptClass:"mstrmojo.ui.Splitter",cssClass:"mstrmojo-qb-main-panel",alias:"workPanel",slot:C,orientation:mstrmojo.ui.Splitter.ENUM_OR.VERTICAL,getLayoutOffsets:function G(){return{h:0,w:12};},children:[{scriptClass:"mstrmojo.qb.QBPanel",slot:D},{scriptClass:"mstrmojo.qb.QBMappings",alias:"mappingPanel",slot:C}],config:{firstSplit:{v:"50%",min:"150px",max:undefined},secondSplit:{v:"50%",min:"150px",max:undefined},resizeHandle:{v:"5px"}}}]});}());(function(){mstrmojo.requiresCls("mstrmojo.dom","mstrmojo.array","mstrmojo.hash","mstrmojo.func","mstrmojo.Button","mstrmojo.HTMLButton","mstrmojo.HBox","mstrmojo.List","mstrmojo.Label","mstrmojo.ListMapperHoriz","mstrmojo.WidgetList","mstrmojo.WidgetListMapper","mstrmojo.TristateCheckBox","mstrmojo.Pulldown","mstrmojo.ACL.UserTreeBrowser","mstrmojo.DataGrid","mstrmojo.DropDownButton","mstrmojo.ListBox","mstrmojo.DivItemRenderer","mstrmojo.VBox","mstrmojo.Box","mstrmojo.ACL.UserInputBox","mstrmojo.Editor","mstrmojo.ACL.UserDataService","mstrmojo.CheckList","mstrmojo.TextBox","mstrmojo.TextBoxWithLabel","mstrmojo.CheckBox","mstrmojo.MouseOverContainer","mstrmojo.util.LibraryHelper");mstrmojo.requiresDescs(1825,8078,8079,629,8080,8081,8082,3336,9048,8083,8084,955,8085,531,8086,8087,8088,8089,8090,767,2056,8091,8093,1442,221,8092,13621,9772,9773,9774,272,271,8145,2509,8146,8147,9775,9776,9777,9771,12299,9151,2156,9892,9890,9891,9099,2140,2102);var W=mstrmojo.dom,E=mstrmojo.css,q=mstrmojo.array,r=mstrmojo.util.LibraryHelper,j=[],z=[{n:mstrmojo.desc(16034,"Grant"),v:0},{n:mstrmojo.desc(16035,"Deny"),v:1},{n:mstrmojo.desc(8441,"Default"),v:2}],Y="sharingEditor",u=199,X="294DEDC011D2F1D56000D98E67019608",I="C82C6B1011D2894CC0009D9F29718E4F",F=[1,4,8,16,32,64,128],B=[mstrmojo.desc(1825,"Browse"),mstrmojo.desc(8078,"Read"),mstrmojo.desc(8079,"Write"),mstrmojo.desc(629,"Delete"),mstrmojo.desc(8080,"Control"),mstrmojo.desc(8081,"Use"),mstrmojo.desc(8082,"Execute")],f=["B","R","W","D","C","U","E"],h=false,x=true,Z=257,w=1024,b=772,d=776,O=777,l=mstrmojo.Button.newWebButton,t=mstrmojo.Button.newActionButton;function g(AC,AD,AB){return{scriptClass:"mstrmojo.HBox",alias:AC,right:AD,cssText:"height:20px;",children:[{scriptClass:"mstrmojo.Label",text:AB,cssText:"width:80px"},{scriptClass:"mstrmojo.Pulldown",cssText:"width:100px",itemIdField:"v",items:z,defaultSelection:2,selectionPolicy:"reselect",_set_value:function(AF,AE){this.value=AE;}}]};}function V(AB){return(AB&&AB.t===8);}function AA(AB){return AB&&AB.st!=Z&&AB.st!=w&&AB.st!=b&&AB.st!=d&&AB.st!=O;}function N(AB){return{"253000":255000,"253":255,"221":223,"197":199,"69":71}[AB]||AB;}function K(AB){return{"253000":255000,"253":255,"32221":223,"56197":199}[AB]||AB;}function c(AH){var AG=[].concat(AH.acls),AB=AH.inhs,AF=AH.acls,AJ,AD,AI,AC,AE;AF.splice(0,AF.length);if(V(AH)){AG=AG.concat(mstrmojo.hash.valarray(AB));}for(AC=0,AE=AG.length;AC<AE;AC++){AJ=AG[AC];AI=AJ.rgt;if(AI>1000){AD=mstrmojo.hash.copy(AJ);AD.den=true;AD.rgt=Math.floor(AI/1000);AF.push(AD);}if((AI%1000)>0){AD=mstrmojo.hash.copy(AJ);AD.den=false;AD.rgt=AI%1000;AF.push(AD);}}return AH;}function U(AC){var AB={isSerializable:function(AF,AE,AD){switch(AF){case"did":case"rgt":case"n":case"acls":case"t":case"st":case"inh":case"den":return true;}return false;},getArrItemName:function(AF,AD,AE){if(AF==="acls"){return"acl";}},convertBoolean:true};return mstrmojo.string.json2xml("oi",AC,AB);}function o(AG,AF){var AD=AG&&AG.oi,AC,AB,AH,AE=AG.oneTierConnectivity;if(AD){AD=c(AD);AC=U(AD);AH={taskId:"saveObjectACL",objectXML:AC,objectType:AD.t,objectID:AD.did,propagateToChildren:AG.childrenAccessPulldown.value};AB={success:function(AI){if(AF){AG.close();}else{mstrmojo.alert(mstrmojo.desc(3336,"## has been saved successfully.").replace("##",AI.n));AG.set("hasChanged",false);}},failure:function(AI){if(AI.getReponseHeader){mstrmojo.alert(AI.getResponseHeader("X-MSTR-TaskFailureMsg"));}if(AF){AG.close();}}};if(AE){delete AH.taskId;AH.connectionId=AE.connectionId;AH.sessionState=AE.sessionState;AE.connectivityProxy.saveObjectACL(AH,mstrmojo.func.wrapMethods(AB,{failure:function(AI){mstrmojo.onetier.vi.prefs.handleErrorMessage(AI);}}));}else{mstrmojo.xhr.request("POST",mstrConfig.taskURL,AB,AH);}}}function p(AJ){var AN=AJ.aclList,AO=AJ.objectInputer,AE=AO.getSelectedObjects(),AG=AE.length,AK=[],AD,AM=199,AC,AL,AB;if(!AO.isValid()){mstrmojo.alert(mstrmojo.desc(9048,"Some users/groups do not exist. Please remove them in order to proceed."),null,AJ.alertTitle);return false;}for(AC=0;AC<AG;AC++){AD=AE[AC];if(AD.did===X||AD.did===I){var AF=mstrmojo.all[Y];if(AM===AF.currentPublicRight){if(x){E.removeClass(AF.userMessage.domNode,"hideMsg");}}}AL=q.find(AN.items,"did",AD.did);if(AL!==-1){AB=AN.items[AL];if(AJ.uneditableRights[AB.rgt]){continue;}}AK.push(new mstrmojo.Obj({n:AD.n,did:AD.did,st:AD.st,rgt:AM,newItem:true}));}if(AK.length>0){var AI=q.findMulti(AN.items,"did",AK);if(AI.count){var AH=AI.indices.concat().sort(q.numSorter).slice(0,AI.count);for(AC=AH.length-1;AC>-1;AC--){AN.remove(AH[AC]);}}AN.add(AK);AJ.set("hasChanged",true);}AO.set("items",[]);return true;}function P(AB){var AD=[],AG=Math.floor(AB/1000),AE=AB%1000,AH=F,AI=B,AF=AH.length,AJ,AC;for(AC=0;AC<AF;AC++){AD.push(AI[AC]);AD.push(" ");if((AE&AH[AC])>0){AD.push(mstrmojo.desc(8083,"Granted"));}else{if((AG&AH[AC])>0){AD.push(mstrmojo.desc(8084,"Denied"));}else{AD.push(mstrmojo.desc(959,"Default"));}}AD.push(",");}AJ=AD.join("");return AJ.substring(AJ,AJ.length-1);}function k(AI){var AF=[],AH=AI%1000,AD=F,AG=f,AB=AD.length,AE,AC;for(AC=0;AC<AB;AC++){if((AH&AD[AC])>0){AF.push(AG[AC]);AF.push(",");}}AE=AF.join("");return AE.substring(AE,AE.length-1);}function R(AD,AE){var AF=AD.items,AC=q.find(AF,AD.itemIdField,AE),AH=AD.customItem,AB=AF.length-2;if(AC===-1){var AG={n:k(AE),rgt:AE};if(AH){AF.splice(AB,1);}AB=AF.length-1;AF.splice(AB,0,AG);AD.customItem=AG;}else{if(AH&&AC!==AB){AF.splice(AB,1);AD.customItem=null;}}if(mstrmojo.all[Y].showACLHint!==false){AD.set("title",P(AE));}AD.value=AE;}function C(AB){return{"776":[{n:mstrmojo.desc(8085,"Consume"),rgt:71},{n:mstrmojo.desc(531,"Add"),rgt:199},{n:mstrmojo.desc(8086,"Collaborate"),rgt:223},{n:mstrmojo.desc(8087,"Full control"),rgt:255},{n:mstrmojo.desc(8088,"Denied all"),rgt:255000},{n:mstrmojo.desc(8089,"Custom ..."),rgt:-1}],"779":[{n:mstrmojo.desc(8085,"Consume"),rgt:71},{n:mstrmojo.desc(531,"Add"),rgt:199},{n:mstrmojo.desc(8086,"Collaborate"),rgt:223},{n:mstrmojo.desc(8087,"Full control"),rgt:255},{n:mstrmojo.desc(8088,"Denied all"),rgt:255000},{n:mstrmojo.desc(8089,"Custom ..."),rgt:-1}]}[AB]||[{n:mstrmojo.desc(8090,"View"),rgt:199},{n:mstrmojo.desc(767,"Modify"),rgt:223},{n:mstrmojo.desc(8087,"Full control"),rgt:255},{n:mstrmojo.desc(8088,"Denied all"),rgt:255000},{n:mstrmojo.desc(8089,"Custom ..."),rgt:-1}];}function S(AI,AG){var AF="";if(AG){var AC=this.widthInput.value,AJ=this.heightInput.value,AB=' src="'+AI,AK="",AD=this.toolbarOptions.checkBoxList,AH=AD.items,AE;for(AE=0;AE<AH.length;AE++){if(!AD.selectedIndices.hasOwnProperty(AE)){if(AK==""){AK="&hiddensections="+AH[AE].alias;}else{AK+=","+AH[AE].alias;}}}AF='<iframe width="'+AC+'" ';AF+='height="'+AJ+'" ';AF+=AB;AF+=AK;AF+='"></iframe>';}else{AF='<iframe width="640" height="480" src="';AF+=AI;AF+='&hiddensections=header,path,dockTop,dockLeft,footer"></iframe>';}return AF;}function n(AD){var AF=mstrmojo.string.parseUri(AD).queryKey,AG=AD.indexOf("?"),AC=AG>0?AD.substring(0,AG):AD;var AB=AC.indexOf(";jsessionid");AC=AB>0?AC.substring(0,AB):AC;if(AF.hasOwnProperty("iframe")){delete AF.iframe;}if(AF.hasOwnProperty("validateRandNum")){delete AF.validateRandNum;}if(!AF.hasOwnProperty("server")){AF.Server=encodeURIComponent(mstrApp.serverName);}if(!AF.hasOwnProperty("Project")){AF.Project=encodeURIComponent(mstrmojo.string.decodeHtmlString(mstrApp.projectName));}if(!AF.hasOwnProperty("port")){AF.Port=mstrApp.serverPort;}if(h&&mstrConfig.shareToGuestWhenEnabled){AF.connmode=8;AF.ru=1;}if(AF.evt!=="3185"){AF.share=1;}AC+="?";for(var AE in AF){AC+=AE+"="+AF[AE]+"&";}AC=AC.substring(0,AC.length-1);return AC;}function M(AB){AB.select();document.execCommand("copy");AB.value=AB.value;mstrmojo.alert(mstrmojo.desc(15340,"The link has been successfully copied to your clipboard"));}function D(AC,AB){return(r.isLibraryConfigured()&&(AC===55||(AC===18&&AB&&AB.contains("documentID"))));}function H(AD,AC,AB){if(AC===18&&D(AC,AB)){var AE=mstrmojo.string.parseUri(AB).queryKey;AD=AE.documentID;}return AD;}function a(AD,AC){var AE=window.location.protocol,AB="mailto:?body="+window.encodeURIComponent(AC)+"&subject="+encodeURI(AD.objectName);if(mstrApp.isSingleTier){window.FormWrapper.openPage(AB);}else{if(!!W.isChrome&&AE==="https:"){window.open(AB,"_self");window.setTimeout("iframe.hideWaitPage()",2000);}else{window.open(AB,"mailtoIframe");}}}function L(AC){var AB;switch(AC){case 199:AB="read";break;case 223:AB="write";break;case 255:AB="full";break;case 255000:AB="deny";break;default:AB="custom";}return"sharingEditor-privilegeIcon "+AB;}function J(AE){var AB=new Date(),AD=this.objectName+" "+AB.toLocaleDateString()+" "+AB.toLocaleTimeString(),AC=this,AF={success:function(AI){var AH=n(AI.url);AC.topSection.authorLinkRow.authorLinkBox.set("value",AH);AC.url=AH;AC.topSection.htmlPanel.htmlLinkRow.htmlBox.set("value",S(AH));var AG=AC.topSection.authorEmail.emailLink;AG.set("url",window.encodeURIComponent(AH));AG.set("name",AC.objectName);},failure:function(AG){mstrmojo.alert(AG.getResponseHeader("X-MSTR-TaskFailureMsg"));},complete:function(){AC.hideWait();if(AE){var AG="mailto:?body="+window.encodeURIComponent(AC.url)+"&subject="+encodeURI(AC.objectName);var AH=mstrApp.openPage||mstrmojo._IsWebApp.openPage;AH(AG,"mailtoIframe");}}};this.showWait();mstrmojo.xhr.request("POST",mstrConfig.taskURL,AF,{taskId:"savePersonalView",messageID:this.mid,objectType:this.oi.t,subName:AD,objectSubType:0,viewMode:this.viewMode||0,isPVPublic:true});}function e(AE){var AC=this.getAvailableRightsForSelection(),AB=AC.length,AD;for(AD=0;AD<AB;AD++){if(AC[AD].rgt===AE){return AC[AD].n;}}return mstrmojo.desc(2056,"Custom");}function Q(AB){return(((AB.acg&32)>0)&&((AB.acg&8)>0));}mstrmojo.SharingEditor=mstrmojo.declare(mstrmojo.Editor,null,{scriptClass:"mstrmojo.SharingEditor",cssClass:"mstrmojo-SharingEditor",showSharingOptions:true,showButtonBar:true,showPublisAccess:true,hasChanged:false,help:"sharing_dialog_box.htm",zIndex:199,defaultRight:223,showButtonText:true,uneditableRights:{},currentPublicRight:199,userSelectorTitle:mstrmojo.desc(8091,"User/User Group Browser"),showLinkOnOpen:true,closeEditorAfterSave:true,allowHTMLTitle:true,init:function(AB){Y=AB.id||Y;this._super(AB);},onShowLink:function(AE){var AB=["libraryLink","showLink","htmlCode"];for(var AD=0;AD<AB.length;AD++){if(AB[AD]!==AE){var AC=this.topSection.tabDock[AB[AD]];AC.set("selected",false);E.removeClass(AC.domNode,"selected");}}},showWait:mstrmojo.emptyFn,hideWait:mstrmojo.emptyFn,checkPublicAccess:function(){var AI=this.oi.acls,AD,AL=q.find(AI,"did",I),AG=this.aclList.itemsContainerNode,AH=this.publicAccessSection.publicLabel,AF,AK=false,AB=q.find(AI,"did",X),AJ;if(AL!==-1&&h&&AB!==-1){var AC=AI[AL].rgt,AE=AI[AB].rgt;if(AC===AE){AK=true;AJ=AE;}}if(AL!==-1&&!h){AK=true;AJ=AI[AL].rgt;}AF=AG.children[0].tBodies;if(h&&AF[AB]){E.toggleClass(AF[AB].rows[0],"hide",AK);}if(AF[AL]){E.toggleClass(AF[AL].rows[0],"hide",AK);}AH.set("checked",AK);if(AJ){this.set("currentPublicRight",AJ);}},oncurrentPublicRightChange:function(){var AB=this.publicAccessSection.publicMouseOver;AB.publicRight.set("value",this.currentPublicRight);AB.publicRightLabel.set("text",e.call(this,this.currentPublicRight));},onOpen:function(){var AM=this.oi,AD=AM.n,AK=AM.t,AN=AM.acls,AF=this.topSection,AI=AF.tabDock,AE=false;var AG=H(AM.did,AK,this.href);if(this.objectId&&this.objectId===AG&&!this.isLinkDirty){AE=true;}this.objectId=AG;this.objectName=AD;this.set("showACL",!!AN);h=this.guestModeEnabled;if(AA(AM)&&this.showSharingOptions){if(!AE){if(this.href&&!this.isLinkDirty){var AC=!this.urlReady?n(this.href):this.href,AJ=AF.authorEmail.emailLink;this.url=AC;AJ.set("url",window.encodeURIComponent(AC));AJ.set("name",AD);AF.htmlPanel.htmlLinkRow.htmlBox.set("value",S(AC));AF.authorLinkRow.authorLinkBox.set("value",AC);}else{J.call(this);this.set("isLinkDirty",false);}if(D(AK,this.href)){var AC=r.constructLibraryUrl(AG);var AL=AF.libraryLaunchButtons.libraryEmailLink;this.libraryUrl=AC;AF.libraryLinkRow.libraryLinkBox.set("value",this.libraryUrl);AL.set("url",window.encodeURIComponent(AC));AL.set("name",AD);}}if(this.initTab=="shareByLinkMSTRLibrary"){this.onShowLink("libraryLink");AI.libraryLink.set("selected",true);E.addClass(AI.libraryLink.domNode,"selected");}else{if(this.initTab=="shareByLinkEmbed"){this.onShowLink("htmlCode");AI.htmlCode.set("selected",true);E.addClass(AI.htmlCode.domNode,"selected");}else{this.onShowLink("showLink");AI.showLink.set("selected",true);E.addClass(AI.showLink.domNode,"selected");}}}this.set("title",mstrmojo.desc(8093,"share").replace("##",mstrmojo.string.encodeHtmlString(AD)));if(AN){this.checkPublicAccess();var AO=this.objectInputer,AH=this.userSelector,AB=AH&&AH.userBrowser;AO.zIndex=this.zIndex;if(AB&&AB.hasRendered){AH.opener=this;AB.set("items",[]);AB.getContent(AB);}this.set("hasChanged",false);}this.aclList.updateScrollbars();this.positionDialog();},_set_hasChanged:function(AD,AB){var AC=(AB!==this.hasChanged);this.hasChanged=AB;if(AB===true){this.checkPublicAccess();return AB;}return AC;},_set_oi:function(AC,AB){this.oi=this.preProcessACLs(AB);return true;},postCreate:function(){this.oi=this.preProcessACLs(this.oi);},getAvailableRightsForSelection:function(){return C(this.oi.st);},preProcessACLs:function(AI){if(AI&&AI.acls){var AG=AI.acls,AF=AG&&AG.length,AH=V(AI),AC={},AJ,AB,AD,AE;if(AH){AD={};AI.inhs=AD;}for(AE=0;AE<AF;AE++){AJ=new mstrmojo.Obj(AG[AE]);if(AJ.den){AJ.rgt=AJ.rgt*1000;}if(AH&&AJ.inh){AD[AJ.n]=mstrmojo.hash.copy(AJ);continue;}AB=AC[AJ.n];if(!AB){AB=mstrmojo.hash.copy(AJ);AB.rgt=0;delete AB.den;AC[AJ.n]=AB;}AB.rgt=AB.rgt+AJ.rgt;if(AB.rgt>255000){AB.rgt=Math.floor(AB.rgt/1000)*1000;}}AG=mstrmojo.hash.valarray(AC);AI.acls=AG;}return AI;},getACLItems:function(){var AE=this.aclList&&this.aclList.items,AC=[];for(var AD=0,AB=AE.length;AD<AB;AD++){AC.push(AE[AD]);}return AC;},onClose:function(){var AB=this.objectInputer;AB.set("items",[]);this.aclList.clearSelect();this.onShowLink("showLink");},getACLUserDataService:function m(){return mstrmojo.ACL.UserDataService;},userSelector:{scriptClass:"mstrmojo.Editor",cssClass:"mstrmojo-UserEditor",help:"user_group_browser.htm",onClose:function(){this.userBrowser.clearTreeSelect();},children:[{scriptClass:"mstrmojo.ACL.UserTreeBrowser",alias:"userBrowser",getACLUserDataService:function m(){return this.parent.opener.getACLUserDataService();},updateTreeContent:function(AC,AE){AC.contentRetrieved=true;var AD=AE[AC.itemChildrenField],AB=AC.tree||AC,AG=AE.bc,AF=AE.sz,AH=AE.bb;if(AG!==-1){if(AH+AG<=AF){AD.push(AB.nextItemCreaterFunc());}if((AH-AG)>-1){AD.unshift(AB.prevItemCreaterFunc());}}AC.blockBegin=AH;AB.initializing=true;AC.clearSelect(false);AC.set("items",AD);AC.setSelectedItems(AB.getTotalSelections(),true);AB.initializing=false;},selectionAcrossBranch:true,multiSelect:true},{scriptClass:"mstrmojo.HBox",cssClass:"mstrmojo-Editor-buttonBox",slot:"buttonNode",children:[{scriptClass:"mstrmojo.HTMLButton",cssClass:"mstrmojo-Editor-button",iconClass:"mstrmojo-Editor-button-OK",text:mstrmojo.desc(1442,"OK"),onclick:function(AC){var AB=this.parent.parent,AG=AB.opener,AF=AG.objectInputer,AE=AB.userBrowser,AD=AE.getTotalSelections();if(AD&&AD.length>0){AF.add(AD,AF.items.length-1);}AB.close();},preBuildRendering:function(){if(!this.parent.parent.opener.showButtonText){this.set("text","");}}},{scriptClass:"mstrmojo.HTMLButton",cssClass:"mstrmojo-Editor-button",iconClass:"mstrmojo-Editor-button-Cancel",text:mstrmojo.desc(221,"Cancel"),onclick:function(AB){this.parent.parent.close();},preBuildRendering:function(){if(!this.parent.parent.opener.showButtonText){this.set("text","");}}}]}],onOpen:function(){this.set("title",this.opener.userSelectorTitle);}},customACL:{scriptClass:"mstrmojo.Editor",title:mstrmojo.desc(8092,"Custom Permission Level"),cssClass:"mstrmojo-CustomACLEditor",help:"Custom_Permission_Level_dialog_box.htm",onOpen:function(){var AH=this.rgt,AI=Math.floor(AH/1000),AG=AH%1000,AD=this.children,AE,AF,AC,AB;for(AC=0,AB=7;AC<AB;AC++){AE=AD[AC];AF=AE.right;if((AG&AF)>0){AE.children[1].value=0;}else{if((AI&AF)>0){AE.children[1].value=1;}else{AE.children[1].value=2;}}}this.refresh();},getACLValue:function(){var AF=0,AG=0,AD=this.children,AE,AC,AB;for(AC=0,AB=7;AC<AB;AC++){AE=AD[AC];if(AE.children[1].value==0){AF+=AE.right;}else{if(AE.children[1].value==1){AG+=AE.right;}}}return AG*1000+AF;},children:[g("browse",1,mstrmojo.desc(1825,"Browse")),g("read",4,mstrmojo.desc(8078,"Read")),g("write",8,mstrmojo.desc(8079,"Write")),g("delete",16,mstrmojo.desc(629,"Delete")),g("control",32,mstrmojo.desc(8080,"Control")),g("use",64,mstrmojo.desc(8081,"Use")),g("execute",128,mstrmojo.desc(8082,"Execute")),{scriptClass:"mstrmojo.HBox",cssClass:"mstrmojo-Editor-buttonBox",slot:"buttonNode",children:[{scriptClass:"mstrmojo.HTMLButton",cssClass:"mstrmojo-Editor-button",iconClass:"mstrmojo-Editor-button-OK",text:mstrmojo.desc(1442,"OK"),onclick:function(AB){var AC=this.parent.parent;if(AC.onOK){AC.onOK();}AC.close();}},{scriptClass:"mstrmojo.HTMLButton",cssClass:"mstrmojo-Editor-button",iconClass:"mstrmojo-Editor-button-Cancel",text:mstrmojo.desc(221,"Cancel"),onclick:function(AB){var AC=this.parent.parent;if(AC.onCancel){AC.onCancel();}AC.close();}}]}]},children:[{scriptClass:"mstrmojo.Box",alias:"topSection",cssClass:"sharingEditor-topSection",bindings:{visible:function(){return AA(this.parent.oi)&&this.parent.showSharingOptions;}},children:[{scriptClass:"mstrmojo.HBox",alias:"tabDock",cssClass:"sharingEditor-tabDock",bindings:{visible:function(){return AA(this.parent.parent.oi)&&this.parent.parent.showSharingOptions;}},children:[{scriptClass:"mstrmojo.Label",alias:"showLink",text:mstrmojo.desc(9773,"Link"),cssClass:"SharingEditor-ShowLink",selected:false,onclick:function(AB){var AC=this.parent.parent.parent;if(!this.selected){AC.onShowLink(this.alias);this.set("selected",true);E.addClass(this.domNode,"selected");}},},{scriptClass:"mstrmojo.Label",alias:"libraryLink",text:mstrmojo.desc(15572,"Library link"),cssClass:"SharingEditor-libraryLink",selected:false,onclick:function(AB){var AC=this.parent.parent.parent;if(!this.selected){AC.onShowLink(this.alias);this.set("selected",true);E.addClass(this.domNode,"selected");}},bindings:{visible:function(){return D(this.parent.parent.parent.oi.t,this.parent.parent.parent.href);}}},{scriptClass:"mstrmojo.Label",cssClass:"SharingEditor-ShowHtml",alias:"htmlCode",text:mstrmojo.desc(9774,"Show HTML"),selected:false,onclick:function(AB){var AC=this.parent.parent.parent;if(!this.selected){AC.onShowLink(this.alias);this.set("selected",true);E.addClass(this.domNode,"selected");}}}]},{scriptClass:"mstrmojo.Box",alias:"htmlPanel",cssClass:"mstrmojo-SharingEditor-html-panel",children:[{scriptClass:"mstrmojo.HBox",alias:"htmlLinkRow",cssClass:"SharingEditor-LinkRow",children:[{scriptClass:"mstrmojo.TextBox",alias:"htmlBox",cssClass:"SharingEditor-Html"},{scriptClass:"mstrmojo.Button",alias:"copyHtmlLink",cssClass:"SharingEditor-CopyHtmlLink",onclick:function(AB){var AC=this.parent.htmlBox.inputNode;M(AC);},bindings:{visible:"this.parent.parent.parent.tabDock.htmlCode.selected"}}]},{scriptClass:"mstrmojo.Label",alias:"IframeSize",text:mstrmojo.desc(9735,"Size:"),cssClass:"SharingEditor-Html-Size"},{scriptClass:"mstrmojo.TextBoxWithLabel",alias:"widthInput",label:mstrmojo.desc(272,"Width:"),value:640,onvalueChange:function(AB){var AC=this.parent,AD=mstrmojo.all[Y];AC.htmlLinkRow.htmlBox.set("value",S.call(AC,AD.url,true));}},{scriptClass:"mstrmojo.TextBoxWithLabel",label:mstrmojo.desc(271,"Height:"),alias:"heightInput",value:480,onvalueChange:function(){var AB=this.parent,AC=mstrmojo.all[Y];AB.htmlLinkRow.htmlBox.set("value",S.call(AB,AC.url,true));}},{scriptClass:"mstrmojo.HBox",alias:"toolbarOptions",cssClass:"SharingEditor-toolbarRow",children:[{scriptClass:"mstrmojo.Label",alias:"IframeShow",text:mstrmojo.desc(15341,"Show:"),cssClass:"SharingEditor-Html-Show"},{scriptClass:"mstrmojo.CheckListHoriz",alias:"checkBoxList",items:[{n:mstrmojo.desc(8145,"Navigation bar"),alias:"path"},{n:mstrmojo.desc(2509,"Toolbar"),alias:"dockTop"},{n:mstrmojo.desc(8146,"Tools panel"),alias:"dockLeft"},{n:mstrmojo.desc(8147,"Footer"),alias:"footer"}],multiSelect:true,onselectionChange:function(AB){var AC=this.parent.parent,AD=mstrmojo.all[Y];AC.htmlLinkRow.htmlBox.set("value",S.call(AC,AD.url,true));}}]}],bindings:{visible:"this.parent.tabDock.htmlCode.selected"}},{scriptClass:"mstrmojo.HBox",alias:"authorLinkRow",cssClass:"SharingEditor-LinkRow",bindings:{visible:function(){return this.parent.tabDock.showLink.selected;}},children:[{scriptClass:"mstrmojo.TextBox",alias:"authorLinkBox",cssClass:"SharingEditor-Link",},{scriptClass:"mstrmojo.Button",alias:"authorCopyLink",cssClass:"SharingEditor-CopyLink",onclick:function(AB){var AC=this.parent.authorLinkBox.inputNode;M(AC);}},]},{scriptClass:"mstrmojo.HBox",alias:"libraryLinkRow",cssClass:"SharingEditor-LinkRow",bindings:{visible:function(){return this.parent.tabDock.libraryLink.selected;}},children:[{scriptClass:"mstrmojo.TextBox",alias:"libraryLinkBox",cssClass:"SharingEditor-Link",},{scriptClass:"mstrmojo.Button",alias:"libraryCopyLink",cssClass:"SharingEditor-CopyLink",onclick:function(AB){var AC=this.parent.libraryLinkBox.inputNode;M(AC);}},]},{scriptClass:"mstrmojo.HBox",alias:"libraryLaunchButtons",cssClass:"SharingEditor-LaunchButtons",bindings:{visible:function(){return this.parent.tabDock.libraryLink.selected;}},children:[{scriptClass:"mstrmojo.Widget",markupString:'<div id = "{@id}" class ="sharingEditor-launchLink" style="{@cssText}" mstrAttach:click>'+mstrmojo.desc(15334,"Launch")+' <iframe name="launchToIframe" target="_blank" style="display:none"></iframe> </div>',alias:"launchLink",onclick:function(){var AB=this.parent.parent.parent;r.createTokenAndOpenLink(AB.libraryUrl);},bindings:{visible:function(){return this.parent.parent.tabDock.libraryLink.selected&&this.parent.parent.parent.oi.t==55;}}},{scriptClass:"mstrmojo.Widget",markupString:'<div id = "{@id}" class ="sharingEditor-emailLink" style="{@cssText}"" mstrAttach:click>'+mstrmojo.desc(15333,"Email Link")+' <iframe name="mailtoIframe" style="display:none"></iframe> </div>',alias:"libraryEmailLink",onclick:function(){var AB=this.parent.parent.parent;if(!AB.libraryUrl){r.constructLibraryUrl(AB.objectId);}else{a(AB,AB.libraryUrl);}}}]},{scriptClass:"mstrmojo.HBox",alias:"authorEmail",cssClass:"SharingEditor-LaunchButtons email",bindings:{visible:function(){return this.parent.tabDock.showLink.selected;}},children:[{scriptClass:"mstrmojo.Widget",markupString:'<div id = "{@id}" class ="sharingEditor-emailLink" style="{@cssText}"" mstrAttach:click>'+mstrmojo.desc(15333,"Email Link")+' <iframe name="mailtoIframe" style="display:none"></iframe> </div>',alias:"emailLink",onclick:function(){var AB=this.parent.parent.parent;if(!AB.url||AB.isLinkDirty){J.call(AB,true);AB.set("isLinkDirty",false);}else{a(AB,AB.url);}}}]}]},{scriptClass:"mstrmojo.Label",text:mstrmojo.desc(9775,"Who Has Access"),cssClass:"SharingEditor-title",bindings:{visible:"this.parent.showACL"}},{scriptClass:"mstrmojo.Label",alias:"userMessage",text:mstrmojo.desc(9771,"The permission you added is already granted"),cssClass:"sharingEditorUserMessage hideMsg",bindings:{visible:"this.parent.showACL"},onclick:function(){E.addClass(this.domNode,"hideMsg");x=false;}},{scriptClass:"mstrmojo.Box",cssClass:"sharingEditor-ACLUserPanel",bindings:{visible:"this.parent.showACL"},children:[{scriptClass:"mstrmojo.HBox",cssClass:"sharingEditor-CPSection",children:[{scriptClass:"mstrmojo.ACL.AddUserInputBox",emptyText:mstrmojo.desc(15335,"Type to add users or groups here..."),getACLUserDataService:function m(){return this.parent.parent.parent.getACLUserDataService();},noCache:true,postCreate:function(){var AB=this.parent.parent.parent;if(AB){this.zIndex=AB.zIndex+1;}},onRender:function(){var AB=this.parent.parent.parent;if(AB){AB.objectInputer=this;}},bindings:{enabled:function(){return Q(this.parent.parent.parent.oi);}}},t(mstrmojo.desc(1825,"Browse"),function(AB){var AC=this.parent.parent.parent;AC.openPopup("userSelector",{zIndex:AC.zIndex+10});},{bindings:{enabled:function(){return Q(this.parent.parent.parent.oi);}}})]}]},{scriptClass:"mstrmojo.HBox",alias:"publicAccessSection",cssClass:"sharingEditor-publicAccessSection",bindings:{visible:"this.parent.showACL && this.parent.showPublisAccess"},children:[{scriptClass:"mstrmojo.CheckBox",alias:"publicLabel",cssClass:"SharingEditor-Public",bindings:{label:function(){if(this.parent.parent.guestModeEnabled){return mstrmojo.desc(9776,"Public (Login not required)");}return mstrmojo.desc(9777,"Everyone (Login not required)");},enabled:function(){return Q(this.parent.parent.oi);}},oncheckedChange:function(){E.toggleClass(this.domNode.children[1],"label-disabled",!this.checked);},getUserGroupsInfo:function(){if(h){this.getUserGroupFromTaskCall(X);}this.getUserGroupFromTaskCall(I);},getUserGroupFromTaskCall:function(AH){var AD=mstrmojo.all[Y],AE=AD.aclList,AF=AD.getACLUserDataService(),AG=function(AJ){var AI=new mstrmojo.Obj({n:AJ.n,did:AJ.did,st:AJ.st,rgt:u,newItem:true});j.push(AI);},AC=function(AI){},AB=function(){if(!h||(h&&j.length==2)){AE.add(j);AD.set("hasChanged",true);}};AF.getMembers({blockBegin:0,blockCount:1,outputElements:1,data:{did:AH}},{success:AG,failure:AC,complete:AB});},onclick:function(){var AC=mstrmojo.all[Y];var AD=AC.aclList.items;var AE=q.find(AD,"did",I);if(AE!==-1){AD.remove(AE);}var AB=q.find(AD,"did",X);if(h&&AB!==-1){AD.remove(AB);}if(this.checked===true){if(j.length<1){this.getUserGroupsInfo();}else{mstrmojo.array.forEach(j,function(AF){AF.rgt=u;});AD.add(j);AC.set("hasChanged",true);}}else{AC.set("currentPublicRight",u);AC.set("hasChanged",true);}}},{scriptClass:"mstrmojo.MouseOverContainer",alias:"publicMouseOver",setupSelectedItem:function A(){this.mouseoverItem=this.publicRight;this.mouseoutItem=this.publicRightLabel;},bindings:{visible:"this.parent.publicLabel.checked",enabled:function(){return Q(this.parent.parent.oi);}},children:[{scriptClass:"mstrmojo.Label",markupMethods:{oncssClassChange:function(){this.domNode.className="mstrmojo-Label "+this.cssClass;}},bindings:{cssClass:function(){return L(this.parent.parent.parent.currentPublicRight);}}},{scriptClass:"mstrmojo.Label",alias:"publicRightLabel",cssClass:"sharingEditor-rightLabel",bindings:{text:function(){var AB=this.parent.parent.parent;return e.call(AB,AB.currentPublicRight);},enabled:function(){return Q(this.parent.parent.parent.oi);}}},{scriptClass:"mstrmojo.Pulldown",cssClass:"sharingEditor-pulldown",itemIdField:"rgt",alias:"publicRight",visible:false,postCreate:function(){this.items=this.parent.parent.parent.getAvailableRightsForSelection();},bindings:{value:"this.parent.parent.parent.currentPublicRight",enabled:function(){return Q(this.parent.parent.parent.oi);}},selectionPolicy:"reselect",onvalueChange:function(){var AB=this.parent;var AC=AB.parent.parent;AB.publicRightLabel.set("text",e.call(AC,this.value));},_set_value:function(AG,AC){var AD=this.value,AB=(AD!==AC);if(AB){if(AC===-1){var AF=this.parent.parent.parent,AE=this;AF.openPopup("customACL",{zIndex:AF.zIndex+10,rgt:AD,twoStates:true,onOK:function(){AE.set("value",this.getACLValue());},onCancel:function(){AE.set("value",AD);}});return false;}AC=K(AC);R(this,AC);this.updatePublicRight(AC);return true;}return true;},updatePublicRight:function(AC){var AD=this.parent.parent.parent;if(AD.aclList){var AE=AD.aclList.items;var AB=q.find(AE,"did",X);var AF=q.find(AE,"did",I);if(h&&AB!==-1){AE[AB].rgt=AC;}if(AF!==-1){AE[AF].rgt=AC;}AD.set("hasChanged",true);AD.set("currentPublicRight",AC);}}}]}]},{scriptClass:"mstrmojo.DataGrid",alias:"aclList",cssClass:"aclList",renderOnScroll:false,makeObservable:true,itemDisplayField:"n",itemIdField:"did",dropZone:true,bindings:{items:function(){return this.parent.oi.acls||[];},visible:"this.parent.showACL"},onremove:function(AC){var AG=this.parent.oi;var AF=this;window.setTimeout(function(){AF.updateScrollbars();},10);if(!V(AG)){return ;}var AH=AG.inhs,AE=AC.value,AB=AE&&AE.length,AI,AD;for(AD=0;AD<AB;AD++){AI=AE[AD].n;delete AH[AI];}},onadd:function(AC){var AG=this.parent.oi;var AF=this;window.setTimeout(function(){AF.updateScrollbars();},10);if(!V(AG)){return ;}var AH=AG.inhs,AE=AC.value,AB=AE&&AE.length,AI,AD;for(AD=0;AD<AB;AD++){AI=AE[AD].n;AH[AI]=mstrmojo.hash.copy(AE[AD]);AH[AI].inh=true;}},onACLChanged:function(AC){var AB=this.parent.oi;this.parent.set("hasChanged",true);if(!V(AB)){return ;}if(this.parent.childrenAccessPulldown.value==1){AB.inhs[AC.n]=mstrmojo.hash.copy(AC);AB.inhs[AC.n].inh=true;}},columns:[{dataFunction:function(AD,AB,AC){return'<div class="mstrmojo-ACLEditor-user '+(AD.st===8705?"ug":"u")+'">'+mstrmojo.string.encodeHtmlString(AD.n)+"</div>";}},{dataWidget:{scriptClass:"mstrmojo.MouseOverContainer",alias:"mouseOverContainer",bindings:{enabled:function(){return Q(this.parent.parent.parent.oi);}},setupSelectedItem:function A(){this.mouseoverItem=this.dataGridPulldown;this.mouseoutItem=this.dataGridLabel;},children:[{scriptClass:"mstrmojo.Label",markupMethods:{oncssClassChange:function(){this.domNode.className="mstrmojo-Label "+this.cssClass;}},bindings:{cssClass:function(){return L(this.parent.parent.data.rgt);}}},{scriptClass:"mstrmojo.Label",cssClass:"sharingEditor-rightLabel",alias:"dataGridLabel",bindings:{text:function(){return e.call(mstrmojo.all[Y],this.parent.parent.data.rgt);},enabled:function(){return Q(this.parent.parent.parent.parent.oi);}}},{scriptClass:"mstrmojo.HBox",alias:"dataGridPulldown",cssClass:"sharingEditor-datagridContainer",visible:false,children:[{scriptClass:"mstrmojo.Pulldown",cssClass:"sharingEditor-datagridPulldown",itemIdField:"rgt",popupToBody:true,selectionPolicy:"reselect",popupZIndex:1001,postCreate:function(){this.markupMethods=mstrmojo.hash.copy({ondataChange:function(){var AB=this.parent.parent.data;this.set("value",AB[this.itemIdField]);},onvisibleChange:function(){this.domNode.style.display=this.visible?"block":"none";if(!this.visible&&this.popupRef){this.popupRef.set("visible",false);}}},mstrmojo.hash.copy(this.markupMethods));this.items=this.parent.parent.dataGrid.parent.getAvailableRightsForSelection();},_set_value:function(AG,AC){var AD=this.value,AB=(AD!==AC);if(AB){if(AC===-1){var AF=this.parent.parent.dataGrid.parent,AE=this;AF.openPopup("customACL",{zIndex:AF.zIndex+10,rgt:AD,twoStates:!!this.parent.parent.data.newItem,onOK:function(){AE.set("value",this.getACLValue());},onCancel:function(){AE.set("value",AD);}});return false;}AC=N(AC);R(this,AC);this.parent.parent.data.set(this.itemIdField,AC);if(AD!==null){this.parent.parent.dataGrid.onACLChanged(this.parent.parent.data);}return true;}return true;},bindings:{enabled:function(){return Q(this.parent.parent.parent.parent.parent.oi);}}},{scriptClass:"mstrmojo.Button",cssClass:"mstrmojo-ACLEditor-delete",text:"&nbsp",title:mstrmojo.desc(629,"Delete"),onclick:function(AB){var AC=this,AD=function(){var AE=AC.parent.parent.dataGrid;AE.remove(AC.parent.parent.data);AE.parent.set("hasChanged",true);};mstrmojo.confirm(mstrmojo.desc(12299,"Are you sure you want to delete the user/user group #?").replace("#",this.parent.parent.data.n),{confirmBtn:{fn:AD}},{zIndex:2000});},bindings:{enabled:function(){return Q(this.parent.parent.parent.parent.parent.oi);}}}]}]}}]},{scriptClass:"mstrmojo.Label",text:mstrmojo.desc(9892,"Children Access"),cssClass:"SharingEditor-title",bindings:{visible:function(){return this.parent.showACL&&V(this.parent.oi);}}},{scriptClass:"mstrmojo.Pulldown",alias:"childrenAccessPulldown",value:0,items:[{n:mstrmojo.desc(9890,"Preserve children's access control lists"),idx:0},{n:mstrmojo.desc(9891,"Overwrite children's access control lists"),idx:1}],itemIdField:"idx",bindings:{visible:function(){return this.parent.showACL&&V(this.parent.oi);}}},{scriptClass:"mstrmojo.HBox",cssClass:"Editor-buttonBox",slot:"buttonNode",bindings:{visible:"this.parent.showButtonBar"},children:[l(mstrmojo.desc(8473,"Done"),function(AB){var AC=this.parent.parent;if(p(AC)){o(AC,AC.closeEditorAfterSave);}},true,{iconClass:"mstrmojo-Editor-button-OK",bindings:{visible:"this.parent.parent.showACL",enabled:function(){return Q(this.parent.parent.oi)&&this.parent.parent.hasChanged;},text:function(){return mstrmojo.desc(8473,"Done");}},preBuildRendering:function(){if(!this.parent.parent.showButtonText){this.set("text","");}}}),l("",function(AB){var AC=this.parent.parent;AC.close();AC.set("hasChanged",false);},false,{iconClass:"mstrmojo-Editor-button-Close",bindings:{iconClass:function(){var AB=this.parent.parent;if(AB.hasChanged){return"mstrmojo-Editor-button-Cancel";}return"mstrmojo-Editor-button-Close";},text:function(){return mstrmojo.desc(2140,"Cancel");}}})]}]});mstrmojo.ACL.AddUserInputBox=mstrmojo.declare(mstrmojo.ACL.UserInputBox,null,{scriptClass:"mstrmojo.ACL.AddUserInputBox",add:function G(AC,AB){var AD=this.parent.parent.parent;this._super(AC,AB);p(AD);},});}());(function(){mstrmojo.requiresCls("mstrmojo.DI.ui.dialogs.DISaveAsDialog","mstrmojo.Button","mstrmojo.DI.DIHelpers");mstrmojo.requiresDescs(221,1442,3415,3416,12376,12377,12925,14438,15065,15066,15066);var F=mstrmojo.desc,E=mstrmojo.DI.DIHelpers,C=mstrmojo.Button.newWebButton;var B;mstrmojo.qb.QBHelpers={showSaveAsDialog:function A(N,L){var G=0,J=-1,H=-2;var I,M={};if(E.isServerBasedWS()&&N){M.taskId="openNativeWindow";M.windowType=3;var K={success:function(O){if(O&&O.fileName){N.onOK({folderID:O.folderID,objDesc:"",objName:O.fileName,objPath:O.filePath+"\\"+O.fileName});}}};mstrApp.serverRequest(M,K);return ;}I=B&&mstrmojo.all[B];if(!I){I=new mstrmojo.DI.ui.dialogs.DISaveAsDialog();B=I.id;}I.set("name",L.name||"");I.set("desc",L.desc||"");I.set("saveParams",{});I.set("retainPrevFolder",true);I.buttonBox.ok.set("enabled",true);if(mstrApp.cubeSaveFolderId){I.set("rootFolderID",mstrApp.cubeSaveFolderId);}I.saveAs=function(O){var P=I.zIndex+2;I.buttonBox.ok.set("enabled",false);this.validateInput(O,function(Q){var R={folderID:I.folderID,objDesc:I.desc||"",objName:I.name||"",saveAsOverwrite:I.saveAsOverwrite,objPath:I.getObjectPath()};switch(Q){case G:I.close();N.onOK(R);break;case J:mstrmojo.alert(F(12376,"Please enter a valid cube name"),null,"",P);I.buttonBox.ok.set("enabled",true);break;case H:I.buttonBox.ok.set("enabled",true);mstrmojo.confirm(mstrmojo.desc(12925,"The name ## already exists. Do you want to replace the existing one?").replace("##",this.name),{confirmBtn:{fn:function(){I.close();N.onOK(R);}}},{title:F(12377,"Saving cube with the same name"),zIndex:P});break;}});};I.open();return I;},saveWithUserOption:function(I,H,J){var G="<strong>"+F(15066,"Do you want to replace the existing cube")+"?</strong><br/>",K={rename:function(){mstrmojo.confirm(G+F(15067,"A cube named ## already exists in this location. Do you want to replace it with the one you are editing ?").replace("##",H.fileName),{},{title:F(14438,"Replace"),allowHTML:true,cssClass:"CubeNameConflictDialog",buttons:[C(F(15065,"Keep Both"),function(){I(true);},false),C(F(14438,"Replace"),function(){I(false);},false)]});},saveDirectly:function(){I(false);}};if(!H){return false;}J.searchObjectName(K,{folderID:H.folderID,searchPattern:H.fileName});},clone:function D(K){if(!K){return null;}var M;if(K.constructor===Array){M=K.concat();var L=M[0];if(L&&typeof L==="object"){var G=M.length,J;for(J=0;J<G;J++){M[J]=this.clone(K[J]);}}}else{M={};var I,H;for(I in K){if(I==="parent"){continue;}H=K[I];if(H&&typeof H==="object"){M[I]=this.clone(H);}else{M[I]=H;}}}return M;}};}());(function(){mstrmojo.requiresCls("mstrmojo.hash","mstrmojo.array","mstrmojo.css","mstrmojo.string","mstrmojo.fe.RelationNode","mstrmojo.fe.RelationFilterExprTree","mstrmojo.mstr.EnumDSSXMLObjectTypes","mstrmojo.mstr.EnumNodeDimty","mstrmojo.Box","mstrmojo.ui.Pulldown","mstrmojo.Label","mstrmojo.vi.ui.toolbars.TitleToolbar","mstrmojo.vi.ui.toolbars._HasToolbar");mstrmojo.requiresDescs(2790,5895,5896,7931,12036,12037,15121,15122);var F=mstrmojo.hash,A=mstrmojo.array,G=mstrmojo.mstr.EnumDSSXMLObjectTypes,H=mstrmojo.mstr.EnumNodeDimty,C=mstrmojo.css,E=mstrmojo.string,D=function(P){var Q=P.data,O=Q.dmy&&Q.dmy.uts||[],L=O.length,K=[],N,M;for(N=0;N<L;N++){K.push(E.encodeHtmlString(O[N].n));}M=K.join(", ");return'<span class="mstrmojo-text" title="'+M+'">'+M+"</span>";};var I=function(){var M=mstrmojo.desc(2790,"Set of ##"),L=M.split("##")[0];var K=L.length;if(K>0&&L[K-1]===" "){L+="&nbsp;";}return L;};mstrmojo.vi.ui.editors.fe.RelationNode=mstrmojo.declare(mstrmojo.fe.RelationNode,[mstrmojo.vi.ui.toolbars._HasToolbar],{scriptClass:"mstrmojo.vi.ui.editors.fe.RelationNode",markupString:'<div id="{@id}" class="mstrmojo-relation {@cssClass}"  style="position:relative;{@cssText}" mstrAttach:mousedown><div class="mstrmojo-onhoverparent mstrmojo-relation-prefix {@cssClass}"><span class="mstrmojo-textset mstrmojo-relation-prefix-text" mstrAttach:click></span><span class="mstrmojo-onhover-in mstrmojo-andor-tools {@cssClass}"><span class="mstrmojo-indent" onclick="mstrmojo.all[\'{@id}\'].ind()">'+mstrmojo.desc(5895,"Group conditions")+'</span><span class="mstrmojo-outdent" onclick="mstrmojo.all[\'{@id}\'].out()">'+mstrmojo.desc(5896,"Ungroup Conditions")+'</span></span></div><div class="mstrmojo-relationNode"><div class="mstrmojo-relationNode-inf"><div class="mstrmojo-relation-prefix-text">'+I()+'</div><div class="mstrmojo-textset"  mstrAttach:click></div><div class="mstrmojo-relation-prefix-text">'+(mstrmojo.desc(2790,"Set of ##").split("##")[1]||"")+'</div><div class="mstrmojo-relation-postfix-text">'+mstrmojo.desc(15121,"filtered by")+'</div><div class="mstrmojo-relation-related-by-box"></div><div class="mstrmojo-relation-toolbar"></div><img class="mstrmojo-del" src="../images/1ptrans.gif" title="'+mstrmojo.desc(7931,"Delete condition")+'"onclick="mstrmojo.all[\'{@id}\'].del()" /></div><div class="mstrmojo-relation-childTreeNode" style="position:relative;"></div></div></div>',markupSlots:{prefixHoverNode:function(){return this.domNode.firstChild;},prefixNode:function(){return this.domNode.firstChild.firstChild;},relationNode:function(){return this.domNode.lastChild;},textNode:function(){return this.domNode.childNodes[1].firstChild.childNodes[1];},relatedByBoxNode:function(){return this.domNode.childNodes[1].firstChild.childNodes[4];},toolbarNode:function(){return this.domNode.childNodes[1].firstChild.childNodes[5];},containerNode:function(){return this.domNode.childNodes[1].childNodes[1];}},markupMethods:{onprefixedAndOrEditableChange:function(){C.toggleClass(this.prefixNode,["editable"],this.prefixedAndOrEditable);},onselectedChange:function(){C.toggleClass(this.relationNode,["selected"],this.selected);},ondataChange:function(){this.prefixNode.innerHTML=this.andOrTxt();this.textNode.innerHTML=D(this);}},children:[{scriptClass:"mstrmojo.fe.RelationFilterExprTree",alias:"childTree",ignoreLayout:true,dropZone:false,draggable:false,nodeClassMap:{14:mstrmojo.fe.AndOrNode,ph:mstrmojo.fe.DynamicNode,"*":mstrmojo.fe.ConditionNode},onNew:function(K){this.parent.tree.onNew(K);},getItemConfig:function(N,K,O){var L=mstrmojo.fe.RelationFilterExprTree.prototype.getItemConfig.call(this,N,K,O),M=O.tree||O;return F.copy({tree:M,rootTree:this.parent.tree,noRelation:true,inRelation:true,onremove:function(){if(this.rootTree&&this.rootTree.onremove){this.rootTree.onremove();}},onadd:function(){if(this.rootTree&&this.rootTree.onadd){this.rootTree.onadd();}}},L);},prenodeclick:function(K){if(!K||!K.part){return ;}var L=this.rootTree;if(L&&L.onnodeclick&&this.editable){K.editor=L.editor;L.onnodeclick.call(this,K);}}},{scriptClass:"mstrmojo.Box",alias:"relBox",slot:"relatedByBoxNode",cssClass:"RelatedBy-Box",cssDisplay:"inline-block",children:[{scriptClass:"mstrmojo.Label",text:mstrmojo.desc(12036,"Related by"),cssClass:"Label",cssDisplay:"inline-block"},{scriptClass:"mstrmojo.ui.Pulldown",alias:"relPd",cssClass:"Pulldown",cssDisplay:"inline-block",isHostedWithin:false,allowHTML:false,onitemSelected:function B(O){var N=this.parent.parent,L=N.data,K=null;if(this.selectedIndex>0){K={n:O.n,did:O.did,t:O.t||G.Metric,st:O.st||1024};}L.dmt=H.NodeDimtyOutputLevel;L.dmy=L.dmy||{};var M=L.relation=L.relation||{};if(K){M.guide=K;L.useSchema=false;}else{delete M.guide;delete M.rsTp;delete M.joTp;delete M.paTp;delete M.erTp;L.useSchema=true;}N.set("data",L);}}]},{scriptClass:"mstrmojo.vi.ui.toolbars.TitleToolbar",slot:"toolbarNode",alias:"toolbar",visible:true,hasContextMenuButton:true,cssClass:"relation-toolbar",cssDisplay:"inline-block"}],_set_data:function(N,S){var O=this._super(N,S);var L=this.data,P=!L.m,K=this.relBox.relPd,Q=A.filter(this.tree.editor.targetMetrics,function(V){return !V.um;}),U=[{n:mstrmojo.desc(12037,"System Default"),t:-1,did:"default"}].concat(Q);this.relBox.set("visible",P);if(P){var R=0;if(L.relation&&L.relation.guide){var M=L.relation.guide;R=A.find(U,"did",M.did);}if(R!==K.selectedIndex){K.set("items",U);K.set("selectedIndex",R>=0?R:0);}}return O;},updateToolbar:function J(K){var L=this;if(this._super){K=this._super(K);}K.addMenuItem(mstrmojo.desc(15122,"Convert to Condition"),"convert",function(){L.parent.removeSet(L);});K.isHostedWithin=false;return K;}});}());(function(){mstrmojo.requiresCls("mstrmojo.hash","mstrmojo.HTMLButton","mstrmojo.CheckBox","mstrmojo.Editor","mstrmojo.HBox","mstrmojo.Label","mstrmojo.RadioButton","mstrmojo.warehouse.dbroles.DBRoleDSNConnection","mstrmojo.warehouse.dbroles.DBRoleSetting","mstrmojo.warehouse.obj.DBRole","mstrmojo.DI.DIHelpers");mstrmojo.requiresDescs(10070,12933,12949,11139,8513,1162,11134,10071,5891,2102);var O=mstrmojo.array,H=mstrmojo.string,L=mstrmojo.hash,R=mstrmojo.css,A=mstrmojo.warehouse.EnumObjectTypes,I="PWDHIDDEN123!@#",K=mstrmojo.DI.DIHelpers,P="Kerberos Authentication",S=mstrmojo.DI.DIConstants,C=[S.dbType.TERADATA];function M(V,W){var U=V&&V.container&&V.container.dsnSelector&&V.container.dsnSelector.WHDSNLIST&&V.container.dsnSelector.WHDSNLIST.selectedIndex===1;return K.getEnvObj().isWSDossierLocalMode()&&U&&C.indexOf(W)>-1;}function J(){var X=this,U=this.dbrole.mdDBRole,Y=H.trim(X.container.txtname.text),W=X.container.dsninfo,Z=W.contents,a,b;b=Z&&Z.RB0&&Z.RB0.label===P&&Z.RB0.checked;if(Y!==U.n){if(!mstrApp.getRootController().validateName(A.DBROLE,Y,U.n)){return false;}}if(W.getDBId()!==43&&!b&&!M(X,W.getDBType())){if(X.container.txtlogin.visible){a=X.container.txtlogin.isValid();if(!a.val){mstrmojo.alert(a.msg);return false;}}if(X.container.txtpwd.visible){a=X.container.txtpwd.isValid();if(!a.val){mstrmojo.alert(a.msg);return false;}}}if(X.container.dsnSelector.WHDSNLIST.selectedIndex===1){var V=X.container.dsninfo.dsnBox.dsnList.selectedItem;if(!V||V.des==="0"||V.des===0){mstrmojo.alert(mstrmojo.desc(10070,"Please select a DSN first"));return false;}}else{a=X.container.dsninfo.isValidInput();if(!a.val){mstrmojo.alert(a.msg);return false;}}return true;}function E(){var X=this,e=this.container.dsninfo,Y=this.dbrole.mdDBRole,V=this.config,U=Y.connstr,W=this.container,a=false,b=function b(){e.clear();if(!U){var g=window.localStorage,c=parseInt((g&&g.getItem("dbRoleDSNOption"))||0,10);if(c===0||a){W.dsnSelector.WHDSNLIST.set("selectedIndex",0);}else{W.dsnSelector.WHDSNLIST.set("selectedIndex",1);}}else{var f=(U.split("=")[0]).toUpperCase();if(f==="DSN"){W.dsnSelector.WHDSNLIST.set("selectedIndex",1);}else{W.dsnSelector.WHDSNLIST.set("selectedIndex",0);}}e.set("info",Y);if(!Y.shared){Y.shared="0";}if(mstrApp.isSingleTier){W.sharedConnection.domNode.style.display="none";}else{W.sharedConnection.checked=(Y.shared==="1");W.sharedConnection.refresh();}Y.des=(mstrApp.rootController.isCloud()?Y.n:"");Y.ln=Y.ln||"";W.txtlogin.set("text",Y.ln);if(Y.did===""){Y.password=Y.password||"";}else{Y.password=Y.password||I;}W.txtpwd.set("text",Y.password);W.txtname.set("text",Y.n||Y.des);};if(V||mstrApp.isSingleTier){X.set("visible",false);mstrApp.rootController.getDBObjects().reloadDSNs({success:function d(){b.call(X);X.set("visible",true);}});if(V.hideDSNOption||(mstrApp.isSingleTier&&navigator.userAgent.indexOf("Macintosh")>-1)){W.dsnSelector.domNode.style.display="none";a=true;}if(V.hideDriverCheck){W.dsninfo.set("hideDriverCheck",V.hideDriverCheck);}if(V.requiresLogin!==undefined){W.txtlogin.isRequired=V.requiresLogin;W.txtpwd.isRequired=V.requiresLogin;}if(V.dbIdFilter){W.dsninfo.dbIdFilter=V.dbIdFilter.sort(O.numSorter);}if(V.dbIdExcludeFilter){W.dsninfo.dbIdExcludeFilter=V.dbIdExcludeFilter.sort(O.numSorter);}if(V.dsnDbTypeExcludeFilter){W.dsninfo.dsnDbTypeExcludeFilter=V.dsnDbTypeExcludeFilter.sort(O.numSorter);}if(V.showAddDriver){W.dsninfo.set("showAddDriver",V.showAddDriver);}if(V.singleType){W.dsninfo.set("singleType",true);}if(V.cfgDbmsTypeExcludeFilter){W.dsninfo.set("cfgDbmsTypeExcludeFilter",V.cfgDbmsTypeExcludeFilter);}W.sharedConnection.set("visible",!(V.hideShareConnection===undefined||V.hideShareConnection===null?true:V.hideShareConnection));W.shareLink.set("visible",!!V.showShareLink);W.txtlogin.set("visible",false);if(V.hideLogin){W.txtlogin.set("visible",false);}if(V.hidePwd){W.txtpwd.set("visible",false);}if(V.hideShareLink){W.shareLink.set("visible",false);}}else{b.call(X);}var Z=K.isdbRoleWritable(Y);X.buttonsbox.okButton.set("enabled",Z);}function N(a){var Y=this;var b=this.container,W=b.dsninfo,U=L.clone(this.dbrole.mdDBRole);if(mstrApp.rootController.isCloud()){U.des=H.trim(b.txtname.text);U.n=U.des+"___"+new Date().getTime();}else{U.n=H.trim(b.txtname.text);}U.des=U.des.replace(",","%%%");U.n=U.n.replace(",","%%%");if(parseInt(U.dbr_type,10)!==1){U.dbr_type="2";}U.owned="1";U.writable="1";if(b.sharedConnection.isChecked()){U.shared="1";}else{U.shared="0";}if(b.txtlogin.visible){U.ln=H.trim(b.txtlogin.text);}else{U.ln="";}if((b.txtpwd.text!==I)&&(b.txtpwd.visible)){U.password=b.txtpwd.text;}else{delete U.password;}var X=W.getConnectionStr();U.connstr=X.str;U.db_type=W.getDBType();U.cefu=W.getCharEncodingForUnix(U.connstr);U.driverMode=W.getDriverMode();U.odbcv=W.getOdbcv();U.dbms=W.getDbmsID();U.ab=W.getDBId();if(M(Y,U.db_type)){if(U.ln===""){delete U.ln;}if(U.password===""){delete U.password;}}W.getVLDBProperties(U.vldbProperties);mstrApp.rootController.saveDBRole({mdDBRole:U},(U.did===""),{errorMsg:X.err,success:function Z(){if(Y.callback&&Y.callback.success){Y.callback.success(Y.dbrole);}if(a&&a.keepOpen){a.success();}else{Y.close();}},complete:function V(){if(this.errorMsg!==""){mstrmojo.alert(this.errorMsg);}}});}function Q(W,X){var V=(W.dbrole?W:W.parent),U=V.dbrole.mdDBRole;if(K.isdbRoleWritable(U)){if(J.call(V)){N.call(V,X);}}else{return ;}}mstrmojo.warehouse.dbroles.DBRoleEditor=mstrmojo.declare(mstrmojo.Editor,null,{scriptClass:"mstrmojo.warehouse.dbroles.DBRoleEditor",cssClass:"mstrmojo-wh-DBRoleEditor",title:mstrmojo.desc(12949,"Data Source"),zIndex:100,dbrole:undefined,useDSN:true,callback:mstrmojo.emptyFn(),isHadoopGateWay:false,onOpen:function D(){E.call(this);},onClose:function B(){if(this.callback&&this.callback.close){this.callback.close();}},container:undefined,dsnSelector:undefined,WHDSNLIST:undefined,dsninfo:undefined,txtlogin:undefined,txtpwd:undefined,sharedConnection:undefined,shareLink:undefined,hideDSNOption:undefined,hideDriverCheck:undefined,requiresLogin:undefined,scrollable:undefined,postBuildRendering:function(){if(this._super){this._super();}if(this.isHadoopGateWay){this.containerNode.style.maxHeight="416px";}},children:[{scriptClass:"mstrmojo.Box",cssClass:"mstrmojo-wh-DBRoleEditor-container",alias:"container",children:[{scriptClass:"mstrmojo.Box",cssClass:"mstrmojo-wh-DSNSelector",alias:"dsnSelector",bindings:{visible:function(){return !(K.getEnvObj().isWSMac()&&K.getEnvObj().isWSDossierLocalMode());}},children:[{scriptClass:"mstrmojo.ui.CheckList",cssClass:"mstrmojo-wh-DSNSelector-radio",multiSelect:false,orientation:"h",alias:"WHDSNLIST",items:[{did:"0",n:mstrmojo.desc(11132,"DSN less data sources")},{did:"1",n:mstrmojo.desc(11133,"DSN data sources")}],onchange:function(){if(this.selectedIndex===0){this.parent.parent.dsninfo.set("isDSNLess",true);}else{this.parent.parent.dsninfo.set("isDSNLess",false);}var U=window.localStorage;if(U){U.setItem("dbRoleDSNOption",this.selectedIndex);}}}]},{scriptClass:"mstrmojo.Label",cssClass:"mstrmojo-wh-DBRoleEditor-info",text:mstrmojo.desc(11139,"Connection Information"),visible:false},{scriptClass:"mstrmojo.warehouse.dbroles.DBRoleDSNConnection",alias:"dsninfo",onEnterFn:function G(U){Q(U.parent.parent);},updateLoginFn:function F(U){if(this.parent.parent.isHadoopGateWay){this.parent.txtlogin.set("visible",false);this.parent.txtpwd.set("visible",false);}else{this.parent.txtlogin.set("visible",U);this.parent.txtpwd.set("visible",U);}}},{scriptClass:"mstrmojo.warehouse.dbroles.DBRoleSetting",alias:"txtlogin",isRequired:true,caption:mstrmojo.desc(8513,"login:"),onEnter:function G(){Q(this.parent.parent);}},{scriptClass:"mstrmojo.warehouse.dbroles.DBRoleSetting",alias:"txtpwd",isPassword:true,hiddenPwd:I,isRequired:true,caption:mstrmojo.desc(1162,"password:"),onEnter:function G(){Q(this.parent.parent);}},{scriptClass:"mstrmojo.warehouse.dbroles.DBRoleSetting",alias:"txtname",bindings:{cssText:function(){return this.isHadoopGateWay?"display:none !important;visibility:hidden !important":"";}},caption:mstrmojo.desc(11134,"ds name:"),onEnter:function G(){Q(this.parent.parent);}},{scriptClass:"mstrmojo.CheckBox",cssClass:"mstrmojo-wh-DBRoleEditor-infoCheckbox",alias:"sharedConnection",label:mstrmojo.desc(10071,"Share this connection with everybody")},{scriptClass:"mstrmojo.Label",cssClass:"mstrmojo-wh-DBRoleEditor-shareLabel",alias:"shareLink",text:mstrmojo.desc(9099,"Share"),onclick:function(){var V=this.parent.parent,U=V.dbrole&&V.dbrole.mdDBRole;if(U){mstrApp.getRootController().shareDBRole(U);}}}]},{scriptClass:"mstrmojo.HBox",cssClass:"mstrmojo-Editor-buttonBox",slot:"buttonNode",alias:"buttonsbox",children:[{scriptClass:"mstrmojo.Button",cssClass:"mstrmojo-Editor-button rightfloat mstrmojo-WebButton hot",text:mstrmojo.desc(5891,"Save"),alias:"okButton",onclick:function(){Q(this.parent.parent);}},{scriptClass:"mstrmojo.Button",cssClass:"mstrmojo-Editor-button mstrmojo-WebButton",text:mstrmojo.desc(2102,"Close"),alias:"buttonCancel",onclick:function(){var U=this.parent.parent;if(U.onCancel){U.onCancel();}U.close();}}]}]});}());(function(){mstrmojo.requiresCls("mstrmojo.array","mstrmojo.hash","mstrmojo.string","mstrmojo.architect.EnumDragActions","mstrmojo.warehouse.EnumObjectTypes","mstrmojo.warehouse.ui.TablesTree","mstrmojo.warehouse.menu.AvailableTablesMenu");mstrmojo.requiresDescs(2901);var W=mstrmojo.array,R=mstrmojo.hash,A=mstrmojo.string,X=mstrmojo.css,M="loading",Z="item-mn",I="item-n",E=mstrmojo.dom,P=mstrmojo.warehouse.EnumDataChangeEvents,N=mstrmojo.architect.EnumDragActions,H=mstrmojo.warehouse.EnumObjectTypes,Q=mstrmojo.desc(2901,"Loading..."),O="waitBoxTipForAvailableTablesTree",V;mstrmojo.warehouse.ui.AvailableTablesTree=mstrmojo.declare(mstrmojo.warehouse.ui.TablesTree,null,{scriptClass:"mstrmojo.architect.ui.AvailableTablesTree",cssClass:"mstrmojo-wh-AvailableTablesTree",tablesTreeHooks:{addItem:function(c,d){var b=mstrApp.getRootController();if(d.n){d.n=d.n.replace(/<strong>|<\/strong>/gi,"");if(!d.decoded){d.n=A.decodeHtmlString(d.n);d.decoded=true;}}b.addTables([].concat(d));},isTable:function a(b){return b&&b.tp===H.TABLE;}},createAvatarFunc:undefined,positionAvatarFunc:undefined,useRichTooltip:true,showTooltip:function D(c,e){var d=c.target||E.eventTarget(c.hWin,c.e);if(d.className&&(d.className.indexOf("item-n")>-1)){d=d.parentNode;}if(d.className.indexOf("item tp")>-1&&(d.scrollWidth>d.clientWidth)){var b=E.position(d);this.richTooltip={posType:mstrmojo.tooltip.POS_TOPLEFT,cssClass:"vi-regular vi-tooltip-A",content:d.textContent,top:b.y+b.h+5,left:b.x};this._super(c,e);}},init:function U(m){this._super(m);var n={},g=mstrApp.getRootController(),d=n[this.id]={};d[P.DBTABLES_CHANGED]=function j(q){if(!((this.sourceInfo===q.sourceInfo)||(q.sourceInfo==="")||(q.sourceInfo===undefined))){return ;}this.cleanUp();var w=q.selectedItems||[],u=this.selectedIndices={},r=q.keyword,t=q.items;t=W.map(t,function(AB){if(AB.encoded===true){return AB;}var AC=AB.n,z=new RegExp(r,"gi"),x,AD=0,AA=[];while(!!r&&(x=z.exec(AC))){AA.push(A.encodeHtmlString(AC.slice(AD,x.index)));AA.push("<strong>"+A.encodeHtmlString(AC.slice(x.index,z.lastIndex))+"</strong>");AD=z.lastIndex;}AA.push(A.encodeHtmlString(AC.slice(AD)));AB.n=AA.join("");AB.encoded=true;return AB;});W.forEach(w,function(x){u[W.find(t,"n",x)]=true;});this.expandedIndices=q.expandedIndices||{};this.set("items",t);if(this.domNode){this.domNode.onmousedown=function(x){E.preventDefault(window,x);};}this.waitBoxTip&&this.waitBoxTip.closeWait();};d[P.DBTABLES_REQUESTED]=function k(w){var u=mstrApp.getRootController(),AA=u.dataService,t=(AA==mstrmojo.qb.mdx.DataService);if(!((this.sourceInfo===w.sourceInfo)||(w.sourceInfo===""))){return ;}this.cleanUp();var x=[],z=this.domNode.clientWidth||parseInt(this.width,10),r=this.domNode.clientHeight||parseInt(this.height,10);x.push({n:t?Q:"",tp:"0",isVisible:function q(){return true;}});this.set("items",x);X.toggleClass(this.getLeafNode(0),M,true);!t&&this.waitBoxTip.showWait({showCancel:true,message:" ",cssClass:"mstrmojo-WaitBoxTip",cancelCallback:this.cancelTables,position:{left:(E.position(this.domNode).x+z/2-20)+"px",top:(E.position(this.domNode).y+r/2-12)+"px"},width:"40px"});};d[P.DBTABLE_UPDATED]=function p(q){W.forEach(this.getItemWithPropName(this.items,"did",q.item.did),function(r){this.updateChild(r._renderIdx,q.item);},this);};d[P.TABLES_CANCELED]=function e(q){this.set("items",[]);};d.windowSizeChanged=function(){this.waitBoxTip&&this.waitBoxTip.adjustCorners.call(this);};d[P.DBTABLES_USED]=function f(q){var t=q.items||[],r=this.items;R.forEach(this.selectedIndices,function(u,w){this.toggleChildSelection(String(w),false);},this);W.forEach(t,function(u){this.toggleChildSelection(String(W.find(r,"n",u)),true);},this);};g.attachDataChangeListeners(n);this.dataHelper={fetch:function c(q,r){if(q.tp===H.TABLE){g.getColumnsForDBTable({data:q,showCancel:false},r);}else{r.success({items:[]});}}};if(!mstrmojo.all[O]){var h=this,o=h.domNode?h.domNode:undefined;mstrmojo.insert({scriptClass:"mstrmojo.warehouse.ui.WaitBoxTip",cssClass:"mstrmojo-WaitBoxTip",id:O,adjustCorners:function l(){if(o||(this&&this.domNode)){var t=o?h:this,r=t.domNode.clientWidth||parseInt(t.width,10),q=t.domNode.clientHeight||parseInt(t.height,10);var u=E.position(t.domNode);this.set("position",{left:(u.x+r/2-20)+"px",top:(u.y+q/2-12)+"px"});}},postBuildRendering:function b(){mstrmojo.warehouse.ui.WaitBoxTip.prototype.postBuildRendering.call(this);var q=this.domNode.firstChild;X.addClass(q,"noBgNBor");}});}this.waitBoxTip=mstrmojo.all[O];},createAvatar:function L(b){if(this.createAvatarFunc){return this.createAvatarFunc.call(this,b);}else{return this._super(b);}},positionAvatar:function G(c,b){if(this.positionAvatarFunc){this.positionAvatarFunc.call(this,c,b);}else{this._super(c,b);}},cancelTables:function B(){mstrApp.getRootController().cancelLoadTables();},cleanUp:function K(){this.expandedIndices={};this.selectedIndices={};this.userSelections={};},onitemsChange:function S(b){if(this._super){this._super(b);}delete this._oldItems;},getItemProps:function Y(d,e,c){var b=d.cube_caption?d.cube_caption:d.n;b=(b&&(b+""))||"";return{tag:"div",cls:"item "+(d.tp?("tp"+d.tp):""),n:b,idx:c};},getItemMarkup:function C(c,d,b){return'<div class="{@cls}" title="{@ttp}"><span class='+I+' unselectable="on">{'+(d===1?"@en":"")+"@n}</span><span class="+Z+"></span></div>";},getMenuHelper:function F(){V.menuHelper=V.menuHelper||new mstrmojo.warehouse.menu.AvailableTablesMenu();return V.menuHelper;},getDragAction:function J(c){var d=this.getNodeAttributes(c.src.node),b=d&&this.getTreeItem(d.index);if(b&&b.n){if(!!b.decoded){b.n=A.encodeHtmlString(b.n);b.decoded=false;}b.n=b.n.replace(/<strong>|<\/strong>/gi,"");}switch(b&&b.tp){case H.TABLE:return N.ADD_TABLE;}}});V=mstrmojo.warehouse.ui.AvailableTablesTree;}());(function(){mstrmojo.requiresCls("mstrmojo._IsList","mstrmojo.ListBase","mstrmojo.array","mstrmojo.string","mstrmojo.dom","mstrmojo.ui.menus._HasMenuPopup","mstrmojo.ui.menus.Menu","mstrmojo.warehouse.EnumDataChangeEvents","mstrmojo.warehouse.menu.DBConnectionsMenu");mstrmojo.requiresDescs(2901);var O=mstrmojo.array,D=mstrmojo.dom,A=mstrmojo.string,Q="item-mn",I=mstrmojo.warehouse.EnumDataChangeEvents,L=mstrmojo.desc(2901,"Loading..."),G=57,H=mstrmojo.DI.DIHelpers;function K(U){var W=U.item,S=this.items,V=O.find(S,"did",W.did);S[V]=W;this._getItemNode(V).outerHTML=this.itemRenderer.render(W,V,this);}function E(V){var W=V.item,U=this.items.concat(),S=O.find(U,"did",W.did);if(S>-1){U.splice(S,1);}this.set("items",U);}mstrmojo.warehouse.ui.DBConnectionsList=mstrmojo.declare(mstrmojo.ListBase,[mstrmojo._IsList,mstrmojo.ui.menus._HasMenuPopup],{scriptClass:"mstrmojo.architect.ui.DBConnectionsList",cssClass:"mstrmojo-wh-dbConnectionslist",selectionPolicy:"reselect",useRichTooltip:true,showTooltip:function B(U,X){var W=U.target||D.eventTarget(U.hWin,U.e),V=this.getItemFromTarget(W);if(W.className&&(W.className.indexOf("item-n")>-1)){W=W.parentNode;}if(V&&V.n&&(W.scrollWidth>W.clientWidth)){var S=D.position(W);this.richTooltip={posType:mstrmojo.tooltip.POS_TOPLEFT,cssClass:"vi-regular vi-tooltip-A",content:A.encodeHtmlString(V.n+"",true),top:S.y+S.h+5,left:S.x};this._super(U,X);}},postBuildRendering:function N(){if(D.isChrome){D.attachEvent(this.domNode,"mousedown",function(S){if(S.which===2){D.stopPropogation(window,S);D.preventDefault(window,S);}});}if(this._super){this._super();}},init:function M(X){this._super(X);var Z=this,Y={},V=Y[this.id]={};V[I.DBROLES_REQUESTED]=function S(){var a={n:L,tp:"0",isPrimary:function(){return false;}};Z.set("items",[a]);};V[I.DBROLES_LOADED]=function W(a){var c=a.offset||0;Z.set("items",a.items);if(a.isManagedDBR){var b={};b[c]=true;this.set("selectedIndices",b);}if(c>0){Z.adjustScrollPosition(c);}};V[I.DBROLES_ADD]=function U(a){Z.addItems([a.item]);};V[I.DBROLE_CHANGED]=K;V[I.DBROLES_RENAME]=K;V[I.DBROLES_DELETE]=E;mstrApp.getRootController().attachDataChangeListeners(Y);},getItemMarkup:function C(U){var S=(U.mdDBRole&&U.mdDBRole.shared==="1"?" shared":"");return'<div class="item {@cls}" idx="{@idx}" style="{@style}"><span class="item-ic'+S+'"></span><span class="item-n" >{@n}</span><span class='+Q+"></span></div>";},getItemProps:function P(W,S){var X=!!this.selectedIndices[S],V=A.encodeHtmlString(W.n),U=mstrApp.rootController.hasPrivilege(G)?"":" hide-menu";return{sel:X,cls:"tp"+W.tp+(W.isPrimary()?" primary":"")+(X?" selected":"")+U,n:V,idx:S};},onclick:function R(b){try{var X=b.target||D.eventTarget(b.hWin,b.e),c=D.findAncestorByAttr(X,"idx",true,this.domNode),a=c&&parseInt(c.value,10),S=this.items[a],U=H.getEnvObj().isDesktopClient();if(A.startsWith(X.className,Q)&&a!==null&&!isNaN(a)){var Z=mstrmojo.warehouse.ui.DBConnectionsList,V=new mstrmojo.warehouse.menu.DBConnectionsMenu({isManagedDBR:S.isManagedDBR,readable:S.mdDBRole&&S.mdDBRole.readable?S.mdDBRole.readable:"0",writable:S.mdDBRole&&S.mdDBRole.writable?S.mdDBRole.writable:"0",controllable:!U&&S.mdDBRole&&S.mdDBRole.controllable?S.mdDBRole.controllable:"0",deletable:S.mdDBRole&&S.mdDBRole.deletable?S.mdDBRole.deletable:"0"});V.data=S.data;var W=V.getMenuConfig();W.hostId=this.id;W.hostElement=X;W.isHostedWithin=false;W.hostProxyCssClass="item-mn-proxy";W.position=D.position(W.hostElement,true);this.openPopup(new mstrmojo.ui.menus.Menu({popupConfig:W}));}else{if(a!==null){this._super(b);}}}catch(Y){throw Y;}},onchange:function F(){if(this.selectedItem){mstrApp.getRootController().setSelectedDBRoleID(this.selectedItem);}},adjustScrollPosition:function J(W){var S=this.domNode.clientHeight,V=this.domNode.scrollHeight,U=this.items.length;if(U>0&&V>S){this.domNode.scrollTop=W*(V/U);}}});}());(function(){mstrmojo.requiresCls("mstrmojo.Box","mstrmojo.ui.Pulldown","mstrmojo.warehouse.ui.DBConnectionsList");mstrmojo.requiresDescs(13531,13532,13533,14034,14035);var E=57,D="reportDefLoaded",C=mstrmojo.warehouse.EnumDataChangeEvents;mstrmojo.qb.thirdParty.BISourceSelector=mstrmojo.declare(mstrmojo.Box,null,{scriptClass:"mstrmojo.qb.thirdParty.BISourceSelector",cssClass:"mstrmojo-qb-thirdParty-BISourceSelector",title:mstrmojo.desc(4381,"data sources"),newDBBtn:undefined,dbConnections:undefined,onheightChange:function B(G){if(!this.heightOffset){this.heightOffset=37;}this.dbConnections.set("height",parseInt(G.value,10)-this.heightOffset+"px");},children:[{scriptClass:"mstrmojo.Box",cssClass:"selector-panel-header cf",children:[{scriptClass:"mstrmojo.Label",cssClass:"title-label",text:mstrmojo.desc(4381,"DATA SOURCES")},{scriptClass:"mstrmojo.Button",cssClass:"add-connection-button",text:mstrmojo.desc(14035,"Add a new connection")+"...",onclick:function F(){if(mstrApp.rootController.hasPrivilege(E)){mstrApp.getRootController().editDBRole();}else{mstrmojo.alert(mstrmojo.desc(12933,"You don't have enough privileges to perform this operation"));}}}]},{scriptClass:"mstrmojo.ui.Pulldown",cssClass:"source-type-selector",visible:false,items:[{id:0,n:"All"},{id:1,n:"SAP Business Objects"},{id:2,n:"OBIEE"},{id:3,n:"Cognos"}],selectedIndex:0,onitemSelected:function(G){this.parent.dbConnections.filterBySource(G.n);}},{scriptClass:"mstrmojo.warehouse.ui.DBConnectionsList",alias:"dbConnections",postCreate:function(){var H={},G=H[this.id]={};G[C.DBROLES_LOADED]=this.onDBRolesLoaded;G[D]=this.onReportDefLoaded;mstrApp.getRootController().attachDataChangeListeners(H);},onDBRolesLoaded:function(G){this.allDBRoles=G.items;},onReportDefLoaded:function(){var G=mstrApp.getRootController().model;this.singleSelectByField(G.SelDBRoleID,"did");},onchange:function(){var H=this.selectedItem,G=mstrApp.getRootController().model;if(H){G.SelDBRoleID=H.did;G.set("SelDBRoleName",H.n);}else{if(G.SelDBRoleID){this.singleSelectByField(G.SelDBRoleID,"did");}else{G.set("SelDBRoleName","");}}G.raiseEvent({name:"BISourceChange"});},filterBySource:function A(G){}}]});}());(function(){mstrmojo.requiresCls("mstrmojo.warehouse.ui.BasePanel","mstrmojo.warehouse.ui.DBConnectionsList");mstrmojo.requiresDescs(4381,11131,12933);var B=57;mstrmojo.warehouse.DBRoleSelector=mstrmojo.declare(mstrmojo.warehouse.ui.BasePanel,null,{scriptClass:"mstrmojo.warehouse.DBRoleSelector",cssClass:"DBConnections",title:mstrmojo.desc(4381,"data sources"),newDBBtn:undefined,dbConnections:undefined,init:function C(D){this._super(D);this.addNewTitleButton({alias:"newDBBtn",cssClass:"mstrmojo-wh-addDB",title:mstrmojo.desc(11131,"New data source"),onclick:function E(){if(mstrApp.rootController.hasPrivilege(B)){mstrApp.getRootController().editDBRole();}else{mstrmojo.alert(mstrmojo.desc(12933,"You don't have enough privileges to perform this operation"));}}});},onheightChange:function A(D){if(!this.heightOffset){this.heightOffset=30;}this.dbConnections.set("height",parseInt(D.value,10)-this.heightOffset+"px");},children:[{scriptClass:"mstrmojo.warehouse.ui.DBConnectionsList",alias:"dbConnections"}]});}());(function(){mstrmojo.requiresCls("mstrmojo.Button","mstrmojo.DataGrid","mstrmojo.dom","mstrmojo.Editor","mstrmojo.RadioButton","mstrmojo.architect.ui.SQLInputBox","mstrmojo.warehouse.EnumNamespaceMode","mstrmojo.warehouse.ui.AvailableTablesTree","mstrmojo.warehouse.ui.NameSpacePullDown","mstrmojo.DI.DIHelpers");var u=mstrmojo.array,l=mstrmojo.hash,F=mstrmojo.css,Z=mstrmojo.dom,AE=mstrmojo.DI.DIHelpers,t="1",x="2",AB="0",r="2",AQ="4",q=mstrmojo.warehouse.EnumNamespaceMode.ALL,AA=mstrmojo.warehouse.EnumNamespaceMode.CURRENT,AJ=30,AC=57,m=40,AD=78,G=3,AM="...",Y="mstrmojo-ar-catSQL",AO=mstrmojo.desc(15173,"Edit Catalog Options"),AH=mstrmojo.desc(15174,"Select Catalog Mode"),k=mstrmojo.desc(15175,"Retrieval Mode"),S=mstrmojo.desc(12263,"Data source SQL"),b=mstrmojo.desc(12264,"ODBC calls"),a=mstrmojo.desc(8368,"Caching"),K=mstrmojo.desc(12265,"Table names only"),N=mstrmojo.desc(12266,"Table and column names"),AL=mstrmojo.desc(2057,"None"),w=mstrmojo.desc(12267,"Cannot guarantee caching when using non-default SQL"),H=mstrmojo.desc(221,"Cancel"),p=mstrmojo.desc(15176,"Edit SQL Statement:"),O=mstrmojo.desc(12268,"Namespaces"),I=mstrmojo.desc(3524,"All"),A=mstrmojo.desc(12269,"Current only"),M=mstrmojo.desc(12270,"Retrieve table and column names in the data source"),AG=mstrmojo.desc(15177,"Retrieve namespaces available in data source"),h=mstrmojo.desc(12271,"Retrieve tables available in the data source"),c=mstrmojo.desc(12272,"Retrieve columns available in the data source"),L=mstrmojo.desc(15178,"Preview Available Tables"),AP=mstrmojo.desc(1442,"OK"),D=mstrmojo.desc(1905,"Reset"),R=mstrmojo.desc(134,"Apply"),J=mstrmojo.desc(12273,"Use default value"),C={namespace:AG,full:M,table:h,column:c},g="##EMPTY##";var AN;var e;function W(AS){return AS.replace(/[ \n\r\t]/g,"");}function z(){var AS=new mstrmojo.Label({cssClass:Y+"-sectionTitle",text:p});this.contents.middlePanel.addChildren([AS]);}function o(AZ,AU,AW){var AV=new mstrmojo.Box({alias:"sqlBox",cssClass:Y+"-sqlBox",defaultSQL:"",useDefaultSQL:function AY(){return(W(this.defaultSQL)===W(this.currentSQL));},currentSQL:"",resize:function AT(){var Ae=this.sqlText.domNode,Ac=Z.position(Ae).h,Ab=Ae.offsetTop,Aa=Z.position(Ae).w,Ad=this.curtain;Ad.domNode.style.height=Ac+"px";Ad.domNode.style.width=Aa+"px";Ad.domNode.style.top=Ab+"px";},children:[{scriptClass:"mstrmojo.HBox",alias:"sqlHead",cssClass:"sqlSection-box",children:[{scriptClass:"mstrmojo.Label",cssClass:Y+"-sqlLabel",text:C[AW].length>AD?C[AW].substring(0,AD-G)+AM:C[AW],title:C[AW],useRichTooltip:true,updateTooltipConfig:function(){E.call(this);}},{scriptClass:"mstrmojo.CheckBox",cssClass:Y+"-check",alias:"sqlCheck",index:AW,label:J,oncheckedChange:function AX(){var Ac=this.parent.parent,Aa=Ac.parent.parent.parent,Ab,Ad;Ac.curtain.set("visible",this.checked);Aa.changeDirtyStat(true);if(this.checked){Ac.sqlText.setSQLStatement(Ac.defaultSQL);}else{if(!Aa.loadingPanel){switch(Aa.options.cacheMode.value){case AB:Ad=N;break;case r:if(this.index==="column"){break;}Ad=K;break;case AQ:break;}Ad!==undefined&&mstrmojo.alert(w,undefined,a+": "+Ad);}}Ab=Ac.sqlText.domNode.firstChild.firstChild.firstChild;Ab.style.overflowY=this.checked?"hidden":"auto";}}]},{scriptClass:"mstrmojo.architect.ui.SQLInputBox",cssClass:"mstrmojo-ar-sqlInput-inputbox visible "+Y,alias:"sqlText",postBuildRendering:function(){mstrmojo.architect.ui.SQLInputBox.prototype.postBuildRendering.call(this);this.inputBox.handlekeyup=function(Ab){var Aa=this.parent.parent.parent.parent.parent;mstrmojo.ME.TokenInputBox.prototype.handlekeyup.call(this,Ab);Aa.changeDirtyStat(true);};}},{scriptClass:"mstrmojo.Label",cssClass:Y+"-curtain",alias:"curtain"}]});this.contents.middlePanel.addChildren([AV]);var AS=AV.sqlText;F.toggleClass(AS.domNode,"full",(this.options.cacheMode.value===AB));F.toggleClass(AS.domNode,"full-column",(this.options.catalogMode.value===x));AV.resize();AV.defaultSQL=AZ[u.find(AZ,"tp",AW)]?AZ[u.find(AZ,"tp",AW)].sql:"";AV.currentSQL=AU[u.find(AU,"tp",AW)]?AU[u.find(AU,"tp",AW)].sql:"";if("namespace"===AW){if(g===AV.currentSQL){AV.currentSQL=f(AV.currentSQL);}}AS.setSQLStatement(AV.currentSQL);AV.sqlHead.sqlCheck.checked=!AV.useDefaultSQL();AV.sqlHead.sqlCheck.set("checked",AV.useDefaultSQL());return AV;}function V(AZ,AU,AX,AT){var AW=this,AV,AS,AY;AS=AZ[u.find(AZ,"tp",AX)];AV=AU[u.find(AU,"tp",AX)];AY=AW.contents.middlePanel.children[AT].sqlText.getSQLStatement();if(AS===undefined&&AX==="namespace"){return false;}if(AY===AS.sql){AY="";}AV.sql=AY;return AV;}function Q(AW,AV,AU,AS){var AT,AZ;if((AV.value===q)){AT=l.cloneArray(AW.SQLStatements.currentSQLs.allNS);AZ=l.cloneArray(AW.SQLStatements.defaultSQLs.allNS);if(AU.value===AQ){if(AW.supportsNameSpaces){AT=l.cloneArray(AW.SQLStatements.currentSQLs.allNS);AZ=l.cloneArray(AW.SQLStatements.defaultSQLs.allNS);}}else{if(AU.value===r){if(AW.supportsNameSpaces){var AY=l.cloneArray(AW.SQLStatements.currentSQLs.allNS),AX=l.cloneArray(AW.SQLStatements.defaultSQLs.allNS);AT[u.find(AT,"tp","column")]=AY[u.find(AY,"tp","column")];AZ[u.find(AZ,"tp","column")]=AX[u.find(AX,"tp","column")];}}}}else{AT=l.cloneArray(AW.SQLStatements.currentSQLs.currentNS);AZ=l.cloneArray(AW.SQLStatements.defaultSQLs.currentNS);}if(AS){return AT;}return AZ;}function E(){var AS=Z.position(this.domNode);this.set("richTooltip",{cssClass:"vi-regular A-center vi-tooltip-A",top:Math.max(AS.y+AS.h*1.2,0),left:Math.max(AS.x+AS.w*0.5,0),posType:mstrmojo.tooltip.POS_TOPCENTER,content:this.title});}function B(){var AU=this,AS=new mstrmojo.Box({alias:"sqlPreviewBox",cssClass:Y+"-sqlBox",children:[{scriptClass:"mstrmojo.Label",cssClass:Y+"-sqlPreviewLabel",text:L.length>m?L.substring(0,m-G)+AM:L,title:L,useRichTooltip:true,updateTooltipConfig:function(){E.call(this);}},{scriptClass:"mstrmojo.Box",cssClass:Y+"-preview",alias:"sqlPreviewContents",children:[new mstrmojo.warehouse.ui.NameSpacePullDown({alias:"nameSpaces",sourceInfo:"CatSQL",keepNamespacesVisible:true,catalogRefreshNS:function(){var AW=mstrApp.getRootController(),AX=AW.model,AY=AU.btnHbox.applyBtn;if(AU.isDirty){mstrmojo.confirm(mstrmojo.desc(15180,"Catalog SQL statement modification will be applied firstly before you preview catalog."),{confirmBtn:{fn:function(){AY.onclick(function(){AX.catalogRefresh=true;AX.sourceInfo="CatSQL";AW.updateSelectedDBRoleId();});},t:mstrmojo.desc(134,"Apply")},cancelBtn:{fn:function(){}}},{title:mstrmojo.desc(15185,"Apply SQL statement")});}else{AX.catalogRefresh=true;AX.sourceInfo="CatSQL";AW.updateSelectedDBRoleId();}},nameSpacesLoaded:function(){if(this.parent.parent.parent){var AX=this.parent.parent.parent.parent.parent,AW=AX.options.nsMode;if(AW.value===q){this.pulldown.set("items",[]);mstrApp.rootController.availableTableSearch("",{dbRoleID:AX.dbRole.did,nameSpace:"",getFresh:true,sourceInfo:"CatSQL"});}}},onItemSelectedCallback:function AV(AX){AU.selectedNS=AX.n;var AW=AU.btnHbox.applyBtn;if(AU.isDirty&&AX.n!==""){mstrmojo.confirm(mstrmojo.desc(15180,"Catalog SQL statement modification will be applied firstly before you preview catalog."),{confirmBtn:{fn:function(){AW.onclick();},t:mstrmojo.desc(134,"Apply")},cancelBtn:{fn:function(){}}},{title:mstrmojo.desc(15185,"Apply SQL statement")});}else{if(AU.options.nsMode.value!==q){mstrApp.rootController.availableTableSearch("",{dbRoleID:AU.dbRole.did,nameSpace:AU.selectedNS||"",getFresh:AU.isDirty,sourceInfo:"CatSQL"});}}},onvisibleChange:function(){var AW=(this.domNode&&this.domNode.clientWidth)||parseInt(this.width,10);if(this.visible&&typeof AW==="number"&&AW>0){this.pulldown.set("width","144px");if(this.waitBoxTip){this.waitBoxTip.adjustCorners();}}}})]},{scriptClass:"mstrmojo.warehouse.ui.AvailableTablesTree",alias:"dbTableTree",cssClass:"mstrmojo-wh-AvailableTablesTree "+Y+"-dbTablesTree",sourceInfo:"CatSQL",editor:AU,postCreate:function AT(){this.ondblclick=function(){};if(this.editor.options.catalogMode.value===x){this.cssClass+="-none";}}}]});this.contents.rightPanel.addChildren([AS]);}function U(){var AS,AT=this.parent.count,AU=this.parent.prefix;if(this.checked){for(AS=0;AS<AT;AS++){this.parent[AU+AS].set("checked",false);}this.set("checked",true);}}function P(AT){var AS=l.walk("dbRole.mdDBRole",AT);return AE.isdbRoleWritable(AS);}function d(AT){var AS=l.walk("dbRole.mdDBRole",AT);return AS&&AS.usable==="1";}function AK(){var AX=this,Ac=AX.options,AW=AX.contents.middlePanel,AY=AX.contents.rightPanel,AU,AS,Ab,AV,AT;if(AX.loading){return ;}this.loadingPanel=true;AW.removeChildren();z.call(AX);AS=Q(AX,Ac.nsMode,Ac.cacheMode,true);Ab=Q(AX,Ac.nsMode,Ac.cacheMode,false);e=[];e.push(o.call(AX,Ab,AS,"namespace"));if(Ac.catalogMode.value===t){switch(Ac.cacheMode.value){case AB:AV=o.call(AX,Ab,AS,"full");e.push(AV);break;case r:case AQ:e.push(o.call(AX,Ab,AS,"table"));e.push(o.call(AX,Ab,AS,"column"));break;default:break;}}AY.sqlPreviewBox&&AY.sqlPreviewBox.sqlPreviewContents.nameSpaces.destroy();AY.removeChildren();B.call(AX);AT=AX.contents.rightPanel.sqlPreviewBox.sqlPreviewContents.nameSpaces;AT.domNode.style.visibility=(AX.supportsNameSpaces?"":"hidden");AT.selectedIndex=undefined;AX.selectedNS=undefined;if(AX.supportsNameSpaces){if(AX.defaultOptions.nsMode.value===q&&AX.options.nsMode.value===AA){AT.keepNamespacesIndexUnselectedBeforeLoading=true;}AT.pulldown.set("visible",true);AT.labelNS.set("visible",true);AT.set("visible",true);AT.btnRefreshNS.set("visible",true);}this.loadingPanel=false;var AZ=P(AX),Aa=d(AX);AX.btnHbox.applyBtn.set("enabled",AZ&&Aa);AX.btnHbox.okBtn.set("enabled",AZ&&Aa);AT.btnRefreshNS.set("enabled",AZ&&Aa);}function f(AT){var AS;switch(AT){case"":AS=g;break;case g:AS="";break;default:AS=AT;break;}return AS;}mstrmojo.warehouse.ui.editors.CatalogSQLEditor=mstrmojo.declare(mstrmojo.Editor,[mstrmojo._FillsBrowser,mstrmojo._HasLayout],{scriptClass:"mstrmojo.warehouse.ui.editors.CatalogSQLEditor",cssClass:Y,title:AO,isDirty:false,changeDirtyStat:function(AS){this.isDirty=AS;this.btnHbox.applyBtn.set("enabled",P(this)&&d(this)&&AS);},hasApplied:false,options:{},SQLStatements:[],onUpdateInfo:undefined,supportsNameSpaces:false,dbRole:undefined,sql:"",curtain:undefined,useDefaultSQL:undefined,contents:undefined,middlePanel:undefined,rightPanel:undefined,sqlPreviewBox:undefined,sqlPreviewContents:undefined,leftPanel:undefined,currentSQLs:undefined,defaultSQLs:undefined,catalogModeRBBox:undefined,catalogModeRB0:undefined,catalogModeRB1:undefined,cacheMode:undefined,nsMode:undefined,catalogMode:undefined,sqlCheck:undefined,allNS:undefined,currentNS:undefined,cacheModeRBBox:undefined,nsModeRBBox:undefined,nsModeRB1:undefined,applyBtn:undefined,okBtn:undefined,revertBtn:undefined,closeBtn:undefined,cbkOnClose:mstrmojo.emotyFn,browserResized:function AI(AS){var AT=parseInt(AS.w,10);AN=AS;if(isNaN(AT)||AT<0||!this.domNode){return ;}if(AT<948){AT=1110;}else{if(AT>1063){AT=1110;}else{AT=Math.ceil(AT*0.95);}}this.domNode.children[0].style.width=AT+"px";this.contents.middlePanel.domNode.style.width=(AT-219-281)+"px";u.forEach(e,function(AU){AU.resize();});this.btnHbox.revertBtn.domNode.style.marginRight=(AT-316)+"px";},collectOptions:function AR(){var AX=this,Aa=AX.options,AW=Aa.catalogMode,AY=Aa.nsMode,AS=Aa.cacheMode,AT,AZ,AV=[];AV.push(AW);AV.push(AY);AV.push(AS);AT=Q(AX,AY,AS,true);AZ=Q(AX,AY,AS,false);var AU=V.call(AX,AZ,AT,"namespace",1);if(AU!==false){if(false===AX.contents.middlePanel.children[1].sqlHead.sqlCheck.checked&&W(AX.contents.middlePanel.children[1].sqlText.getSQLStatement())===""){AU.sql=f(AU.sql);}AV.push(AU);}if(Aa.catalogMode.value===t){switch(AS.value){case AB:AV.push(V.call(AX,AZ,AT,"full",2));break;case r:AV.push(V.call(AX,AZ,AT,"table",2));AV.push(V.call(AX,AZ,AT,"column",3));break;case AQ:AV.push(V.call(AX,AZ,AT,"table",2));AV.push(V.call(AX,AZ,AT,"column",3));break;}}return AV;},defaultOptions:undefined,applyOptions:function X(AW){var AV,AU=AW?AW:this.options,AT=this.contents.leftPanel;var AS=(u.find(mstrApp.rootController.getDBObjects().catalogDbTypes,"v",this.dbRole.mdDBRole.db_type)>=0);AT.catalogModeRBBox.catalogModeRB0.set("enabled",AS);if((AU.catalogMode.value===t)&&AS){AV=0;}else{AV=1;}AT.catalogModeRBBox["catalogModeRB"+AV].set("checked",true);AT.catalogModeRBBox["catalogModeRB"+AV].onclick();AT.nsModeRBBox.nsModeRB1.set("enabled",this.supportsNameSpaces);if(this.supportsNameSpaces){if(AU.nsMode.value===AB){AV=0;}else{AV=1;}}else{AV=0;}AT.nsModeRBBox["nsModeRB"+AV].set("checked",true);AT.nsModeRBBox["nsModeRB"+AV].onclick();if(AU.cacheMode.value===AB){AV=0;}else{if(AU.cacheMode.value===r){AV=1;}else{if(AU.cacheMode.value===AQ){AV=2;}}}AT.cacheModeRBBox["cacheModeRB"+AV].set("checked",true);AT.cacheModeRBBox["cacheModeRB"+AV].onclick();},checkSqlSection:function(){var AS=this,AU=AS.contents.middlePanel,AT=AU.children.slice(1);u.forEach(AT,function(AW,AV){AW.sqlHead.sqlCheck.set("checked",true);},AS);},onOpen:function n(){var AT=this.contents.leftPanel,AS,AU,AV;this.loading=true;this.defaultOptions=l.clone(this.options);this.applyOptions();this.hasApplied=false;this.selectedNS=undefined;this.loading=false;AK.call(this);AU=this.domNode.children[0];AV=parseInt(AU.style.top,10);if(AV<0){AU.style.top="0px";}if(AN){this.browserResized(AN);Z.center(AU);}this.changeDirtyStat(false);},onClose:function(){this.cbkOnClose.call(this);},children:[{scriptClass:"mstrmojo.HBox",alias:"contents",cssClass:"catsql-hbox",children:[{scriptClass:"mstrmojo.Box",cssClass:Y+"-leftPanel",alias:"leftPanel",children:[{scriptClass:"mstrmojo.Label",cssClass:Y+"-sectionTitle",text:AH.length>AJ?AH.substring(0,AJ-G)+AM:AH,title:AH,useRichTooltip:true,updateTooltipConfig:function(){E.call(this);}},{scriptClass:"mstrmojo.Label",cssClass:Y+"-sectionSubTitle",text:k},{scriptClass:"mstrmojo.Box",cssClass:Y+"-sectionBox",count:2,prefix:"catalogModeRB",alias:"catalogModeRBBox",children:[{scriptClass:"mstrmojo.RadioButton",cssClass:Y+"-option",label:S,index:0,alias:"catalogModeRB0",onclick:function AF(){U.call(this);},oncheckedChange:function j(){}},{scriptClass:"mstrmojo.RadioButton",cssClass:Y+"-option",label:b,index:1,alias:"catalogModeRB1",onclick:function AF(){U.call(this);},oncheckedChange:function j(){var AS=this.parent.parent.parent.parent;AS.changeDirtyStat(true);AS.options.catalogMode.value=(this.checked?x:t);AK.call(AS);}}]},{scriptClass:"mstrmojo.Label",cssClass:Y+"-sectionSubTitle",text:O},{scriptClass:"mstrmojo.Box",cssClass:Y+"-sectionBox",count:2,alias:"nsModeRBBox",prefix:"nsModeRB",children:[{scriptClass:"mstrmojo.RadioButton",cssClass:Y+"-option",label:I,index:0,alias:"nsModeRB0",onclick:function AF(){U.call(this);},oncheckedChange:function j(){if(!this.checked){return ;}var AS=this.parent.parent.parent.parent;AS.options.nsMode.value=q;AS.changeDirtyStat(true);AK.call(AS);}},{scriptClass:"mstrmojo.RadioButton",cssClass:Y+"-option",label:A,index:1,alias:"nsModeRB1",onclick:function AF(){U.call(this);},oncheckedChange:function j(){if(!this.checked){return ;}var AS=this.parent.parent.parent.parent;AS.options.nsMode.value=AA;AS.changeDirtyStat(true);AK.call(AS);}}]},{scriptClass:"mstrmojo.Label",cssClass:Y+"-sectionSubTitle",text:a},{scriptClass:"mstrmojo.Box",cssClass:Y+"-sectionBox",count:3,alias:"cacheModeRBBox",prefix:"cacheModeRB",children:[{scriptClass:"mstrmojo.RadioButton",cssClass:Y+"-option",label:N,index:0,alias:"cacheModeRB0",onclick:function AF(){U.call(this);},oncheckedChange:function j(){if(!this.checked){return ;}var AS=this.parent.parent.parent.parent;AS.changeDirtyStat(true);AS.options.cacheMode.value=AB;AK.call(AS);}},{scriptClass:"mstrmojo.RadioButton",cssClass:Y+"-option",label:K,index:1,alias:"cacheModeRB1",onclick:function AF(){U.call(this);},oncheckedChange:function j(){if(!this.checked){return ;}var AS=this.parent.parent.parent.parent;AS.changeDirtyStat(true);AS.options.cacheMode.value=r;AK.call(AS);}},{scriptClass:"mstrmojo.RadioButton",cssClass:Y+"-option",label:AL,index:2,alias:"cacheModeRB2",onclick:function AF(){U.call(this);},oncheckedChange:function j(){if(!this.checked){return ;}var AS=this.parent.parent.parent.parent;AS.changeDirtyStat(true);AS.options.cacheMode.value=AQ;AK.call(AS);}}]}]},{scriptClass:"mstrmojo.Box",cssClass:Y+"-middlePanel",alias:"middlePanel",children:[]},{scriptClass:"mstrmojo.Box",cssClass:Y+"-rightPanel",alias:"rightPanel",children:[]}]}],buttons:[{scriptClass:"mstrmojo.Button",cssClass:"mstrmojo-WebButton "+Y+"-button mstrmojo-ar-catSQL-revertBtn",text:D,alias:"revertBtn",onclick:function AF(){var AS=this.parent.parent;mstrmojo.confirm(mstrmojo.desc(15181,"Do you want to revert all modifications to default value?"),{confirmBtn:{hot:false,fn:function(){var AT=AS.defaultOptions;AS.applyOptions(AT);AS.checkSqlSection();}},cancelBtn:{fn:function(){}}},{title:mstrmojo.desc(15182,"Revert to Default Value")});}},{scriptClass:"mstrmojo.Button",cssClass:"mstrmojo-WebButton "+Y+"-button",text:R,alias:"applyBtn",enabled:false,onclick:function AF(AU){var AS=this.parent.parent,AT=AS.collectOptions();dbr=AS.dbRole.mdDBRole;if(P(AS)){AS.onUpdateInfo({options:AT,callback:function(){if(AS.selectedNS){mstrApp.rootController.availableTableSearch("",{dbRoleID:AS.dbRole.did,nameSpace:AS.selectedNS||"",getFresh:AS.isDirty,sourceInfo:"CatSQL"});}AS.changeDirtyStat(false);AS.hasApplied=true;typeof AU==="function"&&AU();}});}else{return ;}}},{scriptClass:"mstrmojo.Button",cssClass:"mstrmojo-WebButton "+Y+"-button",text:AP,alias:"okBtn",onclick:function AF(){var AS=this.parent,AT=AS.parent;if(AT.isDirty){AS.applyBtn.onclick(function(){AS.closeBtn.onclick();});}else{AS.closeBtn.onclick();}}},{scriptClass:"mstrmojo.Button",cssClass:"mstrmojo-WebButton "+Y+"-closeBtn",text:H,alias:"closeBtn",onclick:function AF(){var AS=this.parent.parent,AT=function AT(){u.forEach(AS.contents.rightPanel.sqlPreviewBox.dbTableTree.items,function(AU){delete AU.items;});AS.close();};if(AS.isDirty){mstrmojo.confirm(mstrmojo.desc(15183,"The SQL statement modification has not been saved applied, do you still want to leave and discard the SQL modification?"),{confirmBtn:{t:mstrmojo.desc(15186,"Leave"),hot:false,fn:function(){AT();}},cancelBtn:{t:mstrmojo.desc(221,"Cancel"),fn:function(){}}},{title:mstrmojo.desc(15184,"Discard SQL modification")});}else{AT();}}}]});}());(function(){mstrmojo.requiresCls("mstrmojo.ui.SearchablePulldown","mstrmojo.warehouse.EnumDataChangeEvents","mstrmojo.warehouse.EnumNamespaceMode","mstrmojo.warehouse.ui.AvailableTablesTree","mstrmojo.warehouse.ui.BasePanel","mstrmojo.warehouse.ui.NameSpacePullDown","mstrmojo.warehouse.ui.SearchBox");mstrmojo.requiresDescs(12260,9142,12259,12666,15173);var J=mstrmojo.array,K=mstrmojo.css,F="mstrmojo-wh-",H=mstrmojo.dom,B=mstrmojo.desc(12260,"%% Tables, Last cache update: $$"),L=mstrmojo.desc(9142,"Available Tables"),G=mstrmojo.desc(15173,"Edit Catalog Options"),Q=mstrmojo.warehouse.EnumDataChangeEvents;mstrmojo.warehouse.ui.AvailableTablesPanel=mstrmojo.declare(mstrmojo.warehouse.ui.BasePanel,null,{scriptClass:"mstrmojo.warehouse.ui.AvailableTablesPanel",cssClass:"AvailableTables",title:L,dbTableTree:undefined,searchBox:undefined,nameSpaces:undefined,catalogSQLBtn:undefined,refreshBtn:undefined,catSQL:undefined,useRichTooltip:true,showTooltip:function M(R,U){var S=R.target||H.eventTarget(R.hWin,R.e);if(S===this.titleNode||S===this.titleTextNode){this.richTooltip={cssClass:"vi-regular vi-tooltip-A",posType:mstrmojo.tooltip.POS_TOPLEFT,refNode:this.titleNode,top:32,content:this.titleTooltip};this._super(R,U);}},init:function N(V){this._super(V);var Y=this.searchBox,U=this.dbTableTree;Y.attachEventListener("searchTriggered",this.id,function(Z){U.userSelections={};mstrApp.getRootController().availableTableSearch(Z.searchValue);});this.addNewTitleButton({alias:"catalogSQLBtn",title:G,cssClass:F+"catalogSQL hidden",onclick:function R(){mstrApp.getRootController().displayCatalogSQL();}});var X=this,W={},S=W[this.id]={};S[Q.DBTABLES_CHANGED]=function(Z){X.set("titleTooltip",B.replace("%%",Z.items.length.toString()).replace("$$",Z.src.catalogStamp||""));};S[Q.DBROLE_SELECTION]=function(b){var c=this,a=mstrApp.getRootController(),Z=b.src.dbrs[J.find(b.src.dbrs,"did",b.value)];if(!!mstrApp.isWorkstation){K.toggleClass(this.searchBox.tableBox.refreshBtn.domNode,"btnRefreshNS-show",false);K.toggleClass(this.searchBox.tableBox.refreshBtn.domNode,"btnRefreshNS-hide",true);}else{Y.tableBox.refreshBtn.set("visible",false);}if(Z){Z.populate(function d(e){Y.clearSearch(true);K.toggleClass(c.catalogSQLBtn.domNode,"hidden",!(a.canDisplayCatalogSQL(b.src.dbObjects.dbTypes,e.mdDBRole.db_type)));if(!!mstrApp.isWorkstation){K.toggleClass(Y.tableBox.refreshBtn.domNode,"btnRefreshNS-show",Y._preSearch?Y._preSearch():false);K.toggleClass(Y.tableBox.refreshBtn.domNode,"btnRefreshNS-hide",!(Y._preSearch?Y._preSearch():false));}else{Y.tableBox.refreshBtn.set("visible",Y._preSearch?Y._preSearch():false);}});}else{if(!b.value){Y.clearSearch(true);}}};mstrApp.getRootController().attachDataChangeListeners(W);},onheightChange:function C(U){var S=mstrApp.getRootController(),V=S.dataService,R=(V==mstrmojo.qb.mdx.DataService);if(!this.nameSpaces.heightOffset){this.nameSpaces.heightOffset=21;}if(!this.heightOffset){this.heightOffset=85;}this.dbTableTree.set("height",parseInt(U.value,10)-this.heightOffset-(this.nameSpaces.visible?this.nameSpaces.heightOffset:0)-(!R&&this.searchBox.visible?this.searchBox.domNode.clientHeight:0)-(R?7:0)+"px");},onwidthChange:function E(R){if(!this.searchBox.widthOffset){this.searchBox.widthOffset=0;}var S=parseInt(R.value,10);this.searchBox.set("width",S-6-this.searchBox.widthOffset+"px");this.nameSpaces.set("width",S-12+"px");if(!!mstrApp.isWorkstation){this.nameSpaces.pulldown.set("width",parseInt(this.nameSpaces.pulldown.width,10)+4+"px");this.nameSpaces.set("width",parseInt(this.searchBox.width,10)+7+"px");}},postBuildRendering:function A(){if(this._super){this._super();}if(!!mstrApp.isWorkstation){this.searchBox.tableBox.inputBox.domNode.setAttribute("placeholder",mstrmojo.desc(12666,"Search..."));this.nameSpaces.btnRefreshNS.set("visible",true);this.searchBox.tableBox.refreshBtn.set("visible",true);K.toggleClass(this.searchBox.tableBox.refreshBtn.domNode,"btnRefreshNS-show",false);K.toggleClass(this.searchBox.tableBox.refreshBtn.domNode,"btnRefreshNS-hide",true);}},children:[{alias:"nameSpaces",scriptClass:"mstrmojo.warehouse.ui.NameSpacePullDown",sourceInfo:"tablesPanel",nameSpacesLoaded:function D(){this.parent.searchBox.clearSearch(true);this.parent.onheightChange({value:this.parent.height});},onItemSelectedCallback:function P(R){var S=this.parent.searchBox;S.clearSearch(true);mstrApp.getRootController().setNameSpaceID(R.n);if(!!mstrApp.isWorkstation){K.toggleClass(S.tableBox.refreshBtn.domNode,"btnRefreshNS-show",S._preSearch?S._preSearch():false);K.toggleClass(S.tableBox.refreshBtn.domNode,"btnRefreshNS-hide",!(S._preSearch?S._preSearch():false));}else{S.tableBox.refreshBtn.set("visible",S._preSearch?S._preSearch():false);}}},{scriptClass:"mstrmojo.warehouse.ui.SearchBox",alias:"searchBox",_preSearch:function O(){if(this.parent&&this.parent.nameSpaces.visible){return(this.parent.nameSpaces.selectedIndex!==undefined);}return true;},_onRefresh:function I(){this.clearSearch(true);mstrApp.getRootController().handleDBTableRefresh();}},{alias:"dbTableTree",scriptClass:"mstrmojo.warehouse.ui.AvailableTablesTree",sourceInfo:"tablesPanel",renderOnScroll:true}]});}());(function(){mstrmojo.requiresCls("mstrmojo.Label","mstrmojo.Pulldown","mstrmojo.ObjectInputBox","mstrmojo.ME.MetricDataService","mstrmojo.ME._MetricEditorHelper","mstrmojo.ui.ScrollableSuggestionList");var H=mstrmojo.expr,O=mstrmojo.Enum_OIB_States,J=mstrmojo.ME._MetricEditorHelper,R=mstrmojo.dom;mstrmojo.ME.ObjectInputBox=mstrmojo.declare(mstrmojo.ObjectInputBox,null,{cssClass:"",autoSelect:false,suggestionListClass:"mstrmojo.ui.ScrollableSuggestionList",suggestionPopupCssClss:"mstrmojo-ME-ObjectInputBox-suggest",blockCount:mstrmojo.ME.MetricDataService.blockCount,suggestCount:mstrmojo.ME.MetricDataService.suggestCount,useKeyDelay:true,showDesc:true,showPath:true,showFunctionSyntaxAsPath:true,emptyText:"Search for an object",showEmptyItem:false,noEditButton:true,browseItemVisible:true,click2edit:true,showSuggestionOnEdit:false,tabNavigable:true,obCfg:{},dynamicVerify:true,init:function P(E){this._super(E);mstrmojo.css.addWidgetCssClass(this,"mstrmojo-ME-ObjectInputBox");if(this.isDME){this.browseItemVisible=!this.isDME;this.suggestCount=this.isDME?1000:mstrmojo.ME.MetricDataService.suggestCount;this.REQUEST_THRESHOLD=1000;this.dynamicVerify=false;}},item2textCss:function D(X){if(this.isDME){return mstrmojo.ME._MetricEditorHelper.item2textCss(X);}var E=this._super(X)||{1:"f",4:"m",12:"a",13:"fc",43:"tr","-1":"rl","-99":"br"}[X.t]||"";return E?" icn "+E:"";},itemFunction:function B(Y,E,X,Z){Y[X.itemIdField]=X.nextId();var a=Z||mstrmojo.ME.ObjectItem,b=new a({parent:X,itemField:X.itemField,cssClass:X.item2textCss(Y),data:Y,bindings:{isFull:"this.parent.isFull"},onisFullChange:function(){if(this.hasRendered){this.updateButtonsVisibility();}}});X.attachEventListener4ItemWidget(b,X);return b;},getActiveItem:function M(){var E=this.editingIdx,Y,X;if(E>-1){Y=this.ctxtBuilder.itemWidgets[E];X=Y&&Y.data;}return X;},showObjectBrowser:function(E){this.set("suggestTarget",E);this.handleSuggestionItemSelect({t:-99},this.obCfg);},hideItemWidgetBrowseButton:function S(){return false;},hidePulldownButton:function G(){return true;},hideDelButton:function A(){return false;},dtp:0,verifyObject:function C(X,E){if(!this.dynamicVerify){return O.VALID;}var Z=E.data;var Y=parseInt(this.dtp,10);switch(Y){case -1:case -2:case -4:case -5:case -6:if(Z.t===-1||J.isDimty(X,Y===-1)){return O.VALID;}if(this.dynamicVerify){return this._super(X,E);}return Z.did?O.VALID:O.INVALID;case 1:case 2:case 3:case 4:case 5:case 6:case 7:if(Z.t<0){return O.VALID;}if(/^\d{1,}$/.test(mstrmojo.string.trim(X))||Z.did){return O.VALID;}if(this.dynamicVerify){return this._super(X,E);}return O.INVALID;default:return O.VALID;}},getItemsToFilterOut:function N(){return this.items;},updateSuggestion:function Q(E){var Y=this.getActiveItem();var X=this.getItemsToFilterOut();E=mstrmojo.array.filter(E,function(b){var a=b.did,Z=false,d;var c=function(e){mstrmojo.array.forEach(X,function(f){if(f!==Y&&f.did===e){Z=true;return false;}});};c(a);if(!Z){d=b;}return d;});if(this._super){this._super(E);}},nudge:function I(X){X.domNode.style.minWidth=this.suggestTarget.domNode.offsetWidth+(this.isDME&&!(mstrApp&&mstrApp.isWSStyling)?13:0)+"px";var Y=R.position(X.domNode),Z=R.position(this.suggestTarget.domNode),E=R.windowDim();if(Y.y+Y.h>E.h){X.domNode.style.top=(Z.y-Y.h-5)+"px";}}});mstrmojo.ME.ObjectItem=mstrmojo.declare(mstrmojo.ObjectItem,[mstrmojo._HasPopup],{markupString:'<div id={@id} class="mstrmojo-ObjectItem" style="{@cssText}"><div class="mstrmojo-ObjectItem-displayNode" tabindex="0" mstrAttach:click,focus><span class="mstrmojo-ObjectItem-text {@cssClass}"></span></div><div class="mstrmojo-ObjectItem-editNode"><input type="text" class="mstrmojo-ObjectItem-input" placeholder="{@placeholderText}" mstrAttach:keyup,keydown,focus/></div><div class="mstrmojo-ObjectItem-icons"><div class="mstrmojo-ObjectItem-down" onclick="mstrmojo.all[\'{@id}\'].showSuggestion(\'\')"></div><img class="mstrmojo-ObjectItem-browse" src="../images/1ptrans.gif" title="'+mstrmojo.desc(1825,"Browse")+'" onclick="mstrmojo.all[\'{@id}\'].browse()"/><div class="mstrmojo-ObjectItem-opts" title="'+mstrmojo.desc(9598,"Level options")+'" onclick="mstrmojo.all[\'{@id}\'].options(arguments[0])" style="display:none;"></div><img class="mstrmojo-ObjectItem-edit" src="../images/1ptrans.gif" title="'+mstrmojo.desc(1088,"Edit")+'" onclick="mstrmojo.all[\'{@id}\'].edit()"/><img class="mstrmojo-ObjectItem-del" src="../images/1ptrans.gif" title="'+mstrmojo.desc(629,"Delete")+'" onclick="mstrmojo.all[\'{@id}\'].del(arguments[0])" style="display:none;"/></div></div>',markupSlots:{displayNode:function(){return this.domNode.firstChild;},editNode:function(){return this.domNode.childNodes[1];},textNode:function(){return this.domNode.firstChild.firstChild;},pulldownButtonNode:function(){return this.domNode.lastChild.childNodes[0];},browseButtonNode:function(){return this.domNode.lastChild.childNodes[1];},optionButtonNode:function(){return this.domNode.lastChild.childNodes[2];},editButtonNode:function(){return this.domNode.lastChild.childNodes[3];},delButtonNode:function(){return this.domNode.lastChild.lastChild;},inputNode:function(){return this.domNode.childNodes[1].firstChild;}},init:function P(E){this._super(E);this.placeholderText=this.parent.emptyText;},initState:function U(){var X=this.parent,Y=this.data,E=Y.state;if(X.dynamicVerify){return this._super();}if(typeof E==="undefined"){E=X.verifyObject(Y[this.itemField],this);Y.state=E;}return E;},reduceWidth:function(){},updateButtonsVisibility:function F(){if(this._super){this._super();}if(this.parent.hidePulldownButton()){this.pulldownButtonNode.style.display="none";}if(this.parent.hideItemWidgetBrowseButton()){this.browseButtonNode.style.display="none";}this.optionButtonNode.style.display=this.data.state!==O.ADDING&&this.optionButtonVisible?"":"none";this.delButtonNode.style.display=this.data.state!==O.ADDING&&!this.parent.hideDelButton()&&!this.isFull?"":"none";},browse:function L(){this.set("state",this.data.state===O.ADDING?O.ADDING:O.EDITING);this.parent.showObjectBrowser(this);},click2edit:function K(){if(this.parent.click2edit){this.edit();}},onclick:function W(){this.click2edit();},onfocus:function V(E){if(E.getTarget()===this.inputNode){this._super();}else{this.click2edit();}}});}());(function(){mstrmojo.requiresCls("mstrmojo.array","mstrmojo.hash","mstrmojo.expr","mstrmojo.Button","mstrmojo.Editor","mstrmojo.ME.MetricDataService","mstrmojo.ME._MetricEditorHelper");mstrmojo.requiresDescs(12852);var J=mstrmojo.expr,A=mstrmojo.array,G=mstrmojo.hash,M=mstrmojo.ME._MetricEditorHelper,B=mstrmojo.ME.Enum.DYNAMIC_DIMTY,L=mstrmojo.ME.Enum.UI_DATA_TYPE,I=mstrmojo.ME.Enum.UI_OBJECT_TYPE,F=mstrmojo.ME.MetricToken.brackets;var K;function Q(){var E=mstrmojo.all[K];if(E&&E.onmetricModify){E.onmetricModify();}}function C(){var E=mstrmojo.all[K];if(E&&E.updateScrollbars){E.updateScrollbars();}}mstrmojo.ME.SortByInputList=mstrmojo.declare(mstrmojo.WidgetList,null,{makeObservable:true,isNewDef:true,isDME:false,init:function R(E){this._super(E);mstrmojo.css.addWidgetCssClass(this,"mstrmojo-ME-sortby");},preBuildRendering:function(){var E=this.items||[];if(this.isNewDef&&this.isDME){E.push(B.getAutomaticDimtyObject());}E.push({n:""});this.items=E;if(this._super){this._super();}},getTokens:function(){var X=this.items,E=X.length-1,W,b=[];if(E>0){b.push({v:"SortBy"});b.push({v:"=",isDelimiter:true});b.push({v:"(",isDelimiter:true});for(W=0;W<E;W++){var Z=X[W],a=Z.selFrm,V,Y=false;if(M.isDimty(Z.n)){V={v:Z.n};Y=true;}else{if(/^@/.test(Z.did)){V={v:Z.did};Y=true;}else{V={v:F(Z.n),oi:Z};}}if(a&&(Z.t===J.TP.ATTR||(Z.t===J.TP.CONS&&Z.st===J.STP.NDE))){G.copy({v:F(Z.n)+"@"+F(a.n),exv:a.dssid,extp:8},V);}b.push(V);if(!Y){if(!!Z.asc){b.push({v:"Desc",tp:259});}}if(W!==(E-1)){b.push({v:",",isDelimiter:true});}}b.push({v:")",isDelimiter:true});}return b;},itemFunction:function(Y,E,V){return new mstrmojo.Box({cssClass:"mstrmojo-ME-sortby-item",alias:"sortByItem",parent:V,children:[{scriptClass:"mstrmojo.ME.ObjectInputBox",alias:"sortByInput",cssClass:"mstrmojo-ME-ObjectInputBox-sortby",emptyText:mstrmojo.desc(12179,"Search for #").replace("#",mstrmojo.desc(3377,"Object").toLowerCase()),isDME:V.isDME,dtp:L.Sortby,maxObjectCount:1,folderLinksContextId:16,browsableTypes:[J.TP.ATTR,J.TP.METRIC,J.TP.FOLDER].join(","),getCandidatesThroughTaskCall:function a(d,c){d.objectType=J.TP.ATTR+","+J.TP.METRIC;d.rootFolderType=39;d.blockCount=d.blockCount||this.blockCount;mstrmojo.ME.MetricDataService.getMetricComponents(d,c);},obCfg:{folderLinksContextId:16,browsableTypes:[J.TP.ATTR,J.TP.METRIC,J.TP.FOLDER].join(",")},bindings:{candidates:"this.parent.parent.candidates"},postCreate:function(c){if(!c){this.set("items",Y.did||Y.dimty?[Y]:null);}},onitemchange:function(){var e=this.getSelectedObjects()[0];if(!e||!e.did&&!e.n){return ;}Y.selFrm=null;mstrmojo.hash.copy(e,Y);var d=this.parent.formsPulldown;if(d){d.updateForms(e);}var c=this.parent.ascPulldown;if(c){c.set("visible",Y.t===4||Y.st===J.STP.NDE);}Q();},onadd:function W(){if(this.getSelectedObjects().length===0){return ;}if(this.parent===V.ctxtBuilder.itemWidgets[V.items.length-1]){V.add([{n:""}]);this.parent.del.set("visible",true);}},hidePulldownButton:function(){return !V.isDME;},hideDelButton:function(){return true;},hideItemWidgetBrowseButton:function(){return V.isDME;},getItemsToFilterOut:function(){return V.items;}},{scriptClass:"mstrmojo.Pulldown",alias:"formsPulldown",cssClass:"mstrmojo-ME-sortby-forms mstrmojo-ME-Pulldown",popupCssClass:"mstrmojo-ME-Pulldown-Popup",defaultSelection:-1,bindings:{visible:function(){return this.items&&this.items.length>0;}},popupToBody:true,popupZIndex:100,postCreate:function(){this.retrieveDssForms(Y);},retrieveDssForms:function X(e){var d=this,c=function(){var m=function(n){e.dssforms=n;d.set("items",e.dssforms);d.selectedIndex=-1;d.selectedItem=null;d.value=null;d.set("value",e.selFrm);};var k=d.parent.sortByInput.candidates,f=k&&k.items;if(e.did&&f){var j=A.find(f,"did",e.did);if(j>-1){var h=mstrmojo.hash.clone(f[j].fs);if(h){A.forEach(h,function(n){n[d.itemIdField]=n.fid;n[d.itemField]=n.fnm;});m(h);return ;}}}var l=function(n){if(n){var o=n.container;if(o&&o.dssforms){e.dssforms=o.dssforms;m(e.dssforms);}}},g=function(n){mstrmojo.alert(n.getResponseHeader("X-MSTR-TaskFailureMsg"));};mstrmojo.ME.MetricDataService.getAttributeForms({attributeID:e.did,displayedForms:0},{success:l,failure:g});};switch(e.t){case J.TP.ATTR:c();break;case J.TP.CONS:if(e.st===J.STP.NDE){d.set("visible",false);}break;case J.TP.METRIC:d.set("visible",false);break;case I.Dimty:d.set("visible",false);break;}},updateForms:function Z(c){this.retrieveDssForms(c);},onvalueChange:function b(){if(this.selectedItem){Y.selFrm=this.selectedItem;}if(this.hasRendered){Q();}}},{scriptClass:"mstrmojo.Pulldown",alias:"ascPulldown",cssClass:"mstrmojo-ME-sortby-asc mstrmojo-ME-Pulldown",popupCssClass:"mstrmojo-ME-Pulldown-Popup",items:[{n:"Ascending",v:0},{n:"Descending",v:1}],itemIdField:"v",popupToBody:true,popupZIndex:100,visible:false,bindings:{value:function(){return this.parent.parent.items[E].asc;},visible:function(){var c=this.parent.sortByInput.getSelectedObjects()[0];return this.parent.formsPulldown.visible&&this.parent.formsPulldown.value||c.t===J.TP.METRIC||c.st===J.STP.NDE;}},onvalueChange:function(c){Y.asc=this.value;if(this.hasRendered){Q();}}},{scriptClass:"mstrmojo.Button",alias:"del",cssClass:"mstrmojo-ACLEditor-delete",text:"&nbsp",title:mstrmojo.desc(629,"Delete"),bindings:{visible:function(){var c=V.itemIndex(Y);return this.parent.parent.items[c].did;}},onclick:function(){V.remove(V.items[V.itemIndex(Y)]);Q();}}]});},onadd:function H(){C();},onremove:function S(){C();}});mstrmojo.ME._HasSortBy=mstrmojo.provide("mstrmojo.ME._HasSortBy",{_mixinName:"mstrmojo.ME._HasSortBy",ios:false,oniosChange:function P(E){this.sortByContainer.set("visible",E.value);},onOpen:function(){if(this._super){this._super();}K=this.id;var V=this.oi.tks,W=!V.met;var E=this.sortByContainer&&this.sortByContainer.sortByWidgetList;if(E){E.set("isNewDef",W);E.set("isDME",this.isDME);E.set("candidates",this.getCandidates4Sortby());E.set("items",this.getSortByDefFromTokens().items||[]);}},getCandidates4Sortby:function U(){var V=this.candidates,E;if(V&&!this.noCache){E=A.filter(V.items,function(W){return W.t===J.TP.ATTR||W.t===J.TP.METRIC||W.st===J.STP.NDE;});if(this.isDME){E=B.getItems("sortby").concat(E);}}return{items:E||[],isComplete:V&&V.isComplete};},getSortByWidget:function D(E){var X=this,W=[{scriptClass:"mstrmojo.ME.SortByInputList",alias:"sortByWidgetList",cssClass:"sortBy mstrmojo-ME-sortby",cssDisplay:"table-cell"}],V={scriptClass:"mstrmojo.Label",alias:"sortByLabel",cssClass:"mstrmojo-ME-SortBy-label",cssDisplay:"table-cell",text:mstrmojo.desc(12852,"Sort By")};if(E){W.unshift(V);}return{scriptClass:"mstrmojo.Box",alias:"sortByContainer",cssClass:"mstrmojo-ME-SortBy-Container",cssDisplay:"table-row",visible:X.ios,postCreate:function(){X.sortByContainer=this;this.editor=X;},getTokens:function(){return this.sortByWidgetList.getTokens();},children:W};},getSortByDefFromTokens:function N(){var b=this.oi.tks.items,X=b.length,c,Z,V,W,Y={};for(W=0;W<X;W++){c=b[W];Z=c.tp;V=c.sctt;if(mstrmojo.ME.MetricToken.isDelimiter(c.v)&&(c.v!=="("&&c.v!==")")||c.v==="&gt;"||c.v==="&lt;"){continue;}switch(V){case 131072:if(Z===302){c=b[++W];while(c){if(c.tp!==282){if(c.oi){c.oi.selFrm=c.exv;var a=b[W+1];if(a.v==="Desc"&&a.tp===259){c.oi.asc=1;W++;}Y.items=Y.items||[];Y.items.push(c.oi);}else{if(c.tp===64){Y.items=Y.items||[];var E=c.v+b[++W].v;c=b[W+1];if(c.tp===43||c.tp===45){E+=b[++W].v;E+=b[++W].v;}Y.items.push(B.getDimtyObject(E,this.isDME));}}}if((c=b[++W])["v"]===")"){break;}}}}}return Y;},getSortByDefAsTokens:function O(){return this.sortByContainer.getTokens();}});}());(function(){mstrmojo.requiresCls("mstrmojo.hash","mstrmojo.array","mstrmojo.css","mstrmojo.expr","mstrmojo.ValidationTextBox","mstrmojo.HBox","mstrmojo.ui.menus.EditorConfig","mstrmojo.mstr.EnumFunction","mstrmojo.DropDownList","mstrmojo.ui.Pulldown","mstrmojo.SearchablePulldown","mstrmojo.ButtonList","mstrmojo.Box","mstrmojo.Label","mstrmojo.RadioList","mstrmojo.CheckList","mstrmojo.EditableLabel","mstrmojo.CheckBox","mstrmojo._FormatDefinition","mstrmojo.num","mstrmojo.locales","mstrmojo.vi.models.VIComponentMap","mstrmojo.func","mstrmojo.dom","mstrmojo.ME.AttributeEditBox","mstrmojo.ME.MetricToken","mstrmojo.string","mstrmojo.dom","mstrmojo.models.datasets.DataInterface","mstrmojo.chart.model.enums.EnumDSSObjectType","mstrmojo.vi.ui.editors.ObjectPicker","mstrmojo.vi.ui.editors.AttributeLinkEditor","mstrmojo.vi.ui.NumberFormatter","mstrmojo.mstr.EnumDSSXMLBaseFormType","mstrmojo.mstr.EnumDSSXMLObjectTypes","mstrmojo.mstr.EnumDSSXMLObjectSubTypes","mstrmojo.mstr.EnumDSSConsolidationType");mstrmojo.requiresDescs(1442,1885,1886,2022,2122,2123,2124,2125,2126,2127,2128,2129,2130,2131,2132,3993,4564,11494,11495,11496,11497,14612);var r=mstrmojo.mstr.EnumFunction,a=mstrmojo.hash,x=mstrmojo.array,D=mstrmojo.css,Y=mstrmojo.dom,AB=mstrmojo.Button.newWebButton,V=mstrmojo.ME.MetricToken.brackets,AH=mstrmojo.ME.MetricToken.argDelimiter,W=mstrmojo._FormatDefinition,u=mstrmojo.models.datasets.DataInterface,K=mstrmojo.vi.models.VIComponentMap.TYPES,X=mstrmojo.chart.model.enums.EnumDSSObjectType,t=mstrmojo.mstr.EnumDSSXMLBaseFormType,AU=mstrmojo.mstr.EnumDSSXMLObjectTypes,N=mstrmojo.mstr.EnumDSSXMLObjectSubTypes,AF=mstrmojo.mstr.EnumDSSConsolidationType;var b={SUM:mstrmojo.desc(2131,"Sum"),ADD:mstrmojo.desc(6017,"Add"),AVG:mstrmojo.desc(2122,"Average"),MAX:mstrmojo.desc(2125,"Maximum"),GST:mstrmojo.desc(5869,"Greatest"),MIN:mstrmojo.desc(2127,"Minimum"),LST:mstrmojo.desc(5868,"Least"),CNT:mstrmojo.desc(2123,"Count"),MTP:mstrmojo.desc(5418,"Multiply"),STD:mstrmojo.desc(2130,"Standard Deviation"),PTD:mstrmojo.desc(11494,"Population Standard Deviation")},g={SUM:{n:b.SUM,t:r.FunctionSum},ADD:{n:b.ADD,t:r.FunctionPlus},AVG:{n:b.AVG,t:r.FunctionAvg},MAX:{n:b.MAX,t:r.FunctionMax},GST:{n:b.GST,t:r.FunctionGreatest},MIN:{n:b.MIN,t:r.FunctionMin},LST:{n:b.LST,t:r.FunctionLeast},TMS:{n:b.MTP,t:r.FunctionTimes},CNT:{n:b.CNT,t:r.FunctionCount},GEM:{n:mstrmojo.desc(2124,"Geometric Mean"),t:r.FunctionGeomean},MED:{n:mstrmojo.desc(2126,"Median"),t:r.FunctionMedian},MOD:{n:mstrmojo.desc(2128,"Mode"),t:r.FunctionMode},PDT:{n:mstrmojo.desc(2129,"Product"),t:r.FunctionProduct},STD:{n:mstrmojo.desc(2130,"Standard Deviation"),t:r.FunctionStdev},VAR:{n:mstrmojo.desc(2132,"Variance"),t:r.FunctionVar}},c=[{n:b.SUM,t:r.FunctionOLAPSum},{n:b.AVG,t:r.FunctionOLAPAvg},{n:b.MIN,t:r.FunctionOLAPMin},{n:b.MAX,t:r.FunctionOLAPMax},{n:b.CNT,t:r.FunctionOLAPCount}],AS=[{n:b.SUM,t:r.FunctionOLAPSum},{n:b.AVG,t:r.FunctionOLAPAvg},{n:b.MIN,t:r.FunctionOLAPMin},{n:b.MAX,t:r.FunctionOLAPMax},{n:b.CNT,t:r.FunctionOLAPCount}],M=[{n:mstrmojo.desc(1058,"Previous"),t:r.FunctionLag},{n:mstrmojo.desc(1059,"Next"),t:r.FunctionLead},{n:mstrmojo.desc(4046,"First"),t:r.FunctionFirst},{n:mstrmojo.desc(4049,"Last"),t:r.FunctionLast}];var AC={YEAR:"Year",QUARTER:"Quarter",CONCAT:"Concat",QUARTERSTARTDATE:"QuarterStartDate",MONTH:"Month",TOSTRING:"ToString",MONTHSTARTDATE:"MonthStartDate",WEEK:"Week",WEEKSTARTDATE:"WeekStartDate",DAYOFMONTH:"DayOfMonth",DAYOFWEEK:"DayOfWeek",DAYOFYEAR:"DayOfYear"};var AL={};AL[AC.YEAR]="6F7DF5F8449111D5BEA300B0D01A55EF";AL[AC.QUARTER]="6F7DF5F7449111D5BEA300B0D01A55EF";AL[AC.CONCAT]="6F7DF5FF449111D5BEA300B0D01A55EF";AL[AC.QUARTERSTARTDATE]="59E10CE2ADDD4A6DAC2416A72999A9ED";AL[AC.MONTH]="6F7DF5F6449111D5BEA300B0D01A55EF";AL[AC.TOSTRING]="D1ED29645DEC4DBF99E8E09ED939074B";AL[AC.MONTHSTARTDATE]="7C63D4E70B2741C3A5B54A2EFD40961B";AL[AC.WEEK]="6F7DF5F5449111D5BEA300B0D01A55EF";AL[AC.WEEKSTARTDATE]="44681336D0DB4E43AC333FFB3CC4400D";AL[AC.DAYOFMONTH]="6F7DF5F2449111D5BEA300B0D01A55EF";AL[AC.DAYOFWEEK]="6F7DF5F3449111D5BEA300B0D01A55EF";AL[AC.DAYOFYEAR]="6F7DF5F4449111D5BEA300B0D01A55EF";var Q="@form";function d(AW){var AY=8,AZ=1,AV=x.find(AW.fs,"idf",true);if(AV===-1){return null;}var AX=AW.fs[AV];return((AW.da||AX.obf)&&(AX.bftp===AY||AX.bftp===AZ))?AX:null;}var AR={Year:{ID:[AC.YEAR,"(",Q,")"]},Quarter:{ID:[AC.YEAR,"(",Q,") * 10 + ",AC.QUARTER,"(",Q,")"],DESC:[AC.CONCAT,'("Q"',AH,AC.QUARTER,"(",Q,")",AH,' ", "',AH,AC.YEAR,"(",Q,"))"],DATE:[AC.QUARTERSTARTDATE,"(",Q,")"]},QuarterOfYear:{ID:[AC.QUARTER,"(",Q,")"],DESC:[AC.CONCAT,'("Q"',AH,"This@ID)"]},Month:{ID:[AC.YEAR,"(",Q,") * 100 + ",AC.MONTH,"(",Q,")"],DESC:[AC.TOSTRING,'<Pattern="mmm yyyy">(',Q,")"],DATE:[AC.MONTHSTARTDATE,"(",Q,")"]},MonthOfYear:{ID:[AC.MONTH,"(",Q,")"],DESC:[AC.TOSTRING,'<Pattern="mmmm">(',Q,")"]},Week:{ID:[AC.YEAR,"(",Q,") * 100 + ",AC.WEEK,"(",Q,")"],DESC:[AC.CONCAT,'("W"',AH,AC.WEEK,"(",Q,")",AH,' ", "',AH,AC.YEAR,"(",Q,"))"],DATE:[AC.WEEKSTARTDATE,"(",Q,")"]},WeekOfYear:{ID:[AC.WEEK,"(",Q,")"]},DayOfMonth:{ID:[AC.DAYOFMONTH,"(",Q,")"]},DayOfWeek:{ID:[AC.DAYOFWEEK,"(",Q,")"],DESC:[AC.TOSTRING,'<Pattern="ddd">(',Q,")"]},DayOfYear:{ID:[AC.DAYOFYEAR,"(",Q,")"]}};function k(AX,AZ,AY,AV){return{scriptClass:"mstrmojo.ui.Pulldown",isHostedWithin:false,items:AX,selectedIndex:AZ,onitemSelected:function AW(Aa){var Ab=this.parent;while(!Ab.data||!Ab.data[AY]){Ab=Ab.parent;}Ab.data.set(AY,AV?AV(Aa):Aa.v);}};}function AD(AX,AW,AV){return{scriptClass:"mstrmojo.Box",cssClass:"breakByBox",children:[{scriptClass:"mstrmojo.Label",text:mstrmojo.desc(13903,"Break by:"),cssClass:"menu-info-text"},a.copy(AV,k(AX,AW,"breakBy",function(AY){return{id:AY.did,type:AY.t,dmy:AY.dmy};}))]};}function AP(AY){var AZ=AY.metrics,Aa=AY.propName,AX=AY.optionValueField||"id",AV=x.find(AZ,AX,AY.value),Ab=function Ab(Ad){var Ac=this.parent;while(!Ac.data||!Ac.data.hasOwnProperty(Aa)){Ac=Ac.parent;}Ac.data.set(Aa,Ad?{id:Ad[AX],type:4}:{cst:this.text});};return{scriptClass:"mstrmojo.ui.SearchablePulldown",isHostedWithin:false,cssClass:"Calculation-PullDown",items:AZ,selectedIndex:AV,useRichTooltip:true,bindings:AY.bindings,valid:true,allowCustomText:true,allowEmptyText:true,allowHTML:false,onvalidChange:function AW(){mstrmojo.css.toggleClass(this.domNode,"invalid",!this.valid);if(this.hasRendered){this.hideTooltip();this.showTooltip();}},updateTooltipConfig:function(){if(this.valid){this.richTooltip=null;return ;}this.richTooltip={posType:mstrmojo.tooltip.POS_BOTTOMLEFT,cssClass:"vi-warning vi-tooltip-C vi-calculation-warning",left:this.domNode.offsetWidth+12,top:this.domNode.offsetHeight+5,refNode:this.domNode,content:mstrmojo.desc(13819,"Invalid input")};},onitemSelected:Ab,onTextEditComplete:function(){Ab.call(this,this.items[this.selectedIndex]);},onPopupWidgetOpened:function(){this.set("valid",true);},postkeyup:AY.postkeyup};}function U(AY,AX,AW){if(AY&&AY.datap){var AV=x.filterOne(AY.datap,function(Aa){return Aa.tbid===AX;}),AZ=AV&&AV.maps.amps;return x.filterOne(AZ,function(Aa){return AW===Aa.aimp.atid;});}return null;}function n(AV,AZ){var AX=x.filterOne(AV&&AV.afmps,function(Aa){return Aa.fmid===AZ;}),AY=AX&&(AX.sqc?AX:AX.col.oi),AW;if(AY&&AY.sqc){AW={did:AY.sqc.id,n:mstrmojo.string.decodeHtmlString(AY.cln),coldtp:AY.sqc.dt.tp,georole:AY.geo,timerole:AY.tim,der:AY.sqc.der};}else{if(AY){AW={did:AY.did,n:mstrmojo.string.decodeHtmlString(AY.def.cln),coldtp:AY.def.dt.tp,georole:AX.geo,timerole:AY.def.dicl.time,der:AY.def.dicl.der};}}return AW;}function C(AX,AW,AZ){var AY={success:function(Aa){if(Aa&&Aa.msgid){mstrApp.serverRequest({taskId:"qBuilder.GetReportXDADefinition",msgid:Aa.msgid,bindingflag:2,previewflag:261,browsetype:5},AZ);}},failure:function(Aa){mstrApp.onerror(Aa);}};var AV=!!(mstrConfig.resolveOnly||mstrApp.isAppStatePause&&mstrApp.isAppStatePause());mstrApp.serverRequest({taskId:"duplicateReportInstance",datasetID:AW,messageID:AX,skipRebuild:AV},AY);}function I(Aa,Ab,AY){var AW=Aa.srcTableId,Ad=Aa.tgtTableId,AV,AZ,AX=function(Ah,Ag){var Aj="<mpcs><mpc ",Af,Ai;for(Af in Ag){Ai=Ag[Af];Aj+='$ACT="$VAL" '.replace("$ACT",Af).replace("$VAL",Ai);}Aj+="/></mpcs>";return{act:"changeEMMAMapping",tbid:Ah,dsid:Aa.dsid,mapping:Aj};},Ac=function(){var Af=[],Ai={},Ag,Ah;if(!AV||!AZ){return ;}Ai[AW]={};Ai[Ad]={};x.forEach(AV.afmps,function(Am){var Ak=x.find(AZ.afmps,"fmid",Am.fmid),An,Al,Aj;if(Ak>=0){Ag=n(AV,Am.fmid);Ah=n(AZ,Am.fmid);if(Ag.georole!==Ah.georole){Aj=(Ag.georole===0)?AW:Ad;An=(Ag.georole===0)?Ag.did:Ah.did;Al=Ag.georole||Ah.georole;Ai[Aj][An]=a.copy({did:An,georole:Al},Ai[Aj][An]);}if(Ag.timerole!==Ah.timerole){Aj=(Ag.timerole===0)?AW:Ad;An=(Ag.timerole===0)?Ag.did:Ah.did;Al=Ag.timerole||Ah.timerole;Ai[Aj][An]=a.copy({did:An,timerole:Al},Ai[Aj][An]);}if(Ag.der!==Ah.der){Al=Ag.der|Ah.der;Ai[AW][Ag.did]=a.copy({did:Ag.did,drvflg:Al},Ai[AW][Ag.did]);Ai[Ad][Ah.did]=a.copy({did:Ah.did,drvflg:Al},Ai[Ad][Ah.did]);}}});a.forEach(Ai,function(Aj,Ak){a.forEach(Aj,function(Al){Af.push(AX(Ak,Al));});});Ag=n(AV,AV.afmps[0].fmid);Af.push(AX(AW,{did:Ag.did,oid:AZ.aimp.atid}));if(AY){AY(Af);}},Ae=function(Ah){var Ai={success:function(){Ac();}},Ag,Af;AV=U(Ah,AW,Aa.srcId);AZ=U(Ah,Ad,Aa.tgtId);Ag=n(AV,AV.afmps[0].fmid);Af=[AX(AW,{did:Ag.did,oid:AZ.aimp.atid,fg:1})];Ab.getDataService().submitUpdates(Af,Ai);};C(Ab.mid,Aa.dsid,{success:Ae});}function Z(Aa,AX,AW,Ab){var AV=0,AZ=[],AY=function(Ac){var Ad=AW[AV-1];if(Ac&&Ac.tks&&Ad){AZ.push({fid:Ad.fid,fnm:Ad.fnm,ftk:Ac.tks.items});}if(AV===AW.length){Ab(AZ);return ;}Ad=AW[AV++];mstrmojo.ME.MetricDataService.validateMetric({metricId:AX,formID:Ad.fid,objectType:12,tokenStreamXML:"",metricXML:"",msgID:Aa},{success:AY});};AY();}function AI(AV,AW){return{v:V(AV.n)+"@"+V(AW.fnm),tp:275,lv:1,exv:AW.fid,extp:8,oi:{did:AV.did,t:AV.t,n:AV.n}};}function H(AW){var AY=(AW.t===AU.Filter||AW.t===AU.Consolidation),AX=(AW.t===AU.Attribute&&AW.de),AV=(AW.t===AU.Consolidation&&AW.st===N.ConsolidationManaged);return !!(AY&&!AV||AX);}mstrmojo.vi.ui.DatasetUnitMenuUtils=mstrmojo.provide("mstrmojo.vi.ui.DatasetUnitMenuUtils",{getAvailableShortcutMetricFunctionsGroup:function AO(AV){return{"12":[[g.AVG,g.CNT,g.MAX,g.MIN,g.STD,g.SUM,g.VAR]],"4":[[g.SUM,g.AVG,g.MIN,g.MAX,g.CNT],[g.GEM,g.MED,g.MOD,g.PDT,g.STD,g.VAR]]}[AV.t];},isAmongFunctions:function B(AW,AV){return AV.some(function(AX){return AX.some(function(AY){return AY.t===AW;});});},getMultiSelectionShortcutMetricFunctions:function J(AV){var AW=true;x.forEach(AV,function(AX){if(4!==AX.t){AW=false;return false;}return true;});return AW?[g.ADD,g.AVG,g.GST,g.LST,g.TMS]:[];},getRelativeReferenceMenu:function f(AZ,AX,Ac,AV){var AY=0,AW=M[AY],Ab=0,Aa=Ac&&Ac[Ab];return new mstrmojo.ui.menus.EditorConfig({data:{item:AZ,relativeRef:AW,breakBy:Aa},cssClass:"RelativeReference-MenuEditor",contents:[{scriptClass:"mstrmojo.Box",cssClass:"funcBox",children:[{scriptClass:"mstrmojo.Label",visible:AX&&AX.length,text:AX,cssClass:"menu-info-text"},a.copy({cssClass:"RelativeReferencePullDown"},k(M,AY,"relativeRef",function(Ad){return Ad.t;}))]},AD(Ac,Ab,{cssClass:"RelativeReferencePullDown"})],fnOk:function(Ad){return AV(Ad.item,Ad.relativeRef,[Ad.breakBy]);}});},getMovingTotalMenu:function A(Af,AZ,Ab){var Ag=1,AY=AS[Ag].t,Aa=1,AW=mstrmojo.desc(13289,"Starting previous##rows").split("##"),Ae=0,AX=AZ&&AZ[Ae];return new mstrmojo.ui.menus.EditorConfig({cssClass:"MovingTotal-MenuEditor",data:{item:Af,funcType:AY,windowSize:Aa,breakBy:AX},contents:[a.copy({cssClass:"MovingTotalPullDown"},k(AS,Ag,"funcType",function(Ah){return Ah.t;})),{alias:"winSzBox",scriptClass:"mstrmojo.HBox",children:[{scriptClass:"mstrmojo.Label",cssClass:"WinSzPrefix menu-info-text",text:AW[0]},{alias:"winSz",scriptClass:"mstrmojo.ValidationTextBox",required:true,dtp:mstrmojo.expr.DTP.INTEGER,constraints:{trigger:mstrmojo.validation.TRIGGER.ALL,min:1},postCreate:function Ad(){this.set("value",Aa);},_ontooltipover:function(){var Ah=mstrmojo.all[this.id];Ah._hovered=true;Ah.showTooltip();},_ontooltipout:function(){var Ah=mstrmojo.all[this.id];Ah._hovered=false;Ah.hideTooltip();},useRichTooltip:true,tooltipOpenDelay:0,onInvalid:function(){var Ah=this.validationStatus.msg,Ai=!(this.richTooltip&&Ah===this.richTooltip.content);this.richTooltip={posType:mstrmojo.tooltip.POS_BOTTOMLEFT,cssClass:"vi-warning vi-tooltip-V",top:-5,refNode:this.domNode,content:Ah};if(this._hovered&&Ai){this.hideTooltip();this.showTooltip();}},onValid:function(){this.richTooltip=null;this.hideTooltip();},postvalueChange:function Ac(){var Ah=this.isValid();this.parent.parent.popupConfig.data.set("windowSize",Ah?parseInt(this.value,10):0);}},{scriptClass:"mstrmojo.Label",cssClass:"WinSzSuffix menu-info-text",text:AW[1]}]},AD(AZ,Ae,{cssClass:"MovingTotalPullDown BreakByBox"})],bindings:{okEnabled:function(){return !!this.data.windowSize;}},fnOk:function AV(Ah){if(Ab){Ab(Af,Ah.funcType,Ah.windowSize,[Ah.breakBy]);}}});},getRunningTotalMenu:function AN(AY,Ab,AW){var AX=0,AV=c[AX].t,Aa=0,AZ=Ab&&Ab[Aa];return new mstrmojo.ui.menus.EditorConfig({data:{item:AY,func:AV,breakBy:AZ},cssClass:"RunningTotal-MenuEditor",contents:[a.copy({cssClass:"RunningTotalPullDown"},k(c,AX,"func",function(Ac){return Ac.t;})),AD(Ab,Aa,{cssClass:"RunningTotalPullDown BreakByBox"})],fnOk:function(Ac){return AW(Ac.item,Ac.func,[Ac.breakBy]);}});},getRankMetricEditor:function AE(AZ,Ac,AX){var AV=[{n:mstrmojo.desc(1886,"Descending"),v:"0"},{n:mstrmojo.desc(1885,"Ascending"),v:"-1"}],AW=0,AY=AV[AW].v,Ab=0,Aa=Ac&&Ac[Ab];return new mstrmojo.ui.menus.EditorConfig({data:{item:AZ,order:AY,breakBy:Aa},cssClass:"NewRankMetric-MenuEditor",contents:[{scriptClass:"mstrmojo.Box",children:[{scriptClass:"mstrmojo.Label",text:mstrmojo.desc(14612,"Sort:"),cssClass:"menu-info-text"},a.copy({cssClass:"NewRankMetricPullDown"},k(AV,AW,"order"))]},AD(Ac,Ab,{cssClass:"NewRankMetricPullDown"})],fnOk:function(Ad){return AX(Ad.item,Ad.order,[Ad.breakBy]);}});},insertAddUnitToFilterMenu:function G(Aa,AW,AV){var AY=this,AX=mstrmojo.desc(2022,"Add to Filter"),AZ=x.ensureArray(AV).filter(function(Ab){return AY.isValidAddToFP(AW,Ab);});if(AZ.length>0){Aa.addMenuItem(AX,"",function(){AW.addFilterStackSelectors(AZ);});}else{Aa.addDisabledMenuItem(AX,"");}},isValidAddToFP:function O(AW,Ab,Ad){var AX=AW.controller.view.builder,AZ=AX.getLayoutVIMap(AW.getCurrentLayoutKey()),Aa=AZ.getComponent(K.FILTER_STACK),Ac=true;if(!Ad){Ac=(!Aa||x.find(Aa.getFilterDefinitions(),"srcid",Ab.did)===-1);}if(Ac&&Ab.lock){var AY=Ab.fs||[],AV;Ac=false;for(AV=0;AV<AY.length;AV++){if(AY[AV].iidx){Ac=true;break;}}}return Ac;},renameItem:function w(Aa,Ad,AW,AY){var AZ=Aa.mstrmojoId,Ac=mstrmojo.dom.findWidget(Aa);AY=AY||{};if(!AZ){var Ab=mstrmojo.insert({scriptClass:"mstrmojo.EditableLabel",editOnClick:false,editOnTwoClicks:true,text:Ad.n,title:Ad.dsc||"",allowEmptyText:AY.allowEmptyText,allowTrimming:AY.allowTrimming||false,cssClass:AY.cssClass||"",placeholder:Aa,onTextEditComplete:function AV(Ae){if(Ae){return AW(this);}},onmousedown:function AX(Ae){if(this.isEditing){Ae.cancel();}}});if(Ac&&Ac.draggable){Ab.parent=Ac;}Ab.render();AZ=Ab.id;}mstrmojo.all[AZ].set("isEditing",true);return mstrmojo.all[AZ];},getMultipleMetricsCalculationMenus:function m(Ac,AV,Af){var Ab=new mstrmojo.ui.menus.MenuConfig(),Ah=mstrmojo.vi.ui.DatasetUnitMenuUtils.getMultiSelectionShortcutMetricFunctions(Ac),AZ=function(Aj,Ak,Ai){return{dsid:AV,funcType:Ak,funcType2:Ai,items:Aj};};Ab.useTooltip=true;Ah.forEach(function(Ai){Ab.addMenuItem(Ai.n,"",function(){Af(AZ(Ac,Ai.t));});});if(Ac.length===2){var Aa=mstrmojo.mstr.EnumFunction,AY=Aa.FunctionDivide,AW=Aa.FunctionMinus,Ae=Ac[0],Ad=Ac[1],Ag=function(Am,Ak,Ai,Al,Aj){Ab.addMenuItem(Am,"",function(){Af(AZ([Ak,Ai],Al,Aj));});},AX=[{n:function(Aj,Ai){return Aj.n+"/"+Ai.n;},fn:AY},{n:function(Aj,Ai){return Aj.n+"-"+Ai.n;},fn:AW},{n:function(Aj,Ai){return"("+Aj.n+"-"+Ai.n+")/"+Ai.n;},fn:AW,fn2:AY}];AX.forEach(function(Ai){Ab.addSeparator();Ag(Ai.n(Ae,Ad),Ae,Ad,Ai.fn,Ai.fn2);Ag(Ai.n(Ad,Ae),Ad,Ae,Ai.fn,Ai.fn2);});}return Ab;},getCalculationMetricEditor:function L(Ad,Ae,Ac){var AX=[{n:"",css:"operator-plus",funcType:r.FunctionPlus},{n:"",css:"operator-minus",funcType:r.FunctionMinus},{n:"",css:"operator-multiply",funcType:r.FunctionTimes},{n:"",css:"operator-divide",funcType:r.FunctionDivide},{n:!mstrApp.isWSStyling?"%":"",css:"operator-percent-diff",funcType:r.FunctionMinus,funcType2:r.FunctionDivide}],AY={m1:Ae.did,m2:Ad[0].did,operator:r.FunctionPlus,u1:{id:Ae.did,type:4},u2:null},AW=function(Af){return{}.hasOwnProperty.call(Af,"cst");},Ab=function(Af){return typeof Af==="string"&&!!Af.length&&!isNaN(Number(Af));};var AV="this.parent.popupConfig.valid || this.selectedIndex !== -1 || (!!this.selectedNode && this.selectedNode.innerHTML.length === 0)",Aa=function Aa(){var Af=this.parent.popupConfig;if(Af){Af.set("okEnabled",this[this.editableSlot].innerHTML.length!==0);}};return new mstrmojo.ui.menus.EditorConfig({cssClass:"Calculation-MenuEditor",contents:[AP({metrics:Ad,value:AY.m1,propName:"u1",optionValueField:"did",bindings:{valid:AV},postkeyup:Aa}),{scriptClass:"mstrmojo.ButtonListHoriz",items:AX,selectedIndex:0,postselectionChange:function AZ(){this.parent.data.set("operator",this.selectedItem.funcType);this.parent.data.set("operator2",this.selectedItem.funcType2);}},AP({metrics:Ad,value:null,propName:"u2",optionValueField:"did",bindings:{valid:AV},postkeyup:Aa})],data:AY,okEnabled:false,bindings:{valid:function(){var Ah=this.data.u1,Ag=this.data.u2,Ai=this.data.operator;if(!Ah||!Ag||!Ai){return false;}var Af=!(AW(Ah)&&AW(Ag))&&(!AW(Ah)||Ab(Ah.cst))&&(!AW(Ag)||Ab(Ag.cst));this.set("okEnabled",Af);return Af;}},fnOk:function(Af){return Ac(Af.u1,Af.u2,Af.operator,Af.operator2);}});},getCfgForAddUnitFromAllObject:function(AV,AW){var AX=null,AY=null,AZ=[],Aa=function(Ab,Ac){if(!Ac){return false;}return x.find((Ac.att||[]).concat(Ac.mx||[]),"did",Ab.did)>-1;};a.forEach(AW,function(Ac,Ab){if(Ac.idd){AX=Ab;AY=Ac;return false;}return true;});if(!AX){AX="$GUID_141";AZ.push({act:"createDataset",mgo:true,prm:true,name:mstrApp.projectName,idd:true,newObjectIds:[AX]});}x.forEach(AV,function(Ab){if(!Aa(Ab,AY)){AZ.push({act:"addUnitToDataset",dsid:AX,unitId:Ab.did,unitType:Ab.t});}});return{actions:AZ,dsid:AX};},getAggregateByMenu:function q(Aa,AY){var AW=new mstrmojo.ui.menus.MenuConfig(),AX=function(Ae,Ad){var Ag,Af;if(Ad){var Ac=Ae.mexp.args[0];Ag=Ac.did;Af=Ac.t;}else{Ag=Ae.did;Af=Ae.t;}return{did:Ag,t:Af};},AV=this.getAvailableShortcutMetricFunctionsGroup(Aa),Ab=Aa.mexp?Aa.mexp.ft:null,AZ=Aa.mexp&&this.isAmongFunctions(Ab,AV);AV.forEach(function(Ac,Ad){if(Ad!==0){AW.addSeparator();}Ac.forEach(function(Ae){AW.addMenuItem(Ae.n,"",function(){AY(AX(Aa,AZ),Ae.t);});});});return AW;},showObjectPicker:function p(AW,AV){var AX="object_picker";return function(){var AY=mstrmojo.all[AX];if(!AY){AY=new mstrmojo.vi.ui.editors.ObjectPicker({id:AX});if(AV){AY.supportedTypes=x.hash(AV);AY.ob.browsableTypes="8,"+AV.join(",");}AY.render();}else{if(AV){AY.supportedTypes=x.hash(AV);AY.ob.browsableTypes="8,"+AV.join(",");}AY.browse();}AY.OKFn=AW||mstrmojo.emptyFn;AY.open();};},getObjectPicker:function p(){var AV="object_picker";return mstrmojo.all[AV];},generateNumberFormat:function AA(Aa){var AV=W.DefaultFormat.FormattingNumber,AW=W.NumberFormatCategory,AY=Aa||{},AX=AY.nct,AZ=AX===AW.General&&AY.nfs==="General";return{category:(AX===undefined||AZ)?AW.Automatic:AX,decimalPlaces:AY.ndp===undefined?2:AY.ndp,thousandSeparator:AY.nth===undefined?parseInt(AV.ThousandSeparator,10):(AY.nth?-1:0),currencySymbol:AY.ncs||AV.CurrencySymbol,currencyPosition:AY.ncp||AV.CurrencyPosition,format:AY.nfs||"",negativeNumbers:AY.nnn||AV.NegativeNumbers};},getNumberFormatEditor:function AG(AY,AX,AW){var AV=this.generateNumberFormat(AX),AZ=a.clone(AV),Ab=a.clone(AV);return new mstrmojo.ui.menus.EditorConfig({data:AZ,bindings:{okEnabled:function(){return !(this.data.category===Ab.category&&this.data.format===Ab.format);}},cssClass:"NumberFormat-MenuEditor",contents:[{scriptClass:"mstrmojo.vi.ui.NumberFormatter",formatValue:AV,myData:AZ,oldData:Ab,adjustAfterCategoryChange:function(){this.parent.adjustCornersForPopupOverflow();}}],fnOk:function Aa(Ac){if(!(Ac.category===Ab.category&&Ac.format===Ab.format)){return AW(Ac,Ab);}}});},getHighlightElementHandler:function(AX,AW,AV){return function(){D.toggleClass(AW,AV||"open",AX);};},getConfDataTypeMenuCfg:function AK(AV,Aq,Ai,A4){var Az="ToString",Ap="ToNumber",An="ToDateTime",Ah="keepOriginal",AY="Default",A0={ToString:t.DssXmlBaseFormText,ToNumber:t.DssXmlBaseFormNumber,ToDateTime:t.DssXmlBaseFormDate},Ad={ToString:"D1ED29645DEC4DBF99E8E09ED939074B",ToNumber:"399C3EC1041643F1ACE8F2A92B1C1F2F",ToDateTime:"0A558C7295DE42DAA8C5594F1724563F"},Ab="_pattern",A2="_func",Al="_bft",A7="_state",A5={UNCHANGED:0,TO_CREATE:1,TO_UPDATE:2},Aa={n:"Default",v:"Default"},Ax=[{n:"MM-DD-Year",v:"MM-DD-Year"},{n:"MM/DD/Year",v:"MM/DD/Year"},{n:"DD-MM-Year",v:"DD-MM-Year"},{n:"DD/mm/Year",v:"DD/mm/Year"},Aa],AX=[{n:mstrmojo.desc(13772,"Keep Original"),v:Ah},{n:mstrmojo.desc(12276,"String"),v:Az},{n:mstrmojo.desc(2052,"Date"),v:An},{n:mstrmojo.desc(3434,"Number"),v:Ap}];if(mstrApp&&mstrApp.showMultiDataType){AX=[{n:mstrmojo.desc(13772,"Keep Original"),v:Ah},{isSeparator:true,cls:"separator"},{n:mstrmojo.desc(3434,"Number"),v:Ap,bft:t.DssXmlBaseFormNumber},{n:mstrmojo.desc(9920,"Big Decimal"),v:Ap,bft:t.DssXmlBaseFormBigDecimal},{isSeparator:true,cls:"separator"},{n:mstrmojo.desc(2052,"Date"),v:An,bft:t.DssXmlBaseFormDate},{n:mstrmojo.desc(9919,"DateTime"),v:An,bft:t.DssXmlBaseFormDateTime},{n:mstrmojo.desc(2170,"Time"),v:An,bft:t.DssXmlBaseFormTime},{isSeparator:true,cls:"separator"},{n:mstrmojo.desc(3544,"Text"),v:Az,bft:t.DssXmlBaseFormText},{n:mstrmojo.desc(9921,"HTML Tag"),v:Az,bft:t.DssXmlBaseFormHTMLTag},{n:mstrmojo.desc(8984,"Phone Number"),v:Az,bft:t.DssXmlBaseFormPhoneNumber},{n:mstrmojo.desc(4530,"Symbol"),v:Az,bft:t.DssXmlBaseFormSymbol},{n:mstrmojo.desc(9922,"URL"),v:Az,bft:t.DssXmlBaseFormUrl},{n:mstrmojo.desc(4699,"Email"),v:Az,bft:t.DssXmlBaseFormEmail}];}var Ag=a.clone(AX).slice(1),Ao=Aq.fs.filter(function(A9){return Aq.da||A9.obf;}),A8=Ao.length>1,Ak=Ao.length>5,Ac=false,Ay=false,Ar=[],Aw=[{scriptClass:"mstrmojo.Label",text:mstrmojo.desc(13773,"Select Data Type for New Attribute:"),cssClass:"menu-info-text menu-header-text"}],A6={okEnabled:false},A1=function(){var A9=false;Ao.forEach(function(BA){A9=A9||(A6[BA.fnm+A2+A7]!==A5.UNCHANGED)||(A6[BA.fnm+Ab+A7]!==A5.UNCHANGED);});return A9;},As=function(BB,BA){var A9=0;if(BB.da){x.forEach([Az,An,Ap],function(BE,BC){var BD=new RegExp("^\\s*"+BE+"\\s*(<.*>)?\\s*\\((.+)\\)\\s*$","i").exec(BA.f);if(BD&&BD[2]){A9=BC+1;return false;}});}return A9;},Av=function(BB,BA){var A9=0;if(BB.da){var BC=BA&&BA.bftp;x.forEach(AX,function(BE,BD){if(BE.bft===BC){A9=BD;return false;}});}return A9;},Au=function(BB,BA){var BC=AY;if(Aq.da){var A9=new RegExp("^\\s*"+BA+'\\s*<\\s*Pattern\\s*=\\s*"(.+)"\\s*>.*$',"i").exec(BB.f);if(!mstrmojo.string.isEmpty(A9&&A9[1])){BC=A9[1];}}return BC;},At=function(){return Ak?this.parent.parent.parent:(A8?this.parent.parent:this.parent);},Am=function(A9){if(Ak){A9.formList.updateScrollbars();}},AZ=function(BG,BH,BF){var A9=BH.fnm,BC=Ak?BG.formList[BH.fnm+Ab]:BG[BH.fnm+Ab],BD=A8?BC.children[1]:BC,BE=A6[A9+A2],BB=Ac&&(BE===An||BE===Az),BA=BC.visible!==BB;if(BA){BC.set("visible",BB);if(BB){Am(BG);}else{BD.hideTooltip();}}if(BF){BD.set("text",Au(BH,BE));BD.set("items",BE===An?Ax:[Aa]);}},Aj=function(A9){var BA=false;Ao.forEach(function(BB){if(A6[BB.fnm+A2]===An||A6[BB.fnm+A2]===Az){BA=true;return false;}});A9.advancedLabel.set("visible",BA);},AW=function(BB,A9,BC){return{scriptClass:"mstrmojo.ui.Pulldown",isHostedWithin:false,items:BB,alias:BC.fnm+A2,selectedIndex:A9,onPopupWidgetOpened:function(){Am(At.call(this));},onitemSelected:function BA(BH,BF){var BG=At.call(this),BI=BG.data,BJ=BC.fnm,BE=BH.v,BD=function(BK){if(BK){return(BB.length===3?A5.TO_UPDATE:A5.TO_CREATE);}return A5.UNCHANGED;};BI.set(BJ+A2,BE);BI.set(BJ+Ab,Au(BC,BE));BI.set(BJ+Al,BE===Ah?BC.bftp:(BH.bft?BH.bft:A0[BE]));BI.set(BJ+A2+A7,BD(BF!==A9));BI.set("okEnabled",A1());AZ(BG,BC,true);Aj(BG);}};},Af=function(BB,BC,A9){return{scriptClass:"mstrmojo.ui.SearchablePulldown",isHostedWithin:false,alias:BB.fnm+Ab,useRichTooltip:true,visible:A9,allowCustomText:true,allowEmptyText:true,onPopupWidgetOpened:function(){Am(At.call(this));},customizeSearchResult:function(BD){if(x.find(BD,"v","Default")===-1&&this.items.length>0){BD.push(Aa);}},onclick:function(BD){mstrmojo.ui.SearchablePulldown.prototype.onclick.call(this,BD);this.set("isEditing",true);},updateData:function(BF){var BD=At.call(this),BE=BD.data,BG=BB.fnm;BE.set(BG+Ab,BF);BE.set(BG+Ab+A7,BC!==BF?A5.TO_UPDATE:A5.UNCHANGED);BE.set("okEnabled",A1());},onitemSelected:function BA(BD){if(BD){this.updateData(BD.v);}},onkeyup:function(BD){mstrmojo.ui.SearchablePulldown.prototype.onkeyup.call(this,BD);var BE=this[this.editableSlot],BF=BE.innerText||BE.textContent;this.updateData(BF);},updateTooltipConfig:function(BE){this.tooltipOpenDelay=BE?500:0;var BD=Y.position(this.domNode);this.richTooltip={content:mstrmojo.desc(14114,'Pattern determines the formatting for the resulting string of characters. You can use the custom numeric, date, and time formatting symbols. <br/> Example: if pattern is defined as "0,000.00" for "1001", it returns the string "1,001.00"'),posType:mstrmojo.tooltip.POS_TOPLEFT,cssClass:"vi-regular vi-tooltip-C",top:BD.y-2,left:BD.x+BD.w+10};}};},A3=function(BH,BG,A9,BA,BF){var BC=mstrApp&&mstrApp.showMultiDataType?Av(BH,BG):As(BH,BG),BE=Au(BG,AX[BC].v),BB=BG.fnm,BD=AX;if(BC>0){BD=Ag;BC--;}BA[BB+Ab]="";BA[BB+A2]="";BA[BB+Al]="";BA[BB+A2+A7]=BA[BB+Ab+A7]=A5.UNCHANGED;if(BF){A9.push({scriptClass:"mstrmojo.HBox",cssClass:"func-input",alias:BB+A2,children:[{scriptClass:"mstrmojo.Label",text:BB,useRichTooltip:true,updateTooltipConfig:function(BK){this.tooltipOpenDelay=BK?500:0;var BJ=this.domNode;var BI=Y.position(BJ);if(BJ.scrollWidth>BJ.offsetWidth){this.richTooltip={content:BJ.innerText,posType:mstrmojo.tooltip.POS_TOPLEFT,cssClass:"vi-regular vi-tooltip-V",top:BI.y-BI.h-10,left:BI.x-10};}}},a.copy({cssClass:"ConfDataTypePullDown MeContentPullDown HBOXPullDown"},AW(BD,BC,BG,true))]});A9.push({scriptClass:"mstrmojo.HBox",cssClass:"pattern-input",alias:BB+Ab,children:[{scriptClass:"mstrmojo.Label",text:mstrmojo.desc(12078,"Pattern"),cssClass:"menu-info-text"},a.copy({cssClass:"ConfDataTypePullDown MeContentPullDown HBOXPullDown"},Af(BG,BE,true))]});}else{A9.push(a.copy({cssClass:"ConfDataTypePullDown MeContentPullDown"},AW(BD,BC,BG,false)));A9.push(a.copy({cssClass:"ConfDataTypePullDown MeContentPullDown"},Af(BG,BE,false)));}};x.forEach(Aq.fs,function(A9){if(AV.als&&AV.als.links[Aq.did+" "+A9.fid]){Ay=true;return false;}});if(A8){Ao.forEach(function(A9){A3(Aq,A9,Ak?Ar:Aw,A6,true);});}else{A3(Aq,Ao[0],Aw,A6,false);}if(Ak){Aw.push({scriptClass:"mstrmojo.ui.ScrollableContainer",alias:"formList",cssClass:"formList",children:Ar});}Aw.push({scriptClass:"mstrmojo.Label",cssClass:"advancedLabel",alias:"advancedLabel",allowHTML:true,text:"<span>"+mstrmojo.desc(702,"Advanced")+"</span>",onclick:function(){var BA=this.parent,BB,A9,BC=true;Ac=!Ac;D.toggleClass(this.domNode,"expanded",Ac);Ao.forEach(function(BD){AZ(BA,BD,false);BB=Ak?BA.formList[BD.fnm+Ab]:BA[BD.fnm+Ab];A9=A8?BB.children[1]:BB;if(BB.visible&&BC&&!Ak){BC=false;A9.showTooltip();}});}});return new mstrmojo.ui.menus.EditorConfig({data:A6,cssClass:"ConfDataType-MenuEditor",contents:Aw,onOpen:function(){Am(this);},bindings:{okEnabled:"this.data.okEnabled"},fnOk:function Ae(BB){var A9=[],BD=[],BA=false,BC=function(BG,BH,BF){var BJ=[],BI=function(BK){var BL=BK.ftk&&BK.ftk.slice(2,-2);if(!BL){return null;}while((BL.shift()).v!=="("){}return BL;},BE=BI(BF)||[AI(Aq,BF)];BJ.push({v:"!",tp:33,lv:4});if(BG!==Ah){BJ.push({v:BG,oi:{did:Ad[BG],t:11,st:2816,n:BG}});if(!mstrmojo.string.isEmpty(BH)&&BH!==AY&&(BG===An||BG===Az)){BJ.push({v:'<Pattern="'+BH+'">(',tp:"2",lv:1});}else{BJ.push({v:"(",tp:"2",lv:1});}BJ=BJ.concat(BE);BJ.push({v:")",tp:"2",lv:1});}else{BJ=BJ.concat(BE);}BJ.push({v:"",tp:-1,lv:4});return mstrmojo.ME.AttributeEditBox.getTokenStreamXML({items:BJ});};if(Ay){BA=true;}else{Ao.forEach(function(BE){if(BB[BE.fnm+A2+A7]===A5.TO_CREATE){BA=true;return false;}else{if(BB[BE.fnm+A2+A7]===A5.TO_UPDATE||(BB[BE.fnm+Ab+A7]===A5.TO_UPDATE&&(BB[BE.fnm+A2]===An||BB[BE.fnm+A2]===Az))){BD.push(BE);}}});}if(BA){Ao.forEach(function(BE){A9.push({n:BE.fnm,formula:BC(BB[BE.fnm+A2],BB[BE.fnm+Ab],BE),bft:BB[BE.fnm+Al]});});A4(BA,A9);}else{if(Aq.da){Z(AV.mid,Aq.did,BD,function(BE){BE.forEach(function(BF){A9.push({did:BF.fid,formula:BC(BB[BF.fnm+A2],BB[BF.fnm+Ab],BF),bft:BB[BF.fnm+Al]});});A4(BA,A9);});}}}});},getCreateTimeDAEditorCfg:function P(AY,AX){var AV=d(AY);if(!AV){return null;}return new mstrmojo.ui.menus.EditorConfig({data:{okEnabled:false},cssClass:"CreateTimeAttribute-MenuEditor",contents:[{scriptClass:"mstrmojo.ui.CheckList",alias:"time_type",items:[{n:mstrmojo.desc(873,"Year"),v:"Year"},{n:mstrmojo.desc(10051,"Quarter of Year"),v:"QuarterOfYear"},{n:mstrmojo.desc(10050,"Quarter"),v:"Quarter"},{n:mstrmojo.desc(10049,"Month of Year"),v:"MonthOfYear"},{n:mstrmojo.desc(871,"Month"),v:"Month"},{n:mstrmojo.desc(10047,"Week of Year"),v:"WeekOfYear"},{n:mstrmojo.desc(10048,"Week"),v:"Week"},{n:mstrmojo.desc(11608,"Day of Year"),v:"DayOfYear"},{n:mstrmojo.desc(10046,"Day of Month"),v:"DayOfMonth"},{n:mstrmojo.desc(10045,"Day of Week"),v:"DayOfWeek"}],onchange:function AW(){var Aa=false;a.forEach(this.selectedIndices,function(Ab){if(Ab){Aa=true;return false;}});this.parent.data.set("okEnabled",Aa);}}],bindings:{okEnabled:function(){return this.data.okEnabled;}},fnOk:function AZ(Ae,Ac){var Ad=Ac.time_type,Ah=Ad.selectedIndices,Ab=Ad.items,Ag=[],Aa=[],Af=function(Ai,Ak,Am){var Al=[{v:"!",tp:33,lv:4}],Aj;Am.forEach(function(An){if(An===Q){Al.push(AI(Ai,Ak));}else{Aj=AL[An];if(Aj){Al.push({v:Aj,oi:{did:Aj,t:11,st:2816,n:Aj}});}else{Al.push({v:An,tp:"2",lv:1});}}});Al.push({v:"",tp:-1,lv:4});return mstrmojo.ME.AttributeEditBox.getTokenStreamXML({items:Al});};a.forEach(Ah,function(Ai,Aj){if(Ai){Aa=[];a.forEach(AR[Ab[Aj].v],function(Ak,Al){Aa.push({n:Al,formula:Af(AY,AV,Ak),bft:(Al==="DATE"?8:0)});});Ag.push({isTokenStream:true,forms:Aa,name:AY.n+" ("+Ab[Aj].n+")"});}});return AX(Ag);}});},RefreshAndCloseAllObjectBrowserCallback:function(AW,AV){return mstrmojo.func.wrapMethods(AV.getDatasetsUpdateCallback(),{success:function(){if(x.find(AW,"act","createDataset")!==-1){AV.controller.datasetsPanel.set("allObjectBrowserOpened",false);}}});},getUnitFromDataset:function e(AW,AY,AV){var AX=null;a.forEach(AW,function(Aa){var AZ=Aa.att||[];if(AV===4){AZ=Aa.mx||[];}x.forEach(AZ,function(Ab){if(Ab.did===AY){AX=Ab;return false;}});if(AX){return false;}});return AX;},getDatasetFromId:function R(AV,AW){var AX=null;a.forEach(AV,function(AY){if(AY.did===AW){AX=AY;return false;}});return AX;},getDatasetFromAttributeId:function R(AV,AW){var AX=null;a.forEach(AV,function(AY){if(x.find(AY.att,"did",AW)>=0){AX=AY;return false;}});return AX;},getSortedDatasetUnits:function E(AV){var AW=function AW(AX){return AX.t===X.DssTypeMetric?2:1;};AV=AV.concat();AV.sort(function(Aa,AY){if(!Aa||!AY){return true;}var Ab=AW(Aa)-AW(AY),AZ=Aa.n.toUpperCase(),AX=AY.n.toUpperCase();return Ab!==0?Ab:(AZ!==AX?AZ.localeCompare(AX):Aa.n.localeCompare(AY.n));});return AV;},isGeoAttr:function AM(AV,AW){return !!(AV.fs&&(AV.fs instanceof Array)&&AV.fs.length&&AV.fs.some(function(AX){return AX.fgr>0&&(!AW||(AW&&AX.obf));}));},isTimeAttr:function h(AV){return !!(AV.fs&&d(AV));},getUnitCssClass:function(AW){var AV=AW.t;if(this.isGeoAttr(AW,AW.useAvailGeoFmsOnly)){AV+="g";}else{if((AW.dm||AW.um)||AW.da){AV+="d";}else{if(AW.de){AV+="de";}else{if(this.isTimeAttr(AW)){AV+="t";}}}}if((AW.t===AU.Consolidation&&AW.st===N.ConsolidationManaged)||(AW.t===AU.Attribute&&AW.st&&AW.st===N.AttributeRecursive)){AV+=(" st"+AW.st);}if(AW.t===AU.Consolidation&&AW.st===N.ConsolidationManaged&&AW.ndetype===AF.DssRecursiveDerivedElement){AV+=" nde4ra";}return"ic"+AV;},hasMultiForms:function o(AW,AV){return u.getFormsByAttrId(AW,AV).length>1;},getDisplayFormsMenu:function F(Ak,Ai,Ac,Ah){var Ag=[],Aj=[],AZ=[],Ae=[{n:mstrmojo.desc(2411,"Off"),v:0},{n:mstrmojo.desc(2410,"On"),v:1},{n:mstrmojo.desc(8504,"Form Name Only"),v:2},{n:mstrmojo.desc(8505,"Show Attribute Name Once"),v:3},{n:mstrmojo.desc(4531,"Automatic"),v:4}];var Ad=Ai.model.data,AV=Ad.gts,Af;var AY=Ak.t===AU.Consolidation&&Ak.st===N.ConsolidationManaged;x.forEach((AV.row||[]).concat(AV.col||[]),function(Al){if(Al.id===Ak.did){Aj=Aj.concat(Al.fs);}});Af=u.getFormsByAttrId(Ak.attId||Ak.did,Ac);x.forEach(Af||[],function(Am){var An=Am.fid;if(x.find(Ag,"id",An)<0){Ag.push({id:An,n:Am.fnm});var Al=x.find(Aj,"id",An);if(Al>-1){AZ[Ag.length-1]=true;}}});var Aa=[{alias:"fs",scriptClass:"mstrmojo.ui.CheckList",minimumSelectCnt:1,items:Ag,selectedIndices:AZ},{scriptClass:"mstrmojo.Label",text:mstrmojo.desc(11918,"Display attribute form names:"),cssClass:"menu-info-text"},{alias:"longNames",scriptClass:"mstrmojo.ui.Pulldown",items:Ae,isHostedWithin:false,selectedIndex:x.find(Ae,"v",Ad.lnm||0),onitemSelected:function AW(Al){this.v=String(Al.v);}}];if(Ai.getChartStyle&&Ai.getChartStyle()==="NewGraphMatrixVisualizationStyle"){Aa.splice(-2,2);}if(AY){Aa.splice(-2,2);}return new mstrmojo.ui.menus.EditorConfig({cssClass:"displayForms",data:{item:Ak,oldSelected:a.copy(AZ,{})},contents:Aa,okBtnText:mstrmojo.desc(1442,"Ok"),fnOk:function AX(Aq,Au){var Ap=Au.fs,An=Ap.selectedIndices,As=Ap.items,Ay=[],Ar=[],Av=[];if(!Ap.getSelectedItems().length){mstrmojo.alert("Please select at least one form!");return ;}var Am=Aq.oldSelected,Ax=An,Ao,At={},Aw={};for(Ao=0;Ao<As.length;Ao++){if(Am[Ao]&&!Ax[Ao]){At[Ao]=true;}else{if(!Am[Ao]&&Ax[Ao]){Aw[Ao]=true;}}}a.forEach(At,function(Az,A0){if(Az){Ar.push({act:"removeForm",unitId:Ak.did,unitType:Ak.t,attFormId:As[A0].id});}});var Al=Ai.model.data.gts;(Al.row||[]).concat(Al.col||[]).forEach(function(Az){if(Az.id===Ak.did){(Az.fs||[]).forEach(function(A0){if(x.find(Ag,"id",A0.id)<0){Ar.push({act:"removeForm",unitId:Ak.did,unitType:Ak.t,attFormId:A0.id});}});}});a.forEach(Aw,function(Az,A0){if(Az){Ay.push({act:"addForm",unitId:Ak.did,unitType:Ak.t,attFormId:As[A0].id,unitPos:0});}});Av.push({act:"putProperties",prs:"Template Formatting",pr:"LongNames",v:Au.longNames?Au.longNames.v:0});if(Ah){Ah([{act:"updateTemplate",keyContext:Ai.k,partialRetrieval:{nodes:[Ai.k]},actions:Ar.concat(Ay).concat(Av)}]);}},onOpen:function Ab(){this.fs.updateScrollbars();}});},getAttributeLinkMenu:function j(Ah,Ak,Af,Aj,Aa){var Al=-2147483648,Ac=Aj.datasets,Ad=Ac[Af],Ai=Ad.tables||[],AV={},Ae=[],AY=(Ak.fs&&Ak.fs[0])||{},Ag=[],Ab=779,AX=Ak.art>1,AW=!AX&&a.keyarray(Ac).length>1,AZ=function(){mstrmojo.vi.ui.editors.AttributeLinkEditor.open({attribute:Ak,docModel:Aj,datasetId:Af});};if((Ad.st!==Ab)||Ai.length<=1||Ak.da){if(AW){Ah.addMenuItem(mstrmojo.desc(11941,"Link to Other Dataset..."),"",AZ);}return ;}x.forEach(Ad.att,function(Ao){var Ap=true,An=null,Am=(Ao.fs&&Ao.fs[0])||{};if(Ao.da){return ;}if(AY.der===Al||Am.der===Al||AY.fgr===-1||Am.fgr===-1||AY.ftr===-1||Am.ftr===-1){return ;}if(AY.fgr&&Am.fgr&&AY.fgr!==Am.fgr){return ;}if(AY.ftr&&Am.ftr&&AY.ftr!==Am.ftr){return ;}x.forEach(Ai,function(Aq){var Ar=x.find(Aq.attRefs,"did",Ak.did),As=x.find(Aq.attRefs,"did",Ao.did);if(Ar>=0&&x.indexOf(Ae,Aq.did)<0){Ae.push(Aq.did);}if(As>=0){An=Aq.did;}if(Ar>=0&&As>=0){Ap=false;}});if(Ap&&!Ao.hide){AV[Ao.did]=An;Ag.push(Ao);}});if(Ag.length>0&&Ad.hcs!==true&&!Aj.isSparkDataset(Ad)){Ah.addEditorMenuItem(mstrmojo.desc(13172,"Map Attributes"),"",function(){return new mstrmojo.ui.menus.EditorConfig({data:{},cssClass:"mapAttribute",okVisible:false,cancelVisible:false,contents:[{scriptClass:"mstrmojo.ui.ScrollableContainer",children:[{scriptClass:"mstrmojo.vi.ui.InteractiveUnitList",draggable:false,CLS_HAS_MENU:"",items:Ag,listHooks:{select:function Am(An,Ao){Aj.warnForEditStandaloneDS(Ad,function(){x.forEach(Ae,function(Ap){I({dsid:Af,srcId:Ak.did,srcTableId:Ap,tgtId:Ao.did,tgtTableId:AV[Ao.did]},Aj,Aa);});});}}}]}]});});}if(AW){Ah.addMenuItem(mstrmojo.desc(11941,"Link to Other Dataset..."),"",AZ);}},isDocumentLevelItem:function z(AV){return AV&&(AV.um||AV.da||(AV.t===AU.Consolidation&&AV.st===N.ConsolidationManaged));},isLegalObjectName:function S(AV){var AW=/["\[\]\\]/g;if(AV.match(AW)){return false;}return true;},validateName:function l(AW,AX,AV){if(this.isLegalObjectName(AW)){AX();}else{mstrmojo.alert(mstrmojo.desc(8622,"The # cannot contain the reserved characters ##.").replace("##","'[', ']', '\"' and '\\'").replace("#",mstrmojo.desc(945,"Name")),AV,mstrmojo.desc(1388,"Rename"));}},hasCGorCon:function AT(AV){return AV.att.some(function(AW){return H(AW);});},isCGorCon:function AJ(AV,AX){var AW=x.filterOne(AX&&AX.att,function(AY){return AY.did===AV.did;});return H(AW||AV);},hasOldDEOverDatasets:function(AY,AX){var AW=false,AV;a.forEach(AX,function(AZ){AV=x.find((AZ.att||[]),"did",AY);if(AV!==-1&&AZ.att[AV].de){AW=true;return false;}});return AW;},getMarkGeoRoleEditorCfg:function AQ(AV,A7,Ap,Am,BG,BI){var Al=268435456,BD=536870912,Aa=1073741824,Az=268435456,BA=805306368,A5=805306368,At=1879048192,BH=-2147483648,A8=0,A9=1,Ac=2,Ak=3,Ao=4,Ai=5,BF=6,Af=7,Ar=8,Aq=9,A1=10,AY=2,Ay=3,A6={v:A8,n:mstrmojo.desc(2057,"None")},BJ={v:Ak,n:mstrmojo.desc(7674,"Country"),der:Al},A4={v:Ac,n:mstrmojo.desc(7676,"State"),parents:[BJ],der:BD},Ag={v:Aq,n:mstrmojo.desc(12919,"County"),parents:[BJ,A4]},BB={v:A9,n:mstrmojo.desc(7675,"City"),parents:[BJ,A4],der:Aa},Au={v:Ar,n:mstrmojo.desc(7677,"Zip Code"),parents:[BJ,A4,BB]},An={v:Ai,n:mstrmojo.desc(7696,"Latitude")},A2={v:BF,n:mstrmojo.desc(7697,"Longitude")},Aj={v:Ao,n:mstrmojo.desc(7675,"City")+", "+mstrmojo.desc(7676,"State")},Ax={v:A1,n:mstrmojo.desc(12973,"Area Code")},A0={v:Af,n:mstrmojo.desc(2056,"Custom")},Ah={ID:[A6,BJ,A4,Ag,BB,Au,An,A2,Aj,Ax,A0],ID_NUMERIC:[A6,Au,Ax,An,A2],NON_ID:[A6,BJ,A4,Ag,BB,Au,Aj,Ax,A0],NON_ID_NUMERIC:[A6,Au,Ax]},Av=x.filter(A7.fs,function(BK){return(BK.bftp===AY||BK.bftp===Ay)&&BK.der!==BH;});var A3=(Av.length>1),AX=x.find(Av,"idf",true),AZ=(AX===-1?0:AX),Aw=Av[AZ],Ae,AW,As,Ab=[],Ad=function(BK){var BL=(BK.idf?"ID":"NON_ID")+(BK.bftp===AY?"_NUMERIC":"");return Ah[BL];},BE=function(BL,BK){return x.find(Ad(BK),"v",BL);};if(Av.length===0||x.find(A7.fs,"fgr",-1)!==-1||Aw.der===BH){return null;}x.forEach(Av,function(BM,BK){var BL=a.clone(BM);BL.n=BL.fnm;Ab.push(BL);if(BM.fgr){Aw=BL;AZ=BK;}});Ae=Aw.fid;As=Aw.fgr||0;AW=BE(As,Aw);return new mstrmojo.ui.menus.EditorConfig({data:{item:A7,geoForm:Aw,geoRole:As},cssClass:"MarkGeoRole-MenuEditor",contents:[{scriptClass:"mstrmojo.Label",text:mstrmojo.desc(13522,"Select Attribute Form:"),visible:A3},{scriptClass:"mstrmojo.ui.Pulldown",isHostedWithin:false,cssClass:"MarkGeoRolePullDown",items:Ab,selectedIndex:AZ,alias:"formList",visible:A3,onitemSelected:function BC(BM){var BK=this.parent.data,BL=this.parent.geoRoleList;if(BK.geoForm.fid!==BM.fid){BK.set("geoForm",BM);BK.set("geoRole",BM.fgr);BL.set("items",Ad(BM));BL.set("selectedIndex",BE(BM.fgr,BM));}}},{scriptClass:"mstrmojo.ToolSeparator",visible:A3,markupMethods:{onvisibleChange:mstrmojo.Widget.visibleMarkupMethod}},{scriptClass:"mstrmojo.Label",text:mstrmojo.desc(13523,"Select Geographic Type:"),cssClass:"menu-info-text"},{scriptClass:"mstrmojo.ui.Pulldown",isHostedWithin:false,cssClass:"MarkGeoRolePullDown",items:Ad(Aw),selectedIndex:AW,alias:"geoRoleList",onitemSelected:function BC(BQ){var BP=this.parent,BK=BP.data,BR=BP.geoDrvList;var BM=[],BO=[],BL=Aw.der,BN;BK.set("geoRole",BQ.v);x.forEach(BQ.parents,function(BS,BT){BN=BS;BM.push({n:BN.n,der:BN.der});if((BL&BN.der)!==0){BO[BT]=true;}});BR.set("items",BM);BR.set("selectedIndices",BO);x.forEach(["geoDrvSeparator","geoDrvLabel","geoDrvList"],function(BS){BP[BS].set("visible",BM.length>0);});if(BP.adjustCornersForPopupOverflow){BP.adjustCornersForPopupOverflow();}}},{scriptClass:"mstrmojo.ToolSeparator",markupMethods:{onvisibleChange:mstrmojo.Widget.visibleMarkupMethod},alias:"geoDrvSeparator"},{scriptClass:"mstrmojo.Label",text:mstrmojo.desc(13524,"(Optional) Create Additional Attributes:"),alias:"geoDrvLabel",cssClass:"menu-info-text"},{scriptClass:"mstrmojo.ui.CheckList",alias:"geoDrvList"}],fnOk:function(BP,BO){var BL=function(BW){var BV=function(Ba){var Bb="<mpcs>";x.forEach(Ba,function(Bc){Bb+='<mpc did="'+Bc.did+'" n="'+Bc.n+'" georole="'+Bc.georole+'" drvflg="'+Bc.drvflg+'" />';});Bb+="</mpcs>";return Bb;},BR=function(Ba,Bc,Be,Bb){var Bd=function(Bi,Bf,Bh){var Bg=U(BW,Bi,Bf),Bj=n(Bg,Bh);return Bj&&Bj.did;};BG.forEach(function(Bf,Bg){var Bh=Bd(Bf.did,A7.did,Bc.fid);if(Bh){Ba[Bg]=Ba[Bg]||[];Ba[Bg].push({did:Bh,n:Bc.fnm,georole:Be,drvflg:Bb});}});},BT=[],BZ=[],BX=BO.geoDrvList,BS=0,BU=false,BY={2:Az,1:BA,9:A5,8:At}[BP.geoRole]||0;a.forEach(BX.selectedIndices,function(Bb,Ba){if(Bb){BS|=BX.items[Ba].der;}});BS&=BY;if(Aw.fgr!==BP.geoRole||Aw.fid!==BP.geoForm.fid||Aw.der!==BS){if(A3&&Aw.fid!==BP.geoForm.fid){if(Aw.fgr!==A8){BR(BZ,Aw,A8,0);if(Aw.der>0){BU=true;}}}if(BP.geoForm.fgr!==BP.geoRole||BP.geoForm.der!==BS){BR(BZ,BP.geoForm,BP.geoRole,BS);if((BS&BP.geoForm.der)!==BP.geoForm.der){BU=true;}}if(BZ.length>0){BZ.forEach(function(Bb,Ba){BT.push({act:"changeEMMAMapping",dsid:Ap,tbid:BG[Ba].did,mapping:BV(Bb)});});BI(BT,BU);}}},BM=function(){C(AV.mid,Ap,{success:BL});};var BN=mstrApp.isAppStatePause();if(!Am||BN){var BQ,BK=BN?mstrmojo.desc(212,"Continue"):mstrmojo.desc(219,"Yes");if(Am){BQ=mstrmojo.desc(16237,"The operation requires the dataset to be unloaded from memory. It will be automatically reloaded when you resume data retrieval. Do you want to continue?");}else{BQ=BN?mstrmojo.desc(16236,"The operation requires modifying the dataset and unloading it from memory. It will be automatically reloaded when you resume data retrieval, however the change will also affect other reports, documents, and dossiers that share the dataset. Do you want to continue?"):mstrmojo.desc(15493,"Modifications to this dataset will affect other reports, documents, and dossiers that share the dataset. Do you want to continue?");}mstrmojo.warn(BQ,{},{buttons:[AB(BK,function(){BM();},true,{cssText:"min-Width: 60px"}),AB(mstrmojo.desc(221,"Cancel"),function(){})]});}else{BM();}}});}});}());(function(){mstrmojo.requiresCls("mstrmojo.Obj","mstrmojo.css","mstrmojo.AjaxCall","mstrmojo.hash","mstrmojo.array","mstrmojo.expr","mstrmojo.Label","mstrmojo.ListBase","mstrmojo.ui.CheckList","mstrmojo.ui.ColumnContainer","mstrmojo.rw.ConditionWalkProviderBase","mstrmojo.elementHelper");var G=mstrmojo.css,X=mstrmojo.hash,t=mstrmojo.array,W=mstrmojo.expr,M=W.ET,Z=W.ET2TGT,Y=W.FN,S=W.FN_MRP,n=W.DTP2FN_DTP,E=mstrmojo.meta.TP,AC=W.TP,J=W.STP,l=mstrmojo.elementHelper,q=mstrmojo.rw.ConditionWalkProviderBase;var P={};P[M.AQ]={target:1,fm:1,fn:1,c0:1,c1:1};P[M.AL]={target:1,fm:1,fn:1,c0:1};P[M.AE]={target:1,fm:1,es:1};P[M.AC]={target:1,fm:1,fm2:1,fm3:1,fn:1,c0:1,c1:1};P[M.MQ]={target:1,fn:1,c0:1,c1:1,dmy:1};P[M.MC]=P[M.MQ];P["*"]={target:1};var x={};x[M.MQ]={key:"metricFns",def:W.METRIC_FNS};x[M.MC]={key:"metricFns",def:W.METRIC_FNS};x[M.AQ]={key:"formFns",def:W.FORM_FNS};x[M.AL]={key:"formFns",def:W.FORM_FNS};x[M.AC]={key:"formFns",def:W.FORM_FNS};x[M.AE]={key:"elemFns",def:W.ELEM_FNS};var AH=mstrmojo.desc(14084,"Select a filter option or a qualification."),AG=mstrmojo.desc(15007,"Choose to select in list or qualify on an attribute form."),AF=mstrmojo.desc(14085,"Select one or more elements."),N=mstrmojo.desc(15009,"Select element(s)."),AE=mstrmojo.desc(14086,"Select an operator."),AD=mstrmojo.desc(14087,"Enter a value or select an attribute from the list."),C=mstrmojo.desc(15010,"Enter a specific value or select an attribute form as variable."),AB=mstrmojo.desc(14088,"Select an attribute form. When done, click ## button.").replace("##",'"√"'),AA=mstrmojo.desc(14089,"Select a condition."),AJ=mstrmojo.desc(15011,"Select an operator."),z=mstrmojo.desc(14090,"Enter a value or select a metric from the list."),R=mstrmojo.desc(15012,"Enter a specific value or select a metric as variable.");var k=0,r=1;var H=mstrmojo.ui.ColumnContainer.prototype.updateColumnContainer;var e="dummy",I={did:"idErr",v:"idErr",n:mstrmojo.desc(7929,"Error loading data."),t:e,css:"unselectable"},p={did:"idWait",v:"idWait",n:mstrmojo.desc(2901,"Loading..."),t:e,css:"unselectable"},AI={did:"idSelect",v:"idSelect",n:mstrmojo.desc(547,"Select"),t:e,css:"unselectable"},w={did:"idWait",v:"idQualification",n:mstrmojo.desc(5225,"Qualification"),t:e,css:"unselectable"},D={did:"idWait",v:"idQualification",n:mstrmojo.desc(15008,"Qualify on"),t:e,css:"unselectable"};var b=q.onWalkChange,F=q.replaceItem,L=q.getChildJSON,u=q.walkChildPostCreateFn,o=q.updateList,AN=q.fnItem,AM=q.isComparisonAllowed,h=q.cstJson,f=q.fmJson,d=q.updateListMulti,m=q.updateListMultiData;function j(AO){return AO.targets?t.filter(AO.targets,function(AP){return AP[E]===W.TP.ATTR;}):[];}function K(AO){this.tip.set("text",AO);}var V=[W.STP.PROMPT,W.STP.PROMPT_OBJECTS,W.STP.PROMPT_ELEMENTS,W.STP.PROMPT_EXPRESSION,W.STP.PROMPT_EXPRESSION_DRAFT];var AL=q.allowedTargetTypes;mstrmojo.rw.ConditionWalkProvider=mstrmojo.declare(mstrmojo.rw.ConditionWalkProviderBase,null,{scriptClass:"mstrmojo.rw.ConditionWalkProvider",browseEs:function c(AR,AQ,AT){AR.openPopup("eb",{zIndex:AR.parent.zIndex+10,left:Math.round(AT.x)+"px",top:Math.round(AT.y)+"px"});var AP=AR.eb.browser,AO=AR.model,AS=AO&&AO.a&&AO.a.did;if(!AS){return ;}AP.set("attributeID",AS);AP.set("selectedItems",AO.es?X.clone(AO.es):[]);AP.initBrowser();},browseObjs:function AK(AV,AO,AP){AV.openPopup("ob",{zIndex:AV.parent.zIndex+10,left:Math.round(AP.x)+"px",top:Math.round(AP.y)+"px"});var AQ=AV.ob.browser;AQ.target=AO;var AR;switch(AO.alias){case"dmy":AR=[W.TP.ATTR,W.TP.DIM];break;case"c0":case"c1":var AT=AV.model,AS=AT&&AT.et,AW=AT&&AT.fm,AU=AW&&AW.dtp||(AT.m?W.DTP.DECIMAL:W.DTP.UNKNOWN);AR=(AS===M.MQ||AS===M.MC)?[W.TP.METRIC,W.DTP2PROMPT_STP[AU]]:[W.TP.ATTR,W.DTP2PROMPT_STP[AU]];break;default:AR=AL(AV.ets);AR=AR?X.keyarray(AR,true):[W.TP.ATTR,W.TP.METRIC,W.STP.REPORT_GRID,W.STP.REPORT_GRAPH,W.STP.REPORT_ENGINE,W.STP.REPORT_TEXT,W.STP.REPORT_DATAMART,W.STP.REPORT_BASE,W.STP.REPORT_GRIDGRAPH,W.STP.REPORT_NONINTERACTIVE,W.STP.FILTER].concat(V);}AR[AR.length]=W.TP.FOLDER;AQ.browse({rootFolderType:AT&&(AT.et===M.MQ||AT.et===M.MC)?5:26,folderLinksContextId:33,onSelectCB:[AV,"onOBSelect"],browsableTypes:AR.join(",")});},getFm2NodeProps:function U(){return{alias:"fm2",children:[f({alias:"fm2",fmPost:2})],updateColumnContainer:function AO(){var AP=this.parent.parent;if(this.domNode){G.addClass(this.domNode,"lastStage");}this.fm2.update();K.call(AP,AB);H.call(this);}};},getC0NodeProps:function Q(){var AO=this;return{alias:"c0",c1Selected:false,children:[{scriptClass:"mstrmojo.Label",cssClass:"baseOn",text:mstrmojo.desc(527,"Value")},h({alias:"c0",cstIndex:0}),{scriptClass:"mstrmojo.Label",alias:"btwn",cssClass:"btwn",text:mstrmojo.desc(308,"and"),visible:false},h({alias:"c1",cstIndex:1,visible:false}),{alias:"browseLink",scriptClass:"mstrmojo.Label",cssClass:"mstrmojo-walkstep-browse",text:mstrmojo.desc(7926,"Browse..."),onclick:function(){this.parent.parent.parent.browse(this.parent.c0);},visible:false}],updateColumnContainer:function AP(){this.c0.update();var AZ=this.parent,AV=AZ.parent,AU=AZ.parent.model,AX=AU&&AU.fn,AR=AX===Y.BETWEEN||AX===Y.NOT_BETWEEN||AX===S.BETWEEN||AX===S.BETWEEN_DESCENDING,AW=AX===Y.EQUAL||AX===Y.NOT_EQUAL||AX===Y.GREATER||AX===Y.GREATER_EQUAL||AX===Y.LESS||AX===Y.LESS_EQUAL,AY=this.idx,AT=this.next;this.browseLink.set("visible",AV.objectBrowsingEnabled&&AM(AU,AV.ets));this.btwn.set("visible",AR);this.c1.set("visible",AR);if(AR){this.c1.update();}else{AU.edit("c1",{v:null,dtp:null,skipET:true},true);}if(AU.a2&&AW){if(!(AT&&AT.fm2)){AZ.insertAndRemoveTrailing(AY,AO.getFm2NodeProps());}}else{AZ.removeTrailingContainer(AY);}var AS=mstrApp.isWSStyling?C:AD,AQ=mstrApp.isWSStyling?R:z;K.call(AV,AU.a?AS:AU.m?AQ:"");if((!AU.a)&&AU.m&&this.domNode){G.addClass(this.domNode,"lastStage");}H.call(this);}};},getFnNodeProps:function a(){var AO=this;return{alias:"fn",children:[{scriptClass:"mstrmojo.Label",cssClass:"baseOn",text:mstrApp.isWSStyling?mstrmojo.desc(15006,"Operator"):mstrmojo.desc(9579,"Condition")},f({alias:"fn",allowUnlistedValues:false,update:function(){var AV=this.parent.parent.parent,AR=AV.model||{},AW=AR.et,AU,AX=false,AY,AQ;switch(AW){case M.AE:AX=!!AR.a;break;case M.AQ:case M.AC:case M.AL:AX=!!(AR.fm&&AR.fm.did);AU=AX?AR.fm.dtp:null;break;case M.MQ:case M.MC:AX=!!AR.m;AU=AX?W.METRIC_DTP:null;break;}if(AX){var AZ=n[AU];if((this.lastEt!==AW)||(this.lastFnDtp!==AZ)){this.lastEt=AW;this.lastFnDtp=AZ;var AT=AW?x[AW]:null,AS=AT&&AT.key;AY=(AS&&AV[AS])||AT.def||[];if(typeof (AY)==="object"){AY=AY[AZ]||AY["*"];}}AQ=AN(AR.fn,AR.fnt||1);}o(this,AX,AY,AQ);this.parent.updateScrollbars();}})],updateColumnContainer:function AP(){this.fn.update();var AQ=this.parent,AR=AQ.parent,AS=AR.model,AU=AS&&AS.fn,AT=this.next,AW=AU===Y.IS_NULL||AU===Y.IS_NOT_NULL;if(AU&&AW){AQ.removeTrailingContainer(this.idx);}else{if(AU&&!(AT&&AT.c0)){AQ.insertAndRemoveTrailing(this.idx,AO.getC0NodeProps());}}var AV=mstrApp.isWSStyling?AJ:AA;K.call(AR,AS.a?AE:AS.m?AV:"");AT=this.next;if(AT){AT.updateColumnContainer();}}};},getEsNodeProps:function B(){var AQ=[{scriptClass:"mstrmojo.ui.CheckList",alias:"es",itemIdField:"v",allowUnlistedValues:true,insertUnlistedValuesAt:0,selectionPolicy:"toggle",postCreate:function AP(){u.apply(this,[]);this.ajx=mstrmojo.insert({parent:this,scriptClass:"mstrmojo.AjaxCall",isTask:true,params:{taskId:"browseElements",attributeID:null,styleName:"MojoAttributeStyle",blockBegin:1,blockCount:mstrApp.elementsBlockCount||30},onsuccess:function(){var Ab=this.parent,AV=this.response;if((AV&&AV.did)!==Ab.lastAttrId){return ;}var AX=(AV&&AV.es)?t.filter(AV.es,function(Ac){return !l.isNullElem(Ac.v);}):[],Aa=Ab.parent.parent.parent.model&&Ab.parent.parent.parent.model.es,AY=function(Ai,Ad){var Ah=Ai&&Ai.length||0,Ag=Ad&&Ad.length||0,Ac=[],Af,Ae;for(Af=0;Af<Ag;Af++){for(Ae=0;Ae<Ah;Ae++){if(Ad[Af].n===Ai[Ae].n){break;}}if(Ae===Ah){Ac.push(Ad[Af]);}}return Ac;},AZ=function(Ac,Ad,Ag){var Af=[],Ae;t.forEach(Ac,function(Ah){Ae=t.filterOne(Ad,function(Ai){return Ah[Ag]&&Ai[Ag]&&Ah[Ag]===Ai[Ag];});if(Ae){Af.push(Ae);}});return Af.length===Ac.length?Af:Ac;};Aa=Aa&&AZ(Aa,AX,"v");if(Ab.allowUnlistedValues){var AW=AY(AX,Aa);AX=(Ab.insertUnlistedValuesAt===0)?AW.concat(AX):AX.concat(AW);}m(Ab,AX,Aa,null);Ab.parent.updateScrollbars();},onerr:function(){F(this.parent,p,[I]);}});},onselectionChange:function AT(AV){mstrmojo.ListBase.prototype.onselectionChange.call(this,AV);b.call(this,AV);},update:function AS(){var AY=this.parent.parent.parent,AX=AY.model,Ac=AX&&AX.a,Ad=!!Ac&&!Ac.ilk,Ae,AV,Ab,AZ,AW,Af;if(Ad){if(this.lastAttrId!==Ac.did){this.lastAttrId=Ac.did;Ae=AX.es;AZ=Ae&&Ae.length;Ae=AZ?Ae.concat():[];Ae.push(p);if(AZ){Ab=[];for(AW=1;AW<=AZ;AW++){Ab[AW]=AW;}}Af=this.ajx;AY.updateBrowseElementsParams(Af.params,Ac);}else{AV=AX.es;}}d(this,Ad,Ae,AV,Ab);if(Ad&&Af){if(AY.getElements){var Aa=this;AY.getElements(Ac,{success:function(Ag){m(Aa,Ag.es||[],AY.model&&AY.model.es,null);Aa.parent.updateScrollbars();},failure:function(){F(Aa,p,[I]);}});}else{Af.send();}}},setupScrollNodes:function AR(){this.scrollNode=null;}}];if(!mstrApp.isSingleTier){AQ.splice(0,0,{scriptClass:"mstrmojo.Label",cssClass:"mstrmojo-walkstep-browse",text:mstrmojo.desc(7928,"Browse elements..."),onclick:function AO(){this.parent.parent.parent.browse(this.parent.es);}});}return{alias:"es",children:AQ,updateList:function(AV){d(this.es,true,AV,this.parent.parent.model.es,null);this.updateScrollbars();},updateColumnContainer:function AU(){var AV=this.parent.parent;if(this.domNode){G.addClass(this.domNode,"lastStage");}this.es.update();K.call(AV,mstrApp.isWSStyling?N:AF);}};},getFmNodeProps:function O(){var AO=this;return{alias:"fm",children:[f({alias:"fm",fmPost:"",filter:false,isFirstFm:true})],updateColumnContainer:function AP(){this.fm.update();var AZ=this.parent,AU=AZ.parent,AT=AU.model,AW=AT&&AT.fm,AY=this.idx,AX=AT&&AT.a,AR=AU.disableElementsBrowsing,AQ=AX&&AR&&AR(AX);var AV=(AT.etWas&&AT.etWas===M.AE)?r:k,AS=k;if(AT.et===M.AE&&!AQ){AS=r;}if(AV!==AS||AS===k){AZ.removeTrailingContainer(AY);if(AS===k&&AW){AZ.addNextColumn(AO.getFnNodeProps());}else{if(AS===r){AZ.addNextColumn(AO.getEsNodeProps());}}}K.call(AU,mstrApp.isWSStyling?AG:AH);H.call(this);}};},getTargetNodeProps:function g(){var AO=this;return{alias:"target",target:null,browseLink:null,children:[{scriptClass:"mstrmojo.Label",cssClass:"baseOn",text:mstrmojo.desc(11859,"Based On")},L({alias:"target",insertUnlistedValuesAt:0,makeObservable:true,hideIfEmpty:true,postCreate:function(){this._super();this.parent.parent.parent.attachEventListener("updateTargets",this.id,function(){this.update();});},onObjBrowsed:function(AR){if(AR.st===J.FILTER||AR.t===AC.REPORT||AR.t===AC.PROMPT){this.parent.parent.parent.onOK();}},update:function AQ(){var AS=this.parent.parent.parent,AT=AS.model,AW=AS.targetsLastMod,AX=AT&&AT.et;if(this.lastModel!==AT||this.targetsLastMod!==AW){this.lastModel=AT;this.targetsLastMod=AW;var AR=AS.targets,AY=AS.ets;if(AY&&AR&&AR.length){var AV=AL(AS.ets);AR=t.filter(AR,function(AZ){return AV[AZ[E]];});}var AU=AT&&AT[Z[AX]];o(this,true,W.getSortedObjectsByTypeGroup(AR),AU);this.parent.updateScrollbars();}}}),{alias:"browseLink",scriptClass:"mstrmojo.Label",cssClass:"mstrmojo-walkstep-browse",text:mstrmojo.desc(7926,"Browse..."),onclick:function(){this.parent.parent.parent.browse(this.parent.target);}}],updateColumnContainer:function AP(){this.target.update();var AS=this.parent,AT=AS.parent,AU=AT.model,AW=AU&&AU.et,AR=this.idx,AV=this.next;this.browseLink.set("visible",AT.objectBrowsingEnabled);if(AW){switch(AW){case M.AQ:case M.AL:case M.AC:case M.AE:if(AU.a&&!(AV&&AV.fm)){this.parent.insertAndRemoveTrailing(AR,AO.getFmNodeProps());}break;case M.MQ:case M.MC:if(AU.m&&!(AV&&AV.fn)){this.parent.insertAndRemoveTrailing(AR,AO.getFnNodeProps());}break;case M.R:case M.F:case M.XML:this.parent.removeTrailingContainer(AR);break;}}AV=this.next;if(AV){AV.updateColumnContainer();}}};}});var A=mstrmojo.rw.ConditionWalkProvider;A.setTip=K;}());(function(){mstrmojo.requiresCls("mstrmojo.array","mstrmojo.dom","mstrmojo.expr","mstrmojo.hash","mstrmojo.Container","mstrmojo._HasLayout","mstrmojo._HasPopup","mstrmojo.ui.ColumnWalk","mstrmojo.Button","mstrmojo.mstr.EnumNodeDimty","mstrmojo.ConditionModel","mstrmojo.rw.ConditionWalkProvider");var S=mstrmojo.Widget,J=mstrmojo.array,F=mstrmojo.dom,O=mstrmojo.hash,A=mstrmojo.mstr.EnumNodeDimty,K=mstrmojo.rw.ConditionWalkProvider.setTip,Q=mstrmojo.expr,I=Q.ET;var C=mstrmojo.desc(11899,"Select a dataset object.");var M=J.hash([A.NodeDimtyOutputLevel]);function E(){var X=this.model;if(X){if(!X.attachEventListener){O.make(X,mstrmojo.ConditionModel,{});}X.attachEventListener("edit",this.id,"onmodeledit");}}function N(Y,X){if(X&&X.detachEventListener){X.detachEventListener("edit",Y.id,"onmodeledit");}}function P(c,X){var a=X,b=[],Z=[],Y=[],d=false;O.forEach(a,function(e){b=b.concat(e.att.filter(function(f){return f.did===c;}));});d=b[0]&&b[0].da;b.forEach(function(e){Z=Z.concat(e.fs||[]);});Z.forEach(function(e){if((e.obf||d)&&Y.filter(function(f){return f.did===e.fid;}).length===0){Y.push({did:e.fid,dtp:mstrmojo.expr.mapBaseFormTypeToDataType(e.bftp),n:e.fnm,t:e.t,isbf:e.isbf});}});return Y;}function D(c,X){var Y,a=X,b,Z=false;if(typeof microstrategy!=="undefined"){a=a||microstrategy.bones.rwb_viewer.datasetInfos;}O.forEach(a,function(d){Y=d.mx;O.forEach(Y,function(e){if(e.did===c){b=d;Z=e.um||e.rdm;return false;}});return !b;});return Z&&b&&b.isMDX;}mstrmojo.rw.ConditionWalk=mstrmojo.declare(mstrmojo.Container,[mstrmojo._HasLayout,mstrmojo._HasPopup],{scriptClass:"mstrmojo.rw.ConditionWalk",markupString:'<div class="mstrmojo-rw-ConditionWalk" mstrAttach:click><div class="condition mstrmojo-ConditionNode"><div class="mstrmojo-cond-contents"></div></div><div class="walk"></div><div class="apply"></div></div>',markupSlots:{conditionNode:function(){return this.domNode.firstChild;},walkNode:function(){return this.domNode.children[1];},applyNode:function(){return this.domNode.lastChild;}},markupMethods:{onvisibleChange:function L(){S.visibleMarkupMethod.call(this);if(this.visible){this.initWalk();}},onheightChange:S.heightMarkupMethod,onwidthChange:S.widthMarkupMethod},layoutConfig:{h:{conditionNode:"auto",walkNode:"100%",applyNode:"auto"},xt:true},editor:undefined,columnWalk:undefined,tip:undefined,walkProvider:null,objectBrowsingEnabled:true,postCreate:function B(){if(this._super){this._super();}if(!this.walkProvider){this.walkProvider=mstrmojo.insert(mstrmojo.rw.ConditionWalkProvider);}},initWalk:function R(){var X=this.columnWalk,Y=this.walkProvider;K.call(this,C);X.removeTrailingContainer(-1);X.addNextColumn(Y.getTargetNodeProps());X.target.updateColumnContainer();this.updateOkBtn();},updateBrowseElementsParams:function(a,Z){a.attributeID=Z.did;a.otp=Z.t||12;var Y=this.editor,X=Y&&Y.onUpdateBrowseElementsParams;if(X){X.call(Y,a,Z);}},children:[{scriptClass:"mstrmojo.ui.ColumnWalk",alias:"columnWalk",slot:"walkNode",height:"333px",width:"750px"},{alias:"cancelBtn",slot:"applyNode",scriptClass:"mstrmojo.Button",cssClass:"cancelBtn",title:mstrmojo.desc(2399,"Cancel"),ignoreLayout:true,onclick:function(){var X=this.parent;if(X.close){X.close();}}},{alias:"okBtn",slot:"applyNode",scriptClass:"mstrmojo.Button",cssClass:"okBtn",title:mstrmojo.desc(2397,"OK"),onclick:function(){var X=this.parent;if(X.onOK){X.onOK();}}},{scriptClass:"mstrmojo.Label",alias:"tip",slot:"applyNode",cssClass:"tip",text:C,ignoreLayout:true}],eb:{scriptClass:"mstrmojo.Editor",cssClass:F.isIE7?"mstrmojo-ElementsEditorIE7":"mstrmojo-ElementsEditor",title:mstrmojo.desc(6149,"Select Elements"),help:"element_browser_dialog_box.htm",children:[{scriptClass:"mstrmojo.ElementsBrowser",alias:"browser",onUpdateBrowseElementsParams:function(Y){var X=this.parent.opener;X.updateBrowseElementsParams(Y,X.model.a);}},{scriptClass:"mstrmojo.HBox",cssClass:"mstrmojo-Editor-buttonBox",slot:"buttonNode",children:[{scriptClass:"mstrmojo.Button",alias:"ok",text:mstrmojo.desc(1442,"OK"),cssClass:"mstrmojo-WebButton hot",cssText:"width: 66px;",onclick:function(){var X=this.parent.parent,Y=X&&X.opener;if(Y){Y.onEBSelect();Y.closePopup();}}},{scriptClass:"mstrmojo.Button",alias:"ok",text:mstrmojo.desc(221,"Cancel"),cssClass:"mstrmojo-WebButton",cssText:"min-width: 66px; margin-left: 11px;",onclick:function(){var X=this.parent.parent,Y=X&&X.opener;if(Y){Y.closePopup();}}}]}]},ob:{scriptClass:"mstrmojo.Editor",title:mstrmojo.desc(5298,"Select an Object"),help:"Select_Objects_dialog_box_.htm",children:[{scriptClass:"mstrmojo.ObjectBrowser",alias:"browser",fishEyeVisible:false,upButtonVisible:true,scrollableIncFetch:true,showCompletePath:false,closeable:false,closeOnSelect:false,browsableTypes:"3,4,8,10,12,256",includeObjectDesc:true,quickSearch:true,minSearchLength:1}]},_set_model:function V(a,X){var Y=this.model,Z=(X!==Y);if(Z){N.call(this,Y);X.dimtyTypes=this.dimtyTypes||M;this.model=X;E.call(this,X);if(this.hasRendered&&this.visible){this.columnWalk.target.updateColumnContainer();}}return Z;},onmodeledit:function H(Y){var X=Y.prop,a=X==="c0"||X==="c1",Z=this.columnWalk[a?"c0":X];if(a){Z.c1Selected=X==="c1";}Z.updateColumnContainer();Z.c1Selected=false;this.updateOkBtn();},browse:function G(Z){var b=this.parent.editorNode,a=function(d,f){var c=mstrmojo.dom.position(d,true),e=mstrmojo.dom.position(f,true);return{x:c.x+c.w,y:e.y};},X=this.columnWalk,Y=this.walkProvider;switch(Z&&Z.alias){case"target":case"dmy":Y.browseObjs(this,Z,a(Z.alias==="target"?X.target.domNode:this.dmyNode,b));break;case"c0":case"c1":Y.browseObjs(this,Z,a(X.c0.domNode,b));break;case"es":Y.browseEs(this,Z,a(X.es.domNode,b));break;}},onOBSelect:function(b){var Z=this.ob.browser,d=Z.target;this.closePopup();var Y=this.targets,c=d.itemIdField,a=Y||[],X=J.find(Y,c,b[c]);if(X===-1){a.push(b);this.targets=a;this.targetsLastMod=new Date();this.raiseEvent({name:"updateTargets",targets:this.targets});}d.setSelectedItems([b],d.multiSelect);if(d.onObjBrowsed){d.onObjBrowsed(b);}},onEBSelect:function(){var Y=this.eb.browser,a=this.columnWalk.es.es;a.set("selectedIndices",{});var X=a.items,Z=[];J.forEach(Y.selectedItems||[],function(c){if(J.find(a.items,"v",c.v)<0){Z.push(c);}});var b=a.insertUnlistedValuesAt||0;if(b<0){b=X.length;}a.set("items",X.slice(0,b).concat(Z).concat(X.slice(b)));a.setSelectedItems(Y.selectedItems,false);},destroy:function U(Y){var X=this.walkProvider;if(X&&X.destroy){this.walkProvider.destroy();}this._super(Y);},updateOkBtn:function W(){var a=true,X=this.model,Y,Z=X&&Q.fnCstCount(X.fn,X.fnt);if(!X){return ;}switch(X.et){case I.AQ:case I.AL:case I.MQ:for(Y=0;Y<Z;Y++){a=a&&!this["invalid"+Y];}break;}a=a&&!!X.completed;this.okBtn.set("visible",a);this.raiseEvent({name:"conditionWalkUpdateOkBtn",valid:a});}});mstrmojo.rw.ConditionWalk.getAttForms=P;mstrmojo.rw.ConditionWalk.isMdxDM=D;}());(function(){mstrmojo.requiresCls("mstrmojo.array","mstrmojo.css","mstrmojo.dom","mstrmojo.expr","mstrmojo.hash","mstrmojo.string","mstrmojo.vi.ui.HierarchyElementsCheckListBrowser","mstrmojo.vi.ui.ElementsBrowser","mstrmojo.ValidationTextBox","mstrmojo.DateTextBox","mstrmojo.Label","mstrmojo._IsList","mstrmojo.rw.ConditionWalkProviderBase","mstrmojo.ui.Pulldown","mstrmojo.ui.SearchablePulldown","mstrmojo.ui.CheckList","mstrmojo.ui.ColumnContainer","mstrmojo.vi.ui.DatasetUnitMenuUtils");var P=mstrmojo.array,W=mstrmojo.css,F=mstrmojo.string,M=mstrmojo.expr,X=mstrmojo.dom,Y=mstrmojo.hash,AA=M.ET,a=M.ET2TGT,o=M.DTP2FN_DTP,Z=M.FN,n=M.FNT,S=M.FN_MRP,t=mstrmojo.rw.ConditionWalkProviderBase,d=t.onWalkChange,q=t.updateList,AK=t.fnItem,AJ=t.isComparisonAllowed,b=t.clearInvalid,D=t.shouldShowCst,e=t.getConstant,G=t.getConstantDataType,z=t.getConstantValue,AL=t.isDATE,f=t.getCstListCompareTgts,g=t.fmJson,AD=t.allowedTargetTypes,L=t.updatePulldown,U=t.onWalkChangeThroughPulldown,p=mstrmojo.mstr.EnumDSSXMLObjectTypes,AH=mstrmojo.mstr.EnumDSSXMLObjectSubTypes,AN=mstrmojo.vi.ui.DatasetUnitMenuUtils,B=mstrmojo.ui._HasListTooltip;var E=mstrmojo.ui.ColumnContainer.prototype.updateColumnContainer;var Q=mstrmojo.meta.TP,AG=mstrmojo.meta.STP,C="-2";var N={SELECT:0,QUALIFICATION:1};var h={TEMPLATE_LEVEL:0,DATASET_LEVEL:1};var V={VALUE:1,RANK_PERCENTAGE:2,BOTH:3};var m=0,r=1;var H=368,AF=H-5,AM=5,R=26,K=10;var x={};x[AA.MQ]={key:"metricFns",def:M.METRIC_FNS};x[AA.MC]={key:"metricFns",def:M.METRIC_FNS};x[AA.AQ]={key:"formFns",def:M.FORM_FNS};x[AA.AL]={key:"formFns",def:M.FORM_FNS};x[AA.AC]={key:"formFns",def:M.FORM_FNS};x[AA.AE]={key:"elemFns",def:M.ELEM_FNS};function AI(AO){return'<div class="unit item '+AN.getUnitCssClass(AO)+'">'+F.encodeHtmlString(AO.n)+"</div>";}function AC(AO){var AP=this.selectedNode;P.forEach(AP.classList,function(AQ){if(AQ&&F.startsWith(AQ,"ic")){W.removeClass(AP,AQ);}});W.addClass(AP,"unit");W.addClass(AP,"item");W.addClass(AP,AN.getUnitCssClass(AO));return F.encodeHtmlString(AO.n);}function l(AP,AX){var AT=AP.model,AW=AT.et,AY=AT&&AT[a[AW]]&&AT[a[AW]][AP.columnWalk.target.itemIdField||"did"],AS=AT&&AT.fm,Ab=AS&&AS.dtp,AQ=AJ(AT,AP.ets);if(this.targetsLastMod&&this.targetsLastMod===AP.targetsLastMod&&AY&&AY===this._lastTargetId&&this.lastFmDtp===Ab&&this.lastFnTp===AQ&&this.lastEt===AW){return ;}var AV=this.attMxPd,Aa=this.attMxLabel;if(!AQ){AV.set("items",[]);Aa.set("visible",false);AV.set("visible",false);}else{var AZ=AT.a?mstrmojo.desc(518,"Attribute"):AT.m?mstrmojo.desc(517,"Metric"):"",AU=f(AP),AO=AT[a[AT.et]+(2+AX)],AR=AO?P.find(AU,"did",AO.did):undefined;Aa.set("text",AZ);AV.items=AU;AV.selectedIndex=AR>=0?AR:undefined;AV.refresh();Aa.set("visible",true);AV.set("visible",true);}this._lastTargetId=AY;this.lastFnTp=AQ;this.lastFmDtp=Ab;this.lastEt=AW;this.targetsLastMod=AP.targetsLastMod;}function J(AW,AZ){AW.updating=true;var AS=AW.parent.parent.parent,AY=D(AS,AZ);if(!AY){AW.updating=false;return ;}var AQ=AS.model||{},AV=e(AS,AZ),AR=G(AS,AV),Aa=z(AS,AZ),AX=AQ.fn,AU=M.fn_List(AX,AQ.fnt),AO=AL[AR];var AT=AO?AW.dateInput:AW.txtInput;var AP=AO?AW.txtInput:AW.dateInput;AP.set("visible",false);AT.updating=true;AT.set("dtp",AR);AT.set("isList",AU);AT.set("value",Aa);AT.set("visible",true);AT.set("hint",AU?mstrmojo.desc(8191,"value1## value2## ...## valueN").replace(/##/g,mstrConfig.listSep||";"):"");AT.updating=false;if(AX===1||AX===2){AT.constraints.min=0;}if(AT.clearValidation&&AT.inputNode){AT.clearValidation();}l.call(AW,AS,AZ);switch(AQ.et){case AA.AQ:case AA.AL:case AA.MQ:AW.attMxPd.set("selectedIndex",undefined);break;}AW.updating=false;}function AE(){var AR=this.parent,AP=AR.parent.parent.parent,AQ=(this.isValid&&this.isValid())||(!this.isValid&&!F.isEmpty(this.value)),AO=AP.model;AP["invalid"+AR.cstIndex]=!AQ;if(!this.updating){this.updating=true;if(AO){AO.edit(AR.alias,{v:this.value,dtp:this.dtp});}this.updating=false;}if(AP.updateOkBtn){AP.updateOkBtn();}}function I(AO){if(AO){var AQ=AO.n,AP=AO.dsName;if(AQ&&AP){return'<div class="name">'+F.encodeHtmlString(AQ,true)+'</div><div class="dsc dataset">'+F.encodeHtmlString(AP,true)+"</div>";}else{return B.getTooltipText.call(this,AO);}}}function k(AO){return Y.copy(AO,{scriptClass:"mstrmojo.Box",children:[{scriptClass:"mstrmojo.ValidationTextBox",alias:"txtInput",cssText:"width: 100%",required:true,constraints:{trigger:mstrmojo.validation.TRIGGER.VALUESET},onValid:AE,onInvalid:AE,onClearValidation:b,size:6,visible:true},{scriptClass:"mstrmojo.DateTextBox",alias:"dateInput",cssDisplay:"inline-block",required:true,constraints:{trigger:mstrmojo.validation.TRIGGER.ALL},onValid:AE,onInvalid:AE,onClearValidation:b,calendarToBody:true,autoFormat:false,calConfig:{onmousedown:function(AR){X.stopPropogation(AR.hWin,AR.e);}},visible:true},{scriptClass:"mstrmojo.Label",cssClass:"attMxLabel",text:"Attribute",alias:"attMxLabel"},{scriptClass:"mstrmojo.ui.Pulldown",alias:"attMxPd",itemIdField:"did",cssClass:"conditionWalk-attMxPd",onSelectedItemChange:function AP(AS,AT){if(this.hasRendered){var AR=this.parent.parent.parent.parent;U.call(this,AR,AS,"c0");}},getPulldownTextInnerHTML:AI,getPopupListConfig:function AQ(){var AR=mstrmojo.ui.Pulldown.prototype.getPopupListConfig.call(this);AR.showTooltipForLargeText=false;AR.getItemProps=function AS(AV,AT){var AU=mstrmojo._IsList.getItemProps.call(this,AV,AT);AU.title="";AU.style=this.parent.itemCssText||"";AU.addCls("unit "+AN.getUnitCssClass(AV));return AU;};AR.getTooltipText=I;return AR;}}],update:function(){J(this,this.cstIndex);this.parent.updateScrollbars();},postCreate:function(){this._super();this.parent.parent.parent.attachEventListener("updateTargets",this.id,function(){this.update();});}});}function u(AO){return AO[Q]===p.Attribute&&AO[AG]===AH.AttributeRecursive;}function w(AO){var AQ=AO[Q]===p.Consolidation&&AO[AG]===AH.ConsolidationManaged,AP=mstrApp&&mstrApp.rootCtrl&&mstrApp.rootCtrl.docCtrl&&mstrApp.rootCtrl.docCtrl.model;if(AQ&&AP&&AP.findUnitInDataSet){AO=AP.findUnitInDataSet(AO.did);if(AO&&AO.attId){return u(AP.findUnitInDataSet(AO.attId));}}}mstrmojo.vi.ui.ConditionWalkProvider=mstrmojo.declare(mstrmojo.rw.ConditionWalkProviderBase,null,{scriptClass:"mstrmojo.vi.ui.ConditionWalkProvider",getTargetNodeProps:function j(){var AY=this;return{alias:"target",isAttribute:false,isMetric:false,showChooseMethod:true,showLevel:false,children:[{scriptClass:"mstrmojo.Label",cssClass:"baseOn",text:mstrmojo.desc(15115,"Based on")},{scriptClass:"mstrmojo.ui.SearchablePulldown",alias:"target",itemIdField:"did",cssClass:"conditionWalk-target",allowEmptyText:true,onRender:function(){if(this.hasRendered){this[this.editableSlot].setAttribute("placeholder",mstrmojo.desc(10,"Search"));}},postCreate:function(){this.parent.parent.parent.attachEventListener("updateTargets",this.id,function(){this.update();});},getEditableTextInnerHTML:function AZ(){var Ab=this.selectedIndex,Aa=this.getPopupList(),Ac=Aa&&Aa.items;if(this.selectedNode&&Ac&&Ac[Ab]){return this.getPulldownTextInnerHTML(Ac[Ab]);}else{return"";}},update:function AU(){var Ad=this.parent.parent.parent,Ac=Ad.model,Aa=Ad.targetsLastMod,Ag=Ac&&Ac.et;if(this.lastModel!==Ac||this.targetsLastMod!==Aa){this.lastModel=Ac;this.targetsLastMod=Aa;var Ab=Ad.targets,Ae=Ad.ets;if(Ae&&Ab&&Ab.length){var Af=AD(Ad.ets);Ab=P.filter(Ab,function(Al){return Af[Al[Q]];});}var Aj=Ac&&Ac[a[Ag]],Ai=Ad.objectBrowsingEnabled,Ak=Ai&&(!Ab||P.find(Ab,"did",C)===-1);if(Ag===AA.ANDOR){Aj=Ac.a||Ac.m||null;}this.set("objectBrowsingEnabled",Ai);if(Ak){Ab=Ab||[];var Ah=mstrmojo.desc(15346,"Browse Metadata Objects...");Ab.push({did:C,n:Ah,t:-1,title:Ah});}L(this,true,M.getSortedObjectsByTypeGroup(Ab),Aj);if((!Ai||Ak)&&!Aj){this.set("isEditing",true);this.openPopup(this.getPopupList());}}},onitemSelected:function AP(Ac,Ab){if(this.hasRendered){var Aa=this.parent.parent.parent;U.call(this,Aa,Ac,"target");}},preisEditingChange:function AV(){if(this.hasRendered&&this.isEditing){var Aa=this.selectedNode;this._lastText=Aa.innerHTML;W.removeClass(Aa,"unit");W.removeClass(Aa,"item");}return true;},postisEditingChange:function AW(){if(this.hasRendered&&!this.isEditing){var Aa=this.selectedNode;if(this._lastText){Aa.innerHTML=this._lastText;W.addClass(Aa,"unit");W.addClass(Aa,"item");}else{Aa.innerHTML="";}delete this._lastText;}},onPopupWidgetClosed:function AX(Ac){if(this.objectBrowsingEnabled&&Ac&&Ac.pressingEnter){var Aa=this.getPopupList(),Af=Aa._oldItems,Ae=this.text;if(Af&&Ae){var Ad=P.filterOne(Af,function(Ag){return Ag.n===Ae;});Ad=Ad||Aa.items[0];if(!Ad){delete Aa._oldItems;Aa.set("items",Af);return ;}if(Ad.did===C){var Ab=this.parent.parent.parent;Ab.browse(this);delete Aa._oldItems;Aa.set("items",Af);return ;}}}mstrmojo.ui.SearchablePulldown.prototype.onPopupWidgetClosed.call(this,Ac);},getPulldownTextInnerHTML:AC,getPopupListConfig:function AO(){var Aa=mstrmojo.ui.SearchablePulldown.prototype.getPopupListConfig.call(this);Aa.showTooltipForLargeText=false;Aa.getItemProps=function Ab(Ag,Ae){var Af=mstrmojo._IsList.getItemProps.call(this,Ag,Ae);Af.title="";Af.style=this.parent.itemCssText||"";Af.addCls("unit "+AN.getUnitCssClass(Ag));Af.addCls(Ag.isInvalid?"invalid":"");return Af;};Aa.doItemSelect=function Ac(Ah,Ae){if(Ah.did===C){var Af=this.parent;Af.parent.parent.parent.browse(Af);}else{if(Ah.isInvalid){var Ag=this;window.setTimeout(function(){Ag.showTooltip({target:Ag._getItemNode(Ah._renderIdx)},window);},0);}else{mstrmojo._IsList.doItemSelect.call(this,Ah,Ae);}}};Aa.showTooltip=function Ad(Aj,Ai){if(!this.hasOpenTooltip&&!(this._lastOpened&&this._lastOpened.visible)){var Ah=X.eventTarget(Ai,Aj),Ag=this.getItemFromTarget(Ah);if(Ag&&Ag.isInvalid){var Af=this.getItemNodeFromTarget(Ah),Ae=X.position(Af);this.richTooltip={content:mstrmojo.desc(15391,"This is an invalid object. Please contact your administrator for more information."),cssClass:"vi-warning triangle-warning vi-tooltip-C A-center",left:Ae.x+168,top:Ae.y};mstrmojo._HasTooltip.showTooltip.call(this,Aj,Ai);}else{this.constructor.prototype.showTooltip.call(this,Aj,Ai);}}};Aa.tooltipOpenDelay=700;Aa.getTooltipText=I;return Aa;}},{scriptClass:"mstrmojo.Label",cssClass:"baseOn",text:mstrmojo.desc(15116,"Choose elements by"),alias:"attrLabel",bindings:{visible:"this.parent.isAttribute && this.parent.showChooseMethod"}},{scriptClass:"mstrmojo.ui.Pulldown",alias:"chooseMethodPd",items:null,visible:false,bindings:{visible:"this.parent.isAttribute && this.parent.showChooseMethod"},onitemSelected:function AP(Ad){var Ac=this.parent.fm,Ab=Ac&&Ac.cssClass,Aa=Ac&&Ac.domNode,Ae=Ac&&Ac.selectedItem;if(Ad.v===N.SELECT){W.toggleClass(Aa,"forms",false);if((Ab||"").indexOf(" forms")>-1){Ac.cssClass=Ab.replace(" forms","");}if((!Ae)||Ae.did!=="1,22"&&Ae.did!=="1,57"){Ac.singleSelectByField("1,22","did");}}else{W.toggleClass(Aa,"forms",true);if((Ab||"").indexOf(" forms")===-1){Ac.cssClass=(Ab||"")+" forms";}if(!Ae||Ae.did==="1,22"||Ae.did==="1,57"){Ac.singleSelect(2);}}Ac.updateScrollbars();},update:function AU(){var Af=this.parent.parent.parent,Ad=Af&&Af.model,Ab=Af&&Af.disableElementsBrowsing,Aa=Ad&&Ad.a,Ac=Aa&&Ab&&Ab(Aa);if(Ac){this.set("items",[{n:mstrmojo.desc(15117,"Qualification on"),v:N.QUALIFICATION}]);}else{if(Aa.ndetype===1){this.children[0].showTooltipForLargeText=false;this.set("items",[{n:mstrmojo.desc(15118,"Selecting in list"),v:N.SELECT,ttpDisabled:true},{n:mstrmojo.desc(15117,"Qualification on"),v:N.QUALIFICATION,cls:"disabled",dsbld:true,ttp:mstrmojo.desc(16184,"This method is not available for this object type.")}]);}else{this.set("items",[{n:mstrmojo.desc(15118,"Selecting in list"),v:N.SELECT},{n:mstrmojo.desc(15117,"Qualification on"),v:N.QUALIFICATION}]);}}var Ae=this.getSelectedItem();switch(Ad.et){case AA.AQ:case AA.AL:case AA.AC:if(!Ae||Ae.v!==N.QUALIFICATION){this.selectItemByField("v",N.QUALIFICATION);}break;default:if(!Ae||Ae.v!==N.SELECT){this.selectItemByField("v",N.SELECT);}break;}}},g({scriptClass:"mstrmojo.ui.CheckList",alias:"fm",fmPost:"",itemIdField:"did",filter:false,isFirstFm:true,multiSelect:false,minimumSelectCnt:0,hasDummyLabel:false,lastAttrId:null,height:AF-R*4-K*2-AM+"px",onchange:function AS(Aa){d.call(this,Aa,"fm");},bindings:{visible:"this.parent.isAttribute && this.parent.showChooseMethod"},onvisibleChange:function(){this.lastAttrId=null;}}),{scriptClass:"mstrmojo.Label",text:mstrmojo.desc(15119,"Output Level"),cssClass:"baseOn",alias:"metricLabel",bindings:{visible:"this.parent.isMetric && this.parent.showLevel"}},{scriptClass:"mstrmojo.ui.Pulldown",alias:"outputLevelPd",items:[{n:mstrmojo.desc(12178,"Visualization level"),v:h.TEMPLATE_LEVEL},{n:mstrmojo.desc(13519,"Dataset level"),v:h.DATASET_LEVEL}],selectedIndex:0,bindings:{visible:"this.parent.isMetric && this.parent.showLevel"},onSelectedItemChange:function AQ(Ab,Ac){var Aa=this.parent.parent.parent,Ad=Aa.condition;Ad.level=Ab.v;}}],updateColumnContainer:function AR(){this.target.update();var Ad=this.parent,Ai=Ad.parent,Al=Ai.model,At=Al&&Al.et,Am=this.idx,Aq=this.next,Ar=Al&&Al.a,Aj=Al&&Al.fm,Ag=Ai&&Ai.inRelation;if(At){switch(At){case AA.AQ:case AA.AL:case AA.AC:case AA.AE:case AA.ANDOR:if(Ar){this.set("isMetric",false);this.set("isAttribute",true);var Ap=Ai.disableElementsBrowsing,Ac=Ar&&Ap&&Ap(Ar),An=Ai.getAttributeInfo(Ar.did),Ah=u(An)||w(An),Ak=Ai.disableHierarchyLevel;if(Ah){Al.et=AA.AE;this.set("showChooseMethod",false);}var Af=(Al.etWas&&Al.etWas===AA.AE)?r:m,Ao=m;if(Al.et===AA.AE&&!Ac){Ao=r;}if(Af!==Ao||Ao===m||!Ad.next){Ad.removeTrailingContainer(Am);if(Ao===m&&Aj){Ad.addNextColumn(AY.getFnNodeProps());}else{if(Ao===r){Ad.addNextColumn(AY.getEsNodeProps(Ah,Ak));}}}Ai.condition.level=h.DATASET_LEVEL;var As=this.fm;As.updating=true;As.update();this.chooseMethodPd.update();As.updating=false;}break;case AA.MQ:case AA.MC:if(Al.m){this.set("isMetric",true);this.set("isAttribute",false);var Ab=Ai.isMDXDM(Al.m.did),Aa=Ai.condition.level,Ae=Ai.editor&&Ai.editor.showLimits;if(Aa!==h.TEMPLATE_LEVEL&&Aa!==h.DATASET_LEVEL){Aa=Ai.condition.level=Ae?h.TEMPLATE_LEVEL:h.DATASET_LEVEL;}if(!Ag&&!Ab&&Ae){this.set("showLevel",true);this.outputLevelPd.set("selectedIndex",Aa);}else{this.set("showLevel",false);}if(!(Aq&&Aq.fn)){this.parent.insertAndRemoveTrailing(Am,AY.getFnNodeProps());}}break;case AA.R:case AA.F:case AA.XML:this.set("isMetric",false);this.set("isAttribute",false);Ai.condition.level=h.DATASET_LEVEL;this.parent.removeTrailingContainer(Am);break;}}else{this.set("isMetric",false);this.set("isAttribute",false);}E.call(this);},setupScrollNodes:function AT(){this.scrollNode=null;}};},getEsNodeProps:function A(AV,AQ){var AU=AV?"HierarchyElementsCheckListBrowser":"ElementsBrowser",AP=[{scriptClass:"mstrmojo.vi.ui."+AU,alias:"es",height:AF-5+"px",disableLevel:AQ,update:function AT(){var AZ=this.parent.parent.parent,Aa=AZ.model,AY=Aa&&Aa.a,AX=!!AY&&!AY.ilk;if(!AX){return ;}this.set("ifDataSource",AZ.getIfDataSource());this.onUpdateBrowseElementsParams=function(Ad){AZ.onUpdateBrowseElementsParams(Ad);};if(!Aa.es){Aa.es=[];}if(AV){var Ac=AZ.getAttributeInfo(AY.did);Y.copyProps(["t","st"],Ac,AY);if(Ac&&Ac.attId){Ac=AZ.getAttributeInfo(Ac.attId);}Y.copyProps(["fs","lvfs"],Ac,AY);}else{if(!AY.fs){Y.copyProps(["fs"],AZ.getAttributeInfo(AY.did),AY);}}var Ab=Y.clone(AV?Aa.data:Aa.es);this.set("attribute",AY);this.set("selectedItems",Ab);},onBrowseElementsFailure:function AO(){var Aa=this.attributeId,AX=this.parent.parent,AZ=AX.parent,AY=P.filterOne(AZ.targets,function(Ac){return Ac.did===Aa;});AY.isInvalid=true;AY.cls=(AY.cls||"")+" invalid";AZ.set("model",{et:5,isNew:true,defaultETAttr:5});var Ab=AX.target.target;Ab.openPopup(Ab.getPopupWidget());},onItemsSelectionChange:function AW(AX){var AY=this.parent.parent.parent,AZ=AY.model;AZ.edit(AV?"data":"es",AX);}}];return{alias:"es",children:AP,cssClass:"lastStage",updateColumnContainer:function AR(){this.es.update();},setupScrollNodes:function AS(){this.scrollNode=null;}};},getFnNodeProps:function c(){var AS=this,AP=[{scriptClass:"mstrmojo.Label",cssClass:"baseOn",text:mstrApp.isWSStyling?mstrmojo.desc(15006,"Operator"):mstrmojo.desc(9579,"Condition")},{scriptClass:"mstrmojo.ui.Pulldown",alias:"fnTypePulldown",items:[{n:mstrmojo.desc(15302,"By Value"),v:V.VALUE},{n:mstrmojo.desc(15303,"By Rank"),v:V.RANK_PERCENTAGE}],onSelectedItemChange:function AT(AV,AX){var AW=this.parent;AW.fn.update();}},g({scriptClass:"mstrmojo.ui.CheckList",alias:"fn",multiSelect:false,allowUnlistedValues:false,hideCheckMark:true,itemIdField:"did",onchange:function AO(AV){d.call(this,AV);},update:function(){var AX=this.parent,Ab=AX.parent.parent,AW=Ab.model||{},Ac=AW.et,Aa,Ad=false,Ae,AV,Ag=V.BOTH;switch(Ac){case AA.AE:Ad=!!AW.a;break;case AA.AQ:case AA.AC:case AA.AL:Ad=!!(AW.fm&&AW.fm.did);Aa=Ad?AW.fm.dtp:null;break;case AA.MQ:case AA.MC:Ad=!!AW.m;Aa=Ad?M.METRIC_DTP:null;Ag=AX.fnTypePulldown.getSelectedItem().v;break;}if(!Ad){return ;}var Af=o[Aa];if((this.lastEt!==Ac)||(this.lastFnDtp!==Af)||(this.lastFnTypeToDisplay!==Ag)){this.lastEt=Ac;this.lastFnDtp=Af;this.lastFnTypeToDisplay=Ag;var AZ=Ac?x[Ac]:null,AY=AZ&&AZ.key;Ae=(AY&&Ab[AY])||AZ.def||[];if(typeof (Ae)==="object"){Ae=Ae[Af]||Ae["*"];}if(Ag!=V.BOTH){Ae=P.filter(Ae,function(Ah){var Ai=Ah.tp===n.PER||Ah.tp===n.RANK;return Ag===V.RANK_PERCENTAGE?Ai:!Ai;});}AV=AK(AW.fn,AW.fnt||1);AV=P.filterOne(Ae,function(Ah){return Ah.did===(AV&&AV.did);});q(this,Ad,Ae,AV);if(!AV){this.set("selectedIndex",0);}}this.parent.updateScrollbars();}})];return{alias:"fn",children:AP,updateColumnContainer:function AU(){var Ad=this.parent,AZ=Ad.parent,AY=AZ.model,Aa=AY&&AY.fn,Ac=AY&&AY.fnt,Ab=AY&&AY.et,AX=this.next,AW=Aa===Z.IS_NULL||Aa===Z.IS_NOT_NULL,AV=(Ab===AA.MC||Ab===AA.MQ);this.changeFnTypePdVisibility(AV);if(AV){this.fnTypePulldown.getPopupList().singleSelectByField((Ac===n.RANK||Ac===n.PER)?V.RANK_PERCENTAGE:V.VALUE,"v");}else{this.fn.update();}if(Aa&&AW){Ad.removeTrailingContainer(this.idx);}else{if(Aa&&!(AX&&AX.c0)){Ad.insertAndRemoveTrailing(this.idx,AS.getC0NodeProps());}}AX=this.next;if(AX){AX.updateColumnContainer();}},changeFnTypePdVisibility:function AR(AW){this.fnTypePulldown.set("visible",AW);var AV=AF-AM-R;if(AW){AV-=(R+K);}this.fn.set("height",AV+"px");},setupScrollNodes:function AQ(){this.scrollNode=null;}};},getC0NodeProps:function O(){var AQ=this;return{alias:"c0",children:[{scriptClass:"mstrmojo.Label",cssClass:"baseOn",text:mstrmojo.desc(527,"Value")},k({alias:"c0",cstIndex:0}),{scriptClass:"mstrmojo.Label",alias:"btwn",cssClass:"btwn",text:mstrmojo.desc(308,"and"),visible:false},k({alias:"c1",cstIndex:1,visible:false}),{alias:"browseLink",scriptClass:"mstrmojo.Label",cssClass:"mstrmojo-walkstep-browse",text:mstrmojo.desc(7926,"Browse..."),onclick:function(){this.parent.parent.parent.browse(this.parent.c0);},visible:false},g({scriptClass:"mstrmojo.ui.CheckList",alias:"fm2",fmPost:2,itemIdField:"did",filter:false,multiSelect:false,minimumSelectCnt:0,hasDummyLabel:false,height:AF-R*4-K*2-AM+"px",onchange:function AO(AS){d.call(this,AS,"fm2");}})],updateColumnContainer:function AR(){this.c0.update();var Ab=this.parent,AX=Ab.parent,AW=Ab.parent.model,AZ=AW&&AW.fn,AS=AZ===Z.BETWEEN||AZ===Z.NOT_BETWEEN||AZ===S.BETWEEN||AZ===S.BETWEEN_DESCENDING,AY=AZ===Z.EQUAL||AZ===Z.NOT_EQUAL||AZ===Z.GREATER||AZ===Z.GREATER_EQUAL||AZ===Z.LESS||AZ===Z.LESS_EQUAL,Aa=this.idx,AV=this.next;this.browseLink.set("visible",AX.objectBrowsingEnabled&&AJ(AW,AX.ets));this.btwn.set("visible",AS);var AU=this.c1;AU.set("visible",AS);if(AS){AU.update();}else{if(AW.c1){AW.edit("c1",{v:null,dtp:null,skipET:true},true);}}if((!AW.a)&&AW.m&&this.domNode){W.addClass(this.domNode,"lastStage");}var AT=this.fm2;if(AW.a2&&AY){AT.update();AT.set("visible",true);}else{AT.set("visible",false);}E.call(this);},setupScrollNodes:function AP(){this.scrollNode=null;}};},browseObjs:function AB(AT,AS,AV){var AR=X.position(AT.parent.containerNode);AV=AV||{};AV.x=AR.x+40;AV.y=AR.y;this._super(AT,AS,AV);var AP=AT.ob.browser,AO=AT.parent.opener.docModel,AQ=AS.alias,AU=AT.model.et;AO.controller.rootCtrl.loadDataProvider(function(AW){if(AQ==="target"||AU===AA.AQ){AP.rootFolder={did:"6F55FB47F9974EABA18CB0C5FF46785C"};}else{if(AU===AA.MQ){AP.rootFolder={did:"E0CCB9CF22104A489CBE78D974AFD19E"};}}AP.model=AO;AP.set("dataProvider",AW);AP.set("opened",true);});}});}());(function(){mstrmojo.requiresCls("mstrmojo.vi.models.EnumDragSources","mstrmojo.vi.ui.DatasetUnitMenuUtils");var A=mstrmojo.vi.ui.DatasetUnitMenuUtils;mstrmojo.vi.ui._CanDropFromSchema=mstrmojo.provide("mstrmojo.vi.ui._CanDropFromSchema",{_mixinName:"mstrmojo.vi.ui._CanDropFromSchema",augmentDropContextForSchema:function B(E,C){var F=E.getCtxtDragData();if(F.src===mstrmojo.vi.models.EnumDragSources.ALL_OBJECT_LIST){var D=A.getCfgForAddUnitFromAllObject(F.items,C.datasets||{});F.dsid=D.dsid;if(D.actions.length){E.actions=D.actions;E.callback=C.getDatasetsUpdateCallback();}}}});})();(function(){mstrmojo.requiresCls("mstrmojo.ListBase","mstrmojo._IsList","mstrmojo.vi.ui.DatasetUnitMenuUtils");var B=mstrmojo.vi.ui.DatasetUnitMenuUtils;mstrmojo.vi.ui.UnitList=mstrmojo.declare(mstrmojo.ListBase,[mstrmojo._IsList],{scriptClass:"mstrmojo.vi.ui.UnitList",init:function C(D){this._super(D);mstrmojo.css.addWidgetCssClass(this,"mstrmojo-VIUnitList");},getItemProps:function A(F,D){var E=this._super(F,D);E.addCls("unit "+B.getUnitCssClass(F));return E;}});}());(function(){mstrmojo.requiresCls("mstrmojo.hash","mstrmojo.dom","mstrmojo.elementHelper","mstrmojo.func","mstrmojo.VisEnum","mstrmojo.num","mstrmojo.array","mstrmojo.VisMenuList","mstrmojo.mstr.EnumFunction","mstrmojo._HasMarkup","mstrmojo.chart.model.enums.EnumDSSObjectType","mstrmojo.models.FormatModel","mstrmojo._FormatDefinition","mstrmojo.css","mstrmojo.chart.enums.EnumFontStyle","mstrmojo.vi.ui.DatasetUnitMenuUtils","mstrmojo.chart.model.enums.EnumDSSBaseFormType","mstrmojo.string","mstrmojo.vi.viz.EnumVizStyles","mstrmojo.vi.enums.EnumFeatures","mstrmojo.vi.ui.rw.GhostImageContainer","mstrmojo.vi.ui.rw.FreezingImageContainer");mstrmojo.requiresClsP("mstrmojo.ui.menus","MenuConfig","EditorConfig");var N=document.getElementById("vis-measure-canvas"),E=document.getElementById("vis-measure-span"),f={},M={},q={},AE=mstrmojo.dom,d=mstrmojo.elementHelper,AV=mstrmojo.vi.ui.DatasetUnitMenuUtils,V=mstrmojo.VisEnum.EnumColorRankMode,p=mstrmojo.chart.model.enums.EnumDSSObjectType,AN=mstrmojo.chart.model.enums.EnumDSSBaseFormType,AT=mstrmojo.models.FormatModel.ENUM_PROPERTY_NAMES,AX=mstrmojo.chart.enums.EnumFontStyle,X=mstrmojo.hash,c=mstrmojo.string,Ae=mstrmojo.func.wrapMethods,Z=mstrmojo.VisEnum,Q=mstrmojo._FormatDefinition,Ah=Z.SERVER_JSON_ERROR_TYPE,x=mstrmojo.vi.viz.EnumVizStyles,AO=mstrmojo.vi.enums.EnumFeatures,D=mstrmojo.vi.ui.rw.FreezingImageContainer,Ac=mstrmojo.vi.ui.rw.GhostImageContainer;var u=64,AG=128,C=4,AA=5,b=6,F=7,e=mstrmojo,S=e.array,Af=mstrmojo.array,A=e.desc,j=e.mstr.EnumFunction,U=mstrmojo.vi.enums.EnumDerivedElementType,Aa=e._HasMarkup,Ad=e.css;var P;mstrmojo.requiresDescs(221,358,1422,2122,6017,5868,5869,11819,11827);function Ag(Am,Al){var Ak=mstrmojo.VisUtility;var An=Ak.pluck(Al,"tid"),Ao=Ak.pluck(Al,"eid"),Aj=(Am.getDocModel&&Am.getDocModel())||Ak.getPropertyByPath(Am,"model.docModel");if(Ak.getPropertyByPath(Aj,"getColorBy") instanceof Function){return Aj.getColorBy(An,Ao);}}function Ab(Aj,Al,An){var Am=Al.id,Ak=Al.getHost();if(Ak&&Ak.observableModel){Aj.forEach(function(Ap){var Ao=Ak.observableModel[Ap];if(Ao){Ao.attachEventListener("valueChanged",Am,An);}});}}function Ai(Ak){var Aj={SINGLE:[{text:A(358,"Absolute"),value:j.FunctionAbs,n:A(358,"Absolute"),v:j.FunctionAbs}],PAIR:[{text:A(6017,"Add"),value:j.FunctionAdd,n:A(6017,"Add"),v:j.FunctionAdd},{text:A(2122,"Average"),value:j.FunctionAverage,n:A(2122,"Average"),v:j.FunctionAverage},{text:A(5868,"Least"),value:j.FunctionLeast,n:A(5868,"Least"),v:j.FunctionLeast},{text:A(5869,"Greatest"),value:j.FunctionGreatest,n:A(5869,"Greatest"),v:j.FunctionGreatest},{text:"A-B",value:j.FunctionMinus+";0",n:"A-B",v:j.FunctionMinus+";0"},{text:"B-A",value:j.FunctionMinus+";1",n:"B-A",v:j.FunctionMinus+";1"},{text:"A/B",value:j.FunctionDivide+";0",n:"A/B",v:j.FunctionDivide+";0"},{text:"B/A",value:j.FunctionDivide+";1",n:"B/A",v:j.FunctionDivide+";1"}],MORE:[{text:A(6017,"Add"),value:j.FunctionAdd,n:A(6017,"Add"),v:j.FunctionAdd},{text:A(2122,"Average"),value:j.FunctionAverage,n:A(2122,"Average"),v:j.FunctionAverage},{text:A(5868,"Least"),value:j.FunctionLeast,n:A(5868,"Least"),v:j.FunctionLeast},{text:A(5869,"Greatest"),value:j.FunctionGreatest,n:A(5869,"Greatest"),v:j.FunctionGreatest}]};return Aj[Ak];}function AS(Ak,Aj){return !!(((Ak&&Ak.at)||0)&Aj);}function Y(Aj){return !Aj.cmSelCells.some(function(Ak){var Al=Aj.getCellForNode(Ak);return d.isNonGroupNull(Al)||!AS(Al,u)||Al.dei!==undefined||Aj.model.isRecursiveAttribute(Al.tid);});}function l(Ak){var Aj;return !Ak.cmSelCells.some(function(Al){Aj=Ak.getCellForNode(Al);return(d.isNonGroupNull(Aj)||!AS(Aj,AG))||Ak.model.isRecursiveAttribute(Aj.tid);});}function W(Am,Al,Ao,An,Ak){var Aj=Ao&&Ao.func;if((Aj===An)||(typeof An==="string"&&An.indexOf(Aj)===0&&An.indexOf(";0")>0)){return ;}if(Ak){Am.editDECalculation(Al,An);}else{Am.derivedElementCalculation(Al,An);}}function m(Av,At,Ar){var Au=At&&At.es,Aj=(Au&&Au.length)||Av.cmSelCells.length,Am=(Aj===1)?"SINGLE":((Aj===2)?"PAIR":"MORE"),As=Ai(Am),Al=(At&&At.func),An,Aw=Av.cmSelCells,Ak,Aq,Ap,Ao;if(Am==="PAIR"){if(At){Ao=Au[0].v>Au[1].v;if(Ao){Ap=Au[0].n;Aq=Au[1].n;As[4]={value:j.FunctionMinus+";1",v:j.FunctionMinus+";1"};As[5]={value:j.FunctionMinus+";0",v:j.FunctionMinus+";0"};As[6]={value:j.FunctionDivide+";1",v:j.FunctionDivide+";1"};As[7]={value:j.FunctionDivide+";0",v:j.FunctionDivide+";0"};}else{Aq=Au[0].n;Ap=Au[1].n;}}else{Aq=Ar(Aw[0]);Ap=Ar(Aw[1]);}As[C].text=Aq+" - "+Ap;As[AA].text=Ap+" - "+Aq;As[b].text=Aq+" / "+Ap;As[F].text=Ap+" / "+Aq;As[C].n=Aq+" - "+Ap;As[AA].n=Ap+" - "+Aq;As[b].n=Aq+" / "+Ap;As[F].n=Ap+" / "+Aq;}for(An in As){if(typeof As[An].value==="string"&&As[An].value.indexOf(Al)===0&&As[An].value.indexOf(";0")>0){Ak=As[An];break;}if(As[An].value===Al){Ak=As[An];break;}}return{items:As,selectedItem:Ak};}function w(Aj,Am){if(!Aj){return Aj;}if(Am.length===1){return Aj[Am[0]];}var Al=(Am&&Am.length)||0,Ak;for(Ak=0;Ak<Al;Ak++){Aj=Aj[Am[Ak]];if(!Aj){break;}}return Aj;}function AU(Al,Ak,Aj){return Al.every(function(Am){return Am.ttp===Ak||Am.ttp===Aj;});}function G(Ak,An,Ao){var Am=(An&&An.length)||0,Al,Aj,Ap=Ak;for(Al=0;Al<Am-1;Al++){Aj=An[Al];if(!Ap[Aj]){Ap[Aj]={};}Ap=Ap[Aj];}Ap[An[Am-1]]=Ao;}function AD(Ar){var As,Aq,Am,Ao,Aj,Ap=this.model.docModel.datasets,Ak=false,An=false,Al={isDM:false};for(As in Ap){if(Ap.hasOwnProperty(As)){Aq=Ap[As].mx;S.forEach((Aq||[]),function(At){if(At.did===Ar){if(At.um||At.rdm){An=true;}Ak=true;return false;}});if(Ak){break;}}}if(An){Aj=this.model.data.gts.col;Am=(Aj&&Aj[Aj.length-1]);if(Am&&Am.otp===-1){Ao=Am.es;}S.forEach((Ao||[]),function(At){if(At.oid===Ar){Al={isDM:true,id:At.id};return false;}});}return Al;}function L(Aj,Am){var Ap=[],Al={act:"updateElementsPropertiesMap",epm:Ap},An=[],Ak={},Ar=[Ak],Aq=this;Ap.push({epmk:An,epmv:Ar});Aj.forEach(function(At){var Au=At.tid,Aw=At.tp,As=Au===-1,Av={ob:{did:As?"":Au,tp:Aw}};An.push(Av);});if(Am&&Am.indexOf("default")<0){Ak.v={vv:Am};}var Ao=[];Ak.k={chn:Ao};Aj.forEach(function(Au){var Av=Au.tid,As=Av===-1,At;if(As){At=AD.call(Aq,Au.eid);if(At.isDM){Ao.push({emt:2,ei:At.id});}else{Ao.push({emt:2,mt:{did:Au.eid,tp:4,ql:0}});}}else{Ao.push({emt:1,ei:Au.eid,at:{did:Av,tp:Au.tp,ql:0}});}});return Al;}function AP(An,Al){var Am="00000000000000000000000000000000",Ak=An&&An.dropZones,Aj=S.find(Ak,"id",Al);return Aj===-1?[]:S.filter(Ak[Aj].items,function(Ao){return Ao.t===4&&Ao.id!==Am;});}function AJ(Ao,Al,An,Ak,Aj){var Ap=Ak?Ao:Ao&&Ao.parentNode;while(Ap&&(Ap!==Aj)){var Am=Ap.getAttribute&&Ap.getAttribute(Al);if(Am!==null&&Am.indexOf(An)>=0){return true;}Ap=Ap.parentNode;}return false;}function AC(Ak,Al){var Aj=X.walk("rootCtrl.docCtrl",mstrApp);if(Aj&&(typeof Aj.selectViPanel==="function")){Aj.selectViPanel(Al);}Ak.getDocModel().selectVIUnit(Ak.parent.id,true);}var H={sessions:{},instances:[],init:function AK(){this.supportedEventTypes=[];if(window.TouchEvent){this.supportedEventTypes.push("TouchEvent");}else{if(window.PointerEvent){this.supportedEventTypes.push("PointerEvent");}}if(window.MouseEvent){this.supportedEventTypes.push("MouseEvent");}return this;},startNewSessions:function AH(Aj){var An=this;var Al=this;var Ak=document;var Am=function(Ax){var As=Aj.callbacks.start.bind(Aj.callbackThis),At=Aj.callbacks.change.bind(Aj.callbackThis),Au=Aj.callbacks.end.bind(Aj.callbackThis),Aw=Aj.callbacks.context;var Ap={};Ap.identifier=Ax.identifier;Ap.context=X.clone(Aw);Ap.clientX=Ax.clientX;Ap.clientY=Ax.clientY;var Ar=function Ar(Ay){var Az=this.context;return As({api:Al,event:Ay,session:this,context:Az});};var Av=function Av(Az,Ay){var A0=this.context,A2=0,A1=0;A2=Ay.clientX-this.clientX;A1=Ay.clientY-this.clientY;this.clientX=Ay.clientX;this.clientY=Ay.clientY;var A3={api:Al,event:Az,deltaX:A2,deltaY:A1,session:this,context:A0};return At(A3);};var Aq=function Aq(Ay){var Az=this.context;return Au({api:Al,event:Ay,session:this,context:Az});};Ap.onStart=Ar;Ap.onChange=Av;Ap.onEnd=Aq;return Ap;};var Ao=function(Aq,Ap){Aq.listeners={};Aq.listeners.change=function(Ar){var As=An.getChangedSessions(Ar);for(var At=0;At<As.length;At++){if(Aq.identifier===As[At].identifier){return An.sessions[Aq.identifier].onChange(Ar,As[At]);}}};Aq.listeners.end=function(As){var At=An.getChangedSessions(As);for(var Au=0;Au<At.length;Au++){if(Aq.identifier===At[Au].identifier){if(window.TouchEvent&&window.TouchEvent.prototype.isPrototypeOf(Ap)){Ak.removeEventListener("touchmove",Aq.listeners.change);Ak.removeEventListener("touchend",Aq.listeners.end);Ak.removeEventListener("touchcancel",Aq.listeners.end);}else{if(window.PointerEvent&&window.PointerEvent.prototype.isPrototypeOf(Ap)&&(Ap.pointerType&&Ap.pointerType!=="mouse")){Ak.removeEventListener("pointermove",Aq.listeners.change);Ak.removeEventListener("pointerleave",Aq.listeners.end);Ak.removeEventListener("pointerup",Aq.listeners.end);}else{if(window.MouseEvent&&window.MouseEvent.prototype.isPrototypeOf(Ap)&&!Ap.pointerType){Ak.removeEventListener("mousemove",Aq.listeners.change);Ak.removeEventListener("mouseup",Aq.listeners.end);}}}var Ar=An.sessions[Aq.identifier].onEnd(As);delete An.sessions[Aq.identifier];return Ar;}}};if(window.TouchEvent&&window.TouchEvent.prototype.isPrototypeOf(Ap)){Ak.addEventListener("touchmove",Aq.listeners.change);Ak.addEventListener("touchend",Aq.listeners.end);Ak.addEventListener("touchcancel",Aq.listeners.end);}else{if(window.PointerEvent&&window.PointerEvent.prototype.isPrototypeOf(Ap)&&(Ap.pointerType&&Ap.pointerType!=="mouse")){Ak.addEventListener("pointermove",Aq.listeners.change);Ak.addEventListener("pointerleave",Aq.listeners.end);Ak.addEventListener("pointerup",Aq.listeners.end);}else{if(window.MouseEvent&&window.MouseEvent.prototype.isPrototypeOf(Ap)&&!Ap.pointerType){Ak.addEventListener("mousemove",Aq.listeners.change);Ak.addEventListener("mouseup",Aq.listeners.end);}}}};return function(Ar){var As=An.getChangedSessions(Ar),Aq=An.sessions,At=As.filter(function(Au){if(Aq[Au.identifier]){return false;}else{return true;}});At.forEach(function(Au){An.sessions[Au.identifier]=Am(Au);Ao(An.sessions[Au.identifier],Ar);});var Ap=[];At.forEach(function(Au){Ap.push(An.sessions[Au.identifier].onStart(Ar));});return Ap;};},newInstance:function AM(Am,Ap,Ao){var Al,Ak,Aj=this.getInstanceIndex(Am);if(Aj!==-1){for(Al=0;Al<this.supportedEventTypes.length;Al++){Ak=this.supportedEventTypes[Al];if(Ak==="TouchEvent"){Am.removeEventListener("touchstart",this.instances[Aj].starter);}else{if(Ak==="PointerEvent"){Am.removeEventListener("pointerdown",this.instances[Aj].starter);}else{if(Ak==="MouseEvent"){Am.removeEventListener("mousedown",this.instances[Aj].starter);}}}}delete this.instances[Aj];}var An={domNode:Am,callbacks:Ap,callbackThis:Ao};An.starter=this.startNewSessions(An);if(Aj!==-1){this.instances[Aj]=An;}else{this.instances.push(An);}for(Al=0;Al<this.supportedEventTypes.length;Al++){Ak=this.supportedEventTypes[Al];if(Ak==="TouchEvent"){Am.addEventListener("touchstart",An.starter);}else{if(Ak==="PointerEvent"){Am.addEventListener("pointerdown",An.starter);}else{if(Ak==="MouseEvent"){Am.addEventListener("mousedown",An.starter);}}}}return this;},getInstanceIndex:function J(Aj){return S.find(this.instances,"domNode",Aj);},getInstance:function o(Ak){var Aj=this.getInstanceIndex(Ak);return this.instances[Aj];},getChangedSessions:function AF(Aj){var Ak=[];if(window.TouchEvent&&window.TouchEvent.prototype.isPrototypeOf(Aj)){var An=Aj.changedTouches;for(var Al=0;Al<An.length;Al++){var Am={};Am.identifier=An[Al].identifier;Am.clientX=An[Al].clientX;Am.clientY=An[Al].clientY;Ak.push(Am);}}else{if(window.PointerEvent&&window.PointerEvent.prototype.isPrototypeOf(Aj)&&(Aj.pointerType&&Aj.pointerType!=="mouse")){Ak.push({identifier:Aj.pointerId,clientX:Aj.clientX,clientY:Aj.clientY,});}else{if(window.MouseEvent&&window.MouseEvent.prototype.isPrototypeOf(Aj)&&!Aj.pointerType){Ak.push({identifier:"mouse",clientX:Aj.clientX,clientY:Aj.clientY,});}}}return Ak;}};var t=H.init();mstrmojo.VisUtility=mstrmojo.provide("mstrmojo.VisUtility",{getCache:function(){return JSON.stringify(q);},getUpdateColorMapAction:function(Ak,Aj){return L.call(this,Ak,Aj);},measureTextSize:function(Ak,Aj,Al){return{width:this.measureTextWidth(Ak,Aj,Al),height:this.measureTextHeight(Ak,Aj,Al)};},measureTextWidth:function(Am,Al,An,Ak,Aj){if(AE.isIE||AE.isIEW3C){return this.measureTextWidthWithSpan(Am,Al,An,Ak,Aj);}return this.measureTextWidthWithCanvas(Am,Al,An);},measureTextWidthWithCanvas:function(Am,An,Aq,Ao){Ao=Ao||false;if(Am===""){return 0;}if(Am===" "){Am="\u00A0";}var Ap=An.fontFamily,As=An.fontSize,Al=An.fontStyle,Ar=An.fontWeight;if(typeof As==="number"){As+="pt";}Al=Al||"normal";Ar=Ar||"normal";Aq=Aq||0;var Ak=Ao?undefined:w(f,[Ap,As,Al,Ar,Am]);if(!Ak){if(!N){N=document.createElement("canvas");N.width=0;N.height=0;N.id="vis-measure-canvas";N.style.position="absolute";N.style.top="0";N.style.fontSize="medium";document.body.appendChild(N);}var Aj=N.getContext("2d");Aj.font=Al+" "+Ar+" "+As+" "+this.surroundWithQuotes(Ap);Ak=Math.ceil(Aj.measureText(Am).width);G(f,[Ap,As,Al,Ar,Am],Ak);}return Ak+Aq;},measureTextWidthQuick:function(Am,An,Aq,Ao){Ao=Ao||false;if(Am===""){return 0;}if(Am===" "){Am="\u00A0";}var Ap=An.fontFamily,As=An.fontSize,Al=An.fontStyle,Ar=An.fontWeight;if(typeof As==="number"){As+="pt";}Al=Al||"normal";Ar=Ar||"normal";Aq=Aq||0;var Ak=Ao?undefined:w(f,[Ap,As,Al,Ar,Am]);if(!Ak){if(!N){N=document.createElement("canvas");N.width=0;N.height=0;N.id="vis-measure-canvas";N.style.position="absolute";N.style.top="0";N.style.fontSize="medium";document.body.appendChild(N);}var Aj=N.getContext("2d");Aj.font=Al+" "+Ar+" "+As+" "+this.surroundWithQuotes(Ap);Ak=Math.ceil(Aj.measureText(Am).width);G(f,[Ap,As,Al,Ar,Am],Ak);}return Ak+Aq;},measureTextWidthWithSpan:function(Am,An,Ar,At,Ao,Aj){if(Am===""){return 0;}if(Am===" "){Am="\u00A0";}var Ap=An.fontFamily,Au=An.fontSize,Al=An.fontStyle,Aq=An.fontWeight;if(typeof Au==="number"){Au+="px";}Al=Al||"normal";Aq=Aq||"normal";At=At||"auto";Ar=Ar||0;Ao=!!Ao;if(typeof At==="number"){At+="px";}var Ak=w(M,[Ap,Au,Al,Aq,At,Am]);if(!Ak||Aj){var As;if(!E){E=document.createElement("span");As=E.style;E.id="vis-measure-span";As.position="absolute";As.top="0";As.visibility="hidden";As.width="auto";As.height="auto";if(Ao){As.whiteSpace="nowrap";}else{As.whiteSpace="normal";}document.body.appendChild(E);}As=E.style;if(Ao){As.whiteSpace="nowrap";}else{As.whiteSpace="normal";}As.width="auto";As.height=At;As.fontFamily=this.surroundWithQuotes(Ap);As.fontSize=Au;As.fontStyle=Al;As.fontWeight=Aq;E.innerHTML=c.encodeHtmlString(Am);Ak=Math.ceil(E.clientWidth);G(M,[Ap,Au,Al,Aq,At,Am],Ak);}return Ak+Ar;},measureTextHeight:function(Al,Am,Ar,Au,Aj,Ao,An){if(Al===""){return 0;}if(Al===" "){Al="\u00A0";}var Ap=Am.fontFamily,Aw=Am.fontSize,Ak=Am.fontStyle,Aq=Am.fontWeight,At=Am.lineHeight||"inherit";Aj=Aj||"normal";An=!!An;if(typeof Aw==="number"){Aw+="px";}Ak=Ak||"normal";Aq=Aq||"normal";Au=Au||"auto";Ar=Ar||0;if(typeof Au==="number"){Au+="px";}var Av=Ao?undefined:w(q,[Ap,Aw,Ak,Aq,Au,Al]);if(!Av){var As;if(!E){E=document.createElement("span");As=E.style;E.id="vis-measure-span";As.position="absolute";As.top="0";As.visibility="hidden";As.width="auto";As.height="auto";if(An){As.whiteSpace="nowrap";}else{As.whiteSpace="normal";}document.body.appendChild(E);}As=E.style;if(An){As.whiteSpace="nowrap";}else{As.whiteSpace="normal";}As.heigth="auto";As.width=Au;As.lineHeight=At;As.fontFamily=this.surroundWithQuotes(Ap);As.fontSize=Aw;As.fontStyle=Ak;As.fontWeight=Aq;As.wordBreak=Aj;E.innerHTML=c.encodeHtmlString(Al);Av=E.clientHeight;if(!Ao){G(q,[Ap,Aw,Ak,Aq,Au,Al],Av);}}return Av+Ar;},getVisEmptyMsg:function(Aj,Ak){var Al="";switch(Aj){case"AE_ERROR":Al='<div class="gm-vis-msg-container"><div class="gm-vis-msg-vcenter"><div class="gm-vis-msg-hcenter"><div style="padding:25px"><div class="gm-warning-icon" style="padding-bottom:18px"></div><div style="padding-bottom:8px">'+(Ak||this.errorMsg||"")+"</div><div></div></div></div></div></div>";break;case"NODATA_OTHERERROR":Al='<div class="error-msg"><div class="error-content"><div class="text" style="visibility: visible;padding-top:0px;"><div>'+(this.errorMsg||mstrmojo.desc(2388,"No data returned for this view. This might be because the applied filter excludes all data."))+"</div></div></div></div>";break;default:Al='<div class="mstrmojo-Label dropMsg" style="display: block;" >'+mstrmojo.desc(11668,"Drag objects here.")+"</div>";}return Al;},getVisEmptyMsgControls:function B(){var Al=this.error,Aq,Ao=this.errorType,Ak;var Am=mstrmojo.VisUtility;if(this.excludeData){Aq=Am.getVisStyle.call(this);var An=Am.getAttMetricCount.call(this);return[{scriptClass:"mstrmojo.vi.ui.rw.FreezingImageContainer",cssClass:Aq,visName:mstrConfig.pluginsVisList[Aq]&&mstrConfig.pluginsVisList[Aq].d,visDropzoneMsg:D.getVisDropzoneMsg(An.attCount,An.metricCount)}];}if(!this.hasError()){return ;}switch(Ao){case Ah.NO_DATASET:case Ah.NO_TEMPLATE_UNIT:if(mstrApp&&mstrApp.supportFeature&&mstrApp.supportFeature(AO.SUPPORT_GHOST_IMG)){Aq=Am.getVisStyle.call(this);var Ar="",Ap="",Aj="";if(Aq===x.HEAT_MAP){Ar="heatmap";Ap=mstrmojo.desc(11819,"Heat Map");Aj=Ac.getVisDesc("heatmap");}else{if(Aq===x.NETWORK){Ar="network";Ap=mstrmojo.desc(11827,"Network");Aj=Ac.getVisDesc("network");}else{if(Aq===x.KPICARD){Ar="kpicard";Ap=mstrmojo.desc(15800,"KPI");Aj=Ac.getVisDesc("kpicard");}}}Ak=[{scriptClass:"mstrmojo.vi.ui.rw.GhostImageContainer",cssClass:Ar,visName:Ap,visDesc:Aj}];}else{Ak=[{scriptClass:"mstrmojo.Label",cssClass:"dropMsg",text:Al}];}break;case Ah.AE_ERROR:Ak=[{scriptClass:"mstrmojo.Container",cssClass:"error-msg",markupString:Am.getVisEmptyMsg("AE_ERROR",Al),markupSlots:{containerNode:function(){return this.domNode;}}}];break;default:Ak=[{scriptClass:"mstrmojo.Container",cssClass:"error-msg",markupString:'<div class="{@cssClass}"><div class="error-content" style="visibility: visible">'+Al+"</div></div>",markupSlots:{containerNode:function(){return this.domNode;}}}];break;}return Ak;},applyStyles2DomNode:function(Ao,Ar){var Aj,Ap=Ao.style;if(Object.prototype.hasOwnProperty.call(Ar,"backgroundColor")&&Ar.backgroundColor!==""&&Ar.backgroundColor!=="transparent"){var An=1;if(Object.prototype.hasOwnProperty.call(Ar,"opacity")&&Ar.opacity!==""){An=Ar.opacity;}var Ak=Ar.backgroundColor,Aq=function Aq(As){if(isNaN(As)){As=0;}As%=16777216;return{b:As%256,g:(As>>8)%256,r:(As>>16)%256};},Am="";if(Ak){var Al=function Al(At,Au){if(At==="transparent"){return"rgba(0,0,0,0)";}At=this.parseCSSColor(At,false);var As=Aq(At);return"rgba("+As.r+" ,"+As.g+" ,"+As.b+" ,"+Au+" )";}.bind(this);if(Ak.c1!==undefined&&Ak.c2!==undefined&&Ak.or!==undefined){Am=(Ad.buildGradient(Ak.or,Al(Ak.c1,An),Al(Ak.c2,An))).v;}else{Am=Al(Ak,An);}Ap.background=Am;}}else{Ap.backgroundColor="rgba(0,0,0,0)";}for(Aj in Ar){if(Aj!=="backgroundColor"&&Aj!=="opacity"&&Object.prototype.hasOwnProperty.call(Ar,Aj)&&Ar[Aj]&&Ar[Aj]!==""){Ap[Aj]=Ar[Aj];if(Aj==="fontFamily"){Ap[Aj]="'"+Ar[Aj]+"'";}}}},parseCSSColor:function(An,Ak){var Aj,Al;if(An.length===7){if(Ak===true){Aj=An[5]+An[6]+An[3]+An[4]+An[1]+An[2];}else{Aj=An.slice(1);}}else{Aj=[];var Am=An.slice(1);if(Ak===true){for(Al=2;Al>=0;Al--){Aj.push(Am[Al]);Aj.push(Am[Al]);}}else{for(Al=0;Al<3;Al++){Aj.push(Am[Al]);Aj.push(Am[Al]);}}Aj=Aj.join("");}return parseInt(Aj,16);},positionDomNode:function(Al,An){var Ak,Aq,Ao,Am=["width","height","top","left","right","bottom"],Ap=Am.length,Aj=Al.style;for(Ak=0;Ak<Ap;Ak++){Aq=Am[Ak];Ao=An[Aq];if(Ao!==undefined){if((typeof Ao)==="number"){Ao+="px";}Aj[Aq]=Ao;}}},getComputedFontStyle:function K(Al){var Aj=mstrmojo.css.getComputedStyle(Al);var Am={};Am.fontFamily=Aj.fontFamily;Am.fontSize=Aj.fontSize;Am.fontStyle=Aj.fontStyle;Am.fontWeight=Aj.fontWeight;Am.fontVariant=Aj.fontVariant;var Ak=parseInt(Aj.paddingLeft)||0,An=parseInt(Aj.paddingLeft)||0;Am.bonus=Ak+An;return Am;},splitWordIfTooLong:function(At,Ar,Am){var Ap=[];var Aq=At.length;var An;for(An=0;An<Aq;An++){var Ak=At[An];while(true){var Au=this.measureTextWidth(Ak,Am);if(Au>Ar){var As=(Ar/Au)*Ak.length;var Aj=Math.max(Math.round(As),1);while(Aj>0){var Ao=Ak.substr(0,Aj);var Al=Math.round(this.measureTextWidth(Ao,Am));if(Al<=Ar||Aj===1){Ap.push(Ao);break;}else{Aj--;}}Ak=Ak.substr(Aj,Ak.length-Aj);}else{Ap.push(Ak);break;}}}return Ap;},truncateTextToLineWithWordWrap:function k(A9,A2,A0,Ap,A1,At){var Ax=A9.split(" "),A3=Ax.length;if(!At){Ax=this.splitWordIfTooLong(Ax,A0,A2);}var BG,Av=[],BB=[],Aj=0,An=Ax.length,BI=this.measureTextWidth(" ",A2),Am=0,As=false,Az=(A3===Ax.length);BB.push(0);for(BG=0;BG<An;BG++){var A7=this.measureTextWidth(Ax[BG],A2);if(!At&&A7>A0){var Ak=Ax[BG];var BE=(A0/A7)*Ak.length;Ax[BG]=Ak.substr(0,parseInt(BE,10));A7=A0;}Av.push(A7);Aj+=A7;BB.push(Aj);if(BG!==An-1){Aj+=BI;}}var BD,BF,A5=Ap;for(BD=0,BF=0;BF<BB.length;){var Ar=BB[BF]-BB[BD];if(BD>0&&BF!==BD){Ar-=BI;}var Aq=BB[BF+1]-BB[BD];if(BD>0&&BF+1!==BD){Aq-=BI;}if(Ar<=A0&&((BF+1===BB.length)||(Aq>A0))){Am=Math.max(Am,Ar);A5--;if(A5===0||BF===An){break;}else{BD=BF;BF++;}}else{BF++;}}if(BF>An){BF=An;}var Au=BB[BF]-BB[BD];if(BD>0&&BF!==BD){Au-=BI;}var A8;if(BF>=An&&Au<A0){A8=Ax.join(" ");}else{As=true;Am=A0;A8=Ax.slice(0,BF).join(" ");var Aw=this.measureTextWidth("...",A2);if(Au+Aw<=A0){if(Au+BI+Aw>A0){A8+="...";}else{var BH=Ax[BF],Ay;for(var A4=1;A4<BH.length;A4++){Ay=this.measureTextWidth(BH.substr(0,A4),A2);if(Au+BI+Ay+Aw>A0){break;}}A8+=" "+BH.substr(0,A4-1)+"...";}}else{if(A8.charAt(A8.length-1)===" "){A8=A8.substr(0,A8.length-1);}var A6=A8.lastIndexOf(" ");var Al=A8.length-1-A6;if(Al===3){A8=A8.substr(0,A8.length-3)+" ...";}else{var BA=0,Ao="",BC=0;while(BA<Aw&&A8.length>BC){BC++;Ao=A8.substr(A8.length-BC,A8.length);BA=this.measureTextWidth(Ao,A2);}A8=A8.substr(0,A8.length-BC)+"...";}}}if(A1){return{text:A8,truncated:As,maxLineLen:Am,canWordWrap:Az};}return A8;},measureSuperTextWidth:function z(Ak,Al,Aj,Am){return Ak?this.measureTextWidth("<sup>"+Al+"</sup>",Aj,Am):this.measureTextWidth(Al,Aj,Am);},splitTokenIfTooLong:function h(Au,As,Am){var Aq=[];var Ar=Au.length;var An,Ak,Av,Ap,Aw;for(An=0;An<Ar;An++){Ak=Au[An];Ap=Ak.isSuper;while(true){Av=Ak.v;if(Ak.textWidth!==undefined){Aw=Ak.textWidth;}else{Aw=Ak.textWidth=this.measureSuperTextWidth(Ap,Av,Am);}if(Aw>As){var At=(As/Aw)*Av.length;var Aj=Math.max(Math.round(At),1);while(Aj>0){var Ao=Av.substr(0,Aj);var Al=Math.round(this.measureSuperTextWidth(Ap,Ao,Am));if(Al<=As||Aj===1){Aq.push({v:Ao,isSuper:Ap,textWidth:Al});break;}else{Aj--;}}Ak={v:Av.substr(Aj,Av.length-Aj),isSuper:Ap};}else{Aq.push(Ak);break;}}}return Aq;},truncateTextToLineWithWordWrapForTokens:function AY(At,An,BC,A4,BD,Az){var A7=At.length;At=this.splitTokenIfTooLong(At,BC,An);var BB,Ay=[],Aj=0,A2=At.length,Ak=0,A3=false,Ap=(A7===At.length),Ar,Aw,A5,Al,A9,As,Ax;if(Az&&!Ap){return{canWordWrap:Ap};}Ay.push(0);for(BB=0;BB<A2;BB++){Ar=At[BB];A5=Ar.v;Aw=Ar.isSuper;if(Ar.textWidth!==undefined){Al=Ar.textWidth;}else{Al=Ar.textWidth=this.measureSuperTextWidth(Aw,A5,An);}if(Al>BC){var BA=(BC/Al)*A5.length;Ar.v=A5.substr(0,parseInt(BA,10));Al=Ar.textWidth=BC;}Aj+=Al;Ay.push(Aj);}var Av,A6,Au=A4;for(Av=0,A6=0;A6<Ay.length;){var Aq=Ay[A6]-Ay[Av];var Ao=Ay[A6+1]-Ay[Av];if(Aq<=BC&&((A6+1===Ay.length)||(Ao>BC))){Ak=Math.max(Ak,Aq);Au--;if(Au===0||A6===A2){break;}else{Av=A6;A6++;}}else{A6++;}}if(A6>A2){A6=A2;}var A1=Ay[A6]-Ay[Av];var BE;if(A6>=A2&&A1<BC){BE=At;}else{A3=true;Ak=BC;BE=At.slice(0,A6);var Am=this.measureTextWidth("...",An);if(A1+Am<=BC){As=At[A6];A5=As.v;Aw=As.isSuper;for(A9=1;A9<A5.length;A9++){Ax=this.measureSuperTextWidth(Aw,A5.substr(0,A9),An);if(A1+Am+Ax>BC){break;}}if(A9>1){Ar={v:A5.substr(0,A9-1),isSuper:Aw};Ar.textWidth=this.measureSuperTextWidth(Aw,Ar.v,An);BE.push(Ar);BE.push({v:"...",textWidth:Am});}}else{var A0=0,A8;for(BB=BE.length-1;BB>=0;BB--){Ar=BE[BB];A5=Ar.v;Aw=Ar.isSuper;A8=0;for(A9=A5.length-1;A9>=0;A9--){A8=this.measureSuperTextWidth(Aw,A5.substr(A9),An);if(A0+A8>=Am){break;}}if(A9>=0){break;}else{A0+=A8;}}if(BB>=0){if(A9>0){Ar.v=A5.substr(0,A9);Ar.textWidth=this.measureSuperTextWidth(Aw,Ar.v,An);BE=BE.slice(0,BB+1);}else{if(A9===0){BE=BE.slice(0,BB);}}BE.push({v:"...",textWidth:Am});}else{BE=[{v:"...",textWidth:Am}];}}}if(BD){return{text:BE,truncated:A3,maxLineLen:Ak,canWordWrap:Ap};}return BE;},getRankMode:function O(Ap){var Ar=1,Aq=2,Ao=3,Ak=4,Am=5,Aj=6,An=7,Al=V.INVALID;if(Ap){if(AU(Ap,Ao,Aq)){Al=V.TOP_PERCENT;}else{if(AU(Ap,Ao,Ar)){Al=V.BOTTOM_PERCENT;}else{if(AU(Ap,Aj,Ak)){Al=V.BOTTOM;}else{if(AU(Ap,Aj,Am)){Al=V.TOP;}else{if(AU(Ap,An)){Al=V.VALUE;}}}}}}return Al;},getColorByTitle:function a(Ak,Aj){if(Aj===V.BOTTOM_PERCENT||Aj===V.TOP_PERCENT){Ak=mstrmojo.desc(2787,"Percentage of ##").replace("'##'",Ak);}else{if(Aj===V.BOTTOM||Aj===V.TOP){Ak=mstrmojo.desc(2788,"Rank of ##").replace("'##'",Ak);}}return Ak;},getColorByFormatStr:function g(Ak,Aj){if(Aj===V.BOTTOM_PERCENT||Aj===V.TOP_PERCENT){Ak="0%;(0%)";}else{if(Aj===V.BOTTOM||Aj===V.TOP){Ak="";}}return Ak;},getColorByItems:function AZ(Aj,At,A0,Aw,Ar,Ap,Ax){var Av=[],A1,Al,Aq=mstrmojo.num,Ao,As;if(Aj===undefined||Aj.length===0){return Av;}var A3=true;if(Aj.length>1){if(Aj[0].ceil===Aj[1].flr){A3=false;}else{A3=true;}}for(A1=0;A1<Aj.length;A1++){var A2=Aj[A1],An={},Ak=A2.ceil,Az=A2.flr;if((A1===0&&A3)||(A1===Aj.length-1&&!A3)){if(At===V.BOTTOM_PERCENT||At===V.TOP_PERCENT){An.flr=Az/100;An.ceil=1;}else{if(At===V.TOP||At===V.BOTTOM){Az+=1;An.flr=Math.floor(Az);An.ceil=Ar;}else{An.flr=Az;An.ceil=A0;}}As=An.ceil;}else{if((A1===0&&!A3)||(A1===Aj.length-1&&A3)){if(At===V.BOTTOM_PERCENT||At===V.TOP_PERCENT){An.flr=0;An.ceil=Ak/100;}else{if(At===V.TOP||At===V.BOTTOM){An.flr=0;An.ceil=Math.floor(Ak);}else{An.flr=Aw;An.ceil=Ak;}}Ao=An.flr;}else{if(At===V.BOTTOM_PERCENT||At===V.TOP_PERCENT){Az=Az/100;Ak=Ak/100;}else{if(At===V.TOP||At===V.BOTTOM){Az+=1;Az=Math.floor(Az);Ak=Math.floor(Ak);}}An.flr=Az;An.ceil=Ak;}}if(At===V.TOP||At===V.BOTTOM){An.ceil=An.ceil>Ar?Ar:An.ceil;}if(Ap){An.label=Aq.formatByMask(Ap,An.flr);if(An.flr!==An.ceil){An.label+=" - "+Aq.formatByMask(Ap,An.ceil);}}else{An.label=An.flr;if(An.flr!==An.ceil){An.label+=" - "+An.ceil;}}if(A2.fmt&&A2.fmt.bc){An.color=A2.fmt.bc;}else{An.color=Ax;}Av.push(An);}Av=Av.filter(function(A4){return A4.flr<=A4.ceil&&!(A4.flr>As||A4.ceil<Ao);});if(At!==V.VALUE){if(Av[0]&&(Av[0].label===0)){Av.shift();}}if(At===V.TOP||At===V.BOTTOM){Al=Ar;}else{if(Av.length>0){if(A3){Al=Av[0].ceil-Av[(Av.length-1)].flr;}else{Al=Av[(Av.length-1)].ceil-Av[0].flr;}}}var Ay=0,Au,Am;for(A1=0;A1<Av.length;A1++){if(A1===Av.length-1){Av[A1].scopePercent=1-Ay;}else{if(At===V.TOP||At===V.BOTTOM){Am=Av[A1].ceil-Av[A1].flr+1;}else{Am=Av[A1].ceil-Av[A1].flr;}Au=Am/Al;Av[A1].scopePercent=Au;Ay+=Au;}}return Av;},getDefaultColorByItems:function(Am,Ak,Al){var Aj={};Aj.label=Al+" - "+Ak;Aj.flr=Al;Aj.ceil=Ak;Aj.color=Am;Aj.scopePercent=1;return[Aj];},getNumberFormat:function(Am,Ak){var An=Am.nf,Al=Am.gvs;function Aj(){var Aq=(Al&&Al.items&&Al.items[0]&&Al.items[0].items)||[],Ap=Aq[Ak]||{},Ao=Ap.nfs;return typeof Ao==="string"?Ao:"";}if(An[Ak]&&typeof An[Ak].nfs!=="string"){An[Ak].nfs=Aj();}return An[Ak]&&An[Ak].nfs;},hasOnlyMetricsOnColumn:function(Ak){var Aj=(Ak&&Ak.gts&&Ak.gts.col)||[];return Aj.every(function(Al){return Al.otp===p.DssTypeUnknown&&(Al.es||[]).every(function(Am){return Am.otp===p.DssTypeMetric;});});},hasNoMetricOnRow:function(Ak){var Al=(Ak&&Ak.gts&&Ak.gts.row)||[],Aj=function(Am){return Am.otp!==p.DssTypeMetric;};return Al.every(Aj);},getAttMetricCount:function(){var Am=this.getEditingGridData&&this.getEditingGridData()||this.model&&this.model.data,Aq=Am&&Am.gsi,Ap=Aq&&Aq.rows||[],Al=Aq&&Aq.cols||[],Ak=[].concat(Ap).concat(Al),Ao=Aq&&Aq.mx||[],Aj=0,An=Ao.length;Af.forEach(Ak,function(Ar){if(Ar.t!==p.DssTypeMetric){Aj++;}});return{attCount:Aj,metricCount:An};},isOnExpressMode:function(){return mstrApp.isExpress;},modifyScExp:function(Ar,Aj,Av,Ap){if(!Ar||!Aj){return ;}var Am=Ar.nds,Aq,Ak,As,Au,At,Ao,An,Al;Af.forEach(Am||[],function(Aw){Aq=Aw.nds;Af.forEach(Aq||[],function(Ax){Ak=Ax.es;Af.forEach(Ak||[],function(Ay){Au=Ay.v;Ao=Ap[Au];if(!Ao){Ao=Av.getNormalizedFormElementId(Au);Ap[Au]=Ao;}Af.forEach(Aj||[],function(Az){As=Az.es;Af.forEach(As||[],function(A0){Al=false;At=A0.id;if(At===Au){Al=true;}else{An=Ap[At];if(!An){An=Av.getNormalizedFormElementId(At);Ap[At]=An;}if(Ao===An){Al=true;}}if(Al){Ay.v=A0.id;Ay.n=A0.n;return false;}});if(Al){return false;}});});});});},modifyScExpDeprecated:function(Ap,Aq,An,Al){if(!Ap||!Aq){return ;}var Am=Ap.nds,Ak,Aj,Ao;Af.forEach(Am||[],function(Ar){Ak=Ar.nds;Af.forEach(Ak||[],function(As){Aj=As.es;Af.forEach(Aj||[],function(At){Af.forEach(Aq||[],function(Au){Af.forEach(Au||[],function(Av){Ao=Av.es;Af.forEach(Ao||[],function(Aw){if(An.call(Al,Aw.id,At.v)){At.v=Aw.id;At.n=Aw.n;}});});});});});});},getMouseOffset:function(Ak){var Aj=(Ak.offsetX!==undefined)?Ak.offsetX:(Ak.layerX),Al=(Ak.offsetY!==undefined)?Ak.offsetY:(Ak.layerY);return{x:Aj,y:Al};},translateLineStyle:function(Aj){var Al=["none","solid","solid","dashed","dotted"],Ak=["1px","1px","2px","1px","1px"];return{width:Ak[Aj]||"0px",style:Al[Aj]||"none"};},getVisStyle:function(){var Aj=mstrmojo.VisUtility;return Aj.getPropertyByPath(this,"model.data.visName")||Aj.getPropertyByPath(this,"model.data.vis.vn");},getGroupAndCalculationContextMenuForDataPoints:function(Au,A8){var Aw,Ay=[],Al=[],A5=[],Aq=A8.fnCellName,A0=A8.fnUnique,Ap=A8.fnMakeNode,A3=Au.getCellForNode.bind(Au),BA=A8.selection;var Ao=new e.ui.menus.MenuConfig(),Ak=new e.ui.menus.MenuConfig(),A2=new e.ui.menus.MenuConfig(),A7=new e.ui.menus.MenuConfig();function A9(BB){Au.cmSelCells=Ay[BB].cmSelCells;Au.derivedElementGroup(A3(Au.cmSelCells[0]));}function Ar(BD){Au.cmSelCells=Al[BD].cmSelCells;var BC=A3(Al[BD].cmSelCells[0]),BB=Au.getDEInfo(BC);Au.derivedElementsEdit(A3(Au.cmSelCells[0]),BB);}function Az(BC){Au.cmSelCells=Al[BC].cmSelCells;var BB=A3(Al[BC].cmSelCells[0]);Au.removeQuickDE(BB);}function Ax(BC){Au.cmSelCells=Al[BC].cmSelCells;var BB=A3(Al[BC].cmSelCells[0]);Au.renameDEList(BB);}function A1(BB){W(Au,A3(Au.cmSelCells[0]),null,BB,false);}function Aj(BB){W(Au,A3(Au.cmSelCells[0]),null,BB,true);}function An(BC){var BB=A3(Al[BC].cmSelCells[0]);Au.removeQuickDE(BB);}function A6(BC){var BB=A3(Al[BC].cmSelCells[0]);Au.editDECalculation(BB);}function As(BC,BB){return function(){var BD=new e.ui.menus.MenuConfig();BD.addNonInteractiveMenuItem(mstrmojo.desc(11859,"Based on"),"xt",true);BD.addRadioMenuGroup(null,BC,BB,"checkMark",undefined,true);return BD;};}function Av(BB){BB=BB||[];function BC(BG){var BD=BG.extra||{},BH=BG.setup||mstrmojo.emptyFn,BE=BG.action||mstrmojo.emptyFn,BF=[];BH(BF,BD);BE(BF,BD);}BB.forEach(BC);}var Am=[{name:"group",setup:function(BB){Ay.forEach(function(BC){Au.cmSelCells=Ay[BC.v].cmSelCells;if(!Object.prototype.hasOwnProperty.call(Al,BC.v)&&Y(Au)){BB.push(BC);}});},action:function(BC){var BB;if(BC.length===1){BB=BC[0].v;Ao.addMenuItem(mstrmojo.desc(1911,"Group"),"xt",function(){Au.cmSelCells=Ay[BB].cmSelCells;Au.derivedElementGroup(A3(Au.cmSelCells[0]));});}if(BC.length>1){Ao.addPopupMenuItem(mstrmojo.desc(1911,"Group"),Au.id,As(A9,BC),"xt");}}},{name:"edit-group",setup:function(BB){Al.forEach(function(BF){var BE=A3(Al[BF.v].cmSelCells[0]),BD=Au.getDEInfo(BE),BC=BD&&BD.de;if(BC&&BC.t===U.LIST){BB.push(BF);}});},action:function(BC){var BB,BE,BD;if(BC.length===1){BB=Al[BC[0].v].cmSelCells;BE=A3(BB[0]);BD=Au.getDEInfo(BE);Ak.addMenuItem(mstrmojo.desc(13395,"Edit Group..."),"xt",function(){Au.cmSelCells=BB;Au.derivedElementsEdit(A3(Au.cmSelCells[0]),BD);});Ak.addMenuItem(mstrmojo.desc(12195,"Ungroup"),"xt",function(){Au.cmSelCells=BB;Au.removeQuickDE(BE);});A7.addMenuItem(mstrmojo.desc(13968,"Rename Group..."),"xt",function(){Au.cmSelCells=BB;Au.renameDEList(BE);});}if(BC.length>1){Ak.addPopupMenuItem(mstrmojo.desc(13395,"Edit Group..."),Au.id,As(Ar,BC),"xt");Ak.addPopupMenuItem(mstrmojo.desc(12195,"Ungroup"),Au.id,As(Az,BC),"xt");A7.addPopupMenuItem(mstrmojo.desc(13968,"Rename Group..."),Au.id,As(Ax,BC),"xt");}}},{name:"calculation",setup:function(BB){A5.forEach(function(BE,BD,BC){Au.cmSelCells=BC[BE.v].cmSelCells;var BG=A3(Au.cmSelCells[0]),BF=Au.getDEInfo(BG),BH=BF&&BF.de;if(!(BH&&BH.t===U.RESIDUE)&&l(Au)){BB.push(BE);}});},action:function(BB){if(BB.length===1){Ao.addPopupMenuItem(mstrmojo.desc(5188,"Calculation"),Au.id,function(){var BC=BB[0].v,BD=new e.ui.menus.MenuConfig();Au.cmSelCells=A5[BC].cmSelCells;BD.addRadioMenuGroup(null,A1,m(Au,null,Aq).items,"checkMark",undefined,true);return BD;},"xt");}if(BB.length>1){Ao.addPopupMenuItem(mstrmojo.desc(5188,"Calculation"),Au.id,function(){return new mstrmojo.ui.menus.EditorConfig({cssClass:"base-on-calculation-editor",data:{},hasToggleItem:true,contents:[{scriptClass:"mstrmojo.Label",text:mstrmojo.desc(11859,"Based on")},{scriptClass:"mstrmojo.ui.Pulldown",alias:"attrList",items:BB,selectedIndex:0,onitemSelected:function(BC){var BD=BC.v;Au.cmSelCells=A5[BD].cmSelCells;this.parent.checkList.set("items",[]);this.parent.checkList.set("items",m(Au,null,Aq).items);this.parent.data.set("valid",false);}},{scriptClass:"mstrmojo.VisMenuList",alias:"checkList"}],bindings:{okEnabled:"this.valid",valid:function(){return this.data.valid;}},fnOk:function(BD,BC){W(Au,A3(Au.cmSelCells[0]),null,BC.checkList.selectedItem.v,false);}});});}}},{name:"edit-calculation",setup:function(BB){Al.forEach(function(BF){var BE=A3(Al[BF.v].cmSelCells[0]),BD=Au.getDEInfo(BE),BC=BD&&BD.de;if(BC&&BC.t===U.CALCULATION&&l(Au)){BB.push(BF);}});},action:function(BB){function BC(){var BD=BB[0].v;Au.cmSelCells=Al[BD].cmSelCells;var BH=A3(Au.cmSelCells[0]),BG=Au.getDEInfo(BH),BI=BG&&BG.de,BF=m(Au,BI,Aq),BE=new e.ui.menus.MenuConfig();BE.addRadioMenuGroup(BF.selectedItem.value,Aj,BF.items,"checkMark",undefined,true);return BE;}if(BB.length===1){A2.addPopupMenuItem(mstrmojo.desc(12196,"Edit Calculation"),Au.id,BC,"xt");A2.addMenuItem(mstrmojo.desc(12197,"Delete Calculation"),"xt",function(){var BD=BB[0].v;Au.cmSelCells=Al[BD].cmSelCells;var BE=A3(Au.cmSelCells[0]);Au.removeQuickDE(BE);});A7.addMenuItem(mstrmojo.desc(13967,"Rename Calculation..."),"xt",function(){var BD=BB[0].v;Au.cmSelCells=Al[BD].cmSelCells;var BE=A3(Au.cmSelCells[0]);Au.editDECalculation(BE);});}if(BB.length>1){A2.addPopupMenuItem(mstrmojo.desc(12196,"Edit Calculation"),Au.id,function(){return new mstrmojo.ui.menus.EditorConfig({data:{},hasToggleItem:true,contents:[{scriptClass:"mstrmojo.Label",text:mstrmojo.desc(11859,"Based on")},{scriptClass:"mstrmojo.ui.Pulldown",alias:"attrList",items:BB,selectedIndex:0,onitemSelected:function(BG){var BH=BG.v;Au.cmSelCells=Al[BH].cmSelCells;var BF=A3(Au.cmSelCells[0]),BE=Au.getDEInfo(BF),BI=BE&&BE.de;var BD=m(Au,BI,Aq);this.parent.checkList.set("items",[]);this.parent.checkList.set("items",BD.items);this.parent.checkList.set("selectedItem",BD.selectedItem);this.parent.data.set("valid",false);}},{scriptClass:"mstrmojo.VisMenuList",alias:"checkList"}],bindings:{okEnabled:"this.valid",valid:function(){return this.data.valid;}},fnOk:function(BE,BD){W(Au,A3(Au.cmSelCells[0]),null,BD.checkList.selectedItem.v,true);}});});A2.addPopupMenuItem(mstrmojo.desc(12197,"Delete Calculation"),Au.id,As(An,BB),"xt");A7.addPopupMenuItem(mstrmojo.desc(13967,"Rename Calculation..."),Au.id,As(A6,BB),"xt");}}}];Aw=A0(BA);Aw.forEach(function(BC){var BE=Ap(BC),BB=A3(BE),BD,BF,BG;if(!Au.model.supportsViewFilterActions(BB.tid)){return ;}BD=BB.dei===undefined?Ay:Al;BF=BB.tid;BG=Au.model.getObjectInfo(BF).n;if(BD[BF]===undefined){BD[BF]={};BD[BF].cmSelCells=[];BD.push({n:BG,v:BF,text:BG,value:BF});}BD[BF].cmSelCells.push(BE);if(A5[BF]===undefined){A5[BF]={};A5[BF].cmSelCells=[];A5.push({n:BG,v:BF,text:BG,value:BF});}A5[BF].cmSelCells.push(BE);});var At=mstrmojo.VisUtility;var A4=At.getVisStyle.call(Au);if(A4===x.HEAT_MAP){Am.splice(2,2);}Av(Am);return{createDe:Ao,editGroup:Ak,editCalculation:A2,renameDe:A7};},getGroupAndCalculationContextMenu:function(Ar,A5,A2){var A4=Ar,Ay=A2.skipSingleAttrCheck||A4.isSingleAttrSelection(),Am=false,Ao=A4.isSingleContextMenuSelection(),As=A4.getDEInfo(A5),An=As&&As.deObject,A1=As&&As.de,Aw=An&&A4.getOthersDEInfo(An),Au=A4.getContextMenuSelections(),A0=true,Aq=A2.fnCellName,A3=this.getPropertyByPath(A4,"model.data.visName")||this.getPropertyByPath(A4,"model.data.vis.vn");var Ap=new e.ui.menus.MenuConfig(),Ak=new e.ui.menus.MenuConfig(),Av=new e.ui.menus.MenuConfig(),Az=new e.ui.menus.MenuConfig();A4.cmSelCells=A2.selection;if(Ar.model.supportsViewFilterActions(A5.tid)){if((Am||Ay)&&AS(A5,u)&&Y(A4)){Ap.addMenuItem(mstrmojo.desc(1911,"Group"),"xt",function(){Ar.derivedElementGroup(A5);});}if(Ao&&A1&&A1.t===U.LIST){Ak.addMenuItem(mstrmojo.desc(13395,"Edit Group..."),"xt",function(){Ar.derivedElementsEdit(A5,As);});Ak.addMenuItem(mstrmojo.desc(12195,"Ungroup"),"xt",function(){Ar.removeQuickDE(A5);});Az.addMenuItem(mstrmojo.desc(13968,"Rename Group..."),"xt",function(){Ar.renameDEList(A5);});}var At=function(A6){W(A4,A5,A1,A6,false);},Ax=function(A6){W(A4,A5,A1,A6,true);};if(Aw&&!Ao&&Ay){S.forEach(Au,function(A6){if(A6[0]&&A6[0].eid.indexOf(Aw.id)>-1){A0=false;return false;}});}if(A3!=="VIHeatMapVisualizationStyle"&&!(Ao&&A1&&A1.t===U.RESIDUE)&&(Am||Ay)&&AS(A5,AG)&&l(A4)){var Aj=function(){var A6=new e.ui.menus.MenuConfig(),A7=m(A4,null,Aq);A6.addRadioMenuGroup(null,At,A7.items,"checkMark",undefined,true);return A6;};Ap.addPopupMenuItem(mstrmojo.desc(5188,"Calculation"),this.id,Aj,"xt");}if(Ao&&A1&&A1.t===U.CALCULATION&&l(A4)){var Al=function(){var A6=new e.ui.menus.MenuConfig(),A7=m(A4,A1,Aq);A6.addRadioMenuGroup(A7.selectedItem.value,Ax,A7.items,"checkMark",undefined,true);return A6;};Av.addPopupMenuItem(mstrmojo.desc(12196,"Edit Calculation"),this.id,Al,"xt");Av.addMenuItem(mstrmojo.desc(12197,"Delete Calculation"),"xt",function(){Ar.removeQuickDE(A5);});Az.addMenuItem(mstrmojo.desc(13967,"Rename Calculation..."),"xt",function(){Ar.editDECalculation(A5);});}}return{createDe:Ap,editGroup:Ak,editCalculation:Av,renameDe:Az};},isHostedPopupNode:function(Am,Al,Ak,Aj){return AJ(Am,Al,"mstrmojo-popup-widget-hosted",Ak,Aj);},isMojoEditorNode:function(Am,Al,Ak,Aj){return AJ(Am,Al,"mstrmojo-Editor",Ak,Aj);},applyStyle2Legend:function(Am,Al,Ak){var Aj,Ao={},An={};for(Aj in Am){if(Aj.indexOf("font")>=0||Aj.indexOf("color")>=0||Aj.indexOf("textDecoration")>=0){Ao[Aj]=Am[Aj];}else{An[Aj]=Am[Aj];}}if(Al){Al.style.background="";this.applyStyles2DomNode(Al,An);}if(Ak){this.applyStyles2DomNode(Ak,Ao);}},mergeMenuConfigs:function AI(Ak,Aj){function Al(An,Ao,Am){if(!Ao){return ;}if(!Am&&An.hasMenuItems()&&Ao.hasMenuItems()){An.addSeparator();}if(Ao.hasMenuItems()){An.absorbMenuItems(Ao);}}return Aj.reduce(function(Am,An){Al(Am,Ak[An.name],An.noSeparator);return Am;},new mstrmojo.ui.menus.MenuConfig());},absorbMenuItems:function(Ak,Aj,Al){Ak.addDisposable(Aj);Ak.absorbMenuItems(Aj);if(Al&&Aj.menus.length>0){Ak.addSeparator();}},addWheelListener:(function(){var Am=mstrmojo.dom,Al=Am.attachEvent,Ak=Am.preventDefault,An;function Aj(Ar,Aq,As,Ap){var Ao=(An==="wheel")?As:function(At){if(!At){At=window.event;}var Av={originalEvent:At,target:At.target||At.srcElement,type:"wheel",deltaMode:(At.deltaMode!==undefined?At.deltaMode:1),deltaX:0,deltaZ:0,preventDefault:function(){Ak(window,At);}},Au=this;if(An==="mousewheel"){Av.deltaY=-At.wheelDelta;if(At.wheelDeltaX!==undefined){Av.deltaX=-At.wheelDeltaX;}}else{Av.deltaY=At.detail;}return As.call(Au,Av);};return Al(Ar,Aq,Ao,Ap);}if(Object.prototype.hasOwnProperty.call(document.createElement("div"),"onwheel")){An="wheel";}else{An=document.onmousewheel!==undefined?"mousewheel":"DOMMouseScroll";}return function(Ap,Aq,Ao){return Aj(Ap,An,Aq,Ao);};}()),addTouchSupportHelper:function AL(Aj,Al,Ak,Ao,An){Aj.style["touch-action"]="none";var Am={MINDRAG:function(Ap){return(((Ap.event.type.indexOf("touch")===0)||(Ap.event.type.indexOf("pointer")===0))?5:1);},TAPHOLDDELAY:250,DBLCLICKDELAY:300};t.newInstance(Aj,{context:Am,start:Ak,change:Ao,end:An},Al);},addBasicTouchSupport:function AB(Ao,Aq,At,An,As){function Au(Ay){var Ax={left:0,top:0};function Av(Az){if(Az===window||Az===document||Az===document.body){return Ax;}else{return Az.getBoundingClientRect();}}function Aw(A2,A3,A0){A3=A3||A2.currentTarget||A2.srcElement;if(!Array.isArray(A0)){A0=[0,0];}var Az=A2.clientX||0;var A4=A2.clientY||0;var A1=Av(A3);A0[0]=Az-A1.left;A0[1]=A4-A1.top;return A0;}return Aw(Ay.changedTouches?Ay.changedTouches[0]:Ay,document.body);}function Am(Av,Ax){if(Av.touches.length>1||(Av.type==="touchend"&&Av.touches.length>0)){return undefined;}var Aw=null,Az=null;switch(Av.type){case"touchstart":Aw="mousedown";Az=Av.changedTouches[0];break;case"touchmove":Aw="mousemove";Az=Av.changedTouches[0];break;case"touchend":Aw="click";Az=Av.changedTouches[0];break;}if(Ax){Aw=Ax;}var Ay={bubbles:Av.bubbles,cancelable:Av.cancelable,view:Av.view,screenX:Az.screenX,screenY:Az.screenY,clientX:Az.clientX,clientY:Az.clientY};if(Ax==="contextmenu"){Ay.button=2;Ay.buttons=2;}return new MouseEvent(Ax,Ay);}function Ap(Ax,Av){var Aw;if(Ax.type.indexOf("touch")===0){Aw=Am(Ax,Av);}else{var Ay=Au(Ax),Az={bubbles:Ax.bubbles,cancelable:Ax.cancelable,view:Ax.view,detail:Ax.detail,screenX:Ax.screenX,screenY:Ax.screenY,clientX:Ay[0],clientY:Ay[1]};if(Av==="contextmenu"){Az.button=2;Az.buttons=2;}Aw=new MouseEvent(Av,Az);}Aw.originEvent=Ax;return Aw;}function Al(Av){if(Av.stopPropagation){Av.stopPropagation();}if(Av.preventDefault){Av.preventDefault();}Av.cancelBubble=true;return false;}function Aj(Aw){var Az=Aw.event,Av=Aw.context;Av.startOffset=Au(Az);Av._dragged=false;Av._dragging=true;Av._taphold=false;Av.initialTarget=Az.target;var Ay=(new Date()).getTime();if(Ay-Av._mouseDownTime<Av.DBLCLICKDELAY){Av.numClicks+=1;}else{Av.numClicks=1;Av._mouseDownTime=Ay;}Av.tapholdTimeoutId=setTimeout(function(){if((new Date()).getTime()-Av._mouseDownTime>Av.TAPHOLDDELAY&&!Av._dragged){Av._taphold=true;}if(!Av._dragged&&Av._taphold){Aw.session.listeners.end(Az);}},Av.TAPHOLDDELAY+10);var Ax;if(At){Ax=At(Aw);}if(Ax===undefined||(Ax&&Ax.pause)){Al(Aw.event);}}function Ar(Az){var Av=Az.event,Ay=Az.context,A1=Au(Av),Ax=A1[0]-Ay.startOffset[0],Aw=A1[1]-Ay.startOffset[1];if(Math.abs(Ax)<Ay.MINDRAG(Az)){Ax=0;}if(Math.abs(Aw)<Ay.MINDRAG(Az)){Aw=0;}if(Ax||Aw){Ay._dragged=true;}if((new Date()).getTime()-Ay._mouseDownTime>Ay.TAPHOLDDELAY&&!Ay._dragged){Ay._taphold=true;}var A0;if(An){A0=An(Az);}if(A0===undefined||(A0&&A0.pause)){Al(Az.event);}}function Ak(Aw){var Av=Aw.context,Ay=Aw.event;if(Av.tapholdTimeoutId){clearTimeout(Av.tapholdTimeoutId);}if(!Av._dragging){Av._dragged=false;return ;}Av._dragging=false;if((new Date()).getTime()-Av._mouseDownTime>Av.DBLCLICKDELAY){Av.numClicks=Math.max(Av.numClicks-1,1);}if((new Date()).getTime()-Av._mouseDownTime>Av.TAPHOLDDELAY&&!Av._dragged){Av._taphold=true;}var Ax;if(As){Ax=As(Aw);}if(Ay.type.indexOf("mouse")===0){Av._dragged=false;Av._taphold=false;return ;}else{if(!Av._dragged){if(Av._taphold){Av.initialTarget.dispatchEvent(Ap(Ay,"contextmenu"));}else{Av.initialTarget.dispatchEvent(Ap(Ay,"click"));}}Av._dragged=false;Av._taphold=false;if(Ax===undefined||(Ax&&Ax.pause)){Al(Aw.event);}}}this.addTouchSupportHelper(Ao,Aq,Aj,Ar,Ak);},isNearZero:function(Ak,Aj){Aj=Aj||5;var Al=1/Math.pow(10,Aj);return(Math.abs(Ak)<Al);},hasMergedRowCells:function(Aj){return false;},getMockUpThresholds:function(Al,Am){var Aj=[{tid:1,n:"threshold 0",scope:1,rtp:2,rtxt:"",fmt:{bc:"#cc2525",bgs:0},expr:{et:14,nds:[{et:10,dmt:7,m:{did:"4C051DB611D3E877C000B3B2D86C964F",n:"Profit"},cs:[{v:"10%",dtp:5}],fn:2,fnt:3}],fn:19},ttp:1,flr:0,ceil:10},{tid:2,n:"threshold 1",scope:1,rtp:2,rtxt:"",fmt:{bc:"#e34b4b",bgs:0},expr:{et:14,nds:[{et:10,dmt:7,m:{did:"4C051DB611D3E877C000B3B2D86C964F",n:"Profit"},cs:[{v:"10%",dtp:5},{v:"30%",dtp:5}],fn:3,fnt:3}],fn:19},ttp:3,flr:10,ceil:30},{tid:3,n:"threshold 2",scope:1,rtp:2,rtxt:"",fmt:{bc:"#e97d7d",bgs:0},expr:{et:14,nds:[{et:10,dmt:7,m:{did:"4C051DB611D3E877C000B3B2D86C964F",n:"Profit"},cs:[{v:"30%",dtp:5},{v:"50%",dtp:5}],fn:3,fnt:3}],fn:19},ttp:3,flr:30,ceil:50},{tid:4,n:"threshold 3",scope:1,rtp:2,rtxt:"",fmt:{bc:"#79d479",bgs:0},expr:{et:14,nds:[{et:10,dmt:7,m:{did:"4C051DB611D3E877C000B3B2D86C964F",n:"Profit"},cs:[{v:"50%",dtp:5},{v:"70%",dtp:5}],fn:3,fnt:3}],fn:19},ttp:3,flr:50,ceil:70},{tid:5,n:"threshold 4",scope:1,rtp:2,rtxt:"",fmt:{bc:"#57ba57",bgs:0},expr:{et:14,nds:[{et:10,dmt:7,m:{did:"4C051DB611D3E877C000B3B2D86C964F",n:"Profit"},cs:[{v:"70%",dtp:5},{v:"90%",dtp:5}],fn:3,fnt:3}],fn:19},ttp:3,flr:70,ceil:90},{tid:6,n:"threshold 5",scope:1,rtp:2,rtxt:"",fmt:{bc:"#2ca02c",bgs:0},expr:{et:14,nds:[{et:10,dmt:7,m:{did:"4C051DB611D3E877C000B3B2D86C964F",n:"Profit"},cs:[{v:"90%",dtp:5}],fn:5,fnt:3}],fn:19},ttp:1,flr:90,ceil:100}];S.forEach(Aj,function(Ao){var An=Ao.expr.nds[0].m;An.did=Al;An.n=Am;});var Ak={};Ak[Al]=Aj;return Ak;},generateThresholdsInfo:function(Al,Aq,Aj,An){var Ap=Aj.length,Ak=[],At,Am,Au=0,As=0;for(var Ao=0;Ao<Ap;Ao++){Am=Math.round(An[Ao]*100);As=Au;Au=Am||100;At={tid:Ao+1,n:"threshold "+Ao,scope:1,rtp:2,rtxt:"",fmt:{bc:Aj[Ao],bgs:0},expr:{et:14,nds:[{et:10,dmt:7,m:{did:Al,n:Aq},cs:[{v:Am+"%",dtp:5}],fn:2,fnt:3}],fn:19},ttp:1,ceil:Au,flr:As};Ak.push(At);}var Ar={};Ar[Al]=Ak;return Ar;},psPt2CssPt:function(Al,Ak){var Aj=parseInt(Al,10)*0.75;if(Ak instanceof Function){Aj=Ak(Aj);}return Aj+"pt";},captureEventOnce:function(Ao,An,Aj,Am,Al){function Ak(Ap){An.call(Aj,Aa.newDomEvent(Ao,window,Ap||window.event),Al);AE.detachEvent(Am,Ao,Ak);}Al=Al||{};Am=Am||document;AE.attachEvent(Am,Ao,Ak);},getPropertyByPath:function(An,Am,Aj){var Ak,Al;if(typeof Am!=="string"){return Aj;}Ak=Am.split(".");Al=Ak.every(function(Ap){var Ao=An[Ap];if(Ao!==undefined){An=Ao;return true;}return false;});return Al?An:Aj;},mergeHashes:function(){return Array.prototype.slice.apply(arguments).reduce(function(Aj,Ak){if(Ak){Object.keys(Ak).forEach(function(Al){Aj[Al]=Ak[Al];});}return Aj;},{});},toggleControlEnabled:function(Aj,Ak){[].concat(Aj).forEach(function(Al){Al.set("enabled",!!Ak);});},findInArray:function(Am,Al,Ak){var Ao=-1,An,Aj;if(!Array.isArray(Am)){return Ao;}for(An=Ak===undefined?0:Ak,Aj=Am.length;An<Aj;An+=1){if(Al(Am[An])){return An;}}return Ao;},arrayUnique:function(Aj,Al){if(!Array.isArray(Aj)){return Aj;}var Ak=mstrmojo.VisUtility;return Aj.filter(function(Am,An){return Ak.findInArray(Aj,function(Ao){return Al(Am,Ao);},An+1)===-1;});},range:function(Aj,An,Am){Am=Am||1;var Al,Ak=[];for(Al=Aj;Al!==An;Al+=Am){Ak.push(Al);}return Ak;},drawDashLine:function I(Ar,Al,Ap,Ak,An,Aj,Aq){var Ao=(Al===Ak),Am;Ar.beginPath();Ar.moveTo(Al,Ap);if(Ao){Am=0;Ap+=Aj;while(Ap<=An){if(Am%2===0){Ar.lineTo(Al,Ap);Ap+=Aq;}else{Ar.moveTo(Al,Ap);Ap+=Aj;}Am++;}if(Am%2===0){Ar.lineTo(Ak,An);}}else{Am=0;Al+=Aj;while(Al<=Ak){if(Am%2===0){Ar.lineTo(Al,Ap);Al+=Aq;}else{Ar.moveTo(Al,Ap);Al+=Aj;}Am++;}if(Am%2===0){Ar.lineTo(Ak,An);}}Ar.stroke();},repeat:function(Al,Am){var Aj=[],Ak;Am=Math.max(0,Am);for(Ak=0;Ak<Am;Ak+=1){Aj[Ak]=Al;}return Aj;},isHierarchyObject:function(Aj){return(Aj&&Aj.t)===p.DssTypeDimension;},selectDropZonePanel:function(Aj){AC(Aj,"editPanel");},selectPropertyPanel:function(Ak,Al){AC(Ak,"propertiesPanel");var Aj=Ak.edtModel;if(Aj){Aj.selectTargetByValue(Al);}},pluck:function(Ak,Aj){if(!S.isArray(Ak)){return Ak;}return Ak.map(function(Al){return Al&&Al[Aj];});},pick:function(Ak,Aj){return Aj.reduce(function(Am,Al){Am[Al]=Ak[Al];return Am;},{});},isColorManuallySet:function(Al,Ak){var Aj=Ag(Al,Ak);if(Aj){return Aj.isManual;}},getCombColor:function(Al,Ak){var Aj=Ag(Al,Ak);if(Aj){return Aj.color;}},setColorPickerShowAutomatic:function(Ak,Aj){Ak.children[0].fillColor.colorPicker.showAutomatic=Aj;},getCharGroupValueChangeCb:function(Aj){var Ak=(function(){var Al={};Al[AT.FONT_WEIGHT]=AX.FS_BOLD;Al[AT.FONT_STYLE]=AX.FS_ITALIC;Al[AT.UNDERLINE]=AX.FS_UNDERLINE;Al[AT.LINE_THROUGH]=AX.FS_STRIKETHROUGH;return function(Am,An){return Am^Al[An];};}());return function(Am,Al){if(Aj instanceof Function){Aj=Aj();}if(!Aj){return ;}switch(Am){case AT.COLOR:Aj.fontColor.fill.value.setValue(Al);break;case AT.FONT_SIZE:Aj.fontSize.setValue(Al);break;case AT.FONT_FAMILY:Aj.fontFamily.setValue(Al);break;case AT.FONT_WEIGHT:case AT.FONT_STYLE:case AT.UNDERLINE:case AT.LINE_THROUGH:Aj.fontStyle.setValue(Ak(Aj.fontStyle.getValue(),Am));break;}};},getMetricsInDropZone:AP,addLegendFontChangeListeners:function(Ak,Al){var Aj=["lgdFntClr","lgdFntSz","lgdFntFml","lgdFntStyle"];Ab(Aj,Ak,Al);},addLegendBackgroundChangeListeners:function(Ak,Al){var Aj=["lgdBgFillClr","lgdBgFillTrans"];Ab(Aj,Ak,Al);},isValidDropZone:function(Aj){if(Aj===undefined){return false;}var Al=Object.keys(Aj).filter(function(Am){return Am!=="visProp";});var Ak=X.copyProps(Al,Aj);return Aj&&!X.equals(Ak,{});},unitExistInTemplate:function(Am,Aj){var Al,Ao,An=Aj.row,Ak=Aj.col;for(Al=0,Ao=An.length;Al<Ao;Al++){if(An[Al].id===Am){return true;}}for(Al=0,Ao=Ak.length;Al<Ao;Al++){if(Ak[Al].id===Am){return true;}}return false;},findDisabledUnits:function(As,At){var Ao,Ak,Am=At.docModel.datasets,Aj=As.gts,Aq=As.datasetId,An=Am[Aq]||{},Ap=An.att||[],Ar=[];var Al=mstrmojo.VisUtility;if(Ap){for(Ao=0,Ak=Ap.length;Ao<Ak;Ao++){if(!Al.unitExistInTemplate(Ap[Ao].did,Aj)){Ar.push(Ap[Ao]);}}}return Ar;},getDrillCandidates:function(Ao,Ap){var Ar=Ao.modelData,At=Ao.model,An=At.docModel.datasets,Aj=Ar.gts,Al=mstrmojo.VisUtility,Au=Al.findDisabledUnits(Ar,At),Ak=[],Am=(function(){var Av;if(Ap){S.forEach(Aj.row.concat(Aj.col),function(Aw){if(Aw.id&&Aw.id===Ap){Av=Aw.dp;}});}return Av;}()),Aq=function(Av,Ay){var Aw=S.find(Av,"did",Ay.id),Ax=Av[Aw];if(Ax&&!Ax.hide){Ay.n=Ax.n;return true;}return false;},As=S.filter(Am,function(Ax){var Av;for(Av in An){var Aw=An[Av];if(Aq(Aw.att,Ax)){return true;}}return false;});if(As){Ak=S.filter(Au,function(Aw){for(var Av in As){if(As[Av].n===Aw.n){return true;}}return false;});}return Ak;},getDrillSubMenu:function(Aj){if(!Aj||!Aj.items||!Aj.drillAction){return{};}var An=new mstrmojo.ui.menus.MenuConfig({supportsScroll:true,isHostedWithin:false,alignWithAnchor:true,maxHeight:350}),Ak=Aj.items,Am=Aj.drillAction,Al=[];if(mstrmojo.resolveFeature("sort-drill-paths")){Ak.sort(function(Ap,Ao){if(Ap.n>Ao.n){return 1;}if(Ap.n<Ao.n){return -1;}return 0;});}Ak.forEach(function(Aq,Ao){if(Al.indexOf(Aq.did)===-1){Al.push(Aq.did);if(Aq.att){var Ap=mstrmojo.VisUtility;var Ar={};X.copy(Aj,Ar);Ar.items=Ak[Ao].att;An.addPopupMenuItem(Aq.n,this.id,Ap.getDrillSubMenu,"xt",Ar);}else{An.addMenuItem(Aq.n,"xt",Am,X.copy(Aj,{drillUnit:Aq}));}}});return An;},getDrillMenu:function(Ap,Aq,Av,Aj){var Ar=Ap.model,Am=mstrmojo.VisUtility,As=Am.getDrillCandidates(Ap,Aq),At=As.length,Ao=Ar.docModel,Al=Ao.datasets[Ap.modelData.datasetId],Az,Au=[],Ax=-1,Aw,Ay,An,Ak;if(Al&&Ao.isMDXDataset(Al)){Am.sortMdxDrillCandidates(As);Az=Al.tables[0];Az.dimensions.forEach(function(A0){An=true;Aw=-1;A0.hierarchies.forEach(function(A1){Ak=true;A1.att.forEach(function(A2){Ay=Af.findBin(As,A2,"did",At);if(Ay!==-1){if(An){Au.push({id:A0.did,did:A0.did,n:A0.n,att:[]});Ax++;An=false;}if(Ak){Au[Ax].att.push({id:A1.did,did:A1.did,n:A1.n,att:[]});Aw++;Ak=false;}Au[Ax].att[Aw].att.push(As[Ay]);}});});});}else{Au=As;}return Am.getDrillSubMenu(X.copy(Aj,{items:Au,drillAction:Av}));},sortMdxDrillCandidates:function(Aj){Aj.sort(function(Al,Ak){if(Al.did<Ak.did){return -1;}if(Al.did>Ak.did){return 1;}return 0;});return Aj;},getDrillMenuItemsCallback:function(Al,Am,Aj,Ak){return function(){var Ao=mstrmojo.VisUtility;var Ap=Ao.getDrillCandidates(Al,Ak),An=new mstrmojo.ui.menus.MenuConfig({supportsScroll:true,maxHeight:350});Ap.forEach(function(Aq){An.addMenuItem(Aq.n,"xt",Am,X.copy(Aj,{drillUnit:Aq}));});return An;};},doDrill:function(Al,Az,Au,A0){var A1=Al;function Ar(A3){return A3.model.controller.cmdMgr;}function Ax(){return{success:function A3(){var A4=mstrmojo.VisUtility;A4.visPrint("reaise");this.raiseEvent({name:"regenerateToolbar"});}.bind(this)};}var Ak=A1.model,Ay=(A1.getDocModel&&A1.getDocModel())||A1.model.docModel,Aw=Ay.getDataService(),Ao=Aw.newUpdate();var Aq=true;if(Ay.prefs&&Ay.prefs.rtprnt){Aq=parseInt(Ay.prefs.rtprnt,10)===1;}else{if(Ak.xtab.defn.tkp!==undefined){Aq=parseInt(Ak.xtab.defn.tkp,10)===-1;}}A0=A0||{};A0.keepParent=Aq;var Ap=Au.call(Al,Az,A0);var As=A1.zonesModel,A2=As.getUpdateCallback(),At=A1.model.controller||Ay.controller,Am=At._getXtabCallback(A1);Ao.add(Ap,Ae(A2,Am));var Aj=Ak.getSelectorDataFromTemplateLimit(A1.model.data.tpl).concat({keepOnly:true,data:A1.getContextMenuSelections()}),Av=Ay.getKeepOnlyOrExcludeAction(A1.k,Aj);Ao.add(Av,Ax.call(A1));Ar(A1).execute({execute:function An(){this.submitUpdate(Ao);},urInfo:{callback:Ao.callback}});},strStartsWith:function(Al,Ak,Aj){Aj=Aj||0;return Al.lastIndexOf(Ak,Aj)===Aj;},changeWidgetBackground:function(Al,Am,Ak){var Aj=Al.parent;if(Aj&&Am!==Ak){Aj.changeUnitFormats(false,1,Al.getFormats(),AT.BACKGROUND_COLOR,Am,Ak);Aj.raiseEvent({name:"BEMFormatChange",propertyName:AT.BACKGROUND_COLOR,value:Am,isTitle:false});}},translateGridError:function(Ak,Aj){if(Aj===undefined){Aj=Ah.AE_ERROR;}if(Aj===Ah.EMPTY_DATA){Ak=mstrmojo.desc(2388,"No data returned for this view. This might be because the applied filter excludes all data.");}if(Aj===Ah.NO_DATASET||Aj===Ah.NO_TEMPLATE_UNIT){Ak=mstrmojo.desc(11668,"Drag objects here.");}if(!Ak){Ak=mstrmojo.desc(13687,"Unknown error");}return{msg:Ak,type:Aj};},hasValidValueInMetric:function(Am,Ak){var Aj=mstrmojo.VisUtility;var Al=Aj.getPropertyByPath(Am,"model.data.gsi.mx");if(Al===undefined||Al.length<=Ak||Ak<0){return false;}var An=Al[Ak];return["min","max"].every(function(Ao){var Ap=An[Ao];return Ap!==undefined&&Ap!==null&&Ap!=="";});},renderWidgetErrorRSD:function(Am,Ao,Ak){var Aq=document.createElement("div");var Ap='<div style="display: table; height: 100%; width: 100%; background-color:#F5F5F2; border: solid 1px #A7A7A7; box-sizing: border-box;"><div style="display: table-cell; vertical-align: middle; text-align: center; color: #000000; font-size: 14pt;">'+Ao+"</div></div>";Aq.innerHTML=Ap;Aq=Aq.firstChild;var Aj=Am.width,Al=Am.height;if(Aj!==undefined){Aq.style.width=Aj+"px";}if(Al!==undefined){Aq.style.height=Al+"px";}var An=Am.domNode;if(An){Ak.forEach(function(Ar){An["on"+Ar]=undefined;});while(An.firstChild){An.removeChild(An.firstChild);}An.appendChild(Aq);}else{Am.parent.domNode.appendChild(Aq);}},visPrint:function(){var Aj=mstrmojo.VisUtility.enableInVis;if(Aj&&window.mstr_profile&&mstr_profile.enabled&&console){Function.prototype.apply.call(console.log,console,arguments);}},hasCGorCon:function(Am,Aj){var Al=Aj&&Aj.did,Ak=Am.model.data.datasetId||"",An=null;if(Al){An=AV.getDatasetFromAttributeId(Am.model.docModel.datasets,Al);}else{if(Ak){An=AV.getDatasetFromId(Am.model.docModel.datasets,Ak);}}return An&&AV.hasCGorCon(An);},isCGorCon:function n(Am,Aj){var Al=Aj&&Aj.did,Ak=Am.model.data.datasetId||"",An=null;if(Al){An=AV.getDatasetFromAttributeId(Am.model.docModel.datasets,Al);}else{if(Ak){An=AV.getDatasetFromId(Am.model.docModel.datasets,Ak);}}return An&&AV.isCGorCon(Aj,An);},findElementsByAttribute:function R(Al,An,Am,Aj){Aj=!!Aj;var Ao=[];if(Am.constructor!==Array){Am=[Am];}var Ap=function(Aq){if(Aj){return Aq.identity&&Aq.identity.tlOpt&&Aq.identity.tlOpt[An];}else{return Aq.getAttribute(An);}};function Ak(As){var Aq=Ap(As),Ar;if(As.hasChildNodes()){Ar=As.firstChild;while(Ar){if(Ar.nodeType===1){Aq=Ap(Ar);if(Am.indexOf(Aq)!==-1){Ao.push(Ar);}else{Ak(Ar);}}Ar=Ar.nextSibling;}}}Ak(Al);return Ao;},restoreEsForUnit:function AR(An){if(!An){return ;}var Ao=An.es,Ak=An.fs,Am=An.otp,Aj=Ak&&Ak.length||0;function Al(Ap){var Aq=document.createElement("div");Aq.innerHTML=Ap;return Aq.innerText;}if(Ao){S.forEach(Ao,function(Aq,Ap){Aq.n=c.decodeHtmlString(Aq.n);if(Am===p.DssTypeAttribute&&Aj){switch(Ak[Ap%Aj].bftp){case AN.DssBaseFormHTMLTag:Aq.n=Al(Aq.n);break;default:}}});}},isTrue:function AW(Aj){return Aj==="true"||Aj===true;},getFontFamilyItems:function r(){if(P){return P;}else{P=[];S.forEach(Q.Families.slice(1),function(Aj){P.push({n:Aj.n,id:Aj.n,did:Aj.n,preview:!Aj.symbolic});});return P;}},surroundWithQuotes:function AQ(Aj){if(!Aj){return"";}return"'"+Aj.replace(/^['|"]+/,"").replace(/['|"]+$/,"")+"'";}});mstrmojo.VisUtility.enableInVis=true;}());(function(){mstrmojo.requiresCls("mstrmojo.vi.viz.DropZoneHelper","mstrmojo.string","mstrmojo.vi.ui.DatasetUnitMenuUtils");var G="mstrmojo-VIUnitList",I="icn clsx_sub",D=mstrmojo.vi.viz.DropZoneHelper.isMetricNames,C=mstrmojo.vi.ui.DatasetUnitMenuUtils,J=mstrmojo.string;mstrmojo.vi.ui.VIDragUnit=mstrmojo.declare(null,null,{scriptClass:"mstrmojo.vi.ui.VIDragUnit",getItemDisplayName:function F(K){return K.n;},getUnitAvatar:function A(N,Q){var M=document.createElement("div"),P=N.getCtxtDragData(),K=P.items,L=['<div class="',[G,mstrApp.getThemeClassName()].join(" "),'">'],O=this;K.forEach(function(S){var U=O.getItemDisplayName(S),R="item unit isAvatar "+C.getUnitCssClass(S);if(D(S)){U=mstrmojo.desc(3582,"Metrics");R+=" is-mh";}L.push('<div class="'+R+'"><span class="txt" unselectable="on">'+(Q?J.encodeHtmlString(U):U)+"</span></div>");});L.push("</div>");M.innerHTML=L.join("");return M.removeChild(M.firstChild);},getUnitDragData:function B(M,K){var L=this.setAvatarClass.bind(this);return{items:K,item:K[0],setAvatarClass:function N(P){L(M,P);},setInvalidAvatarClass:function O(){L(M,I);}};},getDragUnitOffsets:function E(){return{x:21,y:16};},setAvatarClass:function H(N,K){var L=N.avatar;if(L){var M=[G,"hasOwnAvatar",mstrApp.getThemeClassName(),K||""];L.className=M.join(" ");}}});}());(function(){mstrmojo.requiresCls("mstrmojo.ME.ObjectInputBox");var B=mstrmojo.expr;mstrmojo.ME.ConditionInputBox=mstrmojo.declare(mstrmojo.ME.ObjectInputBox,null,{cssClass:"mstrmojo-ME-ObjectInputBox-condition",folderLinksContextId:10,browsableTypes:[B.TP.FOLDER,B.TP.FILTER,B.STP.PROMPT_OBJECTS].join(","),noEditButton:true,maxObjectCount:1,getCandidatesThroughTaskCall:function A(D,C){D.rootFolderType=39;D.blockCount=this.blockCount;mstrmojo.ME.MetricDataService.getFilters(D,C);},hideItemWidgetBrowseButton:function(){return this.isDME;}});})();(function(){mstrmojo.requiresCls("mstrmojo.Label","mstrmojo.Pulldown","mstrmojo.ME.ObjectInputBox","mstrmojo.ME.MetricDataService","mstrmojo.ME.Enum");mstrmojo.requiresDescs(1107,12178);var J=mstrmojo.expr,D=mstrmojo.ME.Enum.DYNAMIC_DIMTY;mstrmojo.ME.LevelInputBox=mstrmojo.declare(mstrmojo.ME.ObjectInputBox,null,{cssClass:"mstrmojo-ME-ObjectInputBox-level",oncandidatesChange:function F(E){this.candidates.items=D.getItems("level").concat(this.candidates.items);},hidePulldownButton:function(){return !this.isDME;},hideItemWidgetBrowseButton:function(){return this.isDME;},folderLinksContextId:16,browsableTypes:[J.TP.FOLDER,J.TP.ATTR,J.TP.DIM].join(","),getCandidatesThroughTaskCall:function K(L,E){L.rootFolderType=39;L.blockCount=this.blockCount;mstrmojo.ME.MetricDataService.getAttributes(L,E);},itemFunction:function B(M,E,L){M.filtering=M.filtering||1;M.grouping=M.grouping||1;var N=this._super(M,E,L,mstrmojo.ME.LevelObjectItem);N.optionButtonVisible=true;return N;},updateSuggestion:function C(E){E=[{n:this.isDME?mstrmojo.desc(12178,"Visualization level"):mstrmojo.desc(1107,"Report Level"),did:-1,t:-1,state:0}].concat(E);if(this._super){this._super(E);}},add:function H(L,E){var N=true,M=this.items;mstrmojo.array.forEach(L,function(O){mstrmojo.array.forEach(M,function(P){if(P.did&&P.did===O.did){N=false;return false;}});});if(N){this._super(L,E);}}});mstrmojo.ME.LevelObjectItem=mstrmojo.declare(mstrmojo.ME.ObjectItem,[mstrmojo._HasPopup],{optsRef:{scriptClass:"mstrmojo.Editor",title:mstrmojo.desc(9598,"Level Options"),cssText:"width: 450px;",onOpen:function A(){var E=this.opener.data;this.filterOption.set("value",E.filtering);this.groupOption.set("value",E.grouping);},children:[{scriptClass:"mstrmojo.Label",text:mstrmojo.desc(9599,"Relationship with Report Filter:")},{scriptClass:"mstrmojo.Pulldown",alias:"filterOption",itemField:"n",itemIdField:"did",items:[{n:mstrmojo.desc(9600,"Standard - Metric calculates only for elements found in the filter"),did:1},{n:mstrmojo.desc(9601,"Absolute - Raises the calculation to the selected level, if possible"),did:2},{n:mstrmojo.desc(9602,"Ignore - Omit filtering criteria based on selected level and its related attributes"),did:3},{n:mstrmojo.desc(9603,"None - Unspecified - the selected level and group components define the filter"),did:4}]},{scriptClass:"mstrmojo.Label",text:mstrmojo.desc(9604,"Metric Aggregations:")},{scriptClass:"mstrmojo.Pulldown",alias:"groupOption",itemField:"n",itemIdField:"did",items:[{n:mstrmojo.desc(9605,"Standard - Metric calculates at the selected level, if possible"),did:1},{n:mstrmojo.desc(9606,"None - Exclude the selected level and children from the GROUP BY clause in the SQL"),did:2},{n:mstrmojo.desc(9607,"Beginning lookup - Use the first value of the lookup table"),did:3},{n:mstrmojo.desc(9608,"Ending lookup - Use the last value of the lookup table"),did:4},{n:mstrmojo.desc(9609,"Beginning fact - Use the first value of the fact table"),did:5},{n:mstrmojo.desc(9610,"Ending fact - Use the last value of the fact table"),did:6}]},{scriptClass:"mstrmojo.HBox",slot:"buttonNode",cssText:"float:right;margin: 5px 0px;",children:[{scriptClass:"mstrmojo.Button",cssClass:"mstrmojo-Editor-button mstrmojo-WebButton hot",text:mstrmojo.desc(1442,"OK"),onclick:function(){var E=this.parent.parent,L=E.opener;if(L.saveOnClose){L.saveOnClose(E.filterOption.value,E.groupOption.value);}E.close();}},{scriptClass:"mstrmojo.Button",cssClass:"mstrmojo-Editor-button mstrmojo-WebButton",text:mstrmojo.desc(221,"Cancel"),onclick:function(){var E=this.parent.parent;E.close();}}]}]},saveOnClose:function G(E,M){var L=this.data;L.filtering=E;L.grouping=M;if(this.parent.onSaveOnClose){this.parent.onSaveOnClose();}},options:function I(){this.openPopup("optsRef",{title:'"'+this.data[this.itemField]+'" '+mstrmojo.desc(9598,"Level Options"),zIndex:40});}});}());(function(){mstrmojo.requiresCls("mstrmojo.ME.ObjectInputBox");var B=mstrmojo.expr;mstrmojo.ME.TransformInputBox=mstrmojo.declare(mstrmojo.ME.ObjectInputBox,null,{cssClass:"mstrmojo-ME-ObjectInputBox-transform",items:[],noEditButton:true,folderLinksContextId:26,browsableTypes:[B.TP.FOLDER,B.TP.ROLE].join(","),getCandidatesThroughTaskCall:function A(E,D){mstrmojo.ME.MetricDataService.getTransformations(E,D);},hideItemWidgetBrowseButton:function C(){return this.isDME;}});}());(function(){mstrmojo.requiresCls("mstrmojo.warehouse.DBRoleSelector","mstrmojo.ui.Splitter","mstrmojo.warehouse.EnumDataChangeEvents","mstrmojo.warehouse.ui.AvailableTablesPanel");var A=mstrmojo.warehouse.EnumDataChangeEvents;mstrmojo.warehouse.WHPanel=mstrmojo.declare(mstrmojo.ui.Splitter,null,{scriptClass:"mstrmojo.warehouse.WHPanel",cssClass:"WHPanel",orientation:mstrmojo.ui.Splitter.ENUM_OR.VERTICAL,config:{firstSplit:{v:"300px",min:"100px"},secondSplit:{v:"100%",min:"100px"},resizeHandle:{v:"2px"}},getLayoutOffsets:function C(){return{h:0,w:0};},init:function B(E){this._super(E);var F={},D=F[this.id]={};D[A.DBROLE_SELECTION]=this.onDBRoleSelection;mstrApp.getRootController().attachDataChangeListeners(F);},onDBRoleSelection:mstrmojo.emptyFn,children:[{scriptClass:"mstrmojo.warehouse.DBRoleSelector",slot:"firstSplitNode",alias:"topPanel"},{scriptClass:"mstrmojo.warehouse.ui.AvailableTablesPanel",slot:"secondSplitNode",alias:"bottomPanel"}]});}());(function(){mstrmojo.requiresCls("mstrmojo.form","mstrmojo.hash","mstrmojo.Obj","mstrmojo.architect.ui.editors.NameEditor","mstrmojo.warehouse.EnumDataChangeEvents","mstrmojo.warehouse.obj.DBRole","mstrmojo.warehouse.dbroles.DBRoleEditor","mstrmojo.warehouse.ui.editors.CatalogSQLEditor","mstrmojo.DI.DIConstants","mstrmojo.DI.DIHelpers");mstrmojo.requiresDescs(16036);var R=mstrmojo.hash,t=mstrmojo.DI.DIHelpers,N=mstrmojo.func.wrapMethods,P=mstrmojo.warehouse.EnumDataChangeEvents,U=P.DBTABLES_CHANGED,AA=mstrmojo.warehouse.EnumObjectTypes,h=AA.DBROLE,o=mstrmojo.DI.DIConstants,S,C,d=57,E="sharingEditorID_WHController";function p(AM,AL){var AK;if(AM){AK=this.model.getDBRole(AM.did);if(AK){return AK;}}if(AL){AK=new mstrmojo.warehouse.obj.DBRole({mdl:this.model});if(AM&&AM.did){AK.did=AM.did;}return AK;}return null;}function W(){var AK="data_source_dialog.htm";if(mstrApp.type===o.xdaType.mdx){AK="Creating_a_data_source_connection_to_an_OLAP_source.htm";}else{if(mstrApp.subtype===o.sourceSubtype.searchOnSource){AK="Creating_a_data_source_connection_to_search.htm";}}return AK;}mstrmojo.warehouse.WHController=mstrmojo.declare(mstrmojo.Obj,null,{start:mstrmojo.emptyFn,getDataService:mstrmojo.emptyFn,loadDBRoles:function D(AL){var AK=this.model;if(mstrApp.isSingleTier){AK.loadDBRoles(AL);}else{AK.loadPrivileges(function(){AK.loadDBRoles(AL);});}},isCloud:function V(){return false;},isUsingCookieNamespace:function A(){return this.model.usingCookieNamespace;},getDBRoles:function G(){return this.model.dbrs;},getAllDBRoleNames:function c(){return this.model.allDBRoleNames;},loadDBObjects:function Q(AK){this.model.loadDBObjects(AK);},getDBObjects:function X(){return this.model.dbObjects;},setNameSpaceID:function f(AK){this.model.set("SelNameSpaceID",AK);},getNameSpaceID:function z(){return this.model.SelNameSpaceID;},getNameSpaces:function AF(AK){this.model.SelNameSpaceID=undefined;this.model.getNameSpaces(AK);},cancelLoadNameSpaces:function F(){this.model.cancelNameSpaces();},cancelLoadTables:function AC(){this.model.cancelLoadTables();},getColumnsForDBTables:function H(AN,AO){var AK=this.model,AL=AN.tables,AM=AN.getFresh;R.forEach(AL,function(AQ){AK.getColumnsForDBTable({data:AQ,getFresh:AM},N({success:function AR(AS){AQ.items=R.clone(AS.items);},complete:function AP(){AK.raiseEvent({name:P.DBTABLE_UPDATED,item:AQ});}},AO));});},getColumnsForDBTable:function a(AK,AL){if(S&&S.visible){AK.data.dbrole=S.dbRole.did;}this.model.getColumnsForDBTable(AK,AL);},setSelectedDBRoleID:function L(AL){var AK=AL&&AL.mdDBRole&&AL.mdDBRole.usable?parseInt(AL.mdDBRole.usable,10):true;if(AK){this.model.set("SelDBRoleID",AL.did);}else{mstrmojo.alert(mstrmojo.desc(16036,"You don't have 'Use' privilege to perform this operation."));return ;}},updateSelectedDBRoleId:function O(){var AK=this.model.SelDBRoleID;this.model.SelDBRoleID=undefined;this.model.set("SelDBRoleID",AK);},handleDBTableRefresh:function e(AL){var AK=this.model;AK.catalogRefresh=true;this.availableTableSearch("",R.copy(AL,{sourceInfo:"tablesPanel"}));},sqls:undefined,getCurrentZIndex:function b(){if(mstrApp.sessionManager){return mstrApp.sessionManager.zIndex;}else{if(t.getEnvObj().isWS()){return mstrApp.diCurrentZIndex;}}return undefined;},displayCatalogSQL:function AB(AM){var AL=this,AK=this.model,AN=AM||AK.SelDBRoleID;S=S||new mstrmojo.warehouse.ui.editors.CatalogSQLEditor({help:"edit_catalog_options_dialog.htm",cbkOnClose:function(){if(!!this.hasApplied){AK.sourceInfo="tablesPanel";AL.updateSelectedDBRoleId();}}});AL.getDataService().catalogAction({success:function AO(AQ){S.options=AQ.options;S.SQLStatements=AQ.sqls;AK.getDBRole(AN).populate(function AP(AS){S.dbRole=AS;S.supportsNameSpaces=AS.supportsNameSpaces;S.onUpdateInfo=function AU(AV){AL.getDataService().catalogAction({success:function AW(){if(AK.SelDBRoleID===AN&&AK.SelNameSpaceID){AL.availableTableSearch("",{sourceInfo:"tablesPanel"});}if(AV.callback){AV.callback();}}},{dbrid:AN,info:JSON.stringify(AV.options),flags:10003});};var AT=AL.getCurrentZIndex(),AR={};if(AT){AR.zIndex=AT+1;}S.open(null,AR);});}},{dbrid:AN,flags:10002});},attachDataChangeListeners:function l(AL){var AK=this.model;R.forEach(AL,function(AM,AN){R.forEach(AM,function(AP,AO){AK.attachEventListener(AO,AN,AP);});});},editDBRole:function g(AL,AN){var AM=this,AK=(t.isServerBasedWS()||t.isLocalWS())&&!mstrApp.isPopup&&!mstrApp.DIEmbeded;p.call(this,AL,true).populate(function(AO){AM.loadDBObjects({success:function AP(){C=C||new mstrmojo.warehouse.dbroles.DBRoleEditor({help:W(),scrollable:AK});C.config=AM.model.dbRoleEditorCfg;C.config.showAddDriver=AM.model.showAddDriver;C.callback=AN||mstrmojo.emptyFn;C.dbrole=AO;C.container.dsninfo.clear();C.open();}});});},renameDBRole:function AJ(AK){p.call(this,AK,false).populate(function(AL){if(!AL){return ;}var AN=new mstrmojo.architect.ui.editors.NameEditor({data:AL,tp:h,zIndex:9999,isNew:false,help:W(),onOK:function AM(AO){AL.rename(AO);}});AN.open();});},duplicateDBRole:function u(AK){var AL=this;p.call(AL,AK,false).populate(function(AM){if(!AM){return ;}AM.duplicate();});},deleteDBRole:function M(AK){var AL=this;p.call(AL,AK,false).populate(function(AN){var AM=mstrmojo.Button.newInteractiveButton;if(!AN){return ;}mstrmojo.confirm(mstrmojo.desc(10073,"Are you sure you want to delete the Database Connection")+" "+AN.n+"?",null,{buttons:[AM(mstrmojo.desc(219,"Yes"),function AO(){AL.model.deleteDBRole(AN.mdDBRole.did,{success:function AP(){}});},null,{iconClass:"mstrmojo-Editor-button-Yes"}),AM(mstrmojo.desc(218,"no"),null,null,{iconClass:"mstrmojo-Editor-button-No"})],title:mstrmojo.desc(3169,"delete"),zIndex:9999});});},setProjectPrimaryDBRole:function j(AL,AM){var AK=this.model;AK.SelDBRoleID=AL.did;AK.setProjectPrimaryDBRole(true,AM);},getProjectPrimaryDBRoleID:function K(){return this.model.projPrimaryDBRoleID;},saveDBRole:function I(AL,AK,AO){var AM=this;AM.model.saveDBRole(AL.mdDBRole,AK,N(AO,{success:function AN(AQ){var AR=AQ.dbr.did,AS=AQ.dbr.n,AP=p.call(AM,{did:AR},true);AP.populated=false;AP.n=AS;}}));},populateDBRole:function Z(AK,AL){this.model.populateDBRole(AK,AL);},navigateProject:function m(AK){if(AK){mstrmojo.form.send({evt:3010,Server:AK.sname,Project:AK.pname,Port:AK.port,loginReq:true},mstrApp.name,"POST",null,null,false);}else{mstrmojo.form.send({evt:3010},mstrApp.name,"POST",null,null,false);}},navigateArchitect:function AI(AK){mstrmojo.form.send({evt:3176,Server:AK.sname,Project:AK.pname,Port:AK.port,loginReq:true},mstrApp.name,"POST",null,null,false);},availableTableSearch:function AE(AK,AL){this.model.getSelectedDBRoleTables(N({blockBegin:0,blockCount:1000,filterText:AK},AL||{}));},getPrimaryDBRoleTablesAndColumns:function AH(AK){this.model.getDBRoleTablesAndColumns({dbRoleID:this.model.projPrimaryDBRoleID},AK);},hasPrivilege:function k(AK){return mstrApp.isSingleTier||this.model.privileges[AK]||false;},validateName:function Y(AM,AK,AL,AN){return this.model.validateName(AM,AK,AL,AN);},findNextName:function AD(AK,AL,AM){return this.model.findNextName(AK,AL,AM);},findinArray:function AG(AK,AM,AL){return this.model.findinArray(AK,AM,AL);},getObjectCount:function B(AM){if(Object.keys){return Object.keys(AM).length;}var AK,AL=[];for(AK in AM){if(AM.hasOwnProperty(AK)){AL.push(AK);}}return AL.length;},destroy:function x(AK){if(C){C.destroy(AK);C=null;}this._super(AK);},cleanError:function r(AK){AK=AK.replace("com.microstrategy.webapi.MSTRWebAPIException:","");AK=AK.replace("Internal Error:","");return mstrmojo.string.trim(AK);},launchOneTierFileBrowser:function n(AK){window.FormWrapper.openFileDialog(AK);},launchOneTierAccessFileBrowser:function n(AK){window.FormWrapper.openAccessDialog(AK);},oneTierFileUploader:function q(AL,AK){mstrApp.serverRequest(R.copy(AK,{taskId:"addDriver"}),AL,true);},clearDBTables:function J(){this.model.raiseEvent({name:U,items:[],selectedItems:[]});},canDisplayCatalogSQL:function w(AO,AN){var AK=mstrmojo.hash.valarray(AO),AM=mstrmojo.array.find(AK,"v",AN),AL=AK[AM];if(mstrApp.isSingleTier){return false;}if((AL.disp&2)===2||(AL.disp&4)===4){return false;}if(!this.hasPrivilege(d)){return false;}return true;},shareDBRole:function(AL){var AK=this;if(!AL||!AL.did){return ;}AK.getDataService().getObjectInfo({success:function(AN){var AO=AN.objects[0],AM=mstrmojo.all[E];if(!AM){AM=new mstrmojo.SharingEditor({id:E,oi:AO,showSharingOptions:false});}else{AM.set("oi",AO);}AM.open();}},{objectIDs:AL.did,objectTypes:h,includeACL:true});}});}());(function(){mstrmojo.requiresCls("mstrmojo.Container","mstrmojo._FillsBrowser","mstrmojo._HasLayout","mstrmojo.ui.Splitter","mstrmojo.qb.thirdParty.BISourceSelector","mstrmojo.qb.thirdParty.SourceInput","mstrmojo.DI.DIHelpers");mstrmojo.requiresDescs(12384);var B=mstrmojo.DI.DIHelpers;var D="firstSplitNode",I="secondSplitNode";var H=0,C=1;mstrmojo.qb.thirdParty.RootView=mstrmojo.declare(mstrmojo.Container,[mstrmojo._HasLayout,mstrmojo._HasPopup],{scriptClass:"mstrmojo.qb.thirdParty.RootView",markupString:'<div id="{@id}" class="mstrmojo-qb {@cssClass}" style="{@cssText}"><div class="mstrmojo-qb-layout"></div><div></div></div>',markupSlots:{layout:function(){return this.domNode.firstChild;}},bindings:{layoutConfig:function(){if(B.getEnvObj().isWSDossier()){return{h:{layout:"465px"},w:{layout:"1010px"}};}else{return{h:{layout:"100%"},w:{layout:"100%"}};}}},onError:mstrmojo.emptyFn,loadView:mstrmojo.emptyFn,toggleDatabaseView:mstrmojo.emptyFn,viewMode:H,fixedViewSize:null,init:function J(O){this._super(O);var P={},N=P[this.id]={},M,K,L;N.windowSizeChanged=this.adjustSize;mstrApp.getRootController().attachDataChangeListeners(P);if(this.viewMode===H&&!mstrApp.isCloudPro){this.viewMode=C;L=mstrApp.container.size;if(L){M=parseInt(L.w,10);K=parseInt(L.h,10);}this.fixedViewSize=(!isNaN(M)&&!isNaN(K))?{w:M+"px",h:K+"px"}:{w:"1006px",h:"540px"};}if(this.viewMode===C){this.getBrowserDimensions=function Q(){return this.fixedViewSize;};}},preBuildRendering:function G(){if(this._super){this._super();}this.adjustSize({size:mstrApp.size});},children:[{scriptClass:"mstrmojo.ui.Splitter",cssClass:"mstrmojo-qb-es-whole-panel mstrmojo-bi-tools-main",config:{firstSplit:{v:"40%",min:"335px",max:undefined},secondSplit:{v:"60%",min:"550px",max:undefined},resizeHandle:{v:"2px"}},getLayoutOffsets:function F(){return{h:0,w:48};},slot:"layout",alias:"main",children:[{scriptClass:"mstrmojo.qb.thirdParty.BISourceSelector",slot:D,alias:"srcSelector"},{scriptClass:"mstrmojo.qb.thirdParty.SourceInput",slot:I,alias:"srcInput"}]}],adjustSize:function(P){var S=P.size,M,N,L=mstrApp.isCloudPro,R=L?40:0,O=L?180:104;var K=parseInt(S.w,10)-R+"px",Q=parseInt(S.h,10)-O+"px";if(this.height&&Q!==this.height){this.set("height",Q);}else{this.height=Q;}if(this.width&&K!==this.width){this.set("width",K);}else{this.width=K;}if(B.isWS()){N=document.getElementById("QBContainer");N.style.height="100%";M=N.clientHeight;this.set("height",M);}return true;},getSrcCnt:function(){return this.main.srcInput.children.length;},getSrcUrls:function E(){return this.main.srcInput.getSrcs();},removeSrcs:function A(K){this.main.srcInput.removeSrcs(K);}});}());(function(){mstrmojo.requiresCls("mstrmojo.qb.mdx.DataService","mstrmojo.warehouse.WHController","mstrmojo.qb.QBHelpers","mstrmojo.DI.DIHelpers");var P=mstrmojo.hash,F=mstrmojo.DI.DIHelpers,J=mstrmojo.qb.QBHelpers,V=mstrmojo.DI.DIConstants;function B(Z){var a=mstrApp.diShowFooterFunction;if(a){a({finish:{visible:Z}});}}function I(c){var b=c.SelDBRoleID;var e=c.dbrs;var d;var a;var Z;for(d=0;d<e.length;d++){if(b===e[d].did){a=e[d].n;break;}}Z=c.cubes[0].n;return{name:Z,desc:a};}mstrmojo.qb.mdx.Controller=mstrmojo.declare(mstrmojo.warehouse.WHController,null,{start:function H(){var d=this.rootView,Z=this.model,a,f,c,b;this.dataService=mstrmojo.qb.mdx.DataService;d.render();this.toggleDatabaseView(true);Z.loadDBTypeFilters({success:function e(){Z.loadDBRoles({success:function g(){B(true);Z.initialize();}});}});a=mstrApp.diFooterID;f=a?mstrmojo.all[a]:undefined;if(f){c=f.next;b=f.finish;Z.attachEventListener("refreshTables",c.id,f.enableButton);Z.attachEventListener("refreshTables",b.id,f.enableButton);setTimeout(function(){f.mdxRA.update();},0);}},getDataService:function K(){return this.dataService;},toggleDatabaseView:function Y(Z){this.rootView.toggleDatabaseView(Z);},addCubes:function O(Z){this.model.addCubes(Z);},addTables:function L(Z){this.model.addCubes(Z);},removeCube:function Q(Z){this.model.removeCube(Z);},updateCube:function W(Z){this.model.updateCube(Z);},handleDBTableRefresh:function S(){var a=this.model,Z=a.SelDBRoleID;a.catalogRefresh=true;a.onSelNameSpaceIDChange({value:a.SelNameSpaceID});},attachDataChangeListeners:function N(a){var Z=this.model;P.forEach(a,function(b,c){P.forEach(b,function(e,d){Z.attachEventListener(d,c,e);});});},detachDataChangeListeners:function E(a){var Z=this.model;mstrmojo.array.forEach(a,function(b){Z.detachEventListener(b);});},onCancelButtonClick:function G(){mstrApp.container.unloadQB();mstrApp.getRootController().onCancelButtonClick();},onFinishButtonClick:function U(){var Z=this.model,a={};a.onOK=function(c){if(c){Z.folderID=c.folderID;Z.cubeDesc=c.objDesc;Z.cubeName=c.objName;}Z.commitChanges({success:function b(g){var e=mstrApp.msgid,f=Z.isManagedCube,l,d;mstrApp.container.unloadQB();mstrApp.messageID=e;mstrApp.isDDA=true;mstrApp.saveCubeParams=c;mstrApp.isManagedCube=f;l=mstrApp.getRootController();if(Z.isNew){l.getDDAController().setDirectDataAccess(mstrApp.isDDA);l.dataService.set("messageID",mstrApp.messageID);l.model.isManagedCube=mstrApp.isManagedCube;d=l.model;d.cubeName=I(Z).name;if(mstrApp.isSingleTier){var j={isDirectDataAccess:d.isDirectDataAccess},k={success:function(m){if(m.objectId){d.cubeID=m.objectId;}l.wrapUpDataImport();},failure:function(m){mstrApp.hideProgress();l.displayError(mstrmojo.desc(13061,"Error in creating the dataset."),false,m&&m.message);}},h={success:function(){l.dataService.createOneTierDoc(k,j);},failure:function(m){mstrApp.hideProgress();l.displayError(mstrmojo.desc(13062,"Error in merging the duplicate report instance."),false,m&&m.message);}};if(d.operationMode===V.operationMode.edit||d.operationMode===V.operationMode.refresh){l.dataService.duplicateReportInstance(h,{messageID:d.analysisID,datasetID:d.cubeID,duplicateRIMsgID:l.dataService.messageID});}else{if(mstrApp.isSingleTier&&!Z.isManagedCube){if(g&&g.objectId){d.cubeID=g.objectId;}l.wrapUpDataImport();return ;}l.dataService.createOneTierDoc(k,j);}return ;}if(f){l.wrapUpDataImport();return ;}d=l.model;if(g&&g.objectId){d.cubeID=g.objectId;}d.path=c&&c.objPath;if(c&&c.folderID&&c!==""){d.folderID=c.folderID;}l.wrapUpDataImport();}else{if(F.isServerBasedWS()){d=l.model;d.path="serverBased";}l.wrapUpDataImport();return ;}}});};if(!Z.isManagedCube&&Z.isNew&&!F.isOnetier()){J.showSaveAsDialog(a,I(this.model));}else{a.onOK();}},onBackButtonClick:function A(){mstrApp.container.unloadQB();mstrApp.getRootController().backFromQB();},exitApplication:function D(){mstrApp.container.unloadQB();mstrApp.getRootController().exitApplication();},onHelpButtonClick:function R(){mstrApp.showHelpTopic("Creating_a_data_source_connection_to_an_OLAP_source.htm");},getProjectPrimaryDBRoleID:function X(){return this.model.SelDBRoleID;},setRecursive:function M(Z){this.model.set("recursive",Z);},getRecursive:function C(){return this.model.recursive;}});}());(function(){mstrmojo.requiresCls("mstrmojo.qb.es.DataService","mstrmojo.warehouse.WHController","mstrmojo.qb.es.AlternateSourceDialog","mstrmojo.DI.ui.dialogs.DIDirectAccessConfirmDialog","mstrmojo.qb.QBHelpers","mstrmojo.DI.DIHelpers","mstrmojo.DI.DIConstants");mstrmojo.requiresDescs(12379,12380,2171,9614,9621,1395,9613,9619,2265,8002,9612,9623,9616,9611,9622,9615,2052,2170,9620,9617,9618,5471,4444);var c=mstrmojo.array,V=mstrmojo.hash,f=mstrmojo.qb.QBHelpers,L=mstrmojo.desc,d=mstrmojo.DI.DIHelpers,k=mstrmojo.qb.EnumQBAppType,O=mstrmojo.DI.DIConstants;var j=1,R="mstr-qb-alternatesource";var H={1:L(12379,"We cannot convert the cube to a DDA cube because you are importing some tables that cannot support it. Remove them to enable this feature."),2:L(12380,"The cube has to be a direct data access cube due to some of the sources selected. You will have to delete them if you want to change this.")};function E(o){var p=mstrApp.diShowFooterFunction;if(p){p({finish:{visible:o}});}}function I(o,q){var p;p=mstrmojo.all[R]||(new mstrmojo.qb.es.AlternateSourceDialog({id:R}));if(q){p.set("zIndex",q);}p.items=o;p.open();}var G={0:L(2171,"Default"),1:L(9614,"Integer"),2:L(9621,"Unsigned"),3:L(1395,"Numeric"),4:L(9613,"Decimal"),5:L(9619,"Real"),6:L(2265,"Double"),7:L(8002,"Float"),8:L(9612,"Char"),9:L(9623,"VarChar"),10:L(9616,"Long VarChar"),11:L(9611,"Binary"),12:L(9622,"VarBin"),13:L(9615,"Long VarBin"),14:L(2052,"Date"),15:L(2170,"Time"),16:L(9620,"TimeStamp"),17:L(9617,"NChar"),18:L(9618,"NVarChar"),30:L(5471,"Big decimal")};function P(o){return G[o]||L(4444,"Unknown");}function C(z){var w=[],t,u,x,AA,o,q,r,p;c.forEach(z,function(AB){t=u=x=AA="";q=(AB.vt===3)?1:0;switch(AB.vt){case 0:case 1:case 2:case 3:t=AB.n;u=P(AB.ddt);o=AB.src;x=o.n;AA=P(o.ddt);break;case 4:t=AB.n;u=P(AB.ddt);break;case 8:o=AB.src;x=o.n;AA=P(o.ddt);break;}r=u?t+"("+u+")":t;p=AA?x+"("+AA+")":x;w.push([r,q,p]);});return w;}function Y(p){var o=[];c.forEach(p.tables,function(q){o.push(q.dbtn||"");});return{name:d.generateCubeName(o)};}mstrmojo.qb.es.Controller=mstrmojo.declare(mstrmojo.warehouse.WHController,null,{ddaController:null,start:function W(){var t=this.rootView,q=this.model,r=this,o,u,p,z;this.dataService=mstrmojo.qb.es.DataService;if(mstrApp.emmaIRRMessageID){this.dataService.emmaIRRMessageID=mstrApp.emmaIRRMessageID;}t.render();this.toggleDatabaseView(true);var w=function w(){r.loadDBRoles({success:function AA(){var AB;AB=(mstrApp.emmaTablesNum===0);E(AB);if(mstrApp.tableID&&mstrApp.msgid){q.loadTable(mstrApp.tableID);}else{if(!r.model.isForAlternateSource&&!mstrApp.msgid){r.dataService.createEmmaInstance({success:function AC(AD){mstrApp.msgid=AD.msgid;}});}}}});};if(q.specifyDBTypes){q.dbObjects.populateDBProperties({success:function x(){w();}});}else{q.loadDBTypeFilters({success:function x(){w();}});}o=mstrApp.diFooterID;u=o?mstrmojo.all[o]:undefined;if(u){p=u.next;z=u.finish;q.attachEventListener("refreshTables",p.id,u.enableButton);q.attachEventListener("refreshTables",z.id,u.enableButton);}},getCurrentZIndex:function X(){return mstrApp.diCurrentZIndex;},getDataService:function M(){return this.dataService;},toggleDatabaseView:function h(o){this.rootView.toggleDatabaseView(o);},openHelp:function Q(){var o=mstrmojo.helpPath()+(mstrApp.isFFSQL?"Importing_data_from_a_database_by_typing_a_query.htm":"Importing_data_from_a_database_by_picking_relation.htm");window.open(o);},addTable:function b(o){this.model.addTable(o);},addTables:function e(o){this.model.addTable(o);},removeTable:function U(o){this.model.removeTable(o);},removeDBRoleTables:function l(o){if(mstrApp.type===k.EmmaSingleTable){this.model.removeDBRoleTables(o);}},cancel:function F(){if(!mstrApp.isFromDI){var o=mstrApp.origin?"-2":"-1";mstrmojo.form.send({evt:"3124",src:mstrApp.name+".qbuilder.3124",relativePageNumber:o},mstrApp.name,"POST",null,null,false);}},commitChanges:function a(){this.model.commitChanges({success:function o(p){var q=p.msgid;mstrmojo.form.send({evt:"3172",messageID:q,launchingApp:"QB"},mstrApp.name,"POST",null,null,false);}});},onNextButtonClick:function K(){var o=this;this.model.commitChanges({success:function p(u){var r=mstrApp.getRootController().model,w=r.isDDA,t=r.isManagedCube;mstrApp.container.unloadQB();mstrApp.messageID=u.msgid;mstrApp.isDDA=w;mstrApp.isManagedCube=t;var q=(o.model.tableID&&o.model.isSapHana!==true)?o.model.tables:undefined;mstrApp.msgid=o.model.messageID;mstrApp.getRootController().getModel().originalMsgID=o.model.originalMsgID;mstrApp.getRootController().getModel().editingTableId=o.model.tableID;mstrApp.getRootController().afterQBProcess(undefined,q);}});},saveDDACube:function n(p){var q=this.model,r={},t;t={success:function(AC){var u=mstrApp.msgid,x=q.isDDA,z,AD,AA,AB,w,AE=q.isManagedCube;mstrApp.container.unloadQB();mstrApp.messageID=u;mstrApp.isDDA=x;mstrApp.isManagedCube=AE;z=mstrApp.getRootController();AD=z.model;z.getDDAController().setDirectDataAccess(mstrApp.isDDA);z.dataService.set("messageID",mstrApp.messageID);AD.isManagedCube=mstrApp.isManagedCube;AD.cubeName=Y(q).name;if(p&&p.folderID&&p.folderID!==""){AD.folderID=p.folderID;}if(mstrApp.isSingleTier){AA={isDirectDataAccess:AD.isDirectDataAccess,name:AD.cubeName};AB={success:function(AF){if(AF.objectId){AD.cubeID=AF.objectId;}z.wrapUpDataImport();},failure:function(AF){mstrApp.hideProgress();z.displayError(mstrmojo.desc(13061,"Error in creating the dataset."),false,AF&&AF.message);}};w={success:function(){z.dataService.createOneTierDoc(AB,AA);},failure:function(AF){mstrApp.hideProgress();z.displayError(mstrmojo.desc(13062,"Error in merging the duplicate report instance."),false,AF&&AF.message);}};if(AD.operationMode===O.operationMode.edit||AD.operationMode===O.operationMode.refresh){z.dataService.duplicateReportInstance(w,{messageID:AD.analysisID,datasetID:AD.cubeID,duplicateRIMsgID:z.dataService.messageID});}else{if(mstrApp.isSingleTier&&!q.isManagedCube){if(AC&&AC.objectId){AD.cubeID=AC.objectId;}z.wrapUpDataImport();return ;}z.dataService.createOneTierDoc(AB,AA);}return ;}if(AE){z.wrapUpDataImport();return ;}AD=z.model;if(AC&&AC.objectId){AD.cubeID=AC.objectId;}AD.path=p&&p.objPath;z.wrapUpDataImport();}};function o(){if(q.isManagedCube){t.success();return ;}r.displayMode=12;r.shouldRefresh=false;if(q.isDDA){r.shouldRefresh=false;r.saveAsFlags=O.saveAsFlags.saveAsDDA|O.saveAsFlags.saveAsOverWrite;}else{r.saveAsFlags=O.saveAsFlags.saveAsInMemory|O.saveAsFlags.saveAsOverWrite;}r.saveAsFlags|=O.saveAsFlags.saveAsWithAnswers|O.saveAsFlags.saveAsWithPrompts;r.taskId="saveAndPublishCube";r.showWait=true;r=V.copy(p,r);r.saveAsOverwrite=true;if(mstrApp.isSingleTier&&!q.isManagedCube){r.persist=1;}r.objName=r.objName||Y(q).name;r.folderID=r.folderID||"";r.msgID=r.msgid||mstrApp.msgid;delete r.objPath;mstrApp.getRootController().model.submitRequest(t,r);}mstrApp.getRootController().model.submitRequest({success:function(){if(q.operationMode!==2){mstrApp.getRootController().model.submitRequest({success:function(){o();}},{taskId:"DIClearRelationshipEMMASourceTable",showWait:true});}else{o();}}},{taskId:"DIToggleDatasetServeMode",serveMode:q.isDDA?O.datasetServeMode.dda:O.datasetServeMode.inMemory,showWait:true});},handleFinish:function N(){var o=this.model,q=this,p=o.operationMode,r={};r.onOK=function(u){o.commitChanges({success:function t(z){var w=z.msgid,AA=o.isDDA,x=o.isManagedCube;if(AA&&p!==1){q.saveDDACube(u);}else{mstrApp.container.unloadQB();mstrApp.messageID=w;mstrApp.isDDA=AA;mstrApp.saveCubeParams=u;mstrApp.isManagedCube=x;mstrApp.getRootController().afterQBProcess(true);}}});};if(p===1){r.onOK();}else{if(!o.isManagedCube&&!mstrApp.isSingleTier){f.showSaveAsDialog(r,Y(this.model));}else{r.onOK();}}},onFinishButtonClick:function m(){var p=this,o=this.model,r=p.getDDAController(),x,w,q,u=mstrApp.diCurrentZIndex,t=u?u+1:10;c.forEach(o.tables,function(z){if(z.extt||z.hanai){w=true;o.isDDA=true;}});if(!o.origIsDDA&&r.allowDDA()&&!w){x={onOK:function(){p.handleFinish();}};q={callback:x,selectedIndex:o.isDDA?0:1,zIndex:t};r.showDDAConfirmDialog(q);return ;}this.handleFinish();},onBackButtonClick:function S(){mstrApp.container.unloadQB();mstrApp.getRootController().backFromQB();},onCancelButtonClick:function g(){this.exitApplication();},exitApplication:function D(){mstrApp.container.unloadQB();mstrApp.getRootController().onCancelButtonClick();},getTableErrorMsg:function(){return this.model.addTableErrorMsg;},selectAlternateSource:function Z(x,AA,r){var u=this,z=u.dataService,t=this.model,AB=t.tables,AC,q,o,p=null,w={zIndex:r+1000};if(AB.length===0){return ;}AC=AB[0];if(AA.failure){p=function(AD){AA.failure(AD);};}q={success:function(){var AD;mstrApp.hasEditEmmaIRRSource=true;AD={success:function(AG){var AH,AF,AI,AE;if(AG.vt===1){AF=mstrApp.msgid;AI=z.emmaIRRMessageID;mstrApp.container.unloadQB();AH=mstrApp.getRootController().dataService;mstrApp.messageID=AF;if(AF){AH.set("messageID",AF);}if(AI){AH.set("emmaIRRMessageID",AI);}if(AA.success){AA.success({tableName:AC.n});}}else{AE=C(AG.cols);I(AE,r);}},failure:p};z.validateEmmaIRRAlternateSource(AD,{tbid:x,alertCfg:w});},failure:p};o={sourceType:j,tables:x,deleteTables:"0",dbRoleID:AC.dbr,dbTableName:AC.n,alertCfg:w};if(AC.ns){o.dbNamespace=AC.ns;}z.editEmmaIRRSourceTable(q,o);},getDDAController:function J(){if(this.ddaController===null){this.ddaController={shouldAskUser:true,allowDDA:function t(){var AA=mstrApp.getRootController().model,z=null,AC=!!AA.canSupportDDA,x,AB=AA.tables;if(!AC){return false;}if(AB.length>0){z=AB[0].dbr;}x=AA.dbridForDDA;if(x&&z!==null&&x!==z){AC=false;}if(!AC){return false;}c.forEach(AB,function(AD){if(AD.dbr!==z){AC=false;return false;}return true;});return AC;},onlyAllowDDA:function w(){return !!mstrApp.getRootController().model.shouldSupportDDA;},onToggleDDA:function o(AB){var z=mstrApp.getRootController().model,x=0,AA;if(z.isDDA===AB){return ;}if(AB){z.set("isDDA",true);if(!this.allowDDA()){x=1;AA=false;}}else{z.set("isDDA",false);if(this.onlyAllowDDA()){x=2;AA=true;}}if(x){mstrmojo.qb.alert(H[x]);z.set("isDDA",AA);}},checkDDACheckbox:function q(AA){var x=mstrApp.getRootController().model.ddaCheckboxID,z;if(x){z=mstrmojo.all[x];if(z){z.set("checked",AA);}}},tryEnableDDACheckbox:function r(AA){var x=mstrApp.getRootController().model.ddaCheckboxID,z;if(x){z=mstrmojo.all[x];}if(!z||!z.visible){return ;}if(!AA){if(z.enabled&&!z.checked&&!this.allowDDA()){z.set("enabled",false);}}else{if(!z.enabled&&!z.checked&&this.allowDDA()){z.set("enabled",true);}}},askUserAboutDDA:function u(x){if(x){this.shouldAskUser=false;}return this.shouldAskUser;},showDDAConfirmDialog:function p(x){var z=new mstrmojo.DI.ui.dialogs.DIDirectAccessConfirmDialog(x||{});z.open();}};}return this.ddaController;},onHelpButtonClick:function A(){mstrApp.showHelpTopic(this.model.getHelpTopic());},selectDBRole:function B(q){var p,o;if(!q){return ;}p=this.rootView.getDBConnectionList();o=c.find(p.items,"did",q);if(o>=0){p.set("selectedIndex",o);p.adjustScrollPosition(o);}}});}());(function(){mstrmojo.requiresCls("mstrmojo.Container","mstrmojo._FillsBrowser","mstrmojo._HasLayout","mstrmojo.ui.Splitter","mstrmojo.qb.es.TableDropbox","mstrmojo.DI.DIHelpers","mstrmojo.warehouse.WHPanel");mstrmojo.requiresDescs(531,12384,14083);var D=mstrmojo.desc,C=mstrmojo.dom,S=mstrmojo.array,O=mstrmojo.DI.DIHelpers,Y=mstrmojo.DI.DIConstants;var U="firstSplitNode",Q="secondSplitNode";var Z=0,I=1;var N="idx",A="li";var M=D(12384,"LIVE Data Connection does NOT support connection to multiple Database Instances currently. Please uncheck LIVE Data Connection to add table(s) from this Database Instance.");var L=D(14083,"The following table(s) cannot be added since they are not Information Views: ###");function J(d){var b=document.createElement("div"),k=C.findAncestorByAttr(d,N,true,this.domNode),h='<div class="item-ic"></div><div class="item-n" title="" style="max-width: 340px">{@n}</div><div class="item-del"></div>',e,j,a;function f(l){e=document.createElement("div");e.className="item cf";e.innerHTML=h.replace("{@n}",l).replace("\n","");return e;}if(k&&k.node){var c=this.userSelections;if(c[k.value]){var g=this.domNode.getElementsByTagName(A);S.forEach(g,function(l){a=l.getAttribute(N);if(c[a]===true){j=this.items[a].n;e=f(j);b.appendChild(e);}},this);}else{j=this.items[parseInt(k.value)].n;e=f(j);b.appendChild(e);}b.appendChild(document.createElement("div"));}b.className="mstrmojo-qb-emma-tablelist";return b;}function F(d,a){var c=this.avatar.style,b=this.restrictedToAxis;if(b!=="y"){c.left=d.x+1+"px";}if(b!=="x"){c.top=d.y+1+"px";}}mstrmojo.qb.es.RootView=mstrmojo.declare(mstrmojo.Container,[mstrmojo._HasLayout,mstrmojo._HasPopup],{scriptClass:"mstrmojo.qb.es.RootView",markupString:'<div id="{@id}" class="mstrmojo-qb {@cssClass}" style="{@cssText}"><div class="mstrmojo-qb-layout"></div><div></div></div>',markupSlots:{layout:function(){return this.domNode.firstChild;}},bindings:{layoutConfig:function(){if(O.getEnvObj().isWSDossier()){return{h:{layout:"465px"},w:{layout:"1110px"}};}else{return{h:{layout:"100%"},w:{layout:"100%"}};}}},onError:mstrmojo.emptyFn,init:function P(d){this._super(d);var e={},c={},b;e[this.id]=c;c.directDataAccessTableError=this.onTableAdded;c.maxTableError=this.onTableAdded;c.SapHanaIncompatibleTypeError=this.onTableAdded;c.windowSizeChanged=this.adjustSize;mstrApp.getRootController().attachDataChangeListeners(e);var f=this.getDBRoleSelector();var a=this.main.children[0].bottomPanel;a.getLayoutOffsets=function(){return{h:32,w:0};};f.getLayoutOffsets=function(){return{h:32,w:0};};a.searchBox.widthOffset=21;a.nameSpaces.heightOffset=35;f.heightOffset=31;a.heightOffset=31;f.newDBBtn.set("text",mstrmojo.desc(531,"Add")+"...");b=a.dbTableTree;b.createAvatarFunc=J;b.positionAvatarFunc=F;b.showTablesNum=false;},getDBRoleSelector:function G(){return this.main.children[0].topPanel;},getDBConnectionList:function H(){return this.getDBRoleSelector().dbConnections;},preBuildRendering:function B(){var a=mstrApp.getRootController().model;if(this._super){this._super();}if(this.viewMode===I){if(this._listenerProc){mstrmojo.dom.detachEvent(window,"resize",this._listenerProc);this._listenerProc=null;}}a.attachEventListener("windowSizeChanged",this.id,this.adjustSize);},onTableAdded:function K(a){var b="",c=[];switch(a.name){case"maxTableError":b=mstrApp.getRootController().getTableErrorMsg();break;case"directDataAccessTableError":b=M;break;case"SapHanaIncompatibleTypeError":S.forEach(a.data,function(d){c.push(d.n);});b=L.replace("###",c.join(", "));break;}mstrmojo.qb.alert(b,null,null,null,this.alertCfg);},renderPageLoadError:function E(){var c=this.error,b=c.message,d=c.title,a=c.btns;this.onError(c);if(!a||!a.length){mstrmojo.alert(b,null,d);}else{mstrmojo.confirm(b,null,{buttons:a,title:d});}},render:function X(){if(this.error){this.renderPageLoadError();}else{this._super();}},children:[{scriptClass:"mstrmojo.ui.Splitter",cssClass:"mstrmojo-qb-es-whole-panel",config:{firstSplit:{v:"50%",min:"350px",max:undefined},secondSplit:{v:"50%",min:"300px",max:undefined},resizeHandle:{v:"2px"}},getLayoutOffsets:function V(){return{h:0,w:!!mstrApp.isWorkstation?32:36};},slot:"layout",alias:"main",toggleDatabaseView:function W(a){this.toggleFirstItemVisibility(a);},children:[{scriptClass:"mstrmojo.warehouse.WHPanel",cssClass:"mstrmojo-qb-es-whpanel",slot:U,orientation:mstrmojo.ui.Splitter.ENUM_OR.HORIZONTAL,config:{firstSplit:{v:"50%",min:"200px"},secondSplit:{v:"50%",min:"300px"},resizeHandle:{v:"2px"}}},{scriptClass:"mstrmojo.qb.es.TableDropbox",alias:"tableDropbox",slot:Q}]}],toggleDatabaseView:function W(a){this.main.toggleDatabaseView(a);},adjustSize:function(f){var j=f.size,c=mstrApp.isCloudPro,g=c?40:0,e=(c?180:104)-(!!mstrApp.isWorkstation?40:0),b=(Y.workstation.utils.shouldShowTitleBar())?20:0;var a=parseInt(j.w,10)-g+"px",h=parseInt(j.h,10)-e-b+"px",d=parseInt(j.h,10)-e-b-305+"px";if(this.height&&h!==this.height){this.set("height",h);}else{this.height=h;}if(this.width&&a!==this.width){this.set("width",a);}else{this.width=a;}return true;},postBuildRendering:function R(){var a=mstrApp.getRootController().model;if(this._super){this._super();}if(mstrApp.size){this.adjustSize({size:mstrApp.size});}}});}());(function(){mstrmojo.requiresCls("mstrmojo.Container","mstrmojo._FillsBrowser","mstrmojo._HasLayout","mstrmojo.ui.Splitter","mstrmojo.warehouse.WHPanel","mstrmojo.qb.mdx.CubeDropbox","mstrmojo.hash","mstrmojo.DI.DIHelpers");mstrmojo.requiresDescs(531,12932,12923,12941);var B=mstrmojo.hash,C=mstrmojo.DI.DIHelpers;var E="firstSplitNode",K="secondSplitNode";var D=1;mstrmojo.qb.mdx.RootView=mstrmojo.declare(mstrmojo.Container,[mstrmojo._HasLayout,mstrmojo._HasPopup],{scriptClass:"mstrmojo.qb.mdx.RootView",markupString:'<div id="{@id}" class="mstrmojo-qb {@cssClass}" style="{@cssText}"><div class="mstrmojo-qb-layout"></div><div></div></div>',markupSlots:{layout:function(){return this.domNode.firstChild;}},viewMode:D,init:function L(Q){this._super(Q);var S={};S[this.id]={maxCubeError:this.onErrorDisplay};S[this.id].windowSizeChanged=this.adjustSize;mstrApp.getRootController().attachDataChangeListeners(S);var M=this.main.whPanel;M.topPanel.title=mstrmojo.desc(12923,"MDX Connections");M.bottomPanel.title=mstrmojo.desc(12941,"Browse Catalog");M.bottomPanel.dbTableTree.getDragAction=function R(X){var Y=this.getNodeAttributes(X.src.node),W=Y&&this.getTreeItem(Y.index);if(W&&W.cubetp){return"addCube";}};this.getBrowserDimensions=function V(){return{w:"1010px",h:"552px"};};var P=M.bottomPanel;P.searchBox.widthOffset=21;var N=this.getDBRoleSelector();N.newDBBtn.set("text",mstrmojo.desc(531,"Add")+"...");P.getLayoutOffsets=function(){return{h:32,w:0};};N.getLayoutOffsets=function(){return{h:32,w:0};};P.heightOffset=59;var U=P.dbTableTree,O=B.clone(U.tablesTreeHooks);O.isTable=function(W){return W&&W.cubetp;};U.tablesTreeHooks=O;},getDBRoleSelector:function I(){return this.main.children[0].topPanel;},preBuildRendering:function J(){var M=true;if(this._super){M=this._super();}if(this.viewMode===D){if(this._listenerProc){mstrmojo.dom.detachEvent(window,"resize",this._listenerProc);this._listenerProc=null;}}return M;},onErrorDisplay:function F(M){var N="";if(M.name==="maxCubeError"){N=mstrmojo.desc(12932,"A dataset can have only a single OLAP cube. Please create another dataset to import the second OLAP cube.");}mstrmojo.qb.alert(N,null,null,null,this.alertCfg);},bindings:{layoutConfig:function(){if(C.getEnvObj().isWSLiveMode()){return{h:{layout:"465px"},w:{layout:"1010px"}};}else{return{h:{layout:"100%"},w:{layout:"100%"}};}}},children:[{scriptClass:"mstrmojo.ui.Splitter",cssClass:"mstrmojo-qb-es-whole-panel",config:{firstSplit:{v:"50%",min:"350px",max:undefined},secondSplit:{v:"50%",min:"300px",max:undefined},resizeHandle:{v:"2px"}},getLayoutOffsets:function H(){return{h:0,w:36};},slot:"layout",alias:"main",toggleDatabaseView:function G(M){this.toggleFirstItemVisibility(M);},children:[{scriptClass:"mstrmojo.warehouse.WHPanel",cssClass:"mstrmojo-qb-es-whpanel mdx-panel",alias:"whPanel",slot:E,orientation:mstrmojo.ui.Splitter.ENUM_OR.HORIZONTAL,config:{firstSplit:{v:"50%",min:"200px"},secondSplit:{v:"50%",min:"200px"},resizeHandle:{v:"2px"}}},{scriptClass:"mstrmojo.qb.mdx.CubeDropbox",slot:K}]}],toggleDatabaseView:function G(M){this.main.toggleDatabaseView(M);},adjustSize:function(N){var O=N.size,Q=mstrApp.isCloudPro,U=Q?40:0,R=Q?180:104,S=C.isServerBasedWS()?50:0;var P=parseInt(O.w,10)-U+"px",M=parseInt(O.h,10)-R+S+"px";if(this.height&&M!==this.height){this.set("height",M);}else{this.height=M;}if(this.width&&P!==this.width){this.set("width",P);}else{this.width=P;}return true;},postBuildRendering:function A(){if(this._super){this._super();}this.adjustSize({size:mstrApp.size});}});}());(function(){mstrmojo.requiresCls("mstrmojo.Box","mstrmojo.Label","mstrmojo.warehouse.DBRoleSelector","mstrmojo.warehouse.WHPanel","mstrmojo.warehouse.ui.AvailableTablesPanel");var B=mstrmojo.dom,C=mstrmojo.css,I=mstrmojo.warehouse.EnumDataChangeEvents;function A(O){var N="mstr-qb-oAuthSourcelogout",K=document.getElementById(N),J=mstrApp.getRootController().model,L=J.tableID,M=mstrApp.getRootController().getDataService();if(!K){K=document.createElement("IFRAME");K.id=N;document.body.appendChild(K);K.style.display="none";B.attachEvent(K,"load",function(Q){var R={};var P=function P(){M.signOutOAuthSource({success:function S(){mstrApp.getRootController().handleLogout();}},R);};R.dbRoleID=mstrApp.dbrid;if(mstrApp.said){R.sourceAccountID=mstrApp.said;}if(J.isNew&&L){M.removeEmmaTable({success:P},{did:L});}else{P();}});}K.src=O;}mstrmojo.qb.bigquery.BigQuerySignOut=mstrmojo.declare(mstrmojo.Box,null,{scriptClass:"mstrmojo.qb.bigquery.BigQuerySignOut",cssClass:"mstrmojo-qb-bigquery-signout",bindings:{visible:function(){var K=mstrmojo.qb.EnumQBAppType,J=mstrApp.type;return J===K.BigQuery||J===K.BigQueryFFSQL||J===K.BigQuerySingleTable;}},children:[{scriptClass:"mstrmojo.Label",cssClass:"username",postCreate:function F(){if(this._super){this._super();}this.set("text",mstrApp.userEmail||"");}},{scriptClass:"mstrmojo.Label",text:mstrmojo.desc(12735,"Sign Off..."),cssClass:"signout",onclick:function H(){A("https://www.google.com/accounts/logout");}}]});mstrmojo.qb.bigquery.DBRoleSelector=mstrmojo.declare(mstrmojo.Box,[mstrmojo._HasLayout],{scriptClass:"mstrmojo.qb.bigquery.DBRoleSelector",markupString:'<div id="{@id}" class="mstrmojo-Box {@cssClass}" style="{@cssText}"><div></div><div></div></div>',markupSlots:{bqSignOutNode:function(){return this.domNode.children[0];},dbSelectorNode:function(){return this.domNode.children[1];}},slot:"firstSplitNode",alias:"topPanel",children:[{scriptClass:"mstrmojo.qb.bigquery.BigQuerySignOut",alias:"bqSignOut",slot:"bqSignOutNode"},{scriptClass:"mstrmojo.warehouse.DBRoleSelector",alias:"dbSelector",slot:"dbSelectorNode"}],init:function G(J){if(this._super){this._super(J);}var K=this.dbSelector.dbConnections;K.onclick=function(M){try{var P=M.target||B.eventTarget(M.hWin,M.e),O=B.findAncestorByAttr(P,"idx",true,this.domNode),L=O&&parseInt(O.value,10);if(P.className==="item-mn"&&L!==null&&!isNaN(L)){return false;}if(L!==null){mstrmojo.warehouse.ui.DBConnectionsList.prototype.onclick.call(K,M);}}catch(N){throw N;}};},setDimensions:function D(N,K){var J=parseInt(N,10);var M=parseInt(K,10),L;if(!this.layoutConfig){this.layoutConfig={h:{},w:{}};}L=this.layoutConfig;if(this.bqSignOut.visible){L.h.bqSignOutNode="38px";L.h.dbSelectorNode=(J-38)+"px";}else{L.h.dbSelectorNode=J+"px";}L.w.bqSignOutNode=M+"px";L.w.dbSelectorNode=M+"px";if(this._super){this._super(J+"px",K);}}});mstrmojo.qb.bigquery.BigQueryWHPanel=mstrmojo.declare(mstrmojo.warehouse.WHPanel,[mstrmojo._HasLayout],{scriptClass:"mstrmojo.qb.bigquery.BigQueryWHPanel",cssClass:"mstrmojo-qb-whpanel",children:[{scriptClass:"mstrmojo.qb.bigquery.DBRoleSelector",slot:"firstSplitNode",alias:"topPanel"},{scriptClass:"mstrmojo.warehouse.ui.AvailableTablesPanel",slot:"secondSplitNode",alias:"bottomPanel"}],init:function G(K){if(this._super){this._super(K);}var L={},J,M;J=L[this.id]={};M=this.bottomPanel;J[I.DBROLE_SELECTION]=function(N){if(M.refreshBtn){C.toggleClass(M.refreshBtn.domNode,"hidden",false);}};mstrApp.getRootController().attachDataChangeListeners(L);},preBuildRendering:function E(){if(this._super){this._super();}var J,K;J=this.topPanel.dbSelector;K=this.bottomPanel;J.title=mstrmojo.desc(37,"Projects");J.cssClass="bigquery-projects";K.title=mstrmojo.desc(12569,"Available Datasets");K.cssClass="AvailableTables bigquery-datasets";}});}());(function(){mstrmojo.requiresCls("mstrmojo.css","mstrmojo.dom","mstrmojo.array","mstrmojo.vi.ui.theme","mstrmojo._HasOwnAvatar","mstrmojo.vi.ui.VIDragUnit","mstrmojo.hash");var G=mstrmojo.css,E=mstrmojo.dom,B=mstrmojo.vi.ui.theme,F=mstrmojo.array,C=mstrmojo.hash;function D(P,Q,O){var N=false;F.forEach(this.getSelectedItems(),function(R){if(R.itemNode===Q||R===P){N=true;}});if(P&&!N){this.doItemSelect(P,O||{});}}var M={avatarCssClass:"mstrmojo-VIUnitList",encodeUnitAvatar:true,getDragData:function L(N){var O=N.src.node,Q=E.findAncestorByAttr(O,"idx",true,this.domNode);N.src.node=Q?Q.node:O;var P=(N.dragUnitHelper=new mstrmojo.vi.ui.VIDragUnit()).getUnitDragData(N,this.getSelectedItems());if(this.getItemDisplayName){mstrmojo.func.override({getItemDisplayName:this.getItemDisplayName},N.dragUnitHelper);}P.srcId=this.id;return P;},createAvatar:function A(O,N){if(N.dragUnitHelper){return N.dragUnitHelper.getUnitAvatar(N,this.encodeUnitAvatar);}},selectDragNode:function K(N){var O=N.src;D.call(this,this.getItemFromTarget(O.node),this.getItemNodeFromTarget(O.node),O);},onItemContextMenu:function J(O,N){D.call(this,O,this.getItemNodeFromTarget(N.getTarget()),N);if(this._super){return this._super(O,N);}},positionAvatar:function H(O,N){N.dragOffsets=N.dragUnitHelper.getDragUnitOffsets();if(this._super){this._super(O,N);}}},I=C.copy(M);I._mixinName="mstrmojo.vi.ui._HasUnitListAvatar2";I.getDragData=function(N){if(this.isDraggingItem&&!this.isDraggingItem(N)){if(this._super){return this._super(N);}}else{return M.getDragData.call(this,N);}};mstrmojo.vi.ui._HasUnitListAvatar2=mstrmojo.provide("mstrmojo.vi.ui._HasUnitListAvatar2",I);mstrmojo.vi.ui._HasUnitListAvatar=mstrmojo.provide("mstrmojo.vi.ui._HasUnitListAvatar",mstrmojo.mixin(M,mstrmojo.mixin(mstrmojo._HasOwnAvatar)));}());(function(){mstrmojo.requiresCls("mstrmojo.func","mstrmojo.array","mstrmojo.hash","mstrmojo.Container","mstrmojo._HasLayout","mstrmojo._Formattable","mstrmojo._IsDocumentTemplate","mstrmojo.Label","mstrmojo.VisUtility","mstrmojo.ui.menus.MenuConfig","mstrmojo.vi._MonitorsAppState","mstrmojo.vi.ui.rw._SupportViewFilterInVizBox","mstrmojo.util.FontLoader");mstrmojo.requiresClsP("mstrmojo.vi.viz","EnumVisualizationTemplates","EnumVizStyles","EnumWidgetTypes");var R={top:"top",left:"left","z-index":"zIndex",width:"width",height:"height"};var L=["background-color","fx"],H={width:"width",height:"height"},Y=mstrmojo.array,K=mstrmojo.hash;mstrmojo.VisBase=mstrmojo.declare(mstrmojo.Container,[mstrmojo._HasLayout,mstrmojo._Formattable,mstrmojo._IsDocumentTemplate,mstrmojo.vi.ui.rw._SupportViewFilterInVizBox,mstrmojo.vi._MonitorsAppState],{scriptClass:"mstrmojo.VisBase",updated:false,waitingForData:false,node:null,excludeData:false,skipReRender:false,updateFormatsOnUpdate:true,bgFormats:{},init:function d(m){this.excludeData=!!(mstrConfig.resolveOnly||mstrApp.isAppStatePause&&mstrApp.isAppStatePause());if(this._super){this._super(m);}},setModel:function g(m){this.set("model",m);},destroy:function c(){var m=this.model;if(m&&m.destroy){m.destroy();delete this.model;}this._super();},resize:function N(){var m=this.getFormats();if(parseInt(m.height,10)===0||parseInt(m.width,10)===0){this.domNode.style.display="none";}else{this.setDimensions(m.height,m.width);this.domNode.style.display="";}},setDimensions:function b(o,n){var m=this._super(o,n);if(m&&this.hasRendered&&!this.skipReRender){this.reRender();}return m;},reRender:function J(){this.unrender();this.render();},getWidth:function h(){return parseInt(this.width,10);},getHeight:function X(){return parseInt(this.height,10);},getLeft:function V(){return parseInt(this.left,10);},getTop:function B(){return parseInt(this.top,10);},getFonts:mstrmojo.emptyFn(),loadFonts:function E(m,n){if(mstrmojo.util.FontLoader.load(m,n)){n.success();}},preBuildRendering:function A(){if(this.requirePreload){var m=function m(){this.requirePreload=false;this.render();};if(mstrmojo.util.FontLoader.load(this.getFonts(),{success:m.bind(this),failure:m.bind(this)})){return this._super();}else{return false;}}return this._super();},buildRendering:function D(){this.height=this.getHeight();this.width=this.getWidth();this.left=this.getLeft();this.top=this.getTop();if(!this.updated){this.update();}this._super();},initFromVisProps:function a(){},postBuildRendering:function(){var m=this.isEmpty();this._super();this.raiseEvent({name:"toggleCtrlOverlay",visible:m||this.excludeData,controls:this.getVisEmptyMsgControls()});this.applyBackground();return !m;},applyBackground:function W(){var n=this.bgFormats,p,m,q,o;if(mstrApp.isExpress&&!K.isEmpty(n)){p=this.formatHandlers=this.formatHandlers||{};q=p.domNode=p.domNode||[];m="BG";o=Y.indexOf(q,m);if(o<0){q.push(m);}this.applyCSSFormatToNode("domNode",n);}},parseBgFormats:function G(){var m=this.id;return{success:function(t){var p,w,r,n,u,o,q=mstrmojo.all[m],x=q&&q.getDocModel();if(t.defn&&t.defn.layouts&&q&&x){w=t.defn.layouts;p=Y.find(w,"k",x.getCurrentLayoutKey());r=w[p];n=r&&r.units&&r.units[q.k];u=n&&n.fmts;if(u){o=q.bgFormats={};Y.forEach(L,function(z){if(u[z]){o[z]=u[z];}});}}}};},onAppStateChange:function(m){var n=mstrApp.isAppStatePause&&mstrApp.isAppStatePause(),o=m.valueWas&mstrmojo.vi.VisualInsightApp.APP_STATES.PAUSE;this.excludeData=!!(mstrConfig.resolveOnly||n);if(this._super){this._super(m);}if(n&&!o||(!n&&o&&!mstrApp.enableUpdate)){this.raiseEvent({name:"toggleCtrlOverlay",visible:this.excludeData||this.isEmpty(),controls:this.getVisEmptyMsgControls()});}},refresh:function j(m){if(this.excludeData){this.raiseEvent({name:"toggleCtrlOverlay",visible:true,controls:this.getVisEmptyMsgControls()});return ;}this._super(m);},update:function Z(p){p=p||this.node;if(p){var m=p.data;if(m){this.model.set("data",m);}this.waitingForData=!!m.nsj;if(this.waitingForData){var n="ServerJsonRWDStyle";var q=this.model,o=q.getDataService(),r={host:this,nodes:[this.k]},u;if(m.wid!==undefined){r.slices=[m.wid];}u=mstrmojo.func.wrapMethods(this.parseBgFormats(),q.docModel.getUpdateColorMapCallback(),q.docModel.getUpdateThemePaletteCallback(true),q.controller._getXtabCallback(this,false));o.retrieveServerJson(r,u,{preserveUndo:true,style:{name:n,params:{treesToRender:3}},params:{styleName:n}});this.updated=true;return false;}this.updateContentFormats(p);}if(this.model){var w=this.model&&this.model.docModel;this.initFromVisProps(this.model.vp);if(w&&w.getDocBuilder){var t=w.getDocBuilder().getMojoVisName(p);if(t){p.data.visName=t;}}}this.updated=true;if(this._super){return this._super(p);}return true;},updateContentFormats:function M(q){var o,r,n,p=q.defn,m=this.builder;if(this.updateFormatsOnUpdate&&p){if(m&&m.isPortlet&&m.isPortlet(p)){r=H;}else{r=R;}n=p.fmts||p.units[this.model.k].fmts;for(o in r){if(r.hasOwnProperty(o)&&n.hasOwnProperty(o)){this[r[o]]=n[o];}}}},isEmpty:function O(){return false;},getVisEmptyMsgControls:function I(){return[{scriptClass:"mstrmojo.Label",cssClass:"dropMsg",text:mstrmojo.desc(11668,"Drag objects here.")}];},getModel:function k(){return this.model;},getData:function Q(){return this.model.data;},getRowsAndCols:function(){var m=this.model.data.gts;return(m.row||[]).concat(m.col||[]);},getExp:function(){var m=this.model.data,n=m&&m.sc&&m.sc.exp;return n;},getDocModel:function e(){return this.model&&this.model.docModel;},getTitleRMCPopup:mstrmojo.emptyFn,getMenuHandler:function U(){return mstrmojo.emptyFn;},renderErrorMessage:function l(m){this.domNode.innerHTML='<div class="mstrmojo-message">'+m+"</div>";},getMessageID:function S(){return this.model.docModel.mid||this.model.mid;},performAction:function f(m){var n=this.model,q=this.scriptClass==="mstrmojo.heatmap.vi.VisHeatMap",p=q?n.getHMAction(m):n.getAction(m),o=p&&p.h;if(o&&this.controller[o]){this.controller[o](this,p.a);return true;}return false;},deleteSelectorControl:function P(){var m=this.getData(),n=m.sc;if(n&&parseInt(n.ct,10)===6){delete m.sc;}},findSelectorControl:function F(){var n=this.getData(),m=n&&n.sc;if(m&&parseInt(m.ct,10)===6){this.selectorControl=m;this.isMultiSelect=true;}else{delete this.selectorControl;}return this.selectorControl;},displayVizBoxVisFilterIndicator:function C(m,n){if(m&&n&&n.displayVisFilterIndicator){n.displayVisFilterIndicator();}}});})();(function(){mstrmojo.requiresCls("mstrmojo.array","mstrmojo.rw.ConditionWalk","mstrmojo.Label","mstrmojo.ui.Pulldown","mstrmojo.ui.Checkbox","mstrmojo.expr","mstrmojo.css");var F=mstrmojo.expr.ET.MQ,H=mstrmojo.expr.ET.MC,C=mstrmojo.css,B=mstrmojo.desc(14387,"Evaluate this condition independent of other dataset level conditions");var G=function(L,N){var K=L.et,I=L.m&&mstrmojo.rw.ConditionWalk.isMdxDM(L.m.did),M=((K===F||K===H)&&!this.inRelation&&!I)?"block":"none",J=(((N===1)||K!==F)&&!I)?1:0;C.toggleClass(this.toolNode,"unselectable",K===H);this.toolNode.style.display=M;this.level.set("selectedIndex",J);this.includeExist.set("visible",J===1&&(K===H||K===F));this.includeExist.set("checked",L.idcsi===undefined?false:L.idcsi);};mstrmojo.fe.ConditionWalk=mstrmojo.declare(mstrmojo.rw.ConditionWalk,null,{scriptClass:"mstrmojo.fe.ConditionWalk",markupString:'<div class="mstrmojo-rw-ConditionWalk" mstrAttach:click><div class="condition mstrmojo-ConditionNode"><div class="mstrmojo-cond-contents"></div></div><div class="walk"></div><div class="tools"></div><div class="apply"></div></div>',markupSlots:mstrmojo.hash.copy({toolNode:function(){return this.domNode.childNodes[2];}},mstrmojo.hash.copy(mstrmojo.rw.ConditionWalk.prototype.markupSlots)),layoutConfig:{h:{conditionNode:"auto",walkNode:"100%",toolNode:"auto",applyNode:"auto"},xt:true},postCreate:function E(){this.children=mstrmojo.hash.clone(this.children).concat([{scriptClass:"mstrmojo.Label",slot:"toolNode",text:mstrmojo.desc(13517,"Calculate on")},{scriptClass:"mstrmojo.ui.Pulldown",slot:"toolNode",alias:"level",isHostedWithin:false,items:[{n:mstrmojo.desc(13518,"Template level"),v:0},{n:mstrmojo.desc(13519,"Dataset level"),v:1}],onitemSelected:function I(J){var K=this.parent;if(K&&K.condition&&K.visible){K.includeExist.set("visible",J.v===1);K.condition.level=J.v;}}},{scriptClass:"mstrmojo.ui.Checkbox",alias:"includeExist",slot:"toolNode",postBuildRendering:function(){this.domNode.innerHTML=B;},oncheckedChange:function(){var J=this.parent;if(J){J.model.set("idcsi",this.checked);}}}]);if(this._super){this._super();}},onvisibleChange:function A(I){var J=this.condition;if(J&&this.toolNode&&this.visible){G.call(this,J.data,J.tree.level);}if(this._super){this._super(I);}},onmodeledit:function D(I){if(this._super){this._super(I);}if(this.toolNode){G.call(this,this.model.get(),this.model.level);}}});}());(function(){mstrmojo.requiresCls("mstrmojo.array","mstrmojo.expr","mstrmojo.css","mstrmojo.Button","mstrmojo.Label","mstrmojo.rw.ConditionWalk","mstrmojo.ui.Pulldown","mstrmojo.ui.Checkbox","mstrmojo.ui._IsIncFetchList","mstrmojo.ui.ColumnWalk","mstrmojo.mstr.DocElementDataHelper");var F=mstrmojo.expr.ET.MQ,B=mstrmojo.expr.ET.MC,H=mstrmojo.css,G=mstrmojo.desc(14387,"Evaluate this condition independent of other dataset level conditions");var D=function(Q,S){var P=Q.et,N=this.parent&&this.parent.docModel&&this.parent.docModel.datasets,M=Q.m&&mstrmojo.rw.ConditionWalk.isMdxDM(Q.m.did,N),R=((P===F||P===B)&&!this.inRelation&&!M)?"block":"none",O=(((S===1)||P!==F)&&!M)?1:0;H.toggleClass(this.toolNode,"unselectable",P===B);this.toolNode.style.display=R;this.level.set("selectedIndex",O);this.includeExist.set("visible",O===1&&(P===B||P===F));this.includeExist.set("checked",Q.idcsi===undefined?false:Q.idcsi);};mstrmojo.vi.ui.editors.fe.ConditionWalk=mstrmojo.declare(mstrmojo.rw.ConditionWalk,[mstrmojo.ui._IsIncFetchList],{scriptClass:"mstrmojo.vi.ui.editors.fe.ConditionWalk",markupString:'<div class="mstrmojo-rw-ConditionWalk" mstrAttach:click><div class="condition mstrmojo-ConditionNode"><div class="mstrmojo-cond-contents"></div></div><div class="walk"></div><div class="tools"></div><div class="apply"></div></div>',markupSlots:mstrmojo.hash.copy({toolNode:function(){return this.domNode.childNodes[2];}},mstrmojo.hash.copy(mstrmojo.rw.ConditionWalk.prototype.markupSlots)),layoutConfig:{h:{conditionNode:"auto",walkNode:"100%",toolNode:"auto",applyNode:"auto"},xt:true},children:[{scriptClass:"mstrmojo.ui.ColumnWalk",alias:"columnWalk",slot:"walkNode",height:"333px",width:"800px"},{alias:"cancelBtn",slot:"applyNode",scriptClass:"mstrmojo.Button",cssClass:"cancelBtn",title:mstrmojo.desc(2399,"Cancel"),ignoreLayout:true,onclick:function(){var M=this.parent;if(M.close){M.close();}}},{alias:"okBtn",slot:"applyNode",scriptClass:"mstrmojo.Button",cssClass:"okBtn",title:mstrmojo.desc(2397,"OK"),onclick:function(){var M=this.parent;if(M.onOK){M.onOK();}}},{scriptClass:"mstrmojo.Label",alias:"tip",slot:"applyNode",cssClass:"tip",text:"",ignoreLayout:true}],init:function K(M){this._super(M);this.attachEventListener("conditionWalkUpdateOkBtn",this.id,function(N){var P=N.valid,O=this.parent;O.toggleOkButtonStatus(P);});},postCreate:function I(){this.children=mstrmojo.hash.clone(this.children).concat([{scriptClass:"mstrmojo.Label",slot:"toolNode",text:mstrmojo.desc(13517,"Calculate on")},{scriptClass:"mstrmojo.ui.Pulldown",slot:"toolNode",alias:"level",isHostedWithin:false,items:[{n:mstrmojo.desc(13518,"Template level"),v:0},{n:mstrmojo.desc(13519,"Dataset level"),v:1}],onitemSelected:function M(N){var O=this.parent;if(O&&O.condition&&O.visible){O.includeExist.set("visible",N.v===1);O.condition.level=N.v;}}},{scriptClass:"mstrmojo.ui.Checkbox",alias:"includeExist",slot:"toolNode",postBuildRendering:function(){this.domNode.innerHTML=G;},oncheckedChange:function(){var N=this.parent;if(N){N.model.set("idcsi",this.checked);}}}]);if(this._super){this._super();}},onvisibleChange:function J(M){var N=this.condition;if(N&&this.toolNode&&this.visible){D.call(this,N.data,N.tree.level);}if(this._super){this._super(M);}},onmodeledit:function A(M){if(this._super){this._super(M);}if(this.toolNode){D.call(this,this.model.get(),this.model.level);}},getAttributeForms:function L(M){return mstrmojo.rw.ConditionWalk.getAttForms(M,this.editor.docModel.datasets);},getElements:function E(P,R){var Q={},N=R.complete,O=this;this.scrollNode=this.columnWalk.es.scrollNode;var M=this.scrollNode&&this.scrollNode.style;if(M){M.height="100%";}if(!this.ifDataHelper){this.ifDataHelper=new mstrmojo.mstr.DocElementDataHelper({source:this.editor.docModel.getDataService()});}else{this.ifDataHelper.set("items",null);}this.columnWalk.es.es.allowUnlistedValues=false;this.updateBrowseElementsParams(Q,P);this.ifDataHelper.browseConfig=Q;R=mstrmojo.func.wrapMethods(R,{complete:function(S){O.initScroll();}});this.ifDataHelper.getItems(1,R);},postNext:function C(){this.columnWalk.es.updateList(this.ifDataHelper.items);}});}());(function(){mstrmojo.requiresCls("mstrmojo.array","mstrmojo.css","mstrmojo.dom","mstrmojo.expr","mstrmojo.hash","mstrmojo.Box","mstrmojo.Button","mstrmojo.Dial","mstrmojo.Editor","mstrmojo.FilterExpr","mstrmojo.HBox","mstrmojo.Label","mstrmojo.Obj","mstrmojo.CheckBox","mstrmojo.mstr.EnumNodeProperties","mstrmojo.warehouse.EnumObjectTypes","mstrmojo.fe.FilterExprTree","mstrmojo.fe.RelationFilterExprTree","mstrmojo.fe.CreateSetEditor","mstrmojo.fe.ConditionWalk","mstrmojo.ui.Pulldown","mstrmojo.ui.StatusButton");var a=mstrmojo.expr,I=a.ET,O=a.BRANCH_FNS,Y=mstrmojo.Obj,X=mstrmojo.dom,b=mstrmojo.array,S=mstrmojo.hash,e=mstrmojo.css,F=mstrmojo.mstr.EnumNodeProperties,C=mstrmojo.warehouse.EnumObjectTypes,K={TEMPLATE:0,DATASET:1},E=mstrmojo.mstr.EnumNodeDimty,Q=b.hash([E.NodeDimtyUnspecified,E.NodeDimtyNone]),M=200,H=mstrmojo.ui.PopupConfig.ENUM_CORNERS;function Z(){var h=this.avatar;if(h){h.parentNode.removeChild(h);delete this.avatar;e.removeClass(h,[this.avatarCssClass]);}}mstrmojo.fe.FilterEditorBase=mstrmojo.declare(mstrmojo.Editor,null,{onSave:null,onCancel:null,title:mstrmojo.desc(12032,"View Filter Editor"),help:"view_filter_editor_for_report_services_documents.htm",cssClass:"mstrmojo-charcoalboxe mstrmojo-FE",showLimits:true,objectBrowsingEnabled:false,children:null,showCondWalk:false,isNewCond:false,vizTitle:"",init:function U(h){this.children=[{alias:"feContent",scriptClass:"mstrmojo.Box",cssClass:"mstrmojo-FE-content",postCreate:function(){this.children=[{scriptClass:"mstrmojo.Box",cssClass:"mstrmojo-FE-exprTool",children:[{scriptClass:"mstrmojo.ui.StatusButton",cssClass:"mstrmojo-FE-addCondition",postCreate:function j(){this.editor=this.parent.parent.parent;this.statusList=this.editor.getAddConditionList();this.status=this.statusList[0];},onButtonClick:function(k){if(k){k.handler.apply(this.editor);}}}]},this.parent.getExpressionContainerCfg()];}},this.getConditionWalkConfig(),{alias:"buttonBar",scriptClass:"mstrmojo.HBox",cssClass:"mstrmojo-Editor-buttonBar",slot:"buttonNode",toggleBtnStatus:function(j){this.children[0].btnSave.set("enabled",j);this.children[0].btnCancel.set("enabled",j);},children:[{scriptClass:"mstrmojo.HBox",cssText:"float:right; border-collapse: separate",cellSpacing:3,children:[{scriptClass:"mstrmojo.Button",cssClass:"mstrmojo-WebButton hot",text:mstrmojo.desc(118,"Save"),alias:"btnSave",onclick:function(){var j=this.editor;j.save();j.close();},bindings:{enabled:function(){return !this.editor.readOnly;},editor:"this.parent.parent.parent"}},{scriptClass:"mstrmojo.Button",cssClass:"mstrmojo-WebButton",alias:"btnCancel",text:mstrmojo.desc(221,"Cancel"),onclick:function(){var j=this.editor;if(j.onCancel){j.onCancel(j.model);}j.close();},bindings:{editor:"this.parent.parent.parent"}}]}]}];this._super(h);this.model=this.model||new Y();},save:function W(){var h=this.model;h.expr=f(h.exprForest);h.limitExpr=f(c(h.limitExprForest));this.onSave(h);},getExpressionContainerCfg:function(){var h=this;return{alias:"feExpr",scriptClass:"mstrmojo.Box",cssClass:"mstrmojo-FE-expr-list",postCreate:function(){this.children=h.getExpressionContentsConfig();},onRender:function(){X.attachMarkupEvent(this.id,this.domNode,"mousedown");},onmousedown:function(j){var k=X.eventTarget(j.hWin,j.e);if(this.isBlankArea(k)){this.clearSelect();}},isBlankArea:function(j){return j===this.domNode;},clearSelect:function(){}};},getExpressionContentsConfig:function(){return[];},getConditionWalkConfig:function(){var j=this;return{scriptClass:"mstrmojo.rw.ConditionWalk",width:"750px",objectBrowsingEnabled:false,dimtyTypes:Q,alias:"walk",visible:false,onOK:function h(){var l=this.condition;j.feContent.set("visible",true);this.set("visible",false);j.onConditionEdit(l,this.model.get());j.toggleButtonStatus(true);j.set("showCondWalk",false);},close:function k(){j.feContent.set("visible",true);this.set("visible",false);var l=this.condition;if(l&&l.isEmpty()){l.del();}j.toggleButtonStatus(true);j.set("showCondWalk",false);},targets:null,targetsLastMod:null,ets:null,condition:null,bindings:{disableElementsBrowsing:"this.parent.disableElementsBrowsing"}};},onConditionEdit:function(j,h){j.tree.modifyConditionNode(j,h);},getAddConditionList:function d(){return[{n:mstrmojo.desc(1994,"Add Condition"),handler:function(){this.mainExpr.newCondition(null,true);}}];},toggleButtonStatus:function B(h){this.buttonBar.toggleBtnStatus(h);},andOrPopupRef:{scriptClass:"mstrmojo.Editor",cssClass:"mstrmojo-FE-andOrPopup mstrmojo-CGE-andOrPopup mstrmojo-ConditionWalk",contentNodeCssClass:"mstrmojo-balloon",slot:"containerNode",modal:false,autoClose:true,showTitle:false,draggable:false,openEffect:null,closeEffect:null,onOpen:function(){var h=this.condition,l=h&&h.data&&h.data.not,m=h&&h.parent,j=m&&m.data,k=(j&&j.fn)+(l?21:0);this.list.opening=true;this.list.set("selectedItem",isNaN(k)?null:{did:k});this.list.opening=false;},children:[{scriptClass:"mstrmojo.Dial",cssClass:"mstrmojo-CGE-andOrDial",alias:"list",itemMarkup:'<div class="dial-item {@css}">{@n}</div>',itemIdField:"did",renderOnScroll:false,items:[{did:19,n:O[19]},{did:20,n:O[20]},{did:19+21,n:O["19_21"]},{did:20+21,n:O["20_21"]}],onchange:function(){if(this.opening){return ;}var j=this.parent,h=j.condition,o=this.selectedItem,n=o&&o.did,m=n>21?true:null,l=n-(m?21:0);j.close();var k=h&&h.parent;if(k&&k.data&&k.data.et===I.ANDOR){k.edit(h,l,m);}else{var p=h&&h.data;if(p&&(p.not!==m)){p.not=m;h.paint();}}}}]},createSetPopupRef:{scriptClass:"mstrmojo.fe.CreateSetEditor",contentNodeCssClass:"",cssClass:"CreateSet-Editor",title:mstrmojo.desc(12034,"Create a Set"),slot:"containerNode"},_set_busy:function(j,h){if(h){this.set("enabled",false);this.set("iconClass","mstrmojo-WaitIcon");}else{this.set("enabled",true);this.set("iconClass","");}},_set_model:function(m,j){var k=this.model,l=k!==j;if(l){this.model=j;this.modelLastSet=new Date();var h=function(n){return P(J(n));};j.exprForest=h(j.expr);j.limitExprForest=h(j.limitExpr);if(this.feContent&&this.feContent.feExpr.ve){this.feContent.feExpr.ve.nameFactory.clear();}}return l;},onUpdateBrowseElementsParams:mstrmojo.emptyFn,openWalk:function(q,r,x,z){var u=this,j=X.delta(r.domNode,u.containerNode);j.y+=(x==="andor"?16:parseInt(r.domNode.offsetHeight,10));var w={condition:r,zIndex:u.zIndex+10,left:j.x+"px",top:j.y+"px"},h;switch(x){case"andor":if(u.skipAndOrPopup){return ;}h="andOrPopupRef";break;case"createSet":case"createSetOpt":if(z&&z.e&&z.e.target){var m=z&&z.e&&z.e.target,p=X.delta(m,u.containerNode);w.left=p.x+"px";w.top=p.y+parseInt(m.offsetHeight,10)+"px";}var t=u.model.targets;h="createSetPopupRef";w.type=x;w.model={attrs:b.filter(t,function(n){return n.t===C.ATTRIBUTE;}),metrics:b.filter(t,function(n){return n.t===C.METRIC;})};if(x==="createSetOpt"){w.condition=r.parent;w.model.childIdx=r.childIndex();}break;case"condition":var o=u.walk,k=r.textNode.cloneNode(true),l=o.conditionNode.firstChild;e.removeClass(k,"editable");e.addClass(o.conditionNode,"mstrmojo-ConditionNode");if(l.firstChild){l.removeChild(l.firstChild);}l.appendChild(k);o.set("objectBrowsingEnabled",u.objectBrowsingEnabled);o.set("targets",u.model.targets);o.set("targetsLastMod",u.modelLastSet);o.set("ets",r.tree.validExprTypes||u.validExprTypes);o.set("condition",r);o.set("model",S.clone(q));o.set("hasPrompt",u.model.hasPrompt);o.set("disableElementsBrowsing",u.disableElementsBrowsing||o.disableElementsBrowsing);o.set("editor",u);o.set("inRelation",r.inRelation);u.feContent.set("visible",false);o.set("visible",true);o.columnWalk.target.updateScrollbars();u.toggleButtonStatus(false);u.set("showCondWalk",true);u.set("isNewCond",!!q.isNew);return ;}u.openPopup(h,w);}});mstrmojo.fe._isReportFilterEditor=mstrmojo.provide("mstrmojo.fe._isReportFilterEditor",{_mixinName:"mstrmojo.fe._isReportFilterEditor",getExpressionContainerCfg:function(){var h=this._super();return mstrmojo.mixin({clearSelect:function(){this.re.clearTreeSelect();}},h);},getExpressionContentsConfig:function(){return[{alias:"re",scriptClass:"mstrmojo.fe.ReportFilterExprTree",level:K.DATASET,bindings:{items:"this.editor.model.exprForest || []"},postApplyProperties:function(){this.editor=this.parent.parent.parent;this.editor.set("mainExpr",this);}}];}});mstrmojo.fe.ReportFilterEditor=mstrmojo.declare(mstrmojo.fe.FilterEditorBase,[mstrmojo.fe._isReportFilterEditor],{scriptClass:"mstrmojo.fe.ReportFilterEditor"});mstrmojo.fe.ReportFilterExprTree=mstrmojo.declare(mstrmojo.fe.FilterExprTree,null,{scriptClass:"mstrmojo.fe.ReportFilterExprTree",cssClass:"mstrmojo-expr mstrmojo-FE-datasetExpr",onNew:function(h){h.data.isNew=true;this.editor.openWalk(h.data,h.widget.ctxtBuilder.itemWidgets[h.index],"condition");},onnodeclick:function A(h){var j=h.editor||this.tree.editor;j.openWalk(this.data,this,h&&h.part,h);},allowDrop:function G(h){var k=h&&h.src,m=k&&k.data,l=m&&m.et,j=k&&k.widget&&k.widget.tree;return l&&this!==j;}});mstrmojo.fe.FilterEditor=mstrmojo.declare(mstrmojo.fe.FilterEditorBase,null,{getExpressionContainerCfg:function(){var h=this._super();return mstrmojo.mixin({isBlankArea:function(j){if(this._super(j)){return true;}return !b.filterOne([this.ve,this.vle,this.re],function(k){if(k&&X.contains(k.domNode,j,true)){return true;}});},clearSelect:function(){this.ve.clearTreeSelect();this.vle.clearTreeSelect();}},h);},getExpressionContentsConfig:function(){return[{scriptClass:"mstrmojo.Label",text:mstrmojo.desc(11746,"Dataset Level Conditions"),cssClass:"mstrmojo-FE-expr-header dl",bindings:{visible:"true || this.parent.parent.parent.showLimits"}},{alias:"ve",scriptClass:"mstrmojo.fe.RWViewFilterExprTree",level:K.DATASET,bindings:{items:"this.editor.model.exprForest || []"},onBlankClick:function(h){this.parent.clearSelect(h);},supportRelation:true,postApplyProperties:function(){this.editor=this.parent.parent.parent;this.editor.set("mainExpr",this);}},{scriptClass:"mstrmojo.Label",text:mstrmojo.desc(11747,"Template Level Conditions"),cssClass:"mstrmojo-FE-expr-header tl",bindings:{visible:"this.parent.parent.parent.showLimits"}},{alias:"vle",scriptClass:"mstrmojo.fe.RWViewLimitExprTree",level:K.TEMPLATE,bindings:{visible:"this.editor.showLimits",items:"this.editor.model.limitExprForest || []"},onBlankClick:function(h){this.parent.clearSelect(h);},postApplyProperties:function(){this.editor=this.parent.parent.parent;this.editor.set("limitExpr",this);}}];},getConditionWalkConfig:function(){var h=this._super();S.copy({scriptClass:"mstrmojo.fe.ConditionWalk"},h);return h;},getAddConditionList:function d(){var h=this._super();h.push({n:mstrmojo.desc(12055,"Add Dynamic Condition"),handler:function(){this.mainExpr.newCondition({et:I.XML,idc:1,ph:{}},true);}});return h;},onConditionEdit:function(k,j){if(k.tree.level===k.level||k.tree.level===undefined){this._super(k,j);}else{k.parent.remove(k.data);var h=K.TEMPLATE===k.level?this.limitExpr:this.mainExpr;h.addSingleCondition(j);}}});mstrmojo.fe.RWViewFilterExprTree=mstrmojo.declare(mstrmojo.fe.RelationFilterExprTree,null,{scriptClass:"mstrmojo.fe.RWViewFilterExprTree",cssClass:"mstrmojo-expr mstrmojo-FE-datasetExpr",levelSwitchValidTypes:[I.MQ],onNew:function(h){h.data.isNew=true;if(!h.data.ph){this.editor.openWalk(h.data,h.widget.ctxtBuilder.itemWidgets[h.index],"condition");}},onnodeclick:function A(j){var h=this.tree,l=j.editor||h.editor;this.level=h.level;var k=typeof (l.disableElementsBrowsing)==="function"&&l.disableElementsBrowsing();if(k&&this.data.et===I.AE){return ;}l.openWalk(this.data,this,j&&j.part,j);},ondragend:function N(k){var j=k&&k.tgt,h=j&&j.widget;if(this.tree&&h&&h.tree&&h.tree!==this.tree){Z.call(this);return ;}this._super(k);},getItemConfig:function(k,h,l){var j=this._super(k,h,l);return S.copy({getConditionTextPostfix:function(){if(this.data.et!==I.MQ){return"";}return'<img class="mstrmojo-moveToViewLimit" src="../images/1ptrans.gif" title="'+mstrmojo.desc(4978,"Move to view limit")+'"onclick="var w = mstrmojo.all[\''+this.id+"']; w.tree.moveMQNodeToViewLimit(w); return false;\" />";}},j);},moveMQNodeToViewLimit:function(k){if(b.indexOf(this.levelSwitchValidTypes,k.data.et)===-1){return ;}var j=S.copy(k.data);k.parent.remove(k.data);var h=this.editor.limitExpr;h.addSingleCondition(j);},allowDrop:function G(h){var k=h&&h.src,n=k&&k.data,m=n&&n.et,l=this.tree,j=k&&k.widget&&k.widget.tree;return m&&(this===l?(j!==l):true);}});mstrmojo.fe.RWViewLimitExprTree=mstrmojo.declare(mstrmojo.fe.FilterExprTree,null,{scriptClass:"mstrmojo.fe.RWViewLimitExprTree",cssClass:"mstrmojo-expr mstrmojo-FE-limitExpr",validExprTypes:b.hash([I.MQ]),levelSwitchValidTypes:[I.MQ],onnodeclick:function A(j){var h=this.tree,k=h.editor;this.level=h.level;k.openWalk(this.data,this,j&&j.part,j);},onConditionEdit:function(j,h){this._super(j,h);j.data.mdxUnitId=j.data.m.did;V(j);},addSingleCondition:function(j){var h=this._super(j);V(h);},allowDrop:function(h){var l=h&&h.src,n=l&&l.data,m=n&&n.et,k=this.tree,j=l&&l.widget&&l.widget.tree;if(k===j){return this!==j&&this.data&&(this===l.parent||this.data.mdxUnitId===(n&&n.mdxUnitId));}return !(b.indexOf(this.levelSwitchValidTypes,m)===-1);},ondrop:function L(j){var m=j&&j.src,h=m&&m.widget;if(h&&h.tree!==this.tree){var l=m&&m.data;if(l&&l.index!==null){var k=h.ctxtBuilder.itemWidgets[l.index];k.tree.moveMQNodeToViewLimit(k);}m.data=null;}this._super(j);},isEditable:function(h){return h.mdxUnitId&&this._super(h);},ondragend:function R(h){var l=h&&h.tgt,j=l&&l.widget;if(j&&j.tree!==this.tree){var k=h.src&&h.src.data;if(k&&(k.indices||(k.index!==null))){this.remove(k.indices||k.index);}Z.call(this);}else{this._super(h);}},moveMQNodeToViewFilter:function(j){var h=this.editor.mainExpr;j.parent.remove(j.data);h.addSingleCondition(j.data);},getItemConfig:function(k,h,l){k.mdxUnitId=D(k);var j=this._super(k,h,l);return S.copy({cssClass:g(k,h,l)?"per-metric-limit":"",forbidRelation:true,getConditionTextPostfix:function(){if(this.data.et!==I.MQ||mstrmojo.rw.ConditionWalk.isMdxDM(this.data.m.did)){return"";}return'<img class="mstrmojo-moveToViewFilter" src="../images/1ptrans.gif" title="'+mstrmojo.desc(9746,"Move to view filter")+'"onclick="var w = mstrmojo.all[\''+this.id+"']; w.tree.moveMQNodeToViewFilter(w); return false;\" />";}},j);}});function P(j){var h=[];b.forEach(j,function(k){if(!k){return ;}if(k.et===I.ANDOR&&!(k.node&F.CONDITION)){k.nds=P(k.nds);if(k.nds.length===0){return ;}else{if(k.nds.length===1){var l=k.nds[0];if(k.not){l.not=!l.not;}h.push(l);return ;}}}h.push(k);});return h;}function J(h){return h?[h]:[];}function f(h){return h&&h.length===1?h[0]:null;}function c(k){var j=P(k),h;if(!j[0]||j[0].mdxUnitId){h={et:I.ANDOR,fn:a.FN.AND,nds:j};}else{h=j[0];}return[h];}function g(j,h,k){return(k===k.tree||k.parent===k.tree)&&!!j.mdxUnitId;}function D(j){if(!("mdxUnitId" in j)){var h;switch(j.et){case I.MQ:case I.MC:h=j.m.did||null;break;case I.ANDOR:b.forEach(j.nds,function(l){var k=D(l);if(h===undefined){h=k;}else{if(h!==k){h=null;return false;}}return true;});break;default:h=undefined;break;}j.mdxUnitId=h;}return j.mdxUnitId;}function V(n){var p=n.tree,o=p.ctxtBuilder.itemWidgets[0],t=n.parent,q=b.indexOf(t.items,n.data),l=t.items[q],j=l.mdxUnitId;if(t===p){return ;}if(t.data.mdxUnitId===j){return ;}if(o.data.mdxUnitId){var k={et:I.ANDOR,fn:a.FN.AND,nds:[o.data,l]};p.remove(0);p.add([k]);p.ctxtBuilder.itemWidgets[0].ctxtBuilder.itemWidgets[0].remove(l);}else{var m=o,h;b.forEach(o.data.nds,function(w,u){if(w.mdxUnitId===l.mdxUnitId&&o.items[u]!==l){m=o.ctxtBuilder.itemWidgets[u];h=u;return false;}});if(m===t){return ;}if(m.data.et!==I.ANDOR){var r={et:I.ANDOR,fn:a.FN.AND,nds:[m.data,l]};o.add([r],h+1);o.remove(m.data);}else{m.add([l]);}t.remove(l);}}}());(function(){mstrmojo.requiresCls("mstrmojo.VisBase","mstrmojo.DocPortlet");var L={top:"top",left:"left","z-index":"zIndex",width:"width",height:"height"},P,B;mstrmojo.Vis=mstrmojo.declare(mstrmojo.VisBase,null,{scriptClass:"mstrmojo.Vis",offsetTop:0,offsetLeft:0,isAndroid:window.navigator.userAgent.indexOf("Android")!=-1,reRenderOnDimensionChg:true,isVis:function(){return true;},setModel:function Q(R){this._super(R);if(R.data){this.set("model",R.data);}this.xtabModel=R;if(this.controller&&typeof (this.controller.getPageByTree)!="undefined"){this.controller.getPageByTree(false);}},destroy:function O(){this._super();var R=this.xtabModel;if(R&&R.destroy){R.destroy();delete this.xtabModel;}},setDimensions:function N(U,S){var R=this._super(U,S);if(R&&this.hasRendered&&this.reRenderOnDimensionChg){this.reRender();}return R;},buildRendering:function M(){if(this.parent instanceof mstrmojo.DocPortlet){delete this.left;delete this.top;this.height=this.fmts&&this.fmts.height;}this._super();},postBuildRendering:function G(){P=this.width;B=this.height;this.adjustWidgetOffsets();this._super();},adjustWidgetOffsets:function E(){var R=mstrmojo.boxmodel.offset(this.domNode);this.offsetTop=R.top;this.offsetLeft=R.left;},update:function F(W){W=W||this.node;if(W){if(W.data){this.set("model",W.data);if(this.xtabModel&&this.xtabModel.set){this.xtabModel.set("data",W.data);}this.model=W.data;if(this.model.layoutModel){this.layoutModel=this.model.layoutModel;}if(this.model.layoutNode){this.layoutNode=this.model.layoutNode;}mstrmojo.hash.copy(W.data.extProps,this);}var U=this.controller,S=U.view,Y=(S.hasRendered&&S.getCurrentLayout&&S.getCurrentLayout());if(U.view.fullScreenInfoWindow&&(Y&&Y.defn.visName)){var X=mstrApp.rootView.getContentDimensions();this.height=X.h+"px";this.width=X.w+"px";}else{this.fmts=W.defn.fmts||W.defn.units[this.model.k].fmts;var R=this.fmts;if(R){for(var V in L){v=L[V];if(V in R){this[v]=R[V];}}}}}if(this.model){this.initFromVisProps(this.model.vp);}this.updated=true;return true;},getModel:function A(S){if(S){var R=mstrmojo.Vis.getVisGrid(this.layoutModel,this.layoutNode,S);if(R){return R.data;}else{alert(mstrmojo.desc(8427,"Incorrect visualization properties encountered.  Data may be inconsistent.  Please reset your properties."));return{};}}else{return this.model;}},getDataParser:function K(R){return new mstrmojo.Vis.DataParser(this.getModel(R));},renderErrorMessage:function H(R){this.domNode.innerHTML='<div class="mstrmojo-message">'+R+"</div>";},getMessageID:function J(){return this.model.mid&&this.model.mid||this.xtabModel&&this.xtabModel.docModel&&this.xtabModel.docModel.mid;},hasNoninfowindowTarget:function D(V){var c=this.xtabModel,b=(c&&c.docModel);var d=false;if(b){var a=b.defn&&b.defn.layouts,U=null;var S;if(a){for(S in a){if(a[S].loaded){U=a[S];break;}}}var W=U&&U.units;this.selectorTargets={};if(W&&V.scObjList){for(var S=0;S<V.scObjList.length;S++){var X=V.scObjList[S];var Y=X.sc.tks.split("\x1E");for(var R=0;R<Y.length;R++){var Z=W[Y[R]];if(Z){this.selectorTargets[Y[R]]=Z;if(!this.isChildOfIfw(W,Z)){d=true;}}}}}}return d;},isChildOfIfw:function I(R,S){while(S){if(S.ifw){return true;}S=R[S.pnk];}return false;},performAction:function C(R){var U=this.xtabModel.getAction(R),S=U&&U.h;if(S&&this.controller[S]){this.controller[S](this,U.a);return true;}return false;}});mstrmojo.Vis.getVisGrid=function(R,Z,S){var X=Z;var V=R.getChildren(Z,false);for(var U=0;U<V.length;U++){var Y=V[U];if(Y.k==S){return Y;}else{var W=mstrmojo.Vis.getVisGrid(R,Y,S);if(W){Z=X;return W;}}}};mstrmojo.Vis.DataParser=function(U){var b=mstrmojo.Vis;return{getRowTitles:function(){return new b.Titles(U,true);},getColTitles:function(){return new b.Titles(U,false);},findMetricValue:function(g,l){var k=U.ghs.rhs.items;for(var h in k){var j=k[h].items;var f=true;for(var d in g){if(g[d]!=j[d].idx){f=false;break;}}if(f){return new mstrmojo.Vis.MetricValue(U.gvs.items[h].items[l]);}}},getTotalRows:function X(){var c=U.ghs&&U.ghs.rhs&&U.ghs.rhs.items;return(U.eg||!c)?0:c.length;},getTotalColHeaderRows:function V(){return(!U.ghs.chs.items?0:U.ghs.chs.items.length);},getTotalCols:function R(){return this.getColHeaders(0).size();},getRowHeaders:function a(c){return new b.Headers(U,c,true);},getColHeaders:function Z(c){return new b.Headers(U,c,false);},getMetricValue:function Y(d,c){return new b.MetricValue(U,U.gvs.items[d].items[c]);},getColumnHeaderCount:function W(){return U.gvs.items[0].items.length;},getCSSString:function S(){return U.cssString;}};};mstrmojo.Vis.Titles=function(R,X){var W=(X)?R.gts.row:R.gts.col;return{size:function V(){return W.length;},getTitle:function U(Y){return new mstrmojo.Vis.Title(W[Y]);},getCSS:function S(Y){return R.css[W[Y].cni].n;}};};mstrmojo.Vis.Headers=function(S,U,Y){var Z=(Y)?S.gts.row:S.gts.col;var X=(Y)?S.ghs.rhs:S.ghs.chs;var V=X.items&&X.items[U].items;return{size:function a(){return(!V?0:V.length);},getHeader:function R(b){return V&&V[b]&&new mstrmojo.Vis.Header(V[b],Y?Z[b]:Z[U]);},getCSS:function W(b){return V&&S.css[V[b].cni].n;},getHeaderCell:function(b){return V&&V[b];}};};mstrmojo.Vis.Title=function(S){return{getActionType:function(){return S.at;},getDrillPath:function(){return S.dp;},getHeaderValues:function R(){return S.es;},getHeaderName:function U(W){return S.es[W].n;},getHeaderId:function U(W){return S.es[W].id;},getForms:function V(){return S.fs;},getFormId:function(){return S.fid;},getFormType:function(){return S.ftp;},getUnitId:function(){return S.id;},getLinkMap:function(){return S.lm;},getName:function(){return S.n;},getUnitDssType:function(){return S.otp;},getSelectorControl:function(){return S.sc;}};};mstrmojo.Vis.Header=function(U,R){return{getName:function W(){return(U.idx===-1)?"":R.es[U.idx].n;},getElementId:function Z(){return(U.idx===-1)?"":R.es[U.idx].id;},getObjectId:function V(){return(U.idx===-1)?"":R.es[U.idx].oid;},getElementIndex:function S(){return U.idx;},getActionType:function Y(){return U.at;},isTotal:function X(){return U.otr===1;}};};mstrmojo.Vis.MetricValue=function(R,Z){var Y=Z;return{getValue:function S(){return Y.v;},getThresholdType:function U(){return Y.ty;},getRawValue:function X(){return Y.rv;},getCSS:function V(){return R.css[Y.cni].n;},getThresholdValue:function a(b){if(Y.ti==undefined){return b;}return R.th[Y.ti].n;},getFillColor:function W(b){if(Y.ci==undefined){return b;}return R.fc[Y.ci].n;}};};})();(function(){mstrmojo.requiresCls("mstrmojo.dom","mstrmojo.array","mstrmojo.hash","mstrmojo.array","mstrmojo.Container","mstrmojo.TreeBrowserNode","mstrmojo.TreeBrowser","mstrmojo.TreeBrowserSelector","mstrmojo.DynamicClassFactory","mstrmojo._HasLayout","mstrmojo.ObjectBrowserDataProvider","mstrmojo.ui._HasScroller","mstrmojo.ui.SearchBox","mstrmojo.ui._HasUITheme","mstrmojo.vi.ui._IsDropTarget","mstrmojo.vi.ui._IsViPanel","mstrmojo.vi.ui.UnitList","mstrmojo.vi.ui._HasUnitListAvatar","mstrmojo.vi.ui.toolbars._HasToolbar","mstrmojo.vi.ui.CollapsibleTitleBar","mstrmojo.vi.ui.DatasetUnitMenuUtils","mstrmojo.vi.models.EnumDragSources","mstrmojo.vi.ui._CanDropFromSchema","mstrmojo.css","mstrmojo.vi.ui.theme");var G=mstrmojo.DynamicClassFactory,V=mstrmojo.array,I=mstrmojo.hash,H=mstrmojo.dom,A=mstrmojo.css,h=mstrmojo.string,F=mstrmojo.vi.ui.theme,b=mstrmojo.vi.ui.DatasetUnitMenuUtils,g=[4,12,1,47];var J={n:mstrmojo.desc(15348,"No applicable objects"),t:0},R={n:mstrmojo.desc(15559,"No result matches your search."),t:0};function L(p){var o=[],n=[],u=this._shiftStartIndex,t=this.selectedIndices,r=Math.min(u,p),q=Math.max(u,p);V.forEach(this.items,function(w,x){if(r<=x&&x<=q){if(!t[x]){o.push(x);}}else{if(t[x]){n.push(x);}}});this.addSelect(o);this.removeSelect(n);}function P(){return !mstrmojo.resolveFeature("hide-objects-description");}function Y(o){var n=mstrmojo.vi.enums.EnumDSSAccessRightFlags;return o.acg&&(o.acg&n.DssAccessRightUseFlag)&&(o.acg&n.DssAccessRightExecuteFlag);}function j(o,r){var q=o.itemsContainerNode,p=H.isMetaKey(r.src.hWin,r.src.e),u=H.eventTarget(r.src.hWin,r.src.e),n=-1;if(q&&u){V.forEach(q.childNodes,function(w,x){if(H.contains(w,u,true,w)){n=x;return false;}});}if(n!==-1){var t=o.items[n];if(!p&&!o.selectedIndices[n]){o.tree.clearTreeSelect();}if(V.indexOf(g,t.t)>=0){o.addSelect(n);}return true;}return false;}function c(p,n){var o=this.listSelector;if(o){o[p](this,this.itemsContainerNode,n);}}function M(o,p){var n=false;if(o.itemsContainerNode){V.forEach(o.ctxtBuilder.itemWidgets,function(q){if(H.contains(q.itemsContainerNode,p,q.domNode)){n=true;}});}return n;}mstrmojo.vi.ui.BrowserNodesAvatarContent=G.newComponent(mstrmojo.vi.ui.UnitList,null,{getItemProps:function(p,n){var o=this._super(p,n);o.addCls("isAvatar");return o;}});mstrmojo.vi.ui.TreeBrowserSelector=I.copy({premousedown:function(o,q,n){o.tree._selectNode=H.eventTarget(n.hWin,n.e);},premouseup:function D(AA,n,AC){if(H.isPrimaryMouseBtn(AC.e)){var r=AC.hWin,u=AC.e,x=H.eventTarget(r,u),q=H.shiftKey(AC.hWin,AC.e),AB=AA._shiftStartIndex,t=M(AA,x),z=AA.listMapper.findIndex(AA,n,x);if(z>-1&&!t&&AA.tree._selectNode===x){var o=V.indexOf(g,AA.items[z].t)!==-1;if(q&&AB>-1&&o){AA.rangeSelect(z);}else{AA.toggleSelect(z);if(AA.selectedIndices[z]&&o){AA._shiftStartIndex=z;}}}}}},mstrmojo.TreeBrowserSelector);mstrmojo.vi.ui.TreeBrowser=G.newComponent(mstrmojo.TreeBrowser,[mstrmojo.vi.ui._HasUnitListAvatar],{containerResizable:false,draggable:true,avatarCssClass:"mstrmojo-VIUnitList",rangeSelect:L,_selectNode:null,_shiftStartIndex:-1,blockBegin:1,blockCount:50,getContent:function(o,t){o=o||this;var p=(o===this),n=this,u=function(w){if(p){mstrmojo.css.removeClass(n.domNode,["loading"]);}n.updateTreeContent(o,w);},q=function(w){o.contentRetrieved=true;o.set("items",[n.failItemCreaterFunc()]);mstrmojo.err(w);},r={success:u,failure:q};if(p){mstrmojo.css.addClass(n.domNode,["loading"]);}if(mstrApp.objectsBlockCount){this.blockCount=parseInt(mstrApp.objectsBlockCount,10);}this.getContentThroughTaskCall({isRoot:p,data:o.data,blockBegin:t||o.blockBegin,blockCount:parseInt(mstrApp.objectsBlockCount,10)||n.blockCount},r);},getDragData:function k(o){o.dragUnitHelper=new mstrmojo.vi.ui.VIDragUnit();var r=this,t=function(z){V.forEach(z.ctxtBuilder.itemWidgets,function(AA){var AB=H.eventTarget(o.src.hWin,o.src.e);if(AB&&H.contains(AA.itemsContainerNode,AB,true,AA.itemsContainerNode)){r=AA;t(AA);return false;}});};t(this);var p=j(r,o);var u=p?this.getSelectedItems().filter(function(z){return V.indexOf(g,z.t)!==-1;}):null;var n=this.id,q=function q(z){var AC=mstrmojo.all[n],AA=AC.avatar;if(AA){var AB=[AC.avatarCssClass,"hasOwnAvatar",z];AA.className=AB.join(" ");}};return{items:u,item:u&&u[0],src:mstrmojo.vi.models.EnumDragSources.ALL_OBJECT_LIST,setAvatarClass:function w(z){q(z);},setInvalidAvatarClass:function x(){q("icn clsx_sub");}};},getSelectedItems:function(){var n=this.ctxtBuilder,o=[];if(n){V.forEach(n.itemWidgets,function(p){if(p.state===1){o=o.concat(p.getSelectedItems());}});}o=(this._super()||[]).concat(o);return o;},createAvatar:function(p,o){var n=document.createElement("div");this.avatarContent=new mstrmojo.vi.ui.BrowserNodesAvatarContent({items:o.src.data.items});this.avatarContent.render();A.addClass(this.avatarContent.domNode,[F.getThemeClass.call(this)]);n.appendChild(this.avatarContent.domNode);return n;},ondragend:function(n){this._super(n);if(this.avatarContent&&this.avatarContent.destroy){this.avatarContent.destroy();}delete this.avatarContent;},isDragValid:function S(o){var n=o.src.data.items;return(n&&n.length)||this._super(o)||false;},contentRetrieved:false,onvisibleChange:function(){if(!this.contentRetrieved){this.getContent(this);}}});mstrmojo.vi.ui.TreeBrowserNode=G.newComponent(mstrmojo.TreeBrowserNode,[{_mixinName:"newClass"}],{containerResizable:false,draggable:false,_shiftStartIndex:-1,rangeSelect:L,premousedown:function(n){this.tree._selectNode=H.eventTarget(n.hWin,n.e);},premouseup:function(o){if(H.isPrimaryMouseBtn(o.e)){var t=H.isMetaKey(o.hWin,o.e),r=H.shiftKey(o.hWin,o.e),u=H.eventTarget(o.hWin,o.e),w=H.contains(this.itemsContainerNode,u,true,this.domNode),q=w&&M(this,u),p=(this.state===2),n=!p&&(u!==this.stateNode&&u!==this.textNode)&&!w;if(q||this.tree._selectNode!==u){return ;}if((!t&&!r)||this.tree.isSelectedFolder||n){this.tree.clearTreeSelect();}if(n){this.tree.isSelectedFolder=true;}else{if(!w){this.tree.isSelectedFolder=false;}}if(!p&&(u===this.stateNode||u===this.textNode)){this.toggleState();this.tree.updateScroller();H.stopPropogation(o.hWin,o.e);}else{if(w){c.call(this,"premouseup",o);}else{this.handleNodeClicked();}}}},getSelectedItems:function(){var n=this.ctxtBuilder,o=[];if(n){V.forEach(n.itemWidgets,function(p){if(p.state===1){o=o.concat(p.getSelectedItems());}});}o=(this._super()||[]).concat(o);return o;}});function Z(p){var o=this;return I.copy(p,{scriptClass:"mstrmojo.vi.ui.TreeBrowser",alias:"contents",slot:"containerNode",isSelectedFolder:false,browserNodeClass:mstrmojo.vi.ui.TreeBrowserNode,noCheckBox:true,itemIdField:"did",useRichTooltip:true,dataProvider:this.dataProvider,listSelector:mstrmojo.vi.ui.TreeBrowserSelector,showTooltip:function t(w,AD){var AC=w.target||H.eventTarget(w.hWin,w.e),AB=H.findWidget(AC),AA=AB.data;if(AA&&AA.n){var x=AB.domNode.firstChild;var z='<div class="name">'+h.encodeHtmlString(AA.n,true)+"</div>"+(AA.desc?'<div  class="dsc">'+h.encodeHtmlString(AA.desc,true)+"</div>":"");var u=H.position(x);this.richTooltip={posType:mstrmojo.tooltip.POS_TOPLEFT,cssClass:"vi-regular vi-tooltip-C",content:z,top:u.y-4,left:u.x+u.w+6};this.constructor.prototype.showTooltip.call(this,w,AD);}},updateScroller:function(){o.updateScrollbars();},isBranch:function(u){return u.t===8;},items:null,bindings:{data:"this.parent.rootFolder"},setDimensions:mstrmojo.emptyFn,item2textCss:function n(w){var z={8:"folder",3:"report",12:"attribute",4:"metric",47:"consolidation",1:"custom-group",0:"no-obj"},u=mstrmojo.TreeBrowser.prototype.item2textCss(w)||z[w.t],x=this.parent&&this.parent.highlightItems;if(x&&x.indexOf(w.did)!==-1){u+=" highlight";}return u;},onnodechange:function r(u){this.constructor.prototype.onnodechange.call(this,u);this.parent.onSelectedItemsChange(u);},getTotalSelections:function(){return[];},getContentThroughTaskCall:function q(AD,AA){var u=this.parent,z=AD.data||{fty:u.rootFolderType},x=AD.isRoot,w=u.folderList,AB=AD.blockBegin,AC=AD.blockCount;this.dataProvider.fetchFolderContents({sId:mstrApp.sessionState,browsableTypes:u.getObjectSubTypes().join(","),includeObjectDesc:true,folderLinksContextId:u.folderLinksContextId||29,blockCount:AC||50},{fid:z.did,fty:z.fty,blockBegin:AB||1},{success:function(AF){var AE=AF.items?AF.items.filter(function(AH){return AH.t===8||Y(AH);}):[];AA.success({items:AE.length?AE:[J],sz:AF.sz,bb:AF.bb,bc:AF.bc});if(x&&!w.initialized){w.set("items",AF.sc);var AG=V.find(AF.sc,"did",AF.did);if(AG!==-1){w.set("selectedIndex",AG);}}w.initialized=true;o.updateScrollbars();},failure:AA.failure});}});}function e(o,p){if(o.state===2){var n=o.data;A.toggleClass(o.textNode,"highlight",n&&(p.indexOf(n.did)!==-1));}else{o.ctxtBuilder.itemWidgets.forEach(function(q){e(q,p);});}}mstrmojo.vi.ui.AllObjectsBrowser=mstrmojo.declare(mstrmojo.Container,[mstrmojo._HasLayout,mstrmojo.vi.ui._IsDropTarget,mstrmojo.vi.ui._IsViPanel,mstrmojo.ui._HasScroller,mstrmojo.vi.ui.toolbars._HasToolbar,mstrmojo.ui._HasUITheme],{scriptClass:"mstrmojo.vi.ui.AllObjectsBrowser",markupString:'<div id="{@id}" class="mstrmojo-VIPanel mstrmojo-VIAllObjectsBrowser {@cssClass}" style="{@cssText}"><div class="mstrmojo-VIPanel-titlebar"></div><div class="filter"></div><div class="search-box"></div><div class="horizontal-line"></div><div class="mstrmojo-VIPanel-contentContainer"><div style="overflow:hidden;"><div class="mstrmojo-VIPanel-content"></div></div></div></div>',markupSlots:{titlebarNode:function l(){return this.domNode.firstChild;},filterNode:function B(){return this.domNode.childNodes[1];},searchBox:function Q(){return this.domNode.childNodes[2];},contentNode:function m(){return this.domNode.childNodes[4].firstChild;},containerNode:function U(){return this.domNode.childNodes[4].firstChild.firstChild;}},title:mstrmojo.desc(5679,"All Objects"),model:null,rootFolder:null,rootFolderType:null,highlightItems:null,getObjectSubTypes:function(){var n=[2048,3072,1024];if(!mstrApp.isSingleTier){n.push(12032);n.push(257);n.push(2560);}return n;},layoutConfig:{h:{titlebarNode:"30px",filterNode:"30px",searchBox:"33px",containerNode:"100%"},w:{titlebarNode:"100%",searchBox:"100%",containerNode:"100%"},xt:true},opened:false,dataProvider:null,onSelectedItemsChange:mstrmojo.emptyFn,onopenedChange:function(){if(!this.searchList&&this.opened){var n=this.folderList,o=n.getSelectedItem(),p=this.rootFolder;if(o&&p&&o.did!==p.did){n.initialized=false;}this.addChildren([Z.call(this,{ondataChange:function(){if(this.data){this.getContent(this);}},ondblclick:this.dblClickOnNodes.bind(this)}),Z.call(this,{alias:"searchList",visible:false,contentRetrieved:true,ondblclick:this.dblClickOnNodes.bind(this)})]);}},reset:function(){if(this.contents){this.removeChildren(this.contents);}if(this.searchList){this.removeChildren(this.searchList);}},dblClickOnNodes:function N(o){var r=o.getTarget(),q=H.findWidget(r).data,p=this.model,n=p.getSelectedViUnit();if(n&&q&&V.indexOf(g,q.t)!==-1){this.dataProvider.loadObjects([q],{success:function(){var t=b.getCfgForAddUnitFromAllObject([q],p.datasets);if(n){n.getZonesModel().addUnitsFromDataSource([q],t.dsid,t.actions,p.getDatasetsUpdateCallback());}}},true);}},getSelectedItems:function K(){var o=this.contents,n=o.visible?o:this.searchList;return n.getSelectedItems();},getLayoutOffsets:function(){return{w:18,h:0};},children:[{scriptClass:"mstrmojo.vi.ui.CollapsibleTitleBar",cssClass:"vi-allObjects-tb",slot:"titlebarNode",alias:"titleBar",editTitleOnDoubleClick:false,getLayoutOffsets:function(){return{w:0,h:5};},onclick:function W(){this.close();},close:function(){this.parent.close();},bindings:{title:"this.parent.title"}},{scriptClass:"mstrmojo.ui.Pulldown",slot:"filterNode",alias:"folderList",initialized:false,getLayoutOffsets:function(){return{w:0,h:9};},onitemSelected:function(n){if(this.initialized){this.parent.set("rootFolder",n);this.parent.obSearchBox.clearSearch(true);}}},{scriptClass:"mstrmojo.ui.SearchBox",slot:"searchBox",alias:"obSearchBox",getLayoutOffsets:function(){return{w:0,h:13};},searchTriggered:function O(t){this.text=t;if(!t){this.clearSearch(true);return ;}var n=this.parent,q=n.contents.visible?n.contents:n.searchList,w=q.getSelectedItems(),o=n.folderList,p=this.parent.dataProvider,u=o.items[o.selectedIndex].did,r=this;w.forEach(function(x){if(x.t===8){u=x.did;return false;}});A.addClass(q.domNode,["loading"]);p.fetchFolderContents({browsableTypes:n.getObjectSubTypes().join(","),includeObjectDesc:true,folderLinksContextId:n.folderLinksContextId||29,blockCount:50,enableQuickSearch:!!(mstrApp.useQuickSearch&&mstrApp.useQuickSearch())},{fid:u,searchPattern:t,recursive:1},{success:function(x){A.removeClass(q.domNode,["loading"]);if(r.inputNode.value===t){n.contents.set("visible",false);n.searchList.set("visible",true);(n.searchList||this).set("items",x.items||[R]);n.updateScrollbars();}}});},onkeyup:function f(o){var n=o.hWin,p=o.e||n.event;if((mstrApp.useQuickSearch&&mstrApp.useQuickSearch())||((p.keyCode===13||p.keyCode===27||!this.inputNode.value))){this.constructor.prototype.onkeyup.call(this,o);}},postClearSearch:function(){var n=this.parent,p=n.contents,o=n.searchList;if(p){p.set("visible",true);}if(o){o.set("visible",false);}}}],getDropAvatarIcon:function C(n){return" ";},passToolbarCfg:function E(n){this.titleBar.set("toolbarCfg",n);},updateToolbar:function a(n){n.hasCloseButton=true;n.closeButtonText="";return n;},onhighlightItemsChange:function X(){var n=this.highlightItems;if(n){e(this.contents,n);e(this.searchList,n);}},setupScrollNodes:function d(){this.scrollNode=this.containerNode;},updateScrollbars:function(){this._super();if(this.scrollNode&&this.hasCustomScrollbar){var o=this.scrollNode,n=H.getComputedScrollbarWidth(o);o.style.marginRight=-n+"px";o.style.paddingRight=n+"px";}}});}());(function(){mstrmojo.requiresCls("mstrmojo.qb.es.RootView","mstrmojo.qb.QBHelpers");var C=mstrmojo.qb.QBHelpers;mstrmojo.qb.bigquery.ESRootView=mstrmojo.declare(mstrmojo.qb.es.RootView,null,{scriptClass:"mstrmojo.qb.bigquery.ESRootView",init:function A(D){this.children=C.clone(this.children);this.children[0].children[0].scriptClass="mstrmojo.qb.bigquery.BigQueryWHPanel";if(this._super){this._super(D);}},getDBRoleSelector:function B(){return this.main.children[0].topPanel.dbSelector;}});}());(function(){mstrmojo.requiresCls("mstrmojo.array","mstrmojo.css","mstrmojo._HasPopup","mstrmojo.Popup","mstrmojo.hash","mstrmojo.expr","mstrmojo.Container","mstrmojo.ConditionModel","mstrmojo.Widget","mstrmojo.Button","mstrmojo.ui.ColumnWalk","mstrmojo.rw.ConditionWalk","mstrmojo.mstr.EnumNodeDimty","mstrmojo.vi.ui.ConditionWalkProvider","mstrmojo.vi.ui.AllObjectsBrowser");var U=mstrmojo.Widget,M=mstrmojo.array,G=mstrmojo.dom,Q=mstrmojo.hash,b=mstrmojo.css,V=mstrmojo.Button.newWebButton,L=mstrmojo.expr,C=L.ET,A=mstrmojo.mstr.EnumNodeDimty,N=M.hash([A.NodeDimtyOutputLevel]);var O=mstrmojo.rw.ConditionWalk.getAttForms,E=mstrmojo.rw.ConditionWalk.isMdxDM;function F(){var d=this.model;if(d){if(!d.attachEventListener){Q.make(d,mstrmojo.ConditionModel,{defaultETAttr:d.defaultETAttr,data:d.data});}d.attachEventListener("edit",this.id,"onmodeledit");}}function P(e,d){if(d&&d.detachEventListener){d.detachEventListener("edit",e.id,"onmodeledit");}}mstrmojo.vi.ui.ConditionWalk=mstrmojo.declare(mstrmojo.Container,[mstrmojo._HasPopup],{scriptClass:"mstrmojo.vi.ui.ConditionWalk",markupString:'<div id="{@id}" class="mstrmojo-vi-ui-ConditionWalk" mstrAttach:click><div class="walk"></div></div>',markupSlots:{walkNode:function(){return this.domNode.firstChild;}},markupMethods:{onvisibleChange:U.visibleMarkupMethod,onheightChange:U.heightMarkupMethod,onwidthChange:U.widthMarkupMethod},layoutConfig:{h:{walkNode:"100%"},xt:true},editor:undefined,columnWalk:undefined,walkProvider:null,objectBrowsingEnabled:false,children:[{scriptClass:"mstrmojo.ui.ColumnWalk",alias:"columnWalk",slot:"walkNode",height:"370px",width:"600px"}],postCreate:function B(){if(this._super){this._super();}if(!this.walkProvider){this.walkProvider=this.addDisposable(mstrmojo.insert(mstrmojo.vi.ui.ConditionWalkProvider));}},initWalk:function W(){var d=this.columnWalk,e=this.walkProvider;d.removeTrailingContainer(-1);d.addNextColumn(e.getTargetNodeProps());d.target.updateColumnContainer();this.updateOkBtn();},ob:{scriptClass:"mstrmojo.Popup",cssClass:"mstrmojo-vi-ui-ConditionWalk ObjectBrowserPopup mojo-theme-light",children:[{scriptClass:"mstrmojo.vi.ui.AllObjectsBrowser",alias:"browser",title:mstrmojo.desc(5298,"Select an Object"),layoutConfig:null,onSelectedItemsChange:function K(){var d=this.getSelectedItems(),e=d&&d[0],f=e&&e.t;this.parent.buttons.selectBtn.set("enabled",f&&f!==L.TP.FOLDER);},browse:function R(d){Q.copy(d,this);},getObjectSubTypes:function(){var d=this.browsableTypes;if(d){return d.split(",");}return this.constructor.prototype.browsableTypes();},dblClickOnNodes:function a(d){var g=this.onSelectCB,f=d.getTarget(),e=G.findWidget(f).data;g[0][g[1]](e);}},{scriptClass:"mstrmojo.Box",alias:"buttons",cssClass:"buttons",children:[V(mstrmojo.desc(221,"Cancel"),function(){this.parent.parent.opener.closePopup();}),V(mstrmojo.desc(547,"Select"),function(){var f=this.parent.parent,g=f.browser,h=g.onSelectCB,e=g.getSelectedItems(),d=this.parent.parent.opener;if(e&&e.length>0){h[0][h[1]](e[0]);}else{d.closePopup();}},true,{alias:"selectBtn",enabled:false})]}],onOpen:function H(){var h=this.shadowNode,d=document.body,e=document.documentElement,g=h.style,f=this.domNode;this.browser.obSearchBox.clearSearch(true);g.width=Math.max(d.clientWidth,e.scrollWidth)+"px";g.height=Math.max(d.clientHeight,e.scrollHeight)+"px";window.setTimeout(function(){b.addClass(f,"open");},1);},onClose:function D(){b.removeClass(this.domNode,"open");var d=this.browser;d.opened=false;d.reset();}},_set_model:function Z(g,d){var e=this.model,f=(d!==e);if(f){P.call(this,e);d.dimtyTypes=this.dimtyTypes||N;this.model=d;F.call(this,d);this.initWalk();}return f;},onmodeledit:function J(e){var d=this.columnWalk[e.prop==="c1"?"c0":e.prop];if(e.prop==="fm"){d=this.columnWalk.target;}if(d){d.updateColumnContainer();}this.updateOkBtn();this.postmodeledit(e);},postmodeledit:mstrmojo.emptyFn,updateOkBtn:function c(){var g=true,d=this.model,e,f=d&&L.fnCstCount(d.fn,d.fnt);if(!d){return ;}switch(d.et){case C.AQ:case C.AL:case C.MQ:for(e=0;e<f;e++){g=g&&!this["invalid"+e];}break;}g=g&&!!d.completed;this.delegateUpdateOkBtn(g);},delegateUpdateOkBtn:mstrmojo.emptyFn,browse:function I(f){var h=this.parent.editorNode,g=function(k,m){var j=G.position(k,true),l=G.position(m,true);return{x:j.x+j.w,y:l.y};},d=this.columnWalk,e=this.walkProvider;switch(f&&f.alias){case"target":case"dmy":e.browseObjs(this,f);break;case"c0":case"c1":e.browseObjs(this,f);break;case"es":e.browseEs(this,f,g(d.es.domNode,h));break;}},onOBSelect:function(j){var l=j.t;if(l===L.TP.FOLDER||l===0||l===undefined){return ;}var g=this.ob.browser,m=g.target;this.closePopup();if(m.alias==="c0"){m=m.attMxPd;}var e=this.targets,k=m.itemIdField,h=e||[],d=M.find(e,k,j[k]);if(d===-1){h.push(j);this.targets=h;this.targetsLastMod=new Date();this.raiseEvent({name:"updateTargets",targets:this.targets});}m.list.set("selectedIndex",M.find(m.items,"did",j.did));if(m.onObjBrowsed){m.onObjBrowsed(j);}},getDatasets:mstrmojo.emptyFn,getAttributeForms:function X(f){var e=this.editor;if(e&&e.getAttributeForms){return e.getAttributeForms(f);}var d=this.getDatasets();return O(f,d);},getAttributeInfo:function Y(d){var e,g=this.editor;if(g&&g.model&&g.model.targets){M.forEach(g.model.targets,function(h){if(h.did===d){e=Q.clone(h);return false;}});}else{var f=this.getDatasets();Q.forEach(f,function(h){e=Q.clone(h.att.filter(function(j){return j.did===d;})[0]);if(e){return false;}});}if(e){e.fs=this.getAttributeForms(d);}return e?e:{};},isMDXDM:function S(d){return E(d,this.getDatasets());},getIfDataSource:mstrmojo.emptyFn,onUpdateBrowseElementsParams:mstrmojo.emptyFn});}());(function(){mstrmojo.requiresCls("mstrmojo.Vis","mstrmojo.color");var A=mstrmojo.css,G=mstrmojo.dom,D;mstrmojo.qb.QBTableLinker=mstrmojo.declare(mstrmojo.Vis,null,{scriptClass:"mstrmojo.qb.QBTableLinker",width:null,height:0,context:0,markupString:'<div id="{@id}" class="mstrmojo-Chart {@cssClass}" style="position:absolute;left:0px;top:0px;width:{@width}px;height:{@height}px;overflow:hidden;"  mstrAttach:mouseover,mousemove,click ><canvas width="{@width}px" height="{@height}px"></canvas><canvas style="position:absolute;left:0;top:0" width="{@width}px" height="{@height}px"></canvas><div id="{@id}-tooltip" class="mstrmojo-Map-tooltip"></div></div>',markupSlots:{canvas:function(){return this.domNode.firstChild;},highlightCanvas:function(){return this.domNode.childNodes[1];},tooltip:function(){return this.domNode.childNodes[2];}},postBuildRendering:function F(){if(this._super){this._super();}if(D===undefined){D=this.canvas&&this.canvas.getContext&&this.canvas.getContext("2d");}if(D){this.context=this.canvas.getContext("2d");this.highlight=this.highlightCanvas.getContext("2d");}else{this.createVMLCanvas();}this.model=mstrmojo.all.QBuilderModel;},getCordValue:function H(L){return CordValue;},drawLinks:function I(){this.clearCanvas();var R=mstrmojo.all.QBuilderModel;if(R.linkerNeedRender){this.render();R.linkerNeedRender=false;}var L=this.model&&this.model.joinsInfo;for(var Q in L){var Y=L[Q],N=Y.links;for(linkid in N){var U=N[linkid].srcw,O=N[linkid].tgtw,W=U.parent.parent,S=O.parent.parent,a=parseInt(W.leftAnchor()),P=parseInt(W.rightAnchor()),M=parseInt(S.leftAnchor()),Z=parseInt(S.rightAnchor()),e=W.containerNode.clientWidth,V=G.position(U.domNode),X=G.position(O.domNode),c=G.position(this.domNode),d=G.position(W.containerNode),b=G.position(S.containerNode);if(V.y>d.y&&V.y+0.5*V.h<d.y+d.h){srcwy=V.y-c.y+0.5*U.domNode.clientHeight;}else{srcwy=d.y-c.y-0.5*W.titleNode.clientHeight;}if(X.y>b.y&&X.y+0.5*X.h<b.y+b.h){tgtwy=X.y-c.y+0.5*O.domNode.clientHeight;}else{tgtwy=b.y-c.y-0.5*S.titleNode.clientHeight;}if(M>a+0.5*e){srcwx=P;srcwx1=srcwx+20;tgtwx=M;tgtwx1=tgtwx-20;}else{if(M>a&&M<a+0.5*e){srcwx=P;srcwx1=srcwx+20;tgtwx=Z;tgtwx1=tgtwx+20;}else{if(M<a&&Z>a+0.5*e){srcwx=a;srcwx1=srcwx-20;tgtwx=M;tgtwx1=tgtwx-20;}else{srcwx=a;srcwx1=srcwx-20;tgtwx=Z;tgtwx1=tgtwx+20;}}}N[linkid].marker=[{x:srcwx,y:srcwy},{x:srcwx1,y:srcwy},{x:tgtwx1,y:tgtwy},{x:tgtwx,y:tgtwy}];N[linkid].coords=[srcwx,srcwy+5,srcwx,srcwy-5,srcwx1,srcwy-5,tgtwx1,tgtwy-5,tgtwx,tgtwy-5,tgtwx,tgtwy+5,tgtwx1,tgtwy+5,srcwx1,srcwy+5];this.drawLine(srcwx,srcwy,srcwx1,srcwy);this.drawLine(srcwx1,srcwy,tgtwx1,tgtwy);this.drawLine(tgtwx1,tgtwy,tgtwx,tgtwy);switch(Y.jt){case"3":this.drawLine(srcwx,srcwy,0.5*(srcwx+srcwx1),srcwy+5);this.drawLine(srcwx,srcwy,0.5*(srcwx+srcwx1),srcwy-5);this.drawLine(tgtwx,tgtwy,0.5*(tgtwx+tgtwx1),tgtwy-5);this.drawLine(tgtwx,tgtwy,0.5*(tgtwx+tgtwx1),tgtwy+5);break;case"1":this.drawLine(srcwx,srcwy,0.5*(srcwx+srcwx1),srcwy+5);this.drawLine(srcwx,srcwy,0.5*(srcwx+srcwx1),srcwy-5);break;case"2":this.drawLine(tgtwx,tgtwy,0.5*(tgtwx+tgtwx1),tgtwy-5);this.drawLine(tgtwx,tgtwy,0.5*(tgtwx+tgtwx1),tgtwy+5);break;default:break;}}}if(D){this.context.stroke();}this.drawMarker();},clearCanvas:function K(){if(D){this.context.clearRect(0,0,this.width,this.height);this.context.beginPath();}else{var L=document.getElementById("vmlCanvas");if(L&&L.hasChildNodes()){while(L.childNodes.length>=1){L.removeChild(L.firstChild);}this.createVMLCanvasFrame();}}},clearHighLightCanvas:function(){if(D){this.highlight.clearRect(0,0,this.width,this.height);this.highlight.beginPath();}},drawMarker:function(){if(D){this.clearHighLightCanvas();if(!this.model.selLink){return ;}var P=this.model,Q=P.joinsInfo[P.selLink[0]],O=!!Q?Q.links[P.selLink[1]].marker:[],M=this.highlight;for(var N=0,L=O.length;N<L;N++){M.strokeStyle="blue";M.beginPath();M.arc(O[N].x,O[N].y,3,0,Math.PI*2,true);M.closePath();M.stroke();}}},drawLine:function C(N,P,M,O){if(D){this.context=this.canvas.getContext("2d");this.context.moveTo(N,P);this.context.lineTo(M,O);}else{var L=document.createElement("v:line");L.setAttribute("from",N+" "+P);L.setAttribute("to",M+" "+O);document.getElementById("vmlCanvas").appendChild(L);}},createVMLCanvasFrame:function J(){var L=document.createElement("v:rect");L.setAttribute("id","vmlFrame");L.setAttribute("stroke","true");L.setAttribute("strokecolor","red");L.style.width=isNaN(this.width)?"auto":this.width;L.style.height=isNaN(this.height)?"auto":this.height;L.style.zindex="-1";document.getElementById("vmlCanvas").appendChild(L);},createVMLCanvas:function E(){var N=parseInt(this.width);var M=parseInt(this.height);var L=document.createElement("v:group");L.setAttribute("id","vmlCanvas");L.style.width=isNaN(this.width)?"auto":this.width;L.style.height=isNaN(this.height)?"auto":this.height;L.setAttribute("coordorigin","0, 0");L.setAttribute("coordsize",N+", "+M);this.domNode.appendChild(L);this.createVMLCanvasFrame();return ;},renderTooltip:function B(O,R,Q,S){var L=this.model.gts;if(S>=0){var N=L.row[0].n+": "+O;var M;for(M=0,len=L.col[0].es.length;L&&L.col&&M<len;M++){var U=this.model.gvs.items[S].items[M];var P=U.v;if(U.ty==4){P='<img src="'+P+'" >';}N+="<br>"+L.col[0].es[M].n+": "+P;}this.tooltip.innerHTML=N;}if(R+this.tooltip.offsetWidth>this.width){R=R-this.tooltip.offsetWidth;}this.tooltip.style.webkitTransform="translate3d("+R+"px, "+Q+"px, 0)";this.tooltip.style.MozTransform="translate("+R+"px, "+Q+"px)";if(this.tooltip.className.indexOf("fadeIn")<0){this.tooltip.className=this.tooltip.className+" fadeIn";}}});})();(function(){mstrmojo.requiresCls("mstrmojo.expr","mstrmojo.hash","mstrmojo.fe.FilterEditor","mstrmojo.ui._HasScroller");var C=mstrmojo.hash,B=mstrmojo.expr,A=B.ET;mstrmojo.vi.ui.editors.fe.RWViewLimitExprTree=mstrmojo.declare(mstrmojo.fe.RWViewLimitExprTree,[mstrmojo.ui._HasScroller],{scriptClass:"mstrmojo.vi.ui.editors.fe.RWViewLimitExprTree",markupString:'<div id="{@id}"><div class="mstrmojo-ListBase2 {@cssClass}" style="position:relative;{@cssText}" mstrAttach:keyup,keypress,mousedown,mouseup,dblclick><div class="mstrmojo-ListBase2-itemsContainer" style="position:relative;{@itemsContainerCssText}">{@itemsHtml}</div><div class="mstrmojo-ListBase2-dropCue {@cssClass}"><div class="mstrmojo-ListBase2-dropCue-inner"></div></div></div></div>',markupSlots:{scrollboxNode:function(){return this.domNode.firstChild;},itemsContainerNode:function(){return this.domNode.firstChild.firstChild;},dropCueNode:function(){return this.domNode.firstChild.lastChild;}},levelSwitchValidTypes:[A.MQ,A.MC],getItemConfig:function(F,D,G){var E=this._super(F,D,G);return C.copy({getConditionTextPostfix:function(){return"";}},E);},setupScrollNodes:function(){this.scrollNode=this.scrollboxNode;}});}());(function(){mstrmojo.requiresCls("mstrmojo.expr","mstrmojo.hash","mstrmojo.fe.FilterEditor","mstrmojo.fe.AndOrNode","mstrmojo.fe.DynamicNode","mstrmojo.fe.ConditionNode","mstrmojo.ui._HasScroller","mstrmojo.vi.ui.editors.fe.RelationNode");var C=mstrmojo.hash,B=mstrmojo.expr,A=B.ET;mstrmojo.vi.ui.editors.fe.RWViewFilterExprTree=mstrmojo.declare(mstrmojo.fe.RWViewFilterExprTree,[mstrmojo.ui._HasScroller],{scriptClass:"mstrmojo.vi.ui.editors.fe.RWViewFilterExprTree",markupString:'<div id="{@id}"><div class="mstrmojo-ListBase2 {@cssClass}" style="position:relative;{@cssText}" mstrAttach:keyup,keypress,mousedown,mouseup,dblclick><div class="mstrmojo-ListBase2-itemsContainer" style="position:relative;{@itemsContainerCssText}">{@itemsHtml}</div><div class="mstrmojo-ListBase2-dropCue {@cssClass}"><div class="mstrmojo-ListBase2-dropCue-inner"></div></div></div></div>',markupSlots:{scrollboxNode:function(){return this.domNode.firstChild;},itemsContainerNode:function(){return this.domNode.firstChild.firstChild;},dropCueNode:function(){return this.domNode.firstChild.lastChild;}},nodeClassMap:{14:mstrmojo.fe.AndOrNode,15:mstrmojo.vi.ui.editors.fe.RelationNode,ph:mstrmojo.fe.DynamicNode,"*":mstrmojo.fe.ConditionNode},levelSwitchValidTypes:[A.MQ,A.MC],setupScrollNodes:function(){this.scrollNode=this.scrollboxNode;},getItemConfig:function(F,D,G){var E=this._super(F,D,G);return C.copy({getConditionTextPostfix:function(){return"";}},E);}});}());(function(){mstrmojo.requiresCls("mstrmojo.css","mstrmojo.dom","mstrmojo.hash","mstrmojo.Box","mstrmojo.qb.FilterValueEditor","mstrmojo.qb.QBTableLinker","mstrmojo.qb.ConditionEditor","mstrmojo.qb.DBTable","mstrmojo.ui.menus.Menu","mstrmojo.qb.DBTableRowMenu");mstrmojo.requiresDescs(221,520,521,522,523,524,525,526,612,629,686,687,688,696,746,1442,2122,2123,2125,2127,2131,2151,2219,2220,2784,2785,2786,4449,5893,8571,9126,9127,9128,9129,9640,9641,9913,9938,9939,9940,9941,12736,15479,14909,14949,14905);var Z=mstrmojo.dom,L=mstrmojo.array,K="addTable",Y="264px",a=30;var N=[0,"tick",16,"mix"];var H=[{did:"Delete",n:mstrmojo.desc(629,"Delete")},{did:-1,n:"-"},{did:"0",n:mstrmojo.desc(9640,"Inner Join")},{did:"1",n:mstrmojo.desc(9940,"Left Outer Join")},{did:"2",n:mstrmojo.desc(9941,"Right Outer Join")},{did:"3",n:mstrmojo.desc(9641,"Outer Join")},{did:-1,n:"-"},{did:"More Options",n:mstrmojo.desc(9126,"More Options")}];var F=[{did:"0",n:mstrmojo.desc(9640,"Inner Join")},{did:"1",n:mstrmojo.desc(9940,"Left Outer Join")},{did:"2",n:mstrmojo.desc(9941,"Right Outer Join")},{did:"3",n:mstrmojo.desc(9641,"Outer Join")}];var P=[{n:"=",dssid:"0"},{n:">",dssid:"1"},{n:">=",dssid:"2"},{n:"<",dssid:"3"},{n:"<=",dssid:"4"},{n:"<>",dssid:"5"}];var d=[{did:"-2",n:mstrmojo.desc(4449,"Expression")},{did:-1,n:"-"},{did:2219,n:mstrmojo.desc(2219,"In list")},{did:2220,n:mstrmojo.desc(2220,"Not in list")},{did:-1,n:"-"},{did:520,n:mstrmojo.desc(520,"Exactly")},{did:612,n:mstrmojo.desc(612,"Not Exactly")},{did:-1,n:"-"},{did:521,n:mstrmojo.desc(521,"Greater than")},{did:523,n:mstrmojo.desc(523,"Less than")},{did:522,n:mstrmojo.desc(522,"Greater than equal")},{did:524,n:mstrmojo.desc(524,"Less than equal")},{did:-1,n:"-"},{did:"-5",n:mstrmojo.desc(9939,"Strings"),fns:[{did:525,n:mstrmojo.desc(525,"Like")},{did:526,n:mstrmojo.desc(526,"Not like")},{did:686,n:mstrmojo.desc(686,"Contains")},{did:2784,n:mstrmojo.desc(2784,"Does not contain")},{did:687,n:mstrmojo.desc(687,"Begins with")},{did:2785,n:mstrmojo.desc(2785,"Does not begin with")},{did:688,n:mstrmojo.desc(688,"Ends with")},{did:2786,n:mstrmojo.desc(2786,"Does not end with")}]},{did:-1,n:"-"},{did:"Between",n:mstrmojo.desc(696,"Between")},{did:"Not between",n:mstrmojo.desc(746,"Not between")}];var b=[{did:"0",n:mstrmojo.desc(4449,"Expression")},{did:"1",n:mstrmojo.desc(9913,"Aggregation Function"),fns:[{did:"-6",n:mstrmojo.desc(2131,"Sum"),idx:1},{did:"-6",n:mstrmojo.desc(2122,"Average"),idx:2},{did:"-6",n:mstrmojo.desc(2127,"Minimum"),idx:3},{did:"-6",n:mstrmojo.desc(2125,"Maximum"),idx:4},{did:"-6",n:mstrmojo.desc(2123,"Count"),idx:5},{did:"-6",n:mstrmojo.desc(9938,"Count Distinct"),idx:6}]},{did:"2",n:mstrmojo.desc(2151,"Filter"),fns:d}];function U(k){return a*(k?(k+2):1);}function M(q){var l=mstrmojo.all.QBuilderModel,n,o=[],p;if(!q.srcData){n=l.gettIndex(q.id);for(var m=1,k=q.Rows.children.length;m<k;m++){p=q.Rows.children[m];if(p.visible){o.push(p);}}}else{o.push(q);n=l.gettIndex(q.parent.parent.id);}l.addSelectedColumns(o,n,null,{success:function(){var u=0,r=o.length,t;for(u;u<r;u++){t=o[u];t.updateState(1);t.count++;}}});}var B=0,J=1,j=3;function g(k,m,o){var p="mstr-qb-table-moreCM",n=mstrmojo.all[p];if(!n){n=new mstrmojo.MenuButton({id:p,cmCssClass:"mstrmojo-CXM",alias:"fctmenu",itemChildrenField:"fns",itemIdField:"did",itemField:"n",iconClass:"mstrmojo-qb-ListIcon div",cm:b,domSrc:m,obj:o,dynamicUpdate:true,getMenuPosition:function l(){var q=mstrmojo.dom.position(this.domSrc,true);return{x:Math.round(q.x),y:Math.round(q.y+q.h)};},executeCommand:function(AK){var AD=this.obj,x=mstrmojo.all.QBuilderModel,u=AD.parent.parent,AJ=x.gettIndex(AD.srcID);switch(AK.did){case"0":mstrApp.getRootController().openExpressionEditor({type:B,w:AD,tkn:AD.expr});break;case"-2":mstrApp.getRootController().openExpressionEditor({n:mstrmojo.desc(5893,"New Condition"),w:AD,tkn:AD.expr,callbacks:{success:function AC(AN){var w=AN.mi;mstrApp.getRootController().addNewFilter({et:"*",expr:w.items,n:AN.expr,sqltp:w.exp.sqltp});}}});break;case"-6":var q=x.selectedClns,AG=q.length,AI=new Array(),z=AD.parent.children,AH=u.selectedIndex;AI.push(AD);var AF={success:function(){var AP=0,AN=AI.length,AO;for(AP;AP<AN;AP++){AO=AI[AP];if(AO.state==0||AO.state==2){AO.state++;AO.images[1]=AO.img[AO.state];AO.render();}AO.count++;}},failure:function(){}};x.addSelectedColumns(AI,AJ,AK.idx,AF);break;default:var t=this.obj,AE=t.dt.tp,AA={14:true,15:true,16:true},AL={30:true},AB,AM,r;switch(AK.did){case"Between":case"Not between":r=2;break;default:r=1;}AM="mstr-qb-fve";AB=mstrmojo.all[AM]||(new mstrmojo.qb.FilterValueEditor({id:AM}));AB.n=AK.n;AB.operatorID=AK.did;AB.column=t.oriexpr;AB.isDateTime=AA[AE];AB.isBigDecimal=AL[AE];AB.paraNum=r;AB.open();}}});n.render();}else{n.set("domSrc",m);n.set("obj",o);}n.showContextMenu();n.onContextMenuClose=function(){m.style.visibility="inherit";};}function e(l,m){var o={success:function(){var q,p;q=l.menuHelper;if(!q){q=l.menuHelper=new mstrmojo.qb.DBTableRowMenu();}q.tableRow=l;p=q.getMenuConfig();p.hostId=l.id;p.hostElement=l.domNode;if(m.position){p.position=m.position;}p.isHostedWithin=false;l.openPopup(new mstrmojo.ui.menus.Menu({popupConfig:p}));}},k=mstrApp.getRootController();if(k.getFunctionList()){o.success();return ;}k.model.getFunctions(false,{success:function n(){o.success();}},{showWait:true});}function G(o,n,m){var k=mstrmojo.all.QBuilderModel,p=Z.position(m.domNode),t=o.clientX,q=o.clientY,r=k.getTouchValue(t-p.x,q-p.y),l=Z.position(m.domNode,true);if(r){k.selLink=r;n.drawMarker();f.call(this,o,r,n,{x:t+(l.x-p.x),y:q+(l.y-p.y)});}else{k.selLink=null;n.clearHighLightCanvas();}}var S={};function f(w,l,o,t){var m=mstrApp.diCurrentZIndex,n=m>999?m+1:999,r=this,u=r.joinMenuOption.mappingKey,k=r.joinMenuOption.menuItems,p=S[u];if(!p){p=S[u]=new mstrmojo.MenuButton({cmCssClass:"mstrmojo-CXM",cm:k,zIndex:n,itemChildrenField:"fns",itemIdField:"did",itemField:"n",dynamicUpdate:true,obj:l,pos:t,linker:o,getMenuPosition:function q(){return this.pos;},queryChecked:function(AA){switch(AA.did){case"Delete":case -1:case"More Options":return false;default:var x=mstrmojo.all.QBuilderModel;var z=x.selLink[0];return(x.joinsInfo[z].jt==AA.did);}},executeCommand:function(AC){var AD=this.linker;var z=mstrmojo.all.QBuilderModel;var AB=this.obj,AA=AC.did;switch(AA){case"Delete":var x={success:function(){z.selLink=null;AD.drawLinks();},failure:function(){}};z.removeLink(AB[1],AB[0],x);break;case"0":case"1":case"2":case"3":z.editJoin({joinID:AB[0],linkID:AB[1],type:AA});break;case"More Options":R.call(r,w,AB,AD);break;default:break;}}});}else{p.set("pos",t);p.set("obj",l);p.set("linker",o);}p.showContextMenu();}var V={};function R(u,r,n,q){var x=this.joinMenuOption.joinItems,t=this.joinMenuOption.mappingKey,o=V[t],m=this.joinMenuOption.joinOperators;if(!o){o=V[t]=new mstrmojo.Editor({slink:r,linker:n,cssClass:"mstrmojo-Join-Options",title:mstrmojo.desc(9127,"Join Options"),help:(mstrApp.helpTopics&&mstrApp.helpTopics.tableJoin)||"join_options_dialog_box.htm",zIndex:100,cssText:"width:350px;",children:[{scriptClass:"mstrmojo.Label",cssText:"font-weight:bold; width:100%; padding: 5px;",text:mstrmojo.desc(9128,"Join")},{scriptClass:"mstrmojo.ui.CheckList",alias:"radiolist",multiSelect:false,itemCssClass:"mstrmojo-QB-radiolist-item",items:x},{scriptClass:"mstrmojo.Label",cssText:"font-weight:bold; width:100%; padding-left: 5px;",text:mstrmojo.desc(9129,"Join Operator")},{scriptClass:"mstrmojo.Label",cssText:"padding-left:5px;",bindings:{text:"this.parent.srcText"}},{scriptClass:"mstrmojo.HBox",alias:"jop",cssText:"position:relative;width:86px;",children:[{scriptClass:"mstrmojo.Pulldown",bindings:{cssClass:function(){return !!mstrApp.isWorkstation?"mstrmojo-QB-PullDown-item":"mstrmojo-Pulldown";}},items:m,popupToBody:true}]},{scriptClass:"mstrmojo.Label",cssText:"padding-left:5px;",bindings:{text:"this.parent.tgtText"}},{scriptClass:"mstrmojo.HBox",cssClass:"mstrmojo-Editor-buttonBox",slot:"buttonNode",children:[{scriptClass:"mstrmojo.Button",cssClass:"mstrmojo-Editor-button mstrmojo-WebButton hot",cssText:"float:right;",text:mstrmojo.desc(1442,"OK"),onclick:function(z){var AG=this.parent.parent;var AA=mstrmojo.all.QBuilderModel,AE=AG.radiolist.selectedItem.did,AD=AG.slink[1],AB=AG.slink[0],AC=AG.jop.children[0].selectedItem,AF=AA.brackets(AG.srcText)+AC.n+AA.brackets(AG.tgtText);AA.editJoin({joinID:AB,linkID:AD,type:AE,exp:AF,op:AC.dssid});if(AG.onOK){AG.onOK();}AG.close();}},{scriptClass:"mstrmojo.Button",cssClass:"mstrmojo-Editor-button mstrmojo-WebButton",text:mstrmojo.desc(221,"Cancel"),onclick:function(z){var AA=this.parent.parent;if(AA.onCancel){AA.onCancel();}AA.close();}}]}]});}else{o.set("slink",r);o.set("linker",n);}var k=mstrmojo.all.QBuilderModel,w=k.joinsInfo[r[0]].links[r[1]],l=w.srcw.oriexpr,p=w.tgtw.oriexpr;o.set("srcText",l);o.set("tgtText",p);o.radiolist.set("selectedIndex",parseInt(k.joinsInfo[r[0]].jt));o.jop.children[0].set("value",w.op||"0");o.open();}function C(n,o,r,q,m){var k=mstrmojo.all.QBuilderModel;var z=new mstrmojo.qb.DBTable({scriptClass:"mstrmojo.qb.DBTable",cssText:"opacity:0.3;filter:alpha(opacity=30);left:0px;top:0px;width:180px;height:"+o+"px;",title:m,visible:false,noCheckBox:true});z.container=n.parent;z.selectedIndex=new Array();var u=k.gettIndex(z.id);n.addChildren([z]);z.maxHeight=z.editorNode.clientHeight;z.maxWidth=Math.max(z.Rows.domNode.clientWidth,z.titlebarNode.clientWidth);if(z.maxHeight>parseInt(Y)){z.set("height",Y);}var l=r+"px",t=q+"px",AA=r+z.editorNode.clientWidth,p=q+z.editorNode.clientHeight,w=z.editorNode.style;w.left=l;w.top=t;w.width=z.titlebarNode.clientWidth+"px";z.left=l;z.top=t;return z;}function E(o){var n,m,l=0,q,p=10,k;L.forEach(o,function(r){k=mstrmojo.all[r];m=parseInt(k.left)+parseInt(k.editorNode.style.width);if(m>l){l=m;n=k;}});q=Math.ceil(l/200)*200+10;return{left:q,top:p};}function Q(z,AR){var AO=AR.h,u=AR.w,t=AR.x,r=AR.y,m=AR.tbn,AP=AR.did,AA=AR.dbtbn,AB=AR.ns,AL=AR.readOnly,o=mstrmojo.all.QBuilderModel,AT;var AC=U(z.length);AT=E(o.dbtables);t=AT.left;r=AT.top;var AF=new mstrmojo.qb.DBTable({scriptClass:"mstrmojo.qb.DBTable",cssText:"position:absolute;left:0px;top:0px;width:"+(u?u:180)+"px;height:"+AC+"px;",left:t+"px",top:r+"px",readOnly:AL,title:m,visible:true,readOnly:AL,noCheckBox:true,onClose:function(){var x=this;var w={success:function(){x.parent.parent.linker.drawLinks();},failure:function(){}};o.removeTable(this,w);},onRender:function(){if(AL&&this.closeNode){this.closeNode.title=mstrmojo.desc(15479,"Cannot delete this table since it is being used by the dossier");mstrmojo.css.addClass(this.closeNode,"readonly");}}});if(this.parent.parent.fromAggregation){AF.ondblclick=function(){};}o.upttIndex(m,AA,AF.id,true,AP,AB);o.raiseEvent({name:"refreshTables",items:o.dbtables.slice(0)});if(AP){o.uiids[AP]=AF.id;}AF.model=o;AF.container=this.parent;AF.selectedIndex=new Array();var AQ=o.gettIndex(AF.id);var p,q,AE,AK,AN=z.length,AJ;if(AN){AJ='* <span class = "all"> '+mstrmojo.desc(12736,"Add all columns")+"</span>";AF.addRow("* "+mstrmojo.desc(12736,"Add all columns"),0,["0","0"],"",AJ);p=AF.Rows.children[0];p.draggable=false;p.dropZone=false;p.allowDrop=false;p.rIndex=-1;p.table=AF;p.ondblclick=function(w){if(mstrmojo.dom.eventTarget(w.hWin,w.e).className.indexOf("add")<0){M(AF);}};p.oncontextmenu=function AM(w){Z.preventDefault(window,w.e);};}for(AK=0;AK<AN;AK++){q=z[AK].cln;AE=z[AK].state?["0",N[z[AK].state]]:["0","0"];AF.addRow(z[AK].cln,0,AE,"");AF.selectedIndex[AK]=false;p=AF.Rows.children[AK+1];p.cssClass=(AK%2)?"odd":"even";p.srcTable=m;p.srcID=AF.id;p.srcData=z[AK];p.oriexpr=z[AK].exp?z[AK].exp:(m+"."+z[AK].cln);p.expr=[{isNew:true,v:o.brackets(p.oriexpr),oi:{tIndex:AQ,rIndex:AK+1,t:"26",n:p.oriexpr}}];p.img=N;p.enableExpr=!z[AK].hideExpr;p.state=!z[AK].state?0:z[AK].state;o.tables[AF.id].rows[p.id]=p;p.rIndex=AK;p.count=!z[AK].count?0:z[AK].count;p.dt=z[AK].dt;p.updateState=function(x){if(this.count<=0){this.state=this.state&2;}this.state=this.state|x;var w=(this.state&1)+(this.state&2);this.images[1]=this.img[w];this.render();};p.ondblclick=function(w){if(mstrmojo.dom.eventTarget(w.hWin,w.e).className.indexOf("add")<0){M(this);}};p.oncontextmenu=function AM(w){Z.preventDefault(window,w.e);e(this,{position:Z.getMousePosition(w.e,window)});};if(AP){o.uiids[AP+z[AK].did]=p.id;}}this.addChildren([AF]);AF.maxHeight=AC;var AU=AF.Rows.domNode.clientWidth;mstrmojo.array.forEach(AF.Rows.domNode.children,function(w){AU=Math.max(AU,w.firstChild.children[1].clientWidth+30);});AF.maxWidth=Math.max(AU,AF.titlebarNode.clientWidth);if(AO<AC){AF.set("height",AO+"px");}var AS=t+"px",AH=r+"px",AI=t+AF.editorNode.clientWidth,l=r+AF.editorNode.clientHeight+10,AG=AF.editorNode.style,k=this.parent,n=this.domNode.style,AD=k.linker;AF.titlebarNode.style.width=parseInt(AG.width,10)-56+"px";AF.titleNode.style.width=AF.titlebarNode.style.width;AO=parseInt(k.domNode.clientHeight);u=parseInt(k.domNode.clientWidth);if(u<AI&&k.maxWidth<AI){k.maxWidth=AI;k.canvasbox.set("width",k.maxWidth+"px");k.linker.set("width",k.maxWidth+"px");o.linkerNeedRender=true;}if(AO<l&&k.maxHeight<l){k.maxHeight=l;k.canvasbox.set("height",k.maxHeight+"px");k.linker.set("height",k.maxHeight+"px");o.linkerNeedRender=true;}k.domNode.style["overflow-x"]=(k.maxWidth>u)?"auto":"hidden";k.domNode.style["overflow-y"]=(k.maxHeight>AO)?"auto":"hidden";return AF;}mstrmojo.qb.QBTableView=mstrmojo.declare(mstrmojo.Box,null,{scriptClass:"mstrmojo.qb.QBTableView",joinMenuOption:{menuItems:H,joinItems:F,mappingKey:"database",joinOperators:P},markupMethods:{onvisibleChange:function(){this.domNode.style.display=this.visible?"block":"none";}},init:function X(m){this._super(m);var p={},l=p[this.id]={},o=this;l.joinChanged=l.JoinsLoaded=l.JoinsAdded=function k(){o.scrollBox.linker.drawLinks();};l.BindingTableLoaded=function n(q){o.scrollBox.canvasbox.displayBindingTable(q);};l.refreshTables=o.onTableRefresh;mstrApp.getRootController().attachDataChangeListeners(p);},onTableRefresh:function W(k){var l=k.items.length>0;var m=this.scrollBox;mstrmojo.css.toggleClass(m.hintbox.domNode,["off"],l);mstrmojo.css.toggleClass(m.domNode,["active"],l);if(!l){mstrApp.getRootController().toggleDataPreview(false);}},children:[{scriptClass:"mstrmojo.Box",alias:"scrollBox",cssClass:"mstrmojo-qb-tableview-box",maxWidth:0,maxHeight:0,markupString:'<div id="{@id}" class="mstrmojo-Box {@cssClass}" style="{@cssText}" mstrAttach:mouseover,mouseout></div>',onmouseover:function(){var k=parseInt(this.domNode.clientHeight),m=parseInt(this.domNode.clientWidth),l=this.domNode.style;if(m<this.maxWidth){l.overflowX="auto";}else{l.overflowX="hidden";this.domNode.scrollLeft=0;}if(k<this.maxHeight){l.overflowY="auto";}else{l.overflowY="hidden";this.domNode.scrollTop=0;}},onmouseout:function(){this.domNode.style.overflow="hidden";},children:[{scriptClass:"mstrmojo.Box",alias:"hintbox",markupString:'<div class="mstrmojo-qb-EmptyHint">{@emptyHint}</div>',cssDisplay:"",emptyHint:mstrmojo.desc(14909,"Drag and Drop to Add Tables")},{scriptClass:"mstrmojo.qb.QBTableLinker",alias:"linker",cssClass:"mstrmojo-qb-tableview-linker",dropZone:true,allowDrop:function D(k){return(k.action===K);},ondrop:function c(k){this.parent.canvasbox.ondrop(k);mstrmojo.css.removeClass(this.domNode,"dragging");},ondragenter:function O(k){this.parent.canvasbox.ondragenter(k);mstrmojo.css.addClass(this.parent.domNode,"dragging");},ondragleave:function O(k){this.parent.canvasbox.ondragleave(k);mstrmojo.css.removeClass(this.domNode,"dragging");},onclick:function h(l){var k=this.parent.parent;G.call(k,l.e,this,this);}},{scriptClass:"mstrmojo.Box",markupString:'<div id="{@id}" class="mstrmojo-Box {@cssClass}" style="{@cssText}" mstrAttach:click,dblclick,mousemove> </div>',cssClass:"mstrmojo-qb-tableview-canvas",alias:"canvasbox",dropZone:true,allowDrop:function D(k){return(k.action===K);},onclick:function h(l){var k=this.parent.parent;G.call(k,l.e,this.parent.linker,this);},displayBindingTable:function(u){var w=u.value,l=0,p=20,r=20,x=0,k=0,q,AA,m=0;for(var n=0,o=w.length;n<o;n++){AA=w[n];q=AA.pos;if(q){r=q.t;l=q.l;x=q.h;k=q.w;}else{x=U(AA.cs.length);l+=m+p;}AA.h=x>parseInt(Y)?parseInt(Y):x;AA.w=k;AA.x=l;AA.y=r;var z=Q.call(this,AA.cs,AA);m=z.editorNode.clientWidth;}},updateTableName:function(p){var o=p.tid;if(o&&mstrmojo.all[o]){var m=mstrmojo.all.QBuilderModel,n=mstrmojo.all[o],l=n.Rows.children,q,k=p.value;mstrmojo.array.forEach(l,function(t,r){if(r>0){t.oriexpr=k+"."+t.srcData.cln;t.expr[0].v=m.brackets(t.oriexpr);t.expr[0].n=t.oriexpr;m.tables[o].rows[t.id]=t;}});}},postCreate:function(){var k=mstrmojo.all.QBuilderModel;if(!k){return ;}k.attachEventListener("TableAdded",this.id,"drawTable");k.attachEventListener("TableNameChanged",this.id,"updateTableName");},ondrop:function c(k){var r=k.action,n=k.src;if(n&&n.data){var o=n.data;if(r===K){var m=k.tgt.pos,p=mstrmojo.dom.position(k.tgt.node),t=m.x-p.x;y=m.y-p.y;var l=n.widget.dataHelper,q=0;mstrmojo.array.forEach(o,function(w){l.fetch(w,{success:function u(x){w.x=t+q*15;w.y=y+q*15;q++;mstrApp.getRootController().addTable(w,x.items);}});});}}mstrmojo.css.removeClass(this.parent.domNode,"dragging");},getAvatarIconClass:function I(k){return"enabled";},ondragenter:function O(k){var l=k.src.widget;if(l&&l.toggleAvatarClass&&this.allowDrop(k)){l.toggleAvatarClass(this.getAvatarIconClass(k),true);}mstrmojo.css.addClass(this.parent.domNode,"dragging");},ondragleave:function A(k){var l=k.src.widget;if(l&&l.toggleAvatarClass&&this.allowDrop(k)){l.toggleAvatarClass(this.getAvatarIconClass(k),false);}mstrmojo.css.removeClass(this.parent.domNode,"dragging");},drawTable:function(k){var n=k.data,m=k.table,l=U(n.length);l=(l>parseInt(Y,10))?parseInt(Y,10):l;m.h=l;m.w=null;Q.call(this,n,m);}}]}],onheightChange:function(m){var l=parseInt(m.value)-3;this.scrollBox.set("height",l+"px");var k=this.scrollBox.canvasbox;if((!k.height)||(k.domNode&&l>k.domNode.clientHeight)){k.set("height",l+"px");this.scrollBox.linker.set("height",l);}if(this.scrollBox.domNode){this.scrollBox.hintbox.domNode.style.lineHeight=l+100+"px";this.scrollBox.domNode.style.height=this.scrollBox.height;if(parseInt(this.scrollBox.height)<this.scrollBox.maxHeight){this.scrollBox.linker.set("height",parseInt(this.scrollBox.maxHeight));this.scrollBox.linker.render();this.scrollBox.linker.drawLinks();this.scrollBox.canvasbox.domNode.style.height=parseInt(this.scrollBox.maxHeight)+"px";}else{this.scrollBox.linker.set("height",l);this.scrollBox.linker.render();this.scrollBox.linker.drawLinks();k.domNode.style.height=l+"px";k.height=k.domNode.style.height;}}},onwidthChange:function(m){var k=parseInt(m.value)-2;this.scrollBox.set("width",k+"px");var l=this.scrollBox.canvasbox;if((!l.width)||(l.domNode&&k>l.domNode.clientWidth)){l.set("width",k+"px");this.scrollBox.linker.set("width",k);}if(this.scrollBox.domNode){this.scrollBox.domNode.style.width=this.scrollBox.width;if(parseInt(this.scrollBox.width)<this.scrollBox.maxWidth){this.scrollBox.linker.set("width",parseInt(this.scrollBox.maxWidth));this.scrollBox.linker.render();this.scrollBox.linker.drawLinks();this.scrollBox.canvasbox.domNode.style.width=parseInt(this.scrollBox.maxWidth)+"px";}else{this.scrollBox.linker.set("width",k);this.scrollBox.linker.render();this.scrollBox.linker.drawLinks();l.domNode.style.width=k+"px";l.width=l.domNode.style.width;}}}});})();(function(){mstrmojo.requiresCls("mstrmojo.array","mstrmojo.hash","mstrmojo.Editor","mstrmojo.Label","mstrmojo.Button","mstrmojo.mstr.EnumNodeDimty","mstrmojo.vi.ui.ConditionWalk","mstrmojo.fe.FilterUtils","mstrmojo.expr");mstrmojo.requiresDescs(15540);var I=mstrmojo.array,M=mstrmojo.hash,R=mstrmojo.Button.newWebButton,G=mstrmojo.mstr.EnumNodeDimty,P=I.hash([G.NodeDimtyUnspecified,G.NodeDimtyNone]),B=mstrmojo.fe.FilterUtils,J=mstrmojo.expr,Q=J.ET;mstrmojo.vi.ui.ConditionEditor=mstrmojo.declare(mstrmojo.Editor,null,{scriptClass:"mstrmojo.vi.ui.ConditionEditor",cssClass:"mstrmojo-vi-ui-ConditionEditor",help:"Creating_a_Metric_Qualification.htm",title:mstrmojo.desc(15540,"Edit Qualification"),objectBrowsingEnabled:false,targets:null,targetsLastMod:null,ets:null,condition:null,model:null,hasPrompt:false,disableElementsBrowsing:null,inRelation:null,editor:null,children:[{scriptClass:"mstrmojo.Box",markupString:'<div id="{@id}" class="mstrmojo-Box {@cssClass}" style="{@cssText}"></div>',cssDisplay:"inline-block",cssClass:"conditionBar",model:null,alias:"conditionBar",bindings:{model:"this.parent.model"},update:function(){var E=this.model,U=B.getExprNodeHtmlAndText(E.data?E.data:E,{emptyText:mstrmojo.desc(15413,"Qualification Details"),elemsEmpty:" "});if(this.containerNode){this.containerNode.innerHTML=U.html;this.containerNode.title=U.text;}}},{scriptClass:"mstrmojo.vi.ui.ConditionWalk",alias:"walk",dimtyTypes:P,delegateUpdateOkBtn:function D(V){var E=this.parent,W=E&&E.btnHbox,U=W&&W.okBtn;if(U){U.set("enabled",!!V);}},onOK:function O(){var U=this.condition,E=this.editor;E.onConditionEdit(U,this.model.get());},close:function L(){var E=this.condition;if(E&&E.isEmpty()){E.del();}},postmodeledit:function H(E){this.parent.updateConditionBar();},getIfDataSource:function S(){return this.parent.getIfDataSource();},onUpdateBrowseElementsParams:function N(E){this.parent.onUpdateBrowseElementsParams(E);},getDatasets:function F(){return this.parent.getDatasets();}}],buttons:[R(mstrmojo.desc(1442,"OK"),function(){var E=this.parent.parent;E.walk.onOK();E.close();},true,{enabled:true,alias:"okBtn"}),R(mstrmojo.desc(221,"Cancel"),function(){var E=this.parent.parent;E.close();})],updateConditionBar:function A(){this.conditionBar.update();},open:function K(V,E){this._super(V,E);var U={objectBrowsingEnabled:this.objectBrowsingEnabled,targets:this.targets,targetsLastMod:this.targetsLastMod,ets:this.ets,condition:this.condition,hasPrompt:this.hasPrompt,disableElementsBrowsing:this.disableElementsBrowsing,disableHierarchyLevel:this.disableHierarchyLevel,inRelation:this.inRelation,editor:this.editor};M.copy(U,this.walk);if(!(this.disableElementsBrowsing&&this.disableElementsBrowsing())){this.model.defaultETAttr=Q.AE;}this.walk.set("model",this.model);this.updateConditionBar();},onClose:function C(){this.walk.close();},getDatasets:mstrmojo.emptyFn,getIfDataSource:mstrmojo.emptyFn,onUpdateBrowseElementsParams:mstrmojo.emptyFn});}());(function(){mstrmojo.requiresCls("mstrmojo.array","mstrmojo.css","mstrmojo.dom","mstrmojo.hash","mstrmojo.expr","mstrmojo.Box","mstrmojo.Button","mstrmojo.Editor","mstrmojo.Dial","mstrmojo.Label","mstrmojo.fe.CreateSetEditor","mstrmojo.fe.FilterEditor","mstrmojo.vi.ui.editors.fe.RWViewLimitExprTree","mstrmojo.mstr.EnumDSSXMLObjectTypes","mstrmojo.vi.ui.ConditionWalk","mstrmojo.vi.ui.ConditionEditor","mstrmojo.vi.ui.editors.fe.ConditionWalk","mstrmojo.vi.ui.editors.fe.RWViewFilterExprTree","mstrmojo.warehouse.EnumObjectTypes");mstrmojo.requiresDescs(118,2397,5758,14915,15540,15005,15014,15091);var b=mstrmojo.hash,W=mstrmojo.array,f=mstrmojo.css,L=mstrmojo.dom,Z=mstrmojo.expr,h=mstrmojo.mstr.EnumDSSXMLObjectTypes,S={TEMPLATE:0,DATASET:1},O=Z.ET,Y=Z.BRANCH_FNS,B=mstrmojo.warehouse.EnumObjectTypes,K=mstrmojo.mstr.EnumNodeProperties,I="VFEmpty";var G=10,U=46,H=116,P=286,R=369,F=42;DL_LABEL_HEIGHT=26;function g(k){var j={et:k.defaultExpressionType};if(k.disableElementsBrowsing&&k.disableElementsBrowsing()){j={et:O.AQ};}k.mainExpr.newCondition(j,true);}function N(j){var k=G;if(j<G){k=G;}else{if(j<=U){k=U;}else{k=H;}}return k;}function A(o,AB){var w=o&&o.domNode,t=AB&&AB.domNode,k=w&&w.style,u=t&&t.style;var m=o.parent.domNode.offsetHeight;if(!AB){k.height=m+"px";if(o.updateScrollbars){o.updateScrollbars();}return ;}if(w&&t){var r=R-P;if(!o.editor.showLimits){r-=F+DL_LABEL_HEIGHT;}var j=m-r;var l=L.position(o.itemsContainerNode),p=L.position(AB.itemsContainerNode),z=l.h,AA=p.h;var n=N(AA),x=j-n;var q=Math.min(G+z,x);k.height=q+"px";u.height=j-q+"px";if(o.updateScrollbars){o.updateScrollbars();}if(AB.updateScrollbars){AB.updateScrollbars();}}}function D(k){var l=b.clone(k);if(k&&k.et===O.ANDOR&&(k.node&K.CONDITION)){var m=b.valarray(Z.findTargets(k,"did"))[0],j={et:O.ANDOR,data:l};switch(m&&m.t){case h.Attribute:j.a=m;break;case h.Metric:j.m=m;break;}return j;}return l;}mstrmojo.vi.ui.editors.FilterEditor=mstrmojo.declare(mstrmojo.fe.FilterEditor,null,{scriptClass:"mstrmojo.vi.ui.editors.FilterEditor",titleMarkupString:'<div class="mstrmojo-Editor-title-container"><div class="mstrmojo-Editor-title"></div><div class="edt-title-btn mstrmojo-Editor-help" tooltip="'+mstrmojo.desc(1143,"help")+'"></div><div class="edt-title-btn mstrmojo-Editor-close" tooltip="'+mstrmojo.desc(2102,"Close")+'"></div></div><div class="mstrmojo-Editor-subtitle-container"></div><div class="mstrmojo-Editor-titleSpacer"></div>',markupSlots:b.copy({subTitleNode:function X(){return this.showTitle?this.domNode.firstChild.children[1]:null;},containerNode:function d(){return this.domNode.firstChild.childNodes[3];},buttonNode:function J(){return this.domNode.firstChild.childNodes[4];},curtainNode:function E(){return this.domNode.lastChild;}},b.copy(mstrmojo.fe.FilterEditor.prototype.markupSlots)),help:"view_filter_editor_for_dossiers.htm",cssClass:"mstrmojo-charcoalboxe mstrmojo-FE mstrmojo-vi-ui-FE",postCreate:function C(){this.children=mstrmojo.hash.clone(this.children).concat([{scriptClass:"mstrmojo.Box",slot:"subTitleNode",children:[{scriptClass:"mstrmojo.Label",text:mstrmojo.desc(14915,"New Qualification"),cssDisplay:"inline-block",cssClass:"mstrmojo-relation-relateby-text",bindings:{text:function(){return this.editor.isNewCond?mstrmojo.desc(14915,"New Qualification"):mstrmojo.desc(15540,"Edit Qualification");},editor:"this.parent.parent",visible:function(){return !!this.editor.showCondWalk;}}},{scriptClass:"mstrmojo.Button",cssClass:"mstrmojo-WebButton",alias:"newQualificationBtn",cssText:"float: left",cssDisplay:"inline-block",text:mstrmojo.desc(15005,"Add New Qualification"),onclick:function(){g(this.editor);},bindings:{enabled:function(){return !this.editor.readOnly;},visible:function(){return !this.editor.showCondWalk;},editor:"this.parent.parent"}}]}]);if(this._super){this._super();}},editorTitle:mstrmojo.desc(5758,"Filter Editor"),defaultExpressionType:O.AE,onvizTitleChange:function(){this.set("title",this.editorTitle+" - "+this.vizTitle);},getExpressionContainerCfg:function(){var j=this._super();j.cssDisplay="flex";return j;},onOpen:function M(){var j=this.mainExpr,k=this.limitExpr;if(j){A(j,k);}if(!this.model.expr){g(this);}},getExpressionContentsConfig:function(){return[{scriptClass:"mstrmojo.Label",text:mstrmojo.desc(15091,"Metric values are not aggregated."),cssClass:"mstrmojo-FE-expr-header dl",bindings:{visible:"this.parent.parent.parent.showLimits"}},{alias:"ve",scriptClass:"mstrmojo.vi.ui.editors.fe.RWViewFilterExprTree",level:S.DATASET,bindings:{items:"this.editor.model.exprForest || []"},onBlankClick:function(o){this.parent.clearSelect(o);},supportRelation:true,postApplyProperties:function(){this.editor=this.parent.parent.parent;this.editor.set("mainExpr",this);},onNew:function(p){p.data.isNew=true;if(!p.data.ph){this.editor.openWalk(p.data,p.widget.ctxtBuilder.itemWidgets[p.index],"condition");}var o=this.parent.vle;A(this,o);},onadd:function j(){f.toggleClass(this.parent.domNode,I,this.items.length===0);var o=this.parent.vle;A(this,o);},onremove:function l(){f.toggleClass(this.parent.domNode,I,this.items.length===0);var o=this.parent.vle;A(this,o);},onnodeadd:function k(){var o=this.tree.parent.vle;A(this.tree,o);},onnoderemove:function n(){var o=this.tree.parent.vle;A(this.tree,o);},onitemsChange:function m(o){var q=this.items.length===0,p=this.parent;if(this.hasRendered){f.toggleClass(p.domNode,I,q);}else{if(q){f.addWidgetCssClass(p,I);}else{f.removeWidgetCssClass(p,I);}}}},{scriptClass:"mstrmojo.Label",text:mstrmojo.desc(15014,"Metric values are aggregated based on the attributes in the visualization."),cssClass:"mstrmojo-FE-expr-header tl",bindings:{visible:"this.parent.parent.parent.showLimits"}},{alias:"vle",scriptClass:"mstrmojo.vi.ui.editors.fe.RWViewLimitExprTree",level:S.TEMPLATE,validExprTypes:W.hash([O.MQ,O.MC]),bindings:{visible:"this.editor.showLimits",items:"this.editor.model.limitExprForest || []"},onBlankClick:function(o){this.parent.clearSelect(o);},postApplyProperties:function(){this.editor=this.parent.parent.parent;this.editor.set("limitExpr",this);},onnodeadd:function k(){var o=this.tree.parent.ve;A(o,this.tree);},onnoderemove:function n(){var o=this.tree.parent.ve;A(o,this.tree);},onadd:function j(){var o=this.parent.ve;A(o,this);},onremove:function l(){var o=this.parent.ve;A(o,this);}}];},getConditionWalkConfig:function c(){return undefined;},toggleOkButtonStatus:function V(j){var k=this.buttonBar.children[0].btnSave;k.set("enabled",!!j);},andOrPopupRef:{scriptClass:"mstrmojo.Editor",cssClass:"mstrmojo-FE-andOrPopup mstrmojo-ConditionWalk",contentNodeCssClass:"mstrmojo-balloon",slot:"containerNode",modal:false,autoClose:true,showTitle:false,draggable:false,openEffect:null,closeEffect:null,onOpen:function(){var j=this.condition,m=j&&j.data&&j.data.not,n=j&&j.parent,k=n&&n.data,l=(k&&k.fn)+(m?21:0);this.list.opening=true;this.list.set("selectedItem",isNaN(l)?null:{did:l});this.list.opening=false;},children:[{scriptClass:"mstrmojo.Dial",cssClass:"mstrmojo-CGE-andOrDial",alias:"list",animate:false,itemMarkup:'<div class="dial-item {@css}">{@n}</div>',itemIdField:"did",renderOnScroll:false,items:[{did:19,n:Y[19]},{did:20,n:Y[20]},{did:19+21,n:Y["19_21"]},{did:20+21,n:Y["20_21"]}],onchange:function(){if(this.opening){return ;}var k=this.parent,j=k.condition,p=this.selectedItem,o=p&&p.did,n=o>21?true:null,m=o-(n?21:0);k.close();var l=j&&j.parent;if(l&&l.data&&l.data.et===O.ANDOR){l.edit(j,m,n);}else{var q=j&&j.data;if(q&&(q.not!==n)){q.not=n;j.paint();}}}}]},createSetPopupRef:{scriptClass:"mstrmojo.fe.CreateSetEditor",contentNodeCssClass:"",cssClass:"VI-CreateSet-Editor",slot:"containerNode",autoClose:true,showTitle:false,isHostedWithin:false},conditionEditorPopupRef:{scriptClass:"mstrmojo.vi.ui.ConditionEditor",isHostedWithin:false,getIfDataSource:function e(){return this.editor.getIfDataSource();},getDatasets:function Q(){return this.editor.getDatasets();},onUpdateBrowseElementsParams:function a(j){this.editor.onUpdateBrowseElementsParams(j);}},docModel:null,targetMetrics:null,_set_model:function(m,k){var l=this._super(m,k);if(l){var j=this.model.targets;this.targetMetrics=W.filter(j,function(n){n.title=n.n||"";return n.t===h.Metric;});}return l;},openWalk:function(o,p,u,w){var r=this,k=L.delta(p.domNode,r.containerNode);k.y+=(u==="andor"?16:parseInt(p.domNode.offsetHeight,10));var t={condition:p,zIndex:r.zIndex+10,left:k.x+"px",top:k.y+"px"},j;switch(u){case"andor":if(r.skipAndOrPopup){return ;}j="andOrPopupRef";break;case"createSet":case"createSetOpt":if(mstrApp&&mstrApp.isWSStyling&&w&&w.e&&w.e.target){var l=w&&w.e&&w.e.target,m=L.delta(l,r.containerNode);t.left=m.x+"px";t.top=m.y+parseInt(l.offsetHeight,10)+"px";}var q=r.model.targets;j="createSetPopupRef";t.type=u;t.model={attrs:W.filter(q,function(n){return n.t===B.ATTRIBUTE;}),metrics:W.filter(q,function(n){return n.t===B.METRIC;})};if(u==="createSetOpt"){t.condition=p.parent;t.model.childIdx=p.childIndex();}break;case"condition":var x=L.position(this.titleNode);t=b.copy({editor:r,objectBrowsingEnabled:r.objectBrowsingEnabled,showLimits:r.showLimits,targets:r.model.targets,targetsLastMod:r.modelLastSet,ets:p.tree.validExprTypes||r.validExprTypes,condition:p,hasPrompt:r.model.hasPrompt,disableElementsBrowsing:r.disableElementsBrowsing,inRelation:p.inRelation,model:D(o),left:x.x+50+"px",top:x.y+20+"px",draggable:!r.conditionEditorNotDraggable},t);if(!!o.isNew){t.title=mstrmojo.desc(14915,"New Qualification");}else{t.title=mstrmojo.desc(15540,"Edit Qualification");}j="conditionEditorPopupRef";}r.openPopup(j,t);},getIfDataSource:function e(){if(this.docModel){return this.docModel.getDataService();}return null;},onUpdateBrowseElementsParams:mstrmojo.emptyFn,getDatasets:function Q(){if(this.docModel){return this.docModel.datasets;}return null;},conditionEditorNotDraggable:false});}());(function(){mstrmojo.requiresCls("mstrmojo.Box","mstrmojo.css","mstrmojo.string","mstrmojo.qb.QBTableView","mstrmojo.qb.FFsqlEditor","mstrmojo.Label","mstrmojo.Table","mstrmojo.Button");mstrmojo.requiresDescs(2827,9130,9137,9141,9215,9927,12378,12417,13403,1281,14911);var K=mstrmojo.string,E=mstrmojo.css,C=mstrmojo.desc,G="on",O=mstrmojo.warehouse.EnumDataChangeEvents,N=mstrmojo.DI.DIConstants;var F=1,H=2;var A=mstrmojo.desc(9215,"Type multi-pass SQL or double-click a table name");mstrmojo.qb.Button=mstrmojo.declare(mstrmojo.Button,null,{scriptClass:"mstrmojo.qb.Button",markupString:'<div id="{@id}" class="mstrmojo-Button mstrmojo-qb-Button {@cssClass} {@iconClass}" title="{@title}" style="{@cssText}" mstrAttach:touchstart,click,mousedown,mouseup><div class="mstrmojo-qb-Button-icon {@innerIconClass}"></div><div class="mstrmojo-Button-text mstrmojo-qb-Button-text {@innerIconClass}" style="{@innerBtxCss}"></div></div>',markupSlots:{iconNode:function(){return this.domNode.firstChild;},textNode:function(){return this.domNode.lastChild;}},postBuildRendering:function(){var Q;if(this._super){Q=this._super();}var P=this;this.set("richTooltip",{cssClass:"vi-regular vi-tooltip-A",refNode:this.domNode,posType:mstrmojo.tooltip.POS_TOPLEFT,top:32,content:this.text||""});if(!this._ontooltipover){this._ontooltipover=function(R){var S=P.textNode;if(S.offsetWidth<S.scrollWidth){P.showTooltip(R,self);}};this._ontooltipout=function(R){var S=P.textNode;if(S.offsetWidth<S.scrollWidth){P.hideTooltip(R,self);}};}mstrmojo.dom.attachEvent(this.domNode,"mouseover",this._ontooltipover);mstrmojo.dom.attachEvent(this.domNode,"mouseout",this._ontooltipout);return Q;}});mstrmojo.qb.QBPanel=mstrmojo.declare(mstrmojo.Box,null,{scriptClass:"mstrmojo.qb.QBPanel",markupMethods:{onvisibleChange:function(){this.domNode.style.display=this.visible?"block":"none";}},cssText:"position:relative;",mode:F,children:[{scriptClass:"mstrmojo.Box",alias:"header",cssClass:"mstrmojo-qb-tableview-toolbar",children:[{scriptClass:"mstrmojo.qb.Button",iconClass:"mstrmojo-qb-tableview-toolbarIcon play",text:C(9130,"Execute SQL"),postCreate:function L(){var Q={},P=Q[this.id]={};P[O.DBTABLES_ENABLED]=function(R){this.set("enabled",R.value);};mstrApp.getRootController().attachDataChangeListeners(Q);},onclick:function(){var Q=mstrApp.getRootController(),P=this.parent.parent;if(P.mode===F){Q.autoMap();}else{Q.autoMapFFSQL(P.SQL.ffsql.getSQLstmt());}}},{scriptClass:"mstrmojo.qb.Button",iconClass:"mstrmojo-qb-tableview-toolbarIcon erase",text:C(2827,"Clear"),bindings:{visible:function(){return this.parent.parent.mode===H;}},postCreate:function L(){var Q={},P=Q[this.id]={};P[O.DBTABLES_ENABLED]=function(R){this.set("enabled",R.value);};mstrApp.getRootController().attachDataChangeListeners(Q);},onclick:function M(){var Q=this.parent.parent.SQL,R=Q.ffsql,P=mstrApp.getRootController();R.clearTokens();Q.updatepasses();if(P.hasDBRoleSelected()){P.autoMapFFSQL("");}if(P.canAddTableSQL(true,"")){P.enableAvailableTables();}}},{scriptClass:"mstrmojo.qb.Button",iconClass:"mstrmojo-qb-tableview-toolbarIcon refresh",text:C(9927,"Update Tables"),bindings:{visible:function(){return(this.parent.parent.mode===F&&!mstrApp.isBigQuery);}},onclick:function(){mstrApp.getRootController().updateTableStructure();}}],preBuildRendering:function J(){if(this._super){this._super();}var Q=[];Q=[{scriptClass:"mstrmojo.qb.Button",cssClass:"mstrmojo-qb-tableview-toolbarIcon filter",text:C(1281,"Filter"),postBuildRendering:function P(){var S=this;mstrApp.getRootController().attachEventListener("reportModeChange",this.id,function(U){S.set("visible",U.mode!==2);});var R;if(this._super){R=this._super();}this.set("richTooltip",{cssClass:"vi-regular vi-tooltip-A",refNode:this.domNode,posType:mstrmojo.tooltip.POS_TOPLEFT,top:32,content:C(1281,"Filter")});if(!this._ontooltipover){this._ontooltipover=function(U){S.showTooltip(U,self);};this._ontooltipout=function(U){S.hideTooltip(U,self);};}mstrmojo.dom.attachEvent(this.domNode,"mouseover",this._ontooltipover);mstrmojo.dom.attachEvent(this.domNode,"mouseout",this._ontooltipout);return R;},onclick:function(){mstrApp.getRootController().openConditionDialog();}},{scriptClass:"mstrmojo.qb.Button",cssClass:"mstrmojo-qb-tableview-toolbarIcon sql",useRichTooltip:true,alias:"modeSwitcher",richTooltip:{cssClass:"vi-regular vi-tooltip-A",top:32,posType:mstrmojo.tooltip.POS_TOPLEFT},bindings:{text:function(){var R=this.parent.parent.mode===F;return R?C(9137,"Edit SQL"):C(14911,"Switch to Build Mode");},visible:function(){return !mstrApp.isFFSQL;}},onclick:function(){if(!mstrApp.isCloudPro||mstrApp.said){mstrApp.getRootController().convertMode(this.parent.parent.mode===F);}},postBuildRendering:function P(){var U=this;var S;if(this._super){S=this._super();}var R;if(!this._ontooltipover){this._ontooltipover=function(V){if(V.relatedTarget!==U.domNode&&V.relatedTarget!==U.domNode.childNodes[0]){R=mstrApp.isCloudPro?C(12417,"View SQL"):C(9137,"Edit SQL");U.richTooltip.refNode=U.domNode;if(U.parent.parent.mode===F){U.richTooltip.content=U.text;U.showTooltip(V,self);}else{U.richTooltip.content=U.text;U.showTooltip(V,self);}}};this._ontooltipout=function(V){U.hideTooltip(V,self);};}mstrmojo.dom.attachEvent(this.domNode,"mouseover",this._ontooltipover);mstrmojo.dom.attachEvent(this.domNode,"mouseout",this._ontooltipout);return S;}}];this.addChildren(Q);}},{scriptClass:"mstrmojo.qb.QBTableView",cssClass:"mstrmojo-qb-tableview on",alias:"tables",bindings:{visible:function(){return(this.parent.mode===F);}}},{scriptClass:"mstrmojo.qb.FFsqlEditor",cssClass:"mstrmojo-qb-ffsqlview",alias:"SQL",bindings:{visible:function(){return(this.parent.mode===H);}}}],enterMode:function I(P){var S=P.mode;this.set("mode",S);var Q=(S===H);this.tables.set("visible",!Q);E.toggleClass(this.tables.domNode,G,!Q);E.toggleClass(this.SQL.domNode,G,Q);E.toggleClass(this.header.modeSwitcher.domNode,"switch_to_build",Q);this.SQL.set("visible",Q);if(Q){var R=this.SQL.ffsql;R.updateSQL(P);}else{this.tables.scrollBox.linker.drawLinks();}},onheightChange:function(P){if(this.domNode&&this.header.domNode){this.tables.set("height",parseInt(P.value,10)-this.header.domNode.clientHeight-3-(N.workstation.utils.shouldShowTitleBar()?35:0)+"px");this.SQL.set("height",this.tables.height);}},onwidthChange:function B(P){if(this.width!=="NaNpx"){this.tables.set("width",this.width);this.SQL.set("width",this.width);}},postBuildRendering:function D(){if(this._super){this._super();}var P=mstrApp.getRootController();P.attachEventListener("reportModeChange",this.id,this.enterMode);P.attachEventListener("addCandidateTables",this.SQL.ffsql.id,"addCandidateTables");}});}());(function(){mstrmojo.requiresCls("mstrmojo.array","mstrmojo.hash","mstrmojo.mstr.EnumDSSXMLObjectTypes","mstrmojo.mstr.EnumDSSXMLObjectSubTypes","mstrmojo.vi.ui.editors.FilterEditor");mstrmojo.requiresDescs(5758,16037);var C=mstrmojo.array,A=mstrmojo.hash,B=mstrmojo.mstr.EnumDSSXMLObjectTypes,E=mstrmojo.mstr.EnumDSSXMLObjectSubTypes;mstrmojo.ME._HasConditionMetricFilterEditor=mstrmojo.provide("mstrmojo.ME._HasConditionMetricFilterEditor",{openConditionMetricFilterEditor:function D(G){var J="cmfe",K,H={},I=G.filter;function F(){C.forEach(G.att,function(N){if(N.t!==B.Attribute||N.da){return ;}var M=N.did,O=N.path;H[M]={did:M,n:N.n,t:N.t,st:N.st,fs:N.fs,da:N.da||false,datasetId:N.datasetId,ttp:N.n+(O?" - "+O:""),dsName:O};});C.forEach(G.mx,function(N){var M=N.did,O=N.path;H[M]={did:M,n:N.n,t:N.t,st:N.st||E.Metric,um:N.um,datasetId:N.datasetId,ttp:N.n+(O?" - "+O:""),dsName:O};});var L={expr:A.clone(I),targets:A.valarray(H)};K=J&&window.mstrmojo&&mstrmojo.all[J];if(!K){K=mstrmojo.insert({id:J,scriptClass:"mstrmojo.vi.ui.editors.FilterEditor",showLimits:false,docModel:G.docModel,title:mstrmojo.desc(11579,"Metric Editor")+" - "+mstrmojo.desc(16037,"Add Filter")});}if(G.zIndex){K.set("zIndex",G.zIndex);}K.set("model",L);K.targetMap=H;K.onSave=G.fnOk;K.onCancel=G.onCancel;K.onUpdateBrowseElementsParams=G.browseParam;K.open();}F();}});}());(function(){mstrmojo.requiresCls("mstrmojo.array","mstrmojo.css","mstrmojo.dom","mstrmojo.hash","mstrmojo.expr","mstrmojo.Table","mstrmojo.CheckBox","mstrmojo.UUID","mstrmojo.ME.LevelInputBox","mstrmojo.ME.ConditionInputBox","mstrmojo.ME.TransformInputBox","mstrmojo.ME.MetricDataService","mstrmojo.Button","mstrmojo.Box","mstrmojo.Editor","mstrmojo.ME._MetricEditorHelper","mstrmojo.mstr.EnumFunction","mstrmojo.mstr.EnumDSSXMLObjectTypes","mstrmojo.mstr.EnumDSSXMLObjectSubTypes","mstrmojo.vi.ui.editors.FilterEditor","mstrmojo.vi.enums.EnumFeatures","mstrmojo.fe.FilterUtils","mstrmojo.ME._HasConditionMetricFilterEditor","mstrmojo.ME.DerivedMetricOptions");mstrmojo.requiresDescs(1107,1281,2148,2397,2399,2827,3324,3377,4788,6223,9577,9579,9581,9582,9583,9584,11564,11565,12178,12179,12853,15004,15646);var U=mstrmojo.expr,I=mstrmojo.array,X=mstrmojo.css,e=mstrmojo.dom,R=mstrmojo.hash,G=mstrmojo.UUID,j=mstrmojo.mstr.EnumDSSXMLObjectTypes,a=mstrmojo.mstr.EnumDSSXMLObjectSubTypes,W=mstrmojo.ME._MetricEditorHelper,B=mstrmojo.ME.MetricToken.brackets,P=mstrmojo.vi.enums.EnumFeatures,f=mstrmojo.desc(15004,"Filter Applied"),A=mstrmojo.desc(15347,"Add Filter..."),g=mstrmojo.fe.FilterUtils.getExprXml,J=mstrmojo.ME.DerivedMetricOptions.isNonAFB;var Q,O;var F=function(){var E=this.isDME?mstrmojo.desc(12178,"Visualization level"):mstrmojo.desc(1107,"Report Level");return mstrmojo.hash.copy({n:E,did:-1,t:-1,state:0});};var k={level:-4,condition:-5,transformation:-6,simple:-7},b=function(E){return E===-4||E===-5||E===-6||E===-7;};var h={n:"",did:"-1",desc:""},D={1:"+",2:"*",3:"%",4:""},H={1:"",2:"!",3:"<",4:">",5:"<|",6:">|"};mstrmojo.ME._HasLevel=mstrmojo.provide("mstrmojo.ME._HasLevel",R.copy(mstrmojo.ME._HasConditionMetricFilterEditor,{_mixinName:"mstrmojo.ME._HasLevel",isAggFunction:false,init:function d(E){if(this._super){this._super(E);}Q=this.id;O=this;},onOpen:function N(){if(this._super){this._super();}if(!this.isAggFunction){return ;}O=this;var q=this.getLCTDefFromTokens();this.updateToggleBarStatus(q);var u=this.metricLCT.levelInput;u.set("candidates",this.getCandidates4LCT([U.TP.ATTR,U.STP.NDE]));u.set("items",q.level);var w=this.metricLCT.conditionInput;if(!this.isDME){if(!this.noCache&&!w.candidates){mstrmojo.ME.MetricDataService.getFilters({pattern:"*",blockBegin:1,blockCount:-1},{success:function(x){if(x){w.set("candidates",{items:x.items,isComplete:(x.bc===-1||(x.bb+x.bc>x.sz))});}},failure:function(x){mstrmojo.alert(x.getResponseHeader("X-MSTR-TaskFailureMsg"));}});}else{w.candidates=this.getCandidates4LCT([U.TP.FILTER,U.STP.PROMPT_OBJECTS]);this.metricLCT.lblCondition.set("visible",q.filter.length>0);}w.set("items",q.filter);}var E=this.metricLCT.transformInput;if(!this.noCache&&!E.candidates&&!this.isDME){mstrmojo.ME.MetricDataService.getTransformations({pattern:"*",blockBegin:1,blockCount:-1},{success:function(x){if(x){E.set("candidates",{items:x.items,isComplete:(x.bc===-1||(x.bb+x.bc>x.sz))});}},failure:function(x){mstrmojo.alert(x.getResponseHeader("X-MSTR-TaskFailureMsg"));}});}else{E.candidates=this.getCandidates4LCT(U.TP.ROLE);this.metricLCT.lblTransform.set("visible",q.tranformation.length>0);}E.set("items",q.tranformation);var p=this.metricLCT.addFilterBox,n=p.btnAddFilter,r=p.btnClearFilter,m=this.oi&&this.oi.conditions&&this.oi.conditions[0],o=m&&m.exp,t=q.filter&&q.filter[0],l={did:t&&t.did,n:t&&t.n,exp:o,isEmbedded:!!(o||(!t))};n.set("filter",l);r.set("filter",l);},hasConditionFilter:function V(){var l=this.metricLCT.addFilterBox,E=l.btnAddFilter;return !!(E.filter&&E.filter.did);},clearConditionFilter:function c(){var m=this,n=m.metricLCT.addFilterBox,l=n.btnAddFilter,E=n.btnClearFilter;l.set("filter",{isEmbedded:true});E.set("filter",{isEmbedded:true});m.onmetricModify();},onMpsChange:function M(){var m=this,n=m.metricLCT.addFilterBox,l=n.btnAddFilter,E=n.btnClearFilter;l.refresh();E.refresh();},useEmbeddedFilter:function C(){return this.isDME&&!this.ide.disableConditionMetric;},getLCTDefAsTokens:function S(){if(!this.isAggFunction){return[];}var w=this.metricLCT.levelInput.getSelectedObjects(),o=this.useEmbeddedFilter()?this.metricLCT.addFilterBox.btnAddFilter.getFilterObj():this.metricLCT.conditionInput.getSelectedObjects(),m=this.metricLCT.transformInput.getSelectedObjects(),r=[],l,n,p,E=function(z,x){return z.filtering===1?"("+x+")":x;};r.push({v:"{",isDelimiter:true});var t=null;for(n=0,p=w.length;n<p;n++){t=w[n];r.push({v:H[t.grouping],isDelimiter:true});if(W.isDimty(t.n)){r.push({v:E(t,t.n)});}else{if(/^@/.test(t.did)){r.push({v:E(t,t.did)});}else{if(t.did===-1){r.push({v:"~",isDelimiter:true});}else{r.push({v:B(t.n),oi:t});}}}r.push({v:D[t.filtering],isDelimiter:true});if(n<(p-1)){r.push({v:", ",isDelimiter:true});}}if(!this.levelFilterRest){r.push({v:";",isDelimiter:true});r.push({v:"-",isDelimiter:true});}if(!this.levelCanContinue){r.push({v:";",isDelimiter:true});r.push({v:"/",isDelimiter:true});}r.push({v:"}",isDelimiter:true});if(o.length>0){r.push({v:"<",isDelimiter:true});l={v:B(o[0].n)};if(o[0].did){l.oi=o[0];}r.push(l);r.push({v:";",isDelimiter:true});r.push({v:"@",isDelimiter:true});r.push({v:this.conditionEmbedMethod});r.push({v:";",isDelimiter:true});r.push({v:this.conditionIgnoreFilterElem?"-":"+",isDelimiter:true});r.push({v:">",isDelimiter:true});}var u=I.indexOf(m,h);p=u<0?m.length:u;if(p>0){r.push({v:"|",isDelimiter:true});var q=null;for(n=0;n<p;n++){q=m[n];l={v:B(q.n)};if(q.did){l.oi=q;}r.push(l);if(n<(p-1)){r.push({v:", ",isDelimiter:true});}}r.push({v:"|",isDelimiter:true});}for(n=0,p=r.length;n<p;n++){r[n].isNew=true;}return r;},getLCTDefFromTokens:function Y(){var l=[],n=false,t=[],q=[],w=this.oi.tks.items,u=w.length,r;if(this.insertMode||u===0){l.push(F.call(this));}else{for(r=0;r<u;r++){var o=w[r],x=o.tp,m=o.sctt;switch(m){case 262144:n=true;switch(x){case 64:case 126:case 264:case 265:case 310:var p=r,z;if(x===64){var E=o.v+w[++r].v;o=w[r+1];if(o.tp===43||o.tp===45){E+=w[++r].v;E+=w[++r].v;}else{if(o.tp===41){r++;}}z=mstrmojo.ME.Enum.DYNAMIC_DIMTY.getDimtyObject(E,this.isDME);}else{z=x===126?F.call(this):o.oi;}z.grouping=1;z.filtering=4;switch(w[p-1].tp){case 33:z.grouping=2;break;case 60:z.grouping=3;break;case 62:z.grouping=4;break;case 297:z.grouping=5;break;case 298:z.grouping=6;break;}switch(w[r+1].tp){case 37:z.filtering=3;break;case 42:z.filtering=2;break;case 43:z.filtering=1;break;}l.push(z);break;case 45:this.levelFilterRest=false;break;case 47:this.levelCanContinue=false;break;}break;case 327680:switch(x){case 270:case 273:t.push(o.oi);break;case 262:this.conditionEmbedMethod=o.v;break;case 43:this.conditionIgnoreFilterElem=false;break;case 45:this.conditionIgnoreFilterElem=true;break;}break;case 393216:switch(x){case 271:q.push(o.oi);break;}break;}}if(l.length===0&&!n){l.push(F.call(this));}}return{level:l,filter:t,tranformation:q};},levelCanContinue:true,levelFilterRest:true,conditionEmbedMethod:"2",conditionIgnoreFilterElem:true,_set_candidates:function(p,l){this.candidates=l;if(this.hasRendered){var E=this.metricLCT.levelInput,m=this.metricLCT.conditionInput,o=this.metricLCT.transformInput;E.candidates=this.getCandidates4LCT([U.TP.ATTR,U.STP.NDE]);m.candidates=this.getCandidates4LCT([U.TP.FILTER]);o.candidates=this.getCandidates4LCT([U.TP.ROLE]);}return true;},getCandidates4LCT:function L(n,E){var m=this.candidates,l;if(m){n=I.ensureArray(n);l=I.filter(m.items,function(o){return I.indexOf(n,o.t)>-1||I.indexOf(n,o.st)>-1;});if(I.indexOf(n,12)>-1&&E){if(this.replaceAttributeWithForms){l=this.replaceAttributeWithForms(l);}}return{items:l,isComplete:m.isComplete};}return null;},updateToggleBarStatus:function K(E){var l=false;if(E.level){l=E.level.length>1||E.level.length===1&&E.level[0].did!==-1;}if(E.filter){l=l||E.filter.length>0;}if(E.transformation){l=l||E.transformation.length>0;}if(b(this.did)){l=true;}this.metricLCT.toggle.set("selected",l);},levelAdvRef:{scriptClass:"mstrmojo.Editor",title:mstrmojo.desc(9577,"Level Advanced Options"),help:"Level_Advanced_Options_dialog_box.htm",cssClass:"mstrmojo-ME-level-options",onOpen:function(){var E=this.opener;this.contentTable.ccCheckBox.set("checked",E.levelCanContinue);this.contentTable.frCheckBox.set("checked",E.levelFilterRest);},children:[{scriptClass:"mstrmojo.Table",alias:"contentTable",rows:3,cols:1,children:[{scriptClass:"mstrmojo.CheckBox",alias:"ccCheckBox",slot:"0,0",label:mstrmojo.desc(9583,"Allow other users to add extra units to this definition")},{scriptClass:"mstrmojo.CheckBox",alias:"frCheckBox",slot:"1,0",label:mstrmojo.desc(9584,"Include filter attributes which are not in report or level in metric calculation")}]},{scriptClass:"mstrmojo.HBox",slot:"buttonNode",cssText:"float:right;margin: 5px 0px;",children:[{scriptClass:"mstrmojo.HTMLButton",cssClass:"mstrmojo-Editor-button",text:mstrmojo.desc(1442,"OK"),onclick:function(){var E=this.parent.parent;E.saveLevelOptions(E.contentTable.ccCheckBox.checked,E.contentTable.frCheckBox.checked);E.opener.onmetricModify();E.close();}},{scriptClass:"mstrmojo.HTMLButton",cssClass:"mstrmojo-Editor-button",text:mstrmojo.desc(221,"Cancel"),onclick:function(){var E=this.parent.parent;E.close();}}]}]},conditionAdvRef:{scriptClass:"mstrmojo.Editor",title:"Condition Advanced Options",help:"Condition_Advanced_Options_dialog_box.htm",cssText:"width: 286px;",onOpen:function(){var E=this.opener;this.contentTable.emPulldown.set("value",E.conditionEmbedMethod);this.contentTable.irfeCheckBox.set("checked",E.conditionIgnoreFilterElem);},children:[{scriptClass:"mstrmojo.Table",cssText:"margin-top:5px;",alias:"contentTable",rows:3,cols:1,children:[{scriptClass:"mstrmojo.Label",slot:"0,0",text:mstrmojo.desc(9585,"Interaction between metric filter and report filter: ")},{scriptClass:"mstrmojo.Pulldown",alias:"emPulldown",itemField:"n",itemIdField:"did",slot:"1,0",value:"2",items:[{n:mstrmojo.desc(9586,"Merge into new"),did:"1"},{n:mstrmojo.desc(9587,"Merge report filter into metric"),did:"2"},{n:mstrmojo.desc(9588,"Merge metric condition into report"),did:"3"}]},{scriptClass:"mstrmojo.CheckBox",alias:"irfeCheckBox",slot:"2,0",label:mstrmojo.desc(9589,"Ignore related report filter elements")}]},{scriptClass:"mstrmojo.HBox",slot:"buttonNode",cssText:"float:right;margin: 5px 0px;",children:[{scriptClass:"mstrmojo.HTMLButton",cssClass:"mstrmojo-Editor-button",text:mstrmojo.desc(1442,"OK"),onclick:function(){var E=this.parent.parent;E.saveConditionOptions(E.contentTable.emPulldown.value,E.contentTable.irfeCheckBox.checked);E.opener.onmetricModify();E.close();}},{scriptClass:"mstrmojo.HTMLButton",cssClass:"mstrmojo-Editor-button",text:mstrmojo.desc(221,"Cancel"),onclick:function(){var E=this.parent.parent;E.close();}}]}]},getLCTComponent:function Z(){return{scriptClass:"mstrmojo.Table",cssClass:"mstrmojo-ME-LCT",alias:"metricLCT",layout:[{cells:[{cssClass:"mstrmojo-SME-label mstrmojo-ME-LCT-label"},{}]},{cells:[{cssClass:"mstrmojo-SME-label mstrmojo-ME-LCT-label"},{}]},{cells:[{cssClass:"mstrmojo-SME-label mstrmojo-ME-LCT-label"},{}]},{cells:[{cssClass:"mstrmojo-SME-label mstrmojo-ME-LCT-label"},{cssText:"width:252px;padding-right:6px;"}]},{cells:[{cssClass:"mstrmojo-SME-label mstrmojo-ME-LCT-label"},{}]}],bindings:{visible:function(){return this.parent.isAggFunction;}},labelWidth:"auto",children:[{scriptClass:"mstrmojo.Button",cssClass:"toggle",alias:"toggle",text:mstrmojo.desc(6223,"Show All"),selected:false,bindings:{visible:function(){return !this.parent.parent.isDME;}},onclick:function(){var o=!this.selected;this.set("selected",o);},slot:"0,0"},{scriptClass:"mstrmojo.Label",alias:"lblLevel",text:mstrmojo.desc(4788,"Level"),bindings:{visible:function(){return this.parent.parent.isDME||!this.parent.parent.isDME&&this.parent.toggle.selected;},width:"this.parent.labelWidth"},onwidthChange:function(){if(this.hasRendered){this.domNode.style.width=this.width;}},slot:"1,0"},{scriptClass:"mstrmojo.ME.LevelInputBox",emptyText:mstrmojo.desc(12179,"Search for #").replace("#",mstrmojo.desc(2148,"Attribute").toLowerCase()),alias:"levelInput",dtp:-4,xacptSugItemOnly:true,bindings:{noCache:function(){return this.parent.parent.noCache;},isDME:function(){return this.parent.parent.isDME;},visible:function(){return this.parent.lblLevel.visible;}},reportLevelAdded:true,onadd:function(){var o=this.getSelectedObjects();this.set("reportLevelAdded",I.find(o,"did",-1)>-1);},onremove:function(){var o=this.getSelectedObjects();this.set("reportLevelAdded",I.find(o,"did",-1)>-1);},onitemchange:function(){this.parent.parent.onmetricModify();if(O.updateScrollbars){O.updateScrollbars();}},onSaveOnClose:function(){this.parent.parent.onmetricModify();},slot:"1,1"},{scriptClass:"mstrmojo.Button",cssClass:"mstrmojo-ME-link-text right bold",text:mstrmojo.desc(9577,"Level Advanced Options"),bindings:{visible:function(){return !this.parent.parent.isDME&&this.parent.toggle.selected;}},onclick:function(){var o=this.parent.parent;o.openPopup("levelAdvRef",{saveLevelOptions:function(q,p){o.levelCanContinue=q;o.levelFilterRest=p;},zIndex:o.zIndex+10});},slot:"1,1"},{scriptClass:"mstrmojo.Label",alias:"lblCondition",text:mstrmojo.desc(9579,"Condition"),bindings:{visible:function(){return !this.parent.parent.isDME&&this.parent.toggle.selected;}},slot:"2,0"},{scriptClass:"mstrmojo.ME.ConditionInputBox",cssClass:"mstrmojo-ME-ObjectInputBox-condition singleObject",emptyText:mstrmojo.desc(12179,"Search for #").replace("#",mstrmojo.desc(1281,"Filter").toLowerCase()),alias:"conditionInput",dtp:-4,xacptSugItemOnly:true,bindings:{visible:function(){return this.parent.lblCondition.visible;},isDME:function(){return this.parent.parent.isDME;},noCache:function(){return this.parent.parent.noCache;}},onitemchange:function(){this.parent.parent.onmetricModify();},slot:"2,1"},{scriptClass:"mstrmojo.Button",cssClass:"mstrmojo-ME-link-text right bold condition",text:mstrmojo.desc(9581,"Condition Advanced Options"),bindings:{visible:function(){return this.parent.lblCondition.visible&&!this.parent.parent.isDME;}},onclick:function(){var o=this.parent.parent;o.openPopup("conditionAdvRef",{saveConditionOptions:function(q,p){o.conditionEmbedMethod=q;o.conditionIgnoreFilterElem=p;},zIndex:o.zIndex+10});},slot:"2,1"},{scriptClass:"mstrmojo.Label",alias:"lblTransform",text:mstrmojo.desc(3324,"Transformation"),bindings:{visible:function(){return !this.parent.parent.isDME&&this.parent.toggle.selected;}},slot:"3,0"},{scriptClass:"mstrmojo.ME.TransformInputBox",cssClass:"mstrmojo-ME-ObjectInputBox-transform",emptyText:mstrmojo.desc(12179,"Search for #").replace("#",mstrmojo.desc(3377,"Object").toLowerCase()),alias:"transformInput",dtp:-4,xacptSugItemOnly:true,bindings:{visible:function(){return this.parent.lblTransform.visible;},isDME:function(){return this.parent.parent.isDME;},noCache:function(){return this.parent.parent.noCache;}},onitemchange:function(){this.parent.parent.onmetricModify();if(O.updateScrollbars){O.updateScrollbars();}},slot:"3,1"},{scriptClass:"mstrmojo.Label",alias:"lblFilter",text:mstrmojo.desc(1281,"Filter"),bindings:{visible:function(){return !!(this.parent.parent.isDME&&!this.parent.parent.ide.disableConditionMetric);}},slot:"4,0"},{scriptClass:"mstrmojo.Box",alias:"addFilterBox",slot:"4,1",cssClass:"addFilterBox",bindings:{visible:function(){return !!(this.parent.parent.isDME&&!this.parent.parent.ide.disableConditionMetric);}},children:[{scriptClass:"mstrmojo.Button",alias:"btnAddFilter",text:A,cssClass:"btnAddFilter",cssDisplay:"inline-block",getFilterObj:function m(){var p=this.filter,o=p&&p.isEmbedded;if(!p||!p.did){return[];}if(o){return[].concat(p.exp?{did:p.did,t:j.Filter,st:a.Filter,n:p.n,isEmbedded:true,condition:{did:p.did,exp:p.exp}}:[]);}return[{did:p.did,t:j.Filter,st:a.Filter,n:p.n}];},onfilterChange:function(){this.refresh();},buildRendering:function l(){if(!this.filter){this.filter={isEmbedded:true};}var t=this.filter,u=this.parent.parent,r=u.parent,w=r&&r.ide,p;r=w&&w.editor;p=r&&r.oi&&r.oi.mps;this.text=(t.did)?f:A;var q=this.constructor.prototype.buildRendering.call(this);X.toggleClass(this.domNode,"hasFilter",t.did);this.set("enabled",t.isEmbedded&&(!J(p)));var o=!!(t.did||(mstrApp.isVI&&u.parent.useEmbeddedFilter()));u.lblFilter.set("visible",o);u.addFilterBox.set("visible",o);return q;},useRichTooltip:true,updateTooltipConfig:function n(){var q=e.position(this.domNode),p=this.parent.parent.parent,r=p&&p.ide;p=r&&r.editor;var o=p&&p.oi&&p.oi.mps;this.richTooltip=!J(o)?null:{content:mstrmojo.desc(15646,"This metric is not configured to aggregate from the base dataset. Please go to the Metric Options to change this behavior."),cssClass:"vi-regular vi-tooltip-C A-center",left:q.x+q.w+10,top:q.y-4};},onclick:function E(){var r=this.parent.parent.parent,t=this.parent.btnClearFilter,z=r.dsUnits,w=[],AA=[],AB=mstrApp.getRootController().docCtrl.model,x=AB&&AB.getDataService(),o=this.filter,q=o&&o.exp,u=this;I.forEach(z&&z.items,function(AC){if(AC.t===j.Attribute){w.push(AC);}else{if(AC.t===j.Metric){AA.push(AC);}}});var p=function(AD){var AC=G.create();u.filter={did:AC,n:AC,exp:AD.expr,isEmbedded:true};var AF=AD.expr;var AE=function(){u.text=AF?f:A;X.toggleClass(u.domNode,"hasFilter",AF);r.onmetricModify();u.refresh();t.set("filter",u.filter);};if(AF){x.createEmbeddedFilter({expr:g(AF),expJson:AF,filterId:u.filter.did,filterName:u.filter.n},{success:function(){AE();}});}else{u.filter={isEmbedded:true};AE();}};r.openConditionMetricFilterEditor({filter:q,att:w,mx:AA,docModel:AB,invalidItems:[],fnOk:p,onCancel:mstrmojo.emptyFn,browseParam:function(AC){AC.messageID=AB.mid;AC.datasetID=AB.findDatasetIdFromUnit(AC.attributeID);},zIndex:r.zIndex+1});}},{scriptClass:"mstrmojo.Button",alias:"btnClearFilter",text:mstrmojo.desc(2827,"Clear"),cssClass:"btnClearFilter",cssDisplay:"inline-block",buildRendering:function l(){var p=this.filter;var o=this.constructor.prototype.buildRendering.call(this);this.set("visible",p&&p.did);return o;},onfilterChange:function(){this.refresh();},onclick:function(){var p=this.parent.btnAddFilter,o=this.parent.parent.parent;p.set("filter",{isEmbedded:true});this.set("filter",{isEmbedded:true});o.onmetricModify();}}]}]};}}));mstrmojo.ME._HasLevel.EnumEditorComponents=k;}());(function(){mstrmojo.requiresCls("mstrmojo.array","mstrmojo.hash","mstrmojo.expr","mstrmojo._HasPopup","mstrmojo.Label","mstrmojo.HTMLButton","mstrmojo.ObjectBrowser","mstrmojo.DataGrid","mstrmojo.Editor","mstrmojo.ME._MetricEditorHelper","mstrmojo.ME.ObjectInputBox","mstrmojo.mstr.EnumDSSXMLObjectTypes","mstrmojo.ME.MetricDataService","mstrmojo.ME._HasLevel","mstrmojo.ME._HasSortBy","mstrmojo.ME.FunctionInfo");mstrmojo.requiresDescs(629,2148,3377,9582,12173,12179,12852);var J=mstrmojo.hash,m=mstrmojo.array,M=mstrmojo.expr,j=mstrmojo.ME._MetricEditorHelper,A=mstrmojo.ME.MetricDataService,d=mstrmojo.mstr.EnumDSSXMLObjectTypes,p=mstrmojo.ME.Enum.DYNAMIC_DIMTY,O=mstrmojo.ME.Enum.UI_OBJECT_TYPE;var V,Y;var f=function(E){if(E.onmetricModify){E.onmetricModify();}},c=function(){if(Y.updateScrollbars){Y.updateScrollbars();}};var Z=mstrmojo.ME.MetricToken.brackets,L=mstrmojo.ME.MetricToken.quotes,a=mstrmojo.ME.MetricToken.unquotes;var e=function(){var E={"9C374236DD9F11D3B98100C04F2233EA":"Forecast","9C374233DD9F11D3B98100C04F2233EA":"Growth","9C374233DD9F11D3B98100C04F2233EA":"Trend","677E93B2786B11D4B82F00C04F356781":"Case",C41C34F0786B11D4B82F00C04F356781:"CaseV",B2C0FA4420C711D6AD1400C04F0423DE:"IF","8107C324DD9911D3B98100C04F2233EA":"Not"};return E.hasOwnProperty(this.fctOi.did);};var h=function(u){var t=u.split(",")[0],r=t.replace(/\d$/,""),E=t.replace(r,"");return{prefix:r,startAt:parseInt(E,10)};};var G=function(AB){var AA=function(){if(AB.isRepeated){var w=this.parent.dataGrid.ctxtBuilder.itemWidgets[this.parent.idx].labelWidget;if(w){w.set("count",this.getSelectedObjects().length);}}};var r=Y.getParamObjectTypes();var E={scriptClass:"mstrmojo.Table",cssClass:"funcParam",layout:[{cells:[{cssText:"width: 338px"},{}]}],children:[{scriptClass:"mstrmojo.ME.ObjectInputBox",alias:"paramInput",slot:"0,0",cssClass:"mstrmojo-ME-param",dtp:AB.dtp,isDME:Y.isDME,hideEditButton:function(w){return true;},hideDelButton:function(w){return this.isFull;},hidePulldownButton:function(){return this.parent.dataGrid.parent.tbBrowsable;},hideItemWidgetBrowseButton:function(){return !this.parent.dataGrid.parent.tbBrowsable;},browsableTypes:r.concat([M.TP.FOLDER]).join(","),folderLinksContextId:17,emptyText:mstrmojo.desc(12179,"Search for #").replace("#",mstrmojo.desc(3377,"Object").toLowerCase()),getCandidatesThroughTaskCall:function z(AC,w){AC.objectType=r.join(",");AC.rootFolderType=39;AC.blockCount=this.blockCount;mstrmojo.ME.MetricDataService.getMetricComponents(AC,w);},postCreate:function(AF){var AE=this.parent.dataGrid,AH=AE&&AE.parent;this.noCache=AH.noCache;if(!this.noCache){this.candidates=AH.getCandidates(function(AI){return mstrmojo.array.indexOf(r,AI.t)>-1;});var w=this.candidates.items||[];if(Y.isDME){w=Y.replaceAttributeWithForms(m.filter(w,function(AI){return m.indexOf(r,AI.t)>-1&&AI.st!==M.STP.NDE;}));}for(var AD=0,AC=(AB.items||[]).length;AD<AC;AD++){var AG=AB.items[AD];if(AG&&AG.t===mstrmojo.ME.Enum.UI_OBJECT_TYPE.Sub_Expression){w.push(AG);}}this.candidates.items=w;if(!AF){AE.candidatesListener.push(this.id);}}if(!AF){this.set("items",AB.items);}},onitemchange:function(){f(this.parent.dataGrid.parent);},onadd:function t(){AA.call(this);},onremove:function x(){AA.call(this);},obCfg:{folderLinksContextId:17,browsableTypes:r.concat([M.TP.FOLDER]).join(",")}}],getTokens:function(){var AE=this.paramInput.getSelectedObjects(),AF,w=AE.length,AD,AG=[],AC;if(w>0){for(AD=0;AD<w;AD++){AF=AE[AD];if(AF.state===mstrmojo.Enum_OIB_States.VALID&&AF.did){if(AF.t===O.Sub_Expression){AG=AG.concat(AF.tks);}else{AC={v:Z(AF.n)};if(AF.t===21){AC.oi=AF.oi;AC.exv=AF.fmdid||AF.exv;AC.extp=8;AC.v=AF.fnm?Z(AF.oi.n)+"@"+Z(AF.fnm):AC.v;}else{AC.oi=AF;}AG.push(AC);}}else{AC={v:L(AB.dtp,AF.n)};AG.push(AC);}AG.push({v:mstrmojo.ME.MetricToken.argDelimiter,isDelimiter:true});}AG.pop();}return AG;}};var u=E.children&&E.children[0];if(!AB.isRepeated){u.cssClass="mstrmojo-ME-ObjectInputBox-param singleObject noVerify";u.maxObjectCount=1;}else{u.cssClass="mstrmojo-ME-ObjectInputBox-param noVerify";}return E;};var C=function(t){var r=mstrmojo.all[V];var E=null;if(t.isParam){E=r.getParamWidget(t);}else{switch(t&&t.dtp){case 11:E={scriptClass:"mstrmojo.Pulldown",cssClass:"bool mstrmojo-ME-Pulldown",popupCssClass:"mstrmojo-ME-Pulldown-Popup",items:[{n:"False",did:"0"},{n:"True",did:"-1"}],popupToBody:true,itemIdField:"did",postCreate:function(u){var w=this.data;this.value=!!w.v?(w.v==="False"?0:-1):(w.dfv||0);},getTokens:function(){var u=this.data;if(!A.isValEqual(this.value,u.dfv)){return[{v:u.n},{v:"=",isDelimiter:true},{v:A.isValEqual(this.value,"-1")?"True":"False"}];}return[];},onvalueChange:function(){f(this.parent.dataGrid.parent);}};break;case -2:E=r.getBreakByWidget(t);break;case -1:E=r.getSortByWidget(t);break;default:E=r.getTextWidget(t);break;}}E.alias="inputWidget";return E;};var X=function(u,E,r){var t={scriptClass:"mstrmojo.ui.List",alias:"labelWidget",cssClass:"mstrmojo-FunctionWidzard-labels",count:u.items&&u.items.length||0,buildItems:function(){var w=[],z=this.count,AB=(u.isParam?"*":"")+":",AA=u.np;if(AA){for(var x=0;x<=z;x++){w.push({n:AA.n+(AA.startAt+x)+AB,title:u.desc||""});}}else{w.push({n:(u.dn||u.n)+AB,title:u.desc||""});}this.set("items",w);},postCreate:function(){this.buildItems();},oncountChange:function(){this.buildItems();}};return t;};var P=function(w){var r=mstrmojo.all[V];return{scriptClass:"mstrmojo.ME.ObjectInputBox",alias:"breakByInput",cssClass:"mstrmojo-ME-breakby",isDME:r.isDME,dtp:w.dtp,emptyText:mstrmojo.desc(12179,"Search for #").replace("#",mstrmojo.desc(2148,"Attribute").toLowerCase()),folderLinksContextId:16,browsableTypes:[M.TP.FOLDER,M.TP.ATTR].join(","),getCandidatesThroughTaskCall:function u(z,x){z.rootFolderType=39;z.blockCount=z.blockCount||this.blockCount;mstrmojo.ME.MetricDataService.getAttributes(z,x);},obCfg:{folderLinksContextId:16,browsableTypes:[M.TP.ATTR,M.TP.FOLDER].join(",")},postCreate:function(AA){var x=this.parent.dataGrid,AB=x&&x.parent;this.noCache=AB.noCache;if(!this.noCache){this.candidates=AB.getCandidates(function(AE){return AE.t===d.Attribute||AE.t===d.Consolidation;});if(this.isDME){this.candidates.items=p.getItems("breakby").concat(this.candidates.items);}if(!AA){x.candidatesListener.push(this.id);}}if(!AA){var z=w.items||[],AC=r.oi.tks,AD=!AC.met||AC.items&&(AC.items.length===0);if(AD&&this.isDME){z.push(p.getAutomaticDimtyObject());}this.set("items",z);}},onitemchange:function(){f(this.parent.dataGrid.parent);},onadd:function E(){c();},onremove:function t(){c();},hidePulldownButton:function(){return this.parent.dataGrid.parent.tbBrowsable;},hideItemWidgetBrowseButton:function(){return !this.parent.dataGrid.parent.tbBrowsable;},getTokens:function(){var AB=this.getSelectedObjects(),x=AB.length,AA,AD=[];if(x>0){AD.push({v:"BreakBy"});AD.push({v:"=",isDelimiter:true});AD.push({v:"{",isDelimiter:true});for(AA=0;AA<x;AA++){var AC=AB[AA],z;if(j.isDimty(AC.n)){z={v:AC.n};}else{if(/^@/.test(AC.did)){z={v:AC.did};}else{z={v:Z(AC.n),oi:AC};}}AD.push(z);if(AA!==(x-1)){AD.push({v:",",isDelimiter:true});}}AD.push({v:"}",isDelimiter:true});}return AD;}};};var F=function(u,w){var r=u.length,E;for(E=0;E<r;E++){var t=mstrmojo.array.find(u[E].fns,"n",w);if(t>-1){return J.clone(u[E].fns[t]);}}return null;};var S=function(t,u){var r,E=u.length,w=t&&t.length;if(w>0){for(r=0;r<w-1;r++){t[r].items=[u[r]];t[r].dynamicVerify=true;}t[w-1].items=[];for(r=w-1;r<E;r++){t[w-1].items.push(u[r]);t[w-1].dynamicVerify=true;}}return t;};var N=function(r,t,x){var w={items:[]},u={301:"}",302:")"}[x],E=t[++r];while(E){if(E.oi){if(x==302){E.oi.selFrm=E.exv;E.oi.asc=E.asc;}w.items.push(E.oi);}if((E=t[++r]).v===u){break;}}return w;};mstrmojo.ME.FunctionWizard=mstrmojo.declare(mstrmojo.Editor,[mstrmojo.ME._MetricEditorHelper,mstrmojo.ME._HasLevel,mstrmojo.ME._HasSortBy],{scriptClass:"mstrmojo.ME.FunctionWizard",cssClass:"mstrmojo-Editor-me mstrmojo-FunctionWidzard",title:mstrmojo.desc(9582,"Function Editor: "),help:"Function_Arguments_dialog_box.htm",fctOi:null,fctArgs:null,fctArgsDataGridCssClass:"functionArgs",fctSyntax:"",fctDesc:"",hiddenPs:[],bindings:{candidates:"this.opener.candidates"},getParamObjectTypes:function g(){var E=[M.TP.METRIC,M.TP.FACT];if(this.isAgg(this.fctOi)){E.push(M.TP.ATTR);}return E;},getCandidates:function R(t){var r=this.candidates,E;if(r){E=mstrmojo.array.filter(r.items,t);return{items:E,isComplete:r.isComplete};}return{};},_set_candidates:function(x,r){this.candidates=r;if(this.hasRendered&&this.visible){var u=this.argsGrid,w=u.candidatesListener,E=w.length,t;for(t=0;t<E;t++){if(mstrmojo.all[w[t]]){mstrmojo.all[w[t]].postCreate(true);}}}if(this._super){this._super(x,r);}return true;},postProcessParamsFromToken:function(u){if(this.refOi&&this.candidates){var w=this.refOi.did;this.refOi=mstrmojo.array.filterOne(this.candidates.items,function(AB){return AB.did===w;});}var AA=[],x,t,r=u.pars,E=(r&&r.length)||0;for(t=0;t<E;t++){x=J.copy(r[t]);x.isParam=true;if(t===0&&this.refOi){x.items=[this.refOi];this.refOi=null;}AA.push(x);}if(u.rpc>0&&!e.call(this)){x.isRepeated=true;var z=h(x.n);x.np={n:z.prefix,startAt:z.startAt||1};}return AA;},postProcessProsFromToken:function(u){var w=[],t,E=(u.pros&&u.pros.length)||0,r=function(x){if(m.indexOf(mstrmojo.ME.Enum.NonExposableParams,x.n)>-1){x.itemCss="hidden";}return x;};for(t=0;t<E;t++){w.push(r(J.copy(u.pros[t])));}return w;},buildSyntax:function(t){var r=[],u,E;r.push(t.n);r.push("(");E=(t.pars&&t.pars.length)||0;for(u=0;u<E;u++){r.push(t.pars[u].n);if(u!==(E-1)){r.push(", ");}}r.push(")");return r;},onOpen:function(){V=this.id;this._setupCandidatesCache();var t=this.getArgsFromTokens();var w=this,u=t||this.fctOi;var E=this.buildSyntax(u),x=this.postProcessParamsFromToken(u);x=x.concat(this.postProcessProsFromToken(u));if(u.sqt===5){x.push({n:"BreakBy",dn:mstrmojo.desc(12173,"Break By"),dtp:-2,desc:"Break By is a parameter representing the break by levels for this function.",items:u.bb&&u.bb.items});}if(u.ios){x.push({n:"SortBy",dn:mstrmojo.desc(12852,"Sort By"),dtp:-1,desc:"Sort By is a parameter representing the sort by levels for this function.",items:u.sb&&u.sb.items});}x=x.concat(this.hiddenPs||[]);w.set("fctArgs",x);w.set("fctSyntax",E.join(""));w.set("fctDesc",mstrmojo.ME.FunctionInfo.getDescAndExample(this.fctOi).desc+"  "+mstrmojo.ME.MetricDataService.getFunctionHelpTopic(u.h));w.set("title",this.insertMode?u.n:mstrmojo.desc(9582,"Function Editor: ")+" "+this.oi.n);w.set("fctName",u.n);this.raiseEvent({name:"fctDidChange",did:this.fctOi.did});this.set("isAggFunction",this.isAgg());this.set("ios",u.ios);if(this._super){this._super();}if(this.isAggFunction){var r=this.argsGrid.ctxtBuilder.itemWidgets;if(r&&r.length>0){this.metricLCT.set("labelWidth",r[0].labelWidget&&r[0].labelWidget.domNode.clientWidth+"px");}}},getArgsFromTokens:function Q(){if(!this.oi||this.oi.tks.items.length===0){return null;}var u={},x=this.oi.tks.items,AM=x.length,AH=[],r=[],AG=0,E=[],AL;for(AL=0;AL<AM;AL++){var AA=x[AL],t=AA.tp,AO=AA.sctt;if(mstrmojo.ME.MetricToken.isDelimiter(AA.v)&&(AA.v!=="("&&AA.v!==")")||AA.v==="&gt;"||AA.v==="&lt;"){continue;}switch(AO){case 65536:u.n=AA.oi?AA.oi.n:AA.v;var AB=this.fctOi=F(this.functions,u.n);AH=AB.pars||[];r=AB.pros||[];u.rpc=AB.rpc;u.sqt=AB.sqt;u.ios=AB.ios;break;case 196608:var AK=[],AF=[],AD,AJ,AI;AA=x[++AL];while(AA&&(AA.sctt===196608||AA.sctt===196609)){if(AA.sctt===196608){AF.push(AA);}else{AK.push(AF);AF=[];}AA=x[++AL];}AK.push(AF);AK[AK.length-1].pop();for(AI=0;AI<AK.length;AI++){AF=AK[AI];var w={n:""};AD=AF.length;if(AD===1){AA=AF[0];if(AA.extp){w={n:AA.v,did:AA.oi.did+"@"+AA.exv,exv:AA.exv,extp:AA.extp,oi:AA.oi,t:21,tk:AA};}else{var AE=Math.min(AH.length-1,E.length),AN=a(AA,AA.v,AH[AE].dtp);w=AA.oi||{n:AN,v:AN,t:O.Sub_Expression};}}else{for(AJ=0;AJ<AD;AJ++){w.n+=AF[AJ].v+" ";}w.v=w.n;w.did=w.n;w.t=O.Sub_Expression;w.tks=AF;}E.push(w);}break;case 131072:if(t==301){var AC={};AA=x[++AL];while(AA){if(AA.tp!=282){if(AA.oi){AC.items=AC.items||[];AC.items.push(AA.oi);}else{if(AA.tp===64){AC.items=AC.items||[];var z=AA.v+x[++AL].v;AA=x[AL+1];if(AA.tp===43||AA.tp===45){z+=x[++AL].v;z+=x[++AL].v;}AC.items.push(p.getDimtyObject(z,this.isDME));}}}if((AA=x[++AL])["v"]==="}"){break;}}u.bb=AC;}else{if(t==302){u.sb={};}else{if(t==259){mstrmojo.array.forEach(r,function(AR){if(AR.n===x[AL].v){AL=AL+2;var AQ=x[AL],AP=[];do{AP.push(x[AL++].v);if(x[AL].sctt===131072&&x[AL].tp===62||x[AL].sctt===131073){break;}}while(true);AP=AP.join("");AP=a(AQ,AP,AR.dtp);AR.v=AP;return false;}});}}}break;}}u.pars=S(AH,E);u.pros=r;return u;},getTokens:function H(){var u=this.argsGrid.ctxtBuilder.itemWidgets,AA=u.length,z,AE,AB=[],t=[],AF=[],AC,x,r,E,AD=this.fctOi;for(z=0;z<AA;z++){AE=u[z].inputWidget;if(AE.data.isParam){t.push(AE.getTokens());}else{AB.push(AE.getTokens());}}AF.push({v:AD.n,oi:AD});AA=AB.length;if(AA>0){E=false;AF.push({v:"<",isDelimiter:true});for(z=0;z<AA;z++){AC=AB[z];r=AC.length;if(r===0){continue;}E=true;for(x=0;x<r;x++){AF.push(AC[x]);}AF.push({v:",",isDelimiter:true});}AF.pop();if(E){AF.push({v:">",isDelimiter:true});}}AA=t.length;AF.push({v:"(",isDelimiter:true});E=false;for(z=0;z<AA;z++){AC=t[z];r=AC.length;if(r===0){continue;}E=true;for(x=0;x<r;x++){AF.push(AC[x]);}AF.push({v:mstrmojo.ME.MetricToken.argDelimiter,isDelimiter:true});}if(E){AF.pop();}AF.push({v:")",isDelimiter:true});for(z=0,AA=AF.length;z<AA;z++){AF[z].isNew=true;}return AF;},getMetricDefAsTokens:function q(){var E=this.getTokens();if(this.getLCTDefAsTokens){E=E.concat(this.getLCTDefAsTokens());}return E;},handleValidation:function o(w){if(w&&!w.rjec){return ;}var u=w&&w.rjec==="-2147214846";if(u){var t=w.items,x=mstrmojo.array.find(t,"sta",-1),E=t[x].v;mstrmojo.alert('More than one object with the name "#" found. Browse to select the object or retype to select it from the search autocomplete list.'.replace("#",E));}else{mstrmojo.alert(w&&w.rjed);}},getPROPBuilder:function b(){return X;},getDTPBuilder:function k(){return C;},getParamWidget:function B(E){return G(E);},getBreakByWidget:function U(E){return P(E);},getSortByWidget:function l(E){return this._super();},getTextWidget:function W(E){return{scriptClass:"mstrmojo.TextBox",cssClass:"mstrmojo-functionArgs-textInput",postCreate:function(r){var t=this.data;this.value=t.v||((t.dfv||t.dfv===0)?t.dfv:"");},getTokens:function(){var r=this.data;if(!mstrmojo.string.isEmpty(this.value)&&this.value!==r.dfv){return[{v:r.n},{v:"=",isDelimiter:true},{v:L(r.dtp,this.value)}];}return[];},onvalueChange:function(){f(this.parent.dataGrid.parent);}};},getDataGridRef:function D(){return{scriptClass:"mstrmojo.DataGrid",alias:"argsGrid",cssClass:this.fctArgsDataGridCssClass,makeObservable:true,banding:false,columns:[{headerText:"Property Name",dataWidgetBuilder:this.getPROPBuilder(),colCss:"name"},{headerText:"Property Type",dataWidgetBuilder:this.getDTPBuilder(),colCss:"dtp"}],postCreate:function(){this.candidatesListener=[];},bindings:{items:"this.parent.fctArgs"},onadd:function(){c();}};},init:function n(E){this.children=this.getChildren();this._super(E);V=this.id;Y=this;},isAgg:function K(E){return(E||this.fctOi||{}).sqt===1;},getChildren:function I(){return[mstrmojo.ME._MetricEditorHelper.formatAndOptionsBarRef,mstrmojo.ME._MetricEditorHelper.nameEditBoxRef,mstrmojo.ME._MetricEditorHelper.functionNameRef,this.getDataGridRef(),this.getLCTComponent(),{scriptClass:"mstrmojo.Label",slot:"buttonNode",cssClass:"mstrmojo-FE-functionSyntax",bindings:{visible:"this.parent.insertMode",text:function(){return this.parent.fctSyntax;}}},{scriptClass:"mstrmojo.Label",slot:"buttonNode",cssClass:"mstrmojo-FE-functionDesc",allowHTML:true,bindings:{visible:"this.parent.insertMode || this.parent.simplex",text:function(){return this.parent.fctDesc;}}},mstrmojo.ME._MetricEditorHelper.switchRef,mstrmojo.ME._MetricEditorHelper.buttonBarRef];}});}());(function(){mstrmojo.requiresCls("mstrmojo.array","mstrmojo.hash","mstrmojo.expr","mstrmojo.ui._HasScroller","mstrmojo.SearchableDropDownList","mstrmojo.ME.FunctionWizard","mstrmojo.ME._DerivedMetricEditorHelper");mstrmojo.requiresDescs(3377,11569,12179);var A,C;mstrmojo.ME.DerivedFunctionWizard=mstrmojo.declare(mstrmojo.ME.FunctionWizard,[mstrmojo.ME._DerivedMetricEditorHelper,mstrmojo.ui._HasScroller],{scriptClass:"mstrmojo.ME.DerivedFunctionWizard",init:function F(G){mstrmojo.css.addWidgetCssClass(this,"dme");this._super(G);A=this.id;C=this;},setupScrollNodes:function E(){this.scrollNode=this.containerNode;},onOpen:function B(){this._super();if(this.ide&&this.ide.action.cmd===mstrmojo.ME.ENUM.METRIC_ACTIONS.EDIT_NEW){this.dirty=true;}if(this.updateScrollbars){this.updateScrollbars();}},getParamObjectTypes:function D(){var G=this.opener||{};return G.getValidFuncParamTypes?G.getValidFuncParamTypes(this.fctOi):this._super();}});}());(function(){mstrmojo.requiresCls("mstrmojo.ME.DerivedFunctionWizard","mstrmojo.ME.MetricDataService","mstrmojo.ME.AttributeEditBox","mstrmojo.expr","mstrmojo.array","mstrmojo.hash");var G;var f=mstrmojo.ME.MetricDataService,V=mstrmojo.hash,N=mstrmojo.array,X=mstrmojo.ME.AttributeEditBox.getTokenStreamXML,b=mstrmojo.expr.DTP,Q={SHOW_BAND_NAMES:-4,BANDON_UNITS:-6},B={START_END:'BandNames<ResidueName="All Others">(this@ID, "#s - #e")',BAND_NUM:'BandNames<ResidueName="All Others">(this@ID, "Band #b")',BAND_NUM_START_END:'BandNames<ResidueName="All Others">(this@ID, "Band #b: #s - #e")',NO:"No"},R=[{n:mstrmojo.desc(14145,"Start - End"),v:B.START_END},{n:mstrmojo.desc(14146,"Band #"),v:B.BAND_NUM},{n:mstrmojo.desc(14147,"Band #: Start - End"),v:B.BAND_NUM_START_END},{n:mstrmojo.desc(218,"No"),v:B.NO}],K={"8107C337DD9911D3B98100C04F2233EA":"BAND_SIZE","8107C338DD9911D3B98100C04F2233EA":"BAND_COUNT","8107C339DD9911D3B98100C04F2233EA":"BAND_POINTS"},D=function(){return[];};function Z(g){return g.replace(/\s/g,"").toLowerCase();}function O(g){var h=[{v:"BandNames",tp:279,lv:1,oi:{did:"ACA96B1F9F99412B867045747DD88575",n:"BandNames",st:2816,t:11}},{v:"<",tp:60,lv:1},{v:"ResidueName",tp:259,lv:1},{v:"=",tp:282,lv:1},{v:'"All Others"',tp:261,lv:1},{v:">",tp:62,lv:1},{v:"(",tp:40,lv:1},{lv:1,tp:275,v:"this@ID"},{v:",",tp:44,lv:1}];switch(g){case B.BAND_NUM:h.push({v:'"Band #b"',tp:261,lv:1});break;case B.BAND_NUM_START_END:h.push({v:'"Band #b: #s - #e"',tp:261,lv:1});break;case B.START_END:h.push({v:'"#s - #e"',tp:261,lv:1});break;}h.push({v:")",tp:41,lv:1});return h;}function e(g){var h="";N.forEach(g.slice(1,-1),function(j){h+=j.v;});return h;}function J(g){if(g.t===4){return"BandOn";}return g.n;}function E(g){if(g.t===4){return Q.BANDON_UNITS;}return g.dtp;}var C=function(g,h){return{did:"",n:"New Attribute",forms:[{n:"ID",tks:{items:[]}}]};};function U(h,g){return h.dtp===8&&h.n==="Delimiter"?'"'+g+'"':g;}function P(k){var j=k.split(",")[0],h=j.replace(/\d$/,""),g=j.replace(h,"");return{prefix:h,startAt:parseInt(g,10)};}function L(g,h){return{scriptClass:"mstrmojo.Pulldown",cssClass:"mstrmojo-ME-Pulldown",popupCssClass:"mstrmojo-ME-Pulldown-Popup",items:g,popupToBody:true,itemIdField:"v",postCreate:function(){var j=this.data;this.value=j.v||j.dfv;},getTokens:h||D,onvalueChange:function(){G.set("dirty",true);}};}function I(h,k){var g=function(l){return l.inputWidget&&l.inputWidget.widgetName===k;},j=mstrmojo.array.filterOne(h.argsGrid.ctxtBuilder.itemWidgets,g);return j&&j.inputWidget;}var H=function(h){var g=null;switch(h&&h.dtp){case Q.SHOW_BAND_NAMES:g=L(R);g.widgetName="bandNames";g.getDescTokens=function(){var j=this.selectedItem&&this.selectedItem.v;return j===B.NO?null:O(j);};break;case Q.BANDON_UNITS:g=G.getParamWidget(h);g.widgetName="bandOn";break;case b.DOUBLE:case b.INTEGER:case b.VARCHAR:g=G.getTextWidget(h);break;default:g=G.getParamWidget(h);g.onitemsChange=mstrmojo.emptyFn;break;}if(g){g.alias="inputWidget";}return g;};var M=function(o,p,l,q){var m=o.did,j=o.n,g=o.dsid,h=o.forms,n={items:p},k=function(r){if(r.vs!==0){mstrmojo.alert(mstrmojo.desc(9826,"The metric definition has an error. Please correct before proceeding."),null,mstrmojo.desc(9571,"Syntax Error!"));return ;}var u,t={n:"ID",formula:r.tokenXML};if(m){t.did=h[0].did;u={act:"updateDA",name:j,dsid:g,attrId:m,isTokenStream:true,update:[t]};if(l){if(l.did&&!l.del){u.update.push(l);}else{if(l.did&&l.del){u.del=[{did:l.did}];}else{u.add=[l];}}}}else{u={act:"addDAToDataset",dsid:g,name:j,evFlags:1,isTokenStream:true,forms:[t].concat(l?[l]:[])};}q(u);};mstrmojo.ME.AttributeEditBox.validateSyntax(m,n,true,k);};var a=function(m){var l=m.forms,h=l&&l.length,k=h&&l[0],j=h&&l[1],o=N.some(k&&k.ftk,function(p){return p.oi&&K[p.oi.did];});if(!o){return false;}if(h===1){return true;}if(j&&j.ftk&&h===2){var g=false,n=Z(e(j.ftk));V.forEach(B,function(p){if(Z(p)===n){g=true;return false;}});return g;}return false;};mstrmojo.ME.BandingDAEditor=mstrmojo.declare(mstrmojo.ME.DerivedFunctionWizard,null,{scriptClass:"mstrmojo.ME.BandingDAEditor",ide:null,insertMode:false,init:function W(g){this._super(g);G=this;},getDTPBuilder:function Y(){return H;},getParamObjectTypes:function S(){return[mstrmojo.expr.TP.METRIC];},getTextWidget:function c(h){var j=P(h.n).prefix;return{scriptClass:"mstrmojo.ValidationTextBox",emptyText:(h.dtp===b.DOUBLE||h.dtp===b.INTEGER)?mstrmojo.desc(14143,"Type a number"):"",postCreate:function(){this.value=(h.items&&h.items[0].v)||h.dfv;},oninput:function k(l){G.set("dirty",true);this.createNextInputParamWidget();},constraints:{trigger:mstrmojo.validation.TRIGGER.ONKEYUP,min:1},dtp:h.dtp,getTokens:function(){var l=this.data;if(!mstrmojo.string.isEmpty(this.value)&&this.value!==l.dfv){return[{v:U(l,this.value)}];}return[];},createNextInputParamWidget:function g(){var p=this.data,o=this.dataGrid,q=G._lastRpIdx;if(!(p.isRepeated&&p.rpIdx===q)){return ;}var m=q+1,n=j+m,l=mstrmojo.hash.copy({desc:n,n:n,items:null,dn:n,rpIdx:m},mstrmojo.hash.copy(p));o.items.add([l],mstrmojo.array.indexOf(o.items,p)+1);G._lastRpIdx=l.rpIdx;if(G.updateScrollbars){G.updateScrollbars();}}};},onOpen:function F(){G=this;this.oi.tks=this.oi.forms[0].tks||{items:this.oi.forms[0].ftk};this._super();if(this.updateScrollbars){this.updateScrollbars();}},insertOnFinish:function(){var l=mstrmojo.all.mstrDAE.attrEditBox,g=l.inputBox,k=I(this,"bandNames"),h=this.getTokens(),j=k.getDescTokens();g.insertTokens(h);if(j){l.tabstrip.addTab();g.insertTokens(j);}},validateAndSave:function A(n,m){var l=this,k=l.ide.action,g=n.forms,h=I(this,"bandNames"),p=h.getDescTokens(),j=V.copy(p?{n:"DESC",formula:X({items:p})}:null,g[1]?{did:g[1].did}:null),o=function(r){m();l.ide.close();var q=n.did?k.onupdate:k.oncreate;if(q){q(r);}};if(p===null&&j){j.del=true;}M.call(l,l.oi,this.getTokens(),j,o);},postProcessParamsFromToken:function(k){var m=[],l,j,h=k.pars,g=(h&&h.length)||0;for(j=0;j<g;j++){l=V.copy(h[j]);l.dtp=E(l);l.n=J(l);l.isParam=true;m.push(l);}l=m[m.length-1];if(k.rpc>0){m=m.concat(this.postProcessRepeatParam(l));}return m;},postProcessRepeatParam:function d(o){var n=P(o.n),m=n.prefix,j=n.startAt||1,g=[],l,h;o.isRepeated=true;o.rpIdx=this._lastRpIdx=j;o.n=m+(j++);var k=o.items||[];if(k.length>0){o.items=[k[0]];for(h=1;h<=k.length;h++){l=V.copy(o);l.rpIdx=j;l.n=m+(j++);l.items=(h===k.length?null:[k[h]]);g.push(l);}this._lastRpIdx=l.rpIdx;}return g;},postProcessProsFromToken:function(g){var j=[],h={dfv:B.START_END,n:"ShowBandNames",desc:mstrmojo.desc(14144,"Show band names"),dtp:Q.SHOW_BAND_NAMES};if(this.oi.forms.length>1){var k=Z(e(this.oi.forms[1].ftk));V.forEach(B,function(l){if(Z(l)===k){h.v=l;return false;}});}else{if(this.oi.did!==""){h.v=B.NO;}}j.push(h);return j;}});mstrmojo.ME.BandingDAEditor.getNewDefinition=C;mstrmojo.ME.BandingDAEditor.showAsBandingEditor=a;}());(function(){mstrmojo.requiresCls("mstrmojo.array","mstrmojo.hash","mstrmojo.dom","mstrmojo.css","mstrmojo.Editor","mstrmojo.tooltip","mstrmojo.SearchWidget","mstrmojo.ME._MetricEditorHelper","mstrmojo.ME.BandingDAEditor","mstrmojo.ME.Enum","mstrmojo.ME.FunctionInfo");mstrmojo.requiresDescs(13141,9590,4561,9591,3273,9592,9579,9593,3324,9594,11656,11657,4565,9595,9925,1088,13141,9563,9597,221);var R=mstrmojo.hash,X=mstrmojo.dom,M=mstrmojo.css,Z=mstrmojo.ME.Enum.SHORTCUT_FUNCTIONS;var D={n:mstrmojo.desc(9590,"Search Result"),did:-1,fns:[]},E={n:mstrmojo.desc(4561,"All Functions"),did:-2,fns:[]},Q={n:mstrmojo.desc(9591,"Metric Templates"),did:-3,fns:[{n:mstrmojo.desc(3273,"Level"),did:Z.Level,desc:mstrmojo.desc(9592,"Create a level metric."),h:"standard_functions_Level"},{n:mstrmojo.desc(9579,"Condition"),did:Z.Condition,desc:mstrmojo.desc(9593,"Create a conditional metric."),h:"standard_functions_condition"},{n:mstrmojo.desc(3324,"Transformation"),did:Z.Transformation,desc:mstrmojo.desc(9594,"Create a transformation metric."),h:"standard_functions_transformation"},{n:mstrmojo.desc(11656,"Row Count"),desc:mstrmojo.desc(11657,"Row Count calculates the total number of rows in the dataset."),did:Z.Row_Count,tks:{items:[{v:"Count",tp:280,oi:{n:"Count",did:"8107C31CDD9911D3B98100C04F2233EA",t:11,st:2816}},{v:"<",tp:60},{v:"Null",tp:259},{v:"=",tp:282},{v:"True",tp:299},{v:",",tp:44},{v:"UseLookupForAttributes",tp:259},{v:"=",tp:282},{v:"False",tp:300},{v:">",tp:62},{v:"(",tp:40},{v:'"*"',tp:261},{v:")",tp:41},{v:"{",tp:123},{v:"~",tp:126},{v:"}",tp:125}]}}]},G={n:mstrmojo.desc(4565,"Select a category:"),did:-4,fns:[]},F=function(a,b){var c=a.functionList;a.openWizard(c.items[c.selectedIndex],b);},H=function(){return mstrmojo.hash.copy(mstrmojo.ME.ENUM.NEW_METRIC_DEFINITION);};var Y=function(b){var a="mstrmojo-ME-fct-tip",c=this.tooltip&&this.tooltip.domNode;if(c){M.toggleClass(c,a,b);}};mstrmojo.ME.FunctionSelector=mstrmojo.declare(mstrmojo.Editor,[],{scriptClass:"mstrmojo.ME.FunctionSelector",title:mstrmojo.desc(9595,"Select a function or template"),help:"Select_a_Function_dialog_box.htm",isDME:false,functions:null,includeFakeFuncs:true,functionItems:null,selectedCategory:1,selectedIndex:-1,init:function U(a){this._super(a);M.addWidgetCssClass(this,"mstrmojo-FunctionSelector");},getFunctionSyntax:function L(h,c){var e=this.functionItems;if(!e){return"";}var g=e[h].fns[c];if(g.did<0){return g.n;}var a=g.pars,k=g.pros,j=[],b,d;j.push(g.n);k=mstrmojo.hash.clone(k)||[];if(g.ios){k.push({n:"SortBy"});}if(g.sqt===5){k.push({n:"BreakBy"});}if(this.showFullSyntax){if(k.length>0){j.push("<");for(b=0,d=k.length;b<d;b++){j.push(k[b].n);j.push(", ");}j.pop();j.push(">");}}j.push("(");for(b=0,d=a.length;b<d;b++){j.push(a[b].n);if(b!==(d-1)){j.push(", ");}}j.push(")");return j.join("");},getFunctionDesc:function P(d,a){var c=this.functionItems;if(!c){return"";}var b=c[d].fns[a];return mstrmojo.ME.FunctionInfo.getDescAndExample(b).desc;},getFunctionHelpTopic:function O(d,a){var c=this.functionItems;if(!c){return"";}var b=c[d].fns[a];if(b.did===Z.Row_Count){return"";}return mstrmojo.ME.MetricDataService.getFunctionHelpTopic(b.h);},getMetricDefAsTokens:function S(){return this.getTokens();},getTokens:function K(){var b=this.functionList,a=b.items[b.selectedIndex],c=[];if(a){if(a.did<-1){switch(a.did){case -7:c=a.tks.items;break;case -4:case -5:case -6:break;}}else{c.push({v:a.n,oi:a,isNew:true});}}return c;},onfunctionsChange:function W(){if(!this.functions){return ;}this.selectedCategory=0;this.set("selectedCategory",1);this.set("selectedIndex",-1);var c=mstrmojo.hash.clone(this.functions),a=c.length;if(!c.add){c=R.make(c,mstrmojo.Arr);}if(a>=1&&this.includeFakeFuncs){var b=c[mstrmojo.ME.MetricDataService.getBasicCategoryIndex(c)];b.fns.push(Q.fns[0]);if(!this.isDME){b.fns.push(Q.fns[1]);b.fns.push(Q.fns[2]);}else{b.fns.push(Q.fns[3]);}}this.set("functionItems",c);},onPreClose:function N(){this.cleanup();return true;},cleanup:function I(){this.searchWidget.clearSearch();this.set("selectedIndex",-1);},handleCloseAction:function C(){this.close();},clearSearchResult:function V(b){var c=this.fcHBox.fcPulldown,d=this.functionItems,a=d.length-1;if(a>-1&&d[a]===D){if(this.selectedCategory===a){if(b!==false){this.set("selectedCategory",1);this.set("selectedIndex",-1);}}d.remove(a);c.refresh();}},clearSearchPattern:function A(){var a=this.searchWidget;if(a&&a.hasRendered){a.reset();this.clearSearchResult(false);}},openWizard:function J(d,c){var b=this,a;if(mstrmojo.ME.MetricDataService.isBasicAggMap(d.did)||d.did<-1){a={zIndex:b.zIndex+10,did:d.did,oi:H};a.insertMode=false;a.id="mstrSME";}else{a={functions:mstrmojo.ME.MetricDataService.getFunctionCatList(),fctOi:d,zIndex:b.zIndex+10,oi:H};a.id="mstrFE";}a.insertMode=this.insertMode;if(a.insertMode){a.insertOnFinish=this.insertOnFinish;}b.switch2Editor(a.id,a);},handleSelectedFunction:function(a){F(this);},onshowFullSyntaxChange:function B(){this.functionList.onchange();},children:[{scriptClass:"mstrmojo.Label",cssClass:"mstrmojo-FunctionSelector-label",text:mstrmojo.desc(9925,"Functions")},{scriptClass:"mstrmojo.SearchWidget",alias:"searchWidget",cssClass:"mstrmojo-FunctionSelector-search",width:"65px",quickSearch:true,placeholderText:"",onsearch:function(h){var a=this.parent,g=a.fcHBox.fcPulldown,e=a.functionItems,j=a.functionList.itemDisplayField,f=[],b=function(l){var k=mstrmojo.hash.copy(l),n=k.n,m;try{m=new RegExp(h,"ig");}catch(o){m=new RegExp(mstrmojo.string.regEscape(h),"ig");}if(m.test(n)){k[j]=n.replace(m,function(p){return"<em>"+mstrmojo.string.encodeHtmlString(p)+"</em>";});f.push(k);}},c,d;for(c=0,d=e.length;c<d;c++){if(e[c]===D||e[c].did===E.did){continue;}if(h){mstrmojo.array.forEach(e[c].fns,b);}}D.fns=f;if(e[e.length-1]!==D){e.add([D]);}g.refresh();a.selectedCategory=0;a.set("selectedCategory",e.length-1);a.set("selectedIndex",-1);},onclear:function(a){if(a){this.parent.clearSearchResult();}}},{scriptClass:"mstrmojo.HBox",alias:"fcHBox",cssClass:"mstrmojo-FunctionSelector-fctBox",children:[{scriptClass:"mstrmojo.Pulldown",cssClass:"mstrmojo-ME-Pulldown",popupCssClass:"mstrmojo-ME-Pulldown-Popup",alias:"fcPulldown",itemIdField:"did",itemField:"n",items:[],bindings:{items:function(){var b=this.parent.parent.functionItems,c=[];if(!b){return b;}c=mstrmojo.ME.MetricDataService.sortFunctions(b);if(b[0].did!==E.did){var a=E;a.fns=c;b.unshift(a);}return b;},selectedIndex:"this.parent.parent.selectedCategory",value:function(){var a=this.parent.parent.selectedCategory;return this.items[a][this.itemIdField];}},onvalueChange:function(a){var b=this.parent.parent;b.set("selectedCategory",this.selectedIndex);b.set("selectedIndex",-1);if(a.valueWas===D.did&&this.selectedItem.did!==D.did){this.parent.parent.clearSearchPattern();}}}]},{scriptClass:"mstrmojo.ME.FunctionList",alias:"functionList",itemIdField:"dssid",itemField:"n",itemDisplayField:"dn",items:[{n:"",cls:"wait"}],cssClass:"mstrmojo-FE-functionList mstrmojo-suggest-list",renderOnScroll:false,itemMarkupFunction:function(d,a,c){var b="mstrmojo-Button mstrmojo-Editor-button mstrmojo-WebButton tbFunction";if(!mstrApp.isWSStyling){b+=" hot";}return'<div class="mstrmojo-suggest-text '+(d.cls||"fn")+'" idx="'+a+'"'+(d.did<0?'did="'+d.did+'"':"")+" onmouseover=\"mstrmojo.all['"+c.id+"'].onmouseover(this, event)\" onmouseout=\"mstrmojo.all['"+c.id+"'].onmouseout(this, event)\">"+((c.itemDisplayField&&d[c.itemDisplayField])||d[c.itemField])+'<div class="'+b+'" t="edt"><div class="mstrmojo-Button-text" t="edt">'+mstrmojo.desc(1088,"Edit")+"</div></div></div>";},bindings:{items:function(){var a=this.parent.functionItems,b=this.parent.selectedCategory;return(a&&a[b].fns)||this.items;},selectedIndex:"this.parent.selectedIndex"},buffer:"",onkeypress:function(m){var l=this,h=m.e,d=h.keyCode||h.charCode,n=mstrmojo.Enum_Keys,a=function(p){var o=(X.isIE&&!X.isIE9)?p.keyCode:p.charCode;return(o>0)?String.fromCharCode(o):"";},j=this.items,g=j.length,b=this.selectedIndex,c=function(e){l.scrollTo(e);};switch(d){case n.UP_ARROW:this.set("selectedIndex",(b+g-1)%g);break;case n.DOWN_ARROW:this.set("selectedIndex",(b+1)%g);break;default:var f=(this.buffer+=a(h));if(g>0&&f.length>0){mstrmojo.array.forEach(j,function(p,k,e){var o=new RegExp("^"+f,"i");if(o.test(p[l.itemField])){if(k>-1){this.selectedIndex=-1;this.set("selectedIndex",k);}return false;}},this);}}if(this.selectedIndex>-1){c(this.selectedIndex);}window.clearTimeout(this.tmr);this.tmr=window.setTimeout(function(){l.buffer="";},300);mstrmojo.dom.stopPropogation(m.hWin,h);return false;},onkeyup:function(a){this.onkeypress(a);},onchange:function(a){var c=this.parent;if(this.selectedIndex!==c.selectedIndex){c.set("selectedIndex",this.selectedIndex);}var e=c.selectedCategory,b=c.selectedIndex,d=e>-1&&b>-1;c.set("funcSyntax",d?c.getFunctionSyntax(e,b):"");c.set("funcDesc",d?c.getFunctionDesc(e,b)+"  "+c.getFunctionHelpTopic(e,b):"");if(this.changeByMouse){if(c.selectedCategory>-1&&c.selectedIndex>-1){c.handleSelectedFunction(false);}this.changeByMouse=false;}},onmouseup:function(a){var c=a.getTarget(),b=c.getAttribute("t");if(b==="edt"){mstrmojo.dom.stopPropogation(a.hWin,a.e);mstrmojo.dom.preventDefault(a.hWin,a.e);this.openFunctionEditor();return false;}},openFunctionEditor:function(){var c=this.parent.parent.parent,d=c.getTokenInputBox(),a={zIndex:c.zIndex+1,insertMode:true,oi:mstrmojo.ME.ENUM.getNewDefinition(),insertOnFinish:function(e){d.insertTokens(e);}},b=this.parent.functionList.selectedItem;if(c.isBanding&&c.isBanding(b.did)){a={zIndex:c.zIndex+1,insertMode:true,fctOi:b,id:"mstrBDAE_1",oi:mstrmojo.ME.BandingDAEditor.getNewDefinition(),ide:c};}else{if(mstrmojo.ME.MetricDataService.isBasicAggMap(b.did)||b.did<-1){a.candidates=d.candidates;a.did=b.did;a.id="mstrSME_1";a.useGUIDefault=true;}else{a.fctOi=b;a.id="mstrFE_1";a.paramItemsPath=c.feParamItemsPath;}}a.modal=true;c.getModalEditor(a).open(c);},ondblclick:function(a){var c=this.getItemNodeFromTarget(a.getTarget());if(c){var b=this.parent;if(b.selectedCategory>-1&&b.selectedIndex>-1){b.handleSelectedFunction(true);}}},useRichTooltip:false,onmouseover:function(c,k){var m=this,b=this.parent,l=b.selectedCategory,f=c.getAttribute("idx"),d=X.eventTarget(window,k),a=d.getAttribute("t")==="edt";if((!isNaN(f)&&f>-1)||a){window.clearTimeout(m.hideTmr);var j='<dl class="fct-info"><dt class="fct-syntax">'+b.getFunctionSyntax(l,f)+'</dt><dd class="fct-desc">'+(b.getFunctionDesc(l,f)+"  "+b.getFunctionHelpTopic(l,f))+"</dd></dl>";var n=mstrmojo.dom.position(c,true),o=function(){var p=(m.tooltip&&m.tooltip.domNode.offsetWidth+15)||200,e=n.x,u=n.y-c.offsetHeight/2,t=e<p?"left":"right",r=e<p?mstrmojo.tooltip.POS_TOPLEFT:mstrmojo.tooltip.POS_TOPRIGHT;e=e<p?n.x+n.w+8:e-10;return{arrow_css:t,contentNodeCssClass:"me-tooltip-content "+t,posType:r,left:e,top:u};},h=o(),g="hidden";m.richTooltip=a?m.getEditBtnTooltip(d,f,h):{cssClass:g,contentNodeCssClass:"me-tooltip-content "+h.arrow_css,posType:h.posType,left:h.left,top:h.top,content:j,areaId:f};m.useRichTooltip=true;m.hasOpenTooltip=false;m.showTooltip();window.clearInterval(m.posTmr);var q=0;if(!m.posTmr){m.posTmr=window.setInterval(function(){if(m.tooltip){var r=m.tooltip.domNode,p=r.childNodes[1].firstChild,e=h.posType;h=o();if(h.posType!==e){r.style.left=h.left+"px";M.addClass(p,[h.arrow_css]);}window.setTimeout(function(){M.removeClass(r,g);},10);window.clearInterval(m.posTmr);delete m.posTmr;}else{if(q++>10){window.clearInterval(m.posTmr);}}},200);}Y.call(this,!a);}},getEditBtnTooltip:function(b,c,a){if(a){return{posType:mstrmojo.tooltip.POS_TOPLEFT,content:mstrmojo.desc(13141,"Edit function parameters"),top:a.top+50,left:a.left+200,cssClass:"vi-regular vi-tooltip-A"};}return{posType:mstrmojo.tooltip.POS_TOPRIGHT,contentNodeCssClass:"me-tooltip-content regular up tbFunction",top:28,left:67,refNode:b,content:mstrmojo.desc(13141,"Edit function parameters"),areaId:c};},onmouseout:function(){var a=this;this.hideTmr=window.setTimeout(function(){Y.call(a);a.hideTooltip();a.useRichTooltip=false;},500);}},R.copy({slot:"buttonNode",cssText:"text-align: center; float:left;",text:mstrmojo.desc(9563,"Switch to Formula Editor"),title:mstrmojo.desc(9597,"Build a metric formula using metrics, facts, attributes and functions."),closeAfterSwitch:false,getEditor:function(){return this.parent;},postclick:function(){this.getEditor().buttonNode.style.visibility="hidden";},bindings:{visible:function(){return !this.parent.insertMode;}}},R.copy(mstrmojo.ME._MetricEditorHelper.switchRef)),{scriptClass:"mstrmojo.HBox",alias:"buttonBar",slot:"buttonNode",cssClass:"mstrmojo-ME-buttonBox",cellCssClass:"subBox",children:[{scriptClass:"mstrmojo.Button",cssClass:"mstrmojo-Editor-button mstrmojo-WebButton",text:mstrmojo.desc(221,"Cancel"),onclick:function(){this.parent.parent.handleCloseAction();}}]}]});}());(function(){mstrmojo.requiresCls("mstrmojo.List","mstrmojo.ui._HasScroller");var E=mstrmojo.dom;mstrmojo.ME.FunctionList=mstrmojo.declare(mstrmojo.List,[mstrmojo.ui._HasScroller],{scriptClass:"mstrmojo.ME.FunctionList",setupScrollNodes:function D(){this.scrollNode=this.itemsContainerNode;this.scrollNode.style.height=this.scrollboxNode.offsetHeight+"px";this.scrollboxNode=this.itemsContainerNode;},getItemNodeFromTarget:function C(H){var G=mstrmojo.dom.findAncestorByAttr(H,"idx",true,this.domNode);return(G&&G.node)||null;},premousedown:function A(H){this.changeByMouse=false;if(E.isPrimaryMouseBtn(H.e)){var I=this.getItemNodeFromTarget(H.getTarget()),G=I&&parseInt(I.getAttribute("idx"),10);if(G!==null&&!isNaN(G)&&G!==this.selectedIndex){this.domNode.tabIndex=0;this.domNode.focus();this.changeByMouse=true;}this._super(H);}},getDragData:function B(G){return{item:this._super(G)};},premouseup:function F(G){if(E.getButton(G.hWin,G.e)===E.MOUSE_BUTTON.LEFT){this._super(G);return true;}mstrmojo.dom.stopPropogation(G.hWin,G.e);mstrmojo.dom.preventDefault(G.hWin,G.e);return false;}});}());(function(){mstrmojo.requiresCls("mstrmojo.func","mstrmojo.Editor","mstrmojo.List","mstrmojo.ME.MetricEditBox","mstrmojo.ME.FunctionSelector","mstrmojo.qb.FunctionWizard","mstrmojo.MenuButton","mstrmojo.qb.FFsqlToken","mstrmojo.array");mstrmojo.requiresDescs(221,2827,2919,4449,1442,9105,9106,9107,9108,9109,9110,9925);var Q=mstrmojo.string,S=mstrmojo.hash,O=mstrmojo.array,P={VALID:0,UNKNOWN:1,VALIDATING:2,ERROR:3},Y={0:"valid",1:"unknown",2:"validating",3:"error"},U={0:mstrmojo.desc(9105,"Valid Expression Formula."),1:mstrmojo.desc(9106,"Require Validation?"),2:mstrmojo.desc(9107,"Validation in Progress..."),3:mstrmojo.desc(9108,"Validation Failed with Syntax Error")},B=0,Z=3;function D(a){return(a?P.ERROR:P.VALID);}function M(a){var b=[];O.forEach(a,function(c){b.push(c.v);});return b.join("").replace(/<\s/g,"<").replace(/>\s/g,">");}function A(f){var e=f[f.length-1],c,d,b=[],a="";if(f[0]&&f[0].tp!==64){b.push({v:"",tp:64,lv:3,sta:1});}O.forEach(f,function(g){if(!g.oi){a+=g.v;}else{if(!Q.isEmpty(a)){b.push({v:a,tp:2,lv:1});a="";}b.push(S.copy(g,{lv:1,tp:2,sta:1}));}});if(!Q.isEmpty(a)){b.push({v:a,tp:2,lv:1});a="";}if(e&&e.tp!==-1){b.push({v:"",tp:-1,lv:2,sta:1});}return{omit:b,cn:b.length};}function N(d){var c=A(d),b={v:true,tp:true,lv:true,n:true,did:true,t:true,st:true,cn:true,mi:true,omit:true,extra:true,tknctx:true,sqlti:true,tindex:true,cli:true,sta:true,ix:true},a={getArrItemName:function(){return"tkn";},isSerializable:function(e){return(b[e])?true:false;}};return mstrApp.getRootController().exprjson2xml("mi",c,a);}function R(f){var b="",e=1,d="",a=this.exprEditBox.inputBox;if(a.doubleByte){d=a.editNode.innerText||a.editNode.textContent;a.ime=false;}else{if(this.oi.type!==0&&this.oi.type!==3){d=M(a.items);e=2;}else{b=N(a.items);}}var c=this;mstrApp.getRootController().parseExpression({expr:d,tKnStrm:b,isNew:true,qbrex:e,vo:1},{success:function(h){if(h&&h.mi&&h.mi.items){var g=h.mi.exp.sqltp;if(g!==null){c.sqltp=g;}c.exprEditBox.handleValidation(h.mi,false);if(!h.mi.reject_error_code&&f&&f.success){f.success(h);}else{if(f&&f.failure){f.failure(h);}}}}});}function X(b){var c=[],a=b.length;O.forEach(b,function(e,d){var f=e.v;if(typeof f!=="string"&&f.toString){f=e.v=f.toString();}if(e.orf){if(d>0&&f.slice(0,1)!==" "){c.push({v:" "});}c.push(e);if(d<a-1&&f.slice(-1)!==" "){c.push({v:" "});}}else{c.push(e);}});O.forEach(c,function(e,d){b[d]=e;});}function V(b){if(!b.length){return ;}var a=b[b.length-1];if(a&&a.tp===-1){b.pop();}if(b[0]&&(b[0].tp===64||(b[0].tp===36&&b[0].v==="$"))){b.splice(0,1);}X(b);}function K(a){return["[",a,"]"].join("");}mstrmojo.qb.ExpressionEditor=mstrmojo.declare(mstrmojo.Editor,null,{scriptClass:"mstrmojo.qb.ExpressionEditor",cssClass:"mstrmojo-MetricEditor mstrmojo-qb-ExpressionEditor",zIndex:70,title:mstrmojo.desc(4449,"Expression"),functionSelector:{scriptClass:"mstrmojo.ME.FunctionSelector"},wizard:{scriptClass:"mstrmojo.qb.FunctionWizard"},model:null,selFuncItem:null,onfunclistChange:function I(){this.toolBox.toolBar.func.set("cm",[{n:mstrmojo.desc(9925,"Functions"),did:-3,fns:this.funclist}]);},onOpen:function E(){var d=this,c=this.oi,g=this.exprEditBox,h=g.inputBox;h.customFunctionMode=false;h.doubleByte=false;c.isSave=false;this.set("funclist",mstrApp.getRootController().rootView.scriptClass==="mstrmojo.DI.ui.dialogs.DIAggregationDialog"?O.filter(this.funclist||mstrApp.getRootController().getFunctionList(),function(j){return j.n&&(j.n.indexOf("Financial")===-1&&j.n.indexOf("Statistical")===-1);}):(this.funclist||mstrApp.getRootController().getFunctionList()));var f={items:mstrApp.getRootController().getSuggestionItems(false),isComplete:true};h.set("candidates",f);d.set("candidates",f);g.set("iStatus","");g.set("vStatus",0);var b={0:mstrmojo.desc(4449,"Expression"),1:mstrmojo.desc(9109,"Filter Expression"),3:mstrmojo.desc(4449,"Expression")},e={0:(mstrApp.helpTopics&&mstrApp.helpTopics.expression)||"expression_dialog_box.htm",3:(mstrApp.helpTopics&&mstrApp.helpTopics.expression)||"expression_dialog_box.htm"};this.set("title",[b[c.type]||"",c.n].join(""));this.set("help",e[c.type]||((mstrApp.helpTopics&&mstrApp.helpTopics.condition)||"new_condition_dialog_box.htm"));var a;if(c&&c.tkn){a=S.clone(c.tkn);V(a);h.set("items",a);}if(c&&c.selFuncItem){d.openPopup("wizard",{fctOi:c.selFuncItem,zIndex:d.zIndex+10,insertOnFinish:function(j){h.insertTokens(j);}});}},onClose:function C(){var a=this.exprEditBox.inputBox;a.set("items",[]);a.itemcount=0;},children:[{scriptClass:"mstrmojo.HBox",cssClass:"mstrmojo-Editor-toolBox",alias:"toolBox",children:[{scriptClass:"mstrmojo.Label",cssText:"font-size: 10pt",text:mstrmojo.desc(15415,"Type Expression")+":"},{scriptClass:"mstrmojo.ToolBar",cssClass:"mstrmojo-oivmSprite grouped",alias:"toolBar",cssText:"float: right",children:[{scriptClass:"mstrmojo.MenuButton",alias:"func",iconClass:"tbInsert",title:mstrmojo.desc(2919,"Insert"),zIndex:80,itemIdField:"did",itemField:"n",itemChildrenField:"fns",isSeparatorItem:function L(a){return a[this.itemIdField]===-1;},executeCommand:function W(b){var a=this.parent.parent.parent,c=a.exprEditBox.inputBox;if(b.did===-999){a.openPopup("functionSelector",{functions:a.funclist,zIndex:a.zIndex+10,openWizard:function(d){a.openPopup("wizard",{fctOi:d,zIndex:a.zIndex+10,insertOnFinish:function(e){c.insertTokens(e);}});}});}else{a.openPopup("wizard",{fctOi:b,zIndex:a.zIndex+10,insertOnFinish:function(d){c.insertTokens(d);}});}}},{scriptClass:"mstrmojo.Button",title:mstrmojo.desc(9110,"Syntax Validation"),iconClass:"tbValidate",text:mstrmojo.desc(11897,"Validate"),onclick:function(){R.call(this.parent.parent.parent);}},{scriptClass:"mstrmojo.Button",title:mstrmojo.desc(2827,"Clear"),iconClass:"tbClear",text:mstrmojo.desc(2827,"Clear"),onclick:function(){var a=this.parent.parent.parent,b=[];a.oi.tkn=b;a.exprEditBox.inputBox.clearTokens(b);a.exprEditBox.resizeInputBox();}}]}]},{scriptClass:"mstrmojo.ME.MetricEditBox",alias:"exprEditBox",cssText:"height:132px;",children:[{scriptClass:"mstrmojo.ME.TokenInputBox",alias:"inputBox",slot:"editNode",browseItemVisible:false,renderBlockSize:1000,item2textCss:function J(a){return" mstrmojo-qb-SuggestIcon t"+a.t;},itemFunction:function G(d,a,b){return new mstrmojo.ME.MetricToken({data:d,brackets:K,isDelimiter:function c(){return this.data.isDelimiter||(this.length()===1&&mstrmojo.qb.FFsqlToken.isDelimiter(this.data.v));}});},isDelimiter:mstrmojo.qb.FFsqlToken.isDelimiter}],markupMethods:{onvStatusChange:function(){var b=this.vStatus,a=this.vStatusNode;a.className="mstrmojo-MEBox-vStatus "+Y[b];a.innerHTML=U[b];},oniStatusChange:function(){this.iStatusNode.innerHTML=this.iStatus;this.resizeInputBox();}},handleValidation:function F(d,f){if(!d){this.set("vStatus",P.ERROR);return ;}d.vs=D(d.reject_error_code);this.set("vStatus",d.vs);this.set("iStatus",d.reject_error_description||"");var e=d.items,h=[],g,a=".",c,b;O.forEach(e,function(k,j){h[j]={};if(k.tp===304&&!/^'.*'$/.test(k.v)){k.v=["'",k.v,"'"].join("");}if(k.tp===309){g=k.v;c=g.lastIndexOf(a);if(c>=1){k.v=g;h[j].oi={tn:g.slice(0,c),rn:g.slice(c+1),tp:26};}else{h[j].oi={tn:null,rn:g,tp:26};}}if(k.orf){h[j].oi=k.orf;k.v=[" ",k.v," "].join("");}h[j].v=!k.v||(typeof k.v)==="string"?k.v:k.v.toString();h[j].sta=k.sta;});this.inputBox.set("items",h);this.resizeInputBox();if(!f){this.inputBox.focus();}},resizeInputBox:function H(){var c=this.inputBox.domNode,b=this.iStatusNode.parentNode,d=parseInt(this.domNode.clientHeight,10)-7,a=b.offsetHeight;if(c){c.style.height=d-a+"px";}}},{scriptClass:"mstrmojo.HBox",cssText:"float: right; border-collapse: separate;margin:10px 0px;",children:[{scriptClass:"mstrmojo.Button",cssClass:"mstrmojo-Editor-button mstrmojo-WebButton hot",text:mstrmojo.desc(1442,"OK"),onclick:function(){var f=this.parent.parent,e=f.oi,b=e.type,d=e.w,a=f.exprEditBox.inputBox,c=M(a.items),h={success:function g(){f.close();}};e.isSave=true;switch(b){case B:R.call(f,{success:function g(){mstrApp.getRootController().addColumnWithExpression(d,c,a.items,h);}});break;case Z:R.call(f,{success:function g(){mstrApp.getRootController().editColumnExpression(e.cIndex,c,a.items,h);}});break;default:R.call(f,mstrmojo.func.wrapMethods(e.callbacks,h));}}},{scriptClass:"mstrmojo.Button",cssClass:"mstrmojo-Editor-button mstrmojo-WebButton",text:mstrmojo.desc(221,"Cancel"),onclick:function(){this.parent.parent.close();}}]}]});}());(function(){mstrmojo.requiresCls("mstrmojo.func","mstrmojo.string","mstrmojo.form","mstrmojo.qb.ExpressionEditor","mstrmojo.qb.MissingColumnWarning","mstrmojo.qb.DataService","mstrmojo.warehouse.EnumDataChangeEvents","mstrmojo.mstr.EnumDSSXMLObjectTypes");mstrmojo.requiresDescs(218,219,1442,9220,9221,9222,9223,9224,9225,9226,9227,9228,9229,9230,9945,9946,11164,16115);var P=mstrmojo.string,V=mstrmojo.hash,Z=mstrmojo.array,Y=mstrmojo.css,BU=mstrmojo.DI.DIHelpers,AN=mstrmojo.DI.DIConstants,Ad=mstrmojo.mstr.EnumDSSXMLObjectTypes,BQ=P.decodeHtmlString,A6=mstrmojo.warehouse.EnumDataChangeEvents,BS="    ",A7="A61B85F4485D3B953003B195E58B5138",BT=15,L=200,A4=200,m=0,R=0,b=["0DFE6FB4356F4FA2A0C1C10D0B415355","375104850C3E45EA889D9F5FEB37D317","B2C0FA4020C711D6AD1400C04F0423DE","B2C0FA4120C711D6AD1400C04F0423DE","9AD889E56E4D4E56A127207B4AF77166","8107C31BDD9911D3B98100C04F2233EA","8107C31DDD9911D3B98100C04F2233EA","8107C31EDD9911D3B98100C04F2233EA","8107C31FDD9911D3B98100C04F2233EA","8107C31CDD9911D3B98100C04F2233EA","AB08D4FC700B4EE58C021BFA2ABD77D0","993F6897863E43CFBEA4969F68BBDED7","C50F2A4F75AE49D6B20E00224967B500","0150F348CB0B4D9AB8CCA458C1ACC4B0","6F7DF5F2449111D5BEA300B0D01A55EF","6F7DF5F3449111D5BEA300B0D01A55EF","6F7DF5F4449111D5BEA300B0D01A55EF","6F7DF5FB449111D5BEA300B0D01A55EF","6F7DF5FE449111D5BEA300B0D01A55EF","6F7DF5FC449111D5BEA300B0D01A55EF","6F7DF5F6449111D5BEA300B0D01A55EF","A9A5B40DF7204F27A04AB3C74225477E","B651EC29A3074BA68F31DE99FC300AF7","7C63D4E70B2741C3A5B54A2EFD40961B","6F7DF5F7449111D5BEA300B0D01A55EF","6F7DF5FD449111D5BEA300B0D01A55EF","6F7DF5F5449111D5BEA300B0D01A55EF","6F7DF5F8449111D5BEA300B0D01A55EF","2146A148C528458181CD816CD96E71D3","8F090B600594488A8FF89A5867C78973","8107C33EDD9911D3B98100C04F2233EA","8107C33FDD9911D3B98100C04F2233EA","6F7DF5FF449111D5BEA300B0D01A55EF","8107C357DD9911D3B98100C04F2233EA","6F7DF606449111D5BEA300B0D01A55EF","6F7DF609449111D5BEA300B0D01A55EF","6F7DF600449111D5BEA300B0D01A55EF","6F7DF601449111D5BEA300B0D01A55EF","6F7DF602449111D5BEA300B0D01A55EF","6F7DF603449111D5BEA300B0D01A55EF","6F7DF608449111D5BEA300B0D01A55EF","6F7DF604449111D5BEA300B0D01A55EF","6F7DF605449111D5BEA300B0D01A55EF","6F7DF607449111D5BEA300B0D01A55EF","8107C347DD9911D3B98100C04F2233EA","8107C327DD9911D3B98100C04F2233EA","F262C811DDA611D3B98100C04F2233EA","F262C812DDA611D3B98100C04F2233EA","F262C813DDA611D3B98100C04F2233EA","F262C830DDA611D3B98100C04F2233EA","F262C814DDA611D3B98100C04F2233EA","F262C815DDA611D3B98100C04F2233EA","F262C816DDA611D3B98100C04F2233EA","F262C817DDA611D3B98100C04F2233EA","F262C818DDA611D3B98100C04F2233EA","F262C819DDA611D3B98100C04F2233EA","F262C81ADDA611D3B98100C04F2233EA","F262C81BDDA611D3B98100C04F2233EA","F262C81CDDA611D3B98100C04F2233EA","F262C81DDDA611D3B98100C04F2233EA","F262C81EDDA611D3B98100C04F2233EA","F262C81FDDA611D3B98100C04F2233EA","F262C820DDA611D3B98100C04F2233EA","F262C821DDA611D3B98100C04F2233EA","F262C822DDA611D3B98100C04F2233EA","F262C831DDA611D3B98100C04F2233EA","F262C824DDA611D3B98100C04F2233EA","F262C825DDA611D3B98100C04F2233EA","F262C826DDA611D3B98100C04F2233EA","F262C828DDA611D3B98100C04F2233EA","F262C829DDA611D3B98100C04F2233EA","5CCBF590DAB311D5AD0E00C04F0423DE","F262C82ADDA611D3B98100C04F2233EA","F262C82BDDA611D3B98100C04F2233EA","F262C82CDDA611D3B98100C04F2233EA","F262C82DDDA611D3B98100C04F2233EA","F262C82EDDA611D3B98100C04F2233EA","F262C82FDDA611D3B98100C04F2233EA","A202C222DD9D11D3B98100C04F2233EA","A202C223DD9D11D3B98100C04F2233EA","A202C224DD9D11D3B98100C04F2233EA","A202C225DD9D11D3B98100C04F2233EA","A202C226DD9D11D3B98100C04F2233EA","A202C228DD9D11D3B98100C04F2233EA","A202C227DD9D11D3B98100C04F2233EA","A202C229DD9D11D3B98100C04F2233EA","A202C210DD9D11D3B98100C04F2233EA","A202C211DD9D11D3B98100C04F2233EA","A202C212DD9D11D3B98100C04F2233EA","A202C213DD9D11D3B98100C04F2233EA","A202C22ADD9D11D3B98100C04F2233EA","A202C22BDD9D11D3B98100C04F2233EA","A202C214DD9D11D3B98100C04F2233EA","A202C215DD9D11D3B98100C04F2233EA","A202C216DD9D11D3B98100C04F2233EA","A202C217DD9D11D3B98100C04F2233EA","A202C22DDD9D11D3B98100C04F2233EA","A202C218DD9D11D3B98100C04F2233EA","A202C22CDD9D11D3B98100C04F2233EA","A202C219DD9D11D3B98100C04F2233EA","A202C21ADD9D11D3B98100C04F2233EA","A202C22EDD9D11D3B98100C04F2233EA","A202C22FDD9D11D3B98100C04F2233EA","A202C230DD9D11D3B98100C04F2233EA","A202C231DD9D11D3B98100C04F2233EA","A202C21BDD9D11D3B98100C04F2233EA","A202C21CDD9D11D3B98100C04F2233EA","A202C232DD9D11D3B98100C04F2233EA","A202C233DD9D11D3B98100C04F2233EA","A202C234DD9D11D3B98100C04F2233EA","A202C21DDD9D11D3B98100C04F2233EA","A202C21EDD9D11D3B98100C04F2233EA","A202C236DD9D11D3B98100C04F2233EA","A202C21FDD9D11D3B98100C04F2233EA","A202C220DD9D11D3B98100C04F2233EA","A202C237DD9D11D3B98100C04F2233EA","A202C238DD9D11D3B98100C04F2233EA","A202C239DD9D11D3B98100C04F2233EA","A202C221DD9D11D3B98100C04F2233EA","A202C235DD9D11D3B98100C04F2233EA","A202C23ADD9D11D3B98100C04F2233EA","A202C23BDD9D11D3B98100C04F2233EA","9C374206DD9F11D3B98100C04F2233EA","9C374207DD9F11D3B98100C04F2233EA","9C374209DD9F11D3B98100C04F2233EA","9C374220DD9F11D3B98100C04F2233EA","9C37421CDD9F11D3B98100C04F2233EA","9C37420CDD9F11D3B98100C04F2233EA","9C374208DD9F11D3B98100C04F2233EA","9C37421DDD9F11D3B98100C04F2233EA","9C374236DD9F11D3B98100C04F2233EA","9C37420DDD9F11D3B98100C04F2233EA","9C374233DD9F11D3B98100C04F2233EA","9C37420EDD9F11D3B98100C04F2233EA","9C374214DD9F11D3B98100C04F2233EA","9C374216DD9F11D3B98100C04F2233EA","9C374215DD9F11D3B98100C04F2233EA","9C37421EDD9F11D3B98100C04F2233EA","9C374219DD9F11D3B98100C04F2233EA","9C37421ADD9F11D3B98100C04F2233EA","9C374218DD9F11D3B98100C04F2233EA","9C37421BDD9F11D3B98100C04F2233EA","9C37420FDD9F11D3B98100C04F2233EA","9C374210DD9F11D3B98100C04F2233EA","9C37420BDD9F11D3B98100C04F2233EA","9C37421FDD9F11D3B98100C04F2233EA","9C374211DD9F11D3B98100C04F2233EA","9C374221DD9F11D3B98100C04F2233EA","9C37420ADD9F11D3B98100C04F2233EA","9C374212DD9F11D3B98100C04F2233EA","9C374213DD9F11D3B98100C04F2233EA"],BE=12,B=4,AD=1,A2=2,Bd=4,BC=256,BO=15,Bb=1,BA=2,AO=4,Ar=8,c=1,Am=2,AJ=8,Bl=16,AL=1,H=0,E=" ",d=".",Q="/",Au=";";function K(Bm){var Bn=P.trim(Bm);if(Bn.slice(-1)===Au){Bn=Bn.slice(0,-1);}return Bn;}function x(Bm,Bn){if(!Bn){return Bm;}return Bn.indexOf("#1")>-1?Bn.replace("#0.","").replace("#1",Bm):Bn.replace("#0",Bm);}function k(Bo,Br,Bp){var Bt=[],Bn=Bp.length,Bs,Bm,Bu,Bq,Bv=10;Bm=mstrApp.isBigQuery?"":((this.getDBRole&&this.getDBRole(this.SelDBRoleID).mdDBRole.cpat)||"");Bu=mstrApp.isBigQuery?"":((this.getDBRole&&this.getDBRole(this.SelDBRoleID).mdDBRole.tpat)||"");Bt.push({v:"select",oi:{n:"select",sta:100,t:100}},{isNew:true,v:" ",isDelimiter:true});Z.forEach(Bp,function(Bx,Bw){Bt.push({v:x(Bx.cln,Bm)});Bs=Bw<Bn-1;if(Bs){Bt.push({v:",",isDelimiter:true});}Bt.push({v:"\n",isDelimiter:true});if(Bs){for(Bq=0;Bq<Bv;++Bq){Bt.push({v:" ",isDelimiter:true});}}});Br=x(Br,Bu);Bt.push({v:"from",oi:{n:"from",sta:100,t:100}},{v:" ",isDelimiter:true},{v:" ",isDelimiter:true},{v:" ",isDelimiter:true},{v:(Bo?x(Bo,Bu)+d+Br:Br)},{v:";"});this.raiseEvent({name:"sqlTokensAdded",value:Bt});}function AA(Bn){if(!Bn||!Bn.length){return ;}var Bm=Bn[Bn.length-1];if(Bm&&Bm.tp===-1){Bn.pop();}if(Bn[0]&&(Bn[0].tp===64||(Bn[0].tp===36&&Bn[0].v==="$"))){Bn.splice(0,1);}}function C(Bn){var Bm=[];Z.forEach(Bn,function(Bo){Bm.push(Bo.v);});return Bm.join(" ");}function Ai(Bn){var Bm={">=":2,"<>":5,"<=":4,"<":3,">":1},Bo;for(Bo in Bm){if(Bn.indexOf(Bo)>-1){return Bm[Bo];}}return 0;}function D(Bo,Bq){var Bm=function(Bs,Br){return mstrmojo.array.stringSorter(Bs.n||Bs.did,Br.n||Br.did);},Bp,Bn=[];if(Bq){Z.forEach(Bo,function(Br){Z.forEach(Br.fns,function(Bs){if(Z.indexOf(b,Bs.did)>-1){Br.fns=Br.fns.sort(Bm);Bp=[];Z.forEach(Br.fns,function(Bt){if(Z.indexOf(b,Bt.did)>-1){Bp.push(Bt);}});Br.fns=Bp;Bn.push(Br);return false;}});});Bn=Z.filter(Bn,function(Br){return Br.n&&(Br.n.indexOf("Financial")===-1&&Br.n.indexOf("Statistical")===-1);});}else{Z.forEach(Bo,function(Br){Z.forEach(Br.fns,function(Bs){if(Z.indexOf(BV,Bs.did)>-1){Br.fns=Br.fns.sort(Bm);if(mstrApp.isCloudPro&&Bs.did===BV[2]){Z.removeItems(Br.fns,"did",[{did:BL}]);}Bn.push(Br);return false;}});});}Bn=Bn.sort(Bm);return Bn;}var AQ={1:"Sum",2:"Avg",3:"Min",4:"Max",5:"Count",6:"Count<Distinct=true>"};var BV=["8107C31BDD9911D3B98100C04F2233EA","6F7DF5F8449111D5BEA300B0D01A55EF","4A257916A153468384320E8DB7FD338B","8107C345DD9911D3B98100C04F2233EA","6F7DF605449111D5BEA300B0D01A55EF","8107C324DD9911D3B98100C04F2233EA","F262C81CDDA611D3B98100C04F2233EA"];var BL="8107C344DD9911D3B98100C04F2233EA",Bg=".";function A5(Bq,Bm,Br){if(!Br){return ;}var Bp=Br.expr,Bn,Bo=Br.cols;Z.forEach(Bp,function(Bs){Bn=Bs.tknctx&&Bs.tknctx.oi;if(Bn&&Bn.tp===26){if(Bs.extra.sqlti.als===Bq){Bs.extra.sqlti.als=Bm;Bs.v=(Bs.v+"").replace(Bq,Bm);}}});Z.forEach(Bo,function(Bs){if(Bs.t===Bq){Bs.t=Bm;Bs.v=(Bs.v+"").replace(Bq,Bm);}});Br.n=(Br.n+"").replace(Bq,Bm);Z.forEach(Br.nds,function(Bs){A5(Bq,Bm,Bs);});}function I(Bu,Bm){Bu=Bu||{};if(!Bm){return ;}var Br=Bm.expr,Bt,Bo,Bs=Bm.cols,Bq,Bn,Bp=this;Z.forEach(Br,function(Bw){if(Bw.tp===309){var Bv=Bp.resolveToken(Bw.v.toString());Bo=Bv.tableName;Bn=Bv.colName;if(Bo&&Bn){Bu[Bo]=Bu[Bo]||{};Bu[Bo][Bn]=true;}}});Z.forEach(Bs,function(Bv){Bo=Bv.t.toLowerCase();Bu[Bo]=Bu[Bo]||{};Bu[Bo][Bv.col.toLowerCase()]=true;});Z.forEach(Bm.nds,function(Bv){I.call(Bp,Bu,Bv);});}var X=mstrmojo.expr,BF=X.ET,A={19:" AND ",20:" OR ",21:"(NOT( "},AT="))";function An(Bq){if(!Bq){return"";}if(!Bq.nds){return Bq.n||"";}var Bo=[],Bp=Bq.nds,Bn=Bq.fn,Bm;Z.forEach(Bp,function(Bs,Br){Bm=Bs.not;if(Br!==0){Bo.push(A[Bn]);}Bm&&Bo.push(A[21]);Bo.push("(");Bo.push(An(Bs));Bo.push(")");Bm&&Bo.push(AT);});return Bo.join("");}function AI(Bm){return BQ(Bm).replace(/&apos;/g,"'");}function Ah(Bm){return Bm.replace(/&gt;/g,">").replace(/&lt;/g,"<").replace(/&quot;/g,'"').replace(/&amp;apos;/g,'"').replace(/&apos;/g,"'").replace(/^\n+|\n+$/g,"").replace(/\t/g," ").replace(/&amp;/g,"&");}var BH=function(Bm){if(Bm==null){return"null";}var Bn=typeof (Bm);if(Bn!="object"){return Bn;}else{if(Bm.length===undefined){return"object";}else{return"array";}}};var AE=[{n:"Text",v:"3"},{n:"Number",v:"2"},{n:"Date",v:"8"},{n:"Time",v:"9"},{n:"DateTime",v:"1"},{n:"URL",v:"5"},{n:"Email",v:"6"},{n:"HTML Tag",v:"7"},{n:"Symbol",v:"10"},{n:"Big Decimal",v:"11"},{n:"Phone Number",v:"12"}];function u(Bq){var Bo=[],Bn=[];var Bp={mi:true,cn:true,v:true,tp:true,lv:true,sta:true,tkn:true};Bo.push({lv:3,sta:1,tp:64,v:""});Bo.push({lv:1,sta:1,tp:2,v:Bq});Bo.push({lv:2,sta:1,tp:-1,v:""});var Bm={getArrItemName:function(Bt,Br,Bs){return"tkn";},isSerializable:function(Bt,Bs,Br){return(Bp[Bt])?true:false;}};Bn.push('<mi cn="3">');Bn.push(P.json2xml("tkn",Bo[0],Bm));Bn.push(P.json2xml("tkn",Bo[1],Bm));Bn.push(P.json2xml("tkn",Bo[2],Bm));Bn.push("</mi>");return Bn.join("");}var Ak=0,g=1,p=2,Bf=3,Be=4,Av=5,F=6,AH=7,BP=8,BG=9,Aq=10,Ac=11,AR=12;var Al={0:Ak,1:p,2:p,3:p,4:p,5:p,6:p,7:p,8:Bf,9:Bf,10:Bf,11:Bf,12:Bf,13:Bf,14:BP,15:BG,16:g,17:Bf,18:Bf,30:Ac,31:Ak,33:Ak};function r(Bo,Bs){var Bq=[],Bn,Br;for(var Bp=0,Bm=Bs.length;Bp<Bm;Bp++){Bn=Bs[Bp];if(Bo.uiids[Bn.tid+Bn.cid]){Br=Bo.uiids[Bn.tid+Bn.cid];Bq.push(Br);}}return Bq;}function AV(Br,Bo,Bs,Bm,By,Bv){if(!Bo.ftype){var Bn=Ah(Bo.exp);if(Bn.indexOf("? aptqbr_prompt")>-1){Bv.push({n:Bn,cid:Bm.chn[0].cmid});return ;}var Bz=r(Br,AX(Bm,[])),Bu,Bw=[];Z.forEach(Bz,function(B0){Bu=mstrmojo.all[B0];Bu&&Bu.updateState&&Bu.updateState(2);Bw.push({t:Bu.srcTable,col:Bu.text});});return Bs.push({et:"*",n:Bn,expr:[{v:Bn}],sqltp:By,cols:Bw});}switch(Bo.ftype){case 19:case 20:case 21:var Bq=[],Bx;for(var Bp=0,Bt=Bo.children.length;Bp<Bt;Bp++){Bx=Bo.children[Bp];AV(Br,Bx,Bq,Bm.chn[Bp],By,Bv);}if(Bq.length==0){return ;}if(Bq.length<Bt&&Bq.length==1){Bs.push(Bq[0]);}else{Bs.push({et:14,fn:Bo.ftype,nds:Bq,not:(Bo.ftype==21),sqltp:By});}break;default:break;}}function M(Bo,Bq,Bm){if(!Bq.ftype){Bm.push({lcid:Bo.chn[0].col,rcid:Bo.chn[1].col,exp:Bq.exp});return Bq.exp;}var Bp,Bn,Br;switch(Bq.ftype){case 19:case 20:Bp=M(Bo.chn[0],Bq.children[0],Bm);Bn=M(Bo.chn[1],Bq.children[1],Bm);Br=Bp+((Bq.ftype==19)?" AND ":" OR ")+Bn;break;case 21:Br=" NOT "+M(Bo.chn[0],Bq.children[0],Bm);break;default:break;}return Br;}function AX(Bo,Bp){var Bq=Bo.chn;if(!Bq){if(Bo.col&&Bo.stbid){Bp.push({cid:Bo.col,tid:Bo.stbid});}return Bp;}for(var Bn=0,Bm=Bq.length;Bn<Bm;Bn++){Bp=AX(Bq[Bn],Bp);}return Bp;}function h(Bm){Bm.raiseEvent({name:"dataPreview",mappings:Bm.mappings,dataset:Bm.dataset,selectedColumns:Bm.selectedClns,isRefined:Bm.isRefined});}function BI(Bm,Bp,Bn){var Bo=Bm[Bm.length-1].oi.def.csl.roo.chn[0].va.vv;Bo=Bo?Ah(Bo):"";mstrApp.getRootController().raiseEvent({name:"reportModeChange",mode:2,value:Bo});Bn.populateFFSQLMapping(Bp);if(Bn.firstTimeLoading){h(Bn);Bn.firstTimeLoading=false;}}function At(CO,Br){if(!CO||!CO.btb){return ;}var B9=CO.btb;var CT=CO.datap.maps;if(Br.firstTimeLoading){Br.orimaps=CT;}Br.refresh_opt=B9[0].oi.def.crpt;var B8=null;if(B9[0].oi.ext_type===304){Br.set("isFFSQL",true);Br.set("FFSQLMode",true);mstrApp.isFFSQL=mstrApp.isFFSQLMode=true;for(var CZ=0,CA=B9.length;CZ<CA;CZ++){if(B9[CZ].oi.tp===53){B8=B9[CZ].oi.def.dbr.did;}}B8&&Br._set_SelDBRoleID("SelDBRoleID",B8,false);BI(B9,CT,Br);return ;}var Cb={},Bo={},Bn,Bq;for(var CZ=0,CA=B9.length;CZ<CA;CZ++){Bq=B9[CZ].oi;switch(Bq.tp){case 53:Cb[Bq.did]={cs:Bq.def.cs.cs,tbn:AI(Bq.def.tbn),did:Bq.did,ns:Bq.def.ns};break;case 26:Bo[Bq.did]={did:Bq.did,cln:AI(Bq.def.cln),dttp:Bq.def.dt.tp,dtps:Bq.def.dt.ps,dtsc:Bq.def.dt.sc};break;case 3:Bn=Bq.efd;break;default:break;}}var CB=null,CP=null;for(var CZ=0,CA=Bn.length;CZ<CA;CZ++){CP=Bn[CZ].oi;switch(CP.tp){case 53:CB=CP.def.sqs.c_c[0];B8=CP.def.dbr.did;break;default:break;}}Br._set_SelDBRoleID("SelDBRoleID",B8,false);if(CB===null){return ;}var CI=CB.sqcs.c_c;var B4=CB.sjs.c_c;var Ca=CB.stbs.c_c;var B0=CB.whe;var CR=CB.w_cond;var Ce=CB.he;var Bt=CB.h_cond;Br.selectedClns=[];Br.dbtables=[];Br.joins=[];Br.joinsInfo={};Br.uiids={};Br.tables={};var CW=Br.selectedClns;var CN={},B7,Cc,Bz,B3,Bw;for(var CZ=0,CA=CI.length;CZ<CA;CZ++){if(CI[CZ].der&2147483648){CW.push({isDerived:true,existing:true});continue;}B7=AX(CI[CZ].exp.roo,[]);Cc=AI(CI[CZ].exp.exp);CW.push({wid:[],expr:[{v:Cc}],existing:true});for(var CY=0;CY<B7.length;CY++){Bw=B7[CY];Bz=Bw.cid;B3=Bw.tid;CN[B3]=CN[B3]||{};CN[B3][Bz]=CN[B3][Bz]||{};CN[B3][Bz].state=1;CN[B3][Bz].count=!CN[B3][Bz].count?1:CN[B3][Bz].count+1;CW[CZ].wid.push(B3+Bz);}}Br.tbns={};var B2=Br.pos_hash;var Bv=Br.tbns,CX=[];var CU,Bu,Bs,Bz,CF,CS,B6;for(var CZ=0,CA=Ca.length;CZ<CA;CZ++){CX[CZ]={};CU=Ca[CZ];B3=CU.id;Bu=CU.dbt.did;B6=CU.als?AI(CU.als):Cb[Bu].tbn;CF=Cb[Bu].cs;if(B2&&B2[B6]){CX[CZ].pos={w:B2[B6].w,h:B2[B6].h,t:B2[B6].t,l:B2[B6].l};}else{Bs=CU.sqltf;if(Bs&&Bs.length){CX[CZ].pos={w:(Bs[0]&&Bs[0].pdv)/BT||A4,h:(Bs[1]&&Bs[1].pdv)/BT||L,t:(Bs[2]&&Bs[2].pdv)/BT||m,l:(Bs[3]&&Bs[3].pdv)/BT||R};}}CS=[];for(var CY=0,CD=CF.length;CY<CD;CY++){Bz=CF[CY].did;CS.push(V.copy(Bo[Bz]));if(CN[B3]&&CN[B3][Bz]){CS[CY].state=1;CS[CY].count=CN[B3][Bz].count;}}CX[CZ].did=B3;CX[CZ].cs=CS;CX[CZ].tbn=B6;CX[CZ].ns=Cb[Bu].ns;CX[CZ].dbtbn=Cb[Bu].tbn;Bv[B6]=B6;}if(Br.firstTimeLoading&&!Br.isNew){Br.orits=Br.orits||CX.slice(0);}var B5=Br.orits;Z.forEach(CX,function(Cf){if(Z.find(B5,"did",Cf.did)>-1){Cf.existing=true;Cf.readOnly=mstrApp.isCloudPro;}});Br.raiseEvent({name:"BindingTableLoaded",value:CX});for(var CZ=0,CA=CW.length;CZ<CA;CZ++){var CV=CW[CZ].wid;if(CV){for(var CY=0,CD=CV.length;CY<CD;CY++){CV[CY]=Br.uiids[CV[CY]];}}}Br.populateMappings(CT);if(CO.datap.data){Br.populateDataset(CO.datap.data);}h(Br);var B1,CL,Bp,Bx,CM,CG,CJ,Bm,Cc,CC,Cd;for(var CZ=0,CA=B4.length;CZ<CA;CZ++){B1=B4[CZ];CL=B1.ltid,Bp=B1.rtid,Bx=B1.jt,idx=B1.ix;CG=B1.cdn.roo;Cd=[];Cc=AI(M(CG,B1.exp_bo,Cd));CC=Br.uiids[CL]+Br.uiids[Bp];Br.joins.push(CC);Br.joinsInfo[CC]=new Object();Br.joinsInfo[CC].jt=""+Bx;Br.joinsInfo[CC].exp=Cc;Br.joinsInfo[CC].srctID=Br.uiids[CL];Br.joinsInfo[CC].tgttID=Br.uiids[Bp];if(!Br.joinsInfo[CC].links){Br.joinsInfo[CC].links=new Object();}if(Br.tables[Br.uiids[CL]].njoins){Br.tables[Br.uiids[CL]].njoins++;}else{Br.tables[Br.uiids[CL]].njoins=1;}if(Br.tables[Br.uiids[Bp]].njoins){Br.tables[Br.uiids[Bp]].njoins++;}else{Br.tables[Br.uiids[Bp]].njoins=1;}for(var CY=0;CY<Cd.length;CY++){CJ=Cd[CY].lcid;Bm=Cd[CY].rcid;Cc=AI(Cd[CY].exp);var CQ=Br.uiids[CL+CJ],By=Br.uiids[Bp+Bm];Br.joinsInfo[CC].links[CQ+By]={srcw:mstrmojo.all[CQ],tgtw:mstrmojo.all[By],coords:[],exp:Cc,jid:CC,op:Ai(Cc)};if(Br.joinsInfo[CC].nlinks){Br.joinsInfo[CC].nlinks++;}else{Br.joinsInfo[CC].nlinks=1;}}}Br.raiseEvent({name:"JoinsLoaded"});var B9=[],CH=[];if(B0.exp!=""){AV(Br,CR,B9,B0.roo,0,CH);B9.length&&(Br.conditions.where=B9[0]);if(CH.length&&!Br.isCubeReport){Br.pattrs={};var CE=CT.amps,CK;Z.forEach(CE,function(Cf){if(Z.find(CH,"cid",Cf.afmps[0].sqc.id)>=0){CK=Cf.aimp;Br.pattrs[CK.atid]={n:CK.atnm,tp:12};}});}}if(Ce.exp!=""){B9=[];AV(Br,Bt,B9,Ce.roo,1);B9.length&&(Br.conditions.having=B9[0]);}Br.firstTimeLoading=false;}function AP(Bo,Bn,Bm){mstrApp.getRootController().getDataService()[Bm||"submitRequest"](Bo,Bn);}function G(Bm,Bp,Bo){var Bn={};if(!Bm[Bp]){Bm[Bp]=Bo;}else{if(!Bm[Bo]){Bm[Bo]=Bp;}else{while(Bm[Bp]){Bn[Bp]=true;Bp=Bm[Bp];if(Bn[Bp]){return ;}}Bm[Bp]=Bo;}}}function BM(Bm,Bo,Bn){if(Bm[Bo]){delete Bm[Bo];}else{if(Bm[Bn]){delete Bm[Bn];}}}function BD(Bm,Bp,Bo){var Bn={};while(Bm[Bp]){Bn[Bp]=true;Bp=Bm[Bp];if(Bn[Bp]){return true;}}while(Bm[Bo]){Bn[Bo]=true;Bo=Bm[Bo];if(Bn[Bo]){return true;}}return Bp===Bo;}function Bi(Br,Bp){var Bs=[],Bo,Bn,Bm,Bq;for(Bn in Br){Bm=Br[Bn].links;Bq=Bm[0];Bo={srcIndex:Bp.gettIndex(Bq.srcw.srcID),destIndex:Bp.gettIndex(Bq.tgtw.srcID),jtype:Bq.jtype,jexp:Br[Bn].jexp};Bs.push(Bo);}return Bs;}mstrmojo.qb._hasQBModel=mstrmojo.provide("mstrmojo.qb._hasQBModel",{id:"QBuilderModel",tables:{},selLink:null,dbtbls:{},uiids:{},riid:"",analysisID:null,alertTitle:null,msgid:"",dbtables:[],selectedClns:[],joins:[],joinsInfo:{},joinCols:{},dbrs:[],dsns:[],drivers:[],dbms:[],suppdbs:[],pos_hash:{},bindingT:[],tbns:{},catalogRefresh:false,SelDBRoleID:null,prevDBRoleID:null,isDI:false,FFSQLMode:false,isFFSQL:false,isCloud:false,supportTimeGeo:true,isCubeReport:true,autoRefreshSQL:false,isDirty:false,SQLPreviewStmt:"",SQLstmt:undefined,refresh_opt:1,mappings:[],cloneMappings:[],dataset:[],cacheMP:[],cacheDS:[],conditions:{},cnum:0,datatypes:AE,init:function Bh(Bm){if(this._super){this._super(Bm);}this.dbtables=[];this.tables={};this.selectedClns=[];this.tbns={};this.joins=[];this.joinsInfo={};this.joinCols={};this.uiids={};this.conditions={};this.mappings=[];this.cloneMappings=[];this.dataset=[];this.cacheMP=[];this.cacheDS=[];},addLink:function n(Bo,Bs,Bn,Br){var Bp=this,Bw=Bo.id+Bs.id,Bx=Bp.joinsInfo[Bn].links,Bq=Bp.joinsInfo[Bn].jt;var Bv=this.getjIndex(Bn),Bm=this.brackets(Bo.oriexpr)+"="+this.brackets(Bs.oriexpr),Bu=Bp.joinsInfo[Bn].exp+" AND "+Bm;if(Bx[Bw]||Bx[Bs.id+Bo.id]){return ;}var Bt={success:function(By){Bp.joinsInfo[Bn].exp=Bu;Bx[Bw]={};Bx[Bw].srcw=Bo;Bx[Bw].tgtw=Bs;Bx[Bw].coords=[];Bx[Bw].exp=Bm;Bx[Bw].jid=Bn;Bp.joinsInfo[Bn].exp=Bu;if(Br&&Br.success){Br.success();}Bp.raiseEvent({name:"JoinsAdded"});}};G(Bp.joinCols,Bo.id,Bs.id);mstrApp.getRootController().getDataService().editJoin(Bt,{jindex:Bv,exp:Bu,tbid:Bp.tableID||"",jtype:Bq});},removeLink:function AB(Bs,Bm,Bp){var Bn=this,Bv=Bn.joinsInfo[Bm].links,Bo=Bn.joinsInfo[Bm].jt,Bu=Bn.getjIndex(Bm),Br="",Bt=Bv[Bs];V.forEach(Bv,function(Bx,Bw){if(Bw!==Bs){Br+=(Br?" AND ":"")+Bx.exp;}});BM(Bn.joinCols,Bt.srcw.id,Bt.tgtw.id);if(!Br){Bn.removeJoin(Bm,Bp);}else{var Bq={success:function(Bw){mstrApp.msgid=Bw.msgid;Bn.joinsInfo[Bm].exp=Br;delete Bv[Bs];if(Bp&&Bp.success){Bp.success();}}};mstrApp.getRootController().getDataService().editJoin(Bq,{jindex:Bu,exp:Br,tbid:Bn.tableID||"",jtype:Bo});}},getTouchValue:function Aw(Bm,Br){for(var Bp in this.joinsInfo){var Bo=this.joinsInfo[Bp].links;for(var Bq in Bo){var Bn=Bo[Bq].coords;if(this.inPoly(Bn,Bm,Br)){return[Bp,Bq];}}}return null;},inPoly:function BB(Bo,By,Bx){var Bu=Bo.length;var Br,Bm,Bz,Bt,Bp,Bw,Bn,Bv,Bs;var Bq=false;if(Bu/2<3){return false;}Bz=Bo[Bu-2];Bt=Bo[Bu-1];for(Bs=0;Bs<Bu;Bs=Bs+2){Br=Bo[Bs];Bm=Bo[Bs+1];if(Br>Bz){Bp=Bz;Bn=Br;Bw=Bt;Bv=Bm;}else{Bp=Br;Bn=Bz;Bw=Bm;Bv=Bt;}if((Br<By)==(By<=Bz)&&((Bx-Bw)*(Bn-Bp)<(Bv-Bw)*(By-Bp))){Bq=!Bq;}Bz=Br;Bt=Bm;}return Bq;},exprEditor:function(Bn,Bo,Bp,Bm){this.getFunctions();},brackets:function(Bm){return"["+Bm+"]";},isEquivalentExpr:function(Bo,Bn){var Bm=function Bm(Bp){return Bp.replace(/\s/g,"").replace(/\[+(.*?)\]+/g,"$1").replace(/\(+(.*?)\)+/g,"($1)").toUpperCase();};return(Bm(Bo)===Bm(Bn));},_set_SelDBRoleID:function(Bp,Bn){var Bm=this,Bo=(Bm.SelDBRoleID!==Bn);this._super&&this._super(Bp,Bn);Bm.SelDBRoleID=Bn;if(Bo&&Bn){Bm.setDBRole&&Bm.setDBRole(Bn);}Z.forEach(Bm.dbrs,function(Bq){if(Bq.data.isPrimary){Bq.data.isPrimary=false;Bm.raiseEvent({name:A6.DBROLE_CHANGED,item:Bq});}if(Bq.did===Bn){Bq.data.isPrimary=true;Bm.raiseEvent({name:A6.DBROLE_CHANGED,item:Bq});}});if(Bo){Bm.raiseEvent({name:A6.DBTABLES_ENABLED,value:Bm.getAvailableTablesEnabled()});mstrApp.getRootController().enableButton();}return Bo;},setDBRole:function(Bn){var Bm=this;Bm.connectLiveSupport=undefined;if(this.tableID){mstrApp.getRootController().getDataService().setDBRole({success:function(Bo){mstrApp.msgid=Bo.msgid;Bm.loadConnectLiveSupport();}},{dbrid:Bn,tbid:this.tableID});}},autoMap:function(Bo,Bn,Bq){var Bp=this;if(!Bp.FFSQLMode){if(Bp.getColumnsCount()===0){mstrmojo.alert(mstrmojo.desc(9945,"Please add at least one column and try again."));if(Bo&&Bo.failure){Bo.failure();}return ;}else{if(Bp.getTablesCount()===0){mstrmojo.alert(mstrmojo.desc(9946,"Please add at least one table and try again."));if(Bo&&Bo.failure){Bo.failure();}return ;}}}var Bm={success:function(Bs){Bp.isDirty=false;if(!Bn){var Br=Bs.datap,Bv=Br.maps,Bt=Br.data;if(Bp.FFSQLMode){var Bu=[];Bp.populateFFSQLMapping(Bv);Bp.populateDataset(Bt);}else{Bp.populatePreview(Bv,Bt);}h(Bp);}if(Bo&&Bo.success){Bo.success(Bs);}}};Bp.loadReport(Bd,BO,c+Am,Bq?H:AL,Bm);},convertToQueryBuilder:function z(Bm){var Bn=this;mstrApp.getRootController().getDataService().convertToQB({success:function Bo(Bp){mstrApp.msgid=Bp.msgid;mstrApp.isFFSQLMode=false;Bn.isDirty=true;Bn.FFSQLMode=false;Bn.mappings=Bn.cacheMP;Bn.dataset=Bn.cacheDS;h(Bn);Bm&&Bm.success&&Bm.success(Bp);}},{tbid:Bn.tableID||""});},convertToFFSQL:function AG(Bp,Bn,Bm){var Bo=this;Bo.SQLstmt=Bp;mstrApp.getRootController().getDataService().convertToFFSQL({success:function Bq(Br){mstrApp.msgid=Br.msgid;Bo.isDirty=true;Bo.FFSQLMode=true;mstrApp.isFFSQLMode=true;Bo.cacheMP=Bo.mappings;Bo.cacheDS=Bo.dataset;Bo.dataset=[];Bo.mappings=[];if(!Bm){h(Bo);}Bn&&Bn.success&&Bn.success(Br);}},{tbid:Bo.tableID||"",exp:P.encodeXMLAttribute(Bp)});},isMultiPassSQL:function Ab(Bm){return K(Bm).indexOf(Au)>-1;},autoMapFFSQL:function Aa(Bn,Bp){var Bm=this;Bn=K(Bn);mstrApp.getRootController().getDataService().editFFSQL({success:function Bo(Bq){Bm.isDirty=Bm.isDirty||(P.trim(Bm.SQLstmt)===P.trim(Bn)?false:true);Bm.SQLstmt=Bn;Bm.isDDA=Bm.isDDA&&!Bm.isMultiPassSQL(Bn);if(Bn){Bm.autoMap(Bp,undefined,undefined,true);}else{Bm.dataset=[];Bm.mappings=[];h(Bm);Bp&&Bp.success&&Bp.success({msgid:mstrApp.msgid});}}},{exp:P.encodeXMLAttribute(Bn).replace(/\t/g,BS),tbid:Bm.tableID||""});},editFFSQL:function BW(Bn,Bo){var Bm=this;if(this.SQLstmt===Bo){if(Bn&&Bn.success){Bn.success();return ;}}Bo=K(Bo);mstrApp.getRootController().getDataService().editFFSQL({success:function Bp(Bq){mstrApp.msgid=Bq.msgid;Bm.isDirty=true;Bm.SQLstmt=Bo;Bn&&Bn.success&&Bn.success(Bq);}},{exp:P.encodeXMLAttribute(Bo).replace(/\t/g,BS),tbid:Bm.tableID||""});},updateSQL:function(Bm){this.getSQL(Bm);},getSQL:function f(Bn){var Bo=this;if((!Bo.SelDBRoleID&&Bo.riid===A7)||Bo.dbtables.length===0){var Bm="";if(Bn&&Bn.success){Bn.success(Bm);}}else{Bo.loadReport(A2,BO,null,null,{success:function Bp(Br){var Bs=Br.sqls[Br.sqls.length-1],Bq=Bs?Ah(Bs):"";if(Bn&&Bn.success){Bn.success(Bq);}}},true);}},isNameUnique:function(Br,Bn,Bo){var Bs=this,Bq=Bs.mappings;for(var Bp=0,Bm=Bq.length;Bp<Bm;Bp++){if(Bp!=Bn){if(Bo===Bq[Bp].alias&&Bq[Bn].tp==Bq[Bp].tp){return false;}}}return true;},mapAttribute:function(By,Bn,Bp,Bu,Bv,Bw){var Bo=this,Br=Bo.mappings;for(var Bq=0,Bt=Br.length;Bq<Bt;Bq++){if(Br[Bq].afid===(Bn+Bp)){if(Bv&&Bv.failure){Bv.failure(mstrmojo.desc(9926,"The attribute form you select has been mapped. Please choose a different one."));}return false;}}var Bs=Z.find(Br,"did",By),Bm=Br[Bs],Bx=function Bx(Bz){mstrApp.getRootController().getDataService().remapObject({success:function B0(B1){Bo.autoMap();if(Bv&&Bv.success){Bv.success(B1);}}},{mpcs:JSON.stringify(Bz),docid:mstrApp.docID||"",suppressError:true});};if(Bm.isIDForm&&Bm.multiForms&&!Bm.ipa){mstrmojo.confirm(mstrmojo.desc(11164,"All other forms of the attribute will be unmapped. Do you want to continue?"),{confirmBtn:{fn:function(){var Bz=[];Z.forEach(Br,function(B0){if(B0.oid===Bw&&B0.did!==By){Bz.push({did:B0.did,aid:"",ot:BE});}});Bz.push({did:By,aid:Bn,fid:Bp});Bx(Bz);}}});}else{Bx([{did:By,aid:Bn,fid:Bp}]);}},unmap:function(Bq,Bp){var Br=this,Bs=Br.mappings,Bn=Z.find(Bs,"did",Bq),Bm=Bs[Bn],Bo=function Bo(Bt){mstrApp.getRootController().getDataService().remapObject({success:function Bu(Bv){Br.autoMap();}},{mpcs:JSON.stringify(Bt),docid:mstrApp.docID||"",suppressError:true});};if(Bm.isIDForm&&Bm.multiForms){mstrmojo.confirm(mstrmojo.desc(11164,"All other forms of the attribute will be unmapped. Do you want to continue?"),{confirmBtn:{fn:function(){var Bt=[];Z.forEach(Bs,function(Bu){if(Bu.oid===Bp&&Bu.did!==Bq){Bt.push({did:Bu.did,aid:"",ot:BE});}});Bt.push({did:Bq,aid:"",ot:BE});Bo(Bt);}}});}else{Bo([{did:Bq,aid:"",ot:BE}]);}},remap:function S(Bn,Bm){mstrApp.getRootController().getDataService().changeMapping({success:function Bo(Bp){if(Bm&&Bm.success){Bm.success(Bp);}}},{tbid:this.tableID||"",mpcs:JSON.stringify([Bn]),docid:mstrApp.docID||""});},commitMapping:function(Bt){var Bn=this;var Bu=this.cloneMappings,Bv=this.mappings;var Bq,Br=[],Bm,Bo,Bw;for(var Bp=0,Bs=Bu.length;Bp<Bs;Bp++){Bo=Bu[Bp];Bw=Bv[Bp];Bq={};Bm=false;if(!Bw.selected){Br.push({did:Bw.did,cmf:0});}else{if(Bw.alias!=Bo.alias){Bq.alias=Bw.alias;Bm=true;}if(Bw.dtp!=Bo.dtp){Bq.bft=Bw.dtp;Bm=true;}if(Bw.tp!=Bo.tp){Bq.ot=Bw.tp;Bm=true;}if(Bm){Bq.did=Bw.did;Br.push(Bq);}}}if(Br.length>0){mstrApp.getRootController().getDataService().remapObject({success:function(Bx){if(Bt&&Bt.success){Bt.success(Bx);}}},{mpcs:JSON.stringify(Br),docid:mstrApp.docID||""});}else{if(Bt&&Bt.success){Bt.success();}}},validateExpr:function J(Bn,Bm){this.parseExpression(Bn.vo===1,1,Bn.cIndex,null,Bn.qbrex,Bn.expr,Bn.tKnStrm,Bm);},parseExpression:function AK(Bt,Bn,Bu,Bm,Bs,Bp,Br,Bq){var Bo={qbrex:Bs};Bo.qindex=Bn||1;Bo.tbid=this.tableID||"";if(Bm!=null){Bo.jindex=Bm;}if(Bp!=null){Bo.exp=Bp;}if(Br){Bo.tokenStrm=Br;}Bo.vo=1;mstrApp.getRootController().getDataService().parse({success:function(Bv){if(Bv&&Bv.mi&&Bv.mi.items){var Bw=Bv.mi.items;AA(Bw);Bv.expr=C(Bw);}if(Bq&&Bq.success){Bq.success(Bv);}}},Bo);},canAddTable:function Ap(Bq){var Bp=this,Bn=Bp.SelDBRoleID,Bo=Bp.dbridForDDA,Bm;if(Bp.isDDA&&Bo&&Bn!==Bo){Bm={name:"directDataAccessTableError"};}if(Bm){if(!Bq){this.raiseEvent(Bm);}return false;}return true;},addTable:function W(By,Bz){var Br=this,Bq=By.tbn||By.did,Bw=Br.tbns,Bx,Bt=1,Bu=[],Bp,Bs=Br.SelDBRoleID,Bv;if(!this.canAddTable()){return ;}Bq=Bq.replace(/^[0-9]/,"L");Bx=Bq;while(Bw[Bx]){Bx=Bq+"_"+(Bt++);}Bq=Bx;Z.forEach(Bz,function(B0){Bp=B0.dt;Bu.push({cln:B0.cln,dtps:Bp.ps,dttp:Bp.tp,dtsc:Bp.sc});});var Bo={tbn:By.dbtn||By.tbn||By.did,clns:JSON.stringify(Bu),ns:By.ns,alias:Bq,tbid:Br.tableID||""},Bn=this.getMissingTableID(By.tbn,Bq,By.ns);if(Bn){Bo.stbid=Bn;}var Bm={success:function(B0){Bw[Bq]=Bq;Br.isDirty=true;mstrApp.msgid=B0.msgid;Br.raiseEvent({name:"TableAdded",data:Bz,table:{x:By.x,y:By.y,tbn:Bq,dbtbn:By.tbn||By.did,ns:By.ns,did:Bn}});if(Br.dbtables.length>1){Br.autoJoin();}Br.prevDBRoleID=Bs;if(!Br.isDDA){Bv=mstrApp.getRootController().getDDAController();Bv.tryEnableDDACheckbox(false);}}};mstrApp.getRootController().getDataService().addTable(Bm,Bo);},resolveToken:function(Bo){var Bt=Bo.indexOf(Bg),Br,Bq,Bs,Bp,Bu;if(Bt>=1){Br=Bo.slice(0,Bt).toLowerCase();Bq=Bo.slice(Bt+1).toLowerCase();}else{Bq=Bo.toLowerCase();Bs=this.tables;for(var Bm in Bs){Bp=Bs[Bm],Bu=Bp.rows;for(var Bn in Bu){if(Bu[Bn].text.toLowerCase()===Bq){Br=Bp.tbn.toLowerCase();break;}}if(Br){break;}}}return{tableName:Br,colName:Bq};},removeTableFromCondition:function(Bq,Bs){if(!Bq){return false;}var Bm=Bq.nds,Bn,Bp=this;if(Bm){var Bu=[],Bt,Bo;Z.forEach(Bm,function(Bw,Bv){Bp.removeTableFromCondition(Bw,Bs)&&Bu.push(Bv);});for(Bt=Bu.length-1;Bt>-1;Bt--){Bm.splice(Bu[Bt],1);}Bo=Bm.length;if(Bo===1){Bq=Bm[0];}return(Bo===0);}var Br;Z.forEach(Bq.expr,function(Bv){if(Bv.tp===309){Bn=Bp.resolveToken(Bv.v).tableName;if(Bn===undefined||Bs===Bn){Br=true;return false;}}});return Br;},removeTable:function(Bn,Bp){var Br=this,Bo=this.gettIndex(Bn.id),Bq=Bn.Rows.children;var Bm={widget:Bn,success:function(B0){mstrApp.msgid=B0.msgid;Br.isDirty=true;var B4,B5,B8=this.widget.id;var B3=Br.tbns,B6=Br.tables[B8],Bv=B6.tbn,Bs=B6.dbtbn,B1=B6.ns;if(B3[Bv]){delete B3[Bv];}for(var Bu in Br.joinsInfo){var Bx=Br.joinsInfo[Bu].srctID,Bt=Br.joinsInfo[Bu].tgttID;if(B8==Bx||B8==Bt){B5=Br.joinsInfo[Bu].links;for(B4 in B5){BM(Br.joinCols,B5[B4].srcw.id,B5[B4].tgtw.id);}delete Br.joinsInfo[Bu];mstrmojo.array.removeItem(Br.joins,Bu);Br.tables[Bx].njoins--;Br.tables[Bt].njoins--;}if(Br.selLink&&Z.indexOf(Br.selLink[0],B8)>-1){Br.selLink=null;}}Br.upttIndex(Bv,Bs,B8,false,B6.did,B1);if(Br.dbtables.length===0&&Br.canAddTable(true)){Br.raiseEvent({name:A6.DBTABLES_ENABLED,value:true});mstrApp.getRootController().enableButton();}if(!Br.isDDA){ddaController=mstrApp.getRootController().getDDAController();ddaController.tryEnableDDACheckbox(true);}var Bz=Br.selectedClns,B7=[],By;Z.forEach(Bq,function(B9){Z.forEach(Bz,function(CB,CA){By=Z.indexOf(CB.wid,B9.id);if(By>-1){Z.removeIndices(CB.wid,By,1);if(Z.indexOf(B7,CA)==-1){B7.push(CA);}}});});B7.sort(mstrmojo.array.numSorter);for(var Bw=B7.length-1;Bw>-1;Bw--){Br.removeExpression(B7[Bw],true);}if(B7.length>0){h(Br);}Br.raiseEvent({name:"refreshTables",items:Br.dbtables.slice(0)});var B2=Br.conditions;Bv=Bv.toLowerCase();Br.removeTableFromCondition(B2.where,Bv)&&(delete B2.where);Br.removeTableFromCondition(B2.having,Bv)&&(delete B2.having);Br.updateFilterLabel(B2);if(Bp&&Bp.success){Bp.success();}}};mstrApp.getRootController().getDataService().removeTable(Bm,{tbid:Br.tableID||"",tindex:Bo});},getAvailableTablesEnabled:function Ao(){return(!mstrApp.isFFSQLMode)?this.canAddTable(true):this.canAddTableSQL(true);},addExpression:function A3(Bm,Bn){var Bs=C(this.selectedClns[Bm].expr);var Bq={did:Bm+Bs,alias:Bs,n:Bs,selected:false,hasMapped:false,isQB:!this.FFSQLMode,expr:this.selectedClns[Bm].expr,dtp:1,colo:Bm,ix:Bm,tp:0};this.mappings.push(Bq);var Bp=this.dataset.length;if(Bp>0){for(var Bo=0;Bo<Bp;Bo++){var Br=this.dataset[Bo];Br.push("");}}if(!Bn){mstrApp.getRootController().toggleDataPreview(true);h(this);}},removeExpression:function Bc(Bn,Bp){var Bm=this.selectedClns,Bq,Br=0,Bo;Z.forEach(Bm[Bn].wid,function(Bs){Bq=mstrmojo.all[Bs];Bq.count--;Bq.updateState(0);});if(this.isRefined&&!mstrApp.isFFSQLMode){Bo=Bm[Bn].ix;Z.forEach(Bm,function(Bs){if(Bs.ix>Bo){Br=Br?Math.min(Br,Bs.ix-Bo):Bs.ix-Bo;}});Z.forEach(Bm,function(Bs){if(Bs.ix>Bo){Bs.ix=Bs.ix-Br;}});}else{Bo=this.mappings[Bn].ix;Z.forEach(this.mappings,function(Bs){if(Bs.ix>Bo){Br=Br?Math.min(Br,Bs.ix-Bo):Bs.ix-Bo;}});Z.forEach(this.mappings,function(Bs){if(Bs.ix>Bo){Bs.ix=Bs.ix-Br;Bs.colo=Bs.colo-1;}});Z.removeIndices(this.mappings,Bn,1);}Bm.splice(Bn,1);Z.forEach(this.dataset,function(Bs){Z.removeIndices(Bs,Bn,1);});if(!Bp){h(this);}},editExpression:function(Bm){var Bo=this.selectedClns[Bm-1],Bn=Bo.wid;this.exprEditor(Bo,3,null,Bm);},updateExpression:function Bj(Bm){var Br=C(this.selectedClns[Bm].expr);var Bp=this.mappings[Bm];if(!Bp){return ;}Bp.did=Bm+Br;Bp.alias=Br;Bp.n=Br;Bp.expr=this.selectedClns[Bm].expr,Bp.selected=false;Bp.hasMapped=false;Bp.tp=0;var Bo=this.dataset.length;if(Bo>0){for(var Bn=0;Bn<Bo;Bn++){var Bq=this.dataset[Bn];Bq[Bm]="";}}h(this);},addSelectedColumns:function AS(Bn,Bq,Bp,Bw){var Bo=this,Bm,Bx,Bz=[],Bv,Bt,Bu,Bs=Bo.tables[Bo.dbtables[Bq-1]].existing;for(i=0;i<Bn.length;i++){Bv=Bn[i];Bu=Bv.dt;Bx={dt:Bu.tp,ps:Bu.ps,sc:Bu.sc,clix:Bv.rIndex+1,tblIdx:Bq};if(Bp!=null){Bx.findex=Bp;Bt=[AQ[Bp],"(",Bv.oriexpr,")"].join("");}else{Bt=Bv.expr[0].oi.n;}if(Bs){Bm=this.getMissingColumnID(Bt);if(Bm){Bx.cmid=Bm;}}Bz.push(Bx);}var By=JSON.stringify(Bz);var Br={success:function(B2){Bo.isDirty=true;mstrApp.msgid=B2.msgid;for(var B1=0,B0=Bn.length;B1<B0;B1++){Bo.addColumnIndex(Bn[B1],Bp,null,!Bs,Bz[B1].cmid,true);}mstrApp.getRootController().toggleDataPreview(true);h(Bo);if(Bw&&Bw.success){Bw.success(Bv);}}};mstrApp.getRootController().getDataService().addSelectedColumns(Br,{tbid:Bo.tableID||"",colArray:By});},addColumnWithExpression:function BZ(Bp,Bt,Bu,Bs){var Br=this,Bq=Bp.dt,Bo={dt:Bq.tp,ps:Bq.ps,sc:Bq.sc,tbid:Br.tableID||"",exp:Bt||""},Bn=Br.tables[Bp.srcID].existing;if(Bn){var Bm=this.getMissingColumnID(expr);if(Bm){Bo.cmid=Bm;}}mstrApp.getRootController().getDataService().addColumn({success:function(Bv){Br.isDirty=true;mstrApp.msgid=Bv.msgid;Bv.cIndex=Br.addColumnIndex(Bp,null,Bt,!Bn,Bm);mstrApp.getRootController().updateTableViewWithExpression(Bv.cIndex,Bu,true);if(Bs&&Bs.success){Bs.success();}}},Bo);},removeSelectedColumn:function(Bm,Br){var Bp=this,Bo=Bp.mappings,Bn=Bp.selectedClns[Bm].ix,Bq;if(this.isRefined&&!mstrApp.isFFSQLMode){Bq=typeof Bn!=="undefined"?Bn+1:Bm+1;}else{Bq=Bo[Bm].ix+1;}mstrApp.getRootController().getDataService().removeColumn({success:function(Bs){Bp.isDirty=true;mstrApp.msgid=Bs.msgid;Bp.removeExpression(Bm);if(Br&&Br.success){Br.success();}}},{cindex:Bq,tbid:Bp.tableID||""});},removeAllColumns:function AU(){var Bn=this,Bq=Bn.mappings,Bm=Bn.selectedClns,Bo=Bm.length,Bp;mstrApp.getRootController().getDataService().removeColumn({success:function(Br){Bn.isDirty=true;mstrApp.msgid=Br.msgid;Z.forEach(Bn.selectedClns,function(Bs){Z.forEach(Bs.wid,function(Bt){Bp=mstrmojo.all[Bt];Bp.count--;Bp.updateState(0);});});Bn.selectedClns=[];Bn.mappings=[];Bn.dataset=[];h(Bn);}},{count:Bo,tbid:Bn.tableID||""});},editColumnExpression:function Ag(Bm,Br,Bp,Bo){var Bn=this,Bq={cindex:Bn.mappings[Bm].ix+1,exp:Br||"",tbid:Bn.tableID||""};mstrApp.getRootController().getDataService().editColumn({success:function(Bs){Bn.isDirty=true;mstrApp.msgid=Bs.msgid;mstrApp.getRootController().updateTableViewWithExpression(Bm,Bp);if(Bo&&Bo.success){Bo.success();}}},Bq);},editExpr:function(Bm){var Bn=this.selectedClns[Bm-1];this.exprEditor(Bn,3,null,Bm);},getColDataType:function Af(Bm){return parseInt(Bm.dt.tp,10);},addJoinColInfo:function A9(Bn,Bm){G(this.joinCols,Bn,Bm);},autoJoin:function BR(){var B1=this.dbtables.length,Bz,B2,B0,Bt=this.tables,Bw,Br,Bu,B3,Bo,Bx,Bn,Bs,Bp,Bm={},By,Bv,Bq;Bz=this.dbtables[B1-1];B0=Bt[Bz];B3=B0.rows;for(B2 in Bt){if(B2===Bz){continue;}Bw=Bt[B2].rows;Bq=Bz+B2;for(Bo in B3){Bs=B3[Bo];Bx=Bs.srcData;Bn=this.getColDataType(Bx);if(Bn===AN.columnDataTypes.integer||Bn===AN.columnDataTypes.unsigned||Bn===AN.columnDataTypes.int64||Bn==="INTEGER"){for(Br in Bw){Bp=Bw[Br];Bu=Bp.srcData;if(Bx.cln===Bu.cln&&Bn===this.getColDataType(Bu)&&!BD(this.joinCols,Bo,Br)){Bv=this.brackets(Bs.oriexpr)+"="+this.brackets(Bp.oriexpr);if(Bm[Bq]){Bm[Bq].jexp=Bm[Bq].jexp+" AND "+Bv;}else{Bm[Bq]={jexp:Bv,links:[]};}By={srcw:Bs,tgtw:Bp,jtype:0,jexp:Bv};Bm[Bq].links.push(By);G(this.joinCols,Bs.id,Bp.id);break;}}}}}if(!V.isEmpty(Bm)){this.addJoins(Bm);}},addJoin:function U(Bo,Bm,Bn,Bt,Bq){var Bp,Br,Bs={};Bp=Bo.srcID+Bm.srcID;Br={srcw:Bo,tgtw:Bm,jtype:Bn,jexp:this.brackets(Bo.oriexpr)+"="+this.brackets(Bm.oriexpr)};Bs[Bp]={links:[Br],jexp:Br.jexp};G(this.joinCols,Bo.id,Bm.id);this.addJoins(Bs,Bq);},addJoins:function o(Br,Bu){var Bq=this,Bs,Bo,Bw,Bp,Bv,Bn,Bt,Bm={success:function(Bx){Bq.isDirty=true;mstrApp.msgid=Bx.msgid;for(Bp in Br){Bv=Br[Bp].jexp;Bw=Br[Bp].links;Bq.joinsInfo[Bp]={jt:0,exp:Bv,links:{},nlinks:Bw.length};for(i=0;i<Bw.length;i++){Bo=Bw[i];Bn=Bo.srcw;Bt=Bo.tgtw;Bq.joinsInfo[Bp].links[Bn.id+Bt.id]={srcw:Bn,tgtw:Bt,coords:[],exp:Bo.jexp,jid:Bp};Bq.tables[Bn.srcID].njoins++;Bq.tables[Bt.srcID].njoins++;}Bq.joinsInfo[Bp].srctID=Bn.srcID;Bq.joinsInfo[Bp].tgttID=Bt.srcID;Bq.joins.push(Bp);}if(Bu&&Bu.success){Bu.success();}Bq.raiseEvent({name:"JoinsAdded"});}};Bs=JSON.stringify(Bi(Br,Bq));mstrApp.getRootController().getDataService().addJoin(Bm,{joins:Bs,tbid:Bq.tableID||""});},removeJoin:function(Bo,Bq){var Br=this;var Bp=Br.joinsInfo[Bo],Bs=Bp.srctID,Bn=Bp.tgttID;var Bm={success:function(Bt){Br.isDirty=true;mstrApp.msgid=Bt.msgid;Z.removeItem(Br.joins,Bo);delete Br.joinsInfo[Bo];Br.tables[Bs].njoins--;Br.tables[Bn].njoins--;if(Bq&&Bq.success){Bq.success();}}};mstrApp.getRootController().getDataService().removeJoin(Bm,{jindex:Br.getjIndex(Bo),tbid:Br.tableID||""});},editJoin:function t(Br){var Bt=this,Bp=Br.linkID,Bm=Br.joinID,Bu=Br.exp||"",Bn=Br.op,Bx=Br.type,By=Bt.joinsInfo[Bm].links,Bv=Bt.getjIndex(Bm),Bo="",Bq={jindex:Bv,jtype:Bx,tbid:Bt.tableID||""},Bs={success:function Bw(Bz){mstrApp.msgid=Bz.msgid;Bt.isDirty=true;Bt.joinsInfo[Bm].jt=Bx;if(Bu){By[Bp].op=Bn;By[Bp].exp=Bu;Bt.joinsInfo[Bm].exp=Bo;}Bt.raiseEvent({name:"joinChanged"});}};if(Bu){V.forEach(By,function(B0,Bz){Bo+=(Bo?" AND ":"")+((Bz!==Bp)?B0.exp:Bu);});Bq.exp=Bo;}mstrApp.getRootController().getDataService().editJoin(Bs,Bq);},renameTable:function BX(Bp,Bm,Bo){var Bn=this;mstrApp.getRootController().getDataService().editTable({success:function(Bq){mstrApp.msgid=Bq.msgid;delete Bn.tbns[Bm];Bn.tbns[Bo]=Bo;Bn.tables[Bp].tbn=Bo;V.forEach(Bn.conditions,function(Br){A5(Bm,Bo,Br);});Bn.raiseEvent({name:"TableNameChanged",value:Bo,tid:Bp});}},{tbid:Bn.tableID||"",tables:JSON.stringify([{alias:Bo,tindex:Bn.gettIndex(Bp)}])});},saveTableLayout:function BK(Bo){var Bn=[];for(var Bp in this.tables){var Bm=mstrmojo.all[Bp];if(Bm&&Bm.editorNode){Bn.push({tindex:this.gettIndex(Bp),t:parseInt(Bm.top,10)*BT,l:parseInt(Bm.left,10)*BT,w:Bm.editorNode.clientWidth*BT,h:Bm.editorNode.clientHeight*BT});}}mstrApp.getRootController().getDataService().editTable({success:function Bq(Br){mstrApp.msgid=Br.msgid;if(Bo&&Bo.success){Bo.success();}}},{tbid:this.tableID||"",tables:JSON.stringify(Bn)});},loadReport:function Az(Bs,Bu,Bt,Bq,Br,Bm){var Bn=this;Bu=Bu||BO;var Bp={browsetype:Bs,bindingflag:Bu,suppressError:true,showWait:!Bm};if(Bt!=null){Bp.previewflag=Bt;}if(Bq!=null){Bp.automap=Bq;Bp.docid=mstrApp.docID||"";}Bp.tableID=Bn.tableID||"";var Bo={success:function(Bv){if(Bs&AD){if(Bv.btb){Bn.bindingT=Bv.btb.slice(0);}}if(Br&&Br.success){Br.success(Bv);}}};mstrApp.getRootController().getDataService().getReportDefinition(Bo,Bp);},loadConnectLiveSupport:function q(){var Bn=this,Bm,Bp={browsetype:BC,bindingflag:0,previewflag:0,tableID:Bn.tableID||"",showWait:false};Bn.connectLiveSupport=undefined;Bm={success:function(Bq){if(Bq.prs&&Bq.prs.dda!==undefined){Bn.connectLiveSupport=Bq.prs.dda;}}};var Bo=mstrApp.getRootController().getDataService();typeof (Bo.getReportDefinition)==="function"&&Bo.getReportDefinition(Bm,Bp);},getcIndex:function Ax(Bm){return mstrmojo.array.indexOf(this.selectedClns,Bm)+1;},getRowWidget:function l(Bm,Bq){var Br=this.tables;Bq=Bq.toLowerCase();if(!Bm){for(var Bn in Br){var Bp=Br[Bn].rows;for(var Bo in Bp){if(Bp[Bo].text.toLowerCase()===Bq){return mstrmojo.all[Bo];}}}}else{Bm=Bm.toLowerCase();for(var Bn in Br){if(Br[Bn].tbn.toLowerCase()===Bm){var Bp=Br[Bn].rows;for(var Bo in Bp){if(Bp[Bo].text.toLowerCase()===Bq){return mstrmojo.all[Bo];}}}}}},uptcIndex:function Aj(Bn,Bm){while(Bm>this.selectedClns.length){this.selectedClns.push("");}this.selectedClns[Bm]=Bn;},getjIndex:function AZ(Bm){return mstrmojo.array.indexOf(this.joins,Bm)+1;},gettIndex:function O(Bm){return mstrmojo.array.indexOf(this.dbtables,Bm)+1;},upttIndex:function Bk(Bo,Bm,Bn,Bu,Bt,Br){var Bs=this.dbtables,Bq=this.tables,Bp=function Bp(By,Bw,Bv,Bx){return{rows:{},njoins:0,tbn:By,ns:Bw,alias:"",dbtbn:Bv,did:Bx};};if(Bu){Bq[Bn]=Bp(Bo,Br,Bm,Bt);Bs.push(Bn);}else{delete Bq[Bn];mstrmojo.array.removeItem(Bs,Bn);}},save:function(Bn,Bw,Bp,Bx,Bu,Bv,By){var Bs=this;var Bm={success:function(B1){var B0=B1.did;Bs.riid=B0;mstrApp.path=B1.path;mstrApp.reportID=B0;mstrApp.folderID=Bp;var Bz={success:function(B2){if(By&&By.success){By.success({did:B0,path:mstrApp.path});}},failure:function(B7){var B6=Bs.dbtables,B4,B3=Bs.pos_hash;for(var B5=0,B2=B6.length;B5<B2;B5++){B4=mstrmojo.all[B6[B5]];if(B4&&B4.editorNode){B3[B4.title]={t:parseInt(B4.top,10),l:parseInt(B4.left,10),w:B4.editorNode.clientWidth,h:B4.editorNode.clientHeight};}if(B4){B4.set("visible",false);B4.set("opener",null);}delete mstrmojo.all[B6[B5]];}var B9=mstrmojo.all.CE,B8;if(B9&&(B8=B9.CEl)){B8.filterExpr.set("items",[]);B8.aggfilterExpr.set("items",[]);}Bs.createReportInstance();}};mstrApp.getRootController().getDataService().publishCube(Bz,{reportid:B0});}};var Bo={success:function(){params={reportid:Bs.riid,folderID:Bp,isCube:Bs.isCubeReport,crb:Bs.refresh_opt,overwrite:!!Bx,autoName:!!Bu};if(Bn){params.name=Bn;}if(Bw){params.desc=Bw;}mstrApp.getRootController().getDataService().saveReport(Bm,params);}};var Bq={success:function(){Bs.updateDerivedFlags(Bo);}};var Br={success:function(){if(Bs.skipMissingCheck){Bq.success();return ;}var B2=[],B1=Bs.getMissingMaps(B2);if(B1){var B0=B2.length>0,Bz=mstrmojo.insert({scriptClass:"mstrmojo.qb.MissingColumnWarning",hasPT:B0,mappings:B0?B2:B1,isCube:Bs.isCubeReport,onOK:function(){Bq.success();return true;}});Bz.open();}else{Bq.success();}}};var Bt={success:function(){if(Bs.isDirty){Bs.autoMap(Br);}else{Br.success();}}};if(!Bs.FFSQLMode){Bs.saveTableLayout(Bt);}else{Bs.editFFSQL(Bt,Bv);}},populatePreview:function BJ(Bn,Bm){this.populateMappings(Bn);this.populateDataset(Bm);},populateMappings:function j(Bt){var Bu=Bt.amps,B1=Bt.mtmps,Bs=!mstrApp.isCloudPro&&(mstrApp.saveAsCube==2)&&(!this.isNew),B4=[];var B5=this.mappings.slice(0);this.mappings=[];this.cloneMappings=[];var Bw,Bv,Bp,Bm,B6,Bx=0,Bq,Bn,B3,B0,Br=function(B7){var B8=0;Z.forEach(B7,function(B9){if(!(B9.sqc.der&2147483648)){B8++;}});return B8;};for(var By=0,Bz=Bu.length;By<Bz;By++){Bv=Bu[By];Bp=Bv.aimp;Bn=Bp.ipa;Bm=Bv.afmps;Bx+=Bm.length;B0=Br(Bm);for(Bw=0,aflen=Bm.length;Bw<aflen;Bw++){B6=Bm[Bw].sqc;Bq=mstrmojo.array.find(B5,"did",B6.id);B3=(B6.der&2147483648)?true:false;B4.push({did:B6.id,alias:AI(Bp.atnm),n:AI(Bv.afmps[Bw].cln),selected:(B6.se==1),hasMapped:true,isReadOnly:Bs,isDI:this.isDI,isQB:!(this.FFSQLMode),dtp:Bm[Bw].bft,colo:Bm[Bw].colo-1,ix:B6.ix,tp:12,ipa:Bn,georole:(Bq>=0)?B5[Bq].georole:B6.geo,der:(Bq>=0)?B5[Bq].der:B6.der,oid:Bp.atid,fmid:Bm[Bw].fmid,afid:Bp.atid+Bm[Bw].fmid,fmn:AI(Bm[Bw].fmn),shapeKey:AI((Bq>=0)?B5[Bq].shapeKey:Bm[Bw].sha),toDel:(B6.ups&4)?true:false,isDerived:B3,multiForms:B0>1,isIDForm:Bw===0});}}for(var By=0,Bz=B1.length;By<Bz;By++){var Bo=B1[By],B6=Bo.sqc;B4.push({did:B6.id,alias:AI(Bo.mtn),n:AI(Bo.cln),selected:(B6.se==1),isReadOnly:Bs,hasMapped:true,isDI:this.isDI,isQB:!(this.FFSQLMode),dtp:Al[B6.dt.tp],colo:Bo.colo-1,ix:B6.ix,tp:4,oid:Bo.mtid,georole:B6.geo,der:B6.der,toDel:(B6.ups&4)?true:false});}Z.forEach(Bt.cmps,function(B7){B6=B7.sqc;B4.push({did:B6.id,alias:AI(B6.exp.exp),n:AI(B6.exp.exp),selected:false,hasMapped:false,isQB:!this.FFSQLMode,expr:B6.exp.exp,dtp:Al[B6.dt.tp],colo:B7.colo-1,ix:B6.ix,tp:0});});var B2;B4.sort(function(B8,B7){return(B8.ix<B7.ix)?-1:1;});for(var By=0,Bz=B4.length;By<Bz;By++){B2=B4[By];if(B2.toDel){this.selectedClns&&this.selectedClns[By]&&(this.selectedClns[By].missing=true);}else{if(B2.isDerived){this.selectedClns&&this.selectedClns[By]&&(this.selectedClns[By].isDerived=true);}else{this.mappings.push(B2);this.cloneMappings.push(V.copy(B2));}}}},populateDataset:function BN(Bm){var Bn;if(!(Bm instanceof Array)){Bm=Bm.dcs;if(!Bm||!Bm.length){this.dataset=[];return ;}}Bn=[];Z.forEach(Bm,function(Bo){Z.forEach(Bo.dvs,function(Bq,Bp){Bq=(Bq===null)?"":BU.encodeData(Bq);Bn[Bp]=Bn[Bp]||[];Bn[Bp].push(Bq);});});this.dataset=Bn;},populateFFSQLMapping:function a(Bu){var Bv=Bu.amps,B2=Bu.mtmps;var Bn={};var B7=this.mappings.slice(0);this.mappings=[];this.cloneMappings=[];var Bx,Bw,Bq,B5,By=0,B3,Bm,B4,Bo,B6,B1,Bs=function Bs(B8){var B9=0;Z.forEach(B8,function(CA){if(!(CA.col.oi.def.dicl.der&2147483648)){B9++;}});return B9;};for(var Bz=0,B0=Bv.length;Bz<B0;Bz++){Bw=Bv[Bz];Bq=Bw.aimp;Bo=Bq.ipa;Bm=Bw.afmps;B1=Bs(Bm);for(Bx=0,B3=Bm.length;Bx<B3;Bx++){B5=Bm[Bx].col.oi;pos=mstrmojo.array.find(B7,"did",B5.did);if(B5.def.dicl.ups&4){break;}B6=(B5.def.dicl.der&2147483648)?true:false;By++;B4={did:B5.did,alias:AI(Bq.atnm),n:BU.encodeData(B5.def.cln),selected:true,hasMapped:true,dtp:Bm[Bx].bft,georole:(pos>=0)?B7[pos].georole:B5.def.dicl.geo,shapeKey:AI((pos>=0)?B7[pos].shapeKey:Bm[Bx].sha),oid:Bq.atid,fmid:Bm[Bx].fmid,afid:Bq.atid+Bm[Bx].fmid,fmn:AI(Bm[Bx].fmn),ipa:Bo,colo:Bm[Bx].colo-1,ix:B5.def.dicl.clix-1,tp:12,der:(pos>=0)?B7[pos].der:B5.def.dicl.der,isDerived:B6,multiForms:B1>1,isIDform:Bx===0};Bn[B4.ix]=B4;}}var Bt=Bv.length;for(var Bz=0,B0=B2.length;Bz<B0;Bz++){var Bp=B2[Bz],B5=Bp.col.oi;if(B5.def.dicl.ups&4){continue;}By++;var B4={did:B5.did,alias:AI(Bp.mtn),n:AI(B5.def.cln),selected:true,hasMapped:true,dtp:Al[B5.def.dt.tp],colo:Bp.colo-1,ix:B5.def.dicl.clix-1,oid:Bp.mtid,tp:4,georole:B5.def.dicl.geo,der:B5.def.dicl.der};Bn[B4.ix]=B4;}var B4;var Br=[];V.forEach(Bn,function(B9,B8){Br.push(parseInt(B8,10));});Br.sort(function(B9,B8){return B9-B8;});for(var Bz=0;Bz<Br.length;Bz++){B4=Bn[Br[Bz]];if(B4&&!B4.isDerived){this.mappings.push(B4);this.cloneMappings.push(V.copy(B4));}}},populateFFSQLSrcTblClnInfo:function(){var Bn=this.bindingT||[],Bp,Bq,Bo,Bm=[];Z.forEach(Bn,function(Br){if(V.walk("oi.tp",Br)===Ad.DbTable){Bq=Br.oi;return false;}});Bo=V.walk("def.cs.cs",Bq);Z.forEach(Bo,function(Br){Z.forEach(Bn,function(Bs){if(V.walk("oi.did",Bs)===Br.did&&V.walk("oi.tp",Bs)===Br.tp){Bm.push(V.walk("oi.def",Bs));}});});Bm=Z.filter(Bm,function(Br){return typeof Br!=="undefined";});this.set("sourceTableColumns",Bm);return Bm;},updateDerivedFlags:function(Bp){var Bs=this.mappings;var Bn=[],Bq;for(var Bo=0,Bm=Bs.length;Bo<Bm;Bo++){if(Bs[Bo].hasMapped){Bn.push({did:Bs[Bo].did,georole:Bs[Bo].georole,shapekey:Bs[Bo].shapeKey,drvflgs:Bs[Bo].der});}}if(Bn.length===0){Bp&&Bp.success&&Bp.success();}else{mstrApp.getRootController().getDataService().remapObject({success:function Br(Bt){if(Bp&&Bp.success){Bp.success(Bt);}}},{mpcs:JSON.stringify(Bn),docid:mstrApp.docID||"",utm:1});}},getMissingMaps:function(B8){if(!this.orimaps){return null;}var Bx=[],B3,B2,B4,B5;var B6=this.orimaps;var Bp=this.mappings;var Bv=B6.amps,Bw=B6.mtmps;B6={};var Br,B1,Bn,By,B7,Bt,Bz,Bu=mstrApp.isFFSQL;for(B3=0,B4=Bv.length;B3<B4;B3++){B5=Bv[B3].aimp;Br=B5.atid;B1=AI(B5.atnm);B5=Bv[B3].afmps;for(B2=0;B2<B5.length;B2++){if(Bu){By=B5[B2].col.oi.def;if(By.dicl.der&2147483648){break;}Bt=By.cln;Bz=B5[B2].col.oi.did;}else{B7=B5[B2].sqc;if(B7.der&2147483648){break;}Bt=B7.exp.exp;Bz=B7.id;}B6[Br]=B6[Br]||{n:B1,oid:Br,tp:12,fms:[]};B6[Br].fms.push({fmid:B5[B2].fmid,fnm:AI(B5[B2].fmn),exp:AI(Bt),cmid:Bz});}}for(B3=0,B4=Bw.length;B3<B4;B3++){if(Bu){Bt=Bw[B3].col.oi.def.cln;Bz=Bw[B3].col.oi.did;}else{B7=Bw[B3].sqc;Bt=B7.exp.exp;Bz=B7.id;}B6[Bw[B3].mtid]={oid:Bw[B3].mtid,n:AI(Bw[B3].mtn),tp:4,exp:AI(Bt),cmid:Bz};}var B0=mstrmojo.hash.copy((this.pattrs||{}));var B4=Bp.length,Bm,Bo,Bq,Bs;for(B3=0;B3<B4;B3++){Bm=Bp[B3].oid;Bo=B6[Bm];if(Bo&&Bo.tp==Bp[B3].tp){Bq=Bo.fms;if(Bq){Bs=Z.find(Bq,"fmid",Bp[B3].fmid);if(Bs>-1){Z.removeIndices(Bq,Bs,1);}}else{delete B6[Bm];}}if(B0[Bm]&&B0[Bm].tp==Bp[B3].tp){delete B0[Bm];}}if(B8){for(Bm in B0){B5=B0[Bm];B8.push(B5);}}for(Bm in B6){B5=B6[Bm];if(B5.tp===12){if(B5.fms.length){Bx.push(B5);}}else{Bx.push(B5);}}return((Bx.length>0)?Bx:null);},getMissingColumnID:function(Bq){var Bn=this,Bm=Bn.getMissingMaps();if(!Bm){return null;}var Bp=null,Br,Bo=Bn.mappings;Z.forEach(Bm,function(Bs){Br=(Bs.tp===4)?[Bs]:Bs.fms;Z.forEach(Br,function(Bt){if(Z.find(Bo,"did",Bt.cmid)===-1&&Bn.isEquivalentExpr(Bt.exp,Bq)){Bp=Bt.cmid;return false;}});if(Bp){return false;}});if(Bp){Z.forEach(Bn.selectedClns,function(Bs){if(Bs.cmid===Bp&&!Bs.missing){Bp=null;return false;}});}return Bp;},getMissingTableID:function(Bm,Bo,Br){var Bt=this.orits;if(!Bt){return null;}var Bs=this.dbtables,Bq=this.tables,Bu;for(var Bn=0,Bp=Bs.length;Bn<Bp;Bn++){Bu=Bq[Bs[Bn]];if(Bu.existing&&Bu.missing&&Bu.tbn===Bo&&Bu.dbtbn===Bm&&Bu.ns===Br){return(!Bu.did?null:Bu.did);}}return null;},getTablesCount:function(){var Bp=this.tables,Bq=this.dbtables,Bo=0;for(var Bn=0,Bm=Bq.length;Bn<Bm;Bn++){!Bp[Bq[Bn]].missing&&(Bo++);}return Bo;},getColumnsCount:function(){var Bn=this.selectedClns,Bp=0;for(var Bo=0,Bm=Bn.length;Bo<Bm;Bo++){!Bn[Bo].missing&&(Bp++);}return Bp;},addColumnIndex:function(Bz,Bq,Bw,Bm,Bo,Bu){var Bt=this.selectedClns,Bx=this.gettIndex(Bz.parent.parent.id),Bp,Bv,By,Bs=Bt.length,Br,Bn;if(!!Bw){Bp=Bw;}else{if(Bq){Bp=AQ[Bq]+"("+(Bz.oriexpr)+")";}else{Bp=this.brackets(Bz.oriexpr);}}if(!Bm){for(Br=0;Br<Bs;Br++){Bn=Bt[Br];if(Bn.missing&&Bn.expr&&this.isEquivalentExpr(Bn.expr[0].v,Bp)){Bn.missing=false;Bn.wid=[Bz.id];Bn.cmid=Bo;By=true;break;}}Bv=Br;}else{Bv=Bs;}if(!By){if(Bq){if(Bq===6){Bt.push({wid:[Bz.id],expr:[{isNew:true,v:"Count",oi:{t:"11",n:"Count"}},{isNew:true,v:"<Distinct=true>",oi:{t:"11",n:"<Distinct=true>"}},{isNew:true,v:"(",isDelimiter:true},{isNew:true,v:this.brackets(Bz.oriexpr),oi:{tIndex:Bx,rIndex:Bz.rIndex,t:"26",n:Bz.oriexpr}},{isNew:true,v:")",isDelimiter:true}]});}else{Bt.push({wid:[Bz.id],expr:[{isNew:true,v:AQ[Bq],oi:{t:"11",n:AQ[Bq]}},{isNew:true,v:"(",isDelimiter:true},{isNew:true,v:this.brackets(Bz.oriexpr),oi:{tIndex:Bx,rIndex:Bz.rIndex,t:"26",n:Bz.oriexpr}},{isNew:true,v:")",isDelimiter:true}]});}}else{Bt.push({wid:[Bz.id],expr:[{isNew:true,v:Bp,oi:{tIndex:Bx,rIndex:Bz.rIndex,t:"26",n:Bz.oriexpr}}]});}}this.addExpression(Bv,Bu);return Bv;},compareDBTables:function(Bo){var Bn=this;if(Bn.dbtables.length===0){return ;}var Bm={success:function(Bs){var Bp=Bs.btb,Bq=[],Bu,Bt;Z.forEach(Bp,function(Bv){Bu=Bv.oi;Bt=Bu.def;(Bu.tp===53&&Bt.xt===1)&&Bq.push({tbid:Bu.did,tbn:AI(Bt.tbn),ns:AI(Bt.ns)});});if(Bq.length==0){return ;}Bn.whts=Bq;mstrApp.getRootController().getDataService().catalogAction({success:function Br(Bv){var Bw=Bv.xrc.cas[0];Bn.whdef=Bw.tis?Bw.tis:[Bw];Bo&&Bo.success&&Bo.success();}},{dbrid:Bn.SelDBRoleID,flags:1073741824|2|524288,mid:mstrApp.msgid,dbts:JSON.stringify(Bq),showWait:true});}};Bn.loadReport(AD+Bd,BO,c,null,Bm);},updateDBTables:function(Bw){var Bo=this,By,Bs,Bn=[],Bp,Bm,Bu,Bt,Br,Bv,Bx;for(Bt=0,Bv=Bo.whdef.length;Bt<Bv;Bt++){By=Bo.whdef[Bt];if(By.sta!=0){Bp={ns:By.ns,sta:By.sta,tbid:By.tbid,tbn:AI(By.tbn),clis:[]};Bu=Bp.clis;Bm=By.clis;for(Br=0;Br<Bm.length;Br++){Bx=Bm[Br];Bu.push({cln:AI(Bx.cln),cmid:Bx.cmid,sta:Bx.sta,prec:Bx.dt.prec,scl:Bx.dt.scl,tp:Bx.dt.tp});}Bn.push(Bp);}}if(Bn.length==0){return ;}var Bq={success:function(B0){mstrApp.msgid=B0.msgid;var Bz={success:function(B4){var B9=Bo.dbtables,B8,B3=Bo.pos_hash,B7,CA=[];for(var B1=0,B2=B9.length;B1<B2;B1++){B8=mstrmojo.all[B9[B1]];if(B8&&B8.editorNode){B3[B8.title]={t:parseInt(B8.top,10),l:parseInt(B8.left,10),w:B8.editorNode.clientWidth,h:B8.editorNode.clientHeight};}B8.set("visible",false);B8.set("opener",null);delete mstrmojo.all[B9[B1]];}var B6=mstrmojo.all.CE,B5;if(B6&&(B5=B6.CEl)){B5.filterExpr.set("items",[]);B5.aggfilterExpr.set("items",[]);}Bo.isDirty=true;if(Bo.loadDefinition){B7=Bo.firstTimeLoading;Bo.loadDefinition(B4);if(!B7){h(Bo);}}else{At(B4,Bo);}if(Bn.length>0){Z.forEach(Bn,function(CB){if(CB.sta=="4"){CA.push("<li>"+P.htmlAngles(CB.tbn)+"</li>");}});if(CA.length>0){CA.unshift('<ul style="padding-left: 16px; max-height: 80px; overflow: auto;">');CA.push("</ul>");mstrmojo.error({shortDesc:"<strong>"+mstrmojo.desc(16115,"The following tables are not found from the database. They have been removed from the canvas. Please add new tables as you need.")+"</strong>"+CA.join("")},mstrmojo.emptyFn,{title:mstrmojo.desc(12537,"Data Import")});}}}};Bo.loadReport(AD+Bd,BO,c,null,Bz);}};mstrApp.getRootController().getDataService().updateTableStructure(Bq,{tables:JSON.stringify(Bn),tbid:Bo.tableID||""});},isColumnUsed:function(Bu,Bs){var Bo=Bu.tbn,Bn=Bs.cln,Bp,Bq,Bv;var Br=this.tables;for(var Bm in Br){if(Br[Bm].dbtbn===Bo){Bv=Br[Bm].rows;for(var Bt in Bv){if((Bv[Bt].text===Bn)&&(Bv[Bt].state!=0)){return true;}}}}return false;},hasMissingUsedDBColumns:function(){var Bp=this.whdef,Bt,Bs,Br,Bm,Bo,Bn,Bq;for(Bs=0,Bm=Bp.length;Bs<Bm;Bs++){Bt=Bp[Bs];switch(parseInt(Bt.sta,10)){case 0:case 64:break;default:Bq=Bt.clis;for(Br=0,Bo=Bq.length;Br<Bo;Br++){Bn=Bq[Br];if(parseInt(Bn.sta,10)===4){if(this.isColumnUsed(Bt,Bn)){return true;}}}break;}if(Bt.sta==4){Bq=Bt.clis;for(Br=0,Bo=Bq.length;Br<Bo;Br++){Bn=Bq[Br];if(this.isColumnUsed(Bt,Bn)){return true;}}}}return false;},getShapeKeys:function(){var Bn=this;var Bm={success:function(Br){if(Br&&Br.ShapeFileMaps&&Br.ShapeFileMaps.ShapeFileMap){var Bs=Br.ShapeFileMaps.ShapeFileMap,Bp=[],Bt,Bq,Bo=function Bo(Bw,Bv){var Bu=Bw.n.toLowerCase();var Bx=Bv.n.toLowerCase();if(Bu<Bx){return -1;}else{if(Bu>Bx){return 1;}else{return 0;}}};Z.forEach(Bs,function(Bu){Bt=Bu.descWeb;Bq=Bt?mstrmojo.desc(Bt.slice(8)):AI(Bu.name);Bp.push({did:Bu.shapeKey,n:Bq});});Bp.sort(Bo);Bn.shapeKeys=Bp;}}};mstrApp.getRootController().getDataService().getShapeKeys(Bm,{});},createEmmaTable:function A8(){var Bq=mstrApp.getRootController().getDataService(),Bo=this,Bn=mstrApp.isFFSQL,Bm=(Bn?304:352),Br=function Br(Bs){Bq.createEmmaTable({success:function Bt(Bu){Bo.tableID=Bu.tbid;mstrApp.msgid=Bu.msgid;}},{xt:Bs});};mstrApp.msgid=mstrApp.msgID;if(mstrApp.msgid){Br(Bm);}else{Bq.createEmmaInstance({success:function Bp(Bs){mstrApp.msgid=Bs.msgid;Br(Bm);}});}if(mstrApp.isFFSQL){Bo.set("isFFSQL",true);Bo.set("FFSQLMode",true);mstrApp.isFFSQLMode=true;}},createReportInstance:function BY(){var Bp=this,Bo=mstrApp.isCloudPro;Bp.msgid=mstrApp.msgid;Bp.riid=mstrApp.reportID||A7;Bp.supportTimeGeo=true;Bp.analysisID=mstrApp.analysisID;Bp.isNew=(Bp.riid==A7);Bp.alertTitle=Bo?"Oops!":null;if(mstrApp.isEMMACube){this.createEmmaTable();return ;}var Bn={success:function Bm(Bq){Bp.msgid=Bq.msgid;mstrApp.msgid=Bq.msgid;if(Bp.riid!==A7){Bp.firstTimeLoading=true;var Br={success:function Bs(Bu){var Bt;if(Bu&&(Bt=Bu.items)&&Bt.length){Bp.pattrs={};Z.forEach(Bt,function(Bv){Bv.ismapped&&(Bp.pattrs[Bv.did]={n:Bv.n,tp:12});});}Bp.loadReport(AD+Bd,BO,c,null,{success:function(Bv){At(Bv,Bp);if(Bo){mstrApp.getRootController().getDataService().autoClosePrompt({success:function Bw(Bx){mstrApp.msgid=Bx.msgid;}});}}});}};if(Bo&&mstrApp.analysisID&&mstrApp.saveAsCube!=2){mstrApp.getRootController().getDataService().getDocumentAttributes(Br,{objectID:mstrApp.analysisID});}else{Br.success();}}else{Bp.skipMissingCheck=true;if(mstrApp.isFFSQL){Bp.set("isFFSQL",true);Bp.set("FFSQLMode",true);mstrApp.isFFSQLMode=true;Bp.convertToFFSQL("",null,true);}}Bp.set("isCloud",Bo);Bp.set("isCubeReport",mstrApp.saveAsCube!=2);}};mstrApp.getRootController().getDataService().createReportInstance(Bn,{reportid:Bp.riid});if(!mstrApp.isCloudPro){Bp.getShapeKeys();}Bp.getFunctions();},getAllowSave:function w(Bo){var Bn,Bm=mstrApp.isFFSQLMode;if(Bm&&Bo===undefined){Bo=mstrApp.getRootController().rootView.getSQLStatement();}if(this.isNew){Bn=Bm?(!!P.trim(Bo)):(this.dbtables.length>0&&this.selectedClns.length>0);Bn=Bn&&(!!this.SelDBRoleID);}else{Bn=Bm?(!!P.trim(Bo)):true;}Bn=Bn&&this.getAvailableTablesEnabled();return Bn;},getAutoReportName:function Ay(){var Bm=this.tbns,Bn=[];V.forEach(Bm,function(Bp,Bo){Bn.push(Bo);});Bn=Bn.join("_");if(Bn==""){Bn="FFSQL";}return Bn.substring(0,252);},getFunctions:function As(Bp,Bo,Bn){var Bm=this;if(!this.functions){mstrApp.getRootController().getDataService().getSystemFunctions({success:function(Bq){Bm.functions=D(Bq.fncs,Bp);if(Bo&&Bo.success){Bo.success();}}},V.copy(Bn,{includeFunctionDetails:false,functionFlags:2}));}},getFunctionList:function Ba(){return this.functions;},getSuggestionItems:function AF(Bo){var Bm=[],Bp;if(Bo){var Bn=this.dbtbls[this.SelDBRoleID];V.forEach(Bn,function(Bq,Br){Bm.push({n:Br,sta:2,t:15});});}else{V.forEach(this.tables,function(Bq){V.forEach(Bq.rows,function(Br){Bp=Br.oriexpr;Bm.push({n:Bp,cmid:Br.srcData.id,rIndex:Br.rIndex+1,t:26,display:['<span class="mstrmojo-qb-ListIconBlock t26 "></span><span>',Bp,"</span>"].join("")});});});}Z.forEach(this.functions,function(Bq){Z.forEach(Bq.fns,function(Br){Bm.push(Br);});});if(Bo){this.FFsqlComp=Bm;}return Bm;},getConditions:function AM(){return this.conditions;},setCondition:function AC(Bn,Bq,Bo){var Bm=this;mstrApp.getRootController().getDataService().editCondition({success:function Bp(Br){mstrApp.msgid=Br.msgid;Bm.isDirty=true;if(Bo&&Bo.success){Bo.success(Br);}}},{tbid:Bm.tableID||"",clause:Bn?"where":"having",exp:Bq});},updateConditions:function e(Bq,Bs){var Bn=this,Br=this.conditions,Bp={success:function Bo(Bu){Br.having=Bs;Bn.updateFilterLabel(Br);}},Bm=function Bm(Bu){Br.where=Bq;if(Bs){Bn.setCondition(false,An(Bs),Bp);}else{if(Br.having){Bn.setCondition(false,"",Bp);}else{Bp.success();}}},Bt={success:Bm};if(Bq){this.setCondition(true,An(Bq),Bt);}else{if(Br.where){this.setCondition(true,"",Bt);}else{Bm();}}},appendCondition:function A1(Bn){var Bo=this.conditions,Bm=Bn.sqltp===0;condition=Bm?Bo.where:Bo.having;if(!condition){condition=Bn;}else{if(condition.nds){condition.nds.push(Bn);}else{condition={et:BF.ANDOR,fn:X.FN.AND,nds:[V.copy(condition),Bn]};}}Bo[Bm?"where":"having"]=condition;this.setCondition(Bm,An(condition),null);this.updateFilterLabel(Bo);},canAddTableSQL:function N(Bq,Bp){var Bo=this,Bn=Bo.SelDBRoleID,Bm;dbridForDDA=this.dbridForDDA;if(Bo.isDDA&&dbridForDDA&&Bn!==dbridForDDA){Bm={name:"directDataAccessTableError"};}if(Bm){if(!Bq){this.raiseEvent(Bm);}return false;}return true;},addTableSQL:function A0(Bn,Bm){k.call(this,Bn.ns,Bn.n,Bm);this.prevDBRoleID=this.SelDBRoleID;},updateFilterLabel:function AW(Bs){var Bp={},Br=this,Bt=Br.tables,Bo,Bu,Bq,Bn,Bm;V.forEach(Bs,function(Bv){I.call(Br,Bp,Bv);});V.forEach(Bt,function(Bv){Bu=Bv.rows;Bo=Bv.tbn.toLowerCase();Bn=Bp[Bo];V.forEach(Bu,function(Bw){Bm=Bw.state;Bm=(Bn&&Bn[Bw.text.toLowerCase()])?(Bm|2):(Bm&(~2));if(Bw.state!==Bm){Bw.state=Bm;Bw.images[1]=Bw.img[Bm];Bw.render();}});});},submitRequest:function Ae(Bo,Bn,Bm){AP(Bo,Bn,Bm);},onisDDAChange:function AY(Bm){var Bn=this;mstrApp.getRootController().getDDAController().checkDDACheckbox(Bm.value);Bn.raiseEvent({name:A6.DBTABLES_ENABLED,value:Bn.getAvailableTablesEnabled()});mstrApp.getRootController().enableButton();}});})();(function(){mstrmojo.requiresCls("mstrmojo.qb._hasQBModel");mstrmojo.qb.QBuilderModel=mstrmojo.declare(mstrmojo.warehouse.WHModel,[mstrmojo.qb._hasQBModel],{scriptClass:"mstrmojo.qb.QBuilderModel"});})();(function(){mstrmojo.requiresCls("mstrmojo.hash","mstrmojo.array","mstrmojo.qb._hasQBModel","mstrmojo.warehouse.WHModel","mstrmojo.DI.DIConstants","mstrmojo.DI.DIHelpers","mstrmojo.warehouse.EnumObjectTypes","mstrmojo.XMLParser","mstrmojo.warehouse.EnumDataChangeEvents");mstrmojo.requiresDescs(14098,9945,9946);var K=mstrmojo.warehouse.EnumDataChangeEvents,f=mstrmojo.string.decodeHtmlString,P=mstrmojo.hash,g=mstrmojo.array,Y=mstrmojo.DI.DIConstants,D=mstrmojo.warehouse.EnumObjectTypes,J=4000,U=15,R=200,L=200,n=0,e=0,l=mstrmojo.desc(14098,"There is no project ## in ###.");var H=mstrmojo.desc;function b(o){return o.replace(/&gt;/g,">").replace(/&lt;/g,"<").replace(/&quot;/g,'"').replace(/&amp;apos;/g,'"').replace(/&apos;/g,"'").replace(/^\n+|\n+$/g,"").replace(/\t/g," ").replace(/&amp;/g,"&");}function V(o){return f(o).replace(/&apos;/g,"'");}function W(o){o.raiseEvent({name:"dataPreview",mappings:o.FFSQLMode?o.sourceTableColumns:o.mappings,dataset:o.dataset,selectedColumns:o.selectedClns,isRefined:o.isRefined});}function m(q){var x=q.datap,r=x.maps,p=x.srce,z=p.csl,u=mstrApp.getRootController(),t=this,o=p.gbqp,w;if(this.firstTimeLoading){this.orimaps=r;}t.usingCookieNamespace=true;if(p.xt===304){t.prevDBRoleID=p.dbrid;w=u.selectDBRole(p.dbrid);}else{if(t.getProject(o)===null){mstrmojo.alert(l.replace("##",o).replace("###",mstrApp.userEmail));}}if(!t.isBigQuery&&!w){t.fetchAndAppendSingleDBR(p.dbrid);}z=b(z);this.SQLstmt=z;mstrApp.getRootController().raiseEvent({name:"reportModeChange",mode:2,value:z,keepFormat:true});this.populateFFSQLMapping(r);if(this.firstTimeLoading){W(this);this.firstTimeLoading=false;}}function X(o,p){var q=o.chn;if(!q){if(o.col&&o.stbid){p.push({cid:o.col,tid:o.stbid});}return p;}g.forEach(q,function(r){p=X(r,p);});return p;}function F(o){return o.replace(/&gt;/g,">").replace(/&lt;/g,"<").replace(/&quot;/g,'"').replace(/&amp;apos;/g,'"').replace(/&apos;/g,"'").replace(/^\n+|\n+$/g,"").replace(/\t/g," ").replace(/&amp;/g,"&");}function d(p){var o={">=":2,"<>":5,"<=":4,"<":3,">":1},q;for(q in o){if(p.indexOf(q)>-1){return o[q];}}return 0;}function E(o,p){var q=[],r;g.forEach(p,function(t){r=o.uiids[t.tid+t.cid];if(r){q.push(r);}});return q;}function I(r,u,o){if(!u.ftype){o.push({lcid:r.chn[0].col,rcid:r.chn[1].col,exp:u.exp});return u.exp;}var t,q,p;switch(u.ftype){case 19:case 20:t=I(r.chn[0],u.children[0],o);q=I(r.chn[1],u.children[1],o);p=t+((u.ftype===19)?" AND ":" OR ")+q;break;case 21:p=" NOT "+I(r.chn[0],u.children[0],o);break;default:break;}return p;}function G(t,q,u,o,AA,x){if(!q.ftype){var p=F(q.exp);if(p.indexOf("? aptqbr_prompt")>-1){x.push({n:p,cid:o.chn[0].cmid});return ;}var AB=E(t,X(o,[])),w,z=[];g.forEach(AB,function(AC){w=mstrmojo.all[AC];if(w&&w.updateState){w.updateState(2);}z.push({t:w.srcTable,col:w.text});});return u.push({et:"*",n:p,expr:[{v:p}],sqltp:AA,cols:z});}switch(q.ftype){case 19:case 20:case 21:var r=[];g.forEach(q.children,function(AD,AC){G(t,AD,r,o.chn[AC],AA,x);});if(!r.length){return ;}if(r.length<q.children.length&&r.length===1){u.push(r[0]);}else{u.push({et:14,fn:q.ftype,nds:r,not:(q.ftype===21),sqltp:AA});}break;default:break;}}function O(As){var AM=As.datap||[],Aj=AM.maps,t=this,AP,AJ,Ar=mstrApp.getRootController();if(t.firstTimeLoading){t.orimaps=Aj;}var AR,AO,At={},q={},Ak,p=true,AZ={53:function AK(Aw){if(Aw.ext_type===352||Aw.ext_type===341){AR=Aw.def.sqs.c_c[0];AO=Aw.def.dbr.did;AP=Aw.ext_type;AJ=Aw.def.sqs.big;}else{At[Aw.did]={cs:Aw.def.cs.cs,tbn:V(Aw.n),did:Aw.did,ns:Aw.def.ns};if(Ak===undefined){Ak=Aw.def.ns;}p=p&&(Ak===Aw.def.ns);if(Aw.ext_type===288){At[Aw.did].alias=V(Aw.n);}}},26:function Am(Aw){q[Aw.did]={did:Aw.did,cln:V(Aw.def.cln),dt:Aw.def.dt};}};g.forEach(As.btb,function(Aw){Aw=Aw.oi;if(AZ[Aw.tp]){AZ[Aw.tp](Aw);}});t.usingCookieNamespace=true;if(AP===341){Ar.selectDBRole(AJ);if(t.getProject(AJ)===null){mstrmojo.alert(l.replace("##",AJ).replace("###",mstrApp.userEmail));}}else{Ar.selectDBRole(AO);}t.prevDBRoleID=AO;if(!AR){return ;}var Aa=AR.sqcs.c_c,AE=AR.whe,Ag=AR.w_cond,Av=AR.he,x=AR.h_cond;t.selectedClns=[];t.dbtables=[];t.joins=[];t.joinsInfo={};t.uiids={};t.tables={};var Ap=t.selectedClns,Af={},AN,Ao,Au,AD,AI;g.forEach(Aa,function(Aw){if(!(Aw.der&2147483648)){AN=X(Aw.exp.roo,[]);Au=V(Aw.exp.exp);Ao=[];g.forEach(AN,function(Ax){AD=Ax.cid;AI=Ax.tid;Af[AI]=Af[AI]||{};Af[AI][AD]=Af[AI][AD]||{};Af[AI][AD].state=1;Af[AI][AD].count=!Af[AI][AD].count?1:Af[AI][AD].count+1;Ao.push(AI+AD);});Ap.push({wid:Ao,expr:[{v:Au}],existing:true,ix:Aw.ix});}});t.tbns={};var AG=t.pos_hash,AB=t.tbns,Aq=[],z,u,Ab,Ai,Al,r,AW;g.forEach(AR.stbs.c_c,function(Ax,Aw){AW={};AI=Ax.id;z=Ax.dbt.did;Al=Ax.als?V(Ax.als):(At[z].alias||At[z].tbn);Ab=At[z].cs;if(AG&&AG[Al]){AW.pos={w:AG[Al].w||L,h:AG[Al].h||R,t:AG[Al].t||n,l:AG[Al].l||e};}else{u=Ax.sqltf;if(u&&u.length){AW.pos={w:(u[0]&&u[0].pdv)/U||L,h:(u[1]&&u[1].pdv)/U||R,t:(u[2]&&u[2].pdv)/U||n,l:(u[3]&&u[3].pdv)/U||e};}}Ai=[];g.forEach(Ab,function(Ay){AD=Ay.did;r=P.copy(q[AD]);if(Af[AI]&&Af[AI][AD]){r.state=1;r.count=Af[AI][AD].count;}Ai.push(r);});AW.did=AI;AW.cs=Ai;AW.tbn=Al;AW.ns=At[z].ns;AW.dbtbn=At[z].tbn;Aq[Aw]=AW;AB[Al]=Al;});if(t.firstTimeLoading&&!t.isNew){t.orits=t.orits||Aq.slice(0);}var AL=t.orits;g.forEach(Aq,function(Aw){if(g.find(AL,"did",Aw.did)>-1){Aw.existing=true;Aw.readOnly=mstrApp.isCloudPro;}});t.raiseEvent({name:"BindingTableLoaded",value:Aq});g.forEach(Ap,function(Aw){Ao=Aw.wid;g.forEach(Ao,function(Ay,Ax){Ao[Ax]=t.uiids[Ay];});});if(Aj){t.populateMappings(Aj);}if(AM.data){t.populateDataset(AM.data);}if(this.firstTimeLoading){W(t);}var AC,Ah,Ae,w,An,AS,AX,AH,AV,Ac,o,AA,AF,AU;g.forEach(AR.sjs.c_c,function(Aw){AC=Aw.ltid;Ae=Aw.rtid;AX=Aw.jt;AH=Aw.ix;AV=Aw.cdn.roo;AF=[];AA=t.uiids[AC]+t.uiids[Ae];t.joins.push(AA);AU={jt:AX+"",exp:V(I(AV,Aw.exp_bo,AF)),srctID:t.uiids[AC],tgttID:t.uiids[Ae],links:{}};Ah=t.tables[t.uiids[AC]];w=t.tables[t.uiids[Ae]];Ah.njoins=(Ah.njoins||0)+1;w.njoins=(w.njoins||0)+1;g.forEach(AF,function(Ax){Ac=Ax.lcid;o=Ax.rcid;Au=V(Ax.exp);An=t.uiids[AC+Ac];AS=t.uiids[Ae+o];AU.links[An+AS]={srcw:mstrmojo.all[An],tgtw:mstrmojo.all[AS],coords:[],exp:Au,jid:AA,op:d(Au)};AU.nlinks=(AU.nlinks||0)+1;t.addJoinColInfo(An,AS);});t.joinsInfo[AA]=AU;});t.raiseEvent({name:"JoinsLoaded"});var AQ=[],AY=[];if(AE.exp!==""){G(t,Ag,AQ,AE.roo,0,AY);if(AQ.length){t.conditions.where=AQ[0];}if(AY.length&&!t.isCubeReport){t.pattrs={};var AT=Aj.amps,Ad;g.forEach(AT,function(Aw){if(g.find(AY,"cid",Aw.afmps[0].sqc.id)>=0){Ad=Aw.aimp;t.pattrs[Ad.atid]={n:Ad.atnm,tp:12};}});}}if(Av.exp!==""){AQ=[];G(t,x,AQ,Av.roo,1);if(AQ.length){t.conditions.having=AQ[0];}}t.firstTimeLoading=false;}function C(p){var o=this;if(!o.FFSQLMode){if(o.getColumnsCount()===0){mstrmojo.alert(mstrmojo.desc(9945,"Please add at least one column and try again."));if(p&&p.failure){p.failure();}return false;}if(o.getTablesCount()===0){mstrmojo.alert(mstrmojo.desc(9946,"Please add at least one table and try again."));if(p&&p.failure){p.failure();}return false;}}return true;}function Z(p){var o=Y.ERDF.ENUM_LOAD_REPORT_PREVIEW_FLAG_DataInfo;if(p.isRefined){o=Y.ERDF.ENUM_LOAD_REPORT_PREVIEW_FLAG_InnerDataInfo;}if(!p.isFFSQL&&p.FFSQLMode){o=Y.ERDF.ENUM_LOAD_REPORT_PREVIEW_FLAG_DataInfo;}return Y.ERDF.ENUM_LOAD_REPORT_PREVIEW_FLAG_MappingInfo+o;}mstrmojo.qb.EmmaModel=mstrmojo.declare(mstrmojo.warehouse.WHModel,[mstrmojo.qb._hasQBModel],{scriptClass:"mstrmojo.qb.EmmaModel",originalMsgID:undefined,dbRolesVersionExcludeFilter:[223],isDataImport:true,init:function k(o){if(this._super){this._super(o);}if(o.dbIds){this.dbRoleEditorCfg.dbIdFilter=o.dbIds;}if(o.dbTypes!==undefined){this.specifyDBTypes=true;this.dbRolesTypeFilter=o.dbTypes;this.dbmsTypeFilter=this.dbRolesTypeFilter;}if(o.dbVersions){this.dbRolesVersionFilter=o.dbVersions;this.dbmsVersionFilter=o.dbVersions;}if(o.dbObjects!==undefined){this.dbObjects=o.dbObjects;}if(o.isHadoopQB){this.dbObjectsDisplayOptions=16;this.specifyDBTypes=true;this.dbRolesTypeFilter=Y.hadoopDbTypes.slice(0);this.dbmsTypeFilter=this.dbRolesTypeFilter.slice(0);this.dbRolesVersionExcludeFilter=Y.ibmDb2Versions.concat(this.dbRolesVersionExcludeFilter?this.dbRolesVersionExcludeFilter:[]);}this.dbRoleEditorCfg.dbIdExcludeFilter=!mstrApp.isFFSQL?[41,15]:[41];this.dbRoleEditorCfg.cfgDbmsTypeExcludeFilter=!mstrApp.isFFSQL?[3000]:[];},dbRoleEditorCfg:{hideShareConnection:true,dbIdExcludeFilter:[41]},createReportInstance:function Q(q,p){var t=this,o=t.isNew=!mstrApp.tableID;t.supportTimeGeo=true;t.analysisID=mstrApp.analysisID;t.tableID=mstrApp.tableID;var w=mstrApp.getRootController().getDataService(),r=mstrApp.isFFSQL,x=function x(AA,z){w.createEmmaTable({success:function AB(AC){t.tableID=AC.tbid;mstrApp.msgid=AC.msgid;}},{xt:AA,dict:z});};mstrApp.msgid=mstrApp.msgID;if(o){if(mstrApp.msgid){t.originalMsgID=mstrApp.msgid;w.removeOrDuplicateRI({success:function(z){mstrApp.msgid=z.msgid;x(q,p);}},{messageID:mstrApp.msgid});}else{w.createEmmaInstance({success:function u(z){mstrApp.msgid=z.msgid;x(q,p);}});}}else{t.originalMsgID=mstrApp.msgid;w.removeOrDuplicateRI({success:function(z){mstrApp.msgid=z.msgid;t.firstTimeLoading=true;var AA=Y.ERDF.ENUM_LOAD_REPORT_BROWSE_TYPE_BINDINGTABLE+Y.ERDF.ENUM_LOAD_REPORT_BROWSE_TYPE_DATAPREVIEW;t.loadReport(AA,Y.ERDF.ENUM_LOAD_REPORT_BINDING_FLAG_ALL,Y.ERDF.ENUM_LOAD_REPORT_PREVIEW_FLAG_MappingInfo+Y.ERDF.ENUM_LOAD_REPORT_PREVIEW_FLAG_SourceInfo,null,{success:function AB(AC){if(r){t.populateFFSQLSrcTblClnInfo();m.call(t,AC);}else{var AE=!t.isBigQuery&&t.findManagedDBR();if(AE){t.fetchAndAppendSingleDBR(AE);}O.call(t,AC);}if(mstrApp.isCloud){mstrApp.getRootController().getDataService().autoClosePrompt({success:function AD(AF){mstrApp.msgid=AF.msgid;}});}}});}},{messageID:mstrApp.msgid});}if(mstrApp.isFFSQL){t.set("isFFSQL",true);t.set("FFSQLMode",true);mstrApp.isFFSQLMode=true;}},loadDefinition:function A(o){O.call(this,o);},remap:function h(p,o){mstrApp.getRootController().getDataService().changeMapping({success:function q(r){if(o&&o.success){o.success(r);}}},{tbid:this.tableID,mpcs:JSON.stringify([p]),docid:mstrApp.docID||""});},loadEmmaReport:function M(q,o,x,t){var p=this,w=!t?Y.ERDF.ENUM_LOAD_REPORT_BROWSE_TYPE_DATAPREVIEW:Y.ERDF.ENUM_LOAD_REPORT_BROWSE_TYPE_BINDINGTABLE+Y.ERDF.ENUM_LOAD_REPORT_BROWSE_TYPE_DATAPREVIEW,r=Z(p);if(!C.call(p,q)){return ;}p.loadReport(w,Y.ERDF.ENUM_LOAD_REPORT_BINDING_FLAG_ALL,r,null,{success:function u(AA){p.isDirty=false;if(!o){var z=AA.datap,AC=z.maps,AB=z.data;if(p.FFSQLMode){p.populateFFSQLMapping(AC);p.populateFFSQLSrcTblClnInfo();p.populateDataset(AB);}else{p.populatePreview(AC,AB);}W(p);}if(q&&q.success){q.success(AA);}}});},autoMap:function c(u,w,o,q){var x=mstrApp.getRootController().getDataService(),r=this,p;if(!C.call(r,u)){return ;}p={tbid:r.tableID,isDB:true,taskId:"DIAutoMappingEMMASourceTable"};if(!r.isNew&&(mstrApp.isFFSQL||!r.FFSQLMode)){p.behaviorFlags=16;}if(!r.isDirty&&r.isNew){r.loadEmmaReport(u,w,o,q);return ;}var t=function(){r.submitRequest({success:function AB(){r.loadEmmaReport(u,w,o,q);},failure:function AA(AC){if(u&&u.failure){u.failure(AC);}}},p);};r.processEmmaTable({success:function z(){t();},canceled:function(AC,AB){var AA={success:function(){if(u&&u.canceled){u.canceled();}},failure:function(){if(u&&u.canceled){u.canceled();}}};if(AB&&(AB.tid||AB.jid)){x.killJob(AA,{threadId:AB.tid,jobid:AB.jid});}else{AA.success();}}},{tables:r.tableID});},processEmmaTable:function(q,p){var o=mstrApp.getRootController().getDataService();o.clearDataCache({success:function(r){o.prepareData(q,p,1,1,H(9130,"Execute SQL"));},failure:function(r){o.prepareData(q,p,1,1,H(9130,"Execute SQL"));}},p);},buildRelations:function S(o){mstrApp.getRootController().getDataService().buildRelations({success:function p(q){if(o&&o.success){o.success(q);}}},{did:this.tableID});},loadDBTypeFilters:function B(q){var o=this;o.dbObjects.populateDBProperties(mstrmojo.func.wrapMethods({success:function p(){var t=[],r=o.dbObjectsDisplayOptions;P.forEach(o.dbObjects.dbTypes,function(u){if((u.disp&r)===r){t.push(u.v);}});o.dbmsTypeFilter=t;o.dbRolesTypeFilter=t;}},q));},cleanDuplicateRI:function N(p){var o;if(this.originalMsgID&&this.originalMsgID!==mstrApp.msgid){if(p){o=mstrApp.msgid;mstrApp.msgid=this.originalMsgID;}else{o=this.originalMsgID;}mstrApp.getRootController().getDataService().removeOrDuplicateRI({success:mstrmojo.emptyFn},{add:false,messageID:o,showWait:false});delete this.originalMsgID;}},submitRequest:function j(q,p,o){if(p.showWait===undefined){p.showWait=true;}mstrApp.getRootController().getDataService()[o||"submitRequest"](q,p);},getHelpTopic:function a(){return this.FFSQLMode?"Importing_data_from_a_database_by_typing_a_query.htm":"Importing_data_from_a_database_by_building_a_SQL_q.htm";}});}());(function(){mstrmojo.requiresCls("mstrmojo.qb.bigquery._hasBigQueryModel","mstrmojo.hash");var C=mstrmojo.hash;mstrmojo.qb.bigquery.Model=mstrmojo.declare(mstrmojo.qb.EmmaModel,[mstrmojo.qb.bigquery._hasBigQueryModel],{setDBRole:function A(D){mstrApp.getRootController().getDataService().setDBRole({success:function(E){mstrApp.msgid=E.msgid;}},{dbrid:D,said:mstrApp.said,pid:this.selectedProject,tbid:this.tableID||""});},getRowWidget:function B(D,F){var G=this.tables,E,I,H;C.forEach(G,function(J){C.forEach(J.rows,function(L,K){if(D){I=D.toLowerCase()+"."+F.toLowerCase();E=J.tbn.toLowerCase();if(E+"."+L.text.toLowerCase()===I){H=L;return false;}}else{if(L.text.toLowerCase()===F){H=mstrmojo.all[K];return false;}}});if(!H){return false;}});return H;},catalogRefresh:false});}());(function(){mstrmojo.requiresCls("mstrmojo.hash","mstrmojo.array","mstrmojo.warehouse.EnumDataChangeEvents");var F=mstrmojo.string;var E=4,A=15,D=5;function G(M){return M.replace(/&gt;/g,">").replace(/&lt;/g,"<").replace(/&quot;/g,'"').replace(/&amp;apos;/g,'"').replace(/&apos;/g,"'").replace(/^\n+|\n+$/g,"").replace(/\t/g," ").replace(/&amp;/g,"&");}function I(O){var M=O.datap,N=M.srce,P=N.csl;this.set("SelDBRoleID",N.dbrid);P=G(P);this.SQLstmt=P;this.raiseEvent({name:"reportDefLoaded"});}function C(M){return M.dbRoleID+M.url;}mstrmojo.qb.thirdParty.Model=mstrmojo.declare(mstrmojo.qb.EmmaModel,null,{scriptClass:"mstrmojo.qb.thirdParty.Model",dbRolesVersionFilter:[223],dbRolesVersionExcludeFilter:[],dbObjectsDisplayOptions:8,xdaType:304,connectorType:131076,dbRoleEditorCfg:{hideShareConnection:true,hideDSNOption:true,hideDriverCheck:true,dbIdFilter:[41],singleType:true},urlSrc:null,init:function L(M){this.dbRoleEditorCfg.showAddDriver=false;M.dbIds=null;M.dbVersions=null;this._super(M);this.urlSrc=[];this.dbRoleEditorCfg.dbIdExcludeFilter=[];this.dbRoleEditorCfg.cfgDbmsTypeExcludeFilter=[];},createReportInstance:function K(){var O=this,N=mstrApp.isFFSQL,M=O.isNew=!mstrApp.tableID,Q=mstrApp.getRootController().getDataService();O.supportTimeGeo=true;O.analysisID=mstrApp.analysisID;O.tableID=mstrApp.tableID;mstrApp.msgid=mstrApp.msgID;if(M){if(mstrApp.msgid){O.originalMsgID=mstrApp.msgid;Q.removeOrDuplicateRI({success:function(R){mstrApp.msgid=R.msgid;}},{messageID:mstrApp.msgid});}else{Q.createEmmaInstance({success:function P(R){mstrApp.msgid=R.msgid;}});}}else{O.originalMsgID=mstrApp.msgid;Q.removeOrDuplicateRI({success:function(R){mstrApp.msgid=R.msgid;var S=E;O.loadReport(S,A,D,null,{success:function U(V){if(N){I.call(O,V);}if(mstrApp.isCloud){mstrApp.getRootController().getDataService().autoClosePrompt({success:function W(X){mstrApp.msgid=X.msgid;}});}}});}},{messageID:mstrApp.msgid});}if(mstrApp.isFFSQL){O.set("isFFSQL",true);O.set("FFSQLMode",true);mstrApp.isFFSQLMode=true;}},getAllowSave:function H(M){if(M&&M!==""){return true;}return false;},getHelpTopic:function J(){return"importing_data_from_a_BI_source.htm";},getNameSpaces:mstrmojo.emptyFn,autoMapFFSQL:function B(N,P){var M=this;mstrApp.getRootController().getDataService().editFFSQL({success:function O(){M.isDirty=true;M.SQLstmt=N;if(N){M.autoMap(P);}}},{exp:F.encodeXMLAttribute(N),tbid:M.tableID||""});}});}());(function(){mstrmojo.requiresCls("mstrmojo.Container","mstrmojo._HasLayout","mstrmojo._HasPopup","mstrmojo._FillsBrowser","mstrmojo.Box","mstrmojo.Table","mstrmojo.Image","mstrmojo.Button","mstrmojo.qb.SplitPanel","mstrmojo.qb.VSplitPanel","mstrmojo.qb.QBuilderModel","mstrmojo.qb.QBPanel","mstrmojo.qb.QBMappings","mstrmojo.qb.MissingColumnWarning","mstrmojo.form","mstrmojo.hash","mstrmojo.array","mstrmojo.qb.Toolbar","mstrmojo.qb.QBPageLayout","mstrmojo.qb.Footer","mstrmojo.DI.DIExitOptions");mstrmojo.requiresDescs(531,1143,3377,12408,12484);var R=mstrmojo.hash,F=mstrmojo.desc,C=mstrmojo.DI.DIHelpers;var M="qbexpr",X={scriptClass:"mstrmojo.qb.ExpressionEditor",id:M};var A=" ",L=".";var N=F(12408,"Please add tables from the same DB connection.");function B(b,c){if(!c){return b;}return(b.indexOf(A)>-1||b.indexOf(L)>-1)?c.replace("#0",b):b;}function Q(d,g,e){var m=[],c=mstrmojo.all.FFsql,n,j,k=e.length,l=c.items,h,f=this.main.WHTableTree,b=f.getDBRole(f.getDBRoleID()).cpat;n=j=c.itemCount;m.push({isNew:true,v:"select",oi:{n:"select",sta:100,t:100},did:j++},{isNew:true,v:" ",isDelimiter:true,did:j++});mstrmojo.array.forEach(e,function(p,o){m.push({isNew:true,v:B(p.cln,b),did:j++});h=o<k-1;if(h){m.push({isNew:true,v:",",isDelimiter:true,did:j++});}m.push({isNew:true,v:"\n",isDelimiter:true,did:j++});if(h){m.push({isNew:true,v:" ",isDelimiter:true,did:j++});}});g=B(g,b);m.push({isNew:true,v:"from",oi:{n:"from",sta:100,t:100},did:j++},{isNew:true,v:" ",isDelimiter:true,did:j++},{isNew:true,v:(d?B(d,b)+L+g:g),did:j++},{isNew:true,v:";",did:j++});if(n>0&&l[n-1]!=="\n"){l.push({isNew:true,v:"\n",isDelimiter:true,did:j++});}l=l.concat(m);c.itemCount=j;c.set("items",l);c.parent.updatepasses();}mstrmojo.qb.QBuilderPage=mstrmojo.declare(mstrmojo.Container,[mstrmojo._HasLayout,mstrmojo._HasPopup],{scriptClass:"mstrmojo.qb.QBuilderPage",markupString:'<div id="{@id}" class="mstrmojo-qb {@cssClass}" style="{@cssText}"><div class="mstrmojo-qb-layout"></div></div>',markupSlots:{layout:function(){return this.domNode.firstChild;}},layoutConfig:{h:{layout:"100%"},w:{layout:"100%"}},id:"QBuilderPage",onError:mstrmojo.emptyFn,renderPageLoadError:function H(){var d=this.error,c=d.message,e=d.title,b=d.btns;this.onError(d);if(!b||!b.length){mstrmojo.alert(c,null,e);}else{mstrmojo.confirm(c,null,{buttons:b,title:e});}},render:function a(){if(this.error){this.renderPageLoadError();}else{this._super();}},saveasRef:{scriptClass:"mstrmojo.SaveAsEditor",typeDesc:mstrmojo.desc(3377,"Object"),browsableTypes:"3,8",showCompletePath:false,onObjectSaved:function(d){var c=this.opener,b=c&&c.oi;if(c&&b){b.did=d.did;b.n=d.name;b.desc=d.desc;c.set("title","QBReport: "+d.name);}}},children:[{scriptClass:"mstrmojo.qb.QBPageLayout",slot:"layout",alias:"main"}],init:function V(d){this._super(d);var e={},c=e[this.id]={};c.directDataAccessTableError=this.onTableAdded;c.diffDBInstTableError=this.onTableAdded;c.windowSizeChanged=this.adjustSize;mstrApp.getRootController().attachDataChangeListeners(e);var f=this.getDBRoleSelector(),b=this.main.children[0].bottomPanel;f.getLayoutOffsets=function(){return{h:9,w:0};};b.getLayoutOffsets=function(){return{h:16,w:0};};b.searchBox.widthOffset=10;b.nameSpaces.heightOffset=30;f.heightOffset=52;b.heightOffset=73;this.main.workPanel.getLayoutOffsets=function(){return{h:16,w:12};};f.newDBBtn.set("text",mstrmojo.desc(531,"Add")+"...");},getDBRoleSelector:function J(){return this.main.children[0].topPanel;},getDBConnectionList:function K(){return this.getDBRoleSelector().dbConnections;},onTableAdded:function P(b){var c="";switch(b.name){case"diffDBInstTableError":c=N;break;case"directDataAccessTableError":c=N;break;}mstrmojo.qb.alert(c);},openDialog:function Y(b){this.openPopup(b);},openExpressionEditor:function I(c,d){var b=mstrmojo.all[M]||mstrmojo.insert(X);b.set("oi",R.copy(c,{mhfts:{},mvfts:{}}));b.open(null,{zIndex:d||50});},addSQLFromColumn:function U(b){Q.call(this,b.ns,b.tbn,[b]);},addSQLFromTable:function S(c,d,b){Q.call(this,c,d,b);},getSQLStatement:function E(){return mstrmojo.all.FFsql.getSQLstmt();},toggleDatabaseView:function Z(b){this.main.toggleDatabaseView(b);},toggleDataPreview:function D(b){this.main.toggleDataPreview(b);},loadView:function O(){this.toggleDataPreview(true);this.toggleDataPreview(false);},showRedirectionPage:function G(b,c){this.set("children",[{scriptClass:"mstrmojo.Label",slot:"toolbar",text:mstrmojo.desc(12484,"Data Imported"),cssClass:"mstrmojo-qb-title"},{scriptClass:"mstrmojo.Image",cssClass:"mstrmojo-qb-toolbarIcon help",slot:"toolbar",title:mstrmojo.desc(1143,"help"),onclick:function(){var d=mstrmojo.helpPath()+"Interfaces_for_importing_data.htm";window.open(d);}},{scriptClass:"mstrmojo.DI.DIExitOptions",privileges:{CreateViewReport:mstrConfig.canCreateReport,CreateReportServices:mstrConfig.canCreateDocument,CreateAnalysis:mstrConfig.canCreateAnalysis},model:{cubeID:b,path:c,operationMode:mstrApp.getRootController().getOperationMode()},slot:"layout"},{scriptClass:"mstrmojo.qb.Footer",slot:"footer",alias:"footerWidget"}]);this.footerWidget.hidePublish();},adjustSize:function(h,b){var l=h.size,e=h.target,d=mstrApp.isCloudPro,k=d?40:0,g=d?180:101,f=!!mstrApp.isWorkstation?60:0;if(!C.acceptEventFromAncestor.call(this,e)){return ;}var c,j;if(b&&mstrmojo.DI.DIHelpers.getEnvObj().isWSLiveMode()){g+=45;k+=80;}j=parseInt(l.h,10)-g+f+"px";c=parseInt(l.w,10)-k+"px";if(this.height&&j!==this.height){this.set("height",j);}else{this.height=j;}if(this.width&&c!==this.width){this.set("width",c);}else{this.width=c;}return true;},postBuildRendering:function W(){if(this._super){this._super();}this.adjustSize({size:mstrApp.size},true);}});})();(function(){mstrmojo.requiresCls("mstrmojo.qb.QBPageLayout","mstrmojo.qb.QBuilderPage","mstrmojo.qb.bigquery.BigQueryWHPanel","mstrmojo.qb.QBHelpers");var F=mstrmojo.qb.QBHelpers;var B=[{did:"Delete",n:mstrmojo.desc(629,"Delete")},{did:-1,n:"-"},{did:"0",n:mstrmojo.desc(9640,"Inner Join")},{did:"1",n:mstrmojo.desc(9940,"Left Outer Join")},{did:"2",n:mstrmojo.desc(9941,"Right Outer Join")},{did:"3",n:mstrmojo.desc(9641,"Outer Join")},{did:-1,n:"-"},{did:"More Options",n:mstrmojo.desc(9126,"More Options")}];var C=[{did:"0",n:mstrmojo.desc(9640,"Inner Join")},{did:"1",n:mstrmojo.desc(9940,"Left Outer Join")},{did:"2",n:mstrmojo.desc(9941,"Right Outer Join")},{did:"3",n:mstrmojo.desc(9641,"Outer Join")},];var A=[{n:"=",dssid:"0"}];mstrmojo.qb.bigquery.QBPageLayout=mstrmojo.declare(mstrmojo.qb.QBPageLayout,null,{scriptClass:"mstrmojo.qb.bigquery.QBPageLayout",init:function D(H){var G;this.children=F.clone(this.children);this.children[0].scriptClass="mstrmojo.qb.bigquery.BigQueryWHPanel";if(this._super){this._super(H);}G=this.workPanel.children[0].tables;G.joinMenuOption={menuItems:B,joinItems:C,mappingKey:"bigquery",joinOperators:A};}});mstrmojo.qb.bigquery.BigQueryBuilderPage=mstrmojo.declare(mstrmojo.qb.QBuilderPage,null,{scriptClass:"mstrmojo.qb.bigquery.BigQueryBuilderPage",init:function D(G){this.children=F.clone(this.children);this.children[0].scriptClass="mstrmojo.qb.bigquery.QBPageLayout";if(this._super){this._super(G);}},getDBRoleSelector:function E(){return this.main.children[0].topPanel.dbSelector;}});}());(function(){mstrmojo.requiresCls("mstrmojo.Obj","mstrmojo.hash","mstrmojo.Serializer","mstrmojo.array","mstrmojo.qb.QBuilderPage","mstrmojo.qb.QBuilderModel","mstrmojo.warehouse.WHController","mstrmojo.qb.QBHelpers","mstrmojo.DI.DIConstants");mstrmojo.requiresDescs(218,219,221,1442,3179,3377,7985,7986,8041,9114,9139,9523,9915,11299,12379,12380,12922,13137,15125);var o=mstrmojo.hash,w=mstrmojo.array,AR=mstrmojo.string,j=mstrmojo.warehouse.EnumDataChangeEvents,AK=mstrmojo.qb.QBHelpers,h=mstrmojo.DI.DIConstants,Y=mstrmojo.desc;var N={1:Y(12379,"We cannot convert the cube to a DDA cube because you are importing some tables that cannot support it. Remove them to enable this feature."),2:Y(12380,"The cube has to be a direct data access cube due to some of the sources selected. You will have to delete them if you want to change this.")};var M=function(AX){if(AX===null){return"null";}var AY=typeof (AX);if(AY!=="object"){return AY;}else{if(AX.length===undefined){return"object";}else{return"array";}}};function H(AX){var AY=mstrApp.diShowFooterFunction;if(AY){AY({finish:{visible:AX}});}}function x(AY){var AX=AY.FFSQLMode?"Type Query":"Build Query";return{name:AX};}mstrmojo.qb.RootController=mstrmojo.declare(mstrmojo.warehouse.WHController,null,{ddaController:null,start:function p(Aj,Aa){var Ad=this.rootView,Ac=this.model,Ae=this,AY,Ab,AX,Ag,AZ,Ai;this.dataService=mstrmojo.qb.DataService;Ad.render();if(mstrApp.isCloudPro){mstrApp.docID=mstrApp.docID||"";}else{mstrApp.docID=mstrApp.docID||mstrApp.analysisID||"";}if(mstrApp.isFFSQL){this.raiseEvent({name:"reportModeChange",mode:2,value:""});}this.toggleDatabaseView(true);Ad.loadView();var Af=function Af(){Ae.loadDBRoles({success:function Ak(){Ac.createReportInstance(Aj,Aa);var Al;Al=(Ac.isNew&&mstrApp.emmaTablesNum===0);H(Al);}});};if(Ac.specifyDBTypes){Ac.dbObjects.populateDBProperties({success:function Ah(){Af();}});}else{Ac.loadDBTypeFilters({success:function Ah(){Af();}});}AY=mstrApp.diRootViewID;this.header=Ab=(AY?(mstrmojo.all[AY]&&mstrmojo.all[AY].header):undefined);Ac.attachEventListener("dataPreview",this.id,function(){Ae.enableButton(Ac.SQLstmt);});AX=mstrApp.diFooterID;Ag=AX?mstrmojo.all[AX]:undefined;if(Ag){AZ=Ag.next;Ai=Ag.finish;Ae.attachEventListener("allowSave",AZ.id,Ag.enableButton);Ae.attachEventListener("allowSave",Ai.id,Ag.enableButton);}},getDataService:function Z(){return this.dataService;},getModel:function AW(){return this.model;},toggleDatabaseView:function AO(AX){this.rootView.toggleDatabaseView(AX);},toggleDataPreview:function AE(AX){var AZ=this.rootView,AY=this.model.FFSQLMode;AZ.toggleDataPreview(AX);if(!AY){AZ.showQBPreview=AX;}if(AX){this.raiseEvent({name:"dataPreview"});}},openConditionDialog:function f(){var AY=this.model,Ab=mstrApp.diCurrentZIndex,Aa=Ab?Ab+1:(this.zIndex||10)+1;if(AY.dbtables.length===0){mstrmojo.alert(mstrmojo.desc(9114,"Cannot add Filter without any Tables being added, please add some Tables first"));return ;}var AZ="qbcondition",AX=mstrmojo.all[AZ]||mstrmojo.insert({scriptClass:"mstrmojo.qb.ConditionEditor",id:AZ});AX.set("zIndex",Aa);if(!AX.hasRendered){AX.render();}AX.domNode.style.zIndex=AX.zIndex;AX.set("data",o.clone(AY.getConditions()));AX.set("visible",true);},refreshConditionDialog:function L(){var AY=this.model,AZ="qbcondition",AX=mstrmojo.all[AZ];if(AX&&AX.visible){AX.set("data",o.copy(AY.getConditions()));}},openHelp:function l(){var AX=mstrmojo.helpPath()+(mstrApp.isFFSQL?"Importing_data_from_a_database_by_typing_a_query.htm":"Importing_data_from_a_database_by_picking_relation.htm");window.open(AX);},openExpressionEditor:function S(AY){var AX=this,Aa={success:function AZ(){var Ac=mstrApp.diCurrentZIndex,Ab=AY.zIndex?AY.zIndex:(Ac?Ac+3:AX.zIndex);AX.rootView.openExpressionEditor(AY,Ab);}};if(this.getFunctionList()){Aa.success();return ;}this.model.getFunctions(false,{success:function AZ(){Aa.success();}},{showWait:true});},getFunctionList:function AA(){return this.model.getFunctionList();},getSuggestionItems:function AP(AX){return this.model.getSuggestionItems(AX);},exprjson2xml:function e(Aj,Ag,Aa){if(!(Ag instanceof Array)){Ag=[Ag];}var AY=Aa&&Aa.isSerializable,Ae=(Aa.convertBoolean===false)?false:true;var Ah=[],AX=[],AZ,Ak;for(var Ad=0,Al=Ag.length;Ad<Al;Ad++){var Am=Ag[Ad];for(AZ in Am){if(AY){var Af=AY(AZ,Ag,Ad);if(Af!==true){if(Af===false){continue;}else{if(Af.att){Ah.push(Af.att);}if(Af.child){AX.push(Af.child);}continue;}}}Ak=Am[AZ];switch(M(Ak)){case"array":var Ab,Ac,Ai;if(AZ!=="omit"){AX.push(["<",AZ,">"].join(""));for(Ab=0,Ac=Ak.length;Ab<Ac;Ab++){Ai=Aa.getArrItemName(AZ,Ak,Ab)||Ab;AX.push(this.exprjson2xml(Ai,Ak[Ab],Aa));}AX.push("</"+AZ+">");}else{for(Ab=0,Ac=Ak.length;Ab<Ac;Ab++){Ai=Aa.getArrItemName(AZ,Ak,Ab)||Ab;AX.push(this.exprjson2xml(Ai,Ak[Ab],Aa));}}break;case"object":AX.push(this.exprjson2xml(AZ,Ak,Aa));break;case"string":Ah.push([AZ,'="',mstrmojo.string.encodeXMLAttribute(Ak),'"'].join(""));break;case"boolean":Ah.push([AZ,'="',((Ae)?(Ak?"-1":"0"):Ak),'"'].join(""));break;case"null":if(!Aa.skipNull){Ah.push([AZ,'="',Aa.nullValue,'"'].join(""));}break;default:Ah.push([AZ,'="',Ak,'"'].join(""));break;}}}return["<",Aj," ",Ah.join(" "),">",AX.join(""),"</",Aj,">"].join("");},parseExpression:function D(AY,AX){this.model.validateExpr(AY,AX);},autoMap:function AF(){var AX=this;if(!AX.hasDBConnection()){return ;}AX.model.autoMap({success:function(){AX.toggleDataPreview(true);}},false,false);},autoMapFFSQL:function r(AY){var AX=this;if(!AX.hasDBConnection()){return ;}AX.model.autoMapFFSQL(AY,{success:function AZ(){AX.enableButton(AY);}});},getSQLPreview:function m(AX){this.model.getSQL(AX);},convertMode:function AM(Ac){var AZ=this,Ab=mstrApp.diCurrentZIndex,Aa=Ab?Ab+1:1000;AZ.model.connectLiveSupport=undefined;if(Ac){mstrmojo.confirm(mstrmojo.desc(15125,"All changes performed in Build Query mode will be lost. Do you want to leave Build Query mode?"),{confirmBtn:{fn:function(){AZ.model.getSQL({success:function Ae(Af){AZ.model.convertToFFSQL(Af,{success:function Ag(){AZ.toggleDataPreview(false);AZ.raiseEvent({name:"reportModeChange",mode:2,value:Af});}});}});}}},{zIndex:Aa});}else{var AY=AZ.rootView.showQBPreview,Ad={success:function(){AZ.toggleDataPreview(AY);AZ.raiseEvent({name:"reportModeChange",mode:1,showPreview:AY});}},AX=mstrmojo.all.FFsql;if(AX.oriSQL===AX.getSQLstmt()){AZ.model.convertToQueryBuilder(Ad);}else{mstrmojo.confirm(mstrmojo.desc(9139,"All changes performed in FFSQL mode will be lost. Do you want to leave FFSQL mode?"),{confirmBtn:{fn:function(){AZ.model.convertToQueryBuilder(Ad);}}},{zIndex:Aa});}}},editSQL:function AS(AX,AY){this.model.editFFSQL(AY,AX);},addTable:function AB(AY,AX){this.model.addTable(AY,AX);},addTables:function AJ(AY){var AZ=this,AX=AZ.model;w.forEach(AY,function(Ab){AZ.getColumnsForDBTable({data:Ab},{success:function Aa(Ac){if(AX.FFSQLMode){AZ.addTableSQL(Ab,Ac.items);AZ.enableButton();}else{AZ.addTable(Ab,Ac.items);}}});});},addSQLFromTable:function AH(AY,AZ,AX){this.rootView.addSQLFromTable(AY,AZ,AX);},addSQLFromColumn:function AC(AX){this.rootView.addSQLFromColumn(AX);},addSelectedColumns:function c(Aa,AX,AZ,AY){this.model.addSelectedColumns(Aa,AX,AZ,AY);},addColumnWithExpression:function R(AX,Aa,AZ,AY){this.model.addColumnWithExpression(AX,Aa,AZ,AY);},editColumnExpression:function t(AX,Aa,AZ,AY){this.model.editColumnExpression(AX,Aa,AZ,AY);},gettIndex:function b(AX){return this.model.gettIndex(AX);},updateTableViewWithExpression:function Q(AY,AX,Ae){var Ac=this.model,Ab=Ac.selectedClns[AY],Aa=Ab.wid,AZ,Ad;Ab.expr=AX;w.forEach(Aa,function(Af){AZ=mstrmojo.all[Af];if(AZ&&!Ae){if(AZ.count>0){AZ.count--;}AZ.updateState(0);}});Aa=[];w.forEach(AX,function(Af){Ad=Af.oi;if(Ad&&Ad.tp===26){AZ=Ac.getRowWidget(Ad.tn,Ad.rn);if(AZ){AZ.count++;AZ.updateState(1);Aa.push(AZ.id);}}});Ab.wid=Aa;Ac.updateExpression(AY);},updateFilters:function AN(AX,AY){this.model.updateConditions(AX,AY);},addNewFilter:function V(AX){this.model.appendCondition(AX);},cancel:function K(){var AX=mstrApp.origin?(mstrApp.isBigQuery?"-3":"-2"):"-1";mstrmojo.form.send({evt:"3124",src:mstrApp.name+".qbuilder.3124",relativePageNumber:AX},mstrApp.name,"POST",null,null,false);},onCancelButtonClick:function AL(){var AX;this.model.cleanDuplicateRI(true);AX=mstrApp.msgid;mstrApp.container.unloadQB();mstrApp.messageID=AX;mstrApp.getRootController().onCancelButtonClick();},onNextButtonClick:function X(){var AX=this;this.commit({success:function AY(){var AZ,Aa=mstrApp.getRootController().model,Ac=Aa.isDDA,Ab=Aa.isManagedCube;if(AX.header&&AX.header.closeBtn){AX.header.closeBtn.set("visible",true);}Aa.cleanDuplicateRI(false);AZ=mstrApp.msgid;mstrApp.container.unloadQB();mstrApp.messageID=AZ;mstrApp.isDDA=Ac;mstrApp.isManagedCube=Ab;mstrApp.getRootController().afterQBProcess();}});},saveDDACube:function AT(AY){var AZ=this.model,Aa={},Ab;Ab={success:function(Ai){var Ac,Ae=AZ.isDDA,Af,Aj,Ag,Ah,Ad,Ak=AZ.isManagedCube;AZ.cleanDuplicateRI(false);Ac=mstrApp.msgid;mstrApp.container.unloadQB();mstrApp.messageID=Ac;mstrApp.isDDA=Ae;mstrApp.isManagedCube=Ak;Af=mstrApp.getRootController();Aj=Af.model;Af.getDDAController().setDirectDataAccess(mstrApp.isDDA);Af.dataService.set("messageID",mstrApp.messageID);Af.model.isManagedCube=mstrApp.isManagedCube;Aj.cubeName=x(AZ).name;if(mstrApp.isSingleTier){Ag={isDirectDataAccess:Aj.isDirectDataAccess,name:Aj.cubeName};Ah={success:function(Al){if(Al.objectId){Aj.cubeID=Al.objectId;}Af.wrapUpDataImport();},failure:function(Al){mstrApp.hideProgress();Af.displayError(mstrmojo.desc(13061,"Error in creating the dataset."),false,Al&&Al.message);}};Ad={success:function(){Af.dataService.createOneTierDoc(Ah,Ag);},failure:function(Al){mstrApp.hideProgress();Af.displayError(mstrmojo.desc(13062,"Error in merging the duplicate report instance."),false,Al&&Al.message);}};if(Aj.operationMode===h.operationMode.edit||Aj.operationMode===h.operationMode.refresh){Af.dataService.duplicateReportInstance(Ad,{messageID:Aj.analysisID,datasetID:Aj.cubeID,duplicateRIMsgID:Af.dataService.messageID});}else{if(mstrApp.isSingleTier&&!AZ.isManagedCube){if(Ai&&Ai.objectId){Aj.cubeID=Ai.objectId;}Af.wrapUpDataImport();return ;}Af.dataService.createOneTierDoc(Ah,Ag);}return ;}if(Ak){Af.wrapUpDataImport();return ;}Aj=Af.model;if(Ai&&Ai.objectId){Aj.cubeID=Ai.objectId;}Aj.path=AY&&AY.objPath;Af.wrapUpDataImport();}};function AX(){if(AZ.isManagedCube){Ab.success();return ;}Aa.displayMode=12;Aa.shouldRefresh=false;if(AZ.isDDA){Aa.shouldRefresh=false;Aa.saveAsFlags=h.saveAsFlags.saveAsDDA|h.saveAsFlags.saveAsOverWrite;}else{Aa.saveAsFlags=h.saveAsFlags.saveAsInMemory|h.saveAsFlags.saveAsOverWrite;}Aa.saveAsFlags|=h.saveAsFlags.saveAsWithAnswers|h.saveAsFlags.saveAsWithPrompts;Aa.taskId="saveAndPublishCube";Aa.showWait=true;Aa=o.copy(AY,Aa);Aa.saveAsOverwrite=true;if(mstrApp.isSingleTier&&!AZ.isManagedCube){Aa.persist=1;}Aa.objName=Aa.objName||x(AZ).name;Aa.folderID=Aa.folderID||"";Aa.msgID=Aa.msgid||mstrApp.msgid;delete Aa.objPath;mstrApp.getRootController().model.submitRequest(Ab,Aa);}mstrApp.getRootController().model.submitRequest({success:function(){if(AZ.operationMode!==2){mstrApp.getRootController().model.submitRequest({success:function(){AX();}},{taskId:"DIClearRelationshipEMMASourceTable",showWait:true});}else{AX();}}},{taskId:"DIToggleDatasetServeMode",serveMode:AZ.isDDA?h.datasetServeMode.dda:h.datasetServeMode.inMemory,showWait:true});},handleFinish:function a(){var AX=this.model,AZ=this,AY=AX.operationMode,Aa={};Aa.onOK=function(Ac){AZ.commit({success:function Ab(){var Ad,Af=AX.isDDA,Ae=AX.isManagedCube;if(Af&&AY!==1){AZ.saveDDACube(Ac);}else{AX.cleanDuplicateRI(false);Ad=mstrApp.msgid;mstrApp.container.unloadQB();mstrApp.messageID=Ad;mstrApp.isDDA=Af;mstrApp.saveCubeParams=Ac;mstrApp.isManagedCube=Ae;mstrApp.getRootController().afterQBProcess(true);}}});};if(AY===1){Aa.onOK();}else{if(!AX.isManagedCube&&!mstrApp.isSingleTier){AK.showSaveAsDialog(Aa,x(this.model));}else{Aa.onOK();}}},onBackButtonClick:function n(){var AY=this.model,AZ=AY.tableID,AX=this,Ab;Ab={success:function Aa(){var Ac=mstrApp.msgid,Ad;mstrApp.container.unloadQB();mstrApp.messageID=Ac;Ad=mstrApp.getRootController();if(Ac){Ad.dataService.set("messageID",Ac);}Ad.backFromQB();}};if(AY.isNew&&AZ){AX.getDataService().removeEmmaTable(Ab,{did:AZ});}else{Ab.success();}},onFinishButtonClick:function AQ(){var AY=this,AX=this.model,Aa=AY.getDDAController(),Ad,AZ,Ac=mstrApp.diCurrentZIndex,Ab=Ac?Ac+1:10;if(!AX.origIsDDA&&Aa.allowDDA()){Ad={onOK:function(){AY.handleFinish();}};AZ={callback:Ad,selectedIndex:AX.isDDA?0:1,zIndex:Ab};Aa.showDDAConfirmDialog(AZ);return ;}this.handleFinish();},exitApplication:function G(){mstrApp.container.unloadQB();mstrApp.getRootController().exitApplication();},addSQLCandidateTables:function u(AX){this.model.raiseEvent({name:"addCandidateTables",value:AX});},hasDBConnection:function z(){if(this.model.SelDBRoleID){return true;}mstrmojo.alert(mstrmojo.desc(9915,"Please select a database connection first."));return false;},hasDBRoleSelected:function(){return !!this.model.SelDBRoleID;},publish:function g(){var AZ=this.model,AX=AZ.FFSQLMode?this.rootView.getSQLStatement():"",Ab=AZ.isNew,Ac=mstrApp.folderID,Aa=this,AY={success:function(Ah){if(mstrApp.analysisID||mstrApp.msgID){var Ai=mstrApp.analysisID?[3169,mstrApp.name+".3169","messageID",mstrApp.analysisID]:[3104,mstrApp.name+".3104","messageID",mstrApp.msgID,"rwDesignMode",1,"executionMode",2],Ag=[Ai,[2048007,mstrApp.name+".rwd.rwframe.rwb.2048007","dsObjectID",Ah.did,"dsType",3,"isDatasetAdded",false,"isDefault",false]];mstrApp.redirectToPage({evt:"1024001",events:mstrmojo.Serializer.serializeValueGroup(Ag),src:mstrApp.name+"."+mstrApp.pageName+".1024001","1024001":"1",evtorder:"1024001"});}else{if(mstrApp.isCloudPro){mstrApp.redirectToPage({evt:"3104",src:mstrApp.name+".3104",executionMode:"1",rwDesignMode:"0",objectType:"3",objectID:Ah.did,rwCreateFlags:"16",rwViewMode:"2048"});}else{Aa.gotoRedirectionPage(Ah.did,Ah.path);}}}};if(!this.hasDBConnection()){return ;}AZ.recoverMode=0;if(Ac||!Ab){var Af=Ab&&mstrApp.isCloudPro;AZ.save((Af?AZ.getAutoReportName():null),null,Ac,!Ab,Af,AX,{success:function(Ak){var Aj=mstrApp.analysisID,Am=!AZ.isCubeReport,Ag=mstrApp.folderID,Ai=mstrApp.reportID,Al=mstrApp.refreshInDoc;if(!Ab&&Aj){mstrApp.hideWait(true);if(Al){if(rrLockAndRunDashboard){rrLockAndRunDashboard(Aj);}else{mstrApp.redirectToPage({evt:"3104",rwDesignMode:"0",rwViewMode:"2048",executionMode:"1",objectType:"55",objectID:Aj});}}else{var Ah=mstrmojo.insert({scriptClass:"mstrmojo.Editor",cssClass:"mstrmojo-qb-ObjectInfoEditor run-dashboard",showTitle:false,analysisID:Aj,cssText:"width: 260px",children:[{scriptClass:"mstrmojo.Label",text:Am?mstrmojo.desc(13137,"Edit data successfully!"):mstrmojo.desc(11299,"Data refresh successful!"),cssClass:"mstrmojo-AttCreator-Text"},{scriptClass:"mstrmojo.HBox",cssClass:"mstrmojo-Editor-buttonBox",slot:"buttonNode",children:[{scriptClass:"mstrmojo.Button",cssClass:"mstrmojo-Editor-button mstrmojo-Editor-button-RunDashboard",onclick:function(Ao){var An=this.parent.parent;An.close();if(rrLockAndRunDashboard){rrLockAndRunDashboard(Aj);}else{mstrApp.redirectToPage({evt:"3104",rwDesignMode:"0",rwViewMode:"2048",executionMode:"1",objectType:"55",objectID:Aj});}}},{scriptClass:"mstrmojo.Button",id:"RefreshData",cssClass:"mstrmojo-Editor-button mstrmojo-Editor-button-"+(Am?"EditData":"RefreshData"),cssDisplay:"none",onclick:function(){if(Am){refreshCube(Aj,Ag,"0",Ai,RRDIExtentedType.DATAIMPORT_DATABASE,false,true);}else{openCubeRefreshStatus(Aj,Ag);}}},{scriptClass:"mstrmojo.Button",cssClass:"mstrmojo-Editor-button mstrmojo-Editor-button-Exit",onclick:function(){var An=this.parent.parent;An.close();mstrApp.showWait();if(mstrApp.isCloud){rrOpenHomePage&&rrOpenHomePage();}else{mstrApp.redirectToPage({evt:3010});}}}]}]});Ah.open();}}else{AY.success(Ak);}}});}else{var Ad=this.rootView,Ae=function Ae(){Ad.openPopup("saveasRef",{folderLinksContextId:mstrConfig.hasProfileReports?28:1,name:mstrmojo.desc(8041,"New Cube"),saveAs:function(){var An=this,Ag=An.contPanel,Ah=Ag.name.value,Am=An.ob.currentFolder,Aj=Am.did,Ai={success:function Al(Ap){AY.success(Ap);},failure:function Ak(Aq){var Ap=parseInt(Aq.getResponseHeader("X-MSTR-TaskErrorCode"),10)+4294967296;if(Ap===2147749923){mstrmojo.confirm(mstrmojo.desc(7986,"The ## '###' already exists. Do you want to replace the existing one?").replace("##",mstrmojo.desc(3377)).replace("###",Ah),{confirmBtn:{fn:function(){Ao(true);}}},{title:mstrmojo.desc(3179,"Confirm Overwrite")});}else{mstrmojo.alert(mstrmojo.desc(7985,"Error while saving: ")+Aq.getResponseHeader("X-MSTR-TaskFailureMsg"));}}};if(!Ah){mstrmojo.alert(mstrmojo.desc(9523,"Enter a Name"));return ;}var Ao=function Ao(Ap){AZ.save(Ah||"",Ag.desc.value||"",Aj,Ap,mstrApp.isCloudPro,AX,Ai);An.close();};Ao();}});};Ae();}},updateTableStructure:function I(){var AX=this.model;AX.compareDBTables({success:function(){if(AX.hasMissingUsedDBColumns()){mstrmojo.confirm(mstrmojo.desc(12922,"There are missing columns used in expressions. Do you want to update?"),null,{buttons:[mstrmojo.Button.newInteractiveButton(mstrmojo.desc(219),function(){AX.updateDBTables(true);},null,{iconClass:"mstrmojo-Editor-button-Yes"}),mstrmojo.Button.newInteractiveButton(mstrmojo.desc(218),null,null,{iconClass:"mstrmojo-Editor-button-No"})],title:mstrmojo.desc(3179)});}else{AX.updateDBTables();}}});},gotoRedirectionPage:function C(AX,AY){if(mstrApp.isNewAnalysis){mstrApp.redirectToPage({evt:"3104",src:mstrApp.name+".3104",executionMode:"1",rwDesignMode:"0",objectType:"3",objectID:AX,rwCreateFlags:"16",rwViewMode:"2048"});return ;}if(mstrApp.msgID){mstrApp.redirectToPage({evt:"3104",src:mstrApp.name+".3104",executionMode:"2",rwDesignMode:"1",objectType:"3",objectID:AX});return ;}this.rootView.showRedirectionPage(AX,AY);},save:function k(){this.model.save();},enableButton:function(AY){var AX=this.model.getAllowSave(AY);this.raiseEvent({name:"allowSave",value:AX});},addWHTable:function J(Aa){var AZ=this.model,AY=0,AX=Aa.x,Ab=Aa.y;w.forEach(Aa,function(Ad){AZ.getColumnsForDBTable({data:Ad},{success:function Ac(Ae){Ad.x=AX+AY*15;Ad.y=Ab+AY*15;AY++;AZ.addTable(Ad,Ae.items);}},this);});},canAddTableSQL:function AD(AY,AX){return this.model.canAddTableSQL(AY,AX);},addTableSQL:function O(AY,AX){this.model.addTableSQL(AY,AX);},getFFsqlComp:function AU(){return this.model.FFsqlComp;},getOperationMode:function AI(){return(this.model.isNew)?0:1;},checkDBTables:function q(){this.model.checkDBTables();},markFailureLabel:function U(AX){this.raiseEvent({name:"failureLabel",value:AX});},attachDataChangeListeners:function AG(AY){var AX=this.model;o.forEach(AY,function(AZ,Aa){o.forEach(AZ,function(Ac,Ab){AX.attachEventListener(Ab,Aa,Ac);});});},editColumn:function d(Aa){var Ab=3,AZ=Aa.columnIndex,AX=this.model,AY=AX.selectedClns[AZ];this.openExpressionEditor({type:Ab,w:AY,tkn:AY.expr,cIndex:AZ});},deleteColumn:function B(AZ){var AY=AZ.columnIndex,AX=this.model;if(AX.removeSelectedColumn){AX.removeSelectedColumn(AY);}},deleteAllColumns:function P(){this.model.removeAllColumns();},enableAvailableTables:function AV(){this.model.raiseEvent({name:j.DBTABLES_ENABLED,value:true});mstrApp.getRootController().enableButton();},getDDAController:function W(){if(this.ddaController===null){this.ddaController={shouldAskUser:true,allowDDA:function Ab(){var Ai=mstrApp.getRootController(),Aj=Ai.model,Ak=Ai.rootView,Ag=!!Aj.canSupportDDA,Ae,Al,Ah=Aj.connectLiveSupport,Am,Af;if(!Ag||(Ah===h.connectLiveSupport.connectLiveSupportInMemoryOnly)){return false;}else{if(Ah===undefined||!mstrApp.isFFSQLMode){Am=Aj.getDBRole(Aj.SelDBRoleID);Af=Am&&Am.mdDBRole&&Am.mdDBRole.db_type===3000;if(Af){return false;}}}Ae=Aj.dbridForDDA;if(Ae){if(!mstrApp.isFFSQLMode&&Aj.dbtables.length>0&&Ae!==Aj.prevDBRoleID){Ag=false;}else{if(mstrApp.isFFSQLMode){Al=Ak.getSQLStatement();if(Aj.prevDBRoleID&&AR.trim(Al)&&Ae!==Aj.prevDBRoleID){Ag=false;}}}}return Ag&&!(mstrApp.isFFSQLMode&&Aj.isMultiPassSQL(Ak.getSQLStatement()));},onlyAllowDDA:function Ad(){return !!mstrApp.getRootController().model.shouldSupportDDA;},onToggleDDA:function AX(Ah){var Af=mstrApp.getRootController().model,Ae=0,Ag;if(Af.isDDA===Ah){return ;}if(Ah){Af.set("isDDA",true);if(!this.allowDDA()){Ae=1;Ag=false;}}else{Af.set("isDDA",false);if(this.onlyAllowDDA()){Ae=2;Ag=true;}}if(Ae){mstrmojo.qb.alert(N[Ae]);Af.set("isDDA",Ag);}},checkDDACheckbox:function AZ(Ag){var Ae=mstrApp.getRootController().model.ddaCheckboxID,Af;if(Ae){Af=mstrmojo.all[Ae];if(Af){Af.set("checked",Ag);}}},tryEnableDDACheckbox:function Aa(Ag){var Ae=mstrApp.getRootController().model.ddaCheckboxID,Af;if(Ae){Af=mstrmojo.all[Ae];}if(!Af||!Af.visible){return ;}if(!Ag){if(Af.enabled&&!Af.checked&&!this.allowDDA()){Af.set("enabled",false);}}else{if(!Af.enabled&&!Af.checked&&this.allowDDA()){Af.set("enabled",true);}}},askUserAboutDDA:function Ac(Ae){if(Ae){this.shouldAskUser=false;}return this.shouldAskUser;},showDDAConfirmDialog:function AY(Ae){var Af=new mstrmojo.DI.ui.dialogs.DIDirectAccessConfirmDialog(Ae||{});Af.open();}};}return this.ddaController;},onHelpButtonClick:function A(){mstrApp.showHelpTopic(this.model.getHelpTopic());},selectDBRole:function E(AZ){var AY,AX;if(!AZ){return ;}AY=this.rootView.getDBConnectionList&&this.rootView.getDBConnectionList();if(!AY){return ;}AX=w.find(AY.items,"did",AZ);if(AX>=0){AY.set("selectedIndex",AX);AY.adjustScrollPosition(AX);}return(AX>=0);},hasTableJoin:function F(AX){var AY=this.model.tables[AX];return(AY&&AY.njoins>0)?true:false;}});}());(function(){mstrmojo.requiresCls("mstrmojo.qb.RootController","mstrmojo.warehouse.WHController");mstrmojo.qb.EmmaController=mstrmojo.declare(mstrmojo.qb.RootController,null,{commit:function A(F){var C=this.model,D,B={success:function E(){C.buildRelations(F);}};if(C.FFSQLMode){C.autoMapFFSQL(mstrApp.getRootController().rootView.getSQLStatement(),B);}else{C.autoMap(B);}}});}());(function(){mstrmojo.requiresCls("mstrmojo.qb.RootController","mstrmojo.warehouse.WHController","mstrmojo.DI.DIHelpers");mstrmojo.requiresDescs(12752,12898,13324);var L=mstrmojo.array,I=mstrmojo.DI.DIHelpers;function G(){return mstrApp.container.launchingApp.getRootController();}function E(S){var R=[];var U=[];var V=S.urlSrc;var W="<ul>";mstrmojo.hash.forEach(V,function(X){if(X.fail===true){R.push(X.tableID);W+="<li>"+X.url+"<br>"+X.errorMsg||" </li>";}else{U.push(X.tableID);}});W+="</ul>";return W;}function H(S,X,W){var Z=E(S);var R={detailErrorMessage:Z,okBtnText:mstrmojo.desc(219,"Yes"),cancelBtnText:mstrmojo.desc(218,"No"),onCancel:W};var Y=mstrmojo.desc(12752,"BI Sources"),V=mstrmojo.desc(13324,"Error importing the following files. Click 'Yes' to ignore the erroneous files and proceed with the successful files. Otherwise, click 'No' to check the erroneous files or delete them."),U=G();U.displayWarning(V,Y,X,R);}function P(R){var S=G();var U=E(R);S.displayError(mstrmojo.desc(12900,"Error importing following files. Please check the files or delete them."),false,U);}function M(W,X,V,S,Z){var R={success:function Y(){W.buildRelations(Z);},failure:function U(){W.urlSrc[S].fail=true;Z.success();}};W.setDBRole(X);W.autoMapFFSQL(V,R);}function C(U,X,Y,R){var W=mstrApp.getRootController().getDataService();if(mstrApp.msgid&&X.tableID){U.tableID=X.tableID;M(U,X.dbRoleID,X.url,R,Y);}else{W.createEmmaTable({success:function V(Z){U.tableID=Z.tbid;mstrApp.msgid=Z.msgid;X.tableID=Z.tbid;M(U,X.dbRoleID,X.url,R,Y);},failure:function S(){U.urlSrc[R].fail=true;P(U);}},{xt:U.xdaType,dict:U.connectorType});}}function B(V){var R=V.getDBRole(V.SelDBRoleID);var S=R?R.n:"";var U="BI Source from "+S;return{name:U};}function O(a,e){var c=mstrApp.getRootController().getDataService();var W=a.urlSrc,Y=[],S=[];L.forEach(W,function(f){if(f.fail){S.push(f.tableID);}else{Y.push(f);}});var X=function(){e.success();},V=function(){var f=mstrApp.getRootController();f.removeImportedSrc(Y);};var b=(S.length===W.length);var Z={success:function d(){L.forEach(W,function(f){if(f.fail){f.tableID=undefined;}});if(b){P(a);}else{H(a,X,V);}},failure:function R(){var f=G();f.displayError(mstrmojo.desc(12898,"Delete failed table failure!"),true);}};var U=S.length;if(U===0){e.success();}else{if(a.isNew){c.removeEmmaTable(Z,{did:S.join()});}else{P(a);}}}mstrmojo.qb.thirdParty.Controller=mstrmojo.declare(mstrmojo.qb.RootController,null,{scriptClass:"mstrmojo.qb.thirdParty.Controller",proIdx:-1,commit:function J(Z){var S=this.model,W=mstrApp.getRootController().rootView,U=W.getSrcUrls(),Y=U.length,V=this,X;S.urlSrc=U;V.proIdx=0;if(Y>0){X=U[0];var R={success:function(){V.proIdx++;X=U[V.proIdx];if(X){C(S,X,R,V.proIdx);}else{O(S,Z);}}};if(S.isNew){C(S,X,R,V.proIdx);}else{M(S,X.dbRoleID,X.url,0,Z);}}},onBackButtonClick:function Q(){mstrApp.container.unloadQB();var R=mstrApp.getRootController();var S=R.rootView.header;if(S){S.set("subtitleText","");}R.backFromQB();},handleFinish:function K(){var R=this.model,U=this,S=R.operationMode,V={};V.onOK=function(X){U.commit({success:function W(){var Y=mstrApp.msgid,Z=R.isManagedCube;mstrApp.container.unloadQB();mstrApp.messageID=Y;mstrApp.saveCubeParams=X;mstrApp.isManagedCube=Z;mstrApp.getRootController().afterQBProcess(true);}});};if(S===1){V.onOK();}else{if(!R.isManagedCube&&!mstrApp.isSingleTier){mstrmojo.qb.QBHelpers.showSaveAsDialog(V,B(this.model));}else{V.onOK();}}},onFinishButtonClick:function F(){this.handleFinish();},removeImportedSrc:function D(R){this.rootView.removeSrcs(R);},canDisplayCatalogSQL:function N(){return false;},handleServerRequestError:function A(S,Y,X,W,U){var R=this.proIdx;if(R<0){mstrmojo.DI.controller.DIDialogController.showErrorDialog(S,Y,X,W,U);}else{var V=this.model.urlSrc[R];if(V){V.errorMsg=Y;}if(X){X();}}}});}());(function(){mstrmojo.requiresCls("mstrmojo.hash","mstrmojo.qb.bigquery._BigQueryController");mstrmojo.requiresDescs(12385);var F=mstrmojo.hash,E=mstrmojo.desc;mstrmojo.qb.bigquery.RootController=mstrmojo.declare(mstrmojo.qb.EmmaController,[mstrmojo.qb.bigquery._BigQueryController],{scriptClass:"mstrmojo.qb.bigquery.RootController",isCloud:function C(){return mstrApp.isCloudPro;},getColumnsForDBTable:function A(G,H){this.model.getColumnsForDBTable(G,H);},attachDataChangeListeners:function D(H){var G=this.model;F.forEach(H,function(I,J){F.forEach(I,function(L,K){G.attachEventListener(K,J,L);});});},hasDBConnection:function B(){if(this.model.selectedProject){return true;}mstrmojo.alert(E(12385,"Please select a project first."));return false;}});}());(function(){mstrmojo.requiresCls("mstrmojo.Obj","mstrmojo._IsWebApp","mstrmojo.ServerProxy","mstrmojo.XHRServerTransport","mstrmojo.warehouse.WHModel","mstrmojo.warehouse.WHController","mstrmojo.qb.QBuilderPage","mstrmojo.qb.QBuilderModel","mstrmojo.qb.EmmaModel","mstrmojo.qb.RootController","mstrmojo.qb.EmmaController","mstrmojo.qb.bigquery.RootController","mstrmojo.qb.bigquery.ESRootView","mstrmojo.qb.bigquery.BigQueryBuilderPage","mstrmojo.qb.es.Model","mstrmojo.qb.es.Controller","mstrmojo.qb.EnumQBAppType","mstrmojo.qb.QBAlertDialog","mstrmojo.qb.thirdParty.Controller","mstrmojo.qb.thirdParty.Model","mstrmojo.qb.thirdParty.RootView","mstrmojo.DI.DIConstants","mstrmojo.string","mstrmojo.hash");mstrmojo.requiresDescs(37,889,1442,9944,11583,11584,11585,11622,11623,11624,11625,12569,12920,12921,12923,12941,5781,14297,12933);var O=mstrmojo.string,F=mstrmojo.DI.DIHelpers,X=mstrmojo.hash;var Q="QBwaitBox",a={scriptClass:"mstrmojo.Editor",id:Q,draggable:false,showTitle:false,zIndex:9999,cssClass:"mstrmojo-di-progressBar",children:[{scriptClass:"mstrmojo.ProgressBar",alias:"progress",cssClass:"mstrmojo-di-progress stripes"}],counter:0,displayMsg:null,ondisplayMsgChange:function J(){if(this.progress){this.progress.set("progressText",this.displayMsg);}},oncounterChange:function h(){var l=this.counter,n=this.visible;if(l===0&&n){this.close();}else{if(l>0&&!n){var k=mstrApp.container;var m={};if(k&&k.domNode){var j=mstrmojo.dom.position(k.domNode);if(j){m={top:j.y+"px"};}}this.open(null,m);}}}};var N=-2147215346,K=-2147071825,g=-2147212035,H=-2147206925,A=-2147206924,G=-2147209051,D=-2147207419,e=-2147071870,B=-2147216373,L=-2147214579;var f={};f[N]=mstrmojo.desc(11583,"Failed to execute query.");f[K]=mstrmojo.desc(11584,"Insufficient storage space to upload your data.");f[g]=mstrmojo.desc(11622,"Please unmap the attribute's non-key form first.");f[H]=mstrmojo.desc(11623,"Your session has expired.");f[A]=mstrmojo.desc(11623,"Your session has expired.");f[G]=mstrmojo.desc(11623,"Your session has expired.");f[D]=mstrmojo.desc(11623,"Your session has expired.");f[e]=mstrmojo.desc(11624,"No quota left to create cube.");f[B]=mstrmojo.desc(11625,"Failed to create report instance.");f[L]=mstrmojo.desc(12933,"You don't have enough privileges to perform this operation");var R="A61B85F4485D3B953003B195E58B5138";var C=mstrmojo.DI.DIConstants;function c(r,j,q){var n=mstrApp.isSingleTier?mstrmojo.desc(14297,"There is an error."):mstrmojo.desc(11585,"There is an error on the server."),p=mstrApp.getRootController(),u=r.code||(r.getResponseHeader&&r.getResponseHeader("X-MSTR-TaskErrorCode"))||"",l=r.message||(r.getResponseHeader&&r.getResponseHeader("X-MSTR-TaskFailureMsg"))||"",k="",o="",t;l=(l.length>2000)?l.substring(0,2000)+"...":l;t=l.replace(/com\.microstrategy(\.\w+)*: \(?/,"").replace(/\)$/,"");u=parseInt(u,10);switch(u){case N:if(p.model.FFSQLMode){k=l.replace(/com\.microstrategy(\.\w+)*: \(/,"").replace(/\)$/,"");if(k.match(/(.\s)*DataImport\)?\[(\d+)\](.\s)*/)){var m=parseInt(RegExp.$2,10);p.markFailureLabel(m);o=mstrmojo.desc(9944,"SQL Pass ## failed to execute.").replace("##",m);t=O.encodeHtmlString(k);}}t=O.htmlAngles(t);mstrmojo.qb.alert(o||f[u],t,j,null,q);break;case K:l=l.match(/currently using(.*)space/g)[0];l=l.match(/\d+../g);k=mstrmojo.desc(12920,"You are currently using ## of the allocated ### space.");mstrmojo.qb.alert(f[u],k.replace("##",l[0]).replace("###",l[1]),j,null,q);break;case g:mstrmojo.qb.alert(f[u],t,j,null,q);break;case e:mstrmojo.qb.alert(f[u],t,function(){mstrmojo.form.send({evt:"3124",src:mstrApp.name+".qbuilder.3124",relativePageNumber:"-1"},mstrApp.name,"POST",null,null,false);},null,q);break;case B:if(p.model.riid===R){mstrmojo.alert(mstrmojo.desc(12921,"Please contact your Administrator to update the Project Metadata."),function(){mstrApp.redirectToPage({evt:3010});});}else{mstrmojo.qb.alert(f[u],t,j,null,q);}break;case H:case A:case G:case D:if(mstrApp.isCloudPro){rrOpenHomePage&&rrOpenHomePage();}else{mstrmojo.form.send({evt:"3010"},mstrApp.name,"POST",null,null,false);}break;case L:mstrmojo.qb.alert(f[u],t,j,null,q);break;default:if(t){mstrmojo.qb.alert(n,t,j,null,q);}else{l=r.responseText;l=l&&l.match(/\[HttpException \(0x80004005\): (.)+\]/);mstrmojo.qb.alert(n,(l&&l[0]&&l[0].replace(/\[HttpException \(0x80004005\): |\]/gi,""))||mstrmojo.desc(5781,"Request timed out."),j,null,q);}break;}mstrmojo.all.WaitBoxTip&&mstrmojo.all.WaitBoxTip.closeWait();mstrmojo.all.waitBoxTipForAvailableTablesTree&&mstrmojo.all.waitBoxTipForAvailableTablesTree.closeWait();}function U(j){if(!!j&&j.taskId==="saveAndPublishCube"){if(!!j.msgID&&!!j.msgid){delete j.msgid;}}}mstrmojo.qb.QBApp=mstrmojo.declare(mstrmojo.Obj,[mstrmojo._IsWebApp],{scriptClass:"mstrmojo.qb.QBApp",isQB:true,enableWaitBox:true,getWaitBoxPosition:function(){var k=mstrApp.container;var l={};if(!F.getEnvObj().isAppSchema()){if(k&&k.domNode){var j=mstrmojo.dom.position(k.domNode,true);if(j){l={top:j.y};}}else{if(this.rootController&&this.rootController.rootView&&this.rootController.rootView.titleContainerNode){var o=mstrmojo.dom.position(this.rootController.rootView.titleContainerNode,true);if(o&&o.h!==0&&o.y!==0){l.top=o.h+o.y;}}}}else{if(k&&k.parent&&k.parent.domNode){var n=mstrmojo.dom.position(k.parent.domNode),m=48;if(n){l={top:n.y+n.h/2-m/2};}}}return l;},init:function Z(j){this._super(j);if(!this.serverProxy){this.serverProxy=new mstrmojo.ServerProxy({transport:mstrmojo.XHRServerTransport});}},start:function E(r,l){var p,k=mstrmojo.qb.EnumQBAppType,t,q,o=mstrmojo.hash.clone(l),n,j=C.backendSourceSubtype,m=false;switch(parseInt(r,10)){case k.BigQuery:mstrApp.isBigQuery=true;t=mstrApp.isFFSQL?C.xdaType.googleBigQueryFFSQL:C.xdaType.googleBigQuery;n=j.googleBigQuery;this.dbroleID=mstrApp.dbrid;p=this.rootController=new mstrmojo.qb.bigquery.RootController();p.dataService=mstrmojo.qb.DataService;o.id="QBuilderModel";p.model=new mstrmojo.qb.bigquery.Model(o);p.rootView=new mstrmojo.qb.bigquery.BigQueryBuilderPage({placeholder:this.placeholder});break;case k.BigQueryFFSQL:mstrApp.isBigQuery=true;t=mstrApp.isFFSQL?C.xdaType.googleBigQueryFFSQL:C.xdaType.googleBigQuery;n=j.googleBigQueryFFSQLModel;this.dbroleID=mstrApp.dbrid;p=this.rootController=mstrmojo.insert({scriptClass:l.rootControllerCls||"mstrmojo.qb.bigquery.RootController"});p.dataService=mstrmojo.qb.DataService;o.id="QBuilderModel";p.model=new mstrmojo.qb.bigquery.Model(o);p.rootView=new mstrmojo.qb.bigquery.BigQueryBuilderPage({placeholder:this.placeholder});break;case k.BigQuerySingleTable:mstrApp.isBigQuery=true;t=345;this.dbroleID=mstrApp.dbrid;p=this.rootController=mstrmojo.insert({scriptClass:l.rootControllerCls||"mstrmojo.qb.bigquery.ESController"});p.dataService=mstrmojo.qb.es.DataService;p.model=new mstrmojo.qb.bigquery.ESModel(o);p.rootView=new mstrmojo.qb.bigquery.ESRootView({placeholder:this.placeholder});this.msgid=this.msgID;break;case k.EmmaSingleTable:p=this.rootController=mstrmojo.insert({scriptClass:l.rootControllerCls||"mstrmojo.qb.es.Controller"});p.dataService=mstrmojo.qb.es.DataService;if(o.hasOwnProperty("emmaSingleIsForAlternateSource")){o.isForAlternateSource=o.emmaSingleIsForAlternateSource;delete o.emmaSingleIsForAlternateSource;}p.model=new mstrmojo.qb.es.Model(o);q={placeholder:this.placeholder};if(o.hasOwnProperty("emmaSingleAlertCfg")){q.alertCfg=o.emmaSingleAlertCfg;}p.rootView=new mstrmojo.qb.es.RootView(q);this.msgid=this.msgID;m=true;break;case k.MDX:p=this.rootController=new mstrmojo.qb.mdx.Controller();p.dataService=mstrmojo.qb.mdx.DataService;delete o.dbObjectsDisplayOptions;p.model=new mstrmojo.qb.mdx.Model(o);p.rootView=new mstrmojo.qb.mdx.RootView({placeholder:this.placeholder});this.msgid=this.msgID;break;case k.BISource:mstrApp.isBISource=true;t=mstrApp.isFFSQL?304:352;p=this.rootController=mstrmojo.insert({scriptClass:"mstrmojo.qb.thirdParty.Controller"});p.dataService=mstrmojo.qb.DataService;p.model=new mstrmojo.qb.thirdParty.Model(o);p.rootView=new mstrmojo.qb.thirdParty.RootView({placeholder:this.placeholder});break;default:t=mstrApp.isFFSQL?304:352;n=mstrApp.isFFSQL?j.customSQL:j.customSQLWizard;if(mstrApp.isEMMACube){p=this.rootController=mstrmojo.insert({scriptClass:l.rootControllerCls||"mstrmojo.qb.EmmaController"});p.dataService=mstrmojo.qb.DataService;o.canSupportDDA=mstrApp.canSupportDDA;o.shouldSupportDDA=mstrApp.shouldSupportDDA;o.dbridForDDA=mstrApp.dbridForDDA;o.isDDA=mstrApp.isDDA;o.ddaCheckboxID=mstrApp.ddaCheckboxID;p.model=new mstrmojo.qb.EmmaModel(o);p.model.set("id","QBuilderModel");m=true;}else{p=this.rootController=mstrmojo.insert({scriptClass:"mstrmojo.qb.RootController"});p.dataService=mstrmojo.qb.DataService;p.model=new mstrmojo.qb.QBuilderModel({id:"QBuilderModel"});}p.rootView=new mstrmojo.qb.QBuilderPage({placeholder:this.placeholder});break;}if(!m){p.model.dbObjects.populateDBProperties({});}p.rootView.inPageDialog=!!l.inPageDialog;p.start(t,n);},getRootController:function Y(j){var k=X.walk("container.launchingApp",mstrApp)||mstrApp.launchingApp;if(k&&(k.placeholder==="DIApp"||k.placeholder==="mainDIApp")&&j==="DI"){return k.getRootController();}return this.rootController;},hideProgress:function P(k){var l=mstrmojo.all.progressBar,j={manually:!!k};if(l){l.close(j);}},redirectToPage:function d(j){this.showWait();mstrmojo.form.send(j,mstrApp.name,"POST",null,null,false);},serverResponse:function M(n,k,l,j,m){mstrmojo.all[n][k](l,!!j,m);},serverRequest:function V(o,t,n,p,u,j,q,r){var m={},k;if(!o.sessionState&&this.sessionState){o.sessionState=this.sessionState;}o.msgid=j||mstrApp.msgid;U(o);if(typeof n==="object"){mstrmojo.hash.copy(n,m);}m.hideFailureErr=true;if(!p){k=t.failure;t.failure=function l(w){c(w,k,q);};}m.waitBoxCfg=r||{showCancel:false};m.waitBoxCfg.position=this.getWaitBoxPosition();m.waitBoxCfg.message=u;m.silent=!n;this._super(o,t,m);},serverRequestQueue:function W(l,m,j){if(F.getEnvObj().isWS()){this.serverRequestParallelNative(l,m,j);}else{var k=j||new mstrmojo.SimpleXHR();k.request("POST",mstrConfig.taskURL,{success:function(n){if(m.success){m.success(n);}},failure:function(n){if(m.failure){m.failure({code:n.getResponseHeader("X-MSTR-TaskErrorCode"),message:n.getResponseHeader("X-MSTR-TaskFailureMsg")});}},complete:function(){if(m.complete){m.complete();}}},l);}},serverRequestParallel:function I(l,q,k,m,r,j,n){if(k===true){this.showWait(r);}if(!l.sessionState&&this.sessionState){l.sessionState=this.sessionState;}l.msgid=j||mstrApp.msgid;try{var p=this;window.setTimeout(function(){var w=q.failure;q.failure=function u(z){c(z,w,n);};var x=mstrmojo.func.wrapMethods(q,{complete:function t(){if(k){p.hideWait();}}});window.setTimeout(p.serverProxy.serverRequestParallel.bind(p.serverProxy,l,{success:function(z){if(x.success){x.success(z);}},failure:function(z){if(x.failure){x.failure(z);}},complete:function(){if(x.complete){x.complete();}}},p.xhrQueue),0);},0);}catch(o){mstrmojo.err(o);}},showProgress:function S(j){if(!j){j={message:mstrmojo.desc(5720,"Waiting...")};}if(j.showCancel===undefined){j.showCancel=false;}if(j.showProgressText&&j.progressText){j.message=j.progressText;}this.showWait(j);},getSearchAutoCompleteDelay:mstrmojo.emptyFn,executeCommand:function b(j,l){var k=this.container&&this.container.launchingApp;if(k){return k.executeCommand(j,l);}}});window.$MAPF=function(){return false;};}());