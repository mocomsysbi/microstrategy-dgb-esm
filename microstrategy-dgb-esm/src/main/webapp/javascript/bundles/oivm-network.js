mstrmojo.chart.model.enums.EnumDSSGraphDataTextShowType={DssGraphDataTextNone:0,DssGraphDataTextValue:1,DssGraphDataTextLabel:2,DssGraphDataTextBoth:3,DssGraphDataTextAbs:4,DssGraphDataTextAbsValue:5,DssGraphDataTextAbsBoth:7,DssGraphDataTextTotal:8,DssGraphDataTextZValue:16,DssGraphDataTextPercent:32,DssGraphDataTextYValue:64,DssGraphDataTextInternal:128,DssGraphDataTextSeriesDependent:256,DssGraphDataTextQualityObjectMode:512};mstrmojo.chart.enums.EnumGraphMajorType={GMT_INVALID:0,GMT_CATEGORY:1,GMT_PIE:2,GMT_SCATTER:3,GMT_POLAR:4,GMT_RADAR:5,GMT_BUBBLE:6,GMT_STOCK:7,GMT_HISTOGRAM:8,GMT_GAUGE:9,GMT_FUNNEL:10,GMT_BOX:11,GMT_GANTT:12,GMT_SPECTRAL:13,GMT_TABLE:14,GMT_3D_CATEGORY:15,GMT_3D_SCATTER:16,GMT_GRID:17};mstrmojo.warehouse.EnumDatabaseType={SAP:1200,MSAS:1500,EssBase:1600,TM1:2900,SAPHana:4000,BDE:5400,SearchEngineSOLR:5500,Hive:3100,Impala:4100,SearchEngineSPLUNK:5600,Pig:6400,PHOENIX:6800,IBMBigInsights:700,Drill:7300,DB_TYPE_NEWDB_1:8100,DB_TYPE_NEWDB_5:8500,AzureCosmosDB:8700};mstrmojo.chart.model.enums.EnumDSSGraphObject={DssGraphNull:-3,DssGraphBackground:1,DssGraphFrame:2,DssGraphFootnote:3,DssGraphSubtitle:4,DssGraphTitle:5,DssGraphLegendArea:6,DssGraphLegendLine:7,DssGraphLegendMarker:8,DssGraphLegendText:9,DssGraphCurve:257,DssGraphDataLine:258,DssGraphDataMarker:259,DssGraphDataText:260,DssGraphDivBiPolar:261,DssGraphErrorBar:262,DssGraphLinrExp:263,DssGraphLinrLine:264,DssGraphLinrLog:265,DssGraphLinrNatLog:266,DssGraphLinrNPoly:267,DssGraphLinrText:268,DssGraphMeanLine:269,DssGraphMovAvgLine:270,DssGraphO1Body:271,DssGraph2DO1Label:272,DssGraphO1Major:273,DssGraphO1Minor:274,DssGraphO1Super:275,DssGraphO1Title:276,DssGraphO2Body:277,DssGraph2DO2Label:278,DssGraphO2Major:279,DssGraphO2Minor:280,DssGraphO2Title:281,DssGraphConnectDataLine:282,DssGraphRiser:286,DssGraphRiserShadow:287,DssGraphStdDevLine:288,DssGraphX1Body:289,DssGraphX1Label:290,DssGraphX1Major:291,DssGraphX1Minor:292,DssGraphXTitle:293,DssGraphY1Body:295,DssGraphY1Label:296,DssGraphY1Major:297,DssGraphY1Minor:298,DssGraphY1Title:299,DssGraphY2Body:301,DssGraphY2Label:302,DssGraphY2Major:303,DssGraphY2Minor:304,DssGraphY2Title:305,DssGraph3DShowColumnHeaders:318,DssGraph3DShowLeftHeaders:321,DssGraph3DShowRightHeaders:323,DssGraph3DShowRowHeaders:325,DssGraphOBPBox:329,DssGraphOBPMedian:330,DssGraphOBPStem:331,DssGraphOBPTail:332,DssGraphPieFeelerLine:337,DssGraphPieFeelerLabel:338,DssGraphPieGroupLabel:339,DssGraphPieRingLabel:340,DssGraphPieSlice:341,DssGraphSeriesTitle:398,DssGraphConnectStackLine:399,DssGraphDataTextStackTotal:401,DssGraphOPILBLValue:418,DssGraphUserLine1:414,DssGraphUserLine2:415,DssGraphUserLine3:416,DssGraphUserLine4:417,DssGraphDataTextConnectLine:431,DssGraphGauge:444,DssGraphGaugeTitle:450,DssGraphGaugeRange:451,DssGraphY3Body:477,DssGraphY3Label:478,DssGraphY3Major:479,DssGraphY3Minor:480,DssGraphY4Body:483,DssGraphY4Label:484,DssGraphY4Major:485,DssGraphY4Minor:486,DssGraph3DColHeader:512,DssGraph3DColTitle:515,DssGraph3DDataText:518,DssGraph3DRowHeader:552,DssGraph3DRowTitle:555,DssGraph3DRYHeader:558,DssGraph3DRYTitle:561,DssGraphGaugeBorder:1319,DssGraphGaugeNeedleBase:1320,DssGraphGaugeNeedleBaseLine:1330,DssGraphZBody:10003,DssGraphTrendLine:10004,DssGraphY1RightBody:10005,DssGraphY1RightTitle:10006,DssGraphReferenceLine:10007,DssGraphStraightLine:10008,DssGraphTargetLine:10009,DssGraphRefLineText:10010,DssGraphTrendLineText:10011,DssGraphUserLabel1:100100,DssGraphUserLabel2:100101,DssGraphUserLabel3:100102,DssGraphUserLabel4:100103,DssGraphX2Body:100200,DssGraphX2Label:100201,DssGraphX2Major:100202,DssGraphX2Minor:100203,DssGraphX2Title:100204};mstrmojo.vi.viz.EnumDSSDropZones={Reserved:0,Rows:1,Columns:2,XAxis:3,YAxis:4,BreakBy:5,SliceBy:6,ColorBy:7,SizeBy:8,AdditionalMetrics:9,Angle:10,Grouping:11,GeoAttribute:12,Layout:13,FromItem:14,ToItem:15,ItemSize:16,Latitude:17,Longitude:18,Metric:19,Trend:20};mstrmojo.chart.enums.EnumLineStyle={LS_SOLID:0,LS_DASH:1,LS_DOT:2,LS_DOT_DASH:3,LS_DASH_DOT_DOT:4,LS_MEDIUM_DASH:5,LS_SHORT_DASH:6,LS_LONGEST_DASH:7,LS_LONG_DOT:8,LS_DOT_DOT_DOT:9,LS_DASH_DASH_DOT:10,LS_DASH_DASH_DOT_DOT:11,LS_LONG_DASH_DOT:12,LS_LONG_DASH_DOT_DOT:13,LS_LONG_DASH_DASH:14,LS_LONG_DASH_DASH_DASH:15,LS_GRADIENT:16,LS_NONE:99};mstrmojo.vi.enums.EnumFilterClearActionType={CLEAR_ALL:0,CLEAR_KEEP_ONLY:1,CLEAR_ADV_QUALIFICATION:2,CLEAR_LINKING:3,CLEAR_KEEP_ONLY_AND_LINKING:4,CLEAR_DRILLING:5};mstrmojo.chart.model.enums.EnumDSSGraphProperty={DssGraphTextContent:9999,DssGraphContent:9999,DssGraphPropertyReserved:0,DssGraphAutoFitO1:4,DssGraphAutoFitO2:5,DssGraphAutoFitX:6,DssGraphAutoFitY1:7,DssGraphAutoFitY2:8,DssGraphGroupSpacing:10,DssGraphRiserWidth:11,DssGraphColorBySeries:12,DssGraphCurveColorAsSeries:13,DssGraphSDMOVAFactor:14,DssGraph2DAngle:18,DssGraph2DDepth:20,DssGraphDepthMode:21,DssGraph2ScaleDirectionX:22,DssGraph2ScaleDirectionY1:23,DssGraph2ScaleDirectionY2:24,DssGraph2ExcludeZeroX:25,DssGraph2ExcludeZeroY1:26,DssGraph2ExcludeZeroY2:27,DssGraphFormatDataTextX:28,DssGraphFormatDataTextY1:29,DssGraphFormatDataTextY2:30,DssGraphFormatX:33,DssGraphFormatY1:34,DssGraphFormatY2:35,DssGraphFormatZ:36,DssGraphGridLineO1:37,DssGraphGridLineO2:38,DssGraphGridLineX:39,DssGraphGridLineY1:40,DssGraphGridLineY2:41,DssGraphLabelModeO1:48,DssGraphLabelModeO2:49,DssGraphLegendLocation:52,DssGraphTitleXLocation:54,DssGraphTitleY1Location:55,DssGraphTitleY2Location:56,DssGraph2LogScaleX:57,DssGraph2LogScaleY1:58,DssGraph2LogScaleY2:59,DssGraphMarkerShape:60,DssGraphMarkerSize:61,DssGraph2DPlaceX:65,DssGraph2DPlaceY1:66,DssGraph2DPlaceY2:67,DssGraphConnectLine:68,DssGraphShowStepLine:70,DssGraph2ScaleEndX:74,DssGraph2ScaleEndY1:75,DssGraph2ScaleEndY2:76,DssGraph2DScaleFreqO1:87,DssGraph2DScaleFreqO2:88,DssGraph2DScaleFreqX:89,DssGraph2DScaleFreqY1:90,DssGraph2DScaleFreqY2:91,DssGraphScaleX:92,DssGraphScaleY1:93,DssGraphScaleY2:94,DssGraphShowSDDataLineType:96,DssGraphSDRiserType:97,DssGraphShowSDLine:98,DssGraphShowSDCurve:99,DssGraphShowSDLinrCorr:101,DssGraphShowSDLinrExp:102,DssGraphShowSDLinrFormula:103,DssGraphShowSDLinrLine:104,DssGraphShowSDLinrLog:105,DssGraphShowSDLinrNatLog:106,DssGraphShowSDLinrNPoly:107,DssGraphSDPolyFactor:108,DssGraphShowSDMeanLine:109,DssGraphShowSDMOVALine:110,DssGraphShowSDSTDDLine:111,DssGraphShowDataText:113,DssGraphShowDivBiPolar:114,DssGraphShowErrorBar:115,DssGraphShowLegendText:116,DssGraphShow2DO1Label:117,DssGraphShow2DO1:-117,DssGraphShow2DO2:118,DssGraphOffScaleTypeX:119,DssGraphOffScaleTypeY1:120,DssGraphOffScaleTypeY2:121,DssGraphShowQuadrants:122,DssGraphShowRiserShadows:123,DssGraphShow2DXTitle:124,DssGraphShow2DY1Title:125,DssGraphShow2DY2Title:126,DssGraphShow2DXLabel:127,DssGraphShow2DX:-127,DssGraphShow2DY1Label:128,DssGraphShow2DY1:-128,DssGraphShow2DY2Label:129,DssGraphShow2DY2:-129,DssGraphShowZeroLineX:130,DssGraphShowZeroLineY1:131,DssGraphShowZeroLineY2:132,DssGraph2DSideO1:133,DssGraph2DSideO2:134,DssGraph2DSideX:135,DssGraph2DSideY1:136,DssGraph2DSideY2:137,DssGraph2DSDSplitY:140,DssGraphStaggerO1:142,DssGraphStaggerO2:143,DssGraphStaggerX:144,DssGraphStaggerY1:145,DssGraphStaggerY2:146,DssGraphUniformBorders:148,DssGraphPieDepthValue:192,DssGraphPieHoleSizeValue:198,DssGraphPieInset:200,DssGraphPiesPerRowValue:201,DssGraphPieRotationValue:202,DssGraphShowFeeler:204,DssGraphShowLBLFeelerLabel:205,DssGraphShowLBLFeeler:-205,DssGraphShowLBLPie:206,DssGraphShowLBLRing:207,DssGraphDeleteSlice:208,DssGraphDetachSlice:209,DssGraphPieRestore:210,DssGraphPieTiltValue:211,DssGraphPieTiltOn:212,DssGraphShowPolarCoordinateAxis:215,DssGraphShowPolarConnectLines:218,DssGraphStockDataValueType:222,DssGraphShowBubbleGrid:245,DssGraphSDShowDataText:247,DssGraphShowTitleSeries:248,DssGraphConnectStackBars:249,DssGraphLegendBox:250,DssGraphLinkColors:260,DssGraph3DCustomView:265,DssGraph3DGridFloor:277,DssGraph3DGridLWall:278,DssGraph3DGridRiser:279,DssGraph3DGridRWall:280,DssGraph3DColTitleLocation:285,DssGraph3DLYTitleLocation:287,DssGraph3DRowTitleLocation:288,DssGraph3DRYTitleLocation:289,DssGraph3DScalefreqX:299,DssGraph3DScalefreqY:300,DssGraph3DScalefreqZ:301,DssGraphShow3DScatterLine:308,DssGraphShow3DLineToLWall:309,DssGraphShow3DLineToFloor:310,DssGraphShow3DLineToRWall:311,DssGraphSD3DRiserType:312,DssGraphShow3DShowDataLabelsBox:313,DssGraph3DOffScaleTypeX:314,DssGraph3DOffScaleTypeY:315,DssGraph3DOffScaleTypeZ:316,DssGraphShow3DCHeader:318,DssGraphShow3DColTitle:319,DssGraph3DShowDataText:320,DssGraphShow3DLNumber:321,DssGraphShow3DLYTitle:322,DssGraphShow3DRNumber:323,DssGraphShow3DRYTitle:324,DssGraphShow3DRHeader:325,DssGraphShow3DRowTitle:326,DssGraphShow3DFloor:327,DssGraphShow3DLegend:328,DssGraphShow3DLWall:329,DssGraphShow3DRWall:330,DssGraph3DViewStruct:337,DssGraphACMColorModel:549,DssGraphLegendItems:554,DssGraphSeriesColor:556,DssGraphReverseGroup:558,DssGraphReverseSeries:559,DssGraphSeriesByColumn:560,DssGraphAreaBackColor:561,DssGraphAreaTransparency:563,DssGraphAreaColor:564,DssGraphAreaPattern:566,DssGraphAreaSFX:567,DssGraphFontAlign:570,DssGraphFontTransparency:573,DssGraphFontColor:574,DssGraphFontName:576,DssGraphFontRotation:578,DssGraphVirtualFontSize:583,DssGraphFontStyle:584,DssGraphType:585,DssGraphLineTransparency:587,DssGraphLineColor:588,DssGraphLinePattern:589,DssGraphVirtualLineWidth:591,DssGraphFootnoteLocation:592,DssGraphFrameLocation:593,DssGraphSubTitleLocation:594,DssGraphTitleLocation:595,DssGraphShowfootnote:596,DssGraphShowSubtitle:597,DssGraphShowTitle:598,DssGraphFontBox:601,DssGraphFontSize:603,DssGraphLockFontSize:604,DssGraphLineWidth:605,DssGraphAreaAlpha:608,DssGraphLineAlpha:609,DssGraphFontAlpha:610,DssGraphAreaCustomBevelEffect:612,DssGraphFormatDataTextAdv:616,DssGraphFormatXAdv:618,DssGraphFormatY1Adv:619,DssGraphFormatY2Adv:620,DssGraphFormatZAdv:621,DssGraphMiddleValue:630,DssGraphSplitYPosition:631,DssGraphAxisShowUserLine:632,DssGraphAxisUserLineValue:633,DssGraphAxisUserLineAxis:634,DssGraphMarkerLayout:637,DssGraphPieDataValueLoc:638,DssGraphPieDataLabelLoc:639,DssGraph2DOrdSpaceMode:642,DssGraphLegendLock:644,DssGraphGridStepY1:645,DssGraphGridStepY2:646,DssGraphGridStepX:647,DssGraphDataTextShowConnectLine:652,DssGraphGridLineZ:658,DssGraphScaleZ:659,DssGraphStaggerZ:660,DssGraph2ScaleEndZ:662,DssGraph2ExcludeZeroZ:663,DssGraph2ScaleDirectionZ:664,DssGraphGridStepZ:665,DssGraphGaugeInfo:668,DssGraphGaugeFancyBox:669,DssGraphSDMarkerSize:671,DssGraphSDMarkerShape:683,DssGraphMetric1:690,DssGraphMetric2:691,DssGraphStockStyle:692,DssGraph2ScaleDirectionY3:693,DssGraph2ExcludeZeroY3:694,DssGraphGridLineY3:697,DssGraphFormatY3Adv:699,DssGraphGridStepY3:701,DssGraphOffScaleTypeY3:702,DssGraphShow2DY3:704,DssGraph2DSideY3:706,DssGraphStaggerY3:707,DssGraph2DPlaceY3:709,DssGraph2ScaleEndY3:710,DssGraph2DScaleFreqY3:713,DssGraphScaleY3:714,DssGraph2ScaleDirectionY4:715,DssGraph2ExcludeZeroY4:716,DssGraphGridLineY4:719,DssGraphFormatY4Adv:721,DssGraphGridStepY4:723,DssGraphOffScaleTypeY4:724,DssGraphShow2DY4:726,DssGraph2DSideY4:728,DssGraphStaggerY4:729,DssGraph2DPlaceY4:731,DssGraph2ScaleEndY4:732,DssGraph2DScaleFreqY4:735,DssGraphScaleY4:736,DssGraphSpiderLines:739,DssGraphPolarStartAngle:740,DssGraphMetric3:742,DssGraphRadarCircularDataLines:782,DssGraphRemoteAxis:784,DssGraphConnectFirstLast:790,DssGraphGaugeShowAxisLabelsOutside:791,DssGraphGaugeShowNeedle:792,DssGraphTailShape:793,DssGraphPieForceRound:794,DssGraphGaugeStyleValue:795,DssGraphGaugeBorderStyleValue:796,DssGraphGaugeBorderThicknessValue:797,DssGraphGaugeRangeThicknessValue:798,DssGraphGaugeRangeStartAngleValue:799,DssGraphGaugeRangeStopAngleValue:800,DssGraphGaugeNeedleStyleValue:801,DssGraphCurvedLines:804,DssGraphAreaBevelEffect:879,DssGraphFontAntiAlias:881,DssGraphFormatDataTextY3:695,DssGraphFormatDataTextY4:717,DssGraphColorPalette:10000,DssGraphOriContent:10001,DssGraphFillEffect:10002,DssGraphGradient:10003,DssGraphSDShowToolTip:10004,DssGraphSDToolTip:10005,DssGraphSDRegressionType:10006,DssGraph2LogScale:10007,DssGraphManualMajor:10008,DssGraphManualMinor:10009,DssGraph2ScaleDirection:10010,DssGraphShow2DAxisLine:10011,DssGraph2ExcludeZero:10012,DssGraph2ScaleUseMax:10013,DssGraph2ScaleUseMin:10014,DssGraph2ScaleMax:10015,DssGraph2ScaleMin:10016,DssGraphShow2DAxisLabels:10017,DssGraph2ScaleEndMax:10018,DssGraph2ScaleEndMin:10019,DssGraphShow2DAxisMajor:10020,DssGraphShow2DAxisMinor:10021,DssGraph2DSide:10022,DssGraphStyleMajor:10023,DssGraphStyleMinor:10024,DssGraphCountMajor:10025,DssGraphCountMinor:10026,DssGraphShowTotalValue:10027,DssGraph2DPie:10028,DssGraphShowDataValue:10029,DssGraphShowDVPercent:10030,DssGraphShowDataLabel:10031,DssGraphShowPieLabelOnSide:10032,DssGraphShowMarker:10033,DssGraphShowMetric1:10034,DssGraphShowMetric2:10035,DssGraphShowMetric3:10036,DssGraphMetric1Style:10037,DssGraphMetric2Style:10038,DssGraphMetric3Style:10039,DssGraphShowLine:10040,DssGraphShowToolTip:10041,DssGraphToolTip:10042,DssGraphAxisAutoFit:10043,DssGraphAxisStagger:10044,DssGraphAxisScaleFreq:10045,DssGraphMetric1Value:10046,DssGraphMetric2Value:10047,DssGraphMetric3Value:10048,DssGraph2AxisFormatText:10049,DssGraph2AxisFormatDataText:10050,DssGraphDPI:10051,DssGraphDocSize:10052,DssGraphAutoArrange:10053,DssGraph2DSplitYAutomatic:10054,DssGraphHistogramRangeMin:10055,DssGraphHistogramRangeMax:10056,DssGraphHistogramBuckets:10057,DssGraphGaugeSAngle:10058,DssGraphGaugeEAngle:10059,DssGraphGaugeThickness:10060,DssGraphGauge1Show:10061,DssGraphGauge1Min:10062,DssGraphGauge1Max:10063,DssGraphGauge2Show:10064,DssGraphGauge2Min:10065,DssGraphGauge2Max:10066,DssGraphGauge3Show:10067,DssGraphGauge3Min:10068,DssGraphGauge3Max:10069,DssGraphGauge4Show:10070,DssGraphGauge4Min:10071,DssGraphGauge4Max:10072,DssGraphGauge5Show:10073,DssGraphGauge5Min:10074,DssGraphGauge5Max:10075,DssGraphAxisDataTextPlace:10076,DssGraphAxisNumberFormat:10077,DssGraphAxisDataNumberFormat:10078,DssGraphAxisHasErrorBar:10079,DssGraphAxisHasMiddleValue:10080,DssGraphHeight:10081,DssGraphWidth:10082,DssGraphPicture:10083,DssGraph3DTurnXCounterClockwise:10084,DssGraph3DTurnYCounterClockwise:10085,DssGraph3DTurnZCounterClockwise:10086,DssGraph3DTurnXClockwise:10087,DssGraph3DTurnYClockwise:10088,DssGraph3DTurnZClockwise:10089,DssGraph3DMoveXTowardsOrigin:10090,DssGraph3DMoveYTowardsOrigin:10091,DssGraph3DMoveZTowardsOrigin:10092,DssGraph3DMoveXAwayFromOrigin:10093,DssGraph3DMoveYAwayFromOrigin:10094,DssGraph3DMoveZAwayFromOrigin:10095,DssGraph3DDecreaseCubeX:10096,DssGraph3DDecreaseCubeY:10097,DssGraph3DDecreaseCubeZ:10098,DssGraph3DIncreaseCubeX:10099,DssGraph3DIncreaseCubeY:10100,DssGraph3DIncreaseCubeZ:10101,DssGraph3DDecreaseWallX:10102,DssGraph3DDecreaseWallY:10103,DssGraph3DDecreaseWallZ:10104,DssGraph3DIncreaseWallX:10105,DssGraph3DIncreaseWallY:10106,DssGraph3DIncreaseWallZ:10107,DssGraph3DPanXLeft:10108,DssGraph3DPanYUp:10109,DssGraph3DRelative:10110,DssGraph3DPanXRight:10111,DssGraph3DPanYDown:10112,DssGraph3DAbsolute:10113,DssGraph3DZoomIn:10114,DssGraph3DIncreasePerspectiveDistortion:10115,DssGraph3DStepSize:10116,DssGraph3DZoomOut:10117,DssGraph3DDecreasePerspectiveDistortion:10118,DssGraph3DInitMatrix:10119,DssGraphGaugeQBShow:10120,DssGraphGaugeQBStart:10121,DssGraphGaugeQBStop:10122,DssGraphEnhancedSeriesEffect:10123,DssGraphLocale:10124,DssGraph3DViewStructName:10125,DssGraphLabelsDistance:10126,DssGraphLegendDetails:10127,DssGraphDefaultsInitialized:10128,DssGraphShow3DAxisMajor:10129,DssGraphGradientColorMode:10130,DssGraphLegendDetailsNEW:10131,DssGraphFrameLocationNEW:10132,DssGraph3DColTitleLocationNEW:10133,DssGraph3DRowTitleLocationNEW:10134,DssGraphLabelsDistanceNEW:10135,DssGraphDocSizeNEW:10136,DssGraphUseManualHistogramBuckets:10137,DssGraphFontSize100:10138,DssGraphUseSpecialSeries:10140,DssGraphIsOnlyAdditionalMetrics:10170};(function(){function B(L,Q,N){var M,O;M=0;if(N){M=Math.max(L,L-Q);M=Math.max(M,-Q);}else{M=L-Q;}if(M===0){this.mIsShown=false;return 1;}var P=M;O=1;while(M<1){M*=10;O/=10;}while(M>=10){M/=10;O*=10;}if(M<1.8){O*=2;O/=10;}else{if(M<3.1){O*=4;O/=10;}else{if(M<4.6){O*=5;O/=10;}else{if(M>=8.1){O*=2;}}}}return O;}function K(P){var L,N;this.mStep=B.call(this,this.mMaximum,this.mMinimum,P.mAlwaysIncludeZero);this.mMaxTick=Math.ceil(this.mMaximum/this.mStep)*this.mStep;this.mMinTick=Math.floor(this.mMinimum/this.mStep)*this.mStep;this.mMinTick=(this.mMinTick*this.mMinimum<0)?0:this.mMinTick;if(P.mAlwaysIncludeZero){this.mMaxTick=(this.mMaximum<0)?0:this.mMaxTick;this.mMinTick=(this.mMinimum>0)?0:this.mMinTick;}var M=this.mMaxTick-this.mMinTick;if(this.mStep>=M){return ;}L=Math.floor((this.mMaxTick-this.mMinTick+this.mStep/100)/this.mStep)+1;for(N=1;N<L-1;++N){var O=this.mMinTick+N*this.mStep;this.mTicks.push(O);}}function C(M){var L;this.mMaxTick=1;this.mStep=this.mMinimum<0?0.2:0.1;if(M.mUseCustomMinMax){this.mMaxTick=M.mAxisMaxValue;this.mMinTick=M.mAxisMinValue;this.mMaxTick=Math.min(1,this.mMaxTick);this.mMinTick=Math.max(-1,this.mMinTick);this.mStep=0.1;}else{if(this.mMaximum>=0.5){this.mMaxTick=1;this.mMinTick=Math.floor(this.mMinimum/this.mStep)*this.mStep;this.mMinTick=(this.mMinTick*this.mMinimum<0)?0:(this.mMinTick>0?0:this.mMinTick);if(this.mMinimum<-0.5){this.mMinTick=-1;}}else{if(this.mMaximum>0){this.mMaxTick=Math.ceil(this.mMaximum/this.mStep)*this.mStep;this.mMinTick=-1;}else{this.mStep=0.1;this.mMaxTick=0;this.mMinTick=-1;}}}for(L=this.mMinTick+this.mStep;L+0.01<this.mMaxTick;L+=this.mStep){this.mTicks.push(Math.round(L*100)/100);}}function I(L){return Math.log(L)/Math.log(10);}function H(O){var N,L,M;this.mStep=1;if(this.mMaximum<=0){this.mMinTick=1;this.mMaxTick=10;return ;}if(this.mMinimum<=0){L=this.mMaximum>1?0:-1;this.mMinTick=Math.pow(10,L);if(O.mUseCustomMinMax){this.mMaxTick=this.mMaximum;N=Math.floor(I.call(this,this.mMaximum));if(I.call(this,this.mMaximum)===N){N--;}}else{N=Math.ceil(I.call(this,this.mMaximum));this.mMaxTick=Math.pow(10,N);}for(M=L+1;M<N;++M){this.mTicks.push(Math.pow(10,Math.floor(M)));}return ;}if(O.mUseCustomMinMax){N=I.call(this,this.mMaximum);L=I.call(this,this.mMinimum);this.mMaxTick=this.mMaximum;this.mMinTick=this.mMinimum;}else{N=Math.ceil(I.call(this,this.mMaximum));L=Math.floor(I.call(this,this.mMinimum));this.mMaxTick=Math.pow(10,N);this.mMinTick=Math.pow(10,L);}for(M=L+1;M<N;++M){this.mTicks.push(Math.pow(10,Math.floor(M)));}}function J(L){this.mTicks.splice(0,this.mTicks.length);if(this.mIsPercent){return C.call(this,L);}if(L.mUseLogarithmicScale){return H.call(this,L);}K.call(this,L);}function G(Q){if(Q.mUseCustomMinMax||Q.mUseLogarithmicScale){return ;}var M=0.1,O=false,L=false,P=[];this.GetTicks(P);if(P.length>=2){var N=P.length;L=((Math.abs(this.mMaximum-P[N-2])<M*this.mStep));O=((Math.abs(this.mMinimum-P[1])<M*this.mStep));if(this.mIsPercent){L=false;}}if(L&&O){this.mMinTick=this.mMinimum;this.mMaxTick=this.mMaximum;Q.mUseMinValue=Q.mShowMinLabel=true;Q.mUseMaxValue=Q.mShowMaxLabel=true;}else{if(L){this.mMaxTick=this.mMaximum;Q.mUseMaxValue=Q.mShowMaxLabel=true;}else{if(O){this.mMinTick=this.mMinimum;Q.mUseMinValue=Q.mShowMinLabel=true;}else{}}}if(Q.mAlwaysIncludeZero){this.mMaxTick=(this.mMaximum<0)?0:this.mMaxTick;this.mMinTick=(this.mMinimum>0)?0:this.mMinTick;}}mstrmojo.chart.common.ScalePlate=mstrmojo.provide("mstrmojo.chart.common.ScalePlate",{mOptions:{mShowMinLabel:true,mShowMaxLabel:true},isStackedChart:false,mStep:0,mIsPercent:false,mMinimum:0,mMaximum:0,mMaxTick:0,mMinTick:0,mTicks:[],clear:function F(){this.isStackedChart=this.mIsPercent=false;this.mMinimum=this.mMaximum=0;this.mMinTick=this.mMaxTick=0;this.mStep=0;this.mTicks=[];},GetTicks:function A(M){if(this.mOptions.mShowMinLabel){M.push(this.mMinTick);}var L;for(L=0;L<this.mTicks.length;++L){M.push(this.mTicks[L]);}if(this.mOptions.mShowMaxLabel){M.push(this.mMaxTick);}},getMaxMinTickValue:function D(O,N,L,M){this.computeTicks(O,N,L,M);return{Max:this.mMaxTick,Min:this.mMinTick};},computeTicks:function E(Q,P,L,N){this.mMinimum=N;this.mMaximum=L;this.mIsPercent=!!(P&1);this.isStackedChart=!!(P&2);var O=1e-14;if(!Q.mUseLogarithmicScale&&this.isStackedChart){this.mMinimum=Math.min(this.mMinimum,0);this.mMaximum=Math.max(this.mMaximum,0);}if(Q.mDrawCustomLine){this.mMinimum=Math.min(this.mMinimum,Q.mAxisCustomValue);this.mMaximum=Math.max(this.mMaximum,Q.mAxisCustomValue);}if(this.mIsPercent&&this.mMinimum===this.mMaximum&&1===this.mMaximum){if(this.mMinimum===1){this.mMinimum=0;}}if(Math.abs(this.mMinimum-this.mMaximum)<O){if(this.mMinimum<-O||this.mMinimum>O){var M=Math.abs(this.mMinimum)*0.5;this.mMaximum=this.mMaximum+M;this.mMinimum=this.mMinimum-M;}else{this.mMinimum=-6;this.mMaximum=6;}}J.call(this,Q);if(Q.mUseLogarithmicScale&&this.isStackedChart){this.mMaximum=Q.mDrawCustomLine?Math.max(this.mMaximum+this.mMinTick,Q.mAxisCustomValue):this.mMaximum+this.mMinTick;this.mMinimum=Math.min(this.mMinimum,0);this.mTicks.splice(0,this.mTicks.length);H.call(this,Q);}G.call(this,Q);}});}());mstrmojo.vi.viz.EnumVisualizationTemplates={UNKNOWN_GRAPHMATRIX_TYPE:-1,GRID:0,HEATMAP:1,GOOGLEMAP:2,PIE:3,RING:4,GRAPHMATRIXVERTICALBARSTACKED:6,GRAPHMATRIXVERTICALBARCLUSTERED:7,GRAPHMATRIXVERTICALBARPERCENT:8,GRAPHMATRIXHORIZONTALBARSTACKED:9,GRAPHMATRIXHORIZONTALBARCLUSTERED:10,GRAPHMATRIXHORIZONTALBARPERCENT:11,GRAPHMATRIXVERTICALLINESTACKED:12,GRAPHMATRIXVERTICALLINECLUSTERED:13,GRAPHMATRIXVERTICALLINEPERCENT:14,GRAPHMATRIXHORIZONTALLINESTACKED:15,GRAPHMATRIXHORIZONTALLINECLUSTERED:16,GRAPHMATRIXHORIZONTALLINEPERCENT:17,GRAPHMATRIXSCATTERCIRCLEMM:18,GRAPHMATRIXSCATTERGRIDCIRCLEAA:19,GRAPHMATRIXBUBBLECIRCLEMM:21,GRAPHMATRIXBUBBLEGRIDCIRCLEAA:22,GRAPHMATRIXSCATTERSQUAREAM:23,GRAPHMATRIXSCATTERSQUAREMM:24,GRAPHMATRIXSCATTERGRIDSQUAREAA:25,GRAPHMATRIXBUBBLESQUAREAM:26,GRAPHMATRIXBUBBLESQUAREMM:27,GRAPHMATRIXBUBBLEGRIDSQUAREAA:28,GRAPHHORIZONTALBARCLUSTERED:29,GRAPHMATRIXVERTICALAREASTACKED:30,GRAPHMATRIXVERTICALAREAPERCENT:31,GRAPHMATRIXVERTICALAREACLUSTERED:32,GRAPHMATRIXHORIZONTALAREASTACKED:40,GRAPHMATRIXHORIZONTALAREAPERCENT:41,GRAPHMATRIXHORIZONTALAREACLUSTERED:42,GRAPHHORIZONTALBARDUALAXISCLUSTERED:33,GRAPHHORIZONTALBARDUALAXISABSOLUTE:34,GRAPHHORIZONTALLINEABSOLUTE:35,GRAPHHORIZONTALLINEDUALAXISABSOLUTE:36,GRAPHHORIZONTALAREAABSOLUTE:37,GRAPHHORIZONTALAREADUALAXISABSOLUTE:38,GRAPHVERTICALBARCLUSTERED:39,GRAPHVERTICALBARDUALAXISCLUSTERED:43,GRAPHVERTICALBARDUALAXISABSOLUTE:44,GRAPHVERTICALBARDUALAXISSTACKED:45,GRAPHVERTICALLINEABSOLUTE:46,GRAPHVERTICALLINESTACKED:47,GRAPHVERTICALLINEPERCENT:48,GRAPHVERTICALLINEDUALAXISABSOLUTE:49,GRAPHVERTICALLINEDUALAXISSTACKED:50,GRAPHVERTICALAREAABSOLUTE:51,GRAPHVERTICALAREAPERCENT:52,GRAPHVERTICALAREASTACKED:53,GRAPHVERTICALAREADUALAXISABSOLUTE:54,GRAPHVERTICALAREADUALAXISSTACKED:55,GRAPHCOMBINATIONBARAREA:56,GRAPHCOMBINATIONBARAREADUALAXIS:57,NETWORK:58,IMAGELAYOUT:59,GOOGLEMAPDENSITY:60,GRAPHMATRIXPIE:61,GRAPHMATRIXRING:62,GRAPHHORIZONTALBARABSOLUTE:63,GRAPHHORIZONTALBARPERCENT:64,GRAPHHORIZONTALBARSTACKED:65,GRAPHVERTICALBARABSOLUTE:66,GRAPHVERTICALBARPERCENT:67,GRAPHVERTICALBARSTACKED:68,ESRIMAP:69,GRAPHMATRIXVERTICALBARAUTOMATIC:70,GRAPHMATRIXHORIZONTALBARAUTOMATIC:71,GRAPHMATRIXVERTICALLINEAUTOMATIC:72,GRAPHMATRIXHORIZONTALLINEAUTOMATIC:73,GRAPHMATRIXVERTICALAREAAUTOMATIC:74,GRAPHMATRIXHORIZONTALAREAAUTOMATIC:75,GRAPHMATRIXVERTICALHISTOGRAM:76,GRAPHMATRIXGRIDCHART:78,GRAPHMATRIXVERTICALBOXPLOT:79,GRAPHMATRIXHORIZONTALBOXPLOT:80,GRAPHMATRIXVERTICALWATERFALL:81,GRAPHMATRIXHORIZONTALWATERFALL:82,KPICARD:83};var T=mstrmojo.vi.viz.EnumVisualizationTemplates;mstrmojo.vi.viz.EnumAggregatedVisTemplates={COMBOCHART:[T.GRAPHHORIZONTALBARDUALAXISCLUSTERED,T.GRAPHHORIZONTALBARDUALAXISABSOLUTE,T.GRAPHHORIZONTALLINEDUALAXISABSOLUTE,T.GRAPHHORIZONTALAREADUALAXISABSOLUTE,T.GRAPHVERTICALBARDUALAXISCLUSTERED,T.GRAPHVERTICALBARDUALAXISABSOLUTE,T.GRAPHVERTICALBARDUALAXISSTACKED,T.GRAPHVERTICALLINEDUALAXISABSOLUTE,T.GRAPHVERTICALLINEDUALAXISSTACKED,T.GRAPHVERTICALAREADUALAXISABSOLUTE,T.GRAPHVERTICALAREADUALAXISSTACKED,T.GRAPHCOMBINATIONBARAREADUALAXIS,T.GRAPHCOMBINATIONBARAREA],BUBBLECHART:[T.GRAPHMATRIXSCATTERCIRCLEMM,T.GRAPHMATRIXSCATTERGRIDCIRCLEAA,T.GRAPHMATRIXBUBBLECIRCLEMM,T.GRAPHMATRIXBUBBLEGRIDCIRCLEAA,T.GRAPHMATRIXSCATTERSQUAREAM,T.GRAPHMATRIXSCATTERSQUAREMM,T.GRAPHMATRIXSCATTERGRIDSQUAREAA,T.GRAPHMATRIXBUBBLESQUAREAM,T.GRAPHMATRIXBUBBLESQUAREMM,T.GRAPHMATRIXBUBBLEGRIDSQUAREAA],BARCHART:[T.GRAPHMATRIXVERTICALBARSTACKED,T.GRAPHMATRIXVERTICALBARCLUSTERED,T.GRAPHMATRIXVERTICALBARPERCENT,T.GRAPHMATRIXHORIZONTALBARSTACKED,T.GRAPHMATRIXHORIZONTALBARCLUSTERED,T.GRAPHMATRIXHORIZONTALBARPERCENT,T.GRAPHHORIZONTALBARCLUSTERED,T.GRAPHVERTICALBARCLUSTERED,T.GRAPHHORIZONTALBARABSOLUTE,T.GRAPHHORIZONTALBARPERCENT,T.GRAPHHORIZONTALBARSTACKED,T.GRAPHVERTICALBARABSOLUTE,T.GRAPHVERTICALBARPERCENT,T.GRAPHVERTICALBARSTACKED,T.GRAPHMATRIXVERTICALBARAUTOMATIC,T.GRAPHMATRIXHORIZONTALBARAUTOMATIC],LINECHART:[T.GRAPHMATRIXVERTICALLINESTACKED,T.GRAPHMATRIXVERTICALLINECLUSTERED,T.GRAPHMATRIXVERTICALLINEPERCENT,T.GRAPHMATRIXHORIZONTALLINESTACKED,T.GRAPHMATRIXHORIZONTALLINECLUSTERED,T.GRAPHMATRIXHORIZONTALLINEPERCENT,T.GRAPHHORIZONTALLINEABSOLUTE,T.GRAPHVERTICALLINEABSOLUTE,T.GRAPHVERTICALLINESTACKED,T.GRAPHVERTICALLINEPERCENT,T.GRAPHMATRIXVERTICALLINEAUTOMATIC,T.GRAPHMATRIXHORIZONTALLINEAUTOMATIC],PIECHART:[T.PIE,T.RING,T.GRAPHMATRIXPIE,T.GRAPHMATRIXRING],AREACHART:[T.GRAPHMATRIXVERTICALAREASTACKED,T.GRAPHMATRIXVERTICALAREAPERCENT,T.GRAPHMATRIXVERTICALAREACLUSTERED,T.GRAPHMATRIXHORIZONTALAREASTACKED,T.GRAPHMATRIXHORIZONTALAREAPERCENT,T.GRAPHMATRIXHORIZONTALAREACLUSTERED,T.GRAPHHORIZONTALAREAABSOLUTE,T.GRAPHVERTICALAREAABSOLUTE,T.GRAPHVERTICALAREAPERCENT,T.GRAPHVERTICALAREASTACKED,T.GRAPHMATRIXVERTICALAREAAUTOMATIC,T.GRAPHMATRIXHORIZONTALAREAAUTOMATIC],HISTOGRAM:[T.GRAPHMATRIXVERTICALHISTOGRAM,],BOXPLOT:[T.GRAPHMATRIXVERTICALBOXPLOT,T.GRAPHMATRIXHORIZONTALBOXPLOT],WATERFALL:[T.GRAPHMATRIXVERTICALWATERFALL,T.GRAPHMATRIXHORIZONTALWATERFALL]};(function(){mstrmojo.requiresCls("mstrmojo.array","mstrmojo.VisEnum");var D=mstrmojo.array,A=mstrmojo.VisEnum,B=A.NETWORK_LAYOUT.LINEAR;mstrmojo.netviz._LinearLayout=mstrmojo.provide("mstrmojo.netviz._LinearLayout",{_mixinName:"mstrmojo.netviz._LinearLayout",init:function(E){if(this._super){this._super(E);}if(this.layouts===undefined){this.layouts={};}this.layouts[B]=C;}});function C(H,J,G){var E=H.nodes,I=E.length,M=G.dimension,K=Math.max(10,(180-M)/I)/2,F=J.height,L=-1*K,N=F/2;J.currentLayout=B;D.forEach(H.nodes,function(P){if(P.isExcluded){return ;}var O=P.sprite,Q=O.getGeometry(),R=Q.s;Q.x=L+R+K;Q.y=N;O.setGeometry(Q);L+=2*(R+K);});D.forEach(H.edges,function(Q){var W=Q.from.sprite,X=Q.to.sprite,O=W.getGeometry(),P=X.getGeometry(),U=P.x-O.x,S=P.y-O.y,Y=(O.x+P.x)/2,V=(O.y+P.y)/2;Q=Q.sprite;var R={x:Y-S*0.5,y:V+U*0.5};Q.setGeometry(R);});}}());(function(){mstrmojo.requiresCls("mstrmojo.array","mstrmojo.VisEnum");var D=mstrmojo.array,A=mstrmojo.VisEnum,B=A.NETWORK_LAYOUT.CIRCULAR;mstrmojo.netviz._CircularLayout=mstrmojo.provide("mstrmojo.netviz._CircularLayout",{_mixinName:"mstrmojo.netviz._CircularLayout",init:function(E){if(this._super){this._super(E);}if(this.layouts===undefined){this.layouts={};}this.layouts[B]=C;}});function C(L,N,J){function K(Q){if(Q.isExcluded){return ;}var R=Q.sprite.getGeometry(),P,O;G+=F;R.x=Math.cos(G)*E+E+I;R.y=Math.sin(G)*E+E+I;Q.sprite.setGeometry(R);if(Q.edges){for(P=0,O=Q.edges.length;P<O;P++){Q.edges[P].sprite.setGeometry({x:E+I,y:E+I,type:"bezier"});}}G+=F;}var G=0,I=J.maxR+A.NETWORK_CIRCLE_BORDER_WIDTH,M=J.circleCount,H=M*I*2,E=Math.max(Math.min(N.width,N.height)/2-I,H/(2*Math.PI)),F=Math.PI/M;N.currentLayout=B;D.forEach(L.nodes,K);}}());(function(){mstrmojo.requiresCls("mstrmojo.array");var H=mstrmojo.array,D={},G={},A="72px",F="abcdefghijklmnopqrstuvwxyz0123456789";function C(I){return I.name+":"+(I.isItalic?"i":"n")+(I.isBold?"7":"4");}mstrmojo.util.FontLoader=mstrmojo.provide("mstrmojo.util.FontLoader",{load:function E(N,O){var L=this,J=[],K;H.forEach(N,function(P){if(!L.isFontInstalled(P)){K=C(P);if(!D[K]&&!G[K]){J.push(K);}}});if(!window.WebFont||J.length===0){return true;}window.WebFont.load({custom:{families:J},fontactive:function(Q,P){D[Q+":"+P]=true;},fontinactive:function(Q,P){G[Q+":"+P]=true;},active:function M(){O.success();},inactive:function I(){O.failure();}});return false;},isFontInstalled:function B(J){var K=document.createElement("canvas"),L=K.getContext("2d"),P=J.isItalic?"italic":"normal",I=J.isBold?"bold":"normal",N=P+" "+I+" "+A,O,M;L.font=N+" monospace";O=L.measureText(F).width;L.font=N+" '"+J.name+"', monospace";M=L.measureText(F).width;K=null;return O!==M;}});})();(function(){mstrmojo.requiresCls("mstrmojo.dom");var C=mstrmojo.dom,D=Math;mstrmojo.gm._IsAnchorable={PLACEMENT_ABOVE:1,PLACEMENT_BELOW:2,PLACEMENT_LEFT:3,PLACEMENT_RIGHT:4,anchor:null,anchorPosition:null,boundary:null,boundaryPosition:null,popupNodeName:"infoNode",tipNodeName:"tipNode",baseTipClass:"arrow",infoNodeOffset:25,popupNodeOffset:0,placementOrder:[this.PLACEMENT_ABOVE,this.PLACEMENT_BELOW,this.PLACEMENT_LEFT,this.PLACEMENT_RIGHT],hasScrollbars:function G(){return(!mstrApp.isTouchApp||!mstrApp.isTouchApp());},positionDialog:function E(){if(!this.anchorPopup()){if(typeof this._super==="function"){this._super();}}},positionTipNode:function A(I){var J=this.baseTipClass,K=this[this.tipNodeName];K.className=J+" "+I;},getTipDimension:function B(){var J=this[this.tipNodeName],I=C.position(J);return I;},anchorPopup:function F(){this.positionTipNode("top");var K=this.anchor,c=this.boundary,o=this[this.popupNodeName],r=this.infoNodeOffset,j=this.popupNodeOffset,l=this.hasScrollbars(),Z=this.anchorPosition||C.position(K,true),M=this.boundaryPosition||C.position(c,true),t=M.w,L=M.h,d=o.offsetWidth,O=o.offsetHeight,V=d/2,I=O/2,X=this.getTipDimension(),h=D.min(X.h,X.w),P=D.max(X.h,X.w)/2;if(l){t-=15;L-=15;}var a=C.contains(c,o),k=a?0:M.y,s=t/2-V,Q=L/2-I+k,n=-1000,u=-1000;if(a){Z.x=Z.x-M.x;Z.y=Z.y-M.y;}var g=Z.y+Z.h,N=Z.x+Z.w,f=Z.x>d,p=((N+d)<t),R=Z.y>O,m=((g+O)<L),U=this,W=function(i,x,w){return D.min(D.max(i,w),D.max(x,0));},e=function(){if((Z.x<t)&&R){var i=Z.x+(Z.w/2);U.positionTipNode("bottom");u=Z.y-h-j;Q=u-O+r;s=W(0,t-d,i-V);n=W(Z.x,N,i)-P;return true;}return false;},J=function(){if((Z.x<t)&&m){var i=Z.x+(Z.w/2);U.positionTipNode("top");u=g+j;Q=u+h-r;s=W(0,t-d,i-V);n=W(Z.x,N,i)-P;return true;}return false;},b=function(){if((Z.y<L)&&f){var i=Z.y+(Z.h/2);U.positionTipNode("right");n=Z.x-h-j;s=n-d+r;Q=W(k,L-O,i-I);u=W(Z.y,g,i)-P;return true;}return false;},Y=function(){if((Z.y<L)&&p){var i=Z.y+(Z.h/2);U.positionTipNode("left");n=N+j;s=n+h-r;Q=W(k,L-O,i-I);u=W(Z.y,g,i)-P;return true;}return false;},S=[],q;for(q=0;q<this.placementOrder.length;q++){switch(this.placementOrder[q]){case this.PLACEMENT_ABOVE:S.push(e);break;case this.PLACEMENT_BELOW:S.push(J);break;case this.PLACEMENT_LEFT:S.push(b);break;case this.PLACEMENT_RIGHT:S.push(Y);break;}}for(q=0;q<S.length;q++){if(S[q]()){break;}}Q=D.round(Q);s=D.round(s);u=D.round(u);n=D.round(n);this.applyPopupNodePos(Q,s,u,n);return true;},applyPopupNodePos:function H(K,J,M,I){var O=this[this.tipNodeName],L=O.style,P=this[this.popupNodeName],N=P.style;L.top=M+"px";L.left=I+"px";N.top=K+"px";N.left=J+"px";}};}());(function(){mstrmojo.requiresCls("mstrmojo.array","mstrmojo.string","mstrmojo.vi.enums.EnumFilterClearActionType","mstrmojo.vi.enums.EnumVisFilterType");var D=mstrmojo.array,M=mstrmojo.string,H=mstrmojo.vi.enums.EnumFilterClearActionType,J=mstrmojo.vi.enums.EnumVisFilterType;mstrmojo.vi.ui.rw._SupportViewFilterInVizBox=mstrmojo.provide("mstrmojo.vi.ui.rw._SupportViewFilterInVizBox",{_mixinName:"mstrmojo.vi.ui.rw._SupportViewFilterInVizBox",getSelectorObjectsFromTemplateLimit:function N(){return this.getSelObjsFromTemlateLimitHandler();},getSelectorObjectsFromViewFilter:function B(){return this.getSelObjsFromVFHandler();},getSelObjsFromVFHandler:function F(){var R=this,P=R.model,Q=R.node.data,S=Q&&Q.vfexpr;return P&&P.getSelectorDataFromViewFilter(S);},getSelObjsFromTemlateLimitHandler:function K(){var R=this,P=R.model,Q=R.node.data,S=Q&&Q.tpl;return P&&P.getSelectorDataFromTemplateLimit(S);},makeBold:function C(P){return"<span style='font-weight:bold;'>"+P+"</span>";},getSelectorExpr:function I(U,S){var V=[],W="",R=true,Q=U.keepOnly?"##":mstrmojo.desc(13232,"Not ##"),P,X=mstrmojo.desc(5283,"OR");if(S){X=this.makeBold(X);}U.data.every(function(Y){[].concat(Y).every(function(Z){if(W===""){W=Z.tn;}return(R=(W===Z.tn));});return R;});U.data.forEach(function(a,Y){if(Y>0){V.push(X);}var Z=[];[].concat(a).forEach(function(d){var c=S?M.encodeHtmlString(d.v):d.v,b=S?M.encodeHtmlString(d.tn):d.tn;Z.push((R?"":(d.tn+" = "))+(c||mstrmojo.desc(14323,"NULL")));});V.push(Z.join(" "));});if(V.length>0){P=Q.replace("##",(R?W+" = ":"")+V.join(" "));}return P;},getLinkingSelectorExpr:function O(S,R){var U=[],V="",Q=true,W=mstrmojo.desc(5283,"OR"),P=S.keepOnly?"##":mstrmojo.desc(13232,"Not ##");if(R){W=this.makeBold(W);}S.data.every(function(X){[].concat(X).every(function(Y){if(V===""){V=Y.tn;}return(Q=(V===Y.tn));});return Q;});S.data.forEach(function(Z,X){var Y=[];if(Q){if(X>0){Y.push(W);}else{Y.push(P.replace("##",V+" = "));}}[].concat(Z).forEach(function(c){var b=R?M.encodeHtmlString(c.v):c.v,a=R?M.encodeHtmlString(c.tn):c.tn;Y.push((Q?"":(a+" = "))+(b||mstrmojo.desc(14323,"NULL")));});U.push(Y.join(" "));});return U.join(" ");},getFilterMenuPairs:function G(P){var R=this,S=[],Q=mstrmojo.desc(2827,"Clear");if(P instanceof Array){P.forEach(function(X,W){var V=R.getSelectorExpr(X),U=R.getSelectorExpr(X,true);S.push({menuString:Q+' "'+V+'"',menuTtpString:Q+' "'+U+'"',ctxt:W});});}return S;},filterMenuHandler:function L(P,S){var R=this,Q=R.controller;switch(P.type){case H.CLEAR_KEEP_ONLY:P=P.idx;Q.applyKeepOnly(R,S,undefined,P,false);break;case H.CLEAR_ALL:Q.clearFiltersForVis(R,[J.KEEP_ONLY,J.LINKING,J.DRILLING],S);break;case H.CLEAR_ADV_QUALIFICATION:Q.clearFiltersForVis(R,[J.ADV_QUALIFICATION],S);break;case H.CLEAR_KEEP_ONLY_AND_LINKING:Q.clearFiltersForVis(R,[J.KEEP_ONLY,J.LINKING],S);break;case H.CLEAR_LINKING:Q.clearLinkingFilter(P,S);break;case H.CLEAR_DRILLING:Q.clearFiltersForVis(R,[J.DRILLING],S);break;default:break;}},hasKeepOnly:function E(P){return P===null||P.length>0;},getSelectorDataForKeepOnly:function A(Q,V){var S=this,R=S.model,U=S.model.data||S.node.data,P=U.tpl,W;if(V===-1){W=[];}else{W=[].concat(R.getSelectorDataFromTemplateLimit(P));if(V===-2){W=D.filter(W,function(X){return !X.keepOnly;});}else{if(V>=0){W.splice(V,1);}}}if(Q){W=W.concat(Q);}return W;}});}());(function(){mstrmojo.requiresCls("mstrmojo.Base");var B=false;mstrmojo.netviz.Bitmap=mstrmojo.declare(mstrmojo.Base,null,{scriptClass:"mstrmojo.netviz.Bitmap",init:function(F){if(this._super){this._super();}var I=F.scale||1,H=F.left,G=F.top,E=F.right,D=F.bottom;if(I>1){H/=I;G/=I;E/=I;D/=I;}this._colCnt=Math.ceil(E)-Math.floor(H)+1;this._rowCnt=Math.ceil(D)-Math.floor(G)+1;this._scale=I;this._bits=[];},testZeros:function(H){var J=C.call(this,H),G=J.left,I=J.top,L=J.right,D=J.bottom,M=this._bits,K=this._colCnt,N,F,E;for(N=I;N<=D;N+=1){for(F=G;F<=L;F+=1){E=M[N*K+F];if(E&&A(E,H)){return false;}}}return true;},set:function(G){var I=C.call(this,G),F=I.left,H=I.top,L=I.right,D=I.bottom,M=this._bits,K=this._colCnt,N,E,J;for(N=H;N<=D;N+=1){for(E=F;E<=L;E+=1){J=N*K+E;if(!M[J]){M[J]=G;}}}}});function A(E,D){if(E.left>D.right||D.left>E.right){return false;}if(E.top>D.bottom||D.top>E.bottom){return false;}return true;}function C(G){var I=G.left,H=G.top,F=G.right,D=G.bottom,E=this._colCnt,K=this._rowCnt,J=this._scale;if(J>1){I/=J;H/=J;F/=J;D/=J;}I=Math.floor(I);F=Math.ceil(F);H=Math.floor(H);D=Math.ceil(D);if(F>=E){F=E-1;}if(I<0){I=0;}if(I>F){I=F;}if(D>=K){D=K-1;}if(H<0){H=0;}if(H>D){H=D;}return{top:H,left:I,bottom:D,right:F};}if(B){(function(){function D(I,H,G,F){return{left:I,top:H,right:G,bottom:F};}var E=new mstrmojo.netviz.Bitmap({left:0,top:0,right:100,bottom:100});console.assert(E.testZeros(D(10,15,50,20)));E.set(D(10,25,50,50));console.assert(E._bits.reduce(function(F){return F+1;},0)===41*26);console.assert(E.testZeros(D(10,15,50,20)));console.assert(!E.testZeros(D(10,15,50,25)));console.assert(!E.testZeros(D(0,0,100,100)));console.assert(E.testZeros(D(75,70,100,75)));console.assert(E.testZeros(D(-1,-1,-1,-1)));console.assert(E.testZeros(D(-1,100,1000,1000)));console.assert(!E.testZeros(D(50,50,50,50)));}());}}());(function(){mstrmojo.requiresCls("mstrmojo.Base");mstrmojo.chart.common.DSSTimeUtil=mstrmojo.declare(mstrmojo.Base,null,{scriptClass:"mstrmojo.chart.common.DSSTimeUtil",DaysInMonth:[31,28,31,30,31,30,31,31,30,31,30,31],DaysBeforeMonth:[0,31,59,90,120,151,181,212,243,273,304,334],DateAbove1970:[1972,1973,1974,1997,1976,1977,1978,1973,1980,1981,1971,1977,2012,1974,1997,1981,1988,1978,1973,1974,1992,1971,1977,1978,1996,1997,1981,1971,1972,1973,1974,1997,1976,1977,1978,1973,1980,1981,1971,1977,2012,1974,1997,1981,1988,1978,1973,1974,1992,1971,1977,1978,1996,1997,1981,1971,1972,1973,1974,1997,1976,1977,1978,1973,1980,1981,1971,1977,2012,1974,1997,1981,1988,1978,1973,1974,1992,1971,1977,1978,1996,1997,1981,1971,1972,1973,1974,1997,1976,1977,1978,1973,1980,1981,1971,1977,2012,1974,1997,1981,1971,1977,1978,1973,1980,1981,1971,1977,2012,1974,1997,1981,1988,1978,1973,1974,1992,1971,1977,1978,1996,1997,1981,1971,1972,1973,1974,1997,1976,1977,1978,1973,1980,1981,1971,1977,2012,1974,1997,1981,1988,1978,1973,1974,1992,1971,1977,1978,1996,1997,1981,1971,1972,1973,1974,1997,1976,1977,1978,1973,1980,1981,1971,1977,2012,1974,1997,1981,1988,1978,1973,1974,1992,1971,1977,1978,1996,1997,1981,1971,1972,1973,1974,1997,1976,1977,1978,1973,1980,1981,1971,1977,2012,1974,1997,1981,1988,1978,1973,1974,1997,1981,1971,1977,2012,1974,1997,1981,1988,1978,1973,1974,1992,1971,1977,1978,1996,1997,1981,1971,1972,1973,1974,1997,1976,1977,1978,1973,1980,1981,1971,1977,2012,1974,1997,1981,1988,1978,1973,1974,1992,1971,1977,1978,1996,1997,1981,1971,1972,1973,1974,1997,1976,1977,1978,1973,1980,1981,1971,1977,2012,1974,1997,1981,1988,1978,1973,1974,1992,1971,1977,1978,1996,1997,1981,1971,1972,1973,1974,1997,1976,1977,1978,1973,1980,1981,1971,1977,2012,1974,1997,1981,1988,1978,1973,1974,1992,1971,1977,1978,1973,1974,1997,1981,1988,1978,1973,1974,1992,1971,1977,1978,1996,1997,1981,1971,1972,1973,1974,1997,1976,1977,1978,1973,1980,1981,1971,1977,2012,1974,1997,1981,1988,1978,1973,1974,1992,1971,1977,1978,1996,1997,1981,1971,1972,1973,1974,1997,1976,1977,1978,1973,1980,1981,1971,1977,2012,1974,1997,1981,1988,1978,1973,1974,1992,1971,1977,1978,1996,1997,1981,1971,1972,1973,1974,1997,1976,1977,1978,1973,1980,1981,1971,1977,2012,1974,1997,1981,1988,1978,1973,1974,1992,1971,1977,1978,1996,1997,1981,1971,1972,1973,1974,1997,1976,1977,1978,1973,1980,1981,1971,1977,2012,1974,1997,1981,1988,1978,1973,1974,1992,1971,1977,1978,1996,1997,1981,1971,1972,1973,1974,1997,1976,1977,1978,1973,1980,1981,1971,1977,2012,1974,1997,1981,1988,1978,1973,1974,1992,1971,1977,1978,1996,1997,1981,1971,1972,1973,1974,1997,1976,1977,1978,1973,1980,1981,1971,1977,2012,1974,1997,1981,1988,1978,1973,1974,1992,1971,1977,1978,1996,1997,1981,1971,1972,1973,1974,1997,1976,1977,1978,1973,1980,1981,1971,1977,2012,1974,1997,1981,1971,1977,1978,1973,1980,1981,1971,1977,2012,1974,1997,1981,1988,1978,1973,1974,1992,1971,1977,1978,1996,1997,1981,1971,1972,1973,1974,1997,1976,1977,1978,1973,1980,1981,1971,1977,2012,1974,1997,1981,1988,1978,1973,1974,1992,1971,1977,1978,1996,1997,1981,1971,1972,1973,1974,1997,1976,1977,1978,1973,1980,1981,1971,1977,2012,1974,1997,1981,1988,1978,1973,1974,1992,1971,1977,1978,1996,1997,1981,1971,1972,1973,1974,1997,1976,1977,1978,1973,1980,1981,1971,1977,2012,1974,1997,1981,1988,1978,1973,1974,1997,1981,1971,1977,2012,1974,1997,1981,1988,1978,1973,1974,1992,1971,1977,1978,1996,1997,1981,1971,1972,1973,1974,1997,1976,1977,1978,1973,1980,1981,1971,1977,2012,1974,1997,1981,1988,1978,1973,1974,1992,1971,1977,1978,1996,1997,1981,1971,1972,1973,1974,1997,1976,1977,1978,1973,1980,1981,1971,1977,2012,1974,1997,1981,1988,1978,1973,1974,1992,1971,1977,1978,1996,1997,1981,1971,1972,1973,1974,1997,1976,1977,1978,1973,1980,1981,1971,1977,2012,1974,1997,1981,1988,1978,1973,1974,1992,1971,1977,1978,1973,1974,1997,1981,1988,1978,1973,1974,1992,1971,1977,1978,1996,1997,1981,1971,1972,1973,1974,1997,1976,1977,1978,1973,1980,1981,1971,1977,2012,1974,1997,1981,1988,1978,1973,1974,1992,1971,1977,1978,1996,1997,1981,1971,1972,1973,1974,1997,1976,1977,1978,1973,1980,1981,1971,1977,2012,1974,1997,1981,1988,1978,1973,1974,1992,1971,1977,1978,1996,1997,1981,1971,1972,1973,1974,1997,1976,1977,1978,1973,1980,1981,1971,1977,2012,1974,1997,1981,1988,1978,1973,1974,1992,1971,1977,1978,1996,1997,1981,1971,1972,1973,1974,1997,1976,1977,1978,1973,1980,1981,1971,1977,2012,1974,1997,1981,1988,1978,1973,1974,1992,1971,1977,1978,1996,1997,1981,1971,1972,1973,1974,1997,1976,1977,1978,1973,1980,1981,1971,1977,2012,1974,1997,1981,1988,1978,1973,1974,1992,1971,1977,1978,1996,1997,1981,1971,1972,1973,1974,1997,1976,1977,1978,1973,1980,1981,1971,1977,2012,1974,1997,1981,1988,1978,1973,1974,1992,1971,1977,1978,1996,1997,1981,1971,1972,1973,1974,1997,1976,1977,1978,1973,1980,1981,1971,1977,2012,1974,1997,1981,1971,1977,1978,1973,1980,1981,1971,1977,2012,1974,1997,1981,1988,1978,1973,1974,1992,1971,1977,1978,1996,1997,1981,1971,1972,1973,1974,1997,1976,1977,1978,1973,1980,1981,1971,1977,2012,1974,1997,1981,1988,1978,1973,1974,1992,1971,1977,1978,1996,1997,1981,1971,1972,1973,1974,1997,1976,1977,1978,1973,1980,1981,1971,1977,2012,1974,1997,1981,1988,1978,1973,1974,1992,1971,1977,1978,1996,1997,1981,1971,1972,1973,1974,1997,1976,1977,1978,1973,1980,1981,1971,1977,2012,1974,1997,1981,1988,1978,1973,1974,1997,1981,1971,1977,2012,1974,1997,1981,1988,1978,1973,1974,1992,1971,1977,1978,1996,1997,1981,1971,1972,1973,1974,1997,1976,1977,1978,1973,1980,1981,1971,1977,2012,1974,1997,1981,1988,1978,1973,1974,1992,1971,1977,1978,1996,1997,1981,1971,1972,1973,1974,1997,1976,1977,1978,1973,1980,1981,1971,1977,2012,1974,1997,1981,1988,1978,1973,1974,1992,1971,1977,1978,1996,1997,1981,1971,1972,1973,1974,1997,1976,1977,1978,1973,1980,1981,1971,1977,2012,1974,1997,1981,1988,1978,1973,1974,1992,1971,1977,1978,1973,1974,1997,1981,1988,1978,1973,1974,1992,1971,1977,1978,1996,1997,1981,1971,1972,1973,1974,1997,1976,1977,1978,1973,1980,1981,1971,1977,2012,1974,1997,1981,1988,1978,1973,1974,1992,1971,1977,1978,1996,1997,1981,1971,1972,1973,1974,1997,1976,1977,1978,1973,1980,1981,1971,1977,2012,1974,1997,1981,1988,1978,1973,1974,1992,1971,1977,1978,1996,1997,1981,1971,1972,1973,1974,1997,1976,1977,1978,1973,1980,1981,1971,1977,2012,1974,1997,1981,1988,1978,1973,1974,1992,1971,1977,1978,1996,1997,1981,1971,1972,1973,1974,1997,1976,1977,1978,1973,1980,1981,1971,1977,2012,1974,1997,1981,1988,1978,1973,1974,1992,1971,1977,1978,1996,1997,1981,1971,1972,1973,1974,1997,1976,1977,1978,1973,1980,1981,1971,1977,2012,1974,1997,1981,1988,1978,1973,1974,1992,1971,1977,1978,1996,1997,1981,1971,1972,1973,1974,1997,1976,1977,1978,1973,1980,1981,1971,1977,2012,1974,1997,1981,1988,1978,1973,1974,1992,1971,1977,1978,1996,1997,1981,1971,1972,1973,1974,1997,1976,1977,1978,1973,1980,1981,1971,1977,2012,1974,1997,1981,1971,1977,1978,1973,1980,1981,1971,1977,2012,1974,1997,1981,1988,1978,1973,1974,1992,1971,1977,1978,1996,1997,1981,1971,1972,1973,1974,1997,1976,1977,1978,1973,1980,1981,1971,1977,2012,1974,1997,1981,1988,1978,1973,1974,1992,1971,1977,1978,1996,1997,1981,1971,1972,1973,1974,1997,1976,1977,1978,1973,1980,1981,1971,1977,2012,1974,1997,1981,1988,1978,1973,1974,1992,1971,1977,1978,1996,1997,1981,1971,1972,1973,1974,1997,1976,1977,1978,1973,1980,1981,1971,1977,2012,1974,1997,1981,1988,1978,1973,1974,1997,1981,1971,1977,2012,1974,1997,1981,1988,1978,1973,1974,1992,1971,1977,1978,1996,1997,1981,1971,1972,1973,1974,1997,1976,1977,1978,1973,1980,1981,1971,1977,2012,1974,1997,1981,1988,1978,1973,1974,1992,1971,1977,1978,1996,1997,1981,1971,1972,1973,1974,1997,1976,1977,1978,1973,1980,1981,1971,1977,2012,1974,1997,1981,1988,1978,1973,1974,1992,1971,1977,1978,1996,1997,1981,1971,1972,1973,1974,1997,1976,1977,1978,1973,1980,1981,1971,1977,2012,1974,1997,1981,1988,1978,1973,1974,1992,1971,1977,1978,1973,1974,1997,1981,1988,1978,1973,1974,1992,1971,1977,1978,1996,1997,1981,1971,1972,1973,1974,1997,1976,1977,1978,1973,1980,1981,1971,1977,2012,1974,1997,1981,1988,1978,1973,1974,1992,1971,1977,1978,1996,1997,1981,1971,1972,1973,1974,1997,1976,1977,1978,1973,1980,1981,1971,1977,2012,1974,1997,1981,1988,1978,1973,1974,1992,1971,1977,1978,1996,1997,1981,1971,1972,1973,1974,1997,1976,1977,1978,1973,1980,1981,1971,1977,2012,1974,1997,1981,1988,1978,1973,1974,1992,1971,1977,1978,1996,1997,1981,1971,1972,1973,1974,1997,1976,1977,1978,1973,1980,1981,1971,1977,2012,1974,1997,1981,1988,1978,1973,1974,1992,1971,1977,1978,1996,1997,1981,1971,1972,1973,1974,1997,1976,1977,1978,1973,1980,1981,1971,1977,2012,1974,1997,1981,1988,1978,1973,1974,1992,1971,1977,1978,1996,1997,1981,1971,1972,1973,1974,1997,1976,1977,1978,1973,1980,1981,1971,1977,2012,1974,1997,1981,1988,1978,1973,1974,1992,1971,1977,1978,1996,1997,1981,1971,1972,1973,1974,1997,1976,1977,1978,1973,1980,1981,1971,1977,2012,1974,1997,1981,1971,1977,1978,1973,1980,1981,1971,1977,2012,1974,1997,1981,1988,1978,1973,1974,1992,1971,1977,1978,1996,1997,1981,1971,1972,1973,1974,1997,1976,1977,1978,1973,1980,1981,1971,1977,2012,1974,1997,1981,1988,1978,1973,1974,1992,1971,1977,1978,1996,1997,1981,1971,1972,1973,1974,1997,1976,1977,1978,1973,1980,1981,1971,1977,2012,1974,1997,1981,1988,1978,1973,1974,1992,1971,1977,1978,1996,1997,1981,1971,1972,1973,1974,1997,1976,1977,1978,1973,1980,1981,1971,1977,2012,1974,1997,1981,1988,1978,1973,1974,1997,1981,1971,1977,2012,1974,1997,1981,1988,1978,1973,1974,1992,1971,1977,1978,1996,1997,1981,1971,1972,1973,1974,1997,1976,1977,1978,1973,1980,1981,1971,1977,2012,1974,1997,1981,1988,1978,1973,1974,1992,1971,1977,1978,1996,1997,1981,1971,1972,1973,1974,1997,1976,1977,1978,1973,1980,1981,1971,1977,2012,1974,1997,1981,1988,1978,1973,1974,1992,1971,1977,1978,1996,1997,1981,1971,1972,1973,1974,1997,1976,1977,1978,1973,1980,1981,1971,1977,2012,1974,1997,1981,1988,1978,1973,1974,1992,1971,1977,1978,1973,1974,1997,1981,1988,1978,1973,1974,1992,1971,1977,1978,1996,1997,1981,1971,1972,1973,1974,1997,1976,1977,1978,1973,1980,1981,1971,1977,2012,1974,1997,1981,1988,1978,1973,1974,1992,1971,1977,1978,1996,1997,1981,1971,1972,1973,1974,1997,1976,1977,1978,1973,1980,1981,1971,1977,2012,1974,1997,1981,1988,1978,1973,1974,1992,1971,1977,1978,1996,1997,1981]});}());(function(){var E=false;mstrmojo.requiresCls("mstrmojo.Base");mstrmojo.netviz.PropertyParser=mstrmojo.declare(mstrmojo.Base,null,{scriptClass:"mstrmojo.netviz.PropertyParser",methods:{unmarshal:function(X,W){var V=this;V._withConfig({unmarshal:true},function(){V.parsedProps[X]=W;});},marshal:function(W){var V=this;return V._withConfig({marshal:true},function(){return V.parsedProps[W];});}},init:function(V){if(this._super){this._super(V);}this.config={marshal:false,unmarshal:false};this.parsedProps={};},parse:function(W,Y){var X=this,Z=this.parsedProps,V=this.methods;this.raw=W;this.schema=Y;Object.keys(V).forEach(function(a){X.defineMethod(a,V[a]);});Object.keys(Y).forEach(function(a){var b=Y[a];X.defineProperty(a,b.type);Z.unmarshal(a,W[b.key]);});return Z;},defineProperty:function(V,d){var c=this,X=c.config,b=this.parsedProps,W=(this.schema||{})[V]||{},h=W.preSet,Z=W.postSet,Y=W.preGet,e=W.postGet,g=W.key,f=this.raw,a;if(!U(d)){throw new TypeError("type does not implement required methods");}Object.defineProperty(b,V,{enumerable:true,get:function(){var i=a;if(i!==undefined&&X.marshal){if(Y instanceof Function){i=Y.call(b,i,V,f,g);}i=d.marshal(i);if(e instanceof Function){i=e.call(b,i,V,f,g);}}return i;},set:function(j){var i=j;if(X.unmarshal){if(h instanceof Function){i=h.call(b,i,V,f,g);}i=d.unmarshal(i);if(Z instanceof Function){i=Z.call(b,i,V,f,g);}}if(i!==undefined&&!d.validate(i)){throw new TypeError("Invalid value in setter. Consider unmarshal(prop, val).");}a=i;}});},defineMethod:function(Y,V){var W=this,X=W.parsedProps;if(!L(Y)||!(V instanceof Function)){return ;}Object.defineProperty(X,Y,{enumerable:false,value:V.bind(W)});},_withConfig:function(X,a){var Y=this.config,Z=Object.keys(X||{}),W=Z.reduce(function(c,b){c[b]=Y[b];return c;},{}),V;Z.forEach(function(b){Y[b]=X[b];});V=a();Z.forEach(function(b){Y[b]=W[b];});return V;}});var O=Object.prototype.toString,G=mstrmojo.netviz.PropertyParser;function J(Y,X,W){var V=parseInt(Y,X);return isNaN(V)?W:V;}function N(V){return O.call(V)==="[object Number]";}function L(V){return O.call(V)==="[object String]";}var I=mstrmojo.declare(mstrmojo.Base,[],{scriptClass:"mstrmojo.netviz.PropertyParser.Property",init:function(V){if(this._super){this._super();}this.defval=V.defval;},marshal:function(V){return JSON.stringify(V).replace(/"/g,"'");}});G.BooleanProperty=mstrmojo.declare(I,[],{scriptClass:"mstrmojo.netviz.PropertyParser.BooleanProperty",unmarshal:function(V){if(V===undefined){return this.defval;}return V.toString()==="true";},validate:function(V){return V===true||V===false||O.call(V)==="[object Boolean]";}});G.IntegerProperty=mstrmojo.declare(I,[],{scriptClass:"mstrmojo.netviz.PropertyParser.IntegerProperty",unmarshal:function(V){return J(V,10,this.defval);},validate:N});G.FloatProperty=mstrmojo.declare(I,[],{scriptClass:"mstrmojo.netviz.PropertyParser.FloatProperty",unmarshal:function(W){var V=parseFloat(W);return isNaN(V)?this.defval:V;},validate:N});G.JsonProperty=mstrmojo.declare(I,[],{scriptClass:"mstrmojo.netviz.PropertyParser.JsonProperty",unmarshal:function(V){function W(Y){var X;if(Y!==undefined){try{X=JSON.parse(Y.replace(/'/g,'"'));}catch(Z){X=Y;}}return X;}if(typeof V==="string"){return W(V);}if(V!==undefined&&V!==null){return V;}return this.defval;},validate:function(V){return true;}});G.StringProperty=mstrmojo.declare(I,[],{scriptClass:"mstrmojo.netviz.PropertyParser.StringProperty",unmarshal:function(V){if(V!==undefined&&V!==null){return V.toString();}return this.defval;},marshal:function(V){return V;},validate:L});var K=["BooleanProperty","StringProperty","JsonProperty","IntegerProperty","FloatProperty"];K.forEach(function(V){var W=G[V];W.preset=function(X){return new W({defval:X});};});function U(V){return Q(V,["marshal","unmarshal","validate"]);}function Q(W,V){if(!W){return false;}return(V||[]).every(function(X){return W[X] instanceof Function;});}if(E){var C=new G(),F=G.BooleanProperty,H=G.IntegerProperty,B=G.FloatProperty,S=G.StringProperty,M=G.JsonProperty;var R={x:1,y:{x:"n+1"},z:true,m:3.14};var P={bp1:"false",bp2:"true",bp3:"",dp1:"12",dp2:22,fp1:23.3,fp2:"3.14",sp1:"foobar",jp1:R,jp3:"transparent"};var A={boolProp1:{key:"bp1",type:F.preset(false)},boolProp2:{key:"bp2",type:F.preset(false)},boolProp3:{key:"bp3",type:F.preset(false)},boolProp4:{key:"bp4",type:F.preset(false)},boolProp5:{key:"bp5",type:F.preset(true)},decimalProp1:{key:"dp1",type:H.preset(-1)},decimalProp2:{key:"dp2",type:H.preset(-1)},decimalPropn:{key:"dpn",type:H.preset(-1)},floatProp1:{key:"fp1",type:B.preset(0)},floatProp2:{key:"fp2",type:B.preset(0)},floatProp3:{key:"fp3",type:B.preset(0.03)},stringProp1:{key:"sp1",type:S.preset("")},stringProp2:{key:"sp2",type:S.preset("string")},jsonProp1:{key:"jp1",type:M.preset({})},jsonProp2:{key:"jp2",type:M.preset({})},jsonProp3:{key:"jp3",type:M.preset("error")}};var D=C.parse(P,A);console.assert(Object.keys(D).length===Object.keys(A).length,"wrong property count");console.assert(D.unmarshal instanceof Function,"unmarshal not found");console.assert(D.marshal instanceof Function,"marshal not found");console.assert(D.boolProp1===false);console.assert(D.boolProp2===true);console.assert(D.boolProp3===false);console.assert(D.boolProp4===false);console.assert(D.boolProp5===true);console.assert(D.marshal("boolProp5")==="true");D.unmarshal("boolProp5","false");console.assert(D.boolProp5===false);console.assert(D.marshal("boolProp5")==="false");console.assert(D.decimalProp1===12);console.assert(D.decimalProp2===22);console.assert(D.decimalPropn===-1);D.unmarshal("decimalProp1",42);console.assert(D.decimalProp1===42);console.assert(D.marshal("decimalProp1")==="42");console.assert(D.floatProp1===23.3);console.assert(D.marshal("floatProp1")==="23.3");console.assert(D.floatProp2===3.14);console.assert(D.floatProp3===0.03);D.unmarshal("floatProp3",100);console.assert(D.floatProp3===100);console.assert(D.stringProp1==="foobar");console.assert(D.stringProp2==="string");D.unmarshal("stringProp2","quux");console.assert(D.marshal("stringProp2")==="quux");D.unmarshal("stringProp2",42);console.assert(D.stringProp2==="42");console.assert(JSON.stringify(D.jsonProp1)===JSON.stringify(R));console.assert(Object.keys(D.jsonProp2).length===0);console.assert(D.jsonProp3==="transparent");console.assert(D.marshal("jsonProp1")===JSON.stringify(R).replace(/"/g,"'"));D.unmarshal("jsonProp2",true);console.assert(D.jsonProp2===true);console.assert(D.marshal("jsonProp2")==="true");console.info("PropertyParser: all tests processed");}}());(function(){mstrmojo.requiresCls("mstrmojo.Base","mstrmojo.gm.GMEnums");var A=mstrmojo.gm.EnumIdentityType;mstrmojo.gm.GMIdentities=mstrmojo.declare(mstrmojo.Base,null,{scriptClass:"mstrmojo.gm.GMIdentities"});mstrmojo.gm.HeaderCellIdentity=mstrmojo.declare(mstrmojo.Base,null,{scriptClass:"mstrmojo.gm.HeaderCellIdentity",eid:undefined,v:undefined,tid:undefined,n:undefined,tui:undefined,fid:undefined,o:undefined,isRowAttribute:undefined,at:undefined,dei:undefined,dpt:undefined});mstrmojo.gm.GeneralIdentity=mstrmojo.declare(mstrmojo.Base,null,{scriptClass:"mstrmojo.gm.GeneralIdentity",objType:undefined});mstrmojo.gm.TitleCellIdentity=mstrmojo.declare(mstrmojo.Base,null,{scriptClass:"mstrmojo.gm.TitleCellIdentity",tid:undefined,fid:undefined,n:undefined,tui:undefined,isRowAttribute:undefined,otp:undefined,init:function(B){this.fid=B.fid;this.tid=B.id;this.isRowAttribute=B.isRowAttribute;if(B.isRowAttribute){this.objType=A.ROW_TITLE;}else{this.objType=A.COL_TITLE;}this.n=B.n;this.otp=B.otp;this.ost=B.ost;this.tui=B.tui;}});mstrmojo.gm.MetricAxisTitleIdentity=mstrmojo.declare(mstrmojo.Base,null,{scriptClass:"mstrmojo.gm.MetricAxisTitleIdentity",init:function(B){this._super(B);}});mstrmojo.gm.AttributeAxisTitleIdentity=mstrmojo.declare(mstrmojo.Base,null,{scriptClass:"mstrmojo.gm.AttributeAxiTitleIdentity",init:function(B){this._super(B);}});mstrmojo.gm.AxisIdentity=mstrmojo.declare(mstrmojo.Base,null,{scriptClass:"mstrmojo.gm.AxisIdentity",isNumericAxis:undefined,metricIdxArr:undefined,attrIdArr:undefined});mstrmojo.gm.ColorSquareIdentity=mstrmojo.declare(mstrmojo.Base,null,{scriptClass:"mstrmojo.gm.ColorSquareIdentity",init:function(B){this._super(B);this.comb=this.getElementsCombination();},getElementsCombination:function(){var B,F=this.token,C,H,G,E,I,D;if(F){D=[];C=F.levels;H=F.elements;G=F.types;B=C.length;for(E=0;E<B;E++){I={eid:H[E],tid:C[E]};if(G){I.tp=G[E];}D.push(I);}return D;}return undefined;}});}());(function(){mstrmojo.requiresCls("mstrmojo.Base","mstrmojo.chart.common.DSSTimeUtil");var H=24*60*60*1000;var A=60*60*1000;var L=60*1000;var C=1000;var K=24;var D=24*60;var J=24*60*60;var B=new mstrmojo.chart.common.DSSTimeUtil();mstrmojo.chart.common.DSSDateTime=mstrmojo.declare(mstrmojo.Base,null,{scriptClass:"mstrmojo.chart.common.DSSDateTime",mnYear:1899,mnMonth:12,mnDay:30,mnHour:0,mnMinute:0,mnSecond:0,mnMillisecond:0,mnWeek:-1,mnDayOfWeek:-1,init:function P(U){if(!U||!U.ifTime){this.mnYear=1899;this.mnMonth=12;this.mnDay=30;this.mnHour=0;this.mnMinute=0;this.mnSecond=0;this.mnMillisecond=0;this.mnWeek=-1;this.mnDayOfWeek=-1;return ;}var S=0;var W=23242571;var R=-693593;if(U.ifTime>W){this.mnYear=65535;this.mnMonth=12;this.mnDay=30;S=U.ifTime-Math.floor(U.ifTime);}else{if(U.ifTime<R){this.mnYear=1;this.mnMonth=1;this.mnDay=1;S=Math.abs(U.ifTime)+Math.ceil(U.ifTime);}else{if(U.ifTime>0){var X=this.DAYSToYMD(Math.floor(U.ifTime));this.mnYear=X.year;this.mnMonth=X.month;this.mnDay=X.day;S=U.ifTime-Math.floor(U.ifTime);}else{if(U.ifTime<0){var X=this.DAYSToYMD(Math.ceil(U.ifTime));this.mnYear=X.year;this.mnMonth=X.month;this.mnDay=X.day;S=Math.abs(U.ifTime)+Math.ceil(U.ifTime);}}}}S*=H;var V=S+0.5;if(V==H){V--;}if(V>0){this.mnHour=Math.floor(V/A);V-=this.mnHour*A;this.mnMinute=Math.floor(V/L);V-=this.mnMinute*L;this.mnSecond=Math.floor(V/C);V-=this.mnSecond*C;this.mnMillisecond=Math.floor(V);}else{this.mnHour=0;this.mnMinute=0;this.mnSecond=0;this.mnMillisecond=0;}this.mnWeek=-1;this.mnDayOfWeek=-1;this.Sanitize();},Sanitize:function O(){var R=false;if(this.mnHour==24&&this.mnMinute==0&&this.mnSecond==0){R=true;this.mnHour=0;}if(this.mnMonth<1){this.mnMonth=1;}else{if(this.mnMonth>12){this.mnMonth=12;}}if(this.mnDay<1){this.mnDay=1;}else{if(this.mnDay>B.DaysInMonth[this.mnMonth-1]){this.mnDay=B.DaysInMonth[this.mnMonth-1];if(this.mnMonth==2&&this.IsLeapYear(this.mnYear)){this.mnDay++;}}}if(this.mnHour<0){this.mnHour=0;}else{if(this.mnHour>23){this.mnHour=23;}}if(this.mnMinute<0){this.mnMinute=0;}else{if(this.mnMinute>59){this.mnMinute=59;}}if(this.mnSecond<0){this.mnSecond=0;}else{if(this.mnSecond>59){this.mnSecond=59;}}if(this.mnMillisecond<0){this.mnMillisecond=0;}else{if(this.mnMillisecond>999){this.mnMillisecond=999;}}if(R){var S=this.ToMilliseconds();S=S+H;this.init({ifTime:this.MillisecondsToDATE(S)});}},IsLeapYear:function Q(R){return((R&3)==0)&&((R%100)!=0||(R%400)==0);},ToMilliseconds:function I(){var R=this.YMDToDAYS(this.mnYear,this.mnMonth,this.mnDay);var S=R*H;S+=this.mnHour*A+this.mnMinute*L+this.mnSecond*C+this.mnMillisecond;return S;},MillisecondsToDATE:function E(S){var R=Math.floor(S/H);var U=(S-R*H)/H;if(U<0){R--;U+=1;}return R>=0?R+U:R-U;},DAYSToYMD:function N(U){var X=0;var Z=0;var S=0;U+=693959;var W=Math.floor(U/365);var V=U-W*365;var Y=Math.floor(W/4)-Math.floor(W/100)+Math.floor(W/400);V=V-Y;if(V<0){W--;V+=365;while(V<=0){W--;V+=365;}}var R=U-(W*365+Math.floor(W/4)+(W%4?1:0)-Math.floor((W-1)/100)+Math.floor((W-1)/400));if(R==365&&!this.IsLeapYear(W)){X=W+1;Z=1;S=1;return{year:X,month:Z,day:S};}if(R==-1){X=W-1;Z=12;S=31;return{year:X,month:Z,day:S};}X=W;Z=12;while(R<B.DaysBeforeMonth[Z-1]){Z--;}S=R-B.DaysBeforeMonth[Z-1]+1;if(Z>2&&this.IsLeapYear(X)){S--;if(S==0){Z--;S=B.DaysInMonth[Z-1];if(Z==2){S++;}}}return{year:X,month:Z,day:S};},YMDToDAYS:function G(V,U,S){if(U<1||U>12){return 0;}var R=V*365+Math.floor(V/4)+(V%4?1:0)-Math.floor((V-1)/100)+Math.floor((V-1)/400);R+=B.DaysBeforeMonth[U-1];if(U>2&&this.IsLeapYear(V)){R++;}R+=S-1;R-=693959;return R;},ToDATE:function F(){var S=this.YMDToDAYS(this.mnYear,this.mnMonth,this.mnDay);var R=this.mnHour/K+this.mnMinute/D+this.mnSecond/J+this.mnMillisecond/H;if(S>=0){return S+R;}else{return S-R;}},DateTimeOrder:function M(R){if(this.mnYear>R.mnYear){return 1;}else{if(this.mnYear<R.mnYear){return -1;}}if(this.mnMonth>R.mnMonth){return 1;}else{if(this.mnMonth<R.mnMonth){return -1;}}if(this.mnDay>R.mnDay){return 1;}else{if(this.mnDay<R.mnDay){return -1;}}if(this.mnHour>R.mnHour){return 1;}else{if(this.mnHour<R.mnHour){return -1;}}if(this.mnMinute>R.mnMinute){return 1;}else{if(this.mnMinute<R.mnMinute){return -1;}}if(this.mnSecond>R.mnSecond){return 1;}else{if(this.mnSecond<R.mnSecond){return -1;}}if(this.mnMillisecond>R.mnMillisecond){return 1;}else{if(this.mnMillisecond<R.mnMillisecond){return -1;}}return 0;}});}());(function(){mstrmojo.requiresCls("mstrmojo.dom","mstrmojo.css");var C=Math,I=mstrmojo.dom,K=mstrmojo.css,E="active",L="ready",J=6,F=10,O=10,P={LASSO_SELECTOR:"lasso-selector",LASSO_RESIZER:"lasso-resizer",BUTTON:"button"};mstrmojo.util.ui.LassoSelectorParamsType=null;function Q(S,R,U){return function(V){S.call(mstrmojo.all[R],V,U);};}function M(S){var V=S.view,U=I.eventTarget(window,S),R=this.lassoSelector;if(this.clickFromLassoResizer||(U!==R&&this.clickFromCreatingLasso)){I.stopPropogation(V,S);I.preventDefault(V,S);}delete this.clickFromLassoResizer;delete this.clickFromCreatingLasso;}function D(c,V){var R,e,S,a,b=c.clientX,Z=c.clientY,U=this.lassoSelector,Y=V.startX,X=V.startY,W=V.containerPos,f=b-W.x,d=Z-W.y;f=C.min(f,V.maxX);f=C.max(f,V.minX);d=C.min(d,V.maxY);d=C.max(d,V.minY);R=C.abs(f-Y);e=C.abs(d-X);a=C.min(X,d);S=C.min(Y,f);U.style.width=R+"px";U.style.height=e+"px";U.style.left=S+"px";U.style.top=a+"px";V.width=R;V.height=e;V.left=S;V.top=a;if(R<=O&&e<=O){U.style.visibility="hidden";K.removeClass(U,E);}else{U.style.visibility="visible";K.addClass(U,E);document.body.style.cursor="crosshair";}}function H(U,X){var W=window.document,S=this.lassoSelector,V=X.width,R=X.height;I.detachEvent(W,"mousemove",X.fnMove);I.detachEvent(W,"mouseup",X.fnUp);delete X.fnMove;delete X.fnUp;document.body.style.cursor="default";if(!V||V===0||!R||R===0){this.dismissLassoSelector();}else{X.ctrlKey=U.ctrlKey;this.lassoSelected(X);this.clickFromCreatingLasso=true;K.addClass(S,L);this.positionBoxResizers();}}function N(h){var a,d=h.view,c,b,e=I.eventTarget(window,h),R=e.getAttribute("type"),W=this.lassoSelector,S=this.lassoContainer,j=this.excludeAttrArr,V=j.length,Z,Y={};delete this.clickFromLassoResizer;delete this.clickFromCreatingLasso;if(!W||!S||!this.lassoSelectorEnabled){return ;}if(I.contains(this.dropDownBtn,e,true)){return ;}for(a=0;a<V;a++){if(R===j[a]){return ;}}this.lassoSelecting();Z=I.position(S);c=h.clientX-Z.x;b=h.clientY-Z.y;Y.containerPos=Z;Y.maxX=Z.w;Y.maxY=Z.h;Y.startX=c;Y.startY=b;Y.minX=0;Y.minY=0;Y.info=this.getLassoSelectionInfo(e);Y.useAsSelectorOrBrushes=this.useAsSelectorOrBrushes||((this.hasAssociatedNodes&&this.hasAssociatedNodes())||this.selectorControl);W.style.visibility="hidden";W.style.left=c+"px";W.style.top=b+"px";W.style.width="0px";W.style.height="0px";K.removeClass(W,L);S.appendChild(W);var U=this.id,f=document,X=Q(D,U,Y),g=Q(H,U,Y);I.attachEvent(f,"mousemove",X);I.attachEvent(f,"mouseup",g);Y.fnMove=X;Y.fnUp=g;I.stopPropogation(d,h);I.preventDefault(d,h);}function G(b,V){var Z=V.index,Y=V.startX,X=V.startY,W=V.containerPos,g=b.clientX-W.x,f=b.clientY-W.y,U=this.lassoSelector;g=C.min(g,V.maxX);g=C.max(g,V.minX);f=C.min(f,V.maxY);f=C.max(f,V.minY);var e=g-Y,d=f-X;if(Z%3===1){e=0;}if(Z===3||Z===5){d=0;}var R=V.selWidth,c=V.selHeight,S=V.selLeft,a=V.selTop;if(e!==0){if(Z%3===0){S+=e;R-=e;}else{R+=e;}}if(d!==0){if(Z<3){a+=d;c-=d;}else{c+=d;}}U.style.width=R+"px";U.style.left=S+"px";U.style.top=a+"px";U.style.height=c+"px";V.width=R;V.left=S;V.height=c;V.top=a;this.positionBoxResizers();}function B(R,V){var U=R.view,S=window.document;I.detachEvent(S,"mousemove",V.fnMove);I.detachEvent(S,"mouseup",V.fnUp);delete V.fnMove;delete V.fnUp;this.clickFromLassoResizer=true;I.stopPropogation(U,R);I.preventDefault(U,R);this.lassoSelectorResized(V);}function A(W){var U=W.view,i=I.eventTarget(window,W),V=parseInt(i.getAttribute("index"),10),b=this.lassoSelector,a=b.offsetLeft,k=b.offsetTop,Z=a+b.offsetWidth,h=k+b.offsetHeight,R=I.position(this.lassoContainer),g=0,d=0,e=R.w,c=R.h,f={};if(V%3===0){e=Z-F;}if(V%3===2){g=a+F;}if(V<3){c=h-F;}if(V>=6){d=k+F;}f.minX=g;f.minY=d;f.maxX=e;f.maxY=c;f.startX=W.clientX-R.x;f.startY=W.clientY-R.y;f.index=V;f.containerPos=R;f.selWidth=b.clientWidth;f.selHeight=b.clientHeight;f.selLeft=b.offsetLeft;f.selTop=b.offsetTop;var Y=this.id,j=document,S=Q(G,Y,f),X=Q(B,Y,f);I.attachEvent(j,"mousemove",S);I.attachEvent(j,"mouseup",X);f.fnMove=S;f.fnUp=X;I.stopPropogation(U,W);I.preventDefault(U,W);}mstrmojo.util.ui._LassoSelector=mstrmojo.provide("mstrmojo.util.ui._LassoSelector",{_mixinName:"mstrmojo.util.ui._LassoSelector",lassoContainer:undefined,lassoSelector:undefined,lassoSelectorEnabled:true,excludeAttrArr:null,boxResizers:null,useDropDownBtn:false,dropDownBtn:undefined,init:function(R){if(this._super){this._super(R);}this.excludeAttrArr=[];this.boxResizers=[];},registerLassoSelector:function(S,W,V){W=W||[];W.push(P.LASSO_SELECTOR);W.push(P.LASSO_RESIZER);W.push(P.BUTTON);this.lassoContainer=S;this.excludeAttrArr=W;this.useDropDownBtn=V||false;I.attachEvent(S,"mousedown",Q(N,this.id));I.attachEvent(S,"click",Q(M,this.id));var R=this.lassoSelector;if(!R){R=this.createLassoSelector();this.lassoSelector=R;}var U=R.parentNode;if(U){U.removeChild(R);}},createLassoSelector:function(){var V,W,S,U=this.boxResizers,R=document.createElement("div");R.setAttribute("class","lasso-selector");R.setAttribute("type",P.LASSO_SELECTOR);R.setAttribute("draggable",false);R.draggable=false;for(V=0;V<9;V++){if(V!==4){W=document.createElement("div");W.setAttribute("class","lasso-selector-resizer");W.setAttribute("type",P.LASSO_RESIZER);W.setAttribute("index",String(V));W.setAttribute("draggable",false);W.draggable=false;R.appendChild(W);U[V]=W;I.attachEvent(W,"mousedown",Q(A,this.id));}}K.addClass(U[0],["top","left"]);K.addClass(U[1],["top"]);K.addClass(U[2],["top","right"]);K.addClass(U[3],["left"]);K.addClass(U[5],["right"]);K.addClass(U[6],["bottom","left"]);K.addClass(U[7],["bottom"]);K.addClass(U[8],["bottom","right"]);if(this.useDropDownBtn===true){S=document.createElement("div");S.setAttribute("type",P.BUTTON);S.setAttribute("class","lasso-selector-dropdown-button");R.appendChild(S);I.attachEvent(S,"click",Q(this.lassoButtonClicked,this.id));this.dropDownBtn=S;}return R;},positionBoxResizers:function(){var U=this.boxResizers,S=this.lassoSelector,V=S.clientWidth,R=S.clientHeight,X=(V-J)>>1,W=(R-J)>>1;U[1].style.left=X+"px";U[3].style.top=W+"px";U[5].style.top=W+"px";U[7].style.left=X+"px";},dismissLassoSelector:function(){var R=this.lassoSelector;if(R){K.removeClass(R,[E,L]);if(R.parentNode){R.parentNode.removeChild(R);}}},isLassoSelectorActive:function(){function S(W,V){var X=W.className.split(/\s+/),U;for(U=0;U<X.length;U++){if(X[U]===V){return true;}}return false;}var R=this.lassoSelector;if(R){return S(R,E);}return false;},getLassoSelectionInfo:mstrmojo.emptyFn,lassoSelected:mstrmojo.emptyFn,lassoSelecting:mstrmojo.emptyFn,lassoButtonClicked:mstrmojo.emptyFn,lassoSelectorResized:mstrmojo.emptyFn});}());(function(){mstrmojo.requiresCls("mstrmojo.Obj","mstrmojo.hash");var B="___value",E="___parent",A="___key_map",D="___IS_LEAF";mstrmojo.netviz.ObservableModel=mstrmojo.declare(mstrmojo.Obj,[],{scriptClass:"mstrmojo.netviz.ObservableModel",init:function(H){var G=[];H=H||{};H=mstrmojo.hash.clone(H);var L=Object.keys(H),F=L.length,K,J;for(K=0;K<F;K++){var I=L[K],M=H[I];if(!(M instanceof Object)){J=new C();J[B]=M;J[D]=true;H[I]=J;}else{H[I]=J=new C(M);}G.push(J);H[I][E]=this;}if(this._super){this._super(H);}this.addDisposable(G);this[A]=H;},getParent:function(){return this[E];},getChildrenKeys:function(){return Object.keys(this[A]);},isLeafNode:function(){return this[D];},getValue:function(){if(this.isLeafNode()){return this[B];}return this.getRawObject();},setValue:function(G,K){var F=this.getValue();var M,J,I,L,H;if(this.isLeafNode()){if(!(G instanceof Object)){if(F!==G){this[B]=G;if(!K){this.raiseEvent({name:"valueChanged",target:this,oldValue:F,newValue:G});}}}else{this[B]=undefined;this[D]=undefined;this[A]=G;M=Object.keys(G);J=M.length;H=this.addDisposable(new C(G));for(I=0;I<J;I++){L=M[I];this[L]=H[L];H[E]=this;}if(!K){this.raiseEvent({name:"valueChanged",target:this,oldValue:F,newValue:G});}}}else{var N=this.getChildrenKeys();J=N.length;for(I=0;I<J;I++){L=N[I];this[L]=undefined;}if(!(G instanceof Object)){this[D]=true;this[B]=G;this[A]=undefined;this[B]=G;if(!K){this.raiseEvent({name:"valueChanged",target:this,oldValue:F,newValue:G});}}else{this[A]=G;M=Object.keys(G);J=M.length;H=this.addDisposable(new C(G));for(I=0;I<J;I++){L=M[I];this[L]=H[L];H[E]=this;}if(!K){this.raiseEvent({name:"valueChanged",target:this,oldValue:F,newValue:G});}}}},stopPropagation:function(F){F._isStopped=true;},raiseEvent:function(G){if(this._super){this._super(G);}if(G._isStopped){return ;}var F=this.getParent();if(F){F.raiseEvent(G);}},getRawObject:function(){var G={},J=this.getChildrenKeys(),F=J.length,I;for(I=0;I<F;I++){var H=J[I],K=this[H];if(K.isLeafNode()){G[H]=K.getValue();}else{G[H]=K.getRawObject();}}return G;}});var C=mstrmojo.netviz.ObservableModel;}());(function(){mstrmojo.requiresCls("mstrmojo.hash","mstrmojo.array","mstrmojo.DocDataService","mstrmojo.mstr.EnumFunction","mstrmojo.warehouse.EnumDatabaseType","mstrmojo.mstr.EnumDSSXMLObjectTypes");mstrmojo.requiresDescs(5421,5422,13355);var P=mstrmojo.hash,L=mstrmojo.array,F=mstrmojo.desc,G=mstrmojo.DocDataService,C=mstrmojo.string,a=mstrmojo.mstr.EnumFunction,b=mstrmojo.mstr.EnumDSSXMLObjectTypes;var c=1;function K(n,d,s,u){var g=n.model,p=n.cmSelCells,t=[],AD=g.getCellTitleInfo(d).title,AF,x,j=function(e){var i=n.getCellForNode(e);t.push(n.getCellUnitIndex(i));AF=i.dpt;},o,AA=d.lv>=0,AG;if(typeof u==="string"&&u.indexOf(";")>0){x=parseInt(u.substring(u.indexOf(";")+1),10);u=parseInt(u.substring(0,u.indexOf(";")),10);}if(x===1&&!s){p.reverse().forEach(j);}else{if(x===1){o=1;p.forEach(j);}else{p.forEach(j);}}AG={oId:AD.id,oTp:AD.otp,depth:AF,ordinals:t.join(","),sliceId:n.sid,viewKey:n.k,funcVal:u,switchOrder:o,art:g.getObjectInfoFromDataset(AD.id).art,isRA:AA};if(AA&&u===a.FunctionApplySimple){var r=g.docModel.datasets[g.data.datasetId];if(r&&r.tables&&r.tables.length>=0&&r.tables[0].dbt===mstrmojo.warehouse.EnumDatabaseType.EssBase){AG.peName=AD.v||AD.n;}else{var k=n.getCellForNode(p[0]),AE=k._e.id;AG.peId=AE;AG.peName=k._e.ori_n||k._e.n;try{if(AD.fix>=0){var h=g.docModel.findUnitInDataSet(AD.id).fs,m=L.filterOne(h,function(e){return e.fnm==="DESC";}).fid;if(m){var AB=n.dataBlocks&&n.dataBlocks[k._gd]||g.data,z=AB.gts[(AD.axis===c)?"row":"col"],l=L.filterOne(z,function(e){return e.id===AD.id&&e.fid===m;}),AC=l.es[k.idx];AG.peName=AC&&(AC.ori_n||AC.n)||AG.peName;}}else{var q;L.forEach(AD.fs,function(w,e){if(w.n==="DESC"){q=e;return false;}});if(q!==undefined){var f=[];if(AD.axis===c){var y;for(y=k.idx;y>-1;y--){if(AD.es[y].id===AE){f=[AD.es[y].ori_n||AD.es[y].n].concat(f);}else{break;}}for(y=k.idx+1;y<AD.es.length;y++){if(AD.es[y].id===AE){f.push(AD.es[y].ori_n||AD.es[y].n);}else{break;}}}else{f=L.map(L.filter(AD.es,function(i){return i.id===AE;}),function(i){return i.ori_n||i.n;});}AG.peName=f[q]||AG.peName;}}}catch(AC){}}}return AG;}function D(f,e,h){var k=f.getDEInfo(e),j=k&&k.deObject&&k.deObject.des,i=1,g=h===-1?F(5187,"Group"):(h===a.FunctionApplySimple?F(13355,"Calculated Member"):F(5188,"Calculation")),d=function(l){return l.n===g+" "+i;};while(true&&j){if(j.some(d)){i++;}else{break;}}f.controller.onAddQuickDE(f,P.copy(K(f,e,false,h),{act:"addQuickDE",deName:g+" "+i}));}function Z(d,f){var e;for(e in d){if(L.find(d[e].att,"did",f)>-1){return e;}}return undefined;}function X(d){var f=d.split(";"),e;if(f.length>1&&f[f.length-2].slice(-1)!=="//"){f.splice(-1,1);}e=f.join(";");return e.replace(/\\:/g,"*:").replace(/\\;/g,";").replace(/\\\\/g,"\\").substring(1);}function A(p,e,l,h,d){var k=l.es,f=l.id,j;d.forEach(function(q){j=q[0];if(j.eid.indexOf(f)<0){k.push({n:C.decodeHtmlString(j.v,true),t:mstrmojo.vi.enums.EnumDerivedElementType.LIST,v:X(j.eid)});}});var g=p.controller,o=p.model&&p.model.docModel,n=g._getXtabCallback(p),i={act:"applyDEChanges",deId:e.did,attId:e.attId,attName:e.attName,dsId:e.dsId,k:p&&p.k,actions:[V(l,h)]};o.addUpdateObjects(i,{id:i.deId||i.attId,type:47,flag:G.PARTIAL_UPDATE_FLAGS.DATA_CHANGE});n=mstrmojo.func.wrapMethods(n,o.getDatasetsUpdateCallback(),o.getUpdateHiddenLayoutsCallback(),{success:function(){o.callOnNDECreated([l]);}});var m=function(q){return function(){if(i&&q){i.partialRetrieval={nodes:Y(p,o,e)};}var r=q?o.wrapUnsetVisualizationFilterAction(i):i;g.submitUndoRedoUpdates(r,{},n,G.REQUEST_DEFN_DATA);};};o.checkAndNotifyVFChangeOnGroupUpdate({actions:i},m(true),m(false));}function V(e,d){return{act:"update",position:d+1,item:e};}function E(f,e,i,h,g){var d=f.model.getCellTitleInfo(e).title;f.controller.onSetDEHierachyOptions(f,{act:"setDEHierarchyOptions",oId:d.id,eId:i.id,splice:h,expand:g});}function O(h,e){var d=[],g=e.t,f=e.did;h.getDropZones().zones.forEach(function(i){((i&&i.items)||[]).forEach(function(k){var l=k.t,j=k.did;if(l!==21&&j!=="-1"&&j!=="00000000000000000000000000000000"&&((l===4&&g===4)||(l!==4&&g!==4))&&j!==f&&L.find(d,"did",j)===-1){d.push(k);}});});h.docModel.getDatasetUnits(g===4?["mx"]:["att"]).forEach(function(i){if(L.find(d,"did",i.did)===-1&&i.did!==f&&!i.hide){d.push(i);}});return mstrmojo.vi.ui.DatasetUnitMenuUtils.getSortedDatasetUnits(d);}function Y(g,d,f){var e=d.getSourceFilterKeys(g.zonesModel.getHost().k);L.forEach(g.parent.parent.children,function(j){var h=j.boxContent.gridInfo;if(h){var k=(h.rows.concat(h.cols)).some(function(l){return l.did===f.did;}),i=e.some(function(l){return l===j.k;});if(k&&!i){e.push(j.k);}}});return e;}mstrmojo.vi.ui.rw._XtabDE=mstrmojo.provide("mstrmojo.vi.ui.rw._XtabDE",{scriptClass:"mstrmojo.vi.ui.rw._XtabDE",derivedElementGroup:function M(d){D(this,d,-1);},addElementsToGroup:function N(f,g,e,d){A(this,f,g,e,d);},derivedElementCalculation:function B(e,d){D(this,e,d);},separateOthers:function Q(d,e){E(this,d,e,1,1);},renameDEList:function I(d){this.controller.onEditQuickDEList(this,P.copy(K(this,d,true,-1),{act:"editQuickDEList",deName:d.v}));},editQuickDECalculationNumberFormat:function J(e,f){var d=K(this,e);d.deId=f.de.id;d.act="editQuickDECalculationNumberFormat";this.controller.editQuickDECalculationNumberFormat(this,P.copy(d,this.model.docModel.createNumberFormatParams(f)));},editDECalculation:function H(e,d){if(d!==undefined&&d!==null){this.controller.editQuickDECalculation(this,P.copy(K(this,e,true,d),{act:"editQuickDECalculation"}));}else{this.controller.onEditQuickDECalculation(this,P.copy(K(this,e,true),{act:"editQuickDECalculation",deName:e.v}));}},createDEParam:function K(d,f,e){return K(this,d,f,e);},removeQuickDE:function S(k,o){var h=o&&o.deObject,i=(h&&h.des)||[],p=this,q=2,n=L.filter(i,function(s){return !s.ido;},{max:q+1});if(h&&(i.length<=q||n.length<=q)){var j=[],m=this.zonesModel.getZoneForObject(h.did),f=O(this.zonesModel,h),e=L.find(f,"did",h.attId),d=e>=0?f[e]:null,l={};if(d&&m){j.push(P.copy({isUngroup:1,deId:h.did},this.model.getAddTemplateUnitAction(d,h.dsId,m.id,L.find(m.items,"did",h.did))));j=[this.zonesModel.getUpdateTemplateAction(j)];l=this.controller._getXtabCallback(this);}j.push({act:"removeNDEFromDS",dsid:h.dsId,oid:h.did,disablePU:true});l=mstrmojo.func.wrapMethods(this.controller.model.getDatasetsUpdateCallback(),this.controller.model.getReloadLayoutModelCallback(),l,this.controller.getReloadLayoutViewCallback());var r=p.model&&p.model.docModel;var g=function(s){return function(){var t=(s&&r)?r.wrapUnsetVisualizationFilterAction(j):j;p.controller.submitUndoRedoUpdates(t,null,l,G.REQUEST_DEFN_DATA);};};r&&r.checkAndNotifyVFChangeOnGroupUpdate({actions:j,zm:r},g(true),g(false));}else{this.controller.removeQuickDE(this,P.copy(K(this,k),{act:"removeQuickDE"}));}},derivedElementsEdit:function U(l,g){if(!g){g=this.getDEInfo(l);}var h=this.model,e=h.getCellTitleInfo(l).title,f=g&&g.deObject,k=g&&g.de,d,j,i;if(!f){d=this.gridData.datasetId||Z(h.docModel.datasets,e.id);j=e.id;i=e.n?C.decodeHtmlString(e.n):undefined;}this.controller.openDEEditor(this,{dsId:d,attId:j,attName:i,deObj:f,elemId:k&&k.id,dispName:l.n?C.decodeHtmlString(l.n):i});},getDEInfo:function W(l){var g=this.model,i=g.getCellTitleInfo(l),j=i.isSrcTitle,e=i.title,d=l.dei,f,k;if((e&&e.ost!==12033)||(j&&l.otp!==b.Consolidation)){return null;}var h=(e&&e.id)||(j&&l.otp===b.Consolidation&&l.id);f=g.docModel.getDEObject(h);if(f&&d!==undefined){k=f.des[d];}return{deObject:f,de:k,ttl:e};},getOthersDEInfo:function R(e){var d;L.forEach(e.des,function(f){if(f.t===4){d=f;return false;}});return d;}});}());(function(){mstrmojo.requiresCls("mstrmojo._HasPopup","mstrmojo.Button","mstrmojo.dom","mstrmojo.Container");mstrmojo.requiresDescs(1442,2140);var C=mstrmojo.dom;mstrmojo.ui.menus.ToolbarEditor=mstrmojo.declare(mstrmojo.Container,[mstrmojo.ui.menus._IsMenuPopup,mstrmojo._IsPopup,mstrmojo._CanAutoClose],{scriptClass:"mstrmojo.ui.menus.ToolbarEditor",markupString:'<div id="{@id}" class="mstrmojo-ui-ToolbarEditor mstrmojo-ui-MenuEditor {@cssClass}" style="..." mstrAttach:mouseover,mouseout,click><div class="te-content"></div></div>',markupSlots:{containerNode:function A(){return this.domNode.firstChild;}},popupConfig:null,children:null,autoCloses:false,locksHover:true,visible:true,onclick:function B(E){C.stopPropogation(null,E.e);},init:function D(F){this._super(F);var E=this.popupConfig,G=E.contents;if(!G){throw new Error("Cannot open editor without editor content.");}this.cssClass=E.cssClass;this.addChildren(G);}});}());(function(){mstrmojo.requiresClsP("mstrmojo","ListBase","_IsList","css","array");var H=mstrmojo.css;var K=0;var C=15;var B="collapsed";var A="expanded";var D="hidden";mstrmojo.VisMenuHierarchicalList=mstrmojo.declare(mstrmojo.ListBase,[mstrmojo._IsList],{scriptClass:"mstrmojo.VisMenuHierarchicalList",prevSelection:{},itemField:"v",selectionPolicy:"toggle",multiSelect:false,init:function N(P){this._super(P);var Q=this;},onRender:function O(){this.collapseAll();},getItemProps:function I(R,P){var Q=this._super(R,P);Q.tag="a";Q.addCls("mstrmojo-ui-Menu-item");Q.addCls("hierarachy");if(!R.isLeaf){var S=R.collapsed?B:A;Q.addCls(S);}if(!R.initVisible){Q.addCls(D);}Q.indent=R.level*C+K;return Q;},getItemMarkup:function L(Q,P){return'<{@tag} class="item {@cls}" idx="{@idx}" style="{@style}" title="{@tt}"><span class="indent" style="padding-left: {@indent}px;"></span><span class="mark" style="position: static;"></span><span class="">{@en@n}</span></{@tag}>';},onselectionChange:function J(P){this._super(P);this.parent.data.set("valid",true);},doItemSelect:function E(R,P){if(R.isLeaf){this._super(R,P);}else{var Q=this._getItemNode(R._renderIdx);R.collapsed=!R.collapsed;if(R.collapsed){H.addClass(Q,B);H.removeClass(Q,A);}else{H.addClass(Q,A);H.removeClass(Q,B);}this.collapseChildren(R,R.collapsed);if(this.parent.adjustCornersForPopupOverflow){this.parent.adjustCornersForPopupOverflow();}if(this.parent.updateScrollbars){this.parent.updateScrollbars();}}},collapseChildren:function G(Q,R){var P=this;(Q.children||[]).forEach(function(S){if(R){P.setVisible(S,false);}else{P.setVisible(S,true);}P.collapseChildren(S,R||S.collapsed);});},setVisible:function M(Q,R){var P=this._getItemNode(Q._renderIdx);H.toggleClass(P,D,!R);},collapseAll:function F(){var Q=this;var P=this.items;if(P){P.forEach(function(S){if(!S.isLeaf){var R=Q._getItemNode(S._renderIdx);S.collapsed=true;H.addClass(R,B);H.removeClass(R,A);Q.collapseChildren(S,S.collapsed);}});}},});}());(function(){mstrmojo.requiresCls("mstrmojo.ui.PopupConfig","mstrmojo.ui.menus.ToolbarEditor","mstrmojo.hash");mstrmojo.ui.menus.ToolbarEditorConfig=mstrmojo.declare(mstrmojo.ui.PopupConfig,[mstrmojo._HasBindings],{scriptClass:"mstrmojo.ui.menus.ToolbarEditorConfig",cssClass:"",contents:null,init:function C(D){this._super(D);this.initBindings();},clear:function A(){this._super();this.contents=null;},newInstance:function B(D){return new mstrmojo.ui.menus.ToolbarEditor(mstrmojo.hash.copy({popupConfig:this},D));}});}());(function(){mstrmojo.requiresCls("mstrmojo.ui.editors.controls.ControlGroup","mstrmojo.array","mstrmojo.hash","mstrmojo.ui.editors.controls.ColorPickerButton","mstrmojo.ui.editors.controls.LineStyleButton");var L=mstrmojo.emptyFn,I=mstrmojo.array,C=mstrmojo.hash,E=mstrmojo.gm.EnumCombinedLineStyle;var J={LINE_COLOR:"Clr",LINE_STYLE:"Style"},A={"1pt solid":E.THIN,"2pt solid":E.THICK,"1pt dashed":E.DASHED,"1pt dotted":E.DOTTED,none:E.NONE};function D(P,O){return C.copy(O,{scriptClass:"mstrmojo.ui.editors.controls.ColorPickerButton",alias:"lineColor",slot:P,selectedValue:"#000000",postselectedValueChange:function(Q){if(this.propName){this.parent.parent.raiseFormatValueChange(this.propName,Q.value,Q.valueWas);}},postclick:function(Q){this.parent.parent.postclick(Q);}});}function K(P){return{scriptClass:"mstrmojo.ui.editors.controls.LineStyleButton",showThickOption:true,showNoneOption:true,hideDashOptions:false,defaultSelectedIndex:3,propName:undefined,alias:"lineStyle",slot:P,postInit:function O(){var Q=["mstrmojo-ui-LineStyle"];if(!this.showNoneOption){Q.push("no-none");}if(this.hideDashOptions){Q.push("no-dash");}mstrmojo.css.addWidgetCssClass(this,Q);(this.list.items||[]).forEach(function(R){R.v=(A[R.id]!==undefined?A[R.id]:A["not defined"]);});},onshowNoneOptionChange:function(Q){var R=["no-none"];if(!Q.value){mstrmojo.css.addWidgetCssClass(this,R);}else{mstrmojo.css.removeWidgetCssClass(this,R);}var S=this.hasRendered;if(S){this.refresh();}},postselectedValueChange:function(R){this._super();var Q=I.find(this.list.items,"id",R.value);if(Q===-1){Q=this.defaultSelectedIndex;}var S=this.list.items[Q].v;if(this.propName){this.parent.parent.setChildEnable(J.LINE_COLOR,S!==A.none);this.parent.parent.raiseFormatValueChange(this.propName,S,A[R.valueWas]);}},postclick:function(Q){this.parent.parent.postclick(Q);}};}mstrmojo.ui.editors.controls.LineConfigGroup=mstrmojo.declare(mstrmojo.ui.editors.controls.ControlGroup,null,{scriptClass:"mstrmojo.ui.editors.controls.LineConfigGroup",propNames:undefined,postclick:L,hideColorControl:false,showGradient:false,showNoFillInColor:true,showAutomaticInColor:false,showNoneOption:true,lineColorAndStyle:undefined,lineTitle:undefined,init:function N(Q){this._super(Q);var O=[],R;O.push(K("col1Node"));if(!this.hideColorControl){O.push(D("col2Node",{showGradient:this.showGradient,showNoFill:this.showNoFillInColor,showAutomatic:this.showAutomaticInColor}));}else{R={col1Width:"100%",dividerWidth:"0",col2Width:"0"};}var P=[];if(this.lineTitle&&this.lineTitle!==""){P.push(new mstrmojo.Label({text:this.lineTitle}));}P.push(C.copy(R,{scriptClass:"mstrmojo.ui.editors.controls.TwoColumnContainer",alias:"lineColorAndStyle",children:O}));this.addChildren(P);},getChildComp:function M(O){if(O.indexOf(J.LINE_COLOR)!==-1){return this.lineColorAndStyle.lineColor;}if(O.indexOf(J.LINE_STYLE)!==-1){return this.lineColorAndStyle.lineStyle;}return null;},iniChildrenComp:function G(P){I.forEach(P,function(R){var Q=this.getChildComp(R);if(Q!==undefined){Q.propName=R;}},this);var O=this.lineColorAndStyle.lineStyle;O.showNoneOption=this.showNoneOption;O.hideDashOptions=this.hideDashOptions;O.postInit();},onshowNoneOptionChange:function(O){this.lineColorAndStyle.lineStyle.set("showNoneOption",O.value);},setChildValue:function F(Q,R){var O=this.getChildComp(Q);if(O===undefined){return false;}var P;switch(O.alias){case"lineColor":if(R!==O.selectedValue){O.set("selectedValue",typeof R==="undefined"?"conflict":R);}break;case"lineStyle":if(typeof R==="undefined"){O.list.clearSelect();this.syncControls(function(){O.set("selectedValue","conflict");});}else{P=I.find(O.list.items,"v",R);if(P===-1){P=O.defaultSelectedIndex;}var S=O.list.items[P].id;if(S!==O.selectedValue){O.set("selectedValue",S);}}break;}},setChildEnable:function H(Q,P){var O=this.getChildComp(Q);if(O!==undefined){O.set("enabled",P);}},setChildrenValue:function B(O){O.forEach(function(P){this.setChildValue(P[0],P[1]);});}});}());(function(){mstrmojo.requiresCls("mstrmojo.ui.editors.controls.ControlGroup","mstrmojo.ui.editors.controls.TwoColumnContainer","mstrmojo.ui.editors.controls.ColorPickerButton","mstrmojo.ui.editors.controls.ValidationTextBox","mstrmojo.hash","mstrmojo.array","mstrmojo.ValidationTextBox","mstrmojo.expr");var K=mstrmojo.emptyFn,B=mstrmojo.hash,H=mstrmojo.array,I=mstrmojo.expr.DTP,F={FILL_COLOR:"Clr",FILL_TRANSPARENT:"FillTrans"},C=1,J=2;function N(U,Q,P,S,R){return{scriptClass:"mstrmojo.ui.editors.controls.ColorPickerButton",alias:"fillColor",slot:U,showNoFill:S!==false,showAutomatic:!!R,showGradient:false,selectedValue:"#000000",isHostedWithin:Q||false,postselectedValueChange:function(V){if(this.propName&&this.parent&&this.parent.parent){this.parent.parent.raiseFormatValueChange(this.propName,V.value,V.valueWas);}},postclick:function(V){this.parent.parent.postclick(V);}};}function O(Q){return{scriptClass:"mstrmojo.ui.editors.controls.TwoColumnContainer",alias:"fillAlpha",slot:Q,col1Width:"100%",col2Width:"10px",children:[{scriptClass:"mstrmojo.ui.editors.controls.ValidationTextBox",alias:"fillAlphaText",slot:"col1Node",value:"100",cssText:"text-align:right",dtp:I.INTEGER,required:true,constraints:{min:0,max:100},onvalueChange:function(R){this.valueWas=R.valueWas;},onValid:function P(){if(this.propName&&this.value!==this.valueWas){this.parent.parent.parent.raiseFormatValueChange(this.propName,this.value,this.valueWas);}},postclick:function(R){this.parent.parent.parent.postclick(R);}},{scriptClass:"mstrmojo.Label",slot:"col2Node",text:"%"}]};}mstrmojo.ui.editors.controls.FillConfigGroup=mstrmojo.declare(mstrmojo.ui.editors.controls.ControlGroup,null,{scriptClass:"mstrmojo.ui.editors.controls.FillConfigGroup",propNames:undefined,postclick:K,visibleControls:C+J,fillColorAndTrans:undefined,init:function M(U){this._super(U);var Q=[],X="col1Node",R=U&&U.colorPickerHostWithin,P=U&&U.showGradient,W=U&&U.showNoFill,S=U&&U.showAutomaticInColor,V;if((this.visibleControls&C)>0){Q.push(N(X,R,P,W,S));X="col2Node";}if((this.visibleControls&J)>0){Q.push(O(X));}if(Q.length===1){V={col1Width:"100%",dividerWidth:"0",col2Width:"0"};}this.addChildren([B.copy(V,{scriptClass:"mstrmojo.ui.editors.controls.TwoColumnContainer",alias:"fillColorAndTrans",children:Q})]);},getChildComp:function L(P){if(P.indexOf(F.FILL_COLOR)!==-1){return this.fillColorAndTrans.fillColor;}if(P.indexOf(F.FILL_TRANSPARENT)!==-1){return this.fillColorAndTrans.fillAlpha.fillAlphaText;}return undefined;},iniChildrenComp:function E(P){this.propNames=P;H.forEach(P,function(R){var Q=this.getChildComp(R);if(Q!==undefined){Q.propName=R;}},this);},setChildValue:function D(Q,R){var P=this.getChildComp(Q);if(P===undefined){return false;}switch(P.alias){case"fillColor":if(R!==P.selectedValue){P.set("selectedValue",R==="undefined"?"conflict":R);}break;case"fillAlphaText":if(R!==P.value){P.set("value",R==="undefined"?"":R);}break;}},setChildEnable:function G(R,Q){var P=this.getChildComp(R);if(P!==undefined){P.set("enabled",Q);}},setChildrenValue:function A(P){var Q=this;P.forEach(function(R){Q.setChildValue(R[0],R[1]);});}});mstrmojo.ui.editors.controls.FillConfigGroup.CTRL_FLAGS={FILL_COLOR:C,FILL_TRANSPARENCY:J};mstrmojo.ui.editors.controls.FillConfigGroup.FillCompName=F;}());(function(){mstrmojo.requiresCls("mstrmojo.locales");mstrmojo.requiresCls("mstrmojo.chart.enums.EnumFontStyle");mstrmojo.requiresCls("mstrmojo.VisUtility");mstrmojo.requiresClsP("mstrmojo.chart.common","DSSDateTime","ScalePlate");mstrmojo.requiresClsP("mstrmojo.chart.model.enums","EnumDSSGraphProperty","EnumDSSGraphDataTextShowType","EnumDSSGraphObject");var h=mstrmojo.chart,d=h.model,p=mstrmojo.VisUtility,Q=h.enums,E=Q.EnumFontStyle,S=d.enums,z=S.EnumDSSGraphProperty,Y=S.EnumDSSGraphDataTextShowType,AA=S.EnumDSSGraphObject;var F=mstrmojo.gm.EnumDataLabels;var W=[["xAxLbFntClr","yAxLbFntClr","dlFntClr","lgdFntClr"],["xAxLbFntFml","yAxLbFntFml","dlFntFml","lgdFntFml"],["xAxLbFntSz","yAxLbFntSz","dlFntSz","lgdFntSz"],["xAxLbFntStyle","yAxLbFntStyle","dlFntStyle","lgdFntFml"]];var q=[["majorGridLnThk","minerGridLnThk","majorGridLnThk","minerGridLnThk"],["majorGridLnClr","minerGridLnClr","majorGridLnClr","minerGridLnClr"],["majorGridLnStyle","minerGridLnStyle","majorGridLnStyle","minerGridLnStyle"]];var Z=[["bgFillClr"],["bgFillStyle"],["bgFillTrans"]];function V(AJ){switch(AJ){case z.DssGraphFontColor:return 0;case z.DssGraphFontName:return 1;case z.DssGraphFontSize:return 2;case z.DssGraphFontStyle:return 3;case z.DssGraphFontSize100:return 4;default:return -1;}}function u(AJ){switch(AJ){case z.DssGraphAreaColor:return 0;case z.DssGraphFillEffect:return 1;case z.DssGraphAreaAlpha:return 2;}return -1;}function x(AJ){var AK;switch(AJ){case AA.DssGraphX1Body:case AA.DssGraphX1Label:case AA.DssGraphX1Major:case AA.DssGraphX1Minor:case AA.DssGraphUserLabel3:case AA.DssGraphUserLine3:AK="X1";break;case AA.DssGraphX2Body:case AA.DssGraphX2Label:case AA.DssGraphX2Major:case AA.DssGraphX2Minor:case AA.DssGraphUserLabel4:case AA.DssGraphUserLine4:AK="X2";break;case AA.DssGraphY1Body:case AA.DssGraphY1Label:case AA.DssGraphY1Major:case AA.DssGraphY1Minor:case AA.DssGraphUserLabel1:case AA.DssGraphUserLine1:AK="Y1";break;case AA.DssGraphY2Body:case AA.DssGraphY2Label:case AA.DssGraphY2Major:case AA.DssGraphY2Minor:case AA.DssGraphUserLabel2:case AA.DssGraphUserLine2:AK="Y2";break;case AA.DssGraphZBody:AK="Z";break;case AA.DssGraphO1Body:case AA.DssGraph2DO1Label:case AA.DssGraphO1Major:case AA.DssGraphO1Minor:AK="O1";break;case AA.DssGraphO2Body:case AA.DssGraph2DO2Label:case AA.DssGraphO2Major:case AA.DssGraphO2Minor:AK="O2";break;default:AK="No_Axis";break;}return AK;}function e(AJ,AK){if(!!AJ===false){return undefined;}return undefined;}function X(AO,AJ){if(!!AO===false){return undefined;}var AT,AR,AQ=AJ.isVertical!==undefined?AJ.isVertical:true,AL=AJ.isGridChart||false,AU=AJ.isPieShape||false,AP={Name:0,Value:0},AM=AO.gaid,AN=AO.goid,AK=AO.gsid,AS=AO.v;if(!!AM===false){return undefined;}switch(AM){case z.DssGraphShowLBLFeeler:if(AU){AP.Name="DataLabel";if((AS&Y.DssGraphDataTextValue)!==0){AP.Value=F.SHOW_VALUE_ONLY;}else{if((AS&Y.DssGraphDataTextLabel)!==0){AP.Value=F.SHOW_TEXT_ONLY;}else{AP.Value=F.HIDE;}}}break;case z.DssGraphAreaColor:case z.DssGraphFillEffect:case z.DssGraphAreaAlpha:AR=u.call(this,AM);if(AR<0){return undefined;}if(AN===AA.DssGraphBackground){AP.Name=Z[AR][0];if(AP.Name.search("Trans")!==-1){AP.Value=AS/255*100;}else{AP.Value=AS;}}break;case z.DssGraphShowLegendText:AP.Name="LegendVisibleness";AP.Value=AS===0?false:true;break;case z.DssGraphSDShowDataText:AP.Name="ShowSeriesDataLabel";AP.Value=AS!==0;break;case z.DssGraphShowDataText:if(AU===false){AP.Name="DataLabel";AP.Value=F.HIDE;if(AS&Y.DssGraphDataTextValue){AP.Value=F.SHOW_VALUE_ONLY;}else{if(AS&Y.DssGraphDataTextLabel){AP.Value=F.SHOW_TEXT_ONLY;}}}break;case z.DssGraphFontColor:case z.DssGraphFontName:case z.DssGraphFontSize100:case z.DssGraphFontSize:case z.DssGraphFontStyle:AP.Value=AS;AT=x.call(this,AN);AR=V.call(this,AM);if(AR<0){return undefined;}if(AR===4){AR=3;AP.Value/=100;}if(AT==="No_Axis"){if(AN===AA.DssGraphDataText){if(AU){return undefined;}AP.Name=W[AR][2];}else{if(AN===AA.DssGraphPieFeelerLabel||AN===AA.DssGraphPieFeelerLabel){if(AU===false){return undefined;}AP.Name=W[AR][2];}else{if(AN===AA.DssGraphLegendText){AP.Name=W[AR][3];}else{return undefined;}}}}else{if(AT[0]==="X"){AP.Name=W[AR][0];}else{if(AT[0]==="Y"){AP.Name=W[AR][1];}else{if(AT[0]==="O"){AP.Name=AQ?W[AR][0]:W[AR][1];}else{return undefined;}}}}break;}return AP;}var U,j=String.fromCharCode,AD=mstrmojo.locales.datetime,AI=0,L=document.getElementById("measureText"),B={},i={};var n=0.03,K=0,R=0,H=0.2;function o(AK){var AJ,AL=[],AM;for(AJ=0;AJ<=AK;AJ++){AM=AJ.toString(16);if(AM.length===1){AM="0"+AM;}AL[AJ]=AM;}U=AL;return AL;}function AG(AJ){var AK=parseFloat(AJ);if(isNaN(AK)===false&&AK!==undefined&&AK!==null){return AK;}return 0;}function D(AJ){AJ=AJ.replace(/ddd/g,"EEE");AJ=AJ.replace(/AM\/PM/g,"a");AJ=AJ.replace(/tt/g,"a");AJ=AJ.replace(/:'/g,":");AJ=AJ.replace(/'\/'/g,"/");AJ=AJ.replace(/\\/g,"");var AK,AM=true,AL=AJ.length;for(AK=0;AK<AL;AK++){if(AJ[AK]==="h"||AJ[AK]==="H"||AJ[AK]===":"){AM=true;}else{if(AJ[AK]===" "&&AM){AM=true;}}if(AJ[AK]==="m"&&AM){AJ=AJ.substring(0,AK)+"M"+AJ.substring(AK+1);}}return AJ;}mstrmojo.chart.common.Utility=mstrmojo.provide("mstrmojo.chart.common.Utility",{point2D:{},rect2D:{},tripleId:{create:function M(AK,AO,AM,AL,AN){if(AK===null||AK===undefined){AK=-3;}if(AO===null||AO===undefined){AO=-3;}if(AM===null||AM===undefined){AM=-3;}var AJ={mObjectId:AK,mSeriesId:AO,mGroupId:AM};if(AL!==undefined&&AL!==null){AJ.angleByIndex=AL;}if(AN!==undefined&&AN!==null){AJ.sliceById=AN;}return AJ;},walks:function l(AN,AL){if(!!AN===false||!!AL===false){return null;}if(AN.length===1){return AL[AN[0]];}var AM=(AN&&AN.length)||0,AK,AJ=AN[AK];for(AK=0;AK<AM;AK++){if(AL[AJ]===undefined){AL[AJ]={};}AL=AL[AJ];}return AL;},equal:function b(AJ,AK){return(AJ.mObjectId===AK.mObjectId&&AJ.mSeriesId===AK.mSeriesId&&AJ.mGroupId===AK.mGroupId);},reset:function r(AL,AN,AM,AK,AJ,AO){AL.mObjectId=AN!==undefined?AN:-3;AL.mSeriesId=AM!==undefined?AM:-3;AL.mGroupId=AK!==undefined?AK:-3;if(AJ!==undefined&&AJ!==null){AL.angleByIndex=AJ;}if(AO!==undefined&&AO!==null){AL.sliceById=AO;}return AL;}},transformProperty:function A(AJ,AL,AK){if(AL===0){return X.call(this,AJ,AK);}return e.call(this,AJ,AK);},abbreviateNumber:function c(AT,AJ){var AU,AK,AV="",AM=(AT<0),AW=(this.isIntegar(AT)===false);if(AW){AJ++;}if(AT<0){AJ++;}var AP=AM?-AT:AT;var AQ=0;if(AP>=1e+27){AP=999;AV="Y";}else{if(AP>=1e+24){AP/=1e+24;AV="Y";}else{if(AP>=1e+21){AP/=1e+21;AV="Z";}else{if(AP>=1000000000000000000){AP/=1000000000000000000;AV="E";}else{if(AP>=1000000000000000){AP/=1000000000000000;AV="P";}else{if(AP>=1000000000000){AP/=1000000000000;AV="T";}else{if(AP>=1000000000){AP/=1000000000;AV="B";}else{if(AP>=1000000){AP/=1000000;AV="M";}else{if(AP>=1000){AP/=1000;AV="K";}else{if(AP>=1){AQ++;}else{if(AP>=0.001){AQ++;}else{if(AP>=0.000001){AQ++;}else{if(AP>=1e-9){AQ++;}else{if(AP>=1e-12){AQ++;}else{AM=false;}}}}}}}}}}}}}}if(this.isIntegar(AP)===false){AU=AP.toString();var AL=5,AO=2,AX;AK=AU.indexOf(".");AX=AU.length-AK-1;if(AX>AL||(AX>AO&&AX>AK)){if(AX>AL&&AJ-AX<0){AO=Math.max(AO,Math.min(AO,AJ-AX));}else{AO=Math.max(1,Math.min(AO,AJ-AX));}AP=AP.toFixed(AO);}}AU=AP.toString();if(this.isIntegar(AP)===false){var AS=AU.length-1;AK=AU.indexOf(".");if(AK!==-1){if(AK>=AS){AU=AU.substring(0,AK);}else{var AR,AN=true;for(AR=AS;AR>AK&&AN;--AR){if(AU[AR]!=="0"){AN=false;}}if(AN){AU=AU.substring(0,AK);}}}}if(AM){AU="-"+AU;}AU+=AV;return AU;},getScalePlate:function AF(AJ){AJ=AJ||false;this.mScalePlate=mstrmojo.chart.common.ScalePlate;if(AJ){this.mScalePlate.clear();}return this.mScalePlate;},prepareScalePlateOptions:function AC(AL,AK,AM){var AJ={mUseLogarithmicScale:AL,mAlwaysIncludeZero:!AL&&(AK||!!(AM&1)||!!(AM&2)),mShowMinLabel:true,mShowMaxLabel:true,mDrawCustomLine:false,mAxisMinValue:0,mAxisMaxValue:0,mAxisCustomValue:0,mUseCustomMinMax:false};return AJ;},evaluateTextMargin:function P(AJ){this.mTextMargins=this.mTextMargins||{};var AK=this.mTextMargins;if(AK[AJ]){return AK[AJ];}var AL=[];AL[0]=Math.floor(AJ*n+0.5);AL[1]=Math.floor(AJ*K+0.5);AL[2]=Math.max(Math.floor(AJ*R+0.5),1);AK[AJ]=AL;return AL;},AlmostZero:function y(AJ){return(Math.abs(AJ)<0.000001);},isValidNumber:function J(AJ){if(typeof AJ==="number"){if(AJ===0){return true;}return !!AJ;}return false;},isIntegar:function k(AJ){return AJ===+AJ&&AJ===(AJ|0);},HasArrayIntersection:function O(AK,AJ){var AL;for(AL=0;AL<AK.length;AL++){if(AJ.indexOf(AK[AL])!==-1){return true;}}return false;},EscapeString:function C(AJ){var AL='"',AK='\\"',AM=new RegExp(AL,"g");return String(AJ).replace(/</g,"&lt;").replace(/>/g,"&gt;").replace(/\\/g,"\\\\").replace(AM,AK).replace(/\r\n/g,"<br/>").replace(/\r/g,"<br/>").replace(/\n/g,"<br/>");},EscapeStringForJSON:function N(AJ){var AL='"',AK='\\"',AM=new RegExp(AL,"g");return String(AJ).replace(/\\/g,"\\\\").replace(AM,AK).replace(/\r/g,"\\r").replace(/\n/g,"\\n");},TrimLastComma:function AE(AK){var AJ;if(!AK.buf||AK.len===-1){return ;}AJ=AK.len;var AL=String(AK.buf[AJ]);if(AL&&AL[AL.length-1]===","){AK.buf[AJ]=AL.slice(0,-1);}},decodeUTF8:function g(AJ){var AK="",AM=0,AO=0,AN=0,AL=0;while(AM<AJ.length){AO=AJ.charCodeAt(AM);if(AO<128){AK+=j(AO);AM++;}else{if((AO>191)&&(AO<224)){AN=AJ.charCodeAt(AM+1);AK+=j(((AO&31)<<6)|(AN&63));AM+=2;}else{AN=AJ.charCodeAt(AM+1);AL=AJ.charCodeAt(AM+2);AK+=j(((AO&15)<<12)|((AN&63)<<6)|(AL&63));AM+=3;}}}return AK;},formatDateTimeValue:function f(AK,AP){var AN=new mstrmojo.chart.common.DSSDateTime({ifTime:AP});var AJ="";var AM="";var AQ=0;while(AQ<AK.length){var AL=1;switch(AK.charAt(AQ)){case"[":AQ++;while(AQ<AK.length&&AK.charAt(AQ)!=="]"){AM+=AK.charAt(AQ);AQ++;}if(AM.length>0&&(AM[0]===">"||AM[0]==="<"||AM[0]==="=")){AM="";}AQ++;break;case"y":AQ++;while(AQ<AK.length&&AK.charAt(AQ)==="y"){AL++;AQ++;if(AL===4){break;}}if(AL===1||AL===2){AJ+=this.fillZeroToWidth(AN.mnYear%100,2);}else{if(AL===3){AJ+=this.fillZeroToWidth(AN.mnYear%100,2);AQ--;}else{if(AL===4){AJ+=AN.mnYear;}}}break;case"M":AQ++;while(AQ<AK.length&&AK.charAt(AQ)==="M"){AL++;AQ++;}if(AL<3){AJ+=this.fillZeroToWidth(AN.mnMonth,AL);}else{if(AL===3){AJ+=AD.MONTHNAME_SHORT[AN.mnMonth];}else{AJ+=AD.MONTHNAME_FULL[AN.mnMonth];}}break;case"d":AQ++;while(AQ<AK.length&&AK.charAt(AQ)==="d"){AL++;AQ++;}if(AL<3){AJ+=this.fillZeroToWidth(AN.mnDay,AL);}else{if(AL===3){AJ+=AD.dayShortNames[AN.mnDay];}else{AJ+=AD.dayNames[AN.mnDay];}}break;case"h":AQ++;while(AQ<AK.length&&AK.charAt(AQ)==="h"){AL++;AQ++;}var AO=AN.mnHour;if(AO===0){AO=12;}if(AO>12){AO-=12;}AJ+=this.fillZeroToWidth(AO,AL);break;case"H":AQ++;while(AQ<AK.length&&AK.charAt(AQ)==="H"){AL++;AQ++;}AJ+=this.fillZeroToWidth(AN.mnHour,AL);break;case"m":AQ++;while(AQ<AK.length&&AK.charAt(AQ)==="m"){AL++;AQ++;}AJ+=this.fillZeroToWidth(AN.mnMinute,AL);break;case"s":AQ++;while(AQ<AK.length&&AK.charAt(AQ)==="s"){AL++;AQ++;}AJ+=this.fillZeroToWidth(AN.mnSecond,AL);break;case"S":AQ++;while(AQ<AK.length&&AK.charAt(AQ)==="S"){AL++;AQ++;}AJ+=this.fillZeroToWidth(AN.mnMillisecond,AL);break;case"a":AO=AN.mnHour;if(AO<12){AJ+=AD.AM_NAME;}else{AJ+=AD.PM_NAME;}AQ++;break;default:AJ+=AK.charAt(AQ++);break;}}if(AM.length!==0){AJ='<SPAN STYLE="COLOR: '+AM+'" >'+AJ+"</SPAN>";}return AJ;},fillZeroToWidth:function m(AN,AL){var AK="",AM=AK+AN;var AJ=AM.length;while(AJ<AL){AM="0"+AM;AJ++;}return AM;},updateCache:function AH(AK,AN,AO){var AM=(AN&&AN.length)||0,AL,AJ,AP=AK;for(AL=0;AL<AM-1;AL++){AJ=AN[AL];if(!AP[AJ]){AP[AJ]={};}AP=AP[AJ];}AP[AN[AM-1]]=AO;},measureTextHeight:function(AO,AL,AS,AP,AJ){var AR,AN=AO;if(AN===" "){AN="\u00A0";}AJ=AJ||"pt";if(typeof AS==="number"){AS=AS+AJ;}var AK="none",AQ="normal";if(AP&E.FS_ITALIC){AK="italic";}if(AP&E.FS_BOLD){AQ="bold";}var AM={fontFamily:AL,fontSize:AS,fontStyle:AK,fontWeight:AQ};if(i&&i.H&&i.H[AL]&&i.H[AL][AS]&&i.H[AL][AS][AP]){AR=i.H[AL][AS][AP];}else{AR=p.measureTextHeight("H",AM,1);this.updateCache(i,["H",AL,AS,AP],AR);}return AR;},measureText:function w(AQ,AN,AW,AR,AL){var AK=true,AJ,AU=AW+1;var AP=AQ;if(AP===" "){AP="\u00A0";}AL=AL||"pt";if(typeof AW==="number"){AW=AW+AL;}if(B&&B[AP]&&B[AP][AN]&&B[AP][AN][AW]&&B[AP][AN][AW][AR]){return B[AP][AN][AW][AR];}if(AK){var AM="normal",AS="normal";if(AR&E.FS_ITALIC){AM="italic";}if(AR&E.FS_BOLD){AS="bold";}var AO={fontFamily:AN,fontSize:AW,fontStyle:AM,fontWeight:AS};if(i&&i.H&&i.H[AN]&&i.H[AN][AW]&&i.H[AN][AW][AR]){AU=i.H[AN][AW][AR];}else{AU=p.measureTextHeight("H",AO,true);this.updateCache(i,["H",AN,AW,AR],AU);}AJ=p.measureTextWidth(AQ,AO,0);}else{if(!L){var AT=document.createElement("div");AT.id="measureText";AT.style.position="absolute";AT.style.top="0";AT.style.visibility="hidden";AT.style.height="auto";AT.style.width="auto";document.body.appendChild(AT);L=AT;}L.innerHTML="";L.appendChild(document.createTextNode(AP));L.style.fontFamily=AN;L.style.fontSize=AW;L.style.fontWeight="normal";L.style.fontStyle="none";if(AR&E.FS_ITALIC){L.style.fontStyle="italic";}if(AR&E.FS_BOLD){L.style.fontWeight="bold";}AJ=L.scrollWidth+1;AU=L.scrollHeight+1;}var AV={Width:AJ,Height:AU};this.updateCache(B,[AP,AN,AW,AR],AV);return AV;},ReplaceDecimalPoint:function AB(AK,AJ){return AK.replace(".",AJ);},ReplaceMinusSign:function t(AJ,AK){return AJ.replace("-",AK);},insert:function G(AK,AJ,AL){if(typeof AK==="string"&&typeof AJ==="string"&&AL<=AK.length){return AK.substr(0,AL)+AJ+AK.substr(AL);}return AK;},InsertThousandSeparator:function s(AL,AM,AQ){var AJ=AQ.mstrDecimalPoint;var AK=AL.indexOf(AJ);if(AK===-1){AK=AL.length;}var AN=0;while(AN<AK&&!this.chk_val(AL.charAt(AN))){AN++;}var AP=AL;var AO;for(AO=AK-3;AO>AN;AO-=3){AP=this.insert(AP,AM,AO);}return AP;},chk_val:function I(AJ){return/^\d+$/.test(AJ);},hFormatValue:function a(AW,AN,Ah,A6){var AU=0;var Ap=0;var Ad=AW.length;var BE=false;if(!A6){A6={};var An=window.navigator.userLanguage||window.navigator.language;var BP=An.split("-");this.mstrLanguageCode=BP[0];this.mstrCountryCode=BP[1]||BP[0];A6.mstrThousandSeparator=mstrmojo.locales.number.THOUSANDSEPARATOR||",";A6.mstrCurrencySymbol="$";A6.mstrDecimalPoint=mstrmojo.locales.number.DECIMALSEPARATOR||".";A6.mstrPercentSign="%";A6.mstrMinusSign="-";}while(AU<Ad){if(AW.charAt(AU)==='"'){AU++;while(AU<Ad&&AW.charAt(AU)!=='"'){AU++;}AU++;}else{if(AW.charAt(AU)==="["){AU++;var Ao="";while(AU<Ad&&AW.charAt(AU)!=="]"){Ao+=AW.charAt(AU);AU++;}if(Ao.length>1&&(Ao.charAt(0)===">"||Ao.charAt(0)==="<"||Ao.charAt(0)==="=")){var AK=-1;var A8=0;switch(Ao.charAt(0)){case">":if(Ao.charAt(1)>="0"&&Ao.charAt(1)<="9"){AK=1;A8=1;}else{if(Ao.charAt(1)==="="&&Ao.length>2&&Ao.charAt(2)>="0"&&Ao.charAt(2)<="9"){AK=2;A8=2;}}break;case"=":if(Ao.charAt(1)>="0"&&Ao.charAt(1)<="9"){AK=3;A8=1;}else{if(Ao.charAt(1)==="="&&Ao.length>2&&Ao.charAt(2)>="0"&&Ao.charAt(2)<="9"){AK=3;A8=2;}}break;case"<":if(Ao.charAt(1)>="0"&&Ao.charAt(1)<="9"){AK=5;A8=1;}else{if(Ao.charAt(1)==="="&&Ao.length>2&&Ao.charAt(2)>="0"&&Ao.charAt(2)<="9"){AK=4;A8=2;}}break;}if(AK>0){var AY=Ao.substr(A8);var BH=parseFloat(AY);if((AK===1&&AN>BH)||(AK===2&&AN>=BH)||(AK===3&&AN===BH)||(AK===4&&AN<=BH)||(AK===5&&AN<BH)){BE=true;}return mstrmojo.num.formatByMask(AW,AN);}}}else{if(AW.charAt(AU)===";"){if(BE){Ad=AU;break;}else{Ap=AU+1;AU++;}}else{AU++;}}}}if(!BE){Ap=0;}AU=Ap;var Au=false;while(AU<Ad){if(AW.charAt(AU)==='"'){AU++;while(AU<Ad&&AW.charAt(AU)!=='"'){AU++;}}else{if(AW.charAt(AU)==="["){AU++;while(AU<Ad&&AW.charAt(AU)!=="]"){AU++;}}else{if(AW.charAt(AU)==="y"||AW.charAt(AU)==="M"||AW.charAt(AU)==="d"||AW.charAt(AU)==="h"||AW.charAt(AU)==="H"||AW.charAt(AU)==="m"||AW.charAt(AU)==="s"||AW.charAt(AU)==="S"){Au=true;break;}else{AU++;}}}}if(Au){var BC="";if(BE){BC=AW.substr(Ap,Ad-Ap);}else{BC=AW;}return mstrmojo.num.formatByMask(BC,AN);}var BG;var Al;var Ar=false;var AQ=false;var BB=false;var Ac=false;var BM=[];var Ag="";var AZ=0;var A7=false;var AX=0;var BN="";var AR="";var Ak="";var A5="";var AV=0;var BJ=0;var BI=false;var A9=A6.mstrCurrencySymbol;var A0=A6.mstrThousandSeparator;var Aw=A6.mstrDecimalPoint;var BA=A6.mstrPercentSign;var A4=A6.mstrMinusSign;AU=Ap;var Aj="";if(AN<0&&!BE){while(AU<Ad&&AW.charAt(AU)!==";"){if(AW.charAt(AU)==='"'){AU++;while(AU<Ad&&AW.charAt(AU)!=='"'){AU++;}}AU++;}AU++;if(AU>=Ad){if(AN<0){BN+="-";}AU=Ap;}}var BO=false;while(AU<Ad){var Aq=false;switch(AW.charAt(AU)){case"[":AU++;while(AU<Ad&&AW.charAt(AU)!=="]"){Ak+=AW.charAt(AU);AU++;}if(Ak.length>0&&(Ak.charAt(0)===">"||Ak.charAt(0)==="<"||Ak.charAt(0)==="=")){Ak="";}AU++;break;case'"':AU++;while(AU<Ad&&AW.charAt(AU)!=='"'){if(BO){AR+=AW.charAt(AU);}else{BN+=AW.charAt(AU);}AU++;}AU++;break;case"#":case"0":var Ab=AW.charAt(AU);BO=true;var Af=1;AU++;while(AU<Ad&&AW.charAt(AU)===Ab){Af++;AU++;}if(AU+1<Ad&&AW.charAt(AU)==="-"&&AW.charAt(AU+1)===Ab){Ac=true;BM.push(Af);AU++;while(true){Af=0;while(AU<Ad&&AW.charAt(AU)===Ab){Af++;AU++;}BM.push(Af);if(AU>=Ad||AW.charAt(AU)!=="-"){break;}AU++;}}while(AU<Ad){if(AW.charAt(AU)===","){if(AU+1<Ad&&AW.charAt(AU+1)===Ab){Ar=true;}else{break;}}else{if(AW.charAt(AU)!==Ab){break;}}AU++;}break;case".":BO=true;AU++;AZ=0;while(AU<Ad&&AW.charAt(AU)==="0"){AZ++;AU++;}if(AZ===0){while(AU<Ad&&AW.charAt(AU)==="#"){AZ++;AU++;}}break;case"E":BJ=6;while(AU<Ad&&AW.charAt(AU)!=="0"){if(AW.charAt(AU)==="+"&&AU<Ad&&AW.charAt(AU+1)==="0"){AQ=true;}else{A5+=AW.charAt(AU);}AU++;}AV=0;while(AU<Ad&&AW.charAt(AU)==="0"){AV++;AU++;}break;case"%":BJ=4;AU++;break;case"(":AU++;BN+="(";break;case")":AU++;AR+=")";break;case"-":AU++;if(AN<0){BN+=A4;}break;case"?":AU++;break;case"/":if(AU>Ap&&AW.charAt(AU-1)==="?"&&AU+1<Ad&&AW.charAt(AU+1)==="?"){BJ=5;A7=false;Al=AU-1;while(Al>Ap&&AW.charAt(Al)==="?"){Al--;}while(Al>Ap&&AW.charAt(Al)===" "){Al--;}if(Al>=Ap&&(AW.charAt(Al)==="#"||AW.charAt(Al)==="0")){A7=true;}AX=0;AU++;while(AU<Ad&&AW.charAt(AU)==="?"){AX++;AU++;}}else{AU++;}break;case",":if(AU>Ap&&(AW.charAt(AU-1)==="0"||AW.charAt(AU-1)==="#")){BB=true;AU++;}Al=AU+1;while(Al<Ad){if(AW.charAt(Al)===","){Al++;continue;}else{break;}}if(Al===Ad||AW.charAt(Al)==="."){BI=true;}if(BI||(!BI&&AU+1<Ad&&AW.charAt(AU+1)===",")){while(AU<Ad&&AW.charAt(AU)===","){AN/=1000;AU++;}AU--;}AU++;break;case";":Aq=true;break;case"$":if(BO){AR+=A9;}else{BN+=A9;}AU++;break;case"_":if(BO){AR+=" ";}else{BN+=" ";}AU++;AU++;break;default:if(BO){AR+=AW.charAt(AU);}else{BN+=AW.charAt(AU);}AU++;}if(Aq){break;}}if(AN<0){AN=-AN;if(BN.length===0){BN=A4;}}var Ay="";if(Ac){var At=0;for(BG=0;BG<BM.length;BG++){At+=BM[BG];}Ay=Aj=this.fillZeroToWidth(At,AN.toFixed());for(BG=0;BG<BM.length-1;BG++){At-=BM[BG];var As=Ay.length-At;Ay=Ay.slice(0,As)+"-"+Ay.slice(As);}}else{switch(BJ){case 0:if(BB){AN/=1000;}var A2=AN;if(A2<0){A2=-A2;}var AJ=0;while(A2>=10){A2/=10;AJ++;}if(AJ>=15){Ay=Aj=this.fillZeroToWidth((AN<0?-AN:AN),10);var Am=Ay.indexOf(".");if(Am!==-1){Ay=Ay.slice(0,Am)+Ay.slice(Am+1);}Ay=Ay.substr(0,16);if(Ay.charAt(15)>="5"){var AT=14;while(AT>=0&&Ay.charAt(AT)==="9"){Ay=Ay.slice(0,AT)+"0"+Ay.slice(AT+1);AT--;}var AO=Ay.charAt(AT);AO++;if(AT>=0){Ay=Ay.slice(0,AT)+AO+Ay.slice(AT+1);}else{Ay="1"+Ay;}}Ay=Ay.substr(0,15);var BF;for(BF=AJ-14;BF>0;BF--){Ay+="0";}if(AN<0){Ay=A4+Ay;}}else{Aj+=(AN+Math.pow(0.1,AZ+6)).toFixed(AZ);Ay=Aj;Ay=this.ReplaceDecimalPoint(Ay,Aw);if(AN<0){Ay=this.ReplaceMinusSign(Ay,A4);}}if(Ar){Ay=this.InsertThousandSeparator(Ay,A0,A6);}if(BB){Ay+=Ag;}break;case 5:if(BB){AN/=1000;}var Ai=10;for(BG=1;BG<AX;BG++){Ai*=10;}var AL={numerator:0,denominator:1};var AS={numerator:1,denominator:1};var AP={numerator:1,denominator:2};var Ax={numerator:0,denominator:1};var Ae=AN>=0;var A3=Math.abs(AN);var A1=parseInt(A3,10);A3-=A1;while(AP.denominator<Ai){if(Math.abs(AG.call(AP)-A3)<1e-15){Ax=AP;break;}if(AG.call(AP)>A3){AS=AP;}else{AL=AP;}AP.denominator=AL.denominator+AS.denominator;AP.numerator=AL.numerator+AS.numerator;}if(AP.denominator>=Ai){if(A3-AG.call(AL)<AG.call(AS)-A3){Ax=AL;}else{Ax=AS;}}if(A1>0){Ax.numerator+=A1*Ax.denominator;}if(Ax.denominator===0){A7=false;}var BD=false;var Az=false;var BL=Ax.numerator;if(A7){A1=Math.floor(Ax.numerator/Ax.denominator);BL=Ax.numerator%Ax.denominator;Az=Az||(BL!==0);if(A1>0){BD=true;Aj+=A1;if(Az){Aj+=" ";}}}if(!Az&&!BD&&BL===0){Aj+="0";}else{if(!Az&&BD&&BL===0){AI++;}else{Aj+=BL;Aj+="/";Aj+=Ax.denominator;}}Ay=Aj;if(!Ae){Ay=A4+Ay;}if(Ar){Ay=this.InsertThousandSeparator(Ay,A0,A6);}if(BB){Ay+=Ag;}break;case 4:AN*=100;Aj+=(AN+Math.pow(0.1,AZ+6)).toFixed(AZ);Ay=Aj;Ay=this.ReplaceDecimalPoint(Ay,Aw);if(AN<0){Ay=this.ReplaceMinusSign(Ay,A4);}if(Ar){Ay=this.InsertThousandSeparator(Ay,A0,A6);}Ay+=BA;break;case 6:var Av=AN;var BK=0;if(Av>1){while(Av>=10){Av/=10;BK++;}}else{if(Av!==0){while(Av<1){Av*=10;BK--;}}}Aj+=(Av+Math.pow(0.1,AZ+6)).toFixed(AZ);Aj+=A5;if(AQ&&BK>=0){Aj<<"+";}if(BK<0){Aj<<"-";BK=-BK;}Aj+=this.fillZeroToWidth(BK,AV);Ay=Aj;Ay=this.ReplaceDecimalPoint(Ay,Aw);if(AN<0){Ay=this.ReplaceMinusSign(Ay,A4);}break;}}var AM=BN+Ay+AR;var Aa=false;if(Ak.length!==0&&Aa){AM='<SPAN STYLE="COLOR: '+Ak+'" >'+AM+"</SPAN>";}return AM;}});}());(function(){mstrmojo.requiresCls("mstrmojo.registry","mstrmojo.hash","mstrmojo.Label","mstrmojo.array","mstrmojo.Popup","mstrmojo.Box","mstrmojo.ui.editors.controls.ColorPickerButton","mstrmojo.ui.PopupConfig","mstrmojo.ui.Pulldown","mstrmojo.ui.editors.controls.LineStyleButton","mstrmojo.dom","mstrmojo.models.FormatModel","mstrmojo.VisUtility");var G=mstrmojo.array,K=mstrmojo.hash,D=mstrmojo.dom,J=mstrmojo.VisUtility,L=11,A=mstrmojo.models.FormatModel.ENUM_PROPERTY_NAMES;function Q(){var V=L,W,U=[],Y=Math.round(100/(V-1));for(W=0;W<V;W++){var X=(W*Y)/100,S=(W*Y)+"%";if(W===V-1){S="100%";X=1;}U.push({n:S,did:X});}return U;}function M(){var S=[{n:mstrmojo.desc(12100,"Circle"),did:"Circle"},{n:mstrmojo.desc(12101,"Square"),did:"Square"},{n:mstrmojo.desc(14433,"Diamond"),did:"Diamond"},{n:mstrmojo.desc(14434,"Hexagon"),did:"Hexagon"},{n:mstrmojo.desc(14435,"Triangle"),did:"Triangle"},{n:mstrmojo.desc(12103,"Ring"),did:"Ring"}];return S;}function F(W){var U=L,V,S=0,X=Math.round(100/(U-1));W=Math.round(W*100);for(V=0;V<U;V++){if(Math.abs(W-V*X)<0.5*X){S=V;break;}}return S;}function I(S){S=S||[];G.forEach(S,function(U){U.cssDisplay="inline-block";});return{scriptClass:"mstrmojo.Box",cssClass:"row-container",children:S};}function B(V,S,U,X){X=X||"60px";var W=new mstrmojo.ui.Pulldown({items:V,width:X});W.set("selectedIndex",S);W.postselectedIndexChange=function(Y){var Z=Y.value,a=V[Z]&&V[Z].did;G.forEach(U,function(b){b.setValue(a);});};return{scriptClass:"mstrmojo.Box",children:[W]};}function O(U,S){return K.copy(S,{scriptClass:"mstrmojo.Label",text:U,cssText:"width: 60px;"});}function H(S,V){var U;G.forEach(S,function(X,W){if(X===V||X.did===V){U=W;return false;}});return U;}function N(V,S,U){U.shapeIndex=H(M(),V.shape.getValue());U.fillColorValue=V.color.value.getValue();U.opacityIndex=F(V.color.opacity.getValue());U.borderColorValue=V.border.color.value.getValue();U.borderStyleValue=V.border.style.getValue();S.push(V);}function R(X,a,Z){var d=X.circleStyle.fromNode,Y=X.circleStyle.toNode,g=d.shape.getValue(),W=Y.shape.getValue(),U=d.color.value.getValue(),b=Y.color.value.getValue(),e=d.color.opacity.getValue(),V=Y.color.opacity.getValue(),h=d.border.color.value.getValue(),S=Y.border.color.value.getValue(),c=d.border.style.getValue(),f=Y.border.style.getValue();Z.shapeIndex=g===W?H(M(),g):-1;Z.fillColorValue=U===b?U:"conflict";Z.opacityIndex=e===V?F(e):-1;Z.borderColorValue=h===S?h:"conflict";Z.borderStyleValue=c===f?c:"conflict";a.push(d);a.push(Y);}function E(S){if(!K.equals(S.value,S.valueWas)){G.forEach(this.models,function(U){U.setValue(S.value);});}}var C={background:function(U,S){var W=(S&&S.label)||mstrmojo.desc(3905,"Background"),V=mstrApp.getThemeClassName()||"";return{scriptClass:"mstrmojo.Popup",cssClass:"widget-inner-context-menu "+V,locksHover:true,children:[I([O(W),{scriptClass:"mstrmojo.Box",children:[{scriptClass:"mstrmojo.ui.editors.controls.ColorPickerButton",isHostedWithin:true,cssClass:V,selectedValue:U.value.getValue(),model:U.value,showNoFill:false,width:"60px",postselectedValueChange:function(X){this.model.setValue(X.value);}}]}])]};},bubble:function(U,S){var Z=mstrApp.getThemeClassName()||"",Y=U.circleStyle.fromNode,W=U.circleStyle.toNode,V=[],X={shapeIndex:-1,fillColorValue:"conflict",opacityIndex:-1,borderColorValue:"conflict",borderStyleValue:"conflict"};if(S.alignment.attSrc==="from"){N(Y,V,X);}else{if(S.alignment.attSrc==="to"){N(W,V,X);}else{R(U,V,X);}}return{scriptClass:"mstrmojo.Popup",cssClass:"widget-inner-context-menu "+Z,locksHover:true,children:[I([O(mstrmojo.desc(2923,"Shape")),B(M(),X.shapeIndex,V.map(function(a){return a.shape;}),"128px")]),I([O(mstrmojo.desc(2885,"Fill")),{scriptClass:"mstrmojo.Box",children:[{scriptClass:"mstrmojo.ui.editors.controls.ColorPickerButton",isHostedWithin:true,cssClass:Z,showNoFill:false,selectedValue:X.fillColorValue,models:V.map(function(a){return a.color.value;}),width:"60px",postselectedValueChange:E}]},B(Q(),X.opacityIndex,V.map(function(a){return a.color.opacity;}))]),I([O(mstrmojo.desc(9736,"Border")),{scriptClass:"mstrmojo.Box",children:[{scriptClass:"mstrmojo.ui.editors.controls.ColorPickerButton",isHostedWithin:true,cssClass:Z,showNoFill:false,showGradient:false,selectedValue:X.borderColorValue,models:V.map(function(a){return a.border.color.value;}),width:"60px",postselectedValueChange:E}]},{scriptClass:"mstrmojo.Box",children:[{scriptClass:"mstrmojo.ui.editors.controls.LineStyleButton",width:"60px",isHostedWithin:true,models:V.map(function(a){return a.border.style;}),selectedValue:X.borderStyleValue,postselectedValueChange:E}]}]),I([O(mstrmojo.desc(11993,"Data Labels")),{scriptClass:"mstrmojo.Box",children:[{scriptClass:"mstrmojo.ui.editors.controls.CharacterGroup",cssClass:"mstrmojo-ui-ToolbarCharacter cf",layoutConfig:null,showNoFillInColor:false,width:"397px",height:"22px,",onGroupValueChange:J.getCharGroupValueChangeCb(U.circleLabelStyle)}]}])]};}};function P(Z,X,Y,U){var W=C[Z];if(W){var S=W(X,U),a=D.position(this.containerNode,true),c=Y.pageX-a.x,b=Y.pageY-a.y;var V=this._contextMenuAnchor;if(!V||!V.parentElement){V=document.createElement("div");V.style.position="absolute";this._contextMenuAnchor=V;this.containerNode.appendChild(V);}V.style.left=c+1+"px";V.style.top=b+1+"px";var d={hostId:this.id,hostElement:V,isHostedWithin:false};if(U&&U.alignment){d.alignment=U.alignment;}S.popupConfig=new mstrmojo.ui.PopupConfig(d);S.visible=true;S.onClose=function(){this.unrender();};return S;}}mstrmojo.netviz._HasNetworkContextMenu=mstrmojo.provide("mstrmojo.netviz._HasNetworkContextMenu",{getWidget:function(){return this.owner;},showContextMenu:function(X,W,Y,S){var V=P.call(this,X,W,Y,S);if(S&&J.getPropertyByPath(S,"alignment.attSrc",false)!==false){if(S.alignment.attSrc==="from"){this.parent.textSelectedIndex=1;}else{if(S.alignment.attSrc==="from and to"){this.parent.textSelectedIndex=0;}else{this.parent.textSelectedIndex=2;}}}if(X==="bubble"){V=mstrmojo.registry.ref(V);var U=J.getPropertyByPath(V,"children.3.children.1.children.0");if(U!==undefined){U.setFormatSource(this.getDataLabelFormats());U.fontColor.isHostedWithin=true;U.fontSize.isHostedWithin=true;U.fontFamily.isHostedWithin=true;}}this.openPopup(V);},unrender:function(S){this._contextMenuAnchor=undefined;this._super(S);}});}());(function(){mstrmojo.requiresCls("mstrmojo.Box","mstrmojo.dom","mstrmojo.css","mstrmojo.string","mstrmojo.VisUtility");var M=mstrmojo.css,I=mstrmojo.VisUtility,L=mstrmojo.array,N=mstrmojo.string,F="vis-tooltip",E=20,C=165,D="px";function Q(){var U=this.domNode;U.innerHTML="";var R=document.createElement("div");R.className=F+"-container";var V=document.createElement("table");V.className=F+"-table";for(var S=0;S<2;S++){V.appendChild(document.createElement("COL"));}R.appendChild(V);this.domNode.appendChild(R);return V;}function K(S){var R=[],U=false;L.forEach(S,function(V){if(!V.isSuper){R.push(V.v);}else{U=true;R.push("<sup>"+V.v+"</sup>");}});return{hasSuper:U,htmlText:R.join("")};}mstrmojo.VisTooltip=mstrmojo.declare(mstrmojo.Box,null,{scriptClass:"mstrmojo.VisTooltip",init:function P(R){this._super(R);M.addWidgetCssClass(this,(R&&R.widgetClass)?[R.widgetClass,F]:F);},toggle:function H(R){var S=mstrApp.isAppStatePrintPreview&&mstrApp.isAppStatePrintPreview();if(this.domNode){this.domNode.style.display=R&&!S?"block":"none";}},displayInfo:function O(X,a,R,S){var V=this.domNode,c=Q.call(this),Y=false,U=0,Z=0,b=c.childNodes[0],W=c.childNodes[1];X.forEach(function(k){var s,i,u,o,d,h,q,m,w,l,t,r,n=false,j=false;var e=c.insertRow(-1),g=e.insertCell(-1),p=e.insertCell(-1);e.className=F+"-tr";g.className=F+"-name "+F+"-td";p.className=F+"-value "+F+"-td";if(k===null){M.addClass(e,"separator");Y=true;}else{if(Y){M.addClass(e,"below-separator");}s=k.n;r=!k.skipEncode;g.innerHTML=r?N.encodeHtmlString(s,true):s;u=I.getComputedFontStyle(g);if(S){o=Math.ceil(I.measureTextWidthWithSpan(g.innerHTML,u,u.bonus,null,true,true));}else{o=Math.ceil(I.measureTextWidth(g.innerHTML,u,u.bonus));}q=3;if(o>C){m=I.truncateTextToLineWithWordWrap(s,u,C,q,true);if(m.canWordWrap){g.innerHTML=r?N.encodeHtmlString(m.text,true):m.text;}else{m=I.truncateTextToLineWithWordWrap(s,u,C,1);g.innerHTML=r?N.encodeHtmlString(m,true):m;}n=true;}U=Math.min(Math.max(U,o),C);i=k.v;l=k.isTrendLineFuncToken;if(l){w=K(i);}if(!l||!w.hasSuper){if(l){i=w.htmlText;}p.innerHTML=r?N.encodeHtmlString(i,true):i;d=I.getComputedFontStyle(p);if(S){h=Math.ceil(I.measureTextWidthWithSpan(p.innerHTML,u,u.bonus,null,true,true));}else{h=Math.ceil(I.measureTextWidth(p.innerHTML,d,d.bonus,null,true));}if(h>C){m=I.truncateTextToLineWithWordWrap(i,d,C,k.noTruncate?100:q,true);if(!m.canWordWrap){m=I.truncateTextToLineWithWordWrap(i,d,C,1,true);}p.innerHTML=r?N.encodeHtmlString(m.text,true):m.text;h=m.maxLineLen;j=true;}Z=Math.min(Math.max(Z,h),C);}else{p.innerHTML=w.htmlText;d=I.getComputedFontStyle(p);h=0;L.forEach(i,function(x){x.textWidth=I.measureSuperTextWidth(x.isSuper,x.v,d,d.bonus);h+=x.textWidth;});h=Math.ceil(h);if(h>C){m=I.truncateTextToLineWithWordWrapForTokens(i,d,C,k.noTruncate?100:q,true,true);if(!m.canWordWrap){m=I.truncateTextToLineWithWordWrapForTokens(i,d,C,1,true);}p.innerHTML=K(m.text).htmlText;h=m.maxLineLen;j=true;}Z=Math.min(Math.max(Z,h),C);}var f=parseInt(M.getComputedStyle(g).paddingRight);b.style.width=(U+f+1)+"px";W.style.width=(Z+1)+"px";t=U+Z+f;c.style.width=(t+2)+"px";Y=false;if(n||j){M.addClass(e,"wrapped");}}});if(a){this.moveTo(a.x,a.y);}},moveTo:function(a,Z){var Y=mstrmojo.dom.position(document.body),W=this.domNode,b=W.offsetWidth,X=W.offsetHeight,V=Y.x+Y.w,c=Y.y+Y.h,S=a+E,R=Z+E;if(S>V-b||R>c-X){if(S<=V-b){R=c-X;}else{if(R<=c-X){S=V-b;}else{S=V-b;R=Z-E-X;}}}var U=W.style;U.left=S+D;U.top=R+D;},doLayout:function A(R){var U=this.domNode.getElementsByTagName("table")[0];if(!U){return ;}var V=M.getComputedStyle(this.domNode),S=R-parseInt(V.paddingLeft,10)-parseInt(V.paddingRight,10);S-=U.rows[0].cells[0].offsetWidth;U.getElementsByClassName(F+"-value").forEach(function(W){W.style.maxWidth=S+D;});},posTo:function B(S){var R=this.domNode.style;R.left=S.x+D;R.top=S.y+D;},renderErrMsg:function G(R){Q.call(this).insertRow(-1).insertCell(-1).innerText=R;},hide:function J(){var R=this.domNode;this.toggle(false);if(R&&R.parentNode){R.parentNode.removeChild(R);R.innerHTML="";}}});}());(function(){mstrmojo.requiresCls("mstrmojo.array","mstrmojo.vi.ui.rw._HasVisSelections","mstrmojo.VisUtility");var D=mstrmojo.array;var E=mstrmojo.VisUtility;var C=mstrmojo.vi.ui.rw.SelectionType;var G=2;function B(J){var I=-1;var K=this.modelData.gts.row||[],H=K.length,L;for(L=0;L<H;L++){if(K[L].id===J){I=L;}}return I;}mstrmojo.netviz._SupportNetworkBrushesAndHighlights=mstrmojo.provide("mstrmojo.netviz._SupportNetworkBrushesAndHighlights",{_mixinName:"mstrmojo.netviz._SupportNetworkBrushesAndHighlights",prepareSelectedNodesInfo:function(H,I){if(I===true){this.clearCxtMnuSelection();}else{this.clearSelections();}var J=I===true?this.getContextMenuSelectedNodes():this.getSelectedNodes();if(H instanceof Function){J=H.call(this,J);}D.forEach(J,function(L){var K=L.attributeElements;if(I===true){this.addContextMenuAttributeSelection(L.attribute.id,K[0].id,E.pluck(K,"name").join(":"));}else{this.addAttributeSelection(L.attribute.id,K[0].id,E.pluck(K,"name").join(":"));}},this);},highlight:function(Z,g){if(this._super){this._super.apply(this,arguments);}if(this.noHighlightAfterKeepOnlyExcludeDrill){return ;}var K,J,H,b,V,c=[],Y,U,R=[],d=this.stage,X=(d&&d.spriteCollection)||[],M,L,P,N,O=this.model;if(!this.stage){return ;}function Q(n,k){var o,m,j,i,l=[],h;if(n){l.push(n);}if(k){l.push(k);}D.forEach(l,function(p){o=p.sprite;if(o&&c.indexOf(o)===-1){c.push(o);}});h=l.length;if(h===2){j=l[0].edges;i=l[1].edges;D.forEach(j,function(p){U=p&&p.sprite;if(i.indexOf(p)!==-1&&R.indexOf(U)===-1){R.push(U);}});}else{if(h===1){m=l[0].edges;D.forEach(m,function(p){U=p&&p.sprite;if(U&&R.indexOf(U)===-1){R.push(U);}});}}}function W(h){var i=null;D.forEach(X,function(j){if(j.type==="Circle"&&j.text===h){i=j;return false;}});return i;}function S(h){var l=null,i,k,j=[];D.forEach(X,function(m){if(m.type==="Circle"){i=m.unit;k=i?i.attributeElements:[];if(i&&i.hasSelfLoop){j=i.secondaryAttributeElements;}k=k.concat(j);D.forEach(k,function(n){if(O.compareElementsId(n.id,h)){l=m;return false;}});if(l){return false;}}});return l;}function a(h){D.forEach(h,function(i){if(i){d.addToSelection(i);}});}function f(h){D.forEach(h,function(i){d.addToSelection(i);});}function e(){a(c);f(R);d.draw();}function I(h){var i="";D.forEach(h||[],function(j){i+=j.n+" ";});i=i.substring(0,i.length-1);return i;}if(Z===C.ATTS){d.clearSelection();for(K in g){if(g.hasOwnProperty(K)){J=g[K];for(H in J){if(J.hasOwnProperty(H)){b=B.call(this,H);if(b<0){continue;}V=J[H];if(V&&V.length>0){Y=S.call(this,V[0].id);}if(Y&&c.indexOf(Y)===-1){c.push(Y);}}}}}e();}else{if(Z===C.METRICS){d.clearSelection();for(K in g){if(!g.hasOwnProperty(K)){continue;}J=g[K];M=null;L=null;P=null;N=null;for(H in J){if(!J.hasOwnProperty(H)){continue;}b=B.call(this,H);if(b<0||b>1){continue;}else{if(b===0){V=J[H];if(V&&V.length>0){P=S.call(this,V[0].id);}M=P&&P.unit;}else{if(b===1){V=J[H];if(V&&V.length>0){N=S.call(this,V[0].id);}L=N&&N.unit;}}}}Q(M,L);}e();}else{if(Z===C.EMPTY){d.clearSelection();d.draw();}}}},singleUnitSelect:function A(){var J=this.getSelections().length>0||this.clearSelectionsFlag;if(this.clearSelectionsFlag){delete this.clearSelectionsFlag;}if(J){var I=function(){var L=this.model.scm,N=Object.keys(L||{}),P=(N&&N[0])||"",O=this.model.data.gts.row,M=this.model.data.gts.col;D.forEach(O.concat(M),function(Q){if(N.indexOf(Q.id)!==-1){P=Q.id;return false;}});return P;};var K=function(){var L={};L.tid=I.call(this);L.eid="";L.isClearAll=false;L.anchor=this.domNode;L.at=G;L.selections=this.getSelections();L.selectionType=this.getSelectionType();if(L.selections.length&&L.selections[0][0].tid){L.tid=L.selections[0][0].tid;}return L;};var H=K.call(this);this.performAction([H]);}},clearSelections:function(H){this.clearSelectionsFlag=true;if(this._super){this._super();}if(H&&this.stage){this.stage.dismissLassoSelector();this.stage.clearSelection();this.stage.draw(false);}},clearCxtMnuSelection:function F(){if(this._super){this._super();}}});}());(function(){mstrmojo.requiresCls("mstrmojo.gm.GMEnums","mstrmojo.hash","mstrmojo.DocDataService","mstrmojo.VisEnum.GMLegendFormatingPropertyTag","mstrmojo.VisUtility");var N=mstrmojo.gm.EnumTRFManipulations;var J=mstrmojo.array,C=mstrmojo.hash,M=mstrmojo.func.wrapMethods,G=mstrmojo.func.composite,I=mstrmojo.VisEnum.GMLegendFormatingPropertyTag;var D={silent:false,undo:mstrmojo.emptyFn,redo:mstrmojo.emptyFn};function K(O){return O.model.controller.cmdMgr;}function L(){return(this.getDocModel&&this.getDocModel())||this.model.docModel;}function H(){return{success:function O(){this.raiseEvent({name:"regenerateToolbar"});}.bind(this)};}function E(P,R){var O,V,Q,S,U={};U.tks=this.k;U.selectorObjects=P;U.keepOnly=!!R;U.isDocVis=true;O=L.call(this);V=O.getDataService();Q=V.getGMViewFilterAction(U);S=O.getSliceCallback(U);return{action:Q,callbacks:S};}function B(Q,P){var O,S,R;O=L.call(this);R=O.getDataService();if(!this.isXMLDirty()){R.submitUpdates(Q,P);}else{S=this.getPersistAction();R.submitUpdates([Q,S],P);this.resetXMLDirtyFlag();}}function A(){var c=this.modelData||this.model.data,S=c.k,a,Z="FormattingWidget",V,U,Y,P,Q,R=[],X=[],W=this.edtModel;if(!c){console.log("warning: modelData is missing");return null;}var b=function(e,g){var d=U.createElement(g),f;if(e instanceof Object){for(f in e){if(e.hasOwnProperty(f)){var h=b(e[f],f);if(h){d.appendChild(h);}}}}else{d.setAttribute("value",e);}return d;};var O=function(d){return d.replace(/&/g,"&amp;").replace(/</g,"&lt;").replace(/"/g,"&quot;");};Y=this.createWidgetPropsXML?this.createWidgetPropsXML():null;if(!Y||Y.length===0){V=this.getProperties(S);if(this.useCompatibleXML){U=(new DOMParser()).parseFromString("<widgetProps></widgetProps>","text/xml");U.firstChild.appendChild(b(V,"fmt"));}else{U=(new DOMParser()).parseFromString("<props><widgetProps></widgetProps></props>","text/xml");U.firstChild.firstChild.appendChild(b(V,"fmt"));}Y=(new XMLSerializer()).serializeToString(U);}P=O(Y);Q={act:"setProperty",nodeKey:S,prs:Z,pri:4,v:P};R.push(Q);return R;}function F(P,Q,O,U){if(!(U instanceof Function)){return D;}var S=this.id;function R(V){return function(){var X=mstrmojo.all[S],W;if(!X){return ;}W=X.getProperties();W[P]=V;U.call(X,V,true);X.getDocModel().selectVIUnit(X.parent.id,true);};}return{silent:true,undo:R(O),redo:R(Q)};}mstrmojo._VizSelectionHelper=mstrmojo.provide("mstrmojo._VizSelectionHelper",{postBuilderingCalled:false,listenToUpdateColorMap:function(R){if(mstrmojo.VisUtility.isOnExpressMode()){return ;}var Q=this,P,O=(Q.getDocModel&&Q.getDocModel())||Q.model.docModel;if(O){return O.attachEventListener("colorMapChanged",Q.id,function(U){P=Q.parent&&Q.parent.parent;if(Q.forceUpdateColorMap||(P&&P.isPanelDisplaying())){R.call(Q);}else{var S=P.attachEventListener("panelDisplaying",Q.id,function(V){if(Q.postBuilderingCalled){R.call(Q);}P.detachEventListener(S);});}});}},detachUpdateColorMapListener:function(P){if(!P){return ;}var O=(this.getDocModel&&this.getDocModel())||this.model.docModel;O.detachEventListener(P);},updateTargets:function(P){var S={},Q=this,O=L.call(this);S.fromGM=true;S.type=1;S.src=this.k;S.selectorObjects=P;function R(W){var U=Q.modelData||Q.model.data,V=U.sc;if(V!==undefined){return V[W];}return undefined;}S.keepOnly=true;S.ck=R.call(this,"ck");S.keyContext=S.ck;S.tks=R.call(this,"tks");S.ckey=R.call(this,"ckey");S.isDocVis=true;S.include=true;S.showall=R.call(this,"showall");O.slice(S);},updateAfterViewFilter:function(Q,O){var W,V,P,U,S,X,R;W=L.call(this);V=W.getDataService();U=E.call(this,Q,O);P=U.action;S=U.callbacks;R=this.model.controller||W.controller;if(this.currKeepOnlyAction){X=[C.clone(this.currKeepOnlyAction)];}else{X=E.call(this,[],false).action;}this.currKeepOnlyAction=P;R.submitUndoRedoUpdates([P],X,S);},updateAfterKeepOnly:function(Q){var P=L.call(this),O=this.model.controller||P.controller,R=M(O._getXtabCallback(this),H.call(this));O.applyKeepOnly(this,R,{keepOnly:Q,data:this.getContextMenuSelections()},Q?-2:undefined);},updateAfterKeepOnlyForMultiTemplate:function(Q){var P=L.call(this),O=this.model.controller||P.controller,R=M(O._getXtabCallback(this),H.call(this));O.applyKeepOnlyForMutilTemplate(Q,R,true);},updateAfterDrill:function(O,d,Z){var a=this,e=L.call(this),c=e.getDataService(),U=c.newUpdate(),R=this.getContextMenuSelections(),P=Z||this,S=P.model,V=P.model.data||P.node.data,Y=S.getSelectorDataFromTemplateLimit(V.tpl).concat({keepOnly:true,data:R}),Q=e.getKeepOnlyOrExcludeAction(V.k,Y),W=a.model.controller||e.controller,X=W._getXtabCallback(a);U.add(O,M(d,X));U.add(Q,H.call(a));K(a).execute({execute:function b(){this.submitUpdate(U);},urInfo:{callback:U.callback}});},updateAfterSort:function(R){var P=this,O=L.call(this),S=O.getDataService(),U=O.getSliceCallback({tks:P.k});K(P).execute({execute:function Q(){var W=S.newUpdate(this,undefined),V={act:"sortGM",nodeKey:P.k,subActions:R,partialUpdate:{nodes:[P.k]}};W.add(V,U,undefined);if(P.isXMLDirty()){W.addActions(P.getPersistAction());}this.submitUpdate(W,undefined);},urInfo:{callback:U}});},updateAfterAction:function(U,O,P,b,Y){if(!U){return ;}var W=this,Q=W.parent&&W.parent.id,c=W.model.docModel,V=W.model.controller||c.controller,a,Z,S={},X,R=Y||D;if(P){a=mstrmojo.emptyFn;X=function(){this.submitSilent(U);};}else{a=c.getSliceCallback({tks:this.k});a.success=G([a.success,function(){c.selectVIUnit(Q,true);}]);X=function(){this.submit(U,a,S);};}Z=V._getXtabCallback(W);if(O){a=M(a,O);Z=M(Z,O);}Z.success=G([Z.success,function(){c.selectVIUnit(Q,true);}]);if(P){C.copy(mstrmojo.DocDataService.SUPPRESS_DATA,S);}if(b){C.copy(mstrmojo.DocDataService.REQUEST_DEFN_DATA,S);}K(this).execute({execute:X,urInfo:{silent:R.silent,callback:Z,redo:R.redo,undo:R.undo}});},getProperties:mstrmojo.emptyFn,getSetPropertiesAction:A,updateAfterPropertiesChange:function(P,Q,O,R){this.updateAfterAction(A.call(this),P,Q,O,R);},setProperty:function(W,R,U){var P=U.callback,Q=!!U.suppressData,Y=U.requestDefinition,S=U.clientUndoRedoCallback,X=this.getProperties(),O=X[W],V;if(W===I.COLOR_SQUARE_COLOR){if(this.colorSqureIdentity){this.updateColorMap(this.colorSqureIdentity.comb,R);}}else{if(X&&(X[W]===undefined||X[W].toString()!==R.toString())){X[W]=R;V=F.call(this,W,R,O,S);this.updateAfterPropertiesChange(P,Q,Y,V);}}},showData:function(O){if(!this.gridData){this.gridData=this.model.data;}mstrmojo.vi.ui.ViewDataDialog.open(this.parent,true);}});}());(function(){mstrmojo.requiresCls("mstrmojo.Widget","mstrmojo.dom","mstrmojo.string","mstrmojo.gm._IsAnchorable","mstrmojo.ui._HasUITheme","mstrmojo.VisUtility");var E=mstrmojo.dom,D=mstrmojo.string,F=mstrmojo.VisUtility;mstrmojo.gm.DndTooltip=mstrmojo.declare(mstrmojo.Widget,[mstrmojo.gm._IsAnchorable,mstrmojo.ui._HasUITheme],{scriptClass:"mstrmojo.gm.DndTooltip",left:0,top:0,zIndex:10,boundaryNodeName:"boundary",popupNodeName:"infoNode",baseTipClass:"arrow",infoNodeOffset:0,popupNodeOffset:5,anchor:null,boundary:null,utils:mstrmojo.VisChartUtils,themeClassName:"mojo-theme-light",markupString:'<div id="{@id}" class="mstrmojo-Tooltip {@cssClass}" style="top:{@top}px;left:{@left}px;z-index:{@zIndex};position:absolute;{@cssText};"><div class="mstrmojo-Tooltip-shadow {@shadowNodeCssClass}"></div><div class="mstrmojo-Tooltip-content {@contentNodeCssClass}" style="{@contentNodeCssText}"><div class="content"></div><div class="arrow"><div class="after"></div><div class="before"></div></div></div></div>',markupSlots:{infoNode:function(){return this.domNode.childNodes[1];},contentNode:function(){return this.domNode.childNodes[1].firstChild;},tipNode:function(){return this.domNode.childNodes[1].lastChild;}},toggle:function A(H){if(H){this.domNode.style.display="block";}else{this.domNode.style.display="none";}},updateContent:function(H,J,I){this.set("themeClassName",mstrApp.getThemeClassName());this.fillContent(H,J,I);this.positionDialog();},fillContent:function C(J,N,L){this.anchor=J;this.anchorPosition=N;this.contentNode.innerText=L||this.anchor.innerText||this.anchor.textContent,true;this.toggle(true);var H=F.getComputedFontStyle(this.contentNode),M=this.contentNode.innerText,I=F.measureTextWidth(M,H),K=130;if(I<=K){this.contentNode.style.width=I+"px";}else{this.contentNode.innerText=F.truncateTextToLineWithWordWrap(M,H,K,3);this.contentNode.style.width=K+"px";}},getTipDimension:function B(){var I=this[this.tipNodeName],H=E.position(I.firstChild);return H;},applyPopupNodePos:function G(J,I,L,H){var N=this[this.tipNodeName],K=N.style,O=this[this.popupNodeName],M=O.style;M.top=J+"px";M.left=I+"px";K.top=(L-J)+"px";K.left=(H-I)+"px";}});}());(function(){mstrmojo.requiresCls("mstrmojo.func","mstrmojo.array","mstrmojo.hash","mstrmojo.Container","mstrmojo._HasLayout","mstrmojo._Formattable","mstrmojo._IsDocumentTemplate","mstrmojo.Label","mstrmojo.VisUtility","mstrmojo.ui.menus.MenuConfig","mstrmojo.vi._MonitorsAppState","mstrmojo.vi.ui.rw._SupportViewFilterInVizBox","mstrmojo.util.FontLoader");mstrmojo.requiresClsP("mstrmojo.vi.viz","EnumVisualizationTemplates","EnumVizStyles","EnumWidgetTypes");var R={top:"top",left:"left","z-index":"zIndex",width:"width",height:"height"};var L=["background-color","fx"],H={width:"width",height:"height"},Y=mstrmojo.array,K=mstrmojo.hash;mstrmojo.VisBase=mstrmojo.declare(mstrmojo.Container,[mstrmojo._HasLayout,mstrmojo._Formattable,mstrmojo._IsDocumentTemplate,mstrmojo.vi.ui.rw._SupportViewFilterInVizBox,mstrmojo.vi._MonitorsAppState],{scriptClass:"mstrmojo.VisBase",updated:false,waitingForData:false,node:null,excludeData:false,skipReRender:false,updateFormatsOnUpdate:true,bgFormats:{},init:function d(l){this.excludeData=!!(mstrConfig.resolveOnly||mstrApp.isAppStatePause&&mstrApp.isAppStatePause());if(this._super){this._super(l);}},setModel:function g(l){this.set("model",l);},destroy:function c(){var l=this.model;if(l&&l.destroy){l.destroy();delete this.model;}this._super();},resize:function N(){var l=this.getFormats();if(parseInt(l.height,10)===0||parseInt(l.width,10)===0){this.domNode.style.display="none";}else{this.setDimensions(l.height,l.width);this.domNode.style.display="";}},setDimensions:function b(n,m){var l=this._super(n,m);if(l&&this.hasRendered&&!this.skipReRender){this.reRender();}return l;},reRender:function J(){this.unrender();this.render();},getWidth:function h(){return parseInt(this.width,10);},getHeight:function X(){return parseInt(this.height,10);},getLeft:function V(){return parseInt(this.left,10);},getTop:function B(){return parseInt(this.top,10);},getFonts:mstrmojo.emptyFn(),loadFonts:function E(l,m){if(mstrmojo.util.FontLoader.load(l,m)){m.success();}},preBuildRendering:function A(){if(this.requirePreload){var l=function l(){this.requirePreload=false;this.render();};if(mstrmojo.util.FontLoader.load(this.getFonts(),{success:l.bind(this),failure:l.bind(this)})){return this._super();}else{return false;}}return this._super();},buildRendering:function D(){this.height=this.getHeight();this.width=this.getWidth();this.left=this.getLeft();this.top=this.getTop();if(!this.updated){this.update();}this._super();},initFromVisProps:function a(){},postBuildRendering:function(){var l=this.isEmpty();this._super();this.raiseEvent({name:"toggleCtrlOverlay",visible:l||this.excludeData,controls:this.getVisEmptyMsgControls()});this.applyBackground();return !l;},applyBackground:function W(){var m=this.bgFormats,o,l,p,n;if(mstrApp.isExpress&&!K.isEmpty(m)){o=this.formatHandlers=this.formatHandlers||{};p=o.domNode=o.domNode||[];l="BG";n=Y.indexOf(p,l);if(n<0){p.push(l);}this.applyCSSFormatToNode("domNode",m);}},parseBgFormats:function G(){var l=this.id;return{success:function(r){var o,t,q,m,s,n,p=mstrmojo.all[l],u=p&&p.getDocModel();if(r.defn&&r.defn.layouts&&p&&u){t=r.defn.layouts;o=Y.find(t,"k",u.getCurrentLayoutKey());q=t[o];m=q&&q.units&&q.units[p.k];s=m&&m.fmts;if(s){n=p.bgFormats={};Y.forEach(L,function(w){if(s[w]){n[w]=s[w];}});}}}};},onAppStateChange:function(l){var m=mstrApp.isAppStatePause&&mstrApp.isAppStatePause(),n=l.valueWas&mstrmojo.vi.VisualInsightApp.APP_STATES.PAUSE;this.excludeData=!!(mstrConfig.resolveOnly||m);if(this._super){this._super(l);}if(m&&!n||(!m&&n&&!mstrApp.enableUpdate)){this.raiseEvent({name:"toggleCtrlOverlay",visible:this.excludeData||this.isEmpty(),controls:this.getVisEmptyMsgControls()});}},refresh:function i(l){if(this.excludeData){this.raiseEvent({name:"toggleCtrlOverlay",visible:true,controls:this.getVisEmptyMsgControls()});return ;}this._super(l);},update:function Z(o){o=o||this.node;if(o){var l=o.data;if(l){this.model.set("data",l);}this.waitingForData=!!l.nsj;if(this.waitingForData){var m="ServerJsonRWDStyle";var p=this.model,n=p.getDataService(),q={host:this,nodes:[this.k]},s;if(l.wid!==undefined){q.slices=[l.wid];}s=mstrmojo.func.wrapMethods(this.parseBgFormats(),p.docModel.getUpdateColorMapCallback(),p.docModel.getUpdateThemePaletteCallback(true),p.controller._getXtabCallback(this,false));n.retrieveServerJson(q,s,{preserveUndo:true,style:{name:m,params:{treesToRender:3}},params:{styleName:m}});this.updated=true;return false;}this.updateContentFormats(o);}if(this.model){var t=this.model&&this.model.docModel;this.initFromVisProps(this.model.vp);if(t&&t.getDocBuilder){var r=t.getDocBuilder().getMojoVisName(o);if(r){o.data.visName=r;}}}this.updated=true;if(this._super){return this._super(o);}return true;},updateContentFormats:function M(p){var n,q,m,o=p.defn,l=this.builder;if(this.updateFormatsOnUpdate&&o){if(l&&l.isPortlet&&l.isPortlet(o)){q=H;}else{q=R;}m=o.fmts||o.units[this.model.k].fmts;for(n in q){if(q.hasOwnProperty(n)&&m.hasOwnProperty(n)){this[q[n]]=m[n];}}}},isEmpty:function O(){return false;},getVisEmptyMsgControls:function I(){return[{scriptClass:"mstrmojo.Label",cssClass:"dropMsg",text:mstrmojo.desc(11668,"Drag objects here.")}];},getModel:function j(){return this.model;},getData:function Q(){return this.model.data;},getRowsAndCols:function(){var l=this.model.data.gts;return(l.row||[]).concat(l.col||[]);},getExp:function(){var l=this.model.data,m=l&&l.sc&&l.sc.exp;return m;},getDocModel:function e(){return this.model&&this.model.docModel;},getTitleRMCPopup:mstrmojo.emptyFn,getMenuHandler:function U(){return mstrmojo.emptyFn;},renderErrorMessage:function k(l){this.domNode.innerHTML='<div class="mstrmojo-message">'+l+"</div>";},getMessageID:function S(){return this.model.docModel.mid||this.model.mid;},performAction:function f(l){var m=this.model,p=this.scriptClass==="mstrmojo.heatmap.vi.VisHeatMap",o=p?m.getHMAction(l):m.getAction(l),n=o&&o.h;if(n&&this.controller[n]){this.controller[n](this,o.a);return true;}return false;},deleteSelectorControl:function P(){var l=this.getData(),m=l.sc;if(m&&parseInt(m.ct,10)===6){delete l.sc;}},findSelectorControl:function F(){var m=this.getData(),l=m&&m.sc;if(l&&parseInt(l.ct,10)===6){this.selectorControl=l;this.isMultiSelect=true;}else{delete this.selectorControl;}return this.selectorControl;},displayVizBoxVisFilterIndicator:function C(l,m){if(l&&m&&m.displayVisFilterIndicator){m.displayVisFilterIndicator();}}});})();(function(){mstrmojo.requiresCls("mstrmojo.array","mstrmojo.VisEnum","mstrmojo.VisUtility");var S=mstrmojo,N=S.array,M=S.VisEnum,L=S.VisUtility,J=M.NETWORK_LAYOUT.FORCE_DIRECTED,E=M.NETWORK_FORCE_DIRECTED_LAYOUT_EDGE_CURVATURE,A=Math.ceil,V=Math.sqrt,O=Math.abs,I=0.1,U=V(I/2),C=L.isNearZero,D=(window.env||{}).isDebugging;function G(W){if(D){L.visPrint(W);}}mstrmojo.netviz._ForceDirectedLayout=mstrmojo.provide("mstrmojo.netviz._ForceDirectedLayout",{_mixinName:"mstrmojo.netviz._ForceDirectedLayout",init:function(W){if(this._super){this._super(W);}if(this.layouts===undefined){this.layouts={};}this.layouts[J]=R;}});function R(f,j){function a(){var h=0,i;F(g);H(f.edges);j.setScene();j.draw();i=setInterval(function(){if(m>0){Q(g,b,m,Z,W);m-=X;F(g);H(f.edges);j.setScene();j.draw(false,true);G("iteration: "+h++);}else{clearInterval(i);}},17);}var g=[],b=[],l=100,e=100;j.currentLayout=J;B(f,g,b,l,e);var Y=200,d=g.length,Z=V(l*e/d),W=Z*Z,m=l/(2*V(d)),X=m/Y,c;if(D){a();}else{for(c=0;c<Y;c++){Q(g,b,m,Z,W);m-=X;}F(g,f.nodesIdHash);H(f.edges);}}function B(Y,b,X,W,Z){function a(h){var l=h.length,e=A(V(l)),d=W/e,o=Z/e,g,f;for(g=0;g<e;g++){for(f=0;f<e;f++){var k=g*e+f;if(k<l){var m=h[k];m.px=g*d-W/2;m.py=f*o-Z/2;}}}}N.forEach(Y.nodes,function(d){if(!d.isExcluded){var c=d.getSize();var e={m:c*c,px:0,py:0,ax:0,ay:0,nodeId:d.id};d._shadowSprite=e;b.push(e);}});N.forEach(Y.edges,function(c){if(!c.isExcluded){X.push({from:c.from._shadowSprite,to:c.to._shadowSprite});}});a(b);}function K(e,f,Y){var c=f.px-e.px,b=f.py-e.py,a,Z,X,W;if(!C(c)&&!C(b)){a=V(c*c+b*b);Z=a*a/Y;X=c/a*Z;W=b/a*Z;e.ax+=X;e.ay+=W;f.ax-=X;f.ay-=W;}}function P(d,e,W){var c=e.px-d.px,a=e.py-d.py,Z=c*c+a*a,b,Y,X;if(Z<I){Z=I;c=(c>=0?1:-1)*U;a=(a>=0?1:-1)*U;}b=W/Z;Y=-c*b;X=-a*b;d.ax+=Y;d.ay+=X;e.ax-=Y;e.ay-=X;}function Q(b,Z,f,X,W){N.forEach(b,function(h){h.ax=0;h.ay=0;});var a,d=b.length,Y,g;for(a=0;a<d;a++){g=b[a];for(Y=a+1;Y<d;Y++){P(g,b[Y],W);}}N.forEach(Z,function(c){K(c.from,c.to,X);});for(a=0;a<d;a++){var e=b[a];e.ax+=-e.px;e.ay+=-e.py;}N.forEach(b,function(h){if(O(h.ax)>f){h.ax=(h.ax>=0?1:-1)*f;}if(O(h.ay)>f){h.ay=(h.ay>=0?1:-1)*f;}h.px=h.px+h.ax;h.py=h.py+h.ay;});}function F(Y,W){var X;N.forEach(Y,function(Z){X=W[Z.nodeId];X.sprite.setGeometry({x:Z.px,y:Z.py});delete X._shadowSprite;});}function H(W){N.forEach(W,function(Z){Z=Z.sprite;var c=Z.from,b=Z.to,Y=c.getGeometry(),X=b.getGeometry(),a=E[(Z.unit.reversedEdge?1:0)];Z.setGeometry({x:(Y.x+X.x)/2+(Y.y-X.y)*a,y:(Y.y+X.y)/2+(X.x-Y.x)*a,type:"bezier"});});}}());(function(){mstrmojo.requiresCls("mstrmojo.Container","mstrmojo.dom","mstrmojo.css","mstrmojo.VisEnum","mstrmojo.VisUtility");var A=mstrmojo.VisEnum.NETWORK_LOCAL_PROPS,B=mstrmojo.VisEnum.NETWORK_DRAG_MODE;var C=mstrmojo.css,E=mstrmojo.dom,D=mstrmojo.VisUtility;mstrmojo.netviz.VisNetworkStageScaleBar=mstrmojo.declare(mstrmojo.Container,[],{scriptClass:"mstrmojo.netviz.VisNetworkStageScaleBar",markupString:'<div class="VisNetworkStageScaleBar" id="{@id}-networkStageScaleBar" style="position: absolute; top:{@top}px; left:{@left}px; height: {@height}px; width: {@width}px; z-index: 2;" mstrAttach:mousedown,click><div class="_label"></div><div style="position: relative"><div class="_zoomTool"><div class="_FTWTrigger"></div><div class="_zoomInButton"></div><div class="_scaleBar"><div class="_bar"></div><div class="_slider"></div></div><div class="_zoomOutButton"></div></div><div class="pan-select-tool"><input class="_inputPan" type="radio" id="{@id}-panButton" name="{@id}-sptype"><label for="{@id}-panButton" class="_panButton"></label><input class="_inputSelect" type="radio" id="{@id}-selectButton" name="{@id}-sptype"><label for="{@id}-selectButton" class="_selectButton"></label></div></div></div>',markupSlots:{label:function(){return this.domNode.childNodes[0];},fitToWindowTrigger:function(){return this.domNode.childNodes[1].childNodes[0].childNodes[0];},zoomInButton:function(){return this.domNode.childNodes[1].childNodes[0].childNodes[1];},zoomTool:function(){return this.domNode.childNodes[1].childNodes[0].childNodes[2].childNodes[0];},slider:function(){return this.domNode.childNodes[1].childNodes[0].childNodes[2].childNodes[1];},zoomOutButton:function(){return this.domNode.childNodes[1].childNodes[0].childNodes[3];},SPTrigger:function(){return this.domNode.childNodes[1].childNodes[1];},inputPan:function(){return this.domNode.childNodes[1].childNodes[1].childNodes[0];},panButton:function(){return this.domNode.childNodes[1].childNodes[1].childNodes[1];},inputSelect:function(){return this.domNode.childNodes[1].childNodes[1].childNodes[2];},selectButton:function(){return this.domNode.childNodes[1].childNodes[1].childNodes[3];}},init:function(F){if(this._super){this._super(F);}if(!this.placeholder){D.visPrint("A placeholder is needed for set the position for the ScaleBar. Init failed.");return ;}this.left=this.placeholder.offsetLeft;this.top=this.placeholder.offsetTop;},postBuildRendering:function(){if(this._super){this._super();}var I=["mousedown","mouseup","mousemove","click","mousewheel"],H,F=I.length;for(H=0;H<F;H++){var J=I[H],G="on"+J;if(this[G]){this.attachEventListener(J,this.id,this[G]);}}this.setScaleFactor(this.scaleFactor);this.initSPType();},initSPType:function(){var G=this.dragMode,F=this.owner;F.dragMode=G;if(G===B.pan){this.inputPan.checked=true;this.owner.lassoSelectorEnabled=false;}else{if(G===B.select){this.inputSelect.checked=true;this.owner.lassoSelectorEnabled=true;}}},onclick:function(H){H=H.e||H;H.stopPropagation();var G=H.target;var F;if(G===this.fitToWindowTrigger){this.resetScene.call(this.owner);this.setScaleFactor(1);var I=this;this._deActiveTimer=window.setTimeout(function(){I.setScaleFactorDone();},1000);}else{if(G===this.zoomInButton){this.setScaleFactor(this.scaleFactor+0.1,false,true);}else{if(G===this.zoomOutButton){this.setScaleFactor(this.scaleFactor-0.1,false,true);}else{if(G===this.panButton){F=B.pan;}else{if(G===this.selectButton){F=B.select;}}}}}if(F!==undefined){this.setSPType(F);}},setSPType:function(F){if(this.hasInterface("setDragType")){this.setDragType.call(this.owner,F);}},onmousedown:function(G){G=G.e||G;this.owner.dismissLassoSelector();G.stopPropagation();var F=G.target;if(F===this.slider){E.attachMouseMoveEvents(this.onmousemove.bind(this),this.onmouseup.bind(this));this._oldPageY=G.pageY;}},onmousemove:function(J){J=J.e||J;J.stopPropagation();var F=J.pageY-this._oldPageY;this._oldPageY=J.pageY;var K=this.slider.offsetTop+this.slider.offsetHeight/2+F-this.zoomTool.offsetTop,G=this.zoomTool.offsetHeight,I;if(this.hasInterface("range")){var H=this.range;I=(G-K)/G*(H.max-H.min)+H.min;}this.setScaleFactor(I);},onmouseup:function(F){F=F.e||F;F.stopPropagation();this.setScaleFactorDone();},setScaleFactor:function(P,K,F){if(isNaN(P)){D.visPrint("Invalid scale factor");return ;}if(this.hasInterface("owner")&&this.hasInterface("scale")&&this.hasInterface("range")){var Q,I;var O;var J=this.range;var G=1;if(P<J.min){O=J.min;}else{if(P>J.max){O=J.max;}else{O=P;}}if(O>this.scaleFactor){Q=true;}if(O<this.scaleFactor){I=true;}G=O/this.scaleFactor;this.scaleFactor=O;this.slider.style.top=(J.max-this.scaleFactor)/(J.max-J.min)*this.zoomTool.offsetHeight+this.zoomTool.offsetTop-this.slider.offsetHeight/2+"px";var H,L;if(Q){H=this.zoomInButton;L="_zoomInButtonActive";}if(I){H=this.zoomOutButton;L="_zoomOutButtonActive";}if(H){this.setScaleFactorDone();this._zoomButtonDomNode=H;this._zoomButtonActiveClassName=L;if(!F){C.addClass(H,L);}}var N=this.label;N.innerHTML=Math.floor(this.scaleFactor*100)+"%";this.owner.setLocalProp(A.ZOOM_FACTOR,this.scaleFactor);if(this.fadeLabelTimer){window.clearInterval(this.fadeLabelTimer);N.style.opacity=1;}var M=this;this.fadeLabelTimer=window.setInterval(function(){var R=N.style.opacity,S=0.01;if(R>S){R-=S;}else{R=0;if(M.fadeLabelTimer){window.clearInterval(M.fadeLabelTimer);}}N.style.opacity=R;},10);if(!K){this.scale.call(this.owner,G);}}},setScaleFactorDone:function(){if(this._zoomButtonActiveClassName&&this._zoomButtonDomNode){C.removeClass(this._zoomButtonDomNode,this._zoomButtonActiveClassName);delete this._zoomButtonActiveClassName;delete this._zoomButtonDomNode;}if(this._deActiveTimer){window.clearTimeout(this._deActiveTimer);}},hasInterface:function(F){if(this[F]){return true;}D.visPrint("warning: no interface found: "+F);return false;},scaleFactor:1,savedScaleFactor:1,range:null,scale:null,owner:null,dragMode:B.pan});})();(function(){var AE=false,D=function(A1){if(AE){AR.visPrint(A1);}};mstrmojo.requiresCls("mstrmojo.Obj","mstrmojo.Base","mstrmojo.dom","mstrmojo.Container","mstrmojo.hash","mstrmojo.array","mstrmojo.netviz.VisNetworkStageScaleBar","mstrmojo.css","mstrmojo.netviz.ObservableModel","mstrmojo._HasPopup","mstrmojo.netviz._HasNetworkContextMenu","mstrmojo.VisEnum","mstrmojo.VisTooltip","mstrmojo.chart.enums.EnumFontStyle","mstrmojo.chart.enums.EnumLineStyle","mstrmojo.ui.PopupConfig","mstrmojo.VisUtility","mstrmojo.PerformanceLogOutput","mstrmojo.util.ui._LassoSelector","mstrmojo.netviz.Bitmap","mstrmojo.util.color","mstrmojo.ui.menus.MenuConfig");var Ae=mstrmojo.dom,AW=Ae.position,Ah=mstrmojo.VisEnum.NETWORK_DRAG_MODE,AX=mstrmojo.netviz.ObservableModel,Ar=mstrmojo.css,N=mstrmojo.hash,J=mstrmojo.array,Q=mstrmojo.VisEnum,AR=mstrmojo.VisUtility,t=mstrmojo.PerformanceLogOutput,k=mstrmojo.util.color,F=mstrmojo.color;var Aq=Q.NETWORK_LOCAL_PROPS,b=Q.FormNameDisplayType,n=Q.NETWORK_FORCE_DIRECTED_LAYOUT_EDGE_CURVATURE,Af=mstrmojo.chart.enums.EnumFontStyle,i=Q.NETWORK_LAYOUT;var O=["Select","Swipe","Multi","Tap",""],AL=["Begin","End","Move","Cancel",""];var Au=["click","dblclick","drage","dragend","dragenter","dragleave","dragover","dragstart","drop","mousedown","mousemove","mouseup","mouseout","mouseover","mousewheel","scroll","contextmenu"];var u=["mousemove","mouseup"];var An=[];J.forEach(O,function(A1){J.forEach(AL,function(A2){An.push("touch"+A1+A2);});});var Aj=5*1000;var j=6;var a=40*Math.PI/180;var d=3,o=30*Math.PI/180,M=Math.pow(d,2)+1-2*Math.cos(o)*d,AN=Math.cos(o)*d,Ab=Math.sin(o)*d;var AS=500;var AP=26,A0=5,Am=25,X=350,AT={EDGE:0,CIRCLE:1,HIGHLIGHT:2},Ak={BASE:0,HIGHLIGHT:1};var AK={fontFamily:"Helvetica",fontSize:AR.psPt2CssPt("12pt",Math.round),fontStyle:Af.FS_BOLD},AD=4,R=3,Ap=5;(function(){var A4=["ms","moz","webkit","o"],A3=0,A2,A1=A4.length;for(A2=0;A2<A1&&!window.requestAnimationFrame;A2+=1){window.requestAnimationFrame=window[A4[A2]+"RequestAnimationFrame"];window.cancelAnimationFrame=window[A4[A2]+"CancelAnimationFrame"]||window[A4[A2]+"CancelRequestAnimationFrame"];}if(!window.requestAnimationFrame){window.requestAnimationFrame=function(A8){var A7=new Date().getTime(),A5=16-(A7-A3),A6;if(A5<0){A3=A7;A6=0;}else{A6=A5;}return setTimeout(function(){A8(A3);},A6);};}if(!window.cancelAnimationFrame){window.cancelAnimationFrame=clearTimeout;}}());function Ac(A4,A5){if(typeof A4!=="object"){return ;}var A3=Object.keys(A4),A2,A1;for(A2=0,A1=A3.length;A2<A1;A2++){A5(A3[A2]);}}function As(A1){var A2=[];if(A1&Af.FS_BOLD){A2.push("bold");}if(A1&Af.FS_ITALIC){A2.push("italic");}return A2.join(" ");}function W(A1){return[As(A1.fontStyle),A1.fontSize,"'"+A1.fontFamily+"'"].join(" ");}function U(A1){Ae.stopPropogation(window,A1);Ae.preventDefault(window,A1);}function y(A1){var A2=[];if(A1&Af.FS_UNDERLINE){A2.push("underline");}if(A1&Af.FS_STRIKETHROUGH){A2.push("line-through");}return A2.join(" ");}var H=(function(){var A1={},A2=new RegExp("(\\d+)(p[xt])","i");return function A3(A5){var A4,A7,A6;if(A1.hasOwnProperty(A5)){return A1[A5];}A4=A2.exec(A5);if(!A4){return ;}A7=parseInt(A4[1],10);A6=A4[2].toLowerCase();if(A6==="pt"){A7*=96/72;}A7=Math.ceil(A7);A1[A5]=A7;return A7;};}());function AU(A2,A7){if(A7 instanceof Object){var A5=Object.keys(A7),A1=A5.length,A4,A3,A6;for(A4=0;A4<A1;A4++){A3=A5[A4];A6=A7[A3];if(!(A6 instanceof Object)){A2[A3]=A6;}else{if(!A2[A3]){A2[A3]={};}AU(A2[A3],A6);}}}return A2;}function A(A2){var A1=arguments.length,A3,A4;A2=N.clone(A2||{});for(A3=1;A3<A1;A3++){A4=arguments[A3];if(A4 instanceof Object){AU(A2,A4);}}return A2;}function Aw(A2){var A1;if(A2.which===undefined||A2.which===null){A1=(A2.button<2)?0:((A2.button===4)?1:2);}else{A1=(A2.which<2)?0:((A2.which===2)?1:2);}return A1;}function B(A1){var A2=A1._delayHideTimerId;if(A2){clearTimeout(A2);delete A1._delayHideTimerId;}}function G(A1){B(A1);A1._delayHideTimerId=setTimeout(function(){A1.toggle(false);delete this._isTooltipShown;},Aj);}function L(A2){var A4=[],A1,A3;A2=A2||[];for(A3=0,A1=A2.length;A3!==A1;A3++){A4.push(A3);}return A4;}function x(BA,BB,A7){var A1=mstrmojo.ui.PopupConfig.ENUM_CORNERS,BD={pageX:BA.pageX,pageY:BA.pageY-6},A4=this,A2=A4.owner;A2.closePopup();var A6="",A5=false,A9=false;J.forEach(BB,function(BE){if(BE.attSrc==="from"){A5=true;}else{if(BE.attSrc==="to"){A9=true;}}});A6=A5?(A9?"from and to":"from"):"to";A4.showContextMenu("bubble",A4.observableModel,BD,{alignment:{host:A1.TOP_LEFT,popup:A1.BOTTOM_LEFT,attSrc:A6}});var BC=A4._lastOpened;A2.showMenu(A4.owner.getFormatMenuConfig(),BA,A7);var A3=A2._lastOpened,A8=A3._unlockHoverCheck;A3._unlockHoverCheck=function(BF,BE){if(!Ae.contains(BC.domNode,Ae.eventTarget(BE,BF),true)){A3._unlockHoverCheck=A8;A3._unlockHoverCheck(BF,BE);}};}function V(A2){var A3=this,A1=A3.contextMenuSelection;x.call(A3,A2,A1,true);}function S(A2){var A3=this,A1=A3.selectedSprites;x.call(A3,A2,A1,false);}function g(A2,A8,A7,A6){var A4,A3,A1,A5;if(isNaN(A2)||A2<0||A2>1){return{x:NaN,y:NaN};}A4=1-A2;A1=A4*A4;A3=A2*A2;A5=2*A4*A2;return{x:A1*A8.x+A5*A7.x+A3*A6.x,y:A1*A8.y+A5*A7.y+A3*A6.y};}var At=mstrmojo.chart.enums.EnumLineStyle;function z(A1){var A4=1,A3=At.LS_SOLID;if(A1){if(A1==="none"){A3=At.LS_NONE;}else{var A2=parseInt(A1,10);if(!isNaN(A2)){A4=A2;}if(/dotted/.test(A1)){A3=At.LS_DOT;}else{if(/dashed/.test(A1)){A3=At.LS_DASH;}else{if(/solid/.test(A1)){A3=At.LS_SOLID;}}}}}return{ceLnStyle:A3,thk:A4};}var I=mstrmojo.declare(mstrmojo.Base,[],{scriptClass:"mstrmojo.netviz.VisNetworkStage.Sprite",init:function(A5){this.zIndex=0;this.selectionState={};this.geometry={x:0,y:0,s:0};this.record();if(this._super){this._super(A5);}var A1=this.stage,A3=this,A2=Au;var A4=function(A8){var A6=A8.layerX,A9=A8.layerY,A7=A8.name;if(!A1.transitionTimer&&!A1.eventHasBeenHandled&&this["on"+A7]&&(u.indexOf(A7)!==-1||A3.isHit(A6,A9))&&!this.isExcluded){A3["on"+A7](A8);}};J.forEach(A2,function(A6){A1.attachEventListenerForSprites(A6,A3,A4);});},updateZIndex:function(){var A6=this.stage&&this.stage.layers&&this.stage.layers[this.layerIndex];if(!(A6 instanceof Array&&A6.length>0)){return ;}var A1=A6.length,A5=this.type,A3,A2,A4;for(A3=0;A3<A1;A3++){A4=A6[A3];if(A4.type===A5){if(A4!==this){A2=A6.indexOf(this);this.zIndex=A4.zIndex+1;A4.zIndex=A6[A3-1]?A6[A3-1]-1:0;A6[A2]=A4;A6[A3]=this;this.stylesChanged();}break;}}},stopPropagation:function(){this.stage.eventHasBeenHandled=true;},draw:function(){this.record();},record:function(){var A1=this.getGeometry();this.oldGeometry=N.clone(A1);},drawStage:function(A1,A2){this.stage.draw(A1,A2);},stylesChanged:function(){this.hasStyleChanged=true;var A1=this.stage;if(A1){if(A1.onSpriteStyleChange&&A1.hasRendered){A1.onSpriteStyleChange(this.layerIndex);}}},highlight:function(){this.stage.addSpriteToLayer(this,AT.HIGHLIGHT);},unHighlight:function(){var A1=this.selectionState;if(!A1.selected&&!A1.hovered){this.stage.removeSpriteFromLayer(this,AT.HIGHLIGHT);var A2=this.type==="Circle"?AT.CIRCLE:AT.EDGE;this.stage.addSpriteToLayer(this,A2);}},showTooltip:function(A1){var A2=this.stage.tooltip;if(!this._isTooltipShown){this._isTooltipShown=true;A2.displayInfo(this.getTooltipInfo(),A1);}else{A2.moveTo(A1.x,A1.y);}A2.toggle(true);G(A2);},hideTooltip:function(){var A1=this.stage.tooltip;B(A1);A1.toggle(false);delete this._isTooltipShown;}});var AA=0,Ag=16777215;var Y={normal:{color:{value:2212863,opacity:0.8},border:{color:{value:8487297,opacity:0.8},width:2,style:"1pt solid"}},hovered:{color:{opacity:0.5},highlightBorder:{color:{value:Ag,opacity:1},width:2,distance:3}},selectedStyleA:{color:{opacity:1},fromNode:{color:{opacity:1}},toNode:{color:{opacity:1}},selectionBorders:{inner:{color:{value:AA,opacity:1},width:2},outer:{color:{value:Ag,opacity:1},width:2}}},selectedStyleB:{color:{opacity:1},fromNode:{color:{opacity:1}},toNode:{color:{opacity:1}},selectionBorders:{inner:{color:{value:AA,opacity:1},width:2},outer:{color:{opacity:1},width:2}}},selectedStyleC:{color:{opacity:1},fromNode:{color:{opacity:1}},toNode:{color:{opacity:1}},selectionBorders:{inner:{color:{opacity:1},width:2},outer:{color:{value:Ag,opacity:1},width:2}}}};var Av={normal:{color:{value:2062260,opacity:0.7},border:{color:{value:2062260,opacity:1},width:2,style:"1pt solid"}},hovered:{color:{opacity:0.35},fromNode:{color:{opacity:0.35}},toNode:{color:{opacity:0.35}},highlightBorder:{color:{value:AA,opacity:1},width:2,distance:3}},selectedHovered:{color:{opacity:0.7},fromNode:{color:{opacity:0.7}},toNode:{color:{opacity:0.7}}},selectedStyleA:{color:{opacity:1},fromNode:{color:{opacity:1}},toNode:{color:{opacity:1}},selectionBorders:{inner:{color:{value:Ag,opacity:1},width:2},outer:{color:{value:AA,opacity:1},width:2}}},selectedStyleB:{color:{opacity:1},fromNode:{color:{opacity:1}},toNode:{color:{opacity:1}},selectionBorders:{inner:{color:{value:Ag,opacity:1},width:2},outer:{color:{opacity:1},width:2}}},selectedStyleC:{color:{opacity:1},fromNode:{color:{opacity:1}},toNode:{color:{opacity:1}},selectionBorders:{inner:{color:{opacity:1},width:2},outer:{color:{value:AA,opacity:1},width:2}}}};function Al(A2,A1,A6,A4,A5,A3){A2.arc(A1,A6,A4,A5,A3);}function C(A2,A1,A4,A3){A2.rect(A1-Math.sqrt(2)*A3/2,A4-Math.sqrt(2)*A3/2,Math.sqrt(2)*A3,Math.sqrt(2)*A3);}function AQ(A2,A1,A4,A3){A2.moveTo(A1,A4-A3);A2.lineTo(A1+A3,A4);A2.lineTo(A1,A4+A3);A2.lineTo(A1-A3,A4);A2.lineTo(A1,A4-A3);}function Ai(A2,A1,A4,A3){A2.moveTo(A1,A4-A3);A2.lineTo(A1+A3*Math.sqrt(3)/2,A4-A3/2);A2.lineTo(A1+A3*Math.sqrt(3)/2,A4+A3/2);A2.lineTo(A1,A4+A3);A2.lineTo(A1-A3*Math.sqrt(3)/2,A4+A3/2);A2.lineTo(A1-A3*Math.sqrt(3)/2,A4-A3/2);A2.lineTo(A1,A4-A3);}function q(A2,A1,A4,A3){A2.moveTo(A1,A4-A3);A2.lineTo(A1+A3*Math.sqrt(3)/2,A4+A3/2);A2.lineTo(A1-A3*Math.sqrt(3)/2,A4+A3/2);A2.lineTo(A1,A4-A3);}var f={Circle:Al,Square:C,Diamond:AQ,Hexagon:Ai,Triangle:q,Ring:Al};function AC(BE,A8,A6,BA,BH,BQ){if(!BE||!BA){return BA;}BH=BH||{color:{value:0,opacity:1},width:1};var BO=At.LS_SOLID,A2=BH.distance||0;if(BH.style){var A4=z(BH.style);BO=A4.ceLnStyle;BH.width=A4.thk+1;}BA+=A2;var A9=BH.width,BC=BH.color,BN=k.getCSSColorString(BC.value,BC.opacity);if(BO===At.LS_NONE){return BA;}BE.save();var BP=BA+A9*0.5,BM=Math.PI*2;BE.strokeStyle=BN;BE.lineWidth=A9;BE.beginPath();if(BO===At.LS_SOLID){f[BQ](BE,A8,A6,BP,0,BM,true);}else{var A7=BO===At.LS_DASH?0.5:0.2;var BD=BP/A7,A3=Math.PI*2/BD,BG=[],BF=-1,A5,BB,BK=(Math.cos(A3)*BP)+A8,A1=(Math.sin(A3)*BP)+A6,BL=(Math.cos(2*A3)*BP)+A8,BJ=(Math.sin(2*A3)*BP)+A6,BI=Math.sqrt(Math.pow(BK-BL,2)+Math.pow(A1-BJ,2));if(BQ==="Ring"||BQ==="Circle"){while(BF<BD){A5=A3*BF;BB=A3*(BF+1);BG.push({x:(Math.cos(A5)*BP)+A8,y:(Math.sin(A5)*BP)+A6,ex:(Math.cos(BB)*BP)+A8,ey:(Math.sin(BB)*BP)+A6});BF+=2;}J.forEach(BG,function(BR){BE.moveTo(BR.x,BR.y);BE.lineTo(BR.ex,BR.ey);});}else{BE.setLineDash([BI,BI]);BE.lineWidth=2;f[BQ](BE,A8,A6,BA);}}BE.stroke();BE.closePath();BE.restore();return BA+A9;}function Aa(BA,A3,A6,A7,A4){var A9=A6.x,A8=A6.y,A1=0,A2=0,A5=A3.value;if(k.isGradientColor(A5)){A1=A5.or;A2=1-A1;}BA.save();BA.fillStyle=k.createCanvasFillPattern(A3,BA,A9-A7*A1,A8-A7*A2,A9+A7*A1,A8+A7*A2);BA.beginPath();if(A4==="Ring"){BA.lineWidth=A7*0.3;BA.strokeStyle=BA.fillStyle;Al(BA,A6.x,A6.y,A7*0.85,0,2*Math.PI,true);BA.stroke();}else{f[A4](BA,A6.x,A6.y,A7,0,2*Math.PI,true);}BA.closePath();if(A4!=="Ring"){BA.fill();}BA.restore();}var Z={dark:Y,light:Av},Ay={dark:{stroke:{value:"#1f1f1f",opacity:1},fill:{value:"#ffffff",opacity:1}},light:{stroke:{value:"#ffffff",opacity:1},fill:{value:"#000000",opacity:1}}};var AY=mstrmojo.declare(I,[],{scriptClass:"mstrmojo.netviz.VisNetworkStage.CircleSprite",init:function(A1){this.position={x:0,y:0,r:0};this.style=null;if(this._super){this._super(A1);}var A2=this.position;A2.x=isNaN(A2.x)||Math.abs(A2.x)===Infinity?0:A2.x;A2.y=isNaN(A2.y)||Math.abs(A2.y)===Infinity?0:A2.y;A2.r=isNaN(A2.r)||Math.abs(A2.r)===Infinity?0:A2.r;this.updateTextSize();},getTooltipInfo:function(){var A1=this.getTooltipAttrInfo();if(this.aggregationName){A1.push({n:this.aggregationName,v:this.displayValue});}return A1;},getTooltipAttrInfo:function(A3){var A2=this.stage.owner.abstractedModel.formNameDisplayType,A1=this.forms,A6=this.formValues,A5=A3||this.title,A4;if(A2===b.OFF||this.selfLoop){A4=[{n:A5,v:this.text}];}else{A4=A1.map(function(A8,A7){return{n:A8,v:A6[A7]};});}return A4;},onclick:function(){this.stopPropagation();},onmousedown:function(A2){A2=A2.e||A2;var A4=A2.srcElement||A2.target,A3=this.stage,A1=A3&&A3.lassoSelector;this.stopPropagation();if(!(Aw(A2)===2&&A4===A1)){this.stage.dismissLassoSelector();}if(A3.dragMode===Ah.select){A3.lassoSelectorEnabled=false;}this._isMouseDown=true;this._selectionState=N.clone(this.selectionState);this._lastMousePosition={x:A2.pageX,y:A2.pageY};},onmousemove:function(A9){var A4,A8,A6;var BC=A9.layerX,BB=A9.layerY,A2=this.stage,A3=false;A9=A9.e||A9;if(this._isMouseDown&&Aw(window.event||A9)===0){var A7=this._lastMousePosition,BG=A9.pageX-A7.x,BD=A9.pageY-A7.y;this._lastMousePosition={x:A9.pageX,y:A9.pageY};this.stopPropagation();if(BG!==0||BD!==0){if(!this._dragged){A2.onSpriteStyleChange(AT.EDGE);A2.onSpriteStyleChange(AT.CIRCLE);}this._dragged=true;if(!this.selectionState.selected){if(!(A9.ctrlKey||A9.metaKey)){A2.clearSelection();}A2.addToSelection(this);A3=true;A2.owner.doSelection();}var BF=this.stage.selectedSprites,A5=this.stage.currentLayout;J.forEach(BF,function(BH){A6=BH.getGeometry();A6.x+=BG;A6.y+=BD;BH.setGeometry(A6);if(A5===i.LINEAR||A5===i.FORCE_DIRECTED){J.forEach(BH.unit.edges,function(BJ){var BI=BJ.from.sprite.getGeometry(),BK=BJ.to.sprite.getGeometry(),BM,BL;if(A5===i.LINEAR){BL={x:(BI.x+BK.x)*0.5-(BK.y-BI.y)*0.5,y:(BI.y+BK.y)*0.5+(BK.x-BI.x)*0.5};}else{if(A5===i.FORCE_DIRECTED){BM=n[BJ.reversedEdge?1:0];BL={x:(BI.x+BK.x)*0.5+(BI.y-BK.y)*BM,y:(BI.y+BK.y)*0.5+(BK.x-BI.x)*BM};}}BJ.sprite.setGeometry(BL);});}});this.drawStage(false,A3);}}else{var BA,BE,A1=this.isHit(BC,BB);if(A1){this.stopPropagation();}if(this._hoverHighlighted){if(!A1){BA=this.getInvolvedSprites();A8=BA.length;for(A4=0;A4<A8;A4++){BE=BA[A4];BA[A4].unHoverHighlight();}delete this._hoverHighlighted;this.hideTooltip();if(A2._pendingRefresh){A2.onSpriteStyleChange(AT.CIRCLE);A2.onSpriteStyleChange(AT.EDGE);}A3=true;if(A2._pendingRefresh){delete A2._pendingRefresh;}}}else{if(A1){BA=this.getInvolvedSprites();A8=BA.length;for(A4=0;A4<A8;A4++){BE=BA[A4];BE.hoverHighlight();}this._hoverHighlighted=true;A3=true;}}if(A2.selectedSprites.length>0){A2.onSpriteStyleChange(AT.HIGHLIGHT);}this.drawStage(false,A3);}if(this._hoverHighlighted){this.showTooltip({x:A9.clientX,y:A9.clientY});}},onmouseup:function(A1){var A2=this.stage;A1=A1.e||A1;if(this._isMouseDown){this.stopPropagation();if(!this._dragged){if(A1.button===0){this.clickHandler(A1);}}A2._bubbleToolbarPos=A1;A2._pendingRefresh=true;delete this._selectionState;delete this._isMouseDown;delete this._lastMousePosition;delete this._dragged;A2.circleMenuOnCloseFlag=false;}},clickHandler:function(A7,A8){A7=A7.e||A7;var A3=this.selectionState.selected,A1=A7.ctrlKey||A7.metaKey,A2=this.stage,A9=A2.selectedSprites.length>1,A4=A2.isClearAllEnabled(this),A5=A2.parent,A6=A5&&A5.parent;isAdded=false;A2.clearContextMenuSelection();if(A3&&!A9){if(!A8&&A4){A2.clearSelection();}}if((A3&&!A1&&A9&&!A8)||(!A3&&!A1)){A2.clearSelection();A2.addToSelection(this);isAdded=true;}if(!A3&&A1){A2.addToSelection(this);isAdded=true;}if(A3&&A1&&A9){if(!A8){A2.removeFromSelection(this);}}A5.displayVizBoxVisFilterIndicator(isAdded,A6);this.drawStage(false,true);A2.owner.doSelection();},contextMenuSelectionHandler:function(){var A1=this.selectionState.selected,A2=this.stage;A2.clearContextMenuSelection();if(A1){A2.cloneSelectionToContextMenuSelection();}else{A2.addSpriteToContextMenuSelection(this);}A2.contextMenuSelectionHighLight=true;A2.owner.doSelection(undefined,true);this.drawStage(false,true);},oncontextmenu:function AV(A2){if(mstrApp.isInVFInteractMode){U(A2);return false;}var A5=this.stage,A1=A5.owner,A3=A2.e||A2,A4=A3.ctrlKey||A3.metaKey;A2.preventDefault();A2.cancel();this.stopPropagation();if(!A4){this.contextMenuSelectionHandler();}if(this._isMouseDown){delete this._selectionState;delete this._isMouseDown;delete this._lastMousePosition;delete this._dragged;}if(!A4){if(A5.isOnFormattingMode){V.call(A5,A3);}else{A1.showSelectionMenu(A3,function(){V.call(A5,A3);AR.selectPropertyPanel(A1,"de");},true);}this.hideTooltip();}return false;},getInvolvedSprites:function(){var A3=[],A6;A3.push(this);var A5=this.unit;if(A5){var A2=A5.edges,A1=A2.length,A4;for(A4=0;A4<A1;A4++){A6=A2[A4];A3.push(A6.sprite);if(A6.from===A5){A3.push(A6.to.sprite);}else{A3.push(A6.from.sprite);}}}return A3;},touchSwipeMove:function(A4){var A1=A4.layerX,A3=A4.layerY,A2=this.getGeometry();A2.x=A1;A2.y=A3;this.setGeometry(A2);this.drawStage(false);},hoverHighlight:function(){if(!this.selectionState.hovered){this.selectionState.hovered=true;this.highlight();}},unHoverHighlight:function(){if(this.selectionState.hovered){this.selectionState.hovered=false;this.unHighlight();}},getStyle:function(){var A5=this.selectionState,A2=this.stage,A4=this.stage.themeType==="dark"?A2.circleStyle.dark:A2.circleStyle.light,A3=this.stage.IsInContextMenuSelectionIndex(this),A1=false;if(A5.selected===true){if(A3===true&&A2.contextMenuSelectionHighLight===true){A1=A4.selectedStyleC;if(this.attSrc==="from"){A1.selectionBorders.inner.color.value=A4.normal.fromNode.color.value;}else{A1.selectionBorders.inner.color.value=A4.normal.toNode.color.value;}}else{A1=A4.selectedStyleA;}}else{if(A3===true&&A2.contextMenuSelectionHighLight===true){A1=A4.selectedStyleB;if(this.attSrc==="from"){A1.selectionBorders.outer.color.value=A4.normal.fromNode.color.value;}else{A1.selectionBorders.outer.color.value=A4.normal.toNode.color.value;}}}return A(A4.normal,A5.hovered&&A4.hovered,A1,A5.hovered&&A5.selected&&A4.selectedHovered);},getLabelBoundingBox:function(){var BA=this.textSize,A3=this.stage,A4=(A3.currentLayout===i.LINEAR),A1=this.position,A8=A1.x,A7=A1.y,A9,A6,A5,A2;if(A4){A9=BA.height;A6=BA.width;}else{A9=BA.width;A6=BA.height;}A5=(A9+Ap)/2;A2=(A6+Ap)/2;return{top:A7-A2,left:A8-A5,bottom:A7+A2,right:A8+A5};},isShowLabel:function AI(){var A6=this.stage,A3=A6.circleStyle.showNodeLabel||(this.selectionState.hovered&&!this._hoverHighlighted),A1=!A6.transitionTimer&&A3,A4=this.getLabelBoundingBox(),A5=A6.labelBitmap,A2;if(A1){A2=A5&&A5.testZeros(A4);if(A2){A5.set(A4);}}return A1&&A2;},draw:function Al(A5,A7){if(this.isExcluded){return ;}this._super();var A8=this.stage,A4=this.getCanvas(),BC=A8.background;if(!A4){D("cannot find the corresponding canvas.");return ;}var BD=A4.getContext("2d"),A3=this.position,A1=A3.r>1?A3.r:1,A2=this.getStyle(),BA;var A6,A9=[];function BB(BE){A6=A2[BE+"Node"].shape;BA=A2[BE+"Node"].color;if(!A2.selectionBorders){A9.push(A2[BE+"Node"].border);}return A9;}A9=BB(A7);if(A5){BA=k.mix(BA,BC);}Aa(BD,BA,A3,A1,A6);if(A2.selectionBorders){A9.push(A2.selectionBorders.inner);A9.push(A2.selectionBorders.outer);}if(A2.highlightBorder){A9.push(A2.highlightBorder);}J.forEach(A9,function(BE){if(A5){BE.color=k.mix(BE.color,BC);}A1=AC(BD,A3.x,A3.y,A1,BE,A6);});if(A8.onDraw){A8.onDraw(this);}this.drawText();},drawText:function(){function A8(BC,BA,BG){function BD(BI,BM,BJ){var BL=BM.x,BK=BM.y,BH=BA&Af.FS_BOLD?2:1;BI.save();BI.lineWidth=1;BI.strokeRect(BL-1,BK-1,BJ+2,BH+2);BI.fillRect(BL,BK,BJ,BH);BI.restore();}var BE=this.textSize,BB=BE.width,BF=BG.x-BB/2;if(BA&Af.FS_UNDERLINE){BD(BC,{x:BF,y:BG.y+BE.height/2},BB);}if(BA&Af.FS_STRIKETHROUGH){BD(BC,{x:BF,y:BG.y},BB);}}var A5=this.stage,A2=this.getCanvas(),A9=A2.getContext("2d"),A1=this.position,A7=A1,A6=this.stage.circleLabelStyle,A4=A6.fontColor,A3=A6.fontStyle;if(!this.isShowLabel()){this.hasDrawnLabel=false;return ;}A9.save();A9.font=W(A6);A9.lineWidth=AD;A9.fillStyle=k.getCSSColorString(A4.fill.value,A4.fill.opacity);A9.strokeStyle=k.getCSSColorString(A4.stroke.value,A4.stroke.opacity);A9.lineJoin="round";A9.textBaseline="middle";A9.textAlign="center";if(A5.currentLayout===i.LINEAR){A9.translate(A1.x,A1.y);A9.rotate(-Math.PI/2);A7={x:0,y:0};}A9.strokeText(this.text,A7.x,A7.y);A9.fillText(this.text,A7.x,A7.y);A8.call(this,A9,A3,A7);A9.restore();this.hasDrawnLabel=true;},isHit:function(A1,A7){var A5=this.position,A3=A5.x-A1,A2=A5.y-A7,A4=A5.r,A6=A3*A3+A2*A2;return(A6<=A4*A4);},setGeometry:function(A5){if(A5){var A1=A5.x,A7=A5.y,A3=A5.s,A4=this.position,A6=false,A2;if(!isNaN(A1)&&Math.abs(A1)!==Infinity){if(A1!==A4.x){A6=true;A4.x=A1;}}if(!isNaN(A7)&&Math.abs(A7)!==Infinity){if(A7!==A4.y){A6=true;A4.y=A7;}}if(!isNaN(A3)&&Math.abs(A3)!==Infinity){if(A3!==A4.r){A6=true;A4.r=A3;}}if(A6){this.stylesChanged();A2=this.unit&&this.unit.edges;J.forEach(A2,function(A8){A8=A8.sprite;A8.stylesChanged(true);});}}},getGeometry:function(){var A2=this.position,A1=this.geometry;A1.x=A2.x;A1.y=A2.y;A1.s=A2.r;return A1;},getBorderWidth:function(){var A3,A1,A5=this.getStyle(),A6=[],A2,A4=0;if(A5.selectionBorders){A6.push(A5.selectionBorders.inner);A6.push(A5.selectionBorders.outer);}else{if(AR.getPropertyByPath(A5,"fromNode.border",false)===false&&AR.getPropertyByPath(A5,"toNode.border",false)===false){A6.push(A5.border);}else{A6.push(A5.fromNode.border);A6.push(A5.toNode.border);}}for(A3=0,A1=A6.length;A3!==A1;A3++){A5=A6[A3];if(A5.style){A2=z(A5.style);A4+=A2.thk+1;}else{A4+=A5.width||1;}}return A4;},updateTextSize:function(){var A1=this.text,A3=this.stage.circleLabelStyle,A4=H(A3.fontSize),A2=AR.measureTextWidth(A1,{fontSize:A3.fontSize,fontFamily:A3.fontFamily,fontStyle:As(A3.fontStyle)},R);this.textSize={width:A2,height:A4};}});var E={hovered:"white"};var e={hovered:"black"};function AH(A4){var A5=A4.start,A1=A4.end,A2,A3=false;if(A5>A1){A2=A5;A5=A1;A1=A2;A3=!A3;}if(A5<=Math.PI&&A1>A5+Math.PI){A2=A5;A5=A1;A1=A2;A3=!A3;}if(A3){A2=A4.p1;A4.p1=A4.p2;A4.p2=A2;}A4.start=A5;A4.end=A1;}function c(A1,A5){var A3=A5.x-A1.x,A2=A5.y-A1.y,A4=Math.acos(A3/Math.sqrt(A3*A3+A2*A2));if(A2>=0){return A4;}return 2*Math.PI-A4;}function h(BL,BD,A7,A8,BF){var A3=AR.isNearZero,BJ=BF/2,BH=A8*Math.cos(BJ)+Math.sqrt(A7*A7-A8*A8*Math.pow(Math.sin(BJ),2)),BB=BD.x-BL.x,BA=BD.y-BL.y,BG,A5,A4,BK,A6,BI,BE,BC,A9,A2,A1;BG=Math.sqrt(BB*BB+BA*BA);A5=BB*BH/BG;A4=BA*BH/BG;A6=Math.acos((A7*A7+BH*BH-A8*A8)/(2*A7*BH));BI=A4/BH;if(A3(Math.abs(A4)-Math.abs(BH))){if(A4<0){BI=-1;}else{if(A4>0){BI=1;}}}BI=Math.asin(BI);BE=BI+A6;BC=BI-A6;A9=BB/Math.abs(BB);BK={x:BD.x+A5,y:BD.y+A4};if(isNaN(A9)){A2={x:BD.x+A7*Math.cos(BE),y:BD.y+A7*Math.sin(BE)};A1={x:BD.x+A7*Math.cos(BC),y:BD.y+A7*Math.sin(BC)};}else{A2={x:BD.x+A7*Math.abs(Math.cos(BE))*A9,y:BD.y+A7*Math.sin(BE)};A1={x:BD.x+A7*Math.abs(Math.cos(BC))*A9,y:BD.y+A7*Math.sin(BC)};}return{center:BK,p1:A2,p2:A1};}function AB(){var BB=this,A9=this.stage,A7=A9.currentLayout,A3=BB.from.position,A5;var A4=BB.width>1?BB.width:1,A1=A3.r+BB.from.getBorderWidth()/2,BC=j+A4/2;if(A7===i.CIRCULAR){A5=A9.graphCenter;}else{if(A7===i.FORCE_DIRECTED){A5=A9.findForceDirectedGraphCenter(BB.from);}else{A5=A9.findLinearLayoutGraphCenter(BB.from);}}var BA=h(A5,A3,A1,BC,a);var A2=c(BA.center,BA.p1);var A6=c(BA.center,BA.p2);var A8=BA;A8.start=A2;A8.end=A6;A8.r=BC;AH(A8);return A8;}function p(A8){var A2=this,A6=AB.call(A2),BA,A9,A7,A1=A6.start,A4=A6.end,A5=Math.max(A2.width,1),A3;if(isNaN(A6.center.x)||isNaN(A6.center.y)){return false;}BA=A8.x-A6.center.x;A9=A8.y-A6.center.y;A7=Math.sqrt(BA*BA+A9*A9)-j;if(A7<0||A7>A5){return false;}A3=c(A6.center,A8);if(A1<A4){return A3<=A1||A3>=A4;}if(A1>A4){return A4<=A3&&A3<=A1;}return true;}function AZ(A3,A2,A1){A1.save();A1.fillStyle=A2;A1.lineWidth=A3.width;A1.lineJoin="round";A1.lineCap="round";A1.miterLimit=0;A1.beginPath();A1.moveTo(A3.tip.x,A3.tip.y);A1.lineTo(A3.wing1.x,A3.wing1.y);A1.lineTo(A3.crossing1.x,A3.crossing1.y);A1.lineTo(A3.crossing2.x,A3.crossing2.y);A1.lineTo(A3.wing2.x,A3.wing2.y);A1.closePath();A1.fill();A1.restore();}function AF(A1,A6,A7){var BD=A6.x-A1.x,BC=A6.y-A1.y,A8=AR.isNearZero,A4=A8(BD),A2=A8(BC),A3,A5,A9,BB,BA;if(A4&&A2){return{x:A6.x,y:A6.y};}if(A4){return{x:A6.x,y:A6.y-(BC>0?A7:-A7)};}if(A2){return{x:A6.x-(BD>0?A7:-A7),y:A6.y};}A5=BD/BC;A3=BC>0?-1:1;A9=Math.sqrt(A7*A7/(A5*A5+1));BA=A6.y+A3*A9;BB=A6.x+A5*(BA-A6.y);return{x:BB,y:BA};}function Ax(A7,A1,A2){var A9=A1.x-A7.x,A8=A1.y-A7.y,A6=AR.isNearZero,A4=A6(A9),A3=A6(A8),A5;if(A4&&A3){return{a:A2.y/A2.x,b:-1,c:0};}if(A4){return{a:0,b:1,c:-A2.y};}if(A3){return{a:1,b:0,c:-A2.x};}A5=A9/A8;return{a:-A9,b:-A8,c:(A2.x*A5+A2.y)*A8};}function K(A8,BT,A1,BK){var BR=A8.a,BQ=A8.b,BO=A8.c,A3=AR.isNearZero,BF=A3(BR),A6=A3(BQ);if(BF||A6){var A7=AN*BK,BP=AF(BT,A1,A7),A9=Ab*BK;if(BF&&A6){return[{x:A1.x,y:A1.y},{x:A1.x,y:A1.y}];}if(BF){return[{x:BP.x+A9,y:BP.y},{x:BP.x-A9,y:BP.y}];}if(A6){return[{x:BP.x,y:BP.y+A9},{x:BP.x,y:BP.y-A9}];}}var BS=BR*BR,BN=BT.x,A5=BT.y,BJ=Math.sqrt(BR*BR+BQ*BQ),BI=Ab*BK*BJ,BH=M*BK*BK,BG=BI-BO,BE=BR*BR+BQ*BQ,BD=2*(BN*BR*BQ-BQ*BG-BS*A5),BC=BG*BG+BS*BN*BN-2*BN*BR*BG+BS*A5*A5-BH*BS,BB=Math.sqrt(BD*BD-4*BE*BC),BA=2*BE,A4=(-BD+BB)/BA,A2=(-BD-BB)/BA,BM=(BG-BQ*A4)/BR,BL=(BG-BQ*A2)/BR;return[{x:BM,y:A4},{x:BL,y:A2}];}function m(A8,A2,A7,A3){var BA=AF(A8,A2,A7),BB=AF(A8,A2,A7+A3),A9=Ax(A8,A2,BB),A1=K(A9,BB,BA,A3),A6=M*A3/3,A5=AF(BB,A1[0],A6),A4=AF(BB,A1[1],A6);return{tip:BA,inner:BB,wing1:A1[0],wing2:A1[1],crossing1:A5,crossing2:A4,width:A3};}function w(A9,A3,A8){var A6=A9.x,A5=A9.y,A2=A3.x,A1=A3.y,A7=A8.x,A4=A8.y;return AR.isNearZero(A6*(A1-A4)+A2*(A4-A5)+A7*(A5-A1));}var s=mstrmojo.declare(I,[],{scriptClass:"mstrmojo.netviz.VisNetworkStage.EdgeSprite",init:function(A1){this.controlPoint={x:0,y:0};if(this._super){this._super(A1);}},getTooltipInfo:function(){function A3(BA){var BB=BA.unit;return[].concat(BA.from.getTooltipAttrInfo(A9),BA.to.getTooltipAttrInfo(A4),BB.values.map(function(BC,BD){return{n:BC.metricName,v:BB.format(BC.value,BD)};}));}var A2,A1=this.unit.reversedEdge,A5=this.stage.currentLayout===i.CIRCULAR,A7=this.stage.owner.abstractedModel||{},A8=A7.indexes,A6=A7.attributes,A9,A4;if(A8&&A6){A9=(A6[A8.fromIndex]||{}).name;A4=(A6[A8.toIndex]||{}).name;}A2=A3(this);if(A5&&A1){A2=A2.concat(null,A3(A1.sprite));}return A2;},onmousemove:function(A4){var A1=A4.layerX,A6=A4.layerY,A2=this.isHit(A1,A6),A5=this.stage,A3=false;A4=A4.e||A4;if(this.selectionState.hovered&&!A2){this.unHoverHighlight();this.hideTooltip();delete A5._isEdgeHovered;if(A5._pendingRefresh){A5.onSpriteStyleChange(AT.CIRCLE);A5.onSpriteStyleChange(AT.EDGE);}A3=true;}else{if(!this.selectionState.hovered&&A2){this.stopPropagation();this.hoverHighlight();A5._isEdgeHovered=true;A3=true;}}if(A3){if(A5.selectedSprites.length>0){A5.onSpriteStyleChange(AT.HIGHLIGHT);}A5.draw(false,true);if(!this.selectionState.hovered){delete A5._pendingRefresh;}}if(this.selectionState.hovered){this.stopPropagation();this.showTooltip({x:A4.clientX,y:A4.clientY});}},oncontextmenu:function(A5){if(mstrApp.isInVFInteractMode){U(A5);return false;}A5=A5.e||A5;this.stopPropagation();var A2=new mstrmojo.ui.menus.MenuConfig(),A4=this.stage,A3=A4.owner,A7=A3.getColorByMetric();if(A7&&!mstrApp.isDossier){A2.addMenuItem(mstrmojo.desc(13174,"Select color ranges..."),"",function(){A3.model.openThresholdEditor(A7,true,false);});}var A1=A3.observableModel.showEdgeDirection,A6=A1.getValue();A2.addMenuItem(mstrmojo.desc(12080,"Show Edge Direction"),A6?"on":"",function(){A1.setValue(!A6);});A2.hasToggleItem=true;A3.showMenu(A2,A5);},hoverHighlight:function(){this.selectionState.hovered=true;if(this.from){this.from.hoverHighlight();}if(this.to){this.to.hoverHighlight();}this.highlight();},unHoverHighlight:function(){this.selectionState.hovered=false;if(this.from){this.from.unHoverHighlight();}if(this.to){this.to.unHoverHighlight();}this.unHighlight();},getEndPoint:function(){var A2=this.stage,A4=A2.showEdgeDirection,BA=this,A5=BA.to,A9=A5.getGeometry(),A7=A9,A6=BA.controlPoint,A1=BA.width>1?BA.width:1,A3=A1<4?4:A1,BB,A8;if(A4){BB=BA.arrow||m(A6,A9,A9.s+A5.getBorderWidth(),A3);A8={x:(BB.crossing1.x+BB.crossing2.x)/2,y:(BB.crossing1.y+BB.crossing2.y)/2};A7=AF(A9,A8,0.15);if(!BA.arrow){BA.arrow=BB;}}return{pos:A7,arrow:BB};},draw:function l(){if(this.isExcluded){return ;}var BI=this.stage,BB=BI.currentLayout===i.CIRCULAR,BD=this.unit,BC,BE=this,A3=this.getCanvas(),BG=A3.getContext("2d"),BA=BE.to,A2=BE.from.position,A1=BA.position,A9=BE.controlPoint,BF=BE.width>1?BE.width:1,A7=BE.selectionState,BH,BJ,BK,A5,A8,A6=A2,A4;if(BB&&this.skipBidirectional){return ;}if(A7.hovered||A7.selected){BH=this.stage.themeType==="dark"?E.hovered:e.hovered;}else{BH=BE.color;}BG.strokeStyle=BH;BG.lineWidth=BF;if(A2===A1){BJ=AB.call(this);BG.beginPath();BG.arc(BJ.center.x,BJ.center.y,BJ.r,BJ.start,BJ.end,true);BG.stroke();}else{BK=this.getEndPoint();A4=BK.pos;A8=BK.arrow;BC=BD.reversedEdge;if(BB&&BC){BC=BC.sprite;BC.skipBidirectional=true;BE.skipBidirectional=false;BK=BC.getEndPoint();A6=BK.pos;A5=BK.arrow;}BG.beginPath();BG.moveTo(A6.x,A6.y);if(w(A6,A9,A4)){BG.lineTo(A4.x,A4.y);}else{BG.quadraticCurveTo(A9.x,A9.y,A4.x,A4.y);}BG.stroke();}if(A5){AZ(A5,BG.strokeStyle,BG);}if(A8){AZ(A8,BG.strokeStyle,BG);}if(BI.onDraw){BI.onDraw(this);}this._super();},isHit:function(BE,BB){var BK=Math.max(1,this.width/2),A2=this.controlPoint,A1=this.to.position,A3=this.from.position,BF=A3.x-2*A2.x+A1.x,BJ=2*(A2.x-A3.x),A6=A3.x-BE,BA=BJ*BJ-4*BF*A6,BD=A3.y-2*A2.y+A1.y,BI=2*(A2.y-A3.y),A4=A3.y-BB,A8=BI*BI-4*BD*A4,BL;function A5(BO,BN){return Math.sqrt(Math.pow((BO.x-BN.x),2)+Math.pow((BO.y-BN.y),2));}if(this.from===this.to){return p.call(this,{x:BE,y:BB});}var A7=[];var BG,BC,A9;if(BF===0){if(BJ!==0){BG=(BE-A3.x)/(2*(A2.x-A3.x));}else{BG=0;}A7.push(BG);}else{if(BA>=0){BC=(Math.sqrt(BA)-BJ)/(2*BF);A9=(-1*Math.sqrt(BA)-BJ)/(2*BF);A7.push(BC);A7.push(A9);}}if(BD===0){if(BI!==0){BG=(BB-A3.y)/(2*(A2.y-A3.y));}else{BG=0;}A7.push(BG);}else{if(A8>=0){BC=(Math.sqrt(A8)-BI)/(2*BD);A9=(-1*Math.sqrt(A8)-BI)/(2*BD);A7.push(BC);A7.push(A9);}}var BH,BM;for(BH=0;BH<A7.length;BH++){BM=g(A7[BH],A3,A2,A1);BL=A5({x:BE,y:BB},BM);if(BL<=BK){return true;}}return false;},getGeometry:function(){var A2=this.controlPoint,A1=this.geometry;A1.x=A2.x;A1.y=A2.y;A1.s=this.width;return A1;},setGeometry:function(A4){if(A4){var A1=A4.x,A6=A4.y,A2=A4.s,A3=this.controlPoint,A5=false;if(!isNaN(A1)&&Math.abs(A1)!==Infinity){if(A1!==A3.x){A3.x=A1;A5=true;}}if(!isNaN(A6)&&Math.abs(A6)!==Infinity){if(A6!==A3.y){A3.y=A6;A5=true;}}if(!isNaN(A2)&&Math.abs(A2)!==Infinity){if(A2!==this.width){this.width=A2;A5=true;}}if(A5){this.stylesChanged();}}},stylesChanged:function(A1){if(this._super){this._super();}if(A1){this.arrow=undefined;}}});function AO(){function A2(){var A3=this.circleStyle,A7=this.themeType==="dark"?A3.dark:A3.light,A4=N.clone(A7.normal),A8=AR.getPropertyByPath(A4,"color.value",false)!==false?k.getCSSColorString(A4.color.value):undefined,BF=AR.getPropertyByPath(A4,"border.color.value",false)!==false?k.getCSSColorString(A4.border.color.value):undefined,BC=AR.getPropertyByPath(A4,"fromNode.color.value",false),BE=AR.getPropertyByPath(A4,"toNode.color.value",false),A6=AR.getPropertyByPath(A4,"fromNode.border.color.value",false),BA=AR.getPropertyByPath(A4,"toNode.border.color.value",false),BB=BC===false?A8:BC,BD=BE===false?A8:BE,A5=A6===false?BF:A6,A9=BA===false?BF:BA;A4={fromNode:{border:AR.getPropertyByPath(A4,"fromNode.border",false)!==false?A4.fromNode.border:A4.border,color:AR.getPropertyByPath(A4,"fromNode.color",false)!==false?A4.fromNode.color:A4.color,shape:A4.fromNode!==undefined?A4.fromNode.shape:"Circle"},toNode:{border:AR.getPropertyByPath(A4,"toNode.border",false)!==false?A4.toNode.border:A4.border,color:AR.getPropertyByPath(A4,"toNode.color",false)!==false?A4.toNode.color:A4.color,shape:A4.toNode!==undefined?A4.toNode.shape:"Circle"}};A4.fromNode.border.color.value=k.getCSSColorString(A5);A4.fromNode.color.value=k.getCSSColorString(BB,undefined,{retainGradientObject:true});A4.toNode.border.color.value=k.getCSSColorString(A9);A4.toNode.color.value=k.getCSSColorString(BD,undefined,{retainGradientObject:true});A4.showNodeLabel=A3.showNodeLabel;A7.normal=A4;return A4;}var A1=this.addDisposable(new AX({background:this.background,circleStyle:A2.call(this),circleLabelStyle:this.circleLabelStyle,dragMode:this.dragMode}));A1.background.attachEventListener("valueChanged",this.id,function(A4){var A6=A1.background.getRawObject();this.background=A6;var A3=this.owner,A5=F.encodeColor(A3.getFormats()["background-color"],10),A7=F.encodeColor(A4.newValue,10);if(A5!==A7){AR.changeWidgetBackground(A3,A4.newValue,A4.oldValue);}A3.onStylesModified("background",A6);});A1.circleStyle.attachEventListener("valueChanged",this.id,function(){function A5(A9,A8){var A6=this.observableModel,A7=A9;this.circleStyle=A9;Ao.call(this);if(A8){A7=A2.call(this);A6.circleStyle.setValue(A7,true);this.owner.propInfo.circleStyle=A6.circleStyle;}this.draw(false,true,true);}var A3=A1.circleStyle.getRawObject();A3.fromNode.border.color.value=k.getColorValue(A3.fromNode.border.color.value);A3.fromNode.color.value=k.getColorValue(A3.fromNode.color.value);A3.toNode.border.color.value=k.getColorValue(A3.toNode.border.color.value);A3.toNode.color.value=k.getColorValue(A3.toNode.color.value);var A4=this.themeType==="dark"?this.circleStyle.dark:this.circleStyle.light;A4.normal=A3;this.circleStyle.showNodeLabel=A3.showNodeLabel;this.owner.onStylesModified("circleStyle",A3,A5);A5.call(this,this.circleStyle);});A1.circleLabelStyle.attachEventListener("valueChanged",this.id,function(A3){function A5(A8,A7){var A6=this.observableModel;this.circleLabelStyle=A8;if(A7){P.call(this);A6.circleLabelStyle.setValue(this.circleLabelStyle,true);}if(A4){(this.spriteCollection||[]).forEach(function(A9){if(A9.type==="Circle"){A9.updateTextSize();}});}this.draw(false,true,true);}var A4=(A3.target!==A1.circleLabelStyle.fontColor.fill.value);this.owner.onStylesModified("circleLabelStyle",A1.circleLabelStyle.getRawObject(),A5);A5.call(this,A1.circleLabelStyle.getRawObject());});A1.dragMode.attachEventListener("valueChanged",this.id,function(A3){function A5(A7,A6){this.dragMode=A7;if(A6){this.observableModel.dragMode.setValue(A7,true);}if(A7===Ah.pan){this.dismissLassoSelector();this.lassoSelectorEnabled=false;this.scaleBar.inputPan.checked=true;}else{if(A7===Ah.select){this.lassoSelectorEnabled=true;this.scaleBar.inputSelect.checked=true;}}}var A4=A3.newValue;A5.call(this,A4);this.owner.onStylesModified("dragMode",A4,A5);});return A1;}function P(){var A1=this.circleLabelStyle,A2=N.clone(AK);N.copy(A1||{},A2);if(!A2.fontColor){A2.fontColor=N.clone(this.themeType==="dark"?Ay.dark:Ay.light);}this.circleLabelStyle=A2;this.owner.propInfo.circleLabelStyle=A2;}function Ao(){var A3=this.circleStyle,A2=Object.keys(A3),A1;if(!A3||(A2.length===1&&A2[0]==="showNodeLabel")){A1=A3.showNodeLabel;this.circleStyle=N.clone(Z);this.circleStyle.showNodeLabel=A1;}else{if(!this.circleStyle.light||!this.circleStyle.dark){var A5=N.clone(Z),A4=this.themeType==="dark"?A5.dark:A5.light;A4.normal=this.circleStyle;A5.showNodeLabel=this.circleStyle.showNodeLabel;delete this.circleStyle.showNodeLabel;this.circleStyle=A5;}}}mstrmojo.netviz.VisNetworkStage=mstrmojo.declare(mstrmojo.Container,[mstrmojo._HasPopup,mstrmojo.netviz._HasNetworkContextMenu,mstrmojo.util.ui._LassoSelector],{scriptClass:"mstrmojo.netviz.VisNetworkStage",markupString:'<div id="{@id}-networkstage" style="position: absolute; left: {@left}px; top: {@top}px; width: {@width}px; height:{@height}px;" mstrAttach:mousedown,mousemove,click,contextmenu><div id="{@id}-canvas-parent-parent" style="position: absolute; width: {@width}px; height: {@height}px;"><div id="{@id}-canvas-parent" style="position: relative; z-index: 0;"><canvas id="{@id}-canvas" style="position: absolute; z-index: {@canvasCount}" id="canvas" width= "{@width}" height="{@height}"></canvas></div></div><div style="position: absolute; display:none; border: 2px dotted white; -webkit-user-select: none;"></div><div style="position: absolute; left: '+AP+"px; top: "+A0+'px;"></div><div style="position: absolute;"></div></div>',markupSlots:{baseCanvas:function(){return this.domNode.firstChild.firstChild.firstChild;},canvasContainer:function(){return this.domNode.firstChild.firstChild;},canvasOuterContainer:function(){return this.domNode.firstChild;},selectionRectangle:function(){return this.domNode.childNodes[1];},scaleBarPlaceHolder:function(){return this.domNode.childNodes[2];},containerNode:function(){return this.domNode.childNodes[0];}},circleMenuOnCloseFlag:false,contextMenuSelectionHighLight:false,init:function(A1){this.spriteCollection=[];this.selectedSprites=[];this.contextMenuSelection=[];this.circleMenuOnCloseFlag=false;this.contextMenuSelectionHighLight=false;this.frameRate=60;this.frameInterval=Math.ceil(1000/this.frameRate);this.eventHasBeenHandled=false;this.isOnFormattingMode=false;this.dragMode=Ah.pan;this.canvases=[];this.canvasCount=2;this.layers=[];this.transitionDuration=AS;if(this._super){this._super(A1);}this.scaleBarRect={x:AP,y:A0,w:Am,h:X};Ao.call(this);P.call(this);if(this.showTransition){this.enableTransition();}this.observableModel=AO.call(this);if(!this.tooltip){this.tooltip=this.addDisposable(new mstrmojo.VisTooltip({placeholder:document.body.appendChild(document.createElement("div")),owner:this}));this.tooltip.render();this.tooltip.domNode.style.display="none";}this.enableRaiseEventsForGestures();},themeType:"dark",destroy:function(){var A1=this.tooltip;if(A1.domNode&&A1.domNode.parentNode){A1.domNode.parentNode.removeChild(A1.domNode);}delete this.spriteCollection;delete this.selectedSprites;delete this.canvases;delete this.layers;if(this._super){this._super();}},preBuildRendering:function(A1){this._super(A1);},postBuildRendering:function(A2){if(this._super){this._super(A2);}var A1=this.baseCanvas;if(!A1){D("No canvas found. Init failed");return ;}this.putSpritesInCanvases();J.forEach(this.layers,function(A4){if(A4){A4.sort(function(A6,A5){if(A6.zIndex>A5.zIndex){return 1;}if(A6.zIndex===A5.zIndex){return 0;}return -1;});}});this.clear();this.updateCanvasPosition();this.draw();this.scaleBar=this.addDisposable(new mstrmojo.netviz.VisNetworkStageScaleBar({owner:this,placeholder:this.scaleBarPlaceHolder,width:this.scaleBarRect.w,height:this.scaleBarRect.h,scale:this.scale,range:{min:AE?0.00001:0.5,max:AE?10:2},setDragType:this.setDragType,resetScene:this.resetScene,dragMode:this.dragMode}));this.scaleBar.render();var A3=this;AR.addWheelListener(this.domNode,function(A7){A7.preventDefault();A3.dismissLassoSelector();if(A3.transitionTimer){return ;}var A4=A3.scaleBar,A6=A7.deltaY>0?-1:1,A8=0.1,A5=isNaN(A4.scaleFactor)?1:A4.scaleFactor;A5+=A6*A8;A4.setScaleFactor(A5);A4._deActoniveTimer=window.setTimeout(function(){A4.setScaleFactorDone();},1000);});this.registerLassoSelector(this.domNode,[],false);},lassoSelecting:function(){Ar.removeClass(this.lassoSelector,"lasso-selector-hasContent");},lassoSelected:function(A4){var A3=this,A1=A3.owner,A2=A1.parent;A3.areaSelect({x0:A4.left,y0:A4.top,x1:A4.left+A4.width,y1:A4.top+A4.height},A4);if(A3.selectedSprites.length){Ar.addClass(this.lassoSelector,"lasso-selector-hasContent");}A1.doSelection();A1.displayVizBoxVisFilterIndicator(true,A2);},lassoSelectorResized:function(A1){this.lassoSelecting();this.lassoSelected(A1);},initScaleBar:function(A2){var A1=this.scaleBar;var A3=A2||this.getLocalProp(Aq.ZOOM_FACTOR);if(!isNaN(A3)&&A3!==1){A1.setScaleFactor(A3);}},getLocalProp:function(A2){var A1=this.owner;return A1&&A1.getLocalProp(A2);},setLocalProp:function(A3,A2){var A1=this.owner;return A1&&A1.setLocalProp(A3,A2);},setMainRect:function(A1){if(!A1){return ;}this.scaleBarRect.x=A1.x+AP;if(this.scaleBar&&this.scaleBar.domNode){this.scaleBar.domNode.style.left=this.scaleBarRect.x+"px";}A1.x=this.scaleBarRect.x+this.scaleBarRect.w;A1.w=A1.w-this.scaleBarRect.w-AP;this.mainRect=A1;},onSpriteStyleChange:function(A2){if(!this.toBeDrawnLayersIndexes){this.toBeDrawnLayersIndexes=[];}var A1=this.toBeDrawnLayersIndexes;if(!isNaN(A2)&&A1.indexOf(A2)===-1){A1.push(A2);}},removeSpriteFromLayer:function(A3,A2){var A1=false,A5=this.layers[A2],A4=A5.indexOf(A3);if(A4!==-1){A5.splice(A4,1);A1=true;if(this.hasRendered){this.onSpriteStyleChange(A2);}}return A1;},addSpriteToLayer:function(A3,A2){var A4=this.layers[A2],A1=false;if(A4){A3.layerIndex=A2;if(A4.indexOf(A3)===-1){A4.push(A3);A1=true;}if(this.hasRendered){this.onSpriteStyleChange(A2);}}return A1;},putSpritesInCanvases:function(){this.canvases=[];var A1=this.canvasCount-1,A4=this.canvases,A6=[],A3,A2=document.createDocumentFragment(),A8;[AT.EDGE,AT.CIRCLE,AT.HIGHLIGHT].forEach(function(BA){var A9=A6[BA]=[];A9.canvasIndex=BA===AT.HIGHLIGHT?Ak.HIGHLIGHT:Ak.BASE;});function A5(BB,BA){var A9=A6[BA];if(A9.indexOf(BB)===-1){BB.layerIndex=BA;A9.push(BB);}BB.getCanvas=function(){return this.stage.canvases[this.stage.layers[this.layerIndex].canvasIndex];};}for(A3=0;A3<A1;A3++){A8=document.createElement("canvas");A8.width=this.width;A8.height=this.height;A8.style.position="absolute";A8.style.zIndex=(A3+1).toString();A2.appendChild(A8);A4.push(A8);}this.canvasContainer.appendChild(A2);this.canvases.push(this.baseCanvas);var A7=this.spriteCollection;J.forEach(A7,function(A9){if(A9.type==="Circle"){A5(A9,AT.CIRCLE);J.forEach(A9.unit.edges,function(BA){BA=BA.sprite;A5(BA,AT.EDGE);});}});this.layers=A6;},unrender:function(A1){if(this.scaleBar&&this.scaleBar.unrender){this.scaleBar.unrender(A1);}if(this._super){this._super(A1);}},updateCanvasPosition:function(){this.canvasPosition=AW(this.baseCanvas,true);},enableRaiseEventsForGestures:function(){var A6=Au;var A5=this,A4,A7,BA=this.id;var A9=function(BF,BE){return function(BI){var BH=AW(this.baseCanvas,true),BG=BI.e||BI.evt||BI;BI.name=BF;BI.layerX=BG.pageX-BH.x;BI.layerY=BG.pageY-BH.y;mstrmojo.all[BA].eventHasBeenHandled=false;mstrmojo.all[BA].raiseEventForSprites(BI);if(BE){BE.call(mstrmojo.all[BA],BI);}};};var A8=A5.onmousemove,BC,A2,A3,A1,BB,BD;for(A4=0,A7=A6.length;A4<A7;A4++){BC=A6[A4];A2="on"+BC;A3=A5[A2];A5[A2]=A9(BC,A3);}A1=A5.onmousemove;A5.onmousemove=function(BE){if(!mstrmojo.all[BA]._isMouseDown){A1.call(mstrmojo.all[BA],BE);}else{A8.call(mstrmojo.all[BA],BE);}};BB=A5.onmousedown;BD=A5.onmouseup;A5.onmousedown=function(BE){BB.call(mstrmojo.all[BA],BE);AR.captureEventOnce("mouseup",BD,mstrmojo.all[BA]);};},clear:function AG(A4){var A3=[],A5=this,A1=this.width,A2=this.height;if(A4 instanceof Array){A4.forEach(function(A7){var A6=A5.canvases[A5.layers[A7].canvasIndex];if(A3.indexOf(A6)===-1){A3.push(A6);}});}else{A3=this.canvases;}A3.forEach(function(A7){var A6;A6=A7.getContext("2d");A6.clearRect(0,0,A1,A2);A6.fillStyle="rgba(0, 0, 0, 0)";A6.fillRect(0,0,A1,A2);});},applyScaleAndPosition:function(){var A6=this.spriteCollection,A5=A6.length,A2=this.sceneInformation.position,A4=this.scaleFactor,A9=this.width/2,A7=this.height/2,A3,BA,A1;if(isNaN(A4)){A4=1;}for(A3=0;A3<A5;A3++){BA=A6[A3];A1=BA.getGeometry();A1.s=A1.s*A4;A1.x=(A1.x-A9)*A4+A9+A2.x;A1.y=(A1.y-A7)*A4+A7+A2.y;BA.setGeometry(A1);}if(this.currentLayout===i.CIRCULAR){var A8=this.graphCenter;if(A8){A8.x=(A8.x-A9)*A4+A9+A2.x;A8.y=(A8.y-A7)*A4+A7+A2.y;}}this.scaleFactor=1;A2.x=0;A2.y=0;},setDragType:function(A2){var A1=AR.getPropertyByPath(this,"observableModel.dragMode");if(A1!==undefined){A1.setValue(A2);}},drawLayer:function AM(A3,A5){if(!A3){return ;}var A1=A3.length,A2,A4;for(A2=A1-1;A2>=0;A2--){A4=A3[A2];A4.draw(A5,A4.attSrc);delete A4.hasStyleChanged;}},drawFrame:function Ad(A2,BG){var BL,BK,A1,BH,A4,BD,BA,A7,BJ,BN,BF,A9,BP=this,BB="timerid_draw";function BM(BS){var BQ=BD["diff"+BS],BR=BQ*A9;if(!isNaN(BR)){BD[BS]=BD["start"+BS]+BR;}}if(!BP._hasDrawnTheFirstFrame){t.startTimer({functionName:"VisNetworkStage.draw",purpose:"Rendering the canvas"},BB);}BP.clear(BG);BA=[];if(BG instanceof Array){for(BK=0;BK<BG.length;BK++){A7=BG[BK];BN=BP.layers.length;for(BJ=0;BJ<BN;BJ++){var BI=BP.layers[A7],BE=BP.layers[BJ];if(BJ!==A7&&BI&&BE&&BI.canvasIndex===BE.canvasIndex&&BG.indexOf(BJ)===-1){BG.push(BJ);}}}BG.sort();J.forEach(BG,function(BR){var BQ=BP.layers[BR];if(BQ){BA.push(BQ);}});}else{BA=BP.layers;}if(!BA.length){D("nothing to draw");return ;}if(BP.transitionTimer){A1=BP.spriteCollection;BL=A1.length;BF=A2-BP.transitionStartTime;if(BF>BP.transitionDuration){for(BK=0;BK<BL;BK++){BH=A1[BK];A4=BH.newGeometry;BH.setGeometry(A4);delete BH.transitionGeometry;}BP.onDrawTransitionEnd();}else{A9=BF/BP.transitionDuration;for(BK=0;BK<BL;BK++){BH=A1[BK];BD=BH.transitionGeometry;A4=BH.getGeometry();Ac(A4,BM);BH.setGeometry(BD);}}}var BO=BP.labelBitmap,A5=BG||N.valarray(AT),A6=A5.some(function(BQ){return BQ===AT.CIRCLE;}),A3=A5.some(function(BQ){return BQ===AT.HIGHLIGHT;})?BP.layers[AT.HIGHLIGHT]:[];BP.spriteCollection.forEach(function(BR){var BS,BQ;if(BR.type==="Circle"&&BR.hasDrawnLabel){BQ=A6||A3.some(function(BT){return BT===BR;});if(!BQ){BS=BR.getLabelBoundingBox();BO.set(BS.left,BS.top,BS.right,BS.bottom);}}});var A8=BA.length;if(BA[AT.HIGHLIGHT]!==undefined&&A8>1){if(A8===2){D("WARN: refresh only two layers: highlight and [circle|edge]");}BA=BA.slice();BA.splice(AT.HIGHLIGHT,1);}var BC=BP.layers[AT.HIGHLIGHT];J.forEach(BA,function(BQ){if(BQ){BP.drawLayer(BQ,BQ===BC);}});D("draw done");BP.toBeDrawnLayersIndexes=[];if(!BP._hasDrawnTheFirstFrame){BP._hasDrawnTheFirstFrame=true;t.endTimer(BB);}},draw:function AJ(A1,BD,A5){var A2,A9,A7,A3,BC,BB,BA,A6=this;function A8(BE){BB["diff"+BE]=BA[BE]-BB[BE];BB["start"+BE]=BB[BE];}function A4(BG){var BE=A6.id,BF=mstrmojo.all[BE];if(!BF){return ;}if(!BD&&A6.transitionTimer===undefined){if(A6.lastDrawTime!==undefined&&BG-A6.lastDrawTime<A6.frameInterval){D("draw ignored");return ;}}if(A6.transitionTimer&&!A6.transitionStartTime){A6.transitionStartTime=BG;}A6.labelBitmap=A6.addDisposable(new mstrmojo.netviz.Bitmap({left:0,top:0,right:A6.width,bottom:A6.height,scale:4}));A6.drawFrame.call(BF,BG,A2);A6.toBeDrawnLayersIndexes=[];A6.lastDrawTime=BG;if(A6.transitionTimer){A6.transitionTimer=window.requestAnimationFrame(A4);}}this.onDrawTransitionEnd();A2=this.toBeDrawnLayersIndexes;if(typeof A2==="number"&&this.layers[A2]){A2=[A2];}if(A5){A2=L(this.layers);}if(!A1){window.requestAnimationFrame(A4);}else{A9=this.spriteCollection;A7=A9.length;for(A3=0;A3<A7;A3++){BC=A9[A3];BB=N.clone(BC.oldGeometry);BA=N.clone(BC.getGeometry());Ac(BA,A8);BC.newGeometry=BA;BC.transitionGeometry=BB;}this.transitionTimer=window.requestAnimationFrame(A4);}},onDrawTransitionEnd:function(){if(this.transitionTimer){window.cancelAnimationFrame(this.transitionTimer);delete this.transitionTimer;delete this.transitionStartTime;}},clearHoverHighlight:function(){var A2=this.spriteCollection,A1=A2.length,A4,A3;for(A3=0;A3<A1;A3++){A4=A2[A3];if(A4.type==="Edge"){A4.unHoverHighlight();}}},clearSelection:function(){var A3=this.selectedSprites,A1=A3.length,A2,A4;for(A2=0;A2<A1;A2++){A4=A3[A2];A4.selectionState.selected=false;A4.unHighlight();}this.selectedSprites=[];},addToSelection:function(A2){var A1=this.selectedSprites;if(A1.indexOf(A2)===-1){A2.selectionState.selected=true;A2.highlight();A1.push(A2);}},clearContextMenuSelection:function(){var A2=this.contextMenuSelection,A1=A2.length,A3,A4;for(A3=0;A3<A1;A3++){A4=A2[A3];if(!A4.selectionState.selected){A4.unHighlight();}else{A4.highlight();}}this.contextMenuSelection=[];},clearContextMenuSelectionHighLight:function(){var A2=this.contextMenuSelection,A1=A2.length,A3,A4;for(A3=0;A3<A1;A3++){A4=A2[A3];if(!A4.selectionState.selected){A4.unHighlight();}else{A4.highlight();}}this.contextMenuSelectionHighLight=false;},cloneSelectionToContextMenuSelection:function(){var A2,A1,A3,A4;this.contextMenuSelection=this.selectedSprites.slice(0);A2=this.contextMenuSelection;A1=A2.length;for(A3=0;A3<A1;A3++){A4=A2[A3];A4.highlight();}},addSpriteToContextMenuSelection:function(A2){var A1=this.contextMenuSelection;if(A1.indexOf(A2)===-1){A2.highlight();A1.push(A2);}},IsInContextMenuSelectionIndex:function(A1){return this.contextMenuSelection.indexOf(A1)!==-1;},removeFromSelection:function(A3){var A2=this.selectedSprites,A1=A2.indexOf(A3);if(A1!==-1){A3.selectionState.selected=false;A3.unHighlight();A2.splice(A1,1);}},onclick:function(){},onmousedown:function(A1){A1=A1.e||A1;if(this.eventHasBeenHandled||this.transitionTimer||(this.lassoSelector!==A1.target&&this.canvases.indexOf(A1.target)===-1)){return ;}if(this.dragMode===Ah.select){this.lassoSelectorEnabled=true;}this._isMouseDown=true;this._lastMousePosition={x:A1.pageX,y:A1.pageY};if(this._isEdgeHovered){delete this._isEdgeHovered;this._isEdgeMouseDown=true;}},onmousemove:function(A6){A6=A6.e||A6;if(this.eventHasBeenHandled||this.transitionTimer||!this._isMouseDown){return ;}var A3=this._lastMousePosition,A5={x:A6.pageX,y:A6.pageY},A2=A5.x-A3.x,A1=A5.y-A3.y;if(!this._isDragged){if(A2||A1){this._isDragged=true;if(this._isEdgeMouseDown){this._pendingRefresh=true;delete this._isEdgeMouseDown;}}}if(this.dragMode===Ah.pan&&A6.button===0){var A4=this.sceneInformation.position;A4.x+=A2;A4.y+=A1;this.applyScaleAndPosition();this.draw(false);}this._lastMousePosition=A5;},onmouseup:function(A3){var A6=A3.e||A3,A1=this.owner,A5=[],A4,A2=this.circleMenuOnCloseFlag,A7=A6.ctrlKey||A6.metaKey;if(this.eventHasBeenHandled||this.transitionTimer||!this._isMouseDown){return ;}A4=this.contextMenuSelection.length;this.clearContextMenuSelection();if(!this._isDragged){if((Aw(A6)===2)===false&&A2===false&&A7===false){A5=(this.selectedSprites||[]).filter(this.isClearAllEnabled,this);A5.forEach(function(A8){if(this.isClearAllEnabled(A8)){this.removeFromSelection(A8);}},this);}}if(A5.length>0||A4>0){if(A5.length>0){A1.doSelection();}if(A4>0){A1.doSelection(undefined,true);}this.draw(false);}delete this._isMouseDown;delete this._lastMousePosition;delete this._isDragged;delete this._isEdgeMouseDown;this.circleMenuOnCloseFlag=false;},oncontextmenu:function AV(A9){if(mstrApp.isInVFInteractMode){U(A9);return false;}var A7=A9.e||A9,A1=A7.target||A7.srcElement,A6=this.lassoSelector;Ae.stopPropogation(window,A7);Ae.preventDefault(window,A7);if(this.eventHasBeenHandled||this.transitionTimer){return ;}if(this.isOnFormattingMode){this.showContextMenu("background",this.observableModel.background,A7);}else{var A2=this.owner,A3=this;if(A1===A6){var A8=[],A5,A4;A3.clearContextMenuSelection();A3.cloneSelectionToContextMenuSelection();A8=A3.contextMenuSelection;A5=A8.length;if(A5>0){A3.contextMenuSelectionHighLight=true;A2.doSelection(undefined,true);for(A4=0;A4<A5;A4++){A8[A4].drawStage(false,true);}A2.showSelectionMenu(A7,function(){V.call(A3,A7);AR.selectPropertyPanel(A2,"de");},true);}}else{if(!Ae.contains(this.scaleBar.domNode,A1,true)){A2.showBlankSpaceMenu(A7,function(){A3.showContextMenu("background",A3.observableModel.background,A7);AR.selectPropertyPanel(A3.owner,0);});}}}if(this._isMouseDown){delete this._selectionState;delete this._isMouseDown;delete this._lastMousePosition;delete this._dragged;}},getCircleSpriteItems:function(){var A1=[];J.forEach(this.spriteCollection,function(A2){if(A2.type==="Circle"){A1.push({n:A2.text,id:A2});}});return A1;},areaSelect:function(A2,A6){if(isNaN(A2.x0)||isNaN(A2.x1)||isNaN(A2.y0)||isNaN(A2.y1)){D("Invalid selection area.");return ;}var A8=this.spriteCollection,A1=A8.length,A4,A3,A5;if(!A6.ctrlKey){this.clearSelection();}for(A4=0;A4<A1;A4++){A3=A8[A4];if(A3.type==="Circle"){A5=A3.getGeometry();if((A5.x-A2.x0)*(A5.x-A2.x1)<=0&&(A5.y-A2.y0)*(A5.y-A2.y1)<=0){this.addToSelection(A3);}}}var A7=AW(this.baseCanvas,true);this._bubbleToolbarPos={pageX:A2.x0+A7.x,pageY:A2.y0+A7.y};this.draw(false);},enableTransition:function(A1){this.showTransition=true;if(isNaN(A1)){A1=AS;}this.transitionDuration=A1;},disableTransition:function(){this.showTransition=false;delete this.transitionDuration;var A3=this.spriteCollection,A1=A3.len,A2;for(A2=0;A2<A1;A2++){delete A3[A2].oldGeometry;delete A3[A2].newGeometry;}},getSpriteIndex:function Az(A3){var A1=this.spriteCollection,A2;for(A2=0;A1[A2];A2++){if(A3===A1[A2]){return A2;}}return null;},createSprite:function(A2){A2.stage=this;var A1=null;if(A2.type==="Circle"){A1=this.addDisposable(new AY(A2));}if(A2.type==="Edge"){A1=this.addDisposable(new s(A2));}return A1;},addSprite:function r(A2,A1){if(!isNaN(A1)){this.spriteCollection.splice(A1,0,A2);}else{this.spriteCollection.push(A2);}},clearSprites:function(){this.spriteCollection=[];},removeSprite:function(A2,A1){if(isNaN(A1)){A1=this.getInex(A2);}if(!isNaN(A1)){this.spriteCollection.splice(A1,1);}},attachEventListenerForSprites:function(A2,A1,A3){if(!A1.eventHandlers){A1.eventHandlers={};}var A4=A1.eventHandlers;A4["on"+A2]=A3;},removeEventListenerForSprites:function(A2,A1){var A3=A2.eventHandlers;if(A3){delete A3[A1];if(Object.keys(A3).length===0){delete A2.eventHandlers;}}},raiseEventForSprites:function(A7){if(this.eventHasBeenHandled){return ;}var A8=A7.name;if(A8){var A3=[];J.forEach(this.layers,function(BB){var BA=[];A3.push(BA);J.forEach(BB,function(BC){BA.push(BC);});});var A6=A3.length,A4,A2,A5,A9,A1;for(A4=A6-1;A4>=0;A4--){A5=A3[A4];for(A2=0;A2<A5.length;A2++){A9=A5[A2];A1=A9.eventHandlers;if(A1&&A1["on"+A8]){A1["on"+A8].call(A9,A7);}if(this.eventHasBeenHandled){return ;}}}}},mainRect:null,setScene:function(){function BA(BY,BX,BW){function BZ(Bb,Ba){return AR.isNearZero(Bb.x-Ba.x)&&AR.isNearZero(Bb.y-Ba.y);}var BU=["x","y"].map(function BV(Bc){var Ba=(BY[Bc]-2*BW[Bc]+BX[Bc]),Bb=AR.isNearZero(Ba)?1:(BY[Bc]-BW[Bc])/Ba;if(Bb<0||Bb>=1){return BX;}return g(Bb,BY,BW,BX);}).filter(function(Ba){return !(BZ(Ba,BY)||BZ(Ba,BX));}),BT=BU.length;if(BT===2&&BZ.apply(undefined,BU)){BU.pop();BT=1;}if(BT===0){return BX;}else{return BU[0];}}this.sceneInformation={};this.scaleFactor=1;var BF=this.mainRect||{x:0,y:0,w:this.width,h:this.height},A2,BI,BG,BE=[],BB=null,BN=null,BR=Q.NETWORK_CIRCLE_BORDER_WIDTH,BO=4,BM=Infinity,A5=this.showEdgeDirection,BH=Math.max,BD=Math.min,A3=Math.ceil,A6=Math.pow,BQ=Math.sqrt,BJ,A1,BS,BL,BC;A2=this.spriteCollection||[];J.forEach(A2,function(BW){var Ba,BZ,BY,BU,BT,BX,BV;if(BW.isExcluded){return ;}Ba=BW.getGeometry();if(BW.type==="Circle"){BZ=Ba.s+BR;BY=Ba;BE.push(BW);}else{BZ=BH(A3(Ba.s/2),BO);if(A5){BC=BW.getEndPoint().pos;}else{BC=BW.to.getGeometry();}BY=BA(BW.from.getGeometry(),BC,Ba);}BU=BY.x-BZ;BT=BY.x+BZ;BX=BY.y-BZ;BV=BY.y+BZ;if(!BB){BB={x1:BU,x2:BT,y1:BX,y2:BV};}else{BB.x1=BD(BB.x1,BU);BB.x2=BH(BB.x2,BT);BB.y1=BD(BB.y1,BX);BB.y2=BH(BB.y2,BV);}if(!BN){BN={x1:BY.x,x2:BY.x,y1:BY.y,y2:BY.y};}else{BN.x1=BD(BN.x1,BY.x);BN.x2=BH(BN.x2,BY.x);BN.y1=BD(BN.y1,BY.y);BN.y2=BH(BN.y2,BY.y);}});if(!BB){BB={x1:0,x2:0,y1:0,y2:0};BN={x1:0,x2:0,y1:0,y2:0};}this.sceneInformation.position={x:0,y:0};var A7={left:BN.x1-BB.x1,top:BN.y1-BB.y1,bottom:BB.y2-BN.y2,right:BB.x2-BN.x2},BK,A4,BP;if(AR.isNearZero(BN.x2-BN.x1)){BK=0;}else{BK=(BF.w-A7.left-A7.right)/(BN.x2-BN.x1);}if(AR.isNearZero(BN.y2-BN.y1)){A4=0;}else{A4=(BF.h-A7.top-A7.bottom)/(BN.y2-BN.y1);}if(BK===0&&A4!==0){BP=A4;}else{if(A4===0&&BK!==0){BP=BK;}else{BP=BD(BK,A4);}}if(Math.abs(BP)===Infinity){return ;}var A9=(BF.w-(BN.x2-BN.x1)*BP-A7.left-A7.right)/2+A7.left,A8=(BF.h-(BN.y2-BN.y1)*BP-A7.top-A7.bottom)/2+A7.top;J.forEach(A2,function(BU){var BV=BU.getGeometry(),BT=BV.x,BW=BV.y;BT-=BN.x1;BT*=BP;BV.x=BT+BF.x+A9;BW-=BN.y1;BW*=BP;BV.y=BW+BF.y+A8;BU.setGeometry(BV);});if(this.currentLayout===i.CIRCULAR){this.graphCenter={x:BF.w/2+BF.x,y:BF.h/2+BF.y};}for(BI=0,BJ=BE.length;BI<BJ;BI++){A1=BE[BI].getGeometry();for(BG=BI+1;BG<BJ;BG++){BS=BE[BG].getGeometry();BL=BQ(A6(A1.x-BS.x,2)+A6(A1.y-BS.y,2));if(BL>2){BM=BD(BM,BL/(A1.s+BS.s));}}}if(BM<1){J.forEach(A2,function(BT){BT.setGeometry({s:BT.getGeometry().s*BM});});}},resetScene:function(){if(this.sceneInformation){this.sceneInformation.position={x:0,y:0};}this.setScene();},scale:function(A1){if(!this.sceneInformation){this.sceneInformation={size:{width:this.width,height:this.height},position:{x:0,y:0}};}this.scaleFactor=A1;this.applyScaleAndPosition();this.draw(false);},findForceDirectedGraphCenter:function(A2){var A7=this.spriteCollection,A3={x:0,y:0},A4=0,A5,A6,BC,BB,BA,A8,A9={x:0,y:0},A1={};for(A5=0,A6=A7.length;A5!==A6;A5++){BC=A7[A5];if(BC instanceof s){BB=BC.from;BA=BC.to;if(BB===A2&&!A1.hasOwnProperty(BA.id)){A8=BA.position;A4++;A1[BA.id]=true;}else{if(BA===A2&&!A1.hasOwnProperty(BB.id)){A8=BB.position;A4++;A1[BB.id]=true;}else{A8=A9;}}A3.x+=A8.x;A3.y+=A8.y;}}A3.x/=A4;A3.y/=A4;return A3;},findLinearLayoutGraphCenter:function(A1){var A6=this.spriteCollection,A2=A1.position,A8=0,A4,A5,A9,A7,A3;for(A4=0,A5=A6.length;A4!==A5;A4++){A9=A6[A4];if(A9 instanceof s){if(A9.from===A9.to){continue;}A7=A9.controlPoint;if(A7.y<A2.y){A8++;}else{A8--;}}}if(A8>=0){A3={x:A2.x,y:0};}else{A3={x:A2.x,y:2*A2.y};}return A3;},getDataLabelFormats:function(){var A1=this.circleLabelStyle;return{color:k.getCSSColorString(A1.fontColor.fill.value),font:W(A1),"text-decoration":y(A1.fontStyle)};},execFormatHandler:function(){var A1=this.selectedSprites;if(A1&&A1.length>0){S.call(this,this._bubbleToolbarPos);AR.selectPropertyPanel(this.owner,"de");}else{AR.selectPropertyPanel(this.owner,0);}},isClearAllEnabled:function(A1){return this.owner.isClearAllEnabled(A1.unit);}});}());(function(){mstrmojo.requiresCls("mstrmojo.VisBase","mstrmojo.DocPortlet");var L={top:"top",left:"left","z-index":"zIndex",width:"width",height:"height"},P,B;mstrmojo.Vis=mstrmojo.declare(mstrmojo.VisBase,null,{scriptClass:"mstrmojo.Vis",offsetTop:0,offsetLeft:0,isAndroid:window.navigator.userAgent.indexOf("Android")!=-1,reRenderOnDimensionChg:true,isVis:function(){return true;},setModel:function Q(R){this._super(R);if(R.data){this.set("model",R.data);}this.xtabModel=R;if(this.controller&&typeof (this.controller.getPageByTree)!="undefined"){this.controller.getPageByTree(false);}},destroy:function O(){this._super();var R=this.xtabModel;if(R&&R.destroy){R.destroy();delete this.xtabModel;}},setDimensions:function N(U,S){var R=this._super(U,S);if(R&&this.hasRendered&&this.reRenderOnDimensionChg){this.reRender();}return R;},buildRendering:function M(){if(this.parent instanceof mstrmojo.DocPortlet){delete this.left;delete this.top;this.height=this.fmts&&this.fmts.height;}this._super();},postBuildRendering:function G(){P=this.width;B=this.height;this.adjustWidgetOffsets();this._super();},adjustWidgetOffsets:function E(){var R=mstrmojo.boxmodel.offset(this.domNode);this.offsetTop=R.top;this.offsetLeft=R.left;},update:function F(W){W=W||this.node;if(W){if(W.data){this.set("model",W.data);if(this.xtabModel&&this.xtabModel.set){this.xtabModel.set("data",W.data);}this.model=W.data;if(this.model.layoutModel){this.layoutModel=this.model.layoutModel;}if(this.model.layoutNode){this.layoutNode=this.model.layoutNode;}mstrmojo.hash.copy(W.data.extProps,this);}var U=this.controller,S=U.view,Y=(S.hasRendered&&S.getCurrentLayout&&S.getCurrentLayout());if(U.view.fullScreenInfoWindow&&(Y&&Y.defn.visName)){var X=mstrApp.rootView.getContentDimensions();this.height=X.h+"px";this.width=X.w+"px";}else{this.fmts=W.defn.fmts||W.defn.units[this.model.k].fmts;var R=this.fmts;if(R){for(var V in L){v=L[V];if(V in R){this[v]=R[V];}}}}}if(this.model){this.initFromVisProps(this.model.vp);}this.updated=true;return true;},getModel:function A(S){if(S){var R=mstrmojo.Vis.getVisGrid(this.layoutModel,this.layoutNode,S);if(R){return R.data;}else{alert(mstrmojo.desc(8427,"Incorrect visualization properties encountered.  Data may be inconsistent.  Please reset your properties."));return{};}}else{return this.model;}},getDataParser:function K(R){return new mstrmojo.Vis.DataParser(this.getModel(R));},renderErrorMessage:function H(R){this.domNode.innerHTML='<div class="mstrmojo-message">'+R+"</div>";},getMessageID:function J(){return this.model.mid&&this.model.mid||this.xtabModel&&this.xtabModel.docModel&&this.xtabModel.docModel.mid;},hasNoninfowindowTarget:function D(V){var c=this.xtabModel,b=(c&&c.docModel);var d=false;if(b){var a=b.defn&&b.defn.layouts,U=null;var S;if(a){for(S in a){if(a[S].loaded){U=a[S];break;}}}var W=U&&U.units;this.selectorTargets={};if(W&&V.scObjList){for(var S=0;S<V.scObjList.length;S++){var X=V.scObjList[S];var Y=X.sc.tks.split("\x1E");for(var R=0;R<Y.length;R++){var Z=W[Y[R]];if(Z){this.selectorTargets[Y[R]]=Z;if(!this.isChildOfIfw(W,Z)){d=true;}}}}}}return d;},isChildOfIfw:function I(R,S){while(S){if(S.ifw){return true;}S=R[S.pnk];}return false;},performAction:function C(R){var U=this.xtabModel.getAction(R),S=U&&U.h;if(S&&this.controller[S]){this.controller[S](this,U.a);return true;}return false;}});mstrmojo.Vis.getVisGrid=function(R,Z,S){var X=Z;var V=R.getChildren(Z,false);for(var U=0;U<V.length;U++){var Y=V[U];if(Y.k==S){return Y;}else{var W=mstrmojo.Vis.getVisGrid(R,Y,S);if(W){Z=X;return W;}}}};mstrmojo.Vis.DataParser=function(U){var b=mstrmojo.Vis;return{getRowTitles:function(){return new b.Titles(U,true);},getColTitles:function(){return new b.Titles(U,false);},findMetricValue:function(g,l){var k=U.ghs.rhs.items;for(var h in k){var j=k[h].items;var f=true;for(var d in g){if(g[d]!=j[d].idx){f=false;break;}}if(f){return new mstrmojo.Vis.MetricValue(U.gvs.items[h].items[l]);}}},getTotalRows:function X(){var c=U.ghs&&U.ghs.rhs&&U.ghs.rhs.items;return(U.eg||!c)?0:c.length;},getTotalColHeaderRows:function V(){return(!U.ghs.chs.items?0:U.ghs.chs.items.length);},getTotalCols:function R(){return this.getColHeaders(0).size();},getRowHeaders:function a(c){return new b.Headers(U,c,true);},getColHeaders:function Z(c){return new b.Headers(U,c,false);},getMetricValue:function Y(d,c){return new b.MetricValue(U,U.gvs.items[d].items[c]);},getColumnHeaderCount:function W(){return U.gvs.items[0].items.length;},getCSSString:function S(){return U.cssString;}};};mstrmojo.Vis.Titles=function(R,X){var W=(X)?R.gts.row:R.gts.col;return{size:function V(){return W.length;},getTitle:function U(Y){return new mstrmojo.Vis.Title(W[Y]);},getCSS:function S(Y){return R.css[W[Y].cni].n;}};};mstrmojo.Vis.Headers=function(S,U,Y){var Z=(Y)?S.gts.row:S.gts.col;var X=(Y)?S.ghs.rhs:S.ghs.chs;var V=X.items&&X.items[U].items;return{size:function a(){return(!V?0:V.length);},getHeader:function R(b){return V&&V[b]&&new mstrmojo.Vis.Header(V[b],Y?Z[b]:Z[U]);},getCSS:function W(b){return V&&S.css[V[b].cni].n;},getHeaderCell:function(b){return V&&V[b];}};};mstrmojo.Vis.Title=function(S){return{getActionType:function(){return S.at;},getDrillPath:function(){return S.dp;},getHeaderValues:function R(){return S.es;},getHeaderName:function U(W){return S.es[W].n;},getHeaderId:function U(W){return S.es[W].id;},getForms:function V(){return S.fs;},getFormId:function(){return S.fid;},getFormType:function(){return S.ftp;},getUnitId:function(){return S.id;},getLinkMap:function(){return S.lm;},getName:function(){return S.n;},getUnitDssType:function(){return S.otp;},getSelectorControl:function(){return S.sc;}};};mstrmojo.Vis.Header=function(U,R){return{getName:function W(){return(U.idx===-1)?"":R.es[U.idx].n;},getElementId:function Z(){return(U.idx===-1)?"":R.es[U.idx].id;},getObjectId:function V(){return(U.idx===-1)?"":R.es[U.idx].oid;},getElementIndex:function S(){return U.idx;},getActionType:function Y(){return U.at;},isTotal:function X(){return U.otr===1;}};};mstrmojo.Vis.MetricValue=function(R,Z){var Y=Z;return{getValue:function S(){return Y.v;},getThresholdType:function U(){return Y.ty;},getRawValue:function X(){return Y.rv;},getCSS:function V(){return R.css[Y.cni].n;},getThresholdValue:function a(b){if(Y.ti==undefined){return b;}return R.th[Y.ti].n;},getFillColor:function W(b){if(Y.ci==undefined){return b;}return R.fc[Y.ci].n;}};};})();(function(){mstrmojo.requiresCls("mstrmojo.dom","mstrmojo.gm.DndTooltip","mstrmojo.VisUtility","mstrmojo.vi.models.EnumDragSources");var N=mstrmojo,I=N.dom,K=N.VisUtility,C=N.vi.models.EnumDragSources,J=N.array;mstrmojo.gm._SupportDndAsBlackBox=mstrmojo.provide("mstrmojo.gm._SupportDndAsBlackBox",{_mixinName:"mstrmojo.gm._SupportDndAsBlackBox",mainContainerNode:"domNode",handleDndForParentNode:true,dndAsBlackBox:true,allowDrop:function H(R){var S=R.src.data,Q=S&&S.src;if(Q===C.DATASETS||Q===C.VIZ_EDITOR||Q===C.VIZ||Q===C.ALL_OBJECT_LIST){return true;}return false;},cleanUpAfterTarget:function E(Q){this._super(Q);if(this.domNode.contains(this.dndHighlightCanvas)){this.domNode.removeChild(this.dndHighlightCanvas);}delete this.dndHighlightCanvas;if(this.dndTooltip){this.dndTooltip.destroy();}delete this.dndTooltip;},ondragenter:function M(R){if(this._super){this._super(R);}var X=this.isEmpty();if(X&&!this.excludeData){R.tgt.widget=this;this.raiseEvent({name:"toggleCtrlOverlay",visible:false,controls:this.getVisEmptyMsgControls()});}var W;if(!this.dndHighlightCanvas){var Q=document.createElement("canvas"),V=I.position(this.domNode),U=I.position(this[this.mainContainerNode]);this.domNode.appendChild(Q);Q.style.position="absolute";Q.style.zIndex=1000;Q.width=U.w||V.w;Q.height=U.h||V.h;Q.style.top=(U.y-V.y)+"px";Q.style.left=(U.x-V.x)+"px";this.dndHighlightCanvas=Q;}if(!this.dndTooltip){W=document.createElement("div");document.body.appendChild(W);var S={placeholder:W,contentNodeCssClass:"gm-dnd-replace-node-tooltip",boundary:document.body};this.dndTooltip=new mstrmojo.gm.DndTooltip(S);this.dndTooltip.render();this.dndTooltip.parent=this;}this.ondragover(R);},ondragover:function B(Q){if(this._super){this._super(Q);}if(this.dndAsBlackBox){this.clearHighlightDropZoneOnGraph();this.drawBlackBoxHighlight(Q);}},ondragleave:function P(Q){var R=this.isEmpty();if(R){this.raiseEvent({name:"toggleCtrlOverlay",visible:true,controls:this.getVisEmptyMsgControls()});}if(this._super){this._super(Q);}},ondrop:function L(R){if(this._super){this._super(R);}if(this.dndAsBlackBox){var V=this.zonesModel,U=R.src.data,Q=U.items,S=R.getCtxtDragData().src;this.getDocModel().selectVIUnit(this.parent.id);V.addUnitsFromDataSource(Q,U.dsid,R.actions,S===C.ALL_OBJECT_LIST?R.callback:null);}},clearHighlightDropZoneOnGraph:function G(){var R=this.dndHighlightCanvas,Q=R.getContext("2d");Q.clearRect(0,0,R.width,R.height);this.dndTooltip.toggle(false);},isMetric:function O(Q){return Q&&Q.t===4;},isAttrCategory:function D(Q){return Q&&(Q.t===12||Q.t===1||Q.t===47);},singleTypeObject:function F(Q){var U=0,S=0,R=this;J.forEach(Q.src.data.items,function(V){if(R.isAttrCategory(V)){U++;}else{if(R.isMetric(V)){S++;}}});return !(U>0&&S>0);},drawBlackBoxHighlight:function A(S){var U=this.dndHighlightCanvas,b=U.getContext("2d"),Y=I.position(this[this.mainContainerNode]),Q=I.position(this.domNode),R=Y.w||Q.w,a=Y.h||Q.h,X=Math.min(30,0.25*R),c=Math.min(30,0.25*a);b.save();b.beginPath();b.rect(X,c,R-2*X,a-2*c);b.fillStyle="#bce8ff";b.globalAlpha=0.4;b.fill();b.strokeStyle="#34abeb";b.globalAlpha=1;K.drawDashLine(b,X,c,X,a-c,2,2);K.drawDashLine(b,X,c,R-X,c,2,2);K.drawDashLine(b,R-X,c,R-X,a-c,2,2);K.drawDashLine(b,X,a-c,R-X,a-c,2,2);b.restore();if(!this.singleTypeObject(S)){var V=this.dndTooltip,Z={x:S.tgt.e.x,y:S.tgt.e.y,w:0,h:0},W=S.src.widget.avatar;if(W){Z=I.position(W);}V.placementOrder=[V.PLACEMENT_ABOVE];V.popupNodeOffset=5;V.updateContent(null,Z,"Add Attributes and Metrics");}}});}());(function(){mstrmojo.requiresCls("mstrmojo.array","mstrmojo.hash","mstrmojo.num","mstrmojo.VisEnum","mstrmojo.VisUtility","mstrmojo.gm.GMEnums","mstrmojo.color","mstrmojo.chart","mstrmojo.chart.common.Utility");mstrmojo.requiresClsP("mstrmojo.chart.enums","EnumGraphMajorType");mstrmojo.requiresClsP("mstrmojo.chart.model.enums","EnumDSSGraphObject");var o=mstrmojo,B=o.css,p=mstrmojo.array,Q=mstrmojo.hash,I=mstrmojo.num,H=mstrmojo.VisUtility,c=mstrmojo.chart,L=c.enums,d=L.EnumGraphMajorType,K=c.common.Utility,V=c.model,N=V.enums,x=N.EnumDSSGraphObject,AB=mstrmojo.VisEnum.ControlType,y=o.gm,W=mstrmojo.gm.EnumTextAlignH,r=mstrmojo.gm.EnumTextAlignV,w=";",k=",",A="_tmsp",M=" ",a=-20,l=mstrmojo.gm.EnumSelectionOptionLevel,AD=mstrmojo.gm.EnumShape,h=mstrmojo.color,J=mstrmojo.gm.EnumIdentityType,S=0.00001,E,b=Math.pow(2,30),e=Math.pow(2,60);var g=["Reserved",mstrmojo.desc(2125,"Maximum"),mstrmojo.desc(2127,"Minimum"),mstrmojo.desc(2122,"Average"),mstrmojo.desc(2126,"Median"),mstrmojo.desc(4046,"First"),mstrmojo.desc(4049,"Last"),mstrmojo.desc(7194,"Constant")];function m(AJ,AI){var AK,AH=AJ.length;if(AH!==AI.length){return false;}for(AK=0;AK<AH;AK++){if(AJ[AK]!==AI[AK]){return false;}}return true;}function AC(AK,AI,AL){var AJ=false,AM=AL+A,AH=AK[AM],AN=AI[AM];if(AI[AL]===undefined){AJ=true;}else{if((AN===undefined&&AH!==undefined)||(AN!==undefined&&AH!==undefined&&AN<AH)){AJ=true;}}if(AJ){AI[AL]=AK[AL];if(AN!==undefined){AI[AM]=AH;}}}function AG(AI,AH){var AJ;for(AJ in AI){if(AI.hasOwnProperty(AJ)){AC(AI,AH,AJ);}}return AH;}function Y(AL){var AK={},AJ,AI=[],AH;p.forEach(AL,function(AM){if(AM!==undefined){AI.push(AM);}});AH=AI.length;if(AH===1){return AI[0];}for(AJ=0;AJ<AH;AJ++){AG(AI[AJ],AK);}return AK;}function AA(AH){return{n:AH,s:AH.toString(),on:AH};}function Z(AJ,AH,AL){if(AH===AJ){return 0;}var AI=AH-AJ,AK=1;while(AI<1){AI*=10;AK/=10;}while(AI>=10){AI/=10;AK*=10;}if(AI<1.8){AK*=0.2;}else{if(AI<3.1){AK*=0.4;}else{if(AI<4.6){AK*=0.5;}else{if(AI>=8.1){AK*=2;}}}}if(AL){AK=Math.round(AK);if(AK<1){AK=1;}}return AK;}function C(AK,AO,AQ,AI){var AM=[];if(AK===AO){if(AK<0){AM.push(mstrmojo.gm.GMUtility.formatNumber(AK,"nearest"));}AM.push({n:0,s:"0",on:0});if(AK>0){AM.push(mstrmojo.gm.GMUtility.formatNumber(AK,"nearest"));}return AM;}var AH=AI>0?AI:Z(AK,AO,AQ);var AJ=Math.ceil(AO/AH)*AH;if(AJ-AO>=AH*0.9){AJ=Math.floor(AO/AH)*AH;}var AN=Math.floor(AK/AH)*AH;if(AK-AN>=AH*0.9){AN=Math.ceil(AK/AH)*AH;}var AP=Math.floor((AJ-AN+AH/100)/AH)+1,AL;for(AL=0;AL<AP;++AL){AM.push(mstrmojo.gm.GMUtility.formatNumber(AN+AL*AH,"nearest"));}return AM;}function U(AH,AK){var AJ;AH.mMaxTick=1;if(this.mChartContextPtr.mIsGraphMatrix){AH.mStep=this.mMinimum<0?0.2:0.1;if(AK.mUseCustomMinMax){var AI=AK;AH.mMaxTick=AI.mAxisMaxValue;AH.mMinTick=AI.mAxisMinValue;AH.mMaxTick=Math.min(1,AH.mMaxTick);AH.mMinTick=Math.max(-1,AH.mMinTick);AH.mStep=0.1;}else{if(this.mMaximum>=0.5){AH.mMaxTick=1;AH.mMinTick=Math.floor(this.mMinimum/AH.mStep)*AH.mStep;AH.mMinTick=(AH.mMinTick*this.mMinimum<0)?0:(AH.mMinTick>0?0:AH.mMinTick);if(this.mMinimum<-0.5){AH.mMinTick=-1;}}else{if(this.mMaximum>0){AH.mMaxTick=Math.ceil(this.mMaximum/AH.mStep)*AH.mStep;AH.mMinTick=-1;}else{AH.mStep=0.1;AH.mMaxTick=0;AH.mMinTick=-1;}}}}else{AH.mMinTick=(this.mMinimum<0)?-1:0;if(u.call(this,AH)){return ;}AH.mStep=this.mMajorGrid.mUseManualGrid?this.mMajorGrid.mGridInterval:(AH.mMaxTick-AH.mMinTick)/10;}for(AJ=AH.mMinTick+AH.mStep;AJ+c.gModuleMain.mTolerance<AH.mMaxTick;AJ+=AH.mStep){AH.mTicks.push(Math.round(AJ*100)/100);}}function P(AH,AM){var AL,AI,AO=AM,AN=AO.mDrawCustomLine,AJ=AO.mAxisCustomValue,AK;AH.mStep=1;if(this.mMaximum<=0){AH.mMinTick=1;AH.mMaxTick=10;if(AN&&AJ<=1){AO.mAxisCustomValue=AH.mMinTick;}return ;}if(this.mMinimum<=0){AI=this.mMaximum>1?0:-1;AH.mMinTick=Math.pow(10,AI);if(AO.mUseCustomMinMax){AH.mMaxTick=this.mMaximum;AL=Math.floor(i.call(this,this.mMaximum));if(i.call(this,this.mMaximum)===AL){AL--;}}else{AL=Math.ceil(i.call(this,this.mMaximum));AH.mMaxTick=Math.pow(10,AL);}for(AK=AI+1;AK<AL;++AK){AH.mTicks.push(Math.pow(10,Math.floor(AK)));}if(AN&&AJ<=0){AO.mAxisCustomValue=Math.max(AH.mMinTick,AO.mAxisCustomValue);}return ;}if(AO.mUseCustomMinMax){AL=i.call(this,this.mMaximum);AI=i.call(this,this.mMinimum);AH.mMaxTick=this.mMaximum;AH.mMinTick=this.mMinimum;}else{AL=Math.ceil(i.call(this,this.mMaximum));AI=Math.floor(i.call(this,this.mMinimum));AH.mMaxTick=Math.pow(10,AL);AH.mMinTick=Math.pow(10,AI);}for(AK=AI+1;AK<AL;++AK){AH.mTicks.push(Math.pow(10,Math.floor(AK)));}if(AN&&AJ<=0){AO.mAxisCustomValue=AH.mMinTick;}}function s(AR,AM){var AJ=AM,AH,AK;AR.mStep=f.call(this,this.mMaximum,this.mMinimum,AJ.mAlwaysIncludeZero);AR.mMaxTick=Math.ceil(this.mMaximum/AR.mStep)*AR.mStep;AR.mMinTick=Math.floor(this.mMinimum/AR.mStep)*AR.mStep;AR.mMaxTick=AR.mMaxTick<this.mMaxmum?this.mMaxmum:AR.mMaxTick;AR.mMinTick=AR.mMinTick>this.mMinimum?this.mMinimum:AR.mMinTick;AR.mMinTick=(AR.mMinTick*this.mMinimum<0)?0:AR.mMinTick;if(AJ.mAlwaysIncludeZero){AR.mMaxTick=(this.mMaximum<0)?0:AR.mMaxTick;AR.mMinTick=(this.mMinimum>0)?0:AR.mMinTick;}var AL=AR.mMaxTick-AR.mMinTick;if(AR.mStep>=AL){return ;}if(u.call(this,AR)){return ;}AH=Math.floor((AR.mMaxTick-AR.mMinTick+AR.mStep/100)/AR.mStep)+1;var AN=this.mNumberFormat;for(AK=1;AK<AH-1;++AK){var AP=AR.mMinTick+AK*AR.mStep,AQ,AI,AO;if(AR.mStep<1&&AN.mFormatType===4&&AN.mCustomFormat.indexOf("%")!==-1){AQ=AP*100;if(!K.isIntegar(AQ)){AI=Math.round(AQ);AO=Math.abs(AQ-AI);if(AO<S){AP=AI/100;}}}AR.mTicks.push(AP);}}function D(AR,AL){var AQ=AL,AK,AH,AO,AJ,AN,AM,AI,AP;AR.mMaxTick=AQ.mAxisMaxValue;AR.mMinTick=AQ.mAxisMinValue;if(u.call(this,AR)){return ;}if(!X.call(this)||this.mMajorGrid.mUseManualGrid){AR.mStep=f.call(this,AR.mMaxTick,AR.mMinTick,false);AK=AR.mMaxTick-AR.mMinTick;if(AR.mStep>=AK){return ;}AH=Math.floor(AK/AR.mStep);if(!(this.mChartContextPtr.mIsTimeSeriesChart)&&AK===AH*AR.mStep){for(AJ=1;AJ<AH;++AJ){AR.mTicks.push(AR.mMinTick+AJ*AR.mStep);}}else{AK=AR.mMaxTick-AR.mMinTick;AO=10;AN=false;for(AJ=3;AJ<AH;++AJ){AM=AK/AJ;while(AM<1){AM*=10;}while(AM>=10){AM/=10;}if(AM===Math.floor(AM)){AO=AJ;AN=true;break;}}if(AN){AR.mStep=AK/AO;for(AJ=1;AJ<AO;++AJ){AR.mTicks.push(AR.mMinTick+AJ*AR.mStep);}}else{AI=Math.ceil((AR.mMinTick+AR.mStep/100)/AR.mStep)*AR.mStep;AP=Math.floor((AR.mMaxTick-AR.mStep/100-AI)/AR.mStep)+3;for(AJ=0;AJ<AP-2;++AJ){AR.mTicks.push(AI+AJ*AR.mStep);}}}}else{AK=AR.mMaxTick-AR.mMinTick;AO=10;for(AJ=6;AJ<=9;++AJ){AM=AK/AJ;while(AM<10){AM*=10;}while(AM>=100){AM/=10;}if(AM===Math.floor(AM)){AO=AJ;break;}}AR.mStep=AK/AO;for(AJ=1;AJ<AO;++AJ){AR.mTicks.push(AR.mMinTick+AJ*AR.mStep);}}}function F(AH,AL){var AK,AI,AJ;AH.mMaxTick=AL.mAxisMaxValue;if(AH.mMaxTick<=this.mMinimum){this.mMinimum=AH.mMaxTick-1;}AH.mStep=f.call(this,AH.mMaxTick,this.mMinimum,AL.mAlwaysIncludeZero&&(AH.mMaxTick>0));AK=(AL.mAlwaysIncludeZero&&(this.mMinimum>0))?0:this.mMinimum;if(X.call(this)){AH.mMinTick=AH.mMaxTick-Math.ceil((AH.mMaxTick-AK)/AH.mStep)*AH.mStep;}else{AH.mMinTick=Math.floor(AK/AH.mStep)*AH.mStep;}if(u.call(this,AH)){return ;}AI=Math.floor((AH.mMaxTick-AH.mStep/100-AH.mMinTick)/AH.mStep)+2;for(AJ=1;AJ<AI-1;++AJ){AH.mTicks.push(AH.mMinTick+AJ*AH.mStep);}}function j(AH,AM){var AI,AL,AJ,AK;AH.mMinTick=AM.mAxisMinValue;if(AH.mMinTick>=this.mMaximum){this.mMaximum=AH.mMinTick+1;}AH.mStep=f.call(this,this.mMaximum,AH.mMinTick,AM.mAlwaysIncludeZero&&(AH.mMinTick<0));AI=(AM.mAlwaysIncludeZero&&(this.mMaximum<0))?0:this.mMaximum;if(X.call(this)){AH.mMaxTick=AH.mMinTick+Math.ceil((AI-AH.mMinTick)/AH.mStep)*AH.mStep;}else{AH.mMaxTick=Math.ceil(AI/AH.mStep)*AH.mStep;}if(u.call(this,AH)){return ;}AL=Math.ceil((AH.mMinTick+AH.mStep/100)/AH.mStep)*AH.mStep;AJ=Math.floor((AH.mMaxTick-AL+AH.mStep/100)/AH.mStep)+2;for(AK=0;AK<AJ-2;++AK){AH.mTicks.push(AL+AK*AH.mStep);}}function f(AX,AR,AJ){var AQ,AL;if(this.mMajorGrid.mUseManualGrid){return this.mMajorGrid.mGridInterval;}AQ=0;if(AJ){AQ=Math.max(AX,AX-AR);AQ=Math.max(AQ,-AR);}else{AQ=AX-AR;}if(AQ===0){this.mIsShown=false;return 1;}if(AQ>=1&&AQ<=4&&parseInt(AQ)===AQ){var AY=this.PrimaryMetricIndex,AM=AY.length;for(var AT=0;AT<AM;AT++){var AP=this.mChartContextPtr.mDatasetPtr,AS=AP.dataProvider,AK=AS.getSeriesCount(),AO=AS.getGroupCount(),AI=AY[AT],AN,AV;for(var AW=0;AW<AK;AW++){AN=AS.getMetricIndexForSeries(AW);if(AN===AI){AV=true;for(var AU=0;AU<AO;AU++){var AZ=AP.GetData(AW,AU);if(parseInt(AZ)!==AZ){AV=false;break;}}}if(AV){return 1;}}}}var AH=AQ;AL=1;while(AQ<1){AQ*=10;AL/=10;}while(AQ>=10){AQ/=10;AL*=10;}if(AQ<1.8){AL*=2;AL/=10;}else{if(AQ<3.1){AL*=4;AL/=10;}else{if(AQ<4.6){AL*=5;AL/=10;}else{if(AQ>=8.1){AL*=2;}}}}AL=this.postProcessStep(AL,AH);return AL;}function u(AH){if(this.mChartContextPtr.mIsGraphMatrix){return false;}var AI=this.mMajorGrid;return AI.mUseManualGrid&&(AI.mGridInterval<(AH.mMaxTick-AH.mMinTick)/30);}function i(AH){return Math.log(AH)/Math.log(10);}function X(){return(this.mGraphMajorType===d.GMT_HISTOGRAM||this.mGraphMajorType===d.GMT_POLAR)&&this.mTripleId.mObjectId===x.DssGraphX1Body;}function z(AK){var AL=this,AH=AL.id,AJ=AK.metricId,AI=new o.ui.menus.MenuConfig();(AK.options).forEach(function(AM){if(AM!==y.EnumRefLineModelType.CONST){AI.addMenuItem(g[AM],"xt",function(){AL.toggleRefLineEnabled(AJ,AM,true);});}else{AI.addEditorMenuItem(g[y.EnumRefLineModelType.CONST],AH,function(){return new mstrmojo.ui.menus.EditorConfig({data:{},contents:[{scriptClass:"mstrmojo.ValidationTextBox",alias:"constVal",dtp:mstrmojo.expr.DTP.FLOAT,constraints:{trigger:mstrmojo.validation.TRIGGER.ONBLUR},onEnter:function(){this.validate();}}],fnOk:function(AO,AN){var AP=AN.constVal;if(AP.isValid()){AL.toggleRefLineEnabled(AJ,AM,true,AP.value);}}});});}});return AI;}function t(AJ){var AK=this,AI=AJ.metricId,AH=new o.ui.menus.MenuConfig();(AJ.options).forEach(function(AN){var AL=AN.refType,AM=g[AL]+((AL===y.EnumRefLineModelType.CONST)?("-["+I.toLocaleString(AN.c)+"]"):"");AH.addMenuItem(AM,"xt",function(){AK.toggleRefLineEnabled(AI,AL,false,0,AN.modix);});});return AH;}function AE(AL,AH){var AK=AL.GMController,AI=AK.getForbiddenShapeForMetric(AH),AJ=[];[{text:mstrmojo.desc(12097,"Bar"),value:AD.BAR},{text:mstrmojo.desc(2059,"Line"),value:AD.LINE},{text:mstrmojo.desc(9738,"Area"),value:AD.AREA},{text:mstrmojo.desc(12100,"Circle"),value:AD.CIRCLE},{text:mstrmojo.desc(12101,"Square"),value:AD.SQUARE},{text:mstrmojo.desc(12102,"Tick"),value:AD.TICK}].forEach(function(AM){if(AI.indexOf(AM.value)<0){AJ.push(AM);}});if(AK.chartType===mstrmojo.gm.EnumGraphType.BAR||AK.chartType===mstrmojo.gm.EnumGraphType.LINE){AJ=AJ.filter(function(AM){return AM.value!==AD.AREA;});}return AJ;}function q(AI,AH){return function(AK,AJ){if(AK!==AJ){AH({ctxt:{sp:AK,mid:AI}});}};}function AF(AK){var AI=AK.options,AH=this.getMenuHandler("changeShape"),AJ=new mstrmojo.ui.menus.MenuConfig();AJ.addRadioMenuGroup(AK.currValue,q(AK.metricId,AH),AI,"checkMark",undefined,true);return AJ;}mstrmojo.gm.GMUtility=mstrmojo.provide("mstrmojo.gm.GMUtility",{mTimers:[],mUseTimer:true,timerId:0,timerHistory:[],timerHistoryMax:50,startTimer:function R(AI){if(this.mUseTimer){var AH=this.timerId++;this.mTimers.push({timeStamp:new Date(),timerId:AH,desc:AI.functionName+": "+AI.purpose});return AH;}},endTimer:function G(AL,AN){if(this.mUseTimer){var AI,AJ=this.mTimers,AO=0;if(AL===undefined){AI=AJ.pop();}else{var AM,AP;for(AM=0;AM<AJ.length;AM++){AP=AJ[AM];if(AP.timerId===AL){AI=AP;AJ.splice(AM,1);AM--;}}}if(AI){var AH=new Date();var AK=(AH-AI.timeStamp);if(AN){this.timerHistory[this.timerId%this.timerHistoryMax]={desc:AI.desc,duration:AK,start:AI.timeStamp.getTime(),end:AH.getTime()};}H.visPrint("%c"+AI.desc+": "+AK+"ms","color: blue");AO=new Date()-AI.timeStamp;}return AO;}},computeTicksForPercentchart:function(AI,AH,AJ){return C(AI,AH,false,AJ);},computeTicksForFlexMinMax:function(AI,AH,AJ,AK){return C(AI,AH,AJ,AK);},formatNumber:function(AJ,AI,AH){return AA(AJ,AI,AH===undefined?3:AH);},sizeCalculator:{sum:function(AH,AL,AM){var AJ,AI=0,AK=0;if(AM===undefined){AM=AH.length;}AL=AL||1;for(AJ=0;AJ<AM;AJ++){if(AH[AJ]>0){AK+=AH[AJ];AI+=1;}}if(AI>1){AK+=(AI-1)*AL;}return AK;},add:function(AJ,AH,AI){AI=AI||1;if(AH>0){AJ+=(AH+AI);}return AJ;},minus:function(AJ,AH,AI){if(AH>0){AJ-=(AH+AI);}return AJ;}},replaceSpecialChars:function(AH){return AH.replace(/&/g,"&amp;").replace(/</g,"&lt;").replace(/>/g,"&gt;").replace(/"/g,"&quot;");},restoreSpecialChars:function(AH){return AH.replace(/&nbsp;/g," ").replace(/&lt;/g,"<").replace(/&gt;/g,">").replace(/&quot;/g,'"').replace(/&#039;/g,"'").replace(/&amp;/g,"&");},removeExtraSpace:function(AH){return AH.replace(/ {2,}/g," ");},stringToJSON:function(AH){if(AH===undefined){return undefined;}if(typeof AH==="string"){AH=AH.replace(/'/g,'"');try{return JSON.parse(AH);}catch(AI){return AH;}}return AH;},everythingToString:function(AI){if(AI===undefined){return undefined;}var AH;if(typeof AI==="object"){AH=JSON.stringify(AI.jsonObj||AI);}else{AH=AI.toString();}AH=AH.replace(/"/g,"'");return AH;},compareElementObj:function(AL,AI){var AK=AL.tid.toString(),AH=AI.tid.toString(),AM=AL.eid,AJ=AI.eid;if(AK!==AH){return AK>AH?1:-1;}if(AM===AJ){return 0;}return AM>AJ?1:-1;},isEqualComb:function(AI,AH){var AM=true,AL,AK=AI.length,AJ=AH.length;if(AK!==AJ){return false;}if(AI.length>1){AI.sort(this.compareElementObj);}if(AH.length>1){AH.sort(this.compareElementObj);}for(AL=0;AL<AK;AL++){if(this.compareElementObj(AI[AL],AH[AL])!==0){AM=false;break;}}return AM;},serializeCombination:function(AI){var AH="";if(AI.length>1){AI.sort(this.compareElementObj);}p.forEach(AI,function(AJ){if(AH!==""){AH+=w;}AH+=(AJ.tid+k+AJ.eid);});return AH;},deserializeCombination:function(AI){var AJ=AI.split(w),AH=[];p.forEach(AJ,function(AN){var AK=AN.split(k);var AM=AK[0];var AL=AK[1];AH.push({tid:AM,eid:AL});});return AH;},getElementCombinationForMetric:function(AH){var AI=[];AI.push({tid:-1,eid:AH});return AI;},getResolvedFormatsObject:function(AH){return Y(AH);},isDigitalArrayEqual:function(AI,AH){return m.call(this,AI,AH);},indexOf:function(AI,AK){var AJ,AH=AI.length;for(AJ=0;AJ<AH;AJ++){if(m(AI[AJ],AK)){return AJ;}}return -1;},parseAxisScaleData:function(AL){var AJ,AM,AI,AH=AL.split(","),AK=[];for(AJ=0,AM=AH.length;AJ<AM;AJ++){AI=AH[AJ].split(":");AK.push(AI);}return AK;},parseCSSColor:function(AL,AI){var AK=AL.slice(1),AH=[],AJ;if(AK.length===6){if(AI===true){AH[0]=AK[4];AH[1]=AK[5];AH[2]=AK[2];AH[3]=AK[3];AH[4]=AK[0];AH[5]=AK[1];}else{for(AJ=0;AJ<6;AJ++){AH[AJ]=AK[AJ];}}}else{if(AI===true){for(AJ=2;AJ>=0;AJ--){AH.push(AK[AJ]);AH.push(AK[AJ]);}}else{for(AJ=0;AJ<3;AJ++){AH.push(AK[AJ]);AH.push(AK[AJ]);}}}return parseInt("0x"+AH.join(""),16);},RGB_BRG_Switch:function(AI){var AK=(AI>>16)&255,AJ=(AI>>8)&255,AH=(AI>>0)&255;return(AH<<16)|(AJ<<8)|(AK<<0);},encodeColor:function(AI){if(AI===undefined||AI===null||AI==="transparent"||AI==="default"){return AI;}var AJ=false,AH={};if(AJ){if(typeof AI==="object"){AH.c1=this.RGB_BRG_Switch(h.encodeColor(AI.c1));AH.c2=this.RGB_BRG_Switch(h.encodeColor(AI.c2));AH.or=AI.or;return AH;}return this.RGB_BRG_Switch(h.encodeColor(AI));}if(typeof AI==="object"){AH.c1=h.encodeColor(AI.c1);AH.c2=h.encodeColor(AI.c2);AH.or=AI.or;return AH;}return h.encodeColor(AI);},checkEquality:function(AI,AH){if(typeof AI==="object"&&AI.c1!==undefined){if(AI.c1!==AH.c1){return false;}if(AI.c2!==AH.c2){return false;}if(AI.or!==AH.or){return false;}return true;}return AI===AH;},decodeColor:function(AI){if(AI===undefined||AI===null||AI==="transparent"||AI==="default"){return AI;}var AJ=false,AH={};if(AJ){if(typeof AI==="object"){AH.c1=h.decodeColor(this.RGB_BRG_Switch(AI.c1));AH.c2=h.decodeColor(this.RGB_BRG_Switch(AI.c2));AH.or=AI.or;return AH;}return h.decodeColor(this.RGB_BRG_Switch(AI));}if(typeof AI==="object"){AH.c1=h.decodeColor(AI.c1);AH.c2=h.decodeColor(AI.c2);AH.or=AI.or;return AH;}return h.decodeColor(AI);},getTrendLineToggleHandler:function(AH,AJ,AI){return function(){AH.switchOnOffTrendLineForMetric(AJ,AI);};},getTrendLineToggleState:function(AH,AI){return AH.queryTrendLineStatusForMetric(AI);},getEditTrendLineHandler:function(AH,AI){return function(){mstrApp.rootCtrl.docCtrl.selectViPanel("propertiesPanel");AH.raiseEventCMSelection(J.TREND_LINE,AI);};},getEditRefLineHandler:function(AH,AI){return function(){mstrApp.rootCtrl.docCtrl.selectViPanel("propertiesPanel");AH.raiseEventCMSelection(J.REF_LINE,AI);};},getEditAxisScaleHandler:function(AH,AI){return function(){mstrApp.rootCtrl.docCtrl.selectViPanel("propertiesPanel");AH.raiseEventCMSelection(J.AXIS_SCALE,AI);};},getEditAxisOriginHandler:function(AH,AI){return function(){mstrApp.rootCtrl.docCtrl.selectViPanel("propertiesPanel");AH.raiseEventCMSelection(J.AXIS_ORIGIN_DEFINE,AI);};},getEditLogScaleHandler:function(AH,AI){return function(){mstrApp.rootCtrl.docCtrl.selectViPanel("propertiesPanel");AH.raiseEventCMSelection(J.LOG_SCALE,AI);};},getOptionObjArr:function(AH,AJ,AL){if(!E){E=mstrmojo.gm.GMUtility;}var AI={},AK;if(AJ!==undefined){AJ=AJ.toLowerCase();if(AJ==="x1"){AJ="x";}else{if(AJ==="y1"){AJ="y";}}}if(AH.length>1||(AL&&AH.length===1)){if(AJ==="x"){AI.opt=mstrmojo.desc(11712,"Bottom Axis");AI.key="XAxis";}else{if(AJ==="x2"){AI.opt=mstrmojo.desc(11710,"Top Axis");AI.key="X2Axis";}else{if(AJ==="y"){AI.opt=mstrmojo.desc(11715,"Left Axis");AI.key="YAxis";}else{if(AJ==="y2"){AI.opt=mstrmojo.desc(11713,"Right Axis");AI.key="Y2Axis";}else{if(AJ==="z"){AI.opt=mstrmojo.desc(12090,"SizeBy");AI.key="SizeBy";}}}}}AI.optLvl=l.AXIS;AI.mos=this.getMetricFormatFromIndexArray(AH);}else{if(AH.length===1){AK=this.getMetricFormat(AH[0]);AI.opt=AK.n;AI.mos=[AK];AI.key=AK.mId;AI.comb=E.getElementCombinationForMetric(AK.mId);AI.optLvl=l.METRIC;if(AJ==="z"){AI.sizeBy=true;}}}return AI;},filterInValidMetricIndex:function(AI){var AH=[];p.forEach(AI,function(AJ){if(AJ!==a){AH.push(AJ);}});return AH;},fillBackgroundDiv:function(AI){var AH=document.createElement("div");AH.setAttribute("class","gm-bk-div");AH.style.backgroundColor="rgba(0,0,0,0)";AI.appendChild(AH);},getSubMenu:function(AM,AN,AL,AK){var AJ=AE(AM,AK),AH=AM.getMenuHandler("changeShape"),AI=AM.GMController.getOnTheFlyShapeForMetric(AK);if(AJ.length>1){AN.addSubMenuItem(mstrmojo.desc(11972,"Change Shape"),"",AM.id,AF,{currValue:AI,options:AJ,metricId:AL});}else{AN.addRadioMenuGroup(AI,q(AL,AH),AJ,"checkMark",undefined,true);}},getReferenceLineSubMenu:function(AI,AM,AN,AH){var AO=mstrmojo.gm.EnumSubtype,AL=AI.GMController.chartSubType;if(AN&&AL===AO.PERCENT){return ;}var AP=AI.id,AJ=AI.getAvailableRefLineTypes(AH)||[];if(AJ.length>0){AM.addSubMenuItem(mstrmojo.desc(13021,"Add Reference Line"),"xt",AP,z,{metricId:AH,options:AJ});}var AK=AI.getExistingRefLineOptions(AH)||[];if(AK.length>0){AM.addMenuItem(mstrmojo.desc(13659,"Edit Reference Line"),"xt",E.getEditRefLineHandler(AI,AH));AM.addSubMenuItem(mstrmojo.desc(13022,"Remove Reference Line"),"xt",AP,t,{metricId:AH,options:AK});}},reverseMapping:function n(AI){var AK={},AJ,AH=AI.length;for(AJ=0;AJ<AH;AJ++){AK[AI[AJ]]=AJ;}return AK;},longIntAnd:function(AI,AH){var AJ;if(AI===AH){return AI;}if(AI>e||AH>e){throw new Error("Operand exceeds valid data range.");}if(AI<b&&AH<b){return AI&AH;}if(AI>=b||AH>=b){if(AI<AH){AJ=AI;AI=AH;AH=AJ;}}var AL=Math.floor(AI/b),AK=Math.floor(AH/b),AN=AI-AL*b,AM=AH-AK*b;return(AN&AM)+(AL&AK)*b;},longIntOr:function(AI,AH){var AJ;if(AI===AH){return AI;}if(AI<b&&AH<b){return AI|AH;}if(AI<AH){AJ=AI;AI=AH;AH=AJ;}AJ=this.longIntAnd(AI,AH);return AH-AJ+AI;},parseNumeric:function(AH){return +AH||parseFloat(AH);},fillImageInDiv:function(AK,AJ,AI,AH){AH=AH||"gm-img";AK.innerType=AJ;if(AJ===4){AK.innerHTML="<img class="+AH+' src="'+AI+'"/>';}else{if(AJ===7){AK.innerHTML=AI;B.addClass(AK.firstChild,AH);}}},fillTextInDiv:function(AH,AQ,AS,AI,AT,AJ,AV,AL,AO){if(AI===undefined){AI=AH.offsetWidth;}if(AT===undefined){AT=AH.offsetHeight;}if(AL===undefined){AL=W.MIDDLE;}if(AO===undefined){AO=r.MIDDLE;}if(AJ===undefined){AJ=false;}AS=this.replaceSpecialChars(AS);var AP,AR,AN,AU=AJ?"gm-text-body":"gm-text-body-nowrap",AK=false,AM;AP=H.measureTextWidth(AS,AV,6);AM=H.measureTextWidth("...",AV,6);if(AP>AI&&AM>AI){return ;}AN=document.createElement("div");AN.setAttribute("class",AU);AN.setAttribute("type",AB.GM_TEXT_BODY);AN.identity=AQ;H.applyStyles2DomNode(AN,AV);AN.innerHTML=AS;AH.appendChild(AN);if(AJ){if(AP>AI){AR=AN.offsetHeight;}else{AR=H.measureTextHeight(AS,AV,4);}}else{AR=H.measureTextHeight(AS,AV,4);AK=AP>AI;}AP=Math.min(AP,AI);AN.style.width=AP+"px";if(AJ){AK=AN.scrollWidth>AP||AN.scrollHeight>AR;}if(AK){AN.setAttribute("title",AS);}else{AN.setAttribute("title","");}switch(AL){case W.LEFT:AN.style.left="0px";AN.style.textAlign="left";break;case W.MIDDLE:AN.style.left=((AI-AP)>>1)+"px";break;case W.RIGHT:AN.style.right="0px";AN.style.textAlign="right";break;}switch(AO){case r.TOP:AN.style.top="0px";break;case r.MIDDLE:AN.style.top=((AT-AR)>>1)+"px";break;case r.BOTTOM:AN.style.bottom="0px";break;}},updateTextColorAndAlignment:function(AH,AJ,AK){var AL=AH.firstChild,AM=AL.style,AI=AH.clientWidth,AN=AL.clientWidth,AP=AH.clientHeight,AO=AL.clientHeight;AM.left="auto";AM.right="auto";switch(AJ){case W.LEFT:AM.left="0px";break;case W.MIDDLE:AM.left=((AI-AN)>>1)+"px";break;case W.RIGHT:AM.right="0px";break;}AM.top="auto";AM.bottom="auto";switch(AK){case r.TOP:AM.top="0px";break;case r.MIDDLE:AM.top=((AP-AO)>>1)+"px";break;case r.BOTTOM:AM.bottom="0px";break;}},toggleDisplay:function(AI,AH){if(!AI){return ;}if(AH){AI.style.display="block";}else{AI.style.display="none";}},isTrendLineAvailableForMetric:function(AL,AM,AP){var AW=AL&&AL.excludeData,AT=mstrmojo.gm.EnumSubtype,AO=o.gm.EnumShape,AU=AL.GMController,AQ=AU.chartSubType,AV=AL.model.data.dz,AJ=AV.XAxis,AH=AV.YAxis,AK=AV.BreakBy,AN=AV.SliceBy,AR=AP,AI=AU.getChartInfo(),AS=AU.getBreakByAttrsID().length>0||(AI.isABL&&((AJ.MetricNames!==undefined)||(AH.MetricNames!==undefined)||(AK.MetricNames!==undefined)||(AN.MetricNames!==undefined)));if(AR===undefined){AR=AU.getOnTheFlyShapeForMetric(AM);}if(AI.isABL&&AQ===AT.PERCENT){AW=true;}if(AS&&!AI.isBubbleOrScatter&&(AR===AO.BAR||AQ===AT.STACKED||(AQ===AT.AUTO&&AR===AO.AREA))){AW=true;}if(AI.isABL){if(AJ.TemplateUnit&&AJ.TemplateUnit.length>1){AW=true;}if(AH.TemplateUnit&&AH.TemplateUnit.length>1){AW=true;}if(AJ.TemplateUnit===undefined&&AH.TemplateUnit===undefined){AW=true;}}AW=AW||this.isIgnoredMetric(AL,AM);return !AW;},isTrendLineAvailableForAnyMetric:function(AJ){var AI=AJ.model.data.gsi.mx,AH;for(AH in AI){if(this.isTrendLineAvailableForMetric(AJ,AH)){return true;}}return false;},isIgnoredMetric:function(AK,AI){var AJ=AK.GMController,AL,AH;if(AJ.bubbleSeriesNum!==undefined){AL=AJ.getMetricsOnYAxis();AH=AL.indexOf(AI);if(AH>=AJ.bubbleSeriesNum){return true;}AL=AJ.getMetricsOnXAxis();AH=AL.indexOf(AI);if(AH>=AJ.bubbleSeriesNum){return true;}}return false;},getAxisMetricsInfo:function(AM){var AH=AM.model.data.dz,AN=AM.model.data.gsi.mx,AI,AJ,AL=[];if(!AH||!AH.ColorBy||!AN){return AN;}var AK=function(AO){return(AO&&AO.TemplateMetric)||[];};AI=AK(AH.YAxis).concat(AK(AH.XAxis));p.forEach(AN,function(AO){AJ=false;p.forEach(AI,function(AP){if(AO.did===AP.id){AJ=true;return false;}});if(AJ){AL.push(AO);}});return AL;},isInvalidTemplate:function O(AK){if(AK.eg){return false;}var AI=AK.gts;var AH=AI.row.length===0&&AI.col.length===0;p.forEach(AI.row,function(AN){if(AN.otp===-1){AH=true;}});var AM=AI.col;if(AM.length>0){var AJ,AL=AM.length-1;for(AJ=0;AJ<AL;AJ++){if(AM[AJ].otp===-1){AH=true;}}}return AH;},isNoData:function(AH){return AH.eg!==undefined;},getInvalidTemplateErrMsg:function(AH){return AH||mstrmojo.desc(12094,"The Graph Matrix requires:")+"\n"+mstrmojo.desc(12095,"- at least one attribute to be placed on the row or column axis")+"\n"+mstrmojo.desc(12096,"- all metrics to be placed on the column axis, below any attributes");},initColorPickerBtnWithGradientDir:function(AI,AJ){mstrmojo.func.override({showPickerForCurrentMode:function AH(){this._super();if(this.pickerMode===2&&typeof this.color!=="object"){var AK=this.gradientOrientation,AL=AJ.getChartInfo().dirc===mstrmojo.gm.EnumABLDirection.VERTICAL;AK.set("selectedIndex",p.find(AK.items,"id",AL?0:1));}}},AI.colorPicker);},generateToolTipContent:function(AQ,AL,AH,AM,AO,AN,AT){var AK,AI,AJ,AP,AR,AS;for(AK=AQ;AK<AL;AK++){AI=AM[AK];AP=AO[AK];if(AK>AQ){AJ=AM[AK-1];AR=AO[AK-1];if(AI.id===AJ.id){if(AP===""){continue;}if(AI.fid===AJ.fid&&AP.idx===AR.idx){continue;}if(AI.n===""){AN[AN.length-1].v+=M+AP.n;continue;}}}if(AT){AN.push({n:AI.n,tid:AI.id,v:AP.n});}else{AS=AH===undefined?AI.isRowAttribute:AH;AN.push({n:AI.n,tid:AI.id,v:AP.n,eid:AP.id,tp:AI.otp,axis:AS?1:2,tui:AI.tui,ui:AI.tui,dpt:AI.tui+1,at:AP.at,isRowAttribute:AS,dei:AP.dei,o:AP.o});}}},getAttributeFormCnt:function(AH){var AI;if((AH.fcnt===undefined||AH.fcnt===null)&&AH.fs){AH.fcnt=AH.fs.length||1;}if(AH.fcnt!==undefined&&AH.fcnt!==null){AI=AH.fcnt;}else{if(AH.t===47){AI=1;}else{AI=AH.cs!==undefined?AH.cs:AH.rs;}}return AI;},isTrueForBoolValue:function(AH){return AH===true||AH==="true";},computeTicksForAxis:function(AK,AI){var AJ=AK.mOptions,AL,AH={mTicks:[]};if(AI){AL=Q.copy(AJ);Q.copy(AI,AL);}else{AL=AJ;}if(AK.mIsPercent){U.call(AK,AH,AL);return AH;}if(AL.mUseLogarithmicScale){P.call(AK,AH,AL);return AH;}if(AK.mGraphMajorType===d.GMT_BUBBLE&&AK.mTripleId.mObjectId===x.DssGraphZBody){AH.mMinTick=AL.mUseMinValue?AL.mAxisMinValue:AK.mMinimum;AH.mMaxTick=AL.mUseMaxValue?AL.mAxisMaxValue:AK.mMaximum;if(AK.mMinTick>=AK.mMaxTick){AH.mMaxTick=AH.mMinTick+1;}return AH;}if(!AL.mUseMaxValue&&!AL.mUseMinValue){s.call(AK,AH,AL);}else{if(AL.mUseMaxValue&&AL.mUseMinValue){D.call(AK,AH,AL);}else{if(AL.mUseMaxValue){F.call(AK,AH,AL);}else{j.call(AK,AH,AL);}}}return AH;},computeTicksForLogScale:function(AJ){var AI=AJ.mOptions,AH={mTicks:[]};P.call(AJ,AH,AI);return AH;},destroyDisposable:function(AH,AI){if(AI){p.removeItem(AH.disposables,AI);AI.destroy();}},handleDestroy:function(AL,AK,AI){if(!AL){return ;}var AM,AJ=0,AH=AL.disposables,AN=(AH&&AH.length)||0;while(AJ<AN){AM=AH[AJ];if((!AM.scriptClass||AK.indexOf(AM.scriptClass)<0)&&p.indexOf(AI,AM.id)===-1){this.destroyDisposable(AL,AM);}if(AH.length<AN){AN=AH.length;}else{AJ++;}}}});}());(function(){mstrmojo.requiresCls("mstrmojo.string","mstrmojo.dom","mstrmojo.array","mstrmojo.css","mstrmojo.hash","mstrmojo.VisEnum","mstrmojo.VisUtility","mstrmojo.gm.GMUtility","mstrmojo.color","mstrmojo.ui.menus.EditorConfig","mstrmojo.ui.menus.ToolbarEditorConfig","mstrmojo.vi.ui.editors.EditorGroup","mstrmojo.ui.editors.controls.LineConfigGroup","mstrmojo.ui.editors.controls.FillConfigGroup","mstrmojo.ui.editors.controls.ColorPickerButton","mstrmojo.ui.editors.controls.CharacterGroup","mstrmojo.ui.editors.controls.AdvancedColorPicker");var a=mstrmojo,I=a.dom,K=a.hash,b=a.array,A=a.css,j=a.VisEnum.ControlType,i=mstrmojo.gm,F=mstrmojo.color,V=i.GMUtility,R=a.VisUtility,k=i.FormatingPropertyTag,f=mstrmojo.models.FormatModel,d=f.ENUM_PROPERTY_NAMES,P=mstrmojo.chart.enums.EnumFontStyle,g=mstrmojo.VisEnum.GMLegendFormatingPropertyTag,G=mstrmojo.VisEnum.NetworkLegendFormattingCategory,W=mstrmojo.ui.editors.controls.AdvancedColorPicker,X={GLOBAL:"glb",FORMATTING:"fmt"},D={FONT_COMP:"FntCmp",FONT_FAMILY:"FntFml",FONT_STYLE:"FntStyle",FONT_SIZE:"FntSz",FONT_COLOR:"FntClr",LINE_COMP:"LnCmp",SHOW:"Shw",COLOR:"Clr",STYLE:"Style",THICKNESS:"Thk"};function N(r,o){var n=this.widget,p=n.domToolbarPH,q=this;n._lastOpened=null;p.innerHTML="";document.body.appendChild(p);A.toggleClass(p,mstrApp.getThemeClassName(),true);this.configureLegendPopup(o,p);n.toolEditor=o.newInstance({unrender:function(){}});n.toolEditorClosefn=function(s){var u=s.target,t=n.toolEditor.domNode;if(!I.contains(t,u,true,t)&&!R.isHostedPopupNode(u,"class",true,document.body)){q.hideToolbar();}};I.attachEvent(document.body,"mousedown",n.toolEditorClosefn,true);n.openPopup(this.widget.toolEditor);A.toggleClass(document.body,"hasToolbarPopup",true);}function L(o,n){var p;if(n===X.GLOBAL){p=this.readGlobalProperty(o);}else{if(n===X.FORMATTING){p=this.widget.getPropertiesOfFormatable();}}if(o.slice(-3)===D.COLOR){if(o!==k.COLOR_SQUARE_COLOR||n!==X.GLOBAL){p=V.decodeColor(p);}}return p;}function Q(o,n){var p=this;if(n===X.GLOBAL){return function(r){var q=L.call(p,o,X.GLOBAL);if(o===k.COLOR_SQUARE_COLOR){q=q.color;}if(!K.equals(r,q)){if(o.indexOf(D.COLOR)!==-1){r=V.encodeColor(r);}p.writeGlobalProperty(o,r);}};}return function(s,q){var r=L.call(p,o,X.FORMATTING);if(s!==r){if(o.indexOf(D.COLOR)!==-1){s=F.encodeColor(s);}p.widget.writeFormatableProperties(o,s,q);}};}function O(o,n){o=o||[];n=n||"";b.forEach(o,function(p){p.cssDisplay="inline-block";});return{scriptClass:"mstrmojo.HBox",cssClass:n,children:o};}function e(o,p){o=o||[];var n=new mstrmojo.Box({children:o,cssText:p});return n;}function B(r,s,n){var q="white-space: nowrap; width: 50px;";if(r===mstrmojo.desc(3905,"Background")||r===mstrmojo.desc(6242,"Color")){q="white-space: nowrap;";}else{if(r===mstrmojo.desc(2885,"Fill")){q="white-space: nowrap; margin-right: 9px;";}}var o=new mstrmojo.Label({text:r}),p=e(o,q);return O([p,s],n);}function c(o,p,n){var q=this;o=o||{};if(o.propNames===undefined){o.propNames=p;}o.onGroupValueChange=function(r,t,s){if(t!==s&&t!==undefined){(Q.call(q,r,n))(t,s);}};return o;}function S(p,o,n){var q=this;b.forEach(o,function(r){var s=L.call(q,r,n);if(s!==undefined){p.setChildValue(r,s);}});}function C(n,q,p,o){o=c.call(this,o,q,p);K.copy({width:"140px",height:"22px",colorPickerHostWithin:true},o);var r=new mstrmojo.ui.editors.controls.FillConfigGroup(o);if(r){r.iniChildrenComp(q);S.call(this,r,q,p);}if(typeof n==="string"){return B(n,r,(o||[]).rowContainerCSSClass);}return r;}function Z(p,o,n){return new mstrmojo.ui.menus.ToolbarEditorConfig({contents:[{scriptClass:"mstrmojo.Box",cssClass:"mstrmojo-ui-ToolBoxBackgroundFill",children:[C.call(this,mstrmojo.desc(2885,"Fill"),p,o,K.copy({rowContainerCSSClass:"mstrmojo-ui-rowContainer"},n))]}]});}function l(r,p,t,s,o){var q=L.call(this,t,s),u=this;var n=new mstrmojo.ui.editors.controls.ColorPickerButton({isHostedWithin:true,width:"40px",selectedValue:q,showNoFill:false,postselectedValueChange:function(w){(Q.call(u,t,s))(w.value,w.valueWas);}});if(r){n.alias=r;}if(typeof p==="string"){return B(p,n);}return n;}function m(o){var n;if(o.listenToUpdateColorMap instanceof Function){n=o.listenToUpdateColorMap(function(){o.raiseEvent({name:"colorByColorChange",type:"invalidateCache"});if(n&&o.detachUpdateColorMapListener instanceof Function){o.detachUpdateColorMapListener(n);}});}}function h(p,o){var n=L.call(this,p,o),q=this;return new mstrmojo.ui.menus.ToolbarEditorConfig({cssClass:"cbsquare-colorpicker",contents:[new mstrmojo.ui.editors.controls.AdvancedColorPicker({showAutomatic:!n.isDefaultColor,color:n.color,colorChanged:function(r){r=(this.showAutomatic&&r===W.VAL_AUTOMATIC)?"default":r;m(q.widget);(Q.call(q,p,o))(r,n.color);q.hideToolbar();},colorCanceled:function(){q.hideToolbar();}})]});}function U(t,o){var n={},s=L.call(this,o+D.FONT_STYLE,X.GLOBAL),q=L.call(this,o+D.FONT_COLOR,X.GLOBAL),p=L.call(this,o+D.FONT_FAMILY,X.GLOBAL),r=L.call(this,o+D.FONT_SIZE,X.GLOBAL);if(s!==undefined){n[d.FONT_WEIGHT]=(!isNaN(s)&&((s&P.FS_BOLD)>0));n[d.FONT_STYLE]=(!isNaN(s)&&((s&P.FS_ITALIC)>0));n[d.UNDERLINE]=(!isNaN(s)&&((s&P.FS_UNDERLINE)>0));n[d.LINE_THROUGH]=(!isNaN(s)&&((s&P.FS_STRIKETHROUGH)>0));}if(q!==undefined){n[d.COLOR]=q;}if(r!==undefined){n[d.FONT_SIZE]=r;}if(p!==undefined){n[d.FONT_FAMILY]=p;}t.setFormatSource(n);}function H(o,n){var p=null;if(n.indexOf(D.FONT_FAMILY)!==-1){p=o.fontFamily;}else{if(n.indexOf(D.FONT_STYLE)!==-1){p=o.fontStyle;}else{if(n.indexOf(D.FONT_SIZE)!==-1){p=o.fontSize;}else{if(n.indexOf(D.FONT_COLOR)!==-1){p=o.fontColor;}}}}return p;}function M(q,p,n){var o={bold:P.FS_BOLD,italic:P.FS_ITALIC,underline:P.FS_UNDERLINE,strikeout:P.FS_STRIKETHROUGH},r=this;p.forEach(function(s){var t=H(q,s);if(t){t.propName=s;if(s.indexOf(D.FONT_STYLE)!==-1){t.postselectionChange=function(u){var y=u.added,z=t.items[(y&&y[0]!==undefined)?y[0]:u.removed[0]],x=!!y,w=L.call(r,s,n),AA=(w===undefined?0:w);if(x){AA=AA|o[z.css];}else{AA=AA&(~o[z.css]);}t.parent.raiseFormatValueChange(s,AA,w);};}else{if(s.indexOf(D.FONT_FAMILY)!==-1){t.postselectedIndexChange=function(u){var y=u.value,x=u.valueWas;if(y!==x){var w=t.items;t.parent.raiseFormatValueChange(s,w[y].id,w[x]&&w[x].id);}};}else{if(s.indexOf(D.FONT_SIZE)!==-1){t.postselectedValueChange=function(u){var x=parseInt(u.value,10)+"pt",w=parseInt(u.valueWas,10)+"pt";if(x!==w){t.parent.parent.raiseFormatValueChange(s,x,w);}};}else{t.postselectedValueChange=function(u){t.parent.parent.raiseFormatValueChange(s,u.value,u.valueWas);};}}}}});}function Y(o,r,q,p){var u=this;p=p||{};if(p.propNames===undefined){p.propNames=r;}if(p.onGroupValueChange===undefined){p.onGroupValueChange=function(w,y,x){if(y!==x&&y!==undefined){(Q.call(u,w,X.GLOBAL))(y,x);}};}var n={cssClass:"mstrmojo-ui-ToolbarCharacter cf",layoutConfig:null,width:"397px",height:"22px"};p=K.copy(n,p);var t=new mstrmojo.ui.editors.controls.CharacterGroup(p),s=H(t,k.LEGEND_FONT_COLOR);s.showNoFill=false;M.call(this,t,r,q);U.call(this,t,o);return t;}function J(r,q){var w=q.firstChild,AA=w?w.offsetWidth:0,o=w?w.offsetHeight:0,s=document.body.offsetWidth,z=document.body.offsetHeight,t=10,u=5,y=5;if(w){w.style.left="0";w.style.right="auto";w.style.top="0";w.style.bottom="auto";}var x={w:AA,h:0};var p=o>0;if(p){x.h=o;}else{return false;}if(p){q.style.left=r.x+"px";q.style.top=r.y-o-t/2+"px";}if(r.x+x.w>s){q.style.left=r.x-AA+"px";}if(p){var n=0;if(r.y-o-t/2<u){n=u;q.style.top=n+"px";}else{if(r.y+t/2>z){n=Math.max(z-t-o,u);q.style.top=n+"px";}}}}function E(n,q,p,o){return new mstrmojo.ui.menus.ToolbarEditorConfig({contents:[{scriptClass:"mstrmojo.vi.ui.editors.EditorGroup",showDivider:false,children:[Y.call(this,n,q,p,o)]}]});}mstrmojo._FormateVisLegend=mstrmojo.provide("mstrmojo._FormateVisLegend",{_mixinName:"mstrmojo._FormateVisLegend",widget:null,readGlobalProperty:undefined,writeGlobalProperty:undefined,configureLegendPopup:undefined,init:function(n){this.widget=null;if(this._super){this._super(n);}if(this.widget&&!this.widget.domToolbarPH){var o;o=document.createElement("div");o.setAttribute("class","gm-menu-placeholder");this.widget.domToolbarPH=o;}},handleRMCOnLegend:function(z){var s=z.getTarget(),t=z.e,x={x:t.pageX,y:t.pageY},w=s.getAttribute("type"),o,u,q,r=this,p=this.widget;z.cancel();z.preventDefault();if(mstrApp.isAppStatePresentation()||!mstrApp.allowWebDashboardDesign()||mstrApp.isInVFInteractMode){return ;}var y,n=function(AA){switch(AA){case j.LGD_COLORBOX_CTN:case j.LGD_COLORBOX:if(AA===j.LGD_COLORBOX){s=s.parentNode;}u=s.firstChild.identity;if(u&&u.comb){this.widget.colorSqureIdentity=u;this.selectColorBox(s,this.fmtMode);o=h.call(this,k.COLOR_SQUARE_COLOR,X.GLOBAL);x=this.adjustColorPickerPos(s);if(!x.alignLeft){q=o.ENUM_CORNERS;o.setAlignment(q.BOTTOM_LEFT,q.TOP_RIGHT);}}break;case j.LGD_TITLE:case j.LGD_TEXT:this.selectText(true);var AB=[k.LEGEND_FONT_SIZE,k.LEGEND_FONT_FAMILY,k.LEGEND_FONT_STYLE,k.LEGEND_FONT_COLOR];o=E.call(this,"lgd",AB,X.GLOBAL);y="lgd";break;default:this.selectLegendBody();var AC=[k.LEGEND_BG_COLOR,k.LEGEND_BG_FILL_TRANSPARENCY];o=Z.call(this,AC,X.GLOBAL);y="lgd";break;}if(o){N.call(this,x,o);if(!!y){mstrApp.rootCtrl.docCtrl.selectViPanel("propertiesPanel");p.parent.selectVIUnit();var AD=p.edtModel._targetPulldown;if(AD){AD.selectItemByField("v",y);}}}};n.call(this,w);J.call(this,x,this.widget.domToolbarPH);},hideToolbar:function(){var o=this.widget,p=o.domToolbarPH,r=p.firstChild,n=p.parentNode;if(r){p.removeChild(r);}if(n){n.removeChild(p);}var q=o.toolEditor;if(q){q.unrender=function(){q._super();};q.destroy();q.unrender=function(){};delete o.toolEditor;A.toggleClass(document.body,"hasToolbarPopup",false);A.toggleClass(p,mstrApp.getThemeClassName(),false);}if(o.toolEditorClosefn){I.detachEvent(document.body,"mousedown",o.toolEditorClosefn,true);delete o.toolEditorClosefn;}},highlightText:function(n){throw new Error("subclass need to implement highlightText function");}});}());(function(){mstrmojo.requiresCls("mstrmojo.dom","mstrmojo.css","mstrmojo.Vis","mstrmojo._HasOwnAvatar");var K=mstrmojo.css,I=mstrmojo.dom,F="px";function B(Q,P){return{x:Q.x-P.x,y:Q.y-P.y};}function M(Q,P){return(Q.x-P.x)*(Q.x-P.x)+(Q.y-P.y)*(Q.y-P.y);}function N(P){var Q=P.src.data;return(!Q||!Q.isScrollBar);}mstrmojo.VisLegend=mstrmojo.declare(mstrmojo.Vis,[mstrmojo._HasOwnAvatar],{scriptClass:"mstrmojo.gm.VisLegend",bodyCssClass:"",avatarCssClass:"legend-dragged",dropZoneHighlightCss:"legend-dropZone",ownAvatar:true,draggable:true,dropZone:true,dockedPositions:null,calculateDockedPositions:mstrmojo.emptyFn,widget:null,boundaryNode:null,draggableNodeName:"domLegend",legendMarkup:"",extrasMarkup:"",markupString:'<div id="{@id}" class="{@cssClass}" style="width:{@width}px;height:{@height}px;top:{@top}px;left:{@left}px;position:absolute;" mstrAttach:click,mouseover,mouseout><div class="gm-legend-bg"><div class="{@bodyCssClass}" style="width:{@width}px;height:{@height}px;text-decoration:inherit">{@legendMarkup}</div></div><div class="gm-anchor-point topLeft"></div><div class="gm-anchor-point topRight"></div><div class="gm-anchor-point bottomLeft"></div><div class="gm-anchor-point bottomRight"></div>{@extrasMarkup}</div>',markupSlots:{dropZoneNode:function(){return this.domNode;},domLegend:function(){return this.domNode.firstChild.firstChild;}},postBuildRendering:function(){this._super();this.calculateDockedPositions(this.widget.getWidth(),this.widget.getHeight());this.boundaryNode=this.widget.domNode;this.boundaryPosition=I.position(this.boundaryNode,true);},createAvatar:function D(){return this[this.draggableNodeName];},updateDropZoneNode:function C(R){var P=this.dockedPositions;if(P&&P.length>0){var X=B(R.tgt.pos,this.boundaryPosition);var V=M(X,P[0]),U=0,Q,W;for(Q=1;Q<P.length;Q++){W=M(X,P[Q]);if(W<V){V=W;U=Q;}}if(U!==this.currDockedPositionIdx){var S=this.dropZoneNode.style;S.left=P[U].x+F;S.top=P[U].y+F;if(this.widget.onLegendDropZoneChange){this.widget.onLegendDropZoneChange(P[U],U);}this.currDockedPositionIdx=U;this.updateAlignClass();return true;}}return false;},toggleDropZoneBorder:function O(P){K.toggleClass(this.dropZoneNode,this.dropZoneHighlightCss,P);},isDragValid:N,ondragstart:function E(P){if(!N(P)){return ;}this._super(P);this.toggleDropZoneBorder(true);},ondragmove:function A(P){if(!N(P)){return ;}this.updateDropZoneNode(P);this._super(P);},allowDrop:function H(P){var R=P.src,Q=R&&R.widget;return(Q&&Q!==this&&Q.parent===this.parent);},ondrop:function J(R){var P=this.domLegend;K.removeClass(P,this.avatarCssClass);var S=P.style;S.left="0";S.top="0";this.dropZoneNode.firstChild.appendChild(P);if(this.widget.onLegendDropped){var Q=this.getDockedPosition();this.widget.onLegendDropped(Q&&Q.pos);}R.dropSuccessful=true;},getDockedPosition:function G(){return this.dockedPositions&&this.dockedPositions[this.currDockedPositionIdx];},ondragend:function A(P){if(!N(P)){return ;}this._super(P);if(!P.dropSuccessful){this.ondrop(P);}this.toggleDropZoneBorder(false);},positionAvatar:function L(V){var R=this,Q=this.avatar,S=Q.style,U=this.boundaryPosition;var P=function(W,X){if(W==="x"){if(X<U.x){return U.x;}return Math.min(X,U.x+U.w-R.domNode.offsetWidth);}if(W==="y"){if(X<U.y){return U.y;}return Math.min(X,U.y+U.h-R.domNode.offsetHeight);}};S.left=P("x",V.x)+F;S.top=P("y",V.y)+F;}});}());(function(){mstrmojo.requiresCls("mstrmojo.dom","mstrmojo.css","mstrmojo.VisEnum","mstrmojo.VisLegend","mstrmojo.VisUtility","mstrmojo.gm.GMEnums","mstrmojo.gm.GMIdentities","mstrmojo.gm.GMUtility","mstrmojo.array","mstrmojo.string","mstrmojo.hash","mstrmojo._FormateVisLegend","mstrmojo.ui._HasScroller");var Aj=mstrmojo,Af=Aj.gm,AC=Aj.dom,Ae=Aj.css,S=Aj.hash,AQ=Aj.VisUtility,b=Af.GMUtility,P=mstrmojo.array,Z=mstrmojo.string,AD=mstrmojo.ui.editors.controls.AdvancedColorPicker,g=Af.ColorSquareIdentity,C=Aj.VisEnum.ControlType,k=Af.EnumLegendSlot,AO=Af.EnumDockPosition,o=Af.EnumLegendSlot,AI=Af.EnumIdentityType,AG=Af.EnumShape,Aa=Aj.VisEnum.GMLegendDataType,J=mstrmojo.desc(13966,"Size by:"),y="px",F=1.35,a=0.75,X=5,K=20,m=K,AH=5,A=5,z=16,f=15,H=16,AL=20,G=150,t=15,Ah=1,AB="setAttribute",l=3,i=2,Q=8,s=15,AV=14,w=1,R=2,h=4,Ak=8,Ai=16,L=10,AX=3,AM=50,AS=-3,u=5,AT="gm-legend-lock-icon",AP=mstrmojo.desc(14442,"This metric has its axis scale set to custom min and max values"),O="http://www.w3.org/2000/svg",x="\u2026",N=/[ \-]/;function AU(Aq,As,Al,At){if(!Aq){return ;}var An,Aw,Ao,Av,Ar=Aq.style,Ax=As===AO.TOP,Am=As===AO.BOTTOM,Au=As===AO.LEFT,Ap=As===AO.RIGHT;if(Ax||Am){An=Al;Aw=1;Ao=-1;Av=AS;if(Am){Av+=At;}}else{if(Au||Ap){An=1;Aw=At;Av=-1;Ao=AS;if(Ap){Ao+=Al;}}}Ar.cssText="left:"+Ao+y+";top:"+Av+y+";width:"+An+y+";height:"+Aw+y+";";if(mstrApp.isInVFInteractMode){Ar.cursor="default";}}function I(Am){var Al=String(Am);return Al.indexOf(" ")>=0||Al.indexOf("-")>=0;}function Y(An,Am,Ao){var Al=typeof An==="string"?b.restoreSpecialChars(An):An;return AQ.measureTextWidth(Al,Am,Ao);}function AK(Ap,Ao,Am,Al){var An=Y(Ao,Am,L);Ap.setAttribute("measureWidth",An);if(An>Al){An=Al;}else{Ap.style.overflow="visible";}Ap.setAttribute("displayWidth",An);Ap.style.width=An+y;return An;}function Ag(An,Am){var Al;if(parseInt(An.getAttribute("measureWidth"))>Am){Al=parseInt(An.style.maxHeight);}else{Al=parseInt(An.style.lineHeight);}return Al;}function B(Am){var Al;if(Am.textContent&&typeof (Am.textContent)!==undefined){Al=Am.textContent;}else{Al=Am.innerText;}return Al;}function c(An){var Am=An.getAttribute("measureWidth"),Al=An.getAttribute("displayWidth");if(!Am){An[AB]("title","");}Am=parseFloat(Am,10);Al=parseFloat(Al,10);if((Am-Al)>0.1){An[AB]("title",B(An));}else{An[AB]("title","");}}function AN(Ap,Al,Am,Ao){var An=document.createElement("div");An[AB]("class","gm-legend-underLine");An.style.width=Ao-L+y;An.style.left=Al+5+y;An.style.top=Am+y;Ap.appendChild(An);}function AZ(Ao,Al,Am){var An=document.createElement("div");An[AB]("class","gm-legend-underLine-anchorPoint");An.style.left=Al+y;An.style.top=Am-3+y;Ao.appendChild(An);}function AJ(Ao,Al,Am,An){AN(Ao,Al,Am,An);AZ(Ao,Al,Am);}function n(An,Ay,Au,As,Aw){var At,Ao,Av,Al,Ax=b.restoreSpecialChars(An.innerHTML),Ar=Ax.length,Ap=0,Am=Ar,Aq=false;if(An.scrollHeight>1.5*H){At=Y(An.innerHTML,Ay,L);Ao=At-Au+L;if(Ao>Aw){while((Am-Ap)>1){Av=(Ap+Am)>>1;Al=Ax.substring(0,Av)+x;At=Y(Al,Ay,L);Ao=At-Au+L;if(Ao>Aw){Am=Av;}else{Ap=Av;}}An.innerHTML=Z.encodeHtmlString(Ax.substring(0,Ap)+x,true);An[AB]("title",Ax);Aq=true;At=Y(An.innerHTML,Ay,L);Ao=At-Au+L;}AN(An,0,As+H,(Ao<Aw)?Ao:Aw);}if(Au>Aw){An[AB]("title",Ax);}else{if(!Aq){An[AB]("title","");}}}function AA(Al,Au,Aq,Am,At,Av){var An,Ap,Ar,As,Ao=document.createElement("div");Ao[AB]("class","gm-legend-textcell");Ao[AB]("type",C.LGD_TEXT);Ao.style.lineHeight=f+y;if(At){As=AK(Ao,Au,Av,At);}if(Am&w){An=(AL+AV)/2+Aq*AL;Ar=z;}else{An=(t+AV)/2+Aq*t;if(Am&Ak){if(Am&Ai){Ar=0;}else{Ar=s;}}else{if(Am&h){Ar=Q;}else{Ar=0;}}}Ap=As||s+L;Ao.innerText=Au;Ao.identity={objType:AI.LEGEND_TEXT};AJ(Al,Ar,An,Ap);this.textDivs.push(Ao);Al.appendChild(Ao);}function Ac(Al,Ao){var Am,Aq,Ap,An=0;if(Al){Ap=Al.elements;for(Am=0,Aq=Ap.length;Am<Aq;Am++){An=Math.max(An,Y(Ap[Am].label,Ao,L));}An+=z+A*2+AX;}return An;}function W(Ao,An){var Ar,Al,Aq,Ap=Ao.items,Am=0;if(!Ap){return 0;}Ar=Ap.length;Aq=Ao.custMetrics;for(Al=0;Al<Ar;Al++){if(Aq&&Aq.indexOf(Ap[Al])!==-1){Am=Math.max(Am,Y(Ap[Al],An,L)+Q);}else{Am=Math.max(Am,Y(Ap[Al],An,L));}}return Am;}function AR(Ao,An){var Al,Aq,Ap,Am=0;if(Ao){Ap=Ao.elements;Aq=Ap.length;if(Ao.caseFlag===1){Am=W(Ao,An);}else{if(Ao.caseFlag===0){for(Al=0;Al<Aq;Al++){Am=Math.max(Am,Y("Max: "+Ap[Al].v,An,L));}Am+=t*l;Am=Math.max(Am,W(Ao,An));}else{if(Ao.caseFlag===2){for(Al=0;Al<Aq;Al++){Am=Math.max(Am,Y(Ap[Al].v,An,L));}Am+=t*Aq+s;Am=Math.max(Am,W(Ao,An));}else{if(Ao.caseFlag===3){for(Al=0;Al<Aq;Al++){Am=Math.max(Am,Y(Ap[Al].v,An,L));}Am+=t*u;}}}}Am=Math.max(Am,Y(J,An,L));Am+=A*3;}return Am;}function e(Aw,Ao,A0){if(!Aw||!Aw.length||Aw.length<1){return 0;}var Ap,Am,Az,Al,As,Av,Ar,Au,At,An,Aq,Ay=m+2*Ah,Ax=Ay;for(Ap=0;Ap<Aw.length;Ap++){Ar=Aw[Ap];if(Ar.dataType===Aa.COLOR_BY){Au=Ar.dataObj;if(Au){An=2*AH+H;Az=b.removeExtraSpace(Au.item);Av=Y(Az,A0,L);if((Av+2*A>Ao-2*Ah)&&I(Az)){An+=H;}Al=Au.elements;Am=Al.length;An+=A;An+=i;Al.forEach(function(A1){if(A1.bftp){Af.GMLegend.IMAGE_SIZE_FIXED=G;AL=G;}});Ay+=An+AL*Am;Ax+=An+(Am>0?AL:0);}}else{if(Ar.dataType===Aa.SIZE_BY){At=Ar.dataObj;if(At){Aq=2*AH+H;Az=b.removeExtraSpace(At.item);Av=Y(Az,A0,L);if((Av+2*A>Ao-2*Ah)&&I(Az)){Aq+=H;}As=At.caseFlag;if(As===1){Am=0;}else{if(As===0){Am=2;}else{if(At.caseFlag===2||As===3){Am=At.elements.length;}}}Am+=(At.items&&At.items.length)||0;Aq+=t*Am;Aq+=A;Aq+=i;Ay+=Aq;Ax+=Aq;}}}}return{height:Ay,minHeight:Ax};}function Ad(Al,Am){var Ao=0,An=0;P.forEach(Al||[],function(Ap){var Aq;if(Ap.dataType===Aa.COLOR_BY){Aq=Ac(Ap.dataObj,Am);if(Aq>Ao){Ao=Aq;}}else{if(Ap.dataType===Aa.SIZE_BY){Aq=AR(Ap.dataObj,Am);if(Aq>An){An=Aq;}}}});return Math.max(Ao,An)+2*Ah;}function j(Am,As,Aq,Ap){var An=e(Am,As,Ap),Al=An.height,Ar=Aq-X*2,Ao={};Ao.autoCollapse=An.minHeight>Ar;Ao.minHeight=An.minHeight;Ao.width=As;Ao.height=Math.min(Al,Ar);if(Al>Ar){Ao.cutBy=Al-Ar;}return Ao;}function E(Am,An){var Ao=Am.decodedColor||Am.color||AD.VAL_AUTOMATIC,Al;if(Ao.c1){Al=Ae.buildGradient(Ao.or,Ao.c1,Ao.c2);An.style[Ae.convertCssToCamelCase(Al.n)]=Al.v;}else{An.style.backgroundColor=Ao;}if(Am.image){An.style.backgroundImage=Am.image;}if(Am.opacity!==undefined){An.style.opacity=Am.opacity;}An.identity=new g({objType:AI.COLOR_SQUARE,parentIdentity:this.identity,token:Am.token,decodedColor:Am.decodedColor,encodedColor:Am.encodedColor,isDefaultColor:Am.isDefaultColor});}function AW(){var A0,Ax,Av,Al,Aw,A2,Am,At,Ar,Ao,A4=document,A3=this.triBtn,Az=this.closeBtn,Aq=this.cbContainer,An=this.sb1Container,Ay=this.sb2Container,As=this.cbTableContainer,Ap=null,A1=this.height-m-A-2*Ah,Au=this.width-2*A-2*Ah;A3[AB]("class","gm-legend-tri-button-collapsed");if(this.autoCollapse){A3[AB]("title",mstrmojo.desc(13682,"There is not enough space to display the legend"));}else{A3[AB]("title",mstrmojo.desc(13683,"Maximize Legend"));}Az.style.display="none";this.splitter.style.display="none";this.domNode.style.overflow="hidden";for(A0=0;this.dataArray&&A0<this.dataArray.length;A0++){Al=this.dataArray[A0];if(Al.dataType===Aa.COLOR_BY){Ap=Al.dataObj;break;}}Aq.style.display=Ap?"block":"none";An.style.display="none";Ay.style.display="none";if(Ap){Av=Ap.elements;Ax=Av.length;Aw=this.cbTitle;Aw.style.display="none";Aq.style.top=m+y;Aq.style.width=Au+y;As.style.top="0px";A2=this.cbTable;A2.innerHTML="";for(A0=0;A0<Ax;A0++){Am=A4.createElement("tr");At=A4.createElement("td");Ao=A4.createElement("div");Ar=A4.createElement("div");Ao[AB]("class","gm-legend-colorbox-ctn-div");Ao[AB]("type",C.LGD_COLORBOX_CTN);Ao[AB]("title",Av[A0].label);Ar[AB]("class","gm-legend-colorbox-div");Ar[AB]("type",C.LGD_COLORBOX);E.call(this,Av[A0],Ar);Am[AB]("class","gm-legend-tr");Am.style.height=AL+y;At[AB]("class","gm-legend-colorbox");Ao.appendChild(Ar);At.appendChild(Ao);Am.appendChild(At);A2.appendChild(Am);if(A2.offsetHeight+AL>A1){break;}}A2.style.top="0px";A2.style.marginLeft="0px";As.style.top=A+y;As.style.height=A2.offsetHeight+y;}Aq.style.height=A1+y;}function p(An,Am,Ap,Al){var Ao=document.createElementNS(O,"circle");Ao.setAttribute("cx",Am);Ao.setAttribute("cy",Ap);Ao.setAttribute("r",Al);Ao.setAttribute("class","gm-legend-sizeby-circle");An.appendChild(Ao);}function AF(An,Ao,Ar,Am,Aq,As,Ap){var Al=document.createElementNS(O,"line");Al.setAttribute("x1",Ao);Al.setAttribute("y1",Ar);Al.setAttribute("x2",Am);Al.setAttribute("y2",Aq);Al.style.strokeWidth=As;if(Ap){Al.setAttribute("class",Ap);}An.appendChild(Al);}function Ab(Am,A0){var Az,An,Ap,Aq,Ao,Al,Ay,Ar,A1,As,Aw=Math.PI,At=A0.elements,Au=At.length,Av=Au*t,Ax=Am.getContext("2d"),A2={LINE_COLOR:"#b0b0b0",MIN_WIDTH:1,MAX_WIDTH:10},A3=AQ.getPropertyByPath(this,"widget.model.data.visName")||AQ.getPropertyByPath(this,"widget.model.data.vis.vn");switch(A3){case"GraphMatrixVisualizationStyle":if(this.shapeType===AG.SQUARE||this.shapeType===AG.TICK||this.shapeType===AG.LINE||this.shapeType===AG.BAR||this.shapeType===AG.AREA||this.shapeType===AG.RECTANGLE){As="rectangle";}else{As="circle";}break;case"VIHeatMapVisualizationStyle":As="rectangle";break;default:As="circle";break;}switch(A0.caseFlag){case 0:Ax.save();if(mstrApp.getThemeClassName().indexOf("dark")>=0){Ax.strokeStyle="rgba(116, 116, 117, 0.7)";Ax.fillStyle="rgba(116, 116, 117, 0.7)";}else{Ax.strokeStyle="rgba(188, 188, 189, 0.7)";Ax.fillStyle="rgba(188, 188, 189, 0.7)";}Av=t*l;A1=Math.floor(t*0.75+0.5);An=Math.floor(A1/3.5+0.5);if(As==="circle"){Aq=A1+1;Ao=t;Ax.beginPath();Ax.arc(Aq,Ao,A1,0,2*Aw,false);Ax.fill();Ax.stroke();Aq=2*Aq+2*An;Ao=Math.floor(0.53*t+0.5);Ax.beginPath();Ax.arc(Aq,Ao,An,0,2*Aw,false);Ax.fill();Ax.stroke();}else{Aq=1;Ao=t-A1;Ax.beginPath();Ax.fillRect(Aq,Ao,2*A1,2*A1);Aq=2*A1+2+An;Ao=Math.floor(0.53*t-An+0.5);Ax.beginPath();Ax.fillRect(Aq,Ao,2*An,2*An);}Ax.translate(0.5,0.5);Ax.lineWidth=1;Ax.strokeStyle="#9C9C9C";Aq=2*A1+3*An+3;Ao=Math.floor(0.53*t+0.5);Ax.beginPath();Ax.moveTo(Aq,Ao);Ax.lineTo(Av,Ao);Ax.stroke();Aq=2*A1+2;Ao=Math.floor(1.53*t-An+0.5);Ax.beginPath();Ax.moveTo(Aq,Ao);Ax.lineTo(Aq+An,Ao+An);Ax.lineTo(Av,Ao+An);Ax.stroke();Ax.restore();break;case 1:break;case 2:Ap=parseInt(At[0].diameter,10);Ap=Math.min(Ap,Av);Ax.fillStyle="#ADADAC";Ax.strokeStyle="#ADADAC";if(As==="circle"){Aq=Av>>1;Ao=Aq;Ax.arc(Aq,Ao,Ap>>1,0,2*Aw,false);Ax.fill();Ax.stroke();}else{Aq=(Av-Ap)>>1;Ao=Aq;Ax.rect(Aq,Ao,Ap,Ap);Ax.fill();Ax.stroke();}break;case 3:Al=A2.MIN_WIDTH;Ay=(Au===1?0:(A2.MAX_WIDTH-A2.MIN_WIDTH)/(Au-1));Av=Am.width;Ar=t;Aq=0;Ao=t/2;Ax.strokeStyle=A2.LINE_COLOR;for(Az=0;Az<Au;Az++){Ax.lineWidth=Al;Ax.beginPath();Ax.moveTo(Aq,Ao);Ax.lineTo(Av-Aq,Ao);Ax.stroke();Ao+=Ar;Al+=Ay;}break;default:break;}}function AY(Am,Au){var As=1,Al,Aq=1.5*H,At=Am.innerHTML,Ar=b.restoreSpecialChars(At),An=Ar.split(N),Av,Ao;var Ap=function(Aw){Ao=Ar[Aw];return Ao!==undefined?Ao:"";};if(Am.scrollHeight>Aq){if(!An[0]){return 0;}Al=An[0]+Ap(An[0].length);while(An[As]!==undefined){Av=Al+An[As];Av+=Ap(Av.length);Am.innerHTML=b.replaceSpecialChars(Av);if(Am.scrollHeight>Aq){break;}Al=Av;As++;}Am.innerHTML=At;}else{Al=Ar;}return Y(Al,Au,L);}function d(A1,Az,A0,Av){var Ay,An,Aq,Ap,Au,Ax,At=Az.elements,Aw=At.length,As=[],A2=document,Al=A2.createDocumentFragment(),Ao=false,Ar=this.styles,Am=A0;switch(Av){case 0:if(Aw>0){As.push({v:"Min: "+At[Aw-1].v});As.push({v:"Max: "+At[0].v});Aw=2;}break;case 1:At=Az.items;P.forEach(At,function(A3){As.push({v:A3});});break;case 3:As=At;break;default:As=At;Ao=true;break;}Aw=As.length;for(Ay=0;Ay<Aw;Ay++){An=A2.createElement("tr");An[AB]("class","gm-legend-tr2");An.style.height=t+y;if(Ao){Aq=A2.createElement("td");AA.call(this,Aq,As[Ay].sign,Ay,R|Ak|Ai);Aq[AB]("class","gm-legend-sign");An.appendChild(Aq);Am-=s;}Ap=A2.createElement("td");Ap[AB]("class","gm-legend-desc");if(Az.custMetrics&&Az.custMetrics.indexOf(As[Ay].v)!==-1){AA.call(this,Ap,As[Ay].v,Ay,R|h,Am-Q,Ar);Ax=parseInt(Ap.lastChild.style.width,10);Au=A2.createElement("div");Au.setAttribute("class",AT);Au.setAttribute("title",AP);Ap.appendChild(Au);Au.style.top=(t-8)/2+Ay*t+y;Ap.lastChild.style.marginLeft=Ax+y;}else{if(Ao){AA.call(this,Ap,As[Ay].v,Ay,R|Ak,Am,Ar);}else{AA.call(this,Ap,As[Ay].v,Ay,R,Am,Ar);}}An.appendChild(Ap);Al.appendChild(An);}A1.appendChild(Al);}function V(){var An="."+AT,Al=this.domLegend.querySelectorAll(An),Am;P.forEach(Al,function(Ao){Am=Ao.parentNode;if(Am){Am.removeChild(Ao);}});}function U(){var BE,A6,BJ=0,BK,A1,A8,A2,Ao,BC,BF,As,BI,BD,Al=this.width-2*Ah,Aw=Al-2*A,Aq=document,An=this.triBtn,A7=this.closeBtn,A5=this.cbContainer,Ax=this.cbTableContainer,BL=this.sb1Container,Ar=this.sb2Container,Av,At,Ap,Au,BA,Az,A9=this.cutBy,A4=m,BG=0,A3=this.styles,BB,BH,A0=(H+AV)/2,Am,Ay;An[AB]("class","gm-legend-tri-button");An[AB]("title",mstrmojo.desc(13684,"Minimize Legend"));A7.style.display="block";A7[AB]("title",mstrmojo.desc(12002,"Hide Legend"));this.updateSplitter();V.call(this);this.domNode.style.overflow="visible";A5.style.display="none";BL.style.display="none";Ar.style.display="none";for(A6=0;this.dataArray&&A6<this.dataArray.length;A6++){At=this.dataArray[A6];BA=null;Az=null;if(At.dataType===Aa.COLOR_BY){BA=At.dataObj;if(BA){A5.style.display="block";A2=b.removeExtraSpace(BA.item);Ao=BA.elements;BE=Ao.length;A5.style.top=A4+y;A5.style.width=Aw+y;BI=0;if(BG===0){Ae.addClass(this.sepLine1,"toggleHide");BG++;}BK=this.cbTitle;BK.style.display="block";AK(BK,A2,A3,Aw);BK.innerHTML=Z.encodeHtmlString(A2,true);BI+=Ag(BK,Aw)+2*AH;Am=AY(BK,A3);n(BK,A3,Am,A0,Aw);AJ(BK,0,A0,(Am<Aw)?Am:Aw);A1=this.cbTable;A1.style.display="block";A1.style.width=(Aw-AX)+y;A1.style.marginLeft=AX+y;A1.innerHTML="";A1.appendChild(this.fillColorByTable(BA,0));BC=AL*BE+1;Ax.style.top=BI+y;A1.style.display="table";BI+=BC+A;if(A9){BI-=A9;BC-=A9;}A5.style.height=BI+y;Ax.style.height=BC+y;A4+=BI+i;}}else{if(At.dataType===Aa.SIZE_BY){Az=At.dataObj;if(Az){BJ++;if(BJ===1){Ap=BL;Au=this.sb1Title;A8=this.sb1MetricNamesTable;A1=this.sb1DataTable;Av=this.sb1Canvas;}else{Ap=Ar;Au=this.sb2Title;A8=this.sb2MetricNamesTable;A1=this.sb2DataTable;Av=this.sb2Canvas;}Ap.style.display="block";A2=b.removeExtraSpace(Az.item);Ao=Az.elements;BE=Ao.length;Ap.style.top=A4+y;Ap.style.width=Aw+y;BI=0;if(BG===0){Ae.addClass(this.sepLine2,"toggleHide");BG++;}if(Az.caseFlag===0){BF=l*t;As=2*t;}else{if(Az.caseFlag===3){BF=u*t;As=BE*t;}else{BF=BE*t;As=BF;}}BK=Au;BK.innerHTML=Z.encodeHtmlString(A2,true);BH=Az.custMetrics&&Az.custMetrics.indexOf(A2)!==-1;if(BH){Ay=Aw-Q;}else{Ay=Aw;}AK(BK,A2,A3,Ay);if(BH){BB=Aq.createElement("div");BB.setAttribute("class",AT);BB.setAttribute("title",AP);Ap.appendChild(BB);BB.style.top=(BK.offsetHeight-8)/2+AH+i+y;BB.style.left=BK.offsetWidth+"px";}Am=AY(BK,A3);n(BK,A3,Am,A0,Ay);AJ(BK,0,A0,(Am<Ay)?Am:Ay);BI+=Ag(BK,Ay)+2*AH;BD=Aw;A8.innerHTML="";if(Az.items&&Az.items.length>0){A8.style.display="block";d.call(this,A8,Az,BD,1);}else{A8.style.display="none";}A8.style.top=BI+y;A8.style.left="0"+y;A8.style.width=BD+y;BI+=A8.offsetHeight;if(BF>0){BD-=BF+A;}A1.innerHTML="";if(Az.elements&&Az.elements.length>0){A1.style.display="block";d.call(this,A1,Az,BD,Az.caseFlag);}else{A1.style.display="none";}Av.style.position="absolute";Av.style.top=BI+y;Av.style.marginLeft=A+y;A1.style.top=BI+y;A1.style.left=(BF+A)+y;A1.style.width=BD+y;BI+=As+A;Ap.style.height=BI+y;A1.style.display="table";Av.width=BF;Av.height=As;Ab.call(this,Av,Az);A4+=BI+i;}}}}}function q(){var Al,Am=this.textDivs,An=Am.length;for(Al=0;Al<An;Al++){c(Am[Al]);}}mstrmojo.gm.GMLegend=mstrmojo.declare(mstrmojo.VisLegend,[mstrmojo._FormateVisLegend,mstrmojo.ui._HasScroller],{scriptClass:"mstrmojo.gm.GMLegend",cssClass:"gm-legend",dropZoneHighlightCss:"gm-legend-slot",dockedPositions:null,dockPos:AO.LEFT,GMW:0,GMH:0,isMinimal:false,shapeType:undefined,legendMarkup:'<div class="gm-legend-button"><div class="gm-legend-tri-button"></div><div class="gm-legend-name"></div><div class="gm-legend-close-button"></div></div><div class="gm-legend-container"><div class="gm-legend-separator-line" style="width:{@coreWidth}px"></div><div class="gm-legend-title" type="lgd-title" style="line-height:{@lineHeight}px; max-height:{@maxHeight}px"></div><div class="gm-legend-table-container"><table class="gm-legend-table"></table></div></div><div class="gm-legend-container"><div class="gm-legend-separator-line" style="width:{@coreWidth}px"></div><div class="gm-legend-title" type="lgd-title" style="line-height:{@lineHeight}px; max-height:{@maxHeight}px"></div><table class="gm-legend-table"></table><table class="gm-legend-table"></table><canvas type="lgd-canvas"></canvas></div><div class="gm-legend-container"><div class="gm-legend-separator-line" style="width:{@coreWidth}px"></div><div class="gm-legend-title" type="lgd-title" style="line-height:{@lineHeight}px; max-height:{@maxHeight}px"></div><table class="gm-legend-table"></table><table class="gm-legend-table"></table><canvas type="lgd-canvas"></canvas></div><div class="gm-legend-resizer-v" draggable="false"></div><div class="gm-legend-resizeRect"></div>',init:function AE(Am){this.styles={};this.cutBy=null;this.dataArray=null;this.textDivs=[];this.dockedPositions=[{pos:o.LEFT_TOP},{pos:o.LEFT_MIDDLE},{pos:o.LEFT_BOTTOM},{pos:o.RIGHT_TOP},{pos:o.RIGHT_MIDDLE},{pos:o.RIGHT_BOTTOM}];var An=Am.placeholder,Al=An.style;if(An){this.cssClass=An.getAttribute("class");if(!this.cssClass){this.cssClass="";}if(Am.hasOwnProperty("width")===false){Am.width=(Al&&Al.width)||An.clientWidth;}if(Am.hasOwnProperty("height")===false){Am.height=(Al&&Al.height)||An.clientHeight;}if(Am.hasOwnProperty("left")===false){Am.left=An.offsetLeft;}if(Am.hasOwnProperty("top")===false){Am.top=An.offsetTop;}}this._super(Am);},setupScrollNodes:function M(){this.scrollNode=this.cbTableContainer;},getSplitterDockPos:function(){return(this.currDockedPositionIdx<3)?AO.RIGHT:AO.LEFT;},updateAlignClass:function(){var Ap=this.getDockedPosition(),Aq=Ap&&Ap.pos,An=(Aq===o.RIGHT_MIDDLE||Aq===o.RIGHT_TOP||Aq===o.RIGHT_BOTTOM||Aq===o.RIGHT),Al=this.domLegend,Am=this.domNode,Ao=this.resizeRect;if(An){Ae.removeClass(Al,"gm-align-left");Ae.addClass(Al,"gm-align-right");Ae.toggleClass(Al,"gm-legend-alignRight",true);Ae.toggleClass(Al,"gm-legend-alignLeft",false);Ae.toggleClass(Am,"gm-legend-alignRight",true);Ae.toggleClass(Am,"gm-legend-alignLeft",false);Ae.toggleClass(Ao,"gm-legend-alignRight",true);Ae.toggleClass(Ao,"gm-legend-alignLeft",false);}else{Ae.removeClass(Al,"gm-align-right");Ae.addClass(Al,"gm-align-left");Ae.toggleClass(Al,"gm-legend-alignRight",false);Ae.toggleClass(Al,"gm-legend-alignLeft",true);Ae.toggleClass(Am,"gm-legend-alignRight",false);Ae.toggleClass(Am,"gm-legend-alignLeft",true);Ae.toggleClass(Ao,"gm-legend-alignRight",false);Ae.toggleClass(Ao,"gm-legend-alignLeft",true);}},postBuildRendering:function(){this._super();var Ax=this.styles,Az=this.domNode,Ao=this.domLegend.childNodes,As=Ao[1],Aq=Ao[2],Ay=Ao[3],A2={objType:AI.LEGEND};this.addSlots({lgdBtn:Ao[0],triBtn:Ao[0].firstChild,lgdName:Ao[0].childNodes[1],closeBtn:Ao[0].lastChild,cbContainer:Ao[1],sepLine1:As.firstChild,cbTitle:As.childNodes[1],cbTableContainer:As.childNodes[2],cbTable:As.childNodes[2].firstChild,sb1Container:Aq,sepLine2:Aq.firstChild,sb1Title:Aq.childNodes[1],sb1MetricNamesTable:Aq.childNodes[2],sb1DataTable:Aq.childNodes[3],sb1Canvas:Aq.childNodes[4],sb2Container:Ay,sepLine3:Ay.firstChild,sb2Title:Ay.childNodes[1],sb2MetricNamesTable:Aq.childNodes[2],sb2DataTable:Ay.childNodes[3],sb2Canvas:Ay.childNodes[4],splitter:Ao[4],resizeRect:Ao[5]});Af.GMLegend.applyHTML5Props(Ax);this.bgColor=Ax.background||Ax.backgroundColor||"transparent";AQ.applyStyle2Legend(Ax,Az,this.domLegend);if(mstrApp.isInVFInteractMode){this.closeBtn.style.visibility="hidden";}var Ar=this.getSplitterDockPos(),A1=this.width-2*A-2*Ah,At=this.cbTitle,Am=At.style,An=this.sb1Title,Ap=this.sb2Title,A0=An.style,Al=Ap.style,Aw=this.sepLine1,Av=this.sepLine2,Au=this.sepLine3;Aw.style.width=A1+y;Av.style.width=A1+y;Au.style.width=A1+y;Am.lineHeight=H+y;A0.lineHeight=H+y;Al.lineHeight=H+y;Am.maxHeight=2*H+y;A0.maxHeight=2*H+y;Al.maxHeight=2*H+y;At.identity={objType:AI.LEGEND_TEXT,parentIdentity:A2};An.identity={objType:AI.LEGEND_TEXT,parentIdentity:A2};Ap.identity={objType:AI.LEGEND_TEXT,parentIdentity:A2};this.dockPos=Ar;this.identity=Az.identity=A2;this.updateAlignClass();},feedData:function(Al,Am){this.dataArray=Al;this.isMinimal=Am;this.textDivs=[];Af.GMLegend.applyHTML5Props(this.styles);this.autoCollapseLegend();if(Am||this.autoCollapse){AW.call(this);this.draggable=false;}else{U.call(this);this.draggable=true;}q.call(this);this.updateScrollbars();},autoCollapseLegend:function(){this.autoCollapse=false;},updateColorBySquare:function(An){var Ao,Ap,Am,Al;if(An){Al=this.domNode.querySelectorAll(".gm-legend-colorbox-div");Ao=An.elements;Ap=Math.min(Ao.length,Al.length);for(Am=0;Am<Ap;Am++){E.call(this,Ao[Am],Al[Am]);}}},updateContainerSize:function(Al,Am){this.GMW=Al;this.GMH=Am;this.calculateDockedPositions(Al,Am);},updateAfterResize:function(){Af.GMLegend.applyHTML5Props(this.styles);var Aq=0,Ap=this.width,Ar=this.cbContainer,At=this.sb1Container,An=this.sb2Container,Ao=this.sepLine1,Am=this.sepLine2,Al=this.sepLine3,As=Ap-2*A-2*Ah;P.forEach(this.dataArray||[],function(Au){if(Au.dataType===Aa.COLOR_BY){if(Au.dataObj){if(Ar){Ar.style.width=As+y;}}}else{if(Au.dataType===Aa.SIZE_BY){if(Au.dataObj){Aq++;if(Aq===1&&At){At.style.width=As+y;}if(Aq===2&&An){An.style.width=As+y;}}}}});if(Ao){Ao.style.width=As+y;}if(Am){Am.style.width=As+y;}if(Al){Al.style.width=As+y;}this.domLegend.style.width=this.width+y;this.domLegend.style.height=this.height+y;},updateStyle:function(Al){this.styles=Al;this.bgColor=Al.background||Al.backgroundColor||"transparent";AQ.applyStyle2Legend(Al,this.domNode,this.domLegend);},updateTitleLineHeight:function(){var Am=this.cbTitle,Ap=Am.style,An=this.sb1Title,Al=this.sb2Title,Aq=An.style,Ao=Al.style;Af.GMLegend.applyHTML5Props(this.styles);Ap.lineHeight=H+y;Aq.lineHeight=H+y;Ao.lineHeight=H+y;Ap.maxHeight=2*H+y;Aq.maxHeight=2*H+y;Ao.maxHeight=2*H+y;},getSplitterPosition:function(An){var Am=An.src.startPos+An.tgt.pos.x-An.src.pos.x,Ap=An.src.posInfo,Ao=Ap&&Ap.min,Al=Ap&&Ap.max;if(Ao!==undefined){Am=Math.max(Am,Ao);}if(Al!==undefined){Am=Math.min(Am,Al);}return Am;},positionResizeRect:function(Al,Am){var Ao=Al.src.posInfo.dockPosition===AO.LEFT,Ap=Am-AS,Aq=Ao?Ap:0,An=Ao?this.width-Ap:Ap;this.resizeRect.style.left=(Aq-1)+y;this.resizeRect.style.width=(An-2)+y;},updateLegendSlot:function(Ao,Al){var An=this.getDockedPosition(),Am=An&&An.pos;if(Am!==Ao){this.currDockedPositionIdx=Al;this.dockPos=this.getSplitterDockPos();this.updateDropZonePosition();this.updateAlignClass();this.updateSplitter();this.widget.onLegendDropZoneChange(this.getDockedPosition());}},isDragValid:function r(Al){return !mstrApp.isInVFInteractMode&&this._super(Al);},ondragstart:function(Al){var An=Al.src.e.target,Am=Al.src.data;if(this.widget&&this.widget.setInteractive){this.widget.setInteractive(false);}if(An===this.splitter){Al.src.startPos=An.offsetLeft;Al.src.posInfo=this.getSplitterInfo(An);this.positionResizeRect(Al,Al.src.startPos);Ae.addClass(this.resizeRect,"resizing");}else{this.cbTableScrollTop=this.cbTableContainer.scrollTop;this._super(Al);if(!Am||!Am.isScrollBar){this.clearSelectedTargets();Ae.toggleClass(this.domNode,"gm-legend-hover",false);Ae.toggleClass(this.domLegend,"active",false);this.cbTableContainer.scrollTop=this.cbTableScrollTop;this.domLegend.style.background=this.bgColor;this.isDragging=true;}}},ondragmove:function D(Al){var An=Al.src.e.target,Am;if(An===this.splitter){Am=this.getSplitterPosition(Al);An.style.left=Am+y;this.positionResizeRect(Al,Am);}else{this._super(Al);}},ondragend:function(Al){var An=Al.src.e.target;if(An===this.splitter){Ae.removeClass(this.resizeRect,"resizing");this.splitterMoved(this.getSplitterPosition(Al)-Al.src.startPos,Al.src.posInfo);}else{this._super(Al);var Am=Al.src.data;if(!Am||!Am.isScrollBar){this.cbTableContainer.scrollTop=this.cbTableScrollTop;this.domLegend.style.background="transparent";this.isDragging=false;}delete this.cbTableScrollTop;}if(this.widget&&this.widget.setInteractive){this.widget.setInteractive(true);}},onscroll:function(){var Am,Aq,Ap=this.scrollNode.scrollTop,Ao,An,Al;if(this.prevScrpllTop===Ap){return ;}Aq=(this.dataArray&&this.dataArray.length)||0;for(Am=0;Am<Aq;Am++){An=this.dataArray[Am];if(An.dataType===Aa.COLOR_BY){Al=An.dataObj;break;}}if(Al){Ao=this.cbTable;Ao.innerHTML="";Ao.appendChild(this.fillColorByTable(Al,Math.floor(Ap/AL)));this.prevScrpllTop=Ap;this.scrollNode.scrollTop=Ap;this._super();}},fillColorByTable:function(A1,Ar){var A2,Az,An,Aq,Ap,As,At,Au=this.styles,Al,Ax=this.cutBy,Av=this.width-2*Ah-2*A,Aw,Ao,Am,A3,Ay,A4;Aw=A1.elements;Az=Aw.length;Al=document.createDocumentFragment();Ao=Av-z-AX;Am=0;A3=AL*Az;Ay=Ar*AL;function A0(A5){An=document.createElement("tr");Aq=document.createElement("td");An.style.height=A5+y;Aq[AB]("class","gm-legend-colorbox");An.appendChild(Aq);Al.appendChild(An);}if(Ar>0){A0(Ay);}for(A2=Ar;A2<Az;A2++){An=document.createElement("tr");Aq=document.createElement("td");Ap=document.createElement("td");As=document.createElement("div");At=document.createElement("div");As[AB]("class","gm-legend-colorbox-ctn-div");As[AB]("type",C.LGD_COLORBOX_CTN);At[AB]("class","gm-legend-colorbox-div");At[AB]("type",C.LGD_COLORBOX);E.call(this,Aw[A2],At);An[AB]("class","gm-legend-tr");An.style.height=AL+y;Aq[AB]("class","gm-legend-colorbox");Ap[AB]("class","gm-legend-desc");A4=Aw[A2];if(A4.bftp){b.fillImageInDiv(Ap,A4.bftp,A4.label,"gm-img-legend");}else{AA.call(this,Ap,A4.label,A2,w,Ao,Au);}As.appendChild(At);Aq.appendChild(As);An.appendChild(Aq);An.appendChild(Ap);Al.appendChild(An);Am+=AL;if(Ax&&(Ax+Am-AL)>A3){A0(A3-Am-Ay);break;}}return Al;},calculateDockedPositions:function(Am,Ap){var Ao,Ar=this.getWidth(),Al=this.getHeight(),An=this.dockedPositions,Aq=function(As){switch(As.pos){case k.LEFT_TOP:As.x=0;As.y=X;break;case k.LEFT_MIDDLE:As.x=0;As.y=Math.max(X,(Ap-Al)>>1);break;case k.LEFT_BOTTOM:As.x=0;As.y=Math.max(0,Ap-Al-X);break;case k.RIGHT_TOP:As.x=Am-Ar;As.y=X;break;case k.RIGHT_MIDDLE:As.x=Am-Ar;As.y=Math.max(X,(Ap-Al)>>1);break;case k.RIGHT_BOTTOM:As.x=Am-Ar;As.y=Math.max(0,Ap-Al-X);break;}};for(Ao=0;Ao<An.length;Ao++){Aq(An[Ao]);}this.updateDropZonePosition();},updateDropZonePosition:function(){var Al=this.getDockedPosition(),Am=this.dropZoneNode.style;Am.left=Al.x+y;Am.top=Al.y+y;},updateDropZoneNode:function(Al){this._super(Al);this.dockPos=this.getSplitterDockPos();this.updateSplitter();},onmouseover:function(Al){var An=this.domLegend,Ar=Al.getTarget(),Ao=Ar.getAttribute("type"),Aq=this.widget,Am;if(this.isDragging){return ;}var Ap=S.copy(this.styles);Ap.opacity+=0.4;AQ.applyStyles2DomNode(this.domNode,Ap);if(AC.contains(An,Ar,true)){Ae.addClass(An,"active");}if(Ao===C.LGD_COLORBOX){Ar=Ar.parentNode;Ao=Ar.getAttribute("type");}if(Ao===C.LGD_COLORBOX_CTN){Am=Ar.firstChild.identity;if(!Am||!Am.comb){return ;}Ae.toggleClass(Ar,"hover-colorsquare",true);return ;}if(Aq.formattingMode){switch(Ao){case C.LGD_TITLE:case C.LGD_TEXT:Ae.toggleClass(An,"hover-txt",true);break;default:Ae.toggleClass(this.domNode,"gm-legend-hover",true);break;}}},onmouseout:function(Am){var Ao=this.domLegend,Al=Am.e.toElement||Am.e.relatedTarget,Ar=Am.getTarget(),Ap=Ar.getAttribute("type"),Aq=this.widget,An;AQ.applyStyles2DomNode(this.domNode,this.styles);if(!AC.contains(Ao,Al,true)){Ae.removeClass(Ao,"active");}if(Ap===C.LGD_COLORBOX){Ar=Ar.parentNode;Ap=Ar.getAttribute("type");}if(Ap===C.LGD_COLORBOX_CTN){An=Ar.firstChild.identity;if(!An||!An.comb){return ;}Ae.toggleClass(Ar,"hover-colorsquare",false);return ;}if(Aq.formattingMode||Aq.isOnFormattingMode){switch(Ap){case C.LGD_COLORBOX_CTN:case C.LGD_COLORBOX:break;case C.LGD_TITLE:case C.LGD_TEXT:Ae.toggleClass(Ao,"hover-txt",false);break;default:Ae.toggleClass(this.domNode,"gm-legend-hover",false);break;}}},onclick:function(Al){var Ao=Al.getTarget(),Am=Ao.getAttribute("type"),An=this.widget;if(Ao===this.triBtn){if(!this.autoCollapse){this.raiseEvent({name:"gm-legend-clicked",action:(this.isMinimal?"restore":"minimize")});}}else{if(Ao===this.closeBtn){this.raiseEvent({name:"gm-legend-clicked",action:"close",mousePos:Al.e});}else{if(Am===C.LGD_COLORBOX){Ao=Ao.parentNode;Am=Ao.getAttribute("type");}if(An.formattingMode||An.isOnFormattingMode){if(Am===C.LGD_COLORBOX_CTN){this.selectColorBox(Ao,true);}else{if(Am===C.LGD_TEXT||Am===C.LGD_TITLE){this.selectText();}else{this.selectLegendBody();}}}else{this.clearSelectedColorBox();}}}AC.stopPropogation(null,Al.e);},attachClearEvent:function(){if(this.clearSelectTargetfn){return ;}var Am=this,Al=this.domLegend;this.clearSelectTargetfn=function(Aq){var Ap=Aq.target,An=Am.widget.toolEditor,Ao;if(!AC.contains(Al,Ap,true,Al)){if(An){Ao=An.domNode;if(!AC.contains(Ao,Ap,true,Ao)){Am.clearSelectedTargets();}}else{Am.clearSelectedTargets();}}};AC.attachEvent(document.body,"mousedown",this.clearSelectTargetfn,true);},clearSelectedColorBox:function(){var Al=this.selectedColorBox;if(Al){Ae.toggleClass(Al,"select",false);Ae.toggleClass(Al,"selectfmt",false);this.selectedColorBox=undefined;}},clearSelectedText:function(){Ae.removeClass(this.domNode,"select-txt");},clearSelectedLegendBody:function(){Ae.removeClass(this.domNode,"gm-legend-select");},clearSelectedTargets:function(){this.clearSelectedColorBox();this.clearSelectedText();this.clearSelectedLegendBody();if(this.clearSelectTargetfn){AC.detachEvent(document.body,"mousedown",this.clearSelectTargetfn,true);delete this.clearSelectTargetfn;}},selectColorBox:function(An,Am){var Al=An.firstChild.identity;if(!Al||!Al.comb){return ;}this.clearSelectedText();this.clearSelectedLegendBody();if(this.selectedColorBox!==An){this.clearSelectedColorBox();this.selectedColorBox=An;if(Am){Ae.toggleClass(An,"selectfmt",true);}else{Ae.toggleClass(An,"select",true);}this.attachClearEvent();}},selectText:function(){this.clearSelectedColorBox();this.clearSelectedLegendBody();Ae.addClass(this.domNode,"select-txt");this.attachClearEvent();},selectLegendBody:function(){this.clearSelectedColorBox();this.clearSelectedText();Ae.addClass(this.domNode,"gm-legend-select");this.attachClearEvent();},adjustColorPickerPos:function(Al){var Ao=AC.position(Al),Am=0,An={};if(this.currDockedPositionIdx<3){An.x=Ao.x+Ao.w+Am;An.alignLeft=true;}else{An.x=Ao.x-Am;An.alignLeft=false;}An.y=Ao.y+Ao.h+Am;return An;},getSplitterInfo:function(Aq){if(!Aq){return{};}var Am=this.dockPos,Ap={},Ao=this.width,Al=AM,An=Math.floor(this.GMW/3);Ap.dockPosition=Am;if(Am===AO.LEFT){Ap.min=Math.min(Ao-An,0);Ap.max=Math.max(Ao-Al,0);}else{if(Am===AO.RIGHT){Ap.min=Al;Ap.max=An;}}Ap.min+=AS;Ap.max+=AS;return Ap;},splitterMoved:function(Al,Am){if(Al===0){return ;}if(Am.dockPosition===AO.LEFT){Al=-Al;}this.raiseEvent({name:"gm-legend-resized",position:Al});this.updateSplitter();if(this.widget&&this.widget.setInteractive){this.widget.setInteractive(true);}},updateSplitter:function(){AU(this.splitter,this.dockPos,this.width,this.height);this.resizeRect.style.height=this.height-2+y;}});Af.GMLegend.IMAGE_SIZE_FIXED=0;Af.GMLegend.applyHTML5Props=function(An){var Ao=parseInt(An.fontSize,10)||8,Am;if(An.fontSize.indexOf("px")>=0){Ao=Math.floor(Ao*a+0.5);}Am=Math.floor(Ao/a*F+0.5);H=Math.max(Ao,8)+9;AV=Math.floor(Ao/a+0.5);f=Math.max(Am,15);AL=Af.GMLegend.IMAGE_SIZE_FIXED||(Math.max(Am,20)+2);t=Math.max(Am,14)+2;Ah=parseInt(An.borderWidth,10)||1;var Al=parseInt(An.tbHeight,10);m=isNaN(Al)?K:Al;};Af.GMLegend.getLegendSize4MinMode=function(Am,An){var Ap,Ao,Al=m+2*Ah;if(Am){Ao=Am.elements;Ap=Ao.length;Al+=AL*Ap;Al+=2*A;}Al=Math.min(Al,An-X*2);return{width:z+5+7+2*Ah,height:Al};};Af.GMLegend.getLegendSize=function(Az,Ao,Al,Ar,A1,As){var At,Am,A0,Aq,Ap=Ar-X*2,Ax=0,An=0,Aw={},Av,Au,Ay;if(!Az||!Az.length||Az.length<1){return{};}if(Ao!==undefined){if(!As){As=Math.floor(Ad(Az,A1)*Ao);}Aq=Math.min(As,Math.floor(Al/3));Aq=Math.max(Aq,50);return j(Az,Aq,Ar,A1);}Aq=Math.min(Math.floor(0.2*Al),300);for(At=0;At<Az.length;At++){Au=Az[At];if(Au.dataType===Aa.COLOR_BY){Av=Ac(Au.dataObj,A1);if(Av>Ax){Ax=Av;}}else{if(Au.dataType===Aa.SIZE_BY){Av=AR(Au.dataObj,A1);if(Av>An){An=Av;}}}}Am=Math.max(Ax,An)+2*Ah;Aw.width=Math.min(Am,Aq);Aw.scale=Aw.width/Am;Ay=e(Az,Aw.width,A1);A0=Ay.height;Aw.autoCollapse=Ay.minHeight>Ap;Aw.minHeight=Ay.minHeight;Aw.height=Math.min(A0,Ap);if(A0>Ap){Aw.cutBy=A0-Ap;}return Aw;};}());(function(){if(!window.env){window.env={};}var k=window.env;k.isDebugging=false;var AB=k.isDebugging;function I(Ag){if(AB){AK.visPrint(Ag);}}mstrmojo.requiresCls("mstrmojo.css","mstrmojo.array","mstrmojo.num","mstrmojo.hash","mstrmojo.color","mstrmojo.dom","mstrmojo.Base","mstrmojo.Container","mstrmojo.Label","mstrmojo.VisBase","mstrmojo.ui.Pulldown","mstrmojo.VisMenuList","mstrmojo.VisMenuHierarchicalList","mstrmojo._VizSelectionHelper","mstrmojo._LoadsScript","mstrmojo.VisUtility","mstrmojo.VisEnum","mstrmojo.chart.common.Utility","mstrmojo.chart.enums.EnumFontStyle","mstrmojo.vi._MonitorsAppState","mstrmojo.vi.enums.EnumFeatures","mstrmojo.vi.ui._IsDropTarget","mstrmojo.vi.viz.EnumDSSDropZones","mstrmojo.chart.model.enums.EnumDSSObjectType","mstrmojo.util.color","mstrmojo.PerformanceLogOutput");mstrmojo.requiresClsP("mstrmojo.ui.menus","MenuConfig","_HasMenuPopup","EditorConfig");mstrmojo.requiresClsP("mstrmojo.gm","GMLegend","GMUtility","EnumLegendSlot","_SupportDndAsBlackBox");mstrmojo.requiresClsP("mstrmojo.netviz","_SupportNetworkBrushesAndHighlights","VisNetworkStage","ObservableModel","PropertyParser","_ForceDirectedLayout","_CircularLayout","_LinearLayout");mstrmojo.requiresClsP("mstrmojo.vi.ui.rw","_HasVisSelections","selectors._IsMultiUnitControl","selectors._BrushesAndHighlights","_XtabDE");var AX={lgdBgFillClr:[15461355,1710618],lgdBgFillStyle:[0,0],lgdBgFillEff:[1,1],lgdBgFillTrans:[0,100],lgdFntSz:["8pt","8pt"],lgdFntFml:["Arial","Arial"],lgdFntStyle:[0,0],lgdFntClr:[6710886,16777215],lgdBdrShw:[false,false],lgdBdrClr:[11579568,5855577],lgdBdrThk:["1px","1px"],lgdBdrLnStyle:[0,0],lm:[0,0],lwr:[undefined,undefined]};function AM(Ag){var Ah={};mstrmojo.hash.keyarray(AX).forEach(function(Ai){Ah[Ai]=AX[Ai][Ag];});return Ah;}var f=mstrmojo,AW=f.dom,AK=f.VisUtility,Ac=f.num,R=f.array,W=f.hash,AR=f.netviz.ObservableModel,AD=f.util.color,Ad=f.gm,U=Ad.GMLegend,h=5,p=Ad.EnumLegendSlot,AY=f.VisEnum.GMLegendDataType,G=f.chart.enums.EnumFontStyle,AZ=mstrmojo.VisEnum.GMLegendFormatingPropertyTag,Z=f.VisEnum,AU=Z.LegendPropertyTag,AN=Z.EnumLegendMode,AA=mstrmojo.vi.enums.EnumFeatures,AQ=Ad.GMUtility,x=f.PerformanceLogOutput,AJ=Z.NETWORK_AGGREGATION_METHOD,AH=Z.NETWORK_PROPERTIES,n=Z.NETWORK_LAYOUT,A=mstrmojo.vi.viz.EnumDSSDropZones,c=mstrmojo.chart.model.enums.EnumDSSObjectType,e=Z.NETWORK_MAX_NODE_SIZE_TYPE,AE=Z.NETWORK_MIN_NODE_SIZE_TYPE;var Y=24,w=24,S=76,P=28;var s=[{pos:p.LEFT_TOP},{pos:p.LEFT_MIDDLE},{pos:p.LEFT_BOTTOM},{pos:p.RIGHT_TOP},{pos:p.RIGHT_MIDDLE},{pos:p.RIGHT_BOTTOM}];var AS=0.5;var Af=Z.SERVER_JSON_ERROR_TYPE;var H=[n.CIRCULAR,n.LINEAR,n.FORCE_DIRECTED];var N=50;var AT=4;var a=0.2;var l={};l[e.AUTOMATIC]={"size-by":0.9,"no-size-by":0.08};l[e.MANUAL]={"size-by":0.5,"no-size-by":0.16};var E=["click","contextmenu","mouseup"];function AL(An,Ak){function Ap(Ax){var Av=Am.getDropZone();var Aw={from:A.FromItem,to:A.ToItem};var Ay;Object.keys(Aw).some(function(Az){var A0=Az+".TemplateUnit.0.id";if(AK.getPropertyByPath(Av,A0)===Ax){Ay=Aw[Az];return true;}return false;});return Ay;}var Am=this,Ar={act:"updateTemplate",keyContext:Am.k,actions:[]},Ah=Ar.actions,Au=[AK.pick(An,["did","t"])];var Ai=Ak.drillFromUnit.id;var Aj=Ap(Ai);if(Aj===undefined){return Ar;}var Aq={id:Aj},Ao=Am.zonesModel,Al=Ao.getZoneModelByZoneId(Aj),At=Al.items||[],As;var Ag=AK.findInArray(At,function(Av){return Av.did===Ai;});if(Ag!==-1){As=At[Ag];}if(As){Array.prototype.push.apply(Ah,Ao.getRemoveDropZoneUnitActions(Aq,As));Array.prototype.push.apply(Ah,Ao.getAddDropZoneUnitsActions(Aq,Au,As.idx));}return Ar;}function D(){var Ag=this.propInfo.layoutMode,Ah=H[Ag];if(Ah===n.LINEAR){this.inputLinearIcon.checked=true;}else{if(Ah===n.CIRCULAR){this.inputCircularIcon.checked=true;}else{if(Ah===n.FORCE_DIRECTED){this.inputForceDirectedIcon.checked=true;}}}}function t(Ai){var Ag,Ah=s.length;for(Ag=0;Ag<Ah;Ag++){if(Ai===s[Ag].pos){return Ag;}}return -1;}function M(Ag,Ah){if(isNaN(Ag)){return"rgba(0,0,0,1)";}Ag=parseInt(Ag,10);if(isNaN(Ah)){Ah=1;}return AD.getCSSColorString(Ag,Ah);}function Ab(Ag){var Ah=0;R.forEach(Ag,function(Aj){var Ai=parseFloat(Aj);if(!isNaN(Ai)){Ah+=Ai;}});return Ah;}var m={COUNT:"Count of",SUM:"Sum of",AVERAGE:"Average of",MIN:"Min of",MAX:"Max of"};var C={};C[m.COUNT]=function(Ag){return Ag.length;};C[m.SUM]=Ab;C[m.AVERAGE]=function(Ah){var Ag=Ah.length;return(Ag>0?Ab(Ah)/Ag:NaN);};C[m.MIN]=function(Ai){var Ag=Ai.length,Ak,Aj,Ah;if(Ag<1){return NaN;}Ak=Ai[0];for(Aj=1;Aj<Ag;Aj++){Ah=Ai[Aj];if(Ak>Ah){Ak=Ah;}}return Ak;};C[m.MAX]=function(Aj){var Ah=Aj.length,Ag,Ak,Ai;if(Ah<1){return NaN;}Ag=Aj[0];for(Ak=1;Ak<Ah;Ak++){Ai=Aj[Ak];if(Ag<Ai){Ag=Ai;}}return Ag;};function Aa(Al){if(!this.range||!this.sizeRange){I("No value range or size range available, cannot calculate size.");return 0;}var Ah=this.range,Aj=this.sizeRange,Ag=Math.max(Ah.max,Ah.min*Aj.max/Aj.min);var Ak=Ag-Ah.min||Infinity;var Ai=(Al-Ah.min)/Ak*(Aj.max-Aj.min)+Aj.min;if(isNaN(Ai)){I("something wrong in linear interpolation");Ai=0;}return Ai;}function g(){var Ag=this.stage;if(Ag){if(Ag.parent!==undefined){this.removeChildren(Ag);}Ag.destroy();delete this.stage;}}var Ae=0;var AV=mstrmojo.declare(mstrmojo.Base,null,{scriptClass:"mstrmojo.netviz.VisNetwork.Node",init:function(Ag){this.adjacence=[];this.edges=[];this.properties={};this.range={};this.attribute={};this.attributeElements=[];this.aggregationName=0;this.aggregationMethod=null;this.itemSizeMetricName=null;this.size=0;this.style=null;this._super(Ag);this.id="x"+(++Ae);},getAttributeName:function(){return this.hasSelfLoop?"Name":this.attribute&&this.attribute.name;},getName:function j(){var Ag="";R.forEach(this.attributeElements||[],function(Ah){Ag+=(Ah.name+" ");});return Ag.slice(0,Ag.length-1);},getFormNames:function(){var Ag=[];R.forEach(this.attribute.forms,function(Ah){Ag.push(Ah.name);});return Ag;},getFormValues:function(){var Ag=[];R.forEach(this.attributeElements,function(Ah){Ag.push(Ah.name);});return Ag;},setAggregationMethod:function(){var Ag=m.SUM;this.aggregationMethodName=(this.properties&&this.properties.nodeSizeAggregation)||Ag;if(!AJ.hasOwnProperty(this.aggregationMethodName)){this.aggregationMethodName=Ag;}this.aggregationMethod=C[this.aggregationMethodName];},getAggregatedValue:function(){if(!this.aggregationMethod){this.setAggregationMethod();}var Ai=this.edges,Ah=[],Aj,Ag;this.aggregationName=this.aggregationMethodName+" "+(this.itemSizeMetricName||"");if(this.itemSizeMetricName!==null){for(Aj=0,Ag=Ai.length;Aj<Ag;Aj++){var Ak=Ai[Aj];if(Ak&&Ak.itemSizeValue&&!Ak.isExcluded&&!isNaN(Ak.itemSizeValue)){Ah.push(Ak.itemSizeValue);}}return this.aggregationMethod(Ah);}return 0;},getSize:function(){if(isNaN(this.aggregatedValue)){this.aggregatedValue=this.getAggregatedValue();}return this.valueToSize(this.aggregatedValue);},valueToSize:function(An){var Ah=this.getNodeSizeRange();var Al=this.range;var Ai=Ah.min,Am=Ah.max,Ak=Al.min,Ap=Al.max,Ag=Ah.area;var Ao,Aj;if(Ak===Ap){Ao=Am;}else{Aj=(An-Ak)/(Ap-Ak);if(Ag){Aj=Math.sqrt(Aj);}Ao=Ai+(Am-Ai)*Aj;}return Ao;},getNodeSizeRange:function(){var Aj=this.properties;var Al=this.range;var Ai=Aj.maxNodeSize;var Am=Aj.minNodeSize;var Ap=Al.max,Ak=Al.min,Aq=false,An=N,Ah=AT;var Ao,Ag;if(this.isMetricSizeBy){switch(Am.type){case AE.PROPORTIONAL:Ao=Ai.ratio*An;if(Ap===0){Ag=Ah;}else{Ag=Ao*Math.sqrt(Ak/Ap);}Aq=true;break;case AE.FULL_RANGE:Ao=Ai.ratio*An;Ag=Ah;break;case AE.ADJUSTED_RANGE:Ao=Ai.ratio*An;Ag=Ao*Am.ratio;break;default:Ao=Ai.ratio*An;Ag=Ah;break;}}else{Ao=An*Ai.ratio;Ag=Ao;}if(Ao<Ah){Ao=Ah;}if(Ao>An){Ao=An;}if(Ag<Ah){Ag=Ah;}return{min:Ag,max:Ao,area:Aq};},updateValues:function(){var Ag=this.getAggregatedValue();if(!isNaN(Ag)){if(this.itemSizeMetricName!==undefined&&this.itemSizeMetricName!==null&&this.properties.minNodeSize.type===AE.PROPORTIONAL){if(Ag<0&&Math.abs(Ag)<this.range.min){this.range.minNegtive=true;}if(Ag<0&&Math.abs(Ag)>this.range.max){this.range.maxNegtive=true;}Ag=Math.abs(Ag);}this.aggregatedValue=Ag;this.range.min=Math.min(this.range.min,Ag);this.range.max=Math.max(this.range.max,Ag);}},updateStyles:function(){this.size=this.getSize();},update:function(){this.updateValues();this.updateStyles();},exclude:function(){this.isExcluded=true;this.sprite.isExcluded=true;var Ao=this.edges,Ak=Ao.length,Ai=this.adjacence,Ag=Ai.length,Ap;for(Ap=0;Ap<Ak;Ap++){var Aq=Ao[Ap];Aq.isExcluded=true;Aq.sprite.isExcluded=true;}for(Ap=0;Ap<Ag;Ap++){var Al=Ai[Ap],Aj=0,Am=Al.edges,Ah=Am.length,An;for(An=0;An<Ah;An++){if(!Am[An].isExcluded){Aj++;}}if(Aj===0){Al.isExcluded=true;Al.sprite.isExcluded=true;}Al.update();}},format:function(Ai){if(this.edges&&this.edges.length){var Ah=this.edges[0];var Ag;if(this.aggregationMethodName===m.COUNT){Ag=null;}else{if(Ah&&Ah.values[Ah.indexes.nodeSizeMIndex]){Ag=Ah.values[Ah.indexes.nodeSizeMIndex].formatString;}else{Ag=null;}}return Ac.formatByMask(Ag,Ai);}return Ai.toString();},getActionInfo:function(){var Ah=[],Ag=this;R.forEach(Ag.attributeElements,function(Ai){Ah.push({n:Ag.attribute.name,tid:Ag.attribute.id,v:Ai.name,eid:Ai.id});});return Ah;}});var J=[13376797,16734244,16749895,16762209,6672939];J.MISSING=5066061;J.FIRST_PALETTE_COLOR=2062260;var q=mstrmojo.declare(mstrmojo.Base,[],{scriptClass:"mstrmojo.netviz.VisNetwork.Edge",sizeRange:{min:1,max:16},valueToWidth:Aa,init:function(Ag){this.from=null;this.to=null;this.values=[];this.indexes={};this.properties={};this.range={};this.colorValueRange={};this.sizeValue=0;this.colorValue=0;this.itemSizeValue=0;this.width=0;this.color=0;if(this._super){this._super(Ag);}},update:function(){this.updateValues();this.updateStyles();},updateValues:function(){if(!this.values){return ;}var Ag=this.values[this.indexes.edgeColorMIndex],Ah=this.values[this.indexes.edgeSizeMIndex],Ai=this.values[this.indexes.nodeSizeMIndex];this.colorValue=Ag?parseFloat(Ag.value):"missing";this.sizeValue=Ah?parseFloat(Ah.value):"missing";this.itemSizeValue=Ai?parseFloat(Ai.value):"missing";if(!isNaN(this.sizeValue)){this.range.min=Math.min(this.sizeValue,this.range.min);this.range.max=Math.max(this.sizeValue,this.range.max);}if(!isNaN(this.colorValue)){this.colorValueRange.min=Math.min(this.colorValue,this.colorValueRange.min);this.colorValueRange.max=Math.max(this.colorValue,this.colorValueRange.max);}},updateStyles:function(){this.width=this.valueToWidth(this.sizeValue);},format:function(Ai,Ah){var Ag=(this.values[Ah]&&this.values[Ah].formatString)||null;return Ac.formatByMask(Ag,Ai);}});function K(Am,Ai){var Ao=mstrmojo.netviz.PropertyParser,Ah=Ao.BooleanProperty,An=Ao.IntegerProperty,Aj=Ao.FloatProperty,Ag=Ao.StringProperty,Al=Ao.JsonProperty;var Ak={showLegend:{key:AH.showLegend,type:Ah.preset(true)},showEdgeDirection:{key:AH.showEdgeDirection,type:Ah.preset(false)},showTransition:{key:AH.showTransition,type:Ah.preset(false)},nodeSizeAggregation:{key:AH.nodeSizeAggregation,type:Ag.preset(m.SUM)},minNodeSize:{key:AH.minNodeSize,type:Al.preset({type:AE.PROPORTIONAL}),postSet:function(Ar,As,Ap,Aq){if(Ar.type!==AE.ADJUSTED_RANGE){Ar.ratio=AT/N;}else{if(Ar.ratio===undefined){Ar.ratio=a;}}return Ar;}},maxNodeSize:{key:AH.maxNodeSize,type:Al.preset({type:e.AUTOMATIC}),postSet:function(As,At,Ap,Aq){var Ar=Am.hasSizeByMetric()?"size-by":"no-size-by";if(As.type===e.AUTOMATIC||As.type===e.MANUAL&&As.ratio===undefined){As.ratio=l[As.type][Ar];}return As;}},themeType:{key:AH.themeType,type:Ag.preset("light"),preSet:function(Ar,As,Ap,Aq){return(parseInt(Ar,10)===0)?"dark":"light";}},background:{key:AH.background,type:Al.preset({})},circleStyle:{key:AH.bubbleStyle,type:Al.preset({}),postSet:function(As,At,Aq,Ar){var Ap=Aq.shownodelabel;if(As.showNodeLabel===undefined){As.showNodeLabel=!!(Ap!==undefined&&Ap.toString()==="true");}return As;}},circleLabelStyle:{key:AH.circleLabelFont,type:Al.preset({})},layoutMode:{key:AH.layoutMode,type:An.preset(0)},dragMode:{key:AH.dragMode,type:An.preset(Z.NETWORK_DRAG_MODE.pan)},lgdBgFillClr:{key:AZ.LEGEND_BG_COLOR,type:Al.preset(undefined)},lgdBgFillStyle:{key:AZ.LEGEND_BG_FILL_STYLE,type:Ag.preset(undefined)},lgdBgFillEff:{key:AZ.LEGEND_BG_FILL_EFFECT,type:Ag.preset(undefined)},lgdBgFillTrans:{key:AZ.LEGEND_BG_FILL_TRANSPARENCY,type:Ag.preset(undefined)},lgdFntSz:{key:AZ.LEGEND_FONT_SIZE,type:Ag.preset(undefined)},lgdFntFml:{key:AZ.LEGEND_FONT_FAMILY,type:Ag.preset(undefined)},lgdFntStyle:{key:AZ.LEGEND_FONT_STYLE,type:An.preset(undefined)},lgdFntClr:{key:AZ.LEGEND_FONT_COLOR,type:An.preset(undefined)},lgdBdrShw:{key:AZ.LEGEND_BORDER_SHOW,type:Ah.preset(undefined)},lgdBdrClr:{key:AZ.LEGEND_BORDER_COLOR,type:Ag.preset(undefined)},lgdBdrStyle:{key:AZ.LEGEND_BORDER_LINE_STYLE,type:Ag.preset(undefined)},lm:{key:AU.LEGEND_MODE,type:An.preset(undefined)},LegendPosition:{key:AU.LEGEND_POSITION,type:An.preset(2)},lwr:{key:AU.SCALE_LEGEND_WIDTH,type:Aj.preset(undefined)}};return new Ao().parse(Ai,Ak);}function AP(Ag){function Ah(Ak){var Ai=Ag[Ak],Aj=Ai&&(Ai.TemplateUnit||Ai.TemplateMetric);return(Aj&&Aj[0])||{};}return{edgeColor:Ah("ColorBy"),edgeSize:Ah("SizeBy"),itemSize:Ah("itemsz"),from:Ah("from"),to:Ah("to")};}var AG=["at","dei","dpt","o","tui","ui"];function X(Bq,BX,Al){BX=BX||{};BX.nodeValueRange=BX.nodeValueRange||{min:Infinity,max:-Infinity};BX.edgeValueRange=BX.edgeValueRange||{min:Infinity,max:-Infinity};BX.edgeColorValueRange=BX.edgeColorValueRange||{min:Infinity,max:-Infinity};BX.circleStyle.fromNode.shape=BX.circleStyle.fromNode.shape||"Circle";BX.circleStyle.toNode.shape=BX.circleStyle.toNode.shape||"Circle";var Ak=[],BC=[],Bn=[],BT=[],Bm={};var Av=Al.edgeColor.id,Aq=Al.edgeSize.id,Bh=Al.itemSize.id,BY=Al.from.id,Ay=Al.to.id;var A4={nodes:Ak,edges:BC,nodesIdHash:Bm,attributes:Bn,metrics:BT,indexes:{edgeColorMIndex:-1,edgeSizeMIndex:-1,nodeSizeMIndex:-1,fromIndex:-1,toIndex:-1},modifiedNodes:[],formNameDisplayType:Bq.lnm};var Bg=this.model;function Br(B5,B6,B4){return new AV({attribute:B5,attributeElements:B6,adjacence:[],edges:[],properties:BX,range:BX.nodeValueRange,isMetricSizeBy:Bh!==undefined,attSrc:B5.id===B4?"from":"to",shape:B5.id===B4?BX.circleStyle.fromNode.shape:BX.circleStyle.toNode.shape});}function BN(B6,B5,B4){return new q({from:B6,to:B5,values:[],indexes:B4,properties:BX,range:BX.edgeValueRange,colorValueRange:BX.edgeColorValueRange});}var Bc=Bq.gts.row;var Ba=Bq.gts.col;var Bk=Bq.ghs.rhs.items;var BK=Bq.gvs.items||[];var As={};var At=true,Am;R.forEach(Bc,function(B7,B6){AK.restoreEsForUnit(B7);var B8=[],B4=[],B5;R.forEach(B7.es,function(B9){B8.push({id:B9.id,name:B9.n});});R.forEach(B7.fs,function(B9){B4.push({name:B9.n});});Am=Bg.supportsViewFilterActions(B7.id);At=At&&Am;B5={id:B7.id,name:B7.n,elements:B8,supportsViewFilter:Am,forms:B4,formsLength:(B7.fs&&B7.fs.length)||1};if(B7.sc!==undefined){B5.sc=B7.sc;}Bn.push(B5);As[B7.id]=B6;});A4.allSupportsViewFilter=At;var Bi=(Bq.gsi&&Bq.gsi.mx)||[];try{R.forEach(Bi,function(B4,B5){BT.push({id:B4.did,name:B4.n,formatString:AK.getNumberFormat(Bq,B5)||""});As[B4.did]=B5;});}catch(B3){mstrmojo.err(B3);}var BV=A4.indexes;BV.edgeColorMIndex=As[Av];BV.edgeSizeMIndex=As[Aq];BV.nodeSizeMIndex=As[Bh];BV.fromIndex=As[BY];BV.toIndex=As[Ay];var Au=[];if(BV.edgeColorMIndex!==undefined){var BA=Bq.gsi&&Bq.gsi.thresholds[BT[BV.edgeColorMIndex].id],BL;if(BA!==undefined&&BA.length>0){for(BL=0;BL<BA.length;BL++){if(BA[BL].fmt&&BA[BL].fmt.bc){Au[BL]=mstrmojo.VisUtility.parseCSSColor(BA[BL].fmt.bc);}else{Au[BL]=J.FIRST_PALETTE_COLOR;}}}}var A5={max:-Infinity,min:Infinity};if(AK.isOnExpressMode()){var BG=BV.edgeColorMIndex;R.forEach(BK,function(B5){var B4=B5&&B5.items&&B5.items[BG];if(B4){A5.max=Math.max(A5.max,B4.rv);A5.min=Math.min(A5.min,B4.rv);}});}var BE={},Aj={};var BS,BR,BP,BO,A9,Bu,Aw,Bf,Bp,Ap,B2,BF,Bx,Ah,Bd,Bz,Bv,BB,Ao,A2,BZ,Ai=(Bk&&Bk.length)||0,BD=(Bc&&Bc.length)||0,BQ=AG.length;for(BS=0;BS<Ai;++BS){Bp=Bk[BS].items;Ap=Bp.length;B2=[];Bu=1;A9=0;for(BR=0;BR<BD;BR++){if(BR!==BV.fromIndex&&BR!==BV.toIndex){B2.push(null);continue;}BF=Bn[BR];Bx=BF.elements;Ah=[];Bd="";Aw=BF.cs?BF.cs:1;Bu=BF.formsLength;A2=[];for(BP=0,Bf=Math.max(Aw,Bu);BP<Bf;BP++){if(Bp[A9]&&Bp[A9].tui===BR){BB=Bp[A9];Bz=Bx[BB.idx];A9++;if(A2.indexOf(Bz)===-1){for(BO=0;BO!==BQ;BO+=1){Ao=AG[BO];Bz[Ao]=BB[Ao];}Bd+=Bz.name;A2.push(Bz);Ah.push(Bz);}}}if(!BE[Bd]){BZ=Br(BF,Ah,BY,Ay);BE[Bd]=Bm[BZ.id]=BZ;Ak.push(BZ);}else{Bv=BE[Bd];if(Bv.attSrc==="to"&&BR===0){Bv.attSrc="from";Bv.shape=BX.circleStyle.fromNode.shape;}if(Bv.attribute!==BF){Bv.hasSelfLoop=true;Bv.secondaryAttribute=BF;Bv.secondaryAttributeElements=Ah;}}B2.push(BE[Bd]);}var Bo=B2[BV.fromIndex],BU=B2[BV.toIndex];try{if(Bo&&BU){var A1=BN(Bo,BU,A4.indexes),BH=A1.from.id+A1.to.id,A3=A1.to.id+A1.from.id,B0,A6=BK[BS]?BK[BS].items:[];if(A6!==null){var Bj=BT.length;for(BR=0;BR<Bj;++BR){var A0={},Bl=BT[BR],A7=A6[BR];A0.metricName=Bl.name;A0.value=A7.rv;A0.formatString=Bl.formatString;A1.values[BR]=A0;if(BV.edgeColorMIndex!==undefined&&BV.edgeColorMIndex===BR&&Au.length>0){var Be=A7.ti;if(Be===undefined&&AK.isOnExpressMode()){var BM,Az=A5.max,B1=A5.min,Bt=A7.rv;if(Az===B1){BM=0;}else{BM=(Bt-B1)/(Az-B1);}if(BM<0.1){Be=0;}else{if(BM>=0.1&&BM<0.3){Be=1;}else{if(BM>=0.3&&BM<0.5){Be=2;}else{if(BM>=0.5&&BM<0.7){Be=3;}else{if(BM>=0.7&&BM<0.9){Be=4;}else{if(BM>=0.9){Be=5;}}}}}}}A1.color=M(Au[Be],AS);}}if(BV.edgeColorMIndex===undefined||Au.length===0){A1.color=M(J.MISSING,AS);}}if(Aj[BH]){var BW=Aj[BH],Bb=A1.values||[],Ar=Bb.length,An;for(An=0;An<Ar;An++){BW.values[An].value+=Bb[An].value;}}else{B0=Aj[A3];if(B0){A1.reversedEdge=B0;B0.reversedEdge=A1;}Aj[BH]=A1;BC.push(A1);Bo.adjacence.push(BU);Bo.edges.push(A1);if(Bo!==BU){BU.adjacence.push(Bo);BU.edges.push(A1);}}}}catch(B3){mstrmojo.err(B3);}}R.forEach(BC,function(B4){B4.updateValues();});R.forEach(BC,function(B4){B4.updateStyles();});var Bs=BV.nodeSizeMIndex,BI=(BT[Bs]&&BT[Bs].name)||null;R.forEach(Ak,function(B4){B4.itemSizeMetricName=BI;B4.updateValues();});R.forEach(Ak,function(B4){B4.updateStyles();});R.forEach(BX.modifiedNodes,function(B5){var B4=BE[B5.name];if(B4){B4.style=B5.style;if(A4.modifiedNodes.indexOf(B4)===-1){A4.modifiedNodes.push(B4);}else{I("warning: duplicated nodes are store in the server.");}}});function By(B4){var B5;R.forEach(Ba[0].es,function(B6){if(B6.oid===B4){B5=B6.n;return false;}});return B5;}function BJ(B5,B6){var B4;if(isNaN(B6)){B4="--";}else{B4=B5.format(B6);}return B4;}function Bw(){if(Al&&Al.itemSize&&Al.itemSize.id){var B7=A4.nodes[0]||new AV(),B5={},CA=[],CB=B7.range.minNegtive?(-B7.range.min):B7.range.min,B6=B7.range.maxNegtive?(-B7.range.max):B7.range.max,B9,B8,B4;B9=parseFloat(B6);if(B6===CB){B9=parseFloat(B6);CA.push({label:BJ(B7,B9)});}else{[B6,CB].forEach(function(CC){B9=parseFloat(CC);CA.push({label:BJ(B7,B9)});});}B5.item=mstrmojo.desc(13616,"Item size:")+" "+By(Al.itemSize.id);if(CA.length>1){B8=B5.elements=[];R.forEach(CA,function(CC){B8.push({sign:"=",v:CC.label});});B5.caseFlag=0;}else{if(CA.length===1){B5.elements=[{diameter:12,shape:"rect",sign:"=",v:CA[0].label}];B5.caseFlag=2;}}return B5;}}A4.itemSizeByInfo=Bw();function Ax(B5,B9,CC,B6){var CE=[];if(!CC||CC.length<2){for(BS=0;BS<B6;BS++){CE.push(B5);}return CE;}var CD=(B9-B5)/(B6-1),B7=CC[2]?(CC[2]-CC[1]):(CC[1]-CC[0]),CA,B8=CC[1],B4=1,CB,CF;while(B7<1){B7*=10;B4/=10;}while(B7>=10){B7/=10;B4*=10;}CE.push(B5);while(B8>B5){B8-=B4;}for(BS=1;BS<B6-1;BS++){CA=parseFloat(B5+BS*CD);CF=Number.POSITIVE_INFINITY;CB=Math.abs(CA-B8);while(CB<CF){CF=CB;B8+=B4;CB=Math.abs(CA-B8);}B8-=B4;CE.push(B8);}CE.push(B9);return CE;}function A8(){if(Al&&Al.edgeSize&&Al.edgeSize.id){var B6=A4.edges[0]||new q(),CE=5,CD=[],B4,B8={},CF=B6.range.min,CI=B6.range.max,CA=B6.indexes.edgeSizeMIndex,CG,B7=f.chart.common.Utility,CH,B5,B9,CB,CC=[];if((!CF&&CF!==0)||(!CI&&CI!==0)||!isFinite(CF)||!isFinite(CI)||(CI<CF)){CC.push("Error");}else{if(CF===CI){CC.push(CF);}else{CH=B7.prepareScalePlateOptions(false,0,4);B5=B7.getScalePlate(true);B5.computeTicks(CH,4,CI,CF);B5.GetTicks(CC);CC=Ax(CF,CI,CC,CE);}}for(B9=0,CB=CC.length;B9<CB;B9++){if(!isFinite(CC[B9])){CG="--";}else{CG=B6.format(CC[B9],CA);}CD.push({label:CG});}B8.item=mstrmojo.desc(13617,"Edge size:")+" "+By(Al.edgeSize.id);B4=B8.elements=[];R.forEach(CD,function(CJ){B4.push({sign:"<",v:CJ.label});});CB=B4.length;if(CB===5){B4[0].sign="=";B4[4].sign="=";}if(CB===1){B4[0].sign="=";}B8.caseFlag=3;return B8;}}A4.edgeSizeByInfo=A8();function Ag(CC){var B4=Al&&Al.edgeColor&&Al.edgeColor.id,CB=Bq.gsi.mx,B7;if(B4&&CC!==undefined){R.forEach(CB,function(CD){if(CD.did===B4){B7=CD;}});if(B7){var B8=CC[B4];if(B8&&B8.length>0&&B8[0].fmt&&B8[0].fmt.bc){var CA=mstrmojo.VisUtility.getRankMode(B8),B6=AK.getNumberFormat(Bq,A4.indexes.edgeColorMIndex),B9=B6?mstrmojo.VisUtility.getColorByFormatStr(B6.replace(/\'/g,'"'),CA):"",B5=mstrmojo.VisUtility.getColorByItems(B8,CA,B7.max,B7.min,B7.cnt,B9,M(J.FIRST_PALETTE_COLOR));return{item:mstrmojo.desc(13618,"Edge color:")+" "+mstrmojo.VisUtility.getColorByTitle(By(B4),CA),elements:B5};}}}}A4.edgeColorByInfo=Ag(Bq.gsi.thresholds);return A4;}function AI(){function Ai(An,Aq,Ap){var Am=this.propInfo,Ao;Am.unmarshal(An,Aq);Ao=Am[An];if(Ap){this.observableModel[An].setValue(Ao,true);}return Ao;}function Al(Am,Ao,An,Aq){function Ap(At,As){Ai.call(this,Am,At,As);var Ar=this.legend;if(!Ar||!Ar.hasRendered){return ;}this.initHTML5Props(this.HTML5PROPS);Ar.updateStyle(this.HTML5PROPS.LEGEND);if(Aq){Ar.updateTitleLineHeight();this.hEvalSize4Legend();this.updateLegend();Ar.updateSplitter();this.updateStageContentForLegendChanged(s[Ar.currDockedPositionIdx].pos);}}Ap.call(this,Ao);this.setProperty(An,this.propInfo.marshal(Am),{suppressData:true,clientUndoRedoCallback:Ap});}function Ak(An){return function Am(Ap){var Ao=Ap.newValue;function Aq(At,As){var Ar=this.propInfo;Ai.call(this,An,At,As);Ar.nodeValueRange={min:Infinity,max:-Infinity};Ar.edgeValueRange={min:Infinity,max:-Infinity};Ar.edgeColorValueRange={min:Infinity,max:-Infinity};this.abstractedModel=X.call(this,this.modelData,Ar,this.dropZoneInfo);this.generateSprites(this.abstractedModel,this.stage);this.refresh();}Aq.call(this,Ao);this.setProperty(AH[An],this.propInfo.marshal(An),{suppressData:true,clientUndoRedoCallback:Aq});};}var Ag=this.propInfo,Aj=["showEdgeDirection","showTransition","nodeSizeAggregation","layoutMode","lgdBgFillTrans","lgdBgFillClr","lgdFntClr","lgdFntSz","lgdFntFml","lgdFntStyle","showLegend","maxNodeSize","minNodeSize"],Ah=this.addDisposable(new AR(Aj.reduce(function(Am,An){Am[An]=Ag[An];return Am;},{})));Ah.showEdgeDirection.attachEventListener("valueChanged",this.id,function(Ao){var An=Ao.newValue,Am="showEdgeDirection";function Ap(As,Ar){var Aq=Ai.call(this,Am,As,Ar);this.stage.showEdgeDirection=Aq;this.stage.draw(false,true,true);}Ap.call(this,An);this.setProperty(AH.showEdgeDirection,this.propInfo.marshal(Am),{suppressData:true,clientUndoRedoCallback:Ap});});Ah.showTransition.attachEventListener("valueChanged",this.id,function(Ao){var An=Ao.newValue,Am="showTransition";function Ap(As,Ar){var Aq=Ai.call(this,Am,As,Ar);this.stage.showTransition=Aq;}Ap.call(this,An);this.setProperty(AH.showTransition,this.propInfo.marshal(Am),{suppressData:true,clientUndoRedoCallback:Ap});});Ah.nodeSizeAggregation.attachEventListener("valueChanged",this.id,Ak("nodeSizeAggregation"));Ah.maxNodeSize.attachEventListener("valueChanged",this.id,Ak("maxNodeSize"));Ah.minNodeSize.attachEventListener("valueChanged",this.id,Ak("minNodeSize"));Ah.layoutMode.attachEventListener("valueChanged",this.id,function(Ao){var An=Ao.newValue,Am="layoutMode";function Ap(As,Ar){var Aq=Ai.call(this,Am,As,Ar);D.call(this);this.layoutSprites(this.abstractedModel,this.stage,H[Aq]);this.stage.draw(this.propInfo.showTransition,true,true);}Ap.call(this,An);this.setProperty(AH.layoutMode,this.propInfo.marshal(Am),{suppressData:true,clientUndoRedoCallback:Ap});});Ah.lgdBgFillTrans.attachEventListener("valueChanged",this.id,function(Am){Al.call(this,"lgdBgFillTrans",Am.newValue,AH.lgdBgFillTrans);});Ah.lgdBgFillClr.attachEventListener("valueChanged",this.id,function(Am){Al.call(this,"lgdBgFillClr",Am.newValue,AH.lgdBgFillClr);});Ah.lgdFntClr.attachEventListener("valueChanged",this.id,function(Am){Al.call(this,"lgdFntClr",Am.newValue,AH.lgdFntClr);});Ah.lgdFntSz.attachEventListener("valueChanged",this.id,function(Am){Al.call(this,"lgdFntSz",Am.newValue,AH.lgdFntSz,true);});Ah.lgdFntFml.attachEventListener("valueChanged",this.id,function(Am){Al.call(this,"lgdFntFml",Am.newValue,AH.lgdFntFml,true);});Ah.lgdFntStyle.attachEventListener("valueChanged",this.id,function(Am){Al.call(this,"lgdFntStyle",Am.newValue,AH.lgdFntStyle,true);});Ah.showLegend.attachEventListener("valueChanged",this.id,function(Ao){var An=Ao.newValue,Am="showLegend";function Ap(As,Ar){var Aq=Ai.call(this,Am,As,Ar);if(this.isEmpty()){return ;}this.toggleLegend(Aq);this.updateStageContentForLegendChanged(s[this.legend.currDockedPositionIdx].pos,(Ag.showLegend?this.legendW:0));}Ap.call(this,An);if(this.parent.selectVIUnit){this.parent.selectVIUnit(true);}this.setProperty(AH.showLegend,this.propInfo.marshal(Am),{suppressData:true,clientUndoRedoCallback:Ap});});return Ah;}function AO(){var Aj=this.contextMenuSelection,Ai,Ah,Ag;for(Ai=0,Ah=Aj.length;Ai!==Ah;Ai++){Ag=Aj[Ai].unit.attribute;if(!Ag.supportsViewFilter){return false;}}return true;}function o(Al,Ag,Aj){var Ai=this.menuAnchor,Ak=this,Ah;if(!Ai){Ai=document.createElement("div");Ai.id=this.id+"-netviz-menu-anchor";Ai.style.position="absolute";document.body.appendChild(Ai);this.menuAnchor=Ai;}Ai.style.left=Ag.pageX+"px";Ai.style.top=Ag.pageY+"px";Ai.style.zIndex=101;this.configurePopup(Al,Ai);Ah=Al.newInstance();if(Ah&&Aj){Ah.onCloseMenuCallBack=function(){Ak.stage.clearContextMenuSelectionHighLight();Ak.stage.draw(false);Ak.stage.circleMenuOnCloseFlag=true;};}this.openPopup(Ah);}function V(Ai){var Aj=this,Ak=Aj.model,Am=AK.getDrillCandidates(Aj,Ai),Ao=Am.length,Al=Ak.docModel,Ah=Al.datasets[Aj.modelData.datasetId],As,Aq=[],Ar;function Ap(At,Av,Aw,Au){return{id:-1,n:At,title:Av,level:Aw,isLeaf:false,initVisible:true,collapsed:false,children:[],_renderIdx:Au,};}if(Ah&&Al.isMDXDataset(Ah)){AK.sortMdxDrillCandidates(Am);var An=0;As=Ah.tables[0];As.dimensions.forEach(function(Av){var Au=false,At=Ap(Av.n,Av.n,0,An++),Aw=[];Aw.push(At);Av.hierarchies.forEach(function(Ay){var Ax=false,Az=Ap(Ay.n,Ay.n,1,An++),A0=[];A0.push(Az);Ay.att.forEach(function(A1){Ar=R.findBin(Am,A1,"did",Ao);if(Ar!==-1){Ax=true;var A3={level:2,isLeaf:true,initVisible:true,collapsed:null,_renderIdx:An++,};var A2=W.copy(Am[Ar],A3);A0.push(A2);Az.children.push(A2);}});if(Ax){At.children.push(Az);Aw=Aw.concat(A0);Au=true;}});if(Au){Aq=Aq.concat(Aw);}});}else{var An;for(An=0;An<Am.length;++An){var Ag={_renderIdx:An,};W.copy(Am[An],Ag);Aq.push(Ag);}}return Aq;}function AC(){function Am(Ap){var Ao=AK.getPropertyByPath(this,"modelData.gts.row",[]);var An=AK.findInArray(Ao,function(Aq){return Aq.id===Ap;});if(An!==-1){return Ao[An];}}function Ak(){var An=this.getDropZone();var Ao=this;return["to","from"].map(function(Aq){var At=Aq+".TemplateUnit.0.id";var As=AK.getPropertyByPath(An,At);var Ap=Am.call(Ao,As);var Ar=AK.pick(Ap,["n","id"]);Ar.title=Ar.n;return Ar;});}var Ah=this.model,Ag=Ah.docModel,Al=Ag.datasets[this.modelData.datasetId],Aj=null;if(Al&&Ag.isMDXDataset(Al)){Aj={scriptClass:"mstrmojo.VisMenuHierarchicalList",alias:"candidateList",itemField:"n"};}else{Aj={scriptClass:"mstrmojo.VisMenuList",alias:"candidateList",itemField:"n"};}var Ai=this;return function(){return new mstrmojo.ui.menus.EditorConfig({cssClass:"base-on-calculation-editor",data:{},contents:[{scriptClass:"mstrmojo.Label",text:mstrmojo.desc(11859,"Based on")},{scriptClass:"mstrmojo.ui.Pulldown",alias:"attributeList",items:Ak.call(Ai),selectedIndex:0,onitemSelected:function(){var Ap=this.items[this.selectedIndex].id,An=this.parent,Ao=An&&An.candidateList;if(Ao){Ao.items=V.call(Ai,Ap);}if(An){(An.children||[]).forEach(function(Aq){if(Aq.scriptClass=="mstrmojo.VisMenuList"||Aq.scriptClass=="mstrmojo.VisMenuHierarchicalList"){Aq.clearSelect();An.data.set("valid",false);Aq.unrender();Aq.render();}});}}},Aj,],bindings:{okEnabled:"this.valid",valid:function(){return this.data.valid;}},fnOk:function(Ar,Ap){var Ao=AK.getPropertyByPath(Ap,"candidateList.selectedItem");var Aq=AK.pick(Ap.attributeList.getSelectedItem(),["id","n"]);Ai.doSelection(function An(At){var As=Aq.id;return At.filter(function(Au){return Au.hasSelfLoop||Au.attribute.id===As;}).map(function(Av){var Au=Av;if(Av.hasSelfLoop&&Av.attribute.id!==As){Au={attribute:Av.secondaryAttribute,attributeElements:Av.secondaryAttributeElements};}return Au;});},true);AK.doDrill(Ai,Ao,AL,{drillFromUnit:Aq});}});};}function F(){var Ao=this.abstractedModel.allSupportsViewFilter||AO.call(this.stage),Al=new mstrmojo.ui.menus.MenuConfig(),Ah=new mstrmojo.ui.menus.MenuConfig(),Aq={filter:Al,showData:Ah},Am=this,Ai=this.stage.contextMenuSelection,An=function(At){var As=Ai;var Ar=O(As);if(Ar.isSameAttr){return AK.getDrillMenu.bind(AK,Am,As[0].unit.attribute.id,At,{drillFromUnit:AK.pick(Ar.nonLoopAttr,["id","n"])});}else{return AC.call(Am);}};if(Ao){if(this.isLinkedFilterEnabled()){var Ak=function(){Am.handleContextMenuSelectionData(true);};Al.addMenuItem(mstrmojo.desc(15070,"Go to Targets"),"",Ak);Al.addSeparator();}Al.addMenuItem(mstrmojo.desc(11701,"Keep only"),"xt",this.getMenuHandler("keepOnly"));Al.addMenuItem(mstrmojo.desc(3946,"Exclude"),"xt",this.getMenuHandler("exclude"));if(!mstrApp.isInVFConfigMode&&mstrmojo.resolveFeature(AA.WEB_DRILL_AND_LINK)){var Aj,Ap,Ag=false;for(Aj in Ai){Ap=AK.getPropertyByPath(Ai[Aj],"unit.attribute.id",null);if(Ap&&AK.getDrillCandidates(this,Ap).length>0){Ag=true;break;}}if(Ag){Al.addPopupMenuItem(mstrmojo.desc(145,"Drill"),this.id,An(this.getMenuHandler("drill")),"xt");}else{Al.addNonInteractiveMenuItem(mstrmojo.desc(145,"Drill"),"",true);}}if(!mstrApp.isDossier&&!this.excludeData){Ah.addMenuItem(mstrmojo.desc(13537,"Show Data..."),"xt",this.getMenuHandler("showData"));}}return Aq;}function O(Ah){var Ag,Ai=Ah.every(function(Al){var Ak=Al.unit,Aj=Ak.attribute;if(!Ak.hasSelfLoop){if(Ag===undefined){Ag=Aj;}return Ag===Aj;}return false;});return{isSameAttr:Ai,allSelfloops:Ag===undefined,nonLoopAttr:Ag};}function u(Aj){if(Aj.length===0){return{isSameAttr:false,allSelfloops:false,selection:[]};}var Ai=O(Aj),Al=Ai.isSameAttr,Ah=Ai.allSelfloops,Ak=Ai.nonLoopAttr;var Ag=Aj.reduce(function(An,Aq){var Ap=Aq.unit,Am=Ap.attribute,Ao;if(Ap.hasSelfLoop){if(Ah||Am!==Ak){Ao={attribute:Ap.secondaryAttribute,attributeElements:Ap.secondaryAttributeElements};An.push({text:Aq.text,unit:Ao,title:Ao.attribute.name});}if(Ah||Am===Ak){Ao={attribute:Am,attributeElements:Ap.attributeElements};An.push({text:Aq.text,unit:Ao,title:Am.name});}}else{Ao={attribute:Am,attributeElements:Ap.attributeElements};An.push({text:Aq.text,unit:Ao,title:Am.name});}return An;},[]);return{allSelfloops:Ah,isSameAttr:Al,selection:Ag};}function d(){var Ah={};if(mstrApp.isAppStatePresentation()||mstrApp.isInVFConfigMode){return Ah;}var Al=this.stage.contextMenuSelection,Aj,Ag,Am,Ak=function(An){return An.text;},Ai=function(An){return An;};if(Al&&Al.length>0){Aj=u(Al);Al=Aj.selection;Ag=Aj.allSelfloops;if(!Ag&&Aj.isSameAttr){Am=this.getCellForNode(Al[0]);Ah=AK.getGroupAndCalculationContextMenu(this,Am,{selection:Al,skipSingleAttrCheck:true,fnCellName:Ak});}else{if(Ag){Ah=AK.getGroupAndCalculationContextMenuForDataPoints(this,{selection:Al,fnCellName:Ak,fnUnique:Ai,fnMakeNode:Ai});}}}return Ah;}function Q(Ah){var Ag=0,Ak=0,Ai=0;function Aj(Al){if(Al.isExcluded){return ;}var Am=Al.sprite.getGeometry();Ag++;if(!isNaN(Am.s)){Ak+=Am.s*2;if(Ai<Am.s){Ai=Am.s;}}}R.forEach(Ah.nodes,Aj);return{circleCount:Ag,dimension:Ak,maxR:Ai};}function z(Ah){var Ag=Ah.nodes.reduce(function(Al,Ak,Aj){Al[Ak.id]=Aj;return Al;},{});Ah.nodes.sort(function Ai(Ak,Aj){var An=Ak.sprite.getGeometry().s,Am=Aj.sprite.getGeometry().s,Al;if(An>Am){Al=1;}else{if(An===Am){Al=Ag[Ak.id]>Ag[Aj.id]?1:-1;}else{Al=-1;}}return Al;});}mstrmojo.netviz.VisNetwork=mstrmojo.declare(mstrmojo.VisBase,[mstrmojo._VizSelectionHelper,mstrmojo._LoadsScript,mstrmojo.vi.ui.rw._HasVisSelections,mstrmojo.vi.ui.rw.selectors._IsMultiUnitControl,mstrmojo.vi.ui.rw.selectors._BrushesAndHighlights,mstrmojo.vi.ui.rw._XtabDE,mstrmojo.vi.ui._IsDropTarget,mstrmojo.gm._SupportDndAsBlackBox,mstrmojo.netviz._ForceDirectedLayout,mstrmojo.netviz._CircularLayout,mstrmojo.netviz._LinearLayout,mstrmojo.netviz._SupportNetworkBrushesAndHighlights,mstrmojo.ui.menus._HasMenuPopup,mstrmojo.vi._MonitorsAppState],{scriptClass:"mstrmojo.netviz.VisNetwork",localProps:null,normalizedIdCache:{},markupString:'<div class="VisNetwork network-{@themeType}-theme mil-{@themeType} gm-{@themeType}-theme" id={@id} style="position: absolute; left: {@left}px; top: {@top}px; width: {@width}px; height: {@height}px; z-index: 1;" mstrAttach:'+E.join(",")+'><div style="width: {@width}px; height:{@height}px;"></div><div></div><div class="_layoutIcons" style="position: absolute; right: '+Y+"px; top: "+w+"px; width: "+S+"px; height: "+P+'px"><input id="{@id}-inputForceDirectedIcon" class="_inputForceDirectedIcon" type="radio" name="{@id}-layoutTypes" style="display:none;"><label for="{@id}-inputForceDirectedIcon" class="_forceDirectedIcon" style=""></label><input id="{@id}-inputCircularIcon" class="_inputCircularIcon" type="radio" name="{@id}-layoutTypes" style="display:none;"><label for="{@id}-inputCircularIcon" class="_circularIcon" style=""></label><input id="{@id}-inputLinearIcon" class="_inputLinearIcon" type="radio" name="{@id}-layoutTypes" style="display:none;"><label for="{@id}-inputLinearIcon" class="_linearIcon" style=""></label></div>',markupSlots:{stageContainer:function(){return this.domNode.firstChild;},legendPlaceholder:function(){return this.domNode.childNodes[1];},modeSwitchButton:function(){return this.domNode.childNodes[2];},inputForceDirectedIcon:function(){return this.domNode.childNodes[2].childNodes[0];},forceDirectedIcon:function(){return this.domNode.childNodes[2].childNodes[1];},inputCircularIcon:function(){return this.domNode.childNodes[2].childNodes[2];},circularIcon:function(){return this.domNode.childNodes[2].childNodes[3];},inputLinearIcon:function(){return this.domNode.childNodes[2].childNodes[4];},linearIcon:function(){return this.domNode.childNodes[2].childNodes[5];}},init:function(Ag){this._super(Ag);this.modeSwitchButtonRect={r:Y,t:w,w:S,h:P};this.HTML5PROPS={};this.localProps={};this.canOnlyDragOnTitleBar=true;},update:function(Ai){var Ak,Al,Aq,Ag,Aj,Am=this.excludeData,Ah="timerid_update";x.startTimer({functionName:"VisNetwork.update",purpose:"JSON loading and consuming"},Ah);Ak=this._super(Ai);if(Ak!==false){this.clearError();Aq=this.model.data||{};Ag=Aq.egt;Aj=Aq.eg;if((Ag!==undefined||Aj!==undefined)&&!Am){this.setError(Aj,Ag);if(this.errorType!==Af.EMPTY_DATA){return Ak;}}this.modelData=this.model.data;this.dropZoneInfo=AP(this.getDropZone());this.propInfo=K(this,this.getProperties());var Ap=this.getFormats()["background-color"];if(Ap===undefined){Ap=this.propInfo.themeType==="dark"?"#333333":"#ffffff";}this.propInfo.background={value:Ap,opacity:1};this.observableModel=AI.call(this);g.call(this);Al=this.propInfo;this.stage=this.addDisposable(new mstrmojo.netviz.VisNetworkStage({owner:this,slot:"stageContainer",showTransition:Al.showTransition,showEdgeDirection:Al.showEdgeDirection,themeType:Al.themeType,background:W.clone(Al.background),circleStyle:W.clone(Al.circleStyle),circleLabelStyle:W.clone(Al.circleLabelStyle),dragMode:Al.dragMode}));this.propInfo.circleStyle=this.stage.observableModel&&this.stage.observableModel.circleStyle;this.layoutMode=H[Al.layoutMode];this.themeType=Al.themeType;if(AK.isOnExpressMode()&&this.dropZoneInfo.edgeColor.id){var Ao=this.modelData.gsi;if(Object.keys(Ao.thresholds).length===0){var An=this.dropZoneInfo.edgeColor;Ao.thresholds=AK.getMockUpThresholds(An.id,An.n);}}if(AK.hasMergedRowCells(this.modelData)&&!Am){this.error=mstrmojo.desc(13702,"The Network doesn't support grid data with merged row cell. Please disable cell merge and retry");}else{if(this.dropZoneInfo.from.id||this.dropZoneInfo.to.id){if(Al.showLegend&&!this.hasSizebyOrColorby()){Al.showLegend=false;}this.abstractedModel=X.call(this,this.modelData,Al,this.dropZoneInfo);this.generateSprites(this.abstractedModel,this.stage);}else{if(!Am){this.setError(null,Af.NO_TEMPLATE_UNIT);}}}}x.endTimer(Ah);return Ak;},getColorByMetric:function(){return AK.getMetricsInDropZone(this.zonesModel,mstrmojo.vi.viz.EnumDSSDropZones.ColorBy)[0]||null;},hasSizebyOrColorby:function(){return AK.getPropertyByPath(this,"dropZoneInfo.edgeColor.id",false)||AK.getPropertyByPath(this,"dropZoneInfo.edgeSize.id",false)||AK.getPropertyByPath(this,"dropZoneInfo.itemSize.id",false);},hasSizeByMetric:function(){return AK.getPropertyByPath(this,"dropZoneInfo.itemSize.t")===c.DssTypeMetric;},setError:function(Ai,Ah){var Ag=AK.translateGridError(Ai,Ah);this.error=Ag.msg;this.errorType=Ag.type;},clearError:function(){this.error=undefined;this.errorType=undefined;},hasError:function(){return this.error!==undefined||this.errorType!==undefined;},isEmpty:function(){return this.hasError();},getVisEmptyMsgControls:function(){return AK.getVisEmptyMsgControls.call(this);},preBuildRendering:function(){if(this.waitingForData){return ;}this._super();var Ag=this.stage;if(Ag){Ag.height=parseInt(this.height,10);Ag.width=parseInt(this.width,10);if(!this.hasError()&&!this.waitingForData){this.defaultsLegendPop=AM.call(this,(this.themeType==="light"?0:1));this.initHTML5Props(this.HTML5PROPS);}}},postBuildRendering:function(){var Ah="timerid_fromBuildtoEnd";x.startTimer({functionName:"VisNetwork.postBuildRendering",purpose:"from Build to End"},Ah);if(this.waitingForData){return ;}if(this.isEmpty()){if(AK.isOnExpressMode()){AK.renderWidgetErrorRSD(this,this.error,E);}else{this._super();}return ;}this.addChildren(this.stage);if(this.excludeData){this.raiseEvent({name:"toggleCtrlOverlay",visible:true,controls:this.getVisEmptyMsgControls()});return ;}this.stage.render();this.initLegend();D.call(this);this.layoutSprites(this.abstractedModel,this.stage,H[this.propInfo.layoutMode]);this.stage.draw(false);this.attachEventListener("click",this.id,this.onclick);var Ag=this.getExp(),Ai=this.getRowsAndCols();AK.modifyScExp(Ag,Ai,this.model,this.normalizedIdCache);if(this._super){this._super();}x.endTimer(Ah);},destroy:function(){if(this.legend){this.legend.hideToolbar();}g.call(this);delete this.modelData;delete this.propInfo;delete this.legend;delete this.abstractedModel;if(this._super){this._super();}},getProperties:function(){return(this.modelData&&this.modelData.vp)||{};},getProperty:function(Ag){var Ah=this.getProperties();return Ah[Ag];},getDropZone:function(){var Ah=this.modelData&&this.modelData.dz;if(!AK.isValidDropZone(Ah)){Ah={};var Am=this.model&&this.model.data;if(Am){var Ai=Am.gts||{},Aj=Ai.row||[],Al=(Ai.col&&Ai.col[0]&&Ai.col[0].es)||[],An=["from","to"],Ag=["SizeBy","ColorBy","itemsz"],Ak=[{units:Aj,unitKeys:An,setKey:"TemplateUnit"},{units:Al,unitKeys:Ag,setKey:"TemplateMetric"}];R.forEach(Ak,function(Ao){R.forEach(Ao.units,function(Aq,As){var Ap=Ao.unitKeys[As];if(Ap){var Ar={};Ar[Ao.setKey]=[{id:Aq.oid||Aq.id,t:Aq.otp}];Ah[Ap]=Ar;}});});}}return Ah;},onAppStateChange:function AF(Ag){this._super(Ag);if(!this.selectorControl){this.clearSelections(true);}},onclick:function(Ag){delete this.noHighlightAfterKeepOnlyExcludeDrill;var Aj=Ag.e||Ag,Ai=Aj.target,Ah;if(Ai===this.circularIcon){Ah="0";}if(Ai===this.linearIcon){Ah="1";}if(Ai===this.forceDirectedIcon){Ah="2";}if(Ah){this.observableModel.layoutMode.setValue(Ah);}this.stage.dismissLassoSelector();if(this.legend){this.legend.hideToolbar();}},oncontextmenu:function(Ag){delete this.noHighlightAfterKeepOnlyExcludeDrill;var Ah=Ag.getTarget();Ag.cancel();Ag.preventDefault();if(this.legend){if(AW.contains(this.legend.domNode,Ah,true)){this.legend.handleRMCOnLegend(Ag);}else{this.legend.hideToolbar();}}},dismissLassoSelector:function L(){var Ag=this.stage;if(Ag){Ag.dismissLassoSelector();}},onmouseup:function(Ag){var Ai=Ag.e||Ag,Aj=this.stage,Ah=Ai.target||Ai.srcElement;if(!AW.contains(Aj.domNode,Ah,true)){Aj.dismissLassoSelector();}},initLegend:function(){var Ah=0,Ag=0;this.hEvalSize4Legend();if(this.propInfo.showLegend){this.renderLegend();var Ai=s[this.legend.currDockedPositionIdx];Ah=this.isOnRight(Ai.pos)?0:this.legendW;if(this.isLegendSwitchOverlap()){Ag=Y+this.modeSwitchButtonRect.w;this.modeSwitchButtonRect.r=this.legendW+Y;}else{this.modeSwitchButtonRect.r=Y;}}this.modeSwitchButton.style.right=this.modeSwitchButtonRect.r+"px";this.stage.setMainRect({x:Ah,y:0,w:parseInt(this.width-Ag-this.legendW,10),h:parseInt(this.height,10)});},hEvalSize4Legend:function(){var Al,Aj=this.abstractedModel.edgeColorByInfo,Ai=this.abstractedModel.itemSizeByInfo,Ah=this.abstractedModel.edgeSizeByInfo,Ak=this.getWidth(),Ag=this.getHeight(),Am=this.HTML5PROPS.LEGEND,An;if(this.propInfo.showLegend===false){this.legendW=this.legendH=this.legendP=0;}else{U.applyHTML5Props(Am);this.legendP=h;An=this.readGlobalProperty(AU.SCALE_LEGEND_WIDTH);if(An===undefined||!this.legendScale||this.legendScale!==An){this.legendScale=An;this.legendResized=true;this.legendFixedW=undefined;}Al=U.getLegendSize([{dataType:AY.COLOR_BY,dataObj:Aj},{dataType:AY.SIZE_BY,dataObj:Ai},{dataType:AY.SIZE_BY,dataObj:Ah}],this.legendResized?this.legendScale:undefined,Ak,Ag,Am,this.legendFixedW);this.legendCutBy=Al.cutBy;this.legendMinHeight=Al.minHeight;this.legendFixedW=Al.width;if(Al.scale){this.legendScale=Al.scale;}if(this.readGlobalProperty(AU.LEGEND_MODE)===AN.MINIMIZED||Al.autoCollapse){Al=U.getLegendSize4MinMode(Aj,Ag);this.legendCutBy=undefined;}this.legendW=Al.width;this.legendH=Al.height;}},hInitLegendListeners:function(){var Ag=this,Ah=this.id;if(this.legend){this.legendResizeListener=this.legend.attachEventListener("gm-legend-resized",Ah,function(Ai){Ag.onLegendResized(Ai.position);});this.legendClickListener=this.legend.attachEventListener("gm-legend-clicked",Ah,function(Ai){Ag.onLegendClicked(Ai);});}},onLegendResized:function(Ai){function Ag(){var Aj=this.legend;if(Aj){this.hEvalSize4Legend();this.updateLegend();Aj.updateAfterResize();this.updateStageContentForLegendChanged(s[Aj.currDockedPositionIdx].pos);}}function Ah(Ak,Aj){if(Aj){this.legendScale=Ak;this.legendResized=true;this.legendFixedW=undefined;Ag.call(this);}}if(this.legend){this.legendFixedW=this.legendW+Ai;this.legendScale=(this.legendFixedW)/(this.legendW/this.legendScale);this.legendResized=true;this.writeLgendFormatProperty(AU.SCALE_LEGEND_WIDTH,this.legendScale,{success:Ah});Ag.call(this);}},onLegendClicked:function(Ag){var Ai=Ag.action,Ah=this.legend,Aj={success:function(){this.hEvalSize4Legend();this.updateLegend();this.updateStageContentForLegendChanged(s[Ah.currDockedPositionIdx].pos);}};if(Ai==="close"){this.observableModel.showLegend.setValue(false);return ;}if(Ai==="minimize"){this.writeLgendFormatProperty(AU.LEGEND_MODE,AN.MINIMIZED,Aj);}else{if(Ai==="restore"){this.writeLgendFormatProperty(AU.LEGEND_MODE,AN.RESTORED,Aj);}}},renderLegend:function(){var Ag=this.legendPlaceholder;if(!this.propInfo.showLegend){Ag.style.display="none";}Ag.style.width=this.legendW+"px";Ag.style.height=this.legendH+"px";this.legend=this.addDisposable(new Ad.GMLegend({widget:this,model:this.model,placeholder:Ag,currDockedPositionIdx:t(this.readGlobalProperty(AU.LEGEND_POSITION)),cutBy:this.legendCutBy,cssClass:"gm-legend",styles:this.HTML5PROPS.LEGEND,readGlobalProperty:function(Ah){return this.widget.readGlobalProperty(Ah);},writeGlobalProperty:function(Ah,Ai){this.widget.writeLgendFormatProperty(Ah,Ai,{success:function(){this.widget.reRender();}.bind(this)});},configureLegendPopup:function(Ah,Ai){return this.widget.configurePopup(Ah,Ai);}}));this.legend.render();this.legend.parent=this;this.legend.cutBy=this.legendCutBy;this.legend.minHeight=this.legendMinHeight;this.legend.updateContainerSize(this.getWidth(),this.getHeight());this.legendPlaceholder=this.legend.domNode;this.hInitLegendListeners();this.legend.feedData([{dataType:AY.COLOR_BY,dataObj:this.abstractedModel.edgeColorByInfo},{dataType:AY.SIZE_BY,dataObj:this.abstractedModel.edgeSizeByInfo},{dataType:AY.SIZE_BY,dataObj:this.abstractedModel.itemSizeByInfo}],(this.readGlobalProperty(AU.LEGEND_MODE)===AN.MINIMIZED));},showMenu:o,showSelectionMenu:function(Ai,Aj,Ah){var Ag;if(!AK.isOnExpressMode()){Ag=this.getSelectionMenuConfig();if(!mstrApp.isAppStatePresentation()&&mstrApp.allowWebDashboardDesign()&&Aj){if(Ag.hasMenuItems()){Ag.addSeparator();}Ag.addMenuItem(mstrmojo.desc(1918,"Format"),"xt",Aj);}if(Ag.hasMenuItems()){this.showMenu(Ag,Ai,Ah);}}},showBlankSpaceMenu:function(Ag,Ah){if(!AK.isOnExpressMode()&&!mstrApp.isAppStatePresentation()&&mstrApp.allowWebDashboardDesign()&&!mstrApp.isInVFConfigMode){this.showMenu(this.getBlankSpaceMenuConfig(Ah),Ag);}},getSelectionMenuConfig:function(){var Ag=AK.mergeHashes(F.call(this),d.call(this)),Ah=[{name:"filter"},{name:"editGroup"},{name:"editCalculation"},{name:"createDe"},{name:"showData"},{name:"renameDe"}];return AK.mergeMenuConfigs(Ag,Ah);},getFormatMenuConfig:function(){var Ag=this.addDisposable(new mstrmojo.ui.menus.MenuConfig()),Ah=AK.getPropertyByPath(this,"stage.observableModel.circleStyle.showNodeLabel"),Aj=!!(Ah&&Ah.getValue()),Ai;if(Aj){Ai=mstrmojo.desc(13688,"Hide Node Label");}else{Ai=mstrmojo.desc(12079,"Show Node Label");}Ag.addMenuItem(Ai,"xt",function(){Ah.setValue(!Aj);});return Ag;},getBlankSpaceMenuConfig:function(Ai){var Ag=this.addDisposable(new mstrmojo.ui.menus.MenuConfig()),Ah=this;Ai=Ai||function(){mstrApp.rootCtrl.docCtrl.selectViPanel("propertiesPanel");};Ag.addMenuItem(mstrmojo.desc(1918,"Format"),"xt",Ai);if(this.hasSizebyOrColorby()){if(!Ah.propInfo.showLegend){Ag.addMenuItem(mstrmojo.desc(12001,"Show Legend"),"xt",this.getMenuHandler("showLegend"));}}return Ag;},getLocalProp:function(Ag){return this.localProps[Ag];},setLocalProp:function(Ah,Ag){this.localProps[Ah]=Ag;},unrender:function(){if(this.legendResizeListener){this.legendResizeListener.clear();}if(this.legendClickListener){this.legendClickListener.clear();}if(this.legend){this.legend.unrender();}if(this.stage){if(this.stage._contextMenuAnchor){this.stage._contextMenuAnchor=undefined;}this.removeChildren(this.stage);}var Ag=this._lastOpened;if(Ag){this.closePopup();}if(this._super){this._super();}},generateSprites:function r(Ah,Ai){function Aj(Ak){Ak.sprite=Ai.createSprite({type:"Circle",position:{x:0,y:0,r:Ak.size},text:Ak.getName(),title:Ak.getAttributeName(),attSrc:Ak.attSrc,forms:Ak.getFormNames(),formValues:Ak.getFormValues(),displayValue:Ak.format(Ak.getAggregatedValue()),aggregationName:Ak.itemSizeMetricName?Ak.aggregationName:null,unit:Ak,style:Ak.style,selfLoop:Ak.hasSelfLoop});Ai.addSprite(Ak.sprite);}function Ag(Ak){Ak.sprite=Ai.createSprite({type:"Edge",from:Ak.from.sprite,to:Ak.to.sprite,controlPoint:{x:Ai.width/2,y:Ai.height/2},color:Ak.color,width:Ak.width,unit:Ak});Ai.addSprite(Ak.sprite);}Ai.clearSprites();R.forEach(Ah.nodes,Aj);R.forEach(Ah.edges,Ag);},getSelectedNodes:function(){return AK.pluck((this.stage.selectedSprites||[]).filter(function(Ag){return Ag.type==="Circle"&&Ag.unit;}),"unit");},getContextMenuSelectedNodes:function(){return AK.pluck((this.stage.contextMenuSelection||[]).filter(function(Ag){return Ag.type==="Circle"&&Ag.unit;}),"unit");},keepOnly:function(){var Ag=this.abstractedModel.nodes,An=Ag.length,Ao=this.getSelectedNodes(),Aj=Ao.length,Al,Ah;for(Al=0;Al<Aj;Al++){Ah=Ao[Al];var Ai=Ah.adjacence,Am=Ai.length,Ak;for(Ak=0;Ak<Am;Ak++){if(!Ai[Ak].isExcluded&&Ao.indexOf(Ai[Ak])===-1){Ao.push(Ai[Ak]);}}}for(Al=0;Al<An;Al++){Ah=Ag[Al];if(Ao.indexOf(Ah)===-1){Ah.exclude();}}this.stage.draw(false);},exclude:function(){var Ai=this.getSelectedNodes(),Ag=Ai.length,Ah;for(Ah=0;Ah<Ag;Ah++){Ai[Ah].exclude();}this.stage.draw(false);},getSelectedNodesInfo:function(){var Ag=[];R.forEach(this.getSelectedNodes(),function(Ah){Ag.push(Ah.getActionInfo());});return Ag;},getContextMenuSelectedNodesInfo:function(){var Ag=[];R.forEach(this.getContextMenuSelectedNodes(),function(Ah){Ag.push(Ah.getActionInfo());});return Ag;},getMenuHandler:function(Ah){var Am=this,Ap=this._super(Ah);if(Ap!==mstrmojo.emptyFn){return Ap;}var Ai={keepOnly:function Aj(){Am.updateAfterKeepOnly(true);Am.noHighlightAfterKeepOnlyExcludeDrill=true;},exclude:function Ao(){Am.updateAfterKeepOnly(false);Am.noHighlightAfterKeepOnlyExcludeDrill=true;},drill:function Al(Aq){AK.doDrill(Am,Aq.ctxt.drillUnit,AL,Aq.ctxt);Am.noHighlightAfterKeepOnlyExcludeDrill=true;},showData:function Ak(){Am.showData(Am.getContextMenuSelectedNodesInfo());},showLegend:function An(){Am.observableModel.showLegend.setValue(true);},hideLegend:function Ag(){Am.observableModel.showLegend.setValue(false);}};if(Ai.hasOwnProperty(Ah)){return Ai[Ah];}return mstrmojo.emptyFn;},doSelection:function(Ag,Ah){this.prepareSelectedNodesInfo(Ag,Ah);if(!Ah){this.endSelections();}},onStylesModified:function(Ai,Aj,Al){var Ak=function(Am){return function(Ap,Ao){var An=this.propInfo;An.unmarshal(Am,Ap);Al.call(this.stage,An[Am],Ao);};};var Ag={circleStyle:function(Am){this.setProperty(AH.bubbleStyle,Am,{suppressData:true,clientUndoRedoCallback:Ak("circleStyle")});},background:function(Am){this.propInfo.background=Am;},circleLabelStyle:function(Am){this.setProperty(AH.circleLabelFont,Am,{suppressData:true,clientUndoRedoCallback:Ak("circleLabelStyle")});},dragMode:function(Am){this.setProperty(AH.dragMode,Am,{suppressData:true,clientUndoRedoCallback:Ak("dragMode")});}};if(Ag[Ai]){this.propInfo[Ai]=Aj;var Ah=Ag[Ai];if(Ah instanceof Function){Ah.call(this,this.propInfo.marshal(Ai));}}},layoutSprites:function(Ah,Ai,Ag){var Aj="timerid_layoutSprites";x.startTimer({functionName:"VisNetwork.layoutSprites",purpose:"layout the bubbles"},Aj);z(Ah);R.forEach(Ah.nodes,function(Ak){Ak.sprite.setGeometry({s:Ak.size});});R.forEach(Ah.edges,function(Ak){Ak.sprite.setGeometry({s:Ak.width});});this.layouts[Ag].call(this,Ah,Ai,Q(Ah));Ai.setScene();x.endTimer(Aj);},readGlobalProperty:function(Ag){var Ah;switch(Ag){case AZ.LEGEND_BG_COLOR:Ah=this.propInfo.lgdBgFillClr;break;case AZ.LEGEND_BG_FILL_STYLE:Ah=this.propInfo.lgdBgFillStyle;break;case AZ.LEGEND_BG_FILL_EFFECT:Ah=this.propInfo.lgdBgFillEff;break;case AZ.LEGEND_BG_FILL_TRANSPARENCY:Ah=this.propInfo.lgdBgFillTrans;break;case AZ.LEGEND_FONT_SIZE:Ah=this.propInfo.lgdFntSz;break;case AZ.LEGEND_FONT_FAMILY:Ah=this.propInfo.lgdFntFml;break;case AZ.LEGEND_FONT_STYLE:Ah=this.propInfo.lgdFntStyle;break;case AZ.LEGEND_FONT_COLOR:Ah=this.propInfo.lgdFntClr;break;case AZ.LEGEND_BORDER_SHOW:Ah=this.propInfo.lgdBdrShw;break;case AZ.LEGEND_BORDER_COLOR:Ah=this.propInfo.lgdBdrClr;break;case AZ.LEGEND_BORDER_LINE_STYLE:Ah=this.propInfo.lgdBdrStyle;break;case AZ.COLOR_SQUARE_COLOR:Ah=this.propInfo.clrSqrClr;break;case AU.LEGEND_MODE:Ah=this.propInfo.lm;break;case AU.LEGEND_POSITION:Ah=this.propInfo.LegendPosition;break;case AU.SCALE_LEGEND_WIDTH:Ah=this.propInfo.lwr;break;}if(Ah===undefined||((typeof Ah)==="number"&&isNaN(Ah))){Ah=this.defaultsLegendPop&&this.defaultsLegendPop[Ag];}return Ah;},initHTML5Props:function(Ai){function Ah(Ak,Aj){Ak.fontWeight=(Aj&G.FS_BOLD?"bold":"normal");Ak.fontStyle=(Aj&G.FS_ITALIC?"italic":"normal");if((Aj&G.FS_STRIKETHROUGH)&&(Aj&G.FS_UNDERLINE)){Ak.textDecoration="line-through underline";}else{if(Aj&G.FS_STRIKETHROUGH){Ak.textDecoration="line-through";}else{if(Aj&G.FS_UNDERLINE){Ak.textDecoration="underline";}else{Ak.textDecoration="none";}}}}var Ag={};Ag.fontFamily=this.readGlobalProperty(AZ.LEGEND_FONT_FAMILY);Ag.fontSize=this.readGlobalProperty(AZ.LEGEND_FONT_SIZE);Ah(Ag,this.readGlobalProperty(AZ.LEGEND_FONT_STYLE));Ag.color=AQ.decodeColor(this.readGlobalProperty(AZ.LEGEND_FONT_COLOR));Ag.backgroundColor=AQ.decodeColor(this.readGlobalProperty(AZ.LEGEND_BG_COLOR));Ag.opacity=this.readGlobalProperty(AZ.LEGEND_BG_FILL_TRANSPARENCY)/100;if(this.readGlobalProperty(AZ.LEGEND_BORDER_SHOW)){Ag.borderWidth=AK.translateLineStyle(this.readGlobalProperty(AZ.LEGEND_BORDER_LINE_STYLE)).width;Ag.borderStyle=AK.translateLineStyle(this.readGlobalProperty(AZ.LEGEND_BORDER_LINE_STYLE)).style;Ag.borderColor=AQ.decodeColor(this.readGlobalProperty(AZ.LEGEND_BORDER_COLOR));}Ai.LEGEND=Ag;},configurePopup:function y(Ag,Ah){Ag.hostId=this.id;Ag.hostElement=Ah;},writeLgendFormatProperty:function(Ai,Aj,Al){var Ah=!!(Al&&Al.success),Ak=function(Ao,An){var Am=this.propInfo;Am.unmarshal(Ai,Ao);if(Ah){Al.success.call(this,Am[Ai],An);}},Ag;if(Ai===AZ.COLOR_SQUARE_COLOR){this.propInfo.unmarshal(Ai,Aj);this.setProperty(Ai,Aj,{callback:Al});}else{if(this.observableModel[Ai]){Ag=this.observableModel[Ai];Ag.setValue(Aj);}else{Ak.call(this,Aj,false);this.setProperty(Ai,Aj,{suppressData:true,clientUndoRedoCallback:Ah?Ak:undefined});}}},onLegendDropZoneChange:function b(Ag,Ah){this.setLegendSlot(Ag,Ah);},onLegendDropped:function(Ag){this.writeLgendFormatProperty(AU.LEGEND_POSITION,Ag,{success:function(Ai,Ah){if(Ah){this.renderLegend();this.updateStageContentForLegendChanged(Ai);}}});},setLegendSlot:function(Aj,Am){var Al=this.legend.currDockedPositionIdx;if(Am!==Al){var Ag=this.isOnRight(s[Al].pos),Ak=this.isOnRight(Aj.pos),Ah=this.isOnRightTop(s[Al].pos),Ai=this.isOnRightTop(Aj.pos);if(Ag!==Ak||(Ag&&Ak&&Ah!==Ai)){this.updateStageContentForLegendChanged(Aj.pos);}}},isOnRight:function(Ag){return(Ag===p.RIGHT_MIDDLE||Ag===p.RIGHT_TOP||Ag===p.RIGHT_BOTTOM);},isOnRightTop:function(Ag){return Ag===p.RIGHT_TOP;},isLegendSwitchOverlap:function(){var Aj=AW.position(this.legend.domNode),Ah=AW.position(this.modeSwitchButton),Ai=Aj.x,Ap=Aj.y,Al=Ai+Aj.w,An=Ap+Aj.h,Ag=Ah.x,Ao=Ah.y,Ak=Ag+Ah.w,Am=Ao+Ah.h;return !(Ai>=Ak||Ap>=Am||Ag>=Al||Ao>=An);},updateStageContentForLegendChanged:function(Aj,Ai){var Ah=0,Ag=0;Ai=(typeof Ai==="number")?Ai:this.legendW;this.modeSwitchButtonRect.r=Y;if(this.propInfo.showLegend){Aj=Aj||this.readGlobalProperty(AU.LEGEND_POSITION);Ah=this.isOnRight(Aj)?0:Ai;if(this.isLegendSwitchOverlap()){Ag=Y+this.modeSwitchButtonRect.w;this.modeSwitchButtonRect.r=Ai+Y;}}this.stage.setMainRect({x:Ah,y:0,w:parseInt(this.width-Ag-Ai,10),h:parseInt(this.height,10)});this.modeSwitchButton.style.right=this.modeSwitchButtonRect.r+"px";D.call(this);this.stage.setScene();this.stage.draw(false);},updateLegend:function(){var Ag=this.legend,Ai=this.abstractedModel,Ah=this.legendPlaceholder.style;Ah.width=this.legendW+"px";Ah.height=this.legendH+"px";Ag.width=this.legendW;Ag.height=this.legendH;Ag.cutBy=this.legendCutBy;Ag.minHeight=this.legendMinHeight;Ag.updateContainerSize(this.getWidth(),this.getHeight());Ag.feedData([{dataType:AY.COLOR_BY,dataObj:Ai.edgeColorByInfo},{dataType:AY.SIZE_BY,dataObj:Ai.edgeSizeByInfo},{dataType:AY.SIZE_BY,dataObj:Ai.itemSizeByInfo}],(this.readGlobalProperty(AU.LEGEND_MODE)===AN.MINIMIZED));Ag.updateAfterResize();},toggleLegend:function(Ag){var Ai=this.legend,Ah;if(!Ai||!Ai.hasRendered||!Ai.domNode){this.initLegend();Ai=this.legend;}Ah=Ai.domNode.style;if(!Ag){Ai.hideToolbar();Ah.display="none";}else{if(Ah.display!=="block"){Ah.display="block";}}},getCellForNode:function i(Ah){var Aj=Ah.unit,Ag=Aj.attribute,Ai=Aj.attributeElements[0];return{at:Ai.at,dei:Ai.dei,dpt:Ai.dpt,o:Ai.o,n:Ah.title,tui:Ai.tui,ui:Ai.tui,axis:1,v:Ah.text,tid:Ag.id};},getCellUnitIndex:function B(Ag){return Ag.o;},execFormatHandler:function(){var Ag=this.stage;if(Ag){Ag.execFormatHandler();}},onNDECreated:function(Ag){var Ai=this.stage,Ah=Ai.spriteCollection;Ag.forEach(function(Am){var Aj=Am.id,Al=Am.unitId;var Ak=AK.findInArray(Ah,function(An){var Ao=An.unit;return An.type==="Circle"&&Ao.attribute.id===Al&&Ao.attributeElements.some(function(Ap){return Ap.id.indexOf(Aj)!==-1;});});if(Ak!==-1){Ai.addToSelection(Ah[Ak]);}});Ai.draw(false,true);},isClearAllEnabled:function(Ah){var Ag=AK.getPropertyByPath(this,"modelData",{}),Ai=AK.getPropertyByPath(Ah,"attribute.sc",Ag.sc);return !!(Ai===undefined||Ai.showall);}});}());