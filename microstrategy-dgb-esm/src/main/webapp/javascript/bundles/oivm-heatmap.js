mstrmojo.chart.enums.EnumGraphMajorType={GMT_INVALID:0,GMT_CATEGORY:1,GMT_PIE:2,GMT_SCATTER:3,GMT_POLAR:4,GMT_RADAR:5,GMT_BUBBLE:6,GMT_STOCK:7,GMT_HISTOGRAM:8,GMT_GAUGE:9,GMT_FUNNEL:10,GMT_BOX:11,GMT_GANTT:12,GMT_SPECTRAL:13,GMT_TABLE:14,GMT_3D_CATEGORY:15,GMT_3D_SCATTER:16,GMT_GRID:17};mstrmojo.vi.viz.EnumDSSDropZones={Reserved:0,Rows:1,Columns:2,XAxis:3,YAxis:4,BreakBy:5,SliceBy:6,ColorBy:7,SizeBy:8,AdditionalMetrics:9,Angle:10,Grouping:11,GeoAttribute:12,Layout:13,FromItem:14,ToItem:15,ItemSize:16,Latitude:17,Longitude:18,Metric:19,Trend:20};mstrmojo.vi.viz.EnumVisualizationTemplates={UNKNOWN_GRAPHMATRIX_TYPE:-1,GRID:0,HEATMAP:1,GOOGLEMAP:2,PIE:3,RING:4,GRAPHMATRIXVERTICALBARSTACKED:6,GRAPHMATRIXVERTICALBARCLUSTERED:7,GRAPHMATRIXVERTICALBARPERCENT:8,GRAPHMATRIXHORIZONTALBARSTACKED:9,GRAPHMATRIXHORIZONTALBARCLUSTERED:10,GRAPHMATRIXHORIZONTALBARPERCENT:11,GRAPHMATRIXVERTICALLINESTACKED:12,GRAPHMATRIXVERTICALLINECLUSTERED:13,GRAPHMATRIXVERTICALLINEPERCENT:14,GRAPHMATRIXHORIZONTALLINESTACKED:15,GRAPHMATRIXHORIZONTALLINECLUSTERED:16,GRAPHMATRIXHORIZONTALLINEPERCENT:17,GRAPHMATRIXSCATTERCIRCLEMM:18,GRAPHMATRIXSCATTERGRIDCIRCLEAA:19,GRAPHMATRIXBUBBLECIRCLEMM:21,GRAPHMATRIXBUBBLEGRIDCIRCLEAA:22,GRAPHMATRIXSCATTERSQUAREAM:23,GRAPHMATRIXSCATTERSQUAREMM:24,GRAPHMATRIXSCATTERGRIDSQUAREAA:25,GRAPHMATRIXBUBBLESQUAREAM:26,GRAPHMATRIXBUBBLESQUAREMM:27,GRAPHMATRIXBUBBLEGRIDSQUAREAA:28,GRAPHHORIZONTALBARCLUSTERED:29,GRAPHMATRIXVERTICALAREASTACKED:30,GRAPHMATRIXVERTICALAREAPERCENT:31,GRAPHMATRIXVERTICALAREACLUSTERED:32,GRAPHMATRIXHORIZONTALAREASTACKED:40,GRAPHMATRIXHORIZONTALAREAPERCENT:41,GRAPHMATRIXHORIZONTALAREACLUSTERED:42,GRAPHHORIZONTALBARDUALAXISCLUSTERED:33,GRAPHHORIZONTALBARDUALAXISABSOLUTE:34,GRAPHHORIZONTALLINEABSOLUTE:35,GRAPHHORIZONTALLINEDUALAXISABSOLUTE:36,GRAPHHORIZONTALAREAABSOLUTE:37,GRAPHHORIZONTALAREADUALAXISABSOLUTE:38,GRAPHVERTICALBARCLUSTERED:39,GRAPHVERTICALBARDUALAXISCLUSTERED:43,GRAPHVERTICALBARDUALAXISABSOLUTE:44,GRAPHVERTICALBARDUALAXISSTACKED:45,GRAPHVERTICALLINEABSOLUTE:46,GRAPHVERTICALLINESTACKED:47,GRAPHVERTICALLINEPERCENT:48,GRAPHVERTICALLINEDUALAXISABSOLUTE:49,GRAPHVERTICALLINEDUALAXISSTACKED:50,GRAPHVERTICALAREAABSOLUTE:51,GRAPHVERTICALAREAPERCENT:52,GRAPHVERTICALAREASTACKED:53,GRAPHVERTICALAREADUALAXISABSOLUTE:54,GRAPHVERTICALAREADUALAXISSTACKED:55,GRAPHCOMBINATIONBARAREA:56,GRAPHCOMBINATIONBARAREADUALAXIS:57,NETWORK:58,IMAGELAYOUT:59,GOOGLEMAPDENSITY:60,GRAPHMATRIXPIE:61,GRAPHMATRIXRING:62,GRAPHHORIZONTALBARABSOLUTE:63,GRAPHHORIZONTALBARPERCENT:64,GRAPHHORIZONTALBARSTACKED:65,GRAPHVERTICALBARABSOLUTE:66,GRAPHVERTICALBARPERCENT:67,GRAPHVERTICALBARSTACKED:68,ESRIMAP:69,GRAPHMATRIXVERTICALBARAUTOMATIC:70,GRAPHMATRIXHORIZONTALBARAUTOMATIC:71,GRAPHMATRIXVERTICALLINEAUTOMATIC:72,GRAPHMATRIXHORIZONTALLINEAUTOMATIC:73,GRAPHMATRIXVERTICALAREAAUTOMATIC:74,GRAPHMATRIXHORIZONTALAREAAUTOMATIC:75,GRAPHMATRIXVERTICALHISTOGRAM:76,GRAPHMATRIXGRIDCHART:78,GRAPHMATRIXVERTICALBOXPLOT:79,GRAPHMATRIXHORIZONTALBOXPLOT:80,GRAPHMATRIXVERTICALWATERFALL:81,GRAPHMATRIXHORIZONTALWATERFALL:82,KPICARD:83};var T=mstrmojo.vi.viz.EnumVisualizationTemplates;mstrmojo.vi.viz.EnumAggregatedVisTemplates={COMBOCHART:[T.GRAPHHORIZONTALBARDUALAXISCLUSTERED,T.GRAPHHORIZONTALBARDUALAXISABSOLUTE,T.GRAPHHORIZONTALLINEDUALAXISABSOLUTE,T.GRAPHHORIZONTALAREADUALAXISABSOLUTE,T.GRAPHVERTICALBARDUALAXISCLUSTERED,T.GRAPHVERTICALBARDUALAXISABSOLUTE,T.GRAPHVERTICALBARDUALAXISSTACKED,T.GRAPHVERTICALLINEDUALAXISABSOLUTE,T.GRAPHVERTICALLINEDUALAXISSTACKED,T.GRAPHVERTICALAREADUALAXISABSOLUTE,T.GRAPHVERTICALAREADUALAXISSTACKED,T.GRAPHCOMBINATIONBARAREADUALAXIS,T.GRAPHCOMBINATIONBARAREA],BUBBLECHART:[T.GRAPHMATRIXSCATTERCIRCLEMM,T.GRAPHMATRIXSCATTERGRIDCIRCLEAA,T.GRAPHMATRIXBUBBLECIRCLEMM,T.GRAPHMATRIXBUBBLEGRIDCIRCLEAA,T.GRAPHMATRIXSCATTERSQUAREAM,T.GRAPHMATRIXSCATTERSQUAREMM,T.GRAPHMATRIXSCATTERGRIDSQUAREAA,T.GRAPHMATRIXBUBBLESQUAREAM,T.GRAPHMATRIXBUBBLESQUAREMM,T.GRAPHMATRIXBUBBLEGRIDSQUAREAA],BARCHART:[T.GRAPHMATRIXVERTICALBARSTACKED,T.GRAPHMATRIXVERTICALBARCLUSTERED,T.GRAPHMATRIXVERTICALBARPERCENT,T.GRAPHMATRIXHORIZONTALBARSTACKED,T.GRAPHMATRIXHORIZONTALBARCLUSTERED,T.GRAPHMATRIXHORIZONTALBARPERCENT,T.GRAPHHORIZONTALBARCLUSTERED,T.GRAPHVERTICALBARCLUSTERED,T.GRAPHHORIZONTALBARABSOLUTE,T.GRAPHHORIZONTALBARPERCENT,T.GRAPHHORIZONTALBARSTACKED,T.GRAPHVERTICALBARABSOLUTE,T.GRAPHVERTICALBARPERCENT,T.GRAPHVERTICALBARSTACKED,T.GRAPHMATRIXVERTICALBARAUTOMATIC,T.GRAPHMATRIXHORIZONTALBARAUTOMATIC],LINECHART:[T.GRAPHMATRIXVERTICALLINESTACKED,T.GRAPHMATRIXVERTICALLINECLUSTERED,T.GRAPHMATRIXVERTICALLINEPERCENT,T.GRAPHMATRIXHORIZONTALLINESTACKED,T.GRAPHMATRIXHORIZONTALLINECLUSTERED,T.GRAPHMATRIXHORIZONTALLINEPERCENT,T.GRAPHHORIZONTALLINEABSOLUTE,T.GRAPHVERTICALLINEABSOLUTE,T.GRAPHVERTICALLINESTACKED,T.GRAPHVERTICALLINEPERCENT,T.GRAPHMATRIXVERTICALLINEAUTOMATIC,T.GRAPHMATRIXHORIZONTALLINEAUTOMATIC],PIECHART:[T.PIE,T.RING,T.GRAPHMATRIXPIE,T.GRAPHMATRIXRING],AREACHART:[T.GRAPHMATRIXVERTICALAREASTACKED,T.GRAPHMATRIXVERTICALAREAPERCENT,T.GRAPHMATRIXVERTICALAREACLUSTERED,T.GRAPHMATRIXHORIZONTALAREASTACKED,T.GRAPHMATRIXHORIZONTALAREAPERCENT,T.GRAPHMATRIXHORIZONTALAREACLUSTERED,T.GRAPHHORIZONTALAREAABSOLUTE,T.GRAPHVERTICALAREAABSOLUTE,T.GRAPHVERTICALAREAPERCENT,T.GRAPHVERTICALAREASTACKED,T.GRAPHMATRIXVERTICALAREAAUTOMATIC,T.GRAPHMATRIXHORIZONTALAREAAUTOMATIC],HISTOGRAM:[T.GRAPHMATRIXVERTICALHISTOGRAM,],BOXPLOT:[T.GRAPHMATRIXVERTICALBOXPLOT,T.GRAPHMATRIXHORIZONTALBOXPLOT],WATERFALL:[T.GRAPHMATRIXVERTICALWATERFALL,T.GRAPHMATRIXHORIZONTALWATERFALL]};mstrmojo.chart.model.enums.EnumDSSGraphObject={DssGraphNull:-3,DssGraphBackground:1,DssGraphFrame:2,DssGraphFootnote:3,DssGraphSubtitle:4,DssGraphTitle:5,DssGraphLegendArea:6,DssGraphLegendLine:7,DssGraphLegendMarker:8,DssGraphLegendText:9,DssGraphCurve:257,DssGraphDataLine:258,DssGraphDataMarker:259,DssGraphDataText:260,DssGraphDivBiPolar:261,DssGraphErrorBar:262,DssGraphLinrExp:263,DssGraphLinrLine:264,DssGraphLinrLog:265,DssGraphLinrNatLog:266,DssGraphLinrNPoly:267,DssGraphLinrText:268,DssGraphMeanLine:269,DssGraphMovAvgLine:270,DssGraphO1Body:271,DssGraph2DO1Label:272,DssGraphO1Major:273,DssGraphO1Minor:274,DssGraphO1Super:275,DssGraphO1Title:276,DssGraphO2Body:277,DssGraph2DO2Label:278,DssGraphO2Major:279,DssGraphO2Minor:280,DssGraphO2Title:281,DssGraphConnectDataLine:282,DssGraphRiser:286,DssGraphRiserShadow:287,DssGraphStdDevLine:288,DssGraphX1Body:289,DssGraphX1Label:290,DssGraphX1Major:291,DssGraphX1Minor:292,DssGraphXTitle:293,DssGraphY1Body:295,DssGraphY1Label:296,DssGraphY1Major:297,DssGraphY1Minor:298,DssGraphY1Title:299,DssGraphY2Body:301,DssGraphY2Label:302,DssGraphY2Major:303,DssGraphY2Minor:304,DssGraphY2Title:305,DssGraph3DShowColumnHeaders:318,DssGraph3DShowLeftHeaders:321,DssGraph3DShowRightHeaders:323,DssGraph3DShowRowHeaders:325,DssGraphOBPBox:329,DssGraphOBPMedian:330,DssGraphOBPStem:331,DssGraphOBPTail:332,DssGraphPieFeelerLine:337,DssGraphPieFeelerLabel:338,DssGraphPieGroupLabel:339,DssGraphPieRingLabel:340,DssGraphPieSlice:341,DssGraphSeriesTitle:398,DssGraphConnectStackLine:399,DssGraphDataTextStackTotal:401,DssGraphOPILBLValue:418,DssGraphUserLine1:414,DssGraphUserLine2:415,DssGraphUserLine3:416,DssGraphUserLine4:417,DssGraphDataTextConnectLine:431,DssGraphGauge:444,DssGraphGaugeTitle:450,DssGraphGaugeRange:451,DssGraphY3Body:477,DssGraphY3Label:478,DssGraphY3Major:479,DssGraphY3Minor:480,DssGraphY4Body:483,DssGraphY4Label:484,DssGraphY4Major:485,DssGraphY4Minor:486,DssGraph3DColHeader:512,DssGraph3DColTitle:515,DssGraph3DDataText:518,DssGraph3DRowHeader:552,DssGraph3DRowTitle:555,DssGraph3DRYHeader:558,DssGraph3DRYTitle:561,DssGraphGaugeBorder:1319,DssGraphGaugeNeedleBase:1320,DssGraphGaugeNeedleBaseLine:1330,DssGraphZBody:10003,DssGraphTrendLine:10004,DssGraphY1RightBody:10005,DssGraphY1RightTitle:10006,DssGraphReferenceLine:10007,DssGraphStraightLine:10008,DssGraphTargetLine:10009,DssGraphRefLineText:10010,DssGraphTrendLineText:10011,DssGraphUserLabel1:100100,DssGraphUserLabel2:100101,DssGraphUserLabel3:100102,DssGraphUserLabel4:100103,DssGraphX2Body:100200,DssGraphX2Label:100201,DssGraphX2Major:100202,DssGraphX2Minor:100203,DssGraphX2Title:100204};mstrmojo.chart.model.enums.EnumDSSGraphDataTextShowType={DssGraphDataTextNone:0,DssGraphDataTextValue:1,DssGraphDataTextLabel:2,DssGraphDataTextBoth:3,DssGraphDataTextAbs:4,DssGraphDataTextAbsValue:5,DssGraphDataTextAbsBoth:7,DssGraphDataTextTotal:8,DssGraphDataTextZValue:16,DssGraphDataTextPercent:32,DssGraphDataTextYValue:64,DssGraphDataTextInternal:128,DssGraphDataTextSeriesDependent:256,DssGraphDataTextQualityObjectMode:512};(function(){function B(L,Q,N){var M,O;M=0;if(N){M=Math.max(L,L-Q);M=Math.max(M,-Q);}else{M=L-Q;}if(M===0){this.mIsShown=false;return 1;}var P=M;O=1;while(M<1){M*=10;O/=10;}while(M>=10){M/=10;O*=10;}if(M<1.8){O*=2;O/=10;}else{if(M<3.1){O*=4;O/=10;}else{if(M<4.6){O*=5;O/=10;}else{if(M>=8.1){O*=2;}}}}return O;}function K(P){var L,N;this.mStep=B.call(this,this.mMaximum,this.mMinimum,P.mAlwaysIncludeZero);this.mMaxTick=Math.ceil(this.mMaximum/this.mStep)*this.mStep;this.mMinTick=Math.floor(this.mMinimum/this.mStep)*this.mStep;this.mMinTick=(this.mMinTick*this.mMinimum<0)?0:this.mMinTick;if(P.mAlwaysIncludeZero){this.mMaxTick=(this.mMaximum<0)?0:this.mMaxTick;this.mMinTick=(this.mMinimum>0)?0:this.mMinTick;}var M=this.mMaxTick-this.mMinTick;if(this.mStep>=M){return ;}L=Math.floor((this.mMaxTick-this.mMinTick+this.mStep/100)/this.mStep)+1;for(N=1;N<L-1;++N){var O=this.mMinTick+N*this.mStep;this.mTicks.push(O);}}function C(M){var L;this.mMaxTick=1;this.mStep=this.mMinimum<0?0.2:0.1;if(M.mUseCustomMinMax){this.mMaxTick=M.mAxisMaxValue;this.mMinTick=M.mAxisMinValue;this.mMaxTick=Math.min(1,this.mMaxTick);this.mMinTick=Math.max(-1,this.mMinTick);this.mStep=0.1;}else{if(this.mMaximum>=0.5){this.mMaxTick=1;this.mMinTick=Math.floor(this.mMinimum/this.mStep)*this.mStep;this.mMinTick=(this.mMinTick*this.mMinimum<0)?0:(this.mMinTick>0?0:this.mMinTick);if(this.mMinimum<-0.5){this.mMinTick=-1;}}else{if(this.mMaximum>0){this.mMaxTick=Math.ceil(this.mMaximum/this.mStep)*this.mStep;this.mMinTick=-1;}else{this.mStep=0.1;this.mMaxTick=0;this.mMinTick=-1;}}}for(L=this.mMinTick+this.mStep;L+0.01<this.mMaxTick;L+=this.mStep){this.mTicks.push(Math.round(L*100)/100);}}function I(L){return Math.log(L)/Math.log(10);}function H(O){var N,L,M;this.mStep=1;if(this.mMaximum<=0){this.mMinTick=1;this.mMaxTick=10;return ;}if(this.mMinimum<=0){L=this.mMaximum>1?0:-1;this.mMinTick=Math.pow(10,L);if(O.mUseCustomMinMax){this.mMaxTick=this.mMaximum;N=Math.floor(I.call(this,this.mMaximum));if(I.call(this,this.mMaximum)===N){N--;}}else{N=Math.ceil(I.call(this,this.mMaximum));this.mMaxTick=Math.pow(10,N);}for(M=L+1;M<N;++M){this.mTicks.push(Math.pow(10,Math.floor(M)));}return ;}if(O.mUseCustomMinMax){N=I.call(this,this.mMaximum);L=I.call(this,this.mMinimum);this.mMaxTick=this.mMaximum;this.mMinTick=this.mMinimum;}else{N=Math.ceil(I.call(this,this.mMaximum));L=Math.floor(I.call(this,this.mMinimum));this.mMaxTick=Math.pow(10,N);this.mMinTick=Math.pow(10,L);}for(M=L+1;M<N;++M){this.mTicks.push(Math.pow(10,Math.floor(M)));}}function J(L){this.mTicks.splice(0,this.mTicks.length);if(this.mIsPercent){return C.call(this,L);}if(L.mUseLogarithmicScale){return H.call(this,L);}K.call(this,L);}function G(Q){if(Q.mUseCustomMinMax||Q.mUseLogarithmicScale){return ;}var M=0.1,O=false,L=false,P=[];this.GetTicks(P);if(P.length>=2){var N=P.length;L=((Math.abs(this.mMaximum-P[N-2])<M*this.mStep));O=((Math.abs(this.mMinimum-P[1])<M*this.mStep));if(this.mIsPercent){L=false;}}if(L&&O){this.mMinTick=this.mMinimum;this.mMaxTick=this.mMaximum;Q.mUseMinValue=Q.mShowMinLabel=true;Q.mUseMaxValue=Q.mShowMaxLabel=true;}else{if(L){this.mMaxTick=this.mMaximum;Q.mUseMaxValue=Q.mShowMaxLabel=true;}else{if(O){this.mMinTick=this.mMinimum;Q.mUseMinValue=Q.mShowMinLabel=true;}else{}}}if(Q.mAlwaysIncludeZero){this.mMaxTick=(this.mMaximum<0)?0:this.mMaxTick;this.mMinTick=(this.mMinimum>0)?0:this.mMinTick;}}mstrmojo.chart.common.ScalePlate=mstrmojo.provide("mstrmojo.chart.common.ScalePlate",{mOptions:{mShowMinLabel:true,mShowMaxLabel:true},isStackedChart:false,mStep:0,mIsPercent:false,mMinimum:0,mMaximum:0,mMaxTick:0,mMinTick:0,mTicks:[],clear:function F(){this.isStackedChart=this.mIsPercent=false;this.mMinimum=this.mMaximum=0;this.mMinTick=this.mMaxTick=0;this.mStep=0;this.mTicks=[];},GetTicks:function A(M){if(this.mOptions.mShowMinLabel){M.push(this.mMinTick);}var L;for(L=0;L<this.mTicks.length;++L){M.push(this.mTicks[L]);}if(this.mOptions.mShowMaxLabel){M.push(this.mMaxTick);}},getMaxMinTickValue:function D(O,N,L,M){this.computeTicks(O,N,L,M);return{Max:this.mMaxTick,Min:this.mMinTick};},computeTicks:function E(Q,P,L,N){this.mMinimum=N;this.mMaximum=L;this.mIsPercent=!!(P&1);this.isStackedChart=!!(P&2);var O=1e-14;if(!Q.mUseLogarithmicScale&&this.isStackedChart){this.mMinimum=Math.min(this.mMinimum,0);this.mMaximum=Math.max(this.mMaximum,0);}if(Q.mDrawCustomLine){this.mMinimum=Math.min(this.mMinimum,Q.mAxisCustomValue);this.mMaximum=Math.max(this.mMaximum,Q.mAxisCustomValue);}if(this.mIsPercent&&this.mMinimum===this.mMaximum&&1===this.mMaximum){if(this.mMinimum===1){this.mMinimum=0;}}if(Math.abs(this.mMinimum-this.mMaximum)<O){if(this.mMinimum<-O||this.mMinimum>O){var M=Math.abs(this.mMinimum)*0.5;this.mMaximum=this.mMaximum+M;this.mMinimum=this.mMinimum-M;}else{this.mMinimum=-6;this.mMaximum=6;}}J.call(this,Q);if(Q.mUseLogarithmicScale&&this.isStackedChart){this.mMaximum=Q.mDrawCustomLine?Math.max(this.mMaximum+this.mMinTick,Q.mAxisCustomValue):this.mMaximum+this.mMinTick;this.mMinimum=Math.min(this.mMinimum,0);this.mTicks.splice(0,this.mTicks.length);H.call(this,Q);}G.call(this,Q);}});}());mstrmojo.vi.enums.EnumFilterClearActionType={CLEAR_ALL:0,CLEAR_KEEP_ONLY:1,CLEAR_ADV_QUALIFICATION:2,CLEAR_LINKING:3,CLEAR_KEEP_ONLY_AND_LINKING:4,CLEAR_DRILLING:5};mstrmojo.warehouse.EnumDatabaseType={SAP:1200,MSAS:1500,EssBase:1600,TM1:2900,SAPHana:4000,BDE:5400,SearchEngineSOLR:5500,Hive:3100,Impala:4100,SearchEngineSPLUNK:5600,Pig:6400,PHOENIX:6800,IBMBigInsights:700,Drill:7300,DB_TYPE_NEWDB_1:8100,DB_TYPE_NEWDB_5:8500,AzureCosmosDB:8700};mstrmojo.chart.model.enums.EnumDSSDefaultFormats={Label:1,Text:2,Image:3,Crosstab:4,Line:5,Shape:6,Section:7,Title:8,HTML:9,PanelStack:10,Control:11,UnselectedItem:12,SelectedItem:13,HighlightedItem:14,GridTitle:15,PanelStackTitle:16,Panel:17,ControlTitle:18,MetricsHeader:20,MetricsGrid:21,MetricsSubtotalHeader:22,MetricsSubtotalGrid:23,RowHeader:24,RowGrid:25,RowSubtotalHeader:26,RowSubtotalGrid:27,ColumnHeader:28,ColumnGrid:29,ColumnSubtotalHeader:30,ColumnSubtotalGrid:31,GraphMatrix:32,HeatMap:33,Network:34};mstrmojo.chart.model.enums.EnumDSSGraphProperty={DssGraphTextContent:9999,DssGraphContent:9999,DssGraphPropertyReserved:0,DssGraphAutoFitO1:4,DssGraphAutoFitO2:5,DssGraphAutoFitX:6,DssGraphAutoFitY1:7,DssGraphAutoFitY2:8,DssGraphGroupSpacing:10,DssGraphRiserWidth:11,DssGraphColorBySeries:12,DssGraphCurveColorAsSeries:13,DssGraphSDMOVAFactor:14,DssGraph2DAngle:18,DssGraph2DDepth:20,DssGraphDepthMode:21,DssGraph2ScaleDirectionX:22,DssGraph2ScaleDirectionY1:23,DssGraph2ScaleDirectionY2:24,DssGraph2ExcludeZeroX:25,DssGraph2ExcludeZeroY1:26,DssGraph2ExcludeZeroY2:27,DssGraphFormatDataTextX:28,DssGraphFormatDataTextY1:29,DssGraphFormatDataTextY2:30,DssGraphFormatX:33,DssGraphFormatY1:34,DssGraphFormatY2:35,DssGraphFormatZ:36,DssGraphGridLineO1:37,DssGraphGridLineO2:38,DssGraphGridLineX:39,DssGraphGridLineY1:40,DssGraphGridLineY2:41,DssGraphLabelModeO1:48,DssGraphLabelModeO2:49,DssGraphLegendLocation:52,DssGraphTitleXLocation:54,DssGraphTitleY1Location:55,DssGraphTitleY2Location:56,DssGraph2LogScaleX:57,DssGraph2LogScaleY1:58,DssGraph2LogScaleY2:59,DssGraphMarkerShape:60,DssGraphMarkerSize:61,DssGraph2DPlaceX:65,DssGraph2DPlaceY1:66,DssGraph2DPlaceY2:67,DssGraphConnectLine:68,DssGraphShowStepLine:70,DssGraph2ScaleEndX:74,DssGraph2ScaleEndY1:75,DssGraph2ScaleEndY2:76,DssGraph2DScaleFreqO1:87,DssGraph2DScaleFreqO2:88,DssGraph2DScaleFreqX:89,DssGraph2DScaleFreqY1:90,DssGraph2DScaleFreqY2:91,DssGraphScaleX:92,DssGraphScaleY1:93,DssGraphScaleY2:94,DssGraphShowSDDataLineType:96,DssGraphSDRiserType:97,DssGraphShowSDLine:98,DssGraphShowSDCurve:99,DssGraphShowSDLinrCorr:101,DssGraphShowSDLinrExp:102,DssGraphShowSDLinrFormula:103,DssGraphShowSDLinrLine:104,DssGraphShowSDLinrLog:105,DssGraphShowSDLinrNatLog:106,DssGraphShowSDLinrNPoly:107,DssGraphSDPolyFactor:108,DssGraphShowSDMeanLine:109,DssGraphShowSDMOVALine:110,DssGraphShowSDSTDDLine:111,DssGraphShowDataText:113,DssGraphShowDivBiPolar:114,DssGraphShowErrorBar:115,DssGraphShowLegendText:116,DssGraphShow2DO1Label:117,DssGraphShow2DO1:-117,DssGraphShow2DO2:118,DssGraphOffScaleTypeX:119,DssGraphOffScaleTypeY1:120,DssGraphOffScaleTypeY2:121,DssGraphShowQuadrants:122,DssGraphShowRiserShadows:123,DssGraphShow2DXTitle:124,DssGraphShow2DY1Title:125,DssGraphShow2DY2Title:126,DssGraphShow2DXLabel:127,DssGraphShow2DX:-127,DssGraphShow2DY1Label:128,DssGraphShow2DY1:-128,DssGraphShow2DY2Label:129,DssGraphShow2DY2:-129,DssGraphShowZeroLineX:130,DssGraphShowZeroLineY1:131,DssGraphShowZeroLineY2:132,DssGraph2DSideO1:133,DssGraph2DSideO2:134,DssGraph2DSideX:135,DssGraph2DSideY1:136,DssGraph2DSideY2:137,DssGraph2DSDSplitY:140,DssGraphStaggerO1:142,DssGraphStaggerO2:143,DssGraphStaggerX:144,DssGraphStaggerY1:145,DssGraphStaggerY2:146,DssGraphUniformBorders:148,DssGraphPieDepthValue:192,DssGraphPieHoleSizeValue:198,DssGraphPieInset:200,DssGraphPiesPerRowValue:201,DssGraphPieRotationValue:202,DssGraphShowFeeler:204,DssGraphShowLBLFeelerLabel:205,DssGraphShowLBLFeeler:-205,DssGraphShowLBLPie:206,DssGraphShowLBLRing:207,DssGraphDeleteSlice:208,DssGraphDetachSlice:209,DssGraphPieRestore:210,DssGraphPieTiltValue:211,DssGraphPieTiltOn:212,DssGraphShowPolarCoordinateAxis:215,DssGraphShowPolarConnectLines:218,DssGraphStockDataValueType:222,DssGraphShowBubbleGrid:245,DssGraphSDShowDataText:247,DssGraphShowTitleSeries:248,DssGraphConnectStackBars:249,DssGraphLegendBox:250,DssGraphLinkColors:260,DssGraph3DCustomView:265,DssGraph3DGridFloor:277,DssGraph3DGridLWall:278,DssGraph3DGridRiser:279,DssGraph3DGridRWall:280,DssGraph3DColTitleLocation:285,DssGraph3DLYTitleLocation:287,DssGraph3DRowTitleLocation:288,DssGraph3DRYTitleLocation:289,DssGraph3DScalefreqX:299,DssGraph3DScalefreqY:300,DssGraph3DScalefreqZ:301,DssGraphShow3DScatterLine:308,DssGraphShow3DLineToLWall:309,DssGraphShow3DLineToFloor:310,DssGraphShow3DLineToRWall:311,DssGraphSD3DRiserType:312,DssGraphShow3DShowDataLabelsBox:313,DssGraph3DOffScaleTypeX:314,DssGraph3DOffScaleTypeY:315,DssGraph3DOffScaleTypeZ:316,DssGraphShow3DCHeader:318,DssGraphShow3DColTitle:319,DssGraph3DShowDataText:320,DssGraphShow3DLNumber:321,DssGraphShow3DLYTitle:322,DssGraphShow3DRNumber:323,DssGraphShow3DRYTitle:324,DssGraphShow3DRHeader:325,DssGraphShow3DRowTitle:326,DssGraphShow3DFloor:327,DssGraphShow3DLegend:328,DssGraphShow3DLWall:329,DssGraphShow3DRWall:330,DssGraph3DViewStruct:337,DssGraphACMColorModel:549,DssGraphLegendItems:554,DssGraphSeriesColor:556,DssGraphReverseGroup:558,DssGraphReverseSeries:559,DssGraphSeriesByColumn:560,DssGraphAreaBackColor:561,DssGraphAreaTransparency:563,DssGraphAreaColor:564,DssGraphAreaPattern:566,DssGraphAreaSFX:567,DssGraphFontAlign:570,DssGraphFontTransparency:573,DssGraphFontColor:574,DssGraphFontName:576,DssGraphFontRotation:578,DssGraphVirtualFontSize:583,DssGraphFontStyle:584,DssGraphType:585,DssGraphLineTransparency:587,DssGraphLineColor:588,DssGraphLinePattern:589,DssGraphVirtualLineWidth:591,DssGraphFootnoteLocation:592,DssGraphFrameLocation:593,DssGraphSubTitleLocation:594,DssGraphTitleLocation:595,DssGraphShowfootnote:596,DssGraphShowSubtitle:597,DssGraphShowTitle:598,DssGraphFontBox:601,DssGraphFontSize:603,DssGraphLockFontSize:604,DssGraphLineWidth:605,DssGraphAreaAlpha:608,DssGraphLineAlpha:609,DssGraphFontAlpha:610,DssGraphAreaCustomBevelEffect:612,DssGraphFormatDataTextAdv:616,DssGraphFormatXAdv:618,DssGraphFormatY1Adv:619,DssGraphFormatY2Adv:620,DssGraphFormatZAdv:621,DssGraphMiddleValue:630,DssGraphSplitYPosition:631,DssGraphAxisShowUserLine:632,DssGraphAxisUserLineValue:633,DssGraphAxisUserLineAxis:634,DssGraphMarkerLayout:637,DssGraphPieDataValueLoc:638,DssGraphPieDataLabelLoc:639,DssGraph2DOrdSpaceMode:642,DssGraphLegendLock:644,DssGraphGridStepY1:645,DssGraphGridStepY2:646,DssGraphGridStepX:647,DssGraphDataTextShowConnectLine:652,DssGraphGridLineZ:658,DssGraphScaleZ:659,DssGraphStaggerZ:660,DssGraph2ScaleEndZ:662,DssGraph2ExcludeZeroZ:663,DssGraph2ScaleDirectionZ:664,DssGraphGridStepZ:665,DssGraphGaugeInfo:668,DssGraphGaugeFancyBox:669,DssGraphSDMarkerSize:671,DssGraphSDMarkerShape:683,DssGraphMetric1:690,DssGraphMetric2:691,DssGraphStockStyle:692,DssGraph2ScaleDirectionY3:693,DssGraph2ExcludeZeroY3:694,DssGraphGridLineY3:697,DssGraphFormatY3Adv:699,DssGraphGridStepY3:701,DssGraphOffScaleTypeY3:702,DssGraphShow2DY3:704,DssGraph2DSideY3:706,DssGraphStaggerY3:707,DssGraph2DPlaceY3:709,DssGraph2ScaleEndY3:710,DssGraph2DScaleFreqY3:713,DssGraphScaleY3:714,DssGraph2ScaleDirectionY4:715,DssGraph2ExcludeZeroY4:716,DssGraphGridLineY4:719,DssGraphFormatY4Adv:721,DssGraphGridStepY4:723,DssGraphOffScaleTypeY4:724,DssGraphShow2DY4:726,DssGraph2DSideY4:728,DssGraphStaggerY4:729,DssGraph2DPlaceY4:731,DssGraph2ScaleEndY4:732,DssGraph2DScaleFreqY4:735,DssGraphScaleY4:736,DssGraphSpiderLines:739,DssGraphPolarStartAngle:740,DssGraphMetric3:742,DssGraphRadarCircularDataLines:782,DssGraphRemoteAxis:784,DssGraphConnectFirstLast:790,DssGraphGaugeShowAxisLabelsOutside:791,DssGraphGaugeShowNeedle:792,DssGraphTailShape:793,DssGraphPieForceRound:794,DssGraphGaugeStyleValue:795,DssGraphGaugeBorderStyleValue:796,DssGraphGaugeBorderThicknessValue:797,DssGraphGaugeRangeThicknessValue:798,DssGraphGaugeRangeStartAngleValue:799,DssGraphGaugeRangeStopAngleValue:800,DssGraphGaugeNeedleStyleValue:801,DssGraphCurvedLines:804,DssGraphAreaBevelEffect:879,DssGraphFontAntiAlias:881,DssGraphFormatDataTextY3:695,DssGraphFormatDataTextY4:717,DssGraphColorPalette:10000,DssGraphOriContent:10001,DssGraphFillEffect:10002,DssGraphGradient:10003,DssGraphSDShowToolTip:10004,DssGraphSDToolTip:10005,DssGraphSDRegressionType:10006,DssGraph2LogScale:10007,DssGraphManualMajor:10008,DssGraphManualMinor:10009,DssGraph2ScaleDirection:10010,DssGraphShow2DAxisLine:10011,DssGraph2ExcludeZero:10012,DssGraph2ScaleUseMax:10013,DssGraph2ScaleUseMin:10014,DssGraph2ScaleMax:10015,DssGraph2ScaleMin:10016,DssGraphShow2DAxisLabels:10017,DssGraph2ScaleEndMax:10018,DssGraph2ScaleEndMin:10019,DssGraphShow2DAxisMajor:10020,DssGraphShow2DAxisMinor:10021,DssGraph2DSide:10022,DssGraphStyleMajor:10023,DssGraphStyleMinor:10024,DssGraphCountMajor:10025,DssGraphCountMinor:10026,DssGraphShowTotalValue:10027,DssGraph2DPie:10028,DssGraphShowDataValue:10029,DssGraphShowDVPercent:10030,DssGraphShowDataLabel:10031,DssGraphShowPieLabelOnSide:10032,DssGraphShowMarker:10033,DssGraphShowMetric1:10034,DssGraphShowMetric2:10035,DssGraphShowMetric3:10036,DssGraphMetric1Style:10037,DssGraphMetric2Style:10038,DssGraphMetric3Style:10039,DssGraphShowLine:10040,DssGraphShowToolTip:10041,DssGraphToolTip:10042,DssGraphAxisAutoFit:10043,DssGraphAxisStagger:10044,DssGraphAxisScaleFreq:10045,DssGraphMetric1Value:10046,DssGraphMetric2Value:10047,DssGraphMetric3Value:10048,DssGraph2AxisFormatText:10049,DssGraph2AxisFormatDataText:10050,DssGraphDPI:10051,DssGraphDocSize:10052,DssGraphAutoArrange:10053,DssGraph2DSplitYAutomatic:10054,DssGraphHistogramRangeMin:10055,DssGraphHistogramRangeMax:10056,DssGraphHistogramBuckets:10057,DssGraphGaugeSAngle:10058,DssGraphGaugeEAngle:10059,DssGraphGaugeThickness:10060,DssGraphGauge1Show:10061,DssGraphGauge1Min:10062,DssGraphGauge1Max:10063,DssGraphGauge2Show:10064,DssGraphGauge2Min:10065,DssGraphGauge2Max:10066,DssGraphGauge3Show:10067,DssGraphGauge3Min:10068,DssGraphGauge3Max:10069,DssGraphGauge4Show:10070,DssGraphGauge4Min:10071,DssGraphGauge4Max:10072,DssGraphGauge5Show:10073,DssGraphGauge5Min:10074,DssGraphGauge5Max:10075,DssGraphAxisDataTextPlace:10076,DssGraphAxisNumberFormat:10077,DssGraphAxisDataNumberFormat:10078,DssGraphAxisHasErrorBar:10079,DssGraphAxisHasMiddleValue:10080,DssGraphHeight:10081,DssGraphWidth:10082,DssGraphPicture:10083,DssGraph3DTurnXCounterClockwise:10084,DssGraph3DTurnYCounterClockwise:10085,DssGraph3DTurnZCounterClockwise:10086,DssGraph3DTurnXClockwise:10087,DssGraph3DTurnYClockwise:10088,DssGraph3DTurnZClockwise:10089,DssGraph3DMoveXTowardsOrigin:10090,DssGraph3DMoveYTowardsOrigin:10091,DssGraph3DMoveZTowardsOrigin:10092,DssGraph3DMoveXAwayFromOrigin:10093,DssGraph3DMoveYAwayFromOrigin:10094,DssGraph3DMoveZAwayFromOrigin:10095,DssGraph3DDecreaseCubeX:10096,DssGraph3DDecreaseCubeY:10097,DssGraph3DDecreaseCubeZ:10098,DssGraph3DIncreaseCubeX:10099,DssGraph3DIncreaseCubeY:10100,DssGraph3DIncreaseCubeZ:10101,DssGraph3DDecreaseWallX:10102,DssGraph3DDecreaseWallY:10103,DssGraph3DDecreaseWallZ:10104,DssGraph3DIncreaseWallX:10105,DssGraph3DIncreaseWallY:10106,DssGraph3DIncreaseWallZ:10107,DssGraph3DPanXLeft:10108,DssGraph3DPanYUp:10109,DssGraph3DRelative:10110,DssGraph3DPanXRight:10111,DssGraph3DPanYDown:10112,DssGraph3DAbsolute:10113,DssGraph3DZoomIn:10114,DssGraph3DIncreasePerspectiveDistortion:10115,DssGraph3DStepSize:10116,DssGraph3DZoomOut:10117,DssGraph3DDecreasePerspectiveDistortion:10118,DssGraph3DInitMatrix:10119,DssGraphGaugeQBShow:10120,DssGraphGaugeQBStart:10121,DssGraphGaugeQBStop:10122,DssGraphEnhancedSeriesEffect:10123,DssGraphLocale:10124,DssGraph3DViewStructName:10125,DssGraphLabelsDistance:10126,DssGraphLegendDetails:10127,DssGraphDefaultsInitialized:10128,DssGraphShow3DAxisMajor:10129,DssGraphGradientColorMode:10130,DssGraphLegendDetailsNEW:10131,DssGraphFrameLocationNEW:10132,DssGraph3DColTitleLocationNEW:10133,DssGraph3DRowTitleLocationNEW:10134,DssGraphLabelsDistanceNEW:10135,DssGraphDocSizeNEW:10136,DssGraphUseManualHistogramBuckets:10137,DssGraphFontSize100:10138,DssGraphUseSpecialSeries:10140,DssGraphIsOnlyAdditionalMetrics:10170};(function(){mstrmojo.requiresCls("mstrmojo.dom");var C=mstrmojo.dom,D=Math;mstrmojo.gm._IsAnchorable={PLACEMENT_ABOVE:1,PLACEMENT_BELOW:2,PLACEMENT_LEFT:3,PLACEMENT_RIGHT:4,anchor:null,anchorPosition:null,boundary:null,boundaryPosition:null,popupNodeName:"infoNode",tipNodeName:"tipNode",baseTipClass:"arrow",infoNodeOffset:25,popupNodeOffset:0,placementOrder:[this.PLACEMENT_ABOVE,this.PLACEMENT_BELOW,this.PLACEMENT_LEFT,this.PLACEMENT_RIGHT],hasScrollbars:function G(){return(!mstrApp.isTouchApp||!mstrApp.isTouchApp());},positionDialog:function E(){if(!this.anchorPopup()){if(typeof this._super==="function"){this._super();}}},positionTipNode:function A(I){var J=this.baseTipClass,K=this[this.tipNodeName];K.className=J+" "+I;},getTipDimension:function B(){var J=this[this.tipNodeName],I=C.position(J);return I;},anchorPopup:function F(){this.positionTipNode("top");var K=this.anchor,c=this.boundary,o=this[this.popupNodeName],r=this.infoNodeOffset,j=this.popupNodeOffset,l=this.hasScrollbars(),Z=this.anchorPosition||C.position(K,true),M=this.boundaryPosition||C.position(c,true),t=M.w,L=M.h,d=o.offsetWidth,O=o.offsetHeight,V=d/2,I=O/2,X=this.getTipDimension(),h=D.min(X.h,X.w),P=D.max(X.h,X.w)/2;if(l){t-=15;L-=15;}var a=C.contains(c,o),k=a?0:M.y,s=t/2-V,Q=L/2-I+k,n=-1000,u=-1000;if(a){Z.x=Z.x-M.x;Z.y=Z.y-M.y;}var g=Z.y+Z.h,N=Z.x+Z.w,f=Z.x>d,p=((N+d)<t),R=Z.y>O,m=((g+O)<L),U=this,W=function(i,x,w){return D.min(D.max(i,w),D.max(x,0));},e=function(){if((Z.x<t)&&R){var i=Z.x+(Z.w/2);U.positionTipNode("bottom");u=Z.y-h-j;Q=u-O+r;s=W(0,t-d,i-V);n=W(Z.x,N,i)-P;return true;}return false;},J=function(){if((Z.x<t)&&m){var i=Z.x+(Z.w/2);U.positionTipNode("top");u=g+j;Q=u+h-r;s=W(0,t-d,i-V);n=W(Z.x,N,i)-P;return true;}return false;},b=function(){if((Z.y<L)&&f){var i=Z.y+(Z.h/2);U.positionTipNode("right");n=Z.x-h-j;s=n-d+r;Q=W(k,L-O,i-I);u=W(Z.y,g,i)-P;return true;}return false;},Y=function(){if((Z.y<L)&&p){var i=Z.y+(Z.h/2);U.positionTipNode("left");n=N+j;s=n+h-r;Q=W(k,L-O,i-I);u=W(Z.y,g,i)-P;return true;}return false;},S=[],q;for(q=0;q<this.placementOrder.length;q++){switch(this.placementOrder[q]){case this.PLACEMENT_ABOVE:S.push(e);break;case this.PLACEMENT_BELOW:S.push(J);break;case this.PLACEMENT_LEFT:S.push(b);break;case this.PLACEMENT_RIGHT:S.push(Y);break;}}for(q=0;q<S.length;q++){if(S[q]()){break;}}Q=D.round(Q);s=D.round(s);u=D.round(u);n=D.round(n);this.applyPopupNodePos(Q,s,u,n);return true;},applyPopupNodePos:function H(K,J,M,I){var O=this[this.tipNodeName],L=O.style,P=this[this.popupNodeName],N=P.style;L.top=M+"px";L.left=I+"px";N.top=K+"px";N.left=J+"px";}};}());(function(){mstrmojo.requiresCls("mstrmojo.array");var H=mstrmojo.array,D={},G={},A="72px",F="abcdefghijklmnopqrstuvwxyz0123456789";function C(I){return I.name+":"+(I.isItalic?"i":"n")+(I.isBold?"7":"4");}mstrmojo.util.FontLoader=mstrmojo.provide("mstrmojo.util.FontLoader",{load:function E(N,O){var L=this,J=[],K;H.forEach(N,function(P){if(!L.isFontInstalled(P)){K=C(P);if(!D[K]&&!G[K]){J.push(K);}}});if(!window.WebFont||J.length===0){return true;}window.WebFont.load({custom:{families:J},fontactive:function(Q,P){D[Q+":"+P]=true;},fontinactive:function(Q,P){G[Q+":"+P]=true;},active:function M(){O.success();},inactive:function I(){O.failure();}});return false;},isFontInstalled:function B(J){var K=document.createElement("canvas"),L=K.getContext("2d"),P=J.isItalic?"italic":"normal",I=J.isBold?"bold":"normal",N=P+" "+I+" "+A,O,M;L.font=N+" monospace";O=L.measureText(F).width;L.font=N+" '"+J.name+"', monospace";M=L.measureText(F).width;K=null;return O!==M;}});})();(function(){mstrmojo.requiresCls("mstrmojo.Base");mstrmojo.chart.common.DSSTimeUtil=mstrmojo.declare(mstrmojo.Base,null,{scriptClass:"mstrmojo.chart.common.DSSTimeUtil",DaysInMonth:[31,28,31,30,31,30,31,31,30,31,30,31],DaysBeforeMonth:[0,31,59,90,120,151,181,212,243,273,304,334],DateAbove1970:[1972,1973,1974,1997,1976,1977,1978,1973,1980,1981,1971,1977,2012,1974,1997,1981,1988,1978,1973,1974,1992,1971,1977,1978,1996,1997,1981,1971,1972,1973,1974,1997,1976,1977,1978,1973,1980,1981,1971,1977,2012,1974,1997,1981,1988,1978,1973,1974,1992,1971,1977,1978,1996,1997,1981,1971,1972,1973,1974,1997,1976,1977,1978,1973,1980,1981,1971,1977,2012,1974,1997,1981,1988,1978,1973,1974,1992,1971,1977,1978,1996,1997,1981,1971,1972,1973,1974,1997,1976,1977,1978,1973,1980,1981,1971,1977,2012,1974,1997,1981,1971,1977,1978,1973,1980,1981,1971,1977,2012,1974,1997,1981,1988,1978,1973,1974,1992,1971,1977,1978,1996,1997,1981,1971,1972,1973,1974,1997,1976,1977,1978,1973,1980,1981,1971,1977,2012,1974,1997,1981,1988,1978,1973,1974,1992,1971,1977,1978,1996,1997,1981,1971,1972,1973,1974,1997,1976,1977,1978,1973,1980,1981,1971,1977,2012,1974,1997,1981,1988,1978,1973,1974,1992,1971,1977,1978,1996,1997,1981,1971,1972,1973,1974,1997,1976,1977,1978,1973,1980,1981,1971,1977,2012,1974,1997,1981,1988,1978,1973,1974,1997,1981,1971,1977,2012,1974,1997,1981,1988,1978,1973,1974,1992,1971,1977,1978,1996,1997,1981,1971,1972,1973,1974,1997,1976,1977,1978,1973,1980,1981,1971,1977,2012,1974,1997,1981,1988,1978,1973,1974,1992,1971,1977,1978,1996,1997,1981,1971,1972,1973,1974,1997,1976,1977,1978,1973,1980,1981,1971,1977,2012,1974,1997,1981,1988,1978,1973,1974,1992,1971,1977,1978,1996,1997,1981,1971,1972,1973,1974,1997,1976,1977,1978,1973,1980,1981,1971,1977,2012,1974,1997,1981,1988,1978,1973,1974,1992,1971,1977,1978,1973,1974,1997,1981,1988,1978,1973,1974,1992,1971,1977,1978,1996,1997,1981,1971,1972,1973,1974,1997,1976,1977,1978,1973,1980,1981,1971,1977,2012,1974,1997,1981,1988,1978,1973,1974,1992,1971,1977,1978,1996,1997,1981,1971,1972,1973,1974,1997,1976,1977,1978,1973,1980,1981,1971,1977,2012,1974,1997,1981,1988,1978,1973,1974,1992,1971,1977,1978,1996,1997,1981,1971,1972,1973,1974,1997,1976,1977,1978,1973,1980,1981,1971,1977,2012,1974,1997,1981,1988,1978,1973,1974,1992,1971,1977,1978,1996,1997,1981,1971,1972,1973,1974,1997,1976,1977,1978,1973,1980,1981,1971,1977,2012,1974,1997,1981,1988,1978,1973,1974,1992,1971,1977,1978,1996,1997,1981,1971,1972,1973,1974,1997,1976,1977,1978,1973,1980,1981,1971,1977,2012,1974,1997,1981,1988,1978,1973,1974,1992,1971,1977,1978,1996,1997,1981,1971,1972,1973,1974,1997,1976,1977,1978,1973,1980,1981,1971,1977,2012,1974,1997,1981,1988,1978,1973,1974,1992,1971,1977,1978,1996,1997,1981,1971,1972,1973,1974,1997,1976,1977,1978,1973,1980,1981,1971,1977,2012,1974,1997,1981,1971,1977,1978,1973,1980,1981,1971,1977,2012,1974,1997,1981,1988,1978,1973,1974,1992,1971,1977,1978,1996,1997,1981,1971,1972,1973,1974,1997,1976,1977,1978,1973,1980,1981,1971,1977,2012,1974,1997,1981,1988,1978,1973,1974,1992,1971,1977,1978,1996,1997,1981,1971,1972,1973,1974,1997,1976,1977,1978,1973,1980,1981,1971,1977,2012,1974,1997,1981,1988,1978,1973,1974,1992,1971,1977,1978,1996,1997,1981,1971,1972,1973,1974,1997,1976,1977,1978,1973,1980,1981,1971,1977,2012,1974,1997,1981,1988,1978,1973,1974,1997,1981,1971,1977,2012,1974,1997,1981,1988,1978,1973,1974,1992,1971,1977,1978,1996,1997,1981,1971,1972,1973,1974,1997,1976,1977,1978,1973,1980,1981,1971,1977,2012,1974,1997,1981,1988,1978,1973,1974,1992,1971,1977,1978,1996,1997,1981,1971,1972,1973,1974,1997,1976,1977,1978,1973,1980,1981,1971,1977,2012,1974,1997,1981,1988,1978,1973,1974,1992,1971,1977,1978,1996,1997,1981,1971,1972,1973,1974,1997,1976,1977,1978,1973,1980,1981,1971,1977,2012,1974,1997,1981,1988,1978,1973,1974,1992,1971,1977,1978,1973,1974,1997,1981,1988,1978,1973,1974,1992,1971,1977,1978,1996,1997,1981,1971,1972,1973,1974,1997,1976,1977,1978,1973,1980,1981,1971,1977,2012,1974,1997,1981,1988,1978,1973,1974,1992,1971,1977,1978,1996,1997,1981,1971,1972,1973,1974,1997,1976,1977,1978,1973,1980,1981,1971,1977,2012,1974,1997,1981,1988,1978,1973,1974,1992,1971,1977,1978,1996,1997,1981,1971,1972,1973,1974,1997,1976,1977,1978,1973,1980,1981,1971,1977,2012,1974,1997,1981,1988,1978,1973,1974,1992,1971,1977,1978,1996,1997,1981,1971,1972,1973,1974,1997,1976,1977,1978,1973,1980,1981,1971,1977,2012,1974,1997,1981,1988,1978,1973,1974,1992,1971,1977,1978,1996,1997,1981,1971,1972,1973,1974,1997,1976,1977,1978,1973,1980,1981,1971,1977,2012,1974,1997,1981,1988,1978,1973,1974,1992,1971,1977,1978,1996,1997,1981,1971,1972,1973,1974,1997,1976,1977,1978,1973,1980,1981,1971,1977,2012,1974,1997,1981,1988,1978,1973,1974,1992,1971,1977,1978,1996,1997,1981,1971,1972,1973,1974,1997,1976,1977,1978,1973,1980,1981,1971,1977,2012,1974,1997,1981,1971,1977,1978,1973,1980,1981,1971,1977,2012,1974,1997,1981,1988,1978,1973,1974,1992,1971,1977,1978,1996,1997,1981,1971,1972,1973,1974,1997,1976,1977,1978,1973,1980,1981,1971,1977,2012,1974,1997,1981,1988,1978,1973,1974,1992,1971,1977,1978,1996,1997,1981,1971,1972,1973,1974,1997,1976,1977,1978,1973,1980,1981,1971,1977,2012,1974,1997,1981,1988,1978,1973,1974,1992,1971,1977,1978,1996,1997,1981,1971,1972,1973,1974,1997,1976,1977,1978,1973,1980,1981,1971,1977,2012,1974,1997,1981,1988,1978,1973,1974,1997,1981,1971,1977,2012,1974,1997,1981,1988,1978,1973,1974,1992,1971,1977,1978,1996,1997,1981,1971,1972,1973,1974,1997,1976,1977,1978,1973,1980,1981,1971,1977,2012,1974,1997,1981,1988,1978,1973,1974,1992,1971,1977,1978,1996,1997,1981,1971,1972,1973,1974,1997,1976,1977,1978,1973,1980,1981,1971,1977,2012,1974,1997,1981,1988,1978,1973,1974,1992,1971,1977,1978,1996,1997,1981,1971,1972,1973,1974,1997,1976,1977,1978,1973,1980,1981,1971,1977,2012,1974,1997,1981,1988,1978,1973,1974,1992,1971,1977,1978,1973,1974,1997,1981,1988,1978,1973,1974,1992,1971,1977,1978,1996,1997,1981,1971,1972,1973,1974,1997,1976,1977,1978,1973,1980,1981,1971,1977,2012,1974,1997,1981,1988,1978,1973,1974,1992,1971,1977,1978,1996,1997,1981,1971,1972,1973,1974,1997,1976,1977,1978,1973,1980,1981,1971,1977,2012,1974,1997,1981,1988,1978,1973,1974,1992,1971,1977,1978,1996,1997,1981,1971,1972,1973,1974,1997,1976,1977,1978,1973,1980,1981,1971,1977,2012,1974,1997,1981,1988,1978,1973,1974,1992,1971,1977,1978,1996,1997,1981,1971,1972,1973,1974,1997,1976,1977,1978,1973,1980,1981,1971,1977,2012,1974,1997,1981,1988,1978,1973,1974,1992,1971,1977,1978,1996,1997,1981,1971,1972,1973,1974,1997,1976,1977,1978,1973,1980,1981,1971,1977,2012,1974,1997,1981,1988,1978,1973,1974,1992,1971,1977,1978,1996,1997,1981,1971,1972,1973,1974,1997,1976,1977,1978,1973,1980,1981,1971,1977,2012,1974,1997,1981,1988,1978,1973,1974,1992,1971,1977,1978,1996,1997,1981,1971,1972,1973,1974,1997,1976,1977,1978,1973,1980,1981,1971,1977,2012,1974,1997,1981,1971,1977,1978,1973,1980,1981,1971,1977,2012,1974,1997,1981,1988,1978,1973,1974,1992,1971,1977,1978,1996,1997,1981,1971,1972,1973,1974,1997,1976,1977,1978,1973,1980,1981,1971,1977,2012,1974,1997,1981,1988,1978,1973,1974,1992,1971,1977,1978,1996,1997,1981,1971,1972,1973,1974,1997,1976,1977,1978,1973,1980,1981,1971,1977,2012,1974,1997,1981,1988,1978,1973,1974,1992,1971,1977,1978,1996,1997,1981,1971,1972,1973,1974,1997,1976,1977,1978,1973,1980,1981,1971,1977,2012,1974,1997,1981,1988,1978,1973,1974,1997,1981,1971,1977,2012,1974,1997,1981,1988,1978,1973,1974,1992,1971,1977,1978,1996,1997,1981,1971,1972,1973,1974,1997,1976,1977,1978,1973,1980,1981,1971,1977,2012,1974,1997,1981,1988,1978,1973,1974,1992,1971,1977,1978,1996,1997,1981,1971,1972,1973,1974,1997,1976,1977,1978,1973,1980,1981,1971,1977,2012,1974,1997,1981,1988,1978,1973,1974,1992,1971,1977,1978,1996,1997,1981,1971,1972,1973,1974,1997,1976,1977,1978,1973,1980,1981,1971,1977,2012,1974,1997,1981,1988,1978,1973,1974,1992,1971,1977,1978,1973,1974,1997,1981,1988,1978,1973,1974,1992,1971,1977,1978,1996,1997,1981,1971,1972,1973,1974,1997,1976,1977,1978,1973,1980,1981,1971,1977,2012,1974,1997,1981,1988,1978,1973,1974,1992,1971,1977,1978,1996,1997,1981,1971,1972,1973,1974,1997,1976,1977,1978,1973,1980,1981,1971,1977,2012,1974,1997,1981,1988,1978,1973,1974,1992,1971,1977,1978,1996,1997,1981,1971,1972,1973,1974,1997,1976,1977,1978,1973,1980,1981,1971,1977,2012,1974,1997,1981,1988,1978,1973,1974,1992,1971,1977,1978,1996,1997,1981,1971,1972,1973,1974,1997,1976,1977,1978,1973,1980,1981,1971,1977,2012,1974,1997,1981,1988,1978,1973,1974,1992,1971,1977,1978,1996,1997,1981,1971,1972,1973,1974,1997,1976,1977,1978,1973,1980,1981,1971,1977,2012,1974,1997,1981,1988,1978,1973,1974,1992,1971,1977,1978,1996,1997,1981,1971,1972,1973,1974,1997,1976,1977,1978,1973,1980,1981,1971,1977,2012,1974,1997,1981,1988,1978,1973,1974,1992,1971,1977,1978,1996,1997,1981,1971,1972,1973,1974,1997,1976,1977,1978,1973,1980,1981,1971,1977,2012,1974,1997,1981,1971,1977,1978,1973,1980,1981,1971,1977,2012,1974,1997,1981,1988,1978,1973,1974,1992,1971,1977,1978,1996,1997,1981,1971,1972,1973,1974,1997,1976,1977,1978,1973,1980,1981,1971,1977,2012,1974,1997,1981,1988,1978,1973,1974,1992,1971,1977,1978,1996,1997,1981,1971,1972,1973,1974,1997,1976,1977,1978,1973,1980,1981,1971,1977,2012,1974,1997,1981,1988,1978,1973,1974,1992,1971,1977,1978,1996,1997,1981,1971,1972,1973,1974,1997,1976,1977,1978,1973,1980,1981,1971,1977,2012,1974,1997,1981,1988,1978,1973,1974,1997,1981,1971,1977,2012,1974,1997,1981,1988,1978,1973,1974,1992,1971,1977,1978,1996,1997,1981,1971,1972,1973,1974,1997,1976,1977,1978,1973,1980,1981,1971,1977,2012,1974,1997,1981,1988,1978,1973,1974,1992,1971,1977,1978,1996,1997,1981,1971,1972,1973,1974,1997,1976,1977,1978,1973,1980,1981,1971,1977,2012,1974,1997,1981,1988,1978,1973,1974,1992,1971,1977,1978,1996,1997,1981,1971,1972,1973,1974,1997,1976,1977,1978,1973,1980,1981,1971,1977,2012,1974,1997,1981,1988,1978,1973,1974,1992,1971,1977,1978,1973,1974,1997,1981,1988,1978,1973,1974,1992,1971,1977,1978,1996,1997,1981,1971,1972,1973,1974,1997,1976,1977,1978,1973,1980,1981,1971,1977,2012,1974,1997,1981,1988,1978,1973,1974,1992,1971,1977,1978,1996,1997,1981,1971,1972,1973,1974,1997,1976,1977,1978,1973,1980,1981,1971,1977,2012,1974,1997,1981,1988,1978,1973,1974,1992,1971,1977,1978,1996,1997,1981]});}());(function(){mstrmojo.requiresCls("mstrmojo.Base","mstrmojo.gm.GMEnums");var A=mstrmojo.gm.EnumIdentityType;mstrmojo.gm.GMIdentities=mstrmojo.declare(mstrmojo.Base,null,{scriptClass:"mstrmojo.gm.GMIdentities"});mstrmojo.gm.HeaderCellIdentity=mstrmojo.declare(mstrmojo.Base,null,{scriptClass:"mstrmojo.gm.HeaderCellIdentity",eid:undefined,v:undefined,tid:undefined,n:undefined,tui:undefined,fid:undefined,o:undefined,isRowAttribute:undefined,at:undefined,dei:undefined,dpt:undefined});mstrmojo.gm.GeneralIdentity=mstrmojo.declare(mstrmojo.Base,null,{scriptClass:"mstrmojo.gm.GeneralIdentity",objType:undefined});mstrmojo.gm.TitleCellIdentity=mstrmojo.declare(mstrmojo.Base,null,{scriptClass:"mstrmojo.gm.TitleCellIdentity",tid:undefined,fid:undefined,n:undefined,tui:undefined,isRowAttribute:undefined,otp:undefined,init:function(B){this.fid=B.fid;this.tid=B.id;this.isRowAttribute=B.isRowAttribute;if(B.isRowAttribute){this.objType=A.ROW_TITLE;}else{this.objType=A.COL_TITLE;}this.n=B.n;this.otp=B.otp;this.ost=B.ost;this.tui=B.tui;}});mstrmojo.gm.MetricAxisTitleIdentity=mstrmojo.declare(mstrmojo.Base,null,{scriptClass:"mstrmojo.gm.MetricAxisTitleIdentity",init:function(B){this._super(B);}});mstrmojo.gm.AttributeAxisTitleIdentity=mstrmojo.declare(mstrmojo.Base,null,{scriptClass:"mstrmojo.gm.AttributeAxiTitleIdentity",init:function(B){this._super(B);}});mstrmojo.gm.AxisIdentity=mstrmojo.declare(mstrmojo.Base,null,{scriptClass:"mstrmojo.gm.AxisIdentity",isNumericAxis:undefined,metricIdxArr:undefined,attrIdArr:undefined});mstrmojo.gm.ColorSquareIdentity=mstrmojo.declare(mstrmojo.Base,null,{scriptClass:"mstrmojo.gm.ColorSquareIdentity",init:function(B){this._super(B);this.comb=this.getElementsCombination();},getElementsCombination:function(){var B,F=this.token,C,H,G,E,I,D;if(F){D=[];C=F.levels;H=F.elements;G=F.types;B=C.length;for(E=0;E<B;E++){I={eid:H[E],tid:C[E]};if(G){I.tp=G[E];}D.push(I);}return D;}return undefined;}});}());(function(){var E=false;mstrmojo.requiresCls("mstrmojo.Base");mstrmojo.netviz.PropertyParser=mstrmojo.declare(mstrmojo.Base,null,{scriptClass:"mstrmojo.netviz.PropertyParser",methods:{unmarshal:function(X,W){var V=this;V._withConfig({unmarshal:true},function(){V.parsedProps[X]=W;});},marshal:function(W){var V=this;return V._withConfig({marshal:true},function(){return V.parsedProps[W];});}},init:function(V){if(this._super){this._super(V);}this.config={marshal:false,unmarshal:false};this.parsedProps={};},parse:function(W,Y){var X=this,Z=this.parsedProps,V=this.methods;this.raw=W;this.schema=Y;Object.keys(V).forEach(function(a){X.defineMethod(a,V[a]);});Object.keys(Y).forEach(function(a){var b=Y[a];X.defineProperty(a,b.type);Z.unmarshal(a,W[b.key]);});return Z;},defineProperty:function(V,d){var c=this,X=c.config,b=this.parsedProps,W=(this.schema||{})[V]||{},h=W.preSet,Z=W.postSet,Y=W.preGet,e=W.postGet,g=W.key,f=this.raw,a;if(!U(d)){throw new TypeError("type does not implement required methods");}Object.defineProperty(b,V,{enumerable:true,get:function(){var i=a;if(i!==undefined&&X.marshal){if(Y instanceof Function){i=Y.call(b,i,V,f,g);}i=d.marshal(i);if(e instanceof Function){i=e.call(b,i,V,f,g);}}return i;},set:function(j){var i=j;if(X.unmarshal){if(h instanceof Function){i=h.call(b,i,V,f,g);}i=d.unmarshal(i);if(Z instanceof Function){i=Z.call(b,i,V,f,g);}}if(i!==undefined&&!d.validate(i)){throw new TypeError("Invalid value in setter. Consider unmarshal(prop, val).");}a=i;}});},defineMethod:function(Y,V){var W=this,X=W.parsedProps;if(!L(Y)||!(V instanceof Function)){return ;}Object.defineProperty(X,Y,{enumerable:false,value:V.bind(W)});},_withConfig:function(X,a){var Y=this.config,Z=Object.keys(X||{}),W=Z.reduce(function(c,b){c[b]=Y[b];return c;},{}),V;Z.forEach(function(b){Y[b]=X[b];});V=a();Z.forEach(function(b){Y[b]=W[b];});return V;}});var O=Object.prototype.toString,G=mstrmojo.netviz.PropertyParser;function J(Y,X,W){var V=parseInt(Y,X);return isNaN(V)?W:V;}function N(V){return O.call(V)==="[object Number]";}function L(V){return O.call(V)==="[object String]";}var I=mstrmojo.declare(mstrmojo.Base,[],{scriptClass:"mstrmojo.netviz.PropertyParser.Property",init:function(V){if(this._super){this._super();}this.defval=V.defval;},marshal:function(V){return JSON.stringify(V).replace(/"/g,"'");}});G.BooleanProperty=mstrmojo.declare(I,[],{scriptClass:"mstrmojo.netviz.PropertyParser.BooleanProperty",unmarshal:function(V){if(V===undefined){return this.defval;}return V.toString()==="true";},validate:function(V){return V===true||V===false||O.call(V)==="[object Boolean]";}});G.IntegerProperty=mstrmojo.declare(I,[],{scriptClass:"mstrmojo.netviz.PropertyParser.IntegerProperty",unmarshal:function(V){return J(V,10,this.defval);},validate:N});G.FloatProperty=mstrmojo.declare(I,[],{scriptClass:"mstrmojo.netviz.PropertyParser.FloatProperty",unmarshal:function(W){var V=parseFloat(W);return isNaN(V)?this.defval:V;},validate:N});G.JsonProperty=mstrmojo.declare(I,[],{scriptClass:"mstrmojo.netviz.PropertyParser.JsonProperty",unmarshal:function(V){function W(Y){var X;if(Y!==undefined){try{X=JSON.parse(Y.replace(/'/g,'"'));}catch(Z){X=Y;}}return X;}if(typeof V==="string"){return W(V);}if(V!==undefined&&V!==null){return V;}return this.defval;},validate:function(V){return true;}});G.StringProperty=mstrmojo.declare(I,[],{scriptClass:"mstrmojo.netviz.PropertyParser.StringProperty",unmarshal:function(V){if(V!==undefined&&V!==null){return V.toString();}return this.defval;},marshal:function(V){return V;},validate:L});var K=["BooleanProperty","StringProperty","JsonProperty","IntegerProperty","FloatProperty"];K.forEach(function(V){var W=G[V];W.preset=function(X){return new W({defval:X});};});function U(V){return Q(V,["marshal","unmarshal","validate"]);}function Q(W,V){if(!W){return false;}return(V||[]).every(function(X){return W[X] instanceof Function;});}if(E){var C=new G(),F=G.BooleanProperty,H=G.IntegerProperty,B=G.FloatProperty,S=G.StringProperty,M=G.JsonProperty;var R={x:1,y:{x:"n+1"},z:true,m:3.14};var P={bp1:"false",bp2:"true",bp3:"",dp1:"12",dp2:22,fp1:23.3,fp2:"3.14",sp1:"foobar",jp1:R,jp3:"transparent"};var A={boolProp1:{key:"bp1",type:F.preset(false)},boolProp2:{key:"bp2",type:F.preset(false)},boolProp3:{key:"bp3",type:F.preset(false)},boolProp4:{key:"bp4",type:F.preset(false)},boolProp5:{key:"bp5",type:F.preset(true)},decimalProp1:{key:"dp1",type:H.preset(-1)},decimalProp2:{key:"dp2",type:H.preset(-1)},decimalPropn:{key:"dpn",type:H.preset(-1)},floatProp1:{key:"fp1",type:B.preset(0)},floatProp2:{key:"fp2",type:B.preset(0)},floatProp3:{key:"fp3",type:B.preset(0.03)},stringProp1:{key:"sp1",type:S.preset("")},stringProp2:{key:"sp2",type:S.preset("string")},jsonProp1:{key:"jp1",type:M.preset({})},jsonProp2:{key:"jp2",type:M.preset({})},jsonProp3:{key:"jp3",type:M.preset("error")}};var D=C.parse(P,A);console.assert(Object.keys(D).length===Object.keys(A).length,"wrong property count");console.assert(D.unmarshal instanceof Function,"unmarshal not found");console.assert(D.marshal instanceof Function,"marshal not found");console.assert(D.boolProp1===false);console.assert(D.boolProp2===true);console.assert(D.boolProp3===false);console.assert(D.boolProp4===false);console.assert(D.boolProp5===true);console.assert(D.marshal("boolProp5")==="true");D.unmarshal("boolProp5","false");console.assert(D.boolProp5===false);console.assert(D.marshal("boolProp5")==="false");console.assert(D.decimalProp1===12);console.assert(D.decimalProp2===22);console.assert(D.decimalPropn===-1);D.unmarshal("decimalProp1",42);console.assert(D.decimalProp1===42);console.assert(D.marshal("decimalProp1")==="42");console.assert(D.floatProp1===23.3);console.assert(D.marshal("floatProp1")==="23.3");console.assert(D.floatProp2===3.14);console.assert(D.floatProp3===0.03);D.unmarshal("floatProp3",100);console.assert(D.floatProp3===100);console.assert(D.stringProp1==="foobar");console.assert(D.stringProp2==="string");D.unmarshal("stringProp2","quux");console.assert(D.marshal("stringProp2")==="quux");D.unmarshal("stringProp2",42);console.assert(D.stringProp2==="42");console.assert(JSON.stringify(D.jsonProp1)===JSON.stringify(R));console.assert(Object.keys(D.jsonProp2).length===0);console.assert(D.jsonProp3==="transparent");console.assert(D.marshal("jsonProp1")===JSON.stringify(R).replace(/"/g,"'"));D.unmarshal("jsonProp2",true);console.assert(D.jsonProp2===true);console.assert(D.marshal("jsonProp2")==="true");console.info("PropertyParser: all tests processed");}}());(function(){mstrmojo.requiresCls("mstrmojo.array","mstrmojo.string","mstrmojo.vi.enums.EnumFilterClearActionType","mstrmojo.vi.enums.EnumVisFilterType");var D=mstrmojo.array,M=mstrmojo.string,H=mstrmojo.vi.enums.EnumFilterClearActionType,J=mstrmojo.vi.enums.EnumVisFilterType;mstrmojo.vi.ui.rw._SupportViewFilterInVizBox=mstrmojo.provide("mstrmojo.vi.ui.rw._SupportViewFilterInVizBox",{_mixinName:"mstrmojo.vi.ui.rw._SupportViewFilterInVizBox",getSelectorObjectsFromTemplateLimit:function N(){return this.getSelObjsFromTemlateLimitHandler();},getSelectorObjectsFromViewFilter:function B(){return this.getSelObjsFromVFHandler();},getSelObjsFromVFHandler:function F(){var R=this,P=R.model,Q=R.node.data,S=Q&&Q.vfexpr;return P&&P.getSelectorDataFromViewFilter(S);},getSelObjsFromTemlateLimitHandler:function K(){var R=this,P=R.model,Q=R.node.data,S=Q&&Q.tpl;return P&&P.getSelectorDataFromTemplateLimit(S);},makeBold:function C(P){return"<span style='font-weight:bold;'>"+P+"</span>";},getSelectorExpr:function I(U,S){var V=[],W="",R=true,Q=U.keepOnly?"##":mstrmojo.desc(13232,"Not ##"),P,X=mstrmojo.desc(5283,"OR");if(S){X=this.makeBold(X);}U.data.every(function(Y){[].concat(Y).every(function(Z){if(W===""){W=Z.tn;}return(R=(W===Z.tn));});return R;});U.data.forEach(function(a,Y){if(Y>0){V.push(X);}var Z=[];[].concat(a).forEach(function(d){var c=S?M.encodeHtmlString(d.v):d.v,b=S?M.encodeHtmlString(d.tn):d.tn;Z.push((R?"":(d.tn+" = "))+(c||mstrmojo.desc(14323,"NULL")));});V.push(Z.join(" "));});if(V.length>0){P=Q.replace("##",(R?W+" = ":"")+V.join(" "));}return P;},getLinkingSelectorExpr:function O(S,R){var U=[],V="",Q=true,W=mstrmojo.desc(5283,"OR"),P=S.keepOnly?"##":mstrmojo.desc(13232,"Not ##");if(R){W=this.makeBold(W);}S.data.every(function(X){[].concat(X).every(function(Y){if(V===""){V=Y.tn;}return(Q=(V===Y.tn));});return Q;});S.data.forEach(function(Z,X){var Y=[];if(Q){if(X>0){Y.push(W);}else{Y.push(P.replace("##",V+" = "));}}[].concat(Z).forEach(function(c){var b=R?M.encodeHtmlString(c.v):c.v,a=R?M.encodeHtmlString(c.tn):c.tn;Y.push((Q?"":(a+" = "))+(b||mstrmojo.desc(14323,"NULL")));});U.push(Y.join(" "));});return U.join(" ");},getFilterMenuPairs:function G(P){var R=this,S=[],Q=mstrmojo.desc(2827,"Clear");if(P instanceof Array){P.forEach(function(X,W){var V=R.getSelectorExpr(X),U=R.getSelectorExpr(X,true);S.push({menuString:Q+' "'+V+'"',menuTtpString:Q+' "'+U+'"',ctxt:W});});}return S;},filterMenuHandler:function L(P,S){var R=this,Q=R.controller;switch(P.type){case H.CLEAR_KEEP_ONLY:P=P.idx;Q.applyKeepOnly(R,S,undefined,P,false);break;case H.CLEAR_ALL:Q.clearFiltersForVis(R,[J.KEEP_ONLY,J.LINKING,J.DRILLING],S);break;case H.CLEAR_ADV_QUALIFICATION:Q.clearFiltersForVis(R,[J.ADV_QUALIFICATION],S);break;case H.CLEAR_KEEP_ONLY_AND_LINKING:Q.clearFiltersForVis(R,[J.KEEP_ONLY,J.LINKING],S);break;case H.CLEAR_LINKING:Q.clearLinkingFilter(P,S);break;case H.CLEAR_DRILLING:Q.clearFiltersForVis(R,[J.DRILLING],S);break;default:break;}},hasKeepOnly:function E(P){return P===null||P.length>0;},getSelectorDataForKeepOnly:function A(Q,V){var S=this,R=S.model,U=S.model.data||S.node.data,P=U.tpl,W;if(V===-1){W=[];}else{W=[].concat(R.getSelectorDataFromTemplateLimit(P));if(V===-2){W=D.filter(W,function(X){return !X.keepOnly;});}else{if(V>=0){W.splice(V,1);}}}if(Q){W=W.concat(Q);}return W;}});}());(function(){mstrmojo.requiresCls("mstrmojo.array","mstrmojo.hash","mstrmojo.vi.ui.rw._HasVisSelections");mstrmojo.requiresClsP("mstrmojo.vi.ui.rw","_HasVisSelections","SelectionType");var B=mstrmojo,D=B.array,E=B.hash;var G=2;function C(J){var I=-1;var K=this.modelData.gts.row||[],H=K.length,L;for(L=0;L<H;L++){if(K[L].id===J){I=L;}}return I;}mstrmojo.heatmap.vi._SupportHeatmapBrushesAndHighlights=mstrmojo.provide("mstrmojo.heatmap.vi._SupportHeatmapBrushesAndHighlights",{_mixinName:"mstrmojo.heatmap.vi._SupportHeatmapBrushesAndHighlights",prepareSelectedNodesInfo:function(K){if(K==true){this.clearCxtMnuSelection();}else{this.clearSelections();}var L=this,I=this.attSpan,O=this.modelData.ghs.rhs.items,J=this.modelData.gts.row,M=[],N=K===true?this.contextMenuSelection:this.previousSelected,H={};D.forEach(N,function(Y){var Q=Y.level,W=(Y.index===undefined)?Y.indices[0]:Y.index,X=O[W].items,P=(X&&X.length)||0,Z,c,U,d,V,S,a=[],b,R;H={};for(V=Y.entityChildren?Q:0;V<=Q;V++){Z=J[V];H[Z.id]=[];d=[];R=[];b={n:Z.n,tid:Z.id};for(S=0;S<P;S++){if(!X[S]||X[S].tui!==V){continue;}c=X[S].idx;if(c===-1){continue;}U=Z.es[c];if(d.indexOf(U)===-1){R.push(U.n);d.push(U);if(b.eid===undefined){b.eid=U.id;}}}b.v=R.join(":");if(V===Q){b.level=Y.level;H[Z.id].push({id:b.eid,n:b.v,level:b.level});}else{H[Z.id].push({id:b.eid,n:b.v});}a.push(b);}M.push(a);if(Q<J.length-1){if(K==true){L.addContextMenuAttributeSelection(Z.id,b.eid,b.v);}else{L.addAttributeSelection(Z.id,b.eid,b.v);}}else{if(K==true){L.addContextMenuMetricValueSelection(H);}else{L.addMetricValueSelection(H);}}});return M;},highlight:function(S,J){if(this._super){this._super.apply(this,arguments);}if(this.noHighlightAfterKeepOnlyExcludeDrill){return ;}var U,I,Q,H,M,K,L,R,O=[];function P(j,b){var g=this.root,e=g&&g.entityChildren,l=this.modelData.gts.row||[],m,d,Y,W,X=l.length,f=[],c=this;if(!b){b=[];}if(!E.isEmpty(j)){f.push(g);for(W=0;W<X;W++){m=j[W];d=m&&m.eNm;Y=m&&m.eId;var k=[];D.forEach(f,function(n,o){e=n.entityChildren||[];var i=false;D.forEach(e,function(p){if(p.level===W&&((!d&&j.maxIndex>W)||c.model.compareElementsId(p.id,Y))){f.push(p);i=true;}});if(!i&&d){k.push(o);}});D.forEach(k,function(n,i){f.splice(n-i,1);});if(W===0){f.splice(0,1);}var a=f.length,Z,h=0;for(Z=0;Z<a;Z++){if(f[Z].level===W){h=Z;break;}}if(h>0){f.splice(0,h);}}}return b.concat(f);}if(this.isEmpty()){return ;}var N=function(W){M+=W.n+" ";};for(I in J){var V=true;if(!J.hasOwnProperty(I)){continue;}U=J[I];R={};for(Q in U){if(!U.hasOwnProperty(Q)){continue;}L=C.call(this,Q);if(L<0){V=false;break;}if(!R.hasOwnProperty("maxIndex")){R.maxIndex=0;}H=U[Q]||[];M="";D.forEach(H,N);M=M.substring(0,M.length-1);K=H.length>0?H[0].id:"";R[L]={eNm:M,eId:K};R.maxIndex=Math.max(L,R.maxIndex);}if(V){O=P.call(this,R,O);}}this.removeAllSelections();this.previousSelected=O;this.refreshHighlights();},singleUnitSelect:function A(){var K=this.getSelections().length>0||this.clearSelectionsFlag;if(this.clearSelectionsFlag){delete this.clearSelectionsFlag;}if(K){var I=function(){var N=this.model.scm,P=Object.keys(N||{}),R=(P&&P[0])||"",M=this.model.data.gts,Q=M.row,O=M.col;D.forEach(Q.concat(O),function(S){if(P.indexOf(S.id)!==-1){R=S.id;return false;}});return R;};var J=function(){var N=this.model.scm,P=Object.keys(N||{}),R=[],M=this.model.data.gts,Q=M.row,O=M.col;D.forEach(Q.concat(O),function(S){if(P.indexOf(S.id)!==-1){R.push(S.id);}});return R;};var L=function(){var M={};M.tid=I.call(this);M.tids=J.call(this);M.eid="";M.isClearAll=false;M.anchor=this.domNode;M.at=G;M.selections=this.getSelections();M.selectionType=this.getSelectionType();return M;};var H=L.call(this);this.performAction([H]);}},clearSelections:function(){this.clearSelectionsFlag=true;if(this._super){this._super();}},clearCxtMnuSelection:function F(){if(this._super){this._super();}}});}());(function(){mstrmojo.requiresCls("mstrmojo.dom","mstrmojo.css");var C=Math,I=mstrmojo.dom,K=mstrmojo.css,E="active",L="ready",J=6,F=10,O=10,P={LASSO_SELECTOR:"lasso-selector",LASSO_RESIZER:"lasso-resizer",BUTTON:"button"};mstrmojo.util.ui.LassoSelectorParamsType=null;function Q(S,R,U){return function(V){S.call(mstrmojo.all[R],V,U);};}function M(S){var V=S.view,U=I.eventTarget(window,S),R=this.lassoSelector;if(this.clickFromLassoResizer||(U!==R&&this.clickFromCreatingLasso)){I.stopPropogation(V,S);I.preventDefault(V,S);}delete this.clickFromLassoResizer;delete this.clickFromCreatingLasso;}function D(c,V){var R,e,S,a,b=c.clientX,Z=c.clientY,U=this.lassoSelector,Y=V.startX,X=V.startY,W=V.containerPos,f=b-W.x,d=Z-W.y;f=C.min(f,V.maxX);f=C.max(f,V.minX);d=C.min(d,V.maxY);d=C.max(d,V.minY);R=C.abs(f-Y);e=C.abs(d-X);a=C.min(X,d);S=C.min(Y,f);U.style.width=R+"px";U.style.height=e+"px";U.style.left=S+"px";U.style.top=a+"px";V.width=R;V.height=e;V.left=S;V.top=a;if(R<=O&&e<=O){U.style.visibility="hidden";K.removeClass(U,E);}else{U.style.visibility="visible";K.addClass(U,E);document.body.style.cursor="crosshair";}}function H(U,X){var W=window.document,S=this.lassoSelector,V=X.width,R=X.height;I.detachEvent(W,"mousemove",X.fnMove);I.detachEvent(W,"mouseup",X.fnUp);delete X.fnMove;delete X.fnUp;document.body.style.cursor="default";if(!V||V===0||!R||R===0){this.dismissLassoSelector();}else{X.ctrlKey=U.ctrlKey;this.lassoSelected(X);this.clickFromCreatingLasso=true;K.addClass(S,L);this.positionBoxResizers();}}function N(h){var a,d=h.view,c,b,e=I.eventTarget(window,h),R=e.getAttribute("type"),W=this.lassoSelector,S=this.lassoContainer,j=this.excludeAttrArr,V=j.length,Z,Y={};delete this.clickFromLassoResizer;delete this.clickFromCreatingLasso;if(!W||!S||!this.lassoSelectorEnabled){return ;}if(I.contains(this.dropDownBtn,e,true)){return ;}for(a=0;a<V;a++){if(R===j[a]){return ;}}this.lassoSelecting();Z=I.position(S);c=h.clientX-Z.x;b=h.clientY-Z.y;Y.containerPos=Z;Y.maxX=Z.w;Y.maxY=Z.h;Y.startX=c;Y.startY=b;Y.minX=0;Y.minY=0;Y.info=this.getLassoSelectionInfo(e);Y.useAsSelectorOrBrushes=this.useAsSelectorOrBrushes||((this.hasAssociatedNodes&&this.hasAssociatedNodes())||this.selectorControl);W.style.visibility="hidden";W.style.left=c+"px";W.style.top=b+"px";W.style.width="0px";W.style.height="0px";K.removeClass(W,L);S.appendChild(W);var U=this.id,f=document,X=Q(D,U,Y),g=Q(H,U,Y);I.attachEvent(f,"mousemove",X);I.attachEvent(f,"mouseup",g);Y.fnMove=X;Y.fnUp=g;I.stopPropogation(d,h);I.preventDefault(d,h);}function G(b,V){var Z=V.index,Y=V.startX,X=V.startY,W=V.containerPos,g=b.clientX-W.x,f=b.clientY-W.y,U=this.lassoSelector;g=C.min(g,V.maxX);g=C.max(g,V.minX);f=C.min(f,V.maxY);f=C.max(f,V.minY);var e=g-Y,d=f-X;if(Z%3===1){e=0;}if(Z===3||Z===5){d=0;}var R=V.selWidth,c=V.selHeight,S=V.selLeft,a=V.selTop;if(e!==0){if(Z%3===0){S+=e;R-=e;}else{R+=e;}}if(d!==0){if(Z<3){a+=d;c-=d;}else{c+=d;}}U.style.width=R+"px";U.style.left=S+"px";U.style.top=a+"px";U.style.height=c+"px";V.width=R;V.left=S;V.height=c;V.top=a;this.positionBoxResizers();}function B(R,V){var U=R.view,S=window.document;I.detachEvent(S,"mousemove",V.fnMove);I.detachEvent(S,"mouseup",V.fnUp);delete V.fnMove;delete V.fnUp;this.clickFromLassoResizer=true;I.stopPropogation(U,R);I.preventDefault(U,R);this.lassoSelectorResized(V);}function A(W){var U=W.view,i=I.eventTarget(window,W),V=parseInt(i.getAttribute("index"),10),b=this.lassoSelector,a=b.offsetLeft,k=b.offsetTop,Z=a+b.offsetWidth,h=k+b.offsetHeight,R=I.position(this.lassoContainer),g=0,d=0,e=R.w,c=R.h,f={};if(V%3===0){e=Z-F;}if(V%3===2){g=a+F;}if(V<3){c=h-F;}if(V>=6){d=k+F;}f.minX=g;f.minY=d;f.maxX=e;f.maxY=c;f.startX=W.clientX-R.x;f.startY=W.clientY-R.y;f.index=V;f.containerPos=R;f.selWidth=b.clientWidth;f.selHeight=b.clientHeight;f.selLeft=b.offsetLeft;f.selTop=b.offsetTop;var Y=this.id,j=document,S=Q(G,Y,f),X=Q(B,Y,f);I.attachEvent(j,"mousemove",S);I.attachEvent(j,"mouseup",X);f.fnMove=S;f.fnUp=X;I.stopPropogation(U,W);I.preventDefault(U,W);}mstrmojo.util.ui._LassoSelector=mstrmojo.provide("mstrmojo.util.ui._LassoSelector",{_mixinName:"mstrmojo.util.ui._LassoSelector",lassoContainer:undefined,lassoSelector:undefined,lassoSelectorEnabled:true,excludeAttrArr:null,boxResizers:null,useDropDownBtn:false,dropDownBtn:undefined,init:function(R){if(this._super){this._super(R);}this.excludeAttrArr=[];this.boxResizers=[];},registerLassoSelector:function(S,W,V){W=W||[];W.push(P.LASSO_SELECTOR);W.push(P.LASSO_RESIZER);W.push(P.BUTTON);this.lassoContainer=S;this.excludeAttrArr=W;this.useDropDownBtn=V||false;I.attachEvent(S,"mousedown",Q(N,this.id));I.attachEvent(S,"click",Q(M,this.id));var R=this.lassoSelector;if(!R){R=this.createLassoSelector();this.lassoSelector=R;}var U=R.parentNode;if(U){U.removeChild(R);}},createLassoSelector:function(){var V,W,S,U=this.boxResizers,R=document.createElement("div");R.setAttribute("class","lasso-selector");R.setAttribute("type",P.LASSO_SELECTOR);R.setAttribute("draggable",false);R.draggable=false;for(V=0;V<9;V++){if(V!==4){W=document.createElement("div");W.setAttribute("class","lasso-selector-resizer");W.setAttribute("type",P.LASSO_RESIZER);W.setAttribute("index",String(V));W.setAttribute("draggable",false);W.draggable=false;R.appendChild(W);U[V]=W;I.attachEvent(W,"mousedown",Q(A,this.id));}}K.addClass(U[0],["top","left"]);K.addClass(U[1],["top"]);K.addClass(U[2],["top","right"]);K.addClass(U[3],["left"]);K.addClass(U[5],["right"]);K.addClass(U[6],["bottom","left"]);K.addClass(U[7],["bottom"]);K.addClass(U[8],["bottom","right"]);if(this.useDropDownBtn===true){S=document.createElement("div");S.setAttribute("type",P.BUTTON);S.setAttribute("class","lasso-selector-dropdown-button");R.appendChild(S);I.attachEvent(S,"click",Q(this.lassoButtonClicked,this.id));this.dropDownBtn=S;}return R;},positionBoxResizers:function(){var U=this.boxResizers,S=this.lassoSelector,V=S.clientWidth,R=S.clientHeight,X=(V-J)>>1,W=(R-J)>>1;U[1].style.left=X+"px";U[3].style.top=W+"px";U[5].style.top=W+"px";U[7].style.left=X+"px";},dismissLassoSelector:function(){var R=this.lassoSelector;if(R){K.removeClass(R,[E,L]);if(R.parentNode){R.parentNode.removeChild(R);}}},isLassoSelectorActive:function(){function S(W,V){var X=W.className.split(/\s+/),U;for(U=0;U<X.length;U++){if(X[U]===V){return true;}}return false;}var R=this.lassoSelector;if(R){return S(R,E);}return false;},getLassoSelectionInfo:mstrmojo.emptyFn,lassoSelected:mstrmojo.emptyFn,lassoSelecting:mstrmojo.emptyFn,lassoButtonClicked:mstrmojo.emptyFn,lassoSelectorResized:mstrmojo.emptyFn});}());(function(){mstrmojo.requiresCls("mstrmojo.Base","mstrmojo.chart.common.DSSTimeUtil");var H=24*60*60*1000;var A=60*60*1000;var L=60*1000;var C=1000;var K=24;var D=24*60;var J=24*60*60;var B=new mstrmojo.chart.common.DSSTimeUtil();mstrmojo.chart.common.DSSDateTime=mstrmojo.declare(mstrmojo.Base,null,{scriptClass:"mstrmojo.chart.common.DSSDateTime",mnYear:1899,mnMonth:12,mnDay:30,mnHour:0,mnMinute:0,mnSecond:0,mnMillisecond:0,mnWeek:-1,mnDayOfWeek:-1,init:function P(U){if(!U||!U.ifTime){this.mnYear=1899;this.mnMonth=12;this.mnDay=30;this.mnHour=0;this.mnMinute=0;this.mnSecond=0;this.mnMillisecond=0;this.mnWeek=-1;this.mnDayOfWeek=-1;return ;}var S=0;var W=23242571;var R=-693593;if(U.ifTime>W){this.mnYear=65535;this.mnMonth=12;this.mnDay=30;S=U.ifTime-Math.floor(U.ifTime);}else{if(U.ifTime<R){this.mnYear=1;this.mnMonth=1;this.mnDay=1;S=Math.abs(U.ifTime)+Math.ceil(U.ifTime);}else{if(U.ifTime>0){var X=this.DAYSToYMD(Math.floor(U.ifTime));this.mnYear=X.year;this.mnMonth=X.month;this.mnDay=X.day;S=U.ifTime-Math.floor(U.ifTime);}else{if(U.ifTime<0){var X=this.DAYSToYMD(Math.ceil(U.ifTime));this.mnYear=X.year;this.mnMonth=X.month;this.mnDay=X.day;S=Math.abs(U.ifTime)+Math.ceil(U.ifTime);}}}}S*=H;var V=S+0.5;if(V==H){V--;}if(V>0){this.mnHour=Math.floor(V/A);V-=this.mnHour*A;this.mnMinute=Math.floor(V/L);V-=this.mnMinute*L;this.mnSecond=Math.floor(V/C);V-=this.mnSecond*C;this.mnMillisecond=Math.floor(V);}else{this.mnHour=0;this.mnMinute=0;this.mnSecond=0;this.mnMillisecond=0;}this.mnWeek=-1;this.mnDayOfWeek=-1;this.Sanitize();},Sanitize:function O(){var R=false;if(this.mnHour==24&&this.mnMinute==0&&this.mnSecond==0){R=true;this.mnHour=0;}if(this.mnMonth<1){this.mnMonth=1;}else{if(this.mnMonth>12){this.mnMonth=12;}}if(this.mnDay<1){this.mnDay=1;}else{if(this.mnDay>B.DaysInMonth[this.mnMonth-1]){this.mnDay=B.DaysInMonth[this.mnMonth-1];if(this.mnMonth==2&&this.IsLeapYear(this.mnYear)){this.mnDay++;}}}if(this.mnHour<0){this.mnHour=0;}else{if(this.mnHour>23){this.mnHour=23;}}if(this.mnMinute<0){this.mnMinute=0;}else{if(this.mnMinute>59){this.mnMinute=59;}}if(this.mnSecond<0){this.mnSecond=0;}else{if(this.mnSecond>59){this.mnSecond=59;}}if(this.mnMillisecond<0){this.mnMillisecond=0;}else{if(this.mnMillisecond>999){this.mnMillisecond=999;}}if(R){var S=this.ToMilliseconds();S=S+H;this.init({ifTime:this.MillisecondsToDATE(S)});}},IsLeapYear:function Q(R){return((R&3)==0)&&((R%100)!=0||(R%400)==0);},ToMilliseconds:function I(){var R=this.YMDToDAYS(this.mnYear,this.mnMonth,this.mnDay);var S=R*H;S+=this.mnHour*A+this.mnMinute*L+this.mnSecond*C+this.mnMillisecond;return S;},MillisecondsToDATE:function E(S){var R=Math.floor(S/H);var U=(S-R*H)/H;if(U<0){R--;U+=1;}return R>=0?R+U:R-U;},DAYSToYMD:function N(U){var X=0;var Z=0;var S=0;U+=693959;var W=Math.floor(U/365);var V=U-W*365;var Y=Math.floor(W/4)-Math.floor(W/100)+Math.floor(W/400);V=V-Y;if(V<0){W--;V+=365;while(V<=0){W--;V+=365;}}var R=U-(W*365+Math.floor(W/4)+(W%4?1:0)-Math.floor((W-1)/100)+Math.floor((W-1)/400));if(R==365&&!this.IsLeapYear(W)){X=W+1;Z=1;S=1;return{year:X,month:Z,day:S};}if(R==-1){X=W-1;Z=12;S=31;return{year:X,month:Z,day:S};}X=W;Z=12;while(R<B.DaysBeforeMonth[Z-1]){Z--;}S=R-B.DaysBeforeMonth[Z-1]+1;if(Z>2&&this.IsLeapYear(X)){S--;if(S==0){Z--;S=B.DaysInMonth[Z-1];if(Z==2){S++;}}}return{year:X,month:Z,day:S};},YMDToDAYS:function G(V,U,S){if(U<1||U>12){return 0;}var R=V*365+Math.floor(V/4)+(V%4?1:0)-Math.floor((V-1)/100)+Math.floor((V-1)/400);R+=B.DaysBeforeMonth[U-1];if(U>2&&this.IsLeapYear(V)){R++;}R+=S-1;R-=693959;return R;},ToDATE:function F(){var S=this.YMDToDAYS(this.mnYear,this.mnMonth,this.mnDay);var R=this.mnHour/K+this.mnMinute/D+this.mnSecond/J+this.mnMillisecond/H;if(S>=0){return S+R;}else{return S-R;}},DateTimeOrder:function M(R){if(this.mnYear>R.mnYear){return 1;}else{if(this.mnYear<R.mnYear){return -1;}}if(this.mnMonth>R.mnMonth){return 1;}else{if(this.mnMonth<R.mnMonth){return -1;}}if(this.mnDay>R.mnDay){return 1;}else{if(this.mnDay<R.mnDay){return -1;}}if(this.mnHour>R.mnHour){return 1;}else{if(this.mnHour<R.mnHour){return -1;}}if(this.mnMinute>R.mnMinute){return 1;}else{if(this.mnMinute<R.mnMinute){return -1;}}if(this.mnSecond>R.mnSecond){return 1;}else{if(this.mnSecond<R.mnSecond){return -1;}}if(this.mnMillisecond>R.mnMillisecond){return 1;}else{if(this.mnMillisecond<R.mnMillisecond){return -1;}}return 0;}});}());(function(){mstrmojo.requiresCls("mstrmojo.util.color");var Q=mstrmojo.util.color;var O={Min:15872549,Max:1489202,Invalid:0,NoColorMetric:16119287};var G={LeftToRight:0,RightToLeft:1,Center:2,None:3};var M={dark:[1487103,16725801,309794,16750094,11434462,13421861,1691360,11119017,11783663,16754582,10018698,16760704,14337004,14803088,10608618,14079702],light:[2062260,14034728,2924588,16744206,9725885,12369186,1556175,8355711,11454440,16750742,10018698,16759672,12955861,14408589,10410725,13092807]};function K(W,j,a){if(W<0||W>1){return 0;}var X=256,Z=W*X,R,Y,c,V=j>>16,U=a>>16,f=(j&65280)>>8,d=(a&65280)>>8,S=(j&255),h=(a&255);R=V+Math.floor((Z*(U-V)/X));Y=f+Math.floor((Z*(d-f)/X));c=S+Math.floor((Z*(h-S)/X));return c+(Y<<8)+(R<<16);}function F(S,W){var V=S>>16,U=(S&65280)>>8,R=(S&255);V=Math.floor((1-W)*V);U=Math.floor((1-W)*U);R=Math.floor((1-W)*R);return R+(U<<8)+(V<<16);}function J(R){var Y=[],X,S,V=R.dp,U=V.length,Z,a,W;if(R===null||R.length===0){return[];}for(W=0;W<U;W++){S={};if(W>0){Z=X;X=a;}else{X=V[W];}if(W<U-1){a=V[W+1];}S.sv=(W===0)?X.v:(Z.v+X.v)/2;S.ev=(W===U-1)?X.v:(a.v+X.v)/2;S.c=X.c;S.d=(W===0)?G.LeftToRight:(W===U-1?G.RightToLeft:G.Center);Y[W]=S;}return Y;}function E(Z){var Y=[],X,W,V=Z.dp,R=V.length,S;if(Z===null||Z.length===0){return[];}for(S=0;S<R;S++){X={};W=V[S];X.c=W.c;switch(W.d){case G.LeftToRight:X.v=W.s;break;case G.RightToLeft:X.v=W.e;break;default:var U=(W.s+W.e)/2;X.v=U;break;}Y[S]=X;}return Y;}function L(b){if(isNaN(b)){return O.Invalid;}if(this.max===this.min){return this.blendEqualColor;}var U=this.blend.dp,S=U.length;if(!this.valid){var f=U[0],X=U[S-1];if(b<this.min){return f.c;}return X.c;}var V,Z=U[0],d=Z.v,Y=Z.c,a,W;for(V=1;V<S;V++){Z=U[V];if(Z.v>=b){break;}d=Z.v;Y=Z.c;}V=Math.min(V,S-1);Z=U[V];a=Z.v;W=Z.c;if(b<d){return Y;}if(b>a){return W;}if(d===a){return K(0.5,Y,W);}var R=(b-d)/(a-d);return K(R,Y,W);}function D(W,b){var R=[],S=[],Y=[];if(this.min===this.max||isNaN(W)||isNaN(b)||W===b){R[0]=L.call(this,W);R[1]=L.call(this,b);S[0]=1;S[1]=1;Y[0]=0;Y[1]=1;}else{if(this.min<this.max){var a,V=this.blend.dp,U=V.length,Z=0,X;R[Z]=L.call(this,W);S[Z]=1;Y[Z]=0;Z++;for(X=0;X<U;X++){a=V[X];if(a.v>=W&&a.v<=b){R[Z]=a.c;S[Z]=1;Y[Z]=(a.v-W)/(b-W);Z++;}}R[Z]=L.call(this,b);S[Z]=1;Y[Z]=1;}}return{c:R,a:S,r:Y};}function I(U,X){var V=0.4,S=F(X.c,V),R,W;switch(X.d){case G.LeftToRight:if(U<X.s){return X.c;}if(U>X.e){return S;}if(X.s===X.e){return K(0.5,X.c,S);}W=(U-X.s)/(X.e-X.s);return K(W,X.c,S);case G.RightToLeft:if(U<X.s){return S;}if(U>X.e){return X.c;}if(X.s===X.e){return K(0.5,S,X.c);}W=(U-X.s)/(X.e-X.s);return K(W,S,X.c);case G.Center:R=(X.s+X.e)/2;if(U<X.s||U>X.e){return S;}if(X.s===X.e){return S;}if(U<=R){W=(U-X.s)/(R-X.s);return K(W,S,X.c);}W=(U-R)/(X.e-R);return K(W,X.c,S);default:return X.c;}}function B(S){if(isNaN(S)){return O.Invalid;}if(this.min===this.max){return this.bandEqualColor;}var Y=this.band.dp,R=Y.length;if(!this.valid){var V=Y[0],W=Y[R-1];if(S<this.min){return I(W.s,V);}if(S>=this.min){return I(W.e,W);}}var X=Y[0],U;if(X.s>=S){return I(S,X);}for(U=0;U<R;U++){X=Y[U];if(X.s<=S&&S<X.e){return I(S,X);}}return I(S,X);}function A(W,g){var R=[],S=[],Y=[];if(this.min===this.max||isNaN(W)||isNaN(g)||W===g){R[0]=B.call(this,W);R[1]=B.call(this,g);S[0]=1;S[1]=1;Y[0]=0;Y[1]=1;}else{if(this.min<this.max){var V=this.band.dp,U=V.length,h=0.4,d,f,k,X,b=0;if(W<0){R[b]=B(W);S[b]=1;Y[b]=0;b++;if(g<1){R[b]=B(g);S[b]=1;Y[b]=1;b++;}}for(X=0;X<U;X++){d=V[X];if(d.s>g||d.e<W){continue;}f=d.c;k=F(f,h);var j=Math.max(d.s,W),e=Math.min(d.e,g);if(e!==j){switch(d.d){case G.LeftToRight:case G.RightToLeft:case G.Center:if(j===d.s){R[b]=(d.d!==G.LeftToRight)?k:f;}else{R[b]=B.call(this,j);}Y[b]=(j-W)/(g-W);S[b]=1;b++;if(d.d===G.Center){var Z=(d.s+d.e)/2;if(Z>j&&Z<e){R[b]=f;Y[b]=(Z-W)/(g-W);S[b]=1;b++;}}if(e===d.e){R[b]=(d.d!==G.RightToLeft)?k:f;}else{R[b]=B.call(this,e);}Y[b]=(e-W)/(g-W);S[b]=1;b++;break;default:R[b]=f;Y[b]=(j-W)/(g-W);S[b]=1;b++;R[b]=f;Y[b]=(e-W)/(g-W);S[b]=1;b++;break;}}}if(g>1){if(W>1){R[b]=B.call(this,W);Y[b]=0;S[b]=1;b++;}R[b]=B.call(this,g);Y[b]=1;S[b]=1;}}}return{c:R,a:S,r:Y};}function P(S,R){this.blend.dp=[];var V=this.blend.dp,U;U={};U.c=S;U.v=0;V[0]=U;U={};U.c=R;U.v=1;V[1]=U;}function N(S,R){this.band.dp=[];var V=this.band.dp,U;U={};U.d=G.LeftToRight;U.s=0;U.e=0.5;U.c=S;V[0]=U;U={};U.d=G.LeftToRight;U.s=0.5;U.e=1;U.c=R;V[1]=U;}function C(s,V,r){var X=[],W=0,a,q,g=this.min,j=this.max,U=r.legendTickCount,S={},R,Z=!isNaN(this.min)&&!isNaN(this.max),k;if(this.min>=this.max||this.blend.dp.length<=2){var m=(j-g)/U;for(k=0;k<s;k++){S={x:W,w:Math.floor(V/U)};W+=S.w;if(Z){a=g+k*m;q=a+m;R=this.getColor((a+q)/2);}else{a="Null";q="Null";R=0;}X.push({r:S,c:R,sv:a,ev:q});}}else{var e=this.blend.dp,h=e.length;for(k=0;k<h;k++){var o=e[k],Y,b;if(k===0){a=g;}else{Y=e[k-1];a=g+(j-g)*(o.v+Y.v)/2;}if(k===h-1){q=j;}else{b=e[k+1];q=g+(j-g)*(o.v+b.v)/2;}S={x:W,w:Math.floor(V*(q-a)/(j-g))};W+=S.w;if(Z){R=this.getColor((a+q)/2);}else{a="Null";q="Null";R=0;}X.push({r:S,c:R,sv:a,ev:q});}}this.tooltipInfo=X;}function H(p,V,o){var X=[],W=0,Z,n,g=this.min,h=this.max,U=o.legendTickCount,S={},R,b="",Y=!isNaN(this.min)&&!isNaN(this.max),j,m;if(this.min>=this.max){for(j=0;j<p;j++){S={x:W,w:Math.floor(V/U)};b+=S.w;if(Y){R=this.getColor(g);}else{Z="Null";n="Null";R=0;}X.push({r:S,c:R,sv:Z,ev:n});}}else{var a=this.band.dp,f=a.length,k,e;if(f<=2){for(j=0;j<f;j++){m=a[j];if(j===0){Z=g;}else{Z=g+(h-g)*m.s;}if(j===f-1){n=h;}else{n=g+(h-g)*m.e;}S={x:W,w:Math.floor(V*(n-Z)/(h-g)/2)};W+=S.w;if(Y){n=(Z+n)/2;R=this.getColor((Z+n)/2);}else{Z="Null";n="Null";R=0;}X.push({r:S,c:R,sv:Z,ev:n});W+=S.w;k=V*(n-Z)/(h-g)/2;S={x:W,w:Math.ceil(k)};if(j>0){e=X[X.length-1].r;if(S.x<e.x+e.w+1){e.w=S.x-e.x;}}W+=Math.floor(k);if(Y){Z=(Z+n)/2;R=this.getColor((Z+n)/2);}else{Z="Null";n="Null";R=0;}X.push({r:S,c:R,sv:Z,ev:n});}}else{for(j=0;j<f;j++){m=a[j];if(j===0){Z=o.props.legendAsc?g:h;}else{Z=o.props.legendAsc?g+(h-g)*m.s:h+(g-h)*m.s;}if(j===f-1){n=o.props.legendAsc?h:g;}else{n=o.props.legendAsc?g+(h-g)*m.e:h+(g-h)*m.e;}k=V*(n-Z)/(h-g);S={x:W,w:Math.ceil(k)};if(j>0){e=X[X.length-1].r;if(S.x<e.x+e.w+1){e.w=S.x-e.x;}}if(j===f-1){S.w=V-W;}W+=Math.floor(k);var q=o.props.legendAsc?" < ":" > ";if(Y){R=this.getColor((Z+n)/2);}else{Z="Null";n="Null";R=0;}if(q){X.push({r:S,c:R,sv:Z,ev:n});}else{X.push({r:S,c:R,sv:Z,ev:n,sign:">"});}}}}this.tooltipInfo=X;}mstrmojo.heatmap.vi.VisHeatMapColorTheme={newInstance:function(){return{initialize:function W(){this.blend={};this.band={};this.valid=true;this.blendEqualColor=0;this.bandEqualColor=0;this.isBlend=true;this.style="dark";this.setDefaultDataProvider();this.checkMinMax();},getGradientFillInfo:function Z(f,c){var g,e;if(isNaN(f)||isNaN(c)){if(this.isBlend){return D.call(this,f,c);}return A.call(this,f,c);}if(this.min===this.max){if(f<this.min){g=0;}else{g=1;}if(c<this.max){e=0;}else{e=1;}}else{var h;if(this.isFixedColorBanding){h=this.initMax-this.initMin;g=(f-this.initMin)/h;e=(c-this.initMin)/h;}else{h=this.max-this.min;g=(f-this.min)/h;e=(c-this.min)/h;}}if(this.isBlend){return D.call(this,g,e);}return A.call(this,g,e);},checkMinMax:function X(){var j=this.min,d=this.max;if(j>d){this.valid=false;}else{if(j===d){j=d=1;var m=this.blend.dp,e=m.length,k,h,g;for(h=e-1;h>=0;h--){k=m[h];if(h===e-1&&k.v<=j){this.blendEqualColor=k.c;break;}if(h===0&&k.c>=j){this.blendEqualColor=k.c;break;}if(h>0&&k.c>=j){var f=m[h-1];if(f.c<j){g=(j-f.v)/(k.v-f.v);this.blendEqualColor=K(g,f.c,k.c);break;}}}m=this.band.dp;e=m.length;for(h=0;h<e;h++){k=m[h];if((h===0&&k.s>=j)||(h===e-1&&k.e<=j)||(k.s<=j&&k.e>=j)){this.bandEqualColor=k.c;break;}}}}},setDefaultDataProvider:function b(){P.call(this,O.Min,O.Max);N.call(this,O.Min,O.Max);this.useDefault=true;},getColor:function S(c){if(this.colorByType==="attribute"){return M[this.themeType][c%16];}if(this.hasNoColorMetric){return O.NoColorMetric;}var d=NaN;if(isNaN(c)){d=0;}else{if(this.min===this.max){d=c<this.min?0:1;}else{if(this.isFixedColorBanding){d=(c-this.initMin)/(this.initMax-this.initMin);}else{d=(c-this.min)/(this.max-this.min);}}}if(this.isBlend){return L.call(this,d);}return B.call(this,d);},isBrightColor:function a(i){var f=i>>16,e=(i&65280)>>8,d=(i&255),h=(f*299+e*587+d*114)/1000;if(h>150){return true;}return false;},getContrastColor:function R(d){if(Q.isGradientColor(d)){d=d.c1;}if(this.isBrightColor(d)){return 0;}return 16777215;},createTooltipInfo:function V(f,e,h){var g=0;if(this.min>=this.max){g=1;}else{var c;if(this.isBlend){c=this.blend.dp.length;g=(c<=2)?5:c;}else{c=this.band.dp.length;g=(c<=2)?4:c;}}if(this.isBlend){C.call(this,g,e,h);}else{H.call(this,g,e,h);}},getTooltipInfo:function U(c){var e=this.tooltipInfo;var d;for(d=0;d<e.length;d++){var g=e[d],f=g.r;if(c>=f.x&&c<f.x+f.w){return d;}}return d-1;},getMaxMinByMetricID:function(p,d){var e=p.gts.col,m=e.length,h=0,l=null,k={min:null,max:null};for(h=0;h<m&&l===null;h++){var o=e[h].es,c=o.length,g;for(g=0;g<c;g++){if(o[g].oid===d){l=g;break;}}}if(l===null){return k;}var f=p.gvs.items||[];m=f.length;for(h=0;h<m;h++){var n=parseFloat(f[h].items[l].rv);if(k.min===null){k.min=n;}if(k.max===null){k.max=n;}if(k.min>n){k.min=n;}if(k.max<n){k.max=n;}}return k;},convertFixedValueToBlendString:function(g,f){var m="";if(g.length%2===0){var c=g.length,d=f.min,h=f.max,e=0;var l=h-d;m="0,"+g[1];for(e=2;e<c-2;e+=2){var k=parseInt(g[e],10);if(k<d||k>h){continue;}else{var j=(k-d)/l;m+=","+j+","+g[e+1];}}m+=",1,"+g[c-1];}return m;},convertAbsoluteToBlend:function(e,g){this.useDefault=false;this.isColorBanding=true;var c=g.abs.replace(/&quot;/g,'"').replace(/&gt;/g,">").replace(/&lt;/g,"<").replace(/&amp;/g,"&");c=(new window.DOMParser()).parseFromString(c,"text/xml");var f=c.getElementsByTagName("m")[0];e.absoluteColorID=f.getAttribute("id");this.isFixedColorBanding=true;this.fixedBandingArray=f.getAttribute("bl").split(",");var d;if(!isNaN(this.min)&&!isNaN(this.max)){d={max:this.max,min:this.min};}else{d=this.getMaxMinByMetricID(e.modelData,e.absoluteColorID);this.max=d.max;this.min=d.min;}if(isNaN(this.initMax)||isNaN(this.initMin)){d=this.getMaxMinByMetricID(e.modelData,e.absoluteColorID);this.max=d.max;this.min=d.min;this.initMax=d.max;this.initMin=d.min;}g.bandColors=f.getAttribute("ba");g.gradientColors=this.convertFixedValueToBlendString(this.fixedBandingArray,d);},createDataProviderFromString:function Y(k,j){var d=k.split(","),e=0,h,g;this.blend.dp=[];this.useDefault=false;h=this.blend.dp;if(d.length%2===0){while(e<d.length){g={};g.v=parseFloat(d[e]);e++;g.c=parseInt(d[e],10);e++;h[h.length]=g;}}e=0;d=j.split(",");this.band.dp=[];h=this.band.dp;if(d.length%4===0){while(e<d.length){g={};g.s=parseFloat(d[e]);e++;g.e=parseFloat(d[e]);e++;g.c=parseInt(d[e],10);e++;var f=d[e];switch(f){case"leftToRight":g.d=G.LeftToRight;break;case"rightToLeft":g.d=G.RightToLeft;break;case"center":g.d=G.Center;break;default:g.d=G.None;}e++;h[h.length]=g;}}},getBackgroundColor:function(){if(this.style==="light"){return"#ffffff";}return"#333333";},decodeAttriColorByColor:function(d){if(typeof d==="object"){return d;}var c=this.RGB_BRG_Switch(d);return mstrmojo.color.decodeColor(c);},RGB_BRG_Switch:function(d){var f=(d>>16)&255,e=(d>>8)&255,c=(d>>0)&255;return(c<<16)|(e<<8)|(f<<0);}};}};}());(function(){mstrmojo.requiresCls("mstrmojo.Obj","mstrmojo.hash");var B="___value",E="___parent",A="___key_map",D="___IS_LEAF";mstrmojo.netviz.ObservableModel=mstrmojo.declare(mstrmojo.Obj,[],{scriptClass:"mstrmojo.netviz.ObservableModel",init:function(H){var G=[];H=H||{};H=mstrmojo.hash.clone(H);var L=Object.keys(H),F=L.length,K,J;for(K=0;K<F;K++){var I=L[K],M=H[I];if(!(M instanceof Object)){J=new C();J[B]=M;J[D]=true;H[I]=J;}else{H[I]=J=new C(M);}G.push(J);H[I][E]=this;}if(this._super){this._super(H);}this.addDisposable(G);this[A]=H;},getParent:function(){return this[E];},getChildrenKeys:function(){return Object.keys(this[A]);},isLeafNode:function(){return this[D];},getValue:function(){if(this.isLeafNode()){return this[B];}return this.getRawObject();},setValue:function(G,K){var F=this.getValue();var M,J,I,L,H;if(this.isLeafNode()){if(!(G instanceof Object)){if(F!==G){this[B]=G;if(!K){this.raiseEvent({name:"valueChanged",target:this,oldValue:F,newValue:G});}}}else{this[B]=undefined;this[D]=undefined;this[A]=G;M=Object.keys(G);J=M.length;H=this.addDisposable(new C(G));for(I=0;I<J;I++){L=M[I];this[L]=H[L];H[E]=this;}if(!K){this.raiseEvent({name:"valueChanged",target:this,oldValue:F,newValue:G});}}}else{var N=this.getChildrenKeys();J=N.length;for(I=0;I<J;I++){L=N[I];this[L]=undefined;}if(!(G instanceof Object)){this[D]=true;this[B]=G;this[A]=undefined;this[B]=G;if(!K){this.raiseEvent({name:"valueChanged",target:this,oldValue:F,newValue:G});}}else{this[A]=G;M=Object.keys(G);J=M.length;H=this.addDisposable(new C(G));for(I=0;I<J;I++){L=M[I];this[L]=H[L];H[E]=this;}if(!K){this.raiseEvent({name:"valueChanged",target:this,oldValue:F,newValue:G});}}}},stopPropagation:function(F){F._isStopped=true;},raiseEvent:function(G){if(this._super){this._super(G);}if(G._isStopped){return ;}var F=this.getParent();if(F){F.raiseEvent(G);}},getRawObject:function(){var G={},J=this.getChildrenKeys(),F=J.length,I;for(I=0;I<F;I++){var H=J[I],K=this[H];if(K.isLeafNode()){G[H]=K.getValue();}else{G[H]=K.getRawObject();}}return G;}});var C=mstrmojo.netviz.ObservableModel;}());(function(){mstrmojo.requiresCls("mstrmojo.hash","mstrmojo.array","mstrmojo.DocDataService","mstrmojo.mstr.EnumFunction","mstrmojo.warehouse.EnumDatabaseType","mstrmojo.mstr.EnumDSSXMLObjectTypes");mstrmojo.requiresDescs(5421,5422,13355);var P=mstrmojo.hash,L=mstrmojo.array,F=mstrmojo.desc,G=mstrmojo.DocDataService,C=mstrmojo.string,a=mstrmojo.mstr.EnumFunction,b=mstrmojo.mstr.EnumDSSXMLObjectTypes;var c=1;function K(n,d,s,u){var g=n.model,p=n.cmSelCells,t=[],AD=g.getCellTitleInfo(d).title,AF,x,j=function(e){var i=n.getCellForNode(e);t.push(n.getCellUnitIndex(i));AF=i.dpt;},o,AA=d.lv>=0,AG;if(typeof u==="string"&&u.indexOf(";")>0){x=parseInt(u.substring(u.indexOf(";")+1),10);u=parseInt(u.substring(0,u.indexOf(";")),10);}if(x===1&&!s){p.reverse().forEach(j);}else{if(x===1){o=1;p.forEach(j);}else{p.forEach(j);}}AG={oId:AD.id,oTp:AD.otp,depth:AF,ordinals:t.join(","),sliceId:n.sid,viewKey:n.k,funcVal:u,switchOrder:o,art:g.getObjectInfoFromDataset(AD.id).art,isRA:AA};if(AA&&u===a.FunctionApplySimple){var r=g.docModel.datasets[g.data.datasetId];if(r&&r.tables&&r.tables.length>=0&&r.tables[0].dbt===mstrmojo.warehouse.EnumDatabaseType.EssBase){AG.peName=AD.v||AD.n;}else{var k=n.getCellForNode(p[0]),AE=k._e.id;AG.peId=AE;AG.peName=k._e.ori_n||k._e.n;try{if(AD.fix>=0){var h=g.docModel.findUnitInDataSet(AD.id).fs,m=L.filterOne(h,function(e){return e.fnm==="DESC";}).fid;if(m){var AB=n.dataBlocks&&n.dataBlocks[k._gd]||g.data,z=AB.gts[(AD.axis===c)?"row":"col"],l=L.filterOne(z,function(e){return e.id===AD.id&&e.fid===m;}),AC=l.es[k.idx];AG.peName=AC&&(AC.ori_n||AC.n)||AG.peName;}}else{var q;L.forEach(AD.fs,function(w,e){if(w.n==="DESC"){q=e;return false;}});if(q!==undefined){var f=[];if(AD.axis===c){var y;for(y=k.idx;y>-1;y--){if(AD.es[y].id===AE){f=[AD.es[y].ori_n||AD.es[y].n].concat(f);}else{break;}}for(y=k.idx+1;y<AD.es.length;y++){if(AD.es[y].id===AE){f.push(AD.es[y].ori_n||AD.es[y].n);}else{break;}}}else{f=L.map(L.filter(AD.es,function(i){return i.id===AE;}),function(i){return i.ori_n||i.n;});}AG.peName=f[q]||AG.peName;}}}catch(AC){}}}return AG;}function D(f,e,h){var k=f.getDEInfo(e),j=k&&k.deObject&&k.deObject.des,i=1,g=h===-1?F(5187,"Group"):(h===a.FunctionApplySimple?F(13355,"Calculated Member"):F(5188,"Calculation")),d=function(l){return l.n===g+" "+i;};while(true&&j){if(j.some(d)){i++;}else{break;}}f.controller.onAddQuickDE(f,P.copy(K(f,e,false,h),{act:"addQuickDE",deName:g+" "+i}));}function Z(d,f){var e;for(e in d){if(L.find(d[e].att,"did",f)>-1){return e;}}return undefined;}function X(d){var f=d.split(";"),e;if(f.length>1&&f[f.length-2].slice(-1)!=="//"){f.splice(-1,1);}e=f.join(";");return e.replace(/\\:/g,"*:").replace(/\\;/g,";").replace(/\\\\/g,"\\").substring(1);}function A(p,e,l,h,d){var k=l.es,f=l.id,j;d.forEach(function(q){j=q[0];if(j.eid.indexOf(f)<0){k.push({n:C.decodeHtmlString(j.v,true),t:mstrmojo.vi.enums.EnumDerivedElementType.LIST,v:X(j.eid)});}});var g=p.controller,o=p.model&&p.model.docModel,n=g._getXtabCallback(p),i={act:"applyDEChanges",deId:e.did,attId:e.attId,attName:e.attName,dsId:e.dsId,k:p&&p.k,actions:[V(l,h)]};o.addUpdateObjects(i,{id:i.deId||i.attId,type:47,flag:G.PARTIAL_UPDATE_FLAGS.DATA_CHANGE});n=mstrmojo.func.wrapMethods(n,o.getDatasetsUpdateCallback(),o.getUpdateHiddenLayoutsCallback(),{success:function(){o.callOnNDECreated([l]);}});var m=function(q){return function(){if(i&&q){i.partialRetrieval={nodes:Y(p,o,e)};}var r=q?o.wrapUnsetVisualizationFilterAction(i):i;g.submitUndoRedoUpdates(r,{},n,G.REQUEST_DEFN_DATA);};};o.checkAndNotifyVFChangeOnGroupUpdate({actions:i},m(true),m(false));}function V(e,d){return{act:"update",position:d+1,item:e};}function E(f,e,i,h,g){var d=f.model.getCellTitleInfo(e).title;f.controller.onSetDEHierachyOptions(f,{act:"setDEHierarchyOptions",oId:d.id,eId:i.id,splice:h,expand:g});}function O(h,e){var d=[],g=e.t,f=e.did;h.getDropZones().zones.forEach(function(i){((i&&i.items)||[]).forEach(function(k){var l=k.t,j=k.did;if(l!==21&&j!=="-1"&&j!=="00000000000000000000000000000000"&&((l===4&&g===4)||(l!==4&&g!==4))&&j!==f&&L.find(d,"did",j)===-1){d.push(k);}});});h.docModel.getDatasetUnits(g===4?["mx"]:["att"]).forEach(function(i){if(L.find(d,"did",i.did)===-1&&i.did!==f&&!i.hide){d.push(i);}});return mstrmojo.vi.ui.DatasetUnitMenuUtils.getSortedDatasetUnits(d);}function Y(g,d,f){var e=d.getSourceFilterKeys(g.zonesModel.getHost().k);L.forEach(g.parent.parent.children,function(j){var h=j.boxContent.gridInfo;if(h){var k=(h.rows.concat(h.cols)).some(function(l){return l.did===f.did;}),i=e.some(function(l){return l===j.k;});if(k&&!i){e.push(j.k);}}});return e;}mstrmojo.vi.ui.rw._XtabDE=mstrmojo.provide("mstrmojo.vi.ui.rw._XtabDE",{scriptClass:"mstrmojo.vi.ui.rw._XtabDE",derivedElementGroup:function M(d){D(this,d,-1);},addElementsToGroup:function N(f,g,e,d){A(this,f,g,e,d);},derivedElementCalculation:function B(e,d){D(this,e,d);},separateOthers:function Q(d,e){E(this,d,e,1,1);},renameDEList:function I(d){this.controller.onEditQuickDEList(this,P.copy(K(this,d,true,-1),{act:"editQuickDEList",deName:d.v}));},editQuickDECalculationNumberFormat:function J(e,f){var d=K(this,e);d.deId=f.de.id;d.act="editQuickDECalculationNumberFormat";this.controller.editQuickDECalculationNumberFormat(this,P.copy(d,this.model.docModel.createNumberFormatParams(f)));},editDECalculation:function H(e,d){if(d!==undefined&&d!==null){this.controller.editQuickDECalculation(this,P.copy(K(this,e,true,d),{act:"editQuickDECalculation"}));}else{this.controller.onEditQuickDECalculation(this,P.copy(K(this,e,true),{act:"editQuickDECalculation",deName:e.v}));}},createDEParam:function K(d,f,e){return K(this,d,f,e);},removeQuickDE:function S(k,o){var h=o&&o.deObject,i=(h&&h.des)||[],p=this,q=2,n=L.filter(i,function(s){return !s.ido;},{max:q+1});if(h&&(i.length<=q||n.length<=q)){var j=[],m=this.zonesModel.getZoneForObject(h.did),f=O(this.zonesModel,h),e=L.find(f,"did",h.attId),d=e>=0?f[e]:null,l={};if(d&&m){j.push(P.copy({isUngroup:1,deId:h.did},this.model.getAddTemplateUnitAction(d,h.dsId,m.id,L.find(m.items,"did",h.did))));j=[this.zonesModel.getUpdateTemplateAction(j)];l=this.controller._getXtabCallback(this);}j.push({act:"removeNDEFromDS",dsid:h.dsId,oid:h.did,disablePU:true});l=mstrmojo.func.wrapMethods(this.controller.model.getDatasetsUpdateCallback(),this.controller.model.getReloadLayoutModelCallback(),l,this.controller.getReloadLayoutViewCallback());var r=p.model&&p.model.docModel;var g=function(s){return function(){var t=(s&&r)?r.wrapUnsetVisualizationFilterAction(j):j;p.controller.submitUndoRedoUpdates(t,null,l,G.REQUEST_DEFN_DATA);};};r&&r.checkAndNotifyVFChangeOnGroupUpdate({actions:j,zm:r},g(true),g(false));}else{this.controller.removeQuickDE(this,P.copy(K(this,k),{act:"removeQuickDE"}));}},derivedElementsEdit:function U(l,g){if(!g){g=this.getDEInfo(l);}var h=this.model,e=h.getCellTitleInfo(l).title,f=g&&g.deObject,k=g&&g.de,d,j,i;if(!f){d=this.gridData.datasetId||Z(h.docModel.datasets,e.id);j=e.id;i=e.n?C.decodeHtmlString(e.n):undefined;}this.controller.openDEEditor(this,{dsId:d,attId:j,attName:i,deObj:f,elemId:k&&k.id,dispName:l.n?C.decodeHtmlString(l.n):i});},getDEInfo:function W(l){var g=this.model,i=g.getCellTitleInfo(l),j=i.isSrcTitle,e=i.title,d=l.dei,f,k;if((e&&e.ost!==12033)||(j&&l.otp!==b.Consolidation)){return null;}var h=(e&&e.id)||(j&&l.otp===b.Consolidation&&l.id);f=g.docModel.getDEObject(h);if(f&&d!==undefined){k=f.des[d];}return{deObject:f,de:k,ttl:e};},getOthersDEInfo:function R(e){var d;L.forEach(e.des,function(f){if(f.t===4){d=f;return false;}});return d;}});}());(function(){mstrmojo.requiresCls("mstrmojo._HasPopup","mstrmojo.Button","mstrmojo.dom","mstrmojo.Container");mstrmojo.requiresDescs(1442,2140);var C=mstrmojo.dom;mstrmojo.ui.menus.ToolbarEditor=mstrmojo.declare(mstrmojo.Container,[mstrmojo.ui.menus._IsMenuPopup,mstrmojo._IsPopup,mstrmojo._CanAutoClose],{scriptClass:"mstrmojo.ui.menus.ToolbarEditor",markupString:'<div id="{@id}" class="mstrmojo-ui-ToolbarEditor mstrmojo-ui-MenuEditor {@cssClass}" style="..." mstrAttach:mouseover,mouseout,click><div class="te-content"></div></div>',markupSlots:{containerNode:function A(){return this.domNode.firstChild;}},popupConfig:null,children:null,autoCloses:false,locksHover:true,visible:true,onclick:function B(E){C.stopPropogation(null,E.e);},init:function D(F){this._super(F);var E=this.popupConfig,G=E.contents;if(!G){throw new Error("Cannot open editor without editor content.");}this.cssClass=E.cssClass;this.addChildren(G);}});}());(function(){mstrmojo.requiresCls("mstrmojo.ui.PopupConfig","mstrmojo.ui.menus.ToolbarEditor","mstrmojo.hash");mstrmojo.ui.menus.ToolbarEditorConfig=mstrmojo.declare(mstrmojo.ui.PopupConfig,[mstrmojo._HasBindings],{scriptClass:"mstrmojo.ui.menus.ToolbarEditorConfig",cssClass:"",contents:null,init:function C(D){this._super(D);this.initBindings();},clear:function A(){this._super();this.contents=null;},newInstance:function B(D){return new mstrmojo.ui.menus.ToolbarEditor(mstrmojo.hash.copy({popupConfig:this},D));}});}());(function(){mstrmojo.requiresCls("mstrmojo.ui.editors.controls.ControlGroup","mstrmojo.ui.editors.controls.TwoColumnContainer","mstrmojo.ui.editors.controls.ColorPickerButton","mstrmojo.ui.editors.controls.ValidationTextBox","mstrmojo.hash","mstrmojo.array","mstrmojo.ValidationTextBox","mstrmojo.expr");var K=mstrmojo.emptyFn,B=mstrmojo.hash,H=mstrmojo.array,I=mstrmojo.expr.DTP,F={FILL_COLOR:"Clr",FILL_TRANSPARENT:"FillTrans"},C=1,J=2;function N(U,Q,P,S,R){return{scriptClass:"mstrmojo.ui.editors.controls.ColorPickerButton",alias:"fillColor",slot:U,showNoFill:S!==false,showAutomatic:!!R,showGradient:false,selectedValue:"#000000",isHostedWithin:Q||false,postselectedValueChange:function(V){if(this.propName&&this.parent&&this.parent.parent){this.parent.parent.raiseFormatValueChange(this.propName,V.value,V.valueWas);}},postclick:function(V){this.parent.parent.postclick(V);}};}function O(Q){return{scriptClass:"mstrmojo.ui.editors.controls.TwoColumnContainer",alias:"fillAlpha",slot:Q,col1Width:"100%",col2Width:"10px",children:[{scriptClass:"mstrmojo.ui.editors.controls.ValidationTextBox",alias:"fillAlphaText",slot:"col1Node",value:"100",cssText:"text-align:right",dtp:I.INTEGER,required:true,constraints:{min:0,max:100},onvalueChange:function(R){this.valueWas=R.valueWas;},onValid:function P(){if(this.propName&&this.value!==this.valueWas){this.parent.parent.parent.raiseFormatValueChange(this.propName,this.value,this.valueWas);}},postclick:function(R){this.parent.parent.parent.postclick(R);}},{scriptClass:"mstrmojo.Label",slot:"col2Node",text:"%"}]};}mstrmojo.ui.editors.controls.FillConfigGroup=mstrmojo.declare(mstrmojo.ui.editors.controls.ControlGroup,null,{scriptClass:"mstrmojo.ui.editors.controls.FillConfigGroup",propNames:undefined,postclick:K,visibleControls:C+J,fillColorAndTrans:undefined,init:function M(U){this._super(U);var Q=[],X="col1Node",R=U&&U.colorPickerHostWithin,P=U&&U.showGradient,W=U&&U.showNoFill,S=U&&U.showAutomaticInColor,V;if((this.visibleControls&C)>0){Q.push(N(X,R,P,W,S));X="col2Node";}if((this.visibleControls&J)>0){Q.push(O(X));}if(Q.length===1){V={col1Width:"100%",dividerWidth:"0",col2Width:"0"};}this.addChildren([B.copy(V,{scriptClass:"mstrmojo.ui.editors.controls.TwoColumnContainer",alias:"fillColorAndTrans",children:Q})]);},getChildComp:function L(P){if(P.indexOf(F.FILL_COLOR)!==-1){return this.fillColorAndTrans.fillColor;}if(P.indexOf(F.FILL_TRANSPARENT)!==-1){return this.fillColorAndTrans.fillAlpha.fillAlphaText;}return undefined;},iniChildrenComp:function E(P){this.propNames=P;H.forEach(P,function(R){var Q=this.getChildComp(R);if(Q!==undefined){Q.propName=R;}},this);},setChildValue:function D(Q,R){var P=this.getChildComp(Q);if(P===undefined){return false;}switch(P.alias){case"fillColor":if(R!==P.selectedValue){P.set("selectedValue",R==="undefined"?"conflict":R);}break;case"fillAlphaText":if(R!==P.value){P.set("value",R==="undefined"?"":R);}break;}},setChildEnable:function G(R,Q){var P=this.getChildComp(R);if(P!==undefined){P.set("enabled",Q);}},setChildrenValue:function A(P){var Q=this;P.forEach(function(R){Q.setChildValue(R[0],R[1]);});}});mstrmojo.ui.editors.controls.FillConfigGroup.CTRL_FLAGS={FILL_COLOR:C,FILL_TRANSPARENCY:J};mstrmojo.ui.editors.controls.FillConfigGroup.FillCompName=F;}());(function(){mstrmojo.requiresCls("mstrmojo.ui.editors.controls.ControlGroup","mstrmojo.array","mstrmojo.hash","mstrmojo.ui.editors.controls.ColorPickerButton","mstrmojo.ui.editors.controls.LineStyleButton");var L=mstrmojo.emptyFn,I=mstrmojo.array,C=mstrmojo.hash,E=mstrmojo.gm.EnumCombinedLineStyle;var J={LINE_COLOR:"Clr",LINE_STYLE:"Style"},A={"1pt solid":E.THIN,"2pt solid":E.THICK,"1pt dashed":E.DASHED,"1pt dotted":E.DOTTED,none:E.NONE};function D(P,O){return C.copy(O,{scriptClass:"mstrmojo.ui.editors.controls.ColorPickerButton",alias:"lineColor",slot:P,selectedValue:"#000000",postselectedValueChange:function(Q){if(this.propName){this.parent.parent.raiseFormatValueChange(this.propName,Q.value,Q.valueWas);}},postclick:function(Q){this.parent.parent.postclick(Q);}});}function K(P){return{scriptClass:"mstrmojo.ui.editors.controls.LineStyleButton",showThickOption:true,showNoneOption:true,hideDashOptions:false,defaultSelectedIndex:3,propName:undefined,alias:"lineStyle",slot:P,postInit:function O(){var Q=["mstrmojo-ui-LineStyle"];if(!this.showNoneOption){Q.push("no-none");}if(this.hideDashOptions){Q.push("no-dash");}mstrmojo.css.addWidgetCssClass(this,Q);(this.list.items||[]).forEach(function(R){R.v=(A[R.id]!==undefined?A[R.id]:A["not defined"]);});},onshowNoneOptionChange:function(Q){var R=["no-none"];if(!Q.value){mstrmojo.css.addWidgetCssClass(this,R);}else{mstrmojo.css.removeWidgetCssClass(this,R);}var S=this.hasRendered;if(S){this.refresh();}},postselectedValueChange:function(R){this._super();var Q=I.find(this.list.items,"id",R.value);if(Q===-1){Q=this.defaultSelectedIndex;}var S=this.list.items[Q].v;if(this.propName){this.parent.parent.setChildEnable(J.LINE_COLOR,S!==A.none);this.parent.parent.raiseFormatValueChange(this.propName,S,A[R.valueWas]);}},postclick:function(Q){this.parent.parent.postclick(Q);}};}mstrmojo.ui.editors.controls.LineConfigGroup=mstrmojo.declare(mstrmojo.ui.editors.controls.ControlGroup,null,{scriptClass:"mstrmojo.ui.editors.controls.LineConfigGroup",propNames:undefined,postclick:L,hideColorControl:false,showGradient:false,showNoFillInColor:true,showAutomaticInColor:false,showNoneOption:true,lineColorAndStyle:undefined,lineTitle:undefined,init:function N(Q){this._super(Q);var O=[],R;O.push(K("col1Node"));if(!this.hideColorControl){O.push(D("col2Node",{showGradient:this.showGradient,showNoFill:this.showNoFillInColor,showAutomatic:this.showAutomaticInColor}));}else{R={col1Width:"100%",dividerWidth:"0",col2Width:"0"};}var P=[];if(this.lineTitle&&this.lineTitle!==""){P.push(new mstrmojo.Label({text:this.lineTitle}));}P.push(C.copy(R,{scriptClass:"mstrmojo.ui.editors.controls.TwoColumnContainer",alias:"lineColorAndStyle",children:O}));this.addChildren(P);},getChildComp:function M(O){if(O.indexOf(J.LINE_COLOR)!==-1){return this.lineColorAndStyle.lineColor;}if(O.indexOf(J.LINE_STYLE)!==-1){return this.lineColorAndStyle.lineStyle;}return null;},iniChildrenComp:function G(P){I.forEach(P,function(R){var Q=this.getChildComp(R);if(Q!==undefined){Q.propName=R;}},this);var O=this.lineColorAndStyle.lineStyle;O.showNoneOption=this.showNoneOption;O.hideDashOptions=this.hideDashOptions;O.postInit();},onshowNoneOptionChange:function(O){this.lineColorAndStyle.lineStyle.set("showNoneOption",O.value);},setChildValue:function F(Q,R){var O=this.getChildComp(Q);if(O===undefined){return false;}var P;switch(O.alias){case"lineColor":if(R!==O.selectedValue){O.set("selectedValue",typeof R==="undefined"?"conflict":R);}break;case"lineStyle":if(typeof R==="undefined"){O.list.clearSelect();this.syncControls(function(){O.set("selectedValue","conflict");});}else{P=I.find(O.list.items,"v",R);if(P===-1){P=O.defaultSelectedIndex;}var S=O.list.items[P].id;if(S!==O.selectedValue){O.set("selectedValue",S);}}break;}},setChildEnable:function H(Q,P){var O=this.getChildComp(Q);if(O!==undefined){O.set("enabled",P);}},setChildrenValue:function B(O){O.forEach(function(P){this.setChildValue(P[0],P[1]);});}});}());(function(){mstrmojo.requiresCls("mstrmojo.locales");mstrmojo.requiresCls("mstrmojo.chart.enums.EnumFontStyle");mstrmojo.requiresCls("mstrmojo.VisUtility");mstrmojo.requiresClsP("mstrmojo.chart.common","DSSDateTime","ScalePlate");mstrmojo.requiresClsP("mstrmojo.chart.model.enums","EnumDSSGraphProperty","EnumDSSGraphDataTextShowType","EnumDSSGraphObject");var h=mstrmojo.chart,d=h.model,p=mstrmojo.VisUtility,Q=h.enums,E=Q.EnumFontStyle,S=d.enums,z=S.EnumDSSGraphProperty,Y=S.EnumDSSGraphDataTextShowType,AA=S.EnumDSSGraphObject;var F=mstrmojo.gm.EnumDataLabels;var W=[["xAxLbFntClr","yAxLbFntClr","dlFntClr","lgdFntClr"],["xAxLbFntFml","yAxLbFntFml","dlFntFml","lgdFntFml"],["xAxLbFntSz","yAxLbFntSz","dlFntSz","lgdFntSz"],["xAxLbFntStyle","yAxLbFntStyle","dlFntStyle","lgdFntFml"]];var q=[["majorGridLnThk","minerGridLnThk","majorGridLnThk","minerGridLnThk"],["majorGridLnClr","minerGridLnClr","majorGridLnClr","minerGridLnClr"],["majorGridLnStyle","minerGridLnStyle","majorGridLnStyle","minerGridLnStyle"]];var Z=[["bgFillClr"],["bgFillStyle"],["bgFillTrans"]];function V(AJ){switch(AJ){case z.DssGraphFontColor:return 0;case z.DssGraphFontName:return 1;case z.DssGraphFontSize:return 2;case z.DssGraphFontStyle:return 3;case z.DssGraphFontSize100:return 4;default:return -1;}}function u(AJ){switch(AJ){case z.DssGraphAreaColor:return 0;case z.DssGraphFillEffect:return 1;case z.DssGraphAreaAlpha:return 2;}return -1;}function x(AJ){var AK;switch(AJ){case AA.DssGraphX1Body:case AA.DssGraphX1Label:case AA.DssGraphX1Major:case AA.DssGraphX1Minor:case AA.DssGraphUserLabel3:case AA.DssGraphUserLine3:AK="X1";break;case AA.DssGraphX2Body:case AA.DssGraphX2Label:case AA.DssGraphX2Major:case AA.DssGraphX2Minor:case AA.DssGraphUserLabel4:case AA.DssGraphUserLine4:AK="X2";break;case AA.DssGraphY1Body:case AA.DssGraphY1Label:case AA.DssGraphY1Major:case AA.DssGraphY1Minor:case AA.DssGraphUserLabel1:case AA.DssGraphUserLine1:AK="Y1";break;case AA.DssGraphY2Body:case AA.DssGraphY2Label:case AA.DssGraphY2Major:case AA.DssGraphY2Minor:case AA.DssGraphUserLabel2:case AA.DssGraphUserLine2:AK="Y2";break;case AA.DssGraphZBody:AK="Z";break;case AA.DssGraphO1Body:case AA.DssGraph2DO1Label:case AA.DssGraphO1Major:case AA.DssGraphO1Minor:AK="O1";break;case AA.DssGraphO2Body:case AA.DssGraph2DO2Label:case AA.DssGraphO2Major:case AA.DssGraphO2Minor:AK="O2";break;default:AK="No_Axis";break;}return AK;}function e(AJ,AK){if(!!AJ===false){return undefined;}return undefined;}function X(AO,AJ){if(!!AO===false){return undefined;}var AT,AR,AQ=AJ.isVertical!==undefined?AJ.isVertical:true,AL=AJ.isGridChart||false,AU=AJ.isPieShape||false,AP={Name:0,Value:0},AM=AO.gaid,AN=AO.goid,AK=AO.gsid,AS=AO.v;if(!!AM===false){return undefined;}switch(AM){case z.DssGraphShowLBLFeeler:if(AU){AP.Name="DataLabel";if((AS&Y.DssGraphDataTextValue)!==0){AP.Value=F.SHOW_VALUE_ONLY;}else{if((AS&Y.DssGraphDataTextLabel)!==0){AP.Value=F.SHOW_TEXT_ONLY;}else{AP.Value=F.HIDE;}}}break;case z.DssGraphAreaColor:case z.DssGraphFillEffect:case z.DssGraphAreaAlpha:AR=u.call(this,AM);if(AR<0){return undefined;}if(AN===AA.DssGraphBackground){AP.Name=Z[AR][0];if(AP.Name.search("Trans")!==-1){AP.Value=AS/255*100;}else{AP.Value=AS;}}break;case z.DssGraphShowLegendText:AP.Name="LegendVisibleness";AP.Value=AS===0?false:true;break;case z.DssGraphSDShowDataText:AP.Name="ShowSeriesDataLabel";AP.Value=AS!==0;break;case z.DssGraphShowDataText:if(AU===false){AP.Name="DataLabel";AP.Value=F.HIDE;if(AS&Y.DssGraphDataTextValue){AP.Value=F.SHOW_VALUE_ONLY;}else{if(AS&Y.DssGraphDataTextLabel){AP.Value=F.SHOW_TEXT_ONLY;}}}break;case z.DssGraphFontColor:case z.DssGraphFontName:case z.DssGraphFontSize100:case z.DssGraphFontSize:case z.DssGraphFontStyle:AP.Value=AS;AT=x.call(this,AN);AR=V.call(this,AM);if(AR<0){return undefined;}if(AR===4){AR=3;AP.Value/=100;}if(AT==="No_Axis"){if(AN===AA.DssGraphDataText){if(AU){return undefined;}AP.Name=W[AR][2];}else{if(AN===AA.DssGraphPieFeelerLabel||AN===AA.DssGraphPieFeelerLabel){if(AU===false){return undefined;}AP.Name=W[AR][2];}else{if(AN===AA.DssGraphLegendText){AP.Name=W[AR][3];}else{return undefined;}}}}else{if(AT[0]==="X"){AP.Name=W[AR][0];}else{if(AT[0]==="Y"){AP.Name=W[AR][1];}else{if(AT[0]==="O"){AP.Name=AQ?W[AR][0]:W[AR][1];}else{return undefined;}}}}break;}return AP;}var U,j=String.fromCharCode,AD=mstrmojo.locales.datetime,AI=0,L=document.getElementById("measureText"),B={},i={};var n=0.03,K=0,R=0,H=0.2;function o(AK){var AJ,AL=[],AM;for(AJ=0;AJ<=AK;AJ++){AM=AJ.toString(16);if(AM.length===1){AM="0"+AM;}AL[AJ]=AM;}U=AL;return AL;}function AG(AJ){var AK=parseFloat(AJ);if(isNaN(AK)===false&&AK!==undefined&&AK!==null){return AK;}return 0;}function D(AJ){AJ=AJ.replace(/ddd/g,"EEE");AJ=AJ.replace(/AM\/PM/g,"a");AJ=AJ.replace(/tt/g,"a");AJ=AJ.replace(/:'/g,":");AJ=AJ.replace(/'\/'/g,"/");AJ=AJ.replace(/\\/g,"");var AK,AM=true,AL=AJ.length;for(AK=0;AK<AL;AK++){if(AJ[AK]==="h"||AJ[AK]==="H"||AJ[AK]===":"){AM=true;}else{if(AJ[AK]===" "&&AM){AM=true;}}if(AJ[AK]==="m"&&AM){AJ=AJ.substring(0,AK)+"M"+AJ.substring(AK+1);}}return AJ;}mstrmojo.chart.common.Utility=mstrmojo.provide("mstrmojo.chart.common.Utility",{point2D:{},rect2D:{},tripleId:{create:function M(AK,AO,AM,AL,AN){if(AK===null||AK===undefined){AK=-3;}if(AO===null||AO===undefined){AO=-3;}if(AM===null||AM===undefined){AM=-3;}var AJ={mObjectId:AK,mSeriesId:AO,mGroupId:AM};if(AL!==undefined&&AL!==null){AJ.angleByIndex=AL;}if(AN!==undefined&&AN!==null){AJ.sliceById=AN;}return AJ;},walks:function l(AN,AL){if(!!AN===false||!!AL===false){return null;}if(AN.length===1){return AL[AN[0]];}var AM=(AN&&AN.length)||0,AK,AJ=AN[AK];for(AK=0;AK<AM;AK++){if(AL[AJ]===undefined){AL[AJ]={};}AL=AL[AJ];}return AL;},equal:function b(AJ,AK){return(AJ.mObjectId===AK.mObjectId&&AJ.mSeriesId===AK.mSeriesId&&AJ.mGroupId===AK.mGroupId);},reset:function r(AL,AN,AM,AK,AJ,AO){AL.mObjectId=AN!==undefined?AN:-3;AL.mSeriesId=AM!==undefined?AM:-3;AL.mGroupId=AK!==undefined?AK:-3;if(AJ!==undefined&&AJ!==null){AL.angleByIndex=AJ;}if(AO!==undefined&&AO!==null){AL.sliceById=AO;}return AL;}},transformProperty:function A(AJ,AL,AK){if(AL===0){return X.call(this,AJ,AK);}return e.call(this,AJ,AK);},abbreviateNumber:function c(AT,AJ){var AU,AK,AV="",AM=(AT<0),AW=(this.isIntegar(AT)===false);if(AW){AJ++;}if(AT<0){AJ++;}var AP=AM?-AT:AT;var AQ=0;if(AP>=1e+27){AP=999;AV="Y";}else{if(AP>=1e+24){AP/=1e+24;AV="Y";}else{if(AP>=1e+21){AP/=1e+21;AV="Z";}else{if(AP>=1000000000000000000){AP/=1000000000000000000;AV="E";}else{if(AP>=1000000000000000){AP/=1000000000000000;AV="P";}else{if(AP>=1000000000000){AP/=1000000000000;AV="T";}else{if(AP>=1000000000){AP/=1000000000;AV="B";}else{if(AP>=1000000){AP/=1000000;AV="M";}else{if(AP>=1000){AP/=1000;AV="K";}else{if(AP>=1){AQ++;}else{if(AP>=0.001){AQ++;}else{if(AP>=0.000001){AQ++;}else{if(AP>=1e-9){AQ++;}else{if(AP>=1e-12){AQ++;}else{AM=false;}}}}}}}}}}}}}}if(this.isIntegar(AP)===false){AU=AP.toString();var AL=5,AO=2,AX;AK=AU.indexOf(".");AX=AU.length-AK-1;if(AX>AL||(AX>AO&&AX>AK)){if(AX>AL&&AJ-AX<0){AO=Math.max(AO,Math.min(AO,AJ-AX));}else{AO=Math.max(1,Math.min(AO,AJ-AX));}AP=AP.toFixed(AO);}}AU=AP.toString();if(this.isIntegar(AP)===false){var AS=AU.length-1;AK=AU.indexOf(".");if(AK!==-1){if(AK>=AS){AU=AU.substring(0,AK);}else{var AR,AN=true;for(AR=AS;AR>AK&&AN;--AR){if(AU[AR]!=="0"){AN=false;}}if(AN){AU=AU.substring(0,AK);}}}}if(AM){AU="-"+AU;}AU+=AV;return AU;},getScalePlate:function AF(AJ){AJ=AJ||false;this.mScalePlate=mstrmojo.chart.common.ScalePlate;if(AJ){this.mScalePlate.clear();}return this.mScalePlate;},prepareScalePlateOptions:function AC(AL,AK,AM){var AJ={mUseLogarithmicScale:AL,mAlwaysIncludeZero:!AL&&(AK||!!(AM&1)||!!(AM&2)),mShowMinLabel:true,mShowMaxLabel:true,mDrawCustomLine:false,mAxisMinValue:0,mAxisMaxValue:0,mAxisCustomValue:0,mUseCustomMinMax:false};return AJ;},evaluateTextMargin:function P(AJ){this.mTextMargins=this.mTextMargins||{};var AK=this.mTextMargins;if(AK[AJ]){return AK[AJ];}var AL=[];AL[0]=Math.floor(AJ*n+0.5);AL[1]=Math.floor(AJ*K+0.5);AL[2]=Math.max(Math.floor(AJ*R+0.5),1);AK[AJ]=AL;return AL;},AlmostZero:function y(AJ){return(Math.abs(AJ)<0.000001);},isValidNumber:function J(AJ){if(typeof AJ==="number"){if(AJ===0){return true;}return !!AJ;}return false;},isIntegar:function k(AJ){return AJ===+AJ&&AJ===(AJ|0);},HasArrayIntersection:function O(AK,AJ){var AL;for(AL=0;AL<AK.length;AL++){if(AJ.indexOf(AK[AL])!==-1){return true;}}return false;},EscapeString:function C(AJ){var AL='"',AK='\\"',AM=new RegExp(AL,"g");return String(AJ).replace(/</g,"&lt;").replace(/>/g,"&gt;").replace(/\\/g,"\\\\").replace(AM,AK).replace(/\r\n/g,"<br/>").replace(/\r/g,"<br/>").replace(/\n/g,"<br/>");},EscapeStringForJSON:function N(AJ){var AL='"',AK='\\"',AM=new RegExp(AL,"g");return String(AJ).replace(/\\/g,"\\\\").replace(AM,AK).replace(/\r/g,"\\r").replace(/\n/g,"\\n");},TrimLastComma:function AE(AK){var AJ;if(!AK.buf||AK.len===-1){return ;}AJ=AK.len;var AL=String(AK.buf[AJ]);if(AL&&AL[AL.length-1]===","){AK.buf[AJ]=AL.slice(0,-1);}},decodeUTF8:function g(AJ){var AK="",AM=0,AO=0,AN=0,AL=0;while(AM<AJ.length){AO=AJ.charCodeAt(AM);if(AO<128){AK+=j(AO);AM++;}else{if((AO>191)&&(AO<224)){AN=AJ.charCodeAt(AM+1);AK+=j(((AO&31)<<6)|(AN&63));AM+=2;}else{AN=AJ.charCodeAt(AM+1);AL=AJ.charCodeAt(AM+2);AK+=j(((AO&15)<<12)|((AN&63)<<6)|(AL&63));AM+=3;}}}return AK;},formatDateTimeValue:function f(AK,AP){var AN=new mstrmojo.chart.common.DSSDateTime({ifTime:AP});var AJ="";var AM="";var AQ=0;while(AQ<AK.length){var AL=1;switch(AK.charAt(AQ)){case"[":AQ++;while(AQ<AK.length&&AK.charAt(AQ)!=="]"){AM+=AK.charAt(AQ);AQ++;}if(AM.length>0&&(AM[0]===">"||AM[0]==="<"||AM[0]==="=")){AM="";}AQ++;break;case"y":AQ++;while(AQ<AK.length&&AK.charAt(AQ)==="y"){AL++;AQ++;if(AL===4){break;}}if(AL===1||AL===2){AJ+=this.fillZeroToWidth(AN.mnYear%100,2);}else{if(AL===3){AJ+=this.fillZeroToWidth(AN.mnYear%100,2);AQ--;}else{if(AL===4){AJ+=AN.mnYear;}}}break;case"M":AQ++;while(AQ<AK.length&&AK.charAt(AQ)==="M"){AL++;AQ++;}if(AL<3){AJ+=this.fillZeroToWidth(AN.mnMonth,AL);}else{if(AL===3){AJ+=AD.MONTHNAME_SHORT[AN.mnMonth];}else{AJ+=AD.MONTHNAME_FULL[AN.mnMonth];}}break;case"d":AQ++;while(AQ<AK.length&&AK.charAt(AQ)==="d"){AL++;AQ++;}if(AL<3){AJ+=this.fillZeroToWidth(AN.mnDay,AL);}else{if(AL===3){AJ+=AD.dayShortNames[AN.mnDay];}else{AJ+=AD.dayNames[AN.mnDay];}}break;case"h":AQ++;while(AQ<AK.length&&AK.charAt(AQ)==="h"){AL++;AQ++;}var AO=AN.mnHour;if(AO===0){AO=12;}if(AO>12){AO-=12;}AJ+=this.fillZeroToWidth(AO,AL);break;case"H":AQ++;while(AQ<AK.length&&AK.charAt(AQ)==="H"){AL++;AQ++;}AJ+=this.fillZeroToWidth(AN.mnHour,AL);break;case"m":AQ++;while(AQ<AK.length&&AK.charAt(AQ)==="m"){AL++;AQ++;}AJ+=this.fillZeroToWidth(AN.mnMinute,AL);break;case"s":AQ++;while(AQ<AK.length&&AK.charAt(AQ)==="s"){AL++;AQ++;}AJ+=this.fillZeroToWidth(AN.mnSecond,AL);break;case"S":AQ++;while(AQ<AK.length&&AK.charAt(AQ)==="S"){AL++;AQ++;}AJ+=this.fillZeroToWidth(AN.mnMillisecond,AL);break;case"a":AO=AN.mnHour;if(AO<12){AJ+=AD.AM_NAME;}else{AJ+=AD.PM_NAME;}AQ++;break;default:AJ+=AK.charAt(AQ++);break;}}if(AM.length!==0){AJ='<SPAN STYLE="COLOR: '+AM+'" >'+AJ+"</SPAN>";}return AJ;},fillZeroToWidth:function m(AN,AL){var AK="",AM=AK+AN;var AJ=AM.length;while(AJ<AL){AM="0"+AM;AJ++;}return AM;},updateCache:function AH(AK,AN,AO){var AM=(AN&&AN.length)||0,AL,AJ,AP=AK;for(AL=0;AL<AM-1;AL++){AJ=AN[AL];if(!AP[AJ]){AP[AJ]={};}AP=AP[AJ];}AP[AN[AM-1]]=AO;},measureTextHeight:function(AO,AL,AS,AP,AJ){var AR,AN=AO;if(AN===" "){AN="\u00A0";}AJ=AJ||"pt";if(typeof AS==="number"){AS=AS+AJ;}var AK="none",AQ="normal";if(AP&E.FS_ITALIC){AK="italic";}if(AP&E.FS_BOLD){AQ="bold";}var AM={fontFamily:AL,fontSize:AS,fontStyle:AK,fontWeight:AQ};if(i&&i.H&&i.H[AL]&&i.H[AL][AS]&&i.H[AL][AS][AP]){AR=i.H[AL][AS][AP];}else{AR=p.measureTextHeight("H",AM,1);this.updateCache(i,["H",AL,AS,AP],AR);}return AR;},measureText:function w(AQ,AN,AW,AR,AL){var AK=true,AJ,AU=AW+1;var AP=AQ;if(AP===" "){AP="\u00A0";}AL=AL||"pt";if(typeof AW==="number"){AW=AW+AL;}if(B&&B[AP]&&B[AP][AN]&&B[AP][AN][AW]&&B[AP][AN][AW][AR]){return B[AP][AN][AW][AR];}if(AK){var AM="normal",AS="normal";if(AR&E.FS_ITALIC){AM="italic";}if(AR&E.FS_BOLD){AS="bold";}var AO={fontFamily:AN,fontSize:AW,fontStyle:AM,fontWeight:AS};if(i&&i.H&&i.H[AN]&&i.H[AN][AW]&&i.H[AN][AW][AR]){AU=i.H[AN][AW][AR];}else{AU=p.measureTextHeight("H",AO,true);this.updateCache(i,["H",AN,AW,AR],AU);}AJ=p.measureTextWidth(AQ,AO,0);}else{if(!L){var AT=document.createElement("div");AT.id="measureText";AT.style.position="absolute";AT.style.top="0";AT.style.visibility="hidden";AT.style.height="auto";AT.style.width="auto";document.body.appendChild(AT);L=AT;}L.innerHTML="";L.appendChild(document.createTextNode(AP));L.style.fontFamily=AN;L.style.fontSize=AW;L.style.fontWeight="normal";L.style.fontStyle="none";if(AR&E.FS_ITALIC){L.style.fontStyle="italic";}if(AR&E.FS_BOLD){L.style.fontWeight="bold";}AJ=L.scrollWidth+1;AU=L.scrollHeight+1;}var AV={Width:AJ,Height:AU};this.updateCache(B,[AP,AN,AW,AR],AV);return AV;},ReplaceDecimalPoint:function AB(AK,AJ){return AK.replace(".",AJ);},ReplaceMinusSign:function t(AJ,AK){return AJ.replace("-",AK);},insert:function G(AK,AJ,AL){if(typeof AK==="string"&&typeof AJ==="string"&&AL<=AK.length){return AK.substr(0,AL)+AJ+AK.substr(AL);}return AK;},InsertThousandSeparator:function s(AL,AM,AQ){var AJ=AQ.mstrDecimalPoint;var AK=AL.indexOf(AJ);if(AK===-1){AK=AL.length;}var AN=0;while(AN<AK&&!this.chk_val(AL.charAt(AN))){AN++;}var AP=AL;var AO;for(AO=AK-3;AO>AN;AO-=3){AP=this.insert(AP,AM,AO);}return AP;},chk_val:function I(AJ){return/^\d+$/.test(AJ);},hFormatValue:function a(AW,AN,Ah,A6){var AU=0;var Ap=0;var Ad=AW.length;var BE=false;if(!A6){A6={};var An=window.navigator.userLanguage||window.navigator.language;var BP=An.split("-");this.mstrLanguageCode=BP[0];this.mstrCountryCode=BP[1]||BP[0];A6.mstrThousandSeparator=mstrmojo.locales.number.THOUSANDSEPARATOR||",";A6.mstrCurrencySymbol="$";A6.mstrDecimalPoint=mstrmojo.locales.number.DECIMALSEPARATOR||".";A6.mstrPercentSign="%";A6.mstrMinusSign="-";}while(AU<Ad){if(AW.charAt(AU)==='"'){AU++;while(AU<Ad&&AW.charAt(AU)!=='"'){AU++;}AU++;}else{if(AW.charAt(AU)==="["){AU++;var Ao="";while(AU<Ad&&AW.charAt(AU)!=="]"){Ao+=AW.charAt(AU);AU++;}if(Ao.length>1&&(Ao.charAt(0)===">"||Ao.charAt(0)==="<"||Ao.charAt(0)==="=")){var AK=-1;var A8=0;switch(Ao.charAt(0)){case">":if(Ao.charAt(1)>="0"&&Ao.charAt(1)<="9"){AK=1;A8=1;}else{if(Ao.charAt(1)==="="&&Ao.length>2&&Ao.charAt(2)>="0"&&Ao.charAt(2)<="9"){AK=2;A8=2;}}break;case"=":if(Ao.charAt(1)>="0"&&Ao.charAt(1)<="9"){AK=3;A8=1;}else{if(Ao.charAt(1)==="="&&Ao.length>2&&Ao.charAt(2)>="0"&&Ao.charAt(2)<="9"){AK=3;A8=2;}}break;case"<":if(Ao.charAt(1)>="0"&&Ao.charAt(1)<="9"){AK=5;A8=1;}else{if(Ao.charAt(1)==="="&&Ao.length>2&&Ao.charAt(2)>="0"&&Ao.charAt(2)<="9"){AK=4;A8=2;}}break;}if(AK>0){var AY=Ao.substr(A8);var BH=parseFloat(AY);if((AK===1&&AN>BH)||(AK===2&&AN>=BH)||(AK===3&&AN===BH)||(AK===4&&AN<=BH)||(AK===5&&AN<BH)){BE=true;}return mstrmojo.num.formatByMask(AW,AN);}}}else{if(AW.charAt(AU)===";"){if(BE){Ad=AU;break;}else{Ap=AU+1;AU++;}}else{AU++;}}}}if(!BE){Ap=0;}AU=Ap;var Au=false;while(AU<Ad){if(AW.charAt(AU)==='"'){AU++;while(AU<Ad&&AW.charAt(AU)!=='"'){AU++;}}else{if(AW.charAt(AU)==="["){AU++;while(AU<Ad&&AW.charAt(AU)!=="]"){AU++;}}else{if(AW.charAt(AU)==="y"||AW.charAt(AU)==="M"||AW.charAt(AU)==="d"||AW.charAt(AU)==="h"||AW.charAt(AU)==="H"||AW.charAt(AU)==="m"||AW.charAt(AU)==="s"||AW.charAt(AU)==="S"){Au=true;break;}else{AU++;}}}}if(Au){var BC="";if(BE){BC=AW.substr(Ap,Ad-Ap);}else{BC=AW;}return mstrmojo.num.formatByMask(BC,AN);}var BG;var Al;var Ar=false;var AQ=false;var BB=false;var Ac=false;var BM=[];var Ag="";var AZ=0;var A7=false;var AX=0;var BN="";var AR="";var Ak="";var A5="";var AV=0;var BJ=0;var BI=false;var A9=A6.mstrCurrencySymbol;var A0=A6.mstrThousandSeparator;var Aw=A6.mstrDecimalPoint;var BA=A6.mstrPercentSign;var A4=A6.mstrMinusSign;AU=Ap;var Aj="";if(AN<0&&!BE){while(AU<Ad&&AW.charAt(AU)!==";"){if(AW.charAt(AU)==='"'){AU++;while(AU<Ad&&AW.charAt(AU)!=='"'){AU++;}}AU++;}AU++;if(AU>=Ad){if(AN<0){BN+="-";}AU=Ap;}}var BO=false;while(AU<Ad){var Aq=false;switch(AW.charAt(AU)){case"[":AU++;while(AU<Ad&&AW.charAt(AU)!=="]"){Ak+=AW.charAt(AU);AU++;}if(Ak.length>0&&(Ak.charAt(0)===">"||Ak.charAt(0)==="<"||Ak.charAt(0)==="=")){Ak="";}AU++;break;case'"':AU++;while(AU<Ad&&AW.charAt(AU)!=='"'){if(BO){AR+=AW.charAt(AU);}else{BN+=AW.charAt(AU);}AU++;}AU++;break;case"#":case"0":var Ab=AW.charAt(AU);BO=true;var Af=1;AU++;while(AU<Ad&&AW.charAt(AU)===Ab){Af++;AU++;}if(AU+1<Ad&&AW.charAt(AU)==="-"&&AW.charAt(AU+1)===Ab){Ac=true;BM.push(Af);AU++;while(true){Af=0;while(AU<Ad&&AW.charAt(AU)===Ab){Af++;AU++;}BM.push(Af);if(AU>=Ad||AW.charAt(AU)!=="-"){break;}AU++;}}while(AU<Ad){if(AW.charAt(AU)===","){if(AU+1<Ad&&AW.charAt(AU+1)===Ab){Ar=true;}else{break;}}else{if(AW.charAt(AU)!==Ab){break;}}AU++;}break;case".":BO=true;AU++;AZ=0;while(AU<Ad&&AW.charAt(AU)==="0"){AZ++;AU++;}if(AZ===0){while(AU<Ad&&AW.charAt(AU)==="#"){AZ++;AU++;}}break;case"E":BJ=6;while(AU<Ad&&AW.charAt(AU)!=="0"){if(AW.charAt(AU)==="+"&&AU<Ad&&AW.charAt(AU+1)==="0"){AQ=true;}else{A5+=AW.charAt(AU);}AU++;}AV=0;while(AU<Ad&&AW.charAt(AU)==="0"){AV++;AU++;}break;case"%":BJ=4;AU++;break;case"(":AU++;BN+="(";break;case")":AU++;AR+=")";break;case"-":AU++;if(AN<0){BN+=A4;}break;case"?":AU++;break;case"/":if(AU>Ap&&AW.charAt(AU-1)==="?"&&AU+1<Ad&&AW.charAt(AU+1)==="?"){BJ=5;A7=false;Al=AU-1;while(Al>Ap&&AW.charAt(Al)==="?"){Al--;}while(Al>Ap&&AW.charAt(Al)===" "){Al--;}if(Al>=Ap&&(AW.charAt(Al)==="#"||AW.charAt(Al)==="0")){A7=true;}AX=0;AU++;while(AU<Ad&&AW.charAt(AU)==="?"){AX++;AU++;}}else{AU++;}break;case",":if(AU>Ap&&(AW.charAt(AU-1)==="0"||AW.charAt(AU-1)==="#")){BB=true;AU++;}Al=AU+1;while(Al<Ad){if(AW.charAt(Al)===","){Al++;continue;}else{break;}}if(Al===Ad||AW.charAt(Al)==="."){BI=true;}if(BI||(!BI&&AU+1<Ad&&AW.charAt(AU+1)===",")){while(AU<Ad&&AW.charAt(AU)===","){AN/=1000;AU++;}AU--;}AU++;break;case";":Aq=true;break;case"$":if(BO){AR+=A9;}else{BN+=A9;}AU++;break;case"_":if(BO){AR+=" ";}else{BN+=" ";}AU++;AU++;break;default:if(BO){AR+=AW.charAt(AU);}else{BN+=AW.charAt(AU);}AU++;}if(Aq){break;}}if(AN<0){AN=-AN;if(BN.length===0){BN=A4;}}var Ay="";if(Ac){var At=0;for(BG=0;BG<BM.length;BG++){At+=BM[BG];}Ay=Aj=this.fillZeroToWidth(At,AN.toFixed());for(BG=0;BG<BM.length-1;BG++){At-=BM[BG];var As=Ay.length-At;Ay=Ay.slice(0,As)+"-"+Ay.slice(As);}}else{switch(BJ){case 0:if(BB){AN/=1000;}var A2=AN;if(A2<0){A2=-A2;}var AJ=0;while(A2>=10){A2/=10;AJ++;}if(AJ>=15){Ay=Aj=this.fillZeroToWidth((AN<0?-AN:AN),10);var Am=Ay.indexOf(".");if(Am!==-1){Ay=Ay.slice(0,Am)+Ay.slice(Am+1);}Ay=Ay.substr(0,16);if(Ay.charAt(15)>="5"){var AT=14;while(AT>=0&&Ay.charAt(AT)==="9"){Ay=Ay.slice(0,AT)+"0"+Ay.slice(AT+1);AT--;}var AO=Ay.charAt(AT);AO++;if(AT>=0){Ay=Ay.slice(0,AT)+AO+Ay.slice(AT+1);}else{Ay="1"+Ay;}}Ay=Ay.substr(0,15);var BF;for(BF=AJ-14;BF>0;BF--){Ay+="0";}if(AN<0){Ay=A4+Ay;}}else{Aj+=(AN+Math.pow(0.1,AZ+6)).toFixed(AZ);Ay=Aj;Ay=this.ReplaceDecimalPoint(Ay,Aw);if(AN<0){Ay=this.ReplaceMinusSign(Ay,A4);}}if(Ar){Ay=this.InsertThousandSeparator(Ay,A0,A6);}if(BB){Ay+=Ag;}break;case 5:if(BB){AN/=1000;}var Ai=10;for(BG=1;BG<AX;BG++){Ai*=10;}var AL={numerator:0,denominator:1};var AS={numerator:1,denominator:1};var AP={numerator:1,denominator:2};var Ax={numerator:0,denominator:1};var Ae=AN>=0;var A3=Math.abs(AN);var A1=parseInt(A3,10);A3-=A1;while(AP.denominator<Ai){if(Math.abs(AG.call(AP)-A3)<1e-15){Ax=AP;break;}if(AG.call(AP)>A3){AS=AP;}else{AL=AP;}AP.denominator=AL.denominator+AS.denominator;AP.numerator=AL.numerator+AS.numerator;}if(AP.denominator>=Ai){if(A3-AG.call(AL)<AG.call(AS)-A3){Ax=AL;}else{Ax=AS;}}if(A1>0){Ax.numerator+=A1*Ax.denominator;}if(Ax.denominator===0){A7=false;}var BD=false;var Az=false;var BL=Ax.numerator;if(A7){A1=Math.floor(Ax.numerator/Ax.denominator);BL=Ax.numerator%Ax.denominator;Az=Az||(BL!==0);if(A1>0){BD=true;Aj+=A1;if(Az){Aj+=" ";}}}if(!Az&&!BD&&BL===0){Aj+="0";}else{if(!Az&&BD&&BL===0){AI++;}else{Aj+=BL;Aj+="/";Aj+=Ax.denominator;}}Ay=Aj;if(!Ae){Ay=A4+Ay;}if(Ar){Ay=this.InsertThousandSeparator(Ay,A0,A6);}if(BB){Ay+=Ag;}break;case 4:AN*=100;Aj+=(AN+Math.pow(0.1,AZ+6)).toFixed(AZ);Ay=Aj;Ay=this.ReplaceDecimalPoint(Ay,Aw);if(AN<0){Ay=this.ReplaceMinusSign(Ay,A4);}if(Ar){Ay=this.InsertThousandSeparator(Ay,A0,A6);}Ay+=BA;break;case 6:var Av=AN;var BK=0;if(Av>1){while(Av>=10){Av/=10;BK++;}}else{if(Av!==0){while(Av<1){Av*=10;BK--;}}}Aj+=(Av+Math.pow(0.1,AZ+6)).toFixed(AZ);Aj+=A5;if(AQ&&BK>=0){Aj<<"+";}if(BK<0){Aj<<"-";BK=-BK;}Aj+=this.fillZeroToWidth(BK,AV);Ay=Aj;Ay=this.ReplaceDecimalPoint(Ay,Aw);if(AN<0){Ay=this.ReplaceMinusSign(Ay,A4);}break;}}var AM=BN+Ay+AR;var Aa=false;if(Ak.length!==0&&Aa){AM='<SPAN STYLE="COLOR: '+Ak+'" >'+AM+"</SPAN>";}return AM;}});}());(function(){mstrmojo.requiresCls("mstrmojo.Widget","mstrmojo.dom","mstrmojo.string","mstrmojo.gm._IsAnchorable","mstrmojo.ui._HasUITheme","mstrmojo.VisUtility");var E=mstrmojo.dom,D=mstrmojo.string,F=mstrmojo.VisUtility;mstrmojo.gm.DndTooltip=mstrmojo.declare(mstrmojo.Widget,[mstrmojo.gm._IsAnchorable,mstrmojo.ui._HasUITheme],{scriptClass:"mstrmojo.gm.DndTooltip",left:0,top:0,zIndex:10,boundaryNodeName:"boundary",popupNodeName:"infoNode",baseTipClass:"arrow",infoNodeOffset:0,popupNodeOffset:5,anchor:null,boundary:null,utils:mstrmojo.VisChartUtils,themeClassName:"mojo-theme-light",markupString:'<div id="{@id}" class="mstrmojo-Tooltip {@cssClass}" style="top:{@top}px;left:{@left}px;z-index:{@zIndex};position:absolute;{@cssText};"><div class="mstrmojo-Tooltip-shadow {@shadowNodeCssClass}"></div><div class="mstrmojo-Tooltip-content {@contentNodeCssClass}" style="{@contentNodeCssText}"><div class="content"></div><div class="arrow"><div class="after"></div><div class="before"></div></div></div></div>',markupSlots:{infoNode:function(){return this.domNode.childNodes[1];},contentNode:function(){return this.domNode.childNodes[1].firstChild;},tipNode:function(){return this.domNode.childNodes[1].lastChild;}},toggle:function A(H){if(H){this.domNode.style.display="block";}else{this.domNode.style.display="none";}},updateContent:function(H,J,I){this.set("themeClassName",mstrApp.getThemeClassName());this.fillContent(H,J,I);this.positionDialog();},fillContent:function C(J,N,L){this.anchor=J;this.anchorPosition=N;this.contentNode.innerText=L||this.anchor.innerText||this.anchor.textContent,true;this.toggle(true);var H=F.getComputedFontStyle(this.contentNode),M=this.contentNode.innerText,I=F.measureTextWidth(M,H),K=130;if(I<=K){this.contentNode.style.width=I+"px";}else{this.contentNode.innerText=F.truncateTextToLineWithWordWrap(M,H,K,3);this.contentNode.style.width=K+"px";}},getTipDimension:function B(){var I=this[this.tipNodeName],H=E.position(I.firstChild);return H;},applyPopupNodePos:function G(J,I,L,H){var N=this[this.tipNodeName],K=N.style,O=this[this.popupNodeName],M=O.style;M.top=J+"px";M.left=I+"px";K.top=(L-J)+"px";K.left=(H-I)+"px";}});}());(function(){mstrmojo.requiresCls("mstrmojo.hash","mstrmojo.array","mstrmojo.Container","mstrmojo.util.color","mstrmojo.VisUtility");var S=mstrmojo.util.color,N=mstrmojo.hash,K=mstrmojo.array;var H={BASE_FILL_COLOR_DARK:"#20516b",BASE_FILL_COLOR_LIGHT:"#bce8ff",BORDER_COLOR:"#34abeb",FONT_COLOR_DARK:"#34abeb",FONT_COLOR_LIGHT:"#007ebe"};var J={DARKA:{BASE_FILL_COLOR:H.BASE_FILL_COLOR_DARK,HOVER_FILL_OPACITY:0.4,SELECTED_FILL_OPACITY:0.4,HOVER_SELECTED_FILL_OPACITY:0.65,BORDER_COLOR:H.BORDER_COLOR,FONT_COLOR:H.FONT_COLOR_DARK},DARKB:{BASE_FILL_COLOR:H.BASE_FILL_COLOR_DARK,HOVER_FILL_OPACITY:0.4,SELECTED_FILL_OPACITY:0,HOVER_SELECTED_FILL_OPACITY:0.65,BORDER_COLOR:H.BORDER_COLOR,FONT_COLOR:H.FONT_COLOR_DARK},DARKC:{BASE_FILL_COLOR:H.BASE_FILL_COLOR_DARK,HOVER_FILL_OPACITY:0.4,SELECTED_FILL_OPACITY:0.6,HOVER_SELECTED_FILL_OPACITY:0.65,BORDER_COLOR:H.BORDER_COLOR,FONT_COLOR:H.FONT_COLOR_DARK},LIGHTA:{BASE_FILL_COLOR:H.BASE_FILL_COLOR_LIGHT,HOVER_FILL_OPACITY:0.4,SELECTED_FILL_OPACITY:0.4,HOVER_SELECTED_FILL_OPACITY:0.65,BORDER_COLOR:H.BORDER_COLOR,FONT_COLOR:H.FONT_COLOR_LIGHT},LIGHTB:{BASE_FILL_COLOR:H.BASE_FILL_COLOR_LIGHT,HOVER_FILL_OPACITY:0.4,SELECTED_FILL_OPACITY:0,HOVER_SELECTED_FILL_OPACITY:0.65,BORDER_COLOR:H.BORDER_COLOR,FONT_COLOR:H.FONT_COLOR_LIGHT},LIGHTC:{BASE_FILL_COLOR:H.BASE_FILL_COLOR_LIGHT,HOVER_FILL_OPACITY:0.4,SELECTED_FILL_OPACITY:0.6,HOVER_SELECTED_FILL_OPACITY:0.65,BORDER_COLOR:H.BORDER_COLOR,FONT_COLOR:H.FONT_COLOR_LIGHT}};var P=false,D=false;function C(X,W){return{x:X.x+W,y:X.y+W,w:Math.max(X.w-2*W,0),h:Math.max(X.h-2*W,0)};}function O(W,Z,b,X){if(X==0){return ;}var a=X/2,Y={x:Z.x+a,y:Z.y+a,w:Math.max(Z.w-X,0),h:Math.max(Z.h-X,0)};W.save();W.strokeStyle=b;W.lineWidth=X;W.strokeRect(Y.x,Y.y,Y.w,Y.h);W.restore();}function Q(W){return"_"+W;}function F(Y,X,Z){if(!Y){return ;}var a=Y.style;if(a[X]===Z){return ;}var W=Q(X);if(Y[W]===undefined){Y[W]=getComputedStyle(Y)[X];a[X]=Z;}}function I(Z,Y){if(!Z){return ;}var W=Q(Y),X=Z[W];if(X!==undefined){Z.style[Y]=X;Z[W]=undefined;}}function V(W,Y){var X=C(Y,this.outerBorderWidth);E.call(this);O(W,Y,this.outerBorderColor,this.outerBorderWidth);O(W,X,this.innerBorderColor,this.innerBorderWidth);M.call(this);}function E(){if(P&&D){if(this.themeType==="dark"){this.outerBorderColor=this.innerBorderColor="#ffffff";}else{this.outerBorderColor=this.innerBorderColor="#000000";}this.innerBorderWidth=0;}else{if(P&&!D){this.outerBorderWidth=0;this.innerBorderColor="#ffffff";}else{if(this.themeType==="dark"){this.outerBorderColor="#ffffff";this.innerBorderColor="#000000";}else{this.outerBorderColor="#000000";this.innerBorderColor="#ffffff";}}}}function M(){if(this.themeType==="dark"){this.outerBorderColor="#ffffff";this.innerBorderColor="#000000";}else{this.outerBorderColor="#000000";this.innerBorderColor="#ffffff";}this.outerBorderWidth=2;this.innerBorderWidth=1;}function U(W,Y){var X=C(Y,this.outerBorderWidth);W.save();W.fillStyle=S.getCSSColorString(this.backgroundColor,0.3);W.fillRect(X.x,X.y,X.w,X.h);W.restore();}function G(W,a,Y,Z,b){F(Y,"color",Z.FONT_COLOR);var X=C(a,1);W.save();if(b){W.fillStyle=S.getCSSColorString(Z.BASE_FILL_COLOR,Z.HOVER_SELECTED_FILL_OPACITY);}else{W.fillStyle=S.getCSSColorString(Z.BASE_FILL_COLOR,Z.SELECTED_FILL_OPACITY);}W.fillRect(X.x,X.y,X.w,X.h);W.restore();O(W,a,Z.BORDER_COLOR,1);}function L(Y,W,X){if(W&&!Y){X.selected();}else{if(!W&&Y){X.hover();}else{if(W&&Y){X.hoverSelected();}}}}function A(W,X){return{hover:function(){U.call(this,W,X);}.bind(this),selected:function(){V.call(this,W,X);}.bind(this),hoverSelected:function(){V.call(this,W,X);U.call(this,W,C(X,1));}.bind(this)};}function B(c,Z,Y){var a=Y.isEntityContainer,e=Z.labelDomNode,W=Y.isSelected,b=Y.isHovered,g=this.canvas.getContext("2d"),f=this.themeType==="dark"?J.DARKA:J.LIGHTA;P=Y.contextMenuSelected;D=Y.isPreviousSelected;if(this.themeType!=="dark"){if(P&&D){f=J.LIGHTC;}else{if(!P&&D){f=J.LIGHTA;}else{if(P&&!D){f=J.LIGHTB;}}}}else{if(P&&D){f=J.DARKC;}else{if(!P&&D){f=J.DARKA;}else{if(P&&!D){f=J.DARKB;}}}}var X,d=this.parent;if(a){X={hover:function(){I(e,"color");var h=C(c,1);g.save();g.fillStyle=S.getCSSColorString(f.BASE_FILL_COLOR,f.HOVER_FILL_OPACITY);g.fillRect(h.x,h.y,h.w,h.h);g.restore();},selected:function(){G(g,c,e,f,false);},hoverSelected:function(){G(g,c,e,f,true);}};}else{X=A.call(this,g,c);}F(e&&e.parentNode,"zIndex",3);g.clearRect(c.x,c.y,c.w,c.h);L(b,W,X);}function R(d,Z,Y){var a=Y.isEntityContainer,e=Z.labelDomNode,W=Y.isSelected,b=Y.isHovered,f=this.canvas.getContext("2d");P=Y.contextMenuSelected;D=Y.isPreviousSelected;var c=this,X;if(a){X={hover:function(){},selected:function(){},hoverSelected:function(){}};}else{f.clearRect(d.x,d.y,d.w,d.h);X=A.call(this,f,d);}F(e&&e.parentNode,"zIndex",3);L(b,W,X);}mstrmojo.heatmap.vi.VisHeatMapHighlightCanvas=mstrmojo.declare(mstrmojo.Container,null,{scriptClass:"mstrmojo.heatmap.vi.VisHeatMapHighlightCanvas",markupString:'<div id={@id}-HeatMapHighlightCanvas style="z-index: 2; position: absolute; left: {@left}px; top: {@top}px; width: {@width}px; height: {@height}px;"><canvas width={@width} height={@height}></canvas></div>',markupSlots:{canvas:function(){return this.domNode.firstChild;}},backgroundColor:"#ffffff",init:function(W){this.isOnSelectionMode=mstrmojo.emptyFn;this.alpha=0.4;this.themeType="dark";if(this._super){this._super(W);}if(this.themeType==="dark"){this.outerBorderColor="#ffffff";this.innerBorderColor="#000000";}else{this.outerBorderColor="#000000";this.innerBorderColor="#ffffff";}this.outerBorderWidth=2;this.innerBorderWidth=1;this.maskColor="#ffffff";},preBuildRendering:function(){var W=this.placeholder;this.width=parseInt(W.style.width);this.height=parseInt(W.style.height);if(this._super){this._super();}},hide:function(){this.domNode.style.display="none";},show:function(){this.domNode.style.display="block";},clear:function(X){this.show();if(!X){X={x:0,y:0,w:this.width,h:this.height};}var W=this.canvas.getContext("2d");W.save();W.clearRect(X.x,X.y,X.w,X.h);if(this.isOnSelectionMode()){W.fillStyle=S.getCSSColorString(this.maskColor,this.alpha);W.fillRect(X.x,X.y,X.w,X.h);}W.restore();},resetCanvasRect:function(W){this.width=W.w;this.height=W.h;this.domNode.style.width=W.w+"px";this.domNode.style.height=W.h+"px";this.canvas.width=W.w;this.canvas.height=W.h;},highlight:function(a,Y,X){X=N.copy(X,{isHovered:false,isSelected:false,isEntityContainer:false,isHeaderOnTop:false});var c=X.isHeaderOnTop,W=X.isSelected,Z=X.isHovered,d=this.isOnSelectionMode(),b=Y.labelDomNode,e=this.canvas.getContext("2d");this.show();if(!Z&&!W){I(b&&b.parentNode,"zIndex");I(b,"textDecoration");I(b,"color");e.clearRect(a.x,a.y,a.w,a.h);if(d){this.clear(a);}else{this.clear();}return ;}if(c){B.call(this,a,Y,X);}else{R.call(this,a,Y,X);}}});}());(function(){mstrmojo.requiresCls("mstrmojo.gm.GMEnums","mstrmojo.hash","mstrmojo.DocDataService","mstrmojo.VisEnum.GMLegendFormatingPropertyTag","mstrmojo.VisUtility");var N=mstrmojo.gm.EnumTRFManipulations;var J=mstrmojo.array,C=mstrmojo.hash,M=mstrmojo.func.wrapMethods,G=mstrmojo.func.composite,I=mstrmojo.VisEnum.GMLegendFormatingPropertyTag;var D={silent:false,undo:mstrmojo.emptyFn,redo:mstrmojo.emptyFn};function K(O){return O.model.controller.cmdMgr;}function L(){return(this.getDocModel&&this.getDocModel())||this.model.docModel;}function H(){return{success:function O(){this.raiseEvent({name:"regenerateToolbar"});}.bind(this)};}function E(P,R){var O,V,Q,S,U={};U.tks=this.k;U.selectorObjects=P;U.keepOnly=!!R;U.isDocVis=true;O=L.call(this);V=O.getDataService();Q=V.getGMViewFilterAction(U);S=O.getSliceCallback(U);return{action:Q,callbacks:S};}function B(Q,P){var O,S,R;O=L.call(this);R=O.getDataService();if(!this.isXMLDirty()){R.submitUpdates(Q,P);}else{S=this.getPersistAction();R.submitUpdates([Q,S],P);this.resetXMLDirtyFlag();}}function A(){var c=this.modelData||this.model.data,S=c.k,a,Z="FormattingWidget",V,U,Y,P,Q,R=[],X=[],W=this.edtModel;if(!c){console.log("warning: modelData is missing");return null;}var b=function(e,g){var d=U.createElement(g),f;if(e instanceof Object){for(f in e){if(e.hasOwnProperty(f)){var h=b(e[f],f);if(h){d.appendChild(h);}}}}else{d.setAttribute("value",e);}return d;};var O=function(d){return d.replace(/&/g,"&amp;").replace(/</g,"&lt;").replace(/"/g,"&quot;");};Y=this.createWidgetPropsXML?this.createWidgetPropsXML():null;if(!Y||Y.length===0){V=this.getProperties(S);if(this.useCompatibleXML){U=(new DOMParser()).parseFromString("<widgetProps></widgetProps>","text/xml");U.firstChild.appendChild(b(V,"fmt"));}else{U=(new DOMParser()).parseFromString("<props><widgetProps></widgetProps></props>","text/xml");U.firstChild.firstChild.appendChild(b(V,"fmt"));}Y=(new XMLSerializer()).serializeToString(U);}P=O(Y);Q={act:"setProperty",nodeKey:S,prs:Z,pri:4,v:P};R.push(Q);return R;}function F(P,Q,O,U){if(!(U instanceof Function)){return D;}var S=this.id;function R(V){return function(){var X=mstrmojo.all[S],W;if(!X){return ;}W=X.getProperties();W[P]=V;U.call(X,V,true);X.getDocModel().selectVIUnit(X.parent.id,true);};}return{silent:true,undo:R(O),redo:R(Q)};}mstrmojo._VizSelectionHelper=mstrmojo.provide("mstrmojo._VizSelectionHelper",{postBuilderingCalled:false,listenToUpdateColorMap:function(R){if(mstrmojo.VisUtility.isOnExpressMode()){return ;}var Q=this,P,O=(Q.getDocModel&&Q.getDocModel())||Q.model.docModel;if(O){return O.attachEventListener("colorMapChanged",Q.id,function(U){P=Q.parent&&Q.parent.parent;if(Q.forceUpdateColorMap||(P&&P.isPanelDisplaying())){R.call(Q);}else{var S=P.attachEventListener("panelDisplaying",Q.id,function(V){if(Q.postBuilderingCalled){R.call(Q);}P.detachEventListener(S);});}});}},detachUpdateColorMapListener:function(P){if(!P){return ;}var O=(this.getDocModel&&this.getDocModel())||this.model.docModel;O.detachEventListener(P);},updateTargets:function(P){var S={},Q=this,O=L.call(this);S.fromGM=true;S.type=1;S.src=this.k;S.selectorObjects=P;function R(W){var U=Q.modelData||Q.model.data,V=U.sc;if(V!==undefined){return V[W];}return undefined;}S.keepOnly=true;S.ck=R.call(this,"ck");S.keyContext=S.ck;S.tks=R.call(this,"tks");S.ckey=R.call(this,"ckey");S.isDocVis=true;S.include=true;S.showall=R.call(this,"showall");O.slice(S);},updateAfterViewFilter:function(Q,O){var W,V,P,U,S,X,R;W=L.call(this);V=W.getDataService();U=E.call(this,Q,O);P=U.action;S=U.callbacks;R=this.model.controller||W.controller;if(this.currKeepOnlyAction){X=[C.clone(this.currKeepOnlyAction)];}else{X=E.call(this,[],false).action;}this.currKeepOnlyAction=P;R.submitUndoRedoUpdates([P],X,S);},updateAfterKeepOnly:function(Q){var P=L.call(this),O=this.model.controller||P.controller,R=M(O._getXtabCallback(this),H.call(this));O.applyKeepOnly(this,R,{keepOnly:Q,data:this.getContextMenuSelections()},Q?-2:undefined);},updateAfterKeepOnlyForMultiTemplate:function(Q){var P=L.call(this),O=this.model.controller||P.controller,R=M(O._getXtabCallback(this),H.call(this));O.applyKeepOnlyForMutilTemplate(Q,R,true);},updateAfterDrill:function(O,d,Z){var a=this,e=L.call(this),c=e.getDataService(),U=c.newUpdate(),R=this.getContextMenuSelections(),P=Z||this,S=P.model,V=P.model.data||P.node.data,Y=S.getSelectorDataFromTemplateLimit(V.tpl).concat({keepOnly:true,data:R}),Q=e.getKeepOnlyOrExcludeAction(V.k,Y),W=a.model.controller||e.controller,X=W._getXtabCallback(a);U.add(O,M(d,X));U.add(Q,H.call(a));K(a).execute({execute:function b(){this.submitUpdate(U);},urInfo:{callback:U.callback}});},updateAfterSort:function(R){var P=this,O=L.call(this),S=O.getDataService(),U=O.getSliceCallback({tks:P.k});K(P).execute({execute:function Q(){var W=S.newUpdate(this,undefined),V={act:"sortGM",nodeKey:P.k,subActions:R,partialUpdate:{nodes:[P.k]}};W.add(V,U,undefined);if(P.isXMLDirty()){W.addActions(P.getPersistAction());}this.submitUpdate(W,undefined);},urInfo:{callback:U}});},updateAfterAction:function(U,O,P,b,Y){if(!U){return ;}var W=this,Q=W.parent&&W.parent.id,c=W.model.docModel,V=W.model.controller||c.controller,a,Z,S={},X,R=Y||D;if(P){a=mstrmojo.emptyFn;X=function(){this.submitSilent(U);};}else{a=c.getSliceCallback({tks:this.k});a.success=G([a.success,function(){c.selectVIUnit(Q,true);}]);X=function(){this.submit(U,a,S);};}Z=V._getXtabCallback(W);if(O){a=M(a,O);Z=M(Z,O);}Z.success=G([Z.success,function(){c.selectVIUnit(Q,true);}]);if(P){C.copy(mstrmojo.DocDataService.SUPPRESS_DATA,S);}if(b){C.copy(mstrmojo.DocDataService.REQUEST_DEFN_DATA,S);}K(this).execute({execute:X,urInfo:{silent:R.silent,callback:Z,redo:R.redo,undo:R.undo}});},getProperties:mstrmojo.emptyFn,getSetPropertiesAction:A,updateAfterPropertiesChange:function(P,Q,O,R){this.updateAfterAction(A.call(this),P,Q,O,R);},setProperty:function(W,R,U){var P=U.callback,Q=!!U.suppressData,Y=U.requestDefinition,S=U.clientUndoRedoCallback,X=this.getProperties(),O=X[W],V;if(W===I.COLOR_SQUARE_COLOR){if(this.colorSqureIdentity){this.updateColorMap(this.colorSqureIdentity.comb,R);}}else{if(X&&(X[W]===undefined||X[W].toString()!==R.toString())){X[W]=R;V=F.call(this,W,R,O,S);this.updateAfterPropertiesChange(P,Q,Y,V);}}},showData:function(O){if(!this.gridData){this.gridData=this.model.data;}mstrmojo.vi.ui.ViewDataDialog.open(this.parent,true);}});}());(function(){mstrmojo.requiresCls("mstrmojo.func","mstrmojo.array","mstrmojo.hash","mstrmojo.Container","mstrmojo._HasLayout","mstrmojo._Formattable","mstrmojo._IsDocumentTemplate","mstrmojo.Label","mstrmojo.VisUtility","mstrmojo.ui.menus.MenuConfig","mstrmojo.vi._MonitorsAppState","mstrmojo.vi.ui.rw._SupportViewFilterInVizBox","mstrmojo.util.FontLoader");mstrmojo.requiresClsP("mstrmojo.vi.viz","EnumVisualizationTemplates","EnumVizStyles","EnumWidgetTypes");var R={top:"top",left:"left","z-index":"zIndex",width:"width",height:"height"};var L=["background-color","fx"],H={width:"width",height:"height"},Y=mstrmojo.array,K=mstrmojo.hash;mstrmojo.VisBase=mstrmojo.declare(mstrmojo.Container,[mstrmojo._HasLayout,mstrmojo._Formattable,mstrmojo._IsDocumentTemplate,mstrmojo.vi.ui.rw._SupportViewFilterInVizBox,mstrmojo.vi._MonitorsAppState],{scriptClass:"mstrmojo.VisBase",updated:false,waitingForData:false,node:null,excludeData:false,skipReRender:false,updateFormatsOnUpdate:true,bgFormats:{},init:function d(l){this.excludeData=!!(mstrConfig.resolveOnly||mstrApp.isAppStatePause&&mstrApp.isAppStatePause());if(this._super){this._super(l);}},setModel:function g(l){this.set("model",l);},destroy:function c(){var l=this.model;if(l&&l.destroy){l.destroy();delete this.model;}this._super();},resize:function N(){var l=this.getFormats();if(parseInt(l.height,10)===0||parseInt(l.width,10)===0){this.domNode.style.display="none";}else{this.setDimensions(l.height,l.width);this.domNode.style.display="";}},setDimensions:function b(n,m){var l=this._super(n,m);if(l&&this.hasRendered&&!this.skipReRender){this.reRender();}return l;},reRender:function J(){this.unrender();this.render();},getWidth:function h(){return parseInt(this.width,10);},getHeight:function X(){return parseInt(this.height,10);},getLeft:function V(){return parseInt(this.left,10);},getTop:function B(){return parseInt(this.top,10);},getFonts:mstrmojo.emptyFn(),loadFonts:function E(l,m){if(mstrmojo.util.FontLoader.load(l,m)){m.success();}},preBuildRendering:function A(){if(this.requirePreload){var l=function l(){this.requirePreload=false;this.render();};if(mstrmojo.util.FontLoader.load(this.getFonts(),{success:l.bind(this),failure:l.bind(this)})){return this._super();}else{return false;}}return this._super();},buildRendering:function D(){this.height=this.getHeight();this.width=this.getWidth();this.left=this.getLeft();this.top=this.getTop();if(!this.updated){this.update();}this._super();},initFromVisProps:function a(){},postBuildRendering:function(){var l=this.isEmpty();this._super();this.raiseEvent({name:"toggleCtrlOverlay",visible:l||this.excludeData,controls:this.getVisEmptyMsgControls()});this.applyBackground();return !l;},applyBackground:function W(){var m=this.bgFormats,o,l,p,n;if(mstrApp.isExpress&&!K.isEmpty(m)){o=this.formatHandlers=this.formatHandlers||{};p=o.domNode=o.domNode||[];l="BG";n=Y.indexOf(p,l);if(n<0){p.push(l);}this.applyCSSFormatToNode("domNode",m);}},parseBgFormats:function G(){var l=this.id;return{success:function(r){var o,t,q,m,s,n,p=mstrmojo.all[l],u=p&&p.getDocModel();if(r.defn&&r.defn.layouts&&p&&u){t=r.defn.layouts;o=Y.find(t,"k",u.getCurrentLayoutKey());q=t[o];m=q&&q.units&&q.units[p.k];s=m&&m.fmts;if(s){n=p.bgFormats={};Y.forEach(L,function(w){if(s[w]){n[w]=s[w];}});}}}};},onAppStateChange:function(l){var m=mstrApp.isAppStatePause&&mstrApp.isAppStatePause(),n=l.valueWas&mstrmojo.vi.VisualInsightApp.APP_STATES.PAUSE;this.excludeData=!!(mstrConfig.resolveOnly||m);if(this._super){this._super(l);}if(m&&!n||(!m&&n&&!mstrApp.enableUpdate)){this.raiseEvent({name:"toggleCtrlOverlay",visible:this.excludeData||this.isEmpty(),controls:this.getVisEmptyMsgControls()});}},refresh:function i(l){if(this.excludeData){this.raiseEvent({name:"toggleCtrlOverlay",visible:true,controls:this.getVisEmptyMsgControls()});return ;}this._super(l);},update:function Z(o){o=o||this.node;if(o){var l=o.data;if(l){this.model.set("data",l);}this.waitingForData=!!l.nsj;if(this.waitingForData){var m="ServerJsonRWDStyle";var p=this.model,n=p.getDataService(),q={host:this,nodes:[this.k]},s;if(l.wid!==undefined){q.slices=[l.wid];}s=mstrmojo.func.wrapMethods(this.parseBgFormats(),p.docModel.getUpdateColorMapCallback(),p.docModel.getUpdateThemePaletteCallback(true),p.controller._getXtabCallback(this,false));n.retrieveServerJson(q,s,{preserveUndo:true,style:{name:m,params:{treesToRender:3}},params:{styleName:m}});this.updated=true;return false;}this.updateContentFormats(o);}if(this.model){var t=this.model&&this.model.docModel;this.initFromVisProps(this.model.vp);if(t&&t.getDocBuilder){var r=t.getDocBuilder().getMojoVisName(o);if(r){o.data.visName=r;}}}this.updated=true;if(this._super){return this._super(o);}return true;},updateContentFormats:function M(p){var n,q,m,o=p.defn,l=this.builder;if(this.updateFormatsOnUpdate&&o){if(l&&l.isPortlet&&l.isPortlet(o)){q=H;}else{q=R;}m=o.fmts||o.units[this.model.k].fmts;for(n in q){if(q.hasOwnProperty(n)&&m.hasOwnProperty(n)){this[q[n]]=m[n];}}}},isEmpty:function O(){return false;},getVisEmptyMsgControls:function I(){return[{scriptClass:"mstrmojo.Label",cssClass:"dropMsg",text:mstrmojo.desc(11668,"Drag objects here.")}];},getModel:function j(){return this.model;},getData:function Q(){return this.model.data;},getRowsAndCols:function(){var l=this.model.data.gts;return(l.row||[]).concat(l.col||[]);},getExp:function(){var l=this.model.data,m=l&&l.sc&&l.sc.exp;return m;},getDocModel:function e(){return this.model&&this.model.docModel;},getTitleRMCPopup:mstrmojo.emptyFn,getMenuHandler:function U(){return mstrmojo.emptyFn;},renderErrorMessage:function k(l){this.domNode.innerHTML='<div class="mstrmojo-message">'+l+"</div>";},getMessageID:function S(){return this.model.docModel.mid||this.model.mid;},performAction:function f(l){var m=this.model,p=this.scriptClass==="mstrmojo.heatmap.vi.VisHeatMap",o=p?m.getHMAction(l):m.getAction(l),n=o&&o.h;if(n&&this.controller[n]){this.controller[n](this,o.a);return true;}return false;},deleteSelectorControl:function P(){var l=this.getData(),m=l.sc;if(m&&parseInt(m.ct,10)===6){delete l.sc;}},findSelectorControl:function F(){var m=this.getData(),l=m&&m.sc;if(l&&parseInt(l.ct,10)===6){this.selectorControl=l;this.isMultiSelect=true;}else{delete this.selectorControl;}return this.selectorControl;},displayVizBoxVisFilterIndicator:function C(l,m){if(l&&m&&m.displayVisFilterIndicator){m.displayVisFilterIndicator();}}});})();(function(){mstrmojo.requiresCls("mstrmojo.hash","mstrmojo.VisUtility","mstrmojo.vi.enums.EnumThemeProperties","mstrmojo.models.FormatModel","mstrmojo.chart.enums.EnumFontStyle");var B=mstrmojo.VisUtility,F=mstrmojo.hash,D=mstrmojo.models.FormatModel,C=D.ENUM_PROPERTY_NAMES,G=mstrmojo.chart.enums.EnumFontStyle,A=mstrmojo.vi.enums.EnumThemeProperties;mstrmojo.heatmap.vi.VisHeatmapUtility=mstrmojo.provide("mstrmojo.heatmap.vi.VisHeatmapUtility",{fontStyleValueMap:{bold:G.FS_BOLD,italic:G.FS_ITALIC,underline:G.FS_UNDERLINE,strikeout:G.FS_STRIKETHROUGH},setStepperEnabled:function(H,L,J){var K=["min","max"],I=["gt","lt"];K.forEach(function(O,M){var N=L.every(function(Q){var P=I[M],R=B.getPropertyByPath(J,[Q,O].join("."),P);return R===P;});H.getControl(M+1).set("enabled",N);});},getStepper:function(K,H){var J=new mstrmojo.Button(mstrmojo.Button.newIconButton(mstrmojo.desc(13608,"Decrease Font Size"),"single-operator minus",function(){K(-1);},undefined,{slot:"col1Node"})),I=new mstrmojo.Button(mstrmojo.Button.newIconButton(mstrmojo.desc(13607,"Increase Font Size"),"single-operator plus",function(){K(1);},undefined,{slot:"col2Node"}));H=F.copy(H,{col1Width:"50%",col2Width:"50%",dividerWidth:"10px",children:[J,I]});return new mstrmojo.ui.editors.controls.TwoColumnContainer(H);},isInvalidTemplate:function E(I){var H=I&&I.gts,J=H&&H.row;return(!(J&&J.length>0)||!B.hasOnlyMetricsOnColumn(I)||!B.hasNoMetricOnRow(I));},getInvalidTemplateErrMsg:function(H){return H||mstrmojo.desc(13685,"The Heat Map requires at least one attribute on the row axis to render properly; it is recommended that two metrics be placed on the column axis as well");},isSpatial:function(){return mstrApp.getThemeProps&&mstrApp.getThemeProps(A.SUBTYPE.HEATMAP).smallGap===A.DEFAULT_THEME_PROPS.HEATMAP.smallGap||false;},convertFontStyle:function(I,H){if((I&G.FS_BOLD)>0){H[C.FONT_WEIGHT]="bold";}if((I&G.FS_ITALIC)>0){H[C.FONT_STYLE]="italic";}if((I&G.FS_UNDERLINE)>0){H[C.UNDERLINE]="underline";}if((I&G.FS_STRIKETHROUGH)>0){H[C.LINE_THROUGH]="line-through";}},processFontStyle:function(H,I){H.fontWeight=(I&G.FS_BOLD?"bold":"normal");H.fontStyle=(I&G.FS_ITALIC?"italic":"normal");if((I&G.FS_STRIKETHROUGH)&&(I&G.FS_UNDERLINE)){H.textDecoration="line-through underline";}else{if(I&G.FS_STRIKETHROUGH){H.textDecoration="line-through";}else{if(I&G.FS_UNDERLINE){H.textDecoration="underline";}else{H.textDecoration="none";}}}},getFontStyleItems:function(){return[{n:mstrmojo.desc(2718,"Bold"),id:"b",css:"bold"},{n:mstrmojo.desc(2719,"Italic"),id:"i",css:"italic"},{n:mstrmojo.desc(2720,"Underline"),id:"u",css:"underline"},{n:mstrmojo.desc(3062,"Strikeout"),id:"s",css:"strikeout"}];},updateFontStyle:function(J,H){var I=[],K=function(N,O,L){var M=H[N];if(M){I.push(L);}};K(C.FONT_WEIGHT,"bold",0);K(C.FONT_STYLE,"italic",1);K(C.UNDERLINE,"underline",2);K(C.LINE_THROUGH,"line-through",3);J.select(I);},});}());(function(){mstrmojo.requiresCls("mstrmojo.Box","mstrmojo.dom","mstrmojo.css","mstrmojo.string","mstrmojo.VisUtility");var M=mstrmojo.css,I=mstrmojo.VisUtility,L=mstrmojo.array,N=mstrmojo.string,F="vis-tooltip",E=20,C=165,D="px";function Q(){var U=this.domNode;U.innerHTML="";var R=document.createElement("div");R.className=F+"-container";var V=document.createElement("table");V.className=F+"-table";for(var S=0;S<2;S++){V.appendChild(document.createElement("COL"));}R.appendChild(V);this.domNode.appendChild(R);return V;}function K(S){var R=[],U=false;L.forEach(S,function(V){if(!V.isSuper){R.push(V.v);}else{U=true;R.push("<sup>"+V.v+"</sup>");}});return{hasSuper:U,htmlText:R.join("")};}mstrmojo.VisTooltip=mstrmojo.declare(mstrmojo.Box,null,{scriptClass:"mstrmojo.VisTooltip",init:function P(R){this._super(R);M.addWidgetCssClass(this,(R&&R.widgetClass)?[R.widgetClass,F]:F);},toggle:function H(R){var S=mstrApp.isAppStatePrintPreview&&mstrApp.isAppStatePrintPreview();if(this.domNode){this.domNode.style.display=R&&!S?"block":"none";}},displayInfo:function O(X,a,R,S){var V=this.domNode,c=Q.call(this),Y=false,U=0,Z=0,b=c.childNodes[0],W=c.childNodes[1];X.forEach(function(k){var s,i,u,o,d,h,q,m,w,l,t,r,n=false,j=false;var e=c.insertRow(-1),g=e.insertCell(-1),p=e.insertCell(-1);e.className=F+"-tr";g.className=F+"-name "+F+"-td";p.className=F+"-value "+F+"-td";if(k===null){M.addClass(e,"separator");Y=true;}else{if(Y){M.addClass(e,"below-separator");}s=k.n;r=!k.skipEncode;g.innerHTML=r?N.encodeHtmlString(s,true):s;u=I.getComputedFontStyle(g);if(S){o=Math.ceil(I.measureTextWidthWithSpan(g.innerHTML,u,u.bonus,null,true,true));}else{o=Math.ceil(I.measureTextWidth(g.innerHTML,u,u.bonus));}q=3;if(o>C){m=I.truncateTextToLineWithWordWrap(s,u,C,q,true);if(m.canWordWrap){g.innerHTML=r?N.encodeHtmlString(m.text,true):m.text;}else{m=I.truncateTextToLineWithWordWrap(s,u,C,1);g.innerHTML=r?N.encodeHtmlString(m,true):m;}n=true;}U=Math.min(Math.max(U,o),C);i=k.v;l=k.isTrendLineFuncToken;if(l){w=K(i);}if(!l||!w.hasSuper){if(l){i=w.htmlText;}p.innerHTML=r?N.encodeHtmlString(i,true):i;d=I.getComputedFontStyle(p);if(S){h=Math.ceil(I.measureTextWidthWithSpan(p.innerHTML,u,u.bonus,null,true,true));}else{h=Math.ceil(I.measureTextWidth(p.innerHTML,d,d.bonus,null,true));}if(h>C){m=I.truncateTextToLineWithWordWrap(i,d,C,k.noTruncate?100:q,true);if(!m.canWordWrap){m=I.truncateTextToLineWithWordWrap(i,d,C,1,true);}p.innerHTML=r?N.encodeHtmlString(m.text,true):m.text;h=m.maxLineLen;j=true;}Z=Math.min(Math.max(Z,h),C);}else{p.innerHTML=w.htmlText;d=I.getComputedFontStyle(p);h=0;L.forEach(i,function(x){x.textWidth=I.measureSuperTextWidth(x.isSuper,x.v,d,d.bonus);h+=x.textWidth;});h=Math.ceil(h);if(h>C){m=I.truncateTextToLineWithWordWrapForTokens(i,d,C,k.noTruncate?100:q,true,true);if(!m.canWordWrap){m=I.truncateTextToLineWithWordWrapForTokens(i,d,C,1,true);}p.innerHTML=K(m.text).htmlText;h=m.maxLineLen;j=true;}Z=Math.min(Math.max(Z,h),C);}var f=parseInt(M.getComputedStyle(g).paddingRight);b.style.width=(U+f+1)+"px";W.style.width=(Z+1)+"px";t=U+Z+f;c.style.width=(t+2)+"px";Y=false;if(n||j){M.addClass(e,"wrapped");}}});if(a){this.moveTo(a.x,a.y);}},moveTo:function(a,Z){var Y=mstrmojo.dom.position(document.body),W=this.domNode,b=W.offsetWidth,X=W.offsetHeight,V=Y.x+Y.w,c=Y.y+Y.h,S=a+E,R=Z+E;if(S>V-b||R>c-X){if(S<=V-b){R=c-X;}else{if(R<=c-X){S=V-b;}else{S=V-b;R=Z-E-X;}}}var U=W.style;U.left=S+D;U.top=R+D;},doLayout:function A(R){var U=this.domNode.getElementsByTagName("table")[0];if(!U){return ;}var V=M.getComputedStyle(this.domNode),S=R-parseInt(V.paddingLeft,10)-parseInt(V.paddingRight,10);S-=U.rows[0].cells[0].offsetWidth;U.getElementsByClassName(F+"-value").forEach(function(W){W.style.maxWidth=S+D;});},posTo:function B(S){var R=this.domNode.style;R.left=S.x+D;R.top=S.y+D;},renderErrMsg:function G(R){Q.call(this).insertRow(-1).insertCell(-1).innerText=R;},hide:function J(){var R=this.domNode;this.toggle(false);if(R&&R.parentNode){R.parentNode.removeChild(R);R.innerHTML="";}}});}());(function(){mstrmojo.requiresCls("mstrmojo.gm.GMEnums","mstrmojo.hash","mstrmojo.DocDataService","mstrmojo.VisEnum.GMLegendFormatingPropertyTag","mstrmojo.VisUtility");var E=mstrmojo.array,D=mstrmojo.hash,A=mstrmojo.func.wrapMethods;function B(F){return F.model.controller.cmdMgr;}mstrmojo._colorPalette=mstrmojo.provide("mstrmojo._colorPalette",{listenToUpdateColorMap:function(I){if(mstrmojo.VisUtility.isOnExpressMode()){return ;}var H=this,G,F=(H.getDocModel&&H.getDocModel())||H.model.docModel;if(F){return F.attachEventListener("colorMapChanged",H.id,function(K){G=H.parent.parent;if(G.isPanelDisplaying()){I.call(H);}else{var J=G.attachEventListener("panelDisplaying",H.id,function(L){if(H.postBuilderingCalled){I.call(H);}G.detachEventListener(J);});}});}},detachUpdateColorMapListener:function(G){if(!G){return ;}var F=(this.getDocModel&&this.getDocModel())||this.model.docModel;F.detachEventListener(G);},submitUpdatesAndPersistXML:function C(H,L,F,P){if(!H||H.length===0){return ;}var G={},M=this,Q=(M.getDocModel&&M.getDocModel())||M.model.docModel,O=Q.getDataService(),I=M.model.controller||Q.controller,J=I._getXtabCallback(M);if(F){D.copy(mstrmojo.DocDataService.SUPPRESS_DATA,G);}if(P){D.copy(mstrmojo.DocDataService.REQUEST_ONLY_DEFINITION,G);}var K=false;E.forEach(H,function(R){if(R.act==="updateElementsPropertiesMap"){K=true;}});if(K){A(Q.getUpdateColorMapCallback(),J);}B(M).execute({execute:function N(){var R=O.newUpdate(this,undefined);R.add(H,L,G);this.submitUpdate(R);},urInfo:{callback:J}});},updateColorMap:function(I,G){if(!E.isArray((G))){G=[G];I=[I];}if(I.length!==G.length){throw new Error("comb and color number mismatch");}var F=(this.getDocModel&&this.getDocModel())||this.model.docModel,J=mstrmojo.VisUtility.getUpdateColorMapAction.bind(this),H=I.map(function(L,K){return J(L,JSON.stringify({color:G[K]}));});this.submitUpdatesAndPersistXML(H,F.getUpdateColorMapCallback(),false,true);}});}());(function(){mstrmojo.requiresCls("mstrmojo.Widget","mstrmojo.heatmap.vi.VisHeatMapColorTheme","mstrmojo.dom","mstrmojo.hash","mstrmojo.css","mstrmojo.VisUtility","mstrmojo.heatmap.vi.VisHeatmapUtility","mstrmojo.util.color","mstrmojo.vi.enums.EnumThemeProperties");var E=mstrmojo.util.color,I=mstrmojo.VisUtility,H=mstrmojo.heatmap.vi.VisHeatmapUtility,F=mstrmojo.vi.enums.EnumThemeProperties.SUBTYPE.HEATMAP,C=mstrmojo.hash;var J={ON:0,OFF:1,PROPORTIONAL:2};var L={LABEL_CTNR_THRES:6,LABEL_CTNR_WIDTH_THRES:32,LGD_GUTTER:5,LABEL_PADDING:5};var N=0.5;function G(U,Y){var R=[U];while(R.length!==0){var X=R.shift();if(X===undefined||X.deleted){continue;}Y(X);var W=X.entityChildren;if(W!==undefined){var S=W.length,V;for(V=0;V<S;V++){R.push(W[V]);}}}}function D(U,X,V){if(U.deleted){return ;}if(V===undefined){X(U);}else{X(U,V);}if(U.entityChildren===undefined){return ;}var R=U.entityChildren,S=R.length,W;for(W=0;W<S;W++){var Y=R[W];if(V===undefined){D(Y,X);}else{var Z=V;if(!Z){Z=W.toString();}else{Z=Z+":"+W;}D(Y,X,Z);}}}function M(W,V){var U=parseFloat(W),R=U.toString().length,S=W.substring(R);return U*V+S;}function Q(R,V,S){var U;if(S){if(R===0){U="heatmap-level-1-header-on-top";}else{if(R===1){U="heatmap-level-2-header-on-top";}else{U="heatmap-level-3-header-on-top";}}}else{if(V===1){if(R===0){U="heatmap-one-level-1";}}else{if(V===2){if(R===0){U="heatmap-multi-level-1";}else{if(R===1){U="heatmap-two-level-2";}}}else{if(V>=3){if(R===0){U="heatmap-multi-level-1";}else{if(R===1){U="heatmap-multi-level-2";}else{if(R===2){U="heatmap-multi-level-3";}}}}}}}return U;}function B(R,S){if(!R||!S){return false;}return !(S.x>=R.x+R.w||S.y>=R.y+R.h||S.x+S.w<=R.x||S.y+S.h<=R.y);}function A(V,S){var R=Math.max(V.x,S.x);var X=Math.max(V.y,S.y);var U=Math.min(V.x+V.w,S.x+S.w)-R;var W=Math.min(V.y+V.h,S.y+S.h)-X;if(U<0||W<0){return{x:NaN,y:NaN,w:NaN,h:NaN};}return{x:R,y:X,w:U,h:W};}function P(R){var S=this.domSpan;Object.keys(R||[]).forEach(function(V){if(V==="style"){H.processFontStyle(R,parseInt(R.style));return ;}if(V!=="scale"&&V!=="family"){S.className=V;var W=R[V];if(W){S.style.fontFamily=R.family;S.style.fontSize=M(W,R.scale);}var U=document.defaultView.getComputedStyle(S);R[V]={fontSize:parseInt(U.fontSize,10),fontWeight:U.fontWeight};}});}function K(S){var R=this.bgColor,U={value:R!==undefined?R:"#ffffff",opacity:1};return E.mix(S,U);}function O(W){var a=W.e,Y=W.css,c=W.s,R=document.createElement("div"),X=this.getLabelColor(a,c),S=R.style;R.className=Y+" heatmap-trun-text";S.position="absolute";S.width=c.w+"px";S.height=c.h*1.3+"px";S.lineHeight=W.lh+"px";S.zIndex=1;S.color=X;if(W.fontSize){S.fontSize=W.fontSize;}if(W.fontFamily){S.fontFamily="'"+W.fontFamily+"'";}if(W.fontWeight){S.fontWeight=W.fontWeight;}R.innerHTML=a.text;R.firstChild.setAttribute("idx",a.idx);a.labelDomNode=R;var U=document.createElement("div"),Z=U.style;Z.position="absolute";Z.left=c.x+"px";Z.top=c.y+"px";Z.width=c.w+"px";Z.height=c.h+"px";U.appendChild(R);var b=document.createElement("div");b.className="heatmap-label-square";var V=4;b.style.width=V+"px";b.style.height=V+"px";b.style.top=(W.lh-V)+"px";U.appendChild(b);return U;}mstrmojo.heatmap.vi.VisHeatMapCanvas=mstrmojo.declare(mstrmojo.Widget,null,{scriptClass:"mstrmojo.heatmap.vi.VisHeatMapCanvas",parent:null,root:null,colorTheme:null,attributes:[],scale:1,labelSetting:0,showMetric:false,bgColor:"#333333",numImages:0,offsetX:0,offsetY:0,markupString:'<div style="position:absolute; width:{@width}px; height:{@height}px"><canvas width={@width} height={@height} style="visibility: hidden; z-index:0"></canvas><span></span></div>',markupSlots:{domCanvas:function(){return this.domNode.firstChild;},domSpan:function(){return this.domNode.childNodes[1];},domImage:function(){return this.domNode.childNodes[2];}},init:function(R){if(this._super){this._super(R);}this.canvasStepX=this.scale*this.width;this.canvasStepY=this.scale*this.height;},postBuildRendering:function(){if(!this.isFontHeightMeasured){this.measureFontHeight();}this.draw();this._super();},removeImageAndLabels:function(){var U=this.domNode,W=U.childNodes,V=W.length,R;for(R=V-1;R>1;R--){var S=W[R];U.removeChild(S);}this.numImages=0;},removeLabels:function(){var V=this.domNode,X=V.childNodes,W=X.length,S=1+this.numImages,R;for(R=W-1;R>S;R--){var U=X[R];V.removeChild(U);}},updateOffsets:function(R,S){this.offsetX=R;this.offsetY=S;this.removeLabels();this.drawLabels();},draw:function(R,S){if(R!==undefined){this.offsetX=R;}if(S!==undefined){this.offsetY=S;}this.removeImageAndLabels();this.drawRects();this.drawLabels();},drawRects:function(){var a=this.width,m=this.height,f=this.scale,S=Math.ceil(a*f),c=Math.ceil(m*f),b=this.domCanvas,n=this.domNode,R=document.createDocumentFragment(),Z=this.canvasStepX,Y=this.canvasStepY,W=Math.ceil(c/Y),U=Math.ceil(S/Z),X=0,l,g,e,d;var V=function(s,x){var u,j,k,r,q,z,y;if(!s.deleted){if(s.entityChildren===undefined){u=s.size;j=s.color;}else{if(s.headerSize){u=s.headerSize;j=s.headerColor;}}if(B(d,u)){var i=Math.max(u.x-d.x,0),w=Math.max(u.y-d.y,0),h=Math.min(u.x+u.w-d.x,d.w),t=Math.min(u.y+u.h-d.y,d.h);k=j.value;if(E.isGradientColor(k)&&k.or===1){r=i;q=w;z=h;y=w;}else{r=i;q=w;z=i;y=t;}e.fillStyle=E.createCanvasFillPattern(j,e,r,q,z,y);e.fillRect(i,w,h-i,t-w);}}s.idx=x;};for(l=0;l<W;l++){for(g=0;g<U;g++){d={x:g*Z,y:l*Y,w:Z,h:Y};if(l+1===W){d.h=c-d.y;}if(g+1===U){d.w=S-d.x;}b.width=d.w;b.height=d.h;e=b.getContext("2d");e.fillStyle="rgba(0, 0, 0, 0)";e.fillRect(0,0,d.w,d.h);D(this.root,V,"");var p=b.toDataURL();var o=document.createElement("img");o.src=p;o.style.position="absolute";o.style.left=d.x+"px";o.style.top=d.y+"px";o.draggable=false;o.setAttribute("orgx",d.x);o.setAttribute("orgy",d.y);R.appendChild(o);X++;}}b.width=0;b.height=0;n.style.width=S+"px";n.style.height=c+"px";n.appendChild(R);this.numImages=X;},drawLabels:function(){var j=this.attributes.length,Z=this,W=L.LGD_GUTTER*2,b=2*L.LABEL_PADDING,a={x:this.offsetX,y:this.offsetY,w:this.width,h:this.height},V=[],i=[{},{},{}];var Y=Math.floor(Math.log(this.scale)/Math.log(2));Y=Math.min(Y,j-3);Y=Math.max(Y,0);this._ext=Y;var c=this.labelSetting===J.OFF;var U="\u2026";var f=H.isSpatial();function X(r,p,m,q){var k=9,o=8,n=false,l=Z.getTextSize(r,p,k,m,false,q.w);while(o>=1){if(l.h<q.h){k+=o;}else{if(k===9){break;}if(k>=q.w){break;}if(!n){o/=2;}n=true;k-=o;}l=Z.getTextSize(r,p,k,m,false,q.w);if(n){o=o>>1;}}if(l.h>q.h&&k>9){k--;}if(k>q.w){k=q.w;}return{fontSize:k,loc:q};}function R(x,k,AC,AB,l,u,p){AC.text=AC.text.replace("#addedStyleTemplate",p);var y=AC.text;var t=k&&(k.w-b),AA=k&&(k.h-b);var z={drop:true};var AD,q,m,r,o;var n={fontFamily:AB,fontSize:l+"px",fontWeight:u};if(Z.labelSetting===J.PROPORTIONAL){var s=mstrmojo.hash.copy(k);s.w=t;s.h=AA;var AE=X(y,AB,u,s);m=AE.fontSize;s=AE.loc;x.fs=m;x.lh=m;r=Z.getTextSize(y,AB,m,u,false,t);if(r.h>s.h){return z;}AD=r.w;q=r.h;l=m;}else{m=l;r=Z.getTextSize(y,AB,m,u,false,t,true);o=I.measureTextWidth(U,n);q=r.h;AD=r.w;x.lh=m;if(r.w/2+o+N>t){return z;}if(q>AA){return z;}}x.isLowestLevel=true;return{w:AD,h:q,fontSize:l};}function S(AA,k,AJ,AH,m,u,r){var y=mstrApp.getThemeProps(F),t=k&&(k.w-2*y.leftPadding),AG=k&&(k.h-2*y.topPadding),n=m*y.lineHeightTime;var l="<div style='line-height: #lineHeightTime;width: #maxWidth;overflow: hidden;text-overflow: ellipsis;text-align: left; #addedStyleTemplate'>#innerText</div>",o="<div style='line-height: #lineHeightTime;margin-top: #marginTop;white-space: nowrap;text-align: left; #addedStyleTemplate'>#innerText</div>";l=l.replace("#maxWidth",t+"px").replace("#lineHeightTime",y.lineHeightTime).replace("#addedStyleTemplate",r);o=o.replace("#lineHeightTime",y.lineHeightTime).replace("#marginTop",y.marginTop).replace("#addedStyleTemplate",r);var AF={drop:true},q={fontFamily:AH,fontSize:m,fontWeight:u},AK,p;var AL=Z.parent.getEntityDisplayName(AJ),z=AL.split(" ");var AD=I.measureTextWidth(z[0],q);if(t<AD||AG<n){return AF;}var AB=[];AB.push(z[0]);var AE;for(AE=1;AE<z.length;AE++){AK=I.measureTextWidth(z[AE],q);AB.push(z[AE]);if(AK>t){if(AE<z.length-1){AB[AE]=AB[AE]+"...";}break;}}z=AB;AB=[];AL=z[0];AB.push(z[0]);var s=n;for(AE=1;AE<z.length;AE++){AL+=(" "+z[AE]);p=l.replace("#innerText",AL);AK=Z.getTextSize(p,AH,m,u,false,t,true,n);if(AK.h>AG){p=l.replace("#innerText",AB.join(" ")+" "+z[AE][0]+"...");AK=Z.getTextSize(p,AH,m,u,false,t,true,n);if(AK.h<AG){AB.push(z[AE]);}var AI=AB[AB.length-1];var AC;for(AC=0;AC<AI.length;AC++){AB[AB.length-1]=AI.substring(0,AI.length-AC)+"...";p=l.replace("#innerText",AB.join(" "));AK=Z.getTextSize(p,AH,m,u,false,t,true,n);if(AK.h<AG){break;}}break;}else{AB.push(z[AE]);s=AK.h;}}AL=AB.join(" ");AJ.text=l.replace("#innerText",AL).replace('style="','style="height:'+s+"px;");AK=Z.getTextSize(AJ.text,AH,m,u,false,t,true,n);if(AK.h<AG){if(Z.parent.props.showMetricValues){var x=Z.parent.getMetricDisplayValues(Z.parent,AJ);if(x.length>0){p=o.replace("#innerText",x.join("<br>"));AK=Z.getTextSize(p,AH,m,u,false,t,true,n);if(AK.w<t&&(AK.h+s)<AG){AJ.text+=p;}}}}AK=Z.getTextSize(AJ.text,AH,m,u,false,t,true,n);AA.isLowestLevel=true;AA.lh=n;return{w:AK.w,h:AK.h,fontSize:m};}function h(k,x,l,AB,AA,m,u,r){AB.text=AB.text.replace("#addedStyleTemplate",r);var t=l&&l.w,z=l&&l.h,y=!Z.isHeaderOnTop,q={drop:true};if(y&&j>1&&k===0){t-=W;z-=W;}var n,s,AC,p;var o={fontFamily:AA,fontSize:m+"px",fontWeight:u};var AD=Z.parent.getEntityDisplayName(AB);n=I.measureTextWidthWithSpan(AD,o)*1.05;s=m;AC=Math.min(n,t);p=I.measureTextWidth(U,o);if(n/2+p+N>t){return q;}if(s>z){return q;}x.lh=s;return{w:AC,h:s,fontSize:m};}function e(k,z,t,o,q,r,w){var p=o.w,m=o.h,AA=o.fontSize,l,u,s;if(w&&!r.entityChildren&&Z.labelSetting!==J.PROPORTIONAL){l=mstrApp.getThemeProps(F);u=t.x+l.leftPadding;s=t.y+l.topPadding;}else{u=t.x+((t.w-p)/2);s=t.y+((t.h-m)/2);}q.s={x:u,y:s,w:p,h:m};if(i[k]===undefined){i[k]={};}var n=Z.getFontGroup(Z.fonts,k);if(n){q.fontFamily=n.family;}q.fontSize=AA+"px";i[k][z]=q;}function g(l){if(l===Z.root||l.deleted||(c&&!l.entityChildren)){return true;}var k=(Z.isHeaderOnTop&&l.entityChildren)?l.headerSize:l.size;if(!B(a,k)){return true;}if(k.w<L.LABEL_CTNR_WIDTH_THRES+2*L.LABEL_PADDING||k.h<L.LABEL_CTNR_THRES){return true;}if(!Z.isHeaderOnTop){var m=l.level-Y;if(m<0||m>=3){return true;}}return false;}function d(r){if(g(r)){return ;}var u,k;if(Z.isHeaderOnTop){u=r.entityChildren?r.headerSize:r.size;k=r.level;}else{u=r.size;k=r.level-Y;}var o,w=r.idx,p=Q(k,j,Z.isHeaderOnTop),m=Z.getFontGroup(Z.measuredFonts,r.level),s=m.family,n=m[p],x=n.fontSize,t=m.fontWeight,q={s:{},e:r,m:0,css:p};var l="font-weight: #fontWeight; font-style: #italic; text-decoration: #textDecoration";l=l.replace("#fontWeight",t).replace("#italic",m.fontStyle).replace("#textDecoration",m.textDecoration);if(!r.entityChildren){if(!f||Z.labelSetting===J.PROPORTIONAL){o=R(q,u,r,s,x,t,l);}else{o=S(q,u,r,s,x,t,l);}}else{o=h(k,q,u,r,s,x,t,l);}if(o.drop){return ;}e(k,w,u,o,q,r,f);}G(this.root,d);if(this.isHeaderOnTop){this.layoutLabelsOnTop(i);}else{this.layoutLabelsOnMiddle(i);}},layoutLabelsOnTop:function(V){var Y=document.createDocumentFragment(),X=V.length,U,W=this;for(U=0;U<X;U++){var Z=V[U],b;for(b in Z){var S=Z[b],a=O.call(this,S),R=a.firstChild.style;if(S.isLowestLevel||W.isHeaderColorsModified()){R.color=W.getLabelColor(S.e);}if(S.isLowestLevel&&W.labelSetting===J.PROPORTIONAL){R.wordBreak="break-all";}else{R.textOverflow="ellipsis";R.wordBreak="normal";}Y.appendChild(a);}}this.domNode.appendChild(Y);},layoutLabelsOnMiddle:function(q){var t=document,U=t.createDocumentFragment(),j=this;function d(x){var u=O.call(j,x);var w=u.firstChild.style;if(x.isLowestLevel&&j.labelSetting===J.PROPORTIONAL){w.wordBreak="break-all";}else{w.wordBreak="normal";}U.appendChild(u);}var o=q[0],n=q[1],m=q[2],g,h;for(g in n){h=false;var p=n[g],S=p.s,i=p.e,Z=i.parentEntity,s=o[Z.idx];if(s===undefined){d(p);}if(!!s){var X=s.s,a=A(S,X);if(a.w>5||a.h>5){var r;if(X.y<=S.y){r=((X.y+X.h-S.y)>>1)+1;if(s.m!==2&&(X.y-r>=Z.size.y)&&(S.y+S.h+r<=i.size.y+i.size.h)){X.y-=r;S.y+=r;s.m=1;}else{h=true;}}else{r=((S.y+S.h-X.y)>>1)+1;if(s.m!==1&&(X.y+X.h+r<=Z.size.y+Z.size.h)&&(S.y-r>=i.size.y)){X.y+=r;S.y-=r;s.m=2;}else{h=true;}}}if(h!==true){d(p);}}}for(g in o){d(o[g]);}for(g in m){h=false;var b=m[g],R=b.e,V=R.parentEntity,W=V.parentEntity,k=V.idx,l=W.idx,c=n[k],e=o[l];if(c!==undefined){var f=A(c.s,b.s);if(!isNaN(f.w)){h=true;}}if(h===false&&e!==undefined){var Y=A(e.s,b.s);if(!isNaN(Y.w)){h=true;}}if(h!==true){d(b);}}this.domNode.appendChild(U);},getLabelColor:function(l,c,Z){var m,U=this.colorTheme,b=K.bind(this),j,g,R,V;if(Z){V=function(e){return Z(b(e));};}else{V=b;}if(this.isHeaderOnTop){if(!l.entityChildren){j=l.color;}else{j=l.headerColor;}j=V(j);g=E.getColorValue(j.value);m=E.getCSSColorString(U.getContrastColor(g));}else{R=l.level-this._ext;if(R===0){return"#FFFFFF";}if(l.entityChildren===undefined){j=V(l.color);g=E.getColorValue(j.value);return E.getCSSColorString(U.getContrastColor(g));}var X=[l],Y=0,d=0;while(X.length!==0){var h=X.shift(),a=h.entityChildren,f=h.entityChildren.length,k;for(k=0;k<f;k++){var W=a[k];if(W.deleted){continue;}var S=A(c,W.size);if(W.entityChildren===undefined){if(!isNaN(S.w)){j=V(W.color);g=E.getColorValue(j.value);if(U.isBrightColor(g)){Y+=S.w*S.h;}else{d+=S.w*S.h;}}}else{if(!isNaN(S.w)){X.push(W);}}}}if(Y>d){m="#000000";}else{m="#FFFFFF";}}return m;},getEntity:function(X){var S=X.x,R=X.y,V;var U=function(d){if(d.deleted){return ;}var b;if(d.entityChildren===undefined){b=d.size;}else{if(d.entityChildren&&d.headerSize!==undefined){b=d.headerSize;}}if(b){var Z=b.x,c=b.y,Y=Z+b.w,a=c+b.h;if(S>=Z&&S<=Y&&R>=c&&R<=a){V=d;}}};var W=function(a,c){if(a.deleted){return ;}c(a);var Y=a.entityChildren;if(Y!==undefined){var Z=Y.length,b;for(b=0;b<Z;b++){var d=Y[b];W(d,c);if(V!==undefined){return ;}}}};W(this.root,U);return V;},getAllSiblingEntities:function(X){var V=X.id,Z=X.level,S=[],R=0,Y=[],W,U;S.push({entity:this.root,level:-1});while(S.length>0){W=S.shift();U=W.entity;if(U.id===V){Y.push(U);continue;}if(W.level<Z&&U.entityChildren){for(R=0;R<U.entityChildren.length;++R){S.push({entity:U.entityChildren[R],level:U.entityChildren[R].level});}}}return Y;},getFontGroup:function(U,S){if(!this.isHeaderOnTop){return U.headerOnMiddle;}var R=this.attributes.length;return R===S+1?U.headerOnTop.cell:U.headerOnTop.header;},clearFontCache:function(){this.isFontHeightMeasured=false;},measureFontHeight:function(){this.measuredFonts=C.clone(this.fonts);var R=this.measuredFonts;P.call(this,R.headerOnMiddle);P.call(this,R.headerOnTop.header);P.call(this,R.headerOnTop.cell);this.isFontHeightMeasured=true;},getTextSize:function(Y,S,b,Z,R,U,W){function V(){var e=document.getElementById("heatmap-measure-span"),c,d;if(!e){e=document.createElement("span");e.setAttribute("id","heatmap-measure-span");document.body.appendChild(e);}e.innerHTML=Y;e.style.cssText="position:absolute; visibility:hidden; z-index:-1; font-family:"+S+"; font-size:"+b+"px; font-weight:"+Z+"; font-style:"+(R?"italic":"normal")+"; line-height:"+b+"px;";c=e.offsetWidth;d=e.offsetHeight;if(U!==undefined&&c>U){e.style.cssText+="overflow:hidden; word-break:"+X+"; max-width:"+U+"px;";d=e.offsetHeight;c=e.offsetWidth;}return{w:c,h:d};}var X="break-all";if(W){X="normal";}Z=Z||"normal";var a=V.call(this);a.w+=N;return a;}});}());(function(){mstrmojo.requiresCls("mstrmojo.ui.editors.controls.TwoColumnContainer","mstrmojo.Label","mstrmojo.array","mstrmojo.hash","mstrmojo.Popup","mstrmojo.Box","mstrmojo.ui.editors.controls.ColorPickerButton","mstrmojo.ui.PopupConfig","mstrmojo.ui.Pulldown","mstrmojo.dom","mstrmojo._FormatDefinition","mstrmojo.string","mstrmojo.Button","mstrmojo.models.FormatModel","mstrmojo.VisUtility","mstrmojo.heatmap.vi.VisHeatmapUtility");var J=mstrmojo.array,B=mstrmojo.hash,I=mstrmojo.dom,D=mstrmojo.VisUtility,H=mstrmojo.heatmap.vi.VisHeatmapUtility,N=mstrmojo.string,E=mstrmojo.chart.enums.EnumFontStyle,L=mstrmojo.ui.editors.controls.FillConfigGroup.CTRL_FLAGS;function O(Q,S){var P=Q.length,R;for(R=0;R<P;R++){if(S===Q[R].did){return R;}}}function K(Q,P){Q=Q||[];J.forEach(Q,function(R){R.cssDisplay="inline-block";});return B.copy(P||{},{scriptClass:"mstrmojo.Box",cssClass:"row-container",children:Q});}function F(R,Q,S,U){var P=function(V){var W=V.value,X=R[W]&&R[W].did;S.setValue(X);};return A(R,Q,P,U);}function A(Q,P,V,U){U=U||"60px";var S=new mstrmojo.ui.Pulldown({items:Q,width:U,postselectedIndexChange:V,getPopupListConfig:function R(){var W=mstrmojo.ui.Pulldown.prototype.getPopupListConfig.call(this);W.getItemProps=function X(a,Y){var Z=mstrmojo._IsList.getItemProps.call(this,a,Y);Z.style=a.preview?"font-family:'"+N.encodeHtmlString(a.n,true)+"';":"";return Z;};return W;}});S.set("selectedIndex",P);return{scriptClass:"mstrmojo.Box",children:[S]};}function G(S,Q){Q=B.copy(Q,{label:mstrmojo.desc(3905,"Background"),noOpacity:false,showNoFill:true});var R=!Q.noOpacity;var W,U,P;var Y="ColorClr",Z="ColorFillTrans";if(R){W=L.FILL_COLOR|L.FILL_TRANSPARENCY;U=[Y,Z];P="125px";}else{W=L.FILL_COLOR;U=[Y];P="60px";}var V=new mstrmojo.ui.editors.controls.FillConfigGroup({colorPickerHostWithin:true,showNoFill:Q.showNoFill,visibleControls:W,onGroupValueChange:function(a,b){if(a===Y){S.value.setValue(b);}if(a===Z){S.opacity.setValue(b/100);}},width:P});if(V){if(R){V.fillColorAndTrans.layoutConfig={w:{col1Node:"50%",dividerNode:"5px",col2Node:"50%"},xt:true};}V.iniChildrenComp(U);V.syncControls(function(){this.setChildValue(Y,S.value.getValue());if(R){this.setChildValue(Z,S.opacity.getValue()*100);}});}var X=[{scriptClass:"mstrmojo.Box",width:"60px",children:[{scriptClass:"mstrmojo.Label",text:Q.label}]},V];return[K(X)];}var C={background:G,headerFill:G,font:function(R,W){var P=H.getStepper(function(X){if(X>0){R.scale.setValue(R.scale.getValue()+0.1);}else{R.scale.setValue(Math.max(0.1,R.scale.getValue()-0.1));}},{width:"62px",dividerWidth:"5px"});this.attachEventListener("fontScaleChange",this.id,function(X){H.setStepperEnabled(P,[W.modelPath],X.limits);if(W.disableFontSize){P.set("enabled",false);}});var U=new mstrmojo.ui.ButtonBar({hasSpacing:true,multiSelect:true,items:H.getFontStyleItems(),postselectionChange:function(X){var a=X.added,b=this.items[(a&&a[0]!==undefined)?a[0]:X.removed[0]],Z=(a&&a.length>0);var Y=R.style.getValue(),c=(Y===undefined?E.NORMAL:Y);if(Z){c=c|H.fontStyleValueMap[b.css];}else{c=c&(~H.fontStyleValueMap[b.css]);}if(Y!==c){R.style.setValue(c.toString());}}}),S=function(Y){var X={};var Z=parseInt(Y.style.getValue());H.convertFontStyle(Z,X);return X;},V=function(Y){var X=S(Y);H.updateFontStyle(U,X);};var Q=[K([{scriptClass:"mstrmojo.Box",width:"60px",children:[{scriptClass:"mstrmojo.Label",text:mstrmojo.desc(3544,"Text")}]},P,F(D.getFontFamilyItems(),O(D.getFontFamilyItems(),R.family.getValue()),R.family),U],{width:"335px"})];this.triggerFontScaleChangeEvent();V(R);return Q;},attributeColorBy:function(X,S){S=S||{};var W=mstrmojo.desc(2885,"Fill"),Y=S.callback;var V="ShapeClr",Q="ShapeFillTrans",P=Y&&Y.onFillChanged&&Y.onOpacityChanged,R=P?function(a,Z){if(a===V){Y.onFillChanged.call(this,Z,function(b){U.syncControls(function(){this.setChildValue(V,b);});});D.setColorPickerShowAutomatic(U,Z!=="automatic");}else{if(a===Q){Y.onOpacityChanged.call(this,Z);}}}:mstrmojo.emptyFn,U=new mstrmojo.ui.editors.controls.FillConfigGroup({colorPickerHostWithin:true,onGroupValueChange:R,width:"125px"});if(U){U.fillColorAndTrans.layoutConfig={w:{col1Node:"50%",dividerNode:"5px",col2Node:"50%"},xt:true};U.iniChildrenComp([V,Q]);U.syncControls(function(){this.setChildValue(V,X.color);this.setChildValue(Q,X.opacity);});D.setColorPickerShowAutomatic(U,X.showAutomatic);}return[K([{scriptClass:"mstrmojo.Box",width:"60px",children:[{scriptClass:"mstrmojo.Label",text:W}]},U],{width:"147px"})];},metricColorByOpacity:function(Q){var R="ShapeFillTrans";var P=new mstrmojo.ui.editors.controls.FillConfigGroup({visibleControls:L.FILL_TRANSPARENCY,onGroupValueChange:function(U,S){if(U===R&&Q){Q.setValue(S/100);}},width:"60px"});if(P&&Q){P.iniChildrenComp([R]);P.syncControls(function(){this.setChildValue(R,Q.getValue()*100);});}return[K([{scriptClass:"mstrmojo.Box",width:"60px",children:[{scriptClass:"mstrmojo.Label",text:mstrmojo.desc(2885,"Fill")}]},P])];}};function M(Z,S,U){var Y=[],R=this;Z.forEach(function(g){var e=g.type,c=g.model,b=C[e],f=R.getWidget();if(b){Y=Y.concat(b.call(f,c,g));}});if(Y.length){var V=I.position(this.containerNode,true),X=S.pageX-V.x,W=S.pageY-V.y;var P={scriptClass:"mstrmojo.Popup",cssClass:"widget-inner-context-menu "+mstrApp.getThemeClassName(),locksHover:true,children:Y};var Q=this._contextMenuAnchor;if(!Q||!Q.parentElement){Q=document.createElement("div");Q.style.position="absolute";this._contextMenuAnchor=Q;this.containerNode.appendChild(Q);}Q.style.left=X+1+"px";Q.style.top=W+1+"px";var a={hostId:this.id,hostElement:Q,isHostedWithin:false};if(U){a.alignment=U;}P.popupConfig=new mstrmojo.ui.PopupConfig(a);P.visible=true;P.onClose=function(){this.unrender();};return P;}}mstrmojo.heatmap.vi._HasHeatmapContextMenu=mstrmojo.provide("mstrmojo.heatmap.vi._HasHeatmapContextMenu",{getWidget:function(){return this;},showContextMenu:function(P,Q,R){P=[].concat(P);this.openPopup(M.call(this,P,Q,R));},unrender:function(P){this._contextMenuAnchor=undefined;this._super(P);}});}());(function(){mstrmojo.requiresCls("mstrmojo.VisBase","mstrmojo.DocPortlet");var L={top:"top",left:"left","z-index":"zIndex",width:"width",height:"height"},P,B;mstrmojo.Vis=mstrmojo.declare(mstrmojo.VisBase,null,{scriptClass:"mstrmojo.Vis",offsetTop:0,offsetLeft:0,isAndroid:window.navigator.userAgent.indexOf("Android")!=-1,reRenderOnDimensionChg:true,isVis:function(){return true;},setModel:function Q(R){this._super(R);if(R.data){this.set("model",R.data);}this.xtabModel=R;if(this.controller&&typeof (this.controller.getPageByTree)!="undefined"){this.controller.getPageByTree(false);}},destroy:function O(){this._super();var R=this.xtabModel;if(R&&R.destroy){R.destroy();delete this.xtabModel;}},setDimensions:function N(U,S){var R=this._super(U,S);if(R&&this.hasRendered&&this.reRenderOnDimensionChg){this.reRender();}return R;},buildRendering:function M(){if(this.parent instanceof mstrmojo.DocPortlet){delete this.left;delete this.top;this.height=this.fmts&&this.fmts.height;}this._super();},postBuildRendering:function G(){P=this.width;B=this.height;this.adjustWidgetOffsets();this._super();},adjustWidgetOffsets:function E(){var R=mstrmojo.boxmodel.offset(this.domNode);this.offsetTop=R.top;this.offsetLeft=R.left;},update:function F(W){W=W||this.node;if(W){if(W.data){this.set("model",W.data);if(this.xtabModel&&this.xtabModel.set){this.xtabModel.set("data",W.data);}this.model=W.data;if(this.model.layoutModel){this.layoutModel=this.model.layoutModel;}if(this.model.layoutNode){this.layoutNode=this.model.layoutNode;}mstrmojo.hash.copy(W.data.extProps,this);}var U=this.controller,S=U.view,Y=(S.hasRendered&&S.getCurrentLayout&&S.getCurrentLayout());if(U.view.fullScreenInfoWindow&&(Y&&Y.defn.visName)){var X=mstrApp.rootView.getContentDimensions();this.height=X.h+"px";this.width=X.w+"px";}else{this.fmts=W.defn.fmts||W.defn.units[this.model.k].fmts;var R=this.fmts;if(R){for(var V in L){v=L[V];if(V in R){this[v]=R[V];}}}}}if(this.model){this.initFromVisProps(this.model.vp);}this.updated=true;return true;},getModel:function A(S){if(S){var R=mstrmojo.Vis.getVisGrid(this.layoutModel,this.layoutNode,S);if(R){return R.data;}else{alert(mstrmojo.desc(8427,"Incorrect visualization properties encountered.  Data may be inconsistent.  Please reset your properties."));return{};}}else{return this.model;}},getDataParser:function K(R){return new mstrmojo.Vis.DataParser(this.getModel(R));},renderErrorMessage:function H(R){this.domNode.innerHTML='<div class="mstrmojo-message">'+R+"</div>";},getMessageID:function J(){return this.model.mid&&this.model.mid||this.xtabModel&&this.xtabModel.docModel&&this.xtabModel.docModel.mid;},hasNoninfowindowTarget:function D(V){var c=this.xtabModel,b=(c&&c.docModel);var d=false;if(b){var a=b.defn&&b.defn.layouts,U=null;var S;if(a){for(S in a){if(a[S].loaded){U=a[S];break;}}}var W=U&&U.units;this.selectorTargets={};if(W&&V.scObjList){for(var S=0;S<V.scObjList.length;S++){var X=V.scObjList[S];var Y=X.sc.tks.split("\x1E");for(var R=0;R<Y.length;R++){var Z=W[Y[R]];if(Z){this.selectorTargets[Y[R]]=Z;if(!this.isChildOfIfw(W,Z)){d=true;}}}}}}return d;},isChildOfIfw:function I(R,S){while(S){if(S.ifw){return true;}S=R[S.pnk];}return false;},performAction:function C(R){var U=this.xtabModel.getAction(R),S=U&&U.h;if(S&&this.controller[S]){this.controller[S](this,U.a);return true;}return false;}});mstrmojo.Vis.getVisGrid=function(R,Z,S){var X=Z;var V=R.getChildren(Z,false);for(var U=0;U<V.length;U++){var Y=V[U];if(Y.k==S){return Y;}else{var W=mstrmojo.Vis.getVisGrid(R,Y,S);if(W){Z=X;return W;}}}};mstrmojo.Vis.DataParser=function(U){var b=mstrmojo.Vis;return{getRowTitles:function(){return new b.Titles(U,true);},getColTitles:function(){return new b.Titles(U,false);},findMetricValue:function(g,l){var k=U.ghs.rhs.items;for(var h in k){var j=k[h].items;var f=true;for(var d in g){if(g[d]!=j[d].idx){f=false;break;}}if(f){return new mstrmojo.Vis.MetricValue(U.gvs.items[h].items[l]);}}},getTotalRows:function X(){var c=U.ghs&&U.ghs.rhs&&U.ghs.rhs.items;return(U.eg||!c)?0:c.length;},getTotalColHeaderRows:function V(){return(!U.ghs.chs.items?0:U.ghs.chs.items.length);},getTotalCols:function R(){return this.getColHeaders(0).size();},getRowHeaders:function a(c){return new b.Headers(U,c,true);},getColHeaders:function Z(c){return new b.Headers(U,c,false);},getMetricValue:function Y(d,c){return new b.MetricValue(U,U.gvs.items[d].items[c]);},getColumnHeaderCount:function W(){return U.gvs.items[0].items.length;},getCSSString:function S(){return U.cssString;}};};mstrmojo.Vis.Titles=function(R,X){var W=(X)?R.gts.row:R.gts.col;return{size:function V(){return W.length;},getTitle:function U(Y){return new mstrmojo.Vis.Title(W[Y]);},getCSS:function S(Y){return R.css[W[Y].cni].n;}};};mstrmojo.Vis.Headers=function(S,U,Y){var Z=(Y)?S.gts.row:S.gts.col;var X=(Y)?S.ghs.rhs:S.ghs.chs;var V=X.items&&X.items[U].items;return{size:function a(){return(!V?0:V.length);},getHeader:function R(b){return V&&V[b]&&new mstrmojo.Vis.Header(V[b],Y?Z[b]:Z[U]);},getCSS:function W(b){return V&&S.css[V[b].cni].n;},getHeaderCell:function(b){return V&&V[b];}};};mstrmojo.Vis.Title=function(S){return{getActionType:function(){return S.at;},getDrillPath:function(){return S.dp;},getHeaderValues:function R(){return S.es;},getHeaderName:function U(W){return S.es[W].n;},getHeaderId:function U(W){return S.es[W].id;},getForms:function V(){return S.fs;},getFormId:function(){return S.fid;},getFormType:function(){return S.ftp;},getUnitId:function(){return S.id;},getLinkMap:function(){return S.lm;},getName:function(){return S.n;},getUnitDssType:function(){return S.otp;},getSelectorControl:function(){return S.sc;}};};mstrmojo.Vis.Header=function(U,R){return{getName:function W(){return(U.idx===-1)?"":R.es[U.idx].n;},getElementId:function Z(){return(U.idx===-1)?"":R.es[U.idx].id;},getObjectId:function V(){return(U.idx===-1)?"":R.es[U.idx].oid;},getElementIndex:function S(){return U.idx;},getActionType:function Y(){return U.at;},isTotal:function X(){return U.otr===1;}};};mstrmojo.Vis.MetricValue=function(R,Z){var Y=Z;return{getValue:function S(){return Y.v;},getThresholdType:function U(){return Y.ty;},getRawValue:function X(){return Y.rv;},getCSS:function V(){return R.css[Y.cni].n;},getThresholdValue:function a(b){if(Y.ti==undefined){return b;}return R.th[Y.ti].n;},getFillColor:function W(b){if(Y.ci==undefined){return b;}return R.fc[Y.ci].n;}};};})();(function(){mstrmojo.requiresCls("mstrmojo.dom","mstrmojo.gm.DndTooltip","mstrmojo.VisUtility","mstrmojo.vi.models.EnumDragSources");var N=mstrmojo,I=N.dom,K=N.VisUtility,C=N.vi.models.EnumDragSources,J=N.array;mstrmojo.gm._SupportDndAsBlackBox=mstrmojo.provide("mstrmojo.gm._SupportDndAsBlackBox",{_mixinName:"mstrmojo.gm._SupportDndAsBlackBox",mainContainerNode:"domNode",handleDndForParentNode:true,dndAsBlackBox:true,allowDrop:function H(R){var S=R.src.data,Q=S&&S.src;if(Q===C.DATASETS||Q===C.VIZ_EDITOR||Q===C.VIZ||Q===C.ALL_OBJECT_LIST){return true;}return false;},cleanUpAfterTarget:function E(Q){this._super(Q);if(this.domNode.contains(this.dndHighlightCanvas)){this.domNode.removeChild(this.dndHighlightCanvas);}delete this.dndHighlightCanvas;if(this.dndTooltip){this.dndTooltip.destroy();}delete this.dndTooltip;},ondragenter:function M(R){if(this._super){this._super(R);}var X=this.isEmpty();if(X&&!this.excludeData){R.tgt.widget=this;this.raiseEvent({name:"toggleCtrlOverlay",visible:false,controls:this.getVisEmptyMsgControls()});}var W;if(!this.dndHighlightCanvas){var Q=document.createElement("canvas"),V=I.position(this.domNode),U=I.position(this[this.mainContainerNode]);this.domNode.appendChild(Q);Q.style.position="absolute";Q.style.zIndex=1000;Q.width=U.w||V.w;Q.height=U.h||V.h;Q.style.top=(U.y-V.y)+"px";Q.style.left=(U.x-V.x)+"px";this.dndHighlightCanvas=Q;}if(!this.dndTooltip){W=document.createElement("div");document.body.appendChild(W);var S={placeholder:W,contentNodeCssClass:"gm-dnd-replace-node-tooltip",boundary:document.body};this.dndTooltip=new mstrmojo.gm.DndTooltip(S);this.dndTooltip.render();this.dndTooltip.parent=this;}this.ondragover(R);},ondragover:function B(Q){if(this._super){this._super(Q);}if(this.dndAsBlackBox){this.clearHighlightDropZoneOnGraph();this.drawBlackBoxHighlight(Q);}},ondragleave:function P(Q){var R=this.isEmpty();if(R){this.raiseEvent({name:"toggleCtrlOverlay",visible:true,controls:this.getVisEmptyMsgControls()});}if(this._super){this._super(Q);}},ondrop:function L(R){if(this._super){this._super(R);}if(this.dndAsBlackBox){var V=this.zonesModel,U=R.src.data,Q=U.items,S=R.getCtxtDragData().src;this.getDocModel().selectVIUnit(this.parent.id);V.addUnitsFromDataSource(Q,U.dsid,R.actions,S===C.ALL_OBJECT_LIST?R.callback:null);}},clearHighlightDropZoneOnGraph:function G(){var R=this.dndHighlightCanvas,Q=R.getContext("2d");Q.clearRect(0,0,R.width,R.height);this.dndTooltip.toggle(false);},isMetric:function O(Q){return Q&&Q.t===4;},isAttrCategory:function D(Q){return Q&&(Q.t===12||Q.t===1||Q.t===47);},singleTypeObject:function F(Q){var U=0,S=0,R=this;J.forEach(Q.src.data.items,function(V){if(R.isAttrCategory(V)){U++;}else{if(R.isMetric(V)){S++;}}});return !(U>0&&S>0);},drawBlackBoxHighlight:function A(S){var U=this.dndHighlightCanvas,b=U.getContext("2d"),Y=I.position(this[this.mainContainerNode]),Q=I.position(this.domNode),R=Y.w||Q.w,a=Y.h||Q.h,X=Math.min(30,0.25*R),c=Math.min(30,0.25*a);b.save();b.beginPath();b.rect(X,c,R-2*X,a-2*c);b.fillStyle="#bce8ff";b.globalAlpha=0.4;b.fill();b.strokeStyle="#34abeb";b.globalAlpha=1;K.drawDashLine(b,X,c,X,a-c,2,2);K.drawDashLine(b,X,c,R-X,c,2,2);K.drawDashLine(b,R-X,c,R-X,a-c,2,2);K.drawDashLine(b,X,a-c,R-X,a-c,2,2);b.restore();if(!this.singleTypeObject(S)){var V=this.dndTooltip,Z={x:S.tgt.e.x,y:S.tgt.e.y,w:0,h:0},W=S.src.widget.avatar;if(W){Z=I.position(W);}V.placementOrder=[V.PLACEMENT_ABOVE];V.popupNodeOffset=5;V.updateContent(null,Z,"Add Attributes and Metrics");}}});}());(function(){mstrmojo.requiresCls("mstrmojo.array","mstrmojo.hash","mstrmojo.num","mstrmojo.VisEnum","mstrmojo.VisUtility","mstrmojo.gm.GMEnums","mstrmojo.color","mstrmojo.chart","mstrmojo.chart.common.Utility");mstrmojo.requiresClsP("mstrmojo.chart.enums","EnumGraphMajorType");mstrmojo.requiresClsP("mstrmojo.chart.model.enums","EnumDSSGraphObject");var o=mstrmojo,B=o.css,p=mstrmojo.array,Q=mstrmojo.hash,I=mstrmojo.num,H=mstrmojo.VisUtility,c=mstrmojo.chart,L=c.enums,d=L.EnumGraphMajorType,K=c.common.Utility,V=c.model,N=V.enums,x=N.EnumDSSGraphObject,AB=mstrmojo.VisEnum.ControlType,y=o.gm,W=mstrmojo.gm.EnumTextAlignH,r=mstrmojo.gm.EnumTextAlignV,w=";",k=",",A="_tmsp",M=" ",a=-20,l=mstrmojo.gm.EnumSelectionOptionLevel,AD=mstrmojo.gm.EnumShape,h=mstrmojo.color,J=mstrmojo.gm.EnumIdentityType,S=0.00001,E,b=Math.pow(2,30),e=Math.pow(2,60);var g=["Reserved",mstrmojo.desc(2125,"Maximum"),mstrmojo.desc(2127,"Minimum"),mstrmojo.desc(2122,"Average"),mstrmojo.desc(2126,"Median"),mstrmojo.desc(4046,"First"),mstrmojo.desc(4049,"Last"),mstrmojo.desc(7194,"Constant")];function m(AJ,AI){var AK,AH=AJ.length;if(AH!==AI.length){return false;}for(AK=0;AK<AH;AK++){if(AJ[AK]!==AI[AK]){return false;}}return true;}function AC(AK,AI,AL){var AJ=false,AM=AL+A,AH=AK[AM],AN=AI[AM];if(AI[AL]===undefined){AJ=true;}else{if((AN===undefined&&AH!==undefined)||(AN!==undefined&&AH!==undefined&&AN<AH)){AJ=true;}}if(AJ){AI[AL]=AK[AL];if(AN!==undefined){AI[AM]=AH;}}}function AG(AI,AH){var AJ;for(AJ in AI){if(AI.hasOwnProperty(AJ)){AC(AI,AH,AJ);}}return AH;}function Y(AL){var AK={},AJ,AI=[],AH;p.forEach(AL,function(AM){if(AM!==undefined){AI.push(AM);}});AH=AI.length;if(AH===1){return AI[0];}for(AJ=0;AJ<AH;AJ++){AG(AI[AJ],AK);}return AK;}function AA(AH){return{n:AH,s:AH.toString(),on:AH};}function Z(AJ,AH,AL){if(AH===AJ){return 0;}var AI=AH-AJ,AK=1;while(AI<1){AI*=10;AK/=10;}while(AI>=10){AI/=10;AK*=10;}if(AI<1.8){AK*=0.2;}else{if(AI<3.1){AK*=0.4;}else{if(AI<4.6){AK*=0.5;}else{if(AI>=8.1){AK*=2;}}}}if(AL){AK=Math.round(AK);if(AK<1){AK=1;}}return AK;}function C(AK,AO,AQ,AI){var AM=[];if(AK===AO){if(AK<0){AM.push(mstrmojo.gm.GMUtility.formatNumber(AK,"nearest"));}AM.push({n:0,s:"0",on:0});if(AK>0){AM.push(mstrmojo.gm.GMUtility.formatNumber(AK,"nearest"));}return AM;}var AH=AI>0?AI:Z(AK,AO,AQ);var AJ=Math.ceil(AO/AH)*AH;if(AJ-AO>=AH*0.9){AJ=Math.floor(AO/AH)*AH;}var AN=Math.floor(AK/AH)*AH;if(AK-AN>=AH*0.9){AN=Math.ceil(AK/AH)*AH;}var AP=Math.floor((AJ-AN+AH/100)/AH)+1,AL;for(AL=0;AL<AP;++AL){AM.push(mstrmojo.gm.GMUtility.formatNumber(AN+AL*AH,"nearest"));}return AM;}function U(AH,AK){var AJ;AH.mMaxTick=1;if(this.mChartContextPtr.mIsGraphMatrix){AH.mStep=this.mMinimum<0?0.2:0.1;if(AK.mUseCustomMinMax){var AI=AK;AH.mMaxTick=AI.mAxisMaxValue;AH.mMinTick=AI.mAxisMinValue;AH.mMaxTick=Math.min(1,AH.mMaxTick);AH.mMinTick=Math.max(-1,AH.mMinTick);AH.mStep=0.1;}else{if(this.mMaximum>=0.5){AH.mMaxTick=1;AH.mMinTick=Math.floor(this.mMinimum/AH.mStep)*AH.mStep;AH.mMinTick=(AH.mMinTick*this.mMinimum<0)?0:(AH.mMinTick>0?0:AH.mMinTick);if(this.mMinimum<-0.5){AH.mMinTick=-1;}}else{if(this.mMaximum>0){AH.mMaxTick=Math.ceil(this.mMaximum/AH.mStep)*AH.mStep;AH.mMinTick=-1;}else{AH.mStep=0.1;AH.mMaxTick=0;AH.mMinTick=-1;}}}}else{AH.mMinTick=(this.mMinimum<0)?-1:0;if(u.call(this,AH)){return ;}AH.mStep=this.mMajorGrid.mUseManualGrid?this.mMajorGrid.mGridInterval:(AH.mMaxTick-AH.mMinTick)/10;}for(AJ=AH.mMinTick+AH.mStep;AJ+c.gModuleMain.mTolerance<AH.mMaxTick;AJ+=AH.mStep){AH.mTicks.push(Math.round(AJ*100)/100);}}function P(AH,AM){var AL,AI,AO=AM,AN=AO.mDrawCustomLine,AJ=AO.mAxisCustomValue,AK;AH.mStep=1;if(this.mMaximum<=0){AH.mMinTick=1;AH.mMaxTick=10;if(AN&&AJ<=1){AO.mAxisCustomValue=AH.mMinTick;}return ;}if(this.mMinimum<=0){AI=this.mMaximum>1?0:-1;AH.mMinTick=Math.pow(10,AI);if(AO.mUseCustomMinMax){AH.mMaxTick=this.mMaximum;AL=Math.floor(i.call(this,this.mMaximum));if(i.call(this,this.mMaximum)===AL){AL--;}}else{AL=Math.ceil(i.call(this,this.mMaximum));AH.mMaxTick=Math.pow(10,AL);}for(AK=AI+1;AK<AL;++AK){AH.mTicks.push(Math.pow(10,Math.floor(AK)));}if(AN&&AJ<=0){AO.mAxisCustomValue=Math.max(AH.mMinTick,AO.mAxisCustomValue);}return ;}if(AO.mUseCustomMinMax){AL=i.call(this,this.mMaximum);AI=i.call(this,this.mMinimum);AH.mMaxTick=this.mMaximum;AH.mMinTick=this.mMinimum;}else{AL=Math.ceil(i.call(this,this.mMaximum));AI=Math.floor(i.call(this,this.mMinimum));AH.mMaxTick=Math.pow(10,AL);AH.mMinTick=Math.pow(10,AI);}for(AK=AI+1;AK<AL;++AK){AH.mTicks.push(Math.pow(10,Math.floor(AK)));}if(AN&&AJ<=0){AO.mAxisCustomValue=AH.mMinTick;}}function s(AR,AM){var AJ=AM,AH,AK;AR.mStep=f.call(this,this.mMaximum,this.mMinimum,AJ.mAlwaysIncludeZero);AR.mMaxTick=Math.ceil(this.mMaximum/AR.mStep)*AR.mStep;AR.mMinTick=Math.floor(this.mMinimum/AR.mStep)*AR.mStep;AR.mMaxTick=AR.mMaxTick<this.mMaxmum?this.mMaxmum:AR.mMaxTick;AR.mMinTick=AR.mMinTick>this.mMinimum?this.mMinimum:AR.mMinTick;AR.mMinTick=(AR.mMinTick*this.mMinimum<0)?0:AR.mMinTick;if(AJ.mAlwaysIncludeZero){AR.mMaxTick=(this.mMaximum<0)?0:AR.mMaxTick;AR.mMinTick=(this.mMinimum>0)?0:AR.mMinTick;}var AL=AR.mMaxTick-AR.mMinTick;if(AR.mStep>=AL){return ;}if(u.call(this,AR)){return ;}AH=Math.floor((AR.mMaxTick-AR.mMinTick+AR.mStep/100)/AR.mStep)+1;var AN=this.mNumberFormat;for(AK=1;AK<AH-1;++AK){var AP=AR.mMinTick+AK*AR.mStep,AQ,AI,AO;if(AR.mStep<1&&AN.mFormatType===4&&AN.mCustomFormat.indexOf("%")!==-1){AQ=AP*100;if(!K.isIntegar(AQ)){AI=Math.round(AQ);AO=Math.abs(AQ-AI);if(AO<S){AP=AI/100;}}}AR.mTicks.push(AP);}}function D(AR,AL){var AQ=AL,AK,AH,AO,AJ,AN,AM,AI,AP;AR.mMaxTick=AQ.mAxisMaxValue;AR.mMinTick=AQ.mAxisMinValue;if(u.call(this,AR)){return ;}if(!X.call(this)||this.mMajorGrid.mUseManualGrid){AR.mStep=f.call(this,AR.mMaxTick,AR.mMinTick,false);AK=AR.mMaxTick-AR.mMinTick;if(AR.mStep>=AK){return ;}AH=Math.floor(AK/AR.mStep);if(!(this.mChartContextPtr.mIsTimeSeriesChart)&&AK===AH*AR.mStep){for(AJ=1;AJ<AH;++AJ){AR.mTicks.push(AR.mMinTick+AJ*AR.mStep);}}else{AK=AR.mMaxTick-AR.mMinTick;AO=10;AN=false;for(AJ=3;AJ<AH;++AJ){AM=AK/AJ;while(AM<1){AM*=10;}while(AM>=10){AM/=10;}if(AM===Math.floor(AM)){AO=AJ;AN=true;break;}}if(AN){AR.mStep=AK/AO;for(AJ=1;AJ<AO;++AJ){AR.mTicks.push(AR.mMinTick+AJ*AR.mStep);}}else{AI=Math.ceil((AR.mMinTick+AR.mStep/100)/AR.mStep)*AR.mStep;AP=Math.floor((AR.mMaxTick-AR.mStep/100-AI)/AR.mStep)+3;for(AJ=0;AJ<AP-2;++AJ){AR.mTicks.push(AI+AJ*AR.mStep);}}}}else{AK=AR.mMaxTick-AR.mMinTick;AO=10;for(AJ=6;AJ<=9;++AJ){AM=AK/AJ;while(AM<10){AM*=10;}while(AM>=100){AM/=10;}if(AM===Math.floor(AM)){AO=AJ;break;}}AR.mStep=AK/AO;for(AJ=1;AJ<AO;++AJ){AR.mTicks.push(AR.mMinTick+AJ*AR.mStep);}}}function F(AH,AL){var AK,AI,AJ;AH.mMaxTick=AL.mAxisMaxValue;if(AH.mMaxTick<=this.mMinimum){this.mMinimum=AH.mMaxTick-1;}AH.mStep=f.call(this,AH.mMaxTick,this.mMinimum,AL.mAlwaysIncludeZero&&(AH.mMaxTick>0));AK=(AL.mAlwaysIncludeZero&&(this.mMinimum>0))?0:this.mMinimum;if(X.call(this)){AH.mMinTick=AH.mMaxTick-Math.ceil((AH.mMaxTick-AK)/AH.mStep)*AH.mStep;}else{AH.mMinTick=Math.floor(AK/AH.mStep)*AH.mStep;}if(u.call(this,AH)){return ;}AI=Math.floor((AH.mMaxTick-AH.mStep/100-AH.mMinTick)/AH.mStep)+2;for(AJ=1;AJ<AI-1;++AJ){AH.mTicks.push(AH.mMinTick+AJ*AH.mStep);}}function j(AH,AM){var AI,AL,AJ,AK;AH.mMinTick=AM.mAxisMinValue;if(AH.mMinTick>=this.mMaximum){this.mMaximum=AH.mMinTick+1;}AH.mStep=f.call(this,this.mMaximum,AH.mMinTick,AM.mAlwaysIncludeZero&&(AH.mMinTick<0));AI=(AM.mAlwaysIncludeZero&&(this.mMaximum<0))?0:this.mMaximum;if(X.call(this)){AH.mMaxTick=AH.mMinTick+Math.ceil((AI-AH.mMinTick)/AH.mStep)*AH.mStep;}else{AH.mMaxTick=Math.ceil(AI/AH.mStep)*AH.mStep;}if(u.call(this,AH)){return ;}AL=Math.ceil((AH.mMinTick+AH.mStep/100)/AH.mStep)*AH.mStep;AJ=Math.floor((AH.mMaxTick-AL+AH.mStep/100)/AH.mStep)+2;for(AK=0;AK<AJ-2;++AK){AH.mTicks.push(AL+AK*AH.mStep);}}function f(AX,AR,AJ){var AQ,AL;if(this.mMajorGrid.mUseManualGrid){return this.mMajorGrid.mGridInterval;}AQ=0;if(AJ){AQ=Math.max(AX,AX-AR);AQ=Math.max(AQ,-AR);}else{AQ=AX-AR;}if(AQ===0){this.mIsShown=false;return 1;}if(AQ>=1&&AQ<=4&&parseInt(AQ)===AQ){var AY=this.PrimaryMetricIndex,AM=AY.length;for(var AT=0;AT<AM;AT++){var AP=this.mChartContextPtr.mDatasetPtr,AS=AP.dataProvider,AK=AS.getSeriesCount(),AO=AS.getGroupCount(),AI=AY[AT],AN,AV;for(var AW=0;AW<AK;AW++){AN=AS.getMetricIndexForSeries(AW);if(AN===AI){AV=true;for(var AU=0;AU<AO;AU++){var AZ=AP.GetData(AW,AU);if(parseInt(AZ)!==AZ){AV=false;break;}}}if(AV){return 1;}}}}var AH=AQ;AL=1;while(AQ<1){AQ*=10;AL/=10;}while(AQ>=10){AQ/=10;AL*=10;}if(AQ<1.8){AL*=2;AL/=10;}else{if(AQ<3.1){AL*=4;AL/=10;}else{if(AQ<4.6){AL*=5;AL/=10;}else{if(AQ>=8.1){AL*=2;}}}}AL=this.postProcessStep(AL,AH);return AL;}function u(AH){if(this.mChartContextPtr.mIsGraphMatrix){return false;}var AI=this.mMajorGrid;return AI.mUseManualGrid&&(AI.mGridInterval<(AH.mMaxTick-AH.mMinTick)/30);}function i(AH){return Math.log(AH)/Math.log(10);}function X(){return(this.mGraphMajorType===d.GMT_HISTOGRAM||this.mGraphMajorType===d.GMT_POLAR)&&this.mTripleId.mObjectId===x.DssGraphX1Body;}function z(AK){var AL=this,AH=AL.id,AJ=AK.metricId,AI=new o.ui.menus.MenuConfig();(AK.options).forEach(function(AM){if(AM!==y.EnumRefLineModelType.CONST){AI.addMenuItem(g[AM],"xt",function(){AL.toggleRefLineEnabled(AJ,AM,true);});}else{AI.addEditorMenuItem(g[y.EnumRefLineModelType.CONST],AH,function(){return new mstrmojo.ui.menus.EditorConfig({data:{},contents:[{scriptClass:"mstrmojo.ValidationTextBox",alias:"constVal",dtp:mstrmojo.expr.DTP.FLOAT,constraints:{trigger:mstrmojo.validation.TRIGGER.ONBLUR},onEnter:function(){this.validate();}}],fnOk:function(AO,AN){var AP=AN.constVal;if(AP.isValid()){AL.toggleRefLineEnabled(AJ,AM,true,AP.value);}}});});}});return AI;}function t(AJ){var AK=this,AI=AJ.metricId,AH=new o.ui.menus.MenuConfig();(AJ.options).forEach(function(AN){var AL=AN.refType,AM=g[AL]+((AL===y.EnumRefLineModelType.CONST)?("-["+I.toLocaleString(AN.c)+"]"):"");AH.addMenuItem(AM,"xt",function(){AK.toggleRefLineEnabled(AI,AL,false,0,AN.modix);});});return AH;}function AE(AL,AH){var AK=AL.GMController,AI=AK.getForbiddenShapeForMetric(AH),AJ=[];[{text:mstrmojo.desc(12097,"Bar"),value:AD.BAR},{text:mstrmojo.desc(2059,"Line"),value:AD.LINE},{text:mstrmojo.desc(9738,"Area"),value:AD.AREA},{text:mstrmojo.desc(12100,"Circle"),value:AD.CIRCLE},{text:mstrmojo.desc(12101,"Square"),value:AD.SQUARE},{text:mstrmojo.desc(12102,"Tick"),value:AD.TICK}].forEach(function(AM){if(AI.indexOf(AM.value)<0){AJ.push(AM);}});if(AK.chartType===mstrmojo.gm.EnumGraphType.BAR||AK.chartType===mstrmojo.gm.EnumGraphType.LINE){AJ=AJ.filter(function(AM){return AM.value!==AD.AREA;});}return AJ;}function q(AI,AH){return function(AK,AJ){if(AK!==AJ){AH({ctxt:{sp:AK,mid:AI}});}};}function AF(AK){var AI=AK.options,AH=this.getMenuHandler("changeShape"),AJ=new mstrmojo.ui.menus.MenuConfig();AJ.addRadioMenuGroup(AK.currValue,q(AK.metricId,AH),AI,"checkMark",undefined,true);return AJ;}mstrmojo.gm.GMUtility=mstrmojo.provide("mstrmojo.gm.GMUtility",{mTimers:[],mUseTimer:true,timerId:0,timerHistory:[],timerHistoryMax:50,startTimer:function R(AI){if(this.mUseTimer){var AH=this.timerId++;this.mTimers.push({timeStamp:new Date(),timerId:AH,desc:AI.functionName+": "+AI.purpose});return AH;}},endTimer:function G(AL,AN){if(this.mUseTimer){var AI,AJ=this.mTimers,AO=0;if(AL===undefined){AI=AJ.pop();}else{var AM,AP;for(AM=0;AM<AJ.length;AM++){AP=AJ[AM];if(AP.timerId===AL){AI=AP;AJ.splice(AM,1);AM--;}}}if(AI){var AH=new Date();var AK=(AH-AI.timeStamp);if(AN){this.timerHistory[this.timerId%this.timerHistoryMax]={desc:AI.desc,duration:AK,start:AI.timeStamp.getTime(),end:AH.getTime()};}H.visPrint("%c"+AI.desc+": "+AK+"ms","color: blue");AO=new Date()-AI.timeStamp;}return AO;}},computeTicksForPercentchart:function(AI,AH,AJ){return C(AI,AH,false,AJ);},computeTicksForFlexMinMax:function(AI,AH,AJ,AK){return C(AI,AH,AJ,AK);},formatNumber:function(AJ,AI,AH){return AA(AJ,AI,AH===undefined?3:AH);},sizeCalculator:{sum:function(AH,AL,AM){var AJ,AI=0,AK=0;if(AM===undefined){AM=AH.length;}AL=AL||1;for(AJ=0;AJ<AM;AJ++){if(AH[AJ]>0){AK+=AH[AJ];AI+=1;}}if(AI>1){AK+=(AI-1)*AL;}return AK;},add:function(AJ,AH,AI){AI=AI||1;if(AH>0){AJ+=(AH+AI);}return AJ;},minus:function(AJ,AH,AI){if(AH>0){AJ-=(AH+AI);}return AJ;}},replaceSpecialChars:function(AH){return AH.replace(/&/g,"&amp;").replace(/</g,"&lt;").replace(/>/g,"&gt;").replace(/"/g,"&quot;");},restoreSpecialChars:function(AH){return AH.replace(/&nbsp;/g," ").replace(/&lt;/g,"<").replace(/&gt;/g,">").replace(/&quot;/g,'"').replace(/&#039;/g,"'").replace(/&amp;/g,"&");},removeExtraSpace:function(AH){return AH.replace(/ {2,}/g," ");},stringToJSON:function(AH){if(AH===undefined){return undefined;}if(typeof AH==="string"){AH=AH.replace(/'/g,'"');try{return JSON.parse(AH);}catch(AI){return AH;}}return AH;},everythingToString:function(AI){if(AI===undefined){return undefined;}var AH;if(typeof AI==="object"){AH=JSON.stringify(AI.jsonObj||AI);}else{AH=AI.toString();}AH=AH.replace(/"/g,"'");return AH;},compareElementObj:function(AL,AI){var AK=AL.tid.toString(),AH=AI.tid.toString(),AM=AL.eid,AJ=AI.eid;if(AK!==AH){return AK>AH?1:-1;}if(AM===AJ){return 0;}return AM>AJ?1:-1;},isEqualComb:function(AI,AH){var AM=true,AL,AK=AI.length,AJ=AH.length;if(AK!==AJ){return false;}if(AI.length>1){AI.sort(this.compareElementObj);}if(AH.length>1){AH.sort(this.compareElementObj);}for(AL=0;AL<AK;AL++){if(this.compareElementObj(AI[AL],AH[AL])!==0){AM=false;break;}}return AM;},serializeCombination:function(AI){var AH="";if(AI.length>1){AI.sort(this.compareElementObj);}p.forEach(AI,function(AJ){if(AH!==""){AH+=w;}AH+=(AJ.tid+k+AJ.eid);});return AH;},deserializeCombination:function(AI){var AJ=AI.split(w),AH=[];p.forEach(AJ,function(AN){var AK=AN.split(k);var AM=AK[0];var AL=AK[1];AH.push({tid:AM,eid:AL});});return AH;},getElementCombinationForMetric:function(AH){var AI=[];AI.push({tid:-1,eid:AH});return AI;},getResolvedFormatsObject:function(AH){return Y(AH);},isDigitalArrayEqual:function(AI,AH){return m.call(this,AI,AH);},indexOf:function(AI,AK){var AJ,AH=AI.length;for(AJ=0;AJ<AH;AJ++){if(m(AI[AJ],AK)){return AJ;}}return -1;},parseAxisScaleData:function(AL){var AJ,AM,AI,AH=AL.split(","),AK=[];for(AJ=0,AM=AH.length;AJ<AM;AJ++){AI=AH[AJ].split(":");AK.push(AI);}return AK;},parseCSSColor:function(AL,AI){var AK=AL.slice(1),AH=[],AJ;if(AK.length===6){if(AI===true){AH[0]=AK[4];AH[1]=AK[5];AH[2]=AK[2];AH[3]=AK[3];AH[4]=AK[0];AH[5]=AK[1];}else{for(AJ=0;AJ<6;AJ++){AH[AJ]=AK[AJ];}}}else{if(AI===true){for(AJ=2;AJ>=0;AJ--){AH.push(AK[AJ]);AH.push(AK[AJ]);}}else{for(AJ=0;AJ<3;AJ++){AH.push(AK[AJ]);AH.push(AK[AJ]);}}}return parseInt("0x"+AH.join(""),16);},RGB_BRG_Switch:function(AI){var AK=(AI>>16)&255,AJ=(AI>>8)&255,AH=(AI>>0)&255;return(AH<<16)|(AJ<<8)|(AK<<0);},encodeColor:function(AI){if(AI===undefined||AI===null||AI==="transparent"||AI==="default"){return AI;}var AJ=false,AH={};if(AJ){if(typeof AI==="object"){AH.c1=this.RGB_BRG_Switch(h.encodeColor(AI.c1));AH.c2=this.RGB_BRG_Switch(h.encodeColor(AI.c2));AH.or=AI.or;return AH;}return this.RGB_BRG_Switch(h.encodeColor(AI));}if(typeof AI==="object"){AH.c1=h.encodeColor(AI.c1);AH.c2=h.encodeColor(AI.c2);AH.or=AI.or;return AH;}return h.encodeColor(AI);},checkEquality:function(AI,AH){if(typeof AI==="object"&&AI.c1!==undefined){if(AI.c1!==AH.c1){return false;}if(AI.c2!==AH.c2){return false;}if(AI.or!==AH.or){return false;}return true;}return AI===AH;},decodeColor:function(AI){if(AI===undefined||AI===null||AI==="transparent"||AI==="default"){return AI;}var AJ=false,AH={};if(AJ){if(typeof AI==="object"){AH.c1=h.decodeColor(this.RGB_BRG_Switch(AI.c1));AH.c2=h.decodeColor(this.RGB_BRG_Switch(AI.c2));AH.or=AI.or;return AH;}return h.decodeColor(this.RGB_BRG_Switch(AI));}if(typeof AI==="object"){AH.c1=h.decodeColor(AI.c1);AH.c2=h.decodeColor(AI.c2);AH.or=AI.or;return AH;}return h.decodeColor(AI);},getTrendLineToggleHandler:function(AH,AJ,AI){return function(){AH.switchOnOffTrendLineForMetric(AJ,AI);};},getTrendLineToggleState:function(AH,AI){return AH.queryTrendLineStatusForMetric(AI);},getEditTrendLineHandler:function(AH,AI){return function(){mstrApp.rootCtrl.docCtrl.selectViPanel("propertiesPanel");AH.raiseEventCMSelection(J.TREND_LINE,AI);};},getEditRefLineHandler:function(AH,AI){return function(){mstrApp.rootCtrl.docCtrl.selectViPanel("propertiesPanel");AH.raiseEventCMSelection(J.REF_LINE,AI);};},getEditAxisScaleHandler:function(AH,AI){return function(){mstrApp.rootCtrl.docCtrl.selectViPanel("propertiesPanel");AH.raiseEventCMSelection(J.AXIS_SCALE,AI);};},getEditAxisOriginHandler:function(AH,AI){return function(){mstrApp.rootCtrl.docCtrl.selectViPanel("propertiesPanel");AH.raiseEventCMSelection(J.AXIS_ORIGIN_DEFINE,AI);};},getEditLogScaleHandler:function(AH,AI){return function(){mstrApp.rootCtrl.docCtrl.selectViPanel("propertiesPanel");AH.raiseEventCMSelection(J.LOG_SCALE,AI);};},getOptionObjArr:function(AH,AJ,AL){if(!E){E=mstrmojo.gm.GMUtility;}var AI={},AK;if(AJ!==undefined){AJ=AJ.toLowerCase();if(AJ==="x1"){AJ="x";}else{if(AJ==="y1"){AJ="y";}}}if(AH.length>1||(AL&&AH.length===1)){if(AJ==="x"){AI.opt=mstrmojo.desc(11712,"Bottom Axis");AI.key="XAxis";}else{if(AJ==="x2"){AI.opt=mstrmojo.desc(11710,"Top Axis");AI.key="X2Axis";}else{if(AJ==="y"){AI.opt=mstrmojo.desc(11715,"Left Axis");AI.key="YAxis";}else{if(AJ==="y2"){AI.opt=mstrmojo.desc(11713,"Right Axis");AI.key="Y2Axis";}else{if(AJ==="z"){AI.opt=mstrmojo.desc(12090,"SizeBy");AI.key="SizeBy";}}}}}AI.optLvl=l.AXIS;AI.mos=this.getMetricFormatFromIndexArray(AH);}else{if(AH.length===1){AK=this.getMetricFormat(AH[0]);AI.opt=AK.n;AI.mos=[AK];AI.key=AK.mId;AI.comb=E.getElementCombinationForMetric(AK.mId);AI.optLvl=l.METRIC;if(AJ==="z"){AI.sizeBy=true;}}}return AI;},filterInValidMetricIndex:function(AI){var AH=[];p.forEach(AI,function(AJ){if(AJ!==a){AH.push(AJ);}});return AH;},fillBackgroundDiv:function(AI){var AH=document.createElement("div");AH.setAttribute("class","gm-bk-div");AH.style.backgroundColor="rgba(0,0,0,0)";AI.appendChild(AH);},getSubMenu:function(AM,AN,AL,AK){var AJ=AE(AM,AK),AH=AM.getMenuHandler("changeShape"),AI=AM.GMController.getOnTheFlyShapeForMetric(AK);if(AJ.length>1){AN.addSubMenuItem(mstrmojo.desc(11972,"Change Shape"),"",AM.id,AF,{currValue:AI,options:AJ,metricId:AL});}else{AN.addRadioMenuGroup(AI,q(AL,AH),AJ,"checkMark",undefined,true);}},getReferenceLineSubMenu:function(AI,AM,AN,AH){var AO=mstrmojo.gm.EnumSubtype,AL=AI.GMController.chartSubType;if(AN&&AL===AO.PERCENT){return ;}var AP=AI.id,AJ=AI.getAvailableRefLineTypes(AH)||[];if(AJ.length>0){AM.addSubMenuItem(mstrmojo.desc(13021,"Add Reference Line"),"xt",AP,z,{metricId:AH,options:AJ});}var AK=AI.getExistingRefLineOptions(AH)||[];if(AK.length>0){AM.addMenuItem(mstrmojo.desc(13659,"Edit Reference Line"),"xt",E.getEditRefLineHandler(AI,AH));AM.addSubMenuItem(mstrmojo.desc(13022,"Remove Reference Line"),"xt",AP,t,{metricId:AH,options:AK});}},reverseMapping:function n(AI){var AK={},AJ,AH=AI.length;for(AJ=0;AJ<AH;AJ++){AK[AI[AJ]]=AJ;}return AK;},longIntAnd:function(AI,AH){var AJ;if(AI===AH){return AI;}if(AI>e||AH>e){throw new Error("Operand exceeds valid data range.");}if(AI<b&&AH<b){return AI&AH;}if(AI>=b||AH>=b){if(AI<AH){AJ=AI;AI=AH;AH=AJ;}}var AL=Math.floor(AI/b),AK=Math.floor(AH/b),AN=AI-AL*b,AM=AH-AK*b;return(AN&AM)+(AL&AK)*b;},longIntOr:function(AI,AH){var AJ;if(AI===AH){return AI;}if(AI<b&&AH<b){return AI|AH;}if(AI<AH){AJ=AI;AI=AH;AH=AJ;}AJ=this.longIntAnd(AI,AH);return AH-AJ+AI;},parseNumeric:function(AH){return +AH||parseFloat(AH);},fillImageInDiv:function(AK,AJ,AI,AH){AH=AH||"gm-img";AK.innerType=AJ;if(AJ===4){AK.innerHTML="<img class="+AH+' src="'+AI+'"/>';}else{if(AJ===7){AK.innerHTML=AI;B.addClass(AK.firstChild,AH);}}},fillTextInDiv:function(AH,AQ,AS,AI,AT,AJ,AV,AL,AO){if(AI===undefined){AI=AH.offsetWidth;}if(AT===undefined){AT=AH.offsetHeight;}if(AL===undefined){AL=W.MIDDLE;}if(AO===undefined){AO=r.MIDDLE;}if(AJ===undefined){AJ=false;}AS=this.replaceSpecialChars(AS);var AP,AR,AN,AU=AJ?"gm-text-body":"gm-text-body-nowrap",AK=false,AM;AP=H.measureTextWidth(AS,AV,6);AM=H.measureTextWidth("...",AV,6);if(AP>AI&&AM>AI){return ;}AN=document.createElement("div");AN.setAttribute("class",AU);AN.setAttribute("type",AB.GM_TEXT_BODY);AN.identity=AQ;H.applyStyles2DomNode(AN,AV);AN.innerHTML=AS;AH.appendChild(AN);if(AJ){if(AP>AI){AR=AN.offsetHeight;}else{AR=H.measureTextHeight(AS,AV,4);}}else{AR=H.measureTextHeight(AS,AV,4);AK=AP>AI;}AP=Math.min(AP,AI);AN.style.width=AP+"px";if(AJ){AK=AN.scrollWidth>AP||AN.scrollHeight>AR;}if(AK){AN.setAttribute("title",AS);}else{AN.setAttribute("title","");}switch(AL){case W.LEFT:AN.style.left="0px";AN.style.textAlign="left";break;case W.MIDDLE:AN.style.left=((AI-AP)>>1)+"px";break;case W.RIGHT:AN.style.right="0px";AN.style.textAlign="right";break;}switch(AO){case r.TOP:AN.style.top="0px";break;case r.MIDDLE:AN.style.top=((AT-AR)>>1)+"px";break;case r.BOTTOM:AN.style.bottom="0px";break;}},updateTextColorAndAlignment:function(AH,AJ,AK){var AL=AH.firstChild,AM=AL.style,AI=AH.clientWidth,AN=AL.clientWidth,AP=AH.clientHeight,AO=AL.clientHeight;AM.left="auto";AM.right="auto";switch(AJ){case W.LEFT:AM.left="0px";break;case W.MIDDLE:AM.left=((AI-AN)>>1)+"px";break;case W.RIGHT:AM.right="0px";break;}AM.top="auto";AM.bottom="auto";switch(AK){case r.TOP:AM.top="0px";break;case r.MIDDLE:AM.top=((AP-AO)>>1)+"px";break;case r.BOTTOM:AM.bottom="0px";break;}},toggleDisplay:function(AI,AH){if(!AI){return ;}if(AH){AI.style.display="block";}else{AI.style.display="none";}},isTrendLineAvailableForMetric:function(AL,AM,AP){var AW=AL&&AL.excludeData,AT=mstrmojo.gm.EnumSubtype,AO=o.gm.EnumShape,AU=AL.GMController,AQ=AU.chartSubType,AV=AL.model.data.dz,AJ=AV.XAxis,AH=AV.YAxis,AK=AV.BreakBy,AN=AV.SliceBy,AR=AP,AI=AU.getChartInfo(),AS=AU.getBreakByAttrsID().length>0||(AI.isABL&&((AJ.MetricNames!==undefined)||(AH.MetricNames!==undefined)||(AK.MetricNames!==undefined)||(AN.MetricNames!==undefined)));if(AR===undefined){AR=AU.getOnTheFlyShapeForMetric(AM);}if(AI.isABL&&AQ===AT.PERCENT){AW=true;}if(AS&&!AI.isBubbleOrScatter&&(AR===AO.BAR||AQ===AT.STACKED||(AQ===AT.AUTO&&AR===AO.AREA))){AW=true;}if(AI.isABL){if(AJ.TemplateUnit&&AJ.TemplateUnit.length>1){AW=true;}if(AH.TemplateUnit&&AH.TemplateUnit.length>1){AW=true;}if(AJ.TemplateUnit===undefined&&AH.TemplateUnit===undefined){AW=true;}}AW=AW||this.isIgnoredMetric(AL,AM);return !AW;},isTrendLineAvailableForAnyMetric:function(AJ){var AI=AJ.model.data.gsi.mx,AH;for(AH in AI){if(this.isTrendLineAvailableForMetric(AJ,AH)){return true;}}return false;},isIgnoredMetric:function(AK,AI){var AJ=AK.GMController,AL,AH;if(AJ.bubbleSeriesNum!==undefined){AL=AJ.getMetricsOnYAxis();AH=AL.indexOf(AI);if(AH>=AJ.bubbleSeriesNum){return true;}AL=AJ.getMetricsOnXAxis();AH=AL.indexOf(AI);if(AH>=AJ.bubbleSeriesNum){return true;}}return false;},getAxisMetricsInfo:function(AM){var AH=AM.model.data.dz,AN=AM.model.data.gsi.mx,AI,AJ,AL=[];if(!AH||!AH.ColorBy||!AN){return AN;}var AK=function(AO){return(AO&&AO.TemplateMetric)||[];};AI=AK(AH.YAxis).concat(AK(AH.XAxis));p.forEach(AN,function(AO){AJ=false;p.forEach(AI,function(AP){if(AO.did===AP.id){AJ=true;return false;}});if(AJ){AL.push(AO);}});return AL;},isInvalidTemplate:function O(AK){if(AK.eg){return false;}var AI=AK.gts;var AH=AI.row.length===0&&AI.col.length===0;p.forEach(AI.row,function(AN){if(AN.otp===-1){AH=true;}});var AM=AI.col;if(AM.length>0){var AJ,AL=AM.length-1;for(AJ=0;AJ<AL;AJ++){if(AM[AJ].otp===-1){AH=true;}}}return AH;},isNoData:function(AH){return AH.eg!==undefined;},getInvalidTemplateErrMsg:function(AH){return AH||mstrmojo.desc(12094,"The Graph Matrix requires:")+"\n"+mstrmojo.desc(12095,"- at least one attribute to be placed on the row or column axis")+"\n"+mstrmojo.desc(12096,"- all metrics to be placed on the column axis, below any attributes");},initColorPickerBtnWithGradientDir:function(AI,AJ){mstrmojo.func.override({showPickerForCurrentMode:function AH(){this._super();if(this.pickerMode===2&&typeof this.color!=="object"){var AK=this.gradientOrientation,AL=AJ.getChartInfo().dirc===mstrmojo.gm.EnumABLDirection.VERTICAL;AK.set("selectedIndex",p.find(AK.items,"id",AL?0:1));}}},AI.colorPicker);},generateToolTipContent:function(AQ,AL,AH,AM,AO,AN,AT){var AK,AI,AJ,AP,AR,AS;for(AK=AQ;AK<AL;AK++){AI=AM[AK];AP=AO[AK];if(AK>AQ){AJ=AM[AK-1];AR=AO[AK-1];if(AI.id===AJ.id){if(AP===""){continue;}if(AI.fid===AJ.fid&&AP.idx===AR.idx){continue;}if(AI.n===""){AN[AN.length-1].v+=M+AP.n;continue;}}}if(AT){AN.push({n:AI.n,tid:AI.id,v:AP.n});}else{AS=AH===undefined?AI.isRowAttribute:AH;AN.push({n:AI.n,tid:AI.id,v:AP.n,eid:AP.id,tp:AI.otp,axis:AS?1:2,tui:AI.tui,ui:AI.tui,dpt:AI.tui+1,at:AP.at,isRowAttribute:AS,dei:AP.dei,o:AP.o});}}},getAttributeFormCnt:function(AH){var AI;if((AH.fcnt===undefined||AH.fcnt===null)&&AH.fs){AH.fcnt=AH.fs.length||1;}if(AH.fcnt!==undefined&&AH.fcnt!==null){AI=AH.fcnt;}else{if(AH.t===47){AI=1;}else{AI=AH.cs!==undefined?AH.cs:AH.rs;}}return AI;},isTrueForBoolValue:function(AH){return AH===true||AH==="true";},computeTicksForAxis:function(AK,AI){var AJ=AK.mOptions,AL,AH={mTicks:[]};if(AI){AL=Q.copy(AJ);Q.copy(AI,AL);}else{AL=AJ;}if(AK.mIsPercent){U.call(AK,AH,AL);return AH;}if(AL.mUseLogarithmicScale){P.call(AK,AH,AL);return AH;}if(AK.mGraphMajorType===d.GMT_BUBBLE&&AK.mTripleId.mObjectId===x.DssGraphZBody){AH.mMinTick=AL.mUseMinValue?AL.mAxisMinValue:AK.mMinimum;AH.mMaxTick=AL.mUseMaxValue?AL.mAxisMaxValue:AK.mMaximum;if(AK.mMinTick>=AK.mMaxTick){AH.mMaxTick=AH.mMinTick+1;}return AH;}if(!AL.mUseMaxValue&&!AL.mUseMinValue){s.call(AK,AH,AL);}else{if(AL.mUseMaxValue&&AL.mUseMinValue){D.call(AK,AH,AL);}else{if(AL.mUseMaxValue){F.call(AK,AH,AL);}else{j.call(AK,AH,AL);}}}return AH;},computeTicksForLogScale:function(AJ){var AI=AJ.mOptions,AH={mTicks:[]};P.call(AJ,AH,AI);return AH;},destroyDisposable:function(AH,AI){if(AI){p.removeItem(AH.disposables,AI);AI.destroy();}},handleDestroy:function(AL,AK,AI){if(!AL){return ;}var AM,AJ=0,AH=AL.disposables,AN=(AH&&AH.length)||0;while(AJ<AN){AM=AH[AJ];if((!AM.scriptClass||AK.indexOf(AM.scriptClass)<0)&&p.indexOf(AI,AM.id)===-1){this.destroyDisposable(AL,AM);}if(AH.length<AN){AN=AH.length;}else{AJ++;}}}});}());(function(){mstrmojo.requiresCls("mstrmojo.string","mstrmojo.dom","mstrmojo.array","mstrmojo.css","mstrmojo.hash","mstrmojo.VisEnum","mstrmojo.VisUtility","mstrmojo.gm.GMUtility","mstrmojo.color","mstrmojo.ui.menus.EditorConfig","mstrmojo.ui.menus.ToolbarEditorConfig","mstrmojo.vi.ui.editors.EditorGroup","mstrmojo.ui.editors.controls.LineConfigGroup","mstrmojo.ui.editors.controls.FillConfigGroup","mstrmojo.ui.editors.controls.ColorPickerButton","mstrmojo.ui.editors.controls.CharacterGroup","mstrmojo.ui.editors.controls.AdvancedColorPicker");var a=mstrmojo,I=a.dom,K=a.hash,b=a.array,A=a.css,j=a.VisEnum.ControlType,i=mstrmojo.gm,F=mstrmojo.color,V=i.GMUtility,R=a.VisUtility,k=i.FormatingPropertyTag,f=mstrmojo.models.FormatModel,d=f.ENUM_PROPERTY_NAMES,P=mstrmojo.chart.enums.EnumFontStyle,g=mstrmojo.VisEnum.GMLegendFormatingPropertyTag,G=mstrmojo.VisEnum.NetworkLegendFormattingCategory,W=mstrmojo.ui.editors.controls.AdvancedColorPicker,X={GLOBAL:"glb",FORMATTING:"fmt"},D={FONT_COMP:"FntCmp",FONT_FAMILY:"FntFml",FONT_STYLE:"FntStyle",FONT_SIZE:"FntSz",FONT_COLOR:"FntClr",LINE_COMP:"LnCmp",SHOW:"Shw",COLOR:"Clr",STYLE:"Style",THICKNESS:"Thk"};function N(r,o){var n=this.widget,p=n.domToolbarPH,q=this;n._lastOpened=null;p.innerHTML="";document.body.appendChild(p);A.toggleClass(p,mstrApp.getThemeClassName(),true);this.configureLegendPopup(o,p);n.toolEditor=o.newInstance({unrender:function(){}});n.toolEditorClosefn=function(s){var u=s.target,t=n.toolEditor.domNode;if(!I.contains(t,u,true,t)&&!R.isHostedPopupNode(u,"class",true,document.body)){q.hideToolbar();}};I.attachEvent(document.body,"mousedown",n.toolEditorClosefn,true);n.openPopup(this.widget.toolEditor);A.toggleClass(document.body,"hasToolbarPopup",true);}function L(o,n){var p;if(n===X.GLOBAL){p=this.readGlobalProperty(o);}else{if(n===X.FORMATTING){p=this.widget.getPropertiesOfFormatable();}}if(o.slice(-3)===D.COLOR){if(o!==k.COLOR_SQUARE_COLOR||n!==X.GLOBAL){p=V.decodeColor(p);}}return p;}function Q(o,n){var p=this;if(n===X.GLOBAL){return function(r){var q=L.call(p,o,X.GLOBAL);if(o===k.COLOR_SQUARE_COLOR){q=q.color;}if(!K.equals(r,q)){if(o.indexOf(D.COLOR)!==-1){r=V.encodeColor(r);}p.writeGlobalProperty(o,r);}};}return function(s,q){var r=L.call(p,o,X.FORMATTING);if(s!==r){if(o.indexOf(D.COLOR)!==-1){s=F.encodeColor(s);}p.widget.writeFormatableProperties(o,s,q);}};}function O(o,n){o=o||[];n=n||"";b.forEach(o,function(p){p.cssDisplay="inline-block";});return{scriptClass:"mstrmojo.HBox",cssClass:n,children:o};}function e(o,p){o=o||[];var n=new mstrmojo.Box({children:o,cssText:p});return n;}function B(r,s,n){var q="white-space: nowrap; width: 50px;";if(r===mstrmojo.desc(3905,"Background")||r===mstrmojo.desc(6242,"Color")){q="white-space: nowrap;";}else{if(r===mstrmojo.desc(2885,"Fill")){q="white-space: nowrap; margin-right: 9px;";}}var o=new mstrmojo.Label({text:r}),p=e(o,q);return O([p,s],n);}function c(o,p,n){var q=this;o=o||{};if(o.propNames===undefined){o.propNames=p;}o.onGroupValueChange=function(r,t,s){if(t!==s&&t!==undefined){(Q.call(q,r,n))(t,s);}};return o;}function S(p,o,n){var q=this;b.forEach(o,function(r){var s=L.call(q,r,n);if(s!==undefined){p.setChildValue(r,s);}});}function C(n,q,p,o){o=c.call(this,o,q,p);K.copy({width:"140px",height:"22px",colorPickerHostWithin:true},o);var r=new mstrmojo.ui.editors.controls.FillConfigGroup(o);if(r){r.iniChildrenComp(q);S.call(this,r,q,p);}if(typeof n==="string"){return B(n,r,(o||[]).rowContainerCSSClass);}return r;}function Z(p,o,n){return new mstrmojo.ui.menus.ToolbarEditorConfig({contents:[{scriptClass:"mstrmojo.Box",cssClass:"mstrmojo-ui-ToolBoxBackgroundFill",children:[C.call(this,mstrmojo.desc(2885,"Fill"),p,o,K.copy({rowContainerCSSClass:"mstrmojo-ui-rowContainer"},n))]}]});}function l(r,p,t,s,o){var q=L.call(this,t,s),u=this;var n=new mstrmojo.ui.editors.controls.ColorPickerButton({isHostedWithin:true,width:"40px",selectedValue:q,showNoFill:false,postselectedValueChange:function(w){(Q.call(u,t,s))(w.value,w.valueWas);}});if(r){n.alias=r;}if(typeof p==="string"){return B(p,n);}return n;}function m(o){var n;if(o.listenToUpdateColorMap instanceof Function){n=o.listenToUpdateColorMap(function(){o.raiseEvent({name:"colorByColorChange",type:"invalidateCache"});if(n&&o.detachUpdateColorMapListener instanceof Function){o.detachUpdateColorMapListener(n);}});}}function h(p,o){var n=L.call(this,p,o),q=this;return new mstrmojo.ui.menus.ToolbarEditorConfig({cssClass:"cbsquare-colorpicker",contents:[new mstrmojo.ui.editors.controls.AdvancedColorPicker({showAutomatic:!n.isDefaultColor,color:n.color,colorChanged:function(r){r=(this.showAutomatic&&r===W.VAL_AUTOMATIC)?"default":r;m(q.widget);(Q.call(q,p,o))(r,n.color);q.hideToolbar();},colorCanceled:function(){q.hideToolbar();}})]});}function U(t,o){var n={},s=L.call(this,o+D.FONT_STYLE,X.GLOBAL),q=L.call(this,o+D.FONT_COLOR,X.GLOBAL),p=L.call(this,o+D.FONT_FAMILY,X.GLOBAL),r=L.call(this,o+D.FONT_SIZE,X.GLOBAL);if(s!==undefined){n[d.FONT_WEIGHT]=(!isNaN(s)&&((s&P.FS_BOLD)>0));n[d.FONT_STYLE]=(!isNaN(s)&&((s&P.FS_ITALIC)>0));n[d.UNDERLINE]=(!isNaN(s)&&((s&P.FS_UNDERLINE)>0));n[d.LINE_THROUGH]=(!isNaN(s)&&((s&P.FS_STRIKETHROUGH)>0));}if(q!==undefined){n[d.COLOR]=q;}if(r!==undefined){n[d.FONT_SIZE]=r;}if(p!==undefined){n[d.FONT_FAMILY]=p;}t.setFormatSource(n);}function H(o,n){var p=null;if(n.indexOf(D.FONT_FAMILY)!==-1){p=o.fontFamily;}else{if(n.indexOf(D.FONT_STYLE)!==-1){p=o.fontStyle;}else{if(n.indexOf(D.FONT_SIZE)!==-1){p=o.fontSize;}else{if(n.indexOf(D.FONT_COLOR)!==-1){p=o.fontColor;}}}}return p;}function M(q,p,n){var o={bold:P.FS_BOLD,italic:P.FS_ITALIC,underline:P.FS_UNDERLINE,strikeout:P.FS_STRIKETHROUGH},r=this;p.forEach(function(s){var t=H(q,s);if(t){t.propName=s;if(s.indexOf(D.FONT_STYLE)!==-1){t.postselectionChange=function(u){var y=u.added,z=t.items[(y&&y[0]!==undefined)?y[0]:u.removed[0]],x=!!y,w=L.call(r,s,n),AA=(w===undefined?0:w);if(x){AA=AA|o[z.css];}else{AA=AA&(~o[z.css]);}t.parent.raiseFormatValueChange(s,AA,w);};}else{if(s.indexOf(D.FONT_FAMILY)!==-1){t.postselectedIndexChange=function(u){var y=u.value,x=u.valueWas;if(y!==x){var w=t.items;t.parent.raiseFormatValueChange(s,w[y].id,w[x]&&w[x].id);}};}else{if(s.indexOf(D.FONT_SIZE)!==-1){t.postselectedValueChange=function(u){var x=parseInt(u.value,10)+"pt",w=parseInt(u.valueWas,10)+"pt";if(x!==w){t.parent.parent.raiseFormatValueChange(s,x,w);}};}else{t.postselectedValueChange=function(u){t.parent.parent.raiseFormatValueChange(s,u.value,u.valueWas);};}}}}});}function Y(o,r,q,p){var u=this;p=p||{};if(p.propNames===undefined){p.propNames=r;}if(p.onGroupValueChange===undefined){p.onGroupValueChange=function(w,y,x){if(y!==x&&y!==undefined){(Q.call(u,w,X.GLOBAL))(y,x);}};}var n={cssClass:"mstrmojo-ui-ToolbarCharacter cf",layoutConfig:null,width:"397px",height:"22px"};p=K.copy(n,p);var t=new mstrmojo.ui.editors.controls.CharacterGroup(p),s=H(t,k.LEGEND_FONT_COLOR);s.showNoFill=false;M.call(this,t,r,q);U.call(this,t,o);return t;}function J(r,q){var w=q.firstChild,AA=w?w.offsetWidth:0,o=w?w.offsetHeight:0,s=document.body.offsetWidth,z=document.body.offsetHeight,t=10,u=5,y=5;if(w){w.style.left="0";w.style.right="auto";w.style.top="0";w.style.bottom="auto";}var x={w:AA,h:0};var p=o>0;if(p){x.h=o;}else{return false;}if(p){q.style.left=r.x+"px";q.style.top=r.y-o-t/2+"px";}if(r.x+x.w>s){q.style.left=r.x-AA+"px";}if(p){var n=0;if(r.y-o-t/2<u){n=u;q.style.top=n+"px";}else{if(r.y+t/2>z){n=Math.max(z-t-o,u);q.style.top=n+"px";}}}}function E(n,q,p,o){return new mstrmojo.ui.menus.ToolbarEditorConfig({contents:[{scriptClass:"mstrmojo.vi.ui.editors.EditorGroup",showDivider:false,children:[Y.call(this,n,q,p,o)]}]});}mstrmojo._FormateVisLegend=mstrmojo.provide("mstrmojo._FormateVisLegend",{_mixinName:"mstrmojo._FormateVisLegend",widget:null,readGlobalProperty:undefined,writeGlobalProperty:undefined,configureLegendPopup:undefined,init:function(n){this.widget=null;if(this._super){this._super(n);}if(this.widget&&!this.widget.domToolbarPH){var o;o=document.createElement("div");o.setAttribute("class","gm-menu-placeholder");this.widget.domToolbarPH=o;}},handleRMCOnLegend:function(z){var s=z.getTarget(),t=z.e,x={x:t.pageX,y:t.pageY},w=s.getAttribute("type"),o,u,q,r=this,p=this.widget;z.cancel();z.preventDefault();if(mstrApp.isAppStatePresentation()||!mstrApp.allowWebDashboardDesign()||mstrApp.isInVFInteractMode){return ;}var y,n=function(AA){switch(AA){case j.LGD_COLORBOX_CTN:case j.LGD_COLORBOX:if(AA===j.LGD_COLORBOX){s=s.parentNode;}u=s.firstChild.identity;if(u&&u.comb){this.widget.colorSqureIdentity=u;this.selectColorBox(s,this.fmtMode);o=h.call(this,k.COLOR_SQUARE_COLOR,X.GLOBAL);x=this.adjustColorPickerPos(s);if(!x.alignLeft){q=o.ENUM_CORNERS;o.setAlignment(q.BOTTOM_LEFT,q.TOP_RIGHT);}}break;case j.LGD_TITLE:case j.LGD_TEXT:this.selectText(true);var AB=[k.LEGEND_FONT_SIZE,k.LEGEND_FONT_FAMILY,k.LEGEND_FONT_STYLE,k.LEGEND_FONT_COLOR];o=E.call(this,"lgd",AB,X.GLOBAL);y="lgd";break;default:this.selectLegendBody();var AC=[k.LEGEND_BG_COLOR,k.LEGEND_BG_FILL_TRANSPARENCY];o=Z.call(this,AC,X.GLOBAL);y="lgd";break;}if(o){N.call(this,x,o);if(!!y){mstrApp.rootCtrl.docCtrl.selectViPanel("propertiesPanel");p.parent.selectVIUnit();var AD=p.edtModel._targetPulldown;if(AD){AD.selectItemByField("v",y);}}}};n.call(this,w);J.call(this,x,this.widget.domToolbarPH);},hideToolbar:function(){var o=this.widget,p=o.domToolbarPH,r=p.firstChild,n=p.parentNode;if(r){p.removeChild(r);}if(n){n.removeChild(p);}var q=o.toolEditor;if(q){q.unrender=function(){q._super();};q.destroy();q.unrender=function(){};delete o.toolEditor;A.toggleClass(document.body,"hasToolbarPopup",false);A.toggleClass(p,mstrApp.getThemeClassName(),false);}if(o.toolEditorClosefn){I.detachEvent(document.body,"mousedown",o.toolEditorClosefn,true);delete o.toolEditorClosefn;}},highlightText:function(n){throw new Error("subclass need to implement highlightText function");}});}());(function(){mstrmojo.requiresCls("mstrmojo.dom","mstrmojo.css","mstrmojo.Vis","mstrmojo._HasOwnAvatar");var K=mstrmojo.css,I=mstrmojo.dom,F="px";function B(Q,P){return{x:Q.x-P.x,y:Q.y-P.y};}function M(Q,P){return(Q.x-P.x)*(Q.x-P.x)+(Q.y-P.y)*(Q.y-P.y);}function N(P){var Q=P.src.data;return(!Q||!Q.isScrollBar);}mstrmojo.VisLegend=mstrmojo.declare(mstrmojo.Vis,[mstrmojo._HasOwnAvatar],{scriptClass:"mstrmojo.gm.VisLegend",bodyCssClass:"",avatarCssClass:"legend-dragged",dropZoneHighlightCss:"legend-dropZone",ownAvatar:true,draggable:true,dropZone:true,dockedPositions:null,calculateDockedPositions:mstrmojo.emptyFn,widget:null,boundaryNode:null,draggableNodeName:"domLegend",legendMarkup:"",extrasMarkup:"",markupString:'<div id="{@id}" class="{@cssClass}" style="width:{@width}px;height:{@height}px;top:{@top}px;left:{@left}px;position:absolute;" mstrAttach:click,mouseover,mouseout><div class="gm-legend-bg"><div class="{@bodyCssClass}" style="width:{@width}px;height:{@height}px;text-decoration:inherit">{@legendMarkup}</div></div><div class="gm-anchor-point topLeft"></div><div class="gm-anchor-point topRight"></div><div class="gm-anchor-point bottomLeft"></div><div class="gm-anchor-point bottomRight"></div>{@extrasMarkup}</div>',markupSlots:{dropZoneNode:function(){return this.domNode;},domLegend:function(){return this.domNode.firstChild.firstChild;}},postBuildRendering:function(){this._super();this.calculateDockedPositions(this.widget.getWidth(),this.widget.getHeight());this.boundaryNode=this.widget.domNode;this.boundaryPosition=I.position(this.boundaryNode,true);},createAvatar:function D(){return this[this.draggableNodeName];},updateDropZoneNode:function C(R){var P=this.dockedPositions;if(P&&P.length>0){var X=B(R.tgt.pos,this.boundaryPosition);var V=M(X,P[0]),U=0,Q,W;for(Q=1;Q<P.length;Q++){W=M(X,P[Q]);if(W<V){V=W;U=Q;}}if(U!==this.currDockedPositionIdx){var S=this.dropZoneNode.style;S.left=P[U].x+F;S.top=P[U].y+F;if(this.widget.onLegendDropZoneChange){this.widget.onLegendDropZoneChange(P[U],U);}this.currDockedPositionIdx=U;this.updateAlignClass();return true;}}return false;},toggleDropZoneBorder:function O(P){K.toggleClass(this.dropZoneNode,this.dropZoneHighlightCss,P);},isDragValid:N,ondragstart:function E(P){if(!N(P)){return ;}this._super(P);this.toggleDropZoneBorder(true);},ondragmove:function A(P){if(!N(P)){return ;}this.updateDropZoneNode(P);this._super(P);},allowDrop:function H(P){var R=P.src,Q=R&&R.widget;return(Q&&Q!==this&&Q.parent===this.parent);},ondrop:function J(R){var P=this.domLegend;K.removeClass(P,this.avatarCssClass);var S=P.style;S.left="0";S.top="0";this.dropZoneNode.firstChild.appendChild(P);if(this.widget.onLegendDropped){var Q=this.getDockedPosition();this.widget.onLegendDropped(Q&&Q.pos);}R.dropSuccessful=true;},getDockedPosition:function G(){return this.dockedPositions&&this.dockedPositions[this.currDockedPositionIdx];},ondragend:function A(P){if(!N(P)){return ;}this._super(P);if(!P.dropSuccessful){this.ondrop(P);}this.toggleDropZoneBorder(false);},positionAvatar:function L(V){var R=this,Q=this.avatar,S=Q.style,U=this.boundaryPosition;var P=function(W,X){if(W==="x"){if(X<U.x){return U.x;}return Math.min(X,U.x+U.w-R.domNode.offsetWidth);}if(W==="y"){if(X<U.y){return U.y;}return Math.min(X,U.y+U.h-R.domNode.offsetHeight);}};S.left=P("x",V.x)+F;S.top=P("y",V.y)+F;}});}());(function(){mstrmojo.requiresCls("mstrmojo.dom","mstrmojo.css","mstrmojo.VisEnum","mstrmojo.VisLegend","mstrmojo.VisUtility","mstrmojo.gm.GMEnums","mstrmojo.gm.GMIdentities","mstrmojo.gm.GMUtility","mstrmojo.array","mstrmojo.string","mstrmojo.hash","mstrmojo._FormateVisLegend","mstrmojo.ui._HasScroller");var Aj=mstrmojo,Af=Aj.gm,AC=Aj.dom,Ae=Aj.css,S=Aj.hash,AQ=Aj.VisUtility,b=Af.GMUtility,P=mstrmojo.array,Z=mstrmojo.string,AD=mstrmojo.ui.editors.controls.AdvancedColorPicker,g=Af.ColorSquareIdentity,C=Aj.VisEnum.ControlType,k=Af.EnumLegendSlot,AO=Af.EnumDockPosition,o=Af.EnumLegendSlot,AI=Af.EnumIdentityType,AG=Af.EnumShape,Aa=Aj.VisEnum.GMLegendDataType,J=mstrmojo.desc(13966,"Size by:"),y="px",F=1.35,a=0.75,X=5,K=20,m=K,AH=5,A=5,z=16,f=15,H=16,AL=20,G=150,t=15,Ah=1,AB="setAttribute",l=3,i=2,Q=8,s=15,AV=14,w=1,R=2,h=4,Ak=8,Ai=16,L=10,AX=3,AM=50,AS=-3,u=5,AT="gm-legend-lock-icon",AP=mstrmojo.desc(14442,"This metric has its axis scale set to custom min and max values"),O="http://www.w3.org/2000/svg",x="\u2026",N=/[ \-]/;function AU(Aq,As,Al,At){if(!Aq){return ;}var An,Aw,Ao,Av,Ar=Aq.style,Ax=As===AO.TOP,Am=As===AO.BOTTOM,Au=As===AO.LEFT,Ap=As===AO.RIGHT;if(Ax||Am){An=Al;Aw=1;Ao=-1;Av=AS;if(Am){Av+=At;}}else{if(Au||Ap){An=1;Aw=At;Av=-1;Ao=AS;if(Ap){Ao+=Al;}}}Ar.cssText="left:"+Ao+y+";top:"+Av+y+";width:"+An+y+";height:"+Aw+y+";";if(mstrApp.isInVFInteractMode){Ar.cursor="default";}}function I(Am){var Al=String(Am);return Al.indexOf(" ")>=0||Al.indexOf("-")>=0;}function Y(An,Am,Ao){var Al=typeof An==="string"?b.restoreSpecialChars(An):An;return AQ.measureTextWidth(Al,Am,Ao);}function AK(Ap,Ao,Am,Al){var An=Y(Ao,Am,L);Ap.setAttribute("measureWidth",An);if(An>Al){An=Al;}else{Ap.style.overflow="visible";}Ap.setAttribute("displayWidth",An);Ap.style.width=An+y;return An;}function Ag(An,Am){var Al;if(parseInt(An.getAttribute("measureWidth"))>Am){Al=parseInt(An.style.maxHeight);}else{Al=parseInt(An.style.lineHeight);}return Al;}function B(Am){var Al;if(Am.textContent&&typeof (Am.textContent)!==undefined){Al=Am.textContent;}else{Al=Am.innerText;}return Al;}function c(An){var Am=An.getAttribute("measureWidth"),Al=An.getAttribute("displayWidth");if(!Am){An[AB]("title","");}Am=parseFloat(Am,10);Al=parseFloat(Al,10);if((Am-Al)>0.1){An[AB]("title",B(An));}else{An[AB]("title","");}}function AN(Ap,Al,Am,Ao){var An=document.createElement("div");An[AB]("class","gm-legend-underLine");An.style.width=Ao-L+y;An.style.left=Al+5+y;An.style.top=Am+y;Ap.appendChild(An);}function AZ(Ao,Al,Am){var An=document.createElement("div");An[AB]("class","gm-legend-underLine-anchorPoint");An.style.left=Al+y;An.style.top=Am-3+y;Ao.appendChild(An);}function AJ(Ao,Al,Am,An){AN(Ao,Al,Am,An);AZ(Ao,Al,Am);}function n(An,Ay,Au,As,Aw){var At,Ao,Av,Al,Ax=b.restoreSpecialChars(An.innerHTML),Ar=Ax.length,Ap=0,Am=Ar,Aq=false;if(An.scrollHeight>1.5*H){At=Y(An.innerHTML,Ay,L);Ao=At-Au+L;if(Ao>Aw){while((Am-Ap)>1){Av=(Ap+Am)>>1;Al=Ax.substring(0,Av)+x;At=Y(Al,Ay,L);Ao=At-Au+L;if(Ao>Aw){Am=Av;}else{Ap=Av;}}An.innerHTML=Z.encodeHtmlString(Ax.substring(0,Ap)+x,true);An[AB]("title",Ax);Aq=true;At=Y(An.innerHTML,Ay,L);Ao=At-Au+L;}AN(An,0,As+H,(Ao<Aw)?Ao:Aw);}if(Au>Aw){An[AB]("title",Ax);}else{if(!Aq){An[AB]("title","");}}}function AA(Al,Au,Aq,Am,At,Av){var An,Ap,Ar,As,Ao=document.createElement("div");Ao[AB]("class","gm-legend-textcell");Ao[AB]("type",C.LGD_TEXT);Ao.style.lineHeight=f+y;if(At){As=AK(Ao,Au,Av,At);}if(Am&w){An=(AL+AV)/2+Aq*AL;Ar=z;}else{An=(t+AV)/2+Aq*t;if(Am&Ak){if(Am&Ai){Ar=0;}else{Ar=s;}}else{if(Am&h){Ar=Q;}else{Ar=0;}}}Ap=As||s+L;Ao.innerText=Au;Ao.identity={objType:AI.LEGEND_TEXT};AJ(Al,Ar,An,Ap);this.textDivs.push(Ao);Al.appendChild(Ao);}function Ac(Al,Ao){var Am,Aq,Ap,An=0;if(Al){Ap=Al.elements;for(Am=0,Aq=Ap.length;Am<Aq;Am++){An=Math.max(An,Y(Ap[Am].label,Ao,L));}An+=z+A*2+AX;}return An;}function W(Ao,An){var Ar,Al,Aq,Ap=Ao.items,Am=0;if(!Ap){return 0;}Ar=Ap.length;Aq=Ao.custMetrics;for(Al=0;Al<Ar;Al++){if(Aq&&Aq.indexOf(Ap[Al])!==-1){Am=Math.max(Am,Y(Ap[Al],An,L)+Q);}else{Am=Math.max(Am,Y(Ap[Al],An,L));}}return Am;}function AR(Ao,An){var Al,Aq,Ap,Am=0;if(Ao){Ap=Ao.elements;Aq=Ap.length;if(Ao.caseFlag===1){Am=W(Ao,An);}else{if(Ao.caseFlag===0){for(Al=0;Al<Aq;Al++){Am=Math.max(Am,Y("Max: "+Ap[Al].v,An,L));}Am+=t*l;Am=Math.max(Am,W(Ao,An));}else{if(Ao.caseFlag===2){for(Al=0;Al<Aq;Al++){Am=Math.max(Am,Y(Ap[Al].v,An,L));}Am+=t*Aq+s;Am=Math.max(Am,W(Ao,An));}else{if(Ao.caseFlag===3){for(Al=0;Al<Aq;Al++){Am=Math.max(Am,Y(Ap[Al].v,An,L));}Am+=t*u;}}}}Am=Math.max(Am,Y(J,An,L));Am+=A*3;}return Am;}function e(Aw,Ao,A0){if(!Aw||!Aw.length||Aw.length<1){return 0;}var Ap,Am,Az,Al,As,Av,Ar,Au,At,An,Aq,Ay=m+2*Ah,Ax=Ay;for(Ap=0;Ap<Aw.length;Ap++){Ar=Aw[Ap];if(Ar.dataType===Aa.COLOR_BY){Au=Ar.dataObj;if(Au){An=2*AH+H;Az=b.removeExtraSpace(Au.item);Av=Y(Az,A0,L);if((Av+2*A>Ao-2*Ah)&&I(Az)){An+=H;}Al=Au.elements;Am=Al.length;An+=A;An+=i;Al.forEach(function(A1){if(A1.bftp){Af.GMLegend.IMAGE_SIZE_FIXED=G;AL=G;}});Ay+=An+AL*Am;Ax+=An+(Am>0?AL:0);}}else{if(Ar.dataType===Aa.SIZE_BY){At=Ar.dataObj;if(At){Aq=2*AH+H;Az=b.removeExtraSpace(At.item);Av=Y(Az,A0,L);if((Av+2*A>Ao-2*Ah)&&I(Az)){Aq+=H;}As=At.caseFlag;if(As===1){Am=0;}else{if(As===0){Am=2;}else{if(At.caseFlag===2||As===3){Am=At.elements.length;}}}Am+=(At.items&&At.items.length)||0;Aq+=t*Am;Aq+=A;Aq+=i;Ay+=Aq;Ax+=Aq;}}}}return{height:Ay,minHeight:Ax};}function Ad(Al,Am){var Ao=0,An=0;P.forEach(Al||[],function(Ap){var Aq;if(Ap.dataType===Aa.COLOR_BY){Aq=Ac(Ap.dataObj,Am);if(Aq>Ao){Ao=Aq;}}else{if(Ap.dataType===Aa.SIZE_BY){Aq=AR(Ap.dataObj,Am);if(Aq>An){An=Aq;}}}});return Math.max(Ao,An)+2*Ah;}function j(Am,As,Aq,Ap){var An=e(Am,As,Ap),Al=An.height,Ar=Aq-X*2,Ao={};Ao.autoCollapse=An.minHeight>Ar;Ao.minHeight=An.minHeight;Ao.width=As;Ao.height=Math.min(Al,Ar);if(Al>Ar){Ao.cutBy=Al-Ar;}return Ao;}function E(Am,An){var Ao=Am.decodedColor||Am.color||AD.VAL_AUTOMATIC,Al;if(Ao.c1){Al=Ae.buildGradient(Ao.or,Ao.c1,Ao.c2);An.style[Ae.convertCssToCamelCase(Al.n)]=Al.v;}else{An.style.backgroundColor=Ao;}if(Am.image){An.style.backgroundImage=Am.image;}if(Am.opacity!==undefined){An.style.opacity=Am.opacity;}An.identity=new g({objType:AI.COLOR_SQUARE,parentIdentity:this.identity,token:Am.token,decodedColor:Am.decodedColor,encodedColor:Am.encodedColor,isDefaultColor:Am.isDefaultColor});}function AW(){var A0,Ax,Av,Al,Aw,A2,Am,At,Ar,Ao,A4=document,A3=this.triBtn,Az=this.closeBtn,Aq=this.cbContainer,An=this.sb1Container,Ay=this.sb2Container,As=this.cbTableContainer,Ap=null,A1=this.height-m-A-2*Ah,Au=this.width-2*A-2*Ah;A3[AB]("class","gm-legend-tri-button-collapsed");if(this.autoCollapse){A3[AB]("title",mstrmojo.desc(13682,"There is not enough space to display the legend"));}else{A3[AB]("title",mstrmojo.desc(13683,"Maximize Legend"));}Az.style.display="none";this.splitter.style.display="none";this.domNode.style.overflow="hidden";for(A0=0;this.dataArray&&A0<this.dataArray.length;A0++){Al=this.dataArray[A0];if(Al.dataType===Aa.COLOR_BY){Ap=Al.dataObj;break;}}Aq.style.display=Ap?"block":"none";An.style.display="none";Ay.style.display="none";if(Ap){Av=Ap.elements;Ax=Av.length;Aw=this.cbTitle;Aw.style.display="none";Aq.style.top=m+y;Aq.style.width=Au+y;As.style.top="0px";A2=this.cbTable;A2.innerHTML="";for(A0=0;A0<Ax;A0++){Am=A4.createElement("tr");At=A4.createElement("td");Ao=A4.createElement("div");Ar=A4.createElement("div");Ao[AB]("class","gm-legend-colorbox-ctn-div");Ao[AB]("type",C.LGD_COLORBOX_CTN);Ao[AB]("title",Av[A0].label);Ar[AB]("class","gm-legend-colorbox-div");Ar[AB]("type",C.LGD_COLORBOX);E.call(this,Av[A0],Ar);Am[AB]("class","gm-legend-tr");Am.style.height=AL+y;At[AB]("class","gm-legend-colorbox");Ao.appendChild(Ar);At.appendChild(Ao);Am.appendChild(At);A2.appendChild(Am);if(A2.offsetHeight+AL>A1){break;}}A2.style.top="0px";A2.style.marginLeft="0px";As.style.top=A+y;As.style.height=A2.offsetHeight+y;}Aq.style.height=A1+y;}function p(An,Am,Ap,Al){var Ao=document.createElementNS(O,"circle");Ao.setAttribute("cx",Am);Ao.setAttribute("cy",Ap);Ao.setAttribute("r",Al);Ao.setAttribute("class","gm-legend-sizeby-circle");An.appendChild(Ao);}function AF(An,Ao,Ar,Am,Aq,As,Ap){var Al=document.createElementNS(O,"line");Al.setAttribute("x1",Ao);Al.setAttribute("y1",Ar);Al.setAttribute("x2",Am);Al.setAttribute("y2",Aq);Al.style.strokeWidth=As;if(Ap){Al.setAttribute("class",Ap);}An.appendChild(Al);}function Ab(Am,A0){var Az,An,Ap,Aq,Ao,Al,Ay,Ar,A1,As,Aw=Math.PI,At=A0.elements,Au=At.length,Av=Au*t,Ax=Am.getContext("2d"),A2={LINE_COLOR:"#b0b0b0",MIN_WIDTH:1,MAX_WIDTH:10},A3=AQ.getPropertyByPath(this,"widget.model.data.visName")||AQ.getPropertyByPath(this,"widget.model.data.vis.vn");switch(A3){case"GraphMatrixVisualizationStyle":if(this.shapeType===AG.SQUARE||this.shapeType===AG.TICK||this.shapeType===AG.LINE||this.shapeType===AG.BAR||this.shapeType===AG.AREA||this.shapeType===AG.RECTANGLE){As="rectangle";}else{As="circle";}break;case"VIHeatMapVisualizationStyle":As="rectangle";break;default:As="circle";break;}switch(A0.caseFlag){case 0:Ax.save();if(mstrApp.getThemeClassName().indexOf("dark")>=0){Ax.strokeStyle="rgba(116, 116, 117, 0.7)";Ax.fillStyle="rgba(116, 116, 117, 0.7)";}else{Ax.strokeStyle="rgba(188, 188, 189, 0.7)";Ax.fillStyle="rgba(188, 188, 189, 0.7)";}Av=t*l;A1=Math.floor(t*0.75+0.5);An=Math.floor(A1/3.5+0.5);if(As==="circle"){Aq=A1+1;Ao=t;Ax.beginPath();Ax.arc(Aq,Ao,A1,0,2*Aw,false);Ax.fill();Ax.stroke();Aq=2*Aq+2*An;Ao=Math.floor(0.53*t+0.5);Ax.beginPath();Ax.arc(Aq,Ao,An,0,2*Aw,false);Ax.fill();Ax.stroke();}else{Aq=1;Ao=t-A1;Ax.beginPath();Ax.fillRect(Aq,Ao,2*A1,2*A1);Aq=2*A1+2+An;Ao=Math.floor(0.53*t-An+0.5);Ax.beginPath();Ax.fillRect(Aq,Ao,2*An,2*An);}Ax.translate(0.5,0.5);Ax.lineWidth=1;Ax.strokeStyle="#9C9C9C";Aq=2*A1+3*An+3;Ao=Math.floor(0.53*t+0.5);Ax.beginPath();Ax.moveTo(Aq,Ao);Ax.lineTo(Av,Ao);Ax.stroke();Aq=2*A1+2;Ao=Math.floor(1.53*t-An+0.5);Ax.beginPath();Ax.moveTo(Aq,Ao);Ax.lineTo(Aq+An,Ao+An);Ax.lineTo(Av,Ao+An);Ax.stroke();Ax.restore();break;case 1:break;case 2:Ap=parseInt(At[0].diameter,10);Ap=Math.min(Ap,Av);Ax.fillStyle="#ADADAC";Ax.strokeStyle="#ADADAC";if(As==="circle"){Aq=Av>>1;Ao=Aq;Ax.arc(Aq,Ao,Ap>>1,0,2*Aw,false);Ax.fill();Ax.stroke();}else{Aq=(Av-Ap)>>1;Ao=Aq;Ax.rect(Aq,Ao,Ap,Ap);Ax.fill();Ax.stroke();}break;case 3:Al=A2.MIN_WIDTH;Ay=(Au===1?0:(A2.MAX_WIDTH-A2.MIN_WIDTH)/(Au-1));Av=Am.width;Ar=t;Aq=0;Ao=t/2;Ax.strokeStyle=A2.LINE_COLOR;for(Az=0;Az<Au;Az++){Ax.lineWidth=Al;Ax.beginPath();Ax.moveTo(Aq,Ao);Ax.lineTo(Av-Aq,Ao);Ax.stroke();Ao+=Ar;Al+=Ay;}break;default:break;}}function AY(Am,Au){var As=1,Al,Aq=1.5*H,At=Am.innerHTML,Ar=b.restoreSpecialChars(At),An=Ar.split(N),Av,Ao;var Ap=function(Aw){Ao=Ar[Aw];return Ao!==undefined?Ao:"";};if(Am.scrollHeight>Aq){if(!An[0]){return 0;}Al=An[0]+Ap(An[0].length);while(An[As]!==undefined){Av=Al+An[As];Av+=Ap(Av.length);Am.innerHTML=b.replaceSpecialChars(Av);if(Am.scrollHeight>Aq){break;}Al=Av;As++;}Am.innerHTML=At;}else{Al=Ar;}return Y(Al,Au,L);}function d(A1,Az,A0,Av){var Ay,An,Aq,Ap,Au,Ax,At=Az.elements,Aw=At.length,As=[],A2=document,Al=A2.createDocumentFragment(),Ao=false,Ar=this.styles,Am=A0;switch(Av){case 0:if(Aw>0){As.push({v:"Min: "+At[Aw-1].v});As.push({v:"Max: "+At[0].v});Aw=2;}break;case 1:At=Az.items;P.forEach(At,function(A3){As.push({v:A3});});break;case 3:As=At;break;default:As=At;Ao=true;break;}Aw=As.length;for(Ay=0;Ay<Aw;Ay++){An=A2.createElement("tr");An[AB]("class","gm-legend-tr2");An.style.height=t+y;if(Ao){Aq=A2.createElement("td");AA.call(this,Aq,As[Ay].sign,Ay,R|Ak|Ai);Aq[AB]("class","gm-legend-sign");An.appendChild(Aq);Am-=s;}Ap=A2.createElement("td");Ap[AB]("class","gm-legend-desc");if(Az.custMetrics&&Az.custMetrics.indexOf(As[Ay].v)!==-1){AA.call(this,Ap,As[Ay].v,Ay,R|h,Am-Q,Ar);Ax=parseInt(Ap.lastChild.style.width,10);Au=A2.createElement("div");Au.setAttribute("class",AT);Au.setAttribute("title",AP);Ap.appendChild(Au);Au.style.top=(t-8)/2+Ay*t+y;Ap.lastChild.style.marginLeft=Ax+y;}else{if(Ao){AA.call(this,Ap,As[Ay].v,Ay,R|Ak,Am,Ar);}else{AA.call(this,Ap,As[Ay].v,Ay,R,Am,Ar);}}An.appendChild(Ap);Al.appendChild(An);}A1.appendChild(Al);}function V(){var An="."+AT,Al=this.domLegend.querySelectorAll(An),Am;P.forEach(Al,function(Ao){Am=Ao.parentNode;if(Am){Am.removeChild(Ao);}});}function U(){var BE,A6,BJ=0,BK,A1,A8,A2,Ao,BC,BF,As,BI,BD,Al=this.width-2*Ah,Aw=Al-2*A,Aq=document,An=this.triBtn,A7=this.closeBtn,A5=this.cbContainer,Ax=this.cbTableContainer,BL=this.sb1Container,Ar=this.sb2Container,Av,At,Ap,Au,BA,Az,A9=this.cutBy,A4=m,BG=0,A3=this.styles,BB,BH,A0=(H+AV)/2,Am,Ay;An[AB]("class","gm-legend-tri-button");An[AB]("title",mstrmojo.desc(13684,"Minimize Legend"));A7.style.display="block";A7[AB]("title",mstrmojo.desc(12002,"Hide Legend"));this.updateSplitter();V.call(this);this.domNode.style.overflow="visible";A5.style.display="none";BL.style.display="none";Ar.style.display="none";for(A6=0;this.dataArray&&A6<this.dataArray.length;A6++){At=this.dataArray[A6];BA=null;Az=null;if(At.dataType===Aa.COLOR_BY){BA=At.dataObj;if(BA){A5.style.display="block";A2=b.removeExtraSpace(BA.item);Ao=BA.elements;BE=Ao.length;A5.style.top=A4+y;A5.style.width=Aw+y;BI=0;if(BG===0){Ae.addClass(this.sepLine1,"toggleHide");BG++;}BK=this.cbTitle;BK.style.display="block";AK(BK,A2,A3,Aw);BK.innerHTML=Z.encodeHtmlString(A2,true);BI+=Ag(BK,Aw)+2*AH;Am=AY(BK,A3);n(BK,A3,Am,A0,Aw);AJ(BK,0,A0,(Am<Aw)?Am:Aw);A1=this.cbTable;A1.style.display="block";A1.style.width=(Aw-AX)+y;A1.style.marginLeft=AX+y;A1.innerHTML="";A1.appendChild(this.fillColorByTable(BA,0));BC=AL*BE+1;Ax.style.top=BI+y;A1.style.display="table";BI+=BC+A;if(A9){BI-=A9;BC-=A9;}A5.style.height=BI+y;Ax.style.height=BC+y;A4+=BI+i;}}else{if(At.dataType===Aa.SIZE_BY){Az=At.dataObj;if(Az){BJ++;if(BJ===1){Ap=BL;Au=this.sb1Title;A8=this.sb1MetricNamesTable;A1=this.sb1DataTable;Av=this.sb1Canvas;}else{Ap=Ar;Au=this.sb2Title;A8=this.sb2MetricNamesTable;A1=this.sb2DataTable;Av=this.sb2Canvas;}Ap.style.display="block";A2=b.removeExtraSpace(Az.item);Ao=Az.elements;BE=Ao.length;Ap.style.top=A4+y;Ap.style.width=Aw+y;BI=0;if(BG===0){Ae.addClass(this.sepLine2,"toggleHide");BG++;}if(Az.caseFlag===0){BF=l*t;As=2*t;}else{if(Az.caseFlag===3){BF=u*t;As=BE*t;}else{BF=BE*t;As=BF;}}BK=Au;BK.innerHTML=Z.encodeHtmlString(A2,true);BH=Az.custMetrics&&Az.custMetrics.indexOf(A2)!==-1;if(BH){Ay=Aw-Q;}else{Ay=Aw;}AK(BK,A2,A3,Ay);if(BH){BB=Aq.createElement("div");BB.setAttribute("class",AT);BB.setAttribute("title",AP);Ap.appendChild(BB);BB.style.top=(BK.offsetHeight-8)/2+AH+i+y;BB.style.left=BK.offsetWidth+"px";}Am=AY(BK,A3);n(BK,A3,Am,A0,Ay);AJ(BK,0,A0,(Am<Ay)?Am:Ay);BI+=Ag(BK,Ay)+2*AH;BD=Aw;A8.innerHTML="";if(Az.items&&Az.items.length>0){A8.style.display="block";d.call(this,A8,Az,BD,1);}else{A8.style.display="none";}A8.style.top=BI+y;A8.style.left="0"+y;A8.style.width=BD+y;BI+=A8.offsetHeight;if(BF>0){BD-=BF+A;}A1.innerHTML="";if(Az.elements&&Az.elements.length>0){A1.style.display="block";d.call(this,A1,Az,BD,Az.caseFlag);}else{A1.style.display="none";}Av.style.position="absolute";Av.style.top=BI+y;Av.style.marginLeft=A+y;A1.style.top=BI+y;A1.style.left=(BF+A)+y;A1.style.width=BD+y;BI+=As+A;Ap.style.height=BI+y;A1.style.display="table";Av.width=BF;Av.height=As;Ab.call(this,Av,Az);A4+=BI+i;}}}}}function q(){var Al,Am=this.textDivs,An=Am.length;for(Al=0;Al<An;Al++){c(Am[Al]);}}mstrmojo.gm.GMLegend=mstrmojo.declare(mstrmojo.VisLegend,[mstrmojo._FormateVisLegend,mstrmojo.ui._HasScroller],{scriptClass:"mstrmojo.gm.GMLegend",cssClass:"gm-legend",dropZoneHighlightCss:"gm-legend-slot",dockedPositions:null,dockPos:AO.LEFT,GMW:0,GMH:0,isMinimal:false,shapeType:undefined,legendMarkup:'<div class="gm-legend-button"><div class="gm-legend-tri-button"></div><div class="gm-legend-name"></div><div class="gm-legend-close-button"></div></div><div class="gm-legend-container"><div class="gm-legend-separator-line" style="width:{@coreWidth}px"></div><div class="gm-legend-title" type="lgd-title" style="line-height:{@lineHeight}px; max-height:{@maxHeight}px"></div><div class="gm-legend-table-container"><table class="gm-legend-table"></table></div></div><div class="gm-legend-container"><div class="gm-legend-separator-line" style="width:{@coreWidth}px"></div><div class="gm-legend-title" type="lgd-title" style="line-height:{@lineHeight}px; max-height:{@maxHeight}px"></div><table class="gm-legend-table"></table><table class="gm-legend-table"></table><canvas type="lgd-canvas"></canvas></div><div class="gm-legend-container"><div class="gm-legend-separator-line" style="width:{@coreWidth}px"></div><div class="gm-legend-title" type="lgd-title" style="line-height:{@lineHeight}px; max-height:{@maxHeight}px"></div><table class="gm-legend-table"></table><table class="gm-legend-table"></table><canvas type="lgd-canvas"></canvas></div><div class="gm-legend-resizer-v" draggable="false"></div><div class="gm-legend-resizeRect"></div>',init:function AE(Am){this.styles={};this.cutBy=null;this.dataArray=null;this.textDivs=[];this.dockedPositions=[{pos:o.LEFT_TOP},{pos:o.LEFT_MIDDLE},{pos:o.LEFT_BOTTOM},{pos:o.RIGHT_TOP},{pos:o.RIGHT_MIDDLE},{pos:o.RIGHT_BOTTOM}];var An=Am.placeholder,Al=An.style;if(An){this.cssClass=An.getAttribute("class");if(!this.cssClass){this.cssClass="";}if(Am.hasOwnProperty("width")===false){Am.width=(Al&&Al.width)||An.clientWidth;}if(Am.hasOwnProperty("height")===false){Am.height=(Al&&Al.height)||An.clientHeight;}if(Am.hasOwnProperty("left")===false){Am.left=An.offsetLeft;}if(Am.hasOwnProperty("top")===false){Am.top=An.offsetTop;}}this._super(Am);},setupScrollNodes:function M(){this.scrollNode=this.cbTableContainer;},getSplitterDockPos:function(){return(this.currDockedPositionIdx<3)?AO.RIGHT:AO.LEFT;},updateAlignClass:function(){var Ap=this.getDockedPosition(),Aq=Ap&&Ap.pos,An=(Aq===o.RIGHT_MIDDLE||Aq===o.RIGHT_TOP||Aq===o.RIGHT_BOTTOM||Aq===o.RIGHT),Al=this.domLegend,Am=this.domNode,Ao=this.resizeRect;if(An){Ae.removeClass(Al,"gm-align-left");Ae.addClass(Al,"gm-align-right");Ae.toggleClass(Al,"gm-legend-alignRight",true);Ae.toggleClass(Al,"gm-legend-alignLeft",false);Ae.toggleClass(Am,"gm-legend-alignRight",true);Ae.toggleClass(Am,"gm-legend-alignLeft",false);Ae.toggleClass(Ao,"gm-legend-alignRight",true);Ae.toggleClass(Ao,"gm-legend-alignLeft",false);}else{Ae.removeClass(Al,"gm-align-right");Ae.addClass(Al,"gm-align-left");Ae.toggleClass(Al,"gm-legend-alignRight",false);Ae.toggleClass(Al,"gm-legend-alignLeft",true);Ae.toggleClass(Am,"gm-legend-alignRight",false);Ae.toggleClass(Am,"gm-legend-alignLeft",true);Ae.toggleClass(Ao,"gm-legend-alignRight",false);Ae.toggleClass(Ao,"gm-legend-alignLeft",true);}},postBuildRendering:function(){this._super();var Ax=this.styles,Az=this.domNode,Ao=this.domLegend.childNodes,As=Ao[1],Aq=Ao[2],Ay=Ao[3],A2={objType:AI.LEGEND};this.addSlots({lgdBtn:Ao[0],triBtn:Ao[0].firstChild,lgdName:Ao[0].childNodes[1],closeBtn:Ao[0].lastChild,cbContainer:Ao[1],sepLine1:As.firstChild,cbTitle:As.childNodes[1],cbTableContainer:As.childNodes[2],cbTable:As.childNodes[2].firstChild,sb1Container:Aq,sepLine2:Aq.firstChild,sb1Title:Aq.childNodes[1],sb1MetricNamesTable:Aq.childNodes[2],sb1DataTable:Aq.childNodes[3],sb1Canvas:Aq.childNodes[4],sb2Container:Ay,sepLine3:Ay.firstChild,sb2Title:Ay.childNodes[1],sb2MetricNamesTable:Aq.childNodes[2],sb2DataTable:Ay.childNodes[3],sb2Canvas:Ay.childNodes[4],splitter:Ao[4],resizeRect:Ao[5]});Af.GMLegend.applyHTML5Props(Ax);this.bgColor=Ax.background||Ax.backgroundColor||"transparent";AQ.applyStyle2Legend(Ax,Az,this.domLegend);if(mstrApp.isInVFInteractMode){this.closeBtn.style.visibility="hidden";}var Ar=this.getSplitterDockPos(),A1=this.width-2*A-2*Ah,At=this.cbTitle,Am=At.style,An=this.sb1Title,Ap=this.sb2Title,A0=An.style,Al=Ap.style,Aw=this.sepLine1,Av=this.sepLine2,Au=this.sepLine3;Aw.style.width=A1+y;Av.style.width=A1+y;Au.style.width=A1+y;Am.lineHeight=H+y;A0.lineHeight=H+y;Al.lineHeight=H+y;Am.maxHeight=2*H+y;A0.maxHeight=2*H+y;Al.maxHeight=2*H+y;At.identity={objType:AI.LEGEND_TEXT,parentIdentity:A2};An.identity={objType:AI.LEGEND_TEXT,parentIdentity:A2};Ap.identity={objType:AI.LEGEND_TEXT,parentIdentity:A2};this.dockPos=Ar;this.identity=Az.identity=A2;this.updateAlignClass();},feedData:function(Al,Am){this.dataArray=Al;this.isMinimal=Am;this.textDivs=[];Af.GMLegend.applyHTML5Props(this.styles);this.autoCollapseLegend();if(Am||this.autoCollapse){AW.call(this);this.draggable=false;}else{U.call(this);this.draggable=true;}q.call(this);this.updateScrollbars();},autoCollapseLegend:function(){this.autoCollapse=false;},updateColorBySquare:function(An){var Ao,Ap,Am,Al;if(An){Al=this.domNode.querySelectorAll(".gm-legend-colorbox-div");Ao=An.elements;Ap=Math.min(Ao.length,Al.length);for(Am=0;Am<Ap;Am++){E.call(this,Ao[Am],Al[Am]);}}},updateContainerSize:function(Al,Am){this.GMW=Al;this.GMH=Am;this.calculateDockedPositions(Al,Am);},updateAfterResize:function(){Af.GMLegend.applyHTML5Props(this.styles);var Aq=0,Ap=this.width,Ar=this.cbContainer,At=this.sb1Container,An=this.sb2Container,Ao=this.sepLine1,Am=this.sepLine2,Al=this.sepLine3,As=Ap-2*A-2*Ah;P.forEach(this.dataArray||[],function(Au){if(Au.dataType===Aa.COLOR_BY){if(Au.dataObj){if(Ar){Ar.style.width=As+y;}}}else{if(Au.dataType===Aa.SIZE_BY){if(Au.dataObj){Aq++;if(Aq===1&&At){At.style.width=As+y;}if(Aq===2&&An){An.style.width=As+y;}}}}});if(Ao){Ao.style.width=As+y;}if(Am){Am.style.width=As+y;}if(Al){Al.style.width=As+y;}this.domLegend.style.width=this.width+y;this.domLegend.style.height=this.height+y;},updateStyle:function(Al){this.styles=Al;this.bgColor=Al.background||Al.backgroundColor||"transparent";AQ.applyStyle2Legend(Al,this.domNode,this.domLegend);},updateTitleLineHeight:function(){var Am=this.cbTitle,Ap=Am.style,An=this.sb1Title,Al=this.sb2Title,Aq=An.style,Ao=Al.style;Af.GMLegend.applyHTML5Props(this.styles);Ap.lineHeight=H+y;Aq.lineHeight=H+y;Ao.lineHeight=H+y;Ap.maxHeight=2*H+y;Aq.maxHeight=2*H+y;Ao.maxHeight=2*H+y;},getSplitterPosition:function(An){var Am=An.src.startPos+An.tgt.pos.x-An.src.pos.x,Ap=An.src.posInfo,Ao=Ap&&Ap.min,Al=Ap&&Ap.max;if(Ao!==undefined){Am=Math.max(Am,Ao);}if(Al!==undefined){Am=Math.min(Am,Al);}return Am;},positionResizeRect:function(Al,Am){var Ao=Al.src.posInfo.dockPosition===AO.LEFT,Ap=Am-AS,Aq=Ao?Ap:0,An=Ao?this.width-Ap:Ap;this.resizeRect.style.left=(Aq-1)+y;this.resizeRect.style.width=(An-2)+y;},updateLegendSlot:function(Ao,Al){var An=this.getDockedPosition(),Am=An&&An.pos;if(Am!==Ao){this.currDockedPositionIdx=Al;this.dockPos=this.getSplitterDockPos();this.updateDropZonePosition();this.updateAlignClass();this.updateSplitter();this.widget.onLegendDropZoneChange(this.getDockedPosition());}},isDragValid:function r(Al){return !mstrApp.isInVFInteractMode&&this._super(Al);},ondragstart:function(Al){var An=Al.src.e.target,Am=Al.src.data;if(this.widget&&this.widget.setInteractive){this.widget.setInteractive(false);}if(An===this.splitter){Al.src.startPos=An.offsetLeft;Al.src.posInfo=this.getSplitterInfo(An);this.positionResizeRect(Al,Al.src.startPos);Ae.addClass(this.resizeRect,"resizing");}else{this.cbTableScrollTop=this.cbTableContainer.scrollTop;this._super(Al);if(!Am||!Am.isScrollBar){this.clearSelectedTargets();Ae.toggleClass(this.domNode,"gm-legend-hover",false);Ae.toggleClass(this.domLegend,"active",false);this.cbTableContainer.scrollTop=this.cbTableScrollTop;this.domLegend.style.background=this.bgColor;this.isDragging=true;}}},ondragmove:function D(Al){var An=Al.src.e.target,Am;if(An===this.splitter){Am=this.getSplitterPosition(Al);An.style.left=Am+y;this.positionResizeRect(Al,Am);}else{this._super(Al);}},ondragend:function(Al){var An=Al.src.e.target;if(An===this.splitter){Ae.removeClass(this.resizeRect,"resizing");this.splitterMoved(this.getSplitterPosition(Al)-Al.src.startPos,Al.src.posInfo);}else{this._super(Al);var Am=Al.src.data;if(!Am||!Am.isScrollBar){this.cbTableContainer.scrollTop=this.cbTableScrollTop;this.domLegend.style.background="transparent";this.isDragging=false;}delete this.cbTableScrollTop;}if(this.widget&&this.widget.setInteractive){this.widget.setInteractive(true);}},onscroll:function(){var Am,Aq,Ap=this.scrollNode.scrollTop,Ao,An,Al;if(this.prevScrpllTop===Ap){return ;}Aq=(this.dataArray&&this.dataArray.length)||0;for(Am=0;Am<Aq;Am++){An=this.dataArray[Am];if(An.dataType===Aa.COLOR_BY){Al=An.dataObj;break;}}if(Al){Ao=this.cbTable;Ao.innerHTML="";Ao.appendChild(this.fillColorByTable(Al,Math.floor(Ap/AL)));this.prevScrpllTop=Ap;this.scrollNode.scrollTop=Ap;this._super();}},fillColorByTable:function(A1,Ar){var A2,Az,An,Aq,Ap,As,At,Au=this.styles,Al,Ax=this.cutBy,Av=this.width-2*Ah-2*A,Aw,Ao,Am,A3,Ay,A4;Aw=A1.elements;Az=Aw.length;Al=document.createDocumentFragment();Ao=Av-z-AX;Am=0;A3=AL*Az;Ay=Ar*AL;function A0(A5){An=document.createElement("tr");Aq=document.createElement("td");An.style.height=A5+y;Aq[AB]("class","gm-legend-colorbox");An.appendChild(Aq);Al.appendChild(An);}if(Ar>0){A0(Ay);}for(A2=Ar;A2<Az;A2++){An=document.createElement("tr");Aq=document.createElement("td");Ap=document.createElement("td");As=document.createElement("div");At=document.createElement("div");As[AB]("class","gm-legend-colorbox-ctn-div");As[AB]("type",C.LGD_COLORBOX_CTN);At[AB]("class","gm-legend-colorbox-div");At[AB]("type",C.LGD_COLORBOX);E.call(this,Aw[A2],At);An[AB]("class","gm-legend-tr");An.style.height=AL+y;Aq[AB]("class","gm-legend-colorbox");Ap[AB]("class","gm-legend-desc");A4=Aw[A2];if(A4.bftp){b.fillImageInDiv(Ap,A4.bftp,A4.label,"gm-img-legend");}else{AA.call(this,Ap,A4.label,A2,w,Ao,Au);}As.appendChild(At);Aq.appendChild(As);An.appendChild(Aq);An.appendChild(Ap);Al.appendChild(An);Am+=AL;if(Ax&&(Ax+Am-AL)>A3){A0(A3-Am-Ay);break;}}return Al;},calculateDockedPositions:function(Am,Ap){var Ao,Ar=this.getWidth(),Al=this.getHeight(),An=this.dockedPositions,Aq=function(As){switch(As.pos){case k.LEFT_TOP:As.x=0;As.y=X;break;case k.LEFT_MIDDLE:As.x=0;As.y=Math.max(X,(Ap-Al)>>1);break;case k.LEFT_BOTTOM:As.x=0;As.y=Math.max(0,Ap-Al-X);break;case k.RIGHT_TOP:As.x=Am-Ar;As.y=X;break;case k.RIGHT_MIDDLE:As.x=Am-Ar;As.y=Math.max(X,(Ap-Al)>>1);break;case k.RIGHT_BOTTOM:As.x=Am-Ar;As.y=Math.max(0,Ap-Al-X);break;}};for(Ao=0;Ao<An.length;Ao++){Aq(An[Ao]);}this.updateDropZonePosition();},updateDropZonePosition:function(){var Al=this.getDockedPosition(),Am=this.dropZoneNode.style;Am.left=Al.x+y;Am.top=Al.y+y;},updateDropZoneNode:function(Al){this._super(Al);this.dockPos=this.getSplitterDockPos();this.updateSplitter();},onmouseover:function(Al){var An=this.domLegend,Ar=Al.getTarget(),Ao=Ar.getAttribute("type"),Aq=this.widget,Am;if(this.isDragging){return ;}var Ap=S.copy(this.styles);Ap.opacity+=0.4;AQ.applyStyles2DomNode(this.domNode,Ap);if(AC.contains(An,Ar,true)){Ae.addClass(An,"active");}if(Ao===C.LGD_COLORBOX){Ar=Ar.parentNode;Ao=Ar.getAttribute("type");}if(Ao===C.LGD_COLORBOX_CTN){Am=Ar.firstChild.identity;if(!Am||!Am.comb){return ;}Ae.toggleClass(Ar,"hover-colorsquare",true);return ;}if(Aq.formattingMode){switch(Ao){case C.LGD_TITLE:case C.LGD_TEXT:Ae.toggleClass(An,"hover-txt",true);break;default:Ae.toggleClass(this.domNode,"gm-legend-hover",true);break;}}},onmouseout:function(Am){var Ao=this.domLegend,Al=Am.e.toElement||Am.e.relatedTarget,Ar=Am.getTarget(),Ap=Ar.getAttribute("type"),Aq=this.widget,An;AQ.applyStyles2DomNode(this.domNode,this.styles);if(!AC.contains(Ao,Al,true)){Ae.removeClass(Ao,"active");}if(Ap===C.LGD_COLORBOX){Ar=Ar.parentNode;Ap=Ar.getAttribute("type");}if(Ap===C.LGD_COLORBOX_CTN){An=Ar.firstChild.identity;if(!An||!An.comb){return ;}Ae.toggleClass(Ar,"hover-colorsquare",false);return ;}if(Aq.formattingMode||Aq.isOnFormattingMode){switch(Ap){case C.LGD_COLORBOX_CTN:case C.LGD_COLORBOX:break;case C.LGD_TITLE:case C.LGD_TEXT:Ae.toggleClass(Ao,"hover-txt",false);break;default:Ae.toggleClass(this.domNode,"gm-legend-hover",false);break;}}},onclick:function(Al){var Ao=Al.getTarget(),Am=Ao.getAttribute("type"),An=this.widget;if(Ao===this.triBtn){if(!this.autoCollapse){this.raiseEvent({name:"gm-legend-clicked",action:(this.isMinimal?"restore":"minimize")});}}else{if(Ao===this.closeBtn){this.raiseEvent({name:"gm-legend-clicked",action:"close",mousePos:Al.e});}else{if(Am===C.LGD_COLORBOX){Ao=Ao.parentNode;Am=Ao.getAttribute("type");}if(An.formattingMode||An.isOnFormattingMode){if(Am===C.LGD_COLORBOX_CTN){this.selectColorBox(Ao,true);}else{if(Am===C.LGD_TEXT||Am===C.LGD_TITLE){this.selectText();}else{this.selectLegendBody();}}}else{this.clearSelectedColorBox();}}}AC.stopPropogation(null,Al.e);},attachClearEvent:function(){if(this.clearSelectTargetfn){return ;}var Am=this,Al=this.domLegend;this.clearSelectTargetfn=function(Aq){var Ap=Aq.target,An=Am.widget.toolEditor,Ao;if(!AC.contains(Al,Ap,true,Al)){if(An){Ao=An.domNode;if(!AC.contains(Ao,Ap,true,Ao)){Am.clearSelectedTargets();}}else{Am.clearSelectedTargets();}}};AC.attachEvent(document.body,"mousedown",this.clearSelectTargetfn,true);},clearSelectedColorBox:function(){var Al=this.selectedColorBox;if(Al){Ae.toggleClass(Al,"select",false);Ae.toggleClass(Al,"selectfmt",false);this.selectedColorBox=undefined;}},clearSelectedText:function(){Ae.removeClass(this.domNode,"select-txt");},clearSelectedLegendBody:function(){Ae.removeClass(this.domNode,"gm-legend-select");},clearSelectedTargets:function(){this.clearSelectedColorBox();this.clearSelectedText();this.clearSelectedLegendBody();if(this.clearSelectTargetfn){AC.detachEvent(document.body,"mousedown",this.clearSelectTargetfn,true);delete this.clearSelectTargetfn;}},selectColorBox:function(An,Am){var Al=An.firstChild.identity;if(!Al||!Al.comb){return ;}this.clearSelectedText();this.clearSelectedLegendBody();if(this.selectedColorBox!==An){this.clearSelectedColorBox();this.selectedColorBox=An;if(Am){Ae.toggleClass(An,"selectfmt",true);}else{Ae.toggleClass(An,"select",true);}this.attachClearEvent();}},selectText:function(){this.clearSelectedColorBox();this.clearSelectedLegendBody();Ae.addClass(this.domNode,"select-txt");this.attachClearEvent();},selectLegendBody:function(){this.clearSelectedColorBox();this.clearSelectedText();Ae.addClass(this.domNode,"gm-legend-select");this.attachClearEvent();},adjustColorPickerPos:function(Al){var Ao=AC.position(Al),Am=0,An={};if(this.currDockedPositionIdx<3){An.x=Ao.x+Ao.w+Am;An.alignLeft=true;}else{An.x=Ao.x-Am;An.alignLeft=false;}An.y=Ao.y+Ao.h+Am;return An;},getSplitterInfo:function(Aq){if(!Aq){return{};}var Am=this.dockPos,Ap={},Ao=this.width,Al=AM,An=Math.floor(this.GMW/3);Ap.dockPosition=Am;if(Am===AO.LEFT){Ap.min=Math.min(Ao-An,0);Ap.max=Math.max(Ao-Al,0);}else{if(Am===AO.RIGHT){Ap.min=Al;Ap.max=An;}}Ap.min+=AS;Ap.max+=AS;return Ap;},splitterMoved:function(Al,Am){if(Al===0){return ;}if(Am.dockPosition===AO.LEFT){Al=-Al;}this.raiseEvent({name:"gm-legend-resized",position:Al});this.updateSplitter();if(this.widget&&this.widget.setInteractive){this.widget.setInteractive(true);}},updateSplitter:function(){AU(this.splitter,this.dockPos,this.width,this.height);this.resizeRect.style.height=this.height-2+y;}});Af.GMLegend.IMAGE_SIZE_FIXED=0;Af.GMLegend.applyHTML5Props=function(An){var Ao=parseInt(An.fontSize,10)||8,Am;if(An.fontSize.indexOf("px")>=0){Ao=Math.floor(Ao*a+0.5);}Am=Math.floor(Ao/a*F+0.5);H=Math.max(Ao,8)+9;AV=Math.floor(Ao/a+0.5);f=Math.max(Am,15);AL=Af.GMLegend.IMAGE_SIZE_FIXED||(Math.max(Am,20)+2);t=Math.max(Am,14)+2;Ah=parseInt(An.borderWidth,10)||1;var Al=parseInt(An.tbHeight,10);m=isNaN(Al)?K:Al;};Af.GMLegend.getLegendSize4MinMode=function(Am,An){var Ap,Ao,Al=m+2*Ah;if(Am){Ao=Am.elements;Ap=Ao.length;Al+=AL*Ap;Al+=2*A;}Al=Math.min(Al,An-X*2);return{width:z+5+7+2*Ah,height:Al};};Af.GMLegend.getLegendSize=function(Az,Ao,Al,Ar,A1,As){var At,Am,A0,Aq,Ap=Ar-X*2,Ax=0,An=0,Aw={},Av,Au,Ay;if(!Az||!Az.length||Az.length<1){return{};}if(Ao!==undefined){if(!As){As=Math.floor(Ad(Az,A1)*Ao);}Aq=Math.min(As,Math.floor(Al/3));Aq=Math.max(Aq,50);return j(Az,Aq,Ar,A1);}Aq=Math.min(Math.floor(0.2*Al),300);for(At=0;At<Az.length;At++){Au=Az[At];if(Au.dataType===Aa.COLOR_BY){Av=Ac(Au.dataObj,A1);if(Av>Ax){Ax=Av;}}else{if(Au.dataType===Aa.SIZE_BY){Av=AR(Au.dataObj,A1);if(Av>An){An=Av;}}}}Am=Math.max(Ax,An)+2*Ah;Aw.width=Math.min(Am,Aq);Aw.scale=Aw.width/Am;Ay=e(Az,Aw.width,A1);A0=Ay.height;Aw.autoCollapse=Ay.minHeight>Ap;Aw.minHeight=Ay.minHeight;Aw.height=Math.min(A0,Ap);if(A0>Ap){Aw.cutBy=A0-Ap;}return Aw;};}());(function(){mstrmojo.requiresCls("mstrmojo.VisBase","mstrmojo.dom","mstrmojo.array","mstrmojo.num","mstrmojo.hash","mstrmojo.color","mstrmojo.css","mstrmojo.string","mstrmojo.VisEnum","mstrmojo.chart.enums.EnumFontStyle","mstrmojo.VisUtility","mstrmojo.util.ui._LassoSelector","mstrmojo.ui.menus._HasMenuPopup","mstrmojo._colorPalette","mstrmojo._VizSelectionHelper","mstrmojo.VisTooltip","mstrmojo.vi._MonitorsAppState","mstrmojo.vi.enums.EnumFeatures","mstrmojo.heatmap.vi._HasHeatmapContextMenu","mstrmojo.netviz.ObservableModel","mstrmojo.chart.model.enums.EnumDSSDefaultFormats","mstrmojo.util.color","mstrmojo.vi.ui._IsDropTarget","mstrmojo.gm._SupportDndAsBlackBox","mstrmojo.ui.PopupConfig","mstrmojo.netviz.PropertyParser","mstrmojo.vi.viz.EnumDSSDropZones","mstrmojo.vi.enums.EnumThemeProperties","mstrmojo.PerformanceLogOutput");mstrmojo.requiresClsP("mstrmojo.gm","GMLegend","EnumLegendSlot","GMUtility");mstrmojo.requiresClsP("mstrmojo.vi.ui.rw","_HasVisSelections","selectors._IsMultiUnitControl","selectors._BrushesAndHighlights","_XtabDE");mstrmojo.requiresClsP("mstrmojo.heatmap.vi","_SupportHeatmapBrushesAndHighlights","VisHeatMapColorTheme","VisHeatMapCanvas","VisHeatMapHighlightCanvas","VisHeatmapUtility");var V=mstrmojo,BG=V.css,Ai=V.array,Am=mstrmojo.string,AQ=V.VisUtility,BN=mstrmojo.heatmap.vi.VisHeatmapUtility,n=mstrmojo.vi.enums.EnumFeatures,BB=V.gm,Z=BB.GMLegend,Af=BB.EnumLegendSlot,k=BB.GMUtility,M=V.PerformanceLogOutput,Bi=V.VisEnum.GMLegendDataType,AM=V.chart.enums.EnumFontStyle,AP=mstrmojo.vi.enums.EnumThemeProperties,G=AP.SUBTYPE.HEATMAP,BX=V.VisEnum,Aq=BX.GMLegendFormatingPropertyTag,X=BX.LegendPropertyTag,BQ=BX.EnumLegendMode,s=BX.FormNameDisplayType,x=BX.EnumColorRankMode,Aa=mstrmojo.hash,Ax=V.dom,AK=V.util.color,AA=V.color,O=mstrmojo.VisEnum.HEATMAP_PROPERTIES,Bc=mstrmojo.vi.viz.EnumDSSDropZones;var Bs=BX.SERVER_JSON_ERROR_TYPE;var Aj=["at","dei","dpt","o","tui","ui"],c=Aj.length;var Br=["mousedown","mouseup","mousemove","mouseout","click","contextmenu"];var At=5;var Ba={lgdBgFillClr:[15461355,1710618],lgdBgFillStyle:[0,0],lgdBgFillEff:[1,1],lgdBgFillTrans:[0,100],lgdFntSz:["8pt","8pt"],lgdFntFml:["Arial","Arial"],lgdFntStyle:[0,0],lgdFntClr:[6710886,16777215],lgdBdrShw:[false,false],lgdBdrClr:[11579568,5855577],lgdBdrThk:[1,1],lgdBdrStyle:[0,0],lm:[1,1],lwr:[undefined,undefined]},Ae;var D=[{pos:Af.LEFT_TOP},{pos:Af.LEFT_MIDDLE},{pos:Af.LEFT_BOTTOM},{pos:Af.RIGHT_TOP},{pos:Af.RIGHT_MIDDLE},{pos:Af.RIGHT_BOTTOM}];var BU={VERTICAL:0,HORIZONTAL:1};var Q=mstrmojo.desc(14741,"Absolute value of");var BT="-";var y=false;function Bn(){var Bu=this.modelData,Bz=Bu.gsi.mx,Bw=this.props.sizeMetricID,Bt=AQ.findInArray(Bz,function(B0){return B0.did===Bw;}),Bx=false,By={min:-Infinity,max:Infinity},Bv={min:Infinity,max:-Infinity};if(Bt===-1){return By;}this.dfs(this.root,function(B1){if(B1.entityChildren!==undefined){return ;}var B3=B1.aggValues||[],B0=B3[Bt],B2=B0.value;if(B0.count===0||isNaN(B2)){return ;}Bx=true;if(B2<0){Bv.hasNegativeValue=true;B2=Math.abs(B2);}Bv.min=Math.min(Bv.min,B2);Bv.max=Math.max(Bv.max,B2);});return Bx?Bv:By;}function BH(Bu){if(!Bu||Bu.length!==3){return true;}var Bt=Bu[0];return Bu.slice(1).every(function(Bv){return Aa.equals(Bt,Bv);});}function An(){var Bt=this;return{colorTheme:this.colorTheme,alias:"canvasObject",slot:"canvasSlot",root:this.root,width:this.heatMapSize.w,height:this.heatMapSize.h,attributes:this.levelAttributes,showMetric:this.props.showMetricValues,labelSetting:this.props.labelSize,isHeaderOnTop:this.props.isHeaderOnTop,fonts:this.props.fonts,bgColor:this.getSingleBackgroundColor(),isHeaderColorsModified:function(){return BH(Bt.props.headerColors);}};}function J(Bu,Bt){if(!Array.isArray(Bu)||!Array.isArray(Bt)){return false;}if(Bu===Bt){return true;}if(Bu.length!==Bt.length){return false;}return Bu.every(function(Bv){return Bt.indexOf(Bv)!==-1;});}function BC(Bu){Bu=Bu||[];var Bv={name:"selectionChange",type:[],selectedEntities:Bu},Bt;if(A9.call(this)){Bt=AI(Bu);if(Bt.length>0){Bv.type.push("shapeColor");Bv.colorbyElements=Bt;}this.edtModelCbInitSelection=Bt;}this.raiseEvent(Bv);}function Ab(Bt){Bt=Bt||[];if(A9.call(this)){this.cmColorByElements=AI(Bt);}}function AI(Bu){var Bt=Bu.filter(function(Bv){var Bw=Bv.colorByAttributeIds,Bx=Bv.colorByElementIds;return Bw&&Bx&&Bw.length===Bx.length;}).map(function(Bw){var Bx=Bw.colorByAttributeIds,By=Bw.colorByElementIds,Bv=Bw.colorByTypes;return Bx.map(function(B0,Bz){return{tid:B0,eid:By[Bz],tp:Bv[Bz]};});});return AQ.arrayUnique(Bt,function(Bv,Bw){Bv=Aa.clone(Bv);Bw=Aa.clone(Bw);return k.isEqualComb(Bv,Bw);});}function AU(Bz,Bv){var Bx=this.getPropsInfo().attrColorByOpacity||{},By,Bu,Bt,Bw;Bz=Bz||[];Bv=Bv||[];By=Bz.join("|");Bu=Bv.join("|");Bt=Bx[By]||{};Bw=Bt[Bu];if(Bw===undefined){Bw=100;}return Bw;}function l(Bv){var Bt,Bu=D.length;for(Bt=0;Bt<Bu;Bt++){if(Bv===D[Bt].pos){return Bt;}}return -1;}function K(Bt){var Bu={};Aa.keyarray(Ba).forEach(function(Bv){Bu[Bv]=Ba[Bv][Bt];});return Bu;}function A(Bu){if(Bu.entityChildren){var Bt=false;if(Bu.entityChildren.length===0){return Bt;}Ai.forEach(Bu.entityChildren,function(Bv){Bt=A(Bv);if(Bt){return false;}});return Bt;}return true;}var BA=BX.HEATMAP_LABEL_SIZE;var BO={Sum:0,Avg:1,Cnt:2,Max:3,Min:4,GeoAvg:5,AESum:6};var Ag={Squarified:0,PivotByMiddle:1,SliceAndDice:2};var AV={Padding:5,headerOnTopPadding:5,MaxLegendHeight:60,AttributeColorByLegendWidth:140,LegendMenuEditorWidth:0,LegendMinWidth:15,LegendTickLength:4,LegendMaxBandWidth:400,LegendWidthPercent:0.9,LegendMinPadding:15,LegendBottomPadding:3,LegendGutter:5,LegendBandAspect:10,MinShowLabelDimension:6,DeletedListHeight:500,EditorDialogWidth:565,EditorDialogHeight:574,EditButtonWidth:0,EditButtonHeight:0,EditButtonRight:0,HeaderPixels:19};function Bj(Bt){return Bt&&Bt.value!==undefined&&Bt.opacity!==undefined;}var Ac=[{value:"#efefef",opacity:1},{value:"#e4e4e4",opacity:1},{value:"#e4e4e4",opacity:0.7}];var E=["headerOnMiddle","headerOnTop.header","headerOnTop.cell"];var A4=(function(){var Bt={headerOnMiddle:{scale:1,family:"Arial",style:"0","heatmap-one-level-1":"14pt","heatmap-multi-level-1":"24pt","heatmap-two-level-2":"14pt","heatmap-multi-level-2":"20pt","heatmap-multi-level-3":"10pt"},headerOnTop:{header:{scale:1,family:"Arial",style:"0","heatmap-level-1-header-on-top":"12pt","heatmap-level-2-header-on-top":"11pt","heatmap-level-3-header-on-top":"11pt"},cell:{scale:1,family:"Arial",style:"0","heatmap-level-1-header-on-top":"12pt","heatmap-level-2-header-on-top":"12pt","heatmap-level-3-header-on-top":"12pt"}}};var Bu=Aa.clone(Bt);E.forEach(function(Bw){var Bv=AQ.getPropertyByPath(Bu,Bw,{});Object.keys(Bv).filter(function(Bx){return AQ.strStartsWith(Bx,"heatmap-");}).forEach(function(Bx){Bv[Bx]=AQ.psPt2CssPt(Bv[Bx]);});});return Bu;}());var Bq=(function(){var Bt={headerOnMiddle:{scale:1,family:"Open Sans",style:"0","heatmap-one-level-1":"14px","heatmap-multi-level-1":"24px","heatmap-two-level-2":"14px","heatmap-multi-level-2":"20px","heatmap-multi-level-3":"10px"},headerOnTop:{header:{scale:1,family:"Open Sans",style:"0","heatmap-level-1-header-on-top":"12px","heatmap-level-2-header-on-top":"11px","heatmap-level-3-header-on-top":"11px"},cell:{scale:1,family:"Open Sans",style:"0","heatmap-level-1-header-on-top":"11px","heatmap-level-2-header-on-top":"11px","heatmap-level-3-header-on-top":"11px"}}};var Bu=Aa.clone(Bt);return Bu;}());var R={headerOnTop:{header:{max:16/12,min:8/11},cell:{max:16/12,min:8/11}},headerOnMiddle:{max:36/24,min:8/10}};var Bh="--";var F=16119287;function Ar(Bu,Bt){E.forEach(function(By){var B2=AQ.getPropertyByPath(Bu,By,{}),Bx=AQ.getPropertyByPath(R,By),Bw=AQ.getPropertyByPath(Bt,By,mstrmojo.emptyFn);var B1,Bv,Bz,B0;if(Bx){B1=B2.scale;Bv=Bx.max;Bz=Bx.min;B0={valid:true,min:"gt",max:"lt"};if(B1>=Bv){B1=Bv;B0.valid=false;B0.max=B1===Bv?"eq":"gt";}if(B1<=Bz){B1=Bz;B0.valid=false;B0.min=B1===Bz?"eq":"lt";}Bw(B0,B1);}});}function AR(Bu,Bt){return Bu.reduce(function(Bz,By){var Bv=By.split("."),Bw=Bv.length,Bx=Bz;Bv.forEach(function(B1,B0){if(B0===Bw-1){Bx[B1]=Bt(By);}if(Bx[B1]===undefined){Bx[B1]={};}Bx=Bx[B1];});return Bz;},{});}function A8(Bv){var Bt=AR(E,function(){return false;}),Bu=AR(E,function(Bw){return function(B0,By){var Bx=Bw.split("."),B2=Bx.length-1,B1=Bx[B2],Bz=B2===0?Bt:AQ.getPropertyByPath(Bt,Bx.slice(0,B2).join("."));if(Bz!==undefined){Bz[B1]=B0;}};});Ar(Bv,Bu);this.raiseEvent({name:"fontScaleChange",type:"*",limits:Bt});}function AH(CB,CC){var CD=this,B2={act:"updateTemplate",keyContext:CD.k,actions:[]},B7=B2.actions,B5=CD.zonesModel,B1=[AQ.pick(CB,["did","t"])],Bt={id:Bc.Grouping},Bx=CD.getContextMenuSelections(),By=CD.modelData.datasetId,B6="00000000000000000000000000000000",B4=0,Bv=3,CA=CC.headerDrill,B3=CC.keepParent;var Bz={datasetId:By,datasetType:By===B6?B4:Bv};var B0=Array.prototype.push;if(CA&&Bx.length>0){var Bu=null,B9=B5.getZoneModelByZoneId(Bt.id),B8=Bx[Bx.length-1][0].tid;B9.items.forEach(function(CE){if(CE.did===B8){Bu=CE;return false;}});if(B3){B0.apply(B7,B5.getAddDropZoneUnitsActions(Bt,B1,Bu?Bu.idx+1:0));}else{if(Bu){B0.apply(B7,B5.getRemoveDropZoneUnitActions(Bt,Bu));B0.apply(B7,B5.getAddDropZoneUnitsActions(Bt,B1,Bu.idx));}}}else{var Bw=B5.getItemCountInZone(Bt.id);B0.apply(B7,B5.getAddDropZoneUnitsActions(Bt,B1,Bw,Bz));}return B2;}function e(Bw,Bx,By){var Bv=By.needsCopy,Bu=By.invalidReplacement;if(Bv&&Bw.total===undefined){Bw.avgTotal=Bw.total=Bw.geomProduct=Bw.max=Bw.min=Bw.value;Bw.positiveCount=Bw.value>0?1:0;}var Bt=!isNaN(Bx);Bw.value=Bt?Bx:Bu;Bw.count+=Bt?1:0;Bw.allValueCount+=1;this.aggregated=Bt;if(Bt){if(isNaN(Bw.total)){Bw.total=Bx;}else{Bw.total+=Bx;}if(isNaN(Bw.avgTotal)){Bw.avgTotal=Bx;}else{Bw.avgTotal+=Bx;}if(isNaN(Bw.max)){Bw.max=Bx;}else{Bw.max=Math.max(Bw.max,Bx);}if(isNaN(Bw.min)){Bw.min=Bx;}else{Bw.min=Math.min(Bw.min,Bx);}if(isNaN(Bw.geomProduct)){if(Bx>0){Bw.geomProduct=Bx;Bw.positiveCount++;}}else{if(Bx>0){Bw.geomProduct*=Bx;Bw.positiveCount++;}}Bw.count++;}}function BI(Bt){return Bt.replace(/&lt;/g,"<").replace(/&gt;/g,">").replace(/&quot;/g,'"');}var AT={dftUnDel:0,dftDel:1,usrDel:2};var BL=(function(){var Bw=new window.DOMParser(),Bt,Bu;try{Bt=Bw.parseFromString("<","text/xml");Bu=Bt.getElementsByTagName("parsererror")[0].namespaceURI;return function(Bx){return Bx.getElementsByTagNameNS(Bu,"parsererror").length>0;};}catch(Bv){return null;}}());function S(B7){if(B7.trim()===""){return{};}var Bt=new window.DOMParser(),B2=false,B5;try{B5=Bt.parseFromString(BI(B7),"text/xml");B2=BL&&BL(B5);}catch(B4){B2=true;}if(B2){return{};}var Bu=B5.childNodes[0]||{},B0=B5.childNodes[0].childElementCount||0,B3=Bu.firstElementChild,Bv=B3&&B3.attributes,Bz=Bv&&Bv.length||0,B1={},By=0,Bw,B6,Bx;while(By<B0){Bw=B1;Bv=B3.attributes;for(Bx=0;Bx<Bz;Bx++){B6=Bv[Bx].value;if(Bx===(Bz-1)){Bw[B6]=AT.dftDel;}else{if(!Bw[B6]){Bw[B6]={};}Bw=Bw[B6];}}By++;B3=B3.nextElementSibling;}return B1;}function h(Bt){return parseInt(Bt,10);}function Bl(Bt){return !!(Bt&&Bt.toString()==="true");}function AJ(){var Bt=this.modelData.dz,Bu=this.props;if(Bt){if(Bt.ColorBy&&Bt.ColorBy.TemplateMetric&&Bt.ColorBy.TemplateMetric[0]&&Bt.ColorBy.TemplateMetric[0].id){Bu.colorMetricID=Bt.ColorBy.TemplateMetric[0].id;this.setColorByType("metric");}else{Bu.colorMetricID=Bh;if(Bt.ColorBy&&Bt.ColorBy.TemplateUnit){z.call(this,Bu,Bt.ColorBy.TemplateUnit,a);this.setColorByType("attribute");}}if(Bt.SizeBy&&Bt.SizeBy.TemplateMetric&&Bt.SizeBy.TemplateMetric[0]&&Bt.SizeBy.TemplateMetric[0].id){Bu.sizeMetricID=Bt.SizeBy.TemplateMetric[0].id;}else{Bu.sizeMetricID=Bh;}}}function Av(Bt){return AQ.getPropertyByPath(Bt,"ghs.chs.items.0.items",[]);}function A6(B1){var B0="",Bw=this.modelData,Bv=Bw.ghs.chs.items,Bu=Bv.length,Bx=Bv[0].items.length,B3=Bw.gts.col,By;if(B1<0||B1>=Bx){return"";}for(By=0;By<Bu;By++){var Bz=Bv[By].items[B1].idx;var B2=B3[By].es[Bz];var Bt=(B2.oid!==undefined)?B2.oid:B2.id;B0+=Bt+" ";}return B0.slice(0,B0.length-1);}function u(){var Bv=this.modelData,Bw=Av(Bv).length,Bt=this.props.sizeMetricID,B0=this.props.colorMetricID,B1=[],By;this.metricArray=B1;for(By=0;By<Bw;By++){B1.push(A6.call(this,By));}B1.push(Bh);Bw++;this.sizeMetricIndex=0;this.colorMetricIndex=Bw>2?1:0;for(By=0;By<Bw;By++){if(Bt===B1[By]){this.sizeMetricIndex=By;}if(B0===B1[By]){this.colorMetricIndex=By;}}if(Bt===undefined){Bt=B1[this.sizeMetricIndex];this.props.sizeMetricID=Bt;}if(B0===undefined){B0=B1[this.colorMetricIndex];this.props.colorMetricID=B0;}if(this.props.sizeMetricID===Bh){this.props.sizeMetricEnabled=false;}if(this.props.colorMetricID===Bh){this.props.colorMetricEnabled=false;this.colorTheme.hasNoColorMetric=true;}if(AQ.isOnExpressMode()&&this.props.colorMetricEnabled){this.setColorByType("metric");var Bu=Bv.gsi.thresholds;if(!Bu||Object.keys(Bv.gsi.thresholds).length===0){Bv.gsi.thresholds=AQ.getMockUpThresholds(this.props.colorMetricID,this.getMetricName(this.colorMetricIndex));}}this.props.hasColorInThresholds=false;if(this.isMetricColorByType()&&Bv.gsi.thresholds[this.props.colorMetricID]!==undefined){var B2=Bv.gsi.thresholds[this.props.colorMetricID];for(By=0;By<B2.length;By++){var Bz=B2[By];if(Bz&&Bz.fmt){var Bx=Bz.fmt;if(Bx.bc===undefined&&typeof Bx.fc=="string"){Bz.fmt.bc=Bx.fc;Bz.fmt.bgs=Bz.fmt.bgs||0;this.props.hasColorInThresholds=true;}else{if(Bx.bc){this.props.hasColorInThresholds=true;break;}}}}}if(this.isMetricColorByType()&&this.props.sizeMetricEnabled===false&&this.props.hasColorInThresholds===false){this.props.showLegend=false;}}function Bf(Bu,Bt){return this.getAttributeIndex({id:Bu},Bt);}function a(Bw,By){var Bu=this.modelData,Bv=Bu&&Bu.gts,Bx=Bv&&Bv.row,Bz=Bw.id,Bt=AQ.isHierarchyObject(Bw)?"hid":"id";return AQ.findInArray(Bx,function(B0){return B0[Bt]===Bz;},By);}function z(B0,Bv,Bt){var Bz=(Bv||[]).length,Bw,Bx=[],Bu=[],B1=this.modelData&&this.modelData.gts&&this.modelData.gts.row,By;for(Bw=0;Bw<Bz;Bw++){By=-1;while(true){By=Bt.call(this,Bv[Bw],By+1);if(By!==-1){Bx.push(By);}else{break;}}}Bx.sort();for(Bw=0,Bz=Bx.length;Bw<Bz;Bw++){Bu.push(B1[Bx[Bw]]);}B0.colorAttributeIndexes=Bx;B0.colorAttributes=Bu;}function AZ(){var B6=mstrmojo.netviz.PropertyParser,Bu=B6.BooleanProperty,Bz=B6.IntegerProperty,Bw=B6.FloatProperty,Bt=B6.StringProperty,By=B6.JsonProperty;var Bv=this.getProperties(),B1=BN.isSpatial(),Bx={deletedList:{key:O.deletedList,type:By.preset({}),preSet:function(B9,CA,B7,B8){return B9===undefined?B9:S(B9);}},showMetricValues:{key:O.showMetricValues,type:Bu.preset(B1)},labelSize:{key:O.labelSize,type:Bz.preset(BA.On),preSet:function(B9,CA,B7,B8){return BA[B9];},postGet:function(B9,CB,B7,B8){var CA="On";Object.keys(BA).some(function(CC){if(BA[CC]===parseInt(B9,10)){CA=CC;return true;}return false;});return CA;}},showLegend:{key:O.showLegend,type:Bu.preset(true)},layout:{key:O.layout,type:Bz.preset(Ag.Squarified)},isHeaderOnTop:{key:O.headerType,type:Bu.preset(true),preSet:function(B9,CB,B7,B8){if(B9===undefined){return ;}var CA=B9.toString();if(CA==="true"||CA==="false"){return CA==="true";}return h(B9)!==0;},postGet:function(B9,CA,B7,B8){return B9==="true"?1:0;}},themeType:{key:O.themeType,type:Bt.preset("light"),preSet:function(B9,CA,B7,B8){return h(B9)!==0?"light":"dark";},postGet:function(B9,CA,B7,B8){return B9==="dark"?0:1;}},headerColors:{key:O.headerColors,type:By.preset(Aa.clone(Ac)),postSet:function(CB,CC,B8,B9){var CA=true;if(CB){if(!(CB instanceof Array)){CB=[CB,CB,CB];}Ai.forEach(CB,function(CD){if(!Bj(CD)){if(CD&&CD.color!==undefined){CD.value=AK.getCSSColorString(CD.color);CD.opacity=1;CD.color=undefined;}else{CA=false;return false;}}});}else{CA=false;}var B7=CA?CB:Aa.clone(Ac);this.isDefaultHeaderColor=BH(B7)===false;return B7;}},fonts:{key:O.fonts,type:By.preset(Aa.clone(B1?Bq:A4)),postSet:function(B9,CA,B7,B8){return Aa.mergeHashes(Aa.clone(B1?Bq:A4),B9);}},attrColorByOpacity:{key:O.attrColorByOpacity,type:By.preset({})},metricColorByOpacity:{key:O.metricColorByOpacity,type:Bw.preset(1)},lgdBgFillClr:{key:Aq.LEGEND_BG_COLOR,type:By.preset(undefined)},lgdBgFillStyle:{key:Aq.LEGEND_BG_FILL_STYLE,type:Bt.preset(undefined)},lgdBgFillEff:{key:Aq.LEGEND_BG_FILL_EFFECT,type:Bt.preset(undefined)},lgdBgFillTrans:{key:Aq.LEGEND_BG_FILL_TRANSPARENCY,type:Bt.preset(undefined)},lgdFntSz:{key:Aq.LEGEND_FONT_SIZE,type:Bt.preset(undefined)},lgdFntFml:{key:Aq.LEGEND_FONT_FAMILY,type:Bt.preset(undefined)},lgdFntStyle:{key:Aq.LEGEND_FONT_STYLE,type:Bz.preset(undefined)},lgdFntClr:{key:Aq.LEGEND_FONT_COLOR,type:Bz.preset(undefined)},lgdBdrShw:{key:Aq.LEGEND_BORDER_SHOW,type:Bu.preset(undefined)},lgdBdrClr:{key:Aq.LEGEND_BORDER_COLOR,type:Bt.preset(undefined)},lgdBdrStyle:{key:Aq.LEGEND_BORDER_LINE_STYLE,type:Bt.preset(undefined)},lgdBdrThk:{key:Aq.LEGEND_BORDER_THICKNESS,type:Bt.preset(undefined)},lm:{key:X.LEGEND_MODE,type:Bz.preset(undefined)},LegendPosition:{key:X.LEGEND_POSITION,type:Bz.preset(2)},lwr:{key:X.SCALE_LEGEND_WIDTH,type:Bw.preset(undefined)}};var B2=mstrmojo.heatmap.vi.VisHeatMapColorTheme.newInstance();B2.initialize();this.colorTheme=B2;this.props=new B6().parse(Bv,Bx)||{};var B0=this.props;B2.style=B0.themeType;if(B0.showLegend&&!B0.colorByType&&B0.sizeMetricID===Bh){B0.showLegend=false;}B0.sizeMetricEnabled=true;B0.colorMetricEnabled=true;B0.legendAsc=true;B0.headerPixels=AV.HeaderPixels;var B5="metric",B4=this.modelData.dz,B3;if(AQ.isValidDropZone(B4)){AJ.call(this);}else{if(Bv[O.metricList]){B3=Bv[O.metricList].split(",");if(B3.length>=2){B0.sizeMetricID=B3[0]||Bh;if(h(Bv[O.colorByType])===1){this.setColorByType("attribute");B3.splice(0,1);B0.colorAttributeIDs=B3;z.call(this,B0,B3,Bf);}else{this.setColorByType(B5);B0.colorMetricID=B3[1];}}else{B0.sizeMetricID=Bh;}}}if(Bv.rlp==="false"&&Bv[O.absoluteFixed]){B2.convertAbsoluteToBlend(this,Bv);}B2.isBlend=true;if(Bv[O.blendColor]){B2.isBlend=Bl(Bv[O.blendColor]);}if(Bv.gradientColors&&Bv.bandColors){B2.createDataProviderFromString(Bv.gradientColors,Bv.bandColors);}if(Bv.rlp==="false"&&Bv[O.absoluteFixed]){this.colorTheme.convertAbsoluteToBlend(this,Bv);this.colorTheme.createDataProviderFromString(Bv.gradientColors,Bv.bandColors);}this.bgColor=this.getFormats()["background-color"]||B2.getBackgroundColor();this.background={value:this.bgColor,opacity:1};u.call(this);}function AB(){this.aggFunctions=[];var B1=this.props,B0=B1.colorMetricID,B3=this.aggFunctions,Bw=this.modelData,Bu=Bw.vp||{},Bx=this.metricArray,By=Bx.length-1,Bz;if(B0!==Bh){var B2=Bu["mle"+B0]==="true";if(B2){var Bv=parseFloat(Bu["mlma"+B0]);if(!isNaN(Bv)){this.mlmax=Bv;}Bv=parseFloat(Bu["mlmi"+B0]);if(!isNaN(Bv)){this.mlmin=Bv;}}}for(Bz=0;Bz<By;Bz++){var Bt="agf"+Bx[Bz];if(Bu[Bt]!==undefined){B3.push(parseInt(Bu[Bt],10));}else{B3.push(BO.AESum);}}}function U(){AB.call(this);var Cl=this.modelData,Cr=this.props.deletedList,Ca=(Cl.gts&&Cl.gts.row)||[],Ce=Ca.length,B4=(Cl.gvs&&Cl.gvs.items)||[],CW=(Cl.ghs&&Cl.ghs.rhs&&Cl.ghs.rhs.items)||[],CX=CW.length,B9=Av(Cl).length,CB=AQ.range(0,B9).map(AQ.hasValidValueInMetric.bind(this,this)),CU=this.colorMetricIndex,Bw={max:-Infinity,min:Infinity};if(Ce<=0&&!AQ.isOnExpressMode()&&!this.excludeData){this.setError(null,Bs.NO_TEMPLATE_UNIT);return ;}if(AQ.isOnExpressMode()&&(!AQ.hasOnlyMetricsOnColumn(Cl)||!AQ.hasNoMetricOnRow(Cl))){this.setError(mstrmojo.desc(13685,"The Heat Map requires at least one attribute on the row axis to render properly; it is recommended that two metrics be placed on the column axis as well"));return ;}if(AQ.hasMergedRowCells(Cl)){this.setError(mstrmojo.desc(13686,"The HeatMap doesn't support grid data with merged row cell. Please disable cell merge and retry"));return ;}if(this.props.sizeMetricID!==Bh){var Cv=B4.some(function(Cw){return(typeof (Cw.items[0].rv)==="number")&&Cw.items[0].rv;});if(!Cv&&!this.error){this.error=mstrmojo.desc(16186,"No data could be displayed for this view. This might be because the data only contains non-numeric string.");return ;}}if(AQ.isOnExpressMode()&&this.props.colorMetricEnabled&&CB[CU]){var Bt,CJ,Cn,By,Cc,Cu;for(Bt=0;Bt<CX;Bt++){CJ=CW[Bt]&&CW[Bt].items;Cn=CJ&&CJ.length;Cu=false;for(By=0;By<Cn;By++){if(CJ[By].etk===-1||CJ[By].etk==="-1"){Cu=true;break;}}if(Cu){continue;}Cc=B4[Bt]&&B4[Bt].items&&B4[Bt].items[CU];if(Cc){Bw.max=Math.max(Bw.max,Cc.rv);Bw.min=Math.min(Bw.min,Cc.rv);}}}this.hasNegativeSizeValue=false;this.levelAttributes=[];this.root={aggValues:[],entityChildren:[],level:0};var Cp,Cs=true,B8,Cj=this.model;for(Cp=0;Cp<Ce;Cp++){AQ.restoreEsForUnit(Ca[Cp]);B8=Cj.supportsViewFilterActions(Ca[Cp].id);Cs=Cs&&B8;this.levelAttributes[Cp]={index:Cp,order:Cp+1,isInLOA:Cp+1>0,supportsViewFilter:B8,name:Ca[Cp].n,id:Ca[Cp].id};}this.allSupportsViewFilter=Cs;var CK={},CV=[];for(Cp=0;Cp<Ce;Cp++){var Ci=Ca[Cp].fs;CV[Cp]=Math.max(1,Ci?Ci.length:1);}this.attSpan=CV;var CL=true,CI,B3,B1,CP,B7,Ch,Ck,CQ,CG,CY,CN,CH=Bw.max,Ct=Bw.min,Cg;for(Cp=0;Cp<CX;Cp++){var B6=CW[Cp].items,Co,Cm;var CM="",Bv=Cr,B5=this.root,Cb,B2=0,CC,CT,CZ,Cd=-1,CF;for(Co=0;Co<Ce;Co++){var Bz,Cf,Bx,CE,CD=1;if(Ca[Co].cs){CD=Ca[Co].cs;CF=true;}if(B6[B2].etk===-1||B6[B2].etk==="-1"){if(B5){Bx=B5.aggValues;for(Cm=0;Cm<B9;Cm++){Bz=parseFloat(AQ.getPropertyByPath(B4,Cp+".items."+Cm+".rv"));if(isNaN(Bz)){continue;}Bx[Cm]={AETotal:Bz};}}break;}else{var CS,Cq;CT="";CZ="";CQ=Ca[Co];CG=CV[Co];CN=[];for(Cm=0,CE=Math.max(CG,CD);Cm<CE;Cm++){if(B6[B2]&&B6[B2].tui===Co){CS=B6[B2].idx;B2++;if(CS===-1){continue;}CY=CQ.es[CS];if(CN.indexOf(CY)===-1){CT+=CY.n+" ";if(Cm===0){CZ=CY.id;CM+=CS;}CN.push(CY);}}}CT=CT.substring(0,CT.length-1);if(Bv){Bv=Bv[BI(CT)];}var B0;if(Co!==Ce-1){if(CK[CM]!==undefined){B5=CK[CM];}else{Cb={aggValues:[],entityChildren:[],parentEntity:B5};B0=B5.entityChildren;B0.push(Cb);CK[CM]=Cb;B5=Cb;Cb.deleted=false;Cb.text=CT;Cb.label=CT;Cb.id=CZ;Cb.level=Co;Cb.index=Cp;Ck=B6[B2-1];for(B7=0;B7!==c;B7+=1){Ch=Aj[B7];Cb[Ch]=Ck[Ch];}}CM+=":";Cq=Cb;}else{var CR;if(CK[CM]!==undefined){CC=CK[CM];CR=CC.indices;CR.push(Cp);for(Cm=0;Cm<B9+1;Cm++){Cf=CC.aggValues[Cm];Bz=parseFloat(Cm===B9?1:B4[Cp].items[Cm].rv);if(!CF){e.call(this,Cf,Bz,{needsCopy:true,invalidReplacement:CB[Cm]?0:1});}}}else{CC={indices:[],aggValues:[],parentEntity:B5};CR=CC.indices;CR.push(Cp);Bx=CC.aggValues;for(Cm=0;Cm<B9+1;Cm++){Cf={};Bx[Cm]=Cf;Bz=parseFloat(Cm===B9?1:B4[Cp].items[Cm].rv);if(isNaN(Bz)){Cf.value=CB[Cm]?0:1;Cf.count=0;}else{Cf.value=Bz;Cf.count=1;}Cf.allValueCount=1;}this.aggregated=false;if(Bv){CC.deleted=true;this.colorTheme.useDefault=false;}if(this.isMetricColorByType()&&this.props.colorMetricID!==Bh&&CB[CU]){var Cc=B4[Cp].items[CU],Bu=Cc.ti,CO=parseFloat(Cc.rv);if(CO===""||CO===undefined||CO===null){Bu=-1;}else{if(Bu===undefined){if(AQ.isOnExpressMode()){if(CH===Ct){Cg=0;}else{Cg=(CO-Ct)/(CH-Ct);}if(Cg<0.1){Bu=0;}else{if(Cg>=0.1&&Cg<0.3){Bu=1;}else{if(Cg>=0.3&&Cg<0.5){Bu=2;}else{if(Cg>=0.5&&Cg<0.7){Bu=3;}else{if(Cg>=0.7&&Cg<0.9){Bu=4;}else{if(Cg>=0.9){Bu=5;}}}}}}}else{Bu=-1;}}}CC.thrColorIndex=Bu;}else{CC.thrColorIndex=-1;}B0=B5.entityChildren;B0.push(CC);CC.level=Ce-1;CC.text=CT;CC.label=CT;CC.id=CZ;CK[CM]=CC;Ck=B6[B2-1];for(B7=0;B7!==c;B7+=1){Ch=Aj[B7];CC[Ch]=Ck[Ch];}}Cq=CC;}if(B6[Co].cet!==undefined){if(Co-Cd!==1||(!isNaN(CI)&&CI!==Cp)){CL=false;}if(CL){B3=Cq;Cd=Co;CI=Cp;}if(isNaN(CP)||CP<Co){CP=Co;B1=Cq;}}}}}if(this.errorType!==Bs.EMPTY_DATA&&!A(this.root)&&!this.excludeData){this.setError(mstrmojo.desc(2388,"No data returned for this view. This might be because the applied filter excludes all data."));return ;}function CA(Cx){var Cy=[];var Cw;if(Cx.entityChildren){for(Cw=0;Cw<B9+1;Cw++){if(!Cy[Cw]){Cy[Cw]={AETotal:0,isAETotalFaked:false};}}Ai.forEach(Cx.entityChildren,function(C2){var C0=CA(C2);var Cz,C4,C3,C1;for(Cw=0;Cw<B9+1;Cw++){C4=Cy[Cw];Cz=C0[Cw];if(C2.entityChildren){C4.AETotal+=Cz.AETotal;C4.isAETotalFaked|=Cz.isAETotalFaked;}else{C3=Cz.total;if(C3===undefined){C3=Cz.value;}C1=Cz.allValueCount!==0&&Cz.count!==0;Cy[Cw].AETotal+=C3;Cy[Cw].isAETotalFaked|=!C1;}}});for(Cw=0;Cw<B9+1;Cw++){if(!Cx.aggValues[Cw]){Cx.aggValues[Cw]=Cy[Cw];}}}return Cx.aggValues;}CA(this.root);if(CL&&B3){this.previousSelected=[B3];}else{if(B1){this.previousSelected=[B1];}}}function A0(Bx,Bv,Bu){var Bt=Bx.aggValues;if(Bv>=Bt.length){return NaN;}var Bw=Bt[Bv];if(Bx.entityChildren===undefined){return Bw.allValueCount===1?Bw.value:Bw.total;}else{return Bw.AETotal;}}function b(Bv,Bu){var Bt=Bu.sizeMetricIndex,Bw=A0(Bv,Bt,Bu);if(Bw<0){Bu.hasNegativeSizeValue=true;return Math.abs(Bw);}return Bw;}function L(Bu){var Bt={};Bt.x=Bu.x;Bt.y=Bu.y;Bt.w=Bu.w;Bt.h=Bu.h;return Bt;}function A7(Bx){var Bv=BN.isSpatial(),Bw=Bv?AP.DEFAULT_THEME_PROPS[G]:AP.CLASSIC_THEME_PROPS[G];var By=Bx.level,Bt=this.levelAttributes.length,Bu;switch(Bt){case 1:Bu={v:1,h:1};break;case 2:switch(By){case 0:Bu={v:1,h:3};break;default:Bu={v:1,h:1};}break;case 3:switch(By){case 0:Bu={v:1,h:Bw.largeGap};break;case 1:Bu={v:1,h:3};break;default:Bu={v:1,h:1};}break;default:switch(By){case 0:Bu={v:1,h:Bw.largerGap};break;case 1:Bu={v:1,h:Bw.middleGap};break;case 2:Bu={v:1,h:Bw.smallGap};break;default:Bu={v:1,h:1};}}if(!this.props.isHeaderOnTop){Bu.v=Bu.h;}return Bu;}function C(Bt){return Bt.w>0&&Bt.h>0;}function BW(Bt){var Bu=L(Bt);if(!C(Bt)){Bu.w=0;Bu.h=0;}return Bu;}function AO(Bt){var Bu=Bt.x;Bt.x=Bt.y;Bt.y=Bu;Bu=Bt.w;Bt.w=Bt.h;Bt.h=Bu;return Bt;}function BJ(Bw,Bu){var Bt=Math.max(Bw.x,Bu.x);var By=Math.max(Bw.y,Bu.y);var Bv=Math.min(Bw.x+Bw.w,Bu.x+Bu.w)-Bt;var Bx=Math.min(Bw.y+Bw.h,Bu.y+Bu.h)-By;if(Bv<0||Bx<0){return{x:NaN,y:NaN,w:NaN,h:NaN};}return{x:Bt,y:By,w:Bv,h:Bx};}function w(Bx,Bv){var Bu=BW(Bv);Bx.size=Bu;if(this.props.isHeaderOnTop&&Bx.entityChildren){var Bw=this.props.headerPixels,By=A7.call(this,Bx).v,Bt=A7.call(this,Bx).h;if(BN.isSpatial()&&Bu.y>0){Bu.y=Bu.y-1+Bt;Bu.h=Bu.h+1-Bt;}Bx.headerSize=BW({x:Bu.x,y:Bu.y,w:Bu.w,h:Math.min(Bw,Bu.h)});Bx.contentSize=BW({x:Bu.x,y:Bu.y+Bw+By,w:Bu.w,h:Bu.h-Bw-By});Bx.size=L(Bx.contentSize);Bv.y=Bx.contentSize.y;Bv.h=Bx.contentSize.h;}else{delete Bx.headerSize;delete Bx.contentSize;}}function AC(CA,CN,CE,Bx,CP){var CF,CB,B6=CA.r||[],CG=B6.length,B5,CJ,CC,CO=false;if(CG===0){return ;}if(CE<CN.h){B5=CE;CJ=CN.h;CC=CN;}else{B5=CN.h;CJ=CE;CC=L(CN);AO(CC);CO=true;}var B3=CC.x,B2=CC.y,Bu={x:B3,y:B2,w:B5,h:CJ};var CD=A7.call(this,B6[0]),CI,Bw=this;var Bz={v:CD.v,h:CD.h};if((CP===true&&CO!==true)||(CP===false&&CO===true)){Bz={v:CD.h,h:CD.v};}var CK=function CK(CS,CR){var CU=b(CS,Bw),CT=b(CR,Bw),CQ;if(isNaN(CU)){if(isNaN(CT)){CQ=0;}else{CQ=1;}}else{if(isNaN(CT)){CQ=-1;}else{CQ=CU<CT?1:-1;}}return CQ;};var B7=function(CU,CV,CS){if(B8){return 1;}var CT=b(CU,CV),CR=CJ*CT/Bx;var CQ=(Bx<=0||CU.deleted)?0:Math.ceil(CR);if(CQ>0){CL+=CQ-CR;}if(CT<Bx){if(CS===0&&CG>1){if(B0>1){if(CQ>(B0>>1)){CQ-=(B0>>1);}}else{if(CQ>1){CQ--;}}if(CQ+(CG-1)*(B0+1)>=CJ){CQ=CJ-(CG-1)*(B0+1);B8=true;}}else{if(CS<CG-1){if(B0>1){if(CQ>(B0>>1)){CQ-=B0;}else{CQ=1;}}else{if(CQ>1){CQ--;}}if(CL>1&&CQ>1){CQ--;CL-=1;}}else{CQ=Math.max(CJ+CC.y-B2,1);}}}return CQ;};var B4=0,CM,CH,B0=Bz.v,By=Math.max(1,Math.floor((CJ+B0)/(1+B0)));if(CG>By){for(CI=0;CI<CG;CI++){CM=B6[CI];if(CM.deleted){continue;}B4++;}}for(CH=CG-1,CI=B4-By;CI>0;CH--){CM=B6[CH];if(!CM.deleted){Bx-=b(CM,this);CI--;}}var CL=0,B8=false;for(CH=0,CI=0,B4=B6.length,CG=Math.min(CG,By);CI<B4;CH++){var Bv,B9;CM=B6[CH];if(CM.deleted){continue;}if(CI>=CG){CB=0;}else{CB=B7(CM,this,CI);}CI++;CF=B5;var B1={x:B3,y:B2,w:CF,h:CB};Bv=BJ(B1,Bu);if((CP===true&&CO!==true)||(CP===false&&CO===true)){AO(Bv);}w.call(this,CM,Bv);B2+=CB+B0;if(CM.entityChildren!==undefined){B9=Math.min(Bv.w,Bv.h);var Bt=CM.entityChildren.slice(0);Bt.sort(CK);Al.call(this,Bt,{r:[]},B9,Bv);}}}function BZ(B2,CD){var Bv=0,Bt=B2.r,B6=Bt.length;if(B6===0){return ;}var B7,B4=Bt[0].parentEntity,B0=B4.entityChildren,Bx=B0.length;var B8,CA,By;for(B8=0;B8<B6;B8++){CA=Bt[B8];By=b(CA,this);if(!CA.deleted&&By>0){Bv+=By;}}if(B2.t===undefined){var B1=0;for(B8=0;B8<Bx;B8++){CA=B0[B8];By=b(CA,this);if(!CA.deleted&&By>0){B1+=By;}}B2.t=B1;}CA=Bt[0];var B3=A7.call(this,CA),Bu={x:0,y:0,w:0,h:0};if(CA===this.root){B7=this.heatMapSize.w*this.scaleFactor*this.heatMapSize.h*this.scaleFactor;Bu.w=this.heatMapSize.w*this.scaleFactor;Bu.h=this.heatMapSize.h*this.scaleFactor;}else{if(B4===this.root){B7=this.heatMapSize.w*this.scaleFactor*this.heatMapSize.h*this.scaleFactor;Bu.w=this.heatMapSize.w*this.scaleFactor;Bu.h=this.heatMapSize.h*this.scaleFactor;}else{var CF=B4.size;B7=CF.w*CF.h;Bu=L(CF);}if(B2.t===0){B7=0;}else{B7*=Bv/B2.t;}}var Bz=CD.w,B9=CD.h,CE=false;if(CD.h>=CD.w){CE=true;AO(CD);AO(Bu);var CB=Bz;Bz=B9;B9=CB;B3={h:B3.v,v:B3.h};}if((Bu.x<CD.x)||(Bu.x+Bu.w>CD.x+CD.w)){if(B3.h>1){Bz+=(B3.h>>1);}}if((Bu.y<CD.y)||(Bu.y+Bu.h>CD.y+CD.h)){if(B3.v>1){B9+=(B3.v>>1);}}var B5=B9===0?0:Math.min(CD.w,Math.ceil(B7/B9));if(Bv<B2.t&&Bv>0){if(CD.x+B5<Bu.x+Bu.w){if(B3.h>1){if(B5>B3.h>>1){B5-=(B3.h>>1);}}else{if(B5>1){B5--;}}}}AC.call(this,B2,CD,B5,Bv,CE);var CC=CD.x+B5,Bw=CD.w-B5;if(Bv<B2.t&&Bv>0){if(CD.x+B5<Bu.x+Bu.w){if(B3.h>1){if(Bw>B3.h){CC+=B3.h;Bw-=B3.h;}}else{if(Bw>1){CC++;Bw--;}}}}CD.x=CC;CD.w=Math.max(0,Bw);if(CE){AO(CD);}}function m(B0,B2,CB){var B3,Bt=B0.r,B5=Bt.length;if(B5>0&&CB>0){var CA=Bt[0];var B1=0,B6=this;if(B0.t===undefined){Ai.forEach(CA.parentEntity.entityChildren,function(CD){if(!CD.deleted){B1+=b(CD,B6);}});B0.t=B1;}else{B1=B0.t;}if(isNaN(B1)||B1<=0){return -1;}var B4,B7,Bu=0,CC,B9=false,B8;for(B8=0;B8<B5;B8++){CA=Bt[B8];if(!CA.deleted){CC=b(CA,this);if(!isNaN(CC)){if(B9===false){B7=B4=CC;B9=true;}else{B7=Math.max(CC,B7);B4=Math.min(CC,B4);}Bu+=CC;}}}var Bv=CB*Bu/B1,By=Bv/B2,Bz=(B2<By)?B2:By;B7=CB*B7/B1;B4=CB*B4/B1;var Bx=B7/(Bz*Bz);var Bw=B4/(Bz*Bz);Bx=(Bx>1)?Bx:(1/Bx);Bw=(Bw>1)?Bw:(1/Bw);B3=Math.max(Bx,Bw);}else{B3=-1;}return B3;}function Al(B5,Bt,Bw,B2,B3){var Bx=[[this,B5,Bt,Bw,B2,B3]];while(Bx.length){var Bv=Bx.pop();var B1=Bv.shift();B5=Bv.shift();Bt=Bv.shift();Bw=Bv.shift();B2=Bv.shift();B3=Bv.shift();if(B5.length===0){BZ.call(B1,Bt,B2);}else{var Bu=B2.w*B2.h;var B4;if(B3!==undefined){B4=B3;}else{B4=m.call(B1,Bt,Bw,Bu);}var By=B5[0],Bz=Bt.r;Bz.push(By);var B0=m.call(B1,Bt,Bw,Bu);if(B4>=B0||B4===-1){B5.shift();Bx.push([B1,B5,Bt,Bw,B2,B0]);}else{Bt.r.pop();BZ.call(B1,Bt,B2);Bw=Math.min(B2.w,B2.h);Bx.push([B1,B5,{r:[],t:Bt.t},Bw,B2]);}}}}function d(Bv){if(Bv===null){return[];}var Bt=Bv.slice(0),Bx=0,Bu=Bt.length,Bw;Bt.t=[];for(Bw=0;Bw<Bu;Bw++){var By=Bt[Bw],Bz=b(By,this);if(By.deleted||isNaN(Bz)||Bz<=0){Bt.splice(Bw,1);Bw--;Bu--;continue;}Bx+=Bz;Bt.t[Bw]=Bx;}return Bt;}function BS(Bx,B0,Bz,By){var Bv=L(B0);if(Bz===true){AO(Bv);}w.call(this,Bx,Bv);var Bw=Bx.entityChildren;if(Bw!==undefined){var Bt=d.call(this,Bw),Bu=Bt.length;if(Bu>0&&By){By.push([this,Bt,0,Bu-1,Bv]);}}}function BK(B2,CE,B4,CK){var CL=[[this,B2,CE,B4,CK]];while(CL.length){var By=CL.pop();var CG=By[0];B2=By[1];CE=By[2];B4=By[3];CK=By[4];var CI=B2[0],CA=A7.call(CG,CI),CC,CF,Bw,Bx,B0,CO=false,CB=B4-CE+1,Bz=(CB>2?((CB-1)>>1):(CB>>1))+CE,B8;B8=L(CK);if(B8.w<=B8.h){AO(B8);CA={v:CA.h,h:CA.v};CO=true;}CC=L(B8);CF=L(B8);if(CE===B4){CI=B2[CE];BS.call(CG,CI,B8,CO,CL);continue;}if(CE+1===B4){CI=B2[CE];Bw=b(CI,CG);CI=B2[B4];Bx=b(CI,CG);}else{if(CE===0){Bw=B2.t[Bz-1];}else{Bw=B2.t[Bz-1]-B2.t[CE-1];}if(Bz===0){Bx=B2.t[B4];}else{Bx=B2.t[B4]-B2.t[Bz-1];}}B0=Bw/(Bw+Bx);CC.w=Math.ceil(CC.w*B0);if(CC.w<CK.w){if(CA.h>1){if(CC.w>(CA.h>>1)){CC.w-=(CA.h>>1);}}else{if(CC.w>1){CC.w--;}}}if(CE+1===B4){CF.w-=CC.w+CA.h;CF.x+=CC.w+CA.h;CI=B2[CE];BS.call(CG,CI,CC,CO,CL);CI=B2[B4];BS.call(CG,CI,CF,CO,CL);continue;}var CQ=L(B8),B3,B7,Bv=0,CJ=-1,CD=1,B9;if(Bz>CE){var B1=L(CC);if(CO){AO(B1);}CL.push([CG,B2,CE,Bz-1,B1]);}CQ.w-=CC.w+CA.h;CQ.x+=CC.w+CA.h;CF.w=CQ.w;CF.x=CQ.x;B3=CQ.w/CQ.h;CI=B2[Bz];B9=b(CI,CG);B7=B9/Bx;var CH;for(CH=Bz;CH<=B4;CH++){CI=B2[CH];Bv+=b(CI,CG);if(CH===B4-1){continue;}var Bu=Bv/Bx,CP=B9/Bv,CN=Bu/CP*B3;if(CN>=1){if(CD<1&&CD*CN>1){CJ=(CH===B4)?CH-2:CH-1;}else{CJ=CH;}break;}CD=CN;}CJ=CJ<0?B4:CJ;var B6,B5,CM;if(Bz===0){B6=B2.t[CJ];}else{B6=B2.t[CJ]-B2.t[Bz-1];}B5=Math.min(Math.ceil(CQ.w*(B6/Bx)),CQ.w);CM=Math.min(Math.ceil(CQ.h*(B9/B6)),CQ.h);if(B5<CQ.w){if(CA.h>1){if(B5>(CA.h>>1)){B5-=(CA.h>>1);}}else{if(B5>1){B5--;}}}if(CM<CQ.h){if(CA.v>1){if(CM>(CA.v>>1)){CM-=(CA.v>>1);}}else{if(CM>1){CM--;}}}var Bt={x:CQ.x,y:CQ.y,w:B5,h:CM};CI=B2[Bz];BS.call(CG,CI,Bt,CO,CL);if(Bz<CJ){CQ.y+=CM+CA.v;CQ.w=B5;CQ.h-=CM+CA.v;if(CO){AO(CQ);}CL.push([CG,B2,Bz+1,CJ,CQ]);}if(CJ<B4){CF.x+=B5+CA.h;CF.w-=B5+CA.h;if(CO){AO(CF);}CL.push([CG,B2,CJ+1,B4,CF]);}}}function BM(B0,CA){var CB=[[this,B0,CA]];while(CB.length){var Bu=CB.pop();var B6=Bu[0];B0=Bu[1];CA=Bu[2];if(B0===null||B0.length===0){continue;}var Bz=0,B9=B0[0],CD,B3=A7.call(B6,B9),CC=false,B5=B0.length,Bx,Bw,By,B8;var B7;for(B7=0;B7<B5;B7++){B9=B0[B7];CD=b(B9,B6);if(!B9.deleted&&CD>0){Bz+=CD;}}if(CA.w>=CA.h){CC=true;AO(CA);B3={h:B3.v,v:B3.h};}By=CA.w;B8=CA.h;Bx=CA.x;Bw=CA.y;for(B7=0;B7<B5;B7++){B9=B0[B7];CD=b(B9,B6);if(!B9.deleted&&CD>0){var B4,B2;B2=Bz<=0?0:Math.ceil(CD/Bz*B8);B4=By;if(CD<Bz){if(B7===0||B7===B5-1){if(B3.v>1){if(B2>(B3.v>>1)){B2-=(B3.v>>1);}}else{if(B2>1){B2--;}}}else{if(B2>B3.v){B2-=B3.v;}}}B4=Math.max(0,B4);B2=Math.max(0,B2);var Bv={x:Bx,y:Bw,w:B4,h:B2},Bt=BJ(Bv,CA);Bw+=B2+B3.v;if(Bw>=CA.y+B8){Bt.h=CA.y+B8-Bt.y;}if(CC){AO(Bt);}w.call(B6,B9,Bt);if(B9.entityChildren!==undefined){CB.push([B6,B9.entityChildren,Bt]);}}else{var B1={x:Bx,y:Bw,w:0,h:0};if(CC){AO(B1);}w.call(B6,B9,B1);continue;}}if(CC){AO(CA);}}}function BD(){var Bv=0;if(this.props.showLegend){Bv=Math.min(Math.floor(0.2*(parseInt(this.height,10)-2*this.LayoutProperties.Padding)),this.LayoutProperties.MaxLegendHeight);}var B0=this,Bz=L(this.heatMapSize);Bz.x=0;var Bw=Math.min(Bz.w,Bz.h);var Bx=this.root.entityChildren;var Bt;switch(this.props.layout){case Ag.Squarified:Bt=Bx.slice(0);Bt.sort(function By(B2,B1){var B4=b(B2,B0);var B3=b(B1,B0);if(isNaN(B4)){if(isNaN(B3)){return 0;}return 1;}if(isNaN(B3)){return -1;}return B4<B3?1:-1;});Al.call(this,Bt,{r:[]},Bw,Bz);break;case Ag.SliceAndDice:BM.call(this,Bx,Bz);break;case Ag.PivotByMiddle:Bt=d.call(this,Bx);var Bu=Bt.length;if(Bu>0){BK.call(this,Bt,0,Bu-1,Bz);}break;}}function As(Bv,Bt){var Bu=mstrmojo.desc(14109,"Total of")+" {0}";return Bu.replace("{0}",Bv);}function A3(By,B2,Bu,Bt){var Bx=(By.index===undefined)?By.indices[0]:By.index;var B4=AQ.getPropertyByPath(B2,"modelData.gvs.items",[]);var B0=B2.getMetricName(Bu);var B1,B3,Bz,Bw;if(Bu===-1){B1=BT;}else{if(By.entityChildren!==undefined||B2.aggregated){B3=B2.aggFunctions[Bu];B0=As(B0,B3);B1=A0(By,Bu,B2);Bz=AQ.getPropertyByPath(By,"aggValues."+Bu);if(Bz.isAETotalFaked||isNaN(B1)){B1=BT;}else{var Bv=B2.getFormatString(Bu);B1=B2.nf.formatByMask(Bv,B1);}}else{B1=AQ.getPropertyByPath(B4,Bx+".items."+Bu+".v");if(B1===""||B1===undefined||B1===null){B1=BT;}}}Bw={n:B0,v:B1};if(Bt){Bt.push(Bw);}return Bw;}function BR(By,Bt){var Bx=AQ.getPropertyByPath(By,"modelData.gts.col.0.es.length",0);var Bw=[];var Bu=By.sizeMetricIndex,Bv=By.colorMetricIndex;if(Bu!==undefined&&Bu!==Bx){Bw.push(Bu);}if(!By.isAttributeColorByType()&&Bt.entityChildren===undefined&&Bv!==undefined&&Bv!==Bx&&Bv!==Bu){Bw.push(Bv);}AQ.range(0,Bx).forEach(function(Bz){if(Bw.indexOf(Bz)===-1){Bw.push(Bz);}});return Bw;}function AD(CC,By){var Bu=CC.level,Bx=(CC.index===undefined)?CC.indices[0]:CC.index,B3=By.attSpan,Bt=By.modelData.ghs.rhs.items,CE=Bt[Bx].items,B6=By.modelData.gts.row,B5;var CG="",B4="",CD=[],Bw=0,Bz,B1,B9,B2,B8,B0,B7,CB,Bv,CA;for(B9=0;B9<=Bu;B9++){if(B9>0&&B9===Bu){CD.push(null);}B5=B6[B9];B8=B5.cs?B5.cs:1;if(By.modelData.lnm===s.OFF){CG=B5.n;Bz=B5.id;B4="";CA=[];for(B7=0,CB=Math.max(B3[B9],B8);B7<CB;B7++){if(CE[Bw]&&CE[Bw].tui===B9){B2=CE[Bw].idx;Bw++;if(B2===-1){continue;}Bv=B5.es[B2];if(CA.indexOf(Bv)===-1){B4+=Bv.n+" ";if(B7===0){B1=Bv.id;}CA.push(Bv);}}}B4=B4.substring(0,B4.length-1);CD.push({n:CG,v:B4,tid:Bz,eid:B1});}else{for(B7=0,CB=Math.max(B3[B9],B8);B7<CB;B7++){if(CE[Bw]&&CE[Bw].tui===B9){B2=CE[Bw].idx;B0=CE[Bw].fi?CE[Bw].fi:0;Bw++;if(B2===-1){continue;}CD.push({n:B5.fs[B0].n,v:B5.es[B2].n});}}}}var CF=BR(By,CC);if(y){CF.push(-1);}CF.forEach(function(CH){A3(CC,By,CH,CD);});return CD;}function AN(Bt){return{evt:Bt,target:Bt.getTarget(),pageX:Bt.e.pageX,pageY:Bt.e.pageY,clientX:Bt.e.clientX,clientY:Bt.e.clientY};}var p=function(By,Bx,Bw){if(AQ.isOnExpressMode()){return ;}var Bu=By.e||By,Bz=Bu.ctrlKey||Bu.metaKey,Bt=this.getSelectionMenuConfig(Bw);if(!mstrApp.isAppStatePresentation()&&mstrApp.allowWebDashboardDesign()&&Bx){var Bv=this;Bt.addSeparator();Bt.addMenuItem(mstrmojo.desc(1918,"Format"),"xt",function(){mstrApp.rootCtrl.docCtrl.selectViPanel("propertiesPanel");Bv.parent.selectVIUnit();Bx(By);});}if(Bt.hasMenuItems()&&Bz===false){this.showMenu(Bt,Bu,true);}};function Bk(Bt){if(AQ.isOnExpressMode()||mstrApp.isAppStatePresentation()||!mstrApp.allowWebDashboardDesign()||mstrApp.isInVFConfigMode){return ;}Bt=Bt.e||Bt;this.showMenu(this.getBlankSpaceMenuConfig(Bt),Bt);}var f={BACKGROUND:"background",RECTANGLE:"rectangle",RECTANGLE_LABEL:"rectangleLabel",LEGEND_BACKGROUND:"legendBackground"};function AX(){function B0(B5,CA,B4){var B3=this.props,B7=B4.updateModel,B9=B4.toModelValue,B8=B4.toModelPropName,B6;B3.unmarshal(B5,CA);B6=B3[B5];if(B7){if(B9 instanceof Function){B6=B9.call(this,B5,B6);}if(B8 instanceof Function){B5=B8.call(this,B5);}this.observableModel[B5].setValue(B6,true);}return B6;}function Bx(B4){var B3=this.attributeColorByLegend;if(B3){B3.updateStyle(this.HTML5PROPS.LEGEND);if(B4){B3.updateTitleLineHeight();this.hEvalSize4Legend();this.updateLegend();B3.updateSplitter();this.updateCanvasAfterAttributeLegendChanged(D[B3.currDockedPositionIdx].pos,this.legendW);}}}var B1=function(){var B4=this.props,B3=B4.themeType==="light"?0:1,B5={value:this.bgColor,opacity:Ba.lgdBgFillTrans[B3]/100};if(B4.lgdBgFillClr){B5.value=k.decodeColor(B4.lgdBgFillClr);}if(B4.lgdBgFillTrans){B5.opacity=B4.lgdBgFillTrans/100;}return B5;};var Bv=function(B3,B5,B4,B7){function B6(CB,CA){B0.call(this,B3,CB,{updateModel:CA,toModelPropName:function(CC){if(CC===Aq.LEGEND_BG_COLOR||CC===Aq.LEGEND_BG_FILL_TRANSPARENCY){return"legendBackground";}return CC;},toModelValue:function(CD,CC){if(CD===Aq.LEGEND_BG_COLOR||CD===Aq.LEGEND_BG_FILL_TRANSPARENCY){return B1.call(this);}return CC;}});var B9=this.attributeColorByLegend;if(!B9||!B9.hasRendered){return ;}this.initHTML5Props(this.HTML5PROPS);if(B3===Aq.LEGEND_FONT_FAMILY||B3===Aq.LEGEND_FONT_STYLE){var B8=[];Ap.call(this,B8);this.loadFonts(B8,{success:Bx.bind(this,true),failure:Bx.bind(this,true)});}else{Bx.call(this,B7);}}B6.call(this,B5);this.setProperty(B4,this.props.marshal(B3),{suppressData:true,clientUndoRedoCallback:B6});}.bind(this);function B2(B5,B4,B3){return function(){function B8(CA,B9){B0.call(this,B4,CA,Aa.copy(B6,{updateModel:B9}));if(!(this.excludeData||this.isEmpty())){this.refreshWidget();}if(B9&&B7){this.parent.selectVIUnit(true);}}B3=Aa.copy(B3,{refreshPropertyPanel:true});var B7=B3.refreshPropertyPanel;var B6=B3.modelConfig;B8.call(this,By[B4].getValue(),false);this.setProperty(B5,this.props.marshal(B4),{suppressData:true,clientUndoRedoCallback:B8});};}var Bw=this.props.headerColors,Bz=this.getPropsInfo(),Bt=this.isAttributeColorByType()?"attrColorByOpacity":"metricColorByOpacity",By=new mstrmojo.netviz.ObservableModel({isHeaderOnTop:Bz.isHeaderOnTop,labelSize:Bz.labelSize,showMetricValues:Bz.showMetricValues,layout:Bz.layout,background:this.background,headerColors:Bw[0],fonts:Bz.fonts,legendBackground:B1.call(this),showLegend:Bz.showLegend,colorByOpacity:Bz[Bt],lgdFntSz:Bz.lgdFntSz,lgdFntFml:Bz.lgdFntFml,lgdFntClr:Bz.lgdFntClr,lgdFntStyle:Bz.lgdFntStyle}),Bu=this.id;By.isHeaderOnTop.attachEventListener("valueChanged",Bu,B2(O.headerType,"isHeaderOnTop"));By.labelSize.attachEventListener("valueChanged",Bu,B2(O.labelSize,"labelSize"));By.showMetricValues.attachEventListener("valueChanged",Bu,B2(O.showMetricValues,"showMetricValues"));By.layout.attachEventListener("valueChanged",Bu,B2(O.layout,"layout"));By.headerColors.attachEventListener("valueChanged",Bu,B2(O.headerColors,"headerColors",{refreshPropertyPanel:false,modelConfig:{toModelValue:function(B4,B3){return B3&&B3[0];}}}));By.background.attachEventListener("valueChanged",Bu,function(B4){this.background=By.background.getValue();var B3=this.getSingleBackgroundColor();if(!this.canvasObject){return ;}this.canvasObject.bgColor=B3;this.highlightCanvas.backgroundColor=B3;var B5=AA.encodeColor(this.getFormats()["background-color"],10),B6=AA.encodeColor(B4.newValue,10);if(B5!==B6){AQ.changeWidgetBackground(this,B4.newValue,B4.oldValue);}this.canvasObject.removeLabels();this.canvasObject.drawLabels();});By.fonts.attachEventListener("valueChanged",Bu,function(){var B3="fonts";function B4(B8,B7){function CA(CB){return function(CF,CD){if(CF.valid){return ;}var CE=AQ.getPropertyByPath(B9,CB),CC=AQ.getPropertyByPath(By.fonts,CB);if(CE&&CC){CE.scale=CD;CC.scale.setValue(CD,true);}};}var B9=B0.call(this,B3,B8,{updateModel:B7});Ar(B9,AR(E,CA));A8.call(this,B9);if(!this.isEmpty()){var B5=[];this.canvasObject.fonts=this.props.fonts;function B6(){this.refreshWidget();}Y.call(this,B5);this.loadFonts(B5,{success:B6.bind(this),failure:B6.bind(this)});}}B4.call(this,By.fonts.getValue(),false);this.setProperty(O.fonts,this.props.marshal(B3),{suppressData:true,clientUndoRedoCallback:B4});});By.legendBackground.attachEventListener("valueChanged",Bu,function(B5){var B3,B4=B5.newValue;if(isNaN(B4)){B4=k.encodeColor(B4);B3=Aq.LEGEND_BG_COLOR;}else{B4*=100;B3=Aq.LEGEND_BG_FILL_TRANSPARENCY;}Bv(B3,B4,B3,false);});By.lgdFntSz.attachEventListener("valueChanged",Bu,function(B3){Bv("lgdFntSz",B3.newValue,Aq.LEGEND_FONT_SIZE,true);});By.lgdFntFml.attachEventListener("valueChanged",Bu,function(B3){Bv("lgdFntFml",B3.newValue,Aq.LEGEND_FONT_FAMILY,true);});By.lgdFntClr.attachEventListener("valueChanged",Bu,function(B3){Bv("lgdFntClr",B3.newValue,Aq.LEGEND_FONT_COLOR,false);});By.lgdFntStyle.attachEventListener("valueChanged",Bu,function(B3){Bv("lgdFntStyle",B3.newValue,Aq.LEGEND_FONT_STYLE,true);});By.showLegend.attachEventListener("valueChanged",Bu,function(B3){var B4="showLegend";function B5(B9,B8){var B6=B0.call(this,B4,B9,{updateModel:B8});var B7=this.attributeColorByLegend;if(!B7){this.reRender();return ;}this.toggleLegend(B6);this.updateCanvasAfterAttributeLegendChanged(D[B7.currDockedPositionIdx].pos,(B6?this.legendW:0));}B5.call(this,B3.newValue,false);this.setProperty(O.showLegend,this.props.marshal(B4),{suppressData:true,clientUndoRedoCallback:B5});});By.colorByOpacity.attachEventListener("valueChanged",Bu,function(B3){function B4(B6,B5){B0.call(this,Bt,B6,{updateModel:B5,toModelPropName:function(B7){return"colorByOpacity";}});this.refreshWidget();}B4.call(this,B3.newValue,false);this.setProperty(O[Bt],this.props.marshal(Bt),{suppressData:true,clientUndoRedoCallback:B4});});return By;}function Ah(By,Bu){if(!By.family){return ;}var Bt=By.family,Bx=By.style?parseInt(By.style):0,Bw=Bx&AM.FS_BOLD?true:false,Bz=Bx&AM.FS_ITALIC?true:false,Bv=Ai.some(Bu,function(B0){return B0.name===Bt&&B0.isBold===Bw&&B0.isItalic===Bz;});if(!Bv){Bu.push({name:Bt,isItalic:Bz,isBold:Bw});}}function Y(Bt){var Bu=Aa.clone(this.props.fonts);Ah(Bu.headerOnMiddle,Bt);Ah(Bu.headerOnTop.header,Bt);Ah(Bu.headerOnTop.cell,Bt);}function Ap(Bt){var Bw=this.readGlobalAttriLegndProperty(Aq.LEGEND_FONT_FAMILY),Bv=this.readGlobalAttriLegndProperty(Aq.LEGEND_FONT_STYLE),Bu={family:Bw,style:Bv};Ah(Bu,Bt);}function Az(Bt,Bu){if(Bt===undefined||Bt===null||Bt.length===0){return false;}return Bt.every(function(Bv){return Bu(Bv.level);});}function Ao(){var Bt=this.levelAttributes.length-1,Bv,Bu;Bv=this.contextMenuSelection.length>0?this.contextMenuSelection:this.previousSelected;return Az(Bv,function(Bw){if(Bw===Bt){return false;}if(Bu===undefined){Bu=Bw;}return Bu===Bw;});}function AG(){var Bt=this.levelAttributes.length-1,Bu;Bu=this.contextMenuSelection.length>0?this.contextMenuSelection:this.previousSelected;return Az(Bu,function(Bv){return Bv!==Bt;});}function A9(){var Bt=this.levelAttributes.length-1,Bu;Bu=this.contextMenuSelection.length>0?this.contextMenuSelection:this.previousSelected;return Az(Bu,function(Bv){return Bv===Bt;});}function Bb(By){var Bu={},Bx=[],Bw,Bz,Bv,Bt;for(Bv=0,Bt=By.length;Bv!==Bt;Bv+=1){Bw=By[Bv];Bz=Bw&&Bw.id;if(Bz!==undefined&&!Bu.hasOwnProperty(Bz)){Bu[Bz]=true;Bx.push(Bw);}}return Bx;}function AS(Bv,Bw){var Bu=(Bv.level===Bw.length-1),Bx=Bv,Bt=Bw[Bv.level].supportsViewFilter;if(Bu){while(Bt&&Bx.parentEntity){Bx=Bx.parentEntity;Bt=Bw[Bx.level].supportsViewFilter;}}return Bt;}function B(Bw,Bu){var Bv,Bt;for(Bv=0,Bt=Bw.length;Bv!==Bt;Bv++){if(!AS(Bw[Bv],Bu)){return false;}}return true;}function Aw(Bu,Bv,Bt){return Bv.map(function(Bx,Bw){return{eid:Bx,tid:Bu[Bw],tp:Bt[Bw]};});}function BE(Bt){Bt=Aa.clone(Bt);this.dfs(this.root,function(Bu){var Bx=Bu.colorByAttributeIds||[],By=Bu.colorByElementIds||[],Bw=Bu.colorByTypes||[],Bv=Aw(Bx,By,Bw);if(k.isEqualComb(Bv,Bt)){this.addToSelection(Bu);}}.bind(this));}function Bd(){return{type:"metricColorByOpacity",model:this.observableModel.colorByOpacity};}function AE(){var Bt=this.cmColorByElements,B1=this.getColorByElements(),By=this,Bz,Bx,Bv,Bu,Bw,B0;if(Bt===undefined||Bt.length===0){return ;}Bz=Bt.length;if(Bz>1){Bx=B1[0];}else{Bv=Aa.clone(Bt[0]);Bu=AQ.findInArray(B1,function(B2){return k.isEqualComb(Bv,Aa.clone(B2.comb));});if(Bu===-1){return ;}Bx=B1[Bu];}Bw={color:Bx.color,opacity:Bx.opacity,showAutomatic:Bt.some(function(B2){return AQ.isColorManuallySet(By,B2);})};B0={onFillChanged:function(B6,B4){var B5=B6,B2=B5==="automatic",B3;if(B2){B6="default";}else{B6=k.encodeColor(B6);}B3=By.listenToUpdateColorMap(function(){var B7="#ffffff",B8=Bt.length;if(B2){if(B8===1){B7=k.decodeColor(AQ.getCombColor(By,Bx.comb));}if(B4 instanceof Function){B4(B7);}B5=B7;}By.raiseEvent({name:"colorByColorChange",type:"invalidateCache"});By.raiseEvent({name:"colorByColorChange",type:"fill",fill:B5,showAutomatic:!B2});By.detachUpdateColorMapListener(B3);});By.updateColorMap(Bt,AQ.repeat(B6,Bt.length));},onOpacityChanged:function(B2){By.updateColorByOpacity(Bt,AQ.repeat(B2,Bt.length));By.raiseEvent({name:"colorByColorChange",type:"opacity",opacity:B2});}};this.refreshHighlights();return{type:"attributeColorBy",model:Bw,callback:B0};}function AF(){return{type:"headerFill",model:this.observableModel.headerColors,label:mstrmojo.desc(12105,"Header Fill")};}function BP(B4,CD){var B3=this.levelAttributes,CA=this,B0=function(CF){return CA.props.isHeaderOnTop&&CF.level!==B3.length-1;},Bt=B0(B4),B8,By;if(this.props.isHeaderOnTop){var CB=this.observableModel.fonts.headerOnTop;if(Bt){B8=CB.header;By="headerOnTop.header";}else{B8=CB.cell;By="headerOnTop.cell";}}else{B8=this.observableModel.fonts.headerOnMiddle;By="headerOnMiddle";}var B9=this.root;this.preorderTraverse(B9,function(CG){var CH=CG.labelDomNode;if(CH&&B0(CG)===Bt){CH._oldTextDecoration=CH.style.textDecoration;CH.style.textDecoration="underline";var CI=CH.parentNode.querySelector(".heatmap-label-square"),CF=getComputedStyle(CH).color;if(CI){CI.style.background=CF;CI.style.display="block";}}});var CE=[];if(this.props.isHeaderOnTop&&B4.entityChildren&&B4.headerColor){CE.push(AF.call(this));}if(!B4.entityChildren&&this.isAttributeColorByType()){CE.push(AE.call(this));}var Bv=this.props.labelSize===BA.Proportional;if(this.props.isHeaderOnTop&&Bt){Bv=false;}CE.push({type:"font",model:B8,disableFontSize:Bv,modelPath:By});var B2,B7=CD.e||CD,CC=AQ.getMetricsInDropZone(this.zonesModel,Bc.ColorBy)[0]||null,Bx=this.isMetricColorByType()&&CC;if(Bx&&!B0(B4)){var B6=mstrmojo.ui.PopupConfig.ENUM_CORNERS;B7={pageX:B7.pageX,pageY:B7.pageY-6};B2={host:B6.TOP_LEFT,popup:B6.BOTTOM_LEFT};CE.unshift(Bd.call(this));}this.closePopup();this.showContextMenu(CE,B7,B2);this._lastOpened.onClose=function(){CA.preorderTraverse(B9,function(CF){var CG=CF.labelDomNode;if(CG&&B0(CF)===Bt){CG.style.textDecoration=CG._oldTextDecoration;CG._oldTextDecoration=undefined;var CH=CG.parentNode.querySelector(".heatmap-label-square");if(CH){CH.style.display="none";}}});};if(Bx&&!B0(B4)&&!mstrApp.isDossier){var B5=this._lastOpened;this._lastOpened=null;var B1=new mstrmojo.ui.menus.MenuConfig();B1.addMenuItem(mstrmojo.desc(13174,"Select color ranges..."),"",function(){CA.model.openThresholdEditor(CC,true,false);});this.showMenu(B1,CD,true);var Bu=this._lastOpened,Bw=Bu._unlockHoverCheck;Bu._unlockHoverCheck=function(CG,CF){if(!Ax.contains(B5.domNode,Ax.eventTarget(CF,CG),true)){Bu._unlockHoverCheck=Bw;Bu._unlockHoverCheck(CG,CF);}};}this.raiseEvent({name:"formatclick",type:"format",formatValue:By});var Bz=AI([B4]);if(Bz&&Bz.length>0){this.contextMenuCbSelection=Bz;}AQ.selectPropertyPanel(this,"de");this.contextMenuCbSelection=null;}function A2(Bt){return function(Bw){var Bx=AN(Bw),Bu=this.getEntityByTouch(Bx);var Bv=Bu.id.split(";")[1];if(Bv===undefined){console.log("Unable to get attribute id from entity");}if(this.isOnFormattingMode){Bt.call(this,Bu,Bw);}else{p.call(this,Bw,Bt.bind(this,Bu),Bv);}};}function N(Bu){var Bt=this;Bt.showContextMenu({type:"background",model:Bt.observableModel.background,noOpacity:true,showNoFill:false},Bu);AQ.selectPropertyPanel(Bt,0);}var g={};g[f.BACKGROUND]=function(Bt){if(this.isOnFormattingMode){N.call(this,Bt);}else{Bk.call(this,Bt);}};var Bp=A2(BP);g[f.RECTANGLE_LABEL]=Bp;g[f.RECTANGLE]=Bp;function I(Bu){var B0=this.allSupportsViewFilter||B(this.contextMenuSelection,this.levelAttributes),Bw=new mstrmojo.ui.menus.MenuConfig(),Bt=new mstrmojo.ui.menus.MenuConfig(),Bx={filter:Bw,showData:Bt};if(!B0){return Bx;}var B1=AG.call(this),B2=A9.call(this),Bz,By=this;if(B1){Bz=this.getMenuHandler("headerDrill");}if(B2){Bz=this.getMenuHandler("rectangleDrill");}var B3=AQ.getDrillMenu.bind(AQ,this,Bu,Bz);if(this.isLinkedFilterEnabled()){var Bv=function(){By.handleContextMenuSelectionData(true);};Bw.addMenuItem(mstrmojo.desc(15070,"Go to Targets"),"",Bv);Bw.addSeparator();}Bw.addMenuItem(mstrmojo.desc(11701,"Keep only"),"xt",this.getMenuHandler("keepOnly"));Bw.addMenuItem(mstrmojo.desc(3946,"Exclude"),"xt",this.getMenuHandler("exclude"));if(!mstrApp.isDossier&&!this.excludeData){Bt.addMenuItem(mstrmojo.desc(13537,"Show Data..."),"xt",this.getMenuHandler("showData"));}if(!mstrApp.isInVFConfigMode&&mstrmojo.resolveFeature(n.WEB_DRILL_AND_LINK)){if(B3&&B3().hasMenuItems()){Bw.addPopupMenuItem(mstrmojo.desc(145,"Drill"),this.id,B3,"xt");}else{Bw.addNonInteractiveMenuItem(mstrmojo.desc(145,"Drill"),"",true);}}return Bx;}function Bo(){var Bt={};if(mstrApp.isAppStatePresentation()||mstrApp.isInVFConfigMode){return Bt;}var Bu=Ao.call(this),Bz=A9.call(this),Bv=this.contextMenuSelection.length!==0?this.contextMenuSelection:this.previousSelected,By=function(B0){return B0.label;},Bw=this,Bx;if(Bu){Bx=this.getCellForNode(Bv[0]);Bt=AQ.getGroupAndCalculationContextMenu(this,Bx,{skipSingleAttrCheck:true,selection:Bb(Bv),fnCellName:By});}if(Bz){Bt=AQ.getGroupAndCalculationContextMenuForDataPoints(this,{selection:Bv,fnCellName:By,fnUnique:function(B9){var B3=[],B8=Bw.root,B6=B9,B7=B6.length,B5,B4,B1,CA,B0,B2;while(B7>0){if(B7===1){B4=B6[0];while(B4!==B8){B3.push(B4);B4=B4.parentEntity;}B7=0;}else{CA=[];B0={};for(B5=0;B5!==B7;B5+=1){B4=B6[B5];B1=B4.parentEntity;B2=B4.id;if(!B0.hasOwnProperty(B2)){B0[B2]=true;B3.push(B4);}if(CA.indexOf(B1)===-1){CA.push(B1);}}B6=CA;B7=B6.length;}}return B3;},fnMakeNode:function(B0){return B0;}});}return Bt;}function AY(Bu,Bt){var Bv=Bu;if(!this.nf.validateFormat(Bv)){Bv="#,##0.00;(#,##0.00)";}return this.nf.formatByMask(Bv,Bt);}function A5(Bu,Bt){if(Bu.idx&&Bt.idx){var Bv=Bu.idx.split(":"),Bw=Bt.idx.split(":");if(Bv.length>Bw.length){return false;}return Bv[Bv.length-1]===Bw[Bv.length-1];}return false;}function H(Bt){this.updateEntityHighlight(Bt);}mstrmojo.heatmap.vi.VisHeatMap=mstrmojo.declare(mstrmojo.VisBase,[mstrmojo.util.ui._LassoSelector,mstrmojo.ui.menus._HasMenuPopup,mstrmojo._colorPalette,mstrmojo._VizSelectionHelper,mstrmojo.vi.ui.rw._HasVisSelections,mstrmojo.vi.ui.rw.selectors._IsMultiUnitControl,mstrmojo.vi.ui.rw.selectors._BrushesAndHighlights,mstrmojo.heatmap.vi._SupportHeatmapBrushesAndHighlights,mstrmojo.heatmap.vi._HasHeatmapContextMenu,mstrmojo.vi._MonitorsAppState,mstrmojo.vi.ui.rw._XtabDE,mstrmojo.vi.ui._IsDropTarget,mstrmojo.gm._SupportDndAsBlackBox],{scriptClass:"mstrmojo.heatmap.vi.VisHeatMap",selectedStyle:"background-image: -webkit-gradient(linear, left top, left bottom, color-stop(0, #058CF5), color-stop(1, #015DE6));color:#FFFFFF;",selectedClass:"",insertedStyles:[],LayoutProperties:{},normalizedIdCache:{},highlightBoxWidth:3,waitIconString:mstrmojo.desc("8445","Loading"),markupString:'<div id="{@id}" class="heatmap-{@themeType}-theme mil-{@themeType} gm-{@themeType}-theme" style="width:{@width}px;height:{@height}px; left:{@left}px; top:{@top}px; z-index: {@zIndex}; position:absolute;" mstrAttach:'+Br.join(",")+'><div class="heatmap-canvas-outer-container" style="padding: {@LayoutProperties.Padding}px; height:{@heatMapSize.h}px; width:{@heatMapSize.w}px; left: {@heatMapSize.x}px;"><div id ="{@id}-heatmap-canvas-container" class="heatmap-canvas-container" style="left: {@LayoutProperties.Padding}px; top: {@LayoutProperties.Padding}px; height:{@heatMapSize.h}px; width:{@heatMapSize.w}px"><div style="z-index: 1;"><div></div><div style="width: {@heatMapSize.w}px; height: {@heatMapSize.h}px;"></div></div></div></div><div></div><div style="width: {@legendSize.w}px; height: {@legendSize.h}px"></div></div>',markupSlots:{canvasSlot:function(){return this.domNode.childNodes[0].childNodes[0].childNodes[0].childNodes[0];},highlightCanvasPlaceholder:function(){return this.domNode.childNodes[0].childNodes[0].childNodes[0].childNodes[1];},canvasContainer:function(){return this.domNode.childNodes[0].childNodes[0];},canvasOuterContainer:function(){return this.domNode.childNodes[0];},containerNode:function(){return this.domNode;},scrollNode:function(){return this.domNode.childNodes[0].childNodes[0].childNodes[0];},textSpan:function(){return this.domNode.childNodes[1];},infoBoxPuppet:function(){return this.domNode.childNodes[1];},attributeColorByLegendPlaceHolder:function(){return this.domNode.childNodes[2];}},requirePreload:true,getFonts:function r(){var Bt=[];Y.call(this,Bt);Ap.call(this,Bt);return Bt;},onAppStateChange:function Ad(Bt){this._super(Bt);if(!this.selectorControl){this.removeAllSelections();this.clearSelections();}this.isOnFormattingMode=(Bt.value&mstrmojo.vi.VisualInsightApp.APP_STATES.FORMATTING);},getProperties:function(){var Bt=this.modelData;return(Bt&&Bt.vp)||{};},getPropsInfo:function(){return this.props||{};},init:function(Bv){this.props={};this.previousSelected=[];this.contextMenuSelection=[];this.isRectangleMenuOnClose=false;this._super(Bv);var Bu=document.createElement("canvas");var Bt=Bu.getContext;this.nf=mstrmojo.num;if(!Bt){this.browserSupportsHtml5=false;}else{this.browserSupportsHtml5=true;}this.HTML5PROPS={};if(!Ae){Ae=new mstrmojo.VisTooltip();Ae.render();}this.legendType=BU.VERTICAL;this.isOnFormattingMode=false;},update:function(Bw){var Bv=this._super(Bw),Bt,By,Bu,Bx="timerid_update";M.startTimer({functionName:"VisHeatMap.update",purpose:"JSON loading and consuming, generate the labels and colors"},Bx);if(Bv!==false){this.clearError();Bt=AQ.getPropertyByPath(this,"model.data.egt");By=AQ.getPropertyByPath(this,"model.data.eg");Bu=AQ.getPropertyByPath(this,"model.data.err");if(!this.excludeData){if(Bt!==undefined||By!==undefined){this.setError(By,Bt);}if(Bu!==undefined){this.setError(Bu);}}if(!this.browserSupportsHtml5){this.setError(mstrmojo.desc(8126,"Your browser does not support HTML5"));}this.modelData=this.model.data;if(!this.modelData){this.setError(mstrmojo.desc(8426,"No model provided"));}if(this.hasError()&&this.errorType!==Bs.EMPTY_DATA){M.endTimer(Bx);return Bv;}delete this.verticalLegendColorByElements;delete this.verticalLegendSizeByElements;delete this.colorByMetricThreshold;AZ.call(this);U.call(this);if(this.hasError()&&this.errorType!==Bs.EMPTY_DATA){M.endTimer(Bx);return Bv;}this.observableModel=this.addDisposable(AX.call(this));if(this.hasError()){M.endTimer(Bx);return Bv;}this.refreshLabelInTree();this.refreshColorInTree();}M.endTimer(Bx);return Bv;},preBuildRendering:function(){if(this.hasError()||this.waitingForData){return ;}if(!this._super()){return false;}var Bv=this.getPropsInfo(),Bt=Bv.showLegend,Bu="timerid_preBuildRendering";if(Bt&&this.legendType===BU.VERTICAL){this.defaultsLegendPop=K.call(this,(this.props.themeType==="light"?0:1));this.initHTML5Props(this.HTML5PROPS);}this.LayoutProperties=AV;M.startTimer({functionName:"VisHeatMap.preBuildRendering",purpose:"layout of the rectangles"},Bu);if(Bt){if(this.isAttributeColorByType()||Bv.hasColorInThresholds){this.getVerticalLegendColorByInfo();}if(Bv.sizeMetricEnabled){this.getVerticalLegendSizeByInfo();}}this.setLayout();BD.call(this);M.endTimer(Bu);},setModel:function i(Bt){this._super(Bt);this.listenToUpdateColorMap(this.refreshWidget);},setError:function(Bv,Bu){var Bt=AQ.translateGridError(Bv,Bu);this.error=Bt.msg;this.errorType=Bt.type;},clearError:function(){this.error=undefined;this.errorType=undefined;},hasError:function(){return this.error!==undefined||this.errorType!==undefined;},isEmpty:function(){return this.hasError();},getVisEmptyMsgControls:function(){return AQ.getVisEmptyMsgControls.call(this);},postBuildRendering:function Ak(){if(this.waitingForData){return ;}if(this.isEmpty()){if(AQ.isOnExpressMode()){AQ.renderWidgetErrorRSD(this,this.error,Br);}else{this._super();}return ;}var Bw="timerid_fromBuildtoEnd";M.startTimer({functionName:"VisHeatMap.postBuildRendering",purpose:"from Build to End"},Bw);this.initCanvas();this.renderLegend();this.hInitListeners();this.registerLassoSelector(this.canvasOuterContainer,[],false);this.lassoSelectorEnabled=false;this.preorderTraverse(this.root,function(By){var Bz=By.entityChildren;if(Bz&&Bz.length>1){this.lassoSelectorEnabled=true;return false;}});var Bv=this.getExp(),Bx=this.getRowsAndCols();AQ.modifyScExp(Bv,Bx,this.model,this.normalizedIdCache);var Bt=this._super();var Bu=this.previousSelected;if(Bu&&Bu.length>0){this.edtModelCbInitSelection=AI(Bu);}M.endTimer(Bw);return Bt;},hasSizebyOrColorby:function(){var Bt=this.getPropsInfo();return Bt.colorByType||Bt.sizeMetricID!==Bh;},hInitListeners:function(){var Bt=this.id;if(this.attributeColorByLegend){this.legendResizeListener=this.attributeColorByLegend.attachEventListener("gm-legend-resized",Bt,function(Bu){this.onLegendResized(Bu.position);});this.legendClickListener=this.attributeColorByLegend.attachEventListener("gm-legend-clicked",Bt,function(Bu){this.onLegendClicked(Bu);});}},onLegendResized:function(Bv){function Bt(){var Bw=this.attributeColorByLegend;if(Bw){this.hEvalSize4Legend();this.updateLegend();Bw.updateAfterResize();this.updateCanvasAfterAttributeLegendChanged(D[Bw.currDockedPositionIdx].pos,this.legendW);}}function Bu(Bx,Bw){if(Bw){this.legendScale=Bx;this.legendResized=true;this.legendFixedW=undefined;Bt.call(this);}}if(this.attributeColorByLegend){this.legendFixedW=this.legendW+Bv;this.legendScale=(this.legendFixedW)/(this.legendW/this.legendScale);this.legendResized=true;this.writeGlobalAttriLegndProperty(X.SCALE_LEGEND_WIDTH,this.legendScale,{success:Bu});Bt.call(this);}},onLegendClicked:function(Bt){var Bv=Bt.action,Bu=this.attributeColorByLegend,Bw={success:function(){this.hEvalSize4Legend();this.updateLegend();this.updateCanvasAfterAttributeLegendChanged(D[Bu.currDockedPositionIdx].pos,this.legendW);}};if(Bv==="close"){this.observableModel.showLegend.setValue(false);return ;}if(Bv==="minimize"){this.writeGlobalAttriLegndProperty(X.LEGEND_MODE,BQ.MINIMIZED,Bw);}else{if(Bv==="restore"){this.writeGlobalAttriLegndProperty(X.LEGEND_MODE,BQ.RESTORED,Bw);}}},unrender:function(){this.previousSelected=[];var Bv=Ax.detachEvent,Bt=Ax.TOUCHSTART,Bw=Ae&&Ae.domNode;Bv(this._tn,Bt,this._tsCallback);if(Bw&&Bw.parentNode){this.previousTooltip=undefined;Bw.parentNode.removeChild(Bw);}if(this.attributeColorByLegend){this.attributeColorByLegend.unrender();delete this.attributeColorByLegend;}if(this.legendResizeListener){this.legendResizeListener.clear();}if(this.legendClickListener){this.legendClickListener.clear();}var Bu=this._lastOpened;if(Bu){this.closePopup();}this.destroyCanvas();this._super();},refreshLabelInTree:function(){var Bt=function(Bv,Bu){if(Bv===this.root){return ;}Bv.text=this.getLabelForEntity(Bv);Bv.idx=Bu;};this.dfs(this.root,Bt,"");},getColorByAttrsByID:function(Bu,Bx,Bw){var Bt=AQ.isHierarchyObject(Bx)?"hid":"id",By=Bx.id,Bv="";Ai.forEach(Bu,function(Bz){if(Bz[Bt]===By){Bw.push(Bz.id);Bv+=(Bz.dn||Bz.n)+" ";}});return Bv;},getVerticalLegendColorByInfo:function(){if(this.isAttributeColorByType()){var CI=this.attributeColorByElementsTemp;if(CI===undefined){return ;}var CD,CC,B4,B8,Bx,B6,B7,Bz,B5,CG,CH,CE="",CJ=[],CB=this.props.colorAttributes,Bw=CB.length,B0=CI.length,CF=this.modelData.dz.ColorBy.TemplateUnit,B3,B9=(CF&&CF.length)||0,Bv=[],Bt=function(CL){var CK=CL.lastIndexOf(";");if(CK>-1){return CL.slice(CK+1);}return"";};for(CD=0;CD<B9;CD++){B3=CF[CD];CE+=this.getColorByAttrsByID(CB,B3,Bv);}CE=CE.substring(0,CE.length-1);for(CD=0;CD<B0;CD++){Bx={};B6="";B7=[];Bz=[];B5=[];CG=CI[CD];CH=[];Bx.color=CG.color.value;Bx.decodedColor=Bx.color;Bx.encodedColor=k.encodeColor(Bx.color);Bx.isDefaultColor=CG.isDefaultColor;Bx.opacity=CG.color.opacity;while(CG&&CG.parentEntity){if(this.props.colorAttributeIndexes.indexOf(CG.level)!==-1){B4=Bt(CG.id);CH.push({id:B4,text:CG.label});B7.splice(0,0,CG.id);}CG=CG.parentEntity;}for(CC=0;CC<CH.length;CC++){B8=Ai.find(CH,"id",Bv[CC]);B6=B6+CH[B8].text+" ";}CH=[];B6=B6.substring(0,B6.length-1);Bx.label=B6;for(CC=0;CC<Bw;CC++){Bz.push(CB[CC].id);B5.push(CB[CC].otp);}Bx.token={elements:B7,levels:Bz,types:B5};CJ.push(Bx);}delete this.attributeColorByElementsTemp;this.verticalLegendColorByElements={item:CE,elements:CJ};}else{if(this.props.hasColorInThresholds){var B2=this.getColorByMetricThreshold(),B1,By,CA,Bu=this.getPropsInfo().metricColorByOpacity;if(B2){CA=[];B1=AQ.getColorByTitle(this.getMetricName(this.colorMetricIndex),B2.rankMode);Ai.forEach(B2.items,function(CK){By=Aa.clone(CK);By.opacity=Bu;CA.push(By);});this.verticalLegendColorByElements={item:B1,elements:CA};}else{this.verticalLegendColorByElements=undefined;}}}},getVerticalLegendSizeByInfo:function(){var Bz=Bn.call(this);if(Bz.max===Infinity&&Bz.min===-Infinity){this.verticalLegendSizeByElements=undefined;return ;}var B0=this.getFormatString(this.sizeMetricIndex);var By=[],Bx,Bu=Bz.min,Bv=Bz.max,B2=(Bv-Bu)/4;for(Bx=0;Bx<5;Bx++){By.push(AY.call(this,B0,Bv-Bx*B2));}var B1={},Bt;var Bw=this.getMetricName(this.sizeMetricIndex);if(Bz.hasNegativeValue){Bw=Q+" "+Bw;}B1.item=Bw;if(By.length>1){Bt=B1.elements=[];Ai.forEach(By,function(B3){Bt.push({sign:"<",v:B3});});if(Bt.length===5){Bt[0].sign="=";Bt[4].sign="=";}B1.caseFlag=0;}if(By.length===1){B1.elements=[{diameter:12,shape:"rect",sign:"=",v:By[0]}];B1.caseFlag=2;}this.verticalLegendSizeByElements=B1;},getHeaderColor:function(Bu){var Bt=Aa.clone(this.props.headerColors[Math.min(Bu.level,2)]);if(Bu.level!==0&&!this.props.isDefaultHeaderColor){Bt.opacity*=0.7;}return Bt;},refreshColorInTree:function(){var Bw=[],Bv=[];var By=function(B9){if(B9===this.root){return ;}var B6=this.props.colorAttributeIndexes,B0=B6[B6.length-1];if(B9.level===B0){var B2,B1,B7,B8=B6.length,B3=this.modelData.gts.row,CA=[],B5=[],CB=[],CC=[],B4="";B1=B9;for(B2=0;B2<=B0;B2++){CA.splice(0,0,B1);B1=B1.parentEntity;}for(B2=0;B2<B8;B2++){B7=B6[B2];B5.push(B3[B7].id);CC.push(B3[B7].otp);B4+=CA[B7].id+":";CB.push(CA[B7].id);}if(Bw.indexOf(B4)===-1){this.attributeColorByElementsTemp.push(B9);Bw.push(B4);}this.preorderTraverse(B9,function(CD){CD.colorByAttributeIds=B5;CD.colorByElementIds=CB;CD.colorByTypes=CC;});}};if(this.isAttributeColorByType()){this.attributeColorByElementsTemp=[];this.preorderTraverse(this.root,By);}else{var Bt=this.modelData;if(this.props.colorMetricID!==Bh&&Bt.gsi.thresholds[this.props.colorMetricID]!==undefined){var Bz=Bt.gsi.thresholds[this.props.colorMetricID],Bx;for(Bx=0;Bx<Bz.length;Bx++){if(Bz[Bx].fmt&&Bz[Bx].fmt.bc){Bv[Bx]=Bz[Bx].fmt.bc;}else{Bv[Bx]=AK.getCSSColorString(F);}}}}var Bu=function(B4){if(B4===this.root){return ;}var B0,B2=this.colorTheme,B1=1,B3,B5,B6;if(this.isAttributeColorByType()&&B4.colorByAttributeIds&&B4.colorByElementIds){B5=B4.colorByAttributeIds;B6=B4.colorByElementIds;B3=this.model.docModel.getColorBy(B5,B6);B0=k.decodeColor(B3.color);B1=AU.call(this,B5,B6)/100;B4.isDefaultColor=!B3.isManual;}else{if(this.props.colorMetricID!==Bh&&Bv.length>0&&B4.thrColorIndex>=0){B0=AK.getCSSColorString(Bv[B4.thrColorIndex]);B1=this.getPropsInfo().metricColorByOpacity;}else{B0=AK.getCSSColorString(F);}}B4.color={value:B0,opacity:B1};if(this.props.isHeaderOnTop){B4.headerColor=this.getHeaderColor(B4,B2.style==="light");}};this.dfs(this.root,Bu,"");},dfs:function(Bv,By,Bw){if(!Bv||Bv.deleted){return ;}if(Bw===undefined){By.call(this,Bv);}else{By.call(this,Bv,Bw);}if(Bv.entityChildren===undefined){return ;}var Bt=Bv.entityChildren,Bu=Bt.length,Bx;for(Bx=0;Bx<Bu;Bx++){var Bz=Bt[Bx];if(Bw===undefined){this.dfs(Bz,By);}else{var B0=Bw;if(!B0){B0=Bx.toString();}else{B0=B0+":"+Bx;}this.dfs(Bz,By,B0);}}},preorderTraverse:function(Bu,By){if(Bu){var Bv=By.call(this,Bu);if(Bv===false){return ;}var Bx=Bu.entityChildren||[],Bt=Bx.length,Bw;for(Bw=0;Bw<Bt;Bw++){this.preorderTraverse(Bx[Bw],By);}}},getSingleBackgroundColor:function(){return this.background&&this.background.value&&(this.background.value.c1||this.background.value);},initCanvas:function(){var Bu=this,Bt=An.call(this);this.destroyCanvas();this.addChildren(new mstrmojo.heatmap.vi.VisHeatMapCanvas(Bt));this.highlightCanvas=this.canvasObject.addDisposable(new mstrmojo.heatmap.vi.VisHeatMapHighlightCanvas({placeholder:this.highlightCanvasPlaceholder,isOnSelectionMode:function(){return Bu.previousSelected.length>0||Bu.contextMenuSelection.length>0;},themeType:this.props.themeType,backgroundColor:this.getSingleBackgroundColor()}));this.highlightCanvas.render();this.highlightCanvas.parent=this;},destroyCanvas:function t(){var Bt=this.canvasObject;if(Bt){this.highlightCanvas=null;this.removeChildren(Bt);Bt.destroy();}},scaleFactor:1,renderRectangles:function(){this.canvasObject.clearFontCache();this.refreshLabelInTree();this.refreshColorInTree();this.canvasObject.isHeaderOnTop=this.props.isHeaderOnTop;this.canvasObject.render();},renderLegend:function j(){if(!this.props.showLegend){if(this.attributeColorByLegendPlaceHolder){this.attributeColorByLegendPlaceHolder.style.display="none";}return ;}if(!this.attributeColorByLegend){var Bv=this;var Bu=this.canvasObject.addDisposable(new BB.GMLegend({widget:this,model:this.model,placeholder:this.attributeColorByLegendPlaceHolder,currDockedPositionIdx:l(this.readGlobalAttriLegndProperty(X.LEGEND_POSITION)),cutBy:this.legendCutBy,cssClass:"gm-legend",styles:this.HTML5PROPS.LEGEND,readGlobalProperty:function(Bw){return Bv.readGlobalAttriLegndProperty(Bw);},writeGlobalProperty:function(Bw,Bx){if(Bw===Aq.LEGEND_BG_COLOR){Bv.observableModel.legendBackground.value.setValue(k.decodeColor(Bx));}else{if(Bw===Aq.LEGEND_BG_FILL_TRANSPARENCY){Bv.observableModel.legendBackground.opacity.setValue(Bx/100);}else{if(Bv.observableModel[Bw]){Bv.observableModel[Bw].setValue(Bx);}else{Bv.writeGlobalAttriLegndProperty(Bw,Bx,{success:function(){Bv.reRender();}});}}}},configureLegendPopup:function(Bw,Bx){return Bv.configureAttriLegendPopup(Bw,Bx);}}));Bu.render();Bu.parent=this;this.attributeColorByLegend=Bu;this.attributeColorByLegendPlaceHolder=Bu.domNode;}else{var Bt=this.attributeColorByLegend;Bt.currDockedPositionIdx=l(this.readGlobalAttriLegndProperty(X.LEGEND_POSITION));this.initHTML5Props(this.HTML5PROPS);Bt.updateStyle(this.HTML5PROPS.LEGEND);Bt.updateTitleLineHeight();this.hEvalSize4Legend();this.updateLegend();Bt.updateSplitter();this.updateCanvasAfterAttributeLegendChanged(D[Bt.currDockedPositionIdx].pos,this.legendW);}this.attributeColorByLegend.cutBy=this.legendCutBy;this.attributeColorByLegend.minHeight=this.legendMinHeight;this.attributeColorByLegend.updateContainerSize(this.getWidth(),this.getHeight());this.attributeColorByLegend.feedData([{dataType:Bi.COLOR_BY,dataObj:this.verticalLegendColorByElements},{dataType:Bi.SIZE_BY,dataObj:this.verticalLegendSizeByElements}],(this.readGlobalAttriLegndProperty(X.LEGEND_MODE)===BQ.MINIMIZED));},getColorByMetricThreshold:function(){if(!this.props.hasColorInThresholds){return undefined;}var By;if(this.colorByMetricThreshold){By=this.colorByMetricThreshold;}else{var Bv=this.modelData,Bz=Bv.gsi.mx,Bt=this.props.colorMetricID,B0={max:"",min:""},Bx,Bu;Ai.forEach(Bz,function(B2){if(B2.did===Bt){B0=B2;return false;}});if(B0.max===""&&B0.min===""){this.colorByMetricThreshold=undefined;return ;}if(Bv.gsi.thresholds[Bt]&&B0){var B1,Bw;B1=Bv.gsi.thresholds[Bt];Bx=AQ.getRankMode(B1);Bw=AQ.getColorByFormatStr(this.getFormatString(this.colorMetricIndex),Bx);Bu=AQ.getColorByItems(B1,Bx,B0.max,B0.min,B0.cnt,Bw,AK.getCSSColorString(F));Bu.sort(function(B3,B2){var B4;if(B3.ceil>B2.ceil){B4=1;}else{if(B3.ceil===B2.ceil){B4=0;}else{B4=-1;}}return B4;});}else{if(B0){Bu=AQ.getDefaultColorByItems(AK.getCSSColorString(F),B0.max,B0.min);}else{Bu=AQ.getDefaultColorByItems(AK.getCSSColorString(F),1,0);}Bx=x.VALUE;}By={rankMode:Bx,items:Bu};this.colorByMetricThreshold=By;}return By;},render:function(Bt){if(this.hasRendered&&this.unrender){this.unrender();}this._super(Bt);},reRender:function W(){if(this.hasError()){return ;}this._super();},loadDeleteStatus:function(Bx,Bt){if(!Bx.entityChildren){if(Bt===AT.dftDel||Bt===AT.usrDel){Bx.deleted=true;}else{delete Bx.deleted;}return ;}if((!Bt||Object.keys(Bt).length===0)&&!Bx.hasChildDeleted){return ;}var Bw=Bx.entityChildren,Bv;for(Bv=0;Bv<Bw.length;Bv++){var Bz=Bw[Bv];var Bu=this.getEntityDisplayName(Bz);var By=Bt&&Bt[Bu];this.loadDeleteStatus(Bz,By);}},getFormatString:function Bg(Bw){var Bv=this.modelData,Bx=Bv.nf||[],Bu=Bx.length,Bt;if(Bw>=0&&Bw<Bu){Bt=AQ.getNumberFormat(Bv,Bw);return Bt.replace(/\'/g,'"');}return"";},checkMetricValid:function Bm(Bu){var Bt=this.modelData,Bv=Bt.ghs.chs.items,Bw=Bv[0]?Bv[0].items.length:0;return !(Bu<0||Bu>=Bw);},getMetricName:function BV(B0){var Bz="",Bw=this.modelData,Bv=Bw.ghs.chs.items,Bu=Bv.length,B1=Bw.gts.col,Bx;if(!this.checkMetricValid(B0)){return Bh;}for(Bx=0;Bx<Bu;Bx++){var By=Bv[Bx].items[B0].idx;var Bt=B1[Bx].es[By].n;Bz+=Bt+" ";}return Bz.slice(0,Bz.length-1);},getEntityDisplayName:function BY(B0){var Bu=B0.level,Bx=(B0.index===undefined)?B0.indices[0]:B0.index,B1="",Bz=this.modelData.ghs.rhs.items,By=Bz[Bx].items,Bt=(By&&By.length)||0,B2=this.modelData.gts.row[Bu],Bw,Bv,B4=[];for(Bw=0;Bw<Bt;Bw++){if(!By[Bw]||By[Bw].tui!==Bu){continue;}var B3=By[Bw].idx;if(B3===-1){continue;}Bv=B2.es[B3];if(B4.indexOf(Bv)===-1){B1+=Bv.n+" ";B4.push(Bv);}}B1=B1.substring(0,B1.length-1);return B1;},previousTooltip:null,previousSelected:[],isRectangleMenuOnClose:false,drawHighlight:function(Bt){if(!Bt){return null;}var By=false,Bv=false,Bu=this.props.isHeaderOnTop,Bw=Bt.headerSize||Bt.size,Bx=!!Bt.entityChildren,Bz=this.highlightCanvas;if(Bt===this.previousTooltip){By=true;}else{if(this.previousTooltip&&this.previousTooltip.entityChildren){By=A5(this.previousTooltip,Bt);}}if(this.previousSelected.indexOf(Bt)!==-1||this.contextMenuSelection.indexOf(Bt)!==-1){Bv=true;}else{Ai.forEach(this.previousSelected,function(B0){if(B0.entityChildren){if(A5(B0,Bt)){Bv=true;}}});Ai.forEach(this.contextMenuSelection,function(B0){if(B0.entityChildren){if(A5(B0,Bt)){Bv=true;}}});}if(!Bw){return null;}Bz.highlight(Bw,Bt,{isHovered:By,isSelected:Bv,isEntityContainer:Bx,contextMenuSelected:this.IsInContextMenuSelectionIndex(Bt),isPreviousSelected:this.previousSelected.indexOf(Bt)!==-1,isHeaderOnTop:Bu});return Bw;},updateEntityHighlight:function(Bt){if(!Bt){return ;}this.drawHighlight(Bt);},applyToEntityRecursively:function(Bu,Bv){if(!Bu){return ;}if(Bu.entityChildren){var Bx=this.getAllSiblingEntities(Bu),Bw=this,Bt=Bx;while(Bt.length>0){var By=Bt.shift();Bv(By);if(By.entityChildren){Ai.forEach(By.entityChildren,function(Bz){Bt.push(Bz);});}}}else{Bv(Bu);}},refreshHighlights:function(Bt){if(!this.highlightCanvas){return ;}Bt=Bt||this.previousSelected||[];ContextMenuEntitySet=this.contextMenuSelection||[];if(!this.props.isHeaderOnTop){Bt.sort(function(Bv,Bu){var Bx=Bv.level,Bw=Bu.level;return Bx<Bw?-1:(Bx>Bw?1:0);});ContextMenuEntitySet.sort(function(Bv,Bu){var Bx=Bv.level,Bw=Bu.level;return Bx<Bw?-1:(Bx>Bw?1:0);});}this.highlightCanvas.clear();Ai.forEach(ContextMenuEntitySet,function(Bu){this.applyToEntityRecursively(Bu,H.bind(this));},this);Ai.forEach(Bt,function(Bu){this.applyToEntityRecursively(Bu,H.bind(this));},this);},getLowestLevelRectangle:function(Bv){var Bu=document.elementFromPoint(Bv.pageX,Bv.pageY);var Bt=[];while(!this.isLowestLevelRectangle(Bu)){Bu.style.display="none";Bt.push(Bu);Bu=document.elementFromPoint(Bv.pageX,Bv.pageY);}while(Bt.length){Bt.pop().style.display="block";}return Bu;},areaSelect:function(Bv,Bw){var Bt=this.previousSelected.slice();if(!Bw.ctrlKey){this.removeAllSelections();}this.preorderTraverse(this.root,function(By){if(By===this.root||!By.size){return ;}if(!By.entityChildren&&!isNaN(BJ(By.size,Bv).x)){this.addToSelection(By);return false;}});this.doSelection();this.refreshHighlights();if(!J(Bt,this.previousSelected)){BC.call(this,this.previousSelected);}var Bx,Bu=this.previousSelected;if(Bu&&Bu.length>0){Bx=Ax.position(this.canvasObject.domNode,true);this._toolbarContext={type:f.RECTANGLE,pos:{e:{pageX:Bv.x+Bx.x,pageY:Bv.y+Bx.y},getTarget:function(){return undefined;}},entity:Bu[0]};}},getEntityByTouch:function(Bz,B5){var B2=this.getElementBehindCurtains(Bz.evt);if(!B2){return null;}var Bx=Bz.pageX,Bv=Bz.pageY;if(B5){var Bt=B2,B4=[];while(B2!==this.domNode&&B2.tagName.toLowerCase()!=="img"){B4.push(B2);B2.style.visibility="hidden";B2=document.elementFromPoint(Bx,Bv);if(!B2||B2===Bt){break;}Bt=B2;}while(B4.length>0){var Bu=B4.pop();Bu.style.visibility="visible";}}if(!B2){return null;}var Bw;if(B2!==this.domNode){if(B2.getAttribute("idx")&&!B5){Bw=this.getIdxObjectByTarget(B2);}else{var B3=Ax.position(this.canvasObject.domNode,true),B1=Bx-B3.x,By=Bv-B3.y;var B0={x:B1,y:By};Bw=this.canvasObject.getEntity(B0);}}return Bw;},getAllSiblingEntities:function(Bt){return this.canvasObject.getAllSiblingEntities(Bt);},getMetricDisplayValues:function(Bv,Bw){var Bu=BR(Bv,Bw),Bt=Bu.map(function(Bx){return A3(Bw,Bv,Bx).v;});return Bt;},getLabelForEntity:function(Bx){var Bv=this.getEntityDisplayName(Bx);if(Bx.entityChildren!==undefined){return'<span style="#addedStyleTemplate">'+Am.encodeHtmlString(Bv)+"</span>";}if(!this.props.showMetricValues){return'<span style="#addedStyleTemplate">'+Am.encodeHtmlString(Bv,true)+"</span>";}var Bw=this,Bt=this.getMetricDisplayValues(Bw,Bx);Bt.unshift(Bv);Bt=Bt.map(function(By){return Am.encodeHtmlString(By,true);});var Bu='<span style="#addedStyleTemplate">'+Bt.join("<br>")+"</span>";return Bu;},lassoSelecting:function(){BG.removeClass(this.lassoSelector,"lasso-selector-hasContent");},lassoSelected:function(Bu){if(Ax.supportsTouches===true){return ;}var Bt=this.parent;this.areaSelect({x:Bu.left,y:Bu.top,w:Bu.width,h:Bu.height},Bu);if(this.previousSelected.length){BG.addClass(this.lassoSelector,"lasso-selector-hasContent");}this.displayVizBoxVisFilterIndicator(true,Bt);},lassoSelectorResized:function(Bt){this.lassoSelecting();this.lassoSelected(Bt);},configurePopup:function(Bt,Bu){Bt.hostId=this.id;Bt.hostElement=Bu;},showMenu:function(Bz,Bt,By){var Bw=this.menuAnchor,Bx=this,Bv,Bu;if(!Bw){Bw=document.createElement("div");Bw.id=this.id+"-hm-menu-anchor";Bw.style.position="absolute";document.body.appendChild(Bw);this.menuAnchor=Bw;}Bu=Bw.style;Bu.left=Bt.pageX+"px";Bu.top=Bt.pageY+"px";Bu.zIndex=101;this.configurePopup(Bz,Bw);Bv=Bz.newInstance();if(Bv&&By){Bv.onCloseMenuCallBack=function(){Bx.clearContextMenuSelectionHighLight();Bx.isRectangleMenuOnClose=true;};}this.openPopup(Bv);},getSelectionMenuConfig:function(Bv){var Bt=AQ.mergeHashes(I.call(this,Bv),Bo.call(this)),Bu=[{name:"filter"},{name:"editGroup"},{name:"editCalculation"},{name:"createDe"},{name:"showData"},{name:"renameDe"}];return AQ.mergeMenuConfigs(Bt,Bu);},getBlankSpaceMenuConfig:function(By){var Bu=new mstrmojo.ui.menus.MenuConfig(),Bw=this,Bv=Bw.props;Bu.addMenuItem(mstrmojo.desc(1918,"Format"),"xt",function(){N.call(Bw,By);});if(this.hasSizebyOrColorby()){if(!Bv.showLegend){var Bx=mstrmojo.desc(12001,"Show Legend"),Bt="showLegend";Bu.addMenuItem(Bx,"xt",this.getMenuHandler(Bt));}}return Bu;},keepOnly:function(){this.updateAfterKeepOnly(true);},exclude:function(){this.updateAfterKeepOnly(false);},getMenuHandler:function(Bu){var B3=this._super(Bu);if(B3!==mstrmojo.emptyFn){return B3;}var Bz=this,Bw={keepOnly:function By(){Bz.keepOnly();Bz.clearContextMenuSelection();Bz.noHighlightAfterKeepOnlyExcludeDrill=true;},exclude:function B1(){Bz.exclude();Bz.clearContextMenuSelection();Bz.noHighlightAfterKeepOnlyExcludeDrill=true;},showData:function Bv(){Bz.showData();},rectangleDrill:function Bx(B4){AQ.doDrill(Bz,B4.ctxt.drillUnit,AH,{headerDrill:false});Bz.clearContextMenuSelection();Bz.noHighlightAfterKeepOnlyExcludeDrill=true;},headerDrill:function B2(B4){AQ.doDrill(Bz,B4.ctxt.drillUnit,AH,{headerDrill:true});Bz.clearContextMenuSelection();Bz.noHighlightAfterKeepOnlyExcludeDrill=true;},showLegend:function B0(){Bz.observableModel.showLegend.setValue(true);},hideLegend:function Bt(){Bz.observableModel.showLegend.setValue(false);}};if(Bw.hasOwnProperty(Bu)){return Bw[Bu];}return mstrmojo.emptyFn;},isClearAllEnabled:function(Bx){var Bu=this.modelData||{},Bw=AQ.getPropertyByPath(Bu,"gts.row",[]),Bt,By,Bz=Bu.sc,Bv;if(Bx){Bv=Bx.id||"";Bt=AQ.findInArray(Bw,function(B0){return Bv.indexOf(B0.id)!==-1;});if(Bt!==-1){By=Bw[Bt];Bz=By.sc||Bz;}}return !!(Bz===undefined||Bz.showall);},addToSelection:function(Bt){var Bu=this.previousSelected||[];if(Bu.indexOf(Bt)===-1){Bu.push(Bt);}},removeFromSelection:function(Bt){var Bv=this.previousSelected||[],Bu=Bv.indexOf(Bt);if(Bu!==-1){Bv.splice(Bu,1);return true;}return false;},removeAllSelections:function(Bu){var Bt=(this.previousSelected||[]).slice();this.previousSelected=[];if(!Bu&&Bt.length>0){this.raiseEvent({name:"selectionBatchRemove",entities:Bt});}return Bt;},clearContextMenuSelection:function(){if(this.contextMenuSelection.length!==0){this.contextMenuSelection=[];this.refreshHighlights();}},addEntityToContextMenuSelection:function(Bt){var Bu=this.contextMenuSelection;if(Bu.indexOf(Bt)===-1){Bu.push(Bt);this.applyToEntityRecursively(Bt,H.bind(this));}},cloneSelectionToContextMenuSelection:function(){this.contextMenuSelection=this.previousSelected.slice(0);},IsInContextMenuSelectionIndex:function(Bt){return this.contextMenuSelection.indexOf(Bt)!==-1;},contextMenuSelectionHandler:function(Bw){var Bv=Bw.getTarget();this.clearContextMenuSelection();if(this.isRectangle(Bv)){var Bt=this.getEntityByTouch(AN(Bw)),Bu=this.previousSelected.indexOf(Bt)!==-1,Bx=Bw.ctrlKey||Bw.metaKey;if(Bx===false){if(Bu){this.cloneSelectionToContextMenuSelection();this.refreshHighlights();}else{this.addEntityToContextMenuSelection(Bt);}}if(this.previousSelected.length===0){this.highlightCanvas.clear();}this.doSelection(true);}},clearContextMenuSelectionHighLight:function(){this.clearContextMenuSelection();this.refreshHighlights();},isTargetHasInfoWindow:function(Bx){var Bv=this.modelData,B1=Bv&&Bv.sc,B0=this.model,B2=B0&&B0.docModel,B3,Bz,By=AQ.getPropertyByPath(Bv,"gts.row",[]),Bu,Bt;if(Bx){Bt=Bx.id||"";Bz=AQ.findInArray(By,function(B4){return Bt.indexOf(B4.id)!==-1;});if(Bz!==-1){Bu=By[Bz];B1=Bu.sc||B1;}}B3=B1&&B1.tks;if(!B3){return false;}var Bw=B2.getTargetInfoWin(B3);return(Bw&&Bw.length>0);},onclick:function(B9,Bx){delete this.noHighlightAfterKeepOnlyExcludeDrill;if(!Bx){this.dismissLassoSelector();}var CB=B9.getTarget(),Bu=false,B2=false,By=false,B6=false,B0,B8,B4,CA,Bw,Bt,B5,CC=A9.call(this),Bv=AG.call(this),B1;this.clearContextMenuSelection();Bt=B9.e.ctrlKey||B9.e.metaKey;isRectangleMenuOnClose=this.isRectangleMenuOnClose;if(this.isRectangle(CB)){B0=this.getEntityByTouch(AN(B9));if(B0){B1=B0.level===this.levelAttributes.length-1;B4=this.previousSelected;B8=B4.length;CA=B8===0;Bw=B4.indexOf(B0)!==-1;B5=B8>1;if(Bw&&!B5){if(!Bx&&(this.isClearAllEnabled(B0)||this.isTargetHasInfoWindow(B0))){B2=true;this.removeAllSelections();}}if((Bw&&!Bt&&B5&&!Bx)||(!Bw&&!Bt)||(CC^B1&&!Bw&&Bt)||(!(CC||Bv)&&Bw)){B2=true;By=true;this.removeAllSelections();this.addToSelection(B0);}if(!Bw&&Bt){By=true;this.addToSelection(B0);}if(Bw&&Bt&&B5){if(!Bx){B6=true;this.removeFromSelection(B0);}}B2=B2||CA===(this.previousSelected.length>0);if(B2){this.highlightCanvas.clear();}if(By||B6){this.applyToEntityRecursively(B0,H.bind(this));}if(B2||By||B6){this.doSelection();Bu=true;}this.displayVizBoxVisFilterIndicator(By,this.parent);if(!Bw){this.dismissLassoSelector();}}}var Bz=this.getComponentType(B9),B3;if(!Bx&&!Bt&&isRectangleMenuOnClose===false){if(Bz.type===f.BACKGROUND||Bz.type===f.LEGEND_BACKGROUND){var B7=function(CD){return this.isClearAllEnabled(CD)||this.isTargetHasInfoWindow(CD);};B3=(this.previousSelected||[]).filter(B7,this);if(B3.length>0){B3.forEach(function(CD){this.removeFromSelection(CD);},this);this.doSelection();Bu=true;this.refreshHighlights(B3);this.refreshHighlights();}}}if(this.attributeColorByLegend){this.attributeColorByLegend.hideToolbar();}if(Bu){BC.call(this,this.previousSelected);}this._toolbarContext={type:Bz.type,pos:B9};this.isRectangleMenuOnClose=false;},getElementBehindCurtains:function(Bv){var Bt=[this.highlightCanvas.domNode,this.lassoSelector];Ai.forEach(Bt,function(Bw){Bw._visibility=Bw.style.visibility;Bw.style.visibility="hidden";});var Bu=document.elementFromPoint(Bv.e.pageX,Bv.e.pageY);Ai.forEach(Bt,function(Bw){Bw.style.visibility=Bw._visibility;Bw._visibility=undefined;});return Bu;},getComponentType:function(Bx){var Bu;var Bw=this.getElementBehindCurtains(Bx),Bv=this.attributeColorByLegend;if(this.isRectangle(Bw)){if(Bw.getAttribute("idx")||(Bw.tagName==="SPAN"&&Bw.parentNode.getAttribute("idx"))){Bu=f.RECTANGLE_LABEL;}else{var Bt=this.getEntityByTouch(AN(Bx));if(Bt){Bu=f.RECTANGLE;}else{Bu=f.BACKGROUND;}}}else{if(Bv&&Bv.domLegend===Bw){Bu=f.LEGEND_BACKGROUND;}else{if(Bw===this.domNode||Bw.desc==="clearAllBtn"){Bu=f.BACKGROUND;}}}return{type:Bu,target:Bw};},isRectangle:function(Bt){return Ax.contains(this.canvasObject.domNode,Bt,true)||Ax.contains(this.highlightCanvas.domNode,Bt,true)||Ax.contains(this.lassoSelector,Bt,true);},isLowestLevelRectangle:function(Bt){return Bt.getAttribute&&Bt.getAttribute("idx")&&!(Bt.innerHTML);},toggleSelectAll:function(Bt){var Bu=this.modelData.gts.row[Bt.level].sc;if((Bu&&Bu.all!=="false"&&Bu.all!==false)||!this.hasGridTarget){this.selectAll=!this.selectAll;return true;}return false;},doSelection:function(Bt){this.prepareSelectedNodesInfo(Bt);if(!Bt){this.endSelections();}},getObjectByIdx:function(Bt){if(Bt){var Bu=Bt.split(":");var Bw=this.root,Bv;for(Bv=0;Bv<Bu.length;Bv++){Bw=Bw.entityChildren[Bu[Bv]];}return Bw;}return null;},setColorByType:function(Bt){if(Bt==="attribute"){this.props.colorByType="attribute";this.colorTheme.colorByType="attribute";}else{this.props.colorByType="metric";delete this.colorTheme.colorByType;}},clearChildren:function(Bt){if(!Bt){return ;}while(Bt.firstChild){Bt.removeChild(Bt.firstChild);}},setLayout:function AL(Bt){var Bw=parseInt(this.width,10),Bu=parseInt(this.height,10),Bx=this.LayoutProperties.Padding,By=Bw-2*Bx,B0=Bu-2*Bx,Bv=0;if(!this.legendSize){this.legendSize={};}var Bz=this.legendSize;if(this.props.showLegend){if(this.legendType===BU.VERTICAL){if(!Bt){if(this.attributeColorByLegend){Bt=D[this.attributeColorByLegend.currDockedPositionIdx].pos;}else{Bt=this.readGlobalAttriLegndProperty(X.LEGEND_POSITION);}}this.hEvalSize4Legend();Bz.w=this.legendW;Bz.h=this.legendH;By-=Bz.w;if(!this.isOnRight(Bt)){Bv=Bz.w;}}}this.heatMapSize={x:Bv,y:0,w:By,h:B0};this.maxScale=10;},hEvalSize4Legend:function(){var Bx,Bv=this.verticalLegendColorByElements,Bu=this.verticalLegendSizeByElements,Bw=this.getWidth(),Bt=this.getHeight(),By=this.HTML5PROPS.LEGEND,Bz;if(this.props.showLegend===false){this.legendW=this.legendH=this.legendP=0;}else{Z.applyHTML5Props(By);this.legendP=At;if(!this.legendScale){Bz=this.readGlobalAttriLegndProperty(X.SCALE_LEGEND_WIDTH);if(Bz){this.legendScale=Bz;this.legendResized=true;}}Bx=Z.getLegendSize([{dataType:Bi.COLOR_BY,dataObj:Bv},{dataType:Bi.SIZE_BY,dataObj:Bu}],this.legendResized?this.legendScale:undefined,Bw,Bt,By,this.legendFixedW);this.legendCutBy=Bx.cutBy;this.legendMinHeight=Bx.minHeight;this.legendFixedW=Bx.width;if(Bx.scale){this.legendScale=Bx.scale;}if(this.readGlobalAttriLegndProperty(X.LEGEND_MODE)===BQ.MINIMIZED||Bx.autoCollapse){Bx=Z.getLegendSize4MinMode(Bv,Bt);this.legendCutBy=undefined;}this.legendW=Bx.width;this.legendH=Bx.height;}},applyLayout:function(){if(this.heatMapSize){if(this.canvasOuterContainer){var Bt=this.canvasOuterContainer.style;Bt.left=this.heatMapSize.x+"px";Bt.top=this.heatMapSize.y+"px";Bt.width=this.heatMapSize.w+"px";Bt.height=this.heatMapSize.h+"px";}if(this.canvasContainer){var Bv=this.canvasContainer.style;Bv.width=this.heatMapSize.w+"px";Bv.height=this.heatMapSize.h+"px";}if(this.canvasObject){var Bu=this.canvasObject;Bu.width=this.heatMapSize.w;Bu.height=this.heatMapSize.h;}}},refreshWidget:function(){var Bu=An.call(this),Bt=this.attributeColorByLegend;Aa.copy(Bu,this.canvasObject);if(this.excludeData){return ;}this.setLayout();this.applyLayout();BD.call(this);this.renderRectangles();this.refreshHighlights();if(Bt){if(this.isAttributeColorByType()||this.props.hasColorInThresholds){this.getVerticalLegendColorByInfo();}if(this.props.sizeMetricEnabled){this.getVerticalLegendSizeByInfo();}Bt.feedData([{dataType:Bi.COLOR_BY,dataObj:this.verticalLegendColorByElements},{dataType:Bi.SIZE_BY,dataObj:this.verticalLegendSizeByElements}],(this.readGlobalAttriLegndProperty(X.LEGEND_MODE)===BQ.MINIMIZED));}this.renderLegend();},hideInfoBox:function(){var Bu=Ae.domNode;if(Bu&&Bu.parentNode){var Bt=this.previousTooltip;this.previousTooltip=undefined;this.applyToEntityRecursively(Bt,H.bind(this));Bu.parentNode.removeChild(Bu);}},getIdxObjectByTarget:function(Bv){var Bu=Ax.findAncestorByAttr(Bv,"idx",true,this.domNode);var Bt=Bu&&Bu.value;if(!Bt){return null;}return this.getObjectByIdx(Bt);},showInfoBox:function(Bu,Bx){if(!Bu){return ;}Ae.toggle(true);if(Bu===this.previousTooltip){Ae.moveTo(Bx.x,Bx.y);return ;}var Bw=this.previousTooltip;this.previousTooltip=Bu;this.applyToEntityRecursively(Bw,H.bind(this));this.applyToEntityRecursively(Bu,H.bind(this));var Bt=Bu.headerSize||Bu.size;if(!Bt||isNaN(Bt.x)){return ;}var Bv=AD(Bu,this);if(Bv){if(!Ae.domNode.parentNode){document.body.appendChild(Ae.domNode);}Ae.displayInfo(Bv,Bx);}},onmousedown:function(){this._isMouseDown=true;},onmousemove:function(Bv){if(!this._isMouseDown){var Bw=AN(Bv);var Bu=Bw.target;if(!Bu||!this.isRectangle(Bu)){return ;}var Bt=this.getEntityByTouch(Bw);if(Bt){this.showInfoBox(Bt,{x:Bv.e.pageX,y:Bv.e.pageY});}}},onmouseup:function(){delete this._isMouseDown;},onmouseout:function AW(Bv){var Bu=this.canvasContainer,Bt=Bv.e.toElement||Bv.e.relatedTarget;if(!Ax.contains(Bu,Bt,true)){this.hideInfoBox();}},oncontextmenu:function BF(Bt){if(mstrApp.isInVFInteractMode){Ax.stopPropogation(window,Bt);Ax.preventDefault(window,Bt);return false;}this.contextMenuSelectionHandler(Bt);this.hideInfoBox();Ab.call(this,this.contextMenuSelection);var Bu=this.getComponentType(Bt),By=Bt.ctrlKey||Bt.metaKey,Bw=g[Bu.type];if(Bw){Bw.call(this,Bt,Bu.target);Bt.cancel();}if(this.attributeColorByLegend){var Bx=Bt.getTarget(),Bv=this.attributeColorByLegend;if(Ax.contains(Bv.domNode,Bx,true)){Bv.handleRMCOnLegend(Bt);}else{Bv.hideToolbar();}}Bt.preventDefault();return false;},destroy:function(Bu){var Bt=this.attributeColorByLegend;if(Bt){Bt.hideToolbar();}this._super(Bu);},readGlobalAttriLegndProperty:function o(Bv){var Bu=this.props,Bt,Bw;switch(Bv){case Aq.LEGEND_BG_COLOR:Bw=Bu.lgdBgFillClr;break;case Aq.LEGEND_BG_FILL_STYLE:Bw=Bu.lgdBgFillStyle;break;case Aq.LEGEND_BG_FILL_EFFECT:Bw=Bu.lgdBgFillEff;break;case Aq.LEGEND_BG_FILL_TRANSPARENCY:Bw=Bu.lgdBgFillTrans;break;case Aq.LEGEND_FONT_SIZE:Bw=Bu.lgdFntSz;break;case Aq.LEGEND_FONT_FAMILY:Bw=Bu.lgdFntFml;break;case Aq.LEGEND_FONT_STYLE:Bw=Bu.lgdFntStyle;break;case Aq.LEGEND_FONT_COLOR:Bw=Bu.lgdFntClr;break;case Aq.LEGEND_BORDER_SHOW:Bw=Bu.lgdBdrShw;break;case Aq.LEGEND_BORDER_COLOR:Bw=Bu.lgdBdrClr;break;case Aq.LEGEND_BORDER_THICKNESS:Bw=Bu.lgdBdrThk;break;case Aq.LEGEND_BORDER_LINE_STYLE:Bw=Bu.lgdBdrStyle;break;case Aq.COLOR_SQUARE_COLOR:Bt=this.colorSqureIdentity;if(Bt){Bw={color:Bt.decodedColor,isDefaultColor:Bt.isDefaultColor};}else{Bw={color:"#0000FF",isDefaultColor:true};}break;case X.LEGEND_MODE:Bw=Bu.lm;break;case X.LEGEND_POSITION:Bw=Bu.LegendPosition;break;case X.SCALE_LEGEND_WIDTH:Bw=Bu.lwr;break;}if(Bw===undefined||((typeof Bw)==="number"&&isNaN(Bw))){Bw=this.defaultsLegendPop&&this.defaultsLegendPop[Bv];}return Bw;},initHTML5Props:function(Bv){var Bu=Bv.LEGEND={},Bt=function(Bw){var Bx=["solid","dashed","dotted"];return Bx[Bw]||"none";};Bu.fontFamily=this.readGlobalAttriLegndProperty(Aq.LEGEND_FONT_FAMILY);Bu.fontSize=this.readGlobalAttriLegndProperty(Aq.LEGEND_FONT_SIZE);BN.processFontStyle(Bu,this.readGlobalAttriLegndProperty(Aq.LEGEND_FONT_STYLE));Bu.color=k.decodeColor(this.readGlobalAttriLegndProperty(Aq.LEGEND_FONT_COLOR));Bu.backgroundColor=k.decodeColor(this.readGlobalAttriLegndProperty(Aq.LEGEND_BG_COLOR));Bu.opacity=this.readGlobalAttriLegndProperty(Aq.LEGEND_BG_FILL_TRANSPARENCY)/100;if(this.readGlobalAttriLegndProperty(Aq.LEGEND_BORDER_SHOW)){Bu.borderWidth=this.readGlobalAttriLegndProperty(Aq.LEGEND_BORDER_THICKNESS);Bu.borderStyle=Bt(this.readGlobalAttriLegndProperty(Aq.LEGEND_BORDER_LINE_STYLE));Bu.borderColor=k.decodeColor(this.readGlobalAttriLegndProperty(Aq.LEGEND_BORDER_COLOR));}},configureAttriLegendPopup:function P(Bt,Bu){Bt.hostId=this.id;Bt.hostElement=Bu;},writeGlobalAttriLegndProperty:function(Bu,Bv,Bx){var Bt=!!(Bx&&Bx.success),Bw=function(B0,Bz){var By=this.props;By.unmarshal(Bu,B0);if(Bt){Bx.success.call(this,By[Bu],Bz);}};if(Bu===Aq.COLOR_SQUARE_COLOR){this.props.unmarshal(Bu,Bv);this.setProperty(Bu,Bv,{callback:Bx});}else{Bw.call(this,Bv,false);this.setProperty(Bu,this.props.marshal(Bu),{suppressData:true,clientUndoRedoCallback:Bt?Bw:undefined});}},onLegendDropZoneChange:function Ay(Bt,Bu){this.setLegendSlot(Bt,Bu);},onLegendDropped:function(Bt){this.writeGlobalAttriLegndProperty(X.LEGEND_POSITION,Bt,{success:function(Bv,Bu){if(Bu){this.renderLegend();this.updateCanvasAfterAttributeLegendChanged(Bv,this.legendW);}}});},setLegendSlot:function(Bu,Bx){var Bw=this.attributeColorByLegend.currDockedPositionIdx,By=this.canvasOuterContainer;if(Bx!==Bw){var Bt=this.isOnRight(D[Bw].pos),Bv=this.isOnRight(Bu.pos);if(Bt!==Bv){By.style.left=Bv?"0px":this.legendW+"px";}}},isOnRight:function(Bt){return(Bt===Af.RIGHT_MIDDLE||Bt===Af.RIGHT_TOP||Bt===Af.RIGHT_BOTTOM);},updateLegend:function(){var Bt=this.attributeColorByLegend;this.attributeColorByLegendPlaceHolder.style.width=this.legendW+"px";this.attributeColorByLegendPlaceHolder.style.height=this.legendH+"px";Bt.width=this.legendW;Bt.height=this.legendH;Bt.cutBy=this.legendCutBy;Bt.minHeight=this.legendMinHeight;Bt.updateContainerSize(this.getWidth(),this.getHeight());Bt.feedData([{dataType:Bi.COLOR_BY,dataObj:this.verticalLegendColorByElements},{dataType:Bi.SIZE_BY,dataObj:this.verticalLegendSizeByElements}],(this.readGlobalAttriLegndProperty(X.LEGEND_MODE)===BQ.MINIMIZED));Bt.updateAfterResize();},toggleLegend:function(Bt){var Bv=this.attributeColorByLegend,Bu;Bu=Bv.domNode.style;if(!Bt){Bv.hideToolbar();Bu.display="none";}else{if(Bu.display!=="block"){Bu.display="block";}}},updateCanvasAfterAttributeLegendChanged:function(Bt,Bx){var Bw=parseInt(this.width,10),Bu=parseInt(this.height,10),By=this.LayoutProperties.Padding,Bz=Bw-2*By-Bx,B0=Bu-2*By,Bv=0;if(this.props.showLegend&&!this.isOnRight(Bt)){Bv=Bx;}this.heatMapSize={x:Bv,y:0,w:Bz,h:B0};this.applyLayout();BD.call(this);this.renderRectangles();this.highlightCanvas.resetCanvasRect(this.heatMapSize);this.refreshHighlights();},getCellForNode:function Be(Bu){var Bt=this.levelAttributes[Bu.level];return{at:Bu.at,dei:Bu.dei,dpt:Bu.dpt,o:Bu.o,n:Bt.name,tui:Bu.tui,ui:Bu.ui,axis:1,v:Bu.label,tid:Bt.id};},getCellUnitIndex:function A1(Bt){return Bt.o;},getColorByElements:function q(){var Bt=this.verticalLegendColorByElements,Bu=this,Bv;if(Bt===undefined){this.getVerticalLegendColorByInfo();Bt=this.verticalLegendColorByElements||{};}Bv=(Bt.elements||[]).map(function(By){var Bw=By.token,B0=Bw.elements||[],Bz=Bw.levels||[],Bx=Bw.types||[];return{text:By.label,color:By.color,opacity:AU.call(Bu,Bz,B0),comb:Aw(Bz,B0,Bx)};});Bv.unshift({text:mstrmojo.desc(2461,"All"),color:"#ffffff",opacity:100,comb:[]});return Bv;},updateColorByOpacity:function(Bv,Bt){Bv=[].concat(Bv);Bt=[].concat(Bt);if(Bv.length!==Bt.length){throw new Error("comb and opacity number not match");}var Bu=this.getPropsInfo(),Bw=Bu.attrColorByOpacity||{};Bv.forEach(function(Bz,By){var B1=Bz.map(function(B2){return B2.tid;}).join("|"),B0=Bz.map(function(B2){return B2.eid;}).join("|"),Bx=Bw[B1];if(Bx===undefined){Bx={};Bw={};}Bx[B0]=Bt[By];Bw[B1]=Bx;});this.observableModel.colorByOpacity.setValue(Bw);},execFormatHandler:function(){var By=function(){AQ.selectPropertyPanel(this,0);}.bind(this);var Bx=this.previousSelected;if(Bx===undefined||Bx.length===0){By();return ;}var Bz=A9.call(this),Bu=AG.call(this),Bv=this._toolbarContext,B0,Bw,Bt;if(!Bz&&!Bu){return ;}if(Bv===undefined){By();return ;}B0=Bv.pos;Bw=Bv.type;Bt=Bv.entity||this.getEntityByTouch(AN(B0));switch(Bw){case f.RECTANGLE_LABEL:case f.RECTANGLE:BP.call(this,Bt,B0);break;default:By();break;}},onNDECreated:function(Bt){Bt.forEach(function(Bw){var Bu=Bw.id,Bv=Bw.unitId;this.dfs(this.root,function(Bx){var By=Bx.id||"";if(By.indexOf(Bu)!==-1&&By.indexOf(Bv)!==-1){this.addToSelection(Bx);}}.bind(this));},this);this.doSelection();this.refreshHighlights();},triggerFontScaleChangeEvent:function(){A8.call(this,this.props.fonts);},isAttributeColorByType:function(){return this.props.colorByType==="attribute";},isMetricColorByType:function(){return this.props.colorByType==="metric";},onselectionBatchRemove:function(Bt){this.refreshHighlights(Bt.entities);},clearAllSelectionsAndHighlight:function Au(Bu){var Bt=Bu.getTarget();if(Bt){Bt.desc="clearAllBtn";this.onclick(Bu);delete Bt.desc;}}});}());